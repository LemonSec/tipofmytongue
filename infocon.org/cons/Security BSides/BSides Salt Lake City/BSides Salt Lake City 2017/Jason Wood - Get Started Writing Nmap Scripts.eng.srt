1
00:00:00,500 --> 00:00:13,499
[Music]

2
00:00:14,700 --> 00:00:19,150
so I want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> thank Chris</font><font color="#CCCCCC"> for his</font>

3
00:00:17,710 --> 00:00:23,710
presentation<font color="#CCCCCC"> because it leads right into</font>

4
00:00:19,150 --> 00:00:26,099
mine<font color="#CCCCCC"> I know it's something that the</font>

5
00:00:23,710 --> 00:00:30,009
<font color="#CCCCCC">b-sides group was kind of</font><font color="#E5E5E5"> jazzed about</font>

6
00:00:26,100 --> 00:00:31,810
<font color="#E5E5E5">stacking</font><font color="#CCCCCC"> the two together</font><font color="#E5E5E5"> having a you</font>

7
00:00:30,009 --> 00:00:34,270
know<font color="#E5E5E5"> an intro</font><font color="#CCCCCC"> to nmap and then follow</font><font color="#E5E5E5"> up</font>

8
00:00:31,810 --> 00:00:36,910
with<font color="#E5E5E5"> writing and map script</font><font color="#CCCCCC"> Sean made</font>

9
00:00:34,270 --> 00:00:39,010
the comment to<font color="#E5E5E5"> me last night that you</font>

10
00:00:36,910 --> 00:00:41,440
<font color="#CCCCCC">know typical</font><font color="#E5E5E5"> nmap talk and I've done</font>

11
00:00:39,010 --> 00:00:43,960
this a couple<font color="#CCCCCC"> times myself</font>

12
00:00:41,440 --> 00:00:45,910
hey<font color="#CCCCCC"> nmf has a scripting engine it's</font>

13
00:00:43,960 --> 00:00:47,080
great it's fabulous it's flexible we

14
00:00:45,910 --> 00:00:52,900
don't have time to<font color="#CCCCCC"> talk about one we've</font>

15
00:00:47,080 --> 00:00:58,960
<font color="#CCCCCC">blown so I decided try and address that</font>

16
00:00:52,900 --> 00:01:02,140
<font color="#CCCCCC">a little bit alright</font><font color="#E5E5E5"> my name is Jason</font>

17
00:00:58,960 --> 00:01:05,110
<font color="#E5E5E5">wood I am the owner and</font><font color="#CCCCCC"> founder of</font>

18
00:01:02,140 --> 00:01:07,439
<font color="#E5E5E5">paladin security are you penetration</font>

19
00:01:05,110 --> 00:01:12,220
testing and security code<font color="#E5E5E5"> salting and</font>

20
00:01:07,439 --> 00:01:15,429
working on training<font color="#E5E5E5"> right</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> I actually</font>

21
00:01:12,220 --> 00:01:19,119
am also<font color="#E5E5E5"> a red team member at a very</font>

22
00:01:15,430 --> 00:01:19,570
large<font color="#CCCCCC"> Bank</font><font color="#E5E5E5"> that allows me to</font><font color="#CCCCCC"> do my own</font>

23
00:01:19,119 --> 00:01:21,460
<font color="#E5E5E5">thing</font>

24
00:01:19,570 --> 00:01:24,309
<font color="#CCCCCC">with the condition that</font><font color="#E5E5E5"> I never</font>

25
00:01:21,460 --> 00:01:26,439
mentioned their name so they're<font color="#CCCCCC"> really</font>

26
00:01:24,310 --> 00:01:27,670
pretty strict on on what our<font color="#E5E5E5"> employees</font>

27
00:01:26,439 --> 00:01:30,928
are<font color="#CCCCCC"> allowed to do so I respect that so</font>

28
00:01:27,670 --> 00:01:33,579
<font color="#E5E5E5">they I can keep</font><font color="#CCCCCC"> doing what I</font><font color="#E5E5E5"> would like</font>

29
00:01:30,929 --> 00:01:35,140
and i work as a CyberPatriot mentor if

30
00:01:33,579 --> 00:01:36,869
you hear me<font color="#CCCCCC"> have heard me talk before I</font>

31
00:01:35,140 --> 00:01:39,670
usually<font color="#E5E5E5"> bring this up</font><font color="#CCCCCC"> every</font><font color="#E5E5E5"> time</font>

32
00:01:36,869 --> 00:01:42,039
CyberPatriot is a<font color="#E5E5E5"> Air Force Association</font>

33
00:01:39,670 --> 00:01:44,020
<font color="#E5E5E5">sponsored program to teach middle school</font>

34
00:01:42,039 --> 00:01:45,600
<font color="#E5E5E5">and</font><font color="#CCCCCC"> high school</font><font color="#E5E5E5"> kids and even now</font><font color="#CCCCCC"> that</font>

35
00:01:44,020 --> 00:01:48,039
pushing it down<font color="#E5E5E5"> to elementary school</font>

36
00:01:45,600 --> 00:01:51,130
computer<font color="#E5E5E5"> security how to it get</font>

37
00:01:48,039 --> 00:01:53,770
<font color="#E5E5E5">basically a busted VM with backdoors on</font>

38
00:01:51,130 --> 00:01:56,889
it or badly configured security

39
00:01:53,770 --> 00:01:58,030
it's got score<font color="#CCCCCC"> bots on it</font><font color="#E5E5E5"> and their form</font>

40
00:01:56,889 --> 00:02:00,880
up<font color="#CCCCCC"> in the teams and they compete</font>

41
00:01:58,030 --> 00:02:02,829
<font color="#E5E5E5">nationally against each other</font><font color="#CCCCCC"> I think</font>

42
00:02:00,880 --> 00:02:05,859
<font color="#CCCCCC">it's a</font><font color="#E5E5E5"> great program</font>

43
00:02:02,829 --> 00:02:09,190
<font color="#E5E5E5">just as a way of well</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> couple</font><font color="#CCCCCC"> things I</font>

44
00:02:05,859 --> 00:02:10,869
<font color="#E5E5E5">mean one you get kind of exciting</font><font color="#CCCCCC"> and</font>

45
00:02:09,190 --> 00:02:13,030
working with these kids because<font color="#CCCCCC"> they</font><font color="#E5E5E5"> get</font>

46
00:02:10,869 --> 00:02:15,190
excited<font color="#E5E5E5"> and you feed off</font><font color="#CCCCCC"> of that and to</font>

47
00:02:13,030 --> 00:02:19,690
just<font color="#CCCCCC"> a nice way to give back I think and</font>

48
00:02:15,190 --> 00:02:22,550
teach some of the<font color="#E5E5E5"> upcoming folks</font><font color="#CCCCCC"> moving</font>

49
00:02:19,690 --> 00:02:25,700
into<font color="#CCCCCC"> our community</font>

50
00:02:22,550 --> 00:02:28,460
any scripts<font color="#CCCCCC"> that I mentioned in his talk</font>

51
00:02:25,700 --> 00:02:30,200
that<font color="#CCCCCC"> I've done if you're not a ton are</font>

52
00:02:28,460 --> 00:02:32,510
going to be up on<font color="#CCCCCC"> my github account as</font>

53
00:02:30,200 --> 00:02:35,560
well as the slides<font color="#CCCCCC"> so if you want to</font>

54
00:02:32,510 --> 00:02:37,670
<font color="#E5E5E5">pull those down</font><font color="#CCCCCC"> you're welcome to</font><font color="#E5E5E5"> it I</font>

55
00:02:35,560 --> 00:02:45,470
just<font color="#CCCCCC"> did to think of the slides this</font>

56
00:02:37,670 --> 00:02:47,600
morning so<font color="#CCCCCC"> they're they're up to</font><font color="#E5E5E5"> date so</font>

57
00:02:45,470 --> 00:02:49,400
the end<font color="#CCCCCC"> map scripting engine</font><font color="#E5E5E5"> likes</font><font color="#CCCCCC"> as</font>

58
00:02:47,600 --> 00:02:51,200
Chris said<font color="#CCCCCC"> started out and map was a</font>

59
00:02:49,400 --> 00:02:54,170
port scanner<font color="#E5E5E5"> that's that's what it did</font>

60
00:02:51,200 --> 00:02:56,179
and they ran into<font color="#CCCCCC"> the idea to some</font>

61
00:02:54,170 --> 00:02:58,489
issues<font color="#CCCCCC"> though they wanted</font><font color="#E5E5E5"> to do some</font>

62
00:02:56,180 --> 00:03:00,260
<font color="#CCCCCC">more flexible testing and they couldn't</font>

63
00:02:58,490 --> 00:03:03,890
do it<font color="#CCCCCC"> they</font><font color="#E5E5E5"> couldn't share information</font>

64
00:03:00,260 --> 00:03:08,090
between<font color="#E5E5E5"> different network checks and</font>

65
00:03:03,890 --> 00:03:10,339
stuff like that<font color="#E5E5E5"> very well and this was a</font>

66
00:03:08,090 --> 00:03:11,810
problem<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they wanted to to address</font>

67
00:03:10,340 --> 00:03:14,240
and they didn't want to<font color="#CCCCCC"> get</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> the</font>

68
00:03:11,810 --> 00:03:16,910
<font color="#CCCCCC">situation of they were the sole</font><font color="#E5E5E5"> source</font>

69
00:03:14,240 --> 00:03:21,470
or place<font color="#CCCCCC"> where</font><font color="#E5E5E5"> somebody could come up</font>

70
00:03:16,910 --> 00:03:24,290
with<font color="#E5E5E5"> a check of some sort which if they</font>

71
00:03:21,470 --> 00:03:25,430
had you know<font color="#E5E5E5"> not done the scripting</font>

72
00:03:24,290 --> 00:03:28,549
engine<font color="#CCCCCC"> they'd all the stuff would</font><font color="#E5E5E5"> be</font>

73
00:03:25,430 --> 00:03:31,280
coded<font color="#E5E5E5"> in C or</font><font color="#CCCCCC"> C++ and I don't know about</font>

74
00:03:28,550 --> 00:03:34,130
you<font color="#CCCCCC"> all I've done</font><font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit of</font><font color="#E5E5E5"> C but</font>

75
00:03:31,280 --> 00:03:37,220
don't trust<font color="#E5E5E5"> me to do you know anything</font>

76
00:03:34,130 --> 00:03:40,250
of<font color="#E5E5E5"> a of any importance whereas the</font>

77
00:03:37,220 --> 00:03:42,320
scripting languages within my my<font color="#E5E5E5"> graphs</font>

78
00:03:40,250 --> 00:03:47,090
so<font color="#CCCCCC"> you provided them that flexibility</font>

79
00:03:42,320 --> 00:03:49,519
<font color="#E5E5E5">and they it allowed them to put that</font>

80
00:03:47,090 --> 00:03:51,350
capability<font color="#E5E5E5"> out into everybody's hands</font>

81
00:03:49,520 --> 00:03:53,120
<font color="#CCCCCC">they don't have to write all of the</font>

82
00:03:51,350 --> 00:03:57,079
checks<font color="#E5E5E5"> they can just have people submit</font>

83
00:03:53,120 --> 00:04:01,360
them and and then add them to the

84
00:03:57,080 --> 00:04:05,920
project<font color="#CCCCCC"> repository like</font><font color="#E5E5E5"> Chris said they</font>

85
00:04:01,360 --> 00:04:09,350
the scripting engine runs on using<font color="#E5E5E5"> Lua</font>

86
00:04:05,920 --> 00:04:10,609
scripting language<font color="#E5E5E5"> and there's actually</font>

87
00:04:09,350 --> 00:04:12,950
talk

88
00:04:10,610 --> 00:04:15,470
we've got<font color="#CCCCCC"> fyodor</font><font color="#E5E5E5"> another gentleman who</font>

89
00:04:12,950 --> 00:04:18,140
work on the MF who also works in<font color="#CCCCCC"> the MF</font>

90
00:04:15,470 --> 00:04:20,630
project<font color="#E5E5E5"> they were talking about some of</font>

91
00:04:18,140 --> 00:04:24,050
<font color="#CCCCCC">the reasons why</font><font color="#E5E5E5"> they decided to</font><font color="#CCCCCC"> go down</font>

92
00:04:20,630 --> 00:04:25,430
<font color="#E5E5E5">the route of</font><font color="#CCCCCC"> using Lua</font><font color="#E5E5E5"> one they didn't</font>

93
00:04:24,050 --> 00:04:27,920
want<font color="#E5E5E5"> to run into a situation where</font>

94
00:04:25,430 --> 00:04:30,200
<font color="#CCCCCC">because they were coding</font><font color="#E5E5E5"> this stuff and</font>

95
00:04:27,920 --> 00:04:32,300
C or C++<font color="#CCCCCC"> or they were going</font><font color="#E5E5E5"> to start</font>

96
00:04:30,200 --> 00:04:34,310
dealing<font color="#E5E5E5"> with buffer overflows or whatnot</font>

97
00:04:32,300 --> 00:04:38,000
<font color="#CCCCCC">I didn't want</font><font color="#E5E5E5"> to introduce security</font>

98
00:04:34,310 --> 00:04:43,130
vulnerabilities into the into the to the

99
00:04:38,000 --> 00:04:45,020
application and<font color="#E5E5E5"> to they looked at it and</font>

100
00:04:43,130 --> 00:04:46,700
it's like<font color="#E5E5E5"> okay well that means we want</font>

101
00:04:45,020 --> 00:04:49,130
<font color="#E5E5E5">to a scripting language do we roll our</font>

102
00:04:46,700 --> 00:04:51,260
own scripting language or do we use

103
00:04:49,130 --> 00:04:53,000
<font color="#E5E5E5">something that's already exists and</font><font color="#CCCCCC"> so</font>

104
00:04:51,260 --> 00:04:54,680
<font color="#CCCCCC">they looked around</font><font color="#E5E5E5"> at a few different</font>

105
00:04:53,000 --> 00:04:56,979
<font color="#E5E5E5">languages</font><font color="#CCCCCC"> it wanted something that was</font>

106
00:04:54,680 --> 00:05:03,350
going to be easy<font color="#CCCCCC"> pretty</font><font color="#E5E5E5"> easy to</font><font color="#CCCCCC"> embed</font>

107
00:04:56,979 --> 00:05:05,419
into<font color="#E5E5E5"> the application and that was fairly</font>

108
00:05:03,350 --> 00:05:09,140
mature and<font color="#CCCCCC"> well documented and so they</font>

109
00:05:05,419 --> 00:05:11,150
selected Lua for that and so it's been

110
00:05:09,140 --> 00:05:15,849
<font color="#CCCCCC">around for quite a while</font><font color="#E5E5E5"> I believe since</font>

111
00:05:11,150 --> 00:05:18,799
1993<font color="#CCCCCC"> and as it sits</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> now as of</font>

112
00:05:15,850 --> 00:05:22,640
yesterday I believe<font color="#E5E5E5"> when I checked there</font>

113
00:05:18,800 --> 00:05:24,950
are<font color="#CCCCCC"> 558</font><font color="#E5E5E5"> scripts</font><font color="#CCCCCC"> available when they</font>

114
00:05:22,640 --> 00:05:27,740
originally<font color="#E5E5E5"> you know you go back</font><font color="#CCCCCC"> a few</font>

115
00:05:24,950 --> 00:05:30,200
years<font color="#CCCCCC"> there was a hundred and</font><font color="#E5E5E5"> fifty</font><font color="#CCCCCC"> or</font>

116
00:05:27,740 --> 00:05:33,050
so so it's starting<font color="#E5E5E5"> to grow a little bit</font>

117
00:05:30,200 --> 00:05:35,330
<font color="#E5E5E5">faster</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> definitely has the ability</font>

118
00:05:33,050 --> 00:05:38,180
<font color="#E5E5E5">because of</font><font color="#CCCCCC"> the flexibility built into</font>

119
00:05:35,330 --> 00:05:40,510
this to<font color="#E5E5E5"> almost be like a vulnerability</font>

120
00:05:38,180 --> 00:05:44,150
<font color="#E5E5E5">scanner something like a</font><font color="#CCCCCC"> command-line</font>

121
00:05:40,510 --> 00:05:46,340
<font color="#E5E5E5">meses</font><font color="#CCCCCC"> but you know there's some</font>

122
00:05:44,150 --> 00:05:47,840
differences there<font color="#E5E5E5"> right</font><font color="#CCCCCC"> nessus is</font>

123
00:05:46,340 --> 00:05:49,549
written by a company<font color="#E5E5E5"> that</font><font color="#CCCCCC"> puts</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

124
00:05:47,840 --> 00:05:53,810
money into paying people for write

125
00:05:49,550 --> 00:05:56,419
<font color="#E5E5E5">plug-ins to</font><font color="#CCCCCC"> look for issues</font><font color="#E5E5E5"> and map it</font>

126
00:05:53,810 --> 00:05:58,700
was primarily<font color="#E5E5E5"> devoted towards</font>

127
00:05:56,419 --> 00:06:01,609
network scanning and they<font color="#E5E5E5"> certainly</font>

128
00:05:58,700 --> 00:06:05,320
don't have<font color="#E5E5E5"> that type of organization set</font>

129
00:06:01,610 --> 00:06:07,430
<font color="#CCCCCC">up to pay people to write checks</font><font color="#E5E5E5"> so it's</font>

130
00:06:05,320 --> 00:06:09,290
doesn't<font color="#E5E5E5"> have</font><font color="#CCCCCC"> anything</font><font color="#E5E5E5"> close to that</font>

131
00:06:07,430 --> 00:06:10,910
that<font color="#E5E5E5"> level</font><font color="#CCCCCC"> of features</font><font color="#E5E5E5"> but that doesn't</font>

132
00:06:09,290 --> 00:06:15,920
<font color="#CCCCCC">mean that we can't add specific</font>

133
00:06:10,910 --> 00:06:18,200
things that we want<font color="#E5E5E5"> to look for so why</font>

134
00:06:15,920 --> 00:06:20,690
are<font color="#E5E5E5"> we going to write an NSC script</font>

135
00:06:18,200 --> 00:06:22,880
what's our benefit<font color="#E5E5E5"> well one of the first</font>

136
00:06:20,690 --> 00:06:24,800
things that<font color="#E5E5E5"> got me</font><font color="#CCCCCC"> thinking about this</font><font color="#E5E5E5"> a</font>

137
00:06:22,880 --> 00:06:26,420
little<font color="#E5E5E5"> bit because what</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> would</font>

138
00:06:24,800 --> 00:06:28,670
typically do is I used n map all the

139
00:06:26,420 --> 00:06:30,560
time I'd crack the thing<font color="#E5E5E5"> open you know</font>

140
00:06:28,670 --> 00:06:31,940
<font color="#E5E5E5">crack open some</font><font color="#CCCCCC"> of the scripts to see</font>

141
00:06:30,560 --> 00:06:33,770
<font color="#E5E5E5">okay what</font><font color="#CCCCCC"> is this script do does</font><font color="#E5E5E5"> it</font>

142
00:06:31,940 --> 00:06:36,860
apply to a<font color="#E5E5E5"> penetration test I'm working</font>

143
00:06:33,770 --> 00:06:39,190
on<font color="#E5E5E5"> or Jesus just sounds interesting what</font>

144
00:06:36,860 --> 00:06:41,780
are they doing here

145
00:06:39,190 --> 00:06:45,320
but what got<font color="#E5E5E5"> me interested in this more</font>

146
00:06:41,780 --> 00:06:47,210
was in doing penetration test part of

147
00:06:45,320 --> 00:06:49,130
what we do is we<font color="#E5E5E5"> provide the</font><font color="#CCCCCC"> results</font>

148
00:06:47,210 --> 00:06:51,710
back to our clients and say hey<font color="#CCCCCC"> here's</font>

149
00:06:49,130 --> 00:06:54,500
the<font color="#E5E5E5"> problems we found here's how you can</font>

150
00:06:51,710 --> 00:06:57,159
confirm that<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is in your environment</font>

151
00:06:54,500 --> 00:06:59,210
then you<font color="#E5E5E5"> can use this to check and see</font>

152
00:06:57,160 --> 00:07:02,390
<font color="#E5E5E5">once you fix things whether or not</font>

153
00:06:59,210 --> 00:07:06,289
things<font color="#E5E5E5"> are have been applied correctly</font><font color="#CCCCCC"> I</font>

154
00:07:02,390 --> 00:07:11,419
thought wouldn't it<font color="#E5E5E5"> be neat to</font><font color="#CCCCCC"> be able</font>

155
00:07:06,290 --> 00:07:14,870
<font color="#E5E5E5">to provide at</font><font color="#CCCCCC"> least</font><font color="#E5E5E5"> some of that those</font>

156
00:07:11,420 --> 00:07:17,180
checks<font color="#E5E5E5"> though that testing</font><font color="#CCCCCC"> mechanism</font><font color="#E5E5E5"> in</font>

157
00:07:14,870 --> 00:07:18,650
something like<font color="#E5E5E5"> an antiserum to a client</font>

158
00:07:17,180 --> 00:07:20,300
<font color="#CCCCCC">just say hey here's how you run</font><font color="#E5E5E5"> the</font>

159
00:07:18,650 --> 00:07:24,950
command run it against the<font color="#CCCCCC"> scripts aim</font>

160
00:07:20,300 --> 00:07:26,360
<font color="#CCCCCC">it</font><font color="#E5E5E5"> at this asset or assets and there you</font>

161
00:07:24,950 --> 00:07:28,750
go you can<font color="#CCCCCC"> validate</font><font color="#E5E5E5"> it inside your</font>

162
00:07:26,360 --> 00:07:32,180
environment so<font color="#CCCCCC"> that was what got me</font>

163
00:07:28,750 --> 00:07:35,840
interested in this if you<font color="#E5E5E5"> work inside of</font>

164
00:07:32,180 --> 00:07:38,780
a company as a security<font color="#CCCCCC"> engineer so</font>

165
00:07:35,840 --> 00:07:43,190
you're not out hitting different

166
00:07:38,780 --> 00:07:44,539
<font color="#E5E5E5">companies or clients like I do one of</font>

167
00:07:43,190 --> 00:07:46,430
<font color="#CCCCCC">the</font><font color="#E5E5E5"> things I had thought of as a</font>

168
00:07:44,540 --> 00:07:48,680
security<font color="#CCCCCC"> engineer was similar to</font><font color="#E5E5E5"> that</font>

169
00:07:46,430 --> 00:07:51,020
<font color="#E5E5E5">one I was working</font><font color="#CCCCCC"> at whole time at a</font>

170
00:07:48,680 --> 00:07:53,000
<font color="#E5E5E5">place was I will sure would like to get</font>

171
00:07:51,020 --> 00:07:56,990
some security<font color="#E5E5E5"> testing into my developers</font>

172
00:07:53,000 --> 00:07:58,460
hand or QA groups hands so wouldn't<font color="#CCCCCC"> it</font>

173
00:07:56,990 --> 00:08:00,470
<font color="#CCCCCC">be nice if I came up with hey we've got</font>

174
00:07:58,460 --> 00:08:02,210
this<font color="#E5E5E5"> flaw in this application QA is</font>

175
00:08:00,470 --> 00:08:04,490
primarily responsible for<font color="#CCCCCC"> determining</font>

176
00:08:02,210 --> 00:08:06,530
whether<font color="#E5E5E5"> or not</font><font color="#CCCCCC"> a flaw has been fixed</font><font color="#E5E5E5"> or</font>

177
00:08:04,490 --> 00:08:10,010
<font color="#CCCCCC">not</font><font color="#E5E5E5"> going to be nice to give them a</font>

178
00:08:06,530 --> 00:08:11,770
script<font color="#CCCCCC"> that would</font><font color="#E5E5E5"> handle this and so</font>

179
00:08:10,010 --> 00:08:14,719
<font color="#CCCCCC">okay and</font><font color="#E5E5E5"> there's another use case</font><font color="#CCCCCC"> for</font>

180
00:08:11,770 --> 00:08:19,280
<font color="#CCCCCC">for</font><font color="#E5E5E5"> use an NSC now I could do that</font><font color="#CCCCCC"> in</font>

181
00:08:14,720 --> 00:08:21,610
Python<font color="#CCCCCC"> or Ruby or what have you but</font><font color="#E5E5E5"> you</font>

182
00:08:19,280 --> 00:08:24,448
know here's a framework<font color="#CCCCCC"> ready to go</font><font color="#E5E5E5"> and</font>

183
00:08:21,610 --> 00:08:27,909
others that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can come up obviously</font>

184
00:08:24,449 --> 00:08:29,349
<font color="#E5E5E5">you've found some kind of issue</font><font color="#CCCCCC"> let's</font>

185
00:08:27,909 --> 00:08:32,380
say you're<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> some security research</font>

186
00:08:29,349 --> 00:08:33,549
and you you want to<font color="#E5E5E5"> release checks for</font>

187
00:08:32,380 --> 00:08:35,799
that out to the public

188
00:08:33,549 --> 00:08:37,630
you could write up<font color="#E5E5E5"> an NSC script about</font>

189
00:08:35,799 --> 00:08:39,699
<font color="#E5E5E5">what you found how to detect it and then</font>

190
00:08:37,630 --> 00:08:41,559
send it<font color="#E5E5E5"> over the in map project that</font>

191
00:08:39,700 --> 00:08:43,930
accepted it it gets put into<font color="#E5E5E5"> the</font>

192
00:08:41,559 --> 00:08:45,609
repository<font color="#E5E5E5"> now folks can scan for that</font>

193
00:08:43,929 --> 00:08:47,649
across their environment

194
00:08:45,610 --> 00:08:50,010
<font color="#E5E5E5">so like one of the things you see inside</font>

195
00:08:47,649 --> 00:08:52,300
the list of scripts is<font color="#CCCCCC"> shellshock and</font>

196
00:08:50,010 --> 00:08:53,709
when that came<font color="#E5E5E5"> out everybody was</font><font color="#CCCCCC"> scanned</font>

197
00:08:52,300 --> 00:08:55,120
everything<font color="#E5E5E5"> looking to see where they</font>

198
00:08:53,709 --> 00:08:57,399
could find<font color="#E5E5E5"> that because it was turning</font>

199
00:08:55,120 --> 00:09:00,029
<font color="#E5E5E5">up in all</font><font color="#CCCCCC"> kinds of odd</font><font color="#E5E5E5"> and unusual</font>

200
00:08:57,399 --> 00:09:00,029
places

201
00:09:01,370 --> 00:09:05,750
so that's a little<font color="#E5E5E5"> bit about</font><font color="#CCCCCC"> NSE in the</font>

202
00:09:04,880 --> 00:09:08,030
background on it

203
00:09:05,750 --> 00:09:10,250
but before<font color="#E5E5E5"> we start</font><font color="#CCCCCC"> looking at writing</font>

204
00:09:08,030 --> 00:09:12,439
any type of<font color="#E5E5E5"> script</font><font color="#CCCCCC"> let's take a look at</font>

205
00:09:10,250 --> 00:09:14,150
the Lua scripting language itself<font color="#CCCCCC"> I saw</font>

206
00:09:12,440 --> 00:09:17,300
a couple<font color="#E5E5E5"> of hands when Chris asked who</font>

207
00:09:14,150 --> 00:09:21,740
had developed<font color="#E5E5E5"> scripts for World of</font>

208
00:09:17,300 --> 00:09:25,400
Warcraft has anybody written any scripts

209
00:09:21,740 --> 00:09:27,590
in Lua previously<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> here a couple</font>

210
00:09:25,400 --> 00:09:28,579
<font color="#CCCCCC">people</font><font color="#E5E5E5"> it's just a few folks</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so</font>

211
00:09:27,590 --> 00:09:30,290
you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> look at this and go well</font>

212
00:09:28,580 --> 00:09:32,750
<font color="#E5E5E5">duh</font><font color="#CCCCCC"> because this is</font><font color="#E5E5E5"> going to be really</font>

213
00:09:30,290 --> 00:09:33,980
simple<font color="#CCCCCC"> syntax you know common stuff that</font>

214
00:09:32,750 --> 00:09:36,650
we're going<font color="#E5E5E5"> to use but we're going to go</font>

215
00:09:33,980 --> 00:09:40,010
talk about<font color="#CCCCCC"> that real quick get a feel</font>

216
00:09:36,650 --> 00:09:42,890
for<font color="#E5E5E5"> what the syntax looks like like I</font>

217
00:09:40,010 --> 00:09:46,520
said<font color="#CCCCCC"> in Glu</font><font color="#E5E5E5"> was first released in 93</font>

218
00:09:42,890 --> 00:09:48,620
it's a very lightweight<font color="#CCCCCC"> scripting</font>

219
00:09:46,520 --> 00:09:50,660
language<font color="#CCCCCC"> you</font><font color="#E5E5E5"> just embed it into other</font>

220
00:09:48,620 --> 00:09:53,840
applications<font color="#E5E5E5"> they built it</font><font color="#CCCCCC"> that way and</font>

221
00:09:50,660 --> 00:09:59,300
it's<font color="#E5E5E5"> really</font><font color="#CCCCCC"> well-documented Wireshark</font>

222
00:09:53,840 --> 00:10:01,370
uses it as part of their project<font color="#E5E5E5"> and so</font>

223
00:09:59,300 --> 00:10:05,599
you can<font color="#E5E5E5"> video pretty big in the video</font>

224
00:10:01,370 --> 00:10:07,550
game<font color="#E5E5E5"> realm as well so let's just start</font>

225
00:10:05,600 --> 00:10:08,870
off<font color="#CCCCCC"> with some basics</font><font color="#E5E5E5"> you know we're</font>

226
00:10:07,550 --> 00:10:10,069
going<font color="#E5E5E5"> to need</font><font color="#CCCCCC"> to for writing code we</font>

227
00:10:08,870 --> 00:10:11,570
<font color="#CCCCCC">need to write comments what the heck</font>

228
00:10:10,070 --> 00:10:15,050
were you<font color="#CCCCCC"> thinking when</font><font color="#E5E5E5"> you trying</font><font color="#CCCCCC"> to do</font>

229
00:10:11,570 --> 00:10:17,360
this right<font color="#E5E5E5"> there's the way of doing a</font>

230
00:10:15,050 --> 00:10:18,680
<font color="#E5E5E5">comment is</font><font color="#CCCCCC"> just two dashes</font><font color="#E5E5E5"> in front of</font>

231
00:10:17,360 --> 00:10:20,000
it and<font color="#E5E5E5"> then whatever</font><font color="#CCCCCC"> comes</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> forwards</font>

232
00:10:18,680 --> 00:10:23,079
you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> put down there it's no big deal</font>

233
00:10:20,000 --> 00:10:26,120
<font color="#E5E5E5">if there's a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of a convention</font>

234
00:10:23,080 --> 00:10:27,890
<font color="#E5E5E5">for multi-line comments so you'll see</font>

235
00:10:26,120 --> 00:10:29,240
three dashes and then two dashes<font color="#E5E5E5"> for</font>

236
00:10:27,890 --> 00:10:31,250
everything<font color="#E5E5E5"> else and then they wrap up</font>

237
00:10:29,240 --> 00:10:38,030
<font color="#E5E5E5">with three dashes to kind of</font><font color="#CCCCCC"> signify and</font>

238
00:10:31,250 --> 00:10:43,180
I'm done<font color="#CCCCCC"> not a big</font><font color="#E5E5E5"> deal</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you know I</font>

239
00:10:38,030 --> 00:10:48,920
tend<font color="#E5E5E5"> to default to the pound sign and</font>

240
00:10:43,180 --> 00:10:52,189
that's not the case<font color="#E5E5E5"> here assignment is</font>

241
00:10:48,920 --> 00:10:54,140
<font color="#E5E5E5">really simple</font><font color="#CCCCCC"> Z</font><font color="#E5E5E5"> equals some</font><font color="#CCCCCC"> value</font><font color="#E5E5E5"> right</font>

242
00:10:52,190 --> 00:10:55,460
<font color="#E5E5E5">you're not declaring that oh this is</font>

243
00:10:54,140 --> 00:10:56,810
<font color="#CCCCCC">going to be string or this is gonna be</font>

244
00:10:55,460 --> 00:10:58,850
an integer or<font color="#E5E5E5"> anything like that</font>

245
00:10:56,810 --> 00:11:02,630
<font color="#E5E5E5">one thing that I thought</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> kind of</font>

246
00:10:58,850 --> 00:11:05,060
<font color="#CCCCCC">interesting in</font><font color="#E5E5E5"> assignment is I can</font>

247
00:11:02,630 --> 00:11:09,410
declare<font color="#E5E5E5"> three variables and then give</font><font color="#CCCCCC"> it</font>

248
00:11:05,060 --> 00:11:12,369
two values and the way that works out if

249
00:11:09,410 --> 00:11:15,199
I was to you know<font color="#E5E5E5"> do a comma B comma C</font>

250
00:11:12,370 --> 00:11:19,160
equals zero comma one

251
00:11:15,200 --> 00:11:21,860
and then I print a comma B comma C it's

252
00:11:19,160 --> 00:11:23,930
<font color="#E5E5E5">going to be the first value on the right</font>

253
00:11:21,860 --> 00:11:26,300
gets assigned to the<font color="#CCCCCC"> first variable</font><font color="#E5E5E5"> on</font>

254
00:11:23,930 --> 00:11:30,050
the<font color="#E5E5E5"> left the second one gets assigned to</font>

255
00:11:26,300 --> 00:11:33,709
<font color="#E5E5E5">the second variable</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> left the</font>

256
00:11:30,050 --> 00:11:36,439
third variable<font color="#E5E5E5"> just just gets given a an</font>

257
00:11:33,709 --> 00:11:38,239
ill you know<font color="#E5E5E5"> it's we you declared that</font>

258
00:11:36,440 --> 00:11:40,510
<font color="#E5E5E5">this variable exists you can use it</font>

259
00:11:38,240 --> 00:11:45,190
later<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it doesn't have anything in it</font>

260
00:11:40,510 --> 00:11:47,600
so you can do this kind<font color="#E5E5E5"> of multi-line</font>

261
00:11:45,190 --> 00:11:49,760
declaration<font color="#CCCCCC"> which one that first</font><font color="#E5E5E5"> saw</font>

262
00:11:47,600 --> 00:11:51,649
this and<font color="#CCCCCC"> it's in some examples really</font>

263
00:11:49,760 --> 00:11:56,959
like wait what the<font color="#E5E5E5"> heck is going on here</font>

264
00:11:51,649 --> 00:11:59,690
<font color="#E5E5E5">this doesn't match we've got the concept</font>

265
00:11:56,959 --> 00:12:04,819
<font color="#E5E5E5">of</font><font color="#CCCCCC"> global variables as well</font><font color="#E5E5E5"> as local</font>

266
00:11:59,690 --> 00:12:07,040
<font color="#CCCCCC">variables and I've got a</font><font color="#E5E5E5"> little bit of a</font>

267
00:12:04,820 --> 00:12:08,990
typo<font color="#CCCCCC"> here but global variables are just</font>

268
00:12:07,040 --> 00:12:10,910
<font color="#CCCCCC">that declare wants that</font><font color="#E5E5E5"> you can use it</font>

269
00:12:08,990 --> 00:12:12,440
anywhere<font color="#E5E5E5"> right</font>

270
00:12:10,910 --> 00:12:14,750
just like with<font color="#E5E5E5"> any programming language</font>

271
00:12:12,440 --> 00:12:17,209
<font color="#CCCCCC">though we want to be careful</font><font color="#E5E5E5"> where we</font>

272
00:12:14,750 --> 00:12:18,740
<font color="#E5E5E5">put our we use global</font><font color="#CCCCCC"> variables some</font>

273
00:12:17,209 --> 00:12:20,209
<font color="#E5E5E5">places that make sense but for</font><font color="#CCCCCC"> the most</font>

274
00:12:18,740 --> 00:12:23,660
part<font color="#CCCCCC"> we want to use local variables</font>

275
00:12:20,209 --> 00:12:26,180
local variables are good scoped<font color="#E5E5E5"> to the</font>

276
00:12:23,660 --> 00:12:28,790
block of<font color="#CCCCCC"> code that</font><font color="#E5E5E5"> they're defined in so</font>

277
00:12:26,180 --> 00:12:30,709
if I write a function<font color="#E5E5E5"> and I have declare</font>

278
00:12:28,790 --> 00:12:33,800
a local variable<font color="#E5E5E5"> inside of that function</font>

279
00:12:30,709 --> 00:12:35,859
<font color="#E5E5E5">it's good inside</font><font color="#CCCCCC"> of that function</font><font color="#E5E5E5"> it's</font>

280
00:12:33,800 --> 00:12:40,849
not<font color="#E5E5E5"> good outside of that function at all</font>

281
00:12:35,860 --> 00:12:43,730
so if I declared fubar inside of a

282
00:12:40,850 --> 00:12:46,279
function<font color="#CCCCCC"> I can't call it once</font><font color="#E5E5E5"> I've</font>

283
00:12:43,730 --> 00:12:48,519
exited it and I mean<font color="#E5E5E5"> some other bit of</font>

284
00:12:46,279 --> 00:12:48,519
code

285
00:12:52,840 --> 00:12:57,970
now if you're looking<font color="#CCCCCC"> at this code is if</font>

286
00:12:55,600 --> 00:12:59,890
you've done any scripting this should be

287
00:12:57,970 --> 00:13:03,280
fairly<font color="#E5E5E5"> readable right it's not like</font>

288
00:12:59,890 --> 00:13:05,920
<font color="#E5E5E5">Python it gets really strict about your</font>

289
00:13:03,280 --> 00:13:07,630
white spaces<font color="#E5E5E5"> but it's not like C or Java</font>

290
00:13:05,920 --> 00:13:11,979
where you have to terminate<font color="#E5E5E5"> every line</font>

291
00:13:07,630 --> 00:13:14,140
with a semicolon<font color="#CCCCCC"> so in this case we're</font>

292
00:13:11,980 --> 00:13:17,140
just<font color="#E5E5E5"> declaring a function you know</font>

293
00:13:14,140 --> 00:13:20,230
<font color="#CCCCCC">called attack some host</font><font color="#E5E5E5"> because this is</font>

294
00:13:17,140 --> 00:13:21,880
for an<font color="#CCCCCC"> nmap check we've got to give</font><font color="#E5E5E5"> it</font>

295
00:13:20,230 --> 00:13:24,820
the host and the<font color="#CCCCCC"> pork</font><font color="#E5E5E5"> this applies to</font>

296
00:13:21,880 --> 00:13:26,350
<font color="#E5E5E5">and then we declare some variable in</font>

297
00:13:24,820 --> 00:13:28,450
here<font color="#CCCCCC"> which</font><font color="#E5E5E5"> I've done</font><font color="#CCCCCC"> eric lee just</font>

298
00:13:26,350 --> 00:13:30,070
<font color="#E5E5E5">called an attack we do some stuff and</font>

299
00:13:28,450 --> 00:13:32,530
then when we're done<font color="#E5E5E5"> with the function</font>

300
00:13:30,070 --> 00:13:35,770
we do a return to send back the<font color="#E5E5E5"> data to</font>

301
00:13:32,530 --> 00:13:38,140
whatever called this thing<font color="#CCCCCC"> and then we</font>

302
00:13:35,770 --> 00:13:40,870
just use end to mark the<font color="#E5E5E5"> end of our</font>

303
00:13:38,140 --> 00:13:43,230
function<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that's pretty free</font>

304
00:13:40,870 --> 00:13:45,910
straightforward no curly brackets<font color="#CCCCCC"> or</font>

305
00:13:43,230 --> 00:13:51,060
anything like that<font color="#E5E5E5"> to wrap around</font><font color="#CCCCCC"> or</font>

306
00:13:45,910 --> 00:13:54,130
functions<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right</font>

307
00:13:51,060 --> 00:13:55,510
tables<font color="#E5E5E5"> this is something</font><font color="#CCCCCC"> that I'm</font><font color="#E5E5E5"> still</font>

308
00:13:54,130 --> 00:13:57,220
struggling<font color="#CCCCCC"> with I'll</font><font color="#E5E5E5"> be honest with you</font>

309
00:13:55,510 --> 00:13:58,960
<font color="#E5E5E5">writing this coming up</font><font color="#CCCCCC"> with this talk</font>

310
00:13:57,220 --> 00:14:02,350
was<font color="#E5E5E5"> driven off of my interest in</font>

311
00:13:58,960 --> 00:14:03,550
learning<font color="#CCCCCC"> how to write NSC scripts so one</font>

312
00:14:02,350 --> 00:14:07,870
<font color="#CCCCCC">of the things I'm still grappling</font><font color="#E5E5E5"> with</font>

313
00:14:03,550 --> 00:14:10,959
is that inside<font color="#E5E5E5"> of</font><font color="#CCCCCC"> lua</font><font color="#E5E5E5"> if every type of</font>

314
00:14:07,870 --> 00:14:13,330
<font color="#E5E5E5">data structure is a table well I don't</font>

315
00:14:10,960 --> 00:14:15,640
want to I want<font color="#E5E5E5"> an array that's fine you</font>

316
00:14:13,330 --> 00:14:17,500
<font color="#CCCCCC">can declare</font><font color="#E5E5E5"> an array</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> like this</font><font color="#CCCCCC"> ae</font>

317
00:14:15,640 --> 00:14:19,720
equals<font color="#E5E5E5"> curly brackets right and then you</font>

318
00:14:17,500 --> 00:14:22,060
populated but<font color="#E5E5E5"> that array is inside of a</font>

319
00:14:19,720 --> 00:14:24,970
table<font color="#E5E5E5"> well I want to do linked lists</font>

320
00:14:22,060 --> 00:14:29,439
<font color="#E5E5E5">like I can do in C or C++</font><font color="#CCCCCC"> that's fine</font>

321
00:14:24,970 --> 00:14:31,780
<font color="#E5E5E5">it's inside of a</font><font color="#CCCCCC"> table so this is</font>

322
00:14:29,440 --> 00:14:33,190
<font color="#E5E5E5">something that it takes some some</font>

323
00:14:31,780 --> 00:14:35,670
getting used to I'm still<font color="#E5E5E5"> getting used</font>

324
00:14:33,190 --> 00:14:39,490
<font color="#CCCCCC">to</font><font color="#E5E5E5"> it</font>

325
00:14:35,670 --> 00:14:41,319
matrices multi-dimensional arrays or

326
00:14:39,490 --> 00:14:45,250
several others<font color="#CCCCCC"> that I'm not remembering</font>

327
00:14:41,320 --> 00:14:46,690
<font color="#E5E5E5">off the top of</font><font color="#CCCCCC"> my head but that's</font>

328
00:14:45,250 --> 00:14:49,570
<font color="#E5E5E5">something you're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> want to focus</font>

329
00:14:46,690 --> 00:14:50,620
on and look at<font color="#E5E5E5"> the documentation on to</font>

330
00:14:49,570 --> 00:14:52,270
be honest<font color="#CCCCCC"> with you a lot of</font><font color="#E5E5E5"> times what</font>

331
00:14:50,620 --> 00:14:54,460
I'll do is I'll crack open other<font color="#E5E5E5"> NSC</font>

332
00:14:52,270 --> 00:14:57,069
scripts to see how they did it you know

333
00:14:54,460 --> 00:15:02,370
try and<font color="#E5E5E5"> find something kind of similar</font>

334
00:14:57,070 --> 00:15:02,370
and use what<font color="#CCCCCC"> their their</font><font color="#E5E5E5"> demonstrating</font>

335
00:15:05,279 --> 00:15:13,180
okay if with you know if then statements

336
00:15:10,029 --> 00:15:15,819
if some<font color="#CCCCCC"> conditions then go do something</font>

337
00:15:13,180 --> 00:15:18,670
else<font color="#E5E5E5"> we wrap</font><font color="#CCCCCC"> it up</font><font color="#E5E5E5"> with an end when then</font>

338
00:15:15,819 --> 00:15:21,099
if we are<font color="#CCCCCC"> doing multiple conditions</font>

339
00:15:18,670 --> 00:15:24,189
<font color="#E5E5E5">we've got if something rather than do</font>

340
00:15:21,100 --> 00:15:26,199
this<font color="#E5E5E5"> else if this other thing do</font>

341
00:15:24,190 --> 00:15:28,000
something entirely different<font color="#CCCCCC"> and then</font>

342
00:15:26,199 --> 00:15:29,680
<font color="#E5E5E5">you know we've got our default case here</font>

343
00:15:28,000 --> 00:15:36,399
we didn't match anything so we're going

344
00:15:29,680 --> 00:15:41,349
<font color="#E5E5E5">to just toss there</font><font color="#CCCCCC"> so pretty easy to</font>

345
00:15:36,399 --> 00:15:42,940
<font color="#E5E5E5">work your way through there</font><font color="#CCCCCC"> or loops are</font>

346
00:15:41,350 --> 00:15:48,670
<font color="#E5E5E5">the same kind of thing now this is kind</font>

347
00:15:42,940 --> 00:15:51,399
<font color="#CCCCCC">of an</font><font color="#E5E5E5"> interesting or loop I want to</font>

348
00:15:48,670 --> 00:15:58,120
point<font color="#E5E5E5"> something out</font><font color="#CCCCCC"> here we're going</font><font color="#E5E5E5"> to</font>

349
00:15:51,399 --> 00:16:01,329
do a for<font color="#CCCCCC"> loop over</font><font color="#E5E5E5"> pairs of this</font>

350
00:15:58,120 --> 00:16:03,730
response cookies so we've got on we've

351
00:16:01,329 --> 00:16:05,319
done an HTTP request<font color="#E5E5E5"> we've gotten a</font>

352
00:16:03,730 --> 00:16:06,819
response<font color="#E5E5E5"> back we're extracting the</font>

353
00:16:05,319 --> 00:16:08,500
cookies<font color="#CCCCCC"> out of it we may have more than</font>

354
00:16:06,819 --> 00:16:11,199
<font color="#CCCCCC">one cookie</font><font color="#E5E5E5"> we probably have</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> than</font>

355
00:16:08,500 --> 00:16:14,019
one cookie<font color="#CCCCCC"> and we want to print</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> what</font>

356
00:16:11,199 --> 00:16:15,819
that<font color="#CCCCCC"> value is this theta when you run it</font>

357
00:16:14,019 --> 00:16:17,740
in pairs is going to come<font color="#E5E5E5"> out with index</font>

358
00:16:15,819 --> 00:16:19,719
and then the value well I don't care

359
00:16:17,740 --> 00:16:22,420
about the index I'm not going to use

360
00:16:19,720 --> 00:16:23,550
<font color="#E5E5E5">that we was answer that is fine just use</font>

361
00:16:22,420 --> 00:16:26,800
an underscore

362
00:16:23,550 --> 00:16:28,510
<font color="#E5E5E5">so underscore comma cookies which</font>

363
00:16:26,800 --> 00:16:30,849
basically is kind<font color="#CCCCCC"> of like tosses it out</font>

364
00:16:28,510 --> 00:16:34,180
<font color="#CCCCCC">into the trash over here yes we've</font>

365
00:16:30,850 --> 00:16:36,100
syntactically made the correct call but

366
00:16:34,180 --> 00:16:39,279
I don't care<font color="#E5E5E5"> about the indexes just</font>

367
00:16:36,100 --> 00:16:43,540
giving my data<font color="#CCCCCC"> which is</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> something I</font>

368
00:16:39,279 --> 00:16:45,790
<font color="#CCCCCC">have really run into</font><font color="#E5E5E5"> much before so that</font>

369
00:16:43,540 --> 00:16:48,189
caught my attention<font color="#CCCCCC"> you can go ahead</font>

370
00:16:45,790 --> 00:16:56,040
<font color="#E5E5E5">into the other process of saying hey you</font>

371
00:16:48,189 --> 00:16:59,319
know if this<font color="#E5E5E5"> or excuse me like a for</font>

372
00:16:56,040 --> 00:17:01,180
this<font color="#E5E5E5"> condition and is true you know</font>

373
00:16:59,319 --> 00:17:04,250
something some value is less<font color="#CCCCCC"> than ten or</font>

374
00:17:01,180 --> 00:17:08,119
<font color="#E5E5E5">whatever it is loop until</font>

375
00:17:04,250 --> 00:17:09,619
you know it's no longer<font color="#E5E5E5"> less than</font><font color="#CCCCCC"> ten</font><font color="#E5E5E5"> in</font>

376
00:17:08,119 --> 00:17:11,688
<font color="#E5E5E5">this case</font><font color="#CCCCCC"> though I</font><font color="#E5E5E5"> just want to use one</font>

377
00:17:09,619 --> 00:17:20,000
of their their<font color="#E5E5E5"> built-in functions here</font>

378
00:17:11,689 --> 00:17:26,230
<font color="#CCCCCC">for pairs while loops are pretty much</font>

379
00:17:20,000 --> 00:17:34,789
the<font color="#E5E5E5"> same thing wallet</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> we declare our</font>

380
00:17:26,230 --> 00:17:39,440
<font color="#E5E5E5">iterator variable while a it has some</font>

381
00:17:34,789 --> 00:17:40,750
elements<font color="#CCCCCC"> of I do whatever</font><font color="#E5E5E5"> in this case</font>

382
00:17:39,440 --> 00:17:43,580
we're just going<font color="#CCCCCC"> to print</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> that</font>

383
00:17:40,750 --> 00:17:47,600
element inside<font color="#CCCCCC"> of the array and then</font>

384
00:17:43,580 --> 00:17:49,699
we'll increment the<font color="#E5E5E5"> iterator variable</font>

385
00:17:47,600 --> 00:17:57,168
<font color="#E5E5E5">and then when we're done</font><font color="#CCCCCC"> we just mark</font><font color="#E5E5E5"> it</font>

386
00:17:49,700 --> 00:18:00,169
as in I don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> that's a good</font>

387
00:17:57,169 --> 00:18:01,669
<font color="#CCCCCC">question I didn't look at that I ran</font>

388
00:18:00,169 --> 00:18:03,470
into it once I thought<font color="#E5E5E5"> about it and I</font>

389
00:18:01,669 --> 00:18:06,909
didn't<font color="#E5E5E5"> really look it up and follow up</font>

390
00:18:03,470 --> 00:18:06,909
that's<font color="#E5E5E5"> a good question</font>

391
00:18:07,299 --> 00:18:13,668
so yeah<font color="#E5E5E5"> I'm second and by the way if you</font>

392
00:18:12,200 --> 00:18:16,159
<font color="#E5E5E5">guys do have any questions</font><font color="#CCCCCC"> throughout</font>

393
00:18:13,669 --> 00:18:18,409
this please feel<font color="#CCCCCC"> free to</font><font color="#E5E5E5"> fire way in the</font>

394
00:18:16,159 --> 00:18:23,630
middle<font color="#CCCCCC"> of it</font><font color="#E5E5E5"> doesn't bother me in the</font>

395
00:18:18,409 --> 00:18:27,980
slightest<font color="#CCCCCC"> okay so</font><font color="#E5E5E5"> that's</font><font color="#CCCCCC"> just some basic</font>

396
00:18:23,630 --> 00:18:29,630
and it's our<font color="#CCCCCC"> lewis syntax my</font><font color="#E5E5E5"> col and</font>

397
00:18:27,980 --> 00:18:31,610
covering that<font color="#E5E5E5"> quickly was just so that</font>

398
00:18:29,630 --> 00:18:34,400
as we're going<font color="#CCCCCC"> through</font><font color="#E5E5E5"> things you can</font>

399
00:18:31,610 --> 00:18:40,809
<font color="#CCCCCC">kind of see you know</font><font color="#E5E5E5"> have a foundation</font>

400
00:18:34,400 --> 00:18:40,809
on what we're what you're looking at

401
00:18:43,460 --> 00:18:45,520
you

402
00:18:46,270 --> 00:18:53,480
<font color="#E5E5E5">okay every</font><font color="#CCCCCC"> NSC script</font><font color="#E5E5E5"> has three</font>

403
00:18:49,760 --> 00:18:57,680
<font color="#CCCCCC">components to it you've got the</font><font color="#E5E5E5"> head the</font>

404
00:18:53,480 --> 00:19:00,350
rule<font color="#E5E5E5"> and then the action and I've done</font>

405
00:18:57,680 --> 00:19:02,990
this useless looking example up here

406
00:19:00,350 --> 00:19:07,280
<font color="#CCCCCC">that actually doesn't</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> because I'm</font>

407
00:19:02,990 --> 00:19:08,840
not<font color="#CCCCCC"> doing anything but we start off with</font>

408
00:19:07,280 --> 00:19:11,030
<font color="#E5E5E5">the head this is where we're going</font><font color="#CCCCCC"> to do</font>

409
00:19:08,840 --> 00:19:14,330
<font color="#CCCCCC">our imports</font><font color="#E5E5E5"> we want to import this</font>

410
00:19:11,030 --> 00:19:17,870
particular library<font color="#CCCCCC"> we want to give our</font>

411
00:19:14,330 --> 00:19:20,330
description<font color="#CCCCCC"> of it</font><font color="#E5E5E5"> what is</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> that this</font>

412
00:19:17,870 --> 00:19:22,040
<font color="#E5E5E5">NS</font><font color="#CCCCCC"> skis NSE script is trying to</font>

413
00:19:20,330 --> 00:19:23,750
accomplish

414
00:19:22,040 --> 00:19:28,420
that's actually picked up by the NSC

415
00:19:23,750 --> 00:19:30,320
<font color="#CCCCCC">docks engine</font><font color="#E5E5E5"> and used for documentation</font>

416
00:19:28,420 --> 00:19:32,450
<font color="#CCCCCC">we're going to take a look at categories</font>

417
00:19:30,320 --> 00:19:35,870
<font color="#E5E5E5">here in a moment</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the things</font>

418
00:19:32,450 --> 00:19:38,480
that<font color="#CCCCCC"> nmap does is it has a concept of</font>

419
00:19:35,870 --> 00:19:42,939
categories that<font color="#CCCCCC"> a</font><font color="#E5E5E5"> and it can be more</font>

420
00:19:38,480 --> 00:19:42,940
<font color="#CCCCCC">than one I could have this is safe and</font>

421
00:19:45,190 --> 00:19:50,900
default<font color="#E5E5E5"> there you go</font>

422
00:19:47,110 --> 00:19:53,899
safe<font color="#CCCCCC"> an</font><font color="#E5E5E5"> the default category and what</font>

423
00:19:50,900 --> 00:19:55,730
that tells<font color="#E5E5E5"> in math is hey we've just</font>

424
00:19:53,900 --> 00:19:58,070
enabled all of the scripts and this

425
00:19:55,730 --> 00:19:59,480
script happens to apply and it's safe so

426
00:19:58,070 --> 00:20:04,419
we're<font color="#E5E5E5"> not going to crash any something</font>

427
00:19:59,480 --> 00:20:07,640
so awesome<font color="#E5E5E5"> go ahead and run it</font><font color="#CCCCCC"> if it's</font>

428
00:20:04,420 --> 00:20:09,770
intrusive<font color="#E5E5E5"> or a denial of</font><font color="#CCCCCC"> service or a</font>

429
00:20:07,640 --> 00:20:12,970
brute<font color="#CCCCCC"> force or something like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> and</font>

430
00:20:09,770 --> 00:20:14,810
map is not<font color="#E5E5E5"> going to run that</font>

431
00:20:12,970 --> 00:20:17,090
automatically because the last thing<font color="#E5E5E5"> it</font>

432
00:20:14,810 --> 00:20:18,919
<font color="#CCCCCC">wants to do is have somebody</font><font color="#E5E5E5"> turn they</font>

433
00:20:17,090 --> 00:20:20,209
want to do is have somebody turn this

434
00:20:18,920 --> 00:20:21,470
thing<font color="#E5E5E5"> loose on their environment and</font>

435
00:20:20,210 --> 00:20:24,050
<font color="#E5E5E5">then crash their web form or whatever</font>

436
00:20:21,470 --> 00:20:27,770
<font color="#E5E5E5">all at once you know it would make for</font><font color="#CCCCCC"> a</font>

437
00:20:24,050 --> 00:20:30,649
<font color="#E5E5E5">pretty miserable day</font><font color="#CCCCCC"> then we get into</font>

438
00:20:27,770 --> 00:20:32,750
<font color="#E5E5E5">the rule the rule is basically what</font>

439
00:20:30,650 --> 00:20:38,080
condition<font color="#E5E5E5"> are we matching that we're</font>

440
00:20:32,750 --> 00:20:43,550
going<font color="#CCCCCC"> to actually</font><font color="#E5E5E5"> do the action so a</font>

441
00:20:38,080 --> 00:20:45,830
quick easy way<font color="#E5E5E5"> of doing this is they've</font>

442
00:20:43,550 --> 00:20:48,110
<font color="#E5E5E5">got a library called short port instead</font>

443
00:20:45,830 --> 00:20:49,720
of notating and<font color="#E5E5E5"> I've got an example</font>

444
00:20:48,110 --> 00:20:54,020
<font color="#E5E5E5">later</font>

445
00:20:49,720 --> 00:20:57,350
yeah the port is<font color="#E5E5E5"> 110 let's say</font><font color="#CCCCCC"> for 3 and</font>

446
00:20:54,020 --> 00:20:59,240
it's got the port is open

447
00:20:57,350 --> 00:21:01,219
then we've got some<font color="#CCCCCC"> other value you know</font>

448
00:20:59,240 --> 00:21:04,610
<font color="#E5E5E5">characteristic that we're</font><font color="#CCCCCC"> looking at in</font>

449
00:21:01,220 --> 00:21:06,590
this<font color="#E5E5E5"> case we can just simply declare it</font>

450
00:21:04,610 --> 00:21:11,080
hey we've got a well-known protocol in

451
00:21:06,590 --> 00:21:13,820
this case HTTP short HTTP<font color="#E5E5E5"> if that's true</font>

452
00:21:11,080 --> 00:21:16,129
port rule<font color="#CCCCCC"> matches</font><font color="#E5E5E5"> we move on to the</font>

453
00:21:13,820 --> 00:21:16,760
action<font color="#CCCCCC"> if there</font><font color="#E5E5E5"> wasn't the</font><font color="#CCCCCC"> webserver</font><font color="#E5E5E5"> on</font>

454
00:21:16,130 --> 00:21:19,130
this thing

455
00:21:16,760 --> 00:21:22,070
it wasn't on port 80 it didn't match

456
00:21:19,130 --> 00:21:24,549
HTTP or what have<font color="#CCCCCC"> you or any</font><font color="#E5E5E5"> other</font>

457
00:21:22,070 --> 00:21:26,600
<font color="#E5E5E5">common web ports and it's going to just</font>

458
00:21:24,549 --> 00:21:29,270
ignore<font color="#E5E5E5"> the</font><font color="#CCCCCC"> rest of the actions it</font>

459
00:21:26,600 --> 00:21:31,250
doesn't apply<font color="#E5E5E5"> and then finally we get</font>

460
00:21:29,270 --> 00:21:33,559
into the action<font color="#E5E5E5"> and we send the host and</font>

461
00:21:31,250 --> 00:21:36,320
the port<font color="#CCCCCC"> number that</font><font color="#E5E5E5"> we're interested in</font>

462
00:21:33,559 --> 00:21:38,960
<font color="#E5E5E5">potentially some more</font><font color="#CCCCCC"> information and we</font>

463
00:21:36,320 --> 00:21:45,100
go do<font color="#CCCCCC"> stuff and</font><font color="#E5E5E5"> then return that result</font>

464
00:21:38,960 --> 00:21:45,100
<font color="#E5E5E5">back</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> and map to give us the output</font>

465
00:21:46,320 --> 00:21:55,090
<font color="#E5E5E5">all right here are</font><font color="#CCCCCC"> all of</font><font color="#E5E5E5"> the different</font>

466
00:21:49,780 --> 00:21:57,280
<font color="#CCCCCC">categories</font><font color="#E5E5E5"> at this point you can see the</font>

467
00:21:55,090 --> 00:21:59,610
dangerous ones up<font color="#CCCCCC"> here right</font><font color="#E5E5E5"> brute brute</font>

468
00:21:57,280 --> 00:22:02,860
force<font color="#E5E5E5"> denial of service exploit</font>

469
00:21:59,610 --> 00:22:05,530
<font color="#E5E5E5">intrusive malware usually refers to</font>

470
00:22:02,860 --> 00:22:08,409
checking for<font color="#CCCCCC"> the presence of malware on</font>

471
00:22:05,530 --> 00:22:13,690
a system so it's not infecting it with

472
00:22:08,410 --> 00:22:15,400
malware<font color="#CCCCCC"> it's a safe script we're</font>

473
00:22:13,690 --> 00:22:17,110
checking<font color="#CCCCCC"> for a vulnerability what have</font>

474
00:22:15,400 --> 00:22:18,550
you<font color="#E5E5E5"> buzzer so we're going to throw a</font>

475
00:22:17,110 --> 00:22:22,120
<font color="#CCCCCC">bunch of crap at this thing to see how</font>

476
00:22:18,550 --> 00:22:24,669
it responds<font color="#E5E5E5"> right</font><font color="#CCCCCC"> you just want to make</font>

477
00:22:22,120 --> 00:22:26,590
<font color="#CCCCCC">sure as you're writing your scripts</font><font color="#E5E5E5"> to</font>

478
00:22:24,670 --> 00:22:27,700
put the category in there that's one of

479
00:22:26,590 --> 00:22:32,020
the requirements<font color="#CCCCCC"> we've got to have that</font>

480
00:22:27,700 --> 00:22:33,970
<font color="#CCCCCC">and make sure</font><font color="#E5E5E5"> it's appropriate to what</font>

481
00:22:32,020 --> 00:22:36,400
it is<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> doing if you're doing</font>

482
00:22:33,970 --> 00:22:37,960
something<font color="#CCCCCC"> that's testing for sequel</font>

483
00:22:36,400 --> 00:22:40,030
injection on a web form in this

484
00:22:37,960 --> 00:22:42,900
application and I would put<font color="#CCCCCC"> that as</font>

485
00:22:40,030 --> 00:22:45,040
<font color="#E5E5E5">intrusive right this is not a safe</font>

486
00:22:42,900 --> 00:22:49,930
necessarily a safe script we could have

487
00:22:45,040 --> 00:22:51,659
bad things happen<font color="#E5E5E5"> potentially but all</font>

488
00:22:49,930 --> 00:23:00,430
I'm doing<font color="#CCCCCC"> is a banner grab well</font><font color="#E5E5E5"> that's</font>

489
00:22:51,660 --> 00:23:03,520
that's<font color="#E5E5E5"> safe enough okay the other thing</font>

490
00:23:00,430 --> 00:23:08,140
that we<font color="#CCCCCC"> have to remember is nmap is a</font>

491
00:23:03,520 --> 00:23:14,950
port scanner so everything it does goes

492
00:23:08,140 --> 00:23:17,050
back to a port<font color="#CCCCCC"> so in this case or the</font>

493
00:23:14,950 --> 00:23:21,280
previous example here<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the short for</font>

494
00:23:17,050 --> 00:23:23,830
HTTP it's going to be port 80<font color="#E5E5E5"> or 443 or</font>

495
00:23:21,280 --> 00:23:26,680
8080<font color="#E5E5E5"> something like that right that's</font>

496
00:23:23,830 --> 00:23:28,870
finding a<font color="#CCCCCC"> webserver</font><font color="#E5E5E5"> it's found an open</font>

497
00:23:26,680 --> 00:23:32,830
port<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> associated</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> that service</font>

498
00:23:28,870 --> 00:23:34,090
<font color="#E5E5E5">and therefore the checks that we're</font>

499
00:23:32,830 --> 00:23:35,679
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to do are actually going</font><font color="#E5E5E5"> to apply</font>

500
00:23:34,090 --> 00:23:37,810
<font color="#CCCCCC">to this thing and</font><font color="#E5E5E5"> then we'll go ahead</font>

501
00:23:35,680 --> 00:23:39,490
<font color="#E5E5E5">and run them and this is</font><font color="#CCCCCC"> a quick script</font>

502
00:23:37,810 --> 00:23:42,370
actually<font color="#CCCCCC"> that I had written</font><font color="#E5E5E5"> we'll take a</font>

503
00:23:39,490 --> 00:23:44,440
look at here a bit<font color="#CCCCCC"> that all it</font><font color="#E5E5E5"> does is</font>

504
00:23:42,370 --> 00:23:46,090
grab the cookie value<font color="#CCCCCC"> hits a webpage and</font>

505
00:23:44,440 --> 00:23:48,130
says hey what cookies got<font color="#E5E5E5"> sent to me and</font>

506
00:23:46,090 --> 00:23:50,350
grabs those now why did I want<font color="#CCCCCC"> to do</font>

507
00:23:48,130 --> 00:23:51,539
that look I want<font color="#E5E5E5"> to do honestly</font><font color="#CCCCCC"> I just</font>

508
00:23:50,350 --> 00:23:53,519
wanted to get

509
00:23:51,539 --> 00:23:55,229
be able<font color="#E5E5E5"> to get the cookie so that I</font>

510
00:23:53,519 --> 00:23:57,779
could then<font color="#E5E5E5"> do an authentication attempt</font>

511
00:23:55,229 --> 00:23:59,460
and use those cookies<font color="#E5E5E5"> let's do something</font>

512
00:23:57,779 --> 00:24:01,559
<font color="#E5E5E5">else as an authenticated</font><font color="#CCCCCC"> user in the</font>

513
00:23:59,460 --> 00:24:03,090
application<font color="#E5E5E5"> and I needed</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> start out by</font>

514
00:24:01,559 --> 00:24:07,710
<font color="#E5E5E5">figuring out how the heck do I get</font>

515
00:24:03,090 --> 00:24:11,970
cookies in the first place<font color="#E5E5E5"> okay but it</font>

516
00:24:07,710 --> 00:24:14,279
all ties back to<font color="#E5E5E5"> to some service</font><font color="#CCCCCC"> so if</font>

517
00:24:11,970 --> 00:24:17,489
you're familiar with<font color="#CCCCCC"> and map results</font>

518
00:24:14,279 --> 00:24:19,409
<font color="#CCCCCC">port state</font><font color="#E5E5E5"> service</font><font color="#CCCCCC"> ATT CP</font><font color="#E5E5E5"> open HTTP that</font>

519
00:24:17,489 --> 00:24:25,349
<font color="#E5E5E5">looks very familiar</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> the four</font>

520
00:24:19,409 --> 00:24:27,769
lines<font color="#E5E5E5"> below that's the script any</font>

521
00:24:25,349 --> 00:24:27,769
questions

522
00:24:27,830 --> 00:24:43,139
can you overwrite so if the service is

523
00:24:40,049 --> 00:24:44,729
on a non-standard port and the check

524
00:24:43,139 --> 00:24:50,899
port failed so it doesn't know what

525
00:24:44,729 --> 00:24:50,899
state it's in or

526
00:24:56,470 --> 00:25:03,710
<font color="#E5E5E5">okay so there's the answer is going</font><font color="#CCCCCC"> to</font>

527
00:25:00,080 --> 00:25:07,399
<font color="#CCCCCC">be kind of it depends if the port rule</font>

528
00:25:03,710 --> 00:25:11,150
is<font color="#E5E5E5"> written in a way that I want to look</font>

529
00:25:07,400 --> 00:25:12,310
<font color="#E5E5E5">at 84</font><font color="#CCCCCC"> 43 and</font><font color="#E5E5E5"> 80 80 or something</font><font color="#CCCCCC"> like</font>

530
00:25:11,150 --> 00:25:15,620
that

531
00:25:12,310 --> 00:25:18,350
nope it didn't match<font color="#CCCCCC"> I'm not going</font><font color="#E5E5E5"> to</font>

532
00:25:15,620 --> 00:25:20,979
look at it<font color="#E5E5E5"> if I'm doing like short port</font>

533
00:25:18,350 --> 00:25:23,240
HTTP<font color="#E5E5E5"> which is doing some service</font>

534
00:25:20,980 --> 00:25:26,540
<font color="#E5E5E5">recognition a little bit and I have</font>

535
00:25:23,240 --> 00:25:28,340
service verification or validation

536
00:25:26,540 --> 00:25:31,040
occurring on this and it<font color="#E5E5E5"> says hey that's</font>

537
00:25:28,340 --> 00:25:32,720
<font color="#E5E5E5">an HTTP server now sure it's on some</font>

538
00:25:31,040 --> 00:25:35,480
stupid<font color="#CCCCCC"> Court like</font><font color="#E5E5E5"> twenty</font><font color="#CCCCCC"> five</font><font color="#E5E5E5"> thousand</font>

539
00:25:32,720 --> 00:25:37,490
<font color="#E5E5E5">and thirty</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> but I still recognize as</font>

540
00:25:35,480 --> 00:25:40,000
an HTTP server<font color="#CCCCCC"> so now it applies that</font>

541
00:25:37,490 --> 00:25:47,890
<font color="#CCCCCC">make sense</font>

542
00:25:40,000 --> 00:25:47,890
good question I<font color="#E5E5E5"> like any others oh okay</font>

543
00:25:48,029 --> 00:25:55,600
<font color="#CCCCCC">alright there are</font><font color="#E5E5E5"> already 128 libraries</font>

544
00:25:52,389 --> 00:26:01,059
specifically written for<font color="#CCCCCC"> NSE that are</font>

545
00:25:55,600 --> 00:26:03,219
available<font color="#E5E5E5"> to us I grabbed</font><font color="#CCCCCC"> some of</font><font color="#E5E5E5"> the</font>

546
00:26:01,059 --> 00:26:05,799
more common ones<font color="#E5E5E5"> that I thought hey this</font>

547
00:26:03,220 --> 00:26:08,409
might be useful<font color="#E5E5E5"> on a more regular basis</font>

548
00:26:05,799 --> 00:26:11,408
to display up here<font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to be</font>

549
00:26:08,409 --> 00:26:13,330
dealing<font color="#CCCCCC"> with files potentially so we've</font>

550
00:26:11,409 --> 00:26:14,860
got the<font color="#E5E5E5"> data file library we're going to</font>

551
00:26:13,330 --> 00:26:19,480
be doing<font color="#E5E5E5"> with</font><font color="#CCCCCC"> brute-force attacks</font>

552
00:26:14,860 --> 00:26:21,340
there's a library<font color="#CCCCCC"> for brute force hey</font>

553
00:26:19,480 --> 00:26:22,869
I'm<font color="#E5E5E5"> in a Windows environment and so we</font>

554
00:26:21,340 --> 00:26:24,668
want<font color="#E5E5E5"> to do a lot of stuff with SMB</font>

555
00:26:22,869 --> 00:26:27,158
there's a full<font color="#CCCCCC"> library</font><font color="#E5E5E5"> written for</font><font color="#CCCCCC"> that</font>

556
00:26:24,669 --> 00:26:29,730
<font color="#E5E5E5">and there's a whole bunch of scripts</font>

557
00:26:27,159 --> 00:26:32,529
written for that<font color="#E5E5E5"> as well</font>

558
00:26:29,730 --> 00:26:35,559
they're geared up specifically at SMB

559
00:26:32,529 --> 00:26:38,980
checks<font color="#CCCCCC"> a guy I know named Ron Bo's</font>

560
00:26:35,559 --> 00:26:40,889
actually wrote most of<font color="#E5E5E5"> those and he</font>

561
00:26:38,980 --> 00:26:46,539
spent a bunch of time researching<font color="#E5E5E5"> and</font>

562
00:26:40,889 --> 00:26:49,689
figuring out how<font color="#CCCCCC"> to query or send you</font>

563
00:26:46,539 --> 00:26:51,940
know<font color="#E5E5E5"> request to the SMB service and get</font>

564
00:26:49,690 --> 00:26:54,279
a<font color="#E5E5E5"> response back in some way that makes</font>

565
00:26:51,940 --> 00:26:58,029
<font color="#CCCCCC">sense it was kind of</font><font color="#E5E5E5"> funny we were</font>

566
00:26:54,279 --> 00:27:00,879
talking<font color="#E5E5E5"> about this thing at Derby Con</font>

567
00:26:58,029 --> 00:27:02,499
last year the year<font color="#CCCCCC"> before</font><font color="#E5E5E5"> and he made</font>

568
00:27:00,879 --> 00:27:03,850
the<font color="#CCCCCC"> comic</font><font color="#E5E5E5"> says yeah if I was not to do</font>

569
00:27:02,499 --> 00:27:05,710
that again I'd have<font color="#E5E5E5"> to relearn a whole</font>

570
00:27:03,850 --> 00:27:07,559
bunch of stuff<font color="#E5E5E5"> like</font><font color="#CCCCCC"> any scripting</font>

571
00:27:05,710 --> 00:27:10,809
languages to kind of use it or lose it

572
00:27:07,559 --> 00:27:12,399
<font color="#E5E5E5">type of proposition right so you know</font>

573
00:27:10,809 --> 00:27:15,340
you want<font color="#CCCCCC"> to work with this</font><font color="#E5E5E5"> stuff and</font>

574
00:27:12,399 --> 00:27:16,959
<font color="#E5E5E5">keep</font><font color="#CCCCCC"> going some of the common ones that</font>

575
00:27:15,340 --> 00:27:18,580
<font color="#CCCCCC">we are going to use though across all</font>

576
00:27:16,960 --> 00:27:21,220
scripts<font color="#CCCCCC"> that are useful</font>

577
00:27:18,580 --> 00:27:24,639
we've got I've kind of bolded here<font color="#E5E5E5"> the</font>

578
00:27:21,220 --> 00:27:30,190
the<font color="#CCCCCC"> nmap</font><font color="#E5E5E5"> library the</font><font color="#CCCCCC"> NSC debug short</font>

579
00:27:24,639 --> 00:27:35,049
port STD STD<font color="#E5E5E5"> NSC these are you</font><font color="#CCCCCC"> know just</font>

580
00:27:30,190 --> 00:27:38,549
<font color="#E5E5E5">some kind of standard libraries to aid</font>

581
00:27:35,049 --> 00:27:38,549
us in our scripting

582
00:27:40,169 --> 00:27:44,879
<font color="#E5E5E5">now one interesting</font><font color="#CCCCCC"> one I wanted</font><font color="#E5E5E5"> to</font>

583
00:27:42,339 --> 00:27:47,289
<font color="#E5E5E5">point out here</font><font color="#CCCCCC"> you've got the UN PWD</font>

584
00:27:44,879 --> 00:27:49,208
database username and password database

585
00:27:47,289 --> 00:27:51,119
<font color="#CCCCCC">you're doing a</font><font color="#E5E5E5"> brute-force attack they</font>

586
00:27:49,209 --> 00:27:53,679
actually have a password<font color="#E5E5E5"> database</font>

587
00:27:51,119 --> 00:27:55,869
functionality built into<font color="#E5E5E5"> it already so</font>

588
00:27:53,679 --> 00:27:58,419
you can just call<font color="#E5E5E5"> that</font><font color="#CCCCCC"> and use that</font>

589
00:27:55,869 --> 00:28:01,928
<font color="#E5E5E5">instead so that's that's</font><font color="#CCCCCC"> potentially</font>

590
00:27:58,419 --> 00:28:06,159
<font color="#E5E5E5">very handy we've already seen this in</font>

591
00:28:01,929 --> 00:28:07,329
<font color="#CCCCCC">the in the head of</font><font color="#E5E5E5"> the NSE scripts this</font>

592
00:28:06,159 --> 00:28:10,179
is where we're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> our imports</font>

593
00:28:07,329 --> 00:28:12,249
typically we can do them later<font color="#E5E5E5"> but I can</font>

594
00:28:10,179 --> 00:28:15,699
mention we do them all up front<font color="#CCCCCC"> so in</font>

595
00:28:12,249 --> 00:28:23,709
this case we're calling new HTTP short

596
00:28:15,699 --> 00:28:26,769
port and SD standard embassy<font color="#CCCCCC"> alright</font>

597
00:28:23,709 --> 00:28:31,949
<font color="#E5E5E5">next</font><font color="#CCCCCC"> off of the port rules now we've</font>

598
00:28:26,769 --> 00:28:34,209
seen<font color="#E5E5E5"> the easy way</font><font color="#CCCCCC"> write</font><font color="#E5E5E5"> short port HTTP</font>

599
00:28:31,949 --> 00:28:36,629
fabulous that's that's nice and easy to

600
00:28:34,209 --> 00:28:39,849
remember<font color="#E5E5E5"> okay here's a more complex one</font>

601
00:28:36,629 --> 00:28:44,589
<font color="#E5E5E5">so instead we're going</font><font color="#CCCCCC"> to say okay and</font>

602
00:28:39,849 --> 00:28:47,439
the port<font color="#E5E5E5"> rule is now a</font><font color="#CCCCCC"> function and the</font>

603
00:28:44,589 --> 00:28:49,329
off port we're going to<font color="#E5E5E5"> validate this</font>

604
00:28:47,440 --> 00:28:57,639
it's going<font color="#E5E5E5"> to be on port 1 1 3 where you</font>

605
00:28:49,329 --> 00:29:05,529
looking<font color="#CCCCCC"> at ID identity identity can't</font>

606
00:28:57,639 --> 00:29:08,049
talk<font color="#E5E5E5"> so the port is 1 1 3 it's on TCP we</font>

607
00:29:05,529 --> 00:29:13,269
get the state of all of that<font color="#CCCCCC"> is the port</font>

608
00:29:08,049 --> 00:29:16,239
open<font color="#E5E5E5"> is it the identity identity service</font>

609
00:29:13,269 --> 00:29:19,989
is that open<font color="#E5E5E5"> and as the</font><font color="#CCCCCC"> port's the TCP</font>

610
00:29:16,239 --> 00:29:25,059
port open to do the port rule<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> get</font>

611
00:29:19,989 --> 00:29:26,229
more<font color="#E5E5E5"> complex so this is where you kind</font>

612
00:29:25,059 --> 00:29:29,408
of going<font color="#E5E5E5"> back to what</font><font color="#CCCCCC"> you were talking</font>

613
00:29:26,229 --> 00:29:30,699
<font color="#CCCCCC">about</font><font color="#E5E5E5"> is where we can give ourselves a</font>

614
00:29:29,409 --> 00:29:35,199
<font color="#E5E5E5">lot of room or write ourselves into a</font>

615
00:29:30,699 --> 00:29:36,789
<font color="#CCCCCC">corner but nothing else will happen</font><font color="#E5E5E5"> if</font>

616
00:29:35,199 --> 00:29:38,619
<font color="#E5E5E5">this doesn't match this doesn't come</font>

617
00:29:36,789 --> 00:29:41,408
back true that yep we match all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> these</font>

618
00:29:38,619 --> 00:29:44,039
conditions<font color="#E5E5E5"> then the</font><font color="#CCCCCC"> action never</font>

619
00:29:41,409 --> 00:29:44,039
actually<font color="#E5E5E5"> runs</font>

620
00:29:44,330 --> 00:29:48,419
this is like I<font color="#E5E5E5"> said this is the shorter</font>

621
00:29:46,470 --> 00:29:53,370
way of<font color="#E5E5E5"> doing it yeah different services</font>

622
00:29:48,420 --> 00:29:57,300
look at the<font color="#CCCCCC"> NSE</font><font color="#E5E5E5"> Docs and see what you</font>

623
00:29:53,370 --> 00:30:00,030
<font color="#E5E5E5">have available to you okay now we're</font>

624
00:29:57,300 --> 00:30:01,889
getting<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the part where I'm decided to</font>

625
00:30:00,030 --> 00:30:04,980
try and be a little gutsy<font color="#E5E5E5"> and we're</font>

626
00:30:01,890 --> 00:30:07,710
going to just open<font color="#CCCCCC"> up and terminal and a</font>

627
00:30:04,980 --> 00:30:12,900
text editor and<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> got my cheat</font><font color="#CCCCCC"> sheet</font>

628
00:30:07,710 --> 00:30:15,320
on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> side so I get stuck I'll have</font>

629
00:30:12,900 --> 00:30:15,320
somewhere to go

630
00:30:15,770 --> 00:30:17,830
you

631
00:30:23,270 --> 00:30:25,330
you

632
00:30:29,200 --> 00:30:31,260
<font color="#E5E5E5">you</font>

633
00:30:34,920 --> 00:30:37,920
<font color="#E5E5E5">right</font>

634
00:30:41,700 --> 00:30:43,760
you

635
00:31:07,620 --> 00:31:09,649
<font color="#E5E5E5">a</font>

636
00:31:12,529 --> 00:31:19,309
is that readable back there at all<font color="#CCCCCC"> I</font>

637
00:31:16,129 --> 00:31:19,309
didn't think so

638
00:31:21,240 --> 00:31:23,300
you

639
00:31:26,620 --> 00:31:35,080
you

640
00:31:28,240 --> 00:31:37,580
there we go<font color="#E5E5E5"> how we doing all</font><font color="#CCCCCC"> right</font>

641
00:31:35,080 --> 00:31:39,110
and if I start<font color="#E5E5E5"> getting things too low on</font>

642
00:31:37,580 --> 00:31:42,250
the<font color="#E5E5E5"> screen I need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> raise things up let</font>

643
00:31:39,110 --> 00:31:42,250
me<font color="#E5E5E5"> know so I'll do that too</font>

644
00:31:44,860 --> 00:31:49,299
and

645
00:31:46,250 --> 00:31:49,299
[Music]

646
00:31:51,120 --> 00:31:54,498
<font color="#E5E5E5">we'll be the same thing here</font>

647
00:31:59,059 --> 00:32:01,120
you

648
00:32:13,149 --> 00:32:15,209
you

649
00:32:15,500 --> 00:32:20,540
<font color="#E5E5E5">okay that good - on the terminal</font>

650
00:32:21,190 --> 00:32:23,550
<font color="#E5E5E5">okay</font>

651
00:32:25,360 --> 00:32:30,870
so let's try<font color="#CCCCCC"> and write some nmap scripts</font>

652
00:32:28,660 --> 00:32:30,870
here

653
00:32:32,940 --> 00:32:35,570
leggo

654
00:32:37,340 --> 00:32:42,939
so<font color="#E5E5E5"> Chris mentioned that he had</font><font color="#CCCCCC"> them</font>

655
00:32:39,760 --> 00:32:45,010
worthless<font color="#CCCCCC"> and map script or</font><font color="#E5E5E5"> NSC script</font>

656
00:32:42,940 --> 00:32:47,830
possible<font color="#E5E5E5"> I'm actually going to make one</font>

657
00:32:45,010 --> 00:32:49,360
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> more useless than that because it</font>

658
00:32:47,830 --> 00:32:51,820
is<font color="#E5E5E5"> actually did tell you</font><font color="#CCCCCC"> that there was</font>

659
00:32:49,360 --> 00:32:53,229
a port there and that is potentially

660
00:32:51,820 --> 00:32:55,990
useful<font color="#E5E5E5"> even though</font><font color="#CCCCCC"> nmap would have</font>

661
00:32:53,230 --> 00:32:58,090
already<font color="#E5E5E5"> said that anyhow</font>

662
00:32:55,990 --> 00:33:02,620
so let's start<font color="#E5E5E5"> off</font><font color="#CCCCCC"> first thing</font><font color="#E5E5E5"> that we</font>

663
00:32:58,090 --> 00:33:10,689
need is is going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> the head then</font>

664
00:33:02,620 --> 00:33:16,360
we're going to<font color="#E5E5E5"> have rule and then the</font>

665
00:33:10,690 --> 00:33:17,650
action so let's set<font color="#CCCCCC"> that up</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> the first</font>

666
00:33:16,360 --> 00:33:21,959
thing we're going<font color="#E5E5E5"> to need is our</font>

667
00:33:17,650 --> 00:33:21,960
description<font color="#E5E5E5"> of what it this is so</font>

668
00:33:23,520 --> 00:33:32,250
<font color="#E5E5E5">get up in front of</font><font color="#CCCCCC"> a groupie we can type</font>

669
00:33:25,020 --> 00:33:43,160
anyone<font color="#E5E5E5"> all right</font>

670
00:33:32,250 --> 00:33:43,160
and we'll say<font color="#E5E5E5"> Liggett</font><font color="#CCCCCC"> Orry</font>

671
00:33:44,280 --> 00:33:59,120
<font color="#CCCCCC">bro sorta what's that oh</font><font color="#E5E5E5"> it does change</font>

672
00:33:55,860 --> 00:33:59,120
<font color="#CCCCCC">the meeting</font><font color="#E5E5E5"> a little bit the myth</font>

673
00:34:00,670 --> 00:34:05,620
however you can<font color="#CCCCCC"> argue that that might</font>

674
00:34:02,230 --> 00:34:10,480
apply<font color="#CCCCCC"> particularly the demo gods decide</font>

675
00:34:05,620 --> 00:34:11,799
that they don't<font color="#CCCCCC"> like me very much there</font>

676
00:34:10,480 --> 00:34:13,210
are other things<font color="#E5E5E5"> you can put in</font><font color="#CCCCCC"> here you</font>

677
00:34:11,800 --> 00:34:18,300
can say you<font color="#E5E5E5"> know just for informational</font>

678
00:34:13,210 --> 00:34:18,300
purposes<font color="#E5E5E5"> I can say hey the author is me</font>

679
00:34:18,510 --> 00:34:23,649
<font color="#CCCCCC">but we do</font><font color="#E5E5E5"> that's not you know we don't</font>

680
00:34:21,520 --> 00:34:26,250
have<font color="#E5E5E5"> to have that we do need the</font>

681
00:34:23,649 --> 00:34:26,250
categories

682
00:34:29,119 --> 00:34:32,990
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right yes okay this is going to be</font>

683
00:34:31,369 --> 00:34:34,429
safe because all we're doing is hello

684
00:34:32,989 --> 00:34:36,609
world<font color="#E5E5E5"> so this isn't particularly</font>

685
00:34:34,429 --> 00:34:36,609
dangerous

686
00:34:38,529 --> 00:34:45,399
fabulous<font color="#E5E5E5"> and then we're going to have</font>

687
00:34:41,839 --> 00:34:45,399
our port rule

688
00:34:45,820 --> 00:34:47,880
you

689
00:34:50,850 --> 00:34:56,889
<font color="#E5E5E5">okay now I've got a web store</font>

690
00:34:52,940 --> 00:35:00,470
or that we're<font color="#CCCCCC"> going to hit this</font><font color="#E5E5E5"> with and</font>

691
00:34:56,889 --> 00:35:06,940
because I'm using short<font color="#CCCCCC"> Court you could</font>

692
00:35:00,470 --> 00:35:09,618
go back up<font color="#CCCCCC"> here to</font><font color="#E5E5E5"> the top and say local</font>

693
00:35:06,940 --> 00:35:11,930
<font color="#E5E5E5">short court because we're</font><font color="#CCCCCC"> just limiting</font>

694
00:35:09,619 --> 00:35:13,069
this to<font color="#CCCCCC"> this</font><font color="#E5E5E5"> particular</font><font color="#CCCCCC"> script we're</font>

695
00:35:11,930 --> 00:35:25,149
declaring<font color="#E5E5E5"> it for this block of code</font>

696
00:35:13,069 --> 00:35:25,150
<font color="#E5E5E5">short port is equal to</font><font color="#CCCCCC"> wire fabulous</font>

697
00:35:34,340 --> 00:35:37,490
oh yeah that was supposed to be an

698
00:35:35,720 --> 00:35:40,669
<font color="#CCCCCC">assignment thank you</font>

699
00:35:37,490 --> 00:35:41,509
that would have exploded in my face in

700
00:35:40,670 --> 00:35:43,460
just<font color="#CCCCCC"> a moment</font>

701
00:35:41,510 --> 00:35:47,180
which I guarantee<font color="#E5E5E5"> I'm going to do a</font>

702
00:35:43,460 --> 00:35:49,850
couple<font color="#CCCCCC"> of times while we're up here</font><font color="#E5E5E5"> all</font>

703
00:35:47,180 --> 00:35:52,040
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so now we've got the head</font>

704
00:35:49,850 --> 00:35:53,779
completed we've got the port rule set up

705
00:35:52,040 --> 00:35:57,770
<font color="#E5E5E5">the action is going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be pretty simple</font>

706
00:35:53,780 --> 00:36:01,700
<font color="#CCCCCC">where I say action is a</font><font color="#E5E5E5"> oops</font>

707
00:35:57,770 --> 00:36:04,780
to a function we're going<font color="#CCCCCC"> to set up the</font>

708
00:36:01,700 --> 00:36:04,779
<font color="#E5E5E5">host and the port</font>

709
00:36:06,230 --> 00:36:09,230
and

710
00:36:10,740 --> 00:36:16,250
cool<font color="#E5E5E5"> call some variable called</font>

711
00:36:20,010 --> 00:36:31,670
hi there is equal to hello everyone<font color="#E5E5E5"> and</font>

712
00:36:28,670 --> 00:36:34,080
then we're going<font color="#E5E5E5"> to return</font>

713
00:36:31,670 --> 00:36:38,030
hi there we've got<font color="#CCCCCC"> to send</font><font color="#E5E5E5"> that back</font><font color="#CCCCCC"> to</font>

714
00:36:34,080 --> 00:36:43,200
the scanning engine and then we<font color="#CCCCCC"> end it</font>

715
00:36:38,030 --> 00:36:59,280
then we've got to save this<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't want</font>

716
00:36:43,200 --> 00:37:02,390
to save<font color="#E5E5E5"> it</font><font color="#CCCCCC"> to that directory where soon</font>

717
00:36:59,280 --> 00:37:02,390
as the trouble<font color="#CCCCCC"> about having us</font><font color="#E5E5E5"> out</font>

718
00:37:07,030 --> 00:37:25,590
<font color="#E5E5E5">a world NSE and</font><font color="#CCCCCC"> save it such over to our</font>

719
00:37:18,460 --> 00:37:25,590
<font color="#CCCCCC">command line so we'll see over to</font>

720
00:37:30,900 --> 00:37:37,840
<font color="#CCCCCC">alright here's our</font><font color="#E5E5E5"> NSE script and my</font>

721
00:37:36,160 --> 00:37:40,950
Webster<font color="#E5E5E5"> will need double check and make</font>

722
00:37:37,840 --> 00:37:40,950
<font color="#CCCCCC">sure in the right IP address</font>

723
00:37:42,670 --> 00:37:49,070
perfect<font color="#E5E5E5"> so I have a web</font>

724
00:37:45,450 --> 00:37:49,069
VM run here just with<font color="#E5E5E5"> a website</font><font color="#CCCCCC"> on him</font>

725
00:37:51,349 --> 00:37:59,579
you<font color="#E5E5E5"> don't have to</font><font color="#CCCCCC"> I drew</font><font color="#E5E5E5"> it in this case</font>

726
00:37:56,130 --> 00:38:01,530
because<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is outside</font><font color="#E5E5E5"> of the standard</font>

727
00:37:59,579 --> 00:38:05,880
install<font color="#E5E5E5"> location if I copied this file</font>

728
00:38:01,530 --> 00:38:07,770
to user local share and map scripts<font color="#E5E5E5"> then</font>

729
00:38:05,880 --> 00:38:09,599
I wouldn't have<font color="#CCCCCC"> to I could run in</font><font color="#E5E5E5"> map</font>

730
00:38:07,770 --> 00:38:11,849
<font color="#E5E5E5">from anywhere and it would just no go</font>

731
00:38:09,599 --> 00:38:14,430
look<font color="#E5E5E5"> here for my scripts because</font><font color="#CCCCCC"> this is</font>

732
00:38:11,849 --> 00:38:16,560
a custom written<font color="#E5E5E5"> script and I've got to</font>

733
00:38:14,430 --> 00:38:19,589
say somewhere<font color="#E5E5E5"> on the file system</font><font color="#CCCCCC"> I</font>

734
00:38:16,560 --> 00:38:22,578
either have<font color="#CCCCCC"> to specify</font><font color="#E5E5E5"> the path to it or</font>

735
00:38:19,589 --> 00:38:27,630
I have<font color="#E5E5E5"> to run it from that directory</font>

736
00:38:22,579 --> 00:38:29,490
<font color="#E5E5E5">so-and-so will do n map</font><font color="#CCCCCC"> we're not going</font>

737
00:38:27,630 --> 00:38:33,960
to try<font color="#E5E5E5"> and enumerate all</font><font color="#CCCCCC"> the ports</font><font color="#E5E5E5"> in</font>

738
00:38:29,490 --> 00:38:35,459
the world<font color="#E5E5E5"> on this thing</font><font color="#CCCCCC"> 480 - - script</font>

739
00:38:33,960 --> 00:38:40,380
<font color="#E5E5E5">because we can want one particular</font>

740
00:38:35,460 --> 00:38:43,290
script and it's called hello world you

741
00:38:40,380 --> 00:38:45,119
don't typically call it with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> dot NS e</font>

742
00:38:43,290 --> 00:38:47,339
on the end<font color="#E5E5E5"> of it</font>

743
00:38:45,119 --> 00:38:49,619
in<font color="#E5E5E5"> this case I get autocomplete so it</font>

744
00:38:47,339 --> 00:39:01,190
tried to<font color="#CCCCCC"> add</font><font color="#E5E5E5"> it in and then our IP</font>

745
00:38:49,619 --> 00:39:01,190
<font color="#E5E5E5">address is 170 216 165</font><font color="#CCCCCC"> dot 142 ok</font>

746
00:39:01,580 --> 00:39:09,730
and just for grins<font color="#CCCCCC"> we're going to add</font>

747
00:39:06,230 --> 00:39:12,170
the<font color="#CCCCCC"> dash</font><font color="#E5E5E5"> D to our command which is debug</font>

748
00:39:09,730 --> 00:39:14,990
because<font color="#E5E5E5"> you're going to want this this</font>

749
00:39:12,170 --> 00:39:18,080
<font color="#E5E5E5">one I think we're pretty</font><font color="#CCCCCC"> safe on but as</font>

750
00:39:14,990 --> 00:39:20,060
I'm writing things you get syntax errors

751
00:39:18,080 --> 00:39:21,920
and crap like<font color="#CCCCCC"> that all Sutton</font><font color="#E5E5E5"> without</font>

752
00:39:20,060 --> 00:39:24,350
running the -<font color="#CCCCCC"> D - just explode</font><font color="#E5E5E5"> there's</font>

753
00:39:21,920 --> 00:39:28,490
no didn't work<font color="#E5E5E5"> add this now you find out</font>

754
00:39:24,350 --> 00:39:30,830
<font color="#E5E5E5">what the syntax error was okay it</font>

755
00:39:28,490 --> 00:39:32,959
actually<font color="#CCCCCC"> works</font><font color="#E5E5E5"> so we get a whole lot</font><font color="#CCCCCC"> of</font>

756
00:39:30,830 --> 00:39:40,430
<font color="#CCCCCC">skew from from</font><font color="#E5E5E5"> nmap</font><font color="#CCCCCC"> let's get rid of</font>

757
00:39:32,960 --> 00:39:42,620
<font color="#E5E5E5">that - D okay</font>

758
00:39:40,430 --> 00:39:45,220
and so we've got<font color="#E5E5E5"> our</font><font color="#CCCCCC"> results</font><font color="#E5E5E5"> key hi</font><font color="#CCCCCC"> did</font>

759
00:39:42,620 --> 00:39:48,500
<font color="#CCCCCC">a script</font><font color="#E5E5E5"> and it worked</font>

760
00:39:45,220 --> 00:39:51,830
fortunately<font color="#E5E5E5"> with some help from my my</font>

761
00:39:48,500 --> 00:39:54,170
editor peer review out here exactly but

762
00:39:51,830 --> 00:39:56,540
sure enough<font color="#CCCCCC"> I have run in the</font><font color="#E5E5E5"> webserver</font>

763
00:39:54,170 --> 00:39:58,640
<font color="#E5E5E5">just</font><font color="#CCCCCC"> like I said I was right and because</font>

764
00:39:56,540 --> 00:40:01,820
we found<font color="#E5E5E5"> that we matched the rule and</font>

765
00:39:58,640 --> 00:40:02,450
then it dumped out hi there or hello

766
00:40:01,820 --> 00:40:04,250
everyone

767
00:40:02,450 --> 00:40:10,100
notice that I didn't<font color="#CCCCCC"> really specify</font>

768
00:40:04,250 --> 00:40:12,050
anything<font color="#E5E5E5"> other than</font><font color="#CCCCCC"> just I didn't format</font>

769
00:40:10,100 --> 00:40:14,150
this at all right I<font color="#CCCCCC"> just had returned</font>

770
00:40:12,050 --> 00:40:16,160
<font color="#E5E5E5">the text back and math did what it did</font>

771
00:40:14,150 --> 00:40:18,410
<font color="#CCCCCC">said hey this came from the hello world</font>

772
00:40:16,160 --> 00:40:20,140
<font color="#CCCCCC">and</font><font color="#E5E5E5"> a C script and there's your results</font>

773
00:40:18,410 --> 00:40:23,060
have fun<font color="#CCCCCC"> okay</font>

774
00:40:20,140 --> 00:40:28,279
<font color="#CCCCCC">alright so that's kind of cool but you</font>

775
00:40:23,060 --> 00:40:31,910
know<font color="#E5E5E5"> not particularly exciting so let's</font>

776
00:40:28,280 --> 00:40:34,300
switch<font color="#E5E5E5"> back and then it will do a new</font>

777
00:40:31,910 --> 00:40:34,299
<font color="#E5E5E5">script</font>

778
00:40:35,230 --> 00:40:37,290
you

779
00:40:38,160 --> 00:40:44,140
we're going to make this one a little

780
00:40:39,820 --> 00:40:45,670
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> more involved okay so we've got I'm</font>

781
00:40:44,140 --> 00:40:51,150
gonna<font color="#E5E5E5"> use short</font><font color="#CCCCCC"> port</font><font color="#E5E5E5"> again because I am</font>

782
00:40:45,670 --> 00:40:51,150
a lazy bum<font color="#CCCCCC"> and I don't</font>

783
00:40:51,940 --> 00:40:55,650
<font color="#CCCCCC">why</font><font color="#E5E5E5"> make things harder for</font><font color="#CCCCCC"> me than I</font>

784
00:40:53,320 --> 00:40:55,650
have to

785
00:40:55,970 --> 00:41:00,598
now we're going to<font color="#CCCCCC"> actually in</font><font color="#E5E5E5"> talk with</font>

786
00:40:58,079 --> 00:41:02,400
<font color="#CCCCCC">the HTTP</font><font color="#E5E5E5"> service we're going to get</font>

787
00:41:00,599 --> 00:41:05,910
<font color="#E5E5E5">something back from it</font><font color="#CCCCCC"> and look</font><font color="#E5E5E5"> at the</font>

788
00:41:02,400 --> 00:41:08,119
results<font color="#CCCCCC"> so we need to import the HTTP</font>

789
00:41:05,910 --> 00:41:08,118
library

790
00:41:11,750 --> 00:41:20,140
oops<font color="#E5E5E5"> acquire HTTP</font><font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to do some</font>

791
00:41:16,670 --> 00:41:20,140
stuff<font color="#CCCCCC"> with the standard NSC</font>

792
00:41:21,090 --> 00:41:24,860
library so we'll<font color="#CCCCCC"> have that here</font>

793
00:41:29,780 --> 00:41:31,840
you

794
00:41:33,539 --> 00:41:40,170
<font color="#E5E5E5">okay so</font><font color="#CCCCCC"> starting off</font><font color="#E5E5E5"> our head give the</font>

795
00:41:37,779 --> 00:41:40,170
description

796
00:41:46,080 --> 00:41:48,140
you

797
00:41:49,040 --> 00:41:52,430
<font color="#E5E5E5">what we're going to do with this script</font>

798
00:41:50,300 --> 00:41:56,150
<font color="#E5E5E5">is we're going to</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> get the cookie</font>

799
00:41:52,430 --> 00:41:59,480
values back from the site<font color="#E5E5E5"> okay now</font>

800
00:41:56,150 --> 00:42:02,630
another<font color="#E5E5E5"> part of the</font><font color="#CCCCCC"> anytime we</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> in do</font>

801
00:41:59,480 --> 00:42:04,940
it a script<font color="#CCCCCC"> that we might distribute</font><font color="#E5E5E5"> to</font>

802
00:42:02,630 --> 00:42:07,310
other people is it's kind<font color="#E5E5E5"> of helpful to</font>

803
00:42:04,940 --> 00:42:09,320
<font color="#E5E5E5">have some kind of guidance here on what</font>

804
00:42:07,310 --> 00:42:12,080
we're supposed to do<font color="#E5E5E5"> write a little bit</font>

805
00:42:09,320 --> 00:42:13,370
<font color="#E5E5E5">of help on on how we're going to run</font>

806
00:42:12,080 --> 00:42:16,160
this so we're going<font color="#E5E5E5"> to add a</font><font color="#CCCCCC"> comment in</font>

807
00:42:13,370 --> 00:42:21,130
here and this feeds into<font color="#E5E5E5"> the NSC dots as</font>

808
00:42:16,160 --> 00:42:22,190
well and give the usage at usage<font color="#E5E5E5"> and</font>

809
00:42:21,130 --> 00:42:25,320
then

810
00:42:22,190 --> 00:42:25,320
[Music]

811
00:42:26,550 --> 00:42:36,570
map our targets

812
00:42:30,370 --> 00:42:40,200
and<font color="#E5E5E5"> - - script and we'll call this</font>

813
00:42:36,570 --> 00:42:40,200
script get cookie

814
00:42:41,539 --> 00:42:45,229
and the just as an<font color="#CCCCCC"> example of</font><font color="#E5E5E5"> what</font>

815
00:42:43,880 --> 00:42:48,289
should<font color="#E5E5E5"> come out we</font><font color="#CCCCCC"> have our</font><font color="#E5E5E5"> example</font>

816
00:42:45,229 --> 00:42:51,069
<font color="#CCCCCC">output that</font><font color="#E5E5E5"> they can expect we'll see</font>

817
00:42:48,289 --> 00:42:51,069
<font color="#CCCCCC">something like</font>

818
00:42:52,200 --> 00:43:02,629
<font color="#E5E5E5">see 680 HTTP open h CP CP</font>

819
00:43:04,360 --> 00:43:06,930
<font color="#CCCCCC">and it</font><font color="#E5E5E5"> will</font><font color="#CCCCCC"> be</font>

820
00:43:08,210 --> 00:43:11,290
<font color="#E5E5E5">check cookie</font>

821
00:43:15,330 --> 00:43:17,390
you

822
00:43:20,970 --> 00:43:23,029
you

823
00:43:27,200 --> 00:43:32,919
<font color="#CCCCCC">all right so there's our usage</font><font color="#E5E5E5"> right so</font>

824
00:43:30,559 --> 00:43:36,970
we've now done a little documentation

825
00:43:32,920 --> 00:43:36,970
<font color="#E5E5E5">got to add our categories</font>

826
00:43:38,540 --> 00:43:44,870
and this is going to be equal to<font color="#E5E5E5"> so what</font>

827
00:43:43,820 --> 00:43:47,650
do you guys<font color="#E5E5E5"> think</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going to hit a</font>

828
00:43:44,870 --> 00:43:51,710
website and grab some cookies<font color="#E5E5E5"> safe</font>

829
00:43:47,650 --> 00:43:54,710
dangerous<font color="#E5E5E5"> intrusive safe</font><font color="#CCCCCC"> yeah we're</font><font color="#E5E5E5"> not</font>

830
00:43:51,710 --> 00:43:57,610
<font color="#E5E5E5">doing anything unusual</font><font color="#CCCCCC"> so we'll go ahead</font>

831
00:43:54,710 --> 00:43:57,610
<font color="#E5E5E5">and call this safe</font>

832
00:43:58,140 --> 00:44:04,350
safe<font color="#E5E5E5"> clip enough are you guys able to</font>

833
00:44:03,450 --> 00:44:08,370
read this down here at the bottom

834
00:44:04,350 --> 00:44:10,110
<font color="#E5E5E5">unknown down there okay</font><font color="#CCCCCC"> all right</font>

835
00:44:08,370 --> 00:44:19,080
and then our port rule we finished the

836
00:44:10,110 --> 00:44:24,440
head court rule short<font color="#CCCCCC"> cord on</font><font color="#E5E5E5"> HTTP</font><font color="#CCCCCC"> and</font>

837
00:44:19,080 --> 00:44:29,150
move on to the action action is<font color="#CCCCCC"> function</font>

838
00:44:24,440 --> 00:44:29,150
<font color="#E5E5E5">we have a host ports</font>

839
00:44:32,400 --> 00:44:37,230
we start<font color="#E5E5E5"> into anything just for</font>

840
00:44:34,720 --> 00:44:37,230
convention

841
00:44:37,590 --> 00:44:39,650
<font color="#E5E5E5">you</font>

842
00:44:42,170 --> 00:44:49,869
so we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to do a local</font><font color="#E5E5E5"> variable of</font>

843
00:44:44,150 --> 00:44:52,520
a response and it's going to<font color="#E5E5E5"> equal</font>

844
00:44:49,869 --> 00:44:55,970
<font color="#E5E5E5">whatever we get back from our</font><font color="#CCCCCC"> webserver</font>

845
00:44:52,520 --> 00:44:58,250
<font color="#E5E5E5">so we're going to do HTTP GET now if I</font>

846
00:44:55,970 --> 00:45:01,939
was<font color="#E5E5E5"> doing a post request with the HTTP</font>

847
00:44:58,250 --> 00:45:02,990
<font color="#CCCCCC">POST so it's pretty</font><font color="#E5E5E5"> straightforward but</font>

848
00:45:01,940 --> 00:45:04,250
<font color="#E5E5E5">the sense we're just hitting the main</font>

849
00:45:02,990 --> 00:45:11,689
page we<font color="#E5E5E5"> don't really have to worry about</font>

850
00:45:04,250 --> 00:45:20,869
<font color="#E5E5E5">anything here and then we're going to</font>

851
00:45:11,690 --> 00:45:26,450
<font color="#E5E5E5">get the host port and we need the</font><font color="#CCCCCC"> Hat</font>

852
00:45:20,869 --> 00:45:29,140
which I didn't declare go back up here

853
00:45:26,450 --> 00:45:29,140
ahead<font color="#CCCCCC"> of that</font>

854
00:45:29,560 --> 00:45:38,410
I'll just say half is equal to we're

855
00:45:34,630 --> 00:45:44,550
just<font color="#E5E5E5"> going to get the root of the web</font>

856
00:45:38,410 --> 00:45:44,549
server<font color="#E5E5E5"> okay and then</font>

857
00:45:47,470 --> 00:45:51,470
so we've got<font color="#E5E5E5"> our response back</font><font color="#CCCCCC"> now we're</font>

858
00:45:49,970 --> 00:45:57,290
going to start<font color="#CCCCCC"> looking for</font><font color="#E5E5E5"> cookies local</font>

859
00:45:51,470 --> 00:46:00,859
cookie jar is equal to just<font color="#CCCCCC"> n declare</font>

860
00:45:57,290 --> 00:46:03,460
this cookie jar<font color="#CCCCCC"> as an array which is</font>

861
00:46:00,859 --> 00:46:05,270
<font color="#E5E5E5">actually a</font><font color="#CCCCCC"> table but it turns out and</font>

862
00:46:03,460 --> 00:46:07,910
then<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> probably</font><font color="#CCCCCC"> if this looks</font>

863
00:46:05,270 --> 00:46:09,230
<font color="#E5E5E5">familiar for underscore comma cookie</font>

864
00:46:07,910 --> 00:46:12,830
<font color="#E5E5E5">because all we're interested in are the</font>

865
00:46:09,230 --> 00:46:15,980
cookies themselves<font color="#E5E5E5"> in pairs pairs like</font>

866
00:46:12,830 --> 00:46:18,680
<font color="#E5E5E5">said iterates over every element</font><font color="#CCCCCC"> in an</font>

867
00:46:15,980 --> 00:46:21,230
array without<font color="#E5E5E5"> the index and the value</font>

868
00:46:18,680 --> 00:46:28,520
assigned to<font color="#E5E5E5"> that so it's just automatic</font>

869
00:46:21,230 --> 00:46:30,880
iterator<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we'll do hoops the</font>

870
00:46:28,520 --> 00:46:30,880
<font color="#CCCCCC">pair's</font>

871
00:46:33,390 --> 00:46:40,279
once we want the cookies<font color="#CCCCCC"> now we're going</font>

872
00:46:37,470 --> 00:46:40,279
<font color="#E5E5E5">to go do something</font>

873
00:46:45,300 --> 00:46:56,230
or work<font color="#E5E5E5"> on our table insert it into our</font>

874
00:46:48,190 --> 00:47:06,160
table called cookie jar<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we'll do</font>

875
00:46:56,230 --> 00:47:07,390
cookie name is equal to and we're<font color="#E5E5E5"> going</font>

876
00:47:06,160 --> 00:47:11,980
to go<font color="#CCCCCC"> and go off the</font><font color="#E5E5E5"> screen</font><font color="#CCCCCC"> here a</font>

877
00:47:07,390 --> 00:47:16,930
little bit<font color="#CCCCCC"> so mess</font><font color="#E5E5E5"> with this cookie name</font>

878
00:47:11,980 --> 00:47:20,830
is equal to now to do string

879
00:47:16,930 --> 00:47:22,600
concatenation<font color="#E5E5E5"> in</font><font color="#CCCCCC"> lua a</font><font color="#E5E5E5"> lot of other</font>

880
00:47:20,830 --> 00:47:23,529
languages<font color="#E5E5E5"> we do you know plus sign or</font>

881
00:47:22,600 --> 00:47:28,029
<font color="#CCCCCC">something like</font><font color="#E5E5E5"> that</font>

882
00:47:23,530 --> 00:47:29,830
<font color="#CCCCCC">lua</font><font color="#E5E5E5"> we just use two dots so just a</font>

883
00:47:28,030 --> 00:47:34,740
little<font color="#E5E5E5"> difference there</font><font color="#CCCCCC"> so dot dot and</font>

884
00:47:29,830 --> 00:47:34,740
then cookie name

885
00:47:35,900 --> 00:47:47,580
you

886
00:47:37,630 --> 00:47:47,580
and I want also<font color="#E5E5E5"> the value of</font><font color="#CCCCCC"> the cookie</font>

887
00:47:48,520 --> 00:47:51,540
you is<font color="#E5E5E5"> equal to</font>

888
00:47:53,410 --> 00:47:57,160
<font color="#E5E5E5">cookies value</font>

889
00:47:58,339 --> 00:48:06,299
and for now we'll<font color="#E5E5E5"> just call that good</font>

890
00:48:01,799 --> 00:48:09,900
I've ran off the ends and screen and our

891
00:48:06,299 --> 00:48:12,720
for<font color="#CCCCCC"> loop and</font><font color="#E5E5E5"> then we're going</font><font color="#CCCCCC"> to return</font>

892
00:48:09,900 --> 00:48:26,460
<font color="#CCCCCC">our results</font><font color="#E5E5E5"> using the standard</font><font color="#CCCCCC"> MSE</font>

893
00:48:12,720 --> 00:48:30,379
library<font color="#E5E5E5"> okay</font>

894
00:48:26,460 --> 00:48:32,940
<font color="#CCCCCC">PR is going to</font><font color="#E5E5E5"> get sent back to</font>

895
00:48:30,380 --> 00:48:37,550
scripting engine and we'll wrap<font color="#E5E5E5"> up our</font>

896
00:48:32,940 --> 00:48:37,550
script<font color="#E5E5E5"> and</font><font color="#CCCCCC"> theoretically</font>

897
00:48:40,750 --> 00:48:42,810
you

898
00:48:42,860 --> 00:48:44,920
you

899
00:48:51,260 --> 00:48:59,420
theoretically<font color="#E5E5E5"> when we run this we'll get</font>

900
00:48:54,900 --> 00:49:01,740
<font color="#E5E5E5">to our values back or cookie values back</font>

901
00:48:59,420 --> 00:49:08,130
so the script is going<font color="#E5E5E5"> to be we're just</font>

902
00:49:01,740 --> 00:49:11,069
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to use the same syntax and math -</font>

903
00:49:08,130 --> 00:49:14,600
<font color="#CCCCCC">p80 script instead</font><font color="#E5E5E5"> of hello</font><font color="#CCCCCC"> world is</font>

904
00:49:11,070 --> 00:49:14,600
going to<font color="#E5E5E5"> be get - cookie</font>

905
00:49:15,530 --> 00:49:17,590
you

906
00:49:20,970 --> 00:49:24,509
<font color="#CCCCCC">plus in our debug flag because there's</font>

907
00:49:22,800 --> 00:49:31,400
lots of opportunity<font color="#CCCCCC"> for me to</font><font color="#E5E5E5"> have</font>

908
00:49:24,510 --> 00:49:34,930
screwed up yeah I got away<font color="#E5E5E5"> with</font><font color="#CCCCCC"> it yeah</font>

909
00:49:31,400 --> 00:49:34,930
[Laughter]

910
00:49:35,180 --> 00:49:40,379
so let's clear it we'll run it again

911
00:49:37,830 --> 00:49:43,110
<font color="#E5E5E5">here with things simplified so I ran it</font>

912
00:49:40,380 --> 00:49:45,360
against<font color="#E5E5E5"> this website it's a wordpress</font>

913
00:49:43,110 --> 00:49:47,970
<font color="#E5E5E5">install that mess around with so we get</font>

914
00:49:45,360 --> 00:49:50,160
the PHP session ID<font color="#E5E5E5"> here's its value I</font>

915
00:49:47,970 --> 00:49:51,779
could<font color="#CCCCCC"> also pull up path and all that</font>

916
00:49:50,160 --> 00:49:56,330
other<font color="#CCCCCC"> stuff that you would need to</font><font color="#E5E5E5"> send</font>

917
00:49:51,780 --> 00:49:59,490
back<font color="#CCCCCC"> to the app or</font><font color="#E5E5E5"> subsequent requests</font>

918
00:49:56,330 --> 00:50:01,020
<font color="#CCCCCC">but there</font><font color="#E5E5E5"> you go</font><font color="#CCCCCC"> that's a we've managed</font>

919
00:49:59,490 --> 00:50:03,120
to<font color="#E5E5E5"> start pulling out</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> cookies so what</font>

920
00:50:01,020 --> 00:50:05,150
are we going to<font color="#E5E5E5"> do from here well we've</font>

921
00:50:03,120 --> 00:50:09,290
got<font color="#E5E5E5"> five minutes left so not a whole lot</font>

922
00:50:05,150 --> 00:50:15,860
<font color="#CCCCCC">I'll show you what I'm looking</font><font color="#E5E5E5"> at doing</font>

923
00:50:09,290 --> 00:50:15,860
and back over<font color="#CCCCCC"> here</font>

924
00:50:20,169 --> 00:50:23,558
<font color="#CCCCCC">let's do it</font><font color="#E5E5E5"> this way</font>

925
00:50:37,140 --> 00:50:39,950
come on

926
00:50:43,589 --> 00:50:59,680
all right it's not<font color="#CCCCCC"> like me please don't</font>

927
00:50:48,790 --> 00:51:02,680
say let's<font color="#CCCCCC"> just do</font><font color="#E5E5E5"> it this way all</font><font color="#CCCCCC"> right</font>

928
00:50:59,680 --> 00:51:04,509
<font color="#E5E5E5">so this is pretty much legible</font><font color="#CCCCCC"> so this</font>

929
00:51:02,680 --> 00:51:06,790
<font color="#CCCCCC">is</font><font color="#E5E5E5"> the script</font><font color="#CCCCCC"> that I'm working</font><font color="#E5E5E5"> on and I</font>

930
00:51:04,510 --> 00:51:09,490
was hoping to<font color="#E5E5E5"> have done and I didn't get</font>

931
00:51:06,790 --> 00:51:12,070
it<font color="#E5E5E5"> done</font><font color="#CCCCCC"> so I'll run</font><font color="#E5E5E5"> it just</font><font color="#CCCCCC"> to show you</font>

932
00:51:09,490 --> 00:51:14,290
what it looks<font color="#E5E5E5"> like is what I have</font>

933
00:51:12,070 --> 00:51:16,030
<font color="#E5E5E5">available</font><font color="#CCCCCC"> so I've got all of my imports</font>

934
00:51:14,290 --> 00:51:18,400
up here the<font color="#E5E5E5"> description of this script</font>

935
00:51:16,030 --> 00:51:20,500
is<font color="#E5E5E5"> hey I want to</font><font color="#CCCCCC"> provide</font><font color="#E5E5E5"> a credentials I</font>

936
00:51:18,400 --> 00:51:22,599
want to target<font color="#E5E5E5"> a</font><font color="#CCCCCC"> WordPress site and</font><font color="#E5E5E5"> I</font>

937
00:51:20,500 --> 00:51:26,950
want it to log in and tell<font color="#E5E5E5"> me is</font>

938
00:51:22,599 --> 00:51:28,540
WordPress<font color="#CCCCCC"> up-to-date or not right</font><font color="#E5E5E5"> and as</font>

939
00:51:26,950 --> 00:51:30,160
you<font color="#CCCCCC"> can imagine</font><font color="#E5E5E5"> that's something kind of</font>

940
00:51:28,540 --> 00:51:31,450
important to keep your<font color="#E5E5E5"> finger on if</font>

941
00:51:30,160 --> 00:51:33,848
you're running WordPress sites<font color="#CCCCCC"> the</font>

942
00:51:31,450 --> 00:51:36,000
moment<font color="#E5E5E5"> you're out of date we have a</font>

943
00:51:33,849 --> 00:51:38,440
massive<font color="#CCCCCC"> forum you know running</font><font color="#E5E5E5"> around</font>

944
00:51:36,000 --> 00:51:40,359
trying<font color="#E5E5E5"> to exploit that we've got all</font><font color="#CCCCCC"> of</font>

945
00:51:38,440 --> 00:51:42,760
our output<font color="#E5E5E5"> what I'm hoping to do is</font>

946
00:51:40,359 --> 00:51:45,730
here's<font color="#CCCCCC"> the current</font><font color="#E5E5E5"> version release on</font>

947
00:51:42,760 --> 00:51:49,839
wordpress.org<font color="#E5E5E5"> and here's our installed</font>

948
00:51:45,730 --> 00:51:55,150
version specifying license categories it

949
00:51:49,839 --> 00:51:58,029
should be safe<font color="#CCCCCC"> the thing</font><font color="#E5E5E5"> that I wanted</font>

950
00:51:55,150 --> 00:52:03,820
to<font color="#E5E5E5"> point out and</font><font color="#CCCCCC"> that this is actually</font>

951
00:51:58,030 --> 00:52:06,369
this line right here<font color="#CCCCCC"> this</font><font color="#E5E5E5"> took me by</font>

952
00:52:03,820 --> 00:52:09,970
surprise a little<font color="#CCCCCC"> bit Lua does not have</font>

953
00:52:06,369 --> 00:52:12,280
regular<font color="#E5E5E5"> a regular expression engine fact</font>

954
00:52:09,970 --> 00:52:13,990
when I was reading the Lua documentation

955
00:52:12,280 --> 00:52:16,390
they said well we could put a Lua

956
00:52:13,990 --> 00:52:18,368
but we could do a<font color="#E5E5E5"> regular</font><font color="#CCCCCC"> expression</font>

957
00:52:16,390 --> 00:52:21,040
engine but it's going<font color="#E5E5E5"> to double the code</font>

958
00:52:18,369 --> 00:52:24,570
base of Lua to do it and we don't<font color="#E5E5E5"> want</font>

959
00:52:21,040 --> 00:52:29,109
<font color="#CCCCCC">to do that so they've got this</font><font color="#E5E5E5"> pattern</font>

960
00:52:24,570 --> 00:52:32,349
matching library that<font color="#E5E5E5"> they use and so in</font>

961
00:52:29,109 --> 00:52:35,080
this<font color="#E5E5E5"> case I the line</font><font color="#CCCCCC"> before I've</font>

962
00:52:32,349 --> 00:52:37,240
declared<font color="#E5E5E5"> a variable called WP response</font>

963
00:52:35,080 --> 00:52:39,759
meaning<font color="#CCCCCC"> I'm hitting wordpress.org</font><font color="#E5E5E5"> if you</font>

964
00:52:37,240 --> 00:52:41,859
might get requests<font color="#E5E5E5"> this time I was</font>

965
00:52:39,760 --> 00:52:45,040
<font color="#CCCCCC">interested in the download page itself</font>

966
00:52:41,859 --> 00:52:47,529
so my path was slash download<font color="#CCCCCC"> and then I</font>

967
00:52:45,040 --> 00:52:49,810
was<font color="#E5E5E5"> extracting out the version by doing</font>

968
00:52:47,530 --> 00:52:52,119
a string match inside of<font color="#E5E5E5"> that body for</font>

969
00:52:49,810 --> 00:52:55,570
<font color="#E5E5E5">something that has a download and force</font>

970
00:52:52,119 --> 00:52:56,800
and space<font color="#E5E5E5"> WordPress and</font><font color="#CCCCCC"> persand and then</font>

971
00:52:55,570 --> 00:52:59,270
<font color="#E5E5E5">three</font>

972
00:52:56,800 --> 00:53:03,140
after that and I putting it inside the

973
00:52:59,270 --> 00:53:04,610
<font color="#E5E5E5">parentheses I'm telling Lua</font><font color="#CCCCCC"> these are</font>

974
00:53:03,140 --> 00:53:07,339
the values I<font color="#E5E5E5"> want you to</font><font color="#CCCCCC"> capture and</font>

975
00:53:04,610 --> 00:53:09,080
toss<font color="#E5E5E5"> into this variable okay which is</font>

976
00:53:07,340 --> 00:53:10,100
like<font color="#E5E5E5"> our regular expressions right</font>

977
00:53:09,080 --> 00:53:11,690
whatever<font color="#E5E5E5"> we're grabbing in those</font>

978
00:53:10,100 --> 00:53:15,049
parentheses<font color="#CCCCCC"> is what we're going to</font>

979
00:53:11,690 --> 00:53:17,420
<font color="#E5E5E5">manipulate it on later okay</font><font color="#CCCCCC"> and then it</font>

980
00:53:15,050 --> 00:53:20,240
goes out<font color="#E5E5E5"> and</font><font color="#CCCCCC"> makes the request now I am</font>

981
00:53:17,420 --> 00:53:22,160
working on<font color="#CCCCCC"> my check here against this</font>

982
00:53:20,240 --> 00:53:25,729
<font color="#E5E5E5">development site so I would be logging</font>

983
00:53:22,160 --> 00:53:29,569
in with a<font color="#E5E5E5"> super secret</font><font color="#CCCCCC"> password called</font>

984
00:53:25,730 --> 00:53:31,880
<font color="#CCCCCC">password this</font><font color="#E5E5E5"> is basically the post body</font>

985
00:53:29,570 --> 00:53:33,800
<font color="#E5E5E5">and the goal is</font><font color="#CCCCCC"> I would go in</font><font color="#E5E5E5"> there and</font>

986
00:53:31,880 --> 00:53:37,190
<font color="#E5E5E5">hit</font><font color="#CCCCCC"> the updates page match on what's</font>

987
00:53:33,800 --> 00:53:38,840
there<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then gives</font><font color="#E5E5E5"> some comparison</font>

988
00:53:37,190 --> 00:53:44,500
well it doesn't<font color="#E5E5E5"> work</font><font color="#CCCCCC"> quite</font><font color="#E5E5E5"> right yeah</font>

989
00:53:38,840 --> 00:53:44,500
<font color="#E5E5E5">but let's go ahead</font><font color="#CCCCCC"> and</font>

990
00:53:47,230 --> 00:53:49,290
<font color="#E5E5E5">you</font>

991
00:53:49,980 --> 00:53:54,170
<font color="#E5E5E5">it should work</font><font color="#CCCCCC"> at least enough</font>

992
00:53:57,220 --> 00:54:01,930
right that part of the work<font color="#CCCCCC"> so we've</font>

993
00:53:59,859 --> 00:54:04,180
gone out sure<font color="#E5E5E5"> enough we have a web</font>

994
00:54:01,930 --> 00:54:05,740
server<font color="#E5E5E5"> because at the script fired now</font>

995
00:54:04,180 --> 00:54:08,770
it didn't do any<font color="#E5E5E5"> validation to see that</font>

996
00:54:05,740 --> 00:54:10,959
literally was a<font color="#CCCCCC"> wordpress site</font><font color="#E5E5E5"> right so</font>

997
00:54:08,770 --> 00:54:12,940
I'll<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to be fat</font><font color="#E5E5E5"> up but it did hit</font>

998
00:54:10,960 --> 00:54:15,160
wordpress.org and<font color="#E5E5E5"> the current</font><font color="#CCCCCC"> version is</font>

999
00:54:12,940 --> 00:54:17,680
<font color="#CCCCCC">Ford I 7.3 now I have something to</font>

1000
00:54:15,160 --> 00:54:22,690
compare on<font color="#E5E5E5"> and I can continue</font><font color="#CCCCCC"> on to</font>

1001
00:54:17,680 --> 00:54:25,390
write my<font color="#CCCCCC"> check from</font><font color="#E5E5E5"> there so really</font>

1002
00:54:22,690 --> 00:54:27,040
<font color="#E5E5E5">simple</font><font color="#CCCCCC"> my goal in this was just to you</font>

1003
00:54:25,390 --> 00:54:29,890
know kind<font color="#CCCCCC"> of open</font><font color="#E5E5E5"> up this you know the</font>

1004
00:54:27,040 --> 00:54:33,759
<font color="#E5E5E5">the NSC scripting world a little bit for</font>

1005
00:54:29,890 --> 00:54:35,259
everybody<font color="#CCCCCC"> it's it's not as bad</font><font color="#E5E5E5"> as it</font>

1006
00:54:33,760 --> 00:54:37,720
first looks you open<font color="#E5E5E5"> up some</font><font color="#CCCCCC"> of these</font>

1007
00:54:35,260 --> 00:54:40,510
files and<font color="#E5E5E5"> you start getting kind of</font>

1008
00:54:37,720 --> 00:54:42,040
intimidated by the you<font color="#CCCCCC"> know what they're</font>

1009
00:54:40,510 --> 00:54:43,900
<font color="#E5E5E5">doing and oh my gosh on that would be</font>

1010
00:54:42,040 --> 00:54:46,779
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to do this it's really</font><font color="#CCCCCC"> not that bad</font>

1011
00:54:43,900 --> 00:54:48,700
<font color="#E5E5E5">and I was doing some looking at the 500</font>

1012
00:54:46,780 --> 00:54:50,650
<font color="#E5E5E5">plus scripts and I did some word count</font>

1013
00:54:48,700 --> 00:54:53,799
on all<font color="#E5E5E5"> the lines in it I would say</font>

1014
00:54:50,650 --> 00:54:55,990
probably<font color="#E5E5E5"> around</font><font color="#CCCCCC"> 50% or more of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> NSC</font>

1015
00:54:53,800 --> 00:55:00,640
scripts<font color="#CCCCCC"> that are released as part of</font>

1016
00:54:55,990 --> 00:55:03,060
nmap are about 150 to 175 lines in

1017
00:55:00,640 --> 00:55:06,549
length and<font color="#CCCCCC"> that's going</font><font color="#E5E5E5"> to include</font>

1018
00:55:03,060 --> 00:55:09,430
things like<font color="#E5E5E5"> the description and the</font>

1019
00:55:06,550 --> 00:55:11,020
usage and<font color="#CCCCCC"> all that other</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> so it's</font>

1020
00:55:09,430 --> 00:55:13,390
<font color="#E5E5E5">really not that bad we can do some</font>

1021
00:55:11,020 --> 00:55:14,920
<font color="#CCCCCC">useful stuff</font><font color="#E5E5E5"> in a pretty short short</font>

1022
00:55:13,390 --> 00:55:16,690
amount of code<font color="#E5E5E5"> you don't</font><font color="#CCCCCC"> have to worry</font>

1023
00:55:14,920 --> 00:55:18,220
about<font color="#CCCCCC"> managing thousands</font><font color="#E5E5E5"> of lines of</font>

1024
00:55:16,690 --> 00:55:19,839
code now there are some<font color="#E5E5E5"> that I saw there</font>

1025
00:55:18,220 --> 00:55:23,020
were<font color="#CCCCCC"> fifteen hundred some-odd lines</font>

1026
00:55:19,839 --> 00:55:26,290
<font color="#E5E5E5">that's way</font><font color="#CCCCCC"> out there beyond me</font><font color="#E5E5E5"> and will</font>

1027
00:55:23,020 --> 00:55:28,869
<font color="#E5E5E5">be for quite</font><font color="#CCCCCC"> some time</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> I hope this</font>

1028
00:55:26,290 --> 00:55:33,810
was<font color="#CCCCCC"> interesting to you guys</font><font color="#E5E5E5"> any</font>

1029
00:55:28,869 --> 00:55:33,810
<font color="#E5E5E5">questions on what we've done yeah</font>

1030
00:55:40,750 --> 00:55:45,280
them I don't know but to be honest<font color="#CCCCCC"> okay</font>

1031
00:55:43,750 --> 00:55:47,620
<font color="#CCCCCC">I haven't</font><font color="#E5E5E5"> hit</font><font color="#CCCCCC"> that point I suspect</font>

1032
00:55:45,280 --> 00:55:50,860
though it's going<font color="#E5E5E5"> to be a you tell it to</font>

1033
00:55:47,620 --> 00:55:58,390
<font color="#E5E5E5">do it runs and it's done</font><font color="#CCCCCC"> I can give</font><font color="#E5E5E5"> it a</font>

1034
00:55:50,860 --> 00:56:00,970
list of what's that yes

1035
00:55:58,390 --> 00:56:04,900
and which does lead to<font color="#E5E5E5"> some</font><font color="#CCCCCC"> issues</font><font color="#E5E5E5"> right</font>

1036
00:56:00,970 --> 00:56:10,330
if I'm going to specify<font color="#CCCCCC"> I use of some</font>

1037
00:56:04,900 --> 00:56:13,330
kind<font color="#CCCCCC"> of credentials</font><font color="#E5E5E5"> do I want</font><font color="#CCCCCC"> that in my</font>

1038
00:56:10,330 --> 00:56:15,250
<font color="#E5E5E5">batch history file probably not so put</font>

1039
00:56:13,330 --> 00:56:17,170
it<font color="#E5E5E5"> in some kind of data file right and</font>

1040
00:56:15,250 --> 00:56:19,990
have my<font color="#E5E5E5"> plugin know to look for</font><font color="#CCCCCC"> an</font>

1041
00:56:17,170 --> 00:56:23,320
<font color="#E5E5E5">argument says hey your</font><font color="#CCCCCC"> username file is</font>

1042
00:56:19,990 --> 00:56:24,700
<font color="#CCCCCC">here or your credential file is here you</font>

1043
00:56:23,320 --> 00:56:27,130
could even tie this into<font color="#E5E5E5"> a semi brute</font>

1044
00:56:24,700 --> 00:56:28,569
force type of<font color="#CCCCCC"> do</font><font color="#E5E5E5"> right here the five or</font>

1045
00:56:27,130 --> 00:56:31,420
six credentials that we use across

1046
00:56:28,570 --> 00:56:32,650
<font color="#E5E5E5">whatever this is have fun</font><font color="#CCCCCC"> you figure out</font>

1047
00:56:31,420 --> 00:56:33,540
which one<font color="#CCCCCC"> was the right one and</font><font color="#E5E5E5"> just</font>

1048
00:56:32,650 --> 00:56:36,030
give me the<font color="#E5E5E5"> results when we've done</font>

1049
00:56:33,540 --> 00:56:37,900
<font color="#E5E5E5">right</font>

1050
00:56:36,030 --> 00:56:40,690
like I said<font color="#E5E5E5"> Lua is really</font>

1051
00:56:37,900 --> 00:56:43,020
<font color="#CCCCCC">well-documented</font><font color="#E5E5E5"> you go</font><font color="#CCCCCC"> online</font><font color="#E5E5E5"> they've</font>

1052
00:56:40,690 --> 00:56:45,400
got their programming<font color="#CCCCCC"> in Lua book online</font>

1053
00:56:43,020 --> 00:56:47,860
<font color="#E5E5E5">fabulous you know that's that was my</font>

1054
00:56:45,400 --> 00:56:49,720
<font color="#CCCCCC">reference right I didn't have to go out</font>

1055
00:56:47,860 --> 00:56:52,720
<font color="#CCCCCC">and buy anything</font><font color="#E5E5E5"> you've got about 50</font>

1056
00:56:49,720 --> 00:56:56,080
percent<font color="#E5E5E5"> of the nmap book online the NSE</font>

1057
00:56:52,720 --> 00:56:58,149
<font color="#CCCCCC">Burton section is part</font><font color="#E5E5E5"> of that if you</font>

1058
00:56:56,080 --> 00:57:01,450
don't have the book<font color="#CCCCCC"> it's worth getting I</font>

1059
00:56:58,150 --> 00:57:03,040
have it myself<font color="#E5E5E5"> it's a great great</font>

1060
00:57:01,450 --> 00:57:05,169
reference tool you've got the NSE Doc's

1061
00:57:03,040 --> 00:57:06,400
you're looking at some library what do I

1062
00:57:05,170 --> 00:57:07,720
need<font color="#E5E5E5"> to do with this thing what do I</font>

1063
00:57:06,400 --> 00:57:10,500
need<font color="#E5E5E5"> to send it what you know what</font>

1064
00:57:07,720 --> 00:57:13,689
they've got<font color="#CCCCCC"> all of that documented here</font>

1065
00:57:10,500 --> 00:57:15,430
check out the existing scripts<font color="#E5E5E5"> as kind</font>

1066
00:57:13,690 --> 00:57:17,470
<font color="#CCCCCC">of my favorite way of</font><font color="#E5E5E5"> doing things</font>

1067
00:57:15,430 --> 00:57:19,899
you know<font color="#E5E5E5"> let's see what else somebody</font>

1068
00:57:17,470 --> 00:57:21,459
else has<font color="#E5E5E5"> done and obviously you can go</font>

1069
00:57:19,900 --> 00:57:24,570
back and<font color="#E5E5E5"> look at this presentation some</font>

1070
00:57:21,460 --> 00:57:27,960
of<font color="#E5E5E5"> the scripts here's just the github</font>

1071
00:57:24,570 --> 00:57:27,960
URL again

1072
00:57:28,520 --> 00:57:41,270
sir what's<font color="#E5E5E5"> that</font>

1073
00:57:34,319 --> 00:57:43,190
oh right here<font color="#CCCCCC"> we were</font>

1074
00:57:41,270 --> 00:57:51,770
about that<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> let me handle</font><font color="#E5E5E5"> this and</font>

1075
00:57:43,190 --> 00:57:53,390
then we'll<font color="#CCCCCC"> lie back okay so some of</font><font color="#E5E5E5"> the</font>

1076
00:57:51,770 --> 00:57:55,160
<font color="#E5E5E5">documentation I read said in the older</font>

1077
00:57:53,390 --> 00:57:58,100
versions<font color="#E5E5E5"> of WordPress they out put it in</font>

1078
00:57:55,160 --> 00:58:01,569
a meta tag so that implied to me that

1079
00:57:58,100 --> 00:58:01,569
that was not<font color="#E5E5E5"> the case anymore</font>

1080
00:58:01,780 --> 00:58:07,550
okay<font color="#CCCCCC"> so yeah I saw at about three</font>

1081
00:58:05,780 --> 00:58:11,150
different<font color="#E5E5E5"> ways to</font><font color="#CCCCCC"> get the current an</font>

1082
00:58:07,550 --> 00:58:14,840
<font color="#CCCCCC">assult version one of the one you're</font>

1083
00:58:11,150 --> 00:58:15,770
<font color="#CCCCCC">referring to</font><font color="#E5E5E5"> said older so</font><font color="#CCCCCC"> that I kind</font>

1084
00:58:14,840 --> 00:58:20,570
of shied<font color="#E5E5E5"> away from it</font>

1085
00:58:15,770 --> 00:58:22,820
the question we had earlier<font color="#CCCCCC"> actually</font>

1086
00:58:20,570 --> 00:58:26,900
<font color="#CCCCCC">before you head out what was your what</font>

1087
00:58:22,820 --> 00:58:29,360
<font color="#E5E5E5">was your</font><font color="#CCCCCC"> question again exactly right so</font>

1088
00:58:26,900 --> 00:58:31,430
<font color="#CCCCCC">his question</font><font color="#E5E5E5"> was can you make your</font><font color="#CCCCCC"> NSE</font>

1089
00:58:29,360 --> 00:58:33,110
scripts interactive so<font color="#E5E5E5"> that it hits a</font>

1090
00:58:31,430 --> 00:58:35,330
certain<font color="#E5E5E5"> point it pauses way for you to</font>

1091
00:58:33,110 --> 00:58:38,060
put<font color="#E5E5E5"> in</font><font color="#CCCCCC"> input like username and a</font>

1092
00:58:35,330 --> 00:58:43,990
password right in some way and then move

1093
00:58:38,060 --> 00:58:46,610
on<font color="#CCCCCC"> and then the</font><font color="#E5E5E5"> comment after that was</font>

1094
00:58:43,990 --> 00:58:48,259
well my spot no you<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> think you</font>

1095
00:58:46,610 --> 00:58:50,300
<font color="#E5E5E5">can</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> it's going to just go and</font>

1096
00:58:48,260 --> 00:58:51,800
<font color="#E5E5E5">then you can put it in as part of a</font>

1097
00:58:50,300 --> 00:58:53,840
command line argument<font color="#CCCCCC"> you can put it</font>

1098
00:58:51,800 --> 00:58:56,960
<font color="#E5E5E5">into text files that</font><font color="#CCCCCC"> it reads in and</font>

1099
00:58:53,840 --> 00:58:58,760
uses that<font color="#E5E5E5"> instead so that's that's how</font>

1100
00:58:56,960 --> 00:58:59,930
<font color="#CCCCCC">you would have to get</font><font color="#E5E5E5"> around that so</font>

1101
00:58:58,760 --> 00:59:04,420
does<font color="#E5E5E5"> it require a</font><font color="#CCCCCC"> little bit</font><font color="#E5E5E5"> of</font>

1102
00:58:59,930 --> 00:59:07,370
forethought any other questions

1103
00:59:04,420 --> 00:59:10,880
no well thank you everybody for coming

1104
00:59:07,370 --> 00:59:11,500
<font color="#CCCCCC">out I hope it was useful and take a shot</font>

1105
00:59:10,880 --> 00:59:14,500
at it

1106
00:59:11,500 --> 00:59:14,500
<font color="#E5E5E5">Thanks</font>

