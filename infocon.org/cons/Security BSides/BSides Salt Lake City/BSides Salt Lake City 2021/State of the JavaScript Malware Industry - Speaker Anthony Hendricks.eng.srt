1
00:00:03,840 --> 00:00:06,799
introduce myself i am currently attached

2
00:00:06,799 --> 00:00:08,000
to a blue team

3
00:00:08,000 --> 00:00:09,360
um

4
00:00:09,360 --> 00:00:12,400
i in the past i well i call myself a

5
00:00:12,400 --> 00:00:14,240
reformed red teamer because i i spent

6
00:00:14,240 --> 00:00:16,640
most of my time doing red team

7
00:00:16,640 --> 00:00:18,880
i've done pen testing for for years

8
00:00:18,880 --> 00:00:20,320
mostly

9
00:00:20,320 --> 00:00:21,920
on the public sector

10
00:00:21,920 --> 00:00:23,920
for the u.s government's department of

11
00:00:23,920 --> 00:00:25,439
defense

12
00:00:25,439 --> 00:00:28,400
i've done a fair amount of training

13
00:00:28,400 --> 00:00:31,199
i taught a lot of courses for the us

14
00:00:31,199 --> 00:00:35,680
navy uh for department of defense um

15
00:00:35,680 --> 00:00:37,360
did some time at the nsa that's where i

16
00:00:37,360 --> 00:00:38,879
went after school

17
00:00:38,879 --> 00:00:40,239
a lot of people have asked me like

18
00:00:40,239 --> 00:00:44,079
what's my history i i did the typical

19
00:00:44,079 --> 00:00:46,719
mis degree from from utah state then i

20
00:00:46,719 --> 00:00:49,520
went on to idaho state from there joined

21
00:00:49,520 --> 00:00:51,280
the governments

22
00:00:51,280 --> 00:00:53,039
worked for nsa for

23
00:00:53,039 --> 00:00:55,600
for a number of years and then moved on

24
00:00:55,600 --> 00:00:57,760
to government contracting from there and

25
00:00:57,760 --> 00:01:00,160
i did a bunch of different things

26
00:01:00,160 --> 00:01:02,719
training pen testing that sort of thing

27
00:01:02,719 --> 00:01:06,880
now i work for stage 2 security

28
00:01:06,880 --> 00:01:09,040
we do a lot of

29
00:01:09,040 --> 00:01:11,040
fun things there

30
00:01:11,040 --> 00:01:13,760
anything from pen testing to defense to

31
00:01:13,760 --> 00:01:15,360
um

32
00:01:15,360 --> 00:01:16,960
you know security engineering that sort

33
00:01:16,960 --> 00:01:19,840
of thing so you name it um i probably

34
00:01:19,840 --> 00:01:23,040
have my hands in it in some way

35
00:01:23,040 --> 00:01:25,439
so this is my own talk just a disclaimer

36
00:01:25,439 --> 00:01:27,520
it doesn't necessarily reflect the views

37
00:01:27,520 --> 00:01:29,360
of my employer but they

38
00:01:29,360 --> 00:01:31,680
definitely support it um

39
00:01:31,680 --> 00:01:33,680
so the question is why javascript

40
00:01:33,680 --> 00:01:36,000
malware you know it's it's not not all

41
00:01:36,000 --> 00:01:38,400
that exciting you know you you look at

42
00:01:38,400 --> 00:01:40,479
people like waylon who though do

43
00:01:40,479 --> 00:01:42,799
reverse engineering of of real life

44
00:01:42,799 --> 00:01:45,360
malware um so

45
00:01:45,360 --> 00:01:47,680
why why javascript

46
00:01:47,680 --> 00:01:50,320
and and this came from a two-pronged

47
00:01:50,320 --> 00:01:52,159
approach

48
00:01:52,159 --> 00:01:53,759
the first is

49
00:01:53,759 --> 00:01:56,320
javascript malware is everywhere

50
00:01:56,320 --> 00:01:58,159
so you know it makes threat hunting

51
00:01:58,159 --> 00:02:00,719
really easy if you have so many targets

52
00:02:00,719 --> 00:02:02,000
to look at

53
00:02:02,000 --> 00:02:03,600
you know i'd

54
00:02:03,600 --> 00:02:05,280
you can take a look at a bunch of sites

55
00:02:05,280 --> 00:02:08,639
and any given day you know

56
00:02:08,639 --> 00:02:10,639
a quarter of them have some sort of

57
00:02:10,639 --> 00:02:12,160
javascript malware on them especially

58
00:02:12,160 --> 00:02:13,520
when you're talking about e-commerce

59
00:02:13,520 --> 00:02:14,720
sites

60
00:02:14,720 --> 00:02:15,760
um

61
00:02:15,760 --> 00:02:18,160
reverse engineering isn't necessary you

62
00:02:18,160 --> 00:02:20,480
know i i haven't broken out ida pro in

63
00:02:20,480 --> 00:02:23,680
in a number of years now um

64
00:02:23,680 --> 00:02:24,879
and

65
00:02:24,879 --> 00:02:26,959
i've gotten a little rusty on and so you

66
00:02:26,959 --> 00:02:29,040
know reverse engineering javascript

67
00:02:29,040 --> 00:02:31,680
malware is 1000 times easier you know

68
00:02:31,680 --> 00:02:33,440
they they try to

69
00:02:33,440 --> 00:02:35,280
obfuscate it but there's there's a lot

70
00:02:35,280 --> 00:02:36,879
of tools out there that can help you

71
00:02:36,879 --> 00:02:38,640
with that

72
00:02:38,640 --> 00:02:40,000
if these slides are shared i've got a

73
00:02:40,000 --> 00:02:41,440
bunch of links here

74
00:02:41,440 --> 00:02:43,280
talking about

75
00:02:43,280 --> 00:02:45,040
javascript malware

76
00:02:45,040 --> 00:02:47,599
battles between rival gangs

77
00:02:47,599 --> 00:02:50,640
trying to get malware on on systems

78
00:02:50,640 --> 00:02:52,160
a company that we'll talk a little bit

79
00:02:52,160 --> 00:02:56,959
later sansec is is a leader in this

80
00:02:57,599 --> 00:02:58,720
so

81
00:02:58,720 --> 00:03:01,680
e-commerce what brings us up you know

82
00:03:01,680 --> 00:03:03,440
this time of year there's a lot of

83
00:03:03,440 --> 00:03:06,560
e-commerce malware

84
00:03:06,959 --> 00:03:09,440
you know e-commerce is big business this

85
00:03:09,440 --> 00:03:11,599
time of year everybody's shopping online

86
00:03:11,599 --> 00:03:12,959
everybody's looking for you know

87
00:03:12,959 --> 00:03:15,680
christmas gifts

88
00:03:16,840 --> 00:03:18,560
so

89
00:03:18,560 --> 00:03:20,159
you know this this means that the

90
00:03:20,159 --> 00:03:21,840
attackers are there as well because they

91
00:03:21,840 --> 00:03:23,599
know they can they can gather that

92
00:03:23,599 --> 00:03:24,959
information

93
00:03:24,959 --> 00:03:26,480
so we have these people shopping online

94
00:03:26,480 --> 00:03:29,760
we have the attackers in there um

95
00:03:29,760 --> 00:03:31,200
you know traditionally

96
00:03:31,200 --> 00:03:33,680
we we've been a reactive

97
00:03:33,680 --> 00:03:35,760
group towards this you know we detect

98
00:03:35,760 --> 00:03:38,159
malware the merchant gets

99
00:03:38,159 --> 00:03:41,200
notified and then you respond so you do

100
00:03:41,200 --> 00:03:42,879
ir you reverse engineer the mount where

101
00:03:42,879 --> 00:03:45,200
you figure out what happens

102
00:03:45,200 --> 00:03:46,720
i wanted to be a little more proactive

103
00:03:46,720 --> 00:03:48,560
at it so that's what what started this

104
00:03:48,560 --> 00:03:51,360
whole project

105
00:03:51,599 --> 00:03:54,239
so if anybody's worked for

106
00:03:54,239 --> 00:03:56,959
or a merchant before they've probably

107
00:03:56,959 --> 00:03:58,560
you've probably seen this this kind of

108
00:03:58,560 --> 00:03:59,439
letter

109
00:03:59,439 --> 00:04:01,040
you know it goes along the lines of

110
00:04:01,040 --> 00:04:02,640
saying you know your account has a lot

111
00:04:02,640 --> 00:04:04,560
of fraudulent transactions you need to

112
00:04:04,560 --> 00:04:05,599
do something about it we're going to

113
00:04:05,599 --> 00:04:07,519
shut you down

114
00:04:07,519 --> 00:04:09,120
so

115
00:04:09,120 --> 00:04:10,959
let's first talk about

116
00:04:10,959 --> 00:04:14,239
what a zero dollar verification is zero

117
00:04:14,239 --> 00:04:16,238
dollar is a whole place

118
00:04:16,238 --> 00:04:17,839
you used to see it as a one dollar

119
00:04:17,839 --> 00:04:19,759
transaction but they've gotten gone away

120
00:04:19,759 --> 00:04:22,160
from that and done zero dollar

121
00:04:22,160 --> 00:04:23,520
um

122
00:04:23,520 --> 00:04:26,240
what does this mean why does it matter

123
00:04:26,240 --> 00:04:28,320
so you know if it's zero dollars what do

124
00:04:28,320 --> 00:04:31,120
you care as a merchant

125
00:04:31,120 --> 00:04:33,759
what this is is carter's are are out

126
00:04:33,759 --> 00:04:35,759
there and

127
00:04:35,759 --> 00:04:37,360
when you're selling on the black market

128
00:04:37,360 --> 00:04:39,520
you can have what are known as verified

129
00:04:39,520 --> 00:04:41,680
or unverified cards

130
00:04:41,680 --> 00:04:43,600
if you have a list of verified cards you

131
00:04:43,600 --> 00:04:46,880
can sell those for for way more um you

132
00:04:46,880 --> 00:04:49,120
know 10 times the amount

133
00:04:49,120 --> 00:04:50,320
per

134
00:04:50,320 --> 00:04:52,960
per card over unverified

135
00:04:52,960 --> 00:04:55,040
so what these attackers do is they the

136
00:04:55,040 --> 00:04:56,320
carters will take their list that

137
00:04:56,320 --> 00:04:57,759
they've stolen

138
00:04:57,759 --> 00:04:59,280
and they go through and they find a site

139
00:04:59,280 --> 00:05:01,600
that has has a weakness and they'll go

140
00:05:01,600 --> 00:05:03,120
through and they'll authorize

141
00:05:03,120 --> 00:05:04,960
transactions so they'll go to buy

142
00:05:04,960 --> 00:05:06,479
something

143
00:05:06,479 --> 00:05:07,840
with the intention of immediately

144
00:05:07,840 --> 00:05:09,120
canceling they just want to know the

145
00:05:09,120 --> 00:05:10,800
card works

146
00:05:10,800 --> 00:05:12,160
and then they take those lists and they

147
00:05:12,160 --> 00:05:15,120
sell them as verified

148
00:05:15,120 --> 00:05:16,720
and usually there's some sort of like

149
00:05:16,720 --> 00:05:20,080
buyback policy so you know if if they're

150
00:05:20,080 --> 00:05:22,400
that cards aren't valid then they have

151
00:05:22,400 --> 00:05:24,080
they have to buy them back for a certain

152
00:05:24,080 --> 00:05:25,759
amount of money

153
00:05:25,759 --> 00:05:28,479
so it's in their best interest as

154
00:05:28,479 --> 00:05:31,120
as black market sellers to have verified

155
00:05:31,120 --> 00:05:32,960
cards because they can sell for more and

156
00:05:32,960 --> 00:05:36,880
they don't have to deal with returns

157
00:05:36,960 --> 00:05:38,960
so where do these come from

158
00:05:38,960 --> 00:05:40,400
you know they they don't necessarily

159
00:05:40,400 --> 00:05:43,120
indicate a breach on your your site

160
00:05:43,120 --> 00:05:45,600
um if you're a merchant that has this

161
00:05:45,600 --> 00:05:47,039
sort of thing happen

162
00:05:47,039 --> 00:05:49,520
you know a huge amount or a spike of

163
00:05:49,520 --> 00:05:50,840
zero dollar

164
00:05:50,840 --> 00:05:53,039
verifications um it probably just means

165
00:05:53,039 --> 00:05:55,919
that your payments process is weak

166
00:05:55,919 --> 00:05:58,000
you're missing something in in the steps

167
00:05:58,000 --> 00:06:00,400
that will will prevent bot activity from

168
00:06:00,400 --> 00:06:01,919
verifying these because you know they're

169
00:06:01,919 --> 00:06:03,280
not going in there manually they wrote a

170
00:06:03,280 --> 00:06:04,240
script

171
00:06:04,240 --> 00:06:06,800
to go through test the card add it to

172
00:06:06,800 --> 00:06:08,390
their list

173
00:06:08,390 --> 00:06:10,080
[Music]

174
00:06:10,080 --> 00:06:12,080
and it's it's not a zero cost for you as

175
00:06:12,080 --> 00:06:14,160
a merchant either a lot of payment

176
00:06:14,160 --> 00:06:17,199
processors will charge a fee

177
00:06:17,199 --> 00:06:18,160
for

178
00:06:18,160 --> 00:06:20,000
verification transactions that don't

179
00:06:20,000 --> 00:06:21,440
complete

180
00:06:21,440 --> 00:06:22,880
so if they complete they charge you

181
00:06:22,880 --> 00:06:25,039
their normal rates you know which is a

182
00:06:25,039 --> 00:06:27,199
flat fee plus a per percentage of the

183
00:06:27,199 --> 00:06:28,160
sale

184
00:06:28,160 --> 00:06:30,160
but verifications

185
00:06:30,160 --> 00:06:33,120
especially if you're a repeat offender

186
00:06:33,120 --> 00:06:35,440
can they can charge you up to like 25

187
00:06:35,440 --> 00:06:37,039
cents a transaction

188
00:06:37,039 --> 00:06:39,520
so imagine that if if a carter

189
00:06:39,520 --> 00:06:41,280
targets your site

190
00:06:41,280 --> 00:06:42,720
and they test

191
00:06:42,720 --> 00:06:44,639
10 000 cards

192
00:06:44,639 --> 00:06:46,479
you could be paid on the hook for you

193
00:06:46,479 --> 00:06:48,400
know five hundred dollars

194
00:06:48,400 --> 00:06:50,319
which may be your your revenue if you're

195
00:06:50,319 --> 00:06:51,520
a small

196
00:06:51,520 --> 00:06:54,479
a small merchant

197
00:06:54,479 --> 00:06:56,800
so counter measures for this

198
00:06:56,800 --> 00:06:58,000
you know you're talking about the

199
00:06:58,000 --> 00:06:59,919
typical anti-bot techniques things that

200
00:06:59,919 --> 00:07:01,520
would prevent

201
00:07:01,520 --> 00:07:03,120
bots from

202
00:07:03,120 --> 00:07:05,039
carrying out an action but not limit

203
00:07:05,039 --> 00:07:07,280
your human customers from doing it

204
00:07:07,280 --> 00:07:10,400
captcha is rate limiting

205
00:07:10,400 --> 00:07:12,000
watching for things like shopping cart

206
00:07:12,000 --> 00:07:15,199
reuse so a lot of carters will take and

207
00:07:15,199 --> 00:07:16,639
build a shopping cart and then reuse

208
00:07:16,639 --> 00:07:18,400
that over and over again for these you

209
00:07:18,400 --> 00:07:21,280
know 10 000 transactions

210
00:07:21,280 --> 00:07:23,919
um watch your trends on on checkouts if

211
00:07:23,919 --> 00:07:25,360
you suddenly have a lot of checkouts

212
00:07:25,360 --> 00:07:27,440
that that don't complete or you know

213
00:07:27,440 --> 00:07:28,479
don't go all the way through the

214
00:07:28,479 --> 00:07:29,599
shipping

215
00:07:29,599 --> 00:07:30,800
stage or

216
00:07:30,800 --> 00:07:32,400
the orders get cancelled immediately

217
00:07:32,400 --> 00:07:34,319
after

218
00:07:34,319 --> 00:07:36,479
you know that's a typically a sign of

219
00:07:36,479 --> 00:07:38,560
this sort of activity

220
00:07:38,560 --> 00:07:40,880
um

221
00:07:42,240 --> 00:07:44,160
typically a 0

222
00:07:44,160 --> 00:07:46,720
verification means that you're you're

223
00:07:46,720 --> 00:07:48,800
authorizing the card

224
00:07:48,800 --> 00:07:50,319
but you're not going to charge until

225
00:07:50,319 --> 00:07:54,240
later date this is common for

226
00:07:54,240 --> 00:07:55,520
when you

227
00:07:55,520 --> 00:07:57,120
charge the card when when the the

228
00:07:57,120 --> 00:07:58,800
product ships

229
00:07:58,800 --> 00:07:59,599
so

230
00:07:59,599 --> 00:08:01,440
if you can avoid zero dollar

231
00:08:01,440 --> 00:08:03,520
verifications altogether you know that's

232
00:08:03,520 --> 00:08:04,960
all the better if you can just charge

233
00:08:04,960 --> 00:08:06,639
immediately

234
00:08:06,639 --> 00:08:08,479
but of course you know that depends on

235
00:08:08,479 --> 00:08:11,280
on your your

236
00:08:11,440 --> 00:08:14,400
your site and how you operate

237
00:08:14,400 --> 00:08:16,080
the second one we're going to talk about

238
00:08:16,080 --> 00:08:19,039
um this is this is the one that we we're

239
00:08:19,039 --> 00:08:21,599
actually interested in today um this one

240
00:08:21,599 --> 00:08:23,039
is

241
00:08:23,039 --> 00:08:26,400
um the payment processor or a bank has

242
00:08:26,400 --> 00:08:29,120
aggregated a list of stolen cards

243
00:08:29,120 --> 00:08:31,039
so that all these banks get together and

244
00:08:31,039 --> 00:08:33,440
they share this stolen card data

245
00:08:33,440 --> 00:08:34,799
and then they start looking at

246
00:08:34,799 --> 00:08:36,240
transactions

247
00:08:36,240 --> 00:08:38,240
and when they find transactions that

248
00:08:38,240 --> 00:08:40,719
match between all of these stolen cards

249
00:08:40,719 --> 00:08:42,479
then they decide that that must be the

250
00:08:42,479 --> 00:08:43,599
culprit

251
00:08:43,599 --> 00:08:46,000
and they're usually fairly accurate

252
00:08:46,000 --> 00:08:47,440
because we're talking about huge data

253
00:08:47,440 --> 00:08:49,200
sets here

254
00:08:49,200 --> 00:08:50,880
so all these payment processors they get

255
00:08:50,880 --> 00:08:53,120
together they they figure out who has

256
00:08:53,120 --> 00:08:55,200
that the common transaction you know

257
00:08:55,200 --> 00:08:57,519
where were all these cards used

258
00:08:57,519 --> 00:08:59,519
before the

259
00:08:59,519 --> 00:09:01,680
they were exposed

260
00:09:01,680 --> 00:09:03,440
and then it's the same sort of thing

261
00:09:03,440 --> 00:09:05,760
they talked to the processor so the

262
00:09:05,760 --> 00:09:07,680
processing bank and then the processing

263
00:09:07,680 --> 00:09:08,480
bank

264
00:09:08,480 --> 00:09:10,720
turns to the merchant that says hey you

265
00:09:10,720 --> 00:09:12,640
you need to fix this otherwise we're

266
00:09:12,640 --> 00:09:15,600
cancelling your account

267
00:09:16,320 --> 00:09:18,560
so this is just a summary of

268
00:09:18,560 --> 00:09:20,640
of our difference here

269
00:09:20,640 --> 00:09:23,519
we're looking at stolen cards versus

270
00:09:23,519 --> 00:09:26,160
somebody trying to verify stone cards

271
00:09:26,160 --> 00:09:28,480
um

272
00:09:29,440 --> 00:09:31,519
most of these are

273
00:09:31,519 --> 00:09:33,760
are almost always an indication of some

274
00:09:33,760 --> 00:09:36,160
sort of compromise whether it's they've

275
00:09:36,160 --> 00:09:37,360
compromised

276
00:09:37,360 --> 00:09:39,279
compromised the payment processor

277
00:09:39,279 --> 00:09:41,040
they've compromised your site they

278
00:09:41,040 --> 00:09:42,720
compromise some sort of database on the

279
00:09:42,720 --> 00:09:45,200
back end

280
00:09:45,680 --> 00:09:47,680
it's almost always indication of some

281
00:09:47,680 --> 00:09:50,080
sort of breach in the chain and whether

282
00:09:50,080 --> 00:09:51,839
that's your fault or the payment

283
00:09:51,839 --> 00:09:54,240
processor's fault you know somebody's on

284
00:09:54,240 --> 00:09:56,880
the hook for it

285
00:10:00,399 --> 00:10:02,959
pretty common targets especially

286
00:10:02,959 --> 00:10:06,480
when we're talking about e-commerce are

287
00:10:06,480 --> 00:10:08,480
the major players out there so we're

288
00:10:08,480 --> 00:10:09,920
talking about things like woocommerce

289
00:10:09,920 --> 00:10:11,680
which is a wordplus

290
00:10:11,680 --> 00:10:13,279
plug-in it's

291
00:10:13,279 --> 00:10:15,360
very common to see

292
00:10:15,360 --> 00:10:18,480
multiple cvs or multiple vulnerability

293
00:10:18,480 --> 00:10:20,640
announcements come out for woocommerce

294
00:10:20,640 --> 00:10:22,720
after the holidays because that's when

295
00:10:22,720 --> 00:10:24,720
they discovered them

296
00:10:24,720 --> 00:10:27,680
is after the breach

297
00:10:27,680 --> 00:10:29,040
other other

298
00:10:29,040 --> 00:10:32,079
targets are the platforms themselves so

299
00:10:32,079 --> 00:10:33,600
lots of the

300
00:10:33,600 --> 00:10:35,519
sales as a service type platforms

301
00:10:35,519 --> 00:10:38,800
shopify magento demandware um

302
00:10:38,800 --> 00:10:40,160
you know if they can compromise the

303
00:10:40,160 --> 00:10:41,839
platform whether it is compromise the

304
00:10:41,839 --> 00:10:43,120
credentials whether

305
00:10:43,120 --> 00:10:45,279
or is compromising the platform's back

306
00:10:45,279 --> 00:10:47,279
end

307
00:10:47,279 --> 00:10:50,399
then they can get this information

308
00:10:50,399 --> 00:10:53,279
and we're talking about um

309
00:10:53,279 --> 00:10:55,839
you know zero-day exploits are fairly

310
00:10:55,839 --> 00:10:57,279
common to

311
00:10:57,279 --> 00:10:59,040
they'll discover them and hold on to

312
00:10:59,040 --> 00:11:00,720
them until the

313
00:11:00,720 --> 00:11:03,360
like the holidays or other common high

314
00:11:03,360 --> 00:11:04,240
high

315
00:11:04,240 --> 00:11:05,360
um

316
00:11:05,360 --> 00:11:07,519
e-commerce times so

317
00:11:07,519 --> 00:11:10,480
you think about christmas um other

318
00:11:10,480 --> 00:11:12,480
holidays where a lot of purchasing takes

319
00:11:12,480 --> 00:11:14,480
place such a valentine's day you know

320
00:11:14,480 --> 00:11:16,480
these are times when

321
00:11:16,480 --> 00:11:18,320
these will pop up you know they may have

322
00:11:18,320 --> 00:11:19,040
sat

323
00:11:19,040 --> 00:11:20,399
on them for

324
00:11:20,399 --> 00:11:21,680
months

325
00:11:21,680 --> 00:11:23,600
before finally using them or they may

326
00:11:23,600 --> 00:11:25,839
sit on that access for months

327
00:11:25,839 --> 00:11:28,000
you know it could be a sites compromised

328
00:11:28,000 --> 00:11:30,240
and then they just sit on it and tell it

329
00:11:30,240 --> 00:11:32,160
um the the right time

330
00:11:32,160 --> 00:11:33,519
to

331
00:11:33,519 --> 00:11:35,360
enact their plan

332
00:11:35,360 --> 00:11:36,720
and they're pretty smart about it these

333
00:11:36,720 --> 00:11:38,399
are these are pretty sophisticated

334
00:11:38,399 --> 00:11:42,200
groups they know what they're doing

335
00:11:42,240 --> 00:11:43,760
and then

336
00:11:43,760 --> 00:11:45,760
to dovetail right in with the previous

337
00:11:45,760 --> 00:11:47,279
talk you know password stuffing

338
00:11:47,279 --> 00:11:49,440
credential reuse this is extremely

339
00:11:49,440 --> 00:11:52,399
common with um especially the the sales

340
00:11:52,399 --> 00:11:54,800
as a service platforms where it's some

341
00:11:54,800 --> 00:11:56,320
mom and pop shop

342
00:11:56,320 --> 00:11:58,079
that decided they want to wanted to be

343
00:11:58,079 --> 00:11:59,440
online

344
00:11:59,440 --> 00:12:00,959
so they set up an account and they use

345
00:12:00,959 --> 00:12:03,200
the same password they always use

346
00:12:03,200 --> 00:12:05,200
and then you know that's found in a

347
00:12:05,200 --> 00:12:06,160
breach

348
00:12:06,160 --> 00:12:08,399
and sure enough the the attackers find

349
00:12:08,399 --> 00:12:10,639
it tested and then they have access to

350
00:12:10,639 --> 00:12:14,079
the to the site themselves

351
00:12:14,639 --> 00:12:16,639
another

352
00:12:16,639 --> 00:12:19,360
one that's popped up more recently is

353
00:12:19,360 --> 00:12:21,839
marketplaces for stolen tokens

354
00:12:21,839 --> 00:12:23,200
so this is kind of an interesting one

355
00:12:23,200 --> 00:12:25,279
they get tokens from you know a whole

356
00:12:25,279 --> 00:12:27,519
bunch of different ways

357
00:12:27,519 --> 00:12:30,399
whether it's compromised endpoints

358
00:12:30,399 --> 00:12:33,200
stolen data that sort of thing

359
00:12:33,200 --> 00:12:35,200
there are actually marketplaces that

360
00:12:35,200 --> 00:12:38,320
take stolen session cookies

361
00:12:38,320 --> 00:12:40,240
and sell them to

362
00:12:40,240 --> 00:12:42,639
other hackers to use

363
00:12:42,639 --> 00:12:44,160
in the tax

364
00:12:44,160 --> 00:12:46,320
so basically it's

365
00:12:46,320 --> 00:12:49,680
keys to accounts and

366
00:12:49,920 --> 00:12:52,399
they're being marketed on the

367
00:12:52,399 --> 00:12:54,959
on these forums to be to then be used

368
00:12:54,959 --> 00:12:56,240
later

369
00:12:56,240 --> 00:12:59,279
in enacting these attacks

370
00:12:59,279 --> 00:13:01,519
so our traditional approach to this this

371
00:13:01,519 --> 00:13:04,320
is the the approach i walked into

372
00:13:04,320 --> 00:13:05,440
was

373
00:13:05,440 --> 00:13:07,360
first you get a notification there's

374
00:13:07,360 --> 00:13:09,360
some sort of breach we need to react to

375
00:13:09,360 --> 00:13:10,720
it um

376
00:13:10,720 --> 00:13:13,120
so you go into ir mode you hunt down

377
00:13:13,120 --> 00:13:15,040
where the breach is

378
00:13:15,040 --> 00:13:17,519
figure out what happened

379
00:13:17,519 --> 00:13:19,120
you clean off the site as best you can

380
00:13:19,120 --> 00:13:20,800
so that it means removing whatever

381
00:13:20,800 --> 00:13:23,599
malware is there

382
00:13:23,920 --> 00:13:25,680
try to return return it to a secure

383
00:13:25,680 --> 00:13:26,959
state so that means you have to figure

384
00:13:26,959 --> 00:13:29,600
out how they got in the first place

385
00:13:29,600 --> 00:13:31,600
change passwords patch you know whatever

386
00:13:31,600 --> 00:13:33,760
it is and then return to business as

387
00:13:33,760 --> 00:13:36,079
usual the problem with this is it's

388
00:13:36,079 --> 00:13:38,639
entirely reactionary and

389
00:13:38,639 --> 00:13:40,639
you have no idea what the time is

390
00:13:40,639 --> 00:13:43,040
between

391
00:13:43,360 --> 00:13:45,360
number five here and

392
00:13:45,360 --> 00:13:46,959
returning back to number one and getting

393
00:13:46,959 --> 00:13:50,399
a new breach notification

394
00:13:50,399 --> 00:13:52,959
and that didn't didn't sit well with me

395
00:13:52,959 --> 00:13:55,519
especially because

396
00:13:55,519 --> 00:13:57,760
the steps involved so so how do you find

397
00:13:57,760 --> 00:13:59,920
malicious code on your site especially

398
00:13:59,920 --> 00:14:01,600
if you're relying on third party

399
00:14:01,600 --> 00:14:04,160
providers for a lot of this stuff you

400
00:14:04,160 --> 00:14:05,839
know do you know every line of code on

401
00:14:05,839 --> 00:14:08,320
your site do you know exactly

402
00:14:08,320 --> 00:14:10,240
what every line of code does

403
00:14:10,240 --> 00:14:12,560
and how it affects your site

404
00:14:12,560 --> 00:14:14,560
you know what about third party plugins

405
00:14:14,560 --> 00:14:16,639
what about tracking

406
00:14:16,639 --> 00:14:18,639
what if you use an analytics

407
00:14:18,639 --> 00:14:20,160
platform

408
00:14:20,160 --> 00:14:22,320
what if you use open source dependencies

409
00:14:22,320 --> 00:14:24,800
now this was a common one

410
00:14:24,800 --> 00:14:26,320
that we saw just recently there was an

411
00:14:26,320 --> 00:14:29,360
npm package that was compromised and i i

412
00:14:29,360 --> 00:14:30,800
forget the numbers off the top of my

413
00:14:30,800 --> 00:14:32,480
head but there were you know thousands

414
00:14:32,480 --> 00:14:35,040
of sites that were using this single npm

415
00:14:35,040 --> 00:14:37,440
package that um

416
00:14:37,440 --> 00:14:40,160
installed a crypto miner

417
00:14:40,160 --> 00:14:42,399
so you know you have so many different

418
00:14:42,399 --> 00:14:44,800
points that your site can change and

419
00:14:44,800 --> 00:14:48,000
maybe you don't know about it

420
00:14:48,000 --> 00:14:49,680
just some examples of

421
00:14:49,680 --> 00:14:53,519
of code we've we've seen before um

422
00:14:53,519 --> 00:14:56,240
so who can tell me what that does i

423
00:14:56,240 --> 00:14:58,639
have no idea this is just a snippet

424
00:14:58,639 --> 00:15:01,199
but this is javascript code is

425
00:15:01,199 --> 00:15:02,639
actually part of

426
00:15:02,639 --> 00:15:04,240
part of a compromise

427
00:15:04,240 --> 00:15:05,680
and they've gotten really good at

428
00:15:05,680 --> 00:15:09,359
obfuscating its purpose

429
00:15:10,240 --> 00:15:11,839
now this one uses a little bit more

430
00:15:11,839 --> 00:15:15,040
plain language plain plain english

431
00:15:15,040 --> 00:15:17,199
but even still it's it's fairly

432
00:15:17,199 --> 00:15:18,480
difficult

433
00:15:18,480 --> 00:15:20,320
to spot and this was inserted into a

434
00:15:20,320 --> 00:15:22,399
jquery library so that means there was a

435
00:15:22,399 --> 00:15:24,560
library file that was several megabytes

436
00:15:24,560 --> 00:15:27,279
in size you know jquery is not

437
00:15:27,279 --> 00:15:29,360
not small by any means

438
00:15:29,360 --> 00:15:30,880
and then this little

439
00:15:30,880 --> 00:15:33,040
this little snippet this is just part of

440
00:15:33,040 --> 00:15:33,759
it

441
00:15:33,759 --> 00:15:37,440
was inserted into that library

442
00:15:37,440 --> 00:15:40,560
here's another example this one used

443
00:15:40,560 --> 00:15:42,800
a bunch of strings which it then

444
00:15:42,800 --> 00:15:45,759
reassembled into code later on so i had

445
00:15:45,759 --> 00:15:48,720
a whole bunch of these static

446
00:15:48,720 --> 00:15:50,880
values here and then it reassembled it

447
00:15:50,880 --> 00:15:54,160
into code later on in in there um so the

448
00:15:54,160 --> 00:15:56,240
to the casual observer you know figuring

449
00:15:56,240 --> 00:15:58,079
out what that's doing and and why it's

450
00:15:58,079 --> 00:15:59,440
there is

451
00:15:59,440 --> 00:16:02,480
extremely difficult

452
00:16:03,920 --> 00:16:06,079
so this one here was another another

453
00:16:06,079 --> 00:16:08,800
skimmer um it was a little more obvious

454
00:16:08,800 --> 00:16:10,320
you can see right in the middle there

455
00:16:10,320 --> 00:16:11,279
that

456
00:16:11,279 --> 00:16:14,480
push to a url

457
00:16:15,440 --> 00:16:17,759
so that was actually harvesting

458
00:16:17,759 --> 00:16:19,600
data from the site and then it would

459
00:16:19,600 --> 00:16:21,920
just push it to this url and then down

460
00:16:21,920 --> 00:16:23,680
at the bottom it actually used a

461
00:16:23,680 --> 00:16:26,639
math.random function to generate a

462
00:16:26,639 --> 00:16:29,600
slightly random url

463
00:16:29,600 --> 00:16:32,720
that put that data to

464
00:16:32,800 --> 00:16:36,758
just another example there

465
00:16:38,160 --> 00:16:40,480
this is was an interesting one as well

466
00:16:40,480 --> 00:16:42,560
it was inserted into

467
00:16:42,560 --> 00:16:44,320
google analytics code

468
00:16:44,320 --> 00:16:47,279
so a google analytics library was

469
00:16:47,279 --> 00:16:49,199
pulled down from google inserted into

470
00:16:49,199 --> 00:16:50,720
the page and then they added their own

471
00:16:50,720 --> 00:16:52,079
code to it

472
00:16:52,079 --> 00:16:54,320
so right at the top of the page you saw

473
00:16:54,320 --> 00:16:57,440
copyright 2012 google

474
00:16:57,440 --> 00:16:58,560
and then

475
00:16:58,560 --> 00:17:00,880
further on down there was a function

476
00:17:00,880 --> 00:17:02,800
within there

477
00:17:02,800 --> 00:17:03,600
you know

478
00:17:03,600 --> 00:17:05,520
who knows what google analytics should

479
00:17:05,520 --> 00:17:06,640
look like

480
00:17:06,640 --> 00:17:08,799
who knows whether google analytics code

481
00:17:08,799 --> 00:17:11,119
should be on your site versus pulled

482
00:17:11,119 --> 00:17:12,000
from

483
00:17:12,000 --> 00:17:15,119
you know google themselves

484
00:17:16,240 --> 00:17:17,520
so

485
00:17:17,520 --> 00:17:19,439
it's fairly easy

486
00:17:19,439 --> 00:17:21,199
on a lot of these to get an idea of

487
00:17:21,199 --> 00:17:22,880
what's going on

488
00:17:22,880 --> 00:17:25,760
things like de-obfuscate.io can help you

489
00:17:25,760 --> 00:17:28,559
reverse engineer what's going on it it's

490
00:17:28,559 --> 00:17:29,919
not 100

491
00:17:29,919 --> 00:17:31,600
in every case

492
00:17:31,600 --> 00:17:33,840
but we don't really need it to be

493
00:17:33,840 --> 00:17:35,200
you know that

494
00:17:35,200 --> 00:17:37,200
when you're looking at these these types

495
00:17:37,200 --> 00:17:39,600
of code here all you really need to know

496
00:17:39,600 --> 00:17:42,400
is that something looks fishy

497
00:17:42,400 --> 00:17:44,799
and once you get used to or once you see

498
00:17:44,799 --> 00:17:46,960
a few samples of these they'll start to

499
00:17:46,960 --> 00:17:48,799
to stick out to you because your

500
00:17:48,799 --> 00:17:50,799
javascript code on your site is going to

501
00:17:50,799 --> 00:17:53,760
look well formed it's going to have

502
00:17:53,760 --> 00:17:57,440
defined functions it's going to be

503
00:17:57,440 --> 00:17:59,280
short little

504
00:17:59,280 --> 00:18:01,120
lines of code rather than

505
00:18:01,120 --> 00:18:04,080
these big long strings

506
00:18:04,080 --> 00:18:05,919
and so once you once you know what to

507
00:18:05,919 --> 00:18:07,679
look for then it's pretty easy to spot

508
00:18:07,679 --> 00:18:09,280
those and so you don't necessarily need

509
00:18:09,280 --> 00:18:11,360
to reverse engineer the whole thing just

510
00:18:11,360 --> 00:18:14,480
to figure out what it's doing

511
00:18:14,480 --> 00:18:17,520
what you really need to do is

512
00:18:17,520 --> 00:18:19,760
figure out your indicators so you're

513
00:18:19,760 --> 00:18:22,240
looking at you know what domains is it

514
00:18:22,240 --> 00:18:24,000
contacting how is it what's it doing

515
00:18:24,000 --> 00:18:26,960
with the data that's harvesting

516
00:18:26,960 --> 00:18:28,640
that sort of thing we don't really care

517
00:18:28,640 --> 00:18:31,360
exactly how it's assembling that data to

518
00:18:31,360 --> 00:18:32,880
be shipped off we just care about where

519
00:18:32,880 --> 00:18:36,799
it's going and how we can stop it

520
00:18:37,440 --> 00:18:40,799
js beautify in cyber chef is a good tool

521
00:18:40,799 --> 00:18:42,480
especially if you're dealing with like

522
00:18:42,480 --> 00:18:44,960
minified code

523
00:18:44,960 --> 00:18:47,440
you toss it in there it formats it

524
00:18:47,440 --> 00:18:49,120
nicely for you so it's much easier to

525
00:18:49,120 --> 00:18:51,360
read

526
00:18:52,160 --> 00:18:54,160
so once again we just need our iocs we

527
00:18:54,160 --> 00:18:55,600
don't need to understand exactly what

528
00:18:55,600 --> 00:18:58,000
happens

529
00:18:58,799 --> 00:19:00,400
but that led me to

530
00:19:00,400 --> 00:19:02,480
how can i be proactive how can i move

531
00:19:02,480 --> 00:19:05,280
forward how can i detect these before we

532
00:19:05,280 --> 00:19:07,280
get a letter from the payment processors

533
00:19:07,280 --> 00:19:09,520
how can we figure out how to stop this

534
00:19:09,520 --> 00:19:11,760
before the the compromise or at least

535
00:19:11,760 --> 00:19:13,840
minimize the compromise

536
00:19:13,840 --> 00:19:16,320
because after the fact leads to things

537
00:19:16,320 --> 00:19:18,880
like loss of reputation or loss of you

538
00:19:18,880 --> 00:19:21,440
know your relationship with the

539
00:19:21,440 --> 00:19:23,760
payment processor you may have to move

540
00:19:23,760 --> 00:19:25,280
on to a different payment processor if

541
00:19:25,280 --> 00:19:28,559
you have too many of these breaches

542
00:19:28,559 --> 00:19:30,320
so we started brainstorming you know

543
00:19:30,320 --> 00:19:32,799
what can we do

544
00:19:32,799 --> 00:19:34,720
we looked at tracking the domains that

545
00:19:34,720 --> 00:19:37,200
are called you know a lot of these

546
00:19:37,200 --> 00:19:40,080
javascript malwares are are pushing

547
00:19:40,080 --> 00:19:41,360
data to some

548
00:19:41,360 --> 00:19:43,600
um relatively obscure domain

549
00:19:43,600 --> 00:19:44,799
and

550
00:19:44,799 --> 00:19:46,480
so if we can track those if we track

551
00:19:46,480 --> 00:19:48,880
those dns requests then maybe we can

552
00:19:48,880 --> 00:19:50,400
figure out when the site's compromised

553
00:19:50,400 --> 00:19:52,480
because they're doing

554
00:19:52,480 --> 00:19:56,240
strange dns calls on a regular basis

555
00:19:56,240 --> 00:19:57,679
we thought about using

556
00:19:57,679 --> 00:19:59,679
selenium to

557
00:19:59,679 --> 00:20:02,400
obtain network statistics so we go to

558
00:20:02,400 --> 00:20:04,480
the page we we visit the page and we

559
00:20:04,480 --> 00:20:06,480
track every network call that that

560
00:20:06,480 --> 00:20:07,760
happens

561
00:20:07,760 --> 00:20:08,880
as we

562
00:20:08,880 --> 00:20:11,679
go through and process the page

563
00:20:11,679 --> 00:20:13,280
thought about even just using curl and

564
00:20:13,280 --> 00:20:16,720
regex looking for specific keywords

565
00:20:16,720 --> 00:20:18,080
that one didn't work very well because

566
00:20:18,080 --> 00:20:19,600
there aren't very many keywords we can

567
00:20:19,600 --> 00:20:21,120
use

568
00:20:21,120 --> 00:20:23,919
we looked at hashing the dom and just

569
00:20:23,919 --> 00:20:25,840
every time the dom changes on the site

570
00:20:25,840 --> 00:20:29,200
investigating but you know with any file

571
00:20:29,200 --> 00:20:31,600
integrity integrity monitoring that's

572
00:20:31,600 --> 00:20:33,120
you know lots of false positives

573
00:20:33,120 --> 00:20:34,720
especially when you're dealing with

574
00:20:34,720 --> 00:20:36,640
third parties that may update underneath

575
00:20:36,640 --> 00:20:38,880
you

576
00:20:39,520 --> 00:20:41,760
an interesting one

577
00:20:41,760 --> 00:20:44,240
entropy analysis so i thought well maybe

578
00:20:44,240 --> 00:20:45,840
i can look at entropy

579
00:20:45,840 --> 00:20:47,200
because these

580
00:20:47,200 --> 00:20:49,440
this malware that we're looking at

581
00:20:49,440 --> 00:20:52,000
it looks pretty random to me

582
00:20:52,000 --> 00:20:54,880
as opposed to regular javascript code

583
00:20:54,880 --> 00:20:57,200
but once i started putting the samples i

584
00:20:57,200 --> 00:20:59,360
had into

585
00:20:59,360 --> 00:21:02,159
some some entry entropy analysis it

586
00:21:02,159 --> 00:21:03,840
actually turned out that

587
00:21:03,840 --> 00:21:05,520
um

588
00:21:05,520 --> 00:21:07,679
the entropy was higher on regular

589
00:21:07,679 --> 00:21:10,559
javascript code from you know

590
00:21:10,559 --> 00:21:14,720
third-party sites versus the the malware

591
00:21:14,720 --> 00:21:18,320
the malware repeated enough um that it

592
00:21:18,320 --> 00:21:21,039
didn't look like it was very random

593
00:21:21,039 --> 00:21:23,039
and so it was it was actually the

594
00:21:23,039 --> 00:21:26,000
opposite i expected i expected that um

595
00:21:26,000 --> 00:21:27,919
an entropy analysis would take a

596
00:21:27,919 --> 00:21:29,200
malicious script and it would

597
00:21:29,200 --> 00:21:32,240
immediately flag it as high entropy and

598
00:21:32,240 --> 00:21:34,240
look very suspicious but it turned out

599
00:21:34,240 --> 00:21:35,840
to be exactly the opposite of what i

600
00:21:35,840 --> 00:21:38,080
thought

601
00:21:38,400 --> 00:21:39,919
thread intel feeds

602
00:21:39,919 --> 00:21:42,159
turn out to be not great

603
00:21:42,159 --> 00:21:44,960
usually because of the

604
00:21:44,960 --> 00:21:47,600
um the way these these people operate

605
00:21:47,600 --> 00:21:50,080
and that is that they buy their time

606
00:21:50,080 --> 00:21:52,240
they wait for the right time to

607
00:21:52,240 --> 00:21:54,880
drop their their malware their skimmer

608
00:21:54,880 --> 00:21:55,760
code

609
00:21:55,760 --> 00:21:58,400
and then they operate using a basically

610
00:21:58,400 --> 00:22:02,000
identic domain per engagement and so

611
00:22:02,000 --> 00:22:03,840
once once that's burned they don't go

612
00:22:03,840 --> 00:22:05,520
back to it and so usually the thread

613
00:22:05,520 --> 00:22:08,559
intel feeds are behind

614
00:22:08,559 --> 00:22:11,120
several steps behind the the

615
00:22:11,120 --> 00:22:13,600
attackers

616
00:22:13,600 --> 00:22:15,919
so we started down the the path of

617
00:22:15,919 --> 00:22:18,640
selenium at first and

618
00:22:18,640 --> 00:22:20,720
um pointing selenium of the site

619
00:22:20,720 --> 00:22:23,280
analyzing the results and

620
00:22:23,280 --> 00:22:24,960
generating

621
00:22:24,960 --> 00:22:27,520
statistical analysis on that

622
00:22:27,520 --> 00:22:29,200
um

623
00:22:29,200 --> 00:22:31,520
but it turns out why why reinvent the

624
00:22:31,520 --> 00:22:33,918
wheel

625
00:22:34,640 --> 00:22:36,400
and this isn't really an

626
00:22:36,400 --> 00:22:38,400
endorsement of url scan it's just the

627
00:22:38,400 --> 00:22:40,559
tool we ended up using there's a bunch

628
00:22:40,559 --> 00:22:41,760
out there

629
00:22:41,760 --> 00:22:45,280
but urlscan.io has a an api

630
00:22:45,280 --> 00:22:47,120
interface where you can do exactly what

631
00:22:47,120 --> 00:22:48,159
we were talking about doing with

632
00:22:48,159 --> 00:22:51,120
selenium which is we

633
00:22:51,120 --> 00:22:53,280
load the site we parse it

634
00:22:53,280 --> 00:22:54,400
we stored

635
00:22:54,400 --> 00:22:56,880
data about it and then used that for

636
00:22:56,880 --> 00:23:00,159
statistical analysis

637
00:23:00,320 --> 00:23:03,919
and it has everything we need there

638
00:23:03,919 --> 00:23:06,159
when you load up a site it shows you

639
00:23:06,159 --> 00:23:08,640
all the domains that are called all the

640
00:23:08,640 --> 00:23:10,080
scripts that are loaded

641
00:23:10,080 --> 00:23:12,400
all the ip addresses that are touched

642
00:23:12,400 --> 00:23:13,760
you know all the

643
00:23:13,760 --> 00:23:16,000
various supporting components of the the

644
00:23:16,000 --> 00:23:18,320
site

645
00:23:19,760 --> 00:23:22,559
so if we run url scan provides us back

646
00:23:22,559 --> 00:23:24,080
at json

647
00:23:24,080 --> 00:23:24,880
with

648
00:23:24,880 --> 00:23:26,960
everything we need to know it gives you

649
00:23:26,960 --> 00:23:29,120
hashes of all the files it downloads

650
00:23:29,120 --> 00:23:30,799
names

651
00:23:30,799 --> 00:23:34,000
you can even grab contents if you want

652
00:23:34,000 --> 00:23:36,880
but i was interested in a few key fields

653
00:23:36,880 --> 00:23:39,039
to begin with and so we started with

654
00:23:39,039 --> 00:23:40,880
that i just used python and i parsed out

655
00:23:40,880 --> 00:23:43,200
the json

656
00:23:43,200 --> 00:23:44,559
grab the dates

657
00:23:44,559 --> 00:23:48,880
the pages obtained a pagehash

658
00:23:48,880 --> 00:23:52,159
um but at this point i i wasn't quite

659
00:23:52,159 --> 00:23:55,039
ready for um full analysis of it you

660
00:23:55,039 --> 00:23:57,120
know i just wanted to gather statistical

661
00:23:57,120 --> 00:24:00,959
data to see if i could prove my point

662
00:24:02,720 --> 00:24:04,799
and it also makes it really easy if you

663
00:24:04,799 --> 00:24:06,720
do find something

664
00:24:06,720 --> 00:24:09,600
there's an indicators that you can

665
00:24:09,600 --> 00:24:11,919
pull either from the api or url scan

666
00:24:11,919 --> 00:24:14,159
site that has every

667
00:24:14,159 --> 00:24:16,799
possible indicator related to this site

668
00:24:16,799 --> 00:24:18,320
so then you can just go through and pick

669
00:24:18,320 --> 00:24:21,918
out the ones that you're interested in

670
00:24:22,000 --> 00:24:23,760
and there's a bonus so a company called

671
00:24:23,760 --> 00:24:26,320
sansec dia io

672
00:24:26,320 --> 00:24:27,919
they're pretty

673
00:24:27,919 --> 00:24:31,120
popular in the e-commerce like scanning

674
00:24:31,120 --> 00:24:33,679
field they've actually collaborated with

675
00:24:33,679 --> 00:24:36,880
url scan to provide

676
00:24:36,880 --> 00:24:39,679
classification of sites and and scripts

677
00:24:39,679 --> 00:24:40,880
that are pulled in

678
00:24:40,880 --> 00:24:42,640
so they there's a little bit of thread

679
00:24:42,640 --> 00:24:44,720
intel in there and so far i haven't

680
00:24:44,720 --> 00:24:46,559
found it super valuable but it's you

681
00:24:46,559 --> 00:24:48,559
know a bonus you get

682
00:24:48,559 --> 00:24:51,279
for the the cost of an api key which is

683
00:24:51,279 --> 00:24:55,120
if your small volume is free

684
00:24:55,279 --> 00:24:57,279
and then from there what we did

685
00:24:57,279 --> 00:24:58,960
is we actually turned it into a splunk

686
00:24:58,960 --> 00:25:01,919
soar or phantom project

687
00:25:01,919 --> 00:25:04,159
we use phantom to

688
00:25:04,159 --> 00:25:06,400
query splunk figure out domain names

689
00:25:06,400 --> 00:25:07,279
that

690
00:25:07,279 --> 00:25:08,720
of sites so we don't have to keep that

691
00:25:08,720 --> 00:25:10,480
list up to date

692
00:25:10,480 --> 00:25:11,360
and then

693
00:25:11,360 --> 00:25:13,919
kick off automated scans from url scan

694
00:25:13,919 --> 00:25:15,919
pull back the results and then ingest it

695
00:25:15,919 --> 00:25:18,159
back into splunk for

696
00:25:18,159 --> 00:25:20,640
our own data analysis

697
00:25:20,640 --> 00:25:23,440
the original backup plan was to use

698
00:25:23,440 --> 00:25:25,840
lambda lambda functions to

699
00:25:25,840 --> 00:25:28,000
kick off the api calls and then pull

700
00:25:28,000 --> 00:25:29,760
back the data and store it in s3 and

701
00:25:29,760 --> 00:25:31,600
then we'd figure out how to ingest it

702
00:25:31,600 --> 00:25:34,080
from there

703
00:25:34,799 --> 00:25:37,120
about midway through this project

704
00:25:37,120 --> 00:25:39,200
there was an announcement from

705
00:25:39,200 --> 00:25:40,400
i don't know if you're familiar with him

706
00:25:40,400 --> 00:25:41,840
his name's scott helm

707
00:25:41,840 --> 00:25:45,200
he runs report url uri.com

708
00:25:45,200 --> 00:25:47,279
he actually made an announcement about

709
00:25:47,279 --> 00:25:49,279
they were offering an e-commerce

710
00:25:49,279 --> 00:25:50,960
solution

711
00:25:50,960 --> 00:25:54,240
and that included a couple key tools one

712
00:25:54,240 --> 00:25:55,760
called script watch and one called

713
00:25:55,760 --> 00:25:57,760
content security policy

714
00:25:57,760 --> 00:25:59,840
and basically it was designed to do

715
00:25:59,840 --> 00:26:01,279
exactly what

716
00:26:01,279 --> 00:26:02,880
what i was intending to do with this

717
00:26:02,880 --> 00:26:03,840
project

718
00:26:03,840 --> 00:26:05,520
um so

719
00:26:05,520 --> 00:26:07,600
you know great minds think alike maybe

720
00:26:07,600 --> 00:26:08,640
hopefully

721
00:26:08,640 --> 00:26:09,440
um

722
00:26:09,440 --> 00:26:12,000
but it's a turnkey solution if you know

723
00:26:12,000 --> 00:26:13,279
if you don't want to implement this

724
00:26:13,279 --> 00:26:14,240
yourself

725
00:26:14,240 --> 00:26:15,600
there's definitely companies out there

726
00:26:15,600 --> 00:26:17,120
who are doing it

727
00:26:17,120 --> 00:26:19,520
and you can employ them to to do it for

728
00:26:19,520 --> 00:26:21,679
you

729
00:26:21,919 --> 00:26:24,559
leaves you time to deal with the false

730
00:26:24,559 --> 00:26:26,400
positives and tuning rather than you

731
00:26:26,400 --> 00:26:27,760
know building infrastructure and that

732
00:26:27,760 --> 00:26:29,840
sort of thing

733
00:26:29,840 --> 00:26:30,720
so

734
00:26:30,720 --> 00:26:32,400
like i said before this isn't

735
00:26:32,400 --> 00:26:34,320
necessarily an endorsement of url scan

736
00:26:34,320 --> 00:26:35,919
it's just what we found that works well

737
00:26:35,919 --> 00:26:38,080
for us

738
00:26:38,080 --> 00:26:39,279
and

739
00:26:39,279 --> 00:26:41,039
the intent of this talk was more to

740
00:26:41,039 --> 00:26:43,679
demonstrate that the techniques involved

741
00:26:43,679 --> 00:26:45,600
with this rather than

742
00:26:45,600 --> 00:26:49,199
dependency on the specific tool

743
00:26:50,480 --> 00:26:53,039
so what i have um so far

744
00:26:53,039 --> 00:26:55,520
uh we haven't completed this project so

745
00:26:55,520 --> 00:26:56,720
so if any of you are working on

746
00:26:56,720 --> 00:26:58,720
something similar definitely find me on

747
00:26:58,720 --> 00:27:00,400
the um

748
00:27:00,400 --> 00:27:03,200
besides slc slack

749
00:27:03,200 --> 00:27:04,559
if you'd like to collaborate you know

750
00:27:04,559 --> 00:27:06,880
i'd be that happy to share share what

751
00:27:06,880 --> 00:27:08,640
i've been working on

752
00:27:08,640 --> 00:27:10,080
we can figure out how to

753
00:27:10,080 --> 00:27:13,199
make things better together

754
00:27:13,840 --> 00:27:17,080
any questions

755
00:27:20,559 --> 00:27:24,200
all right thank you

756
00:27:24,950 --> 00:27:28,029
[Applause]

