1
00:00:00,000 --> 00:00:08,099
so can everyone hear me good in the back

2
00:00:03,830 --> 00:00:10,349
<font color="#CCCCCC">all right good</font><font color="#E5E5E5"> good so my</font><font color="#CCCCCC"> name is</font><font color="#E5E5E5"> Rob he</font>

3
00:00:08,099 --> 00:00:13,049
is giving me a very good introduction

4
00:00:10,349 --> 00:00:15,139
thank you<font color="#E5E5E5"> very much so I'm going to be</font>

5
00:00:13,049 --> 00:00:18,240
speaking today on plague scanner and

6
00:00:15,139 --> 00:00:20,460
this is an open source project that has

7
00:00:18,240 --> 00:00:24,180
been in the works probably for about two

8
00:00:20,460 --> 00:00:26,400
and a half years it has coagulated into

9
00:00:24,180 --> 00:00:29,910
something real in the past<font color="#E5E5E5"> six</font><font color="#CCCCCC"> months</font>

10
00:00:26,400 --> 00:00:33,180
and I've been<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> a number</font><font color="#CCCCCC"> of other</font>

11
00:00:29,910 --> 00:00:36,120
conferences and giving talks on it and

12
00:00:33,180 --> 00:00:38,519
this is the latest iteration of it so

13
00:00:36,120 --> 00:00:40,019
Who am I I'm a senior threat

14
00:00:38,520 --> 00:00:42,780
intelligence researcher for threat

15
00:00:40,020 --> 00:00:44,520
connect we're in arlington<font color="#CCCCCC"> virginia my</font>

16
00:00:42,780 --> 00:00:46,739
contact<font color="#CCCCCC"> information is at the bottom</font>

17
00:00:44,520 --> 00:00:49,350
that's my Twitter handle and email

18
00:00:46,739 --> 00:00:52,199
address<font color="#E5E5E5"> I can also give you a card later</font>

19
00:00:49,350 --> 00:00:55,289
after<font color="#CCCCCC"> the talk so we can contact each</font>

20
00:00:52,199 --> 00:00:57,449
other later so let's<font color="#E5E5E5"> just go into the</font>

21
00:00:55,289 --> 00:01:00,239
<font color="#E5E5E5">problem here so you</font><font color="#CCCCCC"> have an unknown or</font>

22
00:00:57,449 --> 00:01:02,879
malicious binary and you want to scan it

23
00:01:00,239 --> 00:01:04,860
with as many AV engines as possible so

24
00:01:02,879 --> 00:01:07,229
there<font color="#CCCCCC"> are a couple of there are a couple</font>

25
00:01:04,860 --> 00:01:10,740
of ways that<font color="#CCCCCC"> you can do</font><font color="#E5E5E5"> this a couple of</font>

26
00:01:07,229 --> 00:01:13,350
options available<font color="#E5E5E5"> to you so the first</font>

27
00:01:10,740 --> 00:01:16,548
option available is to upload the binary

28
00:01:13,350 --> 00:01:19,199
to a multiple AV scanner site online and

29
00:01:16,549 --> 00:01:21,180
we all know which ones these are there

30
00:01:19,200 --> 00:01:22,860
are a few<font color="#E5E5E5"> of them there there's a</font>

31
00:01:21,180 --> 00:01:25,500
growing number of them people will

32
00:01:22,860 --> 00:01:27,630
actually put up a version of cuckoo

33
00:01:25,500 --> 00:01:29,490
sandbox and put it online and<font color="#E5E5E5"> then just</font>

34
00:01:27,630 --> 00:01:31,229
collect binaries from it it's a very

35
00:01:29,490 --> 00:01:33,899
<font color="#E5E5E5">good technique for gathering binaries</font>

36
00:01:31,229 --> 00:01:36,689
and let me repeat that it's a very<font color="#E5E5E5"> good</font>

37
00:01:33,900 --> 00:01:38,909
technique for gathering binaries so they

38
00:01:36,689 --> 00:01:42,270
are gathering the binary that you upload

39
00:01:38,909 --> 00:01:45,479
so let's say<font color="#CCCCCC"> your your you've</font><font color="#E5E5E5"> got a</font>

40
00:01:42,270 --> 00:01:47,670
weaponized PDF and we'll we'll see<font color="#E5E5E5"> some</font>

41
00:01:45,479 --> 00:01:49,679
of<font color="#E5E5E5"> that in a moment you don't</font>

42
00:01:47,670 --> 00:01:51,869
necessarily want<font color="#CCCCCC"> to upload that to any</font>

43
00:01:49,680 --> 00:01:54,000
of these online sites because they are

44
00:01:51,869 --> 00:01:55,860
gathering the binaries and you don't

45
00:01:54,000 --> 00:01:57,630
know who they have who they're sharing

46
00:01:55,860 --> 00:02:01,110
those binaries with who has access<font color="#E5E5E5"> to</font>

47
00:01:57,630 --> 00:02:05,039
that data you<font color="#CCCCCC"> have to trust them and I</font>

48
00:02:01,110 --> 00:02:07,380
don't trust anybody so the second

49
00:02:05,040 --> 00:02:10,860
solution is to buy your own AV scanner

50
00:02:07,380 --> 00:02:13,440
engine system and these<font color="#CCCCCC"> are very very</font>

51
00:02:10,860 --> 00:02:13,840
very<font color="#CCCCCC"> very expensive</font><font color="#E5E5E5"> and I say very</font>

52
00:02:13,440 --> 00:02:17,560
expense

53
00:02:13,840 --> 00:02:19,300
I mean very very very expensive on the

54
00:02:17,560 --> 00:02:21,940
order of<font color="#E5E5E5"> eighty thousand dollars a year</font>

55
00:02:19,300 --> 00:02:24,640
type expensive so that's not really<font color="#E5E5E5"> an</font>

56
00:02:21,940 --> 00:02:26,319
option for small guys that's an option

57
00:02:24,640 --> 00:02:28,119
for a giant<font color="#E5E5E5"> enterprise but a giant</font>

58
00:02:26,319 --> 00:02:31,238
<font color="#CCCCCC">Enterprise might have other you know</font>

59
00:02:28,120 --> 00:02:34,209
other resources available so that's not

60
00:02:31,239 --> 00:02:37,450
an option that's that's viable for me so

61
00:02:34,209 --> 00:02:39,549
solution number three is to create open

62
00:02:37,450 --> 00:02:42,099
source multiple AV scanner framework and

63
00:02:39,549 --> 00:02:47,680
share it<font color="#CCCCCC"> with the world Allah some of my</font>

64
00:02:42,099 --> 00:02:49,899
<font color="#E5E5E5">favorite projects out there so let me</font>

65
00:02:47,680 --> 00:02:53,470
give you a few real world use cases for

66
00:02:49,900 --> 00:02:57,220
this so I I originally had spoken<font color="#E5E5E5"> with a</font>

67
00:02:53,470 --> 00:02:59,349
number of<font color="#CCCCCC"> people at</font><font color="#E5E5E5"> Def Con about this</font>

68
00:02:57,220 --> 00:03:00,959
and that's where the the whole idea came

69
00:02:59,349 --> 00:03:04,839
from and we'll get<font color="#E5E5E5"> that in a minute</font><font color="#CCCCCC"> but</font>

70
00:03:00,959 --> 00:03:06,940
my my you know my use case is blue team

71
00:03:04,840 --> 00:03:08,769
so targeted<font color="#E5E5E5"> weaponize PDFs and other</font>

72
00:03:06,940 --> 00:03:12,400
types of documents with corporate data

73
00:03:08,769 --> 00:03:15,190
embedded in there as bait those are<font color="#E5E5E5"> the</font>

74
00:03:12,400 --> 00:03:17,799
types of things that this is is meant

75
00:03:15,190 --> 00:03:21,730
for however when<font color="#E5E5E5"> I was speaking at</font>

76
00:03:17,799 --> 00:03:25,060
shmoocon this year I spoke<font color="#CCCCCC"> with a group</font>

77
00:03:21,730 --> 00:03:26,980
of people<font color="#CCCCCC"> who work on pen testing and</font>

78
00:03:25,060 --> 00:03:28,989
they developed their own malware and

79
00:03:26,980 --> 00:03:31,030
they want something<font color="#E5E5E5"> like this because</font>

80
00:03:28,989 --> 00:03:34,150
they don't want<font color="#E5E5E5"> to share their targeted</font>

81
00:03:31,030 --> 00:03:35,739
you know custom malware that they're

82
00:03:34,150 --> 00:03:39,579
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> use on a red team engagement</font>

83
00:03:35,739 --> 00:03:42,819
with you know the<font color="#E5E5E5"> the general public of</font>

84
00:03:39,579 --> 00:03:44,410
<font color="#E5E5E5">the variety of online sites so that's a</font>

85
00:03:42,819 --> 00:03:46,298
different use case that I hadn't really

86
00:03:44,410 --> 00:03:49,900
thought about but it's a valid use case

87
00:03:46,299 --> 00:03:52,389
for this obviously<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> want to have</font>

88
00:03:49,900 --> 00:03:54,040
adversaries looking at this and using<font color="#E5E5E5"> it</font>

89
00:03:52,389 --> 00:03:55,810
but it's open source if they want to<font color="#CCCCCC"> go</font>

90
00:03:54,040 --> 00:04:00,880
pay for all of it and put it together

91
00:03:55,810 --> 00:04:03,160
you know it's it's out there so let<font color="#E5E5E5"> me</font>

92
00:04:00,880 --> 00:04:04,870
give you a quick demo of what I'm

93
00:04:03,160 --> 00:04:12,519
talking about<font color="#E5E5E5"> here and what sort of</font>

94
00:04:04,870 --> 00:04:14,709
things you would use this for so this so

95
00:04:12,519 --> 00:04:21,820
I recorded the demo just to appease the

96
00:04:14,709 --> 00:04:24,219
demo gods so as<font color="#E5E5E5"> you might recognize this</font>

97
00:04:21,820 --> 00:04:26,650
<font color="#E5E5E5">is a reverse engineering malware</font>

98
00:04:24,219 --> 00:04:28,719
workstation environment

99
00:04:26,650 --> 00:04:29,859
I have a number<font color="#E5E5E5"> of tools go ahead</font><font color="#CCCCCC"> and</font>

100
00:04:28,720 --> 00:04:31,960
take<font color="#E5E5E5"> a screenshot if you don't know all</font>

101
00:04:29,860 --> 00:04:32,949
those tools you know you might see some

102
00:04:31,960 --> 00:04:34,989
that you don't know you might<font color="#E5E5E5"> see</font>

103
00:04:32,949 --> 00:04:37,240
something that<font color="#E5E5E5"> you do know so this is</font>

104
00:04:34,990 --> 00:04:40,030
I've<font color="#CCCCCC"> got process hacker open on the</font>

105
00:04:37,240 --> 00:04:41,800
right some people<font color="#CCCCCC"> use a</font><font color="#E5E5E5"> different tools</font>

106
00:04:40,030 --> 00:04:46,900
they're all essentially the same<font color="#CCCCCC"> thing</font>

107
00:04:41,800 --> 00:04:49,509
as task manager but on steroids so let's

108
00:04:46,900 --> 00:04:53,049
<font color="#E5E5E5">watch what happens so you can see in</font>

109
00:04:49,509 --> 00:04:56,289
process hacker everything looks nice and

110
00:04:53,050 --> 00:04:58,210
clean let me hold on cause this and move

111
00:04:56,289 --> 00:05:03,490
the move<font color="#CCCCCC"> that down so you can see</font>

112
00:04:58,210 --> 00:05:07,599
process hacker fully<font color="#E5E5E5"> okay so this is the</font>

113
00:05:03,490 --> 00:05:09,520
PDF attachment to an email and boom huh

114
00:05:07,600 --> 00:05:13,720
current literature that's very

115
00:05:09,520 --> 00:05:15,340
<font color="#CCCCCC">interesting that's from 1891 and what</font>

116
00:05:13,720 --> 00:05:18,280
<font color="#E5E5E5">makes this really interesting is this</font>

117
00:05:15,340 --> 00:05:21,369
PDF is six pages long that's<font color="#CCCCCC"> actually</font>

118
00:05:18,280 --> 00:05:23,289
very rare for malware to weaponize

119
00:05:21,370 --> 00:05:25,780
something that's<font color="#E5E5E5"> more</font><font color="#CCCCCC"> than just one</font><font color="#E5E5E5"> page</font>

120
00:05:23,289 --> 00:05:28,840
usually they just have one page<font color="#CCCCCC"> to kind</font>

121
00:05:25,780 --> 00:05:32,049
of you know bait you into clicking or

122
00:05:28,840 --> 00:05:33,969
opening or<font color="#E5E5E5"> remaining there so this</font><font color="#CCCCCC"> is</font>

123
00:05:32,050 --> 00:05:38,710
actually<font color="#E5E5E5"> a six-page document this this</font>

124
00:05:33,970 --> 00:05:41,260
came<font color="#CCCCCC"> in on on a sensor that I have and</font>

125
00:05:38,710 --> 00:05:44,198
it actually has access to one of those

126
00:05:41,260 --> 00:05:47,289
online AV scanner engines and let me

127
00:05:44,199 --> 00:05:49,659
pause this for a second so we can<font color="#E5E5E5"> just</font>

128
00:05:47,289 --> 00:05:51,789
go over<font color="#E5E5E5"> that for a second so I collected</font>

129
00:05:49,659 --> 00:05:53,979
this from a<font color="#E5E5E5"> Navy on one of those online</font>

130
00:05:51,789 --> 00:05:57,039
AV scanner engines where someone else

131
00:05:53,979 --> 00:05:59,860
had uploaded it right so this doesn't

132
00:05:57,039 --> 00:06:01,449
<font color="#CCCCCC">exactly look too scary however this</font>

133
00:05:59,860 --> 00:06:03,400
piqued my interest and I thought you

134
00:06:01,449 --> 00:06:06,639
know this is<font color="#CCCCCC"> a six-page document this is</font>

135
00:06:03,400 --> 00:06:09,849
an unusual way of weaponizing something

136
00:06:06,639 --> 00:06:13,889
so<font color="#E5E5E5"> I started looking</font><font color="#CCCCCC"> into it I reverse</font>

137
00:06:09,849 --> 00:06:16,960
<font color="#CCCCCC">engineered this and the I'll actually</font>

138
00:06:13,889 --> 00:06:21,130
hit play again so as<font color="#E5E5E5"> you can see down</font>

139
00:06:16,960 --> 00:06:25,960
here there is an extra dll<font color="#E5E5E5"> host and also</font>

140
00:06:21,130 --> 00:06:32,349
the<font color="#CCCCCC"> i will highlight it</font><font color="#E5E5E5"> in a second come</font>

141
00:06:25,960 --> 00:06:36,099
on there we go so that's<font color="#E5E5E5"> the extra dll</font>

142
00:06:32,349 --> 00:06:39,610
<font color="#E5E5E5">host and then it is also running still a</font>

143
00:06:36,099 --> 00:06:40,270
copy of the reader which is the<font color="#E5E5E5"> built in</font>

144
00:06:39,610 --> 00:06:43,510
eight point

145
00:06:40,270 --> 00:06:45,669
one PDF reader for Microsoft so both of

146
00:06:43,510 --> 00:06:48,789
those are the dll host is running<font color="#E5E5E5"> that's</font>

147
00:06:45,670 --> 00:06:51,730
actually the malware and then that's<font color="#E5E5E5"> I'm</font>

148
00:06:48,790 --> 00:06:53,170
sorry and the the reader is still

149
00:06:51,730 --> 00:06:55,720
running it didn't shut down properly

150
00:06:53,170 --> 00:06:59,700
even though i clicked shut down and

151
00:06:55,720 --> 00:07:02,260
closed so it<font color="#CCCCCC"> definitely affected the the</font>

152
00:06:59,700 --> 00:07:03,700
reader process also<font color="#CCCCCC"> i'm going to</font>

153
00:07:02,260 --> 00:07:06,849
highlight this is one of<font color="#E5E5E5"> the reasons why</font>

154
00:07:03,700 --> 00:07:09,010
i like process hacker because you<font color="#E5E5E5"> can go</font>

155
00:07:06,850 --> 00:07:12,190
<font color="#CCCCCC">into a running</font><font color="#E5E5E5"> process and run strings</font>

156
00:07:09,010 --> 00:07:17,080
on its memory so that's actually<font color="#E5E5E5"> a very</font>

157
00:07:12,190 --> 00:07:22,030
<font color="#E5E5E5">cool feature so let me pause this and</font>

158
00:07:17,080 --> 00:07:24,340
let's go<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to the presentation so if</font>

159
00:07:22,030 --> 00:07:28,299
that so<font color="#E5E5E5"> that's actually a little bit</font>

160
00:07:24,340 --> 00:07:33,280
worrying where what's going on<font color="#E5E5E5"> there so</font>

161
00:07:28,300 --> 00:07:35,950
<font color="#CCCCCC">i went and took an SS deep hash and</font><font color="#E5E5E5"> if</font>

162
00:07:33,280 --> 00:07:39,549
anyone's familiar with SSD it's a it's

163
00:07:35,950 --> 00:07:42,120
<font color="#CCCCCC">called</font><font color="#E5E5E5"> a piecewise hash or a fuzzy hash</font>

164
00:07:39,550 --> 00:07:45,700
and what it does is<font color="#CCCCCC"> it takes</font><font color="#E5E5E5"> the entire</font>

165
00:07:42,120 --> 00:07:48,220
binary file and it essentially chops it

166
00:07:45,700 --> 00:07:51,070
up into pieces and then takes sub hashes

167
00:07:48,220 --> 00:07:53,050
of the different parts of it and what

168
00:07:51,070 --> 00:07:56,890
this<font color="#E5E5E5"> is good for</font><font color="#CCCCCC"> is instead of having</font>

169
00:07:53,050 --> 00:07:59,470
like a sha-1 or an md5 hash you can<font color="#E5E5E5"> then</font>

170
00:07:56,890 --> 00:08:02,620
take this hash and then see<font color="#CCCCCC"> how similar</font>

171
00:07:59,470 --> 00:08:04,720
the file that you have is to a group of

172
00:08:02,620 --> 00:08:07,570
other files that<font color="#E5E5E5"> have had an SSD patch</font>

173
00:08:04,720 --> 00:08:09,490
done to them so in mathematical terms

174
00:08:07,570 --> 00:08:11,500
the two hashes kind of make a

175
00:08:09,490 --> 00:08:16,930
three-dimensional distance between the

176
00:08:11,500 --> 00:08:18,940
two files but essentially you are you

177
00:08:16,930 --> 00:08:21,790
are looking for other files that<font color="#E5E5E5"> are</font>

178
00:08:18,940 --> 00:08:24,280
similar to this file so fortunately the

179
00:08:21,790 --> 00:08:26,890
same online<font color="#E5E5E5"> scanner engine that i found</font>

180
00:08:24,280 --> 00:08:29,650
this file has a way to search via SS

181
00:08:26,890 --> 00:08:31,330
deep so<font color="#E5E5E5"> i took the SS deep of this file</font>

182
00:08:29,650 --> 00:08:34,179
and looked for<font color="#E5E5E5"> other files that are</font>

183
00:08:31,330 --> 00:08:36,699
similar to it so<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is what's this is</font>

184
00:08:34,179 --> 00:08:38,140
where things get very scary this is this

185
00:08:36,700 --> 00:08:42,880
happened last week and this is all very

186
00:08:38,140 --> 00:08:44,620
new stuff so on<font color="#CCCCCC"> i looked at some of the</font>

187
00:08:42,880 --> 00:08:46,150
scanner results for<font color="#E5E5E5"> this and it turns</font>

188
00:08:44,620 --> 00:08:48,610
out that this piece of malware is called

189
00:08:46,150 --> 00:08:50,530
Earth sniff you might be familiar with

190
00:08:48,610 --> 00:08:52,930
it if you do malware<font color="#E5E5E5"> analysis maybe not</font>

191
00:08:50,530 --> 00:08:54,760
my focus is<font color="#E5E5E5"> crime where and that's one</font>

192
00:08:52,930 --> 00:08:58,449
that's one of the types of crime we're

193
00:08:54,760 --> 00:09:01,569
out there and<font color="#E5E5E5"> this is a new new variant</font>

194
00:08:58,450 --> 00:09:04,839
there was a a trend micro paper about it

195
00:09:01,570 --> 00:09:08,290
back<font color="#CCCCCC"> in January</font><font color="#E5E5E5"> and what it does is</font>

196
00:09:04,839 --> 00:09:10,839
after it after you<font color="#E5E5E5"> are</font><font color="#CCCCCC"> infected it looks</font>

197
00:09:08,290 --> 00:09:13,029
in your hard drive and<font color="#E5E5E5"> weapon</font><font color="#CCCCCC"> izes all</font>

198
00:09:10,839 --> 00:09:14,709
of the PDFs that you have on your hard

199
00:09:13,029 --> 00:09:17,350
drive and then just lets them sit there

200
00:09:14,709 --> 00:09:19,329
right so then when you go to get your

201
00:09:17,350 --> 00:09:22,270
invoice that you want<font color="#E5E5E5"> to send</font><font color="#CCCCCC"> to your</font>

202
00:09:19,330 --> 00:09:24,279
client you just drag the invoice to your

203
00:09:22,270 --> 00:09:26,529
email and send it off and you've

204
00:09:24,279 --> 00:09:29,380
unwittingly sent them a copy of Earth

205
00:09:26,529 --> 00:09:31,689
sniff which is a weaponized copy of your

206
00:09:29,380 --> 00:09:34,959
you know your PDF which is you know

207
00:09:31,690 --> 00:09:36,310
tailored to them almost<font color="#E5E5E5"> perfectly</font>

208
00:09:34,959 --> 00:09:38,890
because the malware author doesn't even

209
00:09:36,310 --> 00:09:45,609
have<font color="#E5E5E5"> to think about what to tailor to to</font>

210
00:09:38,890 --> 00:09:46,990
the target so let<font color="#CCCCCC"> me show you I this is</font>

211
00:09:45,610 --> 00:09:51,070
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> look</font><font color="#CCCCCC"> like a Freedom of</font>

212
00:09:46,990 --> 00:09:54,070
Information Act request because<font color="#CCCCCC"> i</font><font color="#E5E5E5"> have i</font>

213
00:09:51,070 --> 00:09:55,750
have redacted a lot of<font color="#CCCCCC"> these but this</font>

214
00:09:54,070 --> 00:09:58,540
this is where things get very scary

215
00:09:55,750 --> 00:10:01,230
because I pulled all<font color="#E5E5E5"> of these copies off</font>

216
00:09:58,540 --> 00:10:04,750
of the the online malware scanner so

217
00:10:01,230 --> 00:10:08,760
this<font color="#CCCCCC"> is a certificate of analysis for</font>

218
00:10:04,750 --> 00:10:13,570
some<font color="#E5E5E5"> sort of chemical no idea what it</font><font color="#CCCCCC"> is</font>

219
00:10:08,760 --> 00:10:16,990
and then this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the this is a check</font>

220
00:10:13,570 --> 00:10:19,470
register from a company I've redacted

221
00:10:16,990 --> 00:10:26,050
the name of the real<font color="#E5E5E5"> estate agent and</font>

222
00:10:19,470 --> 00:10:29,529
this is a you know a invoice for parts

223
00:10:26,050 --> 00:10:30,969
<font color="#CCCCCC">for a car at a car service center so</font>

224
00:10:29,529 --> 00:10:33,279
these are<font color="#CCCCCC"> the sorts of things that you</font>

225
00:10:30,970 --> 00:10:35,320
save on<font color="#CCCCCC"> your hard drive right and keep</font>

226
00:10:33,279 --> 00:10:37,740
for later these are the sort of things

227
00:10:35,320 --> 00:10:43,920
at this piece of malware is weaponizing

228
00:10:37,740 --> 00:10:46,690
this is a packing list for something oh

229
00:10:43,920 --> 00:10:49,510
and also by the<font color="#E5E5E5"> way this</font><font color="#CCCCCC"> is this this</font>

230
00:10:46,690 --> 00:10:53,800
one one of the things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> did with</font>

231
00:10:49,510 --> 00:10:57,100
<font color="#E5E5E5">this set of documents was sort of a look</font>

232
00:10:53,800 --> 00:11:00,490
into the idea of<font color="#E5E5E5"> who the victims are and</font>

233
00:10:57,100 --> 00:11:03,070
I could tell<font color="#CCCCCC"> by the collection</font><font color="#E5E5E5"> of</font>

234
00:11:00,490 --> 00:11:05,930
documents who the kind<font color="#E5E5E5"> of the initial</font>

235
00:11:03,070 --> 00:11:07,399
infection points were

236
00:11:05,930 --> 00:11:09,469
because any business document

237
00:11:07,399 --> 00:11:11,270
essentially has two companies involved

238
00:11:09,470 --> 00:11:15,230
with it you know<font color="#CCCCCC"> a sender and a receiver</font>

239
00:11:11,270 --> 00:11:17,569
and<font color="#E5E5E5"> so by taking all of these in making</font>

240
00:11:15,230 --> 00:11:20,420
a you know spreadsheet of the senders

241
00:11:17,570 --> 00:11:24,980
and receivers I can see<font color="#E5E5E5"> that okay this</font>

242
00:11:20,420 --> 00:11:26,479
<font color="#E5E5E5">person has this this this company is in</font>

243
00:11:24,980 --> 00:11:28,399
<font color="#E5E5E5">common with all of these different</font>

244
00:11:26,480 --> 00:11:31,370
documents so they must<font color="#E5E5E5"> have</font><font color="#CCCCCC"> been the</font>

245
00:11:28,399 --> 00:11:34,399
initial vector and then this company and

246
00:11:31,370 --> 00:11:37,850
this company and so the company here is

247
00:11:34,399 --> 00:11:39,560
actually<font color="#CCCCCC"> a manufacturer of you know I'm</font>

248
00:11:37,850 --> 00:11:41,420
not<font color="#CCCCCC"> familiar with it with the type of</font>

249
00:11:39,560 --> 00:11:44,510
stuff they make I have some of their

250
00:11:41,420 --> 00:11:46,790
glossies which were weaponized but those

251
00:11:44,510 --> 00:11:49,160
the part they make little metal you know

252
00:11:46,790 --> 00:11:51,680
machine parts and stuff like that<font color="#E5E5E5"> but I</font>

253
00:11:49,160 --> 00:11:54,939
know who their clients are because this

254
00:11:51,680 --> 00:11:59,209
document is a packing list they sent for

255
00:11:54,940 --> 00:12:00,860
to a major car manufacturer so major car

256
00:11:59,209 --> 00:12:05,719
manufacturer is one of their clients and

257
00:12:00,860 --> 00:12:08,029
then this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a this is</font><font color="#E5E5E5"> the real estate</font>

258
00:12:05,720 --> 00:12:11,570
<font color="#CCCCCC">agent so these are copies of their</font>

259
00:12:08,029 --> 00:12:14,660
checks that were repin eyes also very

260
00:12:11,570 --> 00:12:16,880
<font color="#CCCCCC">very scary and then this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> just an</font>

261
00:12:14,660 --> 00:12:20,060
email<font color="#E5E5E5"> talking about I believe this is</font>

262
00:12:16,880 --> 00:12:25,339
talking about<font color="#E5E5E5"> making a donation to the</font>

263
00:12:20,060 --> 00:12:26,989
Humane Society and then here is is that

264
00:12:25,339 --> 00:12:28,850
the check to the<font color="#E5E5E5"> Humane Society no</font>

265
00:12:26,990 --> 00:12:31,070
that's a check for a real estate<font color="#E5E5E5"> agent</font>

266
00:12:28,850 --> 00:12:32,450
there's actually oh I sorry that I

267
00:12:31,070 --> 00:12:33,920
didn't include the check but there's

268
00:12:32,450 --> 00:12:37,250
actually<font color="#E5E5E5"> the check to the humane society</font>

269
00:12:33,920 --> 00:12:39,860
that they'd weaponized so one of the

270
00:12:37,250 --> 00:12:41,420
very frightening parts about this is so

271
00:12:39,860 --> 00:12:43,970
I know now that there are three

272
00:12:41,420 --> 00:12:46,790
companies from these documents there's a

273
00:12:43,970 --> 00:12:50,720
real estate agent there's a manufacturer

274
00:12:46,790 --> 00:12:54,290
of machine parts there is a shale oil

275
00:12:50,720 --> 00:12:57,279
fracking company doing like shale oil

276
00:12:54,290 --> 00:13:01,849
rigs in Pennsylvania and then there's a

277
00:12:57,279 --> 00:13:04,399
a supplier for emt<font color="#CCCCCC"> and Fire you know</font>

278
00:13:01,850 --> 00:13:06,260
equipment in Montana so those<font color="#CCCCCC"> are the</font>

279
00:13:04,399 --> 00:13:09,620
ones that I tark I figured out were the

280
00:13:06,260 --> 00:13:11,149
targets of the of the attack so these

281
00:13:09,620 --> 00:13:13,459
are<font color="#CCCCCC"> the types of documents that you</font>

282
00:13:11,149 --> 00:13:15,260
don't want to upload to an online<font color="#E5E5E5"> AV</font>

283
00:13:13,459 --> 00:13:17,300
scanner right

284
00:13:15,260 --> 00:13:19,790
I think it should<font color="#E5E5E5"> be obvious that you</font>

285
00:13:17,300 --> 00:13:21,050
don't want to upload these and one thing

286
00:13:19,790 --> 00:13:23,510
that's<font color="#CCCCCC"> interesting with these AV</font>

287
00:13:21,050 --> 00:13:25,069
scanners is they track who it is that's

288
00:13:23,510 --> 00:13:27,710
uploading it so they see the IP address

289
00:13:25,070 --> 00:13:29,660
that's uploading it if you have an

290
00:13:27,710 --> 00:13:32,660
account<font color="#E5E5E5"> with them then obviously it's</font>

291
00:13:29,660 --> 00:13:35,030
connected<font color="#CCCCCC"> to that so you know each one</font>

292
00:13:32,660 --> 00:13:38,270
of these came in from the web<font color="#CCCCCC"> interface</font>

293
00:13:35,030 --> 00:13:40,490
so these were you know people at one of

294
00:13:38,270 --> 00:13:42,050
these companies or a<font color="#E5E5E5"> company that was</font>

295
00:13:40,490 --> 00:13:44,660
doing business<font color="#CCCCCC"> with them and</font><font color="#E5E5E5"> was sent</font>

296
00:13:42,050 --> 00:13:46,579
one of<font color="#E5E5E5"> these and they probably just got</font>

297
00:13:44,660 --> 00:13:48,949
an email with an attachment that was

298
00:13:46,580 --> 00:13:51,860
strange and<font color="#E5E5E5"> then submitted it to the</font>

299
00:13:48,950 --> 00:13:54,950
online AV scanner and then I got<font color="#CCCCCC"> a copy</font>

300
00:13:51,860 --> 00:13:57,560
of all of them so and myself and<font color="#E5E5E5"> lots of</font>

301
00:13:54,950 --> 00:13:58,730
other people including<font color="#E5E5E5"> AV AV companies</font>

302
00:13:57,560 --> 00:14:00,530
and security companies<font color="#CCCCCC"> in</font><font color="#E5E5E5"> other</font>

303
00:13:58,730 --> 00:14:05,690
<font color="#E5E5E5">countries you have no idea where the</font>

304
00:14:00,530 --> 00:14:10,430
stuff is going so bad idea so the

305
00:14:05,690 --> 00:14:13,070
onwards to the next the next use case so

306
00:14:10,430 --> 00:14:15,949
the next<font color="#E5E5E5"> use case I have is for red</font>

307
00:14:13,070 --> 00:14:22,370
<font color="#E5E5E5">teams and how</font><font color="#CCCCCC"> many in here</font><font color="#E5E5E5"> are pen</font>

308
00:14:15,950 --> 00:14:24,980
testers two three four<font color="#E5E5E5"> okay so do you</font>

309
00:14:22,370 --> 00:14:28,400
<font color="#E5E5E5">guys use tailored malware in any of your</font>

310
00:14:24,980 --> 00:14:31,070
<font color="#E5E5E5">engagement yes we got to guess over here</font>

311
00:14:28,400 --> 00:14:38,050
would you<font color="#E5E5E5"> want to share</font><font color="#CCCCCC"> that piece of</font>

312
00:14:31,070 --> 00:14:41,930
malware with anyone that's not exactly a

313
00:14:38,050 --> 00:14:44,719
very good answer so and I<font color="#E5E5E5"> just wanted to</font>

314
00:14:41,930 --> 00:14:46,880
highlight because when I when I've given

315
00:14:44,720 --> 00:14:48,830
a talk<font color="#E5E5E5"> when I gave the talk at shmoocon</font>

316
00:14:46,880 --> 00:14:51,710
I was<font color="#CCCCCC"> actually followed by one of the</font>

317
00:14:48,830 --> 00:14:53,660
guys<font color="#CCCCCC"> that is in</font><font color="#E5E5E5"> vail framework one of</font>

318
00:14:51,710 --> 00:14:56,450
the authors of ale framework so this<font color="#E5E5E5"> is</font>

319
00:14:53,660 --> 00:14:59,120
a very great piece of software for for

320
00:14:56,450 --> 00:15:01,670
pen testing and what<font color="#E5E5E5"> it does is</font><font color="#CCCCCC"> you take</font>

321
00:14:59,120 --> 00:15:04,280
your piece of malware and you can use

322
00:15:01,670 --> 00:15:07,010
veil framework to off you skate it in

323
00:15:04,280 --> 00:15:10,819
ways so that it avoids being detected by

324
00:15:07,010 --> 00:15:12,560
AV scanners so the veil framework folks

325
00:15:10,820 --> 00:15:14,390
were saying you know we've thought about

326
00:15:12,560 --> 00:15:15,890
making something like black scanner for

327
00:15:14,390 --> 00:15:19,580
a while but<font color="#E5E5E5"> now you're making it so</font>

328
00:15:15,890 --> 00:15:21,740
<font color="#E5E5E5">great but they're really great guys and</font>

329
00:15:19,580 --> 00:15:24,290
that's actually<font color="#CCCCCC"> a great great project</font>

330
00:15:21,740 --> 00:15:27,620
back door factory is another one where

331
00:15:24,290 --> 00:15:28,630
you are creating<font color="#CCCCCC"> backdoor wineries that</font>

332
00:15:27,620 --> 00:15:31,630
are

333
00:15:28,630 --> 00:15:35,860
real wineries from a system so you<font color="#E5E5E5"> can</font>

334
00:15:31,630 --> 00:15:38,470
take I saw the<font color="#E5E5E5"> their their demo at Derby</font>

335
00:15:35,860 --> 00:15:41,430
con which was fascinating he put a back

336
00:15:38,470 --> 00:15:45,370
door in<font color="#E5E5E5"> Safari the actual Safari</font>

337
00:15:41,430 --> 00:15:48,189
executable on the on a laptop and so it

338
00:15:45,370 --> 00:15:50,980
you know called back to his uh his<font color="#CCCCCC"> situ</font>

339
00:15:48,190 --> 00:15:53,440
so back door factory is another one

340
00:15:50,980 --> 00:15:54,670
where if you're making a backdoor binary

341
00:15:53,440 --> 00:15:57,070
you want to make sure<font color="#E5E5E5"> that it's not</font>

342
00:15:54,670 --> 00:15:59,319
going to be shared out and you can<font color="#E5E5E5"> get</font>

343
00:15:57,070 --> 00:16:03,430
you you're not sharing how you back

344
00:15:59,320 --> 00:16:06,250
doored it side note back door factory is

345
00:16:03,430 --> 00:16:08,589
has<font color="#CCCCCC"> been in the news and it might not</font>

346
00:16:06,250 --> 00:16:12,420
have been in<font color="#CCCCCC"> the news directly but it</font>

347
00:16:08,590 --> 00:16:14,980
was a instance of back door factory was

348
00:16:12,420 --> 00:16:18,130
reported I don't know if<font color="#E5E5E5"> any has anyone</font>

349
00:16:14,980 --> 00:16:20,860
heard of onion Duke onion Duke it's a

350
00:16:18,130 --> 00:16:22,540
piece of malware onion Duke so onion

351
00:16:20,860 --> 00:16:24,010
Duke you probably<font color="#E5E5E5"> heard</font><font color="#CCCCCC"> of onion Duke</font>

352
00:16:22,540 --> 00:16:26,980
but you didn't<font color="#CCCCCC"> know it by the name onion</font>

353
00:16:24,010 --> 00:16:29,200
Duke so about six months ago there was a

354
00:16:26,980 --> 00:16:30,670
<font color="#CCCCCC">tour</font><font color="#E5E5E5"> exit node discovered that was back</font>

355
00:16:29,200 --> 00:16:32,320
<font color="#CCCCCC">during</font><font color="#E5E5E5"> all of the binaries that are</font>

356
00:16:30,670 --> 00:16:34,750
<font color="#E5E5E5">going up and down through it right did</font>

357
00:16:32,320 --> 00:16:36,370
you hear about that<font color="#CCCCCC"> okay so that</font><font color="#E5E5E5"> was</font>

358
00:16:34,750 --> 00:16:37,780
actually someone in Russia that<font color="#CCCCCC"> had</font>

359
00:16:36,370 --> 00:16:39,880
downloaded a copy of<font color="#E5E5E5"> back door factory</font>

360
00:16:37,780 --> 00:16:43,470
installed it and combined it with a tor

361
00:16:39,880 --> 00:16:49,000
exit node and created a you know fun

362
00:16:43,470 --> 00:16:50,740
malware transmission system so that was

363
00:16:49,000 --> 00:16:53,680
that that's how<font color="#E5E5E5"> he that that's one use</font>

364
00:16:50,740 --> 00:16:56,680
case of that but so this is<font color="#CCCCCC"> how i</font>

365
00:16:53,680 --> 00:17:00,010
formulated the plan for plague scanner I

366
00:16:56,680 --> 00:17:02,319
don't know if you recognize this bar but

367
00:17:00,010 --> 00:17:04,420
<font color="#E5E5E5">it's shudders at the Rio so this is</font>

368
00:17:02,320 --> 00:17:07,030
<font color="#E5E5E5">where this</font><font color="#CCCCCC"> is where I was talking to a</font>

369
00:17:04,420 --> 00:17:11,740
number<font color="#E5E5E5"> of other security heads and def</font>

370
00:17:07,030 --> 00:17:13,750
con con goers about what to do in these

371
00:17:11,740 --> 00:17:16,660
different what to do with this problem

372
00:17:13,750 --> 00:17:21,040
<font color="#CCCCCC">and came up with the idea of like</font>

373
00:17:16,660 --> 00:17:23,949
scanner and I was actually<font color="#E5E5E5"> curious at</font>

374
00:17:21,040 --> 00:17:26,530
the time why this<font color="#E5E5E5"> is sort of something</font>

375
00:17:23,949 --> 00:17:28,540
that<font color="#E5E5E5"> seems obvious to me to have an open</font>

376
00:17:26,530 --> 00:17:31,149
<font color="#E5E5E5">source project to do this sort of thing</font>

377
00:17:28,540 --> 00:17:33,850
but I realized the reason why it

378
00:17:31,150 --> 00:17:37,690
probably didn't happen yet is most

379
00:17:33,850 --> 00:17:39,879
people who are open source advocates and

380
00:17:37,690 --> 00:17:42,370
big open<font color="#E5E5E5"> big-time open source people</font>

381
00:17:39,880 --> 00:17:44,500
they kind of get hives when they look

382
00:17:42,370 --> 00:17:46,719
<font color="#E5E5E5">closed source software they don't want</font>

383
00:17:44,500 --> 00:17:49,120
to<font color="#E5E5E5"> work with stuff like that so they</font>

384
00:17:46,720 --> 00:17:52,330
wouldn't want<font color="#CCCCCC"> to write a letter of open</font>

385
00:17:49,120 --> 00:17:54,790
source<font color="#E5E5E5"> over lots of commercial software</font>

386
00:17:52,330 --> 00:17:56,409
that's not necessarily the the thing

387
00:17:54,790 --> 00:18:00,570
that the the first thing that<font color="#E5E5E5"> comes to</font>

388
00:17:56,410 --> 00:18:03,640
mind when<font color="#E5E5E5"> you are a open source guru so</font>

389
00:18:00,570 --> 00:18:06,129
I'm my background is<font color="#E5E5E5"> security I love</font>

390
00:18:03,640 --> 00:18:08,590
open source and so this seemed obvious

391
00:18:06,130 --> 00:18:10,900
and so<font color="#CCCCCC"> after about two years</font><font color="#E5E5E5"> of mulling</font>

392
00:18:08,590 --> 00:18:14,860
it over finally put some parts together

393
00:18:10,900 --> 00:18:17,290
and started the project so let's go<font color="#CCCCCC"> over</font>

394
00:18:14,860 --> 00:18:20,409
the basic components<font color="#CCCCCC"> of plex scanner so</font>

395
00:18:17,290 --> 00:18:23,080
it's all written in Python 3 every

396
00:18:20,410 --> 00:18:25,750
component is Python 3 I try in

397
00:18:23,080 --> 00:18:28,169
everything that I do to<font color="#CCCCCC"> not use Python</font>

398
00:18:25,750 --> 00:18:31,420
to<font color="#CCCCCC"> any more if and only if there's a</font>

399
00:18:28,170 --> 00:18:34,630
import that I have to use an old library

400
00:18:31,420 --> 00:18:37,750
a liar that still uses Python<font color="#E5E5E5"> 2 i will</font>

401
00:18:34,630 --> 00:18:40,240
use by fun too but<font color="#E5E5E5"> python 3 this uses</font>

402
00:18:37,750 --> 00:18:42,460
the app see plug-in system this is a

403
00:18:40,240 --> 00:18:44,100
plug-in system that you might recognize

404
00:18:42,460 --> 00:18:47,040
from other malware analysis project

405
00:18:44,100 --> 00:18:51,639
called<font color="#E5E5E5"> mastiff they use the app see</font>

406
00:18:47,040 --> 00:18:55,420
<font color="#CCCCCC">mastiff is a static malware analysis</font>

407
00:18:51,640 --> 00:19:00,100
framework so I they had a good<font color="#E5E5E5"> idea so I</font>

408
00:18:55,420 --> 00:19:02,080
took it<font color="#E5E5E5"> and then zeromq is similar to</font>

409
00:19:00,100 --> 00:19:03,730
rabbitmq if you if you're familiar with

410
00:19:02,080 --> 00:19:05,500
that it's<font color="#E5E5E5"> just a little bit faster</font><font color="#CCCCCC"> a</font>

411
00:19:03,730 --> 00:19:09,640
little bit<font color="#CCCCCC"> easier</font><font color="#E5E5E5"> to use a little bit</font>

412
00:19:05,500 --> 00:19:12,600
cleaner so<font color="#CCCCCC"> I use your zeromq for message</font>

413
00:19:09,640 --> 00:19:15,250
queuing and that is how you<font color="#CCCCCC"> know the the</font>

414
00:19:12,600 --> 00:19:17,169
<font color="#E5E5E5">malware sample and then the code to run</font>

415
00:19:15,250 --> 00:19:19,570
the matter sample is transmitted between

416
00:19:17,170 --> 00:19:24,610
the core and then each one of<font color="#E5E5E5"> the AV</font>

417
00:19:19,570 --> 00:19:27,939
scanner VMs so<font color="#CCCCCC"> i use qmu originally and</font>

418
00:19:24,610 --> 00:19:30,100
i added about a month ago I added

419
00:19:27,940 --> 00:19:33,400
VirtualBox virtualization for this so it

420
00:19:30,100 --> 00:19:35,770
supports both virtual box and<font color="#CCCCCC"> q mu the</font>

421
00:19:33,400 --> 00:19:38,440
reason<font color="#CCCCCC"> i like qm you is it has Colonel</font>

422
00:19:35,770 --> 00:19:42,730
same page merging which is a type of

423
00:19:38,440 --> 00:19:46,450
memory deduplication so if you have two

424
00:19:42,730 --> 00:19:50,679
or more<font color="#CCCCCC"> VMs and the VMS all have a set</font>

425
00:19:46,450 --> 00:19:52,450
of memory pages vm x and v my if they're

426
00:19:50,679 --> 00:19:54,580
<font color="#CCCCCC">running the same operating system have</font>

427
00:19:52,450 --> 00:19:56,860
almost the same set of memory pay

428
00:19:54,580 --> 00:19:59,199
so why take up that much space in the

429
00:19:56,860 --> 00:20:01,439
host operating system so<font color="#E5E5E5"> Colonel same</font>

430
00:19:59,200 --> 00:20:04,779
page memory Colonel same page merging

431
00:20:01,440 --> 00:20:08,649
works at the host level and so if<font color="#E5E5E5"> you</font>

432
00:20:04,779 --> 00:20:11,049
have one identical page of memory it's

433
00:20:08,649 --> 00:20:15,189
actually shared among all of the VMS

434
00:20:11,049 --> 00:20:17,408
that have that same page so VirtualBox

435
00:20:15,190 --> 00:20:18,610
has a similar technology I don't

436
00:20:17,409 --> 00:20:21,850
remember<font color="#CCCCCC"> it off the top of my head but</font>

437
00:20:18,610 --> 00:20:23,678
<font color="#E5E5E5">it's in a further slide unfortunately</font>

438
00:20:21,850 --> 00:20:27,730
the reit well the reason why I used qmu

439
00:20:23,679 --> 00:20:30,130
is that virtual box under mac OS for

440
00:20:27,730 --> 00:20:32,529
some reason virtual boxes version of KSM

441
00:20:30,130 --> 00:20:34,389
does not work so they don't have a

442
00:20:32,529 --> 00:20:37,960
supported they don't have<font color="#CCCCCC"> that</font>

443
00:20:34,389 --> 00:20:39,908
technology supported under mac OS so if

444
00:20:37,960 --> 00:20:41,799
you run virtual box under mac OS all of

445
00:20:39,909 --> 00:20:44,110
your<font color="#CCCCCC"> VMS have an entire you know you</font>

446
00:20:41,799 --> 00:20:48,100
have this ever-growing repetitive list

447
00:20:44,110 --> 00:20:52,000
of<font color="#E5E5E5"> memory pages i use the pillow python</font>

448
00:20:48,100 --> 00:20:55,809
image library and this is for taking

449
00:20:52,000 --> 00:20:58,840
screenshots of<font color="#CCCCCC"> pop-up windows in the VMS</font>

450
00:20:55,809 --> 00:21:02,260
and then i use tesseract OCR and we'll

451
00:20:58,840 --> 00:21:05,709
go into<font color="#E5E5E5"> why why this is necessary little</font>

452
00:21:02,260 --> 00:21:10,960
bit later the report output is JSON I

453
00:21:05,710 --> 00:21:14,110
don't like XML XML is very last year so

454
00:21:10,960 --> 00:21:16,809
the output<font color="#E5E5E5"> is JSON and then the reports</font>

455
00:21:14,110 --> 00:21:18,490
can optionally be stored in<font color="#CCCCCC"> elastic</font>

456
00:21:16,809 --> 00:21:21,279
<font color="#CCCCCC">search and then you can do nice graph</font>

457
00:21:18,490 --> 00:21:26,320
stuff and look at historical AV engine

458
00:21:21,279 --> 00:21:28,600
results so the whole concept<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that you</font>

459
00:21:26,320 --> 00:21:31,539
bring the scanners so you have gets it's

460
00:21:28,600 --> 00:21:33,760
up to you to buy the licenses and get

461
00:21:31,539 --> 00:21:35,889
them installed correctly and follow the

462
00:21:33,760 --> 00:21:38,860
<font color="#CCCCCC">directions and read the manual of the</font>

463
00:21:35,889 --> 00:21:42,428
manufacturer of those that<font color="#E5E5E5"> is not my</font>

464
00:21:38,860 --> 00:21:44,168
<font color="#CCCCCC">problem</font><font color="#E5E5E5"> but I bring the plugins for each</font>

465
00:21:42,429 --> 00:21:46,090
one<font color="#CCCCCC"> of the scanners so I make sure that</font>

466
00:21:44,169 --> 00:21:47,350
<font color="#CCCCCC">it's instrumented properly and make sure</font>

467
00:21:46,090 --> 00:21:50,019
<font color="#CCCCCC">that there's each one of these</font>

468
00:21:47,350 --> 00:21:52,689
essentially<font color="#E5E5E5"> the core</font><font color="#CCCCCC"> of this is each one</font>

469
00:21:50,019 --> 00:21:55,720
<font color="#CCCCCC">of these is a regex or a set of reg</font><font color="#E5E5E5"> X's</font>

470
00:21:52,690 --> 00:21:58,179
that takes the output<font color="#CCCCCC"> from said AV</font>

471
00:21:55,720 --> 00:22:00,519
scanner pulls out the data that we need

472
00:21:58,179 --> 00:22:03,700
and then sends all that to a central

473
00:22:00,519 --> 00:22:08,570
core and then creates a master JSON file

474
00:22:03,700 --> 00:22:12,289
for that so<font color="#E5E5E5"> I have identified</font>

475
00:22:08,570 --> 00:22:14,750
for for general types of scanner engines

476
00:22:12,289 --> 00:22:17,929
out there so the first<font color="#E5E5E5"> one is open</font>

477
00:22:14,750 --> 00:22:19,789
<font color="#E5E5E5">source I believe unless anyone knows of</font>

478
00:22:17,929 --> 00:22:22,370
any further ones I believe there's only

479
00:22:19,789 --> 00:22:25,990
one member<font color="#CCCCCC"> of this category that would</font>

480
00:22:22,370 --> 00:22:28,668
be clam AV and then the second is a

481
00:22:25,990 --> 00:22:31,399
<font color="#E5E5E5">Linux has has a Linux version available</font>

482
00:22:28,669 --> 00:22:34,100
so many commercial types of malware AV

483
00:22:31,399 --> 00:22:36,678
malware and AV scanners have a Linux

484
00:22:34,100 --> 00:22:38,120
version available and if there's a Linux

485
00:22:36,679 --> 00:22:39,710
version available that means there's a

486
00:22:38,120 --> 00:22:41,449
<font color="#E5E5E5">command line and if there's a command</font>

487
00:22:39,710 --> 00:22:42,980
line it means it's easy for<font color="#E5E5E5"> me to run it</font>

488
00:22:41,450 --> 00:22:46,399
and get a regex and pull out<font color="#E5E5E5"> all the</font>

489
00:22:42,980 --> 00:22:47,750
data that<font color="#CCCCCC"> I need so</font><font color="#E5E5E5"> Linux and I also I</font>

490
00:22:46,399 --> 00:22:49,908
mean there are some companies that

491
00:22:47,750 --> 00:22:52,129
provide a freebsd version and<font color="#E5E5E5"> other BS</font>

492
00:22:49,909 --> 00:22:54,980
DS and other<font color="#CCCCCC"> UNIX a--'s and stuff like</font>

493
00:22:52,129 --> 00:22:58,519
that but<font color="#E5E5E5"> I'm focused on Linux just you</font>

494
00:22:54,980 --> 00:23:00,320
know make it easy make 11 that and there

495
00:22:58,519 --> 00:23:02,629
<font color="#E5E5E5">isn't one there is there are no AV</font>

496
00:23:00,320 --> 00:23:05,059
engines that make scanners for a

497
00:23:02,629 --> 00:23:09,289
different<font color="#CCCCCC"> UNIX that don't make one for</font>

498
00:23:05,059 --> 00:23:11,750
Linux so I've focused on Linux the third

499
00:23:09,289 --> 00:23:13,549
type is a windows-only scanner there's a

500
00:23:11,750 --> 00:23:15,320
lot of those out there there's<font color="#CCCCCC"> only a</font>

501
00:23:13,549 --> 00:23:19,279
verte there's only a version of it in

502
00:23:15,320 --> 00:23:20,689
windows and the good ones are number

503
00:23:19,279 --> 00:23:22,700
three those are the ones that have a

504
00:23:20,690 --> 00:23:25,070
command-line interface available again I

505
00:23:22,700 --> 00:23:26,899
you<font color="#CCCCCC"> know I would prefer not using</font>

506
00:23:25,070 --> 00:23:28,850
<font color="#E5E5E5">Windows but where I have to</font><font color="#CCCCCC"> use Windows</font>

507
00:23:26,899 --> 00:23:31,100
if I have a command line then I get a

508
00:23:28,850 --> 00:23:33,259
you know a pile of text and then<font color="#E5E5E5"> I can</font>

509
00:23:31,100 --> 00:23:34,519
<font color="#E5E5E5">use a regex on it pull</font><font color="#CCCCCC"> it all out and</font><font color="#E5E5E5"> do</font>

510
00:23:33,259 --> 00:23:37,370
the same thing I did<font color="#E5E5E5"> with the Linux</font>

511
00:23:34,519 --> 00:23:41,419
<font color="#E5E5E5">version the fourth type is where there's</font>

512
00:23:37,370 --> 00:23:45,199
a<font color="#E5E5E5"> GUI only these are the the real nasty</font>

513
00:23:41,419 --> 00:23:47,389
ones and difficult to work with so that

514
00:23:45,200 --> 00:23:49,669
<font color="#E5E5E5">brings me to optical character</font>

515
00:23:47,389 --> 00:23:53,299
recognition so that fourth category of

516
00:23:49,669 --> 00:24:00,379
malware an AV scanner engine is the one

517
00:23:53,299 --> 00:24:03,230
that requires OCR so so with OCR you

518
00:24:00,379 --> 00:24:05,629
take a screenshot<font color="#E5E5E5"> in the vm of the</font>

519
00:24:03,230 --> 00:24:07,669
<font color="#E5E5E5">pop-up that says hi you're infected with</font>

520
00:24:05,629 --> 00:24:10,570
earth sniff or how you're infected with

521
00:24:07,669 --> 00:24:13,879
whatever and take a screenshot of that

522
00:24:10,570 --> 00:24:16,100
carve out the areas that that have the

523
00:24:13,879 --> 00:24:18,260
text that I want and then run that

524
00:24:16,100 --> 00:24:20,600
through OCR and then I get a pile of

525
00:24:18,260 --> 00:24:21,620
<font color="#E5E5E5">text that i run a regex on pull that to</font>

526
00:24:20,600 --> 00:24:25,370
the central core

527
00:24:21,620 --> 00:24:28,070
and then add that into a JSON document

528
00:24:25,370 --> 00:24:30,439
this component of plague scanner is not

529
00:24:28,070 --> 00:24:33,139
fully working yet this is this is a

530
00:24:30,440 --> 00:24:35,000
tough is actually this is<font color="#CCCCCC"> a a more</font>

531
00:24:33,140 --> 00:24:41,600
difficult problem than<font color="#CCCCCC"> you would think</font>

532
00:24:35,000 --> 00:24:44,270
but<font color="#E5E5E5"> it is under construction so this</font><font color="#CCCCCC"> is</font>

533
00:24:41,600 --> 00:24:46,610
<font color="#E5E5E5">the basic architectural diagram for</font>

534
00:24:44,270 --> 00:24:48,550
plague scanner there is the the

535
00:24:46,610 --> 00:24:51,919
submission processing and reporting

536
00:24:48,550 --> 00:24:54,320
component in at the top center I've

537
00:24:51,920 --> 00:24:57,400
called that the core so it's a plague

538
00:24:54,320 --> 00:25:00,139
scanner core there is an elastic search

539
00:24:57,400 --> 00:25:02,600
option so this is<font color="#E5E5E5"> something also that</font>

540
00:25:00,140 --> 00:25:05,360
you would set up yourself you know i'm

541
00:25:02,600 --> 00:25:07,669
<font color="#E5E5E5">not going to concern myself other than</font>

542
00:25:05,360 --> 00:25:09,770
making sure that the code to write to

543
00:25:07,670 --> 00:25:11,360
elasticsearch is correct but where your

544
00:25:09,770 --> 00:25:15,110
<font color="#E5E5E5">elastic search is and all that sort of</font>

545
00:25:11,360 --> 00:25:17,540
stuff is up to you so you have<font color="#CCCCCC"> to you</font>

546
00:25:15,110 --> 00:25:19,820
know create your cluster yourself the

547
00:25:17,540 --> 00:25:22,340
message queue is that amorphous blob in

548
00:25:19,820 --> 00:25:25,550
the center<font color="#CCCCCC"> and that's zeromq and that</font>

549
00:25:22,340 --> 00:25:30,110
sends the messages between the core and

550
00:25:25,550 --> 00:25:32,990
each one of<font color="#E5E5E5"> the variety of</font><font color="#CCCCCC"> VMs and let</font>

551
00:25:30,110 --> 00:25:35,740
me<font color="#CCCCCC"> just show a touch on one point about</font>

552
00:25:32,990 --> 00:25:39,200
the way that<font color="#E5E5E5"> I have designed this so</font>

553
00:25:35,740 --> 00:25:41,540
each<font color="#CCCCCC"> one of those VMs in the bottom has</font>

554
00:25:39,200 --> 00:25:45,770
an agent<font color="#E5E5E5"> which is listening for</font><font color="#CCCCCC"> the</font>

555
00:25:41,540 --> 00:25:49,040
zeromq messages and so each<font color="#CCCCCC"> one of those</font>

556
00:25:45,770 --> 00:25:52,100
agents<font color="#CCCCCC"> is actually dumb so they don't</font>

557
00:25:49,040 --> 00:25:54,649
know anything<font color="#CCCCCC"> about the type of vm that</font>

558
00:25:52,100 --> 00:25:56,750
they're in they have no<font color="#E5E5E5"> idea about what</font>

559
00:25:54,650 --> 00:25:59,450
<font color="#CCCCCC">type of Av scanner they're supposed to</font>

560
00:25:56,750 --> 00:26:01,790
deal with and the reason<font color="#CCCCCC"> I did this was</font>

561
00:25:59,450 --> 00:26:04,280
to make it easy on the end user for

562
00:26:01,790 --> 00:26:07,159
setting up the whole<font color="#E5E5E5"> thing the end user</font>

563
00:26:04,280 --> 00:26:10,370
shouldn't have to have<font color="#E5E5E5"> like a huge pile</font>

564
00:26:07,160 --> 00:26:13,580
of agents<font color="#CCCCCC"> that they have to figure</font><font color="#E5E5E5"> out</font>

565
00:26:10,370 --> 00:26:15,678
<font color="#CCCCCC">ok I've got a clam AV agent here and</font>

566
00:26:13,580 --> 00:26:17,928
then which<font color="#CCCCCC"> one of these</font><font color="#E5E5E5"> VMs is Mike lamb</font>

567
00:26:15,679 --> 00:26:20,720
AV and I got to put<font color="#CCCCCC"> that here and make</font>

568
00:26:17,929 --> 00:26:23,510
sure<font color="#CCCCCC"> that this all works no so the</font>

569
00:26:20,720 --> 00:26:25,940
ultimate the end goal is each<font color="#CCCCCC"> one of</font>

570
00:26:23,510 --> 00:26:28,910
these is<font color="#E5E5E5"> a dumb agent and this is</font>

571
00:26:25,940 --> 00:26:30,950
<font color="#CCCCCC">actually very unsafe so you need</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> make</font>

572
00:26:28,910 --> 00:26:33,950
<font color="#E5E5E5">sure</font><font color="#CCCCCC"> that wherever you've put plague</font>

573
00:26:30,950 --> 00:26:35,210
scanner is protected you know outside of

574
00:26:33,950 --> 00:26:37,460
plague scanner itself

575
00:26:35,210 --> 00:26:41,000
so you need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> make</font><font color="#E5E5E5"> sure that this is on</font>

576
00:26:37,460 --> 00:26:44,240
a separate network because this I<font color="#CCCCCC"> I make</font>

577
00:26:41,000 --> 00:26:46,520
no effort whatsoever to to check the

578
00:26:44,240 --> 00:26:48,559
code those agents are running so<font color="#CCCCCC"> they</font>

579
00:26:46,520 --> 00:26:51,049
get a message that contains the binary

580
00:26:48,559 --> 00:26:54,260
that they are going<font color="#CCCCCC"> to scan and then</font>

581
00:26:51,049 --> 00:26:56,600
they<font color="#CCCCCC"> they get a blob of</font><font color="#E5E5E5"> Python script</font>

582
00:26:54,260 --> 00:26:59,120
and then it just<font color="#E5E5E5"> runs the Python script</font>

583
00:26:56,600 --> 00:27:01,610
and it puts the it puts the binary in us

584
00:26:59,120 --> 00:27:04,129
in its that location runs the but it

585
00:27:01,610 --> 00:27:06,350
runs the script<font color="#E5E5E5"> and then the script will</font>

586
00:27:04,130 --> 00:27:08,360
go and look<font color="#CCCCCC"> for the binary run the</font><font color="#E5E5E5"> right</font>

587
00:27:06,350 --> 00:27:10,610
and run the<font color="#E5E5E5"> right scanner engine do the</font>

588
00:27:08,360 --> 00:27:13,219
do the text processing and then send a

589
00:27:10,610 --> 00:27:15,139
<font color="#CCCCCC">JSON message back to the core so that's</font>

590
00:27:13,220 --> 00:27:17,299
very<font color="#E5E5E5"> dangerous cuz i dunno checks</font>

591
00:27:15,140 --> 00:27:20,000
whatsoever so you if you're if you're

592
00:27:17,299 --> 00:27:22,010
running plague scanner out there and

593
00:27:20,000 --> 00:27:23,750
have it open to the<font color="#E5E5E5"> internet that would</font>

594
00:27:22,010 --> 00:27:25,789
be very<font color="#E5E5E5"> bad if you have it like on your</font>

595
00:27:23,750 --> 00:27:27,260
network that also is fairly bad because

596
00:27:25,789 --> 00:27:28,940
someone might discover that you have

597
00:27:27,260 --> 00:27:32,240
this and then<font color="#E5E5E5"> just start running</font>

598
00:27:28,940 --> 00:27:34,330
arbitrary code on your on<font color="#CCCCCC"> the vm so make</font>

599
00:27:32,240 --> 00:27:38,750
sure<font color="#CCCCCC"> that you've protected this properly</font>

600
00:27:34,330 --> 00:27:41,480
but this also leads me to the next part

601
00:27:38,750 --> 00:27:43,940
so<font color="#E5E5E5"> i've had</font><font color="#CCCCCC"> a few lessons learned about</font>

602
00:27:41,480 --> 00:27:45,919
the development of this so when you're

603
00:27:43,940 --> 00:27:48,500
developing a distributed application

604
00:27:45,919 --> 00:27:53,090
such as this that uses a message queue

605
00:27:48,500 --> 00:27:56,179
and you have lots of little<font color="#E5E5E5"> VMs out</font>

606
00:27:53,090 --> 00:27:58,820
there and then a central core so that

607
00:27:56,179 --> 00:28:02,120
the when you're doing development that

608
00:27:58,820 --> 00:28:04,700
adds time to each you<font color="#CCCCCC"> know iteration of</font>

609
00:28:02,120 --> 00:28:05,928
a change in the code so when you're

610
00:28:04,700 --> 00:28:08,480
sitting there and you're banging away at

611
00:28:05,929 --> 00:28:11,299
code and then you want<font color="#E5E5E5"> to run and see if</font>

612
00:28:08,480 --> 00:28:14,000
the thing that you did works or bombs

613
00:28:11,299 --> 00:28:15,830
when you hit run it then has to send

614
00:28:14,000 --> 00:28:17,990
that<font color="#E5E5E5"> message out all these things</font><font color="#CCCCCC"> that</font>

615
00:28:15,830 --> 00:28:19,789
this stuff has to come<font color="#E5E5E5"> back and you know</font>

616
00:28:17,990 --> 00:28:22,159
<font color="#CCCCCC">I'm impatient</font><font color="#E5E5E5"> and I don't want to even</font>

617
00:28:19,789 --> 00:28:24,620
wait that like you<font color="#CCCCCC"> know a few seconds</font><font color="#E5E5E5"> or</font>

618
00:28:22,159 --> 00:28:27,080
whatever so or<font color="#E5E5E5"> actually it's more than</font>

619
00:28:24,620 --> 00:28:28,789
more than like 15-20 seconds I don't

620
00:28:27,080 --> 00:28:31,460
<font color="#CCCCCC">want to wait that long I want</font><font color="#E5E5E5"> to just go</font>

621
00:28:28,789 --> 00:28:34,640
and see if it runs ban see if it runs so

622
00:28:31,460 --> 00:28:37,220
I have implemented they sort<font color="#E5E5E5"> of</font>

623
00:28:34,640 --> 00:28:39,950
development version of the entire system

624
00:28:37,220 --> 00:28:42,890
which works backwards from a smart agent

625
00:28:39,950 --> 00:28:44,870
and makes each one<font color="#CCCCCC"> of the this so</font>

626
00:28:42,890 --> 00:28:46,940
there's an alternate agent where each of

627
00:28:44,870 --> 00:28:48,649
those agents<font color="#E5E5E5"> is actually smart and has</font>

628
00:28:46,940 --> 00:28:49,049
the entire code in<font color="#E5E5E5"> there so that I can</font>

629
00:28:48,649 --> 00:28:51,809
work

630
00:28:49,049 --> 00:28:53,249
on that<font color="#CCCCCC"> vm itself not worry about the</font>

631
00:28:51,809 --> 00:28:55,230
core not<font color="#E5E5E5"> work about worry about anything</font>

632
00:28:53,249 --> 00:28:57,480
else have a binary in the proper

633
00:28:55,230 --> 00:29:02,039
location and then BAM just keep running

634
00:28:57,480 --> 00:29:04,289
the that particular agent and then it

635
00:29:02,039 --> 00:29:05,730
has a REST API so that when I've got

636
00:29:04,289 --> 00:29:08,369
that one working then I can kind of

637
00:29:05,730 --> 00:29:11,039
backup run the core core goes out and

638
00:29:08,369 --> 00:29:14,029
asks all those rest api's to do their

639
00:29:11,039 --> 00:29:17,789
stuff and then gets back<font color="#E5E5E5"> to the results</font>

640
00:29:14,029 --> 00:29:20,489
so then the the second step<font color="#E5E5E5"> of this is</font>

641
00:29:17,789 --> 00:29:22,679
to write the app see<font color="#CCCCCC"> plugin so once I've</font>

642
00:29:20,489 --> 00:29:25,619
got<font color="#CCCCCC"> a plug-in that once</font><font color="#E5E5E5"> I have an agent</font>

643
00:29:22,679 --> 00:29:28,649
that works properly carve out the<font color="#E5E5E5"> proper</font>

644
00:29:25,619 --> 00:29:30,269
piece of code from it and drop<font color="#CCCCCC"> that into</font>

645
00:29:28,649 --> 00:29:33,689
a<font color="#E5E5E5"> yap see</font><font color="#CCCCCC"> plug-in in the other version</font>

646
00:29:30,269 --> 00:29:37,980
so that's the development process it

647
00:29:33,690 --> 00:29:39,539
might the the the carving out and the

648
00:29:37,980 --> 00:29:41,700
making<font color="#E5E5E5"> of the app see</font><font color="#CCCCCC"> plugin might be a</font>

649
00:29:39,539 --> 00:29:43,019
little bit more cumbersome and the setup

650
00:29:41,700 --> 00:29:45,119
of it is a<font color="#E5E5E5"> little bit more cumbersome</font>

651
00:29:43,019 --> 00:29:46,950
but it does it makes it easy for someone

652
00:29:45,119 --> 00:29:51,090
that<font color="#CCCCCC"> doesn't like to wait when they're</font>

653
00:29:46,950 --> 00:29:53,190
<font color="#E5E5E5">doing development so I mentioned some of</font>

654
00:29:51,090 --> 00:29:55,350
the cool features already and I want<font color="#E5E5E5"> to</font>

655
00:29:53,190 --> 00:29:59,519
highlight some<font color="#CCCCCC"> of these some more of</font>

656
00:29:55,350 --> 00:30:02,009
them so Colonel same page merging as I

657
00:29:59,519 --> 00:30:04,169
said<font color="#CCCCCC"> it allows many VMS to share memory</font>

658
00:30:02,009 --> 00:30:06,960
pages this is the name of that

659
00:30:04,169 --> 00:30:10,289
technology in virtualbox it's called

660
00:30:06,960 --> 00:30:13,409
page fusion and if you go into virtual

661
00:30:10,289 --> 00:30:15,179
boxes document set and just grab it<font color="#E5E5E5"> for</font>

662
00:30:13,409 --> 00:30:17,489
page Fuzion you'll find the section on

663
00:30:15,179 --> 00:30:19,230
it and and how'd it<font color="#E5E5E5"> and how to set it</font><font color="#CCCCCC"> I</font>

664
00:30:17,489 --> 00:30:22,470
don't think<font color="#CCCCCC"> there's a I don't think you</font>

665
00:30:19,230 --> 00:30:25,019
have to set it<font color="#E5E5E5"> up but</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> look in</font>

666
00:30:22,470 --> 00:30:27,029
there just double check<font color="#E5E5E5"> I use</font><font color="#CCCCCC"> Mac so</font>

667
00:30:25,019 --> 00:30:31,080
actually I don't don't necessarily use

668
00:30:27,029 --> 00:30:33,840
virtualbox for much of this stuff so

669
00:30:31,080 --> 00:30:37,408
zeromq is a very fast message queuing

670
00:30:33,840 --> 00:30:41,639
system elasticsearch is a good way<font color="#E5E5E5"> to</font>

671
00:30:37,409 --> 00:30:44,899
visualize and store and process and have

672
00:30:41,639 --> 00:30:49,469
a no sequel basically a no sequel<font color="#CCCCCC"> esque</font>

673
00:30:44,899 --> 00:30:51,629
database of your of your results so one

674
00:30:49,470 --> 00:30:54,509
of the reasons why this is an important

675
00:30:51,629 --> 00:30:55,879
is let's say you get a binary that is

676
00:30:54,509 --> 00:30:58,699
new to you

677
00:30:55,879 --> 00:31:00,468
and it doesn't get detected by anything

678
00:30:58,699 --> 00:31:04,219
so that's a little bit<font color="#E5E5E5"> frightening right</font>

679
00:31:00,469 --> 00:31:09,019
but as a researcher you may want<font color="#CCCCCC"> to know</font>

680
00:31:04,219 --> 00:31:12,589
<font color="#E5E5E5">or graph when different scanner engines</font>

681
00:31:09,019 --> 00:31:15,049
began detecting it and see you know who

682
00:31:12,589 --> 00:31:17,269
who<font color="#CCCCCC"> is better at detecting it who might</font>

683
00:31:15,049 --> 00:31:18,649
be following<font color="#E5E5E5"> whom because you know three</font>

684
00:31:17,269 --> 00:31:21,229
or four<font color="#CCCCCC"> of</font><font color="#E5E5E5"> them might detect it all the</font>

685
00:31:18,649 --> 00:31:23,718
same time on a certain day then or maybe

686
00:31:21,229 --> 00:31:25,909
one of them got it and then you<font color="#E5E5E5"> know a</font>

687
00:31:23,719 --> 00:31:27,049
few days<font color="#E5E5E5"> later a lot of them got it so</font>

688
00:31:25,909 --> 00:31:29,749
you want to you know be able<font color="#E5E5E5"> to</font>

689
00:31:27,049 --> 00:31:32,679
highlight who it is that really got the

690
00:31:29,749 --> 00:31:36,529
got the good-good information on it so

691
00:31:32,679 --> 00:31:38,839
you<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> be able to run</font><font color="#CCCCCC"> the scan over</font>

692
00:31:36,529 --> 00:31:41,299
and over and over and<font color="#E5E5E5"> then take all of</font>

693
00:31:38,839 --> 00:31:43,940
those scan results and plug them<font color="#CCCCCC"> into</font>

694
00:31:41,299 --> 00:31:47,379
elasticsearch so that you can see the

695
00:31:43,940 --> 00:31:49,909
trending of fire scanner results<font color="#E5E5E5"> also</font>

696
00:31:47,379 --> 00:31:55,789
another thing that this<font color="#E5E5E5"> is good for</font><font color="#CCCCCC"> is</font>

697
00:31:49,909 --> 00:31:57,529
let's say<font color="#E5E5E5"> I</font><font color="#CCCCCC"> have a</font><font color="#E5E5E5"> sample and I don't</font>

698
00:31:55,789 --> 00:32:00,859
necessarily<font color="#CCCCCC"> want to run it against a</font>

699
00:31:57,529 --> 00:32:04,009
malware library to find things that are

700
00:32:00,859 --> 00:32:07,369
related to it so for example I can<font color="#E5E5E5"> take</font>

701
00:32:04,009 --> 00:32:10,009
there's three<font color="#E5E5E5"> there's three major hashes</font>

702
00:32:07,369 --> 00:32:12,589
that are good for<font color="#E5E5E5"> this type of work one</font>

703
00:32:10,009 --> 00:32:16,489
is called import hash when it's called

704
00:32:12,589 --> 00:32:19,339
PE hash and one<font color="#CCCCCC"> its SS deep so each one</font>

705
00:32:16,489 --> 00:32:22,759
of these is<font color="#E5E5E5"> a way to find related</font>

706
00:32:19,339 --> 00:32:27,049
malware SS deep I described earlier it's

707
00:32:22,759 --> 00:32:30,859
a piecewise hash and then import hash

708
00:32:27,049 --> 00:32:33,408
takes a hash of the import table of<font color="#CCCCCC"> the</font>

709
00:32:30,859 --> 00:32:35,899
malware and then it finds other malware

710
00:32:33,409 --> 00:32:39,169
that has a similar or matching import

711
00:32:35,899 --> 00:32:41,418
table so we're it's set of set of

712
00:32:39,169 --> 00:32:43,039
imports import table some of the stuff

713
00:32:41,419 --> 00:32:45,889
may not actually be in the import table

714
00:32:43,039 --> 00:32:49,419
by<font color="#E5E5E5"> the way so it takes a set of of the</font>

715
00:32:45,889 --> 00:32:55,279
imports and a PE hash takes a hash of

716
00:32:49,419 --> 00:32:57,589
components of the PE header so the the

717
00:32:55,279 --> 00:32:59,839
whole<font color="#E5E5E5"> the</font><font color="#CCCCCC"> whole idea</font><font color="#E5E5E5"> here is to find</font>

718
00:32:57,589 --> 00:33:03,948
other malware thats related<font color="#E5E5E5"> to your</font>

719
00:32:59,839 --> 00:33:07,759
piece of malware so those searches might

720
00:33:03,949 --> 00:33:08,790
find things that are known or not not

721
00:33:07,759 --> 00:33:12,930
necessarily known but

722
00:33:08,790 --> 00:33:15,720
are you know by a test similar to

723
00:33:12,930 --> 00:33:18,690
malware however there might be other

724
00:33:15,720 --> 00:33:21,510
copies of that malware that do not fit

725
00:33:18,690 --> 00:33:23,910
<font color="#CCCCCC">that model that don't have a common SS</font>

726
00:33:21,510 --> 00:33:27,000
deep don't have an import hash don't

727
00:33:23,910 --> 00:33:29,970
have a<font color="#E5E5E5"> PE hash however you</font><font color="#CCCCCC"> have you know</font>

728
00:33:27,000 --> 00:33:31,860
a host of<font color="#E5E5E5"> av scanner companies that are</font>

729
00:33:29,970 --> 00:33:34,650
out there working day and night on lots

730
00:33:31,860 --> 00:33:37,409
and lots and lots of malware they may

731
00:33:34,650 --> 00:33:39,570
have<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know decided that this piece of</font>

732
00:33:37,410 --> 00:33:41,940
malware is related to your piece of

733
00:33:39,570 --> 00:33:44,100
malware but the two of them don't<font color="#CCCCCC"> have a</font>

734
00:33:41,940 --> 00:33:47,490
common import hash don't have a common

735
00:33:44,100 --> 00:33:49,649
<font color="#E5E5E5">PS or SS deep so there's no way for you</font>

736
00:33:47,490 --> 00:33:51,630
to know if you have a malware library

737
00:33:49,650 --> 00:33:54,090
without you know looking through your

738
00:33:51,630 --> 00:33:57,420
samples and and already have seen<font color="#E5E5E5"> that</font>

739
00:33:54,090 --> 00:33:59,699
one to connect the<font color="#E5E5E5"> two but you could</font>

740
00:33:57,420 --> 00:34:01,890
<font color="#CCCCCC">have had your entire</font><font color="#E5E5E5"> malware library run</font>

741
00:33:59,700 --> 00:34:04,050
through<font color="#CCCCCC"> Plex scanner had all the results</font>

742
00:34:01,890 --> 00:34:08,040
in<font color="#E5E5E5"> elastic search and then done a free</font>

743
00:34:04,050 --> 00:34:10,469
text search for the name of a piece of

744
00:34:08,040 --> 00:34:13,259
malware and then found all of the<font color="#E5E5E5"> other</font>

745
00:34:10,469 --> 00:34:15,060
so if you let's<font color="#E5E5E5"> say you have run yours</font>

746
00:34:13,260 --> 00:34:17,220
through here and<font color="#E5E5E5"> it says hi I'm earth</font>

747
00:34:15,060 --> 00:34:18,779
sniff so then you search for<font color="#E5E5E5"> everything</font>

748
00:34:17,219 --> 00:34:21,359
else that's earth sniff in there and

749
00:34:18,780 --> 00:34:24,179
you'll get samples that may not have a

750
00:34:21,360 --> 00:34:26,580
common import hash may not have a common

751
00:34:24,179 --> 00:34:28,410
PE hash and may not<font color="#E5E5E5"> have a common SSD so</font>

752
00:34:26,580 --> 00:34:31,049
you'll have other things to do research

753
00:34:28,409 --> 00:34:33,690
<font color="#E5E5E5">on and kind of figure out like who's</font>

754
00:34:31,050 --> 00:34:35,490
doing what and who's related to who so

755
00:34:33,690 --> 00:34:39,780
that's a very<font color="#E5E5E5"> powerful feature of the</font>

756
00:34:35,489 --> 00:34:42,449
software um so there<font color="#E5E5E5"> are a number of</font>

757
00:34:39,780 --> 00:34:45,450
open issues in here one of the major

758
00:34:42,449 --> 00:34:49,850
problems that<font color="#E5E5E5"> I ran</font><font color="#CCCCCC"> into is that</font><font color="#E5E5E5"> so I</font>

759
00:34:45,449 --> 00:34:54,299
keep all of this at a cloud you know a

760
00:34:49,850 --> 00:34:55,739
cloud vm service so one of the problems

761
00:34:54,300 --> 00:34:57,570
<font color="#E5E5E5">with that is even though they're like</font>

762
00:34:55,739 --> 00:35:00,299
you<font color="#CCCCCC"> know two cents a two cents an hour</font>

763
00:34:57,570 --> 00:35:01,950
to have your vm if you have two cents an

764
00:35:00,300 --> 00:35:04,650
hour but you've got lots and<font color="#E5E5E5"> lots and</font>

765
00:35:01,950 --> 00:35:07,529
lots of<font color="#E5E5E5"> VMS running together that adds</font>

766
00:35:04,650 --> 00:35:10,290
up after a while and the problem<font color="#CCCCCC"> with</font>

767
00:35:07,530 --> 00:35:12,000
combining them all into<font color="#CCCCCC"> one vm or you're</font>

768
00:35:10,290 --> 00:35:15,360
stacking them in any way<font color="#CCCCCC"> shape or form</font>

769
00:35:12,000 --> 00:35:17,580
in that<font color="#E5E5E5"> way is that AV scanners don't</font>

770
00:35:15,360 --> 00:35:19,620
play well with<font color="#E5E5E5"> each other they actually</font>

771
00:35:17,580 --> 00:35:22,360
look for each other<font color="#CCCCCC"> and they say you</font>

772
00:35:19,620 --> 00:35:25,180
know if you install AV scanner x

773
00:35:22,360 --> 00:35:27,190
it will say dude there's AV scanner why

774
00:35:25,180 --> 00:35:30,040
right there I'm<font color="#E5E5E5"> not going to let you</font>

775
00:35:27,190 --> 00:35:33,430
install me unless you remove that one or

776
00:35:30,040 --> 00:35:35,740
some<font color="#CCCCCC"> of them go hi i found AV scanner be</font>

777
00:35:33,430 --> 00:35:37,720
<font color="#E5E5E5">i'm going to just remove it for you and</font>

778
00:35:35,740 --> 00:35:39,819
<font color="#E5E5E5">then it's gone so that doesn't make</font><font color="#CCCCCC"> it</font>

779
00:35:37,720 --> 00:35:43,149
easy to install many AV scanners

780
00:35:39,820 --> 00:35:45,360
together on the same machine so what

781
00:35:43,150 --> 00:35:48,100
I've come up with<font color="#E5E5E5"> here is to use docker</font>

782
00:35:45,360 --> 00:35:50,830
you know I there<font color="#E5E5E5"> are a few other</font>

783
00:35:48,100 --> 00:35:53,620
competing open source projects that do

784
00:35:50,830 --> 00:35:56,640
the same thing as dr. but<font color="#E5E5E5"> dr. is very</font>

785
00:35:53,620 --> 00:36:01,359
you know commonly<font color="#E5E5E5"> found well supported</font>

786
00:35:56,640 --> 00:36:05,080
and fairly easy to use what<font color="#E5E5E5"> dr. does is</font>

787
00:36:01,360 --> 00:36:08,350
it creates containers inside of a linux

788
00:36:05,080 --> 00:36:10,299
machine and those containers you<font color="#CCCCCC"> can</font>

789
00:36:08,350 --> 00:36:12,190
install<font color="#E5E5E5"> software and</font><font color="#CCCCCC"> that and the</font>

790
00:36:10,300 --> 00:36:13,540
software that's in that container can't

791
00:36:12,190 --> 00:36:15,940
see the software that's in another

792
00:36:13,540 --> 00:36:18,340
container so it's sort of a it's like<font color="#CCCCCC"> a</font>

793
00:36:15,940 --> 00:36:21,490
virtual it's not a vm but it's a virtual

794
00:36:18,340 --> 00:36:24,430
<font color="#CCCCCC">environment inside of a vm or inside of</font>

795
00:36:21,490 --> 00:36:26,950
a bare metal machine so you<font color="#CCCCCC"> could so you</font>

796
00:36:24,430 --> 00:36:29,950
can install any number of different

797
00:36:26,950 --> 00:36:32,919
systems<font color="#E5E5E5"> in those in those docker</font>

798
00:36:29,950 --> 00:36:36,910
containers and they can all live on one

799
00:36:32,920 --> 00:36:42,370
<font color="#CCCCCC">VM and it would save money you know for</font>

800
00:36:36,910 --> 00:36:45,190
for cloud services um and if the next 10

801
00:36:42,370 --> 00:36:48,580
CR so OCR is still that's a tough that's

802
00:36:45,190 --> 00:36:51,340
<font color="#E5E5E5">a very tough problem it's difficult</font><font color="#CCCCCC"> to</font>

803
00:36:48,580 --> 00:36:53,980
get that correct and so I'm still

804
00:36:51,340 --> 00:36:55,980
working<font color="#E5E5E5"> on that damn anization that's</font>

805
00:36:53,980 --> 00:36:58,810
also something that I need<font color="#CCCCCC"> to work on</font>

806
00:36:55,980 --> 00:37:00,880
the plague scanner core is still just a

807
00:36:58,810 --> 00:37:03,700
set of scripts where you run it and then

808
00:37:00,880 --> 00:37:06,010
it does its work and<font color="#E5E5E5"> the the information</font>

809
00:37:03,700 --> 00:37:08,950
<font color="#E5E5E5">comes back I would like</font><font color="#CCCCCC"> to have it</font>

810
00:37:06,010 --> 00:37:11,890
similar to if you're familiar with

811
00:37:08,950 --> 00:37:13,899
cuckoo sandbox anybody heard of cuckoo

812
00:37:11,890 --> 00:37:15,819
so cuckoo actually sits there and runs

813
00:37:13,900 --> 00:37:18,760
and<font color="#E5E5E5"> then you submit jobs to it via the</font>

814
00:37:15,820 --> 00:37:21,850
the sequel database that it keeps its

815
00:37:18,760 --> 00:37:23,590
job sort job list in so I'd<font color="#CCCCCC"> like to do</font>

816
00:37:21,850 --> 00:37:26,170
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that like have a have</font>

817
00:37:23,590 --> 00:37:29,170
like a list of jobs coming up and then

818
00:37:26,170 --> 00:37:31,270
have a you know always running<font color="#E5E5E5"> process</font>

819
00:37:29,170 --> 00:37:35,559
that the jobs are submitted<font color="#CCCCCC"> to and then</font>

820
00:37:31,270 --> 00:37:38,170
have that do the processing constantly

821
00:37:35,559 --> 00:37:40,869
another<font color="#CCCCCC"> problem that these have so</font>

822
00:37:38,170 --> 00:37:43,779
scanner updating this is sort of like

823
00:37:40,869 --> 00:37:45,849
herding cats like each one<font color="#CCCCCC"> of these AV</font>

824
00:37:43,779 --> 00:37:47,410
scanner engines wants to update in a

825
00:37:45,849 --> 00:37:50,170
different way wants<font color="#E5E5E5"> to update a</font>

826
00:37:47,410 --> 00:37:52,209
different time and so they're all just

827
00:37:50,170 --> 00:37:55,180
you know they're<font color="#E5E5E5"> doing kind of random</font>

828
00:37:52,209 --> 00:38:00,819
things right to update themselves I

829
00:37:55,180 --> 00:38:04,118
don't have a way to watch monitor or you

830
00:38:00,819 --> 00:38:06,130
know coordinate any of the updating it

831
00:38:04,119 --> 00:38:09,670
just either doesn't<font color="#E5E5E5"> happen and you have</font>

832
00:38:06,130 --> 00:38:11,319
to do it manually or it does its own

833
00:38:09,670 --> 00:38:14,189
automated updating it does it whenever

834
00:38:11,319 --> 00:38:17,199
it wants<font color="#E5E5E5"> to or breaks or whatever so</font>

835
00:38:14,189 --> 00:38:20,558
what I want to do<font color="#CCCCCC"> is have some layer</font>

836
00:38:17,199 --> 00:38:22,749
where it watches for updates or controls

837
00:38:20,559 --> 00:38:25,839
updates for each type<font color="#CCCCCC"> of scanner engine</font>

838
00:38:22,749 --> 00:38:29,259
and that's also valuable because it

839
00:38:25,839 --> 00:38:31,779
would give me<font color="#CCCCCC"> a day por a timestamp when</font>

840
00:38:29,259 --> 00:38:34,150
the update happens and<font color="#CCCCCC"> I can add that to</font>

841
00:38:31,779 --> 00:38:35,799
the JSON document for each one<font color="#CCCCCC"> of the</font>

842
00:38:34,150 --> 00:38:37,839
scanner results and<font color="#CCCCCC"> that can be</font>

843
00:38:35,799 --> 00:38:40,630
important because the the scanner

844
00:38:37,839 --> 00:38:43,328
signatures that a scanner uses might be

845
00:38:40,630 --> 00:38:45,759
different at 4pm than they were at 8am

846
00:38:43,329 --> 00:38:47,920
and you know that's important because at

847
00:38:45,759 --> 00:38:49,749
4pm it began detecting are sniffing at

848
00:38:47,920 --> 00:38:51,519
8am it didn't detect it so I want<font color="#E5E5E5"> to</font>

849
00:38:49,749 --> 00:38:53,618
know like I want<font color="#E5E5E5"> to be able to see that</font>

850
00:38:51,519 --> 00:38:56,169
in the data and be able to look at those

851
00:38:53,619 --> 00:38:58,499
sorts of changes so that's important to

852
00:38:56,170 --> 00:39:01,660
have in there but it doesn't do that yet

853
00:38:58,499 --> 00:39:03,218
that is also going to be<font color="#CCCCCC"> a difficult</font>

854
00:39:01,660 --> 00:39:04,660
problem because as<font color="#E5E5E5"> I said it's like</font>

855
00:39:03,219 --> 00:39:06,069
herding cats they all want<font color="#CCCCCC"> to go in</font>

856
00:39:04,660 --> 00:39:08,469
different directions and they you know

857
00:39:06,069 --> 00:39:10,420
they want<font color="#E5E5E5"> someone want to go outside I</font>

858
00:39:08,469 --> 00:39:15,309
<font color="#E5E5E5">want to go come back inside right after</font>

859
00:39:10,420 --> 00:39:17,829
they go<font color="#CCCCCC"> outside so the</font><font color="#E5E5E5"> next thing that's</font>

860
00:39:15,309 --> 00:39:20,439
<font color="#E5E5E5">uh that is an open problem is</font>

861
00:39:17,829 --> 00:39:22,269
resubmission automation so<font color="#E5E5E5"> I want to</font>

862
00:39:20,439 --> 00:39:25,199
then this is this depends on the

863
00:39:22,269 --> 00:39:30,008
demonization step I want to be able to

864
00:39:25,199 --> 00:39:32,199
not burden someone with a scanner result

865
00:39:30,009 --> 00:39:34,900
of<font color="#E5E5E5"> zero so if there's a scanner result</font>

866
00:39:32,199 --> 00:39:39,969
of 0 you could have a flag set for that

867
00:39:34,900 --> 00:39:42,249
job that says if it has<font color="#E5E5E5"> zero rescan on a</font>

868
00:39:39,969 --> 00:39:44,079
schedule don't ask<font color="#E5E5E5"> me you know don't</font>

869
00:39:42,249 --> 00:39:46,269
make me come<font color="#CCCCCC"> back and do</font><font color="#E5E5E5"> anything just</font>

870
00:39:44,079 --> 00:39:47,979
rescan on a schedule until it hits a

871
00:39:46,269 --> 00:39:49,299
scanner result and when it hits a

872
00:39:47,979 --> 00:39:53,410
scanner result maybe send me

873
00:39:49,300 --> 00:39:56,710
or an alert or nagios you know turn

874
00:39:53,410 --> 00:39:59,170
something<font color="#E5E5E5"> yellow or whatever and so say</font>

875
00:39:56,710 --> 00:40:00,550
like hey you've<font color="#CCCCCC"> got a result</font><font color="#E5E5E5"> so I want</font>

876
00:39:59,170 --> 00:40:01,600
to automate that so you don't<font color="#E5E5E5"> have to</font>

877
00:40:00,550 --> 00:40:03,040
really<font color="#CCCCCC"> think about</font><font color="#E5E5E5"> it if you've got a</font>

878
00:40:01,600 --> 00:40:05,529
<font color="#CCCCCC">lot of stuff coming in you</font><font color="#E5E5E5"> don't want to</font>

879
00:40:03,040 --> 00:40:07,300
sit<font color="#CCCCCC"> there and kind</font><font color="#E5E5E5"> of fiddle with all of</font>

880
00:40:05,530 --> 00:40:09,780
it you want<font color="#E5E5E5"> to be able to automate your</font>

881
00:40:07,300 --> 00:40:13,060
that<font color="#E5E5E5"> your your processes so have</font>

882
00:40:09,780 --> 00:40:16,270
resubmission automation another feature

883
00:40:13,060 --> 00:40:20,650
if you're familiar with again coo coo

884
00:40:16,270 --> 00:40:22,930
sandbox or Thug thug is a low

885
00:40:20,650 --> 00:40:25,240
interaction honey client it's for

886
00:40:22,930 --> 00:40:27,009
<font color="#E5E5E5">visiting a website and then when you</font>

887
00:40:25,240 --> 00:40:29,859
visit the website getting the malware

888
00:40:27,010 --> 00:40:35,740
from it so it pretends to be a variety

889
00:40:29,860 --> 00:40:38,860
<font color="#CCCCCC">of browsers and it also pretends to have</font>

890
00:40:35,740 --> 00:40:41,950
the correct the correct<font color="#CCCCCC"> java version or</font>

891
00:40:38,860 --> 00:40:44,140
flash version or reader version that is

892
00:40:41,950 --> 00:40:46,210
necessary to be infected and so it

893
00:40:44,140 --> 00:40:49,629
collects the binary from the from That

894
00:40:46,210 --> 00:40:51,970
visit so these two things coo coo

895
00:40:49,630 --> 00:40:53,290
sandbox is a thing for sandboxing

896
00:40:51,970 --> 00:40:54,759
malware and getting all of the

897
00:40:53,290 --> 00:40:57,520
indicators<font color="#E5E5E5"> have compromised out of it</font>

898
00:40:54,760 --> 00:41:00,190
and getting its behavioral and other

899
00:40:57,520 --> 00:41:03,009
other components coo coo has lots more

900
00:41:00,190 --> 00:41:05,950
in it than that but both of<font color="#E5E5E5"> them have</font>

901
00:41:03,010 --> 00:41:08,050
the ability to use a protocol called HP

902
00:41:05,950 --> 00:41:09,970
feeds and<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> know if you're</font>

903
00:41:08,050 --> 00:41:13,030
familiar with HP feeds but it's part of

904
00:41:09,970 --> 00:41:16,480
the honey net project and what it is

905
00:41:13,030 --> 00:41:19,380
it's a publish and subscribe protocol

906
00:41:16,480 --> 00:41:23,620
for<font color="#E5E5E5"> sandboxes and and collectors of</font>

907
00:41:19,380 --> 00:41:25,870
malware data so you can have instances

908
00:41:23,620 --> 00:41:28,680
of thug and cuckoo out there in the

909
00:41:25,870 --> 00:41:31,870
world and then they can be producing

910
00:41:28,680 --> 00:41:35,410
binaries and also the binary analysis

911
00:41:31,870 --> 00:41:38,140
data right and it combines all of this

912
00:41:35,410 --> 00:41:41,220
into a feed and then the feed can be

913
00:41:38,140 --> 00:41:44,410
subscribed to by other researchers and

914
00:41:41,220 --> 00:41:46,419
HP feeds actually has a social<font color="#E5E5E5"> platform</font>

915
00:41:44,410 --> 00:41:51,100
it's a social<font color="#E5E5E5"> network based on malware</font>

916
00:41:46,420 --> 00:41:53,170
called HP friends and HP friends you

917
00:41:51,100 --> 00:41:54,819
sign up for accounts and you know

918
00:41:53,170 --> 00:41:56,860
instead<font color="#CCCCCC"> of it being Facebook where you</font>

919
00:41:54,820 --> 00:42:00,190
you know you messaged each other about

920
00:41:56,860 --> 00:42:02,170
like whatever<font color="#E5E5E5"> you do and share photos</font>

921
00:42:00,190 --> 00:42:02,740
and stuff like that you share malware

922
00:42:02,170 --> 00:42:05,320
feeds

923
00:42:02,740 --> 00:42:07,359
with HP feed so you have your friends

924
00:42:05,320 --> 00:42:09,369
and HP friends and then if you're a

925
00:42:07,360 --> 00:42:11,860
friend or you know if you're in a group

926
00:42:09,369 --> 00:42:14,050
you get to you know you get to subscribe

927
00:42:11,860 --> 00:42:16,230
to all of the HP feeds that group

928
00:42:14,050 --> 00:42:21,670
publishes so it's an<font color="#E5E5E5"> interesting concept</font>

929
00:42:16,230 --> 00:42:23,410
I would love to have HP feeds ability in

930
00:42:21,670 --> 00:42:25,240
plague scanner so that you could have a

931
00:42:23,410 --> 00:42:28,029
plague scanner instance out there and

932
00:42:25,240 --> 00:42:31,359
then if you so choose you could share

933
00:42:28,030 --> 00:42:34,300
all of the binaries and the the AV

934
00:42:31,360 --> 00:42:37,270
results with<font color="#CCCCCC"> your with your HP friends</font>

935
00:42:34,300 --> 00:42:40,869
out there that is not<font color="#E5E5E5"> in there yet it's</font>

936
00:42:37,270 --> 00:42:45,660
just a a hope that I get to that

937
00:42:40,869 --> 00:42:51,970
eventually so let's do a demo of the

938
00:42:45,660 --> 00:42:55,118
plague scanner so sorry<font color="#E5E5E5"> about the</font>

939
00:42:51,970 --> 00:42:56,919
resolution<font color="#E5E5E5"> on this it's another recorded</font>

940
00:42:55,119 --> 00:43:15,700
demo and I apologize for<font color="#E5E5E5"> the resolution</font>

941
00:42:56,920 --> 00:43:18,280
but ok so in the on the right side you

942
00:43:15,700 --> 00:43:21,399
see again that's process hacker I love

943
00:43:18,280 --> 00:43:23,650
process hacker this is just a show I I'm

944
00:43:21,400 --> 00:43:26,230
using it here<font color="#E5E5E5"> just to show that</font><font color="#CCCCCC"> the</font>

945
00:43:23,650 --> 00:43:29,050
thing is working because this particular

946
00:43:26,230 --> 00:43:31,510
this particular vm that we're<font color="#CCCCCC"> looking at</font>

947
00:43:29,050 --> 00:43:34,510
<font color="#CCCCCC">right now is a windows vm and it's</font>

948
00:43:31,510 --> 00:43:37,119
running<font color="#E5E5E5"> trend micro of scanners Trend</font>

949
00:43:34,510 --> 00:43:40,119
<font color="#E5E5E5">Micro's scanner and trend micro scanner</font>

950
00:43:37,119 --> 00:43:42,580
is a little bit wonky at some times and

951
00:43:40,119 --> 00:43:44,080
it it can choke on some of the binary

952
00:43:42,580 --> 00:43:46,359
<font color="#CCCCCC">Zand so I'll</font><font color="#E5E5E5"> have to</font><font color="#CCCCCC"> go in here and</font>

953
00:43:44,080 --> 00:43:48,310
actually hit you know a click a button

954
00:43:46,359 --> 00:43:50,650
so that's actually<font color="#E5E5E5"> one of the things</font>

955
00:43:48,310 --> 00:43:54,850
<font color="#CCCCCC">that I want</font><font color="#E5E5E5"> to work on is have a button</font>

956
00:43:50,650 --> 00:43:56,500
clicker you know if if if a window pops

957
00:43:54,850 --> 00:43:58,390
up with a button I just want<font color="#E5E5E5"> to click</font>

958
00:43:56,500 --> 00:44:01,680
the button<font color="#E5E5E5"> who cares what it says I</font>

959
00:43:58,390 --> 00:44:01,680
don't just click it

960
00:44:02,039 --> 00:44:08,559
yeah like<font color="#E5E5E5"> a user exactly i mean it is</font>

961
00:44:05,710 --> 00:44:12,460
basically<font color="#E5E5E5"> that there's a there's a</font>

962
00:44:08,559 --> 00:44:19,000
button clicker in in coo coo sandbox and

963
00:44:12,460 --> 00:44:22,569
it's<font color="#CCCCCC"> actually called human pie so okay</font>

964
00:44:19,000 --> 00:44:27,579
<font color="#E5E5E5">so we're going to watch the session here</font>

965
00:44:22,569 --> 00:44:30,250
so this is this is the this is<font color="#E5E5E5"> one of</font>

966
00:44:27,579 --> 00:44:34,299
<font color="#E5E5E5">the scanner engines its trend micro and</font>

967
00:44:30,250 --> 00:44:38,200
then in a moment we will go to<font color="#E5E5E5"> we'll</font>

968
00:44:34,299 --> 00:44:44,980
take a look at<font color="#E5E5E5"> core wish i had a little</font>

969
00:44:38,200 --> 00:44:50,859
an easier fast forward<font color="#E5E5E5"> okay so this is</font>

970
00:44:44,980 --> 00:44:58,869
this is the core let me<font color="#CCCCCC"> scoop oh dope it</font>

971
00:44:50,859 --> 00:45:00,549
all the way ahead sorry about that just

972
00:44:58,869 --> 00:45:06,339
trying to<font color="#E5E5E5"> move this up here with out of</font>

973
00:45:00,549 --> 00:45:08,890
the way okay so all right this is the

974
00:45:06,339 --> 00:45:20,740
core and at this point we're running

975
00:45:08,890 --> 00:45:23,769
samples through it<font color="#CCCCCC"> binary for that's</font><font color="#E5E5E5"> the</font>

976
00:45:20,740 --> 00:45:25,720
unicorn bug binary<font color="#CCCCCC"> i don't know if</font>

977
00:45:23,769 --> 00:45:28,868
anyone<font color="#E5E5E5"> had heard of that one but came</font>

978
00:45:25,720 --> 00:45:32,410
out like last year or no earlier this

979
00:45:28,869 --> 00:45:36,940
year I think IBM researchers found it it

980
00:45:32,410 --> 00:45:41,259
<font color="#CCCCCC">was a bug in oly off 32 dll this is a</font>

981
00:45:36,940 --> 00:45:43,000
dll that's loaded by everything<font color="#E5E5E5"> and by</font>

982
00:45:41,259 --> 00:45:45,279
<font color="#E5E5E5">the way it's not just loaded by a lot of</font>

983
00:45:43,000 --> 00:45:49,539
things it is also loaded by a lot<font color="#E5E5E5"> of</font>

984
00:45:45,279 --> 00:45:51,549
<font color="#E5E5E5">things going</font><font color="#CCCCCC"> back to</font><font color="#E5E5E5"> windows 95 so</font><font color="#CCCCCC"> i've</font>

985
00:45:49,539 --> 00:45:53,289
<font color="#E5E5E5">heard people say oh if you want to be</font>

986
00:45:51,549 --> 00:45:56,950
safe from malware you would<font color="#E5E5E5"> just run</font>

987
00:45:53,289 --> 00:46:01,180
windows 95 oh no this particular binary

988
00:45:56,950 --> 00:46:04,480
can exploit that<font color="#E5E5E5"> dll the bug that's in</font>

989
00:46:01,180 --> 00:46:06,609
that<font color="#CCCCCC"> dll going back to windows 95 which</font>

990
00:46:04,480 --> 00:46:07,990
is very interesting so that's why they

991
00:46:06,609 --> 00:46:09,730
called<font color="#E5E5E5"> it the unicorn it's something</font>

992
00:46:07,990 --> 00:46:12,979
<font color="#E5E5E5">that can exploit a bug bits gift that</font>

993
00:46:09,730 --> 00:46:15,060
just<font color="#CCCCCC"> is hits all versions of Windows</font>

994
00:46:12,980 --> 00:46:17,270
it would have<font color="#E5E5E5"> been really cool if it got</font>

995
00:46:15,060 --> 00:46:21,660
<font color="#CCCCCC">wind is 351 or something like that but</font>

996
00:46:17,270 --> 00:46:23,849
you can only hope<font color="#E5E5E5"> okay so the other</font>

997
00:46:21,660 --> 00:46:28,410
samples that<font color="#E5E5E5"> I'm running through here</font>

998
00:46:23,849 --> 00:46:31,410
let's hit<font color="#E5E5E5"> play so it's</font><font color="#CCCCCC"> going through</font>

999
00:46:28,410 --> 00:46:35,580
<font color="#CCCCCC">each one of these each one of these</font>

1000
00:46:31,410 --> 00:46:38,759
particular X but sorry each one of these

1001
00:46:35,580 --> 00:46:42,240
particular binaries and these that are

1002
00:46:38,760 --> 00:46:46,349
running right now are the<font color="#CCCCCC"> cv21</font><font color="#E5E5E5"> fought to</font>

1003
00:46:42,240 --> 00:46:50,189
20 2015 03 11 so this is a this is a

1004
00:46:46,349 --> 00:46:52,440
<font color="#CCCCCC">Trojan that was a flash exploit from</font>

1005
00:46:50,190 --> 00:46:54,180
about a month and a half ago this was

1006
00:46:52,440 --> 00:46:56,760
the flash exploit that was the O'Day

1007
00:46:54,180 --> 00:46:58,680
that just appeared out of nowhere and

1008
00:46:56,760 --> 00:47:01,140
then you know<font color="#E5E5E5"> Adobe took a little bit of</font>

1009
00:46:58,680 --> 00:47:02,810
time<font color="#E5E5E5"> getting the getting the fix out</font>

1010
00:47:01,140 --> 00:47:05,819
there but there were binaries out there

1011
00:47:02,810 --> 00:47:08,640
exploiting it in the wild so this was

1012
00:47:05,820 --> 00:47:13,050
this<font color="#E5E5E5"> is that particular one and as you</font>

1013
00:47:08,640 --> 00:47:18,839
can see we've<font color="#CCCCCC"> got the</font><font color="#E5E5E5"> AVGN result here</font>

1014
00:47:13,050 --> 00:47:22,290
so you've got clam Navy and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> result</font>

1015
00:47:18,839 --> 00:47:25,170
is<font color="#CCCCCC"> that resulted play maybe it's just</font>

1016
00:47:22,290 --> 00:47:28,080
saying that is the general exploit ages

1017
00:47:25,170 --> 00:47:30,990
and really tell you what it<font color="#CCCCCC"> is we've</font><font color="#E5E5E5"> got</font>

1018
00:47:28,080 --> 00:47:36,450
that here and it<font color="#CCCCCC"> give you the actual TV</font>

1019
00:47:30,990 --> 00:47:38,459
for it and then any my throat<font color="#CCCCCC"> on these</font>

1020
00:47:36,450 --> 00:47:41,910
are just three demo scanners for it I

1021
00:47:38,460 --> 00:47:46,040
have a lot a lot<font color="#E5E5E5"> more so at the moment</font>

1022
00:47:41,910 --> 00:47:52,730
I've instrumented bitdefender ESET avast

1023
00:47:46,040 --> 00:47:52,730
Windows Defender clam AV Komodo and

1024
00:47:53,000 --> 00:47:58,140
that's it so there's more more on their

1025
00:47:56,190 --> 00:48:00,660
way anyone who wants<font color="#CCCCCC"> to join the project</font>

1026
00:47:58,140 --> 00:48:04,200
and help instrument AV scanners please

1027
00:48:00,660 --> 00:48:07,379
talk to me after this I definitely need

1028
00:48:04,200 --> 00:48:10,710
your help it's a monumental task I would

1029
00:48:07,380 --> 00:48:13,770
like<font color="#CCCCCC"> to have this at par with with some</font>

1030
00:48:10,710 --> 00:48:17,490
of the main commercial and online

1031
00:48:13,770 --> 00:48:25,890
scanners so scoop this back over here

1032
00:48:17,490 --> 00:48:26,879
and<font color="#E5E5E5"> so I wanted to just give a shameless</font>

1033
00:48:25,890 --> 00:48:28,740
plug for<font color="#E5E5E5"> my</font>

1034
00:48:26,880 --> 00:48:32,759
ployer they are<font color="#CCCCCC"> awesome</font><font color="#E5E5E5"> I started there</font>

1035
00:48:28,740 --> 00:48:35,729
in November so I'm one of their new

1036
00:48:32,759 --> 00:48:38,009
newer employees threat connect it

1037
00:48:35,730 --> 00:48:41,849
provides a advanced collaborative threat

1038
00:48:38,009 --> 00:48:44,190
intelligence platform and it has a free

1039
00:48:41,849 --> 00:48:46,799
version right so a free level so it's

1040
00:48:44,190 --> 00:48:49,470
not you know if it's<font color="#E5E5E5"> it's not there's no</font>

1041
00:48:46,799 --> 00:48:51,240
paid there are many levels of paid

1042
00:48:49,470 --> 00:48:53,490
accounts but all of you can sign<font color="#CCCCCC"> up for</font>

1043
00:48:51,240 --> 00:48:54,959
<font color="#CCCCCC">a free account in there and you can see</font>

1044
00:48:53,490 --> 00:48:58,890
<font color="#CCCCCC">the indicators that compromise that I</font>

1045
00:48:54,960 --> 00:49:01,799
share with<font color="#E5E5E5"> the common community you can</font>

1046
00:48:58,890 --> 00:49:03,779
also<font color="#CCCCCC"> share your indicators there's a</font><font color="#E5E5E5"> lot</font>

1047
00:49:01,799 --> 00:49:06,839
of new you<font color="#CCCCCC"> know new malware that shows</font>

1048
00:49:03,779 --> 00:49:10,829
up that<font color="#CCCCCC"> we that we put data for in the</font>

1049
00:49:06,839 --> 00:49:12,779
<font color="#E5E5E5">platform and please sign up</font><font color="#CCCCCC"> for an</font>

1050
00:49:10,829 --> 00:49:16,130
account and if you want<font color="#E5E5E5"> to talk about</font>

1051
00:49:12,779 --> 00:49:19,579
<font color="#E5E5E5">this come come find me after my talk</font>

1052
00:49:16,130 --> 00:49:26,130
looks like i said<font color="#CCCCCC"> i had five minutes so</font>

1053
00:49:19,579 --> 00:49:30,089
cool<font color="#CCCCCC"> all right so any questions</font><font color="#E5E5E5"> oh sorry</font>

1054
00:49:26,130 --> 00:49:33,000
i meant to say so the so my my my handle

1055
00:49:30,089 --> 00:49:36,210
is vodka knows and who knows is Russian

1056
00:49:33,000 --> 00:49:42,140
<font color="#CCCCCC">for duckbill platypus so leaving</font><font color="#E5E5E5"> you</font>

1057
00:49:36,210 --> 00:49:42,140
with a baby duck billed platypus yes

1058
00:49:44,539 --> 00:49:53,000
that's a<font color="#CCCCCC"> very good question I don't so</font>

1059
00:49:49,430 --> 00:49:57,000
one of the so I think doing mobile

1060
00:49:53,000 --> 00:50:00,180
mobile malware scanners would be a

1061
00:49:57,000 --> 00:50:02,190
little bit redundant except<font color="#CCCCCC"> for a few so</font>

1062
00:50:00,180 --> 00:50:05,910
there are<font color="#CCCCCC"> a few AV scanners that are</font>

1063
00:50:02,190 --> 00:50:08,450
mobile that are mobile targeted their

1064
00:50:05,910 --> 00:50:11,670
specific to mobile and don't have a

1065
00:50:08,450 --> 00:50:14,640
version<font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> Windows or Linux or</font>

1066
00:50:11,670 --> 00:50:17,490
anything like that so I would like<font color="#CCCCCC"> to</font>

1067
00:50:14,640 --> 00:50:19,470
however<font color="#CCCCCC"> that would require you know</font>

1068
00:50:17,490 --> 00:50:21,269
putting up a you know<font color="#CCCCCC"> android for</font>

1069
00:50:19,470 --> 00:50:22,950
<font color="#CCCCCC">Android at least the</font><font color="#E5E5E5"> Android SDK and</font>

1070
00:50:21,269 --> 00:50:25,410
running it you know you can run android

1071
00:50:22,950 --> 00:50:27,390
sdk and have<font color="#E5E5E5"> like a little vm and you</font>

1072
00:50:25,410 --> 00:50:30,680
can run your that's actually how I run

1073
00:50:27,390 --> 00:50:30,680
my mobile malware in the in

1074
00:50:43,559 --> 00:50:51,460
awesome<font color="#CCCCCC"> I will after the talk i'll come</font>

1075
00:50:47,319 --> 00:50:53,319
get that<font color="#E5E5E5"> info from</font><font color="#CCCCCC"> you yes so I do i do</font>

1076
00:50:51,460 --> 00:50:56,200
want to<font color="#E5E5E5"> do mobile but right now I mean</font>

1077
00:50:53,319 --> 00:50:59,740
that I've already got like a lot of up

1078
00:50:56,200 --> 00:51:01,689
scope so I'm<font color="#E5E5E5"> trying to just get get the</font>

1079
00:50:59,740 --> 00:51:03,729
<font color="#E5E5E5">get the core of it done and then I can</font>

1080
00:51:01,690 --> 00:51:05,740
start working on up scope but a very

1081
00:51:03,730 --> 00:51:07,829
<font color="#E5E5E5">good point I'll you know I'll make sure</font>

1082
00:51:05,740 --> 00:51:11,490
if you want to<font color="#E5E5E5"> come talk to me out all</font>

1083
00:51:07,829 --> 00:51:28,180
you know let you know when it's ready

1084
00:51:11,490 --> 00:51:30,609
any other question so that's another

1085
00:51:28,180 --> 00:51:33,069
good point and no<font color="#E5E5E5"> I have not begun</font>

1086
00:51:30,609 --> 00:51:35,259
trying to and you're<font color="#CCCCCC"> talking in the</font>

1087
00:51:33,069 --> 00:51:37,750
windows world right yeah so<font color="#E5E5E5"> I have not</font>

1088
00:51:35,260 --> 00:51:39,520
begun trying to shoehorn multiple AV

1089
00:51:37,750 --> 00:51:41,950
scanner engines on to the same box I

1090
00:51:39,520 --> 00:51:45,819
would love to and you know if<font color="#E5E5E5"> you have</font>

1091
00:51:41,950 --> 00:51:48,399
any ideas please let me know but so I

1092
00:51:45,819 --> 00:51:50,829
had focused first on the linux area and

1093
00:51:48,400 --> 00:51:54,099
docker just seems like you know easy the

1094
00:51:50,829 --> 00:51:56,619
easy button for doing that any other

1095
00:51:54,099 --> 00:51:58,630
questions I<font color="#E5E5E5"> would love to have dr. for</font>

1096
00:51:56,619 --> 00:52:08,470
<font color="#CCCCCC">Windows but</font><font color="#E5E5E5"> it just it it's based on a</font>

1097
00:51:58,630 --> 00:52:12,819
<font color="#E5E5E5">Linux only component so yes</font><font color="#CCCCCC"> I'm awesome</font>

1098
00:52:08,470 --> 00:52:14,740
I mean I'm windows is not<font color="#E5E5E5"> my favorite</font>

1099
00:52:12,819 --> 00:52:17,049
thing but<font color="#CCCCCC"> doctor and the concept of</font>

1100
00:52:14,740 --> 00:52:21,149
docker makes things better makes

1101
00:52:17,049 --> 00:52:27,400
everything better any other questions

1102
00:52:21,150 --> 00:52:31,410
<font color="#E5E5E5">alright so I have some</font><font color="#CCCCCC"> schwag hmm so</font>

1103
00:52:27,400 --> 00:52:31,410
lanyard who wants a lanyard lanyard

1104
00:52:31,470 --> 00:52:40,830
another lanyard ah and then this is<font color="#E5E5E5"> that</font>

1105
00:52:37,400 --> 00:52:44,130
so since I'm so far from home I brought

1106
00:52:40,830 --> 00:52:47,970
<font color="#CCCCCC">you a Delaware b-side shirt so who wants</font>

1107
00:52:44,130 --> 00:52:56,330
a Delaware b-side shirt it's a large I

1108
00:52:47,970 --> 00:53:02,368
think and a threat connect shirt with

1109
00:52:56,330 --> 00:53:05,640
which is that all<font color="#CCCCCC"> of it back oh no no</font>

1110
00:53:02,369 --> 00:53:09,030
interceptions allowed because I do<font color="#CCCCCC"> have</font>

1111
00:53:05,640 --> 00:53:12,000
another<font color="#E5E5E5"> one this would I think they're</font>

1112
00:53:09,030 --> 00:53:13,440
<font color="#E5E5E5">both the same size got another one you</font>

1113
00:53:12,000 --> 00:53:19,740
want it over here anyone over here on it

1114
00:53:13,440 --> 00:53:22,980
all right all the way there orange all

1115
00:53:19,740 --> 00:53:32,040
right<font color="#E5E5E5"> actually where you get this one</font>

1116
00:53:22,980 --> 00:53:35,450
you don't know me pass<font color="#CCCCCC"> that one back</font>

1117
00:53:32,040 --> 00:53:35,450
there<font color="#CCCCCC"> all right thanks everybody</font>

