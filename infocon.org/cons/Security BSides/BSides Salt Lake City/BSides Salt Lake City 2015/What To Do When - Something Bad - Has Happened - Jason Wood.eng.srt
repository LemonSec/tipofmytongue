1
00:00:02,029 --> 00:00:06,810
<font color="#CCCCCC">alright thanks everybody for coming out</font>

2
00:00:04,890 --> 00:00:11,910
can you guys hear me okay back there

3
00:00:06,810 --> 00:00:14,610
okay good deal so the this talk like I

4
00:00:11,910 --> 00:00:18,090
said what to do when something bad has

5
00:00:14,610 --> 00:00:19,560
happened and a lot of<font color="#E5E5E5"> this was driven by</font>

6
00:00:18,090 --> 00:00:22,439
things i have observed earned

7
00:00:19,560 --> 00:00:25,169
penetration test when the ops team is

8
00:00:22,439 --> 00:00:27,689
starting to try and troubleshoot what

9
00:00:25,170 --> 00:00:30,119
we're doing and and figure out<font color="#CCCCCC"> how to</font>

10
00:00:27,689 --> 00:00:32,969
keep us from getting access to systems

11
00:00:30,119 --> 00:00:35,340
and and it it gets<font color="#CCCCCC"> into be kind of</font>

12
00:00:32,969 --> 00:00:38,879
interesting<font color="#E5E5E5"> to see how that can play out</font>

13
00:00:35,340 --> 00:00:41,040
<font color="#E5E5E5">into things you already heard a little</font>

14
00:00:38,879 --> 00:00:44,040
bit about me<font color="#CCCCCC"> i'm a pen tester for secure</font>

15
00:00:41,040 --> 00:00:47,760
ideas that's what we do day in day out

16
00:00:44,040 --> 00:00:50,489
pretty<font color="#CCCCCC"> much like said i'm a sysadmin by</font>

17
00:00:47,760 --> 00:00:53,190
<font color="#E5E5E5">by trade that's my background linux and</font>

18
00:00:50,489 --> 00:00:54,959
windows infrastructure<font color="#CCCCCC"> roles a lot</font><font color="#E5E5E5"> of</font>

19
00:00:53,190 --> 00:00:56,849
time spent in that<font color="#E5E5E5"> it's just keeping</font>

20
00:00:54,960 --> 00:00:59,730
things running in the underlying systems

21
00:00:56,850 --> 00:01:03,930
<font color="#CCCCCC">i do a lot of volunteer work mostly with</font>

22
00:00:59,730 --> 00:01:05,789
with kids teenagers between scouts and

23
00:01:03,930 --> 00:01:08,670
cyber<font color="#CCCCCC"> patriot which is a great</font><font color="#E5E5E5"> program</font>

24
00:01:05,790 --> 00:01:11,400
to get<font color="#CCCCCC"> involved in for for teaching kids</font>

25
00:01:08,670 --> 00:01:12,900
computer security as<font color="#CCCCCC"> well as civil air</font>

26
00:01:11,400 --> 00:01:15,240
patrol so those are<font color="#E5E5E5"> all things that</font><font color="#CCCCCC"> i</font>

27
00:01:12,900 --> 00:01:23,009
spend my<font color="#CCCCCC"> time doing which has grown to</font>

28
00:01:15,240 --> 00:01:24,899
be quite a bit of time<font color="#CCCCCC"> recently so</font><font color="#E5E5E5"> i was</font>

29
00:01:23,009 --> 00:01:28,110
<font color="#E5E5E5">thinking about this how do we find out</font>

30
00:01:24,900 --> 00:01:32,869
that something's gone wrong who here has

31
00:01:28,110 --> 00:01:34,799
warned the phone or<font color="#E5E5E5"> the pager yeah</font>

32
00:01:32,869 --> 00:01:37,049
you're sitting<font color="#CCCCCC"> there you're doing</font><font color="#E5E5E5"> your</font>

33
00:01:34,799 --> 00:01:39,060
thing usually on it an inconvenient time

34
00:01:37,049 --> 00:01:41,970
you've got family around or whatever

35
00:01:39,060 --> 00:01:43,530
<font color="#E5E5E5">you're doing something else where you're</font>

36
00:01:41,970 --> 00:01:45,479
away<font color="#CCCCCC"> from a keyboard finally and your</font>

37
00:01:43,530 --> 00:01:48,540
phone starts ringing and you get<font color="#E5E5E5"> pulled</font>

38
00:01:45,479 --> 00:01:51,990
<font color="#E5E5E5">back into work now hopefully when your</font>

39
00:01:48,540 --> 00:01:53,759
phone rings these guys aren't the ones

40
00:01:51,990 --> 00:01:55,009
on<font color="#CCCCCC"> the phone telling you that you have a</font>

41
00:01:53,759 --> 00:01:57,230
problem

42
00:01:55,010 --> 00:01:59,300
I have some friends who have gotten

43
00:01:57,230 --> 00:02:01,190
those phone calls you<font color="#E5E5E5"> know where the</font>

44
00:01:59,300 --> 00:02:04,370
secret services is doing their

45
00:02:01,190 --> 00:02:05,870
investigation and a we we found<font color="#E5E5E5"> some of</font>

46
00:02:04,370 --> 00:02:08,390
your<font color="#E5E5E5"> data on a server that we're</font>

47
00:02:05,870 --> 00:02:13,160
checking out we think<font color="#CCCCCC"> you might have an</font>

48
00:02:08,389 --> 00:02:15,709
issue sometimes<font color="#E5E5E5"> you're going to get</font>

49
00:02:13,160 --> 00:02:17,329
these phone calls somebody<font color="#CCCCCC"> in the</font>

50
00:02:15,710 --> 00:02:19,160
organization is calling oh my gosh I

51
00:02:17,330 --> 00:02:20,300
think I'm hacked I'm going what do i do

52
00:02:19,160 --> 00:02:23,930
and they're panicking and they're

53
00:02:20,300 --> 00:02:25,220
freaking out<font color="#E5E5E5"> and the usually when i got</font>

54
00:02:23,930 --> 00:02:27,470
those phone calls where people said<font color="#CCCCCC"> i</font>

55
00:02:25,220 --> 00:02:29,390
think<font color="#CCCCCC"> I'm hacked unless they had things</font>

56
00:02:27,470 --> 00:02:34,040
really popping up all over their system

57
00:02:29,390 --> 00:02:37,130
which that happens I found<font color="#E5E5E5"> that there</font>

58
00:02:34,040 --> 00:02:39,140
was<font color="#E5E5E5"> something else a lot but you know</font>

59
00:02:37,130 --> 00:02:40,220
sometimes you're going to somebody's

60
00:02:39,140 --> 00:02:43,339
going<font color="#CCCCCC"> to see something</font><font color="#E5E5E5"> and they</font><font color="#CCCCCC"> think</font>

61
00:02:40,220 --> 00:02:45,590
yeah we've got a real problem here most

62
00:02:43,340 --> 00:02:49,220
of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> when I've been pulled into</font>

63
00:02:45,590 --> 00:02:55,340
things something just looks off about

64
00:02:49,220 --> 00:02:57,650
this servers acting a little strange or

65
00:02:55,340 --> 00:03:01,130
something like that they're not sure

66
00:02:57,650 --> 00:03:02,900
what's going on and say hey if you<font color="#E5E5E5"> get</font>

67
00:03:01,130 --> 00:03:04,489
called in for troubleshooting and you

68
00:03:02,900 --> 00:03:08,680
start looking at it and<font color="#E5E5E5"> you realize hey</font>

69
00:03:04,489 --> 00:03:11,900
maybe maybe something else is occurring

70
00:03:08,680 --> 00:03:13,280
so what I want to talk about is<font color="#E5E5E5"> we're</font>

71
00:03:11,900 --> 00:03:15,709
going<font color="#E5E5E5"> to dive into when we get these</font>

72
00:03:13,280 --> 00:03:18,260
phone calls or won't get<font color="#E5E5E5"> this asked to</font>

73
00:03:15,709 --> 00:03:20,720
go check something out how do<font color="#E5E5E5"> we do so</font>

74
00:03:18,260 --> 00:03:24,260
in a way that prevents us from shooting

75
00:03:20,720 --> 00:03:27,530
ourselves in the foot and the first

76
00:03:24,260 --> 00:03:28,760
thing<font color="#CCCCCC"> that I see people do when this</font>

77
00:03:27,530 --> 00:03:31,790
when they think something wrong they

78
00:03:28,760 --> 00:03:33,230
start to panic oh my gosh we got a

79
00:03:31,790 --> 00:03:38,239
problem we've<font color="#CCCCCC"> been we've been I'm going</font>

80
00:03:33,230 --> 00:03:39,590
<font color="#E5E5E5">to get fired or whatever it is and so</font>

81
00:03:38,239 --> 00:03:41,330
they<font color="#E5E5E5"> get really upset and they get</font>

82
00:03:39,590 --> 00:03:44,450
rattled and when we get rattled we start

83
00:03:41,330 --> 00:03:47,239
making even more mistakes so I<font color="#E5E5E5"> always</font>

84
00:03:44,450 --> 00:03:50,690
say you know just don't<font color="#E5E5E5"> panic some</font>

85
00:03:47,239 --> 00:03:53,090
thoughts that we may<font color="#CCCCCC"> have you know</font><font color="#E5E5E5"> here</font>

86
00:03:50,690 --> 00:03:55,040
is you know who should I call should I

87
00:03:53,090 --> 00:03:59,360
call my boss now what do I tell<font color="#E5E5E5"> him if I</font>

88
00:03:55,040 --> 00:04:03,170
do right<font color="#E5E5E5"> hey I</font><font color="#CCCCCC"> think we had an incident</font>

89
00:03:59,360 --> 00:04:07,280
response document where is that that

90
00:04:03,170 --> 00:04:08,450
might be handy right now and the last

91
00:04:07,280 --> 00:04:10,940
one here

92
00:04:08,450 --> 00:04:13,129
you get<font color="#E5E5E5"> some folks that you know they</font>

93
00:04:10,940 --> 00:04:14,359
take<font color="#E5E5E5"> this as a they get all the lid rent</font>

94
00:04:13,129 --> 00:04:15,679
they're going to show this guy and they

95
00:04:14,360 --> 00:04:18,230
star going<font color="#E5E5E5"> to mess back with the hacker</font>

96
00:04:15,680 --> 00:04:20,660
or whatever swearing that our bull in

97
00:04:18,230 --> 00:04:22,460
the china shop here you know<font color="#E5E5E5"> running</font>

98
00:04:20,660 --> 00:04:26,930
around generally causing havoc is there

99
00:04:22,460 --> 00:04:29,570
they're fighting back so rule number one

100
00:04:26,930 --> 00:04:31,840
when you get called in to check out

101
00:04:29,570 --> 00:04:39,650
something<font color="#CCCCCC"> that may</font><font color="#E5E5E5"> be security-related</font>

102
00:04:31,840 --> 00:04:41,030
don't<font color="#E5E5E5"> login is domain admin</font><font color="#CCCCCC"> will get to</font>

103
00:04:39,650 --> 00:04:45,049
this<font color="#E5E5E5"> a little bit later but you know</font>

104
00:04:41,030 --> 00:04:47,270
sometimes in pen test will make a little

105
00:04:45,050 --> 00:04:49,370
bit<font color="#CCCCCC"> of noise on</font><font color="#E5E5E5"> the network so that</font>

106
00:04:47,270 --> 00:04:51,950
<font color="#E5E5E5">somebody with elevated credentials to</font>

107
00:04:49,370 --> 00:04:57,440
<font color="#CCCCCC">the domain actually logs in we want them</font>

108
00:04:51,950 --> 00:04:58,969
<font color="#CCCCCC">to notice us so use the permissions</font><font color="#E5E5E5"> you</font>

109
00:04:57,440 --> 00:05:00,440
need something<font color="#E5E5E5"> with maybe local</font>

110
00:04:58,970 --> 00:05:02,210
administrative rights that you need for

111
00:05:00,440 --> 00:05:05,270
just right here but it's not going to

112
00:05:02,210 --> 00:05:07,120
spread laterally not going to be able to

113
00:05:05,270 --> 00:05:10,760
turn<font color="#E5E5E5"> around and pop other systems</font>

114
00:05:07,120 --> 00:05:12,110
elevate my privileges the attacker

115
00:05:10,760 --> 00:05:14,360
starts moving around to other systems

116
00:05:12,110 --> 00:05:18,680
we're<font color="#E5E5E5"> going to have a really really bad</font>

117
00:05:14,360 --> 00:05:20,150
day at a bare minimum you're going to

118
00:05:18,680 --> 00:05:23,150
spend<font color="#E5E5E5"> a lot of time now</font><font color="#CCCCCC"> chasing</font><font color="#E5E5E5"> around</font>

119
00:05:20,150 --> 00:05:24,919
to different systems most the time

120
00:05:23,150 --> 00:05:27,710
though when I've seen this is people

121
00:05:24,919 --> 00:05:31,789
didn't even notice we<font color="#CCCCCC"> were there and as</font>

122
00:05:27,710 --> 00:05:34,700
they're they're looking<font color="#E5E5E5"> at that at the</font>

123
00:05:31,789 --> 00:05:36,409
system's themselves but<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of times</font>

124
00:05:34,700 --> 00:05:38,030
our goal is<font color="#CCCCCC"> like get hashes get</font>

125
00:05:36,410 --> 00:05:39,500
<font color="#E5E5E5">credentials whatever it is so that we</font>

126
00:05:38,030 --> 00:05:42,489
<font color="#E5E5E5">can move on to the other system I'm on a</font>

127
00:05:39,500 --> 00:05:44,810
relatively under uninteresting box but

128
00:05:42,490 --> 00:05:49,280
if I can get somebody here then that's

129
00:05:44,810 --> 00:05:50,510
that would be pretty cool rule number

130
00:05:49,280 --> 00:05:55,640
two

131
00:05:50,510 --> 00:05:59,480
whoever's this gentleman from the Iraq

132
00:05:55,640 --> 00:06:01,760
war he got up there all the time saying

133
00:05:59,480 --> 00:06:06,740
how<font color="#E5E5E5"> nothing was wrong they were beating</font>

134
00:06:01,760 --> 00:06:11,420
the pants out of the US and that<font color="#E5E5E5"> just</font>

135
00:06:06,740 --> 00:06:12,800
wasn't happening so who's here had

136
00:06:11,420 --> 00:06:15,560
somebody where they look at you<font color="#E5E5E5"> find out</font>

137
00:06:12,800 --> 00:06:17,420
later they've<font color="#CCCCCC"> had some kind of incident</font>

138
00:06:15,560 --> 00:06:19,310
they know something's wrong<font color="#E5E5E5"> they don't</font>

139
00:06:17,420 --> 00:06:22,570
<font color="#CCCCCC">want to tell anybody and so if anybody</font>

140
00:06:19,310 --> 00:06:26,950
asks them this is<font color="#CCCCCC"> what you get from them</font>

141
00:06:22,570 --> 00:06:29,300
one place that I worked actually<font color="#CCCCCC"> we had</font>

142
00:06:26,950 --> 00:06:31,880
we<font color="#E5E5E5"> had a group that had their own server</font>

143
00:06:29,300 --> 00:06:33,680
room off to the side and it was<font color="#E5E5E5"> separate</font>

144
00:06:31,880 --> 00:06:36,350
from all of the rest of IT operations

145
00:06:33,680 --> 00:06:38,870
and systems administration and their job

146
00:06:36,350 --> 00:06:41,990
was<font color="#CCCCCC"> to go out and download data from</font>

147
00:06:38,870 --> 00:06:44,690
various sources and that would then be

148
00:06:41,990 --> 00:06:46,310
processed and uploaded to databases and

149
00:06:44,690 --> 00:06:51,650
they had a large number of systems doing

150
00:06:46,310 --> 00:06:54,470
that and they got infected with some of

151
00:06:51,650 --> 00:06:58,179
the more fun viruses of<font color="#CCCCCC"> the early 2000s</font>

152
00:06:54,470 --> 00:07:01,100
and they said<font color="#CCCCCC"> nothing for two days and</font>

153
00:06:58,180 --> 00:07:02,480
then when<font color="#CCCCCC"> we find out it was when it</font>

154
00:07:01,100 --> 00:07:06,920
<font color="#E5E5E5">finally spread from their environment</font>

155
00:07:02,480 --> 00:07:09,770
into ours and you know when we had 30

156
00:07:06,920 --> 00:07:12,320
systems to deal with we didn't<font color="#CCCCCC"> know</font>

157
00:07:09,770 --> 00:07:14,210
about it when we had 500 systems to deal

158
00:07:12,320 --> 00:07:17,330
with that's when they finally admitted

159
00:07:14,210 --> 00:07:22,280
oh yeah we didn't<font color="#E5E5E5"> want to say anything</font>

160
00:07:17,330 --> 00:07:24,289
about that so be willing to communicate

161
00:07:22,280 --> 00:07:28,460
and let<font color="#CCCCCC"> people know ask questions</font>

162
00:07:24,290 --> 00:07:29,630
because sometimes particularly you<font color="#E5E5E5"> know</font>

163
00:07:28,460 --> 00:07:31,909
during some kind of instance somebody

164
00:07:29,630 --> 00:07:34,100
else may have some information that<font color="#E5E5E5"> that</font>

165
00:07:31,910 --> 00:07:35,510
<font color="#E5E5E5">will help you out you can get in a</font>

166
00:07:34,100 --> 00:07:40,370
second set of hands to go check out

167
00:07:35,510 --> 00:07:44,270
other systems whatever so some things

168
00:07:40,370 --> 00:07:46,660
<font color="#E5E5E5">that you we I guess we do during pen</font>

169
00:07:44,270 --> 00:07:48,799
tests and folks would want to look at

170
00:07:46,660 --> 00:07:52,270
what are they checking for when they get

171
00:07:48,800 --> 00:07:52,270
on<font color="#E5E5E5"> the box okay we've had some alerts</font>

172
00:07:52,300 --> 00:07:57,620
what is it that<font color="#CCCCCC"> I'm even trying to see</font>

173
00:07:55,100 --> 00:07:59,870
and this is something<font color="#CCCCCC"> I talk about to my</font>

174
00:07:57,620 --> 00:08:02,720
cyber Patriot kids a<font color="#E5E5E5"> lot as</font><font color="#CCCCCC"> they're</font>

175
00:07:59,870 --> 00:08:04,370
<font color="#CCCCCC">looking at systems that have been</font>

176
00:08:02,720 --> 00:08:06,260
you know purposely they're looking at

177
00:08:04,370 --> 00:08:08,630
virtual machines that have back doors in

178
00:08:06,260 --> 00:08:09,740
them and malware running and stuff like

179
00:08:08,630 --> 00:08:12,980
that and they're<font color="#CCCCCC"> supposed to try and</font>

180
00:08:09,740 --> 00:08:14,870
<font color="#E5E5E5">figure out where it is I start saying</font>

181
00:08:12,980 --> 00:08:16,250
well<font color="#E5E5E5"> you know what do you normally see</font>

182
00:08:14,870 --> 00:08:21,110
on a windows box what do you normally

183
00:08:16,250 --> 00:08:23,210
see on a<font color="#E5E5E5"> Linux box what looks unusual to</font>

184
00:08:21,110 --> 00:08:25,070
you now<font color="#E5E5E5"> to them that's hard right they</font>

185
00:08:23,210 --> 00:08:27,620
don't they're high school kids or even

186
00:08:25,070 --> 00:08:29,330
<font color="#E5E5E5">middle school kids they</font><font color="#CCCCCC"> don't have lots</font>

187
00:08:27,620 --> 00:08:32,690
of time to do in systems administration

188
00:08:29,330 --> 00:08:36,770
and and seeing what the<font color="#E5E5E5"> systems normally</font>

189
00:08:32,690 --> 00:08:38,599
<font color="#CCCCCC">should be I found that you know is this</font>

190
00:08:36,770 --> 00:08:39,710
Advent you just<font color="#E5E5E5"> kind of get a feel for</font>

191
00:08:38,599 --> 00:08:42,440
what's supposed<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be there</font><font color="#E5E5E5"> and what's</font>

192
00:08:39,710 --> 00:08:43,760
not which is not to say that<font color="#E5E5E5"> I</font>

193
00:08:42,440 --> 00:08:45,800
necessarily spotted everything that

194
00:08:43,760 --> 00:08:47,510
happened but you<font color="#CCCCCC"> know that's that's kind</font>

195
00:08:45,800 --> 00:08:50,270
of things we're looking for any kind of

196
00:08:47,510 --> 00:08:51,230
new changes users the cropping up all of

197
00:08:50,270 --> 00:08:55,819
a sudden you think that would be obvious

198
00:08:51,230 --> 00:09:00,850
but sometimes that that doesn't get

199
00:08:55,820 --> 00:09:05,960
people's attention any<font color="#E5E5E5"> kind of changes</font>

200
00:09:00,850 --> 00:09:08,630
from our normal behavior is it normal

201
00:09:05,960 --> 00:09:11,330
<font color="#CCCCCC">for Jason to log into the server via SSH</font>

202
00:09:08,630 --> 00:09:12,800
yeah he does<font color="#CCCCCC"> that all the time is it</font>

203
00:09:11,330 --> 00:09:16,010
normal<font color="#CCCCCC"> for him to do it at four thirty</font>

204
00:09:12,800 --> 00:09:19,760
in the morning okay<font color="#CCCCCC"> Jason Street will</font>

205
00:09:16,010 --> 00:09:21,080
get up at four thirty I won't if it was

206
00:09:19,760 --> 00:09:24,380
one<font color="#E5E5E5"> or two o'clock</font><font color="#CCCCCC"> in the morning maybe</font>

207
00:09:21,080 --> 00:09:28,790
me but by that time out cold and you

208
00:09:24,380 --> 00:09:30,230
won't see<font color="#CCCCCC"> me til 10 but you know</font>

209
00:09:28,790 --> 00:09:32,240
somebody's logging in at four thirty in

210
00:09:30,230 --> 00:09:34,160
the morning that might be an issue<font color="#E5E5E5"> now</font>

211
00:09:32,240 --> 00:09:35,660
maybe<font color="#E5E5E5"> I got a phone call and I've had to</font>

212
00:09:34,160 --> 00:09:37,430
log in to trouble shoot something and so

213
00:09:35,660 --> 00:09:40,910
that<font color="#E5E5E5"> you ask some questions you find out</font>

214
00:09:37,430 --> 00:09:43,130
<font color="#CCCCCC">okay yeah that</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> that was legit right</font>

215
00:09:40,910 --> 00:09:47,030
but other times we see login activity

216
00:09:43,130 --> 00:09:48,770
that's out of<font color="#E5E5E5"> out</font><font color="#CCCCCC"> of normal hours or</font>

217
00:09:47,030 --> 00:09:51,560
changes<font color="#CCCCCC"> as transfers going on they</font>

218
00:09:48,770 --> 00:09:53,060
shouldn't be<font color="#E5E5E5"> happening you know wait we</font>

219
00:09:51,560 --> 00:09:57,560
don't have this job running at<font color="#CCCCCC"> that</font>

220
00:09:53,060 --> 00:09:59,989
point what's going on any kind<font color="#E5E5E5"> of signs</font>

221
00:09:57,560 --> 00:10:03,709
as someone is or was connected to<font color="#E5E5E5"> that</font>

222
00:09:59,990 --> 00:10:04,760
system you know is it I'm out here

223
00:10:03,710 --> 00:10:07,040
looking at this thing is there anybody

224
00:10:04,760 --> 00:10:09,110
even logged into it in the first place

225
00:10:07,040 --> 00:10:11,870
<font color="#E5E5E5">and you would think that that</font><font color="#CCCCCC"> would be</font>

226
00:10:09,110 --> 00:10:14,600
kind of something I would look for right

227
00:10:11,870 --> 00:10:15,779
away but other folks you know is in our

228
00:10:14,600 --> 00:10:19,050
<font color="#E5E5E5">experience we</font>

229
00:10:15,779 --> 00:10:20,550
vonces and we're spending time hanging

230
00:10:19,050 --> 00:10:23,040
out there having a grand old time

231
00:10:20,550 --> 00:10:25,019
pillage and data and whatnot and we know

232
00:10:23,040 --> 00:10:27,629
the sysadmin is actually<font color="#CCCCCC"> i logged into</font>

233
00:10:25,019 --> 00:10:31,139
the<font color="#CCCCCC"> box looking for some toys that we</font>

234
00:10:27,629 --> 00:10:36,029
had caused and an hour later they log

235
00:10:31,139 --> 00:10:38,220
off and we're still here not not

236
00:10:36,029 --> 00:10:44,459
something that you want to<font color="#E5E5E5"> find out</font>

237
00:10:38,220 --> 00:10:48,720
about<font color="#E5E5E5"> after the fact</font><font color="#CCCCCC"> so unusual network</font>

238
00:10:44,459 --> 00:10:53,489
connections and<font color="#E5E5E5"> I sometimes I'm this</font>

239
00:10:48,720 --> 00:10:54,930
obvious with my cyber Patriot kids what

240
00:10:53,490 --> 00:10:56,100
I'm doing demos with them and trying to

241
00:10:54,930 --> 00:10:58,680
get<font color="#E5E5E5"> them</font><font color="#CCCCCC"> to practice and see some of</font>

242
00:10:56,100 --> 00:11:01,559
this stuff and you know<font color="#E5E5E5"> what looks odd</font>

243
00:10:58,680 --> 00:11:06,599
here well we've got<font color="#E5E5E5"> some connection on</font>

244
00:11:01,559 --> 00:11:12,779
port 44 44 out there and it's running

245
00:11:06,600 --> 00:11:14,279
under process<font color="#E5E5E5"> ID what is that 35 32 well</font>

246
00:11:12,779 --> 00:11:17,699
maybe we should<font color="#CCCCCC"> go look and see what</font>

247
00:11:14,279 --> 00:11:20,250
<font color="#E5E5E5">that</font><font color="#CCCCCC"> is so this is just netstat dash</font><font color="#E5E5E5"> NAA</font>

248
00:11:17,699 --> 00:11:22,349
<font color="#E5E5E5">oh</font><font color="#CCCCCC"> alright get the pig now I'm going to</font>

249
00:11:20,250 --> 00:11:24,839
go look<font color="#CCCCCC"> at</font><font color="#E5E5E5"> ask manager a task list and</font>

250
00:11:22,350 --> 00:11:28,139
see okay what is running<font color="#CCCCCC"> on that that</font>

251
00:11:24,839 --> 00:11:30,600
process ID well kind<font color="#E5E5E5"> of unusual for one</font>

252
00:11:28,139 --> 00:11:32,040
dll 32 to be<font color="#E5E5E5"> logged in to or connected</font>

253
00:11:30,600 --> 00:11:35,970
to some other<font color="#E5E5E5"> system over the network</font>

254
00:11:32,040 --> 00:11:39,089
randomly so that's a problem in this

255
00:11:35,970 --> 00:11:41,009
case you're<font color="#CCCCCC"> just looking at a I've got</font>

256
00:11:39,089 --> 00:11:43,920
meterpreter up on this this windows box

257
00:11:41,009 --> 00:11:45,439
and I'm connected<font color="#CCCCCC"> to it and and this</font><font color="#E5E5E5"> is</font>

258
00:11:43,920 --> 00:11:49,889
what it<font color="#E5E5E5"> looks like from the other side</font>

259
00:11:45,439 --> 00:11:53,480
anything odd like that why is a server

260
00:11:49,889 --> 00:11:56,339
talking to this other server over here I

261
00:11:53,480 --> 00:11:59,009
don't<font color="#E5E5E5"> recall running that service</font>

262
00:11:56,339 --> 00:12:01,939
listening on<font color="#CCCCCC"> the network on you know</font>

263
00:11:59,009 --> 00:12:07,980
port 1337 or something like that

264
00:12:01,939 --> 00:12:10,170
whatever rdp sessions so a while ago we

265
00:12:07,980 --> 00:12:14,610
did a pen test I was actually last

266
00:12:10,170 --> 00:12:18,509
summer where we found this vulnerable

267
00:12:14,610 --> 00:12:20,759
java web app server an tastic we

268
00:12:18,509 --> 00:12:23,639
deployed our war file to it and somebody

269
00:12:20,759 --> 00:12:26,550
had installed tomcat with<font color="#CCCCCC"> the default</font>

270
00:12:23,639 --> 00:12:27,809
installer next next next next next do<font color="#CCCCCC"> I</font>

271
00:12:26,550 --> 00:12:29,160
<font color="#E5E5E5">want to stall it as local system</font>

272
00:12:27,809 --> 00:12:29,550
absolutely because I don't want<font color="#CCCCCC"> to go</font>

273
00:12:29,160 --> 00:12:31,920
get<font color="#E5E5E5"> a</font>

274
00:12:29,550 --> 00:12:34,680
service account NEX NEX NEX next and now

275
00:12:31,920 --> 00:12:36,959
we're system on this this windows box

276
00:12:34,680 --> 00:12:40,560
great we've got full control of that we

277
00:12:36,959 --> 00:12:42,510
created<font color="#E5E5E5"> a user account we decided</font><font color="#CCCCCC"> to be</font>

278
00:12:40,560 --> 00:12:44,518
really subtle we created a user account

279
00:12:42,510 --> 00:12:46,829
from the command line we added it<font color="#E5E5E5"> to the</font>

280
00:12:44,519 --> 00:12:51,260
local administrators group and we only

281
00:12:46,829 --> 00:12:52,829
have permission to our one box here and

282
00:12:51,260 --> 00:12:57,269
yeah we didn't have<font color="#CCCCCC"> any domain</font>

283
00:12:52,829 --> 00:12:59,819
permissions at this point but and we

284
00:12:57,269 --> 00:13:02,810
just logged in via rdp and we're poking

285
00:12:59,820 --> 00:13:05,220
around the box and you know looking at

286
00:13:02,810 --> 00:13:06,779
database connection files so that we

287
00:13:05,220 --> 00:13:10,320
could<font color="#CCCCCC"> potentially get into other systems</font>

288
00:13:06,779 --> 00:13:13,680
and whatnot and one<font color="#E5E5E5"> of the problems we</font>

289
00:13:10,320 --> 00:13:15,360
had is that we didn't we could we there

290
00:13:13,680 --> 00:13:17,359
weren't any credentials cached we<font color="#E5E5E5"> didn't</font>

291
00:13:15,360 --> 00:13:20,850
find<font color="#CCCCCC"> any hashes that were cashed there</font>

292
00:13:17,360 --> 00:13:23,130
nothing<font color="#CCCCCC"> that was going</font><font color="#E5E5E5"> to allow us</font><font color="#CCCCCC"> to</font>

293
00:13:20,850 --> 00:13:25,620
see you need to get out around to the

294
00:13:23,130 --> 00:13:27,480
other systems and so we're<font color="#E5E5E5"> like well hmm</font>

295
00:13:25,620 --> 00:13:30,420
so<font color="#E5E5E5"> we started causing some noise on this</font>

296
00:13:27,480 --> 00:13:31,890
box when<font color="#E5E5E5"> the sysadmin finally logged in</font>

297
00:13:30,420 --> 00:13:34,589
like<font color="#E5E5E5"> I said he SAT there poking around</font>

298
00:13:31,890 --> 00:13:36,600
on the system for<font color="#E5E5E5"> a while investigating</font>

299
00:13:34,589 --> 00:13:38,850
the alerts that we caused and never

300
00:13:36,600 --> 00:13:45,720
noticed<font color="#E5E5E5"> that we were connected via rdp</font>

301
00:13:38,850 --> 00:13:49,350
and here I've got<font color="#E5E5E5"> dr. evil logged in</font><font color="#CCCCCC"> ok</font>

302
00:13:45,720 --> 00:13:52,620
we didn't use dr. evil we used a user

303
00:13:49,350 --> 00:13:56,610
name called secure ideas which is kind

304
00:13:52,620 --> 00:13:58,320
<font color="#E5E5E5">of unusual for this environment but he</font>

305
00:13:56,610 --> 00:14:00,060
never looked he never saw that<font color="#CCCCCC"> we were</font>

306
00:13:58,320 --> 00:14:02,399
there we stayed logged into that machine

307
00:14:00,060 --> 00:14:06,239
for a couple of days<font color="#CCCCCC"> before</font><font color="#E5E5E5"> we</font>

308
00:14:02,399 --> 00:14:08,730
disconnected on her own so some things

309
00:14:06,240 --> 00:14:10,649
<font color="#CCCCCC">to look at here I mean you can always go</font>

310
00:14:08,730 --> 00:14:12,600
in and open up<font color="#E5E5E5"> the MC and say</font><font color="#CCCCCC"> ok you</font>

311
00:14:10,649 --> 00:14:16,170
know go to terminal services and see who

312
00:14:12,600 --> 00:14:18,000
is who's tied up on this box is anybody

313
00:14:16,170 --> 00:14:19,890
connected at all quick easy way to do it

314
00:14:18,000 --> 00:14:21,870
though that's kind of a hassle to open

315
00:14:19,890 --> 00:14:23,850
up that<font color="#E5E5E5"> MC sometimes it takes a</font><font color="#CCCCCC"> while</font>

316
00:14:21,870 --> 00:14:26,880
just open<font color="#CCCCCC"> up the command line cui</font>

317
00:14:23,850 --> 00:14:28,800
recession hit enter and here you go we

318
00:14:26,880 --> 00:14:32,420
see who's logged in at the console in

319
00:14:28,800 --> 00:14:34,829
this case I<font color="#E5E5E5"> am and dr. evil over rdp</font>

320
00:14:32,420 --> 00:14:36,180
this is a sure sign right here that<font color="#E5E5E5"> okay</font>

321
00:14:34,829 --> 00:14:39,479
now we've got a real problem<font color="#CCCCCC"> if we've</font>

322
00:14:36,180 --> 00:14:40,510
done<font color="#CCCCCC"> this right we're again not a domain</font>

323
00:14:39,480 --> 00:14:42,040
admin we're

324
00:14:40,510 --> 00:14:43,450
we've got limited permissions and not

325
00:14:42,040 --> 00:14:46,180
permissions to maybe the local

326
00:14:43,450 --> 00:14:49,320
<font color="#E5E5E5">administrator account or whatever but we</font>

327
00:14:46,180 --> 00:14:51,729
can query this information without

328
00:14:49,320 --> 00:14:53,020
granting that access sideways throughout

329
00:14:51,730 --> 00:14:54,820
the environment you're also going to

330
00:14:53,020 --> 00:14:56,770
want to look and think things like hey

331
00:14:54,820 --> 00:14:58,990
is anybody connected to this thing over

332
00:14:56,770 --> 00:15:00,670
the network got in that BIOS connection

333
00:14:58,990 --> 00:15:03,220
to it or something like that on<font color="#CCCCCC"> that</font>

334
00:15:00,670 --> 00:15:05,829
session real quick see who's talking you

335
00:15:03,220 --> 00:15:08,380
know what open shares or files we have

336
00:15:05,830 --> 00:15:13,510
going<font color="#E5E5E5"> on that may give us some</font>

337
00:15:08,380 --> 00:15:14,920
information as well I debated putting

338
00:15:13,510 --> 00:15:18,640
this one in here because<font color="#E5E5E5"> it's kind of</font>

339
00:15:14,920 --> 00:15:21,189
obvious we're on a Linux box something

340
00:15:18,640 --> 00:15:26,890
unusual is going on it's<font color="#E5E5E5"> kind of normal</font>

341
00:15:21,190 --> 00:15:28,630
to just run who who else is here as well

342
00:15:26,890 --> 00:15:30,850
as the net stats and all that other

343
00:15:28,630 --> 00:15:32,050
stuff that<font color="#CCCCCC"> I showed you that we we</font>

344
00:15:30,850 --> 00:15:37,000
talked about<font color="#CCCCCC"> a little bit</font><font color="#E5E5E5"> alone or</font>

345
00:15:32,050 --> 00:15:39,130
windows box again we hear folks who

346
00:15:37,000 --> 00:15:40,900
never notice that they're poking around

347
00:15:39,130 --> 00:15:42,220
<font color="#E5E5E5">a system or they're</font><font color="#CCCCCC"> not even looking for</font>

348
00:15:40,900 --> 00:15:43,750
<font color="#E5E5E5">things but they've never noticed that</font>

349
00:15:42,220 --> 00:15:46,450
hey somebody else is logged in to this

350
00:15:43,750 --> 00:15:50,290
system and I don't know who Gomer is or

351
00:15:46,450 --> 00:15:51,990
why he's connected to<font color="#E5E5E5"> my box maybe</font>

352
00:15:50,290 --> 00:15:54,880
that's something I want to go<font color="#CCCCCC"> check out</font>

353
00:15:51,990 --> 00:15:57,100
when when we see something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> that you</font>

354
00:15:54,880 --> 00:16:00,960
know all right we've noticed that gomers

355
00:15:57,100 --> 00:16:05,050
here when<font color="#E5E5E5"> did he show up on this case</font>

356
00:16:00,960 --> 00:16:07,150
<font color="#E5E5E5">garma Gomer showed up last night at ten</font>

357
00:16:05,050 --> 00:16:12,370
o'clock because<font color="#CCCCCC"> I was still working</font><font color="#E5E5E5"> on</font>

358
00:16:07,150 --> 00:16:14,170
my presentation at that point<font color="#CCCCCC"> that gives</font>

359
00:16:12,370 --> 00:16:15,520
<font color="#E5E5E5">me</font><font color="#CCCCCC"> some time to start you know time</font>

360
00:16:14,170 --> 00:16:17,979
range right there to start<font color="#CCCCCC"> looking</font>

361
00:16:15,520 --> 00:16:19,540
around and seeing<font color="#CCCCCC"> ok what changed around</font>

362
00:16:17,980 --> 00:16:21,700
that time what other things have

363
00:16:19,540 --> 00:16:24,760
occurred here around this time that

364
00:16:21,700 --> 00:16:26,890
might be of<font color="#CCCCCC"> interest to me give me</font><font color="#E5E5E5"> some</font>

365
00:16:24,760 --> 00:16:31,150
idea what this person's maybe looked at

366
00:16:26,890 --> 00:16:36,220
or done or tried<font color="#E5E5E5"> to do something to comb</font>

367
00:16:31,150 --> 00:16:39,040
through logs on start looking<font color="#CCCCCC"> through</font>

368
00:16:36,220 --> 00:16:41,920
our windows logs for specific events now

369
00:16:39,040 --> 00:16:43,689
I<font color="#CCCCCC"> just went ahead I started</font><font color="#E5E5E5"> to hunt</font>

370
00:16:41,920 --> 00:16:46,630
around for all of the event IDs and then

371
00:16:43,690 --> 00:16:48,970
I found<font color="#E5E5E5"> this fantastic age here on on</font>

372
00:16:46,630 --> 00:16:51,670
these ulcers website<font color="#CCCCCC"> Seltzer calm /</font>

373
00:16:48,970 --> 00:16:54,310
incident dash response logged a shrewd

374
00:16:51,670 --> 00:16:56,620
ash checklist

375
00:16:54,310 --> 00:16:58,239
and I went<font color="#E5E5E5"> we'll shoot why am I going to</font>

376
00:16:56,620 --> 00:17:00,190
copy it out of there and put it into my

377
00:16:58,240 --> 00:17:02,500
slides he's already<font color="#E5E5E5"> done all this work</font>

378
00:17:00,190 --> 00:17:04,930
let's<font color="#CCCCCC"> just give</font><font color="#E5E5E5"> him credit for it he's</font>

379
00:17:02,500 --> 00:17:06,280
got a lot<font color="#E5E5E5"> of great stuff on here just a</font>

380
00:17:04,930 --> 00:17:08,500
little checklist and stuff like that to

381
00:17:06,280 --> 00:17:10,359
prompt you to think<font color="#E5E5E5"> of things have I</font>

382
00:17:08,500 --> 00:17:13,329
done<font color="#E5E5E5"> this have I done this oh I didn't</font>

383
00:17:10,359 --> 00:17:14,889
didn't check that in my<font color="#CCCCCC"> case I was</font>

384
00:17:13,329 --> 00:17:16,480
looking at<font color="#CCCCCC"> okay what are the log in log</font>

385
00:17:14,890 --> 00:17:19,390
on to get off events that I'm<font color="#CCCCCC"> looking</font>

386
00:17:16,480 --> 00:17:23,349
<font color="#E5E5E5">for wrong windows box so we've got you</font>

387
00:17:19,390 --> 00:17:30,840
know event<font color="#E5E5E5"> IDs 528 544 successful logins</font>

388
00:17:23,349 --> 00:17:35,139
failed logins 529 through 537 5 39 38

389
00:17:30,840 --> 00:17:37,540
<font color="#CCCCCC">55-51 etc for log off any kind</font><font color="#E5E5E5"> of</font>

390
00:17:35,140 --> 00:17:39,400
changes<font color="#CCCCCC"> to a user ID these are</font><font color="#E5E5E5"> all</font>

391
00:17:37,540 --> 00:17:42,399
things we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to want to to take a</font>

392
00:17:39,400 --> 00:17:44,170
look at when did it get here did they

393
00:17:42,400 --> 00:17:45,700
change somebody else's permission so

394
00:17:44,170 --> 00:17:47,940
they<font color="#CCCCCC"> changed the password</font><font color="#E5E5E5"> on this box</font>

395
00:17:45,700 --> 00:17:51,700
that we put it into<font color="#CCCCCC"> a different group</font>

396
00:17:47,940 --> 00:17:56,350
elevated<font color="#CCCCCC"> are our access rights to the</font>

397
00:17:51,700 --> 00:17:59,140
system by being<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to do that services</font>

398
00:17:56,350 --> 00:18:03,730
being stopped or started could be<font color="#E5E5E5"> really</font>

399
00:17:59,140 --> 00:18:05,980
important so for<font color="#E5E5E5"> example I'll get on a</font>

400
00:18:03,730 --> 00:18:07,750
system<font color="#E5E5E5"> and I'm looking around and I'm</font>

401
00:18:05,980 --> 00:18:11,410
wanting to<font color="#E5E5E5"> upload some tools to this</font>

402
00:18:07,750 --> 00:18:13,120
thing see what I can do and Oh doggone

403
00:18:11,410 --> 00:18:14,590
it they've got some antivirus and I

404
00:18:13,120 --> 00:18:17,189
haven't<font color="#E5E5E5"> done</font><font color="#CCCCCC"> anything</font><font color="#E5E5E5"> to obscure this</font>

405
00:18:14,590 --> 00:18:20,439
particular app and it's getting<font color="#E5E5E5"> hot oh</font>

406
00:18:17,190 --> 00:18:25,270
wait i'm running a system net stop

407
00:18:20,440 --> 00:18:27,580
<font color="#CCCCCC">symantec fabulous now i have no AV I can</font>

408
00:18:25,270 --> 00:18:31,300
do what I want just the fact that

409
00:18:27,580 --> 00:18:33,939
service went down ought to you know

410
00:18:31,300 --> 00:18:35,290
raise some screaming red flags to

411
00:18:33,940 --> 00:18:38,170
everybody that somebody the other

412
00:18:35,290 --> 00:18:39,460
shenanigans going on here so we want<font color="#E5E5E5"> to</font>

413
00:18:38,170 --> 00:18:41,950
keep<font color="#E5E5E5"> an eye out</font><font color="#CCCCCC"> for these type of events</font>

414
00:18:39,460 --> 00:18:43,420
go through these logs and see you know

415
00:18:41,950 --> 00:18:46,120
which of these events show up script it

416
00:18:43,420 --> 00:18:47,770
out have<font color="#E5E5E5"> some scripts written out one of</font>

417
00:18:46,120 --> 00:18:50,199
<font color="#E5E5E5">the things that we use internally to</font>

418
00:18:47,770 --> 00:18:51,429
secure ideas as we write scripts and we

419
00:18:50,200 --> 00:18:53,290
find that they're useful<font color="#CCCCCC"> Viet for</font>

420
00:18:51,429 --> 00:18:55,960
systems administration for internal

421
00:18:53,290 --> 00:18:58,659
boxes or 10 tests whatever we check them

422
00:18:55,960 --> 00:19:00,580
into subversion repository you know I

423
00:18:58,660 --> 00:19:02,950
write up a useful little<font color="#E5E5E5"> Python script</font>

424
00:19:00,580 --> 00:19:04,840
<font color="#E5E5E5">or something rather it goes into source</font>

425
00:19:02,950 --> 00:19:06,130
control makes it nice and easy because

426
00:19:04,840 --> 00:19:07,500
everybody knows here's where you go<font color="#E5E5E5"> to</font>

427
00:19:06,130 --> 00:19:09,780
look<font color="#E5E5E5"> for this stuff</font>

428
00:19:07,500 --> 00:19:12,390
so if i want<font color="#E5E5E5"> to see if you know where</font>

429
00:19:09,780 --> 00:19:14,910
did I put that script at that's where it

430
00:19:12,390 --> 00:19:19,070
is and all the different various

431
00:19:14,910 --> 00:19:21,600
different versions of it linux systems

432
00:19:19,070 --> 00:19:24,570
you know logs are we're not looking to

433
00:19:21,600 --> 00:19:26,070
event IDs necessarily but if we're

434
00:19:24,570 --> 00:19:28,110
looking<font color="#CCCCCC"> for things going on with users</font>

435
00:19:26,070 --> 00:19:30,870
and authentication that changes to users

436
00:19:28,110 --> 00:19:33,689
off log as our friend<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I just</font><font color="#E5E5E5"> did a</font>

437
00:19:30,870 --> 00:19:37,439
couple of simple little searches through

438
00:19:33,690 --> 00:19:40,230
here we're okay when did somebody<font color="#E5E5E5"> login</font>

439
00:19:37,440 --> 00:19:44,400
via<font color="#E5E5E5"> SSH so I'm just going to search off</font>

440
00:19:40,230 --> 00:19:45,870
log for sshd see what shows up you can

441
00:19:44,400 --> 00:19:48,810
do that<font color="#E5E5E5"> for the console now in this case</font>

442
00:19:45,870 --> 00:19:52,169
I<font color="#E5E5E5"> searched</font><font color="#CCCCCC"> for gdm it was a</font><font color="#E5E5E5"> normal</font>

443
00:19:48,810 --> 00:19:54,570
system you pick<font color="#E5E5E5"> your windows manager at</font>

444
00:19:52,170 --> 00:19:56,460
that point but that's<font color="#E5E5E5"> actually on the</font>

445
00:19:54,570 --> 00:19:57,330
box<font color="#E5E5E5"> but search around through that you</font>

446
00:19:56,460 --> 00:19:59,460
might need to<font color="#E5E5E5"> do some additional</font>

447
00:19:57,330 --> 00:20:02,370
filtering like in this case<font color="#E5E5E5"> I tossed in</font>

448
00:19:59,460 --> 00:20:06,480
looking<font color="#CCCCCC"> for sessions specifically to cut</font>

449
00:20:02,370 --> 00:20:08,189
out some noise and then look for any

450
00:20:06,480 --> 00:20:12,270
activity where somebody's s Ewing or

451
00:20:08,190 --> 00:20:13,710
he's<font color="#CCCCCC"> in pseudo this morning actually</font>

452
00:20:12,270 --> 00:20:14,940
noticed i messed up<font color="#E5E5E5"> on this one a little</font>

453
00:20:13,710 --> 00:20:16,980
bit cuz that command is kind of

454
00:20:14,940 --> 00:20:20,610
redundant because<font color="#E5E5E5"> i'm looking for</font><font color="#CCCCCC"> sudu</font>

455
00:20:16,980 --> 00:20:22,830
or su and su<font color="#E5E5E5"> will just find it however</font>

456
00:20:20,610 --> 00:20:25,649
initially I had a space after that s you

457
00:20:22,830 --> 00:20:27,720
to look for just su events which is why

458
00:20:25,650 --> 00:20:29,330
<font color="#E5E5E5">I had it</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> there but this is mike said</font>

459
00:20:27,720 --> 00:20:34,110
today<font color="#E5E5E5"> i was looking at</font><font color="#CCCCCC"> it was like oh</font>

460
00:20:29,330 --> 00:20:35,760
oops whatever but<font color="#E5E5E5"> here's some examples</font>

461
00:20:34,110 --> 00:20:37,320
<font color="#E5E5E5">of the data that we get out of this and</font>

462
00:20:35,760 --> 00:20:40,410
when you may get some stuff that<font color="#E5E5E5"> okay i</font>

463
00:20:37,320 --> 00:20:41,820
need to ignore invalid user support in

464
00:20:40,410 --> 00:20:46,650
this particular case but<font color="#CCCCCC"> i certainly</font>

465
00:20:41,820 --> 00:20:52,879
want<font color="#E5E5E5"> to see things like you</font><font color="#CCCCCC"> know me s</font>

466
00:20:46,650 --> 00:20:52,880
Ewing a couple of<font color="#E5E5E5"> times here on this box</font>

467
00:20:54,170 --> 00:20:59,610
take some more looking at off log you

468
00:20:58,230 --> 00:21:02,160
get a message<font color="#E5E5E5"> saying that there's a new</font>

469
00:20:59,610 --> 00:21:03,570
user so that's something nice and

470
00:21:02,160 --> 00:21:06,420
generic<font color="#E5E5E5"> I don't really know what I'm</font>

471
00:21:03,570 --> 00:21:07,770
looking<font color="#E5E5E5"> for I just want</font><font color="#CCCCCC"> to see you know</font>

472
00:21:06,420 --> 00:21:09,840
something got logged about a new years

473
00:21:07,770 --> 00:21:12,690
are being created so you<font color="#E5E5E5"> grab her new</font>

474
00:21:09,840 --> 00:21:15,419
user oh we've got a user named Gomer has

475
00:21:12,690 --> 00:21:17,130
showed up<font color="#E5E5E5"> at this point</font><font color="#CCCCCC"> alright well now</font>

476
00:21:15,420 --> 00:21:18,960
<font color="#E5E5E5">I have something else</font><font color="#CCCCCC"> to search for</font>

477
00:21:17,130 --> 00:21:20,789
let's see what else Gomer is done

478
00:21:18,960 --> 00:21:23,250
and now I actually start getting a

479
00:21:20,789 --> 00:21:27,179
history of what's gone on we see the

480
00:21:23,250 --> 00:21:30,360
account being created with CM login via

481
00:21:27,179 --> 00:21:33,990
<font color="#E5E5E5">SSH and i added</font><font color="#CCCCCC"> gomer to the pseudo</font>

482
00:21:30,360 --> 00:21:37,908
group which on a<font color="#E5E5E5"> Naboo to system gives</font>

483
00:21:33,990 --> 00:21:40,409
us the ability to run sudo as<font color="#CCCCCC"> root so</font>

484
00:21:37,909 --> 00:21:47,220
but<font color="#E5E5E5"> I've got a nice little timeline here</font>

485
00:21:40,409 --> 00:21:48,240
on some things<font color="#CCCCCC"> that have gone on one</font><font color="#E5E5E5"> of</font>

486
00:21:47,220 --> 00:21:50,549
the things we talked about with our

487
00:21:48,240 --> 00:21:52,440
clients an awful lot<font color="#E5E5E5"> okay you did this</font>

488
00:21:50,549 --> 00:21:55,080
stuff how do we<font color="#E5E5E5"> even know</font><font color="#CCCCCC"> that you were</font>

489
00:21:52,440 --> 00:21:58,820
there this this<font color="#CCCCCC"> is actually a little bit</font>

490
00:21:55,080 --> 00:22:01,500
more on<font color="#CCCCCC"> the lead into having an incident</font>

491
00:21:58,820 --> 00:22:03,510
stop and<font color="#E5E5E5"> think about it some of these</font>

492
00:22:01,500 --> 00:22:07,350
sensitive changes we've talked about how

493
00:22:03,510 --> 00:22:08,908
often should they really occur does

494
00:22:07,350 --> 00:22:12,590
somebody show up in the don't get added

495
00:22:08,909 --> 00:22:12,590
to the domain admin group day in day out

496
00:22:12,770 --> 00:22:22,770
they do in your environment oh but

497
00:22:18,590 --> 00:22:24,629
<font color="#E5E5E5">it shouldn't happen very often new users</font>

498
00:22:22,770 --> 00:22:26,158
shouldn't be created except for when

499
00:22:24,630 --> 00:22:28,409
there's a new new employee that's<font color="#E5E5E5"> come</font>

500
00:22:26,159 --> 00:22:31,529
on so<font color="#E5E5E5"> we want to look at that and</font><font color="#CCCCCC"> you</font>

501
00:22:28,409 --> 00:22:33,899
know when did they people get added into

502
00:22:31,529 --> 00:22:36,330
different groups or files the sudoers

503
00:22:33,899 --> 00:22:38,219
file or the pseudo group when should

504
00:22:36,330 --> 00:22:39,750
<font color="#E5E5E5">that happen it shouldn't happen very</font>

505
00:22:38,220 --> 00:22:41,429
often and we should be watching<font color="#E5E5E5"> for that</font>

506
00:22:39,750 --> 00:22:44,340
we<font color="#CCCCCC"> should be monitoring and looking for</font>

507
00:22:41,429 --> 00:22:46,710
that so that again as soon as this

508
00:22:44,340 --> 00:22:48,000
happens something should scream and I

509
00:22:46,710 --> 00:22:49,860
may be able<font color="#E5E5E5"> to see I</font><font color="#CCCCCC"> just did that</font>

510
00:22:48,000 --> 00:22:54,720
<font color="#E5E5E5">that's fine that was a part of an</font>

511
00:22:49,860 --> 00:22:57,719
authorized change or not this<font color="#CCCCCC"> is</font>

512
00:22:54,720 --> 00:22:59,010
something<font color="#CCCCCC"> that as a sysadmin</font><font color="#E5E5E5"> I knew was</font>

513
00:22:57,720 --> 00:23:02,760
there you can add exceptions to

514
00:22:59,010 --> 00:23:04,919
antivirus this is really<font color="#E5E5E5"> cool when you</font>

515
00:23:02,760 --> 00:23:08,340
pop a box and you want to upload<font color="#E5E5E5"> your</font>

516
00:23:04,919 --> 00:23:09,450
tools just add an exception<font color="#CCCCCC"> to AV see</font>

517
00:23:08,340 --> 00:23:11,879
you're<font color="#E5E5E5"> going to want to look for that</font>

518
00:23:09,450 --> 00:23:13,830
any sign of an exception showing up

519
00:23:11,880 --> 00:23:15,840
where it ought to be it's even<font color="#E5E5E5"> better</font>

520
00:23:13,830 --> 00:23:17,730
when you pop the system and they've

521
00:23:15,840 --> 00:23:21,240
already added the exceptions for you to

522
00:23:17,730 --> 00:23:24,029
see cohen temp so<font color="#CCCCCC"> i don't even have to</font>

523
00:23:21,240 --> 00:23:25,440
do anything<font color="#CCCCCC"> i just copy my stuff in all</font>

524
00:23:24,029 --> 00:23:27,299
<font color="#CCCCCC">right we talked about services going</font>

525
00:23:25,440 --> 00:23:29,159
down but we do want<font color="#E5E5E5"> to know hey who did</font>

526
00:23:27,299 --> 00:23:30,350
that why did it happen was<font color="#E5E5E5"> it grace</font>

527
00:23:29,159 --> 00:23:34,789
<font color="#E5E5E5">floor did it crash</font>

528
00:23:30,350 --> 00:23:37,879
or what went on around that all right

529
00:23:34,789 --> 00:23:39,740
here's the<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> with some</font><font color="#E5E5E5"> of these you</font>

530
00:23:37,880 --> 00:23:41,299
know the idea some of these mistakes

531
00:23:39,740 --> 00:23:43,570
that we can make there's not<font color="#E5E5E5"> many</font>

532
00:23:41,299 --> 00:23:45,830
there's<font color="#E5E5E5"> not much room for a do-over</font>

533
00:23:43,570 --> 00:23:48,289
right we're<font color="#E5E5E5"> not going to hop</font><font color="#CCCCCC"> in our time</font>

534
00:23:45,830 --> 00:23:51,110
machining and stop ourselves from going

535
00:23:48,289 --> 00:23:54,559
being stupid so we do<font color="#E5E5E5"> need to do some</font>

536
00:23:51,110 --> 00:23:58,939
preparation it's it's much too late when

537
00:23:54,559 --> 00:24:00,710
we're already bleeding so some<font color="#CCCCCC"> things</font>

538
00:23:58,940 --> 00:24:02,990
<font color="#E5E5E5">too keen to think of you know have your</font>

539
00:24:00,710 --> 00:24:04,940
tools ready that's subversion or power

540
00:24:02,990 --> 00:24:07,100
get or whatever your repository of

541
00:24:04,940 --> 00:24:08,809
choice is have somewhere where your

542
00:24:07,100 --> 00:24:11,678
tools or hanging out at<font color="#E5E5E5"> have it deployed</font>

543
00:24:08,809 --> 00:24:14,840
to DVDs or USB<font color="#CCCCCC"> Drive so</font><font color="#E5E5E5"> you can use them</font>

544
00:24:11,679 --> 00:24:16,549
without installing them onto<font color="#CCCCCC"> the target</font>

545
00:24:14,840 --> 00:24:21,889
system we can just run them from right

546
00:24:16,549 --> 00:24:23,690
there have some resources<font color="#E5E5E5"> on hand one of</font>

547
00:24:21,890 --> 00:24:26,030
the things i ran across recently as the

548
00:24:23,690 --> 00:24:29,120
blue team handbook windows and linux

549
00:24:26,030 --> 00:24:31,940
it's<font color="#E5E5E5"> not in depth it's not a big thick</font>

550
00:24:29,120 --> 00:24:32,899
thomann on incident response or anything

551
00:24:31,940 --> 00:24:34,669
like that but it has a<font color="#E5E5E5"> lot of references</font>

552
00:24:32,900 --> 00:24:37,280
to commands and how to do things and

553
00:24:34,669 --> 00:24:40,820
stuff like that I and so I<font color="#CCCCCC"> recommend</font>

554
00:24:37,280 --> 00:24:43,760
that<font color="#E5E5E5"> to folks one thing to keep your</font>

555
00:24:40,820 --> 00:24:45,408
mind<font color="#CCCCCC"> on or keep in mind as well is you</font>

556
00:24:43,760 --> 00:24:47,330
don't want to necessarily tip your hand

557
00:24:45,409 --> 00:24:50,750
too soon there's a fine line here where

558
00:24:47,330 --> 00:24:52,129
we go through and we're gathering

559
00:24:50,750 --> 00:24:53,450
information<font color="#E5E5E5"> in what we were going to hit</font>

560
00:24:52,130 --> 00:24:55,730
a point we're going<font color="#E5E5E5"> to start and</font>

561
00:24:53,450 --> 00:24:57,559
blocking these people into an area and

562
00:24:55,730 --> 00:24:59,330
kicking them out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> our systems if we</font>

563
00:24:57,559 --> 00:25:01,428
tip our hand and do it too quickly when

564
00:24:59,330 --> 00:25:02,689
we're not really ready and we don't know

565
00:25:01,429 --> 00:25:04,309
what they've really done around the

566
00:25:02,690 --> 00:25:06,140
environment we let<font color="#E5E5E5"> them know that we</font>

567
00:25:04,309 --> 00:25:08,178
know that they're there and<font color="#E5E5E5"> then all of</font>

568
00:25:06,140 --> 00:25:11,330
a sudden<font color="#CCCCCC"> you have potential where they</font>

569
00:25:08,179 --> 00:25:12,950
can start to be destructive and that's

570
00:25:11,330 --> 00:25:17,299
<font color="#E5E5E5">not something we don't we want to have</font>

571
00:25:12,950 --> 00:25:20,480
<font color="#CCCCCC">happen and</font><font color="#E5E5E5"> always be ready to call for</font>

572
00:25:17,299 --> 00:25:22,610
help there's you know all of us usually

573
00:25:20,480 --> 00:25:26,870
are working on teams we've got somebody

574
00:25:22,610 --> 00:25:28,549
to reach out to we know folks who have

575
00:25:26,870 --> 00:25:31,030
have<font color="#CCCCCC"> more experience than us I mean I've</font>

576
00:25:28,549 --> 00:25:33,139
got a lot of great experience I<font color="#CCCCCC"> think</font>

577
00:25:31,030 --> 00:25:36,230
but when I run into things that<font color="#E5E5E5"> I'm not</font>

578
00:25:33,140 --> 00:25:39,409
<font color="#E5E5E5">sure of</font><font color="#CCCCCC"> or whatever I'll contact danny</font>

579
00:25:36,230 --> 00:25:41,000
and say hey you done this recently what

580
00:25:39,409 --> 00:25:43,340
do you<font color="#E5E5E5"> think how should i go about this</font>

581
00:25:41,000 --> 00:25:44,169
and not unusual for him to point out

582
00:25:43,340 --> 00:25:45,820
something that

583
00:25:44,169 --> 00:25:49,749
that would have<font color="#E5E5E5"> been a mistake on my</font>

584
00:25:45,820 --> 00:25:51,428
part so you want to keep<font color="#CCCCCC"> that</font><font color="#E5E5E5"> in the</font>

585
00:25:49,749 --> 00:25:54,879
<font color="#E5E5E5">forefront your mind don't let our ego</font>

586
00:25:51,429 --> 00:25:58,289
get too far ahead of us is we're trying

587
00:25:54,879 --> 00:26:01,330
<font color="#CCCCCC">to i got this i'm</font><font color="#E5E5E5"> going to show this guy</font>

588
00:25:58,289 --> 00:26:06,190
nothing wrong with talking a little bit

589
00:26:01,330 --> 00:26:07,840
with the folks around us<font color="#E5E5E5"> so these are</font>

590
00:26:06,190 --> 00:26:10,509
just some things like<font color="#CCCCCC"> i said found this</font>

591
00:26:07,840 --> 00:26:13,090
is part of doing penetration test where

592
00:26:10,509 --> 00:26:14,739
we<font color="#E5E5E5"> found that will do things like the AV</font>

593
00:26:13,090 --> 00:26:17,080
exceptions and uploading tools or

594
00:26:14,739 --> 00:26:20,109
causing alerts to happen to get them to

595
00:26:17,080 --> 00:26:22,149
<font color="#E5E5E5">login with elevated privileges things</font>

596
00:26:20,109 --> 00:26:23,949
that they<font color="#E5E5E5"> don't do when they're actually</font>

597
00:26:22,149 --> 00:26:26,189
trying to<font color="#E5E5E5"> find</font><font color="#CCCCCC"> those surprisingly never</font>

598
00:26:23,950 --> 00:26:28,869
noticing that<font color="#E5E5E5"> we're logged in the</font><font color="#CCCCCC"> RDP</font>

599
00:26:26,190 --> 00:26:30,909
this is just some some observations that

600
00:26:28,869 --> 00:26:32,350
I have from from being<font color="#E5E5E5"> the bad guy</font>

601
00:26:30,909 --> 00:26:34,389
inside of<font color="#E5E5E5"> somebody's environment and</font>

602
00:26:32,350 --> 00:26:37,029
seeing where they have no<font color="#E5E5E5"> idea where</font>

603
00:26:34,389 --> 00:26:40,658
they're even though we're fairly loud

604
00:26:37,029 --> 00:26:42,009
and obvious somebody who's really trying

605
00:26:40,659 --> 00:26:47,739
to<font color="#E5E5E5"> hide you know it's going to make it</font>

606
00:26:42,009 --> 00:26:49,690
even<font color="#E5E5E5"> more difficult any questions no</font><font color="#CCCCCC"> I</font>

607
00:26:47,739 --> 00:26:53,340
hope<font color="#E5E5E5"> that was useful in interesting TL</font>

608
00:26:49,690 --> 00:26:53,340
and thanks for coming<font color="#CCCCCC"> out</font>

