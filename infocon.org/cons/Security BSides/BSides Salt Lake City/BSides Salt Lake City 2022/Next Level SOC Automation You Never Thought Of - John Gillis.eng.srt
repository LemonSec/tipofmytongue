1
00:00:00,420 --> 00:00:02,040
started

2
00:00:02,040 --> 00:00:04,319
um you guys today we're going to talk

3
00:00:04,319 --> 00:00:07,859
about next level sock automation that

4
00:00:07,859 --> 00:00:11,780
you never thought of

5
00:00:11,880 --> 00:00:15,719
who am I I am John Gillis I am a cyber

6
00:00:15,719 --> 00:00:18,240
security automation enthusiast

7
00:00:18,240 --> 00:00:20,640
and if you want to follow me on Twitter

8
00:00:20,640 --> 00:00:23,340
or look up my LinkedIn and or ask me

9
00:00:23,340 --> 00:00:25,680
questions there I'm more than happy to

10
00:00:25,680 --> 00:00:27,300
oblige

11
00:00:27,300 --> 00:00:29,160
So today we're just going to go over

12
00:00:29,160 --> 00:00:31,679
three things and it's going to go really

13
00:00:31,679 --> 00:00:33,660
fast and I apologize for that get your

14
00:00:33,660 --> 00:00:34,800
cameras out if you see something you

15
00:00:34,800 --> 00:00:37,260
want to take a picture of go for it but

16
00:00:37,260 --> 00:00:38,100
first we're going to be learning about

17
00:00:38,100 --> 00:00:40,260
Chrome extensions what are they we're

18
00:00:40,260 --> 00:00:42,540
going to be learning about two different

19
00:00:42,540 --> 00:00:45,660
features that we can Implement in the

20
00:00:45,660 --> 00:00:47,879
Chrome extension that we create

21
00:00:47,879 --> 00:00:52,500
uh to better Aid our sock operations

22
00:00:52,500 --> 00:00:55,379
so let's go ahead and get started with

23
00:00:55,379 --> 00:00:57,960
um this first part which is a repository

24
00:00:57,960 --> 00:01:00,300
that I created it's basically a Chrome

25
00:01:00,300 --> 00:01:03,420
extension template that you can use now

26
00:01:03,420 --> 00:01:05,640
to start playing around with different

27
00:01:05,640 --> 00:01:08,700
automations that you want to use but it

28
00:01:08,700 --> 00:01:10,979
basically is just a good way to get

29
00:01:10,979 --> 00:01:12,380
started

30
00:01:12,380 --> 00:01:14,520
and a lot of things we're going to be

31
00:01:14,520 --> 00:01:16,020
going over the code that's in this

32
00:01:16,020 --> 00:01:18,299
repository so go ahead and feel free to

33
00:01:18,299 --> 00:01:20,159
pull it out during the during the

34
00:01:20,159 --> 00:01:20,840
presentation

35
00:01:20,840 --> 00:01:23,220
[Music]

36
00:01:23,220 --> 00:01:25,560
all right Chrome extensions what are

37
00:01:25,560 --> 00:01:26,360
they

38
00:01:26,360 --> 00:01:29,340
basically they are little programs that

39
00:01:29,340 --> 00:01:32,400
sit on your Chrome browser that interact

40
00:01:32,400 --> 00:01:34,500
with the web browser

41
00:01:34,500 --> 00:01:37,860
and because you can automate what the

42
00:01:37,860 --> 00:01:40,079
Chrome extension does or program what it

43
00:01:40,079 --> 00:01:42,960
does that opens a huge door for us to

44
00:01:42,960 --> 00:01:45,180
start doing a lot of cool things to make

45
00:01:45,180 --> 00:01:47,340
our lives a lot easier

46
00:01:47,340 --> 00:01:49,320
because I think the majority of us would

47
00:01:49,320 --> 00:01:51,119
agree that our touch point with the

48
00:01:51,119 --> 00:01:53,520
Internet is through an internet browser

49
00:01:53,520 --> 00:01:55,140
and a lot of us use Chrome browser we're

50
00:01:55,140 --> 00:01:56,280
not going to be talking about Firefox

51
00:01:56,280 --> 00:01:59,220
today unfortunately

52
00:01:59,220 --> 00:02:04,020
so what are the ingredients of a Chrome

53
00:02:04,020 --> 00:02:06,000
extension what does a Chrome extension

54
00:02:06,000 --> 00:02:08,038
have to contain

55
00:02:08,038 --> 00:02:10,919
first thing you're going to need is a

56
00:02:10,919 --> 00:02:13,379
manifest Json file

57
00:02:13,379 --> 00:02:15,599
the man of n we'll go into more detail

58
00:02:15,599 --> 00:02:17,280
in just a little bit you're going to

59
00:02:17,280 --> 00:02:18,959
need content script and a background

60
00:02:18,959 --> 00:02:20,040
script

61
00:02:20,040 --> 00:02:22,140
my examples that I'm writing here today

62
00:02:22,140 --> 00:02:24,720
are in vanilla JavaScript

63
00:02:24,720 --> 00:02:27,300
if you prefer to use typescript it's

64
00:02:27,300 --> 00:02:29,700
totally okay there's a link right there

65
00:02:29,700 --> 00:02:31,980
for more information on how to use

66
00:02:31,980 --> 00:02:34,140
typescript to program a Chrome extension

67
00:02:34,140 --> 00:02:37,339
instead of vanilla JavaScript

68
00:02:38,300 --> 00:02:42,180
so what is the Manifest Json

69
00:02:42,180 --> 00:02:45,239
the Manifest Json file is basically your

70
00:02:45,239 --> 00:02:47,819
complete configuration file for your

71
00:02:47,819 --> 00:02:49,500
Chrome extension here we're going to

72
00:02:49,500 --> 00:02:51,180
declare things like the name the

73
00:02:51,180 --> 00:02:53,280
description what version of manifest

74
00:02:53,280 --> 00:02:55,200
you're going to be using and permissions

75
00:02:55,200 --> 00:02:58,080
so basically this sets the intent of

76
00:02:58,080 --> 00:03:00,300
your Chrome extension this is a really

77
00:03:00,300 --> 00:03:02,280
useful file to look at if you're even

78
00:03:02,280 --> 00:03:03,540
trying to figure out if a Chrome

79
00:03:03,540 --> 00:03:05,580
extension or a browser extension in

80
00:03:05,580 --> 00:03:07,500
general is malicious because you're

81
00:03:07,500 --> 00:03:09,239
going to see a lot of information about

82
00:03:09,239 --> 00:03:13,459
what it can do just within this file

83
00:03:14,879 --> 00:03:18,120
then we have the background script.js

84
00:03:18,120 --> 00:03:20,400
this is basically what does the heavy

85
00:03:20,400 --> 00:03:22,560
lifting of our Chrome extension

86
00:03:22,560 --> 00:03:24,540
it's going to be able to run in the

87
00:03:24,540 --> 00:03:27,060
context of the browser and will have

88
00:03:27,060 --> 00:03:29,700
access to all of the Chrome apis that

89
00:03:29,700 --> 00:03:34,019
are registered in the Manifest Json

90
00:03:34,019 --> 00:03:35,580
but there's a difference between the

91
00:03:35,580 --> 00:03:38,580
background JS file and

92
00:03:38,580 --> 00:03:41,700
the content script.js file

93
00:03:41,700 --> 00:03:45,120
the content script.js file runs in the

94
00:03:45,120 --> 00:03:48,120
context of the internet website or the

95
00:03:48,120 --> 00:03:50,879
website that you're currently on

96
00:03:50,879 --> 00:03:53,640
and a lot of basically what it does is

97
00:03:53,640 --> 00:03:56,580
it injects a JavaScript file into the

98
00:03:56,580 --> 00:03:58,440
web page so that you can manipulate what

99
00:03:58,440 --> 00:04:00,599
we call the Dom or the document object

100
00:04:00,599 --> 00:04:02,959
model

101
00:04:03,120 --> 00:04:06,180
you might ask what is the Dom a lot of

102
00:04:06,180 --> 00:04:08,580
people ask it I'm not even sure at this

103
00:04:08,580 --> 00:04:11,519
point I just know I use it a ton but if

104
00:04:11,519 --> 00:04:12,599
we were going to describe it it

105
00:04:12,599 --> 00:04:15,840
basically Maps out the HTML page that

106
00:04:15,840 --> 00:04:17,220
you're looking at and makes it so that

107
00:04:17,220 --> 00:04:19,139
we can use JavaScript to interact with

108
00:04:19,139 --> 00:04:20,579
it

109
00:04:20,579 --> 00:04:22,139
if you want to take a look at what the

110
00:04:22,139 --> 00:04:24,479
Dom kind of looks like you can go to any

111
00:04:24,479 --> 00:04:27,600
web page press F12 or right click select

112
00:04:27,600 --> 00:04:30,600
inspect and then go to the elements page

113
00:04:30,600 --> 00:04:34,139
and voila welcome to the Dom or as I

114
00:04:34,139 --> 00:04:37,040
like to call it the jungle

115
00:04:38,340 --> 00:04:41,699
so that's the boring stuff we kind of

116
00:04:41,699 --> 00:04:43,380
know what a Chrome extension is we know

117
00:04:43,380 --> 00:04:45,240
what files it needs in order to run

118
00:04:45,240 --> 00:04:46,259
we're going to be running it with

119
00:04:46,259 --> 00:04:48,720
vanilla JavaScript

120
00:04:48,720 --> 00:04:51,240
so why do I care

121
00:04:51,240 --> 00:04:53,940
well let's do our first feature which is

122
00:04:53,940 --> 00:04:57,060
injecting buttons into a web page

123
00:04:57,060 --> 00:04:58,740
a lot of us may look at a lot of

124
00:04:58,740 --> 00:05:01,020
different python projects off of

125
00:05:01,020 --> 00:05:02,940
pipi.org

126
00:05:02,940 --> 00:05:05,040
and if you're looking at these projects

127
00:05:05,040 --> 00:05:06,780
you might think to yourself well how do

128
00:05:06,780 --> 00:05:08,340
I know if there isn't some really

129
00:05:08,340 --> 00:05:11,280
well-known vulnerability with this pie

130
00:05:11,280 --> 00:05:13,320
project that I'm looking at

131
00:05:13,320 --> 00:05:15,360
and the first thing that we usually

132
00:05:15,360 --> 00:05:17,100
would do there's websites for it but I'm

133
00:05:17,100 --> 00:05:18,840
guessing that we'd usually try to just

134
00:05:18,840 --> 00:05:21,360
Google it you know do the project and

135
00:05:21,360 --> 00:05:23,460
then Google you know vulnerabilities for

136
00:05:23,460 --> 00:05:24,900
this specific thing

137
00:05:24,900 --> 00:05:26,639
the thing is that's a lot of clicks

138
00:05:26,639 --> 00:05:28,440
that's a lot of typing I want to

139
00:05:28,440 --> 00:05:30,479
automate it so it's quick so let's go

140
00:05:30,479 --> 00:05:32,340
ahead and do that

141
00:05:32,340 --> 00:05:33,419
the first thing that we're going to want

142
00:05:33,419 --> 00:05:35,880
to do with our manifest Json file is we

143
00:05:35,880 --> 00:05:39,000
need to declare the tabs permission set

144
00:05:39,000 --> 00:05:41,280
you can read more about that but

145
00:05:41,280 --> 00:05:42,960
basically that's what we need to put in

146
00:05:42,960 --> 00:05:46,020
our manifest Json now our content script

147
00:05:46,020 --> 00:05:48,000
this is where things get front

148
00:05:48,000 --> 00:05:49,680
because this is where we're injecting

149
00:05:49,680 --> 00:05:51,840
the JavaScript into the web page

150
00:05:51,840 --> 00:05:54,180
so let's go ahead and create a function

151
00:05:54,180 --> 00:05:56,520
and we'll call it you know create VT

152
00:05:56,520 --> 00:05:59,400
button where virus or create VT button

153
00:05:59,400 --> 00:06:01,860
right here and

154
00:06:01,860 --> 00:06:03,900
the first thing that we kind of need to

155
00:06:03,900 --> 00:06:05,940
do within this context is we need to

156
00:06:05,940 --> 00:06:08,160
make sure that we are running the

157
00:06:08,160 --> 00:06:09,419
JavaScript

158
00:06:09,419 --> 00:06:11,820
on the correct web page because we don't

159
00:06:11,820 --> 00:06:13,440
want to just run this on every single

160
00:06:13,440 --> 00:06:16,440
web page that we go to that can create

161
00:06:16,440 --> 00:06:18,360
problems and we just generally want to

162
00:06:18,360 --> 00:06:20,639
avoid that so we're going to create a

163
00:06:20,639 --> 00:06:23,280
variable right there called current URL

164
00:06:23,280 --> 00:06:26,180
and that is set equal to

165
00:06:26,180 --> 00:06:28,259
windows.location.href which that Returns

166
00:06:28,259 --> 00:06:30,419
the URL of the page that we're currently

167
00:06:30,419 --> 00:06:32,819
view viewing at that point and then we

168
00:06:32,819 --> 00:06:34,620
just write an if statement and say hey

169
00:06:34,620 --> 00:06:39,120
if our current URL includes Pi pi.org

170
00:06:39,120 --> 00:06:42,300
Project then I want to inject this

171
00:06:42,300 --> 00:06:43,860
button or I want to begin the code to

172
00:06:43,860 --> 00:06:45,180
inject this button

173
00:06:45,180 --> 00:06:47,639
the next line or box that we see below

174
00:06:47,639 --> 00:06:49,740
there is a function that says wait for

175
00:06:49,740 --> 00:06:51,960
help this is a function that I found on

176
00:06:51,960 --> 00:06:54,240
stack Overflow so I'm not going to claim

177
00:06:54,240 --> 00:06:56,220
that I made it or anything but basically

178
00:06:56,220 --> 00:07:00,180
what it does is it waits for a specific

179
00:07:00,180 --> 00:07:03,120
part of the web page to appear before we

180
00:07:03,120 --> 00:07:05,400
start doing our next piece of code so

181
00:07:05,400 --> 00:07:07,020
we're making sure that first we're on

182
00:07:07,020 --> 00:07:09,660
the right web page and then second that

183
00:07:09,660 --> 00:07:11,100
the part of our web page that we're

184
00:07:11,100 --> 00:07:15,080
waiting for appears for us to see

185
00:07:16,680 --> 00:07:20,220
next we want to select the area of the

186
00:07:20,220 --> 00:07:21,960
web page that we want to inject our

187
00:07:21,960 --> 00:07:24,180
button in this case I'm going to call it

188
00:07:24,180 --> 00:07:26,580
like the main menu area I was like it

189
00:07:26,580 --> 00:07:28,259
would be really cool to have a button

190
00:07:28,259 --> 00:07:31,380
that appears in this general area

191
00:07:31,380 --> 00:07:34,560
and so in our code what we do is we

192
00:07:34,560 --> 00:07:37,819
create a variable and say okay

193
00:07:37,819 --> 00:07:40,259
document.queryselector document says Hey

194
00:07:40,259 --> 00:07:42,539
I want the whole entire Dom

195
00:07:42,539 --> 00:07:44,280
and then I want to run this function

196
00:07:44,280 --> 00:07:47,580
called query selector which essentially

197
00:07:47,580 --> 00:07:50,099
says give me an element or give me a

198
00:07:50,099 --> 00:07:52,259
class or a selector so I know what you

199
00:07:52,259 --> 00:07:54,979
want to select specifically

200
00:07:54,979 --> 00:08:00,539
and once we use that now our main menu

201
00:08:00,539 --> 00:08:03,720
variable is that section of the web page

202
00:08:03,720 --> 00:08:05,520
that we're focusing on and that we can

203
00:08:05,520 --> 00:08:07,800
manipulate

204
00:08:07,800 --> 00:08:10,979
next we have to create the button out of

205
00:08:10,979 --> 00:08:12,300
thin air

206
00:08:12,300 --> 00:08:14,360
super hard

207
00:08:14,360 --> 00:08:17,580
document.createelement button done

208
00:08:17,580 --> 00:08:19,500
all right next we need to give that

209
00:08:19,500 --> 00:08:21,419
button attributes

210
00:08:21,419 --> 00:08:23,879
the inner HTML is what we're seeing on

211
00:08:23,879 --> 00:08:24,900
the web page

212
00:08:24,900 --> 00:08:28,560
the ID is basically a part that we can

213
00:08:28,560 --> 00:08:30,539
use to call on it later if we wanted to

214
00:08:30,539 --> 00:08:32,520
do things to that button

215
00:08:32,520 --> 00:08:34,559
and then the style and color pretty

216
00:08:34,559 --> 00:08:36,120
self-explanatory we just turned it black

217
00:08:36,120 --> 00:08:39,979
so it kind of looks nice right there

218
00:08:40,260 --> 00:08:42,719
next we've created the button

219
00:08:42,719 --> 00:08:45,240
now we just need to append it to the

220
00:08:45,240 --> 00:08:47,160
location that we want it

221
00:08:47,160 --> 00:08:49,560
super difficult we call that variable

222
00:08:49,560 --> 00:08:50,820
that we did in the very beginning main

223
00:08:50,820 --> 00:08:55,140
menu dot append button and voila there

224
00:08:55,140 --> 00:08:56,700
it is now we got our check

225
00:08:56,700 --> 00:08:58,860
vulnerabilities button that appears

226
00:08:58,860 --> 00:09:01,500
right there

227
00:09:01,500 --> 00:09:04,620
now the problem is if we try clicking it

228
00:09:04,620 --> 00:09:06,600
it's not going to do anything so we have

229
00:09:06,600 --> 00:09:07,920
to make it do something when it's

230
00:09:07,920 --> 00:09:11,100
clicked the way we do that is we add an

231
00:09:11,100 --> 00:09:14,160
event listener with the click function

232
00:09:14,160 --> 00:09:16,740
and we're going to tell it to run a

233
00:09:16,740 --> 00:09:19,140
function or run a set of actions called

234
00:09:19,140 --> 00:09:21,420
click VT button

235
00:09:21,420 --> 00:09:25,320
and now the next thing we need to do is

236
00:09:25,320 --> 00:09:27,060
we just need to create that function of

237
00:09:27,060 --> 00:09:28,980
what happens when we click the actual

238
00:09:28,980 --> 00:09:31,399
button

239
00:09:31,800 --> 00:09:34,440
so the first thing is we need to go out

240
00:09:34,440 --> 00:09:36,899
and grab the project ID or like the

241
00:09:36,899 --> 00:09:39,360
product the project name and that name

242
00:09:39,360 --> 00:09:41,459
appears in several different places in

243
00:09:41,459 --> 00:09:42,779
the website

244
00:09:42,779 --> 00:09:46,320
but I could see in the URL that they had

245
00:09:46,320 --> 00:09:48,959
the name of the project right there and

246
00:09:48,959 --> 00:09:51,180
the URL is the easiest thing to grab at

247
00:09:51,180 --> 00:09:52,260
this point because I don't need to wait

248
00:09:52,260 --> 00:09:54,300
for anything to appear on the page

249
00:09:54,300 --> 00:09:57,620
so we're going to use that same

250
00:09:57,620 --> 00:10:00,120
window.location.href to grab that URL

251
00:10:00,120 --> 00:10:03,300
but then we add another little thing on

252
00:10:03,300 --> 00:10:06,300
the end and it says dot split

253
00:10:06,300 --> 00:10:09,060
split basically takes a string and then

254
00:10:09,060 --> 00:10:12,779
uses a delimiter to make a list of every

255
00:10:12,779 --> 00:10:15,060
object that it pulls out of that string

256
00:10:15,060 --> 00:10:16,800
based on the delimiter

257
00:10:16,800 --> 00:10:18,420
so to give you guys a visualization

258
00:10:18,420 --> 00:10:21,959
right there we have https pipei.org

259
00:10:21,959 --> 00:10:24,959
project Pi Bart and I use the delimiter

260
00:10:24,959 --> 00:10:27,300
of a forward slash and so what that does

261
00:10:27,300 --> 00:10:29,700
is it cuts it up into all those little

262
00:10:29,700 --> 00:10:33,300
pieces so if I said I wanted the Zero

263
00:10:33,300 --> 00:10:35,339
part or I mean because it's programming

264
00:10:35,339 --> 00:10:37,080
we start with zero it's an array

265
00:10:37,080 --> 00:10:39,480
then I would get https

266
00:10:39,480 --> 00:10:43,019
colon if I said I wanted the item number

267
00:10:43,019 --> 00:10:44,940
one I would get nothing because that

268
00:10:44,940 --> 00:10:46,680
would be in between those two front uh

269
00:10:46,680 --> 00:10:48,540
forward slashes if I said item number

270
00:10:48,540 --> 00:10:51,120
two I'd get pipi.org if I did item

271
00:10:51,120 --> 00:10:52,980
number three I'd get project but we do

272
00:10:52,980 --> 00:10:56,399
item number four which happens to be the

273
00:10:56,399 --> 00:10:58,680
project name

274
00:10:58,680 --> 00:11:02,220
and so now that we have the project name

275
00:11:02,220 --> 00:11:04,560
let's go ahead and craft our Google

276
00:11:04,560 --> 00:11:06,839
search and so we're going to be crafting

277
00:11:06,839 --> 00:11:10,800
basically a direct URL search for Google

278
00:11:10,800 --> 00:11:11,519
um and I'm not going to explain

279
00:11:11,519 --> 00:11:13,440
everything but basically what we can see

280
00:11:13,440 --> 00:11:17,959
there is uh you know https

281
00:11:17,959 --> 00:11:21,180
www.google.com forward slash search and

282
00:11:21,180 --> 00:11:23,279
then there's a question mark and then at

283
00:11:23,279 --> 00:11:25,680
that part I'm basically putting in my

284
00:11:25,680 --> 00:11:27,899
unique search for Google

285
00:11:27,899 --> 00:11:30,480
and I have that part of encode URI right

286
00:11:30,480 --> 00:11:32,820
there so I can write

287
00:11:32,820 --> 00:11:35,700
pretty easily what I want to search and

288
00:11:35,700 --> 00:11:38,279
then that encode URI will encode it for

289
00:11:38,279 --> 00:11:40,800
the URL so when it's sent it will treat

290
00:11:40,800 --> 00:11:44,000
it how it should

291
00:11:45,899 --> 00:11:48,959
so the third part of that this is we've

292
00:11:48,959 --> 00:11:52,260
created this Google search this URL

293
00:11:52,260 --> 00:11:56,040
now if I tried to open up a new tab in

294
00:11:56,040 --> 00:11:58,500
the content.js file

295
00:11:58,500 --> 00:12:01,380
it would yell at me and not work because

296
00:12:01,380 --> 00:12:03,060
of permissions and it's good that we

297
00:12:03,060 --> 00:12:04,380
have these permissions in place because

298
00:12:04,380 --> 00:12:06,899
it protects our web browsers and so what

299
00:12:06,899 --> 00:12:09,240
I need to do is I need to send a message

300
00:12:09,240 --> 00:12:12,060
to my background script that heavy

301
00:12:12,060 --> 00:12:13,920
lifter that we talked about

302
00:12:13,920 --> 00:12:17,160
and so the way that I do that is in that

303
00:12:17,160 --> 00:12:18,660
third line right there where it says

304
00:12:18,660 --> 00:12:21,959
Chrome dot runtime send message

305
00:12:21,959 --> 00:12:24,500
and just to follow it a little bit more

306
00:12:24,500 --> 00:12:27,959
we have the Google search that we just

307
00:12:27,959 --> 00:12:30,480
created and then we when we send that

308
00:12:30,480 --> 00:12:32,519
message you can see Google search

309
00:12:32,519 --> 00:12:34,680
underscore search colon Google search

310
00:12:34,680 --> 00:12:37,019
that second Google search is actually

311
00:12:37,019 --> 00:12:39,779
the URL that we just crafted

312
00:12:39,779 --> 00:12:42,720
and then in my background script you can

313
00:12:42,720 --> 00:12:45,540
see that I add another event listener or

314
00:12:45,540 --> 00:12:47,160
a listener on the other end that's

315
00:12:47,160 --> 00:12:50,279
saying hey when I get a message I want

316
00:12:50,279 --> 00:12:52,680
you to check to see if the message has

317
00:12:52,680 --> 00:12:55,019
anything for Google Search

318
00:12:55,019 --> 00:12:58,500
and if it does I want to open a new tab

319
00:12:58,500 --> 00:13:00,779
and that open tab is another little

320
00:13:00,779 --> 00:13:02,760
function that we created just to quickly

321
00:13:02,760 --> 00:13:04,980
open up a tab through the Google Chrome

322
00:13:04,980 --> 00:13:07,639
apis

323
00:13:08,279 --> 00:13:12,360
but our end product now is this

324
00:13:12,360 --> 00:13:14,700
we can be on this project we can click

325
00:13:14,700 --> 00:13:16,139
it and it will automatically search

326
00:13:16,139 --> 00:13:16,920
Google

327
00:13:16,920 --> 00:13:19,880
for vulnerabilities

328
00:13:22,139 --> 00:13:23,820
That was supposed to go out that way but

329
00:13:23,820 --> 00:13:26,480
it works

330
00:13:26,639 --> 00:13:29,480
and we'll get it again

331
00:13:29,519 --> 00:13:33,120
so that was how to inject a button into

332
00:13:33,120 --> 00:13:35,760
any website and be able to make it do

333
00:13:35,760 --> 00:13:38,279
something with it like open up a tab and

334
00:13:38,279 --> 00:13:40,320
extremely useful

335
00:13:40,320 --> 00:13:43,079
feature number two building a context

336
00:13:43,079 --> 00:13:46,560
menu item so the context menu is that

337
00:13:46,560 --> 00:13:48,120
thing where you're on the browser and

338
00:13:48,120 --> 00:13:49,680
you right click something and it pulls

339
00:13:49,680 --> 00:13:51,380
down a menu

340
00:13:51,380 --> 00:13:54,180
the Manifest Json permissions we need to

341
00:13:54,180 --> 00:13:56,459
set here are the context menus

342
00:13:56,459 --> 00:13:58,440
permission sets

343
00:13:58,440 --> 00:14:00,360
so we need to do three things it's very

344
00:14:00,360 --> 00:14:02,459
similar right we need to craft a URL we

345
00:14:02,459 --> 00:14:04,320
need to make the context button and we

346
00:14:04,320 --> 00:14:06,240
need to trigger it in some way so that

347
00:14:06,240 --> 00:14:08,700
it opens up what page or what page we

348
00:14:08,700 --> 00:14:10,320
want

349
00:14:10,320 --> 00:14:15,360
so first craft that URL now

350
00:14:15,360 --> 00:14:18,120
part of this feature is that we grab

351
00:14:18,120 --> 00:14:20,820
what is selected when the user right

352
00:14:20,820 --> 00:14:23,040
clicks a selection

353
00:14:23,040 --> 00:14:26,160
and so we need to be able to pull that

354
00:14:26,160 --> 00:14:28,380
in and through the Chrome API you can

355
00:14:28,380 --> 00:14:30,720
just give it the selection name right

356
00:14:30,720 --> 00:14:33,180
there and parameters and so that's

357
00:14:33,180 --> 00:14:34,620
basically allowing us to pull in

358
00:14:34,620 --> 00:14:37,620
whatever the user selects right there

359
00:14:37,620 --> 00:14:39,540
and

360
00:14:39,540 --> 00:14:42,540
then we can craft our virus total search

361
00:14:42,540 --> 00:14:45,060
right there which is just virustotal.com

362
00:14:45,060 --> 00:14:46,680
GUI search

363
00:14:46,680 --> 00:14:49,980
plus whatever the person has selected

364
00:14:49,980 --> 00:14:52,560
there's our crafted URL and the next

365
00:14:52,560 --> 00:14:54,779
part is we can just open up a new Chrome

366
00:14:54,779 --> 00:14:56,540
tab so

367
00:14:56,540 --> 00:14:58,740
chrome.tabs.create and we give it the

368
00:14:58,740 --> 00:15:01,320
URL that we just crafted and that index

369
00:15:01,320 --> 00:15:02,399
part

370
00:15:02,399 --> 00:15:04,680
just basically what it does is it

371
00:15:04,680 --> 00:15:07,139
selects the index or the tab that you're

372
00:15:07,139 --> 00:15:09,360
on and then goes one over so that way

373
00:15:09,360 --> 00:15:11,639
we're not creating tabs on another page

374
00:15:11,639 --> 00:15:13,980
or something like that

375
00:15:13,980 --> 00:15:17,279
next we need to make the context button

376
00:15:17,279 --> 00:15:20,240
and we do that by

377
00:15:20,240 --> 00:15:23,339
making sure that we have another

378
00:15:23,339 --> 00:15:26,160
listener on our background script that

379
00:15:26,160 --> 00:15:28,320
is listening for uninstalled or

380
00:15:28,320 --> 00:15:30,060
basically when the Chrome extension gets

381
00:15:30,060 --> 00:15:32,220
installed it automatically registers

382
00:15:32,220 --> 00:15:35,699
this new Chrome extension button

383
00:15:35,699 --> 00:15:39,420
and the ID is what we're going to use to

384
00:15:39,420 --> 00:15:41,820
call back on this the title is what

385
00:15:41,820 --> 00:15:44,040
you'll see in the in the context menu

386
00:15:44,040 --> 00:15:47,639
and then the context is when you see it

387
00:15:47,639 --> 00:15:49,860
so in this case when the user has

388
00:15:49,860 --> 00:15:52,740
something selected this chrome uh this

389
00:15:52,740 --> 00:15:56,480
context menu item will appear

390
00:15:57,600 --> 00:16:01,440
next we need to make a trigger for it so

391
00:16:01,440 --> 00:16:03,899
next we uh we create another listener

392
00:16:03,899 --> 00:16:07,320
and we say hey if the context menus is

393
00:16:07,320 --> 00:16:08,459
clicked

394
00:16:08,459 --> 00:16:10,800
I want you to start doing something

395
00:16:10,800 --> 00:16:13,680
and there we have the the variable of

396
00:16:13,680 --> 00:16:15,540
the selection the info info dot

397
00:16:15,540 --> 00:16:17,639
selection text so that we know what the

398
00:16:17,639 --> 00:16:19,560
user selected and we're pulling that in

399
00:16:19,560 --> 00:16:22,380
and then we use a switch and I'll be

400
00:16:22,380 --> 00:16:24,060
completely honest anytime I have to make

401
00:16:24,060 --> 00:16:26,040
a switch I have to relearn how to make a

402
00:16:26,040 --> 00:16:27,120
switch

403
00:16:27,120 --> 00:16:30,420
so just uh basically what it is a bunch

404
00:16:30,420 --> 00:16:34,860
of else ifs that work a lot better but

405
00:16:34,860 --> 00:16:38,459
we give it a case and in this case

406
00:16:38,459 --> 00:16:40,860
um I say I want to look at the info.m

407
00:16:40,860 --> 00:16:43,860
menu ID and what that is is it's going

408
00:16:43,860 --> 00:16:45,959
to be the ID of the context menu that is

409
00:16:45,959 --> 00:16:48,899
clicked that VT that we saw before and

410
00:16:48,899 --> 00:16:52,199
so I say if it equals VT I want to run

411
00:16:52,199 --> 00:16:54,899
that function that we just created up at

412
00:16:54,899 --> 00:16:57,720
the top which is to craft that URL and

413
00:16:57,720 --> 00:17:00,380
then open it

414
00:17:00,720 --> 00:17:03,360
and now that we have that you can now

415
00:17:03,360 --> 00:17:04,740
select something

416
00:17:04,740 --> 00:17:06,780
go to your virus total button and it

417
00:17:06,780 --> 00:17:09,419
will automatically open virustotal with

418
00:17:09,419 --> 00:17:11,819
that search really useful for domains

419
00:17:11,819 --> 00:17:14,699
hashes all sorts of fun things that we

420
00:17:14,699 --> 00:17:16,919
use for virustotal

421
00:17:16,919 --> 00:17:19,140
and I don't have the the sound I'm sorry

422
00:17:19,140 --> 00:17:20,220
you guys I know you're looking forward

423
00:17:20,220 --> 00:17:22,559
to it but

424
00:17:22,559 --> 00:17:25,319
so direct URLs can do a lot of cool

425
00:17:25,319 --> 00:17:27,359
stuff we used them in two instances with

426
00:17:27,359 --> 00:17:29,780
virustotal and Google

427
00:17:29,780 --> 00:17:32,100
jiric tickets can be created with direct

428
00:17:32,100 --> 00:17:34,860
URLs there's the URL that teaches you

429
00:17:34,860 --> 00:17:36,240
how to do that

430
00:17:36,240 --> 00:17:38,940
so if you like to make jira tickets

431
00:17:38,940 --> 00:17:39,539
um

432
00:17:39,539 --> 00:17:41,400
that's awesome but you can automate it

433
00:17:41,400 --> 00:17:43,679
so it makes it a lot easier you can also

434
00:17:43,679 --> 00:17:45,720
pass parameters into Splunk dashboards

435
00:17:45,720 --> 00:17:49,320
elastic dashboards and search a huge

436
00:17:49,320 --> 00:17:52,760
number amount of websites with it

437
00:17:53,520 --> 00:17:56,940
so what else can we do really the sky is

438
00:17:56,940 --> 00:17:59,160
the limit you literally have a web app

439
00:17:59,160 --> 00:18:01,260
that you can design to your heart's

440
00:18:01,260 --> 00:18:03,059
content but some of the things that

441
00:18:03,059 --> 00:18:05,340
we've done is we've generated email

442
00:18:05,340 --> 00:18:07,620
templates from detection Pages generate

443
00:18:07,620 --> 00:18:10,020
jira tickets from detection Pages pivot

444
00:18:10,020 --> 00:18:12,059
to internal tools you grab information

445
00:18:12,059 --> 00:18:14,280
from one page pull it into another page

446
00:18:14,280 --> 00:18:16,919
it just makes things a lot faster

447
00:18:16,919 --> 00:18:19,500
we've also designed like HTML like

448
00:18:19,500 --> 00:18:21,600
little web pages that show you how many

449
00:18:21,600 --> 00:18:23,820
detections an analyst has or how many

450
00:18:23,820 --> 00:18:27,000
are in the queue currently so your users

451
00:18:27,000 --> 00:18:28,919
can be up to date on that and just have

452
00:18:28,919 --> 00:18:31,140
it in a small tool right there

453
00:18:31,140 --> 00:18:33,480
so where can you get more ideas

454
00:18:33,480 --> 00:18:35,640
the web store is literally full of

455
00:18:35,640 --> 00:18:38,460
thousands of Chrome extensions and you

456
00:18:38,460 --> 00:18:40,740
can check them out and get ideas and

457
00:18:40,740 --> 00:18:42,600
figure out what you want to do or you

458
00:18:42,600 --> 00:18:45,240
can ask chat GPT which seems to be a

459
00:18:45,240 --> 00:18:48,260
thing these days so

460
00:18:48,660 --> 00:18:50,640
so these are benefits that I personally

461
00:18:50,640 --> 00:18:53,220
experienced by implementing a Chrome

462
00:18:53,220 --> 00:18:55,980
extension for your team the first and

463
00:18:55,980 --> 00:18:59,520
foremost is it's saved time

464
00:18:59,520 --> 00:19:01,500
I know when you were watching this you

465
00:19:01,500 --> 00:19:03,360
were probably thinking those were just

466
00:19:03,360 --> 00:19:05,940
clicks just seconds here and there but

467
00:19:05,940 --> 00:19:08,700
you need to understand that clicks are

468
00:19:08,700 --> 00:19:09,919
seconds

469
00:19:09,919 --> 00:19:14,160
become minutes and minutes matter

470
00:19:14,160 --> 00:19:16,020
I stole that from the falcon complete

471
00:19:16,020 --> 00:19:18,720
team if they ever ask about it but

472
00:19:18,720 --> 00:19:21,600
the thing is in our job use it in a sock

473
00:19:21,600 --> 00:19:24,840
those minutes are extremely important

474
00:19:24,840 --> 00:19:27,419
and the more that you can solve or

475
00:19:27,419 --> 00:19:29,520
automate the little things that go into

476
00:19:29,520 --> 00:19:31,559
those minutes the faster that you're

477
00:19:31,559 --> 00:19:34,740
going to be able to respond to important

478
00:19:34,740 --> 00:19:37,160
events

479
00:19:37,260 --> 00:19:39,960
next thing is you can customize the

480
00:19:39,960 --> 00:19:42,419
tools that your team uses every day the

481
00:19:42,419 --> 00:19:44,340
way that you want them

482
00:19:44,340 --> 00:19:47,340
we in a sock usually have a hundred

483
00:19:47,340 --> 00:19:49,679
different tools that we have to use and

484
00:19:49,679 --> 00:19:51,419
you can use a Chrome extension to start

485
00:19:51,419 --> 00:19:53,580
tweaking that tool to the features that

486
00:19:53,580 --> 00:19:55,980
are good for your team again saving you

487
00:19:55,980 --> 00:19:57,240
that time

488
00:19:57,240 --> 00:19:59,220
another huge benefit is knowledge

489
00:19:59,220 --> 00:20:01,200
transfer

490
00:20:01,200 --> 00:20:03,780
socks tend to be pretty Dynamic we have

491
00:20:03,780 --> 00:20:05,400
people coming in and leaving and they're

492
00:20:05,400 --> 00:20:06,480
going to bigger and better things

493
00:20:06,480 --> 00:20:09,299
sometimes and we have to transfer that

494
00:20:09,299 --> 00:20:10,200
knowledge

495
00:20:10,200 --> 00:20:12,240
it's a lot easier to transfer knowledge

496
00:20:12,240 --> 00:20:14,220
by giving them a tool that already has

497
00:20:14,220 --> 00:20:15,600
everything so that they can go through

498
00:20:15,600 --> 00:20:17,700
it and start using it than it is to give

499
00:20:17,700 --> 00:20:19,980
them a list of like a thousand bookmarks

500
00:20:19,980 --> 00:20:22,500
that you use in wikis

501
00:20:22,500 --> 00:20:23,940
and

502
00:20:23,940 --> 00:20:27,000
above all it really comes to helping

503
00:20:27,000 --> 00:20:29,520
analysts follow those processes

504
00:20:29,520 --> 00:20:31,799
and in a sock we have a lot of processes

505
00:20:31,799 --> 00:20:33,299
and procedures that are important we

506
00:20:33,299 --> 00:20:35,160
follow them in a specific way for a

507
00:20:35,160 --> 00:20:37,140
reason and being able to use a Chrome

508
00:20:37,140 --> 00:20:39,299
extension to automate those processes

509
00:20:39,299 --> 00:20:41,100
and help your analysts follow those

510
00:20:41,100 --> 00:20:42,660
processes you're going to have less

511
00:20:42,660 --> 00:20:44,160
problems and you're going to be a more

512
00:20:44,160 --> 00:20:48,440
well oiled and find sock

513
00:20:50,039 --> 00:20:53,039
so thank you and that's it if you guys

514
00:20:53,039 --> 00:20:54,780
uh have any questions

515
00:20:54,780 --> 00:20:56,400
I think we have

516
00:20:56,400 --> 00:20:58,260
time

517
00:20:58,260 --> 00:21:00,179
I know that was really fast and I

518
00:21:00,179 --> 00:21:01,799
apologize for that I only had 25 minutes

519
00:21:01,799 --> 00:21:03,299
so

520
00:21:03,299 --> 00:21:04,620
what would be some reasons to use

521
00:21:04,620 --> 00:21:06,299
typescript instead of JavaScript when

522
00:21:06,299 --> 00:21:07,740
you're building the Chrome extension

523
00:21:07,740 --> 00:21:09,419
yeah that's a great question so

524
00:21:09,419 --> 00:21:10,740
typescript

525
00:21:10,740 --> 00:21:12,720
um is a programming language that

526
00:21:12,720 --> 00:21:15,059
Microsoft developed and it basically

527
00:21:15,059 --> 00:21:18,600
makes your JavaScript way more secure by

528
00:21:18,600 --> 00:21:21,360
specifying type of objects that you're

529
00:21:21,360 --> 00:21:23,820
using and so it's a lot more well

530
00:21:23,820 --> 00:21:27,780
defined and it's harder to create a code

531
00:21:27,780 --> 00:21:31,220
that probably has vulnerabilities

532
00:21:36,780 --> 00:21:39,780
foreign

533
00:21:39,780 --> 00:21:41,880
so the last thing I wanted to say on

534
00:21:41,880 --> 00:21:44,280
this is I know that the code might have

535
00:21:44,280 --> 00:21:46,559
looked a little bit intimidating I come

536
00:21:46,559 --> 00:21:48,059
from a background where I taught myself

537
00:21:48,059 --> 00:21:50,580
how to program and I was not good at it

538
00:21:50,580 --> 00:21:52,440
for a really long time

539
00:21:52,440 --> 00:21:54,960
I promise you that if you just try and

540
00:21:54,960 --> 00:21:57,539
use the Repose the GitHub that I post up

541
00:21:57,539 --> 00:22:00,240
there and just try to make things the

542
00:22:00,240 --> 00:22:01,740
more time that you put into it you will

543
00:22:01,740 --> 00:22:03,600
figure it out it's not impossible and

544
00:22:03,600 --> 00:22:05,640
there's a lot of resources out there and

545
00:22:05,640 --> 00:22:08,460
so don't be don't be scared to try it

546
00:22:08,460 --> 00:22:10,860
because you really can do it and then

547
00:22:10,860 --> 00:22:12,240
once you see the benefits you're going

548
00:22:12,240 --> 00:22:14,840
to get hooked

549
00:22:17,340 --> 00:22:19,080
very humbling

550
00:22:19,080 --> 00:22:21,678
yeah

551
00:22:22,380 --> 00:22:25,500
how easy is this to deploy across like

552
00:22:25,500 --> 00:22:27,679
your

553
00:22:31,860 --> 00:22:34,140
like yeah so I have the instructions

554
00:22:34,140 --> 00:22:36,539
right there on the the GitHub but it's

555
00:22:36,539 --> 00:22:38,100
as easy as you just turn on developer

556
00:22:38,100 --> 00:22:40,440
mode and then cop like drag a folder

557
00:22:40,440 --> 00:22:42,720
into your Chrome browser in in the

558
00:22:42,720 --> 00:22:44,159
extensions page

559
00:22:44,159 --> 00:22:47,299
so fairly easy

560
00:22:57,900 --> 00:23:01,760
all right well thank you guys

561
00:23:03,730 --> 00:23:06,839
[Applause]

