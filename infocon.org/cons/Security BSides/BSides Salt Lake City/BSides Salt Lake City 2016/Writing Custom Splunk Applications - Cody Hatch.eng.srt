1
00:00:18,260 --> 00:00:27,000
that's kind of my passion<font color="#E5E5E5"> in InfoSec</font><font color="#CCCCCC"> I</font>

2
00:00:24,019 --> 00:00:30,150
have<font color="#E5E5E5"> only 30 minutes to cover a lot</font><font color="#CCCCCC"> of</font>

3
00:00:27,000 --> 00:00:33,059
date a lot<font color="#E5E5E5"> of information</font><font color="#CCCCCC"> so I'm gonna</font>

4
00:00:30,150 --> 00:00:36,329
go quick<font color="#E5E5E5"> I'm not gonna go</font><font color="#CCCCCC"> over what</font>

5
00:00:33,059 --> 00:00:38,790
Splunk is<font color="#E5E5E5"> I'm not going to go over the</font>

6
00:00:36,329 --> 00:00:41,040
architecture of<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> I'll figure you</font>

7
00:00:38,790 --> 00:00:43,469
can go to<font color="#CCCCCC"> spunk calm or whatever</font><font color="#E5E5E5"> and</font>

8
00:00:41,040 --> 00:00:45,780
look at<font color="#E5E5E5"> that stuff I'm gonna focus on</font>

9
00:00:43,469 --> 00:00:48,870
applications<font color="#E5E5E5"> writing your own custom</font>

10
00:00:45,780 --> 00:00:53,399
apps<font color="#CCCCCC"> I will at one point touch on where</font>

11
00:00:48,870 --> 00:00:55,399
the apps<font color="#E5E5E5"> reside in the architecture</font><font color="#CCCCCC"> but</font>

12
00:00:53,399 --> 00:00:58,949
<font color="#CCCCCC">I'm not</font><font color="#E5E5E5"> going to go through</font><font color="#CCCCCC"> all that</font>

13
00:00:55,399 --> 00:01:01,050
mainly I<font color="#E5E5E5"> use custom apps to handle the</font>

14
00:00:58,949 --> 00:01:03,599
massive flow of<font color="#E5E5E5"> data</font>

15
00:01:01,050 --> 00:01:06,658
I love<font color="#E5E5E5"> Splunk because you can throw</font><font color="#CCCCCC"> just</font>

16
00:01:03,600 --> 00:01:10,920
<font color="#CCCCCC">anything at it</font><font color="#E5E5E5"> unstructured data</font>

17
00:01:06,659 --> 00:01:13,860
<font color="#CCCCCC">whatever and just drown yourself</font><font color="#E5E5E5"> in data</font>

18
00:01:10,920 --> 00:01:15,630
but I like to be<font color="#CCCCCC"> able to get it</font><font color="#E5E5E5"> you know</font>

19
00:01:13,860 --> 00:01:18,210
under<font color="#E5E5E5"> control and start and start</font>

20
00:01:15,630 --> 00:01:21,270
<font color="#E5E5E5">wrangling with it</font><font color="#CCCCCC"> one of the things I</font>

21
00:01:18,210 --> 00:01:24,000
love about<font color="#E5E5E5"> Splunk is it seems to</font><font color="#CCCCCC"> be</font>

22
00:01:21,270 --> 00:01:27,000
designed<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the way at least my mind</font>

23
00:01:24,000 --> 00:01:29,100
<font color="#E5E5E5">works security teams so to be able to</font>

24
00:01:27,000 --> 00:01:31,890
<font color="#E5E5E5">pull information out</font><font color="#CCCCCC"> I don't know what</font>

25
00:01:29,100 --> 00:01:33,360
<font color="#CCCCCC">it</font><font color="#E5E5E5"> is but it just makes sense from more</font>

26
00:01:31,890 --> 00:01:36,570
<font color="#E5E5E5">of a security</font><font color="#CCCCCC"> standpoint versus like a</font>

27
00:01:33,360 --> 00:01:38,280
business intelligence standpoint<font color="#CCCCCC"> so I'll</font>

28
00:01:36,570 --> 00:01:39,689
cover some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that if you have questions</font>

29
00:01:38,280 --> 00:01:41,759
at any point go ahead<font color="#CCCCCC"> and ask I'll ask</font>

30
00:01:39,689 --> 00:01:44,479
<font color="#E5E5E5">at the</font><font color="#CCCCCC"> end of it if you have</font><font color="#E5E5E5"> questions</font>

31
00:01:41,759 --> 00:01:47,460
but go ahead<font color="#E5E5E5"> and fire away anyway</font><font color="#CCCCCC"> so</font>

32
00:01:44,479 --> 00:01:49,439
<font color="#CCCCCC">first</font><font color="#E5E5E5"> thing I want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk about is very</font>

33
00:01:47,460 --> 00:01:54,149
foundational<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Splunk calls at the</font>

34
00:01:49,439 --> 00:01:56,539
common information model<font color="#CCCCCC"> so what it</font><font color="#E5E5E5"> is</font>

35
00:01:54,149 --> 00:01:59,399
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> from the actual spunk</font>

36
00:01:56,540 --> 00:02:01,290
<font color="#E5E5E5">documentation</font><font color="#CCCCCC"> it's a set of field names</font>

37
00:01:59,399 --> 00:02:03,390
and tags which<font color="#E5E5E5"> are expected</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> define</font>

38
00:02:01,290 --> 00:02:07,560
the least common<font color="#E5E5E5"> denominator of</font><font color="#CCCCCC"> a domain</font>

39
00:02:03,390 --> 00:02:09,568
<font color="#CCCCCC">of interest basically it's it's a</font>

40
00:02:07,560 --> 00:02:14,040
framework that<font color="#CCCCCC"> Splunk has already built</font>

41
00:02:09,568 --> 00:02:16,768
<font color="#CCCCCC">that allows you to</font><font color="#E5E5E5"> pull in disparate</font>

42
00:02:14,040 --> 00:02:19,829
data<font color="#E5E5E5"> from disparate sources</font><font color="#CCCCCC"> and pull it</font>

43
00:02:16,769 --> 00:02:23,190
in together<font color="#E5E5E5"> and distill it into areas</font><font color="#CCCCCC"> of</font>

44
00:02:19,830 --> 00:02:27,540
interest<font color="#CCCCCC"> for you it</font><font color="#E5E5E5"> basically breaks it</font>

45
00:02:23,190 --> 00:02:29,489
out<font color="#E5E5E5"> in two primary components tags</font><font color="#CCCCCC"> a set</font>

46
00:02:27,540 --> 00:02:31,910
of tags and<font color="#E5E5E5"> then a set of extracted</font>

47
00:02:29,489 --> 00:02:36,209
fields that go along<font color="#CCCCCC"> with those tags</font>

48
00:02:31,910 --> 00:02:37,530
<font color="#CCCCCC">it's its own application so</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> download</font>

49
00:02:36,209 --> 00:02:40,530
it it's a free<font color="#E5E5E5"> app that</font><font color="#CCCCCC"> spelunked</font>

50
00:02:37,530 --> 00:02:41,250
produces<font color="#E5E5E5"> you install it and</font><font color="#CCCCCC"> it has all</font>

51
00:02:40,530 --> 00:02:44,420
this<font color="#E5E5E5"> stuff</font>

52
00:02:41,250 --> 00:02:48,680
it is leveraged by a lot<font color="#E5E5E5"> of other apps</font>

53
00:02:44,420 --> 00:02:52,890
<font color="#CCCCCC">likes plunks</font><font color="#E5E5E5"> own enterprise security</font><font color="#CCCCCC"> app</font>

54
00:02:48,680 --> 00:02:56,220
various things<font color="#E5E5E5"> some dashboards they will</font>

55
00:02:52,890 --> 00:02:57,779
<font color="#CCCCCC">leverage this and it provides an awesome</font>

56
00:02:56,220 --> 00:03:00,150
<font color="#CCCCCC">foundation and the best thing about it</font>

57
00:02:57,780 --> 00:03:03,599
<font color="#E5E5E5">is you can extend it</font><font color="#CCCCCC"> so how whatever</font>

58
00:03:00,150 --> 00:03:07,829
<font color="#E5E5E5">your environment needs</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> application</font>

59
00:03:03,599 --> 00:03:11,280
can<font color="#E5E5E5"> be extended very easily so I'm going</font>

60
00:03:07,829 --> 00:03:13,260
<font color="#CCCCCC">to give a couple of examples of how</font><font color="#E5E5E5"> this</font>

61
00:03:11,280 --> 00:03:17,250
<font color="#E5E5E5">works</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> I'm going to use an</font>

62
00:03:13,260 --> 00:03:19,319
authentication<font color="#E5E5E5"> model again this is all</font>

63
00:03:17,250 --> 00:03:21,690
from some<font color="#CCCCCC"> of this is</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> Splunk</font>

64
00:03:19,319 --> 00:03:26,599
documentation and then also how I've

65
00:03:21,690 --> 00:03:29,639
<font color="#CCCCCC">used it so some of</font><font color="#E5E5E5"> the tags use here</font>

66
00:03:26,599 --> 00:03:31,440
<font color="#E5E5E5">authentication default</font><font color="#CCCCCC"> privilege this</font><font color="#E5E5E5"> is</font>

67
00:03:29,639 --> 00:03:37,250
going to be where you send Active

68
00:03:31,440 --> 00:03:40,790
Directory logs<font color="#CCCCCC"> LDAP</font><font color="#E5E5E5"> radius tax whatever</font>

69
00:03:37,250 --> 00:03:44,599
<font color="#E5E5E5">authentication type event you might have</font>

70
00:03:40,790 --> 00:03:47,340
<font color="#E5E5E5">firewall authentication</font><font color="#CCCCCC"> web application</font>

71
00:03:44,599 --> 00:03:49,709
whatever whatever you've got<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

72
00:03:47,340 --> 00:03:53,010
throw in into here that's kind<font color="#E5E5E5"> of the</font>

73
00:03:49,709 --> 00:03:53,519
<font color="#CCCCCC">idea so then you can search with those</font>

74
00:03:53,010 --> 00:03:56,819
tags

75
00:03:53,519 --> 00:03:59,340
<font color="#E5E5E5">once you've distilled all of that for</font>

76
00:03:56,819 --> 00:04:00,319
<font color="#CCCCCC">example the default</font><font color="#E5E5E5"> tag right</font><font color="#CCCCCC"> there that</font>

77
00:03:59,340 --> 00:04:03,000
<font color="#E5E5E5">would be</font><font color="#CCCCCC"> used</font><font color="#E5E5E5"> for like a default</font>

78
00:04:00,319 --> 00:04:06,319
<font color="#E5E5E5">credential administrator credential or</font>

79
00:04:03,000 --> 00:04:10,410
something logging in<font color="#CCCCCC"> privileged user</font>

80
00:04:06,319 --> 00:04:12,358
that's privileged user interesting<font color="#CCCCCC"> those</font>

81
00:04:10,410 --> 00:04:15,989
two can really<font color="#CCCCCC"> be extended by using</font>

82
00:04:12,359 --> 00:04:19,650
input lookups in<font color="#CCCCCC"> Splunk where you can</font>

83
00:04:15,989 --> 00:04:21,840
pull in you can pull in like CSV files

84
00:04:19,649 --> 00:04:23,429
of people who might be privileged<font color="#E5E5E5"> in</font>

85
00:04:21,839 --> 00:04:25,859
your<font color="#E5E5E5"> organization or default account</font>

86
00:04:23,430 --> 00:04:26,840
credentials<font color="#CCCCCC"> default accounts you might</font>

87
00:04:25,860 --> 00:04:30,370
have and

88
00:04:26,840 --> 00:04:32,780
and these can leverage<font color="#E5E5E5"> that so basically</font>

89
00:04:30,370 --> 00:04:35,360
<font color="#E5E5E5">it'll just pull</font><font color="#CCCCCC"> that in</font><font color="#E5E5E5"> and you can do a</font>

90
00:04:32,780 --> 00:04:37,340
search<font color="#E5E5E5"> so clear text obviously if</font>

91
00:04:35,360 --> 00:04:39,020
<font color="#CCCCCC">something's</font><font color="#E5E5E5"> clear text and then some</font>

92
00:04:37,340 --> 00:04:41,719
fields that<font color="#E5E5E5"> are typically used</font><font color="#CCCCCC"> with</font>

93
00:04:39,020 --> 00:04:45,530
authentication<font color="#E5E5E5"> action so is it</font>

94
00:04:41,720 --> 00:04:47,720
successful<font color="#E5E5E5"> or failure</font><font color="#CCCCCC"> source the source</font>

95
00:04:45,530 --> 00:04:50,359
of the authentication<font color="#E5E5E5"> destination where</font>

96
00:04:47,720 --> 00:04:52,990
they authenticated<font color="#E5E5E5"> and the user so down</font>

97
00:04:50,360 --> 00:04:56,810
<font color="#CCCCCC">below I have kind of a an example search</font>

98
00:04:52,990 --> 00:04:58,610
<font color="#E5E5E5">already see that</font><font color="#CCCCCC"> okay hoping so tag</font>

99
00:04:56,810 --> 00:05:02,000
equals authentication<font color="#E5E5E5"> and privileged and</font>

100
00:04:58,610 --> 00:05:05,750
then looking at<font color="#E5E5E5"> the count by user the</font>

101
00:05:02,000 --> 00:05:08,240
action and the source<font color="#E5E5E5"> so a search like</font>

102
00:05:05,750 --> 00:05:10,160
that<font color="#E5E5E5"> if you have</font><font color="#CCCCCC"> all of your app all of</font>

103
00:05:08,240 --> 00:05:11,930
<font color="#CCCCCC">your information</font><font color="#E5E5E5"> feeding it correctly</font>

104
00:05:10,160 --> 00:05:14,240
you should search for<font color="#E5E5E5"> any sort of</font>

105
00:05:11,930 --> 00:05:18,010
privileged authentication<font color="#CCCCCC"> across</font><font color="#E5E5E5"> all of</font>

106
00:05:14,240 --> 00:05:18,010
your authentication events and sources

107
00:05:18,550 --> 00:05:27,680
<font color="#E5E5E5">another example would be IDs</font><font color="#CCCCCC"> so again</font>

108
00:05:23,150 --> 00:05:30,138
this is this data model<font color="#CCCCCC"> is primarily</font>

109
00:05:27,680 --> 00:05:33,530
defined for intrusion<font color="#CCCCCC"> detection events</font>

110
00:05:30,139 --> 00:05:35,740
both<font color="#E5E5E5"> network host application so that</font>

111
00:05:33,530 --> 00:05:38,809
<font color="#CCCCCC">might be a laughs</font><font color="#E5E5E5"> something like</font><font color="#CCCCCC"> that</font>

112
00:05:35,740 --> 00:05:41,810
<font color="#E5E5E5">and then typical fields used for that</font>

113
00:05:38,810 --> 00:05:43,849
are<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be source</font><font color="#E5E5E5"> test write</font>

114
00:05:41,810 --> 00:05:45,229
severity<font color="#E5E5E5"> and the signature that</font><font color="#CCCCCC"> might</font>

115
00:05:43,849 --> 00:05:47,960
have<font color="#E5E5E5"> been</font><font color="#CCCCCC"> triggered as well as ideas</font>

116
00:05:45,229 --> 00:05:50,900
type so at the bottom<font color="#CCCCCC"> there I'm looking</font>

117
00:05:47,960 --> 00:05:54,010
<font color="#E5E5E5">for IDs events that are network based</font>

118
00:05:50,900 --> 00:05:56,780
<font color="#E5E5E5">that were critical across all my devices</font>

119
00:05:54,010 --> 00:05:59,570
<font color="#CCCCCC">so I might have</font><font color="#E5E5E5"> you know a Palo Alto</font>

120
00:05:56,780 --> 00:06:03,200
firewall maybe I've got some Cisco

121
00:05:59,570 --> 00:06:06,919
firewall with IPS somewhere I've got a

122
00:06:03,200 --> 00:06:10,340
laugh<font color="#E5E5E5"> right and I've got endpoint type</font>

123
00:06:06,919 --> 00:06:14,810
<font color="#CCCCCC">IPS this would search across all of</font>

124
00:06:10,340 --> 00:06:16,489
those<font color="#E5E5E5"> that's kind of the idea well it</font>

125
00:06:14,810 --> 00:06:25,760
would search<font color="#E5E5E5"> over network based based on</font>

126
00:06:16,490 --> 00:06:27,260
<font color="#E5E5E5">the search so components so custom</font>

127
00:06:25,760 --> 00:06:30,200
application is primarily made up of

128
00:06:27,260 --> 00:06:36,140
<font color="#E5E5E5">these directories and then files in</font>

129
00:06:30,200 --> 00:06:37,820
those<font color="#CCCCCC"> directories the local app comm and</font>

130
00:06:36,140 --> 00:06:38,619
<font color="#E5E5E5">the metadata files I'm not going to</font>

131
00:06:37,820 --> 00:06:41,949
cover

132
00:06:38,619 --> 00:06:43,929
today because<font color="#CCCCCC"> of brevity</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> they those</font>

133
00:06:41,949 --> 00:06:46,899
are<font color="#CCCCCC"> just basically metadata Raymond's</font>

134
00:06:43,929 --> 00:06:49,359
<font color="#E5E5E5">just information about your app very</font>

135
00:06:46,899 --> 00:06:53,799
basic stuff what's it called<font color="#CCCCCC"> right</font>

136
00:06:49,359 --> 00:06:55,388
who wrote it<font color="#E5E5E5"> that kind of thing</font><font color="#CCCCCC"> I'm</font>

137
00:06:53,799 --> 00:06:57,219
gonna focus on<font color="#E5E5E5"> the stuff under the</font>

138
00:06:55,389 --> 00:06:59,229
<font color="#E5E5E5">default directory and the lookups</font>

139
00:06:57,219 --> 00:07:00,789
directory because that's really<font color="#E5E5E5"> where</font>

140
00:06:59,229 --> 00:07:06,339
<font color="#E5E5E5">the</font><font color="#CCCCCC"> rubber hits</font><font color="#E5E5E5"> the road</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> with</font>

141
00:07:00,789 --> 00:07:10,479
custom apps so an<font color="#E5E5E5"> example app Kampf</font><font color="#CCCCCC"> in</font>

142
00:07:06,339 --> 00:07:11,979
the default directory<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> gonna use in</font>

143
00:07:10,479 --> 00:07:14,769
all<font color="#E5E5E5"> of this I'm going to use</font><font color="#CCCCCC"> just an</font>

144
00:07:11,979 --> 00:07:18,519
example<font color="#CCCCCC"> web application firewall custom</font>

145
00:07:14,769 --> 00:07:20,319
app<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is one that I had to build at</font>

146
00:07:18,519 --> 00:07:23,949
one point<font color="#E5E5E5"> because our</font><font color="#CCCCCC"> vendor vendor</font>

147
00:07:20,319 --> 00:07:26,229
<font color="#E5E5E5">didn't have a small gap and oftentimes</font>

148
00:07:23,949 --> 00:07:28,539
<font color="#CCCCCC">even when the vendors do have Splunk</font>

149
00:07:26,229 --> 00:07:30,789
<font color="#CCCCCC">apps</font><font color="#E5E5E5"> they don't conform to the common</font>

150
00:07:28,539 --> 00:07:32,619
information model and so I end up

151
00:07:30,789 --> 00:07:35,409
<font color="#E5E5E5">rewriting them anyway to fit that</font>

152
00:07:32,619 --> 00:07:37,539
because that's kind of<font color="#E5E5E5"> how my mind</font>

153
00:07:35,409 --> 00:07:41,259
thinks I can fit it<font color="#CCCCCC"> under different</font>

154
00:07:37,539 --> 00:07:45,068
<font color="#CCCCCC">domains right access network security</font>

155
00:07:41,259 --> 00:07:48,669
<font color="#E5E5E5">right account management right I can I</font>

156
00:07:45,069 --> 00:07:50,619
can start bucketing it<font color="#E5E5E5"> that way and a</font>

157
00:07:48,669 --> 00:07:55,029
<font color="#E5E5E5">lot of times vendors don't think that</font>

158
00:07:50,619 --> 00:07:57,399
way<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is pretty basic</font><font color="#CCCCCC"> you know is</font>

159
00:07:55,029 --> 00:08:01,360
it configured is it enabled when you

160
00:07:57,399 --> 00:08:04,529
install<font color="#E5E5E5"> it who the author is version and</font>

161
00:08:01,360 --> 00:08:06,939
then is visible<font color="#CCCCCC"> I</font><font color="#E5E5E5"> usually use false</font>

162
00:08:04,529 --> 00:08:09,819
<font color="#CCCCCC">that's going to be in the in the Splunk</font>

163
00:08:06,939 --> 00:08:11,349
<font color="#E5E5E5">UI up at the top left where you</font><font color="#CCCCCC"> can</font>

164
00:08:09,819 --> 00:08:13,779
click<font color="#CCCCCC"> and is it going</font><font color="#E5E5E5"> to show up in</font><font color="#CCCCCC"> that</font>

165
00:08:11,349 --> 00:08:16,359
<font color="#E5E5E5">drop-down of apps</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> usually don't do</font>

166
00:08:13,779 --> 00:08:18,369
that<font color="#E5E5E5"> because this is</font><font color="#CCCCCC"> usually</font><font color="#E5E5E5"> under</font><font color="#CCCCCC"> the</font>

167
00:08:16,359 --> 00:08:23,109
covers<font color="#E5E5E5"> type stuff I'm</font><font color="#CCCCCC"> doing but if</font><font color="#E5E5E5"> you</font>

168
00:08:18,369 --> 00:08:24,849
hit true<font color="#E5E5E5"> it'll show up there event types</font>

169
00:08:23,109 --> 00:08:27,489
<font color="#E5E5E5">so now we're starting to get into</font><font color="#CCCCCC"> a</font>

170
00:08:24,849 --> 00:08:29,069
little<font color="#E5E5E5"> bit of the meat so event types</font>

171
00:08:27,489 --> 00:08:31,959
are going to be where you identify

172
00:08:29,069 --> 00:08:34,749
certain searches that<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> would do</font>

173
00:08:31,959 --> 00:08:38,229
<font color="#E5E5E5">and you're going</font><font color="#CCCCCC"> to basically generate</font>

174
00:08:34,749 --> 00:08:41,860
<font color="#E5E5E5">meta information an event type that then</font>

175
00:08:38,229 --> 00:08:45,579
can become<font color="#E5E5E5"> searchable so take that first</font>

176
00:08:41,860 --> 00:08:47,980
one<font color="#E5E5E5"> laugh attack so everything after the</font>

177
00:08:45,579 --> 00:08:50,888
equal signs so search equals<font color="#E5E5E5"> and then</font>

178
00:08:47,980 --> 00:08:52,150
that's going to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> the search within</font>

179
00:08:50,889 --> 00:08:54,820
<font color="#CCCCCC">Splunk that you would do</font>

180
00:08:52,150 --> 00:08:56,800
from a search field<font color="#CCCCCC"> that would</font><font color="#E5E5E5"> create</font>

181
00:08:54,820 --> 00:08:59,470
<font color="#E5E5E5">that that</font><font color="#CCCCCC"> event type</font>

182
00:08:56,800 --> 00:09:02,349
then<font color="#E5E5E5"> I've got tags that are going to be</font>

183
00:08:59,470 --> 00:09:05,110
<font color="#E5E5E5">associated with that event type so take</font>

184
00:09:02,350 --> 00:09:07,300
the next<font color="#E5E5E5"> one down the laughs admin</font>

185
00:09:05,110 --> 00:09:09,430
activity<font color="#E5E5E5"> so here's one</font><font color="#CCCCCC"> that I want</font><font color="#E5E5E5"> to</font>

186
00:09:07,300 --> 00:09:12,969
<font color="#E5E5E5">look for</font><font color="#CCCCCC"> it's the source type isn't</font>

187
00:09:09,430 --> 00:09:15,430
<font color="#CCCCCC">whatever my wife vendor is type equals</font>

188
00:09:12,970 --> 00:09:18,250
event and then not user equals<font color="#CCCCCC"> daemon</font>

189
00:09:15,430 --> 00:09:23,829
<font color="#E5E5E5">because this product happened to do a</font>

190
00:09:18,250 --> 00:09:25,960
lot of activity via the daemon user<font color="#CCCCCC"> I</font>

191
00:09:23,830 --> 00:09:28,300
was looking for a specific admin

192
00:09:25,960 --> 00:09:29,980
activity someone some one of our admins

193
00:09:28,300 --> 00:09:31,359
logging in and<font color="#CCCCCC"> doing something</font><font color="#E5E5E5"> and then</font>

194
00:09:29,980 --> 00:09:34,050
<font color="#E5E5E5">I'm calling tagging at</font><font color="#CCCCCC"> Network and</font>

195
00:09:31,360 --> 00:09:36,130
modify next one down<font color="#E5E5E5"> I'm looking for</font>

196
00:09:34,050 --> 00:09:39,699
authentication events from an

197
00:09:36,130 --> 00:09:41,590
administrator<font color="#CCCCCC"> and you'll notice I'm</font>

198
00:09:39,700 --> 00:09:44,500
putting<font color="#E5E5E5"> in their tags are gonna be</font>

199
00:09:41,590 --> 00:09:48,120
<font color="#E5E5E5">authentication privileged</font><font color="#CCCCCC"> it's a network</font>

200
00:09:44,500 --> 00:09:50,140
<font color="#CCCCCC">login and I'm</font><font color="#E5E5E5"> starting a session</font><font color="#CCCCCC"> okay</font>

201
00:09:48,120 --> 00:09:53,830
that's important because<font color="#E5E5E5"> the next one</font>

202
00:09:50,140 --> 00:09:57,610
<font color="#E5E5E5">down I'm doing session end now a lot of</font>

203
00:09:53,830 --> 00:09:59,530
a lot of products do not when they log a

204
00:09:57,610 --> 00:10:01,180
<font color="#E5E5E5">login they</font><font color="#CCCCCC"> always they don't always put</font>

205
00:09:59,530 --> 00:10:03,310
in the length of the<font color="#CCCCCC"> session when</font>

206
00:10:01,180 --> 00:10:06,489
someone logs<font color="#E5E5E5"> out</font><font color="#CCCCCC"> I know like some Cisco</font>

207
00:10:03,310 --> 00:10:08,500
stuff does<font color="#E5E5E5"> but very little does very few</font>

208
00:10:06,490 --> 00:10:10,600
<font color="#E5E5E5">vendors do that this lets you basically</font>

209
00:10:08,500 --> 00:10:11,530
abstract away<font color="#E5E5E5"> from that and use</font><font color="#CCCCCC"> the</font>

210
00:10:10,600 --> 00:10:13,990
<font color="#CCCCCC">timestamps that</font>

211
00:10:11,530 --> 00:10:16,000
<font color="#E5E5E5">Splunk has to determine</font><font color="#CCCCCC"> the duration of</font>

212
00:10:13,990 --> 00:10:18,850
a<font color="#CCCCCC"> session</font><font color="#E5E5E5"> right so I can say I'm gonna</font>

213
00:10:16,000 --> 00:10:20,650
look for session and<font color="#E5E5E5"> session start and</font>

214
00:10:18,850 --> 00:10:25,480
I'm in a<font color="#E5E5E5"> delta the time on that</font><font color="#CCCCCC"> and I</font>

215
00:10:20,650 --> 00:10:27,880
know<font color="#E5E5E5"> their duration make sense so next</font>

216
00:10:25,480 --> 00:10:29,520
<font color="#E5E5E5">is going to be the tags comp file and</font>

217
00:10:27,880 --> 00:10:33,010
this<font color="#E5E5E5"> is pretty self-explanatory</font>

218
00:10:29,520 --> 00:10:35,050
<font color="#CCCCCC">basically lines up with</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> back to</font>

219
00:10:33,010 --> 00:10:36,640
that<font color="#CCCCCC"> events type</font><font color="#E5E5E5"> you I have all the tags</font>

220
00:10:35,050 --> 00:10:37,180
there and the event type<font color="#CCCCCC"> name so in the</font>

221
00:10:36,640 --> 00:10:39,760
tags

222
00:10:37,180 --> 00:10:41,890
<font color="#E5E5E5">I've got event type equals the event</font>

223
00:10:39,760 --> 00:10:45,630
type<font color="#E5E5E5"> and then the tags associated</font><font color="#CCCCCC"> with</font>

224
00:10:41,890 --> 00:10:45,630
that and<font color="#E5E5E5"> I'm enabling</font><font color="#CCCCCC"> or disabling them</font>

225
00:10:46,140 --> 00:10:51,850
<font color="#CCCCCC">that where it</font><font color="#E5E5E5"> says in the brackets event</font>

226
00:10:49,480 --> 00:10:54,370
type equals whatever<font color="#E5E5E5"> that now becomes a</font>

227
00:10:51,850 --> 00:10:55,750
searchable field in<font color="#CCCCCC"> Splunk</font><font color="#E5E5E5"> so when</font>

228
00:10:54,370 --> 00:10:57,880
you're doing a<font color="#CCCCCC"> Splunk search you</font><font color="#E5E5E5"> can</font>

229
00:10:55,750 --> 00:10:59,650
type event type equals<font color="#E5E5E5"> whatever and it</font>

230
00:10:57,880 --> 00:11:01,780
will automatically<font color="#E5E5E5"> find whatever you've</font>

231
00:10:59,650 --> 00:11:04,300
defined here you don't<font color="#CCCCCC"> have to</font><font color="#E5E5E5"> remember</font>

232
00:11:01,780 --> 00:11:06,480
<font color="#CCCCCC">everything</font><font color="#E5E5E5"> that that defined that event</font>

233
00:11:04,300 --> 00:11:06,479
type

234
00:11:07,829 --> 00:11:14,920
<font color="#CCCCCC">all right</font><font color="#E5E5E5"> so transforms</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is this is</font>

235
00:11:11,829 --> 00:11:17,949
where<font color="#E5E5E5"> the meats really</font><font color="#CCCCCC"> is so a couple</font>

236
00:11:14,920 --> 00:11:19,529
examples<font color="#CCCCCC"> here</font><font color="#E5E5E5"> basically the Nate</font>

237
00:11:17,949 --> 00:11:22,180
whatever name you have in the brackets

238
00:11:19,529 --> 00:11:24,540
<font color="#CCCCCC">is only going to be relevant within your</font>

239
00:11:22,180 --> 00:11:28,540
app that doesn't<font color="#E5E5E5"> matter</font><font color="#CCCCCC"> to Splunk</font>

240
00:11:24,540 --> 00:11:30,939
<font color="#E5E5E5">internally you can't search on</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you</font>

241
00:11:28,540 --> 00:11:32,740
can so here<font color="#E5E5E5"> I'm the top one</font><font color="#CCCCCC"> laugh</font>

242
00:11:30,939 --> 00:11:36,160
<font color="#E5E5E5">changes</font><font color="#CCCCCC"> I've got a regex that I'm</font>

243
00:11:32,740 --> 00:11:38,139
<font color="#CCCCCC">looking</font><font color="#E5E5E5"> for a specific log entry</font><font color="#CCCCCC"> and</font>

244
00:11:36,160 --> 00:11:40,149
then I've got parentheses because<font color="#E5E5E5"> this</font>

245
00:11:38,139 --> 00:11:42,009
is<font color="#E5E5E5"> basically following</font><font color="#CCCCCC"> pearl compatible</font>

246
00:11:40,149 --> 00:11:44,259
regular expressions<font color="#E5E5E5"> and you can pull in</font>

247
00:11:42,009 --> 00:11:47,910
those any information in the<font color="#E5E5E5"> parentheses</font>

248
00:11:44,259 --> 00:11:50,949
as a<font color="#E5E5E5"> variable then under format equals</font>

249
00:11:47,910 --> 00:11:54,670
I'm just saying<font color="#E5E5E5"> the first item under</font>

250
00:11:50,949 --> 00:11:56,800
parentheses is<font color="#E5E5E5"> the field user next one</font>

251
00:11:54,670 --> 00:11:59,800
is the field action<font color="#E5E5E5"> right next</font><font color="#CCCCCC"> one's</font>

252
00:11:56,800 --> 00:12:00,939
command<font color="#E5E5E5"> so now those become fields like</font>

253
00:11:59,800 --> 00:12:02,560
when you're in<font color="#CCCCCC"> Splunk and you're looking</font>

254
00:12:00,939 --> 00:12:04,990
<font color="#E5E5E5">at event you have all the fields on the</font>

255
00:12:02,560 --> 00:12:06,550
left<font color="#E5E5E5"> side that</font><font color="#CCCCCC"> you can search these now</font>

256
00:12:04,990 --> 00:12:12,250
become fields that are<font color="#CCCCCC"> available to you</font>

257
00:12:06,550 --> 00:12:14,170
okay next one wife admin off you can see

258
00:12:12,250 --> 00:12:19,959
same thing and<font color="#E5E5E5"> I'm creating the</font><font color="#CCCCCC"> the</font>

259
00:12:14,170 --> 00:12:22,630
<font color="#CCCCCC">fields</font><font color="#E5E5E5"> there another example I'm just</font>

260
00:12:19,959 --> 00:12:24,880
calling<font color="#CCCCCC"> a wife event one</font><font color="#E5E5E5"> and you can see</font>

261
00:12:22,630 --> 00:12:29,439
<font color="#CCCCCC">I can I can chain a ton of</font><font color="#E5E5E5"> these</font>

262
00:12:24,880 --> 00:12:31,269
together and pull in a bunch of them the

263
00:12:29,439 --> 00:12:32,430
bottom one<font color="#CCCCCC"> I want to call special</font>

264
00:12:31,269 --> 00:12:35,680
attention<font color="#E5E5E5"> to</font>

265
00:12:32,430 --> 00:12:38,258
I've got<font color="#E5E5E5"> format equals laugh underscore</font>

266
00:12:35,680 --> 00:12:42,489
action<font color="#E5E5E5"> that's my own event</font><font color="#CCCCCC"> or my own</font>

267
00:12:38,259 --> 00:12:43,870
field name that I'm creating<font color="#CCCCCC"> so you can</font>

268
00:12:42,490 --> 00:12:47,380
see you can extend these you can name

269
00:12:43,870 --> 00:12:50,649
them<font color="#E5E5E5"> whatever you want</font><font color="#CCCCCC"> I'm gonna</font><font color="#E5E5E5"> this</font>

270
00:12:47,380 --> 00:12:54,069
this this<font color="#CCCCCC"> this Web Application</font><font color="#E5E5E5"> Firewall</font>

271
00:12:50,649 --> 00:12:55,839
<font color="#CCCCCC">the action</font><font color="#E5E5E5"> that it took is something</font>

272
00:12:54,069 --> 00:12:56,920
what it put in the<font color="#E5E5E5"> logs is something</font>

273
00:12:55,839 --> 00:13:00,730
that I didn't<font color="#CCCCCC"> really</font><font color="#E5E5E5"> want to work with</font>

274
00:12:56,920 --> 00:13:03,819
<font color="#E5E5E5">so what I did is I created this this why</font>

275
00:13:00,730 --> 00:13:06,220
<font color="#E5E5E5">I named a wife action and I'm now</font>

276
00:13:03,819 --> 00:13:09,009
<font color="#E5E5E5">pulling that in as wife that</font><font color="#CCCCCC"> that field</font>

277
00:13:06,220 --> 00:13:13,059
name<font color="#E5E5E5"> then what</font><font color="#CCCCCC"> I do</font><font color="#E5E5E5"> is in the transforms</font>

278
00:13:09,009 --> 00:13:17,199
<font color="#E5E5E5">calm I I define a look up okay and</font><font color="#CCCCCC"> I</font>

279
00:13:13,059 --> 00:13:18,400
label a file name<font color="#CCCCCC"> a CSV file because I</font>

280
00:13:17,199 --> 00:13:21,459
want<font color="#E5E5E5"> to remap the</font>

281
00:13:18,400 --> 00:13:23,620
what this this<font color="#E5E5E5"> product call</font><font color="#CCCCCC"> anytime</font>

282
00:13:21,460 --> 00:13:26,260
<font color="#E5E5E5">there was an event</font><font color="#CCCCCC"> if it</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> an allowed</font>

283
00:13:23,620 --> 00:13:29,350
event that the<font color="#CCCCCC"> wife did not block it</font>

284
00:13:26,260 --> 00:13:32,980
would log alert<font color="#E5E5E5"> if it was a blocked one</font>

285
00:13:29,350 --> 00:13:34,600
it would<font color="#E5E5E5"> be alert underscore deny which</font>

286
00:13:32,980 --> 00:13:37,030
to me those<font color="#E5E5E5"> aren't really useful because</font>

287
00:13:34,600 --> 00:13:39,310
I have other devices<font color="#CCCCCC"> that use</font><font color="#E5E5E5"> different</font>

288
00:13:37,030 --> 00:13:42,939
nomenclature for for how they a<font color="#E5E5E5"> lot</font>

289
00:13:39,310 --> 00:13:45,180
allow or block things<font color="#E5E5E5"> so in the CSV file</font>

290
00:13:42,940 --> 00:13:47,770
<font color="#CCCCCC">that I just</font><font color="#E5E5E5"> referenced in that</font><font color="#CCCCCC"> lookup</font>

291
00:13:45,180 --> 00:13:49,780
it's a really simple<font color="#CCCCCC"> I've got on the</font>

292
00:13:47,770 --> 00:13:51,640
<font color="#CCCCCC">Left laugh action which I had defined in</font>

293
00:13:49,780 --> 00:13:54,370
my transform when<font color="#E5E5E5"> I extracted the field</font>

294
00:13:51,640 --> 00:13:56,949
and on<font color="#CCCCCC"> the right I've got action okay</font>

295
00:13:54,370 --> 00:13:58,990
<font color="#E5E5E5">which is now for conforming to the</font>

296
00:13:56,950 --> 00:14:01,780
common information model and you<font color="#E5E5E5"> can see</font>

297
00:13:58,990 --> 00:14:04,570
I'm translating<font color="#E5E5E5"> alert to allowed alert</font>

298
00:14:01,780 --> 00:14:07,569
denied a blocked<font color="#E5E5E5"> success to allowed and</font>

299
00:14:04,570 --> 00:14:09,820
I can add whatever I want here<font color="#CCCCCC"> so that</font>

300
00:14:07,570 --> 00:14:11,320
way when I do a search for anything and

301
00:14:09,820 --> 00:14:13,540
you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> anything to do with the</font><font color="#CCCCCC"> laughs</font>

302
00:14:11,320 --> 00:14:15,550
<font color="#E5E5E5">and I want to see whether it was allowed</font>

303
00:14:13,540 --> 00:14:18,040
or not<font color="#E5E5E5"> I can</font><font color="#CCCCCC"> just do action equals</font>

304
00:14:15,550 --> 00:14:19,900
<font color="#E5E5E5">allowed right in my search and then now</font>

305
00:14:18,040 --> 00:14:21,640
that's gonna do that<font color="#CCCCCC"> I don't have</font><font color="#E5E5E5"> to</font>

306
00:14:19,900 --> 00:14:24,939
remember what<font color="#CCCCCC"> the nomenclature</font><font color="#E5E5E5"> was per</font>

307
00:14:21,640 --> 00:14:30,750
vendor<font color="#CCCCCC"> that I have logging Splunk</font><font color="#E5E5E5"> it's</font>

308
00:14:24,940 --> 00:14:30,750
now normalized for me on my team yeah

309
00:14:35,759 --> 00:14:43,509
this one right here<font color="#CCCCCC"> so back here</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> I'm</font>

310
00:14:39,790 --> 00:14:46,149
<font color="#E5E5E5">pulling it out of the the log yep and</font>

311
00:14:43,509 --> 00:14:48,100
<font color="#E5E5E5">then here I'm in the transforms our</font><font color="#CCCCCC"> comm</font>

312
00:14:46,149 --> 00:14:50,529
file just lowered and further<font color="#E5E5E5"> down</font><font color="#CCCCCC"> I'm</font>

313
00:14:48,100 --> 00:14:52,630
actually referencing a<font color="#E5E5E5"> look up and</font>

314
00:14:50,529 --> 00:15:01,480
telling it here's the<font color="#E5E5E5"> file that defines</font>

315
00:14:52,630 --> 00:15:04,509
<font color="#E5E5E5">that look up</font><font color="#CCCCCC"> because this this file name</font>

316
00:15:01,480 --> 00:15:07,779
is<font color="#CCCCCC"> associated with this app so this app</font>

317
00:15:04,509 --> 00:15:10,149
and that<font color="#CCCCCC"> laugh</font><font color="#E5E5E5"> action shouldn't you if</font>

318
00:15:07,779 --> 00:15:12,130
my reg ex is crappy<font color="#E5E5E5"> then think more</font>

319
00:15:10,149 --> 00:15:14,589
things are gonna get<font color="#E5E5E5"> caught but if you</font>

320
00:15:12,130 --> 00:15:16,689
get<font color="#E5E5E5"> your reg ex correct then only events</font>

321
00:15:14,589 --> 00:15:29,470
that match<font color="#E5E5E5"> that reg</font><font color="#CCCCCC"> X should</font><font color="#E5E5E5"> get defined</font>

322
00:15:16,690 --> 00:15:36,130
<font color="#E5E5E5">as that field no because it's a</font>

323
00:15:29,470 --> 00:15:40,149
different reg<font color="#E5E5E5"> X</font><font color="#CCCCCC"> okay that ain't</font><font color="#E5E5E5"> your</font>

324
00:15:36,130 --> 00:15:44,889
<font color="#E5E5E5">question you asked me afterward so</font>

325
00:15:40,149 --> 00:15:48,639
here's a here's<font color="#E5E5E5"> a different type this is</font>

326
00:15:44,889 --> 00:15:50,500
a Palo Alto<font color="#CCCCCC"> so so Palo Alto in</font><font color="#E5E5E5"> their</font>

327
00:15:48,639 --> 00:15:52,779
logs<font color="#E5E5E5"> they're just their logs are</font>

328
00:15:50,500 --> 00:15:54,399
basically just comma separated values so

329
00:15:52,779 --> 00:15:57,189
it makes<font color="#E5E5E5"> it really easy to</font><font color="#CCCCCC"> bring into</font>

330
00:15:54,399 --> 00:16:00,279
<font color="#CCCCCC">Splunk</font><font color="#E5E5E5"> here I'm defining a key value</font>

331
00:15:57,190 --> 00:16:02,620
<font color="#CCCCCC">pair</font><font color="#E5E5E5"> and I'm saying my delimiter the</font>

332
00:16:00,279 --> 00:16:05,560
<font color="#E5E5E5">third line down there is a comma and</font>

333
00:16:02,620 --> 00:16:07,410
then<font color="#CCCCCC"> those are the fields</font><font color="#E5E5E5"> so I'll have</font>

334
00:16:05,560 --> 00:16:09,969
to do any<font color="#CCCCCC"> regex I'm</font><font color="#E5E5E5"> just saying if it's</font>

335
00:16:07,410 --> 00:16:11,199
just go through if it's a field that<font color="#CCCCCC"> I</font>

336
00:16:09,970 --> 00:16:15,279
don't really<font color="#E5E5E5"> care</font><font color="#CCCCCC"> about then I might</font>

337
00:16:11,199 --> 00:16:17,829
<font color="#CCCCCC">just name it some nonsense</font><font color="#E5E5E5"> thing but I</font>

338
00:16:15,279 --> 00:16:19,980
can pull<font color="#CCCCCC"> it in and now all</font><font color="#E5E5E5"> those fields</font>

339
00:16:17,829 --> 00:16:25,719
become<font color="#CCCCCC"> available in a Palo Alto threat</font>

340
00:16:19,980 --> 00:16:28,709
thing<font color="#E5E5E5"> right here so then in the props</font>

341
00:16:25,720 --> 00:16:32,079
<font color="#CCCCCC">comp is where you use all</font><font color="#E5E5E5"> of this so</font>

342
00:16:28,709 --> 00:16:34,540
<font color="#E5E5E5">that first line first couple lines I'm</font>

343
00:16:32,079 --> 00:16:37,349
defining the source type for this

344
00:16:34,540 --> 00:16:40,089
application<font color="#CCCCCC"> I'm calling it wife source</font>

345
00:16:37,350 --> 00:16:42,730
<font color="#E5E5E5">now you notice I'm not defining how that</font>

346
00:16:40,089 --> 00:16:44,480
data is getting<font color="#E5E5E5"> in I'm doing that for</font>

347
00:16:42,730 --> 00:16:46,940
<font color="#CCCCCC">this</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> via the date</font>

348
00:16:44,480 --> 00:16:49,060
<font color="#CCCCCC">in put Splunk ass so I'm just saying if</font>

349
00:16:46,940 --> 00:16:51,860
it comes in<font color="#CCCCCC"> on</font><font color="#E5E5E5"> UDP port such-and-such</font>

350
00:16:49,060 --> 00:16:54,768
<font color="#E5E5E5">then define it a source type last source</font>

351
00:16:51,860 --> 00:16:57,529
and then my application looks for that

352
00:16:54,769 --> 00:17:00,320
store my<font color="#E5E5E5"> application looks for that</font>

353
00:16:57,529 --> 00:17:03,429
source type<font color="#E5E5E5"> laughs source and then that</font>

354
00:17:00,320 --> 00:17:06,709
<font color="#E5E5E5">next line is now should line merge</font>

355
00:17:03,429 --> 00:17:08,418
<font color="#E5E5E5">usually that's going to be false</font><font color="#CCCCCC"> that's</font>

356
00:17:06,709 --> 00:17:09,650
defining<font color="#E5E5E5"> whether you're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> merge</font>

357
00:17:08,419 --> 00:17:11,540
multiple lines if you<font color="#CCCCCC"> have an</font>

358
00:17:09,650 --> 00:17:13,970
application<font color="#E5E5E5"> that</font><font color="#CCCCCC"> merges that has</font>

359
00:17:11,540 --> 00:17:16,069
multiple lines that<font color="#E5E5E5"> kind of come in and</font>

360
00:17:13,970 --> 00:17:18,740
<font color="#E5E5E5">in the logs</font><font color="#CCCCCC"> but really should be one</font>

361
00:17:16,069 --> 00:17:21,918
item<font color="#E5E5E5"> then you can merge them you make</font>

362
00:17:18,740 --> 00:17:24,140
<font color="#E5E5E5">that true now it merges them together so</font>

363
00:17:21,919 --> 00:17:27,470
then here's where you're defining<font color="#E5E5E5"> what's</font>

364
00:17:24,140 --> 00:17:28,730
<font color="#CCCCCC">getting used for the application all of</font>

365
00:17:27,470 --> 00:17:30,500
the other stuff you<font color="#E5E5E5"> could do the work</font>

366
00:17:28,730 --> 00:17:32,270
and if you don't<font color="#E5E5E5"> define it here your</font>

367
00:17:30,500 --> 00:17:34,130
<font color="#E5E5E5">application never sees</font><font color="#CCCCCC"> it and Splunk a</font>

368
00:17:32,270 --> 00:17:36,350
never uses it<font color="#CCCCCC"> so you have</font><font color="#E5E5E5"> to get your</font>

369
00:17:34,130 --> 00:17:39,919
your you have to type the names

370
00:17:36,350 --> 00:17:42,199
correctly<font color="#CCCCCC"> I</font><font color="#E5E5E5"> troubleshot a ton of things</font>

371
00:17:39,919 --> 00:17:45,940
<font color="#E5E5E5">where I've basically fat-fingered things</font>

372
00:17:42,200 --> 00:17:49,309
and caused myself<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of problems so</font>

373
00:17:45,940 --> 00:17:52,880
first<font color="#E5E5E5"> I'll take that first one report</font>

374
00:17:49,309 --> 00:17:56,899
<font color="#CCCCCC">laughs action equals</font><font color="#E5E5E5"> wife action so the</font>

375
00:17:52,880 --> 00:18:00,290
report<font color="#E5E5E5"> tag is basically pulling in any</font>

376
00:17:56,900 --> 00:18:02,330
of the items<font color="#E5E5E5"> as I come back here see</font>

377
00:18:00,290 --> 00:18:05,330
I've<font color="#E5E5E5"> got this wife event one any of</font>

378
00:18:02,330 --> 00:18:07,370
<font color="#CCCCCC">those kind of items show up in the props</font>

379
00:18:05,330 --> 00:18:09,290
<font color="#CCCCCC">comp as a report and</font><font color="#E5E5E5"> you can name them</font>

380
00:18:07,370 --> 00:18:13,250
<font color="#E5E5E5">whatever you want</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> usually keep the two</font>

381
00:18:09,290 --> 00:18:16,700
the same so that<font color="#E5E5E5"> I don't miss type</font>

382
00:18:13,250 --> 00:18:18,710
things so I'm pulling<font color="#CCCCCC"> in the wife action</font>

383
00:18:16,700 --> 00:18:21,679
the wife event one wife changes wife

384
00:18:18,710 --> 00:18:26,419
admin off those are all the transforms I

385
00:18:21,679 --> 00:18:28,990
did previously<font color="#CCCCCC"> field aliases so</font>

386
00:18:26,419 --> 00:18:31,220
sometimes I can get maybe whatever

387
00:18:28,990 --> 00:18:37,160
application I'm pull<font color="#E5E5E5"> whatever data I'm</font>

388
00:18:31,220 --> 00:18:39,230
bringing in<font color="#E5E5E5"> might have the field the</font>

389
00:18:37,160 --> 00:18:41,750
data in the field is correct what I want

390
00:18:39,230 --> 00:18:43,700
<font color="#E5E5E5">but</font><font color="#CCCCCC"> the name</font><font color="#E5E5E5"> of the field isn't matching</font>

391
00:18:41,750 --> 00:18:45,169
what I want to use<font color="#E5E5E5"> so again I want to</font>

392
00:18:43,700 --> 00:18:48,440
map it to the common information model

393
00:18:45,169 --> 00:18:51,860
<font color="#CCCCCC">so for</font><font color="#E5E5E5"> example the first field alias</font>

394
00:18:48,440 --> 00:18:54,620
<font color="#CCCCCC">wife device I'm calling it this device</font>

395
00:18:51,860 --> 00:18:56,139
actually<font color="#E5E5E5"> had a field called dev name</font>

396
00:18:54,620 --> 00:19:00,070
equals and

397
00:18:56,140 --> 00:19:01,960
have whatever the<font color="#CCCCCC"> device name was</font><font color="#E5E5E5"> but</font>

398
00:19:00,070 --> 00:19:04,510
that doesn't match<font color="#CCCCCC"> common information</font>

399
00:19:01,960 --> 00:19:07,300
model common information model<font color="#E5E5E5"> wants</font><font color="#CCCCCC"> DVC</font>

400
00:19:04,510 --> 00:19:12,160
for device<font color="#E5E5E5"> so I'm just a liasing that</font>

401
00:19:07,300 --> 00:19:16,750
over to<font color="#CCCCCC"> Deb name equals device so all of</font>

402
00:19:12,160 --> 00:19:18,400
those<font color="#E5E5E5"> I can</font><font color="#CCCCCC"> do that</font><font color="#E5E5E5"> with you'll notice I</font>

403
00:19:16,750 --> 00:19:21,400
didn't do that<font color="#E5E5E5"> with action again that's</font>

404
00:19:18,400 --> 00:19:23,380
<font color="#E5E5E5">because then you'll only want to</font>

405
00:19:21,400 --> 00:19:26,290
aliasing<font color="#CCCCCC"> x'</font><font color="#E5E5E5"> where the field value</font>

406
00:19:23,380 --> 00:19:30,790
<font color="#CCCCCC">matches what you want to have later</font><font color="#E5E5E5"> in</font>

407
00:19:26,290 --> 00:19:33,310
the application<font color="#CCCCCC"> if the field alias if</font>

408
00:19:30,790 --> 00:19:35,050
the field<font color="#E5E5E5"> value is not that way then you</font>

409
00:19:33,310 --> 00:19:37,270
need<font color="#E5E5E5"> to do a lookup and that's where</font>

410
00:19:35,050 --> 00:19:40,540
you're<font color="#E5E5E5"> basically rewriting that field</font>

411
00:19:37,270 --> 00:19:42,879
<font color="#E5E5E5">information so the bottom one</font><font color="#CCCCCC"> you see</font>

412
00:19:40,540 --> 00:19:45,610
the lookup I'm named<font color="#E5E5E5"> I'm pulling from</font>

413
00:19:42,880 --> 00:19:47,350
<font color="#E5E5E5">that</font><font color="#CCCCCC"> woth action lookup</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I'm taking</font>

414
00:19:45,610 --> 00:19:49,149
the<font color="#E5E5E5"> laughs action column from that CSV</font>

415
00:19:47,350 --> 00:19:54,820
<font color="#E5E5E5">and I'm outputting action the action</font>

416
00:19:49,150 --> 00:19:57,490
<font color="#CCCCCC">column and that's that's pretty much it</font>

417
00:19:54,820 --> 00:19:59,169
<font color="#E5E5E5">here's a different</font><font color="#CCCCCC"> example where I'm</font>

418
00:19:57,490 --> 00:20:00,700
pulling from a source type and<font color="#E5E5E5"> I'm</font>

419
00:19:59,170 --> 00:20:01,960
actually a lot<font color="#E5E5E5"> of times you'll have a</font>

420
00:20:00,700 --> 00:20:05,140
lot of<font color="#E5E5E5"> different devices</font>

421
00:20:01,960 --> 00:20:07,300
maybe<font color="#CCCCCC"> you can't change what port they</font>

422
00:20:05,140 --> 00:20:10,180
log on or and they're just going<font color="#E5E5E5"> to</font>

423
00:20:07,300 --> 00:20:11,919
default to UDP 5:14 for syslog or

424
00:20:10,180 --> 00:20:15,370
something<font color="#E5E5E5"> and you can't change that port</font>

425
00:20:11,920 --> 00:20:18,070
<font color="#E5E5E5">or you can't put a forwarder on on the</font>

426
00:20:15,370 --> 00:20:20,020
device<font color="#E5E5E5"> whatever it might be</font><font color="#CCCCCC"> so here's an</font>

427
00:20:18,070 --> 00:20:22,510
example<font color="#E5E5E5"> where I'm taking syslog data</font>

428
00:20:20,020 --> 00:20:26,110
which<font color="#CCCCCC"> may be I</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> 8 devices logging to</font>

429
00:20:22,510 --> 00:20:28,660
syslog<font color="#E5E5E5"> and I'm gonna rip</font><font color="#CCCCCC"> that out and</font>

430
00:20:26,110 --> 00:20:31,689
I'm<font color="#E5E5E5"> gonna read recategorize that to a</font>

431
00:20:28,660 --> 00:20:35,440
specific<font color="#CCCCCC"> source type so this transforms</font>

432
00:20:31,690 --> 00:20:37,600
I'm forcing the source type<font color="#CCCCCC"> to change</font>

433
00:20:35,440 --> 00:20:40,900
<font color="#CCCCCC">from syslog to what I'm determining and</font>

434
00:20:37,600 --> 00:20:44,230
so in my transforms<font color="#CCCCCC"> Kampf</font><font color="#E5E5E5"> this is where</font>

435
00:20:40,900 --> 00:20:47,050
I'm<font color="#CCCCCC"> doing that</font><font color="#E5E5E5"> I've got a regex that</font>

436
00:20:44,230 --> 00:20:52,150
matches<font color="#CCCCCC"> it needs to</font><font color="#E5E5E5"> match all of the</font>

437
00:20:47,050 --> 00:20:54,399
logs for that source type if you<font color="#CCCCCC"> don't</font>

438
00:20:52,150 --> 00:20:56,410
then you're<font color="#E5E5E5"> going to end up some events</font>

439
00:20:54,400 --> 00:20:58,390
from<font color="#E5E5E5"> that source</font><font color="#CCCCCC"> are going</font><font color="#E5E5E5"> to be mapped</font>

440
00:20:56,410 --> 00:20:59,530
<font color="#CCCCCC">to source type</font><font color="#E5E5E5"> whatever you define here</font>

441
00:20:58,390 --> 00:21:03,910
and some are going to be syslog and

442
00:20:59,530 --> 00:21:05,710
<font color="#CCCCCC">you're going</font><font color="#E5E5E5"> to get</font><font color="#CCCCCC"> incompatible data so</font>

443
00:21:03,910 --> 00:21:07,309
and then I'm just formatting it is

444
00:21:05,710 --> 00:21:14,120
source type is what

445
00:21:07,309 --> 00:21:16,999
I decide<font color="#CCCCCC"> so where do the files go so</font>

446
00:21:14,120 --> 00:21:20,748
they go in the<font color="#CCCCCC"> at-sea</font><font color="#E5E5E5"> apps and then</font>

447
00:21:16,999 --> 00:21:22,279
whatever you name it<font color="#CCCCCC"> extracts our search</font>

448
00:21:20,749 --> 00:21:26,710
time events so they go<font color="#CCCCCC"> on the search</font>

449
00:21:22,279 --> 00:21:29,679
head<font color="#E5E5E5"> and transforms our index time if</font>

450
00:21:26,710 --> 00:21:31,909
extractions so they go<font color="#E5E5E5"> on the indexers</font>

451
00:21:29,679 --> 00:21:33,980
you'll notice I<font color="#CCCCCC"> only use I only showed</font>

452
00:21:31,909 --> 00:21:35,659
<font color="#CCCCCC">one example</font><font color="#E5E5E5"> of transforms they're</font><font color="#CCCCCC"> there</font>

453
00:21:33,980 --> 00:21:40,100
<font color="#E5E5E5">they're rare I don't use them a whole</font>

454
00:21:35,659 --> 00:21:42,080
<font color="#E5E5E5">lot but you</font><font color="#CCCCCC"> can put there's no harm</font><font color="#E5E5E5"> and</font>

455
00:21:40,100 --> 00:21:44,629
placing<font color="#E5E5E5"> them on both which</font><font color="#CCCCCC"> is what I do</font>

456
00:21:42,080 --> 00:21:46,399
<font color="#CCCCCC">so I hate to get</font><font color="#E5E5E5"> in the business of</font>

457
00:21:44,629 --> 00:21:49,129
putting search stuff on the search head

458
00:21:46,399 --> 00:21:51,649
and index F on the index<font color="#E5E5E5"> because I I'm</font>

459
00:21:49,129 --> 00:21:53,149
<font color="#E5E5E5">gonna mess up and my deployment server</font>

460
00:21:51,649 --> 00:21:55,549
this makes it easier for<font color="#E5E5E5"> my deployment</font>

461
00:21:53,149 --> 00:21:57,498
server to just push the app to both so

462
00:21:55,549 --> 00:21:59,299
<font color="#CCCCCC">Splunk doesn't care and it does the work</font>

463
00:21:57,499 --> 00:22:03,499
for<font color="#E5E5E5"> you in deciphering which one goes on</font>

464
00:21:59,299 --> 00:22:09,019
which<font color="#CCCCCC"> ok real quick</font><font color="#E5E5E5"> so how do I</font><font color="#CCCCCC"> use that</font>

465
00:22:03,499 --> 00:22:12,379
<font color="#CCCCCC">so</font><font color="#E5E5E5"> some tips here main thing here is</font>

466
00:22:09,019 --> 00:22:14,809
<font color="#CCCCCC">just start asking questions decide ok I</font>

467
00:22:12,379 --> 00:22:16,309
want to use what what question do I want

468
00:22:14,809 --> 00:22:17,928
to ask what information do I need<font color="#E5E5E5"> and</font>

469
00:22:16,309 --> 00:22:20,928
then build your<font color="#E5E5E5"> app to pull that</font>

470
00:22:17,929 --> 00:22:22,700
information<font color="#E5E5E5"> in I put</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> void pie charts</font>

471
00:22:20,929 --> 00:22:24,320
because data analysts hate pie charts

472
00:22:22,700 --> 00:22:27,499
<font color="#CCCCCC">human</font><font color="#E5E5E5"> eyes can't tell the difference</font>

473
00:22:24,320 --> 00:22:29,809
<font color="#CCCCCC">between</font><font color="#E5E5E5"> the sizes</font><font color="#CCCCCC"> ok so a</font><font color="#E5E5E5"> couple of</font>

474
00:22:27,499 --> 00:22:31,850
<font color="#E5E5E5">examples some examples</font><font color="#CCCCCC"> here on the</font><font color="#E5E5E5"> right</font>

475
00:22:29,809 --> 00:22:35,658
I've just got a single pane<font color="#E5E5E5"> from a</font>

476
00:22:31,850 --> 00:22:38,059
<font color="#CCCCCC">dashboard that</font><font color="#E5E5E5"> I pulled on March 8th</font>

477
00:22:35,659 --> 00:22:40,879
this is authentication events and I'm

478
00:22:38,059 --> 00:22:42,889
tracking access over time by<font color="#E5E5E5"> actions so</font>

479
00:22:40,879 --> 00:22:45,889
I'm only looking<font color="#E5E5E5"> at success or failure</font>

480
00:22:42,889 --> 00:22:48,168
<font color="#E5E5E5">you can see there's a huge increase in</font>

481
00:22:45,889 --> 00:22:49,340
failures<font color="#E5E5E5"> what this ended up being is I</font>

482
00:22:48,169 --> 00:22:52,039
could click on that<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I could drill</font>

483
00:22:49,340 --> 00:22:55,158
<font color="#CCCCCC">down and see</font><font color="#E5E5E5"> what those are but those</font>

484
00:22:52,039 --> 00:22:57,259
were we had a<font color="#CCCCCC"> back-end process that the</font>

485
00:22:55,159 --> 00:22:58,940
authentication mechanism changed<font color="#E5E5E5"> and two</font>

486
00:22:57,259 --> 00:23:01,249
systems didn't reflect<font color="#E5E5E5"> that change</font><font color="#CCCCCC"> and</font>

487
00:22:58,940 --> 00:23:05,119
<font color="#CCCCCC">generated a crap-ton of failed</font>

488
00:23:01,249 --> 00:23:07,159
authentication<font color="#E5E5E5"> failures so</font><font color="#CCCCCC"> I'm able to</font>

489
00:23:05,119 --> 00:23:10,610
spot that the search<font color="#CCCCCC"> that generates</font><font color="#E5E5E5"> that</font>

490
00:23:07,159 --> 00:23:12,460
is over<font color="#CCCCCC"> on the top left I'm just again</font>

491
00:23:10,610 --> 00:23:15,799
I'm<font color="#CCCCCC"> looking at authentication</font><font color="#E5E5E5"> events</font>

492
00:23:12,460 --> 00:23:17,539
I've got two variables<font color="#E5E5E5"> action and user</font>

493
00:23:15,799 --> 00:23:19,379
type that you<font color="#E5E5E5"> can see or dropdowns in</font>

494
00:23:17,539 --> 00:23:23,390
that<font color="#CCCCCC"> dashboard on the</font><font color="#E5E5E5"> right</font>

495
00:23:19,380 --> 00:23:27,780
and<font color="#CCCCCC"> then</font><font color="#E5E5E5"> I'm time charting</font><font color="#CCCCCC"> that actually</font>

496
00:23:23,390 --> 00:23:30,150
that failure will fail your columns were

497
00:23:27,780 --> 00:23:35,160
both windows events as well<font color="#CCCCCC"> as web</font>

498
00:23:30,150 --> 00:23:37,530
application logs on<font color="#E5E5E5"> on the</font><font color="#CCCCCC"> backend so I</font>

499
00:23:35,160 --> 00:23:40,049
got both<font color="#E5E5E5"> types on using the tag equals</font>

500
00:23:37,530 --> 00:23:43,190
authentication<font color="#E5E5E5"> another example below</font>

501
00:23:40,049 --> 00:23:45,210
that failed user accounts<font color="#CCCCCC"> I'm</font>

502
00:23:43,190 --> 00:23:48,210
authentications and failures<font color="#E5E5E5"> and I'm</font>

503
00:23:45,210 --> 00:23:49,980
sorting them are created<font color="#E5E5E5"> enabled</font>

504
00:23:48,210 --> 00:23:52,710
accounts again I'm<font color="#CCCCCC"> looking at I've</font>

505
00:23:49,980 --> 00:23:54,720
tagged<font color="#E5E5E5"> account management creation and</font>

506
00:23:52,710 --> 00:23:57,179
then I'm pulling<font color="#CCCCCC"> in the information</font><font color="#E5E5E5"> that</font>

507
00:23:54,720 --> 00:23:59,220
I want<font color="#E5E5E5"> or sorting it however I want</font><font color="#CCCCCC"> and</font>

508
00:23:57,179 --> 00:24:00,960
<font color="#CCCCCC">that</font><font color="#E5E5E5"> will pull in whatever somebody</font>

509
00:23:59,220 --> 00:24:02,250
creates an account<font color="#E5E5E5"> on the firewall</font><font color="#CCCCCC"> so</font>

510
00:24:00,960 --> 00:24:04,400
<font color="#E5E5E5">many creates account in the database</font>

511
00:24:02,250 --> 00:24:06,299
<font color="#E5E5E5">someone creates an account in</font><font color="#CCCCCC"> Windows or</font>

512
00:24:04,400 --> 00:24:09,960
<font color="#CCCCCC">interactive directory or whatever</font><font color="#E5E5E5"> it's</font>

513
00:24:06,299 --> 00:24:10,918
gonna grab<font color="#CCCCCC"> all those here</font><font color="#E5E5E5"> a couple other</font>

514
00:24:09,960 --> 00:24:13,980
<font color="#E5E5E5">examples</font>

515
00:24:10,919 --> 00:24:15,150
this is URL filtering<font color="#E5E5E5"> so we have URL</font>

516
00:24:13,980 --> 00:24:18,179
filtering logs that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> from different</font>

517
00:24:15,150 --> 00:24:19,470
<font color="#E5E5E5">vendors I want them all and they're in</font>

518
00:24:18,179 --> 00:24:22,049
<font color="#CCCCCC">different data centers and</font><font color="#E5E5E5"> I want them</font>

519
00:24:19,470 --> 00:24:25,500
all correlated<font color="#E5E5E5"> together so the top one</font>

520
00:24:22,049 --> 00:24:28,918
there I've got I'm sorting it according

521
00:24:25,500 --> 00:24:30,929
to on the y-axis<font color="#CCCCCC"> I've got users X</font><font color="#E5E5E5"> access</font>

522
00:24:28,919 --> 00:24:33,510
<font color="#E5E5E5">count I'm looking for stuff that has a</font>

523
00:24:30,929 --> 00:24:35,450
lot of count and<font color="#CCCCCC"> very</font><font color="#E5E5E5"> few users so I'm</font>

524
00:24:33,510 --> 00:24:38,720
I'm looking<font color="#E5E5E5"> for things</font><font color="#CCCCCC"> that look</font>

525
00:24:35,450 --> 00:24:41,039
anomalous<font color="#E5E5E5"> there the bottom</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> I've got</font>

526
00:24:38,720 --> 00:24:44,970
potential beaconing so I'm looking for

527
00:24:41,039 --> 00:24:47,100
things<font color="#E5E5E5"> that are URL queries that I'm</font>

528
00:24:44,970 --> 00:24:49,020
<font color="#E5E5E5">looking at the Delta between epoch time</font>

529
00:24:47,100 --> 00:24:52,350
I'm using<font color="#CCCCCC"> epoch time and I'm looking</font><font color="#E5E5E5"> at</font>

530
00:24:49,020 --> 00:24:54,330
a<font color="#CCCCCC"> delta to determine something</font><font color="#E5E5E5"> that's</font>

531
00:24:52,350 --> 00:24:56,610
making the same request over<font color="#E5E5E5"> and over</font>

532
00:24:54,330 --> 00:24:57,809
<font color="#E5E5E5">and over again and again the useful</font>

533
00:24:56,610 --> 00:24:59,668
thing about this<font color="#CCCCCC"> is I'm doing</font><font color="#E5E5E5"> this</font>

534
00:24:57,809 --> 00:25:03,570
across all of<font color="#E5E5E5"> my URL filtering logs</font>

535
00:24:59,669 --> 00:25:05,880
which<font color="#E5E5E5"> are different vendors here are</font>

536
00:25:03,570 --> 00:25:07,980
some resources<font color="#CCCCCC"> I'm gonna post the I'm</font>

537
00:25:05,880 --> 00:25:10,200
gonna<font color="#E5E5E5"> post the slides so you don't need</font>

538
00:25:07,980 --> 00:25:12,900
to<font color="#CCCCCC"> record all that</font><font color="#E5E5E5"> the bottom one</font><font color="#CCCCCC"> is my</font>

539
00:25:10,200 --> 00:25:14,340
<font color="#CCCCCC">favorite pcre test for not screwing up</font>

540
00:25:12,900 --> 00:25:19,440
your regex

541
00:25:14,340 --> 00:25:22,080
every<font color="#CCCCCC"> Linux Mac OS has it so any</font>

542
00:25:19,440 --> 00:25:24,840
questions<font color="#E5E5E5"> if you do contact me any</font>

543
00:25:22,080 --> 00:25:29,480
questions right now<font color="#E5E5E5"> I kind</font><font color="#CCCCCC"> of blew</font>

544
00:25:24,840 --> 00:25:29,480
through it<font color="#E5E5E5"> but</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> thanks</font>

