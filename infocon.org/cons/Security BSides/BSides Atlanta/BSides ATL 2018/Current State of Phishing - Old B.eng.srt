1
00:00:02,870 --> 00:00:07,200
like you said we're talking<font color="#CCCCCC"> about the</font>

2
00:00:05,069 --> 00:00:10,290
<font color="#E5E5E5">current state of fishing and basically</font>

3
00:00:07,200 --> 00:00:13,799
same old tactics but new tricks<font color="#E5E5E5"> back</font>

4
00:00:10,290 --> 00:00:16,049
<font color="#E5E5E5">though moving on</font>

5
00:00:13,799 --> 00:00:19,109
I meant to take<font color="#E5E5E5"> me broad out but it</font>

6
00:00:16,049 --> 00:00:20,070
seems like<font color="#CCCCCC"> that state from the</font>

7
00:00:19,109 --> 00:00:22,039
University of Tennessee<font color="#CCCCCC"> at Chattanooga</font>

8
00:00:20,070 --> 00:00:25,198
got a little over two years<font color="#CCCCCC"> ago</font>

9
00:00:22,039 --> 00:00:27,869
<font color="#E5E5E5">previously worked at portunity and I did</font>

10
00:00:25,199 --> 00:00:29,730
a lot of<font color="#E5E5E5"> compliance worth a PCI HIPAA</font>

11
00:00:27,869 --> 00:00:31,619
<font color="#E5E5E5">and I also worked in a sock for several</font>

12
00:00:29,730 --> 00:00:34,710
months<font color="#CCCCCC"> so got</font><font color="#E5E5E5"> some awesome experience</font>

13
00:00:31,619 --> 00:00:36,420
I'm currently penetration tester<font color="#E5E5E5"> rapid7</font>

14
00:00:34,710 --> 00:00:41,930
working out of<font color="#E5E5E5"> our Austin Texas office</font>

15
00:00:36,420 --> 00:00:45,360
<font color="#E5E5E5">and I enjoy bringing things you guys I'm</font>

16
00:00:41,930 --> 00:00:47,220
David Thewlis<font color="#E5E5E5"> senior penetration tester</font>

17
00:00:45,360 --> 00:00:49,470
portunity<font color="#CCCCCC"> you</font><font color="#E5E5E5"> are in there for about two</font>

18
00:00:47,220 --> 00:00:57,619
and<font color="#E5E5E5"> a half years at the Philadelphia</font>

19
00:00:49,470 --> 00:00:57,619
office<font color="#CCCCCC"> I also graduated</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> conceited</font>

20
00:01:03,290 --> 00:01:16,650
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> alright alright</font><font color="#E5E5E5"> so on this time</font>

21
00:01:15,090 --> 00:01:19,020
he's coming<font color="#E5E5E5"> in towards penetration</font>

22
00:01:16,650 --> 00:01:20,700
testers<font color="#CCCCCC"> I'm not a luteum Aaron he's</font><font color="#E5E5E5"> not</font>

23
00:01:19,020 --> 00:01:25,740
looting there<font color="#E5E5E5"> we don't</font><font color="#CCCCCC"> know a whole lot</font>

24
00:01:20,700 --> 00:01:27,150
about the defense but<font color="#E5E5E5"> just kind of want</font>

25
00:01:25,740 --> 00:01:29,070
<font color="#CCCCCC">to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about some</font><font color="#E5E5E5"> steps that you can</font>

26
00:01:27,150 --> 00:01:31,050
take in your<font color="#CCCCCC"> fishery in vain to increase</font>

27
00:01:29,070 --> 00:01:32,229
the effectiveness of the<font color="#CCCCCC"> campaign</font><font color="#E5E5E5"> and</font>

28
00:01:31,050 --> 00:01:34,090
obviously<font color="#E5E5E5"> none of</font>

29
00:01:32,230 --> 00:01:35,380
ticks are going to be<font color="#E5E5E5"> working</font><font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> of</font>

30
00:01:34,090 --> 00:01:36,760
<font color="#CCCCCC">the time</font><font color="#E5E5E5"> it's going to be different</font>

31
00:01:35,380 --> 00:01:39,460
<font color="#CCCCCC">every</font><font color="#E5E5E5"> network it's going to be different</font>

32
00:01:36,760 --> 00:01:40,990
<font color="#CCCCCC">on</font><font color="#E5E5E5"> the technologies on the network</font><font color="#CCCCCC"> these</font>

33
00:01:39,460 --> 00:01:45,179
<font color="#E5E5E5">are techniques that have</font><font color="#CCCCCC"> worked for</font><font color="#E5E5E5"> both</font>

34
00:01:40,990 --> 00:01:45,179
of us in<font color="#CCCCCC"> the past with a lot</font><font color="#E5E5E5"> of success</font>

35
00:01:46,470 --> 00:01:51,700
so the game is<font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> a changing lately</font>

36
00:01:49,930 --> 00:02:00,100
I think<font color="#CCCCCC"> it's changing a paper about</font><font color="#E5E5E5"> the</font>

37
00:01:51,700 --> 00:02:02,500
blue team yeah so<font color="#CCCCCC"> you're as the 29</font>

38
00:02:00,100 --> 00:02:03,970
<font color="#CCCCCC">recent layers of Defense are we as</font>

39
00:02:02,500 --> 00:02:08,110
penetration testers<font color="#E5E5E5"> have to practice</font>

40
00:02:03,970 --> 00:02:10,590
offense in depth<font color="#CCCCCC"> for each stage of the</font>

41
00:02:08,110 --> 00:02:12,580
<font color="#CCCCCC">issue campaign you know there are</font>

42
00:02:10,590 --> 00:02:13,900
<font color="#CCCCCC">detected measures where they said</font><font color="#E5E5E5"> are</font>

43
00:02:12,580 --> 00:02:15,820
measures<font color="#E5E5E5"> that</font><font color="#CCCCCC"> were black they live in</font>

44
00:02:13,900 --> 00:02:18,370
place of you as a penetration tester

45
00:02:15,820 --> 00:02:20,829
<font color="#E5E5E5">after bypass each one of those for a</font>

46
00:02:18,370 --> 00:02:23,640
successful campaign<font color="#E5E5E5"> often not knowing</font>

47
00:02:20,830 --> 00:02:26,770
even what what technologies are<font color="#E5E5E5"> in place</font>

48
00:02:23,640 --> 00:02:31,119
<font color="#CCCCCC">you know tailor your campaign</font><font color="#E5E5E5"> for the</font>

49
00:02:26,770 --> 00:02:32,740
network you're<font color="#E5E5E5"> targeting yeah it's</font>

50
00:02:31,120 --> 00:02:33,790
really just an endless<font color="#E5E5E5"> game of</font><font color="#CCCCCC"> cat</font><font color="#E5E5E5"> and</font>

51
00:02:32,740 --> 00:02:35,530
<font color="#E5E5E5">mouse</font>

52
00:02:33,790 --> 00:02:37,840
you know<font color="#E5E5E5"> especially with you know cloud</font>

53
00:02:35,530 --> 00:02:41,380
mail providers<font color="#CCCCCC"> like Microsoft</font><font color="#E5E5E5"> Office 365</font>

54
00:02:37,840 --> 00:02:43,980
G suite mail<font color="#E5E5E5"> sharing threat intelligence</font>

55
00:02:41,380 --> 00:02:46,900
<font color="#CCCCCC">in certain industries</font>

56
00:02:43,980 --> 00:02:49,899
<font color="#CCCCCC">metal attached with sandboxing static</font>

57
00:02:46,900 --> 00:02:54,310
and dynamic analysis<font color="#CCCCCC"> of</font><font color="#E5E5E5"> tax office</font>

58
00:02:49,900 --> 00:02:56,560
macros browser protections<font color="#CCCCCC"> cloudy a</font>

59
00:02:54,310 --> 00:02:58,959
<font color="#CCCCCC">minor</font><font color="#E5E5E5"> solutions that sort of thing is</font>

60
00:02:56,560 --> 00:03:03,820
<font color="#CCCCCC">really shifting in my opinion in favor</font>

61
00:02:58,959 --> 00:03:05,150
of blue team<font color="#E5E5E5"> yeah following these two</font>

62
00:03:03,820 --> 00:03:08,209
guys on

63
00:03:05,150 --> 00:03:11,360
tuning out fishing campaigns<font color="#CCCCCC"> everyday</font>

64
00:03:08,209 --> 00:03:13,519
<font color="#CCCCCC">I've had my</font><font color="#E5E5E5"> phishing campaign tweeted</font>

65
00:03:11,360 --> 00:03:15,260
out by<font color="#E5E5E5"> these</font><font color="#CCCCCC"> facts before which i</font><font color="#E5E5E5"> think</font>

66
00:03:13,519 --> 00:03:17,870
is really<font color="#E5E5E5"> cool because smaller</font>

67
00:03:15,260 --> 00:03:20,659
organizations which may not have the

68
00:03:17,870 --> 00:03:22,430
resources<font color="#CCCCCC"> for a full routine</font><font color="#E5E5E5"> or a</font>

69
00:03:20,659 --> 00:03:24,109
full-time<font color="#E5E5E5"> team are getting these</font>

70
00:03:22,430 --> 00:03:26,180
<font color="#E5E5E5">protections without even knowing it like</font>

71
00:03:24,110 --> 00:03:30,379
I can send<font color="#CCCCCC"> out I can send</font><font color="#E5E5E5"> a phishing</font>

72
00:03:26,180 --> 00:03:32,390
campaign at<font color="#E5E5E5"> 10 a.m. and noon it's argued</font>

73
00:03:30,379 --> 00:03:34,670
on<font color="#E5E5E5"> Twitter and the client didn't even</font>

74
00:03:32,390 --> 00:03:40,790
know you know that<font color="#E5E5E5"> they</font><font color="#CCCCCC"> had this</font>

75
00:03:34,670 --> 00:03:42,230
connection with<font color="#CCCCCC"> office 365</font><font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> did</font>

76
00:03:40,790 --> 00:03:45,849
they put a lot of protection<font color="#CCCCCC"> in place</font>

77
00:03:42,230 --> 00:03:49,310
this<font color="#E5E5E5"> is kind of generic Microsoft ATP</font>

78
00:03:45,849 --> 00:03:51,768
how it works like<font color="#CCCCCC"> mat evil goes in this</font>

79
00:03:49,310 --> 00:03:58,700
stuff comes out<font color="#E5E5E5"> but they are doing</font><font color="#CCCCCC"> a</font>

80
00:03:51,769 --> 00:04:01,250
<font color="#E5E5E5">better job in my</font><font color="#CCCCCC"> opinion so kind</font><font color="#E5E5E5"> of to</font>

81
00:03:58,700 --> 00:04:03,140
<font color="#E5E5E5">start talking about beginning of every</font>

82
00:04:01,250 --> 00:04:05,450
good fishing campaign<font color="#E5E5E5"> we're not going</font><font color="#CCCCCC"> to</font>

83
00:04:03,140 --> 00:04:07,608
talk in depth about<font color="#CCCCCC"> Osen building</font>

84
00:04:05,450 --> 00:04:09,888
<font color="#CCCCCC">pretext</font><font color="#E5E5E5"> but we didn't want to touch on</font>

85
00:04:07,609 --> 00:04:12,500
it because it's obviously a huge<font color="#CCCCCC"> part of</font>

86
00:04:09,889 --> 00:04:14,769
a phishing campaign so here you see we

87
00:04:12,500 --> 00:04:17,269
we<font color="#CCCCCC"> just did some basic stuff the</font>

88
00:04:14,769 --> 00:04:19,120
<font color="#CCCCCC">far-right</font><font color="#E5E5E5"> slide we're using something</font>

89
00:04:17,269 --> 00:04:22,550
<font color="#E5E5E5">that we call Google dorks so basically</font>

90
00:04:19,120 --> 00:04:24,800
you<font color="#E5E5E5"> can do semi advanced filtering for</font>

91
00:04:22,550 --> 00:04:26,780
<font color="#E5E5E5">websites subdomains and you can see</font>

92
00:04:24,800 --> 00:04:29,300
<font color="#E5E5E5">they're all I've done</font><font color="#CCCCCC"> is I'm searching</font>

93
00:04:26,780 --> 00:04:31,549
for Atlantic GA gov and I'm filtering

94
00:04:29,300 --> 00:04:33,710
<font color="#CCCCCC">out all the WW so maybe you find some</font>

95
00:04:31,550 --> 00:04:35,900
<font color="#E5E5E5">interesting subdomains</font><font color="#CCCCCC"> this is part of</font>

96
00:04:33,710 --> 00:04:37,880
when you're building<font color="#CCCCCC"> what you're looking</font>

97
00:04:35,900 --> 00:04:41,448
for in<font color="#CCCCCC"> terms</font><font color="#E5E5E5"> of a pretext maybe cloning</font>

98
00:04:37,880 --> 00:04:43,460
a centrally<font color="#E5E5E5"> authenticating portal some</font>

99
00:04:41,449 --> 00:04:46,849
other very<font color="#CCCCCC"> useful things for subdomain</font>

100
00:04:43,460 --> 00:04:48,859
<font color="#E5E5E5">enumeration attack the target as a</font>

101
00:04:46,849 --> 00:04:52,030
search function<font color="#E5E5E5"> also a very useful API</font>

102
00:04:48,860 --> 00:04:53,740
as you can see as well as virustotal

103
00:04:52,030 --> 00:04:56,979
the years has some awesome<font color="#E5E5E5"> subdomain</font>

104
00:04:53,740 --> 00:05:00,180
numeration so another<font color="#E5E5E5"> reason I put this</font>

105
00:04:56,980 --> 00:05:02,230
is not just<font color="#E5E5E5"> for</font><font color="#CCCCCC"> euro cent or your</font>

106
00:05:00,180 --> 00:05:04,200
<font color="#CCCCCC">subdomain</font><font color="#E5E5E5"> enumeration</font><font color="#CCCCCC"> whenever you're</font>

107
00:05:02,230 --> 00:05:06,460
starting<font color="#E5E5E5"> a campaign but it's also about</font>

108
00:05:04,200 --> 00:05:09,070
<font color="#E5E5E5">evaluating the maturity of who your</font>

109
00:05:06,460 --> 00:05:11,049
target is David just<font color="#CCCCCC"> got done talking</font>

110
00:05:09,070 --> 00:05:12,909
about<font color="#E5E5E5"> the fence in depth but something</font>

111
00:05:11,050 --> 00:05:14,530
<font color="#E5E5E5">that you can tell</font><font color="#CCCCCC"> very quickly</font><font color="#E5E5E5"> about an</font>

112
00:05:12,910 --> 00:05:17,650
organization<font color="#E5E5E5"> when I'm starting</font><font color="#CCCCCC"> an</font>

113
00:05:14,530 --> 00:05:19,239
assessment I can<font color="#E5E5E5"> visit some of the some</font>

114
00:05:17,650 --> 00:05:22,479
of some<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> subdomains that stand out</font>

115
00:05:19,240 --> 00:05:25,320
the<font color="#CCCCCC"> most to me like Citrix or OA</font><font color="#E5E5E5"> and if</font>

116
00:05:22,480 --> 00:05:27,040
they have multi-factor authentication

117
00:05:25,320 --> 00:05:28,659
implemented and that<font color="#E5E5E5"> tells me something</font>

118
00:05:27,040 --> 00:05:31,210
<font color="#CCCCCC">about their maturity just to make</font>

119
00:05:28,660 --> 00:05:34,660
general assumptions when you're<font color="#E5E5E5"> starting</font>

120
00:05:31,210 --> 00:05:35,979
<font color="#E5E5E5">your campaign so the first thing we're</font>

121
00:05:34,660 --> 00:05:38,260
going<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about is domain</font>

122
00:05:35,980 --> 00:05:41,080
categorization<font color="#CCCCCC"> and just to give a brief</font>

123
00:05:38,260 --> 00:05:43,000
summary<font color="#E5E5E5"> of</font><font color="#CCCCCC"> what that is it's a third</font>

124
00:05:41,080 --> 00:05:45,909
<font color="#CCCCCC">party solution that is going to filter</font>

125
00:05:43,000 --> 00:05:48,850
<font color="#CCCCCC">resolution of domain</font><font color="#E5E5E5"> names based on a</font>

126
00:05:45,910 --> 00:05:50,590
<font color="#CCCCCC">pre signed</font><font color="#E5E5E5"> category or</font><font color="#CCCCCC"> in association</font>

127
00:05:48,850 --> 00:05:56,230
with<font color="#CCCCCC"> a pre site category</font><font color="#E5E5E5"> that you don't</font>

128
00:05:50,590 --> 00:05:58,210
want your<font color="#E5E5E5"> users viewing</font><font color="#CCCCCC"> so it</font><font color="#E5E5E5"> basically</font>

129
00:05:56,230 --> 00:06:01,330
it's like whitelist blacklist type thing

130
00:05:58,210 --> 00:06:03,370
if domain has<font color="#E5E5E5"> been visited and has a</font>

131
00:06:01,330 --> 00:06:05,830
<font color="#CCCCCC">reputation of being</font><font color="#E5E5E5"> for news</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> it's</font>

132
00:06:03,370 --> 00:06:07,870
<font color="#E5E5E5">categorized as business or news and if</font>

133
00:06:05,830 --> 00:06:09,460
you want to allow<font color="#CCCCCC"> your users to visit</font>

134
00:06:07,870 --> 00:06:10,900
<font color="#E5E5E5">business websites then you can let them</font>

135
00:06:09,460 --> 00:06:13,000
do that<font color="#E5E5E5"> through domain categorization</font>

136
00:06:10,900 --> 00:06:16,989
<font color="#E5E5E5">and filter</font><font color="#CCCCCC"> out potentially unwanted</font>

137
00:06:13,000 --> 00:06:18,970
domains<font color="#CCCCCC"> but the next</font><font color="#E5E5E5"> thing I want to</font>

138
00:06:16,990 --> 00:06:21,130
<font color="#CCCCCC">note is with preparation categorization</font>

139
00:06:18,970 --> 00:06:25,510
<font color="#E5E5E5">for your fishing domain easily be</font>

140
00:06:21,130 --> 00:06:26,860
obtained prior<font color="#E5E5E5"> to the assessment for</font>

141
00:06:25,510 --> 00:06:30,400
categorization a lot of<font color="#E5E5E5"> third-party</font>

142
00:06:26,860 --> 00:06:32,380
<font color="#E5E5E5">solutions tell buyers big companies that</font>

143
00:06:30,400 --> 00:06:34,060
this is a manual process<font color="#E5E5E5"> somehow we have</font>

144
00:06:32,380 --> 00:06:35,440
tons of employees<font color="#CCCCCC"> that are sifting</font>

145
00:06:34,060 --> 00:06:36,439
through all of these<font color="#E5E5E5"> sites to verify</font>

146
00:06:35,440 --> 00:06:39,919
that<font color="#CCCCCC"> they're okay</font>

147
00:06:36,439 --> 00:06:41,869
<font color="#E5E5E5">users that's</font><font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> not the case it's a</font>

148
00:06:39,919 --> 00:06:43,279
lot of<font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> solutions do this in</font>

149
00:06:41,869 --> 00:06:45,949
an automated<font color="#CCCCCC"> fashion they're filtering</font>

150
00:06:43,279 --> 00:06:48,469
for<font color="#E5E5E5"> keywords so I can clone a website</font>

151
00:06:45,949 --> 00:06:51,229
<font color="#E5E5E5">throw it up submit it to the</font><font color="#CCCCCC"> ten popular</font>

152
00:06:48,469 --> 00:06:54,019
domain categorization solutions and then

153
00:06:51,229 --> 00:06:58,369
get it categorized as<font color="#E5E5E5"> finance or medical</font>

154
00:06:54,019 --> 00:06:59,839
and also<font color="#E5E5E5"> we'll touch on in a second</font>

155
00:06:58,369 --> 00:07:01,309
specific solutions can often be

156
00:06:59,839 --> 00:07:05,559
determined<font color="#E5E5E5"> prior to the assessments</font>

157
00:07:01,309 --> 00:07:07,629
alone<font color="#CCCCCC"> here's just a list of some</font>

158
00:07:05,559 --> 00:07:09,860
resources<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can use to check</font>

159
00:07:07,629 --> 00:07:11,360
categorization of maybe a domain<font color="#E5E5E5"> that</font>

160
00:07:09,860 --> 00:07:13,369
you're currently using<font color="#CCCCCC"> for phishing or</font>

161
00:07:11,360 --> 00:07:15,110
<font color="#CCCCCC">something like that</font><font color="#E5E5E5"> but a lot of the</font>

162
00:07:13,369 --> 00:07:16,759
third-party<font color="#E5E5E5"> solutions have these online</font>

163
00:07:15,110 --> 00:07:18,709
<font color="#E5E5E5">resources where I can just go check</font>

164
00:07:16,759 --> 00:07:20,929
we're having<font color="#E5E5E5"> an</font><font color="#CCCCCC"> X force right</font><font color="#E5E5E5"> now what</font>

165
00:07:18,709 --> 00:07:24,529
my<font color="#E5E5E5"> efficient domains categorized as for</font>

166
00:07:20,929 --> 00:07:25,909
with<font color="#CCCCCC"> blue</font><font color="#E5E5E5"> code or any of those</font><font color="#CCCCCC"> where you</font>

167
00:07:24,529 --> 00:07:27,739
<font color="#E5E5E5">can get</font><font color="#CCCCCC"> it categorize yourself</font><font color="#E5E5E5"> like I</font>

168
00:07:25,909 --> 00:07:30,169
mentioned<font color="#E5E5E5"> you can just sort</font><font color="#CCCCCC"> of it a</font>

169
00:07:27,739 --> 00:07:31,789
categorization request<font color="#E5E5E5"> like normal</font>

170
00:07:30,169 --> 00:07:34,639
<font color="#E5E5E5">people do with their sites that one</font><font color="#CCCCCC"> may</font>

171
00:07:31,789 --> 00:07:36,860
<font color="#CCCCCC">confuse filters so you can do a simple</font>

172
00:07:34,639 --> 00:07:38,959
<font color="#E5E5E5">recursive</font><font color="#CCCCCC"> W get clone somebody else's</font>

173
00:07:36,860 --> 00:07:40,459
site<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> remember to take out all</font>

174
00:07:38,959 --> 00:07:41,209
the copyrighted material or<font color="#CCCCCC"> anything</font>

175
00:07:40,459 --> 00:07:44,839
<font color="#E5E5E5">that's going to get you in trouble</font>

176
00:07:41,209 --> 00:07:46,129
<font color="#E5E5E5">that's the tedious part</font><font color="#CCCCCC"> or you can</font><font color="#E5E5E5"> just</font>

177
00:07:44,839 --> 00:07:48,579
build<font color="#E5E5E5"> your own template that's</font><font color="#CCCCCC"> probably</font>

178
00:07:46,129 --> 00:07:50,990
the safest<font color="#E5E5E5"> way to avoid legal issues and</font>

179
00:07:48,579 --> 00:07:52,849
if it has<font color="#E5E5E5"> the right keywords and it's</font>

180
00:07:50,990 --> 00:07:54,529
kind<font color="#CCCCCC"> of pretty it's probably gonna get</font>

181
00:07:52,849 --> 00:07:56,329
categorized and then<font color="#E5E5E5"> it'll make it</font>

182
00:07:54,529 --> 00:07:59,329
through to make<font color="#E5E5E5"> that accusation filters</font>

183
00:07:56,329 --> 00:08:01,819
also<font color="#E5E5E5"> something that's important is age</font>

184
00:07:59,329 --> 00:08:06,619
of the domain<font color="#E5E5E5"> and we'll talk</font><font color="#CCCCCC"> about that</font>

185
00:08:01,819 --> 00:08:08,869
<font color="#CCCCCC">in a second</font><font color="#E5E5E5"> so if you're kind of lazy</font>

186
00:08:06,619 --> 00:08:11,569
<font color="#CCCCCC">and you don't want to</font><font color="#E5E5E5"> do a little work</font>

187
00:08:08,869 --> 00:08:13,390
<font color="#CCCCCC">ahead of your campaign you can just use</font>

188
00:08:11,569 --> 00:08:16,600
expired domains that are

189
00:08:13,390 --> 00:08:19,990
categorizations<font color="#CCCCCC"> so domain that's existed</font>

190
00:08:16,600 --> 00:08:22,240
for maybe<font color="#CCCCCC"> 1 5 or even</font><font color="#E5E5E5"> 10 20 years</font><font color="#CCCCCC"> this</font>

191
00:08:19,990 --> 00:08:24,640
resource expired domains<font color="#E5E5E5"> keeps track of</font>

192
00:08:22,240 --> 00:08:26,200
all that<font color="#CCCCCC"> and will aggregate</font><font color="#E5E5E5"> this</font>

193
00:08:24,640 --> 00:08:28,419
information<font color="#E5E5E5"> and you can you</font><font color="#CCCCCC"> can see</font>

194
00:08:26,200 --> 00:08:30,729
there's some super useful<font color="#E5E5E5"> search search</font>

195
00:08:28,420 --> 00:08:33,940
functionality and filter based<font color="#E5E5E5"> on the</font>

196
00:08:30,730 --> 00:08:36,640
TLD<font color="#E5E5E5"> you can output this however you want</font>

197
00:08:33,940 --> 00:08:38,380
<font color="#CCCCCC">to do it</font><font color="#E5E5E5"> and so basically this might not</font>

198
00:08:36,640 --> 00:08:39,880
<font color="#E5E5E5">last forever but if you're doing a quick</font>

199
00:08:38,380 --> 00:08:42,250
<font color="#CCCCCC">and pane you can buy their maintenance</font>

200
00:08:39,880 --> 00:08:44,740
expire<font color="#CCCCCC"> that already has a large amount</font>

201
00:08:42,250 --> 00:08:46,900
<font color="#CCCCCC">of</font><font color="#E5E5E5"> presentation based on age and content</font>

202
00:08:44,740 --> 00:08:49,120
<font color="#E5E5E5">that they've posted and use this for</font>

203
00:08:46,900 --> 00:08:55,870
<font color="#E5E5E5">your campaign so there's some more</font>

204
00:08:49,120 --> 00:08:58,780
<font color="#E5E5E5">search functionality and also</font><font color="#CCCCCC"> it'll give</font>

205
00:08:55,870 --> 00:09:00,730
any<font color="#CCCCCC"> an Alexa ranking or also</font><font color="#E5E5E5"> search</font>

206
00:08:58,780 --> 00:09:02,560
similar web and give you statistics on

207
00:09:00,730 --> 00:09:04,360
that<font color="#CCCCCC"> so some</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> useful way to filter</font>

208
00:09:02,560 --> 00:09:07,930
out<font color="#E5E5E5"> expired domains that might be</font>

209
00:09:04,360 --> 00:09:09,340
interested in<font color="#E5E5E5"> so this is this is what it</font>

210
00:09:07,930 --> 00:09:11,459
looks like<font color="#E5E5E5"> whenever you're looking up</font>

211
00:09:09,340 --> 00:09:13,900
what the categorization<font color="#E5E5E5"> of</font><font color="#CCCCCC"> your</font>

212
00:09:11,460 --> 00:09:15,700
potential<font color="#E5E5E5"> fishing domain might be</font>

213
00:09:13,900 --> 00:09:17,560
whenever<font color="#E5E5E5"> you purchased your domain that</font>

214
00:09:15,700 --> 00:09:19,630
<font color="#E5E5E5">you've thrown up a continuity purchased</font>

215
00:09:17,560 --> 00:09:22,390
your<font color="#CCCCCC"> expire domain</font><font color="#E5E5E5"> in there our new</font>

216
00:09:19,630 --> 00:09:24,939
category<font color="#E5E5E5"> categorizes something you're</font>

217
00:09:22,390 --> 00:09:27,460
<font color="#E5E5E5">gonna want</font><font color="#CCCCCC"> to go find out</font><font color="#E5E5E5"> what solution</font>

218
00:09:24,940 --> 00:09:28,750
your targets using<font color="#E5E5E5"> often you can find</font>

219
00:09:27,460 --> 00:09:30,730
that on<font color="#E5E5E5"> LinkedIn just look up the</font>

220
00:09:28,750 --> 00:09:33,520
<font color="#E5E5E5">security people</font><font color="#CCCCCC"> and see what experience</font>

221
00:09:30,730 --> 00:09:36,400
they have often<font color="#E5E5E5"> will say I'm experienced</font>

222
00:09:33,520 --> 00:09:39,040
in implementing blue code<font color="#CCCCCC"> technology so</font>

223
00:09:36,400 --> 00:09:41,650
then targeted<font color="#E5E5E5"> Symantec's</font><font color="#CCCCCC"> Bluecoat</font>

224
00:09:39,040 --> 00:09:42,790
solution<font color="#E5E5E5"> and this is actually a phishing</font>

225
00:09:41,650 --> 00:09:44,470
domain that<font color="#CCCCCC"> i've used on several</font>

226
00:09:42,790 --> 00:09:46,689
engagements<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I've</font><font color="#E5E5E5"> learned some</font><font color="#CCCCCC"> of it</font>

227
00:09:44,470 --> 00:09:47,880
out<font color="#CCCCCC"> but you can see this</font><font color="#E5E5E5"> probably took</font>

228
00:09:46,690 --> 00:09:51,780
an hour<font color="#E5E5E5"> about three requests</font>

229
00:09:47,880 --> 00:09:54,270
<font color="#E5E5E5">that and I recursively</font><font color="#CCCCCC"> Club recursively</font>

230
00:09:51,780 --> 00:09:55,920
<font color="#E5E5E5">W get</font><font color="#CCCCCC"> cloned a site that's financial</font>

231
00:09:54,270 --> 00:09:57,900
related scrape out some stuff<font color="#CCCCCC"> that's</font>

232
00:09:55,920 --> 00:10:01,589
copyrighted<font color="#E5E5E5"> and three days later</font><font color="#CCCCCC"> on</font>

233
00:09:57,900 --> 00:10:03,150
categorizes<font color="#E5E5E5"> financial services and one</font>

234
00:10:01,590 --> 00:10:06,330
thing that<font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> touch on really</font>

235
00:10:03,150 --> 00:10:11,069
<font color="#E5E5E5">quick about categorization</font><font color="#CCCCCC"> in specific</font>

236
00:10:06,330 --> 00:10:13,560
categories<font color="#CCCCCC"> is more than just</font><font color="#E5E5E5"> bypassing</font>

237
00:10:11,070 --> 00:10:16,560
domain categorization<font color="#E5E5E5"> prevention methods</font>

238
00:10:13,560 --> 00:10:18,329
<font color="#E5E5E5">if you</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> categorize it as financial or</font>

239
00:10:16,560 --> 00:10:20,609
medical there's a really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> chance</font>

240
00:10:18,330 --> 00:10:23,750
that<font color="#E5E5E5"> you will there's something called</font>

241
00:10:20,610 --> 00:10:27,240
<font color="#E5E5E5">HTTP inspection and often there's rules</font>

242
00:10:23,750 --> 00:10:29,340
that can<font color="#E5E5E5"> be implemented that break HTTP</font>

243
00:10:27,240 --> 00:10:32,430
connections to do content<font color="#CCCCCC"> inspection and</font>

244
00:10:29,340 --> 00:10:34,200
based on<font color="#E5E5E5"> your categorization often they</font>

245
00:10:32,430 --> 00:10:37,199
will<font color="#CCCCCC"> omit breaking that connection</font>

246
00:10:34,200 --> 00:10:38,610
<font color="#E5E5E5">because</font><font color="#CCCCCC"> the informations financial or</font>

247
00:10:37,200 --> 00:10:41,580
medical related<font color="#E5E5E5"> and that breaks a ton</font><font color="#CCCCCC"> of</font>

248
00:10:38,610 --> 00:10:43,500
laws most likely so if you are<font color="#E5E5E5"> lucky</font>

249
00:10:41,580 --> 00:10:45,060
enough<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be categorized</font><font color="#E5E5E5"> as financial or</font>

250
00:10:43,500 --> 00:10:50,160
medical there's a lot of benefits that

251
00:10:45,060 --> 00:10:51,989
come along<font color="#CCCCCC"> with that as well and just</font>

252
00:10:50,160 --> 00:10:55,160
<font color="#E5E5E5">like I'm into the second ago we have</font>

253
00:10:51,990 --> 00:11:00,570
some this<font color="#CCCCCC"> is literally a screenshot from</font>

254
00:10:55,160 --> 00:11:03,480
<font color="#E5E5E5">LinkedIn you guys remember this is you</font>

255
00:11:00,570 --> 00:11:05,580
can see some super useful information we

256
00:11:03,480 --> 00:11:07,590
see the<font color="#E5E5E5"> quite a bit</font><font color="#CCCCCC"> nine technology so I</font>

257
00:11:05,580 --> 00:11:11,130
don't look for stuff<font color="#CCCCCC"> that carbon black</font>

258
00:11:07,590 --> 00:11:14,190
does because they were<font color="#CCCCCC"> required Cisco</font>

259
00:11:11,130 --> 00:11:17,280
<font color="#CCCCCC">ISE we see by</font><font color="#E5E5E5"> our eyes so when I'm</font>

260
00:11:14,190 --> 00:11:19,260
<font color="#E5E5E5">testing my payloads</font><font color="#CCCCCC"> I I have a sandbox</font>

261
00:11:17,280 --> 00:11:21,209
<font color="#E5E5E5">or something that will run against fire</font>

262
00:11:19,260 --> 00:11:23,640
<font color="#CCCCCC">I off automatically go make</font><font color="#E5E5E5"> that and</font>

263
00:11:21,210 --> 00:11:26,040
also<font color="#CCCCCC"> I see web since email and web</font>

264
00:11:23,640 --> 00:11:27,930
security gateways<font color="#CCCCCC"> so I know immediately</font>

265
00:11:26,040 --> 00:11:33,660
how I need<font color="#E5E5E5"> to tailor when I deliver my</font>

266
00:11:27,930 --> 00:11:35,910
<font color="#E5E5E5">payload so getting into actually first</font>

267
00:11:33,660 --> 00:11:39,000
<font color="#E5E5E5">purchasing your domain one of the oldest</font>

268
00:11:35,910 --> 00:11:40,230
but still most popular is just tricking

269
00:11:39,000 --> 00:11:42,540
the user with something that's often

270
00:11:40,230 --> 00:11:43,690
<font color="#CCCCCC">referred to as Type O squatting I think</font>

271
00:11:42,540 --> 00:11:45,430
it's pretty<font color="#CCCCCC"> some explaining</font>

272
00:11:43,690 --> 00:11:48,070
<font color="#CCCCCC">and spend too much time explaining it</font>

273
00:11:45,430 --> 00:11:50,500
<font color="#E5E5E5">but you can see this tool called URL</font>

274
00:11:48,070 --> 00:11:53,020
crazy<font color="#E5E5E5"> is just doing super simple things</font>

275
00:11:50,500 --> 00:11:55,090
like<font color="#E5E5E5"> character omission</font><font color="#CCCCCC"> character repeat</font>

276
00:11:53,020 --> 00:11:57,010
character swap and if you look at<font color="#E5E5E5"> that</font>

277
00:11:55,090 --> 00:11:59,530
<font color="#E5E5E5">list of domains on the right from the</font>

278
00:11:57,010 --> 00:12:01,360
original Atlanta GA gov<font color="#E5E5E5"> like you really</font>

279
00:11:59,530 --> 00:12:03,339
have to squint at it<font color="#E5E5E5"> before you</font><font color="#CCCCCC"> realize</font>

280
00:12:01,360 --> 00:12:06,370
what character<font color="#E5E5E5"> it's missing</font><font color="#CCCCCC"> replace</font>

281
00:12:03,340 --> 00:12:08,680
submitted and at<font color="#E5E5E5"> first glance when</font>

282
00:12:06,370 --> 00:12:11,500
somebody gets<font color="#E5E5E5"> an email from like your</font>

283
00:12:08,680 --> 00:12:13,390
boss at that<font color="#CCCCCC"> debate or dog work or</font>

284
00:12:11,500 --> 00:12:14,770
<font color="#E5E5E5">whatever you might not look twice at it</font>

285
00:12:13,390 --> 00:12:17,560
you might<font color="#E5E5E5"> just be like oh my god my boss</font>

286
00:12:14,770 --> 00:12:19,210
just<font color="#E5E5E5"> emailed me</font><font color="#CCCCCC"> and I'm fired if I don't</font>

287
00:12:17,560 --> 00:12:21,849
do this thing<font color="#E5E5E5"> I need</font><font color="#CCCCCC"> to do right</font><font color="#E5E5E5"> that</font>

288
00:12:19,210 --> 00:12:23,440
<font color="#E5E5E5">simple typos Bonnie's still super</font>

289
00:12:21,850 --> 00:12:28,210
popular<font color="#CCCCCC"> there's a lot of</font><font color="#E5E5E5"> awesome tools</font>

290
00:12:23,440 --> 00:12:31,240
to do<font color="#CCCCCC"> it so</font><font color="#E5E5E5"> now I'm going to talk</font><font color="#CCCCCC"> about</font>

291
00:12:28,210 --> 00:12:33,850
something<font color="#CCCCCC"> called</font><font color="#E5E5E5"> puny</font><font color="#CCCCCC"> coding which</font><font color="#E5E5E5"> is a</font>

292
00:12:31,240 --> 00:12:36,070
solution<font color="#CCCCCC"> for</font><font color="#E5E5E5"> internationalized of things</font>

293
00:12:33,850 --> 00:12:37,900
<font color="#E5E5E5">and when I say internationalized domains</font>

294
00:12:36,070 --> 00:12:39,550
basically all I mean is<font color="#CCCCCC"> the domain that</font>

295
00:12:37,900 --> 00:12:43,300
consists in the character<font color="#E5E5E5"> that's outside</font>

296
00:12:39,550 --> 00:12:44,740
<font color="#CCCCCC">the ASCII</font><font color="#E5E5E5"> subset so like a through Z its</font>

297
00:12:43,300 --> 00:12:46,390
standard characters that you see<font color="#E5E5E5"> every</font>

298
00:12:44,740 --> 00:12:48,580
<font color="#E5E5E5">day so if you have a domain</font><font color="#CCCCCC"> that has</font>

299
00:12:46,390 --> 00:12:50,830
like a Mandarin character or a Latin

300
00:12:48,580 --> 00:12:53,230
character or a Cyrillic character that

301
00:12:50,830 --> 00:12:55,210
would fall in the<font color="#E5E5E5"> category of</font><font color="#CCCCCC"> IBM or</font>

302
00:12:53,230 --> 00:12:56,950
internationalized domain and the weight

303
00:12:55,210 --> 00:12:58,840
DNS works<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to</font>

304
00:12:56,950 --> 00:13:01,360
<font color="#CCCCCC">represent that and just</font><font color="#E5E5E5"> ASCII characters</font>

305
00:12:58,840 --> 00:13:03,340
simply<font color="#CCCCCC"> easy so their solution was</font>

306
00:13:01,360 --> 00:13:05,410
something called<font color="#E5E5E5"> puny coding and you can</font>

307
00:13:03,340 --> 00:13:09,250
see right<font color="#CCCCCC"> here</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> third bullet I</font>

308
00:13:05,410 --> 00:13:13,660
show<font color="#E5E5E5"> my character in red which is a</font>

309
00:13:09,250 --> 00:13:17,020
Cyrillic<font color="#CCCCCC"> I at the mixer link and it's P</font>

310
00:13:13,660 --> 00:13:20,230
decoding<font color="#CCCCCC"> County</font><font color="#E5E5E5"> counterpart so the</font><font color="#CCCCCC"> X in</font>

311
00:13:17,020 --> 00:13:22,180
-<font color="#E5E5E5"> - Bank of America</font><font color="#CCCCCC"> B</font><font color="#E5E5E5"> 5 B that's the</font>

312
00:13:20,230 --> 00:13:22,710
community coded representation of the

313
00:13:22,180 --> 00:13:25,319
<font color="#E5E5E5">Internet</font>

314
00:13:22,710 --> 00:13:27,150
<font color="#CCCCCC">last images</font><font color="#E5E5E5"> on the left</font><font color="#CCCCCC"> and I put the</font>

315
00:13:25,320 --> 00:13:29,040
regular<font color="#E5E5E5"> Bank of America site right below</font>

316
00:13:27,150 --> 00:13:32,340
<font color="#CCCCCC">that just to</font><font color="#E5E5E5"> show how similar the Pew</font>

317
00:13:29,040 --> 00:13:34,650
decoding<font color="#E5E5E5"> of the regular version look so</font>

318
00:13:32,340 --> 00:13:36,690
you<font color="#E5E5E5"> can see here like you get creative</font>

319
00:13:34,650 --> 00:13:39,600
with your characters<font color="#E5E5E5"> you can buy some</font>

320
00:13:36,690 --> 00:13:41,720
pretty terrifying domains with cutie

321
00:13:39,600 --> 00:13:41,720
kitty

322
00:13:43,260 --> 00:13:48,600
so<font color="#CCCCCC"> PD coding isn't</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> just like black</font>

323
00:13:46,530 --> 00:13:50,970
magic<font color="#CCCCCC"> there this is a</font><font color="#E5E5E5"> very for a while</font>

324
00:13:48,600 --> 00:13:53,100
and<font color="#E5E5E5"> there are a lot</font><font color="#CCCCCC"> of there's a</font><font color="#E5E5E5"> lot of</font>

325
00:13:50,970 --> 00:13:56,520
protective<font color="#CCCCCC"> measures</font><font color="#E5E5E5"> already implemented</font>

326
00:13:53,100 --> 00:13:59,130
<font color="#E5E5E5">that you might not know about</font><font color="#CCCCCC"> I have</font>

327
00:13:56,520 --> 00:14:02,430
links here<font color="#CCCCCC"> to both chromium</font><font color="#E5E5E5"> or chrome</font>

328
00:13:59,130 --> 00:14:04,890
uses and muscle<font color="#CCCCCC"> of Firefox</font><font color="#E5E5E5"> is algorithms</font>

329
00:14:02,430 --> 00:14:06,630
to<font color="#E5E5E5"> try to protect against this but</font>

330
00:14:04,890 --> 00:14:11,340
<font color="#CCCCCC">basically those algorithms just consists</font>

331
00:14:06,630 --> 00:14:13,439
of character combinations like chromium

332
00:14:11,340 --> 00:14:15,390
assumes if you're using a<font color="#CCCCCC"> latin</font>

333
00:14:13,440 --> 00:14:17,460
character<font color="#E5E5E5"> in a domain that also has</font>

334
00:14:15,390 --> 00:14:19,410
regular<font color="#CCCCCC"> English characters you</font><font color="#E5E5E5"> might be</font>

335
00:14:17,460 --> 00:14:20,730
<font color="#CCCCCC">doing something suspicious so basically</font>

336
00:14:19,410 --> 00:14:22,740
what they're<font color="#E5E5E5"> going to do is you can see</font>

337
00:14:20,730 --> 00:14:25,530
here<font color="#E5E5E5"> in this gift when you type in the</font>

338
00:14:22,740 --> 00:14:28,170
<font color="#CCCCCC">domain</font><font color="#E5E5E5"> it's gonna on what I call what</font>

339
00:14:25,530 --> 00:14:29,970
most people call and raveling to the

340
00:14:28,170 --> 00:14:32,280
full<font color="#E5E5E5"> page</font><font color="#CCCCCC"> coded format so there are some</font>

341
00:14:29,970 --> 00:14:34,530
some protections built in a few<font color="#CCCCCC"> mill</font>

342
00:14:32,280 --> 00:14:38,280
clients do the same thing but<font color="#E5E5E5"> not often</font>

343
00:14:34,530 --> 00:14:40,470
like the<font color="#E5E5E5"> outlook regular client like</font><font color="#CCCCCC"> a</font>

344
00:14:38,280 --> 00:14:42,870
<font color="#E5E5E5">desktop</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> unnoticed doesn't unravel</font>

345
00:14:40,470 --> 00:14:44,850
a lot of domains<font color="#E5E5E5"> but a lot of</font><font color="#CCCCCC"> web-based</font>

346
00:14:42,870 --> 00:14:48,500
<font color="#E5E5E5">clients do so it's hit</font><font color="#CCCCCC"> or miss something</font>

347
00:14:44,850 --> 00:14:48,500
<font color="#CCCCCC">yet the testifier campaign</font>

348
00:14:52,850 --> 00:14:57,150
infrastructure<font color="#E5E5E5"> that you need</font><font color="#CCCCCC"> to set up</font>

349
00:14:54,600 --> 00:15:00,630
or a successful<font color="#CCCCCC"> campaign to</font><font color="#E5E5E5"> make sure</font>

350
00:14:57,150 --> 00:15:02,760
that your<font color="#E5E5E5"> your</font><font color="#CCCCCC"> mail is getting delivered</font>

351
00:15:00,630 --> 00:15:03,779
and then if the<font color="#E5E5E5"> phishing campaign is</font>

352
00:15:02,760 --> 00:15:07,379
detected that it's not

353
00:15:03,779 --> 00:15:09,300
<font color="#E5E5E5">that previous or future</font><font color="#CCCCCC"> phishing</font>

354
00:15:07,379 --> 00:15:11,249
campaigns<font color="#E5E5E5"> so when I'm setting up the</font>

355
00:15:09,300 --> 00:15:13,589
<font color="#CCCCCC">campaigns I have to follow you know</font>

356
00:15:11,249 --> 00:15:15,959
segregating the assets based on function

357
00:15:13,589 --> 00:15:17,939
<font color="#E5E5E5">you don't want to have one server doing</font>

358
00:15:15,959 --> 00:15:19,739
all your sending mail all hosting

359
00:15:17,939 --> 00:15:22,110
payloads we see you in callbacks<font color="#CCCCCC"> you</font>

360
00:15:19,740 --> 00:15:24,600
want to<font color="#E5E5E5"> segregate based on asset to make</font>

361
00:15:22,110 --> 00:15:27,899
sure that you know if I'm<font color="#CCCCCC"> mail is</font>

362
00:15:24,600 --> 00:15:29,579
detected<font color="#CCCCCC"> by</font><font color="#E5E5E5"> the blue team</font><font color="#CCCCCC"> that the rest</font>

363
00:15:27,899 --> 00:15:31,139
of<font color="#CCCCCC"> the campaign can</font><font color="#E5E5E5"> go on you can</font>

364
00:15:29,579 --> 00:15:33,329
continue<font color="#E5E5E5"> campaign and you're not going</font>

365
00:15:31,139 --> 00:15:37,740
to lose any access is obtained for

366
00:15:33,329 --> 00:15:40,819
<font color="#E5E5E5">previous campaigns it also</font><font color="#CCCCCC"> oppose</font><font color="#E5E5E5"> the</font>

367
00:15:37,740 --> 00:15:43,199
idea<font color="#E5E5E5"> of setting up a redirector between</font>

368
00:15:40,819 --> 00:15:45,240
what the what the target is<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> see</font>

369
00:15:43,199 --> 00:15:47,550
<font color="#CCCCCC">and then on in their</font><font color="#E5E5E5"> logs and your</font>

370
00:15:45,240 --> 00:15:49,529
back-end servers so that<font color="#E5E5E5"> you only</font><font color="#CCCCCC"> you</font>

371
00:15:47,550 --> 00:15:51,240
<font color="#E5E5E5">only need one back-end server and your</font>

372
00:15:49,529 --> 00:15:55,639
redirect<font color="#E5E5E5"> users can be spun</font><font color="#CCCCCC"> up or spun</font>

373
00:15:51,240 --> 00:15:58,019
down throughout<font color="#E5E5E5"> the</font><font color="#CCCCCC"> fish'</font><font color="#E5E5E5"> campaign so</font>

374
00:15:55,639 --> 00:15:59,790
requirements for our<font color="#E5E5E5"> infrastructure to</font>

375
00:15:58,019 --> 00:16:02,430
make sure that<font color="#E5E5E5"> we've got the best chance</font>

376
00:15:59,790 --> 00:16:04,230
possible<font color="#E5E5E5"> in our mail delivered we want</font>

377
00:16:02,430 --> 00:16:05,670
<font color="#CCCCCC">harder our</font><font color="#E5E5E5"> mail server to work as</font>

378
00:16:04,230 --> 00:16:08,610
legitimate as possible so we're going to

379
00:16:05,670 --> 00:16:10,800
<font color="#E5E5E5">implement some protection</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> some</font>

380
00:16:08,610 --> 00:16:14,730
cement configuration such as send a

381
00:16:10,800 --> 00:16:17,459
policy framework<font color="#CCCCCC"> DKIM</font><font color="#E5E5E5"> be more</font><font color="#CCCCCC"> active to</font>

382
00:16:14,730 --> 00:16:18,389
<font color="#CCCCCC">make our mail server look legitimate you</font>

383
00:16:17,459 --> 00:16:21,809
know<font color="#CCCCCC"> we're gonna</font><font color="#E5E5E5"> need to set some</font>

384
00:16:18,389 --> 00:16:24,240
reverse DNS records we're going to say

385
00:16:21,809 --> 00:16:25,140
<font color="#CCCCCC">anything make</font><font color="#E5E5E5"> sure</font><font color="#CCCCCC"> our the domain we're</font>

386
00:16:24,240 --> 00:16:27,600
sending the mail

387
00:16:25,140 --> 00:16:30,329
and IP address of the mail server<font color="#E5E5E5"> is in</font>

388
00:16:27,600 --> 00:16:31,649
good<font color="#E5E5E5"> standing</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> any black lists and of</font>

389
00:16:30,329 --> 00:16:33,660
course we also want to make sure that

390
00:16:31,649 --> 00:16:35,760
<font color="#E5E5E5">all our data to and</font><font color="#CCCCCC"> from these servers</font>

391
00:16:33,660 --> 00:16:38,430
is encrypted<font color="#CCCCCC"> what I want to make sure</font>

392
00:16:35,760 --> 00:16:40,800
that the<font color="#E5E5E5"> servers are watching down the</font>

393
00:16:38,430 --> 00:16:44,029
vile wall to<font color="#E5E5E5"> make sure that no one can</font>

394
00:16:40,800 --> 00:16:47,300
know<font color="#CCCCCC"> inspect our expect our servers and</font>

395
00:16:44,029 --> 00:16:47,300
<font color="#CCCCCC">it's in</font><font color="#E5E5E5"> trouble</font>

396
00:16:48,290 --> 00:16:54,540
so back<font color="#CCCCCC"> into fishing server</font><font color="#E5E5E5"> usually</font>

397
00:16:51,870 --> 00:16:57,600
<font color="#E5E5E5">gonna run some kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> framework like I</font>

398
00:16:54,540 --> 00:16:59,610
used<font color="#E5E5E5"> to fish was fishing frenzy yes</font>

399
00:16:57,600 --> 00:17:01,890
<font color="#E5E5E5">especially in toolkit people can use I</font>

400
00:16:59,610 --> 00:17:04,020
<font color="#CCCCCC">just prefer</font><font color="#E5E5E5"> go fish the server is not</font>

401
00:17:01,890 --> 00:17:06,150
<font color="#E5E5E5">supposed</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be visible to the defender</font>

402
00:17:04,020 --> 00:17:09,660
so<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> they're not ever going to see</font>

403
00:17:06,150 --> 00:17:11,790
this server it's<font color="#CCCCCC"> going to be static</font>

404
00:17:09,660 --> 00:17:14,040
throughout the campaign will be

405
00:17:11,790 --> 00:17:18,928
redirecting all our mail in relays to

406
00:17:14,040 --> 00:17:20,668
<font color="#CCCCCC">mask the origin of this children its I</font>

407
00:17:18,929 --> 00:17:22,380
use that script right there<font color="#E5E5E5"> just set up</font>

408
00:17:20,669 --> 00:17:24,630
do a lot of<font color="#E5E5E5"> a good thing</font><font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> install</font>

409
00:17:22,380 --> 00:17:27,360
<font color="#CCCCCC">all the</font><font color="#E5E5E5"> postfix and don't cost service</font>

410
00:17:24,630 --> 00:17:29,820
<font color="#E5E5E5">it'll stall</font><font color="#CCCCCC"> go fish it gives you the</font>

411
00:17:27,359 --> 00:17:31,559
<font color="#CCCCCC">brown</font><font color="#E5E5E5"> cube and I</font><font color="#CCCCCC"> Redmond weather</font>

412
00:17:29,820 --> 00:17:33,270
<font color="#CCCCCC">interfaces for managing the mail server</font>

413
00:17:31,559 --> 00:17:35,370
<font color="#E5E5E5">and sending the mail</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> just makes the</font>

414
00:17:33,270 --> 00:17:36,780
whole<font color="#CCCCCC"> process</font><font color="#E5E5E5"> really easy because if</font>

415
00:17:35,370 --> 00:17:41,969
you've<font color="#CCCCCC"> ever a configure the mail server</font>

416
00:17:36,780 --> 00:17:44,639
it's not fun so<font color="#CCCCCC"> we're gonna be sending</font>

417
00:17:41,970 --> 00:17:48,640
<font color="#CCCCCC">them in from the back end to this SMTP</font>

418
00:17:44,640 --> 00:17:50,860
directory and it's<font color="#E5E5E5"> really</font><font color="#CCCCCC"> just a</font>

419
00:17:48,640 --> 00:17:52,870
it needs to make sure<font color="#CCCCCC"> that you're</font>

420
00:17:50,860 --> 00:17:56,530
stripping<font color="#E5E5E5"> certain headers from the</font>

421
00:17:52,870 --> 00:17:58,629
messages<font color="#CCCCCC"> that</font><font color="#E5E5E5"> indicates the location of</font>

422
00:17:56,530 --> 00:18:01,920
the<font color="#CCCCCC"> back-end server to the expert in</font>

423
00:17:58,630 --> 00:18:06,750
1890<font color="#E5E5E5"> the XML</font><font color="#CCCCCC"> or the mind version are all</font>

424
00:18:01,920 --> 00:18:06,750
tells<font color="#E5E5E5"> where our back-end server could be</font>

425
00:18:08,160 --> 00:18:14,020
<font color="#CCCCCC">ministry</font><font color="#E5E5E5"> to make sure they're all</font>

426
00:18:12,400 --> 00:18:15,550
pointing to this<font color="#E5E5E5"> redirect you don't want</font>

427
00:18:14,020 --> 00:18:19,720
them don't want<font color="#CCCCCC"> to accidentally point</font><font color="#E5E5E5"> it</font>

428
00:18:15,550 --> 00:18:21,700
to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> backend</font><font color="#E5E5E5"> fishing server and like I</font>

429
00:18:19,720 --> 00:18:23,140
said<font color="#E5E5E5"> easy to spin out easy to spin down</font>

430
00:18:21,700 --> 00:18:25,210
you send five<font color="#E5E5E5"> messages with one</font>

431
00:18:23,140 --> 00:18:27,070
redirector killing you spend up another

432
00:18:25,210 --> 00:18:28,690
five more messages and they're not gonna

433
00:18:27,070 --> 00:18:30,700
be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to easily correlate the two</font>

434
00:18:28,690 --> 00:18:35,620
<font color="#E5E5E5">campaigns just</font><font color="#CCCCCC"> based on</font><font color="#E5E5E5"> where</font><font color="#CCCCCC"> they came</font>

435
00:18:30,700 --> 00:18:38,050
from<font color="#CCCCCC"> and I'm</font><font color="#E5E5E5"> asking you found that when</font>

436
00:18:35,620 --> 00:18:41,020
you're targeting<font color="#E5E5E5"> cloud mail providers</font>

437
00:18:38,050 --> 00:18:42,820
like office 365<font color="#CCCCCC"> Virgie suite</font><font color="#E5E5E5"> that</font>

438
00:18:41,020 --> 00:18:45,429
they're you know they're<font color="#E5E5E5"> not if you just</font>

439
00:18:42,820 --> 00:18:47,010
<font color="#CCCCCC">spin up a server</font><font color="#E5E5E5"> on AWS and start</font>

440
00:18:45,429 --> 00:18:48,940
<font color="#E5E5E5">sending mail</font><font color="#CCCCCC"> to people with office 365</font>

441
00:18:47,010 --> 00:18:52,600
<font color="#CCCCCC">it's probably not going to make it</font>

442
00:18:48,940 --> 00:18:54,400
through because<font color="#E5E5E5"> office 365 is obviously</font>

443
00:18:52,600 --> 00:18:56,020
receiving a lot of mail so if they see

444
00:18:54,400 --> 00:18:57,640
mail coming<font color="#E5E5E5"> from an IP address they've</font>

445
00:18:56,020 --> 00:19:00,220
never seen before<font color="#CCCCCC"> they're going to</font>

446
00:18:57,640 --> 00:19:02,260
assume it's spam so I<font color="#E5E5E5"> like to send it</font>

447
00:19:00,220 --> 00:19:04,360
<font color="#CCCCCC">through</font><font color="#E5E5E5"> third-party readers I like the</font>

448
00:19:02,260 --> 00:19:06,340
<font color="#CCCCCC">shine</font><font color="#E5E5E5"> greater amount done that you send</font>

449
00:19:04,360 --> 00:19:07,809
thousands<font color="#E5E5E5"> of messages for free you don't</font>

450
00:19:06,340 --> 00:19:10,840
<font color="#E5E5E5">even have to pay</font>

451
00:19:07,809 --> 00:19:12,490
provides really cool rewrite the<font color="#E5E5E5"> links</font>

452
00:19:10,840 --> 00:19:14,919
for you<font color="#CCCCCC"> to let ascend</font><font color="#E5E5E5"> grow over time and</font>

453
00:19:12,490 --> 00:19:16,210
<font color="#E5E5E5">then link which you</font><font color="#CCCCCC"> can track who</font>

454
00:19:14,920 --> 00:19:19,750
actually<font color="#E5E5E5"> clicks on the links</font>

455
00:19:16,210 --> 00:19:25,630
it'll track who opens the mail<font color="#E5E5E5"> and it's</font>

456
00:19:19,750 --> 00:19:27,429
just it<font color="#CCCCCC"> makes it</font><font color="#E5E5E5"> pretty easy for me yeah</font>

457
00:19:25,630 --> 00:19:30,550
the<font color="#E5E5E5"> senate-passed framework</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> new</font>

458
00:19:27,429 --> 00:19:31,130
<font color="#CCCCCC">mic record should all be all</font><font color="#E5E5E5"> plain to</font>

459
00:19:30,550 --> 00:19:33,799
the<font color="#CCCCCC"> third</font>

460
00:19:31,130 --> 00:19:40,039
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> redirected because the</font><font color="#CCCCCC"> mail is</font>

461
00:19:33,799 --> 00:19:41,690
coming from the<font color="#E5E5E5"> relay and this is you</font>

462
00:19:40,039 --> 00:19:42,950
test the legitimacy of<font color="#CCCCCC"> your mail server</font>

463
00:19:41,690 --> 00:19:45,980
<font color="#CCCCCC">to</font><font color="#E5E5E5"> make sure that you can make your</font>

464
00:19:42,950 --> 00:19:48,350
everything properly<font color="#CCCCCC"> that makes an extra</font>

465
00:19:45,980 --> 00:19:49,700
box and mail tests are the two<font color="#CCCCCC"> right</font>

466
00:19:48,350 --> 00:19:51,320
going to<font color="#E5E5E5"> make sure that I didn't</font>

467
00:19:49,700 --> 00:19:53,990
accidentally<font color="#E5E5E5"> miss configure anything</font>

468
00:19:51,320 --> 00:19:56,059
<font color="#E5E5E5">that would indicate that our server is</font>

469
00:19:53,990 --> 00:19:57,620
<font color="#CCCCCC">not a backing tape</font><font color="#E5E5E5"> and it can also be</font>

470
00:19:56,059 --> 00:20:00,590
<font color="#CCCCCC">helpful</font><font color="#E5E5E5"> sometimes to</font><font color="#CCCCCC"> just send a test</font>

471
00:19:57,620 --> 00:20:02,780
message to a non-existent<font color="#E5E5E5"> address at the</font>

472
00:20:00,590 --> 00:20:05,330
target if you get a bounce<font color="#CCCCCC"> back</font><font color="#E5E5E5"> you can</font>

473
00:20:02,780 --> 00:20:07,700
sometimes<font color="#E5E5E5"> tell I know if the message</font>

474
00:20:05,330 --> 00:20:10,250
<font color="#E5E5E5">made it to a mailbox</font><font color="#CCCCCC"> that was filtered</font>

475
00:20:07,700 --> 00:20:12,020
<font color="#E5E5E5">upstream or maybe you know sometimes</font>

476
00:20:10,250 --> 00:20:18,080
<font color="#CCCCCC">even</font><font color="#E5E5E5"> protective technologies they have</font>

477
00:20:12,020 --> 00:20:20,389
<font color="#CCCCCC">in</font><font color="#E5E5E5"> place so</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> have the infrastructure</font>

478
00:20:18,080 --> 00:20:23,600
we've got the demand no need<font color="#E5E5E5"> to pay like</font>

479
00:20:20,390 --> 00:20:25,370
to send you know<font color="#E5E5E5"> capturing login</font>

480
00:20:23,600 --> 00:20:27,379
credentials with<font color="#E5E5E5"> glowing pages is cool</font>

481
00:20:25,370 --> 00:20:28,760
it works a lot but with wide

482
00:20:27,380 --> 00:20:31,039
implementations of multi-factor

483
00:20:28,760 --> 00:20:33,200
authentication<font color="#CCCCCC"> it's getting more</font><font color="#E5E5E5"> and</font>

484
00:20:31,039 --> 00:20:35,030
<font color="#CCCCCC">more difficult to try and capture</font>

485
00:20:33,200 --> 00:20:37,940
<font color="#CCCCCC">incentive potentials into internal</font>

486
00:20:35,030 --> 00:20:41,000
network access so you can<font color="#E5E5E5"> get you</font>

487
00:20:37,940 --> 00:20:43,220
somewhere<font color="#CCCCCC"> but</font><font color="#E5E5E5"> usually we</font><font color="#CCCCCC"> really want to</font>

488
00:20:41,000 --> 00:20:45,500
<font color="#E5E5E5">send a payload to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> target it's going</font>

489
00:20:43,220 --> 00:20:48,590
to give<font color="#E5E5E5"> us execution on that</font><font color="#CCCCCC"> machine</font><font color="#E5E5E5"> and</font>

490
00:20:45,500 --> 00:20:50,539
you can't just send you know resume<font color="#CCCCCC"> dot</font>

491
00:20:48,590 --> 00:20:53,299
<font color="#CCCCCC">dot exe</font><font color="#E5E5E5"> because if you send</font><font color="#CCCCCC"> then the</font>

492
00:20:50,539 --> 00:21:00,980
executable<font color="#E5E5E5"> email it's you're gonna have</font>

493
00:20:53,299 --> 00:21:03,620
a bad<font color="#CCCCCC"> time yeah we're talking about</font><font color="#E5E5E5"> I'll</font>

494
00:21:00,980 --> 00:21:06,080
<font color="#CCCCCC">write</font><font color="#E5E5E5"> about office documents</font><font color="#CCCCCC"> some of</font>

495
00:21:03,620 --> 00:21:09,100
these other special payloads that we've

496
00:21:06,080 --> 00:21:09,100
been experimenting with

497
00:21:09,630 --> 00:21:14,000
<font color="#E5E5E5">we're gonna team here you know this</font><font color="#CCCCCC"> is</font>

498
00:21:11,700 --> 00:21:16,620
<font color="#CCCCCC">kind of</font><font color="#E5E5E5"> up to you this is kind</font><font color="#CCCCCC"> of up to</font>

499
00:21:14,000 --> 00:21:19,950
you know what<font color="#CCCCCC"> kind of protective</font>

500
00:21:16,620 --> 00:21:23,489
measures<font color="#CCCCCC"> are in place</font><font color="#E5E5E5"> the motor is the</font>

501
00:21:19,950 --> 00:21:26,039
classic<font color="#E5E5E5"> a lot of work with</font><font color="#CCCCCC"> Michelle</font>

502
00:21:23,490 --> 00:21:28,559
<font color="#E5E5E5">Empire which is a 1% powerful nation on</font>

503
00:21:26,039 --> 00:21:30,840
access<font color="#CCCCCC"> to rule if you have a reason to</font>

504
00:21:28,559 --> 00:21:33,178
<font color="#E5E5E5">suspect that you</font><font color="#CCCCCC"> know execution of</font>

505
00:21:30,840 --> 00:21:36,990
PowerShell is being blocked<font color="#E5E5E5"> or heavily</font>

506
00:21:33,179 --> 00:21:39,360
<font color="#CCCCCC">logged</font><font color="#E5E5E5"> this schematic jscript where</font><font color="#CCCCCC"> an</font>

507
00:21:36,990 --> 00:21:41,130
access tool is<font color="#E5E5E5"> pretty cool</font><font color="#CCCCCC"> we've got a</font>

508
00:21:39,360 --> 00:21:43,139
lot of<font color="#E5E5E5"> money you</font><font color="#CCCCCC"> know with COBOL</font>

509
00:21:41,130 --> 00:21:45,690
<font color="#CCCCCC">straight but</font><font color="#E5E5E5"> doing the important thing</font>

510
00:21:43,140 --> 00:21:47,789
<font color="#E5E5E5">to know here</font><font color="#CCCCCC"> is that</font><font color="#E5E5E5"> whichever</font><font color="#CCCCCC"> these</font>

511
00:21:45,690 --> 00:21:50,760
<font color="#E5E5E5">issues change the default configuration</font>

512
00:21:47,789 --> 00:21:52,980
<font color="#CCCCCC">because security your vendors are very</font>

513
00:21:50,760 --> 00:21:54,390
good at seeing the default<font color="#E5E5E5"> launcher</font>

514
00:21:52,980 --> 00:21:56,340
<font color="#E5E5E5">they're very good at seeing yet the</font>

515
00:21:54,390 --> 00:22:00,570
<font color="#E5E5E5">default particular executable template</font>

516
00:21:56,340 --> 00:22:02,280
so make sure you change configurations

517
00:22:00,570 --> 00:22:04,820
so<font color="#CCCCCC"> have a</font><font color="#E5E5E5"> summer fun way community does</font>

518
00:22:02,280 --> 00:22:04,820
not<font color="#CCCCCC"> go to waste</font>

519
00:22:05,690 --> 00:22:11,429
I'm a lot of<font color="#E5E5E5"> success with pre-fishing</font>

520
00:22:09,390 --> 00:22:13,770
pants<font color="#CCCCCC"> so it's where I'm</font><font color="#E5E5E5"> sending a</font>

521
00:22:11,429 --> 00:22:16,679
payload<font color="#E5E5E5"> I'm not actually achieving code</font>

522
00:22:13,770 --> 00:22:17,970
execution or remote access on the target

523
00:22:16,679 --> 00:22:20,850
<font color="#CCCCCC">but I'm gathering a lot of information</font>

524
00:22:17,970 --> 00:22:23,100
<font color="#E5E5E5">that a little later in</font><font color="#CCCCCC"> your targeted</font>

525
00:22:20,850 --> 00:22:24,990
<font color="#CCCCCC">attack so if you</font><font color="#E5E5E5"> you know set up</font>

526
00:22:23,100 --> 00:22:27,330
infrastructure with<font color="#CCCCCC"> your directors that</font>

527
00:22:24,990 --> 00:22:29,640
you can easily spin up and spin down<font color="#E5E5E5"> you</font>

528
00:22:27,330 --> 00:22:32,340
could send a hundred<font color="#E5E5E5"> emails to the</font>

529
00:22:29,640 --> 00:22:34,590
client<font color="#E5E5E5"> it's probably gonna get flagged</font>

530
00:22:32,340 --> 00:22:36,750
<font color="#E5E5E5">blocked</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it doesn't matter because</font>

531
00:22:34,590 --> 00:22:39,419
you've already gotten this information

532
00:22:36,750 --> 00:22:42,510
such as the anybody's that using

533
00:22:39,420 --> 00:22:45,210
software<font color="#E5E5E5"> that's installed gathering</font><font color="#CCCCCC"> the</font>

534
00:22:42,510 --> 00:22:48,560
<font color="#E5E5E5">demand use</font><font color="#CCCCCC"> main that you could use for</font>

535
00:22:45,210 --> 00:22:51,120
some kind of encryption<font color="#E5E5E5"> very helpful</font>

536
00:22:48,560 --> 00:22:53,010
<font color="#CCCCCC">testing different expectation that is if</font>

537
00:22:51,120 --> 00:22:55,590
you<font color="#E5E5E5"> actual trade to button categorize</font>

538
00:22:53,010 --> 00:22:57,930
the minions with the<font color="#CCCCCC"> DNS that's all</font><font color="#E5E5E5"> very</font>

539
00:22:55,590 --> 00:23:01,770
helpful<font color="#E5E5E5"> when you're planning the next</font>

540
00:22:57,930 --> 00:23:03,750
<font color="#E5E5E5">phase of your attack and we know for me</font>

541
00:23:01,770 --> 00:23:05,670
when I use you can serve up these

542
00:23:03,750 --> 00:23:08,130
<font color="#CCCCCC">payloads with the patch smartly rights</font>

543
00:23:05,670 --> 00:23:09,480
to serve a random payload<font color="#E5E5E5"> so you can</font>

544
00:23:08,130 --> 00:23:11,400
build you<font color="#CCCCCC"> know five or six different</font>

545
00:23:09,480 --> 00:23:13,050
payloads<font color="#E5E5E5"> to</font><font color="#CCCCCC"> gather certain information</font>

546
00:23:11,400 --> 00:23:14,880
<font color="#CCCCCC">about these machines and if you're</font>

547
00:23:13,050 --> 00:23:16,020
sending<font color="#E5E5E5"> hundred messages you know some</font>

548
00:23:14,880 --> 00:23:17,910
<font color="#CCCCCC">of them are going</font><font color="#E5E5E5"> to get through and</font>

549
00:23:16,020 --> 00:23:20,010
terminated information need to<font color="#E5E5E5"> really</font>

550
00:23:17,910 --> 00:23:25,170
hone in your attack<font color="#CCCCCC"> make sure</font><font color="#E5E5E5"> that it</font>

551
00:23:20,010 --> 00:23:28,290
works and it's not alerted on so office

552
00:23:25,170 --> 00:23:30,720
macros is definitely my favorite<font color="#CCCCCC"> and</font>

553
00:23:28,290 --> 00:23:31,560
<font color="#E5E5E5">I've had the most success</font><font color="#CCCCCC"> with it I'm</font>

554
00:23:30,720 --> 00:23:35,190
going<font color="#E5E5E5"> to talk about a</font><font color="#CCCCCC"> couple of</font>

555
00:23:31,560 --> 00:23:39,000
different<font color="#CCCCCC"> ways of how you</font><font color="#E5E5E5"> can actually</font>

556
00:23:35,190 --> 00:23:41,610
execute arbitrary code yes how easy is

557
00:23:39,000 --> 00:23:44,070
for<font color="#E5E5E5"> defenders to see you know this</font>

558
00:23:41,610 --> 00:23:46,110
because they use for shell just<font color="#E5E5E5"> to open</font>

559
00:23:44,070 --> 00:23:48,300
up writing executables<font color="#E5E5E5"> very suspicious</font>

560
00:23:46,110 --> 00:23:50,159
anybody that's<font color="#E5E5E5"> handed contents of macros</font>

561
00:23:48,300 --> 00:23:54,210
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> melon gateway is going to see</font>

562
00:23:50,160 --> 00:23:56,520
<font color="#E5E5E5">this and alerted this is the second</font>

563
00:23:54,210 --> 00:23:58,140
<font color="#E5E5E5">method of executing processes using</font><font color="#CCCCCC"> WMI</font>

564
00:23:56,520 --> 00:23:59,790
<font color="#E5E5E5">I don't know what go into too</font><font color="#CCCCCC"> much</font>

565
00:23:58,140 --> 00:24:02,400
<font color="#E5E5E5">detail about what this code is doing but</font>

566
00:23:59,790 --> 00:24:04,980
<font color="#CCCCCC">that's not important anything I wanted</font>

567
00:24:02,400 --> 00:24:07,500
<font color="#E5E5E5">to show you here</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we see the</font>

568
00:24:04,980 --> 00:24:10,290
contents of<font color="#E5E5E5"> these strings this is what</font>

569
00:24:07,500 --> 00:24:13,200
this<font color="#E5E5E5"> is what they are not like and it</font>

570
00:24:10,290 --> 00:24:15,720
<font color="#E5E5E5">will spin</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> trade processes with WMI</font>

571
00:24:13,200 --> 00:24:18,360
is suspicious so what<font color="#E5E5E5"> I do and this is</font>

572
00:24:15,720 --> 00:24:20,400
what really well for me is I thought

573
00:24:18,360 --> 00:24:22,139
<font color="#CCCCCC">that data</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> of the back row</font>

574
00:24:20,400 --> 00:24:24,150
<font color="#E5E5E5">and I store it there you can store it in</font>

575
00:24:22,140 --> 00:24:26,610
<font color="#E5E5E5">a document variable and store it in the</font>

576
00:24:24,150 --> 00:24:28,350
<font color="#E5E5E5">body of the document and you</font><font color="#CCCCCC"> can pull</font><font color="#E5E5E5"> it</font>

577
00:24:26,610 --> 00:24:29,850
out in this world<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is notice</font><font color="#E5E5E5"> it</font>

578
00:24:28,350 --> 00:24:32,520
she's the<font color="#E5E5E5"> same thing but without</font><font color="#CCCCCC"> all</font>

579
00:24:29,850 --> 00:24:33,719
those suspicious things in the<font color="#E5E5E5"> in the</font>

580
00:24:32,520 --> 00:24:38,750
macro there in the body<font color="#E5E5E5"> of the document</font>

581
00:24:33,720 --> 00:24:38,750
which obviously is not<font color="#E5E5E5"> and by the way</font>

582
00:24:39,680 --> 00:24:43,950
our<font color="#CCCCCC"> shell is very suspicious</font><font color="#E5E5E5"> you know</font>

583
00:24:42,420 --> 00:24:45,870
<font color="#E5E5E5">even if you don't have a word</font><font color="#CCCCCC"> PowerShell</font>

584
00:24:43,950 --> 00:24:48,410
inside the macro in the body of<font color="#E5E5E5"> the</font>

585
00:24:45,870 --> 00:24:51,120
document the back<font color="#CCCCCC"> fit you know the</font>

586
00:24:48,410 --> 00:24:53,130
office<font color="#CCCCCC"> valuation</font><font color="#E5E5E5"> is spawning</font><font color="#CCCCCC"> my robot</font>

587
00:24:51,120 --> 00:24:55,320
<font color="#CCCCCC">Exe me</font><font color="#E5E5E5"> suspicious so there's a lot of</font>

588
00:24:53,130 --> 00:24:56,820
<font color="#E5E5E5">different you know Microsoft</font><font color="#CCCCCC"> finally</font>

589
00:24:55,320 --> 00:24:59,639
said you know every system that<font color="#CCCCCC"> will</font>

590
00:24:56,820 --> 00:25:01,050
<font color="#E5E5E5">happily execute</font><font color="#CCCCCC"> recovered these</font><font color="#E5E5E5"> are just</font>

591
00:24:59,640 --> 00:25:01,740
some<font color="#E5E5E5"> of the more popular ones with</font>

592
00:25:01,050 --> 00:25:04,080
<font color="#CCCCCC">msbuild</font>

593
00:25:01,740 --> 00:25:06,720
or you can<font color="#CCCCCC"> actually write some dotnet</font>

594
00:25:04,080 --> 00:25:10,560
code compile it and run it<font color="#E5E5E5"> always</font><font color="#CCCCCC"> in the</font>

595
00:25:06,720 --> 00:25:12,630
macro the MSHDA which<font color="#CCCCCC"> I</font><font color="#E5E5E5"> think we were</font>

596
00:25:10,560 --> 00:25:12,960
talking<font color="#E5E5E5"> about in</font><font color="#CCCCCC"> a moment and then you</font>

597
00:25:12,630 --> 00:25:16,410
know

598
00:25:12,960 --> 00:25:23,310
getting a<font color="#CCCCCC"> Windows 15 object to the</font>

599
00:25:16,410 --> 00:25:25,830
register 32 to execute very amazing some

600
00:25:23,310 --> 00:25:27,840
<font color="#E5E5E5">of these the 75 days will actually go</font>

601
00:25:25,830 --> 00:25:29,760
out<font color="#CCCCCC"> and get the tailor for you so you</font>

602
00:25:27,840 --> 00:25:33,000
don't<font color="#E5E5E5"> have to</font><font color="#CCCCCC"> read anything to</font><font color="#E5E5E5"> disk</font><font color="#CCCCCC"> I've</font>

603
00:25:29,760 --> 00:25:35,790
had mixed success with this because<font color="#E5E5E5"> I</font>

604
00:25:33,000 --> 00:25:37,740
think<font color="#CCCCCC"> that America we can dynamically</font>

605
00:25:35,790 --> 00:25:40,560
<font color="#E5E5E5">analyzed it's making network connections</font>

606
00:25:37,740 --> 00:25:43,050
<font color="#CCCCCC">that's immediately suspicious</font><font color="#E5E5E5"> so I</font>

607
00:25:40,560 --> 00:25:44,610
usually have<font color="#E5E5E5"> better luck some of these</font>

608
00:25:43,050 --> 00:25:48,240
local methods where that will actually

609
00:25:44,610 --> 00:25:51,449
<font color="#CCCCCC">you</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> write</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> HTA or that file got</font>

610
00:25:48,240 --> 00:25:52,950
<font color="#CCCCCC">SCT to the file system and</font><font color="#E5E5E5"> then call</font><font color="#CCCCCC"> it</font>

611
00:25:51,450 --> 00:25:55,830
there because<font color="#CCCCCC"> these are I mean these are</font>

612
00:25:52,950 --> 00:25:58,140
this is<font color="#E5E5E5"> XML like the file that SCT is an</font>

613
00:25:55,830 --> 00:25:59,580
XML file<font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> doesn't know what like</font>

614
00:25:58,140 --> 00:26:02,820
it's<font color="#E5E5E5"> not going to find anything bad with</font>

615
00:25:59,580 --> 00:26:09,720
with<font color="#E5E5E5"> XML so I have no worries reading</font>

616
00:26:02,820 --> 00:26:11,760
<font color="#E5E5E5">that to disk this this is probably my</font>

617
00:26:09,720 --> 00:26:14,280
favorite method of executing code inside

618
00:26:11,760 --> 00:26:17,760
macros<font color="#E5E5E5"> because it's not actually</font><font color="#CCCCCC"> calling</font>

619
00:26:14,280 --> 00:26:21,750
<font color="#E5E5E5">W script shell calling and WI it's not</font>

620
00:26:17,760 --> 00:26:29,250
<font color="#E5E5E5">PowerShell unless you strap arbitrary</font>

621
00:26:21,750 --> 00:26:31,020
code and paste it or<font color="#CCCCCC"> VB script this</font><font color="#E5E5E5"> is</font>

622
00:26:29,250 --> 00:26:32,970
kind of what the macros<font color="#E5E5E5"> megabyte</font><font color="#CCCCCC"> as you</font>

623
00:26:31,020 --> 00:26:35,490
can see this down there that<font color="#CCCCCC"> Sarah</font>

624
00:26:32,970 --> 00:26:37,170
<font color="#E5E5E5">that's the serialized on that object up</font>

625
00:26:35,490 --> 00:26:39,060
there is<font color="#E5E5E5"> where it's being called you're</font>

626
00:26:37,170 --> 00:26:40,860
not seeing any of<font color="#CCCCCC"> those suspicious</font>

627
00:26:39,060 --> 00:26:47,760
strings that a lot of<font color="#E5E5E5"> providers with a</font>

628
00:26:40,860 --> 00:26:50,459
little<font color="#CCCCCC"> Donny this</font><font color="#E5E5E5"> is yeah so pre this</font>

629
00:26:47,760 --> 00:26:53,520
like you need<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have some</font><font color="#CCCCCC"> melon and</font>

630
00:26:50,460 --> 00:26:55,779
<font color="#CCCCCC">dotnet</font><font color="#E5E5E5"> so what I've done</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> worked</font>

631
00:26:53,520 --> 00:26:58,119
very well as<font color="#E5E5E5"> you know you just woke up</font>

632
00:26:55,779 --> 00:27:01,539
<font color="#CCCCCC">shall run base and you</font><font color="#E5E5E5"> can give it</font><font color="#CCCCCC"> just</font>

633
00:26:58,119 --> 00:27:02,769
a<font color="#CCCCCC"> 60/40 hardshell</font><font color="#E5E5E5"> and it will do it will</font>

634
00:27:01,539 --> 00:27:05,379
<font color="#CCCCCC">do that fun stuff but they do that</font>

635
00:27:02,769 --> 00:27:07,539
<font color="#CCCCCC">powers</font><font color="#E5E5E5"> will give you access there's some</font>

636
00:27:05,379 --> 00:27:09,699
links<font color="#E5E5E5"> there just to kind of walk what</font>

637
00:27:07,539 --> 00:27:11,109
<font color="#E5E5E5">the process of how you actually build</font>

638
00:27:09,700 --> 00:27:12,009
these payloads because it's a little<font color="#CCCCCC"> bit</font>

639
00:27:11,109 --> 00:27:14,049
<font color="#E5E5E5">more</font><font color="#CCCCCC"> in-depth and just you know</font>

640
00:27:12,009 --> 00:27:15,879
generating<font color="#CCCCCC"> maturity to launch it you</font>

641
00:27:14,049 --> 00:27:21,219
actually<font color="#CCCCCC"> have to write a little bit code</font>

642
00:27:15,879 --> 00:27:23,289
for<font color="#E5E5E5"> this yeah just want to kind of show</font>

643
00:27:21,219 --> 00:27:25,479
you<font color="#CCCCCC"> guys how to generate the</font><font color="#E5E5E5"> descriptive</font>

644
00:27:23,289 --> 00:27:27,309
object using<font color="#E5E5E5"> that to Jason if</font><font color="#CCCCCC"> you've got</font>

645
00:27:25,479 --> 00:27:28,809
<font color="#E5E5E5">to download it you've got to compile it</font>

646
00:27:27,309 --> 00:27:31,690
but once you do<font color="#CCCCCC"> you can have in</font>

647
00:27:28,809 --> 00:27:33,428
generating be descriptive<font color="#E5E5E5"> BBJ</font><font color="#CCCCCC"> J's bridge</font>

648
00:27:31,690 --> 00:27:37,179
<font color="#E5E5E5">and generated these scripting objects</font>

649
00:27:33,429 --> 00:27:43,089
<font color="#E5E5E5">which which can store in the body of the</font>

650
00:27:37,179 --> 00:27:45,580
document and then this is<font color="#CCCCCC"> just not some</font>

651
00:27:43,089 --> 00:27:49,089
concept code for storing these feelings

652
00:27:45,580 --> 00:27:52,389
<font color="#E5E5E5">inside text fields in the document and I</font>

653
00:27:49,089 --> 00:27:54,489
<font color="#E5E5E5">Cynthia the Z Ron</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> just concatenate</font>

654
00:27:52,389 --> 00:27:58,689
all those strings<font color="#CCCCCC"> that they're used to</font>

655
00:27:54,489 --> 00:28:01,749
<font color="#CCCCCC">execute as payload and this is yeah this</font>

656
00:27:58,690 --> 00:28:03,580
when<font color="#CCCCCC"> I when I tested</font><font color="#E5E5E5"> this and uploaded</font>

657
00:28:01,749 --> 00:28:07,839
<font color="#E5E5E5">it to virus total it's</font><font color="#CCCCCC"> usually it's</font>

658
00:28:03,580 --> 00:28:09,728
usually uninfected<font color="#E5E5E5"> macro infestation can</font>

659
00:28:07,839 --> 00:28:12,158
<font color="#CCCCCC">be helpful</font><font color="#E5E5E5"> depending on the</font><font color="#CCCCCC"> pillar to</font>

660
00:28:09,729 --> 00:28:16,570
execute that I found<font color="#E5E5E5"> that often just</font><font color="#CCCCCC"> the</font>

661
00:28:12,159 --> 00:28:20,109
presence<font color="#E5E5E5"> of you know occupation is a</font>

662
00:28:16,570 --> 00:28:21,750
learning and<font color="#E5E5E5"> unit the macro is</font><font color="#CCCCCC"> benign</font>

663
00:28:20,109 --> 00:28:24,629
<font color="#CCCCCC">just the fact that it you</font><font color="#E5E5E5"> know</font>

664
00:28:21,750 --> 00:28:26,700
like this it's going to be flagged by

665
00:28:24,630 --> 00:28:28,950
some providers<font color="#E5E5E5"> and may not get through</font>

666
00:28:26,700 --> 00:28:31,410
but macro pack is what I usually<font color="#CCCCCC"> use to</font>

667
00:28:28,950 --> 00:28:34,320
connect to to pack and obfuscate the

668
00:28:31,410 --> 00:28:37,440
macro and you<font color="#E5E5E5"> just gonna have</font><font color="#CCCCCC"> to test it</font>

669
00:28:34,320 --> 00:28:39,480
<font color="#E5E5E5">and find</font><font color="#CCCCCC"> something that works some</font>

670
00:28:37,440 --> 00:28:42,450
additional protections about ways to

671
00:28:39,480 --> 00:28:44,730
make<font color="#CCCCCC"> sure my payloads remain undetected</font>

672
00:28:42,450 --> 00:28:48,450
that my servers my control<font color="#E5E5E5"> servers don't</font>

673
00:28:44,730 --> 00:28:51,720
<font color="#E5E5E5">they found</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> got a lot successfully with</font>

674
00:28:48,450 --> 00:28:54,990
<font color="#E5E5E5">Kindle so you've got you know your first</font>

675
00:28:51,720 --> 00:28:58,470
stage of the launcher which will you can

676
00:28:54,990 --> 00:29:00,390
<font color="#CCCCCC">key it environmentally so on the name of</font>

677
00:28:58,470 --> 00:29:03,450
<font color="#CCCCCC">the Active</font><font color="#E5E5E5"> Directory domain the name of</font>

678
00:29:00,390 --> 00:29:05,550
the current<font color="#CCCCCC"> user if you know that or you</font>

679
00:29:03,450 --> 00:29:08,070
know going<font color="#E5E5E5"> out</font><font color="#CCCCCC"> and getting a</font><font color="#E5E5E5"> DNS</font><font color="#CCCCCC"> key or</font>

680
00:29:05,550 --> 00:29:10,200
<font color="#E5E5E5">HTTP decrypting</font><font color="#CCCCCC"> the payload that way</font>

681
00:29:08,070 --> 00:29:12,300
that if you<font color="#CCCCCC"> know John Lambert or</font>

682
00:29:10,200 --> 00:29:14,490
Microsoft<font color="#E5E5E5"> it's all your payload he's not</font>

683
00:29:12,300 --> 00:29:15,930
<font color="#E5E5E5">gonna be able to tell where your fact</font>

684
00:29:14,490 --> 00:29:17,900
and control servers are and your

685
00:29:15,930 --> 00:29:20,460
campaign can continue without

686
00:29:17,900 --> 00:29:22,920
recompiling your malware

687
00:29:20,460 --> 00:29:23,580
I like the sandbox<font color="#E5E5E5"> chats and there it is</font>

688
00:29:22,920 --> 00:29:25,860
<font color="#E5E5E5">again</font>

689
00:29:23,580 --> 00:29:28,560
you know these documents that<font color="#E5E5E5"> you're</font>

690
00:29:25,860 --> 00:29:30,330
<font color="#E5E5E5">sending over to office 365</font>

691
00:29:28,560 --> 00:29:33,300
they're<font color="#E5E5E5"> gonna be executed in a sandbox</font>

692
00:29:30,330 --> 00:29:34,679
<font color="#CCCCCC">and it's it's</font><font color="#E5E5E5"> pretty easy to</font><font color="#CCCCCC"> double your</font>

693
00:29:33,300 --> 00:29:37,100
execute in the sandbox like there's not

694
00:29:34,680 --> 00:29:39,710
<font color="#E5E5E5">a lot</font><font color="#CCCCCC"> computers running on one processor</font>

695
00:29:37,100 --> 00:29:41,300
<font color="#E5E5E5">the people</font><font color="#CCCCCC"> you're targeting</font>

696
00:29:39,710 --> 00:29:43,730
somewhere<font color="#CCCCCC"> install so even just</font><font color="#E5E5E5"> checking</font>

697
00:29:41,300 --> 00:29:45,590
for<font color="#E5E5E5"> the presence of Microsoft Word and</font>

698
00:29:43,730 --> 00:29:47,570
<font color="#E5E5E5">then you know not continuing execution</font>

699
00:29:45,590 --> 00:29:48,860
they don't find it can we do a lot to

700
00:29:47,570 --> 00:29:51,010
protect you player to<font color="#E5E5E5"> make sure you</font>

701
00:29:48,860 --> 00:29:55,010
don't<font color="#E5E5E5"> come they'll keep recompiling</font>

702
00:29:51,010 --> 00:29:56,720
<font color="#E5E5E5">every time</font><font color="#CCCCCC"> and depending on</font><font color="#E5E5E5"> how you send</font>

703
00:29:55,010 --> 00:29:57,470
the document whether<font color="#CCCCCC"> it's an attachment</font>

704
00:29:56,720 --> 00:29:59,780
or<font color="#CCCCCC"> a link</font>

705
00:29:57,470 --> 00:30:03,430
<font color="#E5E5E5">I prefer</font><font color="#CCCCCC"> sending as a</font><font color="#E5E5E5"> lake because then</font>

706
00:29:59,780 --> 00:30:03,430
you can<font color="#E5E5E5"> kinda</font><font color="#CCCCCC"> get</font><font color="#E5E5E5"> more control over</font>

707
00:30:04,510 --> 00:30:09,860
<font color="#E5E5E5">whether they're doing district the</font><font color="#CCCCCC"> IP</font>

708
00:30:06,800 --> 00:30:11,899
<font color="#CCCCCC">based files or if you want to</font><font color="#E5E5E5"> go with</font>

709
00:30:09,860 --> 00:30:14,330
the Apaches<font color="#CCCCCC"> marketing right and actually</font>

710
00:30:11,900 --> 00:30:16,460
you<font color="#CCCCCC"> know what you can look</font><font color="#E5E5E5"> at the the</font>

711
00:30:14,330 --> 00:30:18,500
<font color="#E5E5E5">user agent the IP address is</font><font color="#CCCCCC"> coming from</font>

712
00:30:16,460 --> 00:30:22,010
and you<font color="#CCCCCC"> know if it's an IP address that</font>

713
00:30:18,500 --> 00:30:23,360
<font color="#E5E5E5">belonged</font><font color="#CCCCCC"> to a Microsoft or a pre point</font>

714
00:30:22,010 --> 00:30:25,960
<font color="#E5E5E5">it's probably</font><font color="#CCCCCC"> not going</font><font color="#E5E5E5"> to want to give</font>

715
00:30:23,360 --> 00:30:29,510
them the file<font color="#E5E5E5"> that you're sending it so</font>

716
00:30:25,960 --> 00:30:33,920
yeah look at that<font color="#CCCCCC"> and that</font><font color="#E5E5E5"> was right</font>

717
00:30:29,510 --> 00:30:36,410
there<font color="#E5E5E5"> that's an example of my Apache HD</font>

718
00:30:33,920 --> 00:30:41,270
<font color="#CCCCCC">access file that it's</font><font color="#E5E5E5"> got the IP</font>

719
00:30:36,410 --> 00:30:43,640
addresses<font color="#E5E5E5"> for denying email security</font>

720
00:30:41,270 --> 00:30:48,010
gateways and<font color="#CCCCCC"> if it's coming</font><font color="#E5E5E5"> from that</font>

721
00:30:43,640 --> 00:30:48,010
<font color="#CCCCCC">network it just sends into a payload</font>

722
00:30:50,140 --> 00:30:54,890
<font color="#E5E5E5">okay so Dan you're talking about some</font>

723
00:30:52,910 --> 00:30:56,330
<font color="#CCCCCC">awesome stuff</font><font color="#E5E5E5"> the payloads and I'm going</font>

724
00:30:54,890 --> 00:30:57,860
<font color="#CCCCCC">to talk about a couple more payment</font>

725
00:30:56,330 --> 00:30:59,929
options we have<font color="#E5E5E5"> as attackers and also</font>

726
00:30:57,860 --> 00:31:02,240
one other thing<font color="#E5E5E5"> that I absolutely love</font>

727
00:30:59,930 --> 00:31:06,920
<font color="#CCCCCC">SMB</font><font color="#E5E5E5"> egress testing why</font><font color="#CCCCCC"> though</font>

728
00:31:02,240 --> 00:31:11,270
so basically first just to touch<font color="#E5E5E5"> on what</font>

729
00:31:06,920 --> 00:31:13,460
David<font color="#E5E5E5"> was talking about the you payload</font>

730
00:31:11,270 --> 00:31:16,190
key you could<font color="#E5E5E5"> call it or a patch of</font>

731
00:31:13,460 --> 00:31:17,330
<font color="#E5E5E5">modern pre writes by itself it's all</font>

732
00:31:16,190 --> 00:31:19,360
pretty simple<font color="#E5E5E5"> stuff but</font>

733
00:31:17,330 --> 00:31:23,179
so essential because<font color="#E5E5E5"> David and I both</font>

734
00:31:19,360 --> 00:31:25,639
have had<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> been in testing for less</font>

735
00:31:23,180 --> 00:31:27,980
than<font color="#E5E5E5"> two</font><font color="#CCCCCC"> years and</font><font color="#E5E5E5"> I've</font><font color="#CCCCCC"> had payloads</font>

736
00:31:25,640 --> 00:31:30,260
tweeted by guys at fire<font color="#CCCCCC"> I buy guys at</font>

737
00:31:27,980 --> 00:31:33,020
Microsoft and I'm like I'm one person

738
00:31:30,260 --> 00:31:34,010
<font color="#E5E5E5">I've been testing that long like why</font>

739
00:31:33,020 --> 00:31:36,590
<font color="#CCCCCC">would why would they care about my</font>

740
00:31:34,010 --> 00:31:39,830
payloads<font color="#E5E5E5"> but they do and they will tweet</font>

741
00:31:36,590 --> 00:31:41,590
it<font color="#E5E5E5"> out to the whole world the</font><font color="#CCCCCC"> preventive</font>

742
00:31:39,830 --> 00:31:44,120
measures are very very important<font color="#E5E5E5"> because</font>

743
00:31:41,590 --> 00:31:47,209
defenders are your<font color="#CCCCCC"> payloads</font>

744
00:31:44,120 --> 00:31:49,489
so before we get into<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> couple</font>

745
00:31:47,210 --> 00:31:51,740
options we have<font color="#E5E5E5"> in terms of payloads I'm</font>

746
00:31:49,490 --> 00:31:54,740
going to talk<font color="#E5E5E5"> about something called SME</font>

747
00:31:51,740 --> 00:31:56,270
egress testing it's super simple<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I</font>

748
00:31:54,740 --> 00:31:59,510
put a<font color="#E5E5E5"> little gift here just to show you</font>

749
00:31:56,270 --> 00:32:02,720
you<font color="#E5E5E5"> can see</font><font color="#CCCCCC"> on the left</font><font color="#E5E5E5"> I'm doing a TCP</font>

750
00:31:59,510 --> 00:32:06,860
dump<font color="#E5E5E5"> of my interface just on</font><font color="#CCCCCC"> core 4 4 5</font>

751
00:32:02,720 --> 00:32:08,660
which is<font color="#CCCCCC"> SP it's on TCP port 445 so what</font>

752
00:32:06,860 --> 00:32:11,270
Windows Windows does<font color="#E5E5E5"> this fantastic</font>

753
00:32:08,660 --> 00:32:12,890
<font color="#E5E5E5">thing where if you go to a UNC path</font>

754
00:32:11,270 --> 00:32:14,480
which stands for<font color="#E5E5E5"> universal naming</font>

755
00:32:12,890 --> 00:32:17,780
convention<font color="#E5E5E5"> it's like a file share</font>

756
00:32:14,480 --> 00:32:19,790
<font color="#E5E5E5">location you can do it in a browser you</font>

757
00:32:17,780 --> 00:32:22,520
can<font color="#CCCCCC"> do it in</font><font color="#E5E5E5"> your Explorer like your</font>

758
00:32:19,790 --> 00:32:24,740
your file viewing window<font color="#E5E5E5"> anywhere in</font>

759
00:32:22,520 --> 00:32:28,040
<font color="#E5E5E5">Windows it will try to resolve</font><font color="#CCCCCC"> that UNC</font>

760
00:32:24,740 --> 00:32:29,450
<font color="#CCCCCC">path to an SMB share and this</font><font color="#E5E5E5"> glorious</font>

761
00:32:28,040 --> 00:32:31,250
thing it does along with<font color="#CCCCCC"> that is attempt</font>

762
00:32:29,450 --> 00:32:33,650
to<font color="#E5E5E5"> authenticate</font><font color="#CCCCCC"> automatically for you</font>

763
00:32:31,250 --> 00:32:35,090
<font color="#E5E5E5">with the user</font><font color="#CCCCCC"> you're currently</font>

764
00:32:33,650 --> 00:32:37,730
<font color="#E5E5E5">authenticated</font><font color="#CCCCCC"> asks whether</font><font color="#E5E5E5"> or not you're</font>

765
00:32:35,090 --> 00:32:40,689
on<font color="#E5E5E5"> a domain local workgroup whatever it</font>

766
00:32:37,730 --> 00:32:43,520
is all you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> see here is that I'm</font>

767
00:32:40,690 --> 00:32:46,100
<font color="#E5E5E5">going to that UNC path on the right and</font>

768
00:32:43,520 --> 00:32:48,440
<font color="#CCCCCC">Chrome then you're seeing it hit 4 4 4 5</font>

769
00:32:46,100 --> 00:32:50,870
<font color="#E5E5E5">on my</font><font color="#CCCCCC"> listening machine but as we go</font><font color="#E5E5E5"> to</font>

770
00:32:48,440 --> 00:32:52,310
the next<font color="#E5E5E5"> slide you can see some super</font>

771
00:32:50,870 --> 00:32:55,129
<font color="#E5E5E5">cool stuff going to do with this there's</font>

772
00:32:52,310 --> 00:32:56,419
limitless options<font color="#CCCCCC"> the first the</font><font color="#E5E5E5"> first</font>

773
00:32:55,130 --> 00:32:58,880
thing<font color="#E5E5E5"> we like</font><font color="#CCCCCC"> to do when external</font>

774
00:32:56,420 --> 00:33:02,450
testing<font color="#E5E5E5"> is if the client will allow it</font>

775
00:32:58,880 --> 00:33:04,850
we<font color="#CCCCCC"> will</font><font color="#E5E5E5"> just simply embed</font>

776
00:33:02,450 --> 00:33:06,200
<font color="#E5E5E5">tagging email and it's just as</font><font color="#CCCCCC"> simple</font><font color="#E5E5E5"> as</font>

777
00:33:04,850 --> 00:33:09,320
you see the little broken<font color="#CCCCCC"> image there</font>

778
00:33:06,200 --> 00:33:11,420
<font color="#E5E5E5">for proof-of-concept purposes but it's</font>

779
00:33:09,320 --> 00:33:14,570
that line and the<font color="#E5E5E5"> third bullet image</font>

780
00:33:11,420 --> 00:33:18,290
source<font color="#CCCCCC"> by UNC</font><font color="#E5E5E5"> path</font><font color="#CCCCCC"> a gift</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> doesn't</font>

781
00:33:14,570 --> 00:33:22,040
exist<font color="#E5E5E5"> and I throw up there's a ton of</font>

782
00:33:18,290 --> 00:33:23,870
SMB capture services<font color="#CCCCCC"> we</font><font color="#E5E5E5"> have one in</font>

783
00:33:22,040 --> 00:33:26,330
<font color="#CCCCCC">Metasploit their responder does</font><font color="#E5E5E5"> that</font>

784
00:33:23,870 --> 00:33:27,770
tons of services do it<font color="#E5E5E5"> and basically all</font>

785
00:33:26,330 --> 00:33:31,010
it does is listen<font color="#CCCCCC"> to the sesame</font>

786
00:33:27,770 --> 00:33:32,210
authentication<font color="#CCCCCC"> and</font><font color="#E5E5E5"> if you guys allow SMB</font>

787
00:33:31,010 --> 00:33:35,000
to egress<font color="#E5E5E5"> from your internal network</font>

788
00:33:32,210 --> 00:33:38,090
<font color="#E5E5E5">which you shouldn't but tons of people</font>

789
00:33:35,000 --> 00:33:39,680
<font color="#E5E5E5">do then you just read</font><font color="#CCCCCC"> random hashes and</font>

790
00:33:38,090 --> 00:33:41,240
<font color="#E5E5E5">you even better on internal networks</font>

791
00:33:39,680 --> 00:33:42,770
that you start man in the<font color="#E5E5E5"> middlee it's</font>

792
00:33:41,240 --> 00:33:44,870
<font color="#E5E5E5">almost always</font><font color="#CCCCCC"> an appeal Alice to be</font>

793
00:33:42,770 --> 00:33:46,430
about traffic internally but I see it

794
00:33:44,870 --> 00:33:48,139
often<font color="#CCCCCC"> on externals as well when I'm</font>

795
00:33:46,430 --> 00:33:51,050
testing it<font color="#E5E5E5"> just as a client external</font>

796
00:33:48,140 --> 00:33:52,340
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> I'll</font><font color="#CCCCCC"> invent an</font><font color="#E5E5E5"> image tag and the</font>

797
00:33:51,050 --> 00:33:55,270
first<font color="#E5E5E5"> ten minutes of the assessment I</font>

798
00:33:52,340 --> 00:33:58,459
have domain hashes<font color="#E5E5E5"> in bed until M format</font>

799
00:33:55,270 --> 00:33:59,810
so you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> do that in emails</font><font color="#E5E5E5"> you can</font>

800
00:33:58,460 --> 00:34:02,360
<font color="#E5E5E5">also embed it in the landing page of</font>

801
00:33:59,810 --> 00:34:04,159
<font color="#E5E5E5">your phishing campaign same effect image</font>

802
00:34:02,360 --> 00:34:07,969
tag whatever<font color="#CCCCCC"> haven't resolved to you in</font>

803
00:34:04,160 --> 00:34:10,010
<font color="#CCCCCC">see pastor graphic</font><font color="#E5E5E5"> caches something</font>

804
00:34:07,970 --> 00:34:12,889
that's also<font color="#E5E5E5"> really interesting and I</font>

805
00:34:10,010 --> 00:34:17,420
<font color="#CCCCCC">think would apply to more like</font><font color="#E5E5E5"> red team</font>

806
00:34:12,889 --> 00:34:19,670
stuff is doing this with documents<font color="#E5E5E5"> so</font>

807
00:34:17,420 --> 00:34:21,380
within the<font color="#E5E5E5"> last year or two there's been</font>

808
00:34:19,670 --> 00:34:23,150
something called template ejection and

809
00:34:21,380 --> 00:34:24,860
<font color="#E5E5E5">basically all that is is you</font><font color="#CCCCCC"> take all</font>

810
00:34:23,150 --> 00:34:28,100
the office documents you guys know<font color="#CCCCCC"> about</font>

811
00:34:24,860 --> 00:34:30,170
Excel<font color="#E5E5E5"> Word</font><font color="#CCCCCC"> publisher whatever it is</font><font color="#E5E5E5"> they</font>

812
00:34:28,100 --> 00:34:32,810
all have<font color="#E5E5E5"> templates that can be applied</font>

813
00:34:30,170 --> 00:34:34,670
<font color="#E5E5E5">and you can just have the template be</font>

814
00:34:32,810 --> 00:34:36,830
located<font color="#E5E5E5"> in a UNC path that Microsoft</font>

815
00:34:34,670 --> 00:34:39,260
does<font color="#E5E5E5"> that awesome thing and gives you</font>

816
00:34:36,830 --> 00:34:41,779
<font color="#CCCCCC">both hashes</font><font color="#E5E5E5"> so that's</font><font color="#CCCCCC"> simple</font><font color="#E5E5E5"> injection</font>

817
00:34:39,260 --> 00:34:43,190
<font color="#CCCCCC">but</font><font color="#E5E5E5"> recently if you guys have heard a</font>

818
00:34:41,780 --> 00:34:45,170
checkpoint<font color="#E5E5E5"> before they had an awesome</font>

819
00:34:43,190 --> 00:34:47,090
disclosure last week<font color="#E5E5E5"> how to give them</font><font color="#CCCCCC"> a</font>

820
00:34:45,170 --> 00:34:48,790
<font color="#E5E5E5">shout</font><font color="#CCCCCC"> out for it where you can do the</font>

821
00:34:47,090 --> 00:34:51,970
same<font color="#E5E5E5"> thing in PDF documents and</font>

822
00:34:48,790 --> 00:34:54,520
literally<font color="#E5E5E5"> just about every PDF viewers</font>

823
00:34:51,969 --> 00:34:56,230
this well it's<font color="#E5E5E5"> really</font><font color="#CCCCCC"> Windows that has</font>

824
00:34:54,520 --> 00:34:59,859
the<font color="#CCCCCC"> ulnar ability but the PDF viewers</font>

825
00:34:56,230 --> 00:35:01,869
allow it so same thing<font color="#E5E5E5"> simple</font><font color="#CCCCCC"> PDF that's</font>

826
00:34:59,859 --> 00:35:04,240
nothing really malicious is going on

827
00:35:01,869 --> 00:35:07,270
it's just attempting to reach a lot like

828
00:35:04,240 --> 00:35:13,629
a hypothetical<font color="#CCCCCC"> box there and giving me</font>

829
00:35:07,270 --> 00:35:15,099
<font color="#CCCCCC">the</font><font color="#E5E5E5"> hashes in</font><font color="#CCCCCC"> the process</font><font color="#E5E5E5"> okay so we're</font>

830
00:35:13,630 --> 00:35:17,200
going to talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> just a couple more</font>

831
00:35:15,099 --> 00:35:19,840
<font color="#CCCCCC">options in terms</font><font color="#E5E5E5"> of payloads one that's</font>

832
00:35:17,200 --> 00:35:23,618
really<font color="#E5E5E5"> cool called HTML</font><font color="#CCCCCC"> application is</font>

833
00:35:19,840 --> 00:35:27,310
HT HT a report and basically<font color="#E5E5E5"> all this is</font>

834
00:35:23,619 --> 00:35:29,349
is HTML that can execute<font color="#E5E5E5"> on your local</font>

835
00:35:27,310 --> 00:35:31,180
<font color="#CCCCCC">workstation</font><font color="#E5E5E5"> interpreted by windows</font>

836
00:35:29,349 --> 00:35:32,800
script host but it doesn't have<font color="#CCCCCC"> many of</font>

837
00:35:31,180 --> 00:35:34,240
the<font color="#E5E5E5"> constraints that it would</font><font color="#CCCCCC"> if it</font>

838
00:35:32,800 --> 00:35:37,359
<font color="#E5E5E5">executed in the browser so</font><font color="#CCCCCC"> it's like</font>

839
00:35:34,240 --> 00:35:38,830
imagine<font color="#E5E5E5"> writing code to</font><font color="#CCCCCC"> manipulate</font>

840
00:35:37,359 --> 00:35:40,990
<font color="#E5E5E5">things on the operating system but you</font>

841
00:35:38,830 --> 00:35:44,170
<font color="#CCCCCC">can do</font><font color="#E5E5E5"> it in</font><font color="#CCCCCC"> HTML that's</font><font color="#E5E5E5"> HD a pretty</font>

842
00:35:40,990 --> 00:35:46,359
much and the<font color="#E5E5E5"> only</font><font color="#CCCCCC"> difference</font><font color="#E5E5E5"> between</font>

843
00:35:44,170 --> 00:35:48,670
HTML and HTA is one header tag

844
00:35:46,359 --> 00:35:51,460
everything else is very very similar<font color="#CCCCCC"> and</font>

845
00:35:48,670 --> 00:35:53,770
<font color="#CCCCCC">it runs in the same</font><font color="#E5E5E5"> process</font><font color="#CCCCCC"> of others ie</font>

846
00:35:51,460 --> 00:35:55,960
<font color="#E5E5E5">Internet Explorer but just without</font><font color="#CCCCCC"> all</font>

847
00:35:53,770 --> 00:36:01,080
<font color="#E5E5E5">the</font><font color="#CCCCCC"> sandboxing</font><font color="#E5E5E5"> and constraints that</font><font color="#CCCCCC"> IE</font>

848
00:35:55,960 --> 00:36:05,260
<font color="#CCCCCC">has just two people</font><font color="#E5E5E5"> will record on HTA's</font>

849
00:36:01,080 --> 00:36:07,270
<font color="#E5E5E5">and then so in this quick</font><font color="#CCCCCC"> 2 minute demo</font>

850
00:36:05,260 --> 00:36:11,080
<font color="#E5E5E5">that I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> chain HTA's</font>

851
00:36:07,270 --> 00:36:13,109
<font color="#E5E5E5">and</font><font color="#CCCCCC"> des</font><font color="#E5E5E5"> so we talked about HTA's</font><font color="#CCCCCC"> to</font>

852
00:36:11,080 --> 00:36:15,700
briefly explain<font color="#CCCCCC"> what a DD attack is</font>

853
00:36:13,109 --> 00:36:18,069
<font color="#CCCCCC">States</font><font color="#E5E5E5"> for dynamic data exchange</font><font color="#CCCCCC"> and</font>

854
00:36:15,700 --> 00:36:20,109
it's just a protocol<font color="#E5E5E5"> on Windows that</font>

855
00:36:18,070 --> 00:36:22,210
<font color="#CCCCCC">allows applications to communicate with</font>

856
00:36:20,109 --> 00:36:24,490
each<font color="#E5E5E5"> other so if you want order to do</font>

857
00:36:22,210 --> 00:36:26,710
something<font color="#CCCCCC"> and access information from</font><font color="#E5E5E5"> an</font>

858
00:36:24,490 --> 00:36:29,020
<font color="#E5E5E5">Excel document</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can use</font><font color="#CCCCCC"> de to pull</font>

859
00:36:26,710 --> 00:36:32,530
that information<font color="#E5E5E5"> from Excel and interact</font>

860
00:36:29,020 --> 00:36:35,980
<font color="#CCCCCC">with it in</font><font color="#E5E5E5"> Word</font><font color="#CCCCCC"> vice versa so</font><font color="#E5E5E5"> targeting</font>

861
00:36:32,530 --> 00:36:38,740
specific office products word when this

862
00:36:35,980 --> 00:36:40,839
first happened<font color="#E5E5E5"> everyone uses word where</font>

863
00:36:38,740 --> 00:36:42,359
<font color="#E5E5E5">it was hugely targeted so Microsoft</font>

864
00:36:40,839 --> 00:36:44,430
<font color="#CCCCCC">pushed a patch in December</font>

865
00:36:42,360 --> 00:36:46,440
<font color="#CCCCCC">8:17 and if your operating systems</font><font color="#E5E5E5"> up</font>

866
00:36:44,430 --> 00:36:48,180
<font color="#CCCCCC">today</font><font color="#E5E5E5"> to exploit this you're gonna have</font>

867
00:36:46,440 --> 00:36:49,950
<font color="#E5E5E5">to make a registry modification which is</font>

868
00:36:48,180 --> 00:36:52,049
<font color="#E5E5E5">an ideal for</font><font color="#CCCCCC"> us as attackers we wanted</font>

869
00:36:49,950 --> 00:36:54,899
to<font color="#CCCCCC"> Dysport</font><font color="#E5E5E5"> when they get the documents</font>

870
00:36:52,050 --> 00:36:57,150
so that<font color="#E5E5E5"> registry modification can be</font>

871
00:36:54,900 --> 00:36:59,160
<font color="#E5E5E5">made once you've got code execution you</font>

872
00:36:57,150 --> 00:37:01,320
can change<font color="#E5E5E5"> that use it to move laterally</font>

873
00:36:59,160 --> 00:37:04,170
or whatever<font color="#E5E5E5"> but it's not</font><font color="#CCCCCC"> ideal for</font><font color="#E5E5E5"> an</font>

874
00:37:01,320 --> 00:37:05,400
additional football so moving<font color="#CCCCCC"> on</font><font color="#E5E5E5"> Excel</font>

875
00:37:04,170 --> 00:37:07,680
it still does work

876
00:37:05,400 --> 00:37:11,430
there's no registry restrictions and<font color="#E5E5E5"> you</font>

877
00:37:07,680 --> 00:37:12,390
<font color="#E5E5E5">can still execute</font><font color="#CCCCCC"> DD</font><font color="#E5E5E5"> payloads you see</font>

878
00:37:11,430 --> 00:37:14,220
the string that<font color="#E5E5E5"> looks a little</font>

879
00:37:12,390 --> 00:37:16,589
intimidating<font color="#CCCCCC"> but things probably</font><font color="#E5E5E5"> look</font>

880
00:37:14,220 --> 00:37:18,990
familiar so<font color="#CCCCCC"> that all this</font><font color="#E5E5E5"> is going</font><font color="#CCCCCC"> to be</font>

881
00:37:16,590 --> 00:37:20,790
as<font color="#E5E5E5"> the contents of an</font><font color="#CCCCCC"> excel the actual</font>

882
00:37:18,990 --> 00:37:22,200
<font color="#E5E5E5">cell so you literally just paste this in</font>

883
00:37:20,790 --> 00:37:25,820
a<font color="#CCCCCC"> cell and it's gonna</font><font color="#E5E5E5"> execute a ton of</font>

884
00:37:22,200 --> 00:37:29,330
<font color="#CCCCCC">lots of code for us</font><font color="#E5E5E5"> you can see ms excel</font>

885
00:37:25,820 --> 00:37:32,700
<font color="#CCCCCC">this is a kind of a stealthy way to</font>

886
00:37:29,330 --> 00:37:34,620
basically<font color="#E5E5E5"> if you type run and windows</font>

887
00:37:32,700 --> 00:37:37,560
and<font color="#CCCCCC"> type</font><font color="#E5E5E5"> ms excel it's the alias to</font>

888
00:37:34,620 --> 00:37:39,330
execute<font color="#E5E5E5"> Microsoft Excel similarly to CMD</font>

889
00:37:37,560 --> 00:37:42,090
for command prompt all that but

890
00:37:39,330 --> 00:37:44,130
basically we say<font color="#CCCCCC"> ms excel what</font><font color="#E5E5E5"> we're</font>

891
00:37:42,090 --> 00:37:45,840
actually<font color="#E5E5E5"> typing back to execute command</font>

892
00:37:44,130 --> 00:37:47,700
prompt which can be done a little more

893
00:37:45,840 --> 00:37:50,070
stealthy<font color="#E5E5E5"> but this is just for</font>

894
00:37:47,700 --> 00:37:52,890
proof-of-concept purposes<font color="#CCCCCC"> I used circa</font>

895
00:37:50,070 --> 00:37:56,010
till so basically David was talking

896
00:37:52,890 --> 00:37:58,740
<font color="#CCCCCC">about something called</font><font color="#E5E5E5"> lol bins living</font>

897
00:37:56,010 --> 00:38:00,540
off the land but it's just binaries that

898
00:37:58,740 --> 00:38:02,910
<font color="#CCCCCC">are needs us on Windows all the time</font>

899
00:38:00,540 --> 00:38:05,070
<font color="#E5E5E5">that we can use to do bad stuff for us</font>

900
00:38:02,910 --> 00:38:07,470
and it's a<font color="#E5E5E5"> trusted Microsoft binary so</font>

901
00:38:05,070 --> 00:38:09,240
it's probably<font color="#CCCCCC"> not making caught</font><font color="#E5E5E5"> this is</font>

902
00:38:07,470 --> 00:38:11,069
somewhat suspicious but much less likely

903
00:38:09,240 --> 00:38:14,069
than like a<font color="#E5E5E5"> macro downloading something</font>

904
00:38:11,070 --> 00:38:15,930
<font color="#E5E5E5">from the internet so cert util is this</font>

905
00:38:14,070 --> 00:38:18,390
thing<font color="#E5E5E5"> that exists on all windows and it</font>

906
00:38:15,930 --> 00:38:20,460
can download files for us so I do<font color="#E5E5E5"> Surrey</font>

907
00:38:18,390 --> 00:38:24,390
<font color="#CCCCCC">tails and</font><font color="#E5E5E5"> Flags downloads and stuff and</font>

908
00:38:20,460 --> 00:38:25,620
<font color="#E5E5E5">you can see a CPD</font><font color="#CCCCCC"> attacker IP and the</font>

909
00:38:24,390 --> 00:38:28,950
file<font color="#E5E5E5"> and I'm downloading is just a</font>

910
00:38:25,620 --> 00:38:31,839
base64<font color="#E5E5E5"> encoded</font><font color="#CCCCCC"> HDA so it's a bunch of</font>

911
00:38:28,950 --> 00:38:34,089
aged<font color="#E5E5E5"> HTML</font><font color="#CCCCCC"> that has just been basically</font>

912
00:38:31,840 --> 00:38:37,210
<font color="#E5E5E5">four encoded then</font><font color="#CCCCCC"> circuito can also</font>

913
00:38:34,090 --> 00:38:40,710
decode<font color="#CCCCCC"> that for us</font><font color="#E5E5E5"> locally</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> I</font>

914
00:38:37,210 --> 00:38:42,640
<font color="#E5E5E5">just execute eh da</font><font color="#CCCCCC"> and a quick note</font>

915
00:38:40,710 --> 00:38:44,890
<font color="#E5E5E5">Microsoft Publisher there's an even</font>

916
00:38:42,640 --> 00:38:46,900
<font color="#E5E5E5">cooler way to execute</font><font color="#CCCCCC"> DD</font><font color="#E5E5E5"> if you have to</font>

917
00:38:44,890 --> 00:38:49,240
<font color="#E5E5E5">they've implemented specific DD</font>

918
00:38:46,900 --> 00:38:50,980
restrictions<font color="#E5E5E5"> there's a way to bypass a</font>

919
00:38:49,240 --> 00:38:52,870
<font color="#E5E5E5">lot of those restrictions by embedding</font>

920
00:38:50,980 --> 00:38:55,090
<font color="#E5E5E5">an</font><font color="#CCCCCC"> excel document in a publisher</font>

921
00:38:52,870 --> 00:38:57,069
document<font color="#E5E5E5"> but that's</font><font color="#CCCCCC"> probably unnecessary</font>

922
00:38:55,090 --> 00:39:01,390
<font color="#E5E5E5">for this presentation but it's a really</font>

923
00:38:57,070 --> 00:39:03,520
<font color="#CCCCCC">cool thing to look into so here's</font>

924
00:39:01,390 --> 00:39:05,980
another<font color="#CCCCCC"> short little</font><font color="#E5E5E5"> gift they're</font>

925
00:39:03,520 --> 00:39:08,500
showing you what I've<font color="#E5E5E5"> used this EE on</font>

926
00:39:05,980 --> 00:39:10,930
engagements<font color="#E5E5E5"> and it's a very very</font>

927
00:39:08,500 --> 00:39:13,870
<font color="#CCCCCC">successful a</font><font color="#E5E5E5"> variation of this but I</font>

928
00:39:10,930 --> 00:39:15,310
mean I've also seen this from<font color="#CCCCCC"> blue</font><font color="#E5E5E5"> team</font>

929
00:39:13,870 --> 00:39:16,330
<font color="#CCCCCC">lights that</font><font color="#E5E5E5"> have simply like payloads</font>

930
00:39:15,310 --> 00:39:18,790
that<font color="#E5E5E5"> have actually been sent</font><font color="#CCCCCC"> to</font>

931
00:39:16,330 --> 00:39:20,950
companies for like actually trying<font color="#E5E5E5"> to</font>

932
00:39:18,790 --> 00:39:23,590
compromise them<font color="#E5E5E5"> just put a picture and</font>

933
00:39:20,950 --> 00:39:26,049
people<font color="#E5E5E5"> that are you know people that are</font>

934
00:39:23,590 --> 00:39:27,760
<font color="#E5E5E5">not security focused or technically</font>

935
00:39:26,050 --> 00:39:30,430
inclined<font color="#CCCCCC"> they'd open an Excel document</font>

936
00:39:27,760 --> 00:39:31,840
that's like if they already<font color="#E5E5E5"> have the</font>

937
00:39:30,430 --> 00:39:33,669
inclination like I really<font color="#E5E5E5"> need to see</font>

938
00:39:31,840 --> 00:39:35,230
this this<font color="#E5E5E5"> is really urgent and there's a</font>

939
00:39:33,670 --> 00:39:37,210
picture<font color="#CCCCCC"> that matches</font><font color="#E5E5E5"> the color and it</font>

940
00:39:35,230 --> 00:39:39,280
says hey Microsoft Office<font color="#CCCCCC"> you need to</font>

941
00:39:37,210 --> 00:39:42,490
enable<font color="#CCCCCC"> content</font><font color="#E5E5E5"> they're probably going to</font>

942
00:39:39,280 --> 00:39:43,450
do it<font color="#CCCCCC"> but you</font><font color="#E5E5E5"> can see the de only</font><font color="#CCCCCC"> exists</font>

943
00:39:42,490 --> 00:39:46,140
<font color="#E5E5E5">of the stream that I showed you</font>

944
00:39:43,450 --> 00:39:51,480
<font color="#CCCCCC">previously</font><font color="#E5E5E5"> none other than that cell so</font>

945
00:39:46,140 --> 00:39:51,480
<font color="#E5E5E5">going forward</font><font color="#CCCCCC"> if I can play this video</font>

946
00:39:54,670 --> 00:40:03,069
<font color="#E5E5E5">okay so we have our milk right here and</font>

947
00:39:59,069 --> 00:40:05,140
I receive an email something<font color="#CCCCCC"> that I want</font>

948
00:40:03,069 --> 00:40:06,339
to<font color="#E5E5E5"> focus on kind kind of tying some</font>

949
00:40:05,140 --> 00:40:08,799
things that<font color="#E5E5E5"> we talked together</font>

950
00:40:06,339 --> 00:40:12,009
previously or talked<font color="#E5E5E5"> about previously</font>

951
00:40:08,799 --> 00:40:13,660
you see admin at Microsoft calm the

952
00:40:12,010 --> 00:40:15,880
reason it's<font color="#E5E5E5"> rendering like that is a</font>

953
00:40:13,660 --> 00:40:21,460
like I<font color="#E5E5E5"> said outlook doesn't typically</font>

954
00:40:15,880 --> 00:40:23,460
unravel<font color="#CCCCCC"> beauty</font><font color="#E5E5E5"> coded domains and</font><font color="#CCCCCC"> B I</font>

955
00:40:21,460 --> 00:40:25,839
have<font color="#CCCCCC"> a puny coded domain for Microsoft</font>

956
00:40:23,460 --> 00:40:27,250
<font color="#E5E5E5">you can squint at</font><font color="#CCCCCC"> it if you want but</font>

957
00:40:25,839 --> 00:40:29,200
<font color="#E5E5E5">you're probably not going to be able to</font>

958
00:40:27,250 --> 00:40:30,250
tell which<font color="#E5E5E5"> letters unique of it</font><font color="#CCCCCC"> yeah I'm</font>

959
00:40:29,200 --> 00:40:34,359
<font color="#CCCCCC">also</font><font color="#E5E5E5"> not going to tell you because I</font>

960
00:40:30,250 --> 00:40:36,210
<font color="#CCCCCC">don't wanna burn my domain</font><font color="#E5E5E5"> so but I will</font>

961
00:40:34,359 --> 00:40:38,380
tell<font color="#E5E5E5"> you</font><font color="#CCCCCC"> that the puny coded character</font>

962
00:40:36,210 --> 00:40:39,910
<font color="#CCCCCC">renderer is exactly like the</font><font color="#E5E5E5"> ASCII</font>

963
00:40:38,380 --> 00:40:42,369
character so there's<font color="#CCCCCC"> actually no way to</font>

964
00:40:39,910 --> 00:40:44,649
tell<font color="#CCCCCC"> physically which</font><font color="#E5E5E5"> ones to</font><font color="#CCCCCC"> PA go to</font>

965
00:40:42,369 --> 00:40:47,200
character<font color="#E5E5E5"> quite so we got this awesome</font>

966
00:40:44,650 --> 00:40:49,690
domain and apparently<font color="#E5E5E5"> we could ban from</font>

967
00:40:47,200 --> 00:40:51,519
<font color="#E5E5E5">all the things and we're gonna download</font>

968
00:40:49,690 --> 00:40:54,299
an excel file showing us why we've<font color="#E5E5E5"> been</font>

969
00:40:51,519 --> 00:40:54,299
banned from all<font color="#E5E5E5"> things</font>

970
00:41:04,640 --> 00:41:08,420
so it was just<font color="#E5E5E5"> a link directly</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

971
00:41:06,470 --> 00:41:10,100
<font color="#E5E5E5">Excel document</font><font color="#CCCCCC"> we open that up there's</font>

972
00:41:08,420 --> 00:41:12,200
the<font color="#CCCCCC"> image we saw earlier</font><font color="#E5E5E5"> or like oh my</font>

973
00:41:10,100 --> 00:41:16,790
gosh<font color="#E5E5E5"> Scoob and we have to open this so</font>

974
00:41:12,200 --> 00:41:17,930
we enable it<font color="#CCCCCC"> you click through</font><font color="#E5E5E5"> to end so</font>

975
00:41:16,790 --> 00:41:20,060
here on the right<font color="#E5E5E5"> just to give a brief</font>

976
00:41:17,930 --> 00:41:22,669
<font color="#CCCCCC">summary we didn't talk about like</font>

977
00:41:20,060 --> 00:41:25,009
<font color="#E5E5E5">different see two options</font><font color="#CCCCCC"> or ways to</font>

978
00:41:22,670 --> 00:41:29,120
<font color="#CCCCCC">receive the first shells but</font><font color="#E5E5E5"> basically I</font>

979
00:41:25,010 --> 00:41:30,950
just<font color="#E5E5E5"> have</font><font color="#CCCCCC"> a I have a web server on the</font>

980
00:41:29,120 --> 00:41:33,319
far left of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> screen</font>

981
00:41:30,950 --> 00:41:35,359
that's serving on or malicious<font color="#CCCCCC"> excel</font>

982
00:41:33,320 --> 00:41:37,700
document and then on the right side<font color="#CCCCCC"> of</font>

983
00:41:35,360 --> 00:41:39,260
the black screen it's my<font color="#CCCCCC"> empire listener</font>

984
00:41:37,700 --> 00:41:43,549
<font color="#E5E5E5">that's what's going to catch the reverse</font>

985
00:41:39,260 --> 00:41:45,200
shell<font color="#E5E5E5"> so that's listening we click</font>

986
00:41:43,550 --> 00:41:47,570
through<font color="#E5E5E5"> the warning</font><font color="#CCCCCC"> because</font><font color="#E5E5E5"> we really</font>

987
00:41:45,200 --> 00:41:49,129
need<font color="#CCCCCC"> to see this</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> is</font>

988
00:41:47,570 --> 00:41:50,900
something<font color="#E5E5E5"> that makes this a little more</font>

989
00:41:49,130 --> 00:41:53,750
believable<font color="#E5E5E5"> is because we pipe that</font>

990
00:41:50,900 --> 00:41:56,890
content<font color="#E5E5E5"> from instead of using just the</font>

991
00:41:53,750 --> 00:41:58,820
<font color="#E5E5E5">CMD alias we're using</font><font color="#CCCCCC"> ms excel it says</font>

992
00:41:56,890 --> 00:42:00,830
<font color="#E5E5E5">excel needs to actually</font><font color="#CCCCCC"> do something</font>

993
00:41:58,820 --> 00:42:01,940
<font color="#E5E5E5">which doesn't look that suspicious so</font>

994
00:42:00,830 --> 00:42:07,310
we're like yeah<font color="#E5E5E5"> that's fine we need to</font>

995
00:42:01,940 --> 00:42:11,930
see this and you can see the the<font color="#CCCCCC"> W</font><font color="#E5E5E5"> get</font>

996
00:42:07,310 --> 00:42:13,850
that received or say about<font color="#CCCCCC"> the excel</font>

997
00:42:11,930 --> 00:42:16,490
<font color="#CCCCCC">document</font><font color="#E5E5E5"> and also</font><font color="#CCCCCC"> the reverse connection</font>

998
00:42:13,850 --> 00:42:21,080
so now we have code execution<font color="#E5E5E5"> we can</font>

999
00:42:16,490 --> 00:42:24,830
interact with<font color="#E5E5E5"> our original so that's</font>

1000
00:42:21,080 --> 00:42:27,100
basically and just just to read

1001
00:42:24,830 --> 00:42:29,060
summarize what<font color="#CCCCCC"> happened there</font><font color="#E5E5E5"> so we had</font>

1002
00:42:27,100 --> 00:42:31,520
when<font color="#CCCCCC"> you've received the</font><font color="#E5E5E5"> Excel document</font>

1003
00:42:29,060 --> 00:42:33,830
<font color="#E5E5E5">from our</font><font color="#CCCCCC"> Pugh decoded domain which looks</font>

1004
00:42:31,520 --> 00:42:35,240
very legitimate<font color="#E5E5E5"> and don't it wouldn't</font>

1005
00:42:33,830 --> 00:42:37,360
have to come from Microsoft before I

1006
00:42:35,240 --> 00:42:40,669
start an assessment I can buy one for

1007
00:42:37,360 --> 00:42:42,410
your company<font color="#CCCCCC"> comm</font><font color="#E5E5E5"> or your company</font><font color="#CCCCCC"> dot</font>

1008
00:42:40,670 --> 00:42:44,330
whatever<font color="#E5E5E5"> so it would look almost</font>

1009
00:42:42,410 --> 00:42:45,770
identical<font color="#CCCCCC"> if I know you're using the</font>

1010
00:42:44,330 --> 00:42:47,690
outlook<font color="#E5E5E5"> client</font><font color="#CCCCCC"> we could figure out a</font>

1011
00:42:45,770 --> 00:42:48,859
recon<font color="#E5E5E5"> we would know it wouldn't unravel</font>

1012
00:42:47,690 --> 00:42:51,230
and then we do<font color="#E5E5E5"> it</font>

1013
00:42:48,859 --> 00:42:53,089
<font color="#CCCCCC">your</font><font color="#E5E5E5"> CEO at your company calm and say</font>

1014
00:42:51,230 --> 00:42:55,069
hey you did<font color="#E5E5E5"> this bad thing and you need</font>

1015
00:42:53,089 --> 00:42:58,038
to download<font color="#E5E5E5"> this for some relevant</font>

1016
00:42:55,069 --> 00:43:00,288
reason<font color="#E5E5E5"> so we download</font><font color="#CCCCCC"> the excel</font><font color="#E5E5E5"> document</font>

1017
00:42:58,039 --> 00:43:03,980
<font color="#E5E5E5">when the code executes</font><font color="#CCCCCC"> it hits the</font>

1018
00:43:00,289 --> 00:43:06,079
<font color="#CCCCCC">base64 encoded HD</font><font color="#E5E5E5"> a cert you till</font>

1019
00:43:03,980 --> 00:43:21,109
decodes that and then just<font color="#CCCCCC"> execute it</font>

1020
00:43:06,079 --> 00:43:22,880
and<font color="#CCCCCC"> we did the reverse shell</font><font color="#E5E5E5"> okay so and</font>

1021
00:43:21,109 --> 00:43:24,499
just<font color="#E5E5E5"> this is the last payment we're</font>

1022
00:43:22,880 --> 00:43:27,589
going to talk<font color="#E5E5E5"> about but this one's</font>

1023
00:43:24,499 --> 00:43:29,118
pretty unique color click<font color="#E5E5E5"> once and just</font>

1024
00:43:27,589 --> 00:43:32,630
to give a<font color="#CCCCCC"> brief summary</font><font color="#E5E5E5"> of what click</font>

1025
00:43:29,119 --> 00:43:35,210
<font color="#CCCCCC">once is it is something that deploys an</font>

1026
00:43:32,630 --> 00:43:38,539
application in an expedited fashion<font color="#CCCCCC"> when</font>

1027
00:43:35,210 --> 00:43:39,859
you're using the<font color="#E5E5E5"> IE or edge browser</font><font color="#CCCCCC"> it's</font>

1028
00:43:38,539 --> 00:43:43,430
been implemented since<font color="#E5E5E5"> about that</font>

1029
00:43:39,859 --> 00:43:45,920
framework 2.0 and a quote from Microsoft

1030
00:43:43,430 --> 00:43:47,899
Intel says core principle is ease

1031
00:43:45,920 --> 00:43:50,059
installation of<font color="#E5E5E5"> Windows applications so</font>

1032
00:43:47,900 --> 00:43:50,950
that<font color="#CCCCCC"> sounds pretty</font><font color="#E5E5E5"> awesome for us as</font>

1033
00:43:50,059 --> 00:43:53,720
attackers

1034
00:43:50,950 --> 00:43:55,578
<font color="#CCCCCC">the main focus is to</font><font color="#E5E5E5"> update applications</font>

1035
00:43:53,720 --> 00:43:57,769
easily that's it could be something

1036
00:43:55,579 --> 00:43:59,930
you're interested<font color="#E5E5E5"> in but we typically</font>

1037
00:43:57,769 --> 00:44:01,669
disable it when we're disabling<font color="#E5E5E5"> or when</font>

1038
00:43:59,930 --> 00:44:02,808
we're<font color="#E5E5E5"> delivering payloads</font><font color="#CCCCCC"> not something</font>

1039
00:44:01,670 --> 00:44:06,380
we're interested<font color="#E5E5E5"> in you just want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font>

1040
00:44:02,809 --> 00:44:09,079
our<font color="#CCCCCC"> foothold</font><font color="#E5E5E5"> and then yeah who is the</font>

1041
00:44:06,380 --> 00:44:10,519
<font color="#E5E5E5">next item</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so I have a quick proof of</font>

1042
00:44:09,079 --> 00:44:13,249
concept just<font color="#E5E5E5"> to show you guys what it</font>

1043
00:44:10,519 --> 00:44:16,788
<font color="#CCCCCC">looks like so think like</font><font color="#E5E5E5"> you have a</font>

1044
00:44:13,249 --> 00:44:19,220
c-sharp project<font color="#E5E5E5"> or like your your binary</font>

1045
00:44:16,789 --> 00:44:21,259
<font color="#CCCCCC">that's gonna execute malicious code this</font>

1046
00:44:19,220 --> 00:44:23,209
is like a<font color="#E5E5E5"> manifest that would wrap that</font>

1047
00:44:21,259 --> 00:44:26,089
<font color="#CCCCCC">and</font><font color="#E5E5E5"> deliver it very conveniently if</font>

1048
00:44:23,210 --> 00:44:27,680
they're using IE reg<font color="#E5E5E5"> this is what my web</font>

1049
00:44:26,089 --> 00:44:29,150
<font color="#CCCCCC">route would look like</font><font color="#E5E5E5"> my application</font>

1050
00:44:27,680 --> 00:44:33,589
that's been execute is called totally

1051
00:44:29,150 --> 00:44:34,660
trustworthy so when you when you

1052
00:44:33,589 --> 00:44:36,549
actually offers

1053
00:44:34,660 --> 00:44:39,100
with the<font color="#CCCCCC"> halo this</font><font color="#E5E5E5"> is a very unique</font>

1054
00:44:36,550 --> 00:44:41,830
<font color="#E5E5E5">prompt which might make it a</font><font color="#CCCCCC"> little more</font>

1055
00:44:39,100 --> 00:44:43,000
believable<font color="#CCCCCC"> also if you can</font><font color="#E5E5E5"> invest</font><font color="#CCCCCC"> in</font>

1056
00:44:41,830 --> 00:44:45,880
<font color="#CCCCCC">code-signing started would make it</font>

1057
00:44:43,000 --> 00:44:49,090
incredibly believable<font color="#E5E5E5"> but we did this</font>

1058
00:44:45,880 --> 00:44:50,860
prompt and basically it's just like you

1059
00:44:49,090 --> 00:44:52,120
can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> where in IE and</font><font color="#E5E5E5"> you could</font>

1060
00:44:50,860 --> 00:44:54,100
<font color="#CCCCCC">reference some stuff that</font><font color="#E5E5E5"> David already</font>

1061
00:44:52,120 --> 00:44:55,630
<font color="#E5E5E5">talked about about those cool attaching</font>

1062
00:44:54,100 --> 00:44:57,790
<font color="#E5E5E5">lottery rights you can do select if you</font>

1063
00:44:55,630 --> 00:45:00,040
<font color="#E5E5E5">go to it in Chrome or Firefox you could</font>

1064
00:44:57,790 --> 00:45:03,190
give a little<font color="#E5E5E5"> prompt</font><font color="#CCCCCC"> assist this isn't</font>

1065
00:45:00,040 --> 00:45:05,259
compatible with<font color="#E5E5E5"> Firefox please</font><font color="#CCCCCC"> visit you</font>

1066
00:45:03,190 --> 00:45:06,610
to<font color="#E5E5E5"> this page then when they use IE</font>

1067
00:45:05,260 --> 00:45:10,080
they're presented<font color="#CCCCCC"> with this unique</font>

1068
00:45:06,610 --> 00:45:12,760
prompt for a click once application and

1069
00:45:10,080 --> 00:45:14,740
here's just<font color="#CCCCCC"> actually execute the</font><font color="#E5E5E5"> binary</font>

1070
00:45:12,760 --> 00:45:16,960
which is a little less suspicious than

1071
00:45:14,740 --> 00:45:21,279
<font color="#E5E5E5">when you get like downloaded some file</font>

1072
00:45:16,960 --> 00:45:23,170
to disk and<font color="#E5E5E5"> now run it and then you can</font>

1073
00:45:21,280 --> 00:45:26,890
see code execution of just<font color="#E5E5E5"> this super</font>

1074
00:45:23,170 --> 00:45:28,810
simple<font color="#E5E5E5"> dotnet code so that</font><font color="#CCCCCC"> is a very</font>

1075
00:45:26,890 --> 00:45:34,779
<font color="#E5E5E5">brief summary of normal kind click once</font>

1076
00:45:28,810 --> 00:45:37,140
consists of in the like like<font color="#CCCCCC"> I mentioned</font>

1077
00:45:34,780 --> 00:45:39,910
what David talked about for<font color="#E5E5E5"> htaccess</font>

1078
00:45:37,140 --> 00:45:41,859
<font color="#E5E5E5">Apache</font><font color="#CCCCCC"> mod rewrites</font><font color="#E5E5E5"> this is a quick</font>

1079
00:45:39,910 --> 00:45:45,759
<font color="#CCCCCC">example</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> how you could do that</font>

1080
00:45:41,860 --> 00:45:48,100
redirect for forcing like not allowing

1081
00:45:45,760 --> 00:45:49,690
the presentation of that<font color="#E5E5E5"> click once</font>

1082
00:45:48,100 --> 00:45:51,370
application<font color="#E5E5E5"> unless you're using a</font>

1083
00:45:49,690 --> 00:45:56,440
browser like<font color="#CCCCCC"> ie your edge that</font><font color="#E5E5E5"> will be</font>

1084
00:45:51,370 --> 00:45:59,190
compatible with<font color="#E5E5E5"> it and that's all we got</font>

1085
00:45:56,440 --> 00:45:59,190
thank you guys for listening

1086
00:46:01,000 --> 00:46:04,210
[Applause]

