1
00:00:02,750 --> 00:00:09,960
okay great so thanks first of all for

2
00:00:05,970 --> 00:00:13,739
having given me my name is nearly OSHA

3
00:00:09,960 --> 00:00:15,570
actually from New York so I saved a

4
00:00:13,740 --> 00:00:19,380
flight to Atlanta thanks to a

5
00:00:15,570 --> 00:00:23,190
coronavirus and I'm going to talk about

6
00:00:19,380 --> 00:00:26,009
open source solutions for seams I work

7
00:00:23,190 --> 00:00:30,300
for a company named empower which is the

8
00:00:26,010 --> 00:00:32,698
same provider that allows a kind of a

9
00:00:30,300 --> 00:00:36,150
top-down approach for seams that's why

10
00:00:32,698 --> 00:00:40,620
you see the pyramid out here and empower

11
00:00:36,150 --> 00:00:44,390
is also contributing open-source pieces

12
00:00:40,620 --> 00:00:49,319
of their software to to the community

13
00:00:44,390 --> 00:00:52,770
but this is going to be a real firehose

14
00:00:49,320 --> 00:00:54,480
talk so feel free to contact me for any

15
00:00:52,770 --> 00:01:00,719
questions later on this is my twitter

16
00:00:54,480 --> 00:01:02,190
handle and my name in connection so just

17
00:01:00,719 --> 00:01:05,909
a little bit about myself

18
00:01:02,190 --> 00:01:08,340
I'm originally from Israel born and

19
00:01:05,909 --> 00:01:11,490
raised I started my career in the

20
00:01:08,340 --> 00:01:12,959
Israeli intelligence Court and I moved

21
00:01:11,490 --> 00:01:15,719
here to the US

22
00:01:12,959 --> 00:01:20,579
around 20 years ago actually I live in

23
00:01:15,719 --> 00:01:22,408
New York I have three kids make sure I'm

24
00:01:20,579 --> 00:01:25,740
not going to jump into the talk now so I

25
00:01:22,409 --> 00:01:27,630
locked the door and I worked for

26
00:01:25,740 --> 00:01:31,649
multiple vendors in threat intelligence

27
00:01:27,630 --> 00:01:34,348
and in identity management I'm the photo

28
00:01:31,649 --> 00:01:37,939
here you see by the way is me in my

29
00:01:34,349 --> 00:01:40,499
first beside dressed up as a detective a

30
00:01:37,939 --> 00:01:42,630
little weird like the idea was that the

31
00:01:40,499 --> 00:01:45,598
talk is around indicators of compromised

32
00:01:42,630 --> 00:01:48,749
and threatened investigation so that's a

33
00:01:45,599 --> 00:01:55,109
little bit about me but enough about me

34
00:01:48,749 --> 00:01:58,908
let's talk about our agenda so seam is

35
00:01:55,109 --> 00:02:03,059
not a new thing I'll discuss the current

36
00:01:58,909 --> 00:02:05,969
historical challenges with seams and

37
00:02:03,060 --> 00:02:08,699
then how I believe we can solve it with

38
00:02:05,969 --> 00:02:10,919
open source but there are a lot of open

39
00:02:08,699 --> 00:02:13,410
source tools here so bear in mind that

40
00:02:10,919 --> 00:02:15,569
I'm not going to get to all the details

41
00:02:13,410 --> 00:02:20,760
and we'll go

42
00:02:15,569 --> 00:02:22,798
through the tools via a turn that I'd

43
00:02:20,760 --> 00:02:25,980
like to call Sims panel which is

44
00:02:22,799 --> 00:02:30,389
basically tools that helping to reduce

45
00:02:25,980 --> 00:02:33,268
the number of false positives and noise

46
00:02:30,389 --> 00:02:35,670
until you really get into a manageable

47
00:02:33,269 --> 00:02:37,469
number of leads that can be investigated

48
00:02:35,670 --> 00:02:44,488
because as you will see later on that's

49
00:02:37,469 --> 00:02:47,219
the number one issue it seems today so I

50
00:02:44,489 --> 00:02:50,609
don't think I need to introduce steam to

51
00:02:47,219 --> 00:02:54,480
a new one of you but I just put down

52
00:02:50,609 --> 00:02:58,949
here a list of the most common use cases

53
00:02:54,480 --> 00:03:01,379
when operating scenes seems becoming

54
00:02:58,949 --> 00:03:04,069
more and more involved with not only

55
00:03:01,379 --> 00:03:08,189
detection but also prevention data

56
00:03:04,069 --> 00:03:10,668
threat hunting is something that they

57
00:03:08,189 --> 00:03:13,349
are still vendors out there that using

58
00:03:10,669 --> 00:03:15,689
specifically for threat hunting but

59
00:03:13,349 --> 00:03:18,988
there are more and more threat hunters

60
00:03:15,689 --> 00:03:21,810
that using the scene for that and so

61
00:03:18,989 --> 00:03:26,310
that's that's the the main purpose of

62
00:03:21,810 --> 00:03:30,720
giving a scene so let's talk about the

63
00:03:26,310 --> 00:03:35,359
three main issues which seems and the

64
00:03:30,720 --> 00:03:39,209
three ones that I see in Oliver is

65
00:03:35,359 --> 00:03:41,639
around the fields normalization or

66
00:03:39,209 --> 00:03:45,150
terminology of fields coming into the

67
00:03:41,639 --> 00:03:48,900
scene the noise that I mentioned earlier

68
00:03:45,150 --> 00:03:52,139
and the fact that it's really hard to

69
00:03:48,900 --> 00:03:54,769
understand what is a real true positives

70
00:03:52,139 --> 00:03:58,290
and you can see here this is a lot of

71
00:03:54,769 --> 00:04:03,060
cases where people either are getting

72
00:03:58,290 --> 00:04:07,290
false positives or false negatives and

73
00:04:03,060 --> 00:04:09,959
missing real alerts so number one issue

74
00:04:07,290 --> 00:04:13,259
is that there is no standard for seams

75
00:04:09,959 --> 00:04:15,930
as of yet each vendor is coming up with

76
00:04:13,259 --> 00:04:19,649
their own proprietary fields and schema

77
00:04:15,930 --> 00:04:22,469
for data a simple example is using IP

78
00:04:19,649 --> 00:04:25,109
addresses different vendors will call an

79
00:04:22,469 --> 00:04:28,349
IP address in different fields and what

80
00:04:25,110 --> 00:04:29,330
that brings when when you look at him to

81
00:04:28,349 --> 00:04:34,188
see me

82
00:04:29,330 --> 00:04:36,859
a list of name of fields that you cannot

83
00:04:34,189 --> 00:04:40,009
really cross correlate between because

84
00:04:36,860 --> 00:04:42,620
from a database perspective they don't

85
00:04:40,009 --> 00:04:46,090
seems to be the same identity or the

86
00:04:42,620 --> 00:04:48,680
same entity and that's true not only for

87
00:04:46,090 --> 00:04:51,289
specific fields like IP addresses or

88
00:04:48,680 --> 00:04:54,110
URLs but also for names were malware's

89
00:04:51,289 --> 00:04:58,550
and for adversaries vendors keep on

90
00:04:54,110 --> 00:05:03,259
using their own terminologies and does

91
00:04:58,550 --> 00:05:06,409
not necessarily sync the second

92
00:05:03,259 --> 00:05:10,310
challenge around seemed is all around

93
00:05:06,409 --> 00:05:12,169
the noise and the fundamental issue is

94
00:05:10,310 --> 00:05:16,310
that log files are not necessarily

95
00:05:12,169 --> 00:05:17,930
sending events that are left the events

96
00:05:16,310 --> 00:05:20,539
that going into the scene could be just

97
00:05:17,930 --> 00:05:24,349
operational events some of the

98
00:05:20,539 --> 00:05:26,150
information is coming in from detection

99
00:05:24,349 --> 00:05:27,650
tools that are not adjusted to your

100
00:05:26,150 --> 00:05:31,159
environment and so there's a lot of

101
00:05:27,650 --> 00:05:36,919
false positives we see this especially

102
00:05:31,159 --> 00:05:39,349
with IDS's and windows locks and a lot

103
00:05:36,919 --> 00:05:43,520
of time there's no fine-tuning of those

104
00:05:39,349 --> 00:05:45,560
alerts coming into the sea and the last

105
00:05:43,520 --> 00:05:47,900
challenge that relates to the same is

106
00:05:45,560 --> 00:05:51,909
that no single event really tells the

107
00:05:47,900 --> 00:05:55,159
story right you cannot really identify

108
00:05:51,909 --> 00:05:59,120
what is the threat or the attack

109
00:05:55,159 --> 00:06:01,909
progress from a single event you need to

110
00:05:59,120 --> 00:06:05,389
look at more data coming in for more

111
00:06:01,909 --> 00:06:08,419
sources because every attack whether it

112
00:06:05,389 --> 00:06:11,509
goes directly with the cyber kill chain

113
00:06:08,419 --> 00:06:14,330
progress or other progress involves

114
00:06:11,509 --> 00:06:16,879
multiple sensors within your environment

115
00:06:14,330 --> 00:06:20,000
and understanding the entire picture

116
00:06:16,879 --> 00:06:25,819
requires putting all those pieces of

117
00:06:20,000 --> 00:06:26,889
puzzle into one story so how simp ever

118
00:06:25,819 --> 00:06:33,139
solved the issue

119
00:06:26,889 --> 00:06:36,139
well the issue of terminology needs to

120
00:06:33,139 --> 00:06:40,539
be solved by normalization so most

121
00:06:36,139 --> 00:06:43,360
vendors just take different type of

122
00:06:40,539 --> 00:06:48,729
entities and try to normal

123
00:06:43,360 --> 00:06:52,199
them into some common schema in addition

124
00:06:48,729 --> 00:06:55,090
there are rules so the main challenge is

125
00:06:52,199 --> 00:06:57,310
with notices that there's a continuous

126
00:06:55,090 --> 00:07:00,280
need to update the rules which takes a

127
00:06:57,310 --> 00:07:03,990
lot of resources either from the vendor

128
00:07:00,280 --> 00:07:08,559
as a professional services or from the

129
00:07:03,990 --> 00:07:10,780
security operation guys and then finally

130
00:07:08,560 --> 00:07:13,240
to understand the story there should be

131
00:07:10,780 --> 00:07:15,309
some kind of an enrichment of the data a

132
00:07:13,240 --> 00:07:20,080
lot of the time the raw data really

133
00:07:15,310 --> 00:07:23,050
doesn't help understand the exact source

134
00:07:20,080 --> 00:07:25,389
of the address what advocating falls

135
00:07:23,050 --> 00:07:27,699
etcetera and obviously machine learning

136
00:07:25,389 --> 00:07:34,210
by the way all of those things are

137
00:07:27,699 --> 00:07:36,460
available today in open source tools so

138
00:07:34,210 --> 00:07:38,438
if you don't have the same which a lot

139
00:07:36,460 --> 00:07:40,810
of small and medium companies are in

140
00:07:38,439 --> 00:07:42,580
that situation and you need to be able

141
00:07:40,810 --> 00:07:47,050
to see them either for compliance

142
00:07:42,580 --> 00:07:49,599
purposes or because of the use case as I

143
00:07:47,050 --> 00:07:51,389
mentioned earlier there's couple of

144
00:07:49,599 --> 00:07:56,050
things that you need to start doing

145
00:07:51,389 --> 00:07:59,699
first so the first thing to do is just

146
00:07:56,050 --> 00:08:01,479
look at your current blog types

147
00:07:59,699 --> 00:08:04,389
specifically when you look at your

148
00:08:01,479 --> 00:08:08,830
environment seem should have at least

149
00:08:04,389 --> 00:08:13,080
one type of network detection tool and

150
00:08:08,830 --> 00:08:15,639
one type of endpoint protection tool

151
00:08:13,080 --> 00:08:18,669
depending on your environment you might

152
00:08:15,639 --> 00:08:22,629
want to add or also wireless type of

153
00:08:18,669 --> 00:08:25,810
logging or cloud your operation or

154
00:08:22,629 --> 00:08:29,199
business operation also depends in in

155
00:08:25,810 --> 00:08:33,089
the cloud activities which more and more

156
00:08:29,199 --> 00:08:37,570
providing a tree aizen and hooks for

157
00:08:33,089 --> 00:08:40,510
seams today and one additional thing to

158
00:08:37,570 --> 00:08:44,410
look at is the gap analysis of okay

159
00:08:40,510 --> 00:08:47,350
where am I missing data where logs are

160
00:08:44,410 --> 00:08:50,230
not available either due to a licenses

161
00:08:47,350 --> 00:08:51,940
from the vendor or just because I've

162
00:08:50,230 --> 00:08:56,079
done I don't have those detection

163
00:08:51,940 --> 00:08:56,590
devices in my environment so once we

164
00:08:56,079 --> 00:09:00,729
have

165
00:08:56,590 --> 00:09:03,790
this portion of logs that we can work

166
00:09:00,730 --> 00:09:06,550
with the second decision is which works

167
00:09:03,790 --> 00:09:10,329
what we want to go with there's no right

168
00:09:06,550 --> 00:09:13,569
or wrong way to go here it's really

169
00:09:10,330 --> 00:09:15,850
depending on your team and the process

170
00:09:13,570 --> 00:09:20,710
you're using today for detection and

171
00:09:15,850 --> 00:09:23,500
mitigation but generally you can divide

172
00:09:20,710 --> 00:09:24,460
it into two types right you can decide

173
00:09:23,500 --> 00:09:27,279
that you send all the information

174
00:09:24,460 --> 00:09:30,160
directly to the seam and then do the

175
00:09:27,279 --> 00:09:34,589
filtering and the rules in the alerts

176
00:09:30,160 --> 00:09:38,829
from there or you can have some

177
00:09:34,589 --> 00:09:40,960
intermediate solution that does some of

178
00:09:38,830 --> 00:09:45,040
the filtering for you and I'll speak

179
00:09:40,960 --> 00:09:47,050
later on about those tools and if you

180
00:09:45,040 --> 00:09:49,689
would like to use them they're going to

181
00:09:47,050 --> 00:09:51,579
reduce first of all the total storage

182
00:09:49,690 --> 00:09:56,560
that eventually the seam will use but

183
00:09:51,580 --> 00:09:58,779
also they will improve the experience of

184
00:09:56,560 --> 00:10:02,650
the security analyst when they interact

185
00:09:58,779 --> 00:10:05,710
with the scene and then the last thing

186
00:10:02,650 --> 00:10:07,480
to consider is data enrichment so when

187
00:10:05,710 --> 00:10:11,010
I'm talking about data enrichment if

188
00:10:07,480 --> 00:10:13,810
you're looking at identities like users

189
00:10:11,010 --> 00:10:16,960
very often Active Directory can help

190
00:10:13,810 --> 00:10:21,939
with adding metadata to users such as

191
00:10:16,960 --> 00:10:25,540
their department their specific role the

192
00:10:21,940 --> 00:10:29,260
user privileges and so on for looking at

193
00:10:25,540 --> 00:10:32,890
assets like servers or hosts it would be

194
00:10:29,260 --> 00:10:35,230
great if you will add also some context

195
00:10:32,890 --> 00:10:38,710
around which department this asset is

196
00:10:35,230 --> 00:10:40,810
part of how critical it is to the system

197
00:10:38,710 --> 00:10:44,020
which one are your crown jewels and

198
00:10:40,810 --> 00:10:46,270
which one you know just the one server

199
00:10:44,020 --> 00:10:52,209
sitting in QA that has no access to the

200
00:10:46,270 --> 00:10:56,439
Internet so this is how I look at when

201
00:10:52,209 --> 00:10:59,020
I'm thinking of building a seam okay the

202
00:10:56,440 --> 00:11:01,990
look is through a funnel and actually

203
00:10:59,020 --> 00:11:06,339
this one is taking out of a post from my

204
00:11:01,990 --> 00:11:09,040
Spector ops by Jared Adkins on you can

205
00:11:06,339 --> 00:11:09,670
see the link down here and the idea is

206
00:11:09,040 --> 00:11:11,860
that when

207
00:11:09,670 --> 00:11:14,650
we build the same we need to go through

208
00:11:11,860 --> 00:11:16,690
this filtering process the main idea is

209
00:11:14,650 --> 00:11:19,180
that we don't want to clog the funnel we

210
00:11:16,690 --> 00:11:22,300
don't want to end up with alerts that

211
00:11:19,180 --> 00:11:26,050
cannot be handled by the amount of

212
00:11:22,300 --> 00:11:28,630
resources that we have in our group and

213
00:11:26,050 --> 00:11:33,189
so we're kind of going to go one by one

214
00:11:28,630 --> 00:11:38,830
in through those steps and see which

215
00:11:33,190 --> 00:11:41,260
tools can help us in each step so of

216
00:11:38,830 --> 00:11:42,760
course sim has no meaning if there's no

217
00:11:41,260 --> 00:11:47,140
data there so we're starting with

218
00:11:42,760 --> 00:11:50,230
collecting the data the one that I

219
00:11:47,140 --> 00:11:54,400
highlighted here in red are the one that

220
00:11:50,230 --> 00:11:56,200
I have experience with beets if you

221
00:11:54,400 --> 00:11:58,000
haven't heard of peach this is actually

222
00:11:56,200 --> 00:12:02,860
part of the elastic stack which I'll

223
00:11:58,000 --> 00:12:07,810
speak to a little bit more and helps to

224
00:12:02,860 --> 00:12:10,420
collect a lot of various types of data

225
00:12:07,810 --> 00:12:16,290
sources from operating systems to

226
00:12:10,420 --> 00:12:18,910
network to to security devices Kafka is

227
00:12:16,290 --> 00:12:21,640
critical especially when you deal with

228
00:12:18,910 --> 00:12:23,980
high volume data with the high

229
00:12:21,640 --> 00:12:26,560
throughput and low latency and it acts

230
00:12:23,980 --> 00:12:29,650
as a buffer so if any of the pipeline's

231
00:12:26,560 --> 00:12:35,579
is down you don't lose data and then log

232
00:12:29,650 --> 00:12:38,530
stash is really coming in to be

233
00:12:35,580 --> 00:12:42,700
instrumental when you try to parse the

234
00:12:38,530 --> 00:12:45,310
laws and solve this normalization

235
00:12:42,700 --> 00:12:47,080
challenge that I mentioned earlier right

236
00:12:45,310 --> 00:12:50,410
the challenge of talking in different

237
00:12:47,080 --> 00:12:52,180
languages so you can see here's some

238
00:12:50,410 --> 00:12:58,150
other ones but I'm going to focus on

239
00:12:52,180 --> 00:13:01,500
those three today now if you're missing

240
00:12:58,150 --> 00:13:05,800
some of the detection tools on your

241
00:13:01,500 --> 00:13:07,930
either endpoints or networks you don't

242
00:13:05,800 --> 00:13:09,339
have to run and look for vendor to buy

243
00:13:07,930 --> 00:13:11,500
them they are great open source

244
00:13:09,340 --> 00:13:13,960
solutions they're both for network

245
00:13:11,500 --> 00:13:15,430
intrusion detection and hosting through

246
00:13:13,960 --> 00:13:18,040
the detections I'm sure you're familiar

247
00:13:15,430 --> 00:13:20,290
with them the nice thing about them is

248
00:13:18,040 --> 00:13:23,139
that they have a great community behind

249
00:13:20,290 --> 00:13:26,199
them Zeke

250
00:13:23,139 --> 00:13:29,290
some worthy out-of-the-box tools that

251
00:13:26,199 --> 00:13:32,049
supports up to layer seven of network

252
00:13:29,290 --> 00:13:34,988
analysis and Sarika does not also have

253
00:13:32,049 --> 00:13:37,089
very similar format so if you used to

254
00:13:34,989 --> 00:13:42,759
one of them you can move between the two

255
00:13:37,089 --> 00:13:47,079
pretty easily on the endpoint side there

256
00:13:42,759 --> 00:13:49,929
are less enterprises there that I see

257
00:13:47,079 --> 00:13:52,508
implementing open sources just because

258
00:13:49,929 --> 00:13:54,389
it it's much more risky and they rather

259
00:13:52,509 --> 00:13:57,699
work with the vendor that has

260
00:13:54,389 --> 00:14:01,809
accountability on a piece of software

261
00:13:57,699 --> 00:14:04,929
they install on an endpoint but we do

262
00:14:01,809 --> 00:14:06,939
see more and more customers using wazoo

263
00:14:04,929 --> 00:14:08,049
in the production line so if you haven't

264
00:14:06,939 --> 00:14:11,069
heard of wazoo

265
00:14:08,049 --> 00:14:15,119
this was a project forth out of OS X

266
00:14:11,069 --> 00:14:21,040
which provide the great endpoint

267
00:14:15,119 --> 00:14:23,559
detection and again the idea here is

268
00:14:21,040 --> 00:14:24,939
that they integrate nicely with the

269
00:14:23,559 --> 00:14:27,910
other tools that I mentioned earlier

270
00:14:24,939 --> 00:14:32,379
post the beats and lennier on the log

271
00:14:27,910 --> 00:14:35,079
stash which actually going to be what

272
00:14:32,379 --> 00:14:38,559
I'm going to talk about as well so my

273
00:14:35,079 --> 00:14:42,878
company mPower released an open-source

274
00:14:38,559 --> 00:14:45,879
version of log stash parsers the idea

275
00:14:42,879 --> 00:14:48,309
behind it is to solve this problem that

276
00:14:45,879 --> 00:14:50,980
I mentioned earlier with not using the

277
00:14:48,309 --> 00:14:53,290
same terminology and at the same time to

278
00:14:50,980 --> 00:14:57,999
reduce some of the noises even before

279
00:14:53,290 --> 00:15:00,519
the events going in into the sea so log

280
00:14:57,999 --> 00:15:01,899
stash you can see some leaks here if

281
00:15:00,519 --> 00:15:05,309
you're not familiar with is very

282
00:15:01,899 --> 00:15:10,629
flexible framework that is not

283
00:15:05,309 --> 00:15:13,868
necessarily getting you locked in to any

284
00:15:10,629 --> 00:15:16,299
vendor it's an open source it has a

285
00:15:13,869 --> 00:15:19,149
great parsing capabilities you can look

286
00:15:16,299 --> 00:15:21,999
it up it's called the grog filter and it

287
00:15:19,149 --> 00:15:25,059
is very much compatible with the elastic

288
00:15:21,999 --> 00:15:29,069
comment schema which is the elastic

289
00:15:25,059 --> 00:15:32,309
search version of standard field names

290
00:15:29,069 --> 00:15:34,539
in order to be able to later on

291
00:15:32,309 --> 00:15:36,689
cross-correlate events coming in from

292
00:15:34,539 --> 00:15:36,689
multiple

293
00:15:38,040 --> 00:15:43,650
another thing you can do with lobsters

294
00:15:40,210 --> 00:15:46,000
is you can in reach some of the field so

295
00:15:43,650 --> 00:15:48,400
simple example would be if you have an

296
00:15:46,000 --> 00:15:50,710
IP address you can use you can use log

297
00:15:48,400 --> 00:15:55,030
stash to enrich the data for geolocation

298
00:15:50,710 --> 00:15:57,550
so application into the IP address you

299
00:15:55,030 --> 00:15:59,860
can also enrich using reputation so if

300
00:15:57,550 --> 00:16:01,900
you have your L you can and reach it and

301
00:15:59,860 --> 00:16:04,180
find out even before it goes to the

302
00:16:01,900 --> 00:16:12,670
scene whether this URL is malicious or

303
00:16:04,180 --> 00:16:16,089
not so this is how it works an example

304
00:16:12,670 --> 00:16:19,209
of log stash each log stash consists of

305
00:16:16,090 --> 00:16:21,220
pipeline and you can communicate between

306
00:16:19,210 --> 00:16:24,880
black pipe lines you can concatenate

307
00:16:21,220 --> 00:16:30,250
pipe lines each pipe line has three

308
00:16:24,880 --> 00:16:31,960
three parts one is the input plug in and

309
00:16:30,250 --> 00:16:35,410
locks lock star supports multiple

310
00:16:31,960 --> 00:16:39,610
formats whether it's a syslog see ya but

311
00:16:35,410 --> 00:16:42,550
files what have you so once you ingest

312
00:16:39,610 --> 00:16:44,970
the data you can filter it X this is

313
00:16:42,550 --> 00:16:47,829
where you do the enrichment and the

314
00:16:44,970 --> 00:16:50,650
parsing and finally you can either send

315
00:16:47,830 --> 00:16:53,770
it to a database or you can send it to

316
00:16:50,650 --> 00:16:58,060
another log stash if you want to change

317
00:16:53,770 --> 00:17:05,050
few logs together or create the pipeline

318
00:16:58,060 --> 00:17:07,770
to pipeline type of architecture okay so

319
00:17:05,050 --> 00:17:11,050
not sure how many of you have heard of

320
00:17:07,770 --> 00:17:14,109
Sigma but Sigma is a little bit

321
00:17:11,050 --> 00:17:17,709
different that is not a open source code

322
00:17:14,109 --> 00:17:21,040
it is an open source standard and the

323
00:17:17,709 --> 00:17:23,530
idea behind Sigma is to allow you to get

324
00:17:21,040 --> 00:17:27,810
out of the box the list of rules that

325
00:17:23,530 --> 00:17:32,080
already will helps you find threads so

326
00:17:27,810 --> 00:17:34,929
Sigma is basically helping you both to

327
00:17:32,080 --> 00:17:37,659
maintain the threads but also to avoid

328
00:17:34,930 --> 00:17:40,390
vendor lock-in so if you're moving into

329
00:17:37,660 --> 00:17:43,540
another vendor the rules in Sigma will

330
00:17:40,390 --> 00:17:47,120
still stay and will be able to work on

331
00:17:43,540 --> 00:17:51,139
any senior so how it works

332
00:17:47,120 --> 00:17:53,179
ah there is a sigma rule creation

333
00:17:51,140 --> 00:17:55,130
process there's a huge community that

334
00:17:53,180 --> 00:17:58,400
already contributed a lot of things that

335
00:17:55,130 --> 00:18:01,360
helps you identify very common

336
00:17:58,400 --> 00:18:04,340
techniques like lateral movement

337
00:18:01,360 --> 00:18:08,600
privilege escalation initial intrusions

338
00:18:04,340 --> 00:18:10,459
and so on you can create also your own

339
00:18:08,600 --> 00:18:13,909
rule if you have specific rule that is

340
00:18:10,460 --> 00:18:16,070
not part of the community then depending

341
00:18:13,910 --> 00:18:20,330
on the sim that you use you can convert

342
00:18:16,070 --> 00:18:22,820
the rule the rule to your team you would

343
00:18:20,330 --> 00:18:25,850
be able to add custom fields that are

344
00:18:22,820 --> 00:18:27,230
relevant only to your company and then

345
00:18:25,850 --> 00:18:30,949
you would be able to hook it into a

346
00:18:27,230 --> 00:18:33,110
search query and start sending alerts to

347
00:18:30,950 --> 00:18:36,650
incident response and security operation

348
00:18:33,110 --> 00:18:39,889
teams if for any reason you want to move

349
00:18:36,650 --> 00:18:42,850
to a another thing you simply need to

350
00:18:39,890 --> 00:18:46,790
use another converter but you don't lose

351
00:18:42,850 --> 00:18:53,090
the original rules created and

352
00:18:46,790 --> 00:18:55,670
maintained by Sigma ok so just kind of a

353
00:18:53,090 --> 00:18:58,399
recap to spoke about how we getting the

354
00:18:55,670 --> 00:19:00,740
logs shipped into locks - how locks -

355
00:18:58,400 --> 00:19:02,450
can help us with parsing and how Sigma

356
00:19:00,740 --> 00:19:05,570
can help us with creating those rules

357
00:19:02,450 --> 00:19:07,190
all open source and now we're looking at

358
00:19:05,570 --> 00:19:09,290
the other side of the open source which

359
00:19:07,190 --> 00:19:13,400
is the storage and search capabilities

360
00:19:09,290 --> 00:19:16,040
and so one of the solutions you can look

361
00:19:13,400 --> 00:19:19,780
at and the one we have experience with

362
00:19:16,040 --> 00:19:23,149
is the elastic search or the elk stock

363
00:19:19,780 --> 00:19:25,879
elastic search is basically an open

364
00:19:23,150 --> 00:19:29,480
source for search and storage it's not

365
00:19:25,880 --> 00:19:32,990
originally meant to be a seam but it is

366
00:19:29,480 --> 00:19:35,500
highly used in the security community as

367
00:19:32,990 --> 00:19:39,559
a seam because of three main reasons

368
00:19:35,500 --> 00:19:41,720
first it's very scalable you can really

369
00:19:39,559 --> 00:19:44,660
handle huge amount of data and

370
00:19:41,720 --> 00:19:47,360
throughput use it using elastic search

371
00:19:44,660 --> 00:19:49,790
cluster second it's very flexible

372
00:19:47,360 --> 00:19:52,550
there's no specific schema that you're

373
00:19:49,790 --> 00:19:55,010
locked in it's you it's called a schema

374
00:19:52,550 --> 00:19:56,960
on edges which means that once the data

375
00:19:55,010 --> 00:19:59,150
is ingested it's automatically parsed

376
00:19:56,960 --> 00:20:01,340
into a JSON format that makes it very

377
00:19:59,150 --> 00:20:05,460
flexible for search

378
00:20:01,340 --> 00:20:07,020
and lastly it's very quick so one of the

379
00:20:05,460 --> 00:20:10,740
challenges which seems today is that

380
00:20:07,020 --> 00:20:12,720
there's a lot of overhead when reading

381
00:20:10,740 --> 00:20:18,470
information and the more data you add

382
00:20:12,720 --> 00:20:21,660
slow it gets to work with a seam you can

383
00:20:18,470 --> 00:20:23,820
you can look at queries that taking 15

384
00:20:21,660 --> 00:20:26,610
minutes in 20 you can go get a coffee

385
00:20:23,820 --> 00:20:28,409
break and it's still looking for your

386
00:20:26,610 --> 00:20:30,899
data and obviously this is not practical

387
00:20:28,410 --> 00:20:36,060
for soft and definitely not for Incident

388
00:20:30,900 --> 00:20:38,760
Response just mentioning few other seams

389
00:20:36,060 --> 00:20:41,250
that are open source and out there one

390
00:20:38,760 --> 00:20:44,370
coming out of alien vault this is our

391
00:20:41,250 --> 00:20:46,380
steam it's getting a very good feedback

392
00:20:44,370 --> 00:20:49,679
from the field I personally don't have

393
00:20:46,380 --> 00:20:52,520
much experience with it but what I like

394
00:20:49,680 --> 00:20:56,070
about what I hear is that it also has

395
00:20:52,520 --> 00:20:57,690
asset discovery and vulnerability in it

396
00:20:56,070 --> 00:21:01,260
so it really can plug it into your

397
00:20:57,690 --> 00:21:03,870
environment and will tweak find out what

398
00:21:01,260 --> 00:21:06,030
your infrastructure looks like and then

399
00:21:03,870 --> 00:21:09,330
obviously this is helped with finding

400
00:21:06,030 --> 00:21:14,550
relevant threats within your routine you

401
00:21:09,330 --> 00:21:17,669
see I don't believe from what I hear it

402
00:21:14,550 --> 00:21:20,070
is as flexible as the Cabana user

403
00:21:17,670 --> 00:21:25,740
interface which is part of the elastic

404
00:21:20,070 --> 00:21:29,460
stack then one more open source that is

405
00:21:25,740 --> 00:21:31,530
used out there coming out of Apache this

406
00:21:29,460 --> 00:21:35,550
is basically a combination of six open

407
00:21:31,530 --> 00:21:37,860
sources that having one interface what I

408
00:21:35,550 --> 00:21:40,649
like specifically about that is that a

409
00:21:37,860 --> 00:21:43,919
it supports the elasticsearch database

410
00:21:40,650 --> 00:21:48,000
so you're not losing the flexibility and

411
00:21:43,920 --> 00:21:50,100
the speed if using Apache Metron with

412
00:21:48,000 --> 00:21:51,840
elasticsearch database and the other one

413
00:21:50,100 --> 00:21:54,959
is that they have a specific model for

414
00:21:51,840 --> 00:22:01,580
machine learning algorithms if you are

415
00:21:54,960 --> 00:22:01,580
one of those teams that having the

416
00:22:01,850 --> 00:22:10,530
approach towards scientific studying of

417
00:22:07,350 --> 00:22:12,740
of your data this is something that can

418
00:22:10,530 --> 00:22:12,740
help

419
00:22:13,870 --> 00:22:21,620
so this is how the elastic stacks looks

420
00:22:18,410 --> 00:22:25,610
like just to kind of recap we're looking

421
00:22:21,620 --> 00:22:28,699
at low carriers all kind of beats some

422
00:22:25,610 --> 00:22:32,360
are for Windows other are for Linux for

423
00:22:28,700 --> 00:22:35,690
network etc and then you can either send

424
00:22:32,360 --> 00:22:38,419
the data directly to elasticsearch as a

425
00:22:35,690 --> 00:22:42,200
raw data or you can send it through lots

426
00:22:38,420 --> 00:22:44,750
- first for enhancement and parsing and

427
00:22:42,200 --> 00:22:47,210
then eventually they can end up at the

428
00:22:44,750 --> 00:22:51,170
elastic search for search and reporting

429
00:22:47,210 --> 00:22:55,970
and you can access the data via Capanna

430
00:22:51,170 --> 00:22:58,250
for visualization now a lot of the

431
00:22:55,970 --> 00:23:01,880
themes today are starting to move into

432
00:22:58,250 --> 00:23:04,940
not being only a log educator our

433
00:23:01,880 --> 00:23:08,450
threatening social but also an incident

434
00:23:04,940 --> 00:23:11,270
response motion so I figured I'll add

435
00:23:08,450 --> 00:23:14,990
also some of the open source tools that

436
00:23:11,270 --> 00:23:17,080
related to Incident Response and one

437
00:23:14,990 --> 00:23:23,510
which is really standing out is the hive

438
00:23:17,080 --> 00:23:25,699
beehive project again very much smooth

439
00:23:23,510 --> 00:23:27,320
integration with elastic search so all

440
00:23:25,700 --> 00:23:28,420
those open sources are playing nice

441
00:23:27,320 --> 00:23:31,580
together

442
00:23:28,420 --> 00:23:36,320
and the idea behind it like any Incident

443
00:23:31,580 --> 00:23:39,110
Response ticketing system is to be able

444
00:23:36,320 --> 00:23:44,780
to collaborate within the team and

445
00:23:39,110 --> 00:23:46,729
create tasks and enrichment using the

446
00:23:44,780 --> 00:23:49,970
integration that we have has both with

447
00:23:46,730 --> 00:23:52,630
elastic search but also with mist which

448
00:23:49,970 --> 00:23:56,270
I'll talk about next

449
00:23:52,630 --> 00:23:59,630
so mist another open source open source

450
00:23:56,270 --> 00:24:02,389
solution stands for Maori information

451
00:23:59,630 --> 00:24:06,140
sharing platform but it's much more than

452
00:24:02,390 --> 00:24:08,270
that this is a literally an open source

453
00:24:06,140 --> 00:24:12,350
solution for threat intelligence

454
00:24:08,270 --> 00:24:14,330
platforms the idea behind it is to get

455
00:24:12,350 --> 00:24:17,179
feeds from the community with the

456
00:24:14,330 --> 00:24:22,610
indicators of compromised malicious IP

457
00:24:17,180 --> 00:24:24,410
is URL hash values and then easily try

458
00:24:22,610 --> 00:24:26,010
to cross correlate them with those

459
00:24:24,410 --> 00:24:27,810
indicators coming in from

460
00:24:26,010 --> 00:24:30,480
see and then if there's a match

461
00:24:27,810 --> 00:24:34,290
obviously you want this one - to get the

462
00:24:30,480 --> 00:24:39,300
protein first in the list for your

463
00:24:34,290 --> 00:24:42,780
security analyst to work on and then the

464
00:24:39,300 --> 00:24:45,000
last open-source tool I want to speak

465
00:24:42,780 --> 00:24:47,970
about when when it comes to instant

466
00:24:45,000 --> 00:24:50,460
response is cortex this is actually the

467
00:24:47,970 --> 00:24:53,640
second half of the hive project it

468
00:24:50,460 --> 00:24:57,420
supports the analysis of those IO sees

469
00:24:53,640 --> 00:25:00,620
this is the kind of the brain of the

470
00:24:57,420 --> 00:25:03,270
analysis part of what coming in from

471
00:25:00,620 --> 00:25:06,540
beehive ticketing from one hand and what

472
00:25:03,270 --> 00:25:11,129
coming in from your local actors on the

473
00:25:06,540 --> 00:25:12,750
other hand and so encourage all of you

474
00:25:11,130 --> 00:25:17,430
guys to look at the highest project and

475
00:25:12,750 --> 00:25:21,720
see if it's relevant for you so I came

476
00:25:17,430 --> 00:25:24,450
up with this kind of final diagram that

477
00:25:21,720 --> 00:25:27,600
shows all or at least some of the pieces

478
00:25:24,450 --> 00:25:29,670
that I've spoken so if you want to build

479
00:25:27,600 --> 00:25:34,699
your scene totally from open-source it's

480
00:25:29,670 --> 00:25:38,430
definitely possible you can look at lock

481
00:25:34,700 --> 00:25:40,320
aggregators like log stash that can help

482
00:25:38,430 --> 00:25:42,570
you put posting sending them to elastic

483
00:25:40,320 --> 00:25:45,210
search if you missing any of your

484
00:25:42,570 --> 00:25:47,250
detection tools you would be able to use

485
00:25:45,210 --> 00:25:50,160
them as well in this example of a saw

486
00:25:47,250 --> 00:25:53,700
and then eventually this can be

487
00:25:50,160 --> 00:25:56,480
integrated into the hive generating

488
00:25:53,700 --> 00:26:00,660
tickets and if there is any match with

489
00:25:56,480 --> 00:26:03,650
known iOS's you can immediately trigger

490
00:26:00,660 --> 00:26:03,650
alerts

491
00:26:05,830 --> 00:26:10,720
so we cannot really have a security

492
00:26:08,590 --> 00:26:13,779
topic without mentioning mitre attack

493
00:26:10,720 --> 00:26:16,090
framework it's great framework that a

494
00:26:13,779 --> 00:26:20,169
lot of seams and other tools in market

495
00:26:16,090 --> 00:26:22,629
are adjusting to and one of the things

496
00:26:20,169 --> 00:26:26,169
you can do with your open seam is doing

497
00:26:22,629 --> 00:26:29,469
the same thing you can use it for both

498
00:26:26,169 --> 00:26:32,049
the red team or blue team exercise I

499
00:26:29,470 --> 00:26:36,629
have here this is actually an example of

500
00:26:32,049 --> 00:26:39,158
the atomic red which is a cannery

501
00:26:36,629 --> 00:26:40,959
project that helps you test your

502
00:26:39,159 --> 00:26:43,919
existing environment with those

503
00:26:40,960 --> 00:26:45,970
techniques and techniques that are I

504
00:26:43,919 --> 00:26:47,730
mentioning within the mitre and that

505
00:26:45,970 --> 00:26:51,129
framework and then you can identify

506
00:26:47,730 --> 00:26:53,789
where are your gaps right which which of

507
00:26:51,129 --> 00:26:56,139
the testings past and which are failed

508
00:26:53,789 --> 00:26:59,139
but you can also use it within the same

509
00:26:56,139 --> 00:27:00,899
and see within your detections where are

510
00:26:59,139 --> 00:27:03,879
the detections are where are the

511
00:27:00,899 --> 00:27:08,309
specific techniques whether they're more

512
00:27:03,879 --> 00:27:10,869
on the discovery side the persistence

513
00:27:08,309 --> 00:27:12,519
the command-and-control communication

514
00:27:10,869 --> 00:27:14,738
what-have-you and this way you can

515
00:27:12,519 --> 00:27:19,119
continuously improve your security

516
00:27:14,739 --> 00:27:21,519
posture by adjusting your security tools

517
00:27:19,119 --> 00:27:27,399
to to those red spots places that you're

518
00:27:21,519 --> 00:27:29,649
not doing the greatest job on um like I

519
00:27:27,399 --> 00:27:32,979
mentioned earlier seems becoming more

520
00:27:29,649 --> 00:27:36,668
and more of a threat hunting tool there

521
00:27:32,980 --> 00:27:38,799
are separate training out there that can

522
00:27:36,669 --> 00:27:41,830
help you with how to use elasticsearch

523
00:27:38,799 --> 00:27:44,200
in varna for that purpose but in

524
00:27:41,830 --> 00:27:47,549
addition to that you should take into

525
00:27:44,200 --> 00:27:51,249
consideration tools like the Montego

526
00:27:47,549 --> 00:27:54,700
cuckoo and other open source tools that

527
00:27:51,249 --> 00:27:57,659
can help you together with the seam to

528
00:27:54,700 --> 00:28:02,350
figure out a little bit more with the

529
00:27:57,659 --> 00:28:07,029
threats are another proactive tools you

530
00:28:02,350 --> 00:28:11,199
can use again from a from the data

531
00:28:07,029 --> 00:28:12,850
analytics part there's a great tool from

532
00:28:11,200 --> 00:28:16,740
David Bianco which is a great

533
00:28:12,850 --> 00:28:19,779
contributor to the security community

534
00:28:16,740 --> 00:28:21,849
it's called the hunter

535
00:28:19,779 --> 00:28:23,679
my turn release the great tool that

536
00:28:21,849 --> 00:28:25,960
helps you with the process of analyzing

537
00:28:23,679 --> 00:28:28,989
attacks again helps you with

538
00:28:25,960 --> 00:28:31,330
understanding which log file can help

539
00:28:28,989 --> 00:28:33,580
you identify which threats they might

540
00:28:31,330 --> 00:28:35,889
have that framework and then I added

541
00:28:33,580 --> 00:28:37,779
here another link that has some great

542
00:28:35,889 --> 00:28:39,248
tools it's called awesome machine

543
00:28:37,779 --> 00:28:42,249
learning for cyber security and that's

544
00:28:39,249 --> 00:28:46,419
what's exactly it's really great bunch

545
00:28:42,249 --> 00:28:50,440
of tools over there and if you want to

546
00:28:46,419 --> 00:28:54,639
go through the situational awareness you

547
00:28:50,440 --> 00:28:57,039
can work more with tools like Rita Yara

548
00:28:54,639 --> 00:28:59,199
and the diamond model again were short

549
00:28:57,039 --> 00:29:00,969
in time now but if you are curious who

550
00:28:59,200 --> 00:29:04,089
want to learn more about them feel free

551
00:29:00,969 --> 00:29:06,639
to reach out so what I didn't cover in

552
00:29:04,089 --> 00:29:08,379
this call obviously talking about

553
00:29:06,639 --> 00:29:12,039
building your own team cannot be a half

554
00:29:08,379 --> 00:29:14,918
an hour talk there's a lot of other

555
00:29:12,039 --> 00:29:17,109
things to consider I'm not even getting

556
00:29:14,919 --> 00:29:19,359
into the architecture and the storage

557
00:29:17,109 --> 00:29:21,849
calculation and the bandwidth usage

558
00:29:19,359 --> 00:29:23,499
within the network all of those should

559
00:29:21,849 --> 00:29:27,820
be taken but I think the bottom line is

560
00:29:23,499 --> 00:29:31,330
that you can build your own seam with

561
00:29:27,820 --> 00:29:34,330
open source tools and there are great

562
00:29:31,330 --> 00:29:36,639
support coming in from the community and

563
00:29:34,330 --> 00:29:39,460
you can actually expand it to be not

564
00:29:36,639 --> 00:29:42,699
only your scene but also your detection

565
00:29:39,460 --> 00:29:46,089
tool and your threatening the attack

566
00:29:42,700 --> 00:29:48,669
framework so I think I'm over with my

567
00:29:46,089 --> 00:29:50,678
time it's just one thank you and I don't

568
00:29:48,669 --> 00:29:53,589
know if we have questions or not time

569
00:29:50,679 --> 00:29:56,830
for questions but if we do I'll be happy

570
00:29:53,589 --> 00:29:58,839
to answer them yeah so um payoneer thank

571
00:29:56,830 --> 00:30:01,089
you we really appreciate you presenting

572
00:29:58,839 --> 00:30:04,960
today I know there was a lot of good

573
00:30:01,089 --> 00:30:08,469
information about open source Tim um so

574
00:30:04,960 --> 00:30:11,139
there's some questions in slack on track

575
00:30:08,469 --> 00:30:14,889
neck most everybody's asking for a copy

576
00:30:11,139 --> 00:30:17,859
of the slides so you know if you want to

577
00:30:14,889 --> 00:30:20,830
yeah if you want a PDF um and then you

578
00:30:17,859 --> 00:30:24,359
know maybe make them available to

579
00:30:20,830 --> 00:30:27,099
everybody that would be very helpful

580
00:30:24,359 --> 00:30:32,099
otherwise we really appreciate your time

581
00:30:27,099 --> 00:30:32,099
today and speaking that besides Atlanta

