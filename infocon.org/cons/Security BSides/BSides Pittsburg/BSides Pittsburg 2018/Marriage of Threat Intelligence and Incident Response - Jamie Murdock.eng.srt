1
00:00:00,030 --> 00:00:04,049
so next on the stage is Amy Murdock he's

2
00:00:04,049 --> 00:00:05,580
going to be talking about the greatest

3
00:00:05,580 --> 00:00:08,880
buzzword of 2018 threat hunting and how

4
00:00:08,880 --> 00:00:10,620
you can get in on the action in a talk

5
00:00:10,620 --> 00:00:12,300
called the marriage of threat

6
00:00:12,300 --> 00:00:13,889
intelligence and incident response let's

7
00:00:13,889 --> 00:00:23,000
give him a nice hand thank you

8
00:00:23,000 --> 00:00:25,890
so before and I want to obviously say

9
00:00:25,890 --> 00:00:28,140
thanks to besides Pittsburgh it's my

10
00:00:28,140 --> 00:00:30,359
first time being here and so you know

11
00:00:30,359 --> 00:00:31,560
being an attendee and a speaker the

12
00:00:31,560 --> 00:00:33,690
first time is pretty awesome so thank

13
00:00:33,690 --> 00:00:35,160
you everyone for that I wish it wasn't

14
00:00:35,160 --> 00:00:36,719
at this venue because I'm already down

15
00:00:36,719 --> 00:00:40,320
like 40 bucks in the casino so it's yeah

16
00:00:40,320 --> 00:00:44,489
thank you for that yeah so yeah this

17
00:00:44,489 --> 00:00:50,039
this talk is throw intelligence and it's

18
00:00:50,039 --> 00:00:51,629
a response and how we can utilize that

19
00:00:51,629 --> 00:00:53,910
natural threat honey so before I

20
00:00:53,910 --> 00:00:56,850
actually begin since we are at 331 I

21
00:00:56,850 --> 00:00:58,590
like to have fun at my talks if you ever

22
00:00:58,590 --> 00:01:00,000
been in any of my talks I like to have

23
00:01:00,000 --> 00:01:01,710
fun like to have some crowd

24
00:01:01,710 --> 00:01:02,579
participation

25
00:01:02,579 --> 00:01:04,700
so after this gentleman sits down

26
00:01:04,700 --> 00:01:06,840
anytime that somebody comes in because

27
00:01:06,840 --> 00:01:07,950
they're late we're gonna point at him

28
00:01:07,950 --> 00:01:10,409
and laugh does that work

29
00:01:10,409 --> 00:01:21,780
stand by haha so all right let's get

30
00:01:21,780 --> 00:01:26,340
started oh yeah that's the second part

31
00:01:26,340 --> 00:01:27,000
of that I forgot

32
00:01:27,000 --> 00:01:28,590
so my marketing our marketing department

33
00:01:28,590 --> 00:01:30,420
actually like redid my slides because

34
00:01:30,420 --> 00:01:31,770
they look like crap because I do them

35
00:01:31,770 --> 00:01:33,810
and they said hey can we take a crack at

36
00:01:33,810 --> 00:01:36,600
your slides and I was like yeah so they

37
00:01:36,600 --> 00:01:37,920
made some like really cool that I

38
00:01:37,920 --> 00:01:40,049
wouldn't have done alright so let's get

39
00:01:40,049 --> 00:01:41,640
this out of the way this is about me

40
00:01:41,640 --> 00:01:43,649
I am the security program manager at M

41
00:01:43,649 --> 00:01:45,720
arcade technologies I've been doing this

42
00:01:45,720 --> 00:01:48,149
for about twenty years most of my focus

43
00:01:48,149 --> 00:01:49,680
in my career has been on security

44
00:01:49,680 --> 00:01:51,390
operations threat intelligence and

45
00:01:51,390 --> 00:01:58,979
Incident Response you know your career

46
00:01:58,979 --> 00:02:00,240
is great everyone likes to have a good

47
00:02:00,240 --> 00:02:02,100
career but I don't identify myself as my

48
00:02:02,100 --> 00:02:04,740
career identify as a father as a husband

49
00:02:04,740 --> 00:02:08,128
as a former Marine and as a gamer okay

50
00:02:08,128 --> 00:02:08,889
yeah

51
00:02:08,889 --> 00:02:13,600
because I'm a super nerd oh yeah and at

52
00:02:13,600 --> 00:02:15,160
bow dock if you want to follow me on

53
00:02:15,160 --> 00:02:17,530
Twitter but I don't I just like

54
00:02:17,530 --> 00:02:19,030
retweeting everyone else's so it

55
00:02:19,030 --> 00:02:20,890
doesn't matter so what are we gonna talk

56
00:02:20,890 --> 00:02:24,130
about today we're gonna focus on what

57
00:02:24,130 --> 00:02:26,950
threat hunting is and it's nothing new I

58
00:02:26,950 --> 00:02:28,630
mean yeah it's an awesome buzzword for

59
00:02:28,630 --> 00:02:31,170
2018 if you want to sell some stuff but

60
00:02:31,170 --> 00:02:33,670
it's been going over all its we've been

61
00:02:33,670 --> 00:02:35,620
doing threat hunting for a long time it

62
00:02:35,620 --> 00:02:37,300
just didn't have that cool name so we're

63
00:02:37,300 --> 00:02:38,920
gonna kind of get into how all that ties

64
00:02:38,920 --> 00:02:41,320
into play with incident response with

65
00:02:41,320 --> 00:02:43,900
threat intelligence and how to bring all

66
00:02:43,900 --> 00:02:45,670
that together so you can go back to your

67
00:02:45,670 --> 00:02:47,050
organization and go hey I want to do

68
00:02:47,050 --> 00:02:48,280
some threat hunting because it's really

69
00:02:48,280 --> 00:02:50,830
cool sound good I hope so because you're

70
00:02:50,830 --> 00:02:52,810
here so

71
00:02:52,810 --> 00:02:55,780
threat hunting is the new hotness for

72
00:02:55,780 --> 00:03:00,459
2018 sorry threat intelligence you're

73
00:03:00,459 --> 00:03:01,330
not hot anymore

74
00:03:01,330 --> 00:03:04,720
now it's threat hunting so from a show

75
00:03:04,720 --> 00:03:07,540
of hands who has heard of threatening

76
00:03:07,540 --> 00:03:11,920
ooh you like that ooh

77
00:03:11,920 --> 00:03:15,010
so how many now is the same show of

78
00:03:15,010 --> 00:03:16,660
hands how many heard of threat hunting

79
00:03:16,660 --> 00:03:19,890
before he's 17

80
00:03:19,890 --> 00:03:24,190
few of us right ish right but it wasn't

81
00:03:24,190 --> 00:03:25,690
called threatening it's just part of our

82
00:03:25,690 --> 00:03:27,340
job when we tried to figure out if we

83
00:03:27,340 --> 00:03:29,890
had an intruder in the environment but

84
00:03:29,890 --> 00:03:31,420
marketing gets a hold of things and says

85
00:03:31,420 --> 00:03:33,070
we can sell so much service and product

86
00:03:33,070 --> 00:03:37,360
if we actually label it a name to me

87
00:03:37,360 --> 00:03:39,580
threatening starts with your incident

88
00:03:39,580 --> 00:03:43,060
response program now I've given a lot of

89
00:03:43,060 --> 00:03:44,650
talks on Incident Response and I've

90
00:03:44,650 --> 00:03:48,510
given a lot of tabletop tabletop plays

91
00:03:48,510 --> 00:03:51,820
for Incident Response and what drives me

92
00:03:51,820 --> 00:03:55,050
nuts is haha

93
00:03:55,050 --> 00:03:59,010
is we have tabletop exercises that we do

94
00:03:59,010 --> 00:04:01,170
in our organization how many here if you

95
00:04:01,170 --> 00:04:02,520
want to raise your hand do a tabletop

96
00:04:02,520 --> 00:04:05,370
exercise in your organization good it's

97
00:04:05,370 --> 00:04:07,260
a lot better it actually grows every

98
00:04:07,260 --> 00:04:09,330
year and that's awesome now for those of

99
00:04:09,330 --> 00:04:11,010
you who raised your hand helped you

100
00:04:11,010 --> 00:04:13,050
include more than just IT functions in

101
00:04:13,050 --> 00:04:16,410
your table exercises awesome if you're

102
00:04:16,410 --> 00:04:18,720
not it's probably not your fault you've

103
00:04:18,720 --> 00:04:20,370
probably tried to get business units and

104
00:04:20,370 --> 00:04:22,680
HR in the c-suite and everyone else

105
00:04:22,680 --> 00:04:26,070
involved but they're what thank you

106
00:04:26,070 --> 00:04:28,350
they're too busy I don't have time for

107
00:04:28,350 --> 00:04:30,410
that that's an IT function that's not us

108
00:04:30,410 --> 00:04:34,440
that's the absolute wrong answer it is

109
00:04:34,440 --> 00:04:37,170
critical to have groups like HR legal

110
00:04:37,170 --> 00:04:38,700
corporate communications operations

111
00:04:38,700 --> 00:04:41,580
senior executive management now for

112
00:04:41,580 --> 00:04:42,480
those of you who have not done a

113
00:04:42,480 --> 00:04:45,660
tabletop exercise anyone why do you

114
00:04:45,660 --> 00:04:46,860
think that's important to have a group

115
00:04:46,860 --> 00:04:48,600
these people in the room when you're

116
00:04:48,600 --> 00:04:54,480
doing it's and response talks if they're

117
00:04:54,480 --> 00:04:56,400
not in the room nobody cares it's

118
00:04:56,400 --> 00:05:00,720
absolutely right we as IT folks

119
00:05:00,720 --> 00:05:02,790
information security or different IT

120
00:05:02,790 --> 00:05:04,800
silos we are not responsible for instant

121
00:05:04,800 --> 00:05:06,960
response we have this much to do with it

122
00:05:06,960 --> 00:05:08,400
if you really look what Incident

123
00:05:08,400 --> 00:05:10,050
Response means we have this much to do

124
00:05:10,050 --> 00:05:12,030
with it everything else is the business

125
00:05:12,030 --> 00:05:13,020
side and we're gonna talk more about

126
00:05:13,020 --> 00:05:15,840
that but when we come dints in a

127
00:05:15,840 --> 00:05:19,110
response raise your hand if you want if

128
00:05:19,110 --> 00:05:21,030
not that's fine how many people in your

129
00:05:21,030 --> 00:05:22,890
organization or an organization maybe

130
00:05:22,890 --> 00:05:24,600
you worked at before did not have a

131
00:05:24,600 --> 00:05:27,900
formal incident response planning and I

132
00:05:27,900 --> 00:05:29,220
understand there's probably people I'm

133
00:05:29,220 --> 00:05:31,250
not raising my hand and that's fine

134
00:05:31,250 --> 00:05:33,180
you'd be surprised the amount of

135
00:05:33,180 --> 00:05:35,010
organizations that do not have an actual

136
00:05:35,010 --> 00:05:36,900
incident response plan not only do they

137
00:05:36,900 --> 00:05:38,940
die one they don't think it's important

138
00:05:38,940 --> 00:05:41,400
no I didn't think it's important they're

139
00:05:41,400 --> 00:05:42,990
companies which names you would be like

140
00:05:42,990 --> 00:05:46,880
oh I know them very large name-brand

141
00:05:46,880 --> 00:05:50,550
organizations that think an incident

142
00:05:50,550 --> 00:05:52,919
response is something that falls in line

143
00:05:52,919 --> 00:05:56,460
with disaster recovery how many how many

144
00:05:56,460 --> 00:05:58,080
people here think that's would agree

145
00:05:58,080 --> 00:06:00,180
with that and it's a response falls in

146
00:06:00,180 --> 00:06:04,070
line with zest for recovery good no one

147
00:06:04,070 --> 00:06:06,960
so what I'm going to get ready to show

148
00:06:06,960 --> 00:06:08,940
you is a traditional Incident Response

149
00:06:08,940 --> 00:06:11,760
model probably as everyone has seen this

150
00:06:11,760 --> 00:06:13,430
before right

151
00:06:13,430 --> 00:06:16,890
classic phases preparation detection

152
00:06:16,890 --> 00:06:18,840
analysis containment eradication

153
00:06:18,840 --> 00:06:21,630
recovery post incident activity this is

154
00:06:21,630 --> 00:06:26,250
the incident response model 101 I agree

155
00:06:26,250 --> 00:06:28,860
with this for the context of this talk

156
00:06:28,860 --> 00:06:30,480
however when we're talking about threat

157
00:06:30,480 --> 00:06:33,000
hunting I have a little bit different

158
00:06:33,000 --> 00:06:38,280
approach to it okay never mind

159
00:06:38,280 --> 00:06:40,230
again marketing to my slides and I

160
00:06:40,230 --> 00:06:41,160
thought I had something different I

161
00:06:41,160 --> 00:06:43,200
don't that's cool so the way I look at

162
00:06:43,200 --> 00:06:45,660
it is actually starting with detection

163
00:06:45,660 --> 00:06:48,180
as the first stage in instant response

164
00:06:48,180 --> 00:06:49,620
we're gonna go through all these stages

165
00:06:49,620 --> 00:06:50,940
you can kind of get an understanding of

166
00:06:50,940 --> 00:06:53,640
why so detection analysis and threat

167
00:06:53,640 --> 00:06:55,380
intelligence containment hunting

168
00:06:55,380 --> 00:06:58,470
eradication post incident preparation I

169
00:06:58,470 --> 00:07:00,270
know it seems a little weird so bear

170
00:07:00,270 --> 00:07:05,130
with me until the end to get into the

171
00:07:05,130 --> 00:07:07,440
guts of what we're gonna do here let's

172
00:07:07,440 --> 00:07:10,110
start with detection detection is pretty

173
00:07:10,110 --> 00:07:12,750
simple that is like the easiest part of

174
00:07:12,750 --> 00:07:14,340
what we're gonna do in this entire

175
00:07:14,340 --> 00:07:16,650
process of threat hunting we're gonna

176
00:07:16,650 --> 00:07:19,230
identify a security event now notice I

177
00:07:19,230 --> 00:07:23,280
said security event aha it's a security

178
00:07:23,280 --> 00:07:24,630
event we don't know if it's an incident

179
00:07:24,630 --> 00:07:27,720
yet it could be you know Jamie blocked

180
00:07:27,720 --> 00:07:30,000
his password because he changed it and

181
00:07:30,000 --> 00:07:31,620
his phone is going crazy trying to

182
00:07:31,620 --> 00:07:35,450
authenticate is that a security incident

183
00:07:35,450 --> 00:07:38,100
if that's what happened behind it no

184
00:07:38,100 --> 00:07:40,680
it's an event so we need to identify the

185
00:07:40,680 --> 00:07:43,740
event determine if it's an incident now

186
00:07:43,740 --> 00:07:46,020
most importantly and if anyone's been

187
00:07:46,020 --> 00:07:48,510
through a true incident this next step

188
00:07:48,510 --> 00:07:51,180
is actually extremely hard to do record

189
00:07:51,180 --> 00:07:53,130
all the steps tools and analysis or post

190
00:07:53,130 --> 00:07:56,430
incident activities now who here has

191
00:07:56,430 --> 00:07:58,320
been involved in an incident before like

192
00:07:58,320 --> 00:08:01,320
a legit ohshit incident right how many

193
00:08:01,320 --> 00:08:03,240
of you remember to write down everything

194
00:08:03,240 --> 00:08:09,570
that you did couple that is extremely

195
00:08:09,570 --> 00:08:11,310
hard to do because when you're trying to

196
00:08:11,310 --> 00:08:13,200
15 different things communicate with 30

197
00:08:13,200 --> 00:08:15,240
different people and identify what the

198
00:08:15,240 --> 00:08:17,070
next step should be it's hard to

199
00:08:17,070 --> 00:08:19,350
actually write everything down now if

200
00:08:19,350 --> 00:08:20,310
you're in a room and you have the

201
00:08:20,310 --> 00:08:21,930
incident the core team of Incident

202
00:08:21,930 --> 00:08:22,919
Response together

203
00:08:22,919 --> 00:08:24,629
like the IT silos and security it's a

204
00:08:24,629 --> 00:08:26,039
little easier because you can go you

205
00:08:26,039 --> 00:08:27,569
guess what your job is you're gonna

206
00:08:27,569 --> 00:08:28,469
write everything down

207
00:08:28,469 --> 00:08:31,650
you know ascribe this guy knows what I'm

208
00:08:31,650 --> 00:08:34,529
talking about so what do we what do we

209
00:08:34,529 --> 00:08:37,289
use for identifying a potential incident

210
00:08:37,289 --> 00:08:39,690
well is our monitoring detection systems

211
00:08:39,690 --> 00:08:42,349
we reuse our sim we're gonna use our

212
00:08:42,349 --> 00:08:45,120
local movement detection platforms we're

213
00:08:45,120 --> 00:08:47,579
gonna use whatever we at our disposal to

214
00:08:47,579 --> 00:08:50,040
say hey this is something you might want

215
00:08:50,040 --> 00:08:55,380
to look at in that space in detection

216
00:08:55,380 --> 00:08:57,600
we're gonna get one of the key things

217
00:08:57,600 --> 00:08:58,829
we're gonna utilize throughout the

218
00:08:58,829 --> 00:09:01,529
entire process indicators are

219
00:09:01,529 --> 00:09:04,980
compromised is everyone familiar with

220
00:09:04,980 --> 00:09:07,860
the term indicators compromise okay cool

221
00:09:07,860 --> 00:09:11,790
I can skip that so we have all this

222
00:09:11,790 --> 00:09:14,190
stuff now we know something happened but

223
00:09:14,190 --> 00:09:15,779
we don't know exactly if it's an

224
00:09:15,779 --> 00:09:17,790
incident or not well we have some basic

225
00:09:17,790 --> 00:09:20,399
indicators to compromise and those come

226
00:09:20,399 --> 00:09:21,690
from the details when we start our

227
00:09:21,690 --> 00:09:24,630
analysis we're gonna have hopefully you

228
00:09:24,630 --> 00:09:26,160
know some basic things like source and

229
00:09:26,160 --> 00:09:28,920
destination addresses ports any other

230
00:09:28,920 --> 00:09:32,220
signs like hashes signatures for

231
00:09:32,220 --> 00:09:34,680
different detection platforms domain

232
00:09:34,680 --> 00:09:36,480
names blah blah blah blah blah the list

233
00:09:36,480 --> 00:09:39,120
goes on right well we need to look into

234
00:09:39,120 --> 00:09:42,180
each one of these because even though

235
00:09:42,180 --> 00:09:46,670
the source IP address might be 10.1.1.10

236
00:09:46,670 --> 00:09:50,399
server over here okay well let's look at

237
00:09:50,399 --> 00:09:52,070
that server because it's part of this

238
00:09:52,070 --> 00:09:54,000
potential incident and let's see what

239
00:09:54,000 --> 00:09:55,019
else is going on with it

240
00:09:55,019 --> 00:09:57,300
outside of what we know it's talking to

241
00:09:57,300 --> 00:10:00,630
let's not miss any other data when you

242
00:10:00,630 --> 00:10:01,980
run through an incident if you haven't

243
00:10:01,980 --> 00:10:03,930
done one before the biggest mistake you

244
00:10:03,930 --> 00:10:06,660
can make is assuming that your analysis

245
00:10:06,660 --> 00:10:09,990
is complete you have to run everything

246
00:10:09,990 --> 00:10:12,570
to ground I've been involved in instance

247
00:10:12,570 --> 00:10:14,910
before for clients and they said I said

248
00:10:14,910 --> 00:10:16,199
what have you done and they give me the

249
00:10:16,199 --> 00:10:18,660
whole list this address was talking to

250
00:10:18,660 --> 00:10:20,100
this and we know it's doing this we know

251
00:10:20,100 --> 00:10:21,269
it's bad and we know it's talking to

252
00:10:21,269 --> 00:10:24,300
this bad stuff cool have you seen what

253
00:10:24,300 --> 00:10:28,410
else is talking to know why not because

254
00:10:28,410 --> 00:10:30,449
I'm not seeing it on my it's not showing

255
00:10:30,449 --> 00:10:33,149
a red on this dashboard okay well you

256
00:10:33,149 --> 00:10:34,470
know it's an involved in an incident of

257
00:10:34,470 --> 00:10:36,240
some kind why aren't you looking to see

258
00:10:36,240 --> 00:10:36,570
if there's

259
00:10:36,570 --> 00:10:41,000
anything else is communicating with so

260
00:10:41,000 --> 00:10:43,200
when you go through and you do all this

261
00:10:43,200 --> 00:10:44,370
analysis and you're looking at these

262
00:10:44,370 --> 00:10:46,080
different things communication strains

263
00:10:46,080 --> 00:10:49,020
potential droppers anything it is you

264
00:10:49,020 --> 00:10:51,630
want to document all that information

265
00:10:51,630 --> 00:10:53,730
it's going to become key when you start

266
00:10:53,730 --> 00:10:55,710
creating and indicators compromise to go

267
00:10:55,710 --> 00:10:57,750
hunting it's also going to be key when

268
00:10:57,750 --> 00:10:59,160
you do your after-action report and

269
00:10:59,160 --> 00:11:01,590
whenever you do a write-up so hopefully

270
00:11:01,590 --> 00:11:02,970
you're updating your playbooks if you

271
00:11:02,970 --> 00:11:06,360
have any to next time be able to just

272
00:11:06,360 --> 00:11:09,570
run through it we're also going to look

273
00:11:09,570 --> 00:11:12,210
at we're going to investigate other

274
00:11:12,210 --> 00:11:15,210
results so how many here calls somebody

275
00:11:15,210 --> 00:11:17,160
in the security community and go hey man

276
00:11:17,160 --> 00:11:22,470
have you seen this before I highly

277
00:11:22,470 --> 00:11:25,170
suggest that any time you're asked that

278
00:11:25,170 --> 00:11:27,450
again you raise your hand I mean look to

279
00:11:27,450 --> 00:11:29,000
your neighbor right now look to the left

280
00:11:29,000 --> 00:11:31,050
come on yell seriously look to the left

281
00:11:31,050 --> 00:11:32,790
I'll stand here all night look to the

282
00:11:32,790 --> 00:11:36,750
right these are your peers the easier

283
00:11:36,750 --> 00:11:38,160
peers these are people you should be

284
00:11:38,160 --> 00:11:40,290
able to call and say hey have you seen

285
00:11:40,290 --> 00:11:43,890
any an increase in activity of oh three

286
00:11:43,890 --> 00:11:49,640
sixty five compromises from Africa why I

287
00:11:49,640 --> 00:11:52,020
didn't want to name a specific country

288
00:11:52,020 --> 00:11:54,360
but yes you know you should be able to

289
00:11:54,360 --> 00:11:56,490
reach out to somebody in the community

290
00:11:56,490 --> 00:11:58,710
and ask that so that's where this comes

291
00:11:58,710 --> 00:12:00,180
from and further investigating any other

292
00:12:00,180 --> 00:12:02,400
results from other searches and now

293
00:12:02,400 --> 00:12:03,390
obviously you don't have to say hey

294
00:12:03,390 --> 00:12:04,950
guess what right now we're in the middle

295
00:12:04,950 --> 00:12:07,770
of the breach and we have PII flowing

296
00:12:07,770 --> 00:12:10,020
out the door like it's water you don't

297
00:12:10,020 --> 00:12:11,280
have to say that all you have to say is

298
00:12:11,280 --> 00:12:12,860
hey have you seen this before

299
00:12:12,860 --> 00:12:15,930
you know let's utilize the skillsets in

300
00:12:15,930 --> 00:12:20,550
our community how many people have heard

301
00:12:20,550 --> 00:12:23,880
of threat intelligence everybody right

302
00:12:23,880 --> 00:12:25,560
their intelligence last year was the new

303
00:12:25,560 --> 00:12:25,920
hotness

304
00:12:25,920 --> 00:12:28,470
now it's threat hunting next year it'll

305
00:12:28,470 --> 00:12:32,700
be no threat something anyway every time

306
00:12:32,700 --> 00:12:34,170
I give a presentation on threat hunting

307
00:12:34,170 --> 00:12:36,390
I lead off with both threat intelligence

308
00:12:36,390 --> 00:12:38,580
I weed off with threat intelligence is

309
00:12:38,580 --> 00:12:40,770
more than just ones and zeros and it

310
00:12:40,770 --> 00:12:42,420
truly is threat intelligence is any

311
00:12:42,420 --> 00:12:44,100
threat torn organization whether it's

312
00:12:44,100 --> 00:12:47,100
cyber whether it's physical whether it's

313
00:12:47,100 --> 00:12:48,720
business related whether it's brand

314
00:12:48,720 --> 00:12:50,690
reputation that is a threat

315
00:12:50,690 --> 00:12:53,130
however the purpose of this could talk

316
00:12:53,130 --> 00:12:54,750
we're only going to focus on the ones

317
00:12:54,750 --> 00:12:56,760
and zeros but just keep that in the back

318
00:12:56,760 --> 00:12:58,290
your mind for intelligence is any threat

319
00:12:58,290 --> 00:13:01,920
to an organization so when we start

320
00:13:01,920 --> 00:13:03,360
looking at this and we're using it as

321
00:13:03,360 --> 00:13:05,670
part of our exercise for threat hunting

322
00:13:05,670 --> 00:13:08,670
in our exit in their intelligence if you

323
00:13:08,670 --> 00:13:09,930
haven't done if you don't think you've

324
00:13:09,930 --> 00:13:12,360
done it before I guarantee you have how

325
00:13:12,360 --> 00:13:13,650
many people have used Google to look

326
00:13:13,650 --> 00:13:14,820
something up that they're working on

327
00:13:14,820 --> 00:13:16,440
everyone raises their hand

328
00:13:16,440 --> 00:13:17,550
yep that's threat intelligence

329
00:13:17,550 --> 00:13:19,530
congratulations from now all threat

330
00:13:19,530 --> 00:13:21,990
intelligence experts it's called open

331
00:13:21,990 --> 00:13:22,830
source intelligence

332
00:13:22,830 --> 00:13:25,350
Osen open source intelligence just like

333
00:13:25,350 --> 00:13:27,870
it sounds is anything that you can that

334
00:13:27,870 --> 00:13:30,270
is readily and publicly available for

335
00:13:30,270 --> 00:13:33,510
you to gain information on my favorite

336
00:13:33,510 --> 00:13:36,390
source of assent has been and continues

337
00:13:36,390 --> 00:13:40,200
to be so far Twitter Twitter's awesome

338
00:13:40,200 --> 00:13:42,330
it's not as awesome as it used to be

339
00:13:42,330 --> 00:13:45,270
back in the early 2000s when you know

340
00:13:45,270 --> 00:13:48,120
I'm going to attack Bank of America on

341
00:13:48,120 --> 00:13:50,760
this date because they you know screwed

342
00:13:50,760 --> 00:13:52,680
up my checking account that stuff used

343
00:13:52,680 --> 00:13:53,910
to be plastered all over Twitter so you

344
00:13:53,910 --> 00:13:55,800
kind of knew who was doing what who was

345
00:13:55,800 --> 00:13:56,640
just trying to make a name for

346
00:13:56,640 --> 00:13:58,800
themselves all the fun stuff so you

347
00:13:58,800 --> 00:14:00,030
actually track threat actors

348
00:14:00,030 --> 00:14:02,550
unfortunately they kind of evolved have

349
00:14:02,550 --> 00:14:03,870
gotten smarter they went down to the

350
00:14:03,870 --> 00:14:06,150
dark web more but still there's still a

351
00:14:06,150 --> 00:14:07,260
lot of good stuff and open source

352
00:14:07,260 --> 00:14:10,230
intelligence you can get so if you've

353
00:14:10,230 --> 00:14:12,660
looked up is this IP malicious you've

354
00:14:12,660 --> 00:14:14,880
done threat intelligence I mean that's

355
00:14:14,880 --> 00:14:16,740
it's that it literally is that simple

356
00:14:16,740 --> 00:14:19,710
it's not like you have to spend your

357
00:14:19,710 --> 00:14:21,420
time in a dark room creating a false

358
00:14:21,420 --> 00:14:23,610
persona to get invited to a forum on the

359
00:14:23,610 --> 00:14:24,630
dark web that will actually get you

360
00:14:24,630 --> 00:14:25,860
somewhere else we can go for hire a

361
00:14:25,860 --> 00:14:28,140
hacker and get even more information now

362
00:14:28,140 --> 00:14:30,090
that's like legit hardcore threat

363
00:14:30,090 --> 00:14:33,330
intelligence but you can do threat

364
00:14:33,330 --> 00:14:37,950
intelligence without having that anyone

365
00:14:37,950 --> 00:14:41,160
familiar with that screen one two three

366
00:14:41,160 --> 00:14:44,970
four phew yeah so and and this is not

367
00:14:44,970 --> 00:14:46,530
product placement any way shape or form

368
00:14:46,530 --> 00:14:49,140
this is a free service offered by

369
00:14:49,140 --> 00:14:51,120
alienvault it's called otx

370
00:14:51,120 --> 00:14:53,910
it is a great resource for threat

371
00:14:53,910 --> 00:14:59,420
intelligence so what I have here is

372
00:14:59,420 --> 00:15:03,820
something I was looking at and

373
00:15:03,820 --> 00:15:05,770
this is legit this is something I

374
00:15:05,770 --> 00:15:09,220
actually worked on and I went to otx and

375
00:15:09,220 --> 00:15:10,420
I said huh

376
00:15:10,420 --> 00:15:12,460
what is this host name because I saw

377
00:15:12,460 --> 00:15:14,650
communications paths to it I put in the

378
00:15:14,650 --> 00:15:19,120
host name and it pops up does this thing

379
00:15:19,120 --> 00:15:23,670
have a laser see if I screw anything up

380
00:15:23,670 --> 00:15:26,530
so I look up the host name and I see it

381
00:15:26,530 --> 00:15:28,990
has a pulse if you're not familiar with

382
00:15:28,990 --> 00:15:30,940
otx a pulse means somebody's created

383
00:15:30,940 --> 00:15:34,270
something that includes whatever that

384
00:15:34,270 --> 00:15:39,270
search term was so I go to the pulse and

385
00:15:39,270 --> 00:15:42,130
then I start getting all this

386
00:15:42,130 --> 00:15:46,180
information here so those are md5 hashes

387
00:15:46,180 --> 00:15:49,630
that are associated with this pulse if

388
00:15:49,630 --> 00:15:52,530
you can't read that up there very well

389
00:15:52,530 --> 00:15:57,340
the pulse is basically it's this botnet

390
00:15:57,340 --> 00:15:58,930
miner for cryptocurrency and it has a

391
00:15:58,930 --> 00:16:02,080
reference and then it has tags and you

392
00:16:02,080 --> 00:16:04,090
can see in the blue and it says

393
00:16:04,090 --> 00:16:05,650
indicators to compromise somewhere

394
00:16:05,650 --> 00:16:06,160
around there

395
00:16:06,160 --> 00:16:10,030
indicators compromised 51 well on this

396
00:16:10,030 --> 00:16:14,260
specific pulse there's 51 md5 hashes

397
00:16:14,260 --> 00:16:17,530
sometimes those are also IP addresses

398
00:16:17,530 --> 00:16:20,050
domain names it depends on you know what

399
00:16:20,050 --> 00:16:21,390
they found and who found them

400
00:16:21,390 --> 00:16:25,300
so I said huh there's a reference on

401
00:16:25,300 --> 00:16:26,920
this I want to see you know what

402
00:16:26,920 --> 00:16:29,020
somebody wrote up about this and I'm not

403
00:16:29,020 --> 00:16:31,420
gonna read this whole thing but this

404
00:16:31,420 --> 00:16:35,050
goes into what this botnet does how it

405
00:16:35,050 --> 00:16:37,690
operates and one of the most important

406
00:16:37,690 --> 00:16:43,690
things is I think it's there doo doo doo

407
00:16:43,690 --> 00:16:47,010
doo no it's down there right there

408
00:16:47,010 --> 00:16:49,720
infected with NSA Arsenal spread the

409
00:16:49,720 --> 00:16:52,660
recipe for four or five that's some

410
00:16:52,660 --> 00:16:53,980
awesome information to have if you're

411
00:16:53,980 --> 00:16:55,210
defending and you're trying to contain

412
00:16:55,210 --> 00:16:58,960
right you know exactly what port that

413
00:16:58,960 --> 00:17:00,790
this specific button at anyway this

414
00:17:00,790 --> 00:17:02,680
specific cryptocurrency miner is trying

415
00:17:02,680 --> 00:17:07,060
to utilize so we put that away there's

416
00:17:07,060 --> 00:17:09,280
also some other information there again

417
00:17:09,280 --> 00:17:11,920
this would open source intelligence and

418
00:17:11,920 --> 00:17:14,319
it took me a whole two or three minutes

419
00:17:14,319 --> 00:17:16,569
to get this information because I knew

420
00:17:16,569 --> 00:17:19,198
where to go and look

421
00:17:20,259 --> 00:17:23,169
so again we sought we have a host name

422
00:17:23,169 --> 00:17:25,339
we knew was doing something bad we

423
00:17:25,339 --> 00:17:26,539
gathered some intelligence and

424
00:17:26,539 --> 00:17:28,879
discovered it was on this nasty botnet

425
00:17:28,879 --> 00:17:34,879
so what would get old Ilan do this is

426
00:17:34,879 --> 00:17:37,659
where we play this is where we play

427
00:17:37,659 --> 00:17:40,820
participation so based on what we just

428
00:17:40,820 --> 00:17:49,490
saw so we have SMB port 4 4 5 in fact

429
00:17:49,490 --> 00:17:52,250
with an essay or arsenal now Ilana wants

430
00:17:52,250 --> 00:17:55,029
to know what do we do now

431
00:17:56,950 --> 00:18:02,049
block block 4 4 5 what else

432
00:18:06,610 --> 00:18:09,289
boom utilize what we saw those hashes

433
00:18:09,289 --> 00:18:10,820
and 4 4 5 look for any other

434
00:18:10,820 --> 00:18:14,740
communications what else could we do

435
00:18:18,519 --> 00:18:20,809
close you can't chuck the computer in

436
00:18:20,809 --> 00:18:25,009
space but you can nuke it from orbit any

437
00:18:25,009 --> 00:18:28,480
way else going going

438
00:18:33,020 --> 00:18:36,270
you get my empty bottle I don't have any

439
00:18:36,270 --> 00:18:39,330
swag sorry yeah we can grab that

440
00:18:39,330 --> 00:18:42,200
computer we know that in this scenario

441
00:18:42,200 --> 00:18:44,340
that we've seen it communicating we know

442
00:18:44,340 --> 00:18:46,320
some bad shit's going on so let's focus

443
00:18:46,320 --> 00:18:48,510
on that computer we have patient

444
00:18:48,510 --> 00:18:55,169
potentially patient zero so in this

445
00:18:55,169 --> 00:18:58,110
rough scenario we've looked something

446
00:18:58,110 --> 00:18:59,809
popped up said hey this is bad

447
00:18:59,809 --> 00:19:02,340
we've done some intelligence on it we've

448
00:19:02,340 --> 00:19:04,620
analyzed it now we need to start the

449
00:19:04,620 --> 00:19:06,299
process of stopping the bleeding if

450
00:19:06,299 --> 00:19:07,770
you've been in an incident before you

451
00:19:07,770 --> 00:19:09,059
know that it does not go this fast

452
00:19:09,059 --> 00:19:12,120
however for the sake of time we're

453
00:19:12,120 --> 00:19:15,990
skipping really passed through this this

454
00:19:15,990 --> 00:19:18,320
is the hard part you have to balance

455
00:19:18,320 --> 00:19:21,390
business needs with what your gut tells

456
00:19:21,390 --> 00:19:24,899
you your gut might say and it's a as a

457
00:19:24,899 --> 00:19:27,240
security purist right but we're gonna

458
00:19:27,240 --> 00:19:30,720
block four four five right now however

459
00:19:30,720 --> 00:19:32,669
and this is where it comes into play

460
00:19:32,669 --> 00:19:34,890
that senior executives all these other

461
00:19:34,890 --> 00:19:37,620
business units have to be involved we

462
00:19:37,620 --> 00:19:41,010
can say block four or four or five but

463
00:19:41,010 --> 00:19:43,080
if there is a comission critical

464
00:19:43,080 --> 00:19:45,299
business application that utilizes port

465
00:19:45,299 --> 00:19:50,309
445 whose decision is it to make that or

466
00:19:50,309 --> 00:19:53,130
who makes that decision for us it ain't

467
00:19:53,130 --> 00:19:56,909
us whoever makes the most money is

468
00:19:56,909 --> 00:19:59,490
usually correct but it's gonna be

469
00:19:59,490 --> 00:20:02,580
somebody who has the authority to say

470
00:20:02,580 --> 00:20:04,559
we're gonna block this or we're not

471
00:20:04,559 --> 00:20:05,970
gonna block this we're gonna assume the

472
00:20:05,970 --> 00:20:08,580
risk and here's why that's why it's

473
00:20:08,580 --> 00:20:17,190
critical for yeah man stop reading my

474
00:20:17,190 --> 00:20:19,320
slides ahead of time now I'm just

475
00:20:19,320 --> 00:20:21,390
kidding but you're absolutely right you

476
00:20:21,390 --> 00:20:22,649
know there's a lot of factors that go

477
00:20:22,649 --> 00:20:26,669
into this excuse me so

478
00:20:26,669 --> 00:20:33,749
I'm impression let's alright so now I'm

479
00:20:33,749 --> 00:20:34,700
good

480
00:20:34,700 --> 00:20:36,960
it's increment it's critical to have

481
00:20:36,960 --> 00:20:39,690
business units involved I can't say we

482
00:20:39,690 --> 00:20:41,129
have to block four four five we're going

483
00:20:41,129 --> 00:20:43,590
to do it right now but I can as the

484
00:20:43,590 --> 00:20:46,399
security expert in my organization say

485
00:20:46,399 --> 00:20:49,590
here's the risk if we don't here's what

486
00:20:49,590 --> 00:20:51,539
we know about the specific attack vector

487
00:20:51,539 --> 00:20:53,570
here's what we know about the specific

488
00:20:53,570 --> 00:20:58,019
cryptocurrency mining botnet if we

489
00:20:58,019 --> 00:21:00,809
choose to assume the risk and not block

490
00:21:00,809 --> 00:21:02,669
four or four or five here's what can

491
00:21:02,669 --> 00:21:05,970
happen then it becomes a business

492
00:21:05,970 --> 00:21:08,629
decision we have to empower business

493
00:21:08,629 --> 00:21:12,779
makers to make the right decision and if

494
00:21:12,779 --> 00:21:14,789
they don't that's when we kind of throw

495
00:21:14,789 --> 00:21:15,869
our hands in the air and we get really

496
00:21:15,869 --> 00:21:18,570
mad and we say we're screwed and go

497
00:21:18,570 --> 00:21:22,850
drink does everyone understand that part

498
00:21:22,850 --> 00:21:25,679
no Cheers

499
00:21:25,679 --> 00:21:29,940
no the business part because that's crew

500
00:21:29,940 --> 00:21:31,049
divided worked in a lot of organizations

501
00:21:31,049 --> 00:21:35,039
that didn't know to make the right

502
00:21:35,039 --> 00:21:36,720
decision because the right technical

503
00:21:36,720 --> 00:21:38,039
folks didn't give them the right advice

504
00:21:38,039 --> 00:21:39,600
they just said you have to you have to

505
00:21:39,600 --> 00:21:41,759
you have to without providing them the

506
00:21:41,759 --> 00:21:44,999
risk if they don't so communicating risk

507
00:21:44,999 --> 00:21:47,629
is how you actually speak business

508
00:21:47,629 --> 00:21:50,580
because if you say everything from a

509
00:21:50,580 --> 00:21:51,869
security perspective they're gonna be

510
00:21:51,869 --> 00:21:56,100
like no but if we tell them what the

511
00:21:56,100 --> 00:21:57,299
actual risk is they're gonna listen

512
00:21:57,299 --> 00:22:01,320
hopefully so let's have some fun now

513
00:22:01,320 --> 00:22:03,119
we're gonna start talking about actual

514
00:22:03,119 --> 00:22:05,039
threat hunting or as I like to call it

515
00:22:05,039 --> 00:22:08,100
the stuff we normally do anyway threat

516
00:22:08,100 --> 00:22:09,629
hunting we're gonna detect the intruder

517
00:22:09,629 --> 00:22:11,820
we've done that right we've gone through

518
00:22:11,820 --> 00:22:14,369
our detection phase we're going to

519
00:22:14,369 --> 00:22:16,139
prevent them from getting a stronger

520
00:22:16,139 --> 00:22:18,869
foothold we're gonna talk a little bit

521
00:22:18,869 --> 00:22:20,669
about that put your thinking caps on

522
00:22:20,669 --> 00:22:21,629
because I'm going to be asking you some

523
00:22:21,629 --> 00:22:23,369
questions about that and then most

524
00:22:23,369 --> 00:22:24,720
importantly we want them out of our

525
00:22:24,720 --> 00:22:27,119
network as soon as we can get as much

526
00:22:27,119 --> 00:22:29,399
information as we can to contain them to

527
00:22:29,399 --> 00:22:30,840
figure out how they got in how to

528
00:22:30,840 --> 00:22:33,299
correctly get them out and then execute

529
00:22:33,299 --> 00:22:36,389
that to eradicate that's important

530
00:22:36,389 --> 00:22:38,429
however it's gentleman pointer that

531
00:22:38,429 --> 00:22:39,929
brought up a good point we're gonna hit

532
00:22:39,929 --> 00:22:40,470
here in a

533
00:22:40,470 --> 00:22:43,080
and you have to balance that with how

534
00:22:43,080 --> 00:22:44,789
much you want the intruder to actually

535
00:22:44,789 --> 00:22:50,030
know what that you know right so that's

536
00:22:50,030 --> 00:22:52,140
that's a game of chess that we're going

537
00:22:52,140 --> 00:22:55,250
to talk about who is familiar with TTP

538
00:22:55,250 --> 00:22:57,450
not OPP TTP

539
00:22:57,450 --> 00:22:59,490
all right good a bunch of us that's

540
00:22:59,490 --> 00:23:01,980
awesome so as tactics techniques proceed

541
00:23:01,980 --> 00:23:04,260
it's what an attacker does this is

542
00:23:04,260 --> 00:23:08,250
standard methodology attackers most

543
00:23:08,250 --> 00:23:12,570
attackers have the same TTP most of its

544
00:23:12,570 --> 00:23:17,010
in business I mean the the days of you

545
00:23:17,010 --> 00:23:19,470
know teenager in the mom's basement

546
00:23:19,470 --> 00:23:22,380
are pretty much over for real attackers

547
00:23:22,380 --> 00:23:24,360
you know for those of us who have gray

548
00:23:24,360 --> 00:23:26,220
in our hair we remember when that was

549
00:23:26,220 --> 00:23:29,400
like a big problem and that I wish that

550
00:23:29,400 --> 00:23:31,080
was the biggest problem right now we

551
00:23:31,080 --> 00:23:32,850
have sophisticated States we have

552
00:23:32,850 --> 00:23:34,710
criminal organizations we have all this

553
00:23:34,710 --> 00:23:36,659
other stuff it is literally a business

554
00:23:36,659 --> 00:23:43,230
the reason TTP's exist is to model who's

555
00:23:43,230 --> 00:23:44,640
doing what from a threat actor

556
00:23:44,640 --> 00:23:47,039
perspective and we're going to talk a

557
00:23:47,039 --> 00:23:49,280
little bit about something that I love

558
00:23:49,280 --> 00:23:52,530
very shortly but the might the main

559
00:23:52,530 --> 00:23:54,600
thing to get out of this is TTP that's

560
00:23:54,600 --> 00:23:56,640
how we identify attackers that's how we

561
00:23:56,640 --> 00:23:59,429
kind of you know puts a DNA to who's

562
00:23:59,429 --> 00:24:05,220
doing what toward us who knows this the

563
00:24:05,220 --> 00:24:09,030
old pyramid of pain so what the pyramid

564
00:24:09,030 --> 00:24:13,470
of pain shows is from the top up I'm

565
00:24:13,470 --> 00:24:16,110
sorry from the bottom up how much can we

566
00:24:16,110 --> 00:24:19,169
trust an indicator of compromise and how

567
00:24:19,169 --> 00:24:21,090
often do we see them so as you see on

568
00:24:21,090 --> 00:24:22,950
the bottom you have hash values well you

569
00:24:22,950 --> 00:24:26,610
see hash values all day long and they're

570
00:24:26,610 --> 00:24:29,549
the least trustworthy actual indicator

571
00:24:29,549 --> 00:24:30,900
compromise you can have we're gonna talk

572
00:24:30,900 --> 00:24:32,909
about a lot of these then you get up to

573
00:24:32,909 --> 00:24:35,190
the top which is true TTP

574
00:24:35,190 --> 00:24:38,159
it's the hardest to actually get but the

575
00:24:38,159 --> 00:24:40,260
most reliable indicator compromise that

576
00:24:40,260 --> 00:24:46,799
you can utilize so any questions on this

577
00:24:46,799 --> 00:24:49,230
slide we're going to talk more about

578
00:24:49,230 --> 00:24:52,620
each one but just in general anyone look

579
00:24:52,620 --> 00:24:54,299
at this and go I disagree

580
00:24:54,299 --> 00:24:57,179
because you Bree could be right I don't

581
00:24:57,179 --> 00:25:02,879
know I didn't write this okay so when we

582
00:25:02,879 --> 00:25:05,999
talk about indicators to compromise file

583
00:25:05,999 --> 00:25:07,379
names weren't even on the Pyramid of

584
00:25:07,379 --> 00:25:09,389
pain because let's face it if I drop

585
00:25:09,389 --> 00:25:11,639
something on your system and you use it

586
00:25:11,639 --> 00:25:14,099
you go strictly off my file name I am

587
00:25:14,099 --> 00:25:17,669
the worst hacker ever if my with my

588
00:25:17,669 --> 00:25:20,549
malware my my exploit that I wrote can

589
00:25:20,549 --> 00:25:22,739
be defeated because you can pick it up

590
00:25:22,739 --> 00:25:25,169
by a filename I suck it's probably

591
00:25:25,169 --> 00:25:26,820
something that I taught my kid to do for

592
00:25:26,820 --> 00:25:29,099
fun however when we started looking at

593
00:25:29,099 --> 00:25:30,149
hash values

594
00:25:30,149 --> 00:25:32,729
I'm not saying hash values are not a

595
00:25:32,729 --> 00:25:34,820
good indicator of compromise they are

596
00:25:34,820 --> 00:25:38,489
but how easy is it to change a hash it's

597
00:25:38,489 --> 00:25:40,289
extremely easy without having to do a

598
00:25:40,289 --> 00:25:42,779
lot of rewriting of my exploit or my

599
00:25:42,779 --> 00:25:45,829
malware on my ransomware whatever it is

600
00:25:45,829 --> 00:25:48,719
host names now we're getting a little

601
00:25:48,719 --> 00:25:49,399
bit better

602
00:25:49,399 --> 00:25:52,469
however host names can be changed very

603
00:25:52,469 --> 00:25:54,329
easy to you know you throw something in

604
00:25:54,329 --> 00:25:56,369
the past flux botnet fast bugs DNS

605
00:25:56,369 --> 00:25:59,309
button it at that hostname goes up the

606
00:25:59,309 --> 00:26:03,419
window but why is it harder to change a

607
00:26:03,419 --> 00:26:06,239
hostname if you're talking you know in

608
00:26:06,239 --> 00:26:08,129
our example where we have a crypto

609
00:26:08,129 --> 00:26:11,459
currency botnet why is it harder for

610
00:26:11,459 --> 00:26:14,549
them to change a hostname than a file

611
00:26:14,549 --> 00:26:22,099
hash then when I get paid what else

612
00:26:22,099 --> 00:26:24,389
imagine that you have that botnet set up

613
00:26:24,389 --> 00:26:30,659
and you wrote this code maybe you

614
00:26:30,659 --> 00:26:32,879
obfuscated it or its encrypt or whatever

615
00:26:32,879 --> 00:26:36,029
but how do you know how or how does it

616
00:26:36,029 --> 00:26:38,879
know who to talk to because you put a

617
00:26:38,879 --> 00:26:41,700
hostname in so if my hostname gets

618
00:26:41,700 --> 00:26:43,139
detected and it becomes a true indicator

619
00:26:43,139 --> 00:26:46,469
or compromised and it gets flagged I

620
00:26:46,469 --> 00:26:47,969
need to rewrite it that means I have to

621
00:26:47,969 --> 00:26:52,859
change my hostname ports the same thing

622
00:26:52,859 --> 00:26:54,359
you guys think ports are a little bit

623
00:26:54,359 --> 00:26:55,889
better from an indicator than a hostname

624
00:26:55,889 --> 00:26:59,399
is though because yeah I can utilize IP

625
00:26:59,399 --> 00:27:01,379
addresses or pass flux DNS for all these

626
00:27:01,379 --> 00:27:04,320
any of these fun little things to do at

627
00:27:04,320 --> 00:27:05,879
the end of the day I'm writing this code

628
00:27:05,879 --> 00:27:07,640
to work across

629
00:27:07,640 --> 00:27:10,520
a certain communication stream so it's

630
00:27:10,520 --> 00:27:12,050
harder to change what ports its

631
00:27:12,050 --> 00:27:14,840
utilizing than it is a hostname or even

632
00:27:14,840 --> 00:27:17,300
the hash of the file itself because then

633
00:27:17,300 --> 00:27:19,520
I have to completely rewrite a big

634
00:27:19,520 --> 00:27:22,520
portion of my code to inclusio right

635
00:27:22,520 --> 00:27:24,620
well now I'm going to use this protocol

636
00:27:24,620 --> 00:27:28,660
over this port instead everyone get that

637
00:27:28,660 --> 00:27:33,620
cool this isn't the end that bringing it

638
00:27:33,620 --> 00:27:36,020
all together should be there but hey I'm

639
00:27:36,020 --> 00:27:38,240
not marketing so when we look at

640
00:27:38,240 --> 00:27:39,320
everything that we've gone through so

641
00:27:39,320 --> 00:27:42,560
far though we saw something and we

642
00:27:42,560 --> 00:27:45,290
decided this is an incident we have an

643
00:27:45,290 --> 00:27:48,470
alarm in my sim for example and it said

644
00:27:48,470 --> 00:27:50,030
this is communicating to a potentially

645
00:27:50,030 --> 00:27:51,980
malicious host so I looked it up yeah

646
00:27:51,980 --> 00:27:53,620
sure it is

647
00:27:53,620 --> 00:27:56,090
we saw the host name it's communicating

648
00:27:56,090 --> 00:27:59,050
with so we took that information and we

649
00:27:59,050 --> 00:28:01,220
utilized open source intelligence to

650
00:28:01,220 --> 00:28:03,200
find out more information about the host

651
00:28:03,200 --> 00:28:05,000
and it turns out it's part of a crypto

652
00:28:05,000 --> 00:28:07,880
mining botnet we followed the standard

653
00:28:07,880 --> 00:28:09,860
steps of incident response so we went

654
00:28:09,860 --> 00:28:11,930
through our detection and analysis and

655
00:28:11,930 --> 00:28:13,850
we used indicators compromise and threat

656
00:28:13,850 --> 00:28:15,050
intelligence to get more and more

657
00:28:15,050 --> 00:28:17,180
information so that's where we're at

658
00:28:17,180 --> 00:28:21,890
currently so now let's use that and

659
00:28:21,890 --> 00:28:27,440
let's go hunting the rat hunting is very

660
00:28:27,440 --> 00:28:30,410
simple you know like I said it's the new

661
00:28:30,410 --> 00:28:32,930
buzz word of 2018 and it seems like it

662
00:28:32,930 --> 00:28:34,730
might something that's difficult and

663
00:28:34,730 --> 00:28:36,200
maybe it's something scary because you

664
00:28:36,200 --> 00:28:37,430
haven't heard of threat hunting before

665
00:28:37,430 --> 00:28:40,250
but more than likely if you've ever ran

666
00:28:40,250 --> 00:28:41,990
an incident through you've done some

667
00:28:41,990 --> 00:28:44,780
sort of threat hunting at the end of the

668
00:28:44,780 --> 00:28:46,100
day we're taking indicators to

669
00:28:46,100 --> 00:28:48,440
compromise that we have found or maybe

670
00:28:48,440 --> 00:28:51,050
we created them and we're gonna go in

671
00:28:51,050 --> 00:28:53,180
our environment and start looking for

672
00:28:53,180 --> 00:28:54,800
those indicators of compromise we're

673
00:28:54,800 --> 00:28:56,930
gonna start looking internally for any

674
00:28:56,930 --> 00:29:00,500
signs of this threat in this case now

675
00:29:00,500 --> 00:29:06,640
you can do a full 360

676
00:29:22,030 --> 00:29:24,350
we put into our monitoring and detection

677
00:29:24,350 --> 00:29:28,100
systems you know we spent $250,000 each

678
00:29:28,100 --> 00:29:30,770
probably roughly for all these different

679
00:29:30,770 --> 00:29:32,690
systems when you put these in here's a

680
00:29:32,690 --> 00:29:34,220
compromise in there and you start

681
00:29:34,220 --> 00:29:36,230
writing content for example if your sim

682
00:29:36,230 --> 00:29:39,140
I can put that hostname in and say if

683
00:29:39,140 --> 00:29:42,080
anything talks to this it's a priority

684
00:29:42,080 --> 00:29:45,200
one critical or notify everybody or I

685
00:29:45,200 --> 00:29:47,390
can take one of those file hashes or any

686
00:29:47,390 --> 00:29:48,350
of the other things that I have found

687
00:29:48,350 --> 00:29:51,020
and write indicators for them and then

688
00:29:51,020 --> 00:29:53,510
put it into my system so it'll let me

689
00:29:53,510 --> 00:29:54,580
know

690
00:29:54,580 --> 00:29:57,080
that's the most there that's the easiest

691
00:29:57,080 --> 00:29:59,660
part of threat hunting especially if you

692
00:29:59,660 --> 00:30:01,280
have more advanced systems that can

693
00:30:01,280 --> 00:30:02,570
actually you can push through and

694
00:30:02,570 --> 00:30:04,280
automate it or if you can script it

695
00:30:04,280 --> 00:30:05,780
yourself to go through and just start

696
00:30:05,780 --> 00:30:09,050
pushing it out and automate it it's

697
00:30:09,050 --> 00:30:10,760
there's a lot of different things you

698
00:30:10,760 --> 00:30:15,250
can utilize the pyramid of pain again

699
00:30:15,250 --> 00:30:17,720
that's the biggest like threat hunting

700
00:30:17,720 --> 00:30:21,070
takeaway I would say is to remember that

701
00:30:21,070 --> 00:30:23,030
what's at the bottom you're gonna see

702
00:30:23,030 --> 00:30:24,830
the most best the least reliable up top

703
00:30:24,830 --> 00:30:27,440
is where we actually get into stuff you

704
00:30:27,440 --> 00:30:28,850
can hang your hat on when it comes to

705
00:30:28,850 --> 00:30:37,160
fine and profiling malicious actors so

706
00:30:37,160 --> 00:30:39,920
before I get into eradication let's talk

707
00:30:39,920 --> 00:30:42,020
a little bit about TCP a little bit more

708
00:30:42,020 --> 00:30:47,570
in depth when you think of I don't say

709
00:30:47,570 --> 00:30:49,670
Microsoft and this analogy has been used

710
00:30:49,670 --> 00:30:50,960
many times you've probably heard it

711
00:30:50,960 --> 00:30:53,060
before when you think of Microsoft you

712
00:30:53,060 --> 00:30:54,680
think of a company that pushes up

713
00:30:54,680 --> 00:30:58,670
product that's a global leader in you

714
00:30:58,670 --> 00:31:01,430
know all sorts of stuff however maybe

715
00:31:01,430 --> 00:31:03,230
their product isn't that great sometimes

716
00:31:03,230 --> 00:31:05,300
from a security perspective maybe we

717
00:31:05,300 --> 00:31:07,240
need to patch it every once in a while

718
00:31:07,240 --> 00:31:09,620
maybe they have a really good tech

719
00:31:09,620 --> 00:31:13,430
support crew though actual threat actor

720
00:31:13,430 --> 00:31:15,200
groups are just like that but with

721
00:31:15,200 --> 00:31:18,140
better product there's help there's help

722
00:31:18,140 --> 00:31:20,000
desk you know you can you can do

723
00:31:20,000 --> 00:31:24,560
ransomware as a service for example you

724
00:31:24,560 --> 00:31:26,030
can do ransomware as a service you can

725
00:31:26,030 --> 00:31:28,010
do anything malicious as a service now

726
00:31:28,010 --> 00:31:29,390
you can hire hacker all this fun stuff

727
00:31:29,390 --> 00:31:33,170
out the dark web right now think about

728
00:31:33,170 --> 00:31:34,910
when you first started with your current

729
00:31:34,910 --> 00:31:35,490
employer

730
00:31:35,490 --> 00:31:37,500
you probably had to go through some kind

731
00:31:37,500 --> 00:31:40,020
of orientation you probably had a

732
00:31:40,020 --> 00:31:42,240
procedure manual or a policy manual or

733
00:31:42,240 --> 00:31:43,440
something like that you had to go

734
00:31:43,440 --> 00:31:45,780
through you probably had some kind of

735
00:31:45,780 --> 00:31:50,520
run book or help desk certificate help

736
00:31:50,520 --> 00:31:52,530
desk knowledgebase or whatever it says

737
00:31:52,530 --> 00:31:54,960
if you see this do this right if you

738
00:31:54,960 --> 00:31:56,280
have not been through that raise your

739
00:31:56,280 --> 00:31:56,630
hand

740
00:31:56,630 --> 00:32:00,059
yep everybody right these groups do the

741
00:32:00,059 --> 00:32:02,790
exact same thing they have play books

742
00:32:02,790 --> 00:32:05,820
they have scripts for the help desk if

743
00:32:05,820 --> 00:32:08,490
they have an issue with the customer and

744
00:32:08,490 --> 00:32:11,790
there's a problem with the code they get

745
00:32:11,790 --> 00:32:13,890
on it like that they there is better

746
00:32:13,890 --> 00:32:17,990
tech support and dev work sorry devs

747
00:32:17,990 --> 00:32:21,950
there's better dev work on the bad side

748
00:32:21,950 --> 00:32:26,400
why do you think that is money money

749
00:32:26,400 --> 00:32:27,260
money money

750
00:32:27,260 --> 00:32:29,580
product the product they put out is

751
00:32:29,580 --> 00:32:33,300
their name if their name goes out their

752
00:32:33,300 --> 00:32:34,440
products into yourself because somebody

753
00:32:34,440 --> 00:32:35,370
else is going to come up and eat them

754
00:32:35,370 --> 00:32:38,610
alive so when you think of that right we

755
00:32:38,610 --> 00:32:41,130
said that they have their policies and

756
00:32:41,130 --> 00:32:42,420
procedures and run books and everything

757
00:32:42,420 --> 00:32:44,400
like that when we go back to the pyramid

758
00:32:44,400 --> 00:32:47,809
of pain the very top thing was what TTP

759
00:32:47,809 --> 00:32:51,170
how hard is it going to be for me as

760
00:32:51,170 --> 00:32:55,350
though I lead a malicious group and I

761
00:32:55,350 --> 00:32:58,620
have all y'all as my employees and this

762
00:32:58,620 --> 00:33:00,030
is how we're gonna write our code this

763
00:33:00,030 --> 00:33:01,740
is how we're gonna distribute it this is

764
00:33:01,740 --> 00:33:04,380
how we're gonna build clients etc and

765
00:33:04,380 --> 00:33:07,020
then all of a sudden some researcher

766
00:33:07,020 --> 00:33:09,179
comes along and can identify the

767
00:33:09,179 --> 00:33:11,610
methodology in which you code and to

768
00:33:11,610 --> 00:33:14,460
tell that that's you because you're a

769
00:33:14,460 --> 00:33:17,160
Russian based group however you like to

770
00:33:17,160 --> 00:33:19,580
code in Chinese to throw somebody off

771
00:33:19,580 --> 00:33:23,429
however you're not fluent in Chinese so

772
00:33:23,429 --> 00:33:25,590
there's indicators that that's not

773
00:33:25,590 --> 00:33:27,210
Chinese and then all of a sudden that

774
00:33:27,210 --> 00:33:31,230
gets tagged back to you now you have to

775
00:33:31,230 --> 00:33:33,809
completely go back and change how you do

776
00:33:33,809 --> 00:33:37,590
things because you've been busted that's

777
00:33:37,590 --> 00:33:39,120
why that little top piece of that

778
00:33:39,120 --> 00:33:42,120
triangle is so critical you have that

779
00:33:42,120 --> 00:33:44,460
and you can say definitely you know

780
00:33:44,460 --> 00:33:47,309
Charles Yost wrote this code because I

781
00:33:47,309 --> 00:33:48,840
can tell because I've seen another code

782
00:33:48,840 --> 00:33:49,320
that he's

783
00:33:49,320 --> 00:33:53,179
before he's not a bad guy though usually

784
00:33:53,179 --> 00:33:55,830
but that's why it's so critical I can

785
00:33:55,830 --> 00:33:57,419
change the file hash all day long I can

786
00:33:57,419 --> 00:33:59,130
do all these other things but once you

787
00:33:59,130 --> 00:34:01,610
start messing with my business product

788
00:34:01,610 --> 00:34:04,110
it is extremely difficult for me to come

789
00:34:04,110 --> 00:34:07,259
back from just like any other software

790
00:34:07,259 --> 00:34:09,300
if you find a major vulnerability in I

791
00:34:09,300 --> 00:34:10,319
don't know

792
00:34:10,319 --> 00:34:14,429
WordPress our WordPress plugin it it may

793
00:34:14,429 --> 00:34:16,679
take specially if the plug-in and then

794
00:34:16,679 --> 00:34:18,780
that company or whoever wrote it has to

795
00:34:18,780 --> 00:34:20,849
go back through and completely rewrite

796
00:34:20,849 --> 00:34:23,639
it from scratch that causes a problem

797
00:34:23,639 --> 00:34:28,619
for them so just want to make sure

798
00:34:28,619 --> 00:34:29,460
everyone kind of got a good

799
00:34:29,460 --> 00:34:31,619
understanding of the TTP piece of the

800
00:34:31,619 --> 00:34:34,619
house so let's talk about eradication

801
00:34:34,619 --> 00:34:37,560
now what have we done so far we found

802
00:34:37,560 --> 00:34:39,510
some stuff we looked up some stuff we

803
00:34:39,510 --> 00:34:40,859
found out some more information we

804
00:34:40,859 --> 00:34:41,969
thrown some stuff and I'm monitoring

805
00:34:41,969 --> 00:34:43,980
detection when they have scripted some

806
00:34:43,980 --> 00:34:45,030
stuff to go through and look at other

807
00:34:45,030 --> 00:34:48,719
stuff so we've done a lot of stuff what

808
00:34:48,719 --> 00:34:49,889
we haven't done is made sure that

809
00:34:49,889 --> 00:34:51,629
everyone's out all the bad guys are out

810
00:34:51,629 --> 00:34:54,119
of our network yet though so what we do

811
00:34:54,119 --> 00:34:57,750
that we have to think of a lot of

812
00:34:57,750 --> 00:34:59,280
different things this gentleman brought

813
00:34:59,280 --> 00:35:00,420
up one of the most important things

814
00:35:00,420 --> 00:35:02,849
before and that is do you tip off the

815
00:35:02,849 --> 00:35:05,880
intruder or at what point do you tip off

816
00:35:05,880 --> 00:35:09,270
the intruder there might be times and

817
00:35:09,270 --> 00:35:12,300
it's a business decision so we have to

818
00:35:12,300 --> 00:35:14,310
educate the business side the sea level

819
00:35:14,310 --> 00:35:16,380
on the right risks but we have to let

820
00:35:16,380 --> 00:35:17,760
them know what's going on and what our

821
00:35:17,760 --> 00:35:20,670
plan is for example this system is

822
00:35:20,670 --> 00:35:21,359
compromised

823
00:35:21,359 --> 00:35:26,430
it's the admin assistant for the CFO we

824
00:35:26,430 --> 00:35:29,819
know it's compromised however we don't

825
00:35:29,819 --> 00:35:31,500
want to pull it off the water and here's

826
00:35:31,500 --> 00:35:32,010
why

827
00:35:32,010 --> 00:35:34,349
we want to do live memory forensics we

828
00:35:34,349 --> 00:35:35,700
want to do all these other things we

829
00:35:35,700 --> 00:35:37,650
want to see who it's talking to we want

830
00:35:37,650 --> 00:35:39,300
it to go through its paces we can trap

831
00:35:39,300 --> 00:35:41,250
more and more information to create more

832
00:35:41,250 --> 00:35:44,760
and more indicators to compromise that

833
00:35:44,760 --> 00:35:50,579
sounds great but at what cost what's

834
00:35:50,579 --> 00:35:53,810
going to happen if we let that happen

835
00:35:56,360 --> 00:35:59,130
exactly that comes to the business side

836
00:35:59,130 --> 00:36:01,740
of the house now I put my business hat

837
00:36:01,740 --> 00:36:03,210
on I say okay I hear what you're saying

838
00:36:03,210 --> 00:36:04,560
I understand that you want to get this

839
00:36:04,560 --> 00:36:06,980
information and how critical it is but

840
00:36:06,980 --> 00:36:10,170
at what cost what's gonna happen if I

841
00:36:10,170 --> 00:36:12,630
let you do that and let it run its

842
00:36:12,630 --> 00:36:13,400
course

843
00:36:13,400 --> 00:36:17,100
does that admin assistant have access to

844
00:36:17,100 --> 00:36:21,180
the CFO's calendar more than likely so

845
00:36:21,180 --> 00:36:25,520
if the CFO has a meeting on there with

846
00:36:25,520 --> 00:36:30,840
director of operations for Disney well

847
00:36:30,840 --> 00:36:33,240
that's business intelligence information

848
00:36:33,240 --> 00:36:35,130
that I can sell hey guess what

849
00:36:35,130 --> 00:36:37,260
Jamie Murdoch incorporated hasn't made

850
00:36:37,260 --> 00:36:38,760
it looks like a major meeting with

851
00:36:38,760 --> 00:36:42,210
Disney for operations so if I leaked

852
00:36:42,210 --> 00:36:44,670
that information and say hey Disney is

853
00:36:44,670 --> 00:36:48,090
in is looking for security operations

854
00:36:48,090 --> 00:36:50,190
work they probably have an issue I

855
00:36:50,190 --> 00:36:52,230
wouldn't buy Disney movies or whatever

856
00:36:52,230 --> 00:36:54,090
it is so that's business intelligence

857
00:36:54,090 --> 00:36:55,440
that's one little thing just because of

858
00:36:55,440 --> 00:36:58,530
a calendar imagine what they have what

859
00:36:58,530 --> 00:37:00,120
they can get if they had access to the

860
00:37:00,120 --> 00:37:03,480
full inbox of that admin assistant who

861
00:37:03,480 --> 00:37:05,610
by the way probably can do what send on

862
00:37:05,610 --> 00:37:08,550
behalf so if they can send on behalf

863
00:37:08,550 --> 00:37:12,870
what else can they do fishing that pull

864
00:37:12,870 --> 00:37:15,150
access to that email account all sorts

865
00:37:15,150 --> 00:37:18,450
of things so for us in security you know

866
00:37:18,450 --> 00:37:19,980
we want like hey let's keep this machine

867
00:37:19,980 --> 00:37:21,660
open because there's a lot we want to do

868
00:37:21,660 --> 00:37:23,370
but sometimes we can sometimes we have

869
00:37:23,370 --> 00:37:25,380
to say the right thing for the business

870
00:37:25,380 --> 00:37:26,820
is to pull the plug on this thing you

871
00:37:26,820 --> 00:37:29,700
know do some disk forensics we lost

872
00:37:29,700 --> 00:37:32,040
their capability memory forensics but

873
00:37:32,040 --> 00:37:41,760
it's what we had to do a good yes sir so

874
00:37:41,760 --> 00:37:43,680
the gentleman asked can't you tip them

875
00:37:43,680 --> 00:37:45,180
off also if you do if use open source

876
00:37:45,180 --> 00:37:47,850
intelligence possibly for example if I

877
00:37:47,850 --> 00:37:49,800
take the code and load it to let's say

878
00:37:49,800 --> 00:37:52,620
by total and I'm sitting there and I'm

879
00:37:52,620 --> 00:37:56,610
did you know I'm the bad guy developer

880
00:37:56,610 --> 00:37:58,740
and I monitor that looking for my code

881
00:37:58,740 --> 00:38:00,870
to show up then yeah especially if I

882
00:38:00,870 --> 00:38:03,330
customize that code for you if I wrote a

883
00:38:03,330 --> 00:38:04,980
custom exploit or a custom piece of

884
00:38:04,980 --> 00:38:07,050
ransomware malware based on the recon

885
00:38:07,050 --> 00:38:08,069
that I did if you were you

886
00:38:08,069 --> 00:38:10,920
organization and I'm looking then yes

887
00:38:10,920 --> 00:38:18,140
absolutely suggest how to use the source

888
00:38:18,140 --> 00:38:20,039
and let's say you're looking at

889
00:38:20,039 --> 00:38:21,930
something where you're kind of website

890
00:38:21,930 --> 00:38:23,969
right and there's a lot of the first

891
00:38:23,969 --> 00:38:25,999
name

892
00:38:25,999 --> 00:38:28,569
they see their website was put in there

893
00:38:28,569 --> 00:38:31,979
you're not uploading something

894
00:38:33,720 --> 00:38:35,890
good question I like your thinking I'm

895
00:38:35,890 --> 00:38:37,960
gonna talk to you much so with the

896
00:38:37,960 --> 00:38:39,280
gentleman was saying is you know not

897
00:38:39,280 --> 00:38:41,140
only just like virustotal but you know

898
00:38:41,140 --> 00:38:42,670
looking at the website or other things

899
00:38:42,670 --> 00:38:46,480
like that what I do is and who's

900
00:38:46,480 --> 00:38:49,600
familiar retails the ISO security eyes

901
00:38:49,600 --> 00:38:53,470
have Trento I utilize tails through a

902
00:38:53,470 --> 00:38:56,890
VPN through somebody else's Wi-Fi like

903
00:38:56,890 --> 00:38:59,410
Starbucks or something like that that

904
00:38:59,410 --> 00:39:01,090
way you know yeah I might upload their

905
00:39:01,090 --> 00:39:04,960
code but it's not directly tied back to

906
00:39:04,960 --> 00:39:07,600
that organization so yeah is that as the

907
00:39:07,600 --> 00:39:10,510
as the the bad developer

908
00:39:10,510 --> 00:39:11,890
I'll get nervous come like oh

909
00:39:11,890 --> 00:39:13,780
somebody saw my code I wrote this

910
00:39:13,780 --> 00:39:16,300
specifically for them but it's not

911
00:39:16,300 --> 00:39:20,470
necessarily definitive on it was you

912
00:39:20,470 --> 00:39:22,840
know Jamie Murdoch at you know besides

913
00:39:22,840 --> 00:39:26,220
Pittsburgh for example so yeah it's I

914
00:39:26,220 --> 00:39:28,480
hate the word bits like tradecraft stuff

915
00:39:28,480 --> 00:39:29,920
right when you're actually doing the

916
00:39:29,920 --> 00:39:31,060
intelligence work there's other things

917
00:39:31,060 --> 00:39:33,480
that go behind the scenes other than a

918
00:39:33,480 --> 00:39:43,680
couple of slides in a presentation I

919
00:39:43,680 --> 00:39:45,550
don't want to say that it's a bad

920
00:39:45,550 --> 00:39:47,710
example but your reactions to that would

921
00:39:47,710 --> 00:39:49,470
be different because it's warming and

922
00:39:49,470 --> 00:39:51,640
anything more people you would want to

923
00:39:51,640 --> 00:39:55,420
eradicate first and contain before you

924
00:39:55,420 --> 00:40:00,400
would worry about tipping off you're a

925
00:40:00,400 --> 00:40:03,010
hundred percent agree so if if you

926
00:40:03,010 --> 00:40:04,960
didn't hear what the gentleman said in

927
00:40:04,960 --> 00:40:08,050
the example I gave you know because of

928
00:40:08,050 --> 00:40:10,000
the capabilities of what that can do it

929
00:40:10,000 --> 00:40:11,470
can spread I'm just paraphrasing

930
00:40:11,470 --> 00:40:14,260
difference so you'd want to contain that

931
00:40:14,260 --> 00:40:15,700
as soon as possible and you're

932
00:40:15,700 --> 00:40:17,160
absolutely right

933
00:40:17,160 --> 00:40:20,020
damn you for catching me that you're

934
00:40:20,020 --> 00:40:22,030
right I'm not I'm not afraid to admit I

935
00:40:22,030 --> 00:40:23,410
was wrong on that but no that's you're

936
00:40:23,410 --> 00:40:24,880
absolutely right in that situation you

937
00:40:24,880 --> 00:40:27,010
would definitely you know jumping not

938
00:40:27,010 --> 00:40:28,660
jump the gun but jump right into that

939
00:40:28,660 --> 00:40:37,300
container okay so I'm gonna go through

940
00:40:37,300 --> 00:40:40,390
these a little quick Eradication most of

941
00:40:40,390 --> 00:40:41,920
the stuff you guys already know you know

942
00:40:41,920 --> 00:40:43,690
we can do host isolation through a very

943
00:40:43,690 --> 00:40:46,690
you know various different things

944
00:40:46,690 --> 00:40:47,830
pulling the host completely off the

945
00:40:47,830 --> 00:40:50,740
network's putting it into separate VLAN

946
00:40:50,740 --> 00:40:53,050
so you can keep communications alive all

947
00:40:53,050 --> 00:40:54,810
sorts of things you can do it the host

948
00:40:54,810 --> 00:40:57,820
you can get mentation and I'm not

949
00:40:57,820 --> 00:41:00,130
talking about a full-on architect level

950
00:41:00,130 --> 00:41:02,110
network engineers everyone involved

951
00:41:02,110 --> 00:41:05,890
segmentation I'm saying if a field

952
00:41:05,890 --> 00:41:10,300
office in Oshkosh Wisconsin is the one

953
00:41:10,300 --> 00:41:11,620
that we believe had the initial source

954
00:41:11,620 --> 00:41:13,630
compromised then we can segment them off

955
00:41:13,630 --> 00:41:17,530
completely we can look at very very very

956
00:41:17,530 --> 00:41:20,440
very difficult things like removing the

957
00:41:20,440 --> 00:41:25,570
hosts at layer one and removing the

958
00:41:25,570 --> 00:41:27,550
hosts for forensics and this is what

959
00:41:27,550 --> 00:41:29,160
we're talking a little bit about before

960
00:41:29,160 --> 00:41:31,240
obviously if you do that

961
00:41:31,240 --> 00:41:33,220
say goodbye to memory forensics unless

962
00:41:33,220 --> 00:41:36,190
you've already done it but that goes a

963
00:41:36,190 --> 00:41:38,890
lot into what we have to do with

964
00:41:38,890 --> 00:41:45,520
business units post incident so we've

965
00:41:45,520 --> 00:41:47,080
gone through we had an incident just

966
00:41:47,080 --> 00:41:49,000
kind of bring us up to speed we had an

967
00:41:49,000 --> 00:41:50,860
incident we went through we did our

968
00:41:50,860 --> 00:41:52,780
detection analysis we did all that fun

969
00:41:52,780 --> 00:41:54,430
stuff we gathered indicators compromised

970
00:41:54,430 --> 00:41:56,160
and we went looking in our environment

971
00:41:56,160 --> 00:42:02,950
now we were all done however we can't

972
00:42:02,950 --> 00:42:04,900
just assume that because we believe

973
00:42:04,900 --> 00:42:06,550
we've eradicated everything's good to go

974
00:42:06,550 --> 00:42:08,800
I worked an incident for a very very

975
00:42:08,800 --> 00:42:12,160
large global manufacturer that got hit

976
00:42:12,160 --> 00:42:14,290
by a specific threat actor group from

977
00:42:14,290 --> 00:42:19,240
Asia yes the country China yeah imagine

978
00:42:19,240 --> 00:42:23,260
that went through made recommendations

979
00:42:23,260 --> 00:42:25,090
here's what we need to do to not let

980
00:42:25,090 --> 00:42:25,950
this happen again

981
00:42:25,950 --> 00:42:29,410
cool guess what happened about three

982
00:42:29,410 --> 00:42:35,590
months later hey what's up again did you

983
00:42:35,590 --> 00:42:38,760
guys do anything we recommended no okay

984
00:42:38,760 --> 00:42:41,470
so you have to continue with the shields

985
00:42:41,470 --> 00:42:43,360
up posture that's the point you know

986
00:42:43,360 --> 00:42:44,830
when you look at your post incident

987
00:42:44,830 --> 00:42:47,050
you're going to be gun-shy anyway you

988
00:42:47,050 --> 00:42:49,180
see an account lockout you really like

989
00:42:49,180 --> 00:42:51,010
call everybody we're getting hacked

990
00:42:51,010 --> 00:42:55,200
again that's not necessarily a bad thing

991
00:42:55,200 --> 00:42:57,820
we need to document all the steps we

992
00:42:57,820 --> 00:42:58,920
took

993
00:42:58,920 --> 00:43:01,950
and put that in our analysis post

994
00:43:01,950 --> 00:43:04,920
incident activities are critical in any

995
00:43:04,920 --> 00:43:07,680
kind of incident you know most of us who

996
00:43:07,680 --> 00:43:09,660
go through an incident we go through we

997
00:43:09,660 --> 00:43:13,200
do all of our work it's done and we just

998
00:43:13,200 --> 00:43:14,130
kind of leave it at that

999
00:43:14,130 --> 00:43:16,740
we don't do an after-action report we

1000
00:43:16,740 --> 00:43:18,750
don't do an improvement plan we don't

1001
00:43:18,750 --> 00:43:20,940
prep anything for senior management the

1002
00:43:20,940 --> 00:43:22,349
c-suite Board of Directors or anything

1003
00:43:22,349 --> 00:43:23,040
like that

1004
00:43:23,040 --> 00:43:33,770
we're just like whew yeah it was bad so

1005
00:43:33,770 --> 00:43:38,190
what we have to do we have to do is an

1006
00:43:38,190 --> 00:43:40,020
after-action report an improvement plan

1007
00:43:40,020 --> 00:43:43,770
in a a our IP this is based on

1008
00:43:43,770 --> 00:43:47,490
everything we did for this incident you

1009
00:43:47,490 --> 00:43:49,140
know the steps that we took this goes

1010
00:43:49,140 --> 00:43:50,640
back to the documentation when we first

1011
00:43:50,640 --> 00:43:53,430
started this discussion all the steps we

1012
00:43:53,430 --> 00:43:56,010
took what we found the indicators to

1013
00:43:56,010 --> 00:43:58,020
compromise we created how we went

1014
00:43:58,020 --> 00:43:59,549
through our environment to verify we

1015
00:43:59,549 --> 00:44:01,589
didn't see anything else like that all

1016
00:44:01,589 --> 00:44:05,940
these important things usually incidents

1017
00:44:05,940 --> 00:44:07,859
are put into a ticketing system of some

1018
00:44:07,859 --> 00:44:11,099
kind by Justin usually these things were

1019
00:44:11,099 --> 00:44:13,309
put into a ticketing system of some kind

1020
00:44:13,309 --> 00:44:16,770
do not close that incident do not close

1021
00:44:16,770 --> 00:44:20,309
that ticket until you have gone over the

1022
00:44:20,309 --> 00:44:22,260
after-action report with the whole

1023
00:44:22,260 --> 00:44:26,069
incident response team because the

1024
00:44:26,069 --> 00:44:28,740
reason I say that when you go to the

1025
00:44:28,740 --> 00:44:30,299
entire incident response team and you're

1026
00:44:30,299 --> 00:44:31,770
talking to somebody from corporate

1027
00:44:31,770 --> 00:44:33,630
communications or HR or legal they might

1028
00:44:33,630 --> 00:44:35,430
want you to do something else for

1029
00:44:35,430 --> 00:44:38,730
example they might say those systems

1030
00:44:38,730 --> 00:44:40,770
that you did forensics on I also need

1031
00:44:40,770 --> 00:44:43,170
you to take those you know we need to do

1032
00:44:43,170 --> 00:44:44,940
a legal hold we need to do you know

1033
00:44:44,940 --> 00:44:46,589
we're calling in the FBI we need to do a

1034
00:44:46,589 --> 00:44:47,670
chain of custody and all this other

1035
00:44:47,670 --> 00:44:50,000
stuff that's still part of the incident

1036
00:44:50,000 --> 00:44:53,069
so that needs to be added back into that

1037
00:44:53,069 --> 00:44:55,770
after-action report I'll close it until

1038
00:44:55,770 --> 00:44:58,380
everyone's been communicated to and that

1039
00:44:58,380 --> 00:45:00,930
again includes all numbers and

1040
00:45:00,930 --> 00:45:03,649
responding

1041
00:45:04,130 --> 00:45:06,150
again we're gonna push out any of the

1042
00:45:06,150 --> 00:45:08,190
new I OCS that we found to our

1043
00:45:08,190 --> 00:45:10,200
monitoring and detection systems we're

1044
00:45:10,200 --> 00:45:11,940
gonna create new rules and content and

1045
00:45:11,940 --> 00:45:12,790
monitoring

1046
00:45:12,790 --> 00:45:16,870
platform so what does that mean huh no

1047
00:45:16,870 --> 00:45:17,500
one okay

1048
00:45:17,500 --> 00:45:21,010
that means if I saw communication on

1049
00:45:21,010 --> 00:45:25,060
port 445 and it's utilizing you know and

1050
00:45:25,060 --> 00:45:27,370
it's associated with this you know this

1051
00:45:27,370 --> 00:45:31,180
IP or this host then complete shields up

1052
00:45:31,180 --> 00:45:33,160
wake up everybody you know create

1053
00:45:33,160 --> 00:45:36,820
content if we discovered any avenues of

1054
00:45:36,820 --> 00:45:40,720
approach that can be blocked or that we

1055
00:45:40,720 --> 00:45:43,120
can do better work to help prevent

1056
00:45:43,120 --> 00:45:46,570
another you know breach or ransom or

1057
00:45:46,570 --> 00:45:48,490
anything else from happening we need to

1058
00:45:48,490 --> 00:45:49,690
do that that's included in that

1059
00:45:49,690 --> 00:45:51,850
after-action report improvement plan the

1060
00:45:51,850 --> 00:45:53,290
improvement plan for those of you who

1061
00:45:53,290 --> 00:45:54,910
may not be familiar with it basically

1062
00:45:54,910 --> 00:45:56,920
says here's what happened during an

1063
00:45:56,920 --> 00:45:59,380
incident when we were going through we

1064
00:45:59,380 --> 00:46:02,350
discovered that you know we have no

1065
00:46:02,350 --> 00:46:05,200
egress filtering in the company and this

1066
00:46:05,200 --> 00:46:07,510
led to this happening so an approve Minh

1067
00:46:07,510 --> 00:46:09,700
though we recommend would be egress

1068
00:46:09,700 --> 00:46:12,280
filtering so things like that closing

1069
00:46:12,280 --> 00:46:17,200
avenues of approach now the last step in

1070
00:46:17,200 --> 00:46:19,720
my model here is usually the first step

1071
00:46:19,720 --> 00:46:22,660
which is preparation the reason why I

1072
00:46:22,660 --> 00:46:27,000
have it is the last step is hopefully

1073
00:46:27,000 --> 00:46:30,040
you have a plan of some kind whether

1074
00:46:30,040 --> 00:46:31,570
it's formally documented and there's a

1075
00:46:31,570 --> 00:46:34,300
formal policy around it or it's like hey

1076
00:46:34,300 --> 00:46:37,390
I know that if something happens I'm

1077
00:46:37,390 --> 00:46:40,000
gonna call Kevin and Kevin's gonna kick

1078
00:46:40,000 --> 00:46:42,430
things off the reason I have it last

1079
00:46:42,430 --> 00:46:44,860
year is because I want to put a lot of

1080
00:46:44,860 --> 00:46:47,830
focus on it we're gonna take everything

1081
00:46:47,830 --> 00:46:49,600
that we learned during this incident

1082
00:46:49,600 --> 00:46:51,640
everything we gathered from threat

1083
00:46:51,640 --> 00:46:53,440
intelligence any of the information we

1084
00:46:53,440 --> 00:46:55,360
found during our threat hunt and we're

1085
00:46:55,360 --> 00:46:57,640
gonna put that update our incident

1086
00:46:57,640 --> 00:47:00,640
response plan we're gonna communicate

1087
00:47:00,640 --> 00:47:03,640
all not all but as much of the

1088
00:47:03,640 --> 00:47:06,280
information as we can to our employee

1089
00:47:06,280 --> 00:47:09,310
base let's say was fishing maybe the the

1090
00:47:09,310 --> 00:47:12,040
original attack vector was fishing or

1091
00:47:12,040 --> 00:47:14,860
spearfishing so we're gonna communicate

1092
00:47:14,860 --> 00:47:17,200
with our employee base hey fishing sucks

1093
00:47:17,200 --> 00:47:19,060
don't do it you know the BEC typical

1094
00:47:19,060 --> 00:47:22,180
stuff maybe it was because somebody came

1095
00:47:22,180 --> 00:47:26,080
in and installed a device or software

1096
00:47:26,080 --> 00:47:29,530
and we allowed it well education on that

1097
00:47:29,530 --> 00:47:31,510
is let's we need to have a serious look

1098
00:47:31,510 --> 00:47:33,180
at policy change and then putting

1099
00:47:33,180 --> 00:47:35,200
procedures and technology may be in

1100
00:47:35,200 --> 00:47:38,110
place to not allow that anymore like I

1101
00:47:38,110 --> 00:47:39,900
don't know not let everybody be to a

1102
00:47:39,900 --> 00:47:43,450
local admin on their box something might

1103
00:47:43,450 --> 00:47:44,980
sound simple but it's very difficult for

1104
00:47:44,980 --> 00:47:47,440
some people and most importantly because

1105
00:47:47,440 --> 00:47:50,190
this all does relate back to a business

1106
00:47:50,190 --> 00:47:53,530
discussion and business decisions update

1107
00:47:53,530 --> 00:47:56,200
policies and procedures and they sound

1108
00:47:56,200 --> 00:47:58,780
simple it may sound trivial even but

1109
00:47:58,780 --> 00:48:00,970
policies of your teeth procedures was

1110
00:48:00,970 --> 00:48:05,770
what we do that being said I'm out of

1111
00:48:05,770 --> 00:48:10,870
bullet points any questions yes sir

1112
00:48:10,870 --> 00:48:43,570
sorry you what happened I'm gonna be

1113
00:48:43,570 --> 00:48:44,320
right over here

1114
00:48:44,320 --> 00:48:46,240
you're pretty soon because I think I'm a

1115
00:48:46,240 --> 00:48:47,500
gun just a little over but I'm gonna be

1116
00:48:47,500 --> 00:48:48,010
right over here

1117
00:48:48,010 --> 00:48:52,620
yeah I do have okay all right so on that

1118
00:48:52,620 --> 00:48:56,470
it starts with baby steps so if you go

1119
00:48:56,470 --> 00:48:58,810
to an organization and say or let's say

1120
00:48:58,810 --> 00:49:00,310
you're working in a smaller organization

1121
00:49:00,310 --> 00:49:01,690
and you say I want to start doing threat

1122
00:49:01,690 --> 00:49:03,340
hunting it's gonna be really beneficial

1123
00:49:03,340 --> 00:49:05,230
for us and they laugh no no you're not

1124
00:49:05,230 --> 00:49:06,850
we don't have time for that it's

1125
00:49:06,850 --> 00:49:08,080
probably the same reaction you get if

1126
00:49:08,080 --> 00:49:09,010
you say hey I think we should do

1127
00:49:09,010 --> 00:49:11,650
internal pen testing we don't do that

1128
00:49:11,650 --> 00:49:13,810
we're a you know we make widgets or

1129
00:49:13,810 --> 00:49:18,940
whatever any time that you want to have

1130
00:49:18,940 --> 00:49:24,240
a successful project with safer security

1131
00:49:24,240 --> 00:49:27,280
always always always has to align with a

1132
00:49:27,280 --> 00:49:30,370
business goal so if you can identify a

1133
00:49:30,370 --> 00:49:32,980
business goal to relate to you know

1134
00:49:32,980 --> 00:49:35,680
doing an exercise similar to this

1135
00:49:35,680 --> 00:49:40,150
and show the benefit of you know taking

1136
00:49:40,150 --> 00:49:41,440
a couple indicators compromise and

1137
00:49:41,440 --> 00:49:42,670
looking around a little bit poke you

1138
00:49:42,670 --> 00:49:44,340
know kicking the tires so to speak I

1139
00:49:44,340 --> 00:49:48,450
want it to some kind of business goal

1140
00:49:48,540 --> 00:49:51,690
nothing gets security sold better a

1141
00:49:51,690 --> 00:49:54,910
breach does outside a breach nothing

1142
00:49:54,910 --> 00:49:57,280
gets security sold more than being able

1143
00:49:57,280 --> 00:50:00,310
to relay it to a business discussion for

1144
00:50:00,310 --> 00:50:03,310
example how many have heard where

1145
00:50:03,310 --> 00:50:06,540
security we're not but a burden

1146
00:50:06,540 --> 00:50:09,280
everybody right my suggestion of that

1147
00:50:09,280 --> 00:50:11,440
has always been hell yeah we're a burden

1148
00:50:11,440 --> 00:50:14,320
and embraced that don't try to show that

1149
00:50:14,320 --> 00:50:15,820
you know well we kind of make a profit

1150
00:50:15,820 --> 00:50:17,260
or if you don't do this then we could

1151
00:50:17,260 --> 00:50:20,470
lose know we are a burden we're not only

1152
00:50:20,470 --> 00:50:22,300
a burden in the organization we are the

1153
00:50:22,300 --> 00:50:24,160
most important burden you can have in

1154
00:50:24,160 --> 00:50:27,250
this organization and here's why does

1155
00:50:27,250 --> 00:50:28,780
that kind of help I mean I can get more

1156
00:50:28,780 --> 00:50:33,460
into it afterwards but yeah any other

1157
00:50:33,460 --> 00:50:36,340
quick questions yes sir

1158
00:50:36,340 --> 00:50:40,630
I'm coming back to you to thread in tow

1159
00:50:40,630 --> 00:50:45,400
feeds so what I will say about the rent

1160
00:50:45,400 --> 00:50:46,690
until fees there's a lot of them out

1161
00:50:46,690 --> 00:50:47,860
there there's a lot of good things that

1162
00:50:47,860 --> 00:50:50,980
you can get my personal opinion is you

1163
00:50:50,980 --> 00:50:52,270
can get open source threat intelligence

1164
00:50:52,270 --> 00:50:56,740
feeds or do it yourself probably better

1165
00:50:56,740 --> 00:51:00,970
than you can for paying for if you don't

1166
00:51:00,970 --> 00:51:04,080
have the in-house capabilities or the

1167
00:51:04,080 --> 00:51:07,240
bandwidth to do that on your own and you

1168
00:51:07,240 --> 00:51:09,130
then paying for them is not a bad thing

1169
00:51:09,130 --> 00:51:10,810
just keep in mind a lot of times when

1170
00:51:10,810 --> 00:51:11,980
you paper at threat intelligence feed

1171
00:51:11,980 --> 00:51:13,960
it's Canada talked about before the ones

1172
00:51:13,960 --> 00:51:17,530
and zeros you can do dartnet scraping

1173
00:51:17,530 --> 00:51:21,610
now but it's darkness raping that they

1174
00:51:21,610 --> 00:51:23,200
utilize and a lot of these things is no

1175
00:51:23,200 --> 00:51:24,640
more than an algorithm that you can run

1176
00:51:24,640 --> 00:51:28,770
yourself you had a question

1177
00:51:28,770 --> 00:51:31,290
all right anyone else

1178
00:51:31,290 --> 00:51:34,440
yes sir

1179
00:51:37,900 --> 00:51:40,180
five years from now I'm still learning

1180
00:51:40,180 --> 00:51:42,010
about them how often would you recommend

1181
00:51:42,010 --> 00:51:45,400
going through life everybody though so

1182
00:51:45,400 --> 00:51:47,440
the question is finds all these

1183
00:51:47,440 --> 00:51:48,790
indicators went for hunting found

1184
00:51:48,790 --> 00:51:50,710
indicators how off and he's still seeing

1185
00:51:50,710 --> 00:51:51,910
the alerts like five years from now how

1186
00:51:51,910 --> 00:51:53,140
often do you kind of go back and

1187
00:51:53,140 --> 00:51:54,820
reevaluate that it's a good point that

1188
00:51:54,820 --> 00:51:56,890
kind of ties into your threat feed thing

1189
00:51:56,890 --> 00:52:00,850
for example if you go to most threat

1190
00:52:00,850 --> 00:52:02,890
intelligence feeds and as you know

1191
00:52:02,890 --> 00:52:06,940
1.2.3.4 is a bad IP address maybe it was

1192
00:52:06,940 --> 00:52:08,470
five years ago but maybe now it's not

1193
00:52:08,470 --> 00:52:10,240
but it's still listed as malicious

1194
00:52:10,240 --> 00:52:12,880
because most people who write who keep

1195
00:52:12,880 --> 00:52:15,130
those feeds do not update those feeds I

1196
00:52:15,130 --> 00:52:18,670
know one specific feed that does update

1197
00:52:18,670 --> 00:52:24,190
a banned list by binary defense they do

1198
00:52:24,190 --> 00:52:26,230
go through and bet read that the feeds

1199
00:52:26,230 --> 00:52:29,770
so very similar that a if you're still

1200
00:52:29,770 --> 00:52:32,650
seeing alerts after five years if you're

1201
00:52:32,650 --> 00:52:34,270
still seeing alerts a couple months

1202
00:52:34,270 --> 00:52:36,700
afterwards you then I would suggest you

1203
00:52:36,700 --> 00:52:39,130
do like not just taking this stuff that

1204
00:52:39,130 --> 00:52:41,140
I did and do a full threat hunting

1205
00:52:41,140 --> 00:52:43,750
engagement whether you do it you have

1206
00:52:43,750 --> 00:52:44,830
somebody else do it whatever you

1207
00:52:44,830 --> 00:52:47,050
definitely want to get like super in the

1208
00:52:47,050 --> 00:52:50,080
weeds at that point number two you can

1209
00:52:50,080 --> 00:52:51,430
look at the what the indicator

1210
00:52:51,430 --> 00:52:54,220
compromises that you're seeing look to

1211
00:52:54,220 --> 00:52:56,260
the person to your left or right ask if

1212
00:52:56,260 --> 00:52:57,130
they've seen something like that before

1213
00:52:57,130 --> 00:52:59,110
do some more research on the specific

1214
00:52:59,110 --> 00:53:01,000
indicator that you're still flagging on

1215
00:53:01,000 --> 00:53:03,250
because you might still have the issues

1216
00:53:03,250 --> 00:53:05,320
inside the network it could be a false

1217
00:53:05,320 --> 00:53:07,540
positive so the key thing to that with

1218
00:53:07,540 --> 00:53:09,580
any piece of intelligence is all at all

1219
00:53:09,580 --> 00:53:12,430
is always to vet the intelligence so

1220
00:53:12,430 --> 00:53:16,360
that IOC maybe it's not legit anymore

1221
00:53:16,360 --> 00:53:18,610
maybe it's you know who knows maybe the

1222
00:53:18,610 --> 00:53:21,580
IP address got bought by Google and you

1223
00:53:21,580 --> 00:53:23,260
know it's just a communication stream

1224
00:53:23,260 --> 00:53:28,000
with Google all right I'll be right over

1225
00:53:28,000 --> 00:53:29,710
here if anyone else wants to talk thank

1226
00:53:29,710 --> 00:53:31,270
you for your time and I appreciate you

1227
00:53:31,270 --> 00:53:31,920
coming out

1228
00:53:31,920 --> 00:53:35,699
[Applause]

