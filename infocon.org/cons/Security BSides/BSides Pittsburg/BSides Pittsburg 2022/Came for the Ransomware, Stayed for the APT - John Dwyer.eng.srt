1
00:00:00,320 --> 00:00:03,520
all right what's up nerds okay

2
00:00:03,520 --> 00:00:04,960
thank you first of all for coming out

3
00:00:04,960 --> 00:00:06,399
and listen to me talk to you for the

4
00:00:06,399 --> 00:00:08,080
next 40 minutes or go i don't know if

5
00:00:08,080 --> 00:00:09,280
you guys saw

6
00:00:09,280 --> 00:00:11,759
justin's talk before this but

7
00:00:11,759 --> 00:00:13,280
justin you are the most casually

8
00:00:13,280 --> 00:00:15,440
hilarious person i've ever met my life

9
00:00:15,440 --> 00:00:17,199
and i don't know if your memes got

10
00:00:17,199 --> 00:00:20,400
enough credit so allow me to say it for

11
00:00:20,400 --> 00:00:23,119
everyone else that's thinking it so uh

12
00:00:23,119 --> 00:00:24,640
i'm going to try to jump right into this

13
00:00:24,640 --> 00:00:26,800
because i've been described as verbose

14
00:00:26,800 --> 00:00:28,000
and i don't want to take up the rest of

15
00:00:28,000 --> 00:00:29,920
your day so my name is john dwyer and

16
00:00:29,920 --> 00:00:32,960
i'm the head of research for ibm xfors

17
00:00:32,960 --> 00:00:34,880
if you're not familiar with xforce we

18
00:00:34,880 --> 00:00:37,600
are the consulting arm of ibm security

19
00:00:37,600 --> 00:00:39,840
so we offer defensive offensive and

20
00:00:39,840 --> 00:00:41,760
threat intelligence services

21
00:00:41,760 --> 00:00:43,680
one of those defensive services is

22
00:00:43,680 --> 00:00:45,440
incident response which is the team that

23
00:00:45,440 --> 00:00:46,879
i came up through

24
00:00:46,879 --> 00:00:49,680
uh over the years and now my job is the

25
00:00:49,680 --> 00:00:51,760
head of research is kind of two

26
00:00:51,760 --> 00:00:53,199
two areas one of

27
00:00:53,199 --> 00:00:55,440
it's kind of like a devopsy

28
00:00:55,440 --> 00:00:57,440
role where i'm overseeing technol

29
00:00:57,440 --> 00:00:59,600
technology developments to make sure all

30
00:00:59,600 --> 00:01:01,840
those services are operating as

31
00:01:01,840 --> 00:01:03,840
efficiently as effectively as possible

32
00:01:03,840 --> 00:01:05,840
the other side of it is to kind of

33
00:01:05,840 --> 00:01:08,080
highlight all the interesting findings

34
00:01:08,080 --> 00:01:09,840
in things that we've had over all these

35
00:01:09,840 --> 00:01:11,119
different engagements and make sure

36
00:01:11,119 --> 00:01:13,840
we're sharing those with the community

37
00:01:13,840 --> 00:01:16,240
i try to do a good job of

38
00:01:16,240 --> 00:01:18,320
releasing like kind of tactical things

39
00:01:18,320 --> 00:01:20,479
on my social would be like detection

40
00:01:20,479 --> 00:01:22,880
opportunities or interesting findings on

41
00:01:22,880 --> 00:01:24,960
malware just because we kind of want to

42
00:01:24,960 --> 00:01:26,560
be you know

43
00:01:26,560 --> 00:01:28,720
operating appropriately in the community

44
00:01:28,720 --> 00:01:30,720
try to burn as much of the ttps as

45
00:01:30,720 --> 00:01:33,040
possible

46
00:01:33,040 --> 00:01:35,759
my background in a word is chaotic i

47
00:01:35,759 --> 00:01:37,520
would say

48
00:01:37,520 --> 00:01:39,520
so i i started out my professional

49
00:01:39,520 --> 00:01:41,200
career as a laborer

50
00:01:41,200 --> 00:01:43,680
went through help desk actually i don't

51
00:01:43,680 --> 00:01:45,360
know dugus are you out there right now

52
00:01:45,360 --> 00:01:47,520
he might have my first boss ever who

53
00:01:47,520 --> 00:01:49,119
gave me a chance

54
00:01:49,119 --> 00:01:50,720
is actually in the audience today i ran

55
00:01:50,720 --> 00:01:54,159
i ran into him um

56
00:01:54,159 --> 00:01:55,840
but i've done a whole bunch of different

57
00:01:55,840 --> 00:01:57,759
things over and i've gone up through it

58
00:01:57,759 --> 00:01:59,439
and kind of pivoted into security and

59
00:01:59,439 --> 00:02:01,680
then into research and

60
00:02:01,680 --> 00:02:03,759
uh at first it was kind of like am i

61
00:02:03,759 --> 00:02:05,439
going to be too much of a generalist and

62
00:02:05,439 --> 00:02:06,320
then

63
00:02:06,320 --> 00:02:09,119
over the years it's kind of turned into

64
00:02:09,119 --> 00:02:10,800
like a slumdog millionaire situation

65
00:02:10,800 --> 00:02:12,560
where things would pop up

66
00:02:12,560 --> 00:02:14,560
like when proxy logon and proxy shell

67
00:02:14,560 --> 00:02:16,480
happened and i was thinking back when i

68
00:02:16,480 --> 00:02:19,120
used to be an exchange admin like oh i

69
00:02:19,120 --> 00:02:21,599
get that i understand how kaz's work and

70
00:02:21,599 --> 00:02:24,560
i understand how they interface with iis

71
00:02:24,560 --> 00:02:27,520
so i've been all over the place

72
00:02:27,520 --> 00:02:29,920
i have up there that my superpower is

73
00:02:29,920 --> 00:02:31,840
okay with being dumb mostly for two

74
00:02:31,840 --> 00:02:34,480
reasons number one is that

75
00:02:34,480 --> 00:02:36,720
i never think i should take myself too

76
00:02:36,720 --> 00:02:38,640
seriously and you know it's one of those

77
00:02:38,640 --> 00:02:40,080
if you can't laugh at yourself who can

78
00:02:40,080 --> 00:02:42,879
you laugh at situation number two

79
00:02:42,879 --> 00:02:44,640
i try to bring this up as much as i can

80
00:02:44,640 --> 00:02:47,360
is that i wouldn't call myself the most

81
00:02:47,360 --> 00:02:48,840
gifted person

82
00:02:48,840 --> 00:02:52,400
ever uh and when i was in third grade my

83
00:02:52,400 --> 00:02:54,160
third grade teacher told my mom that i

84
00:02:54,160 --> 00:02:55,680
was probably going to struggle in life

85
00:02:55,680 --> 00:02:58,400
because i had such a hard time learning

86
00:02:58,400 --> 00:02:59,840
so that's always kind of stuck with me

87
00:02:59,840 --> 00:03:02,239
and it always seemed like i had to work

88
00:03:02,239 --> 00:03:05,360
twice as hard to accomplish anything

89
00:03:05,360 --> 00:03:07,280
in my life and that persisted

90
00:03:07,280 --> 00:03:10,319
throughout my career uh great story

91
00:03:10,319 --> 00:03:11,680
those of you who know me it's like

92
00:03:11,680 --> 00:03:13,280
you're going to get a lot of tangential

93
00:03:13,280 --> 00:03:15,120
stories as we go through this

94
00:03:15,120 --> 00:03:17,920
um the first time i got like a sis admin

95
00:03:17,920 --> 00:03:20,080
job i was like i'm making it like i'm

96
00:03:20,080 --> 00:03:22,239
doing the thing and i was really proud

97
00:03:22,239 --> 00:03:23,280
of myself

98
00:03:23,280 --> 00:03:24,879
guys i went to that first team meeting

99
00:03:24,879 --> 00:03:27,840
and it was like these dudes are talking

100
00:03:27,840 --> 00:03:30,799
a completely different language i had no

101
00:03:30,799 --> 00:03:32,879
idea what anyone's saying it so i'm like

102
00:03:32,879 --> 00:03:35,040
feverishly taking notes

103
00:03:35,040 --> 00:03:36,560
about stuff that i'm gonna have to look

104
00:03:36,560 --> 00:03:38,959
up after work because i don't understand

105
00:03:38,959 --> 00:03:40,480
and it was embarrassing and it was like

106
00:03:40,480 --> 00:03:41,760
disheartening

107
00:03:41,760 --> 00:03:43,840
to go through that process and that

108
00:03:43,840 --> 00:03:45,760
persisted as i went through every single

109
00:03:45,760 --> 00:03:47,680
evolution of my career

110
00:03:47,680 --> 00:03:49,680
and then i as i got older

111
00:03:49,680 --> 00:03:52,080
i started to realize that

112
00:03:52,080 --> 00:03:54,560
if i'm continually putting myself in the

113
00:03:54,560 --> 00:03:56,000
position

114
00:03:56,000 --> 00:03:56,879
where

115
00:03:56,879 --> 00:03:59,120
i'm the dumbest person in the room

116
00:03:59,120 --> 00:04:01,360
that means i'm choosing adversity i'm

117
00:04:01,360 --> 00:04:03,040
choosing to grow rather than be

118
00:04:03,040 --> 00:04:04,480
complacent

119
00:04:04,480 --> 00:04:06,799
and i look back on that now with

120
00:04:06,799 --> 00:04:08,319
hindsight being

121
00:04:08,319 --> 00:04:11,360
very old at this point

122
00:04:11,360 --> 00:04:13,519
and i'm very grateful for that time but

123
00:04:13,519 --> 00:04:15,439
if you go out on twitter or linkedin

124
00:04:15,439 --> 00:04:17,199
like it just seems like everyone is

125
00:04:17,199 --> 00:04:19,680
crushing it like everyone's putting out

126
00:04:19,680 --> 00:04:21,839
amazing research and all these great

127
00:04:21,839 --> 00:04:24,080
tools and it's really hard if you're

128
00:04:24,080 --> 00:04:26,479
just starting out to not slide into

129
00:04:26,479 --> 00:04:28,720
those negative thoughts about yourself

130
00:04:28,720 --> 00:04:31,040
or about your career so i i like to

131
00:04:31,040 --> 00:04:32,800
bring this up anytime i have a group of

132
00:04:32,800 --> 00:04:33,680
people

133
00:04:33,680 --> 00:04:35,520
just in case there's someone out there

134
00:04:35,520 --> 00:04:37,440
who's just starting out or or they have

135
00:04:37,440 --> 00:04:39,280
that imposter syndrome to say that you

136
00:04:39,280 --> 00:04:40,800
know you're not alone

137
00:04:40,800 --> 00:04:42,960
we all kind of feel that way and if you

138
00:04:42,960 --> 00:04:44,320
put the work in

139
00:04:44,320 --> 00:04:46,880
you can accomplish some great things

140
00:04:46,880 --> 00:04:48,479
with that said

141
00:04:48,479 --> 00:04:50,080
let me get let me tell you about the one

142
00:04:50,080 --> 00:04:53,759
of the coolest irs that i've ever worked

143
00:04:53,759 --> 00:04:55,440
like i said it came up through the ir

144
00:04:55,440 --> 00:04:58,160
team and

145
00:04:58,160 --> 00:04:58,960
like

146
00:04:58,960 --> 00:05:00,880
if there's any responders in the crowd

147
00:05:00,880 --> 00:05:02,960
everyone knows

148
00:05:02,960 --> 00:05:05,520
shiz goes down on a friday right so

149
00:05:05,520 --> 00:05:07,360
people call on the friday

150
00:05:07,360 --> 00:05:09,919
a client calls in like many other ir

151
00:05:09,919 --> 00:05:11,280
firms we offer

152
00:05:11,280 --> 00:05:12,880
a hotline they call in to declare an

153
00:05:12,880 --> 00:05:14,800
incident so they say

154
00:05:14,800 --> 00:05:16,960
in one of our one of our domains we've

155
00:05:16,960 --> 00:05:20,240
been hit by a massive ransomware attack

156
00:05:20,240 --> 00:05:22,840
and they're pretty large retail

157
00:05:22,840 --> 00:05:25,600
organization nationwide

158
00:05:25,600 --> 00:05:27,199
three main areas of their business but

159
00:05:27,199 --> 00:05:29,680
they got shops all over the place

160
00:05:29,680 --> 00:05:31,840
and at this point

161
00:05:31,840 --> 00:05:33,199
i mean this was the golden age of

162
00:05:33,199 --> 00:05:34,560
ransomware it was like

163
00:05:34,560 --> 00:05:36,479
every three days we were getting one of

164
00:05:36,479 --> 00:05:38,320
these calls so it was like there's

165
00:05:38,320 --> 00:05:39,759
another one here's another one so they

166
00:05:39,759 --> 00:05:42,080
call and they said about 200 systems

167
00:05:42,080 --> 00:05:44,560
they're offline they call in they you

168
00:05:44,560 --> 00:05:46,240
know it's actually kind of cool the av

169
00:05:46,240 --> 00:05:48,000
vendor they're not responders but they

170
00:05:48,000 --> 00:05:49,840
did some analysis

171
00:05:49,840 --> 00:05:51,759
found the domain admin account and some

172
00:05:51,759 --> 00:05:53,919
an ip address they blocked it and they

173
00:05:53,919 --> 00:05:55,759
called in they're like hey we just want

174
00:05:55,759 --> 00:05:57,280
to run past this

175
00:05:57,280 --> 00:05:59,440
is it cool and we're like no dog this

176
00:05:59,440 --> 00:06:01,440
ain't cool like there's a lot that we

177
00:06:01,440 --> 00:06:03,280
need to scope right so part of being a

178
00:06:03,280 --> 00:06:04,880
good responder if anyone's trying to get

179
00:06:04,880 --> 00:06:08,000
into the industry is you know sometimes

180
00:06:08,000 --> 00:06:09,199
you got to save the client from

181
00:06:09,199 --> 00:06:11,840
themselves right so we talk about

182
00:06:11,840 --> 00:06:13,440
you can't move forward right now this

183
00:06:13,440 --> 00:06:15,680
hasn't obviously been scoped

184
00:06:15,680 --> 00:06:17,280
as well as it needs to be we need to

185
00:06:17,280 --> 00:06:19,199
increase our visibility the only tooling

186
00:06:19,199 --> 00:06:20,800
that they had right now

187
00:06:20,800 --> 00:06:23,199
was av so we go through the process of

188
00:06:23,199 --> 00:06:24,560
the ir

189
00:06:24,560 --> 00:06:26,160
and like i said we've been doing these a

190
00:06:26,160 --> 00:06:26,960
lot

191
00:06:26,960 --> 00:06:28,720
so they said

192
00:06:28,720 --> 00:06:31,120
all of our files have a dot ryk

193
00:06:31,120 --> 00:06:32,800
immediately we know that's rio grande

194
00:06:32,800 --> 00:06:33,600
where and at the time that was the

195
00:06:33,600 --> 00:06:35,680
hottest one so we got that all the time

196
00:06:35,680 --> 00:06:38,160
also at that time we understood that the

197
00:06:38,160 --> 00:06:41,919
emote trickbot empire ps exec ransomware

198
00:06:41,919 --> 00:06:43,680
we knew that that was a thing

199
00:06:43,680 --> 00:06:46,479
and we did that

200
00:06:46,639 --> 00:06:48,160
legitimately i think i ran the stats on

201
00:06:48,160 --> 00:06:50,080
it was every three days

202
00:06:50,080 --> 00:06:54,160
for seven months that we responded to

203
00:06:54,160 --> 00:06:55,919
more than what we considered as a major

204
00:06:55,919 --> 00:06:57,520
ransomware incident was more than 200

205
00:06:57,520 --> 00:07:00,560
systems so to put that like this was

206
00:07:00,560 --> 00:07:01,520
happening

207
00:07:01,520 --> 00:07:03,840
a lot

208
00:07:04,160 --> 00:07:07,360
one of the first things pro tip

209
00:07:07,360 --> 00:07:09,520
when you do an ir

210
00:07:09,520 --> 00:07:11,280
always ask for a security telemetry

211
00:07:11,280 --> 00:07:13,199
always ask for it there's gold in those

212
00:07:13,199 --> 00:07:14,720
av logs

213
00:07:14,720 --> 00:07:16,800
and while we're deploying our tech we're

214
00:07:16,800 --> 00:07:18,479
collecting that data that all takes time

215
00:07:18,479 --> 00:07:20,000
but you can usually find something

216
00:07:20,000 --> 00:07:21,039
that's going to point you in the right

217
00:07:21,039 --> 00:07:23,759
direction in those av logs this was yet

218
00:07:23,759 --> 00:07:25,440
another example

219
00:07:25,440 --> 00:07:27,360
in fact a couple weeks ago we put out a

220
00:07:27,360 --> 00:07:29,120
research paper

221
00:07:29,120 --> 00:07:30,800
analyzing

222
00:07:30,800 --> 00:07:32,720
why are ransomware attacks happening

223
00:07:32,720 --> 00:07:34,800
faster than they did before

224
00:07:34,800 --> 00:07:36,800
which was a cool topic it took a lot of

225
00:07:36,800 --> 00:07:38,639
time but one of the more interesting

226
00:07:38,639 --> 00:07:40,319
findings in that that i think got

227
00:07:40,319 --> 00:07:43,280
glossed over by the media was

228
00:07:43,280 --> 00:07:45,759
year over year

229
00:07:45,759 --> 00:07:48,000
there is more evidence

230
00:07:48,000 --> 00:07:50,400
in security telemetry now

231
00:07:50,400 --> 00:07:52,400
before ransomware was deployed than

232
00:07:52,400 --> 00:07:54,879
there was in 2019 the start of what we

233
00:07:54,879 --> 00:07:58,000
would call the golden age so that means

234
00:07:58,000 --> 00:08:00,400
that people are a investing in detection

235
00:08:00,400 --> 00:08:03,360
tech and b the detection tech is

236
00:08:03,360 --> 00:08:06,160
actually working better than it used to

237
00:08:06,160 --> 00:08:07,759
and there's usually something in there

238
00:08:07,759 --> 00:08:09,360
that could prevent you from having a

239
00:08:09,360 --> 00:08:10,840
crisis

240
00:08:10,840 --> 00:08:13,520
so make sure you're collecting that make

241
00:08:13,520 --> 00:08:15,120
sure someone's looking at it first of

242
00:08:15,120 --> 00:08:17,039
all and then if you're if you're an ir

243
00:08:17,039 --> 00:08:19,440
person make sure you collect that

244
00:08:19,440 --> 00:08:20,960
the other point i want to point out here

245
00:08:20,960 --> 00:08:24,560
is you can see that the older av alerts

246
00:08:24,560 --> 00:08:25,759
responders are going to know what i'm

247
00:08:25,759 --> 00:08:28,639
talking about here so older av alerts

248
00:08:28,639 --> 00:08:31,039
show someone trying to dump lsas show

249
00:08:31,039 --> 00:08:34,000
cobalt strike show them interpreter now

250
00:08:34,000 --> 00:08:37,279
what is weird about our timeline here

251
00:08:37,279 --> 00:08:38,159
and

252
00:08:38,159 --> 00:08:39,760
and bear with me here i'm not going to

253
00:08:39,760 --> 00:08:42,080
try to sell you anything but why i think

254
00:08:42,080 --> 00:08:44,480
every organization should be interfacing

255
00:08:44,480 --> 00:08:46,399
with an ir team

256
00:08:46,399 --> 00:08:49,440
in some regard an ir consulting team

257
00:08:49,440 --> 00:08:51,440
if you think about this

258
00:08:51,440 --> 00:08:53,200
ir firms

259
00:08:53,200 --> 00:08:54,800
it doesn't have to be again it doesn't

260
00:08:54,800 --> 00:08:56,080
have to be export it's great if it is

261
00:08:56,080 --> 00:08:58,080
but if it's not no big deal but

262
00:08:58,080 --> 00:09:00,000
ir firms are one of the only disciplines

263
00:09:00,000 --> 00:09:01,920
in cyber security where you can can

264
00:09:01,920 --> 00:09:04,080
continually observe an adversary be

265
00:09:04,080 --> 00:09:05,440
successful

266
00:09:05,440 --> 00:09:06,240
right

267
00:09:06,240 --> 00:09:08,160
there's a lot of smart people and the

268
00:09:08,160 --> 00:09:10,640
mdr mssp avs

269
00:09:10,640 --> 00:09:12,480
all these they're putting out fantastic

270
00:09:12,480 --> 00:09:14,640
work but it's in their best interest

271
00:09:14,640 --> 00:09:17,120
to start to stop the adversary before

272
00:09:17,120 --> 00:09:18,880
they're able to complete their objective

273
00:09:18,880 --> 00:09:20,399
with ir

274
00:09:20,399 --> 00:09:22,880
especially with ransomware the detection

275
00:09:22,880 --> 00:09:24,959
point is typically

276
00:09:24,959 --> 00:09:26,560
the ransomware itself right so that

277
00:09:26,560 --> 00:09:28,240
means the adversary is able to go from

278
00:09:28,240 --> 00:09:31,279
initial access to impact

279
00:09:31,279 --> 00:09:32,959
and ir teams are able to reconstruct

280
00:09:32,959 --> 00:09:34,720
that story and they're in a unique

281
00:09:34,720 --> 00:09:37,120
position to say what is anomalous and

282
00:09:37,120 --> 00:09:39,360
what is not from an adversary operations

283
00:09:39,360 --> 00:09:40,959
point of view and we talk about

284
00:09:40,959 --> 00:09:42,480
strategically

285
00:09:42,480 --> 00:09:44,480
how we need to operate now and in

286
00:09:44,480 --> 00:09:46,399
security is moving out of indicator

287
00:09:46,399 --> 00:09:47,519
driven

288
00:09:47,519 --> 00:09:49,680
detection strategies and moving into how

289
00:09:49,680 --> 00:09:51,680
we know adversaries obtain their goals

290
00:09:51,680 --> 00:09:53,120
and objectives

291
00:09:53,120 --> 00:09:54,959
so

292
00:09:54,959 --> 00:09:56,959
this bottom thing here

293
00:09:56,959 --> 00:09:59,440
is incredibly weird

294
00:09:59,440 --> 00:10:01,120
because we know

295
00:10:01,120 --> 00:10:03,120
from doing all of these rare ransomware

296
00:10:03,120 --> 00:10:05,680
investigations that trick bot

297
00:10:05,680 --> 00:10:07,120
should be the first

298
00:10:07,120 --> 00:10:10,399
piece of evidence it should not be

299
00:10:10,399 --> 00:10:13,040
some other c2 framework

300
00:10:13,040 --> 00:10:15,040
that is generally associated with humor

301
00:10:15,040 --> 00:10:17,360
human operated activity

302
00:10:17,360 --> 00:10:18,640
so

303
00:10:18,640 --> 00:10:20,240
like they say back home that's wicked

304
00:10:20,240 --> 00:10:22,560
weird

305
00:10:22,560 --> 00:10:24,640
we're continually bugging the client

306
00:10:24,640 --> 00:10:25,760
about this

307
00:10:25,760 --> 00:10:27,920
again being an ir person one of the best

308
00:10:27,920 --> 00:10:29,360
things you can do is protect the client

309
00:10:29,360 --> 00:10:30,839
from themselves but

310
00:10:30,839 --> 00:10:32,880
understandably they want to get

311
00:10:32,880 --> 00:10:35,120
operations up as soon as possible

312
00:10:35,120 --> 00:10:38,320
we know how to do the trickbot empire ps

313
00:10:38,320 --> 00:10:40,560
exec we know to do that investigation we

314
00:10:40,560 --> 00:10:42,079
find all the domain admin accounts that

315
00:10:42,079 --> 00:10:43,440
were compromised find all the lateral

316
00:10:43,440 --> 00:10:45,839
movement find where they stole data

317
00:10:45,839 --> 00:10:47,120
buttoned up

318
00:10:47,120 --> 00:10:48,720
three days

319
00:10:48,720 --> 00:10:50,560
we're still asking about this system

320
00:10:50,560 --> 00:10:52,399
because it's only one system that's

321
00:10:52,399 --> 00:10:54,560
hanging out there that has this av alert

322
00:10:54,560 --> 00:10:56,399
that is the only thing there's two av

323
00:10:56,399 --> 00:11:00,480
alerts out of a sea of mess that we're

324
00:11:00,480 --> 00:11:02,320
bothering the client about

325
00:11:02,320 --> 00:11:03,680
but they want to go ahead and go with

326
00:11:03,680 --> 00:11:05,040
recovery

327
00:11:05,040 --> 00:11:08,320
so literally typing the report out

328
00:11:08,320 --> 00:11:11,120
saying with a big section that says

329
00:11:11,120 --> 00:11:14,640
dude you might be pop still we're not

330
00:11:14,640 --> 00:11:16,079
going to sign off as this being a

331
00:11:16,079 --> 00:11:17,920
remediated incident

332
00:11:17,920 --> 00:11:20,240
you really should look at this

333
00:11:20,240 --> 00:11:22,480
the it admin texts me

334
00:11:22,480 --> 00:11:25,279
he's like oh i got that system dude do

335
00:11:25,279 --> 00:11:28,320
you want an image do you want edr

336
00:11:28,320 --> 00:11:29,680
deployed or do you want us to run your

337
00:11:29,680 --> 00:11:32,160
tools on it i say yes

338
00:11:32,160 --> 00:11:35,600
do it all right and immediately what we

339
00:11:35,600 --> 00:11:37,519
find out

340
00:11:37,519 --> 00:11:40,000
is that the same system that had

341
00:11:40,000 --> 00:11:41,680
meterpreter and cobalt

342
00:11:41,680 --> 00:11:44,079
actually also had the earliest evidence

343
00:11:44,079 --> 00:11:47,360
of trickbot it also shows that trickbot

344
00:11:47,360 --> 00:11:49,680
was introduced through a meterpreter

345
00:11:49,680 --> 00:11:51,519
session

346
00:11:51,519 --> 00:11:53,200
that's odd right

347
00:11:53,200 --> 00:11:54,399
we know

348
00:11:54,399 --> 00:11:56,720
how trickbot goes right it's spam caming

349
00:11:56,720 --> 00:11:59,200
or downloaded through email emote

350
00:11:59,200 --> 00:12:01,839
that's incredibly awkward and weird to

351
00:12:01,839 --> 00:12:03,920
see that data point the other thing that

352
00:12:03,920 --> 00:12:06,160
we see is that the user account that

353
00:12:06,160 --> 00:12:08,560
associated with those alerts is from a

354
00:12:08,560 --> 00:12:11,680
whole other domain it's from the hq dom

355
00:12:11,680 --> 00:12:13,440
well hq none of these domain names are

356
00:12:13,440 --> 00:12:15,200
real but you know what i mean so it's

357
00:12:15,200 --> 00:12:17,200
from the the root so the hq domain was

358
00:12:17,200 --> 00:12:19,120
the the forced root of this domain and

359
00:12:19,120 --> 00:12:21,839
it was 37 days before ransomware

360
00:12:21,839 --> 00:12:23,760
happened

361
00:12:23,760 --> 00:12:24,480
so

362
00:12:24,480 --> 00:12:26,399
we have to expand scope right so we call

363
00:12:26,399 --> 00:12:28,240
hq and we say

364
00:12:28,240 --> 00:12:30,079
you know houston we have a problem kind

365
00:12:30,079 --> 00:12:32,639
of deal like we need to start ex

366
00:12:32,639 --> 00:12:35,200
uh expanding our visibility and they're

367
00:12:35,200 --> 00:12:37,600
like well we didn't get ransomware

368
00:12:37,600 --> 00:12:39,760
so like we don't have a problem like

369
00:12:39,760 --> 00:12:42,240
dawg you got a problem right because

370
00:12:42,240 --> 00:12:44,560
this is this is abnormal

371
00:12:44,560 --> 00:12:46,160
but you know they also didn't get

372
00:12:46,160 --> 00:12:47,920
ransomware which was weird at the same

373
00:12:47,920 --> 00:12:50,560
time so we're moving forward expanding

374
00:12:50,560 --> 00:12:51,519
scope

375
00:12:51,519 --> 00:12:53,680
trust the process collect the data look

376
00:12:53,680 --> 00:12:55,360
at the data

377
00:12:55,360 --> 00:12:56,720
what do we find out is that there's

378
00:12:56,720 --> 00:13:00,079
cobalt strike within that infrastructure

379
00:13:00,079 --> 00:13:02,079
96 days

380
00:13:02,079 --> 00:13:04,480
before ransomware now

381
00:13:04,480 --> 00:13:07,200
trick bought to react on our research is

382
00:13:07,200 --> 00:13:09,279
the longest life span

383
00:13:09,279 --> 00:13:11,680
of all ransomware attacks we've seen

384
00:13:11,680 --> 00:13:14,880
them prese persist up to three months at

385
00:13:14,880 --> 00:13:19,200
the max 96 days is a behavioral anomaly

386
00:13:19,200 --> 00:13:20,959
based on how we know these attacks

387
00:13:20,959 --> 00:13:21,839
happen

388
00:13:21,839 --> 00:13:23,680
so 96 days that they're in this

389
00:13:23,680 --> 00:13:24,880
environment

390
00:13:24,880 --> 00:13:26,800
they have cobalt strike

391
00:13:26,800 --> 00:13:29,120
then we find out that that account that

392
00:13:29,120 --> 00:13:31,600
was used to pivot to west is an

393
00:13:31,600 --> 00:13:34,320
enterprise admin

394
00:13:34,320 --> 00:13:36,320
weird right

395
00:13:36,320 --> 00:13:38,000
and then we ask even more that

396
00:13:38,000 --> 00:13:39,600
enterprise admin account the security

397
00:13:39,600 --> 00:13:41,279
and i t teams have no idea who's

398
00:13:41,279 --> 00:13:43,440
associated with assumption the adversary

399
00:13:43,440 --> 00:13:45,519
created it

400
00:13:45,519 --> 00:13:47,279
for us you know a few guys aren't

401
00:13:47,279 --> 00:13:49,360
windows people and and if you get

402
00:13:49,360 --> 00:13:51,120
enterprise admin

403
00:13:51,120 --> 00:13:53,440
you effectively own the entire forest

404
00:13:53,440 --> 00:13:54,240
right

405
00:13:54,240 --> 00:13:57,839
so you've owned the whole thing

406
00:13:57,839 --> 00:14:00,079
but you didn't deploy ransomware in hq

407
00:14:00,079 --> 00:14:02,800
right hq is the largest domain within

408
00:14:02,800 --> 00:14:04,880
the entire environment it's got the most

409
00:14:04,880 --> 00:14:06,480
critical systems

410
00:14:06,480 --> 00:14:09,839
if you wanted to create leverage

411
00:14:09,839 --> 00:14:11,440
why didn't you deploy ransomware within

412
00:14:11,440 --> 00:14:13,680
the hq domain

413
00:14:13,680 --> 00:14:15,600
incredibly weird right

414
00:14:15,600 --> 00:14:17,680
none of this makes sense

415
00:14:17,680 --> 00:14:19,440
multi-domain ransomware attacks i don't

416
00:14:19,440 --> 00:14:20,959
know if you guys know this they they do

417
00:14:20,959 --> 00:14:22,320
happen

418
00:14:22,320 --> 00:14:23,120
they're

419
00:14:23,120 --> 00:14:24,079
not as

420
00:14:24,079 --> 00:14:25,920
not as frequent but they do happen but

421
00:14:25,920 --> 00:14:27,440
typically it is a

422
00:14:27,440 --> 00:14:29,120
you know one domain gets popped they'll

423
00:14:29,120 --> 00:14:30,560
get enterprise admin and then they'll

424
00:14:30,560 --> 00:14:34,560
blast it out that same day to everyone

425
00:14:34,560 --> 00:14:36,480
this was way different

426
00:14:36,480 --> 00:14:37,839
there's the uh

427
00:14:37,839 --> 00:14:40,240
that event log up the top

428
00:14:40,240 --> 00:14:42,000
as you see that's the cobalt strike

429
00:14:42,000 --> 00:14:42,959
beacon

430
00:14:42,959 --> 00:14:45,440
likely an smb beacon

431
00:14:45,440 --> 00:14:48,000
if you guys aren't collecting

432
00:14:48,000 --> 00:14:49,440
tangent again

433
00:14:49,440 --> 00:14:52,480
that's system event log 7045

434
00:14:52,480 --> 00:14:54,480
if you guys aren't collecting that

435
00:14:54,480 --> 00:14:56,560
building detections around that

436
00:14:56,560 --> 00:14:58,639
write it down put it in your system

437
00:14:58,639 --> 00:15:01,279
tomorrow start doing keyword searches on

438
00:15:01,279 --> 00:15:02,079
it

439
00:15:02,079 --> 00:15:05,120
if i if i was a detection person with no

440
00:15:05,120 --> 00:15:06,880
budget or if i was a responder and i can

441
00:15:06,880 --> 00:15:09,199
only do one thing

442
00:15:09,199 --> 00:15:12,399
it would be to collect that log it is

443
00:15:12,399 --> 00:15:14,959
that valuable

444
00:15:14,959 --> 00:15:17,279
in 2020 we put out a paper about

445
00:15:17,279 --> 00:15:20,160
detection opportunities for adversaries

446
00:15:20,160 --> 00:15:21,839
in 90

447
00:15:21,839 --> 00:15:24,079
of all irs that we work globally we

448
00:15:24,079 --> 00:15:26,240
found evidence of the adversary in that

449
00:15:26,240 --> 00:15:27,199
log

450
00:15:27,199 --> 00:15:29,199
and that's built upon how things like

451
00:15:29,199 --> 00:15:32,320
interpreter metasploit cobalt strike any

452
00:15:32,320 --> 00:15:34,079
one of them covenant all those c2

453
00:15:34,079 --> 00:15:35,360
frameworks how they do things like

454
00:15:35,360 --> 00:15:36,880
privileged escalation or lateral

455
00:15:36,880 --> 00:15:38,959
movement they all do things like by

456
00:15:38,959 --> 00:15:40,480
creating a new service right so

457
00:15:40,480 --> 00:15:41,839
fundamentally

458
00:15:41,839 --> 00:15:43,839
it makes sense because it works right

459
00:15:43,839 --> 00:15:45,120
it's the same reason why people use

460
00:15:45,120 --> 00:15:46,560
scheduled tasks all the time because it

461
00:15:46,560 --> 00:15:47,440
works

462
00:15:47,440 --> 00:15:49,600
collect that event log build detections

463
00:15:49,600 --> 00:15:51,680
off of it

464
00:15:51,680 --> 00:15:54,959
we're collecting our data going through

465
00:15:54,959 --> 00:15:57,440
two weird observations happen next

466
00:15:57,440 --> 00:15:58,480
first

467
00:15:58,480 --> 00:16:00,079
is that we're only finding evidence of

468
00:16:00,079 --> 00:16:01,519
the adversary within the server

469
00:16:01,519 --> 00:16:02,959
infrastructure

470
00:16:02,959 --> 00:16:04,800
nothing in the workstations nothing in

471
00:16:04,800 --> 00:16:07,120
the dmzs the only thing that we find

472
00:16:07,120 --> 00:16:09,519
activity was in windows

473
00:16:09,519 --> 00:16:11,519
core and internal

474
00:16:11,519 --> 00:16:13,279
infrastructure server infrastructure so

475
00:16:13,279 --> 00:16:15,360
that's weird because we can't identify

476
00:16:15,360 --> 00:16:17,040
what did they would they come in through

477
00:16:17,040 --> 00:16:19,440
hq why can't we find them did they go to

478
00:16:19,440 --> 00:16:22,000
west go to hq and back that's stupid

479
00:16:22,000 --> 00:16:23,680
that doesn't make any sense

480
00:16:23,680 --> 00:16:25,199
and the other thing we do

481
00:16:25,199 --> 00:16:27,199
is we get a yara hit

482
00:16:27,199 --> 00:16:29,759
for m.exe

483
00:16:29,759 --> 00:16:33,440
and it gets a yara hit for mimi cats

484
00:16:33,440 --> 00:16:35,440
we pull that back

485
00:16:35,440 --> 00:16:37,759
now on this is on a domain controller

486
00:16:37,759 --> 00:16:39,440
and on this domain controller was an av

487
00:16:39,440 --> 00:16:41,600
and it was a real av it's not like bob's

488
00:16:41,600 --> 00:16:43,040
av that you download off the internet

489
00:16:43,040 --> 00:16:43,920
it's like

490
00:16:43,920 --> 00:16:45,759
something that's going to many cats on

491
00:16:45,759 --> 00:16:46,880
disk

492
00:16:46,880 --> 00:16:49,120
every av is going to hit that right like

493
00:16:49,120 --> 00:16:50,480
that's

494
00:16:50,480 --> 00:16:52,959
baseline we pull that back and the only

495
00:16:52,959 --> 00:16:54,720
thing that hits is our yara signature we

496
00:16:54,720 --> 00:16:56,399
run it through our sandbox the only

497
00:16:56,399 --> 00:16:58,079
thing that hits us on our yard we run it

498
00:16:58,079 --> 00:17:00,639
through our all of our avs that we have

499
00:17:00,639 --> 00:17:02,160
nothing hits

500
00:17:02,160 --> 00:17:04,880
toss it over to the reverse engineers

501
00:17:04,880 --> 00:17:06,400
and we find out

502
00:17:06,400 --> 00:17:08,400
that it is a completely rewrote version

503
00:17:08,400 --> 00:17:10,480
of mimikats in fact the whole logon

504
00:17:10,480 --> 00:17:12,880
passwords module within mimikatz is

505
00:17:12,880 --> 00:17:15,839
completely obfuscated and rewritten

506
00:17:15,839 --> 00:17:18,799
and it extracts a go binary and that's

507
00:17:18,799 --> 00:17:22,480
how it ex gets the creds from windows

508
00:17:22,480 --> 00:17:24,480
holy right

509
00:17:24,480 --> 00:17:26,559
like that's way beyond the capabilities

510
00:17:26,559 --> 00:17:29,360
of most ransomware adversaries picking

511
00:17:29,360 --> 00:17:30,880
up the phone i'm calling people and i'm

512
00:17:30,880 --> 00:17:33,360
like we got something going on here this

513
00:17:33,360 --> 00:17:34,480
doesn't make sense we're going to have

514
00:17:34,480 --> 00:17:36,559
to do round-the-clock monitoring on this

515
00:17:36,559 --> 00:17:38,480
one

516
00:17:38,480 --> 00:17:41,280
the other thing we pull back is that

517
00:17:41,280 --> 00:17:43,039
sec url

518
00:17:43,039 --> 00:17:44,720
chk file

519
00:17:44,720 --> 00:17:46,480
start looking at that it's what's on the

520
00:17:46,480 --> 00:17:48,160
left here

521
00:17:48,160 --> 00:17:49,840
we start digging through that data and

522
00:17:49,840 --> 00:17:51,840
we find out that it is an arp it's a

523
00:17:51,840 --> 00:17:54,000
custom back door that takes a lot of

524
00:17:54,000 --> 00:17:56,160
code from power runner if you guys don't

525
00:17:56,160 --> 00:17:59,360
know power runner is it's a

526
00:17:59,360 --> 00:18:01,440
it's a tool that you can use to run

527
00:18:01,440 --> 00:18:03,600
powershell commands or scripts without

528
00:18:03,600 --> 00:18:06,320
running powershell.exe you pipe it

529
00:18:06,320 --> 00:18:08,720
through it does the dotnet

530
00:18:08,720 --> 00:18:10,559
calls directly translate them so you can

531
00:18:10,559 --> 00:18:12,400
just run regular powershell commandlets

532
00:18:12,400 --> 00:18:13,760
without

533
00:18:13,760 --> 00:18:15,679
invoking the binary so it's a bypass

534
00:18:15,679 --> 00:18:17,120
mechanism

535
00:18:17,120 --> 00:18:18,640
the other thing that we see is that it

536
00:18:18,640 --> 00:18:20,720
listens on our pcs we'll accept any

537
00:18:20,720 --> 00:18:22,880
commands execute them through a command

538
00:18:22,880 --> 00:18:24,559
terminal

539
00:18:24,559 --> 00:18:25,679
on the bottom there you see that

540
00:18:25,679 --> 00:18:28,080
function install

541
00:18:28,080 --> 00:18:29,600
what that does is that that's its

542
00:18:29,600 --> 00:18:32,000
persistence mechanism right so that is

543
00:18:32,000 --> 00:18:34,960
creating a new shared service so within

544
00:18:34,960 --> 00:18:36,799
windows there's two well there's four

545
00:18:36,799 --> 00:18:38,160
different types of services but there's

546
00:18:38,160 --> 00:18:40,160
two main ones there's standalone and

547
00:18:40,160 --> 00:18:42,799
they're shared process services

548
00:18:42,799 --> 00:18:45,919
now it's not unheard of to see

549
00:18:45,919 --> 00:18:48,960
adversaries use shared process services

550
00:18:48,960 --> 00:18:51,200
as a persistence technique

551
00:18:51,200 --> 00:18:53,440
it's very unheard of to see it from a

552
00:18:53,440 --> 00:18:55,440
ransomware operator right because you

553
00:18:55,440 --> 00:18:57,840
have to custom craft a dll you got to

554
00:18:57,840 --> 00:18:59,600
make sure it executes but it's in a

555
00:18:59,600 --> 00:19:01,840
really good sneaky way

556
00:19:01,840 --> 00:19:04,720
because you have service hose binary

557
00:19:04,720 --> 00:19:05,760
loading

558
00:19:05,760 --> 00:19:08,080
your pro so it runs as a as a library

559
00:19:08,080 --> 00:19:10,240
that's loaded by service hosts and they

560
00:19:10,240 --> 00:19:11,760
also tuck it into

561
00:19:11,760 --> 00:19:14,160
net services as a service group which

562
00:19:14,160 --> 00:19:16,320
gives it unfettered network access so

563
00:19:16,320 --> 00:19:19,360
they have some dev capability

564
00:19:19,360 --> 00:19:21,120
which isn't something that we typically

565
00:19:21,120 --> 00:19:21,840
see

566
00:19:21,840 --> 00:19:23,600
amongst ransomware operators it's

567
00:19:23,600 --> 00:19:24,799
usually rinse and repeat there's not a

568
00:19:24,799 --> 00:19:26,640
lot of custom tooling

569
00:19:26,640 --> 00:19:28,559
we start digging around on that golden

570
00:19:28,559 --> 00:19:31,679
that domain controller top right there

571
00:19:31,679 --> 00:19:34,880
event log four four or four six six two

572
00:19:34,880 --> 00:19:37,280
if you see that without that it's not a

573
00:19:37,280 --> 00:19:38,799
computer account name in the account

574
00:19:38,799 --> 00:19:40,640
name write that one down

575
00:19:40,640 --> 00:19:42,240
that's an evidence that that machine has

576
00:19:42,240 --> 00:19:46,320
been dc synced right through manycats

577
00:19:46,320 --> 00:19:47,600
problem is

578
00:19:47,600 --> 00:19:50,160
the associated user account is not from

579
00:19:50,160 --> 00:19:53,200
the hq domain it's from the east domain

580
00:19:53,200 --> 00:19:55,679
so now we have a multi-domain hop going

581
00:19:55,679 --> 00:19:58,480
on to deploy ransomware like

582
00:19:58,480 --> 00:20:00,960
now that never happens right that that

583
00:20:00,960 --> 00:20:02,480
this is the first ever i've never seen

584
00:20:02,480 --> 00:20:04,840
it again looking around at more of the

585
00:20:04,840 --> 00:20:08,240
data we can see that the adversary had

586
00:20:08,240 --> 00:20:10,240
created a golden ticket and taken

587
00:20:10,240 --> 00:20:13,520
advantage of the extra sid attribute

588
00:20:13,520 --> 00:20:15,200
if you guys uh there's a fantastic

589
00:20:15,200 --> 00:20:16,720
article that harm joy wrote it's called

590
00:20:16,720 --> 00:20:18,320
the truspocalypse

591
00:20:18,320 --> 00:20:20,480
he can explain it much better than i so

592
00:20:20,480 --> 00:20:21,919
if you're interested do that all you

593
00:20:21,919 --> 00:20:23,360
need to know

594
00:20:23,360 --> 00:20:26,480
is within active directory there is a

595
00:20:26,480 --> 00:20:28,400
attribute called the extra sid and it

596
00:20:28,400 --> 00:20:30,080
was created

597
00:20:30,080 --> 00:20:32,640
is either to whenever you're migrating

598
00:20:32,640 --> 00:20:34,480
content to a new domain or you're

599
00:20:34,480 --> 00:20:36,320
upgrading from like

600
00:20:36,320 --> 00:20:39,600
the functional level of 2008 to 2008 r2

601
00:20:39,600 --> 00:20:41,120
something either one of those i can't

602
00:20:41,120 --> 00:20:44,159
remember but what he discovered

603
00:20:44,159 --> 00:20:46,240
and then mimikatz implemented

604
00:20:46,240 --> 00:20:50,559
is that if you own the child domain

605
00:20:50,559 --> 00:20:53,919
and you have the krp tgt hash you can

606
00:20:53,919 --> 00:20:55,200
append

607
00:20:55,200 --> 00:20:57,600
the enterprise admin account

608
00:20:57,600 --> 00:21:00,400
to your account and the parent domain

609
00:21:00,400 --> 00:21:03,679
will respect it effectively meaning that

610
00:21:03,679 --> 00:21:06,000
if you own a child domain

611
00:21:06,000 --> 00:21:08,720
you can own the forest

612
00:21:08,720 --> 00:21:10,720
that's a big deal right because now i

613
00:21:10,720 --> 00:21:12,159
think that fundamentally changes what

614
00:21:12,159 --> 00:21:13,919
you think about trust boundaries in

615
00:21:13,919 --> 00:21:16,080
terms of active directory and what you

616
00:21:16,080 --> 00:21:18,640
should be doing from a prevention or

617
00:21:18,640 --> 00:21:20,799
detection point of view is that any

618
00:21:20,799 --> 00:21:22,400
child domain

619
00:21:22,400 --> 00:21:24,159
can take a parent's

620
00:21:24,159 --> 00:21:26,159
privileges and so on and so forth right

621
00:21:26,159 --> 00:21:28,000
in this case it was the root domain

622
00:21:28,000 --> 00:21:30,480
worst case scenario

623
00:21:30,480 --> 00:21:31,919
so again

624
00:21:31,919 --> 00:21:35,039
we need to expand scope

625
00:21:35,039 --> 00:21:37,120
call up the east domain and they're like

626
00:21:37,120 --> 00:21:38,559
well we don't have a problem we don't

627
00:21:38,559 --> 00:21:40,480
have any alerts our we don't have av

628
00:21:40,480 --> 00:21:42,240
like avs clean i don't know what you're

629
00:21:42,240 --> 00:21:43,600
talking about

630
00:21:43,600 --> 00:21:46,880
there's no new admin accounts created

631
00:21:46,880 --> 00:21:48,799
we have we have no idea what you mean

632
00:21:48,799 --> 00:21:51,039
but you know ceos on the phone at this

633
00:21:51,039 --> 00:21:53,120
point they're like do the thing

634
00:21:53,120 --> 00:21:54,960
deploy the tech

635
00:21:54,960 --> 00:21:58,320
collect the artifacts start analyzing

636
00:21:58,320 --> 00:22:01,520
the data we find 100 days ago 100 days

637
00:22:01,520 --> 00:22:03,120
before ransomware

638
00:22:03,120 --> 00:22:06,640
that same custom mimikatz variant

639
00:22:06,640 --> 00:22:09,200
is in the east domain so 100 days like

640
00:22:09,200 --> 00:22:11,440
that's a long time to wait on a

641
00:22:11,440 --> 00:22:13,919
ransomware attack right

642
00:22:13,919 --> 00:22:16,480
too long

643
00:22:16,559 --> 00:22:18,960
we start enumerating all the data and we

644
00:22:18,960 --> 00:22:22,400
find some really interesting things

645
00:22:22,400 --> 00:22:24,880
some of the coolest things that i have

646
00:22:24,880 --> 00:22:26,960
seen in my career the stuff that didn't

647
00:22:26,960 --> 00:22:29,200
make sense honestly until we you know

648
00:22:29,200 --> 00:22:31,520
until we went all the way through it

649
00:22:31,520 --> 00:22:33,600
let me show you some of the stuff that

650
00:22:33,600 --> 00:22:34,799
we found

651
00:22:34,799 --> 00:22:36,480
the first thing

652
00:22:36,480 --> 00:22:38,559
we find again

653
00:22:38,559 --> 00:22:41,039
windows event log 7045

654
00:22:41,039 --> 00:22:43,120
we see hits on a detection creating a

655
00:22:43,120 --> 00:22:44,799
scheduled test now

656
00:22:44,799 --> 00:22:46,320
weird thing about this that caught

657
00:22:46,320 --> 00:22:47,919
everyone's attention that is that this

658
00:22:47,919 --> 00:22:49,760
binary which we thought to be malware

659
00:22:49,760 --> 00:22:52,080
was calling a wave file

660
00:22:52,080 --> 00:22:54,720
that's weird not unheard of though you

661
00:22:54,720 --> 00:22:56,240
know a lot of the popular malware

662
00:22:56,240 --> 00:22:58,799
families will do things like i'm calling

663
00:22:58,799 --> 00:23:01,120
jase i'm calling javascript through

664
00:23:01,120 --> 00:23:02,640
c-script but i'm going to call it in a

665
00:23:02,640 --> 00:23:04,799
text file or picture file right but it's

666
00:23:04,799 --> 00:23:06,640
just an extension rename

667
00:23:06,640 --> 00:23:08,799
we pull that back i'm expecting to see

668
00:23:08,799 --> 00:23:10,720
this is some sort of portable executable

669
00:23:10,720 --> 00:23:12,559
look at the headers

670
00:23:12,559 --> 00:23:14,720
no it's not there

671
00:23:14,720 --> 00:23:17,280
pull that wav file back into our sandbox

672
00:23:17,280 --> 00:23:19,919
and i'm like i wonder

673
00:23:19,919 --> 00:23:21,360
open it up immediate player and the

674
00:23:21,360 --> 00:23:23,280
thing plays music

675
00:23:23,280 --> 00:23:26,480
like real music and i'm like am i about

676
00:23:26,480 --> 00:23:28,720
to get the most elaborate rick roll of

677
00:23:28,720 --> 00:23:31,679
all time right now

678
00:23:32,240 --> 00:23:33,919
so this doesn't make any sense we pull

679
00:23:33,919 --> 00:23:36,960
back the task list exe shocker it's not

680
00:23:36,960 --> 00:23:39,520
the microsoft one we have to do a long a

681
00:23:39,520 --> 00:23:42,080
lot of analysis on this

682
00:23:42,080 --> 00:23:42,880
what

683
00:23:42,880 --> 00:23:44,559
nothing hits in sandbox something hits

684
00:23:44,559 --> 00:23:46,640
an av virustotal never heard of this

685
00:23:46,640 --> 00:23:48,320
thing before no one knows anything about

686
00:23:48,320 --> 00:23:51,120
it so what we discovered is that task

687
00:23:51,120 --> 00:23:54,559
list w dot exe is a custom loader that

688
00:23:54,559 --> 00:23:57,440
will only load audio files within the

689
00:23:57,440 --> 00:24:00,760
audio file using really packed

690
00:24:00,760 --> 00:24:02,480
stegonography

691
00:24:02,480 --> 00:24:07,279
is a dll that gets loaded into memory

692
00:24:07,520 --> 00:24:10,640
not not encoded in the header

693
00:24:10,640 --> 00:24:12,799
in the audio data

694
00:24:12,799 --> 00:24:17,120
is a dll packed in steganography right

695
00:24:17,120 --> 00:24:19,600
hopefully that lands how cool that is

696
00:24:19,600 --> 00:24:20,559
right

697
00:24:20,559 --> 00:24:23,840
so it extracts itself

698
00:24:23,840 --> 00:24:26,400
launches a run dll32 process then

699
00:24:26,400 --> 00:24:28,720
executes a bunch of shell code injects

700
00:24:28,720 --> 00:24:29,760
into that

701
00:24:29,760 --> 00:24:32,400
goes out to an internet resource

702
00:24:32,400 --> 00:24:35,120
downloads yet another dll

703
00:24:35,120 --> 00:24:37,520
then it does some anti-analysis checks

704
00:24:37,520 --> 00:24:39,600
so it checks to make sure like all adb

705
00:24:39,600 --> 00:24:41,200
isn't running checks that it's not

706
00:24:41,200 --> 00:24:42,880
running in a virtual machine checks that

707
00:24:42,880 --> 00:24:44,240
it's not running

708
00:24:44,240 --> 00:24:46,000
with any other analysis tools or

709
00:24:46,000 --> 00:24:48,720
sandboxes and when that only when that

710
00:24:48,720 --> 00:24:50,559
happens then it will load a cobalt

711
00:24:50,559 --> 00:24:52,720
strike beacon

712
00:24:52,720 --> 00:24:54,799
i haven't really talked about this

713
00:24:54,799 --> 00:24:56,720
through this because i honestly just

714
00:24:56,720 --> 00:25:00,000
forgot but this checked into its sixth

715
00:25:00,000 --> 00:25:03,840
set of c2 at this point so we have

716
00:25:03,840 --> 00:25:06,799
this is a brand new c2 infrastructure in

717
00:25:06,799 --> 00:25:09,039
east versus hq

718
00:25:09,039 --> 00:25:12,000
versus three sets of c2

719
00:25:12,000 --> 00:25:13,600
in west

720
00:25:13,600 --> 00:25:16,159
which shows not only seeing some

721
00:25:16,159 --> 00:25:17,919
developer capability obviously with

722
00:25:17,919 --> 00:25:19,520
custom tooling but they also have the

723
00:25:19,520 --> 00:25:23,440
resources to maintain and migrate c2

724
00:25:23,440 --> 00:25:25,760
across various hosting sites

725
00:25:25,760 --> 00:25:28,880
across the globe

726
00:25:28,880 --> 00:25:29,840
again

727
00:25:29,840 --> 00:25:32,000
we go through the process right

728
00:25:32,000 --> 00:25:34,320
collect some more shiz

729
00:25:34,320 --> 00:25:37,360
get another detection for uh file name

730
00:25:37,360 --> 00:25:38,880
original file name

731
00:25:38,880 --> 00:25:40,400
mismatch

732
00:25:40,400 --> 00:25:42,320
check that one too if you guys have that

733
00:25:42,320 --> 00:25:43,919
renamed binaries it's a great way to

734
00:25:43,919 --> 00:25:45,039
find evil

735
00:25:45,039 --> 00:25:47,120
java workstation.exe

736
00:25:47,120 --> 00:25:49,760
was originally named x.exe connecting

737
00:25:49,760 --> 00:25:50,960
out to

738
00:25:50,960 --> 00:25:52,480
an ip

739
00:25:52,480 --> 00:25:54,159
internet routable ip

740
00:25:54,159 --> 00:25:55,520
the other thing that

741
00:25:55,520 --> 00:25:57,039
if i recall correctly the other thing

742
00:25:57,039 --> 00:25:58,880
that the analyst flagged

743
00:25:58,880 --> 00:26:00,080
was this

744
00:26:00,080 --> 00:26:01,039
in

745
00:26:01,039 --> 00:26:04,480
windows event log 50 5144

746
00:26:04,480 --> 00:26:06,080
i believe

747
00:26:06,080 --> 00:26:08,000
that's in the windows firewall file

748
00:26:08,000 --> 00:26:09,520
event log and that will

749
00:26:09,520 --> 00:26:12,799
log when a binary changes or makes an

750
00:26:12,799 --> 00:26:15,120
exception to the windows firewall and in

751
00:26:15,120 --> 00:26:16,240
this case

752
00:26:16,240 --> 00:26:19,039
java ws.exe was creating an exception to

753
00:26:19,039 --> 00:26:20,240
allow

754
00:26:20,240 --> 00:26:21,679
on inbound

755
00:26:21,679 --> 00:26:23,440
network connections from anywhere so

756
00:26:23,440 --> 00:26:26,000
that got flagged and then we go and we

757
00:26:26,000 --> 00:26:27,840
take a look at it

758
00:26:27,840 --> 00:26:29,679
again nothing in the sandbox nothing in

759
00:26:29,679 --> 00:26:30,720
av

760
00:26:30,720 --> 00:26:32,000
just blank so we have to do some real

761
00:26:32,000 --> 00:26:33,679
analysis on it

762
00:26:33,679 --> 00:26:36,240
and what we find out is that java.ws.exe

763
00:26:36,240 --> 00:26:39,440
is not the real one um but what it does

764
00:26:39,440 --> 00:26:41,440
is it extracts a dll

765
00:26:41,440 --> 00:26:44,159
which then dumps all this data into the

766
00:26:44,159 --> 00:26:46,080
windows media player

767
00:26:46,080 --> 00:26:49,120
registry key and all that data

768
00:26:49,120 --> 00:26:51,520
is a bunch of shell code which then

769
00:26:51,520 --> 00:26:53,200
extracts itself

770
00:26:53,200 --> 00:26:54,880
runs in memory

771
00:26:54,880 --> 00:26:56,880
creates a windows firewall rule for run

772
00:26:56,880 --> 00:26:58,960
dll to make sure it does everything

773
00:26:58,960 --> 00:27:00,960
creates a bunch of registry keys for ps

774
00:27:00,960 --> 00:27:02,640
execs so it doesn't get

775
00:27:02,640 --> 00:27:04,480
if they're going to run like you know ps

776
00:27:04,480 --> 00:27:06,960
exec no one gets a prompt or if they're

777
00:27:06,960 --> 00:27:08,480
running at a system it doesn't just hang

778
00:27:08,480 --> 00:27:09,440
there

779
00:27:09,440 --> 00:27:11,440
and then once it all does that then it

780
00:27:11,440 --> 00:27:12,880
will load them interpreter session with

781
00:27:12,880 --> 00:27:14,720
a brand new set

782
00:27:14,720 --> 00:27:16,240
of c2

783
00:27:16,240 --> 00:27:19,600
seven sets of c2 at this point

784
00:27:19,600 --> 00:27:21,200
we're going on

785
00:27:21,200 --> 00:27:23,679
now i have i should mention at this

786
00:27:23,679 --> 00:27:24,799
point

787
00:27:24,799 --> 00:27:28,240
we're a week and a half into the ir

788
00:27:28,240 --> 00:27:30,720
there's no indication that the adversary

789
00:27:30,720 --> 00:27:33,200
is active all these back doors are just

790
00:27:33,200 --> 00:27:36,320
hanging out they check in

791
00:27:36,320 --> 00:27:38,720
nothing else right the only

792
00:27:38,720 --> 00:27:40,960
sign that someone has been there was a

793
00:27:40,960 --> 00:27:43,919
ransomware on the west coast

794
00:27:43,919 --> 00:27:45,679
headquarters nothing

795
00:27:45,679 --> 00:27:47,360
no activity

796
00:27:47,360 --> 00:27:50,399
east nothing no activity

797
00:27:50,399 --> 00:27:51,600
although given the level of the

798
00:27:51,600 --> 00:27:55,120
tradecraft we're monitoring this 24x7

799
00:27:55,120 --> 00:27:57,360
several days go by

800
00:27:57,360 --> 00:27:59,039
and then we get a hit

801
00:27:59,039 --> 00:28:01,520
so we get a hit on cert util going out

802
00:28:01,520 --> 00:28:03,840
to the internet github in this case

803
00:28:03,840 --> 00:28:06,880
downloading a package

804
00:28:06,880 --> 00:28:09,440
this was huge for us because it also

805
00:28:09,440 --> 00:28:11,760
showed us that an adversary was active

806
00:28:11,760 --> 00:28:14,240
they came back for some reason the other

807
00:28:14,240 --> 00:28:15,840
thing that it is we were able to yoink

808
00:28:15,840 --> 00:28:18,320
their github repo and download all their

809
00:28:18,320 --> 00:28:20,960
tooling so that we could proactively go

810
00:28:20,960 --> 00:28:22,559
out and find

811
00:28:22,559 --> 00:28:24,000
systems of interest that they might be

812
00:28:24,000 --> 00:28:26,559
pivoting to

813
00:28:27,200 --> 00:28:29,039
now

814
00:28:29,039 --> 00:28:30,720
hopefully you guys know what ngrok is if

815
00:28:30,720 --> 00:28:32,240
you don't know what ngrok is just think

816
00:28:32,240 --> 00:28:34,240
of it as tunneling software

817
00:28:34,240 --> 00:28:36,799
in this case they're tunneling rdp

818
00:28:36,799 --> 00:28:38,880
not fan not all that fancy we see that

819
00:28:38,880 --> 00:28:42,480
all the time ransomware operators alike

820
00:28:42,480 --> 00:28:45,120
now what was cool which i thought was

821
00:28:45,120 --> 00:28:46,720
cool and it showed that the adversary

822
00:28:46,720 --> 00:28:48,000
actually had some understanding of the

823
00:28:48,000 --> 00:28:49,760
environment not only the environment

824
00:28:49,760 --> 00:28:51,679
they had the operational security to

825
00:28:51,679 --> 00:28:53,200
understand how this helped desk software

826
00:28:53,200 --> 00:28:54,799
obviously it changed the name

827
00:28:54,799 --> 00:28:57,919
if you go back and did a historical look

828
00:28:57,919 --> 00:28:59,279
to see

829
00:28:59,279 --> 00:29:02,159
what did this binary do the legit one i

830
00:29:02,159 --> 00:29:04,320
don't know why or the purpose of it i

831
00:29:04,320 --> 00:29:05,919
think it facilitated something for the

832
00:29:05,919 --> 00:29:08,320
help desk but it was regularly making

833
00:29:08,320 --> 00:29:10,799
connections over 33.89 for internal

834
00:29:10,799 --> 00:29:12,399
resources so

835
00:29:12,399 --> 00:29:14,880
if you're a sock person and you saw

836
00:29:14,880 --> 00:29:16,720
helpdesk.exe make a connection over

837
00:29:16,720 --> 00:29:18,320
33.89 there's a likelihood you'd

838
00:29:18,320 --> 00:29:20,080
probably just let it go or it's already

839
00:29:20,080 --> 00:29:22,399
accepted or bypass like it's already

840
00:29:22,399 --> 00:29:24,320
whitelisted so i thought that was pretty

841
00:29:24,320 --> 00:29:26,240
cool that they knew what that software

842
00:29:26,240 --> 00:29:27,919
is what that software does and then try

843
00:29:27,919 --> 00:29:29,520
to hide out

844
00:29:29,520 --> 00:29:32,159
so since we have this

845
00:29:32,159 --> 00:29:35,039
also eighth set of c2 at this point

846
00:29:35,039 --> 00:29:39,320
right now we're working off the n grok

847
00:29:41,440 --> 00:29:42,960
now that we have an active adversary we

848
00:29:42,960 --> 00:29:44,480
try to find out where they came from

849
00:29:44,480 --> 00:29:45,520
obviously

850
00:29:45,520 --> 00:29:47,440
right

851
00:29:47,440 --> 00:29:51,440
and then this happens right keyword hit

852
00:29:51,440 --> 00:29:52,840
support

853
00:29:52,840 --> 00:29:54,640
452.

854
00:29:54,640 --> 00:29:56,559
old heads in the crowd

855
00:29:56,559 --> 00:29:57,440
know

856
00:29:57,440 --> 00:30:00,480
that that is bad news right back in the

857
00:30:00,480 --> 00:30:02,559
day there was an advanced russian

858
00:30:02,559 --> 00:30:05,440
adversary they went by cobalt group and

859
00:30:05,440 --> 00:30:07,520
they used to attack swift and atm

860
00:30:07,520 --> 00:30:08,640
networks

861
00:30:08,640 --> 00:30:10,880
all the time and they stole

862
00:30:10,880 --> 00:30:12,399
so much money

863
00:30:12,399 --> 00:30:15,200
and one thing that they always did

864
00:30:15,200 --> 00:30:17,440
was create an account called support

865
00:30:17,440 --> 00:30:19,120
four five i was actually shocked because

866
00:30:19,120 --> 00:30:20,640
this but they've been so quiet i was

867
00:30:20,640 --> 00:30:22,000
actually shocked that that detection was

868
00:30:22,000 --> 00:30:24,080
still running

869
00:30:24,080 --> 00:30:26,320
they used to create a an account called

870
00:30:26,320 --> 00:30:28,720
support 5.2 and add it to the hidden

871
00:30:28,720 --> 00:30:31,440
users list

872
00:30:31,440 --> 00:30:33,520
this right here oh windows event logs

873
00:30:33,520 --> 00:30:35,600
7045 again guys

874
00:30:35,600 --> 00:30:37,279
hopefully this is landing

875
00:30:37,279 --> 00:30:39,279
this registry key if you're not

876
00:30:39,279 --> 00:30:42,000
monitoring for that for like any command

877
00:30:42,000 --> 00:30:43,760
line interpreters that are modifying

878
00:30:43,760 --> 00:30:45,760
that register key you should it's really

879
00:30:45,760 --> 00:30:46,799
good

880
00:30:46,799 --> 00:30:48,960
there's very very false positive rate

881
00:30:48,960 --> 00:30:50,799
and the adversaries are doing that what

882
00:30:50,799 --> 00:30:53,120
this key does if you're not familiar is

883
00:30:53,120 --> 00:30:55,279
if you go onto a workstation right in

884
00:30:55,279 --> 00:30:57,440
windows and it usually will either show

885
00:30:57,440 --> 00:30:59,200
you like a list of people you can log in

886
00:30:59,200 --> 00:31:02,080
as it won't show you that support 452

887
00:31:02,080 --> 00:31:03,679
isn't there if you go to see users you

888
00:31:03,679 --> 00:31:06,399
won't see support 452. so it's a hidden

889
00:31:06,399 --> 00:31:08,080
user registry key you added to that you

890
00:31:08,080 --> 00:31:10,000
could basically have an account

891
00:31:10,000 --> 00:31:11,360
without

892
00:31:11,360 --> 00:31:13,120
a cursory view no one would know that

893
00:31:13,120 --> 00:31:14,320
it's there

894
00:31:14,320 --> 00:31:15,360
so

895
00:31:15,360 --> 00:31:16,320
what

896
00:31:16,320 --> 00:31:18,640
is going on here that's weird that we

897
00:31:18,640 --> 00:31:20,960
would see this like immediately for me

898
00:31:20,960 --> 00:31:22,880
from my background

899
00:31:22,880 --> 00:31:24,640
doing this a long time when i saw that i

900
00:31:24,640 --> 00:31:27,039
was like blown away i was i was like

901
00:31:27,039 --> 00:31:29,200
cobalt group are you kidding me what is

902
00:31:29,200 --> 00:31:30,880
going on right now i haven't seen them

903
00:31:30,880 --> 00:31:33,440
in years the other thing obviously that

904
00:31:33,440 --> 00:31:35,840
workstation name is sus but

905
00:31:35,840 --> 00:31:37,440
that ip address

906
00:31:37,440 --> 00:31:39,600
according to the client

907
00:31:39,600 --> 00:31:42,159
does not exist in their network

908
00:31:42,159 --> 00:31:44,320
that's that was a hard no talking to the

909
00:31:44,320 --> 00:31:46,240
network engineers they're like we don't

910
00:31:46,240 --> 00:31:49,679
do 192.168 anywhere because those are

911
00:31:49,679 --> 00:31:51,919
often the default for consumer grade

912
00:31:51,919 --> 00:31:56,080
devices so we do everything on 172.16

913
00:31:56,080 --> 00:31:58,880
so that can't happen

914
00:31:58,880 --> 00:32:00,720
clearly it happens right so the hunt is

915
00:32:00,720 --> 00:32:03,039
on it's like where where did this log on

916
00:32:03,039 --> 00:32:04,159
come from

917
00:32:04,159 --> 00:32:06,480
because it came from somewhere

918
00:32:06,480 --> 00:32:08,720
it had to come from somewhere like

919
00:32:08,720 --> 00:32:11,919
you can't make that up

920
00:32:11,919 --> 00:32:15,440
well technically you can but

921
00:32:15,440 --> 00:32:17,760
that's a whole other talk

922
00:32:17,760 --> 00:32:19,120
so

923
00:32:19,120 --> 00:32:22,240
the hunt is on what do we find out

924
00:32:22,240 --> 00:32:25,200
is this company in the east

925
00:32:25,200 --> 00:32:27,440
shared an office building with another

926
00:32:27,440 --> 00:32:28,480
company

927
00:32:28,480 --> 00:32:30,080
and within that office building there

928
00:32:30,080 --> 00:32:32,240
was one security office

929
00:32:32,240 --> 00:32:34,399
within that security office there was

930
00:32:34,399 --> 00:32:36,320
one badge printer

931
00:32:36,320 --> 00:32:39,519
and what someone did

932
00:32:39,519 --> 00:32:42,000
was set up a bridge network that

933
00:32:42,000 --> 00:32:43,760
connected company a

934
00:32:43,760 --> 00:32:45,519
to company b

935
00:32:45,519 --> 00:32:47,919
so that the security office could share

936
00:32:47,919 --> 00:32:49,679
a badge printer

937
00:32:49,679 --> 00:32:51,840
and so there was a fat pipe going right

938
00:32:51,840 --> 00:32:53,760
into our clients network that they had

939
00:32:53,760 --> 00:32:58,080
no idea now obviously we asked about it

940
00:32:58,080 --> 00:32:59,760
either no one wanted to fess up to it

941
00:32:59,760 --> 00:33:01,120
which

942
00:33:01,120 --> 00:33:03,279
you know being a former i.t person i

943
00:33:03,279 --> 00:33:05,679
don't blame them or they left or they

944
00:33:05,679 --> 00:33:08,799
forgot or they didn't do it or who knows

945
00:33:08,799 --> 00:33:11,200
but we go back we analyze those systems

946
00:33:11,200 --> 00:33:13,279
we find homies been hanging out there

947
00:33:13,279 --> 00:33:16,080
for 38 uh over a year

948
00:33:16,080 --> 00:33:17,840
over a year

949
00:33:17,840 --> 00:33:20,559
hanging out

950
00:33:20,720 --> 00:33:23,039
if you're a ransomware person

951
00:33:23,039 --> 00:33:25,200
homie why are you burning all this great

952
00:33:25,200 --> 00:33:26,240
tooling

953
00:33:26,240 --> 00:33:28,320
to carry out a small ass ransomware

954
00:33:28,320 --> 00:33:32,320
attack this is nuts it makes no sense

955
00:33:32,320 --> 00:33:34,480
we're calling everyone at this point

956
00:33:34,480 --> 00:33:36,799
because it it fascinating right so we

957
00:33:36,799 --> 00:33:39,360
call the client everyone's jazzed up

958
00:33:39,360 --> 00:33:40,799
because the whole team's on board it's

959
00:33:40,799 --> 00:33:42,080
like we're going to get access to this

960
00:33:42,080 --> 00:33:44,799
organization we're going to find out

961
00:33:44,799 --> 00:33:46,799
how mystery hacker got in there if this

962
00:33:46,799 --> 00:33:49,279
is cobalt group that i'm going to owe a

963
00:33:49,279 --> 00:33:50,640
lot of people a bottle of bourbon

964
00:33:50,640 --> 00:33:53,360
because i said there's no way

965
00:33:53,360 --> 00:33:55,760
it's cobalt group

966
00:33:55,760 --> 00:33:58,320
briefed the other organization

967
00:33:58,320 --> 00:34:00,240
they were very appreciative

968
00:34:00,240 --> 00:34:02,720
gave them our iocs

969
00:34:02,720 --> 00:34:04,399
gets you ready to spin up the engagement

970
00:34:04,399 --> 00:34:05,679
turns out that they have an agreement

971
00:34:05,679 --> 00:34:07,600
with another ir firm

972
00:34:07,600 --> 00:34:09,119
sad face

973
00:34:09,119 --> 00:34:10,560
they're going to engage with that irfm

974
00:34:10,560 --> 00:34:12,000
which i get i mean retainers are

975
00:34:12,000 --> 00:34:14,560
retainers

976
00:34:14,639 --> 00:34:16,639
that ir firm wasn't

977
00:34:16,639 --> 00:34:18,879
going to share data so we ultimately

978
00:34:18,879 --> 00:34:20,480
have no idea

979
00:34:20,480 --> 00:34:22,079
right

980
00:34:22,079 --> 00:34:24,639
how they got who where it came from how

981
00:34:24,639 --> 00:34:27,199
they got into that other organization

982
00:34:27,199 --> 00:34:30,000
or any of the juicy details

983
00:34:30,000 --> 00:34:31,440
which is unfortunate it was kind of hit

984
00:34:31,440 --> 00:34:32,960
of a dead end we're talking with that

985
00:34:32,960 --> 00:34:36,000
client and what we find out

986
00:34:36,000 --> 00:34:39,599
is that the other company

987
00:34:39,599 --> 00:34:42,560
this these guys down here

988
00:34:42,560 --> 00:34:44,800
they are an hvac and control system

989
00:34:44,800 --> 00:34:46,879
company

990
00:34:46,879 --> 00:34:48,960
and they have government contracts

991
00:34:48,960 --> 00:34:52,079
across the nation to install hvac and

992
00:34:52,079 --> 00:34:55,760
control system in government buildings

993
00:34:56,639 --> 00:34:58,320
boom right

994
00:34:58,320 --> 00:35:01,280
wild tinfoil hats go on because we have

995
00:35:01,280 --> 00:35:03,040
no data so we're just like speculating

996
00:35:03,040 --> 00:35:06,320
at this point like who is this

997
00:35:06,320 --> 00:35:08,640
and now it starts to make sense right so

998
00:35:08,640 --> 00:35:09,680
but it's still it's like why did

999
00:35:09,680 --> 00:35:11,520
ransomware at the end

1000
00:35:11,520 --> 00:35:13,599
all the other parts make sense

1001
00:35:13,599 --> 00:35:15,839
right i'm hiding out in east

1002
00:35:15,839 --> 00:35:17,599
beachhead that i have my advanced

1003
00:35:17,599 --> 00:35:18,640
tooling

1004
00:35:18,640 --> 00:35:21,359
nothing's detecting it we're good i can

1005
00:35:21,359 --> 00:35:22,800
always get back into government

1006
00:35:22,800 --> 00:35:25,280
facilities through this pipe

1007
00:35:25,280 --> 00:35:28,320
that only i know about

1008
00:35:28,320 --> 00:35:32,480
why ransomware right

1009
00:35:34,320 --> 00:35:37,200
i'm going to tell you guys

1010
00:35:38,160 --> 00:35:40,079
days later we're doing every time we do

1011
00:35:40,079 --> 00:35:41,680
custom malware analysis we create a

1012
00:35:41,680 --> 00:35:43,440
bunch of yara rules and we're always

1013
00:35:43,440 --> 00:35:45,119
monitoring stuff that's being uploaded

1014
00:35:45,119 --> 00:35:47,280
to things like virustotal reversing labs

1015
00:35:47,280 --> 00:35:49,440
and we get a hit

1016
00:35:49,440 --> 00:35:51,440
for the java and waveloaders as well as

1017
00:35:51,440 --> 00:35:53,520
our custom mimikats

1018
00:35:53,520 --> 00:35:55,440
so we get on the phone we're using all

1019
00:35:55,440 --> 00:35:57,040
of our intel contacts we're like who

1020
00:35:57,040 --> 00:35:58,240
knows about this who knows about this

1021
00:35:58,240 --> 00:36:00,960
who knows about this we find out

1022
00:36:00,960 --> 00:36:02,640
and you can google this i'm not big on

1023
00:36:02,640 --> 00:36:04,800
saying other company names but like if

1024
00:36:04,800 --> 00:36:07,119
you google wave malware you'll find the

1025
00:36:07,119 --> 00:36:10,079
article that i'm talking about

1026
00:36:10,079 --> 00:36:10,880
uh

1027
00:36:10,880 --> 00:36:13,440
we find out this other uh

1028
00:36:13,440 --> 00:36:15,040
firm who we have a really good

1029
00:36:15,040 --> 00:36:17,599
relationship was just getting ready to

1030
00:36:17,599 --> 00:36:19,280
release a report

1031
00:36:19,280 --> 00:36:20,960
about turla

1032
00:36:20,960 --> 00:36:24,079
executing the same payloads to carry out

1033
00:36:24,079 --> 00:36:26,000
government espionage activities across

1034
00:36:26,000 --> 00:36:27,920
the middle east and europe

1035
00:36:27,920 --> 00:36:30,480
not only was it the same tooling we have

1036
00:36:30,480 --> 00:36:32,560
a c2 overlap

1037
00:36:32,560 --> 00:36:35,280
with the stuff that we had in our ir

1038
00:36:35,280 --> 00:36:37,280
looking at the time frames

1039
00:36:37,280 --> 00:36:39,599
we see that it is the same days

1040
00:36:39,599 --> 00:36:42,640
so same days that we have activity

1041
00:36:42,640 --> 00:36:46,400
of legit espionage going on from turla

1042
00:36:46,400 --> 00:36:48,320
we have an overlap of infrastructure and

1043
00:36:48,320 --> 00:36:51,040
overlapping in tooling and we have an

1044
00:36:51,040 --> 00:36:55,359
overlap in time with our ir

1045
00:36:55,359 --> 00:36:57,680
what the right

1046
00:36:57,680 --> 00:36:59,599
so who this turned into like a real

1047
00:36:59,599 --> 00:37:01,839
whodunit right so we

1048
00:37:01,839 --> 00:37:03,599
no one

1049
00:37:03,599 --> 00:37:05,200
no one's gonna say turla is doing

1050
00:37:05,200 --> 00:37:09,760
ransomware as a as a sponsor group like

1051
00:37:09,760 --> 00:37:12,800
they're legit enough that we're not no

1052
00:37:12,800 --> 00:37:14,640
one's saying that i'm not saying that

1053
00:37:14,640 --> 00:37:16,480
they carry out legit espionage

1054
00:37:16,480 --> 00:37:18,079
activities

1055
00:37:18,079 --> 00:37:19,760
we see overlaps from cobalt troop and

1056
00:37:19,760 --> 00:37:21,520
obviously wizard spider with the trick

1057
00:37:21,520 --> 00:37:22,400
bot

1058
00:37:22,400 --> 00:37:25,280
so why do i bring this up guys

1059
00:37:25,280 --> 00:37:27,839
well this is very relevant

1060
00:37:27,839 --> 00:37:29,920
and we need to be prepared as a

1061
00:37:29,920 --> 00:37:31,599
community for this

1062
00:37:31,599 --> 00:37:34,320
is we can see that the lines between

1063
00:37:34,320 --> 00:37:36,160
nation state and cyber criminals are

1064
00:37:36,160 --> 00:37:38,079
continuing to blur

1065
00:37:38,079 --> 00:37:39,839
like this is a thing

1066
00:37:39,839 --> 00:37:41,920
and it is a legit thing we can see that

1067
00:37:41,920 --> 00:37:43,359
and it's a two-way street right so in

1068
00:37:43,359 --> 00:37:46,880
2020 there were two chinese nationals

1069
00:37:46,880 --> 00:37:49,200
that were indicted by the department of

1070
00:37:49,200 --> 00:37:52,000
justice because they were carrying out

1071
00:37:52,000 --> 00:37:53,920
espionage activities on behalf of the

1072
00:37:53,920 --> 00:37:55,839
chinese government using chinese tooling

1073
00:37:55,839 --> 00:37:57,359
for financial gain

1074
00:37:57,359 --> 00:38:00,480
so like harvesting criminals from the

1075
00:38:00,480 --> 00:38:03,200
dark web or all these forums say hey do

1076
00:38:03,200 --> 00:38:05,839
this we'll give you some money

1077
00:38:05,839 --> 00:38:07,359
alternatively

1078
00:38:07,359 --> 00:38:08,800
what we see

1079
00:38:08,800 --> 00:38:10,079
is you can see this quote from

1080
00:38:10,079 --> 00:38:11,440
christopher wray

1081
00:38:11,440 --> 00:38:13,359
is that and the evidence is out there

1082
00:38:13,359 --> 00:38:15,359
you can google this

1083
00:38:15,359 --> 00:38:17,599
we have cyber criminals that are are

1084
00:38:17,599 --> 00:38:20,079
espionage analysts people that are doing

1085
00:38:20,079 --> 00:38:21,040
legit

1086
00:38:21,040 --> 00:38:22,560
things maybe it

1087
00:38:22,560 --> 00:38:24,880
i don't know something like turla that

1088
00:38:24,880 --> 00:38:26,400
are carrying moonlighting is cyber

1089
00:38:26,400 --> 00:38:28,079
criminals at night for their own

1090
00:38:28,079 --> 00:38:29,440
personal gain

1091
00:38:29,440 --> 00:38:31,200
using the tooling that was developed by

1092
00:38:31,200 --> 00:38:34,000
those nation states and in fact

1093
00:38:34,000 --> 00:38:35,520
what timing is almost like i planned

1094
00:38:35,520 --> 00:38:38,880
this yesterday we put out a paper

1095
00:38:38,880 --> 00:38:41,839
detailing how the trickbot group

1096
00:38:41,839 --> 00:38:45,520
is systematically attacking ukraine now

1097
00:38:45,520 --> 00:38:47,040
now if you guys have been tracking

1098
00:38:47,040 --> 00:38:48,320
ukraine

1099
00:38:48,320 --> 00:38:50,079
over the years

1100
00:38:50,079 --> 00:38:51,839
or any of the trickbot malware you'll

1101
00:38:51,839 --> 00:38:52,960
know

1102
00:38:52,960 --> 00:38:55,359
that trickbot malware is specifically

1103
00:38:55,359 --> 00:38:58,800
designed to not execute on systems

1104
00:38:58,800 --> 00:39:01,839
where the ukrainian language is detected

1105
00:39:01,839 --> 00:39:04,000
that has changed

1106
00:39:04,000 --> 00:39:07,599
so now we see that the trick bot group

1107
00:39:07,599 --> 00:39:11,520
is carrying out attacks suddenly

1108
00:39:11,520 --> 00:39:13,520
now that the russian government is

1109
00:39:13,520 --> 00:39:14,800
attacking

1110
00:39:14,800 --> 00:39:16,320
ukraine

1111
00:39:16,320 --> 00:39:18,240
what a systematic shift in behaviors

1112
00:39:18,240 --> 00:39:20,400
they said we've never seen this before

1113
00:39:20,400 --> 00:39:22,640
ever

1114
00:39:22,640 --> 00:39:25,839
we all like take take notice right

1115
00:39:25,839 --> 00:39:28,800
i've had friends who i respect a ton

1116
00:39:28,800 --> 00:39:31,520
very smart people and they've said

1117
00:39:31,520 --> 00:39:33,280
ransomware is a problem for a soft

1118
00:39:33,280 --> 00:39:38,000
target i think that's small thinking

1119
00:39:38,079 --> 00:39:40,240
because this isn't the only case where

1120
00:39:40,240 --> 00:39:42,000
we've seen custom tooling bypass your

1121
00:39:42,000 --> 00:39:44,960
edrs bypass your your avs do all the

1122
00:39:44,960 --> 00:39:48,000
things and people still get popped right

1123
00:39:48,000 --> 00:39:50,240
so we need to take this away as do do

1124
00:39:50,240 --> 00:39:53,280
that stuff buy buy the edr buy the log

1125
00:39:53,280 --> 00:39:55,280
central you know get that threat hunting

1126
00:39:55,280 --> 00:39:56,400
do those things

1127
00:39:56,400 --> 00:39:58,400
but we need to properly prepare for when

1128
00:39:58,400 --> 00:40:00,000
those things fail

1129
00:40:00,000 --> 00:40:01,760
right

1130
00:40:01,760 --> 00:40:04,400
and attribution is going to get harder

1131
00:40:04,400 --> 00:40:08,079
as these lines continue to blur

1132
00:40:08,160 --> 00:40:10,480
but does it matter does attribution

1133
00:40:10,480 --> 00:40:12,960
matter as much as it used to

1134
00:40:12,960 --> 00:40:14,079
right

1135
00:40:14,079 --> 00:40:17,520
if the if the attack's going to happen

1136
00:40:17,520 --> 00:40:19,760
all i mean if your work for a company do

1137
00:40:19,760 --> 00:40:21,839
you really care who it did

1138
00:40:21,839 --> 00:40:23,680
who did it

1139
00:40:23,680 --> 00:40:25,680
so we need to we should be starting to

1140
00:40:25,680 --> 00:40:27,839
shift our mindset away from

1141
00:40:27,839 --> 00:40:31,040
caring about too much in my opinion

1142
00:40:31,040 --> 00:40:33,200
about who did it rather than how they

1143
00:40:33,200 --> 00:40:34,400
did it

1144
00:40:34,400 --> 00:40:35,200
right

1145
00:40:35,200 --> 00:40:36,800
and that's when we go back we're talking

1146
00:40:36,800 --> 00:40:38,880
about value of data

1147
00:40:38,880 --> 00:40:41,040
and why it's so important to do things

1148
00:40:41,040 --> 00:40:44,960
in terms of analysis

1149
00:40:45,440 --> 00:40:49,359
trusting the process in terms of saying

1150
00:40:49,359 --> 00:40:50,319
collect

1151
00:40:50,319 --> 00:40:52,079
analysts and security people all like

1152
00:40:52,079 --> 00:40:53,680
they say collect all the things let me

1153
00:40:53,680 --> 00:40:56,480
let me find the stuff right

1154
00:40:56,480 --> 00:40:57,920
i'm not sure that's the right way to go

1155
00:40:57,920 --> 00:41:00,319
about it

1156
00:41:00,400 --> 00:41:03,040
and in fact we should be using security

1157
00:41:03,040 --> 00:41:04,960
op security and threat hunting and all

1158
00:41:04,960 --> 00:41:06,720
these things we're talking about we

1159
00:41:06,720 --> 00:41:09,440
should be using that to drive investment

1160
00:41:09,440 --> 00:41:11,520
we should be having these conversations

1161
00:41:11,520 --> 00:41:14,400
with our executives and we should not

1162
00:41:14,400 --> 00:41:15,839
collectively

1163
00:41:15,839 --> 00:41:18,160
forget the opportunity that is presented

1164
00:41:18,160 --> 00:41:21,760
to us from ransomware we may never have

1165
00:41:21,760 --> 00:41:24,240
a chance to implement the stuff people

1166
00:41:24,240 --> 00:41:26,000
have been talking about for 20 years

1167
00:41:26,000 --> 00:41:27,920
getting rid of admin rights right

1168
00:41:27,920 --> 00:41:29,599
network segmentation

1169
00:41:29,599 --> 00:41:32,400
you guys seen the zero trust stuff

1170
00:41:32,400 --> 00:41:33,599
we've we've been talking about this for

1171
00:41:33,599 --> 00:41:34,880
years but we've never had this

1172
00:41:34,880 --> 00:41:36,720
opportunity to tell you right now

1173
00:41:36,720 --> 00:41:39,280
there's not a ceo on earth that is not

1174
00:41:39,280 --> 00:41:41,440
scared about ransomware so we have to

1175
00:41:41,440 --> 00:41:44,160
understand the opportunity to do the

1176
00:41:44,160 --> 00:41:45,920
things that i'm talking about you know

1177
00:41:45,920 --> 00:41:48,079
build those detections really work with

1178
00:41:48,079 --> 00:41:50,240
an ir team to fundamentally understand

1179
00:41:50,240 --> 00:41:53,119
the goals and objectives of an adversary

1180
00:41:53,119 --> 00:41:54,640
and with that

1181
00:41:54,640 --> 00:41:56,319
i really think

1182
00:41:56,319 --> 00:41:58,720
that we can make a change to how we do

1183
00:41:58,720 --> 00:42:01,200
computing globally

1184
00:42:01,200 --> 00:42:03,680
so i hope you guys liked it it was a

1185
00:42:03,680 --> 00:42:04,960
cool ir

1186
00:42:04,960 --> 00:42:06,720
and i can take any questions if you want

1187
00:42:06,720 --> 00:42:08,240
or if you just want to chat

1188
00:42:08,240 --> 00:42:11,280
happy to happy to do it thanks

1189
00:42:11,280 --> 00:42:15,229
[Applause]

