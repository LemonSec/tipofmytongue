1
00:00:00,799 --> 00:00:02,879
i'm gonna turn the mic over to our

2
00:00:02,879 --> 00:00:06,080
speaker justin

3
00:00:07,520 --> 00:00:09,280
thank you kat

4
00:00:09,280 --> 00:00:11,519
and thank you everyone for being here

5
00:00:11,519 --> 00:00:13,519
i'm really excited to

6
00:00:13,519 --> 00:00:15,040
deliver this talk

7
00:00:15,040 --> 00:00:18,880
last month i gave this talk at rva sec

8
00:00:18,880 --> 00:00:20,800
and it was really well received and we

9
00:00:20,800 --> 00:00:22,800
had a lot of fun and we're also going to

10
00:00:22,800 --> 00:00:24,720
have a lot of fun today

11
00:00:24,720 --> 00:00:26,560
so my talk is called

12
00:00:26,560 --> 00:00:28,240
honeypot booboo

13
00:00:28,240 --> 00:00:30,400
better breach detection with deception

14
00:00:30,400 --> 00:00:31,599
inception

15
00:00:31,599 --> 00:00:34,320
because it's fun to be wordsmithing

16
00:00:34,320 --> 00:00:35,440
uh

17
00:00:35,440 --> 00:00:37,440
so a little bit about myself

18
00:00:37,440 --> 00:00:38,399
i'm a

19
00:00:38,399 --> 00:00:40,239
authorized partner with things canary i

20
00:00:40,239 --> 00:00:42,239
don't actually work at things canary

21
00:00:42,239 --> 00:00:44,399
but i've worked with them for

22
00:00:44,399 --> 00:00:45,760
several years

23
00:00:45,760 --> 00:00:48,719
and collaborated and i'm very passionate

24
00:00:48,719 --> 00:00:49,600
about

25
00:00:49,600 --> 00:00:51,199
their product and platform because i've

26
00:00:51,199 --> 00:00:52,960
personally seen it

27
00:00:52,960 --> 00:00:55,920
prevent three catastrophic breaches trip

28
00:00:55,920 --> 00:00:58,640
up some of the most elite red teams

29
00:00:58,640 --> 00:01:01,120
in in the world and have pen tests fail

30
00:01:01,120 --> 00:01:02,480
within eight minutes

31
00:01:02,480 --> 00:01:03,359
and

32
00:01:03,359 --> 00:01:06,080
easy cheap effective stuff

33
00:01:06,080 --> 00:01:07,840
and so today i'm gonna

34
00:01:07,840 --> 00:01:10,479
give you an overview of

35
00:01:10,479 --> 00:01:12,320
what we're doing now as far as breach

36
00:01:12,320 --> 00:01:14,799
detection why it's not working

37
00:01:14,799 --> 00:01:17,920
and some ideas for what we may try

38
00:01:17,920 --> 00:01:18,799
to

39
00:01:18,799 --> 00:01:21,119
do better moving forward and also walk

40
00:01:21,119 --> 00:01:23,759
you through various deployment scenarios

41
00:01:23,759 --> 00:01:26,720
for different types of canary tokens

42
00:01:26,720 --> 00:01:29,600
and honey pots and with that

43
00:01:29,600 --> 00:01:32,479
let's kick things off

44
00:01:33,040 --> 00:01:35,280
so

45
00:01:35,759 --> 00:01:37,360
for

46
00:01:37,360 --> 00:01:38,799
starters we need to talk about what's a

47
00:01:38,799 --> 00:01:41,680
honey trap or honey a honey trap can be

48
00:01:41,680 --> 00:01:42,880
a honey pot

49
00:01:42,880 --> 00:01:45,040
or a honey token and

50
00:01:45,040 --> 00:01:46,960
a honey pot

51
00:01:46,960 --> 00:01:48,320
is

52
00:01:48,320 --> 00:01:51,520
a device that's designed to

53
00:01:51,520 --> 00:01:54,240
look like a real service and a real

54
00:01:54,240 --> 00:01:56,159
system that's running attractive

55
00:01:56,159 --> 00:01:59,119
services and you have tokens which are

56
00:01:59,119 --> 00:02:00,560
digital trip wires that can be

57
00:02:00,560 --> 00:02:04,719
manifested as google docs aws keys slack

58
00:02:04,719 --> 00:02:06,159
tokens you name it

59
00:02:06,159 --> 00:02:09,199
both of these mechanisms represent

60
00:02:09,199 --> 00:02:10,639
the larger discipline of deception

61
00:02:10,639 --> 00:02:13,440
technology and this is really fun

62
00:02:13,440 --> 00:02:15,920
because the more creative you are

63
00:02:15,920 --> 00:02:18,720
the more likely you'll be able to thwart

64
00:02:18,720 --> 00:02:20,640
your adversary and

65
00:02:20,640 --> 00:02:22,480
at some point you're going to have

66
00:02:22,480 --> 00:02:25,120
a situation of psychological warfare

67
00:02:25,120 --> 00:02:26,480
where you're going to get them to

68
00:02:26,480 --> 00:02:28,640
question their sanity and we'll get to

69
00:02:28,640 --> 00:02:30,319
that here in a bit

70
00:02:30,319 --> 00:02:32,080
the reason we need something new is

71
00:02:32,080 --> 00:02:34,400
because it takes entirely too long to

72
00:02:34,400 --> 00:02:35,760
detect breaches

73
00:02:35,760 --> 00:02:37,519
it's costing more and more money every

74
00:02:37,519 --> 00:02:39,920
year and exponentially breaches continue

75
00:02:39,920 --> 00:02:41,040
happening

76
00:02:41,040 --> 00:02:43,680
so we also have tons of burnout you know

77
00:02:43,680 --> 00:02:46,080
our the security community is in dire

78
00:02:46,080 --> 00:02:48,400
need of people millions of jobs

79
00:02:48,400 --> 00:02:50,319
depending on what report you read you

80
00:02:50,319 --> 00:02:51,920
have burnout

81
00:02:51,920 --> 00:02:55,120
um you have disaffection and

82
00:02:55,120 --> 00:02:56,720
there's better ways that we need to be

83
00:02:56,720 --> 00:02:58,239
looking at this to help help our

84
00:02:58,239 --> 00:02:59,760
security professionals

85
00:02:59,760 --> 00:03:01,200
and most importantly if you do get

86
00:03:01,200 --> 00:03:02,640
breach because you will it's not a

87
00:03:02,640 --> 00:03:04,720
matter of if it's when the idea is you

88
00:03:04,720 --> 00:03:06,159
want to mitigate the blast radius

89
00:03:06,159 --> 00:03:07,599
because you want to know exactly at that

90
00:03:07,599 --> 00:03:09,360
point that you've been breached and not

91
00:03:09,360 --> 00:03:12,560
212 days later

92
00:03:12,640 --> 00:03:13,760
so

93
00:03:13,760 --> 00:03:15,360
some of you probably know

94
00:03:15,360 --> 00:03:17,200
the pyramid of pain

95
00:03:17,200 --> 00:03:19,120
and laundry room viking

96
00:03:19,120 --> 00:03:20,720
you know for the analysts out there this

97
00:03:20,720 --> 00:03:23,120
might be so

98
00:03:23,120 --> 00:03:25,760
so true it hurts but

99
00:03:25,760 --> 00:03:27,040
you know

100
00:03:27,040 --> 00:03:28,720
the idea is early on you know as an

101
00:03:28,720 --> 00:03:31,680
analyst maybe you work 100 hours a week

102
00:03:31,680 --> 00:03:33,440
and you're not going to go to bed

103
00:03:33,440 --> 00:03:36,080
so you just triage tickets instead and

104
00:03:36,080 --> 00:03:38,000
you might get ahead for the time being

105
00:03:38,000 --> 00:03:41,360
but you'll soon end up dead so

106
00:03:41,360 --> 00:03:42,720
in other words we need to help our

107
00:03:42,720 --> 00:03:44,080
analysts because

108
00:03:44,080 --> 00:03:45,519
it's really hard and i have a lot of

109
00:03:45,519 --> 00:03:48,080
respect for people but

110
00:03:48,080 --> 00:03:50,000
a lot of the time they're spending a lot

111
00:03:50,000 --> 00:03:53,200
of their uh cycles on false positives

112
00:03:53,200 --> 00:03:54,159
and

113
00:03:54,159 --> 00:03:55,120
you know

114
00:03:55,120 --> 00:03:57,680
alerts that don't have any fidelity so i

115
00:03:57,680 --> 00:03:58,840
feel for

116
00:03:58,840 --> 00:04:01,840
them and really like why deception

117
00:04:01,840 --> 00:04:03,840
technology of all things i do believe

118
00:04:03,840 --> 00:04:06,400
this is the year the inflection point

119
00:04:06,400 --> 00:04:08,159
when deception technology really has

120
00:04:08,159 --> 00:04:11,040
started to take off because people

121
00:04:11,040 --> 00:04:13,439
need a new way of thinking about this

122
00:04:13,439 --> 00:04:14,799
and you've just looked back over the

123
00:04:14,799 --> 00:04:17,440
last decade at some of the largest

124
00:04:17,440 --> 00:04:19,358
breaches

125
00:04:19,358 --> 00:04:21,680
you know going back to 2013 with snowden

126
00:04:21,680 --> 00:04:23,520
and he had the most sophisticated spying

127
00:04:23,520 --> 00:04:24,800
agency and

128
00:04:24,800 --> 00:04:26,880
security organization in the world and

129
00:04:26,880 --> 00:04:29,280
snowden just rummaged around for

130
00:04:29,280 --> 00:04:31,600
long periods of time exfiltrated data

131
00:04:31,600 --> 00:04:33,360
and they were none the wiser

132
00:04:33,360 --> 00:04:35,919
you go back to solarwinds we all have

133
00:04:35,919 --> 00:04:38,400
ptsd in the supply chain at this point

134
00:04:38,400 --> 00:04:40,800
everything is about third party risk and

135
00:04:40,800 --> 00:04:42,400
trying to mitigate that

136
00:04:42,400 --> 00:04:44,400
you know the effects are still being

137
00:04:44,400 --> 00:04:46,240
you know felt today

138
00:04:46,240 --> 00:04:47,680
and then you've got a credit score which

139
00:04:47,680 --> 00:04:50,000
is every adult here you know you were

140
00:04:50,000 --> 00:04:52,240
affected by the equifax breach

141
00:04:52,240 --> 00:04:53,360
and

142
00:04:53,360 --> 00:04:54,400
now you

143
00:04:54,400 --> 00:04:57,680
get credit monitoring and

144
00:04:57,680 --> 00:04:59,040
freeze your credit

145
00:04:59,040 --> 00:05:00,160
all of these things you have this

146
00:05:00,160 --> 00:05:02,400
synthetic identity theft problem that's

147
00:05:02,400 --> 00:05:03,840
been popping up

148
00:05:03,840 --> 00:05:06,000
and at this point it's like every other

149
00:05:06,000 --> 00:05:08,240
day there's some kind of breach and the

150
00:05:08,240 --> 00:05:09,840
worst part is things are converging now

151
00:05:09,840 --> 00:05:11,280
into the physical world

152
00:05:11,280 --> 00:05:12,080
um

153
00:05:12,080 --> 00:05:14,320
so we need to do something to

154
00:05:14,320 --> 00:05:16,639
to stop the septa pain

155
00:05:16,639 --> 00:05:18,240
so if any of you remember

156
00:05:18,240 --> 00:05:21,120
jimmy mcmillan from 2012

157
00:05:21,120 --> 00:05:22,960
he ran on a platform about the rent

158
00:05:22,960 --> 00:05:25,120
being too high and he was definitely

159
00:05:25,120 --> 00:05:26,000
right

160
00:05:26,000 --> 00:05:28,479
but the cost of cyber crime is is also

161
00:05:28,479 --> 00:05:30,000
way too high

162
00:05:30,000 --> 00:05:30,960
you know

163
00:05:30,960 --> 00:05:32,320
2021

164
00:05:32,320 --> 00:05:33,919
costs about 6 trillion dollars to the

165
00:05:33,919 --> 00:05:35,360
global economy

166
00:05:35,360 --> 00:05:36,840
the prediction is in

167
00:05:36,840 --> 00:05:40,479
2025 it'd be about 10.5 trillion

168
00:05:40,479 --> 00:05:42,960
roughly every 39 seconds a new business

169
00:05:42,960 --> 00:05:44,000
is breached

170
00:05:44,000 --> 00:05:45,680
fbi last year

171
00:05:45,680 --> 00:05:49,680
had 847 000 cyber complaints

172
00:05:49,680 --> 00:05:50,880
but i'm here

173
00:05:50,880 --> 00:05:53,680
to give you some hope and hopefully a

174
00:05:53,680 --> 00:05:55,440
solution on how we can

175
00:05:55,440 --> 00:05:57,680
fix this

176
00:05:57,680 --> 00:06:00,479
if you look back at some of the largest

177
00:06:00,479 --> 00:06:02,080
breaches as far as the number of records

178
00:06:02,080 --> 00:06:03,280
go

179
00:06:03,280 --> 00:06:05,199
you know it took 212 days on average

180
00:06:05,199 --> 00:06:07,600
based on the ibm report to even know

181
00:06:07,600 --> 00:06:09,440
that a company's been reached that's

182
00:06:09,440 --> 00:06:11,360
entirely too long by then they've run

183
00:06:11,360 --> 00:06:12,639
off with the crown jewels and they've

184
00:06:12,639 --> 00:06:14,720
done everything they need to do

185
00:06:14,720 --> 00:06:16,479
so if you look at cam4 what's

186
00:06:16,479 --> 00:06:18,479
interesting about that service it's a

187
00:06:18,479 --> 00:06:21,680
naughty webcam site but 10.88 billion

188
00:06:21,680 --> 00:06:24,240
accounts there's only 7 billion people

189
00:06:24,240 --> 00:06:25,759
obviously people had multiple accounts

190
00:06:25,759 --> 00:06:27,120
because they probably didn't want to

191
00:06:27,120 --> 00:06:29,199
reveal that they were on this site but

192
00:06:29,199 --> 00:06:31,440
yahoo got breached multiple times you

193
00:06:31,440 --> 00:06:34,319
know yahoo sports yahoo fantasy 3

194
00:06:34,319 --> 00:06:35,280
billion

195
00:06:35,280 --> 00:06:38,639
and in india in think 2017 this was

196
00:06:38,639 --> 00:06:40,960
their government id program

197
00:06:40,960 --> 00:06:41,759
that

198
00:06:41,759 --> 00:06:42,800
was

199
00:06:42,800 --> 00:06:44,880
had you know lofty expectations but was

200
00:06:44,880 --> 00:06:46,639
a epic failure because every single

201
00:06:46,639 --> 00:06:49,759
citizen of india had their data

202
00:06:49,759 --> 00:06:52,960
leaked and the worst part was 401k was

203
00:06:52,960 --> 00:06:55,120
tied to their social security to their

204
00:06:55,120 --> 00:06:57,599
bank account you know everything just in

205
00:06:57,599 --> 00:06:58,639
one

206
00:06:58,639 --> 00:07:00,960
identification system so their life is

207
00:07:00,960 --> 00:07:04,239
effectively ruined at that point

208
00:07:04,479 --> 00:07:06,560
so with that said let's talk about how

209
00:07:06,560 --> 00:07:07,919
canaries

210
00:07:07,919 --> 00:07:09,680
fit into this equation

211
00:07:09,680 --> 00:07:11,599
you know back in the day until 1986

212
00:07:11,599 --> 00:07:13,520
they'd use actual birds

213
00:07:13,520 --> 00:07:14,960
you know when they went mining as an

214
00:07:14,960 --> 00:07:16,639
early warning system

215
00:07:16,639 --> 00:07:19,199
and that's no longer cool cool but we

216
00:07:19,199 --> 00:07:21,840
can use them in our code

217
00:07:21,840 --> 00:07:24,400
and canaries they come in two

218
00:07:24,400 --> 00:07:26,160
forms you've got honey pots which are

219
00:07:26,160 --> 00:07:27,440
known as birds

220
00:07:27,440 --> 00:07:28,800
and you got

221
00:07:28,800 --> 00:07:31,199
honey tokens which are canary tokens

222
00:07:31,199 --> 00:07:33,199
and birds can

223
00:07:33,199 --> 00:07:35,759
birds manifest as real devices you can

224
00:07:35,759 --> 00:07:38,400
have a scada system a smart coffee

225
00:07:38,400 --> 00:07:40,400
machine a dumb terminal

226
00:07:40,400 --> 00:07:42,560
database server and these things are so

227
00:07:42,560 --> 00:07:44,479
real you'd be hard-pressed to tell

228
00:07:44,479 --> 00:07:46,879
anyone that this isn't an actual device

229
00:07:46,879 --> 00:07:48,400
and i'll show you

230
00:07:48,400 --> 00:07:50,560
uh what just how convincing this looks

231
00:07:50,560 --> 00:07:52,319
here soon and then you've got canary

232
00:07:52,319 --> 00:07:54,720
tokens and this is where

233
00:07:54,720 --> 00:07:57,199
the creativity is your only limitation

234
00:07:57,199 --> 00:07:59,120
because you can literally token anything

235
00:07:59,120 --> 00:08:02,000
you can take a piece of data text file

236
00:08:02,000 --> 00:08:03,599
dns record

237
00:08:03,599 --> 00:08:05,199
spreadsheet

238
00:08:05,199 --> 00:08:07,280
even qr codes now and i'll walk through

239
00:08:07,280 --> 00:08:08,800
each of these examples

240
00:08:08,800 --> 00:08:11,120
and the idea is you layer them

241
00:08:11,120 --> 00:08:12,400
in a sort of

242
00:08:12,400 --> 00:08:14,560
deception inception model

243
00:08:14,560 --> 00:08:15,759
which is where everything will kind of

244
00:08:15,759 --> 00:08:18,240
culminate at the end

245
00:08:18,240 --> 00:08:19,440
and you end up essentially creating a

246
00:08:19,440 --> 00:08:21,199
minefield that's hard to avoid at some

247
00:08:21,199 --> 00:08:22,960
point an adversary is going to trip over

248
00:08:22,960 --> 00:08:24,240
something and then they're going to trip

249
00:08:24,240 --> 00:08:26,560
over something else and along the way

250
00:08:26,560 --> 00:08:27,840
we're going to gather a pretty detailed

251
00:08:27,840 --> 00:08:29,280
forensics trail

252
00:08:29,280 --> 00:08:31,360
and when it's all said and done

253
00:08:31,360 --> 00:08:32,880
we may not have all the information to

254
00:08:32,880 --> 00:08:34,880
de-anonymize them but if we provide it

255
00:08:34,880 --> 00:08:36,958
to a third-party company we've given

256
00:08:36,958 --> 00:08:38,958
them like a huge advantage and you'll

257
00:08:38,958 --> 00:08:41,838
see how this works

258
00:08:41,919 --> 00:08:43,919
so let's talk first about

259
00:08:43,919 --> 00:08:47,200
the birds the bird's word

260
00:08:47,200 --> 00:08:49,760
let's talk about from window to the lols

261
00:08:49,760 --> 00:08:51,519
i don't know if any of you remember

262
00:08:51,519 --> 00:08:54,000
microsoft bimbos it was a japanese

263
00:08:54,000 --> 00:08:56,240
computer repair shop

264
00:08:56,240 --> 00:08:58,320
that also had a modified version of

265
00:08:58,320 --> 00:09:00,399
windows xp that was really secure

266
00:09:00,399 --> 00:09:02,240
because all it had was sticky notes

267
00:09:02,240 --> 00:09:04,240
calculator and notepad so the attack

268
00:09:04,240 --> 00:09:06,800
surface was pretty small

269
00:09:06,800 --> 00:09:08,480
and you know a lot of people

270
00:09:08,480 --> 00:09:10,000
organizations that are over 10 years old

271
00:09:10,000 --> 00:09:12,480
probably use active directory and

272
00:09:12,480 --> 00:09:14,000
active directory

273
00:09:14,000 --> 00:09:16,080
runs on domain controllers and the

274
00:09:16,080 --> 00:09:17,279
reason you use this is you want to

275
00:09:17,279 --> 00:09:19,440
manage your users machines passwords

276
00:09:19,440 --> 00:09:22,160
files you name in a central location

277
00:09:22,160 --> 00:09:24,160
this is really attractive to an

278
00:09:24,160 --> 00:09:26,640
adversary if you can compromise ad

279
00:09:26,640 --> 00:09:27,920
normally you can do everything you can

280
00:09:27,920 --> 00:09:30,640
read emails log into any computer listen

281
00:09:30,640 --> 00:09:31,760
to traffic

282
00:09:31,760 --> 00:09:32,880
so of course people are going to want to

283
00:09:32,880 --> 00:09:35,200
come to this so the idea here is we

284
00:09:35,200 --> 00:09:36,560
deploy a bird

285
00:09:36,560 --> 00:09:40,000
that actually is legit not like this and

286
00:09:40,000 --> 00:09:40,880
we

287
00:09:40,880 --> 00:09:42,640
want to see what happens

288
00:09:42,640 --> 00:09:45,440
when this domain controller is

289
00:09:45,440 --> 00:09:46,880
interrogated

290
00:09:46,880 --> 00:09:48,320
and you'll see

291
00:09:48,320 --> 00:09:51,440
so for those that know nmap or don't

292
00:09:51,440 --> 00:09:53,440
it's a classic tool for service

293
00:09:53,440 --> 00:09:55,680
enumeration and port scanning so what i

294
00:09:55,680 --> 00:09:56,880
did here was

295
00:09:56,880 --> 00:09:59,360
i just ran an nmap scan with various

296
00:09:59,360 --> 00:10:01,440
ports targeting a windows domain

297
00:10:01,440 --> 00:10:03,440
controller right and if you look at each

298
00:10:03,440 --> 00:10:06,000
of the service ports you've got

299
00:10:06,000 --> 00:10:07,600
very convincing information about the

300
00:10:07,600 --> 00:10:09,920
services you know you look at port 80

301
00:10:09,920 --> 00:10:11,519
it's running windows internet

302
00:10:11,519 --> 00:10:13,440
information services in fact if you were

303
00:10:13,440 --> 00:10:16,240
to visit that ip on port 80 you'd hit an

304
00:10:16,240 --> 00:10:18,000
is page and it would even let you put

305
00:10:18,000 --> 00:10:19,600
credentials in too

306
00:10:19,600 --> 00:10:21,360
it's you know it's so hard to tell the

307
00:10:21,360 --> 00:10:23,519
difference you can customize

308
00:10:23,519 --> 00:10:25,040
the directory information if you look

309
00:10:25,040 --> 00:10:28,000
here under 88 which is kerberos

310
00:10:28,000 --> 00:10:29,920
which is used for authentication you've

311
00:10:29,920 --> 00:10:30,839
got

312
00:10:30,839 --> 00:10:33,920
realm.kdc and it says ad.thinks.com you

313
00:10:33,920 --> 00:10:35,360
can make it be

314
00:10:35,360 --> 00:10:37,600
b-sides pgh whatever you want for your

315
00:10:37,600 --> 00:10:39,440
company to make it blend in with the

316
00:10:39,440 --> 00:10:40,800
rest of your systems

317
00:10:40,800 --> 00:10:43,279
and even look at

318
00:10:43,279 --> 00:10:44,720
you know like

319
00:10:44,720 --> 00:10:46,720
microsoft sql server it's a dumb idea to

320
00:10:46,720 --> 00:10:48,000
run that on the domain controller but

321
00:10:48,000 --> 00:10:50,320
people do it all the time and even tells

322
00:10:50,320 --> 00:10:51,120
you

323
00:10:51,120 --> 00:10:53,839
what version you have and so on

324
00:10:53,839 --> 00:10:55,920
and then the moment you run this scan a

325
00:10:55,920 --> 00:10:57,680
lot of things happen

326
00:10:57,680 --> 00:10:59,839
you it lights up the christmas tree for

327
00:10:59,839 --> 00:11:01,760
you no need to do it yourself

328
00:11:01,760 --> 00:11:03,600
so on the left side

329
00:11:03,600 --> 00:11:05,279
here's a bunch of aggregated alerts that

330
00:11:05,279 --> 00:11:06,880
you're going to get not only do you get

331
00:11:06,880 --> 00:11:08,480
notified that there's port scanning

332
00:11:08,480 --> 00:11:10,720
happening but you're also going to be

333
00:11:10,720 --> 00:11:12,320
notified that somebody tried to log in

334
00:11:12,320 --> 00:11:14,640
with ftp credentials and it'll even tell

335
00:11:14,640 --> 00:11:16,640
you what username and password and they

336
00:11:16,640 --> 00:11:18,240
can try all day but there's nothing of

337
00:11:18,240 --> 00:11:19,680
value on these birds

338
00:11:19,680 --> 00:11:22,000
you even have microsoft sql

339
00:11:22,000 --> 00:11:23,600
authentication so if somebody's trying

340
00:11:23,600 --> 00:11:26,079
to log in with sasa which is common you

341
00:11:26,079 --> 00:11:28,240
know it's going to fire an alert and

342
00:11:28,240 --> 00:11:30,560
even custom service ports you know if

343
00:11:30,560 --> 00:11:32,880
they run like a telnet command or netcat

344
00:11:32,880 --> 00:11:35,040
it'll capture all this information

345
00:11:35,040 --> 00:11:36,399
on the right side

346
00:11:36,399 --> 00:11:38,800
you can see kind of more information

347
00:11:38,800 --> 00:11:41,440
you gathered the user agent so this is

348
00:11:41,440 --> 00:11:43,920
already helpful right we know now that

349
00:11:43,920 --> 00:11:46,720
whoever visited is coming in on

350
00:11:46,720 --> 00:11:49,120
we're using nmap on a windows machine

351
00:11:49,120 --> 00:11:50,240
essentially

352
00:11:50,240 --> 00:11:51,360
and

353
00:11:51,360 --> 00:11:53,360
we also know we don't have their ip yet

354
00:11:53,360 --> 00:11:55,120
but we will actually we do have the ip

355
00:11:55,120 --> 00:11:56,959
look at the there's a slack alert right

356
00:11:56,959 --> 00:11:57,839
there

357
00:11:57,839 --> 00:11:59,600
it tells you the ip

358
00:11:59,600 --> 00:12:01,279
so you can start to do some reverse geo

359
00:12:01,279 --> 00:12:03,120
location this is actually my ip in

360
00:12:03,120 --> 00:12:04,160
richmond

361
00:12:04,160 --> 00:12:04,880
and

362
00:12:04,880 --> 00:12:06,240
this is our first warning system and

363
00:12:06,240 --> 00:12:08,000
it's only going to get

364
00:12:08,000 --> 00:12:09,920
more robust with our information profile

365
00:12:09,920 --> 00:12:12,399
over time

366
00:12:12,720 --> 00:12:15,120
ted stevens he was

367
00:12:15,120 --> 00:12:16,800
he was not exactly right when he said

368
00:12:16,800 --> 00:12:19,200
the internet is a series of tubes it's

369
00:12:19,200 --> 00:12:21,440
not a big truck i mean it's not a series

370
00:12:21,440 --> 00:12:23,360
of tubes it's not a big truck it is

371
00:12:23,360 --> 00:12:24,720
mostly noise

372
00:12:24,720 --> 00:12:27,200
and specifically it's just grey noise

373
00:12:27,200 --> 00:12:28,959
and if any of you

374
00:12:28,959 --> 00:12:29,839
have

375
00:12:29,839 --> 00:12:31,279
used a service

376
00:12:31,279 --> 00:12:32,800
you know that it's

377
00:12:32,800 --> 00:12:35,200
really a great way to

378
00:12:35,200 --> 00:12:37,120
gather contextual information for birds

379
00:12:37,120 --> 00:12:39,040
that you want to deploy in a traditional

380
00:12:39,040 --> 00:12:41,839
research mode so the bird that

381
00:12:41,839 --> 00:12:44,160
previously was deployed is essentially a

382
00:12:44,160 --> 00:12:46,560
production hunting pot and this differs

383
00:12:46,560 --> 00:12:49,279
from 20 years ago when honey pots really

384
00:12:49,279 --> 00:12:51,200
just sat on the internet and listened

385
00:12:51,200 --> 00:12:53,680
for signals and there wasn't really

386
00:12:53,680 --> 00:12:55,120
anything interesting to you in

387
00:12:55,120 --> 00:12:57,920
particular but what has shifted

388
00:12:57,920 --> 00:13:00,079
is these birds that you deploy

389
00:13:00,079 --> 00:13:02,079
are in your environment normally one hop

390
00:13:02,079 --> 00:13:04,240
away from your public infrastructure and

391
00:13:04,240 --> 00:13:06,560
so they're going to only alert you when

392
00:13:06,560 --> 00:13:09,839
it's relevant but that said canary has a

393
00:13:09,839 --> 00:13:11,680
traditional um

394
00:13:11,680 --> 00:13:13,680
honey pot called the outside bird and i

395
00:13:13,680 --> 00:13:16,240
wrote like a very basic bass script on

396
00:13:16,240 --> 00:13:19,040
github that pulls in the alerts the ips

397
00:13:19,040 --> 00:13:20,480
and it runs it through grey noise and it

398
00:13:20,480 --> 00:13:21,760
gives you

399
00:13:21,760 --> 00:13:23,360
context so essentially what grey noise

400
00:13:23,360 --> 00:13:25,680
does is it says we know showdown has

401
00:13:25,680 --> 00:13:28,079
these scanners we know cloudflare has

402
00:13:28,079 --> 00:13:30,000
cdns we know all these ips we're going

403
00:13:30,000 --> 00:13:32,160
to filter them out we're going to filter

404
00:13:32,160 --> 00:13:34,079
out benign malicious and we're going to

405
00:13:34,079 --> 00:13:35,200
leave you

406
00:13:35,200 --> 00:13:37,120
you know these 4 000 ips will give you

407
00:13:37,120 --> 00:13:39,920
900 so it's a great way to automate for

408
00:13:39,920 --> 00:13:40,959
analysts

409
00:13:40,959 --> 00:13:42,959
the process of you know manually going

410
00:13:42,959 --> 00:13:45,360
through and checking all these ips free

411
00:13:45,360 --> 00:13:46,320
service

412
00:13:46,320 --> 00:13:48,000
community api highly recommend checking

413
00:13:48,000 --> 00:13:49,199
them out

414
00:13:49,199 --> 00:13:51,680
and another native integration

415
00:13:51,680 --> 00:13:54,560
karen aryan rumble goes together like

416
00:13:54,560 --> 00:13:57,760
george foreman grilled tilapia for sure

417
00:13:57,760 --> 00:13:59,680
and what there's there's a native

418
00:13:59,680 --> 00:14:01,839
integration so when you're in canary you

419
00:14:01,839 --> 00:14:03,839
can hover over the hourglass and it

420
00:14:03,839 --> 00:14:05,839
takes you directly to rumble what's neat

421
00:14:05,839 --> 00:14:06,800
here

422
00:14:06,800 --> 00:14:08,079
is rumble

423
00:14:08,079 --> 00:14:09,839
automatically builds an asset inventory

424
00:14:09,839 --> 00:14:11,519
and gives you a lot more enrichment and

425
00:14:11,519 --> 00:14:13,839
context so it tells you

426
00:14:13,839 --> 00:14:16,079
you know services location the

427
00:14:16,079 --> 00:14:18,240
autonomous system number on the internet

428
00:14:18,240 --> 00:14:20,720
um when it was seen and so you can

429
00:14:20,720 --> 00:14:23,519
determine okay did this canary token

430
00:14:23,519 --> 00:14:26,240
fire from one of my assets if if so

431
00:14:26,240 --> 00:14:27,600
i should probably look into that you

432
00:14:27,600 --> 00:14:29,600
know like this was really helpful for a

433
00:14:29,600 --> 00:14:31,760
log for shell you could start gathering

434
00:14:31,760 --> 00:14:34,000
information on public ips and if

435
00:14:34,000 --> 00:14:36,560
machines were communicating you know to

436
00:14:36,560 --> 00:14:39,199
c2 servers and surreptitiously

437
00:14:39,199 --> 00:14:40,480
you'd probably

438
00:14:40,480 --> 00:14:42,480
you know need to investigate that

439
00:14:42,480 --> 00:14:46,079
another free awesome tool hd moore who

440
00:14:46,079 --> 00:14:48,639
wrote metasploit um this is his company

441
00:14:48,639 --> 00:14:50,399
it's awesome highly recommend checking

442
00:14:50,399 --> 00:14:52,240
it out

443
00:14:52,240 --> 00:14:54,000
okay

444
00:14:54,000 --> 00:14:55,519
with birds

445
00:14:55,519 --> 00:14:56,800
taken care of

446
00:14:56,800 --> 00:14:59,199
let's talk about the tokens and the

447
00:14:59,199 --> 00:15:01,760
tokens all the way down

448
00:15:01,760 --> 00:15:03,760
and we're going to start with

449
00:15:03,760 --> 00:15:06,000
chris farley and black sheep and recon

450
00:15:06,000 --> 00:15:08,480
tokens

451
00:15:08,800 --> 00:15:10,160
these are

452
00:15:10,160 --> 00:15:12,000
going to be tokens that people use

453
00:15:12,000 --> 00:15:13,360
before they even have access to your

454
00:15:13,360 --> 00:15:15,920
network and there's ways that you can

455
00:15:15,920 --> 00:15:17,680
gather information on them

456
00:15:17,680 --> 00:15:19,040
to figure out what they may be wanting

457
00:15:19,040 --> 00:15:20,880
to do and why they're targeting you

458
00:15:20,880 --> 00:15:22,959
so one of the first tokens

459
00:15:22,959 --> 00:15:24,160
we can use

460
00:15:24,160 --> 00:15:25,440
is a

461
00:15:25,440 --> 00:15:27,920
domain name system token

462
00:15:27,920 --> 00:15:30,320
and the reason domain name system exists

463
00:15:30,320 --> 00:15:32,160
is because most people aren't weirdos

464
00:15:32,160 --> 00:15:34,399
and like me that memorize ip addresses

465
00:15:34,399 --> 00:15:35,839
you want to type in

466
00:15:35,839 --> 00:15:38,800
you know b-sides pgh behind the scenes

467
00:15:38,800 --> 00:15:40,320
you've got an internet protocol address

468
00:15:40,320 --> 00:15:41,519
that's where

469
00:15:41,519 --> 00:15:43,279
you know you know how to route traffic

470
00:15:43,279 --> 00:15:44,560
on the internet

471
00:15:44,560 --> 00:15:45,440
um

472
00:15:45,440 --> 00:15:46,880
the way that we can use these tokens

473
00:15:46,880 --> 00:15:48,480
really effectively

474
00:15:48,480 --> 00:15:52,000
is we can create dns entries and map

475
00:15:52,000 --> 00:15:54,880
them to unused or dark network segments

476
00:15:54,880 --> 00:15:56,560
so you can create entire

477
00:15:56,560 --> 00:15:58,959
virtual lens that should never be used

478
00:15:58,959 --> 00:16:00,880
and you can have dns pointing there so

479
00:16:00,880 --> 00:16:02,160
if somebody is

480
00:16:02,160 --> 00:16:04,000
enumerating those network segments it's

481
00:16:04,000 --> 00:16:05,600
going to fire this token and you're

482
00:16:05,600 --> 00:16:07,279
going to know snoop dogs in the building

483
00:16:07,279 --> 00:16:08,560
snooping around

484
00:16:08,560 --> 00:16:11,120
and when this token fires

485
00:16:11,120 --> 00:16:12,720
it doesn't tell you

486
00:16:12,720 --> 00:16:15,360
the ip of the host it tells you the ip

487
00:16:15,360 --> 00:16:18,240
of the dns server but even with that it

488
00:16:18,240 --> 00:16:20,079
was able to determine that i was coming

489
00:16:20,079 --> 00:16:22,639
from richmond virginia where i live and

490
00:16:22,639 --> 00:16:24,560
i was using cloudflare their one one one

491
00:16:24,560 --> 00:16:25,839
two

492
00:16:25,839 --> 00:16:28,240
dns server in particular so this is like

493
00:16:28,240 --> 00:16:29,279
a great

494
00:16:29,279 --> 00:16:31,839
initial token just to alert you that

495
00:16:31,839 --> 00:16:33,759
people are mucking around

496
00:16:33,759 --> 00:16:35,519
and trying to do reconnaissance

497
00:16:35,519 --> 00:16:38,399
so this is really helpful

498
00:16:38,399 --> 00:16:40,480
and if we continue along that path

499
00:16:40,480 --> 00:16:42,959
one of my favorite tokens is called a

500
00:16:42,959 --> 00:16:44,800
web redirect

501
00:16:44,800 --> 00:16:46,720
and you can get so much information from

502
00:16:46,720 --> 00:16:50,480
nozi o'donnell just by having them visit

503
00:16:50,480 --> 00:16:53,440
a site so there's a doppelganger domain

504
00:16:53,440 --> 00:16:55,120
that i bought and transferred to canary

505
00:16:55,120 --> 00:16:57,199
called thinks that io

506
00:16:57,199 --> 00:16:59,680
and when you would hit things that i o

507
00:16:59,680 --> 00:17:00,720
it would

508
00:17:00,720 --> 00:17:02,480
quickly redirect you and when you

509
00:17:02,480 --> 00:17:03,920
actually buy the service it doesn't say

510
00:17:03,920 --> 00:17:06,640
canarytokens.com it uses your own domain

511
00:17:06,640 --> 00:17:09,439
so that it looks legitimate but

512
00:17:09,439 --> 00:17:10,559
you know it sends you there then it

513
00:17:10,559 --> 00:17:13,039
redirects you to b sides

514
00:17:13,039 --> 00:17:15,119
and in the process it grabs tons

515
00:17:15,119 --> 00:17:17,599
information it grabs your browser user

516
00:17:17,599 --> 00:17:20,880
agent ip if you have javascript

517
00:17:20,880 --> 00:17:23,199
windows you know after a while

518
00:17:23,199 --> 00:17:24,959
you can start to

519
00:17:24,959 --> 00:17:27,359
you know shrink the pool of potential

520
00:17:27,359 --> 00:17:29,440
people this may be so like

521
00:17:29,440 --> 00:17:31,520
hardware surveys get captured all the

522
00:17:31,520 --> 00:17:33,520
time if you use steam for video games

523
00:17:33,520 --> 00:17:34,799
they always ask you send your hardware

524
00:17:34,799 --> 00:17:36,480
specs microsoft asks you to send your

525
00:17:36,480 --> 00:17:38,480
hardware specs so

526
00:17:38,480 --> 00:17:40,160
there's a good understanding of how many

527
00:17:40,160 --> 00:17:41,760
windows computers might exist here in

528
00:17:41,760 --> 00:17:43,600
pittsburgh and then how many people use

529
00:17:43,600 --> 00:17:45,280
firefox and you can see how you can

530
00:17:45,280 --> 00:17:47,919
start to de-anonymize and

531
00:17:47,919 --> 00:17:48,960
have a

532
00:17:48,960 --> 00:17:51,120
more targeted forensic pool

533
00:17:51,120 --> 00:17:53,200
than if you just try to cast a wide net

534
00:17:53,200 --> 00:17:54,960
so this is where we're starting to build

535
00:17:54,960 --> 00:17:56,320
the trail

536
00:17:56,320 --> 00:17:58,080
until we get to the end

537
00:17:58,080 --> 00:17:58,960
and

538
00:17:58,960 --> 00:18:01,840
that's when things get real

539
00:18:02,000 --> 00:18:03,360
okay

540
00:18:03,360 --> 00:18:06,719
downey dodgeball fans out there

541
00:18:07,120 --> 00:18:09,120
there's a token here called

542
00:18:09,120 --> 00:18:11,840
a clone website token this is actually

543
00:18:11,840 --> 00:18:14,720
incredibly helpful for knowing when

544
00:18:14,720 --> 00:18:16,720
people are trying to impersonate your

545
00:18:16,720 --> 00:18:18,000
your company or they're trying to start

546
00:18:18,000 --> 00:18:19,919
a phishing campaign so i've actually

547
00:18:19,919 --> 00:18:21,280
seen this token

548
00:18:21,280 --> 00:18:23,360
be effective in

549
00:18:23,360 --> 00:18:25,039
allowing for a cease and desist of

550
00:18:25,039 --> 00:18:27,679
domains you know like you get notified

551
00:18:27,679 --> 00:18:29,840
hey somebody's deployed this contact the

552
00:18:29,840 --> 00:18:31,760
registrar and you send them a scary

553
00:18:31,760 --> 00:18:33,840
letter with your legal team nine times

554
00:18:33,840 --> 00:18:36,480
out of ten they're going to tear this

555
00:18:36,480 --> 00:18:38,799
domain down and kind of give up on their

556
00:18:38,799 --> 00:18:39,840
campaign

557
00:18:39,840 --> 00:18:41,440
this is really helpful all you do is you

558
00:18:41,440 --> 00:18:43,919
create the token it gives you five lines

559
00:18:43,919 --> 00:18:45,600
of javascript you don't need to be

560
00:18:45,600 --> 00:18:47,600
technical just embed it in your html

561
00:18:47,600 --> 00:18:48,640
pages

562
00:18:48,640 --> 00:18:50,640
and then if the client redeploy it

563
00:18:50,640 --> 00:18:54,000
anywhere fires an alert get the ip

564
00:18:54,000 --> 00:18:54,960
you get

565
00:18:54,960 --> 00:18:56,799
you know some basic headers

566
00:18:56,799 --> 00:18:58,080
and

567
00:18:58,080 --> 00:18:58,880
yeah

568
00:18:58,880 --> 00:18:59,760
this

569
00:18:59,760 --> 00:19:02,480
this is good information

570
00:19:02,480 --> 00:19:03,679
bert macklin

571
00:19:03,679 --> 00:19:04,960
is on the job

572
00:19:04,960 --> 00:19:06,480
apis

573
00:19:06,480 --> 00:19:09,440
alert protect investigate or application

574
00:19:09,440 --> 00:19:10,720
programming interface but now we're

575
00:19:10,720 --> 00:19:11,919
going to talk about

576
00:19:11,919 --> 00:19:14,320
api specific tokens and how great they

577
00:19:14,320 --> 00:19:15,840
are

578
00:19:15,840 --> 00:19:17,919
starting with

579
00:19:17,919 --> 00:19:20,960
the the cloud the aws

580
00:19:20,960 --> 00:19:22,160
so

581
00:19:22,160 --> 00:19:24,559
probably my favorite token is the aws

582
00:19:24,559 --> 00:19:26,799
amazon web service api key

583
00:19:26,799 --> 00:19:29,120
this looks just like a pair of normal

584
00:19:29,120 --> 00:19:30,480
credentials

585
00:19:30,480 --> 00:19:32,160
but when you use them you can't do

586
00:19:32,160 --> 00:19:33,120
anything

587
00:19:33,120 --> 00:19:35,280
but you also don't know that they're

588
00:19:35,280 --> 00:19:37,280
they're not permission you can though

589
00:19:37,280 --> 00:19:38,400
actually

590
00:19:38,400 --> 00:19:39,919
lead people down a path and you can

591
00:19:39,919 --> 00:19:42,480
provision credentials that have access

592
00:19:42,480 --> 00:19:44,240
fake access to an account

593
00:19:44,240 --> 00:19:45,679
and then you can continue to allow them

594
00:19:45,679 --> 00:19:46,960
to do things

595
00:19:46,960 --> 00:19:48,960
so that you gather more information but

596
00:19:48,960 --> 00:19:51,600
in general these have no permissions

597
00:19:51,600 --> 00:19:52,640
but

598
00:19:52,640 --> 00:19:54,320
when they use these keys

599
00:19:54,320 --> 00:19:56,240
it starts to get even more information

600
00:19:56,240 --> 00:19:57,840
it'll start to tell you

601
00:19:57,840 --> 00:19:59,840
the commands that they run if they hit

602
00:19:59,840 --> 00:20:01,440
any of the buckets it'll tell you the

603
00:20:01,440 --> 00:20:03,440
operation that happens

604
00:20:03,440 --> 00:20:05,600
and what's really cool on the left

605
00:20:05,600 --> 00:20:07,600
is it builds this incident map and this

606
00:20:07,600 --> 00:20:09,440
is on the free

607
00:20:09,440 --> 00:20:11,679
think site canarytokens.org

608
00:20:11,679 --> 00:20:13,840
so one thing to mention is you know you

609
00:20:13,840 --> 00:20:16,480
can spend like five grand a year which

610
00:20:16,480 --> 00:20:18,559
is the best bang for the buck and get a

611
00:20:18,559 --> 00:20:20,480
hosted console or you can do this

612
00:20:20,480 --> 00:20:22,480
yourself for free and you can generate

613
00:20:22,480 --> 00:20:26,480
tokens galore and when you do

614
00:20:26,480 --> 00:20:28,080
it tells you everywhere geographically

615
00:20:28,080 --> 00:20:30,240
that this key is used the idea here is

616
00:20:30,240 --> 00:20:31,120
like

617
00:20:31,120 --> 00:20:32,960
you can automate deployment using

618
00:20:32,960 --> 00:20:34,880
something like jam for intune you can

619
00:20:34,880 --> 00:20:36,960
put it on every single machine

620
00:20:36,960 --> 00:20:38,960
and if marketing all of a sudden fires

621
00:20:38,960 --> 00:20:39,919
an alert

622
00:20:39,919 --> 00:20:42,240
you probably have a good indication well

623
00:20:42,240 --> 00:20:44,000
their machine's been compromised but

624
00:20:44,000 --> 00:20:45,919
what a lot of bad actors will do

625
00:20:45,919 --> 00:20:47,280
is they're not going to run it on that

626
00:20:47,280 --> 00:20:48,720
machine they're going to grab the keys

627
00:20:48,720 --> 00:20:50,799
and use it and in the process continue

628
00:20:50,799 --> 00:20:52,400
to de-anonymize themselves because it's

629
00:20:52,400 --> 00:20:53,840
grabbing the ip

630
00:20:53,840 --> 00:20:56,320
grabbing the particular user agent like

631
00:20:56,320 --> 00:20:58,000
did they use

632
00:20:58,000 --> 00:21:00,480
photo 3 you know python or did they use

633
00:21:00,480 --> 00:21:03,120
some other sdk so you're just continuing

634
00:21:03,120 --> 00:21:05,280
to grab more and more information and

635
00:21:05,280 --> 00:21:08,000
build this forensics trail

636
00:21:08,000 --> 00:21:09,200
you know why you're deceiving them and

637
00:21:09,200 --> 00:21:12,080
leading them along the path

638
00:21:12,799 --> 00:21:15,600
yeah and speaking of bang for the bucket

639
00:21:15,600 --> 00:21:16,960
this is where you can start to really

640
00:21:16,960 --> 00:21:18,400
layer things in

641
00:21:18,400 --> 00:21:20,960
so with amazon web services

642
00:21:20,960 --> 00:21:22,480
you know you've got these simple storage

643
00:21:22,480 --> 00:21:24,880
service buckets and over the years these

644
00:21:24,880 --> 00:21:27,200
things have been prone left and right

645
00:21:27,200 --> 00:21:29,200
you know you've had people accidentally

646
00:21:29,200 --> 00:21:31,760
storing credit card information personal

647
00:21:31,760 --> 00:21:34,240
health info on these buckets

648
00:21:34,240 --> 00:21:37,120
and security was optional with aws you

649
00:21:37,120 --> 00:21:38,960
know for initially you know your bucket

650
00:21:38,960 --> 00:21:40,480
policies weren't

651
00:21:40,480 --> 00:21:42,320
strict by default it would a lot of

652
00:21:42,320 --> 00:21:43,840
times it'd just be world writable and

653
00:21:43,840 --> 00:21:46,240
anonymous and people didn't realize that

654
00:21:46,240 --> 00:21:48,400
they were putting sensitive information

655
00:21:48,400 --> 00:21:50,159
and so given the nature of this zero

656
00:21:50,159 --> 00:21:51,679
trust world we live in

657
00:21:51,679 --> 00:21:53,840
you know companies will get breach

658
00:21:53,840 --> 00:21:56,960
it's just a matter of when and how badly

659
00:21:56,960 --> 00:21:58,880
we know this is a fact this is the only

660
00:21:58,880 --> 00:22:01,039
sensible way to operate in our modern

661
00:22:01,039 --> 00:22:01,919
world

662
00:22:01,919 --> 00:22:04,080
so we just have to make sure

663
00:22:04,080 --> 00:22:05,600
when our preventative controls fail and

664
00:22:05,600 --> 00:22:07,520
they will we have the ability to detect

665
00:22:07,520 --> 00:22:08,559
things

666
00:22:08,559 --> 00:22:11,360
immediately so all you need to do is

667
00:22:11,360 --> 00:22:13,520
create a bucket you can name it

668
00:22:13,520 --> 00:22:15,600
something that blends into your existing

669
00:22:15,600 --> 00:22:18,880
buckets and the mere act of just listing

670
00:22:18,880 --> 00:22:21,120
an account will fire an alert

671
00:22:21,120 --> 00:22:23,600
and you can tie this in with the aws

672
00:22:23,600 --> 00:22:26,000
keys and you can give them permissions

673
00:22:26,000 --> 00:22:29,679
into a bogus account with s3 buckets and

674
00:22:29,679 --> 00:22:31,120
you can have them spin their wheels and

675
00:22:31,120 --> 00:22:32,400
think that they're

676
00:22:32,400 --> 00:22:33,840
doing something

677
00:22:33,840 --> 00:22:35,919
that's valuable but it's really not

678
00:22:35,919 --> 00:22:37,919
and so in the process you go through you

679
00:22:37,919 --> 00:22:39,600
get more information on the user agent

680
00:22:39,600 --> 00:22:41,039
you know we learned here looks like

681
00:22:41,039 --> 00:22:42,000
they're

682
00:22:42,000 --> 00:22:45,520
on linux and they're running boto sdk in

683
00:22:45,520 --> 00:22:48,400
java even tells you here on the right

684
00:22:48,400 --> 00:22:51,200
the actual operation just the head

685
00:22:51,200 --> 00:22:53,840
just to hit the bucket ips same deal

686
00:22:53,840 --> 00:22:57,440
time even the the user right and so

687
00:22:57,440 --> 00:22:59,679
you um you can kind of customize that as

688
00:22:59,679 --> 00:23:00,960
well and

689
00:23:00,960 --> 00:23:03,760
make this look super convincing

690
00:23:03,760 --> 00:23:05,440
and one thing with canary

691
00:23:05,440 --> 00:23:07,280
that's great is you have almost an

692
00:23:07,280 --> 00:23:08,799
unlimited number of endpoints to send

693
00:23:08,799 --> 00:23:10,799
alerts to so you can

694
00:23:10,799 --> 00:23:15,200
email sms slack generic web hooks you

695
00:23:15,200 --> 00:23:16,640
know

696
00:23:16,640 --> 00:23:19,120
splunk you name it

697
00:23:19,120 --> 00:23:20,400
you can send data to it even just

698
00:23:20,400 --> 00:23:23,360
generic syslog and i recommend you do

699
00:23:23,360 --> 00:23:24,799
because

700
00:23:24,799 --> 00:23:25,840
you know you should be sending this to

701
00:23:25,840 --> 00:23:27,760
your sim and building the forensics

702
00:23:27,760 --> 00:23:30,480
trail print area by itself it gathers

703
00:23:30,480 --> 00:23:31,919
this data but their whole pitch is they

704
00:23:31,919 --> 00:23:33,120
don't want you spending time in the

705
00:23:33,120 --> 00:23:35,840
console they they really do just say

706
00:23:35,840 --> 00:23:37,360
take five minutes deploy it and then

707
00:23:37,360 --> 00:23:39,600
don't look at it and most security

708
00:23:39,600 --> 00:23:41,679
companies you have to constantly babysit

709
00:23:41,679 --> 00:23:42,720
the product

710
00:23:42,720 --> 00:23:45,039
but this is one in which it really just

711
00:23:45,039 --> 00:23:46,960
works

712
00:23:46,960 --> 00:23:48,880
um

713
00:23:48,880 --> 00:23:53,279
yeah and we've also got slack tokens

714
00:23:53,279 --> 00:23:55,440
and i like to go meta with these and do

715
00:23:55,440 --> 00:23:57,279
things like dropping them

716
00:23:57,279 --> 00:23:59,120
in your slack space

717
00:23:59,120 --> 00:24:01,440
so you can take your face back to my

718
00:24:01,440 --> 00:24:03,840
space no but the the idea here is you

719
00:24:03,840 --> 00:24:05,919
could put these in public slack channels

720
00:24:05,919 --> 00:24:08,159
so that if people are compromising a

721
00:24:08,159 --> 00:24:09,760
slack account they're going to look

722
00:24:09,760 --> 00:24:12,320
around they might search for xoxp or

723
00:24:12,320 --> 00:24:14,720
xoxb which indicates either a personal

724
00:24:14,720 --> 00:24:16,000
or bot token

725
00:24:16,000 --> 00:24:17,279
and they'll find it and they think they

726
00:24:17,279 --> 00:24:18,960
got something you can drop these in your

727
00:24:18,960 --> 00:24:21,360
code repositories drop them on people's

728
00:24:21,360 --> 00:24:24,400
machines possibilities are endless

729
00:24:24,400 --> 00:24:26,720
and they have no permissions but they're

730
00:24:26,720 --> 00:24:28,320
really appealing you know you ask any

731
00:24:28,320 --> 00:24:30,000
pen tester including

732
00:24:30,000 --> 00:24:32,960
um haroon who you know founded thinks

733
00:24:32,960 --> 00:24:34,080
if um

734
00:24:34,080 --> 00:24:36,559
he would pass over a set of api

735
00:24:36,559 --> 00:24:39,600
credentials no anyone that comes across

736
00:24:39,600 --> 00:24:41,600
credentials is going to try to use them

737
00:24:41,600 --> 00:24:43,679
slack tokens are no exception

738
00:24:43,679 --> 00:24:45,520
and exhibit um

739
00:24:45,520 --> 00:24:47,600
you know exhibit pulls it all together

740
00:24:47,600 --> 00:24:48,270
here for us

741
00:24:48,270 --> 00:24:49,600
[Music]

742
00:24:49,600 --> 00:24:50,799
and then

743
00:24:50,799 --> 00:24:52,720
on the api front we also the latest

744
00:24:52,720 --> 00:24:55,440
token which is super cool it's a

745
00:24:55,440 --> 00:24:58,320
kubernetes or k8 because it's k eight

746
00:24:58,320 --> 00:25:01,200
letters get it and then s and the whole

747
00:25:01,200 --> 00:25:02,720
point of kubernetes

748
00:25:02,720 --> 00:25:05,279
is managing massive amounts of what are

749
00:25:05,279 --> 00:25:07,760
called containerized applications which

750
00:25:07,760 --> 00:25:09,919
is like the next iteration of virtual

751
00:25:09,919 --> 00:25:12,640
machines you know containers like a self

752
00:25:12,640 --> 00:25:15,120
um self-contained environment where you

753
00:25:15,120 --> 00:25:17,520
don't it's platform agnostic you just

754
00:25:17,520 --> 00:25:19,520
spin it up with something like docker or

755
00:25:19,520 --> 00:25:20,480
whatnot

756
00:25:20,480 --> 00:25:22,960
but we can actually create a kubernetes

757
00:25:22,960 --> 00:25:25,679
config file and similar to aws we can

758
00:25:25,679 --> 00:25:27,600
drop these on people's machines

759
00:25:27,600 --> 00:25:28,880
automatically

760
00:25:28,880 --> 00:25:29,679
and

761
00:25:29,679 --> 00:25:32,080
fire alerts when they try to use it and

762
00:25:32,080 --> 00:25:33,120
similar to

763
00:25:33,120 --> 00:25:35,919
aws we also grab information on the user

764
00:25:35,919 --> 00:25:38,159
agent so we'll know what version of the

765
00:25:38,159 --> 00:25:40,640
cube cuddle cli tool they use what

766
00:25:40,640 --> 00:25:43,679
endpoint they hit all the all the really

767
00:25:43,679 --> 00:25:45,200
useful pieces of information and it

768
00:25:45,200 --> 00:25:46,799
looks just like a regular kubernetes

769
00:25:46,799 --> 00:25:48,960
config file behind the scenes though

770
00:25:48,960 --> 00:25:51,200
it's hitting you know a bogus endpoint

771
00:25:51,200 --> 00:25:53,520
that canary kind of like masquerades

772
00:25:53,520 --> 00:25:55,120
it's brilliant

773
00:25:55,120 --> 00:25:57,120
and i've seen this fired

774
00:25:57,120 --> 00:26:00,559
you know probably half a dozen times

775
00:26:01,039 --> 00:26:02,799
all right we're going to talk about some

776
00:26:02,799 --> 00:26:04,880
tokens to protect your telephones and

777
00:26:04,880 --> 00:26:07,520
your devices these are personally useful

778
00:26:07,520 --> 00:26:09,520
for everyone here now and so i'd

779
00:26:09,520 --> 00:26:10,559
recommend

780
00:26:10,559 --> 00:26:12,080
you know creating

781
00:26:12,080 --> 00:26:14,240
the following

782
00:26:14,240 --> 00:26:16,480
so there's a really neat token

783
00:26:16,480 --> 00:26:19,120
canary released last year it's called uh

784
00:26:19,120 --> 00:26:20,880
so wireguard is a new virtual private

785
00:26:20,880 --> 00:26:22,559
network protocol it's faster than

786
00:26:22,559 --> 00:26:25,120
openvpn it uses some different cipher

787
00:26:25,120 --> 00:26:26,080
suites

788
00:26:26,080 --> 00:26:28,159
and it's just more reliable

789
00:26:28,159 --> 00:26:29,679
and

790
00:26:29,679 --> 00:26:31,840
you can create like a bogus

791
00:26:31,840 --> 00:26:33,679
wireguard profile

792
00:26:33,679 --> 00:26:35,600
with the idea that

793
00:26:35,600 --> 00:26:37,440
if your phone is compromised and it's

794
00:26:37,440 --> 00:26:39,360
really hard to know you know last year

795
00:26:39,360 --> 00:26:41,520
you had the pegasus spyware that was

796
00:26:41,520 --> 00:26:44,240
hitting political dissidence phones and

797
00:26:44,240 --> 00:26:46,320
you know it was really hard to detect

798
00:26:46,320 --> 00:26:47,840
unless you did deep forensics i mean

799
00:26:47,840 --> 00:26:50,159
happened to jeff bezos in 2020 allegedly

800
00:26:50,159 --> 00:26:51,600
when the saudi arabian government hacked

801
00:26:51,600 --> 00:26:52,559
his phone

802
00:26:52,559 --> 00:26:54,559
so like how would you even know

803
00:26:54,559 --> 00:26:56,880
that your phone got prone

804
00:26:56,880 --> 00:26:58,400
well one thing you can do is use this

805
00:26:58,400 --> 00:27:00,240
token to create

806
00:27:00,240 --> 00:27:02,240
you know a vpn profile name it something

807
00:27:02,240 --> 00:27:05,039
that sounds appealing like you know

808
00:27:05,039 --> 00:27:08,320
corporate vpn or production whatever

809
00:27:08,320 --> 00:27:10,000
and then if somebody turns it on because

810
00:27:10,000 --> 00:27:11,120
it's not going to be you because it's

811
00:27:11,120 --> 00:27:14,080
useless it's going to fire an alert one

812
00:27:14,080 --> 00:27:15,440
important thing to notice about these

813
00:27:15,440 --> 00:27:17,679
tokens make sure you use a memo that

814
00:27:17,679 --> 00:27:20,399
isn't test make it actionable and and

815
00:27:20,399 --> 00:27:22,720
relevant so i like to automate this

816
00:27:22,720 --> 00:27:25,440
typically by using like variables of

817
00:27:25,440 --> 00:27:27,039
hostname of the machine and then

818
00:27:27,039 --> 00:27:29,760
username so something token on whatever

819
00:27:29,760 --> 00:27:30,720
but otherwise you're going to be like

820
00:27:30,720 --> 00:27:32,559
where's this token and you know because

821
00:27:32,559 --> 00:27:33,600
there are companies that literally have

822
00:27:33,600 --> 00:27:35,440
hundreds of thousands of tokens

823
00:27:35,440 --> 00:27:36,559
and the more the better you get

824
00:27:36,559 --> 00:27:38,880
unlimited with with things so you should

825
00:27:38,880 --> 00:27:40,640
be deploying this everywhere and

826
00:27:40,640 --> 00:27:43,440
anywhere but i love this

827
00:27:43,440 --> 00:27:45,600
and you totally can pull out your phone

828
00:27:45,600 --> 00:27:47,520
right now and scan this code

829
00:27:47,520 --> 00:27:48,880
because

830
00:27:48,880 --> 00:27:50,480
you know bad guys hate it when you do

831
00:27:50,480 --> 00:27:52,159
this one weird trick

832
00:27:52,159 --> 00:27:54,880
qr qr codes are really

833
00:27:54,880 --> 00:27:57,120
versatile and there's a lot of things

834
00:27:57,120 --> 00:27:58,720
that you could do with this

835
00:27:58,720 --> 00:28:00,799
you could put this around your office

836
00:28:00,799 --> 00:28:03,120
and say here's the new wi-fi password

837
00:28:03,120 --> 00:28:05,200
but you know full well that you don't

838
00:28:05,200 --> 00:28:06,640
actually give out the wi-fi password

839
00:28:06,640 --> 00:28:07,679
because you probably push it out

840
00:28:07,679 --> 00:28:09,840
securely so anyone that's trying to get

841
00:28:09,840 --> 00:28:12,799
it is probably just up to no good

842
00:28:12,799 --> 00:28:15,200
but one use case that i've seen that's

843
00:28:15,200 --> 00:28:16,799
really effective is if you have

844
00:28:16,799 --> 00:28:18,480
multi-factor

845
00:28:18,480 --> 00:28:20,480
you can drop an unread email in

846
00:28:20,480 --> 00:28:23,039
everyone's mailbox and make it look like

847
00:28:23,039 --> 00:28:24,799
it came from octa or duo and say hey you

848
00:28:24,799 --> 00:28:27,039
got a new device scan this bad boy and

849
00:28:27,039 --> 00:28:28,640
roll it and then when they do it's going

850
00:28:28,640 --> 00:28:30,880
to send them to some funny site and have

851
00:28:30,880 --> 00:28:32,640
like some lyrics from top gun or i don't

852
00:28:32,640 --> 00:28:34,960
even remember because it's randomized

853
00:28:34,960 --> 00:28:36,960
and where it goes you can rick roll them

854
00:28:36,960 --> 00:28:39,200
you can do whatever you want and at that

855
00:28:39,200 --> 00:28:40,159
point

856
00:28:40,159 --> 00:28:41,600
they're probably going to like

857
00:28:41,600 --> 00:28:43,120
try a little lightly you know it's all

858
00:28:43,120 --> 00:28:45,120
about psychological warfare and as

859
00:28:45,120 --> 00:28:45,840
you're

860
00:28:45,840 --> 00:28:47,600
going along and playing mind games with

861
00:28:47,600 --> 00:28:49,039
them they're going to be more inclined

862
00:28:49,039 --> 00:28:51,679
to want to leave

863
00:28:51,760 --> 00:28:53,279
and on that note

864
00:28:53,279 --> 00:28:55,120
it's trippy but let's talk about mind

865
00:28:55,120 --> 00:28:56,720
games this is where it gets really fun

866
00:28:56,720 --> 00:28:58,480
this is all about the information

867
00:28:58,480 --> 00:29:01,520
warfare where you get to manipulate data

868
00:29:01,520 --> 00:29:02,240
to

869
00:29:02,240 --> 00:29:04,720
convince people that they're losing it

870
00:29:04,720 --> 00:29:08,640
so this data basically database is

871
00:29:08,640 --> 00:29:11,120
just asking me dump because databases

872
00:29:11,120 --> 00:29:13,679
are treasure troves of valuable

873
00:29:13,679 --> 00:29:15,440
bits you know everyone wants the

874
00:29:15,440 --> 00:29:16,640
database

875
00:29:16,640 --> 00:29:18,559
it's usually got credit card numbers

876
00:29:18,559 --> 00:29:21,120
it's got social security numbers we can

877
00:29:21,120 --> 00:29:23,279
make this thing look super convincing

878
00:29:23,279 --> 00:29:26,159
call it nft payments table or call it

879
00:29:26,159 --> 00:29:29,360
you know accounting backup whatever

880
00:29:29,360 --> 00:29:31,039
you know you can create a my sequel

881
00:29:31,039 --> 00:29:32,799
token and

882
00:29:32,799 --> 00:29:34,320
you can drop these things everywhere you

883
00:29:34,320 --> 00:29:36,159
know you can put them in amazon web

884
00:29:36,159 --> 00:29:37,760
services and

885
00:29:37,760 --> 00:29:39,840
use them within your existing databases

886
00:29:39,840 --> 00:29:42,880
or use your imagination right and then

887
00:29:42,880 --> 00:29:45,039
once i go to open this you know database

888
00:29:45,039 --> 00:29:46,559
just running command there's all kinds

889
00:29:46,559 --> 00:29:49,039
of gibberish it looks legit but it's

890
00:29:49,039 --> 00:29:50,880
completely useless but then in the

891
00:29:50,880 --> 00:29:52,320
process you know we get another alert

892
00:29:52,320 --> 00:29:53,120
here

893
00:29:53,120 --> 00:29:54,880
we figure out oh there's the host name

894
00:29:54,880 --> 00:29:56,240
that's helpful

895
00:29:56,240 --> 00:29:58,640
so if they have a specific mysql client

896
00:29:58,640 --> 00:29:59,760
inversion

897
00:29:59,760 --> 00:30:01,600
it'll tell us that and again that starts

898
00:30:01,600 --> 00:30:03,840
to limit our our profile of they're

899
00:30:03,840 --> 00:30:05,120
using this certain version of this and

900
00:30:05,120 --> 00:30:06,720
this so we can start to

901
00:30:06,720 --> 00:30:09,360
you know um like pile it together and

902
00:30:09,360 --> 00:30:11,200
and start building this profile who this

903
00:30:11,200 --> 00:30:14,159
person who people may be

904
00:30:14,159 --> 00:30:16,799
what if conspiracy keanu made the

905
00:30:16,799 --> 00:30:18,320
realization

906
00:30:18,320 --> 00:30:20,559
that conspiracy theories are actually

907
00:30:20,559 --> 00:30:23,440
conspiracy realities so this is a fun

908
00:30:23,440 --> 00:30:25,440
little trick right you create a google

909
00:30:25,440 --> 00:30:28,480
doc or a word doc name it something that

910
00:30:28,480 --> 00:30:30,159
everyone wants to open

911
00:30:30,159 --> 00:30:32,159
if they're up to no good like

912
00:30:32,159 --> 00:30:34,159
organizational structure go to market

913
00:30:34,159 --> 00:30:37,120
strategy ipo whatever and then you hit

914
00:30:37,120 --> 00:30:39,520
them with a truth bomb so you tell them

915
00:30:39,520 --> 00:30:41,440
something that they may not know

916
00:30:41,440 --> 00:30:44,080
maybe that leads them to you know walk

917
00:30:44,080 --> 00:30:45,840
away and question

918
00:30:45,840 --> 00:30:47,520
um you know everything that they're

919
00:30:47,520 --> 00:30:50,000
doing you know mk ultra is a highly

920
00:30:50,000 --> 00:30:51,360
legal cia

921
00:30:51,360 --> 00:30:54,720
program that you know likely created

922
00:30:54,720 --> 00:30:56,799
the unabomber among other things but you

923
00:30:56,799 --> 00:30:57,919
could also drop something in about

924
00:30:57,919 --> 00:31:00,240
operation northwoods or write a whole

925
00:31:00,240 --> 00:31:02,640
story about the jfk assassination is if

926
00:31:02,640 --> 00:31:05,120
you know what happened just confuse them

927
00:31:05,120 --> 00:31:07,120
and below them at this point they're

928
00:31:07,120 --> 00:31:08,480
probably going to go

929
00:31:08,480 --> 00:31:09,519
away

930
00:31:09,519 --> 00:31:11,679
and this is a good point to mention

931
00:31:11,679 --> 00:31:14,480
there's another really neat service

932
00:31:14,480 --> 00:31:16,720
called bittrap that's experimenting with

933
00:31:16,720 --> 00:31:19,519
this whole idea around

934
00:31:19,519 --> 00:31:21,519
giving people bug bounties

935
00:31:21,519 --> 00:31:23,440
but differing amounts depending on how

936
00:31:23,440 --> 00:31:26,240
far along they go in the process so

937
00:31:26,240 --> 00:31:28,559
when you kind of use canary

938
00:31:28,559 --> 00:31:29,600
you know you can have certain

939
00:31:29,600 --> 00:31:30,960
checkpoints and say all right they

940
00:31:30,960 --> 00:31:32,559
popped my web server

941
00:31:32,559 --> 00:31:33,919
if you leave now

942
00:31:33,919 --> 00:31:35,840
they'll give you this you know

943
00:31:35,840 --> 00:31:37,279
five grand but if you keep going you're

944
00:31:37,279 --> 00:31:38,720
going to get less and less money and

945
00:31:38,720 --> 00:31:40,640
also we're going to come for you

946
00:31:40,640 --> 00:31:43,360
and it's a pretty neat service i'm i

947
00:31:43,360 --> 00:31:44,799
don't think they're officially partnered

948
00:31:44,799 --> 00:31:46,799
with canary but

949
00:31:46,799 --> 00:31:50,000
it works works well just like anything

950
00:31:50,000 --> 00:31:51,679
you know it integrates

951
00:31:51,679 --> 00:31:53,600
perfectly so there's a lot of really

952
00:31:53,600 --> 00:31:55,120
neat things you can do

953
00:31:55,120 --> 00:31:56,559
along that line

954
00:31:56,559 --> 00:31:57,440
and

955
00:31:57,440 --> 00:31:59,360
it doesn't just stop with google docs we

956
00:31:59,360 --> 00:32:01,679
can spread some

957
00:32:01,679 --> 00:32:04,799
i just love puns but i'm fascinated with

958
00:32:04,799 --> 00:32:06,159
db cooper

959
00:32:06,159 --> 00:32:08,880
because the fbi closed the case in 2016.

960
00:32:08,880 --> 00:32:10,799
we still don't know what happened to him

961
00:32:10,799 --> 00:32:12,720
and you know maybe the person that reads

962
00:32:12,720 --> 00:32:14,880
this is going to go reopen the case and

963
00:32:14,880 --> 00:32:17,120
do something useful other than try to

964
00:32:17,120 --> 00:32:19,200
you know break into your network and

965
00:32:19,200 --> 00:32:21,279
you know be a scumbag but you know you

966
00:32:21,279 --> 00:32:23,039
can drop stuff in here whatever you want

967
00:32:23,039 --> 00:32:24,960
it to be

968
00:32:24,960 --> 00:32:26,640
i really am curious what happened i mean

969
00:32:26,640 --> 00:32:28,320
he jumped out of the airplane with 200

970
00:32:28,320 --> 00:32:31,039
grand he probably lost it all but uh

971
00:32:31,039 --> 00:32:32,880
you know they're still going to give 100

972
00:32:32,880 --> 00:32:35,360
million dollar rewards so if anybody

973
00:32:35,360 --> 00:32:36,320
knows

974
00:32:36,320 --> 00:32:37,919
there's a there's a funny hbo

975
00:32:37,919 --> 00:32:39,840
documentary about people that claim that

976
00:32:39,840 --> 00:32:42,799
nowhere db cooper is

977
00:32:42,799 --> 00:32:45,120
but they yeah they don't to this day but

978
00:32:45,120 --> 00:32:46,399
that said hey

979
00:32:46,399 --> 00:32:48,399
use your imagination whatever you can

980
00:32:48,399 --> 00:32:51,200
think of that might be interesting

981
00:32:51,200 --> 00:32:53,360
and might educate them this is what you

982
00:32:53,360 --> 00:32:55,039
should do

983
00:32:55,039 --> 00:32:56,399
cool

984
00:32:56,399 --> 00:32:59,120
so now we've worked up to this point to

985
00:32:59,120 --> 00:33:01,279
a seven layer dip or

986
00:33:01,279 --> 00:33:04,320
of deception inception and this is where

987
00:33:04,320 --> 00:33:05,760
it starts to get really fun and this is

988
00:33:05,760 --> 00:33:07,600
where you tie it all together so the

989
00:33:07,600 --> 00:33:08,960
idea here

990
00:33:08,960 --> 00:33:11,840
for example you got an adversary who

991
00:33:11,840 --> 00:33:13,679
pops say your

992
00:33:13,679 --> 00:33:15,440
your actual web server maybe is running

993
00:33:15,440 --> 00:33:17,360
apache struts it's vulnerable it has to

994
00:33:17,360 --> 00:33:19,760
be on the web right now or something you

995
00:33:19,760 --> 00:33:21,200
know there's so many situations you can

996
00:33:21,200 --> 00:33:22,799
think of where you can upgrade this

997
00:33:22,799 --> 00:33:25,679
because of that software dependency so

998
00:33:25,679 --> 00:33:27,039
let's just say you're stuck with this

999
00:33:27,039 --> 00:33:29,679
vulnerable server what you can do

1000
00:33:29,679 --> 00:33:32,960
is wrap it in tokens you can do things

1001
00:33:32,960 --> 00:33:35,360
like the netstat process which is one of

1002
00:33:35,360 --> 00:33:37,360
the first commands in adversarial run to

1003
00:33:37,360 --> 00:33:39,120
get situational awareness we can

1004
00:33:39,120 --> 00:33:41,039
actually wrap that in a dns token so

1005
00:33:41,039 --> 00:33:42,960
when they run netstat it'll fire an

1006
00:33:42,960 --> 00:33:43,840
alert

1007
00:33:43,840 --> 00:33:46,000
and and then it'll start to build

1008
00:33:46,000 --> 00:33:48,240
everything into your knee seam i'm such

1009
00:33:48,240 --> 00:33:50,000
a dork security incident event

1010
00:33:50,000 --> 00:33:53,200
management system and

1011
00:33:53,200 --> 00:33:55,519
then that's part one right so they run

1012
00:33:55,519 --> 00:33:57,840
netstat and then oh nmap happens to be

1013
00:33:57,840 --> 00:34:00,080
there that's helpful well

1014
00:34:00,080 --> 00:34:01,679
once they run nmap

1015
00:34:01,679 --> 00:34:02,960
they're going to hit a windows server

1016
00:34:02,960 --> 00:34:04,880
conveniently that's a file share let's

1017
00:34:04,880 --> 00:34:07,679
just say there's a document on there

1018
00:34:07,679 --> 00:34:09,520
that has some credentials

1019
00:34:09,520 --> 00:34:11,599
that give you access to a bucket

1020
00:34:11,599 --> 00:34:13,839
seven layers you're gathering all this

1021
00:34:13,839 --> 00:34:15,119
different disparate pieces of

1022
00:34:15,119 --> 00:34:17,679
information you're sending it to liam

1023
00:34:17,679 --> 00:34:18,879
neeson

1024
00:34:18,879 --> 00:34:20,639
and he will find you

1025
00:34:20,639 --> 00:34:22,800
and he will kill you or he will at least

1026
00:34:22,800 --> 00:34:24,480
turn the information

1027
00:34:24,480 --> 00:34:25,599
over to

1028
00:34:25,599 --> 00:34:27,918
the authorities and

1029
00:34:27,918 --> 00:34:29,839
you know this is just one example

1030
00:34:29,839 --> 00:34:31,760
there's so many things you could do

1031
00:34:31,760 --> 00:34:34,159
again this is why i love this is not

1032
00:34:34,159 --> 00:34:35,679
only does it

1033
00:34:35,679 --> 00:34:37,440
lean on your kind of like analytical

1034
00:34:37,440 --> 00:34:39,280
brain but it requires you to be creative

1035
00:34:39,280 --> 00:34:41,599
and think of different scenarios as a

1036
00:34:41,599 --> 00:34:44,159
bad actor of what you may do you know

1037
00:34:44,159 --> 00:34:46,239
what are you interested in if you have a

1038
00:34:46,239 --> 00:34:48,399
background in offensive security what's

1039
00:34:48,399 --> 00:34:49,760
your approach

1040
00:34:49,760 --> 00:34:51,119
and you kind of think of it from the

1041
00:34:51,119 --> 00:34:52,639
other side of well how am i going to

1042
00:34:52,639 --> 00:34:54,480
trip myself up and you're kind of

1043
00:34:54,480 --> 00:34:56,000
playing a cat and mouse game with

1044
00:34:56,000 --> 00:34:57,680
yourself and there's bonus points if you

1045
00:34:57,680 --> 00:34:59,680
have a team that you can constantly like

1046
00:34:59,680 --> 00:35:02,320
run these exercises with

1047
00:35:02,320 --> 00:35:03,119
because you're just going to keep

1048
00:35:03,119 --> 00:35:05,440
getting better at the end of the day

1049
00:35:05,440 --> 00:35:06,720
and

1050
00:35:06,720 --> 00:35:08,960
with that i wanted to

1051
00:35:08,960 --> 00:35:12,160
thank you all so much and open it up for

1052
00:35:12,160 --> 00:35:13,839
questions

1053
00:35:13,839 --> 00:35:15,040
and comments

1054
00:35:15,040 --> 00:35:22,540
[Applause]

1055
00:35:28,160 --> 00:35:31,480
it's all hand

1056
00:35:33,440 --> 00:35:35,680
yes

1057
00:35:35,680 --> 00:35:38,320
yeah absolutely i'm gonna

1058
00:35:38,320 --> 00:35:41,119
share it out on on sketch and um

1059
00:35:41,119 --> 00:35:44,640
also yeah you can hit me up on twitter

1060
00:35:44,640 --> 00:35:46,079
i'm not very big in the social media

1061
00:35:46,079 --> 00:35:47,599
world i'm pretty much a ghost however i

1062
00:35:47,599 --> 00:35:49,440
created an account so that i could

1063
00:35:49,440 --> 00:35:52,000
interact it's just at justin t varner

1064
00:35:52,000 --> 00:35:54,160
send me a message i love this stuff

1065
00:35:54,160 --> 00:35:56,640
i love security and i love coming up

1066
00:35:56,640 --> 00:35:58,560
with solutions you know i think my

1067
00:35:58,560 --> 00:36:00,800
generic title i gave myself a security

1068
00:36:00,800 --> 00:36:02,640
philosopher so i just think about

1069
00:36:02,640 --> 00:36:04,000
problems and

1070
00:36:04,000 --> 00:36:05,760
solutions and i think we all kind of do

1071
00:36:05,760 --> 00:36:07,520
that in some way but

1072
00:36:07,520 --> 00:36:08,960
yeah i'd love to talk

1073
00:36:08,960 --> 00:36:10,480
more about all of this stuff because

1074
00:36:10,480 --> 00:36:13,839
it's super fun

1075
00:36:16,400 --> 00:36:18,960
what else

1076
00:36:21,200 --> 00:36:23,590
bueller

1077
00:36:23,590 --> 00:36:24,839
[Music]

1078
00:36:24,839 --> 00:36:28,400
okay got a quite honest thank you guys

1079
00:36:28,400 --> 00:36:31,720
you're the best

