1
00:00:00,030 --> 00:00:06,060
the besides DC 2017 videos are<font color="#E5E5E5"> brought</font>

2
00:00:03,270 --> 00:00:07,740
to you by threat quotient introducing

3
00:00:06,060 --> 00:00:10,019
<font color="#E5E5E5">the industry's</font><font color="#CCCCCC"> first threat intelligence</font>

4
00:00:07,740 --> 00:00:13,139
platform designed to<font color="#E5E5E5"> enable threat</font>

5
00:00:10,019 --> 00:00:15,960
operations and management and data tribe

6
00:00:13,139 --> 00:00:17,910
<font color="#CCCCCC">a new kind of</font><font color="#E5E5E5"> startup studio</font><font color="#CCCCCC"> co building</font>

7
00:00:15,960 --> 00:00:21,090
the next<font color="#CCCCCC"> generation of commercial cyber</font>

8
00:00:17,910 --> 00:00:24,050
<font color="#CCCCCC">security analytics and big data product</font>

9
00:00:21,090 --> 00:00:26,698
companies my name is khalid al<font color="#E5E5E5"> hassan ii</font>

10
00:00:24,050 --> 00:00:28,500
<font color="#E5E5E5">detecting malicious ssl certificates</font>

11
00:00:26,699 --> 00:00:29,970
using machine learning<font color="#CCCCCC"> i know on the</font>

12
00:00:28,500 --> 00:00:31,769
schedule it says in<font color="#CCCCCC"> your spare time</font>

13
00:00:29,970 --> 00:00:34,649
<font color="#CCCCCC">I</font><font color="#E5E5E5"> haven't need to do that here I'll get</font>

14
00:00:31,769 --> 00:00:37,739
to that<font color="#E5E5E5"> a little bit little later but</font>

15
00:00:34,649 --> 00:00:44,629
it's kind of<font color="#E5E5E5"> you know kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> an</font>

16
00:00:37,739 --> 00:00:47,610
accurate<font color="#E5E5E5"> statement</font><font color="#CCCCCC"> so the motivation</font><font color="#E5E5E5"> is</font>

17
00:00:44,629 --> 00:00:49,530
<font color="#CCCCCC">given pretty much well known by now</font>

18
00:00:47,610 --> 00:00:52,769
that increasing share<font color="#CCCCCC"> of encrypted</font>

19
00:00:49,530 --> 00:00:55,379
<font color="#E5E5E5">network traffic traffic let's say half</font>

20
00:00:52,770 --> 00:00:59,280
or more<font color="#CCCCCC"> than half of network</font><font color="#E5E5E5"> traffic is</font>

21
00:00:55,379 --> 00:01:01,108
encrypted<font color="#E5E5E5"> and there is a push to monitor</font>

22
00:00:59,280 --> 00:01:02,969
<font color="#E5E5E5">traffic for malware and other threats</font>

23
00:01:01,109 --> 00:01:08,180
without<font color="#CCCCCC"> man-in-the-middle being without</font>

24
00:01:02,969 --> 00:01:11,280
decryption<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> SSL</font><font color="#E5E5E5"> certificate</font>

25
00:01:08,180 --> 00:01:13,409
provides us with a fundamental<font color="#CCCCCC"> part of</font>

26
00:01:11,280 --> 00:01:15,030
<font color="#E5E5E5">the encrypted traffic matter metadata</font><font color="#CCCCCC"> ad</font>

27
00:01:13,409 --> 00:01:18,540
it provides<font color="#E5E5E5"> us with its</font><font color="#CCCCCC"> ensure</font>

28
00:01:15,030 --> 00:01:24,360
information<font color="#CCCCCC"> that you know we can we can</font>

29
00:01:18,540 --> 00:01:26,310
use<font color="#E5E5E5"> so as as with any machine learning</font>

30
00:01:24,360 --> 00:01:29,189
or data science project<font color="#E5E5E5"> first you need</font>

31
00:01:26,310 --> 00:01:31,229
you need the<font color="#E5E5E5"> data and in this case we</font>

32
00:01:29,189 --> 00:01:33,380
need label data<font color="#E5E5E5"> meaning we need</font>

33
00:01:31,229 --> 00:01:37,350
certificates<font color="#E5E5E5"> that we know are bad</font>

34
00:01:33,380 --> 00:01:40,850
certificates we know<font color="#CCCCCC"> are are good more</font>

35
00:01:37,350 --> 00:01:42,780
or<font color="#CCCCCC"> less we know they're</font><font color="#E5E5E5"> they can be some</font>

36
00:01:40,850 --> 00:01:46,470
certificates that we know they're benign

37
00:01:42,780 --> 00:01:49,140
they're not to be to be malicious<font color="#E5E5E5"> but in</font>

38
00:01:46,470 --> 00:01:53,220
general<font color="#E5E5E5"> benign certificates and and</font>

39
00:01:49,140 --> 00:01:55,649
malicious certificates<font color="#CCCCCC"> collecting benign</font>

40
00:01:53,220 --> 00:01:59,939
certificates is is not a big<font color="#E5E5E5"> problem</font>

41
00:01:55,649 --> 00:02:04,710
<font color="#E5E5E5">there</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> many available</font><font color="#CCCCCC"> we use this the</font>

42
00:01:59,939 --> 00:02:07,469
source<font color="#E5E5E5"> census plenty of millions of</font>

43
00:02:04,710 --> 00:02:09,299
certificates there<font color="#CCCCCC"> we collect the</font>

44
00:02:07,469 --> 00:02:10,960
trusted certificates there we sample

45
00:02:09,300 --> 00:02:13,510
<font color="#CCCCCC">from there</font>

46
00:02:10,960 --> 00:02:17,710
<font color="#E5E5E5">Alexa</font><font color="#CCCCCC"> ten thousand domains we can sample</font>

47
00:02:13,510 --> 00:02:19,149
<font color="#E5E5E5">from there and trusted certificate</font>

48
00:02:17,710 --> 00:02:23,280
authority root certificates these are

49
00:02:19,150 --> 00:02:26,170
self signed<font color="#E5E5E5"> a few hundred of them</font>

50
00:02:23,280 --> 00:02:29,890
getting the<font color="#CCCCCC"> militia certificates is the</font>

51
00:02:26,170 --> 00:02:34,200
is a more challenging<font color="#E5E5E5"> problem and this</font>

52
00:02:29,890 --> 00:02:38,829
<font color="#CCCCCC">is done by our threat research</font><font color="#E5E5E5"> team</font>

53
00:02:34,200 --> 00:02:39,850
<font color="#E5E5E5">particularly Jason Reeves basically</font>

54
00:02:38,830 --> 00:02:51,270
collect the data

55
00:02:39,850 --> 00:02:51,269
the<font color="#E5E5E5"> IOC data of different</font><font color="#CCCCCC"> malware's</font><font color="#E5E5E5"> okay</font>

56
00:02:51,360 --> 00:02:56,590
<font color="#CCCCCC">collective collect I you see data of</font>

57
00:02:54,430 --> 00:03:00,370
different malware and for the ones<font color="#E5E5E5"> that</font>

58
00:02:56,590 --> 00:03:03,190
use as<font color="#CCCCCC"> a cell we</font><font color="#E5E5E5"> store this this this</font>

59
00:03:00,370 --> 00:03:06,310
<font color="#CCCCCC">data and for the ones that</font><font color="#E5E5E5"> use SSL go</font>

60
00:03:03,190 --> 00:03:09,070
back and scan this scan this data

61
00:03:06,310 --> 00:03:16,030
meaning port<font color="#E5E5E5"> IPS and and pull out the</font>

62
00:03:09,070 --> 00:03:19,510
<font color="#CCCCCC">other certificate for for this study so</font>

63
00:03:16,030 --> 00:03:22,560
<font color="#CCCCCC">far we have a data</font><font color="#E5E5E5"> set of about thirteen</font>

64
00:03:19,510 --> 00:03:26,019
thousand two hundred certs including

65
00:03:22,560 --> 00:03:28,930
four hundred four thousand three hundred

66
00:03:26,020 --> 00:03:29,590
roughly militia certs and<font color="#E5E5E5"> around 9,000</font>

67
00:03:28,930 --> 00:03:33,600
<font color="#E5E5E5">benign</font><font color="#CCCCCC"> certs</font>

68
00:03:29,590 --> 00:03:36,400
we want to keep the we want to keep the

69
00:03:33,600 --> 00:03:38,109
the data set from being<font color="#E5E5E5"> too imbalanced</font>

70
00:03:36,400 --> 00:03:39,580
<font color="#CCCCCC">we can</font><font color="#E5E5E5"> collect</font><font color="#CCCCCC"> millions of benign</font>

71
00:03:38,110 --> 00:03:41,380
certificates but that wouldn't<font color="#E5E5E5"> be</font><font color="#CCCCCC"> very</font>

72
00:03:39,580 --> 00:03:47,740
<font color="#E5E5E5">helpful because we don't want to get the</font>

73
00:03:41,380 --> 00:03:53,890
the<font color="#E5E5E5"> data set to be too imbalanced if we</font>

74
00:03:47,740 --> 00:03:57,340
look at one sample<font color="#CCCCCC"> part cert some of the</font>

75
00:03:53,890 --> 00:03:58,869
fields<font color="#CCCCCC"> their serial number</font><font color="#E5E5E5"> begin date</font>

76
00:03:57,340 --> 00:04:06,190
which is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> issuing date in this case</font>

77
00:03:58,870 --> 00:04:11,140
2014 and date in expired<font color="#E5E5E5"> date with</font><font color="#CCCCCC"> is</font>

78
00:04:06,190 --> 00:04:13,570
<font color="#E5E5E5">this case 2026 subject fields include</font>

79
00:04:11,140 --> 00:04:15,760
the<font color="#E5E5E5"> country</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> the state locality</font>

80
00:04:13,570 --> 00:04:18,608
organization organization name email

81
00:04:15,760 --> 00:04:20,798
address common<font color="#E5E5E5"> name and in this case</font>

82
00:04:18,608 --> 00:04:21,250
there<font color="#CCCCCC"> is some unstructured name that's</font>

83
00:04:20,798 --> 00:04:24,489
<font color="#E5E5E5">there</font>

84
00:04:21,250 --> 00:04:27,490
it's not not usually<font color="#CCCCCC"> there</font><font color="#E5E5E5"> the issuer in</font>

85
00:04:24,490 --> 00:04:30,940
this case we only have one field<font color="#CCCCCC"> it's</font>

86
00:04:27,490 --> 00:04:34,840
organization<font color="#E5E5E5"> the key length key type the</font>

87
00:04:30,940 --> 00:04:37,420
signature algorithm<font color="#E5E5E5"> in general there</font><font color="#CCCCCC"> are</font>

88
00:04:34,840 --> 00:04:40,919
there can be<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know more fields for</font>

89
00:04:37,420 --> 00:04:40,920
the issue or including all<font color="#E5E5E5"> these fields</font>

90
00:04:41,640 --> 00:04:49,530
<font color="#E5E5E5">so far I mean so far doesn't</font><font color="#CCCCCC"> look very</font>

91
00:04:44,320 --> 00:04:55,090
<font color="#E5E5E5">bad some names that don't look terrible</font>

92
00:04:49,530 --> 00:04:58,690
if<font color="#E5E5E5"> you look at the</font><font color="#CCCCCC"> dates the issuing and</font>

93
00:04:55,090 --> 00:05:01,570
end dates<font color="#E5E5E5"> this is a large</font><font color="#CCCCCC"> there is a</font>

94
00:04:58,690 --> 00:05:04,210
large time span and this is usually

95
00:05:01,570 --> 00:05:06,460
uncommon for for regular<font color="#CCCCCC"> certs it can be</font>

96
00:05:04,210 --> 00:05:07,989
common for<font color="#E5E5E5"> route certs but this is like</font>

97
00:05:06,460 --> 00:05:09,430
certificate authority<font color="#CCCCCC"> route search this</font>

98
00:05:07,990 --> 00:05:15,150
<font color="#E5E5E5">is not a root search so there is</font>

99
00:05:09,430 --> 00:05:18,960
<font color="#E5E5E5">something might be might be malicious</font>

100
00:05:15,150 --> 00:05:21,400
another important<font color="#E5E5E5"> thing in insert is a</font>

101
00:05:18,960 --> 00:05:23,859
extensions<font color="#E5E5E5"> and these are</font><font color="#CCCCCC"> additional</font>

102
00:05:21,400 --> 00:05:25,840
fields<font color="#E5E5E5"> that can can can be present in an</font>

103
00:05:23,860 --> 00:05:30,490
assert I'm gonna zoom in<font color="#E5E5E5"> on the</font>

104
00:05:25,840 --> 00:05:32,409
extensions here<font color="#CCCCCC"> so this the ones that</font>

105
00:05:30,490 --> 00:05:35,410
are present in in<font color="#E5E5E5"> desserts or basic</font>

106
00:05:32,410 --> 00:05:38,500
constraints include<font color="#E5E5E5"> CA a flag this</font><font color="#CCCCCC"> a</font>

107
00:05:35,410 --> 00:05:39,970
certificate authority<font color="#CCCCCC"> there's there can</font>

108
00:05:38,500 --> 00:05:42,460
be another field<font color="#CCCCCC"> called path length</font>

109
00:05:39,970 --> 00:05:46,720
<font color="#E5E5E5">meaning how many certs can be authorized</font>

110
00:05:42,460 --> 00:05:50,530
in in a chain<font color="#E5E5E5"> the fields</font><font color="#CCCCCC"> 0 here I mean</font>

111
00:05:46,720 --> 00:05:52,750
it means that<font color="#CCCCCC"> this this constrain these</font>

112
00:05:50,530 --> 00:05:54,309
extensions are not<font color="#E5E5E5"> critical so each</font>

113
00:05:52,750 --> 00:05:59,530
<font color="#E5E5E5">extension can</font><font color="#CCCCCC"> be critical</font><font color="#E5E5E5"> or not</font>

114
00:05:54,310 --> 00:06:01,780
critical<font color="#E5E5E5"> key usage in this case that has</font>

115
00:05:59,530 --> 00:06:04,239
<font color="#E5E5E5">three three entries for key usage</font>

116
00:06:01,780 --> 00:06:07,659
<font color="#E5E5E5">extended key</font><font color="#CCCCCC"> usage this</font><font color="#E5E5E5"> is relevant</font>

117
00:06:04,240 --> 00:06:11,620
mostly for leaf certificates<font color="#E5E5E5"> and subject</font>

118
00:06:07,660 --> 00:06:12,510
alt name in this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> as the DNS</font><font color="#E5E5E5"> this</font>

119
00:06:11,620 --> 00:06:16,750
<font color="#E5E5E5">DNS</font>

120
00:06:12,510 --> 00:06:18,940
so other other extensions can<font color="#CCCCCC"> be present</font>

121
00:06:16,750 --> 00:06:22,810
in<font color="#E5E5E5"> addition to the ones that we see in</font>

122
00:06:18,940 --> 00:06:24,760
this certificate<font color="#E5E5E5"> including issuer alt</font>

123
00:06:22,810 --> 00:06:26,950
name subject alt name<font color="#CCCCCC"> Authority key</font>

124
00:06:24,760 --> 00:06:29,069
identifier certificate policies and so

125
00:06:26,950 --> 00:06:31,630
on

126
00:06:29,069 --> 00:06:37,630
as I mentioned each extension<font color="#E5E5E5"> can be</font>

127
00:06:31,630 --> 00:06:40,150
<font color="#E5E5E5">critical or</font><font color="#CCCCCC"> not critical to not talk a</font>

128
00:06:37,630 --> 00:06:41,949
little bit<font color="#CCCCCC"> about the Machine</font><font color="#E5E5E5"> machine</font>

129
00:06:40,150 --> 00:06:44,530
<font color="#CCCCCC">learning classification algorithms that</font>

130
00:06:41,949 --> 00:06:46,930
that we use so we<font color="#CCCCCC"> the basic</font><font color="#E5E5E5"> ideas we</font>

131
00:06:44,530 --> 00:06:49,960
want to build<font color="#CCCCCC"> a model trainer model</font>

132
00:06:46,930 --> 00:06:51,970
using<font color="#CCCCCC"> the data</font><font color="#E5E5E5"> using some algorithm and</font>

133
00:06:49,960 --> 00:06:54,419
after all<font color="#E5E5E5"> that we give it a certificate</font>

134
00:06:51,970 --> 00:06:58,930
it<font color="#CCCCCC"> will tell us if it's</font><font color="#E5E5E5"> malicious or not</font>

135
00:06:54,419 --> 00:07:01,448
<font color="#E5E5E5">so use these these algorithms well-known</font>

136
00:06:58,930 --> 00:07:03,490
algorithms<font color="#E5E5E5"> for classification</font><font color="#CCCCCC"> random</font>

137
00:07:01,449 --> 00:07:07,990
<font color="#CCCCCC">forests</font><font color="#E5E5E5"> logistic regression support</font>

138
00:07:03,490 --> 00:07:09,580
vector machine<font color="#E5E5E5"> and at any</font><font color="#CCCCCC"> point in this</font>

139
00:07:07,990 --> 00:07:11,830
work we can switch between the

140
00:07:09,580 --> 00:07:15,389
algorithms were not really<font color="#E5E5E5"> committed</font><font color="#CCCCCC"> to</font>

141
00:07:11,830 --> 00:07:17,560
any of them<font color="#E5E5E5"> however we compared the</font>

142
00:07:15,389 --> 00:07:19,449
accuracy and<font color="#E5E5E5"> in this case that the</font>

143
00:07:17,560 --> 00:07:23,789
performance we<font color="#E5E5E5"> mostly care about is a</font>

144
00:07:19,449 --> 00:07:27,970
false positive<font color="#CCCCCC"> rate and of the three</font>

145
00:07:23,789 --> 00:07:30,310
<font color="#E5E5E5">using the same data sets and the random</font>

146
00:07:27,970 --> 00:07:32,380
<font color="#CCCCCC">forest in this</font><font color="#E5E5E5"> case gives us better</font>

147
00:07:30,310 --> 00:07:35,889
false positive rate lower false positive

148
00:07:32,380 --> 00:07:38,770
rate<font color="#E5E5E5"> so 0.3 percent I'll get into the</font>

149
00:07:35,889 --> 00:07:41,020
details<font color="#CCCCCC"> later 0.3 percent compared to</font>

150
00:07:38,770 --> 00:07:43,780
<font color="#E5E5E5">0.5 percent percent for logistic</font>

151
00:07:41,020 --> 00:07:48,609
<font color="#CCCCCC">regression and</font><font color="#E5E5E5"> 0.7 percent for support</font>

152
00:07:43,780 --> 00:07:51,638
<font color="#CCCCCC">vector machines in addition this</font><font color="#E5E5E5"> is</font>

153
00:07:48,610 --> 00:07:53,409
important<font color="#CCCCCC"> so in addition to the</font><font color="#E5E5E5"> to the</font>

154
00:07:51,639 --> 00:07:56,259
<font color="#E5E5E5">data set that we use for training</font><font color="#CCCCCC"> the</font>

155
00:07:53,409 --> 00:07:58,270
label data set<font color="#E5E5E5"> we want to test how the</font>

156
00:07:56,259 --> 00:08:02,050
classifier does in the wild<font color="#E5E5E5"> so we</font>

157
00:07:58,270 --> 00:08:04,389
collect data<font color="#E5E5E5"> from some</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> and we</font>

158
00:08:02,050 --> 00:08:06,639
test it on that<font color="#E5E5E5"> network so real network</font>

159
00:08:04,389 --> 00:08:10,509
<font color="#E5E5E5">not related at all to the training data</font>

160
00:08:06,639 --> 00:08:12,130
and we we test the algorithm there<font color="#E5E5E5"> just</font>

161
00:08:10,509 --> 00:08:14,440
to<font color="#E5E5E5"> check</font><font color="#CCCCCC"> the sanity</font><font color="#E5E5E5"> because it might</font>

162
00:08:12,130 --> 00:08:16,060
work<font color="#E5E5E5"> for the data set that we have but</font>

163
00:08:14,440 --> 00:08:21,639
then when<font color="#E5E5E5"> we put it in the wild</font><font color="#CCCCCC"> it might</font>

164
00:08:16,060 --> 00:08:24,210
go crazy<font color="#E5E5E5"> and gives a lot of alerts so</font>

165
00:08:21,639 --> 00:08:30,940
for the rest of the of the presentation

166
00:08:24,210 --> 00:08:34,419
<font color="#CCCCCC">I'm gonna be using random forests so a</font>

167
00:08:30,940 --> 00:08:37,630
few words<font color="#E5E5E5"> about random</font><font color="#CCCCCC"> forests it's an</font>

168
00:08:34,419 --> 00:08:40,448
ensemble<font color="#E5E5E5"> of decision trees so what's a</font>

169
00:08:37,630 --> 00:08:42,760
decision tree<font color="#CCCCCC"> this is an example</font><font color="#E5E5E5"> of a</font>

170
00:08:40,448 --> 00:08:45,550
decision<font color="#CCCCCC"> tree that I got on a car too</font>

171
00:08:42,760 --> 00:08:47,319
that I got from Wikipedia<font color="#E5E5E5"> unfortunately</font>

172
00:08:45,550 --> 00:08:53,140
it's<font color="#E5E5E5"> not it's not a happy one</font>

173
00:08:47,320 --> 00:08:54,880
it's a classification for<font color="#E5E5E5"> passengers</font>

174
00:08:53,140 --> 00:09:00,899
whether they survived or do they didn't

175
00:08:54,880 --> 00:09:00,899
survive the Titanic<font color="#E5E5E5"> so not exactly happy</font>

176
00:09:01,170 --> 00:09:12,640
<font color="#E5E5E5">and it goes</font><font color="#CCCCCC"> like this you know is the</font>

177
00:09:05,860 --> 00:09:15,540
<font color="#E5E5E5">passenger a male if if no</font><font color="#CCCCCC"> you have you</font>

178
00:09:12,640 --> 00:09:22,209
have a high probability of surviving

179
00:09:15,540 --> 00:09:25,420
0.73<font color="#CCCCCC"> 73% chance</font><font color="#E5E5E5"> of surviving if yes</font><font color="#CCCCCC"> you</font>

180
00:09:22,209 --> 00:09:28,319
go down you<font color="#E5E5E5"> look at another feature or</font>

181
00:09:25,420 --> 00:09:35,670
another property<font color="#E5E5E5"> of the passenger and</font>

182
00:09:28,320 --> 00:09:40,660
<font color="#E5E5E5">they age so I can see it greater than</font>

183
00:09:35,670 --> 00:09:44,110
<font color="#CCCCCC">9.5</font><font color="#E5E5E5"> if yes then you have a very high</font>

184
00:09:40,660 --> 00:09:47,829
chance of not surviving<font color="#E5E5E5"> here you know if</font>

185
00:09:44,110 --> 00:09:49,360
yes if no then<font color="#E5E5E5"> you go down furthermore</font>

186
00:09:47,829 --> 00:09:54,069
<font color="#CCCCCC">you</font><font color="#E5E5E5"> need to you need more information</font>

187
00:09:49,360 --> 00:09:57,310
you<font color="#E5E5E5"> look at at another attribute or</font>

188
00:09:54,070 --> 00:09:59,350
another property<font color="#E5E5E5"> and in this case it's a</font>

189
00:09:57,310 --> 00:10:02,649
number<font color="#CCCCCC"> of family members and you go yes</font>

190
00:09:59,350 --> 00:10:05,499
or no so

191
00:10:02,649 --> 00:10:06,610
this is a this<font color="#CCCCCC"> is a decision</font><font color="#E5E5E5"> tree now</font>

192
00:10:05,499 --> 00:10:08,139
you want<font color="#E5E5E5"> to build the decision</font>

193
00:10:06,610 --> 00:10:09,819
<font color="#E5E5E5">three-year</font><font color="#CCCCCC"> so you want to</font><font color="#E5E5E5"> determine what</font>

194
00:10:08,139 --> 00:10:12,189
what features<font color="#CCCCCC"> you look at and what</font>

195
00:10:09,819 --> 00:10:14,349
<font color="#CCCCCC">features you</font><font color="#E5E5E5"> decide on and the split and</font>

196
00:10:12,189 --> 00:10:17,529
this<font color="#E5E5E5"> is done</font><font color="#CCCCCC"> basically</font><font color="#E5E5E5"> this is done</font>

197
00:10:14,350 --> 00:10:19,300
<font color="#E5E5E5">using information</font><font color="#CCCCCC"> gained so you did you</font>

198
00:10:17,529 --> 00:10:20,889
first you give you look at the feature

199
00:10:19,300 --> 00:10:23,050
<font color="#E5E5E5">that gives you the highest information</font>

200
00:10:20,889 --> 00:10:27,399
gained from<font color="#CCCCCC"> the split which</font><font color="#E5E5E5"> is in this</font>

201
00:10:23,050 --> 00:10:29,740
<font color="#E5E5E5">case</font><font color="#CCCCCC"> the gender</font><font color="#E5E5E5"> and you go down by the</font>

202
00:10:27,399 --> 00:10:34,839
end of the training<font color="#E5E5E5"> you you you build</font>

203
00:10:29,740 --> 00:10:36,459
multiple trees and then which which

204
00:10:34,839 --> 00:10:38,769
gives you<font color="#CCCCCC"> your random</font><font color="#E5E5E5"> forest which is an</font>

205
00:10:36,459 --> 00:10:40,779
ensemble<font color="#CCCCCC"> of trees</font><font color="#E5E5E5"> so by that's by the</font>

206
00:10:38,769 --> 00:10:43,629
end of<font color="#E5E5E5"> the training and then you have a</font>

207
00:10:40,779 --> 00:10:46,149
new certificate<font color="#CCCCCC"> you pass</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> through all</font>

208
00:10:43,629 --> 00:10:47,679
these trees<font color="#E5E5E5"> and the decision you look at</font>

209
00:10:46,149 --> 00:10:49,269
the decision of each tree and you look

210
00:10:47,679 --> 00:10:56,699
at the average and it tells you if<font color="#E5E5E5"> it's</font>

211
00:10:49,269 --> 00:10:59,499
better if it's malicious or<font color="#E5E5E5"> not we use</font>

212
00:10:56,699 --> 00:11:02,069
<font color="#CCCCCC">why you're widely used well-known</font>

213
00:10:59,499 --> 00:11:05,920
psychic<font color="#E5E5E5"> learn Python library and this</font>

214
00:11:02,069 --> 00:11:07,990
this these calculations<font color="#E5E5E5"> are</font><font color="#CCCCCC"> not highly</font>

215
00:11:05,920 --> 00:11:10,689
demanding we do that on I do that on<font color="#E5E5E5"> my</font>

216
00:11:07,990 --> 00:11:13,029
laptop my laptop so that's part of why

217
00:11:10,689 --> 00:11:15,819
we say in your spare time<font color="#CCCCCC"> it's not</font>

218
00:11:13,029 --> 00:11:18,339
finally it's<font color="#E5E5E5"> not highly demanding I'm</font>

219
00:11:15,819 --> 00:11:22,839
gonna get into the core of<font color="#E5E5E5"> the of the</font>

220
00:11:18,339 --> 00:11:25,660
work and look at<font color="#E5E5E5"> the results the first</font>

221
00:11:22,839 --> 00:11:27,910
<font color="#E5E5E5">step is we</font><font color="#CCCCCC"> have the certificate we have</font>

222
00:11:25,660 --> 00:11:29,499
the attributes how do you you what do

223
00:11:27,910 --> 00:11:31,870
you use from<font color="#E5E5E5"> these attributes you can't</font>

224
00:11:29,499 --> 00:11:33,970
just give the certificate as it is so we

225
00:11:31,870 --> 00:11:36,879
<font color="#CCCCCC">want to get</font><font color="#E5E5E5"> obtain or extract</font>

226
00:11:33,970 --> 00:11:38,499
information<font color="#CCCCCC"> in some form or</font><font color="#E5E5E5"> some</font>

227
00:11:36,879 --> 00:11:43,149
representation<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the of these</font>

228
00:11:38,499 --> 00:11:45,819
attributes<font color="#E5E5E5"> so we have these general</font>

229
00:11:43,149 --> 00:11:50,980
guidelines<font color="#CCCCCC"> or general options a general</font>

230
00:11:45,819 --> 00:11:52,748
feature<font color="#E5E5E5"> let's say issuer country we have</font>

231
00:11:50,980 --> 00:11:54,939
these options<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> use just the value</font>

232
00:11:52,749 --> 00:11:57,910
as it is<font color="#E5E5E5"> issuer countries the US for</font>

233
00:11:54,939 --> 00:11:59,860
<font color="#CCCCCC">example or present or absent</font><font color="#E5E5E5"> there is no</font>

234
00:11:57,910 --> 00:12:02,469
<font color="#CCCCCC">actual country this can be another you</font>

235
00:11:59,860 --> 00:12:04,480
know<font color="#E5E5E5"> another way to encode this length</font>

236
00:12:02,470 --> 00:12:06,610
of<font color="#E5E5E5"> a string value this is useful in</font><font color="#CCCCCC"> the</font>

237
00:12:04,480 --> 00:12:08,350
<font color="#E5E5E5">case of the serial number because the</font>

238
00:12:06,610 --> 00:12:15,170
serial number by itself doesn't<font color="#E5E5E5"> really</font>

239
00:12:08,350 --> 00:12:17,720
mean much<font color="#E5E5E5"> so the extensions are</font><font color="#CCCCCC"> similar</font>

240
00:12:15,170 --> 00:12:20,439
you know<font color="#E5E5E5"> one option is just</font><font color="#CCCCCC"> to look if</font>

241
00:12:17,720 --> 00:12:23,300
the<font color="#CCCCCC"> the extension is present or absent</font>

242
00:12:20,440 --> 00:12:25,220
<font color="#CCCCCC">crit critical or not critical for some</font>

243
00:12:23,300 --> 00:12:27,740
extensions we dig deeper and<font color="#CCCCCC"> we look at</font>

244
00:12:25,220 --> 00:12:30,050
the values most extensions have multiple

245
00:12:27,740 --> 00:12:33,680
values<font color="#E5E5E5"> so we dig deeper and</font><font color="#CCCCCC"> we look at</font>

246
00:12:30,050 --> 00:12:35,180
the specific<font color="#CCCCCC"> values</font><font color="#E5E5E5"> and for some</font>

247
00:12:33,680 --> 00:12:37,339
extensions we look at the number<font color="#CCCCCC"> of</font>

248
00:12:35,180 --> 00:12:41,290
values<font color="#E5E5E5"> number of subject</font><font color="#CCCCCC"> alt names</font>

249
00:12:37,339 --> 00:12:45,079
number of<font color="#CCCCCC"> issuer alt names and and so</font><font color="#E5E5E5"> on</font>

250
00:12:41,290 --> 00:12:47,209
<font color="#E5E5E5">can I get here into into this feature</font>

251
00:12:45,079 --> 00:12:51,859
extraction from from attributes into

252
00:12:47,209 --> 00:12:53,420
<font color="#E5E5E5">some detail</font><font color="#CCCCCC"> and this is mainly this is</font>

253
00:12:51,860 --> 00:12:55,310
<font color="#E5E5E5">basically the bulk of the work the</font>

254
00:12:53,420 --> 00:12:57,589
algorithms are<font color="#CCCCCC"> well</font><font color="#E5E5E5"> known or well</font>

255
00:12:55,310 --> 00:12:59,388
established<font color="#E5E5E5"> and the bulk of the work is</font>

256
00:12:57,589 --> 00:13:01,370
are actually two<font color="#E5E5E5"> parts obtaining the</font>

257
00:12:59,389 --> 00:13:05,209
malicious certificates and doing the

258
00:13:01,370 --> 00:13:06,829
feature feature extraction the serial

259
00:13:05,209 --> 00:13:08,300
number we<font color="#E5E5E5"> use the length of the serial</font>

260
00:13:06,829 --> 00:13:09,829
number the value<font color="#CCCCCC"> of the serial number</font>

261
00:13:08,300 --> 00:13:11,870
does it<font color="#E5E5E5"> doesn't mean</font><font color="#CCCCCC"> much you know if</font>

262
00:13:09,829 --> 00:13:13,489
two serial numbers are close to that

263
00:13:11,870 --> 00:13:17,899
that<font color="#E5E5E5"> doesn't mean that there is</font>

264
00:13:13,490 --> 00:13:19,430
similarity<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> use the length of the</font>

265
00:13:17,899 --> 00:13:22,190
serial number basically<font color="#E5E5E5"> because there is</font>

266
00:13:19,430 --> 00:13:25,310
a correlation between<font color="#E5E5E5"> the certificate</font>

267
00:13:22,190 --> 00:13:27,230
authority and the pattern between<font color="#CCCCCC"> this</font>

268
00:13:25,310 --> 00:13:29,180
<font color="#CCCCCC">very length of the serial number so</font>

269
00:13:27,230 --> 00:13:31,130
there is some<font color="#CCCCCC"> information they're</font>

270
00:13:29,180 --> 00:13:32,899
issuing and end dates how do you use

271
00:13:31,130 --> 00:13:35,269
<font color="#CCCCCC">that we use</font><font color="#E5E5E5"> the validity periods in</font>

272
00:13:32,899 --> 00:13:37,970
period in years<font color="#CCCCCC"> like the certificate we</font>

273
00:13:35,269 --> 00:13:40,670
saw it has a validity<font color="#E5E5E5"> period of 12 so</font>

274
00:13:37,970 --> 00:13:43,730
<font color="#E5E5E5">that's a feature</font><font color="#CCCCCC"> 12 and whether if it is</font>

275
00:13:40,670 --> 00:13:46,640
<font color="#CCCCCC">whether it's</font><font color="#E5E5E5"> expired or not the version</font>

276
00:13:43,730 --> 00:13:49,300
<font color="#E5E5E5">of the certificate</font><font color="#CCCCCC"> can be</font><font color="#E5E5E5"> 2</font><font color="#CCCCCC"> 3 etc</font><font color="#E5E5E5"> we use</font>

277
00:13:46,640 --> 00:13:54,920
the value of the version the key<font color="#E5E5E5"> length</font>

278
00:13:49,300 --> 00:13:57,079
<font color="#CCCCCC">it says specific values 2048 and so on</font>

279
00:13:54,920 --> 00:13:59,149
so we<font color="#CCCCCC"> use the value itself</font><font color="#E5E5E5"> key type</font>

280
00:13:57,079 --> 00:14:02,420
similarly signature algorithm we<font color="#CCCCCC"> use the</font>

281
00:13:59,149 --> 00:14:04,310
value itself<font color="#CCCCCC"> extensions</font><font color="#E5E5E5"> the whole set as</font>

282
00:14:02,420 --> 00:14:07,370
a set we use<font color="#E5E5E5"> the number</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> extensions</font>

283
00:14:04,310 --> 00:14:09,500
and which extensions are or whether

284
00:14:07,370 --> 00:14:11,569
there<font color="#CCCCCC"> are extensions</font><font color="#E5E5E5"> or not there is</font>

285
00:14:09,500 --> 00:14:14,930
some redundancy<font color="#E5E5E5"> here but the main idea</font>

286
00:14:11,569 --> 00:14:17,689
<font color="#CCCCCC">is use known number of extensions each</font>

287
00:14:14,930 --> 00:14:20,479
of the extensions the the encoding take

288
00:14:17,690 --> 00:14:22,279
<font color="#CCCCCC">3</font><font color="#E5E5E5"> different values if it's absent</font>

289
00:14:20,480 --> 00:14:25,190
<font color="#CCCCCC">extension is</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> their present and</font>

290
00:14:22,279 --> 00:14:27,410
critical and present are<font color="#CCCCCC"> not critical so</font>

291
00:14:25,190 --> 00:14:29,470
it can take<font color="#E5E5E5"> 3 3 values for it for each</font>

292
00:14:27,410 --> 00:14:32,420
<font color="#E5E5E5">of the extension</font>

293
00:14:29,470 --> 00:14:34,400
we need for some extensions<font color="#E5E5E5"> this is a</font>

294
00:14:32,420 --> 00:14:38,000
general one for some extensions we dig

295
00:14:34,400 --> 00:14:38,779
deeper we look at the number of<font color="#E5E5E5"> subject</font>

296
00:14:38,000 --> 00:14:41,060
<font color="#CCCCCC">alt names</font>

297
00:14:38,779 --> 00:14:44,120
we look at the number of issuer out

298
00:14:41,060 --> 00:14:48,650
names<font color="#E5E5E5"> key</font><font color="#CCCCCC"> usage has a specific set of</font>

299
00:14:44,120 --> 00:14:51,050
values<font color="#E5E5E5"> and any of these values</font><font color="#CCCCCC"> can be</font>

300
00:14:48,650 --> 00:14:54,439
present or absent<font color="#CCCCCC"> so we look at each</font>

301
00:14:51,050 --> 00:14:57,260
value like for example digit digital

302
00:14:54,440 --> 00:14:58,880
signature<font color="#E5E5E5"> so if it's there it takes a</font>

303
00:14:57,260 --> 00:15:04,279
value<font color="#CCCCCC"> one if it's</font><font color="#E5E5E5"> not there takes a</font>

304
00:14:58,880 --> 00:15:06,380
value<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> other values and</font><font color="#CCCCCC"> cypher wrong</font>

305
00:15:04,279 --> 00:15:08,450
and so<font color="#CCCCCC"> on for further four I</font><font color="#E5E5E5"> think there</font>

306
00:15:06,380 --> 00:15:11,480
<font color="#E5E5E5">is a set of nine values yeah</font>

307
00:15:08,450 --> 00:15:15,350
extended key usage similarly<font color="#E5E5E5"> similar to</font>

308
00:15:11,480 --> 00:15:18,529
that<font color="#CCCCCC"> Authority key identifier we use</font>

309
00:15:15,350 --> 00:15:21,080
that<font color="#E5E5E5"> value</font><font color="#CCCCCC"> as it is</font><font color="#E5E5E5"> because in principle</font>

310
00:15:18,529 --> 00:15:23,630
<font color="#CCCCCC">there is a limited number of certificate</font>

311
00:15:21,080 --> 00:15:25,910
authorities so<font color="#CCCCCC"> that the value set is not</font>

312
00:15:23,630 --> 00:15:32,480
overwhelming<font color="#E5E5E5"> so you we can use the value</font>

313
00:15:25,910 --> 00:15:37,670
<font color="#CCCCCC">in principle the the</font><font color="#E5E5E5"> subject and issuer</font>

314
00:15:32,480 --> 00:15:40,640
fields the the issuer country we use the

315
00:15:37,670 --> 00:15:43,670
value as it is so US Japan China<font color="#E5E5E5"> each</font>

316
00:15:40,640 --> 00:15:45,620
other<font color="#E5E5E5"> whether it's</font><font color="#CCCCCC"> valid or</font><font color="#E5E5E5"> not this is</font>

317
00:15:43,670 --> 00:15:47,750
another feature<font color="#E5E5E5"> we see sometimes values</font>

318
00:15:45,620 --> 00:15:50,060
like<font color="#CCCCCC"> xx</font><font color="#E5E5E5"> dash dash and so on these</font><font color="#CCCCCC"> are</font>

319
00:15:47,750 --> 00:15:53,630
not<font color="#E5E5E5"> valid kind of valid countries so we</font>

320
00:15:50,060 --> 00:15:56,359
use that<font color="#E5E5E5"> as a feature as well for all</font>

321
00:15:53,630 --> 00:16:00,350
<font color="#E5E5E5">other issuer fields we use values</font>

322
00:15:56,360 --> 00:16:03,710
because you know there is a it's a less

323
00:16:00,350 --> 00:16:06,620
it's a more restricted set of of fields

324
00:16:03,710 --> 00:16:08,210
than than the<font color="#E5E5E5"> subject values for the</font>

325
00:16:06,620 --> 00:16:11,180
subject values we use<font color="#E5E5E5"> the country</font>

326
00:16:08,210 --> 00:16:13,580
<font color="#E5E5E5">similarly to the issuer country value</font>

327
00:16:11,180 --> 00:16:16,180
<font color="#E5E5E5">and whether it's valid</font><font color="#CCCCCC"> or not</font><font color="#E5E5E5"> the other</font>

328
00:16:13,580 --> 00:16:21,050
fields because there is a large<font color="#E5E5E5"> set so</font>

329
00:16:16,180 --> 00:16:23,359
it can be anything<font color="#E5E5E5"> anywhere we use we</font>

330
00:16:21,050 --> 00:16:30,560
use<font color="#CCCCCC"> the values of the the encoding is if</font>

331
00:16:23,360 --> 00:16:34,040
it's absent or present so<font color="#CCCCCC"> 0 or 1 now</font><font color="#E5E5E5"> all</font>

332
00:16:30,560 --> 00:16:35,839
this are still we're<font color="#E5E5E5"> still not ready to</font>

333
00:16:34,040 --> 00:16:38,180
<font color="#E5E5E5">give</font><font color="#CCCCCC"> to the to the machine learning</font>

334
00:16:35,839 --> 00:16:40,960
algorithm we have to do a little<font color="#E5E5E5"> more a</font>

335
00:16:38,180 --> 00:16:45,380
little<font color="#CCCCCC"> more encoding</font>

336
00:16:40,960 --> 00:16:47,870
so this is a small set let's say you

337
00:16:45,380 --> 00:16:52,070
have a<font color="#E5E5E5"> small data set for training set</font>

338
00:16:47,870 --> 00:16:55,250
and you<font color="#CCCCCC"> collect the values</font><font color="#E5E5E5"> and this is</font>

339
00:16:52,070 --> 00:16:57,290
the this<font color="#CCCCCC"> is basically the universe the</font>

340
00:16:55,250 --> 00:17:00,710
the feature<font color="#E5E5E5"> space that you end up with</font>

341
00:16:57,290 --> 00:17:02,240
so you have some certificates with

342
00:17:00,710 --> 00:17:05,209
<font color="#CCCCCC">issuer country China</font>

343
00:17:02,240 --> 00:17:09,140
US Japan<font color="#CCCCCC"> some certificates with version</font>

344
00:17:05,209 --> 00:17:11,809
2<font color="#E5E5E5"> version 3 lengths of serial number 3 7</font>

345
00:17:09,140 --> 00:17:14,630
<font color="#E5E5E5">some certificates have key usage is</font>

346
00:17:11,809 --> 00:17:16,579
critical some have this value digital

347
00:17:14,630 --> 00:17:20,179
signature in usage and so<font color="#E5E5E5"> on so this is</font>

348
00:17:16,579 --> 00:17:24,139
<font color="#CCCCCC">a small subset</font><font color="#E5E5E5"> if we look at one</font><font color="#CCCCCC"> of</font>

349
00:17:20,179 --> 00:17:27,050
these certificates it will be a set of

350
00:17:24,140 --> 00:17:28,760
it will be a vector of<font color="#CCCCCC"> 0s and</font><font color="#E5E5E5"> 1 in this</font>

351
00:17:27,050 --> 00:17:33,080
case<font color="#CCCCCC"> the certificate has issuer country</font>

352
00:17:28,760 --> 00:17:35,870
you as it has version 3<font color="#E5E5E5"> it has 7 as the</font>

353
00:17:33,080 --> 00:17:40,520
length of<font color="#E5E5E5"> the serial number and and so</font>

354
00:17:35,870 --> 00:17:44,090
<font color="#E5E5E5">on so we take this numerical vector 0 0</font>

355
00:17:40,520 --> 00:17:45,950
<font color="#CCCCCC">or zeros and ones</font><font color="#E5E5E5"> and we feed it to the</font>

356
00:17:44,090 --> 00:17:48,830
machine<font color="#CCCCCC"> learning algorithm that we</font>

357
00:17:45,950 --> 00:17:51,320
<font color="#E5E5E5">trained and with it will tell us if it's</font>

358
00:17:48,830 --> 00:17:54,199
if it's malicious<font color="#E5E5E5"> or not so basically</font>

359
00:17:51,320 --> 00:17:57,530
this is<font color="#E5E5E5"> the the well-known machine</font>

360
00:17:54,200 --> 00:18:03,710
learning pipeline with details related

361
00:17:57,530 --> 00:18:09,830
to<font color="#E5E5E5"> our work on on on certificates now we</font>

362
00:18:03,710 --> 00:18:12,860
start looking at some results<font color="#CCCCCC"> what were</font>

363
00:18:09,830 --> 00:18:15,770
mainly concerned<font color="#CCCCCC"> with our to false</font>

364
00:18:12,860 --> 00:18:18,139
positive and false negative rates with

365
00:18:15,770 --> 00:18:19,300
more in<font color="#E5E5E5"> more emphasis on false positive</font>

366
00:18:18,140 --> 00:18:24,559
rates

367
00:18:19,300 --> 00:18:27,980
I'll explain why<font color="#E5E5E5"> so I as I mentioned</font>

368
00:18:24,559 --> 00:18:31,280
<font color="#CCCCCC">before the data set has</font><font color="#E5E5E5"> 13,000 that we</font>

369
00:18:27,980 --> 00:18:35,150
use here<font color="#E5E5E5"> it has</font><font color="#CCCCCC"> 13,000 200 certs</font><font color="#E5E5E5"> and in</font>

370
00:18:31,280 --> 00:18:38,420
the<font color="#E5E5E5"> data set and</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> do the</font><font color="#CCCCCC"> Train test</font>

371
00:18:35,150 --> 00:18:40,700
plate<font color="#E5E5E5"> 80 20 meaning we use with sample</font>

372
00:18:38,420 --> 00:18:43,370
<font color="#CCCCCC">80</font><font color="#E5E5E5"> percent of these certificates we use</font>

373
00:18:40,700 --> 00:18:46,040
that as<font color="#E5E5E5"> at our trainings the data set we</font>

374
00:18:43,370 --> 00:18:50,110
train the model<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> use the</font>

375
00:18:46,040 --> 00:18:52,560
<font color="#E5E5E5">remaining 20% of the certs for testing</font>

376
00:18:50,110 --> 00:18:54,659
the

377
00:18:52,560 --> 00:18:58,070
we look at these<font color="#CCCCCC"> two measures a false</font>

378
00:18:54,660 --> 00:19:01,260
positive<font color="#CCCCCC"> rate</font><font color="#E5E5E5"> meaning the ones that</font>

379
00:18:58,070 --> 00:19:06,450
<font color="#E5E5E5">classifier says they are positive there</font>

380
00:19:01,260 --> 00:19:09,960
are malicious out of the the<font color="#E5E5E5"> number out</font>

381
00:19:06,450 --> 00:19:13,260
of<font color="#E5E5E5"> the number that we have that are that</font>

382
00:19:09,960 --> 00:19:15,570
<font color="#CCCCCC">are negative they're benign meaning that</font>

383
00:19:13,260 --> 00:19:19,020
<font color="#E5E5E5">it classified them as wrongly as as</font>

384
00:19:15,570 --> 00:19:20,610
positive and this<font color="#E5E5E5"> sealed the number of</font>

385
00:19:19,020 --> 00:19:23,490
the negative is the ones<font color="#E5E5E5"> that are</font><font color="#CCCCCC"> truly</font>

386
00:19:20,610 --> 00:19:24,810
<font color="#CCCCCC">they're</font><font color="#E5E5E5"> classified as negative through</font>

387
00:19:23,490 --> 00:19:27,690
<font color="#CCCCCC">negative and the ones</font><font color="#E5E5E5"> that are</font>

388
00:19:24,810 --> 00:19:29,850
classified<font color="#CCCCCC"> as positive for the false</font>

389
00:19:27,690 --> 00:19:32,280
negative rate is<font color="#E5E5E5"> very similar but you</font>

390
00:19:29,850 --> 00:19:34,500
know the mirror image meaning the

391
00:19:32,280 --> 00:19:36,210
numbers that work the number that number

392
00:19:34,500 --> 00:19:39,630
<font color="#E5E5E5">of certificates that</font><font color="#CCCCCC"> were classified as</font>

393
00:19:36,210 --> 00:19:45,750
<font color="#E5E5E5">as negative meaning benign over the</font>

394
00:19:39,630 --> 00:19:49,710
<font color="#CCCCCC">total number of positive deserts so we</font>

395
00:19:45,750 --> 00:19:52,410
value<font color="#E5E5E5"> one this is random</font><font color="#CCCCCC"> forests</font><font color="#E5E5E5"> and it</font>

396
00:19:49,710 --> 00:19:54,570
gives us<font color="#E5E5E5"> a probability and</font><font color="#CCCCCC"> we vary the</font>

397
00:19:52,410 --> 00:19:56,970
probability threshold<font color="#CCCCCC"> like</font><font color="#E5E5E5"> where where</font>

398
00:19:54,570 --> 00:20:00,689
do we set the<font color="#E5E5E5"> threshold where</font><font color="#CCCCCC"> we decide</font>

399
00:19:56,970 --> 00:20:02,280
it's malicious<font color="#E5E5E5"> or not meaning so if we</font>

400
00:20:00,690 --> 00:20:05,520
increase<font color="#CCCCCC"> this pro this probability</font>

401
00:20:02,280 --> 00:20:09,149
<font color="#CCCCCC">threshold from 0.5 to 0.9 meaning that</font>

402
00:20:05,520 --> 00:20:13,230
<font color="#E5E5E5">we want to be more sure</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the that</font>

403
00:20:09,150 --> 00:20:17,370
the certificate is malicious<font color="#E5E5E5"> the false</font>

404
00:20:13,230 --> 00:20:20,880
positive rate<font color="#CCCCCC"> as expected will decrease</font>

405
00:20:17,370 --> 00:20:25,189
<font color="#E5E5E5">from</font><font color="#CCCCCC"> 0.3% so this is multiplied by 100</font>

406
00:20:20,880 --> 00:20:30,720
<font color="#E5E5E5">and this is percentage so 0.3% to 0.1%</font>

407
00:20:25,190 --> 00:20:33,540
<font color="#E5E5E5">the false negative rate will increase as</font>

408
00:20:30,720 --> 00:20:35,250
we increase this because you know we

409
00:20:33,540 --> 00:20:38,220
want to be more<font color="#CCCCCC"> sure so we</font><font color="#E5E5E5"> missed some</font>

410
00:20:35,250 --> 00:20:39,750
certificates that<font color="#CCCCCC"> are you know looked</font>

411
00:20:38,220 --> 00:20:41,600
malicious<font color="#E5E5E5"> but not they don't look</font><font color="#CCCCCC"> very</font>

412
00:20:39,750 --> 00:20:45,690
malicious the probability is let's say

413
00:20:41,600 --> 00:20:48,570
0.5<font color="#E5E5E5"> 0.6 so we miss these and false</font>

414
00:20:45,690 --> 00:20:52,860
negative rate increases so this

415
00:20:48,570 --> 00:20:55,409
<font color="#CCCCCC">trade-off</font><font color="#E5E5E5"> is is there and you have to</font>

416
00:20:52,860 --> 00:20:59,879
decide<font color="#E5E5E5"> which which one you care about</font>

417
00:20:55,410 --> 00:21:01,320
more in our<font color="#E5E5E5"> case we we care</font><font color="#CCCCCC"> about the</font>

418
00:20:59,880 --> 00:21:03,720
false positive rate because there<font color="#E5E5E5"> is a</font>

419
00:21:01,320 --> 00:21:06,300
large number<font color="#CCCCCC"> of benign certificates</font><font color="#E5E5E5"> and</font>

420
00:21:03,720 --> 00:21:08,820
if the false positive rate is

421
00:21:06,300 --> 00:21:10,879
it will give you a lot<font color="#CCCCCC"> of warnings or a</font>

422
00:21:08,820 --> 00:21:13,560
lot of malicious certificates that are

423
00:21:10,880 --> 00:21:15,290
are<font color="#E5E5E5"> not actually malicious so you will</font>

424
00:21:13,560 --> 00:21:20,970
be you will<font color="#CCCCCC"> be overwhelmed by</font><font color="#E5E5E5"> the number</font>

425
00:21:15,290 --> 00:21:27,149
so so this<font color="#E5E5E5"> is the this</font><font color="#CCCCCC"> is the these are</font>

426
00:21:20,970 --> 00:21:30,840
numbers we get<font color="#E5E5E5"> 0.1 percent</font><font color="#CCCCCC"> 5%</font><font color="#E5E5E5"> and can</font>

427
00:21:27,150 --> 00:21:33,690
say a<font color="#E5E5E5"> few words what what that means 0.1</font>

428
00:21:30,840 --> 00:21:36,689
<font color="#E5E5E5">percent means that false positive rate</font>

429
00:21:33,690 --> 00:21:40,080
means that if you<font color="#E5E5E5"> have a thousand benign</font>

430
00:21:36,690 --> 00:21:42,300
<font color="#CCCCCC">cert</font><font color="#E5E5E5"> you will get one cert that's that</font>

431
00:21:40,080 --> 00:21:44,580
is<font color="#E5E5E5"> the the classifier will tell you out</font>

432
00:21:42,300 --> 00:21:46,740
of<font color="#CCCCCC"> these</font><font color="#E5E5E5"> 1000 benign certs</font><font color="#CCCCCC"> to 12</font><font color="#E5E5E5"> it will</font>

433
00:21:44,580 --> 00:21:51,659
tell you that<font color="#E5E5E5"> this is malicious out of</font>

434
00:21:46,740 --> 00:21:55,650
<font color="#CCCCCC">1,000 so for that you will miss so odd</font>

435
00:21:51,660 --> 00:21:58,470
<font color="#E5E5E5">for in return five percent means or five</font>

436
00:21:55,650 --> 00:21:59,970
point five percent means that out<font color="#E5E5E5"> of a</font>

437
00:21:58,470 --> 00:22:03,120
<font color="#E5E5E5">hundred benign out of</font><font color="#CCCCCC"> one hundred</font>

438
00:21:59,970 --> 00:22:04,920
<font color="#E5E5E5">malicious certs you will miss five or</font>

439
00:22:03,120 --> 00:22:08,399
<font color="#E5E5E5">six it will tell you it's not been</font>

440
00:22:04,920 --> 00:22:12,020
malicious<font color="#CCCCCC"> or</font><font color="#E5E5E5"> so this is the this is what</font>

441
00:22:08,400 --> 00:22:16,200
<font color="#E5E5E5">the numbers</font><font color="#CCCCCC"> mean and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a</font><font color="#E5E5E5"> trade off</font>

442
00:22:12,020 --> 00:22:17,940
as and as I mentioned before<font color="#E5E5E5"> it's it's</font>

443
00:22:16,200 --> 00:22:20,670
very<font color="#E5E5E5"> important that we test this on your</font>

444
00:22:17,940 --> 00:22:23,370
dependent real real data we collect<font color="#E5E5E5"> from</font>

445
00:22:20,670 --> 00:22:25,560
the field<font color="#E5E5E5"> make sure that it's these</font>

446
00:22:23,370 --> 00:22:30,780
results are<font color="#CCCCCC"> not just a property of the</font>

447
00:22:25,560 --> 00:22:37,020
of the data set that we have and the

448
00:22:30,780 --> 00:22:41,190
classifier works well in<font color="#E5E5E5"> the field so</font>

449
00:22:37,020 --> 00:22:44,250
the now the dependence of<font color="#E5E5E5"> the how does</font>

450
00:22:41,190 --> 00:22:46,860
<font color="#CCCCCC">this how do how do these results depend</font>

451
00:22:44,250 --> 00:22:49,770
on on the data set<font color="#E5E5E5"> size why we look at</font>

452
00:22:46,860 --> 00:22:52,350
that because<font color="#E5E5E5"> as I mentioned the number</font>

453
00:22:49,770 --> 00:22:54,480
<font color="#E5E5E5">of malicious</font><font color="#CCCCCC"> cells that we have is is an</font>

454
00:22:52,350 --> 00:22:56,040
issue<font color="#E5E5E5"> it's a we're bottlenecked on that</font>

455
00:22:54,480 --> 00:22:59,610
<font color="#CCCCCC">and want to</font><font color="#E5E5E5"> make sure that this doesn't</font>

456
00:22:56,040 --> 00:23:02,430
<font color="#E5E5E5">doesn't hurt us here I'm plotting the</font>

457
00:22:59,610 --> 00:23:04,590
false positive rate<font color="#CCCCCC"> and pick false</font>

458
00:23:02,430 --> 00:23:08,310
positive rate as a number of

459
00:23:04,590 --> 00:23:10,560
certificates<font color="#E5E5E5"> in in the data set so these</font>

460
00:23:08,310 --> 00:23:13,590
numbers two thousand four thousand etc

461
00:23:10,560 --> 00:23:16,560
we sampled them from the big<font color="#E5E5E5"> data set</font>

462
00:23:13,590 --> 00:23:18,870
which is<font color="#E5E5E5"> thirteen thousand certs we do</font>

463
00:23:16,560 --> 00:23:19,919
the same<font color="#E5E5E5"> with sample many times for each</font>

464
00:23:18,870 --> 00:23:22,320
sampling<font color="#E5E5E5"> we do the</font>

465
00:23:19,920 --> 00:23:24,690
test data split<font color="#E5E5E5"> also many times we</font>

466
00:23:22,320 --> 00:23:27,060
calculate<font color="#E5E5E5"> we calculate</font><font color="#CCCCCC"> these the false</font>

467
00:23:24,690 --> 00:23:29,550
positive rate and<font color="#E5E5E5"> which</font><font color="#CCCCCC"> care we</font>

468
00:23:27,060 --> 00:23:32,790
calculate the average<font color="#E5E5E5"> and unruly we get</font>

469
00:23:29,550 --> 00:23:35,730
this<font color="#CCCCCC"> result</font><font color="#E5E5E5"> and this is a probability</font>

470
00:23:32,790 --> 00:23:39,210
<font color="#E5E5E5">threshold</font><font color="#CCCCCC"> of 0.5</font><font color="#E5E5E5"> that we saw that we saw</font>

471
00:23:35,730 --> 00:23:42,840
before<font color="#CCCCCC"> in that table</font><font color="#E5E5E5"> it was the false</font>

472
00:23:39,210 --> 00:23:46,980
positive rate was<font color="#E5E5E5"> around 0.3%</font><font color="#CCCCCC"> so at the</font>

473
00:23:42,840 --> 00:23:49,470
beginning<font color="#E5E5E5"> for a small data set the false</font>

474
00:23:46,980 --> 00:23:53,010
positive rate is high<font color="#E5E5E5"> and it decreases</font>

475
00:23:49,470 --> 00:23:54,870
<font color="#CCCCCC">and it saturates that's safe</font><font color="#E5E5E5"> if you fit</font>

476
00:23:53,010 --> 00:23:58,560
this to a plot it will saturate around

477
00:23:54,870 --> 00:24:02,850
6,000 to 8,000 here and let those so

478
00:23:58,560 --> 00:24:09,210
meaning that we<font color="#E5E5E5"> have a good number of</font>

479
00:24:02,850 --> 00:24:12,270
<font color="#CCCCCC">cells for for training now</font><font color="#E5E5E5"> with that</font>

480
00:24:09,210 --> 00:24:14,880
<font color="#E5E5E5">with</font><font color="#CCCCCC"> that said we continue to harvest</font>

481
00:24:12,270 --> 00:24:19,350
malicious certs<font color="#CCCCCC"> no we're</font><font color="#E5E5E5"> not stopping</font>

482
00:24:14,880 --> 00:24:22,080
here<font color="#CCCCCC"> and why</font><font color="#E5E5E5"> because we might if we want</font>

483
00:24:19,350 --> 00:24:25,110
to<font color="#E5E5E5"> squeeze out more more accuracy you</font>

484
00:24:22,080 --> 00:24:27,659
know a<font color="#CCCCCC"> lower</font><font color="#E5E5E5"> false positive rate we</font>

485
00:24:25,110 --> 00:24:29,100
which we<font color="#E5E5E5"> still we can still look at more</font>

486
00:24:27,660 --> 00:24:33,180
data we can still do more<font color="#CCCCCC"> feature</font>

487
00:24:29,100 --> 00:24:36,510
<font color="#CCCCCC">engineering we can look at other let's</font>

488
00:24:33,180 --> 00:24:39,420
say<font color="#E5E5E5"> more complex methods meaning deep</font>

489
00:24:36,510 --> 00:24:41,460
neural<font color="#E5E5E5"> networks and see if this you know</font>

490
00:24:39,420 --> 00:24:45,900
this trend changes you know if it keeps

491
00:24:41,460 --> 00:24:49,230
keeps<font color="#E5E5E5"> decreasing with with data set size</font>

492
00:24:45,900 --> 00:24:54,140
me so meaning<font color="#E5E5E5"> we can still gain from</font>

493
00:24:49,230 --> 00:24:57,480
this from this<font color="#CCCCCC"> from collecting more data</font>

494
00:24:54,140 --> 00:25:02,810
<font color="#E5E5E5">and also we can still gain by making the</font>

495
00:24:57,480 --> 00:25:02,810
classifier work better in in the field

496
00:25:04,760 --> 00:25:10,860
<font color="#CCCCCC">the final set of results</font><font color="#E5E5E5"> I'm gonna show</font>

497
00:25:07,620 --> 00:25:13,050
is the the feature importance we looked

498
00:25:10,860 --> 00:25:16,889
at some the attributes and how extract

499
00:25:13,050 --> 00:25:19,530
<font color="#CCCCCC">features from them we used a bunch of</font>

500
00:25:16,890 --> 00:25:22,080
them and we<font color="#E5E5E5"> want to get some</font><font color="#CCCCCC"> intuition</font>

501
00:25:19,530 --> 00:25:23,610
as to<font color="#E5E5E5"> which which of these features</font>

502
00:25:22,080 --> 00:25:25,050
which of these<font color="#CCCCCC"> attributes is more</font>

503
00:25:23,610 --> 00:25:26,879
important in<font color="#CCCCCC"> determining whether</font>

504
00:25:25,050 --> 00:25:29,540
determining whether a certificate<font color="#E5E5E5"> is</font>

505
00:25:26,880 --> 00:25:29,540
malicious<font color="#E5E5E5"> or not</font>

506
00:25:30,590 --> 00:25:39,658
so this is the the table for the most

507
00:25:36,450 --> 00:25:41,700
important features this<font color="#E5E5E5"> is the future</font>

508
00:25:39,659 --> 00:25:45,210
importance percentage<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what this</font>

509
00:25:41,700 --> 00:25:48,210
<font color="#CCCCCC">is what we get</font><font color="#E5E5E5"> from the random from the</font>

510
00:25:45,210 --> 00:25:49,980
random forest classifier<font color="#E5E5E5"> what I'm</font>

511
00:25:48,210 --> 00:25:52,259
<font color="#E5E5E5">showing here are the features</font><font color="#CCCCCC"> that have</font>

512
00:25:49,980 --> 00:25:54,360
that<font color="#E5E5E5"> have importance higher than 1.1</font>

513
00:25:52,259 --> 00:25:56,789
percent so this is the last<font color="#E5E5E5"> one here</font>

514
00:25:54,360 --> 00:26:00,689
other features have importance lower

515
00:25:56,789 --> 00:26:03,899
than<font color="#E5E5E5"> 1%</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this all add up</font><font color="#CCCCCC"> to 9</font><font color="#E5E5E5"> around</font>

516
00:26:00,690 --> 00:26:07,919
<font color="#CCCCCC">93% so this is the bulk if you look at</font>

517
00:26:03,899 --> 00:26:10,620
we<font color="#E5E5E5"> look at at these features</font><font color="#CCCCCC"> so</font>

518
00:26:07,919 --> 00:26:11,490
certificate policies this is an this is

519
00:26:10,620 --> 00:26:14,250
<font color="#CCCCCC">an</font><font color="#E5E5E5"> extension</font>

520
00:26:11,490 --> 00:26:18,929
apparently has<font color="#CCCCCC"> the highest highest</font>

521
00:26:14,250 --> 00:26:20,730
importance<font color="#CCCCCC"> Authority</font><font color="#E5E5E5"> in for access</font><font color="#CCCCCC"> this</font>

522
00:26:18,929 --> 00:26:23,850
<font color="#E5E5E5">usually has links to</font><font color="#CCCCCC"> the certificate</font>

523
00:26:20,730 --> 00:26:27,690
<font color="#CCCCCC">authority URLs certificate policies has</font>

524
00:26:23,850 --> 00:26:32,730
also links<font color="#CCCCCC"> to specific</font><font color="#E5E5E5"> policies related</font>

525
00:26:27,690 --> 00:26:35,279
to<font color="#CCCCCC"> SSL certificate authorities or</font><font color="#E5E5E5"> PKS</font>

526
00:26:32,730 --> 00:26:38,879
and so on subject<font color="#E5E5E5"> alt names</font><font color="#CCCCCC"> make</font>

527
00:26:35,279 --> 00:26:41,070
different names<font color="#E5E5E5"> for us</font><font color="#CCCCCC"> website and so on</font>

528
00:26:38,879 --> 00:26:43,830
this is TLS web server authentication

529
00:26:41,070 --> 00:26:45,928
and extended key usage critical key

530
00:26:43,830 --> 00:26:48,389
usage<font color="#CCCCCC"> meaning if that creative</font><font color="#E5E5E5"> a key</font>

531
00:26:45,929 --> 00:26:50,779
usage<font color="#E5E5E5"> is critical or not Authority key</font>

532
00:26:48,389 --> 00:26:53,908
identifier this is an ID<font color="#E5E5E5"> for the</font>

533
00:26:50,779 --> 00:26:58,080
certificate authority<font color="#E5E5E5"> and etc</font><font color="#CCCCCC"> this goes</font>

534
00:26:53,909 --> 00:27:01,440
<font color="#E5E5E5">down one here is the issuer country if</font>

535
00:26:58,080 --> 00:27:04,019
it's valid<font color="#E5E5E5"> or</font><font color="#CCCCCC"> not and then here it's a</font>

536
00:27:01,440 --> 00:27:07,460
issuer country the value of the issuer

537
00:27:04,019 --> 00:27:10,860
country the<font color="#CCCCCC"> organisation in the India or</font>

538
00:27:07,460 --> 00:27:13,649
entity and and so<font color="#E5E5E5"> on length of serial</font>

539
00:27:10,860 --> 00:27:16,668
number<font color="#E5E5E5"> and so</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> and what we see</font><font color="#CCCCCC"> here is</font>

540
00:27:13,649 --> 00:27:19,739
that extensions have particularly high

541
00:27:16,669 --> 00:27:22,830
importance<font color="#E5E5E5"> and in addition to issuer</font>

542
00:27:19,740 --> 00:27:27,980
fields so you<font color="#CCCCCC"> cannot get away without</font>

543
00:27:22,830 --> 00:27:27,980
looking<font color="#CCCCCC"> at at these attributes</font>

544
00:27:29,190 --> 00:27:36,280
also I want<font color="#CCCCCC"> to point out here that this</font>

545
00:27:32,650 --> 00:27:37,480
is there is a lot<font color="#E5E5E5"> of randomness</font><font color="#CCCCCC"> you know</font>

546
00:27:36,280 --> 00:27:40,180
that it's a<font color="#E5E5E5"> random forest there is</font>

547
00:27:37,480 --> 00:27:42,340
<font color="#E5E5E5">sampling and so on so you might run</font>

548
00:27:40,180 --> 00:27:44,170
another set of<font color="#CCCCCC"> calculations sampling</font><font color="#E5E5E5"> and</font>

549
00:27:42,340 --> 00:27:47,020
averaging and so on<font color="#E5E5E5"> and you might not</font>

550
00:27:44,170 --> 00:27:50,080
get this exact this exact order or these

551
00:27:47,020 --> 00:27:52,510
exact<font color="#CCCCCC"> numbers but the</font><font color="#E5E5E5"> most important</font>

552
00:27:50,080 --> 00:27:54,610
ones will be<font color="#E5E5E5"> there so this might be the</font>

553
00:27:52,510 --> 00:27:56,650
<font color="#E5E5E5">you know instead of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> third place</font><font color="#CCCCCC"> will</font>

554
00:27:54,610 --> 00:27:59,110
be the<font color="#E5E5E5"> second</font><font color="#CCCCCC"> and so</font><font color="#E5E5E5"> on but the most</font>

555
00:27:56,650 --> 00:28:03,060
important attributes are gonna be<font color="#E5E5E5"> there</font>

556
00:27:59,110 --> 00:28:03,060
<font color="#E5E5E5">so the order might change a</font><font color="#CCCCCC"> little bit</font>

557
00:28:05,430 --> 00:28:15,010
now I'm gonna take<font color="#E5E5E5"> the that the first</font>

558
00:28:11,110 --> 00:28:19,870
<font color="#E5E5E5">five attributes and look at look at them</font>

559
00:28:15,010 --> 00:28:22,780
in a little<font color="#CCCCCC"> more</font><font color="#E5E5E5"> detail so I look at the</font>

560
00:28:19,870 --> 00:28:25,179
<font color="#CCCCCC">prevalence in the</font><font color="#E5E5E5"> of these</font><font color="#CCCCCC"> attributes in</font>

561
00:28:22,780 --> 00:28:26,740
benign<font color="#CCCCCC"> certs and</font><font color="#E5E5E5"> in militia</font><font color="#CCCCCC"> certs</font>

562
00:28:25,180 --> 00:28:29,560
basically the<font color="#E5E5E5"> idea is to get some</font>

563
00:28:26,740 --> 00:28:32,440
intuition<font color="#E5E5E5"> as</font><font color="#CCCCCC"> to what a malicious cert</font>

564
00:28:29,560 --> 00:28:36,550
<font color="#CCCCCC">look like what to expect and what a</font>

565
00:28:32,440 --> 00:28:38,650
benign third looks like so certificate

566
00:28:36,550 --> 00:28:42,370
policies<font color="#E5E5E5"> has the highest importance and</font>

567
00:28:38,650 --> 00:28:43,960
turns out that<font color="#CCCCCC"> it's present</font><font color="#E5E5E5"> in this</font>

568
00:28:42,370 --> 00:28:46,239
extension certificate policies is

569
00:28:43,960 --> 00:28:47,890
present in ninety five point eight<font color="#E5E5E5"> nine</font>

570
00:28:46,240 --> 00:28:51,400
percent<font color="#E5E5E5"> of the benign certs</font>

571
00:28:47,890 --> 00:28:53,730
while its present on<font color="#E5E5E5"> only 9.75 of the</font>

572
00:28:51,400 --> 00:28:56,980
malicious certs

573
00:28:53,730 --> 00:29:00,990
<font color="#CCCCCC">Authority keen info access same thing</font>

574
00:28:56,980 --> 00:29:03,700
<font color="#E5E5E5">very similar numbers subject alt name</font>

575
00:29:00,990 --> 00:29:05,740
again similar numbers this is<font color="#E5E5E5"> subject</font>

576
00:29:03,700 --> 00:29:08,770
alt<font color="#CCCCCC"> name meaning whether it's present or</font>

577
00:29:05,740 --> 00:29:09,970
<font color="#CCCCCC">not it has a</font><font color="#E5E5E5"> little bit higher</font><font color="#CCCCCC"> presence</font>

578
00:29:08,770 --> 00:29:12,910
in malicious certs

579
00:29:09,970 --> 00:29:17,040
than than the other two critical key

580
00:29:12,910 --> 00:29:20,380
<font color="#CCCCCC">usage</font><font color="#E5E5E5"> it's mostly in in in benign it's</font>

581
00:29:17,040 --> 00:29:23,080
mostly absent in malicious<font color="#CCCCCC"> Authority key</font>

582
00:29:20,380 --> 00:29:27,430
identifier similar story except<font color="#E5E5E5"> that</font>

583
00:29:23,080 --> 00:29:30,189
it's a little<font color="#CCCCCC"> more more prevalent in in</font>

584
00:29:27,430 --> 00:29:33,400
malicious certs<font color="#E5E5E5"> which is most likely why</font>

585
00:29:30,190 --> 00:29:38,700
<font color="#CCCCCC">it gets lower importance than than than</font>

586
00:29:33,400 --> 00:29:42,490
the bar above attributes we go back to

587
00:29:38,700 --> 00:29:43,060
to<font color="#E5E5E5"> the sample cert that I saw at the</font>

588
00:29:42,490 --> 00:29:47,350
beginning

589
00:29:43,060 --> 00:29:49,090
and we will<font color="#E5E5E5"> look at the extension since</font>

590
00:29:47,350 --> 00:29:52,659
<font color="#E5E5E5">we saw that the extensions have a very</font>

591
00:29:49,090 --> 00:29:55,300
<font color="#E5E5E5">particularly high importance</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> these</font>

592
00:29:52,660 --> 00:29:59,140
are the attributes or from the

593
00:29:55,300 --> 00:30:01,149
extensions<font color="#E5E5E5"> of features that</font><font color="#CCCCCC"> have high</font>

594
00:29:59,140 --> 00:30:04,810
importance and<font color="#E5E5E5"> we look at them in in</font>

595
00:30:01,150 --> 00:30:06,760
this<font color="#E5E5E5"> cert certificate policies it's not</font>

596
00:30:04,810 --> 00:30:09,730
<font color="#E5E5E5">present here it should be present</font>

597
00:30:06,760 --> 00:30:14,350
<font color="#CCCCCC">usually</font><font color="#E5E5E5"> Authority info X is not present</font>

598
00:30:09,730 --> 00:30:15,790
subject<font color="#CCCCCC"> alt name its present TLS web</font>

599
00:30:14,350 --> 00:30:18,969
server authentication<font color="#E5E5E5"> it's their</font>

600
00:30:15,790 --> 00:30:21,610
critical key usage<font color="#E5E5E5"> the key usage here is</font>

601
00:30:18,970 --> 00:30:24,880
not critical<font color="#CCCCCC"> and the authority key</font>

602
00:30:21,610 --> 00:30:29,649
identifier it's not present<font color="#CCCCCC"> here so we</font>

603
00:30:24,880 --> 00:30:32,440
look we have some bad features<font color="#E5E5E5"> it's on</font>

604
00:30:29,650 --> 00:30:35,200
the wrong<font color="#E5E5E5"> side</font><font color="#CCCCCC"> of the feature split the</font>

605
00:30:32,440 --> 00:30:37,930
cert someone that<font color="#CCCCCC"> are and two that</font><font color="#E5E5E5"> are</font>

606
00:30:35,200 --> 00:30:42,030
<font color="#CCCCCC">ok</font><font color="#E5E5E5"> and here turns out that this is</font>

607
00:30:37,930 --> 00:30:42,030
<font color="#CCCCCC">actually a malicious earth</font>

608
00:30:46,170 --> 00:30:55,590
now finally I<font color="#E5E5E5"> just saw some summary and</font>

609
00:30:52,290 --> 00:30:56,760
conclusions of all this work so we

610
00:30:55,590 --> 00:31:01,649
applied machine learning out

611
00:30:56,760 --> 00:31:04,710
successfully to classify SSL certificate

612
00:31:01,650 --> 00:31:07,200
certificates we calculated the<font color="#E5E5E5"> future</font>

613
00:31:04,710 --> 00:31:09,480
importance and unprivileged<font color="#CCCCCC"> and this</font>

614
00:31:07,200 --> 00:31:11,790
gives<font color="#E5E5E5"> us a good intuition as to you know</font>

615
00:31:09,480 --> 00:31:14,550
looking at a certificate and<font color="#E5E5E5"> I'm</font>

616
00:31:11,790 --> 00:31:17,420
guessing whether it's good<font color="#CCCCCC"> or bad</font><font color="#E5E5E5"> it's</font>

617
00:31:14,550 --> 00:31:19,710
not exact so usually you know you can

618
00:31:17,420 --> 00:31:21,480
sometimes you can see a lot of<font color="#E5E5E5"> these</font>

619
00:31:19,710 --> 00:31:23,340
<font color="#E5E5E5">features that look good but you know</font>

620
00:31:21,480 --> 00:31:25,220
there are other features<font color="#E5E5E5"> and it and so</font>

621
00:31:23,340 --> 00:31:28,709
<font color="#CCCCCC">you know other features and</font><font color="#E5E5E5"> ends up</font>

622
00:31:25,220 --> 00:31:32,280
<font color="#E5E5E5">being that so but you get a good</font>

623
00:31:28,710 --> 00:31:33,930
intuition<font color="#CCCCCC"> study</font><font color="#E5E5E5"> the effect of the data</font>

624
00:31:32,280 --> 00:31:35,850
size you know being limited<font color="#E5E5E5"> by the</font>

625
00:31:33,930 --> 00:31:37,680
number<font color="#CCCCCC"> of malicious certs</font><font color="#E5E5E5"> we studied</font>

626
00:31:35,850 --> 00:31:44,070
that and<font color="#E5E5E5"> we see that it doesn't it</font>

627
00:31:37,680 --> 00:31:46,890
doesn't<font color="#E5E5E5"> really hurt us some some future</font>

628
00:31:44,070 --> 00:31:50,520
direction<font color="#E5E5E5"> obviously we're gonna keep</font>

629
00:31:46,890 --> 00:31:52,970
collecting malicious certs<font color="#CCCCCC"> dig deeper</font>

630
00:31:50,520 --> 00:31:57,300
into features<font color="#E5E5E5"> try to squeeze out more</font>

631
00:31:52,970 --> 00:32:00,710
<font color="#CCCCCC">accurate higher accuracy</font><font color="#E5E5E5"> again in the</font>

632
00:31:57,300 --> 00:32:04,470
<font color="#CCCCCC">spirit of looking for higher accuracy we</font>

633
00:32:00,710 --> 00:32:06,300
look into whether we this will help help

634
00:32:04,470 --> 00:32:08,730
us using more<font color="#CCCCCC"> sophisticated algorithms</font>

635
00:32:06,300 --> 00:32:13,080
<font color="#CCCCCC">mainly deep neural networks</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is</font>

636
00:32:08,730 --> 00:32:15,840
very<font color="#E5E5E5"> trendy now</font><font color="#CCCCCC"> also look at the search</font>

637
00:32:13,080 --> 00:32:17,370
in the in a broader context we looked in

638
00:32:15,840 --> 00:32:18,959
<font color="#E5E5E5">this study were so far we've been</font>

639
00:32:17,370 --> 00:32:21,719
<font color="#CCCCCC">looking</font><font color="#E5E5E5"> at the certificate itself</font>

640
00:32:18,960 --> 00:32:24,330
look at and we can look<font color="#CCCCCC"> in a broader</font>

641
00:32:21,720 --> 00:32:27,330
context meaning<font color="#E5E5E5"> the certification chain</font>

642
00:32:24,330 --> 00:32:31,580
you<font color="#E5E5E5"> know the parent</font><font color="#CCCCCC"> child and so on</font><font color="#E5E5E5"> more</font>

643
00:32:27,330 --> 00:32:36,710
metadata from<font color="#CCCCCC"> the TLS traffic and so on</font>

644
00:32:31,580 --> 00:32:36,710
so with that thank<font color="#CCCCCC"> you</font>

645
00:32:36,780 --> 00:32:42,300
this work<font color="#E5E5E5"> has</font><font color="#CCCCCC"> been</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> by myself and</font>

646
00:32:39,780 --> 00:32:46,740
<font color="#E5E5E5">Abhishek Sharma at the data analytics</font>

647
00:32:42,300 --> 00:32:50,220
<font color="#E5E5E5">team at</font><font color="#CCCCCC"> Fidelis on Y</font><font color="#E5E5E5"> Jason Reeves at the</font>

648
00:32:46,740 --> 00:32:52,170
threat<font color="#CCCCCC"> research team he collected</font><font color="#E5E5E5"> he has</font>

649
00:32:50,220 --> 00:32:57,060
this project<font color="#E5E5E5"> of collecting the malicious</font>

650
00:32:52,170 --> 00:32:58,740
certs<font color="#CCCCCC"> and we are</font><font color="#E5E5E5"> hiring so if you're</font>

651
00:32:57,060 --> 00:32:59,580
interested<font color="#CCCCCC"> please talk to</font><font color="#E5E5E5"> me or to</font>

652
00:32:58,740 --> 00:33:02,879
Daniel

653
00:32:59,580 --> 00:33:06,389
with the<font color="#CCCCCC"> Fidelis t-shirt and you can</font>

654
00:33:02,879 --> 00:33:35,639
look at the<font color="#CCCCCC"> fedora security website</font>

655
00:33:06,389 --> 00:33:38,820
<font color="#CCCCCC">alright thank you yes actually it's it's</font>

656
00:33:35,639 --> 00:33:41,459
not<font color="#E5E5E5"> only the</font><font color="#CCCCCC"> Alexa</font><font color="#E5E5E5"> 10,000 we use the</font>

657
00:33:38,820 --> 00:33:45,600
Alexa 10,000 we sample from<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we also</font>

658
00:33:41,460 --> 00:33:47,549
<font color="#CCCCCC">have the</font><font color="#E5E5E5"> census and there it's not</font>

659
00:33:45,600 --> 00:33:49,830
necessarily from that has a millions of

660
00:33:47,549 --> 00:33:51,899
certificates we sample<font color="#CCCCCC"> from those this</font>

661
00:33:49,830 --> 00:33:58,019
though<font color="#CCCCCC"> that is not necessarily the</font><font color="#E5E5E5"> most</font>

662
00:33:51,899 --> 00:34:01,408
popular now well it has you<font color="#E5E5E5"> know it has</font>

663
00:33:58,019 --> 00:34:05,279
<font color="#CCCCCC">flags</font><font color="#E5E5E5"> whether these certs are trusted or</font>

664
00:34:01,409 --> 00:34:09,210
not you know again it can be<font color="#E5E5E5"> trusted and</font>

665
00:34:05,279 --> 00:34:11,159
malicious<font color="#E5E5E5"> but you know we're relying on</font>

666
00:34:09,210 --> 00:34:13,379
<font color="#E5E5E5">the fact that the percentage of</font>

667
00:34:11,159 --> 00:34:16,409
malicious certificates<font color="#E5E5E5"> out there in</font>

668
00:34:13,379 --> 00:34:17,879
among trusted certificates is<font color="#E5E5E5"> low so</font>

669
00:34:16,409 --> 00:34:21,139
there might be a little<font color="#E5E5E5"> bit of</font>

670
00:34:17,879 --> 00:34:21,139
<font color="#CCCCCC">mislabelling but you know</font>

671
00:34:27,989 --> 00:34:37,810
yes what's<font color="#E5E5E5"> your actual response time are</font>

672
00:34:30,820 --> 00:34:40,570
you talking about oh no no it's

673
00:34:37,810 --> 00:34:46,509
definitely not hours not minutes<font color="#E5E5E5"> it's it</font>

674
00:34:40,570 --> 00:34:52,270
it<font color="#CCCCCC"> closed the real time so the response</font>

675
00:34:46,510 --> 00:34:54,850
time in in real life meaning<font color="#E5E5E5"> out there</font>

676
00:34:52,270 --> 00:34:57,070
in on the network<font color="#CCCCCC"> you're collect your</font>

677
00:34:54,850 --> 00:35:01,420
<font color="#E5E5E5">you're collecting the certificates you</font>

678
00:34:57,070 --> 00:35:05,160
<font color="#E5E5E5">want</font><font color="#CCCCCC"> to classify them</font><font color="#E5E5E5"> and how how fast</font>

679
00:35:01,420 --> 00:35:05,160
is<font color="#CCCCCC"> that right</font><font color="#E5E5E5"> I</font>

680
00:35:08,520 --> 00:35:15,370
we<font color="#E5E5E5"> have been gotten into into that that</font>

681
00:35:11,860 --> 00:35:19,150
detail yet well we're working on<font color="#E5E5E5"> putting</font>

682
00:35:15,370 --> 00:35:22,660
<font color="#CCCCCC">that in in we're working on putting</font><font color="#E5E5E5"> that</font>

683
00:35:19,150 --> 00:35:25,240
in the<font color="#E5E5E5"> product</font><font color="#CCCCCC"> we collect we have a</font>

684
00:35:22,660 --> 00:35:28,029
database we collect from the research

685
00:35:25,240 --> 00:35:30,490
areas from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> data from the from the</font>

686
00:35:28,030 --> 00:35:32,590
field<font color="#E5E5E5"> and looking at one certificate is</font>

687
00:35:30,490 --> 00:35:41,310
extremely<font color="#E5E5E5"> fast</font><font color="#CCCCCC"> I you know I</font><font color="#E5E5E5"> don't</font><font color="#CCCCCC"> think</font>

688
00:35:32,590 --> 00:35:41,310
it's anywhere near<font color="#CCCCCC"> a second so yeah true</font>

689
00:35:53,250 --> 00:36:01,780
specific like specific types of<font color="#E5E5E5"> malware</font>

690
00:35:57,540 --> 00:36:04,660
<font color="#CCCCCC">we haven't looked at that you</font><font color="#E5E5E5"> know one</font>

691
00:36:01,780 --> 00:36:07,119
<font color="#CCCCCC">reason we haven't looked</font><font color="#E5E5E5"> it so the the</font>

692
00:36:04,660 --> 00:36:10,118
malicious malicious set of certificates

693
00:36:07,119 --> 00:36:12,099
<font color="#E5E5E5">have we looked at specific we have we</font>

694
00:36:10,119 --> 00:36:14,650
you know partition the set<font color="#E5E5E5"> into</font>

695
00:36:12,099 --> 00:36:17,050
<font color="#E5E5E5">different malware types different actors</font>

696
00:36:14,650 --> 00:36:19,270
and so on we haven't<font color="#CCCCCC"> looked at</font><font color="#E5E5E5"> that yet</font>

697
00:36:17,050 --> 00:36:21,369
<font color="#E5E5E5">one reason we haven't looked at</font><font color="#CCCCCC"> that is</font>

698
00:36:19,270 --> 00:36:23,800
that<font color="#E5E5E5"> we have we don't have</font><font color="#CCCCCC"> a large data</font>

699
00:36:21,369 --> 00:36:26,079
<font color="#CCCCCC">set so if</font><font color="#E5E5E5"> you partition it try a farther</font>

700
00:36:23,800 --> 00:36:29,940
<font color="#E5E5E5">you know the training is not gonna be</font>

701
00:36:26,079 --> 00:36:29,940
<font color="#E5E5E5">good</font><font color="#CCCCCC"> enough yes</font>

702
00:36:45,510 --> 00:36:52,490
[Music]

703
00:36:46,990 --> 00:36:57,109
yes so I think<font color="#E5E5E5"> there is there</font><font color="#CCCCCC"> is some</font>

704
00:36:52,490 --> 00:36:58,549
<font color="#CCCCCC">work towards tweaking some militia</font>

705
00:36:57,109 --> 00:37:01,220
<font color="#CCCCCC">there's some certificates that look</font>

706
00:36:58,549 --> 00:37:03,259
benign and making the you know the

707
00:37:01,220 --> 00:37:06,859
classifier<font color="#E5E5E5"> or fooling the classifier</font>

708
00:37:03,260 --> 00:37:08,210
basically this is something<font color="#CCCCCC"> in I haven't</font>

709
00:37:06,859 --> 00:37:12,788
mentioned<font color="#E5E5E5"> here but this is something</font>

710
00:37:08,210 --> 00:37:12,789
<font color="#CCCCCC">that</font><font color="#E5E5E5"> we were gonna be working on a</font>

711
00:37:22,240 --> 00:37:30,379
feature that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> not present in the in</font>

712
00:37:25,220 --> 00:37:34,669
the<font color="#CCCCCC"> certificate itself I</font><font color="#E5E5E5"> I don't have</font>

713
00:37:30,380 --> 00:37:36,559
one<font color="#E5E5E5"> I you know</font><font color="#CCCCCC"> one way as I</font><font color="#E5E5E5"> mentioned</font>

714
00:37:34,670 --> 00:37:39,440
we're gonna look at the broader context

715
00:37:36,559 --> 00:37:45,910
<font color="#E5E5E5">I'm sure we'll get some something there</font>

716
00:37:39,440 --> 00:37:45,910
thank you yes

717
00:37:54,339 --> 00:38:01,759
so it's the is it's like this you know

718
00:37:58,369 --> 00:38:04,849
we have<font color="#CCCCCC"> we have this sense in</font><font color="#E5E5E5"> our</font>

719
00:38:01,759 --> 00:38:06,559
product we have we have multiple

720
00:38:04,849 --> 00:38:08,839
components<font color="#CCCCCC"> one of them is the sensor is</font>

721
00:38:06,559 --> 00:38:11,749
<font color="#CCCCCC">the one</font><font color="#E5E5E5"> that looks looks at the wire and</font>

722
00:38:08,839 --> 00:38:14,839
this is the one that<font color="#E5E5E5"> collects this the</font>

723
00:38:11,749 --> 00:38:16,970
<font color="#E5E5E5">metadata it collects also certificates</font>

724
00:38:14,839 --> 00:38:19,220
as part of<font color="#E5E5E5"> the metadata we send it to</font>

725
00:38:16,970 --> 00:38:21,919
<font color="#CCCCCC">the to</font><font color="#E5E5E5"> our collector where we store</font><font color="#CCCCCC"> the</font>

726
00:38:19,220 --> 00:38:24,439
metadata<font color="#E5E5E5"> so we'll have a database of</font>

727
00:38:21,920 --> 00:38:27,950
search there<font color="#E5E5E5"> and then we're gonna look</font>

728
00:38:24,440 --> 00:38:30,499
at the<font color="#E5E5E5"> we're gonna look at the</font>

729
00:38:27,950 --> 00:38:32,720
certificates in that in that<font color="#CCCCCC"> database</font><font color="#E5E5E5"> we</font>

730
00:38:30,499 --> 00:38:35,450
can<font color="#E5E5E5"> do that in real time we can look you</font>

731
00:38:32,720 --> 00:38:38,749
know once it get the sensor captures

732
00:38:35,450 --> 00:38:40,879
that certificate<font color="#E5E5E5"> we can classify it but</font>

733
00:38:38,749 --> 00:38:42,709
this<font color="#E5E5E5"> is not the architecture where we're</font>

734
00:38:40,880 --> 00:38:44,900
designing or<font color="#E5E5E5"> designing the the other</font>

735
00:38:42,710 --> 00:38:46,940
architecture the sensor sends it to<font color="#CCCCCC"> the</font>

736
00:38:44,900 --> 00:38:51,799
collector<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we go to the</font>

737
00:38:46,940 --> 00:38:57,099
collector and we we look at the other

738
00:38:51,799 --> 00:38:57,099
certificates<font color="#E5E5E5"> in the database yes</font>

739
00:39:07,000 --> 00:39:13,609
so the reason I ask is we want<font color="#CCCCCC"> to be</font>

740
00:39:11,000 --> 00:39:16,010
better<font color="#CCCCCC"> owned</font><font color="#E5E5E5"> object</font><font color="#CCCCCC"> based I guess we do</font>

741
00:39:13,609 --> 00:39:17,598
go time of learning<font color="#E5E5E5"> long</font><font color="#CCCCCC"> before a few</font>

742
00:39:16,010 --> 00:39:18,760
machine learning is not the certificate

743
00:39:17,599 --> 00:39:26,410
yet

744
00:39:18,760 --> 00:39:30,240
I see<font color="#E5E5E5"> yeah we</font><font color="#CCCCCC"> can't go it but I</font><font color="#E5E5E5"> think</font>

745
00:39:26,410 --> 00:39:30,240
this is not what we were choosing to do

746
00:39:41,430 --> 00:39:49,660
<font color="#E5E5E5">I</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't have the details you know it's</font>

747
00:39:47,140 --> 00:39:52,029
<font color="#E5E5E5">it was Jason that did that's doing the</font>

748
00:39:49,660 --> 00:39:53,649
it's Jason<font color="#E5E5E5"> that's doing the work</font><font color="#CCCCCC"> I would</font>

749
00:39:52,030 --> 00:39:55,420
guess that some of them are<font color="#E5E5E5"> not still</font>

750
00:39:53,650 --> 00:39:57,820
<font color="#CCCCCC">not</font><font color="#E5E5E5"> live I don't know what the ratio</font><font color="#CCCCCC"> is</font>

751
00:39:55,420 --> 00:40:00,670
or what the percentage is<font color="#E5E5E5"> or you know</font>

752
00:39:57,820 --> 00:40:19,090
how limited we<font color="#CCCCCC"> are by that</font><font color="#E5E5E5"> but I'm</font><font color="#CCCCCC"> sure</font>

753
00:40:00,670 --> 00:40:24,030
<font color="#E5E5E5">it's it's there yes</font><font color="#CCCCCC"> the code I I can't</font>

754
00:40:19,090 --> 00:40:24,030
answer that sorry I<font color="#E5E5E5"> I I have to check</font>

755
00:40:24,870 --> 00:40:34,740
but<font color="#E5E5E5"> you know if you can send me</font><font color="#CCCCCC"> an email</font>

756
00:40:28,330 --> 00:40:34,740
<font color="#CCCCCC">oh I will I will</font><font color="#E5E5E5"> let</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> no problem</font>

757
00:40:38,829 --> 00:40:42,119
<font color="#E5E5E5">all right thank you</font>

