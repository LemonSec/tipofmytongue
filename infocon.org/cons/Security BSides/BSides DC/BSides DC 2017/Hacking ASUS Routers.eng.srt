1
00:00:00,030 --> 00:00:06,060
the besides DC 2017 videos are brought

2
00:00:03,210 --> 00:00:07,740
to you by threat quotient introducing

3
00:00:06,060 --> 00:00:10,019
<font color="#E5E5E5">the industry's first threat intelligence</font>

4
00:00:07,740 --> 00:00:13,139
platform designed<font color="#E5E5E5"> to enable threat</font>

5
00:00:10,019 --> 00:00:15,960
operations and management and data tribe

6
00:00:13,139 --> 00:00:17,910
<font color="#CCCCCC">a new kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> startup</font><font color="#E5E5E5"> studio</font><font color="#CCCCCC"> co building</font>

7
00:00:15,960 --> 00:00:21,090
the next<font color="#CCCCCC"> generation of commercial cyber</font>

8
00:00:17,910 --> 00:00:23,279
<font color="#CCCCCC">security analytics and big data product</font>

9
00:00:21,090 --> 00:00:25,109
companies so I submitted<font color="#CCCCCC"> my talk</font>

10
00:00:23,279 --> 00:00:26,810
originally<font color="#E5E5E5"> it's supposed to be case</font>

11
00:00:25,109 --> 00:00:28,970
study<font color="#E5E5E5"> on hacking</font><font color="#CCCCCC"> aces routers</font>

12
00:00:26,810 --> 00:00:31,198
<font color="#E5E5E5">specifically from the application</font><font color="#CCCCCC"> layer</font>

13
00:00:28,970 --> 00:00:32,488
there were many other people chosen<font color="#E5E5E5"> the</font>

14
00:00:31,199 --> 00:00:36,239
front of me and I<font color="#E5E5E5"> was chosen as a backup</font>

15
00:00:32,488 --> 00:00:37,440
speaker and now you know why<font color="#E5E5E5"> how can I</font>

16
00:00:36,239 --> 00:00:39,149
can work<font color="#E5E5E5"> on this if you want</font><font color="#CCCCCC"> to go</font><font color="#E5E5E5"> hang</font>

17
00:00:37,440 --> 00:00:43,949
<font color="#E5E5E5">this under</font><font color="#CCCCCC"> like in your</font><font color="#E5E5E5"> slides up</font><font color="#CCCCCC"> ok</font>

18
00:00:39,149 --> 00:00:45,690
thank you<font color="#E5E5E5"> ok</font><font color="#CCCCCC"> so my talk is about so I'm</font>

19
00:00:43,950 --> 00:00:47,430
an application security<font color="#E5E5E5"> engineer my</font>

20
00:00:45,690 --> 00:00:49,230
background is a software developer<font color="#E5E5E5"> I</font>

21
00:00:47,430 --> 00:00:54,180
don't mess with routers<font color="#E5E5E5"> in a regular</font>

22
00:00:49,230 --> 00:00:57,750
basis or<font color="#CCCCCC"> on an annual basis</font><font color="#E5E5E5"> and what I</font>

23
00:00:54,180 --> 00:01:00,780
do is I do security<font color="#E5E5E5"> on application layer</font>

24
00:00:57,750 --> 00:01:03,359
that means<font color="#E5E5E5"> Java apps web apps</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> GS apps</font>

25
00:01:00,780 --> 00:01:07,260
<font color="#E5E5E5">we don't descend below level</font><font color="#CCCCCC"> seven</font>

26
00:01:03,359 --> 00:01:09,000
<font color="#E5E5E5">however I happen</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have a router and I</font>

27
00:01:07,260 --> 00:01:10,860
got curious<font color="#E5E5E5"> about</font><font color="#CCCCCC"> what's actually inside</font>

28
00:01:09,000 --> 00:01:12,479
<font color="#E5E5E5">the router and firmware it's kind of one</font>

29
00:01:10,860 --> 00:01:16,110
of<font color="#CCCCCC"> the things I never had a chance</font><font color="#E5E5E5"> to</font>

30
00:01:12,479 --> 00:01:18,240
look<font color="#CCCCCC"> into so I spend one night</font><font color="#E5E5E5"> unpacking</font>

31
00:01:16,110 --> 00:01:20,310
the firmware<font color="#E5E5E5"> and like just started</font>

32
00:01:18,240 --> 00:01:23,490
<font color="#CCCCCC">looking into</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> and what I found in</font>

33
00:01:20,310 --> 00:01:25,259
there is<font color="#E5E5E5"> actually I got</font><font color="#CCCCCC"> five</font><font color="#E5E5E5"> CVS of</font><font color="#CCCCCC"> her</font>

34
00:01:23,490 --> 00:01:26,789
actually hack into the<font color="#E5E5E5"> router</font><font color="#CCCCCC"> but all of</font>

35
00:01:25,259 --> 00:01:28,890
them are<font color="#E5E5E5"> still</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> application</font><font color="#CCCCCC"> layer</font>

36
00:01:26,790 --> 00:01:31,500
<font color="#E5E5E5">there's nothing on the network layer so</font>

37
00:01:28,890 --> 00:01:31,799
again so my talk<font color="#E5E5E5"> was</font><font color="#CCCCCC"> really about</font><font color="#E5E5E5"> thank</font>

38
00:01:31,500 --> 00:01:36,479
you

39
00:01:31,799 --> 00:01:38,790
it's about even<font color="#E5E5E5"> things that we don't</font>

40
00:01:36,479 --> 00:01:40,079
<font color="#E5E5E5">expect from the application layer</font><font color="#CCCCCC"> we</font>

41
00:01:38,790 --> 00:01:43,110
don't expect<font color="#E5E5E5"> those</font><font color="#CCCCCC"> things to</font><font color="#E5E5E5"> be in</font>

42
00:01:40,079 --> 00:01:46,408
routers<font color="#E5E5E5"> but are there anyway so I'm a</font>

43
00:01:43,110 --> 00:01:48,030
<font color="#CCCCCC">sorta</font><font color="#E5E5E5"> developer</font><font color="#CCCCCC"> I work for a big</font>

44
00:01:46,409 --> 00:01:50,939
financial institution who wishes to

45
00:01:48,030 --> 00:01:53,579
rename unnamed<font color="#CCCCCC"> you could google</font><font color="#E5E5E5"> it and</font><font color="#CCCCCC"> I</font>

46
00:01:50,939 --> 00:01:56,630
have some background in around anti-spam

47
00:01:53,579 --> 00:01:59,158
piping so if you know what SPF is and

48
00:01:56,630 --> 00:02:02,219
DKIM<font color="#E5E5E5"> I was involved in those</font><font color="#CCCCCC"> things many</font>

49
00:01:59,159 --> 00:02:05,960
years<font color="#E5E5E5"> ago I also wrote the RFC for comma</font>

50
00:02:02,219 --> 00:02:05,960
separated value files if<font color="#CCCCCC"> you use those</font>

51
00:02:06,200 --> 00:02:11,489
<font color="#E5E5E5">I'm going to talk</font><font color="#CCCCCC"> about expectations and</font>

52
00:02:08,878 --> 00:02:12,090
<font color="#E5E5E5">this is my standard warning don't hack</font>

53
00:02:11,489 --> 00:02:16,440
<font color="#E5E5E5">your friend</font>

54
00:02:12,090 --> 00:02:18,209
as permission now<font color="#E5E5E5"> there's two parts</font><font color="#CCCCCC"> to</font>

55
00:02:16,440 --> 00:02:19,800
<font color="#CCCCCC">this talk</font><font color="#E5E5E5"> first I'm just gonna run</font>

56
00:02:18,209 --> 00:02:22,200
<font color="#CCCCCC">through the</font><font color="#E5E5E5"> process</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> total process of</font>

57
00:02:19,800 --> 00:02:23,520
<font color="#E5E5E5">what I went through and then I want to</font>

58
00:02:22,200 --> 00:02:27,750
show you what exactly<font color="#CCCCCC"> that was that I</font>

59
00:02:23,520 --> 00:02:28,470
found<font color="#E5E5E5"> so I'm not a pen tester I'm a</font>

60
00:02:27,750 --> 00:02:30,660
<font color="#E5E5E5">developer</font>

61
00:02:28,470 --> 00:02:32,069
I'm the guy that and testers hate

62
00:02:30,660 --> 00:02:34,590
because<font color="#CCCCCC"> I install stuff on my computer</font>

63
00:02:32,069 --> 00:02:37,470
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you don't want to see what happens</font>

64
00:02:34,590 --> 00:02:37,860
is<font color="#E5E5E5"> that I never</font><font color="#CCCCCC"> dealt with</font><font color="#E5E5E5"> firmware</font><font color="#CCCCCC"> I</font>

65
00:02:37,470 --> 00:02:40,620
know

66
00:02:37,860 --> 00:02:42,120
hypothetically<font color="#E5E5E5"> what firmware is I know</font>

67
00:02:40,620 --> 00:02:44,519
what<font color="#CCCCCC"> a router is I know what it's</font>

68
00:02:42,120 --> 00:02:48,330
<font color="#CCCCCC">running but I never</font><font color="#E5E5E5"> actually looked</font><font color="#CCCCCC"> into</font>

69
00:02:44,519 --> 00:02:51,060
it so I have an Asus router and over the

70
00:02:48,330 --> 00:02:54,780
years I was curious<font color="#E5E5E5"> what's</font><font color="#CCCCCC"> inside the</font>

71
00:02:51,060 --> 00:02:57,980
router<font color="#CCCCCC"> so they if you</font><font color="#E5E5E5"> know anything</font>

72
00:02:54,780 --> 00:03:00,060
about Asus they're not exactly<font color="#E5E5E5"> very</font>

73
00:02:57,980 --> 00:03:02,160
<font color="#E5E5E5">regular with their updates</font><font color="#CCCCCC"> so when</font><font color="#E5E5E5"> I</font>

74
00:03:00,060 --> 00:03:03,810
<font color="#CCCCCC">didn't come up</font><font color="#E5E5E5"> with an update</font><font color="#CCCCCC"> I was kind</font>

75
00:03:02,160 --> 00:03:05,549
of<font color="#E5E5E5"> trying to figure</font><font color="#CCCCCC"> out is</font><font color="#E5E5E5"> there a way</font>

76
00:03:03,810 --> 00:03:07,200
<font color="#CCCCCC">for</font><font color="#E5E5E5"> me to kind of crack it open and see</font>

77
00:03:05,549 --> 00:03:08,760
<font color="#E5E5E5">what's inside now for those of you who</font>

78
00:03:07,200 --> 00:03:10,829
work with<font color="#E5E5E5"> routers all day it's</font><font color="#CCCCCC"> probably</font>

79
00:03:08,760 --> 00:03:13,170
a<font color="#E5E5E5"> no-brainer but for me coming as a</font>

80
00:03:10,830 --> 00:03:16,290
software developer<font color="#E5E5E5"> way way up in the</font>

81
00:03:13,170 --> 00:03:18,119
stack<font color="#E5E5E5"> the router to me is a box it's a</font>

82
00:03:16,290 --> 00:03:18,929
box you stick on<font color="#E5E5E5"> a network and</font><font color="#CCCCCC"> you let</font>

83
00:03:18,120 --> 00:03:22,079
it do its own thing

84
00:03:18,930 --> 00:03:24,870
so what was curious<font color="#CCCCCC"> to me what basically</font>

85
00:03:22,079 --> 00:03:27,630
is the point of<font color="#CCCCCC"> my talk is I started</font>

86
00:03:24,870 --> 00:03:29,220
from<font color="#E5E5E5"> the application layer and I ended</font>

87
00:03:27,630 --> 00:03:33,090
<font color="#CCCCCC">up in application layer even</font><font color="#E5E5E5"> though it</font>

88
00:03:29,220 --> 00:03:35,069
was a router<font color="#E5E5E5"> now this way this basically</font>

89
00:03:33,090 --> 00:03:37,200
took about<font color="#E5E5E5"> a night I download the</font>

90
00:03:35,069 --> 00:03:39,869
firmware<font color="#E5E5E5"> I open the buffer I found the</font>

91
00:03:37,200 --> 00:03:42,660
file<font color="#E5E5E5"> what in the world is a file it</font>

92
00:03:39,870 --> 00:03:45,299
turns out it was some<font color="#E5E5E5"> sort of a Linux</font>

93
00:03:42,660 --> 00:03:45,930
partition<font color="#E5E5E5"> and again I'm</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> going on</font>

94
00:03:45,299 --> 00:03:48,060
blindly

95
00:03:45,930 --> 00:03:50,489
I'm opening<font color="#CCCCCC"> the files I'm looking</font><font color="#E5E5E5"> into</font>

96
00:03:48,060 --> 00:03:52,560
them so I<font color="#E5E5E5"> open the file now one thing I</font>

97
00:03:50,489 --> 00:03:54,060
do know is that routers<font color="#CCCCCC"> do not run</font>

98
00:03:52,560 --> 00:03:55,260
Windows and if you have a router<font color="#E5E5E5"> just</font>

99
00:03:54,060 --> 00:03:58,079
running Windows you probably shouldn't

100
00:03:55,260 --> 00:04:01,679
<font color="#E5E5E5">be having it inside the router</font><font color="#CCCCCC"> there</font>

101
00:03:58,079 --> 00:04:05,519
JSON files and the ASP files now ASP

102
00:04:01,680 --> 00:04:07,709
files are dotnet<font color="#CCCCCC"> IAS files they do not</font>

103
00:04:05,519 --> 00:04:11,220
belong in routers so<font color="#E5E5E5"> obviously there's</font>

104
00:04:07,709 --> 00:04:14,970
something something's funny so this was

105
00:04:11,220 --> 00:04:17,310
the essentially the command flow<font color="#E5E5E5"> is that</font>

106
00:04:14,970 --> 00:04:18,930
<font color="#E5E5E5">I took the file IO download</font><font color="#CCCCCC"> Ben walk I</font>

107
00:04:17,310 --> 00:04:21,780
opened it up never<font color="#E5E5E5"> he's been</font><font color="#CCCCCC"> walked</font>

108
00:04:18,930 --> 00:04:25,560
before<font color="#CCCCCC"> and here's what I found now I'm</font>

109
00:04:21,779 --> 00:04:27,419
not<font color="#E5E5E5"> interested from my point of view</font>

110
00:04:25,560 --> 00:04:29,490
and looking into the<font color="#CCCCCC"> sea source and the</font>

111
00:04:27,419 --> 00:04:31,349
command the<font color="#CCCCCC"> luminescent configurations</font>

112
00:04:29,490 --> 00:04:35,400
<font color="#E5E5E5">and</font><font color="#CCCCCC"> there that's not</font><font color="#E5E5E5"> what my expertise</font>

113
00:04:31,350 --> 00:04:37,410
is in so what I was looking for<font color="#CCCCCC"> is just</font>

114
00:04:35,400 --> 00:04:40,888
curious just<font color="#E5E5E5"> see what's in there</font>

115
00:04:37,410 --> 00:04:43,770
so I see these ASP files<font color="#E5E5E5"> now in the</font>

116
00:04:40,889 --> 00:04:47,639
application security<font color="#E5E5E5"> world and</font><font color="#CCCCCC"> ASP file</font>

117
00:04:43,770 --> 00:04:49,280
is a<font color="#CCCCCC"> Windows I script obviously that's</font>

118
00:04:47,639 --> 00:04:53,010
<font color="#CCCCCC">not what the router is supposed to</font><font color="#E5E5E5"> have</font>

119
00:04:49,280 --> 00:04:55,138
but<font color="#CCCCCC"> when I went in and</font><font color="#E5E5E5"> inside these</font>

120
00:04:53,010 --> 00:04:58,020
files<font color="#CCCCCC"> it's actually turned out</font><font color="#E5E5E5"> to be</font>

121
00:04:55,139 --> 00:05:01,889
<font color="#CCCCCC">HTML and JavaScript</font><font color="#E5E5E5"> for whatever reason</font>

122
00:04:58,020 --> 00:05:04,109
<font color="#E5E5E5">ace has decided to package their web UI</font>

123
00:05:01,889 --> 00:05:06,120
files as<font color="#E5E5E5"> a SPS there's some sort of an</font>

124
00:05:04,110 --> 00:05:08,669
engine<font color="#E5E5E5"> interprets them</font><font color="#CCCCCC"> I don't know</font><font color="#E5E5E5"> what</font>

125
00:05:06,120 --> 00:05:11,610
<font color="#E5E5E5">the engine</font><font color="#CCCCCC"> is I didn't</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> into it but</font>

126
00:05:08,669 --> 00:05:14,460
<font color="#E5E5E5">what I did see</font><font color="#CCCCCC"> is a DOS or JSON code</font><font color="#E5E5E5"> now</font>

127
00:05:11,610 --> 00:05:17,639
<font color="#E5E5E5">once</font><font color="#CCCCCC"> it Duggan into all the way down</font>

128
00:05:14,460 --> 00:05:19,859
what I saw was<font color="#CCCCCC"> JSONP now JSONP for those</font>

129
00:05:17,639 --> 00:05:22,590
who are not familiar is that the browser

130
00:05:19,860 --> 00:05:26,220
security<font color="#E5E5E5"> model prohibits us from loading</font>

131
00:05:22,590 --> 00:05:28,739
<font color="#CCCCCC">JavaScript files</font><font color="#E5E5E5"> across domains</font><font color="#CCCCCC"> JSONP is</font>

132
00:05:26,220 --> 00:05:31,229
a way to kind<font color="#CCCCCC"> of bypass that and if you</font>

133
00:05:28,740 --> 00:05:33,690
tell the server<font color="#E5E5E5"> here's my callback</font>

134
00:05:31,229 --> 00:05:35,099
<font color="#E5E5E5">function in JavaScript</font><font color="#CCCCCC"> and give me the</font>

135
00:05:33,690 --> 00:05:37,169
JSON what it does is it doesn't just

136
00:05:35,100 --> 00:05:39,630
<font color="#E5E5E5">return the JSON file to you it</font><font color="#CCCCCC"> also</font>

137
00:05:37,169 --> 00:05:42,240
wraps around and executed the callback

138
00:05:39,630 --> 00:05:44,219
function you provide what happens is

139
00:05:42,240 --> 00:05:46,470
that<font color="#CCCCCC"> to</font><font color="#E5E5E5"> bypass the security model</font>

140
00:05:44,220 --> 00:05:48,390
instead<font color="#CCCCCC"> of using the</font><font color="#E5E5E5"> standard</font><font color="#CCCCCC"> ways you</font>

141
00:05:46,470 --> 00:05:51,180
<font color="#E5E5E5">load it you would do is a simple script</font>

142
00:05:48,390 --> 00:05:54,300
include<font color="#CCCCCC"> udo script include</font><font color="#E5E5E5"> you pass it</font>

143
00:05:51,180 --> 00:05:56,190
to<font color="#CCCCCC"> your server it loads your</font><font color="#E5E5E5"> JSON now a</font>

144
00:05:54,300 --> 00:05:59,039
router is not<font color="#CCCCCC"> a place</font><font color="#E5E5E5"> where you've</font><font color="#CCCCCC"> wanna</font>

145
00:05:56,190 --> 00:06:00,300
<font color="#E5E5E5">find</font><font color="#CCCCCC"> JSONP and in the second part</font><font color="#E5E5E5"> I'm</font>

146
00:05:59,039 --> 00:06:02,610
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> actually show</font><font color="#E5E5E5"> you what</font><font color="#CCCCCC"> that</font>

147
00:06:00,300 --> 00:06:05,100
<font color="#E5E5E5">looked like but</font><font color="#CCCCCC"> essentially what that</font>

148
00:06:02,610 --> 00:06:07,979
<font color="#E5E5E5">means</font><font color="#CCCCCC"> is you can do calls into</font><font color="#E5E5E5"> the web</font>

149
00:06:05,100 --> 00:06:12,720
UI<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> router and you can get stuff</font>

150
00:06:07,979 --> 00:06:14,849
back<font color="#E5E5E5"> this is an</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> of what one of</font>

151
00:06:12,720 --> 00:06:17,700
<font color="#E5E5E5">the files looks</font><font color="#CCCCCC"> like again I</font><font color="#E5E5E5"> don't know</font>

152
00:06:14,850 --> 00:06:19,380
<font color="#E5E5E5">what the</font><font color="#CCCCCC"> engine is</font><font color="#E5E5E5"> I didn't dig enough</font>

153
00:06:17,700 --> 00:06:22,050
into it there<font color="#E5E5E5"> must be something Linux</font>

154
00:06:19,380 --> 00:06:23,700
<font color="#E5E5E5">see what it is</font><font color="#CCCCCC"> exactly I don't know but</font>

155
00:06:22,050 --> 00:06:26,639
what you do see<font color="#CCCCCC"> is</font><font color="#E5E5E5"> it's kind of like</font>

156
00:06:23,700 --> 00:06:28,889
it's putting<font color="#E5E5E5"> some data into</font><font color="#CCCCCC"> it now at</font>

157
00:06:26,639 --> 00:06:31,320
that<font color="#E5E5E5"> point what I'm have is I have the</font>

158
00:06:28,889 --> 00:06:34,229
router that's working with the UI<font color="#E5E5E5"> and I</font>

159
00:06:31,320 --> 00:06:36,780
have my source code<font color="#E5E5E5"> and the names start</font>

160
00:06:34,229 --> 00:06:39,390
to match some names match<font color="#E5E5E5"> some names</font>

161
00:06:36,780 --> 00:06:41,039
don't match<font color="#E5E5E5"> so</font>

162
00:06:39,390 --> 00:06:43,380
I'm not in an outer world anymore<font color="#CCCCCC"> now</font>

163
00:06:41,040 --> 00:06:44,820
I'm back to<font color="#CCCCCC"> where I started were my</font>

164
00:06:43,380 --> 00:06:47,760
expertise lies<font color="#E5E5E5"> which is application</font>

165
00:06:44,820 --> 00:06:49,560
<font color="#E5E5E5">security</font><font color="#CCCCCC"> now what I'm looking at the</font>

166
00:06:47,760 --> 00:06:52,080
router<font color="#E5E5E5"> I'm no longer looking at it as a</font>

167
00:06:49,560 --> 00:06:55,020
box<font color="#CCCCCC"> I'm looking at it as somebody</font><font color="#E5E5E5"> wrote</font>

168
00:06:52,080 --> 00:06:57,479
<font color="#CCCCCC">a UI</font><font color="#E5E5E5"> they have a web</font><font color="#CCCCCC"> application which</font>

169
00:06:55,020 --> 00:07:00,060
is insecure<font color="#E5E5E5"> it happens to be running in</font>

170
00:06:57,480 --> 00:07:02,310
<font color="#E5E5E5">the router versus a conventional</font>

171
00:07:00,060 --> 00:07:05,250
<font color="#CCCCCC">computer</font><font color="#E5E5E5"> but that's what I'm looking at</font>

172
00:07:02,310 --> 00:07:07,500
<font color="#CCCCCC">so I started looking</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> it now this</font>

173
00:07:05,250 --> 00:07:11,100
<font color="#E5E5E5">point is I'm</font><font color="#CCCCCC"> not thinking in terms</font><font color="#E5E5E5"> of</font>

174
00:07:07,500 --> 00:07:12,750
ports<font color="#E5E5E5"> I'm not thinking in terms of what</font>

175
00:07:11,100 --> 00:07:14,250
services<font color="#CCCCCC"> are running</font><font color="#E5E5E5"> on the router I'm</font>

176
00:07:12,750 --> 00:07:16,050
looking<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a point of view</font><font color="#E5E5E5"> of an</font>

177
00:07:14,250 --> 00:07:18,750
application<font color="#E5E5E5"> security engineer</font><font color="#CCCCCC"> and what</font>

178
00:07:16,050 --> 00:07:22,110
we're<font color="#E5E5E5"> looking what if or is this is a</font>

179
00:07:18,750 --> 00:07:24,150
web UI<font color="#E5E5E5"> there are common things that</font><font color="#CCCCCC"> are</font>

180
00:07:22,110 --> 00:07:25,890
described in<font color="#CCCCCC"> the OS top ten that web UI</font>

181
00:07:24,150 --> 00:07:27,120
<font color="#CCCCCC">is have</font><font color="#E5E5E5"> they're vulnerable</font>

182
00:07:25,890 --> 00:07:28,469
those are some of<font color="#E5E5E5"> the things you can</font>

183
00:07:27,120 --> 00:07:31,260
start with but basically<font color="#CCCCCC"> just start</font>

184
00:07:28,470 --> 00:07:33,900
looking<font color="#E5E5E5"> around as if treating it not as</font>

185
00:07:31,260 --> 00:07:36,030
a router but<font color="#CCCCCC"> as any other application so</font>

186
00:07:33,900 --> 00:07:38,070
I started looking at<font color="#E5E5E5"> this there was no</font>

187
00:07:36,030 --> 00:07:40,440
specialized<font color="#E5E5E5"> tool</font><font color="#CCCCCC"> and not</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> Burke a lot</font>

188
00:07:38,070 --> 00:07:41,909
of Chrome I put up the developer<font color="#CCCCCC"> tools</font>

189
00:07:40,440 --> 00:07:46,230
in<font color="#E5E5E5"> chrome and I just started going to</font>

190
00:07:41,910 --> 00:07:49,050
the router UI<font color="#E5E5E5"> and if the firmware is bad</font>

191
00:07:46,230 --> 00:07:52,470
<font color="#E5E5E5">from what I hear the UI apparently was</font>

192
00:07:49,050 --> 00:07:54,120
even worse<font color="#CCCCCC"> the quality of the code</font><font color="#E5E5E5"> at</font>

193
00:07:52,470 --> 00:07:57,690
least<font color="#CCCCCC"> I saw the JavaScript was from a</font>

194
00:07:54,120 --> 00:08:01,620
<font color="#E5E5E5">security angle</font><font color="#CCCCCC"> was pretty bad so at this</font>

195
00:07:57,690 --> 00:08:03,750
point over<font color="#CCCCCC"> a couple</font><font color="#E5E5E5"> days so I found one</font>

196
00:08:01,620 --> 00:08:07,110
I found<font color="#CCCCCC"> two found three - four</font>

197
00:08:03,750 --> 00:08:08,940
eventually<font color="#CCCCCC"> or five different CVS if you</font>

198
00:08:07,110 --> 00:08:11,070
follow the entire chain<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> way to</font>

199
00:08:08,940 --> 00:08:14,210
its end<font color="#E5E5E5"> you can take over anybody driver</font>

200
00:08:11,070 --> 00:08:16,680
<font color="#E5E5E5">now there is a very big</font><font color="#CCCCCC"> difference</font><font color="#E5E5E5"> in</font>

201
00:08:14,210 --> 00:08:18,270
web security<font color="#CCCCCC"> and application security</font>

202
00:08:16,680 --> 00:08:21,300
<font color="#CCCCCC">how you take things off</font><font color="#E5E5E5"> okay</font>

203
00:08:18,270 --> 00:08:23,219
how you take something<font color="#CCCCCC"> over vs.</font><font color="#E5E5E5"> network</font>

204
00:08:21,300 --> 00:08:26,490
<font color="#CCCCCC">level and in part two I'm going</font><font color="#E5E5E5"> to go</font>

205
00:08:23,220 --> 00:08:27,930
through it now<font color="#E5E5E5"> at this point so I just</font>

206
00:08:26,490 --> 00:08:29,820
spent<font color="#E5E5E5"> a couple</font><font color="#CCCCCC"> nights</font><font color="#E5E5E5"> looking at a</font>

207
00:08:27,930 --> 00:08:31,620
router<font color="#E5E5E5"> I've got a bunch of issues</font><font color="#CCCCCC"> now</font>

208
00:08:29,820 --> 00:08:33,000
what am I<font color="#E5E5E5"> supposed to do with it if I</font>

209
00:08:31,620 --> 00:08:36,000
was a<font color="#E5E5E5"> black hat hacker I know what I'm</font>

210
00:08:33,000 --> 00:08:39,870
<font color="#CCCCCC">supposed to do with it</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> luckily for</font>

211
00:08:36,000 --> 00:08:43,740
<font color="#CCCCCC">aces</font><font color="#E5E5E5"> or not I</font><font color="#CCCCCC"> Canada aces</font><font color="#E5E5E5"> now aces took</font>

212
00:08:39,870 --> 00:08:44,820
a<font color="#E5E5E5"> while</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> always go through cert for</font>

213
00:08:43,740 --> 00:08:48,000
those of you who've dealt with

214
00:08:44,820 --> 00:08:50,730
responsible disclosure<font color="#CCCCCC"> it's kind of cert</font>

215
00:08:48,000 --> 00:08:53,100
isn't<font color="#CCCCCC"> always helpful but</font><font color="#E5E5E5"> if a says this</font>

216
00:08:50,730 --> 00:08:54,360
if the vendor decides to go back after

217
00:08:53,100 --> 00:08:56,130
<font color="#E5E5E5">you at least you have a second</font>

218
00:08:54,360 --> 00:08:59,640
individual independent party that was

219
00:08:56,130 --> 00:09:01,020
involved<font color="#CCCCCC"> eventually they fix that one of</font>

220
00:08:59,640 --> 00:09:03,000
them we still have a disagreement<font color="#E5E5E5"> on</font>

221
00:09:01,020 --> 00:09:04,110
they<font color="#E5E5E5"> don't want to fix it</font><font color="#CCCCCC"> I think it's</font>

222
00:09:03,000 --> 00:09:05,700
an issue they<font color="#CCCCCC"> don't think it's an issue</font>

223
00:09:04,110 --> 00:09:09,780
<font color="#E5E5E5">and I'll show you what the issue looks</font>

224
00:09:05,700 --> 00:09:10,470
like about<font color="#CCCCCC"> a talking</font><font color="#E5E5E5"> about a month to</font>

225
00:09:09,780 --> 00:09:13,439
fix<font color="#E5E5E5"> it</font>

226
00:09:10,470 --> 00:09:16,440
Aibileen extra months afterwards<font color="#E5E5E5"> to</font>

227
00:09:13,440 --> 00:09:18,360
actually disclose it<font color="#E5E5E5"> the funny thing</font>

228
00:09:16,440 --> 00:09:20,850
happened is once it was disclosed<font color="#CCCCCC"> and</font>

229
00:09:18,360 --> 00:09:22,440
again I<font color="#E5E5E5"> don't know why this issue</font><font color="#CCCCCC"> over</font>

230
00:09:20,850 --> 00:09:25,140
any other<font color="#CCCCCC"> should the media suddenly</font>

231
00:09:22,440 --> 00:09:28,260
picked her up<font color="#CCCCCC"> high reported an issue in</font>

232
00:09:25,140 --> 00:09:32,040
<font color="#CCCCCC">a single router model based on what the</font>

233
00:09:28,260 --> 00:09:33,900
users are<font color="#CCCCCC"> started sending to me 45</font><font color="#E5E5E5"> the</font>

234
00:09:32,040 --> 00:09:36,270
somewhere between 40<font color="#CCCCCC"> to 50 different</font>

235
00:09:33,900 --> 00:09:38,760
<font color="#E5E5E5">aces models are affected I think pretty</font>

236
00:09:36,270 --> 00:09:40,740
much<font color="#E5E5E5"> every single one</font>

237
00:09:38,760 --> 00:09:43,230
<font color="#E5E5E5">Easter's officially only release patches</font>

238
00:09:40,740 --> 00:09:45,090
<font color="#E5E5E5">for specific ones but as sort of these</font>

239
00:09:43,230 --> 00:09:47,100
other things start coming<font color="#CCCCCC"> out of the</font>

240
00:09:45,090 --> 00:09:49,380
woodwork<font color="#E5E5E5"> they start affecting the rest</font>

241
00:09:47,100 --> 00:09:52,080
<font color="#E5E5E5">of them the last issue is being worked</font>

242
00:09:49,380 --> 00:09:53,790
on as far as enough for at<font color="#E5E5E5"> least for the</font>

243
00:09:52,080 --> 00:09:56,520
router<font color="#CCCCCC"> that I worked on which is the RT</font>

244
00:09:53,790 --> 00:09:58,050
and 56 they do not have a fix

245
00:09:56,520 --> 00:10:03,300
however they do have a fix for

246
00:09:58,050 --> 00:10:06,569
everything else<font color="#E5E5E5"> so bottom line is is</font>

247
00:10:03,300 --> 00:10:10,199
that<font color="#E5E5E5"> from me as an application security</font>

248
00:10:06,570 --> 00:10:11,790
engineer it's good to be curious<font color="#CCCCCC"> even</font>

249
00:10:10,200 --> 00:10:14,520
<font color="#CCCCCC">though I'm I don't touch</font><font color="#E5E5E5"> the network</font>

250
00:10:11,790 --> 00:10:16,740
<font color="#CCCCCC">level stuff in this case it was a good</font>

251
00:10:14,520 --> 00:10:18,510
it was<font color="#E5E5E5"> a</font><font color="#CCCCCC"> good thing and a lot of times</font>

252
00:10:16,740 --> 00:10:20,040
we<font color="#E5E5E5"> have silos that we work in specific</font>

253
00:10:18,510 --> 00:10:23,610
<font color="#E5E5E5">areas we don't</font><font color="#CCCCCC"> necessarily always follow</font>

254
00:10:20,040 --> 00:10:24,990
things<font color="#E5E5E5"> now what I wanted to do at this</font>

255
00:10:23,610 --> 00:10:29,010
point<font color="#E5E5E5"> is when I actually go through the</font>

256
00:10:24,990 --> 00:10:31,440
<font color="#E5E5E5">seven vulnerabilities in interesting</font>

257
00:10:29,010 --> 00:10:33,720
thing about<font color="#E5E5E5"> aces aces is actually under</font>

258
00:10:31,440 --> 00:10:35,760
a<font color="#E5E5E5"> legal consent decree because their</font>

259
00:10:33,720 --> 00:10:37,050
orders are<font color="#CCCCCC"> not</font><font color="#E5E5E5"> secure and I believe</font>

260
00:10:35,760 --> 00:10:38,700
d-link is going through the<font color="#E5E5E5"> same issue</font>

261
00:10:37,050 --> 00:10:41,250
<font color="#E5E5E5">the Federal Trade Commission</font><font color="#CCCCCC"> is slowly</font>

262
00:10:38,700 --> 00:10:43,740
going through all the various router

263
00:10:41,250 --> 00:10:46,260
vendors<font color="#E5E5E5"> and suing them to force them to</font>

264
00:10:43,740 --> 00:10:47,490
do<font color="#E5E5E5"> security that I think that that is I</font>

265
00:10:46,260 --> 00:10:50,310
think one of the reasons why<font color="#CCCCCC"> Asus</font>

266
00:10:47,490 --> 00:10:52,770
responded so fast<font color="#E5E5E5"> because</font><font color="#CCCCCC"> my experience</font>

267
00:10:50,310 --> 00:10:56,069
with other<font color="#E5E5E5"> vendors even Google has not</font>

268
00:10:52,770 --> 00:10:58,230
been<font color="#CCCCCC"> that</font><font color="#E5E5E5"> fast there's 42 models</font>

269
00:10:56,070 --> 00:11:00,060
everything<font color="#CCCCCC"> it's RT - since I wrote the</font>

270
00:10:58,230 --> 00:11:03,009
<font color="#CCCCCC">slide I think that the number crept up a</font>

271
00:11:00,060 --> 00:11:05,589
<font color="#E5E5E5">little bit because some of the routers</font>

272
00:11:03,009 --> 00:11:08,350
<font color="#E5E5E5">Artie is the retail</font><font color="#CCCCCC"> model there's also</font>

273
00:11:05,589 --> 00:11:11,859
the<font color="#E5E5E5"> 4G models</font><font color="#CCCCCC"> there's a couple of other</font>

274
00:11:08,350 --> 00:11:15,549
variations<font color="#E5E5E5"> everything prior to 2017 is a</font>

275
00:11:11,859 --> 00:11:17,679
fact<font color="#CCCCCC"> that there is at least two</font><font color="#E5E5E5"> open</font>

276
00:11:15,549 --> 00:11:21,608
source projects<font color="#E5E5E5"> derived from the</font><font color="#CCCCCC"> Asus</font>

277
00:11:17,679 --> 00:11:24,488
firmware<font color="#CCCCCC"> I think one is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Asus wrt one</font>

278
00:11:21,609 --> 00:11:26,679
is the Merlin project<font color="#E5E5E5"> if they copy code</font>

279
00:11:24,489 --> 00:11:29,609
from<font color="#E5E5E5"> Asus and Asus is very good about</font>

280
00:11:26,679 --> 00:11:32,559
<font color="#E5E5E5">GPL disclosure then they are probably</font>

281
00:11:29,609 --> 00:11:35,470
<font color="#E5E5E5">affected</font><font color="#CCCCCC"> I did not test them to give you</font>

282
00:11:32,559 --> 00:11:37,449
a scale in<font color="#E5E5E5"> terms of sort of the rest of</font>

283
00:11:35,470 --> 00:11:39,160
the<font color="#CCCCCC"> internet their market share at least</font>

284
00:11:37,449 --> 00:11:42,299
<font color="#E5E5E5">according to what the industry people</font>

285
00:11:39,160 --> 00:11:45,129
<font color="#E5E5E5">are saying is 4.3 percent in last year</font>

286
00:11:42,299 --> 00:11:47,259
for the<font color="#CCCCCC"> high-end Wi-Fi routers basic</font>

287
00:11:45,129 --> 00:11:49,809
anything over 100<font color="#E5E5E5"> bucks</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> our share</font>

288
00:11:47,259 --> 00:11:51,669
is<font color="#E5E5E5"> much more it's like</font><font color="#CCCCCC"> 13%</font><font color="#E5E5E5"> now very</font>

289
00:11:49,809 --> 00:11:53,858
important point is the<font color="#E5E5E5"> last one this is</font>

290
00:11:51,669 --> 00:11:56,769
<font color="#E5E5E5">not</font><font color="#CCCCCC"> Network level that means you cannot</font>

291
00:11:53,859 --> 00:11:57,970
just<font color="#E5E5E5"> go</font><font color="#CCCCCC"> into show them or sensors or</font>

292
00:11:56,769 --> 00:11:59,619
anything<font color="#E5E5E5"> like that and start scanning</font>

293
00:11:57,970 --> 00:12:02,769
every single IP you will not find these

294
00:11:59,619 --> 00:12:05,139
issues<font color="#E5E5E5"> because this is a web security</font>

295
00:12:02,769 --> 00:12:07,899
<font color="#E5E5E5">issue not a network security issue this</font>

296
00:12:05,139 --> 00:12:09,309
<font color="#E5E5E5">quotation is path is different in some</font>

297
00:12:07,899 --> 00:12:11,319
ways it's<font color="#CCCCCC"> easier in some ways is</font><font color="#E5E5E5"> much</font>

298
00:12:09,309 --> 00:12:16,089
harder<font color="#E5E5E5"> so it's not something you could</font>

299
00:12:11,319 --> 00:12:19,449
<font color="#CCCCCC">just your pop open from a port so these</font>

300
00:12:16,089 --> 00:12:22,769
are the CVEs<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I found there are</font>

301
00:12:19,449 --> 00:12:22,769
essentially<font color="#CCCCCC"> are</font><font color="#E5E5E5"> four of them</font>

302
00:12:23,189 --> 00:12:28,988
<font color="#E5E5E5">miter miter</font><font color="#CCCCCC"> when they assign them I</font>

303
00:12:26,829 --> 00:12:30,849
think<font color="#E5E5E5"> they were recently</font><font color="#CCCCCC"> I asked</font><font color="#E5E5E5"> for two</font>

304
00:12:28,989 --> 00:12:34,749
they signed for there's a fifth<font color="#E5E5E5"> one so</font>

305
00:12:30,850 --> 00:12:37,899
these these<font color="#E5E5E5"> are basically</font><font color="#CCCCCC"> r4 and what</font>

306
00:12:34,749 --> 00:12:40,839
these four are are as follows<font color="#E5E5E5"> the first</font>

307
00:12:37,899 --> 00:12:44,589
one is the one<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the worst that is</font>

308
00:12:40,839 --> 00:12:48,639
known as<font color="#CCCCCC"> the</font><font color="#E5E5E5"> CSRF now CSRF attack relies</font>

309
00:12:44,589 --> 00:12:50,379
<font color="#E5E5E5">on the fact that you don't have state in</font>

310
00:12:48,639 --> 00:12:52,419
<font color="#E5E5E5">the browser when</font><font color="#CCCCCC"> the browser talks to</font>

311
00:12:50,379 --> 00:12:54,309
the website<font color="#CCCCCC"> there is no state so there's</font>

312
00:12:52,419 --> 00:12:56,499
various tricks that we do to establish

313
00:12:54,309 --> 00:12:57,879
state the most<font color="#E5E5E5"> common is a cookie but</font>

314
00:12:56,499 --> 00:13:00,879
essentially is if you're logged<font color="#CCCCCC"> into</font>

315
00:12:57,879 --> 00:13:03,100
<font color="#CCCCCC">beta my telecom any other</font><font color="#E5E5E5"> website can</font>

316
00:13:00,879 --> 00:13:04,299
start posting stuff to the same to send

317
00:13:03,100 --> 00:13:06,100
them in because the browser will just

318
00:13:04,299 --> 00:13:07,899
take the cookie and send it over now

319
00:13:06,100 --> 00:13:09,729
that is not<font color="#CCCCCC"> something you</font><font color="#E5E5E5"> want to see in</font>

320
00:13:07,899 --> 00:13:12,309
a router<font color="#CCCCCC"> because if you do</font><font color="#E5E5E5"> have a CSRF</font>

321
00:13:09,729 --> 00:13:16,120
issue<font color="#E5E5E5"> in your router that means you can</font>

322
00:13:12,309 --> 00:13:19,089
actually<font color="#E5E5E5"> do a post to the router UI from</font>

323
00:13:16,120 --> 00:13:22,800
any other<font color="#CCCCCC"> site and change things the</font>

324
00:13:19,089 --> 00:13:25,209
next two are somewhat less of an issue

325
00:13:22,800 --> 00:13:27,099
<font color="#E5E5E5">if you do have connectivity to the</font>

326
00:13:25,209 --> 00:13:29,349
router then I mentioned<font color="#CCCCCC"> earlier there's</font>

327
00:13:27,100 --> 00:13:31,300
a<font color="#CCCCCC"> callback you can do</font><font color="#E5E5E5"> callback from any</font>

328
00:13:29,350 --> 00:13:33,699
other<font color="#E5E5E5"> website remember</font><font color="#CCCCCC"> there's no web</font>

329
00:13:31,300 --> 00:13:35,920
security<font color="#E5E5E5"> at this point because the</font>

330
00:13:33,699 --> 00:13:38,498
people<font color="#CCCCCC"> that</font><font color="#E5E5E5"> all do</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> I chose to bypass</font>

331
00:13:35,920 --> 00:13:40,360
<font color="#CCCCCC">it by putting in JSONP you</font><font color="#E5E5E5"> to call the</font>

332
00:13:38,499 --> 00:13:41,680
router and you get<font color="#CCCCCC"> stop</font><font color="#E5E5E5"> back and I'll</font>

333
00:13:40,360 --> 00:13:43,329
<font color="#E5E5E5">show you some of the</font><font color="#CCCCCC"> examples of</font><font color="#E5E5E5"> what</font>

334
00:13:41,680 --> 00:13:44,559
<font color="#E5E5E5">you can get back but there's a lot of</font>

335
00:13:43,329 --> 00:13:46,209
<font color="#E5E5E5">interesting things</font><font color="#CCCCCC"> that come out of</font><font color="#E5E5E5"> the</font>

336
00:13:44,559 --> 00:13:48,009
router<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> to be authenticated</font>

337
00:13:46,209 --> 00:13:50,680
the third one is<font color="#CCCCCC"> there's an unoffending</font>

338
00:13:48,009 --> 00:13:52,629
<font color="#CCCCCC">here endpoint</font><font color="#E5E5E5"> if you want to go and</font>

339
00:13:50,680 --> 00:13:54,189
<font color="#E5E5E5">start attacking your users and you wanna</font>

340
00:13:52,629 --> 00:13:56,199
see who has a router<font color="#E5E5E5"> or who doesn't</font>

341
00:13:54,189 --> 00:13:57,699
<font color="#E5E5E5">that's the endpoint you would use you</font>

342
00:13:56,199 --> 00:14:00,279
could choose once you know what they

343
00:13:57,699 --> 00:14:02,769
lack on the local network looks like you

344
00:14:00,279 --> 00:14:04,839
call that<font color="#E5E5E5"> endpoint</font><font color="#CCCCCC"> as a matter of fact</font>

345
00:14:02,769 --> 00:14:06,160
the official<font color="#CCCCCC"> Asus application that they</font>

346
00:14:04,839 --> 00:14:08,439
have Android that's<font color="#E5E5E5"> the same thing and</font>

347
00:14:06,160 --> 00:14:11,290
then you can<font color="#CCCCCC"> actually detect whether</font>

348
00:14:08,439 --> 00:14:13,629
somebody's running<font color="#CCCCCC"> or not running an</font>

349
00:14:11,290 --> 00:14:15,160
Asus router and then the vulnerabilities

350
00:14:13,629 --> 00:14:17,499
<font color="#E5E5E5">are listed in order of the</font><font color="#CCCCCC"> CPU numbers</font>

351
00:14:15,160 --> 00:14:19,600
not<font color="#CCCCCC"> in order</font><font color="#E5E5E5"> of severity</font><font color="#CCCCCC"> the last one is</font>

352
00:14:17,499 --> 00:14:20,769
the Wi-Fi<font color="#E5E5E5"> password</font><font color="#CCCCCC"> disclosure</font><font color="#E5E5E5"> there's an</font>

353
00:14:19,600 --> 00:14:24,220
endpoint in the router will give you the

354
00:14:20,769 --> 00:14:26,740
Wi-Fi password<font color="#CCCCCC"> now at</font><font color="#E5E5E5"> this point</font>

355
00:14:24,220 --> 00:14:30,100
<font color="#CCCCCC">Asus chose to actually make it a little</font>

356
00:14:26,740 --> 00:14:33,879
<font color="#E5E5E5">more secure</font><font color="#CCCCCC"> that is an XML endpoint</font><font color="#E5E5E5"> not</font>

357
00:14:30,100 --> 00:14:36,220
a<font color="#CCCCCC"> JSONP endpoints so web security</font><font color="#E5E5E5"> in</font>

358
00:14:33,879 --> 00:14:38,110
browsers at this point kicks in and<font color="#CCCCCC"> you</font>

359
00:14:36,220 --> 00:14:40,120
can't actually do this<font color="#E5E5E5"> but</font><font color="#CCCCCC"> if you manage</font>

360
00:14:38,110 --> 00:14:42,100
to<font color="#E5E5E5"> somehow cross</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> natural boundary if</font>

361
00:14:40,120 --> 00:14:44,920
<font color="#E5E5E5">you on the user's local network you'll</font>

362
00:14:42,100 --> 00:14:47,079
get their Wi-Fi passwords now these<font color="#E5E5E5"> are</font>

363
00:14:44,920 --> 00:14:48,279
<font color="#E5E5E5">the actual CPUs how do we actually what</font>

364
00:14:47,079 --> 00:14:51,670
do we do with<font color="#E5E5E5"> them what do we how do we</font>

365
00:14:48,279 --> 00:14:55,839
put<font color="#E5E5E5"> them together</font><font color="#CCCCCC"> so first of</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> just</font>

366
00:14:51,670 --> 00:14:57,610
to<font color="#E5E5E5"> review about CSRF</font><font color="#CCCCCC"> unless you're</font><font color="#E5E5E5"> using</font>

367
00:14:55,839 --> 00:14:58,990
a<font color="#CCCCCC"> mod of</font><font color="#E5E5E5"> very modern browser with</font><font color="#CCCCCC"> the</font>

368
00:14:57,610 --> 00:15:01,360
latest version of<font color="#E5E5E5"> Chrome</font><font color="#CCCCCC"> and using</font>

369
00:14:58,990 --> 00:15:04,449
something called same<font color="#E5E5E5"> site which is very</font>

370
00:15:01,360 --> 00:15:07,300
<font color="#E5E5E5">very new every time</font><font color="#CCCCCC"> you do requests to a</font>

371
00:15:04,449 --> 00:15:11,519
site<font color="#E5E5E5"> a cookie gets sent back and then</font>

372
00:15:07,300 --> 00:15:14,319
establishes a devil established state so

373
00:15:11,519 --> 00:15:17,829
<font color="#CCCCCC">that will happen as anybody can sort of</font>

374
00:15:14,319 --> 00:15:20,469
<font color="#CCCCCC">write</font><font color="#E5E5E5"> in that session the proper way</font><font color="#CCCCCC"> to</font>

375
00:15:17,829 --> 00:15:21,819
get<font color="#E5E5E5"> around those issues is</font><font color="#CCCCCC"> that for</font>

376
00:15:20,470 --> 00:15:24,459
those<font color="#CCCCCC"> who work in application security</font>

377
00:15:21,819 --> 00:15:26,339
<font color="#CCCCCC">we have</font><font color="#E5E5E5"> CSRF tokens which are tokens</font>

378
00:15:24,459 --> 00:15:28,569
<font color="#CCCCCC">that are</font><font color="#E5E5E5"> generated</font><font color="#CCCCCC"> every</font><font color="#E5E5E5"> single time</font>

379
00:15:26,339 --> 00:15:29,010
something<font color="#E5E5E5"> comes back from the server</font><font color="#CCCCCC"> and</font>

380
00:15:28,569 --> 00:15:32,310
<font color="#E5E5E5">we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> this</font>

381
00:15:29,010 --> 00:15:37,410
that second token back<font color="#CCCCCC"> that is not what</font>

382
00:15:32,310 --> 00:15:40,520
is<font color="#CCCCCC"> happening in the Asus router JSONP is</font>

383
00:15:37,410 --> 00:15:43,020
the other one<font color="#CCCCCC"> JSONP is a way to bypass</font>

384
00:15:40,520 --> 00:15:45,780
basically any every browser restriction

385
00:15:43,020 --> 00:15:47,819
there is<font color="#CCCCCC"> JSONP originally was invented</font>

386
00:15:45,780 --> 00:15:50,130
as a way to when the beginnings of

387
00:15:47,820 --> 00:15:50,880
security in web browsers were put in

388
00:15:50,130 --> 00:15:52,800
<font color="#E5E5E5">that's what</font>

389
00:15:50,880 --> 00:15:54,870
how much people<font color="#E5E5E5"> starting to figure out</font>

390
00:15:52,800 --> 00:15:57,120
<font color="#E5E5E5">we cannot load data from</font><font color="#CCCCCC"> other sites</font>

391
00:15:54,870 --> 00:15:59,160
through<font color="#E5E5E5"> XML HTTP requests</font><font color="#CCCCCC"> how do</font><font color="#E5E5E5"> we do</font>

392
00:15:57,120 --> 00:16:00,690
this<font color="#E5E5E5"> so they came up with JSONP which is</font>

393
00:15:59,160 --> 00:16:03,630
not really a standard<font color="#E5E5E5"> it's a convention</font>

394
00:16:00,690 --> 00:16:06,600
<font color="#CCCCCC">but essentially is you could do a script</font>

395
00:16:03,630 --> 00:16:07,980
include<font color="#E5E5E5"> and you tell the server here's</font>

396
00:16:06,600 --> 00:16:10,200
the callback function I<font color="#E5E5E5"> want so you can</font>

397
00:16:07,980 --> 00:16:11,550
<font color="#CCCCCC">lose script including</font><font color="#E5E5E5"> say callback</font><font color="#CCCCCC"> it</font>

398
00:16:10,200 --> 00:16:12,810
will give you back piece of JavaScript

399
00:16:11,550 --> 00:16:14,760
<font color="#CCCCCC">rather</font><font color="#E5E5E5"> data and</font><font color="#CCCCCC"> that callback and</font>

400
00:16:12,810 --> 00:16:18,109
<font color="#CCCCCC">executed in will</font><font color="#E5E5E5"> in your within</font><font color="#CCCCCC"> the</font>

401
00:16:14,760 --> 00:16:20,130
context of<font color="#CCCCCC"> your with your machine now</font>

402
00:16:18,110 --> 00:16:21,930
<font color="#E5E5E5">what will happen</font><font color="#CCCCCC"> is let's say if you</font>

403
00:16:20,130 --> 00:16:23,490
have Bank of America and Bank<font color="#E5E5E5"> of America</font>

404
00:16:21,930 --> 00:16:25,620
does this so they have adjacent<font color="#CCCCCC"> the</font>

405
00:16:23,490 --> 00:16:27,390
endpoint then<font color="#E5E5E5"> anyway other website can</font>

406
00:16:25,620 --> 00:16:29,820
you just go and do<font color="#E5E5E5"> bank robbery</font><font color="#CCCCCC"> on comp</font>

407
00:16:27,390 --> 00:16:31,920
<font color="#E5E5E5">slash</font><font color="#CCCCCC"> JSONP and get</font><font color="#E5E5E5"> whatever data does</font>

408
00:16:29,820 --> 00:16:34,950
<font color="#E5E5E5">something back in application security</font>

409
00:16:31,920 --> 00:16:36,449
<font color="#E5E5E5">world</font><font color="#CCCCCC"> this is very</font><font color="#E5E5E5"> very bad</font>

410
00:16:34,950 --> 00:16:38,910
the funny thing<font color="#CCCCCC"> is if they were not</font>

411
00:16:36,450 --> 00:16:40,740
<font color="#E5E5E5">using</font><font color="#CCCCCC"> JSONP</font><font color="#E5E5E5"> ease of using XML HTTP</font>

412
00:16:38,910 --> 00:16:44,280
<font color="#E5E5E5">request which</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what most sites are</font>

413
00:16:40,740 --> 00:16:45,780
<font color="#CCCCCC">using then web security</font><font color="#E5E5E5"> in the browser</font>

414
00:16:44,280 --> 00:16:47,520
kicks in automatically<font color="#CCCCCC"> it wouldn't have</font>

415
00:16:45,780 --> 00:16:52,560
the<font color="#E5E5E5"> session so somebody went out of the</font>

416
00:16:47,520 --> 00:16:54,449
way and<font color="#CCCCCC"> actually put in the JSON v this</font>

417
00:16:52,560 --> 00:16:56,010
<font color="#E5E5E5">is the exploit chain</font><font color="#CCCCCC"> now if you notice</font>

418
00:16:54,450 --> 00:16:57,660
<font color="#E5E5E5">destination is very different than</font>

419
00:16:56,010 --> 00:17:00,450
<font color="#CCCCCC">Network level network level</font><font color="#E5E5E5"> exploit</font>

420
00:16:57,660 --> 00:17:03,240
chain starts with scanning<font color="#E5E5E5"> there's no</font>

421
00:17:00,450 --> 00:17:05,760
scanning here the first<font color="#E5E5E5"> problem is is</font>

422
00:17:03,240 --> 00:17:07,410
that we cannot actually<font color="#E5E5E5"> get to the UI of</font>

423
00:17:05,760 --> 00:17:09,000
<font color="#CCCCCC">the router</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> running internally</font>

424
00:17:07,410 --> 00:17:10,230
<font color="#E5E5E5">it's running within the local network it</font>

425
00:17:09,000 --> 00:17:12,599
should not be accessible<font color="#E5E5E5"> from the</font>

426
00:17:10,230 --> 00:17:14,730
outside<font color="#CCCCCC"> the way you will need to do</font><font color="#E5E5E5"> that</font>

427
00:17:12,599 --> 00:17:16,919
<font color="#E5E5E5">you need</font><font color="#CCCCCC"> to get somebody</font><font color="#E5E5E5"> who</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> on that</font>

428
00:17:14,730 --> 00:17:18,959
<font color="#E5E5E5">network to visit a malicious page you</font>

429
00:17:16,920 --> 00:17:20,850
could do a watering hole<font color="#CCCCCC"> you could do</font>

430
00:17:18,959 --> 00:17:23,970
spam<font color="#CCCCCC"> you could do a fake</font>

431
00:17:20,849 --> 00:17:25,770
you know app<font color="#E5E5E5"> whatever it is you have to</font>

432
00:17:23,970 --> 00:17:28,500
<font color="#CCCCCC">get somebody to actually click on that</font>

433
00:17:25,770 --> 00:17:31,520
link and hit<font color="#E5E5E5"> that site it's</font><font color="#CCCCCC"> and it will</font>

434
00:17:28,500 --> 00:17:34,710
<font color="#E5E5E5">not work otherwise but once you do that</font>

435
00:17:31,520 --> 00:17:37,520
then the<font color="#CCCCCC"> next step is let's say you did</font>

436
00:17:34,710 --> 00:17:41,490
<font color="#E5E5E5">manage to</font><font color="#CCCCCC"> fish</font><font color="#E5E5E5"> someone</font><font color="#CCCCCC"> you did manage</font><font color="#E5E5E5"> to</font>

437
00:17:37,520 --> 00:17:42,629
<font color="#E5E5E5">do whatever it</font><font color="#CCCCCC"> is and now they are on</font>

438
00:17:41,490 --> 00:17:45,810
<font color="#CCCCCC">your site</font>

439
00:17:42,630 --> 00:17:50,400
then what we do is is<font color="#E5E5E5"> the second step is</font>

440
00:17:45,810 --> 00:17:51,840
there's that<font color="#CCCCCC"> end point</font><font color="#E5E5E5"> sorry the third</font>

441
00:17:50,400 --> 00:17:53,100
<font color="#E5E5E5">that the second step is</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> to find</font>

442
00:17:51,840 --> 00:17:55,560
<font color="#E5E5E5">out what</font><font color="#CCCCCC"> they appear interests</font>

443
00:17:53,100 --> 00:17:57,510
now most browsers<font color="#CCCCCC"> most modern browsers</font>

444
00:17:55,560 --> 00:18:00,030
<font color="#E5E5E5">support a protocol the protocol called</font>

445
00:17:57,510 --> 00:18:02,879
WebRTC<font color="#CCCCCC"> which is used for essentially</font>

446
00:18:00,030 --> 00:18:05,790
<font color="#E5E5E5">video chatting skyping and stuff like</font>

447
00:18:02,880 --> 00:18:07,590
that<font color="#CCCCCC"> WebRTC has</font><font color="#E5E5E5"> got a bunch of security</font>

448
00:18:05,790 --> 00:18:09,920
<font color="#E5E5E5">holes</font><font color="#CCCCCC"> even though I think there's a</font>

449
00:18:07,590 --> 00:18:12,540
black<font color="#E5E5E5"> presentation a couple</font><font color="#CCCCCC"> years back</font>

450
00:18:09,920 --> 00:18:15,300
essentially<font color="#CCCCCC"> here you could tell your</font>

451
00:18:12,540 --> 00:18:17,310
browser<font color="#E5E5E5"> and ask it what is</font><font color="#CCCCCC"> your local</font>

452
00:18:15,300 --> 00:18:19,680
<font color="#E5E5E5">range and will tell you what the local</font>

453
00:18:17,310 --> 00:18:22,830
LAN ranges now at<font color="#E5E5E5"> that</font><font color="#CCCCCC"> point so let's</font>

454
00:18:19,680 --> 00:18:25,440
say you know<font color="#E5E5E5"> the local range most</font>

455
00:18:22,830 --> 00:18:28,080
routers will sit as<font color="#E5E5E5"> the first one so</font><font color="#CCCCCC"> it</font>

456
00:18:25,440 --> 00:18:30,360
says one<font color="#E5E5E5"> into one six eight nine nine it</font>

457
00:18:28,080 --> 00:18:32,310
will be<font color="#E5E5E5"> probably 99.1</font><font color="#CCCCCC"> that's when you</font>

458
00:18:30,360 --> 00:18:34,740
<font color="#E5E5E5">get to the third step is again the user</font>

459
00:18:32,310 --> 00:18:37,200
<font color="#E5E5E5">still on that site they hit that site</font>

460
00:18:34,740 --> 00:18:40,740
the site runs the JavaScript<font color="#E5E5E5"> to do web</font>

461
00:18:37,200 --> 00:18:42,300
RTC<font color="#E5E5E5"> the next point is it runs the third</font>

462
00:18:40,740 --> 00:18:46,890
step<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> it calls the JSONP</font>

463
00:18:42,300 --> 00:18:48,570
<font color="#CCCCCC">endpoint and says are you alive</font><font color="#E5E5E5"> if it</font>

464
00:18:46,890 --> 00:18:53,250
gets a response<font color="#E5E5E5"> back that's an Isis</font>

465
00:18:48,570 --> 00:18:55,320
router now you are at step four<font color="#E5E5E5"> now this</font>

466
00:18:53,250 --> 00:18:57,060
<font color="#E5E5E5">may sound like you know this never</font>

467
00:18:55,320 --> 00:18:58,620
happens right no no everybody changes

468
00:18:57,060 --> 00:19:00,330
their credentials if you look at the

469
00:18:58,620 --> 00:19:02,250
studies that been<font color="#E5E5E5"> done most</font><font color="#CCCCCC"> abusers</font><font color="#E5E5E5"> do</font>

470
00:19:00,330 --> 00:19:03,990
<font color="#E5E5E5">not bother to</font><font color="#CCCCCC"> change their credentials</font>

471
00:19:02,250 --> 00:19:07,110
for<font color="#E5E5E5"> the router because there are is</font>

472
00:19:03,990 --> 00:19:09,240
inside<font color="#CCCCCC"> of arbol so what happens is the</font>

473
00:19:07,110 --> 00:19:11,070
AC<font color="#E5E5E5"> drivers come with the full potentials</font>

474
00:19:09,240 --> 00:19:14,340
<font color="#E5E5E5">the things have been</font><font color="#CCCCCC"> admin</font><font color="#E5E5E5"> password or</font>

475
00:19:11,070 --> 00:19:16,770
admin admin that's when the<font color="#E5E5E5"> next</font>

476
00:19:14,340 --> 00:19:18,199
vulnerability comes<font color="#E5E5E5"> in so the CSRF</font>

477
00:19:16,770 --> 00:19:20,400
attacks so again we're<font color="#CCCCCC"> dealing with</font>

478
00:19:18,200 --> 00:19:22,620
several<font color="#E5E5E5"> different steps I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> go</font>

479
00:19:20,400 --> 00:19:24,330
through<font color="#CCCCCC"> all of them but the</font><font color="#E5E5E5"> CSRF</font>

480
00:19:22,620 --> 00:19:27,179
<font color="#E5E5E5">attacked and lets you log</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> the</font>

481
00:19:24,330 --> 00:19:28,590
router<font color="#E5E5E5"> number five you can use</font>

482
00:19:27,180 --> 00:19:30,420
<font color="#E5E5E5">additional endpoints to collect</font>

483
00:19:28,590 --> 00:19:32,129
<font color="#E5E5E5">information on the router</font><font color="#CCCCCC"> and number six</font>

484
00:19:30,420 --> 00:19:34,320
is<font color="#E5E5E5"> when you can actually use the same</font>

485
00:19:32,130 --> 00:19:35,220
<font color="#E5E5E5">set of vulnerability to do whatever you</font>

486
00:19:34,320 --> 00:19:37,470
want

487
00:19:35,220 --> 00:19:39,690
in my example<font color="#E5E5E5"> you to none</font><font color="#CCCCCC"> involved</font>

488
00:19:37,470 --> 00:19:43,050
<font color="#E5E5E5">access you put an</font><font color="#CCCCCC"> I port</font>

489
00:19:39,690 --> 00:19:45,150
you could also for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> number seven</font>

490
00:19:43,050 --> 00:19:47,879
Asus routers have ability<font color="#E5E5E5"> to some logs</font>

491
00:19:45,150 --> 00:19:49,320
remotely<font color="#E5E5E5"> you could add</font><font color="#CCCCCC"> also but at that</font>

492
00:19:47,880 --> 00:19:51,510
point<font color="#E5E5E5"> every setting within the router</font>

493
00:19:49,320 --> 00:19:53,909
can<font color="#CCCCCC"> be changed</font><font color="#E5E5E5"> and what's interesting</font>

494
00:19:51,510 --> 00:19:55,260
there is<font color="#E5E5E5"> the user has to be visiting a</font>

495
00:19:53,910 --> 00:19:56,880
malicious site and it's<font color="#E5E5E5"> saying</font>

496
00:19:55,260 --> 00:19:59,940
they don't have to be logged into the

497
00:19:56,880 --> 00:20:01,980
router<font color="#E5E5E5"> this I can do it all for them and</font>

498
00:19:59,940 --> 00:20:06,620
all it doesn't<font color="#E5E5E5"> take very long it takes</font>

499
00:20:01,980 --> 00:20:09,330
maybe 30 seconds and then<font color="#CCCCCC"> then it's</font><font color="#E5E5E5"> done</font>

500
00:20:06,620 --> 00:20:12,239
now<font color="#E5E5E5"> the first step is obviously the</font>

501
00:20:09,330 --> 00:20:14,879
hardest<font color="#CCCCCC"> this is this is why this attack</font>

502
00:20:12,240 --> 00:20:16,770
is<font color="#E5E5E5"> not rated higher because this is not</font>

503
00:20:14,880 --> 00:20:18,780
the<font color="#E5E5E5"> kind of thing that you can clear out</font>

504
00:20:16,770 --> 00:20:21,840
<font color="#E5E5E5">right</font><font color="#CCCCCC"> of warm for this is a kind</font><font color="#E5E5E5"> of</font>

505
00:20:18,780 --> 00:20:24,510
thing to just scan all<font color="#CCCCCC"> ip's</font><font color="#E5E5E5"> you have to</font>

506
00:20:21,840 --> 00:20:27,060
<font color="#CCCCCC">actually trick someone</font><font color="#E5E5E5"> to visit our site</font>

507
00:20:24,510 --> 00:20:29,190
and there are many<font color="#E5E5E5"> ways to do that you</font>

508
00:20:27,060 --> 00:20:31,560
could phishing spam watering holes

509
00:20:29,190 --> 00:20:33,540
whatever it is you have to<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> do</font>

510
00:20:31,560 --> 00:20:35,970
<font color="#E5E5E5">that first step now a conventional</font>

511
00:20:33,540 --> 00:20:38,340
phishing attack<font color="#E5E5E5"> lets you when you click</font>

512
00:20:35,970 --> 00:20:41,070
a site it asks you ask you for<font color="#E5E5E5"> username</font>

513
00:20:38,340 --> 00:20:42,689
<font color="#E5E5E5">passwords if a</font><font color="#CCCCCC"> gmail</font><font color="#E5E5E5"> site a lot of the</font>

514
00:20:41,070 --> 00:20:45,240
<font color="#E5E5E5">detection mechanisms</font><font color="#CCCCCC"> around fishing will</font>

515
00:20:42,690 --> 00:20:46,740
look for that this does not<font color="#E5E5E5"> all this</font>

516
00:20:45,240 --> 00:20:48,540
needs<font color="#CCCCCC"> to do is you visit</font><font color="#E5E5E5"> any site</font>

517
00:20:46,740 --> 00:20:49,710
<font color="#E5E5E5">because the user will not see the</font>

518
00:20:48,540 --> 00:20:53,190
JavaScript<font color="#E5E5E5"> commands that are happening</font>

519
00:20:49,710 --> 00:20:54,360
<font color="#E5E5E5">behind</font><font color="#CCCCCC"> the scenes so what they do is at</font>

520
00:20:53,190 --> 00:20:56,960
this point<font color="#E5E5E5"> you give them some how to</font>

521
00:20:54,360 --> 00:21:01,320
visit a malicious site<font color="#E5E5E5"> now at that point</font>

522
00:20:56,960 --> 00:21:02,970
<font color="#E5E5E5">using WebRTC</font><font color="#CCCCCC"> and that's the link</font><font color="#E5E5E5"> to one</font>

523
00:21:01,320 --> 00:21:05,399
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> security one of the security</font>

524
00:21:02,970 --> 00:21:07,770
<font color="#CCCCCC">issues flash is another way for</font><font color="#E5E5E5"> it to</font>

525
00:21:05,400 --> 00:21:09,210
leak<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> also assume that that one</font>

526
00:21:07,770 --> 00:21:12,200
<font color="#E5E5E5">that's zero that one that one's probably</font>

527
00:21:09,210 --> 00:21:15,630
default<font color="#E5E5E5"> if you're using a</font><font color="#CCCCCC"> mobile app</font>

528
00:21:12,200 --> 00:21:17,130
<font color="#E5E5E5">that</font><font color="#CCCCCC"> may work also</font><font color="#E5E5E5"> my router the one</font>

529
00:21:15,630 --> 00:21:19,890
that I worked on doesn't have the last

530
00:21:17,130 --> 00:21:22,070
issue<font color="#E5E5E5"> but some routers actually do if</font>

531
00:21:19,890 --> 00:21:24,630
because they control the DNS they have

532
00:21:22,070 --> 00:21:26,070
default the mains defined<font color="#CCCCCC"> they</font><font color="#E5E5E5"> will</font>

533
00:21:24,630 --> 00:21:28,230
always go to router so you could check

534
00:21:26,070 --> 00:21:30,179
whether the main is there and then

535
00:21:28,230 --> 00:21:32,010
access the<font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> and at that point</font>

536
00:21:30,180 --> 00:21:35,340
you'll see whether<font color="#E5E5E5"> it's bases around or</font>

537
00:21:32,010 --> 00:21:39,410
<font color="#E5E5E5">not an Asus router but the third step is</font>

538
00:21:35,340 --> 00:21:42,030
so now you have the visit of<font color="#E5E5E5"> the page</font>

539
00:21:39,410 --> 00:21:44,840
you either hit you<font color="#CCCCCC"> find out what the IP</font>

540
00:21:42,030 --> 00:21:47,160
address<font color="#E5E5E5"> was or you</font><font color="#CCCCCC"> hit on those domains</font>

541
00:21:44,840 --> 00:21:50,220
that is the<font color="#CCCCCC"> endpoint that you</font><font color="#E5E5E5"> need to</font>

542
00:21:47,160 --> 00:21:51,690
<font color="#E5E5E5">hit if you hit that</font><font color="#CCCCCC"> endpoint</font><font color="#E5E5E5"> on IP it</font>

543
00:21:50,220 --> 00:21:53,130
will give you that<font color="#CCCCCC"> information</font><font color="#E5E5E5"> the</font>

544
00:21:51,690 --> 00:21:54,480
information<font color="#CCCCCC"> is</font><font color="#E5E5E5"> very basic from a</font>

545
00:21:53,130 --> 00:21:56,520
security angle<font color="#E5E5E5"> that sounds pretty</font>

546
00:21:54,480 --> 00:21:59,580
innocent<font color="#CCCCCC"> all it's</font><font color="#E5E5E5"> going to tell you is</font>

547
00:21:56,520 --> 00:22:01,920
what is the<font color="#E5E5E5"> model what is the SSID of</font>

548
00:21:59,580 --> 00:22:06,300
the network and what's<font color="#CCCCCC"> AP address of it</font>

549
00:22:01,920 --> 00:22:08,700
the second one is even smaller<font color="#E5E5E5"> but by</font>

550
00:22:06,300 --> 00:22:10,080
itself this<font color="#E5E5E5"> is the one that we</font><font color="#CCCCCC"> actually</font>

551
00:22:08,700 --> 00:22:11,129
still<font color="#E5E5E5"> arguing with</font><font color="#CCCCCC"> ASUS about they</font>

552
00:22:10,080 --> 00:22:13,289
haven't fixed it<font color="#CCCCCC"> because they don't</font>

553
00:22:11,129 --> 00:22:15,269
<font color="#E5E5E5">consider this to be an issue</font><font color="#CCCCCC"> I consider</font>

554
00:22:13,289 --> 00:22:18,269
this to<font color="#E5E5E5"> be an issue because it's another</font>

555
00:22:15,269 --> 00:22:20,850
way in<font color="#E5E5E5"> further in like for</font><font color="#CCCCCC"> example the</font>

556
00:22:18,269 --> 00:22:22,649
<font color="#E5E5E5">model number some of the</font><font color="#CCCCCC"> Asus models</font>

557
00:22:20,850 --> 00:22:23,730
have<font color="#CCCCCC"> patches some</font><font color="#E5E5E5"> of them do</font><font color="#CCCCCC"> not if I</font>

558
00:22:22,649 --> 00:22:25,379
<font color="#E5E5E5">know what the model number of your</font>

559
00:22:23,730 --> 00:22:28,769
<font color="#E5E5E5">router is then I can target specific</font>

560
00:22:25,379 --> 00:22:31,230
<font color="#E5E5E5">attacks to that model</font><font color="#CCCCCC"> I think in they</font>

561
00:22:28,769 --> 00:22:32,399
are convinced at<font color="#CCCCCC"> this point there is</font>

562
00:22:31,230 --> 00:22:32,609
<font color="#E5E5E5">this an issue but they haven't fixed it</font>

563
00:22:32,399 --> 00:22:34,738
yet

564
00:22:32,609 --> 00:22:37,710
<font color="#E5E5E5">so you have you you have your website</font>

565
00:22:34,739 --> 00:22:39,840
<font color="#CCCCCC">you call</font><font color="#E5E5E5"> these two endpoints you get</font>

566
00:22:37,710 --> 00:22:42,289
some data back now you know the user is

567
00:22:39,840 --> 00:22:45,418
running<font color="#E5E5E5"> they're running an Asus router</font>

568
00:22:42,289 --> 00:22:47,009
<font color="#CCCCCC">this is an example</font><font color="#E5E5E5"> of an actual code</font>

569
00:22:45,419 --> 00:22:49,200
<font color="#E5E5E5">that will do that I have it's called in</font>

570
00:22:47,009 --> 00:22:50,999
my blog this<font color="#CCCCCC"> highway</font><font color="#E5E5E5"> this is a very very</font>

571
00:22:49,200 --> 00:22:52,350
<font color="#CCCCCC">basic way of doing it obviously</font><font color="#E5E5E5"> more</font>

572
00:22:50,999 --> 00:22:54,980
sophisticated way of doing it<font color="#E5E5E5"> but this</font>

573
00:22:52,350 --> 00:23:00,418
is<font color="#E5E5E5"> how you would do this in JavaScript</font>

574
00:22:54,980 --> 00:23:03,419
you append a child element with a script

575
00:23:00,419 --> 00:23:05,009
include you call whatever<font color="#E5E5E5"> that</font><font color="#CCCCCC"> endpoint</font>

576
00:23:03,419 --> 00:23:07,470
is either<font color="#E5E5E5"> will come back when an arrow</font>

577
00:23:05,009 --> 00:23:11,159
will<font color="#E5E5E5"> come back with the data</font><font color="#CCCCCC"> you looking</font>

578
00:23:07,470 --> 00:23:13,139
for next step is the actual login the

579
00:23:11,159 --> 00:23:16,409
default login for the<font color="#E5E5E5"> router is admin</font>

580
00:23:13,139 --> 00:23:18,748
admin<font color="#E5E5E5"> it needs to be base64 encoded very</font>

581
00:23:16,409 --> 00:23:21,960
simple example just<font color="#CCCCCC"> a form you fill Phi</font>

582
00:23:18,749 --> 00:23:23,940
the form<font color="#E5E5E5"> you do form</font><font color="#CCCCCC"> that submit either</font>

583
00:23:21,960 --> 00:23:26,009
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> in and you're not</font><font color="#E5E5E5"> in any way you</font>

584
00:23:23,940 --> 00:23:28,230
verify that<font color="#E5E5E5"> is the next step but</font>

585
00:23:26,009 --> 00:23:31,889
<font color="#E5E5E5">essentially this relies</font><font color="#CCCCCC"> in the fact that</font>

586
00:23:28,230 --> 00:23:33,779
<font color="#E5E5E5">the user is not the user will not change</font>

587
00:23:31,889 --> 00:23:36,928
their credentials which is true in<font color="#CCCCCC"> most</font>

588
00:23:33,779 --> 00:23:39,149
cases<font color="#E5E5E5"> however</font><font color="#CCCCCC"> I do want to</font><font color="#E5E5E5"> point out in</font>

589
00:23:36,929 --> 00:23:40,409
this point<font color="#E5E5E5"> this step if they change</font>

590
00:23:39,149 --> 00:23:43,080
their credentials it's not much you can

591
00:23:40,409 --> 00:23:45,899
do so it does<font color="#CCCCCC"> rely</font><font color="#E5E5E5"> there's multiple</font>

592
00:23:43,080 --> 00:23:47,189
steps<font color="#E5E5E5"> here</font><font color="#CCCCCC"> that need to happen but based</font>

593
00:23:45,899 --> 00:23:48,600
on what I've seen<font color="#E5E5E5"> out</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> and the</font>

594
00:23:47,190 --> 00:23:51,149
service<font color="#E5E5E5"> they were done most users do</font><font color="#CCCCCC"> not</font>

595
00:23:48,600 --> 00:23:52,498
change the credentials<font color="#CCCCCC"> if they did</font>

596
00:23:51,149 --> 00:23:54,268
<font color="#E5E5E5">change their credentials then you have</font>

597
00:23:52,499 --> 00:23:57,899
to go with<font color="#E5E5E5"> you know you conventional</font>

598
00:23:54,269 --> 00:24:01,499
<font color="#E5E5E5">phishing or something similar</font><font color="#CCCCCC"> so at this</font>

599
00:23:57,899 --> 00:24:02,908
point you know there are router IP you

600
00:24:01,499 --> 00:24:05,159
know it's running<font color="#CCCCCC"> an Asus you</font><font color="#E5E5E5"> know which</font>

601
00:24:02,909 --> 00:24:08,850
model<font color="#CCCCCC"> is is it's running and you're able</font>

602
00:24:05,159 --> 00:24:10,499
to<font color="#CCCCCC"> log in</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the interface now you can</font>

603
00:24:08,850 --> 00:24:13,559
collect additional information<font color="#E5E5E5"> here if</font>

604
00:24:10,499 --> 00:24:15,690
you want<font color="#E5E5E5"> the CV</font><font color="#CCCCCC"> there highlight on top</font>

605
00:24:13,559 --> 00:24:17,399
which is<font color="#E5E5E5"> the</font><font color="#CCCCCC"> XML one is not accessible</font>

606
00:24:15,690 --> 00:24:19,379
from<font color="#E5E5E5"> the web but if you make a fake</font>

607
00:24:17,399 --> 00:24:21,029
<font color="#CCCCCC">mobile application or that's application</font>

608
00:24:19,379 --> 00:24:22,770
you<font color="#E5E5E5"> can access it that gives you the</font>

609
00:24:21,029 --> 00:24:25,799
Wi-Fi<font color="#CCCCCC"> password</font>

610
00:24:22,770 --> 00:24:28,950
I don't know how valuable<font color="#E5E5E5"> Wi-Fi password</font>

611
00:24:25,799 --> 00:24:31,710
would<font color="#E5E5E5"> be or not because if</font><font color="#CCCCCC"> you're local</font>

612
00:24:28,950 --> 00:24:34,500
<font color="#E5E5E5">to the network it may</font><font color="#CCCCCC"> be may be valuable</font>

613
00:24:31,710 --> 00:24:36,330
if you're<font color="#E5E5E5"> not</font><font color="#CCCCCC"> local to it you then the</font>

614
00:24:34,500 --> 00:24:39,410
<font color="#CCCCCC">password has to be reusable somewhere</font>

615
00:24:36,330 --> 00:24:45,689
else I<font color="#CCCCCC"> don't know how true that is the</font>

616
00:24:39,410 --> 00:24:48,960
<font color="#CCCCCC">second one is 58 92</font><font color="#E5E5E5"> there's a second set</font>

617
00:24:45,690 --> 00:24:50,299
of JSON<font color="#E5E5E5"> endpoints so in the one the</font>

618
00:24:48,960 --> 00:24:54,270
previous<font color="#E5E5E5"> steps are highlighted again</font>

619
00:24:50,299 --> 00:24:55,530
<font color="#CCCCCC">JSONP can be done cross domain this is</font>

620
00:24:54,270 --> 00:24:57,240
<font color="#CCCCCC">the second</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> that I should like in</font>

621
00:24:55,530 --> 00:24:59,850
additional<font color="#CCCCCC"> information you could</font><font color="#E5E5E5"> get</font>

622
00:24:57,240 --> 00:25:02,970
information about<font color="#E5E5E5"> the router about</font>

623
00:24:59,850 --> 00:25:05,340
things<font color="#CCCCCC"> that are attached</font><font color="#E5E5E5"> to it here's</font>

624
00:25:02,970 --> 00:25:07,679
<font color="#E5E5E5">some examples information about what the</font>

625
00:25:05,340 --> 00:25:09,270
<font color="#E5E5E5">one link looks like you could get the</font>

626
00:25:07,679 --> 00:25:11,429
next to a pretty<font color="#E5E5E5"> interesting that as an</font>

627
00:25:09,270 --> 00:25:13,830
active scan<font color="#E5E5E5"> around all this around the</font>

628
00:25:11,429 --> 00:25:16,409
access points there it<font color="#E5E5E5"> takes a it</font><font color="#CCCCCC"> takes</font>

629
00:25:13,830 --> 00:25:17,850
some time<font color="#E5E5E5"> it actually puts</font><font color="#CCCCCC"> Loden on the</font>

630
00:25:16,409 --> 00:25:20,039
router<font color="#E5E5E5"> you could potentially do as the</font>

631
00:25:17,850 --> 00:25:21,658
router<font color="#E5E5E5"> that way the next</font><font color="#CCCCCC"> one gives you</font>

632
00:25:20,039 --> 00:25:23,700
information about<font color="#E5E5E5"> the local network</font><font color="#CCCCCC"> you</font>

633
00:25:21,659 --> 00:25:25,500
get origin information information about

634
00:25:23,700 --> 00:25:27,720
<font color="#E5E5E5">the external IP the last one can open</font>

635
00:25:25,500 --> 00:25:29,150
web dev access to the router<font color="#CCCCCC"> the web dev</font>

636
00:25:27,720 --> 00:25:32,130
access is routed through<font color="#E5E5E5"> another server</font>

637
00:25:29,150 --> 00:25:35,039
so all of<font color="#E5E5E5"> these things are</font><font color="#CCCCCC"> interesting</font>

638
00:25:32,130 --> 00:25:39,720
but I don't know how<font color="#E5E5E5"> much you can do</font>

639
00:25:35,039 --> 00:25:41,280
with them<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> interesting the here's</font>

640
00:25:39,720 --> 00:25:43,080
<font color="#E5E5E5">example</font><font color="#CCCCCC"> getting this term I P address</font>

641
00:25:41,280 --> 00:25:43,830
now why is this gonna<font color="#E5E5E5"> be address</font>

642
00:25:43,080 --> 00:25:45,750
important

643
00:25:43,830 --> 00:25:48,360
maybe they open the internal<font color="#CCCCCC"> access on</font>

644
00:25:45,750 --> 00:25:50,429
the router maybe not most<font color="#E5E5E5"> races routers</font>

645
00:25:48,360 --> 00:25:52,408
do not have that open but there's an

646
00:25:50,429 --> 00:25:55,169
<font color="#CCCCCC">example</font><font color="#E5E5E5"> of what you</font><font color="#CCCCCC"> can collect</font><font color="#E5E5E5"> again</font>

647
00:25:52,409 --> 00:25:58,409
very simplistic<font color="#E5E5E5"> this is no libraries</font>

648
00:25:55,169 --> 00:26:00,299
nothing<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> HTML</font><font color="#E5E5E5"> 101 there's nothing</font>

649
00:25:58,409 --> 00:26:03,539
complicated here or how you actually get

650
00:26:00,299 --> 00:26:06,210
<font color="#CCCCCC">information into the browser</font><font color="#E5E5E5"> this is</font>

651
00:26:03,539 --> 00:26:09,900
where everything<font color="#E5E5E5"> comes together so at</font>

652
00:26:06,210 --> 00:26:11,970
this<font color="#E5E5E5"> point you have a user on the same</font>

653
00:26:09,900 --> 00:26:13,590
network<font color="#E5E5E5"> into visiting a malicious page</font>

654
00:26:11,970 --> 00:26:18,000
not a phishing page just<font color="#E5E5E5"> a malicious</font>

655
00:26:13,590 --> 00:26:22,049
page the page<font color="#E5E5E5"> used</font><font color="#CCCCCC"> WebRTC to find out a</font>

656
00:26:18,000 --> 00:26:24,480
<font color="#E5E5E5">local IP range we did a JSONP call to</font>

657
00:26:22,049 --> 00:26:27,059
figure<font color="#E5E5E5"> out</font><font color="#CCCCCC"> Asus router with the</font><font color="#E5E5E5"> CSRF to</font>

658
00:26:24,480 --> 00:26:29,280
<font color="#E5E5E5">log in you could where we want because</font>

659
00:26:27,059 --> 00:26:30,690
<font color="#E5E5E5">every setting in the browser can</font><font color="#CCCCCC"> be</font>

660
00:26:29,280 --> 00:26:33,820
changed<font color="#E5E5E5"> through CSRF</font>

661
00:26:30,690 --> 00:26:37,359
the same way that<font color="#CCCCCC"> the sierra</font><font color="#E5E5E5"> on login</font>

662
00:26:33,820 --> 00:26:39,759
that's<font color="#CCCCCC"> this state to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> state of</font><font color="#E5E5E5"> your</font>

663
00:26:37,359 --> 00:26:41,168
login to the router is there<font color="#E5E5E5"> so for</font>

664
00:26:39,759 --> 00:26:42,340
<font color="#E5E5E5">example</font><font color="#CCCCCC"> if user is logged in and you</font>

665
00:26:41,169 --> 00:26:44,679
<font color="#E5E5E5">don't know their credentials you could</font>

666
00:26:42,340 --> 00:26:47,168
do this also but it's easier<font color="#CCCCCC"> to</font><font color="#E5E5E5"> just try</font>

667
00:26:44,679 --> 00:26:49,809
to<font color="#CCCCCC"> log</font><font color="#E5E5E5"> in and you can do all of these</font>

668
00:26:47,169 --> 00:26:52,149
various things<font color="#CCCCCC"> so what I</font><font color="#E5E5E5"> would do is I</font>

669
00:26:49,809 --> 00:26:54,940
would open him on access<font color="#E5E5E5"> I would live in</font>

670
00:26:52,149 --> 00:26:57,340
<font color="#CCCCCC">the</font><font color="#E5E5E5"> remote access to a high port so</font>

671
00:26:54,940 --> 00:26:58,960
<font color="#E5E5E5">Sheldon doesn't find it and I would also</font>

672
00:26:57,340 --> 00:27:01,090
<font color="#CCCCCC">limit the remote access to the IP range</font>

673
00:26:58,960 --> 00:27:03,159
<font color="#CCCCCC">that I</font><font color="#E5E5E5"> want so I can get in and nobody</font>

674
00:27:01,090 --> 00:27:04,509
else can<font color="#CCCCCC"> get</font><font color="#E5E5E5"> in if you want to do you</font>

675
00:27:03,159 --> 00:27:06,070
<font color="#E5E5E5">could change</font><font color="#CCCCCC"> user name password I would</font>

676
00:27:04,509 --> 00:27:07,629
<font color="#E5E5E5">not recommend this is not something the</font>

677
00:27:06,070 --> 00:27:10,059
attacker probably would do<font color="#E5E5E5"> is they</font>

678
00:27:07,629 --> 00:27:11,709
respond because user may figure out

679
00:27:10,059 --> 00:27:12,879
something's wrong but<font color="#CCCCCC"> then again how</font>

680
00:27:11,710 --> 00:27:15,669
often<font color="#E5E5E5"> does somebody log into the router</font>

681
00:27:12,879 --> 00:27:17,498
so<font color="#CCCCCC"> of all</font><font color="#E5E5E5"> of the vulnerabilities of</font>

682
00:27:15,669 --> 00:27:20,440
<font color="#E5E5E5">those four this is</font><font color="#CCCCCC"> the one that's</font><font color="#E5E5E5"> the</font>

683
00:27:17,499 --> 00:27:21,639
<font color="#CCCCCC">most severe because this one</font><font color="#E5E5E5"> actually</font>

684
00:27:20,440 --> 00:27:24,659
lets you change the<font color="#CCCCCC"> settings on the</font>

685
00:27:21,639 --> 00:27:27,820
router<font color="#E5E5E5"> but to exploit this successfully</font>

686
00:27:24,659 --> 00:27:31,119
<font color="#E5E5E5">it's not something you can do from</font>

687
00:27:27,820 --> 00:27:32,859
outside<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to actually be user has</font>

688
00:27:31,119 --> 00:27:35,019
to be on a local<font color="#CCCCCC"> network</font><font color="#E5E5E5"> and they have</font>

689
00:27:32,859 --> 00:27:37,899
to be able to hit a page you're giving

690
00:27:35,019 --> 00:27:39,970
them<font color="#E5E5E5"> I haven't tried weather outlook or</font>

691
00:27:37,899 --> 00:27:42,939
something that's web-based but not

692
00:27:39,970 --> 00:27:45,179
browser-based<font color="#CCCCCC"> can do this I don't think</font>

693
00:27:42,940 --> 00:27:49,289
<font color="#E5E5E5">you can because javascript is limited so</font>

694
00:27:45,179 --> 00:27:51,940
<font color="#CCCCCC">you gotta get</font><font color="#E5E5E5"> them to visit</font><font color="#CCCCCC"> a page now</font>

695
00:27:49,289 --> 00:27:53,529
this is the<font color="#E5E5E5"> admission of UI for the Asus</font>

696
00:27:51,940 --> 00:27:56,080
router<font color="#CCCCCC"> those are all the various</font><font color="#E5E5E5"> options</font>

697
00:27:53,529 --> 00:28:00,789
<font color="#CCCCCC">this</font><font color="#E5E5E5"> just a few of them but it's way way</font>

698
00:27:56,080 --> 00:28:02,499
<font color="#CCCCCC">more of</font><font color="#E5E5E5"> them in there</font><font color="#CCCCCC"> and basically this</font>

699
00:28:00,789 --> 00:28:05,080
<font color="#CCCCCC">is how you would actually tune</font><font color="#E5E5E5"> on remote</font>

700
00:28:02,499 --> 00:28:06,820
access again it's<font color="#CCCCCC"> very simple it's a web</font>

701
00:28:05,080 --> 00:28:08,439
form<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> to be able to you have</font><font color="#E5E5E5"> to</font>

702
00:28:06,820 --> 00:28:10,889
<font color="#E5E5E5">be logged in from the</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> in the</font>

703
00:28:08,440 --> 00:28:12,849
previous steps<font color="#E5E5E5"> once you logged in</font>

704
00:28:10,889 --> 00:28:15,879
basically<font color="#E5E5E5"> this is what you do this code</font>

705
00:28:12,849 --> 00:28:18,609
is incomplete<font color="#CCCCCC"> in purpose but anybody who</font>

706
00:28:15,879 --> 00:28:20,289
<font color="#E5E5E5">digs into</font><font color="#CCCCCC"> the UI can figure it out I</font>

707
00:28:18,609 --> 00:28:22,960
have not been<font color="#CCCCCC"> able to consistently</font>

708
00:28:20,289 --> 00:28:25,239
reproduce it on my router<font color="#CCCCCC"> 100%</font><font color="#E5E5E5"> of the</font>

709
00:28:22,960 --> 00:28:26,919
<font color="#E5E5E5">time it only works sometimes</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> suspect</font>

710
00:28:25,239 --> 00:28:29,289
there's a<font color="#CCCCCC"> timeout</font><font color="#E5E5E5"> of some sort in there</font>

711
00:28:26,919 --> 00:28:31,479
other people have reproduces

712
00:28:29,289 --> 00:28:33,639
successfully and left comments<font color="#E5E5E5"> on the</font>

713
00:28:31,479 --> 00:28:36,729
blog<font color="#E5E5E5"> and saying that other models don't</font>

714
00:28:33,639 --> 00:28:41,139
<font color="#E5E5E5">have the timeout</font><font color="#CCCCCC"> but again this is a</font>

715
00:28:36,729 --> 00:28:44,499
<font color="#E5E5E5">very simple very simple attack CSRF form</font>

716
00:28:41,139 --> 00:28:45,229
<font color="#E5E5E5">that submit and and that's it you're in</font>

717
00:28:44,499 --> 00:28:47,659
there

718
00:28:45,230 --> 00:28:49,880
here's another<font color="#E5E5E5"> example in the UI</font><font color="#CCCCCC"> also</font>

719
00:28:47,659 --> 00:28:53,120
let's say you do<font color="#CCCCCC"> not want to do</font><font color="#E5E5E5"> that but</font>

720
00:28:49,880 --> 00:28:55,760
you<font color="#E5E5E5"> want to see what the person is doing</font>

721
00:28:53,120 --> 00:28:57,620
on<font color="#CCCCCC"> the router on</font><font color="#E5E5E5"> the network</font><font color="#CCCCCC"> level</font><font color="#E5E5E5"> there</font>

722
00:28:55,760 --> 00:28:59,450
<font color="#E5E5E5">is a remote logging server there</font><font color="#CCCCCC"> I don't</font>

723
00:28:57,620 --> 00:29:00,889
<font color="#CCCCCC">know how detailed those I don't know</font>

724
00:28:59,450 --> 00:29:03,529
<font color="#CCCCCC">whether it goes into actual network</font>

725
00:29:00,889 --> 00:29:08,090
level<font color="#E5E5E5"> but that's another example</font><font color="#CCCCCC"> you do</font>

726
00:29:03,529 --> 00:29:10,070
a<font color="#E5E5E5"> CSRF attack same way and you go and</font>

727
00:29:08,090 --> 00:29:10,699
change the settings and then<font color="#E5E5E5"> the user</font>

728
00:29:10,070 --> 00:29:11,720
doesn't know anything

729
00:29:10,700 --> 00:29:15,260
they're not gonna know<font color="#E5E5E5"> what's gonna</font>

730
00:29:11,720 --> 00:29:16,789
happen<font color="#CCCCCC"> so what what's the worst</font><font color="#E5E5E5"> thing</font>

731
00:29:15,260 --> 00:29:17,720
you can do<font color="#E5E5E5"> you can have any mode that</font>

732
00:29:16,789 --> 00:29:19,279
you can<font color="#E5E5E5"> have a missionary access the</font>

733
00:29:17,720 --> 00:29:21,710
router now one thing<font color="#CCCCCC"> also that's</font>

734
00:29:19,279 --> 00:29:22,909
interesting which<font color="#E5E5E5"> is the last point yeah</font>

735
00:29:21,710 --> 00:29:24,080
you can mess with the router you<font color="#CCCCCC"> can</font>

736
00:29:22,909 --> 00:29:26,330
mess with<font color="#E5E5E5"> another experience you could</font>

737
00:29:24,080 --> 00:29:28,519
<font color="#CCCCCC">diminish of</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> you'd also be</font><font color="#E5E5E5"> the</font>

738
00:29:26,330 --> 00:29:31,210
former<font color="#CCCCCC"> the users not gonna know anything</font>

739
00:29:28,519 --> 00:29:33,440
at that point<font color="#CCCCCC"> I</font><font color="#E5E5E5"> mean that's also</font>

740
00:29:31,210 --> 00:29:35,750
<font color="#E5E5E5">something that can be done through CSRF</font>

741
00:29:33,440 --> 00:29:39,559
as well at that<font color="#CCCCCC"> point it may become</font>

742
00:29:35,750 --> 00:29:41,179
somewhat warmer<font color="#E5E5E5"> wool again if there's a</font>

743
00:29:39,559 --> 00:29:44,629
<font color="#CCCCCC">worm it's spreading it has to get to the</font>

744
00:29:41,179 --> 00:29:46,460
other users and<font color="#E5E5E5"> with application level</font>

745
00:29:44,630 --> 00:29:48,200
attacks is kind of hard<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that but</font>

746
00:29:46,460 --> 00:29:49,190
<font color="#E5E5E5">yeah if you have a bishop access a</font>

747
00:29:48,200 --> 00:29:51,889
<font color="#E5E5E5">router you could update the firmware</font>

748
00:29:49,190 --> 00:29:53,480
<font color="#CCCCCC">there's at least two open source ones</font>

749
00:29:51,889 --> 00:29:56,299
that are<font color="#CCCCCC"> out there</font><font color="#E5E5E5"> it's trivial to</font>

750
00:29:53,480 --> 00:29:58,850
download and modify them<font color="#CCCCCC"> so that's</font>

751
00:29:56,299 --> 00:30:02,899
basically you know<font color="#CCCCCC"> just to go back</font><font color="#E5E5E5"> to</font>

752
00:29:58,850 --> 00:30:05,178
the exploit chain is you get them<font color="#E5E5E5"> to</font>

753
00:30:02,899 --> 00:30:08,360
visit<font color="#E5E5E5"> the malicious page detect</font><font color="#CCCCCC"> a pea</font>

754
00:30:05,179 --> 00:30:10,610
<font color="#CCCCCC">wrench</font><font color="#E5E5E5"> to WebRTC figure out if step</font>

755
00:30:08,360 --> 00:30:13,729
<font color="#CCCCCC">three if they have an Asus router login</font>

756
00:30:10,610 --> 00:30:15,408
through<font color="#E5E5E5"> CSRF number five you could</font>

757
00:30:13,730 --> 00:30:16,850
collect<font color="#E5E5E5"> the data if you want to it might</font>

758
00:30:15,409 --> 00:30:20,090
not be helpful<font color="#E5E5E5"> to anyone</font><font color="#CCCCCC"> you could</font>

759
00:30:16,850 --> 00:30:22,699
<font color="#E5E5E5">choose not to number six you do remote</font>

760
00:30:20,090 --> 00:30:24,439
<font color="#E5E5E5">remote access or change the settings or</font>

761
00:30:22,700 --> 00:30:26,419
<font color="#CCCCCC">firmware</font><font color="#E5E5E5"> whatever it is that you want to</font>

762
00:30:24,440 --> 00:30:29,029
do<font color="#E5E5E5"> actual malicious activity and then</font>

763
00:30:26,419 --> 00:30:31,130
you basically done<font color="#CCCCCC"> now one last</font><font color="#E5E5E5"> thing</font>

764
00:30:29,029 --> 00:30:33,980
also<font color="#E5E5E5"> now I mentioned that this</font><font color="#CCCCCC"> is all</font>

765
00:30:31,130 --> 00:30:37,070
<font color="#CCCCCC">about application security</font><font color="#E5E5E5"> however one</font>

766
00:30:33,980 --> 00:30:39,850
more thing after I found mine somebody

767
00:30:37,070 --> 00:30:42,740
<font color="#E5E5E5">found a bunch of network level ones so</font>

768
00:30:39,850 --> 00:30:45,080
just what I will focused on was

769
00:30:42,740 --> 00:30:48,950
application<font color="#E5E5E5"> security however there are</font>

770
00:30:45,080 --> 00:30:51,470
other attacks in the firmware<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are</font>

771
00:30:48,950 --> 00:30:52,669
also network based<font color="#CCCCCC"> there</font><font color="#E5E5E5"> is very little</font>

772
00:30:51,470 --> 00:30:53,179
information available<font color="#CCCCCC"> about these two</font>

773
00:30:52,669 --> 00:30:55,429
CVEs

774
00:30:53,179 --> 00:30:56,720
the only<font color="#E5E5E5"> that's available is that</font><font color="#CCCCCC"> Asus</font>

775
00:30:55,429 --> 00:30:59,090
<font color="#CCCCCC">has not fixed</font><font color="#E5E5E5"> them</font>

776
00:30:56,720 --> 00:31:00,710
and it's<font color="#E5E5E5"> unclear whether</font><font color="#CCCCCC"> it could</font><font color="#E5E5E5"> be</font>

777
00:30:59,090 --> 00:31:02,240
remotely exploitable<font color="#CCCCCC"> or locally</font>

778
00:31:00,710 --> 00:31:04,850
exploitable but that's where you

779
00:31:02,240 --> 00:31:06,770
<font color="#CCCCCC">basically get back into the net sack</font>

780
00:31:04,850 --> 00:31:10,539
territory now

781
00:31:06,770 --> 00:31:10,539
what I learned<font color="#CCCCCC"> from this</font><font color="#E5E5E5"> is that</font>

782
00:31:10,870 --> 00:31:14,719
<font color="#E5E5E5">manufacturers of routers don't</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't</font>

783
00:31:12,650 --> 00:31:15,860
<font color="#E5E5E5">know much about security now we</font><font color="#CCCCCC"> would</font>

784
00:31:14,720 --> 00:31:17,510
hope they know something about<font color="#E5E5E5"> network</font>

785
00:31:15,860 --> 00:31:20,059
<font color="#CCCCCC">security but what I found is</font><font color="#E5E5E5"> application</font>

786
00:31:17,510 --> 00:31:21,020
<font color="#E5E5E5">security often is even worse it's also</font>

787
00:31:20,059 --> 00:31:22,940
important to<font color="#E5E5E5"> know what kind</font><font color="#CCCCCC"> of router</font>

788
00:31:21,020 --> 00:31:26,179
you have<font color="#E5E5E5"> now my the router that</font><font color="#CCCCCC"> I've</font>

789
00:31:22,940 --> 00:31:27,860
used the Asus router<font color="#E5E5E5"> when I was doing</font>

790
00:31:26,179 --> 00:31:29,270
<font color="#CCCCCC">this work which was last December they</font>

791
00:31:27,860 --> 00:31:31,820
haven't had any<font color="#E5E5E5"> security patches I think</font>

792
00:31:29,270 --> 00:31:33,440
for two years at that point<font color="#CCCCCC"> since they</font>

793
00:31:31,820 --> 00:31:34,850
released<font color="#E5E5E5"> this patch which was back in</font>

794
00:31:33,440 --> 00:31:38,299
March there's no more patches since

795
00:31:34,850 --> 00:31:40,070
since then so I would<font color="#E5E5E5"> not necessarily</font>

796
00:31:38,299 --> 00:31:42,200
<font color="#CCCCCC">become you know</font><font color="#E5E5E5"> when you're buying a</font>

797
00:31:40,070 --> 00:31:45,289
router<font color="#CCCCCC"> make sure you know what you're</font>

798
00:31:42,200 --> 00:31:46,880
buying<font color="#E5E5E5"> and</font><font color="#CCCCCC"> make sure it's updated the</font>

799
00:31:45,289 --> 00:31:48,230
other option you<font color="#E5E5E5"> could do is go</font><font color="#CCCCCC"> with</font>

800
00:31:46,880 --> 00:31:52,190
<font color="#E5E5E5">open source</font><font color="#CCCCCC"> firmware</font><font color="#E5E5E5"> open source</font>

801
00:31:48,230 --> 00:31:54,679
firmware like open wrt<font color="#CCCCCC"> Merlyn they some</font>

802
00:31:52,190 --> 00:31:56,330
they maintain their stuff better<font color="#E5E5E5"> but</font>

803
00:31:54,679 --> 00:31:58,460
<font color="#E5E5E5">again the vulnerabilities</font><font color="#CCCCCC"> that I'm</font>

804
00:31:56,330 --> 00:32:00,830
discussing here unfortunately<font color="#E5E5E5"> are in</font>

805
00:31:58,460 --> 00:32:02,720
both<font color="#E5E5E5"> because I have it necessarily</font><font color="#CCCCCC"> seen</font>

806
00:32:00,830 --> 00:32:05,570
the open<font color="#E5E5E5"> source ones fix them</font><font color="#CCCCCC"> before the</font>

807
00:32:02,720 --> 00:32:06,950
manufacturer does admin credentials need

808
00:32:05,570 --> 00:32:09,950
to be changed that's<font color="#E5E5E5"> an important point</font>

809
00:32:06,950 --> 00:32:13,700
<font color="#E5E5E5">we think that the network boundary</font>

810
00:32:09,950 --> 00:32:16,700
cannot be breached easily<font color="#CCCCCC"> in</font><font color="#E5E5E5"> this case a</font>

811
00:32:13,700 --> 00:32:18,919
<font color="#E5E5E5">CSRF attack or</font><font color="#CCCCCC"> JSONP attack is something</font>

812
00:32:16,700 --> 00:32:21,200
that a<font color="#E5E5E5"> lot of people who operate</font><font color="#CCCCCC"> on a</font>

813
00:32:18,919 --> 00:32:22,730
network<font color="#CCCCCC"> land once early realize and are</font>

814
00:32:21,200 --> 00:32:24,830
able<font color="#E5E5E5"> to even do applications on</font><font color="#CCCCCC"> it</font>

815
00:32:22,730 --> 00:32:27,110
<font color="#CCCCCC">certainly realize the router is a box</font>

816
00:32:24,830 --> 00:32:28,220
<font color="#E5E5E5">but it's got a UI if it's got a UI and</font>

817
00:32:27,110 --> 00:32:31,039
<font color="#E5E5E5">then it's got an application its</font>

818
00:32:28,220 --> 00:32:33,799
identification<font color="#CCCCCC"> by vulnerable</font><font color="#E5E5E5"> CSRF</font><font color="#CCCCCC"> JSONP</font>

819
00:32:31,039 --> 00:32:35,809
those kind of things can cross<font color="#CCCCCC"> from one</font>

820
00:32:33,799 --> 00:32:37,879
<font color="#CCCCCC">side to another and bypass browser</font>

821
00:32:35,809 --> 00:32:39,559
security<font color="#CCCCCC"> another thing</font><font color="#E5E5E5"> that I do</font>

822
00:32:37,880 --> 00:32:41,059
<font color="#E5E5E5">recommend if you want</font><font color="#CCCCCC"> to deal with your</font>

823
00:32:39,559 --> 00:32:42,710
<font color="#E5E5E5">browser or with your router which</font><font color="#CCCCCC"> is</font>

824
00:32:41,059 --> 00:32:44,510
something a lot of<font color="#E5E5E5"> the southern edge of</font>

825
00:32:42,710 --> 00:32:46,070
<font color="#E5E5E5">my own routers</font><font color="#CCCCCC"> I do not administer them</font>

826
00:32:44,510 --> 00:32:48,020
<font color="#E5E5E5">when I'm logged in to somewhere else I</font>

827
00:32:46,070 --> 00:32:50,870
go into anonymous mode in somewhere<font color="#E5E5E5"> else</font>

828
00:32:48,020 --> 00:32:53,120
<font color="#E5E5E5">and I like</font><font color="#CCCCCC"> that when I'm done</font><font color="#E5E5E5"> why</font>

829
00:32:50,870 --> 00:32:55,100
because these<font color="#E5E5E5"> kind of attacks and I'm</font>

830
00:32:53,120 --> 00:32:56,418
describing<font color="#E5E5E5"> can't be done without you</font>

831
00:32:55,100 --> 00:32:58,699
knowing it you<font color="#E5E5E5"> will not know anything</font>

832
00:32:56,419 --> 00:33:00,679
<font color="#E5E5E5">you could be logged into your router and</font>

833
00:32:58,700 --> 00:33:02,169
<font color="#E5E5E5">you can be visiting some site and you</font>

834
00:33:00,679 --> 00:33:04,400
<font color="#CCCCCC">may not realize there is</font><font color="#E5E5E5"> a piece of</font>

835
00:33:02,169 --> 00:33:06,320
advertising<font color="#E5E5E5"> code that brings in a piece</font>

836
00:33:04,400 --> 00:33:07,429
<font color="#E5E5E5">of JavaScript and in that piece of</font>

837
00:33:06,320 --> 00:33:10,490
JavaScript I was talking to<font color="#E5E5E5"> your honor</font>

838
00:33:07,429 --> 00:33:12,620
because<font color="#E5E5E5"> these type of attacks CSRF</font>

839
00:33:10,490 --> 00:33:14,450
j7p<font color="#CCCCCC"> in</font><font color="#E5E5E5"> cross from side to side without</font>

840
00:33:12,620 --> 00:33:16,699
anybody<font color="#CCCCCC"> knowing anything</font>

841
00:33:14,450 --> 00:33:18,740
last piece<font color="#E5E5E5"> also is that</font><font color="#CCCCCC"> when I was</font>

842
00:33:16,700 --> 00:33:22,280
originally<font color="#E5E5E5"> trying to find information</font>

843
00:33:18,740 --> 00:33:24,920
<font color="#E5E5E5">about the</font><font color="#CCCCCC"> ASA security team there's a</font>

844
00:33:22,280 --> 00:33:26,990
lot of<font color="#E5E5E5"> interesting stuff out there</font><font color="#CCCCCC"> and</font>

845
00:33:24,920 --> 00:33:29,420
<font color="#E5E5E5">none of it was from Asus</font><font color="#CCCCCC"> a lot of and</font>

846
00:33:26,990 --> 00:33:32,929
part of the problem<font color="#CCCCCC"> oasis is has</font>

847
00:33:29,420 --> 00:33:35,240
multiple country sites<font color="#E5E5E5"> so some</font><font color="#CCCCCC"> of the</font>

848
00:33:32,929 --> 00:33:38,290
attacks here especially<font color="#CCCCCC"> on the mobile</font>

849
00:33:35,240 --> 00:33:40,820
<font color="#E5E5E5">side which I didn't dig into a lot but</font>

850
00:33:38,290 --> 00:33:42,139
if you have an<font color="#CCCCCC"> asus app you better make</font>

851
00:33:40,820 --> 00:33:44,360
<font color="#CCCCCC">sure it's</font><font color="#E5E5E5"> actually comes from asus and</font>

852
00:33:42,140 --> 00:33:45,860
<font color="#E5E5E5">sending for that stuff if this is if you</font>

853
00:33:44,360 --> 00:33:47,000
want<font color="#E5E5E5"> to make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that's an</font><font color="#CCCCCC"> Isis website</font>

854
00:33:45,860 --> 00:33:50,209
you got to make sure it's coming<font color="#E5E5E5"> from</font>

855
00:33:47,000 --> 00:33:52,510
<font color="#E5E5E5">Asus especially since one of these that</font>

856
00:33:50,210 --> 00:33:54,650
I've seen is<font color="#CCCCCC"> some of the main name stuff</font>

857
00:33:52,510 --> 00:33:56,450
<font color="#CCCCCC">those domain names of Asus have</font>

858
00:33:54,650 --> 00:33:58,520
registered I'm not actually registered

859
00:33:56,450 --> 00:34:00,410
publicly and someone can register them

860
00:33:58,520 --> 00:34:03,559
publicly<font color="#CCCCCC"> and grab them</font><font color="#E5E5E5"> so there's a lot</font>

861
00:34:00,410 --> 00:34:05,290
of<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of sort of things to keep in</font>

862
00:34:03,559 --> 00:34:08,090
<font color="#E5E5E5">mind when</font><font color="#CCCCCC"> you're when you're Virata</font>

863
00:34:05,290 --> 00:34:11,029
<font color="#E5E5E5">everything I have here is on my blog</font><font color="#CCCCCC"> on</font>

864
00:34:08,090 --> 00:34:13,340
<font color="#E5E5E5">the blog post all of these CVEs have</font>

865
00:34:11,030 --> 00:34:15,409
been reported<font color="#CCCCCC"> as I said three out of</font>

866
00:34:13,340 --> 00:34:18,500
four have been<font color="#CCCCCC"> fixed if you have any</font>

867
00:34:15,409 --> 00:34:22,670
questions feel<font color="#E5E5E5"> free to reach out</font><font color="#CCCCCC"> to the</font>

868
00:34:18,500 --> 00:34:27,559
questions thank<font color="#E5E5E5"> you</font>

869
00:34:22,670 --> 00:34:27,559
[Applause]

