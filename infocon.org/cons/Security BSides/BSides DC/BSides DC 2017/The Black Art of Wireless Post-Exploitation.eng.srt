1
00:00:00,030 --> 00:00:06,060
the besides DC 2017 videos are<font color="#E5E5E5"> brought</font>

2
00:00:03,300 --> 00:00:07,740
to you by threat quotient introducing

3
00:00:06,060 --> 00:00:10,019
<font color="#E5E5E5">the industry's</font><font color="#CCCCCC"> first threat intelligence</font>

4
00:00:07,740 --> 00:00:13,139
platform designed to<font color="#E5E5E5"> enable threat</font>

5
00:00:10,019 --> 00:00:15,960
operations and management<font color="#E5E5E5"> and data tribe</font>

6
00:00:13,139 --> 00:00:17,910
<font color="#CCCCCC">a new kind of</font><font color="#E5E5E5"> startup studio</font><font color="#CCCCCC"> co building</font>

7
00:00:15,960 --> 00:00:21,090
the next<font color="#CCCCCC"> generation of commercial cyber</font>

8
00:00:17,910 --> 00:00:24,000
<font color="#CCCCCC">security analytics and big data product</font>

9
00:00:21,090 --> 00:00:26,970
companies my name is Gabriel<font color="#E5E5E5"> Ryan I'm US</font>

10
00:00:24,000 --> 00:00:29,519
penetration tester at<font color="#E5E5E5"> Gotham digital</font>

11
00:00:26,970 --> 00:00:32,129
science we're like<font color="#CCCCCC"> Aeons</font><font color="#E5E5E5"> security</font>

12
00:00:29,519 --> 00:00:33,019
consulting arm<font color="#CCCCCC"> I guess I could call it</font>

13
00:00:32,130 --> 00:00:35,750
that

14
00:00:33,020 --> 00:00:37,020
<font color="#CCCCCC">anyone here from the Northern Virginia</font>

15
00:00:35,750 --> 00:00:38,040
<font color="#E5E5E5">yeah</font>

16
00:00:37,020 --> 00:00:39,360
no I'm like<font color="#E5E5E5"> really happy to be here</font>

17
00:00:38,040 --> 00:00:40,920
because<font color="#E5E5E5"> like my first security job was</font>

18
00:00:39,360 --> 00:00:42,930
actually<font color="#CCCCCC"> in Northern Virginia so I'm</font>

19
00:00:40,920 --> 00:00:47,160
pretty<font color="#CCCCCC"> thrilled</font><font color="#E5E5E5"> I don't miss the traffic</font>

20
00:00:42,930 --> 00:00:48,210
<font color="#E5E5E5">though you know but yeah so a couple new</font>

21
00:00:47,160 --> 00:00:49,260
<font color="#CCCCCC">things</font><font color="#E5E5E5"> in this presentation we're gonna</font>

22
00:00:48,210 --> 00:00:50,879
be talking about<font color="#E5E5E5"> two new types of</font>

23
00:00:49,260 --> 00:00:52,649
wireless technique we're going<font color="#CCCCCC"> to talk</font>

24
00:00:50,879 --> 00:00:55,170
<font color="#E5E5E5">about hostile portal attacks which is a</font>

25
00:00:52,649 --> 00:00:56,699
way<font color="#CCCCCC"> of grabbing</font><font color="#E5E5E5"> Active Directory</font>

26
00:00:55,170 --> 00:00:58,559
credentials without having direct

27
00:00:56,699 --> 00:00:59,760
<font color="#CCCCCC">network access and</font><font color="#E5E5E5"> we're also going to</font>

28
00:00:58,559 --> 00:01:01,349
<font color="#E5E5E5">talk about indirect</font><font color="#CCCCCC"> Wireless pivots</font>

29
00:00:59,760 --> 00:01:03,599
which is a way of<font color="#CCCCCC"> using rogue</font><font color="#E5E5E5"> ap attacks</font>

30
00:01:01,350 --> 00:01:06,360
<font color="#E5E5E5">to bypass</font><font color="#CCCCCC"> port based access control</font>

31
00:01:03,600 --> 00:01:08,010
mechanisms on<font color="#CCCCCC"> wireless networks so</font>

32
00:01:06,360 --> 00:01:10,710
before we go<font color="#CCCCCC"> into any of this we have to</font>

33
00:01:08,010 --> 00:01:13,650
take<font color="#E5E5E5"> like an obligatory look at wpa2 EAP</font>

34
00:01:10,710 --> 00:01:15,000
and no<font color="#E5E5E5"> discussion</font><font color="#CCCCCC"> about wpa2 EAP is</font>

35
00:01:13,650 --> 00:01:16,470
really complete without<font color="#E5E5E5"> talking</font><font color="#CCCCCC"> about</font>

36
00:01:15,000 --> 00:01:18,030
rogue<font color="#E5E5E5"> ap attacks which is the means that</font>

37
00:01:16,470 --> 00:01:20,460
you typically use<font color="#CCCCCC"> to steal credentials</font>

38
00:01:18,030 --> 00:01:21,900
<font color="#E5E5E5">for these kinds</font><font color="#CCCCCC"> of networks so Rogan</font>

39
00:01:20,460 --> 00:01:23,130
<font color="#CCCCCC">Pete sacs are the</font><font color="#E5E5E5"> real ones the bread</font>

40
00:01:21,900 --> 00:01:25,020
and<font color="#E5E5E5"> butter</font><font color="#CCCCCC"> of modern</font><font color="#E5E5E5"> wireless networks</font>

41
00:01:23,130 --> 00:01:26,850
<font color="#CCCCCC">you can use it for stealthy man the</font>

42
00:01:25,020 --> 00:01:28,470
middle attacks<font color="#E5E5E5"> you know stealing radius</font>

43
00:01:26,850 --> 00:01:31,979
creds as we've said all<font color="#CCCCCC"> kinds of really</font>

44
00:01:28,470 --> 00:01:33,360
<font color="#CCCCCC">cool</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> and the simplest that this</font>

45
00:01:31,979 --> 00:01:35,310
the simplest example of<font color="#E5E5E5"> how to do a</font>

46
00:01:33,360 --> 00:01:37,079
rogue ap attacker the simple simplest

47
00:01:35,310 --> 00:01:39,600
rogue<font color="#E5E5E5"> ap a check out there is something</font>

48
00:01:37,079 --> 00:01:41,369
called<font color="#CCCCCC"> the evil tone attack</font><font color="#E5E5E5"> just to use</font>

49
00:01:39,600 --> 00:01:42,929
an<font color="#CCCCCC"> analogy actually</font><font color="#E5E5E5"> first given to me by</font>

50
00:01:41,369 --> 00:01:45,540
that<font color="#E5E5E5"> guy right there who got me into</font>

51
00:01:42,930 --> 00:01:48,920
<font color="#CCCCCC">wireless big</font><font color="#E5E5E5"> round of applause for that</font>

52
00:01:45,540 --> 00:01:48,920
<font color="#E5E5E5">guy okay</font>

53
00:01:49,409 --> 00:01:55,870
sorry Scott so it's a good<font color="#E5E5E5"> analogy of</font>

54
00:01:54,580 --> 00:01:57,670
<font color="#E5E5E5">like you know how evil twin attacks work</font>

55
00:01:55,870 --> 00:01:59,350
is let's say<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you have an open</font>

56
00:01:57,670 --> 00:02:01,360
<font color="#CCCCCC">network</font><font color="#E5E5E5"> and we're gonna call this</font><font color="#CCCCCC"> DEFCON</font>

57
00:01:59,350 --> 00:02:02,470
open because<font color="#E5E5E5"> it's probably the most</font>

58
00:02:01,360 --> 00:02:04,179
secure<font color="#CCCCCC"> network in existence and</font>

59
00:02:02,470 --> 00:02:05,500
everything yeah<font color="#CCCCCC"> so you have these these</font>

60
00:02:04,180 --> 00:02:07,660
<font color="#E5E5E5">four</font><font color="#CCCCCC"> devices</font><font color="#E5E5E5"> and they're associated with</font>

61
00:02:05,500 --> 00:02:10,389
<font color="#CCCCCC">this network if you</font><font color="#E5E5E5"> were to spin up your</font>

62
00:02:07,660 --> 00:02:11,920
own wireless hotspot<font color="#E5E5E5"> right and you were</font>

63
00:02:10,389 --> 00:02:15,160
to give this<font color="#E5E5E5"> hotspot the same network</font>

64
00:02:11,920 --> 00:02:16,750
<font color="#E5E5E5">name SSID and channel as the one</font><font color="#CCCCCC"> that</font>

65
00:02:15,160 --> 00:02:17,560
<font color="#CCCCCC">you're attacking how</font><font color="#E5E5E5"> would these devices</font>

66
00:02:16,750 --> 00:02:19,450
be able to tell the difference<font color="#CCCCCC"> between</font>

67
00:02:17,560 --> 00:02:20,830
these two these two access points<font color="#CCCCCC"> well</font>

68
00:02:19,450 --> 00:02:21,940
the truth is<font color="#CCCCCC"> that they wouldn't be able</font>

69
00:02:20,830 --> 00:02:24,100
<font color="#CCCCCC">to and as long as you're able to provide</font>

70
00:02:21,940 --> 00:02:26,470
<font color="#CCCCCC">a better</font><font color="#E5E5E5"> signal-to-noise ratio that is</font>

71
00:02:24,100 --> 00:02:28,239
<font color="#E5E5E5">your signal strength is is better than</font>

72
00:02:26,470 --> 00:02:29,380
the other one these devices will

73
00:02:28,239 --> 00:02:31,360
actually drop their connections and

74
00:02:29,380 --> 00:02:34,359
associate with<font color="#CCCCCC"> you so that's that's the</font>

75
00:02:31,360 --> 00:02:35,470
fundamental you know<font color="#CCCCCC"> rogue access</font><font color="#E5E5E5"> point</font>

76
00:02:34,360 --> 00:02:38,590
attack that pretty much everything<font color="#CCCCCC"> else</font>

77
00:02:35,470 --> 00:02:39,489
is based off<font color="#CCCCCC"> of</font><font color="#E5E5E5"> our spans off of so</font>

78
00:02:38,590 --> 00:02:40,989
<font color="#E5E5E5">these attacks I mean they're not</font>

79
00:02:39,489 --> 00:02:43,060
anything that<font color="#CCCCCC"> they've</font><font color="#E5E5E5"> been around for</font>

80
00:02:40,989 --> 00:02:44,260
like a really really<font color="#E5E5E5"> long</font><font color="#CCCCCC"> time the first</font>

81
00:02:43,060 --> 00:02:46,239
one you know<font color="#E5E5E5"> they started emerge around</font>

82
00:02:44,260 --> 00:02:48,609
2002 the first documentation that<font color="#CCCCCC"> I</font>

83
00:02:46,239 --> 00:02:50,230
could find was the wireless LAN security

84
00:02:48,610 --> 00:02:52,209
fact by CW<font color="#CCCCCC"> Klaus that starts talking</font>

85
00:02:50,230 --> 00:02:53,649
<font color="#E5E5E5">about evil twin attacks</font><font color="#CCCCCC"> about a year</font>

86
00:02:52,209 --> 00:02:55,480
<font color="#E5E5E5">later you have a asleep</font><font color="#CCCCCC"> released by Josh</font>

87
00:02:53,650 --> 00:02:57,790
right<font color="#E5E5E5"> which is a total expands off of</font>

88
00:02:55,480 --> 00:03:00,369
that 2004 you actually see the

89
00:02:57,790 --> 00:03:02,250
implementation<font color="#CCCCCC"> of a karma attack</font><font color="#E5E5E5"> by Dino</font>

90
00:03:00,370 --> 00:03:04,120
<font color="#E5E5E5">Diaz</font><font color="#CCCCCC"> oviya</font><font color="#E5E5E5"> and Shane McCauley</font>

91
00:03:02,250 --> 00:03:06,160
<font color="#CCCCCC">four years after</font><font color="#E5E5E5"> that you have free</font>

92
00:03:04,120 --> 00:03:07,600
radius<font color="#CCCCCC"> wpe which</font><font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> Josh</font>

93
00:03:06,160 --> 00:03:09,160
<font color="#CCCCCC">frightened Brandon Tana woods figured</font>

94
00:03:07,600 --> 00:03:10,500
out how<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use his attacks to steal</font>

95
00:03:09,160 --> 00:03:14,410
<font color="#E5E5E5">credentials from radius networks</font>

96
00:03:10,500 --> 00:03:17,140
welcomewelcome<font color="#CCCCCC"> grabbed a seed and</font><font color="#E5E5E5"> you</font>

97
00:03:14,410 --> 00:03:18,250
know<font color="#E5E5E5"> by 2014 karma attacks</font><font color="#CCCCCC"> had actually</font>

98
00:03:17,140 --> 00:03:20,679
<font color="#E5E5E5">stopped being relays effectives that</font>

99
00:03:18,250 --> 00:03:22,900
used to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> so two researchers from from</font>

100
00:03:20,680 --> 00:03:24,610
South Africa<font color="#CCCCCC"> Dom</font><font color="#E5E5E5"> whitey de Villiers came</font>

101
00:03:22,900 --> 00:03:26,019
up with the improved karma attacks<font color="#E5E5E5"> you</font>

102
00:03:24,610 --> 00:03:27,190
know released a tool called<font color="#CCCCCC"> mana that</font>

103
00:03:26,019 --> 00:03:28,390
actually<font color="#CCCCCC"> mean I made these attack very</font>

104
00:03:27,190 --> 00:03:30,519
very<font color="#E5E5E5"> very effective</font>

105
00:03:28,390 --> 00:03:32,619
once again<font color="#CCCCCC"> and you know very recently</font>

106
00:03:30,519 --> 00:03:34,329
the guy who wrote Wi-Fi Fisher<font color="#E5E5E5"> came</font><font color="#CCCCCC"> up</font>

107
00:03:32,620 --> 00:03:37,209
<font color="#E5E5E5">with a lure</font><font color="#CCCCCC"> ten attack which exploits</font>

108
00:03:34,329 --> 00:03:40,030
<font color="#E5E5E5">Windows Wi-Fi sense to you know a whole</font>

109
00:03:37,209 --> 00:03:41,140
new way of<font color="#CCCCCC"> doing this so as you can see</font>

110
00:03:40,030 --> 00:03:43,030
<font color="#CCCCCC">I mean</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> this is actually</font><font color="#E5E5E5"> a very</font>

111
00:03:41,140 --> 00:03:45,670
there's a<font color="#E5E5E5"> pretty rich history of of</font>

112
00:03:43,030 --> 00:03:47,049
<font color="#E5E5E5">using</font><font color="#CCCCCC"> these kinds of attacks rogue</font><font color="#E5E5E5"> ap</font>

113
00:03:45,670 --> 00:03:48,608
attacks are they primarily are used to

114
00:03:47,049 --> 00:03:49,660
feel<font color="#CCCCCC"> like one</font><font color="#E5E5E5"> of two functions the roles</font>

115
00:03:48,609 --> 00:03:50,650
that<font color="#CCCCCC"> they fall into are either man the</font>

116
00:03:49,660 --> 00:03:52,570
middle attacks which you can use<font color="#CCCCCC"> to</font>

117
00:03:50,650 --> 00:03:55,630
steal<font color="#CCCCCC"> credentials for things or they're</font>

118
00:03:52,570 --> 00:03:58,030
used to<font color="#E5E5E5"> breach WPA or wpa2 networks the</font>

119
00:03:55,630 --> 00:03:58,900
ones that use<font color="#E5E5E5"> the EAP so in this talk</font>

120
00:03:58,030 --> 00:03:59,830
<font color="#E5E5E5">we're</font><font color="#CCCCCC"> going to something</font><font color="#E5E5E5"> a little bit</font>

121
00:03:58,900 --> 00:04:01,060
<font color="#E5E5E5">different we're gonna talk about rogue</font>

122
00:03:59,830 --> 00:04:02,270
<font color="#E5E5E5">ap attacks as a means of lateral</font>

123
00:04:01,060 --> 00:04:05,970
<font color="#E5E5E5">movement</font>

124
00:04:02,270 --> 00:04:08,850
so before we can<font color="#E5E5E5"> continue we also should</font>

125
00:04:05,970 --> 00:04:11,609
talk<font color="#CCCCCC"> about you know</font><font color="#E5E5E5"> how would</font><font color="#CCCCCC"> you use a</font>

126
00:04:08,850 --> 00:04:14,250
rogue<font color="#CCCCCC"> s1 attack to breach at WPI 2 EAP</font>

127
00:04:11,610 --> 00:04:18,959
<font color="#CCCCCC">network so</font><font color="#E5E5E5"> anyone here actually know how</font>

128
00:04:14,250 --> 00:04:20,279
EAP works<font color="#CCCCCC"> ok awesome great</font><font color="#E5E5E5"> so logically</font>

129
00:04:18,959 --> 00:04:22,730
<font color="#E5E5E5">we're gonna start out with kind of a</font>

130
00:04:20,279 --> 00:04:25,380
logical<font color="#CCCCCC"> high look high level</font><font color="#E5E5E5"> look at how</font>

131
00:04:22,730 --> 00:04:28,110
EAP works right we're<font color="#E5E5E5"> looking at EAP</font>

132
00:04:25,380 --> 00:04:30,240
peep and EAP TLS specifically<font color="#E5E5E5"> so</font>

133
00:04:28,110 --> 00:04:32,370
logically the the way<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> aap works</font>

134
00:04:30,240 --> 00:04:34,530
it it it's a transaction<font color="#CCCCCC"> that occurs</font>

135
00:04:32,370 --> 00:04:36,180
between a client<font color="#CCCCCC"> the client and the</font>

136
00:04:34,530 --> 00:04:37,320
authentication server<font color="#CCCCCC"> so the first thing</font>

137
00:04:36,180 --> 00:04:38,880
happens<font color="#E5E5E5"> to the client that's like your</font>

138
00:04:37,320 --> 00:04:40,349
wireless device your laptop or whatever

139
00:04:38,880 --> 00:04:42,150
<font color="#E5E5E5">it's gonna send an authentication</font>

140
00:04:40,350 --> 00:04:43,410
request to the authentication server<font color="#E5E5E5"> the</font>

141
00:04:42,150 --> 00:04:45,239
authentication<font color="#CCCCCC"> server is going to</font>

142
00:04:43,410 --> 00:04:46,500
respond with<font color="#E5E5E5"> an x.509 certificate and</font>

143
00:04:45,240 --> 00:04:47,760
it's<font color="#E5E5E5"> going to send</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> client</font>

144
00:04:46,500 --> 00:04:49,170
now that the reason why it's doing<font color="#CCCCCC"> this</font>

145
00:04:47,760 --> 00:04:51,150
is it needs to establish<font color="#E5E5E5"> the client</font><font color="#CCCCCC"> that</font>

146
00:04:49,170 --> 00:04:52,170
it can be<font color="#CCCCCC"> trusted</font><font color="#E5E5E5"> otherwise the client</font>

147
00:04:51,150 --> 00:04:54,419
<font color="#CCCCCC">doesn't know who it's actually</font>

148
00:04:52,170 --> 00:04:55,920
attempting to authenticate<font color="#E5E5E5"> with so at</font>

149
00:04:54,420 --> 00:04:57,390
this<font color="#E5E5E5"> time at this point the client then</font>

150
00:04:55,920 --> 00:04:58,710
either accepts or rejects the

151
00:04:57,390 --> 00:04:59,820
certificate<font color="#E5E5E5"> if it accepts</font><font color="#CCCCCC"> the</font>

152
00:04:58,710 --> 00:05:01,380
certificate<font color="#E5E5E5"> it means</font><font color="#CCCCCC"> it trusts the</font>

153
00:04:59,820 --> 00:05:02,940
authentication server<font color="#E5E5E5"> and secured</font>

154
00:05:01,380 --> 00:05:05,400
<font color="#CCCCCC">tunnels establish</font><font color="#E5E5E5"> between the client and</font>

155
00:05:02,940 --> 00:05:07,350
<font color="#E5E5E5">the authentication</font><font color="#CCCCCC"> server so once that</font>

156
00:05:05,400 --> 00:05:09,060
<font color="#E5E5E5">secure tile is established</font><font color="#CCCCCC"> we move on</font>

157
00:05:07,350 --> 00:05:10,230
from from<font color="#E5E5E5"> the outer authentication which</font>

158
00:05:09,060 --> 00:05:11,820
is where we were<font color="#E5E5E5"> at</font><font color="#CCCCCC"> before and then we</font>

159
00:05:10,230 --> 00:05:13,620
now start begin what's called<font color="#CCCCCC"> the inter</font>

160
00:05:11,820 --> 00:05:14,790
authentication<font color="#E5E5E5"> process which is this is</font>

161
00:05:13,620 --> 00:05:16,110
<font color="#E5E5E5">actually where you</font><font color="#CCCCCC"> know credentials are</font>

162
00:05:14,790 --> 00:05:17,670
entered and<font color="#CCCCCC"> you know you enter in your</font>

163
00:05:16,110 --> 00:05:19,380
<font color="#E5E5E5">username and password</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that stuff</font>

164
00:05:17,670 --> 00:05:20,550
gets sent to the<font color="#E5E5E5"> authentication</font><font color="#CCCCCC"> server</font>

165
00:05:19,380 --> 00:05:23,040
we'll look more at how<font color="#CCCCCC"> that</font><font color="#E5E5E5"> works</font><font color="#CCCCCC"> in a</font>

166
00:05:20,550 --> 00:05:24,150
second but that<font color="#E5E5E5"> authentication that</font>

167
00:05:23,040 --> 00:05:26,400
<font color="#CCCCCC">inter authentication is going to occur</font>

168
00:05:24,150 --> 00:05:28,440
through this secure tunnel<font color="#E5E5E5"> and the</font>

169
00:05:26,400 --> 00:05:30,960
reason why you need<font color="#CCCCCC"> that secure tunnels</font>

170
00:05:28,440 --> 00:05:33,180
<font color="#E5E5E5">that remember that you know EAP is</font><font color="#CCCCCC"> the</font>

171
00:05:30,960 --> 00:05:34,590
method as the authentication mechanism

172
00:05:33,180 --> 00:05:37,920
<font color="#E5E5E5">that we're using to provide access to</font>

173
00:05:34,590 --> 00:05:39,270
the WPA capabilities of the network so

174
00:05:37,920 --> 00:05:41,400
until this entire<font color="#E5E5E5"> process is</font><font color="#CCCCCC"> finished</font>

175
00:05:39,270 --> 00:05:43,289
<font color="#CCCCCC">this WPA network is not actually</font>

176
00:05:41,400 --> 00:05:45,599
operating as a WPA net<font color="#E5E5E5"> network you don't</font>

177
00:05:43,290 --> 00:05:47,760
<font color="#CCCCCC">get that WPA until after this process</font>

178
00:05:45,600 --> 00:05:49,380
succeeds<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this entire this entire</font>

179
00:05:47,760 --> 00:05:52,620
<font color="#CCCCCC">transactions</font><font color="#E5E5E5"> happening over open Wi-Fi</font>

180
00:05:49,380 --> 00:05:54,120
<font color="#E5E5E5">so without the secure tunnel and it's</font>

181
00:05:52,620 --> 00:05:57,270
hacker could actually<font color="#E5E5E5"> sniff this the</font>

182
00:05:54,120 --> 00:05:58,470
<font color="#E5E5E5">inter authentication process offline and</font>

183
00:05:57,270 --> 00:05:59,909
derive<font color="#E5E5E5"> the password</font><font color="#CCCCCC"> that way and</font>

184
00:05:58,470 --> 00:06:02,100
actually legolas implementations of EAP

185
00:05:59,910 --> 00:06:05,310
were highly susceptible to this<font color="#E5E5E5"> think</font>

186
00:06:02,100 --> 00:06:07,230
like EAP md5 just pretty prevalent<font color="#CCCCCC"> you</font>

187
00:06:05,310 --> 00:06:09,480
know like<font color="#CCCCCC"> ten</font><font color="#E5E5E5"> years</font><font color="#CCCCCC"> ago so when I</font>

188
00:06:07,230 --> 00:06:10,500
<font color="#E5E5E5">mentioned that there</font><font color="#CCCCCC"> was actually you</font>

189
00:06:09,480 --> 00:06:11,820
<font color="#E5E5E5">know two parties involved this</font>

190
00:06:10,500 --> 00:06:12,780
transaction<font color="#E5E5E5"> that's a bit of an</font>

191
00:06:11,820 --> 00:06:14,639
understatement and there's actually

192
00:06:12,780 --> 00:06:16,948
three the<font color="#E5E5E5"> the</font>

193
00:06:14,639 --> 00:06:18,150
being the<font color="#E5E5E5"> authenticator so we talked</font>

194
00:06:16,949 --> 00:06:19,590
about the client device<font color="#E5E5E5"> the technical</font>

195
00:06:18,150 --> 00:06:21,090
name for that's the supplicant<font color="#E5E5E5"> that's</font>

196
00:06:19,590 --> 00:06:22,198
that's that's your<font color="#CCCCCC"> devices connect to</font>

197
00:06:21,090 --> 00:06:23,310
the<font color="#CCCCCC"> network</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you have</font><font color="#E5E5E5"> your</font>

198
00:06:22,199 --> 00:06:24,360
authentication<font color="#E5E5E5"> server and this is the</font>

199
00:06:23,310 --> 00:06:26,069
radius<font color="#E5E5E5"> Center that's handling this</font>

200
00:06:24,360 --> 00:06:27,240
<font color="#CCCCCC">transaction</font><font color="#E5E5E5"> but in the middle here</font>

201
00:06:26,069 --> 00:06:29,099
there's<font color="#E5E5E5"> something else and that's your</font>

202
00:06:27,240 --> 00:06:31,080
access point<font color="#E5E5E5"> the access point we refer</font>

203
00:06:29,099 --> 00:06:32,099
to<font color="#E5E5E5"> it as an Authenticator if you look at</font>

204
00:06:31,080 --> 00:06:34,229
the<font color="#E5E5E5"> RFC's that's the name</font><font color="#CCCCCC"> that's used</font>

205
00:06:32,099 --> 00:06:37,349
<font color="#E5E5E5">and and the job</font><font color="#CCCCCC"> of the Authenticator the</font>

206
00:06:34,229 --> 00:06:39,150
access point is to kind of act as a

207
00:06:37,349 --> 00:06:40,770
mediator<font color="#CCCCCC"> between the</font><font color="#E5E5E5"> client device in</font>

208
00:06:39,150 --> 00:06:43,679
the authentication server<font color="#CCCCCC"> and the reason</font>

209
00:06:40,770 --> 00:06:45,568
why we need this<font color="#E5E5E5"> is because this the</font>

210
00:06:43,680 --> 00:06:46,830
<font color="#CCCCCC">supplicants peeking over</font><font color="#E5E5E5"> layer two</font><font color="#CCCCCC"> and</font>

211
00:06:45,569 --> 00:06:48,029
the authentication<font color="#E5E5E5"> server only speaks</font>

212
00:06:46,830 --> 00:06:49,378
<font color="#CCCCCC">over layer</font><font color="#E5E5E5"> seven using the</font><font color="#CCCCCC"> radiance</font>

213
00:06:48,029 --> 00:06:51,270
protocol<font color="#CCCCCC"> so you need this this</font><font color="#E5E5E5"> access</font>

214
00:06:49,379 --> 00:06:52,529
point<font color="#E5E5E5"> in the middle to act as an</font>

215
00:06:51,270 --> 00:06:54,359
<font color="#E5E5E5">intermediary</font><font color="#CCCCCC"> now remember that this</font>

216
00:06:52,529 --> 00:06:57,389
access<font color="#E5E5E5"> point until the process</font><font color="#CCCCCC"> is</font>

217
00:06:54,360 --> 00:07:00,560
finished<font color="#CCCCCC"> is is acting as an open access</font>

218
00:06:57,389 --> 00:07:03,060
point right<font color="#E5E5E5"> so what this means is</font><font color="#CCCCCC"> that</font>

219
00:07:00,560 --> 00:07:04,770
<font color="#CCCCCC">remember how we talked</font><font color="#E5E5E5"> about how open</font>

220
00:07:03,060 --> 00:07:06,000
access<font color="#E5E5E5"> points are susceptible to evil</font>

221
00:07:04,770 --> 00:07:08,068
twin attacks another rogue access point

222
00:07:06,000 --> 00:07:10,250
attacks<font color="#E5E5E5"> so what that means is that</font>

223
00:07:08,069 --> 00:07:12,270
<font color="#E5E5E5">because until this process</font><font color="#CCCCCC"> is completed</font>

224
00:07:10,250 --> 00:07:14,069
<font color="#CCCCCC">you know that</font><font color="#E5E5E5"> this access point the</font>

225
00:07:12,270 --> 00:07:15,990
Authenticator<font color="#E5E5E5"> here is also susceptible</font>

226
00:07:14,069 --> 00:07:19,289
to those very same attacks<font color="#CCCCCC"> so what you</font>

227
00:07:15,990 --> 00:07:23,039
can do<font color="#E5E5E5"> as an attacker is impersonate a</font>

228
00:07:19,289 --> 00:07:24,870
wpa2<font color="#E5E5E5"> EAP</font><font color="#CCCCCC"> network and and</font><font color="#E5E5E5"> enforce clients</font>

229
00:07:23,039 --> 00:07:27,180
to attempt<font color="#E5E5E5"> to authenticate with you and</font>

230
00:07:24,870 --> 00:07:28,800
if you're using a p-p-poor EP of TTLs<font color="#CCCCCC"> as</font>

231
00:07:27,180 --> 00:07:31,490
your outer authentication mechanisms

232
00:07:28,800 --> 00:07:34,349
<font color="#E5E5E5">then you're going to have a situation</font>

233
00:07:31,490 --> 00:07:36,240
<font color="#E5E5E5">where you</font><font color="#CCCCCC"> can force clients to connect</font>

234
00:07:34,349 --> 00:07:38,279
to you force them to authenticate with

235
00:07:36,240 --> 00:07:39,389
<font color="#CCCCCC">your own rogue radius server</font><font color="#E5E5E5"> and you</font>

236
00:07:38,279 --> 00:07:41,460
know hopefully<font color="#E5E5E5"> what that will get you as</font>

237
00:07:39,389 --> 00:07:44,009
an MS<font color="#CCCCCC"> chappie to</font><font color="#E5E5E5"> challenge and response</font>

238
00:07:41,460 --> 00:07:46,020
which you can then<font color="#E5E5E5"> use to derive radius</font>

239
00:07:44,009 --> 00:07:48,389
passwords or radius and T password

240
00:07:46,020 --> 00:07:50,669
hashes<font color="#CCCCCC"> which are password equivalent so</font>

241
00:07:48,389 --> 00:07:52,469
this<font color="#CCCCCC"> attack that</font><font color="#E5E5E5"> I'm just describing was</font>

242
00:07:50,669 --> 00:07:56,609
was first described by<font color="#E5E5E5"> Brad and Tonto</font><font color="#CCCCCC"> in</font>

243
00:07:52,469 --> 00:07:59,330
<font color="#E5E5E5">2008 and to make</font><font color="#CCCCCC"> it even</font><font color="#E5E5E5"> worse</font><font color="#CCCCCC"> actually</font>

244
00:07:56,610 --> 00:08:01,949
<font color="#E5E5E5">as anyone here familiar with</font><font color="#CCCCCC"> ms Chafee</font><font color="#E5E5E5"> -</font>

245
00:07:59,330 --> 00:08:03,568
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> out of you - who raise</font><font color="#E5E5E5"> your hands</font>

246
00:08:01,949 --> 00:08:06,599
<font color="#E5E5E5">how</font><font color="#CCCCCC"> many</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> think that</font><font color="#E5E5E5"> ms Jeffy -</font><font color="#CCCCCC"> is</font>

247
00:08:03,569 --> 00:08:08,310
amazing yeah I see some some<font color="#E5E5E5"> pretty yeah</font>

248
00:08:06,599 --> 00:08:10,878
like no no<font color="#E5E5E5"> no okay so yeah I'm</font><font color="#CCCCCC"> just</font>

249
00:08:08,310 --> 00:08:14,759
<font color="#E5E5E5">happy</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> of the problem is that you know</font>

250
00:08:10,879 --> 00:08:16,409
<font color="#E5E5E5">a</font><font color="#CCCCCC"> P P</font><font color="#E5E5E5"> for example it this outer</font>

251
00:08:14,759 --> 00:08:17,520
authentication protocol it's bad<font color="#E5E5E5"> enough</font>

252
00:08:16,409 --> 00:08:19,289
that you can<font color="#E5E5E5"> force stuff to connect</font><font color="#CCCCCC"> to</font>

253
00:08:17,520 --> 00:08:21,029
using a row of<font color="#CCCCCC"> AP attack but the inner</font>

254
00:08:19,289 --> 00:08:23,159
<font color="#CCCCCC">the inner authentication mechanism</font>

255
00:08:21,029 --> 00:08:24,449
<font color="#CCCCCC">that's used</font><font color="#E5E5E5"> typically is</font><font color="#CCCCCC"> mschap e2 and</font>

256
00:08:23,159 --> 00:08:26,069
there are a<font color="#E5E5E5"> couple ways of cracking</font>

257
00:08:24,449 --> 00:08:27,330
<font color="#E5E5E5">Emma's</font><font color="#CCCCCC"> Chaffey</font><font color="#E5E5E5"> to the traditional way is</font>

258
00:08:26,069 --> 00:08:28,350
<font color="#E5E5E5">that you take that</font><font color="#CCCCCC"> EAP</font><font color="#E5E5E5"> challenge</font><font color="#CCCCCC"> a</font>

259
00:08:27,330 --> 00:08:30,359
response that<font color="#E5E5E5"> you</font>

260
00:08:28,350 --> 00:08:31,680
that you've captured<font color="#E5E5E5"> and you just can</font>

261
00:08:30,360 --> 00:08:34,740
you<font color="#CCCCCC"> know iterally you know perform a</font>

262
00:08:31,680 --> 00:08:36,450
dictionary attack<font color="#CCCCCC"> can take the password</font>

263
00:08:34,740 --> 00:08:39,750
and the challenge<font color="#E5E5E5"> and then try to you</font>

264
00:08:36,450 --> 00:08:41,190
know combine them to create a<font color="#E5E5E5"> message</font>

265
00:08:39,750 --> 00:08:42,390
<font color="#E5E5E5">happy to response</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> try these</font>

266
00:08:41,190 --> 00:08:43,770
sequentially over and over again until

267
00:08:42,390 --> 00:08:44,520
<font color="#E5E5E5">you find the right password</font><font color="#CCCCCC"> that's a</font>

268
00:08:43,770 --> 00:08:45,840
<font color="#E5E5E5">dictionary attack</font>

269
00:08:44,520 --> 00:08:47,220
unfortunately the success rate<font color="#E5E5E5"> of this</font>

270
00:08:45,840 --> 00:08:48,660
attack is inversely<font color="#CCCCCC"> proportional to</font><font color="#E5E5E5"> the</font>

271
00:08:47,220 --> 00:08:50,550
<font color="#E5E5E5">strength of the password save a really</font>

272
00:08:48,660 --> 00:08:51,569
complex password<font color="#E5E5E5"> you're gonna the</font><font color="#CCCCCC"> more</font>

273
00:08:50,550 --> 00:08:53,359
<font color="#E5E5E5">complex that</font><font color="#CCCCCC"> password the more you're</font>

274
00:08:51,570 --> 00:08:55,530
going<font color="#E5E5E5"> to get diminishing returns</font>

275
00:08:53,360 --> 00:08:57,750
fortunately or unfortunately depending

276
00:08:55,530 --> 00:08:59,520
on your perspective<font color="#CCCCCC"> 2012</font><font color="#E5E5E5"> couple</font>

277
00:08:57,750 --> 00:09:01,080
researchers named Moxie Marlinspike and

278
00:08:59,520 --> 00:09:02,790
David Holton<font color="#CCCCCC"> came</font><font color="#E5E5E5"> up with a</font>

279
00:09:01,080 --> 00:09:05,880
divide-and-conquer attack that can<font color="#E5E5E5"> just</font>

280
00:09:02,790 --> 00:09:07,230
completely bury<font color="#CCCCCC"> MS Chaffee - it turns</font>

281
00:09:05,880 --> 00:09:08,850
out<font color="#E5E5E5"> that they discovered the MS Chaffee</font>

282
00:09:07,230 --> 00:09:11,250
<font color="#CCCCCC">2 uses it uses</font><font color="#E5E5E5"> it basically it's</font>

283
00:09:08,850 --> 00:09:12,930
basically<font color="#CCCCCC"> 3ds encryption so if you're</font>

284
00:09:11,250 --> 00:09:16,290
<font color="#E5E5E5">not familiar with</font><font color="#CCCCCC"> what that</font><font color="#E5E5E5"> means</font>

285
00:09:12,930 --> 00:09:18,030
3ds<font color="#CCCCCC"> you can actually</font><font color="#E5E5E5"> break it down into</font>

286
00:09:16,290 --> 00:09:20,969
<font color="#E5E5E5">a single des of encryption which is only</font>

287
00:09:18,030 --> 00:09:22,589
56 bits ntlm v1 actually has the<font color="#E5E5E5"> same</font>

288
00:09:20,970 --> 00:09:24,720
problem<font color="#E5E5E5"> and because you can reduce</font><font color="#CCCCCC"> it to</font>

289
00:09:22,590 --> 00:09:27,150
this this this<font color="#CCCCCC"> very very</font><font color="#E5E5E5"> small 56 bits</font>

290
00:09:24,720 --> 00:09:28,830
of<font color="#E5E5E5"> encryption</font><font color="#CCCCCC"> you can actually recover</font>

291
00:09:27,150 --> 00:09:31,530
<font color="#E5E5E5">that pass for equivalent NT hash that we</font>

292
00:09:28,830 --> 00:09:33,240
mentioned<font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> within 24</font>

293
00:09:31,530 --> 00:09:34,980
hours<font color="#E5E5E5"> using that using a proper FPGA</font>

294
00:09:33,240 --> 00:09:36,960
<font color="#E5E5E5">based cracking rig with a</font><font color="#CCCCCC"> 1 percent</font>

295
00:09:34,980 --> 00:09:41,490
<font color="#E5E5E5">success rate</font><font color="#CCCCCC"> so it's very very very</font>

296
00:09:36,960 --> 00:09:43,170
crackable<font color="#E5E5E5"> so just a quick demo</font><font color="#CCCCCC"> of how</font>

297
00:09:41,490 --> 00:09:45,930
this attack works you know right right

298
00:09:43,170 --> 00:09:47,790
<font color="#CCCCCC">now</font><font color="#E5E5E5"> from the attackers perspective</font><font color="#CCCCCC"> you'd</font>

299
00:09:45,930 --> 00:09:50,099
first create a cert which is what you're

300
00:09:47,790 --> 00:09:53,790
seeing<font color="#E5E5E5"> here and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> just a simple</font>

301
00:09:50,100 --> 00:09:56,790
self-signed cert and once you create

302
00:09:53,790 --> 00:09:59,969
<font color="#CCCCCC">that certificate</font><font color="#E5E5E5"> yeah</font>

303
00:09:56,790 --> 00:10:03,599
you<font color="#E5E5E5"> then create the the the evil twin of</font>

304
00:09:59,970 --> 00:10:04,740
the network that<font color="#CCCCCC"> you're targeting</font><font color="#E5E5E5"> I'm</font>

305
00:10:03,600 --> 00:10:08,960
gonna kind of<font color="#E5E5E5"> fast</font><font color="#CCCCCC"> forward through that</font>

306
00:10:04,740 --> 00:10:11,610
a<font color="#CCCCCC"> little bit and you're going to get a</font>

307
00:10:08,960 --> 00:10:12,960
client<font color="#E5E5E5"> associating so here you see like</font>

308
00:10:11,610 --> 00:10:16,620
the<font color="#CCCCCC"> the client associating with your</font>

309
00:10:12,960 --> 00:10:18,060
network<font color="#E5E5E5"> and this is what you see on the</font>

310
00:10:16,620 --> 00:10:19,860
<font color="#E5E5E5">attackers perspective you know you'd see</font>

311
00:10:18,060 --> 00:10:22,050
<font color="#CCCCCC">the the username the challenge</font><font color="#E5E5E5"> response</font>

312
00:10:19,860 --> 00:10:23,250
<font color="#E5E5E5">and</font><font color="#CCCCCC"> that would all be sent to you as the</font>

313
00:10:22,050 --> 00:10:25,199
<font color="#E5E5E5">client device attempts to authenticate</font>

314
00:10:23,250 --> 00:10:26,220
<font color="#E5E5E5">with you you know from there the</font>

315
00:10:25,200 --> 00:10:28,110
dictionary attack what it would look

316
00:10:26,220 --> 00:10:29,130
like using a asleep<font color="#E5E5E5"> would be this the</font>

317
00:10:28,110 --> 00:10:31,020
the<font color="#E5E5E5"> divide and</font><font color="#CCCCCC"> conquer is a bit</font>

318
00:10:29,130 --> 00:10:33,090
complicated<font color="#CCCCCC"> so I'm not</font><font color="#E5E5E5"> really showing it</font>

319
00:10:31,020 --> 00:10:35,340
here<font color="#E5E5E5"> but that's that's pretty much what</font>

320
00:10:33,090 --> 00:10:37,830
<font color="#E5E5E5">you'd</font><font color="#CCCCCC"> see and</font><font color="#E5E5E5"> you see we were able to</font>

321
00:10:35,340 --> 00:10:39,240
recover a password that<font color="#E5E5E5"> way so the</font>

322
00:10:37,830 --> 00:10:41,420
mitigation<font color="#CCCCCC"> for this was what's</font>

323
00:10:39,240 --> 00:10:45,950
introduced about<font color="#CCCCCC"> ten years</font><font color="#E5E5E5"> ago as well</font>

324
00:10:41,420 --> 00:10:47,689
this was in<font color="#E5E5E5"> 2008</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> was an RFC</font><font color="#CCCCCC"> 5216 a</font>

325
00:10:45,950 --> 00:10:52,070
new form of EAP was released called<font color="#E5E5E5"> EAP</font>

326
00:10:47,690 --> 00:10:54,500
TLS<font color="#E5E5E5"> and</font><font color="#CCCCCC"> EB EAP TLS</font><font color="#E5E5E5"> uses mutual certain</font>

327
00:10:52,070 --> 00:10:55,850
certificate based<font color="#E5E5E5"> authentication</font><font color="#CCCCCC"> you</font>

328
00:10:54,500 --> 00:10:58,910
know for its outer authentication layer

329
00:10:55,850 --> 00:11:00,260
so because of this this<font color="#E5E5E5"> this</font><font color="#CCCCCC"> this use of</font>

330
00:10:58,910 --> 00:11:01,699
client-side certificates it pretty much

331
00:11:00,260 --> 00:11:04,310
stops rogue<font color="#E5E5E5"> ap attacks dead in their</font>

332
00:11:01,700 --> 00:11:05,510
tracks<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the problem with EAP TLS is</font>

333
00:11:04,310 --> 00:11:06,800
that it's also like really<font color="#E5E5E5"> really</font>

334
00:11:05,510 --> 00:11:09,470
difficult<font color="#E5E5E5"> to integrate any any network</font>

335
00:11:06,800 --> 00:11:12,829
administrators out there<font color="#CCCCCC"> know</font><font color="#E5E5E5"> network</font>

336
00:11:09,470 --> 00:11:13,640
<font color="#CCCCCC">administrators</font><font color="#E5E5E5"> Wow</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so well from the</font>

337
00:11:12,830 --> 00:11:17,210
perspective<font color="#CCCCCC"> of a network administrator</font>

338
00:11:13,640 --> 00:11:18,800
<font color="#E5E5E5">that the difficulty is that EAP TLS is</font>

339
00:11:17,210 --> 00:11:19,940
really can be really difficult<font color="#E5E5E5"> to</font>

340
00:11:18,800 --> 00:11:21,680
implement<font color="#E5E5E5"> you have to you know have an</font>

341
00:11:19,940 --> 00:11:23,270
internal<font color="#E5E5E5"> CA that you set up you</font><font color="#CCCCCC"> have to</font>

342
00:11:21,680 --> 00:11:24,589
<font color="#CCCCCC">have a certificate place on every single</font>

343
00:11:23,270 --> 00:11:26,660
<font color="#E5E5E5">device</font><font color="#CCCCCC"> that you wanna be able</font><font color="#E5E5E5"> to connect</font>

344
00:11:24,590 --> 00:11:28,100
to<font color="#E5E5E5"> your</font><font color="#CCCCCC"> network and and you know</font><font color="#E5E5E5"> all of</font>

345
00:11:26,660 --> 00:11:29,360
this essentially creates a classic

346
00:11:28,100 --> 00:11:31,430
security<font color="#E5E5E5"> versus convenience scenario</font>

347
00:11:29,360 --> 00:11:32,870
where you're forced<font color="#CCCCCC"> to</font><font color="#E5E5E5"> to to choose</font>

348
00:11:31,430 --> 00:11:34,339
between an authentication mechanism

349
00:11:32,870 --> 00:11:38,260
that's very<font color="#E5E5E5"> very difficult to</font><font color="#CCCCCC"> implement</font>

350
00:11:34,340 --> 00:11:40,520
or<font color="#E5E5E5"> also or use a very insecure</font>

351
00:11:38,260 --> 00:11:45,410
<font color="#E5E5E5">authentication mechanism the form of EAP</font>

352
00:11:40,520 --> 00:11:47,569
P but P TLS so you know this creates a

353
00:11:45,410 --> 00:11:48,670
market<font color="#CCCCCC"> gap where you know products</font><font color="#E5E5E5"> you</font>

354
00:11:47,570 --> 00:11:50,720
know that you have<font color="#E5E5E5"> people essentially</font>

355
00:11:48,670 --> 00:11:52,219
<font color="#E5E5E5">the scripts of market gap for products</font>

356
00:11:50,720 --> 00:11:53,690
<font color="#CCCCCC">that can be</font><font color="#E5E5E5"> used</font><font color="#CCCCCC"> to compensate for the</font>

357
00:11:52,220 --> 00:11:55,850
security<font color="#CCCCCC"> issues found at</font><font color="#E5E5E5"> EPP</font><font color="#CCCCCC"> you need to</font>

358
00:11:53,690 --> 00:11:58,760
be TLS<font color="#E5E5E5"> but are also easy to employ and</font>

359
00:11:55,850 --> 00:12:00,350
easy to<font color="#CCCCCC"> use</font><font color="#E5E5E5"> I know so the current trend</font>

360
00:11:58,760 --> 00:12:01,910
that we see<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot is instead</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> focusing</font>

361
00:12:00,350 --> 00:12:03,350
on<font color="#E5E5E5"> breach at</font><font color="#CCCCCC"> prevention which</font><font color="#E5E5E5"> would be</font>

362
00:12:01,910 --> 00:12:04,550
preventing you know attackers<font color="#CCCCCC"> from</font>

363
00:12:03,350 --> 00:12:07,490
accessing<font color="#E5E5E5"> the network in the</font><font color="#CCCCCC"> first place</font>

364
00:12:04,550 --> 00:12:09,439
you<font color="#E5E5E5"> instead see a focus</font><font color="#CCCCCC"> on on containing</font>

365
00:12:07,490 --> 00:12:12,560
breaches that that occur once the

366
00:12:09,440 --> 00:12:13,640
<font color="#E5E5E5">attacker is on the network and that's</font>

367
00:12:12,560 --> 00:12:15,349
<font color="#E5E5E5">what we're</font><font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to address</font><font color="#CCCCCC"> here is</font>

368
00:12:13,640 --> 00:12:17,900
<font color="#CCCCCC">whether</font><font color="#E5E5E5"> or not this this strategy</font>

369
00:12:15,350 --> 00:12:20,560
<font color="#CCCCCC">actually works</font><font color="#E5E5E5"> and before continue have</font>

370
00:12:17,900 --> 00:12:20,560
a little cartoon for you

371
00:12:21,550 --> 00:12:27,650
okay it's a<font color="#E5E5E5"> little let's</font><font color="#CCCCCC"> read some</font>

372
00:12:23,660 --> 00:12:29,420
<font color="#CCCCCC">foreshadowing of</font><font color="#E5E5E5"> what lies ahead so the</font>

373
00:12:27,650 --> 00:12:30,650
most<font color="#E5E5E5"> popular way by far of addressing</font>

374
00:12:29,420 --> 00:12:32,959
the problem<font color="#CCCCCC"> of breach containment is to</font>

375
00:12:30,650 --> 00:12:34,189
use<font color="#CCCCCC"> an AK mechanism to distinguish</font>

376
00:12:32,960 --> 00:12:35,870
between you know<font color="#E5E5E5"> authorized and</font>

377
00:12:34,190 --> 00:12:38,090
<font color="#E5E5E5">unauthorised</font><font color="#CCCCCC"> endpoints</font><font color="#E5E5E5"> as they're added</font>

378
00:12:35,870 --> 00:12:39,350
to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> network so the idea here is a new</font>

379
00:12:38,090 --> 00:12:40,820
endpoint is added<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> network</font>

380
00:12:39,350 --> 00:12:42,470
aka a new device connects to the

381
00:12:40,820 --> 00:12:44,030
wireless network the<font color="#E5E5E5"> nack identifies</font>

382
00:12:42,470 --> 00:12:45,410
whether<font color="#E5E5E5"> this new endpoint is authorized</font>

383
00:12:44,030 --> 00:12:47,360
to<font color="#E5E5E5"> be there</font><font color="#CCCCCC"> or if it's not authorized to</font>

384
00:12:45,410 --> 00:12:48,680
<font color="#E5E5E5">be</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> if it's</font><font color="#CCCCCC"> not authorized you know</font>

385
00:12:47,360 --> 00:12:49,820
some<font color="#E5E5E5"> kind of restrictions placed on the</font>

386
00:12:48,680 --> 00:12:51,969
device usually<font color="#CCCCCC"> place</font><font color="#E5E5E5"> in a quarantine</font>

387
00:12:49,820 --> 00:12:54,110
VLAN where<font color="#CCCCCC"> I can't really touch anything</font>

388
00:12:51,970 --> 00:12:55,610
<font color="#E5E5E5">there are two ways you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> historically</font>

389
00:12:54,110 --> 00:12:57,680
we've<font color="#CCCCCC"> had two ways</font><font color="#E5E5E5"> of doing this you</font>

390
00:12:55,610 --> 00:13:00,620
<font color="#E5E5E5">have agent</font><font color="#CCCCCC"> basin</font><font color="#E5E5E5"> acts and you have agent</font>

391
00:12:57,680 --> 00:13:02,030
list<font color="#CCCCCC"> necks so agent basin acts</font><font color="#E5E5E5"> it's it's</font>

392
00:13:00,620 --> 00:13:03,230
the<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> way that works</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> that</font>

393
00:13:02,030 --> 00:13:04,819
<font color="#E5E5E5">you have a software</font><font color="#CCCCCC"> component called</font><font color="#E5E5E5"> an</font>

394
00:13:03,230 --> 00:13:06,500
agent that's installed<font color="#E5E5E5"> on every single</font>

395
00:13:04,820 --> 00:13:07,700
authorized endpoint on network and these

396
00:13:06,500 --> 00:13:09,530
agents communicate with the brain<font color="#CCCCCC"> of the</font>

397
00:13:07,700 --> 00:13:11,300
neck and report<font color="#CCCCCC"> back information</font><font color="#E5E5E5"> about</font>

398
00:13:09,530 --> 00:13:13,310
<font color="#CCCCCC">both the internals of the</font><font color="#E5E5E5"> device as well</font>

399
00:13:11,300 --> 00:13:15,430
<font color="#E5E5E5">as you know external</font><font color="#CCCCCC"> information as well</font>

400
00:13:13,310 --> 00:13:17,420
<font color="#CCCCCC">so this</font><font color="#E5E5E5"> is really</font><font color="#CCCCCC"> really effective</font>

401
00:13:15,430 --> 00:13:18,829
<font color="#CCCCCC">unfortunately now you you're in another</font>

402
00:13:17,420 --> 00:13:20,000
situation where you have to have<font color="#E5E5E5"> a piece</font>

403
00:13:18,830 --> 00:13:21,620
<font color="#E5E5E5">of software living on every single</font>

404
00:13:20,000 --> 00:13:23,300
<font color="#E5E5E5">device on the network and this makes it</font>

405
00:13:21,620 --> 00:13:27,050
you<font color="#CCCCCC"> know pretty much</font><font color="#E5E5E5"> just as impractical</font>

406
00:13:23,300 --> 00:13:28,069
<font color="#CCCCCC">as eap-tls and on the</font><font color="#E5E5E5"> other side the</font>

407
00:13:27,050 --> 00:13:30,109
spectrum<font color="#E5E5E5"> you have agent listen</font><font color="#CCCCCC"> acts</font>

408
00:13:28,070 --> 00:13:31,670
<font color="#E5E5E5">agent listen acts they use combinations</font>

409
00:13:30,110 --> 00:13:33,350
like<font color="#E5E5E5"> passive fingerprinting active</font>

410
00:13:31,670 --> 00:13:35,150
<font color="#E5E5E5">scanning you know a traffic analysis</font>

411
00:13:33,350 --> 00:13:37,190
stuff like that<font color="#E5E5E5"> and the idea here is is</font>

412
00:13:35,150 --> 00:13:40,130
<font color="#E5E5E5">to completely take a completely</font><font color="#CCCCCC"> external</font>

413
00:13:37,190 --> 00:13:41,540
approach to identifying endpoints

414
00:13:40,130 --> 00:13:43,100
<font color="#E5E5E5">however the problem with this is</font><font color="#CCCCCC"> that</font>

415
00:13:41,540 --> 00:13:44,810
you<font color="#CCCCCC"> have no way to identify</font><font color="#E5E5E5"> the</font>

416
00:13:43,100 --> 00:13:46,340
internals<font color="#E5E5E5"> or examine the internals of</font>

417
00:13:44,810 --> 00:13:47,660
network components<font color="#E5E5E5"> so you can</font><font color="#CCCCCC"> easily</font>

418
00:13:46,340 --> 00:13:50,390
bypass<font color="#E5E5E5"> these just by finding an</font>

419
00:13:47,660 --> 00:13:51,980
authorized device to masquerade<font color="#CCCCCC"> as</font><font color="#E5E5E5"> so I</font>

420
00:13:50,390 --> 00:13:53,150
mean this<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of leads</font><font color="#E5E5E5"> us back to the</font>

421
00:13:51,980 --> 00:13:54,740
same<font color="#CCCCCC"> problem we looked at before you</font>

422
00:13:53,150 --> 00:13:57,439
<font color="#E5E5E5">have a recurring dilemma in security</font>

423
00:13:54,740 --> 00:13:58,580
versus in practicality<font color="#CCCCCC"> you know you have</font>

424
00:13:57,440 --> 00:13:59,810
<font color="#E5E5E5">on one</font><font color="#CCCCCC"> side</font><font color="#E5E5E5"> the spectrum you have these</font>

425
00:13:58,580 --> 00:14:01,880
highly<font color="#E5E5E5"> effective solutions in the form</font>

426
00:13:59,810 --> 00:14:03,729
of agent<font color="#CCCCCC"> basin acts</font><font color="#E5E5E5"> and also like very</font>

427
00:14:01,880 --> 00:14:05,720
<font color="#CCCCCC">easy deploy but also</font><font color="#E5E5E5"> less</font><font color="#CCCCCC"> than effective</font>

428
00:14:03,730 --> 00:14:07,430
<font color="#E5E5E5">solutions in the form</font><font color="#CCCCCC"> of agent listen</font>

429
00:14:05,720 --> 00:14:09,530
<font color="#E5E5E5">acts so this leads to</font><font color="#CCCCCC"> another market gap</font>

430
00:14:07,430 --> 00:14:10,729
<font color="#CCCCCC">right where there's a huge demand for a</font>

431
00:14:09,530 --> 00:14:12,860
solution<font color="#CCCCCC"> that can offer deep</font>

432
00:14:10,730 --> 00:14:14,090
interrogation capabilities that<font color="#E5E5E5"> you find</font>

433
00:14:12,860 --> 00:14:16,580
with like an agent based<font color="#CCCCCC"> knack but</font>

434
00:14:14,090 --> 00:14:17,960
<font color="#E5E5E5">without all that</font><font color="#CCCCCC"> additional overhead</font><font color="#E5E5E5"> so</font>

435
00:14:16,580 --> 00:14:21,590
I mean this<font color="#E5E5E5"> has led</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> rise of</font><font color="#E5E5E5"> the</font>

436
00:14:17,960 --> 00:14:22,190
<font color="#CCCCCC">next-generation</font><font color="#E5E5E5"> neck these are actually</font>

437
00:14:21,590 --> 00:14:24,080
<font color="#CCCCCC">pretty interesting</font>

438
00:14:22,190 --> 00:14:26,120
<font color="#CCCCCC">there there are a lot of really</font>

439
00:14:24,080 --> 00:14:27,830
interesting<font color="#E5E5E5"> solutions to them there's</font>

440
00:14:26,120 --> 00:14:28,940
there's one<font color="#E5E5E5"> in mind that I thought was</font>

441
00:14:27,830 --> 00:14:32,330
<font color="#E5E5E5">like a really interesting approach but</font>

442
00:14:28,940 --> 00:14:33,710
<font color="#E5E5E5">also just at the same time really just</font>

443
00:14:32,330 --> 00:14:35,459
<font color="#E5E5E5">kind of drives the point home as to why</font>

444
00:14:33,710 --> 00:14:37,679
you know this this

445
00:14:35,459 --> 00:14:40,138
isn't like an easy easy<font color="#E5E5E5"> paradox to</font>

446
00:14:37,679 --> 00:14:42,389
bridge<font color="#CCCCCC"> unfortunately no I actually tried</font>

447
00:14:40,139 --> 00:14:45,899
to<font color="#E5E5E5"> I actually tried to borrow one from</font>

448
00:14:42,389 --> 00:14:48,869
work<font color="#E5E5E5"> to bring here and do a demo with so</font>

449
00:14:45,899 --> 00:14:51,059
I opened up a ticket<font color="#CCCCCC"> of course you know</font>

450
00:14:48,869 --> 00:14:52,170
that<font color="#CCCCCC"> didn't really go as</font><font color="#E5E5E5"> I probably</font>

451
00:14:51,059 --> 00:14:53,730
should've expected that<font color="#E5E5E5"> but</font>

452
00:14:52,170 --> 00:14:55,319
interestingly enough<font color="#E5E5E5"> also illegal</font><font color="#CCCCCC"> kind</font>

453
00:14:53,730 --> 00:14:57,149
of reached out<font color="#CCCCCC"> to me just</font><font color="#E5E5E5"> like you you</font>

454
00:14:55,319 --> 00:14:59,519
got<font color="#CCCCCC"> to keep this</font><font color="#E5E5E5"> vendor neutral so I'm</font>

455
00:14:57,149 --> 00:15:01,259
like<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so in the interest of being</font>

456
00:14:59,519 --> 00:15:02,610
vendor neutral<font color="#CCCCCC"> we're going to refer this</font>

457
00:15:01,259 --> 00:15:03,569
hardware vendor as vendor<font color="#E5E5E5"> a and if</font>

458
00:15:02,610 --> 00:15:04,920
you're really<font color="#E5E5E5"> curious I'm sure you can</font>

459
00:15:03,569 --> 00:15:06,959
<font color="#E5E5E5">find a bunch of products that kind</font><font color="#CCCCCC"> of</font>

460
00:15:04,920 --> 00:15:08,729
match the description on<font color="#E5E5E5"> Google but a</font>

461
00:15:06,959 --> 00:15:10,829
really<font color="#E5E5E5"> good</font><font color="#CCCCCC"> example this is vendor a</font>

462
00:15:08,730 --> 00:15:12,179
vendor a<font color="#E5E5E5"> uses</font><font color="#CCCCCC"> WMI to interrogate new</font>

463
00:15:10,829 --> 00:15:14,309
<font color="#E5E5E5">devices as they're added</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the network</font>

464
00:15:12,179 --> 00:15:15,689
and and by doing<font color="#E5E5E5"> this</font><font color="#CCCCCC"> it's able</font><font color="#E5E5E5"> to</font>

465
00:15:14,309 --> 00:15:19,110
<font color="#E5E5E5">perform those deep internal checks</font>

466
00:15:15,689 --> 00:15:20,610
<font color="#E5E5E5">without</font><font color="#CCCCCC"> using an agent</font><font color="#E5E5E5"> and you know the</font>

467
00:15:19,110 --> 00:15:22,379
way that does this is Anna<font color="#E5E5E5"> Kate's over</font>

468
00:15:20,610 --> 00:15:24,569
SMB using a single administrative

469
00:15:22,379 --> 00:15:25,889
<font color="#E5E5E5">service account so device it's added it</font>

470
00:15:24,569 --> 00:15:27,839
authenticates with the device using<font color="#CCCCCC"> the</font>

471
00:15:25,889 --> 00:15:29,189
service account or attempts to and then

472
00:15:27,839 --> 00:15:31,439
at that point<font color="#CCCCCC"> once it's authenticated</font>

473
00:15:29,189 --> 00:15:33,360
<font color="#CCCCCC">with this device it uses some some</font>

474
00:15:31,439 --> 00:15:34,469
pretty deep administrative privileges<font color="#E5E5E5"> to</font>

475
00:15:33,360 --> 00:15:38,249
look at the internals of<font color="#E5E5E5"> the device and</font>

476
00:15:34,470 --> 00:15:39,809
examine how it<font color="#E5E5E5"> works</font><font color="#CCCCCC"> the problem with</font>

477
00:15:38,249 --> 00:15:44,519
this is it creates a single<font color="#CCCCCC"> well anyone</font>

478
00:15:39,809 --> 00:15:46,949
anyone see a<font color="#CCCCCC"> problem this yet yeah yeah</font>

479
00:15:44,519 --> 00:15:48,449
responder<font color="#E5E5E5"> so you have a single</font><font color="#CCCCCC"> point of</font>

480
00:15:46,949 --> 00:15:49,949
<font color="#E5E5E5">failure</font><font color="#CCCCCC"> you have a device that's a you</font>

481
00:15:48,449 --> 00:15:51,079
know<font color="#E5E5E5"> attendeth on</font><font color="#CCCCCC"> okay authenticate</font><font color="#E5E5E5"> with</font>

482
00:15:49,949 --> 00:15:53,160
everything<font color="#CCCCCC"> that's added to</font><font color="#E5E5E5"> the network</font>

483
00:15:51,079 --> 00:15:55,019
<font color="#E5E5E5">using the special service account and</font>

484
00:15:53,160 --> 00:15:56,100
this service<font color="#E5E5E5"> account has</font><font color="#CCCCCC"> access to</font>

485
00:15:55,019 --> 00:15:57,720
<font color="#E5E5E5">nearly everything on the network</font>

486
00:15:56,100 --> 00:15:59,459
<font color="#E5E5E5">typically it has</font><font color="#CCCCCC"> DEA privileges actually</font>

487
00:15:57,720 --> 00:16:01,589
which is<font color="#CCCCCC"> really scary so you have this</font>

488
00:15:59,459 --> 00:16:04,290
<font color="#E5E5E5">device</font><font color="#CCCCCC"> that although</font><font color="#E5E5E5"> it's able</font><font color="#CCCCCC"> to do</font>

489
00:16:01,589 --> 00:16:05,910
these deep checks<font color="#E5E5E5"> relatively easily it's</font>

490
00:16:04,290 --> 00:16:07,649
<font color="#CCCCCC">also sending god mode hashes to anything</font>

491
00:16:05,910 --> 00:16:09,600
<font color="#CCCCCC">that you add to</font><font color="#E5E5E5"> the network so of course</font>

492
00:16:07,649 --> 00:16:12,149
you know the the first<font color="#E5E5E5"> risk that comes</font>

493
00:16:09,600 --> 00:16:13,649
to<font color="#E5E5E5"> mind is is</font><font color="#CCCCCC"> using you know</font><font color="#E5E5E5"> something</font>

494
00:16:12,149 --> 00:16:14,939
like<font color="#E5E5E5"> impacted or responder to perform</font>

495
00:16:13,649 --> 00:16:16,290
<font color="#E5E5E5">S&B relay attacks</font><font color="#CCCCCC"> where just add</font>

496
00:16:14,939 --> 00:16:17,759
<font color="#E5E5E5">something the network wait for this</font>

497
00:16:16,290 --> 00:16:19,049
thing to<font color="#E5E5E5"> authenticate with you really</font>

498
00:16:17,759 --> 00:16:22,259
<font color="#CCCCCC">the authentication</font><font color="#E5E5E5"> attempt is something</font>

499
00:16:19,049 --> 00:16:23,220
else<font color="#CCCCCC"> and</font><font color="#E5E5E5"> pivot into it</font><font color="#CCCCCC"> and actually you</font>

500
00:16:22,259 --> 00:16:24,299
don't need<font color="#CCCCCC"> a man</font><font color="#E5E5E5"> in the middle there</font>

501
00:16:23,220 --> 00:16:26,879
because the<font color="#CCCCCC"> nak applies is trying out</font>

502
00:16:24,299 --> 00:16:28,230
<font color="#E5E5E5">thank you with you of course</font><font color="#CCCCCC"> you can</font>

503
00:16:26,879 --> 00:16:30,329
mitigate this fairly<font color="#E5E5E5"> easily by enabling</font>

504
00:16:28,230 --> 00:16:31,470
SMB signing<font color="#CCCCCC"> although it's worth</font>

505
00:16:30,329 --> 00:16:32,910
mentioning<font color="#CCCCCC"> the s</font><font color="#E5E5E5"> and B sign dates</font>

506
00:16:31,470 --> 00:16:34,519
usually it's disabled by default on

507
00:16:32,910 --> 00:16:36,569
everything about the domain<font color="#E5E5E5"> controller</font>

508
00:16:34,519 --> 00:16:37,949
<font color="#CCCCCC">but this</font><font color="#E5E5E5"> doesn't really address the</font>

509
00:16:36,569 --> 00:16:40,439
issue<font color="#CCCCCC"> of</font><font color="#E5E5E5"> hashes being sent directly</font><font color="#CCCCCC"> to</font>

510
00:16:37,949 --> 00:16:41,279
untrusted<font color="#CCCCCC"> endpoints so I mean it's</font>

511
00:16:40,439 --> 00:16:43,620
interesting<font color="#E5E5E5"> that this matter actually</font>

512
00:16:41,279 --> 00:16:46,110
<font color="#E5E5E5">offers a piece of software that you</font><font color="#CCCCCC"> can</font>

513
00:16:43,620 --> 00:16:47,279
install on every single<font color="#CCCCCC"> thing on</font><font color="#E5E5E5"> the</font>

514
00:16:46,110 --> 00:16:48,839
network to kind of<font color="#E5E5E5"> address</font><font color="#CCCCCC"> this issue</font>

515
00:16:47,279 --> 00:16:49,379
<font color="#CCCCCC">this is starting</font><font color="#E5E5E5"> to sound a lot like an</font>

516
00:16:48,839 --> 00:16:51,059
agent<font color="#E5E5E5"> again</font>

517
00:16:49,379 --> 00:16:52,259
and considering<font color="#CCCCCC"> that</font><font color="#E5E5E5"> the chief selling</font>

518
00:16:51,059 --> 00:16:53,459
point of<font color="#E5E5E5"> this thing is that</font><font color="#CCCCCC"> no agent is</font>

519
00:16:52,259 --> 00:16:54,029
required I feel like we're<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to</font>

520
00:16:53,459 --> 00:16:55,829
square one again

521
00:16:54,029 --> 00:16:59,399
<font color="#E5E5E5">and you know once again I'm not</font><font color="#CCCCCC"> really</font>

522
00:16:55,829 --> 00:17:00,929
<font color="#E5E5E5">like I you</font><font color="#CCCCCC"> know I think I</font><font color="#E5E5E5"> think you know</font>

523
00:16:59,399 --> 00:17:02,639
<font color="#E5E5E5">most I don't think</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> this particular</font>

524
00:17:00,929 --> 00:17:05,849
<font color="#E5E5E5">solution is like you know better or</font>

525
00:17:02,639 --> 00:17:07,470
worse than any<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> other well what's</font>

526
00:17:05,849 --> 00:17:08,908
it called next generation<font color="#CCCCCC"> acts out there</font>

527
00:17:07,470 --> 00:17:11,250
I<font color="#E5E5E5"> just I think it's a really really good</font>

528
00:17:08,909 --> 00:17:12,839
example<font color="#CCCCCC"> of how there</font><font color="#E5E5E5"> really is no</font><font color="#CCCCCC"> magic</font>

529
00:17:11,250 --> 00:17:14,369
bullet<font color="#E5E5E5"> in this in the situation you</font>

530
00:17:12,839 --> 00:17:16,349
can't really always have<font color="#E5E5E5"> security with</font>

531
00:17:14,369 --> 00:17:17,849
convenience and and especially<font color="#E5E5E5"> when</font>

532
00:17:16,349 --> 00:17:20,309
you're talking<font color="#CCCCCC"> about access control or</font>

533
00:17:17,849 --> 00:17:24,809
authorization<font color="#E5E5E5"> or authentication I think</font>

534
00:17:20,309 --> 00:17:26,549
it's actually<font color="#E5E5E5"> a total paradox so kind of</font>

535
00:17:24,809 --> 00:17:28,408
<font color="#E5E5E5">going back</font><font color="#CCCCCC"> to wireless in general</font>

536
00:17:26,549 --> 00:17:29,639
<font color="#CCCCCC">another</font><font color="#E5E5E5"> really interesting wireless</font>

537
00:17:28,409 --> 00:17:31,889
security<font color="#E5E5E5"> control that you see a lot is</font>

538
00:17:29,639 --> 00:17:33,240
client isolation<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Athiya you know the</font>

539
00:17:31,889 --> 00:17:34,229
idea behind client isolation is that you

540
00:17:33,240 --> 00:17:35,549
prevent wireless devices from

541
00:17:34,230 --> 00:17:37,200
<font color="#E5E5E5">communicating with one another you</font>

542
00:17:35,549 --> 00:17:38,970
<font color="#E5E5E5">usually use this as a security control</font>

543
00:17:37,200 --> 00:17:40,620
<font color="#E5E5E5">typical use case would</font><font color="#CCCCCC"> be like an open</font>

544
00:17:38,970 --> 00:17:42,029
<font color="#CCCCCC">network like the hotel here for</font><font color="#E5E5E5"> example</font>

545
00:17:40,620 --> 00:17:43,979
<font color="#E5E5E5">you may notice that you cannot ping</font>

546
00:17:42,029 --> 00:17:45,659
other laptops that<font color="#E5E5E5"> are associated with</font>

547
00:17:43,980 --> 00:17:46,769
the<font color="#CCCCCC"> network and</font><font color="#E5E5E5"> there's a reason for</font>

548
00:17:45,659 --> 00:17:48,000
that<font color="#E5E5E5"> the idea is to keep people</font><font color="#CCCCCC"> from</font>

549
00:17:46,769 --> 00:17:50,789
attacking<font color="#E5E5E5"> each other once they're on the</font>

550
00:17:48,000 --> 00:17:51,960
network so the way<font color="#E5E5E5"> the 802 dot 11 is</font>

551
00:17:50,789 --> 00:17:54,240
supposed<font color="#E5E5E5"> to work is</font><font color="#CCCCCC"> that the</font><font color="#E5E5E5"> AP is</font>

552
00:17:51,960 --> 00:17:56,580
supposed to mediate all communication on

553
00:17:54,240 --> 00:17:58,649
the network right so in theory<font color="#CCCCCC"> if</font><font color="#E5E5E5"> this</font>

554
00:17:56,580 --> 00:18:02,370
guy down<font color="#CCCCCC"> here</font><font color="#E5E5E5"> that can</font><font color="#CCCCCC"> you guys see my</font>

555
00:17:58,649 --> 00:18:03,479
mouse moving<font color="#E5E5E5"> around cool</font><font color="#CCCCCC"> in theory the</font>

556
00:18:02,370 --> 00:18:04,590
way that's supposed to<font color="#E5E5E5"> work</font><font color="#CCCCCC"> is if this</font>

557
00:18:03,480 --> 00:18:06,450
<font color="#E5E5E5">guy here</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> trying to</font><font color="#CCCCCC"> communicate</font><font color="#E5E5E5"> with</font>

558
00:18:04,590 --> 00:18:07,889
this guy the<font color="#E5E5E5"> AP can just intercept the</font>

559
00:18:06,450 --> 00:18:10,409
packet and drop and say no you can't do

560
00:18:07,889 --> 00:18:12,570
that<font color="#CCCCCC"> but</font><font color="#E5E5E5"> the problem with this is</font><font color="#CCCCCC"> that</font>

561
00:18:10,409 --> 00:18:13,919
you<font color="#CCCCCC"> know client isolation really is a</font>

562
00:18:12,570 --> 00:18:17,428
logical<font color="#E5E5E5"> control is not a</font><font color="#CCCCCC"> physical</font>

563
00:18:13,919 --> 00:18:18,899
control<font color="#CCCCCC"> so back in 2005</font><font color="#E5E5E5"> the late Cedric</font>

564
00:18:17,429 --> 00:18:21,000
<font color="#E5E5E5">blancher awesome research</font><font color="#CCCCCC"> from</font>

565
00:18:18,899 --> 00:18:22,110
<font color="#CCCCCC">forcellino longer with us</font><font color="#E5E5E5"> he posed a</font>

566
00:18:21,000 --> 00:18:23,610
<font color="#CCCCCC">question how do you prevent radio</font>

567
00:18:22,110 --> 00:18:26,399
transceivers from communicating with<font color="#CCCCCC"> one</font>

568
00:18:23,610 --> 00:18:27,899
<font color="#CCCCCC">another and the answer was you can't so</font>

569
00:18:26,399 --> 00:18:29,879
he introduced this tool called<font color="#CCCCCC"> Wi-Fi tap</font>

570
00:18:27,899 --> 00:18:32,610
which was<font color="#E5E5E5"> released by Cedric</font><font color="#CCCCCC"> Blanchard</font>

571
00:18:29,879 --> 00:18:33,870
2005 later revived by Oliver Lavery of

572
00:18:32,610 --> 00:18:38,428
<font color="#E5E5E5">Gotham</font><font color="#CCCCCC"> digital science it's actually way</font>

573
00:18:33,870 --> 00:18:40,229
before my time<font color="#CCCCCC"> but the idea is that</font><font color="#E5E5E5"> why</font>

574
00:18:38,429 --> 00:18:42,269
fight actually<font color="#E5E5E5"> Wi-Fi tap actually reads</font>

575
00:18:40,230 --> 00:18:43,590
packets from<font color="#CCCCCC"> the victim to the AP using</font>

576
00:18:42,269 --> 00:18:45,299
a Wi-Fi<font color="#E5E5E5"> interface in monitor mode and it</font>

577
00:18:43,590 --> 00:18:46,769
gives you a ton tap device that's

578
00:18:45,299 --> 00:18:48,570
bridged to this<font color="#E5E5E5"> modern mode</font><font color="#CCCCCC"> interface</font>

579
00:18:46,769 --> 00:18:50,039
and lets you<font color="#E5E5E5"> interact with</font><font color="#CCCCCC"> that monitor</font>

580
00:18:48,570 --> 00:18:52,230
mode<font color="#CCCCCC"> interface and what this allows you</font>

581
00:18:50,039 --> 00:18:53,639
to<font color="#E5E5E5"> do it allows you to inject responses</font>

582
00:18:52,230 --> 00:18:55,440
to packets as if they came<font color="#CCCCCC"> from the AP</font>

583
00:18:53,639 --> 00:18:56,850
so I mean this allows you to<font color="#E5E5E5"> do two</font>

584
00:18:55,440 --> 00:18:58,590
<font color="#CCCCCC">things I</font><font color="#E5E5E5"> mean one it actually lets</font><font color="#CCCCCC"> you</font>

585
00:18:56,850 --> 00:18:59,850
interact<font color="#E5E5E5"> with devices</font><font color="#CCCCCC"> that are associate</font>

586
00:18:58,590 --> 00:19:01,019
<font color="#CCCCCC">up with a</font><font color="#E5E5E5"> wireless network without</font>

587
00:18:59,850 --> 00:19:02,639
actually being associated<font color="#E5E5E5"> with</font><font color="#CCCCCC"> that</font>

588
00:19:01,019 --> 00:19:04,800
wireless network yourself<font color="#E5E5E5"> and</font><font color="#CCCCCC"> for</font>

589
00:19:02,640 --> 00:19:07,500
more it<font color="#E5E5E5"> actually lets you bypass client</font>

590
00:19:04,800 --> 00:19:10,379
isolation and<font color="#E5E5E5"> I think I cover</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> stuff</font>

591
00:19:07,500 --> 00:19:12,660
<font color="#E5E5E5">okay so there</font><font color="#CCCCCC"> are some later tools that</font>

592
00:19:10,380 --> 00:19:15,630
do even<font color="#CCCCCC"> more cool stuff so ayrton ng</font><font color="#E5E5E5"> you</font>

593
00:19:12,660 --> 00:19:17,010
can do the same<font color="#E5E5E5"> attack</font><font color="#CCCCCC"> with WEP tkip ton</font>

594
00:19:15,630 --> 00:19:19,350
ng<font color="#E5E5E5"> this is also part of the</font><font color="#CCCCCC"> aircraft</font>

595
00:19:17,010 --> 00:19:21,920
suite<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can you can inject you know</font>

596
00:19:19,350 --> 00:19:23,240
this<font color="#CCCCCC"> pack injection stuff but with WPA 1</font>

597
00:19:21,920 --> 00:19:25,940
<font color="#E5E5E5">wpa2</font>

598
00:19:23,240 --> 00:19:27,810
<font color="#CCCCCC">there are some attacks</font><font color="#E5E5E5"> that that</font>

599
00:19:25,940 --> 00:19:29,450
theoretical attacks anyways that really

600
00:19:27,810 --> 00:19:31,470
have been<font color="#E5E5E5"> implemented that theoretically</font>

601
00:19:29,450 --> 00:19:32,040
are able to<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> able to do this with</font>

602
00:19:31,470 --> 00:19:34,680
<font color="#E5E5E5">wpa2</font>

603
00:19:32,040 --> 00:19:36,510
<font color="#E5E5E5">whole 196 comes to mind it's worth</font>

604
00:19:34,680 --> 00:19:37,560
mentioning that most of these<font color="#E5E5E5"> are purely</font>

605
00:19:36,510 --> 00:19:38,670
theoretical and actually haven't

606
00:19:37,560 --> 00:19:40,200
contested and are<font color="#E5E5E5"> really up to</font>

607
00:19:38,670 --> 00:19:41,280
considerable debate but<font color="#E5E5E5"> for the sake of</font>

608
00:19:40,200 --> 00:19:44,130
<font color="#E5E5E5">being thorough I just kind of throw them</font>

609
00:19:41,280 --> 00:19:45,720
<font color="#E5E5E5">in there but</font><font color="#CCCCCC"> I mean here's a quick demo</font>

610
00:19:44,130 --> 00:19:48,740
of Wi-Fi tap in general if<font color="#E5E5E5"> you look at</font>

611
00:19:45,720 --> 00:19:52,200
the top right<font color="#CCCCCC"> we're actually going to</font>

612
00:19:48,740 --> 00:19:53,790
create<font color="#E5E5E5"> an access</font><font color="#CCCCCC"> point</font><font color="#E5E5E5"> just using so</font>

613
00:19:52,200 --> 00:19:57,600
we've created here<font color="#E5E5E5"> an open access point</font>

614
00:19:53,790 --> 00:19:58,530
with the SSID example Wi-Fi and we're

615
00:19:57,600 --> 00:19:59,939
going to connect<font color="#E5E5E5"> to it from</font><font color="#CCCCCC"> our host</font>

616
00:19:58,530 --> 00:20:01,740
operating system<font color="#CCCCCC"> this is a VM and this</font>

617
00:19:59,940 --> 00:20:03,810
is a second VM and this is our host

618
00:20:01,740 --> 00:20:05,430
<font color="#E5E5E5">right here in the bottom</font><font color="#CCCCCC"> right so we're</font>

619
00:20:03,810 --> 00:20:08,510
going<font color="#E5E5E5"> to connect</font><font color="#CCCCCC"> to example Wi-Fi</font><font color="#E5E5E5"> from</font>

620
00:20:05,430 --> 00:20:11,520
our from our host operating system<font color="#CCCCCC"> and</font>

621
00:20:08,510 --> 00:20:12,960
<font color="#CCCCCC">then if we go down</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> we're just going</font>

622
00:20:11,520 --> 00:20:15,420
<font color="#CCCCCC">to send a bunch of ICMP packets for us</font>

623
00:20:12,960 --> 00:20:17,130
<font color="#CCCCCC">and</font><font color="#E5E5E5"> five ICMP packets to our</font><font color="#CCCCCC"> AP from our</font>

624
00:20:15,420 --> 00:20:19,320
host operating<font color="#CCCCCC"> system</font><font color="#E5E5E5"> and you notice</font>

625
00:20:17,130 --> 00:20:22,130
that<font color="#CCCCCC"> we send five ICMP packets</font><font color="#E5E5E5"> and we</font>

626
00:20:19,320 --> 00:20:24,120
<font color="#CCCCCC">receive five responses that's expected</font>

627
00:20:22,130 --> 00:20:26,160
so<font color="#E5E5E5"> now we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do is we're going to</font>

628
00:20:24,120 --> 00:20:27,780
start up a modified version of Wi-Fi tap

629
00:20:26,160 --> 00:20:29,250
called Wi-Fi ping which is actually a

630
00:20:27,780 --> 00:20:30,960
really you<font color="#CCCCCC"> know cool way</font><font color="#E5E5E5"> of like</font>

631
00:20:29,250 --> 00:20:32,970
demonstrating how<font color="#E5E5E5"> this works and</font><font color="#CCCCCC"> what</font>

632
00:20:30,960 --> 00:20:35,130
Wi-Fi does is<font color="#E5E5E5"> anytime it sees an ICMP</font>

633
00:20:32,970 --> 00:20:37,050
requests<font color="#E5E5E5"> it injects an ICMP response and</font>

634
00:20:35,130 --> 00:20:38,370
and it so we're<font color="#E5E5E5"> gonna do that from the</font>

635
00:20:37,050 --> 00:20:41,370
attackers virtual machine over<font color="#CCCCCC"> here it</font>

636
00:20:38,370 --> 00:20:44,669
<font color="#E5E5E5">says this terminal you see here so we're</font>

637
00:20:41,370 --> 00:20:46,199
gonna<font color="#E5E5E5"> start up Wi-Fi ping and Wi-Fi ping</font>

638
00:20:44,670 --> 00:20:48,810
is now running<font color="#CCCCCC"> and we're going</font><font color="#E5E5E5"> to once</font>

639
00:20:46,200 --> 00:20:50,280
<font color="#CCCCCC">again sent five ICMP packets but notice</font>

640
00:20:48,810 --> 00:20:52,679
that<font color="#E5E5E5"> instead</font><font color="#CCCCCC"> of receiving</font><font color="#E5E5E5"> five ICMP</font>

641
00:20:50,280 --> 00:20:54,389
responses we see<font color="#E5E5E5"> ten ICMP responses and</font>

642
00:20:52,680 --> 00:20:55,560
that's because we're injecting them over

643
00:20:54,390 --> 00:20:57,480
<font color="#E5E5E5">from this thing and that just kind</font><font color="#CCCCCC"> of</font>

644
00:20:55,560 --> 00:20:58,620
demonstrates<font color="#E5E5E5"> you know just the very</font>

645
00:20:57,480 --> 00:21:01,890
simple

646
00:20:58,620 --> 00:21:04,169
wireless client isolation bypass so food

647
00:21:01,890 --> 00:21:05,340
for thought we've<font color="#E5E5E5"> been you know so far</font>

648
00:21:04,170 --> 00:21:06,960
<font color="#E5E5E5">like I think a lot of the conversation</font>

649
00:21:05,340 --> 00:21:09,870
is<font color="#CCCCCC"> really focused around you know</font>

650
00:21:06,960 --> 00:21:12,540
whether<font color="#E5E5E5"> or not</font><font color="#CCCCCC"> an app</font><font color="#E5E5E5"> can be used</font><font color="#CCCCCC"> to</font>

651
00:21:09,870 --> 00:21:13,530
stop direct attack from<font color="#CCCCCC"> an attacker</font>

652
00:21:12,540 --> 00:21:15,210
who's gained access to<font color="#E5E5E5"> a wireless</font>

653
00:21:13,530 --> 00:21:16,410
network<font color="#E5E5E5"> but</font><font color="#CCCCCC"> I you know</font><font color="#E5E5E5"> what if we're</font>

654
00:21:15,210 --> 00:21:18,510
<font color="#CCCCCC">missing the point here</font>

655
00:21:16,410 --> 00:21:19,440
you know network access control<font color="#E5E5E5"> isn't</font>

656
00:21:18,510 --> 00:21:21,720
the only<font color="#E5E5E5"> problem</font><font color="#CCCCCC"> when containing</font>

657
00:21:19,440 --> 00:21:23,400
<font color="#CCCCCC">wireless</font><font color="#E5E5E5"> breaches</font><font color="#CCCCCC"> you know if you think</font>

658
00:21:21,720 --> 00:21:25,530
<font color="#CCCCCC">about</font><font color="#E5E5E5"> the role of</font><font color="#CCCCCC"> nack in a</font><font color="#E5E5E5"> wireless</font>

659
00:21:23,400 --> 00:21:27,150
network<font color="#CCCCCC"> it's being</font><font color="#E5E5E5"> used to prevent</font>

660
00:21:25,530 --> 00:21:30,300
attackers<font color="#E5E5E5"> from accessing sensitive</font>

661
00:21:27,150 --> 00:21:32,190
resources<font color="#CCCCCC"> after a breach occurs you know</font>

662
00:21:30,300 --> 00:21:34,620
<font color="#CCCCCC">so when an authorized</font><font color="#E5E5E5"> endpoints detected</font>

663
00:21:32,190 --> 00:21:35,730
<font color="#E5E5E5">you take one of one</font><font color="#CCCCCC"> of two possible</font>

664
00:21:34,620 --> 00:21:37,560
<font color="#CCCCCC">actions you know</font><font color="#E5E5E5"> either it place the</font>

665
00:21:35,730 --> 00:21:40,740
<font color="#E5E5E5">endpoint</font><font color="#CCCCCC"> in quarantine or you block the</font>

666
00:21:37,560 --> 00:21:42,120
port completely so what this is is that

667
00:21:40,740 --> 00:21:44,550
<font color="#E5E5E5">when you're violating access control</font>

668
00:21:42,120 --> 00:21:45,899
policies<font color="#CCCCCC"> you're causing the nack to</font>

669
00:21:44,550 --> 00:21:47,070
impose some kind<font color="#CCCCCC"> of restriction</font><font color="#E5E5E5"> in a</font>

670
00:21:45,900 --> 00:21:48,750
wired<font color="#CCCCCC"> network</font><font color="#E5E5E5"> that's</font><font color="#CCCCCC"> the physical</font>

671
00:21:47,070 --> 00:21:51,330
restriction but in a<font color="#E5E5E5"> wireless network</font>

672
00:21:48,750 --> 00:21:54,930
<font color="#E5E5E5">this can only be</font><font color="#CCCCCC"> a logical restriction</font>

673
00:21:51,330 --> 00:21:56,520
as we just saw with with Wi-Fi<font color="#E5E5E5"> tap more</font>

674
00:21:54,930 --> 00:21:59,340
<font color="#CCCCCC">than</font><font color="#E5E5E5"> that later so I want you to imagine</font>

675
00:21:56,520 --> 00:22:00,570
a pretty typical scenario<font color="#CCCCCC"> if you're if</font>

676
00:21:59,340 --> 00:22:01,860
you're incorporating<font color="#CCCCCC"> the</font><font color="#E5E5E5"> wireless into</font>

677
00:22:00,570 --> 00:22:04,649
you know your<font color="#CCCCCC"> Red Team engagement or</font>

678
00:22:01,860 --> 00:22:06,360
your pen test<font color="#E5E5E5"> right you're attacking the</font>

679
00:22:04,650 --> 00:22:07,950
wireless network and this<font color="#CCCCCC"> here this</font>

680
00:22:06,360 --> 00:22:09,360
<font color="#E5E5E5">particular wireless network is is used</font>

681
00:22:07,950 --> 00:22:11,670
to access<font color="#E5E5E5"> sensitive resources in other</font>

682
00:22:09,360 --> 00:22:13,080
words<font color="#E5E5E5"> a legitimate user could get on</font>

683
00:22:11,670 --> 00:22:14,850
this<font color="#E5E5E5"> wireless network</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> there</font>

684
00:22:13,080 --> 00:22:16,350
access stuff like you know production

685
00:22:14,850 --> 00:22:17,879
databases the domain controller

686
00:22:16,350 --> 00:22:18,959
eventually have that kind of<font color="#E5E5E5"> access it's</font>

687
00:22:17,880 --> 00:22:20,490
not just used as a straight pipe out to

688
00:22:18,960 --> 00:22:22,800
the<font color="#E5E5E5"> Internet so assume you've already</font>

689
00:22:20,490 --> 00:22:24,150
breached<font color="#E5E5E5"> the perimeter unfortunately</font>

690
00:22:22,800 --> 00:22:26,159
you've been placed as the<font color="#E5E5E5"> attacker on a</font>

691
00:22:24,150 --> 00:22:28,710
quarantine VLAN by the snack appliance

692
00:22:26,160 --> 00:22:30,900
<font color="#E5E5E5">it's just kind of here's the neck here</font>

693
00:22:28,710 --> 00:22:32,220
you are on this<font color="#E5E5E5"> quarantine VLAN over on</font>

694
00:22:30,900 --> 00:22:33,240
the restricted VLAN there's a bunch of

695
00:22:32,220 --> 00:22:35,070
sensitive resource and<font color="#E5E5E5"> that's ultimately</font>

696
00:22:33,240 --> 00:22:36,780
<font color="#E5E5E5">what you</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> access to because</font>

697
00:22:35,070 --> 00:22:38,010
<font color="#E5E5E5">you know if you can't get</font><font color="#CCCCCC"> access to that</font>

698
00:22:36,780 --> 00:22:41,220
you<font color="#E5E5E5"> really haven't</font><font color="#CCCCCC"> demonstrated anything</font>

699
00:22:38,010 --> 00:22:42,390
<font color="#E5E5E5">in the first place</font><font color="#CCCCCC"> fortunately for you</font>

700
00:22:41,220 --> 00:22:44,550
you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> that you have at least one</font>

701
00:22:42,390 --> 00:22:45,600
victim device on this<font color="#CCCCCC"> restrictive VLAN</font>

702
00:22:44,550 --> 00:22:46,950
because you would have<font color="#E5E5E5"> had to have</font>

703
00:22:45,600 --> 00:22:48,330
compromised<font color="#E5E5E5"> you would have had to</font><font color="#CCCCCC"> use</font>

704
00:22:46,950 --> 00:22:49,800
the<font color="#CCCCCC"> Rove AP attack against this victim</font>

705
00:22:48,330 --> 00:22:50,909
device in the<font color="#E5E5E5"> first place to get</font>

706
00:22:49,800 --> 00:22:53,669
<font color="#CCCCCC">Radiesse credentials</font><font color="#E5E5E5"> that would get you</font>

707
00:22:50,910 --> 00:22:55,260
<font color="#CCCCCC">onto this</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> so the question here</font>

708
00:22:53,670 --> 00:22:56,820
<font color="#CCCCCC">is</font><font color="#E5E5E5"> how do</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> get out how do we get from</font>

709
00:22:55,260 --> 00:22:58,500
<font color="#CCCCCC">this quarantine VLAN over to this</font>

710
00:22:56,820 --> 00:22:59,580
restricted VLAN or<font color="#E5E5E5"> over here where we</font>

711
00:22:58,500 --> 00:23:03,240
<font color="#CCCCCC">can actually</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> the goodies</font><font color="#CCCCCC"> like</font>

712
00:22:59,580 --> 00:23:07,010
sensitive resources so you know<font color="#E5E5E5"> anybody</font>

713
00:23:03,240 --> 00:23:09,600
here every user spotter before<font color="#CCCCCC"> okay yeah</font>

714
00:23:07,010 --> 00:23:12,540
<font color="#E5E5E5">everyone so for those</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> you who do not</font>

715
00:23:09,600 --> 00:23:13,949
<font color="#E5E5E5">know</font><font color="#CCCCCC"> one we have to go over a couple</font>

716
00:23:12,540 --> 00:23:15,030
<font color="#CCCCCC">things</font><font color="#E5E5E5"> that we're gonna like incorporate</font>

717
00:23:13,950 --> 00:23:16,500
into this attack<font color="#CCCCCC"> that we're gonna use to</font>

718
00:23:15,030 --> 00:23:18,540
<font color="#CCCCCC">perform this this pivot we're talking</font>

719
00:23:16,500 --> 00:23:21,600
about<font color="#E5E5E5"> the first</font><font color="#CCCCCC"> is element RM</font><font color="#E5E5E5"> betina's</font>

720
00:23:18,540 --> 00:23:23,460
poisoning so in case they're aware<font color="#E5E5E5"> the</font>

721
00:23:21,600 --> 00:23:25,260
<font color="#CCCCCC">way that NetBIOS name resolution</font><font color="#E5E5E5"> works</font>

722
00:23:23,460 --> 00:23:27,390
is that first you're gonna<font color="#E5E5E5"> check the</font>

723
00:23:25,260 --> 00:23:28,800
look<font color="#CCCCCC"> that when a computer tries to</font>

724
00:23:27,390 --> 00:23:29,940
<font color="#E5E5E5">resolve something using resolve a</font>

725
00:23:28,800 --> 00:23:31,740
<font color="#CCCCCC">hostname</font><font color="#E5E5E5"> using a NetBIOS name</font>

726
00:23:29,940 --> 00:23:33,690
<font color="#E5E5E5">solution it first checks its local</font><font color="#CCCCCC"> cash</font>

727
00:23:31,740 --> 00:23:35,279
if that doesn't work it's<font color="#E5E5E5"> gonna check</font>

728
00:23:33,690 --> 00:23:37,139
<font color="#E5E5E5">its lmhosts file if that doesn't</font><font color="#CCCCCC"> work</font>

729
00:23:35,279 --> 00:23:38,970
it's going to attempt<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use local DNS</font>

730
00:23:37,139 --> 00:23:41,519
and<font color="#E5E5E5"> if that fails we're gonna fall back</font>

731
00:23:38,970 --> 00:23:42,960
to<font color="#E5E5E5"> two closely related protocols that</font>

732
00:23:41,519 --> 00:23:45,600
pretty much behave the same way element

733
00:23:42,960 --> 00:23:47,789
<font color="#CCCCCC">RMB T&S and the way that that works is</font>

734
00:23:45,600 --> 00:23:49,860
<font color="#E5E5E5">element art meatiness</font><font color="#CCCCCC"> is going to send a</font>

735
00:23:47,789 --> 00:23:53,850
broadcast request out to<font color="#CCCCCC"> the entire</font>

736
00:23:49,860 --> 00:23:55,799
subnet<font color="#CCCCCC"> so the way that does this if you</font>

737
00:23:53,850 --> 00:23:58,080
can think<font color="#E5E5E5"> of two computers named Allison</font>

738
00:23:55,799 --> 00:24:00,090
Lee<font color="#E5E5E5"> Roy Lee Rose a file server and Alice</font>

739
00:23:58,080 --> 00:24:02,100
wants<font color="#CCCCCC"> to request a file from Lee Roy but</font>

740
00:24:00,090 --> 00:24:03,990
<font color="#E5E5E5">Alice does not know Leroy's IP Alice</font>

741
00:24:02,100 --> 00:24:09,629
will first attempt<font color="#CCCCCC"> to</font><font color="#E5E5E5"> work through those</font>

742
00:24:03,990 --> 00:24:10,710
<font color="#E5E5E5">first those those first NetBIOS name</font>

743
00:24:09,629 --> 00:24:13,019
resolution<font color="#E5E5E5"> steps that we talked about</font>

744
00:24:10,710 --> 00:24:14,370
<font color="#E5E5E5">before</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> suppose</font><font color="#CCCCCC"> that fails</font><font color="#E5E5E5"> at this</font>

745
00:24:13,019 --> 00:24:16,200
point<font color="#E5E5E5"> alice is gonna make a broadcast</font>

746
00:24:14,370 --> 00:24:18,928
request to the entire subnet using

747
00:24:16,200 --> 00:24:20,279
element<font color="#E5E5E5"> r mb t and s</font><font color="#CCCCCC"> and every computer</font>

748
00:24:18,929 --> 00:24:22,620
<font color="#CCCCCC">on Alice's subnets</font><font color="#E5E5E5"> going to receive this</font>

749
00:24:20,279 --> 00:24:23,820
<font color="#E5E5E5">request and what happens next really</font>

750
00:24:22,620 --> 00:24:25,289
depends<font color="#CCCCCC"> on the honor system</font><font color="#E5E5E5"> the ideas</font>

751
00:24:23,820 --> 00:24:27,509
that<font color="#E5E5E5"> only Leroy will respond to this</font>

752
00:24:25,289 --> 00:24:30,299
broadcast<font color="#CCCCCC"> request and and and provide</font>

753
00:24:27,509 --> 00:24:31,559
Alice with with an IP unfortunately you

754
00:24:30,299 --> 00:24:33,000
know there's no honor among thieves<font color="#CCCCCC"> you</font>

755
00:24:31,559 --> 00:24:34,620
know if we're an attacker and<font color="#E5E5E5"> we're</font>

756
00:24:33,000 --> 00:24:38,129
around the subnet we can simply listen

757
00:24:34,620 --> 00:24:39,779
for<font color="#E5E5E5"> these broadcast requests and and and</font>

758
00:24:38,129 --> 00:24:41,009
respond to<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> them and if Alice</font>

759
00:24:39,779 --> 00:24:43,220
<font color="#CCCCCC">receives two responses it's only the</font>

760
00:24:41,009 --> 00:24:45,480
<font color="#E5E5E5">first ones can be considered valid so</font>

761
00:24:43,220 --> 00:24:48,149
this<font color="#E5E5E5"> creates a race</font><font color="#CCCCCC"> condition that</font><font color="#E5E5E5"> can</font>

762
00:24:45,480 --> 00:24:50,759
<font color="#E5E5E5">be exploited to trick Alice the victim</font>

763
00:24:48,149 --> 00:24:56,428
into sending traffic to the attacker<font color="#E5E5E5"> so</font>

764
00:24:50,759 --> 00:24:58,590
<font color="#E5E5E5">quick timing</font><font color="#CCCCCC"> pretty pretty widely widely</font>

765
00:24:56,429 --> 00:25:02,100
available tool called<font color="#E5E5E5"> responder by</font>

766
00:24:58,590 --> 00:25:04,350
<font color="#CCCCCC">Laurence</font><font color="#E5E5E5"> Joffe and you see here we</font><font color="#CCCCCC"> have</font>

767
00:25:02,100 --> 00:25:06,719
a bunch<font color="#E5E5E5"> of rogue servers here with an</font>

768
00:25:04,350 --> 00:25:07,649
HTTP server HTTP server<font color="#CCCCCC"> SMB server these</font>

769
00:25:06,720 --> 00:25:09,990
are all listening<font color="#E5E5E5"> for authentication</font>

770
00:25:07,649 --> 00:25:11,129
attempts and we have here<font color="#E5E5E5"> our poisoners</font>

771
00:25:09,990 --> 00:25:12,659
we have our element<font color="#E5E5E5"> RM between s</font>

772
00:25:11,129 --> 00:25:14,820
poisoners up there as well and<font color="#E5E5E5"> they're</font>

773
00:25:12,659 --> 00:25:17,340
running and we have our victim<font color="#CCCCCC"> machine</font>

774
00:25:14,820 --> 00:25:20,639
over on<font color="#E5E5E5"> the right so the victim</font><font color="#CCCCCC"> machine</font>

775
00:25:17,340 --> 00:25:23,668
is going<font color="#E5E5E5"> to attempt to access it's gonna</font>

776
00:25:20,639 --> 00:25:25,740
attempt to map a non-existent<font color="#CCCCCC"> share or</font>

777
00:25:23,669 --> 00:25:27,659
an SMB share our non-existent<font color="#E5E5E5"> host right</font>

778
00:25:25,740 --> 00:25:28,860
and what that's going to do is<font color="#E5E5E5"> because</font>

779
00:25:27,659 --> 00:25:30,269
the host<font color="#E5E5E5"> doesn't actually exist it's</font>

780
00:25:28,860 --> 00:25:32,610
going to force<font color="#E5E5E5"> the</font><font color="#CCCCCC"> fallback to element R</font>

781
00:25:30,269 --> 00:25:34,950
and<font color="#E5E5E5"> B T and s so allow us to attack it</font>

782
00:25:32,610 --> 00:25:40,189
<font color="#CCCCCC">so we</font><font color="#E5E5E5"> put in this non-existent host name</font>

783
00:25:34,950 --> 00:25:42,299
as<font color="#E5E5E5"> well as well as an SMB share and</font>

784
00:25:40,190 --> 00:25:43,470
there we hash is on the left<font color="#CCCCCC"> because it</font>

785
00:25:42,299 --> 00:25:45,240
we were<font color="#CCCCCC"> able to poison</font>

786
00:25:43,470 --> 00:25:48,419
<font color="#CCCCCC">requests and forces try to authenticate</font>

787
00:25:45,240 --> 00:25:49,409
<font color="#E5E5E5">with us so we're about 5%</font><font color="#CCCCCC"> for a little</font>

788
00:25:48,419 --> 00:25:50,419
escape attempt here<font color="#E5E5E5"> but there's</font>

789
00:25:49,409 --> 00:25:52,200
something<font color="#CCCCCC"> else you have</font><font color="#E5E5E5"> to cover as well</font>

790
00:25:50,419 --> 00:25:54,510
<font color="#E5E5E5">the other thing we need</font><font color="#CCCCCC"> to cover is</font>

791
00:25:52,200 --> 00:25:58,799
redirect SMB so anybody familiar with

792
00:25:54,510 --> 00:26:03,450
redirect SMB<font color="#CCCCCC"> okay this guy obviously</font>

793
00:25:58,799 --> 00:26:05,070
obviously uses all the things<font color="#E5E5E5"> cuz so</font>

794
00:26:03,450 --> 00:26:07,740
redirect SMB essentially the<font color="#CCCCCC"> idea</font><font color="#E5E5E5"> is</font>

795
00:26:05,070 --> 00:26:10,340
<font color="#CCCCCC">that you you force a</font><font color="#E5E5E5"> victim to visit an</font>

796
00:26:07,740 --> 00:26:12,990
HTTP endpoint and this HTTP endpoint

797
00:26:10,340 --> 00:26:14,639
<font color="#CCCCCC">corresponds to an HTTP server that you</font>

798
00:26:12,990 --> 00:26:16,260
control this HTTP server does one thing

799
00:26:14,640 --> 00:26:19,110
<font color="#E5E5E5">and one thing only and</font><font color="#CCCCCC"> that's redirect</font>

800
00:26:16,260 --> 00:26:20,760
all HTTP requests<font color="#E5E5E5"> to</font><font color="#CCCCCC"> an SMB share</font>

801
00:26:19,110 --> 00:26:22,439
<font color="#E5E5E5">because you can do that so what'll</font>

802
00:26:20,760 --> 00:26:24,450
happen is<font color="#CCCCCC"> the the the</font><font color="#E5E5E5"> victim will click</font>

803
00:26:22,440 --> 00:26:26,789
this link<font color="#E5E5E5"> their browser will go to your</font>

804
00:26:24,450 --> 00:26:28,380
your your rogue HTTP server via rogue

805
00:26:26,789 --> 00:26:30,629
HTTP server will<font color="#CCCCCC"> redirect that</font><font color="#E5E5E5"> browser</font>

806
00:26:28,380 --> 00:26:32,250
to an SMB<font color="#E5E5E5"> share that you on a server</font>

807
00:26:30,630 --> 00:26:33,630
that<font color="#E5E5E5"> you control the browser will then</font>

808
00:26:32,250 --> 00:26:36,090
be forced<font color="#E5E5E5"> to authenticate with your</font>

809
00:26:33,630 --> 00:26:37,890
<font color="#E5E5E5">rogue SMB server and you get hashes</font><font color="#CCCCCC"> that</font>

810
00:26:36,090 --> 00:26:39,840
way so<font color="#E5E5E5"> this is pretty cool it also</font>

811
00:26:37,890 --> 00:26:41,850
requires social<font color="#E5E5E5"> engineering because</font><font color="#CCCCCC"> you</font>

812
00:26:39,840 --> 00:26:43,860
have to<font color="#E5E5E5"> click if the force a user or</font>

813
00:26:41,850 --> 00:26:46,799
<font color="#E5E5E5">coerce the user some way to click this</font>

814
00:26:43,860 --> 00:26:48,418
link<font color="#E5E5E5"> so</font><font color="#CCCCCC"> this is we're</font><font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> start</font>

815
00:26:46,799 --> 00:26:49,950
<font color="#CCCCCC">talking</font><font color="#E5E5E5"> about new stuff</font><font color="#CCCCCC"> the first thing</font>

816
00:26:48,419 --> 00:26:51,390
we<font color="#E5E5E5"> tackle</font><font color="#CCCCCC"> get introduced is the</font><font color="#E5E5E5"> hostile</font>

817
00:26:49,950 --> 00:26:53,190
portal attack and it's essentially a

818
00:26:51,390 --> 00:26:55,409
combination<font color="#E5E5E5"> of the stuff we</font><font color="#CCCCCC"> just talked</font>

819
00:26:53,190 --> 00:26:57,030
about<font color="#E5E5E5"> and it's a means of kind of</font>

820
00:26:55,409 --> 00:26:59,429
leverage<font color="#E5E5E5"> that the leveraging the stuff</font>

821
00:26:57,030 --> 00:27:03,270
to steal ad credit from wireless<font color="#E5E5E5"> network</font>

822
00:26:59,429 --> 00:27:04,470
without network access so<font color="#CCCCCC"> have you guys</font>

823
00:27:03,270 --> 00:27:07,110
seen something like this lately<font color="#CCCCCC"> the</font>

824
00:27:04,470 --> 00:27:09,600
captive portal yeah they're pretty<font color="#CCCCCC"> cool</font>

825
00:27:07,110 --> 00:27:11,729
right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> a captive portal it's used to</font>

826
00:27:09,600 --> 00:27:13,350
restrict<font color="#E5E5E5"> access to an open Wi-Fi network</font>

827
00:27:11,730 --> 00:27:15,419
and the<font color="#E5E5E5"> way that they usually work is</font>

828
00:27:13,350 --> 00:27:16,740
that<font color="#E5E5E5"> you know there was you know that</font>

829
00:27:15,419 --> 00:27:17,789
you typically have a specially

830
00:27:16,740 --> 00:27:20,070
configured DNS server that's running

831
00:27:17,789 --> 00:27:22,950
<font color="#E5E5E5">there was all resolves all DNS queries</font>

832
00:27:20,070 --> 00:27:24,600
to the<font color="#E5E5E5"> captive portal</font><font color="#CCCCCC"> and and also</font><font color="#E5E5E5"> all</font>

833
00:27:22,950 --> 00:27:26,940
DNS<font color="#CCCCCC"> traffic will be redirected to the</font>

834
00:27:24,600 --> 00:27:28,230
cafe traffic<font color="#E5E5E5"> captive portal so</font><font color="#CCCCCC"> that the</font>

835
00:27:26,940 --> 00:27:30,600
<font color="#E5E5E5">the user cannot just manually specify</font>

836
00:27:28,230 --> 00:27:31,890
their own DNS server in addition to that

837
00:27:30,600 --> 00:27:34,980
if you<font color="#E5E5E5"> really</font><font color="#CCCCCC"> want be nasty you can also</font>

838
00:27:31,890 --> 00:27:36,240
<font color="#CCCCCC">redirect all HTTP traffic to the the</font>

839
00:27:34,980 --> 00:27:38,549
server that's that's hosting this

840
00:27:36,240 --> 00:27:39,750
captive portal login page<font color="#E5E5E5"> so the net</font>

841
00:27:38,549 --> 00:27:41,639
effect<font color="#CCCCCC"> is no matter</font><font color="#E5E5E5"> where you try to</font>

842
00:27:39,750 --> 00:27:44,220
<font color="#E5E5E5">navigate to you're just redirected to</font>

843
00:27:41,640 --> 00:27:46,260
this<font color="#E5E5E5"> login page so a</font><font color="#CCCCCC"> hostel portal tag</font>

844
00:27:44,220 --> 00:27:47,789
kind of expands on<font color="#E5E5E5"> this right it's based</font>

845
00:27:46,260 --> 00:27:49,500
on the both<font color="#E5E5E5"> the redirect s and B and</font>

846
00:27:47,789 --> 00:27:51,179
also<font color="#E5E5E5"> like a captive portal technique and</font>

847
00:27:49,500 --> 00:27:54,210
it is<font color="#CCCCCC"> that you first force a victim to</font>

848
00:27:51,179 --> 00:27:55,980
connect to you using rogue<font color="#E5E5E5"> ap attack</font><font color="#CCCCCC"> but</font>

849
00:27:54,210 --> 00:27:57,420
then what you<font color="#E5E5E5"> do is you simply redirect</font>

850
00:27:55,980 --> 00:27:59,130
all HTTP traffic

851
00:27:57,420 --> 00:28:01,590
<font color="#E5E5E5">to an SMB share on your machine and you</font>

852
00:27:59,130 --> 00:28:04,470
run a rogue SMB server in the<font color="#CCCCCC"> background</font>

853
00:28:01,590 --> 00:28:06,750
<font color="#E5E5E5">so the what happens is that the user is</font>

854
00:28:04,470 --> 00:28:09,060
forced to connect to you but instead<font color="#CCCCCC"> of</font>

855
00:28:06,750 --> 00:28:10,800
<font color="#E5E5E5">being redirected to a captive portal</font>

856
00:28:09,060 --> 00:28:12,990
<font color="#E5E5E5">there they're forced to redirect to</font><font color="#CCCCCC"> your</font>

857
00:28:10,800 --> 00:28:14,280
rogue SMB server<font color="#E5E5E5"> and what happens is</font>

858
00:28:12,990 --> 00:28:17,160
then they're forced<font color="#E5E5E5"> authentic cute with</font>

859
00:28:14,280 --> 00:28:19,080
you and they give you hashes<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that's</font>

860
00:28:17,160 --> 00:28:21,390
it's a really fast way to grab hashes<font color="#CCCCCC"> in</font>

861
00:28:19,080 --> 00:28:22,560
<font color="#CCCCCC">addition in case that</font><font color="#E5E5E5"> you know that they</font>

862
00:28:21,390 --> 00:28:24,330
just<font color="#CCCCCC"> have to be idle at the time you can</font>

863
00:28:22,560 --> 00:28:26,600
also<font color="#E5E5E5"> poison elvenar and every</font><font color="#CCCCCC"> TNS in the</font>

864
00:28:24,330 --> 00:28:28,290
background<font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> you can also</font>

865
00:28:26,600 --> 00:28:30,929
attack them that way as well

866
00:28:28,290 --> 00:28:33,090
simultaneously so a quick demo of<font color="#E5E5E5"> how</font>

867
00:28:30,930 --> 00:28:35,010
this<font color="#E5E5E5"> would work we have here where this</font>

868
00:28:33,090 --> 00:28:38,970
<font color="#E5E5E5">is this machine here is our legitimate</font>

869
00:28:35,010 --> 00:28:40,860
<font color="#CCCCCC">network</font><font color="#E5E5E5"> and our our victim is down low</font>

870
00:28:38,970 --> 00:28:42,390
<font color="#E5E5E5">in the</font><font color="#CCCCCC"> bottom right and</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> associated</font>

871
00:28:40,860 --> 00:28:43,290
<font color="#CCCCCC">with this legitimate network</font><font color="#E5E5E5"> this is an</font>

872
00:28:42,390 --> 00:28:44,820
open network we're going to talk<font color="#E5E5E5"> about</font>

873
00:28:43,290 --> 00:28:45,870
how to do this with EAP people Network

874
00:28:44,820 --> 00:28:48,480
<font color="#E5E5E5">syn a second but there's a couple more</font>

875
00:28:45,870 --> 00:28:49,739
<font color="#E5E5E5">steps involve it doing so and over here</font>

876
00:28:48,480 --> 00:28:51,540
we<font color="#E5E5E5"> have the attacker the first thing the</font>

877
00:28:49,740 --> 00:28:53,790
attacker is<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to do is use some D</font>

878
00:28:51,540 --> 00:28:58,830
off<font color="#E5E5E5"> packets to force this victim to roam</font>

879
00:28:53,790 --> 00:29:00,629
<font color="#E5E5E5">over to the the attackers rogue access</font>

880
00:28:58,830 --> 00:29:03,300
point<font color="#E5E5E5"> now the victim in the bottom right</font>

881
00:29:00,630 --> 00:29:05,580
<font color="#CCCCCC">is going</font><font color="#E5E5E5"> to open up</font><font color="#CCCCCC"> ie</font><font color="#E5E5E5"> and the second</font>

882
00:29:03,300 --> 00:29:07,620
<font color="#E5E5E5">that this it tries</font><font color="#CCCCCC"> to set start sending</font>

883
00:29:05,580 --> 00:29:10,590
HTTP traffic<font color="#CCCCCC"> you end</font><font color="#E5E5E5"> up with hashes</font>

884
00:29:07,620 --> 00:29:12,090
which is what you see<font color="#CCCCCC"> here actually</font>

885
00:29:10,590 --> 00:29:15,090
<font color="#CCCCCC">really interesting</font><font color="#E5E5E5"> thing about</font><font color="#CCCCCC"> IE right</font>

886
00:29:12,090 --> 00:29:17,340
<font color="#CCCCCC">is that when you type stuff in the</font>

887
00:29:15,090 --> 00:29:18,840
address bar it doesn't<font color="#E5E5E5"> autocomplete</font>

888
00:29:17,340 --> 00:29:20,129
thing which sends an HTTP request so

889
00:29:18,840 --> 00:29:21,449
every time we type a new letter and here

890
00:29:20,130 --> 00:29:26,400
we're<font color="#CCCCCC"> actually receiving</font><font color="#E5E5E5"> the hashes over</font>

891
00:29:21,450 --> 00:29:28,950
and over again<font color="#CCCCCC"> so good</font><font color="#E5E5E5"> job ie so yeah</font>

892
00:29:26,400 --> 00:29:29,880
<font color="#E5E5E5">when you you</font><font color="#CCCCCC"> know in</font><font color="#E5E5E5"> most cases we also</font>

893
00:29:28,950 --> 00:29:31,800
need to talk<font color="#E5E5E5"> about how to do this with a</font>

894
00:29:29,880 --> 00:29:33,780
WPA EAP<font color="#CCCCCC"> network because in order</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> kind</font>

895
00:29:31,800 --> 00:29:36,240
of tie this to<font color="#CCCCCC"> the scenario we were</font>

896
00:29:33,780 --> 00:29:37,649
talking<font color="#CCCCCC"> about addressing</font><font color="#E5E5E5"> earlier</font><font color="#CCCCCC"> we need</font>

897
00:29:36,240 --> 00:29:39,960
to be<font color="#CCCCCC"> able to use this with networks</font>

898
00:29:37,650 --> 00:29:41,190
that use apt TLS or<font color="#E5E5E5"> eep eep eep</font>

899
00:29:39,960 --> 00:29:43,020
this actually is significantly<font color="#E5E5E5"> harder</font>

900
00:29:41,190 --> 00:29:44,550
because<font color="#E5E5E5"> both of these</font><font color="#CCCCCC"> use</font><font color="#E5E5E5"> mschap</font><font color="#CCCCCC"> e to as</font>

901
00:29:43,020 --> 00:29:46,860
an internal authentication mechanism and

902
00:29:44,550 --> 00:29:48,600
<font color="#E5E5E5">you know what this means is what I mean</font>

903
00:29:46,860 --> 00:29:49,679
<font color="#CCCCCC">by mutual authentication mechanism eken</font>

904
00:29:48,600 --> 00:29:52,260
ism is<font color="#E5E5E5"> that the radius server must</font>

905
00:29:49,680 --> 00:29:54,090
actually<font color="#E5E5E5"> prove knowledge of the client</font>

906
00:29:52,260 --> 00:29:56,280
devices password for the internal

907
00:29:54,090 --> 00:29:58,620
dedication attempt to succeed you<font color="#CCCCCC"> know</font>

908
00:29:56,280 --> 00:30:01,320
so previously<font color="#CCCCCC"> you know we were able to</font>

909
00:29:58,620 --> 00:30:02,669
demonstrate<font color="#E5E5E5"> that you can force a victim</font>

910
00:30:01,320 --> 00:30:05,010
to associate<font color="#E5E5E5"> with you</font><font color="#CCCCCC"> an attempt</font><font color="#E5E5E5"> to</font>

911
00:30:02,670 --> 00:30:05,880
<font color="#E5E5E5">authenticate with you right and it will</font>

912
00:30:05,010 --> 00:30:07,500
go<font color="#E5E5E5"> through all the steps of the</font>

913
00:30:05,880 --> 00:30:08,880
<font color="#E5E5E5">authentication</font><font color="#CCCCCC"> process</font><font color="#E5E5E5"> to the point</font>

914
00:30:07,500 --> 00:30:10,290
where you<font color="#CCCCCC"> actually have an</font><font color="#E5E5E5"> MS</font><font color="#CCCCCC"> happy to</font>

915
00:30:08,880 --> 00:30:11,250
challenge a response which you can crack

916
00:30:10,290 --> 00:30:13,490
<font color="#E5E5E5">offline</font>

917
00:30:11,250 --> 00:30:15,179
to derive<font color="#CCCCCC"> radius credentials</font>

918
00:30:13,490 --> 00:30:18,270
<font color="#CCCCCC">unfortunately what's gonna happen at the</font>

919
00:30:15,179 --> 00:30:19,830
very<font color="#E5E5E5"> end of</font><font color="#CCCCCC"> that process</font><font color="#E5E5E5"> is that you as</font>

920
00:30:18,270 --> 00:30:21,780
<font color="#E5E5E5">the attacker you're you as the</font>

921
00:30:19,830 --> 00:30:23,850
authentication server<font color="#CCCCCC"> need to then</font>

922
00:30:21,780 --> 00:30:25,590
authenticate back with the client and

923
00:30:23,850 --> 00:30:28,620
<font color="#E5E5E5">demonstrate the client that</font><font color="#CCCCCC"> you also</font>

924
00:30:25,590 --> 00:30:30,000
know the<font color="#E5E5E5"> clients radius password and if</font>

925
00:30:28,620 --> 00:30:33,239
you can't do that<font color="#CCCCCC"> the authentication</font>

926
00:30:30,000 --> 00:30:33,929
<font color="#E5E5E5">intent is</font><font color="#CCCCCC"> gonna fail</font><font color="#E5E5E5"> so I mean this is</font>

927
00:30:33,240 --> 00:30:35,670
something<font color="#E5E5E5"> that we really</font><font color="#CCCCCC"> need to</font>

928
00:30:33,929 --> 00:30:37,049
overcome<font color="#CCCCCC"> because pretty</font><font color="#E5E5E5"> much any</font>

929
00:30:35,670 --> 00:30:38,490
interesting rogue ap attack that you

930
00:30:37,049 --> 00:30:39,660
want to do aside from<font color="#E5E5E5"> simply stealing</font>

931
00:30:38,490 --> 00:30:41,850
<font color="#E5E5E5">radius credentials you're going to need</font>

932
00:30:39,660 --> 00:30:44,160
a full<font color="#CCCCCC"> Association from those clients</font>

933
00:30:41,850 --> 00:30:47,219
<font color="#E5E5E5">that are connecting</font><font color="#CCCCCC"> to you now there</font><font color="#E5E5E5"> are</font>

934
00:30:44,160 --> 00:30:48,419
a<font color="#E5E5E5"> couple ways of doing this</font><font color="#CCCCCC"> the there</font>

935
00:30:47,220 --> 00:30:49,380
already<font color="#CCCCCC"> exist I mean for</font><font color="#E5E5E5"> weak rated</font>

936
00:30:48,419 --> 00:30:50,970
scree<font color="#E5E5E5"> Angeles you</font><font color="#CCCCCC"> can use something</font>

937
00:30:49,380 --> 00:30:52,200
<font color="#E5E5E5">called</font><font color="#CCCCCC"> Auto crack and AD this is a</font>

938
00:30:50,970 --> 00:30:53,669
technique<font color="#E5E5E5"> that was developed by</font><font color="#CCCCCC"> Dominic</font>

939
00:30:52,200 --> 00:30:55,950
white and named<font color="#E5E5E5"> de</font><font color="#CCCCCC"> Villiers</font><font color="#E5E5E5"> in the same</font>

940
00:30:53,669 --> 00:30:58,230
talk where they improved<font color="#E5E5E5"> karma tax 2014</font>

941
00:30:55,950 --> 00:31:00,419
and that'll work<font color="#E5E5E5"> for</font><font color="#CCCCCC"> weak radius</font><font color="#E5E5E5"> creds</font>

942
00:30:58,230 --> 00:31:01,980
<font color="#E5E5E5">for stronger radius creds</font><font color="#CCCCCC"> remember</font><font color="#E5E5E5"> that</font>

943
00:31:00,419 --> 00:31:03,720
we can crack<font color="#CCCCCC"> Emma Chaffee to challenge</font>

944
00:31:01,980 --> 00:31:04,830
and<font color="#E5E5E5"> responses relatively quickly</font><font color="#CCCCCC"> so of</font>

945
00:31:03,720 --> 00:31:06,540
course you could<font color="#CCCCCC"> just crack</font><font color="#E5E5E5"> them offline</font>

946
00:31:04,830 --> 00:31:08,189
<font color="#E5E5E5">come back and finish</font><font color="#CCCCCC"> the attack</font><font color="#E5E5E5"> once you</font>

947
00:31:06,540 --> 00:31:11,399
have valid radius credentials<font color="#E5E5E5"> let's talk</font>

948
00:31:08,190 --> 00:31:13,470
about both both<font color="#E5E5E5"> of these so the very end</font>

949
00:31:11,400 --> 00:31:15,030
of the MS<font color="#CCCCCC"> Chaffee to challenge</font>

950
00:31:13,470 --> 00:31:17,940
<font color="#E5E5E5">Emma's</font><font color="#CCCCCC"> chavvy to authentication</font><font color="#E5E5E5"> process</font>

951
00:31:15,030 --> 00:31:19,649
<font color="#E5E5E5">the victim is going</font><font color="#CCCCCC"> to send a challenge</font>

952
00:31:17,940 --> 00:31:21,809
<font color="#E5E5E5">response by the way this overhears</font><font color="#CCCCCC"> the</font>

953
00:31:19,650 --> 00:31:25,890
<font color="#E5E5E5">victim this overhears hostapd hopes to</font>

954
00:31:21,809 --> 00:31:27,149
hostapd is the is<font color="#CCCCCC"> that is essentially</font>

955
00:31:25,890 --> 00:31:28,590
<font color="#E5E5E5">what you use as a radius server</font><font color="#CCCCCC"> whenever</font>

956
00:31:27,150 --> 00:31:30,960
<font color="#E5E5E5">you're you're performing this kind</font><font color="#CCCCCC"> of</font>

957
00:31:28,590 --> 00:31:32,220
attack<font color="#CCCCCC"> so the first thing is gonna</font>

958
00:31:30,960 --> 00:31:34,049
happen the very end of the Emma<font color="#E5E5E5"> Chaffee</font>

959
00:31:32,220 --> 00:31:35,490
<font color="#CCCCCC">to authentication process</font><font color="#E5E5E5"> is that the</font>

960
00:31:34,049 --> 00:31:38,070
victim is<font color="#E5E5E5"> going to send a challenge</font>

961
00:31:35,490 --> 00:31:40,740
response and<font color="#CCCCCC"> that's the thing that</font><font color="#E5E5E5"> you</font>

962
00:31:38,070 --> 00:31:42,330
<font color="#E5E5E5">used to crack the the radius creds to to</font>

963
00:31:40,740 --> 00:31:44,250
your<font color="#E5E5E5"> radius server which is hostapd</font>

964
00:31:42,330 --> 00:31:46,399
<font color="#E5E5E5">hostapd at that point is going</font><font color="#CCCCCC"> to</font>

965
00:31:44,250 --> 00:31:48,299
<font color="#E5E5E5">attempt to load the</font><font color="#CCCCCC"> victim's password</font>

966
00:31:46,400 --> 00:31:49,890
from this thing called the<font color="#E5E5E5"> EAP user</font>

967
00:31:48,299 --> 00:31:51,480
filing EAP user files essentially<font color="#E5E5E5"> a</font>

968
00:31:49,890 --> 00:31:53,280
primitive database that's<font color="#CCCCCC"> implemented</font>

969
00:31:51,480 --> 00:31:55,080
using a text file<font color="#CCCCCC"> that has information</font>

970
00:31:53,280 --> 00:31:56,700
<font color="#E5E5E5">about you know you've different users</font>

971
00:31:55,080 --> 00:31:57,960
<font color="#CCCCCC">and how they can authenticate and you</font>

972
00:31:56,700 --> 00:31:59,669
know what their passwords are etcetera

973
00:31:57,960 --> 00:32:01,410
so it's going to temp to load that

974
00:31:59,669 --> 00:32:03,179
password<font color="#CCCCCC"> and then from there it's going</font>

975
00:32:01,410 --> 00:32:05,010
<font color="#CCCCCC">to use</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> password to construct an</font>

976
00:32:03,179 --> 00:32:07,410
authentication response<font color="#E5E5E5"> that is sent</font>

977
00:32:05,010 --> 00:32:09,510
<font color="#E5E5E5">along with the authentication success</font>

978
00:32:07,410 --> 00:32:10,740
method message to the victim<font color="#E5E5E5"> of course</font>

979
00:32:09,510 --> 00:32:13,049
if you<font color="#E5E5E5"> don't already have the</font><font color="#CCCCCC"> user's</font>

980
00:32:10,740 --> 00:32:14,880
password<font color="#E5E5E5"> or password hash or NT password</font>

981
00:32:13,049 --> 00:32:16,620
<font color="#E5E5E5">hashes I say you're not going to be able</font>

982
00:32:14,880 --> 00:32:18,600
to accurately<font color="#E5E5E5"> construct this</font>

983
00:32:16,620 --> 00:32:20,489
authentication response<font color="#E5E5E5"> so this this</font>

984
00:32:18,600 --> 00:32:22,260
part of the<font color="#E5E5E5"> process here is going to</font>

985
00:32:20,490 --> 00:32:23,660
fail and they're<font color="#E5E5E5"> not good and the</font>

986
00:32:22,260 --> 00:32:25,560
<font color="#E5E5E5">authentication attempts going to fail</font>

987
00:32:23,660 --> 00:32:27,450
so the way that<font color="#CCCCCC"> you get around this</font>

988
00:32:25,560 --> 00:32:28,590
<font color="#E5E5E5">using</font><font color="#CCCCCC"> auto crack and AD is</font><font color="#E5E5E5"> auto crack</font>

989
00:32:27,450 --> 00:32:30,210
<font color="#E5E5E5">and</font><font color="#CCCCCC"> AD</font><font color="#E5E5E5"> the way that it works is that the</font>

990
00:32:28,590 --> 00:32:33,540
<font color="#CCCCCC">second you receive the challenge</font>

991
00:32:30,210 --> 00:32:34,950
response<font color="#E5E5E5"> you actually modify hostapd so</font>

992
00:32:33,540 --> 00:32:36,840
that instead<font color="#E5E5E5"> of immediately loading the</font>

993
00:32:34,950 --> 00:32:38,820
password from the<font color="#E5E5E5"> AP user file you</font>

994
00:32:36,840 --> 00:32:40,649
instead<font color="#E5E5E5"> shoot off the challenge</font>

995
00:32:38,820 --> 00:32:42,030
challenge and response<font color="#E5E5E5"> off to a remote</font>

996
00:32:40,650 --> 00:32:44,100
cracking<font color="#CCCCCC"> rig somewhere</font><font color="#E5E5E5"> which presumably</font>

997
00:32:42,030 --> 00:32:45,570
is equipped to<font color="#E5E5E5"> crack these passwords</font>

998
00:32:44,100 --> 00:32:47,760
relatively quickly<font color="#CCCCCC"> so you've essentially</font>

999
00:32:45,570 --> 00:32:49,679
<font color="#E5E5E5">make an API call</font><font color="#CCCCCC"> to your cracking rig</font>

1000
00:32:47,760 --> 00:32:51,180
<font color="#E5E5E5">the cracking rig at this point cracks</font>

1001
00:32:49,680 --> 00:32:52,560
these radius that<font color="#CCCCCC"> limits a fee to</font>

1002
00:32:51,180 --> 00:32:54,630
<font color="#E5E5E5">challenge a response to get an NT</font>

1003
00:32:52,560 --> 00:32:58,080
password hash and then you just append

1004
00:32:54,630 --> 00:33:00,930
that that NT password<font color="#E5E5E5"> hash</font><font color="#CCCCCC"> or password</font>

1005
00:32:58,080 --> 00:33:03,030
<font color="#E5E5E5">to the end of the EAP user file at that</font>

1006
00:33:00,930 --> 00:33:05,460
point you continue with this with this

1007
00:33:03,030 --> 00:33:08,190
image<font color="#CCCCCC"> a fee to</font><font color="#E5E5E5"> authentication process by</font>

1008
00:33:05,460 --> 00:33:09,870
loading<font color="#E5E5E5"> the the newly appended password</font>

1009
00:33:08,190 --> 00:33:11,970
from the<font color="#E5E5E5"> EAP user file use it to</font>

1010
00:33:09,870 --> 00:33:13,770
construct<font color="#CCCCCC"> the authentication</font><font color="#E5E5E5"> response</font>

1011
00:33:11,970 --> 00:33:15,390
and send<font color="#CCCCCC"> that with the authenticated</font>

1012
00:33:13,770 --> 00:33:19,650
authentication success message<font color="#CCCCCC"> off to</font>

1013
00:33:15,390 --> 00:33:20,940
<font color="#CCCCCC">the victim</font><font color="#E5E5E5"> so that can work with with</font>

1014
00:33:19,650 --> 00:33:22,440
weak<font color="#CCCCCC"> passwords</font><font color="#E5E5E5"> and it could take</font>

1015
00:33:20,940 --> 00:33:24,450
<font color="#CCCCCC">anywhere between</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> few seconds or it</font>

1016
00:33:22,440 --> 00:33:26,040
could take<font color="#CCCCCC"> a couple tries because</font><font color="#E5E5E5"> really</font>

1017
00:33:24,450 --> 00:33:28,860
boils down to can you crack<font color="#CCCCCC"> it in time</font>

1018
00:33:26,040 --> 00:33:31,379
before<font color="#E5E5E5"> this authentication attempt times</font>

1019
00:33:28,860 --> 00:33:32,790
out<font color="#E5E5E5"> but for well it's a relatively weak</font>

1020
00:33:31,380 --> 00:33:35,070
passwords this should<font color="#E5E5E5"> work but you know</font>

1021
00:33:32,790 --> 00:33:37,290
between like four or five tries<font color="#E5E5E5"> for</font>

1022
00:33:35,070 --> 00:33:39,840
<font color="#E5E5E5">stronger for stronger passwords for</font>

1023
00:33:37,290 --> 00:33:41,070
stronger<font color="#CCCCCC"> ADA's passwords you you you</font>

1024
00:33:39,840 --> 00:33:42,689
aren't gonna be<font color="#E5E5E5"> able to do this because</font>

1025
00:33:41,070 --> 00:33:44,520
<font color="#E5E5E5">you're not going to crack it in time</font><font color="#CCCCCC"> but</font>

1026
00:33:42,690 --> 00:33:46,260
<font color="#E5E5E5">remember that the with the</font>

1027
00:33:44,520 --> 00:33:48,000
<font color="#CCCCCC">divide-and-conquer</font><font color="#E5E5E5"> technique you have</font><font color="#CCCCCC"> a</font>

1028
00:33:46,260 --> 00:33:50,550
<font color="#E5E5E5">24 hour maximum the amount</font><font color="#CCCCCC"> of time if</font>

1029
00:33:48,000 --> 00:33:53,000
you're using FPGA based<font color="#CCCCCC"> hardware</font><font color="#E5E5E5"> to</font>

1030
00:33:50,550 --> 00:33:55,590
crack these<font color="#CCCCCC"> to crack these credentials</font>

1031
00:33:53,000 --> 00:33:58,380
<font color="#E5E5E5">so here's a demonstration of how you</font>

1032
00:33:55,590 --> 00:33:59,610
<font color="#E5E5E5">just incorporate the the the auto crack</font>

1033
00:33:58,380 --> 00:34:02,400
and<font color="#CCCCCC"> add technique it looks a lot</font><font color="#E5E5E5"> like</font>

1034
00:33:59,610 --> 00:34:04,740
what we did before<font color="#E5E5E5"> you know we first</font>

1035
00:34:02,400 --> 00:34:07,890
forced the<font color="#E5E5E5"> that's gonna take a couple</font>

1036
00:34:04,740 --> 00:34:09,360
tries<font color="#E5E5E5"> to force the the the victim over</font>

1037
00:34:07,890 --> 00:34:13,020
<font color="#E5E5E5">here to associate with the attacker to</font>

1038
00:34:09,360 --> 00:34:14,280
<font color="#E5E5E5">authenticate with the attacker</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you</font>

1039
00:34:13,020 --> 00:34:16,860
see here<font color="#E5E5E5"> this time the</font><font color="#CCCCCC"> the victim is</font>

1040
00:34:14,280 --> 00:34:18,360
<font color="#CCCCCC">being you know prompted with this</font><font color="#E5E5E5"> this</font>

1041
00:34:16,860 --> 00:34:22,500
certificate<font color="#E5E5E5"> warning because we've we've</font>

1042
00:34:18,360 --> 00:34:23,580
given them an invalid certificate but

1043
00:34:22,500 --> 00:34:25,560
we've gotten them<font color="#CCCCCC"> to associate</font><font color="#E5E5E5"> with us</font>

1044
00:34:23,580 --> 00:34:26,630
<font color="#CCCCCC">and as before the second they</font><font color="#E5E5E5"> opened up</font>

1045
00:34:25,560 --> 00:34:29,219
by<font color="#CCCCCC"> e</font>

1046
00:34:26,630 --> 00:34:30,840
<font color="#CCCCCC">HTTP traffic is sent</font><font color="#E5E5E5"> we're able to</font>

1047
00:34:29,219 --> 00:34:32,189
redirect<font color="#E5E5E5"> that to</font><font color="#CCCCCC"> our SMB server and we</font>

1048
00:34:30,840 --> 00:34:34,950
get their hat their password hashes<font color="#CCCCCC"> that</font>

1049
00:34:32,190 --> 00:34:36,668
way so what this<font color="#E5E5E5"> gets you is lost in</font>

1050
00:34:34,949 --> 00:34:37,899
lots of ntlm hashes

1051
00:34:36,668 --> 00:34:39,399
get<font color="#E5E5E5"> really similar results to what you</font>

1052
00:34:37,899 --> 00:34:41,469
get<font color="#E5E5E5"> with element</font><font color="#CCCCCC"> Arnav 18s poisoning</font>

1053
00:34:39,399 --> 00:34:42,549
<font color="#CCCCCC">there a few key advantages here for one</font>

1054
00:34:41,469 --> 00:34:43,719
<font color="#E5E5E5">thing you don't need to reckon at work</font>

1055
00:34:42,549 --> 00:34:45,730
action<font color="#CCCCCC"> so you</font><font color="#E5E5E5"> don't have to be like on</font>

1056
00:34:43,719 --> 00:34:47,138
<font color="#CCCCCC">the network in order</font><font color="#E5E5E5"> to do this</font><font color="#CCCCCC"> the</font>

1057
00:34:45,730 --> 00:34:48,879
other thing is that<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> not limited</font>

1058
00:34:47,139 --> 00:34:49,990
<font color="#CCCCCC">to just attacking</font><font color="#E5E5E5"> a local subnet</font><font color="#CCCCCC"> you get</font>

1059
00:34:48,879 --> 00:34:51,520
everything<font color="#E5E5E5"> that's connected</font><font color="#CCCCCC"> to wireless</font>

1060
00:34:49,989 --> 00:34:53,739
<font color="#E5E5E5">so that's that that's pretty important</font>

1061
00:34:51,520 --> 00:34:55,139
<font color="#CCCCCC">and</font><font color="#E5E5E5"> and and and most important it's</font><font color="#CCCCCC"> not</font>

1062
00:34:53,739 --> 00:34:57,669
a passive<font color="#E5E5E5"> attack you're not waiting</font><font color="#CCCCCC"> for</font>

1063
00:34:55,139 --> 00:34:59,470
<font color="#E5E5E5">broadcasts or a request to appear on a</font>

1064
00:34:57,670 --> 00:35:03,520
local subnet<font color="#E5E5E5"> you're actually making this</font>

1065
00:34:59,470 --> 00:35:04,750
happen<font color="#E5E5E5"> so back to our scenario</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can we</font>

1066
00:35:03,520 --> 00:35:07,000
can<font color="#E5E5E5"> use this technique that we just</font>

1067
00:35:04,750 --> 00:35:08,680
<font color="#E5E5E5">talked about the hostile portal we could</font>

1068
00:35:07,000 --> 00:35:10,180
build<font color="#E5E5E5"> off of that</font><font color="#CCCCCC"> too to do something</font>

1069
00:35:08,680 --> 00:35:12,819
called an indirect<font color="#CCCCCC"> Wireless pivot and</font>

1070
00:35:10,180 --> 00:35:14,109
that's a way<font color="#CCCCCC"> of using rogue ap attacks</font>

1071
00:35:12,819 --> 00:35:16,839
to bypass port based access control

1072
00:35:14,109 --> 00:35:18,190
mechanisms so we mentioned here<font color="#CCCCCC"> that</font>

1073
00:35:16,839 --> 00:35:19,690
we're stuck<font color="#E5E5E5"> on our quarantine VLAN and</font>

1074
00:35:18,190 --> 00:35:21,040
<font color="#E5E5E5">we want to get over</font><font color="#CCCCCC"> to this restricted</font>

1075
00:35:19,690 --> 00:35:22,420
VLAN<font color="#E5E5E5"> and</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to access these</font>

1076
00:35:21,040 --> 00:35:24,130
<font color="#E5E5E5">sensitive resources here and we have a</font>

1077
00:35:22,420 --> 00:35:25,960
<font color="#E5E5E5">victim device that that is on the</font>

1078
00:35:24,130 --> 00:35:27,099
<font color="#CCCCCC">restricted VLAN as well and we</font><font color="#E5E5E5"> have this</font>

1079
00:35:25,960 --> 00:35:29,710
knack that<font color="#E5E5E5"> is kind of preventing us from</font>

1080
00:35:27,099 --> 00:35:31,540
<font color="#E5E5E5">doing that so the first</font><font color="#CCCCCC"> step that we</font><font color="#E5E5E5"> can</font>

1081
00:35:29,710 --> 00:35:33,549
<font color="#CCCCCC">do we could</font><font color="#E5E5E5"> first force</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> a rogue</font><font color="#CCCCCC"> a</font>

1082
00:35:31,540 --> 00:35:34,900
<font color="#CCCCCC">P attack well actually assume</font><font color="#E5E5E5"> that we</font>

1083
00:35:33,549 --> 00:35:37,450
<font color="#CCCCCC">have</font><font color="#E5E5E5"> two network interfaces first of all</font>

1084
00:35:34,900 --> 00:35:38,559
our<font color="#E5E5E5"> first interface has an IP address on</font>

1085
00:35:37,450 --> 00:35:40,299
this<font color="#E5E5E5"> quarantine VLAN the second</font>

1086
00:35:38,559 --> 00:35:41,799
interface<font color="#E5E5E5"> is free to perform more</font>

1087
00:35:40,299 --> 00:35:44,380
attacks<font color="#E5E5E5"> so we're gonna use the second</font>

1088
00:35:41,799 --> 00:35:46,390
wireless interface<font color="#CCCCCC"> to force this victim</font>

1089
00:35:44,380 --> 00:35:47,799
device<font color="#E5E5E5"> over to our over to our own</font>

1090
00:35:46,390 --> 00:35:50,140
<font color="#E5E5E5">network can we control using a rogue ap</font>

1091
00:35:47,799 --> 00:35:51,280
attack at this<font color="#E5E5E5"> point the particular</font>

1092
00:35:50,140 --> 00:35:53,020
rogue ap attack we do is we'd use a

1093
00:35:51,280 --> 00:35:55,000
hostile portal attack and that<font color="#CCCCCC"> would</font>

1094
00:35:53,020 --> 00:35:57,790
<font color="#E5E5E5">allow us to redirect their HTTP traffic</font>

1095
00:35:55,000 --> 00:36:00,130
to an SMB share<font color="#E5E5E5"> that we control and that</font>

1096
00:35:57,790 --> 00:36:01,480
as<font color="#E5E5E5"> before we will demonstrate this this</font>

1097
00:36:00,130 --> 00:36:04,470
will allow<font color="#E5E5E5"> us to</font><font color="#CCCCCC"> obtain their ntlm</font>

1098
00:36:01,480 --> 00:36:06,700
hashes which<font color="#CCCCCC"> we can crack offline</font><font color="#E5E5E5"> right</font>

1099
00:36:04,470 --> 00:36:08,049
at this point we<font color="#E5E5E5"> continue</font><font color="#CCCCCC"> attack where</font>

1100
00:36:06,700 --> 00:36:09,098
we left<font color="#E5E5E5"> off we might have to repeat the</font>

1101
00:36:08,049 --> 00:36:10,660
step where we get<font color="#CCCCCC"> them to connect to us</font>

1102
00:36:09,099 --> 00:36:12,520
once we've cracked<font color="#E5E5E5"> their ntlm hashes and</font>

1103
00:36:10,660 --> 00:36:15,160
<font color="#E5E5E5">at this point</font><font color="#CCCCCC"> we're able</font><font color="#E5E5E5"> to use that</font>

1104
00:36:12,520 --> 00:36:16,420
<font color="#E5E5E5">that access to place a time payload like</font>

1105
00:36:15,160 --> 00:36:17,348
a<font color="#E5E5E5"> scheduled task or something</font><font color="#CCCCCC"> like that</font>

1106
00:36:16,420 --> 00:36:19,660
<font color="#E5E5E5">on the victim</font>

1107
00:36:17,349 --> 00:36:21,099
we then kill a rogue<font color="#E5E5E5"> ap this allows the</font>

1108
00:36:19,660 --> 00:36:22,420
<font color="#CCCCCC">victim to re associate with the wireless</font>

1109
00:36:21,099 --> 00:36:24,369
<font color="#E5E5E5">network that they were on previously</font>

1110
00:36:22,420 --> 00:36:25,839
now this victim despite the fact despite

1111
00:36:24,369 --> 00:36:28,839
the fact that we've we've exploited it

1112
00:36:25,839 --> 00:36:30,640
<font color="#CCCCCC">it is still an authorized device so the</font>

1113
00:36:28,839 --> 00:36:33,520
nack mechanism here<font color="#CCCCCC"> moves it to the</font>

1114
00:36:30,640 --> 00:36:35,740
<font color="#E5E5E5">restricted VLAN at this point we rate we</font>

1115
00:36:33,520 --> 00:36:38,079
wait for that that that<font color="#E5E5E5"> scheduled attack</font>

1116
00:36:35,740 --> 00:36:40,750
<font color="#CCCCCC">task to execute that gives us a reverse</font>

1117
00:36:38,079 --> 00:36:42,309
shell<font color="#E5E5E5"> to our interface</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> honor on</font>

1118
00:36:40,750 --> 00:36:44,530
<font color="#CCCCCC">the quarantine VLAN</font><font color="#E5E5E5"> and allows</font><font color="#CCCCCC"> us to</font>

1119
00:36:42,309 --> 00:36:47,559
pivot<font color="#E5E5E5"> on to the restorative VLAN through</font>

1120
00:36:44,530 --> 00:36:50,440
the the<font color="#E5E5E5"> authorized device so that's</font>

1121
00:36:47,559 --> 00:36:51,910
that's a simple indirect wireless

1122
00:36:50,440 --> 00:36:54,369
but there's a better person doing<font color="#E5E5E5"> this</font>

1123
00:36:51,910 --> 00:36:57,069
<font color="#E5E5E5">if you can pull it off so suppose</font><font color="#CCCCCC"> you</font>

1124
00:36:54,369 --> 00:36:59,890
<font color="#CCCCCC">have two victims of Isis</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> an account</font>

1125
00:36:57,069 --> 00:37:01,089
<font color="#E5E5E5">that can be used</font><font color="#CCCCCC"> to access</font><font color="#E5E5E5"> both you</font>

1126
00:36:59,890 --> 00:37:03,790
could<font color="#E5E5E5"> then force both of</font><font color="#CCCCCC"> these devices</font>

1127
00:37:01,089 --> 00:37:05,950
<font color="#CCCCCC">to associate</font><font color="#E5E5E5"> with you</font><font color="#CCCCCC"> and you know as</font>

1128
00:37:03,790 --> 00:37:07,960
before you use the hostile portal to get

1129
00:37:05,950 --> 00:37:09,520
them to send<font color="#CCCCCC"> you ntlm hashes at this</font>

1130
00:37:07,960 --> 00:37:10,869
point though instead<font color="#CCCCCC"> of simply capturing</font>

1131
00:37:09,520 --> 00:37:12,490
hashes we're going to relay<font color="#CCCCCC"> that</font>

1132
00:37:10,869 --> 00:37:14,290
authentication<font color="#CCCCCC"> attempt using SNP relay</font>

1133
00:37:12,490 --> 00:37:16,419
attack from one<font color="#CCCCCC"> victim to the other</font><font color="#E5E5E5"> this</font>

1134
00:37:14,290 --> 00:37:18,069
<font color="#E5E5E5">will allow you to instantaneously</font><font color="#CCCCCC"> place</font>

1135
00:37:16,420 --> 00:37:20,410
a time payload on on one of<font color="#E5E5E5"> the victims</font>

1136
00:37:18,069 --> 00:37:21,790
<font color="#CCCCCC">you let the the victims reassociate with</font>

1137
00:37:20,410 --> 00:37:22,930
the target<font color="#E5E5E5"> Network as before they're</font>

1138
00:37:21,790 --> 00:37:24,310
moved back to the<font color="#CCCCCC"> restrictive VLAN</font>

1139
00:37:22,930 --> 00:37:26,470
because they're still<font color="#CCCCCC"> authorized devices</font>

1140
00:37:24,310 --> 00:37:30,640
and as before<font color="#CCCCCC"> we wait</font><font color="#E5E5E5"> for the reverse</font>

1141
00:37:26,470 --> 00:37:33,578
shell so quick demo of<font color="#E5E5E5"> what this would</font>

1142
00:37:30,640 --> 00:37:36,420
<font color="#CCCCCC">look like</font><font color="#E5E5E5"> we have</font><font color="#CCCCCC"> two we</font><font color="#E5E5E5"> have Leroy and</font>

1143
00:37:33,579 --> 00:37:38,770
Jenkins our victim<font color="#E5E5E5"> devices here</font>

1144
00:37:36,420 --> 00:37:40,990
Leroy's in the<font color="#E5E5E5"> top right Jenkins</font><font color="#CCCCCC"> is in</font>

1145
00:37:38,770 --> 00:37:43,509
the is in<font color="#CCCCCC"> the top left here we have our</font>

1146
00:37:40,990 --> 00:37:47,200
<font color="#E5E5E5">attacker anybody</font><font color="#CCCCCC"> ever</font><font color="#E5E5E5"> use Empire you</font>

1147
00:37:43,510 --> 00:37:48,250
again so we<font color="#CCCCCC"> have we</font><font color="#E5E5E5"> have a Empire</font>

1148
00:37:47,200 --> 00:37:50,649
instance running here remember using

1149
00:37:48,250 --> 00:37:52,869
<font color="#E5E5E5">Empire</font><font color="#CCCCCC"> for to manage our payloads we're</font>

1150
00:37:50,650 --> 00:37:54,579
going to be<font color="#E5E5E5"> using impact it to do our</font>

1151
00:37:52,869 --> 00:37:56,369
SMB relay attack and we're going<font color="#E5E5E5"> to be</font>

1152
00:37:54,579 --> 00:37:59,710
<font color="#E5E5E5">using a pamorah to do our Rove</font><font color="#CCCCCC"> ap attack</font>

1153
00:37:56,369 --> 00:38:01,030
<font color="#CCCCCC">and over here we</font><font color="#E5E5E5"> have</font><font color="#CCCCCC"> our legitimate</font>

1154
00:37:59,710 --> 00:38:03,760
access<font color="#E5E5E5"> point</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> two the victim</font>

1155
00:38:01,030 --> 00:38:05,109
<font color="#CCCCCC">devices are connected to and I'm gonna</font>

1156
00:38:03,760 --> 00:38:07,720
come out fast for this<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> to</font>

1157
00:38:05,109 --> 00:38:10,630
listener<font color="#E5E5E5"> set up and we also have our SMB</font>

1158
00:38:07,720 --> 00:38:11,709
<font color="#CCCCCC">sort relay server</font><font color="#E5E5E5"> running there so we're</font>

1159
00:38:10,630 --> 00:38:13,359
gonna<font color="#E5E5E5"> start a recipe really it's really</font>

1160
00:38:11,710 --> 00:38:15,460
servers the first thing we're gonna do

1161
00:38:13,359 --> 00:38:17,920
<font color="#CCCCCC">is we're gonna</font><font color="#E5E5E5"> pass initial</font><font color="#CCCCCC"> powershell</font>

1162
00:38:15,460 --> 00:38:19,359
payload<font color="#CCCCCC"> to our SMB relay server</font><font color="#E5E5E5"> that's</font>

1163
00:38:17,920 --> 00:38:20,650
<font color="#E5E5E5">gonna execute when we first perform the</font>

1164
00:38:19,359 --> 00:38:23,529
SMB relay attack when they put when they

1165
00:38:20,650 --> 00:38:25,960
connect to us and then we're gonna<font color="#E5E5E5"> start</font>

1166
00:38:23,530 --> 00:38:28,000
<font color="#E5E5E5">a Pam or here and then you as before</font>

1167
00:38:25,960 --> 00:38:29,290
we're<font color="#E5E5E5"> gonna send some D off packets to</font>

1168
00:38:28,000 --> 00:38:31,750
these two devices<font color="#E5E5E5"> to get them to Rome</font>

1169
00:38:29,290 --> 00:38:33,880
from from the legitimate access<font color="#E5E5E5"> point</font>

1170
00:38:31,750 --> 00:38:37,690
<font color="#E5E5E5">over to our rogue access point</font><font color="#CCCCCC"> so we're</font>

1171
00:38:33,880 --> 00:38:42,080
gonna do<font color="#E5E5E5"> that really fast and it's kind</font>

1172
00:38:37,690 --> 00:38:46,670
of<font color="#E5E5E5"> lagging there but wait</font><font color="#CCCCCC"> for it</font>

1173
00:38:42,080 --> 00:38:50,480
there you go<font color="#E5E5E5"> okay so that gets us one</font>

1174
00:38:46,670 --> 00:38:51,800
device associated<font color="#CCCCCC"> with us all</font><font color="#E5E5E5"> right step</font>

1175
00:38:50,480 --> 00:38:56,300
<font color="#E5E5E5">two we want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> repeat that with</font><font color="#CCCCCC"> the</font>

1176
00:38:51,800 --> 00:38:57,650
second victim device<font color="#CCCCCC"> Leeroy all right</font>

1177
00:38:56,300 --> 00:39:00,620
now we have<font color="#CCCCCC"> Leroy's associated with us</font>

1178
00:38:57,650 --> 00:39:03,320
as<font color="#E5E5E5"> well at this point</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> need to pull</font>

1179
00:39:00,620 --> 00:39:07,730
off yes and<font color="#CCCCCC"> B relay attack</font><font color="#E5E5E5"> right so</font>

1180
00:39:03,320 --> 00:39:09,470
we're going to to first start<font color="#CCCCCC"> RS and B</font>

1181
00:39:07,730 --> 00:39:11,450
<font color="#E5E5E5">well actually we're first going to</font><font color="#CCCCCC"> need</font>

1182
00:39:09,470 --> 00:39:14,180
to obtain<font color="#E5E5E5"> the</font><font color="#CCCCCC"> IP address of one of</font><font color="#E5E5E5"> these</font>

1183
00:39:11,450 --> 00:39:17,240
devices<font color="#CCCCCC"> that's associated</font><font color="#E5E5E5"> us output that</font>

1184
00:39:14,180 --> 00:39:21,080
<font color="#E5E5E5">we see here copy it over to</font><font color="#CCCCCC"> our SMB</font>

1185
00:39:17,240 --> 00:39:23,120
relay server here and we're going<font color="#E5E5E5"> to</font>

1186
00:39:21,080 --> 00:39:25,640
paste it in there<font color="#E5E5E5"> start the SMB relay</font>

1187
00:39:23,120 --> 00:39:28,790
server now for demonstrative purposes

1188
00:39:25,640 --> 00:39:30,710
we're<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to start we're going to</font>

1189
00:39:28,790 --> 00:39:33,529
<font color="#E5E5E5">start</font><font color="#CCCCCC"> generating some HTTP traffic</font><font color="#E5E5E5"> on</font>

1190
00:39:30,710 --> 00:39:35,300
one<font color="#CCCCCC"> of these these target</font><font color="#E5E5E5"> endpoints so</font>

1191
00:39:33,530 --> 00:39:37,100
we do that here simply by just you know

1192
00:39:35,300 --> 00:39:38,150
typing stuff in the in the browser<font color="#E5E5E5"> like</font>

1193
00:39:37,100 --> 00:39:38,750
we saw<font color="#E5E5E5"> before and you see some activity</font>

1194
00:39:38,150 --> 00:39:40,910
<font color="#E5E5E5">there</font>

1195
00:39:38,750 --> 00:39:42,680
that's the SMB relay server doing its

1196
00:39:40,910 --> 00:39:43,879
thing<font color="#E5E5E5"> that performing SMB relay attack</font>

1197
00:39:42,680 --> 00:39:47,089
and what you should see<font color="#CCCCCC"> in about 40</font>

1198
00:39:43,880 --> 00:39:49,580
seconds<font color="#E5E5E5"> or so</font><font color="#CCCCCC"> in Empire is an</font><font color="#E5E5E5"> empire</font>

1199
00:39:47,090 --> 00:39:51,110
<font color="#E5E5E5">agent connecting back to our Empire</font>

1200
00:39:49,580 --> 00:39:53,690
instance and that<font color="#E5E5E5"> will give us our</font>

1201
00:39:51,110 --> 00:39:57,830
<font color="#CCCCCC">initial shell</font><font color="#E5E5E5"> and there you go initial</font>

1202
00:39:53,690 --> 00:40:00,890
<font color="#E5E5E5">agent from 10.0.0.0 now active</font><font color="#CCCCCC"> we now</font>

1203
00:39:57,830 --> 00:40:04,279
interact<font color="#CCCCCC"> with that agent and at this</font>

1204
00:40:00,890 --> 00:40:09,710
point<font color="#E5E5E5"> we have if you look here I'm going</font>

1205
00:40:04,280 --> 00:40:11,750
<font color="#E5E5E5">to</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> fast forward a</font><font color="#CCCCCC"> bit as you</font>

1206
00:40:09,710 --> 00:40:13,970
<font color="#CCCCCC">can</font><font color="#E5E5E5"> see here we now have NCI</font><font color="#CCCCCC"> authority</font>

1207
00:40:11,750 --> 00:40:15,620
<font color="#CCCCCC">system privileges on Jenkins</font><font color="#E5E5E5"> which is</font>

1208
00:40:13,970 --> 00:40:17,000
this this victim right here so at<font color="#E5E5E5"> this</font>

1209
00:40:15,620 --> 00:40:18,259
point<font color="#E5E5E5"> both</font><font color="#CCCCCC"> of these</font><font color="#E5E5E5"> devices are still</font>

1210
00:40:17,000 --> 00:40:20,420
associate with a rogue access point

1211
00:40:18,260 --> 00:40:21,830
attack<font color="#E5E5E5"> but we've used an SMB</font><font color="#CCCCCC"> relay</font>

1212
00:40:20,420 --> 00:40:25,520
attacked to obtain a shell on<font color="#CCCCCC"> this guy</font>

1213
00:40:21,830 --> 00:40:28,340
<font color="#CCCCCC">right here</font><font color="#E5E5E5"> on Jenkins so we're gonna use</font>

1214
00:40:25,520 --> 00:40:32,720
<font color="#CCCCCC">that initial shell to place a</font><font color="#E5E5E5"> scheduled</font>

1215
00:40:28,340 --> 00:40:34,970
<font color="#CCCCCC">task on</font><font color="#E5E5E5"> Jenkins that</font><font color="#CCCCCC"> is going to connect</font>

1216
00:40:32,720 --> 00:40:36,049
<font color="#E5E5E5">back</font><font color="#CCCCCC"> to our first interface</font><font color="#E5E5E5"> which is</font>

1217
00:40:34,970 --> 00:40:38,750
currently associate<font color="#E5E5E5"> with a target</font>

1218
00:40:36,050 --> 00:40:40,160
<font color="#CCCCCC">network and it's going to do that</font><font color="#E5E5E5"> after</font>

1219
00:40:38,750 --> 00:40:43,700
you<font color="#CCCCCC"> know like a set period</font><font color="#E5E5E5"> of a few</font>

1220
00:40:40,160 --> 00:40:46,339
<font color="#CCCCCC">minutes so we're gonna do</font><font color="#E5E5E5"> that really</font>

1221
00:40:43,700 --> 00:40:48,370
<font color="#E5E5E5">fast I'm gonna kind of speed through</font>

1222
00:40:46,340 --> 00:40:48,370
that

1223
00:40:50,440 --> 00:40:55,760
and at that point now we<font color="#E5E5E5"> we</font><font color="#CCCCCC"> just we just</font>

1224
00:40:53,060 --> 00:40:57,619
kill our rogue<font color="#E5E5E5"> ap and you'll notice here</font>

1225
00:40:55,760 --> 00:40:59,330
that in our and<font color="#E5E5E5"> our legitimate AP that</font>

1226
00:40:57,619 --> 00:41:01,490
<font color="#E5E5E5">the the victim</font><font color="#CCCCCC"> devices</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> reso</font><font color="#E5E5E5"> sheeting</font>

1227
00:40:59,330 --> 00:41:03,590
with us<font color="#CCCCCC"> so we've lost our initial shell</font>

1228
00:41:01,490 --> 00:41:04,700
but and and and when<font color="#E5E5E5"> these</font><font color="#CCCCCC"> devices are</font>

1229
00:41:03,590 --> 00:41:06,020
no longer<font color="#E5E5E5"> directly connected to us</font>

1230
00:41:04,700 --> 00:41:07,790
they're back<font color="#CCCCCC"> on the target network and</font>

1231
00:41:06,020 --> 00:41:09,920
now we just<font color="#E5E5E5"> wait for the scheduled</font><font color="#CCCCCC"> tasks</font>

1232
00:41:07,790 --> 00:41:11,509
to<font color="#CCCCCC"> execute the payload</font><font color="#E5E5E5"> and connect back</font>

1233
00:41:09,920 --> 00:41:13,550
to<font color="#E5E5E5"> us so something really interesting</font>

1234
00:41:11,510 --> 00:41:15,560
happened<font color="#E5E5E5"> when I was</font><font color="#CCCCCC"> actually recording</font>

1235
00:41:13,550 --> 00:41:17,570
this demo<font color="#E5E5E5"> video</font><font color="#CCCCCC"> and in that I actually</font>

1236
00:41:15,560 --> 00:41:19,759
you know forgot to do the thing in in in

1237
00:41:17,570 --> 00:41:22,760
<font color="#CCCCCC">VMware</font><font color="#E5E5E5"> or you connect the virtual</font>

1238
00:41:19,760 --> 00:41:25,670
<font color="#E5E5E5">network interface to your to your to</font>

1239
00:41:22,760 --> 00:41:26,840
<font color="#CCCCCC">your box to the attacker machine so you</font>

1240
00:41:25,670 --> 00:41:28,670
know initially<font color="#E5E5E5"> what happen is that the</font>

1241
00:41:26,840 --> 00:41:32,210
the<font color="#CCCCCC"> the</font><font color="#E5E5E5"> time payload or</font><font color="#CCCCCC"> the amount of</font>

1242
00:41:28,670 --> 00:41:34,790
<font color="#E5E5E5">that delay finished</font><font color="#CCCCCC"> and I was like okay</font>

1243
00:41:32,210 --> 00:41:35,960
so where's the you know<font color="#E5E5E5"> where's the</font>

1244
00:41:34,790 --> 00:41:37,670
<font color="#E5E5E5">shell I don't know what's going on here</font>

1245
00:41:35,960 --> 00:41:39,800
<font color="#CCCCCC">and then I realized</font><font color="#E5E5E5"> that I'd forgotten</font>

1246
00:41:37,670 --> 00:41:41,990
<font color="#E5E5E5">to to connect a thing so I was</font>

1247
00:41:39,800 --> 00:41:43,040
originally<font color="#CCCCCC"> going to to refilm</font><font color="#E5E5E5"> this and</font>

1248
00:41:41,990 --> 00:41:44,089
restart<font color="#E5E5E5"> the demo from scratch but</font>

1249
00:41:43,040 --> 00:41:45,710
something<font color="#E5E5E5"> really interesting happened</font>

1250
00:41:44,090 --> 00:41:49,490
which<font color="#CCCCCC"> is</font><font color="#E5E5E5"> that you know it turns out I'd</font>

1251
00:41:45,710 --> 00:41:50,770
actually<font color="#CCCCCC"> set</font><font color="#E5E5E5"> 120 retries on this agent</font>

1252
00:41:49,490 --> 00:41:53,629
that to connect back<font color="#E5E5E5"> so this</font><font color="#CCCCCC"> thing would</font>

1253
00:41:50,770 --> 00:41:57,590
120 times attempt to keep connecting

1254
00:41:53,630 --> 00:41:59,810
back to<font color="#CCCCCC"> that listener so what ended up</font>

1255
00:41:57,590 --> 00:42:03,980
happening was<font color="#CCCCCC"> and if you can</font><font color="#E5E5E5"> kind of see</font>

1256
00:41:59,810 --> 00:42:07,850
here I'm gonna<font color="#E5E5E5"> get to the</font><font color="#CCCCCC"> point where I</font>

1257
00:42:03,980 --> 00:42:10,160
reconnect it and you see here I<font color="#E5E5E5"> hit the</font>

1258
00:42:07,850 --> 00:42:11,509
<font color="#E5E5E5">back button</font><font color="#CCCCCC"> oh yeah</font><font color="#E5E5E5"> as soon</font><font color="#CCCCCC"> as I did</font>

1259
00:42:10,160 --> 00:42:12,649
that<font color="#E5E5E5"> I</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> got the connection anyways</font>

1260
00:42:11,510 --> 00:42:13,670
<font color="#E5E5E5">so I thought I'd leave</font><font color="#CCCCCC"> that in</font><font color="#E5E5E5"> there</font>

1261
00:42:12,650 --> 00:42:15,170
<font color="#E5E5E5">because it was kind of cool and it kind</font>

1262
00:42:13,670 --> 00:42:17,900
of you<font color="#CCCCCC"> know at</font><font color="#E5E5E5"> this point we</font><font color="#CCCCCC"> actually</font>

1263
00:42:15,170 --> 00:42:19,670
have as soon as I<font color="#CCCCCC"> reconnect to</font><font color="#E5E5E5"> the USB</font>

1264
00:42:17,900 --> 00:42:21,440
interface<font color="#E5E5E5"> you know within seconds I had</font>

1265
00:42:19,670 --> 00:42:22,609
that that refers connection I thought

1266
00:42:21,440 --> 00:42:25,160
I'd leave<font color="#CCCCCC"> that in</font><font color="#E5E5E5"> there cuz it's kind of</font>

1267
00:42:22,609 --> 00:42:26,930
cool and proves<font color="#E5E5E5"> a point about you know</font>

1268
00:42:25,160 --> 00:42:28,609
<font color="#CCCCCC">well-written</font><font color="#E5E5E5"> malware and well-written</font>

1269
00:42:26,930 --> 00:42:29,960
implants which is that you know<font color="#CCCCCC"> even</font><font color="#E5E5E5"> if</font>

1270
00:42:28,609 --> 00:42:32,180
<font color="#E5E5E5">you can</font><font color="#CCCCCC"> enter a</font><font color="#E5E5E5"> situation where you</font>

1271
00:42:29,960 --> 00:42:33,980
can't get a reverse connection

1272
00:42:32,180 --> 00:42:36,470
immediately<font color="#CCCCCC"> you know you can still</font><font color="#E5E5E5"> write</font>

1273
00:42:33,980 --> 00:42:39,530
something that<font color="#E5E5E5"> just keeps attempting to</font>

1274
00:42:36,470 --> 00:42:42,649
in various ways<font color="#E5E5E5"> until it finally</font>

1275
00:42:39,530 --> 00:42:44,030
connects back<font color="#CCCCCC"> to you so</font><font color="#E5E5E5"> that's an</font>

1276
00:42:42,650 --> 00:42:45,140
indirect<font color="#CCCCCC"> wireless pivot</font><font color="#E5E5E5"> I mean the</font>

1277
00:42:44,030 --> 00:42:46,790
equivalent technique of<font color="#E5E5E5"> doing this on a</font>

1278
00:42:45,140 --> 00:42:48,350
wired<font color="#E5E5E5"> network would</font><font color="#CCCCCC"> be simply unplugging</font>

1279
00:42:46,790 --> 00:42:49,730
<font color="#CCCCCC">an authorized device from from a switch</font>

1280
00:42:48,350 --> 00:42:51,470
or<font color="#CCCCCC"> something like</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> and then</font>

1281
00:42:49,730 --> 00:42:52,820
connecting it<font color="#CCCCCC"> unto a</font><font color="#E5E5E5"> connecting it to a</font>

1282
00:42:51,470 --> 00:42:55,129
hostile<font color="#E5E5E5"> network on which</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can attack</font>

1283
00:42:52,820 --> 00:42:56,150
it<font color="#CCCCCC"> and and</font><font color="#E5E5E5"> and what this void</font><font color="#CCCCCC"> Emin</font>

1284
00:42:55,130 --> 00:42:57,950
<font color="#CCCCCC">straits</font><font color="#E5E5E5"> is that port based access</font>

1285
00:42:56,150 --> 00:42:59,180
<font color="#E5E5E5">controls you know that they rely on the</font>

1286
00:42:57,950 --> 00:43:01,069
<font color="#E5E5E5">assumption that the physical layer can</font>

1287
00:42:59,180 --> 00:43:01,960
<font color="#E5E5E5">be</font><font color="#CCCCCC"> trusted</font><font color="#E5E5E5"> in a wireless network</font><font color="#CCCCCC"> on the</font>

1288
00:43:01,070 --> 00:43:03,790
other<font color="#E5E5E5"> hand</font>

1289
00:43:01,960 --> 00:43:06,040
the means through which you<font color="#E5E5E5"> can trust</font>

1290
00:43:03,790 --> 00:43:08,650
the<font color="#E5E5E5"> integrity the physical layer is wpa2</font>

1291
00:43:06,040 --> 00:43:11,349
EAP so if you can't trust<font color="#E5E5E5"> your EAP</font>

1292
00:43:08,650 --> 00:43:13,510
implementation<font color="#CCCCCC"> an attacker can freely</font>

1293
00:43:11,349 --> 00:43:14,950
<font color="#E5E5E5">control</font><font color="#CCCCCC"> the physical layer using rogue</font>

1294
00:43:13,510 --> 00:43:16,810
access point attacks this kind<font color="#E5E5E5"> of you</font>

1295
00:43:14,950 --> 00:43:19,359
<font color="#E5E5E5">know makes the point of whether nak</font>

1296
00:43:16,810 --> 00:43:20,619
<font color="#E5E5E5">works or not kind of moot because</font><font color="#CCCCCC"> you</font>

1297
00:43:19,359 --> 00:43:22,869
know if the attacker can control the

1298
00:43:20,619 --> 00:43:26,109
<font color="#CCCCCC">physical layer port based nak mechanisms</font>

1299
00:43:22,869 --> 00:43:27,430
are actually rendered useless<font color="#E5E5E5"> so what</font>

1300
00:43:26,109 --> 00:43:29,170
this demonstrates<font color="#CCCCCC"> is that port basin act</font>

1301
00:43:27,430 --> 00:43:31,359
mechanisms they don't effectively

1302
00:43:29,170 --> 00:43:33,570
mitigate the risk<font color="#E5E5E5"> presented by weak WPA</font>

1303
00:43:31,359 --> 00:43:35,770
<font color="#E5E5E5">to implement EAP implementations and</font>

1304
00:43:33,570 --> 00:43:37,440
also they demonstrate the<font color="#CCCCCC"> ADI port</font><font color="#E5E5E5"> based</font>

1305
00:43:35,770 --> 00:43:40,270
and act mechanisms to a<font color="#E5E5E5"> wireless network</font>

1306
00:43:37,440 --> 00:43:42,340
it does not make<font color="#E5E5E5"> the use</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the apt TLS</font>

1307
00:43:40,270 --> 00:43:43,930
or<font color="#E5E5E5"> a PP any</font><font color="#CCCCCC"> listen to any less</font>

1308
00:43:42,340 --> 00:43:45,190
inappropriate if the<font color="#E5E5E5"> networking</font>

1309
00:43:43,930 --> 00:43:48,819
questions<font color="#CCCCCC"> use</font><font color="#E5E5E5"> to grant access to</font>

1310
00:43:45,190 --> 00:43:49,930
sensitive information<font color="#E5E5E5"> I'm gonna you know</font>

1311
00:43:48,820 --> 00:43:52,210
before we kind<font color="#E5E5E5"> of wrap</font><font color="#CCCCCC"> this up I'm gonna</font>

1312
00:43:49,930 --> 00:43:55,720
make<font color="#E5E5E5"> like one last stitch kind of like</font>

1313
00:43:52,210 --> 00:43:57,130
you know plug for EAP<font color="#E5E5E5"> TLS which is that</font>

1314
00:43:55,720 --> 00:43:58,899
it's it's actually<font color="#CCCCCC"> not as bad</font><font color="#E5E5E5"> as it used</font>

1315
00:43:57,130 --> 00:44:00,700
<font color="#CCCCCC">to be</font><font color="#E5E5E5"> I mean you can use group policy</font><font color="#CCCCCC"> to</font>

1316
00:43:58,900 --> 00:44:02,800
configure 802 dot<font color="#E5E5E5"> 1 X on clients that</font>

1317
00:44:00,700 --> 00:44:04,180
<font color="#CCCCCC">MIT that makes this a lot easier than it</font>

1318
00:44:02,800 --> 00:44:06,790
<font color="#CCCCCC">used to be and your best option for</font>

1319
00:44:04,180 --> 00:44:08,440
rolling out EAP TLS<font color="#CCCCCC"> let's just use a</font>

1320
00:44:06,790 --> 00:44:10,930
private<font color="#E5E5E5"> CA and to leverage</font><font color="#CCCCCC"> Active</font>

1321
00:44:08,440 --> 00:44:13,089
<font color="#E5E5E5">Directory as much as possible</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> to</font>

1322
00:44:10,930 --> 00:44:15,129
deploy EAP TLS<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you're if you're</font>

1323
00:44:13,089 --> 00:44:17,049
<font color="#CCCCCC">dealing with an MDM or I'm sorry if</font>

1324
00:44:15,130 --> 00:44:19,359
you're<font color="#CCCCCC"> dealing with a bring your own</font>

1325
00:44:17,050 --> 00:44:20,830
<font color="#CCCCCC">device situation I mean you can just you</font>

1326
00:44:19,359 --> 00:44:23,380
distribute that<font color="#E5E5E5"> server server to clients</font>

1327
00:44:20,830 --> 00:44:26,440
<font color="#E5E5E5">using either an MDM solution or a really</font>

1328
00:44:23,380 --> 00:44:27,580
streamlined BYOD onboarding solution<font color="#E5E5E5"> and</font>

1329
00:44:26,440 --> 00:44:28,690
you can<font color="#CCCCCC"> actually use let's encrypt for</font>

1330
00:44:27,580 --> 00:44:29,680
that as well although<font color="#E5E5E5"> it's worth</font>

1331
00:44:28,690 --> 00:44:31,480
mentioning<font color="#E5E5E5"> that even the folks that</font>

1332
00:44:29,680 --> 00:44:34,720
let's encrypt<font color="#E5E5E5"> have stated this as far</font>

1333
00:44:31,480 --> 00:44:37,119
from<font color="#E5E5E5"> the best option</font><font color="#CCCCCC"> out there so just</font>

1334
00:44:34,720 --> 00:44:38,649
<font color="#CCCCCC">to close this</font><font color="#E5E5E5"> up just because wireless</font>

1335
00:44:37,119 --> 00:44:39,790
and wired networks do not<font color="#E5E5E5"> operate just</font>

1336
00:44:38,650 --> 00:44:41,890
because they operate similarly<font color="#E5E5E5"> at the</font>

1337
00:44:39,790 --> 00:44:43,540
logical level<font color="#CCCCCC"> and and that's you</font><font color="#E5E5E5"> know it</font>

1338
00:44:41,890 --> 00:44:44,348
on<font color="#E5E5E5"> purpose right you know you don't want</font>

1339
00:44:43,540 --> 00:44:45,940
<font color="#E5E5E5">to have to be able to observe the</font>

1340
00:44:44,349 --> 00:44:47,109
differences between<font color="#E5E5E5"> using Ethernet or</font><font color="#CCCCCC"> a</font>

1341
00:44:45,940 --> 00:44:49,210
<font color="#E5E5E5">wireless network when</font><font color="#CCCCCC"> you're using</font><font color="#E5E5E5"> the</font>

1342
00:44:47,109 --> 00:44:50,980
network<font color="#E5E5E5"> because that's kind of why we</font>

1343
00:44:49,210 --> 00:44:52,420
have<font color="#CCCCCC"> that</font><font color="#E5E5E5"> layer of</font><font color="#CCCCCC"> abstraction but</font><font color="#E5E5E5"> just</font>

1344
00:44:50,980 --> 00:44:53,770
because<font color="#CCCCCC"> these</font><font color="#E5E5E5"> things worked some early</font>

1345
00:44:52,420 --> 00:44:55,740
at the logic level<font color="#CCCCCC"> does not mean they</font>

1346
00:44:53,770 --> 00:44:57,580
work the same<font color="#CCCCCC"> way</font><font color="#E5E5E5"> at the physical level</font>

1347
00:44:55,740 --> 00:44:59,589
<font color="#CCCCCC">so as a</font><font color="#E5E5E5"> community we should really</font>

1348
00:44:57,580 --> 00:45:01,779
question whether it's truly a sound

1349
00:44:59,589 --> 00:45:03,849
business decision<font color="#E5E5E5"> to neglect EAP TLS</font><font color="#CCCCCC"> in</font>

1350
00:45:01,780 --> 00:45:05,290
favor<font color="#E5E5E5"> more reactive approach that</font>

1351
00:45:03,849 --> 00:45:07,690
focuses<font color="#CCCCCC"> on access control and threat</font>

1352
00:45:05,290 --> 00:45:09,550
containment<font color="#E5E5E5"> and finally last but not</font><font color="#CCCCCC"> not</font>

1353
00:45:07,690 --> 00:45:10,839
least most importantly actually<font color="#E5E5E5"> the</font>

1354
00:45:09,550 --> 00:45:12,369
needs<font color="#E5E5E5"> for convenience and security</font><font color="#CCCCCC"> are</font>

1355
00:45:10,839 --> 00:45:13,690
often at odds with<font color="#CCCCCC"> one another</font><font color="#E5E5E5"> so</font>

1356
00:45:12,369 --> 00:45:15,290
maintain a healthy skepticism<font color="#CCCCCC"> towards</font>

1357
00:45:13,690 --> 00:45:19,330
<font color="#E5E5E5">solutions that prom</font>

1358
00:45:15,290 --> 00:45:19,330
both and that's<font color="#E5E5E5"> it</font><font color="#CCCCCC"> Thanks</font>

1359
00:45:24,280 --> 00:45:40,480
any questions sure<font color="#CCCCCC"> yeah yeah well</font>

1360
00:45:37,900 --> 00:45:42,580
<font color="#E5E5E5">hostapd does actually</font><font color="#CCCCCC"> which is the</font>

1361
00:45:40,480 --> 00:45:44,440
radius<font color="#CCCCCC"> server that</font><font color="#E5E5E5"> you'd use to perform</font>

1362
00:45:42,580 --> 00:45:46,060
<font color="#E5E5E5">the</font><font color="#CCCCCC"> attack as for an individual radius</font>

1363
00:45:44,440 --> 00:45:48,010
implementations they may<font color="#CCCCCC"> not work that</font>

1364
00:45:46,060 --> 00:46:03,730
way but<font color="#E5E5E5"> I know hostapd</font><font color="#CCCCCC"> uses</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> EPS or</font>

1365
00:45:48,010 --> 00:46:06,520
file yeah<font color="#CCCCCC"> so yeah you'd</font><font color="#E5E5E5"> get you'd get a</font>

1366
00:46:03,730 --> 00:46:10,270
prompt the user would get<font color="#E5E5E5"> a prompt so</font>

1367
00:46:06,520 --> 00:46:11,259
yeah well that's that's what you're

1368
00:46:10,270 --> 00:46:13,750
banking<font color="#E5E5E5"> on the problem is that you're</font>

1369
00:46:11,260 --> 00:46:16,180
placing<font color="#E5E5E5"> you're placing the burden on to</font>

1370
00:46:13,750 --> 00:46:18,190
the user to reject that<font color="#E5E5E5"> that prompt and</font>

1371
00:46:16,180 --> 00:46:20,290
you know with an organization of like

1372
00:46:18,190 --> 00:46:20,710
200 to 300<font color="#CCCCCC"> people I mean I don't know</font>

1373
00:46:20,290 --> 00:46:22,810
man

1374
00:46:20,710 --> 00:46:26,080
think about your<font color="#E5E5E5"> workplace do you trust</font>

1375
00:46:22,810 --> 00:46:28,230
everyone<font color="#E5E5E5"> not to click that prompt what's</font>

1376
00:46:26,080 --> 00:46:28,230
up

1377
00:46:31,670 --> 00:47:00,630
true but<font color="#E5E5E5"> that that rules out BYOD as</font>

1378
00:46:37,440 --> 00:47:02,510
well what's up you would need that's<font color="#E5E5E5"> a</font>

1379
00:47:00,630 --> 00:47:05,039
good question

1380
00:47:02,510 --> 00:47:06,779
so effort for that particular attack you

1381
00:47:05,039 --> 00:47:09,299
would need the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> necessary privileges</font>

1382
00:47:06,779 --> 00:47:11,039
to one be<font color="#E5E5E5"> able to access</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> device in</font>

1383
00:47:09,299 --> 00:47:13,579
the<font color="#CCCCCC"> first place you'd also have to</font><font color="#E5E5E5"> have</font>

1384
00:47:11,039 --> 00:47:17,970
at<font color="#CCCCCC"> least like local admin</font><font color="#E5E5E5"> on that device</font>

1385
00:47:13,579 --> 00:47:18,930
<font color="#CCCCCC">because</font><font color="#E5E5E5"> you'd need to be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to do</font>

1386
00:47:17,970 --> 00:47:20,279
something<font color="#E5E5E5"> like</font><font color="#CCCCCC"> you know create a</font>

1387
00:47:18,930 --> 00:47:21,480
<font color="#CCCCCC">schedule tasks to</font><font color="#E5E5E5"> make that then connect</font>

1388
00:47:20,279 --> 00:47:22,829
back to<font color="#CCCCCC"> you in the</font><font color="#E5E5E5"> first</font><font color="#CCCCCC"> place so you</font>

1389
00:47:21,480 --> 00:47:24,089
would need you know some level

1390
00:47:22,829 --> 00:47:26,930
administrative access in<font color="#E5E5E5"> order to make</font>

1391
00:47:24,089 --> 00:47:26,930
that<font color="#E5E5E5"> work</font><font color="#CCCCCC"> if you're</font>

1392
00:47:36,040 --> 00:47:41,390
you could probably automate that using

1393
00:47:38,390 --> 00:47:44,379
the<font color="#E5E5E5"> Empire API</font><font color="#CCCCCC"> I have not done</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> but</font>

1394
00:47:41,390 --> 00:47:44,379
it<font color="#E5E5E5"> can be done</font>

1395
00:47:45,040 --> 00:47:49,790
realistically<font color="#E5E5E5"> though I mean you'd want</font>

1396
00:47:48,140 --> 00:47:51,020
<font color="#E5E5E5">to automate it as fast as</font><font color="#CCCCCC"> possible so I</font>

1397
00:47:49,790 --> 00:47:53,630
mean<font color="#E5E5E5"> that that's doing it like over</font><font color="#CCCCCC"> like</font>

1398
00:47:51,020 --> 00:47:55,130
a few<font color="#E5E5E5"> minutes which</font><font color="#CCCCCC"> is decent but of</font>

1399
00:47:53,630 --> 00:47:56,300
<font color="#E5E5E5">course there's room</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> like taking it</font>

1400
00:47:55,130 --> 00:47:57,560
beyond a proof of concept stage and

1401
00:47:56,300 --> 00:47:59,390
<font color="#E5E5E5">actually making it happen lightning fast</font>

1402
00:47:57,560 --> 00:48:01,580
<font color="#E5E5E5">just ideally what you'd</font><font color="#CCCCCC"> want something</font>

1403
00:47:59,390 --> 00:48:02,930
<font color="#CCCCCC">else that's</font><font color="#E5E5E5"> worth mentioning though</font><font color="#CCCCCC"> you</font>

1404
00:48:01,580 --> 00:48:04,279
know how we<font color="#E5E5E5"> used</font><font color="#CCCCCC"> to schedule</font><font color="#E5E5E5"> tasks in</font>

1405
00:48:02,930 --> 00:48:07,009
<font color="#CCCCCC">order</font><font color="#E5E5E5"> to get the reverse shell</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> to</font>

1406
00:48:04,280 --> 00:48:08,300
execute well that might not<font color="#CCCCCC"> always be</font>

1407
00:48:07,010 --> 00:48:09,500
<font color="#E5E5E5">the best way to do it</font><font color="#CCCCCC"> because if you're</font>

1408
00:48:08,300 --> 00:48:10,280
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> about like a</font><font color="#E5E5E5"> realistic</font><font color="#CCCCCC"> scenario</font>

1409
00:48:09,500 --> 00:48:12,530
you'd want<font color="#E5E5E5"> something that doesn't</font>

1410
00:48:10,280 --> 00:48:13,010
necessarily touch disk<font color="#E5E5E5"> so a better way</font>

1411
00:48:12,530 --> 00:48:14,120
<font color="#CCCCCC">to do it</font>

1412
00:48:13,010 --> 00:48:14,960
do this<font color="#E5E5E5"> would</font><font color="#CCCCCC"> actually be to have</font>

1413
00:48:14,120 --> 00:48:16,910
something that<font color="#E5E5E5"> lives completely in</font>

1414
00:48:14,960 --> 00:48:18,920
memory and is maybe it's more

1415
00:48:16,910 --> 00:48:22,009
event-driven<font color="#E5E5E5"> so it listens for like a</font>

1416
00:48:18,920 --> 00:48:23,570
<font color="#E5E5E5">network change so it just is someone</font>

1417
00:48:22,010 --> 00:48:25,610
logging or<font color="#E5E5E5"> am i back on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> network and</font>

1418
00:48:23,570 --> 00:48:27,560
<font color="#E5E5E5">then it would shoot the the reverse</font>

1419
00:48:25,610 --> 00:48:28,700
shell<font color="#E5E5E5"> which doesn't have to be reversed</font>

1420
00:48:27,560 --> 00:48:29,840
<font color="#E5E5E5">shell back to the first interface I mean</font>

1421
00:48:28,700 --> 00:48:31,669
you could<font color="#CCCCCC"> actually just do an outbound</font>

1422
00:48:29,840 --> 00:48:33,740
connection<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> something else you could</font>

1423
00:48:31,670 --> 00:48:35,240
<font color="#CCCCCC">just have it</font><font color="#E5E5E5"> autonomously start doing</font>

1424
00:48:33,740 --> 00:48:37,459
enough situational awareness move see

1425
00:48:35,240 --> 00:48:38,930
I'm<font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to figure</font><font color="#CCCCCC"> out there a lot</font><font color="#E5E5E5"> of</font>

1426
00:48:37,460 --> 00:48:40,040
<font color="#E5E5E5">different ways of doing it but</font><font color="#CCCCCC"> that's</font>

1427
00:48:38,930 --> 00:48:41,660
<font color="#CCCCCC">just like an easy</font><font color="#E5E5E5"> straightforward way to</font>

1428
00:48:40,040 --> 00:48:46,180
just kind<font color="#CCCCCC"> of explain it so that's kind</font>

1429
00:48:41,660 --> 00:48:46,180
of why did<font color="#CCCCCC"> it that way anything else</font>

1430
00:48:46,630 --> 00:48:49,630
sure

1431
00:48:55,000 --> 00:48:58,730
if you have if you<font color="#CCCCCC"> have certificates</font><font color="#E5E5E5"> on</font>

1432
00:48:56,990 --> 00:49:01,160
both ends<font color="#E5E5E5"> that that mitigates this issue</font>

1433
00:48:58,730 --> 00:49:04,190
that's the<font color="#CCCCCC"> aptl s so that that's how</font><font color="#E5E5E5"> you</font>

1434
00:49:01,160 --> 00:49:06,410
the problem is that like people you know

1435
00:49:04,190 --> 00:49:08,180
<font color="#CCCCCC">organizations they they often tend to</font>

1436
00:49:06,410 --> 00:49:10,549
balk at the idea of<font color="#E5E5E5"> rolling</font><font color="#CCCCCC"> outside like</font>

1437
00:49:08,180 --> 00:49:12,620
that<font color="#E5E5E5"> unfortunately</font><font color="#CCCCCC"> but yeah that's</font>

1438
00:49:10,550 --> 00:49:19,160
that's<font color="#E5E5E5"> I think what I'm trying</font><font color="#CCCCCC"> to push</font>

1439
00:49:12,620 --> 00:49:22,910
for is<font color="#E5E5E5"> using that more I've seen it</font>

1440
00:49:19,160 --> 00:49:26,089
<font color="#E5E5E5">twice this past year</font><font color="#CCCCCC"> which is not</font><font color="#E5E5E5"> great</font>

1441
00:49:22,910 --> 00:49:27,620
<font color="#CCCCCC">but actually the first</font><font color="#E5E5E5"> time I saw it I</font>

1442
00:49:26,090 --> 00:49:29,090
was this here I was thrilled actually

1443
00:49:27,620 --> 00:49:30,290
<font color="#E5E5E5">went up and shook the guy's hand because</font>

1444
00:49:29,090 --> 00:49:32,170
I was like it's<font color="#CCCCCC"> like someone's actually</font>

1445
00:49:30,290 --> 00:49:35,029
doing this<font color="#E5E5E5"> Wow</font>

1446
00:49:32,170 --> 00:49:36,080
but then again remember I work primarily

1447
00:49:35,030 --> 00:49:39,140
with clients<font color="#CCCCCC"> like in the finance sector</font>

1448
00:49:36,080 --> 00:49:40,759
<font color="#E5E5E5">like in the North East corridor area so</font>

1449
00:49:39,140 --> 00:49:42,230
it<font color="#E5E5E5"> this may be different</font><font color="#CCCCCC"> for like if</font>

1450
00:49:40,760 --> 00:49:45,290
you're working like<font color="#E5E5E5"> in medical or DoD</font>

1451
00:49:42,230 --> 00:49:47,120
you<font color="#E5E5E5"> might seem different statistics so</font>

1452
00:49:45,290 --> 00:49:52,060
yeah that's just<font color="#E5E5E5"> my own</font><font color="#CCCCCC"> personal</font>

1453
00:49:47,120 --> 00:49:52,060
experiences with<font color="#CCCCCC"> that anyone</font><font color="#E5E5E5"> else</font>

1454
00:49:53,030 --> 00:49:58,600
<font color="#E5E5E5">No all right well thank you</font>

