1
00:00:00,000 --> 00:00:06,720
the b-sides DC 2016 videos are brought

2
00:00:03,240 --> 00:00:10,129
to you by clear jobs net and cyber sex

3
00:00:06,720 --> 00:00:12,899
calm tools for your next career move and

4
00:00:10,130 --> 00:00:15,330
Antietam technologies focusing on

5
00:00:12,900 --> 00:00:17,310
advanced cyber detection analysis and

6
00:00:15,330 --> 00:00:19,350
mitigation we're going<font color="#E5E5E5"> to give you a</font>

7
00:00:17,310 --> 00:00:21,810
<font color="#E5E5E5">little talk</font><font color="#CCCCCC"> about some some basic yarra</font>

8
00:00:19,350 --> 00:00:25,619
this is the<font color="#CCCCCC"> I</font><font color="#E5E5E5"> yah talk yet another Yara</font>

9
00:00:21,810 --> 00:00:29,070
allocution and my name is John<font color="#CCCCCC"> lacock my</font>

10
00:00:25,619 --> 00:00:32,940
co-presenter is Monty st. John and go

11
00:00:29,070 --> 00:00:34,380
<font color="#E5E5E5">ahead</font><font color="#CCCCCC"> and flick it over here so this is</font>

12
00:00:32,940 --> 00:00:37,379
<font color="#E5E5E5">my background I've been doing computer</font>

13
00:00:34,380 --> 00:00:38,910
forensics for a better part of a decade

14
00:00:37,380 --> 00:00:42,480
now previous to that I did video

15
00:00:38,910 --> 00:00:45,120
<font color="#E5E5E5">forensics I've work commercial private</font>

16
00:00:42,480 --> 00:00:48,089
sector government a little bit of

17
00:00:45,120 --> 00:00:50,669
<font color="#E5E5E5">everything currently among the fidelis</font>

18
00:00:48,090 --> 00:00:54,449
threat research team doing systems work

19
00:00:50,670 --> 00:00:58,680
building giant systems of threat

20
00:00:54,449 --> 00:01:00,899
research basically Monty you guys hear

21
00:00:58,680 --> 00:01:02,879
me do I need the mic my loud enough for

22
00:01:00,899 --> 00:01:05,400
the folks in the back we're good<font color="#CCCCCC"> alright</font>

23
00:01:02,879 --> 00:01:07,259
so you can't see my face but luckily see

24
00:01:05,400 --> 00:01:09,240
me up here<font color="#E5E5E5"> so I'm doing this for</font><font color="#CCCCCC"> a while</font>

25
00:01:07,260 --> 00:01:11,520
couple decades<font color="#E5E5E5"> a couple decades in</font>

26
00:01:09,240 --> 00:01:13,199
uniform<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know then lucky in the last</font>

27
00:01:11,520 --> 00:01:15,658
<font color="#CCCCCC">10 years</font><font color="#E5E5E5"> have been a part of a lot of</font>

28
00:01:13,200 --> 00:01:17,549
really cool<font color="#E5E5E5"> incident response and threat</font>

29
00:01:15,659 --> 00:01:19,320
research teams<font color="#E5E5E5"> it's kind of</font><font color="#CCCCCC"> given me a</font>

30
00:01:17,549 --> 00:01:20,729
lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> good perspective especially with</font>

31
00:01:19,320 --> 00:01:24,119
you are and hopefully we can share some

32
00:01:20,729 --> 00:01:26,039
of that with<font color="#E5E5E5"> you today okay</font>

33
00:01:24,120 --> 00:01:27,780
alright so I know we're get getting

34
00:01:26,040 --> 00:01:29,190
started a few minutes<font color="#E5E5E5"> late here but</font>

35
00:01:27,780 --> 00:01:31,020
would like<font color="#CCCCCC"> to give you a bit of a</font>

36
00:01:29,190 --> 00:01:33,960
disclaimer this is an introductory

37
00:01:31,020 --> 00:01:36,330
introductory level talk if you use<font color="#CCCCCC"> yarn</font>

38
00:01:33,960 --> 00:01:39,210
your day-to-day work flow probably not

39
00:01:36,330 --> 00:01:40,470
to talk for you if you want to walk out

40
00:01:39,210 --> 00:01:41,550
<font color="#E5E5E5">and check out one of the other talks</font>

41
00:01:40,470 --> 00:01:43,560
right now you're<font color="#E5E5E5"> not going to hurt my</font>

42
00:01:41,550 --> 00:01:46,320
feelings but I do like to<font color="#E5E5E5"> frame</font>

43
00:01:43,560 --> 00:01:51,480
expectations so that you know what<font color="#E5E5E5"> we're</font>

44
00:01:46,320 --> 00:01:54,240
going to do so so what is<font color="#E5E5E5"> Yara Yara is</font>

45
00:01:51,480 --> 00:01:56,940
basically tool that allows thread

46
00:01:54,240 --> 00:01:58,640
analysts malware analysts to identify

47
00:01:56,940 --> 00:02:01,830
<font color="#CCCCCC">and classify different malware samples</font>

48
00:01:58,640 --> 00:02:04,650
can be used<font color="#E5E5E5"> to dissect files look for</font>

49
00:02:01,830 --> 00:02:07,080
patterns inside of files perform your

50
00:02:04,650 --> 00:02:08,369
<font color="#E5E5E5">wrist a test and it can also help you to</font>

51
00:02:07,080 --> 00:02:09,600
look through a file and<font color="#E5E5E5"> see if there's</font>

52
00:02:08,369 --> 00:02:13,140
parts of that file that are missing<font color="#CCCCCC"> that</font>

53
00:02:09,600 --> 00:02:15,180
<font color="#E5E5E5">you're expecting it to be there I know</font>

54
00:02:13,140 --> 00:02:17,190
Monty you had a note here one of the

55
00:02:15,180 --> 00:02:18,630
things<font color="#E5E5E5"> too is people kind of get caught</font>

56
00:02:17,190 --> 00:02:19,950
up and using you know<font color="#E5E5E5"> looking at files</font>

57
00:02:18,630 --> 00:02:23,400
with<font color="#E5E5E5"> this you</font><font color="#CCCCCC"> can also look through</font>

58
00:02:19,950 --> 00:02:25,980
memory<font color="#E5E5E5"> okay and we'll talk about again</font>

59
00:02:23,400 --> 00:02:27,360
this<font color="#E5E5E5"> is very a very high level talk but</font>

60
00:02:25,980 --> 00:02:29,130
we're going<font color="#E5E5E5"> to talk about a lot</font><font color="#CCCCCC"> of these</font>

61
00:02:27,360 --> 00:02:30,950
these types of things<font color="#E5E5E5"> and give you some</font>

62
00:02:29,130 --> 00:02:32,910
some of the basics about Yara rules

63
00:02:30,950 --> 00:02:34,440
<font color="#E5E5E5">Gibson something yeah I was going to add</font>

64
00:02:32,910 --> 00:02:37,140
on to that you know so we mentioned

65
00:02:34,440 --> 00:02:38,370
researchers and now our researchers it's

66
00:02:37,140 --> 00:02:40,079
a<font color="#E5E5E5"> little more than</font><font color="#CCCCCC"> you can use you are</font>

67
00:02:38,370 --> 00:02:41,700
anybody can actually use your you can

68
00:02:40,080 --> 00:02:43,739
use<font color="#CCCCCC"> it for just about anything if it's a</font>

69
00:02:41,700 --> 00:02:45,450
file or has structure can pretty much

70
00:02:43,739 --> 00:02:47,580
point you<font color="#E5E5E5"> are at it and look for things</font>

71
00:02:45,450 --> 00:02:50,220
the interesting thing about your is you

72
00:02:47,580 --> 00:02:52,080
look at files in a bunch of<font color="#E5E5E5"> different</font>

73
00:02:50,220 --> 00:02:53,370
<font color="#CCCCCC">ways you can look at the way it is in</font>

74
00:02:52,080 --> 00:02:55,200
the wild<font color="#E5E5E5"> you can look at the way it is</font>

75
00:02:53,370 --> 00:02:57,270
when it's unarmed or done wrapped

76
00:02:55,200 --> 00:02:59,519
unprotected and you can also look for

77
00:02:57,270 --> 00:03:00,630
the inverse of what you think<font color="#CCCCCC"> should be</font>

78
00:02:59,520 --> 00:03:01,620
there and look for the things that<font color="#E5E5E5"> are</font>

79
00:03:00,630 --> 00:03:03,359
missing kind of what we talked about

80
00:03:01,620 --> 00:03:05,459
we're going<font color="#E5E5E5"> to touch on those a little</font>

81
00:03:03,360 --> 00:03:06,600
bit but if you have more questions about

82
00:03:05,459 --> 00:03:10,170
<font color="#E5E5E5">you can definitely hit us afterwards</font>

83
00:03:06,600 --> 00:03:13,799
we're going to more detail okay so

84
00:03:10,170 --> 00:03:16,109
starts beginning so we you know we want

85
00:03:13,800 --> 00:03:18,540
<font color="#E5E5E5">to write a yard rule we need to start</font>

86
00:03:16,110 --> 00:03:20,580
with a real name so there's you'll see

87
00:03:18,540 --> 00:03:21,540
we have some tables in here one of the

88
00:03:20,580 --> 00:03:23,250
things<font color="#E5E5E5"> we've done with this deck is</font>

89
00:03:21,540 --> 00:03:25,440
we've actually got a references section

90
00:03:23,250 --> 00:03:27,810
in the back with a lot of<font color="#E5E5E5"> links to</font><font color="#CCCCCC"> a lot</font>

91
00:03:25,440 --> 00:03:30,209
<font color="#E5E5E5">of</font><font color="#CCCCCC"> different online resources that we</font>

92
00:03:27,810 --> 00:03:31,110
use to help us write this but also you

93
00:03:30,209 --> 00:03:34,320
know just things that we use for

94
00:03:31,110 --> 00:03:35,880
reference on a regular basis so<font color="#CCCCCC"> starting</font>

95
00:03:34,320 --> 00:03:37,930
with the real name which<font color="#CCCCCC"> is one of</font><font color="#E5E5E5"> the</font>

96
00:03:35,880 --> 00:03:40,510
<font color="#E5E5E5">keywords next slide you'll see we have a</font>

97
00:03:37,930 --> 00:03:42,129
of some of the yard keywords and then

98
00:03:40,510 --> 00:03:44,769
it's followed by the actual<font color="#E5E5E5"> rule name or</font>

99
00:03:42,129 --> 00:03:46,328
the identifier just a couple<font color="#E5E5E5"> of notes</font>

100
00:03:44,769 --> 00:03:50,049
with that the first character of a rule

101
00:03:46,329 --> 00:03:51,939
name cannot be a digit<font color="#E5E5E5"> okay rule names</font>

102
00:03:50,049 --> 00:03:55,030
are case sensitive they can't be longer

103
00:03:51,939 --> 00:03:57,400
than 128 characters kind of goes without

104
00:03:55,030 --> 00:03:59,950
saying if your rule name is is really

105
00:03:57,400 --> 00:04:03,219
that long you're probably getting a

106
00:03:59,950 --> 00:04:04,780
little too specific usually I try to

107
00:04:03,219 --> 00:04:07,269
keep it to about maybe two or three

108
00:04:04,780 --> 00:04:08,709
words and I usually will put a nutter

109
00:04:07,269 --> 00:04:12,040
score in between the different words so

110
00:04:08,709 --> 00:04:14,680
you<font color="#CCCCCC"> know John's underscore rule</font>

111
00:04:12,040 --> 00:04:16,389
underscore malware underscore sample or

112
00:04:14,680 --> 00:04:18,340
something like that<font color="#E5E5E5"> you can get crazy</font>

113
00:04:16,389 --> 00:04:19,720
with it it's<font color="#E5E5E5"> really kind of like</font>

114
00:04:18,339 --> 00:04:23,590
anything<font color="#E5E5E5"> it's just up to your your</font>

115
00:04:19,720 --> 00:04:24,699
personal preferences and you'll see at

116
00:04:23,590 --> 00:04:26,320
<font color="#CCCCCC">the very bottom of</font><font color="#E5E5E5"> the slide there</font>

117
00:04:24,699 --> 00:04:28,270
there's a<font color="#E5E5E5"> little curly bracket that's</font>

118
00:04:26,320 --> 00:04:31,659
where the actual<font color="#E5E5E5"> content of the rule</font>

119
00:04:28,270 --> 00:04:33,549
will will start go ahead and<font color="#CCCCCC"> go to</font><font color="#E5E5E5"> the</font>

120
00:04:31,660 --> 00:04:35,139
next<font color="#E5E5E5"> slide there I was going</font><font color="#CCCCCC"> to make a</font>

121
00:04:33,550 --> 00:04:37,150
quick I mean it makes sense that<font color="#CCCCCC"> you</font>

122
00:04:35,139 --> 00:04:39,250
would use real names that actually make

123
00:04:37,150 --> 00:04:40,599
sense they speak<font color="#E5E5E5"> to the content or they</font>

124
00:04:39,250 --> 00:04:42,220
speak to<font color="#E5E5E5"> your perspective what you're</font>

125
00:04:40,599 --> 00:04:43,479
trying to write the rule for you know

126
00:04:42,220 --> 00:04:44,560
make sure<font color="#E5E5E5"> and employ that when you're</font>

127
00:04:43,479 --> 00:04:46,690
naming it don't name it something

128
00:04:44,560 --> 00:04:47,919
nonsensical a lot of times the output

129
00:04:46,690 --> 00:04:50,650
which you'll see later we'll get<font color="#E5E5E5"> a</font>

130
00:04:47,919 --> 00:04:52,840
couple of snapshots the<font color="#E5E5E5"> output is often</font>

131
00:04:50,650 --> 00:04:54,880
the rule name itself so make<font color="#CCCCCC"> it make</font>

132
00:04:52,840 --> 00:04:56,229
sense to what you're looking for<font color="#E5E5E5"> now you</font>

133
00:04:54,880 --> 00:04:58,449
<font color="#E5E5E5">can either output that or</font><font color="#CCCCCC"> its other</font>

134
00:04:56,229 --> 00:05:03,039
elements which<font color="#E5E5E5"> I'm not going to get</font>

135
00:04:58,449 --> 00:05:04,030
ahead of myself<font color="#E5E5E5"> no problem you'll see we</font>

136
00:05:03,039 --> 00:05:06,070
have this table in here a<font color="#E5E5E5"> couple times</font>

137
00:05:04,030 --> 00:05:08,650
this is just to point out that<font color="#E5E5E5"> these are</font>

138
00:05:06,070 --> 00:05:10,240
reserved<font color="#CCCCCC"> key words when</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> name your</font>

139
00:05:08,650 --> 00:05:14,049
rule you don't want to call it rule and

140
00:05:10,240 --> 00:05:16,570
then like all or no case or them or<font color="#E5E5E5"> that</font>

141
00:05:14,050 --> 00:05:18,310
kind of a thing but<font color="#E5E5E5"> you could do you</font>

142
00:05:16,570 --> 00:05:19,449
know rule underscore all or there's

143
00:05:18,310 --> 00:05:21,400
something along those lines if you

144
00:05:19,449 --> 00:05:23,620
wanted to use some of<font color="#CCCCCC"> these words inside</font>

145
00:05:21,400 --> 00:05:28,030
of your rule name itself just<font color="#E5E5E5"> don't call</font>

146
00:05:23,620 --> 00:05:29,949
it all and or any that kind of thing so

147
00:05:28,030 --> 00:05:33,250
the<font color="#E5E5E5"> next section and this is an optional</font>

148
00:05:29,949 --> 00:05:35,820
section but it's<font color="#E5E5E5"> very useful it's the</font>

149
00:05:33,250 --> 00:05:38,530
metadata section and this allows you to

150
00:05:35,820 --> 00:05:41,979
put some different information inside of

151
00:05:38,530 --> 00:05:43,690
the the rural content itself so that you

152
00:05:41,979 --> 00:05:45,758
can kind of use it<font color="#CCCCCC"> to classify if you</font>

153
00:05:43,690 --> 00:05:47,409
have a particular family of malware

154
00:05:45,759 --> 00:05:49,000
you're looking for or things like that

155
00:05:47,409 --> 00:05:50,420
or if you just want to<font color="#E5E5E5"> you know if you</font>

156
00:05:49,000 --> 00:05:52,100
have a team working on<font color="#E5E5E5"> it you can</font>

157
00:05:50,420 --> 00:05:54,560
author names you can see I have a very

158
00:05:52,100 --> 00:05:57,590
basic you<font color="#E5E5E5"> know description author</font>

159
00:05:54,560 --> 00:06:00,620
nickname<font color="#E5E5E5"> anybody here know who email</font>

160
00:05:57,590 --> 00:06:03,289
verb it is just out of<font color="#E5E5E5"> curiosity</font><font color="#CCCCCC"> okay I</font>

161
00:06:00,620 --> 00:06:07,640
didn't<font color="#CCCCCC"> think</font><font color="#E5E5E5"> so all-time baseball player</font>

162
00:06:03,290 --> 00:06:09,170
from the 40s so anyhow that's that's the

163
00:06:07,640 --> 00:06:10,490
meta section you can use it<font color="#CCCCCC"> a lot to do</font>

164
00:06:09,170 --> 00:06:11,510
a<font color="#CCCCCC"> lot of classification and money I</font>

165
00:06:10,490 --> 00:06:13,970
think you're going<font color="#E5E5E5"> to talk about that a</font>

166
00:06:11,510 --> 00:06:15,680
little<font color="#E5E5E5"> bit further down but just kind of</font>

167
00:06:13,970 --> 00:06:19,730
keep in mind it this is an optional

168
00:06:15,680 --> 00:06:22,640
section here and the<font color="#E5E5E5"> reason why</font><font color="#CCCCCC"> you want</font>

169
00:06:19,730 --> 00:06:24,410
to use the metadata again you know as

170
00:06:22,640 --> 00:06:25,610
your number of rules increase<font color="#CCCCCC"> it's going</font>

171
00:06:24,410 --> 00:06:28,070
to help<font color="#CCCCCC"> you</font><font color="#E5E5E5"> to kind of categorize and</font>

172
00:06:25,610 --> 00:06:30,080
sort them it allows you to describe

173
00:06:28,070 --> 00:06:31,820
what's in them<font color="#E5E5E5"> because six months later</font>

174
00:06:30,080 --> 00:06:35,570
you're not going to<font color="#CCCCCC"> remember what you</font>

175
00:06:31,820 --> 00:06:37,070
put in there most likely and it just

176
00:06:35,570 --> 00:06:39,290
<font color="#CCCCCC">helps you to</font><font color="#E5E5E5"> idea in case you want to do</font>

177
00:06:37,070 --> 00:06:42,080
a you know quick wrap their text file so

178
00:06:39,290 --> 00:06:43,670
you can do a quick wrap to look for some

179
00:06:42,080 --> 00:06:45,380
<font color="#CCCCCC">information for you know you may not</font>

180
00:06:43,670 --> 00:06:49,460
<font color="#E5E5E5">have remember the rule name itself but</font>

181
00:06:45,380 --> 00:06:50,750
the metadata<font color="#CCCCCC"> Maytag it for you and and</font>

182
00:06:49,460 --> 00:06:52,370
you hit the<font color="#CCCCCC"> metric section I don't</font>

183
00:06:50,750 --> 00:06:53,750
remember<font color="#CCCCCC"> what exactly you were thinking</font>

184
00:06:52,370 --> 00:06:58,040
there with the metrics for the directive

185
00:06:53,750 --> 00:06:59,960
stuff<font color="#CCCCCC"> you can just explore it you can</font>

186
00:06:58,040 --> 00:07:01,790
gather how often is firing often it's

187
00:06:59,960 --> 00:07:03,890
not firing a million other different

188
00:07:01,790 --> 00:07:05,540
possibilities with metrics if you work

189
00:07:03,890 --> 00:07:07,430
<font color="#CCCCCC">for anybody at a company they ask you</font>

190
00:07:05,540 --> 00:07:09,080
for metrics at some point and so you

191
00:07:07,430 --> 00:07:10,910
need to build<font color="#E5E5E5"> that in if you're</font><font color="#CCCCCC"> thinking</font>

192
00:07:09,080 --> 00:07:12,260
ahead a little bit when you're right in

193
00:07:10,910 --> 00:07:16,690
your yard rules so that you don't have

194
00:07:12,260 --> 00:07:16,690
<font color="#E5E5E5">to go back</font><font color="#CCCCCC"> and do it after the fact okay</font>

195
00:07:16,780 --> 00:07:23,590
so now this<font color="#CCCCCC"> is really the the main</font>

196
00:07:20,990 --> 00:07:26,960
portion of the rule itself this is where

197
00:07:23,590 --> 00:07:29,090
most of your your your action happens so

198
00:07:26,960 --> 00:07:30,049
to speak<font color="#E5E5E5"> so you've got the rule name and</font>

199
00:07:29,090 --> 00:07:31,820
then you'll see that there's two

200
00:07:30,050 --> 00:07:35,240
sections these are the required sections

201
00:07:31,820 --> 00:07:39,920
of<font color="#CCCCCC"> a are a rule they are the strings and</font>

202
00:07:35,240 --> 00:07:42,140
the condition section and you'll see for

203
00:07:39,920 --> 00:07:45,380
the strings we actually have two strings

204
00:07:42,140 --> 00:07:47,360
declared in there we have the my text

205
00:07:45,380 --> 00:07:49,490
string which is<font color="#E5E5E5"> play ball and then to my</font>

206
00:07:47,360 --> 00:07:52,520
heck string which also spells out

207
00:07:49,490 --> 00:07:56,120
baseball<font color="#E5E5E5"> and then we have the condition</font>

208
00:07:52,520 --> 00:07:58,010
<font color="#E5E5E5">a very simple condition if either one of</font>

209
00:07:56,120 --> 00:07:59,810
these strings occurs in<font color="#E5E5E5"> the sample</font><font color="#CCCCCC"> we'll</font>

210
00:07:58,010 --> 00:08:01,340
get a match on this<font color="#E5E5E5"> okay so a very basic</font>

211
00:07:59,810 --> 00:08:02,350
layout this is just to really show you

212
00:08:01,340 --> 00:08:07,000
the two different<font color="#E5E5E5"> section</font>

213
00:08:02,350 --> 00:08:08,860
so with the strength section when you

214
00:08:07,000 --> 00:08:10,990
declare a string you start<font color="#E5E5E5"> with the</font>

215
00:08:08,860 --> 00:08:12,070
identifier of a dollar sign and then you

216
00:08:10,990 --> 00:08:14,530
can use a sequence of alphanumeric

217
00:08:12,070 --> 00:08:17,409
numbers and characters and underscores

218
00:08:14,530 --> 00:08:18,669
and all that kind of stuff<font color="#CCCCCC"> and drinks</font>

219
00:08:17,410 --> 00:08:22,470
can be defined in a number of different

220
00:08:18,670 --> 00:08:25,090
<font color="#E5E5E5">ways you</font><font color="#CCCCCC"> can do a ski strings unicode</font>

221
00:08:22,470 --> 00:08:27,000
you know why you can see right there we

222
00:08:25,090 --> 00:08:29,320
have the<font color="#E5E5E5"> unicode with the wide keyword</font>

223
00:08:27,000 --> 00:08:30,820
so you can do a lot<font color="#E5E5E5"> of different</font><font color="#CCCCCC"> types</font>

224
00:08:29,320 --> 00:08:32,919
of strings as you're going along and

225
00:08:30,820 --> 00:08:39,390
again just<font color="#E5E5E5"> to point out the table there</font>

226
00:08:32,919 --> 00:08:43,569
you can see we've<font color="#CCCCCC"> got oh no case a</font>

227
00:08:39,390 --> 00:08:46,630
couple of wide yeah keywords you can

228
00:08:43,570 --> 00:08:49,030
employ look at different content yeah

229
00:08:46,630 --> 00:08:51,010
you know<font color="#CCCCCC"> to get</font><font color="#E5E5E5"> just what you're working</font>

230
00:08:49,030 --> 00:08:54,370
with really here<font color="#E5E5E5"> so go ahead and click</font>

231
00:08:51,010 --> 00:08:55,830
over to the next<font color="#E5E5E5"> one here so one of the</font>

232
00:08:54,370 --> 00:08:58,510
things you<font color="#E5E5E5"> can do is use the forward</font>

233
00:08:55,830 --> 00:09:01,060
string and that allows you to look

234
00:08:58,510 --> 00:09:04,360
forward boundaries so if you're<font color="#E5E5E5"> looking</font>

235
00:09:01,060 --> 00:09:05,739
for a very specific word you would you

236
00:09:04,360 --> 00:09:07,710
would want to<font color="#E5E5E5"> use forward so in case</font>

237
00:09:05,740 --> 00:09:10,720
here if we had the example of baseball

238
00:09:07,710 --> 00:09:13,660
if you define<font color="#CCCCCC"> it as forward it won't</font>

239
00:09:10,720 --> 00:09:17,680
match on one baseball<font color="#E5E5E5"> com but it would</font>

240
00:09:13,660 --> 00:09:19,209
match on baseball dash reference com and

241
00:09:17,680 --> 00:09:21,969
baseball calm because they're separated

242
00:09:19,210 --> 00:09:23,350
by the<font color="#E5E5E5"> period and the dash okay but if</font>

243
00:09:21,970 --> 00:09:24,730
you<font color="#CCCCCC"> can see with the one baseball</font>

244
00:09:23,350 --> 00:09:28,110
because<font color="#E5E5E5"> I had the word in front of it</font>

245
00:09:24,730 --> 00:09:28,110
that would<font color="#E5E5E5"> not match on that</font>

246
00:09:29,510 --> 00:09:35,160
okay so heck strings we can get directed

247
00:09:33,060 --> 00:09:36,689
a little bit more detailed with you can

248
00:09:35,160 --> 00:09:39,660
see they're enclosed by the curly

249
00:09:36,690 --> 00:09:41,100
brackets it should go without saying the

250
00:09:39,660 --> 00:09:44,399
decimal numbers are not allowed in<font color="#CCCCCC"> HEK</font>

251
00:09:41,100 --> 00:09:49,740
strings you<font color="#CCCCCC"> can see we have the heck</font>

252
00:09:44,399 --> 00:09:52,579
string of baseball 23 so we can also

253
00:09:49,740 --> 00:09:54,720
allow for wild cards and jumps and

254
00:09:52,579 --> 00:09:57,839
different alternatives of wildcard

255
00:09:54,720 --> 00:10:00,740
characters ? and you can see that<font color="#E5E5E5"> the</font>

256
00:09:57,839 --> 00:10:04,649
second string down there has the be a

257
00:10:00,740 --> 00:10:06,600
<font color="#CCCCCC">wild-card</font><font color="#E5E5E5"> be a</font><font color="#CCCCCC"> wildcard 1123 so that</font>

258
00:10:04,649 --> 00:10:11,579
would match on you know anything with

259
00:10:06,600 --> 00:10:15,000
those those wild card tonight you can

260
00:10:11,579 --> 00:10:17,099
also get into variable content at length

261
00:10:15,000 --> 00:10:20,670
in this case here you can see we've got

262
00:10:17,100 --> 00:10:22,140
<font color="#E5E5E5">some jumps to find in there where the in</font>

263
00:10:20,670 --> 00:10:24,300
the middle there<font color="#E5E5E5"> where have the two dash</font>

264
00:10:22,140 --> 00:10:26,010
for it allows<font color="#CCCCCC"> us to look</font><font color="#E5E5E5"> for variable</font>

265
00:10:24,300 --> 00:10:31,229
number of characters in there from two

266
00:10:26,010 --> 00:10:33,500
to four<font color="#CCCCCC"> they're unbounded so you can put</font>

267
00:10:31,230 --> 00:10:37,110
a jump at<font color="#E5E5E5"> the beginning or at the end</font>

268
00:10:33,500 --> 00:10:38,760
and mind you have a note there I<font color="#CCCCCC"> think</font>

269
00:10:37,110 --> 00:10:40,440
you have a thing there just a note if

270
00:10:38,760 --> 00:10:45,810
<font color="#CCCCCC">you use these if you use jumps or use</font>

271
00:10:40,440 --> 00:10:47,310
even a particular jumps<font color="#CCCCCC"> yars</font><font color="#E5E5E5"> pretty</font>

272
00:10:45,810 --> 00:10:48,630
forgiving on a lot<font color="#E5E5E5"> of things but</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> will</font>

273
00:10:47,310 --> 00:10:49,479
really yell at you if<font color="#CCCCCC"> you try to these</font>

274
00:10:48,630 --> 00:10:51,370
at<font color="#E5E5E5"> the beginning</font>

275
00:10:49,480 --> 00:10:53,350
and lastly people try it that's a

276
00:10:51,370 --> 00:10:55,480
horrible idea<font color="#E5E5E5"> I mean use different logic</font>

277
00:10:53,350 --> 00:10:57,519
using<font color="#E5E5E5"> then the center needs something to</font>

278
00:10:55,480 --> 00:10:59,470
search<font color="#CCCCCC"> for word to find that content to</font>

279
00:10:57,519 --> 00:11:01,209
be<font color="#CCCCCC"> able to jump around so use common</font>

280
00:10:59,470 --> 00:11:03,430
sense when your foot knees together yeah

281
00:11:01,209 --> 00:11:04,479
and you'll see<font color="#CCCCCC"> that coming that will</font>

282
00:11:03,430 --> 00:11:07,300
<font color="#E5E5E5">come into play a little bit later when</font>

283
00:11:04,480 --> 00:11:09,670
we start talking<font color="#E5E5E5"> about the next section</font>

284
00:11:07,300 --> 00:11:11,109
here one other thing that we can do we

285
00:11:09,670 --> 00:11:13,120
can<font color="#CCCCCC"> actually get in there and do some</font>

286
00:11:11,110 --> 00:11:15,940
pipe commands so you can see the example

287
00:11:13,120 --> 00:11:18,639
here for the heck string we have<font color="#CCCCCC"> be a 5</font>

288
00:11:15,940 --> 00:11:20,410
<font color="#CCCCCC">e ba then we also have with</font><font color="#E5E5E5"> the pipe</font>

289
00:11:18,639 --> 00:11:23,699
separating the two basically that's like

290
00:11:20,410 --> 00:11:25,810
an or so it's either fivb a or 5<font color="#CCCCCC"> e BB</font>

291
00:11:23,699 --> 00:11:27,579
<font color="#E5E5E5">and you can see that it would match on</font>

292
00:11:25,810 --> 00:11:30,729
either one of those those particular

293
00:11:27,579 --> 00:11:31,989
heck strings there now the other thing

294
00:11:30,730 --> 00:11:37,029
that you<font color="#E5E5E5"> can do is you can actually</font>

295
00:11:31,990 --> 00:11:40,630
define reg<font color="#E5E5E5"> axis within your your strings</font>

296
00:11:37,029 --> 00:11:42,610
and these you know<font color="#CCCCCC"> I have I have one</font>

297
00:11:40,630 --> 00:11:44,829
co-worker that really loves his reg axis

298
00:11:42,610 --> 00:11:47,500
he puts together these really long

299
00:11:44,829 --> 00:11:50,229
intricate strings and kind<font color="#E5E5E5"> of like Monty</font>

300
00:11:47,500 --> 00:11:53,019
was<font color="#E5E5E5"> hinting at before with the jumps you</font>

301
00:11:50,230 --> 00:11:55,510
know that sometimes<font color="#CCCCCC"> comes at a cost so</font>

302
00:11:53,019 --> 00:11:57,639
I'm more of the mindset of simplicity

303
00:11:55,510 --> 00:11:58,899
when i try<font color="#E5E5E5"> to do these things not always</font>

304
00:11:57,639 --> 00:12:00,550
the case you know<font color="#E5E5E5"> sometimes they think</font>

305
00:11:58,899 --> 00:12:05,139
<font color="#CCCCCC">get very complex and you know who I'm</font>

306
00:12:00,550 --> 00:12:07,510
talking about don't you and you can see

307
00:12:05,139 --> 00:12:10,510
in this particular case here we have a

308
00:12:07,510 --> 00:12:14,019
string for an md5 and just a very basic

309
00:12:10,510 --> 00:12:16,029
type of regex 09 a 305 a three off 32

310
00:12:14,019 --> 00:12:19,240
characters that kind of thing so that

311
00:12:16,029 --> 00:12:20,649
<font color="#CCCCCC">would match on an empty five value just</font>

312
00:12:19,240 --> 00:12:21,670
wonder they can quicken over<font color="#E5E5E5"> it even</font>

313
00:12:20,649 --> 00:12:24,579
though we went through a<font color="#CCCCCC"> couple</font><font color="#E5E5E5"> of</font>

314
00:12:21,670 --> 00:12:28,990
slides<font color="#CCCCCC"> it really boils down to string</font>

315
00:12:24,579 --> 00:12:30,880
hex or a regex now there are<font color="#CCCCCC"> variations</font>

316
00:12:28,990 --> 00:12:32,260
<font color="#CCCCCC">each one of those like you could look</font>

317
00:12:30,880 --> 00:12:33,310
<font color="#E5E5E5">for Unicode strange you could look for a</font>

318
00:12:32,260 --> 00:12:35,529
ski strains you to look for a

319
00:12:33,310 --> 00:12:37,719
combination you get it<font color="#E5E5E5"> a regex is all</font>

320
00:12:35,529 --> 00:12:39,279
day long complicated or simple and then

321
00:12:37,720 --> 00:12:41,470
of<font color="#CCCCCC"> course you can look at Hexham any of</font>

322
00:12:39,279 --> 00:12:43,480
its ability to either you know

323
00:12:41,470 --> 00:12:44,260
substitute in or have jumps so you have

324
00:12:43,480 --> 00:12:45,420
to<font color="#E5E5E5"> keep that in mind when you're</font>

325
00:12:44,260 --> 00:12:47,250
developing a

326
00:12:45,420 --> 00:12:49,530
what you want to<font color="#E5E5E5"> look at content wise</font>

327
00:12:47,250 --> 00:12:52,170
<font color="#CCCCCC">and what you want to detect and not find</font>

328
00:12:49,530 --> 00:12:53,459
so part of that<font color="#CCCCCC"> we'll talk about</font><font color="#E5E5E5"> touch</font>

329
00:12:52,170 --> 00:12:54,990
on but at this basically we'll just

330
00:12:53,460 --> 00:12:57,300
remember you really<font color="#E5E5E5"> have three options</font>

331
00:12:54,990 --> 00:12:59,190
there and then that<font color="#CCCCCC"> acquaint conditions</font>

332
00:12:57,300 --> 00:13:00,630
yeah and it really gets down to the

333
00:12:59,190 --> 00:13:02,610
yummy there's more than one way to do

334
00:13:00,630 --> 00:13:04,200
things and so sometimes you know you

335
00:13:02,610 --> 00:13:05,220
kind of start going down<font color="#E5E5E5"> a road because</font>

336
00:13:04,200 --> 00:13:07,140
you have it in your head you want<font color="#E5E5E5"> to use</font>

337
00:13:05,220 --> 00:13:08,340
a regex and maybe you just need to back

338
00:13:07,140 --> 00:13:11,670
up and maybe<font color="#E5E5E5"> just use a very simple</font>

339
00:13:08,340 --> 00:13:13,350
hacks just like anything<font color="#E5E5E5"> you know it's</font>

340
00:13:11,670 --> 00:13:15,209
<font color="#E5E5E5">just matter you just don't want to paint</font>

341
00:13:13,350 --> 00:13:16,650
yourself into a corner<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can take</font>

342
00:13:15,210 --> 00:13:20,280
you can<font color="#E5E5E5"> have some really big performance</font>

343
00:13:16,650 --> 00:13:22,410
it's when you do that so the the other

344
00:13:20,280 --> 00:13:23,550
other necessary section we<font color="#CCCCCC"> have in</font>

345
00:13:22,410 --> 00:13:27,719
addition<font color="#CCCCCC"> to strings are the conditions</font>

346
00:13:23,550 --> 00:13:29,819
and so you<font color="#E5E5E5"> can see here we have the very</font>

347
00:13:27,720 --> 00:13:32,190
simple condition of my texturing or my

348
00:13:29,820 --> 00:13:33,420
heck strength<font color="#CCCCCC"> okay and then we can start</font>

349
00:13:32,190 --> 00:13:35,580
to get a little bit<font color="#CCCCCC"> more complicated</font>

350
00:13:33,420 --> 00:13:38,839
from there you can use a lot of your

351
00:13:35,580 --> 00:13:41,610
common bullion's your hands and ors etc

352
00:13:38,840 --> 00:13:42,600
and you<font color="#CCCCCC"> can see here we can start we're</font>

353
00:13:41,610 --> 00:13:45,420
starting to add a<font color="#E5E5E5"> little bit more</font>

354
00:13:42,600 --> 00:13:46,980
complexity and this the<font color="#E5E5E5"> first bullet</font>

355
00:13:45,420 --> 00:13:49,890
there you can<font color="#CCCCCC"> see we've got</font><font color="#E5E5E5"> a counting</font>

356
00:13:46,980 --> 00:13:54,480
example so if the mic texturing occurs

357
00:13:49,890 --> 00:13:59,250
three times or the my heck string occurs

358
00:13:54,480 --> 00:14:02,550
less than or equal to 7 and the re is

359
00:13:59,250 --> 00:14:04,800
greater than or equal to 2 then it'll be

360
00:14:02,550 --> 00:14:06,180
<font color="#E5E5E5">a match basically and when</font><font color="#CCCCCC"> you're doing</font>

361
00:14:04,800 --> 00:14:09,209
accounting operation you're going to use

362
00:14:06,180 --> 00:14:13,319
the pound sign there for the the

363
00:14:09,210 --> 00:14:15,270
identifier and you know you can<font color="#E5E5E5"> start</font><font color="#CCCCCC"> to</font>

364
00:14:13,320 --> 00:14:17,700
start<font color="#E5E5E5"> to really develop some complexity</font>

365
00:14:15,270 --> 00:14:19,939
with that you can also use<font color="#CCCCCC"> other rule</font>

366
00:14:17,700 --> 00:14:23,670
names so as you build a corpus of rules

367
00:14:19,940 --> 00:14:25,050
you can come in and you see in the

368
00:14:23,670 --> 00:14:28,860
condition here we're referencing the

369
00:14:25,050 --> 00:14:32,729
ghost dash rule and my heck string and

370
00:14:28,860 --> 00:14:33,960
<font color="#CCCCCC">anytime you reference a rule it has to</font>

371
00:14:32,730 --> 00:14:35,970
been processed before you actually

372
00:14:33,960 --> 00:14:37,530
reference it so if i put<font color="#E5E5E5"> it down</font>

373
00:14:35,970 --> 00:14:40,730
underneath my condition it's not going

374
00:14:37,530 --> 00:14:40,730
to<font color="#E5E5E5"> not going to see it</font>

375
00:14:42,630 --> 00:14:47,700
alright so the conditions also just<font color="#E5E5E5"> like</font>

376
00:14:45,870 --> 00:14:49,440
with the heck strings and the<font color="#E5E5E5"> the text</font>

377
00:14:47,700 --> 00:14:50,880
strings and you know<font color="#CCCCCC"> just the different</font>

378
00:14:49,440 --> 00:14:52,980
strings we can start to add some more

379
00:14:50,880 --> 00:14:55,040
complexity like I said you can see we've

380
00:14:52,980 --> 00:14:58,920
<font color="#CCCCCC">got a</font><font color="#E5E5E5"> very basic set of strings here</font>

381
00:14:55,040 --> 00:15:01,319
string a Chicago string B cups drink see

382
00:14:58,920 --> 00:15:05,610
baseball in this<font color="#E5E5E5"> case we're looking for</font>

383
00:15:01,320 --> 00:15:06,990
two of those three so if my my sample

384
00:15:05,610 --> 00:15:09,840
has two<font color="#CCCCCC"> of those three it's going to</font>

385
00:15:06,990 --> 00:15:10,920
fire match on that<font color="#E5E5E5"> and again</font><font color="#CCCCCC"> you can you</font>

386
00:15:09,840 --> 00:15:12,360
know one of the things you<font color="#E5E5E5"> may want to</font>

387
00:15:10,920 --> 00:15:14,849
do I<font color="#CCCCCC"> think we've got it reference at the</font>

388
00:15:12,360 --> 00:15:17,490
end of<font color="#E5E5E5"> the deck but the yard</font>

389
00:15:14,850 --> 00:15:20,700
documentation online has a plethora of

390
00:15:17,490 --> 00:15:22,140
<font color="#E5E5E5">different examples that</font><font color="#CCCCCC"> you can use this</font>

391
00:15:20,700 --> 00:15:24,030
which is one I thought was kind of I

392
00:15:22,140 --> 00:15:28,890
I've seen this one used quite a bit and

393
00:15:24,030 --> 00:15:29,970
it's a pretty useful one and one kind<font color="#CCCCCC"> of</font>

394
00:15:28,890 --> 00:15:31,920
other thing to kind of mention here is

395
00:15:29,970 --> 00:15:33,330
you can actually use<font color="#E5E5E5"> include files just</font>

396
00:15:31,920 --> 00:15:37,199
<font color="#E5E5E5">like a lot of</font><font color="#CCCCCC"> different languages that</font>

397
00:15:33,330 --> 00:15:38,640
are out there in this case<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see</font>

398
00:15:37,200 --> 00:15:40,500
we're in<font color="#E5E5E5"> clothing it with the quotes so</font>

399
00:15:38,640 --> 00:15:47,520
you can do it include other yard to

400
00:15:40,500 --> 00:15:51,660
include another rule and well starting

401
00:15:47,520 --> 00:15:53,220
to get carpal tunnel with that so the

402
00:15:51,660 --> 00:15:55,260
you know just just look<font color="#CCCCCC"> like with</font>

403
00:15:53,220 --> 00:15:57,540
anything you know the base paths you can

404
00:15:55,260 --> 00:16:01,590
do absolute you can do relative paths

405
00:15:57,540 --> 00:16:04,890
and you can<font color="#E5E5E5"> really start to you know get</font>

406
00:16:01,590 --> 00:16:06,630
is specific as you need to so we'll<font color="#E5E5E5"> talk</font>

407
00:16:04,890 --> 00:16:07,680
a little bit more about<font color="#E5E5E5"> this one monitor</font>

408
00:16:06,630 --> 00:16:09,720
to get into some<font color="#E5E5E5"> of the categorization</font>

409
00:16:07,680 --> 00:16:10,979
and some of the monolithic and

410
00:16:09,720 --> 00:16:15,450
megalithic and all those other

411
00:16:10,980 --> 00:16:17,640
structures but at this point arm I'd

412
00:16:15,450 --> 00:16:20,220
like<font color="#E5E5E5"> to take just a quick minute are</font>

413
00:16:17,640 --> 00:16:22,850
there any questions so far<font color="#E5E5E5"> just a couple</font>

414
00:16:20,220 --> 00:16:22,850
you have

415
00:16:26,259 --> 00:16:33,920
bueller bueller<font color="#E5E5E5"> okay all right okay come</font>

416
00:16:32,149 --> 00:16:35,509
on yeah i'm<font color="#CCCCCC"> just gonna as long as you</font>

417
00:16:33,920 --> 00:16:37,430
can hear me I'm good if you can't let<font color="#E5E5E5"> me</font>

418
00:16:35,509 --> 00:16:39,920
know well probably better for the video

419
00:16:37,430 --> 00:16:41,599
<font color="#E5E5E5">all right I like to bellow out then this</font>

420
00:16:39,920 --> 00:16:43,910
just kind<font color="#E5E5E5"> of gets annoying all right so</font>

421
00:16:41,600 --> 00:16:46,009
he done mentioned the include directive

422
00:16:43,910 --> 00:16:47,990
a little bit ago so rule organization is

423
00:16:46,009 --> 00:16:49,519
really key especially as you grow in

424
00:16:47,990 --> 00:16:50,959
your rules so<font color="#E5E5E5"> when you first start you</font>

425
00:16:49,519 --> 00:16:52,519
create a<font color="#E5E5E5"> couple of rules it's not a big</font>

426
00:16:50,959 --> 00:16:54,529
deal you create a<font color="#E5E5E5"> couple hundred it</font>

427
00:16:52,519 --> 00:16:57,290
starts becoming kind of a burden start

428
00:16:54,529 --> 00:16:58,699
creating a couple thousand and then it

429
00:16:57,290 --> 00:17:00,290
really starts to change you start losing

430
00:16:58,699 --> 00:17:02,149
track of what you wrote when<font color="#E5E5E5"> you wrote</font>

431
00:17:00,290 --> 00:17:04,039
it and what you wrote it for metadata

432
00:17:02,149 --> 00:17:06,799
may help but having some organization

433
00:17:04,039 --> 00:17:08,419
two things really helps play towards

434
00:17:06,799 --> 00:17:10,819
keeping track and understanding why

435
00:17:08,419 --> 00:17:12,470
you're using a rule or not using one so

436
00:17:10,819 --> 00:17:14,359
I've got a quick kind of snapshot here

437
00:17:12,470 --> 00:17:15,829
in a minute but with the include

438
00:17:14,359 --> 00:17:17,149
directive its strength is<font color="#CCCCCC"> that you can</font>

439
00:17:15,829 --> 00:17:18,619
create<font color="#E5E5E5"> rules and put them in separate</font>

440
00:17:17,150 --> 00:17:20,900
files and then add and subtract them as

441
00:17:18,619 --> 00:17:22,849
you need so no one uses all the rules

442
00:17:20,900 --> 00:17:24,400
all the time if they do they're probably

443
00:17:22,849 --> 00:17:26,750
wasting some of their precious

444
00:17:24,400 --> 00:17:28,970
processing time when they're doing<font color="#E5E5E5"> so if</font>

445
00:17:26,750 --> 00:17:30,289
you organize it and put things<font color="#E5E5E5"> in groups</font>

446
00:17:28,970 --> 00:17:31,640
just like you would classify and

447
00:17:30,289 --> 00:17:33,260
organize<font color="#E5E5E5"> against different pieces of</font>

448
00:17:31,640 --> 00:17:34,370
malware are different files it will<font color="#CCCCCC"> help</font>

449
00:17:33,260 --> 00:17:35,840
you<font color="#CCCCCC"> out</font><font color="#E5E5E5"> in the long run they're not</font>

450
00:17:34,370 --> 00:17:38,030
clicked on the next side I've got an

451
00:17:35,840 --> 00:17:39,139
example<font color="#E5E5E5"> which you can't hardly see I've</font>

452
00:17:38,030 --> 00:17:41,780
got<font color="#E5E5E5"> the same problem you did Andrew</font>

453
00:17:39,140 --> 00:17:44,059
yesterday so this is supposed to show a

454
00:17:41,780 --> 00:17:45,770
snapshot it's talking<font color="#CCCCCC"> about a threat</font>

455
00:17:44,059 --> 00:17:48,049
group called kurosu and it just breaks

456
00:17:45,770 --> 00:17:50,059
down how<font color="#E5E5E5"> I've started splitting out</font>

457
00:17:48,049 --> 00:17:52,220
different direct you<font color="#E5E5E5"> know different</font>

458
00:17:50,059 --> 00:17:54,200
files with that have been pulled in with

459
00:17:52,220 --> 00:17:56,690
the include directive so it's kind of

460
00:17:54,200 --> 00:17:58,190
<font color="#CCCCCC">hard to see but there's the main rule in</font>

461
00:17:56,690 --> 00:17:59,600
the middle and<font color="#E5E5E5"> then off to the side we</font>

462
00:17:58,190 --> 00:18:01,789
see that first large bracket on<font color="#CCCCCC"> the</font>

463
00:17:59,600 --> 00:18:03,230
right that's a separate rule just for

464
00:18:01,789 --> 00:18:05,840
that threat group that has in it a

465
00:18:03,230 --> 00:18:08,440
subset of about<font color="#E5E5E5"> 15 rules that I'm going</font>

466
00:18:05,840 --> 00:18:10,520
<font color="#E5E5E5">to look each time now underneath that</font>

467
00:18:08,440 --> 00:18:12,350
there are other ones for different

468
00:18:10,520 --> 00:18:14,059
events for the<font color="#E5E5E5"> Forbes event where the</font>

469
00:18:12,350 --> 00:18:15,469
you know the Forbes breach happened and

470
00:18:14,059 --> 00:18:16,399
then a second one for<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Samsung pay</font>

471
00:18:15,470 --> 00:18:18,230
breach and so on everything that's

472
00:18:16,400 --> 00:18:20,270
associated with<font color="#E5E5E5"> that threat actor</font><font color="#CCCCCC"> that</font>

473
00:18:18,230 --> 00:18:22,640
I'm interested in and I want to<font color="#E5E5E5"> see when</font>

474
00:18:20,270 --> 00:18:24,440
I run it against files if I match on

475
00:18:22,640 --> 00:18:25,970
them with the metadata as we talked

476
00:18:24,440 --> 00:18:27,950
about earlier you organize your metadata

477
00:18:25,970 --> 00:18:29,929
so that when it fires off and you look

478
00:18:27,950 --> 00:18:31,130
at<font color="#CCCCCC"> your results it not only tells you</font>

479
00:18:29,929 --> 00:18:33,020
what it is<font color="#E5E5E5"> and where it is and why you</font>

480
00:18:31,130 --> 00:18:34,909
did it it also tells you what directives

481
00:18:33,020 --> 00:18:37,830
what file it's sitting in which helps

482
00:18:34,909 --> 00:18:42,510
when you have thousands<font color="#E5E5E5"> of rules</font>

483
00:18:37,830 --> 00:18:43,889
slime so<font color="#E5E5E5"> I thought this whole next</font>

484
00:18:42,510 --> 00:18:46,230
<font color="#E5E5E5">couple slides is all about rule</font>

485
00:18:43,890 --> 00:18:48,179
organization in rural order the order of

486
00:18:46,230 --> 00:18:50,220
rules is also important a lot of<font color="#E5E5E5"> people</font>

487
00:18:48,179 --> 00:18:51,360
create one gigantic monolithic file and

488
00:18:50,220 --> 00:18:52,740
they throw all the rules in it and they

489
00:18:51,360 --> 00:18:54,689
<font color="#E5E5E5">don't really care</font><font color="#CCCCCC"> what order they fire</font>

490
00:18:52,740 --> 00:18:55,950
off other<font color="#E5E5E5"> than I if I'm going to</font>

491
00:18:54,690 --> 00:18:57,840
reference<font color="#E5E5E5"> this I want to make sure that</font>

492
00:18:55,950 --> 00:18:59,760
I've pre you know I'd previously defined

493
00:18:57,840 --> 00:19:01,649
it but<font color="#CCCCCC"> sometimes you want</font><font color="#E5E5E5"> to know in</font>

494
00:18:59,760 --> 00:19:04,110
what order some rules had fired off you

495
00:19:01,649 --> 00:19:05,580
may have slight changes to 50 different

496
00:19:04,110 --> 00:19:07,908
rules and you're<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> for tiny</font>

497
00:19:05,580 --> 00:19:10,080
variations you can create kind of

498
00:19:07,909 --> 00:19:11,190
complicated condition lines or you can

499
00:19:10,080 --> 00:19:12,980
actually<font color="#E5E5E5"> separate them into different</font>

500
00:19:11,190 --> 00:19:15,120
<font color="#CCCCCC">rules and then watch when they fire off</font>

501
00:19:12,980 --> 00:19:16,409
so it can be very interesting<font color="#E5E5E5"> to play</font>

502
00:19:15,120 --> 00:19:19,379
<font color="#CCCCCC">with that</font><font color="#E5E5E5"> we have a little example</font><font color="#CCCCCC"> here</font>

503
00:19:16,409 --> 00:19:21,630
later go back go<font color="#E5E5E5"> back the other thing</font><font color="#CCCCCC"> is</font>

504
00:19:19,380 --> 00:19:22,830
there are different types of rules we

505
00:19:21,630 --> 00:19:24,179
didn't<font color="#E5E5E5"> touch on this earlier but there</font>

506
00:19:22,830 --> 00:19:25,830
are rules that you write and then there

507
00:19:24,179 --> 00:19:29,309
are private rules that you want<font color="#E5E5E5"> to match</font>

508
00:19:25,830 --> 00:19:30,779
or not match but not<font color="#E5E5E5"> really report back</font>

509
00:19:29,309 --> 00:19:32,580
<font color="#CCCCCC">to you you just want to use them</font><font color="#E5E5E5"> for as</font>

510
00:19:30,779 --> 00:19:34,049
an inclusion<font color="#CCCCCC"> in a different rule you</font>

511
00:19:32,580 --> 00:19:36,510
<font color="#E5E5E5">also have global rules which</font><font color="#CCCCCC"> you want to</font>

512
00:19:34,049 --> 00:19:37,769
<font color="#E5E5E5">apply to everything in your rule file so</font>

513
00:19:36,510 --> 00:19:39,779
in this case if<font color="#E5E5E5"> you only want to look at</font>

514
00:19:37,769 --> 00:19:41,880
PE files you may define a global rule

515
00:19:39,779 --> 00:19:43,019
that says hey only<font color="#CCCCCC"> look at</font><font color="#E5E5E5"> P files you</font>

516
00:19:41,880 --> 00:19:44,159
know this rule as long as it matches on

517
00:19:43,019 --> 00:19:46,139
<font color="#E5E5E5">P file its going to match against</font>

518
00:19:44,159 --> 00:19:48,179
everything else that you have<font color="#E5E5E5"> included</font>

519
00:19:46,139 --> 00:19:50,610
so all global rules will get processed

520
00:19:48,179 --> 00:19:52,740
first and a lot of those we use for

521
00:19:50,610 --> 00:19:54,178
things like p files or file size so<font color="#E5E5E5"> you</font>

522
00:19:52,740 --> 00:19:56,309
only want to look at in this run

523
00:19:54,179 --> 00:19:57,960
anything<font color="#CCCCCC"> under two megabytes great</font>

524
00:19:56,309 --> 00:20:00,330
define it<font color="#CCCCCC"> in a global rule so</font><font color="#E5E5E5"> you have</font>

525
00:19:57,960 --> 00:20:01,980
to find<font color="#E5E5E5"> out each individual rule so the</font>

526
00:20:00,330 --> 00:20:03,000
concept with the global rule is define

527
00:20:01,980 --> 00:20:05,220
it once and it's going<font color="#E5E5E5"> to apply to</font>

528
00:20:03,000 --> 00:20:07,049
<font color="#E5E5E5">everything private rules you define</font>

529
00:20:05,220 --> 00:20:08,010
something you want<font color="#E5E5E5"> to match on and then</font>

530
00:20:07,049 --> 00:20:09,809
<font color="#E5E5E5">you're going to use it later but you</font>

531
00:20:08,010 --> 00:20:11,519
<font color="#E5E5E5">don't want it to report back a lot</font><font color="#CCCCCC"> of</font>

532
00:20:09,809 --> 00:20:14,370
times you do that for heuristics you may

533
00:20:11,519 --> 00:20:15,990
only be interested in some files I'd

534
00:20:14,370 --> 00:20:18,059
only have particular sections or only

535
00:20:15,990 --> 00:20:19,590
have particular interesting strings it's

536
00:20:18,059 --> 00:20:21,178
<font color="#E5E5E5">really useful if you're doing in grand</font>

537
00:20:19,590 --> 00:20:22,408
matching with your yard so that you can

538
00:20:21,179 --> 00:20:24,000
match on certain in grams and look for

539
00:20:22,409 --> 00:20:26,309
that in combination but<font color="#E5E5E5"> you really don't</font>

540
00:20:24,000 --> 00:20:27,630
care if it just matched by itself it's

541
00:20:26,309 --> 00:20:31,260
kind<font color="#CCCCCC"> of a strategy to go with your rules</font>

542
00:20:27,630 --> 00:20:34,039
and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> next one now you can do some</font>

543
00:20:31,260 --> 00:20:36,629
rudimentary if then logic with rules and

544
00:20:34,039 --> 00:20:39,330
I really<font color="#E5E5E5"> want to mention this a lot of</font>

545
00:20:36,630 --> 00:20:40,559
times people also run<font color="#CCCCCC"> your ax once they</font>

546
00:20:39,330 --> 00:20:41,970
try<font color="#CCCCCC"> to shove everything in one big file</font>

547
00:20:40,559 --> 00:20:45,269
run<font color="#CCCCCC"> yaar once and they want to then</font>

548
00:20:41,970 --> 00:20:48,539
process the results it's<font color="#CCCCCC"> it's often more</font>

549
00:20:45,269 --> 00:20:49,889
optimal to split up your runs and run it

550
00:20:48,539 --> 00:20:51,580
multiple times<font color="#E5E5E5"> for different reasons</font>

551
00:20:49,889 --> 00:20:53,530
<font color="#CCCCCC">it's back</font><font color="#E5E5E5"> to your include</font>

552
00:20:51,580 --> 00:20:55,480
directive run<font color="#E5E5E5"> it once get initial</font>

553
00:20:53,530 --> 00:20:57,550
results run it again you know if we did

554
00:20:55,480 --> 00:20:59,200
this manually you would run one see what

555
00:20:57,550 --> 00:21:00,909
you needed change your your includes and

556
00:20:59,200 --> 00:21:02,680
then run that separate set and continue

557
00:21:00,910 --> 00:21:04,720
<font color="#CCCCCC">to hone and find out what you're looking</font>

558
00:21:02,680 --> 00:21:06,490
for it's really<font color="#CCCCCC"> good if you have unknown</font>

559
00:21:04,720 --> 00:21:08,050
files to run that kind<font color="#E5E5E5"> of strategy</font>

560
00:21:06,490 --> 00:21:10,660
because then you can parse things out

561
00:21:08,050 --> 00:21:12,520
and check and then refine that and then

562
00:21:10,660 --> 00:21:13,840
run it again and further get down to

563
00:21:12,520 --> 00:21:16,540
finding out what you have in your hands

564
00:21:13,840 --> 00:21:17,889
<font color="#CCCCCC">so just you can use it with</font><font color="#E5E5E5"> an lodging</font>

565
00:21:16,540 --> 00:21:19,270
any of the boolean logic I kind of broke

566
00:21:17,890 --> 00:21:22,030
it out<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> next slide</font><font color="#CCCCCC"> a little bit</font>

567
00:21:19,270 --> 00:21:24,100
where you<font color="#E5E5E5"> can't really see either but in</font>

568
00:21:22,030 --> 00:21:25,660
this one<font color="#CCCCCC"> I define a couple of private</font>

569
00:21:24,100 --> 00:21:28,120
rules at the top you know is<font color="#E5E5E5"> this a PE</font>

570
00:21:25,660 --> 00:21:30,580
file does it have different p sections

571
00:21:28,120 --> 00:21:31,810
you know there's roughly<font color="#CCCCCC"> 8 to 12 regular</font>

572
00:21:30,580 --> 00:21:33,310
sections you expect to see and there's

573
00:21:31,810 --> 00:21:34,960
some oddball sections that show up<font color="#E5E5E5"> for</font>

574
00:21:33,310 --> 00:21:36,970
different reasons this<font color="#E5E5E5"> rule would match</font>

575
00:21:34,960 --> 00:21:38,230
on that<font color="#E5E5E5"> and then more different</font><font color="#CCCCCC"> cider</font>

576
00:21:36,970 --> 00:21:39,750
<font color="#CCCCCC">ranges the things that I'm interested in</font>

577
00:21:38,230 --> 00:21:42,570
then I'm just going down different rules

578
00:21:39,750 --> 00:21:45,070
again you can't really<font color="#E5E5E5"> see</font><font color="#CCCCCC"> it but it's</font>

579
00:21:42,570 --> 00:21:47,020
there the idea is the one<font color="#E5E5E5"> that's got the</font>

580
00:21:45,070 --> 00:21:48,610
bracket first next to it at the top is

581
00:21:47,020 --> 00:21:50,500
about interesting strings that I'm

582
00:21:48,610 --> 00:21:51,790
looking for I don't care which<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of</font>

583
00:21:50,500 --> 00:21:54,010
those matches but I want it<font color="#CCCCCC"> to</font><font color="#E5E5E5"> match</font>

584
00:21:51,790 --> 00:21:56,230
with a PE file and one that has an

585
00:21:54,010 --> 00:21:57,250
oddball PE structure and the same<font color="#E5E5E5"> thing</font>

586
00:21:56,230 --> 00:21:58,780
for the<font color="#E5E5E5"> second one it does something</font>

587
00:21:57,250 --> 00:22:00,640
similar except with a cider range i'm

588
00:21:58,780 --> 00:22:03,370
looking for IP addresses embedded in a

589
00:22:00,640 --> 00:22:05,800
file in a certain range so just an idea

590
00:22:03,370 --> 00:22:07,389
how you might reorganize your your rule

591
00:22:05,800 --> 00:22:10,300
files to fire off in a certain order and

592
00:22:07,390 --> 00:22:12,640
in a certain way next one this one is

593
00:22:10,300 --> 00:22:14,320
just<font color="#CCCCCC"> an</font><font color="#E5E5E5"> example of an not it's the same</font>

594
00:22:12,640 --> 00:22:16,510
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> as before and here's another</font>

595
00:22:14,320 --> 00:22:19,120
snapshot of rule organization you know

596
00:22:16,510 --> 00:22:23,080
<font color="#E5E5E5">again same kind of things private rules</font>

597
00:22:19,120 --> 00:22:24,459
at the top you<font color="#E5E5E5"> know this is</font><font color="#CCCCCC"> PE different</font>

598
00:22:23,080 --> 00:22:26,260
p sections that kind of thing and<font color="#E5E5E5"> then</font>

599
00:22:24,460 --> 00:22:29,200
going<font color="#CCCCCC"> down for</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> and you can't see it</font>

600
00:22:26,260 --> 00:22:31,150
which really you know it<font color="#CCCCCC"> looks at things</font>

601
00:22:29,200 --> 00:22:32,710
and says hey I want to<font color="#E5E5E5"> find certain rule</font>

602
00:22:31,150 --> 00:22:34,420
on what certain rules to fire I<font color="#E5E5E5"> want</font>

603
00:22:32,710 --> 00:22:35,950
certain things to match inside the core

604
00:22:34,420 --> 00:22:37,960
rule but I want other<font color="#E5E5E5"> things not</font><font color="#CCCCCC"> to</font>

605
00:22:35,950 --> 00:22:41,590
match and so you can<font color="#E5E5E5"> kind of get a</font>

606
00:22:37,960 --> 00:22:44,020
combination going right so just<font color="#E5E5E5"> a side</font>

607
00:22:41,590 --> 00:22:46,620
note after the talk i<font color="#CCCCCC"> will upload this</font>

608
00:22:44,020 --> 00:22:48,760
up on SlideShare and post it out so

609
00:22:46,620 --> 00:22:50,290
you'll be<font color="#E5E5E5"> able to see much better what</font>

610
00:22:48,760 --> 00:22:52,330
we're talking about up<font color="#CCCCCC"> here and also</font>

611
00:22:50,290 --> 00:22:53,500
from the<font color="#E5E5E5"> the references lake i mentioned</font>

612
00:22:52,330 --> 00:22:54,610
earlier you'll be able to see all those

613
00:22:53,500 --> 00:22:55,840
different ways i'm not expecting you

614
00:22:54,610 --> 00:22:58,110
guys to<font color="#E5E5E5"> write this stuff down this is</font>

615
00:22:55,840 --> 00:23:01,480
just these are talking<font color="#CCCCCC"> points for us so</font>

616
00:22:58,110 --> 00:23:02,919
anyways Monty that's fine going<font color="#CCCCCC"> we'll</font>

617
00:23:01,480 --> 00:23:05,230
give you some<font color="#CCCCCC"> snapshots of what it looks</font>

618
00:23:02,920 --> 00:23:07,090
like I mean<font color="#E5E5E5"> your itself is not</font>

619
00:23:05,230 --> 00:23:09,549
ready it's not meant to<font color="#CCCCCC"> be it's very</font>

620
00:23:07,090 --> 00:23:11,230
<font color="#E5E5E5">simple very very good structure this is</font>

621
00:23:09,549 --> 00:23:13,540
just a snapshot of what it looks like it

622
00:23:11,230 --> 00:23:14,620
<font color="#CCCCCC">command-line you'll notice there's a lot</font>

623
00:23:13,540 --> 00:23:16,720
of<font color="#CCCCCC"> different switches and this is</font>

624
00:23:14,620 --> 00:23:17,799
actually visible thankfully where you

625
00:23:16,720 --> 00:23:19,960
can run everything's you can have a

626
00:23:17,799 --> 00:23:21,580
return the rule name with the<font color="#E5E5E5"> right</font>

627
00:23:19,960 --> 00:23:23,590
<font color="#E5E5E5">switch you can ever turn just a metadata</font>

628
00:23:21,580 --> 00:23:25,270
with the right switch and you might want

629
00:23:23,590 --> 00:23:27,189
<font color="#E5E5E5">to do that in tandem you might want to</font>

630
00:23:25,270 --> 00:23:28,540
do that<font color="#E5E5E5"> on different runs you'll have to</font>

631
00:23:27,190 --> 00:23:33,820
figure<font color="#E5E5E5"> out a good strategy in which to</font>

632
00:23:28,540 --> 00:23:35,918
use it and<font color="#CCCCCC"> this next was just a snapshot</font>

633
00:23:33,820 --> 00:23:38,350
I've been matching on different rules so

634
00:23:35,919 --> 00:23:40,510
from our previous example i ran a file

635
00:23:38,350 --> 00:23:43,059
against it recovery got back and I ran

636
00:23:40,510 --> 00:23:44,590
my main rule file with a lot of include

637
00:23:43,059 --> 00:23:46,059
directives to see what would match on it

638
00:23:44,590 --> 00:23:47,470
and it came<font color="#CCCCCC"> back with a variety of</font>

639
00:23:46,059 --> 00:23:50,889
things in<font color="#E5E5E5"> this case a couple zero-day</font>

640
00:23:47,470 --> 00:23:52,510
matches<font color="#CCCCCC"> and couple other items that</font><font color="#E5E5E5"> you</font>

641
00:23:50,890 --> 00:23:54,880
know<font color="#CCCCCC"> I would then follow up with a fine</font>

642
00:23:52,510 --> 00:23:57,190
interesting and pursue with whatever

643
00:23:54,880 --> 00:23:58,660
real strategy i'm using<font color="#CCCCCC"> okay and keep in</font>

644
00:23:57,190 --> 00:24:00,880
mind to it obviously these are windows

645
00:23:58,660 --> 00:24:04,750
boxes yarra will run on multiple

646
00:24:00,880 --> 00:24:06,370
platforms linux mac windows etc just I

647
00:24:04,750 --> 00:24:08,070
think<font color="#CCCCCC"> money</font><font color="#E5E5E5"> you just</font><font color="#CCCCCC"> had a windows box</font>

648
00:24:06,370 --> 00:24:13,299
handy when you did these screenshots

649
00:24:08,070 --> 00:24:17,110
yeah<font color="#E5E5E5"> Louis Louis coming on them yes</font><font color="#CCCCCC"> okay</font>

650
00:24:13,299 --> 00:24:19,150
so there are a lot of resources out

651
00:24:17,110 --> 00:24:21,549
there you know to kind of help you<font color="#E5E5E5"> get</font>

652
00:24:19,150 --> 00:24:23,610
started if you've been doing it for a

653
00:24:21,549 --> 00:24:25,990
while<font color="#CCCCCC"> or if you're just getting started</font>

654
00:24:23,610 --> 00:24:28,659
she's just<font color="#CCCCCC"> getting started yard Jen it's</font>

655
00:24:25,990 --> 00:24:30,010
kind of a nice<font color="#E5E5E5"> tool I use this one a</font>

656
00:24:28,660 --> 00:24:32,679
<font color="#E5E5E5">couple years ago when i did my first</font>

657
00:24:30,010 --> 00:24:35,500
<font color="#E5E5E5">rule it's written by florian roth who</font>

658
00:24:32,679 --> 00:24:39,610
he's also got a number of great

659
00:24:35,500 --> 00:24:42,490
<font color="#E5E5E5">references up on github and pretty</font>

660
00:24:39,610 --> 00:24:45,340
active<font color="#E5E5E5"> in the community so what is your</font>

661
00:24:42,490 --> 00:24:47,830
gen do it allows you to just create some

662
00:24:45,340 --> 00:24:50,470
basic<font color="#E5E5E5"> yaar rules from strings in an</font>

663
00:24:47,830 --> 00:24:52,710
automated fashion and it will use<font color="#CCCCCC"> some</font>

664
00:24:50,470 --> 00:24:54,850
bayesian classifiers to help you

665
00:24:52,710 --> 00:24:57,280
classify the string<font color="#CCCCCC"> to detect useful</font>

666
00:24:54,850 --> 00:24:59,649
words and it will extract also can

667
00:24:57,280 --> 00:25:02,500
extract opcode elements from the text

668
00:24:59,650 --> 00:25:04,990
section of a PE file where<font color="#CCCCCC"> I use this</font>

669
00:25:02,500 --> 00:25:07,929
actually was to help me identify some

670
00:25:04,990 --> 00:25:09,100
strings and you know returned a giant

671
00:25:07,929 --> 00:25:11,140
list of different strings were available

672
00:25:09,100 --> 00:25:15,158
to me and I ran it across several

673
00:25:11,140 --> 00:25:16,330
samples and that allowed me to find in

674
00:25:15,159 --> 00:25:17,539
<font color="#E5E5E5">this case</font><font color="#CCCCCC"> i think i was looking at</font>

675
00:25:16,330 --> 00:25:19,759
cryptolocker

676
00:25:17,539 --> 00:25:21,200
<font color="#E5E5E5">version1 it allowed me to find a bunch</font>

677
00:25:19,759 --> 00:25:23,869
of common string between the different

678
00:25:21,200 --> 00:25:26,119
samples to create one good solid master

679
00:25:23,869 --> 00:25:28,580
rule and I was<font color="#E5E5E5"> looking for fairly unique</font>

680
00:25:26,119 --> 00:25:30,228
strengths I think in this case there

681
00:25:28,580 --> 00:25:32,509
were some file paths that started like

682
00:25:30,229 --> 00:25:34,309
with<font color="#E5E5E5"> Z you know colon it was some</font>

683
00:25:32,509 --> 00:25:36,350
project directory that they had so I

684
00:25:34,309 --> 00:25:38,029
that was one<font color="#CCCCCC"> of them are used and I</font>

685
00:25:36,350 --> 00:25:39,859
cameras been a while now since I've done

686
00:25:38,029 --> 00:25:41,629
<font color="#E5E5E5">it but there were a number you know</font>

687
00:25:39,859 --> 00:25:43,970
fairly unique dreams I<font color="#E5E5E5"> tried to grab</font>

688
00:25:41,629 --> 00:25:48,408
probably about five or<font color="#E5E5E5"> six of them to</font>

689
00:25:43,970 --> 00:25:50,059
throw in there and there's also finally

690
00:25:48,409 --> 00:25:54,649
I think you had to comment on<font color="#CCCCCC"> that one</font>

691
00:25:50,059 --> 00:25:56,119
Monty if you're like most socks are in

692
00:25:54,649 --> 00:25:58,309
you know folks intensity response teams

693
00:25:56,119 --> 00:26:00,139
you don't have a lot<font color="#CCCCCC"> of time the origin</font>

694
00:25:58,309 --> 00:26:02,178
can save you a lot of effort and give

695
00:26:00,139 --> 00:26:04,129
you a good starting point so if you only

696
00:26:02,179 --> 00:26:06,590
have so much time to craft rules then

697
00:26:04,129 --> 00:26:09,168
you have to<font color="#E5E5E5"> look at 100 200 500 thousand</font>

698
00:26:06,590 --> 00:26:10,668
files you can run yards in against all

699
00:26:09,169 --> 00:26:12,739
of them<font color="#E5E5E5"> and get a good starting point</font>

700
00:26:10,669 --> 00:26:14,479
where the<font color="#E5E5E5"> RL to match it looks at things</font>

701
00:26:12,739 --> 00:26:16,460
individually and it also be grouping

702
00:26:14,479 --> 00:26:18,349
it'll give you a good rule where it can

703
00:26:16,460 --> 00:26:20,899
so just feed it a couple<font color="#E5E5E5"> hundred files</font>

704
00:26:18,349 --> 00:26:23,149
it will spit out individual rules as

705
00:26:20,899 --> 00:26:25,580
well as rules for each group<font color="#CCCCCC"> that it can</font>

706
00:26:23,149 --> 00:26:27,498
find which can be useful again if you

707
00:26:25,580 --> 00:26:29,840
<font color="#CCCCCC">have it time to be useful but yeah it</font>

708
00:26:27,499 --> 00:26:31,639
can also create some noise right boys

709
00:26:29,840 --> 00:26:32,779
it's good to do like a check so you make

710
00:26:31,639 --> 00:26:34,728
craft your own rule and if you have

711
00:26:32,779 --> 00:26:36,169
enough time run that as well and<font color="#E5E5E5"> look at</font>

712
00:26:34,729 --> 00:26:38,359
the differences between the two<font color="#E5E5E5"> because</font>

713
00:26:36,169 --> 00:26:40,940
its selection logic is pretty good and

714
00:26:38,359 --> 00:26:42,978
it's constantly being tuned so it can<font color="#E5E5E5"> be</font>

715
00:26:40,940 --> 00:26:44,359
a good quality check<font color="#CCCCCC"> for something</font>

716
00:26:42,979 --> 00:26:46,609
you've written or a starting point if

717
00:26:44,359 --> 00:26:48,949
you<font color="#CCCCCC"> have a lack of time and you need to</font>

718
00:26:46,609 --> 00:26:50,418
actually generate real quickly yep and

719
00:26:48,950 --> 00:26:52,249
you'll see in the notes on<font color="#E5E5E5"> this slide I</font>

720
00:26:50,419 --> 00:26:54,889
actually have the two links for yard<font color="#E5E5E5"> gin</font>

721
00:26:52,249 --> 00:26:56,359
and for binary they're also at the end

722
00:26:54,889 --> 00:26:57,949
of<font color="#E5E5E5"> the deck but you know as you go</font>

723
00:26:56,359 --> 00:26:59,840
through definitely you know we do have

724
00:26:57,950 --> 00:27:02,479
<font color="#E5E5E5">some real basic crude notes in the in</font>

725
00:26:59,840 --> 00:27:08,238
the the presentation<font color="#CCCCCC"> but just</font><font color="#E5E5E5"> something</font>

726
00:27:02,479 --> 00:27:10,340
to keep in mind um ya know binary<font color="#E5E5E5"> is</font>

727
00:27:08,239 --> 00:27:12,229
kind of a new ad in<font color="#E5E5E5"> it's a tool you can</font>

728
00:27:10,340 --> 00:27:13,939
use to search you for chunks of code

729
00:27:12,229 --> 00:27:15,739
that you can pull out<font color="#CCCCCC"> of files can be</font>

730
00:27:13,940 --> 00:27:17,239
useful to figure out what what that

731
00:27:15,739 --> 00:27:19,140
actually is referring<font color="#CCCCCC"> to and also to</font>

732
00:27:17,239 --> 00:27:20,950
determine if that's a good match

733
00:27:19,140 --> 00:27:23,020
especially useful if you're creating

734
00:27:20,950 --> 00:27:24,520
rules just from memory or if you're<font color="#E5E5E5"> just</font>

735
00:27:23,020 --> 00:27:25,930
looking at something you<font color="#E5E5E5"> want to be</font><font color="#CCCCCC"> very</font>

736
00:27:24,520 --> 00:27:28,090
selective and only looking for certain

737
00:27:25,930 --> 00:27:29,980
algorithms within files great thing to

738
00:27:28,090 --> 00:27:31,570
use<font color="#E5E5E5"> to try to figure that out if you</font>

739
00:27:29,980 --> 00:27:33,760
haven't toured with it it's free you can

740
00:27:31,570 --> 00:27:38,399
get on there register ascension AP ikea

741
00:27:33,760 --> 00:27:40,900
that<font color="#E5E5E5"> you can use in leverage</font><font color="#CCCCCC"> okay so</font>

742
00:27:38,400 --> 00:27:42,940
another great resource this is a

743
00:27:40,900 --> 00:27:45,250
<font color="#CCCCCC">invitation-only group it's called the</font>

744
00:27:42,940 --> 00:27:47,760
<font color="#CCCCCC">yarra exchange is there anybody here</font>

745
00:27:45,250 --> 00:27:52,210
that the member just out of curiosity

746
00:27:47,760 --> 00:27:55,420
it's just you guys<font color="#E5E5E5"> okay great resource</font>

747
00:27:52,210 --> 00:27:58,330
uh you see the contact link there<font color="#E5E5E5"> you</font>

748
00:27:55,420 --> 00:28:01,240
can contact them they will check<font color="#E5E5E5"> you out</font>

749
00:27:58,330 --> 00:28:02,889
and<font color="#E5E5E5"> all</font><font color="#CCCCCC"> that kind of good stuff and it's</font>

750
00:28:01,240 --> 00:28:05,190
actually<font color="#CCCCCC"> a really good form they do some</font>

751
00:28:02,890 --> 00:28:10,930
meetups that it's a blackhead or<font color="#CCCCCC"> DEFCON</font>

752
00:28:05,190 --> 00:28:15,250
black hat<font color="#E5E5E5"> okay I heard I heard I don't</font>

753
00:28:10,930 --> 00:28:16,480
do Vegas so but anyways the ER contains

754
00:28:15,250 --> 00:28:18,370
a lot of great information a lot of

755
00:28:16,480 --> 00:28:19,630
<font color="#E5E5E5">people</font><font color="#CCCCCC"> really trying just like with</font>

756
00:28:18,370 --> 00:28:21,550
besides just a lot of<font color="#E5E5E5"> people trying to</font>

757
00:28:19,630 --> 00:28:24,700
help each other out<font color="#E5E5E5"> and a really</font><font color="#CCCCCC"> good</font>

758
00:28:21,550 --> 00:28:26,800
good<font color="#CCCCCC"> form i know they had is is the</font>

759
00:28:24,700 --> 00:28:29,140
slack thing still going or is it yeah

760
00:28:26,800 --> 00:28:31,690
okay<font color="#E5E5E5"> so there's kind of a blend of the</font>

761
00:28:29,140 --> 00:28:38,560
email group in and the slack group as

762
00:28:31,690 --> 00:28:40,630
well so yeah every day right yeah this

763
00:28:38,560 --> 00:28:42,010
is not a not a passive group you know<font color="#E5E5E5"> if</font>

764
00:28:40,630 --> 00:28:43,810
you<font color="#CCCCCC"> if you want to be involved</font><font color="#E5E5E5"> with it</font>

765
00:28:42,010 --> 00:28:44,950
they<font color="#E5E5E5"> want you contributing they don't</font>

766
00:28:43,810 --> 00:28:47,679
<font color="#E5E5E5">want you just sitting</font><font color="#CCCCCC"> there lurking in</font>

767
00:28:44,950 --> 00:28:51,880
the background and and not participating

768
00:28:47,680 --> 00:28:54,310
so and in the shameless plug category we

769
00:28:51,880 --> 00:28:56,980
do have some yarrow rules up on my

770
00:28:54,310 --> 00:29:00,669
<font color="#E5E5E5">company site fidelis it's actually</font>

771
00:28:56,980 --> 00:29:03,010
hosted up a target we have a github page

772
00:29:00,670 --> 00:29:05,830
we also<font color="#E5E5E5"> have some some of our reports</font>

773
00:29:03,010 --> 00:29:09,540
and things up there as well so just just

774
00:29:05,830 --> 00:29:09,540
a more thing to kind of point out and

775
00:29:09,600 --> 00:29:13,990
yes references so we've got about two or

776
00:29:12,340 --> 00:29:14,889
three slides<font color="#CCCCCC"> I know it's probably a</font>

777
00:29:13,990 --> 00:29:16,990
little bit difficult to see the

778
00:29:14,890 --> 00:29:18,250
<font color="#E5E5E5">references from here but these are just</font>

779
00:29:16,990 --> 00:29:21,880
<font color="#E5E5E5">some of the things we talked about here</font>

780
00:29:18,250 --> 00:29:24,370
so you can see<font color="#E5E5E5"> the the the yard rules</font>

781
00:29:21,880 --> 00:29:27,130
and yard gain etc so I won't<font color="#E5E5E5"> belabor</font>

782
00:29:24,370 --> 00:29:29,649
that point Monty did you have anything

783
00:29:27,130 --> 00:29:31,610
you wanted to add in here<font color="#E5E5E5"> okay all right</font>

784
00:29:29,650 --> 00:29:36,580
at<font color="#E5E5E5"> this point we'll open up the</font>

785
00:29:31,610 --> 00:29:36,580
or to any questions comments thoughts

786
00:29:40,120 --> 00:29:47,120
malware good we're or to break it

787
00:29:44,090 --> 00:29:50,270
down<font color="#E5E5E5"> with like a particular family of</font>

788
00:29:47,120 --> 00:29:52,549
malware<font color="#E5E5E5"> versus everything else so you</font>

789
00:29:50,270 --> 00:29:56,510
get more specific rules the derelict on

790
00:29:52,549 --> 00:29:59,090
that I used the good and bad together I

791
00:29:56,510 --> 00:30:00,230
find that's most effective for me there

792
00:29:59,090 --> 00:30:01,610
are<font color="#CCCCCC"> other folks</font><font color="#E5E5E5"> of you different</font>

793
00:30:00,230 --> 00:30:05,750
strategies but that's the one that<font color="#E5E5E5"> I</font>

794
00:30:01,610 --> 00:30:14,330
found works best<font color="#CCCCCC"> okay any other</font>

795
00:30:05,750 --> 00:30:16,280
questions right here in front it really

796
00:30:14,330 --> 00:30:18,649
depends on<font color="#E5E5E5"> the the corpus of rules that</font>

797
00:30:16,280 --> 00:30:20,690
you have you know you know your

798
00:30:18,650 --> 00:30:22,100
customers better than than anyone else

799
00:30:20,690 --> 00:30:25,549
<font color="#E5E5E5">and the types of customers that you have</font>

800
00:30:22,100 --> 00:30:26,928
so if you're<font color="#E5E5E5"> looking for you know just</font>

801
00:30:25,549 --> 00:30:28,460
kind of<font color="#E5E5E5"> Lee in my background we have to</font>

802
00:30:26,929 --> 00:30:30,620
do a<font color="#E5E5E5"> lot of large-scale credit card</font>

803
00:30:28,460 --> 00:30:32,360
breaches so if i had a corpus rule they

804
00:30:30,620 --> 00:30:34,668
were<font color="#E5E5E5"> very specific towards that i might</font>

805
00:30:32,360 --> 00:30:37,159
do that very early if I have a really

806
00:30:34,669 --> 00:30:40,280
targeted set of data and just just kind

807
00:30:37,160 --> 00:30:42,830
of have<font color="#CCCCCC"> it running in the background</font><font color="#E5E5E5"> you</font>

808
00:30:40,280 --> 00:30:44,059
know if you're if you're fishing you

809
00:30:42,830 --> 00:30:45,918
know<font color="#E5E5E5"> it's probably something that you</font>

810
00:30:44,059 --> 00:30:47,360
want<font color="#E5E5E5"> to do kind of later on if you're</font>

811
00:30:45,919 --> 00:30:51,080
looking for you know some needles in the

812
00:30:47,360 --> 00:30:52,549
haystack<font color="#E5E5E5"> okay like us I was going to add</font>

813
00:30:51,080 --> 00:30:54,379
on today so it kind of depends on<font color="#E5E5E5"> what</font>

814
00:30:52,549 --> 00:30:55,879
kind of Investigation doing as well if

815
00:30:54,380 --> 00:30:58,429
they have a<font color="#E5E5E5"> lot of Internet amazing you</font>

816
00:30:55,880 --> 00:31:01,160
have<font color="#E5E5E5"> to search using a jar with a web</font>

817
00:30:58,429 --> 00:31:02,570
<font color="#CCCCCC">can turn could be</font><font color="#E5E5E5"> useful to be quick if</font>

818
00:31:01,160 --> 00:31:04,490
<font color="#CCCCCC">they have you know issues we have</font><font color="#E5E5E5"> to go</font>

819
00:31:02,570 --> 00:31:06,710
through gigs of email the author can

820
00:31:04,490 --> 00:31:07,880
help you process I really<font color="#CCCCCC"> fast for other</font>

821
00:31:06,710 --> 00:31:09,830
tools as well but I mean<font color="#CCCCCC"> if you've</font>

822
00:31:07,880 --> 00:31:11,809
already crafted them and you're trying

823
00:31:09,830 --> 00:31:14,299
to respond and look through like 10 gigs

824
00:31:11,809 --> 00:31:16,010
you know it can be<font color="#E5E5E5"> really good for to do</font>

825
00:31:14,299 --> 00:31:18,139
that<font color="#CCCCCC"> kick off and deal with something</font>

826
00:31:16,010 --> 00:31:19,669
<font color="#E5E5E5">else initially a lot of times after you</font>

827
00:31:18,140 --> 00:31:21,290
put your hands on files that's when<font color="#CCCCCC"> you</font>

828
00:31:19,669 --> 00:31:22,520
craft your er that's what if<font color="#CCCCCC"> I use it to</font>

829
00:31:21,290 --> 00:31:25,190
look across the<font color="#E5E5E5"> network for the files</font>

830
00:31:22,520 --> 00:31:26,570
just depends<font color="#E5E5E5"> on what you use yeah I mean</font>

831
00:31:25,190 --> 00:31:28,010
it's really<font color="#E5E5E5"> just like keyword searching</font>

832
00:31:26,570 --> 00:31:29,840
right you start out with a fairly vague

833
00:31:28,010 --> 00:31:31,940
set and then<font color="#E5E5E5"> you start to refine it as</font>

834
00:31:29,840 --> 00:31:35,449
you learn<font color="#CCCCCC"> more about the the incident</font>

835
00:31:31,940 --> 00:31:36,740
response so it's<font color="#E5E5E5"> not really just to run</font>

836
00:31:35,450 --> 00:31:39,350
it here at this part of the

837
00:31:36,740 --> 00:31:42,250
investigation and then you know it's

838
00:31:39,350 --> 00:31:42,250
it's a continual process

839
00:31:42,550 --> 00:31:47,750
yes yeah there's some on the the ER

840
00:31:45,410 --> 00:31:50,360
exchange site I think<font color="#E5E5E5"> Florian Roth has</font>

841
00:31:47,750 --> 00:31:52,910
some up on his github page and there's

842
00:31:50,360 --> 00:31:54,620
others out there as well just be careful

843
00:31:52,910 --> 00:31:56,660
<font color="#CCCCCC">using you have to understand why they</font>

844
00:31:54,620 --> 00:31:58,040
wrote in the first place ended up they

845
00:31:56,660 --> 00:31:59,780
voted against the sample that was in the

846
00:31:58,040 --> 00:32:02,389
wild or a sample be the<font color="#CCCCCC"> audion raftam</font>

847
00:31:59,780 --> 00:32:04,490
include up and it's perfectly poised to

848
00:32:02,390 --> 00:32:05,780
match and oftentimes that's not what you

849
00:32:04,490 --> 00:32:07,010
guys see<font color="#CCCCCC"> going to see how</font><font color="#E5E5E5"> it is in the</font>

850
00:32:05,780 --> 00:32:09,139
wild it's probably harder than<font color="#CCCCCC"> Sun</font>

851
00:32:07,010 --> 00:32:11,300
fashion and you won't get<font color="#E5E5E5"> a match when</font>

852
00:32:09,140 --> 00:32:12,650
you expect you then you have a perfectly

853
00:32:11,300 --> 00:32:14,510
good rule it's just targeted at the

854
00:32:12,650 --> 00:32:16,160
wrong thing<font color="#E5E5E5"> right i mean if the packers</font>

855
00:32:14,510 --> 00:32:17,510
encryption you know that all that fun

856
00:32:16,160 --> 00:32:19,010
stuff yeah you know you have<font color="#E5E5E5"> to know</font>

857
00:32:17,510 --> 00:32:21,050
we're in<font color="#E5E5E5"> the process they're using it</font>

858
00:32:19,010 --> 00:32:25,850
you know to handle<font color="#E5E5E5"> that so i think i saw</font>

859
00:32:21,050 --> 00:32:27,860
a hand over here if you don't like hair

860
00:32:25,850 --> 00:32:29,419
where the<font color="#E5E5E5"> click if your dl file for</font>

861
00:32:27,860 --> 00:32:32,120
instance they let me through in what you

862
00:32:29,420 --> 00:32:34,040
want to find out<font color="#CCCCCC"> is was there a</font><font color="#E5E5E5"> call</font>

863
00:32:32,120 --> 00:32:37,219
reporting to try to enjoy as well is

864
00:32:34,040 --> 00:32:39,260
there a way to just see if they try<font color="#E5E5E5"> to</font>

865
00:32:37,220 --> 00:32:41,300
make that call in<font color="#E5E5E5"> the file rather than</font>

866
00:32:39,260 --> 00:32:44,450
actually having to have<font color="#CCCCCC"> a surface of</font>

867
00:32:41,300 --> 00:32:46,159
easy true statement in those sorts so

868
00:32:44,450 --> 00:32:47,420
there are modules ago with Yara and one

869
00:32:46,160 --> 00:32:49,190
of us a cuckoo module<font color="#E5E5E5"> and you can write</font>

870
00:32:47,420 --> 00:32:54,310
it to look for<font color="#E5E5E5"> it would do a</font><font color="#CCCCCC"> DNS call</font>

871
00:32:49,190 --> 00:32:54,310
out absolutely and get matching that way

872
00:32:54,550 --> 00:32:58,430
<font color="#E5E5E5">if you go to the root yard I'll read the</font>

873
00:32:56,870 --> 00:33:00,229
docs it's going<font color="#E5E5E5"> to talk about all the</font>

874
00:32:58,430 --> 00:33:01,520
different modules as well<font color="#E5E5E5"> their variety</font>

875
00:33:00,230 --> 00:33:03,410
enables kind of beyond what we want to

876
00:33:01,520 --> 00:33:05,090
touch on here but you can do let me

877
00:33:03,410 --> 00:33:06,800
there's a math module there's a cooper

878
00:33:05,090 --> 00:33:07,909
module there's p model there's a lot of

879
00:33:06,800 --> 00:33:09,919
extra modules ahead of their

880
00:33:07,910 --> 00:33:11,720
functionality you can look for<font color="#E5E5E5"> probably</font>

881
00:33:09,920 --> 00:33:15,440
<font color="#E5E5E5">everything looking for especially when</font>

882
00:33:11,720 --> 00:33:16,940
it comes to<font color="#CCCCCC"> dns a lot of different calls</font>

883
00:33:15,440 --> 00:33:18,170
can be tracked without having<font color="#CCCCCC"> to go</font>

884
00:33:16,940 --> 00:33:20,660
through the process of learning to talk

885
00:33:18,170 --> 00:33:22,160
out yeah and i can remember having set

886
00:33:20,660 --> 00:33:23,570
up coo coo couple years ago that was

887
00:33:22,160 --> 00:33:25,310
actually where i got introduced to<font color="#E5E5E5"> yara</font>

888
00:33:23,570 --> 00:33:27,139
so i can remember you know through<font color="#E5E5E5"> the</font>

889
00:33:25,310 --> 00:33:28,760
cuckoo<font color="#CCCCCC"> dock that</font><font color="#E5E5E5"> they talked about you</font>

890
00:33:27,140 --> 00:33:29,990
know installing yar and setting up your

891
00:33:28,760 --> 00:33:34,930
rules in there as well as part of the

892
00:33:29,990 --> 00:33:34,930
the cuckoo process so okay anybody else

893
00:33:38,730 --> 00:33:44,289
is there any sort of static analysis

894
00:33:40,929 --> 00:33:46,450
unpacker two legs or under samples

895
00:33:44,289 --> 00:33:51,000
through before you<font color="#E5E5E5"> start applying</font>

896
00:33:46,450 --> 00:33:54,700
<font color="#E5E5E5">garrison you know there is the</font><font color="#CCCCCC"> PE ID</font>

897
00:33:51,000 --> 00:34:00,039
module it's fairly depth dated at this

898
00:33:54,700 --> 00:34:01,630
point right<font color="#E5E5E5"> i mean but that I mean</font>

899
00:34:00,039 --> 00:34:04,600
<font color="#E5E5E5">that's kind of the first step obviously</font>

900
00:34:01,630 --> 00:34:06,909
so you know it would just be the normal

901
00:34:04,600 --> 00:34:08,770
you<font color="#CCCCCC"> know using</font><font color="#E5E5E5"> whatever tools you know</font>

902
00:34:06,909 --> 00:34:10,659
you would want<font color="#E5E5E5"> to go in and decrypt your</font>

903
00:34:08,770 --> 00:34:13,719
file or on packet and and starting from

904
00:34:10,659 --> 00:34:15,280
there so you know it's<font color="#CCCCCC"> really just a</font>

905
00:34:13,719 --> 00:34:18,520
little you know search when you go

906
00:34:15,280 --> 00:34:19,659
through some I mean use yard a lot of

907
00:34:18,520 --> 00:34:21,580
ways you could use<font color="#E5E5E5"> our to detect</font>

908
00:34:19,659 --> 00:34:23,440
different types of<font color="#CCCCCC"> Packers like that and</font>

909
00:34:21,580 --> 00:34:24,609
then taking taking action from that

910
00:34:23,440 --> 00:34:26,879
point are<font color="#E5E5E5"> you looking</font><font color="#CCCCCC"> for a tool that</font>

911
00:34:24,609 --> 00:34:29,290
will actually help you unpack yeah okay

912
00:34:26,879 --> 00:34:31,389
we<font color="#E5E5E5"> can talk afterwards I probably better</font>

913
00:34:29,290 --> 00:34:33,159
for<font color="#E5E5E5"> this</font><font color="#CCCCCC"> okay so we</font><font color="#E5E5E5"> can stay focused on</font>

914
00:34:31,389 --> 00:34:34,629
yard that's kind of with you are there's

915
00:34:33,159 --> 00:34:35,859
things<font color="#E5E5E5"> you view beforehand and members</font>

916
00:34:34,629 --> 00:34:37,449
think you after and this is one of those

917
00:34:35,859 --> 00:34:39,129
things you get beforehand before you

918
00:34:37,449 --> 00:34:41,589
actually get into writing<font color="#E5E5E5"> the rule but</font>

919
00:34:39,129 --> 00:34:43,569
if you unpacked first you can apply your

920
00:34:41,589 --> 00:34:46,119
a signature that you know might<font color="#CCCCCC"> be</font>

921
00:34:43,570 --> 00:34:47,589
useful yes<font color="#CCCCCC"> ma'am that's what I was</font>

922
00:34:46,119 --> 00:34:50,260
saying in the wild it's probably packed

923
00:34:47,589 --> 00:34:51,820
<font color="#E5E5E5">on there that you know I've stated all</font>

924
00:34:50,260 --> 00:34:53,260
that other stuff<font color="#E5E5E5"> you might want to write</font>

925
00:34:51,820 --> 00:34:54,580
in your yard world just for<font color="#CCCCCC"> that and</font>

926
00:34:53,260 --> 00:34:57,070
then write a separate one for when it's

927
00:34:54,580 --> 00:34:58,960
not right generally we write both so you

928
00:34:57,070 --> 00:35:00,310
can match it when it's out in the wild

929
00:34:58,960 --> 00:35:01,720
somewhere it's going<font color="#E5E5E5"> to be looking</font>

930
00:35:00,310 --> 00:35:03,609
different from after you've unpacked it

931
00:35:01,720 --> 00:35:04,959
we cleaned it up then you want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> walk</font>

932
00:35:03,609 --> 00:35:06,490
me and you might want<font color="#E5E5E5"> to match on that</font>

933
00:35:04,960 --> 00:35:09,040
<font color="#E5E5E5">which might be more representative</font>

934
00:35:06,490 --> 00:35:10,660
memory or not it<font color="#CCCCCC"> just depends</font><font color="#E5E5E5"> on how it</font>

935
00:35:09,040 --> 00:35:13,420
presents itself everyone's a little

936
00:35:10,660 --> 00:35:16,020
different<font color="#E5E5E5"> okay there was another</font>

937
00:35:13,420 --> 00:35:16,020
<font color="#E5E5E5">question over here</font>

938
00:35:20,370 --> 00:35:26,160
I mean I mean<font color="#CCCCCC"> there's a lot of products</font>

939
00:35:23,760 --> 00:35:27,780
out there I mean<font color="#E5E5E5"> Mike yeah shameless</font>

940
00:35:26,160 --> 00:35:32,279
plug my company has<font color="#E5E5E5"> an integrated within</font>

941
00:35:27,780 --> 00:35:34,320
our product I believe<font color="#CCCCCC"> that the the ER</font>

942
00:35:32,280 --> 00:35:36,840
page itself has a list of companies that

943
00:35:34,320 --> 00:35:38,220
<font color="#E5E5E5">are using it in commercial products</font><font color="#CCCCCC"> and</font>

944
00:35:36,840 --> 00:35:39,600
I'm sure there's obviously going to be a

945
00:35:38,220 --> 00:35:42,060
lot<font color="#E5E5E5"> of open source stuff out there as</font>

946
00:35:39,600 --> 00:35:43,640
well so<font color="#CCCCCC"> it's gained a lot of momentum</font>

947
00:35:42,060 --> 00:35:46,710
over the last couple of years so it's

948
00:35:43,640 --> 00:35:50,089
it's a pretty common tool for for the

949
00:35:46,710 --> 00:35:52,260
malware analyst to<font color="#CCCCCC"> infer</font><font color="#E5E5E5"> analysts to use</font>

950
00:35:50,090 --> 00:35:54,540
<font color="#CCCCCC">its integrating a lot of different tools</font>

951
00:35:52,260 --> 00:35:59,670
I mean the ones you mentioned fire I has

952
00:35:54,540 --> 00:36:01,380
it that they haven't lost wax scanner

953
00:35:59,670 --> 00:36:04,230
uses it I mean there's a lot<font color="#CCCCCC"> of nails</font>

954
00:36:01,380 --> 00:36:05,940
that do there's a couple<font color="#E5E5E5"> of my head you</font>

955
00:36:04,230 --> 00:36:06,750
<font color="#CCCCCC">know it's</font><font color="#E5E5E5"> like pot you know we talked</font>

956
00:36:05,940 --> 00:36:08,640
about<font color="#CCCCCC"> this</font><font color="#E5E5E5"> the other day it's like</font>

957
00:36:06,750 --> 00:36:10,170
Python I mean you know there's you<font color="#CCCCCC"> know</font>

958
00:36:08,640 --> 00:36:12,660
people are right there python scripts

959
00:36:10,170 --> 00:36:14,400
for 2.7 or three point<font color="#CCCCCC"> oh the same thing</font>

960
00:36:12,660 --> 00:36:16,830
with the<font color="#E5E5E5"> different versions of yarra</font>

961
00:36:14,400 --> 00:36:20,250
that are out there and they have

962
00:36:16,830 --> 00:36:22,110
<font color="#E5E5E5">different music not use cases but just</font>

963
00:36:20,250 --> 00:36:25,080
different quirks that go along with them

964
00:36:22,110 --> 00:36:27,780
so the older versions may use the pc re

965
00:36:25,080 --> 00:36:29,370
engine for reg exes and you know the

966
00:36:27,780 --> 00:36:32,310
newer versions use what was it again

967
00:36:29,370 --> 00:36:33,779
<font color="#CCCCCC">I've been</font><font color="#E5E5E5"> using the yeah that's it so</font>

968
00:36:32,310 --> 00:36:35,759
<font color="#CCCCCC">there's different</font><font color="#E5E5E5"> syntaxes with the reg</font>

969
00:36:33,780 --> 00:36:37,860
axes and so<font color="#E5E5E5"> there's depending on the</font>

970
00:36:35,760 --> 00:36:40,380
version of yar that you're using you

971
00:36:37,860 --> 00:36:58,320
have different<font color="#E5E5E5"> considerations as you you</font>

972
00:36:40,380 --> 00:37:00,090
write your rules good so yes better

973
00:36:58,320 --> 00:37:02,070
there's a couple ways<font color="#CCCCCC"> to use yard one is</font>

974
00:37:00,090 --> 00:37:04,950
to do exact match you want to match

975
00:37:02,070 --> 00:37:06,480
exactly this perfect scenario the ones

976
00:37:04,950 --> 00:37:07,740
<font color="#E5E5E5">that only match in part or more</font>

977
00:37:06,480 --> 00:37:09,330
heuristic in nature those are the best

978
00:37:07,740 --> 00:37:11,160
ones to share because they're wider than

979
00:37:09,330 --> 00:37:13,770
more flexible well I don't<font color="#E5E5E5"> know if</font>

980
00:37:11,160 --> 00:37:16,379
you're afraid<font color="#CCCCCC"> to like file system or</font>

981
00:37:13,770 --> 00:37:17,790
just variety of files possible I mean

982
00:37:16,380 --> 00:37:19,890
what's<font color="#CCCCCC"> your take what the rule you want</font>

983
00:37:17,790 --> 00:37:21,930
to do if you<font color="#CCCCCC"> want to write and share I</font>

984
00:37:19,890 --> 00:37:24,089
mean if I see<font color="#E5E5E5"> this power sample in my</font>

985
00:37:21,930 --> 00:37:26,129
environment i'd like to be<font color="#E5E5E5"> able or other</font>

986
00:37:24,090 --> 00:37:29,160
other folks video business ethic to

987
00:37:26,130 --> 00:37:30,630
<font color="#E5E5E5">detect it as well and I mean you talked</font>

988
00:37:29,160 --> 00:37:34,920
about whether it's been seen in awhile

989
00:37:30,630 --> 00:37:36,690
or if you've done analysis enacted now

990
00:37:34,920 --> 00:37:37,890
you can<font color="#E5E5E5"> let somebody know that like the</font>

991
00:37:36,690 --> 00:37:39,930
scenario<font color="#CCCCCC"> that you should be applying</font>

992
00:37:37,890 --> 00:37:41,970
school metadata section would be you

993
00:37:39,930 --> 00:37:44,399
have a good place to fasten information

994
00:37:41,970 --> 00:37:45,959
on I would definitely pass a rule that

995
00:37:44,400 --> 00:37:47,160
was more oriented<font color="#E5E5E5"> toward something</font><font color="#CCCCCC"> that</font>

996
00:37:45,960 --> 00:37:48,660
<font color="#E5E5E5">you seen in the wild with something</font>

997
00:37:47,160 --> 00:37:50,609
that's already cleaned up an impact

998
00:37:48,660 --> 00:37:51,930
because that's more likely what

999
00:37:50,610 --> 00:37:54,150
someone's initially going to run into

1000
00:37:51,930 --> 00:37:55,259
what they're going to detect first now

1001
00:37:54,150 --> 00:37:56,610
after you're sharing with<font color="#E5E5E5"> other</font>

1002
00:37:55,260 --> 00:37:58,170
researchers in the part of the research

1003
00:37:56,610 --> 00:37:59,880
one thing you could be<font color="#E5E5E5"> different you</font>

1004
00:37:58,170 --> 00:38:02,280
know I might share with you know folks I

1005
00:37:59,880 --> 00:38:04,770
know<font color="#E5E5E5"> that have that capability already a</font>

1006
00:38:02,280 --> 00:38:06,240
<font color="#E5E5E5">rule its mooring</font><font color="#CCCCCC"> it towards matching on</font>

1007
00:38:04,770 --> 00:38:08,750
that impact version depends<font color="#E5E5E5"> on what the</font>

1008
00:38:06,240 --> 00:38:10,830
scenario is really it's kind of very

1009
00:38:08,750 --> 00:38:12,120
generally speaking I would go for<font color="#CCCCCC"> the</font>

1010
00:38:10,830 --> 00:38:13,830
end of wild version that they'd agree

1011
00:38:12,120 --> 00:38:16,470
with your right and then really explain

1012
00:38:13,830 --> 00:38:17,990
why your mathematical you might<font color="#E5E5E5"> batch on</font>

1013
00:38:16,470 --> 00:38:20,180
script for example and your look

1014
00:38:17,990 --> 00:38:21,589
using the web scanner to scan different

1015
00:38:20,180 --> 00:38:23,540
sites you've got to<font color="#E5E5E5"> be careful with what</font>

1016
00:38:21,590 --> 00:38:29,290
we share is it can be seen a couple

1017
00:38:23,540 --> 00:38:29,290
<font color="#E5E5E5">different ways that answer your question</font>

1018
00:38:35,650 --> 00:38:42,080
i'm doubtful that i wrote this<font color="#E5E5E5"> board</font>

1019
00:38:38,600 --> 00:38:44,660
this half damn that<font color="#CCCCCC"> de varville</font><font color="#E5E5E5"> access</font>

1020
00:38:42,080 --> 00:38:45,890
then somebody else in<font color="#E5E5E5"> bulletin and give</font>

1021
00:38:44,660 --> 00:38:48,319
article<font color="#E5E5E5"> accessing you have their</font>

1022
00:38:45,890 --> 00:38:50,750
intelligence you can obviously hosting

1023
00:38:48,320 --> 00:38:52,550
rules there in g20 which<font color="#E5E5E5"> you don't have</font>

1024
00:38:50,750 --> 00:38:55,910
access it's not something to have you've

1025
00:38:52,550 --> 00:38:57,470
never used a look at it lower third time

1026
00:38:55,910 --> 00:39:07,009
it's expensive though that it's horrible

1027
00:38:57,470 --> 00:39:08,779
yeah so any more questions<font color="#CCCCCC"> okay if you</font>

1028
00:39:07,010 --> 00:39:09,920
would<font color="#E5E5E5"> like to come up will be kind of</font>

1029
00:39:08,780 --> 00:39:11,810
loitering up front here for a few

1030
00:39:09,920 --> 00:39:12,950
minutes so I<font color="#E5E5E5"> think we've got about a</font>

1031
00:39:11,810 --> 00:39:15,380
couple more<font color="#E5E5E5"> minutes here in the room so</font>

1032
00:39:12,950 --> 00:39:16,939
<font color="#E5E5E5">if you want to come on up and ask some</font>

1033
00:39:15,380 --> 00:39:18,560
questions<font color="#CCCCCC"> one-on-one we'd be happy to</font>

1034
00:39:16,940 --> 00:39:22,780
sit and<font color="#E5E5E5"> talk with you</font><font color="#CCCCCC"> guys and thank you</font>

1035
00:39:18,560 --> 00:39:22,779
guys very much<font color="#E5E5E5"> for coming and go cubs</font>

