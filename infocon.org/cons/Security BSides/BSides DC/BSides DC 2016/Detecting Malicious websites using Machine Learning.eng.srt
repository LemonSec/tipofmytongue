1
00:00:00,030 --> 00:00:06,660
the<font color="#E5E5E5"> b-sides DC 2016 videos are brought</font>

2
00:00:03,240 --> 00:00:09,389
to you by<font color="#E5E5E5"> clear jobs net and cybersex</font>

3
00:00:06,660 --> 00:00:12,900
<font color="#CCCCCC">jobs.com</font><font color="#E5E5E5"> tools for your next career move</font>

4
00:00:09,389 --> 00:00:15,329
<font color="#CCCCCC">and antietam</font><font color="#E5E5E5"> technologies focusing on</font>

5
00:00:12,900 --> 00:00:18,330
advanced cyber detection analysis and

6
00:00:15,330 --> 00:00:19,770
mitigation<font color="#E5E5E5"> yeah hi my name's Andrew</font>

7
00:00:18,330 --> 00:00:22,680
beard

8
00:00:19,770 --> 00:00:25,920
my colleague Ajit saga Rajan is over

9
00:00:22,680 --> 00:00:27,660
there in the audience<font color="#CCCCCC"> so we work for</font><font color="#E5E5E5"> a</font>

10
00:00:25,920 --> 00:00:30,599
little<font color="#CCCCCC"> tongue company called atomic mole</font>

11
00:00:27,660 --> 00:00:32,668
<font color="#CCCCCC">I wanted</font><font color="#E5E5E5"> to talk today about detecting</font>

12
00:00:30,599 --> 00:00:36,480
malicious<font color="#CCCCCC"> websites using</font><font color="#E5E5E5"> machine</font>

13
00:00:32,668 --> 00:00:39,029
learning<font color="#E5E5E5"> and I'm really specifically</font>

14
00:00:36,480 --> 00:00:42,510
talking<font color="#E5E5E5"> about a very specific</font><font color="#CCCCCC"> subset of</font>

15
00:00:39,030 --> 00:00:45,149
malicious websites I'm really focusing

16
00:00:42,510 --> 00:00:48,599
<font color="#E5E5E5">almost entirely and actually totally</font>

17
00:00:45,149 --> 00:00:52,739
entirely on SSL encrypted websites<font color="#E5E5E5"> ones</font>

18
00:00:48,600 --> 00:00:56,239
available<font color="#E5E5E5"> over HTTPS um so you</font><font color="#CCCCCC"> know</font>

19
00:00:52,739 --> 00:00:59,339
obvious question is why focus<font color="#E5E5E5"> on those</font>

20
00:00:56,239 --> 00:01:02,669
encrypted websites are you know huge

21
00:00:59,340 --> 00:01:04,170
rise in<font color="#E5E5E5"> the past couple years</font><font color="#CCCCCC"> it's</font>

22
00:01:02,670 --> 00:01:08,790
<font color="#CCCCCC">easier than</font><font color="#E5E5E5"> ever to</font><font color="#CCCCCC"> get an SSL</font>

23
00:01:04,170 --> 00:01:11,610
certificate<font color="#CCCCCC"> free or low-cost make your</font>

24
00:01:08,790 --> 00:01:14,280
own via<font color="#CCCCCC"> a</font><font color="#E5E5E5"> self-signed certificate um the</font>

25
00:01:11,610 --> 00:01:17,280
big thing<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I want to focus on if you</font>

26
00:01:14,280 --> 00:01:18,810
can actually<font color="#E5E5E5"> read it though is</font><font color="#CCCCCC"> that part</font>

27
00:01:17,280 --> 00:01:22,619
up in the corner right this was a slide

28
00:01:18,810 --> 00:01:25,110
taken from Dell<font color="#E5E5E5"> world 15 which was a</font>

29
00:01:22,619 --> 00:01:27,150
conference they had<font color="#E5E5E5"> looking at 2014 data</font>

30
00:01:25,110 --> 00:01:29,909
and they were projecting<font color="#CCCCCC"> at that point</font>

31
00:01:27,150 --> 00:01:33,600
that<font color="#CCCCCC"> 50% of all attacks were predicted</font>

32
00:01:29,909 --> 00:01:37,829
to<font color="#E5E5E5"> use SSL by 2017 so they were saying</font>

33
00:01:33,600 --> 00:01:40,798
this<font color="#E5E5E5"> in 2015 um 2017 is a whole lot</font>

34
00:01:37,829 --> 00:01:42,508
closer now<font color="#CCCCCC"> than it was then and</font>

35
00:01:40,799 --> 00:01:44,670
everything<font color="#E5E5E5"> that we're looking at says</font>

36
00:01:42,509 --> 00:01:49,860
that yeah they're pretty close to<font color="#CCCCCC"> on</font>

37
00:01:44,670 --> 00:01:51,270
track so SSL you know there are

38
00:01:49,860 --> 00:01:53,009
definitely<font color="#CCCCCC"> some benefits but</font><font color="#E5E5E5"> there's</font>

39
00:01:51,270 --> 00:01:56,579
some pretty<font color="#E5E5E5"> big downsides to its use</font><font color="#CCCCCC"> -</font>

40
00:01:53,009 --> 00:02:00,930
<font color="#CCCCCC">um you</font><font color="#E5E5E5"> know especially in the post</font>

41
00:01:56,579 --> 00:02:02,729
Snowden leaked realm<font color="#E5E5E5"> users</font><font color="#CCCCCC"> websites</font>

42
00:02:00,930 --> 00:02:04,469
everybody wants encryption right they

43
00:02:02,729 --> 00:02:06,960
want<font color="#CCCCCC"> to encrypt all the things I don't</font>

44
00:02:04,469 --> 00:02:08,878
want my<font color="#E5E5E5"> email being read</font><font color="#CCCCCC"> by anybody be</font>

45
00:02:06,960 --> 00:02:11,489
it a government<font color="#CCCCCC"> be it a malicious</font>

46
00:02:08,878 --> 00:02:13,100
individual be it the company that may be

47
00:02:11,489 --> 00:02:15,720
hosting it

48
00:02:13,100 --> 00:02:18,180
we want everything<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be encrypted in</font>

49
00:02:15,720 --> 00:02:20,100
transit<font color="#CCCCCC"> that's great for</font><font color="#E5E5E5"> users that's</font>

50
00:02:18,180 --> 00:02:22,170
not so great<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the guys sitting in the</font>

51
00:02:20,100 --> 00:02:24,180
<font color="#E5E5E5">NOC who are used to</font><font color="#CCCCCC"> having content</font>

52
00:02:22,170 --> 00:02:26,940
visibility who used to be I want to<font color="#E5E5E5"> see</font>

53
00:02:24,180 --> 00:02:28,890
data<font color="#CCCCCC"> traffic going forth</font><font color="#E5E5E5"> and being able</font>

54
00:02:26,940 --> 00:02:31,290
to tell if there's an executable<font color="#E5E5E5"> in a</font>

55
00:02:28,890 --> 00:02:34,049
data stream<font color="#E5E5E5"> or if this is</font><font color="#CCCCCC"> just somebody</font>

56
00:02:31,290 --> 00:02:35,910
looking<font color="#E5E5E5"> at Twitter</font><font color="#CCCCCC"> um it's really</font><font color="#E5E5E5"> good</font>

57
00:02:34,050 --> 00:02:38,790
<font color="#E5E5E5">news</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> people who are using the</font><font color="#CCCCCC"> Wi-Fi</font>

58
00:02:35,910 --> 00:02:41,460
at Starbucks really bad news if you're

59
00:02:38,790 --> 00:02:43,260
<font color="#E5E5E5">on the defense side there are SSL</font>

60
00:02:41,460 --> 00:02:46,140
decryption appliances<font color="#E5E5E5"> proxies</font>

61
00:02:43,260 --> 00:02:49,049
man-in-the-middle devices<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> that</font>

62
00:02:46,140 --> 00:02:51,209
that can<font color="#E5E5E5"> be deployed has anybody ever</font>

63
00:02:49,050 --> 00:02:56,190
actually<font color="#E5E5E5"> deployed one of those devices</font>

64
00:02:51,210 --> 00:02:59,550
<font color="#E5E5E5">in an enterprise environment like a SSL</font>

65
00:02:56,190 --> 00:03:02,460
decryption pass-through okay so we got

66
00:02:59,550 --> 00:03:06,720
maybe three hands<font color="#CCCCCC"> um was that a fun</font>

67
00:03:02,460 --> 00:03:08,460
experience<font color="#E5E5E5"> for you guys yeah and that's</font>

68
00:03:06,720 --> 00:03:10,530
pretty much mirrored the experience<font color="#E5E5E5"> of</font>

69
00:03:08,460 --> 00:03:13,050
everyone<font color="#E5E5E5"> I've ever talked to who's had</font>

70
00:03:10,530 --> 00:03:14,730
to deal with<font color="#E5E5E5"> one you know trying to</font>

71
00:03:13,050 --> 00:03:16,440
manage keys trying to manage cut

72
00:03:14,730 --> 00:03:18,060
throughs all<font color="#E5E5E5"> that sudden realizing that</font>

73
00:03:16,440 --> 00:03:21,750
you now<font color="#CCCCCC"> have</font><font color="#E5E5E5"> the liability whenever one</font>

74
00:03:18,060 --> 00:03:25,410
<font color="#CCCCCC">of</font><font color="#E5E5E5"> your employees visits their bank</font><font color="#CCCCCC"> it's</font>

75
00:03:21,750 --> 00:03:27,900
yeah it's a bit of a pain in the butt so

76
00:03:25,410 --> 00:03:30,329
<font color="#E5E5E5">really</font><font color="#CCCCCC"> want to</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about a lot of</font><font color="#E5E5E5"> those</font>

77
00:03:27,900 --> 00:03:32,880
especially<font color="#E5E5E5"> when we deal</font><font color="#CCCCCC"> with that kind</font>

78
00:03:30,330 --> 00:03:34,650
<font color="#CCCCCC">of medium enterprise market</font><font color="#E5E5E5"> um those</font>

79
00:03:32,880 --> 00:03:36,359
devices are entirely out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the realm of</font>

80
00:03:34,650 --> 00:03:39,150
possibility so the question is what can

81
00:03:36,360 --> 00:03:41,370
<font color="#CCCCCC">we do</font><font color="#E5E5E5"> what can we look at in an SSL</font>

82
00:03:39,150 --> 00:03:43,260
encrypted stream that can give us<font color="#E5E5E5"> some</font>

83
00:03:41,370 --> 00:03:45,450
indication<font color="#E5E5E5"> of whether this is</font><font color="#CCCCCC"> something</font>

84
00:03:43,260 --> 00:03:49,109
<font color="#CCCCCC">okay or if this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> something that</font><font color="#E5E5E5"> may</font><font color="#CCCCCC"> be</font>

85
00:03:45,450 --> 00:03:53,100
a<font color="#CCCCCC"> problem and</font><font color="#E5E5E5"> a big part of that is the</font>

86
00:03:49,110 --> 00:03:56,310
SSL<font color="#CCCCCC"> Certificates themselves so this is a</font>

87
00:03:53,100 --> 00:03:58,950
daring<font color="#CCCCCC"> coated SSL certificate this</font><font color="#E5E5E5"> is a</font>

88
00:03:56,310 --> 00:04:01,709
basically a way to<font color="#E5E5E5"> represent an</font><font color="#CCCCCC"> ascii</font><font color="#E5E5E5"> if</font>

89
00:03:58,950 --> 00:04:05,070
you<font color="#E5E5E5"> to</font><font color="#CCCCCC"> buy an SSL certificate from a CA</font>

90
00:04:01,709 --> 00:04:06,600
<font color="#E5E5E5">and they give you a key file back this</font>

91
00:04:05,070 --> 00:04:08,459
is probably what it looks like this is

92
00:04:06,600 --> 00:04:10,170
the the what its gonna look<font color="#CCCCCC"> like</font><font color="#E5E5E5"> when</font>

93
00:04:08,459 --> 00:04:12,930
it's interpreted by say your web server

94
00:04:10,170 --> 00:04:15,390
<font color="#CCCCCC">on disk it's not what it looks like in</font>

95
00:04:12,930 --> 00:04:18,090
transit though when it it's in transit

96
00:04:15,390 --> 00:04:19,409
<font color="#E5E5E5">it looks a little bit more like this</font><font color="#CCCCCC"> and</font>

97
00:04:18,089 --> 00:04:22,440
I'm sorry<font color="#E5E5E5"> this is a</font><font color="#CCCCCC"> little bit of an eye</font>

98
00:04:19,410 --> 00:04:24,570
chart<font color="#E5E5E5"> here so this is a dump</font>

99
00:04:22,440 --> 00:04:26,670
taken from encoding this decoding the

100
00:04:24,570 --> 00:04:28,530
same certificate<font color="#CCCCCC"> that I saw earlier</font>

101
00:04:26,670 --> 00:04:30,510
just running it through base64 to get it

102
00:04:28,530 --> 00:04:34,500
in a raw binary<font color="#E5E5E5"> format and just doing a</font>

103
00:04:30,510 --> 00:04:35,969
hex dump of it<font color="#E5E5E5"> and you may or may</font><font color="#CCCCCC"> not be</font>

104
00:04:34,500 --> 00:04:38,910
<font color="#CCCCCC">able to see there</font><font color="#E5E5E5"> are a couple strings</font>

105
00:04:35,970 --> 00:04:40,590
in here that look<font color="#CCCCCC"> like a ski but they</font>

106
00:04:38,910 --> 00:04:44,970
look kind of<font color="#E5E5E5"> weird</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> there they're</font>

107
00:04:40,590 --> 00:04:46,500
very very just not a lot<font color="#CCCCCC"> actual human</font>

108
00:04:44,970 --> 00:04:48,860
readable text here<font color="#E5E5E5"> and they're also</font>

109
00:04:46,500 --> 00:04:53,550
<font color="#E5E5E5">somewhat looks like</font><font color="#CCCCCC"> ASCII encoded</font>

110
00:04:48,860 --> 00:04:55,200
numerical values<font color="#E5E5E5"> there so if you're just</font>

111
00:04:53,550 --> 00:04:57,450
<font color="#CCCCCC">looking at</font><font color="#E5E5E5"> this on the wire and you</font>

112
00:04:55,200 --> 00:04:59,159
don't necessarily<font color="#E5E5E5"> understand the format</font>

113
00:04:57,450 --> 00:05:00,659
of the certificate<font color="#CCCCCC"> you can see there's</font>

114
00:04:59,160 --> 00:05:04,530
stuff<font color="#CCCCCC"> here but you don't necessarily</font>

115
00:05:00,660 --> 00:05:07,680
know what it means um however<font color="#E5E5E5"> you dump</font>

116
00:05:04,530 --> 00:05:10,200
this through<font color="#E5E5E5"> the SSL tool that's in</font>

117
00:05:07,680 --> 00:05:12,060
<font color="#E5E5E5">crude included as part of the</font><font color="#CCCCCC"> SSL</font>

118
00:05:10,200 --> 00:05:14,190
distribution or<font color="#E5E5E5"> sorry open SSL</font>

119
00:05:12,060 --> 00:05:16,670
distribution<font color="#E5E5E5"> believe is</font><font color="#CCCCCC"> available on</font>

120
00:05:14,190 --> 00:05:19,950
pretty much every Linux system ever

121
00:05:16,670 --> 00:05:21,570
<font color="#CCCCCC">packaged as part of Mac OS chances are</font>

122
00:05:19,950 --> 00:05:24,150
you already<font color="#E5E5E5"> have this if you're not</font>

123
00:05:21,570 --> 00:05:26,250
running<font color="#E5E5E5"> Windows so you take that same</font>

124
00:05:24,150 --> 00:05:27,630
certificate<font color="#E5E5E5"> you do the base64 decode you</font>

125
00:05:26,250 --> 00:05:29,820
pipe it through here<font color="#E5E5E5"> and all</font><font color="#CCCCCC"> of a sudden</font>

126
00:05:27,630 --> 00:05:33,480
<font color="#CCCCCC">now some of</font><font color="#E5E5E5"> this stuff makes sense</font><font color="#CCCCCC"> if</font>

127
00:05:29,820 --> 00:05:34,830
you can read the screen<font color="#E5E5E5"> at all you can</font>

128
00:05:33,480 --> 00:05:37,880
see here there<font color="#E5E5E5"> are different</font><font color="#CCCCCC"> fields</font>

129
00:05:34,830 --> 00:05:41,190
version numbers different algorithms

130
00:05:37,880 --> 00:05:43,230
validity dates some<font color="#E5E5E5"> of those strings</font>

131
00:05:41,190 --> 00:05:45,630
<font color="#CCCCCC">that may look a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> familiar if</font>

132
00:05:43,230 --> 00:05:48,090
you could see the previous one different

133
00:05:45,630 --> 00:05:49,770
algorithms<font color="#E5E5E5"> all this now you can start</font>

134
00:05:48,090 --> 00:05:53,130
associating<font color="#E5E5E5"> all right there are</font>

135
00:05:49,770 --> 00:05:55,469
different key value pairs<font color="#E5E5E5"> associated</font>

136
00:05:53,130 --> 00:05:59,930
<font color="#E5E5E5">with the certificate beyond just the</font>

137
00:05:55,470 --> 00:06:03,420
binary<font color="#E5E5E5"> stuff that we saw earlier on</font>

138
00:05:59,930 --> 00:06:04,740
<font color="#E5E5E5">there are so I'm using the</font><font color="#CCCCCC"> OpenSSL</font>

139
00:06:03,420 --> 00:06:07,530
binary tool there<font color="#E5E5E5"> are a number of things</font>

140
00:06:04,740 --> 00:06:09,690
that can read this<font color="#CCCCCC"> Wireshark if you look</font>

141
00:06:07,530 --> 00:06:11,640
in an open<font color="#E5E5E5"> SSL exchange where they do a</font>

142
00:06:09,690 --> 00:06:14,430
server certificate<font color="#CCCCCC"> we'll be able</font><font color="#E5E5E5"> to dump</font>

143
00:06:11,640 --> 00:06:16,860
pretty much all of<font color="#CCCCCC"> this info bro a</font>

144
00:06:14,430 --> 00:06:18,000
really excellent tool which Liam was

145
00:06:16,860 --> 00:06:19,560
doing training<font color="#E5E5E5"> on the other day and</font><font color="#CCCCCC"> I</font>

146
00:06:18,000 --> 00:06:23,280
<font color="#E5E5E5">believe is doing it on Sunday as well</font>

147
00:06:19,560 --> 00:06:27,050
<font color="#E5E5E5">can</font><font color="#CCCCCC"> decode</font><font color="#E5E5E5"> this live but I want to talk</font>

148
00:06:23,280 --> 00:06:27,049
about<font color="#E5E5E5"> some of these fields in particular</font>

149
00:06:27,470 --> 00:06:34,470
specifically these two sets of field<font color="#E5E5E5"> one</font>

150
00:06:31,200 --> 00:06:38,460
is the certificate<font color="#E5E5E5"> issuer and one is the</font>

151
00:06:34,470 --> 00:06:40,440
certificate subject so in this

152
00:06:38,460 --> 00:06:42,270
<font color="#E5E5E5">particular field itself</font>

153
00:06:40,440 --> 00:06:44,910
this one here<font color="#E5E5E5"> there are a number of</font>

154
00:06:42,270 --> 00:06:47,789
subfields<font color="#E5E5E5"> and you can see things like</font><font color="#CCCCCC"> C</font>

155
00:06:44,910 --> 00:06:50,370
equals<font color="#E5E5E5"> 8 you what that means</font><font color="#CCCCCC"> is the the</font>

156
00:06:47,790 --> 00:06:53,490
issuer<font color="#E5E5E5"> country code is a</font><font color="#CCCCCC"> u</font><font color="#E5E5E5"> rights</font>

157
00:06:50,370 --> 00:06:57,620
<font color="#CCCCCC">Australia the s</font><font color="#E5E5E5"> T which is supposed to</font>

158
00:06:53,490 --> 00:07:01,500
<font color="#E5E5E5">be the state according to the spec is f2</font>

159
00:06:57,620 --> 00:07:04,460
<font color="#CCCCCC">te e4 which is no state that I've ever</font>

160
00:07:01,500 --> 00:07:06,900
<font color="#E5E5E5">heard of same thing with the location</font>

161
00:07:04,460 --> 00:07:08,969
organization organizational unit and

162
00:07:06,900 --> 00:07:11,969
common name common name is more or<font color="#CCCCCC"> less</font>

163
00:07:08,970 --> 00:07:15,420
the host name of the server<font color="#E5E5E5"> in most</font>

164
00:07:11,970 --> 00:07:17,580
cases so<font color="#E5E5E5"> these are the fields that we</font>

165
00:07:15,420 --> 00:07:19,770
<font color="#E5E5E5">specifically are have</font><font color="#CCCCCC"> been concentrating</font>

166
00:07:17,580 --> 00:07:20,849
on as part of our research<font color="#CCCCCC"> there's been</font>

167
00:07:19,770 --> 00:07:23,039
<font color="#CCCCCC">other research on some of the other</font>

168
00:07:20,850 --> 00:07:25,260
fields<font color="#CCCCCC"> the validity dates in particular</font>

169
00:07:23,040 --> 00:07:28,500
there<font color="#E5E5E5"> was a presentation at besides</font>

170
00:07:25,260 --> 00:07:30,539
<font color="#E5E5E5">charm and earlier this year by will glow</font>

171
00:07:28,500 --> 00:07:33,180
deck<font color="#E5E5E5"> where he kind of looked</font><font color="#CCCCCC"> at those</font>

172
00:07:30,540 --> 00:07:35,160
values<font color="#CCCCCC"> so one</font><font color="#E5E5E5"> thing I want to</font><font color="#CCCCCC"> mention</font>

173
00:07:33,180 --> 00:07:38,160
this particular<font color="#E5E5E5"> certificate</font><font color="#CCCCCC"> here is</font>

174
00:07:35,160 --> 00:07:41,510
actually<font color="#E5E5E5"> common to pretty much all</font><font color="#CCCCCC"> of</font>

175
00:07:38,160 --> 00:07:44,490
the trick<font color="#CCCCCC"> bots</font><font color="#E5E5E5"> see two nodes</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> was a</font>

176
00:07:41,510 --> 00:07:46,169
brought up in a paper<font color="#CCCCCC"> that Fidelis cyber</font>

177
00:07:44,490 --> 00:07:49,710
<font color="#CCCCCC">security published</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> think last week</font>

178
00:07:46,169 --> 00:07:51,630
<font color="#CCCCCC">week before last</font><font color="#E5E5E5"> aside from the country</font>

179
00:07:49,710 --> 00:07:54,330
code which is<font color="#E5E5E5"> a</font><font color="#CCCCCC"> u these values look</font>

180
00:07:51,630 --> 00:07:56,550
<font color="#E5E5E5">almost entirely random right there's</font>

181
00:07:54,330 --> 00:07:59,039
they're definitely not<font color="#E5E5E5"> valid countries</font>

182
00:07:56,550 --> 00:08:00,360
or locations or anything like<font color="#E5E5E5"> that if</font>

183
00:07:59,040 --> 00:08:03,690
you look at them long enough<font color="#E5E5E5"> though you</font>

184
00:08:00,360 --> 00:08:05,940
start and<font color="#CCCCCC"> you have a u.s. keyboard</font><font color="#E5E5E5"> as I</font>

185
00:08:03,690 --> 00:08:07,650
do right<font color="#CCCCCC"> in front of</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can kind of</font>

186
00:08:05,940 --> 00:08:11,190
see that all<font color="#CCCCCC"> of</font><font color="#E5E5E5"> them are very close</font>

187
00:08:07,650 --> 00:08:12,929
<font color="#E5E5E5">together on the keyboard</font><font color="#CCCCCC"> so what looks</font>

188
00:08:11,190 --> 00:08:14,010
<font color="#E5E5E5">like a random string of characters and</font>

189
00:08:12,930 --> 00:08:15,900
<font color="#E5E5E5">you figure is somebody who's doing a</font>

190
00:08:14,010 --> 00:08:17,130
script<font color="#E5E5E5"> is actually somebody to just went</font>

191
00:08:15,900 --> 00:08:20,159
<font color="#E5E5E5">through the certificate generation</font>

192
00:08:17,130 --> 00:08:22,290
process and just<font color="#E5E5E5"> went</font><font color="#CCCCCC"> dududududu over in</font>

193
00:08:20,160 --> 00:08:24,060
<font color="#E5E5E5">different places</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> kind of give you</font>

194
00:08:22,290 --> 00:08:26,250
<font color="#CCCCCC">some information</font><font color="#E5E5E5"> about who set these</font>

195
00:08:24,060 --> 00:08:28,710
nodes up<font color="#E5E5E5"> right this isn't somebody who</font>

196
00:08:26,250 --> 00:08:30,030
has a lot<font color="#CCCCCC"> of scripting who's going</font>

197
00:08:28,710 --> 00:08:32,610
through who's going to be generating one

198
00:08:30,030 --> 00:08:34,890
of these<font color="#CCCCCC"> keys or certificates</font><font color="#E5E5E5"> every 30</font>

199
00:08:32,610 --> 00:08:38,250
seconds<font color="#E5E5E5"> or</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> this is somebody who had a</font>

200
00:08:34,890 --> 00:08:40,380
very manual process involved so it's

201
00:08:38,250 --> 00:08:41,520
this<font color="#E5E5E5"> kind of an example of the kind of</font>

202
00:08:40,380 --> 00:08:45,540
things you can<font color="#CCCCCC"> get when you</font><font color="#E5E5E5"> look a</font>

203
00:08:41,520 --> 00:08:47,460
little<font color="#CCCCCC"> deeper into</font><font color="#E5E5E5"> these attributes so</font>

204
00:08:45,540 --> 00:08:49,380
this the<font color="#E5E5E5"> issuer</font><font color="#CCCCCC"> and subject fields the</font>

205
00:08:47,460 --> 00:08:52,140
ones I talked about<font color="#E5E5E5"> and as we kind of</font>

206
00:08:49,380 --> 00:08:54,360
saw in this particular certificate<font color="#CCCCCC"> so</font>

207
00:08:52,140 --> 00:08:56,100
they're structured by a convention

208
00:08:54,360 --> 00:08:57,930
right it's<font color="#CCCCCC"> supposed to be that C is a</font>

209
00:08:56,100 --> 00:09:00,180
country it is<font color="#E5E5E5"> supposed to be</font><font color="#CCCCCC"> the ellos</font>

210
00:08:57,930 --> 00:09:01,890
location<font color="#E5E5E5"> that is what the RFC says is</font>

211
00:09:00,180 --> 00:09:05,279
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to happen</font><font color="#E5E5E5"> there's nothing that</font>

212
00:09:01,890 --> 00:09:07,560
actually<font color="#E5E5E5"> enforces that in any technical</font>

213
00:09:05,279 --> 00:09:10,910
<font color="#E5E5E5">process when you do a self-signed</font>

214
00:09:07,560 --> 00:09:13,709
<font color="#E5E5E5">certificate if a certificate authority</font>

215
00:09:10,910 --> 00:09:16,019
<font color="#E5E5E5">generated the certificate or at least</font>

216
00:09:13,709 --> 00:09:17,609
signed the certificate<font color="#E5E5E5"> they may check to</font>

217
00:09:16,019 --> 00:09:20,490
make<font color="#E5E5E5"> sure</font><font color="#CCCCCC"> that those values are good and</font>

218
00:09:17,610 --> 00:09:23,310
if you try to<font color="#E5E5E5"> do one that you know has a</font>

219
00:09:20,490 --> 00:09:25,260
<font color="#E5E5E5">location of</font><font color="#CCCCCC"> fe whatever</font><font color="#E5E5E5"> they may say no</font>

220
00:09:23,310 --> 00:09:28,560
<font color="#E5E5E5">we're not</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> do it</font><font color="#CCCCCC"> go away</font>

221
00:09:25,260 --> 00:09:29,790
not all certificates do but some of the

222
00:09:28,560 --> 00:09:30,989
larger<font color="#CCCCCC"> ones do especially</font><font color="#E5E5E5"> when you're</font>

223
00:09:29,790 --> 00:09:33,750
going beyond the<font color="#CCCCCC"> domain validation</font>

224
00:09:30,990 --> 00:09:35,790
certificates but<font color="#E5E5E5"> self-signed</font>

225
00:09:33,750 --> 00:09:37,440
certificates are a total<font color="#E5E5E5"> Wild West you</font>

226
00:09:35,790 --> 00:09:40,410
can<font color="#E5E5E5"> put whatever data you want in this</font>

227
00:09:37,440 --> 00:09:44,730
thing and it<font color="#CCCCCC"> is up to</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> client to try</font>

228
00:09:40,410 --> 00:09:46,769
to process<font color="#E5E5E5"> it so I want to talk about a</font>

229
00:09:44,730 --> 00:09:50,250
<font color="#E5E5E5">couple</font><font color="#CCCCCC"> of resources that are available</font>

230
00:09:46,769 --> 00:09:51,810
<font color="#E5E5E5">and that we use as part</font><font color="#CCCCCC"> of this</font><font color="#E5E5E5"> and how</font>

231
00:09:50,250 --> 00:09:54,230
those pieces<font color="#E5E5E5"> kind of fit together I'll</font>

232
00:09:51,810 --> 00:09:57,479
make a little more sense<font color="#E5E5E5"> go on going on</font>

233
00:09:54,230 --> 00:10:00,269
<font color="#E5E5E5">one of them is project sonar project</font>

234
00:09:57,480 --> 00:10:01,800
sonar is basically<font color="#E5E5E5"> a project it's a</font>

235
00:10:00,269 --> 00:10:04,380
<font color="#CCCCCC">project</font><font color="#E5E5E5"> run by rapid7</font>

236
00:10:01,800 --> 00:10:07,199
<font color="#CCCCCC">um</font><font color="#E5E5E5"> it goes out and</font><font color="#CCCCCC"> it scans</font><font color="#E5E5E5"> the complete</font>

237
00:10:04,380 --> 00:10:11,699
ipv4 space<font color="#E5E5E5"> every seven days looking for</font>

238
00:10:07,199 --> 00:10:15,750
servers that run<font color="#E5E5E5"> SSL web servers on port</font>

239
00:10:11,699 --> 00:10:17,760
443 and specifically on port 443 if

240
00:10:15,750 --> 00:10:20,220
you're running<font color="#E5E5E5"> something on</font><font color="#CCCCCC"> 8 443 they</font>

241
00:10:17,760 --> 00:10:21,839
don't<font color="#E5E5E5"> look at it</font><font color="#CCCCCC"> at all</font><font color="#E5E5E5"> they publish</font>

242
00:10:20,220 --> 00:10:25,500
data every week they've been doing it

243
00:10:21,839 --> 00:10:26,940
<font color="#E5E5E5">for a little over two</font><font color="#CCCCCC"> years now</font><font color="#E5E5E5"> actually</font>

244
00:10:25,500 --> 00:10:29,820
I'm sorry<font color="#E5E5E5"> a little</font><font color="#CCCCCC"> over three years now</font>

245
00:10:26,940 --> 00:10:32,459
<font color="#CCCCCC">um</font><font color="#E5E5E5"> and so</font><font color="#CCCCCC"> far they've captured about</font><font color="#E5E5E5"> 82</font>

246
00:10:29,820 --> 00:10:34,500
million certificates they<font color="#CCCCCC"> make</font><font color="#E5E5E5"> all that</font>

247
00:10:32,459 --> 00:10:37,170
data<font color="#CCCCCC"> available for researchers you can</font>

248
00:10:34,500 --> 00:10:39,510
download them week by week<font color="#CCCCCC"> and they will</font>

249
00:10:37,170 --> 00:10:42,540
<font color="#E5E5E5">give</font><font color="#CCCCCC"> you complete</font><font color="#E5E5E5"> x.509 certificates in</font>

250
00:10:39,510 --> 00:10:45,420
that<font color="#E5E5E5"> base64</font><font color="#CCCCCC"> dere encoded form</font><font color="#E5E5E5"> that I</font>

251
00:10:42,540 --> 00:10:48,300
showed earlier<font color="#E5E5E5"> so a lot of data</font>

252
00:10:45,420 --> 00:10:49,769
available<font color="#CCCCCC"> there you kind of got to</font><font color="#E5E5E5"> have</font>

253
00:10:48,300 --> 00:10:52,199
to<font color="#E5E5E5"> figure out what you want to do with</font>

254
00:10:49,769 --> 00:10:54,209
<font color="#CCCCCC">it though you know</font><font color="#E5E5E5"> obviously if you're</font>

255
00:10:52,199 --> 00:10:55,380
interested in SSL research this is

256
00:10:54,209 --> 00:10:57,089
something that<font color="#E5E5E5"> tends to make people</font>

257
00:10:55,380 --> 00:10:59,910
salivate a little bit when they<font color="#CCCCCC"> think</font><font color="#E5E5E5"> of</font>

258
00:10:57,089 --> 00:11:01,230
all<font color="#E5E5E5"> the potential stuff but it there's a</font>

259
00:10:59,910 --> 00:11:03,860
<font color="#E5E5E5">little bit of work required to</font><font color="#CCCCCC"> actually</font>

260
00:11:01,230 --> 00:11:07,560
get something<font color="#CCCCCC"> meaningful out</font><font color="#E5E5E5"> of this</font>

261
00:11:03,860 --> 00:11:08,279
another project<font color="#E5E5E5"> is the</font><font color="#CCCCCC"> SSL blacklist SSL</font>

262
00:11:07,560 --> 00:11:11,550
<font color="#CCCCCC">BL this is</font>

263
00:11:08,279 --> 00:11:14,430
<font color="#E5E5E5">by abuse</font><font color="#CCCCCC"> eh also that known as</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> Swiss</font>

264
00:11:11,550 --> 00:11:16,829
security blog<font color="#CCCCCC"> they put out a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of</font>

265
00:11:14,430 --> 00:11:19,979
<font color="#E5E5E5">really</font><font color="#CCCCCC"> good feeds of information</font><font color="#E5E5E5"> but</font>

266
00:11:16,829 --> 00:11:22,050
<font color="#E5E5E5">this one particularly is focused almost</font>

267
00:11:19,980 --> 00:11:25,079
entirely on certificates<font color="#E5E5E5"> that are used</font>

268
00:11:22,050 --> 00:11:27,209
by malware<font color="#CCCCCC"> C to</font><font color="#E5E5E5"> servers and they're</font>

269
00:11:25,079 --> 00:11:30,258
almost all commodity C<font color="#E5E5E5"> to servers we're</font>

270
00:11:27,209 --> 00:11:33,239
talking things like dry<font color="#E5E5E5"> decks rootkit</font>

271
00:11:30,259 --> 00:11:35,970
<font color="#CCCCCC">dire</font><font color="#E5E5E5"> was a big one when Dyer</font><font color="#CCCCCC"> was still a</font>

272
00:11:33,240 --> 00:11:39,959
thing<font color="#CCCCCC"> and they distribute lists of</font>

273
00:11:35,970 --> 00:11:43,199
certificate fingerprints sha-1 hashes<font color="#CCCCCC"> so</font>

274
00:11:39,959 --> 00:11:46,800
you know that's a resource where<font color="#CCCCCC"> you can</font>

275
00:11:43,199 --> 00:11:49,050
go<font color="#E5E5E5"> through and find some known bad</font>

276
00:11:46,800 --> 00:11:50,758
certificates<font color="#E5E5E5"> so I'm going to make a</font>

277
00:11:49,050 --> 00:11:53,040
couple of assumptions here<font color="#CCCCCC"> and one</font><font color="#E5E5E5"> upon</font>

278
00:11:50,759 --> 00:11:55,529
hypothesis<font color="#E5E5E5"> and hopefully these kind of</font>

279
00:11:53,040 --> 00:11:57,959
<font color="#E5E5E5">prove out or at least you think</font><font color="#CCCCCC"> they</font>

280
00:11:55,529 --> 00:11:59,069
prove out as we<font color="#CCCCCC"> talk about things and</font>

281
00:11:57,959 --> 00:12:00,719
<font color="#E5E5E5">you can kind of see how these link up</font>

282
00:11:59,069 --> 00:12:03,990
<font color="#E5E5E5">one is that the</font><font color="#CCCCCC"> internet</font><font color="#E5E5E5"> is really</font>

283
00:12:00,720 --> 00:12:06,839
really big<font color="#CCCCCC"> there are a ton of sites out</font>

284
00:12:03,990 --> 00:12:11,759
<font color="#E5E5E5">there malicious sites though ones that</font>

285
00:12:06,839 --> 00:12:13,529
are absolutely done with bad intent<font color="#E5E5E5"> are</font>

286
00:12:11,759 --> 00:12:15,779
relatively rare<font color="#E5E5E5"> there's a lot of weird</font>

287
00:12:13,529 --> 00:12:18,180
crap<font color="#E5E5E5"> out there that isn't necessarily</font>

288
00:12:15,779 --> 00:12:19,800
right I<font color="#E5E5E5"> still don't know why I see so</font>

289
00:12:18,180 --> 00:12:22,099
many certificates<font color="#E5E5E5"> for BlackBerry</font>

290
00:12:19,800 --> 00:12:24,449
PlayBook s-- available at project sonar

291
00:12:22,100 --> 00:12:26,309
but<font color="#E5E5E5"> those aren't</font><font color="#CCCCCC"> necessarily malicious</font>

292
00:12:24,449 --> 00:12:27,439
unless you've<font color="#E5E5E5"> actually used a blackberry</font>

293
00:12:26,309 --> 00:12:30,240
<font color="#E5E5E5">playbook</font>

294
00:12:27,439 --> 00:12:32,490
so another assumption<font color="#E5E5E5"> is a certificate</font>

295
00:12:30,240 --> 00:12:35,339
<font color="#E5E5E5">blacklist don't provide anywhere near</font>

296
00:12:32,490 --> 00:12:36,779
<font color="#E5E5E5">full coverage right or even</font><font color="#CCCCCC"> of a</font>

297
00:12:35,339 --> 00:12:38,910
particular malware family

298
00:12:36,779 --> 00:12:40,889
there's even though the<font color="#CCCCCC"> Internet is</font>

299
00:12:38,910 --> 00:12:42,990
really<font color="#E5E5E5"> really big there's still a lot of</font>

300
00:12:40,889 --> 00:12:44,910
<font color="#E5E5E5">bad</font><font color="#CCCCCC"> stuff out there</font><font color="#E5E5E5"> and if you look at</font>

301
00:12:42,990 --> 00:12:48,180
the total<font color="#CCCCCC"> number of</font><font color="#E5E5E5"> certificates</font><font color="#CCCCCC"> that</font>

302
00:12:44,910 --> 00:12:50,160
<font color="#CCCCCC">are flagged by</font><font color="#E5E5E5"> um blacklist</font><font color="#CCCCCC"> they're</font>

303
00:12:48,180 --> 00:12:53,160
really small compared to<font color="#E5E5E5"> the problem</font>

304
00:12:50,160 --> 00:12:54,779
<font color="#CCCCCC">right</font><font color="#E5E5E5"> the SSL BL I think has somewhere</font>

305
00:12:53,160 --> 00:12:58,110
around a total of a hundred<font color="#E5E5E5"> and thirty</font>

306
00:12:54,779 --> 00:13:00,029
thousand certificate hashes<font color="#E5E5E5"> and the vast</font>

307
00:12:58,110 --> 00:13:02,610
<font color="#CCCCCC">majority of those are</font><font color="#E5E5E5"> for randomly</font>

308
00:13:00,029 --> 00:13:07,019
generated<font color="#CCCCCC"> dier servers which weren't</font>

309
00:13:02,610 --> 00:13:09,149
really an<font color="#E5E5E5"> issue as of February anyway so</font>

310
00:13:07,019 --> 00:13:13,470
if you went out and you blocked every

311
00:13:09,149 --> 00:13:16,679
access to every site on a<font color="#CCCCCC"> SSL blacklist</font>

312
00:13:13,470 --> 00:13:18,660
<font color="#CCCCCC">um you could pretty much guarantee that</font>

313
00:13:16,679 --> 00:13:19,920
you're still screwed right<font color="#CCCCCC"> it might</font><font color="#E5E5E5"> help</font>

314
00:13:18,660 --> 00:13:21,699
you out<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit but if that is your</font>

315
00:13:19,920 --> 00:13:25,540
sole line of<font color="#E5E5E5"> defense</font>

316
00:13:21,699 --> 00:13:27,008
you suck sorry<font color="#E5E5E5"> so the other thing is</font>

317
00:13:25,540 --> 00:13:28,660
<font color="#CCCCCC">that we can pretty much</font><font color="#E5E5E5"> trust that the</font>

318
00:13:27,009 --> 00:13:31,149
certificates<font color="#E5E5E5"> that are identified as bad</font>

319
00:13:28,660 --> 00:13:34,059
<font color="#E5E5E5">really aren't really are bad and they're</font>

320
00:13:31,149 --> 00:13:35,559
<font color="#CCCCCC">really gonna stay bad um the kind of</font>

321
00:13:34,059 --> 00:13:37,209
certificates that<font color="#CCCCCC"> we're talking about on</font>

322
00:13:35,559 --> 00:13:38,980
the blacklist<font color="#CCCCCC"> are done ones that were</font>

323
00:13:37,209 --> 00:13:41,290
done with malicious intent<font color="#CCCCCC"> right</font><font color="#E5E5E5"> that</font>

324
00:13:38,980 --> 00:13:44,799
<font color="#CCCCCC">they're they were specifically generated</font>

325
00:13:41,290 --> 00:13:47,498
to use on a situ<font color="#E5E5E5"> or malware distribution</font>

326
00:13:44,799 --> 00:13:49,119
server<font color="#E5E5E5"> these generally aren't hijack</font>

327
00:13:47,499 --> 00:13:51,369
certificates these aren't the kind<font color="#CCCCCC"> of</font>

328
00:13:49,119 --> 00:13:53,829
things where if you<font color="#CCCCCC"> are a small</font>

329
00:13:51,369 --> 00:13:57,279
electronics manufacturer in South Korea

330
00:13:53,829 --> 00:13:59,888
<font color="#E5E5E5">somebody hacks your website and starts</font>

331
00:13:57,279 --> 00:14:01,660
<font color="#CCCCCC">using your site to distribute malware</font>

332
00:13:59,889 --> 00:14:03,519
<font color="#CCCCCC">that's not the kind of stuff that</font><font color="#E5E5E5"> shows</font>

333
00:14:01,660 --> 00:14:05,559
up<font color="#E5E5E5"> on this particular blacklist at least</font>

334
00:14:03,519 --> 00:14:06,879
<font color="#E5E5E5">so this is the kind of thing where okay</font>

335
00:14:05,559 --> 00:14:09,999
we're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to clean up your site and</font>

336
00:14:06,879 --> 00:14:11,790
you're clean<font color="#CCCCCC"> now in a lot of</font><font color="#E5E5E5"> ways is</font>

337
00:14:09,999 --> 00:14:14,859
<font color="#CCCCCC">very similar to what we assume with</font>

338
00:14:11,790 --> 00:14:17,410
malware<font color="#E5E5E5"> md5</font><font color="#CCCCCC"> s right if it's a bad file</font>

339
00:14:14,859 --> 00:14:19,569
<font color="#CCCCCC">if it was a piece</font><font color="#E5E5E5"> of malware</font><font color="#CCCCCC"> it doesn't</font>

340
00:14:17,410 --> 00:14:23,049
generally become good at some point

341
00:14:19,569 --> 00:14:25,959
later and the last one which<font color="#CCCCCC"> is really</font>

342
00:14:23,049 --> 00:14:27,970
the hypothesis<font color="#E5E5E5"> some actors are going to</font>

343
00:14:25,959 --> 00:14:30,479
generate<font color="#CCCCCC"> certificates for</font><font color="#E5E5E5"> malware sites</font>

344
00:14:27,970 --> 00:14:33,189
specifically<font color="#E5E5E5"> to use for</font><font color="#CCCCCC"> c2</font><font color="#E5E5E5"> servers for</font>

345
00:14:30,480 --> 00:14:36,039
distribution<font color="#E5E5E5"> sites and a lot</font><font color="#CCCCCC"> of them do</font>

346
00:14:33,189 --> 00:14:37,868
it in<font color="#E5E5E5"> batches that look similar and what</font>

347
00:14:36,039 --> 00:14:41,169
do I'm based similar<font color="#E5E5E5"> similar means that</font>

348
00:14:37,869 --> 00:14:42,579
they have some<font color="#E5E5E5"> identical</font><font color="#CCCCCC"> metadata field</font>

349
00:14:41,169 --> 00:14:45,789
some of<font color="#E5E5E5"> those fields we were looking at</font>

350
00:14:42,579 --> 00:14:49,988
earlier<font color="#CCCCCC"> are</font><font color="#E5E5E5"> the same as some other</font>

351
00:14:45,789 --> 00:14:53,439
fields that<font color="#E5E5E5"> are bad or are used in</font>

352
00:14:49,989 --> 00:14:55,299
certificates that<font color="#CCCCCC"> were bad so with these</font>

353
00:14:53,439 --> 00:14:57,339
assumptions<font color="#CCCCCC"> I think we can build a</font>

354
00:14:55,299 --> 00:14:59,769
database of<font color="#E5E5E5"> certificate metadata that</font>

355
00:14:57,339 --> 00:15:01,480
<font color="#CCCCCC">can help</font><font color="#E5E5E5"> us find and track our</font>

356
00:14:59,769 --> 00:15:03,759
adversaries better than just using<font color="#E5E5E5"> the</font>

357
00:15:01,480 --> 00:15:06,069
<font color="#E5E5E5">block list right we can it's available</font>

358
00:15:03,759 --> 00:15:07,809
and things like<font color="#E5E5E5"> project sonar and some</font>

359
00:15:06,069 --> 00:15:12,608
of the targeting<font color="#CCCCCC"> information that we</font>

360
00:15:07,809 --> 00:15:13,988
have<font color="#E5E5E5"> using the</font><font color="#CCCCCC"> SSL BL feed and find</font>

361
00:15:12,609 --> 00:15:17,019
<font color="#E5E5E5">something that's a little bit better</font>

362
00:15:13,989 --> 00:15:19,089
than the sum of its<font color="#CCCCCC"> parts</font><font color="#E5E5E5"> um so this is</font>

363
00:15:17,019 --> 00:15:22,029
<font color="#E5E5E5">kind of just a general flow here right</font>

364
00:15:19,089 --> 00:15:24,669
we take information<font color="#E5E5E5"> from project sonar</font>

365
00:15:22,029 --> 00:15:26,439
<font color="#E5E5E5">well number one projects order spiders</font>

366
00:15:24,669 --> 00:15:28,329
the<font color="#CCCCCC"> internet we take information</font><font color="#E5E5E5"> from</font>

367
00:15:26,439 --> 00:15:30,399
<font color="#E5E5E5">them we run it through a bunch of Python</font>

368
00:15:28,329 --> 00:15:32,799
scripts<font color="#E5E5E5"> and the open s is whole binary</font>

369
00:15:30,399 --> 00:15:35,080
to generate basically a bunch of CSV

370
00:15:32,799 --> 00:15:37,780
files<font color="#E5E5E5"> where each row</font>

371
00:15:35,080 --> 00:15:39,460
at CSV represents<font color="#E5E5E5"> a certificate that was</font>

372
00:15:37,780 --> 00:15:41,910
observed<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the internet and then we</font>

373
00:15:39,460 --> 00:15:45,400
<font color="#E5E5E5">dump it into an Amazon redshift database</font>

374
00:15:41,910 --> 00:15:47,680
now we also apply the information<font color="#CCCCCC"> from</font>

375
00:15:45,400 --> 00:15:50,560
the<font color="#E5E5E5"> black list</font><font color="#CCCCCC"> to try to label</font><font color="#E5E5E5"> which</font>

376
00:15:47,680 --> 00:15:53,290
ones we know are bad<font color="#E5E5E5"> and which ones we</font>

377
00:15:50,560 --> 00:15:55,569
<font color="#E5E5E5">don't necessarily know a lot about my</font>

378
00:15:53,290 --> 00:15:57,819
CSV<font color="#E5E5E5"> files for this look a whole lot like</font>

379
00:15:55,570 --> 00:15:59,680
<font color="#E5E5E5">bro data fields if you've ever used bro</font>

380
00:15:57,820 --> 00:16:02,350
that's<font color="#CCCCCC"> mainly because when we started</font>

381
00:15:59,680 --> 00:16:05,199
this we<font color="#CCCCCC"> were using bro exclusively</font><font color="#E5E5E5"> um I</font>

382
00:16:02,350 --> 00:16:08,950
<font color="#E5E5E5">like bro</font><font color="#CCCCCC"> I use a lot the first paper</font><font color="#E5E5E5"> we</font>

383
00:16:05,200 --> 00:16:10,810
did on<font color="#E5E5E5"> this was entirely about bro</font><font color="#CCCCCC"> and I</font>

384
00:16:08,950 --> 00:16:13,900
mentioned Amazon redshift here<font color="#E5E5E5"> only</font>

385
00:16:10,810 --> 00:16:15,459
<font color="#E5E5E5">because it's cheap</font><font color="#CCCCCC"> and it's a</font><font color="#E5E5E5"> Postgres</font>

386
00:16:13,900 --> 00:16:17,800
cluster for people who have absolutely

387
00:16:15,460 --> 00:16:21,640
<font color="#E5E5E5">no</font><font color="#CCCCCC"> business trying to</font><font color="#E5E5E5"> set up</font><font color="#CCCCCC"> postgrads</font>

388
00:16:17,800 --> 00:16:23,650
clusters<font color="#CCCCCC"> like me it's I think</font><font color="#E5E5E5"> the</font>

389
00:16:21,640 --> 00:16:26,439
instance we use cost us<font color="#CCCCCC"> about</font><font color="#E5E5E5"> 50 cents</font>

390
00:16:23,650 --> 00:16:28,240
an hour<font color="#E5E5E5"> and you can once you load the</font>

391
00:16:26,440 --> 00:16:31,090
data in shut it down<font color="#E5E5E5"> terminate it</font>

392
00:16:28,240 --> 00:16:32,770
snapshot it bring it up<font color="#E5E5E5"> on demand so the</font>

393
00:16:31,090 --> 00:16:34,720
entire amount<font color="#E5E5E5"> of research here if I</font>

394
00:16:32,770 --> 00:16:35,980
wasn't<font color="#CCCCCC"> lazy and didn't forget</font><font color="#E5E5E5"> to</font>

395
00:16:34,720 --> 00:16:38,110
terminate it<font color="#E5E5E5"> at the end of the day most</font>

396
00:16:35,980 --> 00:16:40,210
<font color="#E5E5E5">of the days probably</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> have been</font>

397
00:16:38,110 --> 00:16:47,490
would<font color="#E5E5E5"> it cost us about the amount of</font><font color="#CCCCCC"> two</font>

398
00:16:40,210 --> 00:16:47,490
or<font color="#CCCCCC"> three burritos</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> wow that's</font><font color="#E5E5E5"> terrible</font>

399
00:16:48,480 --> 00:16:54,460
so this would be what it<font color="#CCCCCC"> would</font><font color="#E5E5E5"> look like</font>

400
00:16:51,880 --> 00:16:58,810
if you<font color="#E5E5E5"> were</font><font color="#CCCCCC"> looking at our database and</font>

401
00:16:54,460 --> 00:17:01,570
you couldn't see it all<font color="#E5E5E5"> um so this is</font>

402
00:16:58,810 --> 00:17:03,479
<font color="#CCCCCC">just kind of a</font><font color="#E5E5E5"> overall each one of these</font>

403
00:17:01,570 --> 00:17:06,459
columns represents<font color="#E5E5E5"> a separate data field</font>

404
00:17:03,480 --> 00:17:08,530
<font color="#E5E5E5">you notice maybe that most of these are</font>

405
00:17:06,459 --> 00:17:11,380
pretty sparse<font color="#E5E5E5"> most of the certificates</font>

406
00:17:08,530 --> 00:17:14,319
<font color="#E5E5E5">on the internet that are coming up</font>

407
00:17:11,380 --> 00:17:16,720
through<font color="#CCCCCC"> project sonar don't have most</font><font color="#E5E5E5"> of</font>

408
00:17:14,319 --> 00:17:20,800
the fields most of them may<font color="#CCCCCC"> only have</font>

409
00:17:16,720 --> 00:17:23,170
say the common name field which is right

410
00:17:20,800 --> 00:17:27,220
<font color="#CCCCCC">here</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> you can see is filled in</font>

411
00:17:23,170 --> 00:17:28,750
pretty pretty consistently so there<font color="#E5E5E5"> are</font>

412
00:17:27,220 --> 00:17:32,440
definitely ones that have full entries

413
00:17:28,750 --> 00:17:36,060
and this<font color="#CCCCCC"> is like the</font><font color="#E5E5E5"> the yeah this is</font>

414
00:17:32,440 --> 00:17:38,170
<font color="#CCCCCC">location</font><font color="#E5E5E5"> this is the country</font><font color="#CCCCCC"> code</font>

415
00:17:36,060 --> 00:17:39,820
there are definitely certificates that

416
00:17:38,170 --> 00:17:42,220
<font color="#CCCCCC">have</font><font color="#E5E5E5"> that information but a lot of them</font>

417
00:17:39,820 --> 00:17:43,810
don't<font color="#E5E5E5"> um and a lot of that is because</font>

418
00:17:42,220 --> 00:17:45,640
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> just a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> devices out there</font>

419
00:17:43,810 --> 00:17:48,520
<font color="#CCCCCC">that just have</font><font color="#E5E5E5"> an SSL certificate that</font>

420
00:17:45,640 --> 00:17:52,120
just says<font color="#E5E5E5"> hi I'm you know</font><font color="#CCCCCC"> ten</font>

421
00:17:48,520 --> 00:17:53,200
15.1 27.8<font color="#E5E5E5"> and that's it we can't</font>

422
00:17:52,120 --> 00:17:57,580
necessarily tell a lot of<font color="#E5E5E5"> information</font>

423
00:17:53,200 --> 00:17:59,530
<font color="#CCCCCC">about</font><font color="#E5E5E5"> that so I do want to talk about</font>

424
00:17:57,580 --> 00:18:00,639
what we can find and<font color="#CCCCCC"> what we can't find</font>

425
00:17:59,530 --> 00:18:04,180
though<font color="#E5E5E5"> because there are a lot</font><font color="#CCCCCC"> of</font>

426
00:18:00,640 --> 00:18:05,950
caveats to<font color="#CCCCCC"> this</font><font color="#E5E5E5"> what we can't find the</font>

427
00:18:04,180 --> 00:18:07,540
example I<font color="#CCCCCC"> mentioned earlier hijacked or</font>

428
00:18:05,950 --> 00:18:09,850
compromised certificates<font color="#E5E5E5"> if the</font>

429
00:18:07,540 --> 00:18:11,680
<font color="#CCCCCC">certificate was a good certificate when</font>

430
00:18:09,850 --> 00:18:13,570
it was generated if there was no

431
00:18:11,680 --> 00:18:15,490
malicious<font color="#CCCCCC"> intent that went into it there</font>

432
00:18:13,570 --> 00:18:18,610
probably<font color="#E5E5E5"> no patterns that we could be</font>

433
00:18:15,490 --> 00:18:19,360
recognized um after<font color="#E5E5E5"> the fact</font><font color="#CCCCCC"> after it</font>

434
00:18:18,610 --> 00:18:21,520
was hijacked

435
00:18:19,360 --> 00:18:23,979
if you generated a good certificate for

436
00:18:21,520 --> 00:18:25,810
<font color="#E5E5E5">your website um and you did</font><font color="#CCCCCC"> all the</font>

437
00:18:23,980 --> 00:18:28,300
things that<font color="#CCCCCC"> people who generate good</font>

438
00:18:25,810 --> 00:18:30,159
certificates do and then somebody<font color="#CCCCCC"> else</font>

439
00:18:28,300 --> 00:18:32,830
hijacks it later that<font color="#E5E5E5"> doesn't change the</font>

440
00:18:30,160 --> 00:18:34,990
certificate<font color="#CCCCCC"> I can't tell anything about</font>

441
00:18:32,830 --> 00:18:36,490
that<font color="#E5E5E5"> um this</font><font color="#CCCCCC"> also doesn't</font><font color="#E5E5E5"> really help</font>

442
00:18:34,990 --> 00:18:38,770
<font color="#E5E5E5">against targeted attacks right if you</font>

443
00:18:36,490 --> 00:18:40,660
<font color="#E5E5E5">are if somebody is</font><font color="#CCCCCC"> coming up with</font>

444
00:18:38,770 --> 00:18:42,940
infrastructure specifically<font color="#E5E5E5"> to target</font>

445
00:18:40,660 --> 00:18:45,040
your organization<font color="#E5E5E5"> they're probably going</font>

446
00:18:42,940 --> 00:18:46,810
<font color="#E5E5E5">to do it a little differently than</font><font color="#CCCCCC"> they</font>

447
00:18:45,040 --> 00:18:47,950
did<font color="#E5E5E5"> the previous time there probably</font>

448
00:18:46,810 --> 00:18:48,879
aren't going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be a lot of patterns are</font>

449
00:18:47,950 --> 00:18:51,040
it's<font color="#E5E5E5"> possible</font>

450
00:18:48,880 --> 00:18:53,130
but it's extremely<font color="#CCCCCC"> unlikely this is</font>

451
00:18:51,040 --> 00:18:56,260
generally for<font color="#CCCCCC"> the kind of crime where</font>

452
00:18:53,130 --> 00:18:59,440
stuff where somebody is just targeting<font color="#E5E5E5"> a</font>

453
00:18:56,260 --> 00:19:00,160
whole group of people unilaterally<font color="#CCCCCC"> the</font>

454
00:18:59,440 --> 00:19:01,660
<font color="#E5E5E5">other thing that's not going to help</font>

455
00:19:00,160 --> 00:19:05,020
<font color="#CCCCCC">with</font><font color="#E5E5E5"> it all is initial waves of</font>

456
00:19:01,660 --> 00:19:08,950
campaigns<font color="#CCCCCC"> the way that we're looking</font><font color="#E5E5E5"> at</font>

457
00:19:05,020 --> 00:19:10,720
things right now<font color="#E5E5E5"> we are</font><font color="#CCCCCC"> using</font><font color="#E5E5E5"> SSL BL as</font>

458
00:19:08,950 --> 00:19:12,730
the pointy<font color="#E5E5E5"> end of the stick</font><font color="#CCCCCC"> right they</font>

459
00:19:10,720 --> 00:19:15,790
<font color="#E5E5E5">have to recognize</font><font color="#CCCCCC"> something as</font><font color="#E5E5E5"> being bad</font>

460
00:19:12,730 --> 00:19:18,640
first before<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can start recognizing</font><font color="#CCCCCC"> if</font>

461
00:19:15,790 --> 00:19:21,159
there are patterns<font color="#E5E5E5"> there on the plus</font>

462
00:19:18,640 --> 00:19:23,650
<font color="#E5E5E5">side it does find a fair</font><font color="#CCCCCC"> amount of stuff</font>

463
00:19:21,160 --> 00:19:26,020
though<font color="#E5E5E5"> it finds a lot of certificates</font>

464
00:19:23,650 --> 00:19:27,850
<font color="#E5E5E5">that were specifically issued so that</font>

465
00:19:26,020 --> 00:19:29,950
someone could<font color="#E5E5E5"> distribute malware from it</font>

466
00:19:27,850 --> 00:19:30,520
<font color="#E5E5E5">finds a lot of</font><font color="#CCCCCC"> Kimani malware torrent</font>

467
00:19:29,950 --> 00:19:33,430
<font color="#CCCCCC">Locker</font>

468
00:19:30,520 --> 00:19:36,610
like<font color="#CCCCCC"> I said dry decks dire rootkit um</font>

469
00:19:33,430 --> 00:19:38,170
and it<font color="#E5E5E5"> finds a whole lot of dumb</font><font color="#CCCCCC"> when we</font>

470
00:19:36,610 --> 00:19:39,340
were looking looking through these

471
00:19:38,170 --> 00:19:41,440
<font color="#E5E5E5">especially we were looking through</font><font color="#CCCCCC"> them</font>

472
00:19:39,340 --> 00:19:44,709
manually<font color="#E5E5E5"> we noticed a whole lot of</font>

473
00:19:41,440 --> 00:19:47,380
patterns<font color="#E5E5E5"> that just seemed to display a</font>

474
00:19:44,710 --> 00:19:49,270
striking lack of intelligence<font color="#CCCCCC"> on behalf</font>

475
00:19:47,380 --> 00:19:52,240
of the<font color="#E5E5E5"> people who are generating</font><font color="#CCCCCC"> these</font>

476
00:19:49,270 --> 00:19:54,400
certificates<font color="#E5E5E5"> and I'll I have</font><font color="#CCCCCC"> a couple</font>

477
00:19:52,240 --> 00:19:56,140
<font color="#CCCCCC">examples of</font><font color="#E5E5E5"> these later</font><font color="#CCCCCC"> but I couldn't</font>

478
00:19:54,400 --> 00:19:57,820
put in too much<font color="#E5E5E5"> if you're really</font>

479
00:19:56,140 --> 00:20:01,300
interested in this talk to me afterwards

480
00:19:57,820 --> 00:20:03,460
<font color="#CCCCCC">cuz there's some funny in there um</font>

481
00:20:01,300 --> 00:20:05,590
so the first thing we started off<font color="#E5E5E5"> with</font>

482
00:20:03,460 --> 00:20:07,150
we said<font color="#CCCCCC"> all right we really</font><font color="#E5E5E5"> want to</font>

483
00:20:05,590 --> 00:20:08,830
<font color="#E5E5E5">determine if a</font><font color="#CCCCCC"> certificate is good or</font>

484
00:20:07,150 --> 00:20:11,200
bad<font color="#CCCCCC"> we want to give</font><font color="#E5E5E5"> it a binary</font>

485
00:20:08,830 --> 00:20:14,080
<font color="#E5E5E5">classification</font><font color="#CCCCCC"> we want to just say</font><font color="#E5E5E5"> yes</font>

486
00:20:11,200 --> 00:20:17,680
or<font color="#E5E5E5"> no so you know effectively we're</font>

487
00:20:14,080 --> 00:20:20,050
building a binary classifier model the

488
00:20:17,680 --> 00:20:22,510
very simple implementation<font color="#CCCCCC"> for that is</font>

489
00:20:20,050 --> 00:20:24,550
<font color="#E5E5E5">just use a logistic regression</font><font color="#CCCCCC"> algorithm</font>

490
00:20:22,510 --> 00:20:26,010
it's an algorithm<font color="#CCCCCC"> it's a very</font><font color="#E5E5E5"> common</font>

491
00:20:24,550 --> 00:20:28,149
method has a whole lot<font color="#CCCCCC"> of</font>

492
00:20:26,010 --> 00:20:30,340
implementations available it's a

493
00:20:28,150 --> 00:20:31,210
supervised learning model<font color="#E5E5E5"> but basically</font>

494
00:20:30,340 --> 00:20:34,000
what we're going<font color="#E5E5E5"> to do is we're</font><font color="#CCCCCC"> going to</font>

495
00:20:31,210 --> 00:20:36,790
<font color="#CCCCCC">use that</font><font color="#E5E5E5"> SS</font><font color="#CCCCCC"> LBL data we have to</font><font color="#E5E5E5"> label</font>

496
00:20:34,000 --> 00:20:38,200
our data<font color="#CCCCCC"> to say this is</font><font color="#E5E5E5"> bad stuff we</font>

497
00:20:36,790 --> 00:20:40,510
don't<font color="#CCCCCC"> know if this is bad</font><font color="#E5E5E5"> stuff or not</font>

498
00:20:38,200 --> 00:20:42,190
<font color="#E5E5E5">or um you know we can incorporate some</font>

499
00:20:40,510 --> 00:20:42,940
<font color="#E5E5E5">other data to say we're sure this is not</font>

500
00:20:42,190 --> 00:20:45,940
bad stuff

501
00:20:42,940 --> 00:20:48,220
so we have an<font color="#E5E5E5"> idea of for a given data</font>

502
00:20:45,940 --> 00:20:50,950
<font color="#E5E5E5">set if it's good</font><font color="#CCCCCC"> or bad</font><font color="#E5E5E5"> and we can use</font>

503
00:20:48,220 --> 00:20:53,380
that<font color="#CCCCCC"> to</font><font color="#E5E5E5"> train our model um so our first</font>

504
00:20:50,950 --> 00:20:55,990
try<font color="#E5E5E5"> was all right let's just label some</font>

505
00:20:53,380 --> 00:21:00,910
good data using<font color="#E5E5E5"> sources like Alexa top 1</font>

506
00:20:55,990 --> 00:21:02,950
<font color="#E5E5E5">million the SSL notary um that kind</font><font color="#CCCCCC"> of</font>

507
00:21:00,910 --> 00:21:05,290
<font color="#E5E5E5">rates certificates let's just label</font><font color="#CCCCCC"> 5</font>

508
00:21:02,950 --> 00:21:07,390
<font color="#E5E5E5">million certificates and take all the</font>

509
00:21:05,290 --> 00:21:09,520
bad certificates we have throw them into

510
00:21:07,390 --> 00:21:12,670
a logistic regression<font color="#CCCCCC"> model</font><font color="#E5E5E5"> and see what</font>

511
00:21:09,520 --> 00:21:16,360
happens<font color="#E5E5E5"> so not a lot</font><font color="#CCCCCC"> of good things</font>

512
00:21:12,670 --> 00:21:18,220
happened<font color="#E5E5E5"> so we labeled 5 million good</font>

513
00:21:16,360 --> 00:21:19,570
certificates we had<font color="#E5E5E5"> one thousand three</font>

514
00:21:18,220 --> 00:21:21,430
<font color="#E5E5E5">hundred</font><font color="#CCCCCC"> and thirty-five certificates</font>

515
00:21:19,570 --> 00:21:24,580
that<font color="#E5E5E5"> were recognized bad that showed up</font>

516
00:21:21,430 --> 00:21:27,610
in<font color="#E5E5E5"> the projects on our data so this here</font>

517
00:21:24,580 --> 00:21:30,490
is<font color="#E5E5E5"> a graph of the good certificates</font>

518
00:21:27,610 --> 00:21:31,899
versus the bad certificates see that

519
00:21:30,490 --> 00:21:33,190
little line<font color="#CCCCCC"> right there</font>

520
00:21:31,900 --> 00:21:34,690
<font color="#E5E5E5">now of course you don't</font><font color="#CCCCCC"> you know it</font>

521
00:21:33,190 --> 00:21:36,730
doesn't<font color="#E5E5E5"> even render the line it doesn't</font>

522
00:21:34,690 --> 00:21:38,560
matter that<font color="#E5E5E5"> the projector sucks</font><font color="#CCCCCC"> okay</font>

523
00:21:36,730 --> 00:21:40,270
<font color="#E5E5E5">we're talking</font><font color="#CCCCCC"> about 5 million</font>

524
00:21:38,560 --> 00:21:44,230
certificates that<font color="#E5E5E5"> we know are good out</font>

525
00:21:40,270 --> 00:21:46,110
of<font color="#E5E5E5"> a set of five million 1335 so that</font>

526
00:21:44,230 --> 00:21:48,850
means that on<font color="#CCCCCC"> 99</font>

527
00:21:46,110 --> 00:21:51,310
ninety-nine point nine seven<font color="#CCCCCC"> three</font>

528
00:21:48,850 --> 00:21:53,649
percent of<font color="#E5E5E5"> our certificates were good um</font>

529
00:21:51,310 --> 00:21:55,659
<font color="#CCCCCC">so and we threw an into a model and it</font>

530
00:21:53,650 --> 00:21:57,820
said it had absolutely amazing accuracy

531
00:21:55,660 --> 00:21:59,620
<font color="#E5E5E5">great fit rate</font><font color="#CCCCCC"> in a couple of</font><font color="#E5E5E5"> minutes we</font>

532
00:21:57,820 --> 00:22:00,879
<font color="#E5E5E5">realize</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> problem anybody anybody see</font>

533
00:21:59,620 --> 00:22:07,060
the problem with<font color="#CCCCCC"> this just</font><font color="#E5E5E5"> right off the</font>

534
00:22:00,880 --> 00:22:09,490
<font color="#CCCCCC">bat no okay um so we basically taught</font>

535
00:22:07,060 --> 00:22:11,770
our model how to lie<font color="#E5E5E5"> it just said you</font>

536
00:22:09,490 --> 00:22:14,350
know<font color="#E5E5E5"> what every single certificate in</font>

537
00:22:11,770 --> 00:22:17,260
the<font color="#E5E5E5"> world is good</font>

538
00:22:14,350 --> 00:22:21,560
there are no bad things in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> world</font>

539
00:22:17,260 --> 00:22:23,450
<font color="#E5E5E5">awesome I am right 99.97% of the time we</font>

540
00:22:21,560 --> 00:22:25,129
taught computers how to lie<font color="#E5E5E5"> we taught</font>

541
00:22:23,450 --> 00:22:27,770
<font color="#CCCCCC">him how to cheat</font><font color="#E5E5E5"> we may be one step</font>

542
00:22:25,130 --> 00:22:31,300
<font color="#CCCCCC">closer to Skynet if this leads to the</font>

543
00:22:27,770 --> 00:22:33,860
enslavement<font color="#CCCCCC"> of humanity oops my bad</font>

544
00:22:31,300 --> 00:22:36,350
<font color="#CCCCCC">there are thresholds you</font><font color="#E5E5E5"> can adjust with</font>

545
00:22:33,860 --> 00:22:39,350
a logistic regression model<font color="#CCCCCC"> to prefer</font>

546
00:22:36,350 --> 00:22:41,689
false positive versus false negative

547
00:22:39,350 --> 00:22:45,100
results<font color="#CCCCCC"> in a case like this</font><font color="#E5E5E5"> it doesn't</font>

548
00:22:41,690 --> 00:22:47,270
<font color="#E5E5E5">matter it's you are so far biased</font>

549
00:22:45,100 --> 00:22:49,699
towards good results<font color="#E5E5E5"> because you've</font>

550
00:22:47,270 --> 00:22:53,840
given<font color="#CCCCCC"> it so much more good stuff</font><font color="#E5E5E5"> that</font>

551
00:22:49,700 --> 00:22:55,520
it's always<font color="#E5E5E5"> going to fail</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we learned</font>

552
00:22:53,840 --> 00:22:58,490
pretty quickly that<font color="#E5E5E5"> you really need to</font>

553
00:22:55,520 --> 00:23:01,670
<font color="#E5E5E5">bias your data you need to split things</font>

554
00:22:58,490 --> 00:23:03,500
<font color="#E5E5E5">up in a way</font><font color="#CCCCCC"> that makes more sense to the</font>

555
00:23:01,670 --> 00:23:05,090
model you<font color="#E5E5E5"> need to start with datasets</font>

556
00:23:03,500 --> 00:23:06,380
where the amount<font color="#CCCCCC"> of good things you give</font>

557
00:23:05,090 --> 00:23:08,600
it and<font color="#CCCCCC"> the</font><font color="#E5E5E5"> amount of bad things do you</font>

558
00:23:06,380 --> 00:23:10,220
get it<font color="#E5E5E5"> are a little bit closer so</font><font color="#CCCCCC"> that</font>

559
00:23:08,600 --> 00:23:10,669
<font color="#CCCCCC">you don't</font><font color="#E5E5E5"> just train it whole world's</font>

560
00:23:10,220 --> 00:23:13,400
good

561
00:23:10,670 --> 00:23:17,690
there's no badness here and create the

562
00:23:13,400 --> 00:23:19,160
eternal optimist computer model so we

563
00:23:17,690 --> 00:23:20,960
<font color="#E5E5E5">thought</font><font color="#CCCCCC"> ok let's let's</font><font color="#E5E5E5"> try something a</font>

564
00:23:19,160 --> 00:23:22,700
little<font color="#E5E5E5"> bit different we went on we tried</font>

565
00:23:20,960 --> 00:23:24,470
some<font color="#E5E5E5"> other things eventually we came</font><font color="#CCCCCC"> to</font>

566
00:23:22,700 --> 00:23:26,690
a use case where<font color="#E5E5E5"> you said all right</font>

567
00:23:24,470 --> 00:23:31,130
<font color="#E5E5E5">let's let's talk</font><font color="#CCCCCC"> about random looking</font>

568
00:23:26,690 --> 00:23:32,630
values<font color="#CCCCCC"> and I okay my slide there</font><font color="#E5E5E5"> is</font>

569
00:23:31,130 --> 00:23:36,170
missing<font color="#CCCCCC"> it doesn't</font><font color="#E5E5E5"> matter you guys</font>

570
00:23:32,630 --> 00:23:38,720
<font color="#E5E5E5">wouldn't build C</font><font color="#CCCCCC"> n anyway so there were</font>

571
00:23:36,170 --> 00:23:41,330
a lot<font color="#CCCCCC"> of values that we came</font><font color="#E5E5E5"> up</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> in</font>

572
00:23:38,720 --> 00:23:44,090
<font color="#CCCCCC">terms of the bad certificates that had a</font>

573
00:23:41,330 --> 00:23:49,580
lot of<font color="#E5E5E5"> random values specifically in the</font>

574
00:23:44,090 --> 00:23:52,909
location the<font color="#CCCCCC"> oak</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> I'm tryna</font><font color="#E5E5E5"> remember</font>

575
00:23:49,580 --> 00:23:55,250
<font color="#E5E5E5">its location the common name and the</font>

576
00:23:52,910 --> 00:23:58,130
<font color="#E5E5E5">organization fields and when I say</font>

577
00:23:55,250 --> 00:24:00,170
random<font color="#E5E5E5"> I mean these were values that</font>

578
00:23:58,130 --> 00:24:02,510
were of varying<font color="#E5E5E5"> length that had</font>

579
00:24:00,170 --> 00:24:04,730
characters a through Z<font color="#CCCCCC"> lower case and</font>

580
00:24:02,510 --> 00:24:07,310
<font color="#CCCCCC">upper case</font><font color="#E5E5E5"> and numerical values and you</font>

581
00:24:04,730 --> 00:24:10,130
could it was very easy<font color="#CCCCCC"> for a person to</font>

582
00:24:07,310 --> 00:24:14,750
kind<font color="#E5E5E5"> of look at</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and say yeah this is</font>

583
00:24:10,130 --> 00:24:15,530
complete<font color="#E5E5E5"> junk</font><font color="#CCCCCC"> it's possible to recognize</font>

584
00:24:14,750 --> 00:24:17,390
these kind of things by doing

585
00:24:15,530 --> 00:24:19,399
<font color="#E5E5E5">transformation right compute Shannon</font>

586
00:24:17,390 --> 00:24:21,500
entropy<font color="#E5E5E5"> on every field and look for</font>

587
00:24:19,400 --> 00:24:23,330
certain<font color="#E5E5E5"> cutoff say this is a number of</font>

588
00:24:21,500 --> 00:24:26,840
unique characters<font color="#CCCCCC"> that appear here</font><font color="#E5E5E5"> um</font>

589
00:24:23,330 --> 00:24:27,870
that's kind<font color="#E5E5E5"> of expensive to do on every</font>

590
00:24:26,840 --> 00:24:30,030
piece<font color="#CCCCCC"> of</font><font color="#E5E5E5"> data</font>

591
00:24:27,870 --> 00:24:31,350
not just in our set<font color="#E5E5E5"> but eventually when</font>

592
00:24:30,030 --> 00:24:33,120
<font color="#CCCCCC">we want to try to</font><font color="#E5E5E5"> apply</font><font color="#CCCCCC"> the stuff to</font>

593
00:24:31,350 --> 00:24:34,850
live traffic<font color="#E5E5E5"> doing it for every</font>

594
00:24:33,120 --> 00:24:36,870
certificate that comes<font color="#E5E5E5"> across your box</font>

595
00:24:34,850 --> 00:24:38,580
<font color="#CCCCCC">and we really wanted to try to do this</font>

596
00:24:36,870 --> 00:24:42,989
without creating<font color="#CCCCCC"> more problem specific</font>

597
00:24:38,580 --> 00:24:44,970
attributes<font color="#E5E5E5"> so we took our 1335 bad</font>

598
00:24:42,990 --> 00:24:48,690
certificates<font color="#E5E5E5"> and we all we label all as</font>

599
00:24:44,970 --> 00:24:51,000
random or not<font color="#E5E5E5"> um</font><font color="#CCCCCC"> and we came up that 38%</font>

600
00:24:48,690 --> 00:24:52,410
<font color="#E5E5E5">of</font><font color="#CCCCCC"> their certificates we had which</font>

601
00:24:51,000 --> 00:24:53,010
totally says down on<font color="#E5E5E5"> that</font><font color="#CCCCCC"> thing you</font>

602
00:24:52,410 --> 00:24:57,660
<font color="#E5E5E5">can't see</font>

603
00:24:53,010 --> 00:25:02,309
<font color="#CCCCCC">we're random I</font><font color="#E5E5E5"> do a slide and totally</font>

604
00:24:57,660 --> 00:25:05,610
can't see that<font color="#CCCCCC"> but</font><font color="#E5E5E5"> we you know</font><font color="#CCCCCC"> 38% is a</font>

605
00:25:02,309 --> 00:25:07,230
pretty surprising<font color="#CCCCCC"> percentage when you're</font>

606
00:25:05,610 --> 00:25:11,370
talking<font color="#E5E5E5"> about all the bad things that</font>

607
00:25:07,230 --> 00:25:14,130
<font color="#E5E5E5">you found total um so we said alright</font>

608
00:25:11,370 --> 00:25:16,949
<font color="#E5E5E5">let's</font><font color="#CCCCCC"> take this and in the column here</font>

609
00:25:14,130 --> 00:25:18,540
<font color="#E5E5E5">is one that we added that's just called</font>

610
00:25:16,950 --> 00:25:20,309
looks random<font color="#CCCCCC"> this was something that</font><font color="#E5E5E5"> a</font>

611
00:25:18,540 --> 00:25:22,379
person<font color="#E5E5E5"> went through all thousand all</font>

612
00:25:20,309 --> 00:25:24,120
<font color="#CCCCCC">1300 certificates and they just said</font>

613
00:25:22,380 --> 00:25:26,760
<font color="#E5E5E5">this one looks</font><font color="#CCCCCC"> like it it's random this</font>

614
00:25:24,120 --> 00:25:28,709
one doesn't<font color="#E5E5E5"> um</font><font color="#CCCCCC"> so we</font><font color="#E5E5E5"> we went through and</font>

615
00:25:26,760 --> 00:25:30,870
we<font color="#E5E5E5"> did a ledger logistic regression</font>

616
00:25:28,710 --> 00:25:32,309
model<font color="#CCCCCC"> on</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> too and</font><font color="#E5E5E5"> this time we found</font>

617
00:25:30,870 --> 00:25:34,820
something<font color="#CCCCCC"> it was pretty good we were</font>

618
00:25:32,309 --> 00:25:38,010
still<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> 95% and it was giving us</font>

619
00:25:34,820 --> 00:25:39,780
for both false<font color="#CCCCCC"> or for both</font><font color="#E5E5E5"> positive and</font>

620
00:25:38,010 --> 00:25:41,850
negative<font color="#E5E5E5"> results so it was able to</font>

621
00:25:39,780 --> 00:25:44,129
differentiate<font color="#CCCCCC"> the majority of</font><font color="#E5E5E5"> the time</font>

622
00:25:41,850 --> 00:25:45,840
um whether or not this<font color="#E5E5E5"> was something</font>

623
00:25:44,130 --> 00:25:48,480
that was a random<font color="#CCCCCC"> value</font><font color="#E5E5E5"> that kind of</font>

624
00:25:45,840 --> 00:25:50,070
looked bad the bad news is we started

625
00:25:48,480 --> 00:25:52,290
playing<font color="#CCCCCC"> around</font><font color="#E5E5E5"> with it and we started</font>

626
00:25:50,070 --> 00:25:54,570
<font color="#CCCCCC">realizing that</font><font color="#E5E5E5"> it was entirely basing it</font>

627
00:25:52,290 --> 00:25:56,129
on the state and<font color="#E5E5E5"> country codes so the</font>

628
00:25:54,570 --> 00:25:58,740
state codes and country codes most<font color="#E5E5E5"> of</font>

629
00:25:56,130 --> 00:26:01,440
the time<font color="#CCCCCC"> our two character values both</font>

630
00:25:58,740 --> 00:26:05,130
<font color="#CCCCCC">upper case and so you can say</font><font color="#E5E5E5"> all right</font>

631
00:26:01,440 --> 00:26:07,590
<font color="#E5E5E5">well I've got letters 26 letters so 26</font>

632
00:26:05,130 --> 00:26:10,230
squared<font color="#E5E5E5"> operations each you've only got</font>

633
00:26:07,590 --> 00:26:12,540
26 to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> fourth possible combinations</font>

634
00:26:10,230 --> 00:26:15,660
there so it basically<font color="#E5E5E5"> ignored all the</font>

635
00:26:12,540 --> 00:26:17,790
<font color="#CCCCCC">other values that we had the</font><font color="#E5E5E5"> other very</font>

636
00:26:15,660 --> 00:26:20,520
long random<font color="#E5E5E5"> text</font><font color="#CCCCCC"> rings</font><font color="#E5E5E5"> and it just said</font>

637
00:26:17,790 --> 00:26:22,590
all<font color="#CCCCCC"> right I'm just gonna based on this</font>

638
00:26:20,520 --> 00:26:25,020
these two values figure<font color="#E5E5E5"> out which ones</font>

639
00:26:22,590 --> 00:26:29,159
are common and good and which<font color="#CCCCCC"> ones are</font>

640
00:26:25,020 --> 00:26:30,840
really<font color="#E5E5E5"> rare</font><font color="#CCCCCC"> and bad um there's a lot</font>

641
00:26:29,160 --> 00:26:32,370
easier way to do this<font color="#CCCCCC"> right there's a</font>

642
00:26:30,840 --> 00:26:34,740
method<font color="#CCCCCC"> called bloom filters which are</font>

643
00:26:32,370 --> 00:26:38,070
basically a probabilistic way<font color="#E5E5E5"> of taking</font>

644
00:26:34,740 --> 00:26:39,750
sparse data and creating a<font color="#E5E5E5"> filter out of</font>

645
00:26:38,070 --> 00:26:41,000
it saying yes it matches<font color="#CCCCCC"> this pattern or</font>

646
00:26:39,750 --> 00:26:43,310
no it doesn't

647
00:26:41,000 --> 00:26:45,320
by using a bloom<font color="#CCCCCC"> filter and just finding</font>

648
00:26:43,310 --> 00:26:47,480
out which ones are really really common

649
00:26:45,320 --> 00:26:49,520
<font color="#E5E5E5">country codes which ones are really</font>

650
00:26:47,480 --> 00:26:54,590
really common<font color="#E5E5E5"> state codes if I have a</font>

651
00:26:49,520 --> 00:26:56,480
state<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> VK</font><font color="#E5E5E5"> chances are that's</font><font color="#CCCCCC"> not</font>

652
00:26:54,590 --> 00:26:58,850
something good that's<font color="#E5E5E5"> probably something</font>

653
00:26:56,480 --> 00:27:00,650
<font color="#E5E5E5">random and if I combine</font><font color="#CCCCCC"> that with a</font>

654
00:26:58,850 --> 00:27:02,929
country<font color="#E5E5E5"> code that no one's ever heard of</font>

655
00:27:00,650 --> 00:27:04,220
as well then<font color="#E5E5E5"> we</font><font color="#CCCCCC"> have a</font><font color="#E5E5E5"> pretty good</font>

656
00:27:02,930 --> 00:27:08,060
likelihood<font color="#CCCCCC"> that this</font><font color="#E5E5E5"> was</font><font color="#CCCCCC"> just something</font>

657
00:27:04,220 --> 00:27:10,670
<font color="#E5E5E5">entirely randomly generated</font><font color="#CCCCCC"> this method</font>

658
00:27:08,060 --> 00:27:14,389
is a lot less computationally intensive

659
00:27:10,670 --> 00:27:15,920
to run with then the running an entire

660
00:27:14,390 --> 00:27:18,550
logistic regression model<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then</font>

661
00:27:15,920 --> 00:27:20,840
evaluating something<font color="#E5E5E5"> against that model</font>

662
00:27:18,550 --> 00:27:22,700
<font color="#E5E5E5">like it's not a hundred</font><font color="#CCCCCC"> percent accurate</font>

663
00:27:20,840 --> 00:27:24,110
<font color="#CCCCCC">because we're talking about</font><font color="#E5E5E5"> random</font>

664
00:27:22,700 --> 00:27:26,840
<font color="#E5E5E5">values it's always possible</font><font color="#CCCCCC"> that</font>

665
00:27:24,110 --> 00:27:28,820
<font color="#E5E5E5">somebody can generate a</font><font color="#CCCCCC"> u.s.</font><font color="#E5E5E5"> country</font>

666
00:27:26,840 --> 00:27:31,280
code at random<font color="#CCCCCC"> and combine it with</font>

667
00:27:28,820 --> 00:27:35,870
<font color="#E5E5E5">something it's a valid state code but</font>

668
00:27:31,280 --> 00:27:38,450
probability<font color="#E5E5E5"> is quite low so</font><font color="#CCCCCC"> we did some</font>

669
00:27:35,870 --> 00:27:40,129
<font color="#CCCCCC">more work we started realizing overall</font>

670
00:27:38,450 --> 00:27:42,770
<font color="#E5E5E5">we were trying to come up with</font><font color="#CCCCCC"> different</font>

671
00:27:40,130 --> 00:27:44,840
<font color="#CCCCCC">patterns of things we were</font><font color="#E5E5E5"> trying to</font>

672
00:27:42,770 --> 00:27:47,900
<font color="#E5E5E5">come up</font><font color="#CCCCCC"> with different</font><font color="#E5E5E5"> groups of</font>

673
00:27:44,840 --> 00:27:50,149
problems different<font color="#E5E5E5"> groups of bad</font>

674
00:27:47,900 --> 00:27:52,010
certificates that<font color="#E5E5E5"> we could come</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> with</font>

675
00:27:50,150 --> 00:27:54,530
and<font color="#E5E5E5"> and find</font><font color="#CCCCCC"> something that</font><font color="#E5E5E5"> was usable</font>

676
00:27:52,010 --> 00:27:56,450
<font color="#E5E5E5">and we ended up</font><font color="#CCCCCC"> just kind</font><font color="#E5E5E5"> of settling on</font>

677
00:27:54,530 --> 00:27:58,760
and we<font color="#E5E5E5"> got our best results out of</font><font color="#CCCCCC"> just</font>

678
00:27:56,450 --> 00:28:01,340
simple clustering clustering is all

679
00:27:58,760 --> 00:28:03,890
about counting occurrences of specific

680
00:28:01,340 --> 00:28:05,870
values<font color="#E5E5E5"> you start and we decided let's</font>

681
00:28:03,890 --> 00:28:08,210
start with the most<font color="#E5E5E5"> common values for a</font>

682
00:28:05,870 --> 00:28:11,060
<font color="#CCCCCC">given attribute</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> the location</font><font color="#E5E5E5"> what</font>

683
00:28:08,210 --> 00:28:15,050
are the common locations<font color="#E5E5E5"> you know there</font>

684
00:28:11,060 --> 00:28:16,850
are like say<font color="#E5E5E5"> London</font><font color="#CCCCCC"> Springfield York you</font>

685
00:28:15,050 --> 00:28:19,570
look for other<font color="#E5E5E5"> common attributes then</font>

686
00:28:16,850 --> 00:28:21,740
<font color="#E5E5E5">our happen in that same set of results</font>

687
00:28:19,570 --> 00:28:23,570
<font color="#CCCCCC">okay what's the country code that</font>

688
00:28:21,740 --> 00:28:26,180
generally<font color="#E5E5E5"> corresponds with London most</font>

689
00:28:23,570 --> 00:28:27,620
of the time<font color="#E5E5E5"> its Great Britain um that</font>

690
00:28:26,180 --> 00:28:29,810
one's kind<font color="#E5E5E5"> of obvious</font><font color="#CCCCCC"> but then other</font>

691
00:28:27,620 --> 00:28:32,000
ones like what<font color="#CCCCCC"> organisations in our set</font>

692
00:28:29,810 --> 00:28:34,340
of bad certificates<font color="#E5E5E5"> normally correspond</font>

693
00:28:32,000 --> 00:28:36,140
with London then you start finding<font color="#E5E5E5"> more</font>

694
00:28:34,340 --> 00:28:38,000
interesting things<font color="#E5E5E5"> this is a little</font>

695
00:28:36,140 --> 00:28:40,070
harder to<font color="#E5E5E5"> do with categorical data</font>

696
00:28:38,000 --> 00:28:44,300
and when I say categorical I mean non

697
00:28:40,070 --> 00:28:47,540
numerical<font color="#E5E5E5"> the word London just as text</font>

698
00:28:44,300 --> 00:28:50,180
as a word isn't particularly closer to

699
00:28:47,540 --> 00:28:52,399
<font color="#CCCCCC">Taipei than it is</font><font color="#E5E5E5"> Springfield</font>

700
00:28:50,180 --> 00:28:54,140
<font color="#CCCCCC">um if these were</font><font color="#E5E5E5"> all numbers and I had</font>

701
00:28:52,400 --> 00:28:54,860
something<font color="#E5E5E5"> like I could say four</font><font color="#CCCCCC"> and five</font>

702
00:28:54,140 --> 00:28:59,510
are closer to

703
00:28:54,860 --> 00:29:01,010
than 47 so we start<font color="#CCCCCC"> with kind</font><font color="#E5E5E5"> of a</font>

704
00:28:59,510 --> 00:29:02,809
<font color="#CCCCCC">one-dimensional clustering which is</font>

705
00:29:01,010 --> 00:29:04,910
basically<font color="#E5E5E5"> just trying to find counts of</font>

706
00:29:02,809 --> 00:29:07,428
values then<font color="#CCCCCC"> we look a point of</font>

707
00:29:04,910 --> 00:29:09,650
<font color="#E5E5E5">intersection with other values and try</font>

708
00:29:07,429 --> 00:29:11,270
to<font color="#E5E5E5"> find things that are common</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> our</font>

709
00:29:09,650 --> 00:29:14,210
bad set<font color="#E5E5E5"> this is generally an</font>

710
00:29:11,270 --> 00:29:16,160
unsupervised<font color="#E5E5E5"> activity just finding</font>

711
00:29:14,210 --> 00:29:17,900
clusters of<font color="#E5E5E5"> values but we're</font>

712
00:29:16,160 --> 00:29:20,000
specifically<font color="#E5E5E5"> going to try clustering in</font>

713
00:29:17,900 --> 00:29:23,510
our set of bad values that we know are

714
00:29:20,000 --> 00:29:25,190
already<font color="#E5E5E5"> bad so it's still an</font>

715
00:29:23,510 --> 00:29:26,510
unsupervised method but there's some

716
00:29:25,190 --> 00:29:30,049
level<font color="#E5E5E5"> of</font><font color="#CCCCCC"> supervision that's going to go</font>

717
00:29:26,510 --> 00:29:31,910
<font color="#E5E5E5">on when we go to apply</font><font color="#CCCCCC"> the results so</font>

718
00:29:30,049 --> 00:29:33,740
imagine<font color="#CCCCCC"> for a second that you take one</font>

719
00:29:31,910 --> 00:29:36,860
attribute<font color="#CCCCCC"> and in</font><font color="#E5E5E5"> this case it's the</font>

720
00:29:33,740 --> 00:29:39,260
<font color="#E5E5E5">location which is by L and pretend</font>

721
00:29:36,860 --> 00:29:40,850
<font color="#E5E5E5">you're back in grade school and you have</font>

722
00:29:39,260 --> 00:29:42,500
one<font color="#E5E5E5"> of</font><font color="#CCCCCC"> those big things</font><font color="#E5E5E5"> of construction</font>

723
00:29:40,850 --> 00:29:44,209
<font color="#E5E5E5">paper and those stupid little scissors</font>

724
00:29:42,500 --> 00:29:46,880
that you<font color="#E5E5E5"> can't can't possibly cut</font>

725
00:29:44,210 --> 00:29:49,309
yourself with and you cut a<font color="#CCCCCC"> piece</font><font color="#E5E5E5"> of</font>

726
00:29:46,880 --> 00:29:50,780
<font color="#E5E5E5">paper out for every value you find and</font>

727
00:29:49,309 --> 00:29:53,480
the bigger the piece of paper<font color="#E5E5E5"> the</font><font color="#CCCCCC"> more</font>

728
00:29:50,780 --> 00:29:55,100
<font color="#E5E5E5">common the value is so I can see here</font>

729
00:29:53,480 --> 00:29:56,809
<font color="#E5E5E5">that if I cut this out and I laid</font><font color="#CCCCCC"> all</font>

730
00:29:55,100 --> 00:29:58,520
these things on the paper<font color="#E5E5E5"> the most</font>

731
00:29:56,809 --> 00:30:00,799
common location I've got is just no

732
00:29:58,520 --> 00:30:02,480
location whatsoever<font color="#E5E5E5"> and that</font><font color="#CCCCCC"> kind of</font>

733
00:30:00,799 --> 00:30:03,620
makes sense giving that sparse table

734
00:30:02,480 --> 00:30:05,299
that we showed early on

735
00:30:03,620 --> 00:30:08,239
most people don't<font color="#E5E5E5"> include location</font>

736
00:30:05,299 --> 00:30:11,379
especially<font color="#E5E5E5"> most people that are doing</font>

737
00:30:08,240 --> 00:30:13,490
<font color="#E5E5E5">the malicious certificates don't either</font>

738
00:30:11,380 --> 00:30:15,890
but then there's some<font color="#E5E5E5"> other values that</font>

739
00:30:13,490 --> 00:30:17,600
<font color="#E5E5E5">are very common</font><font color="#CCCCCC"> springfield york london</font>

740
00:30:15,890 --> 00:30:20,660
<font color="#CCCCCC">taipei and there are a bunch of little</font>

741
00:30:17,600 --> 00:30:22,850
<font color="#E5E5E5">ones so we're gonna do the exact same</font>

742
00:30:20,660 --> 00:30:24,110
activity again we're going<font color="#CCCCCC"> to do it with</font>

743
00:30:22,850 --> 00:30:26,290
another attribute<font color="#E5E5E5"> and we're going to</font>

744
00:30:24,110 --> 00:30:28,340
overlay them on<font color="#E5E5E5"> top</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> each other</font>

745
00:30:26,290 --> 00:30:30,850
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> you're gonna come up with a</font>

746
00:30:28,340 --> 00:30:34,280
whole<font color="#CCCCCC"> bunch</font><font color="#E5E5E5"> of blobs and this kind of</font>

747
00:30:30,850 --> 00:30:35,299
helps<font color="#E5E5E5"> represent a little bit what some</font>

748
00:30:34,280 --> 00:30:37,399
of<font color="#E5E5E5"> the different</font><font color="#CCCCCC"> things that can</font><font color="#E5E5E5"> happen</font>

749
00:30:35,299 --> 00:30:41,660
when<font color="#E5E5E5"> you do these intersections for</font>

750
00:30:37,400 --> 00:30:44,510
example this one<font color="#E5E5E5"> a Springfield location</font>

751
00:30:41,660 --> 00:30:45,950
Springfield and organization<font color="#E5E5E5"> D is almost</font>

752
00:30:44,510 --> 00:30:48,290
always happen together

753
00:30:45,950 --> 00:30:50,480
<font color="#E5E5E5">those the the these two sets are almost</font>

754
00:30:48,290 --> 00:30:54,470
identical<font color="#CCCCCC"> almost nobody uses</font><font color="#E5E5E5"> location</font>

755
00:30:50,480 --> 00:30:57,590
Springfield without using D is you know

756
00:30:54,470 --> 00:31:00,260
location empty<font color="#E5E5E5"> is pretty common but then</font>

757
00:30:57,590 --> 00:31:02,600
there's a big<font color="#E5E5E5"> section where you've got</font>

758
00:31:00,260 --> 00:31:05,000
an empty location<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Internet widgets</font>

759
00:31:02,600 --> 00:31:07,879
<font color="#E5E5E5">Pty Ltd</font><font color="#CCCCCC"> by the way anybody</font><font color="#E5E5E5"> know the</font>

760
00:31:05,000 --> 00:31:12,919
significance<font color="#CCCCCC"> of this string here</font>

761
00:31:07,879 --> 00:31:14,779
widgets<font color="#CCCCCC"> PTY ltd</font><font color="#E5E5E5"> right and if you're</font><font color="#CCCCCC"> just</font>

762
00:31:12,919 --> 00:31:17,869
<font color="#CCCCCC">clicking</font><font color="#E5E5E5"> through default then you know</font>

763
00:31:14,779 --> 00:31:20,419
<font color="#E5E5E5">somebody made totally omit location but</font>

764
00:31:17,869 --> 00:31:22,668
still have this guy<font color="#E5E5E5"> in here so this is</font>

765
00:31:20,419 --> 00:31:24,379
<font color="#E5E5E5">common all over the place</font><font color="#CCCCCC"> I'll show this</font>

766
00:31:22,669 --> 00:31:26,569
a<font color="#E5E5E5"> little bit later</font>

767
00:31:24,379 --> 00:31:29,178
my company ltd<font color="#E5E5E5"> that should sound</font>

768
00:31:26,569 --> 00:31:31,819
<font color="#E5E5E5">familiar or a couple</font><font color="#CCCCCC"> people to company</font>

769
00:31:29,179 --> 00:31:33,440
is a common organization<font color="#E5E5E5"> no matter what</font>

770
00:31:31,819 --> 00:31:36,249
the location<font color="#E5E5E5"> is</font><font color="#CCCCCC"> so there's no real</font>

771
00:31:33,440 --> 00:31:38,629
correlation<font color="#E5E5E5"> between these</font><font color="#CCCCCC"> two values</font>

772
00:31:36,249 --> 00:31:42,559
<font color="#E5E5E5">but there is some</font><font color="#CCCCCC"> correlation between my</font>

773
00:31:38,629 --> 00:31:44,149
<font color="#CCCCCC">Company Ltd and</font><font color="#E5E5E5"> York and</font><font color="#CCCCCC"> Taipei although</font>

774
00:31:42,559 --> 00:31:46,099
the location<font color="#E5E5E5"> itself is pretty common</font>

775
00:31:44,149 --> 00:31:48,168
<font color="#E5E5E5">maybe there's nothing that necessarily</font>

776
00:31:46,099 --> 00:31:50,479
clusters with that<font color="#E5E5E5"> specifically for an</font>

777
00:31:48,169 --> 00:31:51,979
organization standpoint so we keep doing

778
00:31:50,479 --> 00:31:53,779
<font color="#E5E5E5">this over and</font><font color="#CCCCCC"> over</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> and we try to</font>

779
00:31:51,979 --> 00:31:55,579
find<font color="#CCCCCC"> different layers</font><font color="#E5E5E5"> that intersect</font>

780
00:31:53,779 --> 00:31:58,609
<font color="#E5E5E5">with each</font><font color="#CCCCCC"> others to make big groups</font>

781
00:31:55,579 --> 00:32:00,469
sorry<font color="#E5E5E5"> wrong one to make big groups like</font>

782
00:31:58,609 --> 00:32:04,158
this that<font color="#E5E5E5"> kind of gives us an idea</font><font color="#CCCCCC"> of</font>

783
00:32:00,469 --> 00:32:06,409
what<font color="#CCCCCC"> a pattern is</font><font color="#E5E5E5"> um</font><font color="#CCCCCC"> but this just</font><font color="#E5E5E5"> tells</font>

784
00:32:04,159 --> 00:32:08,199
us that it's common<font color="#CCCCCC"> in bad stuff right</font>

785
00:32:06,409 --> 00:32:12,649
we still<font color="#E5E5E5"> need a way</font><font color="#CCCCCC"> to kind of go and</font>

786
00:32:08,199 --> 00:32:15,199
rate this so we try<font color="#E5E5E5"> to do some math</font>

787
00:32:12,649 --> 00:32:17,238
<font color="#E5E5E5">around that right</font><font color="#CCCCCC"> overall the patterns</font>

788
00:32:15,199 --> 00:32:20,239
<font color="#CCCCCC">that</font><font color="#E5E5E5"> we have should be more common in</font>

789
00:32:17,239 --> 00:32:22,819
the bad certificates<font color="#E5E5E5"> than</font><font color="#CCCCCC"> overall right</font>

790
00:32:20,239 --> 00:32:24,949
if we're looking<font color="#E5E5E5"> for</font><font color="#CCCCCC"> bad patterns</font><font color="#E5E5E5"> and we</font>

791
00:32:22,819 --> 00:32:26,869
have a set of<font color="#E5E5E5"> bad things we're hoping</font>

792
00:32:24,949 --> 00:32:28,879
<font color="#CCCCCC">that we know more</font><font color="#E5E5E5"> about the bad stuff</font>

793
00:32:26,869 --> 00:32:31,849
<font color="#E5E5E5">than we do about just looking for the</font>

794
00:32:28,879 --> 00:32:34,189
same thing<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> Internet at large so</font>

795
00:32:31,849 --> 00:32:37,009
<font color="#E5E5E5">we ended up finding a ratio that</font><font color="#CCCCCC"> is</font>

796
00:32:34,190 --> 00:32:38,989
number of matches<font color="#CCCCCC"> in the overall set the</font>

797
00:32:37,009 --> 00:32:41,959
<font color="#CCCCCC">the 82 million versus a number of</font>

798
00:32:38,989 --> 00:32:43,819
matches in<font color="#CCCCCC"> our bad set</font><font color="#E5E5E5"> 1335 and we</font>

799
00:32:41,959 --> 00:32:46,069
normalized that<font color="#E5E5E5"> to the number of matches</font>

800
00:32:43,819 --> 00:32:49,039
per bad set so effectively<font color="#E5E5E5"> we're saying</font>

801
00:32:46,069 --> 00:32:51,559
<font color="#CCCCCC">for every</font><font color="#E5E5E5"> time that this showed up in</font>

802
00:32:49,039 --> 00:32:54,408
the bad set<font color="#CCCCCC"> I would expect it to</font><font color="#E5E5E5"> show up</font>

803
00:32:51,559 --> 00:32:56,989
so<font color="#E5E5E5"> many times in my overall um if it's</font>

804
00:32:54,409 --> 00:32:58,699
exactly<font color="#CCCCCC"> 1 then that means that we only</font>

805
00:32:56,989 --> 00:33:01,159
<font color="#CCCCCC">ever found</font><font color="#E5E5E5"> at the bad set because a bad</font>

806
00:32:58,699 --> 00:33:03,259
set is<font color="#E5E5E5"> this a subset of the 82 million</font>

807
00:33:01,159 --> 00:33:05,029
so it's<font color="#CCCCCC"> not really useful right we have</font>

808
00:33:03,259 --> 00:33:06,859
identified<font color="#E5E5E5"> all the cases</font><font color="#CCCCCC"> that we</font>

809
00:33:05,029 --> 00:33:09,829
<font color="#CCCCCC">possibly know about</font><font color="#E5E5E5"> where this thing</font>

810
00:33:06,859 --> 00:33:12,019
occurs<font color="#E5E5E5"> doesn't mean that it's not a good</font>

811
00:33:09,829 --> 00:33:14,448
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> and good indicator</font><font color="#E5E5E5"> it just means</font>

812
00:33:12,019 --> 00:33:16,159
that we've told everything that<font color="#E5E5E5"> we can</font>

813
00:33:14,449 --> 00:33:19,489
know about<font color="#E5E5E5"> it just</font><font color="#CCCCCC"> by specifically</font>

814
00:33:16,159 --> 00:33:21,779
looking at<font color="#CCCCCC"> the blacklist values</font><font color="#E5E5E5"> um if it</font>

815
00:33:19,489 --> 00:33:23,429
occurs greater than a thousand<font color="#CCCCCC"> times</font>

816
00:33:21,779 --> 00:33:26,940
that means that it occurs really often

817
00:33:23,429 --> 00:33:28,979
<font color="#CCCCCC">in the overall set</font><font color="#E5E5E5"> in fact it may occur</font>

818
00:33:26,940 --> 00:33:31,769
more often<font color="#CCCCCC"> the overall set than it does</font>

819
00:33:28,979 --> 00:33:34,109
in<font color="#E5E5E5"> our little</font><font color="#CCCCCC"> small set that means it's</font>

820
00:33:31,769 --> 00:33:36,359
a pattern<font color="#CCCCCC"> but it's not necessarily</font><font color="#E5E5E5"> one</font>

821
00:33:34,109 --> 00:33:38,340
<font color="#CCCCCC">that we want to use and I'll show an</font>

822
00:33:36,359 --> 00:33:40,799
example<font color="#E5E5E5"> about a little bit the sweet</font>

823
00:33:38,340 --> 00:33:42,330
spot that<font color="#E5E5E5"> we found is between a value of</font>

824
00:33:40,799 --> 00:33:44,460
<font color="#E5E5E5">about one</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> two hundred</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> fifty</font>

825
00:33:42,330 --> 00:33:46,769
that's<font color="#E5E5E5"> where we find potentially useless</font>

826
00:33:44,460 --> 00:33:48,629
<font color="#E5E5E5">useful stuff I have some scripts that</font>

827
00:33:46,769 --> 00:33:51,289
calculate these<font color="#CCCCCC"> values and shoot them</font>

828
00:33:48,629 --> 00:33:54,478
<font color="#CCCCCC">out from</font><font color="#E5E5E5"> the raw database and our github</font>

829
00:33:51,289 --> 00:33:57,599
and<font color="#E5E5E5"> this is kind of the example</font><font color="#CCCCCC"> our this</font>

830
00:33:54,479 --> 00:33:59,570
<font color="#E5E5E5">is an example output</font><font color="#CCCCCC"> of that script</font><font color="#E5E5E5"> so</font>

831
00:33:57,599 --> 00:34:02,879
what this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> basically</font><font color="#E5E5E5"> saying is all</font>

832
00:33:59,570 --> 00:34:08,308
<font color="#CCCCCC">right I'm</font><font color="#E5E5E5"> gonna take one here I'm gonna</font>

833
00:34:02,879 --> 00:34:11,788
<font color="#E5E5E5">say let's say us</font><font color="#CCCCCC"> are Monsanto okay so</font><font color="#E5E5E5"> I</font>

834
00:34:08,309 --> 00:34:12,480
found Monsanto as a subject<font color="#E5E5E5"> twice in our</font>

835
00:34:11,789 --> 00:34:15,359
bad set

836
00:34:12,480 --> 00:34:18,740
I found it 26 times<font color="#CCCCCC"> in our overall set</font>

837
00:34:15,359 --> 00:34:22,199
<font color="#E5E5E5">okay there may be something there</font>

838
00:34:18,739 --> 00:34:24,209
democracy found it twice<font color="#CCCCCC"> in our set</font><font color="#E5E5E5"> and</font>

839
00:34:22,199 --> 00:34:26,368
<font color="#CCCCCC">11</font><font color="#E5E5E5"> times in the overall set so I'm</font>

840
00:34:24,210 --> 00:34:28,139
trying<font color="#E5E5E5"> to look at expansion um this one</font>

841
00:34:26,369 --> 00:34:33,059
here is the<font color="#E5E5E5"> empty right subject</font><font color="#CCCCCC"> Oh</font>

842
00:34:28,139 --> 00:34:37,109
appeared<font color="#CCCCCC"> our organization appeared in</font>

843
00:34:33,059 --> 00:34:40,409
the subject blank<font color="#CCCCCC"> 189 times</font><font color="#E5E5E5"> and then it</font>

844
00:34:37,109 --> 00:34:44,788
appeared<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of digits I can't</font>

845
00:34:40,409 --> 00:34:46,679
tell<font color="#E5E5E5"> if that</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> 52 million or that's</font><font color="#CCCCCC"> or</font>

846
00:34:44,789 --> 00:34:48,539
<font color="#E5E5E5">five million times</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> it means it's</font>

847
00:34:46,679 --> 00:34:52,789
incredibly common in the overall set

848
00:34:48,539 --> 00:34:55,169
just by saying<font color="#CCCCCC"> okay blank a blank</font>

849
00:34:52,789 --> 00:34:57,270
<font color="#E5E5E5">organization appears in the bad set</font>

850
00:34:55,168 --> 00:34:59,670
<font color="#CCCCCC">fairly often okay but it appears</font>

851
00:34:57,270 --> 00:35:02,279
everywhere fairly often<font color="#E5E5E5"> so I can't</font>

852
00:34:59,670 --> 00:35:05,130
<font color="#E5E5E5">necessarily say that that's an indicator</font>

853
00:35:02,279 --> 00:35:08,700
of<font color="#E5E5E5"> bad behavior once something gets that</font>

854
00:35:05,130 --> 00:35:11,819
big again<font color="#CCCCCC"> internet widgets PTY appeared</font>

855
00:35:08,700 --> 00:35:13,919
75<font color="#E5E5E5"> times in our set appeared</font><font color="#CCCCCC"> 186</font>

856
00:35:11,819 --> 00:35:17,009
thousand times<font color="#E5E5E5"> overall it's just a</font>

857
00:35:13,920 --> 00:35:18,480
common value<font color="#CCCCCC"> um when those high values</font>

858
00:35:17,010 --> 00:35:20,039
come up you can tell well there's

859
00:35:18,480 --> 00:35:22,440
normally something<font color="#E5E5E5"> going on here and</font>

860
00:35:20,039 --> 00:35:23,670
<font color="#E5E5E5">there's some reason it appears often but</font>

861
00:35:22,440 --> 00:35:26,609
that<font color="#E5E5E5"> reason is not necessarily</font>

862
00:35:23,670 --> 00:35:28,859
maliciousness<font color="#CCCCCC"> but I'm gonna take</font><font color="#E5E5E5"> an</font>

863
00:35:26,609 --> 00:35:32,069
example<font color="#E5E5E5"> of one that</font><font color="#CCCCCC"> is in that sweet</font>

864
00:35:28,859 --> 00:35:35,250
<font color="#CCCCCC">spot that we kind of</font><font color="#E5E5E5"> rundown so this one</font>

865
00:35:32,069 --> 00:35:37,290
value here<font color="#E5E5E5"> appeared twice and</font>

866
00:35:35,250 --> 00:35:40,290
our bad set and it appeared 13 times in

867
00:35:37,290 --> 00:35:42,450
<font color="#E5E5E5">the overall set has a ratio of 6.5 we</font>

868
00:35:40,290 --> 00:35:44,279
say<font color="#E5E5E5"> okay that means that the algorithm</font>

869
00:35:42,450 --> 00:35:47,939
<font color="#CCCCCC">goes to the next</font><font color="#E5E5E5"> step and then it tries</font>

870
00:35:44,280 --> 00:35:49,290
<font color="#CCCCCC">to correlate that with other</font><font color="#E5E5E5"> values I</font>

871
00:35:47,940 --> 00:35:52,230
don't know how much you<font color="#E5E5E5"> can see at this</font>

872
00:35:49,290 --> 00:35:54,450
guy stuff so it starts<font color="#CCCCCC"> sense</font><font color="#E5E5E5"> okay based</font>

873
00:35:52,230 --> 00:35:55,770
on<font color="#E5E5E5"> this particular organization value</font>

874
00:35:54,450 --> 00:35:58,049
<font color="#E5E5E5">I'm going</font><font color="#CCCCCC"> to look</font><font color="#E5E5E5"> for other locations</font>

875
00:35:55,770 --> 00:36:00,180
<font color="#CCCCCC">other organizational units</font><font color="#E5E5E5"> other serial</font>

876
00:35:58,050 --> 00:36:02,670
numbers other countries<font color="#E5E5E5"> I'm gonna try</font>

877
00:36:00,180 --> 00:36:05,009
and find<font color="#E5E5E5"> every other value that</font><font color="#CCCCCC"> seems to</font>

878
00:36:02,670 --> 00:36:07,230
happen<font color="#E5E5E5"> in common with this one and it</font>

879
00:36:05,010 --> 00:36:11,340
came up<font color="#CCCCCC"> with</font><font color="#E5E5E5"> one two three four or five</font>

880
00:36:07,230 --> 00:36:14,220
<font color="#E5E5E5">six seven values so we can see here now</font>

881
00:36:11,340 --> 00:36:15,660
you can't<font color="#CCCCCC"> really</font><font color="#E5E5E5"> see it but it's</font><font color="#CCCCCC"> kind of</font>

882
00:36:14,220 --> 00:36:19,020
funny and<font color="#E5E5E5"> this is where I start talking</font>

883
00:36:15,660 --> 00:36:23,040
<font color="#CCCCCC">about</font><font color="#E5E5E5"> the dumb stuff so this value shows</font>

884
00:36:19,020 --> 00:36:27,259
up with subject<font color="#CCCCCC"> L Quebec but Quebec</font>

885
00:36:23,040 --> 00:36:31,020
don't have a<font color="#E5E5E5"> K</font><font color="#CCCCCC"> on the end of</font><font color="#E5E5E5"> it when</font>

886
00:36:27,260 --> 00:36:36,720
Montreal<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> T in Montreal</font>

887
00:36:31,020 --> 00:36:38,009
this is<font color="#CCCCCC"> monreale</font><font color="#E5E5E5"> so you when you start</font>

888
00:36:36,720 --> 00:36:40,319
seeing<font color="#E5E5E5"> these patterns you tend to see a</font>

889
00:36:38,010 --> 00:36:43,950
<font color="#E5E5E5">lot of misspellings</font><font color="#CCCCCC"> a lot of things that</font>

890
00:36:40,320 --> 00:36:47,130
<font color="#E5E5E5">look on verse very casual glance like</font>

891
00:36:43,950 --> 00:36:49,109
<font color="#E5E5E5">they may be legitimate</font><font color="#CCCCCC"> but on a very</font>

892
00:36:47,130 --> 00:36:50,700
cursory examination you can see<font color="#E5E5E5"> yeah</font>

893
00:36:49,110 --> 00:36:52,590
that says this<font color="#E5E5E5"> is just</font><font color="#CCCCCC"> somebody who is</font>

894
00:36:50,700 --> 00:36:55,740
<font color="#CCCCCC">going really fast trying to do a lot of</font>

895
00:36:52,590 --> 00:36:57,390
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> then totally flubbed it</font><font color="#CCCCCC"> so</font>

896
00:36:55,740 --> 00:37:00,120
down<font color="#CCCCCC"> here</font><font color="#E5E5E5"> you can see all</font><font color="#CCCCCC"> the results</font>

897
00:36:57,390 --> 00:37:03,859
<font color="#E5E5E5">for the</font><font color="#CCCCCC"> pat the pattern we have</font><font color="#E5E5E5"> here</font>

898
00:37:00,120 --> 00:37:07,620
with<font color="#CCCCCC"> quebec gay team as the</font>

899
00:37:03,860 --> 00:37:14,670
organizational<font color="#CCCCCC"> unit canada as</font><font color="#E5E5E5"> the</font>

900
00:37:07,620 --> 00:37:16,500
country<font color="#CCCCCC"> monreale and quebec and</font><font color="#E5E5E5"> you</font>

901
00:37:14,670 --> 00:37:17,970
can't quite<font color="#CCCCCC"> see it</font><font color="#E5E5E5"> here this column is</font>

902
00:37:16,500 --> 00:37:19,590
the<font color="#CCCCCC"> whether or not</font><font color="#E5E5E5"> it appeared in our</font>

903
00:37:17,970 --> 00:37:21,500
<font color="#E5E5E5">feet or not this particular row appeared</font>

904
00:37:19,590 --> 00:37:23,670
in our feet<font color="#E5E5E5"> you can see the first two</font>

905
00:37:21,500 --> 00:37:25,410
<font color="#E5E5E5">did appear</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the feet so there were two</font>

906
00:37:23,670 --> 00:37:27,420
<font color="#E5E5E5">things and they had a lot of stuff in</font>

907
00:37:25,410 --> 00:37:30,410
<font color="#CCCCCC">common</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> were almost identical we</font>

908
00:37:27,420 --> 00:37:34,130
searched for these<font color="#E5E5E5"> specific values</font><font color="#CCCCCC"> in</font>

909
00:37:30,410 --> 00:37:37,560
our<font color="#E5E5E5"> overall set and we found 13</font>

910
00:37:34,130 --> 00:37:39,990
<font color="#E5E5E5">different cases where those values</font>

911
00:37:37,560 --> 00:37:41,970
<font color="#E5E5E5">popped up and after a little</font><font color="#CCCCCC"> more</font>

912
00:37:39,990 --> 00:37:43,020
research<font color="#E5E5E5"> it turns out that every single</font>

913
00:37:41,970 --> 00:37:46,649
one<font color="#E5E5E5"> of these</font>

914
00:37:43,020 --> 00:37:47,970
I was actually<font color="#E5E5E5"> hosting a dried xtc2</font>

915
00:37:46,650 --> 00:37:51,359
server

916
00:37:47,970 --> 00:37:53,640
so you know you can generally<font color="#CCCCCC"> say once</font>

917
00:37:51,359 --> 00:37:56,848
you start<font color="#CCCCCC"> having these weird patterns of</font>

918
00:37:53,640 --> 00:37:59,069
things that are<font color="#E5E5E5"> fairly uncommon but to</font>

919
00:37:56,849 --> 00:38:01,589
expand out that there's commonality here

920
00:37:59,069 --> 00:38:04,349
<font color="#CCCCCC">and that whoever generated</font><font color="#E5E5E5"> this</font>

921
00:38:01,589 --> 00:38:06,150
certificate<font color="#E5E5E5"> these first two is probably</font>

922
00:38:04,349 --> 00:38:07,890
<font color="#CCCCCC">the same guy who generated all these</font>

923
00:38:06,150 --> 00:38:11,490
other certificates<font color="#CCCCCC"> there</font><font color="#E5E5E5"> are things that</font>

924
00:38:07,890 --> 00:38:14,549
<font color="#E5E5E5">are rare in isolation but for some</font>

925
00:38:11,490 --> 00:38:18,720
<font color="#E5E5E5">reason appear you know more</font><font color="#CCCCCC"> often than</font>

926
00:38:14,549 --> 00:38:20,609
they should<font color="#CCCCCC"> in our</font><font color="#E5E5E5"> bad list um</font><font color="#CCCCCC"> you do</font>

927
00:38:18,720 --> 00:38:22,890
that and now all of<font color="#CCCCCC"> a sudden you can</font>

928
00:38:20,609 --> 00:38:26,098
find a lot<font color="#CCCCCC"> more stuff than you</font><font color="#E5E5E5"> did from</font>

929
00:38:22,890 --> 00:38:29,819
that<font color="#E5E5E5"> blacklist alone so big question</font>

930
00:38:26,099 --> 00:38:31,890
<font color="#E5E5E5">right what can</font><font color="#CCCCCC"> I do with this crap so</font>

931
00:38:29,819 --> 00:38:34,140
this was my kind<font color="#CCCCCC"> of good</font><font color="#E5E5E5"> better best</font>

932
00:38:31,890 --> 00:38:37,339
<font color="#E5E5E5">except the okay one isn't really that</font>

933
00:38:34,140 --> 00:38:40,589
<font color="#E5E5E5">good</font><font color="#CCCCCC"> so it's my</font><font color="#E5E5E5"> okay better best list</font><font color="#CCCCCC"> um</font>

934
00:38:37,339 --> 00:38:42,328
first<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> you can do is as we saw here</font>

935
00:38:40,589 --> 00:38:45,029
<font color="#E5E5E5">you can take your blacklist</font><font color="#CCCCCC"> and you can</font>

936
00:38:42,329 --> 00:38:47,039
expand<font color="#E5E5E5"> it right we found six and six</font>

937
00:38:45,030 --> 00:38:48,690
point<font color="#E5E5E5"> five times as many indicators as</font>

938
00:38:47,039 --> 00:38:50,400
we're on the<font color="#E5E5E5"> black list for that one</font>

939
00:38:48,690 --> 00:38:53,069
particular<font color="#E5E5E5"> example</font><font color="#CCCCCC"> and it turns out that</font>

940
00:38:50,400 --> 00:38:57,210
<font color="#E5E5E5">that page that I previously</font><font color="#CCCCCC"> show showed</font>

941
00:38:53,069 --> 00:38:59,369
<font color="#E5E5E5">um everything that was in the one to</font><font color="#CCCCCC"> 250</font>

942
00:38:57,210 --> 00:39:02,579
<font color="#CCCCCC">safe two indicators came up</font><font color="#E5E5E5"> with a</font>

943
00:38:59,369 --> 00:39:06,329
similar expansion rate<font color="#E5E5E5"> um so from this</font>

944
00:39:02,579 --> 00:39:09,900
you<font color="#E5E5E5"> can go from having you know</font><font color="#CCCCCC"> 1335</font>

945
00:39:06,329 --> 00:39:11,099
indicators that were matches up to<font color="#E5E5E5"> you</font>

946
00:39:09,900 --> 00:39:14,220
know tens of thousands hundreds of

947
00:39:11,099 --> 00:39:16,529
thousands pretty easily<font color="#CCCCCC"> so you can make</font>

948
00:39:14,220 --> 00:39:19,950
just<font color="#CCCCCC"> a better blacklist</font><font color="#E5E5E5"> one that's based</font>

949
00:39:16,529 --> 00:39:21,390
off<font color="#E5E5E5"> of inference a lot you</font><font color="#CCCCCC"> could find</font>

950
00:39:19,950 --> 00:39:22,848
stuff there you<font color="#CCCCCC"> could patch</font><font color="#E5E5E5"> that through</font>

951
00:39:21,390 --> 00:39:25,558
the same way you do your<font color="#CCCCCC"> normal feeds</font>

952
00:39:22,849 --> 00:39:27,750
the better thing to<font color="#E5E5E5"> do is to start</font>

953
00:39:25,559 --> 00:39:32,039
looking<font color="#CCCCCC"> using those patterns</font><font color="#E5E5E5"> and finding</font>

954
00:39:27,750 --> 00:39:33,539
strings in your<font color="#E5E5E5"> SSL traffic</font><font color="#CCCCCC"> um and you</font>

955
00:39:32,039 --> 00:39:36,720
<font color="#E5E5E5">know you can do that</font><font color="#CCCCCC"> with a packet based</font>

956
00:39:33,539 --> 00:39:38,640
<font color="#CCCCCC">IPs even we saw early on</font><font color="#E5E5E5"> those kind of</font>

957
00:39:36,720 --> 00:39:40,680
recognizable strings<font color="#CCCCCC"> even in the binary</font>

958
00:39:38,640 --> 00:39:44,549
<font color="#CCCCCC">data</font><font color="#E5E5E5"> there are plenty of snort</font>

959
00:39:40,680 --> 00:39:47,220
signatures<font color="#CCCCCC"> I know s ID one nine five</font>

960
00:39:44,549 --> 00:39:50,520
<font color="#CCCCCC">five one in particular is an example</font><font color="#E5E5E5"> of</font>

961
00:39:47,220 --> 00:39:54,899
one<font color="#CCCCCC"> that look specifically for binary</font>

962
00:39:50,520 --> 00:39:57,150
stuff<font color="#CCCCCC"> in the SSL exchange</font><font color="#E5E5E5"> and those text</font>

963
00:39:54,900 --> 00:39:59,490
<font color="#E5E5E5">rings generally reflect back to</font>

964
00:39:57,150 --> 00:40:01,670
<font color="#E5E5E5">attributes somewhere there yeah the best</font>

965
00:39:59,490 --> 00:40:03,799
way thing you can do with this though is

966
00:40:01,670 --> 00:40:05,990
to start looking at<font color="#E5E5E5"> actual patterns in</font>

967
00:40:03,799 --> 00:40:08,390
your network<font color="#E5E5E5"> traffic using</font><font color="#CCCCCC"> a tool that</font>

968
00:40:05,990 --> 00:40:09,919
can read SSL data<font color="#E5E5E5"> bro is a good one</font>

969
00:40:08,390 --> 00:40:12,379
<font color="#CCCCCC">there are plenty of other commercial</font>

970
00:40:09,920 --> 00:40:14,150
<font color="#E5E5E5">tools that can do similar things</font><font color="#CCCCCC"> um it</font>

971
00:40:12,380 --> 00:40:15,680
really<font color="#CCCCCC"> doesn't take a big</font><font color="#E5E5E5"> investment to</font>

972
00:40:14,150 --> 00:40:18,950
<font color="#E5E5E5">get that kind</font><font color="#CCCCCC"> of contextual awareness</font>

973
00:40:15,680 --> 00:40:19,549
<font color="#E5E5E5">and start reading what those values</font><font color="#CCCCCC"> can</font>

974
00:40:18,950 --> 00:40:21,348
do for you

975
00:40:19,549 --> 00:40:23,299
you can match against that stuff<font color="#E5E5E5"> and</font>

976
00:40:21,349 --> 00:40:25,099
find a lot more<font color="#CCCCCC"> stuff learn</font><font color="#E5E5E5"> and I say</font>

977
00:40:23,299 --> 00:40:26,900
that looking for<font color="#CCCCCC"> it live is so much</font>

978
00:40:25,099 --> 00:40:28,339
<font color="#E5E5E5">better than just</font><font color="#CCCCCC"> creating a black</font><font color="#E5E5E5"> list</font>

979
00:40:26,900 --> 00:40:30,829
<font color="#E5E5E5">cuz you want to lay in the black list</font>

980
00:40:28,339 --> 00:40:32,480
<font color="#E5E5E5">right</font><font color="#CCCCCC"> if you're</font><font color="#E5E5E5"> doing an off SSL BL your</font>

981
00:40:30,829 --> 00:40:34,220
based off of what specifically they can

982
00:40:32,480 --> 00:40:35,809
see if somebody generates another

983
00:40:34,220 --> 00:40:38,419
certificate<font color="#E5E5E5"> with the exact same pattern</font>

984
00:40:35,809 --> 00:40:40,819
<font color="#E5E5E5">hasn't shown up</font><font color="#CCCCCC"> in SSL</font><font color="#E5E5E5"> BL anything like</font>

985
00:40:38,420 --> 00:40:42,920
that<font color="#E5E5E5"> you don't know about</font><font color="#CCCCCC"> it until that</font>

986
00:40:40,819 --> 00:40:44,569
entire process falls through if you look

987
00:40:42,920 --> 00:40:48,770
at these things live<font color="#CCCCCC"> you can hit</font><font color="#E5E5E5"> them</font>

988
00:40:44,569 --> 00:40:50,630
<font color="#E5E5E5">immediately</font><font color="#CCCCCC"> so this is the the triangle</font>

989
00:40:48,770 --> 00:40:54,259
really pyramid because it's a

990
00:40:50,630 --> 00:40:56,059
<font color="#E5E5E5">two-dimensional</font><font color="#CCCCCC"> figure of pain I</font><font color="#E5E5E5"> think</font>

991
00:40:54,260 --> 00:40:58,640
David Bianco was running around here at

992
00:40:56,059 --> 00:41:02,809
some<font color="#CCCCCC"> point there you go thank</font><font color="#E5E5E5"> you for</font>

993
00:40:58,640 --> 00:41:05,210
<font color="#E5E5E5">the triangle so when we started we were</font>

994
00:41:02,809 --> 00:41:07,670
talking<font color="#E5E5E5"> about feed values right and this</font>

995
00:41:05,210 --> 00:41:09,020
certificate<font color="#CCCCCC"> sha1 values are</font><font color="#E5E5E5"> just hash</font>

996
00:41:07,670 --> 00:41:11,390
values right that's at the<font color="#E5E5E5"> bottom of the</font>

997
00:41:09,020 --> 00:41:12,829
pyramid<font color="#CCCCCC"> the pyramid is all about how</font>

998
00:41:11,390 --> 00:41:14,900
much pain you want<font color="#E5E5E5"> to cause your</font>

999
00:41:12,829 --> 00:41:16,339
adversaries<font color="#E5E5E5"> or how much pain an</font>

1000
00:41:14,900 --> 00:41:18,500
individual<font color="#E5E5E5"> thing can cause your</font>

1001
00:41:16,339 --> 00:41:22,190
adversaries personally I want to cause

1002
00:41:18,500 --> 00:41:24,380
as much<font color="#E5E5E5"> pain as</font><font color="#CCCCCC"> possible um I want to</font>

1003
00:41:22,190 --> 00:41:26,150
<font color="#E5E5E5">see my enemies driven</font><font color="#CCCCCC"> before me I want</font>

1004
00:41:24,380 --> 00:41:29,540
<font color="#E5E5E5">to hear the lamentations of their women</font>

1005
00:41:26,150 --> 00:41:32,210
<font color="#CCCCCC">um so I want to do better than</font><font color="#E5E5E5"> this</font>

1006
00:41:29,540 --> 00:41:34,759
right<font color="#E5E5E5"> by kind of working through</font><font color="#CCCCCC"> this</font>

1007
00:41:32,210 --> 00:41:36,170
process<font color="#E5E5E5"> and coming</font><font color="#CCCCCC"> up with certificate</font>

1008
00:41:34,760 --> 00:41:37,880
attributes we're really talking<font color="#E5E5E5"> about</font>

1009
00:41:36,170 --> 00:41:38,900
more<font color="#CCCCCC"> Network artifacts right we're</font>

1010
00:41:37,880 --> 00:41:40,790
<font color="#E5E5E5">talking about things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> have much</font>

1011
00:41:38,900 --> 00:41:43,970
longer<font color="#E5E5E5"> shelf life we're talking</font><font color="#CCCCCC"> about</font>

1012
00:41:40,790 --> 00:41:46,190
<font color="#E5E5E5">things that</font><font color="#CCCCCC"> um we can predict or at</font>

1013
00:41:43,970 --> 00:41:47,779
least deal with some<font color="#E5E5E5"> amount of change on</font>

1014
00:41:46,190 --> 00:41:50,150
the adversaries point they can<font color="#E5E5E5"> just keep</font>

1015
00:41:47,780 --> 00:41:52,190
generating<font color="#E5E5E5"> certificates all day long</font>

1016
00:41:50,150 --> 00:41:57,500
with similar attributes<font color="#E5E5E5"> and if we know</font>

1017
00:41:52,190 --> 00:41:58,609
what attributes<font color="#CCCCCC"> they are we win so</font><font color="#E5E5E5"> you</font>

1018
00:41:57,500 --> 00:42:01,790
know this<font color="#E5E5E5"> this allows</font><font color="#CCCCCC"> us to have</font>

1019
00:41:58,609 --> 00:42:04,640
<font color="#CCCCCC">slightly</font><font color="#E5E5E5"> higher quality indicators that</font>

1020
00:42:01,790 --> 00:42:06,558
<font color="#E5E5E5">we can use so big takeaways it's</font>

1021
00:42:04,640 --> 00:42:09,078
possible to leverage<font color="#E5E5E5"> really large data</font>

1022
00:42:06,559 --> 00:42:10,849
sets with specific indicators find more

1023
00:42:09,079 --> 00:42:12,799
general patterns that are more<font color="#CCCCCC"> useful</font>

1024
00:42:10,849 --> 00:42:15,140
than those specific indicators in and of

1025
00:42:12,799 --> 00:42:15,500
themselves<font color="#E5E5E5"> you</font><font color="#CCCCCC"> got to choose your data</font>

1026
00:42:15,140 --> 00:42:17,089
<font color="#E5E5E5">sets</font>

1027
00:42:15,500 --> 00:42:19,160
carefully though<font color="#E5E5E5"> right if you just</font><font color="#CCCCCC"> try</font>

1028
00:42:17,090 --> 00:42:20,750
<font color="#E5E5E5">to dump</font><font color="#CCCCCC"> everything in and just</font><font color="#E5E5E5"> see what</font>

1029
00:42:19,160 --> 00:42:23,149
happens<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> probably not gonna like</font>

1030
00:42:20,750 --> 00:42:25,190
<font color="#E5E5E5">the results and you know machine</font>

1031
00:42:23,150 --> 00:42:27,920
learning<font color="#E5E5E5"> algorithms</font><font color="#CCCCCC"> overall they give</font>

1032
00:42:25,190 --> 00:42:29,810
<font color="#E5E5E5">you insight into your data sometimes the</font>

1033
00:42:27,920 --> 00:42:31,520
insight<font color="#CCCCCC"> that they give you is that</font><font color="#E5E5E5"> you</font>

1034
00:42:29,810 --> 00:42:33,710
really<font color="#E5E5E5"> shouldn't</font><font color="#CCCCCC"> be learning using a</font>

1035
00:42:31,520 --> 00:42:35,930
machine<font color="#E5E5E5"> learning algorithm overall in</font>

1036
00:42:33,710 --> 00:42:37,430
production<font color="#E5E5E5"> sometimes</font><font color="#CCCCCC"> they suggest</font>

1037
00:42:35,930 --> 00:42:40,370
there's something<font color="#E5E5E5"> much simpler going on</font>

1038
00:42:37,430 --> 00:42:42,950
here do that<font color="#E5E5E5"> instead and I want to say a</font>

1039
00:42:40,370 --> 00:42:43,640
couple<font color="#CCCCCC"> thanks first</font><font color="#E5E5E5"> besides DC and the</font>

1040
00:42:42,950 --> 00:42:46,189
staff here

1041
00:42:43,640 --> 00:42:48,620
Swiss security blog for creating the SSL

1042
00:42:46,190 --> 00:42:51,940
blacklist and<font color="#E5E5E5"> rapid7 labs for providing</font>

1043
00:42:48,620 --> 00:43:08,950
the projects on our data<font color="#CCCCCC"> any questions</font>

1044
00:42:51,940 --> 00:43:10,850
what's up<font color="#CCCCCC"> yes I did</font><font color="#E5E5E5"> something like</font><font color="#CCCCCC"> that</font>

1045
00:43:08,950 --> 00:43:15,109
<font color="#E5E5E5">except you can't really read it very</font>

1046
00:43:10,850 --> 00:43:17,360
well<font color="#CCCCCC"> so the main thing to realize is a</font>

1047
00:43:15,110 --> 00:43:19,420
<font color="#E5E5E5">lot of our data is kind of old we're</font>

1048
00:43:17,360 --> 00:43:22,460
dealing with<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> that's from 2013 on</font>

1049
00:43:19,420 --> 00:43:24,890
<font color="#E5E5E5">so you kind of got</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> go time slicing</font>

1050
00:43:22,460 --> 00:43:27,440
wise right<font color="#E5E5E5"> when you look at this</font>

1051
00:43:24,890 --> 00:43:29,750
originally<font color="#E5E5E5"> um let's encrypt barely</font>

1052
00:43:27,440 --> 00:43:31,280
registers but mainly<font color="#CCCCCC"> because let's</font>

1053
00:43:29,750 --> 00:43:34,760
encrypt hasn't really been<font color="#CCCCCC"> around that</font>

1054
00:43:31,280 --> 00:43:36,950
long<font color="#E5E5E5"> the one that shows up</font><font color="#CCCCCC"> the most out</font>

1055
00:43:34,760 --> 00:43:40,400
of<font color="#E5E5E5"> the total</font><font color="#CCCCCC"> number of</font><font color="#E5E5E5"> certificates by</font>

1056
00:43:36,950 --> 00:43:42,200
far is<font color="#E5E5E5"> Komodo they've had really</font><font color="#CCCCCC"> cheap</font>

1057
00:43:40,400 --> 00:43:45,020
certificate programs or free<font color="#CCCCCC"> certificate</font>

1058
00:43:42,200 --> 00:43:47,359
programs available<font color="#E5E5E5"> for a long time which</font>

1059
00:43:45,020 --> 00:43:48,590
very much biases it but<font color="#CCCCCC"> eighty-seven</font>

1060
00:43:47,360 --> 00:43:55,900
<font color="#E5E5E5">percent of the certificates we found</font>

1061
00:43:48,590 --> 00:43:55,900
we're still self signed<font color="#CCCCCC"> what's up</font>

1062
00:44:06,580 --> 00:44:11,500
so the question was<font color="#E5E5E5"> have I looked at</font>

1063
00:44:08,440 --> 00:44:12,910
external<font color="#E5E5E5"> information correlated with the</font>

1064
00:44:11,500 --> 00:44:16,150
<font color="#CCCCCC">certificate information</font><font color="#E5E5E5"> like age of the</font>

1065
00:44:12,910 --> 00:44:18,339
domain<font color="#CCCCCC"> I haven't so far</font><font color="#E5E5E5"> this was pretty</font>

1066
00:44:16,150 --> 00:44:21,850
<font color="#E5E5E5">much just taking raw data in but that's</font>

1067
00:44:18,340 --> 00:44:24,190
<font color="#CCCCCC">definitely a next</font><font color="#E5E5E5"> step on there I think</font>

1068
00:44:21,850 --> 00:44:26,410
<font color="#CCCCCC">a lot of stuff in</font><font color="#E5E5E5"> terms of age of the</font>

1069
00:44:24,190 --> 00:44:29,200
domain also versus the validity<font color="#E5E5E5"> period</font>

1070
00:44:26,410 --> 00:44:30,609
<font color="#E5E5E5">could be potentially interesting but we</font>

1071
00:44:29,200 --> 00:44:32,259
were kind of<font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> keep it simple</font>

1072
00:44:30,610 --> 00:44:34,330
<font color="#E5E5E5">with those textual fields that are all</font>

1073
00:44:32,260 --> 00:44:37,350
exact match so we didn't deal with<font color="#E5E5E5"> any</font>

1074
00:44:34,330 --> 00:44:44,370
scalar values whatsoever there yeah

1075
00:44:37,350 --> 00:44:44,370
<font color="#E5E5E5">what's up in the front</font><font color="#CCCCCC"> oh yeah sure</font>

1076
00:44:44,490 --> 00:44:50,819
if I can find<font color="#E5E5E5"> it</font><font color="#CCCCCC"> there go yep</font>

1077
00:44:56,970 --> 00:45:02,859
so actually I'm mostly<font color="#CCCCCC"> talking about</font>

1078
00:44:59,530 --> 00:45:04,810
using scripts<font color="#E5E5E5"> so there is as part of the</font>

1079
00:45:02,860 --> 00:45:07,119
<font color="#CCCCCC">broken</font><font color="#E5E5E5"> presentation that we did last</font>

1080
00:45:04,810 --> 00:45:08,560
<font color="#E5E5E5">month we had some kind of example</font>

1081
00:45:07,119 --> 00:45:12,310
scripts and that's<font color="#CCCCCC"> available on our</font>

1082
00:45:08,560 --> 00:45:13,690
<font color="#E5E5E5">github page as well and but one of the</font>

1083
00:45:12,310 --> 00:45:15,250
things that we're looking<font color="#E5E5E5"> into is kind</font>

1084
00:45:13,690 --> 00:45:16,570
<font color="#CCCCCC">of</font><font color="#E5E5E5"> making</font><font color="#CCCCCC"> that a little more flexible</font>

1085
00:45:15,250 --> 00:45:17,530
<font color="#E5E5E5">because we ended up hard coding a lot of</font>

1086
00:45:16,570 --> 00:45:19,450
the values<font color="#CCCCCC"> under the scripts</font><font color="#E5E5E5"> themselves</font>

1087
00:45:17,530 --> 00:45:21,490
<font color="#CCCCCC">I really want to</font><font color="#E5E5E5"> get something like</font>

1088
00:45:19,450 --> 00:45:22,660
where I can load in a<font color="#CCCCCC"> JSON and have that</font>

1089
00:45:21,490 --> 00:45:24,220
<font color="#E5E5E5">available as part of the pro package</font>

1090
00:45:22,660 --> 00:45:26,710
<font color="#E5E5E5">manager so that's very easy</font><font color="#CCCCCC"> to import</font>

1091
00:45:24,220 --> 00:45:29,529
but it's there's really no<font color="#CCCCCC"> universal</font>

1092
00:45:26,710 --> 00:45:32,560
format<font color="#E5E5E5"> for these kind of patterns</font><font color="#CCCCCC"> as an</font>

1093
00:45:29,530 --> 00:45:34,570
indicator right now<font color="#E5E5E5"> so I think we kind</font>

1094
00:45:32,560 --> 00:45:36,400
of need<font color="#CCCCCC"> to figure out something to do</font>

1095
00:45:34,570 --> 00:45:38,830
and and<font color="#E5E5E5"> Mike thought right now is JSON</font>

1096
00:45:36,400 --> 00:45:41,020
because<font color="#E5E5E5"> it has a you have to be</font><font color="#CCCCCC"> able to</font>

1097
00:45:38,830 --> 00:45:44,500
say this field exists<font color="#E5E5E5"> this field</font><font color="#CCCCCC"> doesn't</font>

1098
00:45:41,020 --> 00:45:46,980
and kind<font color="#CCCCCC"> of go</font><font color="#E5E5E5"> from there</font><font color="#CCCCCC"> one of the</font>

1099
00:45:44,500 --> 00:45:46,980
back over there

1100
00:45:52,770 --> 00:45:57,900
so all a lot of<font color="#CCCCCC"> all the machine learning</font>

1101
00:45:55,860 --> 00:46:00,060
stuff was pretty<font color="#E5E5E5"> much just sorry all of</font>

1102
00:45:57,900 --> 00:46:02,700
<font color="#CCCCCC">the clustering stuff was entirely custom</font>

1103
00:46:00,060 --> 00:46:06,299
based off<font color="#E5E5E5"> Python</font><font color="#CCCCCC"> section stuff for the</font>

1104
00:46:02,700 --> 00:46:09,930
logistic regression stuff we started<font color="#CCCCCC"> off</font>

1105
00:46:06,300 --> 00:46:13,200
um<font color="#E5E5E5"> we had some people working</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> I</font>

1106
00:46:09,930 --> 00:46:15,660
believe they were<font color="#E5E5E5"> using are coming in</font>

1107
00:46:13,200 --> 00:46:17,220
through<font color="#E5E5E5"> some Python packages numpy and</font>

1108
00:46:15,660 --> 00:46:20,009
and some others like<font color="#CCCCCC"> that to do data</font>

1109
00:46:17,220 --> 00:46:23,220
frames<font color="#CCCCCC"> I ended up</font><font color="#E5E5E5"> just doing it the</font>

1110
00:46:20,010 --> 00:46:25,950
<font color="#E5E5E5">simple way and I ended up</font><font color="#CCCCCC"> using AWS ml</font>

1111
00:46:23,220 --> 00:46:27,868
<font color="#E5E5E5">as a service a</font><font color="#CCCCCC"> great deal mainly because</font>

1112
00:46:25,950 --> 00:46:33,540
processing power when I dumped in all

1113
00:46:27,869 --> 00:46:37,230
the data<font color="#E5E5E5"> was very very intensive any</font>

1114
00:46:33,540 --> 00:46:45,810
<font color="#CCCCCC">others no cool all right well thanks for</font>

1115
00:46:37,230 --> 00:46:47,040
<font color="#CCCCCC">having us oh and if anybody</font><font color="#E5E5E5"> wants to</font>

1116
00:46:45,810 --> 00:46:49,310
<font color="#E5E5E5">talk about this later because I realized</font>

1117
00:46:47,040 --> 00:46:49,310
I've now

