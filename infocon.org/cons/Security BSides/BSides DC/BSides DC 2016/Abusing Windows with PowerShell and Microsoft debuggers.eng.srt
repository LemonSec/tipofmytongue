1
00:00:00,000 --> 00:00:06,690
the b-sides DC 2016 videos are brought

2
00:00:03,240 --> 00:00:09,389
to you by clear jobs net and cyber sex

3
00:00:06,690 --> 00:00:12,900
jobs com tools for your next career move

4
00:00:09,389 --> 00:00:15,329
and Antietam technologies focusing on

5
00:00:12,900 --> 00:00:18,270
advanced cyber detection analysis and

6
00:00:15,330 --> 00:00:22,050
mitigation hi<font color="#E5E5E5"> everybody thank you very</font>

7
00:00:18,270 --> 00:00:26,039
much for being here so normally<font color="#CCCCCC"> it with</font>

8
00:00:22,050 --> 00:00:28,529
one check like two minutes<font color="#CCCCCC"> ago I'm</font><font color="#E5E5E5"> calyx</font>

9
00:00:26,039 --> 00:00:31,550
on<font color="#CCCCCC"> Bracken I come from Montreal this</font>

10
00:00:28,529 --> 00:00:35,239
morning I flew this morning I'm<font color="#CCCCCC"> belgium</font>

11
00:00:31,550 --> 00:00:39,930
and i will present you how to abuse

12
00:00:35,239 --> 00:00:47,149
windows with tools that it install and

13
00:00:39,930 --> 00:00:51,750
signed already in<font color="#CCCCCC"> windows yeah sorry</font>

14
00:00:47,149 --> 00:00:57,360
like that so like i said i'm from

15
00:00:51,750 --> 00:00:59,840
belgium i'm i'm working at deloitte in

16
00:00:57,360 --> 00:01:05,220
<font color="#E5E5E5">montreal</font><font color="#CCCCCC"> i do Incident Response</font>

17
00:00:59,840 --> 00:01:07,320
compromises man and Red Team I have<font color="#E5E5E5"> a 13</font>

18
00:01:05,220 --> 00:01:11,158
years experience in information

19
00:01:07,320 --> 00:01:15,059
technology<font color="#E5E5E5"> and security and I already</font>

20
00:01:11,159 --> 00:01:18,150
took at several security conferences

21
00:01:15,060 --> 00:01:25,350
like<font color="#E5E5E5"> hackfest</font><font color="#CCCCCC"> Infosecurity Europe in</font>

22
00:01:18,150 --> 00:01:28,530
London UK sector just two<font color="#CCCCCC"> days ago and I</font>

23
00:01:25,350 --> 00:01:33,780
will<font color="#E5E5E5"> talk about my tools at black hat</font>

24
00:01:28,530 --> 00:01:36,450
<font color="#E5E5E5">Arsenal Europe this show and also</font><font color="#CCCCCC"> I'm a</font>

25
00:01:33,780 --> 00:01:40,140
starcraft 2 player so if people<font color="#E5E5E5"> like</font>

26
00:01:36,450 --> 00:01:42,270
this game chem and we will come in and

27
00:01:40,140 --> 00:01:44,600
<font color="#E5E5E5">we will speak about that after the</font>

28
00:01:42,270 --> 00:01:44,600
conference

29
00:01:45,360 --> 00:01:50,410
white /<font color="#E5E5E5"> memory because I wanted to</font>

30
00:01:48,220 --> 00:01:57,280
<font color="#E5E5E5">create something with powershell and</font>

31
00:01:50,410 --> 00:02:00,399
using Microsoft tools but we Microsoft

32
00:01:57,280 --> 00:02:03,729
tools which is signed by Microsoft so

33
00:02:00,400 --> 00:02:06,280
associated with a certificate at

34
00:02:03,729 --> 00:02:10,179
delivered by Microsoft so it's very cool

35
00:02:06,280 --> 00:02:13,990
and yes get a lot of money<font color="#E5E5E5"> but it</font>

36
00:02:10,179 --> 00:02:20,200
doesn't work<font color="#E5E5E5"> so i did that took a lot of</font>

37
00:02:13,990 --> 00:02:24,810
fun with that<font color="#CCCCCC"> Azure gender what is poor</font>

38
00:02:20,200 --> 00:02:29,339
memory and then<font color="#CCCCCC"> I will show you what is</font>

39
00:02:24,810 --> 00:02:33,250
<font color="#E5E5E5">what poor memory use or the binaries</font>

40
00:02:29,340 --> 00:02:36,310
actually it is debugger so the debug of

41
00:02:33,250 --> 00:02:40,120
Microsoft which is windbg and<font color="#CCCCCC"> cdb for</font>

42
00:02:36,310 --> 00:02:44,410
the<font color="#E5E5E5"> common line tool then we will be a</font>

43
00:02:40,120 --> 00:02:47,020
little more a bit technical and I will

44
00:02:44,410 --> 00:02:51,970
<font color="#CCCCCC">show you exactly how what what I do in</font>

45
00:02:47,020 --> 00:02:54,880
memory and<font color="#E5E5E5"> what bite I I change I will</font>

46
00:02:51,970 --> 00:02:58,630
<font color="#CCCCCC">talk about Empire I I suppose people</font>

47
00:02:54,880 --> 00:03:01,450
like you know<font color="#E5E5E5"> about Empire and I met a</font>

48
00:02:58,630 --> 00:03:04,739
pull request for poor memory into Empire

49
00:03:01,450 --> 00:03:08,459
and mitigations so what is<font color="#E5E5E5"> poor memory</font>

50
00:03:04,739 --> 00:03:12,910
poor memory is a minesweeper solver

51
00:03:08,459 --> 00:03:16,390
that's all folks thank you that's a

52
00:03:12,910 --> 00:03:20,079
troll but it's true<font color="#E5E5E5"> and i will i will</font>

53
00:03:16,390 --> 00:03:23,380
show you<font color="#E5E5E5"> how we can solve it I never I</font>

54
00:03:20,079 --> 00:03:26,410
never play at this is this game you<font color="#CCCCCC"> know</font>

55
00:03:23,380 --> 00:03:28,540
with all this kind of bomb I never

56
00:03:26,410 --> 00:03:31,420
played before but the goal<font color="#CCCCCC"> was to</font>

57
00:03:28,540 --> 00:03:34,840
illustrate to show up you can modify the

58
00:03:31,420 --> 00:03:38,048
memory directly during the execution of

59
00:03:34,840 --> 00:03:41,579
the operating system with a tool like a

60
00:03:38,049 --> 00:03:45,880
debugger and automate it and so imagine

61
00:03:41,579 --> 00:03:49,680
some other scenarios like financial

62
00:03:45,880 --> 00:03:49,680
software or something<font color="#CCCCCC"> like that</font>

63
00:03:51,690 --> 00:03:59,859
so with partial and<font color="#CCCCCC"> Microsoft tool and</font>

64
00:03:55,830 --> 00:04:02,980
which is a debugger signed /<font color="#E5E5E5"> memory can</font>

65
00:03:59,860 --> 00:04:07,120
do what you want into<font color="#CCCCCC"> the user land the</font>

66
00:04:02,980 --> 00:04:11,290
<font color="#E5E5E5">cannon lon and wonderland so I have you</font>

67
00:04:07,120 --> 00:04:15,910
know if you know she a shower and listen

68
00:04:11,290 --> 00:04:20,529
to handle on it or that so basically

69
00:04:15,910 --> 00:04:23,430
<font color="#E5E5E5">what</font><font color="#CCCCCC"> i do with powershell so the tool</font>

70
00:04:20,529 --> 00:04:28,479
and<font color="#CCCCCC"> the burger is sending and receiving</font>

71
00:04:23,430 --> 00:04:33,070
texts bites that's all I don't use API I

72
00:04:28,480 --> 00:04:35,910
let the beggar do for me so all the cool

73
00:04:33,070 --> 00:04:39,849
to the<font color="#CCCCCC"> operating system will be done by</font>

74
00:04:35,910 --> 00:04:41,710
<font color="#E5E5E5">this Debbie girl and with</font><font color="#CCCCCC"> that you</font><font color="#E5E5E5"> can</font>

75
00:04:39,850 --> 00:04:45,340
<font color="#E5E5E5">do</font><font color="#CCCCCC"> everything you want on the</font><font color="#E5E5E5"> operating</font>

76
00:04:41,710 --> 00:04:47,469
<font color="#E5E5E5">system so poor memory so use on an</font>

77
00:04:45,340 --> 00:04:49,690
<font color="#CCCCCC">attacker as I said you can get windows</font>

78
00:04:47,470 --> 00:04:51,700
password from<font color="#CCCCCC"> the memory it's not the</font>

79
00:04:49,690 --> 00:04:56,740
same thing<font color="#E5E5E5"> that mimic ads because mimic</font>

80
00:04:51,700 --> 00:05:01,210
at will call the api here i<font color="#CCCCCC"> just use the</font>

81
00:04:56,740 --> 00:05:04,690
debugger it you can inject<font color="#CCCCCC"> executors</font>

82
00:05:01,210 --> 00:05:09,460
shellcode in a remote process you<font color="#CCCCCC"> can</font>

83
00:05:04,690 --> 00:05:13,060
<font color="#E5E5E5">modify the memory of a process then you</font>

84
00:05:09,460 --> 00:05:18,820
can do channel and stuff too so you you

85
00:05:13,060 --> 00:05:21,840
will<font color="#CCCCCC"> have some screen like that but it's</font>

86
00:05:18,820 --> 00:05:25,320
very useful<font color="#CCCCCC"> because you can do</font><font color="#E5E5E5"> all what</font>

87
00:05:21,840 --> 00:05:28,510
advanced malware can do so by example

88
00:05:25,320 --> 00:05:32,740
dko amp or directional object

89
00:05:28,510 --> 00:05:34,960
manipulation and with this this kind<font color="#E5E5E5"> of</font>

90
00:05:32,740 --> 00:05:37,810
techniques you can hide and I the

91
00:05:34,960 --> 00:05:40,870
process from task manager by example and

92
00:05:37,810 --> 00:05:42,580
from the colonel structures you can

93
00:05:40,870 --> 00:05:44,530
protect<font color="#CCCCCC"> a process which is very</font>

94
00:05:42,580 --> 00:05:49,960
interesting because it lets you access

95
00:05:44,530 --> 00:05:53,169
<font color="#E5E5E5">to a special process this light LLS</font><font color="#CCCCCC"> a SS</font>

96
00:05:49,960 --> 00:05:56,320
if<font color="#E5E5E5"> you cannot see</font><font color="#CCCCCC"> very well on the</font>

97
00:05:53,169 --> 00:06:00,159
screen but if you try<font color="#CCCCCC"> on on several a</font>

98
00:05:56,320 --> 00:06:02,890
new recent<font color="#CCCCCC"> story operating system to</font>

99
00:06:00,160 --> 00:06:03,220
dump this process you<font color="#CCCCCC"> will have this</font>

100
00:06:02,890 --> 00:06:06,520
kind

101
00:06:03,220 --> 00:06:11,200
of error message so by protecting your

102
00:06:06,520 --> 00:06:14,770
process as else as you will be able to

103
00:06:11,200 --> 00:06:16,659
<font color="#E5E5E5">dump it as usual you can inject your</font>

104
00:06:14,770 --> 00:06:19,570
privilege in<font color="#CCCCCC"> the process with system</font>

105
00:06:16,660 --> 00:06:21,700
identity and just by sending bites into

106
00:06:19,570 --> 00:06:25,030
the process and then you will have all

107
00:06:21,700 --> 00:06:29,289
<font color="#E5E5E5">the</font><font color="#CCCCCC"> the operating all right I don't know</font>

108
00:06:25,030 --> 00:06:32,679
all the<font color="#E5E5E5"> right you know it's pretty a lot</font>

109
00:06:29,290 --> 00:06:35,140
but I i I'm sure I have all the right

110
00:06:32,680 --> 00:06:38,560
you know and you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> pass it to can</font>

111
00:06:35,140 --> 00:06:40,390
attack so it there are old proof of

112
00:06:38,560 --> 00:06:44,830
concept that<font color="#CCCCCC"> you can do a lot more if</font>

113
00:06:40,390 --> 00:06:47,169
you want<font color="#E5E5E5"> poor memoriam of that is also</font>

114
00:06:44,830 --> 00:06:50,950
an active directory recognition tool so

115
00:06:47,170 --> 00:06:53,890
you can use it<font color="#CCCCCC"> to make a scan in Adam</font>

116
00:06:50,950 --> 00:06:58,240
Active Directory domain and passive

117
00:06:53,890 --> 00:07:00,130
because<font color="#E5E5E5"> it's with SPN technique which is</font>

118
00:06:58,240 --> 00:07:03,220
a service principal<font color="#E5E5E5"> named in active</font>

119
00:07:00,130 --> 00:07:07,240
directory so you if you want to have I

120
00:07:03,220 --> 00:07:09,820
<font color="#E5E5E5">don't know</font><font color="#CCCCCC"> all the sequel server you can</font>

121
00:07:07,240 --> 00:07:13,240
do it by just asking to the<font color="#E5E5E5"> domain</font>

122
00:07:09,820 --> 00:07:17,409
controller you can have fights over

123
00:07:13,240 --> 00:07:20,410
<font color="#CCCCCC">every senior you can get gps pass one</font>

124
00:07:17,410 --> 00:07:25,300
but for all connected for us doc so this

125
00:07:20,410 --> 00:07:27,310
tool will detect all the the forests and

126
00:07:25,300 --> 00:07:30,190
<font color="#E5E5E5">forest connect it and</font><font color="#CCCCCC"> will try to</font>

127
00:07:27,310 --> 00:07:35,080
retrieve all the gpp password of all the

128
00:07:30,190 --> 00:07:39,250
domain and forest connect it so you can

129
00:07:35,080 --> 00:07:42,909
also<font color="#E5E5E5"> assess the server shares of all</font>

130
00:07:39,250 --> 00:07:44,890
connected forest looking for share

131
00:07:42,910 --> 00:07:48,460
accessible for<font color="#CCCCCC"> twenty get it user</font>

132
00:07:44,890 --> 00:07:51,969
because it's often the case<font color="#E5E5E5"> in the</font>

133
00:07:48,460 --> 00:07:54,219
domain so when it's miss kahn is not

134
00:07:51,970 --> 00:07:56,740
very welcome video you will have this

135
00:07:54,220 --> 00:07:58,840
kind of behavior on the<font color="#E5E5E5"> network so you</font>

136
00:07:56,740 --> 00:08:01,840
can<font color="#CCCCCC"> assert that</font><font color="#E5E5E5"> and you can draw the</font>

137
00:07:58,840 --> 00:08:05,590
zyada<font color="#E5E5E5"> topology line in visual just</font>

138
00:08:01,840 --> 00:08:07,719
ossifer also you can try to elevate<font color="#E5E5E5"> you</font>

139
00:08:05,590 --> 00:08:09,580
right because<font color="#CCCCCC"> if you are not an</font>

140
00:08:07,720 --> 00:08:12,610
<font color="#E5E5E5">administrator on the workstation you can</font>

141
00:08:09,580 --> 00:08:13,969
not do a lot of<font color="#CCCCCC"> things so you have four</font>

142
00:08:12,610 --> 00:08:16,459
<font color="#CCCCCC">escalate that can</font>

143
00:08:13,969 --> 00:08:19,149
be lunch and try and it will try to

144
00:08:16,459 --> 00:08:25,099
elevate your right on this workstation

145
00:08:19,149 --> 00:08:29,329
it it's break<font color="#CCCCCC"> them mcafee password which</font>

146
00:08:25,099 --> 00:08:32,448
is which are stored in<font color="#E5E5E5"> XML files so I</font>

147
00:08:29,329 --> 00:08:36,948
did that with an two percent did that I

148
00:08:32,448 --> 00:08:40,848
did the<font color="#E5E5E5"> other way you can provoke a bsod</font>

149
00:08:36,948 --> 00:08:43,458
and why<font color="#CCCCCC"> I did approve this proof of</font>

150
00:08:40,849 --> 00:08:47,420
concept is because if the computer is

151
00:08:43,458 --> 00:08:51,050
configured to crash and and dump the

152
00:08:47,420 --> 00:08:53,360
crash on your between system you can

153
00:08:51,050 --> 00:08:55,899
collect that crash and then give it to

154
00:08:53,360 --> 00:08:59,720
pawn my memory and<font color="#E5E5E5"> get the password</font>

155
00:08:55,899 --> 00:09:02,329
bypass USC and something very funny on a

156
00:08:59,720 --> 00:09:06,350
very old software that i saw in a

157
00:09:02,329 --> 00:09:10,399
different client so it's actually<font color="#CCCCCC"> i</font>

158
00:09:06,350 --> 00:09:13,310
think it's something in 94 for something

159
00:09:10,399 --> 00:09:16,009
like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> and it's actually again</font>

160
00:09:13,310 --> 00:09:20,268
installed on several a client so it's

161
00:09:16,009 --> 00:09:22,730
interesting so if you launch the tool on

162
00:09:20,269 --> 00:09:27,439
directly<font color="#E5E5E5"> on the computer you will have</font>

163
00:09:22,730 --> 00:09:33,430
menu like that and you can try all the

164
00:09:27,439 --> 00:09:33,430
singer<font color="#CCCCCC"> i just said it's very easy to</font><font color="#E5E5E5"> use</font>

165
00:09:33,519 --> 00:09:44,660
<font color="#CCCCCC">okay so what is what's the bugger /</font>

166
00:09:38,990 --> 00:09:46,399
<font color="#E5E5E5">memory use it it will level the sentence</font>

167
00:09:44,660 --> 00:09:49,459
of Jeffress<font color="#E5E5E5"> number will create</font>

168
00:09:46,399 --> 00:09:51,889
<font color="#CCCCCC">powershell</font><font color="#E5E5E5"> he say to us to automate all</font>

169
00:09:49,459 --> 00:09:53,359
the things so<font color="#CCCCCC"> i said to myself okay i</font>

170
00:09:51,889 --> 00:09:56,509
will automate something like the

171
00:09:53,360 --> 00:09:59,720
debugger to do things like<font color="#CCCCCC"> that so to</font>

172
00:09:56,509 --> 00:10:05,180
abuse windows but you can do everything

173
00:09:59,720 --> 00:10:08,420
<font color="#CCCCCC">you want as I said why I wanted to</font><font color="#E5E5E5"> use</font>

174
00:10:05,180 --> 00:10:11,959
that<font color="#CCCCCC"> because it's signed and it's signed</font>

175
00:10:08,420 --> 00:10:15,079
so if never an antivirus will catch that

176
00:10:11,959 --> 00:10:18,170
by default<font color="#E5E5E5"> and I don't know a lot of</font>

177
00:10:15,079 --> 00:10:20,930
<font color="#CCCCCC">yous guys that you is that well</font>

178
00:10:18,170 --> 00:10:23,490
developed and seem<font color="#E5E5E5"> to detect that</font>

179
00:10:20,930 --> 00:10:26,430
behavior because if you have

180
00:10:23,490 --> 00:10:29,399
to try<font color="#E5E5E5"> to detect all the signed by nur</font>

181
00:10:26,430 --> 00:10:33,839
is it will be very difficult but you

182
00:10:29,399 --> 00:10:36,810
have to do that because as<font color="#E5E5E5"> I show you it</font>

183
00:10:33,839 --> 00:10:40,890
can be a big problem so it's trusted

184
00:10:36,810 --> 00:10:43,199
everywhere first step when you are in

185
00:10:40,890 --> 00:10:46,800
front of<font color="#E5E5E5"> the console</font><font color="#CCCCCC"> of the debugger you</font>

186
00:10:43,200 --> 00:10:51,149
can ask<font color="#E5E5E5"> him</font><font color="#CCCCCC"> to display by it so on the</font>

187
00:10:46,800 --> 00:10:56,069
screen I i put DB and you will have the

188
00:10:51,149 --> 00:10:57,450
bite so it's like 51 d 1 something like

189
00:10:56,070 --> 00:11:02,550
<font color="#E5E5E5">that i don't know if you can see that</font>

190
00:10:57,450 --> 00:11:05,130
i'm not<font color="#CCCCCC"> sure so when you type that you</font>

191
00:11:02,550 --> 00:11:10,529
<font color="#E5E5E5">will have this kind of information so</font>

192
00:11:05,130 --> 00:11:13,380
you see<font color="#E5E5E5"> just a letter and a number you</font>

193
00:11:10,529 --> 00:11:16,110
can do<font color="#E5E5E5"> that display word for display a</font>

194
00:11:13,380 --> 00:11:20,510
to buy this play double word for<font color="#E5E5E5"> 4 byte</font>

195
00:11:16,110 --> 00:11:23,970
etc and if you type<font color="#CCCCCC"> D you you will have</font>

196
00:11:20,510 --> 00:11:27,330
the<font color="#CCCCCC"> esky representation so it's the</font>

197
00:11:23,970 --> 00:11:30,089
clear text<font color="#E5E5E5"> I just type D you and an</font>

198
00:11:27,330 --> 00:11:33,810
<font color="#CCCCCC">address in memory and I get my email</font><font color="#E5E5E5"> so</font>

199
00:11:30,089 --> 00:11:37,440
PA breakin at blah blah blah if you do

200
00:11:33,810 --> 00:11:39,060
<font color="#E5E5E5">that on the honor address where password</font>

201
00:11:37,440 --> 00:11:45,089
is contained you will have something

202
00:11:39,060 --> 00:11:48,959
like not in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> esky table so</font><font color="#CCCCCC"> you won't</font>

203
00:11:45,089 --> 00:11:53,000
<font color="#CCCCCC">see anything so you have to do</font><font color="#E5E5E5"> also</font>

204
00:11:48,959 --> 00:11:53,000
thing to get a password it's not as easy

205
00:11:53,329 --> 00:12:01,170
also when you try to load to display

206
00:11:58,680 --> 00:12:06,930
information so when you compile a

207
00:12:01,170 --> 00:12:10,469
program it will be in<font color="#E5E5E5"> all case i am with</font>

208
00:12:06,930 --> 00:12:12,569
it will generate a pdb file and the pdb

209
00:12:10,470 --> 00:12:14,839
file contains some information very

210
00:12:12,570 --> 00:12:18,029
important<font color="#E5E5E5"> for the</font><font color="#CCCCCC"> program to run and</font>

211
00:12:14,839 --> 00:12:21,930
microsoft is very cool<font color="#E5E5E5"> with us because a</font>

212
00:12:18,029 --> 00:12:24,839
host a special symbol server on internet

213
00:12:21,930 --> 00:12:27,359
that<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> access and every developer</font>

214
00:12:24,839 --> 00:12:33,139
will access to that to debug Kerner

215
00:12:27,360 --> 00:12:37,369
things so they host all the symbols that

216
00:12:33,139 --> 00:12:42,739
are generated with the<font color="#CCCCCC"> program's so if I</font>

217
00:12:37,369 --> 00:12:48,049
just<font color="#E5E5E5"> try to display something with a</font>

218
00:12:42,739 --> 00:12:50,149
symbol so it's do w digest etc and I

219
00:12:48,049 --> 00:12:52,669
didn't load the symbols i will have

220
00:12:50,149 --> 00:12:55,519
quotation marks oh no not the content of

221
00:12:52,669 --> 00:12:58,309
the content of the bite if I load the

222
00:12:55,519 --> 00:13:01,970
symbols i will have<font color="#CCCCCC"> the bite it's</font><font color="#E5E5E5"> I'm</font>

223
00:12:58,309 --> 00:13:06,219
sorry<font color="#CCCCCC"> that you cannot look very well at</font>

224
00:13:01,970 --> 00:13:09,049
the screen so the symbols are free you

225
00:13:06,220 --> 00:13:11,540
<font color="#CCCCCC">can so this light will be on the</font>

226
00:13:09,049 --> 00:13:15,259
<font color="#CCCCCC">internet so you will be</font><font color="#E5E5E5"> able to look at</font>

227
00:13:11,540 --> 00:13:17,779
that more clearly so<font color="#E5E5E5"> symbol is free you</font>

228
00:13:15,259 --> 00:13:19,819
can<font color="#E5E5E5"> really easily put that in the</font>

229
00:13:17,779 --> 00:13:23,029
debugger and it will manage all the

230
00:13:19,819 --> 00:13:25,910
thing for you you don't<font color="#E5E5E5"> have to to know</font>

231
00:13:23,029 --> 00:13:28,730
nothing<font color="#CCCCCC"> about symbols to load that so</font>

232
00:13:25,910 --> 00:13:30,949
you indicate this URL in your in your

233
00:13:28,730 --> 00:13:34,790
debugger and you will be able<font color="#E5E5E5"> to get all</font>

234
00:13:30,949 --> 00:13:36,858
<font color="#CCCCCC">the symbols so for to get all the to get</font>

235
00:13:34,790 --> 00:13:39,829
to get the pass one is a memory we will

236
00:13:36,859 --> 00:13:43,309
need<font color="#CCCCCC"> to have</font><font color="#E5E5E5"> a different symbols i will</font>

237
00:13:39,829 --> 00:13:46,309
give you now so the first<font color="#E5E5E5"> one is the</font>

238
00:13:43,309 --> 00:13:48,350
symbols which represents the list entry

239
00:13:46,309 --> 00:13:51,319
because all the password in the<font color="#E5E5E5"> memory</font>

240
00:13:48,350 --> 00:13:55,369
are contained in a list circular list

241
00:13:51,319 --> 00:13:58,128
and so you<font color="#E5E5E5"> will need</font><font color="#CCCCCC"> to go through the</font>

242
00:13:55,369 --> 00:14:00,439
list to get all the icons that<font color="#CCCCCC"> it's</font>

243
00:13:58,129 --> 00:14:02,600
store in memory because if you are on a

244
00:14:00,439 --> 00:14:05,719
<font color="#CCCCCC">i don't know on a terminal server which</font>

245
00:14:02,600 --> 00:14:08,540
lot of users I don't know 10 user by

246
00:14:05,720 --> 00:14:11,360
example you will<font color="#E5E5E5"> need to get to all</font>

247
00:14:08,540 --> 00:14:13,029
these<font color="#E5E5E5"> 10 user to get all the</font><font color="#CCCCCC"> password so</font>

248
00:14:11,360 --> 00:14:16,939
the<font color="#E5E5E5"> first one is released and three and</font>

249
00:14:13,029 --> 00:14:18,980
the symbolic is l and those I don't know

250
00:14:16,939 --> 00:14:20,329
to say that in English but under<font color="#CCCCCC"> schoo I</font>

251
00:14:18,980 --> 00:14:23,720
don't know it see if it's<font color="#CCCCCC"> caught</font><font color="#E5E5E5"> yeah</font>

252
00:14:20,329 --> 00:14:27,138
and locks s list<font color="#CCCCCC"> okay so you tell you</font>

253
00:14:23,720 --> 00:14:30,199
type DB these symbols and you will get

254
00:14:27,139 --> 00:14:33,529
the bytes representing the first<font color="#E5E5E5"> lesson</font>

255
00:14:30,199 --> 00:14:36,108
tree i will show you the list and free

256
00:14:33,529 --> 00:14:38,449
just after this line then you will need

257
00:14:36,109 --> 00:14:41,410
the key because the password has

258
00:14:38,449 --> 00:14:45,900
encrypted since it's an and symmetrical

259
00:14:41,410 --> 00:14:49,500
encryption you need<font color="#E5E5E5"> these symbols</font>

260
00:14:45,900 --> 00:14:53,069
I don't know GP it's not very

261
00:14:49,500 --> 00:14:56,400
interesting<font color="#CCCCCC"> but des because n t5 it's</font>

262
00:14:53,070 --> 00:15:00,000
for<font color="#E5E5E5"> 2003 operating system or XP by</font>

263
00:14:56,400 --> 00:15:06,150
example so the information are encrypted

264
00:15:00,000 --> 00:15:08,370
in des des<font color="#CCCCCC"> X which is created by</font>

265
00:15:06,150 --> 00:15:11,579
Microsoft and not documented so it was

266
00:15:08,370 --> 00:15:14,730
very difficult<font color="#E5E5E5"> to crack this one and</font>

267
00:15:11,580 --> 00:15:17,750
<font color="#E5E5E5">2008's a</font><font color="#CCCCCC"> toronto and t6 entities</font><font color="#E5E5E5"> was</font>

268
00:15:14,730 --> 00:15:22,260
very easy because its standard<font color="#E5E5E5"> protocol</font>

269
00:15:17,750 --> 00:15:26,130
and feedback and four NT<font color="#E5E5E5"> six and TD 10</font>

270
00:15:22,260 --> 00:15:31,620
you need a diaz<font color="#E5E5E5"> keen to not the</font><font color="#CCCCCC"> AC x and</font>

271
00:15:26,130 --> 00:15:34,350
s if it's encrypted into this protocol

272
00:15:31,620 --> 00:15:37,500
but I I never see the two producers to

273
00:15:34,350 --> 00:15:43,230
put<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> i'll also see one which is a s</font>

274
00:15:37,500 --> 00:15:46,650
and the initialization vector but we

275
00:15:43,230 --> 00:15:49,130
need to go deeper now so let's get

276
00:15:46,650 --> 00:15:53,790
technical because it was you know<font color="#E5E5E5"> just</font>

277
00:15:49,130 --> 00:15:57,510
just for for now so to to really

278
00:15:53,790 --> 00:16:03,030
understand well to get the password i

279
00:15:57,510 --> 00:16:05,040
will show you where it it is yes and

280
00:16:03,030 --> 00:16:08,189
it's not internal and it's in usual

281
00:16:05,040 --> 00:16:12,959
answer it you don't have to be into the

282
00:16:08,190 --> 00:16:15,300
kernel to do that we will attract<font color="#CCCCCC"> the</font>

283
00:16:12,960 --> 00:16:18,930
digest security support provider which

284
00:16:15,300 --> 00:16:22,319
is very interesting because if you

285
00:16:18,930 --> 00:16:26,250
disable that and<font color="#CCCCCC"> microsoft proposes a</font>

286
00:16:22,320 --> 00:16:29,040
solution to disable that in company you

287
00:16:26,250 --> 00:16:33,150
won't have<font color="#E5E5E5"> SSO so no shop owners no</font>

288
00:16:29,040 --> 00:16:36,240
nothing so nobody disable this feature

289
00:16:33,150 --> 00:16:42,540
because if you disable that your company

290
00:16:36,240 --> 00:16:45,330
won't work normally so all to do that

291
00:16:42,540 --> 00:16:48,750
you<font color="#E5E5E5"> steal the bites to steal the bed</font><font color="#CCCCCC"> you</font>

292
00:16:45,330 --> 00:16:52,710
can dump else as process you can<font color="#E5E5E5"> do it</font>

293
00:16:48,750 --> 00:16:55,620
locally or remotely and might we'll do

294
00:16:52,710 --> 00:16:57,790
it<font color="#E5E5E5"> locally or remotely you can convert a</font>

295
00:16:55,620 --> 00:17:00,490
file like I brosis

296
00:16:57,790 --> 00:17:03,579
I profile dots is an excuse me to dump

297
00:17:00,490 --> 00:17:06,520
the information you can provoke a bsod

298
00:17:03,580 --> 00:17:09,310
and get the<font color="#CCCCCC"> Crashdown file so you you</font>

299
00:17:06,520 --> 00:17:12,220
are not your maybe not an administrator

300
00:17:09,310 --> 00:17:16,060
of the of the computer you can leverage

301
00:17:12,220 --> 00:17:18,520
<font color="#CCCCCC">the hypervisor because imagine that you</font>

302
00:17:16,060 --> 00:17:22,720
want operator not on an administrator an

303
00:17:18,520 --> 00:17:26,020
operator of vmware or i prevail I pervy

304
00:17:22,720 --> 00:17:28,300
but you don't have no right on the

305
00:17:26,020 --> 00:17:34,090
target so on with the windows installed

306
00:17:28,300 --> 00:17:37,629
into<font color="#E5E5E5"> the upper GI paizo as an operator</font>

307
00:17:34,090 --> 00:17:40,149
if I have the right to get you know

308
00:17:37,630 --> 00:17:43,200
special<font color="#E5E5E5"> file which contains a memory of</font>

309
00:17:40,150 --> 00:17:46,180
the virtual machine inside the

310
00:17:43,200 --> 00:17:49,090
hypervisor I will get all the password

311
00:17:46,180 --> 00:17:52,510
so i did it and<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can get the password</font>

312
00:17:49,090 --> 00:17:55,990
as an operator in hyper-v and in<font color="#CCCCCC"> vmware</font>

313
00:17:52,510 --> 00:17:58,120
and<font color="#CCCCCC"> microsoft say to me no it's not a</font>

314
00:17:55,990 --> 00:18:02,230
problem because you are in front<font color="#E5E5E5"> of the</font>

315
00:17:58,120 --> 00:18:05,860
<font color="#E5E5E5">app I've I so so okay you can also</font>

316
00:18:02,230 --> 00:18:09,370
access else's process directly if you

317
00:18:05,860 --> 00:18:11,679
have<font color="#CCCCCC"> kernel mode access so if you have</font>

318
00:18:09,370 --> 00:18:15,429
kernel mode access you don't need to

319
00:18:11,680 --> 00:18:18,910
dump that you can directly still the

320
00:18:15,430 --> 00:18:22,420
<font color="#E5E5E5">bites okay so poor memory what it does</font>

321
00:18:18,910 --> 00:18:25,000
it calls the debugger is sendie to eat a

322
00:18:22,420 --> 00:18:28,930
comment to execute then you retrieve the

323
00:18:25,000 --> 00:18:31,800
bite it passes them very basically when

324
00:18:28,930 --> 00:18:35,320
you<font color="#E5E5E5"> have them okay need something else</font>

325
00:18:31,800 --> 00:18:39,070
begin another comment to inject and

326
00:18:35,320 --> 00:18:41,950
<font color="#CCCCCC">launch it and you can write to an</font>

327
00:18:39,070 --> 00:18:44,649
address<font color="#E5E5E5"> to the group because of the</font>

328
00:18:41,950 --> 00:18:46,600
debugger thanks to the debugger so okay

329
00:18:44,650 --> 00:18:50,410
can you see the password as the password

330
00:18:46,600 --> 00:18:54,639
is over that<font color="#E5E5E5"> I'll show you but if I show</font>

331
00:18:50,410 --> 00:18:59,190
<font color="#CCCCCC">that it would be like I asked you to</font>

332
00:18:54,640 --> 00:19:02,680
waste well do you know I don't know I

333
00:18:59,190 --> 00:19:05,470
never found what we'll do because and I

334
00:19:02,680 --> 00:19:06,909
it's even more difficult on<font color="#CCCCCC"> the screen I</font>

335
00:19:05,470 --> 00:19:10,690
think

336
00:19:06,909 --> 00:19:12,940
<font color="#E5E5E5">I hope you will see that because it's</font>

337
00:19:10,690 --> 00:19:17,109
very interesting so it's the<font color="#E5E5E5"> list entry</font>

338
00:19:12,940 --> 00:19:20,409
you know I give you the symbols to get

339
00:19:17,109 --> 00:19:25,590
the list entry so it's a<font color="#E5E5E5"> list and 34</font>

340
00:19:20,409 --> 00:19:29,320
done from a 2008 r2 windows server<font color="#E5E5E5"> okay</font>

341
00:19:25,590 --> 00:19:31,330
the first green element is the next time

342
00:19:29,320 --> 00:19:33,279
between the list okay it's an address

343
00:19:31,330 --> 00:19:36,759
you type this address you will get the

344
00:19:33,279 --> 00:19:39,340
next entry in the list<font color="#E5E5E5"> so red one is the</font>

345
00:19:36,759 --> 00:19:44,859
previous<font color="#E5E5E5"> one because it's circular like</font>

346
00:19:39,340 --> 00:19:49,509
i said this address so as you can see

347
00:19:44,859 --> 00:19:51,879
it's this address the<font color="#E5E5E5"> lu id address</font>

348
00:19:49,509 --> 00:19:54,279
which<font color="#CCCCCC"> is not at all interesting to get</font>

349
00:19:51,879 --> 00:19:57,759
the password budget which is a unique

350
00:19:54,279 --> 00:20:00,489
identifier on<font color="#CCCCCC"> a</font><font color="#E5E5E5"> Windows computer which</font>

351
00:19:57,759 --> 00:20:04,389
is<font color="#E5E5E5"> a guaranteed to be unique until the</font>

352
00:20:00,489 --> 00:20:06,970
next reboot then you have you the user

353
00:20:04,389 --> 00:20:09,369
name address and each it's in clear text

354
00:20:06,970 --> 00:20:12,279
so if you type<font color="#E5E5E5"> D use this address you</font>

355
00:20:09,369 --> 00:20:14,949
will have the<font color="#CCCCCC"> username the netbios</font>

356
00:20:12,279 --> 00:20:16,779
domain<font color="#E5E5E5"> name address the encrypted</font>

357
00:20:14,950 --> 00:20:20,259
password so if you try to you you will

358
00:20:16,779 --> 00:20:24,359
get nothing the<font color="#E5E5E5"> domain name address and</font>

359
00:20:20,259 --> 00:20:30,369
the username at domain address so it's

360
00:20:24,359 --> 00:20:34,149
true for 2008 r2 of<font color="#CCCCCC"> honor 2064 bit</font>

361
00:20:30,369 --> 00:20:36,609
architecture if you have a 32-bit a 2003

362
00:20:34,149 --> 00:20:38,709
it will be different<font color="#E5E5E5"> if you have a 2010</font>

363
00:20:36,609 --> 00:20:43,840
teeth will be different so<font color="#CCCCCC"> I had to</font><font color="#E5E5E5"> pass</font>

364
00:20:38,710 --> 00:20:48,399
all the thing regarding the operating

365
00:20:43,840 --> 00:20:54,129
system target it max length of the field

366
00:20:48,399 --> 00:20:56,018
and mainland for minimum so you have the

367
00:20:54,129 --> 00:20:57,488
password because you have the address of

368
00:20:56,019 --> 00:21:00,159
<font color="#E5E5E5">the password it's not enough you need</font>

369
00:20:57,489 --> 00:21:08,220
<font color="#E5E5E5">the</font><font color="#CCCCCC"> key and the initialization vector on</font>

370
00:21:00,159 --> 00:21:15,339
the 2008 r2 so<font color="#CCCCCC"> okay I type DD LLS a SRV</font>

371
00:21:08,220 --> 00:21:18,150
! and h3 des key and<font color="#CCCCCC"> I get this kind of</font>

372
00:21:15,339 --> 00:21:20,970
thing so the<font color="#E5E5E5"> green</font>

373
00:21:18,150 --> 00:21:25,770
the green address is the next entry so

374
00:21:20,970 --> 00:21:29,850
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> I type that I get in red I</font><font color="#E5E5E5"> get the</font>

375
00:21:25,770 --> 00:21:32,310
size of the block its empirical so I

376
00:21:29,850 --> 00:21:36,030
figure it out but I not sure it's it's

377
00:21:32,310 --> 00:21:38,790
it's it's a thing but I a review a lot

378
00:21:36,030 --> 00:21:43,500
of them<font color="#E5E5E5"> really so I think it's</font><font color="#CCCCCC"> the size</font>

379
00:21:38,790 --> 00:21:48,090
the tag k SSM which is also always the

380
00:21:43,500 --> 00:21:50,820
same next information you typed it this

381
00:21:48,090 --> 00:21:55,740
<font color="#E5E5E5">info this address and you will get in</font>

382
00:21:50,820 --> 00:21:59,159
red and the size in purple ma and

383
00:21:55,740 --> 00:22:02,910
another tag which is ms SK and the key

384
00:21:59,160 --> 00:22:04,590
and if you type DB it will be the<font color="#CCCCCC"> little</font>

385
00:22:02,910 --> 00:22:09,080
engine transformation for you so it's

386
00:22:04,590 --> 00:22:12,540
interesting so in blue you<font color="#CCCCCC"> have the key</font>

387
00:22:09,080 --> 00:22:14,909
representative in bite for you so you

388
00:22:12,540 --> 00:22:17,850
have<font color="#E5E5E5"> the password you have the key you</font>

389
00:22:14,910 --> 00:22:20,310
need the initialization vector<font color="#E5E5E5"> Allah and</font>

390
00:22:17,850 --> 00:22:21,929
and there we will be very technical now

391
00:22:20,310 --> 00:22:26,490
big to to get that it's very difficult

392
00:22:21,930 --> 00:22:29,180
to get that you have to type DB and the

393
00:22:26,490 --> 00:22:31,620
symbol<font color="#E5E5E5"> and you you have the directly</font>

394
00:22:29,180 --> 00:22:34,230
initialization vector so it's very<font color="#E5E5E5"> it's</font>

395
00:22:31,620 --> 00:22:36,449
<font color="#E5E5E5">a more difficult part of all the</font><font color="#CCCCCC"> other</font>

396
00:22:34,230 --> 00:22:39,120
thing so you have the three information

397
00:22:36,450 --> 00:22:42,110
with<font color="#CCCCCC"> this free information you will be</font>

398
00:22:39,120 --> 00:22:48,949
able to<font color="#E5E5E5"> decrypt that very easily by a</font>

399
00:22:42,110 --> 00:22:54,959
standard a and algorithm no nothing you

400
00:22:48,950 --> 00:22:57,710
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> I have some</font><font color="#CCCCCC"> demo so first demo to</font>

401
00:22:54,960 --> 00:22:57,710
get the password

402
00:22:58,790 --> 00:23:00,790
uh

403
00:23:02,260 --> 00:23:15,010
ok so its power shall I I see nothing<font color="#E5E5E5"> ok</font>

404
00:23:11,680 --> 00:23:18,490
so you you just<font color="#E5E5E5"> launched it on locally</font>

405
00:23:15,010 --> 00:23:22,890
on the computer you<font color="#CCCCCC"> show you a menu you</font>

406
00:23:18,490 --> 00:23:26,260
type ok<font color="#CCCCCC"> I want to password so i type 1a</font>

407
00:23:22,890 --> 00:23:29,650
figure it out you're right level etc so

408
00:23:26,260 --> 00:23:32,230
each launch another console and then you

409
00:23:29,650 --> 00:23:35,830
can do different thing the first thing

410
00:23:32,230 --> 00:23:38,020
is ok if you are<font color="#E5E5E5"> into Windows domain do</font>

411
00:23:35,830 --> 00:23:41,110
you want<font color="#CCCCCC"> that if I if I find something</font>

412
00:23:38,020 --> 00:23:43,600
do you want that I match it with you

413
00:23:41,110 --> 00:23:45,310
know easy to domain administrator is it

414
00:23:43,600 --> 00:23:47,350
an enterprise one easy easy to back

415
00:23:45,310 --> 00:23:51,100
appropriate or what is but if you do

416
00:23:47,350 --> 00:23:52,929
that it will make an ldap<font color="#E5E5E5"> request into</font>

417
00:23:51,100 --> 00:23:55,419
the domain controller so maybe<font color="#E5E5E5"> you</font><font color="#CCCCCC"> don't</font>

418
00:23:52,930 --> 00:23:58,180
want to do that if you don't<font color="#E5E5E5"> want to</font>

419
00:23:55,420 --> 00:24:01,210
type<font color="#CCCCCC"> to to get the password locally you</font>

420
00:23:58,180 --> 00:24:04,030
type one you can do remotely you can do

421
00:24:01,210 --> 00:24:07,420
from else's process you collect I don't

422
00:24:04,030 --> 00:24:10,780
know when you go<font color="#CCCCCC"> through to a friend</font>

423
00:24:07,420 --> 00:24:14,530
friend house something like that you can

424
00:24:10,780 --> 00:24:20,379
do it with VM snapshot you can do it in

425
00:24:14,530 --> 00:24:22,870
kernel mode so I i will type 1 and no<font color="#CCCCCC"> i</font>

426
00:24:20,380 --> 00:24:25,120
<font color="#E5E5E5">don't want to send it to paste bin but</font>

427
00:24:22,870 --> 00:24:28,629
if you if you<font color="#CCCCCC"> just type enter it wit</font>

428
00:24:25,120 --> 00:24:31,209
won't send it you know i'll show you you

429
00:24:28,630 --> 00:24:35,410
can<font color="#E5E5E5"> you can look into the code</font><font color="#CCCCCC"> i have</font>

430
00:24:31,210 --> 00:24:38,380
nothing<font color="#E5E5E5"> to add so I ok and do you want</font>

431
00:24:35,410 --> 00:24:41,260
<font color="#E5E5E5">to I don't</font><font color="#CCCCCC"> know do you want</font><font color="#E5E5E5"> to clear</font>

432
00:24:38,380 --> 00:24:44,980
neck<font color="#CCCCCC"> even</font><font color="#E5E5E5"> log on this computer so yes we</font>

433
00:24:41,260 --> 00:24:49,480
can just the technique is just to stop

434
00:24:44,980 --> 00:24:52,240
everything that holds the Z event log so

435
00:24:49,480 --> 00:24:54,730
<font color="#E5E5E5">I did I do that first and that I replace</font>

436
00:24:52,240 --> 00:24:56,650
the log with another log that contain

437
00:24:54,730 --> 00:25:02,560
nothing or information completely

438
00:24:56,650 --> 00:25:07,380
useless you know so yes getting valuable

439
00:25:02,560 --> 00:25:10,419
information and<font color="#E5E5E5"> ok I have password and I</font>

440
00:25:07,380 --> 00:25:13,180
put a very secure one because I put<font color="#E5E5E5"> to</font>

441
00:25:10,420 --> 00:25:15,440
you know password<font color="#CCCCCC"> too because one is</font>

442
00:25:13,180 --> 00:25:21,860
<font color="#E5E5E5">very insecure so I</font><font color="#CCCCCC"> prefer</font>

443
00:25:15,440 --> 00:25:24,500
and the non understable character is

444
00:25:21,860 --> 00:25:27,668
because it's a key associated with the

445
00:25:24,500 --> 00:25:27,669
<font color="#E5E5E5">machine with the computer</font>

446
00:25:29,290 --> 00:25:32,040
ok

447
00:25:34,600 --> 00:25:42,260
ok you can inject a shellcode into a

448
00:25:39,529 --> 00:25:46,940
remote process and executed and the<font color="#CCCCCC"> goal</font>

449
00:25:42,260 --> 00:25:52,129
is not just to do what you can<font color="#E5E5E5"> already</font>

450
00:25:46,940 --> 00:25:55,190
do but do it and never use an API ok so

451
00:25:52,130 --> 00:25:59,090
just manipulating bite into the memory

452
00:25:55,190 --> 00:26:04,159
and<font color="#E5E5E5"> I would like</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> call it without a</font>

453
00:25:59,090 --> 00:26:07,299
call and API so to do that you need<font color="#E5E5E5"> to</font>

454
00:26:04,159 --> 00:26:10,429
get a memory executable zone somewhere

455
00:26:07,299 --> 00:26:13,039
you<font color="#E5E5E5"> need a new padding zone into this</font>

456
00:26:10,429 --> 00:26:15,679
memory the catabolism that you get and

457
00:26:13,039 --> 00:26:18,590
you need the<font color="#CCCCCC"> address of the new openings</font>

458
00:26:15,679 --> 00:26:21,460
on to execute it because I give you the

459
00:26:18,590 --> 00:26:24,379
hint to to execute it we will<font color="#E5E5E5"> just</font>

460
00:26:21,460 --> 00:26:27,500
modify the register instruction pointer

461
00:26:24,380 --> 00:26:28,940
and so the next<font color="#E5E5E5"> instruction send it to</font>

462
00:26:27,500 --> 00:26:33,470
the operating<font color="#E5E5E5"> system will be your</font>

463
00:26:28,940 --> 00:26:36,140
shellcode so we will need<font color="#CCCCCC"> to pass the</font>

464
00:26:33,470 --> 00:26:42,289
rod table executable load it into the

465
00:26:36,140 --> 00:26:44,419
<font color="#E5E5E5">memory and it's not very difficult you</font>

466
00:26:42,289 --> 00:26:47,210
can you you the<font color="#CCCCCC"> first thing</font><font color="#E5E5E5"> you have to</font>

467
00:26:44,419 --> 00:26:49,640
to get is the<font color="#CCCCCC"> address of</font><font color="#E5E5E5"> the module load</font>

468
00:26:47,210 --> 00:26:54,559
it into the<font color="#E5E5E5"> memory so for the target</font>

469
00:26:49,640 --> 00:26:57,049
<font color="#E5E5E5">that you try to to pass from this module</font>

470
00:26:54,559 --> 00:27:01,370
address you get the PE header address

471
00:26:57,049 --> 00:27:06,440
which is<font color="#E5E5E5"> located from the module address</font>

472
00:27:01,370 --> 00:27:10,070
you get plus<font color="#CCCCCC"> a 3 see from this P address</font>

473
00:27:06,440 --> 00:27:13,270
which is<font color="#E5E5E5"> always 24 bytes you have the</font>

474
00:27:10,070 --> 00:27:16,428
size of the optional header in in bytes

475
00:27:13,270 --> 00:27:19,450
from the optional header you can add a

476
00:27:16,429 --> 00:27:21,919
section table structure and you will

477
00:27:19,450 --> 00:27:24,200
because<font color="#CCCCCC"> it's follows immediately than</font>

478
00:27:21,919 --> 00:27:26,570
the previous information you get and

479
00:27:24,200 --> 00:27:28,789
from the section<font color="#E5E5E5"> table you will have the</font>

480
00:27:26,570 --> 00:27:31,549
<font color="#CCCCCC">visual side the virtual address</font><font color="#E5E5E5"> and the</font>

481
00:27:28,789 --> 00:27:33,860
raw data pointers that you need with to

482
00:27:31,549 --> 00:27:39,830
calculate your pie dings on it etc<font color="#CCCCCC"> and</font>

483
00:27:33,860 --> 00:27:43,490
then it is a comment<font color="#E5E5E5"> that I so I write a</font>

484
00:27:39,830 --> 00:27:46,149
bite so I take a shellcode I write the

485
00:27:43,490 --> 00:27:48,610
bat into<font color="#CCCCCC"> the</font><font color="#E5E5E5"> memory and I just</font>

486
00:27:46,150 --> 00:27:50,440
ask to the<font color="#CCCCCC"> beggar to modify the written</font>

487
00:27:48,610 --> 00:27:52,750
instruction pointer with the module

488
00:27:50,440 --> 00:27:56,740
address that<font color="#CCCCCC"> I found and it will launch</font>

489
00:27:52,750 --> 00:28:00,250
it will launch it will launch my shell

490
00:27:56,740 --> 00:28:02,620
code into the<font color="#E5E5E5"> process that</font><font color="#CCCCCC"> I attacked</font>

491
00:28:00,250 --> 00:28:09,370
with the level<font color="#CCCCCC"> of right of</font><font color="#E5E5E5"> this process</font>

492
00:28:02,620 --> 00:28:12,729
<font color="#E5E5E5">and you will have a calculator demo a</font>

493
00:28:09,370 --> 00:28:15,520
friend of me pray actually the god of

494
00:28:12,730 --> 00:28:22,140
demo because I have liked for them up

495
00:28:15,520 --> 00:28:22,139
you know so I ok

496
00:28:27,549 --> 00:28:30,239
ok

497
00:28:30,470 --> 00:28:39,950
oh yeah<font color="#E5E5E5"> I can show you the death and the</font>

498
00:28:35,650 --> 00:28:42,230
minesweeper solver because it's a it it

499
00:28:39,950 --> 00:28:44,960
and show something about modifying

500
00:28:42,230 --> 00:28:47,750
memory directly you know I don't<font color="#E5E5E5"> know</font>

501
00:28:44,960 --> 00:28:49,700
but if<font color="#E5E5E5"> Anna content modify financial</font>

502
00:28:47,750 --> 00:28:54,200
information into<font color="#CCCCCC"> the marriage could be</font>

503
00:28:49,700 --> 00:28:58,039
very not a secure you know to to see

504
00:28:54,200 --> 00:29:01,130
this that modify and the accountant

505
00:28:58,039 --> 00:29:04,400
could see the<font color="#E5E5E5"> themes normally and the</font>

506
00:29:01,130 --> 00:29:07,400
data send it will want Beezer that I you

507
00:29:04,400 --> 00:29:12,280
<font color="#E5E5E5">know II try to input into the screen so</font>

508
00:29:07,400 --> 00:29:12,280
<font color="#E5E5E5">okay so they might the field</font>

509
00:29:13,730 --> 00:29:19,900
<font color="#E5E5E5">okay so it launched something I wit with</font>

510
00:29:17,060 --> 00:29:27,100
so it's you<font color="#CCCCCC"> know there's a grid</font><font color="#E5E5E5"> with all</font>

511
00:29:19,900 --> 00:29:27,100
<font color="#E5E5E5">the you have to click etc so</font>

512
00:29:33,200 --> 00:29:44,720
<font color="#E5E5E5">okay yeah it's not easy but maybe I will</font>

513
00:29:39,570 --> 00:29:44,720
just for that modify my settings

514
00:29:48,509 --> 00:29:51,509
ok

515
00:29:51,940 --> 00:29:57,610
okay so you have you know you have the

516
00:29:55,149 --> 00:30:00,279
<font color="#E5E5E5">minesweeper you have the menu because he</font>

517
00:29:57,610 --> 00:30:02,709
asked you okay how do you want to<font color="#E5E5E5"> solve</font>

518
00:30:00,279 --> 00:30:04,870
the grid of a minesweeper you can flag

519
00:30:02,710 --> 00:30:08,049
the bomb if you want like like the

520
00:30:04,870 --> 00:30:10,239
normal game but it's<font color="#E5E5E5"> very it's very bad</font>

521
00:30:08,049 --> 00:30:11,740
game I don't<font color="#E5E5E5"> like you know put all the</font>

522
00:30:10,240 --> 00:30:13,720
flag it's not very interesting<font color="#CCCCCC"> you can</font>

523
00:30:11,740 --> 00:30:16,929
demand the bombs directly if you want

524
00:30:13,720 --> 00:30:19,659
you you can reveal the bombs you can

525
00:30:16,929 --> 00:30:23,350
<font color="#E5E5E5">explore the bombs and still win you can</font>

526
00:30:19,659 --> 00:30:25,840
make a 42 option which is<font color="#CCCCCC"> a special one</font>

527
00:30:23,350 --> 00:30:29,559
and you can clean the board if I try I

528
00:30:25,840 --> 00:30:32,678
don't know two explosive bombs so it

529
00:30:29,559 --> 00:30:35,830
works with my phone in tutoring so maybe

530
00:30:32,679 --> 00:30:40,600
it will it won't<font color="#E5E5E5"> be very very quick very</font>

531
00:30:35,830 --> 00:30:44,080
fast so<font color="#CCCCCC"> it looks it looks</font><font color="#E5E5E5"> in the colonel</font>

532
00:30:40,600 --> 00:30:46,240
sorry userland so it's not<font color="#E5E5E5"> colonel and</font>

533
00:30:44,080 --> 00:30:48,668
you will try to figure<font color="#E5E5E5"> out which this</font>

534
00:30:46,240 --> 00:30:50,830
which is the<font color="#E5E5E5"> site of the grid and then</font>

535
00:30:48,669 --> 00:30:52,690
pass it into the memory because into the

536
00:30:50,830 --> 00:30:54,549
memory you will you have the exact

537
00:30:52,690 --> 00:30:57,039
structure that you can see on the screen

538
00:30:54,549 --> 00:30:59,230
but not exactly like you know the grid

539
00:30:57,039 --> 00:31:03,840
perfectly align it's not<font color="#E5E5E5"> like that</font>

540
00:30:59,230 --> 00:31:03,840
normally it's very quick but

541
00:31:08,130 --> 00:31:19,750
ok so you shows the icon here normally

542
00:31:15,690 --> 00:31:22,330
it has to<font color="#CCCCCC"> work it is</font><font color="#E5E5E5"> we'll work it just</font>

543
00:31:19,750 --> 00:31:27,880
because the internet connection<font color="#E5E5E5"> I think</font>

544
00:31:22,330 --> 00:31:30,129
of my phone<font color="#CCCCCC"> okay so 13 x 16 so he saw</font>

545
00:31:27,880 --> 00:31:32,770
the grid into the memory and<font color="#E5E5E5"> you say</font><font color="#CCCCCC"> ok</font>

546
00:31:30,130 --> 00:31:36,010
has been secure so<font color="#CCCCCC"> i will</font><font color="#E5E5E5"> try to display</font>

547
00:31:32,770 --> 00:31:38,740
that<font color="#E5E5E5"> oh wow interesting so</font><font color="#CCCCCC"> i have</font>

548
00:31:36,010 --> 00:31:42,220
<font color="#E5E5E5">exploited all the mines and I cannot</font>

549
00:31:38,740 --> 00:31:43,630
lose not so it's you know okay you can

550
00:31:42,220 --> 00:31:46,870
do that it it's not<font color="#CCCCCC"> very interesting</font>

551
00:31:43,630 --> 00:31:50,320
because it's it's not fast to win so I

552
00:31:46,870 --> 00:31:52,989
prefer<font color="#CCCCCC"> to select you know the option of</font>

553
00:31:50,320 --> 00:31:56,200
clean the board and<font color="#E5E5E5"> I just click one and</font>

554
00:31:52,990 --> 00:32:00,010
then i win directly<font color="#E5E5E5"> and</font><font color="#CCCCCC"> I have</font><font color="#E5E5E5"> the</font>

555
00:31:56,200 --> 00:32:05,890
maximum score yeah so it's fun but<font color="#CCCCCC"> the</font>

556
00:32:00,010 --> 00:32:10,810
goal is to<font color="#E5E5E5"> show you the impact so for us</font>

557
00:32:05,890 --> 00:32:17,860
a rest in injection into a remote

558
00:32:10,810 --> 00:32:19,720
process no it's not it's not better so I

559
00:32:17,860 --> 00:32:30,090
will

560
00:32:19,720 --> 00:32:36,820
ah ok i don't know if i have a process

561
00:32:30,090 --> 00:32:39,610
<font color="#CCCCCC">ok i</font><font color="#E5E5E5"> have a CMD ok command prompt i will</font>

562
00:32:36,820 --> 00:32:45,220
i will close it ok so i launched another

563
00:32:39,610 --> 00:32:47,080
one so<font color="#E5E5E5"> i want to inject something not</font>

564
00:32:45,220 --> 00:32:52,900
<font color="#CCCCCC">all the privilege not was this time but</font>

565
00:32:47,080 --> 00:32:56,500
a process something so I e-pass all the

566
00:32:52,900 --> 00:33:01,260
things and normally you have to see I

567
00:32:56,500 --> 00:33:03,890
don't<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> because my wife is</font>

568
00:33:01,260 --> 00:33:06,640
calculating

569
00:33:03,890 --> 00:33:06,640
ok

570
00:33:10,980 --> 00:33:23,460
I don't know why it does not rock okay

571
00:33:17,490 --> 00:33:30,450
okay actually it worked but as we cannot

572
00:33:23,460 --> 00:33:32,840
see all the screen<font color="#E5E5E5"> I will try</font><font color="#CCCCCC"> to just we</font>

573
00:33:30,450 --> 00:33:32,840
launched it

574
00:33:34,290 --> 00:33:44,490
sorry yes I don't know what way it is

575
00:33:38,290 --> 00:33:51,909
but normally you you see it I can<font color="#E5E5E5"> try to</font>

576
00:33:44,490 --> 00:33:54,400
to inject in because in fact if I if I

577
00:33:51,910 --> 00:33:56,350
try to put exit you know I don't exceed

578
00:33:54,400 --> 00:33:59,350
because my process is<font color="#E5E5E5"> already injected</font>

579
00:33:56,350 --> 00:34:04,510
into but if you if you want to see the

580
00:33:59,350 --> 00:34:07,770
calculator<font color="#E5E5E5"> I will try to inject another</font>

581
00:34:04,510 --> 00:34:07,770
process like notepad

582
00:34:11,829 --> 00:34:19,310
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> i have the calculator so and</font>

583
00:34:15,889 --> 00:34:22,099
if i show you into the memory with the

584
00:34:19,310 --> 00:34:24,799
tools of my Christina which are working

585
00:34:22,099 --> 00:34:33,710
on Microsoft and who create a

586
00:34:24,800 --> 00:34:36,440
sysinternals sweet it's injected into

587
00:34:33,710 --> 00:34:43,599
the net pan okay the calculator is into

588
00:34:36,440 --> 00:34:43,599
<font color="#E5E5E5">the notepad the</font><font color="#CCCCCC"> taxi process okay</font>

589
00:34:45,960 --> 00:34:56,290
yes but<font color="#E5E5E5"> okay kiernan stuff so now we are</font>

590
00:34:54,159 --> 00:34:59,950
<font color="#E5E5E5">going to the camel lon because it's more</font>

591
00:34:56,290 --> 00:35:02,950
fun you can do everything<font color="#CCCCCC"> in Kanna all</font>

592
00:34:59,950 --> 00:35:05,580
what you can do in userland but also a

593
00:35:02,950 --> 00:35:10,089
lot<font color="#CCCCCC"> of lot of things that you</font><font color="#E5E5E5"> cannot and</font>

594
00:35:05,580 --> 00:35:13,210
just to make a easy proof<font color="#E5E5E5"> of concept</font>

595
00:35:10,090 --> 00:35:16,090
that it is easy to understand i will

596
00:35:13,210 --> 00:35:18,130
<font color="#E5E5E5">show you the height process it's not a</font>

597
00:35:16,090 --> 00:35:21,430
new technique to hide process its

598
00:35:18,130 --> 00:35:24,130
advanced malware already did that but

599
00:35:21,430 --> 00:35:26,200
maybe not with the burger<font color="#E5E5E5"> and a partial</font>

600
00:35:24,130 --> 00:35:29,380
like that so if you want to<font color="#E5E5E5"> hide a</font>

601
00:35:26,200 --> 00:35:32,470
process into the memory process is

602
00:35:29,380 --> 00:35:34,810
contained in to a a process structure if

603
00:35:32,470 --> 00:35:37,509
you type on google<font color="#E5E5E5"> eat processed through</font>

604
00:35:34,810 --> 00:35:40,690
to you will find it and you have this

605
00:35:37,510 --> 00:35:45,970
kind of information so each each little

606
00:35:40,690 --> 00:35:48,760
square is a process and and yes f link

607
00:35:45,970 --> 00:35:50,890
building is falling and back<font color="#CCCCCC"> rolling</font><font color="#E5E5E5"> you</font>

608
00:35:48,760 --> 00:35:55,360
can you can see<font color="#CCCCCC"> that all is linked to</font>

609
00:35:50,890 --> 00:35:59,230
each other and in a<font color="#E5E5E5"> circular away so the</font>

610
00:35:55,360 --> 00:36:02,620
first<font color="#CCCCCC"> thing to do is to unlink you know</font>

611
00:35:59,230 --> 00:36:04,960
a process because it's more fun if it's

612
00:36:02,620 --> 00:36:08,520
unlink because the colonel won't be able

613
00:36:04,960 --> 00:36:11,830
to see that but if you just do that<font color="#E5E5E5"> it's</font>

614
00:36:08,520 --> 00:36:19,240
it<font color="#CCCCCC"> just bsod so it's blue screen of</font>

615
00:36:11,830 --> 00:36:22,960
death immediately so you have to give<font color="#CCCCCC"> to</font>

616
00:36:19,240 --> 00:36:26,080
<font color="#CCCCCC">the colonel</font><font color="#E5E5E5"> the illusion all is ok so ok</font>

617
00:36:22,960 --> 00:36:30,280
in pro<font color="#E5E5E5"> rochelle you you send a command</font>

618
00:36:26,080 --> 00:36:32,380
to the debugger and you create this link

619
00:36:30,280 --> 00:36:34,870
from the previous process to the<font color="#E5E5E5"> next</font>

620
00:36:32,380 --> 00:36:37,480
one<font color="#E5E5E5"> and you do the things for the back</font>

621
00:36:34,870 --> 00:36:42,460
wedding but if you do just<font color="#E5E5E5"> that same</font>

622
00:36:37,480 --> 00:36:46,480
thing bsod because the operating system

623
00:36:42,460 --> 00:36:49,570
will figure out that<font color="#CCCCCC"> you have do</font>

624
00:36:46,480 --> 00:36:51,970
something with its structure its

625
00:36:49,570 --> 00:36:55,589
internal structure because a one of the

626
00:36:51,970 --> 00:36:58,359
process which is a process

627
00:36:55,589 --> 00:37:01,270
is not linked<font color="#E5E5E5"> to anything so it's not</font>

628
00:36:58,359 --> 00:37:06,819
it's<font color="#E5E5E5"> not normal so you you simulate it</font>

629
00:37:01,270 --> 00:37:09,069
you create that and this and all will be

630
00:37:06,819 --> 00:37:12,460
very good for the colonel and<font color="#E5E5E5"> you can</font>

631
00:37:09,069 --> 00:37:18,839
continue<font color="#E5E5E5"> to work normally with a process</font>

632
00:37:12,460 --> 00:37:18,839
which is hidden so yes sorry

633
00:37:19,250 --> 00:37:26,140
so demo my last set up so demo

634
00:37:26,789 --> 00:37:33,989
you want to hide something to the

635
00:37:29,819 --> 00:37:37,619
<font color="#E5E5E5">colonel and to the operating system</font>

636
00:37:33,989 --> 00:37:42,449
sorry so okay we will you we have<font color="#CCCCCC"> a</font><font color="#E5E5E5"> CMD</font>

637
00:37:37,619 --> 00:37:46,769
that we had just before<font color="#CCCCCC"> I will type hide</font>

638
00:37:42,449 --> 00:37:59,729
my process which is cmd.exe and I will

639
00:37:46,769 --> 00:38:01,288
try<font color="#CCCCCC"> to have okay okay maybe</font><font color="#E5E5E5"> I will have</font>

640
00:37:59,729 --> 00:38:03,808
the same problem with the internet

641
00:38:01,289 --> 00:38:07,109
connection because why I need the

642
00:38:03,809 --> 00:38:11,519
<font color="#E5E5E5">internet connection I don't really need</font>

643
00:38:07,109 --> 00:38:14,669
it absolutely but as<font color="#E5E5E5"> I said first I i</font>

644
00:38:11,519 --> 00:38:19,769
connect to<font color="#CCCCCC"> Microsoft guess it's a fond</font>

645
00:38:14,669 --> 00:38:22,439
he found the address I and he<font color="#CCCCCC"> is not so</font>

646
00:38:19,769 --> 00:38:25,948
I have to connect to the<font color="#E5E5E5"> Microsoft</font>

647
00:38:22,439 --> 00:38:28,949
servers<font color="#E5E5E5"> Microsoft symbol servers to get</font>

648
00:38:25,949 --> 00:38:31,949
the symbols and then be able<font color="#CCCCCC"> to you know</font>

649
00:38:28,949 --> 00:38:34,199
type all the<font color="#E5E5E5"> things I I could pre load</font>

650
00:38:31,949 --> 00:38:36,779
all the symbols on my computer and and

651
00:38:34,199 --> 00:38:38,759
don't don't need to do that but I don't

652
00:38:36,779 --> 00:38:41,819
want to you know to put all the symbols

653
00:38:38,759 --> 00:38:43,619
of all the operating system<font color="#CCCCCC"> of my</font>

654
00:38:41,819 --> 00:38:45,269
computer because it's it's not a

655
00:38:43,619 --> 00:38:48,539
targeted attack it's a demo

656
00:38:45,269 --> 00:38:50,538
demonstration if I need<font color="#E5E5E5"> to make a</font><font color="#CCCCCC"> Suns</font>

657
00:38:48,539 --> 00:38:52,799
in targeted I will target a specific

658
00:38:50,539 --> 00:38:55,949
operating system on a specific

659
00:38:52,799 --> 00:38:59,849
architecture so yes it's sorted by name

660
00:38:55,949 --> 00:39:04,650
so yes is not is not<font color="#E5E5E5"> that but is easy</font>

661
00:38:59,849 --> 00:39:09,559
because if I yes yes yes i have CMD you

662
00:39:04,650 --> 00:39:15,079
know i can type who am i all right yes

663
00:39:09,559 --> 00:39:18,839
like<font color="#E5E5E5"> that and yes it works because he is</font>

664
00:39:15,079 --> 00:39:21,449
in Windows web process and thread and

665
00:39:18,839 --> 00:39:25,439
the sweat continue to work usual and

666
00:39:21,449 --> 00:39:28,439
normally but I like<font color="#CCCCCC"> to you know to do</font>

667
00:39:25,439 --> 00:39:33,989
correctly things so if you have this

668
00:39:28,439 --> 00:39:36,649
address which is<font color="#E5E5E5"> the current address of</font>

669
00:39:33,989 --> 00:39:36,650
this<font color="#E5E5E5"> process</font>

670
00:39:39,540 --> 00:39:51,170
yes it appears so it works too<font color="#E5E5E5"> okay um</font>

671
00:39:51,480 --> 00:40:01,890
yeah<font color="#E5E5E5"> I did a thing to to weaponize these</font>

672
00:39:58,170 --> 00:40:06,180
tools so you can if you know hand by

673
00:40:01,890 --> 00:40:09,450
empire which has a very cool<font color="#E5E5E5"> tool i did</font>

674
00:40:06,180 --> 00:40:11,759
a pull request on it and to be able to

675
00:40:09,450 --> 00:40:15,600
do this kind of things with the debugger

676
00:40:11,760 --> 00:40:18,990
on the user to target so it's not in one

677
00:40:15,600 --> 00:40:21,990
Dolan it's a real world so<font color="#E5E5E5"> normally i</font>

678
00:40:18,990 --> 00:40:24,569
have<font color="#E5E5E5"> a music with you note familiar I</font>

679
00:40:21,990 --> 00:40:27,540
don't know<font color="#E5E5E5"> that I I don't have that for</font>

680
00:40:24,570 --> 00:40:30,450
you sorry so<font color="#E5E5E5"> Empire is a very cool tool</font>

681
00:40:27,540 --> 00:40:33,240
if you don't know<font color="#CCCCCC"> that you have to</font><font color="#E5E5E5"> look</font>

682
00:40:30,450 --> 00:40:38,490
at<font color="#E5E5E5"> that on internet so it was developed</font>

683
00:40:33,240 --> 00:40:41,459
by three people but also helped by other

684
00:40:38,490 --> 00:40:44,580
people so i'm john 6 de Panama but you

685
00:40:41,460 --> 00:40:47,520
have also matt grubber which is a very

686
00:40:44,580 --> 00:40:53,009
awesome game guys right and should<font color="#CCCCCC"> make</font>

687
00:40:47,520 --> 00:40:54,690
up is<font color="#E5E5E5"> that a speaker just before so if</font>

688
00:40:53,010 --> 00:40:57,030
you want<font color="#E5E5E5"> to do that</font><font color="#CCCCCC"> you have to target</font>

689
00:40:54,690 --> 00:40:59,340
something<font color="#E5E5E5"> I don't know what you force</font>

690
00:40:57,030 --> 00:41:02,190
the target to load<font color="#CCCCCC"> you and Perry argent</font>

691
00:40:59,340 --> 00:41:04,770
and through thin pyogenes you load poor

692
00:41:02,190 --> 00:41:06,660
memory into<font color="#CCCCCC"> the target memory you drop</font>

693
00:41:04,770 --> 00:41:10,350
the scientific or because it's a concept

694
00:41:06,660 --> 00:41:17,368
and you make<font color="#E5E5E5"> final profits and I have a</font>

695
00:41:10,350 --> 00:41:21,060
demo for you so you<font color="#E5E5E5"> have a basic</font><font color="#CCCCCC"> Kelly</font>

696
00:41:17,369 --> 00:41:22,890
and here maybe the password is not as

697
00:41:21,060 --> 00:41:28,580
secure that the other one because it's

698
00:41:22,890 --> 00:41:28,580
one so you have Empire

699
00:41:31,660 --> 00:41:40,700
<font color="#CCCCCC">ok I've</font><font color="#E5E5E5"> listed to know but no agents and</font>

700
00:41:37,329 --> 00:41:43,099
you can do different thing here<font color="#E5E5E5"> I will</font>

701
00:41:40,700 --> 00:41:45,460
try to show you something but I'm not

702
00:41:43,099 --> 00:41:49,460
sure<font color="#E5E5E5"> it will work but it's something</font>

703
00:41:45,460 --> 00:41:52,970
that case dismissed I don't know if you

704
00:41:49,460 --> 00:41:56,900
know him Casey Smith sub T<font color="#E5E5E5"> Gila straight</font>

705
00:41:52,970 --> 00:42:00,980
at a different technique to whitelist to

706
00:41:56,900 --> 00:42:05,660
to try<font color="#E5E5E5"> to bypass microsoft</font><font color="#CCCCCC"> link with</font>

707
00:42:00,980 --> 00:42:09,470
Microsoft tools too so it<font color="#E5E5E5"> show that with</font>

708
00:42:05,660 --> 00:42:11,990
our software called ms build eggsy you

709
00:42:09,470 --> 00:42:15,980
<font color="#CCCCCC">shoot you should be able to launch I</font>

710
00:42:11,990 --> 00:42:19,700
don't know partial code by example so as

711
00:42:15,980 --> 00:42:26,750
soon as I saw that I try to do something

712
00:42:19,700 --> 00:42:30,589
and the thing is yeah okay the thing is

713
00:42:26,750 --> 00:42:34,130
to to launch partial but without having

714
00:42:30,589 --> 00:42:38,980
<font color="#CCCCCC">portion in memory into memory ok so it's</font>

715
00:42:34,130 --> 00:42:38,980
into<font color="#CCCCCC"> ok</font>

716
00:42:41,569 --> 00:42:44,569
ok

717
00:42:48,630 --> 00:42:57,579
and you have the primal here so you<font color="#E5E5E5"> have</font>

718
00:42:54,999 --> 00:43:01,779
MS bill which is Prince tool by

719
00:42:57,579 --> 00:43:05,559
Microsoft and I prepare something which

720
00:43:01,779 --> 00:43:09,039
is beside DC dot XML so if you if you

721
00:43:05,559 --> 00:43:11,589
<font color="#E5E5E5">are able to cross by example by</font>

722
00:43:09,039 --> 00:43:16,450
something like a rule not la cruel

723
00:43:11,589 --> 00:43:18,788
client rule<font color="#CCCCCC"> 2 for the client to launch a</font>

724
00:43:16,450 --> 00:43:21,640
software which is<font color="#E5E5E5"> already installed in</font>

725
00:43:18,789 --> 00:43:25,869
the operating system with just something

726
00:43:21,640 --> 00:43:28,808
very not dangerous like an XML file you

727
00:43:25,869 --> 00:43:32,410
should be able to provoke something like

728
00:43:28,809 --> 00:43:34,719
that<font color="#CCCCCC"> ok I have an urgent you saw so</font>

729
00:43:32,410 --> 00:43:39,269
initially<font color="#E5E5E5"> gent blah blah blah it just</font>

730
00:43:34,719 --> 00:43:43,599
come from that and if I check my memory

731
00:43:39,269 --> 00:43:46,959
just with that<font color="#CCCCCC"> I I will i see ch partial</font>

732
00:43:43,599 --> 00:43:49,900
eyes which is my IDE but I<font color="#E5E5E5"> don't see pro</font>

733
00:43:46,960 --> 00:43:51,670
shell as a console because if if for

734
00:43:49,900 --> 00:43:55,779
shell was lunch i will have something

735
00:43:51,670 --> 00:43:58,269
like that and it's actually loaded into

736
00:43:55,779 --> 00:44:01,900
ms<font color="#E5E5E5"> build that eggsy so</font><font color="#CCCCCC"> it's pretty cool</font>

737
00:43:58,269 --> 00:44:05,649
it's on my<font color="#E5E5E5"> get up if you want to take a</font>

738
00:44:01,900 --> 00:44:12,910
<font color="#CCCCCC">look</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> that but the objective was not</font>

739
00:44:05,650 --> 00:44:16,920
that is to look at her memory true<font color="#CCCCCC"> in PI</font>

740
00:44:12,910 --> 00:44:20,739
off so you can<font color="#E5E5E5"> interact with this agent</font>

741
00:44:16,920 --> 00:44:26,650
use a module financial and my<font color="#E5E5E5"> to list</font>

742
00:44:20,739 --> 00:44:29,769
it's really<font color="#E5E5E5"> easy to say it r WM c RS but</font>

743
00:44:26,650 --> 00:44:32,829
it's actually means something it to

744
00:44:29,769 --> 00:44:37,089
reveal windows memory credential remote

745
00:44:32,829 --> 00:44:39,759
shell so info you don't need anything

746
00:44:37,089 --> 00:44:42,460
else that I need an active agent on your

747
00:44:39,759 --> 00:44:45,119
target<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you type run normally would</font>

748
00:44:42,460 --> 00:44:45,119
it will work

749
00:44:45,490 --> 00:44:54,540
yeah so debug so you have I don't know

750
00:44:51,369 --> 00:44:58,450
ok follow the right rabbit obviously in

751
00:44:54,540 --> 00:45:02,230
<font color="#E5E5E5">Wonderland and normally we will have a</font>

752
00:44:58,450 --> 00:45:07,029
password so<font color="#E5E5E5"> you have this machine yes so</font>

753
00:45:02,230 --> 00:45:09,820
password to you know etc and this

754
00:45:07,030 --> 00:45:12,869
machine is maybe I<font color="#E5E5E5"> don't on the internet</font>

755
00:45:09,820 --> 00:45:12,869
on something like that

756
00:45:20,620 --> 00:45:31,660
okay okay mitigation how to mitigate

757
00:45:27,450 --> 00:45:34,680
that kind of attacks as the first thing

758
00:45:31,660 --> 00:45:38,319
it's too don't trust the trusted tooth

759
00:45:34,680 --> 00:45:41,020
sorry but it's it's<font color="#E5E5E5"> the first answer to</font>

760
00:45:38,320 --> 00:45:43,300
that you have to<font color="#E5E5E5"> look at</font><font color="#CCCCCC"> the behavior so</font>

761
00:45:41,020 --> 00:45:46,090
it's a pretty it's it's more difficult

762
00:45:43,300 --> 00:45:49,210
it's not just okay this tool is not sign

763
00:45:46,090 --> 00:45:52,630
because I people say okay I will<font color="#CCCCCC"> just</font>

764
00:45:49,210 --> 00:45:54,700
take a look at all<font color="#E5E5E5"> the i dunno autoruns</font>

765
00:45:52,630 --> 00:45:57,040
by example which is installed<font color="#E5E5E5"> on the</font>

766
00:45:54,700 --> 00:46:00,549
operating system and<font color="#E5E5E5"> just look at those</font>

767
00:45:57,040 --> 00:46:02,860
which is not signed but yes look also at

768
00:46:00,550 --> 00:46:05,200
a dose which is sign because if you have

769
00:46:02,860 --> 00:46:07,930
a debugger on your torrents it may be a

770
00:46:05,200 --> 00:46:11,080
problem you have to<font color="#E5E5E5"> look for</font><font color="#CCCCCC"> dumpling</font>

771
00:46:07,930 --> 00:46:13,750
activities and<font color="#CCCCCC"> Microsoft don't provide</font>

772
00:46:11,080 --> 00:46:16,500
something to do<font color="#CCCCCC"> that you have to code it</font>

773
00:46:13,750 --> 00:46:20,320
yourself I did it it's not on my get up

774
00:46:16,500 --> 00:46:25,090
yet but<font color="#E5E5E5"> maybe I will it's really simple</font>

775
00:46:20,320 --> 00:46:29,530
you have to try to<font color="#E5E5E5"> deter to detect if</font>

776
00:46:25,090 --> 00:46:33,490
something is being to attack not to<font color="#CCCCCC"> tune</font>

777
00:46:29,530 --> 00:46:36,940
to<font color="#E5E5E5"> suspend okay the process because when</font>

778
00:46:33,490 --> 00:46:40,270
you try to dump a process you will see

779
00:46:36,940 --> 00:46:42,280
very very quick suspend<font color="#E5E5E5"> state on this</font>

780
00:46:40,270 --> 00:46:44,680
process so if you are able to<font color="#E5E5E5"> detect</font>

781
00:46:42,280 --> 00:46:49,750
that a process is suspended its not very

782
00:46:44,680 --> 00:46:52,839
normal on something like else's you have

783
00:46:49,750 --> 00:46:55,630
to look for bcdedit<font color="#CCCCCC"> dirty</font><font color="#E5E5E5"> use while</font>

784
00:46:52,840 --> 00:46:57,520
because it these tools which is tools

785
00:46:55,630 --> 00:47:01,630
Microsoft tools and it which is

786
00:46:57,520 --> 00:47:04,390
installed on<font color="#E5E5E5"> your computer is a low and</font>

787
00:47:01,630 --> 00:47:06,220
not a cure if the computer is not

788
00:47:04,390 --> 00:47:09,160
protected by<font color="#E5E5E5"> bios or something like that</font>

789
00:47:06,220 --> 00:47:12,129
to launch your<font color="#E5E5E5"> computer's next time in</font>

790
00:47:09,160 --> 00:47:17,109
kernel mode and a way to detect if your

791
00:47:12,130 --> 00:47:20,170
computer is in kernel mode is to try to

792
00:47:17,110 --> 00:47:24,130
take a screen another yes a screenshot

793
00:47:20,170 --> 00:47:26,830
if you do<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> will provoke a break</font>

794
00:47:24,130 --> 00:47:31,350
you know in<font color="#CCCCCC"> the in the kernel so it will</font>

795
00:47:26,830 --> 00:47:33,880
<font color="#CCCCCC">just do something</font><font color="#E5E5E5"> like like that</font>

796
00:47:31,350 --> 00:47:37,960
don't resident point it's<font color="#CCCCCC"> not new and</font>

797
00:47:33,880 --> 00:47:40,570
look for behavior and yes<font color="#CCCCCC"> I walk at</font>

798
00:47:37,960 --> 00:47:44,200
deloitte I don't know if I already did

799
00:47:40,570 --> 00:47:46,660
say that but we have a methodology so

800
00:47:44,200 --> 00:47:50,410
being secure of vision<font color="#E5E5E5"> and resilient and</font>

801
00:47:46,660 --> 00:47:53,830
the major point is first thing is you f

802
00:47:50,410 --> 00:47:57,399
to know your crown jewels and<font color="#E5E5E5"> it's to</font>

803
00:47:53,830 --> 00:48:00,520
you not to link with a behavior so if

804
00:47:57,400 --> 00:48:03,580
you know what are your crown jewels you

805
00:48:00,520 --> 00:48:06,759
<font color="#E5E5E5">will be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> protect this this</font>

806
00:48:03,580 --> 00:48:09,370
information and you have<font color="#E5E5E5"> different</font><font color="#CCCCCC"> steps</font>

807
00:48:06,760 --> 00:48:14,050
that you could read and on this slide

808
00:48:09,370 --> 00:48:16,870
and that you can<font color="#E5E5E5"> read after you we do</font>

809
00:48:14,050 --> 00:48:19,660
actually a lot of things<font color="#E5E5E5"> so we make red</font>

810
00:48:16,870 --> 00:48:24,460
team we may compromise assessment and

811
00:48:19,660 --> 00:48:26,529
and we also do things like architecture

812
00:48:24,460 --> 00:48:31,030
on and so all the you know all the loop

813
00:48:26,530 --> 00:48:33,760
is is take in account and yes something

814
00:48:31,030 --> 00:48:36,100
that we said a lot is you will if you

815
00:48:33,760 --> 00:48:39,190
have a<font color="#E5E5E5"> company you will be hacked the</font>

816
00:48:36,100 --> 00:48:41,980
goal is not to avoid all the attacks but

817
00:48:39,190 --> 00:48:44,980
to be able to respond to that<font color="#E5E5E5"> so maybe</font>

818
00:48:41,980 --> 00:48:47,650
add I don't know an insular my sponge

819
00:48:44,980 --> 00:48:49,900
programming to develop<font color="#CCCCCC"> into your company</font>

820
00:48:47,650 --> 00:48:55,290
and<font color="#E5E5E5"> if you don't have</font><font color="#CCCCCC"> that you you you</font>

821
00:48:49,900 --> 00:48:59,500
you need maybe to to to<font color="#E5E5E5"> put it in place</font>

822
00:48:55,290 --> 00:49:02,020
<font color="#CCCCCC">also sing the summary so primary level</font>

823
00:48:59,500 --> 00:49:05,500
special and<font color="#E5E5E5"> assign Microsoft debugger to</font>

824
00:49:02,020 --> 00:49:07,720
help Microsoft operating system it's

825
00:49:05,500 --> 00:49:11,650
<font color="#E5E5E5">difficult to detect because it just</font>

826
00:49:07,720 --> 00:49:13,600
<font color="#CCCCCC">sends texts and bites to the debugger so</font>

827
00:49:11,650 --> 00:49:15,610
if you look<font color="#E5E5E5"> at</font><font color="#CCCCCC"> the activity it's not</font>

828
00:49:13,600 --> 00:49:20,440
very obvious you know to detect our it

829
00:49:15,610 --> 00:49:23,320
just sent 01 and then it just<font color="#E5E5E5"> send a</font><font color="#CCCCCC"> F I</font>

830
00:49:20,440 --> 00:49:26,590
<font color="#E5E5E5">don't know so you know if you see that</font>

831
00:49:23,320 --> 00:49:31,540
it won't be very easy to detect you can

832
00:49:26,590 --> 00:49:33,730
also recon<font color="#CCCCCC"> ricker make reconnaissance to</font>

833
00:49:31,540 --> 00:49:37,779
recognizance I don't know what this is

834
00:49:33,730 --> 00:49:42,640
that of an<font color="#E5E5E5"> active directory domain</font>

835
00:49:37,780 --> 00:49:45,040
and you can also try to escalate another

836
00:49:42,640 --> 00:49:47,339
workstation<font color="#E5E5E5"> and input thank you very</font>

837
00:49:45,040 --> 00:49:47,340
much

