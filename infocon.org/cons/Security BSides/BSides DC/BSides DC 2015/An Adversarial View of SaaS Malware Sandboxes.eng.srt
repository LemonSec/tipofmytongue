1
00:00:00,000 --> 00:00:03,449
good afternoon so I hope you are talking

2
00:00:03,449 --> 00:00:06,420
editor of view of our staff members ten

3
00:00:06,420 --> 00:00:09,150
boxes to go are we so Monica Jaison

4
00:00:09,150 --> 00:00:11,190
throws begin for research and for

5
00:00:11,190 --> 00:00:13,500
upstream Orton security for more than

6
00:00:13,500 --> 00:00:15,750
the past ten years here's a few twists

7
00:00:15,750 --> 00:00:18,720
air works india he moves out in Game

8
00:00:18,720 --> 00:00:21,240
adversity my background is mainly for

9
00:00:21,240 --> 00:00:23,910
data analytics security research

10
00:00:23,910 --> 00:00:32,299
associate and I marinche are from sir

11
00:00:47,089 --> 00:01:03,679
to creating this is a little better so

12
00:01:03,679 --> 00:01:06,420
when we were doing this our motivation

13
00:01:06,420 --> 00:01:08,940
was we kept hearing a lot of different

14
00:01:08,940 --> 00:01:10,649
things about malware and I'll sandbox

15
00:01:10,649 --> 00:01:12,420
don't work we heard that earlier today

16
00:01:12,420 --> 00:01:15,240
in this room actually so we don't have

17
00:01:15,240 --> 00:01:16,350
to take a look at some of those things

18
00:01:16,350 --> 00:01:19,259
one of those is that 80's that we want

19
00:01:19,259 --> 00:01:21,479
to see well what happens with a what

20
00:01:21,479 --> 00:01:23,909
happens ways submit a sample to a whole

21
00:01:23,909 --> 00:01:25,200
bunch of these different maybe that is

22
00:01:25,200 --> 00:01:29,280
what goes over there we also put yours

23
00:01:29,280 --> 00:01:31,649
tower biggest minutes several spin to

24
00:01:31,649 --> 00:01:33,000
the sandbox isn't data that is generated

25
00:01:33,000 --> 00:01:35,550
from it propagates through threaded tony

26
00:01:35,550 --> 00:01:37,290
speeds and also our data sharing program

27
00:01:37,290 --> 00:01:40,500
so how the sample share ours the

28
00:01:40,500 --> 00:01:41,969
diminished generated how they probably

29
00:01:41,969 --> 00:01:46,320
22 others rotation speeds next thing

30
00:01:46,320 --> 00:01:47,280
you're interested in this operation

31
00:01:47,280 --> 00:01:48,899
security solution to files to these

32
00:01:48,899 --> 00:01:51,140
places are you going to buff the episode

33
00:01:51,140 --> 00:01:53,579
what are they going to see what are they

34
00:01:53,579 --> 00:01:55,320
going to know what time are they going

35
00:01:55,320 --> 00:02:00,420
to know that's what we also kept and

36
00:02:00,420 --> 00:02:02,850
whenever I look at a lot of examples you

37
00:02:02,850 --> 00:02:05,250
keep seeing malware that employees these

38
00:02:05,250 --> 00:02:06,520
new methods

39
00:02:06,520 --> 00:02:10,720
to detect the sandbox is at the ryman we

40
00:02:10,720 --> 00:02:13,920
wanted to see if that worked and how

41
00:02:13,920 --> 00:02:16,180
advanced you have to be to actually

42
00:02:16,180 --> 00:02:18,280
detect the different sandboxes that

43
00:02:18,280 --> 00:02:20,050
people are using at least in commercial

44
00:02:20,050 --> 00:02:25,870
rain-free implementations of those so

45
00:02:25,870 --> 00:02:29,110
with our experiment we created a sensor

46
00:02:29,110 --> 00:02:32,650
and we created a couple versions of that

47
00:02:32,650 --> 00:02:35,890
sensor and submit it to different

48
00:02:35,890 --> 00:02:38,769
sandboxes on the server side we just

49
00:02:38,769 --> 00:02:41,920
gonna HTTP tornado app and bind dns

50
00:02:41,920 --> 00:02:45,370
servers and we included the execution

51
00:02:45,370 --> 00:02:48,610
time in the delay mean that hooked up as

52
00:02:48,610 --> 00:02:52,150
well as the campaign ID so we could

53
00:02:52,150 --> 00:02:55,720
track which sandbox we submitted to we

54
00:02:55,720 --> 00:02:58,989
spit into 29 different sandboxes well 29

55
00:02:58,989 --> 00:03:00,310
different samples to 29 different

56
00:03:00,310 --> 00:03:03,069
animals San glasses and then they watch

57
00:03:03,069 --> 00:03:07,569
the travel to go vacuum we these are

58
00:03:07,569 --> 00:03:09,959
some of the snail us as we submit to

59
00:03:09,959 --> 00:03:13,030
they may include our own sandbox because

60
00:03:13,030 --> 00:03:15,940
we want to see what happened when we ran

61
00:03:15,940 --> 00:03:24,160
things with our configuration with our

62
00:03:24,160 --> 00:03:25,690
sensor this is some of the information

63
00:03:25,690 --> 00:03:29,930
we brought back and we

64
00:03:29,930 --> 00:03:32,989
we just enumerate the host we take a

65
00:03:32,989 --> 00:03:35,060
look at the socket base we use scientist

66
00:03:35,060 --> 00:03:36,920
communications instead of when I met so

67
00:03:36,920 --> 00:03:37,969
there wouldn't be an indexed I've

68
00:03:37,969 --> 00:03:40,760
attitude we created a monkey and we

69
00:03:40,760 --> 00:03:43,670
deleted lucky and we did that because we

70
00:03:43,670 --> 00:03:46,310
wanted to see the validity of the

71
00:03:46,310 --> 00:03:48,019
results that the sand boxes were

72
00:03:48,019 --> 00:03:50,450
returning people to see if they were

73
00:03:50,450 --> 00:03:52,189
monitoring everything or they were just

74
00:03:52,189 --> 00:03:54,109
doing a snapshot before and after and

75
00:03:54,109 --> 00:03:58,489
comparing and then we exited the process

76
00:03:58,489 --> 00:04:00,260
there wasn't any remote access

77
00:04:00,260 --> 00:04:02,510
capability it didn't allow them to

78
00:04:02,510 --> 00:04:04,220
download any files that didn't allow you

79
00:04:04,220 --> 00:04:06,260
to have a reverse shell anything like

80
00:04:06,260 --> 00:04:09,680
that just be clear nothing that are such

81
00:04:09,680 --> 00:04:11,239
a dick was malicious in any way so it's

82
00:04:11,239 --> 00:04:12,739
just a new merging the host and the

83
00:04:12,739 --> 00:04:14,419
communicating details about those back

84
00:04:14,419 --> 00:04:16,910
to us for research purposes so just

85
00:04:16,910 --> 00:04:19,070
morally clear using the details to

86
00:04:19,070 --> 00:04:22,310
remember CPUs username process list

87
00:04:22,310 --> 00:04:24,860
currently running processes they've had

88
00:04:24,860 --> 00:04:27,259
a ram on the machine the machines local

89
00:04:27,259 --> 00:04:29,539
IP address the machine is hosting the

90
00:04:29,539 --> 00:04:31,849
hard drives sorry all the drives hard

91
00:04:31,849 --> 00:04:35,150
drives removable details of alba details

92
00:04:35,150 --> 00:04:37,550
about the bios and so literally this is

93
00:04:37,550 --> 00:04:38,930
all this sort of data we collected

94
00:04:38,930 --> 00:04:41,020
really the goal kind of identifying

95
00:04:41,020 --> 00:04:43,520
features of malware sandboxes name or

96
00:04:43,520 --> 00:04:46,310
fingerprint of all just to do for the

97
00:04:46,310 --> 00:04:51,289
research when we were building this we

98
00:04:51,289 --> 00:04:53,090
wanted to make it kind of look like

99
00:04:53,090 --> 00:04:55,820
malware them and we tried to make it

100
00:04:55,820 --> 00:04:58,250
look like 18 hours as much as possible a

101
00:04:58,250 --> 00:04:59,500
lot of 18 hour

102
00:04:59,500 --> 00:05:01,420
what cat does a lot of that host

103
00:05:01,420 --> 00:05:05,260
enumeration that lead and we also took a

104
00:05:05,260 --> 00:05:08,950
sample of our from a family called Wi-Fi

105
00:05:08,950 --> 00:05:13,960
if their entire and we model our HTTP

106
00:05:13,960 --> 00:05:15,700
communications after them this is the

107
00:05:15,700 --> 00:05:18,400
wmi communications of musa cisco packet

108
00:05:18,400 --> 00:05:22,740
bracket there and puts faces before

109
00:05:22,740 --> 00:05:26,190
encoded zealand compressed data and then

110
00:05:26,190 --> 00:05:30,700
this was an hour HTTP job which was

111
00:05:30,700 --> 00:05:32,290
seeing the compressed and business

112
00:05:32,290 --> 00:05:34,300
people are coated inside of a packet

113
00:05:34,300 --> 00:05:38,320
captures that worked pretty well but we

114
00:05:38,320 --> 00:05:40,300
evolve our sample to do a little bit

115
00:05:40,300 --> 00:05:43,540
more so as we go through this research

116
00:05:43,540 --> 00:05:45,400
we spent our first time around with

117
00:05:45,400 --> 00:05:46,330
samples to do all these different

118
00:05:46,330 --> 00:05:49,050
sandbox as we noticed quite a few of the

119
00:05:49,050 --> 00:05:51,580
samples were getting executed where we

120
00:05:51,580 --> 00:05:53,800
weren't seeing HTTP requests so all

121
00:05:53,800 --> 00:05:56,919
we're seeing is TS about we figure a

122
00:05:56,919 --> 00:05:58,300
bunch of these numbers have obstacle

123
00:05:58,300 --> 00:06:00,430
walkie TCP connections so when that

124
00:06:00,430 --> 00:06:01,960
happened all we can see is it means of

125
00:06:01,960 --> 00:06:03,310
execution that we could not see

126
00:06:03,310 --> 00:06:06,250
Oh sandbox environment so one of the

127
00:06:06,250 --> 00:06:08,820
goals was to see if we get determined

128
00:06:08,820 --> 00:06:11,080
really it as widespread as possible

129
00:06:11,080 --> 00:06:12,940
those details so the next thing that we

130
00:06:12,940 --> 00:06:14,770
did we evolve our sensor when I did a

131
00:06:14,770 --> 00:06:19,450
very simple dns curtail so same sort of

132
00:06:19,450 --> 00:06:21,190
things before we see live compressed all

133
00:06:21,190 --> 00:06:23,290
the data were sent back we hexic go to

134
00:06:23,290 --> 00:06:26,050
that we split across displayed across

135
00:06:26,050 --> 00:06:28,540
chunks of gina's packets really just

136
00:06:28,540 --> 00:06:31,240
doing simple multiple DSD record it

137
00:06:31,240 --> 00:06:33,160
requests and then capturing all that

138
00:06:33,160 --> 00:06:38,370
data on the wrong side and then decoding

139
00:06:40,140 --> 00:06:42,910
so everyone keeps saying that a tease

140
00:06:42,910 --> 00:06:44,530
then you're not going to get any good

141
00:06:44,530 --> 00:06:48,760
detection from this when we first met

142
00:06:48,760 --> 00:06:52,210
our sample was that is true in getting

143
00:06:52,210 --> 00:06:54,550
all of our samples were shown as being

144
00:06:54,550 --> 00:06:56,920
completely benign we have a pseudo anti

145
00:06:56,920 --> 00:07:00,010
virus infections which kind of we should

146
00:07:00,010 --> 00:07:04,480
have since it's not really number but

147
00:07:04,480 --> 00:07:08,350
over time over a lot of a month later by

148
00:07:08,350 --> 00:07:10,000
this code will end up with six of our

149
00:07:10,000 --> 00:07:11,620
samples I have been submitted to other

150
00:07:11,620 --> 00:07:15,370
states and glasses and our anti virus

151
00:07:15,370 --> 00:07:17,650
detection range from eight out of 57

152
00:07:17,650 --> 00:07:21,280
engines to 30 level 57 inches most of

153
00:07:21,280 --> 00:07:24,430
them noted are growler no dollars sensor

154
00:07:24,430 --> 00:07:28,540
is being Zeus or after and one of the

155
00:07:28,540 --> 00:07:30,700
other interesting pieces of it was that

156
00:07:30,700 --> 00:07:34,690
as time went on the amount of a the

157
00:07:34,690 --> 00:07:41,740
engines noting as malicious increased so

158
00:07:41,740 --> 00:07:44,080
kind of part of this research goal was

159
00:07:44,080 --> 00:07:45,640
to figure out how information properties

160
00:07:45,640 --> 00:07:47,560
from these malware sandbox is really

161
00:07:47,560 --> 00:07:48,940
through research community

162
00:07:48,940 --> 00:07:52,060
so first question is sharing about me I

163
00:07:52,060 --> 00:07:53,680
think everyone kind of knows that that

164
00:07:53,680 --> 00:07:55,540
happens to the answer to that is yes

165
00:07:55,540 --> 00:07:58,750
actually quite a bit of sharing so we

166
00:07:58,750 --> 00:08:02,320
found because each sample submitted to

167
00:08:02,320 --> 00:08:03,520
eat it miss different same boxes with

168
00:08:03,520 --> 00:08:06,430
unique and added so many campaign ID we

169
00:08:06,430 --> 00:08:07,990
could track where we submit the sample

170
00:08:07,990 --> 00:08:10,600
here with ABC got executed here here

171
00:08:10,600 --> 00:08:15,430
here here over time so some places we

172
00:08:15,430 --> 00:08:17,470
found propagate a sample to rule out of

173
00:08:17,470 --> 00:08:19,660
town of the places also execute the

174
00:08:19,660 --> 00:08:21,510
sample so when that sample gets executed

175
00:08:21,510 --> 00:08:23,650
generates a ton of network traffic you

176
00:08:23,650 --> 00:08:24,730
can see the vantage points for the

177
00:08:24,730 --> 00:08:27,880
network traffic in front if they do HTTP

178
00:08:27,880 --> 00:08:29,700
request you can see the source IP of

179
00:08:29,700 --> 00:08:32,860
there where he came from so we can see

180
00:08:32,860 --> 00:08:36,370
the dns server and course I TV from all

181
00:08:36,370 --> 00:08:38,409
these different locations allowing these

182
00:08:38,409 --> 00:08:40,330
places also i would say at least

183
00:08:40,330 --> 00:08:42,450
prepared for operational security a

184
00:08:42,450 --> 00:08:44,980
we're doing it from their own corporate

185
00:08:44,980 --> 00:08:47,200
network every major TV company was

186
00:08:47,200 --> 00:08:49,870
representative in these our logs so this

187
00:08:49,870 --> 00:08:51,670
kind of goes to show you a little sample

188
00:08:51,670 --> 00:08:55,180
to most of these sandbox servers or

189
00:08:55,180 --> 00:08:57,460
services and data will give up

190
00:08:57,460 --> 00:08:59,320
interviewee companies you lose complete

191
00:08:59,320 --> 00:09:01,360
control over it they will execute it and

192
00:09:01,360 --> 00:09:04,720
likely to a lot more the other ones we

193
00:09:04,720 --> 00:09:07,120
found because may go the campaign ID and

194
00:09:07,120 --> 00:09:08,710
the time step of execution in the domain

195
00:09:08,710 --> 00:09:12,339
name we would see samples good attitude

196
00:09:12,339 --> 00:09:13,839
the initials can watch this video too

197
00:09:13,839 --> 00:09:15,670
and then over the course of weeks and

198
00:09:15,670 --> 00:09:17,949
days later we see Tina's resolutions

199
00:09:17,949 --> 00:09:20,410
coming into the same exact convenience

200
00:09:20,410 --> 00:09:23,439
which we knew or not from New executions

201
00:09:23,439 --> 00:09:25,209
they were for executions with Yuka trace

202
00:09:25,209 --> 00:09:28,540
rap we could also see how it's good to

203
00:09:28,540 --> 00:09:31,329
share these domains is going off and

204
00:09:31,329 --> 00:09:33,220
ultimately some of the domains mounted

205
00:09:33,220 --> 00:09:34,449
on threatens August list which we

206
00:09:34,449 --> 00:09:35,559
thought was really interesting because

207
00:09:35,559 --> 00:09:37,930
this is not my work doesn't do anything

208
00:09:37,930 --> 00:09:39,759
religious it wasn't reported from a

209
00:09:39,759 --> 00:09:41,550
customer we uploaded as researchers

210
00:09:41,550 --> 00:09:43,660
propagated through the network security

211
00:09:43,660 --> 00:09:46,779
researchers and envious of their

212
00:09:46,779 --> 00:09:48,879
intelligent students the other thing we

213
00:09:48,879 --> 00:09:52,059
saw a lot of the origins of the

214
00:09:52,059 --> 00:09:54,399
traffic's with direct connections to RC

215
00:09:54,399 --> 00:09:56,980
to server and dns resolutions came

216
00:09:56,980 --> 00:09:58,420
directly from the program networks of

217
00:09:58,420 --> 00:10:00,610
lead rabies as well as several several

218
00:10:00,610 --> 00:10:04,240
security product companies so just to

219
00:10:04,240 --> 00:10:06,069
reiterate you stupid snow samples your

220
00:10:06,069 --> 00:10:08,110
money sandboxes you lose complete

221
00:10:08,110 --> 00:10:10,569
control over it tip-off will be tipping

222
00:10:10,569 --> 00:10:11,860
off the episode where it show a lot more

223
00:10:11,860 --> 00:10:15,759
detail slides to accuse the domains that

224
00:10:15,759 --> 00:10:17,529
brought up with a dry toilets piece of

225
00:10:17,529 --> 00:10:20,079
just three of the feet that we have

226
00:10:20,079 --> 00:10:21,999
access to which we thought this was kind

227
00:10:21,999 --> 00:10:23,649
of interesting so this is just a

228
00:10:23,649 --> 00:10:26,589
timeline of events first remaining first

229
00:10:26,589 --> 00:10:30,160
he has a resolution observed soon after

230
00:10:30,160 --> 00:10:32,230
t HTTP requests that's just a few

231
00:10:32,230 --> 00:10:34,059
seconds apart and then the following day

232
00:10:34,059 --> 00:10:37,059
ones that one two three insurgency very

233
00:10:37,059 --> 00:10:40,029
similar the next one's TS resolution

234
00:10:40,029 --> 00:10:42,100
observed add into threaded talking to be

235
00:10:42,100 --> 00:10:44,860
in later on bch the request which this

236
00:10:44,860 --> 00:10:48,550
is a little curious so they're two hours

237
00:10:48,550 --> 00:10:50,290
later with somebody HTTP requests a

238
00:10:50,290 --> 00:10:53,009
secret is not not sure if they are

239
00:10:53,009 --> 00:10:55,230
buffering or blocking these http

240
00:10:55,230 --> 00:10:58,410
later or in very very much delay system

241
00:10:58,410 --> 00:11:00,630
but we thought that was interesting and

242
00:11:00,630 --> 00:11:03,860
then similar batter for the last night

243
00:11:03,860 --> 00:11:07,380
so one other thing we did was you're

244
00:11:07,380 --> 00:11:08,610
taking a look at all the sandbox Eyed

245
00:11:08,610 --> 00:11:10,560
Peas and this was just out of curiosity

246
00:11:10,560 --> 00:11:12,360
be had we have tons of foreign

247
00:11:12,360 --> 00:11:13,770
intelligence data and then we have the

248
00:11:13,770 --> 00:11:15,180
sandbox and he's interacting with other

249
00:11:15,180 --> 00:11:17,130
system three just for curious if you

250
00:11:17,130 --> 00:11:18,570
take the sandbox eyed peas and look it

251
00:11:18,570 --> 00:11:20,400
up with our intelligence databases what

252
00:11:20,400 --> 00:11:23,160
God what comes out of it so all the same

253
00:11:23,160 --> 00:11:25,140
box at ease that made a valid post so

254
00:11:25,140 --> 00:11:26,880
this is this means they're actually

255
00:11:26,880 --> 00:11:29,750
allowing HTTP TCP connections how about

256
00:11:29,750 --> 00:11:32,130
15 then we're also identifying some of

257
00:11:32,130 --> 00:11:35,640
their intelligence these six of them

258
00:11:35,640 --> 00:11:37,050
were from tour so this shows us some of

259
00:11:37,050 --> 00:11:38,610
the sandbox winters actually writing

260
00:11:38,610 --> 00:11:41,210
this down to tour that's not a bad idea

261
00:11:41,210 --> 00:11:43,230
encourage your trash loaded if you're

262
00:11:43,230 --> 00:11:44,580
writing this and if your corporate

263
00:11:44,580 --> 00:11:46,770
network you would identify you one was

264
00:11:46,770 --> 00:11:48,420
an anonymous proxy also probably not a

265
00:11:48,420 --> 00:11:52,470
bad idea ice cream or all the others

266
00:11:52,470 --> 00:11:54,360
were kind of interesting because because

267
00:11:54,360 --> 00:11:57,270
they save us allow about TCP connections

268
00:11:57,270 --> 00:12:00,000
there's avenues for reviews so of all

269
00:12:00,000 --> 00:12:02,070
the other like he's identified their did

270
00:12:02,070 --> 00:12:05,100
find oddities so this is a lot of times

271
00:12:05,100 --> 00:12:06,120
means they connected to someones

272
00:12:06,120 --> 00:12:08,750
sinkhole which is not surprising on our

273
00:12:08,750 --> 00:12:11,250
does it teenis resolution for Lucius

274
00:12:11,250 --> 00:12:12,690
domain that's been single by researcher

275
00:12:12,690 --> 00:12:15,690
that I keep the next a mystical so that

276
00:12:15,690 --> 00:12:18,480
makes sense spam IDs sort of thing and

277
00:12:18,480 --> 00:12:21,030
whatnot bounty skechers go some of that

278
00:12:21,030 --> 00:12:22,710
span was out they thought that they get

279
00:12:22,710 --> 00:12:25,110
out into a list resourceid sting at

280
00:12:25,110 --> 00:12:28,560
least very similar nature and the last

281
00:12:28,560 --> 00:12:30,060
thing is he's one of interesting served

282
00:12:30,060 --> 00:12:32,430
to Old River was compromised ip's so one

283
00:12:32,430 --> 00:12:34,770
of them showed it was a victim in a

284
00:12:34,770 --> 00:12:37,530
hockey logger.log not surprising but

285
00:12:37,530 --> 00:12:43,530
interesting convos so as far as a

286
00:12:43,530 --> 00:12:46,890
timeline of activity here we first

287
00:12:46,890 --> 00:12:50,370
submitted this up on Friday and a lot of

288
00:12:50,370 --> 00:12:52,950
places made DNS connections to us and

289
00:12:52,950 --> 00:12:56,190
then just a few of us a RCT server the

290
00:12:56,190 --> 00:12:59,010
more interesting thing was on the Monday

291
00:12:59,010 --> 00:13:00,960
morning it seemed that everybody had

292
00:13:00,960 --> 00:13:03,420
their roles uploaded stars fell over

293
00:13:03,420 --> 00:13:06,390
something and all of a sudden we had a

294
00:13:06,390 --> 00:13:09,990
large amount of HTTP request to our to

295
00:13:09,990 --> 00:13:13,730
our HTTP server the second submission

296
00:13:13,730 --> 00:13:16,620
about what was I think maybe a month

297
00:13:16,620 --> 00:13:20,850
later we received a lot of the answer

298
00:13:20,850 --> 00:13:22,710
request again but that made sense

299
00:13:22,710 --> 00:13:24,930
because we were using the GSC to it

300
00:13:24,930 --> 00:13:31,140
doesn't have time for your car one of

301
00:13:31,140 --> 00:13:33,600
the other interesting things America

302
00:13:33,600 --> 00:13:35,940
rember in the middle of the week then

303
00:13:35,940 --> 00:13:37,740
the second league we started to get a

304
00:13:37,740 --> 00:13:41,490
lot more DNS resolutions we don't really

305
00:13:41,490 --> 00:13:43,620
know the I that occurred maybe it was

306
00:13:43,620 --> 00:13:46,170
that this information having uploaded to

307
00:13:46,170 --> 00:13:49,620
those portals and people were resolve

308
00:13:49,620 --> 00:13:51,480
those and try to scrape those

309
00:13:51,480 --> 00:13:54,180
see two different sandbox books on that

310
00:13:54,180 --> 00:13:56,730
point but we received a lot more traffic

311
00:13:56,730 --> 00:14:00,389
during that time period but one of the

312
00:14:00,389 --> 00:14:04,040
most interesting things occurred on the

313
00:14:04,040 --> 00:14:08,190
twenty-fifth of August during that time

314
00:14:08,190 --> 00:14:11,339
period there was a handful of IP ban shy

315
00:14:11,339 --> 00:14:14,160
keys that started hitting our HTTP

316
00:14:14,160 --> 00:14:16,889
server and they were really obviously

317
00:14:16,889 --> 00:14:19,790
trying to enumerate vulnerabilities and

318
00:14:19,790 --> 00:14:23,550
directories on my service and I think

319
00:14:23,550 --> 00:14:25,139
our server would respond to anything

320
00:14:25,139 --> 00:14:28,500
correct yeah so it was headed kissing to

321
00:14:28,500 --> 00:14:35,100
see that one of the other features that

322
00:14:35,100 --> 00:14:38,430
we wanted to enumerate here was based

323
00:14:38,430 --> 00:14:43,260
upon all of the reporting of malware

324
00:14:43,260 --> 00:14:45,560
detected sandboxes with these different

325
00:14:45,560 --> 00:14:48,389
advanced techniques one of those

326
00:14:48,389 --> 00:14:50,910
advanced techniques obfuscating oficio

327
00:14:50,910 --> 00:14:54,839
boxes or is it much easier to vanilla at

328
00:14:54,839 --> 00:15:00,209
the different sandboxes so you know

329
00:15:00,209 --> 00:15:01,529
later and said whatever those was also

330
00:15:01,529 --> 00:15:03,149
see can be finger with the sandbox is it

331
00:15:03,149 --> 00:15:05,250
powers is do you need some of the more

332
00:15:05,250 --> 00:15:06,389
advanced techniques that have talked

333
00:15:06,389 --> 00:15:08,190
about it I have that activated security

334
00:15:08,190 --> 00:15:11,100
research literature so that's when we

335
00:15:11,100 --> 00:15:13,350
flex well my data mentioned earlier so

336
00:15:13,350 --> 00:15:15,300
this is just kind of listening some of

337
00:15:15,300 --> 00:15:18,720
this up when we found and two runs on

338
00:15:18,720 --> 00:15:22,079
three sort of system process this a lot

339
00:15:22,079 --> 00:15:23,819
of times they said these mailboxes run

340
00:15:23,819 --> 00:15:26,050
over be aware that's not surprising

341
00:15:26,050 --> 00:15:28,000
that's not dead giveaway with our

342
00:15:28,000 --> 00:15:30,130
sandbox but it can be an indication I

343
00:15:30,130 --> 00:15:31,899
know a lot of devices are looking to

344
00:15:31,899 --> 00:15:34,810
using advertised oh so you can't just

345
00:15:34,810 --> 00:15:36,459
rely on us but we take def they see a

346
00:15:36,459 --> 00:15:39,339
lot of this this research the mac

347
00:15:39,339 --> 00:15:40,899
address seems we're going to take the

348
00:15:40,899 --> 00:15:43,000
mac address look if it's a pretty wife

349
00:15:43,000 --> 00:15:44,860
around bleeding just looking to see what

350
00:15:44,860 --> 00:15:46,810
the interim a city TMR does the most

351
00:15:46,810 --> 00:15:49,570
representative system we found so long

352
00:15:49,570 --> 00:15:50,769
as in our sandbox is also not

353
00:15:50,769 --> 00:15:53,560
surprisingly music there are a few

354
00:15:53,560 --> 00:15:58,089
others that were can also show up in

355
00:15:58,089 --> 00:15:59,380
some of these actually look like they're

356
00:15:59,380 --> 00:16:00,790
trying to cover their tracks money would

357
00:16:00,790 --> 00:16:05,860
like it wasn't super fly system going

358
00:16:05,860 --> 00:16:08,500
down with violence seems to be more the

359
00:16:08,500 --> 00:16:11,410
most popular boxing gym you were kind of

360
00:16:11,410 --> 00:16:12,790
interesting as they both personalization

361
00:16:12,790 --> 00:16:16,899
remarks you're both extremely probably

362
00:16:16,899 --> 00:16:19,930
used elisa universal so these are start

363
00:16:19,930 --> 00:16:22,740
to kind of get you closer to tell you

364
00:16:22,740 --> 00:16:27,100
this is probably a sandbox disk size

365
00:16:27,100 --> 00:16:29,709
same sort of thing how many people do

366
00:16:29,709 --> 00:16:31,480
you know have a 20 gig hard drive on

367
00:16:31,480 --> 00:16:33,670
their machine I'd say probably not very

368
00:16:33,670 --> 00:16:35,740
many unless you're running a tablet we

369
00:16:35,740 --> 00:16:37,480
did some market research and you can

370
00:16:37,480 --> 00:16:38,860
still buy machines with small hard

371
00:16:38,860 --> 00:16:40,029
drives but they're almost all tablets

372
00:16:40,029 --> 00:16:42,370
the smallest that I could find was 32

373
00:16:42,370 --> 00:16:44,829
gig so all these you know very small

374
00:16:44,829 --> 00:16:46,870
hard drives our client are likely to be

375
00:16:46,870 --> 00:16:47,980
pretty anomalous in an enterprise

376
00:16:47,980 --> 00:16:50,140
setting so if you know bad guys are

377
00:16:50,140 --> 00:16:53,260
submitting samples or bad guys are key

378
00:16:53,260 --> 00:16:55,089
if they key in on your disk size in the

379
00:16:55,089 --> 00:16:56,890
machine this could be an indication that

380
00:16:56,890 --> 00:16:58,410
you're owning in the sandbox I

381
00:16:58,410 --> 00:17:00,610
especially taken with any with this

382
00:17:00,610 --> 00:17:02,760
other criteria that we're talking about

383
00:17:02,760 --> 00:17:06,280
Ram same sort of thing 1 gig of ram was

384
00:17:06,280 --> 00:17:08,140
the most popular setting on all these

385
00:17:08,140 --> 00:17:10,660
systems how many enterprise computers do

386
00:17:10,660 --> 00:17:11,919
you know run with just one gig of ram

387
00:17:11,919 --> 00:17:15,699
may be quite a few most systems we've

388
00:17:15,699 --> 00:17:19,000
seen come with two gigs so this is also

389
00:17:19,000 --> 00:17:26,349
kind of telling that's right and then

390
00:17:26,349 --> 00:17:28,419
lastly and this is also another you know

391
00:17:28,419 --> 00:17:30,970
interesting tell was the exe renamed so

392
00:17:30,970 --> 00:17:33,010
how often do you download something and

393
00:17:33,010 --> 00:17:34,630
then rename it to sample that exe

394
00:17:34,630 --> 00:17:37,000
Mallard exe or take the md5 of the

395
00:17:37,000 --> 00:17:37,610
sample

396
00:17:37,610 --> 00:17:39,260
and rename it to that before you run it

397
00:17:39,260 --> 00:17:42,170
so this is as a normal user who likely

398
00:17:42,170 --> 00:17:44,210
that's the target of malware they're not

399
00:17:44,210 --> 00:17:45,679
going to do this researchers are going

400
00:17:45,679 --> 00:17:47,750
to do this this was very very prominent

401
00:17:47,750 --> 00:17:49,760
in almost every sandbox we looked at not

402
00:17:49,760 --> 00:17:51,470
every one of them but most of them so

403
00:17:51,470 --> 00:17:53,270
there's kind of a lot of towels none of

404
00:17:53,270 --> 00:17:55,070
these are sophisticated but taking in

405
00:17:55,070 --> 00:17:56,270
aggregate you can really start to kind

406
00:17:56,270 --> 00:17:59,090
of zero in on is this a you know a

407
00:17:59,090 --> 00:18:03,470
sandbox or is this a user yeah one other

408
00:18:03,470 --> 00:18:05,390
feature was the number of drives

409
00:18:05,390 --> 00:18:07,309
connected you know most virtualized

410
00:18:07,309 --> 00:18:09,890
hosts that people run your citrix your

411
00:18:09,890 --> 00:18:12,710
VP VMware hosts in corporate

412
00:18:12,710 --> 00:18:15,350
environments will have multiple drives

413
00:18:15,350 --> 00:18:18,919
connected to them even if they have that

414
00:18:18,919 --> 00:18:23,390
small fixed disk so in our view all of

415
00:18:23,390 --> 00:18:25,640
the things that malware authors are

416
00:18:25,640 --> 00:18:28,130
doing to try to detect sandboxes are way

417
00:18:28,130 --> 00:18:30,770
too advanced you can detect the sandbox

418
00:18:30,770 --> 00:18:33,230
is much easier than that if you just

419
00:18:33,230 --> 00:18:35,570
look at the CPU count and look for disk

420
00:18:35,570 --> 00:18:38,540
size smaller or equal to 60 gigs and the

421
00:18:38,540 --> 00:18:40,760
other thing was none of the sandboxes

422
00:18:40,760 --> 00:18:43,820
were running a web browser and pretty

423
00:18:43,820 --> 00:18:45,620
much everybody's computer is running a

424
00:18:45,620 --> 00:18:48,440
web browser these days if you just look

425
00:18:48,440 --> 00:18:50,179
for those things you will probably

426
00:18:50,179 --> 00:18:52,730
detect ninety percent of researchers

427
00:18:52,730 --> 00:19:00,350
machines or or sand boxes so one of the

428
00:19:00,350 --> 00:19:01,429
thing I just wanted to kind of key in on

429
00:19:01,429 --> 00:19:02,720
so we thought this is kind of

430
00:19:02,720 --> 00:19:06,980
interesting so the number of sand boxes

431
00:19:06,980 --> 00:19:08,240
were and these are diverse and boxes

432
00:19:08,240 --> 00:19:09,860
these are not the same ones or we

433
00:19:09,860 --> 00:19:11,540
submitted you know across different

434
00:19:11,540 --> 00:19:14,330
campaigns that we did had the same user

435
00:19:14,330 --> 00:19:17,030
names same host names same disk size

436
00:19:17,030 --> 00:19:20,150
same CPU count pretty much are very very

437
00:19:20,150 --> 00:19:23,030
similar across the images so what this

438
00:19:23,030 --> 00:19:25,730
kind of what this tells us is people are

439
00:19:25,730 --> 00:19:27,530
sharing images so they're taking a

440
00:19:27,530 --> 00:19:29,570
winter's image that's identical and

441
00:19:29,570 --> 00:19:31,700
they're just sharing it out so this from

442
00:19:31,700 --> 00:19:33,080
an operational security standpoint is

443
00:19:33,080 --> 00:19:35,030
incredibly bad this basically allows the

444
00:19:35,030 --> 00:19:37,280
bad garden to kind of zero in on what to

445
00:19:37,280 --> 00:19:39,740
look for in my in a sandbox and you can

446
00:19:39,740 --> 00:19:42,740
tell with not a lot of effort what if

447
00:19:42,740 --> 00:19:44,510
you if you to do this sort of like data

448
00:19:44,510 --> 00:19:46,340
collection really what to look for and

449
00:19:46,340 --> 00:19:48,980
how widely propagated these images are

450
00:19:48,980 --> 00:19:51,140
I don't really want to go into too much

451
00:19:51,140 --> 00:19:52,280
detail because we don't want to make a

452
00:19:52,280 --> 00:19:54,440
hell two for how to do that but it's

453
00:19:54,440 --> 00:19:59,210
it's it's pretty bad yeah there were

454
00:19:59,210 --> 00:20:03,440
really only four sandbox images that we

455
00:20:03,440 --> 00:20:06,650
were seeing repeatedly and they were the

456
00:20:06,650 --> 00:20:09,020
same image just over and over and over

457
00:20:09,020 --> 00:20:12,169
again from many different places fairly

458
00:20:12,169 --> 00:20:16,970
interesting so our lessons learned were

459
00:20:16,970 --> 00:20:18,950
that most people are using those Sam

460
00:20:18,950 --> 00:20:22,880
sandbox images and that AV thinks your

461
00:20:22,880 --> 00:20:24,950
file was malicious regardless of its

462
00:20:24,950 --> 00:20:28,100
capability our our sensor didn't have

463
00:20:28,100 --> 00:20:29,990
any remote access capabilities it did

464
00:20:29,990 --> 00:20:32,059
the same thing that a lot of JavaScript

465
00:20:32,059 --> 00:20:36,230
that's on web pages does and we were

466
00:20:36,230 --> 00:20:38,990
marked as malicious especially the more

467
00:20:38,990 --> 00:20:40,760
that they were shared that seemed to be

468
00:20:40,760 --> 00:20:45,549
the key item that they were keying in on

469
00:20:47,080 --> 00:20:50,270
also if someone submits an adversary

470
00:20:50,270 --> 00:20:52,220
sample to a malware sandbox they will be

471
00:20:52,220 --> 00:20:54,350
t they will be tipped off immediately

472
00:20:54,350 --> 00:20:56,570
the other thing is you start to see how

473
00:20:56,570 --> 00:20:58,130
it propagates out to all these different

474
00:20:58,130 --> 00:21:00,080
security companies or using pre poor

475
00:21:00,080 --> 00:21:02,059
operational security doing things

476
00:21:02,059 --> 00:21:04,130
directly from their network directly

477
00:21:04,130 --> 00:21:06,049
connecting to the CT servers from the

478
00:21:06,049 --> 00:21:07,820
network directly doing DNS resolutions

479
00:21:07,820 --> 00:21:10,730
to that network so it definitely tips

480
00:21:10,730 --> 00:21:12,200
off the adversary if the sample gets

481
00:21:12,200 --> 00:21:14,150
uploaded just because of how widely

482
00:21:14,150 --> 00:21:15,679
spread it gets executed how widely

483
00:21:15,679 --> 00:21:17,360
spread the traffic that gets generated

484
00:21:17,360 --> 00:21:18,890
from the systems gets spread and then

485
00:21:18,890 --> 00:21:21,770
resolved through you know dns resolution

486
00:21:21,770 --> 00:21:24,380
systems passive DNS systems those sorts

487
00:21:24,380 --> 00:21:28,549
of things so some of our samples we

488
00:21:28,549 --> 00:21:29,870
submitted I think about a month or two

489
00:21:29,870 --> 00:21:32,630
ago the CTU domains are still being

490
00:21:32,630 --> 00:21:34,820
resolved today so they're still looking

491
00:21:34,820 --> 00:21:37,490
them up so it's it's a dead giveaway so

492
00:21:37,490 --> 00:21:39,500
just something to be mindful of as you

493
00:21:39,500 --> 00:21:42,080
use these systems it's it's basically

494
00:21:42,080 --> 00:21:44,120
tipping tipping your hand if this is a

495
00:21:44,120 --> 00:21:45,950
targeted attack your tipping your hand

496
00:21:45,950 --> 00:21:48,410
not only can they you know look and see

497
00:21:48,410 --> 00:21:49,970
is my is my philo house showing up on

498
00:21:49,970 --> 00:21:51,620
any of these free sites they see the

499
00:21:51,620 --> 00:21:54,340
traffic immediately so keep that in mind

500
00:21:54,340 --> 00:21:57,970
next Santa boxes can be fingerprinted

501
00:21:57,970 --> 00:22:00,830
basically trivially very very simple

502
00:22:00,830 --> 00:22:01,850
techniques you don't need anything

503
00:22:01,850 --> 00:22:02,600
advanced

504
00:22:02,600 --> 00:22:04,160
most of the advanced techniques that we

505
00:22:04,160 --> 00:22:06,260
have we saw were mainly about keying in

506
00:22:06,260 --> 00:22:08,150
on virtualization so is this brownie and

507
00:22:08,150 --> 00:22:11,179
virtualization setting or not that's not

508
00:22:11,179 --> 00:22:14,450
really needed to detect sandboxes so may

509
00:22:14,450 --> 00:22:15,950
or may not be virtualized but it's

510
00:22:15,950 --> 00:22:17,390
likely going to have you know the same

511
00:22:17,390 --> 00:22:20,809
hostname very small disk size very small

512
00:22:20,809 --> 00:22:23,960
RAM size only one cpu you know most CPUs

513
00:22:23,960 --> 00:22:25,789
today have more than one core so it

514
00:22:25,789 --> 00:22:28,039
seemed one cpu along with the other

515
00:22:28,039 --> 00:22:29,900
features we mentioned is kind of

516
00:22:29,900 --> 00:22:32,510
anomalous for enterprise settings all

517
00:22:32,510 --> 00:22:34,039
these very simple things can be used to

518
00:22:34,039 --> 00:22:36,409
come key in on that and then lastly you

519
00:22:36,409 --> 00:22:37,730
get what you pay for these services are

520
00:22:37,730 --> 00:22:39,950
free we don't mean to knock them in any

521
00:22:39,950 --> 00:22:44,210
way but you know keep that in mind as

522
00:22:44,210 --> 00:22:47,480
you give the state outbound you lose

523
00:22:47,480 --> 00:22:51,530
complete control over it I also wanted

524
00:22:51,530 --> 00:22:53,960
to we kind of stepped over a couple of

525
00:22:53,960 --> 00:22:56,630
things earlier the sharing of the sample

526
00:22:56,630 --> 00:23:00,799
is how far they were shared the one of

527
00:23:00,799 --> 00:23:03,140
the sandbox is we submitted to we saw

528
00:23:03,140 --> 00:23:06,590
more than 500 over a two-week period we

529
00:23:06,590 --> 00:23:09,470
saw more than 500 other clients IPS hit

530
00:23:09,470 --> 00:23:15,770
our server and more than 200 HTTP actual

531
00:23:15,770 --> 00:23:18,650
requests running our malware or our

532
00:23:18,650 --> 00:23:23,090
sensor to our C 2 server the other thing

533
00:23:23,090 --> 00:23:26,900
was this was really easy to create it

534
00:23:26,900 --> 00:23:29,630
took us less than 40 hours total to

535
00:23:29,630 --> 00:23:32,510
stand up the server to put together the

536
00:23:32,510 --> 00:23:35,480
two different sensors and to submit them

537
00:23:35,480 --> 00:23:39,049
to all this sand boxes and the part of

538
00:23:39,049 --> 00:23:41,500
the experiment that took the longest was

539
00:23:41,500 --> 00:23:46,030
submitting them to all of the sand boxes

540
00:23:46,030 --> 00:23:49,190
so and that that's all we actually had

541
00:23:49,190 --> 00:23:51,350
this was much quicker than I thought I

542
00:23:51,350 --> 00:23:55,760
was going to be with 23 slides does

543
00:23:55,760 --> 00:23:58,419
anybody have any questions

544
00:24:05,170 --> 00:24:07,360
yeah so we've been working with some of

545
00:24:07,360 --> 00:24:10,830
them the question was have we shared

546
00:24:10,830 --> 00:24:15,190
information back to the providers of the

547
00:24:15,190 --> 00:24:17,350
different sand boxes and such we we have

548
00:24:17,350 --> 00:24:22,290
with some of them not with all of them a

549
00:24:23,820 --> 00:24:26,170
lot of it is just getting a hold of the

550
00:24:26,170 --> 00:24:29,860
right people so our plan is to disclose

551
00:24:29,860 --> 00:24:31,750
all of our findings in great detail to

552
00:24:31,750 --> 00:24:34,390
all these vendors we just haven't had a

553
00:24:34,390 --> 00:24:36,070
chance to kind of fully finish that

554
00:24:36,070 --> 00:24:37,930
process that's why we left a lot of

555
00:24:37,930 --> 00:24:39,730
detail out of the talk so we didn't we

556
00:24:39,730 --> 00:24:40,780
didn't go into great detail on each

557
00:24:40,780 --> 00:24:42,970
sandbox provider really didn't want to

558
00:24:42,970 --> 00:24:44,860
create a how-to for how bad guys can do

559
00:24:44,860 --> 00:24:46,660
that sort of thing but we're still kind

560
00:24:46,660 --> 00:24:47,560
of working through responsible

561
00:24:47,560 --> 00:24:49,710
disclosure

562
00:24:59,669 --> 00:25:02,230
the question was it do we feel our if

563
00:25:02,230 --> 00:25:03,610
our sample got shared with the dark side

564
00:25:03,610 --> 00:25:05,529
it's possible if they're monitoring

565
00:25:05,529 --> 00:25:08,470
these sandboxes a lot of these sandboxes

566
00:25:08,470 --> 00:25:10,059
allow you to download the files directly

567
00:25:10,059 --> 00:25:12,429
from them they would really need to be

568
00:25:12,429 --> 00:25:14,259
looking for them a lot of times a lot of

569
00:25:14,259 --> 00:25:15,999
these places have you know millions of

570
00:25:15,999 --> 00:25:17,559
uploads per day so it's kind of a sea of

571
00:25:17,559 --> 00:25:20,889
data we we definitely saw that some

572
00:25:20,889 --> 00:25:22,840
places are downloading all them out

573
00:25:22,840 --> 00:25:25,210
we're from these these sand boxes and

574
00:25:25,210 --> 00:25:27,039
executing every one of them I would

575
00:25:27,039 --> 00:25:28,269
guess those are all AV companies they're

576
00:25:28,269 --> 00:25:39,970
just based on my data we have so the

577
00:25:39,970 --> 00:25:41,710
question was what do we recommend that

578
00:25:41,710 --> 00:25:43,570
the sandbox vendors do to mitigate the

579
00:25:43,570 --> 00:25:46,690
threat I suppose to us the biggest

580
00:25:46,690 --> 00:25:51,460
threat was more to the end users and the

581
00:25:51,460 --> 00:25:55,269
end organizations so going into this we

582
00:25:55,269 --> 00:25:56,980
kind of knew that people would share the

583
00:25:56,980 --> 00:25:59,529
samples and they would run them we

584
00:25:59,529 --> 00:26:02,070
didn't quite know to the level of

585
00:26:02,070 --> 00:26:04,869
activity that we would see that that was

586
00:26:04,869 --> 00:26:07,690
kind of amazing and additional

587
00:26:07,690 --> 00:26:10,299
additionally was like how regular the

588
00:26:10,299 --> 00:26:12,700
activity was a couple companies hit us

589
00:26:12,700 --> 00:26:16,840
every hour on the hour so that that's

590
00:26:16,840 --> 00:26:19,570
kind of interesting to see so our

591
00:26:19,570 --> 00:26:22,029
takeaway was that people that are

592
00:26:22,029 --> 00:26:24,970
responding to a targeted intrusion or

593
00:26:24,970 --> 00:26:26,499
what they think is a targeted intrusion

594
00:26:26,499 --> 00:26:30,009
that it's in their best interest to

595
00:26:30,009 --> 00:26:32,529
actually run those things in a closed

596
00:26:32,529 --> 00:26:35,049
sandbox environment rather than on the

597
00:26:35,049 --> 00:26:36,970
open web you know you can you can do

598
00:26:36,970 --> 00:26:39,759
that with REM Knox with fake net if you

599
00:26:39,759 --> 00:26:41,950
don't want to set up a separate Linux

600
00:26:41,950 --> 00:26:44,320
side or with a lot of other tools as

601
00:26:44,320 --> 00:26:47,889
well the sandbox providers themselves

602
00:26:47,889 --> 00:26:50,769
there's a lot of work that they could do

603
00:26:50,769 --> 00:26:55,600
to improve their platforms you know

604
00:26:55,600 --> 00:26:58,840
maybe improve the disk sizes improve the

605
00:26:58,840 --> 00:27:01,809
memory sizes and the RAM sizes those are

606
00:27:01,809 --> 00:27:03,700
all things that have been disclosed and

607
00:27:03,700 --> 00:27:05,710
talked about before we just wanted to

608
00:27:05,710 --> 00:27:08,350
see how useful those things actually

609
00:27:08,350 --> 00:27:08,820
work

610
00:27:08,820 --> 00:27:10,830
there's a lot of and one of the things

611
00:27:10,830 --> 00:27:13,740
that came out like last week was samples

612
00:27:13,740 --> 00:27:15,960
of you patri that were doing like a get

613
00:27:15,960 --> 00:27:18,690
to count to see how long the host had

614
00:27:18,690 --> 00:27:21,059
been up because I guess their assumption

615
00:27:21,059 --> 00:27:23,909
is that some sand boxes will just reset

616
00:27:23,909 --> 00:27:26,779
and restart the image each time with a

617
00:27:26,779 --> 00:27:30,090
short amount of time from boot to when

618
00:27:30,090 --> 00:27:32,309
it's rung but you could easily work

619
00:27:32,309 --> 00:27:34,409
through that by just starting up an

620
00:27:34,409 --> 00:27:36,929
image that's already been up for 30

621
00:27:36,929 --> 00:27:40,409
minutes or something the only thing I

622
00:27:40,409 --> 00:27:43,289
would add to that is some of the like

623
00:27:43,289 --> 00:27:45,690
free open-source sandbox platforms I

624
00:27:45,690 --> 00:27:47,460
think could either help with either

625
00:27:47,460 --> 00:27:50,220
documentation or automation to change

626
00:27:50,220 --> 00:27:52,080
the configuration of the images so

627
00:27:52,080 --> 00:27:53,279
images are going to be shared that's a

628
00:27:53,279 --> 00:27:55,470
fact but you could do stuff right before

629
00:27:55,470 --> 00:27:57,029
they sent the malware execute to change

630
00:27:57,029 --> 00:27:58,860
host name change the bios settings

631
00:27:58,860 --> 00:28:01,649
change a bunch of features of the vm or

632
00:28:01,649 --> 00:28:03,509
at least how the vm looks to the malware

633
00:28:03,509 --> 00:28:06,330
sample also not rename the sample before

634
00:28:06,330 --> 00:28:08,759
running a bunch of different things that

635
00:28:08,759 --> 00:28:10,139
they could do i think to kind of help

636
00:28:10,139 --> 00:28:12,120
enable people who run these locally

637
00:28:12,120 --> 00:28:13,590
because a lot of these same platforms

638
00:28:13,590 --> 00:28:15,690
are run locally by researchers they're

639
00:28:15,690 --> 00:28:16,860
just this finger printable if you run

640
00:28:16,860 --> 00:28:19,950
locally so I think those are things that

641
00:28:19,950 --> 00:28:22,220
could be done

642
00:28:28,120 --> 00:28:30,290
did we see any complete failures or

643
00:28:30,290 --> 00:28:32,090
someone took our sample and ran it not

644
00:28:32,090 --> 00:28:33,830
in a sandbox but in some sort production

645
00:28:33,830 --> 00:28:38,270
environment I don't I don't think so it

646
00:28:38,270 --> 00:28:40,250
might be hard for us to detect that to

647
00:28:40,250 --> 00:28:41,570
be honest but I don't I don't think that

648
00:28:41,570 --> 00:28:46,490
happened we could probably say that that

649
00:28:46,490 --> 00:28:48,890
most likely did not happen because all

650
00:28:48,890 --> 00:28:51,530
of the disks were like 20 gigs and 30

651
00:28:51,530 --> 00:29:01,670
gigs in size it's so what percentage of

652
00:29:01,670 --> 00:29:03,170
the providers actually try to call back

653
00:29:03,170 --> 00:29:14,690
in terms of good question yeah so I

654
00:29:14,690 --> 00:29:17,960
guess eight of them is that 88 of the

655
00:29:17,960 --> 00:29:21,170
sandbox providers actually connected to

656
00:29:21,170 --> 00:29:24,320
us with the HTTP traffic 22 of them

657
00:29:24,320 --> 00:29:28,720
connected made the DNS lookup out of 29

658
00:29:28,720 --> 00:29:32,000
there were some places that made no

659
00:29:32,000 --> 00:29:35,000
connections whatsoever to our sites that

660
00:29:35,000 --> 00:29:37,130
that was that was interesting a lot of

661
00:29:37,130 --> 00:29:41,450
the connections to our systems were made

662
00:29:41,450 --> 00:29:43,910
after they had been shared from that

663
00:29:43,910 --> 00:29:45,980
original provider out and that was

664
00:29:45,980 --> 00:29:49,370
interesting the only place that most of

665
00:29:49,370 --> 00:29:51,620
the places that you select private on

666
00:29:51,620 --> 00:29:56,690
end up sharing those samples to other AV

667
00:29:56,690 --> 00:29:59,110
providers which was an interesting

668
00:29:59,110 --> 00:30:02,439
finding of ours

669
00:30:13,360 --> 00:30:15,389
Oh

670
00:30:16,169 --> 00:30:18,230
Oh

671
00:30:21,789 --> 00:30:23,840
question was do we look at the except

672
00:30:23,840 --> 00:30:25,399
for use policy and data sharing policies

673
00:30:25,399 --> 00:30:27,260
of these places after we saw how data

674
00:30:27,260 --> 00:30:29,080
propagated we have not done that yet

675
00:30:29,080 --> 00:30:30,950
that would definitely be interesting to

676
00:30:30,950 --> 00:30:40,490
see if there's conflict I would like to

677
00:30:40,490 --> 00:30:41,899
continue this research and I think

678
00:30:41,899 --> 00:30:43,610
there's a lot of other directions we can

679
00:30:43,610 --> 00:30:46,580
go with this yeah I would like to do

680
00:30:46,580 --> 00:30:50,480
that yeah specifically around the how

681
00:30:50,480 --> 00:30:52,610
the indicators ended up on thread

682
00:30:52,610 --> 00:30:54,350
indicator lists that were being deployed

683
00:30:54,350 --> 00:30:57,110
in people's production blocking

684
00:30:57,110 --> 00:30:59,059
scenarios that that's kind of the most

685
00:30:59,059 --> 00:31:01,970
interesting portion to us at least to me

686
00:31:01,970 --> 00:31:10,269
it weighs oh yeah so the most prevalent

687
00:31:10,269 --> 00:31:13,340
DNS servers were google dns and the most

688
00:31:13,340 --> 00:31:16,789
prevalent HTTP servers or HTTP clients

689
00:31:16,789 --> 00:31:20,120
were amazon web services so a lot of

690
00:31:20,120 --> 00:31:22,039
people are running sandbox is on amazon

691
00:31:22,039 --> 00:31:24,230
web services and a lot of people are

692
00:31:24,230 --> 00:31:27,799
using google dns 88 and all of that

693
00:31:27,799 --> 00:31:30,380
comes back as google translate and most

694
00:31:30,380 --> 00:31:34,059
frequently at least that we were seeing

695
00:31:41,980 --> 00:31:51,880
did we really act at all oh well we

696
00:31:51,880 --> 00:31:53,190
would have been doing the detection

697
00:31:53,190 --> 00:31:57,549
although we did we created the samples

698
00:31:57,549 --> 00:31:59,250
in such a way that we were actually

699
00:31:59,250 --> 00:32:02,950
specifically trying to trigger one of

700
00:32:02,950 --> 00:32:05,620
our colleagues yarra roles that were up

701
00:32:05,620 --> 00:32:09,510
on virustotal and that did succeed and

702
00:32:09,510 --> 00:32:14,140
neville it's fun he wasn't really happy

703
00:32:14,140 --> 00:32:16,090
with us after a couple of days and just

704
00:32:16,090 --> 00:32:27,549
kept sending messages back to us any

705
00:32:27,549 --> 00:32:33,000
other questions Jeff

706
00:32:37,519 --> 00:32:51,059
grafter I guess no so the if we upx pack

707
00:32:51,059 --> 00:32:53,549
them they were almost always detected as

708
00:32:53,549 --> 00:32:57,870
Zeus amongst some Navy vendors but then

709
00:32:57,870 --> 00:32:59,909
some of the samples that were TPX packed

710
00:32:59,909 --> 00:33:02,490
were also detected of Zeus and then they

711
00:33:02,490 --> 00:33:03,899
were detected as a grafter I have no

712
00:33:03,899 --> 00:33:09,090
idea why they were if anything by using

713
00:33:09,090 --> 00:33:14,870
the and you might remember this from

714
00:33:14,870 --> 00:33:17,700
when you took my class did did we do the

715
00:33:17,700 --> 00:33:24,539
Chop Shop module it no okay so the way

716
00:33:24,539 --> 00:33:27,840
that we did the HTTP communications I

717
00:33:27,840 --> 00:33:31,590
was really curious to see will any AV

718
00:33:31,590 --> 00:33:34,769
vendors use the network traffic to try

719
00:33:34,769 --> 00:33:37,230
to trigger off of that and classify the

720
00:33:37,230 --> 00:33:40,559
malware or the sample was something and

721
00:33:40,559 --> 00:33:42,720
as was specifically using that to try to

722
00:33:42,720 --> 00:33:45,480
see if that would happen and that didn't

723
00:33:45,480 --> 00:33:50,210
happen so that was kind of interesting

724
00:33:51,649 --> 00:33:59,299
anybody else cool thank you

