1
00:00:00,030 --> 00:00:05,069
besides DC would like to thank all of

2
00:00:02,310 --> 00:00:07,500
our sponsors and a special thank<font color="#E5E5E5"> you to</font>

3
00:00:05,069 --> 00:00:11,700
all<font color="#E5E5E5"> of our speakers</font><font color="#CCCCCC"> volunteers and</font>

4
00:00:07,500 --> 00:00:14,009
organizers for making 2018<font color="#E5E5E5"> a success hi</font>

5
00:00:11,700 --> 00:00:16,289
my name<font color="#CCCCCC"> is Ken Jenkins we're gonna have</font>

6
00:00:14,009 --> 00:00:18,990
a talk<font color="#E5E5E5"> today about</font><font color="#CCCCCC"> security</font><font color="#E5E5E5"> control</font>

7
00:00:16,289 --> 00:00:23,010
validation using<font color="#E5E5E5"> threat</font><font color="#CCCCCC"> behavioral based</font>

8
00:00:18,990 --> 00:00:24,900
immolations<font color="#CCCCCC"> did this talks Connor more</font>

9
00:00:23,010 --> 00:00:26,130
focus for blue teamers but<font color="#E5E5E5"> I think the</font>

10
00:00:24,900 --> 00:00:27,689
red teamers in the room<font color="#E5E5E5"> could kind of</font>

11
00:00:26,130 --> 00:00:30,210
take it a<font color="#E5E5E5"> Cal ittle bit away</font><font color="#CCCCCC"> from this</font>

12
00:00:27,689 --> 00:00:32,009
<font color="#E5E5E5">so what we've kind of done is you know</font>

13
00:00:30,210 --> 00:00:34,620
instead of<font color="#E5E5E5"> the full spectrum</font><font color="#CCCCCC"> red teaming</font>

14
00:00:32,009 --> 00:00:38,100
we break down<font color="#E5E5E5"> into very small chunks and</font>

15
00:00:34,620 --> 00:00:41,000
<font color="#CCCCCC">a focus of today's talk is on traffic so</font>

16
00:00:38,100 --> 00:00:44,940
iterating through different types<font color="#E5E5E5"> of</font><font color="#CCCCCC"> c2</font>

17
00:00:41,000 --> 00:00:46,289
as I said my<font color="#CCCCCC"> name's Ken Jenkins I've</font>

18
00:00:44,940 --> 00:00:47,669
been<font color="#CCCCCC"> in iron net for about two and</font><font color="#E5E5E5"> a</font>

19
00:00:46,289 --> 00:00:49,649
half<font color="#E5E5E5"> years I lead the red team there</font>

20
00:00:47,670 --> 00:00:51,899
prior to<font color="#CCCCCC"> that I was</font><font color="#E5E5E5"> on a DoD Red Team</font>

21
00:00:49,649 --> 00:00:53,879
Blue<font color="#CCCCCC"> Team hunt team worked in a big sock</font>

22
00:00:51,899 --> 00:00:56,550
<font color="#E5E5E5">prior</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> that was network systems</font>

23
00:00:53,879 --> 00:01:02,730
engineering<font color="#CCCCCC"> I</font><font color="#E5E5E5"> retired about two and a</font>

24
00:00:56,550 --> 00:01:04,378
half<font color="#E5E5E5"> years ago from active duty hi I'm</font>

25
00:01:02,730 --> 00:01:06,450
Stuart<font color="#CCCCCC"> McQuarrie</font><font color="#E5E5E5"> I'm a little confused</font>

26
00:01:04,379 --> 00:01:07,860
<font color="#CCCCCC">about</font><font color="#E5E5E5"> Michaels</font><font color="#CCCCCC"> how they work no I'm</font>

27
00:01:06,450 --> 00:01:09,780
serving<font color="#CCCCCC"> ray I'm a Red Team operator and</font>

28
00:01:07,860 --> 00:01:11,729
developer at iron net<font color="#CCCCCC"> I focus mostly on</font>

29
00:01:09,780 --> 00:01:14,070
<font color="#E5E5E5">UNIX operations for this is at a fortune</font>

30
00:01:11,729 --> 00:01:16,979
<font color="#E5E5E5">500</font><font color="#CCCCCC"> Red Team</font><font color="#E5E5E5"> for that I was an officer</font>

31
00:01:14,070 --> 00:01:18,839
in the Navy<font color="#CCCCCC"> yes</font><font color="#E5E5E5"> so big</font><font color="#CCCCCC"> shout out to Greg</font>

32
00:01:16,979 --> 00:01:21,450
Conte he's one of<font color="#E5E5E5"> our mentors</font><font color="#CCCCCC"> his senior</font>

33
00:01:18,840 --> 00:01:23,189
strategist<font color="#E5E5E5"> at our company</font><font color="#CCCCCC"> he leads a lot</font>

34
00:01:21,450 --> 00:01:26,430
<font color="#E5E5E5">of talks</font><font color="#CCCCCC"> I think he's been in blackout</font>

35
00:01:23,189 --> 00:01:29,880
every year for I<font color="#E5E5E5"> don't know forever</font><font color="#CCCCCC"> good</font>

36
00:01:26,430 --> 00:01:32,280
guy to<font color="#E5E5E5"> follow on Twitter as well so</font>

37
00:01:29,880 --> 00:01:34,530
disclaimer<font color="#CCCCCC"> you see a lot of</font><font color="#E5E5E5"> these at the</font>

38
00:01:32,280 --> 00:01:36,780
talks<font color="#CCCCCC"> this one right here is no</font>

39
00:01:34,530 --> 00:01:38,250
<font color="#E5E5E5">different the big big thing is you know</font>

40
00:01:36,780 --> 00:01:40,460
consult with someone<font color="#E5E5E5"> before you start</font>

41
00:01:38,250 --> 00:01:42,960
doing any<font color="#E5E5E5"> of these activities and</font>

42
00:01:40,460 --> 00:01:45,539
<font color="#CCCCCC">obviously we're not here to like preach</font>

43
00:01:42,960 --> 00:01:48,479
about<font color="#E5E5E5"> our company's policy and</font>

44
00:01:45,540 --> 00:01:50,490
disclaimers<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> kind of an outline</font>

45
00:01:48,479 --> 00:01:52,679
will follow<font color="#E5E5E5"> will address the problem</font>

46
00:01:50,490 --> 00:01:54,780
<font color="#CCCCCC">that we see a lot of red</font><font color="#E5E5E5"> team's they</font>

47
00:01:52,680 --> 00:01:56,610
jump<font color="#E5E5E5"> into a network</font><font color="#CCCCCC"> they do their thing</font>

48
00:01:54,780 --> 00:01:58,500
<font color="#E5E5E5">they give their out brief maybe</font><font color="#CCCCCC"> their</font>

49
00:01:56,610 --> 00:02:01,049
hot wash and then<font color="#E5E5E5"> they jump jump to the</font>

50
00:01:58,500 --> 00:02:02,759
report and then that's<font color="#E5E5E5"> about it every</font>

51
00:02:01,049 --> 00:02:04,680
now and<font color="#CCCCCC"> then there's some</font><font color="#E5E5E5"> follow-on</font><font color="#CCCCCC"> we</font>

52
00:02:02,759 --> 00:02:07,110
<font color="#CCCCCC">talked about</font><font color="#E5E5E5"> how threat emulation helps</font>

53
00:02:04,680 --> 00:02:08,729
your environment<font color="#E5E5E5"> you don't have to be a</font>

54
00:02:07,110 --> 00:02:10,080
red teamer to do threat emulation in

55
00:02:08,729 --> 00:02:11,340
<font color="#E5E5E5">your environment</font><font color="#CCCCCC"> we'll talk a little</font><font color="#E5E5E5"> bit</font>

56
00:02:10,080 --> 00:02:13,490
<font color="#CCCCCC">more about that</font>

57
00:02:11,340 --> 00:02:15,380
and in bad days

58
00:02:13,490 --> 00:02:16,970
matter<font color="#E5E5E5"> what we've done every time we</font>

59
00:02:15,380 --> 00:02:19,760
show up<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a customers excuse me a</font>

60
00:02:16,970 --> 00:02:21,380
client's in environment<font color="#CCCCCC"> something goes</font>

61
00:02:19,760 --> 00:02:24,470
wrong so<font color="#E5E5E5"> even no matter how much you</font>

62
00:02:21,380 --> 00:02:28,100
plan<font color="#CCCCCC"> for it with disgust a fortune 100</font>

63
00:02:24,470 --> 00:02:29,630
engagement that<font color="#E5E5E5"> we had recently and</font><font color="#CCCCCC"> Stu</font>

64
00:02:28,100 --> 00:02:32,239
will jump into<font color="#E5E5E5"> some of the coding</font>

65
00:02:29,630 --> 00:02:33,620
emulators we have and and tools<font color="#E5E5E5"> and then</font>

66
00:02:32,240 --> 00:02:36,920
we'll close<font color="#CCCCCC"> it up with some lessons</font>

67
00:02:33,620 --> 00:02:39,770
learned<font color="#E5E5E5"> so what's the problem</font>

68
00:02:36,920 --> 00:02:42,140
you know<font color="#E5E5E5"> our enterprise environments</font>

69
00:02:39,770 --> 00:02:44,990
have gotten so big<font color="#CCCCCC"> the complexity is</font>

70
00:02:42,140 --> 00:02:46,910
crazy<font color="#CCCCCC"> defense-in-depth is</font><font color="#E5E5E5"> is pretty deep</font>

71
00:02:44,990 --> 00:02:48,950
and<font color="#E5E5E5"> then it should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> distributed</font><font color="#CCCCCC"> how</font>

72
00:02:46,910 --> 00:02:51,380
its managed between the IT team the

73
00:02:48,950 --> 00:02:54,560
<font color="#CCCCCC">governor's</font><font color="#E5E5E5"> risk compliance team the sigh</font>

74
00:02:51,380 --> 00:02:57,829
so steam the the the hunt team is

75
00:02:54,560 --> 00:02:59,150
providing over watching<font color="#CCCCCC"> the sock</font><font color="#E5E5E5"> so you</font>

76
00:02:57,830 --> 00:03:00,650
know there's a lot<font color="#E5E5E5"> of ownership there</font>

77
00:02:59,150 --> 00:03:02,930
and<font color="#CCCCCC"> you know there can be miss</font>

78
00:03:00,650 --> 00:03:05,180
<font color="#CCCCCC">configurations along the way</font><font color="#E5E5E5"> so we want</font>

79
00:03:02,930 --> 00:03:06,260
<font color="#E5E5E5">to we definitely want to not make</font>

80
00:03:05,180 --> 00:03:08,360
<font color="#E5E5E5">assumptions whether something's</font>

81
00:03:06,260 --> 00:03:12,590
configured correctly<font color="#E5E5E5"> and wanted to test</font>

82
00:03:08,360 --> 00:03:14,420
the<font color="#CCCCCC"> security controls so why do we what</font>

83
00:03:12,590 --> 00:03:17,060
is emulation<font color="#E5E5E5"> what's</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> you know to</font>

84
00:03:14,420 --> 00:03:18,769
address that<font color="#E5E5E5"> last slide emulation is</font>

85
00:03:17,060 --> 00:03:20,870
more to the kind<font color="#E5E5E5"> of counter those</font>

86
00:03:18,770 --> 00:03:22,640
problems<font color="#CCCCCC"> so you're not waiting til a bad</font>

87
00:03:20,870 --> 00:03:24,650
days occurred and<font color="#E5E5E5"> you know you're your</font>

88
00:03:22,640 --> 00:03:27,859
<font color="#E5E5E5">first breach</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> your organization has</font>

89
00:03:24,650 --> 00:03:30,170
<font color="#CCCCCC">happened</font><font color="#E5E5E5"> instead you'd rather exercise</font>

90
00:03:27,860 --> 00:03:32,390
that<font color="#E5E5E5"> a few times and you</font><font color="#CCCCCC"> can you you</font>

91
00:03:30,170 --> 00:03:34,940
<font color="#E5E5E5">know we see a lot of organizations doing</font>

92
00:03:32,390 --> 00:03:36,890
<font color="#E5E5E5">tabletop exercise before they rehearse</font>

93
00:03:34,940 --> 00:03:39,050
what they will do if it<font color="#E5E5E5"> happen but they</font>

94
00:03:36,890 --> 00:03:41,510
don't actually rehearse<font color="#E5E5E5"> when it happens</font>

95
00:03:39,050 --> 00:03:44,510
<font color="#E5E5E5">over fire prior to happens like hands on</font>

96
00:03:41,510 --> 00:03:45,920
keyboard<font color="#CCCCCC"> so it's good to conduct Sandman</font>

97
00:03:44,510 --> 00:03:48,260
relations and like I said<font color="#E5E5E5"> we're gonna</font>

98
00:03:45,920 --> 00:03:52,100
break out very specific things we do<font color="#CCCCCC"> for</font>

99
00:03:48,260 --> 00:03:53,870
some of<font color="#CCCCCC"> the red teaming that we do so</font>

100
00:03:52,100 --> 00:03:55,760
what<font color="#CCCCCC"> are uses of current cyber</font><font color="#E5E5E5"> threat</font>

101
00:03:53,870 --> 00:03:58,130
emulation<font color="#E5E5E5"> mainly is to test security</font>

102
00:03:55,760 --> 00:04:00,679
<font color="#E5E5E5">controls endpoint to internet but it's</font>

103
00:03:58,130 --> 00:04:02,540
also people<font color="#E5E5E5"> processes techniques of</font>

104
00:04:00,680 --> 00:04:05,000
<font color="#E5E5E5">shoes excuse me people process</font>

105
00:04:02,540 --> 00:04:06,769
technology and then as I mentioned<font color="#CCCCCC"> a</font>

106
00:04:05,000 --> 00:04:08,690
moment ago<font color="#CCCCCC"> you want to</font><font color="#E5E5E5"> exercise that</font>

107
00:04:06,770 --> 00:04:11,209
<font color="#E5E5E5">insulin response plan but you don't want</font>

108
00:04:08,690 --> 00:04:14,540
to just exercise it on paper or in<font color="#CCCCCC"> a</font>

109
00:04:11,209 --> 00:04:16,459
sandbox<font color="#CCCCCC"> one that we've been kind</font><font color="#E5E5E5"> of</font>

110
00:04:14,540 --> 00:04:19,099
<font color="#CCCCCC">working on a bit is testing sensors and</font>

111
00:04:16,459 --> 00:04:20,238
<font color="#E5E5E5">network protocols so in a lot</font><font color="#CCCCCC"> of our</font>

112
00:04:19,100 --> 00:04:23,570
clients environments they have these

113
00:04:20,238 --> 00:04:26,239
huge gigamon<font color="#E5E5E5"> tapped</font><font color="#CCCCCC"> into spanning a</font>

114
00:04:23,570 --> 00:04:27,400
tapping infrastructures and<font color="#E5E5E5"> you know a</font>

115
00:04:26,240 --> 00:04:29,590
lot of<font color="#E5E5E5"> times that's not</font>

116
00:04:27,400 --> 00:04:31,989
<font color="#CCCCCC">tuned effectively for the IPS is</font><font color="#E5E5E5"> IDS's</font>

117
00:04:29,590 --> 00:04:33,698
so we're kind of go into<font color="#E5E5E5"> that a bit</font><font color="#CCCCCC"> and</font>

118
00:04:31,990 --> 00:04:36,580
<font color="#E5E5E5">show you how some</font><font color="#CCCCCC"> of the gaps that we've</font>

119
00:04:33,699 --> 00:04:37,810
discovered<font color="#CCCCCC"> no matter how many tools you</font>

120
00:04:36,580 --> 00:04:39,900
continue to deploy in your environment

121
00:04:37,810 --> 00:04:42,130
<font color="#CCCCCC">you're always going to find that</font>

122
00:04:39,900 --> 00:04:44,909
<font color="#E5E5E5">something's something's not deployed</font>

123
00:04:42,130 --> 00:04:46,840
<font color="#E5E5E5">exactly as you thought it was you know</font>

124
00:04:44,910 --> 00:04:48,850
if you're in<font color="#E5E5E5"> the government</font><font color="#CCCCCC"> maybe you're</font>

125
00:04:46,840 --> 00:04:50,979
following Stig's<font color="#E5E5E5"> but someone somewhere</font>

126
00:04:48,850 --> 00:04:52,330
responsible you<font color="#E5E5E5"> know didn't configure</font>

127
00:04:50,979 --> 00:04:53,979
something correctly or it was a

128
00:04:52,330 --> 00:04:56,500
oversight or there was a drive-by

129
00:04:53,979 --> 00:04:58,930
<font color="#E5E5E5">fielding whatever it may be</font>

130
00:04:56,500 --> 00:05:01,000
<font color="#CCCCCC">anyone we also work</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> as validating</font>

131
00:04:58,930 --> 00:05:02,500
<font color="#CCCCCC">your vendors claims you know fancy</font>

132
00:05:01,000 --> 00:05:05,169
vendor comes in with their box<font color="#E5E5E5"> their</font>

133
00:05:02,500 --> 00:05:06,760
appliance<font color="#CCCCCC"> they're they're super sexy</font>

134
00:05:05,169 --> 00:05:08,080
sales engineer comes in and<font color="#E5E5E5"> starts</font>

135
00:05:06,760 --> 00:05:11,530
demoing the product<font color="#E5E5E5"> and you're wowed by</font>

136
00:05:08,080 --> 00:05:14,198
it<font color="#E5E5E5"> and you move</font><font color="#CCCCCC"> to purchase you know it</font>

137
00:05:11,530 --> 00:05:15,940
really<font color="#E5E5E5"> works you know what we do here is</font>

138
00:05:14,199 --> 00:05:19,270
we kind<font color="#E5E5E5"> of show</font><font color="#CCCCCC"> off how how our behavior</font>

139
00:05:15,940 --> 00:05:21,669
analytics work next<font color="#E5E5E5"> is a degenerate</font>

140
00:05:19,270 --> 00:05:23,650
artifacts<font color="#E5E5E5"> for our specifically it</font>

141
00:05:21,669 --> 00:05:25,599
generates pcap a bunch of log files<font color="#E5E5E5"> and</font>

142
00:05:23,650 --> 00:05:28,989
<font color="#E5E5E5">you can give that</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> your hunt teams to</font>

143
00:05:25,599 --> 00:05:32,469
use for those<font color="#CCCCCC"> IR exercises</font><font color="#E5E5E5"> of the</font>

144
00:05:28,990 --> 00:05:35,770
training<font color="#E5E5E5"> and testing so how is it</font>

145
00:05:32,470 --> 00:05:38,470
<font color="#E5E5E5">currently being done generally you know</font>

146
00:05:35,770 --> 00:05:40,180
you negotiate with<font color="#CCCCCC"> a</font><font color="#E5E5E5"> I say you know go</font>

147
00:05:38,470 --> 00:05:42,370
she ate you know client reaches out to

148
00:05:40,180 --> 00:05:43,840
you and you go see the contract<font color="#E5E5E5"> you know</font>

149
00:05:42,370 --> 00:05:45,400
if you come<font color="#CCCCCC"> up with your objectives</font><font color="#E5E5E5"> it's</font>

150
00:05:43,840 --> 00:05:47,380
all about the customers objectives right

151
00:05:45,400 --> 00:05:49,510
<font color="#E5E5E5">not just</font><font color="#CCCCCC"> what does the</font><font color="#E5E5E5"> red team want to</font>

152
00:05:47,380 --> 00:05:51,729
do and what<font color="#E5E5E5"> can they get away</font><font color="#CCCCCC"> with and</font>

153
00:05:49,510 --> 00:05:54,070
generally red<font color="#CCCCCC"> team's take the</font><font color="#E5E5E5"> least path</font>

154
00:05:51,729 --> 00:05:56,380
of resistance<font color="#E5E5E5"> normally fish your way in</font>

155
00:05:54,070 --> 00:05:59,590
or get some kind<font color="#E5E5E5"> of assumed breach</font>

156
00:05:56,380 --> 00:06:02,280
access<font color="#E5E5E5"> and then from narrow and you</font>

157
00:05:59,590 --> 00:06:06,789
start<font color="#E5E5E5"> conducting ops usually c2s a given</font>

158
00:06:02,280 --> 00:06:09,340
so<font color="#E5E5E5"> I I was at a class a couple weeks ago</font>

159
00:06:06,789 --> 00:06:12,130
<font color="#E5E5E5">at Derby con and some of the red</font><font color="#CCCCCC"> team's</font>

160
00:06:09,340 --> 00:06:14,260
and Sarah say you know hey<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know we</font>

161
00:06:12,130 --> 00:06:16,180
have a hard customer<font color="#E5E5E5"> so we</font><font color="#CCCCCC"> just domain</font>

162
00:06:14,260 --> 00:06:17,979
front that's just a given<font color="#E5E5E5"> when we go in</font>

163
00:06:16,180 --> 00:06:19,300
we domain front from start<font color="#E5E5E5"> at the</font>

164
00:06:17,979 --> 00:06:21,400
beginning<font color="#E5E5E5"> and we don't really worry</font>

165
00:06:19,300 --> 00:06:23,710
<font color="#E5E5E5">about</font><font color="#CCCCCC"> c2 we we're really worried about</font>

166
00:06:21,400 --> 00:06:27,969
<font color="#E5E5E5">keeping our access and seeing what we</font>

167
00:06:23,710 --> 00:06:29,919
can<font color="#E5E5E5"> do in endpoints and servers so not</font>

168
00:06:27,970 --> 00:06:32,740
<font color="#CCCCCC">really iterating through so in what it</font>

169
00:06:29,919 --> 00:06:34,448
what is within the c2<font color="#CCCCCC"> usually as</font>

170
00:06:32,740 --> 00:06:35,080
beaconing<font color="#E5E5E5"> or some kind of</font><font color="#CCCCCC"> tunneling over</font>

171
00:06:34,449 --> 00:06:37,450
to us

172
00:06:35,080 --> 00:06:39,190
exfil over<font color="#E5E5E5"> DNS but definitely not</font>

173
00:06:37,450 --> 00:06:41,009
iterating so what I what I mean about

174
00:06:39,190 --> 00:06:42,389
iterating is you know

175
00:06:41,009 --> 00:06:44,879
beaconing intervals the different jitter

176
00:06:42,389 --> 00:06:49,469
intervals<font color="#E5E5E5"> are you switching domains as</font>

177
00:06:44,879 --> 00:06:50,819
you know every<font color="#E5E5E5"> other</font><font color="#CCCCCC"> callback or or are</font>

178
00:06:49,469 --> 00:06:54,240
<font color="#CCCCCC">you using</font><font color="#E5E5E5"> different types of DNS</font>

179
00:06:50,819 --> 00:06:56,099
tunneling<font color="#CCCCCC"> or your sub domain sub domain</font>

180
00:06:54,240 --> 00:06:59,099
links the queries<font color="#E5E5E5"> are</font><font color="#CCCCCC"> they a certain</font>

181
00:06:56,099 --> 00:07:00,389
<font color="#E5E5E5">size are you changing that</font><font color="#CCCCCC"> up or you</font>

182
00:06:59,099 --> 00:07:03,930
<font color="#CCCCCC">just sticking</font><font color="#E5E5E5"> on what's publicly</font>

183
00:07:00,389 --> 00:07:07,020
available<font color="#E5E5E5"> that's been signature eyes and</font>

184
00:07:03,930 --> 00:07:09,839
then generally<font color="#E5E5E5"> we do it as well</font><font color="#CCCCCC"> we buy a</font>

185
00:07:07,020 --> 00:07:13,770
good reputation domain<font color="#CCCCCC"> maybe off expired</font>

186
00:07:09,839 --> 00:07:15,839
domains net<font color="#E5E5E5"> and then we you know we kind</font>

187
00:07:13,770 --> 00:07:17,818
of<font color="#CCCCCC"> park it we have a static site up that</font>

188
00:07:15,839 --> 00:07:19,559
keeps<font color="#CCCCCC"> the reputation building before we</font>

189
00:07:17,819 --> 00:07:21,479
go<font color="#CCCCCC"> to excuse me before we go to a</font>

190
00:07:19,559 --> 00:07:23,610
<font color="#E5E5E5">customer engagement we may go and check</font>

191
00:07:21,479 --> 00:07:26,099
to see<font color="#CCCCCC"> if</font><font color="#E5E5E5"> I what's that what's the</font>

192
00:07:23,610 --> 00:07:27,809
reputation<font color="#E5E5E5"> look like now</font><font color="#CCCCCC"> we try</font><font color="#E5E5E5"> to</font>

193
00:07:26,099 --> 00:07:29,159
discover what<font color="#CCCCCC"> that</font><font color="#E5E5E5"> customers proxy is</font>

194
00:07:27,809 --> 00:07:31,409
before we<font color="#E5E5E5"> get there and see if our</font>

195
00:07:29,159 --> 00:07:33,270
domains are categorized correctly but

196
00:07:31,409 --> 00:07:35,219
then<font color="#E5E5E5"> we live off of that those one or</font>

197
00:07:33,270 --> 00:07:36,599
two domains that we use while we're<font color="#E5E5E5"> in</font>

198
00:07:35,219 --> 00:07:38,669
the environment<font color="#E5E5E5"> you know a lot of</font><font color="#CCCCCC"> red</font>

199
00:07:36,599 --> 00:07:40,529
teams have the short and long haul<font color="#CCCCCC"> coms</font>

200
00:07:38,669 --> 00:07:42,808
<font color="#E5E5E5">you know they probably have a some</font><font color="#CCCCCC"> kind</font>

201
00:07:40,529 --> 00:07:44,399
of DNS beacon in you know for long<font color="#E5E5E5"> haul</font>

202
00:07:42,809 --> 00:07:45,719
coms<font color="#E5E5E5"> and then for short all coms are</font>

203
00:07:44,399 --> 00:07:47,430
probably<font color="#E5E5E5"> using some type of beaconing</font>

204
00:07:45,719 --> 00:07:49,319
<font color="#E5E5E5">but they generally don't iterate off of</font>

205
00:07:47,430 --> 00:07:53,339
that<font color="#E5E5E5"> or use different</font><font color="#CCCCCC"> intervals except</font>

206
00:07:49,319 --> 00:07:54,870
when<font color="#E5E5E5"> they go interactive</font><font color="#CCCCCC"> so exercise an</font>

207
00:07:53,339 --> 00:07:57,569
<font color="#CCCCCC">endpoint</font><font color="#E5E5E5"> only there's a lot of talks</font>

208
00:07:54,870 --> 00:08:00,029
going<font color="#E5E5E5"> on about how to privilege escalate</font>

209
00:07:57,569 --> 00:08:02,699
out of bypass or you know<font color="#CCCCCC"> AppLocker</font>

210
00:08:00,029 --> 00:08:04,529
different<font color="#E5E5E5"> EDR solutions we've got one of</font>

211
00:08:02,699 --> 00:08:06,959
celebrities in the in the conference

212
00:08:04,529 --> 00:08:09,149
room<font color="#E5E5E5"> bow up sit in the front row he's</font>

213
00:08:06,959 --> 00:08:11,879
got a<font color="#E5E5E5"> really</font><font color="#CCCCCC"> good blog going on you know</font>

214
00:08:09,149 --> 00:08:13,469
exercise<font color="#E5E5E5"> and</font><font color="#CCCCCC"> end points but</font><font color="#E5E5E5"> we're not</font>

215
00:08:11,879 --> 00:08:15,300
<font color="#E5E5E5">really stressing the network this</font>

216
00:08:13,469 --> 00:08:18,029
<font color="#CCCCCC">networks kind of a given for red team's</font>

217
00:08:15,300 --> 00:08:20,550
<font color="#E5E5E5">if</font><font color="#CCCCCC"> Network segmentation</font><font color="#E5E5E5"> isn't quite</font>

218
00:08:18,029 --> 00:08:22,680
right and<font color="#CCCCCC"> the proxies aren't tuned</font>

219
00:08:20,550 --> 00:08:26,219
correctly<font color="#CCCCCC"> generally just go in write in</font>

220
00:08:22,680 --> 00:08:28,319
and out of the network<font color="#E5E5E5"> often the</font>

221
00:08:26,219 --> 00:08:30,058
defenders<font color="#CCCCCC"> sigh so's whatever it may be</font>

222
00:08:28,319 --> 00:08:31,469
<font color="#CCCCCC">they don't</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> directly with</font><font color="#E5E5E5"> the red</font>

223
00:08:30,059 --> 00:08:34,169
<font color="#E5E5E5">team's maybe it's just for a pro</font>

224
00:08:31,469 --> 00:08:36,299
services engagement<font color="#E5E5E5"> you come in you give</font>

225
00:08:34,169 --> 00:08:38,039
your hand the objectives<font color="#CCCCCC"> over to the to</font>

226
00:08:36,299 --> 00:08:41,698
the red team<font color="#E5E5E5"> you agree upon it and then</font>

227
00:08:38,039 --> 00:08:44,039
you start<font color="#CCCCCC"> exercising</font><font color="#E5E5E5"> that but afterwards</font>

228
00:08:41,698 --> 00:08:45,990
<font color="#E5E5E5">long-term you know there is like</font><font color="#CCCCCC"> that</font>

229
00:08:44,039 --> 00:08:48,269
iterating through training with the sock

230
00:08:45,990 --> 00:08:51,120
or the other defenders<font color="#E5E5E5"> really doesn't</font>

231
00:08:48,269 --> 00:08:52,319
happen a lot<font color="#CCCCCC"> so I kind of touch them the</font>

232
00:08:51,120 --> 00:08:53,900
next<font color="#CCCCCC"> bullet a lack of</font><font color="#E5E5E5"> training</font>

233
00:08:52,319 --> 00:08:54,890
afterwards

234
00:08:53,900 --> 00:08:56,810
I don't<font color="#E5E5E5"> think you</font><font color="#CCCCCC"> should</font><font color="#E5E5E5"> leave an</font>

235
00:08:54,890 --> 00:08:58,970
environment with some some tool<font color="#E5E5E5"> you're</font>

236
00:08:56,810 --> 00:09:00,920
in there or some technique that you know

237
00:08:58,970 --> 00:09:02,300
you're not kind<font color="#E5E5E5"> of sharing with them and</font>

238
00:09:00,920 --> 00:09:03,530
saying hey we might want to go<font color="#CCCCCC"> look</font><font color="#E5E5E5"> at</font>

239
00:09:02,300 --> 00:09:06,680
this<font color="#E5E5E5"> maybe you don't turn it over</font>

240
00:09:03,530 --> 00:09:09,050
completely<font color="#CCCCCC"> and then I don't think</font><font color="#E5E5E5"> we've</font>

241
00:09:06,680 --> 00:09:10,430
talked to a red team that lately that

242
00:09:09,050 --> 00:09:14,990
does<font color="#CCCCCC"> anything with like domain</font>

243
00:09:10,430 --> 00:09:17,630
generation algorithm<font color="#E5E5E5"> so we like to test</font>

244
00:09:14,990 --> 00:09:19,250
this in environment so<font color="#CCCCCC"> DG a</font><font color="#E5E5E5"> DJ's domain</font>

245
00:09:17,630 --> 00:09:21,170
generation algorithm it's a you know

246
00:09:19,250 --> 00:09:23,120
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> algorithm that creates a whole</font>

247
00:09:21,170 --> 00:09:25,060
<font color="#E5E5E5">bunch of queries and the malware</font>

248
00:09:23,120 --> 00:09:27,020
developer at one point<font color="#CCCCCC"> time has</font>

249
00:09:25,060 --> 00:09:30,020
<font color="#E5E5E5">registered domain that he knows that</font>

250
00:09:27,020 --> 00:09:31,699
<font color="#E5E5E5">algorithm will query out to will create</font>

251
00:09:30,020 --> 00:09:33,170
a query inquiry out to that<font color="#CCCCCC"> domain and</font>

252
00:09:31,700 --> 00:09:35,690
then it has command<font color="#CCCCCC"> and control</font><font color="#E5E5E5"> C to</font>

253
00:09:33,170 --> 00:09:37,510
rendezvous<font color="#CCCCCC"> so you know we like to</font>

254
00:09:35,690 --> 00:09:42,470
<font color="#E5E5E5">iterate through different types of</font><font color="#CCCCCC"> DG a</font>

255
00:09:37,510 --> 00:09:43,880
<font color="#CCCCCC">during our engagements so all right</font><font color="#E5E5E5"> well</font>

256
00:09:42,470 --> 00:09:46,550
the red teamers in here you're like yeah

257
00:09:43,880 --> 00:09:48,439
thanks can<font color="#E5E5E5"> you know planning you</font>

258
00:09:46,550 --> 00:09:50,569
definitely got a plan so what some<font color="#E5E5E5"> of</font>

259
00:09:48,440 --> 00:09:53,180
the<font color="#E5E5E5"> things we realize is sometimes we</font><font color="#CCCCCC"> we</font>

260
00:09:50,570 --> 00:09:55,700
were<font color="#CCCCCC"> too real with with our</font><font color="#E5E5E5"> CT and it</font>

261
00:09:53,180 --> 00:09:57,319
doesn't benefit the<font color="#CCCCCC"> defenders if they</font>

262
00:09:55,700 --> 00:09:59,210
can't if they can't catch<font color="#CCCCCC"> it are they</font>

263
00:09:57,320 --> 00:10:01,490
just<font color="#E5E5E5"> not aware of those techniques other</font>

264
00:09:59,210 --> 00:10:03,740
times it's perceived as<font color="#E5E5E5"> not real enough</font>

265
00:10:01,490 --> 00:10:06,200
<font color="#E5E5E5">so you know you've got</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> find a healthy</font>

266
00:10:03,740 --> 00:10:08,540
<font color="#E5E5E5">balance there for the for the sock team</font>

267
00:10:06,200 --> 00:10:09,920
that<font color="#E5E5E5"> really to really feel like they got</font>

268
00:10:08,540 --> 00:10:11,839
something<font color="#CCCCCC"> out of it</font>

269
00:10:09,920 --> 00:10:14,180
<font color="#E5E5E5">and then you know not not to be negative</font>

270
00:10:11,840 --> 00:10:17,750
<font color="#E5E5E5">here the sock may or may not care</font><font color="#CCCCCC"> so it</font>

271
00:10:14,180 --> 00:10:19,489
<font color="#E5E5E5">may be MSSP</font><font color="#CCCCCC"> it may be a contracted red</font>

272
00:10:17,750 --> 00:10:21,350
team that doesn't<font color="#E5E5E5"> belong to excuse me</font>

273
00:10:19,490 --> 00:10:24,020
contract a sock team that doesn't<font color="#E5E5E5"> belong</font>

274
00:10:21,350 --> 00:10:26,300
to<font color="#E5E5E5"> that organization or they're just</font>

275
00:10:24,020 --> 00:10:28,040
<font color="#E5E5E5">being pummeled with tickets and</font><font color="#CCCCCC"> alert</font>

276
00:10:26,300 --> 00:10:29,959
triage<font color="#E5E5E5"> that they just can't</font><font color="#CCCCCC"> participate</font>

277
00:10:28,040 --> 00:10:32,719
<font color="#E5E5E5">any engagement they're just waiting for</font>

278
00:10:29,960 --> 00:10:34,760
the<font color="#E5E5E5"> aftermath of the engagement another</font>

279
00:10:32,720 --> 00:10:37,160
thing is<font color="#CCCCCC"> sometimes use malware you know</font>

280
00:10:34,760 --> 00:10:39,650
you want to<font color="#E5E5E5"> use malware disk</font><font color="#CCCCCC"> it instills</font>

281
00:10:37,160 --> 00:10:41,900
confidence in your the client that

282
00:10:39,650 --> 00:10:44,630
<font color="#E5E5E5">you're working with so</font><font color="#CCCCCC"> we have defamed</font>

283
00:10:41,900 --> 00:10:46,819
malware that<font color="#E5E5E5"> we used</font><font color="#CCCCCC"> so we're building</font>

284
00:10:44,630 --> 00:10:49,850
<font color="#E5E5E5">these emulation is based off of you know</font>

285
00:10:46,820 --> 00:10:51,230
Intel reporting that<font color="#E5E5E5"> has occurred</font><font color="#CCCCCC"> one</font>

286
00:10:49,850 --> 00:10:53,150
thing you don't want<font color="#CCCCCC"> to do there in</font>

287
00:10:51,230 --> 00:10:57,020
these engagements is focus on the

288
00:10:53,150 --> 00:10:59,150
<font color="#E5E5E5">minutiae so you know my security</font>

289
00:10:57,020 --> 00:11:00,890
controls will detect within this beacon

290
00:10:59,150 --> 00:11:03,350
interval<font color="#E5E5E5"> and with this amount of jitter</font>

291
00:11:00,890 --> 00:11:05,649
<font color="#E5E5E5">and you know this amount of subdomain</font>

292
00:11:03,350 --> 00:11:08,349
label queries of

293
00:11:05,649 --> 00:11:10,569
and in bike shedding this is once to do

294
00:11:08,349 --> 00:11:11,859
<font color="#E5E5E5">kind of turn me on to with developers so</font>

295
00:11:10,569 --> 00:11:13,449
you know you're buying<font color="#E5E5E5"> a mansion but</font>

296
00:11:11,859 --> 00:11:16,299
you're worried about the the color of

297
00:11:13,449 --> 00:11:17,769
the bike shed that's it's a being built

298
00:11:16,299 --> 00:11:19,269
<font color="#E5E5E5">next to it you know</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> that's not</font>

299
00:11:17,769 --> 00:11:21,249
really what the<font color="#E5E5E5"> goal of</font><font color="#CCCCCC"> this is you're</font>

300
00:11:19,269 --> 00:11:22,929
<font color="#E5E5E5">trying to focus on the little</font><font color="#CCCCCC"> things and</font>

301
00:11:21,249 --> 00:11:26,229
see<font color="#E5E5E5"> how</font><font color="#CCCCCC"> your security</font><font color="#E5E5E5"> control with</font>

302
00:11:22,929 --> 00:11:27,608
security controls work<font color="#E5E5E5"> so avoiding the</font>

303
00:11:26,229 --> 00:11:29,049
bad days we've all had them<font color="#CCCCCC"> no matter</font>

304
00:11:27,609 --> 00:11:31,629
<font color="#E5E5E5">how well you plan you're still going to</font>

305
00:11:29,049 --> 00:11:33,779
have them<font color="#E5E5E5"> so we definitely run</font>

306
00:11:31,629 --> 00:11:36,099
everything<font color="#E5E5E5"> prior</font><font color="#CCCCCC"> to an engagement</font>

307
00:11:33,779 --> 00:11:38,199
<font color="#E5E5E5">generally we have</font><font color="#CCCCCC"> a we have a pretty</font>

308
00:11:36,099 --> 00:11:40,569
robust testing infrastructure<font color="#CCCCCC"> we also</font>

309
00:11:38,199 --> 00:11:42,098
are contracted with<font color="#E5E5E5"> a company called sim</font>

310
00:11:40,569 --> 00:11:44,858
space it provides us a really nice

311
00:11:42,099 --> 00:11:46,329
<font color="#E5E5E5">training environment so nothing we</font>

312
00:11:44,859 --> 00:11:47,739
detonate everything before you go to a

313
00:11:46,329 --> 00:11:49,598
customer<font color="#CCCCCC"> size we kind of know what</font>

314
00:11:47,739 --> 00:11:51,189
security controls how they'll react we

315
00:11:49,599 --> 00:11:54,669
know what<font color="#E5E5E5"> our stuff</font><font color="#CCCCCC"> looks like</font><font color="#E5E5E5"> looks</font>

316
00:11:51,189 --> 00:11:56,978
like<font color="#E5E5E5"> on the wire before we go and we</font><font color="#CCCCCC"> try</font>

317
00:11:54,669 --> 00:11:58,419
to keep it as simple<font color="#E5E5E5"> as possible</font><font color="#CCCCCC"> but at</font>

318
00:11:56,979 --> 00:12:00,819
the<font color="#CCCCCC"> end of day we're</font><font color="#E5E5E5"> still in we're</font>

319
00:11:58,419 --> 00:12:04,629
trying to emulate characteristics of you

320
00:12:00,819 --> 00:12:07,659
know advanced<font color="#E5E5E5"> threats</font><font color="#CCCCCC"> clear written</font>

321
00:12:04,629 --> 00:12:09,220
scope of testing so<font color="#CCCCCC"> often times you can</font>

322
00:12:07,659 --> 00:12:11,049
go in and do<font color="#E5E5E5"> something very</font><font color="#CCCCCC"> complex and</font>

323
00:12:09,220 --> 00:12:13,389
it's kind of<font color="#CCCCCC"> it's kind of out of bounds</font>

324
00:12:11,049 --> 00:12:16,839
so we you know we we we separate this

325
00:12:13,389 --> 00:12:18,459
from<font color="#E5E5E5"> like full spectrum red teaming</font><font color="#CCCCCC"> and</font>

326
00:12:16,839 --> 00:12:19,569
then communicating<font color="#E5E5E5"> your infrastructure</font>

327
00:12:18,459 --> 00:12:21,789
<font color="#E5E5E5">ahead of time telling your customers</font>

328
00:12:19,569 --> 00:12:23,889
<font color="#CCCCCC">your clients</font><font color="#E5E5E5"> what exactly does your</font>

329
00:12:21,789 --> 00:12:26,109
infrastructure look like where is their

330
00:12:23,889 --> 00:12:28,479
data<font color="#E5E5E5"> going how is it encrypted at rest</font>

331
00:12:26,109 --> 00:12:30,999
and in transit<font color="#CCCCCC"> especially if you're</font>

332
00:12:28,479 --> 00:12:33,100
doing<font color="#E5E5E5"> any type</font><font color="#CCCCCC"> of exfil so communicating</font>

333
00:12:30,999 --> 00:12:34,779
<font color="#E5E5E5">that ahead</font><font color="#CCCCCC"> of time is really pay</font>

334
00:12:33,100 --> 00:12:36,369
dividends for<font color="#CCCCCC"> us it's you know it's</font>

335
00:12:34,779 --> 00:12:38,319
pretty pretty<font color="#E5E5E5"> wide open</font><font color="#CCCCCC"> when you're</font>

336
00:12:36,369 --> 00:12:41,079
talking<font color="#CCCCCC"> to a particular client</font><font color="#E5E5E5"> on this</font>

337
00:12:38,319 --> 00:12:43,839
and then having<font color="#E5E5E5"> everyone know what's</font>

338
00:12:41,079 --> 00:12:47,049
going<font color="#E5E5E5"> on so we see that some of the the</font>

339
00:12:43,839 --> 00:12:49,299
<font color="#E5E5E5">the responsibilities of securing the</font>

340
00:12:47,049 --> 00:12:52,239
enterprise are so distributed for large

341
00:12:49,299 --> 00:12:54,639
fortune 500 fortune<font color="#CCCCCC"> 100's so it's good</font>

342
00:12:52,239 --> 00:12:56,619
<font color="#CCCCCC">to</font><font color="#E5E5E5"> try to bring everyone in</font><font color="#CCCCCC"> so to kind</font>

343
00:12:54,639 --> 00:12:58,359
of know what's going<font color="#E5E5E5"> on we ran into one</font>

344
00:12:56,619 --> 00:13:00,909
environment<font color="#E5E5E5"> where the proxy</font><font color="#CCCCCC"> was not</font>

345
00:12:58,359 --> 00:13:02,709
<font color="#E5E5E5">controlled at all by the sock or even</font>

346
00:13:00,909 --> 00:13:05,769
under the<font color="#E5E5E5"> site so as an IT team and it</font>

347
00:13:02,709 --> 00:13:07,748
<font color="#E5E5E5">took days to manipulate that proxy if</font>

348
00:13:05,769 --> 00:13:10,059
you need<font color="#CCCCCC"> to whitelist something so that</font>

349
00:13:07,749 --> 00:13:11,979
was very<font color="#CCCCCC"> difficult</font><font color="#E5E5E5"> to deal with one</font>

350
00:13:10,059 --> 00:13:13,600
<font color="#E5E5E5">thing we do I didn't I didn't bring it</font>

351
00:13:11,979 --> 00:13:15,149
<font color="#E5E5E5">up in the slide deck but we track</font>

352
00:13:13,600 --> 00:13:18,100
<font color="#E5E5E5">everything so we have source destination</font>

353
00:13:15,149 --> 00:13:19,059
<font color="#CCCCCC">we have the technique we're testing we</font>

354
00:13:18,100 --> 00:13:20,859
had in

355
00:13:19,059 --> 00:13:24,339
you know we have remarks that we leave

356
00:13:20,859 --> 00:13:26,619
<font color="#E5E5E5">behind</font><font color="#CCCCCC"> and we provide that to the client</font>

357
00:13:24,339 --> 00:13:28,599
it's basically an entire list of IOC s

358
00:13:26,619 --> 00:13:30,519
they get based off off<font color="#CCCCCC"> based off</font><font color="#E5E5E5"> the</font>

359
00:13:28,599 --> 00:13:37,119
traffic<font color="#E5E5E5"> that we've generated</font><font color="#CCCCCC"> in their</font>

360
00:13:30,519 --> 00:13:38,799
environment<font color="#CCCCCC"> so for planning</font><font color="#E5E5E5"> our goal</font>

361
00:13:37,119 --> 00:13:41,289
here<font color="#E5E5E5"> isn't to test every single security</font>

362
00:13:38,799 --> 00:13:43,959
control<font color="#CCCCCC"> it's the tested a very specific</font>

363
00:13:41,289 --> 00:13:46,149
<font color="#E5E5E5">technique or you know it with the</font><font color="#CCCCCC"> rise</font>

364
00:13:43,959 --> 00:13:48,429
of behavioral analytics is to focus on a

365
00:13:46,149 --> 00:13:51,039
particular analytic<font color="#E5E5E5"> just to say you have</font>

366
00:13:48,429 --> 00:13:53,098
<font color="#E5E5E5">that analytics beaconing or our domain</font>

367
00:13:51,039 --> 00:13:56,559
generation algorithm or any kind of<font color="#CCCCCC"> c2</font>

368
00:13:53,099 --> 00:13:58,419
<font color="#E5E5E5">over DNS do you know have you</font><font color="#CCCCCC"> tried</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> I</font>

369
00:13:56,559 --> 00:14:00,429
know most socks<font color="#E5E5E5"> don't really have the</font>

370
00:13:58,419 --> 00:14:02,978
ability<font color="#CCCCCC"> to try all those things</font><font color="#E5E5E5"> they</font>

371
00:14:00,429 --> 00:14:05,199
<font color="#E5E5E5">probably have to rely on a red team and</font>

372
00:14:02,979 --> 00:14:06,759
most red teams are<font color="#E5E5E5"> using pre-canned</font>

373
00:14:05,199 --> 00:14:08,258
tools<font color="#E5E5E5"> every now and then some of the</font>

374
00:14:06,759 --> 00:14:10,449
<font color="#E5E5E5">really advanced ones develop their own</font>

375
00:14:08,259 --> 00:14:12,999
<font color="#E5E5E5">but a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> those tools don't get</font>

376
00:14:10,449 --> 00:14:16,358
brought<font color="#E5E5E5"> to every</font><font color="#CCCCCC"> engagement</font><font color="#E5E5E5"> like I said</font>

377
00:14:12,999 --> 00:14:18,789
at least<font color="#CCCCCC"> path the resistance</font><font color="#E5E5E5"> again we</font>

378
00:14:16,359 --> 00:14:21,939
mentioned appropriate the appropriate

379
00:14:18,789 --> 00:14:24,039
personnel being informed<font color="#E5E5E5"> and then we we</font>

380
00:14:21,939 --> 00:14:25,659
generally have a menu<font color="#CCCCCC"> of items</font><font color="#E5E5E5"> that we</font>

381
00:14:24,039 --> 00:14:27,968
know we're<font color="#E5E5E5"> going to emulate before we</font>

382
00:14:25,659 --> 00:14:30,789
<font color="#E5E5E5">arrive</font><font color="#CCCCCC"> we know exactly what tool we're</font>

383
00:14:27,969 --> 00:14:34,749
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> use we generally provide the</font>

384
00:14:30,789 --> 00:14:37,179
client<font color="#CCCCCC"> a list of emulations will run at</font>

385
00:14:34,749 --> 00:14:40,419
specific times from<font color="#E5E5E5"> in brief all the way</font>

386
00:14:37,179 --> 00:14:41,799
to out brief and final<font color="#E5E5E5"> report and</font><font color="#CCCCCC"> then</font>

387
00:14:40,419 --> 00:14:43,718
we tell them why we're going<font color="#E5E5E5"> to use it</font>

388
00:14:41,799 --> 00:14:46,509
like if we have a certain<font color="#E5E5E5"> emulation as</font>

389
00:14:43,719 --> 00:14:48,819
it's been developed<font color="#E5E5E5"> we generally try to</font>

390
00:14:46,509 --> 00:14:50,619
map it<font color="#CCCCCC"> back to a known threat</font><font color="#E5E5E5"> so we're</font>

391
00:14:48,819 --> 00:14:52,329
not<font color="#CCCCCC"> just coming in here to</font><font color="#E5E5E5"> show</font><font color="#CCCCCC"> off</font><font color="#E5E5E5"> the</font>

392
00:14:50,619 --> 00:14:54,189
<font color="#CCCCCC">weakened code</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> that we can create</font>

393
00:14:52,329 --> 00:14:57,549
emulation it's more like hey this<font color="#E5E5E5"> is</font>

394
00:14:54,189 --> 00:14:59,439
<font color="#E5E5E5">realistic apt such-and-such use this apt</font>

395
00:14:57,549 --> 00:15:00,939
such<font color="#E5E5E5"> as</font><font color="#CCCCCC"> ice use that and they if you</font>

396
00:14:59,439 --> 00:15:04,149
<font color="#CCCCCC">can't detect these you're probably not</font>

397
00:15:00,939 --> 00:15:06,819
going to<font color="#E5E5E5"> tech other other threats</font><font color="#CCCCCC"> and</font>

398
00:15:04,149 --> 00:15:08,169
then obviously<font color="#E5E5E5"> written permission</font><font color="#CCCCCC"> this</font>

399
00:15:06,819 --> 00:15:10,329
<font color="#E5E5E5">kind of goes without saying</font><font color="#CCCCCC"> but I've</font>

400
00:15:08,169 --> 00:15:12,189
seen I've seen going to engagement<font color="#CCCCCC"> where</font>

401
00:15:10,329 --> 00:15:14,049
the right person wasn't<font color="#CCCCCC"> involved from</font>

402
00:15:12,189 --> 00:15:18,429
<font color="#E5E5E5">start</font><font color="#CCCCCC"> to finish and then they show up</font>

403
00:15:14,049 --> 00:15:19,899
<font color="#E5E5E5">when you show up so just try you know</font>

404
00:15:18,429 --> 00:15:21,339
that's just<font color="#CCCCCC"> something you</font><font color="#E5E5E5"> have to work</font>

405
00:15:19,899 --> 00:15:23,289
<font color="#E5E5E5">through when it occurs but if if you</font>

406
00:15:21,339 --> 00:15:24,909
have that if<font color="#E5E5E5"> you kind of understand</font>

407
00:15:23,289 --> 00:15:28,689
their<font color="#E5E5E5"> work chart</font><font color="#CCCCCC"> before you are going it</font>

408
00:15:24,909 --> 00:15:30,310
<font color="#E5E5E5">is very helpful so gotchas we've always</font>

409
00:15:28,689 --> 00:15:33,639
had gotchas

410
00:15:30,310 --> 00:15:36,790
so you know we we generally look across

411
00:15:33,639 --> 00:15:38,490
<font color="#E5E5E5">a different a V and in proxy vendors and</font>

412
00:15:36,790 --> 00:15:41,589
say hey you know how are they

413
00:15:38,490 --> 00:15:43,180
categorized in our domains<font color="#CCCCCC"> what is the</font>

414
00:15:41,589 --> 00:15:45,610
threat what does the reputation<font color="#E5E5E5"> of</font><font color="#CCCCCC"> our</font>

415
00:15:43,180 --> 00:15:48,040
domains look like you know we query

416
00:15:45,610 --> 00:15:50,649
domain tools for<font color="#CCCCCC"> all our domains and</font><font color="#E5E5E5"> we</font>

417
00:15:48,040 --> 00:15:51,969
<font color="#E5E5E5">constantly try to have them parked</font><font color="#CCCCCC"> you</font>

418
00:15:50,649 --> 00:15:55,569
know with where they're getting<font color="#E5E5E5"> whether</font>

419
00:15:51,970 --> 00:15:58,329
they're not truly parked foot<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it</font>

420
00:15:55,569 --> 00:16:01,029
<font color="#E5E5E5">having a plan B that's actually been</font>

421
00:15:58,329 --> 00:16:03,219
tested<font color="#CCCCCC"> so I'll discuss that here</font><font color="#E5E5E5"> in a</font>

422
00:16:01,029 --> 00:16:04,779
<font color="#CCCCCC">moment the</font><font color="#E5E5E5"> other thing is don't leave</font>

423
00:16:03,220 --> 00:16:06,879
<font color="#E5E5E5">your devs out of reach fortunately for</font>

424
00:16:04,779 --> 00:16:08,170
me I have a really<font color="#E5E5E5"> good dev on a couple</font>

425
00:16:06,879 --> 00:16:12,279
of really good devs on the team so

426
00:16:08,170 --> 00:16:16,748
<font color="#E5E5E5">they're never really left out next</font><font color="#CCCCCC"> is</font>

427
00:16:12,279 --> 00:16:18,699
make<font color="#E5E5E5"> platform agnostic tools so you</font><font color="#CCCCCC"> know</font>

428
00:16:16,749 --> 00:16:21,759
we agree<font color="#CCCCCC"> upon a lot of things in</font>

429
00:16:18,699 --> 00:16:24,189
statements to work with with clients but

430
00:16:21,759 --> 00:16:27,129
when you<font color="#E5E5E5"> get there you may get handed a</font>

431
00:16:24,189 --> 00:16:28,569
different OS<font color="#CCCCCC"> maybe it's Linux</font><font color="#E5E5E5"> maybe it's</font>

432
00:16:27,129 --> 00:16:30,519
a VM you<font color="#E5E5E5"> brought with you maybe it's</font>

433
00:16:28,569 --> 00:16:32,680
your own machine maybe<font color="#E5E5E5"> it's a victim</font>

434
00:16:30,519 --> 00:16:38,860
they identified for you<font color="#CCCCCC"> so we try to</font>

435
00:16:32,680 --> 00:16:41,859
<font color="#E5E5E5">make platform agnostic tools so I was</font>

436
00:16:38,860 --> 00:16:44,110
<font color="#E5E5E5">talking about a fortune 100 earlier</font><font color="#CCCCCC"> you</font>

437
00:16:41,860 --> 00:16:45,910
know this this organization<font color="#E5E5E5"> is large</font>

438
00:16:44,110 --> 00:16:49,360
<font color="#E5E5E5">pharmaceutical they had every security</font>

439
00:16:45,910 --> 00:16:51,189
<font color="#E5E5E5">product that you</font><font color="#CCCCCC"> can imagine several EDR</font>

440
00:16:49,360 --> 00:16:53,649
solutions on the<font color="#E5E5E5"> endpoint</font><font color="#CCCCCC"> they had a</font>

441
00:16:51,189 --> 00:16:55,750
<font color="#E5E5E5">manís service provider providing</font>

442
00:16:53,649 --> 00:16:57,730
overwatch who was pretty sophisticated

443
00:16:55,750 --> 00:17:00,069
<font color="#E5E5E5">they had a fusion cell they had a sock</font>

444
00:16:57,730 --> 00:17:01,209
and then he had a<font color="#E5E5E5"> security team within</font>

445
00:17:00,069 --> 00:17:04,240
their IT team which<font color="#E5E5E5"> is pretty</font>

446
00:17:01,209 --> 00:17:05,980
<font color="#E5E5E5">interesting and he had you know they've</font>

447
00:17:04,240 --> 00:17:08,230
they pretty much participated in the

448
00:17:05,980 --> 00:17:10,089
exercise<font color="#E5E5E5"> so we agreed we've deployed</font>

449
00:17:08,230 --> 00:17:12,159
them a<font color="#CCCCCC"> vm because they said absolutely</font>

450
00:17:10,089 --> 00:17:14,829
<font color="#CCCCCC">not you're not bringing in your laptops</font>

451
00:17:12,159 --> 00:17:18,159
<font color="#CCCCCC">that's just not that that</font><font color="#E5E5E5"> bypasses all</font>

452
00:17:14,829 --> 00:17:20,319
of our policies and<font color="#E5E5E5"> that just that's a</font>

453
00:17:18,159 --> 00:17:23,799
huge<font color="#CCCCCC"> violation</font><font color="#E5E5E5"> but they would take a</font><font color="#CCCCCC"> vm</font>

454
00:17:20,319 --> 00:17:25,750
so we pack us up<font color="#E5E5E5"> a</font><font color="#CCCCCC"> vm</font><font color="#E5E5E5"> had our framework</font>

455
00:17:23,799 --> 00:17:28,329
on it we sent it forward deployed in

456
00:17:25,750 --> 00:17:31,539
their hypervisor<font color="#E5E5E5"> gave us SSH access to</font>

457
00:17:28,329 --> 00:17:36,309
it then the victim they provide us<font color="#E5E5E5"> gave</font>

458
00:17:31,539 --> 00:17:37,750
us<font color="#E5E5E5"> gave</font><font color="#CCCCCC"> us RDP access to that victim so</font>

459
00:17:36,309 --> 00:17:42,010
that was pretty<font color="#E5E5E5"> interesting pushing</font>

460
00:17:37,750 --> 00:17:43,420
tools over over to it<font color="#E5E5E5"> so we quickly we</font>

461
00:17:42,010 --> 00:17:45,280
quickly started<font color="#CCCCCC"> you know run</font>

462
00:17:43,420 --> 00:17:47,320
our tools off the victim they<font color="#CCCCCC"> provide us</font>

463
00:17:45,280 --> 00:17:49,600
<font color="#E5E5E5">but we continuously had to change up our</font>

464
00:17:47,320 --> 00:17:52,210
infrastructure<font color="#CCCCCC"> to match what was going</font>

465
00:17:49,600 --> 00:17:54,939
on on<font color="#CCCCCC"> this one</font><font color="#E5E5E5"> particular is interesting</font>

466
00:17:52,210 --> 00:17:58,180
they had a pretty<font color="#E5E5E5"> lockdown proxy but</font>

467
00:17:54,940 --> 00:17:59,830
like ml and<font color="#CCCCCC"> GA domains top-level domains</font>

468
00:17:58,180 --> 00:18:02,830
where we register them<font color="#E5E5E5"> on site that</font>

469
00:17:59,830 --> 00:18:04,870
morning<font color="#CCCCCC"> just to have spares and those</font>

470
00:18:02,830 --> 00:18:06,310
<font color="#E5E5E5">actually worked some of the more secure</font>

471
00:18:04,870 --> 00:18:07,810
ones some<font color="#CCCCCC"> of the more the ones that had</font>

472
00:18:06,310 --> 00:18:10,179
the<font color="#E5E5E5"> reputation actually didn't work</font><font color="#CCCCCC"> so</font>

473
00:18:07,810 --> 00:18:12,190
<font color="#CCCCCC">what I'm</font><font color="#E5E5E5"> seeing is if your domains</font>

474
00:18:10,180 --> 00:18:14,800
category if your<font color="#CCCCCC"> domain has got a good</font>

475
00:18:12,190 --> 00:18:17,250
reputation<font color="#CCCCCC"> generally it gets out if your</font>

476
00:18:14,800 --> 00:18:20,740
domains on<font color="#CCCCCC"> categorized maybe maybe not</font>

477
00:18:17,250 --> 00:18:22,420
<font color="#E5E5E5">so you know for the red</font><font color="#CCCCCC"> team's</font><font color="#E5E5E5"> I'm sure</font>

478
00:18:20,740 --> 00:18:23,860
it's pretty obvious but you<font color="#CCCCCC"> definitely</font>

479
00:18:22,420 --> 00:18:27,700
want to<font color="#CCCCCC"> look across that</font><font color="#E5E5E5"> before you show</font>

480
00:18:23,860 --> 00:18:30,100
up with their proxies one thing we

481
00:18:27,700 --> 00:18:32,860
<font color="#CCCCCC">notice here</font><font color="#E5E5E5"> as well there was some DNS</font>

482
00:18:30,100 --> 00:18:36,490
<font color="#CCCCCC">round-robin in our network so</font><font color="#E5E5E5"> every time</font>

483
00:18:32,860 --> 00:18:38,740
a query from from<font color="#E5E5E5"> our</font><font color="#CCCCCC"> c2 over DNS would</font>

484
00:18:36,490 --> 00:18:41,140
go out<font color="#E5E5E5"> like about every fifth every</font>

485
00:18:38,740 --> 00:18:44,260
fifth query would go to a different<font color="#E5E5E5"> DNS</font>

486
00:18:41,140 --> 00:18:45,460
server internally which is you<font color="#CCCCCC"> know for</font>

487
00:18:44,260 --> 00:18:47,410
the defenders in the<font color="#E5E5E5"> room</font><font color="#CCCCCC"> think about</font>

488
00:18:45,460 --> 00:18:49,810
the complexity<font color="#CCCCCC"> of that</font><font color="#E5E5E5"> we're trying to</font>

489
00:18:47,410 --> 00:18:51,310
<font color="#E5E5E5">use like a signature eyes tool or some</font>

490
00:18:49,810 --> 00:18:54,070
kind of behavioral analytics<font color="#E5E5E5"> that means</font>

491
00:18:51,310 --> 00:18:57,340
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> likely only</font><font color="#E5E5E5"> seeing every fourth</font>

492
00:18:54,070 --> 00:19:00,820
or fifth query or one in five queries

493
00:18:57,340 --> 00:19:01,689
<font color="#E5E5E5">maybe so you know they had to retune</font>

494
00:19:00,820 --> 00:19:04,030
<font color="#CCCCCC">that kind</font><font color="#E5E5E5"> of their gigamon</font>

495
00:19:01,690 --> 00:19:05,560
infrastructure<font color="#E5E5E5"> that to test that but no</font>

496
00:19:04,030 --> 00:19:07,600
one in their organization was really

497
00:19:05,560 --> 00:19:09,610
looking at<font color="#CCCCCC"> that so</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> could you could</font>

498
00:19:07,600 --> 00:19:11,980
exfil over DNS all day long<font color="#E5E5E5"> and it</font>

499
00:19:09,610 --> 00:19:13,389
wasn't<font color="#E5E5E5"> a problem</font><font color="#CCCCCC"> and for</font><font color="#E5E5E5"> the tools they</font>

500
00:19:11,980 --> 00:19:15,520
had internally<font color="#E5E5E5"> that would catch that</font>

501
00:19:13,390 --> 00:19:17,890
<font color="#E5E5E5">that just wasn't enough</font><font color="#CCCCCC"> Network</font>

502
00:19:15,520 --> 00:19:20,950
artifacts for<font color="#E5E5E5"> to trigger anything they</font>

503
00:19:17,890 --> 00:19:22,990
had in their environment<font color="#CCCCCC"> also</font><font color="#E5E5E5"> you know</font>

504
00:19:20,950 --> 00:19:24,820
if you know spanning a tapping

505
00:19:22,990 --> 00:19:26,980
infrastructure saturate or is filtering

506
00:19:24,820 --> 00:19:28,840
going on<font color="#E5E5E5"> if you're not catching like you</font>

507
00:19:26,980 --> 00:19:30,130
know if you<font color="#E5E5E5"> got a beacon is going every</font>

508
00:19:28,840 --> 00:19:32,889
<font color="#CCCCCC">ten minutes for</font><font color="#E5E5E5"> an hour that's six</font>

509
00:19:30,130 --> 00:19:36,370
beacons<font color="#CCCCCC"> inter-arrival six six beacons</font><font color="#E5E5E5"> in</font>

510
00:19:32,890 --> 00:19:38,830
arrival in an hour<font color="#CCCCCC"> if you have if you</font>

511
00:19:36,370 --> 00:19:40,510
<font color="#CCCCCC">had a bit of</font><font color="#E5E5E5"> sampling or</font><font color="#CCCCCC"> hour</font><font color="#E5E5E5"> saturation</font>

512
00:19:38,830 --> 00:19:41,919
and environment you probably you might

513
00:19:40,510 --> 00:19:43,629
get three or<font color="#CCCCCC"> four or five of those</font>

514
00:19:41,920 --> 00:19:45,310
beacons so not enough<font color="#E5E5E5"> to trigger</font>

515
00:19:43,630 --> 00:19:48,670
<font color="#E5E5E5">analytic maybe not enough to trigger a</font>

516
00:19:45,310 --> 00:19:52,690
sensor<font color="#E5E5E5"> so they also relied</font><font color="#CCCCCC"> we Level II</font>

517
00:19:48,670 --> 00:19:54,850
relied heavily on IDs and IPS signatures

518
00:19:52,690 --> 00:19:56,260
other than that traffic wise that was it

519
00:19:54,850 --> 00:19:57,158
so but didn't get caught on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> endpoint</font>

520
00:19:56,260 --> 00:20:00,700
<font color="#CCCCCC">the proxy</font>

521
00:19:57,159 --> 00:20:02,919
catch it and went out the<font color="#E5E5E5"> front door so</font>

522
00:20:00,700 --> 00:20:04,989
i'ma kick it over<font color="#E5E5E5"> Stu for a second well</font>

523
00:20:02,919 --> 00:20:07,090
for the<font color="#E5E5E5"> majority of the rest of the talk</font>

524
00:20:04,989 --> 00:20:10,509
to kind of go into how we do these<font color="#CCCCCC"> in</font>

525
00:20:07,090 --> 00:20:12,668
relations<font color="#E5E5E5"> so Stu primarily codes most of</font>

526
00:20:10,509 --> 00:20:14,950
our<font color="#E5E5E5"> in relations along with the rest</font><font color="#CCCCCC"> of</font>

527
00:20:12,669 --> 00:20:16,359
team but<font color="#CCCCCC"> and he's got some pretty</font>

528
00:20:14,950 --> 00:20:19,499
<font color="#E5E5E5">interesting things he'll share with you</font>

529
00:20:16,359 --> 00:20:19,499
so I'll kick it over to<font color="#E5E5E5"> him real quick</font>

530
00:20:23,370 --> 00:20:28,219
thank you sir

531
00:20:24,890 --> 00:20:30,530
hi I'm Stuart McMurray<font color="#E5E5E5"> I got all the</font>

532
00:20:28,220 --> 00:20:32,150
<font color="#E5E5E5">emulations so talk about</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> exactly we</font>

533
00:20:30,530 --> 00:20:33,980
mean when we say we run<font color="#E5E5E5"> an emulation and</font>

534
00:20:32,150 --> 00:20:35,000
a<font color="#E5E5E5"> client environment</font><font color="#CCCCCC"> and furthermore how</font>

535
00:20:33,980 --> 00:20:36,860
<font color="#CCCCCC">the</font><font color="#E5E5E5"> blue guys can run them without</font>

536
00:20:35,000 --> 00:20:38,900
having<font color="#CCCCCC"> to</font><font color="#E5E5E5"> involve a red team</font><font color="#CCCCCC"> pay</font><font color="#E5E5E5"> for a</font>

537
00:20:36,860 --> 00:20:41,479
red team<font color="#E5E5E5"> so what do you mean by an</font>

538
00:20:38,900 --> 00:20:42,470
emulation well<font color="#E5E5E5"> it's a thing that does a</font>

539
00:20:41,480 --> 00:20:44,210
<font color="#CCCCCC">thing</font>

540
00:20:42,470 --> 00:20:46,400
usually it's a program<font color="#CCCCCC"> there could be a</font>

541
00:20:44,210 --> 00:20:47,720
script<font color="#CCCCCC"> sometimes just like command we'll</font>

542
00:20:46,400 --> 00:20:49,580
see a couple<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those that we've run and</font>

543
00:20:47,720 --> 00:20:52,490
the idea is it does something hacker ish

544
00:20:49,580 --> 00:20:53,689
<font color="#E5E5E5">it make some some usually</font><font color="#CCCCCC"> Network but</font><font color="#E5E5E5"> no</font>

545
00:20:52,490 --> 00:20:57,169
<font color="#E5E5E5">reason we</font><font color="#CCCCCC"> couldn't do endpoint stuff and</font>

546
00:20:53,690 --> 00:21:00,380
we have as well<font color="#CCCCCC"> something that is</font><font color="#E5E5E5"> meant</font>

547
00:20:57,169 --> 00:21:03,250
to<font color="#E5E5E5"> trigger an alert or test the bounds</font>

548
00:21:00,380 --> 00:21:05,690
of a sensor<font color="#CCCCCC"> or a</font><font color="#E5E5E5"> EDR solution or whatnot</font>

549
00:21:03,250 --> 00:21:06,679
<font color="#E5E5E5">so broadly speaking with</font><font color="#CCCCCC"> Skol an</font>

550
00:21:05,690 --> 00:21:09,200
emulation

551
00:21:06,679 --> 00:21:11,240
they tend to be malware ish<font color="#CCCCCC"> a lot of</font>

552
00:21:09,200 --> 00:21:13,520
what we use could with minor tweaking be

553
00:21:11,240 --> 00:21:15,530
used actually<font color="#CCCCCC"> to have</font><font color="#E5E5E5"> C</font><font color="#CCCCCC"> 2</font><font color="#E5E5E5"> or actually do</font>

554
00:21:13,520 --> 00:21:17,090
have X<font color="#CCCCCC"> Vil but say it's no need to</font>

555
00:21:15,530 --> 00:21:18,678
introduce<font color="#E5E5E5"> risk we're not trying to prove</font>

556
00:21:17,090 --> 00:21:20,510
<font color="#E5E5E5">yeah we can get coms all the way in and</font>

557
00:21:18,679 --> 00:21:22,070
<font color="#E5E5E5">out that</font><font color="#CCCCCC"> we're trying</font><font color="#E5E5E5"> to say hey we're</font>

558
00:21:20,510 --> 00:21:23,990
where does our emulation we're<font color="#CCCCCC"> C's me</font>

559
00:21:22,070 --> 00:21:25,460
where does<font color="#E5E5E5"> our tool stop where does EDR</font>

560
00:21:23,990 --> 00:21:28,520
stop alerting<font color="#E5E5E5"> and start saying yeah</font>

561
00:21:25,460 --> 00:21:30,080
that's probably all right and then these

562
00:21:28,520 --> 00:21:31,610
are generally<font color="#E5E5E5"> much smaller in scope so</font>

563
00:21:30,080 --> 00:21:33,379
<font color="#CCCCCC">when I write</font><font color="#E5E5E5"> these I write them thinking</font>

564
00:21:31,610 --> 00:21:35,240
okay I'm gonna do<font color="#E5E5E5"> one thing and I'll put</font>

565
00:21:33,380 --> 00:21:36,679
it on<font color="#E5E5E5"> a box it'll run and I'll get a</font>

566
00:21:35,240 --> 00:21:38,570
result so I'm not thinking okay I got to

567
00:21:36,679 --> 00:21:39,860
deploy this<font color="#E5E5E5"> everywhere</font><font color="#CCCCCC"> I need to be able</font>

568
00:21:38,570 --> 00:21:42,260
<font color="#E5E5E5">to pass</font><font color="#CCCCCC"> a shell to that guy so it's very</font>

569
00:21:39,860 --> 00:21:42,770
very<font color="#E5E5E5"> small in scope also cheaper than</font>

570
00:21:42,260 --> 00:21:44,240
red teaming

571
00:21:42,770 --> 00:21:45,980
we found these<font color="#E5E5E5"> are actually pretty good</font>

572
00:21:44,240 --> 00:21:47,360
from a science point of<font color="#E5E5E5"> view from a hey</font>

573
00:21:45,980 --> 00:21:49,640
<font color="#E5E5E5">let's do some security research so not</font>

574
00:21:47,360 --> 00:21:51,139
<font color="#E5E5E5">only can we use them red or blue side we</font>

575
00:21:49,640 --> 00:21:52,940
can say hey yeah I'm testing this neat

576
00:21:51,140 --> 00:21:55,790
<font color="#CCCCCC">theory hey I want</font><font color="#E5E5E5"> to see I</font><font color="#CCCCCC"> found a</font>

577
00:21:52,940 --> 00:21:59,890
workaround for<font color="#E5E5E5"> this thing so it makes a</font>

578
00:21:55,790 --> 00:22:01,760
<font color="#E5E5E5">good</font><font color="#CCCCCC"> one first they have to</font><font color="#E5E5E5"> work so</font><font color="#CCCCCC"> that</font>

579
00:21:59,890 --> 00:22:03,350
<font color="#E5E5E5">don't work you don't get it very far</font>

580
00:22:01,760 --> 00:22:04,940
from<font color="#CCCCCC"> that</font><font color="#E5E5E5"> and then they have</font><font color="#CCCCCC"> to work</font>

581
00:22:03,350 --> 00:22:06,080
without<font color="#E5E5E5"> help from IT so Ken was</font>

582
00:22:04,940 --> 00:22:08,120
mentioning the one time we<font color="#E5E5E5"> tried to</font>

583
00:22:06,080 --> 00:22:10,909
<font color="#E5E5E5">deploy a VM we did to play the VM and</font>

584
00:22:08,120 --> 00:22:12,739
<font color="#CCCCCC">then IT was like yeah and</font><font color="#E5E5E5"> you actually</font>

585
00:22:10,910 --> 00:22:14,960
have<font color="#E5E5E5"> to go through</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> windows</font><font color="#CCCCCC"> in point</font>

586
00:22:12,740 --> 00:22:16,160
to get to<font color="#CCCCCC"> the VM and you got a Citrix</font>

587
00:22:14,960 --> 00:22:18,410
yourself to the<font color="#E5E5E5"> windows endpoint to get</font>

588
00:22:16,160 --> 00:22:21,530
to the VM and that that really<font color="#CCCCCC"> isn't</font>

589
00:22:18,410 --> 00:22:23,360
what we need<font color="#E5E5E5"> so yeah make</font><font color="#CCCCCC"> them make them</font>

590
00:22:21,530 --> 00:22:24,678
work without<font color="#CCCCCC"> eyeties help</font><font color="#E5E5E5"> it's also</font>

591
00:22:23,360 --> 00:22:25,668
means make sure<font color="#E5E5E5"> your domains don't need</font>

592
00:22:24,679 --> 00:22:28,520
white listing or maybe they do maybe

593
00:22:25,669 --> 00:22:30,200
that's what you're testing but generally

594
00:22:28,520 --> 00:22:32,210
the simpler<font color="#E5E5E5"> the better</font><font color="#CCCCCC"> also they don't</font>

595
00:22:30,200 --> 00:22:33,890
trip unintended defenses so if you're

596
00:22:32,210 --> 00:22:37,380
testing like hey do we see something

597
00:22:33,890 --> 00:22:39,150
<font color="#E5E5E5">that</font><font color="#CCCCCC"> makes</font><font color="#E5E5E5"> really long DNS queries</font>

598
00:22:37,380 --> 00:22:41,220
<font color="#E5E5E5">you write it you put on the box</font><font color="#CCCCCC"> AV flags</font>

599
00:22:39,150 --> 00:22:43,620
<font color="#CCCCCC">corn seams it</font><font color="#E5E5E5"> quarantines the box maybe</font>

600
00:22:41,220 --> 00:22:45,210
<font color="#E5E5E5">done that before</font><font color="#CCCCCC"> that you know you don't</font>

601
00:22:43,620 --> 00:22:46,679
<font color="#E5E5E5">actually you test your goal</font><font color="#CCCCCC"> you test</font>

602
00:22:45,210 --> 00:22:48,120
<font color="#CCCCCC">that something works you're not</font><font color="#E5E5E5"> testing</font>

603
00:22:46,680 --> 00:22:49,680
<font color="#CCCCCC">whether or</font><font color="#E5E5E5"> not the one defensive tool</font>

604
00:22:48,120 --> 00:22:52,590
you're trying to<font color="#E5E5E5"> work trying to work</font>

605
00:22:49,680 --> 00:22:54,630
with works<font color="#CCCCCC"> it's kind</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> luda to when we</font>

606
00:22:52,590 --> 00:22:57,270
went that that one<font color="#E5E5E5"> pharmaceutical</font>

607
00:22:54,630 --> 00:22:58,350
company you don't necessarily know what

608
00:22:57,270 --> 00:23:00,990
sort<font color="#E5E5E5"> of targets you're gonna run these</font>

609
00:22:58,350 --> 00:23:02,699
<font color="#CCCCCC">on</font><font color="#E5E5E5"> it sort of</font><font color="#CCCCCC"> endpoints we found we get</font>

610
00:23:00,990 --> 00:23:04,170
on<font color="#E5E5E5"> site you know the people in the</font>

611
00:23:02,700 --> 00:23:05,610
meetings planning meetings we're not

612
00:23:04,170 --> 00:23:07,320
<font color="#CCCCCC">necessarily the people who ought to</font><font color="#E5E5E5"> have</font>

613
00:23:05,610 --> 00:23:08,610
<font color="#CCCCCC">been in the planning</font><font color="#E5E5E5"> meetings and so</font>

614
00:23:07,320 --> 00:23:10,260
like no you can't do that

615
00:23:08,610 --> 00:23:11,879
who let you<font color="#E5E5E5"> do that here here's this one</font>

616
00:23:10,260 --> 00:23:14,730
box<font color="#CCCCCC"> you</font><font color="#E5E5E5"> get it's really</font><font color="#CCCCCC"> old hope you</font>

617
00:23:11,880 --> 00:23:16,080
have something<font color="#CCCCCC"> that</font><font color="#E5E5E5"> works so having</font>

618
00:23:14,730 --> 00:23:17,190
things<font color="#E5E5E5"> that generally work</font><font color="#CCCCCC"> everywhere</font>

619
00:23:16,080 --> 00:23:19,949
that<font color="#CCCCCC"> also means not</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

620
00:23:17,190 --> 00:23:22,980
dependencies<font color="#CCCCCC"> Ruby's a cool language ruby</font>

621
00:23:19,950 --> 00:23:25,560
<font color="#E5E5E5">gems are less cool so if you need like</font>

622
00:23:22,980 --> 00:23:29,070
<font color="#CCCCCC">this many dependencies maybe maybe</font><font color="#E5E5E5"> we</font>

623
00:23:25,560 --> 00:23:30,540
don't code like that<font color="#CCCCCC"> so we started</font><font color="#E5E5E5"> doing</font>

624
00:23:29,070 --> 00:23:31,980
<font color="#E5E5E5">these were like okay well</font><font color="#CCCCCC"> one you're</font>

625
00:23:30,540 --> 00:23:34,050
<font color="#E5E5E5">late bad guys will have domains that</font>

626
00:23:31,980 --> 00:23:36,510
look really<font color="#E5E5E5"> sneaky</font><font color="#CCCCCC"> we'll have Google</font>

627
00:23:34,050 --> 00:23:37,620
login code at UK<font color="#E5E5E5"> for example</font><font color="#CCCCCC"> ID please</font>

628
00:23:36,510 --> 00:23:40,110
don't go searching<font color="#CCCCCC"> for that that was</font><font color="#E5E5E5"> not</font>

629
00:23:37,620 --> 00:23:41,729
<font color="#E5E5E5">one of mine but we'll have things that</font>

630
00:23:40,110 --> 00:23:43,889
<font color="#CCCCCC">are you know</font><font color="#E5E5E5"> nobody's going</font><font color="#CCCCCC"> to see him</font>

631
00:23:41,730 --> 00:23:45,540
<font color="#E5E5E5">it really doesn't help in the sense that</font>

632
00:23:43,890 --> 00:23:46,950
you know<font color="#E5E5E5"> we'll get we'll get past our</font>

633
00:23:45,540 --> 00:23:48,870
tools or be caught by the<font color="#E5E5E5"> tools that</font>

634
00:23:46,950 --> 00:23:50,040
were meant to<font color="#E5E5E5"> be caught</font><font color="#CCCCCC"> by but going</font>

635
00:23:48,870 --> 00:23:51,239
back through it it's kind of hard<font color="#CCCCCC"> to</font>

636
00:23:50,040 --> 00:23:52,649
look<font color="#E5E5E5"> it's like you know if you're not</font>

637
00:23:51,240 --> 00:23:54,120
<font color="#E5E5E5">paying attention Google with a</font><font color="#CCCCCC"> 1 instead</font>

638
00:23:52,650 --> 00:23:56,220
<font color="#CCCCCC">of now looks enough like Google you'll</font>

639
00:23:54,120 --> 00:23:57,629
miss it<font color="#E5E5E5"> and that's happened so instead</font>

640
00:23:56,220 --> 00:23:59,820
<font color="#CCCCCC">of things like</font><font color="#E5E5E5"> that register things like</font>

641
00:23:57,630 --> 00:24:01,620
I love<font color="#CCCCCC"> kittens</font><font color="#E5E5E5"> calm really long really</font>

642
00:23:59,820 --> 00:24:03,899
visible probably not<font color="#E5E5E5"> actually used by</font>

643
00:24:01,620 --> 00:24:05,790
somebody malicious these tend to be

644
00:24:03,900 --> 00:24:07,200
cheap<font color="#E5E5E5"> especially</font><font color="#CCCCCC"> if it's blue team</font>

645
00:24:05,790 --> 00:24:09,389
<font color="#E5E5E5">joining these things you probably have</font>

646
00:24:07,200 --> 00:24:10,590
actual<font color="#E5E5E5"> defense to do and for something</font>

647
00:24:09,390 --> 00:24:12,810
you're<font color="#E5E5E5"> going to run for 5-10 minutes</font>

648
00:24:10,590 --> 00:24:14,220
<font color="#CCCCCC">maybe</font><font color="#E5E5E5"> to test a thing you really don't</font>

649
00:24:12,810 --> 00:24:17,790
want to<font color="#CCCCCC"> spend a week of dev time on it</font>

650
00:24:14,220 --> 00:24:20,460
so<font color="#E5E5E5"> you know simple cheap not not hugely</font>

651
00:24:17,790 --> 00:24:23,540
complex<font color="#CCCCCC"> and then finally credibility</font><font color="#E5E5E5"> for</font>

652
00:24:20,460 --> 00:24:26,460
<font color="#E5E5E5">these we will go we'll</font><font color="#CCCCCC"> run these</font><font color="#E5E5E5"> and</font>

653
00:24:23,540 --> 00:24:28,110
almost all the<font color="#CCCCCC"> time we get</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> yeah but</font>

654
00:24:26,460 --> 00:24:29,460
you know that<font color="#E5E5E5"> wasn't real</font><font color="#CCCCCC"> malice</font><font color="#E5E5E5"> it were</font>

655
00:24:28,110 --> 00:24:31,260
real malware we would have caught it<font color="#CCCCCC"> and</font>

656
00:24:29,460 --> 00:24:33,450
you have to<font color="#E5E5E5"> have some way</font><font color="#CCCCCC"> of saying well</font>

657
00:24:31,260 --> 00:24:34,500
actually<font color="#E5E5E5"> yeah just let me change this it</font>

658
00:24:33,450 --> 00:24:36,150
could<font color="#E5E5E5"> be we're not</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to do that for</font>

659
00:24:34,500 --> 00:24:37,260
<font color="#E5E5E5">you because we don't need to put you at</font>

660
00:24:36,150 --> 00:24:39,150
any more<font color="#E5E5E5"> risk than you are but</font>

661
00:24:37,260 --> 00:24:41,400
credibility is<font color="#E5E5E5"> a actually a pretty</font>

662
00:24:39,150 --> 00:24:42,780
important part<font color="#E5E5E5"> of this my secret weapon</font>

663
00:24:41,400 --> 00:24:44,940
<font color="#CCCCCC">for all the above is go the programming</font>

664
00:24:42,780 --> 00:24:46,649
language<font color="#CCCCCC"> it's quite</font><font color="#E5E5E5"> easy to learn quite</font>

665
00:24:44,940 --> 00:24:47,830
easy to<font color="#E5E5E5"> use and it compiles for just</font>

666
00:24:46,650 --> 00:24:51,039
about everything you're going<font color="#E5E5E5"> to find</font>

667
00:24:47,830 --> 00:24:53,918
in an environment<font color="#CCCCCC"> mainframes actions</font>

668
00:24:51,039 --> 00:24:55,809
mainframe target<font color="#E5E5E5"> so I encourage anybody</font>

669
00:24:53,919 --> 00:24:58,299
who's going<font color="#E5E5E5"> to run these two to look</font>

670
00:24:55,809 --> 00:25:00,789
into it<font color="#E5E5E5"> so a few</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> that have</font>

671
00:24:58,299 --> 00:25:02,610
<font color="#E5E5E5">learned doing these as far as especially</font>

672
00:25:00,789 --> 00:25:04,960
safely<font color="#E5E5E5"> but just coding these in general</font>

673
00:25:02,610 --> 00:25:06,340
<font color="#E5E5E5">it works a lot better</font><font color="#CCCCCC"> if um relations do</font>

674
00:25:04,960 --> 00:25:07,630
one thing and<font color="#E5E5E5"> do</font><font color="#CCCCCC"> it well</font>

675
00:25:06,340 --> 00:25:09,340
when we started we had<font color="#CCCCCC"> this really</font><font color="#E5E5E5"> great</font>

676
00:25:07,630 --> 00:25:11,919
large framework<font color="#E5E5E5"> it had everything you</font>

677
00:25:09,340 --> 00:25:13,178
could<font color="#CCCCCC"> possibly</font><font color="#E5E5E5"> want built in and it had</font>

678
00:25:11,919 --> 00:25:16,779
every bug you could possibly want also

679
00:25:13,179 --> 00:25:18,580
<font color="#E5E5E5">built in so learn quickly okay we'll</font>

680
00:25:16,779 --> 00:25:20,559
<font color="#E5E5E5">just write one tool</font><font color="#CCCCCC"> to do one thing</font><font color="#E5E5E5"> to</font>

681
00:25:18,580 --> 00:25:22,629
test one thing<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we'll write one tool</font>

682
00:25:20,559 --> 00:25:25,090
<font color="#E5E5E5">to just make HTTP beacons over and over</font>

683
00:25:22,630 --> 00:25:27,220
<font color="#CCCCCC">alright one tool to emulate Zbot</font><font color="#E5E5E5"> our</font>

684
00:25:25,090 --> 00:25:29,139
<font color="#E5E5E5">Zeus you know and it</font><font color="#CCCCCC"> actually works</font>

685
00:25:27,220 --> 00:25:30,669
<font color="#CCCCCC">pretty good that way another thing</font><font color="#E5E5E5"> I've</font>

686
00:25:29,139 --> 00:25:32,590
learned<font color="#E5E5E5"> is to handle text streams so</font>

687
00:25:30,669 --> 00:25:34,450
it's really easy output JSON<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

688
00:25:32,590 --> 00:25:35,799
read JSON into<font color="#E5E5E5"> your sim spunk loves JSON</font>

689
00:25:34,450 --> 00:25:37,779
<font color="#CCCCCC">till you actually</font><font color="#E5E5E5"> have to grab something</font>

690
00:25:35,799 --> 00:25:38,860
<font color="#CCCCCC">out of it until like spunk isn't doing</font>

691
00:25:37,779 --> 00:25:40,960
quite what you need names<font color="#E5E5E5"> like let me</font>

692
00:25:38,860 --> 00:25:42,070
grab<font color="#E5E5E5"> text dreams tend to work and it's</font>

693
00:25:40,960 --> 00:25:44,080
<font color="#E5E5E5">real easy to write something to convert</font>

694
00:25:42,070 --> 00:25:48,399
that into<font color="#E5E5E5"> whatever format you'd like to</font>

695
00:25:44,080 --> 00:25:50,110
use with safety<font color="#E5E5E5"> comes readability and</font>

696
00:25:48,399 --> 00:25:51,908
maintainability they go<font color="#CCCCCC"> hand-in-hand and</font>

697
00:25:50,110 --> 00:25:53,860
this comes usually later<font color="#E5E5E5"> when you say</font>

698
00:25:51,909 --> 00:25:56,260
<font color="#E5E5E5">hand turn um make this thing do this</font>

699
00:25:53,860 --> 00:25:57,908
thing and<font color="#E5E5E5"> the intern is</font><font color="#CCCCCC"> like I can't</font>

700
00:25:56,260 --> 00:25:59,408
really<font color="#E5E5E5"> read this but I</font><font color="#CCCCCC"> think here's</font>

701
00:25:57,909 --> 00:26:01,419
<font color="#E5E5E5">where I need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> change it</font><font color="#CCCCCC"> you forgot</font><font color="#E5E5E5"> to</font>

702
00:25:59,409 --> 00:26:02,830
mention that<font color="#E5E5E5"> that affects that and that</font>

703
00:26:01,419 --> 00:26:04,149
affects that so readability

704
00:26:02,830 --> 00:26:06,340
maintainability just good general

705
00:26:04,149 --> 00:26:07,750
<font color="#CCCCCC">software engineering principles go a</font>

706
00:26:06,340 --> 00:26:11,889
long way to make these<font color="#E5E5E5"> safe and just to</font>

707
00:26:07,750 --> 00:26:13,570
work well<font color="#E5E5E5"> testing is important if you</font>

708
00:26:11,889 --> 00:26:16,389
don't test you never know what you're

709
00:26:13,570 --> 00:26:17,620
going<font color="#CCCCCC"> to come into</font><font color="#E5E5E5"> and speaking</font><font color="#CCCCCC"> testing</font>

710
00:26:16,389 --> 00:26:19,899
<font color="#E5E5E5">the unexpected things the last bullet</font>

711
00:26:17,620 --> 00:26:21,250
expect the unexpected<font color="#CCCCCC"> hey your malware</font>

712
00:26:19,899 --> 00:26:24,000
<font color="#E5E5E5">is still running I don't</font><font color="#CCCCCC"> know we kill</font>

713
00:26:21,250 --> 00:26:26,889
standard out but<font color="#CCCCCC"> it's still</font><font color="#E5E5E5"> running so</font>

714
00:26:24,000 --> 00:26:28,840
testing<font color="#E5E5E5"> typically you have</font><font color="#CCCCCC"> to test these</font>

715
00:26:26,889 --> 00:26:30,189
to a point<font color="#E5E5E5"> you're never quite sure</font>

716
00:26:28,840 --> 00:26:31,809
because<font color="#E5E5E5"> you know it's not running in the</font>

717
00:26:30,190 --> 00:26:34,929
exact target<font color="#E5E5E5"> environment but testing as</font>

718
00:26:31,809 --> 00:26:37,059
much as you can<font color="#E5E5E5"> is very important so I</font>

719
00:26:34,929 --> 00:26:38,470
could go over<font color="#E5E5E5"> a couple of the emulations</font>

720
00:26:37,059 --> 00:26:40,779
themselves around<font color="#E5E5E5"> a couple of specific</font>

721
00:26:38,470 --> 00:26:44,200
tools both<font color="#E5E5E5"> of these are publicly</font>

722
00:26:40,779 --> 00:26:46,179
<font color="#CCCCCC">available</font><font color="#E5E5E5"> both worked pretty well so the</font>

723
00:26:44,200 --> 00:26:48,070
<font color="#E5E5E5">first one is DNS botnet actually wrote</font>

724
00:26:46,179 --> 00:26:49,600
DNS botnet originally for a<font color="#CCCCCC"> CCDC</font><font color="#E5E5E5"> the</font>

725
00:26:48,070 --> 00:26:51,428
defense competition<font color="#CCCCCC"> took me a couple</font>

726
00:26:49,600 --> 00:26:52,870
nights<font color="#CCCCCC"> I had the</font><font color="#E5E5E5"> problem in the</font>

727
00:26:51,429 --> 00:26:55,510
competition<font color="#CCCCCC"> that one of the universities</font>

728
00:26:52,870 --> 00:26:57,820
was they learned that<font color="#CCCCCC"> anything with the</font>

729
00:26:55,510 --> 00:26:59,049
network socket was bad and any<font color="#E5E5E5"> malware</font>

730
00:26:57,820 --> 00:27:00,939
that<font color="#E5E5E5"> used a network socket didn't work</font>

731
00:26:59,049 --> 00:27:03,100
<font color="#E5E5E5">anymore</font><font color="#CCCCCC"> so on the red cell</font><font color="#E5E5E5"> that</font>

732
00:27:00,940 --> 00:27:04,150
minor minor heartaches it was like only

733
00:27:03,100 --> 00:27:05,379
leaves a socket<font color="#CCCCCC"> open for a</font><font color="#E5E5E5"> couple</font>

734
00:27:04,150 --> 00:27:08,260
seconds sure it worked it<font color="#E5E5E5"> worked really</font>

735
00:27:05,380 --> 00:27:09,760
well<font color="#E5E5E5"> and then and then we to client was</font>

736
00:27:08,260 --> 00:27:10,810
like hey we'd like you to see what

737
00:27:09,760 --> 00:27:13,990
happens see if you can get out<font color="#CCCCCC"> of</font><font color="#E5E5E5"> our</font>

738
00:27:10,810 --> 00:27:15,850
network<font color="#E5E5E5"> using</font><font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> okay just happen to</font>

739
00:27:13,990 --> 00:27:19,270
<font color="#CCCCCC">have this tool so and it does one thing</font>

740
00:27:15,850 --> 00:27:21,610
<font color="#E5E5E5">comes over DNS and then over time it's</font>

741
00:27:19,270 --> 00:27:24,070
evolved I<font color="#E5E5E5"> changed the query sizes made</font>

742
00:27:21,610 --> 00:27:25,719
the query<font color="#E5E5E5"> sizes configurable we had an</font>

743
00:27:24,070 --> 00:27:28,270
incident where one<font color="#CCCCCC"> of the clients was</font>

744
00:27:25,720 --> 00:27:29,320
like hey so you're supposed<font color="#CCCCCC"> to do Deena</font>

745
00:27:28,270 --> 00:27:31,900
stunning work yeah I worked really<font color="#E5E5E5"> good</font>

746
00:27:29,320 --> 00:27:33,280
like well we didn't see any<font color="#E5E5E5"> you show us</font>

747
00:27:31,900 --> 00:27:35,620
what you<font color="#E5E5E5"> did me showed him in we were</font>

748
00:27:33,280 --> 00:27:37,750
using<font color="#CCCCCC"> 16 byte labels</font><font color="#E5E5E5"> 16 character labels</font>

749
00:27:35,620 --> 00:27:39,280
<font color="#E5E5E5">they're like well it's not</font><font color="#CCCCCC"> DNS tunneling</font>

750
00:27:37,750 --> 00:27:43,300
it's 18 character labels<font color="#E5E5E5"> that's DNS</font>

751
00:27:39,280 --> 00:27:46,840
tunneling<font color="#CCCCCC"> one could argue</font><font color="#E5E5E5"> that when one</font>

752
00:27:43,300 --> 00:27:48,399
could also keep a good client<font color="#CCCCCC"> so just a</font>

753
00:27:46,840 --> 00:27:51,310
little configuration option and hey we

754
00:27:48,400 --> 00:27:53,140
had DNS tunneling there<font color="#CCCCCC"> also it's really</font>

755
00:27:51,310 --> 00:27:54,669
<font color="#CCCCCC">common will get manager types</font><font color="#E5E5E5"> we're like</font>

756
00:27:53,140 --> 00:27:57,430
hey I read about this thing<font color="#CCCCCC"> do this</font>

757
00:27:54,670 --> 00:27:59,500
thing somebody read about DNS over<font color="#E5E5E5"> HTTP</font>

758
00:27:57,430 --> 00:28:01,570
<font color="#CCCCCC">and</font><font color="#E5E5E5"> somebody else read about DNS over</font>

759
00:27:59,500 --> 00:28:04,030
its domain fronting<font color="#E5E5E5"> excuse me so what</font>

760
00:28:01,570 --> 00:28:05,470
does that<font color="#CCCCCC"> know</font><font color="#E5E5E5"> pretty trivial change</font>

761
00:28:04,030 --> 00:28:07,090
actually<font color="#E5E5E5"> it's go so it compiles to</font><font color="#CCCCCC"> a</font>

762
00:28:05,470 --> 00:28:08,590
single binary<font color="#E5E5E5"> we found that just</font>

763
00:28:07,090 --> 00:28:09,820
dropping it on a dropping it on a

764
00:28:08,590 --> 00:28:12,399
Windows host dropping it on a<font color="#E5E5E5"> Linux box</font>

765
00:28:09,820 --> 00:28:13,960
<font color="#E5E5E5">which reason it'll be well it runs and</font>

766
00:28:12,400 --> 00:28:15,430
<font color="#E5E5E5">it's defang</font><font color="#CCCCCC"> evil it was originally</font>

767
00:28:13,960 --> 00:28:18,340
written for<font color="#E5E5E5"> C - so it has C -</font><font color="#CCCCCC"> built-in</font>

768
00:28:15,430 --> 00:28:19,480
but<font color="#CCCCCC"> act e Fang and it said of setting</font>

769
00:28:18,340 --> 00:28:20,500
shell commands<font color="#E5E5E5"> back and forth and shell</font>

770
00:28:19,480 --> 00:28:23,950
output it just give it a<font color="#CCCCCC"> number and</font>

771
00:28:20,500 --> 00:28:26,770
we'll send<font color="#E5E5E5"> you some bites back assuming</font>

772
00:28:23,950 --> 00:28:28,510
assuming the demo<font color="#CCCCCC"> Divinity's like me so</font>

773
00:28:26,770 --> 00:28:30,760
we have this as a<font color="#CCCCCC"> debian</font><font color="#E5E5E5"> boxmeer</font><font color="#CCCCCC"> i'll</font>

774
00:28:28,510 --> 00:28:32,500
read that apologize if it's small back

775
00:28:30,760 --> 00:28:33,879
there<font color="#E5E5E5"> um so we</font><font color="#CCCCCC"> have this I'm gonna run</font>

776
00:28:32,500 --> 00:28:36,100
it I'm just gonna begin<font color="#E5E5E5"> to example.com</font>

777
00:28:33,880 --> 00:28:37,600
<font color="#CCCCCC">by the way this is there's some</font>

778
00:28:36,100 --> 00:28:39,040
networking under the hood<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> this</font>

779
00:28:37,600 --> 00:28:41,980
<font color="#E5E5E5">is not actually example.com</font>

780
00:28:39,040 --> 00:28:44,770
this is it goes<font color="#E5E5E5"> to a box I have that is</font>

781
00:28:41,980 --> 00:28:45,730
<font color="#CCCCCC">it and it's running</font><font color="#E5E5E5"> and this should be</font><font color="#CCCCCC"> a</font>

782
00:28:44,770 --> 00:28:46,960
Windows box here we go

783
00:28:45,730 --> 00:28:49,150
notice the defang<font color="#E5E5E5"> we'll see that in a</font>

784
00:28:46,960 --> 00:28:52,060
second and<font color="#E5E5E5"> both these will be</font><font color="#CCCCCC"> canary</font>

785
00:28:49,150 --> 00:28:52,330
<font color="#CCCCCC">thirty seconds at most longest</font><font color="#E5E5E5"> there we</font>

786
00:28:52,060 --> 00:28:55,500
go

787
00:28:52,330 --> 00:28:58,500
so we see in<font color="#CCCCCC"> heyo TCP dump I was awesome</font>

788
00:28:55,500 --> 00:28:58,500
please

789
00:28:58,759 --> 00:29:03,619
please<font color="#CCCCCC"> write we're</font><font color="#E5E5E5"> not gonna see that</font>

790
00:29:01,359 --> 00:29:07,908
and<font color="#CCCCCC"> IO timeouts are right</font>

791
00:29:03,619 --> 00:29:10,158
angry demo<font color="#E5E5E5"> gods cool so let's see to be</font>

792
00:29:07,909 --> 00:29:11,299
doing more<font color="#E5E5E5"> or less the same thing so we</font>

793
00:29:10,159 --> 00:29:13,639
<font color="#CCCCCC">have the upper left here it's</font><font color="#E5E5E5"> working on</font>

794
00:29:11,299 --> 00:29:15,408
<font color="#CCCCCC">the</font><font color="#E5E5E5"> windows box grabs an ID just from a</font>

795
00:29:13,639 --> 00:29:16,639
network card<font color="#CCCCCC"> when I originally ran this</font>

796
00:29:15,409 --> 00:29:18,169
I had no<font color="#E5E5E5"> good way to like say hey</font><font color="#CCCCCC"> you</font>

797
00:29:16,639 --> 00:29:20,119
<font color="#CCCCCC">just use this IP address so it's</font>

798
00:29:18,169 --> 00:29:21,589
whatever<font color="#E5E5E5"> IP address it can find work</font>

799
00:29:20,119 --> 00:29:22,820
worked really good<font color="#E5E5E5"> until I had a whole</font>

800
00:29:21,589 --> 00:29:25,428
bunch<font color="#CCCCCC"> of docker hosts with all the same</font>

801
00:29:22,820 --> 00:29:27,708
IP<font color="#E5E5E5"> address and tournament oops</font>

802
00:29:25,429 --> 00:29:29,749
you can also see sort of<font color="#E5E5E5"> the idea yeah</font>

803
00:29:27,709 --> 00:29:34,249
so we<font color="#E5E5E5"> can see the roughly what</font><font color="#CCCCCC"> the</font>

804
00:29:29,749 --> 00:29:39,769
queries look like hey that was in the

805
00:29:34,249 --> 00:29:44,149
play button more demo<font color="#E5E5E5"> anger demote</font>

806
00:29:39,769 --> 00:29:45,709
<font color="#E5E5E5">divinity</font><font color="#CCCCCC"> angry cool and then there we go</font>

807
00:29:44,149 --> 00:29:48,619
<font color="#E5E5E5">it's running Windows Linux</font><font color="#CCCCCC"> I'd you can</font>

808
00:29:45,709 --> 00:29:49,609
<font color="#CCCCCC">see it beacons</font><font color="#E5E5E5"> bottom left side here we</font>

809
00:29:48,619 --> 00:29:51,349
can see the beacons and<font color="#E5E5E5"> you can see it</font>

810
00:29:49,609 --> 00:29:55,428
<font color="#CCCCCC">guys</font><font color="#E5E5E5"> these numbers</font><font color="#CCCCCC"> it uses just to avoid</font>

811
00:29:51,349 --> 00:30:00,289
caching beacon beaconing<font color="#E5E5E5"> hey we start</font>

812
00:29:55,429 --> 00:30:03,199
the TCP<font color="#E5E5E5"> dump and then there</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> go so</font>

813
00:30:00,289 --> 00:30:05,629
<font color="#E5E5E5">will interact with implant the 100</font>

814
00:30:03,199 --> 00:30:07,009
implant that bar<font color="#E5E5E5"> there apologies will go</font>

815
00:30:05,629 --> 00:30:09,139
<font color="#CCCCCC">away their good will interact that will</font>

816
00:30:07,009 --> 00:30:10,339
<font color="#E5E5E5">task it to run a you name and in a</font>

817
00:30:09,139 --> 00:30:11,658
second you'll<font color="#CCCCCC"> see on the right side the</font>

818
00:30:10,339 --> 00:30:13,879
<font color="#CCCCCC">output</font><font color="#E5E5E5"> comes back it's</font><font color="#CCCCCC"> really long it's</font>

819
00:30:11,659 --> 00:30:15,169
<font color="#E5E5E5">really ugly</font><font color="#CCCCCC"> actually gets by a lot</font><font color="#E5E5E5"> of</font>

820
00:30:13,879 --> 00:30:17,448
things so it's a nice<font color="#CCCCCC"> takeaway for</font>

821
00:30:15,169 --> 00:30:19,009
<font color="#E5E5E5">clients so task the Windows implant the</font>

822
00:30:17,449 --> 00:30:20,509
<font color="#E5E5E5">fe8 do your implant</font><font color="#CCCCCC"> just to give</font><font color="#E5E5E5"> us a</font>

823
00:30:19,009 --> 00:30:22,219
hundred thousand and<font color="#E5E5E5"> twenty four bytes</font>

824
00:30:20,509 --> 00:30:24,859
back<font color="#E5E5E5"> give it a second to pick up the</font>

825
00:30:22,219 --> 00:30:26,179
tasking<font color="#E5E5E5"> um you can see</font><font color="#CCCCCC"> up here on the</font>

826
00:30:24,859 --> 00:30:27,259
upper<font color="#E5E5E5"> right you know the implant was</font>

827
00:30:26,179 --> 00:30:28,609
like yeah I ran that it's good to<font color="#E5E5E5"> have</font>

828
00:30:27,259 --> 00:30:30,409
log it's good to have<font color="#E5E5E5"> time-stamped logs</font>

829
00:30:28,609 --> 00:30:31,728
<font color="#E5E5E5">because</font><font color="#CCCCCC"> I'm very</font><font color="#E5E5E5"> really similar to</font><font color="#CCCCCC"> be</font>

830
00:30:30,409 --> 00:30:33,589
like hey what<font color="#CCCCCC"> did you do and</font><font color="#E5E5E5"> when do</font>

831
00:30:31,729 --> 00:30:35,419
<font color="#E5E5E5">like let me tell you there we go so</font>

832
00:30:33,589 --> 00:30:38,329
there's<font color="#E5E5E5"> our kilobyte of tasking coming</font>

833
00:30:35,419 --> 00:30:40,190
back<font color="#E5E5E5"> do that because it's um you</font><font color="#CCCCCC"> know is</font>

834
00:30:38,329 --> 00:30:41,418
no reason that unencrypted<font color="#E5E5E5"> DNS</font><font color="#CCCCCC"> comms</font>

835
00:30:40,190 --> 00:30:42,829
couldn't be<font color="#E5E5E5"> intercepted probably not</font>

836
00:30:41,419 --> 00:30:44,809
there's no reason somebody<font color="#E5E5E5"> couldn't</font>

837
00:30:42,829 --> 00:30:49,389
change<font color="#E5E5E5"> the text record to say like blow</font>

838
00:30:44,809 --> 00:30:49,389
everything<font color="#E5E5E5"> away</font><font color="#CCCCCC"> alright</font>

839
00:30:53,600 --> 00:31:00,020
there we go those are<font color="#CCCCCC"> backup pictures</font>

840
00:30:56,690 --> 00:31:01,790
for even angrier demo gods so we have

841
00:31:00,020 --> 00:31:03,770
some takeaways<font color="#E5E5E5"> for both the red side or</font>

842
00:31:01,790 --> 00:31:05,690
the blue side doing<font color="#E5E5E5"> this on instead of</font>

843
00:31:03,770 --> 00:31:07,460
<font color="#E5E5E5">hiring the red team</font><font color="#CCCCCC"> ratings</font><font color="#E5E5E5"> are</font>

844
00:31:05,690 --> 00:31:08,570
expensive and<font color="#E5E5E5"> often not</font><font color="#CCCCCC"> pleasant</font><font color="#E5E5E5"> to deal</font>

845
00:31:07,460 --> 00:31:10,520
with so I'd like to<font color="#CCCCCC"> encourage</font><font color="#E5E5E5"> blue</font>

846
00:31:08,570 --> 00:31:12,230
<font color="#CCCCCC">team's</font><font color="#E5E5E5"> it's easy</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> maybe not this</font>

847
00:31:10,520 --> 00:31:13,639
tool necessarily but some of these<font color="#CCCCCC"> we'll</font>

848
00:31:12,230 --> 00:31:16,100
see a few<font color="#CCCCCC"> examples of tools that</font><font color="#E5E5E5"> are</font>

849
00:31:13,640 --> 00:31:17,110
just quick easy wins<font color="#E5E5E5"> anyway so from the</font>

850
00:31:16,100 --> 00:31:18,860
<font color="#E5E5E5">red side the first thing we learned</font>

851
00:31:17,110 --> 00:31:20,449
<font color="#CCCCCC">especially the first</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> we're doing is</font>

852
00:31:18,860 --> 00:31:22,459
<font color="#CCCCCC">you're</font><font color="#E5E5E5"> like okay how do we get execution</font>

853
00:31:20,450 --> 00:31:23,750
on a box that is<font color="#E5E5E5"> well</font><font color="#CCCCCC"> defended</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> the</font>

854
00:31:22,460 --> 00:31:24,580
answer is you put a binary<font color="#E5E5E5"> in the box</font>

855
00:31:23,750 --> 00:31:27,200
and<font color="#CCCCCC"> you run it</font>

856
00:31:24,580 --> 00:31:29,330
so yes<font color="#CCCCCC"> annalen binaries work pretty well</font>

857
00:31:27,200 --> 00:31:32,060
it was<font color="#E5E5E5"> never before seen by</font><font color="#CCCCCC"> a corporate</font>

858
00:31:29,330 --> 00:31:33,379
environment when I ran it anyways<font color="#CCCCCC"> by the</font>

859
00:31:32,060 --> 00:31:36,620
way this tool has gotten a little<font color="#E5E5E5"> bit of</font>

860
00:31:33,380 --> 00:31:39,620
news on the Twitter's recently so if you

861
00:31:36,620 --> 00:31:41,239
run it in virustotal<font color="#CCCCCC"> flags I apologize</font>

862
00:31:39,620 --> 00:31:43,129
<font color="#E5E5E5">another thing we</font><font color="#CCCCCC"> learned</font><font color="#E5E5E5"> make wire</font><font color="#CCCCCC"> comms</font>

863
00:31:41,240 --> 00:31:45,200
flexible like we had<font color="#CCCCCC"> the</font><font color="#E5E5E5"> people we were</font>

864
00:31:43,130 --> 00:31:46,760
<font color="#E5E5E5">working with</font><font color="#CCCCCC"> it was like no</font><font color="#E5E5E5"> it's 18</font>

865
00:31:45,200 --> 00:31:48,400
bytes not 16<font color="#CCCCCC"> it's a little bit of</font>

866
00:31:46,760 --> 00:31:50,629
flexibility is nice<font color="#CCCCCC"> also a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of</font>

867
00:31:48,400 --> 00:31:52,160
<font color="#CCCCCC">hey yeah if we just change</font><font color="#E5E5E5"> it up your</font>

868
00:31:50,630 --> 00:31:54,320
sensors don't<font color="#E5E5E5"> see it we were we had a</font>

869
00:31:52,160 --> 00:31:56,210
key<font color="#E5E5E5"> base it's a key logger among other</font>

870
00:31:54,320 --> 00:31:58,580
<font color="#CCCCCC">things</font><font color="#E5E5E5"> and we</font><font color="#CCCCCC"> just like put an X in</font><font color="#E5E5E5"> the</font>

871
00:31:56,210 --> 00:32:00,230
query<font color="#E5E5E5"> it was HTTP</font><font color="#CCCCCC"> issue</font><font color="#E5E5E5"> yeah just put an</font>

872
00:31:58,580 --> 00:32:01,280
X<font color="#E5E5E5"> and like oh that was</font><font color="#CCCCCC"> an easy change</font>

873
00:32:00,230 --> 00:32:02,630
didn't catch it<font color="#E5E5E5"> so yeah</font><font color="#CCCCCC"> make</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> coms</font>

874
00:32:01,280 --> 00:32:04,310
flexible<font color="#E5E5E5"> because at some point</font><font color="#CCCCCC"> you'll be</font>

875
00:32:02,630 --> 00:32:06,020
you<font color="#E5E5E5"> know the tools say okay that's bad</font>

876
00:32:04,310 --> 00:32:07,610
<font color="#E5E5E5">then you say well wait what are</font><font color="#CCCCCC"> the</font>

877
00:32:06,020 --> 00:32:10,040
<font color="#E5E5E5">other balance of the tool I'm</font>

878
00:32:07,610 --> 00:32:12,649
repurposing tools is when<font color="#CCCCCC"> appropriate is</font>

879
00:32:10,040 --> 00:32:14,090
good<font color="#CCCCCC"> generally I'm a fan of</font><font color="#E5E5E5"> knowing</font>

880
00:32:12,650 --> 00:32:15,980
exactly what<font color="#CCCCCC"> your tools are doing which</font>

881
00:32:14,090 --> 00:32:17,770
usually means writing your own<font color="#E5E5E5"> but</font>

882
00:32:15,980 --> 00:32:19,940
<font color="#CCCCCC">sometimes</font><font color="#E5E5E5"> especially throughout the tool</font>

883
00:32:17,770 --> 00:32:23,629
<font color="#E5E5E5">you use it from something else it's</font>

884
00:32:19,940 --> 00:32:25,970
great<font color="#CCCCCC"> along</font><font color="#E5E5E5"> with getting code execution</font>

885
00:32:23,630 --> 00:32:27,680
having somewhere to host your<font color="#E5E5E5"> tools that</font>

886
00:32:25,970 --> 00:32:29,120
will get<font color="#E5E5E5"> actually on to targeting unless</font>

887
00:32:27,680 --> 00:32:30,250
you're testing like hey<font color="#CCCCCC"> is</font><font color="#E5E5E5"> anything</font>

888
00:32:29,120 --> 00:32:33,560
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> stop something</font><font color="#CCCCCC"> from downloading</font>

889
00:32:30,250 --> 00:32:35,330
things<font color="#E5E5E5"> like onedrive or Dropbox or ec2</font>

890
00:32:33,560 --> 00:32:37,129
or<font color="#E5E5E5"> excuse me</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> s3 they work pretty</font>

891
00:32:35,330 --> 00:32:38,949
<font color="#E5E5E5">good</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> actually like getting the tools</font>

892
00:32:37,130 --> 00:32:43,280
on target without<font color="#E5E5E5"> somebody saying hey uh</font>

893
00:32:38,950 --> 00:32:45,230
block de binary's sorry<font color="#E5E5E5"> so another thing</font>

894
00:32:43,280 --> 00:32:46,550
have your commands ready<font color="#E5E5E5"> copy/paste just</font>

895
00:32:45,230 --> 00:32:47,810
having a bunch<font color="#E5E5E5"> of pace tables and you'll</font>

896
00:32:46,550 --> 00:32:48,919
develop<font color="#E5E5E5"> these when you're testing</font><font color="#CCCCCC"> when</font>

897
00:32:47,810 --> 00:32:51,560
you're developing and testing the tools

898
00:32:48,920 --> 00:32:54,140
but it saves a<font color="#E5E5E5"> lot of typos</font><font color="#CCCCCC"> it saves a</font>

899
00:32:51,560 --> 00:32:55,280
lot<font color="#CCCCCC"> of hey manager I'm a blue guy but I</font>

900
00:32:54,140 --> 00:32:56,630
have<font color="#CCCCCC"> this</font><font color="#E5E5E5"> really cool red thing and then</font>

901
00:32:55,280 --> 00:32:59,750
you<font color="#E5E5E5"> typo it and then a box shuts down</font>

902
00:32:56,630 --> 00:33:01,730
when<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> like oops sorry so um yeah</font>

903
00:32:59,750 --> 00:33:03,290
does<font color="#CCCCCC"> be that in VMs not not what</font>

904
00:33:01,730 --> 00:33:04,100
somebody<font color="#E5E5E5"> important is watching and the</font>

905
00:33:03,290 --> 00:33:05,330
<font color="#E5E5E5">last thing is to set</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> your</font>

906
00:33:04,100 --> 00:33:07,250
infrastructure ahead of time<font color="#CCCCCC"> we all do</font>

907
00:33:05,330 --> 00:33:09,260
<font color="#E5E5E5">that of course but set it up like weeks</font>

908
00:33:07,250 --> 00:33:11,330
<font color="#E5E5E5">of time a to let the domains mature get</font>

909
00:33:09,260 --> 00:33:14,360
<font color="#E5E5E5">categorized get</font><font color="#CCCCCC"> domain tools do not</font><font color="#E5E5E5"> say</font>

910
00:33:11,330 --> 00:33:16,520
they're terrible<font color="#CCCCCC"> but b-because strange</font>

911
00:33:14,360 --> 00:33:18,350
things happen<font color="#E5E5E5"> so have them set</font><font color="#CCCCCC"> up a long</font>

912
00:33:16,520 --> 00:33:19,670
time<font color="#CCCCCC"> before and then every so often go</font>

913
00:33:18,350 --> 00:33:22,100
in<font color="#E5E5E5"> check</font><font color="#CCCCCC"> case this</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> work hey this</font>

914
00:33:19,670 --> 00:33:23,600
thing work<font color="#E5E5E5"> um and make it look</font>

915
00:33:22,100 --> 00:33:24,770
appropriately<font color="#CCCCCC"> viewed I know if we're</font>

916
00:33:23,600 --> 00:33:26,480
testing<font color="#E5E5E5"> whether the defense of tools</font>

917
00:33:24,770 --> 00:33:27,950
catch malicious things<font color="#E5E5E5"> you can't make it</font>

918
00:33:26,480 --> 00:33:29,360
look<font color="#E5E5E5"> like totally benign</font><font color="#CCCCCC"> time do anybody</font>

919
00:33:27,950 --> 00:33:30,890
any good<font color="#CCCCCC"> you're like</font><font color="#E5E5E5"> well yeah so it</font>

920
00:33:29,360 --> 00:33:32,479
<font color="#E5E5E5">looks normal</font><font color="#CCCCCC"> to me but appropriately</font>

921
00:33:30,890 --> 00:33:34,190
denied if you're not<font color="#E5E5E5"> testing domain</font>

922
00:33:32,480 --> 00:33:37,280
reputation<font color="#CCCCCC"> have your domains</font><font color="#E5E5E5"> normal ish</font>

923
00:33:34,190 --> 00:33:38,930
if you're not testing<font color="#CCCCCC"> like geoip stuff</font>

924
00:33:37,280 --> 00:33:40,430
we had a client<font color="#E5E5E5"> that blocked any</font><font color="#CCCCCC"> IP</font>

925
00:33:38,930 --> 00:33:42,980
addresses<font color="#E5E5E5"> from a large number of</font>

926
00:33:40,430 --> 00:33:44,510
<font color="#CCCCCC">countries</font><font color="#E5E5E5"> of which Togo</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> one and I</font>

927
00:33:42,980 --> 00:33:46,570
was using<font color="#E5E5E5"> some Togo IP addresses that</font>

928
00:33:44,510 --> 00:33:49,100
<font color="#E5E5E5">didn't work too</font><font color="#CCCCCC"> good</font>

929
00:33:46,570 --> 00:33:51,260
blue-blue had a few more takeaways<font color="#E5E5E5"> than</font>

930
00:33:49,100 --> 00:33:52,909
those it was<font color="#E5E5E5"> a bit i opening when i ran</font>

931
00:33:51,260 --> 00:33:53,990
this<font color="#E5E5E5"> one the first thing you learned to</font>

932
00:33:52,910 --> 00:33:54,700
see<font color="#CCCCCC"> stand-alone</font><font color="#E5E5E5"> binary they worked</font>

933
00:33:53,990 --> 00:33:57,260
pretty<font color="#E5E5E5"> good</font>

934
00:33:54,700 --> 00:33:57,710
<font color="#CCCCCC">you drop a</font><font color="#E5E5E5"> standalone binary to disk</font><font color="#CCCCCC"> to</font>

935
00:33:57,260 --> 00:34:00,320
the<font color="#E5E5E5"> desktop</font>

936
00:33:57,710 --> 00:34:02,060
<font color="#E5E5E5">it ran</font><font color="#CCCCCC"> they got a few</font><font color="#E5E5E5"> more smoke</font><font color="#CCCCCC"> queries</font>

937
00:34:00,320 --> 00:34:03,830
out of that one<font color="#E5E5E5"> so another thing blue</font>

938
00:34:02,060 --> 00:34:05,510
learned was that wire coms are pretty

939
00:34:03,830 --> 00:34:07,699
flexible you don't<font color="#E5E5E5"> really have to follow</font>

940
00:34:05,510 --> 00:34:09,580
RFC's<font color="#E5E5E5"> dns it's like this one in</font>

941
00:34:07,700 --> 00:34:11,540
<font color="#CCCCCC">particular</font><font color="#E5E5E5"> do not follow like 150 RFC's</font>

942
00:34:09,580 --> 00:34:13,489
yeah we change it up<font color="#CCCCCC"> just</font><font color="#E5E5E5"> a little bit</font>

943
00:34:11,540 --> 00:34:15,649
<font color="#E5E5E5">no they go</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> nuts</font><font color="#CCCCCC"> can't do that</font><font color="#E5E5E5"> okay</font>

944
00:34:13,489 --> 00:34:18,168
so<font color="#CCCCCC"> suggest and they got a lot of value</font>

945
00:34:15,649 --> 00:34:20,000
out<font color="#CCCCCC"> of that</font><font color="#E5E5E5"> they learned that even if</font>

946
00:34:18,168 --> 00:34:21,949
<font color="#CCCCCC">your malware isn't</font><font color="#E5E5E5"> super cool elite run</font>

947
00:34:20,000 --> 00:34:24,409
by the KGB<font color="#CCCCCC"> they can actually still work</font>

948
00:34:21,949 --> 00:34:26,138
enough<font color="#E5E5E5"> um everybody wants</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> find an apt</font>

949
00:34:24,409 --> 00:34:29,750
everybody want<font color="#E5E5E5"> to say oh yeah we caught</font>

950
00:34:26,139 --> 00:34:32,330
<font color="#CCCCCC">apt</font><font color="#E5E5E5"> one or choose</font><font color="#CCCCCC"> your group doesn't</font>

951
00:34:29,750 --> 00:34:33,800
necessarily mean that the malware isn't

952
00:34:32,330 --> 00:34:35,239
gonna work<font color="#E5E5E5"> isn't gonna cost you money in</font>

953
00:34:33,800 --> 00:34:37,700
<font color="#E5E5E5">the end but you know people generally</font>

954
00:34:35,239 --> 00:34:38,989
<font color="#E5E5E5">defend against blue also learned that</font>

955
00:34:37,699 --> 00:34:40,428
<font color="#E5E5E5">DNS is kind</font><font color="#CCCCCC"> of hard to</font><font color="#E5E5E5"> see Ken alluded</font>

956
00:34:38,989 --> 00:34:43,790
some<font color="#CCCCCC"> round-robin we found and they</font>

957
00:34:40,429 --> 00:34:47,090
caught most of<font color="#E5E5E5"> it we had a client where</font>

958
00:34:43,790 --> 00:34:48,230
<font color="#E5E5E5">an</font><font color="#CCCCCC"> X domains came back as the reason I</font>

959
00:34:47,090 --> 00:34:49,520
forget their upstream<font color="#E5E5E5"> DNS but they're</font>

960
00:34:48,230 --> 00:34:51,199
like hey here's a parking page instead

961
00:34:49,520 --> 00:34:52,879
of your next<font color="#CCCCCC"> domain</font>

962
00:34:51,199 --> 00:34:54,879
<font color="#E5E5E5">what kind of normal kind of gave us</font>

963
00:34:52,879 --> 00:34:56,810
credibility<font color="#CCCCCC"> work pretty good it's worth</font>

964
00:34:54,879 --> 00:34:58,190
<font color="#E5E5E5">but yeah DNS and then we had another</font>

965
00:34:56,810 --> 00:34:59,960
<font color="#E5E5E5">client</font><font color="#CCCCCC"> who was like ah</font><font color="#E5E5E5"> here's our</font>

966
00:34:58,190 --> 00:35:02,120
<font color="#CCCCCC">solution for</font><font color="#E5E5E5"> DNS will encrypt all the</font>

967
00:34:59,960 --> 00:35:04,460
<font color="#E5E5E5">DNS</font><font color="#CCCCCC"> Edison was DNS over HTTP or DNS over</font>

968
00:35:02,120 --> 00:35:05,359
TLS well crypt all the DNS and then

969
00:35:04,460 --> 00:35:07,370
they're like hey<font color="#E5E5E5"> we're not seeing your</font>

970
00:35:05,360 --> 00:35:09,140
emulations what's up with that so maybe

971
00:35:07,370 --> 00:35:11,330
that's that<font color="#E5E5E5"> wasn't helpful it was a good</font>

972
00:35:09,140 --> 00:35:13,220
good lesson could take away for them<font color="#E5E5E5"> the</font>

973
00:35:11,330 --> 00:35:15,500
last thing for<font color="#E5E5E5"> this tool is</font><font color="#CCCCCC"> domain black</font>

974
00:35:13,220 --> 00:35:17,140
lists are not<font color="#E5E5E5"> always effective domain</font>

975
00:35:15,500 --> 00:35:19,400
white lists are not<font color="#E5E5E5"> always effective</font><font color="#CCCCCC"> so</font>

976
00:35:17,140 --> 00:35:20,779
when you<font color="#CCCCCC"> whitelist things that are like</font>

977
00:35:19,400 --> 00:35:22,040
<font color="#CCCCCC">good category good</font><font color="#E5E5E5"> category</font>

978
00:35:20,780 --> 00:35:23,150
<font color="#E5E5E5">category name like hey look at my</font>

979
00:35:22,040 --> 00:35:26,480
medical article on nose hair it's

980
00:35:23,150 --> 00:35:27,710
awesome and I cited Wikipedia then<font color="#CCCCCC"> hey</font>

981
00:35:26,480 --> 00:35:29,750
<font color="#E5E5E5">works pretty good and blacklist hey</font>

982
00:35:27,710 --> 00:35:31,340
these are the bad domains and we

983
00:35:29,750 --> 00:35:32,810
generally<font color="#E5E5E5"> try not to register domains on</font>

984
00:35:31,340 --> 00:35:35,360
site but every so often it's like

985
00:35:32,810 --> 00:35:37,570
<font color="#CCCCCC">cooking right of good ones you know</font><font color="#E5E5E5"> you</font>

986
00:35:35,360 --> 00:35:45,020
need to<font color="#E5E5E5"> do more than we expected</font><font color="#CCCCCC"> or</font><font color="#E5E5E5"> I</font>

987
00:35:37,570 --> 00:35:47,720
worked<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right the next primary next</font>

988
00:35:45,020 --> 00:35:50,030
<font color="#CCCCCC">emulation is PS beacon this is on github</font>

989
00:35:47,720 --> 00:35:56,720
<font color="#CCCCCC">by the way you know spot in that</font><font color="#E5E5E5"> the</font>

990
00:35:50,030 --> 00:35:58,940
link right<font color="#CCCCCC"> there PS beacon here we go</font>

991
00:35:56,720 --> 00:36:01,970
it's a github<font color="#CCCCCC"> gist so apologies</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> the</font>

992
00:35:58,940 --> 00:36:03,770
short short really<font color="#E5E5E5"> long link we de</font>

993
00:36:01,970 --> 00:36:05,089
client was like hey<font color="#CCCCCC"> yes so you</font><font color="#E5E5E5"> know you</font>

994
00:36:03,770 --> 00:36:06,830
do all<font color="#CCCCCC"> this HTTP stuff we read about</font>

995
00:36:05,090 --> 00:36:09,140
<font color="#E5E5E5">things it's just like query</font><font color="#CCCCCC"> answer query</font>

996
00:36:06,830 --> 00:36:11,150
answer<font color="#E5E5E5"> Linux lady came</font><font color="#CCCCCC"> up in some kind</font>

997
00:36:09,140 --> 00:36:13,700
of conversations and<font color="#CCCCCC"> by cake</font><font color="#E5E5E5"> how's</font><font color="#CCCCCC"> it</font>

998
00:36:11,150 --> 00:36:15,260
look<font color="#E5E5E5"> on the wire</font><font color="#CCCCCC"> so I wrote and it was a</font>

999
00:36:13,700 --> 00:36:16,430
<font color="#E5E5E5">Windows endpoints</font><font color="#CCCCCC"> that we were using</font><font color="#E5E5E5"> at</font>

1000
00:36:15,260 --> 00:36:17,660
<font color="#CCCCCC">that point so I wrote a little</font>

1001
00:36:16,430 --> 00:36:19,430
PowerShell script<font color="#E5E5E5"> that was more or</font><font color="#CCCCCC"> less</font>

1002
00:36:17,660 --> 00:36:21,310
<font color="#E5E5E5">the same thing as the little bash bash</font>

1003
00:36:19,430 --> 00:36:24,560
<font color="#E5E5E5">what would be a one-liner up there</font>

1004
00:36:21,310 --> 00:36:28,340
notice critically the important kicker

1005
00:36:24,560 --> 00:36:30,710
part is not<font color="#CCCCCC"> non play and that</font><font color="#E5E5E5"> goes</font><font color="#CCCCCC"> back</font>

1006
00:36:28,340 --> 00:36:32,390
to<font color="#CCCCCC"> the makes things reasonably realistic</font>

1007
00:36:30,710 --> 00:36:35,120
yet<font color="#E5E5E5"> I mean it's gonna pipe to stand it</font>

1008
00:36:32,390 --> 00:36:37,190
<font color="#E5E5E5">out but could write to Ben sh-she could</font>

1009
00:36:35,120 --> 00:36:38,690
<font color="#E5E5E5">write to her shell I'm in there's a 60</font>

1010
00:36:37,190 --> 00:36:40,550
<font color="#E5E5E5">minute</font><font color="#CCCCCC"> there 60 second Beacon scuse</font><font color="#E5E5E5"> me</font>

1011
00:36:38,690 --> 00:36:42,440
it's pretty<font color="#E5E5E5"> much exactly what Linux lady</font>

1012
00:36:40,550 --> 00:36:46,490
did<font color="#E5E5E5"> accepts on a Windows endpoint and</font>

1013
00:36:42,440 --> 00:36:48,920
<font color="#E5E5E5">non cron so it was cheap to write</font>

1014
00:36:46,490 --> 00:36:52,040
definitely hit that wicket<font color="#CCCCCC"> and I was</font>

1015
00:36:48,920 --> 00:36:54,020
like<font color="#E5E5E5"> minutes to write and over time it's</font>

1016
00:36:52,040 --> 00:36:55,700
evolved<font color="#E5E5E5"> features we've added we've had a</font>

1017
00:36:54,020 --> 00:36:57,350
jitter in there so you know<font color="#E5E5E5"> something to</font>

1018
00:36:55,700 --> 00:36:59,180
say<font color="#CCCCCC"> a</font><font color="#E5E5E5"> we've just noticed every minute</font>

1019
00:36:57,350 --> 00:37:00,880
something<font color="#E5E5E5"> is happening</font><font color="#CCCCCC"> that's bad</font><font color="#E5E5E5"> so if</font>

1020
00:36:59,180 --> 00:37:03,049
it's between<font color="#E5E5E5"> like one</font><font color="#CCCCCC"> and three</font><font color="#E5E5E5"> minutes</font>

1021
00:37:00,880 --> 00:37:05,090
<font color="#CCCCCC">might be good might be bad it's good to</font>

1022
00:37:03,050 --> 00:37:07,100
test the<font color="#CCCCCC"> limits of your</font><font color="#E5E5E5"> tools and then</font>

1023
00:37:05,090 --> 00:37:08,350
the user<font color="#CCCCCC"> agent is</font><font color="#E5E5E5"> settable that you can</font>

1024
00:37:07,100 --> 00:37:10,190
configure it<font color="#E5E5E5"> to be whatever you'd like</font>

1025
00:37:08,350 --> 00:37:12,350
<font color="#CCCCCC">one point we're running</font><font color="#E5E5E5"> this and they're</font>

1026
00:37:10,190 --> 00:37:14,390
like<font color="#E5E5E5"> hey that tool was cool but nobody</font>

1027
00:37:12,350 --> 00:37:16,970
uses<font color="#E5E5E5"> power</font><font color="#CCCCCC"> shells</font><font color="#E5E5E5"> IX the right of you</font>

1028
00:37:14,390 --> 00:37:18,410
<font color="#E5E5E5">are excuse me in our environment so</font><font color="#CCCCCC"> and</font>

1029
00:37:16,970 --> 00:37:20,060
<font color="#CCCCCC">that really wasn't they were doing what</font>

1030
00:37:18,410 --> 00:37:23,210
they<font color="#CCCCCC"> were trying to catch</font><font color="#E5E5E5"> so yeah but</font>

1031
00:37:20,060 --> 00:37:24,590
generally it<font color="#E5E5E5"> works pretty good</font><font color="#CCCCCC"> a couple</font>

1032
00:37:23,210 --> 00:37:26,870
<font color="#E5E5E5">little snippets of code so this is the</font>

1033
00:37:24,590 --> 00:37:30,200
config the things you can set a but<font color="#E5E5E5"> be</font>

1034
00:37:26,870 --> 00:37:31,190
defaults and the defaults are very

1035
00:37:30,200 --> 00:37:32,480
important when<font color="#E5E5E5"> you hand something to</font>

1036
00:37:31,190 --> 00:37:34,240
somebody say hey please run this and

1037
00:37:32,480 --> 00:37:36,340
that somebody's like what's

1038
00:37:34,240 --> 00:37:38,649
man line<font color="#E5E5E5"> and you're like please</font>

1039
00:37:36,340 --> 00:37:39,760
<font color="#E5E5E5">double-click this</font><font color="#CCCCCC"> having the</font><font color="#E5E5E5"> settable</font>

1040
00:37:38,650 --> 00:37:41,440
defaults is really quite helpful

1041
00:37:39,760 --> 00:37:43,450
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> also if you're using</font><font color="#CCCCCC"> link by the way</font>

1042
00:37:41,440 --> 00:37:45,640
a little little<font color="#E5E5E5"> takeaway uh link like</font>

1043
00:37:43,450 --> 00:37:47,890
Smiley's and<font color="#E5E5E5"> PowerShell does not like</font>

1044
00:37:45,640 --> 00:37:48,910
Smiley's typed in like link<font color="#E5E5E5"> likes</font>

1045
00:37:47,890 --> 00:37:51,100
turning things into Smiley's

1046
00:37:48,910 --> 00:37:53,020
specifically is the core of the code

1047
00:37:51,100 --> 00:37:55,480
<font color="#E5E5E5">it's actually a really simple tool that</font>

1048
00:37:53,020 --> 00:37:56,590
we use very frequently<font color="#E5E5E5"> and defenders</font>

1049
00:37:55,480 --> 00:37:58,660
actually get a lot<font color="#CCCCCC"> out of it</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

1050
00:37:56,590 --> 00:38:00,490
like oh wow that worked<font color="#CCCCCC"> ok retool our</font>

1051
00:37:58,660 --> 00:38:03,430
change the procedures or what have you<font color="#CCCCCC"> I</font>

1052
00:38:00,490 --> 00:38:03,729
mean<font color="#CCCCCC"> the core really</font><font color="#E5E5E5"> is just somewhere</font>

1053
00:38:03,430 --> 00:38:05,379
in<font color="#CCCCCC"> here</font>

1054
00:38:03,730 --> 00:38:07,360
<font color="#CCCCCC">yeah system donut</font><font color="#E5E5E5"> that website</font><font color="#CCCCCC"> to</font>

1055
00:38:05,380 --> 00:38:09,430
download string pass a URL<font color="#CCCCCC"> and pipe it</font>

1056
00:38:07,360 --> 00:38:11,530
<font color="#CCCCCC">out and all and then yeah but you're</font><font color="#E5E5E5"> not</font>

1057
00:38:09,430 --> 00:38:13,089
actually<font color="#CCCCCC"> running</font><font color="#E5E5E5"> anything like okay we</font>

1058
00:38:11,530 --> 00:38:14,530
we didn't want<font color="#CCCCCC"> to but you know</font><font color="#E5E5E5"> if you</font>

1059
00:38:13,090 --> 00:38:19,720
<font color="#CCCCCC">really need</font><font color="#E5E5E5"> to you can change</font><font color="#CCCCCC"> a few</font>

1060
00:38:14,530 --> 00:38:22,660
bytes<font color="#E5E5E5"> right there demo gods</font><font color="#CCCCCC"> hey</font><font color="#E5E5E5"> there's</font>

1061
00:38:19,720 --> 00:38:28,649
an<font color="#CCCCCC"> AI term update by the way okay seen</font>

1062
00:38:22,660 --> 00:38:28,649
<font color="#CCCCCC">to produce tweets</font>

1063
00:38:30,220 --> 00:38:35,410
<font color="#E5E5E5">okay so we're</font><font color="#CCCCCC"> asking me</font><font color="#E5E5E5"> hey is that Mike</font>

1064
00:38:33,819 --> 00:38:39,250
gonna<font color="#E5E5E5"> work and I was like yeah</font><font color="#CCCCCC"> no</font>

1065
00:38:35,410 --> 00:38:41,200
problem thank you sir

1066
00:38:39,250 --> 00:38:44,230
so here's what<font color="#CCCCCC"> it</font><font color="#E5E5E5"> looks like on</font><font color="#CCCCCC"> the wire</font>

1067
00:38:41,200 --> 00:38:45,490
also<font color="#E5E5E5"> command line parameters and it</font>

1068
00:38:44,230 --> 00:38:47,680
looks exactly like<font color="#CCCCCC"> you'd expect from</font>

1069
00:38:45,490 --> 00:38:49,839
curl in a loop or<font color="#E5E5E5"> assistant on that web</font>

1070
00:38:47,680 --> 00:38:51,160
<font color="#E5E5E5">client loop</font><font color="#CCCCCC"> somewhere between three</font>

1071
00:38:49,839 --> 00:38:52,509
<font color="#CCCCCC">quarters a second in a second recorder</font>

1072
00:38:51,160 --> 00:38:54,430
it makes a request<font color="#E5E5E5"> and that's pretty</font>

1073
00:38:52,510 --> 00:38:57,359
<font color="#E5E5E5">much it again I'm not please don't go</font>

1074
00:38:54,430 --> 00:39:02,348
<font color="#CCCCCC">views them</font><font color="#E5E5E5"> example.com if you can but</font>

1075
00:38:57,359 --> 00:39:04,270
it's not<font color="#E5E5E5"> light and that that's that tool</font>

1076
00:39:02,349 --> 00:39:06,490
<font color="#CCCCCC">and we get a lot of</font><font color="#E5E5E5"> mileage out of</font>

1077
00:39:04,270 --> 00:39:07,780
something<font color="#CCCCCC"> that simple so rid takeaways</font>

1078
00:39:06,490 --> 00:39:10,359
things<font color="#CCCCCC"> we've learned</font><font color="#E5E5E5"> and by</font><font color="#CCCCCC"> red I mean</font>

1079
00:39:07,780 --> 00:39:12,329
blue blue guys acting red or<font color="#E5E5E5"> the red</font>

1080
00:39:10,359 --> 00:39:15,279
guys doing this<font color="#E5E5E5"> tools evolve over time</font>

1081
00:39:12,329 --> 00:39:17,349
<font color="#E5E5E5">when we started this it was that big now</font>

1082
00:39:15,280 --> 00:39:20,170
it's<font color="#E5E5E5"> 80 odd characters or 80 odd lines</font>

1083
00:39:17,349 --> 00:39:21,339
or so and we've just<font color="#E5E5E5"> had different</font><font color="#CCCCCC"> needs</font>

1084
00:39:20,170 --> 00:39:23,319
<font color="#CCCCCC">over time like</font><font color="#E5E5E5"> I was</font><font color="#CCCCCC"> talking</font><font color="#E5E5E5"> to user</font>

1085
00:39:21,339 --> 00:39:25,270
agent next thing we've learned running

1086
00:39:23,319 --> 00:39:26,619
<font color="#E5E5E5">this is to let built-in systems be built</font>

1087
00:39:25,270 --> 00:39:28,660
<font color="#E5E5E5">in systems and do what</font><font color="#CCCCCC"> Bentsen systems</font>

1088
00:39:26,619 --> 00:39:30,250
do our original incarnation of this<font color="#E5E5E5"> was</font>

1089
00:39:28,660 --> 00:39:31,868
<font color="#E5E5E5">written</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> go</font><font color="#CCCCCC"> go can handle Windows</font>

1090
00:39:30,250 --> 00:39:33,970
proxies<font color="#E5E5E5"> and read W</font><font color="#CCCCCC"> pad and all that fun</font>

1091
00:39:31,869 --> 00:39:36,089
<font color="#CCCCCC">stuff or you can write a</font><font color="#E5E5E5"> line of</font>

1092
00:39:33,970 --> 00:39:38,259
PowerShell<font color="#CCCCCC"> and it works</font><font color="#E5E5E5"> just as well so</font>

1093
00:39:36,089 --> 00:39:39,369
we've had the<font color="#E5E5E5"> same issue with DNS like</font>

1094
00:39:38,260 --> 00:39:41,470
okay we<font color="#E5E5E5"> need to shoot this at the right</font>

1095
00:39:39,369 --> 00:39:45,099
DNS server<font color="#E5E5E5"> or just let</font><font color="#CCCCCC"> Windows do the</font>

1096
00:39:41,470 --> 00:39:46,808
DNS<font color="#CCCCCC"> you talked about the configuration</font>

1097
00:39:45,099 --> 00:39:49,119
<font color="#E5E5E5">from inside the script this is not to</font>

1098
00:39:46,809 --> 00:39:51,250
say like go to line this and change this

1099
00:39:49,119 --> 00:39:53,140
this is<font color="#E5E5E5"> not to say like</font><font color="#CCCCCC"> okay here is</font>

1100
00:39:51,250 --> 00:39:54,970
said said<font color="#CCCCCC"> will change it or here's a vim</font>

1101
00:39:53,140 --> 00:39:56,799
<font color="#E5E5E5">find in replace you know just something</font>

1102
00:39:54,970 --> 00:39:58,270
<font color="#CCCCCC">at the top</font><font color="#E5E5E5"> um constants or</font><font color="#CCCCCC"> what-have-you</font>

1103
00:39:56,799 --> 00:40:02,829
<font color="#E5E5E5">is nice let's configure</font><font color="#CCCCCC"> eight your</font>

1104
00:39:58,270 --> 00:40:05,170
<font color="#CCCCCC">command-line arguments okay well then</font>

1105
00:40:02,829 --> 00:40:07,660
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> a little take away</font><font color="#E5E5E5"> IX</font><font color="#CCCCCC"> I'd</font><font color="#E5E5E5"> if you</font>

1106
00:40:05,170 --> 00:40:08,770
are<font color="#CCCCCC"> actually works pretty good</font><font color="#E5E5E5"> so again</font>

1107
00:40:07,660 --> 00:40:11,319
we're like<font color="#E5E5E5"> okay how do we run this</font>

1108
00:40:08,770 --> 00:40:13,089
they're<font color="#CCCCCC"> like our execution policy is to</font>

1109
00:40:11,319 --> 00:40:15,308
<font color="#CCCCCC">prevent that and the profiles won't let</font>

1110
00:40:13,089 --> 00:40:16,900
you do anything<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you're like okay</font>

1111
00:40:15,309 --> 00:40:17,230
<font color="#CCCCCC">we'll</font><font color="#E5E5E5"> just pull it down and see if it</font>

1112
00:40:16,900 --> 00:40:19,539
works

1113
00:40:17,230 --> 00:40:21,730
<font color="#E5E5E5">so actually work pretty</font><font color="#CCCCCC"> good and was</font>

1114
00:40:19,539 --> 00:40:23,380
nice<font color="#E5E5E5"> little</font><font color="#CCCCCC"> finding</font><font color="#E5E5E5"> for them</font><font color="#CCCCCC"> too um also</font>

1115
00:40:21,730 --> 00:40:24,609
<font color="#CCCCCC">while writing this certain certain</font>

1116
00:40:23,380 --> 00:40:27,390
<font color="#E5E5E5">managers who may or may not be in the</font>

1117
00:40:24,609 --> 00:40:30,190
room<font color="#CCCCCC"> like</font><font color="#E5E5E5"> to ask for features and</font>

1118
00:40:27,390 --> 00:40:30,759
certain managers usually know what

1119
00:40:30,190 --> 00:40:32,380
<font color="#E5E5E5">they're talking about</font>

1120
00:40:30,760 --> 00:40:34,240
<font color="#CCCCCC">historian because I don't be fired</font>

1121
00:40:32,380 --> 00:40:35,559
<font color="#E5E5E5">anyway</font><font color="#CCCCCC"> so he's like hey</font><font color="#E5E5E5"> Stuart you got</font>

1122
00:40:34,240 --> 00:40:36,759
to put you got to make you set up a user

1123
00:40:35,559 --> 00:40:37,960
agent<font color="#CCCCCC"> that's what's gonna get</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> Scott</font>

1124
00:40:36,760 --> 00:40:40,359
<font color="#E5E5E5">oh yeah you know I'm doing other</font><font color="#CCCCCC"> things</font>

1125
00:40:37,960 --> 00:40:41,650
<font color="#CCCCCC">here you gotta</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> it set up oh yeah so</font>

1126
00:40:40,359 --> 00:40:42,060
<font color="#E5E5E5">sometimes future</font><font color="#CCCCCC"> peek</font><font color="#E5E5E5"> is a good thing it</font>

1127
00:40:41,650 --> 00:40:44,670
<font color="#CCCCCC">happened</font>

1128
00:40:42,060 --> 00:40:46,590
<font color="#CCCCCC">it happened</font><font color="#E5E5E5"> but generally generally say</font>

1129
00:40:44,670 --> 00:40:49,590
no and that's less to maintain<font color="#E5E5E5"> unless</font>

1130
00:40:46,590 --> 00:40:51,360
that<font color="#CCCCCC"> can go wrong for</font><font color="#E5E5E5"> sure last</font><font color="#CCCCCC"> little</font>

1131
00:40:49,590 --> 00:40:53,100
red<font color="#CCCCCC"> takeaway is there's this blurry line</font>

1132
00:40:51,360 --> 00:40:54,180
between<font color="#E5E5E5"> what is a shell script</font><font color="#CCCCCC"> and what</font>

1133
00:40:53,100 --> 00:40:55,110
does<font color="#E5E5E5"> the shell command there between a</font>

1134
00:40:54,180 --> 00:40:57,930
script in a program that's<font color="#E5E5E5"> pretty</font>

1135
00:40:55,110 --> 00:40:59,070
obvious<font color="#CCCCCC"> compile it it's a program but</font>

1136
00:40:57,930 --> 00:41:02,580
<font color="#E5E5E5">the difference between is shell script</font>

1137
00:40:59,070 --> 00:41:04,220
in a command<font color="#E5E5E5"> go back here</font><font color="#CCCCCC"> script</font><font color="#E5E5E5"> or is</font>

1138
00:41:02,580 --> 00:41:06,120
that just a<font color="#E5E5E5"> command on four lines and</font>

1139
00:41:04,220 --> 00:41:07,709
you know we've had<font color="#E5E5E5"> people are like hey</font>

1140
00:41:06,120 --> 00:41:09,359
you<font color="#E5E5E5"> can you can do things but</font><font color="#CCCCCC"> just don't</font>

1141
00:41:07,710 --> 00:41:12,000
run any<font color="#CCCCCC"> script scripts or something we</font>

1142
00:41:09,360 --> 00:41:14,010
don't<font color="#CCCCCC"> want</font><font color="#E5E5E5"> so staying within the spirit</font>

1143
00:41:12,000 --> 00:41:17,130
of what was asked is you<font color="#CCCCCC"> gotta make</font><font color="#E5E5E5"> sure</font>

1144
00:41:14,010 --> 00:41:19,890
that<font color="#E5E5E5"> you're not gonna anger people so</font>

1145
00:41:17,130 --> 00:41:21,240
poor blue with such a<font color="#E5E5E5"> simple tool</font>

1146
00:41:19,890 --> 00:41:24,000
they're like oh it's<font color="#E5E5E5"> a simple tool no</font>

1147
00:41:21,240 --> 00:41:25,740
problem so our blue guys have come up

1148
00:41:24,000 --> 00:41:27,690
<font color="#CCCCCC">with</font><font color="#E5E5E5"> various sim queries to find</font>

1149
00:41:25,740 --> 00:41:29,729
<font color="#CCCCCC">powershell run from the</font><font color="#E5E5E5"> desktop and for</font>

1150
00:41:27,690 --> 00:41:32,100
the<font color="#E5E5E5"> download execute thing they're like</font>

1151
00:41:29,730 --> 00:41:33,120
yeah sure<font color="#E5E5E5"> we'll look for that now it's</font>

1152
00:41:32,100 --> 00:41:34,380
kind of funny<font color="#E5E5E5"> when you're like you</font><font color="#CCCCCC"> show</font>

1153
00:41:33,120 --> 00:41:36,509
somebody something<font color="#E5E5E5"> and they're like oh</font>

1154
00:41:34,380 --> 00:41:37,710
give<font color="#E5E5E5"> me a second</font><font color="#CCCCCC"> and then ten minutes</font>

1155
00:41:36,510 --> 00:41:39,930
<font color="#E5E5E5">later</font><font color="#CCCCCC"> do they come back and say hey I</font>

1156
00:41:37,710 --> 00:41:42,630
<font color="#E5E5E5">ran this query was that was that</font><font color="#CCCCCC"> you a</font>

1157
00:41:39,930 --> 00:41:46,109
month ago and<font color="#E5E5E5"> you're like no looks like</font>

1158
00:41:42,630 --> 00:41:46,950
<font color="#CCCCCC">me but that wasn't me I don't know what</font>

1159
00:41:46,110 --> 00:41:49,590
<font color="#E5E5E5">happened with</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> one they wouldn't</font>

1160
00:41:46,950 --> 00:41:51,600
tell<font color="#E5E5E5"> me so</font><font color="#CCCCCC"> blue also</font><font color="#E5E5E5"> learned that</font>

1161
00:41:49,590 --> 00:41:53,940
PowerShell profile is an<font color="#E5E5E5"> execution</font>

1162
00:41:51,600 --> 00:41:56,279
policy<font color="#E5E5E5"> and whatnot</font><font color="#CCCCCC"> they work in some</font>

1163
00:41:53,940 --> 00:41:57,570
<font color="#CCCCCC">cases if you have PowerShell to</font><font color="#E5E5E5"> for</font>

1164
00:41:56,280 --> 00:42:01,680
<font color="#E5E5E5">backwards compatibility</font><font color="#CCCCCC"> and you turn</font>

1165
00:41:57,570 --> 00:42:03,840
<font color="#E5E5E5">them off they don't</font><font color="#CCCCCC"> work very well at</font>

1166
00:42:01,680 --> 00:42:05,160
blue in this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> he</font><font color="#E5E5E5"> put code on a safe</font>

1167
00:42:03,840 --> 00:42:06,900
site and pretty much anything hosting

1168
00:42:05,160 --> 00:42:08,310
text that where you can<font color="#E5E5E5"> put up text and</font>

1169
00:42:06,900 --> 00:42:11,520
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> trusted</font><font color="#CCCCCC"> by the</font><font color="#E5E5E5"> environment it'll</font>

1170
00:42:08,310 --> 00:42:12,990
<font color="#E5E5E5">come right back down</font><font color="#CCCCCC"> so they had a blue</font>

1171
00:42:11,520 --> 00:42:14,310
team that<font color="#CCCCCC"> had a bit of a</font><font color="#E5E5E5"> mental</font>

1172
00:42:12,990 --> 00:42:17,189
adjustment about what is safe and what

1173
00:42:14,310 --> 00:42:20,160
we should allow and also that HTTP<font color="#E5E5E5"> works</font>

1174
00:42:17,190 --> 00:42:22,350
pretty good<font color="#CCCCCC"> logging needs to be used</font><font color="#E5E5E5"> and</font>

1175
00:42:20,160 --> 00:42:24,270
inspected<font color="#E5E5E5"> and if you don't you end up</font>

1176
00:42:22,350 --> 00:42:24,960
looking like<font color="#CCCCCC"> that I think</font><font color="#E5E5E5"> but you know</font>

1177
00:42:24,270 --> 00:42:26,130
they're<font color="#E5E5E5"> like hey if we got all this</font>

1178
00:42:24,960 --> 00:42:27,930
<font color="#CCCCCC">PowerShell log you can't get anything</font>

1179
00:42:26,130 --> 00:42:30,150
running<font color="#E5E5E5"> and then they're like we</font><font color="#CCCCCC"> don't</font>

1180
00:42:27,930 --> 00:42:32,669
look at the PowerShell logging so please

1181
00:42:30,150 --> 00:42:35,490
pretend<font color="#E5E5E5"> we did we've had teams find the</font>

1182
00:42:32,670 --> 00:42:37,290
<font color="#CCCCCC">beaconing detection intervals like hey</font>

1183
00:42:35,490 --> 00:42:38,520
yeah everything<font color="#CCCCCC"> no we're</font><font color="#E5E5E5"> not gonna we</font>

1184
00:42:37,290 --> 00:42:39,900
don't even<font color="#E5E5E5"> bother if things beacon at</font>

1185
00:42:38,520 --> 00:42:42,300
minute intervals because<font color="#E5E5E5"> the Maryland</font>

1186
00:42:39,900 --> 00:42:45,630
DMV MVA does that when we've had<font color="#E5E5E5"> teams</font>

1187
00:42:42,300 --> 00:42:46,910
like well<font color="#E5E5E5"> I mean an hour every</font><font color="#CCCCCC"> day it's</font>

1188
00:42:45,630 --> 00:42:48,810
not<font color="#CCCCCC"> gonna really</font><font color="#E5E5E5"> cut so it's it's</font>

1189
00:42:46,910 --> 00:42:51,810
especially<font color="#CCCCCC"> these tools nice to find</font>

1190
00:42:48,810 --> 00:42:53,220
exactly where<font color="#E5E5E5"> those bounds lie the best</font>

1191
00:42:51,810 --> 00:42:55,119
thing we found it was a blue<font color="#E5E5E5"> and a red</font>

1192
00:42:53,220 --> 00:42:57,578
thing was that PowerShell<font color="#CCCCCC"> and next</font>

1193
00:42:55,119 --> 00:42:58,660
you can use different<font color="#E5E5E5"> proxies so we were</font>

1194
00:42:57,579 --> 00:42:59,950
having a devil of a time<font color="#E5E5E5"> pulling our</font>

1195
00:42:58,660 --> 00:43:02,229
<font color="#CCCCCC">code down just typing it into</font><font color="#E5E5E5"> Explorer</font>

1196
00:42:59,950 --> 00:43:04,749
<font color="#CCCCCC">it's what the client gave us and like</font>

1197
00:43:02,229 --> 00:43:07,299
hey<font color="#CCCCCC"> I try</font><font color="#E5E5E5"> this IX</font><font color="#CCCCCC"> IWR thing</font><font color="#E5E5E5"> surely it's</font>

1198
00:43:04,749 --> 00:43:08,348
blocked<font color="#E5E5E5"> whoops</font><font color="#CCCCCC"> all right</font><font color="#E5E5E5"> so I live</font>

1199
00:43:07,299 --> 00:43:11,200
there's actually<font color="#E5E5E5"> three emulations</font>

1200
00:43:08,349 --> 00:43:12,729
apologies<font color="#CCCCCC"> what time we were we were</font>

1201
00:43:11,200 --> 00:43:15,069
having a pretty<font color="#E5E5E5"> rough time at a client</font>

1202
00:43:12,729 --> 00:43:17,649
and they're like hey get some<font color="#E5E5E5"> DGA on the</font>

1203
00:43:15,069 --> 00:43:19,299
wire you know find something<font color="#E5E5E5"> and I was</font>

1204
00:43:17,650 --> 00:43:20,739
<font color="#E5E5E5">like okay and I did this</font><font color="#CCCCCC"> and this is a</font>

1205
00:43:19,299 --> 00:43:23,140
this<font color="#CCCCCC"> is the first one</font><font color="#E5E5E5"> we'll see that</font>

1206
00:43:20,739 --> 00:43:25,930
it's<font color="#CCCCCC"> just you know really simple 30</font>

1207
00:43:23,140 --> 00:43:28,538
<font color="#E5E5E5">second tested appropriately off off</font>

1208
00:43:25,930 --> 00:43:31,210
their network but<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know it was pretty</font>

1209
00:43:28,539 --> 00:43:32,289
fast<font color="#E5E5E5"> it was it worked and then of</font><font color="#CCCCCC"> course</font>

1210
00:43:31,210 --> 00:43:34,269
they<font color="#E5E5E5"> came back and like yeah but that's</font>

1211
00:43:32,289 --> 00:43:35,979
<font color="#E5E5E5">not actually malicious but</font><font color="#CCCCCC"> I said well</font>

1212
00:43:34,269 --> 00:43:37,328
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> imagine those random bits and by</font>

1213
00:43:35,979 --> 00:43:39,308
the way the<font color="#E5E5E5"> batch random variable will</font>

1214
00:43:37,329 --> 00:43:42,910
give you like 15 ish bits of random ish

1215
00:43:39,309 --> 00:43:45,430
number<font color="#E5E5E5"> indefinitely and yeah that's not</font>

1216
00:43:42,910 --> 00:43:47,799
random<font color="#E5E5E5"> like well place dig with curl</font>

1217
00:43:45,430 --> 00:43:51,308
<font color="#E5E5E5">replace random with the md5 hash</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

1218
00:43:47,799 --> 00:43:53,019
<font color="#E5E5E5">day and I could Sh so and then you you</font>

1219
00:43:51,309 --> 00:43:54,759
<font color="#CCCCCC">know</font><font color="#E5E5E5"> you know what days are gonna be</font>

1220
00:43:53,019 --> 00:43:55,808
running<font color="#E5E5E5"> it you can hash it</font><font color="#CCCCCC"> maybe tour an</font>

1221
00:43:54,759 --> 00:43:58,029
hour in there if you want more<font color="#CCCCCC"> domains</font>

1222
00:43:55,809 --> 00:44:00,519
than anybody cares to block it was nice

1223
00:43:58,029 --> 00:44:03,579
little lesson learning<font color="#E5E5E5"> thing like to</font>

1224
00:44:00,519 --> 00:44:05,919
leave you<font color="#E5E5E5"> with some easy wins some some</font>

1225
00:44:03,579 --> 00:44:09,279
<font color="#E5E5E5">little things that you</font><font color="#CCCCCC"> can run red-blue</font>

1226
00:44:05,920 --> 00:44:11,109
management<font color="#E5E5E5"> IT whoever can run just to</font>

1227
00:44:09,279 --> 00:44:12,759
test things<font color="#CCCCCC"> so port scanning netcat has</font>

1228
00:44:11,109 --> 00:44:14,319
a<font color="#E5E5E5"> built in port scanner</font><font color="#CCCCCC"> turns</font><font color="#E5E5E5"> out yes I</font>

1229
00:44:12,759 --> 00:44:15,910
mean it doesn't<font color="#E5E5E5"> do</font><font color="#CCCCCC"> any fancy</font><font color="#E5E5E5"> but it just</font>

1230
00:44:14,319 --> 00:44:18,819
<font color="#E5E5E5">makes it since an</font><font color="#CCCCCC"> ack-ack 10 a connect</font>

1231
00:44:15,910 --> 00:44:20,229
<font color="#CCCCCC">sort of deal</font><font color="#E5E5E5"> also teeing it to port</font>

1232
00:44:18,819 --> 00:44:21,700
<font color="#CCCCCC">scanned out or whatever log file is</font>

1233
00:44:20,229 --> 00:44:23,499
great it's<font color="#CCCCCC"> really good to</font><font color="#E5E5E5"> have a</font>

1234
00:44:21,700 --> 00:44:24,960
<font color="#E5E5E5">especially</font><font color="#CCCCCC"> time-stamped copy of what</font>

1235
00:44:23,499 --> 00:44:26,890
you've done

1236
00:44:24,960 --> 00:44:28,239
lateral<font color="#E5E5E5"> movements been getting a lot of</font>

1237
00:44:26,890 --> 00:44:29,499
news lately because<font color="#E5E5E5"> generally it's hard</font>

1238
00:44:28,239 --> 00:44:32,880
to see inside<font color="#CCCCCC"> of</font><font color="#E5E5E5"> network it's</font><font color="#CCCCCC"> not as</font>

1239
00:44:29,499 --> 00:44:35,439
well instrumented<font color="#CCCCCC"> SH has that</font><font color="#E5E5E5"> built in</font>

1240
00:44:32,880 --> 00:44:36,940
it's working with<font color="#E5E5E5"> a team that were they</font>

1241
00:44:35,440 --> 00:44:38,349
were dead terrified of the wiper<font color="#E5E5E5"> that</font>

1242
00:44:36,940 --> 00:44:39,880
was that was their shtick<font color="#CCCCCC"> we were going</font>

1243
00:44:38,349 --> 00:44:41,859
to defend against a wiper<font color="#CCCCCC"> Sounion happen</font>

1244
00:44:39,880 --> 00:44:43,150
not<font color="#E5E5E5"> that long</font><font color="#CCCCCC"> before we are</font><font color="#E5E5E5"> all we have</font>

1245
00:44:41,859 --> 00:44:47,038
<font color="#CCCCCC">to plan for</font><font color="#E5E5E5"> the wiper</font>

1246
00:44:43,150 --> 00:44:47,039
what's a<font color="#CCCCCC"> Wiker</font><font color="#E5E5E5"> it's a wiper</font>

1247
00:44:47,160 --> 00:44:50,799
brute-forcing creds<font color="#CCCCCC"> test of</font><font color="#E5E5E5"> lockouts</font>

1248
00:44:49,359 --> 00:44:52,058
<font color="#CCCCCC">happen</font><font color="#E5E5E5"> on your website test if</font>

1249
00:44:50,799 --> 00:44:53,200
something's gonna alert and say hey this

1250
00:44:52,059 --> 00:44:55,390
<font color="#E5E5E5">dude logging in about a hundred</font><font color="#CCCCCC"> times</font>

1251
00:44:53,200 --> 00:44:57,910
<font color="#E5E5E5">toast if the fax machine you</font><font color="#CCCCCC"> just bought</font>

1252
00:44:55,390 --> 00:45:00,519
will let you in user share<font color="#CCCCCC"> dict words is</font>

1253
00:44:57,910 --> 00:45:03,729
on at least<font color="#E5E5E5"> max and</font><font color="#CCCCCC"> the bsd boxes and I</font>

1254
00:45:00,519 --> 00:45:04,629
think most<font color="#E5E5E5"> Linux distros last set easy</font>

1255
00:45:03,729 --> 00:45:07,450
wins

1256
00:45:04,630 --> 00:45:08,770
exfil this this is not an<font color="#E5E5E5"> original</font>

1257
00:45:07,450 --> 00:45:09,939
<font color="#E5E5E5">concept friend of mine is like</font>

1258
00:45:08,770 --> 00:45:12,160
yeah<font color="#E5E5E5"> you wouldn't believe what security</font>

1259
00:45:09,940 --> 00:45:13,990
<font color="#CCCCCC">I asked me today and he's like so we</font>

1260
00:45:12,160 --> 00:45:16,240
<font color="#E5E5E5">just had this box that had flat high</font>

1261
00:45:13,990 --> 00:45:17,350
usage<font color="#CCCCCC"> high network usage I was like</font>

1262
00:45:16,240 --> 00:45:18,779
that's weird he's like yeah somebody was

1263
00:45:17,350 --> 00:45:22,569
SC<font color="#E5E5E5"> peeing off their code base for days</font>

1264
00:45:18,780 --> 00:45:23,560
it was more<font color="#CCCCCC"> or less</font><font color="#E5E5E5"> that domain fronting</font>

1265
00:45:22,570 --> 00:45:25,960
also has been getting<font color="#CCCCCC"> a</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of news</font>

1266
00:45:23,560 --> 00:45:28,060
lately<font color="#CCCCCC"> domain burning is actually pretty</font>

1267
00:45:25,960 --> 00:45:29,710
easy to<font color="#E5E5E5"> test is that</font><font color="#CCCCCC"> you have to find</font><font color="#E5E5E5"> a</font>

1268
00:45:28,060 --> 00:45:33,400
benign domain<font color="#E5E5E5"> in a bad domain that are</font>

1269
00:45:29,710 --> 00:45:35,770
front<font color="#CCCCCC"> able please roll your own don't</font>

1270
00:45:33,400 --> 00:45:36,970
use anything you're not<font color="#E5E5E5"> allowed to DNS</font>

1271
00:45:35,770 --> 00:45:39,009
tunneling same things been getting some

1272
00:45:36,970 --> 00:45:40,629
some news lately<font color="#E5E5E5"> that will test what</font>

1273
00:45:39,010 --> 00:45:42,190
<font color="#E5E5E5">happens</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> have a bunch of queries</font>

1274
00:45:40,630 --> 00:45:45,460
to a parent domain<font color="#E5E5E5"> with different</font>

1275
00:45:42,190 --> 00:45:46,390
subdomains<font color="#CCCCCC"> eNOS over HTTP</font><font color="#E5E5E5"> especially in</font>

1276
00:45:45,460 --> 00:45:48,300
the last like<font color="#E5E5E5"> four days I've been</font>

1277
00:45:46,390 --> 00:45:50,140
<font color="#E5E5E5">noticing a lot on Twitter especially</font>

1278
00:45:48,300 --> 00:45:51,550
<font color="#CCCCCC">Google's</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> enough to provide us</font>

1279
00:45:50,140 --> 00:45:54,310
<font color="#E5E5E5">something replace name with something</font>

1280
00:45:51,550 --> 00:45:55,630
<font color="#E5E5E5">that is not going to get anybody</font><font color="#CCCCCC"> I mean</font>

1281
00:45:54,310 --> 00:45:57,070
don't don't<font color="#E5E5E5"> use something actually</font>

1282
00:45:55,630 --> 00:45:58,240
malicious don't be like a threat Intel

1283
00:45:57,070 --> 00:45:59,350
<font color="#E5E5E5">unless that's what you're testing</font><font color="#CCCCCC"> Wester</font>

1284
00:45:58,240 --> 00:46:01,600
testing if<font color="#CCCCCC"> you're threatened till stuff</font>

1285
00:45:59,350 --> 00:46:05,560
works<font color="#CCCCCC"> and then for the managers who like</font>

1286
00:46:01,600 --> 00:46:13,330
buzzwords<font color="#CCCCCC"> DNS over to me</font><font color="#E5E5E5"> in front of</font>

1287
00:46:05,560 --> 00:46:15,009
<font color="#CCCCCC">HTTPS</font><font color="#E5E5E5"> works pretty good - thanks - all</font>

1288
00:46:13,330 --> 00:46:16,420
<font color="#E5E5E5">right so I hope you guys got some</font>

1289
00:46:15,010 --> 00:46:21,940
<font color="#E5E5E5">entertainment out</font><font color="#CCCCCC"> of that imagine</font>

1290
00:46:16,420 --> 00:46:25,420
<font color="#E5E5E5">working with them all</font><font color="#CCCCCC"> right he likes</font>

1291
00:46:21,940 --> 00:46:27,160
cats<font color="#CCCCCC"> as you</font><font color="#E5E5E5"> can see so some of the key</font>

1292
00:46:25,420 --> 00:46:30,060
takeaways<font color="#E5E5E5"> from what we discussed today</font>

1293
00:46:27,160 --> 00:46:32,259
<font color="#E5E5E5">defenses are complex threat emulation</font>

1294
00:46:30,060 --> 00:46:34,930
<font color="#CCCCCC">you know allows the fenders to</font><font color="#E5E5E5"> kind of</font>

1295
00:46:32,260 --> 00:46:37,120
<font color="#E5E5E5">test this red team's eye I recommend you</font>

1296
00:46:34,930 --> 00:46:39,220
kind of add this to your arsenal<font color="#CCCCCC"> but</font>

1297
00:46:37,120 --> 00:46:41,350
blue<font color="#CCCCCC"> team's</font><font color="#E5E5E5"> everything we did there is</font>

1298
00:46:39,220 --> 00:46:42,700
<font color="#E5E5E5">very easy and emulate</font><font color="#CCCCCC"> a lot of the tools</font>

1299
00:46:41,350 --> 00:46:46,080
<font color="#CCCCCC">that</font><font color="#E5E5E5"> Stu</font>

1300
00:46:42,700 --> 00:46:49,779
discussed earlier are being released

1301
00:46:46,080 --> 00:46:52,000
<font color="#CCCCCC">planning I don't know how many proxies</font>

1302
00:46:49,780 --> 00:46:53,470
we've run into how many<font color="#E5E5E5"> firewalls we run</font>

1303
00:46:52,000 --> 00:46:55,690
into signature things that the customer

1304
00:46:53,470 --> 00:46:58,660
<font color="#E5E5E5">the client doesn't know this in their</font>

1305
00:46:55,690 --> 00:47:00,970
environment to cause us issues<font color="#CCCCCC"> when we</font>

1306
00:46:58,660 --> 00:47:04,480
<font color="#E5E5E5">arrive</font><font color="#CCCCCC"> and that's with really well</font>

1307
00:47:00,970 --> 00:47:07,330
<font color="#E5E5E5">rehearsal good rehearsals prior to to</font>

1308
00:47:04,480 --> 00:47:08,080
our engagements and as you saw some<font color="#E5E5E5"> of</font>

1309
00:47:07,330 --> 00:47:10,900
these emulation

1310
00:47:08,080 --> 00:47:12,730
they're just<font color="#E5E5E5"> PowerShell one-liners from</font>

1311
00:47:10,900 --> 00:47:14,560
many folks<font color="#E5E5E5"> in the room could because</font>

1312
00:47:12,730 --> 00:47:16,330
<font color="#E5E5E5">spin these up in seconds and they have</font>

1313
00:47:14,560 --> 00:47:18,310
<font color="#E5E5E5">just great value without having to go</font>

1314
00:47:16,330 --> 00:47:20,259
out and<font color="#CCCCCC"> buy a you know third-party tool</font>

1315
00:47:18,310 --> 00:47:21,310
or you know fancy license to do these

1316
00:47:20,260 --> 00:47:23,380
things

1317
00:47:21,310 --> 00:47:25,720
<font color="#CCCCCC">I would say don't</font><font color="#E5E5E5"> invest in those</font><font color="#CCCCCC"> things</font>

1318
00:47:23,380 --> 00:47:29,530
<font color="#E5E5E5">until you have</font><font color="#CCCCCC"> proven that</font><font color="#E5E5E5"> these things</font>

1319
00:47:25,720 --> 00:47:31,660
<font color="#E5E5E5">get caught and then simple tools you</font>

1320
00:47:29,530 --> 00:47:34,090
know some of<font color="#CCCCCC"> these are</font><font color="#E5E5E5"> you know a couple</font>

1321
00:47:31,660 --> 00:47:36,520
megabyte binaries<font color="#E5E5E5"> that's just because go</font>

1322
00:47:34,090 --> 00:47:39,130
is really<font color="#E5E5E5"> fat when you compile it</font>

1323
00:47:36,520 --> 00:47:42,370
and the rest and the<font color="#CCCCCC"> rest is you</font><font color="#E5E5E5"> know</font>

1324
00:47:39,130 --> 00:47:44,250
again<font color="#E5E5E5"> the one-liners</font><font color="#CCCCCC"> and then always a</font>

1325
00:47:42,370 --> 00:47:47,620
challenge challenge the assumptions

1326
00:47:44,250 --> 00:47:48,910
<font color="#E5E5E5">because hey you know cuz cuz a tool says</font>

1327
00:47:47,620 --> 00:47:51,790
it does something doesn't<font color="#E5E5E5"> necessarily</font>

1328
00:47:48,910 --> 00:47:53,440
<font color="#CCCCCC">mean that</font><font color="#E5E5E5"> and also sometimes the</font><font color="#CCCCCC"> the</font>

1329
00:47:51,790 --> 00:47:56,380
only<font color="#E5E5E5"> adversaries is some of these</font>

1330
00:47:53,440 --> 00:47:58,750
clients<font color="#E5E5E5"> are seeing or</font><font color="#CCCCCC"> read teams that</font>

1331
00:47:56,380 --> 00:48:01,470
are sharing techniques so<font color="#E5E5E5"> they may be</font>

1332
00:47:58,750 --> 00:48:03,760
<font color="#E5E5E5">getting really good at defending against</font>

1333
00:48:01,470 --> 00:48:05,560
you know the<font color="#CCCCCC"> different red teams are</font>

1334
00:48:03,760 --> 00:48:07,570
<font color="#CCCCCC">partnered with but are they ready for</font>

1335
00:48:05,560 --> 00:48:10,420
that<font color="#E5E5E5"> apt</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> kind of come in so</font>

1336
00:48:07,570 --> 00:48:12,880
iterating through these<font color="#E5E5E5"> miniscule</font>

1337
00:48:10,420 --> 00:48:16,810
<font color="#E5E5E5">thready emulation scenarios as you know</font>

1338
00:48:12,880 --> 00:48:18,070
be pretty<font color="#E5E5E5"> beneficial</font><font color="#CCCCCC"> so where do you go</font>

1339
00:48:16,810 --> 00:48:20,380
for more<font color="#CCCCCC"> information</font><font color="#E5E5E5"> still kind of</font>

1340
00:48:18,070 --> 00:48:23,650
<font color="#E5E5E5">talked</font><font color="#CCCCCC"> about he loves tore up tour he</font>

1341
00:48:20,380 --> 00:48:26,520
<font color="#CCCCCC">loves tour also</font><font color="#E5E5E5"> he loves</font><font color="#CCCCCC"> Go Go</font><font color="#E5E5E5"> language</font>

1342
00:48:23,650 --> 00:48:30,040
for developing some of<font color="#E5E5E5"> our emulations</font>

1343
00:48:26,520 --> 00:48:33,700
<font color="#CCCCCC">he's released</font><font color="#E5E5E5"> DNS botnet publicly and a</font>

1344
00:48:30,040 --> 00:48:35,650
PS PS beacon we<font color="#E5E5E5"> through a gist out there</font>

1345
00:48:33,700 --> 00:48:38,890
for<font color="#E5E5E5"> it and then some of our easy wins</font>

1346
00:48:35,650 --> 00:48:41,350
<font color="#E5E5E5">that you saw on the last two slides</font><font color="#CCCCCC"> you</font>

1347
00:48:38,890 --> 00:48:43,620
briefed<font color="#CCCCCC"> so you can go and</font><font color="#E5E5E5"> pull all those</font>

1348
00:48:41,350 --> 00:48:43,620
down

1349
00:48:47,950 --> 00:48:50,490
<font color="#E5E5E5">all right</font>

1350
00:48:59,070 --> 00:49:05,010
awesome<font color="#E5E5E5"> so we used to work for Air Force</font>

1351
00:49:02,910 --> 00:49:07,980
general and we were told we have 50

1352
00:49:05,010 --> 00:49:11,580
minutes<font color="#E5E5E5"> so we're sticking to that any</font>

1353
00:49:07,980 --> 00:49:13,920
questions<font color="#CCCCCC"> any air force in the room time</font>

1354
00:49:11,580 --> 00:49:16,560
hacks things like that<font color="#E5E5E5"> no time on target</font>

1355
00:49:13,920 --> 00:49:18,990
<font color="#CCCCCC">no all right so here's how you getting</font>

1356
00:49:16,560 --> 00:49:20,640
in touch<font color="#CCCCCC"> with us if there's any</font>

1357
00:49:18,990 --> 00:49:24,799
questions we could we have we have a<font color="#E5E5E5"> few</font>

1358
00:49:20,640 --> 00:49:24,799
minutes<font color="#CCCCCC"> also we can talk outside</font>

1359
00:49:25,590 --> 00:49:32,090
[Applause]

