1
00:00:00,030 --> 00:00:05,069
besides DC would like to thank all of

2
00:00:02,280 --> 00:00:07,470
our sponsors and a special thank<font color="#E5E5E5"> you to</font>

3
00:00:05,069 --> 00:00:10,710
all<font color="#E5E5E5"> of our speakers</font><font color="#CCCCCC"> volunteers and</font>

4
00:00:07,470 --> 00:00:13,170
organizers for making 2018<font color="#E5E5E5"> a success</font>

5
00:00:10,710 --> 00:00:15,480
<font color="#E5E5E5">good morning everybody</font><font color="#CCCCCC"> so we're gonna</font>

6
00:00:13,170 --> 00:00:17,550
kick off here today the<font color="#E5E5E5"> post lunch track</font>

7
00:00:15,480 --> 00:00:20,460
which<font color="#E5E5E5"> is always the best</font><font color="#CCCCCC"> one to be try</font>

8
00:00:17,550 --> 00:00:23,070
to<font color="#E5E5E5"> keep you guys</font><font color="#CCCCCC"> vigor ated and a</font><font color="#E5E5E5"> week</font>

9
00:00:20,460 --> 00:00:24,330
here today<font color="#E5E5E5"> so the talk here in today is</font>

10
00:00:23,070 --> 00:00:24,750
unraveling the threat of<font color="#CCCCCC"> chromebase</font>

11
00:00:24,330 --> 00:00:26,580
<font color="#CCCCCC">power</font>

12
00:00:24,750 --> 00:00:28,500
talking about<font color="#CCCCCC"> maori in</font><font color="#E5E5E5"> your browser</font><font color="#CCCCCC"> and</font>

13
00:00:26,580 --> 00:00:30,538
<font color="#CCCCCC">uh</font><font color="#E5E5E5"> talk about a little</font><font color="#CCCCCC"> bit</font><font color="#E5E5E5"> of a war</font>

14
00:00:28,500 --> 00:00:32,430
story we have and<font color="#E5E5E5"> I've been my name is</font>

15
00:00:30,539 --> 00:00:35,730
Justin<font color="#CCCCCC"> Werner</font><font color="#E5E5E5"> I'm a principal security</font>

16
00:00:32,430 --> 00:00:37,140
engineer with gigamon<font color="#E5E5E5"> formerly spent</font>

17
00:00:35,730 --> 00:00:38,099
some<font color="#E5E5E5"> time in the military working for</font>

18
00:00:37,140 --> 00:00:40,020
the US<font color="#E5E5E5"> Air Force doing</font>

19
00:00:38,100 --> 00:00:41,670
counterintelligence work<font color="#E5E5E5"> spent three</font>

20
00:00:40,020 --> 00:00:43,770
years<font color="#E5E5E5"> breaking into places which really</font>

21
00:00:41,670 --> 00:00:45,780
shaped my view a lot of threat

22
00:00:43,770 --> 00:00:47,700
operations<font color="#E5E5E5"> having to actually go do it</font>

23
00:00:45,780 --> 00:00:49,829
<font color="#CCCCCC">learn about the perspective they get I</font>

24
00:00:47,700 --> 00:00:51,180
was very valuable<font color="#E5E5E5"> there I worked</font><font color="#CCCCCC"> with</font>

25
00:00:49,829 --> 00:00:52,829
various<font color="#E5E5E5"> groups adopt a threat</font><font color="#CCCCCC"> division</font>

26
00:00:51,180 --> 00:00:55,410
and then a<font color="#E5E5E5"> natural break occurred which</font>

27
00:00:52,829 --> 00:00:57,270
<font color="#CCCCCC">led me to work with iceberg which became</font>

28
00:00:55,410 --> 00:00:59,038
<font color="#CCCCCC">gigamon I like</font><font color="#E5E5E5"> to be a little bit more</font>

29
00:00:57,270 --> 00:01:00,870
human so I'm<font color="#E5E5E5"> not</font><font color="#CCCCCC"> just a work robot I</font>

30
00:00:59,039 --> 00:01:03,090
have<font color="#CCCCCC"> a hacker wife so</font><font color="#E5E5E5"> I married</font><font color="#CCCCCC"> into the</font>

31
00:01:00,870 --> 00:01:04,830
hacker community<font color="#CCCCCC"> some people hate it</font>

32
00:01:03,090 --> 00:01:06,330
<font color="#E5E5E5">some people love it</font><font color="#CCCCCC"> I personally enjoy</font>

33
00:01:04,830 --> 00:01:08,100
it a<font color="#E5E5E5"> lot and have a young daughter two</font>

34
00:01:06,330 --> 00:01:09,330
<font color="#CCCCCC">years old and</font><font color="#E5E5E5"> I do a lot of volunteer</font>

35
00:01:08,100 --> 00:01:11,939
<font color="#CCCCCC">work and Disaster Response</font><font color="#E5E5E5"> and relief</font>

36
00:01:09,330 --> 00:01:15,000
stuff<font color="#CCCCCC"> tend the fun ways to</font><font color="#E5E5E5"> get away from</font>

37
00:01:11,939 --> 00:01:15,869
the<font color="#CCCCCC"> computer and enjoy the day</font><font color="#E5E5E5"> hi</font>

38
00:01:15,000 --> 00:01:18,540
everyone

39
00:01:15,869 --> 00:01:21,979
my name<font color="#E5E5E5"> is Spencer Walden I'm a security</font>

40
00:01:18,540 --> 00:01:24,390
<font color="#E5E5E5">engineer at gigamon</font><font color="#CCCCCC"> 8er</font><font color="#E5E5E5"> as well</font><font color="#CCCCCC"> I</font>

41
00:01:21,979 --> 00:01:28,400
graduated<font color="#CCCCCC"> from the University of</font>

42
00:01:24,390 --> 00:01:33,090
Washington<font color="#E5E5E5"> Seattle other Washington</font><font color="#CCCCCC"> a</font>

43
00:01:28,400 --> 00:01:35,729
year and a half ago<font color="#CCCCCC"> I've been at iceberg</font>

44
00:01:33,090 --> 00:01:39,799
<font color="#E5E5E5">slash gigamon for two and a half years</font>

45
00:01:35,729 --> 00:01:43,649
<font color="#CCCCCC">now and while I was at u-dub I also did</font>

46
00:01:39,799 --> 00:01:45,659
<font color="#E5E5E5">undergraduate research where I actually</font>

47
00:01:43,649 --> 00:01:48,030
worked on a Chrome extension project

48
00:01:45,659 --> 00:01:50,460
that was super<font color="#CCCCCC"> cool</font><font color="#E5E5E5"> it's discontinued</font>

49
00:01:48,030 --> 00:01:54,119
now but you<font color="#E5E5E5"> should check it out it's</font>

50
00:01:50,460 --> 00:01:56,939
<font color="#CCCCCC">really</font><font color="#E5E5E5"> a cool project</font><font color="#CCCCCC"> and yeah I'm</font>

51
00:01:54,119 --> 00:01:59,369
really<font color="#CCCCCC"> interested</font><font color="#E5E5E5"> in like malware and</font>

52
00:01:56,939 --> 00:02:02,789
you know the different methods that

53
00:01:59,369 --> 00:02:03,509
adversary is used to communicate<font color="#E5E5E5"> and</font>

54
00:02:02,790 --> 00:02:06,450
then

55
00:02:03,509 --> 00:02:09,149
you know<font color="#E5E5E5"> covertly and then working to</font>

56
00:02:06,450 --> 00:02:11,550
detect<font color="#E5E5E5"> those types of things it's it's</font>

57
00:02:09,149 --> 00:02:21,540
<font color="#E5E5E5">fun the whole cat and mouse game</font>

58
00:02:11,550 --> 00:02:27,420
going on there<font color="#E5E5E5"> so living</font><font color="#CCCCCC"> into this</font><font color="#E5E5E5"> who</font>

59
00:02:21,540 --> 00:02:29,579
here<font color="#CCCCCC"> has used</font><font color="#E5E5E5"> a Chrome extension</font><font color="#CCCCCC"> alright</font>

60
00:02:27,420 --> 00:02:32,488
<font color="#E5E5E5">this is relevant</font>

61
00:02:29,580 --> 00:02:35,489
who here has developed<font color="#E5E5E5"> a Chrome</font>

62
00:02:32,489 --> 00:02:39,900
extension or work to<font color="#E5E5E5"> develop one okay</font>

63
00:02:35,489 --> 00:02:44,700
<font color="#E5E5E5">less people but cool so this is gonna be</font>

64
00:02:39,900 --> 00:02:47,180
new for some of you<font color="#E5E5E5"> it's pretty simple</font><font color="#CCCCCC"> I</font>

65
00:02:44,700 --> 00:02:48,980
just<font color="#CCCCCC"> ripped this straight from Google's</font>

66
00:02:47,180 --> 00:02:50,700
documentation which was really<font color="#E5E5E5"> good</font>

67
00:02:48,980 --> 00:02:53,459
<font color="#CCCCCC">super straightforward</font><font color="#E5E5E5"> to make an</font>

68
00:02:50,700 --> 00:02:56,099
extension<font color="#E5E5E5"> basically it's it's just like</font>

69
00:02:53,459 --> 00:02:58,640
a<font color="#E5E5E5"> web page</font><font color="#CCCCCC"> it's just some HTML CSS</font>

70
00:02:56,099 --> 00:03:01,828
<font color="#E5E5E5">JavaScript images whatever you need</font>

71
00:02:58,640 --> 00:03:04,200
<font color="#CCCCCC">thrown into a folder you have</font><font color="#E5E5E5"> the exact</font>

72
00:03:01,829 --> 00:03:09,090
<font color="#CCCCCC">same things that you can do with web</font>

73
00:03:04,200 --> 00:03:11,220
page including XML HTTP requests which

74
00:03:09,090 --> 00:03:14,519
are basically web requests you can<font color="#E5E5E5"> make</font>

75
00:03:11,220 --> 00:03:18,420
<font color="#E5E5E5">from JavaScript</font><font color="#CCCCCC"> the interesting thing</font>

76
00:03:14,519 --> 00:03:20,940
<font color="#E5E5E5">here is that unlike working in a web</font>

77
00:03:18,420 --> 00:03:25,170
<font color="#CCCCCC">page a</font><font color="#E5E5E5"> Chrome</font><font color="#CCCCCC"> extension will actually</font>

78
00:03:20,940 --> 00:03:26,760
have access to<font color="#CCCCCC"> Chrome api's</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> way you</font>

79
00:03:25,170 --> 00:03:28,798
can actually extend<font color="#CCCCCC"> browser</font>

80
00:03:26,760 --> 00:03:33,810
functionalities such as<font color="#E5E5E5"> bookmarks and</font>

81
00:03:28,799 --> 00:03:37,349
tabs and lots of other fun stuff<font color="#CCCCCC"> what</font>

82
00:03:33,810 --> 00:03:39,599
does it<font color="#E5E5E5"> look like</font><font color="#CCCCCC"> yep here's folder</font><font color="#E5E5E5"> of</font>

83
00:03:37,349 --> 00:03:42,649
an<font color="#E5E5E5"> example Chrome extension</font>

84
00:03:39,599 --> 00:03:46,230
basically just any kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> normal</font>

85
00:03:42,650 --> 00:03:48,269
<font color="#CCCCCC">website kind</font><font color="#E5E5E5"> of feel</font><font color="#CCCCCC"> to it</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can you</font>

86
00:03:46,230 --> 00:03:50,910
know structure<font color="#E5E5E5"> however you want to the</font>

87
00:03:48,269 --> 00:03:53,569
important thing here<font color="#CCCCCC"> is that you need</font><font color="#E5E5E5"> a</font>

88
00:03:50,910 --> 00:03:59,010
manifest file<font color="#E5E5E5"> which is a very specific</font>

89
00:03:53,569 --> 00:04:01,980
format<font color="#E5E5E5"> a JSON file</font><font color="#CCCCCC"> and it basically just</font>

90
00:03:59,010 --> 00:04:03,510
<font color="#E5E5E5">specifies kind of how your extensions</font>

91
00:04:01,980 --> 00:04:08,880
supposed to fit together<font color="#CCCCCC"> how do all</font>

92
00:04:03,510 --> 00:04:12,159
these<font color="#E5E5E5"> elements work together so what is</font>

93
00:04:08,880 --> 00:04:14,590
the manifest file actually<font color="#CCCCCC"> have in it</font>

94
00:04:12,159 --> 00:04:17,709
some of its kind<font color="#E5E5E5"> of not</font><font color="#CCCCCC"> that relevant</font>

95
00:04:14,590 --> 00:04:19,750
<font color="#E5E5E5">for</font><font color="#CCCCCC"> our purposes it's just kind of</font><font color="#E5E5E5"> ui/ux</font>

96
00:04:17,709 --> 00:04:22,840
you know how what's what's it look like

97
00:04:19,750 --> 00:04:25,780
in<font color="#CCCCCC"> the browser does it have a pop-up</font>

98
00:04:22,840 --> 00:04:28,570
<font color="#CCCCCC">does that</font><font color="#E5E5E5"> open tabs blah blah metadata</font>

99
00:04:25,780 --> 00:04:32,289
<font color="#E5E5E5">what version is it who is the author and</font>

100
00:04:28,570 --> 00:04:34,270
<font color="#CCCCCC">then the kind of</font><font color="#E5E5E5"> the meat</font><font color="#CCCCCC"> of this is the</font>

101
00:04:32,290 --> 00:04:39,490
permissions<font color="#E5E5E5"> and what I called</font>

102
00:04:34,270 --> 00:04:41,229
registration<font color="#E5E5E5"> which is basically you you</font>

103
00:04:39,490 --> 00:04:42,699
specify like<font color="#E5E5E5"> a background script and</font>

104
00:04:41,229 --> 00:04:45,820
this<font color="#E5E5E5"> will run at all times in the</font>

105
00:04:42,699 --> 00:04:48,550
<font color="#E5E5E5">context of the browser or the</font><font color="#CCCCCC"> content</font>

106
00:04:45,820 --> 00:04:50,800
scripts which<font color="#E5E5E5"> you you basically allow to</font>

107
00:04:48,550 --> 00:04:54,090
inject into<font color="#E5E5E5"> different web pages based on</font>

108
00:04:50,800 --> 00:04:57,190
a<font color="#E5E5E5"> certain set of</font><font color="#CCCCCC"> conditions and</font>

109
00:04:54,090 --> 00:04:59,260
registration also<font color="#E5E5E5"> might cover or</font><font color="#CCCCCC"> I</font>

110
00:04:57,190 --> 00:05:02,949
consider to cover like things like<font color="#E5E5E5"> the</font>

111
00:04:59,260 --> 00:05:05,740
content security policy<font color="#CCCCCC"> and then the</font>

112
00:05:02,949 --> 00:05:07,330
permissions<font color="#E5E5E5"> are basically the</font><font color="#CCCCCC"> different</font>

113
00:05:05,740 --> 00:05:11,080
chrome<font color="#CCCCCC"> api's you want to interact with I</font>

114
00:05:07,330 --> 00:05:12,909
have to declare these some<font color="#E5E5E5"> of them will</font>

115
00:05:11,080 --> 00:05:14,889
actually<font color="#E5E5E5"> prompt the user you may have</font>

116
00:05:12,910 --> 00:05:16,330
seen this you know<font color="#E5E5E5"> blah blah blah can</font>

117
00:05:14,889 --> 00:05:20,039
read and change all the data on the

118
00:05:16,330 --> 00:05:24,400
<font color="#CCCCCC">websites you visit</font><font color="#E5E5E5"> you know kind of</font>

119
00:05:20,039 --> 00:05:27,389
scary sounding<font color="#E5E5E5"> and it's meant to because</font>

120
00:05:24,400 --> 00:05:30,789
there's a lot<font color="#E5E5E5"> of power</font><font color="#CCCCCC"> you get with</font><font color="#E5E5E5"> this</font>

121
00:05:27,389 --> 00:05:32,770
some interesting permissions to call out

122
00:05:30,789 --> 00:05:36,599
<font color="#E5E5E5">that I found there's this background</font>

123
00:05:32,770 --> 00:05:38,830
<font color="#E5E5E5">permission you can set where the</font>

124
00:05:36,599 --> 00:05:42,940
extension will actually come up<font color="#E5E5E5"> with</font><font color="#CCCCCC"> the</font>

125
00:05:38,830 --> 00:05:44,979
<font color="#CCCCCC">system so</font><font color="#E5E5E5"> this image with process</font>

126
00:05:42,940 --> 00:05:47,410
<font color="#CCCCCC">Explorer</font><font color="#E5E5E5"> is showing that chrome is</font>

127
00:05:44,979 --> 00:05:49,539
<font color="#CCCCCC">actually running because of an extension</font>

128
00:05:47,410 --> 00:05:51,099
that<font color="#CCCCCC"> has a background</font><font color="#E5E5E5"> permission set but</font>

129
00:05:49,539 --> 00:05:53,800
you'll<font color="#CCCCCC"> notice in the windows taskbar</font>

130
00:05:51,099 --> 00:05:56,800
<font color="#E5E5E5">chrome isn't actually open there's no</font>

131
00:05:53,800 --> 00:06:02,949
blue line there<font color="#CCCCCC"> so</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of an</font>

132
00:05:56,800 --> 00:06:05,169
<font color="#E5E5E5">interesting thing right so Google</font>

133
00:06:02,949 --> 00:06:07,750
<font color="#CCCCCC">actually does</font><font color="#E5E5E5"> review like all the</font>

134
00:06:05,169 --> 00:06:09,940
extensions<font color="#CCCCCC"> that go into their store they</font>

135
00:06:07,750 --> 00:06:13,349
have an automatic<font color="#CCCCCC"> process</font><font color="#E5E5E5"> and that will</font>

136
00:06:09,940 --> 00:06:16,490
kind<font color="#E5E5E5"> of generate a score</font><font color="#CCCCCC"> that score will</font>

137
00:06:13,349 --> 00:06:19,849
if it's low enough<font color="#E5E5E5"> trigger like a manual</font>

138
00:06:16,490 --> 00:06:22,310
<font color="#E5E5E5">view process and they'll actually do</font>

139
00:06:19,849 --> 00:06:23,750
<font color="#E5E5E5">takedowns</font><font color="#CCCCCC"> on on different</font><font color="#E5E5E5"> extensions if</font>

140
00:06:22,310 --> 00:06:27,800
they don't if they're not up<font color="#E5E5E5"> to</font><font color="#CCCCCC"> snuff</font>

141
00:06:23,750 --> 00:06:32,389
right<font color="#CCCCCC"> one</font><font color="#E5E5E5"> example was you block origin</font>

142
00:06:27,800 --> 00:06:34,400
<font color="#E5E5E5">I was taken down for obfuscation</font><font color="#CCCCCC"> in 2015</font>

143
00:06:32,389 --> 00:06:39,620
kind of the developer made a big stink

144
00:06:34,400 --> 00:06:41,750
about<font color="#CCCCCC"> it uh-huh but yeah so</font><font color="#E5E5E5"> with working</font>

145
00:06:39,620 --> 00:06:44,960
with our<font color="#E5E5E5"> their team when we found all</font>

146
00:06:41,750 --> 00:06:46,699
this<font color="#CCCCCC"> malware</font><font color="#E5E5E5"> they were super supportive</font>

147
00:06:44,960 --> 00:06:53,599
and<font color="#E5E5E5"> it was</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> good working</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> them</font>

148
00:06:46,699 --> 00:06:54,889
<font color="#E5E5E5">to get stuff cleaned up yeah</font><font color="#CCCCCC"> so how</font>

149
00:06:53,599 --> 00:06:56,419
<font color="#CCCCCC">often when you when you use your</font>

150
00:06:54,889 --> 00:07:01,150
<font color="#CCCCCC">computer how often do you</font><font color="#E5E5E5"> have the</font>

151
00:06:56,419 --> 00:07:03,318
browser open<font color="#E5E5E5"> 100% of the time yeah</font>

152
00:07:01,150 --> 00:07:05,479
browsers are running like on pretty<font color="#E5E5E5"> much</font>

153
00:07:03,319 --> 00:07:07,909
every system<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> time like in</font>

154
00:07:05,479 --> 00:07:09,409
Seattle we've got the<font color="#E5E5E5"> the light-rail and</font>

155
00:07:07,909 --> 00:07:11,090
<font color="#E5E5E5">that's got like TV screens showing</font><font color="#CCCCCC"> you</font>

156
00:07:09,409 --> 00:07:13,669
know the<font color="#E5E5E5"> schedule of the Light Rail</font>

157
00:07:11,090 --> 00:07:17,080
trains<font color="#E5E5E5"> sometimes it crashes and you know</font>

158
00:07:13,669 --> 00:07:20,630
you<font color="#E5E5E5"> get</font><font color="#CCCCCC"> that off snap like</font><font color="#E5E5E5"> Chrome</font>

159
00:07:17,080 --> 00:07:21,800
<font color="#CCCCCC">notification in the page and</font><font color="#E5E5E5"> so I mean</font>

160
00:07:20,630 --> 00:07:25,180
it's it's running<font color="#E5E5E5"> on all kinds of</font>

161
00:07:21,800 --> 00:07:27,830
different<font color="#E5E5E5"> systems</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so it's really</font>

162
00:07:25,180 --> 00:07:30,770
powerful right like to get a<font color="#CCCCCC"> plug-in</font>

163
00:07:27,830 --> 00:07:33,530
<font color="#E5E5E5">into one of these things and one</font><font color="#CCCCCC"> of the</font>

164
00:07:30,770 --> 00:07:35,870
cool kind of cool but kind<font color="#E5E5E5"> of bad</font><font color="#CCCCCC"> may be</font>

165
00:07:33,530 --> 00:07:38,239
things is that the web extension API

166
00:07:35,870 --> 00:07:39,349
which is being pioneered by<font color="#E5E5E5"> Chrome it's</font>

167
00:07:38,240 --> 00:07:42,500
being<font color="#CCCCCC"> adopted into the</font><font color="#E5E5E5"> different</font>

168
00:07:39,349 --> 00:07:44,419
browsers so<font color="#E5E5E5"> edge chrome all the major</font>

169
00:07:42,500 --> 00:07:45,110
<font color="#CCCCCC">ones are except for</font><font color="#E5E5E5"> Safari for some</font>

170
00:07:44,419 --> 00:07:48,198
reason

171
00:07:45,110 --> 00:07:50,270
<font color="#CCCCCC">all right opting this framework</font><font color="#E5E5E5"> so if</font>

172
00:07:48,199 --> 00:07:52,280
you write a malicious<font color="#E5E5E5"> Chrome extension</font>

173
00:07:50,270 --> 00:07:53,560
you could<font color="#E5E5E5"> potentially just easily port</font>

174
00:07:52,280 --> 00:07:59,330
it<font color="#CCCCCC"> over the different rousers which</font>

175
00:07:53,560 --> 00:08:01,190
could be cool so what led us here<font color="#E5E5E5"> today</font>

176
00:07:59,330 --> 00:08:02,990
what got us<font color="#E5E5E5"> we're a</font><font color="#CCCCCC"> network security</font>

177
00:08:01,190 --> 00:08:06,110
company what got us<font color="#CCCCCC"> on this rant and</font>

178
00:08:02,990 --> 00:08:07,400
soapbox of<font color="#E5E5E5"> Chrome extensions</font><font color="#CCCCCC"> frankly the</font>

179
00:08:06,110 --> 00:08:10,340
<font color="#CCCCCC">the reason a</font><font color="#E5E5E5"> goddess Aries because we</font>

180
00:08:07,400 --> 00:08:13,008
saw<font color="#CCCCCC"> it used in the</font><font color="#E5E5E5"> wild</font><font color="#CCCCCC"> and so we will</font>

181
00:08:10,340 --> 00:08:14,840
monitoring customer environment<font color="#E5E5E5"> like to</font>

182
00:08:13,009 --> 00:08:16,190
say that something sexy happened and we

183
00:08:14,840 --> 00:08:17,780
that's magic analytic<font color="#E5E5E5"> that found all</font>

184
00:08:16,190 --> 00:08:18,919
evil but<font color="#CCCCCC"> it</font><font color="#E5E5E5"> simply wasn't the case we</font>

185
00:08:17,780 --> 00:08:20,299
had<font color="#E5E5E5"> an analyst going through network</font>

186
00:08:18,919 --> 00:08:22,969
traffic<font color="#E5E5E5"> notice something suspicious</font>

187
00:08:20,300 --> 00:08:24,680
<font color="#CCCCCC">which is how 90%</font><font color="#E5E5E5"> of things are found and</font>

188
00:08:22,970 --> 00:08:26,480
kind of started on pulling<font color="#E5E5E5"> on that</font>

189
00:08:24,680 --> 00:08:28,040
<font color="#E5E5E5">thread what they essentially discovered</font>

190
00:08:26,480 --> 00:08:31,280
was that there<font color="#E5E5E5"> was a ton of HTTP traffic</font>

191
00:08:28,040 --> 00:08:33,409
<font color="#E5E5E5">- really funny looking domains and the</font>

192
00:08:31,280 --> 00:08:35,348
HTTP traffic was coming<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> Chrome</font>

193
00:08:33,409 --> 00:08:38,150
extension you can<font color="#E5E5E5"> see that via the</font>

194
00:08:35,349 --> 00:08:39,589
<font color="#CCCCCC">origin header and the peak app snapshot</font>

195
00:08:38,150 --> 00:08:41,029
on<font color="#CCCCCC"> the bottom right</font><font color="#E5E5E5"> essentially they</font>

196
00:08:39,589 --> 00:08:43,039
could see<font color="#E5E5E5"> exactly what extension</font><font color="#CCCCCC"> was</font>

197
00:08:41,029 --> 00:08:45,100
coming from<font color="#CCCCCC"> they continue</font><font color="#E5E5E5"> to unravel</font>

198
00:08:43,039 --> 00:08:48,650
that thread<font color="#CCCCCC"> and discovered an extension</font>

199
00:08:45,100 --> 00:08:50,510
<font color="#E5E5E5">that was</font><font color="#CCCCCC"> prevalent across massive</font>

200
00:08:48,650 --> 00:08:52,760
massive<font color="#E5E5E5"> customer sets massive</font>

201
00:08:50,510 --> 00:08:54,290
infrastructure involved and follow-on

202
00:08:52,760 --> 00:08:55,760
investigation essentially led to this

203
00:08:54,290 --> 00:08:59,140
extension with over a half<font color="#CCCCCC"> a million</font>

204
00:08:55,760 --> 00:09:01,939
victims and what was led<font color="#CCCCCC"> to be a</font>

205
00:08:59,140 --> 00:09:03,770
suspected fraud campaign<font color="#CCCCCC"> where they are</font>

206
00:09:01,940 --> 00:09:05,600
browsing pivot traffic through the

207
00:09:03,770 --> 00:09:08,079
<font color="#E5E5E5">Chrome extensions so we're gonna detail</font>

208
00:09:05,600 --> 00:09:10,490
this<font color="#E5E5E5"> a little bit more in depth now I</font>

209
00:09:08,080 --> 00:09:12,710
like<font color="#E5E5E5"> to take a pause and</font><font color="#CCCCCC"> say as a red</font>

210
00:09:10,490 --> 00:09:14,480
teamer for three years<font color="#E5E5E5"> I was horrible at</font>

211
00:09:12,710 --> 00:09:16,400
<font color="#E5E5E5">fishing and I stressed out every time I</font>

212
00:09:14,480 --> 00:09:17,600
had<font color="#E5E5E5"> to send a phishing message and I</font>

213
00:09:16,400 --> 00:09:19,310
always<font color="#E5E5E5"> thought social engineering was</font>

214
00:09:17,600 --> 00:09:20,750
very difficult<font color="#CCCCCC"> from a computer</font>

215
00:09:19,310 --> 00:09:23,089
respective breaking into physical<font color="#CCCCCC"> places</font>

216
00:09:20,750 --> 00:09:25,940
<font color="#CCCCCC">easy sitting</font><font color="#E5E5E5"> behind an email not so hard</font>

217
00:09:23,089 --> 00:09:27,650
not<font color="#E5E5E5"> so easy these guys they simply named</font>

218
00:09:25,940 --> 00:09:30,290
their extension<font color="#E5E5E5"> Google which was</font>

219
00:09:27,650 --> 00:09:33,230
essentially they would replace every

220
00:09:30,290 --> 00:09:35,000
Google<font color="#CCCCCC"> logo with a nan cat</font><font color="#E5E5E5"> that was the</font>

221
00:09:33,230 --> 00:09:38,210
whole<font color="#E5E5E5"> purpose of the extension and they</font>

222
00:09:35,000 --> 00:09:39,830
got a half million downloads<font color="#E5E5E5"> like I was</font>

223
00:09:38,210 --> 00:09:41,240
<font color="#E5E5E5">doing it all wrong as a red</font><font color="#CCCCCC"> teamer</font><font color="#E5E5E5"> all</font>

224
00:09:39,830 --> 00:09:43,380
those<font color="#E5E5E5"> years</font>

225
00:09:41,240 --> 00:09:44,490
and the funny<font color="#CCCCCC"> thing is when we started</font>

226
00:09:43,380 --> 00:09:46,410
doing<font color="#E5E5E5"> a</font><font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit of sense on this</font>

227
00:09:44,490 --> 00:09:48,540
stuff like tons of computer forums where

228
00:09:46,410 --> 00:09:49,890
people<font color="#CCCCCC"> are</font><font color="#E5E5E5"> talking about installing on</font>

229
00:09:48,540 --> 00:09:52,140
their<font color="#E5E5E5"> little</font><font color="#CCCCCC"> brother's computers or</font>

230
00:09:49,890 --> 00:09:53,610
<font color="#E5E5E5">trolling and putting it on work</font>

231
00:09:52,140 --> 00:09:55,770
computers as it was funny to see<font color="#E5E5E5"> their</font>

232
00:09:53,610 --> 00:09:57,240
<font color="#CCCCCC">co-worker</font><font color="#E5E5E5"> freak out like</font><font color="#CCCCCC"> it turns out</font>

233
00:09:55,770 --> 00:09:59,640
this is all malware<font color="#E5E5E5"> those people running</font>

234
00:09:57,240 --> 00:10:02,070
around<font color="#CCCCCC"> and installing so how did this</font>

235
00:09:59,640 --> 00:10:03,810
extension exactly work<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is kind</font><font color="#CCCCCC"> of</font>

236
00:10:02,070 --> 00:10:06,240
the beauty<font color="#CCCCCC"> of</font><font color="#E5E5E5"> what they were doing the</font>

237
00:10:03,810 --> 00:10:08,760
the<font color="#E5E5E5"> actual extension contained no</font>

238
00:10:06,240 --> 00:10:11,580
malicious code<font color="#E5E5E5"> so the extension</font><font color="#CCCCCC"> was</font>

239
00:10:08,760 --> 00:10:14,000
nothing more than a fully functioning

240
00:10:11,580 --> 00:10:16,650
<font color="#E5E5E5">purpose it full extension in this case</font>

241
00:10:14,000 --> 00:10:19,320
replacing the Google logo with<font color="#CCCCCC"> a nyan</font>

242
00:10:16,650 --> 00:10:21,270
cat<font color="#E5E5E5"> but then on a certain time interval</font>

243
00:10:19,320 --> 00:10:24,210
<font color="#E5E5E5">the extension would phone out for</font>

244
00:10:21,270 --> 00:10:27,750
updates<font color="#CCCCCC"> was that the guys that they had</font>

245
00:10:24,210 --> 00:10:30,210
set<font color="#CCCCCC"> up the updates</font><font color="#E5E5E5"> even more clever was</font>

246
00:10:27,750 --> 00:10:32,010
not just a straight like it was very

247
00:10:30,210 --> 00:10:33,060
<font color="#E5E5E5">hidden in this case if you</font><font color="#CCCCCC"> look at the</font>

248
00:10:32,010 --> 00:10:34,710
code on<font color="#E5E5E5"> the</font><font color="#CCCCCC"> bottom left</font>

249
00:10:33,060 --> 00:10:36,449
<font color="#CCCCCC">they were looking like</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> were</font>

250
00:10:34,710 --> 00:10:38,490
downloading<font color="#E5E5E5"> JSON updates like maybe a</font>

251
00:10:36,450 --> 00:10:41,580
configuration update the function used

252
00:10:38,490 --> 00:10:43,080
was the Ajax call<font color="#E5E5E5"> forget JSON little no</font>

253
00:10:41,580 --> 00:10:46,620
in fact<font color="#E5E5E5"> that we discovered while looking</font>

254
00:10:43,080 --> 00:10:49,470
at<font color="#CCCCCC"> this if you just</font><font color="#E5E5E5"> append JavaScript</font>

255
00:10:46,620 --> 00:10:52,050
string<font color="#E5E5E5"> to your JSON blob get JSON will</font>

256
00:10:49,470 --> 00:10:53,610
actually evaluate it assuming the unsafe

257
00:10:52,050 --> 00:10:57,060
<font color="#CCCCCC">eval permission is set in the extension</font>

258
00:10:53,610 --> 00:10:59,400
<font color="#CCCCCC">who knew</font><font color="#E5E5E5"> that no hands for the computer</font>

259
00:10:57,060 --> 00:11:01,140
and so yes<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can essentially just app</font>

260
00:10:59,400 --> 00:11:03,329
in JavaScript to a JSON blob and get

261
00:11:01,140 --> 00:11:05,970
JSON will execute<font color="#E5E5E5"> that for you</font><font color="#CCCCCC"> so a very</font>

262
00:11:03,330 --> 00:11:07,620
clever staging mechanism that would that

263
00:11:05,970 --> 00:11:09,210
<font color="#CCCCCC">would get used we actually</font><font color="#E5E5E5"> solved this</font>

264
00:11:07,620 --> 00:11:10,950
evolve over time<font color="#E5E5E5"> there's one other one I</font>

265
00:11:09,210 --> 00:11:12,870
want to call<font color="#E5E5E5"> out is that they also</font>

266
00:11:10,950 --> 00:11:15,840
<font color="#E5E5E5">modified the jQuery library</font><font color="#CCCCCC"> in some</font>

267
00:11:12,870 --> 00:11:17,430
cases<font color="#E5E5E5"> so they wouldn't even have like a</font>

268
00:11:15,840 --> 00:11:18,020
suspicious get JSON it would just be

269
00:11:17,430 --> 00:11:20,699
normal

270
00:11:18,020 --> 00:11:22,829
<font color="#CCCCCC">Ajax calls and then in the jQuery</font>

271
00:11:20,700 --> 00:11:25,710
library<font color="#CCCCCC"> they had minified like</font><font color="#E5E5E5"> their</font>

272
00:11:22,830 --> 00:11:28,590
secret little stager<font color="#E5E5E5"> to change behavior</font>

273
00:11:25,710 --> 00:11:29,070
when they saw certain content inside<font color="#CCCCCC"> of</font>

274
00:11:28,590 --> 00:11:31,140
it

275
00:11:29,070 --> 00:11:32,850
very clever and very<font color="#E5E5E5"> hidden hard to</font>

276
00:11:31,140 --> 00:11:34,170
detect given all the<font color="#CCCCCC"> jquery like</font>

277
00:11:32,850 --> 00:11:35,970
versions that<font color="#E5E5E5"> are out there anyways</font>

278
00:11:34,170 --> 00:11:36,310
<font color="#CCCCCC">unless you have a magic</font><font color="#E5E5E5"> whitelist of</font>

279
00:11:35,970 --> 00:11:40,360
every

280
00:11:36,310 --> 00:11:41,800
<font color="#CCCCCC">we're library</font><font color="#E5E5E5"> you're tracking so after</font>

281
00:11:40,360 --> 00:11:43,480
they would stage the extension they

282
00:11:41,800 --> 00:11:45,400
would essentially stage malicious code

283
00:11:43,480 --> 00:11:47,350
that<font color="#E5E5E5"> led to</font><font color="#CCCCCC"> a WebSocket getting stood</font><font color="#E5E5E5"> up</font>

284
00:11:45,400 --> 00:11:48,640
so they would stage<font color="#E5E5E5"> down some JavaScript</font>

285
00:11:47,350 --> 00:11:51,370
<font color="#E5E5E5">that JavaScript would stand up</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> a</font>

286
00:11:48,640 --> 00:11:52,750
WebSocket<font color="#CCCCCC"> and that WebSocket would</font>

287
00:11:51,370 --> 00:11:56,350
communicate<font color="#E5E5E5"> with this full JavaScript</font>

288
00:11:52,750 --> 00:11:58,330
<font color="#CCCCCC">wrap inside</font><font color="#E5E5E5"> the browser's memory that</font>

289
00:11:56,350 --> 00:12:00,730
JavaScript web tunnel<font color="#E5E5E5"> was then used</font>

290
00:11:58,330 --> 00:12:02,529
<font color="#E5E5E5">passed back and forth JSON taskings so</font>

291
00:12:00,730 --> 00:12:05,220
essentially malware<font color="#CCCCCC"> C - it would</font><font color="#E5E5E5"> task</font>

292
00:12:02,529 --> 00:12:07,600
the browser extension<font color="#CCCCCC"> agent to do things</font>

293
00:12:05,220 --> 00:12:10,839
<font color="#E5E5E5">specifically in this case it would task</font>

294
00:12:07,600 --> 00:12:12,430
it to do<font color="#CCCCCC"> click-fraud</font><font color="#E5E5E5"> and so they would</font>

295
00:12:10,839 --> 00:12:13,870
essentially<font color="#E5E5E5"> pass a website the browser</font>

296
00:12:12,430 --> 00:12:16,180
extension<font color="#CCCCCC"> would visit the</font><font color="#E5E5E5"> website from</font>

297
00:12:13,870 --> 00:12:18,250
<font color="#E5E5E5">the victim computer and so on</font><font color="#CCCCCC"> just</font>

298
00:12:16,180 --> 00:12:20,650
<font color="#E5E5E5">continuously some really</font><font color="#CCCCCC"> interesting</font>

299
00:12:18,250 --> 00:12:22,870
pieces<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this is that the you know we</font>

300
00:12:20,650 --> 00:12:25,060
sandbox<font color="#E5E5E5"> tons of these and</font><font color="#CCCCCC"> monitored them</font>

301
00:12:22,870 --> 00:12:26,440
they were not<font color="#E5E5E5"> injecting every user that</font>

302
00:12:25,060 --> 00:12:28,420
installed<font color="#E5E5E5"> this extension and actually</font>

303
00:12:26,440 --> 00:12:30,310
throttled<font color="#E5E5E5"> who they injected based on</font>

304
00:12:28,420 --> 00:12:32,650
what we believe<font color="#CCCCCC"> to be time</font><font color="#E5E5E5"> zones</font>

305
00:12:30,310 --> 00:12:33,939
geography and then<font color="#CCCCCC"> volume like they</font>

306
00:12:32,650 --> 00:12:36,040
would only<font color="#E5E5E5"> inject a certain number of</font>

307
00:12:33,940 --> 00:12:38,230
<font color="#E5E5E5">people at a time and</font><font color="#CCCCCC"> we believe that was</font>

308
00:12:36,040 --> 00:12:39,699
likely like low confidence assertion

309
00:12:38,230 --> 00:12:41,230
that<font color="#CCCCCC"> it was likely I'm trying to</font>

310
00:12:39,700 --> 00:12:42,790
<font color="#E5E5E5">minimize the chance of getting</font><font color="#CCCCCC"> call like</font>

311
00:12:41,230 --> 00:12:46,450
minimize the times are doing this don't

312
00:12:42,790 --> 00:12:47,740
<font color="#E5E5E5">make it as obvious so the traffic that</font>

313
00:12:46,450 --> 00:12:48,940
we saw essentially when<font color="#CCCCCC"> we were</font>

314
00:12:47,740 --> 00:12:50,820
monitoring<font color="#E5E5E5"> this in decrypting this</font>

315
00:12:48,940 --> 00:12:53,440
traffic<font color="#E5E5E5"> was almost exclusively</font>

316
00:12:50,820 --> 00:12:55,030
advertising traffic<font color="#CCCCCC"> and it would come</font>

317
00:12:53,440 --> 00:12:56,740
fast like when they would<font color="#E5E5E5"> trigger and</font>

318
00:12:55,030 --> 00:12:59,829
turn it on<font color="#E5E5E5"> depending</font><font color="#CCCCCC"> on where you're at</font>

319
00:12:56,740 --> 00:13:01,660
it would go for hours and talking a lot

320
00:12:59,830 --> 00:13:03,820
more<font color="#CCCCCC"> than a request a second for hours</font>

321
00:13:01,660 --> 00:13:05,199
if you<font color="#CCCCCC"> can do the quick math if you</font><font color="#E5E5E5"> go</font>

322
00:13:03,820 --> 00:13:07,510
out in price like how much<font color="#E5E5E5"> you get for</font>

323
00:13:05,200 --> 00:13:10,660
an ad click and an ad network anything

324
00:13:07,510 --> 00:13:12,520
from<font color="#E5E5E5"> it can go lower than</font><font color="#CCCCCC"> $0.10 it can</font>

325
00:13:10,660 --> 00:13:14,920
go as high<font color="#CCCCCC"> as</font><font color="#E5E5E5"> a dollar</font><font color="#CCCCCC"> so like you know</font>

326
00:13:12,520 --> 00:13:16,990
<font color="#E5E5E5">click a second for three hours times</font>

327
00:13:14,920 --> 00:13:18,310
let's go low in like a cent<font color="#E5E5E5"> you can make</font>

328
00:13:16,990 --> 00:13:21,990
a ton of money<font color="#CCCCCC"> doing this across half a</font>

329
00:13:18,310 --> 00:13:23,890
million victims<font color="#CCCCCC"> very profitable campaign</font>

330
00:13:21,990 --> 00:13:25,240
this started<font color="#E5E5E5"> out with just</font><font color="#CCCCCC"> four</font>

331
00:13:23,890 --> 00:13:26,709
extensions so we talked<font color="#CCCCCC"> about Google</font>

332
00:13:25,240 --> 00:13:29,709
<font color="#CCCCCC">there were three other extensions of</font>

333
00:13:26,709 --> 00:13:30,849
bookmarks of stickies and<font color="#E5E5E5"> a require a</font>

334
00:13:29,709 --> 00:13:32,529
Chrome extension<font color="#CCCCCC"> that</font><font color="#E5E5E5"> was actually</font>

335
00:13:30,850 --> 00:13:34,450
really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> anyone who works in</font>

336
00:13:32,529 --> 00:13:36,160
contesting in here use an<font color="#E5E5E5"> extension to</font>

337
00:13:34,450 --> 00:13:39,370
change your HTTP<font color="#E5E5E5"> request stuff to like</font>

338
00:13:36,160 --> 00:13:40,900
add headers or yeah yeah so the change

339
00:13:39,370 --> 00:13:42,400
HTTP request<font color="#E5E5E5"> header that would be a</font>

340
00:13:40,900 --> 00:13:45,400
really<font color="#E5E5E5"> sweet one to hook and</font>

341
00:13:42,400 --> 00:13:46,930
or<font color="#E5E5E5"> hookah pentester this had</font><font color="#CCCCCC"> 14,000</font>

342
00:13:45,400 --> 00:13:49,029
<font color="#CCCCCC">downloads and</font><font color="#E5E5E5"> I if I</font><font color="#CCCCCC"> had to guess a lot</font>

343
00:13:46,930 --> 00:13:51,250
<font color="#CCCCCC">of those were admins or some type of</font>

344
00:13:49,029 --> 00:13:52,689
<font color="#E5E5E5">code developer and that was</font><font color="#CCCCCC"> actually a</font>

345
00:13:51,250 --> 00:13:53,320
<font color="#E5E5E5">backdoor extension that was being</font><font color="#CCCCCC"> used</font>

346
00:13:52,690 --> 00:13:55,480
<font color="#E5E5E5">in this case</font>

347
00:13:53,320 --> 00:13:56,950
so<font color="#E5E5E5"> we actually stopped there we felt</font>

348
00:13:55,480 --> 00:13:59,020
<font color="#CCCCCC">pretty good we notified</font><font color="#E5E5E5"> Google at this</font>

349
00:13:56,950 --> 00:14:00,279
point and then<font color="#E5E5E5"> we</font><font color="#CCCCCC"> continued to monitor</font>

350
00:13:59,020 --> 00:14:01,660
so we're<font color="#E5E5E5"> network security company we</font>

351
00:14:00,279 --> 00:14:03,310
weren't like<font color="#E5E5E5"> really big in</font><font color="#CCCCCC"> the chrome</font>

352
00:14:01,660 --> 00:14:05,290
stuff but how to do diligence<font color="#CCCCCC"> we</font>

353
00:14:03,310 --> 00:14:08,439
continued to monitor<font color="#CCCCCC"> this and then last</font>

354
00:14:05,290 --> 00:14:10,300
year<font color="#CCCCCC"> throughout the year we noticed 35</font>

355
00:14:08,440 --> 00:14:12,220
more extensions<font color="#CCCCCC"> go into the chrome store</font>

356
00:14:10,300 --> 00:14:13,630
<font color="#E5E5E5">so there would be</font><font color="#CCCCCC"> devin</font><font color="#E5E5E5"> jizz we would</font>

357
00:14:12,220 --> 00:14:14,950
see batches of extensions get uploaded

358
00:14:13,630 --> 00:14:18,220
<font color="#E5E5E5">that would continue</font><font color="#CCCCCC"> this functionality</font>

359
00:14:14,950 --> 00:14:21,010
<font color="#CCCCCC">and another 153,000</font><font color="#E5E5E5"> victims over that</font>

360
00:14:18,220 --> 00:14:22,690
year we've continued to<font color="#CCCCCC"> monitor this and</font>

361
00:14:21,010 --> 00:14:23,680
<font color="#E5E5E5">it's still</font><font color="#CCCCCC"> very ongoing we don't have</font>

362
00:14:22,690 --> 00:14:26,710
any new stats to show you today

363
00:14:23,680 --> 00:14:30,520
<font color="#E5E5E5">essentially this continues to happen</font>

364
00:14:26,710 --> 00:14:33,370
<font color="#E5E5E5">these guys are</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> persistent so break</font>

365
00:14:30,520 --> 00:14:35,589
<font color="#E5E5E5">glass if you find evil this</font><font color="#CCCCCC"> is the for</font>

366
00:14:33,370 --> 00:14:37,510
us<font color="#CCCCCC"> we very</font><font color="#E5E5E5"> much like as we started to</font>

367
00:14:35,589 --> 00:14:37,900
scope the depth of this and how serious

368
00:14:37,510 --> 00:14:39,850
this was

369
00:14:37,900 --> 00:14:41,319
we immediately<font color="#E5E5E5"> reached out to Google</font>

370
00:14:39,850 --> 00:14:43,210
again<font color="#CCCCCC"> well we</font><font color="#E5E5E5"> give more</font><font color="#CCCCCC"> shouts</font><font color="#E5E5E5"> out like</font>

371
00:14:41,320 --> 00:14:44,890
the Google team we worked with Google's

372
00:14:43,210 --> 00:14:46,570
huge<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know everybody</font><font color="#E5E5E5"> there but</font>

373
00:14:44,890 --> 00:14:48,580
the Google team we worked with it was

374
00:14:46,570 --> 00:14:49,839
fantastic<font color="#E5E5E5"> they were very interested in</font>

375
00:14:48,580 --> 00:14:51,580
<font color="#CCCCCC">what we had to say they wanted</font><font color="#E5E5E5"> to work</font>

376
00:14:49,839 --> 00:14:53,110
<font color="#CCCCCC">with us</font><font color="#E5E5E5"> we have some tips like what we</font>

377
00:14:51,580 --> 00:14:54,640
learned<font color="#E5E5E5"> we're in this interaction so if</font>

378
00:14:53,110 --> 00:14:56,470
you go chrome hunting after<font color="#E5E5E5"> this talk</font>

379
00:14:54,640 --> 00:14:59,680
<font color="#E5E5E5">here's some tips to share stuff with</font>

380
00:14:56,470 --> 00:15:01,420
<font color="#E5E5E5">them share evidence it's really easy to</font>

381
00:14:59,680 --> 00:15:03,189
say I found<font color="#E5E5E5"> something bad and send it to</font>

382
00:15:01,420 --> 00:15:05,589
somebody<font color="#E5E5E5"> it's really hard</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> them to</font>

383
00:15:03,190 --> 00:15:07,390
understand<font color="#E5E5E5"> what you mean by bad and what</font>

384
00:15:05,589 --> 00:15:09,160
got you did this stuff in this case

385
00:15:07,390 --> 00:15:11,290
specifically<font color="#E5E5E5"> it was tough because they</font>

386
00:15:09,160 --> 00:15:12,730
were doing<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> selective staging so</font>

387
00:15:11,290 --> 00:15:13,959
the<font color="#CCCCCC"> Google team could go</font><font color="#E5E5E5"> install the</font>

388
00:15:12,730 --> 00:15:16,420
same extensions we said<font color="#E5E5E5"> we're evil and</font>

389
00:15:13,959 --> 00:15:17,920
they may not get<font color="#E5E5E5"> the JSON stager and so</font>

390
00:15:16,420 --> 00:15:19,120
they might<font color="#E5E5E5"> be like these</font><font color="#CCCCCC"> guys were you</font>

391
00:15:17,920 --> 00:15:20,740
full of it they don't<font color="#E5E5E5"> know what you're</font>

392
00:15:19,120 --> 00:15:22,630
talking about like how<font color="#CCCCCC"> do</font><font color="#E5E5E5"> we trust them</font>

393
00:15:20,740 --> 00:15:24,160
<font color="#E5E5E5">so we provided and we went</font><font color="#CCCCCC"> through this</font>

394
00:15:22,630 --> 00:15:25,959
we provide the full<font color="#E5E5E5"> pcap of all the</font>

395
00:15:24,160 --> 00:15:28,569
<font color="#E5E5E5">sandboxing everything we had source code</font>

396
00:15:25,959 --> 00:15:29,920
write-ups methodology more or less a

397
00:15:28,570 --> 00:15:31,390
full-fledged report and it was very

398
00:15:29,920 --> 00:15:33,900
appreciated they were able to action it

399
00:15:31,390 --> 00:15:36,640
much quicker indicators are nice like

400
00:15:33,900 --> 00:15:38,920
thread<font color="#E5E5E5"> until people</font><font color="#CCCCCC"> like IPS and domains</font>

401
00:15:36,640 --> 00:15:40,089
are fantastic<font color="#E5E5E5"> the evils fantastic but</font>

402
00:15:38,920 --> 00:15:42,160
methodology how did we go about

403
00:15:40,089 --> 00:15:43,540
<font color="#E5E5E5">discovering why did we stumble upon this</font>

404
00:15:42,160 --> 00:15:46,000
what kind<font color="#E5E5E5"> of generic</font><font color="#CCCCCC"> things are we</font>

405
00:15:43,540 --> 00:15:47,240
looking for<font color="#E5E5E5"> allowed them to go from</font>

406
00:15:46,000 --> 00:15:49,100
solving the<font color="#CCCCCC"> one problem</font>

407
00:15:47,240 --> 00:15:51,080
<font color="#E5E5E5">knew about</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> trying to evolve to solve</font>

408
00:15:49,100 --> 00:15:53,690
future problems and<font color="#E5E5E5"> continue to take</font>

409
00:15:51,080 --> 00:15:54,830
down the class of attacks continuing<font color="#E5E5E5"> on</font>

410
00:15:53,690 --> 00:15:56,060
the list I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> that the two biggest</font>

411
00:15:54,830 --> 00:15:57,980
outcomes are like the highlight in<font color="#E5E5E5"> our</font>

412
00:15:56,060 --> 00:15:59,510
case we actually there's<font color="#E5E5E5"> two ways that</font>

413
00:15:57,980 --> 00:16:01,790
<font color="#CCCCCC">Chrome extensions will get resolved</font>

414
00:15:59,510 --> 00:16:03,950
<font color="#E5E5E5">removal</font><font color="#CCCCCC"> from store meaning people can't</font>

415
00:16:01,790 --> 00:16:06,199
download it<font color="#E5E5E5"> anymore</font><font color="#CCCCCC"> that doesn't mean it</font>

416
00:16:03,950 --> 00:16:08,180
gets<font color="#CCCCCC"> removed from</font><font color="#E5E5E5"> computers there's also</font>

417
00:16:06,200 --> 00:16:09,800
a level<font color="#E5E5E5"> of analysis that'll lead</font><font color="#CCCCCC"> to them</font>

418
00:16:08,180 --> 00:16:12,020
actually<font color="#CCCCCC"> force</font><font color="#E5E5E5"> removing an issuing like</font>

419
00:16:09,800 --> 00:16:13,699
a kill request<font color="#E5E5E5"> out to anyone</font><font color="#CCCCCC"> who has it</font>

420
00:16:12,020 --> 00:16:15,050
installed in their browser<font color="#E5E5E5"> so we</font>

421
00:16:13,700 --> 00:16:16,550
actually<font color="#E5E5E5"> the any of the extensions we've</font>

422
00:16:15,050 --> 00:16:18,229
notified have gotten the kill<font color="#E5E5E5"> request</font>

423
00:16:16,550 --> 00:16:20,060
but that's not true<font color="#E5E5E5"> in all cases it</font>

424
00:16:18,230 --> 00:16:21,620
depends on the level<font color="#CCCCCC"> of</font><font color="#E5E5E5"> confidence and</font>

425
00:16:20,060 --> 00:16:28,640
<font color="#CCCCCC">kind</font><font color="#E5E5E5"> of severity what they're looking at</font>

426
00:16:21,620 --> 00:16:30,290
in the extension<font color="#E5E5E5"> see yeah so great like</font>

427
00:16:28,640 --> 00:16:33,439
we<font color="#E5E5E5"> found this whole malware campaign how</font>

428
00:16:30,290 --> 00:16:35,990
do we<font color="#E5E5E5"> protect against it</font><font color="#CCCCCC"> so there's</font><font color="#E5E5E5"> some</font>

429
00:16:33,440 --> 00:16:38,029
IDs signatures<font color="#E5E5E5"> that came out from the</font>

430
00:16:35,990 --> 00:16:39,080
emerging threats set I don't know if you

431
00:16:38,029 --> 00:16:44,209
guys<font color="#E5E5E5"> are familiar with that</font>

432
00:16:39,080 --> 00:16:46,399
it's like<font color="#CCCCCC"> snore circles so</font><font color="#E5E5E5"> they're a</font>

433
00:16:44,209 --> 00:16:49,119
little<font color="#E5E5E5"> bit fragile</font><font color="#CCCCCC"> one of them is really</font>

434
00:16:46,399 --> 00:16:51,589
good it's looking for<font color="#E5E5E5"> the actual</font>

435
00:16:49,120 --> 00:16:53,360
<font color="#E5E5E5">WebSocket connection that like the JSON</font>

436
00:16:51,589 --> 00:16:57,260
going back and forth once the tunnel<font color="#CCCCCC"> is</font>

437
00:16:53,360 --> 00:16:58,940
established fantastic<font color="#CCCCCC"> it gets it</font><font color="#E5E5E5"> on a</font>

438
00:16:57,260 --> 00:17:01,220
percent of the<font color="#E5E5E5"> time and then the other</font>

439
00:16:58,940 --> 00:17:04,220
<font color="#E5E5E5">one is actually looking for one very</font>

440
00:17:01,220 --> 00:17:07,819
specific Chrome extension ID<font color="#CCCCCC"> so unless</font>

441
00:17:04,220 --> 00:17:09,679
you<font color="#CCCCCC"> have that specific Chrome extension</font>

442
00:17:07,819 --> 00:17:14,449
and<font color="#E5E5E5"> you know you saw there was like 35</font>

443
00:17:09,679 --> 00:17:15,920
<font color="#E5E5E5">plus it's not gonna hit and then with</font>

444
00:17:14,449 --> 00:17:19,000
the<font color="#CCCCCC"> WebSocket tunnel</font><font color="#E5E5E5"> it's only gonna hit</font>

445
00:17:15,920 --> 00:17:22,160
if the<font color="#E5E5E5"> WebSocket tunnel</font><font color="#CCCCCC"> actually gets</font>

446
00:17:19,000 --> 00:17:26,079
set up right<font color="#E5E5E5"> there is a lot of cases</font>

447
00:17:22,160 --> 00:17:28,820
where this didn't actually get set up<font color="#CCCCCC"> so</font>

448
00:17:26,079 --> 00:17:31,940
<font color="#E5E5E5">here's the ugly slide full of</font><font color="#CCCCCC"> circus</font>

449
00:17:28,820 --> 00:17:33,980
<font color="#CCCCCC">Terracotta rules the</font><font color="#E5E5E5"> first one is</font>

450
00:17:31,940 --> 00:17:38,000
basically<font color="#E5E5E5"> looking</font><font color="#CCCCCC"> for the the beaconing</font>

451
00:17:33,980 --> 00:17:41,090
activity<font color="#CCCCCC"> back</font><font color="#E5E5E5"> and forth with the server</font>

452
00:17:38,000 --> 00:17:43,130
<font color="#CCCCCC">before injection</font><font color="#E5E5E5"> has happened</font><font color="#CCCCCC"> the second</font>

453
00:17:41,090 --> 00:17:45,740
one is actually<font color="#E5E5E5"> be looking for the</font>

454
00:17:43,130 --> 00:17:49,309
inject code<font color="#E5E5E5"> right so this is the payload</font>

455
00:17:45,740 --> 00:17:51,320
getting sent down on the update<font color="#E5E5E5"> request</font>

456
00:17:49,309 --> 00:17:53,510
when it when<font color="#CCCCCC"> it decides to do this and</font>

457
00:17:51,320 --> 00:17:57,290
then this last

458
00:17:53,510 --> 00:18:00,220
<font color="#E5E5E5">one is after it's been injected on they</font>

459
00:17:57,290 --> 00:18:02,659
<font color="#E5E5E5">actually add a header to every request</font>

460
00:18:00,220 --> 00:18:04,070
<font color="#CCCCCC">specifying the version</font><font color="#E5E5E5"> of the payload</font>

461
00:18:02,660 --> 00:18:05,840
that<font color="#E5E5E5"> was injected on so that they could</font>

462
00:18:04,070 --> 00:18:11,060
update<font color="#E5E5E5"> the</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> later on</font><font color="#CCCCCC"> in this be</font>

463
00:18:05,840 --> 00:18:13,699
<font color="#CCCCCC">getting some behavioral notes so all</font><font color="#E5E5E5"> of</font>

464
00:18:11,060 --> 00:18:17,929
this activity<font color="#E5E5E5"> was happening</font><font color="#CCCCCC"> in one ASN</font>

465
00:18:13,700 --> 00:18:20,420
<font color="#E5E5E5">it was always an info or a pro TLD</font><font color="#CCCCCC"> of</font>

466
00:18:17,930 --> 00:18:23,570
course there is chrome user agent field

467
00:18:20,420 --> 00:18:25,940
<font color="#E5E5E5">because it's a Chrome</font><font color="#CCCCCC"> extension</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> then</font>

468
00:18:23,570 --> 00:18:28,399
yeah a<font color="#E5E5E5"> couple of other things</font><font color="#CCCCCC"> just going</font>

469
00:18:25,940 --> 00:18:30,830
on<font color="#E5E5E5"> with the the flows looking for kind</font>

470
00:18:28,400 --> 00:18:35,660
<font color="#E5E5E5">of interesting interactions between a</font>

471
00:18:30,830 --> 00:18:36,800
<font color="#CCCCCC">chrome extension</font><font color="#E5E5E5"> and a weird server that</font>

472
00:18:35,660 --> 00:18:44,420
<font color="#E5E5E5">you probably haven't seen on your</font>

473
00:18:36,800 --> 00:18:47,210
network<font color="#CCCCCC"> before and here's some Yara yar</font>

474
00:18:44,420 --> 00:18:49,520
<font color="#CCCCCC">is not really set up to</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> with</font>

475
00:18:47,210 --> 00:18:52,310
<font color="#CCCCCC">JavaScript</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> will it's more it's</font><font color="#E5E5E5"> more</font>

476
00:18:49,520 --> 00:18:56,530
suited for binaries<font color="#CCCCCC"> but it's still a</font>

477
00:18:52,310 --> 00:18:58,669
really<font color="#E5E5E5"> nice kind of grep on steroids</font>

478
00:18:56,530 --> 00:19:00,410
<font color="#E5E5E5">where you can specify a bunch of</font>

479
00:18:58,670 --> 00:19:03,110
different patterns<font color="#CCCCCC"> and kind of what to</font>

480
00:19:00,410 --> 00:19:05,390
<font color="#CCCCCC">look for and conditions right so</font><font color="#E5E5E5"> like I</font>

481
00:19:03,110 --> 00:19:08,570
want this or<font color="#E5E5E5"> this</font><font color="#CCCCCC"> and I want</font><font color="#E5E5E5"> this and</font>

482
00:19:05,390 --> 00:19:13,220
<font color="#E5E5E5">this and so</font><font color="#CCCCCC"> the first</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> I have looking</font>

483
00:19:08,570 --> 00:19:15,200
for<font color="#E5E5E5"> because basically you can ID these</font>

484
00:19:13,220 --> 00:19:17,300
extensions by looking for a couple<font color="#CCCCCC"> of</font>

485
00:19:15,200 --> 00:19:19,790
key<font color="#CCCCCC"> things the first one is looking for</font>

486
00:19:17,300 --> 00:19:21,530
a manifest file that has the<font color="#CCCCCC"> relevant</font>

487
00:19:19,790 --> 00:19:24,649
permissions that<font color="#CCCCCC"> are always</font><font color="#E5E5E5"> set for this</font>

488
00:19:21,530 --> 00:19:27,080
they<font color="#CCCCCC"> have to have</font><font color="#E5E5E5"> web</font><font color="#CCCCCC"> request and web</font>

489
00:19:24,650 --> 00:19:29,510
<font color="#E5E5E5">request blocking and then access to all</font>

490
00:19:27,080 --> 00:19:32,449
<font color="#E5E5E5">URLs as permissions declared in the</font>

491
00:19:29,510 --> 00:19:34,430
manifest file<font color="#CCCCCC"> so look for that the</font>

492
00:19:32,450 --> 00:19:36,560
second<font color="#E5E5E5"> thing is looking for a jQuery</font>

493
00:19:34,430 --> 00:19:39,380
library<font color="#E5E5E5"> that's been modified this</font><font color="#CCCCCC"> is</font>

494
00:19:36,560 --> 00:19:42,570
really<font color="#E5E5E5"> hard</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> I do not recommend</font>

495
00:19:39,380 --> 00:19:46,320
<font color="#E5E5E5">doing this but yeah</font>

496
00:19:42,570 --> 00:19:50,490
<font color="#E5E5E5">of hair tearing out making that one</font><font color="#CCCCCC"> but</font>

497
00:19:46,320 --> 00:19:52,379
really<font color="#CCCCCC"> cool and then the third one is</font>

498
00:19:50,490 --> 00:19:56,429
actually<font color="#E5E5E5"> looking for the the loop the</font>

499
00:19:52,380 --> 00:19:58,110
the update<font color="#E5E5E5"> beacon encode that is present</font>

500
00:19:56,429 --> 00:20:00,330
in all<font color="#CCCCCC"> of these so if you get</font><font color="#E5E5E5"> like a</font>

501
00:19:58,110 --> 00:20:04,908
match on a<font color="#CCCCCC"> Chrome extension with all</font>

502
00:20:00,330 --> 00:20:04,908
three<font color="#CCCCCC"> of these together then we got it</font>

503
00:20:04,940 --> 00:20:12,059
yeah okay<font color="#E5E5E5"> so with</font><font color="#CCCCCC"> Chrome extensions I</font>

504
00:20:09,950 --> 00:20:14,009
was I<font color="#E5E5E5"> was looking at this stuff</font><font color="#CCCCCC"> and I</font>

505
00:20:12,059 --> 00:20:17,070
was<font color="#CCCCCC"> like hey you know there's there's a</font>

506
00:20:14,009 --> 00:20:20,070
<font color="#CCCCCC">lot of time stamps here wouldn't</font><font color="#E5E5E5"> be cool</font>

507
00:20:17,070 --> 00:20:24,658
<font color="#E5E5E5">to like map these out</font><font color="#CCCCCC"> and see what kind</font>

508
00:20:20,070 --> 00:20:25,830
<font color="#CCCCCC">of information</font><font color="#E5E5E5"> we get out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> that so</font><font color="#CCCCCC"> CRX</font>

509
00:20:24,659 --> 00:20:28,110
<font color="#E5E5E5">files which I'd like the Chrome</font>

510
00:20:25,830 --> 00:20:30,240
extension files<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> basically</font><font color="#CCCCCC"> just a</font>

511
00:20:28,110 --> 00:20:32,939
wrapper on a zip file<font color="#E5E5E5"> and zip files</font>

512
00:20:30,240 --> 00:20:35,730
<font color="#CCCCCC">actually have these file modification</font>

513
00:20:32,940 --> 00:20:41,299
timestamps that get preserved when you

514
00:20:35,730 --> 00:20:44,190
zip<font color="#E5E5E5"> up like a bunch of files they are</font>

515
00:20:41,299 --> 00:20:47,850
<font color="#CCCCCC">ms-dos timestamps and they don't have</font>

516
00:20:44,190 --> 00:20:49,769
any kind<font color="#E5E5E5"> of timezone information with it</font>

517
00:20:47,850 --> 00:20:52,620
so<font color="#E5E5E5"> that's kind of annoying</font><font color="#CCCCCC"> and then</font>

518
00:20:49,769 --> 00:20:56,009
there's the domain registrations<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we</font>

519
00:20:52,620 --> 00:20:58,168
have you know who is<font color="#E5E5E5"> records record when</font>

520
00:20:56,009 --> 00:20:59,519
a<font color="#E5E5E5"> domain was registered we have all</font>

521
00:20:58,169 --> 00:21:01,470
these<font color="#CCCCCC"> domains associated with these</font>

522
00:20:59,519 --> 00:21:04,309
<font color="#CCCCCC">chrome extensions great let's grab</font><font color="#E5E5E5"> all</font>

523
00:21:01,470 --> 00:21:08,490
those and<font color="#E5E5E5"> then also this was really fun</font>

524
00:21:04,309 --> 00:21:10,889
<font color="#E5E5E5">so</font><font color="#CCCCCC"> all the icons and images</font><font color="#E5E5E5"> that used in</font>

525
00:21:08,490 --> 00:21:12,750
these<font color="#CCCCCC"> chrome extensions which did</font><font color="#E5E5E5"> do</font>

526
00:21:10,889 --> 00:21:17,158
what they were<font color="#CCCCCC"> ported to do in addition</font>

527
00:21:12,750 --> 00:21:19,110
<font color="#E5E5E5">to</font><font color="#CCCCCC"> the malicious stuff Adobe Photoshop</font>

528
00:21:17,159 --> 00:21:22,830
<font color="#E5E5E5">was used to make most of these images</font>

529
00:21:19,110 --> 00:21:25,678
<font color="#CCCCCC">and they'll actually inject these XML</font>

530
00:21:22,830 --> 00:21:27,809
payloads that<font color="#E5E5E5"> have tons of timestamps</font><font color="#CCCCCC"> in</font>

531
00:21:25,679 --> 00:21:29,399
there of like<font color="#E5E5E5"> oh they added a layer at</font>

532
00:21:27,809 --> 00:21:32,039
this time and they added a layer at this

533
00:21:29,399 --> 00:21:34,070
time and really rich<font color="#E5E5E5"> and it's actually</font>

534
00:21:32,039 --> 00:21:39,629
<font color="#CCCCCC">got</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> timezone</font><font color="#E5E5E5"> information in it too</font>

535
00:21:34,070 --> 00:21:40,999
<font color="#CCCCCC">so that's really cool yeah</font><font color="#E5E5E5"> so actually</font>

536
00:21:39,629 --> 00:21:43,728
graphing it out

537
00:21:40,999 --> 00:21:46,700
you<font color="#E5E5E5"> actually kind of notice something</font>

538
00:21:43,729 --> 00:21:48,049
<font color="#CCCCCC">interesting here going</font><font color="#E5E5E5"> on right</font><font color="#CCCCCC"> Monday</font>

539
00:21:46,700 --> 00:21:50,419
<font color="#E5E5E5">Tuesday Wednesday Thursday Friday</font>

540
00:21:48,049 --> 00:21:53,389
Saturday Sunday<font color="#E5E5E5"> from top to bottom</font>

541
00:21:50,419 --> 00:21:56,830
<font color="#CCCCCC">you'll notice that so the orange</font>

542
00:21:53,389 --> 00:22:01,279
corresponds to the PNG timestamps<font color="#E5E5E5"> the</font>

543
00:21:56,830 --> 00:22:04,099
blue corresponds<font color="#CCCCCC"> to the domain creation</font>

544
00:22:01,279 --> 00:22:06,649
and the green is<font color="#E5E5E5"> the file modification</font>

545
00:22:04,099 --> 00:22:10,729
<font color="#E5E5E5">from the zip files</font><font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> notice there's</font>

546
00:22:06,649 --> 00:22:12,049
kind of<font color="#E5E5E5"> a center going on on Monday</font><font color="#CCCCCC"> to</font>

547
00:22:10,729 --> 00:22:13,849
Friday

548
00:22:12,049 --> 00:22:18,590
I should also know these are<font color="#E5E5E5"> all</font>

549
00:22:13,849 --> 00:22:23,029
normalized to UTC<font color="#E5E5E5"> and based on the data</font>

550
00:22:18,590 --> 00:22:26,539
set because<font color="#CCCCCC"> we had like about 2000 of</font>

551
00:22:23,029 --> 00:22:29,599
the PNG<font color="#E5E5E5"> timestamps unique ones</font><font color="#CCCCCC"> only</font>

552
00:22:26,539 --> 00:22:33,619
<font color="#CCCCCC">about</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> hundred of</font><font color="#E5E5E5"> the domains and like</font>

553
00:22:29,599 --> 00:22:34,849
<font color="#E5E5E5">700 ish of the file timestamps but yeah</font>

554
00:22:33,619 --> 00:22:37,928
so kind<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> monday</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> friday</font>

555
00:22:34,849 --> 00:22:41,059
correlation<font color="#E5E5E5"> here's by hours of the day</font>

556
00:22:37,929 --> 00:22:47,289
<font color="#E5E5E5">same normalization process you'll notice</font>

557
00:22:41,059 --> 00:22:51,099
kind<font color="#E5E5E5"> of activity centers around 9 to</font><font color="#CCCCCC"> 20</font>

558
00:22:47,289 --> 00:22:55,039
UTC so this is really<font color="#E5E5E5"> interesting</font>

559
00:22:51,099 --> 00:22:57,080
<font color="#CCCCCC">nothing no hard</font><font color="#E5E5E5"> you know conclusions we</font>

560
00:22:55,039 --> 00:23:00,349
can draw<font color="#E5E5E5"> from this necessarily but still</font>

561
00:22:57,080 --> 00:23:03,769
really<font color="#E5E5E5"> interesting right yes this is</font>

562
00:23:00,349 --> 00:23:06,109
pretty<font color="#E5E5E5"> cool we actually I was like</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> so</font>

563
00:23:03,769 --> 00:23:07,599
I have<font color="#E5E5E5"> all these things what does this</font>

564
00:23:06,109 --> 00:23:11,570
all<font color="#E5E5E5"> mean</font>

565
00:23:07,599 --> 00:23:13,399
so we took a baseline of like<font color="#E5E5E5"> activity</font>

566
00:23:11,570 --> 00:23:16,789
for like yeah because<font color="#E5E5E5"> I'm kind of</font>

567
00:23:13,399 --> 00:23:18,649
thinking<font color="#CCCCCC"> all right like this kind of</font>

568
00:23:16,789 --> 00:23:21,649
looks like a 9 to 5<font color="#CCCCCC"> schedule</font><font color="#E5E5E5"> maybe right</font>

569
00:23:18,649 --> 00:23:24,649
so what does<font color="#E5E5E5"> this look like compared to</font>

570
00:23:21,649 --> 00:23:27,439
actual<font color="#CCCCCC"> 95 schedule so we're</font><font color="#E5E5E5"> networking</font>

571
00:23:24,649 --> 00:23:30,529
networking company<font color="#E5E5E5"> we have a lot</font><font color="#CCCCCC"> of</font>

572
00:23:27,440 --> 00:23:33,739
customer data<font color="#E5E5E5"> so we take like a baseline</font>

573
00:23:30,529 --> 00:23:36,139
activity curve for people working<font color="#E5E5E5"> 9:00</font>

574
00:23:33,739 --> 00:23:38,419
to<font color="#E5E5E5"> 5:00 in</font><font color="#CCCCCC"> the timezone we normalize</font>

575
00:23:36,139 --> 00:23:40,908
<font color="#E5E5E5">that to UTC and then we compare that</font>

576
00:23:38,419 --> 00:23:43,970
with the different data sets that<font color="#E5E5E5"> we</font>

577
00:23:40,909 --> 00:23:46,220
<font color="#CCCCCC">have so from left to right</font><font color="#E5E5E5"> you have the</font>

578
00:23:43,970 --> 00:23:51,350
domain creation file modification

579
00:23:46,220 --> 00:23:53,509
the PNG<font color="#CCCCCC"> timestamps and</font><font color="#E5E5E5"> basically we're</font>

580
00:23:51,350 --> 00:23:57,529
looking<font color="#CCCCCC"> for where it's closest to zero</font>

581
00:23:53,509 --> 00:24:02,559
<font color="#CCCCCC">is the closest match between like a the</font>

582
00:23:57,529 --> 00:24:02,559
baseline curve<font color="#E5E5E5"> and the attacker curve</font>

583
00:24:03,490 --> 00:24:11,529
<font color="#CCCCCC">but yeah so this actually kind of</font><font color="#E5E5E5"> raised</font>

584
00:24:08,750 --> 00:24:14,360
<font color="#E5E5E5">just more questions than actual answers</font>

585
00:24:11,529 --> 00:24:16,730
<font color="#E5E5E5">because if you if you look back at this</font>

586
00:24:14,360 --> 00:24:18,709
this<font color="#E5E5E5"> last graph the</font><font color="#CCCCCC"> far-right</font><font color="#E5E5E5"> one</font>

587
00:24:16,730 --> 00:24:22,730
actually kind of corresponds to like<font color="#CCCCCC"> a</font>

588
00:24:18,710 --> 00:24:24,950
<font color="#CCCCCC">et Cie shift of minus one but those</font><font color="#E5E5E5"> ones</font>

589
00:24:22,730 --> 00:24:26,570
actually<font color="#E5E5E5"> had timestamp</font><font color="#CCCCCC"> the timezone</font>

590
00:24:24,950 --> 00:24:29,450
<font color="#CCCCCC">information included which said plus</font>

591
00:24:26,570 --> 00:24:31,460
<font color="#E5E5E5">four</font><font color="#CCCCCC"> so since there was that</font><font color="#E5E5E5"> discrepancy</font>

592
00:24:29,450 --> 00:24:33,799
it's like okay what<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that what's</font><font color="#E5E5E5"> that</font>

593
00:24:31,460 --> 00:24:36,830
telling<font color="#E5E5E5"> us like you</font><font color="#CCCCCC"> know it kind of</font>

594
00:24:33,799 --> 00:24:41,570
makes a lot of<font color="#E5E5E5"> different narratives</font>

595
00:24:36,830 --> 00:24:43,939
possible<font color="#E5E5E5"> right so</font><font color="#CCCCCC"> being</font><font color="#E5E5E5"> a red team guy</font>

596
00:24:41,570 --> 00:24:45,710
I'm naturally staring<font color="#CCCCCC"> at this adversary</font>

597
00:24:43,940 --> 00:24:48,139
<font color="#E5E5E5">making millions of dollars and wondering</font>

598
00:24:45,710 --> 00:24:50,149
why I<font color="#E5E5E5"> never did this exact technique for</font>

599
00:24:48,139 --> 00:24:52,039
<font color="#E5E5E5">years and so I kind of took a page out</font>

600
00:24:50,149 --> 00:24:54,080
of their<font color="#E5E5E5"> book and</font><font color="#CCCCCC"> decided to</font><font color="#E5E5E5"> go be evil</font>

601
00:24:52,039 --> 00:24:57,679
for a while and satisfy that craving

602
00:24:54,080 --> 00:24:59,539
before coming back<font color="#CCCCCC"> to blue</font><font color="#E5E5E5"> so what makes</font>

603
00:24:57,679 --> 00:25:01,879
<font color="#CCCCCC">current like stepping</font><font color="#E5E5E5"> his back</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this</font>

604
00:24:59,539 --> 00:25:05,480
like why was this<font color="#E5E5E5"> adversary so brilliant</font>

605
00:25:01,879 --> 00:25:08,178
to do it like this<font color="#CCCCCC"> frankly like</font>

606
00:25:05,480 --> 00:25:10,340
leveraging Google<font color="#CCCCCC"> Chrome</font><font color="#E5E5E5"> is a fantastic</font>

607
00:25:08,179 --> 00:25:12,620
technique<font color="#E5E5E5"> general people trust the</font>

608
00:25:10,340 --> 00:25:14,178
chrome store<font color="#CCCCCC"> like more than</font><font color="#E5E5E5"> they</font><font color="#CCCCCC"> trust</font>

609
00:25:12,620 --> 00:25:17,418
<font color="#CCCCCC">random XD downloaded from the internet</font>

610
00:25:14,179 --> 00:25:19,039
or<font color="#E5E5E5"> from a spear phishing email Google</font>

611
00:25:17,419 --> 00:25:20,870
wants open<font color="#CCCCCC"> development so people are</font>

612
00:25:19,039 --> 00:25:23,809
inherently trusting like an open data

613
00:25:20,870 --> 00:25:25,489
and<font color="#E5E5E5"> open development model and</font><font color="#CCCCCC"> I can bet</font>

614
00:25:23,809 --> 00:25:26,389
you<font color="#CCCCCC"> most people</font><font color="#E5E5E5"> in here well raise their</font>

615
00:25:25,490 --> 00:25:27,950
<font color="#CCCCCC">hand saying</font><font color="#E5E5E5"> they're using Chrome</font>

616
00:25:26,389 --> 00:25:30,408
extensions aren't code reviewing every

617
00:25:27,950 --> 00:25:32,240
extension<font color="#E5E5E5"> you download like maybe some</font>

618
00:25:30,409 --> 00:25:33,440
like maybe<font color="#CCCCCC"> you'd eke out over</font><font color="#E5E5E5"> that but</font>

619
00:25:32,240 --> 00:25:34,700
most times<font color="#E5E5E5"> you're downloading a Chrome</font>

620
00:25:33,440 --> 00:25:37,129
extension because<font color="#CCCCCC"> you want quick</font>

621
00:25:34,700 --> 00:25:39,620
utilities and so that<font color="#E5E5E5"> would defeat the</font>

622
00:25:37,129 --> 00:25:41,689
whole<font color="#E5E5E5"> quick piece</font><font color="#CCCCCC"> of that</font><font color="#E5E5E5"> and so</font>

623
00:25:39,620 --> 00:25:42,350
essentially people<font color="#E5E5E5"> trust Google Google</font>

624
00:25:41,690 --> 00:25:45,860
trust everyone

625
00:25:42,350 --> 00:25:48,289
so people<font color="#E5E5E5"> trust everyone not exactly a</font>

626
00:25:45,860 --> 00:25:49,639
great model<font color="#E5E5E5"> it gives you code execution</font>

627
00:25:48,289 --> 00:25:51,200
in the<font color="#E5E5E5"> browser it gives you the</font><font color="#CCCCCC"> access</font>

628
00:25:49,639 --> 00:25:51,469
to Google's API is everyone does all

629
00:25:51,200 --> 00:25:53,210
<font color="#E5E5E5">their</font>

630
00:25:51,470 --> 00:25:56,059
Google so you have<font color="#E5E5E5"> access to everyone's</font>

631
00:25:53,210 --> 00:25:57,440
work<font color="#E5E5E5"> so stepping</font><font color="#CCCCCC"> back and kind</font><font color="#E5E5E5"> of</font>

632
00:25:56,059 --> 00:25:58,850
walking<font color="#E5E5E5"> through the adversary lifecycle</font>

633
00:25:57,440 --> 00:26:00,530
I decided to<font color="#E5E5E5"> research each page of this</font>

634
00:25:58,850 --> 00:26:02,149
<font color="#E5E5E5">so if I was a bad guy how would</font><font color="#CCCCCC"> I start</font>

635
00:26:00,530 --> 00:26:04,070
<font color="#CCCCCC">from Ground Zero</font><font color="#E5E5E5"> and build a malicious</font>

636
00:26:02,150 --> 00:26:05,600
chrome<font color="#E5E5E5"> of capability so looking at</font>

637
00:26:04,070 --> 00:26:06,740
delivery and installation<font color="#E5E5E5"> there's a</font>

638
00:26:05,600 --> 00:26:08,389
<font color="#CCCCCC">number of</font><font color="#E5E5E5"> different ways that Chrome</font>

639
00:26:06,740 --> 00:26:11,090
extensions can get installed inside of a

640
00:26:08,390 --> 00:26:12,770
user's browser<font color="#E5E5E5"> the simplest would be</font>

641
00:26:11,090 --> 00:26:14,480
something like fishing<font color="#CCCCCC"> with a link to</font>

642
00:26:12,770 --> 00:26:16,129
<font color="#E5E5E5">the chrome store</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> I just</font><font color="#CCCCCC"> convince</font>

643
00:26:14,480 --> 00:26:17,299
<font color="#E5E5E5">someone</font><font color="#CCCCCC"> that there's some policy at</font>

644
00:26:16,130 --> 00:26:18,710
their company and they need to come

645
00:26:17,299 --> 00:26:20,418
download the company's chrome app maybe

646
00:26:18,710 --> 00:26:22,520
<font color="#E5E5E5">I've lized it really well and made it</font>

647
00:26:20,419 --> 00:26:24,140
beautiful lure and convince<font color="#E5E5E5"> them to come</font>

648
00:26:22,520 --> 00:26:25,400
download it they click on<font color="#E5E5E5"> a link</font><font color="#CCCCCC"> there's</font>

649
00:26:24,140 --> 00:26:26,570
nothing hard to do this you can get

650
00:26:25,400 --> 00:26:28,100
links<font color="#CCCCCC"> to the chrome store</font><font color="#E5E5E5"> and it</font>

651
00:26:26,570 --> 00:26:30,200
launches a chrome store and ask them<font color="#CCCCCC"> to</font>

652
00:26:28,100 --> 00:26:32,360
install<font color="#E5E5E5"> everything clever enough</font><font color="#CCCCCC"> lure it</font>

653
00:26:30,200 --> 00:26:34,490
works<font color="#E5E5E5"> maybe you want to do this as a</font>

654
00:26:32,360 --> 00:26:36,020
post exploitation thing you get<font color="#CCCCCC"> access</font>

655
00:26:34,490 --> 00:26:37,700
to a user workstation you want to

656
00:26:36,020 --> 00:26:38,870
<font color="#E5E5E5">install</font><font color="#CCCCCC"> your extension for persistence</font>

657
00:26:37,700 --> 00:26:41,120
there's a couple<font color="#CCCCCC"> different ways you</font><font color="#E5E5E5"> can</font>

658
00:26:38,870 --> 00:26:43,580
do this<font color="#E5E5E5"> the my favorite one</font><font color="#CCCCCC"> was doing</font>

659
00:26:41,120 --> 00:26:45,289
this via<font color="#E5E5E5"> their registry so simply adding</font>

660
00:26:43,580 --> 00:26:46,520
a registry key<font color="#E5E5E5"> all of a sudden the</font>

661
00:26:45,289 --> 00:26:49,158
extension downloads<font color="#E5E5E5"> into the browser</font>

662
00:26:46,520 --> 00:26:52,400
<font color="#E5E5E5">like no user prom no user notification</font>

663
00:26:49,159 --> 00:26:54,590
like this add this key<font color="#E5E5E5"> extension</font>

664
00:26:52,400 --> 00:26:56,830
installs<font color="#E5E5E5"> from the store so pretty</font>

665
00:26:54,590 --> 00:26:59,600
<font color="#CCCCCC">fantastic post exploitation method</font>

666
00:26:56,830 --> 00:27:02,658
<font color="#E5E5E5">pretty easy to do notice</font><font color="#CCCCCC"> the six tub</font>

667
00:26:59,600 --> 00:27:04,580
extender like<font color="#CCCCCC"> I got a extension in there</font>

668
00:27:02,659 --> 00:27:06,710
for<font color="#E5E5E5"> just to prove I</font><font color="#CCCCCC"> could do it for 20</font>

669
00:27:04,580 --> 00:27:08,539
minutes<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> I deleted</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> but this</font>

670
00:27:06,710 --> 00:27:09,740
is a<font color="#E5E5E5"> fully fledged extension that was in</font>

671
00:27:08,539 --> 00:27:12,169
the<font color="#CCCCCC"> store that used the exact same</font>

672
00:27:09,740 --> 00:27:14,090
staging technique<font color="#E5E5E5"> the bad guy was doing</font>

673
00:27:12,169 --> 00:27:15,470
so totally possible<font color="#E5E5E5"> to get an extension</font>

674
00:27:14,090 --> 00:27:19,280
<font color="#E5E5E5">in the store and and use it for this</font>

675
00:27:15,470 --> 00:27:21,169
purpose so post exploitation this is

676
00:27:19,280 --> 00:27:23,270
really what like<font color="#E5E5E5"> a geek out on as a Red</font>

677
00:27:21,169 --> 00:27:24,890
<font color="#E5E5E5">Team guy we spent 90% of our team time</font>

678
00:27:23,270 --> 00:27:26,450
<font color="#E5E5E5">doing post exploitation stuff and</font>

679
00:27:24,890 --> 00:27:28,460
<font color="#CCCCCC">average</font><font color="#E5E5E5"> Sarah I can climb environments</font>

680
00:27:26,450 --> 00:27:30,679
<font color="#E5E5E5">and so what exactly</font><font color="#CCCCCC"> do I get by getting</font>

681
00:27:28,460 --> 00:27:32,929
<font color="#E5E5E5">Chrome well the simple answer</font><font color="#CCCCCC"> is you</font>

682
00:27:30,679 --> 00:27:34,940
<font color="#CCCCCC">basically get full</font><font color="#E5E5E5"> control of the chrome</font>

683
00:27:32,929 --> 00:27:37,130
system<font color="#E5E5E5"> so that includes screen capture</font>

684
00:27:34,940 --> 00:27:39,740
of<font color="#E5E5E5"> chrome tabs key logging of the Chrome</font>

685
00:27:37,130 --> 00:27:42,140
browser<font color="#CCCCCC"> hooking forms so anytime anyone</font>

686
00:27:39,740 --> 00:27:45,309
submits a form<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> gain an execution</font>

687
00:27:42,140 --> 00:27:45,309
hook in there to access<font color="#CCCCCC"> that data</font>

688
00:27:45,400 --> 00:27:49,039
redirection so if I want<font color="#E5E5E5"> to like</font>

689
00:27:47,270 --> 00:27:51,168
intercept a request and<font color="#E5E5E5"> change the route</font>

690
00:27:49,039 --> 00:27:53,690
it goes<font color="#E5E5E5"> social engineering so the</font>

691
00:27:51,169 --> 00:27:55,950
<font color="#E5E5E5">ability to pop messages communicate with</font>

692
00:27:53,690 --> 00:27:58,350
the user<font color="#E5E5E5"> give</font><font color="#CCCCCC"> the pretty images</font>

693
00:27:55,950 --> 00:27:59,580
and techniques<font color="#E5E5E5"> and then browser pivoting</font>

694
00:27:58,350 --> 00:28:01,500
so if you're familiar with<font color="#E5E5E5"> that</font><font color="#CCCCCC"> concept</font>

695
00:27:59,580 --> 00:28:03,300
basically forcing a<font color="#CCCCCC"> users</font><font color="#E5E5E5"> browser to</font>

696
00:28:01,500 --> 00:28:04,980
browser<font color="#E5E5E5"> where you</font><font color="#CCCCCC"> would like under that</font>

697
00:28:03,300 --> 00:28:07,379
under<font color="#CCCCCC"> the context that they already have</font>

698
00:28:04,980 --> 00:28:09,060
established<font color="#CCCCCC"> so walking through</font>

699
00:28:07,380 --> 00:28:10,830
<font color="#E5E5E5">specifically the injection technique so</font>

700
00:28:09,060 --> 00:28:12,360
I told<font color="#E5E5E5"> you I replicated the adversaries</font>

701
00:28:10,830 --> 00:28:14,010
injection technique<font color="#E5E5E5"> I'm gonna give</font>

702
00:28:12,360 --> 00:28:15,330
tidbits of how this<font color="#CCCCCC"> tool works</font><font color="#E5E5E5"> I have</font>

703
00:28:14,010 --> 00:28:18,120
<font color="#E5E5E5">not released and will not be releasing</font>

704
00:28:15,330 --> 00:28:19,679
this tool for open consumption<font color="#CCCCCC"> but there</font>

705
00:28:18,120 --> 00:28:23,610
are enough<font color="#E5E5E5"> pieces if</font><font color="#CCCCCC"> you take a lot of</font>

706
00:28:19,680 --> 00:28:25,770
<font color="#E5E5E5">pictures to get</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> so the</font>

707
00:28:23,610 --> 00:28:28,709
picture here<font color="#E5E5E5"> this is essentially</font><font color="#CCCCCC"> showing</font>

708
00:28:25,770 --> 00:28:30,690
<font color="#E5E5E5">how I staged down a message into</font><font color="#CCCCCC"> the</font>

709
00:28:28,710 --> 00:28:32,940
application<font color="#E5E5E5"> so in this case there's a</font>

710
00:28:30,690 --> 00:28:35,970
<font color="#CCCCCC">JavaScript</font><font color="#E5E5E5"> blob it doesn't get JSON</font>

711
00:28:32,940 --> 00:28:37,920
requests somewhere<font color="#CCCCCC"> I simply respond with</font>

712
00:28:35,970 --> 00:28:40,290
a JSON blob which is a picture<font color="#E5E5E5"> in the</font>

713
00:28:37,920 --> 00:28:43,200
bottom message success<font color="#E5E5E5"> and then I do it</font>

714
00:28:40,290 --> 00:28:45,629
<font color="#E5E5E5">I end it</font><font color="#CCCCCC"> with a dot replace and like do</font>

715
00:28:43,200 --> 00:28:47,580
this fancy evasion technique<font color="#E5E5E5"> basically</font>

716
00:28:45,630 --> 00:28:50,240
<font color="#CCCCCC">I'm appending JavaScript</font><font color="#E5E5E5"> that thoughtful</font>

717
00:28:47,580 --> 00:28:53,189
skated on to the JSON<font color="#CCCCCC"> request or reply</font>

718
00:28:50,240 --> 00:28:54,060
<font color="#E5E5E5">that gives me execution of my rat so</font>

719
00:28:53,190 --> 00:28:55,770
we're gonna<font color="#E5E5E5"> walk</font><font color="#CCCCCC"> through a bunch</font><font color="#E5E5E5"> of</font>

720
00:28:54,060 --> 00:28:57,600
<font color="#CCCCCC">examples in this</font><font color="#E5E5E5"> one I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> hook form</font>

721
00:28:55,770 --> 00:29:00,030
submission<font color="#E5E5E5"> so I have a Chrome extension</font>

722
00:28:57,600 --> 00:29:02,310
calling back<font color="#E5E5E5"> to my controller I'm gonna</font>

723
00:29:00,030 --> 00:29:06,360
task my controller up through the API<font color="#E5E5E5"> to</font>

724
00:29:02,310 --> 00:29:08,820
<font color="#CCCCCC">start a form capture</font><font color="#E5E5E5"> specifically for</font>

725
00:29:06,360 --> 00:29:10,560
<font color="#CCCCCC">that client</font><font color="#E5E5E5"> ID you're gonna see my</font>

726
00:29:08,820 --> 00:29:12,270
<font color="#CCCCCC">server said cool I understand what I'm</font>

727
00:29:10,560 --> 00:29:14,550
<font color="#E5E5E5">doing and I'm gonna come over to my</font>

728
00:29:12,270 --> 00:29:16,560
magic<font color="#CCCCCC"> Facebook window</font><font color="#E5E5E5"> I'm gonna log</font><font color="#CCCCCC"> in</font>

729
00:29:14,550 --> 00:29:19,050
with my<font color="#CCCCCC"> six double net account which is</font>

730
00:29:16,560 --> 00:29:21,090
not<font color="#E5E5E5"> my real</font><font color="#CCCCCC"> account and then you know</font>

731
00:29:19,050 --> 00:29:24,210
what you'll see here is<font color="#CCCCCC"> that the browser</font>

732
00:29:21,090 --> 00:29:25,830
<font color="#E5E5E5">that I</font><font color="#CCCCCC"> formed hooked captured that</font><font color="#E5E5E5"> and</font>

733
00:29:24,210 --> 00:29:28,140
sent those credentials<font color="#E5E5E5"> back up to my</font>

734
00:29:25,830 --> 00:29:29,760
controller for storage so then I<font color="#CCCCCC"> can</font><font color="#E5E5E5"> go</font>

735
00:29:28,140 --> 00:29:32,010
in and ask my controller to get the

736
00:29:29,760 --> 00:29:35,490
results of<font color="#E5E5E5"> that tasking and you can see</font>

737
00:29:32,010 --> 00:29:38,879
<font color="#E5E5E5">I got the password</font><font color="#CCCCCC"> so basically hooked</font>

738
00:29:35,490 --> 00:29:42,930
into the<font color="#CCCCCC"> form extension using chrome</font>

739
00:29:38,880 --> 00:29:46,920
<font color="#CCCCCC">Dobbs execute script and got back the</font>

740
00:29:42,930 --> 00:29:48,810
<font color="#CCCCCC">results and</font><font color="#E5E5E5"> sent it up next cool one key</font>

741
00:29:46,920 --> 00:29:50,310
<font color="#E5E5E5">logging this</font><font color="#CCCCCC"> isn't really on special</font>

742
00:29:48,810 --> 00:29:53,429
<font color="#CCCCCC">JavaScript key loggers have</font><font color="#E5E5E5"> been around</font>

743
00:29:50,310 --> 00:29:55,290
for years<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> what I did</font><font color="#E5E5E5"> here is</font>

744
00:29:53,430 --> 00:29:57,780
<font color="#E5E5E5">leverage the ability</font><font color="#CCCCCC"> to inject</font>

745
00:29:55,290 --> 00:30:00,570
JavaScript in tabs<font color="#CCCCCC"> to selectively inject</font>

746
00:29:57,780 --> 00:30:02,460
a JavaScript key logger<font color="#E5E5E5"> into the tab</font><font color="#CCCCCC"> the</font>

747
00:30:00,570 --> 00:30:03,960
key piece or fun piece<font color="#E5E5E5"> about this is my</font>

748
00:30:02,460 --> 00:30:06,240
JavaScript key logger<font color="#E5E5E5"> that I would</font>

749
00:30:03,960 --> 00:30:08,460
<font color="#CCCCCC">jekt</font><font color="#E5E5E5"> used</font><font color="#CCCCCC"> chrome messages to communicate</font>

750
00:30:06,240 --> 00:30:10,110
<font color="#CCCCCC">back to the extension</font><font color="#E5E5E5"> so like my</font>

751
00:30:08,460 --> 00:30:11,810
<font color="#CCCCCC">JavaScript blob that</font><font color="#E5E5E5"> was injected into</font>

752
00:30:10,110 --> 00:30:14,280
<font color="#CCCCCC">the site did not communicate out</font>

753
00:30:11,810 --> 00:30:16,530
<font color="#E5E5E5">directly it communicated back</font><font color="#CCCCCC"> to the</font>

754
00:30:14,280 --> 00:30:17,700
extension and the extension communicated

755
00:30:16,530 --> 00:30:20,100
<font color="#E5E5E5">out through the web socket that had</font>

756
00:30:17,700 --> 00:30:21,930
already had so no new<font color="#CCCCCC"> tunnels standing</font>

757
00:30:20,100 --> 00:30:23,639
up no new communications<font color="#E5E5E5"> all using</font>

758
00:30:21,930 --> 00:30:25,740
Chrome's messages which<font color="#CCCCCC"> allow</font><font color="#E5E5E5"> tabs that</font>

759
00:30:23,640 --> 00:30:27,000
<font color="#E5E5E5">communicate across</font><font color="#CCCCCC"> you could see</font>

760
00:30:25,740 --> 00:30:28,680
essentially<font color="#E5E5E5"> in here I'll let her run</font>

761
00:30:27,000 --> 00:30:31,230
through one more<font color="#E5E5E5"> time</font><font color="#CCCCCC"> cos the</font><font color="#E5E5E5"> keylogger</font>

762
00:30:28,680 --> 00:30:34,020
<font color="#E5E5E5">typed in a cool sensitive message in the</font>

763
00:30:31,230 --> 00:30:36,030
in the box<font color="#CCCCCC"> it was all logged using</font>

764
00:30:34,020 --> 00:30:39,750
<font color="#E5E5E5">Chrome messages exfiltrated out through</font>

765
00:30:36,030 --> 00:30:41,610
the Chrome<font color="#E5E5E5"> extension I said the default</font>

766
00:30:39,750 --> 00:30:43,350
is capture like 15 seconds<font color="#E5E5E5"> of</font><font color="#CCCCCC"> this tab</font>

767
00:30:41,610 --> 00:30:45,449
<font color="#CCCCCC">but</font><font color="#E5E5E5"> you know all this is configurable</font>

768
00:30:43,350 --> 00:30:47,580
depending on how much<font color="#E5E5E5"> JavaScript</font><font color="#CCCCCC"> kung-fu</font>

769
00:30:45,450 --> 00:30:50,340
<font color="#E5E5E5">you want to do and in this case I'm</font>

770
00:30:47,580 --> 00:30:52,080
hooking Gmail<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you could really hook</font>

771
00:30:50,340 --> 00:30:53,639
any site here<font color="#E5E5E5"> that you wanted to that</font>

772
00:30:52,080 --> 00:30:57,929
you're able<font color="#CCCCCC"> to get JavaScript injected</font>

773
00:30:53,640 --> 00:30:59,940
into this is my personal<font color="#E5E5E5"> favorite</font><font color="#CCCCCC"> every</font>

774
00:30:57,930 --> 00:31:01,650
red teamer is a<font color="#E5E5E5"> voyeur don't let them</font>

775
00:30:59,940 --> 00:31:04,020
tell you otherwise like they their whole

776
00:31:01,650 --> 00:31:05,700
job is to<font color="#E5E5E5"> conduct espionage and</font>

777
00:31:04,020 --> 00:31:08,970
companies<font color="#CCCCCC"> and like learn use</font><font color="#E5E5E5"> that for</font>

778
00:31:05,700 --> 00:31:11,700
their<font color="#E5E5E5"> advantage and so in this case</font><font color="#CCCCCC"> I</font>

779
00:31:08,970 --> 00:31:13,080
love screenshots<font color="#E5E5E5"> like</font><font color="#CCCCCC"> sharing a text all</font>

780
00:31:11,700 --> 00:31:15,000
day is<font color="#E5E5E5"> fun</font><font color="#CCCCCC"> but staring at</font><font color="#E5E5E5"> pictures</font><font color="#CCCCCC"> and</font>

781
00:31:13,080 --> 00:31:17,490
<font color="#E5E5E5">much more fun in this case you can use</font>

782
00:31:15,000 --> 00:31:19,680
<font color="#E5E5E5">the chrome API to do chrome tabs that</font>

783
00:31:17,490 --> 00:31:21,150
capture visible tab which essentially

784
00:31:19,680 --> 00:31:24,030
allows<font color="#E5E5E5"> you to</font><font color="#CCCCCC"> capture a picture picture</font>

785
00:31:21,150 --> 00:31:25,200
<font color="#E5E5E5">of whatever the tab is extensions can do</font>

786
00:31:24,030 --> 00:31:27,750
this as long<font color="#CCCCCC"> as they have the proper</font>

787
00:31:25,200 --> 00:31:29,790
permission<font color="#E5E5E5"> and so I had my extension the</font>

788
00:31:27,750 --> 00:31:32,160
ability to arbitrarily<font color="#E5E5E5"> get screen</font>

789
00:31:29,790 --> 00:31:33,840
captures<font color="#CCCCCC"> of whatever</font><font color="#E5E5E5"> web pages and then</font>

790
00:31:32,160 --> 00:31:35,670
<font color="#E5E5E5">X will trade that out as a data blob</font>

791
00:31:33,840 --> 00:31:37,020
through the<font color="#E5E5E5"> normal WebSocket sort of</font>

792
00:31:35,670 --> 00:31:39,270
that server side and then allow you<font color="#E5E5E5"> to</font>

793
00:31:37,020 --> 00:31:41,220
download and process<font color="#E5E5E5"> that so you can see</font>

794
00:31:39,270 --> 00:31:43,889
here I had a user that<font color="#CCCCCC"> was browsing</font><font color="#E5E5E5"> the</font>

795
00:31:41,220 --> 00:31:45,240
old iceberg<font color="#CCCCCC"> website I was able to</font><font color="#E5E5E5"> get a</font>

796
00:31:43,890 --> 00:31:46,770
screen capture<font color="#E5E5E5"> of what they're browsing</font>

797
00:31:45,240 --> 00:31:48,060
in this case a<font color="#E5E5E5"> picture one of our</font>

798
00:31:46,770 --> 00:31:50,340
researchers<font color="#E5E5E5"> hard at work on his</font>

799
00:31:48,060 --> 00:31:53,669
mechanical keyboard<font color="#E5E5E5"> pounding</font><font color="#CCCCCC"> away in</font>

800
00:31:50,340 --> 00:31:55,649
<font color="#CCCCCC">some code but screen capture</font><font color="#E5E5E5"> this could</font>

801
00:31:53,670 --> 00:31:57,240
be anything from<font color="#CCCCCC"> banks sites to your</font>

802
00:31:55,650 --> 00:31:58,710
<font color="#E5E5E5">most sensitive health information</font><font color="#CCCCCC"> that</font>

803
00:31:57,240 --> 00:32:01,320
<font color="#CCCCCC">you're browsing</font><font color="#E5E5E5"> and your extensions</font>

804
00:31:58,710 --> 00:32:04,050
<font color="#E5E5E5">rolling this all the time possibilities</font>

805
00:32:01,320 --> 00:32:06,149
are<font color="#CCCCCC"> endless</font><font color="#E5E5E5"> and then my personal</font>

806
00:32:04,050 --> 00:32:07,710
<font color="#E5E5E5">favorite</font><font color="#CCCCCC"> anyone uses like browser</font>

807
00:32:06,150 --> 00:32:08,720
pivoting<font color="#E5E5E5"> inside cobalt sorry core</font>

808
00:32:07,710 --> 00:32:11,750
<font color="#CCCCCC">Metasploit</font><font color="#E5E5E5"> and</font>

809
00:32:08,720 --> 00:32:14,960
some<font color="#CCCCCC"> maybe elephants a</font><font color="#E5E5E5"> person or</font><font color="#CCCCCC"> two the</font>

810
00:32:11,750 --> 00:32:16,850
whole<font color="#E5E5E5"> concept is if I issue</font><font color="#CCCCCC"> a Request</font><font color="#E5E5E5"> in</font>

811
00:32:14,960 --> 00:32:19,309
the concept of<font color="#E5E5E5"> the burden that's in the</font>

812
00:32:16,850 --> 00:32:21,080
context of<font color="#E5E5E5"> the browser</font><font color="#CCCCCC"> it's gonna use</font>

813
00:32:19,309 --> 00:32:22,879
whatever session information<font color="#CCCCCC"> and cookies</font>

814
00:32:21,080 --> 00:32:25,010
<font color="#E5E5E5">that the browser</font><font color="#CCCCCC"> already has established</font>

815
00:32:22,880 --> 00:32:27,409
as long as the request is<font color="#CCCCCC"> coming from</font>

816
00:32:25,010 --> 00:32:29,960
the browser and the proper like

817
00:32:27,409 --> 00:32:31,940
<font color="#E5E5E5">cross-origin</font><font color="#CCCCCC"> suss</font><font color="#E5E5E5"> okay so if I can issue</font>

818
00:32:29,960 --> 00:32:34,100
a request from<font color="#E5E5E5"> the context of I</font><font color="#CCCCCC"> don't</font>

819
00:32:31,940 --> 00:32:36,190
know a<font color="#CCCCCC"> gmail tab</font><font color="#E5E5E5"> it'll have the session</font>

820
00:32:34,100 --> 00:32:38,870
<font color="#E5E5E5">initiated and established from Gmail</font>

821
00:32:36,190 --> 00:32:41,390
well this extension<font color="#E5E5E5"> can issue requests</font>

822
00:32:38,870 --> 00:32:44,239
from any context that you have open<font color="#E5E5E5"> so</font>

823
00:32:41,390 --> 00:32:45,710
if I can force my extension to<font color="#E5E5E5"> login</font><font color="#CCCCCC"> to</font>

824
00:32:44,240 --> 00:32:48,110
<font color="#E5E5E5">Gmail from a Gmail tab you already have</font>

825
00:32:45,710 --> 00:32:50,539
open and pull that<font color="#CCCCCC"> requests information</font>

826
00:32:48,110 --> 00:32:53,360
back<font color="#CCCCCC"> I can see I get essentially I</font><font color="#E5E5E5"> can</font>

827
00:32:50,539 --> 00:32:54,919
browse your Gmail inbox<font color="#E5E5E5"> and</font><font color="#CCCCCC"> brah can</font>

828
00:32:53,360 --> 00:32:56,418
pivot<font color="#E5E5E5"> or request to Gmail through an</font>

829
00:32:54,919 --> 00:32:59,419
already existing Gmail window and<font color="#E5E5E5"> get</font>

830
00:32:56,419 --> 00:33:01,340
the results and display it<font color="#CCCCCC"> so in this</font>

831
00:32:59,419 --> 00:33:05,200
case you can see here<font color="#E5E5E5"> I</font><font color="#CCCCCC"> task my thing to</font>

832
00:33:01,340 --> 00:33:08,209
issue a<font color="#E5E5E5"> Gmail mail.google.com</font><font color="#CCCCCC"> request</font>

833
00:33:05,200 --> 00:33:11,390
and then what you'll see is I get<font color="#CCCCCC"> to</font>

834
00:33:08,210 --> 00:33:13,580
reply back and I'm able<font color="#E5E5E5"> to I basically</font>

835
00:33:11,390 --> 00:33:15,289
get<font color="#E5E5E5"> the HTML back from my</font><font color="#CCCCCC"> Inbox</font>

836
00:33:13,580 --> 00:33:16,908
<font color="#CCCCCC">and then I'm able to</font><font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> just grab</font>

837
00:33:15,289 --> 00:33:19,129
through that HTML in this case I<font color="#CCCCCC"> grab</font>

838
00:33:16,909 --> 00:33:21,740
for like I<font color="#E5E5E5"> think a secret password</font><font color="#CCCCCC"> cuz</font>

839
00:33:19,130 --> 00:33:23,659
<font color="#CCCCCC">proof of concept</font><font color="#E5E5E5"> here and I don't know</font>

840
00:33:21,740 --> 00:33:25,820
who has password resets<font color="#CCCCCC"> coming to their</font>

841
00:33:23,659 --> 00:33:28,100
email all the<font color="#CCCCCC"> time yeah like everybody</font>

842
00:33:25,820 --> 00:33:29,450
so it's kind of<font color="#E5E5E5"> a proof of concept here</font>

843
00:33:28,100 --> 00:33:31,459
but I could browse<font color="#CCCCCC"> they anything I</font><font color="#E5E5E5"> could</font>

844
00:33:29,450 --> 00:33:33,710
<font color="#E5E5E5">browse they any cap enabled sites for</font>

845
00:33:31,460 --> 00:33:35,480
<font color="#CCCCCC">Gabby's public leaning in</font><font color="#E5E5E5"> the room</font>

846
00:33:33,710 --> 00:33:37,309
two-factor enabled sites if you've got a

847
00:33:35,480 --> 00:33:39,710
session established like<font color="#E5E5E5"> they're able to</font>

848
00:33:37,309 --> 00:33:43,280
<font color="#E5E5E5">be hit</font><font color="#CCCCCC"> with this technique</font><font color="#E5E5E5"> it's from an</font>

849
00:33:39,710 --> 00:33:45,440
extension that you've installed the<font color="#E5E5E5"> last</font>

850
00:33:43,280 --> 00:33:47,299
one<font color="#E5E5E5"> I have this concept of like I want</font>

851
00:33:45,440 --> 00:33:48,650
to gain code execution during extension

852
00:33:47,299 --> 00:33:51,080
<font color="#E5E5E5">because that's the ultimate sexiness</font>

853
00:33:48,650 --> 00:33:53,870
like user installs extension I get a

854
00:33:51,080 --> 00:33:55,389
shell<font color="#E5E5E5"> like how does</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> and so in</font>

855
00:33:53,870 --> 00:33:57,789
this<font color="#E5E5E5"> case I kind of did a</font>

856
00:33:55,389 --> 00:33:59,799
<font color="#E5E5E5">rigged proof of concept where I set up a</font>

857
00:33:57,789 --> 00:34:02,350
vulnerable server vulnerable<font color="#CCCCCC"> 2d</font>

858
00:33:59,799 --> 00:34:04,059
<font color="#E5E5E5">serialization inside of a network and I</font>

859
00:34:02,350 --> 00:34:06,610
use<font color="#CCCCCC"> this same exact browser pivot</font>

860
00:34:04,059 --> 00:34:10,029
technique to issue a basically a

861
00:34:06,610 --> 00:34:11,918
serialized<font color="#CCCCCC"> exploit so exploit a</font>

862
00:34:10,030 --> 00:34:13,869
thoroughness serialize object<font color="#CCCCCC"> into my</font>

863
00:34:11,918 --> 00:34:15,730
request that's specifically<font color="#E5E5E5"> crafted to</font>

864
00:34:13,869 --> 00:34:17,829
take advantage<font color="#E5E5E5"> of this vulnerability</font><font color="#CCCCCC"> and</font>

865
00:34:15,730 --> 00:34:20,109
what you'll<font color="#CCCCCC"> see</font><font color="#E5E5E5"> here is I'm assuming</font>

866
00:34:17,829 --> 00:34:21,819
this tasking<font color="#E5E5E5"> if I'm successful</font><font color="#CCCCCC"> I get</font>

867
00:34:20,109 --> 00:34:22,899
code execution I drop<font color="#CCCCCC"> high dot text to</font>

868
00:34:21,819 --> 00:34:24,940
the directory<font color="#E5E5E5"> and so you can see in the</font>

869
00:34:22,899 --> 00:34:26,529
top right<font color="#E5E5E5"> there a text file appears that</font>

870
00:34:24,940 --> 00:34:28,510
could have<font color="#E5E5E5"> been a shell calling out or</font>

871
00:34:26,530 --> 00:34:30,309
<font color="#CCCCCC">powershell running or I don't have</font><font color="#E5E5E5"> C</font>

872
00:34:28,510 --> 00:34:32,679
sharps the<font color="#E5E5E5"> cool kid thing nowadays so</font>

873
00:34:30,309 --> 00:34:35,470
like<font color="#E5E5E5"> maybe I you know did done that</font><font color="#CCCCCC"> to</font>

874
00:34:32,679 --> 00:34:37,659
<font color="#E5E5E5">jscript to get a c-sharp module injected</font>

875
00:34:35,469 --> 00:34:39,308
or or some technique<font color="#E5E5E5"> I get code</font>

876
00:34:37,659 --> 00:34:41,319
execution on a vulnerable<font color="#E5E5E5"> server sitting</font>

877
00:34:39,309 --> 00:34:44,200
internal to a network not<font color="#E5E5E5"> public facing</font>

878
00:34:41,319 --> 00:34:45,609
all via Chrome extension so<font color="#E5E5E5"> there's a</font>

879
00:34:44,199 --> 00:34:47,138
leap in there that I'll leave unsaid

880
00:34:45,609 --> 00:34:49,119
like how do I know it's there how do<font color="#CCCCCC"> I</font>

881
00:34:47,139 --> 00:34:52,480
scan the<font color="#CCCCCC"> network but proves it out in</font>

882
00:34:49,119 --> 00:34:56,250
the lab it's very possible so jumping

883
00:34:52,480 --> 00:34:59,170
<font color="#E5E5E5">into kind of the defensive side yeah</font><font color="#CCCCCC"> so</font>

884
00:34:56,250 --> 00:35:04,329
who here is heard of the<font color="#CCCCCC"> mitre attack</font>

885
00:34:59,170 --> 00:35:06,900
framework cool kids<font color="#E5E5E5"> awesome yeah so we</font>

886
00:35:04,329 --> 00:35:11,440
actually<font color="#E5E5E5"> worked with them</font><font color="#CCCCCC"> to get this</font>

887
00:35:06,900 --> 00:35:14,500
added in as a couple<font color="#CCCCCC"> of items</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> so</font>

888
00:35:11,440 --> 00:35:18,490
<font color="#E5E5E5">man in the browser as Justin</font><font color="#CCCCCC"> are talking</font>

889
00:35:14,500 --> 00:35:21,520
about<font color="#CCCCCC"> and browser extensions themselves</font>

890
00:35:18,490 --> 00:35:23,890
as both a persistence mechanism and as a

891
00:35:21,520 --> 00:35:26,109
collection<font color="#E5E5E5"> mechanism the persistence</font>

892
00:35:23,890 --> 00:35:27,790
part is<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> pretty cool because not</font>

893
00:35:26,109 --> 00:35:29,380
only<font color="#E5E5E5"> with like the background permission</font>

894
00:35:27,790 --> 00:35:30,880
set but I mean<font color="#E5E5E5"> your your user is</font>

895
00:35:29,380 --> 00:35:32,470
basically<font color="#CCCCCC"> just gonna start up chrome</font>

896
00:35:30,880 --> 00:35:35,079
<font color="#CCCCCC">every time they start</font><font color="#E5E5E5"> their computers so</font>

897
00:35:32,470 --> 00:35:36,399
<font color="#CCCCCC">them</font><font color="#E5E5E5"> I would highly recommend if you're</font>

898
00:35:35,079 --> 00:35:37,690
out discovering like new offensive

899
00:35:36,400 --> 00:35:39,010
tradecraft or<font color="#CCCCCC"> you're</font><font color="#E5E5E5"> threatened</font><font color="#CCCCCC"> tell</font>

900
00:35:37,690 --> 00:35:40,960
person<font color="#E5E5E5"> finding</font><font color="#CCCCCC"> stuff in the wild like</font>

901
00:35:39,010 --> 00:35:42,700
work with<font color="#CCCCCC"> mitre</font><font color="#E5E5E5"> and get it added you'll</font>

902
00:35:40,960 --> 00:35:44,319
have the<font color="#CCCCCC"> ability to affect</font><font color="#E5E5E5"> hundreds of</font>

903
00:35:42,700 --> 00:35:46,359
security program versus just your own

904
00:35:44,319 --> 00:35:48,579
<font color="#E5E5E5">right because a lot of people</font><font color="#CCCCCC"> go through</font>

905
00:35:46,359 --> 00:35:51,220
<font color="#CCCCCC">this framework in</font><font color="#E5E5E5"> you know validating</font>

906
00:35:48,579 --> 00:35:52,420
like unit tests of like these are you

907
00:35:51,220 --> 00:35:55,058
know it's an attempt at like an

908
00:35:52,420 --> 00:35:58,150
exhaustive<font color="#E5E5E5"> list of all</font><font color="#CCCCCC"> of the bad things</font>

909
00:35:55,059 --> 00:36:00,670
<font color="#E5E5E5">that someone can do to a system to you</font>

910
00:35:58,150 --> 00:36:03,910
know<font color="#CCCCCC"> gain persistence</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> whatever</font><font color="#E5E5E5"> right</font>

911
00:36:00,670 --> 00:36:04,900
<font color="#E5E5E5">so people will go through</font><font color="#CCCCCC"> this list</font><font color="#E5E5E5"> and</font>

912
00:36:03,910 --> 00:36:06,299
make sure<font color="#E5E5E5"> that they're covered in all</font>

913
00:36:04,900 --> 00:36:08,550
these<font color="#E5E5E5"> different</font><font color="#CCCCCC"> areas</font>

914
00:36:06,300 --> 00:36:09,930
so this is really really<font color="#CCCCCC"> important it</font>

915
00:36:08,550 --> 00:36:14,550
was<font color="#CCCCCC"> a lot of fun working with</font><font color="#E5E5E5"> mitre guys</font>

916
00:36:09,930 --> 00:36:17,669
and getting<font color="#E5E5E5"> us added</font><font color="#CCCCCC"> okay yeah so where</font>

917
00:36:14,550 --> 00:36:22,500
do extensions live on<font color="#E5E5E5"> a system</font><font color="#CCCCCC"> three</font>

918
00:36:17,670 --> 00:36:26,070
places<font color="#CCCCCC"> on Mac OS</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> there</font>

919
00:36:22,500 --> 00:36:28,920
Windows Linux so if you need to look for

920
00:36:26,070 --> 00:36:30,330
extensions doing weird stuff<font color="#CCCCCC"> those</font><font color="#E5E5E5"> are</font>

921
00:36:28,920 --> 00:36:33,120
the three places<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> it</font>

922
00:36:30,330 --> 00:36:34,650
super simple<font color="#CCCCCC"> really nice</font><font color="#E5E5E5"> that it's not</font>

923
00:36:33,120 --> 00:36:38,339
spiderwebbed all over across<font color="#CCCCCC"> the</font>

924
00:36:34,650 --> 00:36:40,980
computer for<font color="#E5E5E5"> network just looking for an</font>

925
00:36:38,340 --> 00:36:42,360
origin header<font color="#CCCCCC"> being said that's</font><font color="#E5E5E5"> only</font>

926
00:36:40,980 --> 00:36:46,070
<font color="#CCCCCC">four</font><font color="#E5E5E5"> course requests though</font>

927
00:36:42,360 --> 00:36:48,750
or like requests that invoke<font color="#E5E5E5"> like</font>

928
00:36:46,070 --> 00:36:50,550
<font color="#E5E5E5">cross-origin resource sharing stuff</font><font color="#CCCCCC"> so</font>

929
00:36:48,750 --> 00:36:57,720
certain<font color="#E5E5E5"> like get requests won't actually</font>

930
00:36:50,550 --> 00:37:00,690
<font color="#E5E5E5">trigger this so OS queried you guys</font>

931
00:36:57,720 --> 00:37:03,330
familiar with<font color="#E5E5E5"> I was query some</font><font color="#CCCCCC"> okay</font>

932
00:37:00,690 --> 00:37:06,030
<font color="#E5E5E5">maybe kind of okay well so it's</font>

933
00:37:03,330 --> 00:37:10,529
basically just a<font color="#CCCCCC"> way of it's like kind</font>

934
00:37:06,030 --> 00:37:13,340
of looking<font color="#E5E5E5"> through like</font><font color="#CCCCCC"> a system it</font>

935
00:37:10,530 --> 00:37:15,600
<font color="#E5E5E5">creates like kind of sequel tables of</font>

936
00:37:13,340 --> 00:37:18,000
different<font color="#E5E5E5"> configurations on your system</font>

937
00:37:15,600 --> 00:37:20,910
<font color="#E5E5E5">so</font><font color="#CCCCCC"> you can do like</font><font color="#E5E5E5"> a lot of different</font>

938
00:37:18,000 --> 00:37:22,740
stuff<font color="#CCCCCC"> like taking these</font><font color="#E5E5E5"> over time is</font>

939
00:37:20,910 --> 00:37:24,440
<font color="#E5E5E5">really cool that way you can like kind</font>

940
00:37:22,740 --> 00:37:27,209
<font color="#CCCCCC">of track changes to a system over</font><font color="#E5E5E5"> time</font>

941
00:37:24,440 --> 00:37:29,790
<font color="#CCCCCC">and they've</font><font color="#E5E5E5"> actually got a</font><font color="#CCCCCC"> Chrome</font>

942
00:37:27,210 --> 00:37:31,730
extension table<font color="#E5E5E5"> to find in here which is</font>

943
00:37:29,790 --> 00:37:37,580
<font color="#E5E5E5">super cool</font>

944
00:37:31,730 --> 00:37:37,580
the persistent flag here<font color="#E5E5E5"> it's a little</font>

945
00:37:38,090 --> 00:37:43,020
confusing<font color="#CCCCCC"> in my opinion because it's</font>

946
00:37:41,490 --> 00:37:45,959
basically just specifying whether or not

947
00:37:43,020 --> 00:37:48,570
the<font color="#E5E5E5"> background script is active at all</font>

948
00:37:45,960 --> 00:37:52,350
times<font color="#E5E5E5"> which is not exactly the same as</font>

949
00:37:48,570 --> 00:37:58,250
like the the<font color="#E5E5E5"> background permission which</font>

950
00:37:52,350 --> 00:37:58,250
I think would<font color="#CCCCCC"> be</font><font color="#E5E5E5"> more interesting yeah</font>

951
00:37:59,660 --> 00:38:06,529
<font color="#E5E5E5">Chrome extension so chrome actually they</font>

952
00:38:02,749 --> 00:38:10,308
have like this whole<font color="#E5E5E5"> GPO thing that you</font>

953
00:38:06,529 --> 00:38:13,579
can import with it<font color="#E5E5E5"> yeah 365 policy is a</font>

954
00:38:10,309 --> 00:38:14,809
policy<font color="#E5E5E5"> for every day of the year</font><font color="#CCCCCC"> of</font>

955
00:38:13,579 --> 00:38:16,429
different policies that you<font color="#E5E5E5"> can import</font>

956
00:38:14,809 --> 00:38:19,239
<font color="#E5E5E5">into your</font><font color="#CCCCCC"> Active</font><font color="#E5E5E5"> Directory and get a lot</font>

957
00:38:16,429 --> 00:38:22,369
of much more<font color="#CCCCCC"> modular control over</font>

958
00:38:19,239 --> 00:38:24,679
extensions<font color="#CCCCCC"> as far</font><font color="#E5E5E5"> as like</font><font color="#CCCCCC"> kind of you</font>

959
00:38:22,369 --> 00:38:27,499
<font color="#CCCCCC">know tightening stuff down security</font><font color="#E5E5E5"> wise</font>

960
00:38:24,679 --> 00:38:30,229
there's these extensions<font color="#E5E5E5"> install</font>

961
00:38:27,499 --> 00:38:32,269
blacklist whitelist<font color="#CCCCCC"> force list so the</font>

962
00:38:30,229 --> 00:38:36,169
force list will make sure that every

963
00:38:32,269 --> 00:38:39,140
system<font color="#CCCCCC"> you know in your domain is forced</font>

964
00:38:36,169 --> 00:38:41,808
to install<font color="#E5E5E5"> this thing and then whitelist</font>

965
00:38:39,140 --> 00:38:43,759
<font color="#E5E5E5">are like what are good acceptable</font>

966
00:38:41,809 --> 00:38:46,189
extensions for your<font color="#E5E5E5"> enterprise and then</font>

967
00:38:43,759 --> 00:38:47,749
<font color="#E5E5E5">blacklist is of course you know this is</font>

968
00:38:46,189 --> 00:38:49,249
a known<font color="#E5E5E5"> bad extension what's blacklist</font>

969
00:38:47,749 --> 00:38:52,729
<font color="#CCCCCC">that I don't want that</font><font color="#E5E5E5"> here you can also</font>

970
00:38:49,249 --> 00:38:54,169
do<font color="#E5E5E5"> blacklist</font><font color="#CCCCCC"> for all</font><font color="#E5E5E5"> extensions I don't</font>

971
00:38:52,729 --> 00:38:57,049
want anyone installing stuff<font color="#CCCCCC"> if you're</font>

972
00:38:54,169 --> 00:38:59,419
really paranoid<font color="#CCCCCC"> and your users will see</font>

973
00:38:57,049 --> 00:39:03,589
<font color="#E5E5E5">this type</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> it's blocked by</font><font color="#E5E5E5"> the</font>

974
00:38:59,419 --> 00:39:08,239
admin<font color="#E5E5E5"> and so then they</font><font color="#CCCCCC"> can go</font><font color="#E5E5E5"> and bug IT</font>

975
00:39:03,589 --> 00:39:09,979
to let them install<font color="#E5E5E5"> it so</font><font color="#CCCCCC"> I'm a former</font>

976
00:39:08,239 --> 00:39:13,789
<font color="#E5E5E5">Intel</font><font color="#CCCCCC"> guys former red teamer and until</font>

977
00:39:09,979 --> 00:39:15,558
guy<font color="#CCCCCC"> the</font><font color="#E5E5E5"> dual personality some days we</font>

978
00:39:13,789 --> 00:39:16,459
had this<font color="#CCCCCC"> concept in the</font><font color="#E5E5E5"> military called</font>

979
00:39:15,559 --> 00:39:18,289
getting<font color="#E5E5E5"> left</font><font color="#CCCCCC"> of boomers for</font>

980
00:39:16,459 --> 00:39:19,640
<font color="#CCCCCC">counterterrorism purposes the idea was</font>

981
00:39:18,289 --> 00:39:20,929
like<font color="#E5E5E5"> we want to get ahead</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> when bombs</font>

982
00:39:19,640 --> 00:39:22,788
or detonating so we want to know about

983
00:39:20,929 --> 00:39:24,529
something<font color="#CCCCCC"> before they're</font><font color="#E5E5E5"> happening for</font>

984
00:39:22,789 --> 00:39:27,380
the purpose of issuing early warning and

985
00:39:24,529 --> 00:39:29,779
prediction and stopping it and a lot<font color="#CCCCCC"> of</font>

986
00:39:27,380 --> 00:39:33,019
what I do on the<font color="#E5E5E5"> gigamon side is similar</font>

987
00:39:29,779 --> 00:39:34,279
<font color="#CCCCCC">so I'm</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> threat Intel dude here</font><font color="#E5E5E5"> everyone</font>

988
00:39:33,019 --> 00:39:35,238
probably has strong<font color="#E5E5E5"> opinions about their</font>

989
00:39:34,279 --> 00:39:36,829
intelligence<font color="#E5E5E5"> depending on</font><font color="#CCCCCC"> our</font>

990
00:39:35,239 --> 00:39:38,299
organization<font color="#CCCCCC"> implements and does it</font>

991
00:39:36,829 --> 00:39:39,769
there's different levels<font color="#E5E5E5"> strategic to</font>

992
00:39:38,299 --> 00:39:41,959
tactical<font color="#E5E5E5"> to functional and all these</font>

993
00:39:39,769 --> 00:39:43,908
things<font color="#E5E5E5"> in my opinion their intelligence</font>

994
00:39:41,959 --> 00:39:46,069
<font color="#E5E5E5">is key role is to inform</font><font color="#CCCCCC"> decision makers</font>

995
00:39:43,909 --> 00:39:47,539
<font color="#E5E5E5">and then prioritize and support</font>

996
00:39:46,069 --> 00:39:49,519
defensive<font color="#CCCCCC"> vestra efforts across</font><font color="#E5E5E5"> the</font>

997
00:39:47,539 --> 00:39:51,439
entire spectrum so that<font color="#E5E5E5"> kind of includes</font>

998
00:39:49,519 --> 00:39:53,839
<font color="#E5E5E5">three key areas I'm doing everything I</font>

999
00:39:51,439 --> 00:39:54,949
<font color="#CCCCCC">can</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> support responders and inform</font>

1000
00:39:53,839 --> 00:39:55,880
them and enrich them with<font color="#E5E5E5"> more</font>

1001
00:39:54,949 --> 00:39:58,279
<font color="#CCCCCC">information</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> what they're</font>

1002
00:39:55,880 --> 00:39:59,659
responding to<font color="#E5E5E5"> I'm informing detection</font>

1003
00:39:58,279 --> 00:40:01,939
efforts<font color="#E5E5E5"> so maybe I have</font><font color="#CCCCCC"> a soccer</font>

1004
00:39:59,659 --> 00:40:03,120
detection team<font color="#E5E5E5"> my goal is to like make</font>

1005
00:40:01,939 --> 00:40:05,370
them understand how threats

1006
00:40:03,120 --> 00:40:06,779
<font color="#E5E5E5">they work</font><font color="#CCCCCC"> that's the point</font><font color="#E5E5E5"> of boom I'm</font>

1007
00:40:05,370 --> 00:40:08,850
supplementing that<font color="#E5E5E5"> point of boom by</font>

1008
00:40:06,780 --> 00:40:10,950
helping them boom on more things<font color="#E5E5E5"> and</font>

1009
00:40:08,850 --> 00:40:12,180
<font color="#E5E5E5">boom more intelligently</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> on the</font>

1010
00:40:10,950 --> 00:40:13,620
<font color="#CCCCCC">left-hand side which</font><font color="#E5E5E5"> is what we're gonna</font>

1011
00:40:12,180 --> 00:40:16,470
<font color="#E5E5E5">talk a little bit about now is early</font>

1012
00:40:13,620 --> 00:40:18,540
warning<font color="#CCCCCC"> I want to discover</font><font color="#E5E5E5"> things before</font>

1013
00:40:16,470 --> 00:40:20,009
they ever affect my organization so you

1014
00:40:18,540 --> 00:40:21,540
<font color="#E5E5E5">might</font><font color="#CCCCCC"> be wondering how you do this Carm</font>

1015
00:40:20,010 --> 00:40:23,520
extensions if you're a threat Intel

1016
00:40:21,540 --> 00:40:25,500
person<font color="#E5E5E5"> well if only there was a data</font>

1017
00:40:23,520 --> 00:40:27,660
<font color="#E5E5E5">source that was constantly crawling and</font>

1018
00:40:25,500 --> 00:40:30,360
categorizing every<font color="#E5E5E5"> Chrome extension for</font>

1019
00:40:27,660 --> 00:40:33,089
the past couple years<font color="#E5E5E5"> there exists such</font>

1020
00:40:30,360 --> 00:40:35,520
a resource<font color="#E5E5E5"> it's not ours by any means we</font>

1021
00:40:33,090 --> 00:40:36,960
don't<font color="#E5E5E5"> run it use it your own warning</font>

1022
00:40:35,520 --> 00:40:38,970
disposal with all the normal<font color="#CCCCCC"> legal</font>

1023
00:40:36,960 --> 00:40:41,550
disclaimers<font color="#CCCCCC"> they're</font><font color="#E5E5E5"> crawling</font><font color="#CCCCCC"> chrome</font><font color="#E5E5E5"> but</font>

1024
00:40:38,970 --> 00:40:43,259
it's a fantastic<font color="#CCCCCC"> data set to look at and</font>

1025
00:40:41,550 --> 00:40:45,000
it proves to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> very</font><font color="#E5E5E5"> useful if you want</font>

1026
00:40:43,260 --> 00:40:48,030
<font color="#CCCCCC">to</font><font color="#E5E5E5"> go get</font><font color="#CCCCCC"> access to</font><font color="#E5E5E5"> block chrome</font>

1027
00:40:45,000 --> 00:40:49,920
information so what kind of things can

1028
00:40:48,030 --> 00:40:51,420
we<font color="#E5E5E5"> do and of like Generic</font><font color="#CCCCCC"> hunti like i</font>

1029
00:40:49,920 --> 00:40:53,910
want to discover<font color="#E5E5E5"> things before they're</font>

1030
00:40:51,420 --> 00:40:55,440
known bad<font color="#CCCCCC"> we can kind of genera size</font>

1031
00:40:53,910 --> 00:40:57,960
some<font color="#E5E5E5"> of the things we're looking for</font><font color="#CCCCCC"> so</font>

1032
00:40:55,440 --> 00:40:59,550
rather than just<font color="#E5E5E5"> looking for specific</font>

1033
00:40:57,960 --> 00:41:01,110
variable names<font color="#E5E5E5"> to</font><font color="#CCCCCC"> our campaign we are</font>

1034
00:40:59,550 --> 00:41:03,150
tracking let's just look at suspicious

1035
00:41:01,110 --> 00:41:04,890
variable names so what makes a variable

1036
00:41:03,150 --> 00:41:06,810
name suspicious<font color="#CCCCCC"> I don't know like random</font>

1037
00:41:04,890 --> 00:41:09,089
hex because variable<font color="#CCCCCC"> names</font><font color="#E5E5E5"> shouldn't be</font>

1038
00:41:06,810 --> 00:41:10,320
named random hex<font color="#CCCCCC"> or for humans</font><font color="#E5E5E5"> and so</font>

1039
00:41:09,090 --> 00:41:12,150
that's the<font color="#E5E5E5"> kind of the one on the left</font>

1040
00:41:10,320 --> 00:41:13,710
<font color="#E5E5E5">the</font><font color="#CCCCCC"> top right</font><font color="#E5E5E5"> is a kind of the</font>

1041
00:41:12,150 --> 00:41:14,910
<font color="#CCCCCC">JavaScript key logger functions</font><font color="#E5E5E5"> that are</font>

1042
00:41:13,710 --> 00:41:17,010
commonly<font color="#CCCCCC"> used so if they're not</font>

1043
00:41:14,910 --> 00:41:19,680
obfuscated looking for the the key codes

1044
00:41:17,010 --> 00:41:22,020
or key press function<font color="#CCCCCC"> extensions should</font>

1045
00:41:19,680 --> 00:41:24,120
<font color="#E5E5E5">not be logging key</font><font color="#CCCCCC"> presses very often so</font>

1046
00:41:22,020 --> 00:41:26,070
<font color="#E5E5E5">this thing tends to be a slightly better</font>

1047
00:41:24,120 --> 00:41:28,200
confidence<font color="#CCCCCC"> one and the bottom-right</font>

1048
00:41:26,070 --> 00:41:30,420
looking for extensions kind of setting

1049
00:41:28,200 --> 00:41:33,529
cookies and storing information<font color="#E5E5E5"> that</font>

1050
00:41:30,420 --> 00:41:35,580
might<font color="#CCCCCC"> be</font><font color="#E5E5E5"> useful for configuration</font>

1051
00:41:33,530 --> 00:41:38,280
examples of what we found<font color="#E5E5E5"> using</font><font color="#CCCCCC"> miso</font>

1052
00:41:35,580 --> 00:41:40,080
like these three rules<font color="#CCCCCC"> that babyface is</font>

1053
00:41:38,280 --> 00:41:42,750
like what I constantly have looking<font color="#E5E5E5"> at</font>

1054
00:41:40,080 --> 00:41:45,120
stuff like<font color="#E5E5E5"> this the left one is all the</font>

1055
00:41:42,750 --> 00:41:46,050
hex<font color="#E5E5E5"> variable names again all three of</font>

1056
00:41:45,120 --> 00:41:48,210
these like I'm not a hundred percent

1057
00:41:46,050 --> 00:41:49,710
<font color="#E5E5E5">sure they're evil but they don't look</font>

1058
00:41:48,210 --> 00:41:51,360
normal<font color="#CCCCCC"> like this isn't what I normally</font>

1059
00:41:49,710 --> 00:41:53,280
<font color="#E5E5E5">see when what I'm installing my brother</font>

1060
00:41:51,360 --> 00:41:55,410
so whole bunch<font color="#E5E5E5"> of hex obviously</font>

1061
00:41:53,280 --> 00:41:57,370
obfuscated chrome code the middle<font color="#CCCCCC"> one</font>

1062
00:41:55,410 --> 00:41:59,890
<font color="#E5E5E5">the middle</font><font color="#CCCCCC"> one you</font><font color="#E5E5E5"> have dotnet</font>

1063
00:41:57,370 --> 00:42:01,779
levels in<font color="#E5E5E5"> your Chrome extension like</font>

1064
00:41:59,890 --> 00:42:03,790
don't know why<font color="#E5E5E5"> chrome like a it's</font>

1065
00:42:01,780 --> 00:42:06,130
inherently static<font color="#E5E5E5"> webpage</font><font color="#CCCCCC"> Chrome</font>

1066
00:42:03,790 --> 00:42:08,650
extension<font color="#E5E5E5"> should have all these c-sharp</font>

1067
00:42:06,130 --> 00:42:11,290
net mono libraries all loaded up inside

1068
00:42:08,650 --> 00:42:13,090
of<font color="#E5E5E5"> it and the right one you see every</font>

1069
00:42:11,290 --> 00:42:15,130
<font color="#E5E5E5">file is just named with like a single</font>

1070
00:42:13,090 --> 00:42:16,480
character<font color="#E5E5E5"> looks like they tried</font><font color="#CCCCCC"> to do</font>

1071
00:42:15,130 --> 00:42:19,090
some sort of<font color="#E5E5E5"> smash-and-grab on the file</font>

1072
00:42:16,480 --> 00:42:20,020
names like obfuscation<font color="#E5E5E5"> so again we can</font>

1073
00:42:19,090 --> 00:42:21,640
kind<font color="#E5E5E5"> of hunt and start</font><font color="#CCCCCC"> going through</font>

1074
00:42:20,020 --> 00:42:23,470
<font color="#E5E5E5">these we can work with</font><font color="#CCCCCC"> chrome to notify</font>

1075
00:42:21,640 --> 00:42:24,970
or if<font color="#E5E5E5"> you're an Intel organization you</font>

1076
00:42:23,470 --> 00:42:26,770
<font color="#E5E5E5">can protect your</font><font color="#CCCCCC"> customers by adding</font>

1077
00:42:24,970 --> 00:42:29,980
another<font color="#CCCCCC"> touch point of finding evil and</font>

1078
00:42:26,770 --> 00:42:31,180
<font color="#CCCCCC">stopping it before</font><font color="#E5E5E5"> it affects them so</font>

1079
00:42:29,980 --> 00:42:33,130
<font color="#E5E5E5">getting to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> wrap-up point a</font><font color="#CCCCCC"> little</font>

1080
00:42:31,180 --> 00:42:35,290
<font color="#CCCCCC">bit early</font><font color="#E5E5E5"> but some things I</font><font color="#CCCCCC"> really want</font>

1081
00:42:33,130 --> 00:42:37,000
you to<font color="#E5E5E5"> take away so stepping back</font><font color="#CCCCCC"> to a</font>

1082
00:42:35,290 --> 00:42:39,330
larger view<font color="#E5E5E5"> chrome is</font><font color="#CCCCCC"> just one Chrome</font>

1083
00:42:37,000 --> 00:42:41,380
extensions are just one<font color="#E5E5E5"> example of</font>

1084
00:42:39,330 --> 00:42:44,200
potentially unwanted applications or

1085
00:42:41,380 --> 00:42:45,760
software it's it's not<font color="#E5E5E5"> specifically some</font>

1086
00:42:44,200 --> 00:42:47,740
<font color="#CCCCCC">apt</font><font color="#E5E5E5"> threat depending on who's using it</font>

1087
00:42:45,760 --> 00:42:49,450
it's<font color="#E5E5E5"> just generically maybe it's not</font>

1088
00:42:47,740 --> 00:42:51,609
wanted the admin doesn't want<font color="#E5E5E5"> that level</font>

1089
00:42:49,450 --> 00:42:53,460
<font color="#E5E5E5">of ability</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> in general I've seen kind</font>

1090
00:42:51,610 --> 00:42:56,110
<font color="#E5E5E5">of a couple different strategies with</font>

1091
00:42:53,460 --> 00:42:57,880
<font color="#E5E5E5">potentially unwanted applications</font><font color="#CCCCCC"> one is</font>

1092
00:42:56,110 --> 00:42:59,200
<font color="#E5E5E5">people will try</font><font color="#CCCCCC"> to educate</font><font color="#E5E5E5"> the users or</font>

1093
00:42:57,880 --> 00:43:01,090
like I don't want<font color="#E5E5E5"> to lock down my users</font>

1094
00:42:59,200 --> 00:43:03,100
I'm just going<font color="#CCCCCC"> to make them experts</font><font color="#E5E5E5"> in</font>

1095
00:43:01,090 --> 00:43:05,590
computer<font color="#E5E5E5"> security so they never give our</font>

1096
00:43:03,100 --> 00:43:06,730
<font color="#E5E5E5">organization owned</font><font color="#CCCCCC"> I think most</font><font color="#E5E5E5"> people</font>

1097
00:43:05,590 --> 00:43:09,100
in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> room can see the issue of that</font>

1098
00:43:06,730 --> 00:43:10,840
<font color="#E5E5E5">and have probably dealt with some issues</font>

1099
00:43:09,100 --> 00:43:13,990
<font color="#CCCCCC">with that</font><font color="#E5E5E5"> it's it's possible to an</font>

1100
00:43:10,840 --> 00:43:15,310
extent but<font color="#CCCCCC"> the</font><font color="#E5E5E5"> users gonna use</font><font color="#CCCCCC"> its Matt</font>

1101
00:43:13,990 --> 00:43:17,319
Nelson<font color="#CCCCCC"> you should work</font><font color="#E5E5E5"> with always said</font>

1102
00:43:15,310 --> 00:43:19,150
this like simply not<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to prevent</font>

1103
00:43:17,320 --> 00:43:20,650
users<font color="#E5E5E5"> from doing something like this so</font>

1104
00:43:19,150 --> 00:43:22,240
<font color="#CCCCCC">you need</font><font color="#E5E5E5"> a combination</font><font color="#CCCCCC"> that's that</font>

1105
00:43:20,650 --> 00:43:24,160
brings in the second<font color="#E5E5E5"> viewpoint which is</font>

1106
00:43:22,240 --> 00:43:26,200
control<font color="#E5E5E5"> the users some people go</font>

1107
00:43:24,160 --> 00:43:27,430
overboard<font color="#E5E5E5"> of this</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> like I want to</font>

1108
00:43:26,200 --> 00:43:29,350
lock down everything they can<font color="#CCCCCC"> never do</font>

1109
00:43:27,430 --> 00:43:30,490
anything<font color="#CCCCCC"> without calling me and then</font>

1110
00:43:29,350 --> 00:43:31,779
they get to answer phone calls<font color="#CCCCCC"> at 2:00</font>

1111
00:43:30,490 --> 00:43:33,459
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the morning all the</font><font color="#E5E5E5"> time for things</font>

1112
00:43:31,780 --> 00:43:34,180
that maybe they should<font color="#E5E5E5"> have just let in</font>

1113
00:43:33,460 --> 00:43:35,470
the first place

1114
00:43:34,180 --> 00:43:36,970
so<font color="#E5E5E5"> you can see I kind</font><font color="#CCCCCC"> of have the</font>

1115
00:43:35,470 --> 00:43:38,500
perspective<font color="#CCCCCC"> that it should be a mix</font><font color="#E5E5E5"> of</font>

1116
00:43:36,970 --> 00:43:41,350
both like there should be<font color="#E5E5E5"> some amount</font><font color="#CCCCCC"> of</font>

1117
00:43:38,500 --> 00:43:43,240
technical controls<font color="#E5E5E5"> you can do a good</font>

1118
00:43:41,350 --> 00:43:45,400
analysis of<font color="#E5E5E5"> what your organization</font><font color="#CCCCCC"> and</font>

1119
00:43:43,240 --> 00:43:47,859
<font color="#E5E5E5">your company actually require and what</font>

1120
00:43:45,400 --> 00:43:50,740
<font color="#E5E5E5">your users require allow that and then</font>

1121
00:43:47,860 --> 00:43:52,540
prevent the rest<font color="#E5E5E5"> a pretty big</font><font color="#CCCCCC"> white</font>

1122
00:43:50,740 --> 00:43:54,220
<font color="#CCCCCC">listing fan across all of the security</font>

1123
00:43:52,540 --> 00:43:55,870
spectrum I understand it's hard<font color="#E5E5E5"> chrome</font>

1124
00:43:54,220 --> 00:43:57,009
<font color="#E5E5E5">makes it pretty easy with the</font><font color="#CCCCCC"> GPIOs as</font>

1125
00:43:55,870 --> 00:43:58,660
long as you can enumerate what your

1126
00:43:57,010 --> 00:44:00,010
organization<font color="#E5E5E5"> needs and you're willing to</font>

1127
00:43:58,660 --> 00:44:01,810
<font color="#E5E5E5">suffer for</font><font color="#CCCCCC"> the first</font><font color="#E5E5E5"> couple months you</font>

1128
00:44:00,010 --> 00:44:05,530
<font color="#E5E5E5">roll at the policy as you discover more</font>

1129
00:44:01,810 --> 00:44:06,549
things so what's next<font color="#E5E5E5"> this research kind</font>

1130
00:44:05,530 --> 00:44:07,820
of it still has a lot<font color="#E5E5E5"> of unanswered</font>

1131
00:44:06,550 --> 00:44:10,160
<font color="#E5E5E5">pieces and</font>

1132
00:44:07,820 --> 00:44:12,110
<font color="#E5E5E5">from the rest of our lives so love</font>

1133
00:44:10,160 --> 00:44:12,529
anyone<font color="#E5E5E5"> who is interested in stuff get</font>

1134
00:44:12,110 --> 00:44:14,090
going

1135
00:44:12,530 --> 00:44:15,980
download the archive play with it go

1136
00:44:14,090 --> 00:44:17,810
hunting<font color="#CCCCCC"> some carriers we were really</font>

1137
00:44:15,980 --> 00:44:20,060
<font color="#E5E5E5">interested in as other browsers so as</font>

1138
00:44:17,810 --> 00:44:21,950
they roll<font color="#CCCCCC"> out that web extension</font><font color="#E5E5E5"> API can</font>

1139
00:44:20,060 --> 00:44:25,700
<font color="#CCCCCC">these same like Chrome rat you develop</font>

1140
00:44:21,950 --> 00:44:27,080
in<font color="#CCCCCC"> chrome work on edge or</font><font color="#E5E5E5"> ie or</font><font color="#CCCCCC"> any of</font>

1141
00:44:25,700 --> 00:44:29,029
these other<font color="#E5E5E5"> Firefox of these other</font>

1142
00:44:27,080 --> 00:44:30,350
places is there<font color="#E5E5E5"> a common API that can</font><font color="#CCCCCC"> be</font>

1143
00:44:29,030 --> 00:44:33,050
implemented<font color="#E5E5E5"> essentially getting a</font>

1144
00:44:30,350 --> 00:44:34,690
cross-platform rat<font color="#E5E5E5"> in the browser be</font>

1145
00:44:33,050 --> 00:44:36,830
very useful<font color="#CCCCCC"> would be very interesting</font>

1146
00:44:34,690 --> 00:44:38,000
<font color="#E5E5E5">continued</font><font color="#CCCCCC"> in monitoring of this</font><font color="#E5E5E5"> this</font>

1147
00:44:36,830 --> 00:44:39,640
<font color="#E5E5E5">campaign still going we're still</font>

1148
00:44:38,000 --> 00:44:41,840
tracking and working with Google<font color="#E5E5E5"> on this</font>

1149
00:44:39,640 --> 00:44:43,370
<font color="#E5E5E5">it's kind of hard to get in the head of</font>

1150
00:44:41,840 --> 00:44:44,990
<font color="#E5E5E5">these guys they evolve like every</font>

1151
00:44:43,370 --> 00:44:46,910
<font color="#E5E5E5">adversary and so it takes a lot of</font>

1152
00:44:44,990 --> 00:44:49,189
clothes<font color="#CCCCCC"> for monitoring</font><font color="#E5E5E5"> as you find stuff</font>

1153
00:44:46,910 --> 00:44:51,680
set<font color="#CCCCCC"> up monitoring go look for</font><font color="#E5E5E5"> it see if</font>

1154
00:44:49,190 --> 00:44:53,240
they evolve see if they adapt it can be

1155
00:44:51,680 --> 00:44:54,890
really<font color="#E5E5E5"> useful both for</font><font color="#CCCCCC"> yourself and</font><font color="#E5E5E5"> an</font>

1156
00:44:53,240 --> 00:44:57,410
organization<font color="#E5E5E5"> but also as a research</font>

1157
00:44:54,890 --> 00:44:59,240
perspective<font color="#CCCCCC"> very interesting to see and</font>

1158
00:44:57,410 --> 00:45:00,440
then there's plenty of<font color="#E5E5E5"> work to do we</font>

1159
00:44:59,240 --> 00:45:03,020
found all sorts of malicious<font color="#CCCCCC"> stuff in</font>

1160
00:45:00,440 --> 00:45:04,730
the store<font color="#E5E5E5"> code execution methods</font><font color="#CCCCCC"> I'd be</font>

1161
00:45:03,020 --> 00:45:06,770
particularly interesting if we<font color="#E5E5E5"> can get</font>

1162
00:45:04,730 --> 00:45:09,440
more system code execution techniques or

1163
00:45:06,770 --> 00:45:11,150
easier ways going<font color="#E5E5E5"> beyond the browser how</font>

1164
00:45:09,440 --> 00:45:13,460
can I get from extension land into

1165
00:45:11,150 --> 00:45:16,580
system land<font color="#E5E5E5"> I'd</font><font color="#CCCCCC"> imagine there's probably</font>

1166
00:45:13,460 --> 00:45:18,440
tons<font color="#E5E5E5"> of ways</font><font color="#CCCCCC"> I'd never opened a debugger</font>

1167
00:45:16,580 --> 00:45:20,270
<font color="#CCCCCC">during any</font><font color="#E5E5E5"> of this like this was all</font>

1168
00:45:18,440 --> 00:45:22,190
<font color="#E5E5E5">very simple like surface level research</font>

1169
00:45:20,270 --> 00:45:23,570
<font color="#CCCCCC">I there could potentially be a ton of</font>

1170
00:45:22,190 --> 00:45:25,820
<font color="#E5E5E5">different</font><font color="#CCCCCC"> avenues</font><font color="#E5E5E5"> here that are looked</font>

1171
00:45:23,570 --> 00:45:27,230
at<font color="#CCCCCC"> because people</font><font color="#E5E5E5"> frankly aren't looking</font>

1172
00:45:25,820 --> 00:45:30,530
at Chrome extensions from<font color="#E5E5E5"> a pure</font>

1173
00:45:27,230 --> 00:45:32,180
security perspective<font color="#CCCCCC"> very often and then</font>

1174
00:45:30,530 --> 00:45:34,040
again continued bad guy tracking<font color="#E5E5E5"> acts</font>

1175
00:45:32,180 --> 00:45:35,330
like a double foot stomp like bad guys

1176
00:45:34,040 --> 00:45:38,200
are<font color="#E5E5E5"> there like we should keep watching</font>

1177
00:45:35,330 --> 00:45:41,720
them so<font color="#E5E5E5"> I have a little bit of time for</font>

1178
00:45:38,200 --> 00:45:44,230
<font color="#CCCCCC">questions if there's any in the room</font><font color="#E5E5E5"> one</font>

1179
00:45:41,720 --> 00:45:44,230
<font color="#E5E5E5">in</font><font color="#CCCCCC"> the back left</font>

1180
00:45:46,590 --> 00:45:58,120
yeah so the<font color="#E5E5E5"> question was he we mentioned</font>

1181
00:45:56,560 --> 00:46:01,660
that the other<font color="#E5E5E5"> browsers are adopting the</font>

1182
00:45:58,120 --> 00:46:03,720
web extension API is the<font color="#CCCCCC"> GPO</font><font color="#E5E5E5"> cross</font>

1183
00:46:01,660 --> 00:46:06,250
<font color="#E5E5E5">browser or is that just</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> Chrome</font>

1184
00:46:03,720 --> 00:46:08,560
<font color="#CCCCCC">pretty sure that's that's just</font><font color="#E5E5E5"> released</font>

1185
00:46:06,250 --> 00:46:12,070
<font color="#E5E5E5">by Google for for Chrome specifically</font>

1186
00:46:08,560 --> 00:46:14,410
<font color="#CCCCCC">Chrome</font><font color="#E5E5E5"> for enterprise</font><font color="#CCCCCC"> GPOs</font><font color="#E5E5E5"> I'm not sure</font>

1187
00:46:12,070 --> 00:46:17,160
if the other browsers have something

1188
00:46:14,410 --> 00:46:20,410
like<font color="#E5E5E5"> that I'm sure Microsoft might have</font>

1189
00:46:17,160 --> 00:46:22,629
stuff set<font color="#CCCCCC"> up for edge and stuff I'm not</font>

1190
00:46:20,410 --> 00:46:25,660
actually<font color="#CCCCCC"> sure you're yeah I have to</font>

1191
00:46:22,630 --> 00:46:27,910
verify<font color="#E5E5E5"> that but I don't know if anything</font>

1192
00:46:25,660 --> 00:46:32,279
that<font color="#CCCCCC"> mozilla is doing or any of the</font>

1193
00:46:27,910 --> 00:46:32,279
other major players in<font color="#E5E5E5"> the browser field</font>

1194
00:46:36,990 --> 00:46:40,569
the question was any difference in

1195
00:46:39,040 --> 00:46:43,720
behavior between<font color="#E5E5E5"> chrome user level and</font>

1196
00:46:40,570 --> 00:46:45,910
chrome enterprise<font color="#CCCCCC"> I didn't see any</font><font color="#E5E5E5"> yeah</font>

1197
00:46:43,720 --> 00:46:47,350
no I think<font color="#E5E5E5"> those pretty much operate the</font>

1198
00:46:45,910 --> 00:46:49,509
same like it's still the same browser

1199
00:46:47,350 --> 00:46:52,000
it's just it just<font color="#E5E5E5"> has certain class</font>

1200
00:46:49,510 --> 00:46:56,850
hooks<font color="#E5E5E5"> yeah kind of so that it allows you</font>

1201
00:46:52,000 --> 00:46:59,080
know your domain to<font color="#E5E5E5"> kind of mess with it</font>

1202
00:46:56,850 --> 00:47:00,819
more touch points for admins honestly I

1203
00:46:59,080 --> 00:47:07,200
<font color="#E5E5E5">think I really only thing we observed</font>

1204
00:47:00,820 --> 00:47:07,200
<font color="#CCCCCC">yeah-oh</font><font color="#E5E5E5"> middle</font>

1205
00:47:16,900 --> 00:47:20,750
so the question was<font color="#CCCCCC"> given the amount</font><font color="#E5E5E5"> of</font>

1206
00:47:19,220 --> 00:47:22,279
<font color="#E5E5E5">users and following these extensions is</font>

1207
00:47:20,750 --> 00:47:23,720
there any disclosure concerns as<font color="#CCCCCC"> far</font><font color="#E5E5E5"> as</font>

1208
00:47:22,280 --> 00:47:28,160
like releasing<font color="#E5E5E5"> what we discovered in</font>

1209
00:47:23,720 --> 00:47:30,859
terms here yeah absolutely I would<font color="#E5E5E5"> say</font>

1210
00:47:28,160 --> 00:47:32,060
absolutely<font color="#CCCCCC"> we we coordinated all this</font>

1211
00:47:30,860 --> 00:47:33,619
for<font color="#CCCCCC"> google we've been doing this for</font>

1212
00:47:32,060 --> 00:47:34,970
<font color="#CCCCCC">almost</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> year and a half now there's</font>

1213
00:47:33,619 --> 00:47:35,750
many of the ones that<font color="#E5E5E5"> we listed and</font>

1214
00:47:34,970 --> 00:47:39,529
showed here

1215
00:47:35,750 --> 00:47:41,510
<font color="#CCCCCC">weh-weh old I</font><font color="#E5E5E5"> personally feel there</font><font color="#CCCCCC"> are</font>

1216
00:47:39,530 --> 00:47:44,240
I mean you've got an affected user pool

1217
00:47:41,510 --> 00:47:46,070
that's very large<font color="#E5E5E5"> I think that I it</font>

1218
00:47:44,240 --> 00:47:47,359
would<font color="#E5E5E5"> be good due diligence</font><font color="#CCCCCC"> to share</font>

1219
00:47:46,070 --> 00:47:51,740
with you<font color="#E5E5E5"> go</font><font color="#CCCCCC"> to gonna take him down</font>

1220
00:47:47,360 --> 00:47:53,900
<font color="#CCCCCC">before releasing open research my</font><font color="#E5E5E5"> purely</font>

1221
00:47:51,740 --> 00:47:57,200
my opinion<font color="#E5E5E5"> as I stand wearing a gigabyte</font>

1222
00:47:53,900 --> 00:47:58,880
<font color="#CCCCCC">shirt but I think in</font><font color="#E5E5E5"> general I like to</font>

1223
00:47:57,200 --> 00:48:00,529
<font color="#CCCCCC">work with the vendors and solve the real</font>

1224
00:47:58,880 --> 00:48:02,570
problem<font color="#CCCCCC"> before going out</font><font color="#E5E5E5"> and sharing it</font>

1225
00:48:00,530 --> 00:48:05,180
right responsible disclosure and<font color="#E5E5E5"> all</font>

1226
00:48:02,570 --> 00:48:07,160
that we've worked<font color="#E5E5E5"> with Google and stuff</font>

1227
00:48:05,180 --> 00:48:08,990
<font color="#E5E5E5">before</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> release our blogs just to make</font>

1228
00:48:07,160 --> 00:48:10,069
sure<font color="#E5E5E5"> that everything's cool and</font><font color="#CCCCCC"> then</font>

1229
00:48:08,990 --> 00:48:13,189
we're like hey<font color="#E5E5E5"> look at this cool stuff</font>

1230
00:48:10,070 --> 00:48:14,510
<font color="#E5E5E5">we did I'd also add that we were we've</font>

1231
00:48:13,190 --> 00:48:15,890
taken a<font color="#E5E5E5"> step further and</font><font color="#CCCCCC"> we've like</font>

1232
00:48:14,510 --> 00:48:18,440
volunteered and tried<font color="#CCCCCC"> to work with</font><font color="#E5E5E5"> them</font>

1233
00:48:15,890 --> 00:48:21,140
<font color="#E5E5E5">to do more like general work like here's</font>

1234
00:48:18,440 --> 00:48:23,570
what we're<font color="#CCCCCC"> doing to discover</font><font color="#E5E5E5"> these and</font>

1235
00:48:21,140 --> 00:48:24,920
<font color="#E5E5E5">like here's our</font><font color="#CCCCCC"> yara</font><font color="#E5E5E5"> cigs and we're</font>

1236
00:48:23,570 --> 00:48:27,440
trying to encourage<font color="#CCCCCC"> them and help them</font>

1237
00:48:24,920 --> 00:48:29,150
<font color="#E5E5E5">along the path of finding generic things</font>

1238
00:48:27,440 --> 00:48:30,890
<font color="#CCCCCC">i mean they don't usually need</font><font color="#E5E5E5"> our help</font>

1239
00:48:29,150 --> 00:48:32,630
they're experts<font color="#E5E5E5"> on</font><font color="#CCCCCC"> google</font><font color="#E5E5E5"> but we'd like</font>

1240
00:48:30,890 --> 00:48:35,980
<font color="#E5E5E5">to offer it it's good like we've done</font>

1241
00:48:32,630 --> 00:48:35,980
the research<font color="#CCCCCC"> might as</font><font color="#E5E5E5"> well share</font>

1242
00:48:45,230 --> 00:48:48,420
the question was is<font color="#E5E5E5"> there any</font>

1243
00:48:47,040 --> 00:48:51,050
commonality between the domain

1244
00:48:48,420 --> 00:48:55,410
registration and hosting providers use

1245
00:48:51,050 --> 00:48:57,060
<font color="#E5E5E5">yes yes yeah</font><font color="#CCCCCC"> the domain registration I</font>

1246
00:48:55,410 --> 00:48:57,690
believe it was<font color="#E5E5E5"> all privacy protected my</font>

1247
00:48:57,060 --> 00:49:00,390
correct

1248
00:48:57,690 --> 00:49:02,400
yeah<font color="#E5E5E5"> but who is the same hosting</font>

1249
00:49:00,390 --> 00:49:05,580
provider same<font color="#CCCCCC"> ASN and it was all</font><font color="#E5E5E5"> in the</font>

1250
00:49:02,400 --> 00:49:07,140
<font color="#E5E5E5">same class</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> net</font><font color="#CCCCCC"> blocks alike we</font>

1251
00:49:05,580 --> 00:49:08,370
shared<font color="#E5E5E5"> these indicators on a blog if you</font>

1252
00:49:07,140 --> 00:49:11,100
want<font color="#CCCCCC"> to get like</font><font color="#E5E5E5"> you can go look at the</font>

1253
00:49:08,370 --> 00:49:12,480
<font color="#CCCCCC">class see net block it's it's</font><font color="#E5E5E5"> pretty</font>

1254
00:49:11,100 --> 00:49:14,220
prevalent there they actually<font color="#CCCCCC"> had an</font>

1255
00:49:12,480 --> 00:49:16,950
infrastructure that<font color="#CCCCCC"> was like up to</font><font color="#E5E5E5"> at</font>

1256
00:49:14,220 --> 00:49:18,359
one point<font color="#CCCCCC"> 30 or</font><font color="#E5E5E5"> 40 like c2 servers it's</font>

1257
00:49:16,950 --> 00:49:21,390
pretty massive infrastructure for a

1258
00:49:18,360 --> 00:49:23,430
single campaign in a Chrome extension<font color="#CCCCCC"> so</font>

1259
00:49:21,390 --> 00:49:24,750
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> kind of scale of operations like</font>

1260
00:49:23,430 --> 00:49:26,520
it makes<font color="#E5E5E5"> sense that they're doing this</font>

1261
00:49:24,750 --> 00:49:28,590
<font color="#E5E5E5">on a larger scale and</font><font color="#CCCCCC"> they're pretty</font>

1262
00:49:26,520 --> 00:49:29,880
<font color="#E5E5E5">much all there and we've we've done</font><font color="#CCCCCC"> all</font>

1263
00:49:28,590 --> 00:49:31,320
the notifications<font color="#E5E5E5"> all the different</font>

1264
00:49:29,880 --> 00:49:33,390
routes<font color="#E5E5E5"> you can notify people</font><font color="#CCCCCC"> about all</font>

1265
00:49:31,320 --> 00:49:36,650
<font color="#E5E5E5">these</font><font color="#CCCCCC"> things one thing missing</font><font color="#E5E5E5"> is</font>

1266
00:49:33,390 --> 00:49:39,330
actually all of<font color="#E5E5E5"> the c2 servers were</font>

1267
00:49:36,650 --> 00:49:42,120
their server<font color="#CCCCCC"> l which is like a hosting</font>

1268
00:49:39,330 --> 00:49:44,430
provider<font color="#CCCCCC"> so you know shared</font><font color="#E5E5E5"> hosting but</font>

1269
00:49:42,120 --> 00:49:46,080
they they do hosting and in various

1270
00:49:44,430 --> 00:49:48,149
locations<font color="#E5E5E5"> around the</font><font color="#CCCCCC"> world all the</font><font color="#E5E5E5"> c2</font>

1271
00:49:46,080 --> 00:49:51,299
was in the<font color="#E5E5E5"> Netherlands interesting</font>

1272
00:49:48,150 --> 00:49:53,250
<font color="#CCCCCC">enough I assume that's</font><font color="#E5E5E5"> because they</font>

1273
00:49:51,300 --> 00:49:57,300
thought that's a better<font color="#E5E5E5"> place to host</font>

1274
00:49:53,250 --> 00:50:00,960
things just legally<font color="#E5E5E5"> analytic assumption</font>

1275
00:49:57,300 --> 00:50:03,240
<font color="#E5E5E5">yeah yeah I mean no yeah default on the</font>

1276
00:50:00,960 --> 00:50:07,800
Netherlands<font color="#E5E5E5"> yeah we'll see I don't know</font>

1277
00:50:03,240 --> 00:50:09,000
but awesome<font color="#CCCCCC"> I think we'll wrap it</font><font color="#E5E5E5"> up and</font>

1278
00:50:07,800 --> 00:50:10,770
<font color="#E5E5E5">if you guys want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk and we'll be</font><font color="#CCCCCC"> in</font>

1279
00:50:09,000 --> 00:50:13,250
the back here around<font color="#E5E5E5"> the lobby</font><font color="#CCCCCC"> thank you</font>

1280
00:50:10,770 --> 00:50:13,250
<font color="#E5E5E5">guys for your</font><font color="#CCCCCC"> time</font>

