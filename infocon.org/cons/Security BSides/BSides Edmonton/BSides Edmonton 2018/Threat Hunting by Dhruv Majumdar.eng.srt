1
00:00:05,450 --> 00:00:11,309
thank you thank you so I'm gonna try

2
00:00:09,480 --> 00:00:13,099
going over the first ten slides real

3
00:00:11,309 --> 00:00:16,500
quick cause of the time constraints ah

4
00:00:13,099 --> 00:00:18,390
but to give a short overview I really

5
00:00:16,500 --> 00:00:21,330
like Jason's talk which was the passive

6
00:00:18,390 --> 00:00:23,789
and active Deanna active attacks I was

7
00:00:21,330 --> 00:00:25,759
kind of worried how much can I explain

8
00:00:23,789 --> 00:00:29,490
in the 45 minute that I got today and

9
00:00:25,759 --> 00:00:31,919
but that talk really paved the path I

10
00:00:29,490 --> 00:00:33,839
would say so try to keep that talk in

11
00:00:31,919 --> 00:00:35,730
mind while I go through my slides over

12
00:00:33,840 --> 00:00:37,350
here and I'm gonna try to fly through

13
00:00:35,730 --> 00:00:40,140
the first ten slides really quick cuz

14
00:00:37,350 --> 00:00:44,510
they're pretty much the 101 that why am

15
00:00:40,140 --> 00:00:47,700
I doing this talk so to get started my

16
00:00:44,510 --> 00:00:49,920
Who am I thread hunting basics recipe

17
00:00:47,700 --> 00:00:53,220
for what's needed to do a proper thread

18
00:00:49,920 --> 00:00:55,500
hunt a tack life cycle why we really

19
00:00:53,220 --> 00:00:57,210
like miter attack framework for people

20
00:00:55,500 --> 00:00:59,640
who do not know what might write that

21
00:00:57,210 --> 00:01:01,830
framework dive in start looking into it

22
00:00:59,640 --> 00:01:04,439
really good platforms to give you a

23
00:01:01,830 --> 00:01:05,908
start of what vectors you need and how

24
00:01:04,438 --> 00:01:08,880
you can attack those vectors if you are

25
00:01:05,909 --> 00:01:12,210
looking for those after that there is a

26
00:01:08,880 --> 00:01:14,609
small attack scenario that I made it in

27
00:01:12,210 --> 00:01:16,408
such a way that I can talk to people who

28
00:01:14,609 --> 00:01:17,939
are getting into the security and also

29
00:01:16,409 --> 00:01:18,929
it's kind of an easy walk through for

30
00:01:17,939 --> 00:01:22,529
people who have been in the security

31
00:01:18,929 --> 00:01:24,090
industry and doing what we try to preach

32
00:01:22,530 --> 00:01:26,969
that this is the right way of doing it

33
00:01:24,090 --> 00:01:28,679
there is no really right way and then

34
00:01:26,969 --> 00:01:31,109
it's just trying to see whose

35
00:01:28,679 --> 00:01:34,679
probability is better to detect that

36
00:01:31,109 --> 00:01:36,298
something is happening currently I work

37
00:01:34,679 --> 00:01:39,119
for individual proms I'm out of the

38
00:01:36,299 --> 00:01:41,429
Toronto office and I actually managed

39
00:01:39,119 --> 00:01:43,829
their security platform of threat

40
00:01:41,429 --> 00:01:45,780
detection and response I had a good luck

41
00:01:43,829 --> 00:01:47,999
of getting started in my career I was

42
00:01:45,780 --> 00:01:50,490
working with in bridge moved with Splunk

43
00:01:47,999 --> 00:01:51,899
all the structure on the security cause

44
00:01:50,490 --> 00:01:54,089
that's something I just got stuck I

45
00:01:51,899 --> 00:01:56,460
don't really know how and why but that's

46
00:01:54,090 --> 00:01:58,770
something I'll just love doing what from

47
00:01:56,460 --> 00:02:01,288
that as for hobbies goes I love doing

48
00:01:58,770 --> 00:02:03,658
photography drones and play a little bit

49
00:02:01,289 --> 00:02:05,819
of guitar and piano sometimes I leverage

50
00:02:03,659 --> 00:02:08,600
my drone to do recon activity as well so

51
00:02:05,819 --> 00:02:11,630
you guys get my drift

52
00:02:08,600 --> 00:02:14,250
so before I get started I just wanted to

53
00:02:11,630 --> 00:02:15,930
get in and say what do we actually

54
00:02:14,250 --> 00:02:18,630
understand by Twitter hunting and the

55
00:02:15,930 --> 00:02:20,730
reason I named my presentation not just

56
00:02:18,630 --> 00:02:23,130
for hunting and added that extra word

57
00:02:20,730 --> 00:02:24,600
called practical the reason being a lot

58
00:02:23,130 --> 00:02:27,000
of the people a lot of the talks I have

59
00:02:24,600 --> 00:02:29,310
been to or attended I've seen people

60
00:02:27,000 --> 00:02:31,830
giving talks about Twitter hunting and

61
00:02:29,310 --> 00:02:34,770
what needs to be done and usually they

62
00:02:31,830 --> 00:02:37,620
tend out to be something of a strategy a

63
00:02:34,770 --> 00:02:40,290
lot of the times we miss out why are we

64
00:02:37,620 --> 00:02:42,300
talking about hunting what's the benefit

65
00:02:40,290 --> 00:02:45,060
of using this can I start doing this as

66
00:02:42,300 --> 00:02:47,790
of today in my house and then can I do

67
00:02:45,060 --> 00:02:49,320
it for let's say a packet size or an

68
00:02:47,790 --> 00:02:52,170
environment that's about three terabytes

69
00:02:49,320 --> 00:02:54,180
a day all right and the answer is yes

70
00:02:52,170 --> 00:02:56,519
it's possible you can do it for more

71
00:02:54,180 --> 00:02:58,800
than three terabyte a day and just by

72
00:02:56,520 --> 00:03:00,090
using open source tools and if you are a

73
00:02:58,800 --> 00:03:01,670
good programmer you can just run the

74
00:03:00,090 --> 00:03:05,250
whole show yourself

75
00:03:01,670 --> 00:03:07,290
so as the definition goes proactively

76
00:03:05,250 --> 00:03:08,700
and iteratively looking or searching

77
00:03:07,290 --> 00:03:11,220
through environment to detect and

78
00:03:08,700 --> 00:03:13,829
isolate threats that evade the existing

79
00:03:11,220 --> 00:03:15,660
security solution I really like this

80
00:03:13,830 --> 00:03:17,400
definition not going to go into who

81
00:03:15,660 --> 00:03:19,410
actually first told the definition and

82
00:03:17,400 --> 00:03:22,440
stuff like that but what this actually

83
00:03:19,410 --> 00:03:24,870
shows is that we have been using AVS or

84
00:03:22,440 --> 00:03:27,120
some kind of protection mechanism or

85
00:03:24,870 --> 00:03:30,720
solutions or products or appliances in

86
00:03:27,120 --> 00:03:33,450
our company nor how's friends please

87
00:03:30,720 --> 00:03:35,010
name it but you still get attacked

88
00:03:33,450 --> 00:03:37,769
you still get breached you still get

89
00:03:35,010 --> 00:03:40,590
into trouble or you still don't have and

90
00:03:37,770 --> 00:03:43,680
an entire eyesight of what's going on in

91
00:03:40,590 --> 00:03:45,720
your network so it's not that the

92
00:03:43,680 --> 00:03:48,000
traditional sock is not doing their job

93
00:03:45,720 --> 00:03:50,430
correctly what I feel like is there is a

94
00:03:48,000 --> 00:03:52,530
missing gap that's where threat hunting

95
00:03:50,430 --> 00:03:55,590
or trade hunters comes in is try to

96
00:03:52,530 --> 00:03:57,660
breach the gap the problem with the sock

97
00:03:55,590 --> 00:04:01,260
or the or the problem that I personally

98
00:03:57,660 --> 00:04:03,870
fuel that is traditional sock is it's

99
00:04:01,260 --> 00:04:06,359
always proactive it's it's not really

100
00:04:03,870 --> 00:04:09,120
proactive as far as threat hunting comes

101
00:04:06,360 --> 00:04:12,000
but it's proactive in the nature it's

102
00:04:09,120 --> 00:04:15,030
always driven by a product or a vendor

103
00:04:12,000 --> 00:04:17,310
or what's being taught to you it's not

104
00:04:15,030 --> 00:04:20,220
what's needed or what needs to be done

105
00:04:17,310 --> 00:04:21,488
so that's why I tunnel out that kind of

106
00:04:20,220 --> 00:04:23,410
line that out is that it's

107
00:04:21,488 --> 00:04:25,539
basically signature-based most of the

108
00:04:23,410 --> 00:04:27,819
time and it's alert driven so what ends

109
00:04:25,539 --> 00:04:31,599
up happening is the actual stock

110
00:04:27,819 --> 00:04:33,810
analysts their job becomes a rather you

111
00:04:31,599 --> 00:04:36,880
know reactive job than being proactive

112
00:04:33,810 --> 00:04:38,199
the concept and the mindset mindset kind

113
00:04:36,880 --> 00:04:41,319
of changes when you start thinking about

114
00:04:38,199 --> 00:04:42,940
threat hunting that's because as a

115
00:04:41,319 --> 00:04:47,560
threat hunter I think the first thing

116
00:04:42,940 --> 00:04:49,300
that we preach is you need to understand

117
00:04:47,560 --> 00:04:51,069
that there's always gonna be an hacker

118
00:04:49,300 --> 00:04:53,110
they're always gonna be a breach there's

119
00:04:51,069 --> 00:04:55,930
always going to be some kind of things

120
00:04:53,110 --> 00:04:57,490
that you did not thought of the hacker

121
00:04:55,930 --> 00:05:00,729
just needs enough motivation and

122
00:04:57,490 --> 00:05:02,169
probably money and other reasons but

123
00:05:00,729 --> 00:05:05,229
it's always possible it's always going

124
00:05:02,169 --> 00:05:08,409
to happen your part is how can you

125
00:05:05,229 --> 00:05:10,360
contain that after it has happened so as

126
00:05:08,410 --> 00:05:14,229
a threat hunter your job is to find

127
00:05:10,360 --> 00:05:18,250
things that stands out sticks out and is

128
00:05:14,229 --> 00:05:20,258
not normal so thus bringing on it's a

129
00:05:18,250 --> 00:05:22,180
team effort that's that's why I kind of

130
00:05:20,259 --> 00:05:24,370
have this light over here it's a team

131
00:05:22,180 --> 00:05:26,349
effort where you need people who come

132
00:05:24,370 --> 00:05:29,409
from different mindset different

133
00:05:26,349 --> 00:05:32,440
experience and has walked the different

134
00:05:29,409 --> 00:05:34,300
paths in the library when I talk about

135
00:05:32,440 --> 00:05:35,650
red team's over here these are not but

136
00:05:34,300 --> 00:05:37,840
I'm not talking about pen testers and

137
00:05:35,650 --> 00:05:41,198
talking about actual people who notes to

138
00:05:37,840 --> 00:05:44,080
infiltrate do a proper infrastructure or

139
00:05:41,199 --> 00:05:46,270
ot Red Team engagement it's not a

140
00:05:44,080 --> 00:05:47,979
scanner I'm not looking for scanners or

141
00:05:46,270 --> 00:05:49,780
people who can just run a button and say

142
00:05:47,979 --> 00:05:51,639
yeah I did a pen test this is the

143
00:05:49,780 --> 00:05:53,049
vulnerability that's not untaught that's

144
00:05:51,639 --> 00:05:55,150
not what I'm talking about

145
00:05:53,050 --> 00:05:57,969
people who knows and can strategize how

146
00:05:55,150 --> 00:05:59,650
you can infiltrate a company how you can

147
00:05:57,969 --> 00:06:02,740
go to our objective with the least

148
00:05:59,650 --> 00:06:04,090
amount of noise possible if the company

149
00:06:02,740 --> 00:06:05,650
is really well protected how can you go

150
00:06:04,090 --> 00:06:07,000
against the CISOs and DPS and find

151
00:06:05,650 --> 00:06:11,258
enough details to go in from some other

152
00:06:07,000 --> 00:06:12,699
areas so the strategy mentality is very

153
00:06:11,259 --> 00:06:17,560
important

154
00:06:12,699 --> 00:06:19,719
apart from that differ digital forensics

155
00:06:17,560 --> 00:06:22,030
and Incident Response this skill is very

156
00:06:19,719 --> 00:06:24,669
needed when you are analyzing host-based

157
00:06:22,030 --> 00:06:26,320
data or network based data as I come on

158
00:06:24,669 --> 00:06:29,799
the next few slides you will see why

159
00:06:26,320 --> 00:06:31,810
they become more important the blue team

160
00:06:29,800 --> 00:06:34,540
over here which I talked about is also

161
00:06:31,810 --> 00:06:36,460
not the regular stock that we

162
00:06:34,540 --> 00:06:37,870
that I have seen or we have come across

163
00:06:36,460 --> 00:06:39,940
which is there is an alert that

164
00:06:37,870 --> 00:06:42,310
triggered Oh take a look as to what's

165
00:06:39,940 --> 00:06:45,100
going on right the blue team that I

166
00:06:42,310 --> 00:06:46,990
talked about here is people who have the

167
00:06:45,100 --> 00:06:49,780
capability and experience to look

168
00:06:46,990 --> 00:06:52,240
through data's and can figure out that

169
00:06:49,780 --> 00:06:53,770
this is not normal and when I talk about

170
00:06:52,240 --> 00:06:56,470
not normal I'll come back to that later

171
00:06:53,770 --> 00:06:58,240
on the normal for every client that you

172
00:06:56,470 --> 00:07:02,410
have or every company you work for will

173
00:06:58,240 --> 00:07:03,940
change based on what kind of mechanisms

174
00:07:02,410 --> 00:07:06,370
they are using what kind of procedures

175
00:07:03,940 --> 00:07:08,640
they're using what kind of Tolerance

176
00:07:06,370 --> 00:07:10,570
they're using and what kind of

177
00:07:08,640 --> 00:07:13,050
appliances they're using in the network

178
00:07:10,570 --> 00:07:16,810
a very basic example can be is your

179
00:07:13,050 --> 00:07:18,730
company blocking against ads I'll come

180
00:07:16,810 --> 00:07:21,610
back to that Todd later in the slides

181
00:07:18,730 --> 00:07:23,410
again threat in tow is very important

182
00:07:21,610 --> 00:07:25,720
and plays a really really crucial part

183
00:07:23,410 --> 00:07:27,310
in the entire engagement because if you

184
00:07:25,720 --> 00:07:31,030
don't know what to look for

185
00:07:27,310 --> 00:07:34,300
you're not looking for anything thus it

186
00:07:31,030 --> 00:07:37,119
can be a threat hunting team or what I

187
00:07:34,300 --> 00:07:39,340
like to say is everyone in this room at

188
00:07:37,120 --> 00:07:42,310
some point needs to understand all this

189
00:07:39,340 --> 00:07:44,530
fueled really good and then you become a

190
00:07:42,310 --> 00:07:46,540
threat hunters we are really looking for

191
00:07:44,530 --> 00:07:48,580
people who can do threat hunting all by

192
00:07:46,540 --> 00:07:53,650
themselves and do the entire team's job

193
00:07:48,580 --> 00:07:57,580
it's not easy but it's doable so before

194
00:07:53,650 --> 00:07:59,890
I go into more scenarios what do we

195
00:07:57,580 --> 00:08:01,300
understand and how do we leverage the

196
00:07:59,890 --> 00:08:02,530
threat hunters like yeah now we have

197
00:08:01,300 --> 00:08:04,990
hired a bunch of three hundreds they're

198
00:08:02,530 --> 00:08:06,849
really good if you are not collecting

199
00:08:04,990 --> 00:08:08,710
the right logs you are not looking for

200
00:08:06,850 --> 00:08:11,740
the right things that entire process

201
00:08:08,710 --> 00:08:14,590
just is as good as you know for pouring

202
00:08:11,740 --> 00:08:17,020
it down the drain so the logs that you

203
00:08:14,590 --> 00:08:19,900
really want to look at is bro snort

204
00:08:17,020 --> 00:08:22,060
mohawk proxy logs just kind of curious

205
00:08:19,900 --> 00:08:24,789
how many people here can share the data

206
00:08:22,060 --> 00:08:27,970
on that is your company is probably

207
00:08:24,790 --> 00:08:30,330
doing web proxy just raise your hands if

208
00:08:27,970 --> 00:08:34,630
you are allowed to if not that's fine

209
00:08:30,330 --> 00:08:37,090
but to intercept HTTP traffic web proxy

210
00:08:34,630 --> 00:08:39,400
logs really important right these logs

211
00:08:37,090 --> 00:08:41,680
play a very vital role as to what's

212
00:08:39,400 --> 00:08:44,350
needed we were talking about phishing

213
00:08:41,679 --> 00:08:46,479
right phishing if you are not taking

214
00:08:44,350 --> 00:08:48,190
care or you're not ingesting your mail

215
00:08:46,480 --> 00:08:49,829
server logs

216
00:08:48,190 --> 00:08:52,329
don't really know what you're looking at

217
00:08:49,829 --> 00:08:53,649
yeah you can probably plug in a device

218
00:08:52,329 --> 00:08:55,149
and that's gonna work based on

219
00:08:53,649 --> 00:08:58,449
signatures if something already happened

220
00:08:55,149 --> 00:08:59,920
but usually with bigger clients if the

221
00:08:58,449 --> 00:09:01,389
attacker is really motivated they're not

222
00:08:59,920 --> 00:09:03,399
going to use anything that already has a

223
00:09:01,389 --> 00:09:05,470
stone signature it's going to either use

224
00:09:03,399 --> 00:09:08,170
something that's polymorphed or that's

225
00:09:05,470 --> 00:09:12,339
not out in the market or it's not out

226
00:09:08,170 --> 00:09:14,439
for script kiddies as I called it for

227
00:09:12,339 --> 00:09:17,110
whose data there is a tons of data a lot

228
00:09:14,440 --> 00:09:19,509
of work has been happening Windows Event

229
00:09:17,110 --> 00:09:21,190
log system on all of the new system and

230
00:09:19,509 --> 00:09:22,569
I don't know how many here have been

231
00:09:21,190 --> 00:09:29,550
playing with this one that the new ones

232
00:09:22,569 --> 00:09:32,110
it's just amazing right no one okay but

233
00:09:29,550 --> 00:09:34,329
start looking into system on it's really

234
00:09:32,110 --> 00:09:35,649
amazing it literally works with The

235
00:09:34,329 --> 00:09:37,540
MITRE framework you can literally

236
00:09:35,649 --> 00:09:40,540
categorize where what's happening and

237
00:09:37,540 --> 00:09:43,349
how it happened Google Rapid Response

238
00:09:40,540 --> 00:09:45,849
another great tool at monitor your hosts

239
00:09:43,350 --> 00:09:47,470
for Linux based right what you do with

240
00:09:45,850 --> 00:09:48,670
Linux well there is no security I

241
00:09:47,470 --> 00:09:50,920
haven't mentioned that name over here

242
00:09:48,670 --> 00:09:53,889
but there's no security as well as osek

243
00:09:50,920 --> 00:09:55,449
and audit d turn those on you have

244
00:09:53,889 --> 00:09:58,630
enough data to look into your Linux

245
00:09:55,449 --> 00:10:00,579
boxes a lot of the times host bit

246
00:09:58,630 --> 00:10:03,790
detection gets real tough when it's

247
00:10:00,579 --> 00:10:05,258
talking about SCADA Network cause of all

248
00:10:03,790 --> 00:10:07,360
the horror stories probably a lot of

249
00:10:05,259 --> 00:10:09,699
people you know you turn on system on

250
00:10:07,360 --> 00:10:11,050
you might get a blue screen you turn on

251
00:10:09,699 --> 00:10:13,149
something else you might get something

252
00:10:11,050 --> 00:10:15,790
else it doesn't work the CPU utilization

253
00:10:13,149 --> 00:10:20,350
just increases and people don't like it

254
00:10:15,790 --> 00:10:22,649
right that's where bro comes in bro

255
00:10:20,350 --> 00:10:25,060
please look it up I would really

256
00:10:22,649 --> 00:10:27,790
encourage people to start looking into

257
00:10:25,060 --> 00:10:30,219
bro it's a framework dedicated to do

258
00:10:27,790 --> 00:10:32,829
network analysis it's an analytic

259
00:10:30,220 --> 00:10:34,930
platform once you understand bro data I

260
00:10:32,829 --> 00:10:38,349
think you are already halfway to

261
00:10:34,930 --> 00:10:40,719
becoming a 300 it literally has parsers

262
00:10:38,350 --> 00:10:42,910
to do a lot of protocol parsing and

263
00:10:40,720 --> 00:10:45,009
actually looking into what needs to be

264
00:10:42,910 --> 00:10:48,120
looked at and when you talk about having

265
00:10:45,009 --> 00:10:51,970
complete monitoring of your environment

266
00:10:48,120 --> 00:10:55,180
bro Moloch snort surah Cara are your

267
00:10:51,970 --> 00:10:58,300
best friends moving on to the next slide

268
00:10:55,180 --> 00:11:00,769
over here the actual skills that I like

269
00:10:58,300 --> 00:11:02,779
to leverage out of my team

270
00:11:00,769 --> 00:11:05,329
first if people who have worked with

271
00:11:02,779 --> 00:11:07,759
hosts datas and maybe working incident

272
00:11:05,329 --> 00:11:10,159
response the knowledge that they bring

273
00:11:07,759 --> 00:11:11,989
onto the table is how do I detect there

274
00:11:10,159 --> 00:11:14,539
is a persistence mechanism going on a

275
00:11:11,989 --> 00:11:17,059
code has been executed in a box or

276
00:11:14,539 --> 00:11:19,669
privilege escalations happening or some

277
00:11:17,059 --> 00:11:22,218
kind of an exploit right as far as

278
00:11:19,669 --> 00:11:25,009
network analysis goes on lateral

279
00:11:22,219 --> 00:11:26,989
movements c2 command and control beacon

280
00:11:25,009 --> 00:11:28,839
pattern analysis and payload deliveries

281
00:11:26,989 --> 00:11:31,219
and different stages of payloads

282
00:11:28,839 --> 00:11:33,379
nowadays a newer malware they tend to

283
00:11:31,219 --> 00:11:35,239
like to use not just one payload

284
00:11:33,379 --> 00:11:38,449
mechanism usually there is two or three

285
00:11:35,239 --> 00:11:40,009
and they change I'll talk about I'll

286
00:11:38,449 --> 00:11:41,868
talk about the beacon pattern in one of

287
00:11:40,009 --> 00:11:47,329
my slides just to give you guys a cool

288
00:11:41,869 --> 00:11:48,619
cool picture as well as it shows what

289
00:11:47,329 --> 00:11:50,628
you can achieve when you are looking at

290
00:11:48,619 --> 00:11:53,869
flow data the the same talk passive and

291
00:11:50,629 --> 00:11:58,279
active monitoring great talk by the way

292
00:11:53,869 --> 00:12:00,319
by Jason so I'll show you how to do

293
00:11:58,279 --> 00:12:02,989
beacon pattern analysis and how it helps

294
00:12:00,319 --> 00:12:05,899
you in your day-to-day job threat

295
00:12:02,989 --> 00:12:07,639
intelligence sticks and taxi these are

296
00:12:05,899 --> 00:12:09,079
the two names that will pop up every

297
00:12:07,639 --> 00:12:11,029
time we talk about ready intelligence or

298
00:12:09,079 --> 00:12:12,589
threat gathering sticks gives the

299
00:12:11,029 --> 00:12:15,559
structure as to what your data needs to

300
00:12:12,589 --> 00:12:17,869
look like taxi is the way you transfer

301
00:12:15,559 --> 00:12:20,569
peer-to-peer that data that you are now

302
00:12:17,869 --> 00:12:23,329
generating a lot of the data there is a

303
00:12:20,569 --> 00:12:24,769
project called stats look it up it's an

304
00:12:23,329 --> 00:12:26,089
open source project you can have it

305
00:12:24,769 --> 00:12:27,859
running in your home lab environment

306
00:12:26,089 --> 00:12:30,679
just to see how the data actually looks

307
00:12:27,859 --> 00:12:32,539
like and how it can be leveraged active

308
00:12:30,679 --> 00:12:35,738
defense and OSINT I'm gonna mix them

309
00:12:32,539 --> 00:12:38,869
together for different reasons but

310
00:12:35,739 --> 00:12:42,199
active defense a really good way of

311
00:12:38,869 --> 00:12:44,299
doing that is having honey pots that sit

312
00:12:42,199 --> 00:12:46,248
in your environment and in strategic

313
00:12:44,299 --> 00:12:48,079
locations which only your security team

314
00:12:46,249 --> 00:12:49,879
is supposed to have access to anyone

315
00:12:48,079 --> 00:12:51,228
else having access to that box our

316
00:12:49,879 --> 00:12:53,089
trigger pops up because they're not

317
00:12:51,229 --> 00:12:54,709
supposed to know about this they're not

318
00:12:53,089 --> 00:12:56,539
supposed to interact with this box

319
00:12:54,709 --> 00:12:58,968
something's happening means you need to

320
00:12:56,539 --> 00:13:01,309
look into it I would advice for people

321
00:12:58,969 --> 00:13:04,099
looking into honey pots and something

322
00:13:01,309 --> 00:13:06,379
that needs to be aware of with this

323
00:13:04,099 --> 00:13:09,229
crowd is a lot of the honey pots are

324
00:13:06,379 --> 00:13:11,839
there online and they're like one-click

325
00:13:09,229 --> 00:13:14,430
deployment look into Imogen servers

326
00:13:11,839 --> 00:13:16,290
really good tools for learning per

327
00:13:14,430 --> 00:13:19,050
not a great tool for actually doing

328
00:13:16,290 --> 00:13:21,750
something on your environment because if

329
00:13:19,050 --> 00:13:23,760
I was a hacker I have the same resources

330
00:13:21,750 --> 00:13:25,890
I can now fingerprint all these

331
00:13:23,760 --> 00:13:27,390
open-source honey pots and it's only

332
00:13:25,890 --> 00:13:28,470
gonna take me a second before knowing

333
00:13:27,390 --> 00:13:28,830
it's a honeypot and I'm not gonna touch

334
00:13:28,470 --> 00:13:31,110
it

335
00:13:28,830 --> 00:13:34,980
so itself actually no use try custom

336
00:13:31,110 --> 00:13:39,780
making your own honey pots OSINT like

337
00:13:34,980 --> 00:13:42,410
OSINT covers a huge field really some

338
00:13:39,780 --> 00:13:45,920
good examples I can craft right now is

339
00:13:42,410 --> 00:13:48,390
if you are working for a company or you

340
00:13:45,920 --> 00:13:50,520
monitor a whole lot of companies and you

341
00:13:48,390 --> 00:13:51,750
are responsible for threading tool when

342
00:13:50,520 --> 00:13:53,730
I talk about threading - I'm talking

343
00:13:51,750 --> 00:13:55,950
about tactical threading tool not the

344
00:13:53,730 --> 00:13:58,530
general threading toe so when it comes

345
00:13:55,950 --> 00:14:00,930
to tactical threat intelligence what

346
00:13:58,530 --> 00:14:03,120
really matters is how much are you

347
00:14:00,930 --> 00:14:06,599
exposed to public by public I mean

348
00:14:03,120 --> 00:14:09,450
people who really wants to attack you so

349
00:14:06,600 --> 00:14:11,940
Osen covers that face now you have

350
00:14:09,450 --> 00:14:14,100
showdown you have census i/o and you

351
00:14:11,940 --> 00:14:16,620
have a whole whack of darknet tools that

352
00:14:14,100 --> 00:14:19,050
you can use but end of the day what you

353
00:14:16,620 --> 00:14:21,330
guys need to understand is yes they are

354
00:14:19,050 --> 00:14:25,130
there you need to harness this knowledge

355
00:14:21,330 --> 00:14:28,440
so dust comes to coding scripting

356
00:14:25,130 --> 00:14:32,760
scraping pasting data scraping dumpster

357
00:14:28,440 --> 00:14:35,550
data using census and shodhan to know

358
00:14:32,760 --> 00:14:37,170
whoa this IP or this port was not open

359
00:14:35,550 --> 00:14:39,000
for my company two days back now it's

360
00:14:37,170 --> 00:14:41,339
open what's going on needs to

361
00:14:39,000 --> 00:14:43,230
investigate right so and you get an

362
00:14:41,340 --> 00:14:45,330
alert literally because it's not manual

363
00:14:43,230 --> 00:14:48,630
it's not possible automation comes in

364
00:14:45,330 --> 00:14:51,180
after the people know what to look for

365
00:14:48,630 --> 00:14:53,310
oh sink also covers a lot of other fuels

366
00:14:51,180 --> 00:14:55,199
that I like to talk about especially

367
00:14:53,310 --> 00:14:58,319
from a threat intelligence background is

368
00:14:55,200 --> 00:14:59,370
a lot of the times company call and say

369
00:14:58,320 --> 00:15:02,880
you know we want to get a threat

370
00:14:59,370 --> 00:15:04,440
intelligence work done but you can

371
00:15:02,880 --> 00:15:06,060
actually do this yourself very easily

372
00:15:04,440 --> 00:15:07,800
with your soft team you don't need too

373
00:15:06,060 --> 00:15:10,319
many people one person can do this job

374
00:15:07,800 --> 00:15:13,530
which is and it's a question how many

375
00:15:10,320 --> 00:15:15,960
people in this hall actually scrapes for

376
00:15:13,530 --> 00:15:17,699
dumpster-dives and they know that their

377
00:15:15,960 --> 00:15:21,630
passwords has been pawned from different

378
00:15:17,700 --> 00:15:24,480
sources right very few I would think but

379
00:15:21,630 --> 00:15:26,460
it is possible you can always automate

380
00:15:24,480 --> 00:15:27,970
and script for every time there's a user

381
00:15:26,460 --> 00:15:29,589
name password breach that half

382
00:15:27,970 --> 00:15:31,720
let's hit a LinkedIn let's say Adobe

383
00:15:29,589 --> 00:15:35,470
those goes to a dumpster

384
00:15:31,720 --> 00:15:36,910
hackers love spring data around or

385
00:15:35,470 --> 00:15:39,279
sharing the information around in their

386
00:15:36,910 --> 00:15:41,529
own circle turns out to be either some

387
00:15:39,279 --> 00:15:43,449
form of a pastebin encoded form or a

388
00:15:41,529 --> 00:15:46,149
dumpster guy or some of the forums or in

389
00:15:43,449 --> 00:15:48,699
the dark web scrape these things and now

390
00:15:46,149 --> 00:15:51,279
you have a database of all these

391
00:15:48,699 --> 00:15:53,439
information stored them wherever you

392
00:15:51,279 --> 00:15:55,870
want figure out what will you need how

393
00:15:53,439 --> 00:15:57,849
much resource you need and start from

394
00:15:55,870 --> 00:16:00,790
just using MongoDB right like that's

395
00:15:57,850 --> 00:16:02,769
probably 101 on storing data and looking

396
00:16:00,790 --> 00:16:06,040
into it and once you feel okay now I

397
00:16:02,769 --> 00:16:08,139
need to do this on a really high

398
00:16:06,040 --> 00:16:11,230
performance and there is time is very

399
00:16:08,139 --> 00:16:13,089
crucial you move on to Apache spark you

400
00:16:11,230 --> 00:16:15,670
move on to a Hadoop cluster you move on

401
00:16:13,089 --> 00:16:19,120
to L stack you move on to Splunk choose

402
00:16:15,670 --> 00:16:26,560
your poison but these are very important

403
00:16:19,120 --> 00:16:29,290
boy okay yeah so I want to talk about

404
00:16:26,560 --> 00:16:31,869
attack lifecycle and this is a

405
00:16:29,290 --> 00:16:33,670
mix-and-match from a lot of good attack

406
00:16:31,870 --> 00:16:35,019
life cycles that have been already been

407
00:16:33,670 --> 00:16:37,509
talked about by Lockheed Martin and

408
00:16:35,019 --> 00:16:39,100
different other companies but what I

409
00:16:37,509 --> 00:16:40,899
want to show here is that the attack

410
00:16:39,100 --> 00:16:43,329
framework and if you are a threat hunter

411
00:16:40,899 --> 00:16:46,540
how your lifecycle needs to align up

412
00:16:43,329 --> 00:16:48,579
with the red teamers so let's say the

413
00:16:46,540 --> 00:16:50,649
attack starts from our recon usually

414
00:16:48,579 --> 00:16:53,050
passive active and then it becomes a

415
00:16:50,649 --> 00:16:55,300
delivery mechanism exploits installation

416
00:16:53,050 --> 00:16:57,160
c2 privilege escalation lateral movement

417
00:16:55,300 --> 00:16:58,469
that's already not a good sign in your

418
00:16:57,160 --> 00:17:00,430
environment if you're seeing that

419
00:16:58,470 --> 00:17:04,419
objective right whatever the objective

420
00:17:00,430 --> 00:17:07,260
be as a threat hunting guy or from a

421
00:17:04,419 --> 00:17:11,319
background of threat hunting your

422
00:17:07,260 --> 00:17:13,569
priority is or we I like to say it we

423
00:17:11,319 --> 00:17:15,369
start the morning off by saying there is

424
00:17:13,569 --> 00:17:16,869
already a breach let's find out if we

425
00:17:15,369 --> 00:17:18,908
can catch the breach and close it as

426
00:17:16,869 --> 00:17:21,698
soon as it can it as soon as it's

427
00:17:18,909 --> 00:17:23,470
possible right so we come from a mindset

428
00:17:21,699 --> 00:17:26,079
that we do not think that Oh

429
00:17:23,470 --> 00:17:27,789
everything's all awesome it's sunny all

430
00:17:26,079 --> 00:17:29,830
the time right we come from a mindset

431
00:17:27,789 --> 00:17:33,429
where we think there is already a breach

432
00:17:29,830 --> 00:17:36,158
let's contain that so from a defensive

433
00:17:33,429 --> 00:17:38,140
perspective your start off ground is as

434
00:17:36,159 --> 00:17:40,659
similar to the same red teamer who's

435
00:17:38,140 --> 00:17:41,560
doing the work your work is to scrape

436
00:17:40,659 --> 00:17:44,350
all the data

437
00:17:41,560 --> 00:17:45,879
possibly visible somewhere in the world

438
00:17:44,350 --> 00:17:48,219
if it's available to the hackers it's

439
00:17:45,880 --> 00:17:50,500
better be available to you and your

440
00:17:48,220 --> 00:17:53,080
company right and then take actions

441
00:17:50,500 --> 00:17:55,800
against those and these are all Priority

442
00:17:53,080 --> 00:17:59,590
One if you and these are literally I

443
00:17:55,800 --> 00:18:01,629
like to skip all the the cool stuff that

444
00:17:59,590 --> 00:18:02,860
companies make like the SaaS and working

445
00:18:01,630 --> 00:18:04,990
with different teams and this and that

446
00:18:02,860 --> 00:18:07,270
when you see an issue pick up the phone

447
00:18:04,990 --> 00:18:11,080
no your guy whom to call get the work

448
00:18:07,270 --> 00:18:13,240
done that's priority second is analysis

449
00:18:11,080 --> 00:18:15,340
like you analyze if it back to the whole

450
00:18:13,240 --> 00:18:17,530
priority and SLA is right you analyze if

451
00:18:15,340 --> 00:18:19,000
this is priority one two three can take

452
00:18:17,530 --> 00:18:21,129
up to a month can take up to a week to

453
00:18:19,000 --> 00:18:23,350
get this sorted out but that's your

454
00:18:21,130 --> 00:18:26,410
decision or your team's decision to make

455
00:18:23,350 --> 00:18:28,780
this judgment call and get it fixed if

456
00:18:26,410 --> 00:18:30,610
they don't if they don't work on it

457
00:18:28,780 --> 00:18:32,740
demonstrate what a red teamer will do

458
00:18:30,610 --> 00:18:37,240
that's why you need red teamers in your

459
00:18:32,740 --> 00:18:40,330
team repeat not pen testers triage the

460
00:18:37,240 --> 00:18:44,320
problem investigate and contain your

461
00:18:40,330 --> 00:18:46,090
your main interest is to contain when

462
00:18:44,320 --> 00:18:48,070
and when there is a breach happening you

463
00:18:46,090 --> 00:18:50,620
know there's a breach happening can I

464
00:18:48,070 --> 00:18:53,169
contain that or can I already put a

465
00:18:50,620 --> 00:18:54,909
sandbox around it so that now I can

466
00:18:53,170 --> 00:18:56,950
monitor what the red team was trying to

467
00:18:54,910 --> 00:18:59,380
do but he doesn't know that that's going

468
00:18:56,950 --> 00:19:02,350
on there different approach of what you

469
00:18:59,380 --> 00:19:04,390
can do at this point back to this last

470
00:19:02,350 --> 00:19:07,480
circle over here as I mentioned know

471
00:19:04,390 --> 00:19:10,180
your clients know your terrine as I like

472
00:19:07,480 --> 00:19:12,430
to say cybersecurity is the new form of

473
00:19:10,180 --> 00:19:13,780
warfare people don't have time to press

474
00:19:12,430 --> 00:19:16,300
buttons here and there for actual

475
00:19:13,780 --> 00:19:20,800
military stuff this will be the new

476
00:19:16,300 --> 00:19:22,810
warfare if it not hasn't been yet but if

477
00:19:20,800 --> 00:19:25,840
it's a government-sponsored if it's an

478
00:19:22,810 --> 00:19:27,100
ATP you better know your client cause

479
00:19:25,840 --> 00:19:30,280
they're gonna look for information

480
00:19:27,100 --> 00:19:32,020
that's available job postings gives out

481
00:19:30,280 --> 00:19:33,850
a lot of software information and

482
00:19:32,020 --> 00:19:36,970
metadata every time you have a post

483
00:19:33,850 --> 00:19:38,800
that's out in the market I can now grab

484
00:19:36,970 --> 00:19:40,690
the computer name your name what was

485
00:19:38,800 --> 00:19:42,129
your domain and all these informations

486
00:19:40,690 --> 00:19:44,830
very easily I don't even have to waste

487
00:19:42,130 --> 00:19:46,750
more than two minutes on this after that

488
00:19:44,830 --> 00:19:49,090
so you create your theories now these

489
00:19:46,750 --> 00:19:51,640
are my hypothesis this is the way the

490
00:19:49,090 --> 00:19:54,399
attacks going to happen now that you

491
00:19:51,640 --> 00:19:55,389
also investigate with the dark net recon

492
00:19:54,400 --> 00:19:57,729
work in Orson

493
00:19:55,389 --> 00:19:59,799
activities and now what you want to do

494
00:19:57,729 --> 00:20:02,849
is your hypothesis has now been crafted

495
00:19:59,799 --> 00:20:05,079
now you start looking for what is

496
00:20:02,849 --> 00:20:07,029
available in your network is any of your

497
00:20:05,079 --> 00:20:09,989
hypotheses that you figured might be

498
00:20:07,029 --> 00:20:13,209
happening is it happening if it's not

499
00:20:09,989 --> 00:20:14,489
keep digging right until you have an

500
00:20:13,209 --> 00:20:17,979
answer that yeah you are foolproof

501
00:20:14,489 --> 00:20:20,859
protected keep digging and obviously

502
00:20:17,979 --> 00:20:23,529
this is a very tedious job don't do it

503
00:20:20,859 --> 00:20:25,059
every day the same thing use and

504
00:20:23,529 --> 00:20:28,599
leverage products are out in the market

505
00:20:25,059 --> 00:20:30,009
every time hypothesis becomes it needs

506
00:20:28,599 --> 00:20:31,149
to be enriched with the data and the

507
00:20:30,009 --> 00:20:33,159
trade intelligence platform you're

508
00:20:31,149 --> 00:20:34,599
leveraging so that the next time it's

509
00:20:33,159 --> 00:20:37,450
actually automated you know you're not

510
00:20:34,599 --> 00:20:40,418
running the same searches every day by

511
00:20:37,450 --> 00:20:42,039
yourself it just doesn't work so that

512
00:20:40,419 --> 00:20:44,919
part is something a lot of the companies

513
00:20:42,039 --> 00:20:49,059
I personally feel Phil is the last part

514
00:20:44,919 --> 00:20:51,369
is now you have good people with

515
00:20:49,059 --> 00:20:53,229
experience you probably are being

516
00:20:51,369 --> 00:20:55,958
bottlenecked with the product product

517
00:20:53,229 --> 00:20:57,969
comes second people comes first have

518
00:20:55,959 --> 00:21:00,700
experience people train the people that

519
00:20:57,969 --> 00:21:03,639
you have asked them what they need to

520
00:21:00,700 --> 00:21:08,559
get the work done right then figure out

521
00:21:03,639 --> 00:21:12,928
what product you need to use don't know

522
00:21:08,559 --> 00:21:15,779
why it's clicking twice but know that

523
00:21:12,929 --> 00:21:18,249
for the longest time I was talking about

524
00:21:15,779 --> 00:21:23,829
what things we need what logs we need

525
00:21:18,249 --> 00:21:26,379
and what gives the thread hunter well

526
00:21:23,829 --> 00:21:29,678
basically what makes a thread hunter you

527
00:21:26,379 --> 00:21:32,799
know get his job done now I'm showing

528
00:21:29,679 --> 00:21:34,599
when a 800 gets his job done there are

529
00:21:32,799 --> 00:21:38,200
some cool screens like this that pops up

530
00:21:34,599 --> 00:21:40,239
and it's pretty neat when you when you

531
00:21:38,200 --> 00:21:41,979
get the job done cause no one's gonna

532
00:21:40,239 --> 00:21:43,719
give you a pat at the back but when you

533
00:21:41,979 --> 00:21:46,659
go back home you will be like yeah I did

534
00:21:43,719 --> 00:21:48,009
something good today right so something

535
00:21:46,659 --> 00:21:49,899
here that I want to talk about is a

536
00:21:48,009 --> 00:21:53,139
beacon pattern analysis for this you

537
00:21:49,899 --> 00:21:55,029
definitely need bro log and a lot

538
00:21:53,139 --> 00:21:57,399
something else like there are streams or

539
00:21:55,029 --> 00:21:59,259
spawn streams Wong has written that but

540
00:21:57,399 --> 00:22:01,958
you need something that looks into flow

541
00:21:59,259 --> 00:22:05,169
data there are so right now we are

542
00:22:01,959 --> 00:22:07,580
looking at HTTP events or HTTP flow if

543
00:22:05,169 --> 00:22:10,190
you don't have web proxies on your

544
00:22:07,580 --> 00:22:12,470
your company company why are it's not

545
00:22:10,190 --> 00:22:13,970
deployed properly you can also leverage

546
00:22:12,470 --> 00:22:16,760
different technologies and

547
00:22:13,970 --> 00:22:18,950
fingerprinting mechanisms like ja3 for

548
00:22:16,760 --> 00:22:21,050
HTTP you can also come up with your own

549
00:22:18,950 --> 00:22:23,480
fingerprint mechanism that you have

550
00:22:21,050 --> 00:22:24,830
tried in own lab and you know what when

551
00:22:23,480 --> 00:22:27,910
is someone running a reverse shell

552
00:22:24,830 --> 00:22:31,610
meterpreter over https if someone's

553
00:22:27,910 --> 00:22:34,130
doing an IRC outbound these are all

554
00:22:31,610 --> 00:22:37,550
possible to fingerprint and your data

555
00:22:34,130 --> 00:22:38,900
will look like this so this case one

556
00:22:37,550 --> 00:22:42,050
morning we just started off the work

557
00:22:38,900 --> 00:22:43,430
again we look at the screen and this is

558
00:22:42,050 --> 00:22:45,409
one of our time that actually happened

559
00:22:43,430 --> 00:22:47,810
in the month of April a month of August

560
00:22:45,410 --> 00:22:50,720
actually and we were looking at this and

561
00:22:47,810 --> 00:22:52,370
the blue line the one you guys see is

562
00:22:50,720 --> 00:22:55,880
the last 24 hours

563
00:22:52,370 --> 00:22:57,739
the red line is actually the last day

564
00:22:55,880 --> 00:23:00,230
how it looked like and the green line

565
00:22:57,740 --> 00:23:02,300
was how it looked

566
00:23:00,230 --> 00:23:05,060
on a cluster made it's a it's an AI that

567
00:23:02,300 --> 00:23:08,210
we run behind how it usually looks like

568
00:23:05,060 --> 00:23:10,129
right with this pattern right here we

569
00:23:08,210 --> 00:23:11,630
were like well this is not normal to us

570
00:23:10,130 --> 00:23:14,270
because we've been monitoring the

571
00:23:11,630 --> 00:23:15,680
network for a long time this pattern of

572
00:23:14,270 --> 00:23:18,650
that the blue line over here does not

573
00:23:15,680 --> 00:23:20,690
look right instantly we got triggered

574
00:23:18,650 --> 00:23:21,980
obviously and even without someone

575
00:23:20,690 --> 00:23:23,270
looking into the dashboard we will get

576
00:23:21,980 --> 00:23:24,860
triggered on an alert that ok

577
00:23:23,270 --> 00:23:26,240
something's not right going on with HTTP

578
00:23:24,860 --> 00:23:29,870
flow look into it

579
00:23:26,240 --> 00:23:33,200
right this was actually related to a

580
00:23:29,870 --> 00:23:34,370
conflict configure warm basically if you

581
00:23:33,200 --> 00:23:36,290
guys don't know what that is I would

582
00:23:34,370 --> 00:23:39,379
suggest look into f-secure they did a

583
00:23:36,290 --> 00:23:41,750
really nice blog about it

584
00:23:39,380 --> 00:23:43,280
it shows about how a configure works and

585
00:23:41,750 --> 00:23:45,620
how it makes its way into the

586
00:23:43,280 --> 00:23:48,889
environment and why it needs to generate

587
00:23:45,620 --> 00:23:50,810
that pattern and this screen I'm showing

588
00:23:48,890 --> 00:23:52,790
about how that pattern actually got

589
00:23:50,810 --> 00:23:54,379
generated so right here you're seeing at

590
00:23:52,790 --> 00:23:56,600
a DGA which is domain generated

591
00:23:54,380 --> 00:23:58,460
algorithm and not only config or

592
00:23:56,600 --> 00:24:00,560
actually uses this technology or this

593
00:23:58,460 --> 00:24:01,220
method it's being used by a lot of

594
00:24:00,560 --> 00:24:03,679
ransomware

595
00:24:01,220 --> 00:24:07,550
out in the market and this is a way they

596
00:24:03,680 --> 00:24:10,160
talk back to their c2 so our next step

597
00:24:07,550 --> 00:24:13,190
was from that previous screen we went to

598
00:24:10,160 --> 00:24:14,900
ok since we have the data what kind of

599
00:24:13,190 --> 00:24:16,730
DNS queries were being made and what

600
00:24:14,900 --> 00:24:19,580
kind of HTTP requests were being made

601
00:24:16,730 --> 00:24:21,950
let's try to look into that and we came

602
00:24:19,580 --> 00:24:24,889
across this at first we were like

603
00:24:21,950 --> 00:24:27,320
Wow okay looks like completely random

604
00:24:24,889 --> 00:24:29,840
but if you look close enough and you

605
00:24:27,320 --> 00:24:32,210
have all your information comes back to

606
00:24:29,840 --> 00:24:34,459
it intelligence at this time if you just

607
00:24:32,210 --> 00:24:36,830
even copy pasted one of these domains

608
00:24:34,460 --> 00:24:38,570
and you actually went on to any of your

609
00:24:36,830 --> 00:24:40,279
Intelligence Platform let's I'm not

610
00:24:38,570 --> 00:24:42,950
gonna name the platforms but you go

611
00:24:40,279 --> 00:24:44,690
there plug it in it's not gonna give you

612
00:24:42,950 --> 00:24:46,460
any reference it wouldn't tell what it

613
00:24:44,690 --> 00:24:49,039
was because this was very new at that

614
00:24:46,460 --> 00:24:51,620
time but since we were scraping pastebin

615
00:24:49,039 --> 00:24:53,570
and we have our own honey pots deployed

616
00:24:51,620 --> 00:24:56,899
across all the continents we can think

617
00:24:53,570 --> 00:24:58,879
of over 6,000 of them and we capture all

618
00:24:56,899 --> 00:25:01,518
those data into our 13 trillions

619
00:24:58,880 --> 00:25:03,139
platform from these two sources mainly

620
00:25:01,519 --> 00:25:04,580
pastebin because there was a really nice

621
00:25:03,139 --> 00:25:06,799
research done by one of the Chinese

622
00:25:04,580 --> 00:25:11,090
intelligence and he decided to place

623
00:25:06,799 --> 00:25:13,639
that on pastebin thank God we basically

624
00:25:11,090 --> 00:25:15,860
started looking up with this key witness

625
00:25:13,639 --> 00:25:17,658
queries and we basically would trace it

626
00:25:15,860 --> 00:25:20,809
back that okay this was an infection

627
00:25:17,659 --> 00:25:23,870
this is configured next thing is you

628
00:25:20,809 --> 00:25:26,059
know phone up the guy who goes with this

629
00:25:23,870 --> 00:25:29,719
section called him to pull the plug if

630
00:25:26,059 --> 00:25:31,760
they want to run any kind of dissection

631
00:25:29,720 --> 00:25:33,919
or any kind of forensic song this box

632
00:25:31,760 --> 00:25:35,210
tell them not to restart the box cuz

633
00:25:33,919 --> 00:25:36,740
that end up happening a lot of the time

634
00:25:35,210 --> 00:25:38,570
and you actually lose valuable

635
00:25:36,740 --> 00:25:40,340
information a lot of these worms they

636
00:25:38,570 --> 00:25:42,230
tend to be not on the disk they tend to

637
00:25:40,340 --> 00:25:43,428
be on the memory so you restart the box

638
00:25:42,230 --> 00:25:47,840
means you're losing what was actually

639
00:25:43,429 --> 00:25:50,779
happening also a lot of the times the

640
00:25:47,840 --> 00:25:53,330
threat hunters we really need tools to

641
00:25:50,779 --> 00:25:56,269
guide us over the day or to make our

642
00:25:53,330 --> 00:25:58,879
life easier or else we the work will

643
00:25:56,269 --> 00:26:00,889
just eat up every individuals time and

644
00:25:58,880 --> 00:26:04,159
we won't be able to monitor multiple

645
00:26:00,889 --> 00:26:06,769
clients over the day right some of the

646
00:26:04,159 --> 00:26:09,380
tricks that we use is basically this one

647
00:26:06,769 --> 00:26:11,840
over here we use DNS entropy and HTTP

648
00:26:09,380 --> 00:26:14,870
entropy what they are basically in

649
00:26:11,840 --> 00:26:17,449
another way of seeing it is we leverage

650
00:26:14,870 --> 00:26:22,039
Shannon entropy to actually come up with

651
00:26:17,450 --> 00:26:25,789
okay this one does not look like a valid

652
00:26:22,039 --> 00:26:27,950
host name or a valid query it just does

653
00:26:25,789 --> 00:26:29,570
not seem right and there are always a

654
00:26:27,950 --> 00:26:31,940
lot of false positive depending on what

655
00:26:29,570 --> 00:26:33,799
kind of environment you are in a lot of

656
00:26:31,940 --> 00:26:35,480
this HTTP requests will like the one

657
00:26:33,799 --> 00:26:38,690
that's being shown here is

658
00:26:35,480 --> 00:26:40,520
actually a Google ad so we tend to

659
00:26:38,690 --> 00:26:42,890
monitor ad cause a lot of time if I was

660
00:26:40,520 --> 00:26:45,050
a hacker you already have a network

661
00:26:42,890 --> 00:26:47,150
which is the ad network that's

662
00:26:45,050 --> 00:26:49,220
infiltrating anyways I'm just gonna buy

663
00:26:47,150 --> 00:26:51,080
I'm gonna just make a fork off that same

664
00:26:49,220 --> 00:26:52,460
network and try to infiltrate your

665
00:26:51,080 --> 00:26:54,740
company because you are not blocking ads

666
00:26:52,460 --> 00:26:57,590
so we tend to monitor what's going on -

667
00:26:54,740 --> 00:27:00,950
ad network as well and the recent spike

668
00:26:57,590 --> 00:27:03,590
would be Chrome extensions and other

669
00:27:00,950 --> 00:27:06,320
browser extensions also those are very

670
00:27:03,590 --> 00:27:08,929
easy detectable with this technology

671
00:27:06,320 --> 00:27:10,669
right here or this way of looking into

672
00:27:08,930 --> 00:27:12,700
data I wouldn't call it a technology but

673
00:27:10,670 --> 00:27:15,230
it's it's a way of visualizing the data

674
00:27:12,700 --> 00:27:16,940
the second part if you guys can see I

675
00:27:15,230 --> 00:27:19,700
don't know if you guys can see it well

676
00:27:16,940 --> 00:27:22,010
enough but the HTTP entropy the second

677
00:27:19,700 --> 00:27:24,380
part right here you see a whole

678
00:27:22,010 --> 00:27:26,450
gibberish right if you look into this

679
00:27:24,380 --> 00:27:27,890
kind of data over and over again I can't

680
00:27:26,450 --> 00:27:31,070
really share from where I got this data

681
00:27:27,890 --> 00:27:32,750
but it ended up being a vending machine

682
00:27:31,070 --> 00:27:34,100
that was in a schedule and that

683
00:27:32,750 --> 00:27:37,010
shouldn't have been that's all I can

684
00:27:34,100 --> 00:27:40,159
give and when you are looking at this

685
00:27:37,010 --> 00:27:41,510
data stream it's actually if you have

686
00:27:40,160 --> 00:27:43,580
been looking into this kind of data over

687
00:27:41,510 --> 00:27:45,890
and over again at this stage you will

688
00:27:43,580 --> 00:27:48,050
know that this is a byte stream data

689
00:27:45,890 --> 00:27:50,470
being transferred outbound from your

690
00:27:48,050 --> 00:27:52,760
wherever the location is definitely

691
00:27:50,470 --> 00:27:55,460
needs to be looked at as what's the see

692
00:27:52,760 --> 00:27:57,020
- what's happening how did it get in for

693
00:27:55,460 --> 00:27:58,910
this case I can share that yeah this was

694
00:27:57,020 --> 00:28:04,400
a vending machine doing this which was

695
00:27:58,910 --> 00:28:05,750
not supposed to do this after that this

696
00:28:04,400 --> 00:28:08,300
is the walkthrough that I was talking

697
00:28:05,750 --> 00:28:10,490
about and I'm gonna try to go as soon

698
00:28:08,300 --> 00:28:12,230
I'm gonna try to cover this area as

699
00:28:10,490 --> 00:28:14,630
quickly as possible going through no

700
00:28:12,230 --> 00:28:16,480
harm done by timewise but I think I can

701
00:28:14,630 --> 00:28:18,590
manage

702
00:28:16,480 --> 00:28:21,680
so the walkthrough is there actually a

703
00:28:18,590 --> 00:28:22,970
simple one that I got for so that people

704
00:28:21,680 --> 00:28:25,760
who are starting out in the industry can

705
00:28:22,970 --> 00:28:30,200
understand this walkthrough very well a

706
00:28:25,760 --> 00:28:33,620
simple case of phishing and detecting it

707
00:28:30,200 --> 00:28:35,240
and before the phishing is the guy who's

708
00:28:33,620 --> 00:28:37,719
doing the fishing reaches its objective

709
00:28:35,240 --> 00:28:40,730
how you can trap it contain it and

710
00:28:37,720 --> 00:28:45,830
resolve it so that it does not become a

711
00:28:40,730 --> 00:28:47,570
problem right for that what bottlenecks

712
00:28:45,830 --> 00:28:48,649
are what are the pivot points you need

713
00:28:47,570 --> 00:28:51,200
to know

714
00:28:48,650 --> 00:28:54,620
you need to see the data that shows

715
00:28:51,200 --> 00:28:57,740
process executions PowerShell logging

716
00:28:54,620 --> 00:29:00,669
and email logs so as far as hosted is

717
00:28:57,740 --> 00:29:02,840
considered for this particular case only

718
00:29:00,670 --> 00:29:05,630
thing you need to leverage is actually

719
00:29:02,840 --> 00:29:08,990
system on data windows event logs mail

720
00:29:05,630 --> 00:29:11,480
logs and some sort of a network stream

721
00:29:08,990 --> 00:29:15,350
data so again back to Bro or some kind

722
00:29:11,480 --> 00:29:18,380
of a stream so based on this this was

723
00:29:15,350 --> 00:29:20,270
actually a case for a motet for people

724
00:29:18,380 --> 00:29:21,830
who do not know what a Motorhead is I

725
00:29:20,270 --> 00:29:24,560
would strongly suggest again research

726
00:29:21,830 --> 00:29:26,060
the only way this field is gonna make

727
00:29:24,560 --> 00:29:28,760
your life easier and make it better

728
00:29:26,060 --> 00:29:30,770
is the more research you do without the

729
00:29:28,760 --> 00:29:33,620
hard work nothing comes for free that's

730
00:29:30,770 --> 00:29:36,850
what I usually tell people for a

731
00:29:33,620 --> 00:29:39,530
honeypot for the the hunt hypothesis

732
00:29:36,850 --> 00:29:41,090
searching for programs launching VB

733
00:29:39,530 --> 00:29:44,180
PowerShell or command-line arguments

734
00:29:41,090 --> 00:29:46,760
that's my force hypothesis so I need to

735
00:29:44,180 --> 00:29:49,880
start looking for did anything happen in

736
00:29:46,760 --> 00:29:52,580
that box that had been running a VB

737
00:29:49,880 --> 00:29:55,310
script a command line or a power show

738
00:29:52,580 --> 00:29:57,230
execution happened on that box are we

739
00:29:55,310 --> 00:30:00,290
seeing any kind of a situ that's going

740
00:29:57,230 --> 00:30:03,410
out of that box somewhere right at that

741
00:30:00,290 --> 00:30:06,530
point that's my hypothesis and setting

742
00:30:03,410 --> 00:30:08,300
up persistence for persistence as days

743
00:30:06,530 --> 00:30:10,460
go by hackers are coming up with

744
00:30:08,300 --> 00:30:12,139
different different ways but I'm gonna

745
00:30:10,460 --> 00:30:14,930
I'm gonna go over that slide and show

746
00:30:12,140 --> 00:30:18,710
you guys what are the key methods a lot

747
00:30:14,930 --> 00:30:20,570
of the red teamers tend to use and what

748
00:30:18,710 --> 00:30:24,680
have been in the use for a while but now

749
00:30:20,570 --> 00:30:26,210
they're changing their tactics also for

750
00:30:24,680 --> 00:30:28,520
this particular case we had an unknown

751
00:30:26,210 --> 00:30:29,870
file hash so basically what I'm trying

752
00:30:28,520 --> 00:30:32,690
to say here is let's say you do get a

753
00:30:29,870 --> 00:30:35,780
hash probably none of the vendors will

754
00:30:32,690 --> 00:30:37,730
know also the same time if your favorite

755
00:30:35,780 --> 00:30:40,100
links becomes a virustotal or something

756
00:30:37,730 --> 00:30:41,330
very similar you go plug in the hash you

757
00:30:40,100 --> 00:30:48,620
have no information what you're looking

758
00:30:41,330 --> 00:30:50,090
at okay now this material I doubt how

759
00:30:48,620 --> 00:30:53,750
many eyes can see from the back what's

760
00:30:50,090 --> 00:30:55,459
written all over the screen but my plan

761
00:30:53,750 --> 00:30:58,310
is that when you guys take back this

762
00:30:55,460 --> 00:31:00,530
this presentation you get a chance to

763
00:30:58,310 --> 00:31:01,659
look over this entire process this is a

764
00:31:00,530 --> 00:31:04,540
walk down or

765
00:31:01,660 --> 00:31:07,120
walkthrough of what entirely I'm trying

766
00:31:04,540 --> 00:31:10,060
to explain right now with you guys it's

767
00:31:07,120 --> 00:31:13,899
in this diagram it's given with all the

768
00:31:10,060 --> 00:31:16,270
details to make it really quick and easy

769
00:31:13,900 --> 00:31:19,450
on that side we found that this is

770
00:31:16,270 --> 00:31:21,910
emoted based on pastebin data and also

771
00:31:19,450 --> 00:31:25,150
we actually confirmed that that ye

772
00:31:21,910 --> 00:31:27,160
health that we see here is actually the

773
00:31:25,150 --> 00:31:30,340
delivery mechanism that the new emoted

774
00:31:27,160 --> 00:31:31,960
was using apart from that we also found

775
00:31:30,340 --> 00:31:34,929
that the execution tree which basically

776
00:31:31,960 --> 00:31:36,640
was a word macro it leveraged command

777
00:31:34,930 --> 00:31:38,890
command line with obfuscation

778
00:31:36,640 --> 00:31:40,330
and after that it moved on to actually

779
00:31:38,890 --> 00:31:42,370
doing the next stage of the payload

780
00:31:40,330 --> 00:31:45,669
which was leveraging powershell script I

781
00:31:42,370 --> 00:31:47,500
was a base encoded base64 encoded

782
00:31:45,670 --> 00:31:50,680
partial I'm gonna come to that slide

783
00:31:47,500 --> 00:31:53,170
next but also we were able to get all

784
00:31:50,680 --> 00:31:57,150
the SI toos that it was communicating

785
00:31:53,170 --> 00:31:59,500
outbound with and also you know the the

786
00:31:57,150 --> 00:32:01,660
sha-256 for helping out and sharing the

787
00:31:59,500 --> 00:32:04,830
data to other twenty until people who

788
00:32:01,660 --> 00:32:08,110
are getting our 30 intelligence features

789
00:32:04,830 --> 00:32:10,030
also since we also deploy snort or

790
00:32:08,110 --> 00:32:12,459
sarikaya in our environment we obviously

791
00:32:10,030 --> 00:32:14,740
get any kind of IDs matches that happens

792
00:32:12,460 --> 00:32:17,470
so for this particular case we did get

793
00:32:14,740 --> 00:32:21,040
auto open macro and terse named file

794
00:32:17,470 --> 00:32:22,420
that's possibly hostile but but the kill

795
00:32:21,040 --> 00:32:24,520
chain of how it happened was there was

796
00:32:22,420 --> 00:32:27,670
an email that was sent even though they

797
00:32:24,520 --> 00:32:30,360
were using a really good vendor known to

798
00:32:27,670 --> 00:32:32,590
block a lot of these did not block it

799
00:32:30,360 --> 00:32:35,649
next thing we know the user does click

800
00:32:32,590 --> 00:32:38,260
on macro and that fancy picture I showed

801
00:32:35,650 --> 00:32:40,390
in the last screen from there it

802
00:32:38,260 --> 00:32:43,120
actually leveraged Explorer from there

803
00:32:40,390 --> 00:32:46,300
it went to win word exe that launched

804
00:32:43,120 --> 00:32:47,679
CMD you CMD to call power show and power

805
00:32:46,300 --> 00:32:49,720
shall actually downloaded the second

806
00:32:47,680 --> 00:32:52,390
stage of the payload that was seven to

807
00:32:49,720 --> 00:32:55,540
nine exe the seven to nine exe actually

808
00:32:52,390 --> 00:32:58,330
copies itself in multiple places and it

809
00:32:55,540 --> 00:33:01,740
then changed it name to T voluntarily

810
00:32:58,330 --> 00:33:04,840
exe and T voluntary dot exe is

811
00:33:01,740 --> 00:33:06,430
responsible for doing all the other

812
00:33:04,840 --> 00:33:09,550
stages that become a cross which is

813
00:33:06,430 --> 00:33:12,430
persistence mechanism if it was in case

814
00:33:09,550 --> 00:33:14,860
of this is an emoted if this was an NG

815
00:33:12,430 --> 00:33:15,380
rat the T vondre would be leveraging

816
00:33:14,860 --> 00:33:18,679
that and

817
00:33:15,380 --> 00:33:21,260
lateral movement in the network but the

818
00:33:18,680 --> 00:33:23,480
way we got to know I'm gonna come back

819
00:33:21,260 --> 00:33:26,390
to this slide after I'm done with the

820
00:33:23,480 --> 00:33:32,750
this light where is my slide that I want

821
00:33:26,390 --> 00:33:35,900
to show okay so here is a small

822
00:33:32,750 --> 00:33:38,420
breakdown of what the power shall look

823
00:33:35,900 --> 00:33:39,830
like and the reason I give this out to

824
00:33:38,420 --> 00:33:42,500
you guys is when you guys take back home

825
00:33:39,830 --> 00:33:45,429
it's pretty easy dissecting a base64

826
00:33:42,500 --> 00:33:48,470
encryption power so once you have it and

827
00:33:45,430 --> 00:33:52,310
we also saw that the seven to nine exe

828
00:33:48,470 --> 00:33:54,050
and the T voluntary exe they also shared

829
00:33:52,310 --> 00:33:57,350
the same hash that's confirming it was

830
00:33:54,050 --> 00:33:59,180
the same exe that just copied itself in

831
00:33:57,350 --> 00:34:02,120
a different folder or different folders

832
00:33:59,180 --> 00:34:04,520
for this particular case the power soul

833
00:34:02,120 --> 00:34:07,159
after we decoded it we saw all the the

834
00:34:04,520 --> 00:34:09,649
actual communicating servers that it was

835
00:34:07,160 --> 00:34:11,179
leveraging and at this point you know

836
00:34:09,649 --> 00:34:13,460
you just pick up the phone call the

837
00:34:11,179 --> 00:34:15,740
right people get those blocked and also

838
00:34:13,460 --> 00:34:18,470
since you are monitoring now a lot of

839
00:34:15,739 --> 00:34:21,138
different clients or the entire company

840
00:34:18,469 --> 00:34:23,330
you might want to do is plug these in

841
00:34:21,139 --> 00:34:25,490
into your search query and see if

842
00:34:23,330 --> 00:34:27,409
there's any other box that might have

843
00:34:25,489 --> 00:34:28,969
been infected somewhere else cuz people

844
00:34:27,409 --> 00:34:32,710
like to bring in the box and take out

845
00:34:28,969 --> 00:34:35,149
the box right laptops phones whatever

846
00:34:32,710 --> 00:34:37,250
did they get infected somewhere else and

847
00:34:35,149 --> 00:34:38,839
they came into the office if they are

848
00:34:37,250 --> 00:34:40,760
and they are actually online right now

849
00:34:38,840 --> 00:34:43,450
and they're talking we have another

850
00:34:40,760 --> 00:34:46,600
detection and work on it get it fixed so

851
00:34:43,449 --> 00:34:49,730
now I'll go back to my previous screen

852
00:34:46,600 --> 00:34:55,100
okay so with the note with the network

853
00:34:49,730 --> 00:34:57,170
based data what leverage what monitoring

854
00:34:55,100 --> 00:34:58,790
you can you can leverage with network

855
00:34:57,170 --> 00:35:01,910
based data right so we saw that a

856
00:34:58,790 --> 00:35:03,440
download actually happened from that

857
00:35:01,910 --> 00:35:05,060
destination IP right here I'm not gonna

858
00:35:03,440 --> 00:35:07,310
read that out but you guys probably can

859
00:35:05,060 --> 00:35:10,430
see that at this point sometimes what we

860
00:35:07,310 --> 00:35:12,140
like to do is go after that versary so

861
00:35:10,430 --> 00:35:14,120
we would probably start doing a red

862
00:35:12,140 --> 00:35:18,470
teaming engagement against these people

863
00:35:14,120 --> 00:35:20,569
who are doing this just for fun also at

864
00:35:18,470 --> 00:35:22,220
this point you can see that the Mozilla

865
00:35:20,570 --> 00:35:24,770
extension that's being used so the

866
00:35:22,220 --> 00:35:27,830
Mozilla 4.0 is an older user agent

867
00:35:24,770 --> 00:35:29,080
version it's not the latest one and also

868
00:35:27,830 --> 00:35:31,480
we get other details as

869
00:35:29,080 --> 00:35:34,150
this is a msword status quos well

870
00:35:31,480 --> 00:35:38,490
obviously 200 and also that alert that

871
00:35:34,150 --> 00:35:41,140
we detected on with sis Mon data and

872
00:35:38,490 --> 00:35:42,819
even before we did a deep dive just

873
00:35:41,140 --> 00:35:46,089
looking at the system own events what

874
00:35:42,820 --> 00:35:48,550
happens and you can look at these events

875
00:35:46,090 --> 00:35:50,740
in various different forms but what we

876
00:35:48,550 --> 00:35:52,750
tend to do is just see what's going on

877
00:35:50,740 --> 00:35:56,049
in that hour in our network based on

878
00:35:52,750 --> 00:35:58,960
segments of different IP e sections and

879
00:35:56,050 --> 00:36:01,150
subnets so when we did that scan we saw

880
00:35:58,960 --> 00:36:03,190
that okay there is a file created and a

881
00:36:01,150 --> 00:36:04,470
registry value said oh that's not a good

882
00:36:03,190 --> 00:36:06,910
sign

883
00:36:04,470 --> 00:36:08,560
brings onto the next stream so we

884
00:36:06,910 --> 00:36:10,569
started doing a deeper dive we see that

885
00:36:08,560 --> 00:36:12,910
okay there was a command line that was

886
00:36:10,570 --> 00:36:14,830
alpha skated not encoded it was just

887
00:36:12,910 --> 00:36:17,049
office kated the reason hackers tend to

888
00:36:14,830 --> 00:36:20,049
use office keishon against encoding is

889
00:36:17,050 --> 00:36:22,000
because it's a polymorphic in nature you

890
00:36:20,050 --> 00:36:24,190
can always keep on changing the same

891
00:36:22,000 --> 00:36:25,690
code over and over again with

892
00:36:24,190 --> 00:36:27,840
polymorphic obfuscation and you can

893
00:36:25,690 --> 00:36:30,520
reuse this same code over and over again

894
00:36:27,840 --> 00:36:33,130
thus the command line which we saw okay

895
00:36:30,520 --> 00:36:34,960
this is the command line what called the

896
00:36:33,130 --> 00:36:37,090
command line was the parent image right

897
00:36:34,960 --> 00:36:40,120
here at the bottom if you see that okay

898
00:36:37,090 --> 00:36:43,600
it leveraged of the Windward exe and the

899
00:36:40,120 --> 00:36:45,370
command line was called and obviously

900
00:36:43,600 --> 00:36:48,490
the image that was called is the command

901
00:36:45,370 --> 00:36:50,230
command line after that we see that okay

902
00:36:48,490 --> 00:36:52,990
the command line after it ran it

903
00:36:50,230 --> 00:36:54,610
actually called the power show and which

904
00:36:52,990 --> 00:36:58,299
was encoded and which did the rest of

905
00:36:54,610 --> 00:36:59,160
the work I already went over this screen

906
00:36:58,300 --> 00:37:01,560
with you guys

907
00:36:59,160 --> 00:37:04,540
[Music]

908
00:37:01,560 --> 00:37:08,020
so as for disk activities considered

909
00:37:04,540 --> 00:37:10,240
also true siscon you can gather what

910
00:37:08,020 --> 00:37:12,730
actually happened on that box so we

911
00:37:10,240 --> 00:37:15,819
actually did see that okay yep the 79

912
00:37:12,730 --> 00:37:19,570
exe was created and after that creation

913
00:37:15,820 --> 00:37:21,580
the T voluntary was created so forth

914
00:37:19,570 --> 00:37:23,410
those are for let's say you need to

915
00:37:21,580 --> 00:37:25,560
submit a report with someone as to what

916
00:37:23,410 --> 00:37:28,950
exactly happened these become very

917
00:37:25,560 --> 00:37:31,600
useful evidence that you need to submit

918
00:37:28,950 --> 00:37:33,339
apart from that again back to the the

919
00:37:31,600 --> 00:37:35,140
network when the C 2 was actually

920
00:37:33,340 --> 00:37:37,360
happening so you still see that okay it

921
00:37:35,140 --> 00:37:40,870
was reaching out to a destination IP of

922
00:37:37,360 --> 00:37:42,190
I kind of highlighted that and the

923
00:37:40,870 --> 00:37:44,430
process that were using is the power

924
00:37:42,190 --> 00:37:44,430
show

925
00:37:44,760 --> 00:37:49,780
back to persistence the the thing I

926
00:37:47,470 --> 00:37:51,520
wanted to talk to you about persistence

927
00:37:49,780 --> 00:37:53,830
what you guys need to look out for is

928
00:37:51,520 --> 00:37:56,410
usually hackers will tend to use or

929
00:37:53,830 --> 00:37:58,330
leverage Ron keys which is basically

930
00:37:56,410 --> 00:38:01,870
setting up registry values or registry

931
00:37:58,330 --> 00:38:04,690
keys services scheduled tasks off line

932
00:38:01,870 --> 00:38:08,500
office templates dll's access features

933
00:38:04,690 --> 00:38:10,150
beacon patterns and out IDs and lateral

934
00:38:08,500 --> 00:38:12,490
movement now these are all that is

935
00:38:10,150 --> 00:38:15,310
trackable once you have a very good

936
00:38:12,490 --> 00:38:17,229
visibility of your network and these are

937
00:38:15,310 --> 00:38:21,940
usually what the advisories will be

938
00:38:17,230 --> 00:38:24,040
trying to use and the first three I call

939
00:38:21,940 --> 00:38:26,020
them the old-school ways hackers love to

940
00:38:24,040 --> 00:38:27,759
use those the more and more new members

941
00:38:26,020 --> 00:38:29,770
are coming out of worms are coming out

942
00:38:27,760 --> 00:38:32,320
they don't tend to even exist on the

943
00:38:29,770 --> 00:38:34,920
disk it's probably on the memory so

944
00:38:32,320 --> 00:38:39,070
beacon pattern becomes very important

945
00:38:34,920 --> 00:38:41,320
they love to do an API injection thus

946
00:38:39,070 --> 00:38:44,140
infiltrating our dll without even being

947
00:38:41,320 --> 00:38:46,540
part of the disk that's so you can track

948
00:38:44,140 --> 00:38:48,129
those changes and obviously lateral

949
00:38:46,540 --> 00:38:50,500
movement you will see a box trying to

950
00:38:48,130 --> 00:38:52,930
communicate with multiple boxes running

951
00:38:50,500 --> 00:38:54,400
so brings onto the well this page

952
00:38:52,930 --> 00:38:56,830
actually talks about the registry that I

953
00:38:54,400 --> 00:38:58,600
was talking about the wrong keys so we

954
00:38:56,830 --> 00:39:01,870
actually see that T voluntary did

955
00:38:58,600 --> 00:39:04,810
registry implementation over here for

956
00:39:01,870 --> 00:39:07,900
its persistence mechanism next slide I

957
00:39:04,810 --> 00:39:11,040
talked about lateral movement don't know

958
00:39:07,900 --> 00:39:11,040
why I can't go to the next slide

959
00:39:19,290 --> 00:39:25,290
technical difficulties guys but yeah

960
00:39:22,770 --> 00:39:27,840
lateral movements for lateral movement

961
00:39:25,290 --> 00:39:31,259
the things that you can leverage your in

962
00:39:27,840 --> 00:39:33,119
your monitoring is is there a recon work

963
00:39:31,260 --> 00:39:35,340
happening is there a port scanning

964
00:39:33,119 --> 00:39:37,380
happening is there a power show exact

965
00:39:35,340 --> 00:39:39,060
that's running off that box where it's

966
00:39:37,380 --> 00:39:41,820
not supposed to run

967
00:39:39,060 --> 00:39:44,250
is there an RDP session going on or is

968
00:39:41,820 --> 00:39:46,619
there actually a PS remoting happening

969
00:39:44,250 --> 00:39:49,170
right after that there will be probably

970
00:39:46,619 --> 00:39:52,560
I tend to do a zone transfer or DNS

971
00:39:49,170 --> 00:39:54,900
poisoning attempts or they can leverage

972
00:39:52,560 --> 00:39:57,330
something called the bloodhound and with

973
00:39:54,900 --> 00:39:59,430
a really awesome plugin that was

974
00:39:57,330 --> 00:40:01,890
recently bought a few years back that

975
00:39:59,430 --> 00:40:03,690
was done there was a add-on that

976
00:40:01,890 --> 00:40:07,109
happened that's called the angry puppy

977
00:40:03,690 --> 00:40:09,600
it literally does LDAP enumeration

978
00:40:07,109 --> 00:40:11,490
giving out most of your details about

979
00:40:09,600 --> 00:40:14,240
the interactive directory right so those

980
00:40:11,490 --> 00:40:16,589
are the signs that you can look for but

981
00:40:14,240 --> 00:40:18,000
make sure you contain the data before

982
00:40:16,590 --> 00:40:20,880
this step happens this is already too

983
00:40:18,000 --> 00:40:23,820
late but still need to know when this

984
00:40:20,880 --> 00:40:26,490
thing happens what to look for what you

985
00:40:23,820 --> 00:40:28,859
also expect to see is through system

986
00:40:26,490 --> 00:40:31,200
owned or Windows data that anonymous

987
00:40:28,859 --> 00:40:33,299
user activities service logins LDAP

988
00:40:31,200 --> 00:40:35,549
traffic high count of one to many

989
00:40:33,300 --> 00:40:36,990
connections one box trying to do RDP

990
00:40:35,550 --> 00:40:39,810
sessions with multiple other different

991
00:40:36,990 --> 00:40:42,180
box or trying to scan different other

992
00:40:39,810 --> 00:40:45,240
boxes from that same box which will

993
00:40:42,180 --> 00:40:47,490
become which actually is a pivot case

994
00:40:45,240 --> 00:40:49,470
that all of the time we actually alert

995
00:40:47,490 --> 00:40:51,450
on and start looking into that why is

996
00:40:49,470 --> 00:40:53,459
this box from the HR department trying

997
00:40:51,450 --> 00:40:54,930
to get into a box that belongs to the

998
00:40:53,460 --> 00:40:57,210
monitoring department or some other

999
00:40:54,930 --> 00:40:59,160
department but when you know what your

1000
00:40:57,210 --> 00:41:02,850
baseline is these kind of detections can

1001
00:40:59,160 --> 00:41:04,500
be tracked and monitored very easily but

1002
00:41:02,850 --> 00:41:07,259
again back to what data types

1003
00:41:04,500 --> 00:41:08,609
am I gonna leverage off that that is

1004
00:41:07,260 --> 00:41:11,430
going to allow my threat hunters to do

1005
00:41:08,609 --> 00:41:16,710
this job system on data windows data bro

1006
00:41:11,430 --> 00:41:19,310
log I think that is pretty much that

1007
00:41:16,710 --> 00:41:22,580
brings us to the end of the presentation

1008
00:41:19,310 --> 00:41:25,619
the reason I did this presentation was I

1009
00:41:22,580 --> 00:41:28,380
believed in the cause that people needs

1010
00:41:25,619 --> 00:41:31,350
to learn understand what this is rather

1011
00:41:28,380 --> 00:41:32,559
learning our product works people need

1012
00:41:31,350 --> 00:41:35,229
to understand how

1013
00:41:32,559 --> 00:41:36,939
and why someone's doing something the

1014
00:41:35,229 --> 00:41:39,069
question is not that why are they doing

1015
00:41:36,939 --> 00:41:40,420
it to us the question is I can do it so

1016
00:41:39,069 --> 00:41:42,279
I'll do it

1017
00:41:40,420 --> 00:41:43,749
that's usually the argument for a hacker

1018
00:41:42,279 --> 00:41:46,059
who's trying to do something bad to your

1019
00:41:43,749 --> 00:41:48,910
organization or you or your parents

1020
00:41:46,059 --> 00:41:50,559
right just pick whatever is the

1021
00:41:48,910 --> 00:41:54,430
different scenarios but the thing

1022
00:41:50,559 --> 00:41:57,249
usually happens very similar fashion so

1023
00:41:54,430 --> 00:42:00,879
we have a huge and I repeat we have a

1024
00:41:57,249 --> 00:42:02,439
huge deficiency of people who knows how

1025
00:42:00,880 --> 00:42:05,709
to look into this kind of information

1026
00:42:02,439 --> 00:42:08,589
and do the work right when I actually go

1027
00:42:05,709 --> 00:42:11,618
into public or are going to a workshop I

1028
00:42:08,589 --> 00:42:14,680
actually see a lot of young people and

1029
00:42:11,619 --> 00:42:16,689
they're all very you know they're

1030
00:42:14,680 --> 00:42:19,558
they're I was young at like only just

1031
00:42:16,689 --> 00:42:22,538
few months or a few years back and

1032
00:42:19,559 --> 00:42:24,880
basically they all loved to get into the

1033
00:42:22,539 --> 00:42:27,249
field but they don't really know what to

1034
00:42:24,880 --> 00:42:29,410
look for how to get started

1035
00:42:27,249 --> 00:42:31,319
what can we leverage how much can be

1036
00:42:29,410 --> 00:42:33,848
learned just by doing stuff in your own

1037
00:42:31,319 --> 00:42:36,219
home lab environment it doesn't take

1038
00:42:33,849 --> 00:42:38,019
much it doesn't even take a big server

1039
00:42:36,219 --> 00:42:41,199
to run a lot of the stuff to just start

1040
00:42:38,019 --> 00:42:44,618
running actually bro made Raspberry Pi

1041
00:42:41,199 --> 00:42:46,869
port Splunk made a portable portable

1042
00:42:44,619 --> 00:42:49,209
version for running in Raspberry Pi so

1043
00:42:46,869 --> 00:42:52,179
you can run this entire scenario for

1044
00:42:49,209 --> 00:42:55,919
your home in a Raspberry Pi and monitor

1045
00:42:52,179 --> 00:42:58,479
your home and learn at the same time

1046
00:42:55,920 --> 00:43:01,420
while I was monitoring my home a good

1047
00:42:58,479 --> 00:43:04,299
scenario was I actually I buy stuff so

1048
00:43:01,420 --> 00:43:07,959
that I can break them so I bought out a

1049
00:43:04,299 --> 00:43:12,219
whole pack of Samsung lo ble devices and

1050
00:43:07,959 --> 00:43:13,689
basically their home oh my arts that's

1051
00:43:12,219 --> 00:43:15,519
what I like to call them but they serve

1052
00:43:13,689 --> 00:43:17,920
different purposes like their toasters

1053
00:43:15,519 --> 00:43:20,738
or their music players or their speakers

1054
00:43:17,920 --> 00:43:23,469
and Smart TVs you'll be surprised how

1055
00:43:20,739 --> 00:43:26,049
much data goes to south well goes to

1056
00:43:23,469 --> 00:43:28,150
South Korea from your house when you run

1057
00:43:26,049 --> 00:43:31,390
all these now ten god it's not the other

1058
00:43:28,150 --> 00:43:33,219
end of the Koreas but it's South Korea

1059
00:43:31,390 --> 00:43:35,259
for that case but a lot of cool and

1060
00:43:33,219 --> 00:43:36,729
interesting things that you can find

1061
00:43:35,259 --> 00:43:40,569
from just looking into your home network

1062
00:43:36,729 --> 00:43:42,129
and you can leverage the Raspberry Pi

1063
00:43:40,569 --> 00:43:46,029
cause your home is probably about only

1064
00:43:42,130 --> 00:43:47,140
10 or 20 or 30 or 50 devices strong

1065
00:43:46,030 --> 00:43:52,420
obviously you can do the same for

1066
00:43:47,140 --> 00:43:55,540
environment so there needs to be a way

1067
00:43:52,420 --> 00:43:57,460
you can so the question comes what you

1068
00:43:55,540 --> 00:44:00,220
need to look for what you want to

1069
00:43:57,460 --> 00:44:02,170
accomplish and what agents and what

1070
00:44:00,220 --> 00:44:07,359
appliances can do this job for you guys

1071
00:44:02,170 --> 00:44:09,310
just to give a brief history of this

1072
00:44:07,360 --> 00:44:10,840
conversation few years back I was

1073
00:44:09,310 --> 00:44:12,940
talking to some people and they told me

1074
00:44:10,840 --> 00:44:15,250
or what you're saying is is possible in

1075
00:44:12,940 --> 00:44:17,860
a lab environment it's never possible in

1076
00:44:15,250 --> 00:44:19,660
an actual corporate environment let me

1077
00:44:17,860 --> 00:44:21,790
tell you that statement was completely

1078
00:44:19,660 --> 00:44:25,230
wrong we currently do 10 terabytes of

1079
00:44:21,790 --> 00:44:28,450
data a day and we run this entire show

1080
00:44:25,230 --> 00:44:30,250
24/7 all around the year right so this

1081
00:44:28,450 --> 00:44:31,089
is possible you just need to figure out

1082
00:44:30,250 --> 00:44:33,910
what you need

1083
00:44:31,090 --> 00:44:37,120
what infrastructure you can leverage of

1084
00:44:33,910 --> 00:44:40,509
what tools you need what what crap you

1085
00:44:37,120 --> 00:44:42,009
can throw off there's all this crap with

1086
00:44:40,510 --> 00:44:43,450
any kind of oil that comes in you need

1087
00:44:42,010 --> 00:44:46,090
to know what you can Creek in and out

1088
00:44:43,450 --> 00:44:49,029
and only use it for the purpose it was

1089
00:44:46,090 --> 00:44:50,680
bought for but also for people who are

1090
00:44:49,030 --> 00:44:53,860
starting out in the industry filled in

1091
00:44:50,680 --> 00:44:56,169
this security industry I think the three

1092
00:44:53,860 --> 00:45:00,250
really good platforms that you can learn

1093
00:44:56,170 --> 00:45:02,920
from a lot is security onions salt and

1094
00:45:00,250 --> 00:45:05,610
hunting elk hunting with elk are called

1095
00:45:02,920 --> 00:45:09,100
health there is a great DEFCON

1096
00:45:05,610 --> 00:45:10,930
presentation for help I would strongly

1097
00:45:09,100 --> 00:45:12,430
recommend practice this in your lab

1098
00:45:10,930 --> 00:45:13,930
environments create your own

1099
00:45:12,430 --> 00:45:16,509
environments and start doing these to

1100
00:45:13,930 --> 00:45:18,700
understand security better the more you

1101
00:45:16,510 --> 00:45:21,940
guys understand the easier it becomes

1102
00:45:18,700 --> 00:45:25,000
for the security fuel to work and yeah

1103
00:45:21,940 --> 00:45:27,040
let's work together and let's get the

1104
00:45:25,000 --> 00:45:29,800
show running so that's all for my

1105
00:45:27,040 --> 00:45:33,060
presentation and hopefully you guys had

1106
00:45:29,800 --> 00:45:33,060
something to take back home today

1107
00:45:33,790 --> 00:45:35,850
you

