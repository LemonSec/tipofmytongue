1
00:00:03,810 --> 00:00:09,080
so my name is Joshua Reynolds and

2
00:00:06,089 --> 00:00:11,160
welcome to more monaro more problems I

3
00:00:09,080 --> 00:00:14,670
just wanted to give a brief introduction

4
00:00:11,160 --> 00:00:15,900
as to who I am so I am currently a

5
00:00:14,670 --> 00:00:16,550
senior technical analyst with

6
00:00:15,900 --> 00:00:19,470
CrowdStrike

7
00:00:16,550 --> 00:00:22,550
where I do a large amount of reverse

8
00:00:19,470 --> 00:00:27,000
engineering and Intel analysis on

9
00:00:22,550 --> 00:00:29,310
various tractors I previously was at

10
00:00:27,000 --> 00:00:30,570
Cisco in a similar capacity but I was

11
00:00:29,310 --> 00:00:33,510
working on the product front so I was

12
00:00:30,570 --> 00:00:36,930
producing indicator content for two

13
00:00:33,510 --> 00:00:39,960
product lines and as mentioned I am one

14
00:00:36,930 --> 00:00:41,519
of the cofounders of yegg sec if you are

15
00:00:39,960 --> 00:00:42,870
not part of our community yet and you'd

16
00:00:41,520 --> 00:00:44,160
like to become a part of it even if

17
00:00:42,870 --> 00:00:46,050
you're not necessarily in Edmonton all

18
00:00:44,160 --> 00:00:48,029
the time we still love you to have in

19
00:00:46,050 --> 00:00:50,578
our love to have you in our slack and

20
00:00:48,030 --> 00:00:54,270
become a part of the community so you

21
00:00:50,579 --> 00:00:55,320
can ping us on egg sec on Twitter that's

22
00:00:54,270 --> 00:00:57,710
probably the easiest way to get an

23
00:00:55,320 --> 00:01:01,100
invite and we'll usually provide

24
00:00:57,710 --> 00:01:05,850
consistent updates on on that platform

25
00:01:01,100 --> 00:01:08,610
and I'm also the co-author of the sate

26
00:01:05,850 --> 00:01:10,798
malware analysis course that is a part

27
00:01:08,610 --> 00:01:14,610
of their information security systems

28
00:01:10,799 --> 00:01:18,840
diploma so they started a two-year

29
00:01:14,610 --> 00:01:20,970
program that you can do and in the

30
00:01:18,840 --> 00:01:22,200
second year actually this semester that

31
00:01:20,970 --> 00:01:23,580
starting is the first time that that

32
00:01:22,200 --> 00:01:26,909
malware analysis course is going to be

33
00:01:23,580 --> 00:01:28,890
taught so that's pretty exciting and if

34
00:01:26,909 --> 00:01:34,530
you want to hit me up that's my twitter

35
00:01:28,890 --> 00:01:37,320
handle there at the bottom so when I was

36
00:01:34,530 --> 00:01:39,630
thinking about concepts for this talk I

37
00:01:37,320 --> 00:01:42,449
really liked hip hop and I really liked

38
00:01:39,630 --> 00:01:48,570
biggie so that's kind of like play on

39
00:01:42,450 --> 00:01:50,880
words for for the title and eyes pretty

40
00:01:48,570 --> 00:01:52,979
much everybody in this room knows a

41
00:01:50,880 --> 00:01:55,740
cache pretty much rules everything

42
00:01:52,979 --> 00:01:58,710
around you so and this is the same thing

43
00:01:55,740 --> 00:02:00,570
with criminal threat after groups where

44
00:01:58,710 --> 00:02:02,640
they need recurring revenue as well

45
00:02:00,570 --> 00:02:04,020
because they have bills that need to be

46
00:02:02,640 --> 00:02:06,600
paid they have to pay their rent they

47
00:02:04,020 --> 00:02:10,530
have to buy their family's food etc and

48
00:02:06,600 --> 00:02:13,500
a large amount of these groups live in

49
00:02:10,530 --> 00:02:14,700
countries that they don't have

50
00:02:13,500 --> 00:02:16,650
a lot of choices in terms of

51
00:02:14,700 --> 00:02:20,730
professional careers I was lucky enough

52
00:02:16,650 --> 00:02:22,620
to have a prosperous prosperous security

53
00:02:20,730 --> 00:02:24,899
career in Canada but not a lot of these

54
00:02:22,620 --> 00:02:28,890
guys have the same kind of choices that

55
00:02:24,900 --> 00:02:31,260
I do not to shine a lime light on these

56
00:02:28,890 --> 00:02:33,450
guys but just to give you some other

57
00:02:31,260 --> 00:02:37,100
motivational perspectives they have to

58
00:02:33,450 --> 00:02:42,149
make money too so this is a quote from a

59
00:02:37,100 --> 00:02:44,420
biggie song that is quite good as well

60
00:02:42,150 --> 00:02:45,989
if you want to check it out so

61
00:02:44,420 --> 00:02:48,149
specifically I wanted to talk about

62
00:02:45,989 --> 00:02:50,340
Manero today because this is the primary

63
00:02:48,150 --> 00:02:53,850
crypto currency that's being mined by

64
00:02:50,340 --> 00:02:55,920
malicious cryptocurrency miners and I'll

65
00:02:53,850 --> 00:03:00,930
talk to you or sorry I'll talk about how

66
00:02:55,920 --> 00:03:03,179
exactly and why that is so just a brief

67
00:03:00,930 --> 00:03:05,520
overview of what Manero is it is a

68
00:03:03,180 --> 00:03:09,420
crypto currency based on the crypto note

69
00:03:05,520 --> 00:03:11,310
protocol so unlike most of the popular

70
00:03:09,420 --> 00:03:13,530
crypto currencies it is not a fork of

71
00:03:11,310 --> 00:03:16,920
Bitcoin it was built from the ground up

72
00:03:13,530 --> 00:03:19,500
and they established a what's called the

73
00:03:16,920 --> 00:03:21,510
egalitarian proof of work so for most

74
00:03:19,500 --> 00:03:23,160
crypto currencies you have a proof of

75
00:03:21,510 --> 00:03:24,600
work that basically says that you did

76
00:03:23,160 --> 00:03:27,660
some amount of work in order to receive

77
00:03:24,600 --> 00:03:31,140
a part of the currency or a block on

78
00:03:27,660 --> 00:03:33,540
most block chains and in this instance

79
00:03:31,140 --> 00:03:35,279
they try to make it as accessible to any

80
00:03:33,540 --> 00:03:36,900
computing device as possible so

81
00:03:35,280 --> 00:03:41,340
everybody has a vote that's the

82
00:03:36,900 --> 00:03:43,440
egalitarian term so they also

83
00:03:41,340 --> 00:03:46,440
implemented a number of privacy features

84
00:03:43,440 --> 00:03:48,900
so I now go through those and it is much

85
00:03:46,440 --> 00:03:51,090
more private than Bitcoin which

86
00:03:48,900 --> 00:03:55,230
essentially has every transaction and

87
00:03:51,090 --> 00:03:56,519
every address and transaction between

88
00:03:55,230 --> 00:03:58,048
those addresses is published to their

89
00:03:56,519 --> 00:04:01,709
blockchain which will be there forever

90
00:03:58,049 --> 00:04:03,329
so I'll go over those concepts so just

91
00:04:01,709 --> 00:04:05,370
to quickly go over the Kryptonite

92
00:04:03,329 --> 00:04:07,769
protocol which is that egalitarian proof

93
00:04:05,370 --> 00:04:09,360
of work it is a stick resistance so for

94
00:04:07,769 --> 00:04:11,970
those of you who not are not involved in

95
00:04:09,360 --> 00:04:13,440
the in the crypto space Asics are

96
00:04:11,970 --> 00:04:17,040
essentially specialized computing

97
00:04:13,440 --> 00:04:18,810
devices for calculating sha-256 hashes

98
00:04:17,040 --> 00:04:21,329
at a very rapid rate so those are

99
00:04:18,810 --> 00:04:23,640
usually done on graphics cards because

100
00:04:21,329 --> 00:04:27,150
they allow increased performance over

101
00:04:23,640 --> 00:04:29,250
normal CPUs and so for what these guys

102
00:04:27,150 --> 00:04:32,159
with crypto no protocol sorry kryptonite

103
00:04:29,250 --> 00:04:34,830
protocol is that they made it memory

104
00:04:32,160 --> 00:04:37,350
bound so it's very difficult to make

105
00:04:34,830 --> 00:04:39,539
Asics have good performance when there's

106
00:04:37,350 --> 00:04:42,210
a memory requirement and they made this

107
00:04:39,539 --> 00:04:44,039
two megabytes in size so this fits quite

108
00:04:42,210 --> 00:04:48,780
well within the l3 cache of most modern

109
00:04:44,039 --> 00:04:52,259
CPU cores so then therefore it would

110
00:04:48,780 --> 00:04:54,539
have rapid access to to that l3 cache in

111
00:04:52,259 --> 00:04:57,630
theory and they also made it so it

112
00:04:54,539 --> 00:05:01,440
requires random access to ram so this is

113
00:04:57,630 --> 00:05:05,130
also difficult to implement on Asics and

114
00:05:01,440 --> 00:05:07,469
they've also required the use of CPU

115
00:05:05,130 --> 00:05:10,229
instructions that are also difficult

116
00:05:07,470 --> 00:05:12,690
difficult to emulate on GPUs so if you

117
00:05:10,229 --> 00:05:15,300
look at like I looked at the exome rig

118
00:05:12,690 --> 00:05:18,870
source code they have a number of Intel

119
00:05:15,300 --> 00:05:22,050
instructions on the x86 version that are

120
00:05:18,870 --> 00:05:25,770
specialized when conducting the actual

121
00:05:22,050 --> 00:05:27,270
mining process so I just wanted to go

122
00:05:25,770 --> 00:05:31,889
through the privacy features as well as

123
00:05:27,270 --> 00:05:33,500
mentioned so the way that transactions

124
00:05:31,889 --> 00:05:35,580
are performed in payments in

125
00:05:33,500 --> 00:05:38,490
cryptocurrency is that they are signed

126
00:05:35,580 --> 00:05:40,289
so if I sign a transaction and publish

127
00:05:38,490 --> 00:05:42,900
that the blockchain then that

128
00:05:40,289 --> 00:05:46,229
transaction is going to go to the

129
00:05:42,900 --> 00:05:50,340
receiver but also since I've signed that

130
00:05:46,229 --> 00:05:51,990
with my private key you can say that I

131
00:05:50,340 --> 00:05:53,039
signed that transaction and therefore it

132
00:05:51,990 --> 00:05:55,560
originates from me

133
00:05:53,039 --> 00:05:57,180
the way that Manero gets around this is

134
00:05:55,560 --> 00:06:01,289
they have what's called group signatures

135
00:05:57,180 --> 00:06:05,039
so it's essentially a a crypto

136
00:06:01,289 --> 00:06:06,870
implementation that says okay well the

137
00:06:05,039 --> 00:06:08,940
transaction originated from this group

138
00:06:06,870 --> 00:06:12,300
of signatures but not necessary this

139
00:06:08,940 --> 00:06:13,380
this group which was signed but it's not

140
00:06:12,300 --> 00:06:15,030
necessarily tied to a specific

141
00:06:13,380 --> 00:06:15,800
individual there's no way you can prove

142
00:06:15,030 --> 00:06:18,690
that I

143
00:06:15,800 --> 00:06:22,770
I myself which is a part of that group

144
00:06:18,690 --> 00:06:25,490
had submitted that transaction they also

145
00:06:22,770 --> 00:06:28,979
generate one-time addresses for

146
00:06:25,490 --> 00:06:31,199
anonymous transactions so within the

147
00:06:28,979 --> 00:06:33,530
Bitcoin for instance you can see a

148
00:06:31,199 --> 00:06:36,210
particular transaction occurred with a

149
00:06:33,530 --> 00:06:39,150
transaction address but in Manero that's

150
00:06:36,210 --> 00:06:41,219
not possible because if I was to send a

151
00:06:39,150 --> 00:06:42,810
payment I would give some

152
00:06:41,220 --> 00:06:46,280
what's called like a stealth address and

153
00:06:42,810 --> 00:06:50,340
then they actually derive a one-time key

154
00:06:46,280 --> 00:06:52,020
from from that stealth address which is

155
00:06:50,340 --> 00:06:53,400
then used for the transaction so it's

156
00:06:52,020 --> 00:06:55,799
all done with one-time keys it's kind of

157
00:06:53,400 --> 00:06:57,299
like having a burner phone where you

158
00:06:55,800 --> 00:06:58,890
call and do your drug dealer whatever

159
00:06:57,300 --> 00:07:01,080
and then you break the phone like in all

160
00:06:58,890 --> 00:07:02,520
the movies right so that's kind of the

161
00:07:01,080 --> 00:07:03,840
approach they've taken from a

162
00:07:02,520 --> 00:07:07,320
cryptographic point of view which is

163
00:07:03,840 --> 00:07:09,570
which is quite cool so what is malicious

164
00:07:07,320 --> 00:07:12,060
mining though it's essentially making

165
00:07:09,570 --> 00:07:14,780
use of an infected machine for mining

166
00:07:12,060 --> 00:07:17,160
whatever cryptocurrency that you'd like

167
00:07:14,780 --> 00:07:18,260
it's gaining popularity with a large of

168
00:07:17,160 --> 00:07:21,960
different botnets and malware

169
00:07:18,260 --> 00:07:22,950
distributors because it I believe it was

170
00:07:21,960 --> 00:07:25,020
initially gaining a lot of popularity

171
00:07:22,950 --> 00:07:26,940
because cryptocurrency was gaining so

172
00:07:25,020 --> 00:07:30,109
much popularity and therefore the prices

173
00:07:26,940 --> 00:07:35,310
were very very inflated in my opinion

174
00:07:30,110 --> 00:07:36,570
and they this provides recurring revenue

175
00:07:35,310 --> 00:07:38,490
so if you have a large amount of

176
00:07:36,570 --> 00:07:40,230
infected systems and you're mining on

177
00:07:38,490 --> 00:07:41,940
those infected system systems on a

178
00:07:40,230 --> 00:07:44,130
monthly basis you're constantly making

179
00:07:41,940 --> 00:07:46,230
revenue whereas things like ransomware

180
00:07:44,130 --> 00:07:50,790
you're not gonna be making that revenue

181
00:07:46,230 --> 00:07:52,770
back you're going to be essentially

182
00:07:50,790 --> 00:07:54,630
getting a one-time payment possibly by

183
00:07:52,770 --> 00:07:56,700
encrypting everybody's files so the

184
00:07:54,630 --> 00:07:58,260
other point is that this is much less

185
00:07:56,700 --> 00:08:00,659
invasive and things like ransomware

186
00:07:58,260 --> 00:08:02,550
because you're pretty much just using up

187
00:08:00,660 --> 00:08:05,130
CPU cycles and people's electricity

188
00:08:02,550 --> 00:08:06,990
rather than having an evasive tactic of

189
00:08:05,130 --> 00:08:08,790
making people never be able to get their

190
00:08:06,990 --> 00:08:10,050
photos back in things like that so I

191
00:08:08,790 --> 00:08:13,729
think I think this is why a lot of

192
00:08:10,050 --> 00:08:16,169
malware authors are moving to this and

193
00:08:13,729 --> 00:08:18,360
why do they mine mineiro specifically

194
00:08:16,169 --> 00:08:20,159
well you can probably guess by what I've

195
00:08:18,360 --> 00:08:20,940
alluded to earlier there's an increase

196
00:08:20,160 --> 00:08:24,060
in on amenity

197
00:08:20,940 --> 00:08:27,030
there's the egalitarian proof provides a

198
00:08:24,060 --> 00:08:29,100
means of doing this mining on commodity

199
00:08:27,030 --> 00:08:30,770
hardware so the average CPU is still

200
00:08:29,100 --> 00:08:34,680
decent and mining this cryptocurrency

201
00:08:30,770 --> 00:08:36,630
whereas something like Bitcoin CPUs are

202
00:08:34,679 --> 00:08:38,968
not very good and when you infect a

203
00:08:36,630 --> 00:08:40,110
system as a malware author it is more

204
00:08:38,969 --> 00:08:41,310
often than not going to just be

205
00:08:40,110 --> 00:08:43,860
commodity Hardware because the average

206
00:08:41,309 --> 00:08:47,280
person just has the average computing

207
00:08:43,860 --> 00:08:50,190
power right so the mining difficulty is

208
00:08:47,280 --> 00:08:52,829
also fairly low so for those you still

209
00:08:50,190 --> 00:08:54,930
try to like mine Bitcoin it is fairly

210
00:08:52,830 --> 00:08:55,190
difficult in comparison to the mining

211
00:08:54,930 --> 00:08:56,359
for

212
00:08:55,190 --> 00:08:59,360
in China and things like that who have

213
00:08:56,360 --> 00:09:01,760
massive computing power and it's used in

214
00:08:59,360 --> 00:09:04,760
underground markets so a lot of these

215
00:09:01,760 --> 00:09:06,080
guys will buy kits in order to

216
00:09:04,760 --> 00:09:08,030
distribute their malware so like

217
00:09:06,080 --> 00:09:10,730
document kits that will generate a large

218
00:09:08,030 --> 00:09:13,100
amount of obfuscation and they'll rent

219
00:09:10,730 --> 00:09:14,900
out botnets for spam distribution and to

220
00:09:13,100 --> 00:09:16,990
do all these things and typically

221
00:09:14,900 --> 00:09:19,760
they'll do payments in cryptocurrency

222
00:09:16,990 --> 00:09:23,270
rather than using something like PayPal

223
00:09:19,760 --> 00:09:25,730
do you do that on a non amenity and a

224
00:09:23,270 --> 00:09:27,230
lot of underground markets like the Silk

225
00:09:25,730 --> 00:09:30,550
Road are similar to what the Silk Road

226
00:09:27,230 --> 00:09:33,350
was accept payments and Manero as well

227
00:09:30,550 --> 00:09:35,810
and when I initially came up with this

228
00:09:33,350 --> 00:09:37,220
concept for this talk and when I was

229
00:09:35,810 --> 00:09:40,130
doing a large amount of this research in

230
00:09:37,220 --> 00:09:42,830
like January of this year things were

231
00:09:40,130 --> 00:09:45,620
exploding right you had ridiculous gains

232
00:09:42,830 --> 00:09:49,640
in every single cryptocurrency not just

233
00:09:45,620 --> 00:09:51,620
Manero and that was resulting in a lot

234
00:09:49,640 --> 00:09:53,660
of these guys being able to cash out and

235
00:09:51,620 --> 00:09:55,190
buy like islands like I'm pretty sure

236
00:09:53,660 --> 00:09:58,130
some of the malware was some of the some

237
00:09:55,190 --> 00:10:00,740
of the ransomware authors just cashed

238
00:09:58,130 --> 00:10:01,939
out and like Tesla crypt gave up their

239
00:10:00,740 --> 00:10:04,520
master key I don't know if they're still

240
00:10:01,940 --> 00:10:07,820
around but they probably could have

241
00:10:04,520 --> 00:10:10,010
cashed out and just retired essentially

242
00:10:07,820 --> 00:10:13,970
that's that's how crazy the games were

243
00:10:10,010 --> 00:10:17,510
in January so let's talk about mining

244
00:10:13,970 --> 00:10:20,620
pools so essentially this is the concept

245
00:10:17,510 --> 00:10:23,270
of shared processing power being used

246
00:10:20,620 --> 00:10:25,400
from many different nodes and in order

247
00:10:23,270 --> 00:10:27,199
to - single block so you can think of

248
00:10:25,400 --> 00:10:29,750
kind of the same concept of study at

249
00:10:27,200 --> 00:10:31,610
home so in a search of extraterrestrial

250
00:10:29,750 --> 00:10:33,830
life you have a large amount of CP

251
00:10:31,610 --> 00:10:37,880
instructions that need to be executed

252
00:10:33,830 --> 00:10:40,220
and the SETI organization provided a

253
00:10:37,880 --> 00:10:41,870
means of doing this by just offering up

254
00:10:40,220 --> 00:10:44,080
your CPU cycles which is pretty cool and

255
00:10:41,870 --> 00:10:47,690
it's the same same concept essentially

256
00:10:44,080 --> 00:10:50,570
and based on the amount of hash rate you

257
00:10:47,690 --> 00:10:53,320
provide then the block that you mine as

258
00:10:50,570 --> 00:10:55,700
a group is then split up accordingly and

259
00:10:53,320 --> 00:10:57,110
since you have increased hashing power

260
00:10:55,700 --> 00:10:59,240
between a large amount of different

261
00:10:57,110 --> 00:11:00,650
computers within that single pool then

262
00:10:59,240 --> 00:11:02,210
you have obviously an increased

263
00:11:00,650 --> 00:11:06,560
likelihood of finding a block because

264
00:11:02,210 --> 00:11:08,089
you have much more transactions sorry

265
00:11:06,560 --> 00:11:08,569
many more transactions that are

266
00:11:08,089 --> 00:11:12,980
occurring

267
00:11:08,570 --> 00:11:15,650
so this is an example of a pool my necks

268
00:11:12,980 --> 00:11:17,090
marcom they provide some pretty

269
00:11:15,650 --> 00:11:22,040
interesting statistics so when I took

270
00:11:17,090 --> 00:11:25,160
this screenshot in August they had they

271
00:11:22,040 --> 00:11:28,280
were peeking around over 500,000

272
00:11:25,160 --> 00:11:32,959
connections per I believe that's per

273
00:11:28,280 --> 00:11:37,670
second and then their hash rate was was

274
00:11:32,960 --> 00:11:40,610
hitting hitting around 120 mega hashes

275
00:11:37,670 --> 00:11:41,959
per second which is enormous if you're

276
00:11:40,610 --> 00:11:44,450
kind of involved in the in the crypt of

277
00:11:41,960 --> 00:11:47,630
space or well it's enormous and from my

278
00:11:44,450 --> 00:11:49,670
perspective so that's pretty interesting

279
00:11:47,630 --> 00:11:52,700
and then they provide some other cool

280
00:11:49,670 --> 00:11:57,410
statistics like the difficulty level and

281
00:11:52,700 --> 00:11:58,940
then the block count and when payments

282
00:11:57,410 --> 00:12:01,060
were set out and things like that so

283
00:11:58,940 --> 00:12:04,280
this is actually really useful for

284
00:12:01,060 --> 00:12:06,079
tracking malware authors and we'll kind

285
00:12:04,280 --> 00:12:09,530
of go into that but why do malware

286
00:12:06,080 --> 00:12:12,320
authors use mining pools well there's a

287
00:12:09,530 --> 00:12:14,030
few interesting advantages to using a

288
00:12:12,320 --> 00:12:15,920
pool where you don't really need a a

289
00:12:14,030 --> 00:12:18,079
wallet on the endpoint system you just

290
00:12:15,920 --> 00:12:19,579
need a unique identifier so more often

291
00:12:18,080 --> 00:12:22,040
than not it'll just be a wallet address

292
00:12:19,580 --> 00:12:26,290
that they provide to the pool in order

293
00:12:22,040 --> 00:12:29,750
to say hey I did this mining and then

294
00:12:26,290 --> 00:12:32,930
they also commonly make use of open

295
00:12:29,750 --> 00:12:36,080
source clients like X X M rig so this is

296
00:12:32,930 --> 00:12:38,120
a screenshot of the hybrid analysis

297
00:12:36,080 --> 00:12:39,920
sandbox output and basically it's just

298
00:12:38,120 --> 00:12:42,740
showing the process command-line

299
00:12:39,920 --> 00:12:45,560
arguments so in this instance W script

300
00:12:42,740 --> 00:12:47,660
IX e was being used to execute a VBS

301
00:12:45,560 --> 00:12:50,380
script and this subsequently executed a

302
00:12:47,660 --> 00:12:52,819
mining application so these parameters

303
00:12:50,380 --> 00:12:55,460
are essentially just what's needed for

304
00:12:52,820 --> 00:12:57,640
the excimer egg miner application and as

305
00:12:55,460 --> 00:13:00,080
you can see the - o parameter is

306
00:12:57,640 --> 00:13:01,520
providing the stratum protocol which is

307
00:13:00,080 --> 00:13:06,680
essentially the communication protocol

308
00:13:01,520 --> 00:13:08,630
with the mining pool and the mining pool

309
00:13:06,680 --> 00:13:10,640
is provided as well and the accompanying

310
00:13:08,630 --> 00:13:12,800
port and then the unique identifier so

311
00:13:10,640 --> 00:13:18,140
in this case they are providing a wallet

312
00:13:12,800 --> 00:13:20,510
address so as I kind of alluded to it's

313
00:13:18,140 --> 00:13:22,310
really good for Intel so if you can get

314
00:13:20,510 --> 00:13:23,630
a wallet address

315
00:13:22,310 --> 00:13:25,849
I can get a whole bunch of different

316
00:13:23,630 --> 00:13:28,930
information from these mining pools that

317
00:13:25,850 --> 00:13:31,040
they publicly publish so what's cool is

318
00:13:28,930 --> 00:13:33,319
more often than not you can see the

319
00:13:31,040 --> 00:13:36,890
number of infected system systems based

320
00:13:33,320 --> 00:13:38,120
on a wallet address because this all

321
00:13:36,890 --> 00:13:40,160
this information is freely available

322
00:13:38,120 --> 00:13:42,140
within the pool you can also see their

323
00:13:40,160 --> 00:13:45,319
hash rate and most importantly and

324
00:13:42,140 --> 00:13:47,210
what's mostly what's kind of most of

325
00:13:45,320 --> 00:13:50,210
interest to most people is the number of

326
00:13:47,210 --> 00:13:52,330
mined blocks so this is essentially the

327
00:13:50,210 --> 00:13:56,570
amount of currency that has been mined

328
00:13:52,330 --> 00:13:58,250
from this address or sorry that's being

329
00:13:56,570 --> 00:14:02,540
provided to this address as payment for

330
00:13:58,250 --> 00:14:04,550
mining so you can also report these

331
00:14:02,540 --> 00:14:07,069
addresses to the public mining pools and

332
00:14:04,550 --> 00:14:09,229
get them banned so that's a pretty fun

333
00:14:07,070 --> 00:14:11,170
hobby because you can essentially cut

334
00:14:09,230 --> 00:14:14,570
the head off of a lot of these

335
00:14:11,170 --> 00:14:16,880
operations because they rely on these

336
00:14:14,570 --> 00:14:19,190
mining pools in order to create to

337
00:14:16,880 --> 00:14:21,230
generate currency and if you report the

338
00:14:19,190 --> 00:14:26,420
address to the pool they can no longer

339
00:14:21,230 --> 00:14:28,430
do so but because you can get banned for

340
00:14:26,420 --> 00:14:30,050
the mining pools these guys have

341
00:14:28,430 --> 00:14:33,140
subsequently been rolling their own

342
00:14:30,050 --> 00:14:37,699
pools so this is quite interesting in

343
00:14:33,140 --> 00:14:39,439
that you see a large more and more

344
00:14:37,700 --> 00:14:41,050
people rolling their own pools and we'll

345
00:14:39,440 --> 00:14:45,550
look at a Malheur variant that does that

346
00:14:41,050 --> 00:14:47,810
so here is an example so I took this

347
00:14:45,550 --> 00:14:49,819
address from some commodity mining

348
00:14:47,810 --> 00:14:52,280
malware and looked it up on my next

349
00:14:49,820 --> 00:14:55,580
marcom and then you get a whole bunch of

350
00:14:52,280 --> 00:14:58,790
history pertaining to that address so

351
00:14:55,580 --> 00:15:01,010
you can get things like the amount or

352
00:14:58,790 --> 00:15:04,910
sorry that the average hash rate total

353
00:15:01,010 --> 00:15:06,650
paid so 111 XMR I didn't really look at

354
00:15:04,910 --> 00:15:08,780
the price this morning for Manero but I

355
00:15:06,650 --> 00:15:12,500
think it's around like 11 grand us which

356
00:15:08,780 --> 00:15:14,630
is pretty good and then you can get all

357
00:15:12,500 --> 00:15:15,920
their like transaction history and stuff

358
00:15:14,630 --> 00:15:21,140
like that so this is really good for

359
00:15:15,920 --> 00:15:23,630
Intel work so as there's a large amount

360
00:15:21,140 --> 00:15:27,589
of blue teams in this audience I wanted

361
00:15:23,630 --> 00:15:30,670
to provide a way for most you to be able

362
00:15:27,589 --> 00:15:32,780
to track and stop these infections so on

363
00:15:30,670 --> 00:15:36,050
after every section I'm going to provide

364
00:15:32,780 --> 00:15:38,329
some blue team highlights so this list

365
00:15:36,050 --> 00:15:44,959
is really good and is frequently updated

366
00:15:38,330 --> 00:15:47,330
by 0.1 and you can use these mining pool

367
00:15:44,959 --> 00:15:49,369
addresses to track infections in your

368
00:15:47,330 --> 00:15:51,200
environment so if you look at and all of

369
00:15:49,370 --> 00:15:55,310
your DNS lookups in your environment and

370
00:15:51,200 --> 00:15:56,959
you see one for say my next marcom it's

371
00:15:55,310 --> 00:15:59,029
likely that you have a mining infection

372
00:15:56,959 --> 00:16:02,119
you can also send call these addresses

373
00:15:59,029 --> 00:16:04,880
so there are some semi legitimate ones

374
00:16:02,120 --> 00:16:07,880
based on what you allow for your

375
00:16:04,880 --> 00:16:09,649
browsing policy in your environments but

376
00:16:07,880 --> 00:16:11,630
if you just sinkhole all the addresses

377
00:16:09,649 --> 00:16:12,829
they won't be able to the malware won't

378
00:16:11,630 --> 00:16:17,029
be able to connect to the pools and

379
00:16:12,829 --> 00:16:20,209
therefore not be able to mine and I also

380
00:16:17,029 --> 00:16:21,910
suggest taking a look at your process

381
00:16:20,209 --> 00:16:24,199
command-line arguments for things like

382
00:16:21,910 --> 00:16:29,569
stratum so I just provided like a really

383
00:16:24,200 --> 00:16:32,240
basic regex stratum TCP there won't be

384
00:16:29,570 --> 00:16:34,640
any legitimate applications that I'm

385
00:16:32,240 --> 00:16:36,140
aware of that will be that will include

386
00:16:34,640 --> 00:16:38,630
those command-line arguments you can

387
00:16:36,140 --> 00:16:41,149
also look for hosts within the command

388
00:16:38,630 --> 00:16:42,860
command line arguments themselves but

389
00:16:41,149 --> 00:16:46,970
obviously that will be fairly taxing

390
00:16:42,860 --> 00:16:48,860
because the list is quite large so let's

391
00:16:46,970 --> 00:16:51,290
talk about infection vectors though like

392
00:16:48,860 --> 00:16:52,579
I've alluded to the malware but how is

393
00:16:51,290 --> 00:16:55,849
it actually going to get into your

394
00:16:52,579 --> 00:16:58,910
environments so the predominant

395
00:16:55,850 --> 00:17:00,740
technique is called mal spam so this is

396
00:16:58,910 --> 00:17:03,740
just a generic term that industry uses

397
00:17:00,740 --> 00:17:05,540
to refer to any malicious spam that has

398
00:17:03,740 --> 00:17:06,650
attachments that can be used to gain

399
00:17:05,540 --> 00:17:11,809
code execution within your environment

400
00:17:06,650 --> 00:17:13,579
so typically this mal spam will just be

401
00:17:11,809 --> 00:17:15,470
an attachment that downloads an execute

402
00:17:13,579 --> 00:17:17,149
malware or contains malware in and of

403
00:17:15,470 --> 00:17:18,939
itself so you can actually ship like a

404
00:17:17,150 --> 00:17:24,169
full PE binary within like a window a

405
00:17:18,939 --> 00:17:27,949
Microsoft Word document and these are a

406
00:17:24,169 --> 00:17:30,440
couple of examples so macros VBA macros

407
00:17:27,949 --> 00:17:32,480
can gain full code execution on sandbox

408
00:17:30,440 --> 00:17:34,520
code execution on your machine so just

409
00:17:32,480 --> 00:17:37,940
hitting that enable macros button in

410
00:17:34,520 --> 00:17:40,550
Microsoft Word they can get full access

411
00:17:37,940 --> 00:17:43,280
to your user line processes and things

412
00:17:40,550 --> 00:17:45,678
like that you can also embed an oily

413
00:17:43,280 --> 00:17:47,510
object so if you drag and drop an

414
00:17:45,679 --> 00:17:49,350
executable in Microsoft Word and you

415
00:17:47,510 --> 00:17:50,850
double click on that executable then

416
00:17:49,350 --> 00:17:53,039
it will actually open and execute

417
00:17:50,850 --> 00:17:54,990
there's a few warnings but most people

418
00:17:53,039 --> 00:17:58,710
will just fall for them

419
00:17:54,990 --> 00:18:00,120
there has been instances where miners

420
00:17:58,710 --> 00:18:03,179
have been shipped using document

421
00:18:00,120 --> 00:18:06,270
exploits as well and scripts

422
00:18:03,179 --> 00:18:09,179
so all these scripting file types can be

423
00:18:06,270 --> 00:18:10,740
used to gain access to active ActiveX

424
00:18:09,179 --> 00:18:12,720
controls and then they can gain code

425
00:18:10,740 --> 00:18:15,840
execution on your machine as well so

426
00:18:12,720 --> 00:18:18,240
I'll be going over how to kind of get

427
00:18:15,840 --> 00:18:21,090
around a lot of these issues from a blue

428
00:18:18,240 --> 00:18:24,809
team perspective but let's go into an

429
00:18:21,090 --> 00:18:26,789
actual example so this is an example

430
00:18:24,809 --> 00:18:29,460
from our traffic analysis so this is a

431
00:18:26,789 --> 00:18:31,770
public website that you don't need to

432
00:18:29,460 --> 00:18:34,409
register for or anything like that Brad

433
00:18:31,770 --> 00:18:37,168
who runs it is really good at getting

434
00:18:34,409 --> 00:18:39,270
new content out and he gives everything

435
00:18:37,169 --> 00:18:41,640
so you get a you get like a peek app you

436
00:18:39,270 --> 00:18:43,260
get all the files involved and you can

437
00:18:41,640 --> 00:18:45,120
do whatever analysis you want so I

438
00:18:43,260 --> 00:18:48,360
basically took something that he did an

439
00:18:45,120 --> 00:18:49,799
IFC diary on and then expanded it out

440
00:18:48,360 --> 00:18:53,189
because he didn't do like a full

441
00:18:49,799 --> 00:18:54,929
reversing session on on the malware so

442
00:18:53,190 --> 00:18:58,620
this is actually the office gated

443
00:18:54,929 --> 00:19:00,960
JavaScript and this is a debug session I

444
00:18:58,620 --> 00:19:03,149
just did in Chrome it's quite nice to

445
00:19:00,960 --> 00:19:06,000
have like an interactive debug session

446
00:19:03,150 --> 00:19:09,780
for JavaScript and in this instance they

447
00:19:06,000 --> 00:19:12,690
were just using a concatenation of a

448
00:19:09,780 --> 00:19:16,320
whole bunch of x-rays and these are just

449
00:19:12,690 --> 00:19:18,299
characters and then the offsets into the

450
00:19:16,320 --> 00:19:20,760
array as well and then this just

451
00:19:18,299 --> 00:19:22,590
resulted in this like F delimited string

452
00:19:20,760 --> 00:19:25,260
and then just splitting and joining on

453
00:19:22,590 --> 00:19:29,629
that string produce this command line so

454
00:19:25,260 --> 00:19:35,070
in this instance are using PowerShell to

455
00:19:29,630 --> 00:19:36,929
execute and download a file so in this

456
00:19:35,070 --> 00:19:38,939
instance it's a portable executable and

457
00:19:36,929 --> 00:19:41,909
then they're using invoke WMI method

458
00:19:38,940 --> 00:19:43,830
within PowerShell to execute that

459
00:19:41,909 --> 00:19:49,140
downloaded executable in the temp

460
00:19:43,830 --> 00:19:51,480
directory so let's go over the actual

461
00:19:49,140 --> 00:19:53,730
binary that was dropped so in this

462
00:19:51,480 --> 00:19:56,100
instance it was a binary that dropped

463
00:19:53,730 --> 00:19:57,929
more binaries but it had some

464
00:19:56,100 --> 00:20:01,100
interesting functionality so this

465
00:19:57,929 --> 00:20:03,280
dropper binary has the capability of

466
00:20:01,100 --> 00:20:05,949
propagating over there

467
00:20:03,280 --> 00:20:08,110
four USB drives and your network drives

468
00:20:05,950 --> 00:20:10,810
it requires some interaction and I'll go

469
00:20:08,110 --> 00:20:12,280
into how that actually works and what

470
00:20:10,810 --> 00:20:15,570
was really cool and that I thought was

471
00:20:12,280 --> 00:20:17,470
cool is it will actually monitor for

472
00:20:15,570 --> 00:20:19,929
cryptocurrency addresses in your

473
00:20:17,470 --> 00:20:21,040
clipboard so if you're like mining on

474
00:20:19,930 --> 00:20:25,270
your computer and you go to make a

475
00:20:21,040 --> 00:20:27,700
payment to say somebody for some some

476
00:20:25,270 --> 00:20:29,050
form of goods they will just look for

477
00:20:27,700 --> 00:20:30,490
that in your clipboard and then replace

478
00:20:29,050 --> 00:20:32,740
it with their own address so when you go

479
00:20:30,490 --> 00:20:34,780
to send that currency it will just go to

480
00:20:32,740 --> 00:20:37,900
them instead of who rightful sender was

481
00:20:34,780 --> 00:20:39,910
so I thought that was pretty neat and it

482
00:20:37,900 --> 00:20:41,940
has the capability of downloading the

483
00:20:39,910 --> 00:20:45,760
miner binary which we'll go over as well

484
00:20:41,940 --> 00:20:48,580
so for those of you do not do malware

485
00:20:45,760 --> 00:20:51,010
analysis it is very common for the

486
00:20:48,580 --> 00:20:53,020
binary x' for the malware binaries to

487
00:20:51,010 --> 00:20:56,080
have some an analysis tricks so in this

488
00:20:53,020 --> 00:20:57,310
instance they had a bunch of processes

489
00:20:56,080 --> 00:20:59,260
in memory that they were looking for

490
00:20:57,310 --> 00:21:02,620
they will typically look for a virtual

491
00:20:59,260 --> 00:21:05,320
environment so sandboxes and reversers

492
00:21:02,620 --> 00:21:06,790
will typically run malware in these

493
00:21:05,320 --> 00:21:11,470
virtual environments so like there's

494
00:21:06,790 --> 00:21:13,480
VirtualBox VM ware and if they see these

495
00:21:11,470 --> 00:21:14,800
processes in memory the malware will

496
00:21:13,480 --> 00:21:19,480
just exit they won't do any more

497
00:21:14,800 --> 00:21:23,680
functionality and here's an anti VM

498
00:21:19,480 --> 00:21:26,320
trick so they're looking to resolve this

499
00:21:23,680 --> 00:21:28,810
whine function from the import address

500
00:21:26,320 --> 00:21:31,000
table and if they can successfully get

501
00:21:28,810 --> 00:21:33,580
an address to that function and they

502
00:21:31,000 --> 00:21:35,950
will exit as well so this is a this is

503
00:21:33,580 --> 00:21:39,189
super common you'll often see auntie VM

504
00:21:35,950 --> 00:21:42,280
tricks so for example like I was just

505
00:21:39,190 --> 00:21:44,620
doing this analysis in a virtual

506
00:21:42,280 --> 00:21:46,420
environment and they were able to exit

507
00:21:44,620 --> 00:21:48,280
but if you just break on the exit

508
00:21:46,420 --> 00:21:51,130
function then you can typically look up

509
00:21:48,280 --> 00:21:52,660
the call stack and then determine kind

510
00:21:51,130 --> 00:21:57,660
of where in the code they might have

511
00:21:52,660 --> 00:22:00,760
some anti virtualization tricks so

512
00:21:57,660 --> 00:22:02,770
here's just the code for the network and

513
00:22:00,760 --> 00:22:06,730
try propagation so they will look for

514
00:22:02,770 --> 00:22:08,110
the drive type in a loop so they will

515
00:22:06,730 --> 00:22:11,770
constantly look for connected devices

516
00:22:08,110 --> 00:22:14,649
and drives and if it is either the

517
00:22:11,770 --> 00:22:17,020
removable or the network drive type then

518
00:22:14,650 --> 00:22:20,440
they will create a shortcut

519
00:22:17,020 --> 00:22:23,530
on that USB or network drive that

520
00:22:20,440 --> 00:22:25,720
corresponds to either executable files

521
00:22:23,530 --> 00:22:29,500
on that drive or on that network share

522
00:22:25,720 --> 00:22:32,980
or they will just create on USB sticks

523
00:22:29,500 --> 00:22:36,400
they will create a shortcut for the name

524
00:22:32,980 --> 00:22:38,110
of the USB on the USB and that L&K file

525
00:22:36,400 --> 00:22:41,010
will have these command-line arguments

526
00:22:38,110 --> 00:22:44,260
to execute a copy piece of malware on

527
00:22:41,010 --> 00:22:46,030
whatever device that is so most often

528
00:22:44,260 --> 00:22:47,490
than not some of you would probably fall

529
00:22:46,030 --> 00:22:49,570
for that and they would just click on

530
00:22:47,490 --> 00:22:57,010
that icon and then they would get

531
00:22:49,570 --> 00:23:00,610
infected with the minor as well so so

532
00:22:57,010 --> 00:23:02,050
this is the clipboard replacement

533
00:23:00,610 --> 00:23:03,820
functionality so here they're just

534
00:23:02,050 --> 00:23:04,840
monitoring the the clipboard they're

535
00:23:03,820 --> 00:23:06,970
just getting the contents of that

536
00:23:04,840 --> 00:23:08,800
clipboard in a loop within a separate

537
00:23:06,970 --> 00:23:11,590
thread and then they're just looking for

538
00:23:08,800 --> 00:23:13,480
a number of heuristics it's really basic

539
00:23:11,590 --> 00:23:15,310
like I think the one that I put on there

540
00:23:13,480 --> 00:23:18,670
in this case it's literally looking for

541
00:23:15,310 --> 00:23:20,080
the number two in in your clipboard and

542
00:23:18,670 --> 00:23:22,300
then they'll replace it with this

543
00:23:20,080 --> 00:23:23,429
corresponding address that looks a

544
00:23:22,300 --> 00:23:27,940
little bit similar

545
00:23:23,430 --> 00:23:29,470
so really basic but I think this is

546
00:23:27,940 --> 00:23:31,120
pretty effective in most scenarios for

547
00:23:29,470 --> 00:23:36,340
most people that are dealing with crypto

548
00:23:31,120 --> 00:23:38,590
currency so this eventually drops a

549
00:23:36,340 --> 00:23:43,120
minor so it downloads and executes a

550
00:23:38,590 --> 00:23:45,310
minor over HTTP and what's some

551
00:23:43,120 --> 00:23:47,139
interesting functionality is with the

552
00:23:45,310 --> 00:23:52,750
minor itself is it will actually map

553
00:23:47,140 --> 00:23:54,460
ntdll functions itself so this is this

554
00:23:52,750 --> 00:23:57,580
is kind of unique in that a lot of

555
00:23:54,460 --> 00:24:00,160
antivirus products will be hooking user

556
00:23:57,580 --> 00:24:01,780
lines functions that are commonly used

557
00:24:00,160 --> 00:24:04,260
by applications and not necessarily

558
00:24:01,780 --> 00:24:08,490
those that are with an NT DLL which are

559
00:24:04,260 --> 00:24:11,260
undocumented windows API functions and

560
00:24:08,490 --> 00:24:13,270
they will not mine if you have task

561
00:24:11,260 --> 00:24:16,600
manager dot exe open so I thought that

562
00:24:13,270 --> 00:24:18,400
was kind of kind of cool so if you if

563
00:24:16,600 --> 00:24:19,360
your CPU spikes and you're like what the

564
00:24:18,400 --> 00:24:23,140
hell and then you open task manager

565
00:24:19,360 --> 00:24:25,209
it'll just stop mining so that was

566
00:24:23,140 --> 00:24:27,910
pretty cool and then they drop it config

567
00:24:25,210 --> 00:24:29,680
as well so when I alluded to those

568
00:24:27,910 --> 00:24:32,440
arguments earlier that you could look

569
00:24:29,680 --> 00:24:34,690
for within your Windows Event log er in

570
00:24:32,440 --> 00:24:36,550
this case you can't look for those

571
00:24:34,690 --> 00:24:41,350
because they have the config stored in a

572
00:24:36,550 --> 00:24:43,600
JSON file so this is the task manager

573
00:24:41,350 --> 00:24:46,600
function so it literally just uses the

574
00:24:43,600 --> 00:24:48,250
create tool help 32 snapshot API and

575
00:24:46,600 --> 00:24:49,840
then it just iterates through all the

576
00:24:48,250 --> 00:24:52,000
processes in memory in a loop looking

577
00:24:49,840 --> 00:24:54,790
for task manager txc so it's pretty

578
00:24:52,000 --> 00:24:56,620
basic and then this is that config that

579
00:24:54,790 --> 00:24:58,510
they drop so they have the construct

580
00:24:56,620 --> 00:25:02,139
from a bunch of different pieces in

581
00:24:58,510 --> 00:25:03,460
memory and in this instance the mining

582
00:25:02,140 --> 00:25:08,860
pool they were using was Manero hash

583
00:25:03,460 --> 00:25:11,320
comm unfortunately though they were

584
00:25:08,860 --> 00:25:14,830
banned from that pool when I got to it

585
00:25:11,320 --> 00:25:16,030
so that was unfortunate I was really

586
00:25:14,830 --> 00:25:20,020
looking forward to seeing how much money

587
00:25:16,030 --> 00:25:22,060
they made but in this instance somebody

588
00:25:20,020 --> 00:25:24,970
reported this address and as you can see

589
00:25:22,060 --> 00:25:30,610
the address has been bent due to botnet

590
00:25:24,970 --> 00:25:32,320
mining activity so cool yeah so as blue

591
00:25:30,610 --> 00:25:35,050
team's what can you do about Mouse spam

592
00:25:32,320 --> 00:25:36,939
well if you can I would just disable

593
00:25:35,050 --> 00:25:38,290
macros altogether within Microsoft

594
00:25:36,940 --> 00:25:43,170
Office I know that's not really viable

595
00:25:38,290 --> 00:25:46,450
for most enterprise environments but

596
00:25:43,170 --> 00:25:49,120
some other things you can do is require

597
00:25:46,450 --> 00:25:51,580
signing of those macros so I know again

598
00:25:49,120 --> 00:25:53,709
this is not always viable one thing I

599
00:25:51,580 --> 00:25:57,760
would suggest doing is disabling ActiveX

600
00:25:53,710 --> 00:26:01,540
controls from macros and you can do that

601
00:25:57,760 --> 00:26:03,129
in this blog post and when noticed

602
00:26:01,540 --> 00:26:05,500
effective defender exploit guard is

603
00:26:03,130 --> 00:26:08,140
really awesome on Windows 10 I did a

604
00:26:05,500 --> 00:26:09,490
talk at b-sides Calgary about a whole

605
00:26:08,140 --> 00:26:12,040
bunch of different malicious document

606
00:26:09,490 --> 00:26:16,270
types and I was kind of grilling

607
00:26:12,040 --> 00:26:18,010
Microsoft on their lack of security

608
00:26:16,270 --> 00:26:19,600
around this but if you can install

609
00:26:18,010 --> 00:26:21,070
Windows 10 in your environment and you

610
00:26:19,600 --> 00:26:24,399
can enable all this different

611
00:26:21,070 --> 00:26:25,720
functionality in this blog it's just

612
00:26:24,400 --> 00:26:27,460
going to up your security by like ten

613
00:26:25,720 --> 00:26:29,140
times and there's not a whole lot that

614
00:26:27,460 --> 00:26:31,330
you have to do obviously you probably

615
00:26:29,140 --> 00:26:33,310
have to test some compatibility issues

616
00:26:31,330 --> 00:26:36,429
on your gold image and things like that

617
00:26:33,310 --> 00:26:39,929
but it's Windows 10 is really really

618
00:26:36,430 --> 00:26:42,090
awesome from a security perspective so

619
00:26:39,930 --> 00:26:45,010
scripts

620
00:26:42,090 --> 00:26:47,199
just set up some default handlers for

621
00:26:45,010 --> 00:26:48,910
all these different file types like you

622
00:26:47,200 --> 00:26:50,710
can literally just set it so if somebody

623
00:26:48,910 --> 00:26:53,710
double clicks on a dot GS file it just

624
00:26:50,710 --> 00:26:55,690
opens a notepad instead of executing

625
00:26:53,710 --> 00:26:57,850
commands it's really really basic stuff

626
00:26:55,690 --> 00:26:59,320
that not a lot of people do and they can

627
00:26:57,850 --> 00:27:02,409
just avoid these talks altogether but

628
00:26:59,320 --> 00:27:04,059
attacks all together by doing this I'd

629
00:27:02,410 --> 00:27:07,440
also suggest checking out like app

630
00:27:04,059 --> 00:27:10,629
Locker and software restriction policy

631
00:27:07,440 --> 00:27:12,309
these are a means of restricting where

632
00:27:10,630 --> 00:27:14,500
executables can you execute with your

633
00:27:12,309 --> 00:27:16,660
environment in this instance this entire

634
00:27:14,500 --> 00:27:19,120
talk could have been stopped by just not

635
00:27:16,660 --> 00:27:21,970
allowing this thing to drop in tempo

636
00:27:19,120 --> 00:27:24,189
next Q like well like how many times are

637
00:27:21,970 --> 00:27:26,380
legitimate or how many legitimate use

638
00:27:24,190 --> 00:27:29,020
cases are there for executing binaries

639
00:27:26,380 --> 00:27:33,160
and slash temp right it's not a whole

640
00:27:29,020 --> 00:27:38,590
lot so that's what I'd suggest take a

641
00:27:33,160 --> 00:27:43,780
look at those so another way that these

642
00:27:38,590 --> 00:27:45,520
are infecting environments is via remote

643
00:27:43,780 --> 00:27:47,740
and local code execution so this is

644
00:27:45,520 --> 00:27:49,750
actually making use of available

645
00:27:47,740 --> 00:27:51,190
exploits more often than not I don't

646
00:27:49,750 --> 00:27:55,150
believe I've seen a zero-day being used

647
00:27:51,190 --> 00:27:58,260
for spreading crypto miners to to spread

648
00:27:55,150 --> 00:28:02,830
them so some remote code execution

649
00:27:58,260 --> 00:28:04,540
examples are V s and B so eternal blue

650
00:28:02,830 --> 00:28:05,980
yes there are still machines on the

651
00:28:04,540 --> 00:28:10,149
internet that are vulnerable to eternal

652
00:28:05,980 --> 00:28:12,460
blue Apache struts and Oracle WebLogic

653
00:28:10,150 --> 00:28:15,070
so in our great keynote this morning

654
00:28:12,460 --> 00:28:17,679
kind of alluded some internet-facing

655
00:28:15,070 --> 00:28:20,309
applications that are very commonly

656
00:28:17,679 --> 00:28:22,990
exploited and those are some of them and

657
00:28:20,309 --> 00:28:26,350
local command execution or code

658
00:28:22,990 --> 00:28:27,880
execution so an example of this which

659
00:28:26,350 --> 00:28:32,139
can also be found on that malware

660
00:28:27,880 --> 00:28:34,559
traffic analysis site is rig which is a

661
00:28:32,140 --> 00:28:38,590
very common exploit kit was dropping a

662
00:28:34,559 --> 00:28:41,970
crypto miner via a flash exploit so

663
00:28:38,590 --> 00:28:46,389
let's look at a remote code execution

664
00:28:41,970 --> 00:28:47,710
example in this instance it was some

665
00:28:46,390 --> 00:28:50,620
pretty rudimentary malware that was

666
00:28:47,710 --> 00:28:52,190
written in Python and basically they

667
00:28:50,620 --> 00:28:54,559
just wrapped

668
00:28:52,190 --> 00:28:56,659
a Python wrapper around a bunch of

669
00:28:54,559 --> 00:29:00,320
binaries that were leaked by the shadow

670
00:28:56,659 --> 00:29:01,700
brokers who of you know or actually I

671
00:29:00,320 --> 00:29:05,840
should say who doesn't know who the

672
00:29:01,700 --> 00:29:13,159
shadow brokers are or what okay

673
00:29:05,840 --> 00:29:14,959
so last year there was a really weird

674
00:29:13,159 --> 00:29:16,519
group called the shadow brokers that

675
00:29:14,960 --> 00:29:18,710
started writing all these really odd

676
00:29:16,519 --> 00:29:22,639
medium posts about how they had a bunch

677
00:29:18,710 --> 00:29:23,929
of NSA exploits and they're trying to

678
00:29:22,639 --> 00:29:26,570
sell them for like a million bitcoins

679
00:29:23,929 --> 00:29:29,990
and our million dollars in Bitcoin and

680
00:29:26,570 --> 00:29:32,269
nobody really took them up on that offer

681
00:29:29,990 --> 00:29:34,580
and do you do too some world events they

682
00:29:32,269 --> 00:29:38,539
leak these binaries and I should say

683
00:29:34,580 --> 00:29:41,299
these are alleged NSA binaries and these

684
00:29:38,539 --> 00:29:46,908
were fairly short shortly after these

685
00:29:41,299 --> 00:29:48,769
were instrumented by by a well now we

686
00:29:46,909 --> 00:29:51,019
know it's a nation-state based on what

687
00:29:48,769 --> 00:29:55,730
happened last week so a North Korean was

688
00:29:51,019 --> 00:29:58,549
indicted with charges on programming

689
00:29:55,730 --> 00:30:00,139
wanna cry which is a worm that was

690
00:29:58,549 --> 00:30:03,769
propagating across the internet last May

691
00:30:00,139 --> 00:30:06,019
and basically did the u.s. government

692
00:30:03,769 --> 00:30:08,059
attributed that I talked to him but

693
00:30:06,019 --> 00:30:12,259
basically they used these binaries that

694
00:30:08,059 --> 00:30:14,769
were allegedly NSA derived in order to

695
00:30:12,259 --> 00:30:18,230
spread this malware across the internet

696
00:30:14,769 --> 00:30:20,629
so this piece of mining district

697
00:30:18,230 --> 00:30:22,730
distribution malware also uses the same

698
00:30:20,629 --> 00:30:26,269
binary x' and that's referred to as

699
00:30:22,730 --> 00:30:30,080
eternal blue and it will perform

700
00:30:26,269 --> 00:30:32,059
scanning of your local of your local

701
00:30:30,080 --> 00:30:33,769
network and it will look at random

702
00:30:32,059 --> 00:30:36,230
remote addresses and I'll show you how

703
00:30:33,769 --> 00:30:39,679
that functionality works basically if it

704
00:30:36,230 --> 00:30:43,490
finds a an SMB port that's open it will

705
00:30:39,679 --> 00:30:45,710
attempt to exploit it so this is the

706
00:30:43,490 --> 00:30:47,450
Python so basically how this works on

707
00:30:45,710 --> 00:30:49,820
Windows is you can actually use

708
00:30:47,450 --> 00:30:52,370
something like PI to exe to distribute

709
00:30:49,820 --> 00:30:54,860
Python and this will be executed by a

710
00:30:52,370 --> 00:30:57,889
Python interpreter that's provided with

711
00:30:54,860 --> 00:30:59,779
the binary so in this instance this is

712
00:30:57,889 --> 00:31:03,258
the local scanning literally all this

713
00:30:59,779 --> 00:31:05,630
the red does well it will gather a bunch

714
00:31:03,259 --> 00:31:08,960
of ip's your slash 20 run

715
00:31:05,630 --> 00:31:10,760
range on your local subnet and then this

716
00:31:08,960 --> 00:31:13,100
thread will just look if the port is

717
00:31:10,760 --> 00:31:15,740
open and then it will attempt to exploit

718
00:31:13,100 --> 00:31:17,570
it this is their remote scanning

719
00:31:15,740 --> 00:31:19,400
functionality basically what this does

720
00:31:17,570 --> 00:31:21,379
is it reads this text file and I'll show

721
00:31:19,400 --> 00:31:25,310
you what that looks like and then it

722
00:31:21,380 --> 00:31:28,610
will basically choose a list of 30 IP

723
00:31:25,310 --> 00:31:30,889
addresses to attempt to exploit within a

724
00:31:28,610 --> 00:31:32,360
separate thread and this is what that

725
00:31:30,890 --> 00:31:34,820
text file looks like so it's a whole

726
00:31:32,360 --> 00:31:37,040
bunch of different IP ranges I didn't

727
00:31:34,820 --> 00:31:39,409
really look into this too closely but my

728
00:31:37,040 --> 00:31:42,490
guess is that they probably wanted to

729
00:31:39,410 --> 00:31:44,630
limit their remote targets to

730
00:31:42,490 --> 00:31:47,390
non-government entities and things like

731
00:31:44,630 --> 00:31:49,100
that but I'm assuming this is why they

732
00:31:47,390 --> 00:31:53,450
don't just choose a IPS at random and

733
00:31:49,100 --> 00:31:55,100
it's tend to exploit them so this is

734
00:31:53,450 --> 00:32:00,170
really rudimentary malware but it's

735
00:31:55,100 --> 00:32:02,480
pretty funny so they will look to see if

736
00:32:00,170 --> 00:32:03,890
it is vulnerable to eternal blue by

737
00:32:02,480 --> 00:32:05,570
using this eternal blue function and

738
00:32:03,890 --> 00:32:09,050
I'll show you what that looks like and

739
00:32:05,570 --> 00:32:11,600
basically they'll return if it's if it's

740
00:32:09,050 --> 00:32:15,080
good and then an architecture then that

741
00:32:11,600 --> 00:32:18,830
means it's exploitable so if it's x86

742
00:32:15,080 --> 00:32:22,460
they'll use a 64-bit version of their

743
00:32:18,830 --> 00:32:24,409
DLL and if it's an x86 version they'll

744
00:32:22,460 --> 00:32:27,560
use that version so I'll show you what

745
00:32:24,410 --> 00:32:29,540
that DLL does so this is what that

746
00:32:27,560 --> 00:32:32,000
eternal blue function does so it

747
00:32:29,540 --> 00:32:35,930
literally just provides the parameters

748
00:32:32,000 --> 00:32:37,640
into this eternal blue executable so

749
00:32:35,930 --> 00:32:40,190
this is actually the lead executable

750
00:32:37,640 --> 00:32:42,860
from the shadow brokers and this is how

751
00:32:40,190 --> 00:32:44,480
easy this stuff is to use right so you

752
00:32:42,860 --> 00:32:47,719
can provide a target IP address as a

753
00:32:44,480 --> 00:32:49,580
parameter and then some other parameters

754
00:32:47,720 --> 00:32:52,730
for the supported architectures and then

755
00:32:49,580 --> 00:32:54,470
just run it against the remote IP or

756
00:32:52,730 --> 00:32:57,190
local IP of assistance

757
00:32:54,470 --> 00:33:00,110
so yeah super easy to use these tools

758
00:32:57,190 --> 00:33:02,480
which kind of makes sense for who from

759
00:33:00,110 --> 00:33:05,270
based on pre develop them but basically

760
00:33:02,480 --> 00:33:08,930
they'll just look for these strings and

761
00:33:05,270 --> 00:33:14,150
if it's vulnerable then they will return

762
00:33:08,930 --> 00:33:16,130
what architecture it was so for those of

763
00:33:14,150 --> 00:33:16,550
you who are not familiar with these

764
00:33:16,130 --> 00:33:18,870
tools

765
00:33:16,550 --> 00:33:20,550
there was an implant upon

766
00:33:18,870 --> 00:33:23,040
successful exploitation of maternal blue

767
00:33:20,550 --> 00:33:25,050
called double pulsar and this implant

768
00:33:23,040 --> 00:33:27,930
allowed you to migrate from kernel

769
00:33:25,050 --> 00:33:30,270
address space into user lines and in

770
00:33:27,930 --> 00:33:33,930
this instance they're just providing L

771
00:33:30,270 --> 00:33:37,889
SAS as the default process to migrate

772
00:33:33,930 --> 00:33:41,010
into and then they're providing that

773
00:33:37,890 --> 00:33:43,530
yellow that I referenced earlier so

774
00:33:41,010 --> 00:33:48,030
let's look at what that deal looks like

775
00:33:43,530 --> 00:33:50,730
so literally all the DLL does that they

776
00:33:48,030 --> 00:33:53,428
ship with double pulsar upon successful

777
00:33:50,730 --> 00:33:56,610
exploitation is it will reach out to

778
00:33:53,429 --> 00:34:02,670
this dot ru domain and then download a

779
00:33:56,610 --> 00:34:05,669
minor binary and then this is the mining

780
00:34:02,670 --> 00:34:07,740
config for that final mining payload so

781
00:34:05,670 --> 00:34:09,960
again they're using a config file in

782
00:34:07,740 --> 00:34:12,360
this case to probably avoid using those

783
00:34:09,960 --> 00:34:14,460
command-line arguments but as you can

784
00:34:12,360 --> 00:34:16,290
see this is actually a pool a pool they

785
00:34:14,460 --> 00:34:23,159
rolled themselves this is not a public

786
00:34:16,290 --> 00:34:26,090
pool cool so from my local code

787
00:34:23,159 --> 00:34:28,980
execution perspective for blue team's

788
00:34:26,090 --> 00:34:29,429
update your stuff it's not rocket

789
00:34:28,980 --> 00:34:32,399
science

790
00:34:29,429 --> 00:34:33,540
I know I know it's not always viable in

791
00:34:32,399 --> 00:34:35,100
corporate environments I know you guys

792
00:34:33,540 --> 00:34:36,980
have gold images and you have to test

793
00:34:35,100 --> 00:34:39,270
stuff and make sure everything's working

794
00:34:36,980 --> 00:34:41,940
kind of some more defense and depth

795
00:34:39,270 --> 00:34:45,300
stuff that you can do like disable flash

796
00:34:41,940 --> 00:34:46,918
and Java plugins they really don't have

797
00:34:45,300 --> 00:34:51,210
to be enabled all the time at the very

798
00:34:46,918 --> 00:34:53,790
least if you can do click to play that's

799
00:34:51,210 --> 00:34:55,889
a super good way of doing it especially

800
00:34:53,790 --> 00:34:59,100
like even at home for your loved ones

801
00:34:55,889 --> 00:35:00,630
like disabling things so you can just

802
00:34:59,100 --> 00:35:04,890
click on them and enable them when they

803
00:35:00,630 --> 00:35:07,050
need to be that's a really good way most

804
00:35:04,890 --> 00:35:08,910
modern browsers like Chrome it's really

805
00:35:07,050 --> 00:35:10,680
good for sandboxing most of these

806
00:35:08,910 --> 00:35:13,920
applications that are notoriously bad

807
00:35:10,680 --> 00:35:16,890
for for exploits so they sandbox flash

808
00:35:13,920 --> 00:35:18,510
and they sandbox their PDF reader as

809
00:35:16,890 --> 00:35:20,279
well so even if they're able to gain

810
00:35:18,510 --> 00:35:23,100
initial code execution within your

811
00:35:20,280 --> 00:35:24,510
browser they like they highly limit the

812
00:35:23,100 --> 00:35:26,130
amount of api's that are available from

813
00:35:24,510 --> 00:35:27,720
that sandbox environment and they can't

814
00:35:26,130 --> 00:35:29,910
necessarily escape that sandbox and

815
00:35:27,720 --> 00:35:31,919
break in to your to your computer

816
00:35:29,910 --> 00:35:32,609
not all exploits require sandbox escape

817
00:35:31,920 --> 00:35:34,110
but

818
00:35:32,610 --> 00:35:37,410
it sets the bar like that much higher

819
00:35:34,110 --> 00:35:39,780
and if you can find a remote code

820
00:35:37,410 --> 00:35:41,029
execution vulnerability or sorry a local

821
00:35:39,780 --> 00:35:43,680
code execution vulnerability in Chrome

822
00:35:41,030 --> 00:35:46,260
it's worth a lot of money so that kind

823
00:35:43,680 --> 00:35:47,669
of shows you like how how high the bar

824
00:35:46,260 --> 00:35:51,330
gets set by these kinds of modern

825
00:35:47,670 --> 00:35:52,940
browsers windows to finder exploit

826
00:35:51,330 --> 00:35:55,410
got'em gonna keep like selling this

827
00:35:52,940 --> 00:35:57,930
Windows 10 again

828
00:35:55,410 --> 00:36:02,460
this is essentially what he met turned

829
00:35:57,930 --> 00:36:04,049
into so II met essentially was a

830
00:36:02,460 --> 00:36:07,260
external application that was developed

831
00:36:04,050 --> 00:36:09,510
by Microsoft to stop a whole bunch of

832
00:36:07,260 --> 00:36:11,160
different memory corruption

833
00:36:09,510 --> 00:36:12,960
vulnerabilities from being exploited on

834
00:36:11,160 --> 00:36:14,160
Windows so they'll stop things like rob

835
00:36:12,960 --> 00:36:15,960
chains and a whole bunch of these

836
00:36:14,160 --> 00:36:18,240
different exploitation techniques so I'd

837
00:36:15,960 --> 00:36:19,650
highly encourage you to check that out

838
00:36:18,240 --> 00:36:23,759
or if you're running Windows 7 you can

839
00:36:19,650 --> 00:36:26,940
still run older versions of email okay

840
00:36:23,760 --> 00:36:29,100
so for the remote code execution stuff I

841
00:36:26,940 --> 00:36:30,900
really like this blog that I'll chem

842
00:36:29,100 --> 00:36:34,500
tough put out around the shower brokers

843
00:36:30,900 --> 00:36:38,370
stuff at the time when when wanna cry

844
00:36:34,500 --> 00:36:39,840
came out and and ultimately let's face

845
00:36:38,370 --> 00:36:41,520
it if you're scrambling to lock down

846
00:36:39,840 --> 00:36:43,200
your internet exposed SMB servers in

847
00:36:41,520 --> 00:36:44,790
response to the recent revelations from

848
00:36:43,200 --> 00:36:46,290
shadow brokers you're probably in

849
00:36:44,790 --> 00:36:49,980
trouble and it's not because of the NSA

850
00:36:46,290 --> 00:36:53,820
so if you have SMB services facing the

851
00:36:49,980 --> 00:36:55,350
Internet don't like you really really

852
00:36:53,820 --> 00:36:57,300
don't need to have them facing the

853
00:36:55,350 --> 00:37:00,299
Internet even if you have like a Remote

854
00:36:57,300 --> 00:37:03,570
Desktop Protocol environment just have

855
00:37:00,300 --> 00:37:05,640
that port facing Internet and if you can

856
00:37:03,570 --> 00:37:09,180
really help it don't have any wrote

857
00:37:05,640 --> 00:37:10,980
desktop clients or sorry servers facing

858
00:37:09,180 --> 00:37:15,419
the Internet you really don't need them

859
00:37:10,980 --> 00:37:16,860
just have a VPN service and that's this

860
00:37:15,420 --> 00:37:19,860
is what literally every large company

861
00:37:16,860 --> 00:37:21,210
does is they have a VPN service that you

862
00:37:19,860 --> 00:37:22,710
connect into you then you have access to

863
00:37:21,210 --> 00:37:24,960
all your internal resources you don't

864
00:37:22,710 --> 00:37:27,510
even need a facing a wet sorry a public

865
00:37:24,960 --> 00:37:32,250
facing intranet or anything like that

866
00:37:27,510 --> 00:37:35,190
just really have a VPN service ask

867
00:37:32,250 --> 00:37:38,810
yourself like does this service need to

868
00:37:35,190 --> 00:37:40,080
be facing the internet like does this I

869
00:37:38,810 --> 00:37:41,580
don't know

870
00:37:40,080 --> 00:37:42,720
industrial control system you need to be

871
00:37:41,580 --> 00:37:44,040
facing the internet like these are

872
00:37:42,720 --> 00:37:47,209
literally questions people ask

873
00:37:44,040 --> 00:37:47,210
themselves and they still do it

874
00:37:47,430 --> 00:37:52,589
so and then minimize your public facing

875
00:37:49,830 --> 00:37:55,470
services so kind of that's the overall

876
00:37:52,590 --> 00:37:59,310
arching goal of this ensure proper

877
00:37:55,470 --> 00:38:02,759
configuration so there is there was a

878
00:37:59,310 --> 00:38:07,109
big push over the recent years for no

879
00:38:02,760 --> 00:38:08,730
sequel databases like [ __ ] and I hate

880
00:38:07,109 --> 00:38:10,880
this stuff because you have these sales

881
00:38:08,730 --> 00:38:13,560
guys who walk into health organizations

882
00:38:10,880 --> 00:38:15,119
and government organizations and they

883
00:38:13,560 --> 00:38:16,230
were like hey use this new database and

884
00:38:15,119 --> 00:38:18,510
they don't know why but they buy it

885
00:38:16,230 --> 00:38:20,369
anyways and then the default

886
00:38:18,510 --> 00:38:22,770
configuration in [ __ ] I'm not sure if

887
00:38:20,369 --> 00:38:24,660
this is still the case is no

888
00:38:22,770 --> 00:38:28,590
authentication so literally you have

889
00:38:24,660 --> 00:38:30,629
like all these internet facing databases

890
00:38:28,590 --> 00:38:32,250
full of health records and and you'll

891
00:38:30,630 --> 00:38:34,770
see like so many news stories about all

892
00:38:32,250 --> 00:38:37,140
these misconfigured services like

893
00:38:34,770 --> 00:38:38,730
there's literally no security

894
00:38:37,140 --> 00:38:40,080
vulnerability here other than miss

895
00:38:38,730 --> 00:38:41,220
configuration and the person who set it

896
00:38:40,080 --> 00:38:44,340
up didn't know what they were doing they

897
00:38:41,220 --> 00:38:46,290
made it face the internet so like it's

898
00:38:44,340 --> 00:38:50,640
literally as trivial as that most of the

899
00:38:46,290 --> 00:38:51,990
time defense and depth stuff most of the

900
00:38:50,640 --> 00:38:56,640
people in this room should hopefully

901
00:38:51,990 --> 00:38:59,189
know a lot of these concepts like

902
00:38:56,640 --> 00:39:00,900
practice least privilege the service

903
00:38:59,190 --> 00:39:02,730
that's facing the internet does not need

904
00:39:00,900 --> 00:39:06,170
to be running as root they don't need to

905
00:39:02,730 --> 00:39:08,700
have su privileges they don't need to be

906
00:39:06,170 --> 00:39:11,280
they don't need to have access to the

907
00:39:08,700 --> 00:39:13,830
internal environment try and minimize

908
00:39:11,280 --> 00:39:15,660
your pivots like there should really be

909
00:39:13,830 --> 00:39:17,160
no public facing services that have

910
00:39:15,660 --> 00:39:18,750
access to internal resources that they

911
00:39:17,160 --> 00:39:20,640
don't need obviously if it's a public

912
00:39:18,750 --> 00:39:22,530
facing service with a back-end like a

913
00:39:20,640 --> 00:39:25,819
database you can create an interface for

914
00:39:22,530 --> 00:39:29,150
that they really don't need to be facing

915
00:39:25,820 --> 00:39:30,900
having access to things like HR or

916
00:39:29,150 --> 00:39:34,290
accounting or other parts of your

917
00:39:30,900 --> 00:39:36,060
company Network segregation like there's

918
00:39:34,290 --> 00:39:37,560
still giant companies who have flat

919
00:39:36,060 --> 00:39:39,299
networks and it like boggles my mind

920
00:39:37,560 --> 00:39:40,440
like I have a lot of friends who are pen

921
00:39:39,300 --> 00:39:41,730
testers and they're like yeah man I

922
00:39:40,440 --> 00:39:43,560
finished that engagement in like an hour

923
00:39:41,730 --> 00:39:45,390
and I'm like what how and they're like

924
00:39:43,560 --> 00:39:47,730
oh I just like went into the network and

925
00:39:45,390 --> 00:39:49,170
I popped ad by like using relay and then

926
00:39:47,730 --> 00:39:51,839
I got an admin hash and like all this

927
00:39:49,170 --> 00:39:53,369
stuff and they you can literally destroy

928
00:39:51,839 --> 00:39:55,440
these environments in seconds because

929
00:39:53,369 --> 00:39:56,970
they're just flat networks that use

930
00:39:55,440 --> 00:39:58,809
Active Directory with old versions of

931
00:39:56,970 --> 00:40:02,939
SMB and it's still like super

932
00:39:58,809 --> 00:40:05,349
to do all these things in 2018 so

933
00:40:02,939 --> 00:40:08,199
implement Network segregation and if you

934
00:40:05,349 --> 00:40:10,419
can just put every public service within

935
00:40:08,199 --> 00:40:14,069
India TM said that doesn't have access

936
00:40:10,419 --> 00:40:17,189
to any of your other network resources

937
00:40:14,069 --> 00:40:21,009
so that's pretty much all I had I know I

938
00:40:17,189 --> 00:40:24,848
did pretty good for time but I just

939
00:40:21,009 --> 00:40:26,319
wanted to give some shouts so jello

940
00:40:24,849 --> 00:40:27,969
snake I'm probably pronouncing it's

941
00:40:26,319 --> 00:40:30,519
handle wrong I did some really good work

942
00:40:27,969 --> 00:40:35,229
in this area he's a researcher I Minerva

943
00:40:30,519 --> 00:40:37,479
labs and he did these two b-sides talks

944
00:40:35,229 --> 00:40:40,899
on YouTube which were really good as

945
00:40:37,479 --> 00:40:44,368
well I got some of my resources from him

946
00:40:40,900 --> 00:40:46,779
Brad at traffic our traffic analysis

947
00:40:44,369 --> 00:40:50,979
what I did this talk I wanted to do it

948
00:40:46,779 --> 00:40:52,839
from my personal research rather than

949
00:40:50,979 --> 00:40:55,808
through work because I was going through

950
00:40:52,839 --> 00:40:58,419
some changes at the time and he provided

951
00:40:55,809 --> 00:40:59,859
a really good way of just getting access

952
00:40:58,419 --> 00:41:03,459
to those samples that I went through

953
00:40:59,859 --> 00:41:08,019
today 0.1 he or she has a really good

954
00:41:03,459 --> 00:41:11,469
job at updating this blocker list and it

955
00:41:08,019 --> 00:41:13,948
provides a means of the rest of us to

956
00:41:11,469 --> 00:41:16,539
block a large amount of the

957
00:41:13,949 --> 00:41:17,979
cryptocurrency related domains that

958
00:41:16,539 --> 00:41:22,239
could be using it variously within

959
00:41:17,979 --> 00:41:24,868
corporate environments cool I think we

960
00:41:22,239 --> 00:41:27,130
have a little bit of time for questions

961
00:41:24,869 --> 00:41:32,799
so there's my boy biggie

962
00:41:27,130 --> 00:41:34,659
rest in peace so if there are any

963
00:41:32,799 --> 00:41:36,609
questions just raise your hand oh

964
00:41:34,659 --> 00:41:39,849
there's some questions over here perfect

965
00:41:36,609 --> 00:41:46,479
oh yeah and this is my source is the

966
00:41:39,849 --> 00:41:48,249
source was fine hello

967
00:41:46,479 --> 00:41:49,989
you mentioned that in one of the

968
00:41:48,249 --> 00:41:51,928
exploits they went from JavaScript of

969
00:41:49,989 --> 00:41:54,009
PowerShell could you explain how that

970
00:41:51,929 --> 00:42:01,029
happens yeah

971
00:41:54,009 --> 00:42:02,529
so under Windows there's a there's a

972
00:42:01,029 --> 00:42:04,359
process called a Windows scripting host

973
00:42:02,529 --> 00:42:06,880
and there's also a command line and

974
00:42:04,359 --> 00:42:08,469
scripting house that scripting host was

975
00:42:06,880 --> 00:42:11,950
written by Microsoft they believe to be

976
00:42:08,469 --> 00:42:13,480
able to write a lot of their

977
00:42:11,950 --> 00:42:16,359
or an interface with their operating

978
00:42:13,480 --> 00:42:17,589
system and scripting languages so like

979
00:42:16,359 --> 00:42:20,049
this is completely I know I was

980
00:42:17,589 --> 00:42:21,700
debugging in Chrome but this is when you

981
00:42:20,049 --> 00:42:24,180
when you're executing this on Windows

982
00:42:21,700 --> 00:42:26,259
it's completely external to Chrome and

983
00:42:24,180 --> 00:42:28,000
the windows scripting host will

984
00:42:26,260 --> 00:42:30,970
basically interpret that JavaScript and

985
00:42:28,000 --> 00:42:33,940
then I can send you some code if you

986
00:42:30,970 --> 00:42:36,339
want but basically you can establish an

987
00:42:33,940 --> 00:42:37,660
ActiveX object from that JavaScript so

988
00:42:36,339 --> 00:42:38,769
this is unique to the window scripting

989
00:42:37,660 --> 00:42:42,038
host so they essentially have like a

990
00:42:38,769 --> 00:42:43,598
JavaScript API for themselves and then

991
00:42:42,039 --> 00:42:44,920
once you get that ActiveX object you can

992
00:42:43,599 --> 00:42:47,049
just do like shell execute and then

993
00:42:44,920 --> 00:42:48,760
execute power shell from it yeah it is

994
00:42:47,049 --> 00:42:52,349
like when people started doing this I

995
00:42:48,760 --> 00:42:55,450
was just like what I didn't yeah it's

996
00:42:52,349 --> 00:42:57,099
things are a lot better now I'm like

997
00:42:55,450 --> 00:43:00,490
Windows 10 but it's still fairly trivial

998
00:42:57,099 --> 00:43:01,390
to get code execution on Windows in a

999
00:43:00,490 --> 00:43:02,859
number of different means from

1000
00:43:01,390 --> 00:43:07,480
attachments so this is why it's still

1001
00:43:02,859 --> 00:43:10,690
like people get fished so like I'm I'm

1002
00:43:07,480 --> 00:43:13,019
tracking a large like large remote

1003
00:43:10,690 --> 00:43:16,390
groups right now and like they'll get

1004
00:43:13,019 --> 00:43:19,029
access to be able to jackpot ATMs from

1005
00:43:16,390 --> 00:43:20,529
bag networks from like a fish so that

1006
00:43:19,029 --> 00:43:24,160
literally their initial infection vector

1007
00:43:20,529 --> 00:43:25,269
is just like a JavaScript attachment

1008
00:43:24,160 --> 00:43:26,890
like they'll send like a whole bunch of

1009
00:43:25,269 --> 00:43:29,019
different attachments and then once they

1010
00:43:26,890 --> 00:43:30,879
get one point of code execution on a

1011
00:43:29,019 --> 00:43:33,008
single usual line box and the pivots ad

1012
00:43:30,880 --> 00:43:34,779
and then they'll find like the ATM that

1013
00:43:33,009 --> 00:43:37,390
the ATM banks at the company and then

1014
00:43:34,779 --> 00:43:40,269
they'll like literally cash out and then

1015
00:43:37,390 --> 00:43:48,819
they'll get mules to grab all the cash

1016
00:43:40,269 --> 00:43:51,149
and then yes it's crazy but any more

1017
00:43:48,819 --> 00:43:51,150
questions

1018
00:44:01,520 --> 00:44:05,600
I'm curious what's the general behavior

1019
00:44:03,590 --> 00:44:07,100
of the miners if they find like they

1020
00:44:05,600 --> 00:44:08,810
can't talk to their DNS or whatever do

1021
00:44:07,100 --> 00:44:12,140
they just give up do they do something

1022
00:44:08,810 --> 00:44:13,250
malicious do they wait I yeah that's one

1023
00:44:12,140 --> 00:44:17,509
thing I kind of wanted to look further

1024
00:44:13,250 --> 00:44:20,240
into I believe that they will just not

1025
00:44:17,510 --> 00:44:21,440
mine because if you provide like the

1026
00:44:20,240 --> 00:44:23,750
mining pool parameters and they're

1027
00:44:21,440 --> 00:44:25,850
unable to resolve the the pool I don't

1028
00:44:23,750 --> 00:44:28,370
think there's any point of them mining

1029
00:44:25,850 --> 00:44:30,560
because they don't have a like a an

1030
00:44:28,370 --> 00:44:31,730
actual wallet address to publish to I

1031
00:44:30,560 --> 00:44:33,620
know they have like that command and

1032
00:44:31,730 --> 00:44:34,640
argument but I believe they will just

1033
00:44:33,620 --> 00:44:36,589
know online

1034
00:44:34,640 --> 00:44:38,980
but having said that I haven't tested

1035
00:44:36,590 --> 00:44:38,980
that myself

1036
00:44:40,510 --> 00:44:46,870
any other questions cool awesome Thank

1037
00:44:44,840 --> 00:44:49,920
You Roy

1038
00:44:46,870 --> 00:44:49,920
[Applause]

