1
00:00:02,510 --> 00:00:09,719
welcome thanks guys take it away y'all

2
00:00:05,130 --> 00:00:12,660
can hear me oh we're good yeah oh yeah

3
00:00:09,719 --> 00:00:15,209
so so first things first it's good to

4
00:00:12,660 --> 00:00:16,800
actually see people in the room when I

5
00:00:15,209 --> 00:00:19,050
was looking at the schedule there's a

6
00:00:16,800 --> 00:00:21,029
lot of really really good talks and I

7
00:00:19,050 --> 00:00:23,369
felt a little amateur she was like we're

8
00:00:21,029 --> 00:00:25,619
the ones doing the printer talk like who

9
00:00:23,369 --> 00:00:26,910
gives a about printers really but

10
00:00:25,619 --> 00:00:29,310
that was that was one of the reasons we

11
00:00:26,910 --> 00:00:30,810
wanted to do this regardless of what

12
00:00:29,310 --> 00:00:32,610
your opinions are about the best brand

13
00:00:30,810 --> 00:00:34,710
of phone or the best operating system or

14
00:00:32,610 --> 00:00:36,329
the best anything printers are that one

15
00:00:34,710 --> 00:00:39,059
thing we can all unite behind and be

16
00:00:36,329 --> 00:00:41,180
like these things suck so we're gonna

17
00:00:39,059 --> 00:00:44,039
add a whole bunch of pile to that sock

18
00:00:41,180 --> 00:00:46,320
and secondly on a serious note like

19
00:00:44,039 --> 00:00:47,760
printers are a part of all of us all of

20
00:00:46,320 --> 00:00:50,100
our environments we all have and we use

21
00:00:47,760 --> 00:00:51,870
them act as a multifunction printer just

22
00:00:50,100 --> 00:00:53,280
on floor to outside this building after

23
00:00:51,870 --> 00:00:57,570
you see our talk you're gonna walk by

24
00:00:53,280 --> 00:00:59,609
that and be like rekt so that's kind of

25
00:00:57,570 --> 00:01:02,840
our intro here so so how we got to doing

26
00:00:59,609 --> 00:01:05,369
this Oh Frick back in like February

27
00:01:02,840 --> 00:01:07,080
someone I work with canceled a meeting

28
00:01:05,369 --> 00:01:09,600
which meant I suddenly had an hour of

29
00:01:07,080 --> 00:01:11,729
free time which was quite rare and I had

30
00:01:09,600 --> 00:01:13,830
to do a whole bunch of paperwork and I

31
00:01:11,729 --> 00:01:15,060
ended up printing something and and we

32
00:01:13,830 --> 00:01:18,450
use this this this thing it's called

33
00:01:15,060 --> 00:01:20,250
secure print where you you have a pin

34
00:01:18,450 --> 00:01:21,750
right you know one two three four or

35
00:01:20,250 --> 00:01:23,970
whatever is your debit card the same

36
00:01:21,750 --> 00:01:25,259
thing and and when you send your print

37
00:01:23,970 --> 00:01:26,640
job to the printer the printer doesn't

38
00:01:25,259 --> 00:01:27,930
automatically print it if you use the

39
00:01:26,640 --> 00:01:30,659
care frame the printer holds on to it

40
00:01:27,930 --> 00:01:33,659
until you enter your your PIN then it

41
00:01:30,659 --> 00:01:35,250
releases it and if you're gonna use a

42
00:01:33,659 --> 00:01:37,380
product that has the word secure in the

43
00:01:35,250 --> 00:01:39,390
title and you give someone on my team an

44
00:01:37,380 --> 00:01:41,039
hour free time we're gonna have quite a

45
00:01:39,390 --> 00:01:43,770
bit of fun with it so we're going to

46
00:01:41,040 --> 00:01:44,939
talk today about some practical attacks

47
00:01:43,770 --> 00:01:46,259
against printers there's there's no

48
00:01:44,939 --> 00:01:47,969
there's no theory today everything we're

49
00:01:46,259 --> 00:01:49,170
talking about we've done you can do it

50
00:01:47,969 --> 00:01:50,610
too sometimes it's a matter of just

51
00:01:49,170 --> 00:01:52,770
spending 60 bucks on the internet and

52
00:01:50,610 --> 00:01:54,299
having a go with it but a real quick

53
00:01:52,770 --> 00:01:55,710
intro if you want to learn more about

54
00:01:54,299 --> 00:01:56,790
the bullet points just find me later I'm

55
00:01:55,710 --> 00:01:58,439
not gonna go through it but I do want to

56
00:01:56,790 --> 00:02:00,899
highlight the bottom one here a total

57
00:01:58,439 --> 00:02:02,279
total plug to the home team Nate alumni

58
00:02:00,899 --> 00:02:04,189
as well graduated from the computer

59
00:02:02,280 --> 00:02:06,899
network admin course back in 2008

60
00:02:04,189 --> 00:02:09,690
honestly it was a great course it taught

61
00:02:06,899 --> 00:02:11,310
me so much stuff it humbled me like

62
00:02:09,690 --> 00:02:13,350
crazy I went into that course being like

63
00:02:11,310 --> 00:02:14,330
I know everything about computers and a

64
00:02:13,350 --> 00:02:17,030
week later I was like

65
00:02:14,330 --> 00:02:19,040
you know jack-shit about computers and

66
00:02:17,030 --> 00:02:21,680
I'm also on the base advisory program

67
00:02:19,040 --> 00:02:23,329
what is the base Advisory Group council

68
00:02:21,680 --> 00:02:24,950
membership whatever its its industry

69
00:02:23,330 --> 00:02:32,660
advisors who advise innate on the course

70
00:02:24,950 --> 00:02:35,060
of some of their projects and sorry this

71
00:02:32,660 --> 00:02:36,720
is my very first presentation so just

72
00:02:35,060 --> 00:02:38,830
bear with me thank you I appreciate that

73
00:02:36,720 --> 00:02:41,900
[Applause]

74
00:02:38,830 --> 00:02:43,520
so I'm Zoe I work at secured net

75
00:02:41,900 --> 00:02:45,290
solutions we're a small local company

76
00:02:43,520 --> 00:02:48,140
based out of Calgary it's just sometimes

77
00:02:45,290 --> 00:02:49,880
likes to throw stuff in the xx slack and

78
00:02:48,140 --> 00:02:51,859
I'm like cool a puzzle

79
00:02:49,880 --> 00:02:54,769
I've also doesn't work with Brenneman's

80
00:02:51,860 --> 00:02:56,630
Internet of Dawn's project where he did

81
00:02:54,770 --> 00:02:58,520
some security auditing on internet

82
00:02:56,630 --> 00:03:02,209
connected sex toys so that's what DVDs

83
00:02:58,520 --> 00:03:03,320
are I don't have any C's yet but she

84
00:03:02,209 --> 00:03:05,480
also check out that talk tomorrow

85
00:03:03,320 --> 00:03:07,280
afternoon he's doing a whole talk on a

86
00:03:05,480 --> 00:03:09,530
bunch of things and that is in there and

87
00:03:07,280 --> 00:03:12,200
allegedly I could fit 16 marshmallows in

88
00:03:09,530 --> 00:03:14,330
my mouth I there's no video or photo

89
00:03:12,200 --> 00:03:15,739
evidence and I don't know how that is

90
00:03:14,330 --> 00:03:17,510
because we all have smartphones and when

91
00:03:15,740 --> 00:03:19,850
someone says hold my beer I'm going o

92
00:03:17,510 --> 00:03:23,030
get my phone first you know make sure I

93
00:03:19,850 --> 00:03:24,350
get this on if anybody actually has 16

94
00:03:23,030 --> 00:03:26,450
marshmallows fine because there's

95
00:03:24,350 --> 00:03:27,920
something we need to settle together and

96
00:03:26,450 --> 00:03:31,970
also I will be leaving right after this

97
00:03:27,920 --> 00:03:34,280
talk so all right so here's how we got

98
00:03:31,970 --> 00:03:35,690
here or the quick agenda for today we'll

99
00:03:34,280 --> 00:03:36,739
just do a little bit of discussion get

100
00:03:35,690 --> 00:03:37,760
everyone on the same page about around

101
00:03:36,739 --> 00:03:40,040
printers and what our general knowledge

102
00:03:37,760 --> 00:03:41,600
is encrypt all the things that we know

103
00:03:40,040 --> 00:03:42,650
encryption is important uh-huh we're

104
00:03:41,600 --> 00:03:43,970
gonna show you guys what happens when

105
00:03:42,650 --> 00:03:45,320
you don't encrypt or print jobs which I

106
00:03:43,970 --> 00:03:46,370
would bet very many of you are not doing

107
00:03:45,320 --> 00:03:47,720
and then we're going to show you what

108
00:03:46,370 --> 00:03:48,800
happens when you encrypt them very very

109
00:03:47,720 --> 00:03:49,940
poorly and we come in and start

110
00:03:48,800 --> 00:03:50,900
decrypting your and then we're

111
00:03:49,940 --> 00:03:53,060
gonna show you why you want to encrypt

112
00:03:50,900 --> 00:03:53,959
it string riously goes DDoS that's a

113
00:03:53,060 --> 00:03:55,910
whole section about how your

114
00:03:53,959 --> 00:03:59,239
multifunction printers can do stuff

115
00:03:55,910 --> 00:04:01,100
because stealing domain creds that's

116
00:03:59,239 --> 00:04:02,510
we're gonna focus on stealing domain

117
00:04:01,100 --> 00:04:03,799
creds but really we could title that

118
00:04:02,510 --> 00:04:06,260
just stealing credentials for all sorts

119
00:04:03,800 --> 00:04:08,300
of services using printers and then the

120
00:04:06,260 --> 00:04:09,950
good news is we do have solutions for

121
00:04:08,300 --> 00:04:11,120
all of this this is not one of those

122
00:04:09,950 --> 00:04:13,850
talks so we're just gonna like you know

123
00:04:11,120 --> 00:04:15,709
mic drop walk away and cause panic in

124
00:04:13,850 --> 00:04:18,079
the streets this stuff is actually quite

125
00:04:15,709 --> 00:04:20,720
simple to prevent it's just from my

126
00:04:18,079 --> 00:04:22,340
experience and Zoe's experience people

127
00:04:20,720 --> 00:04:24,440
just aren't doing this so that's okay

128
00:04:22,340 --> 00:04:25,669
and then the last thing I do have I was

129
00:04:24,440 --> 00:04:27,300
told I have to put this slide in here

130
00:04:25,669 --> 00:04:30,150
for my employer I

131
00:04:27,300 --> 00:04:32,009
and one particular vendor that we used

132
00:04:30,150 --> 00:04:34,650
was just if you're gonna throw us under

133
00:04:32,009 --> 00:04:37,440
the bus do so politely it's not a vendor

134
00:04:34,650 --> 00:04:39,210
bash at all this is the intent of this

135
00:04:37,440 --> 00:04:41,190
this presentation is to build each other

136
00:04:39,210 --> 00:04:43,440
up and not put each other down we're

137
00:04:41,190 --> 00:04:45,330
here to show you guys some interesting

138
00:04:43,440 --> 00:04:47,370
issues with printers and the whole point

139
00:04:45,330 --> 00:04:48,719
of this talk is I know for a fact

140
00:04:47,370 --> 00:04:50,759
there's one person in this audience

141
00:04:48,720 --> 00:04:52,590
because they told me earlier their boss

142
00:04:50,759 --> 00:04:54,659
said to them yeah you can go to b-side

143
00:04:52,590 --> 00:04:56,698
Edmonton under one condition and that's

144
00:04:54,659 --> 00:04:58,319
that you bring something back practical

145
00:04:56,699 --> 00:05:00,360
from that conference that we can do in

146
00:04:58,319 --> 00:05:01,650
our environment so this talk do you know

147
00:05:00,360 --> 00:05:04,590
who you are in this talks right for you

148
00:05:01,650 --> 00:05:06,179
because this this that's that's what

149
00:05:04,590 --> 00:05:07,530
this is this is this is practical stuff

150
00:05:06,180 --> 00:05:08,639
you can write this down and be like hey

151
00:05:07,530 --> 00:05:10,369
we should probably look at our printers

152
00:05:08,639 --> 00:05:13,110
because there's some fun stuff there

153
00:05:10,370 --> 00:05:15,419
what else did I have here that was it so

154
00:05:13,110 --> 00:05:17,069
just a little bit audience participation

155
00:05:15,419 --> 00:05:18,419
I hate audience participation so I'm

156
00:05:17,069 --> 00:05:20,370
gonna force all you to do it

157
00:05:18,419 --> 00:05:22,080
sanity check just raise your hand if

158
00:05:20,370 --> 00:05:24,330
you've ever successfully cancelled a

159
00:05:22,080 --> 00:05:28,800
print job who's actually done it a few

160
00:05:24,330 --> 00:05:31,440
of you okay anything I think you're all

161
00:05:28,800 --> 00:05:33,539
liars I mean there was one time there

162
00:05:31,440 --> 00:05:34,889
was one time where I almost managed it

163
00:05:33,539 --> 00:05:36,419
where I thought I cancelled a print job

164
00:05:34,889 --> 00:05:38,159
and like a week later my power blipped

165
00:05:36,419 --> 00:05:40,289
and that cheeky little printer just

166
00:05:38,159 --> 00:05:41,669
fired out that job from a week ago and

167
00:05:40,289 --> 00:05:43,318
trying to go to your therapist to talk

168
00:05:41,669 --> 00:05:45,568
about how your printer is gas lighting

169
00:05:43,319 --> 00:05:47,310
you just it's a little bit it's a little

170
00:05:45,569 --> 00:05:49,949
bit weird she just says step away from

171
00:05:47,310 --> 00:05:51,120
the machines and which is just good life

172
00:05:49,949 --> 00:05:55,050
advice in general I think in our

173
00:05:51,120 --> 00:05:56,789
industry but the opinion that being able

174
00:05:55,050 --> 00:05:58,620
to cancel a print jobs a superpower and

175
00:05:56,789 --> 00:06:00,690
if you only have one superpower like you

176
00:05:58,620 --> 00:06:01,800
could have got flight invincibility you

177
00:06:00,690 --> 00:06:05,550
know you've got the ability to cancel a

178
00:06:01,800 --> 00:06:06,750
print job so that really sucks and how

179
00:06:05,550 --> 00:06:10,409
many of you know what PC load letter

180
00:06:06,750 --> 00:06:13,880
means and how many of you know that from

181
00:06:10,409 --> 00:06:16,440
office space or the actual documentation

182
00:06:13,880 --> 00:06:18,469
apparently it's print carriage load

183
00:06:16,440 --> 00:06:23,669
letter paper they could have just said

184
00:06:18,469 --> 00:06:25,289
yeah how many of you raise your hand if

185
00:06:23,669 --> 00:06:26,460
someone has changed your multifunction

186
00:06:25,289 --> 00:06:28,009
printer display to something

187
00:06:26,460 --> 00:06:31,229
inappropriate on April Fool's Day

188
00:06:28,009 --> 00:06:33,389
that actually happened okay yeah one

189
00:06:31,229 --> 00:06:36,120
person who we can be related together

190
00:06:33,389 --> 00:06:37,320
I don't drink whatever this actually

191
00:06:36,120 --> 00:06:38,310
happened couple years ago you can find

192
00:06:37,320 --> 00:06:39,719
out online there was someone out there

193
00:06:38,310 --> 00:06:40,409
either you show down or they scan the

194
00:06:39,719 --> 00:06:42,419
entire Internet

195
00:06:40,409 --> 00:06:44,279
and they found a couple thousand IP

196
00:06:42,419 --> 00:06:46,409
addresses with public direct ports open

197
00:06:44,279 --> 00:06:47,519
and the early mornings of April Fool's

198
00:06:46,409 --> 00:06:49,709
Day and we were all sleeping they ran a

199
00:06:47,519 --> 00:06:51,149
script that change the where it worked

200
00:06:49,709 --> 00:06:52,769
they display to something like you've

201
00:06:51,149 --> 00:06:53,999
been hacked sort or something and I came

202
00:06:52,769 --> 00:06:55,499
into work and someone was like oh my

203
00:06:53,999 --> 00:07:00,749
gosh someone got into a printer and I

204
00:06:55,499 --> 00:07:02,519
was awesome and how many of your multi

205
00:07:00,749 --> 00:07:11,489
functions have actually DDoS European

206
00:07:02,519 --> 00:07:12,899
Counter Strike servers I see yeah well

207
00:07:11,489 --> 00:07:15,568
that's that's a whole portion of the

208
00:07:12,899 --> 00:07:18,929
talk later so so one thing that I want

209
00:07:15,569 --> 00:07:21,539
to talk about is is four steps to

210
00:07:18,929 --> 00:07:23,068
guarantee failure a lot of what we've

211
00:07:21,539 --> 00:07:24,419
looked at when it came to these printers

212
00:07:23,069 --> 00:07:26,039
is there is this common theme in the

213
00:07:24,419 --> 00:07:28,529
last six months talking to people fixing

214
00:07:26,039 --> 00:07:31,558
stuff and it was to summarize that it

215
00:07:28,529 --> 00:07:33,389
was this it was oh that doesn't work the

216
00:07:31,559 --> 00:07:34,649
way we thought it did or oh that's that

217
00:07:33,389 --> 00:07:36,989
wasn't configured the way we thought it

218
00:07:34,649 --> 00:07:40,519
was configured and and what I've learned

219
00:07:36,989 --> 00:07:43,558
so I work very large enterprise people

220
00:07:40,519 --> 00:07:45,479
departments teams vendors contracts

221
00:07:43,559 --> 00:07:47,129
people there's a lot of people involved

222
00:07:45,479 --> 00:07:48,839
in decision making going basically from

223
00:07:47,129 --> 00:07:51,059
like like conception to actual influence

224
00:07:48,839 --> 00:07:52,979
and operates and you guys remember the

225
00:07:51,059 --> 00:07:54,149
telephone game dare played as a kid

226
00:07:52,979 --> 00:07:56,550
we're like you know they they'd stick in

227
00:07:54,149 --> 00:07:58,499
a group and one person would would say

228
00:07:56,550 --> 00:07:59,909
something like a guppy in a shark tank

229
00:07:58,499 --> 00:08:00,749
and then the person would whisper it and

230
00:07:59,909 --> 00:08:02,369
they'd whisper it and then the last

231
00:08:00,749 --> 00:08:04,829
person would have to say what they heard

232
00:08:02,369 --> 00:08:06,419
and it would be something like a puppy

233
00:08:04,829 --> 00:08:08,159
in the park stinks I got that from the

234
00:08:06,419 --> 00:08:09,539
internet right and the point is it's

235
00:08:08,159 --> 00:08:10,469
like it's like each person kind of hears

236
00:08:09,539 --> 00:08:11,459
something i says something a little

237
00:08:10,469 --> 00:08:14,639
differently and then over time it

238
00:08:11,459 --> 00:08:16,110
changes and um I actually had a

239
00:08:14,639 --> 00:08:17,159
co-worker telling me Billy can we do

240
00:08:16,110 --> 00:08:18,749
that all the time we call it water

241
00:08:17,159 --> 00:08:22,199
falling and I was like that's actually

242
00:08:18,749 --> 00:08:23,789
really funny but here's here's what we

243
00:08:22,199 --> 00:08:25,469
learned with with one one particular

244
00:08:23,789 --> 00:08:27,089
vendor they literally gave like they

245
00:08:25,469 --> 00:08:29,789
gave me step one and I was like I'm

246
00:08:27,089 --> 00:08:31,079
gonna run with this so engineering comes

247
00:08:29,789 --> 00:08:33,088
up with a feature and they say we have

248
00:08:31,079 --> 00:08:34,589
this new feature to solve problem X it

249
00:08:33,089 --> 00:08:36,269
does not solve problem wires that it

250
00:08:34,589 --> 00:08:37,469
just solves problem X and then they gave

251
00:08:36,269 --> 00:08:39,779
it to marketing no offense to the

252
00:08:37,469 --> 00:08:41,550
marketing folks and marketing says you

253
00:08:39,779 --> 00:08:43,889
know we're first to market for feature X

254
00:08:41,549 --> 00:08:47,609
attend this webinar to learn about X Y

255
00:08:43,889 --> 00:08:49,589
and learn all about future Y if you

256
00:08:47,610 --> 00:08:51,420
spend like 20 seconds on LinkedIn step

257
00:08:49,589 --> 00:08:52,889
two you see all over the place

258
00:08:51,420 --> 00:08:53,689
and then the customer goes hey this

259
00:08:52,889 --> 00:08:55,730
webinar just show

260
00:08:53,690 --> 00:08:57,080
how to solve problem wise we have said

261
00:08:55,730 --> 00:08:59,570
all over the place we should attend the

262
00:08:57,080 --> 00:09:01,580
webinar and then step 4 happen so they

263
00:08:59,570 --> 00:09:03,080
by feature X they accidentally use it to

264
00:09:01,580 --> 00:09:04,070
to solve problems that and everything's

265
00:09:03,080 --> 00:09:06,080
right with the world

266
00:09:04,070 --> 00:09:08,000
until Zoe night come knocking with our

267
00:09:06,080 --> 00:09:09,740
fun little tools and and no that's not

268
00:09:08,000 --> 00:09:11,060
what happened so we have three examples

269
00:09:09,740 --> 00:09:12,860
for today that we want to show you guys

270
00:09:11,060 --> 00:09:14,209
there's a lot of stuff we could have

271
00:09:12,860 --> 00:09:16,070
talked about with multifunction prints

272
00:09:14,210 --> 00:09:17,810
acuity but just time constraints and

273
00:09:16,070 --> 00:09:19,450
whatnot we we focused on these ones so

274
00:09:17,810 --> 00:09:22,699
we're going to show you guys a complete

275
00:09:19,450 --> 00:09:24,890
reversing of one particular secure print

276
00:09:22,700 --> 00:09:26,660
implementation we're going to talk about

277
00:09:24,890 --> 00:09:28,040
SNMP management and and how you can

278
00:09:26,660 --> 00:09:29,719
abuse a hell out of that with printers

279
00:09:28,040 --> 00:09:32,240
and then we're going to talk about we

280
00:09:29,720 --> 00:09:34,210
call the scan to folder that's kind of

281
00:09:32,240 --> 00:09:36,350
where we look at at actually abusing

282
00:09:34,210 --> 00:09:36,890
like stealing stealing credentials and

283
00:09:36,350 --> 00:09:40,490
what-have-you

284
00:09:36,890 --> 00:09:42,710
so real quick does anybody anybody here

285
00:09:40,490 --> 00:09:44,810
you secure print you know pins to to

286
00:09:42,710 --> 00:09:47,090
printer stuff or do you just print and

287
00:09:44,810 --> 00:09:48,229
it shows up on the printer and you hope

288
00:09:47,090 --> 00:09:50,660
someone else doesn't have it so if you

289
00:09:48,230 --> 00:09:52,280
use if you don't use secure print this

290
00:09:50,660 --> 00:09:54,140
is what it is it's it's a feature you

291
00:09:52,280 --> 00:09:56,959
can enable in any modern print driver

292
00:09:54,140 --> 00:09:58,850
that's when you print it asks you what

293
00:09:56,960 --> 00:10:00,290
what do you want your a pin or eight one

294
00:09:58,850 --> 00:10:01,460
two three four it sends out along with

295
00:10:00,290 --> 00:10:03,020
the print job when you get to the

296
00:10:01,460 --> 00:10:04,760
printer you it will not release the

297
00:10:03,020 --> 00:10:08,180
preferred job until you enter your

298
00:10:04,760 --> 00:10:11,060
actual pin the problem is that it has

299
00:10:08,180 --> 00:10:12,829
the word secure in it and what it's not

300
00:10:11,060 --> 00:10:14,390
it's not secure there is absolutely

301
00:10:12,830 --> 00:10:15,920
nothing secure about secure prints at

302
00:10:14,390 --> 00:10:17,620
all and Zoey and I are going to

303
00:10:15,920 --> 00:10:20,000
demonstrate this so what we did is we

304
00:10:17,620 --> 00:10:22,580
captured a print job as a whole bunch of

305
00:10:20,000 --> 00:10:25,100
them and and we started looking at what

306
00:10:22,580 --> 00:10:26,690
exactly is in a secure print enabled pin

307
00:10:25,100 --> 00:10:30,050
job on the wire and it's always going to

308
00:10:26,690 --> 00:10:32,030
take it from here so here's a small

309
00:10:30,050 --> 00:10:34,160
sample from just one print job that we

310
00:10:32,030 --> 00:10:35,480
that we captured so we have lots of

311
00:10:34,160 --> 00:10:38,360
really interesting information like we

312
00:10:35,480 --> 00:10:40,690
know the program that issued the print

313
00:10:38,360 --> 00:10:42,860
job so we know it's word we've got

314
00:10:40,690 --> 00:10:44,660
Spaulding's username which is quite

315
00:10:42,860 --> 00:10:47,060
handy because if you you can find out

316
00:10:44,660 --> 00:10:51,040
username format for an enterprise if you

317
00:10:47,060 --> 00:10:51,040
get one the computer name excels your

318
00:10:57,560 --> 00:11:04,939
if you see like sovereign and defiant

319
00:11:00,550 --> 00:11:06,560
okay and but the the big one is job

320
00:11:04,939 --> 00:11:09,860
password that's the one that stood up to

321
00:11:06,560 --> 00:11:15,829
me so yeah the job password looks a

322
00:11:09,860 --> 00:11:16,939
little bit short for a password so and

323
00:11:15,829 --> 00:11:19,790
one of the other things is you can also

324
00:11:16,939 --> 00:11:21,290
I believe in your enter in your

325
00:11:19,790 --> 00:11:22,430
environment you found in one of your

326
00:11:21,290 --> 00:11:25,639
packet captures you found like the

327
00:11:22,430 --> 00:11:27,620
someone printing with you yeah I was I

328
00:11:25,639 --> 00:11:28,819
was capturing something with some with

329
00:11:27,620 --> 00:11:30,290
their permission and and what they

330
00:11:28,819 --> 00:11:32,149
actually had as a user name was was

331
00:11:30,290 --> 00:11:34,069
their last name dot admin I was like oh

332
00:11:32,149 --> 00:11:35,209
no and I didn't know what user name they

333
00:11:34,069 --> 00:11:36,709
were using on how we know your

334
00:11:35,209 --> 00:11:37,969
administrative naming convention so if

335
00:11:36,709 --> 00:11:39,949
you can get a foothold in an environment

336
00:11:37,970 --> 00:11:41,329
where you can just start start ripping

337
00:11:39,949 --> 00:11:42,559
out print jobs which is really easy to

338
00:11:41,329 --> 00:11:44,059
do I'll show you that there is an

339
00:11:42,559 --> 00:11:45,980
absolute wealth of information in these

340
00:11:44,059 --> 00:11:47,689
packets that can help you a numerate and

341
00:11:45,980 --> 00:11:49,430
like when it comes to pen testing like

342
00:11:47,689 --> 00:11:55,430
enumeration is the biggest thing so I

343
00:11:49,430 --> 00:11:57,529
love all that data so we we worked with

344
00:11:55,430 --> 00:11:59,059
some of the pins we entered a few pins

345
00:11:57,529 --> 00:12:01,430
to see what the the job has would look

346
00:11:59,059 --> 00:12:07,819
like so for the pin four three two one

347
00:12:01,430 --> 00:12:11,000
we got 44 58 5654 an odd size that's for

348
00:12:07,819 --> 00:12:12,469
sure each character each pin number so

349
00:12:11,000 --> 00:12:14,149
pins can actually be alphanumeric they

350
00:12:12,470 --> 00:12:16,759
don't need to be just numeric

351
00:12:14,149 --> 00:12:21,319
just for simplicity sakes they are just

352
00:12:16,759 --> 00:12:24,589
numeric here so we have a pin of so four

353
00:12:21,319 --> 00:12:26,000
four we have 44 so we tried doing our

354
00:12:24,589 --> 00:12:28,040
reverse so instead of doing four three

355
00:12:26,000 --> 00:12:29,779
two one we did one two three four we

356
00:12:28,040 --> 00:12:31,579
didn't get something that looked like a

357
00:12:29,779 --> 00:12:35,389
substitution cipher so we can rule that

358
00:12:31,579 --> 00:12:39,079
out and we also notice that the job pass

359
00:12:35,389 --> 00:12:40,730
where it grows the exact same length

360
00:12:39,079 --> 00:12:43,008
dependent that's dependent on the length

361
00:12:40,730 --> 00:12:44,149
of the pin so we know if there's a 20

362
00:12:43,009 --> 00:12:45,620
character job password it's a 10

363
00:12:44,149 --> 00:12:48,860
character pin if it's a 10 character job

364
00:12:45,620 --> 00:12:50,360
password it's a 5 character pin that

365
00:12:48,860 --> 00:12:52,220
doesn't sound like any sort of good

366
00:12:50,360 --> 00:12:56,749
encryption that I've heard of but I'm

367
00:12:52,220 --> 00:12:57,829
not a cryptographer so I had a gut

368
00:12:56,749 --> 00:13:00,170
feeling that it had something to do with

369
00:12:57,829 --> 00:13:01,878
his or but how do I figure it out well I

370
00:13:00,170 --> 00:13:05,899
did the first couple by hand but then I

371
00:13:01,879 --> 00:13:08,029
got lazy because I'm very lazy so I dug

372
00:13:05,899 --> 00:13:09,089
into the android apk so I've done a

373
00:13:08,029 --> 00:13:11,699
little bit of

374
00:13:09,089 --> 00:13:15,149
stuff before mostly working with renders

375
00:13:11,699 --> 00:13:17,579
songs project and the great thing about

376
00:13:15,149 --> 00:13:20,939
Android apks is they're basically jars

377
00:13:17,579 --> 00:13:23,848
so Java jar files and because they're

378
00:13:20,939 --> 00:13:25,978
byte code we can you compile them really

379
00:13:23,849 --> 00:13:28,019
easily I am not Josh I cannot stare at

380
00:13:25,979 --> 00:13:29,549
assembly day in and day out and I just I

381
00:13:28,019 --> 00:13:32,689
see assembly and I just nope out of

382
00:13:29,549 --> 00:13:35,639
their like not for me

383
00:13:32,689 --> 00:13:38,968
so in an android apk you quite often

384
00:13:35,639 --> 00:13:43,079
have if any of your standard file

385
00:13:38,969 --> 00:13:46,439
archive on our cut file unzip e things

386
00:13:43,079 --> 00:13:48,269
winrar that you'll see a few different

387
00:13:46,439 --> 00:13:50,279
files like libraries asset files but

388
00:13:48,269 --> 00:13:51,899
there's one main one main one and that

389
00:13:50,279 --> 00:13:54,539
is the classes.dex

390
00:13:51,899 --> 00:13:55,679
and that is like the that's where all

391
00:13:54,539 --> 00:13:57,359
the nice stuff live that's like the

392
00:13:55,679 --> 00:13:58,649
white stuff in an Oreo you can just

393
00:13:57,359 --> 00:14:06,479
throw away everything else because

394
00:13:58,649 --> 00:14:08,009
really like your taste in Oreo is

395
00:14:06,479 --> 00:14:10,679
objectively incorrect and I can save it

396
00:14:08,009 --> 00:14:17,309
but we'll do that later those

397
00:14:10,679 --> 00:14:18,988
marshmallows so yeah

398
00:14:17,309 --> 00:14:20,879
lots of tools the nice thing too is

399
00:14:18,989 --> 00:14:22,259
because it's just straight jab there's

400
00:14:20,879 --> 00:14:23,939
tons of Java tools out there that will

401
00:14:22,259 --> 00:14:26,669
be compiled these quests lets classes

402
00:14:23,939 --> 00:14:28,529
about Dex files and when you do that you

403
00:14:26,669 --> 00:14:30,149
get nice little class files and it looks

404
00:14:28,529 --> 00:14:32,909
very similar to the source it's not

405
00:14:30,149 --> 00:14:35,899
exactly the source but it's good enough

406
00:14:32,909 --> 00:14:38,789
and the nice thing is that like nobody

407
00:14:35,899 --> 00:14:41,489
strips or office gates these Android

408
00:14:38,789 --> 00:14:44,129
files these apk files there has been one

409
00:14:41,489 --> 00:14:45,479
instance and that was in one of renders

410
00:14:44,129 --> 00:14:47,429
projects after we recommend it to them

411
00:14:45,479 --> 00:14:48,479
to run it through an obfuscator and when

412
00:14:47,429 --> 00:14:51,299
I see the obvious kind of stuff I'm just

413
00:14:48,479 --> 00:14:53,159
like nah I'm I'm off hours I'm too lazy

414
00:14:51,299 --> 00:14:56,249
for that so it's a good way to get rid

415
00:14:53,159 --> 00:14:57,659
of lazy researchers yeah so one of the

416
00:14:56,249 --> 00:15:00,209
key things just with um with the Android

417
00:14:57,659 --> 00:15:01,799
apks and stuff that is if if you're if

418
00:15:00,209 --> 00:15:03,779
your device like your your windows-based

419
00:15:01,799 --> 00:15:06,629
laptop can do the exact same thing but

420
00:15:03,779 --> 00:15:08,309
your Android based phone can do find the

421
00:15:06,629 --> 00:15:10,319
apk that that's doing it and rip it out

422
00:15:08,309 --> 00:15:11,579
what happened in this case is is the

423
00:15:10,319 --> 00:15:13,139
print drivers for the vendor that we

424
00:15:11,579 --> 00:15:16,138
were using that was on here they also

425
00:15:13,139 --> 00:15:17,459
make an Android print driver and when we

426
00:15:16,139 --> 00:15:19,589
were like well hey hold on a second

427
00:15:17,459 --> 00:15:22,079
we're pretty sure we can figure out you

428
00:15:19,589 --> 00:15:24,269
know how the securin thing is working

429
00:15:22,079 --> 00:15:25,199
yeah there's feature parity there so

430
00:15:24,269 --> 00:15:27,689
we'll say if you have feature parity

431
00:15:25,199 --> 00:15:29,309
between an Android device and and your

432
00:15:27,689 --> 00:15:31,019
your regular operating systems or

433
00:15:29,309 --> 00:15:33,118
something look at the apks because

434
00:15:31,019 --> 00:15:35,429
you're gonna learn a lot about how

435
00:15:33,119 --> 00:15:38,579
things actually work yes I mean you

436
00:15:35,429 --> 00:15:41,129
basically get the source silence and so

437
00:15:38,579 --> 00:15:42,238
once you have the D files you compiled

438
00:15:41,129 --> 00:15:45,269
you can load them up into your favorite

439
00:15:42,239 --> 00:15:47,730
IDE and search for keywords like

440
00:15:45,269 --> 00:15:51,389
password and here we have the two files

441
00:15:47,730 --> 00:15:55,769
that the that I handled the encryption

442
00:15:51,389 --> 00:15:57,480
of the pin into into the password so

443
00:15:55,769 --> 00:16:01,110
we're gonna look at job password class

444
00:15:57,480 --> 00:16:02,339
and here we see the encryption string

445
00:16:01,110 --> 00:16:05,249
they use which is actually the same as

446
00:16:02,339 --> 00:16:08,239
what I I found doing it by hand so

447
00:16:05,249 --> 00:16:11,670
that's just a confirmation that it's

448
00:16:08,239 --> 00:16:14,519
soaring with PK de pke you know

449
00:16:11,670 --> 00:16:16,110
repeating which is great seed and a

450
00:16:14,519 --> 00:16:20,160
little bit below we see the actual

451
00:16:16,110 --> 00:16:22,619
method for converting the pin into the

452
00:16:20,160 --> 00:16:23,759
job password so the carrot there right

453
00:16:22,619 --> 00:16:26,519
in the middle right before that long

454
00:16:23,759 --> 00:16:28,019
string is a for the programmers people

455
00:16:26,519 --> 00:16:30,509
who don't program which I don't really

456
00:16:28,019 --> 00:16:32,939
program that much so that's the zuhr

457
00:16:30,509 --> 00:16:34,980
function so we know that it's as or and

458
00:16:32,939 --> 00:16:36,360
it's storing the pin and not seen there

459
00:16:34,980 --> 00:16:37,499
is about 25 lines of code where they're

460
00:16:36,360 --> 00:16:40,350
actually taking the hex representation

461
00:16:37,499 --> 00:16:42,959
and converting it to doing some type

462
00:16:40,350 --> 00:16:47,610
juggling into a string to give us the

463
00:16:42,959 --> 00:16:50,219
hex that we see the XML so now that we

464
00:16:47,610 --> 00:16:52,170
know how the function works we can go

465
00:16:50,220 --> 00:16:53,579
ahead and python script and i will not

466
00:16:52,170 --> 00:16:55,589
show you the code because I am like a

467
00:16:53,579 --> 00:16:57,479
modern-day Medusa except instead of

468
00:16:55,589 --> 00:16:59,009
turning people to stone developers just

469
00:16:57,480 --> 00:17:01,049
cry uncontrollably when they see my

470
00:16:59,009 --> 00:17:04,439
Python code and I don't want to inflict

471
00:17:01,049 --> 00:17:06,629
that on people so but we can also show

472
00:17:04,439 --> 00:17:08,189
that we can take a pin convert it into

473
00:17:06,630 --> 00:17:09,630
the job password format and then take

474
00:17:08,189 --> 00:17:15,449
the job pass reformat and recover the

475
00:17:09,630 --> 00:17:17,130
pin from that but what can we do with

476
00:17:15,449 --> 00:17:19,500
these pins now that we've recovered them

477
00:17:17,130 --> 00:17:21,419
a whole bunch of stuff so so at this

478
00:17:19,500 --> 00:17:22,740
point we've done our print job we've

479
00:17:21,419 --> 00:17:23,909
captured it we've realized in the wire

480
00:17:22,740 --> 00:17:26,069
there's an interesting little value that

481
00:17:23,909 --> 00:17:27,539
says that says you know password we have

482
00:17:26,069 --> 00:17:28,918
a Python file that we can decrypt all

483
00:17:27,539 --> 00:17:30,960
those pins so if you can get a foothold

484
00:17:28,919 --> 00:17:32,399
and you can just copy every user

485
00:17:30,960 --> 00:17:34,260
capturing everybody's print jobs about

486
00:17:32,399 --> 00:17:34,770
that pin value run it to the Python file

487
00:17:34,260 --> 00:17:37,290
we have

488
00:17:34,770 --> 00:17:39,450
what can you do with the pin and the

489
00:17:37,290 --> 00:17:41,520
first one totally obvious now you just

490
00:17:39,450 --> 00:17:43,430
go walk to that printer you enter the

491
00:17:41,520 --> 00:17:46,110
pin you grab their job and you walk away

492
00:17:43,430 --> 00:17:47,310
I've learned I don't know if this is a

493
00:17:46,110 --> 00:17:49,199
common thing but I've learned that

494
00:17:47,310 --> 00:17:50,669
people will like I kid you not they will

495
00:17:49,200 --> 00:17:52,140
print on a Monday and they won't print

496
00:17:50,670 --> 00:17:53,490
their job up until Friday they'll print

497
00:17:52,140 --> 00:17:55,800
on a Friday and they'll expect it to

498
00:17:53,490 --> 00:17:57,030
somehow be there on a Monday I print my

499
00:17:55,800 --> 00:17:58,620
stuff and I walk right there and I get

500
00:17:57,030 --> 00:17:59,910
it so your your time window to grab the

501
00:17:58,620 --> 00:18:02,399
job now that you have their pin is

502
00:17:59,910 --> 00:18:03,510
interesting but the reality is is when

503
00:18:02,400 --> 00:18:04,860
we learn to do this I kind of just

504
00:18:03,510 --> 00:18:06,840
casually walk down my department ask

505
00:18:04,860 --> 00:18:09,240
people is like hey do you secure print

506
00:18:06,840 --> 00:18:15,480
yeah is your PIN the same as your debit

507
00:18:09,240 --> 00:18:17,340
card or credit card PIN and and no one

508
00:18:15,480 --> 00:18:20,220
straight up was like yes but yeah and

509
00:18:17,340 --> 00:18:21,689
and yeah so pin verification systems are

510
00:18:20,220 --> 00:18:23,910
very common now right even if you call

511
00:18:21,690 --> 00:18:25,440
your bank or whatever what's the pin on

512
00:18:23,910 --> 00:18:27,930
the counter I want two three four and

513
00:18:25,440 --> 00:18:29,400
it's not my pencil right but but the

514
00:18:27,930 --> 00:18:31,770
point is now not only do we have a

515
00:18:29,400 --> 00:18:32,900
method of just grabbing their print off

516
00:18:31,770 --> 00:18:35,940
on the printer but we have a way of

517
00:18:32,900 --> 00:18:38,160
figuring building a database of very

518
00:18:35,940 --> 00:18:42,720
common pins and spoiler alert one two

519
00:18:38,160 --> 00:18:43,920
three four is a very common in but one

520
00:18:42,720 --> 00:18:47,400
thing I wanted to point out is that very

521
00:18:43,920 --> 00:18:50,790
top one I know about this so when when

522
00:18:47,400 --> 00:18:52,170
we started changing the pins and then

523
00:18:50,790 --> 00:18:53,850
reprinting the same job and looking it

524
00:18:52,170 --> 00:18:55,020
was on the packet capture we learned an

525
00:18:53,850 --> 00:18:58,560
interesting thing and that was that

526
00:18:55,020 --> 00:19:00,990
nothing else changes in the package the

527
00:18:58,560 --> 00:19:02,970
only thing that changed was that

528
00:19:00,990 --> 00:19:04,290
password value which was interesting

529
00:19:02,970 --> 00:19:06,750
because we were all inter the assumption

530
00:19:04,290 --> 00:19:08,280
but that somehow that password it's

531
00:19:06,750 --> 00:19:10,140
doing that's got to do more it's got to

532
00:19:08,280 --> 00:19:11,730
be it's got to have some influence on on

533
00:19:10,140 --> 00:19:13,500
that that print job it's got to be

534
00:19:11,730 --> 00:19:15,480
encrypting or something yeah it doesn't

535
00:19:13,500 --> 00:19:17,840
that secure print pin is there no other

536
00:19:15,480 --> 00:19:20,550
reason than just to release the job so

537
00:19:17,840 --> 00:19:23,100
we look a little closer and we realized

538
00:19:20,550 --> 00:19:24,389
that what else is in the packet standard

539
00:19:23,100 --> 00:19:26,250
print job this one was like like six

540
00:19:24,390 --> 00:19:28,950
thousand packets of ripping it or

541
00:19:26,250 --> 00:19:30,480
putting it together you've got all the

542
00:19:28,950 --> 00:19:32,340
metadata which got your PIN and then you

543
00:19:30,480 --> 00:19:34,050
have this this is basically it's just a

544
00:19:32,340 --> 00:19:35,040
PCL encoded print job that's all that's

545
00:19:34,050 --> 00:19:37,680
there I mean it might sound like a

546
00:19:35,040 --> 00:19:40,649
no-brainer but that's that's all that's

547
00:19:37,680 --> 00:19:42,150
in it so the point here is that if

548
00:19:40,650 --> 00:19:43,830
you've achieved a foothold in an

549
00:19:42,150 --> 00:19:44,730
environment which is really easy to do

550
00:19:43,830 --> 00:19:46,649
we'll show you in the next set of slides

551
00:19:44,730 --> 00:19:48,850
where you can rip out people's print

552
00:19:46,650 --> 00:19:50,380
jobs and grab their pins you don't

553
00:19:48,850 --> 00:19:51,850
you need to decrypt their PIN anymore

554
00:19:50,380 --> 00:19:53,860
and go run to the printer and print it

555
00:19:51,850 --> 00:19:56,230
you can decrypt the print and hang on to

556
00:19:53,860 --> 00:19:57,699
it for you no other use but you can just

557
00:19:56,230 --> 00:19:59,710
grab the entire print job right off the

558
00:19:57,700 --> 00:20:01,420
wire use an off-the-shelf PCL 6 decoder

559
00:19:59,710 --> 00:20:03,160
and just view it right here on your

560
00:20:01,420 --> 00:20:05,050
laptop so whatever you're printing

561
00:20:03,160 --> 00:20:07,960
whether it's out of no financial

562
00:20:05,050 --> 00:20:11,710
information HR discipline letters that I

563
00:20:07,960 --> 00:20:13,990
get I mean you know these things like

564
00:20:11,710 --> 00:20:15,100
that someone else could easily have it

565
00:20:13,990 --> 00:20:17,350
and you have absolutely no way of

566
00:20:15,100 --> 00:20:20,080
knowing that they've done that and then

567
00:20:17,350 --> 00:20:21,580
um at this point we decided to actually

568
00:20:20,080 --> 00:20:23,020
tell somebody about this we're like hey

569
00:20:21,580 --> 00:20:26,470
look at this thing that we could do we

570
00:20:23,020 --> 00:20:27,760
don't know what the risk is we care

571
00:20:26,470 --> 00:20:29,350
maybe someone carry someone doesn't care

572
00:20:27,760 --> 00:20:32,170
really the question was how much do you

573
00:20:29,350 --> 00:20:33,760
care that we can we can do this and in

574
00:20:32,170 --> 00:20:35,880
the first conference call that we had a

575
00:20:33,760 --> 00:20:38,379
really interesting comment was made and

576
00:20:35,880 --> 00:20:40,630
what we said is they say well how are

577
00:20:38,380 --> 00:20:41,890
you capturing the print jobs and we said

578
00:20:40,630 --> 00:20:43,270
oh we're just running a peak up on our

579
00:20:41,890 --> 00:20:44,920
firewalls because the firewall sat

580
00:20:43,270 --> 00:20:47,379
between my workstation and the printer

581
00:20:44,920 --> 00:20:48,130
and we were doing that because it was

582
00:20:47,380 --> 00:20:49,660
convenient

583
00:20:48,130 --> 00:20:51,190
like we managed maintaining the entire

584
00:20:49,660 --> 00:20:52,450
firewall environment so why would we

585
00:20:51,190 --> 00:20:55,180
build something new just log on run a

586
00:20:52,450 --> 00:20:57,610
TCP dump let me dump it and one person

587
00:20:55,180 --> 00:20:59,200
had said they said oh oh okay well so

588
00:20:57,610 --> 00:21:01,060
for someone to actually do this then

589
00:20:59,200 --> 00:21:02,530
they would need to hack to this firewall

590
00:21:01,060 --> 00:21:04,060
and hack this firewall in hack this

591
00:21:02,530 --> 00:21:05,350
firewall and hack this firewall and get

592
00:21:04,060 --> 00:21:06,909
to this firewall and that's really hard

593
00:21:05,350 --> 00:21:10,740
to do so this isn't a non-issue or this

594
00:21:06,910 --> 00:21:13,000
is a non-issue and well no not at all um

595
00:21:10,740 --> 00:21:14,170
we were we were using the firewalls

596
00:21:13,000 --> 00:21:16,690
because it was convenient but the point

597
00:21:14,170 --> 00:21:19,750
is if you can get physical access to a

598
00:21:16,690 --> 00:21:21,610
printer that's all that's all you need

599
00:21:19,750 --> 00:21:23,140
physical access to a printer get to that

600
00:21:21,610 --> 00:21:24,969
physical wire and you you can start

601
00:21:23,140 --> 00:21:26,890
doing this very very easily and one of

602
00:21:24,970 --> 00:21:29,830
the greatest places to find physical

603
00:21:26,890 --> 00:21:31,210
multifunction MFDs is at any reception

604
00:21:29,830 --> 00:21:32,590
desk how often have you walked into an

605
00:21:31,210 --> 00:21:33,730
organization even here at ebbets in

606
00:21:32,590 --> 00:21:34,810
downtown and you've got the reception

607
00:21:33,730 --> 00:21:37,330
desk person sitting there what's behind

608
00:21:34,810 --> 00:21:38,560
them freaking multifunction printer so

609
00:21:37,330 --> 00:21:40,000
there's only now we're kind of talking

610
00:21:38,560 --> 00:21:41,740
and looking at this and saying like how

611
00:21:40,000 --> 00:21:43,450
what could we do to actually you know

612
00:21:41,740 --> 00:21:45,430
just just realistically you know walk

613
00:21:43,450 --> 00:21:47,260
into an environment you know that we

614
00:21:45,430 --> 00:21:48,760
know absolutely nothing about and

615
00:21:47,260 --> 00:21:51,280
started numerating it and the answer was

616
00:21:48,760 --> 00:21:57,879
BAM that multifunction printer so our

617
00:21:51,280 --> 00:21:59,950
first idea was to buy Raspberry Pi with

618
00:21:57,880 --> 00:22:01,210
a whole bunch of adapters you don't need

619
00:21:59,950 --> 00:22:02,380
a whole bunch of adapters just need to

620
00:22:01,210 --> 00:22:03,520
the reason we bought a whole bunch

621
00:22:02,380 --> 00:22:06,760
can't read spec sheet they bought all

622
00:22:03,520 --> 00:22:10,240
the wrong ones but we finally found this

623
00:22:06,760 --> 00:22:11,620
little guy so we have one right here if

624
00:22:10,240 --> 00:22:13,480
you want to see it later this is a hack

625
00:22:11,620 --> 00:22:15,340
five packets world so this is man in the

626
00:22:13,480 --> 00:22:16,420
middle for 60 bucks us convert to

627
00:22:15,340 --> 00:22:18,550
Canadia and ship it up your hundred

628
00:22:16,420 --> 00:22:22,510
dollars under bucks anyone here can buy

629
00:22:18,550 --> 00:22:24,850
this device and they're amazing a little

630
00:22:22,510 --> 00:22:26,830
larger than a toonie so it works with

631
00:22:24,850 --> 00:22:28,270
battery packs like this is this is the

632
00:22:26,830 --> 00:22:29,889
power to do USB power plug in we all

633
00:22:28,270 --> 00:22:31,510
have those on our phones if you don't

634
00:22:29,890 --> 00:22:32,860
have a battery pack what you do is you

635
00:22:31,510 --> 00:22:35,970
come to the U of A campus you find the

636
00:22:32,860 --> 00:22:38,260
people that are doing this in a circle

637
00:22:35,970 --> 00:22:39,670
and they're playing pokemon go you love

638
00:22:38,260 --> 00:22:41,890
them because they have like 600 battery

639
00:22:39,670 --> 00:22:44,110
packs don't even have to pay for one

640
00:22:41,890 --> 00:22:45,940
shameless plug if you play pokemon go

641
00:22:44,110 --> 00:22:48,399
come to the U of A it is the most dense

642
00:22:45,940 --> 00:22:49,780
pokey Center something like in the

643
00:22:48,400 --> 00:22:52,360
province so people come to the

644
00:22:49,780 --> 00:22:55,000
University just a play pokemon go and it

645
00:22:52,360 --> 00:22:56,409
has three modes be kept dump DNS rewrite

646
00:22:55,000 --> 00:22:57,610
in VPN you can actually put this on a

647
00:22:56,410 --> 00:22:59,110
wire you configure it to rewrite all

648
00:22:57,610 --> 00:23:01,120
people's DNS traffic everything going

649
00:22:59,110 --> 00:23:03,129
through there we use it for pcap dome

650
00:23:01,120 --> 00:23:06,939
and then we said hey why don't we

651
00:23:03,130 --> 00:23:09,310
actually do it so we built a I have it

652
00:23:06,940 --> 00:23:11,190
here someone said looks like a bomb it's

653
00:23:09,310 --> 00:23:13,629
not a bomb

654
00:23:11,190 --> 00:23:15,460
standard besides Las Vegas speaker gift

655
00:23:13,630 --> 00:23:18,610
from a couple years ago just a standard

656
00:23:15,460 --> 00:23:20,020
battery pack USB cable I this is the

657
00:23:18,610 --> 00:23:21,879
bottom I flipped it over the green thing

658
00:23:20,020 --> 00:23:23,500
means it's booting up and it's right

659
00:23:21,880 --> 00:23:26,020
here if you want to see it so completely

660
00:23:23,500 --> 00:23:27,250
portable fully automated just it's

661
00:23:26,020 --> 00:23:29,290
actually powered on right now I

662
00:23:27,250 --> 00:23:30,880
intentionally cover the light so you

663
00:23:29,290 --> 00:23:32,110
can't see that if you were to plug this

664
00:23:30,880 --> 00:23:33,280
into anything on campus there's a

665
00:23:32,110 --> 00:23:34,870
multifunction printer right over there

666
00:23:33,280 --> 00:23:36,310
it'll just start ripping that all the

667
00:23:34,870 --> 00:23:38,290
print jobs copies everything we'll see

668
00:23:36,310 --> 00:23:40,030
everything we want to see so you walk

669
00:23:38,290 --> 00:23:41,350
into that environment you say hey I'm

670
00:23:40,030 --> 00:23:43,710
you know the IT guy here to fix your

671
00:23:41,350 --> 00:23:45,159
printer you reach over you plug her in

672
00:23:43,710 --> 00:23:47,260
and you're good to go

673
00:23:45,160 --> 00:23:49,660
so you notice anything odd about this

674
00:23:47,260 --> 00:23:51,700
printer other than the fact that it's a

675
00:23:49,660 --> 00:23:53,590
printer no right this is standard

676
00:23:51,700 --> 00:23:54,760
printer floor one I know some like

677
00:23:53,590 --> 00:23:56,159
co-workers in here you probably have

678
00:23:54,760 --> 00:23:58,480
printed on this thing a few times and

679
00:23:56,160 --> 00:24:00,220
our vendor and I I'm sorry vendor

680
00:23:58,480 --> 00:24:01,930
reports to me at the U of A and we were

681
00:24:00,220 --> 00:24:04,060
like hey let's let's take some pictures

682
00:24:01,930 --> 00:24:06,880
for this for this shot but if you reach

683
00:24:04,060 --> 00:24:07,210
behind it there it is we just plug it in

684
00:24:06,880 --> 00:24:09,760
now

685
00:24:07,210 --> 00:24:11,140
we took this for the the presentation we

686
00:24:09,760 --> 00:24:13,360
weren't actually ripping out jobs here

687
00:24:11,140 --> 00:24:15,100
but the funniest thing I kid you not we

688
00:24:13,360 --> 00:24:15,760
had two co-workers walk by us my server

689
00:24:15,100 --> 00:24:17,320
team

690
00:24:15,760 --> 00:24:18,760
and they see like like I'm reaching over

691
00:24:17,320 --> 00:24:20,320
my butts in here and her vendors like

692
00:24:18,760 --> 00:24:21,670
and there was his camera trying to get

693
00:24:20,320 --> 00:24:23,260
the light on to make a nice photo and

694
00:24:21,670 --> 00:24:25,450
they they know our jobs and they just

695
00:24:23,260 --> 00:24:26,620
like is there a security issue with the

696
00:24:25,450 --> 00:24:30,910
printer you know like they're God's gift

697
00:24:26,620 --> 00:24:33,159
call me and and we really yeah actually

698
00:24:30,910 --> 00:24:37,000
I mean you get that you walk through the

699
00:24:33,160 --> 00:24:39,400
hall light everyone's like oh secure my

700
00:24:37,000 --> 00:24:41,530
kids are like we do more than that but

701
00:24:39,400 --> 00:24:44,290
anywho so that's that's ripping apart

702
00:24:41,530 --> 00:24:46,030
secure print ripping apart unencrypted

703
00:24:44,290 --> 00:24:49,080
environments under bucks you eyes cause

704
00:24:46,030 --> 00:24:53,220
some stuff so we're gonna switch it here

705
00:24:49,080 --> 00:24:55,270
okay so when communities not your friend

706
00:24:53,220 --> 00:24:57,820
Thomas Matthews this morning plug a

707
00:24:55,270 --> 00:24:59,260
check YAG sex a I wasn't gonna plug it

708
00:24:57,820 --> 00:25:00,610
but if you plugged it I'll plug it so

709
00:24:59,260 --> 00:25:02,260
it's just a local community started a

710
00:25:00,610 --> 00:25:04,479
couple years ago I think we had almost

711
00:25:02,260 --> 00:25:09,250
200 numbers a few days ago if you're

712
00:25:04,480 --> 00:25:11,490
five militant group communities awesome

713
00:25:09,250 --> 00:25:13,960
it's fantastic if someone like me can

714
00:25:11,490 --> 00:25:16,170
get off my butt on a Sunday afternoon

715
00:25:13,960 --> 00:25:18,610
and go to white Ave and meet people

716
00:25:16,170 --> 00:25:20,140
anybody can do it I remember my wife was

717
00:25:18,610 --> 00:25:22,870
like wait you're doing what now like

718
00:25:20,140 --> 00:25:24,970
you're voluntarily leaving the house to

719
00:25:22,870 --> 00:25:28,570
go to Y tab of all places to meet people

720
00:25:24,970 --> 00:25:31,000
you've never met before in a bar like

721
00:25:28,570 --> 00:25:32,740
that is so out of character for me and I

722
00:25:31,000 --> 00:25:34,210
was there for like five hours I'm like

723
00:25:32,740 --> 00:25:38,890
babe I found this group of people

724
00:25:34,210 --> 00:25:41,800
they're amazing there's a roomful you

725
00:25:38,890 --> 00:25:44,740
guys so community is fantastic unless

726
00:25:41,800 --> 00:25:49,030
it's SNMP community then it's absolutely

727
00:25:44,740 --> 00:25:50,770
terrible so if you don't know what SNMP

728
00:25:49,030 --> 00:25:52,750
is it stands for a simple network

729
00:25:50,770 --> 00:25:55,270
management protocol and you can do a lot

730
00:25:52,750 --> 00:25:56,950
of stuff with SNMP and Printers so it's

731
00:25:55,270 --> 00:25:58,270
mostly used you know in large

732
00:25:56,950 --> 00:26:00,220
environments or small environments

733
00:25:58,270 --> 00:26:01,420
whether you're on printers or network

734
00:26:00,220 --> 00:26:03,760
devices just for for monitoring

735
00:26:01,420 --> 00:26:04,840
reporting sending commands and when

736
00:26:03,760 --> 00:26:06,160
you're at the U of A and you've got like

737
00:26:04,840 --> 00:26:08,470
five six hundred print or something

738
00:26:06,160 --> 00:26:10,090
ridiculous okay you know you don't want

739
00:26:08,470 --> 00:26:11,320
to send a person to every single printer

740
00:26:10,090 --> 00:26:13,389
every day because they're gonna hate

741
00:26:11,320 --> 00:26:15,580
their lives and and pull stats on it so

742
00:26:13,390 --> 00:26:17,350
we use SNMP to ask the printer questions

743
00:26:15,580 --> 00:26:19,000
things like what are your toner levels

744
00:26:17,350 --> 00:26:21,040
what are your pin trays how many people

745
00:26:19,000 --> 00:26:22,420
printed this and it reports back so that

746
00:26:21,040 --> 00:26:24,040
way when someone shows up and manages

747
00:26:22,420 --> 00:26:25,570
the printers they can go okay these

748
00:26:24,040 --> 00:26:29,139
three printers need magenta toner

749
00:26:25,570 --> 00:26:30,550
I'll do that takk toner I'll do that but

750
00:26:29,140 --> 00:26:32,140
point is there's a really really really

751
00:26:30,550 --> 00:26:36,010
really loose security feature there

752
00:26:32,140 --> 00:26:37,240
under really loose security feature well

753
00:26:36,010 --> 00:26:38,740
call it a password it's called the

754
00:26:37,240 --> 00:26:41,650
community string but it's a password and

755
00:26:38,740 --> 00:26:42,970
if that is not if what you're sending in

756
00:26:41,650 --> 00:26:44,470
your packet is not what's configured on

757
00:26:42,970 --> 00:26:46,750
the device it'll drop it which is the

758
00:26:44,470 --> 00:26:50,200
intended perfect or purpose but if it's

759
00:26:46,750 --> 00:26:51,340
not like the default so you know you buy

760
00:26:50,200 --> 00:26:53,020
a router from Best Buy and it's not the

761
00:26:51,340 --> 00:26:54,280
default password SNMP is the same thing

762
00:26:53,020 --> 00:26:56,680
a lot of these devices come shipped with

763
00:26:54,280 --> 00:27:00,190
defaults the word is literally public or

764
00:26:56,680 --> 00:27:02,530
private and then as of like last week

765
00:27:00,190 --> 00:27:03,640
shown an had over 45,000 devices on it

766
00:27:02,530 --> 00:27:05,139
if you don't know showdown is it's a

767
00:27:03,640 --> 00:27:07,870
giant internet search engine for ports

768
00:27:05,140 --> 00:27:09,400
and protocols with SNMP listeners so

769
00:27:07,870 --> 00:27:10,780
that's what it is that's how it works

770
00:27:09,400 --> 00:27:14,710
but let's abuse the hell out of it

771
00:27:10,780 --> 00:27:16,180
so DDoS attacks have you know I would

772
00:27:14,710 --> 00:27:17,620
say have had a resurgence in the last

773
00:27:16,180 --> 00:27:19,710
five years I'm sure if you go out to the

774
00:27:17,620 --> 00:27:22,239
this wander booth the sponsors there

775
00:27:19,710 --> 00:27:23,500
they'll tell you all about DDoS attacks

776
00:27:22,240 --> 00:27:24,430
and how their technology stopped and

777
00:27:23,500 --> 00:27:26,170
whatnot but one of the things that

778
00:27:24,430 --> 00:27:27,880
enables DDoS attacks nowadays is

779
00:27:26,170 --> 00:27:30,100
something called UDP amplification so

780
00:27:27,880 --> 00:27:31,780
this is an entire talk in itself I have

781
00:27:30,100 --> 00:27:34,209
a whole talk just on ntp amplification

782
00:27:31,780 --> 00:27:35,649
because it's awesome awesome if you're

783
00:27:34,210 --> 00:27:39,100
not the guy receiving the packets and it

784
00:27:35,650 --> 00:27:40,330
sucks but TLDR UDP amplification is this

785
00:27:39,100 --> 00:27:42,429
it's when you send a really really

786
00:27:40,330 --> 00:27:44,320
really small request to a device and it

787
00:27:42,430 --> 00:27:46,300
generates an abnormal abnormally but a

788
00:27:44,320 --> 00:27:48,730
relatively much larger response in fact

789
00:27:46,300 --> 00:27:52,240
and we talk about it in terms of ratio

790
00:27:48,730 --> 00:27:53,380
so this is NTP not SNMP I think SNMP

791
00:27:52,240 --> 00:27:55,150
depending on what you're doing can be

792
00:27:53,380 --> 00:27:57,040
like 1 to 35 or what and larger but

793
00:27:55,150 --> 00:27:59,500
enemy like 1 is 600 which means that if

794
00:27:57,040 --> 00:28:01,060
you send if you spoof a packet first of

795
00:27:59,500 --> 00:28:01,830
all UDP you can spoof like crazy because

796
00:28:01,060 --> 00:28:04,810
there's there's no connection

797
00:28:01,830 --> 00:28:06,399
orientation there but with UDP you send

798
00:28:04,810 --> 00:28:08,169
a spoofed address the spoofed address is

799
00:28:06,400 --> 00:28:10,300
your your ultimate victim you send it to

800
00:28:08,170 --> 00:28:12,340
all these printers and you ask the

801
00:28:10,300 --> 00:28:14,260
printer a really small question that's

802
00:28:12,340 --> 00:28:15,820
gonna generate a massive reply you make

803
00:28:14,260 --> 00:28:17,050
sure you use public or private is your

804
00:28:15,820 --> 00:28:18,580
community string because odds are they

805
00:28:17,050 --> 00:28:20,050
haven't changed it and what its gonna do

806
00:28:18,580 --> 00:28:21,460
it's gonna be like yeah this is awesome

807
00:28:20,050 --> 00:28:22,780
and it's gonna generate that reply send

808
00:28:21,460 --> 00:28:24,490
it back and then you end up with a

809
00:28:22,780 --> 00:28:27,700
target victim somewhere that's gonna get

810
00:28:24,490 --> 00:28:29,320
flooded so with a ratio of 1 to 600 one

811
00:28:27,700 --> 00:28:31,240
megabit per second requests data and

812
00:28:29,320 --> 00:28:33,310
generate about 600 megabits per second

813
00:28:31,240 --> 00:28:34,750
over play they got which is maybe not

814
00:28:33,310 --> 00:28:36,370
the biggest thing in terms of scale

815
00:28:34,750 --> 00:28:38,440
throw some zeros on them we start having

816
00:28:36,370 --> 00:28:39,639
problems so this is why I think

817
00:28:38,440 --> 00:28:41,200
CloudFlare was saying that they're

818
00:28:39,640 --> 00:28:42,370
mitigating like terabit per second

819
00:28:41,200 --> 00:28:44,140
plastic DDoS

820
00:28:42,370 --> 00:28:45,850
tax now and if not like people are

821
00:28:44,140 --> 00:28:48,490
generating a terabit here and throwing

822
00:28:45,850 --> 00:28:50,919
it there now they using like gigabit per

823
00:28:48,490 --> 00:28:52,930
second of traffic to generate 600 going

824
00:28:50,920 --> 00:28:54,040
this way so the net result is rip

825
00:28:52,930 --> 00:28:56,860
everything so how this applies to

826
00:28:54,040 --> 00:28:58,030
printers we actually had this it

827
00:28:56,860 --> 00:28:59,469
happened a couple years ago came into

828
00:28:58,030 --> 00:29:01,300
work and there's a company called

829
00:28:59,470 --> 00:29:04,150
nuclear fallout it's a popularized it

830
00:29:01,300 --> 00:29:05,200
was their European hosted Counter Strike

831
00:29:04,150 --> 00:29:06,580
servers they host a lot of the

832
00:29:05,200 --> 00:29:08,470
competitive schemes on battlefield

833
00:29:06,580 --> 00:29:09,790
servers and whatnot and we started

834
00:29:08,470 --> 00:29:12,010
getting emails from them very quickly

835
00:29:09,790 --> 00:29:13,659
that we're like hey all these IP

836
00:29:12,010 --> 00:29:16,809
addresses on your network are ddossing

837
00:29:13,660 --> 00:29:18,880
are our environments and it's all SNMP

838
00:29:16,809 --> 00:29:20,230
garbage and when we look very like their

839
00:29:18,880 --> 00:29:21,340
printers like what the hell and that was

840
00:29:20,230 --> 00:29:24,490
kind of how we got tipped off to this

841
00:29:21,340 --> 00:29:26,439
and so this is not a do slide this is a

842
00:29:24,490 --> 00:29:27,460
don't do slide so if anyone's taking a

843
00:29:26,440 --> 00:29:28,540
picture of this there's like this is

844
00:29:27,460 --> 00:29:31,090
that practical thing Michael talked

845
00:29:28,540 --> 00:29:33,790
about we do this not this slide this is

846
00:29:31,090 --> 00:29:35,260
going to cause you a bad day so if you

847
00:29:33,790 --> 00:29:36,730
don't change your community strings if

848
00:29:35,260 --> 00:29:38,530
you expose your listeners to the

849
00:29:36,730 --> 00:29:40,059
Internet and then just go about your day

850
00:29:38,530 --> 00:29:41,710
someone else is gonna find out quite

851
00:29:40,059 --> 00:29:43,090
quickly and good chance your printers

852
00:29:41,710 --> 00:29:44,770
are gonna start ddossing the hell out of

853
00:29:43,090 --> 00:29:47,290
the planet because that's just what

854
00:29:44,770 --> 00:29:50,559
happens on we didn't literally get 500

855
00:29:47,290 --> 00:29:52,240
tickets and then that actually caught us

856
00:29:50,559 --> 00:29:53,350
three months with the work working with

857
00:29:52,240 --> 00:29:55,600
some vendors and some people to actually

858
00:29:53,350 --> 00:29:57,070
go and change the easiest thing to do

859
00:29:55,600 --> 00:29:59,139
was just block SNMP at the campus

860
00:29:57,070 --> 00:30:01,830
perimeter many of you guys probably like

861
00:29:59,140 --> 00:30:04,840
why don't you do that initially and just

862
00:30:01,830 --> 00:30:07,210
politics we can do that now but at the

863
00:30:04,840 --> 00:30:08,530
time much more difficult and and that's

864
00:30:07,210 --> 00:30:09,490
it so that's that's basically how we

865
00:30:08,530 --> 00:30:13,540
blow things out of the water with

866
00:30:09,490 --> 00:30:16,809
printers okay now I'm gonna talk about

867
00:30:13,540 --> 00:30:18,610
how well we've talked about how printers

868
00:30:16,809 --> 00:30:20,170
are one way as we talk to the printers

869
00:30:18,610 --> 00:30:24,010
but we can also make the printers talk

870
00:30:20,170 --> 00:30:24,850
back to us as multi-functions as in the

871
00:30:24,010 --> 00:30:26,920
name they can do several different

872
00:30:24,850 --> 00:30:29,559
things like scanning and the scanning

873
00:30:26,920 --> 00:30:31,660
functions of multifunction printers they

874
00:30:29,559 --> 00:30:34,870
have their own whole happy ecosystem now

875
00:30:31,660 --> 00:30:36,850
if there's a drop box for scan through

876
00:30:34,870 --> 00:30:39,600
Dropbox and whatnot but the ones we're

877
00:30:36,850 --> 00:30:43,300
gonna talk about is scan to folder and

878
00:30:39,600 --> 00:30:47,530
quite often they are misconfigured

879
00:30:43,300 --> 00:30:51,460
therefore for on the attacker front so

880
00:30:47,530 --> 00:30:52,780
when we scan to folder what often that

881
00:30:51,460 --> 00:30:53,890
printer has to have credentials to be

882
00:30:52,780 --> 00:30:54,710
able to write to whatever folder it

883
00:30:53,890 --> 00:30:57,380
wants to do

884
00:30:54,710 --> 00:30:58,730
or wants to write too now you can make

885
00:30:57,380 --> 00:31:01,220
users enter their credentials to do it

886
00:30:58,730 --> 00:31:04,310
so that it has authorization Troi to

887
00:31:01,220 --> 00:31:06,920
that folder but a lot of IT people are

888
00:31:04,310 --> 00:31:11,659
either lazy or more likely under worked

889
00:31:06,920 --> 00:31:13,070
I mean understaffed overworked and so

890
00:31:11,660 --> 00:31:14,480
they may throw high privileged accounts

891
00:31:13,070 --> 00:31:15,500
on there such as domain admin accounts

892
00:31:14,480 --> 00:31:17,390
so that they can write to any folder

893
00:31:15,500 --> 00:31:20,420
willy nilly don't have to worry about

894
00:31:17,390 --> 00:31:22,760
any issues this is a problem though

895
00:31:20,420 --> 00:31:24,350
because if we control that printer and

896
00:31:22,760 --> 00:31:29,240
that printer controls high value

897
00:31:24,350 --> 00:31:31,100
credentials yeah oh yeah by the way the

898
00:31:29,240 --> 00:31:32,540
packet Scrolls they run responder and

899
00:31:31,100 --> 00:31:34,070
they can catch these authentic ation

900
00:31:32,540 --> 00:31:37,850
attempts right out of the box they're

901
00:31:34,070 --> 00:31:40,730
fantastic yeah we can we can basically

902
00:31:37,850 --> 00:31:43,129
control those creds so using something

903
00:31:40,730 --> 00:31:45,680
like responder we can set up an SMB

904
00:31:43,130 --> 00:31:49,010
relay server using responder that's

905
00:31:45,680 --> 00:31:51,170
pretty much my go-to as a pen tester it

906
00:31:49,010 --> 00:31:52,190
basically attempts to intercept any it's

907
00:31:51,170 --> 00:31:53,930
a man-in-the-middle tool where it

908
00:31:52,190 --> 00:31:57,800
attempts to intercept any sort of

909
00:31:53,930 --> 00:31:59,180
authentication attempts and captures

910
00:31:57,800 --> 00:32:00,800
that hash you can also go a little more

911
00:31:59,180 --> 00:32:02,960
advanced and relay that authentication

912
00:32:00,800 --> 00:32:05,060
to tap attempt so you don't even have to

913
00:32:02,960 --> 00:32:06,650
crack the password if you do get a hash

914
00:32:05,060 --> 00:32:08,960
like that you can then just take it

915
00:32:06,650 --> 00:32:12,670
offline and crack it with hash cat I

916
00:32:08,960 --> 00:32:15,980
hope your printer passwords are strong

917
00:32:12,670 --> 00:32:18,470
because I have actually gotten da from a

918
00:32:15,980 --> 00:32:20,660
pen test here in town from a

919
00:32:18,470 --> 00:32:23,720
multifunction printer that was very loud

920
00:32:20,660 --> 00:32:25,760
and had a very weak very very weak

921
00:32:23,720 --> 00:32:27,650
password and this sort of authentication

922
00:32:25,760 --> 00:32:31,180
shenanigans is like standard operating

923
00:32:27,650 --> 00:32:35,660
procedure for most pen testers I think I

924
00:32:31,180 --> 00:32:38,690
think it's relatively low noise so yeah

925
00:32:35,660 --> 00:32:40,820
also we don't even necessarily have a

926
00:32:38,690 --> 00:32:43,100
box on the network to be able to relay

927
00:32:40,820 --> 00:32:44,929
that to I can have a responder server

928
00:32:43,100 --> 00:32:47,659
set up somewhere on the internet like

929
00:32:44,930 --> 00:32:50,390
maybe on AWS and I don't know how many

930
00:32:47,660 --> 00:32:53,320
organizations here our egress filtering

931
00:32:50,390 --> 00:32:56,810
port 445 but I would highly recommend it

932
00:32:53,320 --> 00:32:58,030
because tons from a pen testers point of

933
00:32:56,810 --> 00:33:02,149
view

934
00:32:58,030 --> 00:33:03,410
SMB and getting SMB hashes are there

935
00:33:02,150 --> 00:33:06,509
there's tons of ways we do it like

936
00:33:03,410 --> 00:33:11,089
through fishing through all sorts of

937
00:33:06,509 --> 00:33:11,089
like that so yeah watch out for that I

938
00:33:11,779 --> 00:33:15,749
just realize I've been drinking out of

939
00:33:13,619 --> 00:33:17,639
those water bottles so oh cool I trust

940
00:33:15,749 --> 00:33:19,469
you I'm not saying if you're not sacred

941
00:33:17,639 --> 00:33:21,299
we're good all right all right so so

942
00:33:19,469 --> 00:33:22,589
moving forward using feature X to solve

943
00:33:21,299 --> 00:33:24,209
for L of X instead of problems why is

944
00:33:22,589 --> 00:33:26,639
that so we don't pretty going to time

945
00:33:24,209 --> 00:33:30,269
this timer says 40 minutes already okay

946
00:33:26,639 --> 00:33:32,879
crazy okay so let's let's actually fix

947
00:33:30,269 --> 00:33:34,049
this stuff the good news is is most of

948
00:33:32,879 --> 00:33:35,309
this is relatively simple and

949
00:33:34,049 --> 00:33:36,440
straightforward to fix if you're not

950
00:33:35,309 --> 00:33:38,639
doing a lot of what's in the next slides

951
00:33:36,440 --> 00:33:40,289
maybe start doing them so do the power

952
00:33:38,639 --> 00:33:42,389
of the internet we're gonna start using

953
00:33:40,289 --> 00:33:44,699
memes to guide us through this part here

954
00:33:42,389 --> 00:33:46,859
so you can break this into three areas

955
00:33:44,699 --> 00:33:49,079
physical attacks remote attacks and

956
00:33:46,859 --> 00:33:50,779
man-in-the-middle attacks first one

957
00:33:49,079 --> 00:33:53,519
being threatening physical attacks

958
00:33:50,779 --> 00:33:54,809
common scenarios if you get physical

959
00:33:53,519 --> 00:33:56,879
attack it's game over

960
00:33:54,809 --> 00:33:58,109
and and that's true your screwdriver

961
00:33:56,879 --> 00:33:59,689
becomes the biggest threat at that point

962
00:33:58,109 --> 00:34:01,769
if a person is just gonna rip you know

963
00:33:59,690 --> 00:34:03,809
undo the thing and rip your your hard

964
00:34:01,769 --> 00:34:06,119
drive out you've got some problems so

965
00:34:03,809 --> 00:34:08,069
disk encryption modern ninety FPS

966
00:34:06,119 --> 00:34:10,679
tracking all of them support full-blown

967
00:34:08,069 --> 00:34:12,089
disk encryption pre-boot security so if

968
00:34:10,679 --> 00:34:14,250
someone were to actually take the drive

969
00:34:12,089 --> 00:34:16,379
out they can't get anything on it I know

970
00:34:14,250 --> 00:34:18,599
of one a very competent organization

971
00:34:16,379 --> 00:34:20,429
here in the city who actually tested

972
00:34:18,599 --> 00:34:21,869
that they took it out they sent it away

973
00:34:20,429 --> 00:34:23,220
to one of those fancy data recovery

974
00:34:21,869 --> 00:34:24,359
place pay the thousands of dollars and

975
00:34:23,219 --> 00:34:26,399
they really we can't do anything with

976
00:34:24,359 --> 00:34:27,629
this perfect so if you're not doing

977
00:34:26,399 --> 00:34:29,250
football and disk encryption just turn

978
00:34:27,629 --> 00:34:30,899
it on secondly disk over eights a little

979
00:34:29,250 --> 00:34:32,279
different so disk encryption is great

980
00:34:30,899 --> 00:34:33,388
for for pre-boot but once the system is

981
00:34:32,279 --> 00:34:35,190
booted and turned on and everything is

982
00:34:33,389 --> 00:34:36,899
working correctly there's a lot of other

983
00:34:35,190 --> 00:34:38,279
attacks you can do against you know data

984
00:34:36,899 --> 00:34:40,288
running in memory some of our network

985
00:34:38,279 --> 00:34:41,940
attacks disk over rate is what happens

986
00:34:40,289 --> 00:34:43,079
you can configure that and you can

987
00:34:41,940 --> 00:34:44,909
actually tell your printers you know on

988
00:34:43,079 --> 00:34:47,509
a schedule every day week month just

989
00:34:44,909 --> 00:34:49,679
purge free space and purge memory

990
00:34:47,509 --> 00:34:51,418
earlier I mentioned how people print on

991
00:34:49,679 --> 00:34:53,879
Fridays and picked them up on Mondays

992
00:34:51,418 --> 00:34:55,408
the reason I know that is we had an

993
00:34:53,879 --> 00:34:58,890
environment where we actually turned on

994
00:34:55,409 --> 00:35:00,779
disk overwrite over the weekend and we

995
00:34:58,890 --> 00:35:01,920
didn't tell anybody and they and a bunch

996
00:35:00,779 --> 00:35:05,130
of people came and we're like where's my

997
00:35:01,920 --> 00:35:06,599
print job and we were like wait I sent

998
00:35:05,130 --> 00:35:07,769
it on Friday it's Monday morning it's

999
00:35:06,599 --> 00:35:10,650
not there anymore because like every

1000
00:35:07,769 --> 00:35:12,118
Sunday we we're over wrote things so

1001
00:35:10,650 --> 00:35:13,740
that's a simple communication stage you

1002
00:35:12,119 --> 00:35:15,839
just be like well that's what happens

1003
00:35:13,740 --> 00:35:18,959
they'll pick it up on Friday and for

1004
00:35:15,839 --> 00:35:20,310
some reason also spot checks might sound

1005
00:35:18,960 --> 00:35:21,810
absolutely stupid but if

1006
00:35:20,310 --> 00:35:23,070
you know just get some steps on your

1007
00:35:21,810 --> 00:35:24,600
step counter because you're trying to

1008
00:35:23,070 --> 00:35:26,220
win the departmental you know health

1009
00:35:24,600 --> 00:35:31,799
competition or something walk around

1010
00:35:26,220 --> 00:35:34,230
environment spy checks honestly goodness

1011
00:35:31,800 --> 00:35:36,150
just just look look and see what you can

1012
00:35:34,230 --> 00:35:38,550
find if you find one of these you've

1013
00:35:36,150 --> 00:35:41,100
probably got an issue we we get it at

1014
00:35:38,550 --> 00:35:42,840
work not not common but it is happy my

1015
00:35:41,100 --> 00:35:44,370
team will get tickets from people all

1016
00:35:42,840 --> 00:35:46,320
over campus who are just like hey I

1017
00:35:44,370 --> 00:35:47,549
noticed this odd thing and odd thing is

1018
00:35:46,320 --> 00:35:49,200
some random thing plugged into a wall

1019
00:35:47,550 --> 00:35:50,400
some of the most interesting stuff we've

1020
00:35:49,200 --> 00:35:54,169
been involved in has been so I would

1021
00:35:50,400 --> 00:35:54,170
just be I'm like that shouldn't be there

1022
00:35:54,230 --> 00:35:59,310
and try to put them somewhere that isn't

1023
00:35:57,210 --> 00:36:00,650
a public space I mean maybe maybe not

1024
00:35:59,310 --> 00:36:08,040
that's up to you guys

1025
00:36:00,650 --> 00:36:11,040
preventing remote attacks so this is so

1026
00:36:08,040 --> 00:36:12,480
snmpv3 is actually a thing the whole I

1027
00:36:11,040 --> 00:36:14,430
deal with with community stirrings I'm

1028
00:36:12,480 --> 00:36:15,450
pretty sure that's a v2 thing v3 is a

1029
00:36:14,430 --> 00:36:17,609
much better version of the protocol

1030
00:36:15,450 --> 00:36:19,080
printer supported use that instead and

1031
00:36:17,610 --> 00:36:21,180
all these issues kind of go away

1032
00:36:19,080 --> 00:36:23,100
CLS any management interfaces this one I

1033
00:36:21,180 --> 00:36:24,419
always find fascinating you buy a

1034
00:36:23,100 --> 00:36:25,980
printer you set it up the first thing

1035
00:36:24,420 --> 00:36:27,120
they do is they enable they enable

1036
00:36:25,980 --> 00:36:28,770
encryption on the management interface

1037
00:36:27,120 --> 00:36:29,940
because heaven forbid someone intercept

1038
00:36:28,770 --> 00:36:32,070
the password that we use to manage the

1039
00:36:29,940 --> 00:36:33,930
printer and then they don't care about

1040
00:36:32,070 --> 00:36:35,220
the actual data being sent to the

1041
00:36:33,930 --> 00:36:37,020
printer well that's all that's all plain

1042
00:36:35,220 --> 00:36:39,149
text and whatnot but do it anyways

1043
00:36:37,020 --> 00:36:41,400
obviously strong passwords um

1044
00:36:39,150 --> 00:36:42,630
printers actually have firewalls access

1045
00:36:41,400 --> 00:36:44,190
control that's built right onto them you

1046
00:36:42,630 --> 00:36:44,820
can say only these addresses can manage

1047
00:36:44,190 --> 00:36:47,070
we were good to go

1048
00:36:44,820 --> 00:36:48,510
CA certs unicast of risk path forwarding

1049
00:36:47,070 --> 00:36:49,800
that's not something you do on your

1050
00:36:48,510 --> 00:36:51,390
printer you do that on your routers if

1051
00:36:49,800 --> 00:36:52,680
it supports it so I don't want people to

1052
00:36:51,390 --> 00:36:56,310
spend the next six days being like I

1053
00:36:52,680 --> 00:36:57,600
don't implement unitized RPF my printer

1054
00:36:56,310 --> 00:36:59,250
that's a router thing but it's used for

1055
00:36:57,600 --> 00:37:01,049
ante spoofing there's different versions

1056
00:36:59,250 --> 00:37:03,570
but like a strict version of it the

1057
00:37:01,050 --> 00:37:04,800
rotor wash you check it gets a packet

1058
00:37:03,570 --> 00:37:06,780
from an interface and a check to through

1059
00:37:04,800 --> 00:37:08,370
outing table and it basically says if I

1060
00:37:06,780 --> 00:37:09,630
did not receive that packet on the same

1061
00:37:08,370 --> 00:37:11,009
interface that I would send the response

1062
00:37:09,630 --> 00:37:12,900
I would have drop it

1063
00:37:11,010 --> 00:37:15,300
works really well for a teaspoon if your

1064
00:37:12,900 --> 00:37:17,430
large enterprise asymmetric routing

1065
00:37:15,300 --> 00:37:18,750
might cause some problems so do your

1066
00:37:17,430 --> 00:37:20,190
research first don't just be like

1067
00:37:18,750 --> 00:37:21,420
Michael set up these slides to turn this

1068
00:37:20,190 --> 00:37:23,280
on turn it on and watch your network

1069
00:37:21,420 --> 00:37:24,390
completely die but it is it is

1070
00:37:23,280 --> 00:37:26,430
definitely something to look at it and

1071
00:37:24,390 --> 00:37:27,660
the last thing your friending then ITM

1072
00:37:26,430 --> 00:37:29,759
so basically how to make these things

1073
00:37:27,660 --> 00:37:31,520
not work anymore there's three things

1074
00:37:29,760 --> 00:37:34,290
you can do in order of what I would say

1075
00:37:31,520 --> 00:37:36,420
paranoia so a lot of modern print

1076
00:37:34,290 --> 00:37:38,190
now have encrypted print set right up

1077
00:37:36,420 --> 00:37:41,700
into them actual encrypted print not

1078
00:37:38,190 --> 00:37:43,380
secure buona be print and in the

1079
00:37:41,700 --> 00:37:45,060
implementation we were looking at what

1080
00:37:43,380 --> 00:37:46,800
it does is it still leaves all the

1081
00:37:45,060 --> 00:37:49,259
metadata plaintext that will still leave

1082
00:37:46,800 --> 00:37:51,060
but you can still recover password

1083
00:37:49,260 --> 00:37:52,410
prints or whatever the pass codes out of

1084
00:37:51,060 --> 00:37:55,279
them but what it will do is it will

1085
00:37:52,410 --> 00:37:58,529
actually encourage the PCL 6 data itself

1086
00:37:55,280 --> 00:38:00,210
so that's that's how much how much risk

1087
00:37:58,530 --> 00:38:01,560
you want to accept I would definitely

1088
00:38:00,210 --> 00:38:03,000
recommend doing that because it makes it

1089
00:38:01,560 --> 00:38:05,070
makes it grabbing the actual print job

1090
00:38:03,000 --> 00:38:06,930
itself much harder I think perhaps in

1091
00:38:05,070 --> 00:38:08,280
the future that was something we're

1092
00:38:06,930 --> 00:38:11,850
gonna look at that maybe next year a

1093
00:38:08,280 --> 00:38:13,380
year before will be like the next one

1094
00:38:11,850 --> 00:38:18,000
TLS print you can just do straight up

1095
00:38:13,380 --> 00:38:20,490
wrap all your traffic in and the last

1096
00:38:18,000 --> 00:38:22,170
one is IPSec you can do IPSec I've never

1097
00:38:20,490 --> 00:38:23,729
actually seen an environment set it up

1098
00:38:22,170 --> 00:38:25,800
the vendor we worked with was like we we

1099
00:38:23,730 --> 00:38:28,350
only know of one vendor in the state it

1100
00:38:25,800 --> 00:38:29,790
would say you can take who actually does

1101
00:38:28,350 --> 00:38:30,839
full-blown IPSec for all their their

1102
00:38:29,790 --> 00:38:33,750
print environments because you can do

1103
00:38:30,840 --> 00:38:35,190
with an occasion as well so just one

1104
00:38:33,750 --> 00:38:37,020
more thing as well I forgot to mention

1105
00:38:35,190 --> 00:38:38,910
before instead of having them scan to

1106
00:38:37,020 --> 00:38:40,920
scan to folder and whatnot you scan to

1107
00:38:38,910 --> 00:38:42,330
email that way you don't have to have

1108
00:38:40,920 --> 00:38:44,340
any creds on there except for maybe a

1109
00:38:42,330 --> 00:38:45,450
little level email account and you have

1110
00:38:44,340 --> 00:38:48,690
to worry about writing to any folders

1111
00:38:45,450 --> 00:38:51,029
and that's just locked so a whole whole

1112
00:38:48,690 --> 00:38:52,530
huge huge thing right but that's still

1113
00:38:51,030 --> 00:38:55,020
valid point and then the other the other

1114
00:38:52,530 --> 00:38:56,010
to add on to that too was a lot of

1115
00:38:55,020 --> 00:38:57,720
people what they'll do is they'll

1116
00:38:56,010 --> 00:38:59,760
they'll they'll hard code the creds into

1117
00:38:57,720 --> 00:39:01,529
the printer just for usability but

1118
00:38:59,760 --> 00:39:02,790
really you can also talk to your users

1119
00:39:01,530 --> 00:39:04,710
and have them enter their credentials

1120
00:39:02,790 --> 00:39:06,240
and you want to store anything so that's

1121
00:39:04,710 --> 00:39:07,620
that's kind of we have that's the

1122
00:39:06,240 --> 00:39:10,589
presentation I do want to say special

1123
00:39:07,620 --> 00:39:12,839
thanks to two people well first to Kirk

1124
00:39:10,590 --> 00:39:14,730
Kirk is here he's the guy with the

1125
00:39:12,840 --> 00:39:17,040
shorts on today probably the only person

1126
00:39:14,730 --> 00:39:18,480
with a short sign so Kirk Kirk reports

1127
00:39:17,040 --> 00:39:20,430
me at University he's on our team Kirk

1128
00:39:18,480 --> 00:39:21,720
actually played a huge role in this and

1129
00:39:20,430 --> 00:39:24,480
wasn't just the Mike and Zoey show was a

1130
00:39:21,720 --> 00:39:28,500
Mike Kirk and Zoey try show but Kirk

1131
00:39:24,480 --> 00:39:29,610
didn't wanna present so well well well

1132
00:39:28,500 --> 00:39:32,100
point to oh because we know how much you

1133
00:39:29,610 --> 00:39:33,210
love the spotlight being on you and then

1134
00:39:32,100 --> 00:39:34,710
to the rest of you thanks thanks for

1135
00:39:33,210 --> 00:39:36,060
attending hopefully this was interesting

1136
00:39:34,710 --> 00:39:37,730
and informative yeah it's printers but

1137
00:39:36,060 --> 00:39:42,240
we tried to make it a little bit

1138
00:39:37,730 --> 00:39:43,650
interesting and we'll oh one so open up

1139
00:39:42,240 --> 00:39:45,899
the Q&A in a second if you need to get a

1140
00:39:43,650 --> 00:39:47,130
hold of us that's how you can get a hold

1141
00:39:45,900 --> 00:39:49,410
of us

1142
00:39:47,130 --> 00:39:51,930
yeah email me at the University say what

1143
00:39:49,410 --> 00:39:54,509
you want to say there's always on

1144
00:39:51,930 --> 00:39:55,710
Twitter I'm not linked and the egg sex

1145
00:39:54,509 --> 00:39:57,089
stuff if you're not in if you're not any

1146
00:39:55,710 --> 00:39:58,739
eggs I cannot join great um that's

1147
00:39:57,089 --> 00:40:00,450
probably the best way to get ahold of me

1148
00:39:58,739 --> 00:40:03,210
for like not University stuff is just a

1149
00:40:00,450 --> 00:40:05,899
DM on there so talk to lots of people we

1150
00:40:03,210 --> 00:40:05,900
can hook you up with that

