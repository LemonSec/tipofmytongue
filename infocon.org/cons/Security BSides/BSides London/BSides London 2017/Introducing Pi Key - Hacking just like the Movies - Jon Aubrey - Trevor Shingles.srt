1
00:00:00,030 --> 00:00:03,949
<font color="#E5E5E5">okay good</font><font color="#CCCCCC"> morning can you hear</font><font color="#E5E5E5"> me okay</font>

2
00:00:02,310 --> 00:00:05,910
good stuff

3
00:00:03,950 --> 00:00:08,280
before<font color="#E5E5E5"> I get</font><font color="#CCCCCC"> excited</font><font color="#E5E5E5"> can I have a quick</font>

4
00:00:05,910 --> 00:00:10,650
show<font color="#E5E5E5"> hands and so how many of you guys</font>

5
00:00:08,280 --> 00:00:13,919
in<font color="#CCCCCC"> girls are it's all pen testers or</font>

6
00:00:10,650 --> 00:00:16,219
working in red<font color="#CCCCCC"> team's</font><font color="#E5E5E5"> blue</font><font color="#CCCCCC"> team's</font><font color="#E5E5E5"> soft</font>

7
00:00:13,920 --> 00:00:21,259
<font color="#E5E5E5">analysts</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that type of thing and</font>

8
00:00:16,219 --> 00:00:25,740
<font color="#CCCCCC">security still</font><font color="#E5E5E5"> manages and like okay so</font>

9
00:00:21,260 --> 00:00:29,039
we<font color="#E5E5E5"> are first-time presenters so bear</font>

10
00:00:25,740 --> 00:00:31,470
with us<font color="#E5E5E5"> but I'll give you a quick bit of</font>

11
00:00:29,039 --> 00:00:33,960
<font color="#E5E5E5">introduction</font><font color="#CCCCCC"> into what we're about and</font>

12
00:00:31,470 --> 00:00:35,640
who we<font color="#E5E5E5"> are</font><font color="#CCCCCC"> so that's me and as you can</font>

13
00:00:33,960 --> 00:00:39,809
<font color="#CCCCCC">tell I probably look a lot better in</font>

14
00:00:35,640 --> 00:00:41,520
black and white<font color="#E5E5E5"> so previous background</font>

15
00:00:39,809 --> 00:00:44,718
<font color="#E5E5E5">quite heavily into sort of</font>

16
00:00:41,520 --> 00:00:47,820
infrastructure sort of various roles

17
00:00:44,719 --> 00:00:50,750
<font color="#E5E5E5">fairly new tune</font><font color="#CCCCCC"> for sex</font><font color="#E5E5E5"> so a couple of</font>

18
00:00:47,820 --> 00:00:52,620
years<font color="#E5E5E5"> in now as a penetration tester and</font>

19
00:00:50,750 --> 00:00:54,360
you're probably<font color="#CCCCCC"> thinking</font><font color="#E5E5E5"> you don't want</font>

20
00:00:52,620 --> 00:00:56,579
to listen<font color="#CCCCCC"> to me talk for good forty</font>

21
00:00:54,360 --> 00:00:58,890
minutes so you'll be happy<font color="#CCCCCC"> to know that</font>

22
00:00:56,579 --> 00:01:00,239
my<font color="#CCCCCC"> colleague here John</font>

23
00:00:58,890 --> 00:01:04,470
will<font color="#CCCCCC"> we've taken over second other</font>

24
00:01:00,239 --> 00:01:06,179
prison<font color="#CCCCCC"> presentations so as you can</font><font color="#E5E5E5"> see</font>

25
00:01:04,470 --> 00:01:09,600
from from<font color="#E5E5E5"> John's photo he's not much</font>

26
00:01:06,180 --> 00:01:11,790
<font color="#CCCCCC">better-looking</font><font color="#E5E5E5"> in real life so you know</font>

27
00:01:09,600 --> 00:01:15,960
bear<font color="#CCCCCC"> with him to join</font><font color="#E5E5E5"> as much of a</font>

28
00:01:11,790 --> 00:01:18,840
similar background<font color="#CCCCCC"> to me so we are sort</font>

29
00:01:15,960 --> 00:01:22,350
<font color="#CCCCCC">of would be done sort of similar work in</font>

30
00:01:18,840 --> 00:01:24,210
<font color="#E5E5E5">the background</font><font color="#CCCCCC"> Johnny</font><font color="#E5E5E5"> is now</font><font color="#CCCCCC"> working as</font>

31
00:01:22,350 --> 00:01:27,839
a<font color="#E5E5E5"> security architect and sort of</font>

32
00:01:24,210 --> 00:01:29,639
<font color="#E5E5E5">specializing in IOT so he is going</font><font color="#CCCCCC"> to be</font>

33
00:01:27,840 --> 00:01:33,090
<font color="#E5E5E5">very happy to field any</font><font color="#CCCCCC"> questions you</font>

34
00:01:29,640 --> 00:01:35,009
have<font color="#E5E5E5"> around any complicated IT issues so</font>

35
00:01:33,090 --> 00:01:36,930
<font color="#E5E5E5">feel free you know touching my shoulder</font>

36
00:01:35,009 --> 00:01:39,420
<font color="#E5E5E5">and when you're out</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> hawk</font><font color="#CCCCCC"> Anand</font>

37
00:01:36,930 --> 00:01:43,020
and and make sure you<font color="#CCCCCC"> uh make it</font>

38
00:01:39,420 --> 00:01:46,320
difficult for<font color="#E5E5E5"> him</font><font color="#CCCCCC"> as possible</font><font color="#E5E5E5"> and also</font>

39
00:01:43,020 --> 00:01:47,548
he<font color="#CCCCCC"> is because he's working</font><font color="#E5E5E5"> in IOT he is</font>

40
00:01:46,320 --> 00:01:49,919
<font color="#CCCCCC">single handedly sort of saving</font><font color="#E5E5E5"> the</font>

41
00:01:47,549 --> 00:01:52,860
<font color="#E5E5E5">Internet</font><font color="#CCCCCC"> so again feel free to sort of</font>

42
00:01:49,920 --> 00:01:54,299
<font color="#E5E5E5">congratulate him on that and last boring</font>

43
00:01:52,860 --> 00:01:58,500
slide is a little<font color="#CCCCCC"> bit of a disclaimer</font>

44
00:01:54,299 --> 00:02:01,890
<font color="#CCCCCC">and so</font><font color="#E5E5E5"> obviously our words and views</font><font color="#CCCCCC"> and</font>

45
00:01:58,500 --> 00:02:03,360
thoughts are our own we<font color="#CCCCCC"> don't have any</font>

46
00:02:01,890 --> 00:02:06,689
<font color="#CCCCCC">affiliation</font><font color="#E5E5E5"> with the companies</font><font color="#CCCCCC"> that we</font>

47
00:02:03,360 --> 00:02:08,610
work<font color="#CCCCCC"> for and</font><font color="#E5E5E5"> obviously if you do decide</font>

48
00:02:06,689 --> 00:02:10,100
<font color="#CCCCCC">to go and use the work that we'll</font>

49
00:02:08,610 --> 00:02:12,770
present<font color="#CCCCCC"> here today</font>

50
00:02:10,100 --> 00:02:15,170
in your<font color="#E5E5E5"> places of work or in systems at</font>

51
00:02:12,770 --> 00:02:20,180
you and make them in<font color="#E5E5E5"> contact with then</font>

52
00:02:15,170 --> 00:02:21,739
obviously the usual is irresponsible so

53
00:02:20,180 --> 00:02:24,050
if we<font color="#CCCCCC"> M will get</font><font color="#E5E5E5"> into what we're</font>

54
00:02:21,740 --> 00:02:29,360
actually here<font color="#E5E5E5"> to talk about and so what</font>

55
00:02:24,050 --> 00:02:31,040
is a pikey so as you can see<font color="#CCCCCC"> from the</font>

56
00:02:29,360 --> 00:02:34,130
executive summary<font color="#E5E5E5"> there really it's a</font>

57
00:02:31,040 --> 00:02:37,190
<font color="#E5E5E5">physical</font><font color="#CCCCCC"> pen testing device and we've</font>

58
00:02:34,130 --> 00:02:38,990
<font color="#CCCCCC">designed it for</font><font color="#E5E5E5"> the extraction</font><font color="#CCCCCC"> and reuse</font>

59
00:02:37,190 --> 00:02:41,060
of<font color="#E5E5E5"> credentials so the way we look at it</font>

60
00:02:38,990 --> 00:02:44,320
<font color="#E5E5E5">is we wanted to</font><font color="#CCCCCC"> design something or make</font>

61
00:02:41,060 --> 00:02:46,790
use of something<font color="#E5E5E5"> that was in essence a</font>

62
00:02:44,320 --> 00:02:48,920
tool<font color="#E5E5E5"> that you could come along to a</font>

63
00:02:46,790 --> 00:02:51,890
locked computer<font color="#E5E5E5"> window serving in this</font>

64
00:02:48,920 --> 00:02:54,739
case in a corporate<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> plug it</font>

65
00:02:51,890 --> 00:02:58,160
<font color="#E5E5E5">in wait a few you know 60 seconds or so</font>

66
00:02:54,740 --> 00:02:59,660
<font color="#E5E5E5">and</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> it by magic it would unlock so</font>

67
00:02:58,160 --> 00:03:01,070
that is exactly<font color="#CCCCCC"> what</font><font color="#E5E5E5"> this talk is going</font>

68
00:02:59,660 --> 00:03:03,410
<font color="#E5E5E5">to be about so it's gonna be a little</font>

69
00:03:01,070 --> 00:03:05,180
bit of background about<font color="#E5E5E5"> how we got to</font>

70
00:03:03,410 --> 00:03:08,030
this point so there will<font color="#E5E5E5"> be some sort</font><font color="#CCCCCC"> of</font>

71
00:03:05,180 --> 00:03:09,290
R&D slides<font color="#E5E5E5"> and kind of get you into the</font>

72
00:03:08,030 --> 00:03:11,420
mind so that<font color="#E5E5E5"> we had whilst we were</font>

73
00:03:09,290 --> 00:03:13,549
developing<font color="#E5E5E5"> it and hopefully at the</font><font color="#CCCCCC"> end</font>

74
00:03:11,420 --> 00:03:15,470
you can obviously download the code

75
00:03:13,550 --> 00:03:21,350
<font color="#CCCCCC">yourself from github</font><font color="#E5E5E5"> and have a go at</font>

76
00:03:15,470 --> 00:03:23,900
making one so and the basis<font color="#E5E5E5"> for this</font>

77
00:03:21,350 --> 00:03:27,320
work and you can probably be cast your

78
00:03:23,900 --> 00:03:29,750
minds<font color="#CCCCCC"> back to September</font><font color="#E5E5E5"> 2016 you may</font>

79
00:03:27,320 --> 00:03:33,440
remember seeing an article from<font color="#CCCCCC"> Moo</font>

80
00:03:29,750 --> 00:03:36,860
<font color="#CCCCCC">Bitsy's</font><font color="#E5E5E5"> Rob</font><font color="#CCCCCC"> filler</font><font color="#E5E5E5"> so he had</font>

81
00:03:33,440 --> 00:03:39,380
<font color="#E5E5E5">demonstrated</font><font color="#CCCCCC"> that by plugging in a</font><font color="#E5E5E5"> USB</font>

82
00:03:36,860 --> 00:03:40,880
<font color="#E5E5E5">network device into a Windows</font><font color="#CCCCCC"> 7 machine</font>

83
00:03:39,380 --> 00:03:44,329
or Windows 10 machine for<font color="#E5E5E5"> that matter</font>

84
00:03:40,880 --> 00:03:46,880
<font color="#E5E5E5">and Windows naturally then starts to</font>

85
00:03:44,330 --> 00:03:48,800
<font color="#E5E5E5">trust this device and proceeded</font><font color="#CCCCCC"> to send</font>

86
00:03:46,880 --> 00:03:50,240
<font color="#CCCCCC">traffic out of its interface</font><font color="#E5E5E5"> so in</font>

87
00:03:48,800 --> 00:03:53,300
essence it gets<font color="#CCCCCC"> bumped up in the routing</font>

88
00:03:50,240 --> 00:03:55,190
table<font color="#CCCCCC"> and all of a sudden all the</font>

89
00:03:53,300 --> 00:03:58,040
network traffic<font color="#E5E5E5"> that is going from the</font>

90
00:03:55,190 --> 00:04:00,010
from the<font color="#E5E5E5"> PC at a time will quite happily</font>

91
00:03:58,040 --> 00:04:02,329
go across<font color="#E5E5E5"> this new network interface so</font>

92
00:04:00,010 --> 00:04:05,090
this<font color="#E5E5E5"> is kind of the basis and the key to</font>

93
00:04:02,330 --> 00:04:07,040
to the<font color="#E5E5E5"> works that</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> built on this and</font>

94
00:04:05,090 --> 00:04:10,100
there's been other similar attacks<font color="#E5E5E5"> since</font>

95
00:04:07,040 --> 00:04:11,929
then so you might recall<font color="#E5E5E5"> poison</font><font color="#CCCCCC"> tap</font><font color="#E5E5E5"> but</font>

96
00:04:10,100 --> 00:04:14,180
this one<font color="#E5E5E5"> seems to</font><font color="#CCCCCC"> sort of stand</font><font color="#E5E5E5"> out to</font>

97
00:04:11,930 --> 00:04:16,340
us<font color="#E5E5E5"> is the one that's most relevant</font><font color="#CCCCCC"> to a</font>

98
00:04:14,180 --> 00:04:17,959
corporate environment so and sort of<font color="#CCCCCC"> the</font>

99
00:04:16,339 --> 00:04:22,039
natural<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that we see</font><font color="#E5E5E5"> in engagements</font>

100
00:04:17,959 --> 00:04:23,960
<font color="#E5E5E5">that we that</font><font color="#CCCCCC"> we do so just to give you</font>

101
00:04:22,040 --> 00:04:26,090
some background<font color="#E5E5E5"> on how this works so</font>

102
00:04:23,960 --> 00:04:27,440
you guys are pen testers<font color="#E5E5E5"> and working red</font>

103
00:04:26,090 --> 00:04:29,109
<font color="#E5E5E5">seems you're probably more than more</font>

104
00:04:27,440 --> 00:04:31,250
<font color="#CCCCCC">than aware of how this attack worked and</font>

105
00:04:29,110 --> 00:04:36,050
but<font color="#E5E5E5"> for others we'll just go</font><font color="#CCCCCC"> through</font>

106
00:04:31,250 --> 00:04:38,180
some of<font color="#E5E5E5"> the details so Rob took a USB</font>

107
00:04:36,050 --> 00:04:40,780
LAN<font color="#E5E5E5"> armory which is in essence just a</font>

108
00:04:38,180 --> 00:04:42,889
USB<font color="#E5E5E5"> key was some compute module on it</font>

109
00:04:40,780 --> 00:04:46,758
this emulated itself as a network

110
00:04:42,889 --> 00:04:48,349
<font color="#CCCCCC">adapter</font><font color="#E5E5E5"> happy days and</font><font color="#CCCCCC"> windows</font><font color="#E5E5E5"> naturally</font>

111
00:04:46,759 --> 00:04:52,310
saw the network adapter and<font color="#E5E5E5"> was quite</font>

112
00:04:48,349 --> 00:04:54,770
happy<font color="#CCCCCC"> to install it as I</font><font color="#E5E5E5"> said earlier</font>

113
00:04:52,310 --> 00:04:57,110
<font color="#CCCCCC">Windows tends</font><font color="#E5E5E5"> to prefer the newer and</font>

114
00:04:54,770 --> 00:04:59,659
faster connections so again<font color="#E5E5E5"> it was more</font>

115
00:04:57,110 --> 00:05:01,150
than happy<font color="#CCCCCC"> to accept this and proceed to</font>

116
00:04:59,660 --> 00:05:05,810
<font color="#E5E5E5">send traffic around the interface and</font>

117
00:05:01,150 --> 00:05:08,060
the real key bit was<font color="#CCCCCC"> the Rob had</font>

118
00:05:05,810 --> 00:05:10,910
installed<font color="#E5E5E5"> responder which is a tool from</font>

119
00:05:08,060 --> 00:05:12,860
Spyder labs<font color="#E5E5E5"> so again</font>

120
00:05:10,910 --> 00:05:15,110
pen testers<font color="#E5E5E5"> red team is probably more</font>

121
00:05:12,860 --> 00:05:19,280
<font color="#E5E5E5">than aware what responder does but in</font>

122
00:05:15,110 --> 00:05:21,380
essence<font color="#CCCCCC"> is</font><font color="#E5E5E5"> going to poison any name</font>

123
00:05:19,280 --> 00:05:24,409
resolution<font color="#E5E5E5"> request that it sees so in a</font>

124
00:05:21,380 --> 00:05:27,590
typical engagement<font color="#E5E5E5"> you might start it on</font>

125
00:05:24,409 --> 00:05:29,539
our land<font color="#E5E5E5"> segment and then wait</font><font color="#CCCCCC"> for a</font>

126
00:05:27,590 --> 00:05:31,130
period<font color="#CCCCCC"> of time</font><font color="#E5E5E5"> so what responder is</font>

127
00:05:29,539 --> 00:05:32,659
going to do it's<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to look for any</font>

128
00:05:31,130 --> 00:05:34,909
name resolution requests that come

129
00:05:32,659 --> 00:05:38,090
<font color="#CCCCCC">across</font><font color="#E5E5E5"> the network so your normal net</font><font color="#CCCCCC"> by</font>

130
00:05:34,909 --> 00:05:40,460
<font color="#CCCCCC">asleep</font><font color="#E5E5E5"> local and then it was going to</font>

131
00:05:38,090 --> 00:05:43,609
proceed<font color="#E5E5E5"> to Athens but</font><font color="#CCCCCC"> its hand up</font><font color="#E5E5E5"> and go</font>

132
00:05:40,460 --> 00:05:44,989
yeah I'm that guy on<font color="#E5E5E5"> that host so it</font>

133
00:05:43,610 --> 00:05:46,759
looks for<font color="#CCCCCC"> people that you know perhaps</font>

134
00:05:44,990 --> 00:05:50,449
<font color="#CCCCCC">fat-finger the internet address or a</font>

135
00:05:46,759 --> 00:05:52,370
file server address once<font color="#CCCCCC"> its</font><font color="#E5E5E5"> emulated</font>

136
00:05:50,449 --> 00:05:54,169
once<font color="#CCCCCC"> it spoof that address it embassy to</font>

137
00:05:52,370 --> 00:05:57,259
emulate<font color="#E5E5E5"> service that was the</font><font color="#CCCCCC"> original</font>

138
00:05:54,169 --> 00:06:00,740
request<font color="#CCCCCC"> was for so for SMB services HTTP</font>

139
00:05:57,259 --> 00:06:02,900
SMTP<font color="#E5E5E5"> responder has a whole library of</font>

140
00:06:00,740 --> 00:06:05,509
services that<font color="#E5E5E5"> it will emulate and then</font>

141
00:06:02,900 --> 00:06:07,250
it will see to take part in the any

142
00:06:05,509 --> 00:06:09,800
<font color="#E5E5E5">authentication</font><font color="#CCCCCC"> protocols thereafter</font><font color="#E5E5E5"> so</font>

143
00:06:07,250 --> 00:06:12,020
for ntlm for example it<font color="#E5E5E5"> will quite</font>

144
00:06:09,800 --> 00:06:13,699
<font color="#E5E5E5">happily do the challenge response</font><font color="#CCCCCC"> start</font>

145
00:06:12,020 --> 00:06:16,880
to store the credentials<font color="#E5E5E5"> and then end</font>

146
00:06:13,699 --> 00:06:18,139
the<font color="#E5E5E5"> communication so in this instance</font><font color="#CCCCCC"> it</font>

147
00:06:16,880 --> 00:06:20,030
<font color="#E5E5E5">doesn't have to worry too much</font><font color="#CCCCCC"> about</font>

148
00:06:18,139 --> 00:06:21,560
looking for that name resolution traffic

149
00:06:20,030 --> 00:06:25,609
because it's all coming out<font color="#E5E5E5"> of that</font>

150
00:06:21,560 --> 00:06:27,349
<font color="#E5E5E5">interface anyway and again in the</font>

151
00:06:25,610 --> 00:06:29,030
original attack so after the<font color="#E5E5E5"> device has</font>

152
00:06:27,349 --> 00:06:31,759
<font color="#E5E5E5">received some credentials so responder</font>

153
00:06:29,030 --> 00:06:33,799
<font color="#E5E5E5">happens to store these credentials in a</font>

154
00:06:31,759 --> 00:06:34,840
<font color="#E5E5E5">database that</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> runs so once it has</font>

155
00:06:33,800 --> 00:06:38,380
<font color="#E5E5E5">these</font>

156
00:06:34,840 --> 00:06:40,150
the<font color="#E5E5E5"> device just</font><font color="#CCCCCC"> shuts down and then it's</font>

157
00:06:38,380 --> 00:06:42,280
down to the person that's<font color="#E5E5E5"> running the</font>

158
00:06:40,150 --> 00:06:45,219
attack<font color="#E5E5E5"> love exactly</font><font color="#CCCCCC"> - then take</font><font color="#E5E5E5"> it away</font>

159
00:06:42,280 --> 00:06:47,320
<font color="#E5E5E5">and crack these credentials</font><font color="#CCCCCC"> so all in</font>

160
00:06:45,220 --> 00:06:50,320
all and it was quite simplistic and

161
00:06:47,320 --> 00:06:54,010
<font color="#E5E5E5">we've elegantly summarized the process</font>

162
00:06:50,320 --> 00:06:57,370
here<font color="#E5E5E5"> so USB device Windows machine</font>

163
00:06:54,010 --> 00:07:00,849
<font color="#E5E5E5">credentials</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> as as simple</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> it</font>

164
00:06:57,370 --> 00:07:03,639
go so at the time I<font color="#CCCCCC"> think Rob got quite</font>

165
00:07:00,850 --> 00:07:06,430
a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> press for</font><font color="#CCCCCC"> that is it was it was</font>

166
00:07:03,639 --> 00:07:10,479
so simplistic<font color="#E5E5E5"> he summed up in his own</font>

167
00:07:06,430 --> 00:07:12,060
words<font color="#CCCCCC"> USB</font><font color="#E5E5E5"> Ethernet</font><font color="#CCCCCC"> + DHCP + responder</font>

168
00:07:10,479 --> 00:07:16,150
equals<font color="#E5E5E5"> creds</font>

169
00:07:12,060 --> 00:07:17,680
so again he decided<font color="#CCCCCC"> to use some</font><font color="#E5E5E5"> quite</font>

170
00:07:16,150 --> 00:07:20,169
expensive equipment<font color="#E5E5E5"> for this so</font><font color="#CCCCCC"> he used</font>

171
00:07:17,680 --> 00:07:21,550
the<font color="#E5E5E5"> USPS</font><font color="#CCCCCC"> Armory at the time and he also</font>

172
00:07:20,169 --> 00:07:24,969
demonstrated<font color="#CCCCCC"> that it can be done on a</font>

173
00:07:21,550 --> 00:07:27,940
hat<font color="#CCCCCC"> 5 land turtle and the one slight</font>

174
00:07:24,970 --> 00:07:29,590
caveat with the process is it was it

175
00:07:27,940 --> 00:07:32,590
relies on the Windows machines being

176
00:07:29,590 --> 00:07:35,310
quite chatty<font color="#E5E5E5"> so what we found</font><font color="#CCCCCC"> saying</font>

177
00:07:32,590 --> 00:07:38,169
when we were<font color="#E5E5E5"> testing this and is that in</font>

178
00:07:35,310 --> 00:07:39,669
your<font color="#E5E5E5"> typical</font><font color="#CCCCCC"> coffee shop scenario where</font>

179
00:07:38,169 --> 00:07:41,490
you might find a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of machine</font>

180
00:07:39,669 --> 00:07:44,859
you're not going<font color="#E5E5E5"> to have so much</font><font color="#CCCCCC"> success</font>

181
00:07:41,490 --> 00:07:47,080
<font color="#E5E5E5">it's largely based around corporate</font>

182
00:07:44,860 --> 00:07:48,669
environments where you know clients are

183
00:07:47,080 --> 00:07:50,349
locked<font color="#E5E5E5"> they're already sending</font><font color="#CCCCCC"> traffic</font>

184
00:07:48,669 --> 00:07:52,390
you know they<font color="#E5E5E5"> might</font><font color="#CCCCCC"> be trying to update</font>

185
00:07:50,350 --> 00:07:55,780
their email or browsing<font color="#CCCCCC"> an internet site</font>

186
00:07:52,390 --> 00:07:58,150
<font color="#CCCCCC">etc and he also discovered it worked on</font>

187
00:07:55,780 --> 00:07:59,349
Windows 10 and earlier<font color="#E5E5E5"> and as you'll see</font>

188
00:07:58,150 --> 00:08:02,200
<font color="#E5E5E5">a little bit later in the presentation</font>

189
00:07:59,350 --> 00:08:05,169
that's kind of being caveated now but

190
00:08:02,200 --> 00:08:09,370
still 100% works on Windows<font color="#CCCCCC"> Server</font><font color="#E5E5E5"> which</font>

191
00:08:05,169 --> 00:08:13,599
<font color="#E5E5E5">is great so we had to go at replicating</font>

192
00:08:09,370 --> 00:08:15,100
this attack<font color="#E5E5E5"> so the u.s.</font><font color="#CCCCCC"> 3 armory</font><font color="#E5E5E5"> was was</font>

193
00:08:13,600 --> 00:08:16,419
Rob's weapon of choice<font color="#CCCCCC"> so we thought</font>

194
00:08:15,100 --> 00:08:18,490
we'd give this a go

195
00:08:16,419 --> 00:08:22,299
at 200 quid a time it's quite<font color="#E5E5E5"> an</font>

196
00:08:18,490 --> 00:08:25,030
<font color="#CCCCCC">expensive device</font><font color="#E5E5E5"> and it's not so easy</font><font color="#CCCCCC"> to</font>

197
00:08:22,300 --> 00:08:27,180
get going and<font color="#CCCCCC"> we also found that when</font>

198
00:08:25,030 --> 00:08:29,679
<font color="#E5E5E5">you</font><font color="#CCCCCC"> plugged it in fundamentally windows</font>

199
00:08:27,180 --> 00:08:31,600
needed<font color="#E5E5E5"> to get some drivers installed and</font>

200
00:08:29,680 --> 00:08:32,709
again<font color="#E5E5E5"> because we were looking to</font><font color="#CCCCCC"> the</font>

201
00:08:31,600 --> 00:08:36,190
<font color="#E5E5E5">target this in a corporate</font><font color="#CCCCCC"> environment</font>

202
00:08:32,708 --> 00:08:37,119
<font color="#CCCCCC">as you were</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> than aware</font><font color="#E5E5E5"> it's not</font>

203
00:08:36,190 --> 00:08:40,479
<font color="#E5E5E5">going to reach out to Windows Update</font>

204
00:08:37,120 --> 00:08:42,880
with proxies in place UAC<font color="#E5E5E5"> is been</font>

205
00:08:40,479 --> 00:08:45,520
<font color="#E5E5E5">obviously</font><font color="#CCCCCC"> brachot</font><font color="#E5E5E5"> so it wasn't wasn't</font>

206
00:08:42,880 --> 00:08:47,290
<font color="#CCCCCC">quite working to plan and</font><font color="#E5E5E5"> we thought</font>

207
00:08:45,520 --> 00:08:48,180
<font color="#E5E5E5">both of</font><font color="#CCCCCC"> those issues kind of made</font><font color="#E5E5E5"> it a</font>

208
00:08:47,290 --> 00:08:51,569
<font color="#E5E5E5">low-risk</font>

209
00:08:48,180 --> 00:08:54,349
and but we thought<font color="#E5E5E5"> we'd have a go at</font>

210
00:08:51,570 --> 00:08:57,180
maybe<font color="#E5E5E5"> 20 set the costs down at least and</font>

211
00:08:54,350 --> 00:08:59,640
so I think there's similar work out

212
00:08:57,180 --> 00:09:02,989
there as well around<font color="#E5E5E5"> this but we in</font>

213
00:08:59,640 --> 00:09:07,080
essence bought<font color="#CCCCCC"> a</font><font color="#E5E5E5"> Raspberry Pi zero</font><font color="#CCCCCC"> and</font>

214
00:09:02,990 --> 00:09:09,330
we managed to get all<font color="#E5E5E5"> of</font><font color="#CCCCCC"> Rods work and</font>

215
00:09:07,080 --> 00:09:11,580
<font color="#E5E5E5">replicate onto that so the original</font><font color="#CCCCCC"> work</font>

216
00:09:09,330 --> 00:09:13,470
<font color="#E5E5E5">was really based on and just having a</font>

217
00:09:11,580 --> 00:09:15,450
<font color="#E5E5E5">couple of services start when the device</font>

218
00:09:13,470 --> 00:09:19,020
boots up<font color="#E5E5E5"> so it's quite easily to</font>

219
00:09:15,450 --> 00:09:20,700
replicate<font color="#CCCCCC"> on syrup idea</font><font color="#E5E5E5"> and with the</font>

220
00:09:19,020 --> 00:09:22,650
<font color="#CCCCCC">pirate</font><font color="#E5E5E5"> however we still had the</font>

221
00:09:20,700 --> 00:09:25,230
emulation<font color="#E5E5E5"> issue so drivers</font><font color="#CCCCCC"> were still</font>

222
00:09:22,650 --> 00:09:27,560
<font color="#CCCCCC">required and the one thing</font><font color="#E5E5E5"> that really</font>

223
00:09:25,230 --> 00:09:30,450
frustrated us was the<font color="#E5E5E5"> fact that</font>

224
00:09:27,560 --> 00:09:31,859
fundamentally even on the<font color="#E5E5E5"> armory and the</font>

225
00:09:30,450 --> 00:09:33,960
feedback<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the device was quite</font>

226
00:09:31,860 --> 00:09:36,090
minimal so you would in essence<font color="#CCCCCC"> just see</font>

227
00:09:33,960 --> 00:09:39,330
a<font color="#E5E5E5"> little LED flashing it might turn off</font>

228
00:09:36,090 --> 00:09:41,190
<font color="#E5E5E5">they might flash longer we can really</font>

229
00:09:39,330 --> 00:09:43,410
tell what<font color="#E5E5E5"> the device is doing at any</font>

230
00:09:41,190 --> 00:09:45,150
point in time<font color="#E5E5E5"> sometimes respond it could</font>

231
00:09:43,410 --> 00:09:46,740
take up to<font color="#E5E5E5"> you know three minutes</font><font color="#CCCCCC"> to</font>

232
00:09:45,150 --> 00:09:50,060
<font color="#CCCCCC">grab some</font><font color="#E5E5E5"> credentials sometimes it might</font>

233
00:09:46,740 --> 00:09:51,990
happen quicker so we we<font color="#E5E5E5"> found that</font>

234
00:09:50,060 --> 00:09:53,910
constantly unplugging and plugging the

235
00:09:51,990 --> 00:09:55,950
device in ended up you know corrupting

236
00:09:53,910 --> 00:09:57,050
the SD<font color="#E5E5E5"> cards a lot of the time and we</font>

237
00:09:55,950 --> 00:10:01,170
had to<font color="#CCCCCC"> spend</font><font color="#E5E5E5"> it quite a bit time</font>

238
00:09:57,050 --> 00:10:03,120
<font color="#E5E5E5">rebuilding them thereafter so we got</font>

239
00:10:01,170 --> 00:10:05,640
thinking that we could try<font color="#CCCCCC"> and make</font><font color="#E5E5E5"> this</font>

240
00:10:03,120 --> 00:10:07,620
a<font color="#E5E5E5"> little bit better so and this is kind</font>

241
00:10:05,640 --> 00:10:10,860
of where we<font color="#E5E5E5"> get to</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> the project</font><font color="#CCCCCC"> and</font>

242
00:10:07,620 --> 00:10:14,160
the talk as it is<font color="#E5E5E5"> today and so whilst</font>

243
00:10:10,860 --> 00:10:16,280
snagging the creds<font color="#E5E5E5"> is great it still</font>

244
00:10:14,160 --> 00:10:20,160
<font color="#CCCCCC">means that we</font><font color="#E5E5E5"> have to take them offline</font>

245
00:10:16,280 --> 00:10:21,839
to crack them so whilst you<font color="#CCCCCC"> can use it</font>

246
00:10:20,160 --> 00:10:23,130
as a bit of<font color="#E5E5E5"> a harvesting stool whilst</font>

247
00:10:21,840 --> 00:10:25,260
you're in<font color="#E5E5E5"> front of the machine we got</font>

248
00:10:23,130 --> 00:10:26,970
thinking well perhaps it's better if it

249
00:10:25,260 --> 00:10:28,290
just<font color="#E5E5E5"> unlocks the machine because you</font>

250
00:10:26,970 --> 00:10:31,830
<font color="#E5E5E5">already made the</font><font color="#CCCCCC"> effort to get to</font><font color="#E5E5E5"> that</font>

251
00:10:28,290 --> 00:10:34,250
point<font color="#E5E5E5"> anyway</font><font color="#CCCCCC"> so the whole aim for us was</font>

252
00:10:31,830 --> 00:10:36,840
<font color="#CCCCCC">to try and make something that was</font>

253
00:10:34,250 --> 00:10:41,010
usable in essence so overcome those

254
00:10:36,840 --> 00:10:43,110
initial hurdles that<font color="#CCCCCC"> we saw with</font><font color="#E5E5E5"> under</font>

255
00:10:41,010 --> 00:10:45,240
<font color="#E5E5E5">the driver issues give it some better</font>

256
00:10:43,110 --> 00:10:47,130
<font color="#CCCCCC">feedback make it cheaper no one</font><font color="#E5E5E5"> really</font>

257
00:10:45,240 --> 00:10:48,390
<font color="#E5E5E5">wants to spend</font><font color="#CCCCCC"> two hundred quid on a</font><font color="#E5E5E5"> USB</font>

258
00:10:47,130 --> 00:10:51,000
<font color="#CCCCCC">armory every time you want to</font><font color="#E5E5E5"> do</font>

259
00:10:48,390 --> 00:10:53,280
specially if<font color="#E5E5E5"> you're going to lose it</font><font color="#CCCCCC"> and</font>

260
00:10:51,000 --> 00:10:55,530
<font color="#E5E5E5">also make it flag and play so again you</font>

261
00:10:53,280 --> 00:10:57,480
<font color="#E5E5E5">don't really want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> have to plug in the</font>

262
00:10:55,530 --> 00:10:59,939
<font color="#CCCCCC">device</font><font color="#E5E5E5"> and tinker with the code every</font>

263
00:10:57,480 --> 00:11:01,960
time<font color="#E5E5E5"> you use it or or you know that sort</font>

264
00:10:59,940 --> 00:11:04,570
<font color="#CCCCCC">of</font><font color="#E5E5E5"> thing so really in essence</font>

265
00:11:01,960 --> 00:11:06,730
wanted to simplify<font color="#E5E5E5"> it for some reason</font>

266
00:11:04,570 --> 00:11:11,440
<font color="#CCCCCC">John really loves</font><font color="#E5E5E5"> this slide and so I</font>

267
00:11:06,730 --> 00:11:13,090
left<font color="#E5E5E5"> it in so we</font><font color="#CCCCCC"> got thinking and we try</font>

268
00:11:11,440 --> 00:11:14,560
to<font color="#E5E5E5"> break it down into those sort of</font>

269
00:11:13,090 --> 00:11:17,850
component<font color="#CCCCCC"> parts so the user feedback</font>

270
00:11:14,560 --> 00:11:24,010
<font color="#E5E5E5">making it usable and driverless installs</font>

271
00:11:17,850 --> 00:11:28,330
and<font color="#CCCCCC"> unplugged and</font><font color="#E5E5E5"> play so we starts with</font>

272
00:11:24,010 --> 00:11:32,140
the<font color="#E5E5E5"> PI</font><font color="#CCCCCC"> zero</font><font color="#E5E5E5"> and partly because it's so</font>

273
00:11:28,330 --> 00:11:35,350
mentally cheap and and<font color="#E5E5E5"> also had a few</font>

274
00:11:32,140 --> 00:11:37,300
perks that come with<font color="#CCCCCC"> it so as</font><font color="#E5E5E5"> you can</font>

275
00:11:35,350 --> 00:11:38,980
<font color="#CCCCCC">see on the image</font><font color="#E5E5E5"> there it doesn't have a</font>

276
00:11:37,300 --> 00:11:40,859
lot of interfaces<font color="#E5E5E5"> but it does have a USB</font>

277
00:11:38,980 --> 00:11:43,570
<font color="#CCCCCC">port and</font><font color="#E5E5E5"> it does have a power port and</font>

278
00:11:40,860 --> 00:11:46,000
the one good thing is<font color="#CCCCCC"> that it</font><font color="#E5E5E5"> takes its</font>

279
00:11:43,570 --> 00:11:47,680
power from either<font color="#CCCCCC"> so it can be</font><font color="#E5E5E5"> powered</font>

280
00:11:46,000 --> 00:11:48,910
over the data port<font color="#E5E5E5"> so that means you</font>

281
00:11:47,680 --> 00:11:51,160
<font color="#CCCCCC">don't</font><font color="#E5E5E5"> have to carry around a separate</font>

282
00:11:48,910 --> 00:11:53,709
power<font color="#CCCCCC"> supply and</font><font color="#E5E5E5"> it kind of performs as</font>

283
00:11:51,160 --> 00:11:55,540
it would do in the original<font color="#E5E5E5"> attack so</font>

284
00:11:53,710 --> 00:11:58,990
<font color="#CCCCCC">you just need</font><font color="#E5E5E5"> a normal</font><font color="#CCCCCC"> go cable</font><font color="#E5E5E5"> and the</font>

285
00:11:55,540 --> 00:12:01,270
way you go<font color="#CCCCCC"> the</font><font color="#E5E5E5"> other and probably the</font>

286
00:11:58,990 --> 00:12:04,200
most important part is that<font color="#E5E5E5"> the device</font>

287
00:12:01,270 --> 00:12:09,189
can<font color="#CCCCCC"> be put into host or slave mode so</font>

288
00:12:04,200 --> 00:12:10,600
for a<font color="#E5E5E5"> USB device when it seems</font><font color="#CCCCCC"> or device</font>

289
00:12:09,190 --> 00:12:13,180
like<font color="#CCCCCC"> this when it's in host mode it</font><font color="#E5E5E5"> will</font>

290
00:12:10,600 --> 00:12:16,750
quite<font color="#E5E5E5"> happily receive connections</font>

291
00:12:13,180 --> 00:12:18,640
so from<font color="#E5E5E5"> keyboards mice etc when it's in</font>

292
00:12:16,750 --> 00:12:20,500
slave mode however<font color="#E5E5E5"> it can then do the</font>

293
00:12:18,640 --> 00:12:22,420
emulation stuff<font color="#E5E5E5"> so because we were</font>

294
00:12:20,500 --> 00:12:24,550
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to do feedback so</font>

295
00:12:22,420 --> 00:12:28,329
<font color="#CCCCCC">reuse the credentials that</font><font color="#E5E5E5"> we had that</font>

296
00:12:24,550 --> 00:12:30,189
<font color="#E5E5E5">we had snapped and cracked we needed to</font>

297
00:12:28,330 --> 00:12:31,960
be able<font color="#E5E5E5"> to switch it into into that mode</font>

298
00:12:30,190 --> 00:12:33,940
as well so we emulate network adapters

299
00:12:31,960 --> 00:12:36,100
<font color="#E5E5E5">and we wanted to emulate a keyboard</font><font color="#CCCCCC"> so</font>

300
00:12:33,940 --> 00:12:38,940
<font color="#CCCCCC">that we could type it back in so</font><font color="#E5E5E5"> that's</font>

301
00:12:36,100 --> 00:12:42,070
quite a key piece<font color="#CCCCCC"> to the puzzle</font><font color="#E5E5E5"> and</font>

302
00:12:38,940 --> 00:12:43,270
obviously a small tiny and and it's

303
00:12:42,070 --> 00:12:45,640
designed for a whole community<font color="#CCCCCC"> people</font>

304
00:12:43,270 --> 00:12:47,620
<font color="#E5E5E5">that like</font><font color="#CCCCCC"> to design wonderful cases or</font>

305
00:12:45,640 --> 00:12:49,449
various<font color="#E5E5E5"> colors sizes and whatever so</font>

306
00:12:47,620 --> 00:12:53,590
wrapping it in<font color="#E5E5E5"> a case and put it in</font><font color="#CCCCCC"> your</font>

307
00:12:49,450 --> 00:12:56,350
pocket<font color="#CCCCCC"> and made it</font><font color="#E5E5E5"> quite ideal it comes</font>

308
00:12:53,590 --> 00:12:57,850
with its own strong sort of community

309
00:12:56,350 --> 00:13:00,400
<font color="#CCCCCC">backing as well</font><font color="#E5E5E5"> so there are various</font>

310
00:12:57,850 --> 00:13:02,800
<font color="#CCCCCC">Linux distros for it so again</font><font color="#E5E5E5"> getting it</font>

311
00:13:00,400 --> 00:13:05,140
<font color="#E5E5E5">installed on a micro SD card and it's</font>

312
00:13:02,800 --> 00:13:07,300
<font color="#E5E5E5">really no problem</font><font color="#CCCCCC"> at all</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> actually</font>

313
00:13:05,140 --> 00:13:09,699
the most again kind<font color="#E5E5E5"> of an important</font>

314
00:13:07,300 --> 00:13:11,260
piece<font color="#CCCCCC"> to this is along</font><font color="#E5E5E5"> the very side of</font>

315
00:13:09,700 --> 00:13:13,779
it<font color="#E5E5E5"> and for those that you don't know it</font>

316
00:13:11,260 --> 00:13:16,600
has the GPIO pins which are<font color="#E5E5E5"> just in</font>

317
00:13:13,779 --> 00:13:17,920
and output interfaces<font color="#E5E5E5"> but because it's</font>

318
00:13:16,600 --> 00:13:20,019
designed<font color="#CCCCCC"> for</font><font color="#E5E5E5"> a community people</font><font color="#CCCCCC"> that</font>

319
00:13:17,920 --> 00:13:22,870
quite happily like to tinker is designed

320
00:13:20,019 --> 00:13:25,420
to have various<font color="#CCCCCC"> motor</font><font color="#E5E5E5"> senses and other</font>

321
00:13:22,870 --> 00:13:26,439
devices plugged into it<font color="#E5E5E5"> so for</font><font color="#CCCCCC"> us we got</font>

322
00:13:25,420 --> 00:13:27,819
thinking<font color="#E5E5E5"> that</font><font color="#CCCCCC"> that'd be a good</font>

323
00:13:26,439 --> 00:13:29,709
opportunity to<font color="#E5E5E5"> be able to give it some</font>

324
00:13:27,819 --> 00:13:35,199
feedback and which<font color="#CCCCCC"> we'll touch on</font><font color="#E5E5E5"> a</font>

325
00:13:29,709 --> 00:13:38,619
little<font color="#E5E5E5"> bit later</font><font color="#CCCCCC"> so the downside of the</font>

326
00:13:35,199 --> 00:13:41,589
<font color="#CCCCCC">PI 0 is however we wanted to crack the</font>

327
00:13:38,620 --> 00:13:44,290
credentials<font color="#E5E5E5"> and play them back so as you</font>

328
00:13:41,589 --> 00:13:48,249
can<font color="#CCCCCC"> imagine</font><font color="#E5E5E5"> doing any sort of cracking</font>

329
00:13:44,290 --> 00:13:50,230
on a on a single<font color="#CCCCCC"> processor one gig on</font>

330
00:13:48,249 --> 00:13:51,579
processor with photo and<font color="#E5E5E5"> troll mega</font><font color="#CCCCCC"> RAM</font>

331
00:13:50,230 --> 00:13:56,199
is not going to<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to get you very</font>

332
00:13:51,579 --> 00:13:57,939
far<font color="#CCCCCC"> we</font><font color="#E5E5E5"> wanted it</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> as</font><font color="#CCCCCC"> the title</font>

333
00:13:56,199 --> 00:14:00,040
suggests<font color="#CCCCCC"> like the movie so we didn't</font>

334
00:13:57,939 --> 00:14:02,170
<font color="#E5E5E5">want you</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> plug it in hang around for</font>

335
00:14:00,040 --> 00:14:04,449
5-10 minutes<font color="#CCCCCC"> 2 hours 3</font><font color="#E5E5E5"> hours whatever</font>

336
00:14:02,170 --> 00:14:06,370
<font color="#E5E5E5">make a cup of coffee</font><font color="#CCCCCC"> we kind of wanted</font>

337
00:14:04,449 --> 00:14:08,680
it to be as<font color="#E5E5E5"> instantaneous as possible so</font>

338
00:14:06,370 --> 00:14:09,819
although<font color="#E5E5E5"> there are and again as</font><font color="#CCCCCC"> you'll</font>

339
00:14:08,680 --> 00:14:12,399
see in the demo<font color="#CCCCCC"> there's a little bit of</font>

340
00:14:09,819 --> 00:14:14,439
<font color="#CCCCCC">a delay in it</font><font color="#E5E5E5"> we've got the time right</font>

341
00:14:12,399 --> 00:14:18,819
down by<font color="#E5E5E5"> not relying on the PI and 0</font>

342
00:14:14,439 --> 00:14:22,089
<font color="#E5E5E5">doing the cracking itself so if we can</font>

343
00:14:18,819 --> 00:14:24,459
crack on the PI<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> without thinking</font><font color="#E5E5E5"> about</font>

344
00:14:22,089 --> 00:14:26,439
where we<font color="#CCCCCC"> could do the cracking and and</font>

345
00:14:24,459 --> 00:14:28,359
<font color="#E5E5E5">obviously add again so many pen testers</font>

346
00:14:26,439 --> 00:14:30,160
and<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> will know there's various</font>

347
00:14:28,360 --> 00:14:32,319
libraries or precomputed hashes out

348
00:14:30,160 --> 00:14:33,879
there and we<font color="#CCCCCC"> thought that would</font><font color="#E5E5E5"> be a</font>

349
00:14:32,319 --> 00:14:35,769
good place<font color="#CCCCCC"> to</font><font color="#E5E5E5"> start because at least</font>

350
00:14:33,879 --> 00:14:37,779
<font color="#E5E5E5">then we'd get some immediate response</font>

351
00:14:35,769 --> 00:14:39,850
back so we could<font color="#E5E5E5"> over say this hash was</font>

352
00:14:37,779 --> 00:14:41,860
a simple password<font color="#CCCCCC"> and it would get</font>

353
00:14:39,850 --> 00:14:43,209
<font color="#E5E5E5">cracked immediately or nothing and we</font>

354
00:14:41,860 --> 00:14:47,920
can just shut the device down and move

355
00:14:43,209 --> 00:14:50,559
on so<font color="#CCCCCC"> we did find a</font><font color="#E5E5E5"> problem with using</font>

356
00:14:47,920 --> 00:14:53,290
<font color="#CCCCCC">that approach alder so this is quite</font><font color="#E5E5E5"> a</font>

357
00:14:50,559 --> 00:14:56,500
quite a busy slide<font color="#E5E5E5"> but as you can see up</font>

358
00:14:53,290 --> 00:14:57,699
there<font color="#CCCCCC"> responder</font><font color="#E5E5E5"> quite happily emulates</font>

359
00:14:56,500 --> 00:15:03,579
all<font color="#E5E5E5"> those various services as I</font>

360
00:14:57,699 --> 00:15:05,290
mentioned earlier so<font color="#CCCCCC"> HTTP HTTP etc and</font>

361
00:15:03,579 --> 00:15:07,479
what it tends<font color="#E5E5E5"> to do is because it's</font>

362
00:15:05,290 --> 00:15:09,550
performing<font color="#E5E5E5"> the challenge response for</font>

363
00:15:07,480 --> 00:15:11,800
those services and for an<font color="#CCCCCC"> ntlm</font>

364
00:15:09,550 --> 00:15:14,399
perspective it doesn't just store a

365
00:15:11,800 --> 00:15:16,660
<font color="#E5E5E5">plain hash it stores a salted hash so</font>

366
00:15:14,399 --> 00:15:19,059
but the good thing<font color="#CCCCCC"> is we</font><font color="#E5E5E5"> know the salt</font>

367
00:15:16,660 --> 00:15:21,279
because responder is doing the<font color="#E5E5E5"> challenge</font>

368
00:15:19,059 --> 00:15:23,259
<font color="#E5E5E5">response so responder is in essence</font>

369
00:15:21,279 --> 00:15:25,899
sending that initial challenge and a

370
00:15:23,259 --> 00:15:27,220
salted hash<font color="#CCCCCC"> thereafter</font><font color="#E5E5E5"> is a mix of the</font>

371
00:15:25,899 --> 00:15:29,290
domain the user

372
00:15:27,220 --> 00:15:31,720
and that challenge<font color="#CCCCCC"> so we have all the</font>

373
00:15:29,290 --> 00:15:33,760
information<font color="#E5E5E5"> we need</font>

374
00:15:31,720 --> 00:15:36,640
but the download is the online crackers

375
00:15:33,760 --> 00:15:38,710
typically prefer unsalted hashes<font color="#CCCCCC"> so I</font>

376
00:15:36,640 --> 00:15:40,960
guess some<font color="#CCCCCC"> of you</font><font color="#E5E5E5"> probably use crack</font>

377
00:15:38,710 --> 00:15:43,810
station in the past and you<font color="#E5E5E5"> can see down</font>

378
00:15:40,960 --> 00:15:46,300
the<font color="#CCCCCC"> bottom there quite happily crack NT</font>

379
00:15:43,810 --> 00:15:48,699
and<font color="#CCCCCC"> Ln passwords</font><font color="#E5E5E5"> a bit like the typical</font>

380
00:15:46,300 --> 00:15:52,469
<font color="#E5E5E5">output</font><font color="#CCCCCC"> from the Sam</font><font color="#E5E5E5"> table but it won't</font>

381
00:15:48,700 --> 00:15:54,640
help us in<font color="#E5E5E5"> doing those salted hashes</font>

382
00:15:52,470 --> 00:15:56,580
it's just another example of another

383
00:15:54,640 --> 00:15:58,870
<font color="#E5E5E5">online cracker</font><font color="#CCCCCC"> and again similar thing</font>

384
00:15:56,580 --> 00:16:00,970
<font color="#E5E5E5">where I</font><font color="#CCCCCC"> believes you the ntlm and LM</font>

385
00:15:58,870 --> 00:16:04,990
straight out of the<font color="#CCCCCC"> Sam but but not</font><font color="#E5E5E5"> what</font>

386
00:16:00,970 --> 00:16:06,370
<font color="#E5E5E5">we were hoping</font><font color="#CCCCCC"> to crack so we wanted to</font>

387
00:16:04,990 --> 00:16:10,630
obviously do it ourselves

388
00:16:06,370 --> 00:16:12,280
<font color="#CCCCCC">and</font><font color="#E5E5E5"> we decided</font><font color="#CCCCCC"> this and and also because</font>

389
00:16:10,630 --> 00:16:14,620
the<font color="#E5E5E5"> clients data that we're working with</font>

390
00:16:12,280 --> 00:16:15,730
it it's sensitive<font color="#CCCCCC"> its password data</font><font color="#E5E5E5"> we</font>

391
00:16:14,620 --> 00:16:18,910
wanted<font color="#E5E5E5"> to put it into an environment</font>

392
00:16:15,730 --> 00:16:21,280
<font color="#E5E5E5">where we were in control and</font><font color="#CCCCCC"> obviously</font>

393
00:16:18,910 --> 00:16:23,530
the application is like<font color="#E5E5E5"> John and</font>

394
00:16:21,280 --> 00:16:25,420
<font color="#E5E5E5">hashcode John the Ripper</font><font color="#CCCCCC"> and they</font><font color="#E5E5E5"> will</font>

395
00:16:23,530 --> 00:16:27,670
quite happily<font color="#E5E5E5"> crack passwords and these</font>

396
00:16:25,420 --> 00:16:30,939
<font color="#CCCCCC">salted hashes all day long and we can</font>

397
00:16:27,670 --> 00:16:33,810
control the word<font color="#E5E5E5"> lists so that exactly</font>

398
00:16:30,940 --> 00:16:36,340
<font color="#E5E5E5">what we wanted to do and</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> that and</font>

399
00:16:33,810 --> 00:16:40,150
as<font color="#E5E5E5"> you can imagine we just spun up an</font>

400
00:16:36,340 --> 00:16:42,370
AWS ec2 instance<font color="#E5E5E5"> do</font><font color="#CCCCCC"> know on a little</font><font color="#E5E5E5"> bit</font>

401
00:16:40,150 --> 00:16:46,600
of a shoestring budget so we only only

402
00:16:42,370 --> 00:16:48,490
went for the cheap<font color="#CCCCCC"> t2 micro option but</font>

403
00:16:46,600 --> 00:16:49,960
as you can<font color="#CCCCCC"> see it's</font><font color="#E5E5E5"> already doing</font><font color="#CCCCCC"> it</font>

404
00:16:48,490 --> 00:16:53,800
<font color="#E5E5E5">eight</font><font color="#CCCCCC"> times faster</font><font color="#E5E5E5"> the cracking and</font><font color="#CCCCCC"> the</font>

405
00:16:49,960 --> 00:16:55,840
<font color="#CCCCCC">pi0 itself if you want to scale that up</font>

406
00:16:53,800 --> 00:16:57,280
and<font color="#CCCCCC"> internal touch touch on this a</font>

407
00:16:55,840 --> 00:17:00,430
<font color="#E5E5E5">little bit later as</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> then the</font>

408
00:16:57,280 --> 00:17:01,810
options are there but there is one snag

409
00:17:00,430 --> 00:17:04,329
now before I put this next<font color="#E5E5E5"> slide up for</font>

410
00:17:01,810 --> 00:17:05,560
some<font color="#E5E5E5"> of you in the know and bearing in</font>

411
00:17:04,329 --> 00:17:09,129
mind when we did the initial<font color="#E5E5E5"> research</font>

412
00:17:05,560 --> 00:17:13,379
for this this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> back in 2016 and so at</font>

413
00:17:09,130 --> 00:17:15,610
the time<font color="#E5E5E5"> there</font><font color="#CCCCCC"> was no</font><font color="#E5E5E5"> Wi-Fi and</font>

414
00:17:13,380 --> 00:17:17,050
available in the PI<font color="#CCCCCC"> zero and this</font><font color="#E5E5E5"> is</font>

415
00:17:15,609 --> 00:17:19,629
<font color="#E5E5E5">probably guys thinking why no</font><font color="#CCCCCC"> one's for</font>

416
00:17:17,050 --> 00:17:21,879
the<font color="#CCCCCC"> trying</font><font color="#E5E5E5"> listed</font><font color="#CCCCCC"> before that is</font><font color="#E5E5E5"> and as</font>

417
00:17:19,630 --> 00:17:24,430
<font color="#CCCCCC">I command</font><font color="#E5E5E5"> to in a minute you'll</font><font color="#CCCCCC"> see and</font>

418
00:17:21,880 --> 00:17:28,270
why it was quite such an<font color="#CCCCCC"> arduous task to</font>

419
00:17:24,430 --> 00:17:32,830
<font color="#E5E5E5">try and get it get</font><font color="#CCCCCC"> it working</font><font color="#E5E5E5"> so we had</font>

420
00:17:28,270 --> 00:17:35,650
some options for the wireless<font color="#CCCCCC"> first of</font>

421
00:17:32,830 --> 00:17:37,899
<font color="#E5E5E5">all most people and seem to suggest I'll</font>

422
00:17:35,650 --> 00:17:38,400
just plug in a USB dongle<font color="#CCCCCC"> and away you</font>

423
00:17:37,900 --> 00:17:40,659
go

424
00:17:38,400 --> 00:17:42,759
so the downside<font color="#E5E5E5"> to this is</font>

425
00:17:40,659 --> 00:17:45,159
<font color="#E5E5E5">as I said thought the</font><font color="#CCCCCC"> over can run in</font>

426
00:17:42,759 --> 00:17:47,710
host mode<font color="#E5E5E5"> or slave mode</font><font color="#CCCCCC"> as soon as you</font>

427
00:17:45,159 --> 00:17:49,239
<font color="#E5E5E5">plug in a USB dongle it becomes so</font>

428
00:17:47,710 --> 00:17:50,679
smooth and then<font color="#CCCCCC"> you can't do the</font>

429
00:17:49,239 --> 00:17:52,779
<font color="#E5E5E5">emulation of the keyboard and</font><font color="#CCCCCC"> a network</font>

430
00:17:50,679 --> 00:17:54,879
<font color="#E5E5E5">adapter</font><font color="#CCCCCC"> and we've only</font><font color="#E5E5E5"> got one USB port</font>

431
00:17:52,779 --> 00:17:56,139
<font color="#CCCCCC">so that's</font><font color="#E5E5E5"> not really an option</font><font color="#CCCCCC"> and we'd</font>

432
00:17:54,879 --> 00:17:59,049
have to<font color="#CCCCCC"> carry a battery around</font><font color="#E5E5E5"> to try</font>

433
00:17:56,139 --> 00:18:01,478
<font color="#E5E5E5">and power it on the far right there</font>

434
00:17:59,049 --> 00:18:03,549
there was various sort of<font color="#CCCCCC"> serial hats</font>

435
00:18:01,479 --> 00:18:04,649
that<font color="#E5E5E5"> you can get</font><font color="#CCCCCC"> plug</font><font color="#E5E5E5"> on top of the USB</font>

436
00:18:03,549 --> 00:18:07,539
<font color="#CCCCCC">and the pi0</font>

437
00:18:04,649 --> 00:18:09,279
again these are brilliant<font color="#E5E5E5"> however they</font>

438
00:18:07,539 --> 00:18:11,830
would they were kind of reliant on

439
00:18:09,279 --> 00:18:13,450
previous the<font color="#E5E5E5"> old-school</font><font color="#CCCCCC"> 80</font><font color="#E5E5E5"> commands</font>

440
00:18:11,830 --> 00:18:14,918
you'd have to<font color="#E5E5E5"> write your own packet</font>

441
00:18:13,450 --> 00:18:17,529
<font color="#E5E5E5">making the whole</font><font color="#CCCCCC"> communication a little</font>

442
00:18:14,919 --> 00:18:20,679
<font color="#CCCCCC">bit tricky and then to the real</font><font color="#E5E5E5"> extreme</font>

443
00:18:17,529 --> 00:18:23,139
in the middle we had those<font color="#CCCCCC"> people</font><font color="#E5E5E5"> that</font>

444
00:18:20,679 --> 00:18:26,950
like to<font color="#CCCCCC"> do sobering and use various</font>

445
00:18:23,139 --> 00:18:29,199
amounts of tape and that just horrified

446
00:18:26,950 --> 00:18:30,460
us that's the<font color="#E5E5E5"> whole point of this was we</font>

447
00:18:29,200 --> 00:18:32,259
wanted to<font color="#CCCCCC"> make something</font><font color="#E5E5E5"> that was really</font>

448
00:18:30,460 --> 00:18:34,090
<font color="#E5E5E5">dutiful and we didn't want to come along</font>

449
00:18:32,259 --> 00:18:35,979
and say here's a brilliant device

450
00:18:34,090 --> 00:18:37,959
<font color="#E5E5E5">however you know if you have 20 hours</font>

451
00:18:35,979 --> 00:18:41,229
free you can do some<font color="#E5E5E5"> soldiering and</font>

452
00:18:37,960 --> 00:18:44,619
<font color="#E5E5E5">you'll be away so amazingly it took</font>

453
00:18:41,229 --> 00:18:46,269
quite<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> research</font><font color="#CCCCCC"> to find this but</font>

454
00:18:44,619 --> 00:18:49,689
<font color="#CCCCCC">there was a device</font><font color="#E5E5E5"> a Kickstarter project</font>

455
00:18:46,269 --> 00:18:52,119
<font color="#CCCCCC">and and this</font><font color="#E5E5E5"> red bear hat which gave</font><font color="#CCCCCC"> us</font>

456
00:18:49,690 --> 00:18:56,769
in essence Bluetooth and wireless

457
00:18:52,119 --> 00:18:58,869
capabilities<font color="#E5E5E5"> so it didn't immediately</font>

458
00:18:56,769 --> 00:19:01,479
<font color="#E5E5E5">jump</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the top of any internet searches</font>

459
00:18:58,869 --> 00:19:03,399
<font color="#CCCCCC">however and the benefit of this</font><font color="#E5E5E5"> is it</font>

460
00:19:01,479 --> 00:19:05,200
uses all<font color="#CCCCCC"> of those GPIO pins we mentioned</font>

461
00:19:03,399 --> 00:19:07,570
earlier so great we<font color="#E5E5E5"> weren't using them</font>

462
00:19:05,200 --> 00:19:10,029
<font color="#CCCCCC">in it</font><font color="#E5E5E5"> and it comes pre</font><font color="#CCCCCC"> sort of the</font>

463
00:19:07,570 --> 00:19:14,289
headers<font color="#E5E5E5"> so again no real need</font><font color="#CCCCCC"> to do any</font>

464
00:19:10,029 --> 00:19:16,149
soldering it comes with a custom EEPROM

465
00:19:14,289 --> 00:19:19,109
as well so it<font color="#E5E5E5"> means when the device</font>

466
00:19:16,149 --> 00:19:20,738
boots<font color="#E5E5E5"> it pre-configured all of the</font>

467
00:19:19,109 --> 00:19:22,960
<font color="#CCCCCC">freaking because all of the wireless</font>

468
00:19:20,739 --> 00:19:24,580
details<font color="#CCCCCC"> so there's no</font><font color="#E5E5E5"> there's no</font><font color="#CCCCCC"> need to</font>

469
00:19:22,960 --> 00:19:26,859
do any driver installs or anything funny

470
00:19:24,580 --> 00:19:29,859
you just get a<font color="#CCCCCC"> W nonzero presented</font>

471
00:19:26,859 --> 00:19:32,019
straight out of the box and soldiering

472
00:19:29,859 --> 00:19:33,580
however still caused us some issues I

473
00:19:32,019 --> 00:19:36,519
<font color="#CCCCCC">don't know if many</font><font color="#E5E5E5"> of you out there like</font>

474
00:19:33,580 --> 00:19:38,739
<font color="#E5E5E5">to do so during soldering 40 pins at a</font>

475
00:19:36,519 --> 00:19:42,399
time for a novice like myself<font color="#E5E5E5"> and John</font>

476
00:19:38,739 --> 00:19:44,979
is<font color="#CCCCCC"> it's a stressful task</font><font color="#E5E5E5"> certainly not</font>

477
00:19:42,399 --> 00:19:46,178
therapeutic so we went<font color="#E5E5E5"> to try and find</font>

478
00:19:44,979 --> 00:19:48,249
something<font color="#E5E5E5"> that</font><font color="#CCCCCC"> would be a</font><font color="#E5E5E5"> little bit</font>

479
00:19:46,179 --> 00:19:50,169
<font color="#CCCCCC">easier and a little bit more</font>

480
00:19:48,249 --> 00:19:53,740
reproducible so we<font color="#E5E5E5"> do come</font><font color="#CCCCCC"> across these</font>

481
00:19:50,169 --> 00:19:56,170
wonderful solderless headers so

482
00:19:53,740 --> 00:19:59,920
<font color="#CCCCCC">I find</font><font color="#E5E5E5"> using a hammer</font><font color="#CCCCCC"> much more</font>

483
00:19:56,170 --> 00:20:02,200
therapeutic than<font color="#CCCCCC"> soldiering so we</font>

484
00:19:59,920 --> 00:20:03,490
thought<font color="#E5E5E5"> that was</font><font color="#CCCCCC"> great so you put these</font>

485
00:20:02,200 --> 00:20:04,780
in<font color="#E5E5E5"> place and you</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> hit it with</font><font color="#CCCCCC"> a</font>

486
00:20:03,490 --> 00:20:07,840
<font color="#CCCCCC">hammer and</font><font color="#E5E5E5"> away you go</font>

487
00:20:04,780 --> 00:20:10,178
so in essence that<font color="#E5E5E5"> gave us our wireless</font>

488
00:20:07,840 --> 00:20:13,050
capability so we<font color="#E5E5E5"> had our</font><font color="#CCCCCC"> pi0</font><font color="#E5E5E5"> solderless</font>

489
00:20:10,179 --> 00:20:15,340
<font color="#E5E5E5">letters</font><font color="#CCCCCC"> and a read their hands up</font><font color="#E5E5E5"> and</font>

490
00:20:13,050 --> 00:20:17,110
the<font color="#CCCCCC"> read</font><font color="#E5E5E5"> Barrett will deliver be</font>

491
00:20:15,340 --> 00:20:19,120
expensive<font color="#E5E5E5"> so it kind of hit our budget</font>

492
00:20:17,110 --> 00:20:21,428
we wanted<font color="#E5E5E5"> to try and keep the cost down</font>

493
00:20:19,120 --> 00:20:23,110
<font color="#E5E5E5">and it had to ship from</font><font color="#CCCCCC"> Hong Kong</font><font color="#E5E5E5"> so we</font>

494
00:20:21,429 --> 00:20:27,670
had to wait you know the best part<font color="#CCCCCC"> of</font>

495
00:20:23,110 --> 00:20:29,080
four weeks for<font color="#CCCCCC"> it to arrive</font><font color="#E5E5E5"> the next</font>

496
00:20:27,670 --> 00:20:30,220
thing we wanted<font color="#E5E5E5"> to look at and as I</font>

497
00:20:29,080 --> 00:20:31,960
mentioned<font color="#E5E5E5"> earlier is trying to improve</font>

498
00:20:30,220 --> 00:20:35,290
that<font color="#E5E5E5"> user feedback so having one little</font>

499
00:20:31,960 --> 00:20:36,550
LED<font color="#E5E5E5"> that blinks isn't great we didn't</font>

500
00:20:35,290 --> 00:20:37,990
want to<font color="#E5E5E5"> make this like a school project</font>

501
00:20:36,550 --> 00:20:40,210
<font color="#CCCCCC">so we didn't want to then have a</font>

502
00:20:37,990 --> 00:20:43,090
<font color="#E5E5E5">whopping</font><font color="#CCCCCC"> great big LED just sold it</font><font color="#E5E5E5"> on</font>

503
00:20:40,210 --> 00:20:45,309
hanging<font color="#E5E5E5"> off the side</font><font color="#CCCCCC"> so we tried to have</font>

504
00:20:43,090 --> 00:20:47,230
<font color="#E5E5E5">a little</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> a bit into the</font><font color="#CCCCCC"> other</font>

505
00:20:45,309 --> 00:20:49,750
<font color="#E5E5E5">resource available and like I say</font><font color="#CCCCCC"> pi0</font>

506
00:20:47,230 --> 00:20:51,610
and the whole<font color="#E5E5E5"> pie community there are so</font>

507
00:20:49,750 --> 00:20:53,890
many customizable interfaces and modules

508
00:20:51,610 --> 00:20:56,860
so we found<font color="#E5E5E5"> that we could</font><font color="#CCCCCC"> get a nice</font>

509
00:20:53,890 --> 00:20:59,140
little LED matrix<font color="#CCCCCC"> to sit on top</font><font color="#E5E5E5"> of the</font>

510
00:20:56,860 --> 00:21:01,479
GPIO pins in essence and<font color="#CCCCCC"> that would give</font>

511
00:20:59,140 --> 00:21:03,460
us<font color="#CCCCCC"> some feedback so and</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> only just an</font>

512
00:21:01,480 --> 00:21:04,900
<font color="#CCCCCC">on/off feedback we could stage it so we</font>

513
00:21:03,460 --> 00:21:07,059
knew exactly<font color="#E5E5E5"> where the device was at any</font>

514
00:21:04,900 --> 00:21:08,350
point in time<font color="#CCCCCC"> and fundamentally that</font>

515
00:21:07,059 --> 00:21:09,760
helped us<font color="#E5E5E5"> with the whole debugging as</font>

516
00:21:08,350 --> 00:21:12,669
well so when we were building the thing

517
00:21:09,760 --> 00:21:16,360
we knew exactly what what stage<font color="#E5E5E5"> we were</font>

518
00:21:12,670 --> 00:21:18,190
<font color="#CCCCCC">on so at this point I'll leave this</font>

519
00:21:16,360 --> 00:21:20,020
slide<font color="#CCCCCC"> up here just for you to ponder and</font>

520
00:21:18,190 --> 00:21:24,010
<font color="#E5E5E5">but I'll hand</font><font color="#CCCCCC"> it over to</font><font color="#E5E5E5"> John view take</font>

521
00:21:20,020 --> 00:21:26,320
you<font color="#CCCCCC"> to</font><font color="#E5E5E5"> next after presentation thank you</font>

522
00:21:24,010 --> 00:21:28,660
<font color="#E5E5E5">very much okay so what you're</font><font color="#CCCCCC"> looking at</font>

523
00:21:26,320 --> 00:21:30,700
<font color="#E5E5E5">here on the left hand side is the GPIO</font>

524
00:21:28,660 --> 00:21:32,770
pin out for the<font color="#E5E5E5"> Red Bear device we were</font>

525
00:21:30,700 --> 00:21:35,010
<font color="#CCCCCC">using and on the right hand side are a</font>

526
00:21:32,770 --> 00:21:37,929
couple<font color="#E5E5E5"> of examples of LED display boards</font>

527
00:21:35,010 --> 00:21:40,240
now you might be<font color="#E5E5E5"> to see there's actually</font>

528
00:21:37,929 --> 00:21:42,010
a<font color="#E5E5E5"> crossover</font><font color="#CCCCCC"> between the</font><font color="#E5E5E5"> two there are a</font>

529
00:21:40,240 --> 00:21:44,350
number<font color="#CCCCCC"> of pins required by the LED</font>

530
00:21:42,010 --> 00:21:46,720
displays that<font color="#E5E5E5"> are also in use by the</font><font color="#CCCCCC"> Red</font>

531
00:21:44,350 --> 00:21:47,740
<font color="#CCCCCC">Bear</font><font color="#E5E5E5"> already and we found this all over</font>

532
00:21:46,720 --> 00:21:49,990
<font color="#E5E5E5">the shop when we were</font><font color="#CCCCCC"> looking for</font>

533
00:21:47,740 --> 00:21:52,090
suitable<font color="#CCCCCC"> LEDs and stuff that was easy</font>

534
00:21:49,990 --> 00:21:52,450
just<font color="#E5E5E5"> plug and play</font><font color="#CCCCCC"> just didn't want</font><font color="#E5E5E5"> to</font>

535
00:21:52,090 --> 00:21:55,059
work

536
00:21:52,450 --> 00:21:57,130
they weren't compatible so with a bit<font color="#E5E5E5"> of</font>

537
00:21:55,059 --> 00:22:00,280
<font color="#E5E5E5">research we found two devices that would</font>

538
00:21:57,130 --> 00:22:02,880
kind of<font color="#E5E5E5"> fit the bill</font><font color="#CCCCCC"> the first one is</font>

539
00:22:00,280 --> 00:22:04,629
called the blinked it comes with eight

540
00:22:02,880 --> 00:22:06,490
<font color="#CCCCCC">RGB LEDs</font>

541
00:22:04,630 --> 00:22:07,660
it cost<font color="#E5E5E5"> about five</font><font color="#CCCCCC"> pounds by so it's</font>

542
00:22:06,490 --> 00:22:09,310
nice<font color="#CCCCCC"> and cheap</font>

543
00:22:07,660 --> 00:22:11,710
<font color="#E5E5E5">comes</font><font color="#CCCCCC"> with a Python library so it is</font>

544
00:22:09,310 --> 00:22:13,389
easy programming<font color="#E5E5E5"> for us</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> comes on a</font>

545
00:22:11,710 --> 00:22:19,000
header that<font color="#E5E5E5"> just essentially just sits</font>

546
00:22:13,390 --> 00:22:22,270
<font color="#CCCCCC">straight on top</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> the pipe okay so</font>

547
00:22:19,000 --> 00:22:24,070
here<font color="#CCCCCC"> is an action your</font><font color="#E5E5E5"> suit amongst you</font>

548
00:22:22,270 --> 00:22:26,440
<font color="#CCCCCC">will notice that</font><font color="#E5E5E5"> it's not sat on top of</font>

549
00:22:24,070 --> 00:22:28,450
the pie and<font color="#CCCCCC"> that's because when we got</font>

550
00:22:26,440 --> 00:22:30,010
<font color="#E5E5E5">it we realized</font><font color="#CCCCCC"> that a couple of pins</font>

551
00:22:28,450 --> 00:22:31,800
required<font color="#CCCCCC"> for</font><font color="#E5E5E5"> the blink to actually in</font>

552
00:22:30,010 --> 00:22:36,070
use by the road by<font color="#CCCCCC"> the red bar already</font>

553
00:22:31,800 --> 00:22:38,379
<font color="#E5E5E5">so quick solution was</font><font color="#CCCCCC"> to solder a couple</font>

554
00:22:36,070 --> 00:22:41,740
of wires<font color="#E5E5E5"> on the back of the the</font><font color="#CCCCCC"> blinked</font>

555
00:22:38,380 --> 00:22:43,180
<font color="#E5E5E5">map those that unused pins on the</font><font color="#CCCCCC"> PI and</font>

556
00:22:41,740 --> 00:22:48,550
<font color="#CCCCCC">then just remap the</font><font color="#E5E5E5"> whole lot on</font>

557
00:22:43,180 --> 00:22:50,170
<font color="#E5E5E5">software so the pros of</font><font color="#CCCCCC"> using the blinks</font>

558
00:22:48,550 --> 00:22:52,330
will say it was cheap<font color="#CCCCCC"> centi</font><font color="#E5E5E5"> five pounds</font>

559
00:22:50,170 --> 00:22:53,590
<font color="#CCCCCC">and those eight LEDs get really good</font>

560
00:22:52,330 --> 00:22:56,199
user feedback as to<font color="#E5E5E5"> what was going</font><font color="#CCCCCC"> on</font>

561
00:22:53,590 --> 00:22:58,179
<font color="#E5E5E5">the downsize</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> those four pins</font>

562
00:22:56,200 --> 00:22:59,610
<font color="#E5E5E5">soldering on made it wasn't</font><font color="#CCCCCC"> it wasn't</font>

563
00:22:58,180 --> 00:23:02,050
<font color="#E5E5E5">quite plug-and-play as we want it to be</font>

564
00:22:59,610 --> 00:23:03,729
and<font color="#E5E5E5"> you had to wedge the blinked in</font>

565
00:23:02,050 --> 00:23:08,169
between the PI<font color="#CCCCCC"> zero and the red bed keep</font>

566
00:23:03,730 --> 00:23:11,680
in place<font color="#CCCCCC"> it wasn't</font><font color="#E5E5E5"> the best</font><font color="#CCCCCC"> lesion so</font>

567
00:23:08,170 --> 00:23:14,770
the option<font color="#CCCCCC"> two was a scroll fat and this</font>

568
00:23:11,680 --> 00:23:17,050
comes with<font color="#CCCCCC"> 55</font><font color="#E5E5E5"> LEDs the</font><font color="#CCCCCC"> raw white they're</font>

569
00:23:14,770 --> 00:23:18,879
not<font color="#CCCCCC"> coloured unfortunately</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> cost twice</font>

570
00:23:17,050 --> 00:23:20,770
as much as<font color="#CCCCCC"> the blinked ten</font><font color="#E5E5E5"> pounds again</font>

571
00:23:18,880 --> 00:23:22,660
comes with a header you<font color="#CCCCCC"> can just plunk</font>

572
00:23:20,770 --> 00:23:24,150
<font color="#E5E5E5">it up the</font><font color="#CCCCCC"> PI and gain comes with the</font>

573
00:23:22,660 --> 00:23:26,560
Python<font color="#CCCCCC"> library for easy programming</font>

574
00:23:24,150 --> 00:23:28,060
<font color="#E5E5E5">because it's got so many</font><font color="#CCCCCC"> LEDs also</font><font color="#E5E5E5"> means</font>

575
00:23:26,560 --> 00:23:30,850
you can give text messages either<font color="#E5E5E5"> so we</font>

576
00:23:28,060 --> 00:23:36,580
can say<font color="#E5E5E5"> we're at stage</font><font color="#CCCCCC"> one or responders</font>

577
00:23:30,850 --> 00:23:37,899
running or we've<font color="#CCCCCC"> got creds go so</font><font color="#E5E5E5"> here is</font>

578
00:23:36,580 --> 00:23:40,290
an action so the top left<font color="#E5E5E5"> on image</font>

579
00:23:37,900 --> 00:23:43,330
you're<font color="#CCCCCC"> looking at is</font><font color="#E5E5E5"> the PI</font><font color="#CCCCCC"> 0 on its own</font>

580
00:23:40,290 --> 00:23:44,800
<font color="#CCCCCC">the top right-hand</font><font color="#E5E5E5"> one is the red bear</font>

581
00:23:43,330 --> 00:23:47,320
with a couple<font color="#E5E5E5"> of extra long headers</font>

582
00:23:44,800 --> 00:23:50,139
called stacking headers<font color="#CCCCCC"> sobs</font><font color="#E5E5E5"> on the</font>

583
00:23:47,320 --> 00:23:52,570
bottom left on image is a scroll fat and

584
00:23:50,140 --> 00:23:55,330
then the bottom right is<font color="#E5E5E5"> everything</font>

585
00:23:52,570 --> 00:24:00,220
connected up together<font color="#CCCCCC"> which really</font>

586
00:23:55,330 --> 00:24:02,620
poorly shoddy wiring so the pros of

587
00:24:00,220 --> 00:24:04,300
<font color="#E5E5E5">using the scroll that</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> it literally</font>

588
00:24:02,620 --> 00:24:06,969
<font color="#CCCCCC">just</font><font color="#E5E5E5"> sits first it's straight on top of</font>

589
00:24:04,300 --> 00:24:09,010
the pie<font color="#E5E5E5"> the GPIO pins required were</font>

590
00:24:06,970 --> 00:24:11,500
exact match so it goes<font color="#CCCCCC"> straight on like</font>

591
00:24:09,010 --> 00:24:13,360
Lego<font color="#E5E5E5"> because we have those LEDs like I</font>

592
00:24:11,500 --> 00:24:16,900
mentioned<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can get protect feedback</font>

593
00:24:13,360 --> 00:24:17,979
<font color="#CCCCCC">visa the downside was between</font><font color="#E5E5E5"> all the</font>

594
00:24:16,900 --> 00:24:20,260
soldering point for<font color="#E5E5E5"> everything that's</font>

595
00:24:17,980 --> 00:24:21,040
120 pins I had a solder and those

596
00:24:20,260 --> 00:24:23,800
stacking headers

597
00:24:21,040 --> 00:24:24,940
<font color="#E5E5E5">or real pain in the backside and because</font>

598
00:24:23,800 --> 00:24:27,450
it's<font color="#CCCCCC"> ten pound</font><font color="#E5E5E5"> it's twice</font><font color="#CCCCCC"> as expensive</font>

599
00:24:24,940 --> 00:24:30,430
as the<font color="#CCCCCC"> blinked</font>

600
00:24:27,450 --> 00:24:31,660
so quick<font color="#CCCCCC"> recap where we</font><font color="#E5E5E5"> are so far we've</font>

601
00:24:30,430 --> 00:24:33,130
now got a cheap<font color="#CCCCCC"> device to run the attack</font>

602
00:24:31,660 --> 00:24:35,350
on we've given<font color="#E5E5E5"> it networking</font>

603
00:24:33,130 --> 00:24:37,360
capabilities<font color="#CCCCCC"> we've got password cracking</font>

604
00:24:35,350 --> 00:24:39,790
up in the cloud we've now it user

605
00:24:37,360 --> 00:24:41,649
feedback<font color="#E5E5E5"> to LEDs</font><font color="#CCCCCC"> what we still</font><font color="#E5E5E5"> will the</font>

606
00:24:39,790 --> 00:24:43,930
issue<font color="#E5E5E5"> that Trevor mentioned earlier with</font>

607
00:24:41,650 --> 00:24:45,070
the<font color="#CCCCCC"> drivers</font><font color="#E5E5E5"> still being required which</font>

608
00:24:43,930 --> 00:24:49,930
really<font color="#CCCCCC"> cause problems in a</font><font color="#E5E5E5"> corporate</font>

609
00:24:45,070 --> 00:24:52,060
<font color="#E5E5E5">environment so we</font><font color="#CCCCCC"> fixed it so</font><font color="#E5E5E5"> straight</font>

610
00:24:49,930 --> 00:24:55,540
off the bat<font color="#E5E5E5"> the PI will present itself</font>

611
00:24:52,060 --> 00:24:57,010
as a generic<font color="#CCCCCC"> Ethernet gadget</font><font color="#E5E5E5"> and Windows</font>

612
00:24:55,540 --> 00:24:59,080
<font color="#E5E5E5">doesn't have drivers for</font><font color="#CCCCCC"> that built in</font>

613
00:24:57,010 --> 00:25:00,640
but<font color="#E5E5E5"> bit googling and a bit of messing</font>

614
00:24:59,080 --> 00:25:02,290
<font color="#E5E5E5">around</font><font color="#CCCCCC"> and we</font><font color="#E5E5E5"> found that in</font><font color="#CCCCCC"> fact we just</font>

615
00:25:00,640 --> 00:25:05,350
<font color="#CCCCCC">tweaked the vendor code and the Product</font>

616
00:25:02,290 --> 00:25:08,080
ID<font color="#CCCCCC"> windows does have driver sir an IBM</font>

617
00:25:05,350 --> 00:25:09,730
device<font color="#E5E5E5"> built into</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so if you</font><font color="#CCCCCC"> presented</font>

618
00:25:08,080 --> 00:25:12,189
<font color="#E5E5E5">that IBM devices that is a generic</font>

619
00:25:09,730 --> 00:25:20,290
<font color="#CCCCCC">gadget</font><font color="#E5E5E5"> Windows has the drivers and</font><font color="#CCCCCC"> would</font>

620
00:25:12,190 --> 00:25:21,850
just pick up a run with it<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the last</font>

621
00:25:20,290 --> 00:25:24,040
piece of the puzzle should<font color="#CCCCCC"> have</font><font color="#E5E5E5"> been the</font>

622
00:25:21,850 --> 00:25:25,360
<font color="#CCCCCC">easiest one actually so to type in the</font>

623
00:25:24,040 --> 00:25:26,500
creds back into Windows we need to

624
00:25:25,360 --> 00:25:29,260
<font color="#CCCCCC">emulate a keyboard</font>

625
00:25:26,500 --> 00:25:31,060
and weirdly<font color="#E5E5E5"> the module required to</font>

626
00:25:29,260 --> 00:25:33,940
emulate keyboard and not in the kernel

627
00:25:31,060 --> 00:25:35,500
<font color="#E5E5E5">that was used by the PI by default so we</font>

628
00:25:33,940 --> 00:25:38,080
had to roll<font color="#E5E5E5"> our</font><font color="#CCCCCC"> own kernel and we are</font>

629
00:25:35,500 --> 00:25:40,810
<font color="#CCCCCC">not</font><font color="#E5E5E5"> linux guys so that was interesting</font>

630
00:25:38,080 --> 00:25:42,340
<font color="#CCCCCC">but after</font><font color="#E5E5E5"> that was fixed</font><font color="#CCCCCC"> the PI just</font>

631
00:25:40,810 --> 00:25:47,020
<font color="#E5E5E5">plugs in plays and</font><font color="#CCCCCC"> windows picks it up</font>

632
00:25:42,340 --> 00:25:49,060
as a<font color="#CCCCCC"> keyboard so we were done we had two</font>

633
00:25:47,020 --> 00:25:50,050
devices<font color="#E5E5E5"> they work perfectly the password</font>

634
00:25:49,060 --> 00:25:51,940
cracking worked perfectly

635
00:25:50,050 --> 00:25:53,590
we had a small<font color="#CCCCCC"> amount of code polishing</font>

636
00:25:51,940 --> 00:25:56,140
to do we were ready to release to the

637
00:25:53,590 --> 00:26:02,020
<font color="#E5E5E5">world and this was to start of this year</font>

638
00:25:56,140 --> 00:26:06,820
start 2017<font color="#E5E5E5"> there was</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> one thing the</font>

639
00:26:02,020 --> 00:26:08,260
<font color="#E5E5E5">PI 0w came out so Feb 27 we were just</font>

640
00:26:06,820 --> 00:26:10,600
polishing everything<font color="#CCCCCC"> elf and this got</font>

641
00:26:08,260 --> 00:26:12,610
released<font color="#E5E5E5"> and for those that don't know</font>

642
00:26:10,600 --> 00:26:15,070
<font color="#E5E5E5">it basically takes the PI</font><font color="#CCCCCC"> zero and gives</font>

643
00:26:12,610 --> 00:26:16,959
it wireless capabilities<font color="#E5E5E5"> because we now</font>

644
00:26:15,070 --> 00:26:18,820
have<font color="#E5E5E5"> wireless capabilities we don't need</font>

645
00:26:16,960 --> 00:26:21,550
to use specific<font color="#CCCCCC"> LED devices to give</font>

646
00:26:18,820 --> 00:26:23,080
feedback<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> use whatever</font><font color="#E5E5E5"> we want and</font>

647
00:26:21,550 --> 00:26:24,399
because<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> got Wireless it takes the</font>

648
00:26:23,080 --> 00:26:27,820
kernel<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that kernel broke our</font>

649
00:26:24,400 --> 00:26:29,620
keyboard module<font color="#CCCCCC"> again have you ever</font>

650
00:26:27,820 --> 00:26:32,050
worked on<font color="#E5E5E5"> a project</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> three months</font>

651
00:26:29,620 --> 00:26:33,429
<font color="#E5E5E5">loads of time and</font><font color="#CCCCCC"> effort and research</font>

652
00:26:32,050 --> 00:26:34,418
<font color="#E5E5E5">into it and then someone comes along</font>

653
00:26:33,430 --> 00:26:36,039
<font color="#CCCCCC">just as your</font>

654
00:26:34,419 --> 00:26:40,779
<font color="#CCCCCC">to release and just</font><font color="#E5E5E5"> kind of kibosh</font><font color="#CCCCCC"> is it</font>

655
00:26:36,039 --> 00:26:43,840
all<font color="#E5E5E5"> over yeah yeah we were thrilled</font><font color="#CCCCCC"> new</font>

656
00:26:40,779 --> 00:26:45,999
technology<font color="#E5E5E5"> okay so introducing the new</font>

657
00:26:43,840 --> 00:26:48,189
<font color="#CCCCCC">hiking</font><font color="#E5E5E5"> but he's telling price they're</font>

658
00:26:45,999 --> 00:26:50,499
doubling it and<font color="#E5E5E5"> we published it all</font><font color="#CCCCCC"> off</font>

659
00:26:48,190 --> 00:26:52,809
<font color="#E5E5E5">of</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> so it's now got installers for the</font>

660
00:26:50,499 --> 00:26:55,869
<font color="#E5E5E5">pikey itself and for the server side for</font>

661
00:26:52,809 --> 00:26:57,129
the password<font color="#E5E5E5"> cracking we standardized on</font>

662
00:26:55,869 --> 00:26:59,439
the blinked<font color="#E5E5E5"> because it does give really</font>

663
00:26:57,129 --> 00:27:00,850
<font color="#E5E5E5">good user feedback</font><font color="#CCCCCC"> we don't</font><font color="#E5E5E5"> need to do</font>

664
00:26:59,440 --> 00:27:02,499
any solving<font color="#CCCCCC"> and fiddly wires anymore</font>

665
00:27:00,850 --> 00:27:04,299
<font color="#E5E5E5">because all the pins are freed up we can</font>

666
00:27:02,499 --> 00:27:05,559
just<font color="#CCCCCC"> take</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> straight on top</font><font color="#E5E5E5"> we have</font>

667
00:27:04,299 --> 00:27:07,480
left the code in for the score<font color="#E5E5E5"> fat if</font>

668
00:27:05,559 --> 00:27:11,769
you<font color="#E5E5E5"> want to use that which is the one I</font>

669
00:27:07,480 --> 00:27:14,859
chose right<font color="#CCCCCC"> okay so a quick recap how</font>

670
00:27:11,769 --> 00:27:18,399
everything works firstly<font color="#E5E5E5"> you plug in the</font>

671
00:27:14,859 --> 00:27:19,928
PI key which powers itself up the play

672
00:27:18,399 --> 00:27:21,549
key won't<font color="#E5E5E5"> connect to your</font><font color="#CCCCCC"> phone or Weber</font>

673
00:27:19,929 --> 00:27:25,690
wireless network you've got to make<font color="#E5E5E5"> sure</font>

674
00:27:21,549 --> 00:27:26,499
it's got a cloud connection it ends it

675
00:27:25,690 --> 00:27:28,929
stores<font color="#CCCCCC"> it softer</font><font color="#E5E5E5"> than that work</font>

676
00:27:26,499 --> 00:27:31,840
interface and waits for Windows to give

677
00:27:28,929 --> 00:27:33,039
it some creds assuming you<font color="#E5E5E5"> get some</font>

678
00:27:31,840 --> 00:27:36,158
credentials<font color="#CCCCCC"> come out Windows for some</font>

679
00:27:33,039 --> 00:27:38,889
<font color="#E5E5E5">wait the PI key chucked it up to our</font>

680
00:27:36,159 --> 00:27:40,929
password crack up in the cloud<font color="#E5E5E5"> that</font>

681
00:27:38,889 --> 00:27:43,059
turns away<font color="#E5E5E5"> and assuming of course you</font>

682
00:27:40,929 --> 00:27:46,269
<font color="#E5E5E5">can crack the password like</font><font color="#CCCCCC"> it's sent</font>

683
00:27:43,059 --> 00:27:48,119
<font color="#E5E5E5">back to the PI key the piking then</font>

684
00:27:46,269 --> 00:27:50,049
removes<font color="#E5E5E5"> itself as an ethernet device</font>

685
00:27:48,119 --> 00:27:53,129
reinstalls itself as a hid device<font color="#E5E5E5"> to</font>

686
00:27:50,049 --> 00:27:55,210
<font color="#CCCCCC">Windows</font><font color="#E5E5E5"> presses control lock deletes and</font>

687
00:27:53,129 --> 00:27:58,389
types the password back<font color="#E5E5E5"> into the user</font>

688
00:27:55,210 --> 00:28:02,980
<font color="#CCCCCC">and</font><font color="#E5E5E5"> the lock screen hopefully unlocking</font>

689
00:27:58,389 --> 00:28:06,639
it now<font color="#CCCCCC"> I</font><font color="#E5E5E5"> wasn't brave enough to give a</font>

690
00:28:02,980 --> 00:28:08,200
live demo today<font color="#E5E5E5"> what we got yeah yes</font>

691
00:28:06,639 --> 00:28:09,639
we've got<font color="#E5E5E5"> a we've got a we've</font><font color="#CCCCCC"> got the</font>

692
00:28:08,200 --> 00:28:15,700
devices<font color="#CCCCCC"> with us so we can show you</font><font color="#E5E5E5"> later</font>

693
00:28:09,639 --> 00:28:17,949
<font color="#E5E5E5">but you've got a</font><font color="#CCCCCC"> video in action</font><font color="#E5E5E5"> okay so</font>

694
00:28:15,700 --> 00:28:21,070
normally<font color="#E5E5E5"> takes about 20 odd seconds for</font>

695
00:28:17,950 --> 00:28:23,999
the PI key debates<font color="#CCCCCC"> when it does a couple</font>

696
00:28:21,070 --> 00:28:23,999
<font color="#CCCCCC">of LEDs</font><font color="#E5E5E5"> will come on</font>

697
00:28:26,640 --> 00:28:34,870
so it's booting connecting to<font color="#E5E5E5"> you Wi-Fi</font>

698
00:28:29,230 --> 00:28:36,130
to test connectivity so<font color="#E5E5E5"> responders sat</font>

699
00:28:34,870 --> 00:28:39,159
in the background just waiting for

700
00:28:36,130 --> 00:28:41,320
<font color="#CCCCCC">Windows to give it some creds</font><font color="#E5E5E5"> the fourth</font>

701
00:28:39,160 --> 00:28:46,300
LED lights<font color="#E5E5E5"> up win when respond to get</font>

702
00:28:41,320 --> 00:28:48,460
some creds<font color="#CCCCCC"> okay so we've got some creds</font>

703
00:28:46,300 --> 00:28:52,600
<font color="#E5E5E5">it's now going to send it off</font><font color="#CCCCCC"> to our our</font>

704
00:28:48,460 --> 00:28:54,520
cracker up in the cloud and once<font color="#E5E5E5"> those</font>

705
00:28:52,600 --> 00:28:56,919
have<font color="#CCCCCC"> been correct</font><font color="#E5E5E5"> it will be sent back</font>

706
00:28:54,520 --> 00:29:02,500
<font color="#CCCCCC">to the pikey</font><font color="#E5E5E5"> pikeys now installing</font>

707
00:28:56,920 --> 00:29:04,270
yourself in hid mode and<font color="#CCCCCC"> you'll</font><font color="#E5E5E5"> get a</font>

708
00:29:02,500 --> 00:29:07,020
few<font color="#E5E5E5"> more LEDs and the</font><font color="#CCCCCC"> Machine should</font>

709
00:29:04,270 --> 00:29:07,020
unlock itself

710
00:29:09,230 --> 00:29:18,960
[Applause]

711
00:29:17,000 --> 00:29:20,910
okay so that was<font color="#CCCCCC"> a demo how does it</font>

712
00:29:18,960 --> 00:29:22,410
usually take us so we<font color="#CCCCCC"> find</font><font color="#E5E5E5"> it normally</font>

713
00:29:20,910 --> 00:29:25,140
takes<font color="#E5E5E5"> about 60 to 90 seconds for the</font>

714
00:29:22,410 --> 00:29:27,240
whole attack to work<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> chunking</font>

715
00:29:25,140 --> 00:29:28,590
<font color="#E5E5E5">out is the PI booting and obsolete large</font>

716
00:29:27,240 --> 00:29:29,820
chunk<font color="#E5E5E5"> of that is the password cracking</font>

717
00:29:28,590 --> 00:29:33,090
up in<font color="#E5E5E5"> the cloud so</font><font color="#CCCCCC"> we can probably</font>

718
00:29:29,820 --> 00:29:34,200
optimize that slightly and we did ask<font color="#CCCCCC"> to</font>

719
00:29:33,090 --> 00:29:36,899
introduce some artificial delays

720
00:29:34,200 --> 00:29:38,310
actually so when when you first install

721
00:29:36,900 --> 00:29:39,990
it<font color="#E5E5E5"> windows is a</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> pick</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> the drivers</font>

722
00:29:38,310 --> 00:29:41,879
and it's going<font color="#E5E5E5"> to install them on really</font>

723
00:29:39,990 --> 00:29:43,140
slow machines that can cause<font color="#E5E5E5"> problems so</font>

724
00:29:41,880 --> 00:29:45,960
<font color="#E5E5E5">we're to put it up kind of</font><font color="#CCCCCC"> ten-second</font>

725
00:29:43,140 --> 00:29:49,020
delay for that and again<font color="#CCCCCC"> we found some</font>

726
00:29:45,960 --> 00:29:50,610
machines when you were<font color="#E5E5E5"> when you try to</font>

727
00:29:49,020 --> 00:29:52,650
type in their control<font color="#E5E5E5"> what delete takes</font>

728
00:29:50,610 --> 00:29:54,209
half a second or<font color="#CCCCCC"> so for the machine</font><font color="#E5E5E5"> to</font>

729
00:29:52,650 --> 00:29:58,020
pick it up<font color="#CCCCCC"> so we're</font><font color="#E5E5E5"> to put some</font><font color="#CCCCCC"> delays</font>

730
00:29:54,210 --> 00:30:00,600
<font color="#CCCCCC">in for that alright</font><font color="#E5E5E5"> so one</font><font color="#CCCCCC"> of the things</font>

731
00:29:58,020 --> 00:30:03,300
<font color="#E5E5E5">I said earlier</font><font color="#CCCCCC"> was touched on actually</font>

732
00:30:00,600 --> 00:30:04,620
is that to speed the attack up<font color="#CCCCCC"> we're at</font>

733
00:30:03,300 --> 00:30:06,960
the<font color="#CCCCCC"> moment using</font><font color="#E5E5E5"> John the Ripper</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> the</font>

734
00:30:04,620 --> 00:30:11,489
<font color="#E5E5E5">password cracking you can swap it</font><font color="#CCCCCC"> out</font>

735
00:30:06,960 --> 00:30:13,650
nice hash<font color="#CCCCCC"> caps Amazon</font><font color="#E5E5E5"> now support GPU</font>

736
00:30:11,490 --> 00:30:14,940
instances and Kali comes with it<font color="#E5E5E5"> at the</font>

737
00:30:13,650 --> 00:30:16,860
box which<font color="#CCCCCC"> is what the servers based</font><font color="#E5E5E5"> on</font>

738
00:30:14,940 --> 00:30:19,320
so if you want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do a bit</font><font color="#CCCCCC"> more a bit</font>

739
00:30:16,860 --> 00:30:22,290
more cracking<font color="#CCCCCC"> spin</font><font color="#E5E5E5"> up an easy to</font><font color="#CCCCCC"> p2</font>

740
00:30:19,320 --> 00:30:27,480
instance<font color="#E5E5E5"> and all that'll</font><font color="#CCCCCC"> make</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> pass for</font>

741
00:30:22,290 --> 00:30:29,250
cracking<font color="#E5E5E5"> a lot quicker</font><font color="#CCCCCC"> and fundamentally</font>

742
00:30:27,480 --> 00:30:31,050
<font color="#E5E5E5">the pikey is just based on password</font>

743
00:30:29,250 --> 00:30:32,220
<font color="#E5E5E5">cracking</font><font color="#CCCCCC"> it just takes a password cracks</font>

744
00:30:31,050 --> 00:30:35,280
it and returns a results

745
00:30:32,220 --> 00:30:37,260
so like any engagement if you want<font color="#CCCCCC"> to</font>

746
00:30:35,280 --> 00:30:39,090
<font color="#E5E5E5">much a word list beforehand</font><font color="#CCCCCC"> if you're</font>

747
00:30:37,260 --> 00:30:40,020
going into<font color="#CCCCCC"> enterprise there</font><font color="#E5E5E5"> chances are</font>

748
00:30:39,090 --> 00:30:41,760
<font color="#CCCCCC">you've got eight characters are</font><font color="#E5E5E5"> more</font>

749
00:30:40,020 --> 00:30:43,020
complexity turned on<font color="#CCCCCC"> if you optimize</font>

750
00:30:41,760 --> 00:30:48,900
<font color="#CCCCCC">your word list you'll</font><font color="#E5E5E5"> get much better</font>

751
00:30:43,020 --> 00:30:50,790
<font color="#CCCCCC">results</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we have very specific use</font>

752
00:30:48,900 --> 00:30:52,140
cases when we<font color="#CCCCCC"> actually build this and we</font>

753
00:30:50,790 --> 00:30:53,700
figured people<font color="#CCCCCC"> to be</font><font color="#E5E5E5"> using it for social</font>

754
00:30:52,140 --> 00:30:56,040
<font color="#CCCCCC">engineering engagements</font><font color="#E5E5E5"> maybe for</font>

755
00:30:53,700 --> 00:30:58,710
internal testing you might take it

756
00:30:56,040 --> 00:31:00,210
between different clients<font color="#CCCCCC"> there's a high</font>

757
00:30:58,710 --> 00:31:02,490
probability that you can either lose the

758
00:31:00,210 --> 00:31:03,870
device or the<font color="#CCCCCC"> internal</font><font color="#E5E5E5"> team is going to</font>

759
00:31:02,490 --> 00:31:06,450
<font color="#E5E5E5">catch you and they're going to snag it</font>

760
00:31:03,870 --> 00:31:08,070
and we really didn't<font color="#CCCCCC"> want corporate</font>

761
00:31:06,450 --> 00:31:11,400
creds just kind of floating around<font color="#E5E5E5"> the</font>

762
00:31:08,070 --> 00:31:13,020
device for<font color="#E5E5E5"> someone to grab so when the</font>

763
00:31:11,400 --> 00:31:14,880
pikey first boots<font color="#E5E5E5"> and when it shuts</font><font color="#CCCCCC"> down</font>

764
00:31:13,020 --> 00:31:18,330
it clears all<font color="#CCCCCC"> of its logs so nothing</font>

765
00:31:14,880 --> 00:31:20,280
<font color="#E5E5E5">stored on</font><font color="#CCCCCC"> that on the device</font><font color="#E5E5E5"> itself</font><font color="#CCCCCC"> for</font>

766
00:31:18,330 --> 00:31:23,310
passing periods<font color="#E5E5E5"> between the PI key in</font>

767
00:31:20,280 --> 00:31:25,710
the cloud and back<font color="#CCCCCC"> again we use SSH</font><font color="#E5E5E5"> and</font>

768
00:31:23,310 --> 00:31:27,090
the keys for that are generated when you

769
00:31:25,710 --> 00:31:29,360
first install it to<font color="#CCCCCC"> the unique keys</font>

770
00:31:27,090 --> 00:31:29,360
yourself

771
00:31:29,650 --> 00:31:33,010
the server side though the<font color="#E5E5E5"> password</font>

772
00:31:31,300 --> 00:31:36,610
<font color="#E5E5E5">cracker does store everything</font><font color="#CCCCCC"> pass</font><font color="#E5E5E5"> to it</font>

773
00:31:33,010 --> 00:31:37,720
and the rationale behind this is the

774
00:31:36,610 --> 00:31:39,280
<font color="#E5E5E5">pike</font><font color="#CCCCCC"> is really meant to</font><font color="#E5E5E5"> be used on a</font>

775
00:31:37,720 --> 00:31:40,990
kind<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> couple of engagement you find</font>

776
00:31:39,280 --> 00:31:42,340
a<font color="#CCCCCC"> lock machine</font><font color="#E5E5E5"> you stick it in you crack</font>

777
00:31:40,990 --> 00:31:44,560
it<font color="#E5E5E5"> or you don't and you kind of walk</font>

778
00:31:42,340 --> 00:31:45,970
away<font color="#E5E5E5"> but it could well</font><font color="#CCCCCC"> be that</font><font color="#E5E5E5"> you're on</font>

779
00:31:44,560 --> 00:31:47,679
a<font color="#E5E5E5"> two or three</font><font color="#CCCCCC"> day engagement and those</font>

780
00:31:45,970 --> 00:31:50,170
<font color="#CCCCCC">passwords can be reused at a later date</font>

781
00:31:47,680 --> 00:31:51,910
so<font color="#CCCCCC"> you'll send</font><font color="#E5E5E5"> everything up to the</font>

782
00:31:50,170 --> 00:31:53,350
cloud cracker if you can't crack<font color="#E5E5E5"> it</font>

783
00:31:51,910 --> 00:31:55,240
<font color="#E5E5E5">there and then doesn't matter move on</font>

784
00:31:53,350 --> 00:31:57,370
but it could well be<font color="#CCCCCC"> that you can spend</font>

785
00:31:55,240 --> 00:31:58,870
a lot<font color="#CCCCCC"> more</font><font color="#E5E5E5"> resources that evening</font><font color="#CCCCCC"> crack</font>

786
00:31:57,370 --> 00:32:01,770
the passwords come back on day two<font color="#CCCCCC"> and</font>

787
00:31:58,870 --> 00:32:01,770
use those<font color="#E5E5E5"> in</font><font color="#CCCCCC"> a different manner</font>

788
00:32:02,280 --> 00:32:09,190
so<font color="#CCCCCC"> okay in the real world realistically</font>

789
00:32:06,520 --> 00:32:10,780
these<font color="#E5E5E5"> only works on win7 the original</font>

790
00:32:09,190 --> 00:32:12,970
attack<font color="#CCCCCC"> by move exploits</font><font color="#E5E5E5"> on Windows 10</font>

791
00:32:10,780 --> 00:32:17,200
<font color="#E5E5E5">but might have patched it and everybody</font>

792
00:32:12,970 --> 00:32:18,460
<font color="#E5E5E5">keeps their environment</font><font color="#CCCCCC"> Patra</font><font color="#E5E5E5"> so Windows</font>

793
00:32:17,200 --> 00:32:21,570
7 but quick show of hands<font color="#E5E5E5"> how many</font>

794
00:32:18,460 --> 00:32:25,450
people<font color="#E5E5E5"> use Windows 7 in their enterprise</font>

795
00:32:21,570 --> 00:32:28,210
<font color="#E5E5E5">yeah</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> few yes so it's going to work</font>

796
00:32:25,450 --> 00:32:30,100
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> everywhere again in the real</font>

797
00:32:28,210 --> 00:32:32,650
world<font color="#CCCCCC"> the machine has to</font><font color="#E5E5E5"> be fairly</font>

798
00:32:30,100 --> 00:32:34,449
chassis<font color="#E5E5E5"> if you take a newly booted</font>

799
00:32:32,650 --> 00:32:36,340
machine and lock it<font color="#CCCCCC"> it'll take a long</font>

800
00:32:34,450 --> 00:32:37,780
time to<font color="#E5E5E5"> get any credit</font><font color="#CCCCCC"> out of it if</font>

801
00:32:36,340 --> 00:32:39,340
you've got<font color="#CCCCCC"> a standard machine</font><font color="#E5E5E5"> without</font>

802
00:32:37,780 --> 00:32:42,129
running<font color="#E5E5E5"> a lot of</font><font color="#CCCCCC"> background services</font>

803
00:32:39,340 --> 00:32:43,810
<font color="#E5E5E5">you'll get a lot quicker responses and</font>

804
00:32:42,130 --> 00:32:46,240
<font color="#E5E5E5">also</font><font color="#CCCCCC"> you need</font><font color="#E5E5E5"> a Wi-Fi</font><font color="#CCCCCC"> connection to</font><font color="#E5E5E5"> get</font>

805
00:32:43,810 --> 00:32:48,010
out to the up to<font color="#CCCCCC"> the cloud we found all</font>

806
00:32:46,240 --> 00:32:49,660
some<font color="#E5E5E5"> engagements either the clients wait</font>

807
00:32:48,010 --> 00:32:51,700
let<font color="#CCCCCC"> Katie</font><font color="#E5E5E5"> phones in where you just don't</font>

808
00:32:49,660 --> 00:32:56,320
<font color="#E5E5E5">have</font><font color="#CCCCCC"> a 4G signal in which case you go</font>

809
00:32:51,700 --> 00:32:58,180
nowhere so we<font color="#CCCCCC"> tested this we've got</font>

810
00:32:56,320 --> 00:32:59,770
about<font color="#E5E5E5"> 20 percent success rate and if</font>

811
00:32:58,180 --> 00:33:01,240
<font color="#CCCCCC">anyone</font><font color="#E5E5E5"> suddenly real password</font><font color="#CCCCCC"> crack in</font>

812
00:32:59,770 --> 00:33:01,480
an enterprise<font color="#E5E5E5"> that kind</font><font color="#CCCCCC"> of sounds about</font>

813
00:33:01,240 --> 00:33:03,100
right

814
00:33:01,480 --> 00:33:05,440
they've never done<font color="#CCCCCC"> a password audit</font><font color="#E5E5E5"> of</font>

815
00:33:03,100 --> 00:33:07,990
<font color="#E5E5E5">their ad</font><font color="#CCCCCC"> 20%</font><font color="#E5E5E5"> is kind</font><font color="#CCCCCC"> of a normal hit</font>

816
00:33:05,440 --> 00:33:08,980
right um as<font color="#E5E5E5"> I said earlier if you</font>

817
00:33:07,990 --> 00:33:10,480
optimize<font color="#E5E5E5"> a word list</font>

818
00:33:08,980 --> 00:33:13,630
<font color="#E5E5E5">shot a lot more power behind it you get</font>

819
00:33:10,480 --> 00:33:16,450
a much better<font color="#E5E5E5"> success rate</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> we have</font>

820
00:33:13,630 --> 00:33:18,400
found<font color="#E5E5E5"> in</font><font color="#CCCCCC"> some places</font><font color="#E5E5E5"> technologies in</font>

821
00:33:16,450 --> 00:33:20,230
<font color="#E5E5E5">place that accidentally prevent the PI T</font>

822
00:33:18,400 --> 00:33:21,850
from working because<font color="#E5E5E5"> when it's first</font>

823
00:33:20,230 --> 00:33:23,530
inserted it comes up as a new networking

824
00:33:21,850 --> 00:33:25,179
<font color="#E5E5E5">device and we found that some</font>

825
00:33:23,530 --> 00:33:26,590
enterprises have got firewalls

826
00:33:25,180 --> 00:33:28,480
automatically come up<font color="#E5E5E5"> if they don't</font>

827
00:33:26,590 --> 00:33:30,159
<font color="#E5E5E5">recognize</font><font color="#CCCCCC"> the network or VPNs</font><font color="#E5E5E5"> are</font>

828
00:33:28,480 --> 00:33:32,970
automatically try and connect and<font color="#CCCCCC"> that</font>

829
00:33:30,160 --> 00:33:32,970
kills the attack dead

830
00:33:34,140 --> 00:33:42,360
I think so<font color="#E5E5E5"> here this</font><font color="#CCCCCC"> light at the</font><font color="#E5E5E5"> last</font>

831
00:33:38,820 --> 00:33:43,230
minute can regret<font color="#E5E5E5"> no no right so up to</font>

832
00:33:42,360 --> 00:33:45,120
this point we talked<font color="#CCCCCC"> about the red</font>

833
00:33:43,230 --> 00:33:48,780
teaming aspect of it how do you<font color="#E5E5E5"> protect</font>

834
00:33:45,120 --> 00:33:50,850
against<font color="#E5E5E5"> the pikey so one solution is</font>

835
00:33:48,780 --> 00:33:52,379
endpoint protection<font color="#CCCCCC"> software</font><font color="#E5E5E5"> we define</font>

836
00:33:50,850 --> 00:33:53,939
exactly<font color="#E5E5E5"> what you can and can't connect</font>

837
00:33:52,380 --> 00:33:55,770
your enterprise with<font color="#E5E5E5"> USB devices like</font>

838
00:33:53,940 --> 00:33:58,799
<font color="#E5E5E5">only specific keyboards and mouse that</font>

839
00:33:55,770 --> 00:34:00,480
kills us dead<font color="#CCCCCC"> if you</font><font color="#E5E5E5"> haven't got em</font>

840
00:33:58,799 --> 00:34:04,889
point protection<font color="#E5E5E5"> group policy comes</font>

841
00:34:00,480 --> 00:34:07,230
<font color="#CCCCCC">without the box you just</font><font color="#E5E5E5"> configure it if</font>

842
00:34:04,890 --> 00:34:08,550
you don't<font color="#CCCCCC"> got that</font><font color="#E5E5E5"> or as well as I get</font>

843
00:34:07,230 --> 00:34:10,469
seems<font color="#E5E5E5"> to be the</font><font color="#CCCCCC"> pikeys just a password</font>

844
00:34:08,550 --> 00:34:12,899
cracker<font color="#CCCCCC"> so strong and</font><font color="#E5E5E5"> repeatable</font>

845
00:34:10,469 --> 00:34:13,918
password<font color="#CCCCCC"> Ford it will make a</font><font color="#E5E5E5"> big</font>

846
00:34:12,899 --> 00:34:15,418
<font color="#CCCCCC">difference</font><font color="#E5E5E5"> NIST have actually just</font>

847
00:34:13,918 --> 00:34:16,199
released a new<font color="#CCCCCC"> standards for password</font>

848
00:34:15,418 --> 00:34:20,118
you<font color="#E5E5E5"> can kind</font><font color="#CCCCCC"> of shove in your</font>

849
00:34:16,199 --> 00:34:22,319
<font color="#CCCCCC">enterprises face if you can't do that</font>

850
00:34:20,119 --> 00:34:23,879
<font color="#CCCCCC">you could force all users to log off</font>

851
00:34:22,320 --> 00:34:26,040
when<font color="#CCCCCC"> a</font><font color="#E5E5E5"> year when they walk away you'll</font>

852
00:34:23,879 --> 00:34:28,379
be<font color="#E5E5E5"> very friendly</font><font color="#CCCCCC"> for that one</font><font color="#E5E5E5"> super glue</font>

853
00:34:26,040 --> 00:34:30,869
or the<font color="#E5E5E5"> USB ports</font><font color="#CCCCCC"> for my favorite give</font>

854
00:34:28,379 --> 00:34:34,560
your<font color="#E5E5E5"> enterprise</font><font color="#CCCCCC"> MacBooks</font><font color="#E5E5E5"> with the stupid</font>

855
00:34:30,869 --> 00:34:36,000
USB<font color="#CCCCCC"> C connectors and focus it don't know</font>

856
00:34:34,560 --> 00:34:40,980
that<font color="#CCCCCC"> they're an adapter when they come</font>

857
00:34:36,000 --> 00:34:42,179
on side<font color="#CCCCCC"> ok so last slide and if you want</font>

858
00:34:40,980 --> 00:34:42,750
to<font color="#E5E5E5"> crack this yourself everything's up</font>

859
00:34:42,179 --> 00:34:45,270
on github

860
00:34:42,750 --> 00:34:47,280
we've got<font color="#E5E5E5"> easygeeze installers literally</font>

861
00:34:45,270 --> 00:34:48,960
it's<font color="#CCCCCC"> just kind of run the command at the</font>

862
00:34:47,280 --> 00:34:50,040
bottom I think<font color="#CCCCCC"> for the</font><font color="#E5E5E5"> clients similar</font>

863
00:34:48,960 --> 00:34:52,260
one<font color="#CCCCCC"> for the server it will</font><font color="#E5E5E5"> take care of</font>

864
00:34:50,040 --> 00:34:53,850
<font color="#E5E5E5">all</font><font color="#CCCCCC"> the setup for you all the</font>

865
00:34:52,260 --> 00:34:55,290
<font color="#E5E5E5">instructions and all</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> all the bits</font>

866
00:34:53,850 --> 00:34:57,750
<font color="#CCCCCC">and pieces are up on github</font>

867
00:34:55,290 --> 00:34:59,369
don't forget<font color="#E5E5E5"> your need a PI</font><font color="#CCCCCC"> 0w and</font>

868
00:34:57,750 --> 00:35:04,520
ideally need some LEDs as well to<font color="#E5E5E5"> get it</font>

869
00:34:59,369 --> 00:35:04,520
running<font color="#E5E5E5"> but some good luck</font>

870
00:35:05,220 --> 00:35:14,899
[Applause]

