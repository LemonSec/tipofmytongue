1
00:00:00,319 --> 00:00:07,099
<font color="#CCCCCC">hi guys my</font><font color="#E5E5E5"> name's Alex</font><font color="#CCCCCC"> I'm a senior to</font>

2
00:00:04,710 --> 00:00:09,570
<font color="#CCCCCC">enter with the</font><font color="#E5E5E5"> team account accept and</font>

3
00:00:07,099 --> 00:00:11,849
in today's<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> I really want to</font><font color="#E5E5E5"> kind of</font>

4
00:00:09,570 --> 00:00:15,240
share my experiences<font color="#E5E5E5"> of doing threat</font>

5
00:00:11,849 --> 00:00:17,940
hunting<font color="#E5E5E5"> a scale</font><font color="#CCCCCC"> with multiple clients</font>

6
00:00:15,240 --> 00:00:21,210
thousands<font color="#E5E5E5"> of endpoints and tons of data</font>

7
00:00:17,940 --> 00:00:23,189
ready<font color="#E5E5E5"> and I also wanted</font><font color="#CCCCCC"> to sort of</font><font color="#E5E5E5"> touch</font>

8
00:00:21,210 --> 00:00:25,289
on the differences between threat

9
00:00:23,189 --> 00:00:26,698
hunting and traditional security<font color="#E5E5E5"> how</font>

10
00:00:25,289 --> 00:00:29,880
they differ why they<font color="#CCCCCC"> differ</font>

11
00:00:26,699 --> 00:00:31,170
do they differ at all<font color="#CCCCCC"> I</font><font color="#E5E5E5"> guess I'm also</font>

12
00:00:29,880 --> 00:00:33,239
going to share some tips<font color="#E5E5E5"> for how</font>

13
00:00:31,170 --> 00:00:34,350
<font color="#E5E5E5">attackers can up their game</font><font color="#CCCCCC"> you know</font>

14
00:00:33,239 --> 00:00:36,599
it's<font color="#CCCCCC"> very</font><font color="#E5E5E5"> free rein in the moment</font>

15
00:00:34,350 --> 00:00:37,710
attackers think that<font color="#E5E5E5"> those bollocks but</font>

16
00:00:36,600 --> 00:00:39,239
because a lot of<font color="#E5E5E5"> things</font><font color="#CCCCCC"> they can</font>

17
00:00:37,710 --> 00:00:41,570
actually do up their game as well and

18
00:00:39,239 --> 00:00:43,828
avoid advanced threat detection

19
00:00:41,570 --> 00:00:45,030
<font color="#E5E5E5">hopefully by the end of this talk and</font>

20
00:00:43,829 --> 00:00:46,890
<font color="#CCCCCC">you'll be able</font><font color="#E5E5E5"> to take away</font><font color="#CCCCCC"> all that</font>

21
00:00:45,030 --> 00:00:48,570
<font color="#CCCCCC">I've talked about</font><font color="#E5E5E5"> go back to your own</font>

22
00:00:46,890 --> 00:00:50,370
enterprises<font color="#E5E5E5"> implementing yourselves to</font>

23
00:00:48,570 --> 00:00:55,440
actually<font color="#CCCCCC"> our supercharge your own</font>

24
00:00:50,370 --> 00:00:58,410
<font color="#CCCCCC">Security's</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> quick intro I</font><font color="#E5E5E5"> said my</font>

25
00:00:55,440 --> 00:01:01,079
<font color="#E5E5E5">name</font><font color="#CCCCCC"> is Alex</font><font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> Ben Davis contrary</font>

26
00:00:58,410 --> 00:01:03,000
<font color="#E5E5E5">to the</font><font color="#CCCCCC"> b-sides brochure and</font><font color="#E5E5E5"> obviously</font>

27
00:01:01,079 --> 00:01:05,220
<font color="#CCCCCC">Atlanta with the team at</font><font color="#E5E5E5"> can assess</font><font color="#CCCCCC"> I</font>

28
00:01:03,000 --> 00:01:07,290
spend my days doing<font color="#E5E5E5"> a sort of</font>

29
00:01:05,220 --> 00:01:08,820
<font color="#E5E5E5">investigation actually hands-on getting</font>

30
00:01:07,290 --> 00:01:11,220
into the data and<font color="#E5E5E5"> pulling files</font>

31
00:01:08,820 --> 00:01:15,479
<font color="#E5E5E5">analyzing memory</font><font color="#CCCCCC"> done</font><font color="#E5E5E5"> and liaison with</font>

32
00:01:11,220 --> 00:01:16,679
our<font color="#E5E5E5"> clients to remediate in issues did</font>

33
00:01:15,479 --> 00:01:18,929
the big part<font color="#CCCCCC"> of what I do is attack</font>

34
00:01:16,680 --> 00:01:20,939
research understanding what attackers

35
00:01:18,930 --> 00:01:23,070
are currently<font color="#E5E5E5"> doing here and now in real</font>

36
00:01:20,939 --> 00:01:24,600
environments<font color="#E5E5E5"> and making sure that we can</font>

37
00:01:23,070 --> 00:01:28,380
actually<font color="#E5E5E5"> detect that a concept make sure</font>

38
00:01:24,600 --> 00:01:29,970
that's in our workflow<font color="#CCCCCC"> also got back</font>

39
00:01:28,380 --> 00:01:32,729
<font color="#E5E5E5">under the pen test though she actually</font>

40
00:01:29,970 --> 00:01:35,009
used to<font color="#CCCCCC"> work at MWR as a regular pen</font>

41
00:01:32,729 --> 00:01:35,939
tester before joining<font color="#CCCCCC"> can't</font><font color="#E5E5E5"> accept and</font>

42
00:01:35,009 --> 00:01:38,060
<font color="#E5E5E5">previously that I was doing something</font>

43
00:01:35,939 --> 00:01:41,399
<font color="#CCCCCC">more standard</font><font color="#E5E5E5"> corporate security and</font>

44
00:01:38,060 --> 00:01:42,810
<font color="#E5E5E5">security monitoring folk buying fan</font>

45
00:01:41,400 --> 00:01:45,450
<font color="#CCCCCC">master</font><font color="#E5E5E5"> always encourage people to</font>

46
00:01:42,810 --> 00:01:47,520
participate<font color="#E5E5E5"> and also</font><font color="#CCCCCC"> I want to be</font>

47
00:01:45,450 --> 00:01:50,270
<font color="#CCCCCC">blogger</font><font color="#E5E5E5"> I guess and</font><font color="#CCCCCC"> Twitter fan feel</font>

48
00:01:47,520 --> 00:01:50,270
free<font color="#CCCCCC"> to follow</font>

49
00:01:50,760 --> 00:01:55,060
so my<font color="#E5E5E5"> journey is a threat hunting</font>

50
00:01:52,840 --> 00:01:57,160
actually started about<font color="#E5E5E5"> three years</font><font color="#CCCCCC"> ago I</font>

51
00:01:55,060 --> 00:01:59,170
<font color="#E5E5E5">was working in a fairly sort of typical</font>

52
00:01:57,160 --> 00:02:03,190
security<font color="#E5E5E5"> team</font><font color="#CCCCCC"> we held the usual products</font>

53
00:01:59,170 --> 00:02:05,410
<font color="#E5E5E5">McAfee the endpoint agent hips</font><font color="#CCCCCC"> IPS that</font>

54
00:02:03,190 --> 00:02:06,759
<font color="#E5E5E5">firewalls email analysis all the</font>

55
00:02:05,410 --> 00:02:09,669
standard stuff<font color="#CCCCCC"> that</font><font color="#E5E5E5"> most enterprises</font>

56
00:02:06,760 --> 00:02:14,320
have but<font color="#E5E5E5"> even with all those products I</font>

57
00:02:09,669 --> 00:02:15,820
didn't have access<font color="#E5E5E5"> to</font><font color="#CCCCCC"> raw data and you</font>

58
00:02:14,320 --> 00:02:17,200
<font color="#E5E5E5">know worked in the security team knowing</font>

59
00:02:15,820 --> 00:02:19,090
what attackers were doing they you know

60
00:02:17,200 --> 00:02:21,160
they were<font color="#E5E5E5"> spinning up processes they</font>

61
00:02:19,090 --> 00:02:23,260
were installing persistence on<font color="#E5E5E5"> network</font>

62
00:02:21,160 --> 00:02:25,270
and<font color="#CCCCCC"> I had no way to see any of that with</font>

63
00:02:23,260 --> 00:02:27,370
the<font color="#CCCCCC"> council's I had so I actually</font><font color="#E5E5E5"> ended</font>

64
00:02:25,270 --> 00:02:28,600
<font color="#E5E5E5">up writing</font><font color="#CCCCCC"> write in a blog or run a bit</font>

65
00:02:27,370 --> 00:02:30,610
of PowerShell which I pull my blog<font color="#E5E5E5"> layer</font>

66
00:02:28,600 --> 00:02:31,810
<font color="#E5E5E5">but all this PowerShell did was they</font>

67
00:02:30,610 --> 00:02:33,760
went<font color="#CCCCCC"> out into the estate</font><font color="#E5E5E5"> and it would</font>

68
00:02:31,810 --> 00:02:35,290
just<font color="#CCCCCC"> pull that data</font><font color="#E5E5E5"> and so I actually</font>

69
00:02:33,760 --> 00:02:36,700
ran this across<font color="#E5E5E5"> thousands of endpoints</font>

70
00:02:35,290 --> 00:02:38,590
pull back I was there did<font color="#E5E5E5"> Elise</font>

71
00:02:36,700 --> 00:02:40,329
frequency analysis on it and actually

72
00:02:38,590 --> 00:02:43,530
<font color="#CCCCCC">found some interesting things I kicked</font>

73
00:02:40,330 --> 00:02:46,090
off some investigations because<font color="#E5E5E5"> of it</font>

74
00:02:43,530 --> 00:02:47,380
another<font color="#E5E5E5"> time I just thought hey I'm just</font>

75
00:02:46,090 --> 00:02:49,390
collecting<font color="#E5E5E5"> there I'm doing</font><font color="#CCCCCC"> analysis I'm</font>

76
00:02:47,380 --> 00:02:50,950
finding the bad guys<font color="#E5E5E5"> but</font><font color="#CCCCCC"> I never kind</font><font color="#E5E5E5"> of</font>

77
00:02:49,390 --> 00:02:52,239
realized in<font color="#CCCCCC"> my head that</font><font color="#E5E5E5"> this was</font>

78
00:02:50,950 --> 00:02:53,859
fundamentally a sort of different

79
00:02:52,240 --> 00:02:56,560
<font color="#E5E5E5">approach to security it was being</font>

80
00:02:53,860 --> 00:02:58,270
<font color="#E5E5E5">practiced um I wasn't relying on some</font>

81
00:02:56,560 --> 00:03:00,280
product to give me some alert<font color="#E5E5E5"> to tell me</font>

82
00:02:58,270 --> 00:03:03,250
hey there's a bad guy<font color="#E5E5E5"> over here I was</font>

83
00:03:00,280 --> 00:03:04,420
<font color="#E5E5E5">the one actually doing that and it's</font>

84
00:03:03,250 --> 00:03:06,700
funny you<font color="#CCCCCC"> know fast forward three years</font>

85
00:03:04,420 --> 00:03:08,679
<font color="#E5E5E5">to where we are present babe and</font><font color="#CCCCCC"> I'm</font>

86
00:03:06,700 --> 00:03:10,600
<font color="#E5E5E5">threatened hunting and a whole prior to</font>

87
00:03:08,680 --> 00:03:11,830
approach to raw data and analysis you

88
00:03:10,600 --> 00:03:16,329
know that's really taken off<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's</font>

89
00:03:11,830 --> 00:03:19,300
something I do day to day<font color="#E5E5E5"> so what you</font>

90
00:03:16,330 --> 00:03:21,730
<font color="#E5E5E5">think well squirrel who are a big</font>

91
00:03:19,300 --> 00:03:23,290
Franklin company they<font color="#E5E5E5"> actually have a</font>

92
00:03:21,730 --> 00:03:25,420
quite<font color="#E5E5E5"> a nice</font><font color="#CCCCCC"> definition so it's the</font>

93
00:03:23,290 --> 00:03:26,709
process of proactively an interesting

94
00:03:25,420 --> 00:03:28,600
<font color="#CCCCCC">search and through networks to detect</font>

95
00:03:26,709 --> 00:03:30,760
<font color="#CCCCCC">and most advanced threats</font><font color="#E5E5E5"> the debate</font>

96
00:03:28,600 --> 00:03:32,590
existing security solutions bit<font color="#E5E5E5"> of a</font>

97
00:03:30,760 --> 00:03:34,720
<font color="#CCCCCC">minefield but but the key points</font><font color="#E5E5E5"> really</font>

98
00:03:32,590 --> 00:03:36,310
first of all<font color="#E5E5E5"> proactive and you're not</font>

99
00:03:34,720 --> 00:03:37,930
sitting<font color="#E5E5E5"> back waiting the</font><font color="#CCCCCC"> attackers come</font>

100
00:03:36,310 --> 00:03:39,430
for you you're going<font color="#E5E5E5"> to the attacker</font>

101
00:03:37,930 --> 00:03:43,030
<font color="#CCCCCC">you're assuming</font><font color="#E5E5E5"> that you're already</font>

102
00:03:39,430 --> 00:03:44,739
compromised<font color="#E5E5E5"> and you're going off</font><font color="#CCCCCC"> it's</font>

103
00:03:43,030 --> 00:03:46,690
also very human driven<font color="#E5E5E5"> right you're not</font>

104
00:03:44,739 --> 00:03:48,340
again relying approach it's about that's

105
00:03:46,690 --> 00:03:49,840
<font color="#E5E5E5">Fantas it's the people in your team from</font>

106
00:03:48,340 --> 00:03:51,490
know what attackers doing<font color="#E5E5E5"> are actually</font>

107
00:03:49,840 --> 00:03:53,320
<font color="#E5E5E5">going off for that stuff</font>

108
00:03:51,490 --> 00:03:56,920
did the<font color="#CCCCCC"> coronoid to emphasize here is</font>

109
00:03:53,320 --> 00:03:58,600
the<font color="#CCCCCC"> Francine</font><font color="#E5E5E5"> is focused primarily on</font>

110
00:03:56,920 --> 00:04:00,850
detection<font color="#E5E5E5"> and traditionally was just on</font>

111
00:03:58,600 --> 00:04:03,010
<font color="#CCCCCC">detection but</font><font color="#E5E5E5"> actually</font><font color="#CCCCCC"> that's starting</font>

112
00:04:00,850 --> 00:04:07,480
to expand open to prevention and

113
00:04:03,010 --> 00:04:09,970
response<font color="#CCCCCC"> remediation I</font><font color="#E5E5E5"> read the power of</font>

114
00:04:07,480 --> 00:04:14,019
having all of those components<font color="#E5E5E5"> in one</font>

115
00:04:09,970 --> 00:04:15,760
agent or one team even is efficiency as

116
00:04:14,020 --> 00:04:17,440
a team you can see something<font color="#CCCCCC"> interesting</font>

117
00:04:15,760 --> 00:04:19,839
<font color="#E5E5E5">and actually reach out collect it</font>

118
00:04:17,440 --> 00:04:21,459
analyze<font color="#E5E5E5"> it and then respond to the block</font>

119
00:04:19,839 --> 00:04:24,039
<font color="#E5E5E5">he'll do something about it</font>

120
00:04:21,459 --> 00:04:25,989
I was I<font color="#E5E5E5"> was feel pain for</font><font color="#CCCCCC"> all those</font>

121
00:04:24,040 --> 00:04:27,430
<font color="#E5E5E5">teams are there who don't have access</font><font color="#CCCCCC"> to</font>

122
00:04:25,990 --> 00:04:29,830
and<font color="#CCCCCC"> the points and have to</font><font color="#E5E5E5"> maybe call</font>

123
00:04:27,430 --> 00:04:31,210
another team send a<font color="#E5E5E5"> request through two</font>

124
00:04:29,830 --> 00:04:33,550
weeks later maybe<font color="#E5E5E5"> you get the file</font><font color="#CCCCCC"> back</font>

125
00:04:31,210 --> 00:04:35,950
<font color="#CCCCCC">you know these</font><font color="#E5E5E5"> kind of</font><font color="#CCCCCC"> posters is just</font>

126
00:04:33,550 --> 00:04:37,720
insane<font color="#CCCCCC"> you know that's just not not</font>

127
00:04:35,950 --> 00:04:43,330
adequate<font color="#CCCCCC"> to really keep up</font><font color="#E5E5E5"> with Monday</font>

128
00:04:37,720 --> 00:04:44,860
attackers so to put sort<font color="#E5E5E5"> of</font><font color="#CCCCCC"> threat Anton</font>

129
00:04:43,330 --> 00:04:46,630
in a bit<font color="#E5E5E5"> more context I want</font><font color="#CCCCCC"> to go back</font>

130
00:04:44,860 --> 00:04:49,030
<font color="#E5E5E5">to saw the age-old debate of manual</font>

131
00:04:46,630 --> 00:04:50,409
versus automated and this is quite<font color="#CCCCCC"> or</font>

132
00:04:49,030 --> 00:04:51,489
relevant I guess to to<font color="#E5E5E5"> throw out</font>

133
00:04:50,410 --> 00:04:55,720
something<font color="#E5E5E5"> because there's a manual</font>

134
00:04:51,490 --> 00:04:58,060
aspect to it<font color="#E5E5E5"> so for the pen testers out</font>

135
00:04:55,720 --> 00:04:59,860
there you've probably used vulnerability

136
00:04:58,060 --> 00:05:02,710
scanners before<font color="#E5E5E5"> and they provide awesome</font>

137
00:04:59,860 --> 00:05:05,200
<font color="#E5E5E5">value you can scan appscale get good</font>

138
00:05:02,710 --> 00:05:06,250
quality results very quickly<font color="#CCCCCC"> there's</font>

139
00:05:05,200 --> 00:05:10,900
nothing wrong with<font color="#E5E5E5"> this approach I think</font>

140
00:05:06,250 --> 00:05:12,190
<font color="#CCCCCC">it's a very</font><font color="#E5E5E5"> approach however a lot you</font>

141
00:05:10,900 --> 00:05:14,260
will<font color="#E5E5E5"> probably know that in</font><font color="#CCCCCC"> terms</font><font color="#E5E5E5"> of</font>

142
00:05:12,190 --> 00:05:15,700
quality<font color="#E5E5E5"> the quality would be less with</font>

143
00:05:14,260 --> 00:05:17,380
something like<font color="#CCCCCC"> nasus you're going to</font>

144
00:05:15,700 --> 00:05:19,539
miss things<font color="#E5E5E5"> whereas if you have manual</font>

145
00:05:17,380 --> 00:05:22,270
pen testers it will<font color="#CCCCCC"> often be a deeper</font>

146
00:05:19,540 --> 00:05:23,920
<font color="#E5E5E5">dive into the estate</font><font color="#CCCCCC"> and you'll find a</font>

147
00:05:22,270 --> 00:05:28,000
<font color="#E5E5E5">lot more issues that nurses for example</font>

148
00:05:23,920 --> 00:05:30,010
<font color="#E5E5E5">weren't fine</font><font color="#CCCCCC"> flipping this actually on</font>

149
00:05:28,000 --> 00:05:31,890
<font color="#E5E5E5">ahead and taking</font><font color="#CCCCCC"> myths from some of a</font>

150
00:05:30,010 --> 00:05:33,789
<font color="#E5E5E5">more defensive perspective</font><font color="#CCCCCC"> and</font>

151
00:05:31,890 --> 00:05:35,380
traditional security teams<font color="#CCCCCC"> those</font><font color="#E5E5E5"> kind of</font>

152
00:05:33,790 --> 00:05:36,550
very product focus<font color="#E5E5E5"> they rely on someone</font>

153
00:05:35,380 --> 00:05:40,060
else<font color="#E5E5E5"> telling</font><font color="#CCCCCC"> them when something is</font>

154
00:05:36,550 --> 00:05:42,940
<font color="#E5E5E5">going wrong threat hunting is a</font><font color="#CCCCCC"> common</font>

155
00:05:40,060 --> 00:05:45,550
<font color="#E5E5E5">to pen testing you've got a human person</font>

156
00:05:42,940 --> 00:05:48,460
<font color="#CCCCCC">who's there on-site looking at data</font>

157
00:05:45,550 --> 00:05:50,080
getting<font color="#CCCCCC"> hands-on and</font><font color="#E5E5E5"> also they're using</font>

158
00:05:48,460 --> 00:05:52,599
tooling so just like a<font color="#E5E5E5"> pen tester we use</font>

159
00:05:50,080 --> 00:05:54,630
<font color="#CCCCCC">necess sorry a</font><font color="#E5E5E5"> nmap for example to</font>

160
00:05:52,600 --> 00:05:57,490
assist them you can do the same in

161
00:05:54,630 --> 00:05:59,260
traveling<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> create rules or</font><font color="#E5E5E5"> you</font>

162
00:05:57,490 --> 00:06:01,100
can create automatic automatic analysis

163
00:05:59,260 --> 00:06:02,870
to highlight<font color="#E5E5E5"> things of interest</font>

164
00:06:01,100 --> 00:06:04,640
<font color="#CCCCCC">score things to sort of direct</font><font color="#E5E5E5"> your</font>

165
00:06:02,870 --> 00:06:06,860
attention<font color="#E5E5E5"> and we call this I guess</font>

166
00:06:04,640 --> 00:06:09,169
assisted hunts other people call it

167
00:06:06,860 --> 00:06:11,660
<font color="#CCCCCC">different things but</font><font color="#E5E5E5"> in terms of</font>

168
00:06:09,170 --> 00:06:14,270
<font color="#CCCCCC">maturity and</font><font color="#E5E5E5"> traditional security teams</font>

169
00:06:11,660 --> 00:06:15,580
will tend to<font color="#E5E5E5"> be at the far end focus</font><font color="#CCCCCC"> on</font>

170
00:06:14,270 --> 00:06:18,169
just<font color="#E5E5E5"> what a</font><font color="#CCCCCC"> product tells them to do</font>

171
00:06:15,580 --> 00:06:20,180
more advanced<font color="#CCCCCC"> security teams will be in</font>

172
00:06:18,170 --> 00:06:25,070
the raw data<font color="#CCCCCC"> albeit</font><font color="#E5E5E5"> as find here</font>

173
00:06:20,180 --> 00:06:27,080
<font color="#E5E5E5">actually doing manual threaten</font><font color="#CCCCCC"> T so a</font>

174
00:06:25,070 --> 00:06:28,790
concept we<font color="#E5E5E5"> developed some things that we</font>

175
00:06:27,080 --> 00:06:30,370
call the Paris model<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> really</font>

176
00:06:28,790 --> 00:06:33,320
describes the way that we do<font color="#CCCCCC"> fatten T</font>

177
00:06:30,370 --> 00:06:36,860
it's a research driven<font color="#E5E5E5"> approach to use</font>

178
00:06:33,320 --> 00:06:38,480
case generation<font color="#CCCCCC"> and</font><font color="#E5E5E5"> obviously we're</font>

179
00:06:36,860 --> 00:06:41,000
lucky and<font color="#E5E5E5"> there being a security company</font>

180
00:06:38,480 --> 00:06:42,670
<font color="#CCCCCC">we have a dedicated pen testing team we</font>

181
00:06:41,000 --> 00:06:45,860
have a dedicated<font color="#E5E5E5"> instant response team</font>

182
00:06:42,670 --> 00:06:47,660
and anything<font color="#E5E5E5"> these</font><font color="#CCCCCC"> guys find or do in</font>

183
00:06:45,860 --> 00:06:49,970
the wild<font color="#E5E5E5"> feeds directly into what we do</font>

184
00:06:47,660 --> 00:06:53,510
<font color="#E5E5E5">a concept</font><font color="#CCCCCC"> so we</font><font color="#E5E5E5"> know what attackers are</font>

185
00:06:49,970 --> 00:06:54,680
doing as<font color="#E5E5E5"> they discover it</font><font color="#CCCCCC"> themselves and</font>

186
00:06:53,510 --> 00:06:55,550
this<font color="#E5E5E5"> is really important because you</font>

187
00:06:54,680 --> 00:06:58,760
<font color="#E5E5E5">stay current</font>

188
00:06:55,550 --> 00:07:01,220
you stay relevant<font color="#CCCCCC"> and the next part of</font>

189
00:06:58,760 --> 00:07:03,289
<font color="#E5E5E5">this</font><font color="#CCCCCC"> mall is the top section around</font>

190
00:07:01,220 --> 00:07:03,890
automation you know obviously automation

191
00:07:03,290 --> 00:07:05,210
is a good thing

192
00:07:03,890 --> 00:07:07,130
it speeds things up makes you<font color="#E5E5E5"> more</font>

193
00:07:05,210 --> 00:07:08,299
efficient and when you're competing

194
00:07:07,130 --> 00:07:11,590
against<font color="#E5E5E5"> an attack</font><font color="#CCCCCC"> that was</font><font color="#E5E5E5"> also</font>

195
00:07:08,300 --> 00:07:14,180
efficient<font color="#E5E5E5"> that's really important and so</font>

196
00:07:11,590 --> 00:07:15,919
to give a quick<font color="#CCCCCC"> example here you know</font><font color="#E5E5E5"> if</font>

197
00:07:14,180 --> 00:07:18,260
you look at<font color="#CCCCCC"> ad you know a view via the</font>

198
00:07:15,920 --> 00:07:20,630
top of this pyramid<font color="#CCCCCC"> high confidence</font>

199
00:07:18,260 --> 00:07:24,380
right you<font color="#E5E5E5"> see a hash boom</font><font color="#CCCCCC"> it s contains</font>

200
00:07:20,630 --> 00:07:27,800
<font color="#E5E5E5">gets dealt with but say</font><font color="#CCCCCC"> ABC's PowerShell</font>

201
00:07:24,380 --> 00:07:30,560
running what does the<font color="#E5E5E5"> Navy do does it</font>

202
00:07:27,800 --> 00:07:31,910
<font color="#E5E5E5">block</font><font color="#CCCCCC"> it does it allow it it's a tricky</font>

203
00:07:30,560 --> 00:07:33,320
one<font color="#E5E5E5"> right and this is kind of where</font>

204
00:07:31,910 --> 00:07:35,540
<font color="#CCCCCC">straight Hampton comes in it tackles</font>

205
00:07:33,320 --> 00:07:38,090
<font color="#CCCCCC">that</font><font color="#E5E5E5"> world of gray the traditional</font>

206
00:07:35,540 --> 00:07:39,260
approaches just<font color="#E5E5E5"> can't handle and so</font>

207
00:07:38,090 --> 00:07:40,849
PowerShell will actually be maybe I

208
00:07:39,260 --> 00:07:42,890
don't<font color="#E5E5E5"> that</font><font color="#CCCCCC"> 40 percent confidence level</font>

209
00:07:40,850 --> 00:07:45,410
<font color="#CCCCCC">sometimes it's</font><font color="#E5E5E5"> the German sometimes it's</font>

210
00:07:42,890 --> 00:07:46,789
malicious<font color="#E5E5E5"> but having proper rules in</font>

211
00:07:45,410 --> 00:07:48,980
place<font color="#CCCCCC"> to kind</font><font color="#E5E5E5"> of highlight when it may</font>

212
00:07:46,790 --> 00:07:50,720
be<font color="#E5E5E5"> interesting to look</font><font color="#CCCCCC"> at or more</font><font color="#E5E5E5"> likely</font>

213
00:07:48,980 --> 00:07:53,420
to be suspicious<font color="#CCCCCC"> that allows you</font><font color="#E5E5E5"> to</font>

214
00:07:50,720 --> 00:07:54,950
direct your hunting into it but<font color="#CCCCCC"> a key</font>

215
00:07:53,420 --> 00:07:57,280
point<font color="#E5E5E5"> with a small is this research</font>

216
00:07:54,950 --> 00:07:57,280
<font color="#E5E5E5">driven</font>

217
00:07:58,580 --> 00:08:02,760
so in terms of<font color="#E5E5E5"> just</font><font color="#CCCCCC"> a quick example here</font>

218
00:08:01,110 --> 00:08:03,990
<font color="#E5E5E5">you know red teams often use HD files</font>

219
00:08:02,760 --> 00:08:06,900
<font color="#E5E5E5">you guys approach scenes before</font>

220
00:08:03,990 --> 00:08:08,130
PowerShell again very prevalent<font color="#CCCCCC"> if you</font>

221
00:08:06,900 --> 00:08:10,679
were doing<font color="#CCCCCC"> a manual hunt for this to</font>

222
00:08:08,130 --> 00:08:12,990
<font color="#E5E5E5">MSHDA</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> look for</font><font color="#CCCCCC"> partial actually in</font>

223
00:08:10,680 --> 00:08:15,419
process<font color="#E5E5E5"> data here and also if you had</font>

224
00:08:12,990 --> 00:08:17,570
for example power selling<font color="#CCCCCC"> hans login you</font>

225
00:08:15,419 --> 00:08:19,680
can<font color="#CCCCCC"> actually set the</font><font color="#E5E5E5"> log data as well</font>

226
00:08:17,570 --> 00:08:21,510
but over<font color="#E5E5E5"> time you're looking to automate</font>

227
00:08:19,680 --> 00:08:22,949
<font color="#E5E5E5">this you know have some kind of rule or</font>

228
00:08:21,510 --> 00:08:24,870
<font color="#E5E5E5">tagging in place to highlight this</font>

229
00:08:22,949 --> 00:08:26,520
activity so you don't need to manually

230
00:08:24,870 --> 00:08:27,900
query the data every day<font color="#E5E5E5"> that's just</font>

231
00:08:26,520 --> 00:08:30,990
ridiculous right doing manually you want

232
00:08:27,900 --> 00:08:32,250
to speed up and<font color="#CCCCCC"> overtime</font><font color="#E5E5E5"> actually add</font>

233
00:08:30,990 --> 00:08:34,529
more filtering<font color="#E5E5E5"> get rid</font><font color="#CCCCCC"> of false</font>

234
00:08:32,250 --> 00:08:37,169
positives<font color="#CCCCCC"> and add more context</font><font color="#E5E5E5"> you know</font>

235
00:08:34,529 --> 00:08:38,820
if you're looking<font color="#CCCCCC"> at a</font><font color="#E5E5E5"> persistent sentry</font>

236
00:08:37,169 --> 00:08:40,079
you know save<font color="#CCCCCC"> scheduled tasks</font><font color="#E5E5E5"> while</font>

237
00:08:38,820 --> 00:08:41,279
you've got<font color="#E5E5E5"> the name you've got the part</font>

238
00:08:40,080 --> 00:08:42,659
<font color="#E5E5E5">of the file is loading</font>

239
00:08:41,279 --> 00:08:44,610
you've got the frequency<font color="#CCCCCC"> alpha</font><font color="#E5E5E5"> shelter</font>

240
00:08:42,659 --> 00:08:46,439
<font color="#CCCCCC">class London Rose there's all</font><font color="#E5E5E5"> those</font>

241
00:08:44,610 --> 00:08:48,210
parameters<font color="#CCCCCC"> and that matter around it and</font>

242
00:08:46,440 --> 00:08:50,430
even<font color="#E5E5E5"> for the father is running can you</font>

243
00:08:48,210 --> 00:08:52,170
auto submit that<font color="#CCCCCC"> for</font><font color="#E5E5E5"> VP for example and</font>

244
00:08:50,430 --> 00:08:54,089
<font color="#E5E5E5">get other matter there if you can</font>

245
00:08:52,170 --> 00:08:56,219
incorporate this all in a single UI

246
00:08:54,089 --> 00:08:57,870
your founding<font color="#E5E5E5"> team will come rocket you</font>

247
00:08:56,220 --> 00:09:01,020
know<font color="#E5E5E5"> they'll</font><font color="#CCCCCC"> be far more efficient than</font>

248
00:08:57,870 --> 00:09:03,360
<font color="#CCCCCC">what they do these</font><font color="#E5E5E5"> are two key</font><font color="#CCCCCC"> things</font>

249
00:09:01,020 --> 00:09:05,339
here<font color="#E5E5E5"> in general for anything is the</font>

250
00:09:03,360 --> 00:09:07,290
people in technology<font color="#E5E5E5"> and people's a big</font>

251
00:09:05,339 --> 00:09:09,180
one it's a human<font color="#E5E5E5"> driven approach to</font>

252
00:09:07,290 --> 00:09:10,680
security<font color="#E5E5E5"> and having smart people who</font>

253
00:09:09,180 --> 00:09:13,260
understand attackers<font color="#E5E5E5"> so</font>

254
00:09:10,680 --> 00:09:15,209
<font color="#CCCCCC">OS CPS</font><font color="#E5E5E5"> have comp size degrees of a</font>

255
00:09:13,260 --> 00:09:17,520
strong technical grounding is what you

256
00:09:15,209 --> 00:09:20,069
need you don't want just<font color="#E5E5E5"> help desk staff</font>

257
00:09:17,520 --> 00:09:22,740
who answer tickets<font color="#E5E5E5"> that that's not</font><font color="#CCCCCC"> going</font>

258
00:09:20,070 --> 00:09:25,020
to cut it<font color="#CCCCCC"> really and second</font><font color="#E5E5E5"> that in</font>

259
00:09:22,740 --> 00:09:26,610
terms of<font color="#CCCCCC"> technology you know having</font>

260
00:09:25,020 --> 00:09:28,050
clear endpoint visibility having

261
00:09:26,610 --> 00:09:30,120
<font color="#CCCCCC">visibility across as much</font><font color="#E5E5E5"> of your</font>

262
00:09:28,050 --> 00:09:31,140
network as possible is important just

263
00:09:30,120 --> 00:09:33,420
<font color="#CCCCCC">because there's nowhere</font><font color="#E5E5E5"> for attackers to</font>

264
00:09:31,140 --> 00:09:35,699
hide and also having<font color="#E5E5E5"> some kind of</font>

265
00:09:33,420 --> 00:09:38,089
analysis framework to help<font color="#CCCCCC"> you with your</font>

266
00:09:35,700 --> 00:09:38,089
<font color="#E5E5E5">analysis</font>

267
00:09:38,150 --> 00:09:43,040
to give another<font color="#E5E5E5"> quick</font><font color="#CCCCCC"> example of how we</font>

268
00:09:41,510 --> 00:09:45,080
work at<font color="#E5E5E5"> accept some of you guys may have</font>

269
00:09:43,040 --> 00:09:47,060
<font color="#E5E5E5">seen</font><font color="#CCCCCC"> this and</font><font color="#E5E5E5"> this is the recent shadow</font>

270
00:09:45,080 --> 00:09:48,440
brokers<font color="#E5E5E5"> released you know</font><font color="#CCCCCC"> cat said we</font>

271
00:09:47,060 --> 00:09:49,969
jump<font color="#CCCCCC"> stay</font><font color="#E5E5E5"> on that because</font><font color="#CCCCCC"> we saw the</font>

272
00:09:48,440 --> 00:09:51,800
importance of it and and actually

273
00:09:49,970 --> 00:09:53,180
<font color="#E5E5E5">researched into some of</font><font color="#CCCCCC"> those payloads</font>

274
00:09:51,800 --> 00:09:54,949
you<font color="#E5E5E5"> know double</font><font color="#CCCCCC"> pulsar you guys not</font>

275
00:09:53,180 --> 00:09:57,290
heard<font color="#CCCCCC"> or before</font><font color="#E5E5E5"> and we</font><font color="#CCCCCC"> produce some</font>

276
00:09:54,950 --> 00:09:58,910
tools to<font color="#E5E5E5"> help actually detect that this</font>

277
00:09:57,290 --> 00:10:00,680
is what I mean<font color="#CCCCCC"> when I say research and</font>

278
00:09:58,910 --> 00:10:02,329
model and<font color="#E5E5E5"> current</font><font color="#CCCCCC"> research</font><font color="#E5E5E5"> these are the</font>

279
00:10:00,680 --> 00:10:04,400
kind of stuff that security teams and

280
00:10:02,330 --> 00:10:09,710
hunting teams need<font color="#CCCCCC"> to be doing to keep</font>

281
00:10:04,400 --> 00:10:11,480
<font color="#E5E5E5">up to date so where'd you actually begin</font>

282
00:10:09,710 --> 00:10:12,740
<font color="#CCCCCC">I've talked about quite a few bits in</font>

283
00:10:11,480 --> 00:10:15,020
<font color="#CCCCCC">your</font><font color="#E5E5E5"> wondering where do I start</font><font color="#CCCCCC"> with all</font>

284
00:10:12,740 --> 00:10:17,300
<font color="#E5E5E5">this well there's a tendency</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> for</font>

285
00:10:15,020 --> 00:10:18,589
people<font color="#E5E5E5"> to sort</font><font color="#CCCCCC"> of almost</font><font color="#E5E5E5"> just jump into</font>

286
00:10:17,300 --> 00:10:19,069
the data<font color="#E5E5E5"> right you know if someone gives</font>

287
00:10:18,589 --> 00:10:20,060
me data

288
00:10:19,070 --> 00:10:22,270
I just think<font color="#E5E5E5"> awesome I'm just going to</font>

289
00:10:20,060 --> 00:10:24,469
dive in and start finding<font color="#E5E5E5"> the bad guys</font>

290
00:10:22,270 --> 00:10:26,810
<font color="#E5E5E5">but you want to cover most take a step</font>

291
00:10:24,470 --> 00:10:28,550
back there and to find<font color="#E5E5E5"> your requirements</font>

292
00:10:26,810 --> 00:10:30,709
what type<font color="#E5E5E5"> of attack are you looking for</font>

293
00:10:28,550 --> 00:10:33,740
<font color="#CCCCCC">what threat level is it advanced is</font>

294
00:10:30,710 --> 00:10:34,790
<font color="#E5E5E5">commodity is an insider</font><font color="#CCCCCC"> each of these</font>

295
00:10:33,740 --> 00:10:36,529
threat profiles will have different

296
00:10:34,790 --> 00:10:38,480
<font color="#CCCCCC">requirements or even if you've</font><font color="#E5E5E5"> got</font>

297
00:10:36,529 --> 00:10:40,370
<font color="#CCCCCC">specific asset that you want to target</font>

298
00:10:38,480 --> 00:10:46,100
for<font color="#E5E5E5"> monitoring it's important to define</font>

299
00:10:40,370 --> 00:10:47,270
that<font color="#E5E5E5"> upfront in terms of use cases and</font>

300
00:10:46,100 --> 00:10:48,589
this<font color="#E5E5E5"> is kind of read</font><font color="#CCCCCC"> the driver of your</font>

301
00:10:47,270 --> 00:10:51,110
requirements<font color="#E5E5E5"> you know what you actually</font>

302
00:10:48,589 --> 00:10:52,610
want to look<font color="#E5E5E5"> for my</font><font color="#CCCCCC"> deer have actually</font>

303
00:10:51,110 --> 00:10:54,610
<font color="#CCCCCC">produced a really awesome</font><font color="#E5E5E5"> framework</font><font color="#CCCCCC"> all</font>

304
00:10:52,610 --> 00:10:56,740
that are called the attack framework and

305
00:10:54,610 --> 00:10:58,940
this covers read the whole kill chain

306
00:10:56,740 --> 00:11:00,620
from start to finish it has a whole

307
00:10:58,940 --> 00:11:02,810
series of different<font color="#E5E5E5"> techniques to</font>

308
00:11:00,620 --> 00:11:03,980
describe what attackers are doing<font color="#E5E5E5"> and</font>

309
00:11:02,810 --> 00:11:05,150
the best thing about<font color="#E5E5E5"> this is a technical</font>

310
00:11:03,980 --> 00:11:06,890
you can click on any<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of these</font>

311
00:11:05,150 --> 00:11:09,770
<font color="#E5E5E5">entries you can see the</font><font color="#CCCCCC"> script room</font>

312
00:11:06,890 --> 00:11:11,540
<font color="#CCCCCC">actually a description</font><font color="#E5E5E5"> of it and in that</font>

313
00:11:09,770 --> 00:11:13,160
it actually<font color="#CCCCCC"> shows what attacks its</font>

314
00:11:11,540 --> 00:11:15,589
<font color="#CCCCCC">printing used in it shows you</font>

315
00:11:13,160 --> 00:11:17,240
preventative<font color="#E5E5E5"> remediate of actions as</font>

316
00:11:15,589 --> 00:11:19,250
well it's a really<font color="#CCCCCC"> awesome</font><font color="#E5E5E5"> place</font><font color="#CCCCCC"> to</font>

317
00:11:17,240 --> 00:11:20,360
start and it means you just<font color="#E5E5E5"> you don't</font>

318
00:11:19,250 --> 00:11:22,850
<font color="#E5E5E5">have</font><font color="#CCCCCC"> to go and do the research</font><font color="#E5E5E5"> yourself</font>

319
00:11:20,360 --> 00:11:24,140
<font color="#E5E5E5">you can just use this and in our</font>

320
00:11:22,850 --> 00:11:26,089
experience<font color="#CCCCCC"> that these you know</font><font color="#E5E5E5"> focusing</font>

321
00:11:24,140 --> 00:11:29,740
<font color="#E5E5E5">on these</font><font color="#CCCCCC"> real-world</font><font color="#E5E5E5"> attacker activities</font>

322
00:11:26,089 --> 00:11:29,740
it's<font color="#E5E5E5"> given us the</font><font color="#CCCCCC"> most value</font>

323
00:11:31,000 --> 00:11:34,660
so what sort<font color="#CCCCCC"> of</font><font color="#E5E5E5"> data source is John</font><font color="#CCCCCC"> a</font>

324
00:11:33,160 --> 00:11:36,129
focus on so again<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> thinking about</font>

325
00:11:34,660 --> 00:11:37,899
<font color="#E5E5E5">how we can actually</font><font color="#CCCCCC"> begin to detect</font>

326
00:11:36,129 --> 00:11:41,199
those<font color="#CCCCCC"> these cases</font><font color="#E5E5E5"> I previously brought</font>

327
00:11:37,899 --> 00:11:43,389
up there's a tendency<font color="#E5E5E5"> I think for</font>

328
00:11:41,199 --> 00:11:45,519
<font color="#E5E5E5">organizations to through extremes are</font>

329
00:11:43,389 --> 00:11:47,620
<font color="#E5E5E5">the</font><font color="#CCCCCC"> login everything</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> login nothing or</font>

330
00:11:45,519 --> 00:11:48,850
logging the wrong thing<font color="#E5E5E5"> and anyone who's</font>

331
00:11:47,620 --> 00:11:50,259
<font color="#E5E5E5">tried to do this in</font><font color="#CCCCCC"> real life has</font>

332
00:11:48,850 --> 00:11:52,449
probably experienced the kind of

333
00:11:50,259 --> 00:11:54,819
frustrations of<font color="#E5E5E5"> this if you go log in a</font>

334
00:11:52,449 --> 00:11:56,439
ton of<font color="#E5E5E5"> file or logs your servers</font>

335
00:11:54,819 --> 00:11:59,110
probably not going<font color="#E5E5E5"> to like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> and</font>

336
00:11:56,439 --> 00:12:01,689
you'll<font color="#E5E5E5"> have slow search and etc</font><font color="#CCCCCC"> and that</font>

337
00:11:59,110 --> 00:12:03,339
doesn't make<font color="#E5E5E5"> your security team happy if</font>

338
00:12:01,689 --> 00:12:05,050
you can tune that<font color="#CCCCCC"> down and</font><font color="#E5E5E5"> just focus</font><font color="#CCCCCC"> on</font>

339
00:12:03,339 --> 00:12:08,230
things that important<font color="#E5E5E5"> that matter most</font>

340
00:12:05,050 --> 00:12:09,819
and that's<font color="#E5E5E5"> kind what you want to do the</font>

341
00:12:08,230 --> 00:12:12,670
<font color="#E5E5E5">other point to mention here</font><font color="#CCCCCC"> is around</font>

342
00:12:09,819 --> 00:12:14,349
expectation<font color="#E5E5E5"> um if you tell the business</font>

343
00:12:12,670 --> 00:12:16,180
<font color="#CCCCCC">that you're collecting</font><font color="#E5E5E5"> a data source</font>

344
00:12:14,350 --> 00:12:19,089
they're expecting that you're<font color="#E5E5E5"> monitoring</font>

345
00:12:16,180 --> 00:12:21,550
<font color="#E5E5E5">that in the real</font><font color="#CCCCCC"> world it's</font><font color="#E5E5E5"> not as</font>

346
00:12:19,089 --> 00:12:23,470
<font color="#E5E5E5">simple probably</font><font color="#CCCCCC"> ten percent your time is</font>

347
00:12:21,550 --> 00:12:25,439
spent<font color="#E5E5E5"> logging data</font><font color="#CCCCCC"> ninety percent</font><font color="#E5E5E5"> of</font>

348
00:12:23,470 --> 00:12:28,329
<font color="#E5E5E5">your time is spent analyzing said data</font>

349
00:12:25,439 --> 00:12:31,029
so it's important<font color="#CCCCCC"> to explain that</font><font color="#E5E5E5"> to the</font>

350
00:12:28,329 --> 00:12:33,189
various business<font color="#E5E5E5"> areas and</font><font color="#CCCCCC"> see levels</font><font color="#E5E5E5"> to</font>

351
00:12:31,029 --> 00:12:34,509
make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> they understand that analysis</font>

352
00:12:33,189 --> 00:12:36,250
is a massive component here<font color="#CCCCCC"> and it's</font>

353
00:12:34,509 --> 00:12:41,379
<font color="#E5E5E5">actually really hard to do good analysis</font>

354
00:12:36,250 --> 00:12:42,600
<font color="#CCCCCC">that</font><font color="#E5E5E5"> takes time it takes maturity so</font>

355
00:12:41,379 --> 00:12:45,699
what's<font color="#CCCCCC"> the best way of doing</font><font color="#E5E5E5"> this well</font>

356
00:12:42,600 --> 00:12:47,559
I'd say look at the kill chain look at

357
00:12:45,699 --> 00:12:49,209
how a clock is actually operating here

358
00:12:47,559 --> 00:12:52,000
and look at the data sources<font color="#CCCCCC"> that</font>

359
00:12:49,209 --> 00:12:53,680
<font color="#E5E5E5">actually apply these are kind of my</font>

360
00:12:52,000 --> 00:12:56,170
<font color="#E5E5E5">favorite data sources</font><font color="#CCCCCC"> I'm sure you guys</font>

361
00:12:53,680 --> 00:12:57,339
will<font color="#CCCCCC"> have your own favorites as well but</font>

362
00:12:56,170 --> 00:13:00,189
the key<font color="#E5E5E5"> point here it is that you can</font>

363
00:12:57,339 --> 00:13:03,459
see<font color="#CCCCCC"> M</font><font color="#E5E5E5"> point covers this whole middle</font>

364
00:13:00,189 --> 00:13:05,500
section<font color="#E5E5E5"> attackers</font><font color="#CCCCCC"> arrive on endpoints</font>

365
00:13:03,459 --> 00:13:07,569
they move between<font color="#CCCCCC"> M points</font><font color="#E5E5E5"> and they</font>

366
00:13:05,500 --> 00:13:09,129
steal data or make modifications to<font color="#CCCCCC"> M</font>

367
00:13:07,569 --> 00:13:10,628
points if you don't have this there

368
00:13:09,129 --> 00:13:13,629
you're going<font color="#E5E5E5"> to miss a</font><font color="#CCCCCC"> love a lot of</font>

369
00:13:10,629 --> 00:13:16,480
<font color="#E5E5E5">attacks and</font><font color="#CCCCCC"> M point there's</font><font color="#E5E5E5"> really rich</font>

370
00:13:13,629 --> 00:13:18,939
as well it's it gives you a<font color="#E5E5E5"> lot context</font>

371
00:13:16,480 --> 00:13:22,149
<font color="#E5E5E5">you know the</font><font color="#CCCCCC"> hostname the username</font>

372
00:13:18,939 --> 00:13:23,500
when<font color="#E5E5E5"> and where post is executed or files</font>

373
00:13:22,149 --> 00:13:23,649
were dropped or network connections are

374
00:13:23,500 --> 00:13:26,579
made

375
00:13:23,649 --> 00:13:29,139
it's very<font color="#E5E5E5"> rich data source in itself</font>

376
00:13:26,579 --> 00:13:31,089
<font color="#E5E5E5">other data sources like file logs as I</font>

377
00:13:29,139 --> 00:13:33,370
said before are very<font color="#E5E5E5"> weighty they're</font>

378
00:13:31,089 --> 00:13:35,410
difficult<font color="#CCCCCC"> to work with</font><font color="#E5E5E5"> they contain very</font>

379
00:13:33,370 --> 00:13:37,449
limited<font color="#CCCCCC"> information knowing</font><font color="#E5E5E5"> just a port</font>

380
00:13:35,410 --> 00:13:39,620
on<font color="#E5E5E5"> an IP that's not enough for</font><font color="#CCCCCC"> an</font>

381
00:13:37,449 --> 00:13:41,329
investigation<font color="#E5E5E5"> there's no context</font>

382
00:13:39,620 --> 00:13:42,890
and also you<font color="#E5E5E5"> don't even have the data</font>

383
00:13:41,330 --> 00:13:45,440
like what paper<font color="#E5E5E5"> is actually sent between</font>

384
00:13:42,890 --> 00:13:47,840
<font color="#E5E5E5">those two</font><font color="#CCCCCC"> IPS</font><font color="#E5E5E5"> in that file log again</font><font color="#CCCCCC"> you</font>

385
00:13:45,440 --> 00:13:48,980
<font color="#CCCCCC">don't have it so</font><font color="#E5E5E5"> in terms of priorities</font>

386
00:13:47,840 --> 00:13:50,540
you want to focus on the stuff that

387
00:13:48,980 --> 00:13:52,760
<font color="#CCCCCC">really</font><font color="#E5E5E5"> matters here and certainly email</font>

388
00:13:50,540 --> 00:13:55,280
<font color="#E5E5E5">and ask this is where the majority of</font>

389
00:13:52,760 --> 00:13:56,510
payloads enter<font color="#CCCCCC"> organizations</font><font color="#E5E5E5"> end point</font>

390
00:13:55,280 --> 00:13:58,880
where the majority of activity takes

391
00:13:56,510 --> 00:14:00,770
<font color="#CCCCCC">place and even things like bro I love</font>

392
00:13:58,880 --> 00:14:03,290
bro<font color="#E5E5E5"> and it's also for the network</font>

393
00:14:00,770 --> 00:14:05,930
analysis<font color="#CCCCCC"> and definitely</font><font color="#E5E5E5"> those are things</font>

394
00:14:03,290 --> 00:14:08,319
<font color="#E5E5E5">to look at one last quite</font><font color="#CCCCCC"> actually on</font>

395
00:14:05,930 --> 00:14:10,550
this<font color="#E5E5E5"> line is just around ease-of-use</font>

396
00:14:08,320 --> 00:14:13,150
obviously<font color="#CCCCCC"> endpoint stuff you can</font><font color="#E5E5E5"> plow an</font>

397
00:14:10,550 --> 00:14:15,500
agent get coverage very very quickly

398
00:14:13,150 --> 00:14:17,810
<font color="#E5E5E5">persons like doing bro log analysis and</font>

399
00:14:15,500 --> 00:14:19,840
network<font color="#E5E5E5"> now since</font><font color="#CCCCCC"> it's in general</font><font color="#E5E5E5"> you're</font>

400
00:14:17,810 --> 00:14:22,609
obviously going to have<font color="#CCCCCC"> to deploy kit</font>

401
00:14:19,840 --> 00:14:24,170
<font color="#E5E5E5">and if you've got</font><font color="#CCCCCC"> 50 offices</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font>

402
00:14:22,610 --> 00:14:26,990
need to deploy kit<font color="#CCCCCC"> in each of those</font>

403
00:14:24,170 --> 00:14:29,449
offices and<font color="#E5E5E5"> get a</font><font color="#CCCCCC"> span port set some</font>

404
00:14:26,990 --> 00:14:31,190
massive project<font color="#E5E5E5"> so again balance</font>

405
00:14:29,450 --> 00:14:32,480
<font color="#CCCCCC">efficiency with reward here you know</font>

406
00:14:31,190 --> 00:14:34,250
endpoint<font color="#E5E5E5"> gate you can</font><font color="#CCCCCC"> get very quickly</font>

407
00:14:32,480 --> 00:14:39,380
<font color="#CCCCCC">network</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> log stuff it's going</font><font color="#E5E5E5"> to take</font>

408
00:14:34,250 --> 00:14:41,480
a bit longer<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> do analysis again this</font>

409
00:14:39,380 --> 00:14:43,850
is the phase of<font color="#CCCCCC"> trending that</font><font color="#E5E5E5"> is the</font>

410
00:14:41,480 --> 00:14:45,110
longest<font color="#CCCCCC"> stance the hardest</font><font color="#E5E5E5"> I'm not going</font>

411
00:14:43,850 --> 00:14:47,300
<font color="#E5E5E5">to kind of here on the bush here it's</font>

412
00:14:45,110 --> 00:14:49,360
not<font color="#CCCCCC"> easy to do but</font><font color="#E5E5E5"> you need to know how</font>

413
00:14:47,300 --> 00:14:52,130
attackers operate and at a simple level

414
00:14:49,360 --> 00:14:53,630
you can actually<font color="#E5E5E5"> just look for for bad</font>

415
00:14:52,130 --> 00:14:55,490
<font color="#CCCCCC">things like known bad things like PI</font>

416
00:14:53,630 --> 00:14:58,370
receipts<font color="#E5E5E5"> you can look for hash is a bad</font>

417
00:14:55,490 --> 00:14:59,720
hash or some calamity<font color="#E5E5E5"> or whatever and</font>

418
00:14:58,370 --> 00:15:02,540
will<font color="#E5E5E5"> revenge the level you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to look</font>

419
00:14:59,720 --> 00:15:04,430
at<font color="#E5E5E5"> anomalies try and find those unknowns</font>

420
00:15:02,540 --> 00:15:07,520
right<font color="#E5E5E5"> it's a more powerful technique</font>

421
00:15:04,430 --> 00:15:09,500
<font color="#CCCCCC">this</font><font color="#E5E5E5"> false positive prone but you know</font>

422
00:15:07,520 --> 00:15:10,520
that's where I think<font color="#CCCCCC"> the value is and</font>

423
00:15:09,500 --> 00:15:15,140
<font color="#E5E5E5">with a bit of tuning you can actually</font>

424
00:15:10,520 --> 00:15:16,970
<font color="#E5E5E5">get some</font><font color="#CCCCCC"> goodbye there some</font><font color="#E5E5E5"> people might</font>

425
00:15:15,140 --> 00:15:19,670
<font color="#E5E5E5">be a bit angry with me for</font><font color="#CCCCCC"> this slide</font>

426
00:15:16,970 --> 00:15:20,870
but let me<font color="#E5E5E5"> explain so I think</font><font color="#CCCCCC"> the whole</font>

427
00:15:19,670 --> 00:15:23,089
<font color="#E5E5E5">industry really built</font><font color="#CCCCCC"> trans-fat</font>

428
00:15:20,870 --> 00:15:26,720
intelligence and an IOC<font color="#E5E5E5"> is such as</font>

429
00:15:23,090 --> 00:15:28,280
domains<font color="#E5E5E5"> ip's hashes these get touted as</font>

430
00:15:26,720 --> 00:15:31,400
being<font color="#CCCCCC"> very powerful and everyone should</font>

431
00:15:28,280 --> 00:15:33,050
<font color="#E5E5E5">be</font><font color="#CCCCCC"> using this information but</font><font color="#E5E5E5"> the thing</font>

432
00:15:31,400 --> 00:15:34,850
<font color="#CCCCCC">about that</font><font color="#E5E5E5"> is that I receives a good as</font>

433
00:15:33,050 --> 00:15:38,569
<font color="#E5E5E5">detecting things that have been seen</font>

434
00:15:34,850 --> 00:15:40,689
before<font color="#E5E5E5"> it's a reactive approach</font><font color="#CCCCCC"> it's not</font>

435
00:15:38,570 --> 00:15:42,879
a proactive approach

436
00:15:40,689 --> 00:15:44,379
and it's really<font color="#E5E5E5"> dangerous to Asuma</font><font color="#CCCCCC"> just</font>

437
00:15:42,879 --> 00:15:46,569
because we've seen<font color="#E5E5E5"> something once means</font>

438
00:15:44,379 --> 00:15:47,860
you'll see it again<font color="#CCCCCC"> attack us a smarter</font>

439
00:15:46,569 --> 00:15:49,360
than<font color="#CCCCCC"> that they change infrastructure</font>

440
00:15:47,860 --> 00:15:51,730
<font color="#E5E5E5">they change hashes everyone here</font>

441
00:15:49,360 --> 00:15:54,009
<font color="#CCCCCC">probably knows that so</font><font color="#E5E5E5"> again why focus</font>

442
00:15:51,730 --> 00:15:55,360
<font color="#E5E5E5">on things I receive I'm not saying</font>

443
00:15:54,009 --> 00:15:57,819
there's no<font color="#E5E5E5"> value there is some</font><font color="#CCCCCC"> value</font>

444
00:15:55,360 --> 00:15:59,559
here<font color="#E5E5E5"> but in particular things like</font><font color="#CCCCCC"> IPS</font>

445
00:15:57,819 --> 00:16:00,878
can be very false positive prone<font color="#E5E5E5"> you'll</font>

446
00:15:59,559 --> 00:16:02,860
spend all your time just<font color="#CCCCCC"> basically</font>

447
00:16:00,879 --> 00:16:05,350
wading through false positives<font color="#CCCCCC"> trying to</font>

448
00:16:02,860 --> 00:16:11,920
find the real hit<font color="#E5E5E5"> and say it's far more</font>

449
00:16:05,350 --> 00:16:14,470
effective to focus on anomalies so TTP's

450
00:16:11,920 --> 00:16:15,729
offer a broader<font color="#E5E5E5"> approach detection</font>

451
00:16:14,470 --> 00:16:18,790
they're not specific they're not was

452
00:16:15,730 --> 00:16:20,800
targeted as<font color="#E5E5E5"> irises and this is kind of</font>

453
00:16:18,790 --> 00:16:23,040
what a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of stuff is</font><font color="#E5E5E5"> covered in in the</font>

454
00:16:20,800 --> 00:16:26,170
my to attack framework stuff<font color="#E5E5E5"> is TTP's</font>

455
00:16:23,040 --> 00:16:27,730
and I kind of just want<font color="#E5E5E5"> to run</font><font color="#CCCCCC"> through a</font>

456
00:16:26,170 --> 00:16:30,128
few<font color="#CCCCCC"> examples</font><font color="#E5E5E5"> here I've divided this up</font>

457
00:16:27,730 --> 00:16:31,209
<font color="#E5E5E5">by account data ideally in the real</font>

458
00:16:30,129 --> 00:16:32,679
world<font color="#E5E5E5"> you want to do this you want to</font>

459
00:16:31,209 --> 00:16:34,469
<font color="#CCCCCC">kind of unify</font><font color="#E5E5E5"> all your data sources and</font>

460
00:16:32,679 --> 00:16:39,220
<font color="#E5E5E5">have</font><font color="#CCCCCC"> almost one one unified interface</font>

461
00:16:34,470 --> 00:16:41,079
<font color="#E5E5E5">but just for simplicity I've done so for</font>

462
00:16:39,220 --> 00:16:42,959
an endpoint perspective<font color="#CCCCCC"> um</font><font color="#E5E5E5"> there's quite</font>

463
00:16:41,079 --> 00:16:45,849
<font color="#CCCCCC">quite a few</font><font color="#E5E5E5"> things to look for here I'm</font>

464
00:16:42,959 --> 00:16:47,649
so starting off have binaries and

465
00:16:45,850 --> 00:16:49,990
they've been the<font color="#E5E5E5"> go-to for</font><font color="#CCCCCC"> a long time</font>

466
00:16:47,649 --> 00:16:51,309
for attackers<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> old-school right</font><font color="#E5E5E5"> you</font>

467
00:16:49,990 --> 00:16:52,990
just drop<font color="#CCCCCC"> a payload</font><font color="#E5E5E5"> and you run it</font>

468
00:16:51,309 --> 00:16:54,790
<font color="#E5E5E5">what's nice about them is they work</font>

469
00:16:52,990 --> 00:16:57,970
directly<font color="#CCCCCC"> with the</font><font color="#E5E5E5"> windows API they don't</font>

470
00:16:54,790 --> 00:16:59,980
often spin up additional processes and

471
00:16:57,970 --> 00:17:01,600
in terms of detection<font color="#E5E5E5"> you can look for</font>

472
00:16:59,980 --> 00:17:05,230
<font color="#E5E5E5">things like the name the publisher</font><font color="#CCCCCC"> the</font>

473
00:17:01,600 --> 00:17:06,849
location<font color="#E5E5E5"> entropy or</font><font color="#CCCCCC"> VT school</font><font color="#E5E5E5"> there's</font>

474
00:17:05,230 --> 00:17:09,069
lots of like metrics you<font color="#E5E5E5"> can use here</font>

475
00:17:06,849 --> 00:17:10,480
and<font color="#CCCCCC"> we even use</font><font color="#E5E5E5"> something like ml you</font>

476
00:17:09,069 --> 00:17:13,299
know<font color="#CCCCCC"> probably next-gen AV approach to</font>

477
00:17:10,480 --> 00:17:14,589
this<font color="#CCCCCC"> but then there's many other</font>

478
00:17:13,299 --> 00:17:15,970
techniques<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know for more stealthy</font>

479
00:17:14,589 --> 00:17:17,438
attackers they think<font color="#E5E5E5"> okay I'm not I'm</font>

480
00:17:15,970 --> 00:17:19,390
<font color="#CCCCCC">not</font><font color="#E5E5E5"> going to drop a binary I'm going to</font>

481
00:17:17,439 --> 00:17:22,689
use<font color="#E5E5E5"> Windows utilities I'm a very smart</font>

482
00:17:19,390 --> 00:17:25,630
<font color="#E5E5E5">and stealthy the problem with</font><font color="#CCCCCC"> that is</font>

483
00:17:22,689 --> 00:17:27,730
that<font color="#E5E5E5"> as a threat hunter</font><font color="#CCCCCC"> I look for those</font>

484
00:17:25,630 --> 00:17:30,159
windows utilities<font color="#E5E5E5"> I look for them every</font>

485
00:17:27,730 --> 00:17:31,570
<font color="#E5E5E5">day and it's really</font><font color="#CCCCCC"> easy to spot monster</font>

486
00:17:30,159 --> 00:17:33,429
stuff<font color="#E5E5E5"> you know when you run PowerShell</font>

487
00:17:31,570 --> 00:17:35,620
in a malicious<font color="#CCCCCC"> way it's very different</font>

488
00:17:33,429 --> 00:17:36,940
<font color="#E5E5E5">to an admin running PowerShell so it's</font>

489
00:17:35,620 --> 00:17:40,209
actually very<font color="#CCCCCC"> easy to spot malicious</font>

490
00:17:36,940 --> 00:17:43,600
activity involving those and the thing

491
00:17:40,210 --> 00:17:45,909
for persistence almost all attackers use

492
00:17:43,600 --> 00:17:47,620
persistence in some form there's a few

493
00:17:45,909 --> 00:17:49,029
key<font color="#CCCCCC"> locations</font><font color="#E5E5E5"> if you can monitor them</font>

494
00:17:47,620 --> 00:17:50,739
<font color="#E5E5E5">you're probably going to catch the bad</font>

495
00:17:49,029 --> 00:17:52,749
guy

496
00:17:50,740 --> 00:17:54,429
<font color="#E5E5E5">I feel the points like memory injection</font>

497
00:17:52,749 --> 00:17:57,009
<font color="#E5E5E5">I cover on the next slide but</font><font color="#CCCCCC"> fridge</font>

498
00:17:54,429 --> 00:17:59,499
<font color="#E5E5E5">escalation UAC bypass more specific</font>

499
00:17:57,009 --> 00:18:01,360
techniques<font color="#CCCCCC"> here's to bypass existing the</font>

500
00:17:59,499 --> 00:18:04,450
<font color="#CCCCCC">tools</font><font color="#E5E5E5"> or lastly approaches these are</font>

501
00:18:01,360 --> 00:18:05,559
important<font color="#E5E5E5"> things to look for as</font><font color="#CCCCCC"> well and</font>

502
00:18:04,450 --> 00:18:08,649
one<font color="#CCCCCC"> other</font><font color="#E5E5E5"> thing I want to say up for</font>

503
00:18:05,559 --> 00:18:10,299
<font color="#E5E5E5">this was as well on this slide was we</font>

504
00:18:08,649 --> 00:18:12,158
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> really see more modern techniques</font>

505
00:18:10,299 --> 00:18:14,019
so<font color="#E5E5E5"> I don't for those of you follow like</font>

506
00:18:12,159 --> 00:18:16,720
<font color="#CCCCCC">subkey for example</font><font color="#E5E5E5"> and he talks a lot</font>

507
00:18:14,019 --> 00:18:18,909
<font color="#E5E5E5">about like msbuild reg ASM all the kind</font>

508
00:18:16,720 --> 00:18:20,710
of more<font color="#CCCCCC"> cutting-edge</font><font color="#E5E5E5"> stuff we rarely see</font>

509
00:18:18,909 --> 00:18:22,480
<font color="#CCCCCC">that in the</font><font color="#E5E5E5"> world and if you're an</font>

510
00:18:20,710 --> 00:18:25,749
attacker<font color="#CCCCCC"> I</font><font color="#E5E5E5"> strongly recommend using that</font>

511
00:18:22,480 --> 00:18:26,220
<font color="#E5E5E5">it's probably easy to bypass stuff with</font>

512
00:18:25,749 --> 00:18:28,149
it I guess

513
00:18:26,220 --> 00:18:30,220
<font color="#CCCCCC">also another permission side you know</font>

514
00:18:28,149 --> 00:18:30,610
<font color="#E5E5E5">term I wanna cry</font><font color="#CCCCCC"> so I</font><font color="#E5E5E5"> mentioned</font><font color="#CCCCCC"> that</font>

515
00:18:30,220 --> 00:18:33,549
<font color="#E5E5E5">earlier</font>

516
00:18:30,610 --> 00:18:35,590
<font color="#E5E5E5">I'm things like I see ACLs I'm at rib as</font>

517
00:18:33,549 --> 00:18:37,210
well as the SS admin these<font color="#CCCCCC"> cuddle</font><font color="#E5E5E5"> more</font>

518
00:18:35,590 --> 00:18:39,249
<font color="#E5E5E5">specific windows utilities to multiply</font>

519
00:18:37,210 --> 00:18:43,690
permissions and alternate volume Shadow

520
00:18:39,249 --> 00:18:46,360
Copy<font color="#CCCCCC"> it's worth</font><font color="#E5E5E5"> looking out for on the</font>

521
00:18:43,690 --> 00:18:47,860
network side of things<font color="#CCCCCC"> the</font><font color="#E5E5E5"> main</font>

522
00:18:46,360 --> 00:18:49,418
information is a big one<font color="#E5E5E5"> you can</font>

523
00:18:47,860 --> 00:18:50,229
integrate<font color="#E5E5E5"> with third-party services here</font>

524
00:18:49,419 --> 00:18:53,619
so<font color="#E5E5E5"> domain tools</font>

525
00:18:50,230 --> 00:18:54,909
<font color="#CCCCCC">passive total not cheap but you</font><font color="#E5E5E5"> get some</font>

526
00:18:53,619 --> 00:18:55,689
<font color="#E5E5E5">good results with it if you've</font><font color="#CCCCCC"> got the</font>

527
00:18:54,909 --> 00:18:57,429
<font color="#E5E5E5">cash</font>

528
00:18:55,690 --> 00:18:58,809
but you have looking<font color="#E5E5E5"> at classification</font>

529
00:18:57,429 --> 00:19:00,850
really<font color="#E5E5E5"> a history and the age of the</font>

530
00:18:58,809 --> 00:19:03,490
domain who registered it a lot<font color="#E5E5E5"> of</font>

531
00:19:00,850 --> 00:19:05,199
interesting<font color="#E5E5E5"> things</font><font color="#CCCCCC"> there and</font><font color="#E5E5E5"> looking at</font>

532
00:19:03,490 --> 00:19:06,779
file analysis stuff on the<font color="#CCCCCC"> Y</font><font color="#E5E5E5"> is very</font>

533
00:19:05,200 --> 00:19:08,889
<font color="#E5E5E5">nice too</font>

534
00:19:06,779 --> 00:19:09,909
you can look at extension<font color="#E5E5E5"> broths the</font>

535
00:19:08,889 --> 00:19:12,129
attackers can change the extension

536
00:19:09,909 --> 00:19:13,990
signals<font color="#CCCCCC"> look at content type headers or</font>

537
00:19:12,129 --> 00:19:15,998
even do kind of mine detection yourself

538
00:19:13,990 --> 00:19:18,399
again a lot this is covered in covered

539
00:19:15,999 --> 00:19:20,470
in<font color="#CCCCCC"> bro</font><font color="#E5E5E5"> actually by default</font><font color="#CCCCCC"> any kind of</font>

540
00:19:18,399 --> 00:19:23,649
<font color="#E5E5E5">any kind</font><font color="#CCCCCC"> of mismatch between those three</font>

541
00:19:20,470 --> 00:19:26,049
<font color="#E5E5E5">things so you know you see a JPEG coming</font>

542
00:19:23,649 --> 00:19:28,029
down in<font color="#CCCCCC"> extension</font><font color="#E5E5E5"> but it's actually</font>

543
00:19:26,049 --> 00:19:29,679
contain like a<font color="#E5E5E5"> PowerShell script that's</font>

544
00:19:28,029 --> 00:19:32,639
obviously malicious right you can<font color="#E5E5E5"> just</font>

545
00:19:29,679 --> 00:19:32,639
make a rule that<font color="#CCCCCC"> attack</font><font color="#E5E5E5"> that</font>

546
00:19:34,620 --> 00:19:39,178
and the<font color="#CCCCCC"> last</font><font color="#E5E5E5"> bet I want to mention here</font>

547
00:19:36,990 --> 00:19:41,159
<font color="#CCCCCC">just</font><font color="#E5E5E5"> run logs and obviously logs will</font><font color="#CCCCCC"> be</font>

548
00:19:39,179 --> 00:19:43,409
<font color="#E5E5E5">depending on</font><font color="#CCCCCC"> the log type and what the</font>

549
00:19:41,159 --> 00:19:46,919
type of analysis<font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to do windows</font>

550
00:19:43,409 --> 00:19:49,320
logs briefly logins<font color="#E5E5E5"> and lockouts there's</font>

551
00:19:46,919 --> 00:19:51,360
a key use cases that<font color="#CCCCCC"> people are also</font><font color="#E5E5E5"> and</font>

552
00:19:49,320 --> 00:19:53,070
check for but even more<font color="#CCCCCC"> exhausting stuff</font>

553
00:19:51,360 --> 00:19:54,449
like DC sync and<font color="#CCCCCC"> produce</font><font color="#E5E5E5"> collation you</font>

554
00:19:53,070 --> 00:19:57,029
know<font color="#CCCCCC"> chopping a new user in a domain</font>

555
00:19:54,450 --> 00:19:58,320
<font color="#E5E5E5">admin group there's some simple use</font>

556
00:19:57,029 --> 00:20:05,309
cases<font color="#E5E5E5"> there that can again give you some</font>

557
00:19:58,320 --> 00:20:07,830
quick value so I<font color="#CCCCCC"> think there's a while</font>

558
00:20:05,309 --> 00:20:10,649
sort of<font color="#E5E5E5"> widely held belief in the</font>

559
00:20:07,830 --> 00:20:12,600
security<font color="#CCCCCC"> sort community that if you</font>

560
00:20:10,649 --> 00:20:15,658
inject code<font color="#E5E5E5"> directly into a running</font>

561
00:20:12,600 --> 00:20:17,730
process<font color="#CCCCCC"> no one's</font><font color="#E5E5E5"> going to see you</font><font color="#CCCCCC"> got to</font>

562
00:20:15,659 --> 00:20:19,110
bypass<font color="#E5E5E5"> antivirus</font><font color="#CCCCCC"> you're not going to</font>

563
00:20:17,730 --> 00:20:20,250
leave<font color="#E5E5E5"> any files or friends or contacts</font>

564
00:20:19,110 --> 00:20:24,000
on the system<font color="#E5E5E5"> and it's an awesome</font>

565
00:20:20,250 --> 00:20:26,429
technique to use<font color="#E5E5E5"> as a bad guy</font><font color="#CCCCCC"> now the</font>

566
00:20:24,000 --> 00:20:28,409
reality<font color="#CCCCCC"> is that</font><font color="#E5E5E5"> memory normally is quite</font>

567
00:20:26,429 --> 00:20:30,000
easy to detect<font color="#E5E5E5"> from a transit</font>

568
00:20:28,409 --> 00:20:33,870
perspective<font color="#E5E5E5"> if you have the right tool</font>

569
00:20:30,000 --> 00:20:35,820
in place<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> just know some of the</font><font color="#E5E5E5"> the</font>

570
00:20:33,870 --> 00:20:36,949
common techniques<font color="#E5E5E5"> on the left here</font><font color="#CCCCCC"> you</font>

571
00:20:35,820 --> 00:20:38,700
guys<font color="#CCCCCC"> have probably</font><font color="#E5E5E5"> all heard</font><font color="#CCCCCC"> of them</font>

572
00:20:36,950 --> 00:20:40,679
these<font color="#E5E5E5"> are the kinds</font><font color="#CCCCCC"> of techniques</font><font color="#E5E5E5"> that</font>

573
00:20:38,700 --> 00:20:42,840
<font color="#E5E5E5">most intact frameworks use you know</font>

574
00:20:40,679 --> 00:20:46,049
<font color="#CCCCCC">power sploit</font><font color="#E5E5E5"> quartz right</font><font color="#CCCCCC"> Metasploit</font>

575
00:20:42,840 --> 00:20:47,158
they all employ these things and if<font color="#E5E5E5"> you</font>

576
00:20:46,049 --> 00:20:49,440
actually<font color="#E5E5E5"> start looking at the memory</font>

577
00:20:47,159 --> 00:20:51,299
regions associated with<font color="#E5E5E5"> these kinds of</font>

578
00:20:49,440 --> 00:20:53,510
injections the<font color="#CCCCCC"> anomaly's just jump out</font>

579
00:20:51,299 --> 00:20:56,370
straight away<font color="#CCCCCC"> and you'll be</font><font color="#E5E5E5"> unable</font><font color="#CCCCCC"> to</font>

580
00:20:53,510 --> 00:20:58,890
place back the module associated<font color="#E5E5E5"> with</font>

581
00:20:56,370 --> 00:21:00,510
<font color="#CCCCCC">those memory pages again it's a massive</font>

582
00:20:58,890 --> 00:21:02,669
anomaly I'll just come back with<font color="#CCCCCC"> unknown</font>

583
00:21:00,510 --> 00:21:03,929
<font color="#E5E5E5">module and you can also scan that memory</font>

584
00:21:02,669 --> 00:21:06,120
region<font color="#E5E5E5"> or look</font><font color="#CCCCCC"> for key character it's</font>

585
00:21:03,929 --> 00:21:08,909
<font color="#E5E5E5">that characteristics like is there a</font><font color="#CCCCCC"> P</font>

586
00:21:06,120 --> 00:21:10,799
head of that<font color="#E5E5E5"> is there an m0 header and</font>

587
00:21:08,909 --> 00:21:11,909
you can wipe<font color="#E5E5E5"> these things you can work</font>

588
00:21:10,799 --> 00:21:14,279
these things<font color="#CCCCCC"> if</font><font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> some tools</font>

589
00:21:11,909 --> 00:21:16,140
do<font color="#E5E5E5"> but you'll still see for</font><font color="#CCCCCC"> example an</font>

590
00:21:14,279 --> 00:21:18,830
under module or suspicious<font color="#E5E5E5"> to add</font><font color="#CCCCCC"> volts</font>

591
00:21:16,140 --> 00:21:18,830
within that<font color="#E5E5E5"> process</font>

592
00:21:19,450 --> 00:21:23,409
<font color="#E5E5E5">this is just one slide about</font><font color="#CCCCCC"> memory</font>

593
00:21:21,730 --> 00:21:25,630
injection and my colleagues<font color="#CCCCCC"> Matt and</font>

594
00:21:23,409 --> 00:21:28,149
will I<font color="#CCCCCC"> can said they did a whole</font>

595
00:21:25,630 --> 00:21:29,500
<font color="#E5E5E5">presentation on this that is way more</font>

596
00:21:28,149 --> 00:21:31,479
comprehensive and way more<font color="#E5E5E5"> awesome than</font>

597
00:21:29,500 --> 00:21:32,919
this<font color="#E5E5E5"> one slide and it's that that that</font>

598
00:21:31,480 --> 00:21:34,480
<font color="#E5E5E5">link below I'd strongly recommend</font>

599
00:21:32,919 --> 00:21:40,120
checking it out if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> wanna</font><font color="#E5E5E5"> know more</font>

600
00:21:34,480 --> 00:21:41,950
<font color="#CCCCCC">about</font><font color="#E5E5E5"> this so these frequency analysis</font>

601
00:21:40,120 --> 00:21:43,449
of stacking<font color="#E5E5E5"> is one of the kind of the</font>

602
00:21:41,950 --> 00:21:45,460
mainstays I guess of<font color="#E5E5E5"> the threatening</font>

603
00:21:43,450 --> 00:21:47,139
<font color="#E5E5E5">community everyone likes talking about</font>

604
00:21:45,460 --> 00:21:48,760
this<font color="#E5E5E5"> and this really works in the</font>

605
00:21:47,139 --> 00:21:52,449
assumption that attackers<font color="#E5E5E5"> will only ever</font>

606
00:21:48,760 --> 00:21:54,519
<font color="#E5E5E5">be on one or</font><font color="#CCCCCC"> two boxes in general</font><font color="#E5E5E5"> and it</font>

607
00:21:52,450 --> 00:21:57,010
allows you<font color="#E5E5E5"> to spot anomalies</font><font color="#CCCCCC"> so if you</font>

608
00:21:54,519 --> 00:21:58,929
for example were to look at<font color="#CCCCCC"> rung keys</font>

609
00:21:57,010 --> 00:22:00,760
<font color="#E5E5E5">across an organization</font><font color="#CCCCCC"> there'll</font><font color="#E5E5E5"> be the</font>

610
00:21:58,929 --> 00:22:03,159
same<font color="#E5E5E5"> wrong keys on a large number of</font>

611
00:22:00,760 --> 00:22:05,230
<font color="#CCCCCC">boxes you know you've got</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> was it</font>

612
00:22:03,159 --> 00:22:07,690
like Java update or whatever<font color="#E5E5E5"> that</font><font color="#CCCCCC"> will</font>

613
00:22:05,230 --> 00:22:09,519
be on like a few thousand boxes but then

614
00:22:07,690 --> 00:22:11,200
maybe if the attacker<font color="#CCCCCC"> drops</font><font color="#E5E5E5"> one specific</font>

615
00:22:09,519 --> 00:22:12,970
run key for one specific payload<font color="#E5E5E5"> on</font><font color="#CCCCCC"> one</font>

616
00:22:11,200 --> 00:22:14,019
box<font color="#E5E5E5"> well that's going</font><font color="#CCCCCC"> to be at the other</font>

617
00:22:12,970 --> 00:22:18,130
<font color="#CCCCCC">end of the scale it's going to be</font>

618
00:22:14,019 --> 00:22:19,419
anomalous<font color="#CCCCCC"> um I put</font><font color="#E5E5E5"> some real data just</font>

619
00:22:18,130 --> 00:22:22,750
<font color="#E5E5E5">to give you guys a bit of an</font><font color="#CCCCCC"> example</font>

620
00:22:19,419 --> 00:22:25,480
here<font color="#E5E5E5"> highest frequency counter really</font>

621
00:22:22,750 --> 00:22:26,679
high<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is just</font><font color="#E5E5E5"> process data and you</font>

622
00:22:25,480 --> 00:22:28,539
<font color="#CCCCCC">can</font><font color="#E5E5E5"> see these are just</font><font color="#CCCCCC"> standard windows</font>

623
00:22:26,679 --> 00:22:32,740
processes there's nothing weird about

624
00:22:28,539 --> 00:22:34,629
that and then you<font color="#E5E5E5"> can see the far end of</font>

625
00:22:32,740 --> 00:22:36,730
the scale there's slightly more

626
00:22:34,630 --> 00:22:38,590
interesting<font color="#E5E5E5"> stuff and you've got maybe I</font>

627
00:22:36,730 --> 00:22:40,929
<font color="#E5E5E5">think this is like</font><font color="#CCCCCC"> a HP driver you've</font>

628
00:22:38,590 --> 00:22:43,899
<font color="#E5E5E5">got the Intel agent temporary file and</font>

629
00:22:40,929 --> 00:22:46,960
other<font color="#E5E5E5"> weird</font><font color="#CCCCCC"> stuff I don't know this</font>

630
00:22:43,899 --> 00:22:48,699
might be<font color="#E5E5E5"> malicious and</font><font color="#CCCCCC"> I guess this</font><font color="#E5E5E5"> kind</font>

631
00:22:46,960 --> 00:22:50,260
<font color="#CCCCCC">of shows the power of</font><font color="#E5E5E5"> how you can use</font>

632
00:22:48,700 --> 00:22:52,690
these frequency analysis and<font color="#E5E5E5"> this is</font>

633
00:22:50,260 --> 00:22:54,760
<font color="#E5E5E5">quite a limited view and you want to</font>

634
00:22:52,690 --> 00:22:57,100
<font color="#E5E5E5">kind of regard this more as</font><font color="#CCCCCC"> just one</font>

635
00:22:54,760 --> 00:22:58,658
metric<font color="#E5E5E5"> in your analysis I'm obviously</font>

636
00:22:57,100 --> 00:23:00,459
<font color="#CCCCCC">free to</font><font color="#E5E5E5"> those files like I said before</font>

637
00:22:58,659 --> 00:23:04,049
there's a<font color="#E5E5E5"> location</font><font color="#CCCCCC"> associated with that</font>

638
00:23:00,460 --> 00:23:07,840
publish so a<font color="#E5E5E5"> VT score and entropy rating</font>

639
00:23:04,049 --> 00:23:10,379
and that<font color="#CCCCCC"> extra context can help you with</font>

640
00:23:07,840 --> 00:23:10,379
investigation

641
00:23:10,490 --> 00:23:15,860
<font color="#CCCCCC">a relationship</font><font color="#E5E5E5"> based on artists or graph</font>

642
00:23:13,490 --> 00:23:18,470
analysis comes the way the data points

643
00:23:15,860 --> 00:23:21,678
<font color="#E5E5E5">actually related to each other</font><font color="#CCCCCC"> and this</font>

644
00:23:18,470 --> 00:23:24,020
<font color="#E5E5E5">is</font><font color="#CCCCCC"> a classic</font><font color="#E5E5E5"> attack example here of an</font>

645
00:23:21,679 --> 00:23:25,929
attacker wearing a macro<font color="#E5E5E5"> with in</font>

646
00:23:24,020 --> 00:23:28,150
windward<font color="#CCCCCC"> and a CMD dropping out of it</font>

647
00:23:25,929 --> 00:23:31,190
if you<font color="#E5E5E5"> are looking at parent process</font>

648
00:23:28,150 --> 00:23:32,660
relationships you'd say<font color="#E5E5E5"> okay windward is</font>

649
00:23:31,190 --> 00:23:34,520
the parent<font color="#E5E5E5"> CMD is the child</font>

650
00:23:32,660 --> 00:23:36,050
this is extremely anomalous and<font color="#CCCCCC"> if you</font>

651
00:23:34,520 --> 00:23:37,940
look across your state<font color="#E5E5E5"> you'll be able to</font>

652
00:23:36,050 --> 00:23:41,928
see common relationships and uncommon

653
00:23:37,940 --> 00:23:43,670
relationships but don't just limit

654
00:23:41,929 --> 00:23:45,200
<font color="#CCCCCC">yourself to</font><font color="#E5E5E5"> you to windward and CMD</font>

655
00:23:43,670 --> 00:23:47,390
obviously there's lots<font color="#CCCCCC"> more options here</font>

656
00:23:45,200 --> 00:23:49,670
<font color="#E5E5E5">and both in terms of</font><font color="#CCCCCC"> paid</font><font color="#E5E5E5"> deliveries of</font>

657
00:23:47,390 --> 00:23:52,460
<font color="#E5E5E5">W</font><font color="#CCCCCC"> Script register run deal l32</font>

658
00:23:49,670 --> 00:23:56,330
<font color="#CCCCCC">powershell reggie anthem there's tons</font>

659
00:23:52,460 --> 00:23:57,860
and<font color="#E5E5E5"> also parent processes as well see</font>

660
00:23:56,330 --> 00:23:58,760
<font color="#CCCCCC">this is for a macro</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> how about if</font>

661
00:23:57,860 --> 00:24:00,678
someone<font color="#E5E5E5"> delivered a payload through</font>

662
00:23:58,760 --> 00:24:02,809
<font color="#E5E5E5">outlook</font><font color="#CCCCCC"> well then you'd have</font><font color="#E5E5E5"> out with is</font>

663
00:24:00,679 --> 00:24:04,130
<font color="#E5E5E5">the parent or someone delivered a link</font>

664
00:24:02,809 --> 00:24:06,020
and they clicked in it and they<font color="#E5E5E5"> went</font>

665
00:24:04,130 --> 00:24:07,700
<font color="#E5E5E5">through chrome download next payload</font>

666
00:24:06,020 --> 00:24:09,440
<font color="#E5E5E5">well then you'd have a browser</font><font color="#CCCCCC"> that the</font>

667
00:24:07,700 --> 00:24:12,590
parent process<font color="#E5E5E5"> so kind of think about</font>

668
00:24:09,440 --> 00:24:15,140
<font color="#E5E5E5">these</font><font color="#CCCCCC"> other options</font><font color="#E5E5E5"> as well and also</font>

669
00:24:12,590 --> 00:24:15,860
it's<font color="#E5E5E5"> not</font><font color="#CCCCCC"> just not just processes</font><font color="#E5E5E5"> some</font>

670
00:24:15,140 --> 00:24:17,570
<font color="#E5E5E5">things</font><font color="#CCCCCC"> bigger than that</font>

671
00:24:15,860 --> 00:24:18,939
think about user sessions you<font color="#E5E5E5"> know how</font>

672
00:24:17,570 --> 00:24:21,379
to use the sessions relate to each other

673
00:24:18,940 --> 00:24:23,270
<font color="#CCCCCC">domain admins have very specific</font>

674
00:24:21,380 --> 00:24:26,270
profiles that they they<font color="#E5E5E5"> follow these</font>

675
00:24:23,270 --> 00:24:28,340
<font color="#E5E5E5">they log on to a few specific servers</font>

676
00:24:26,270 --> 00:24:30,590
<font color="#CCCCCC">whereas regular</font><font color="#E5E5E5"> users they just log on</font>

677
00:24:28,340 --> 00:24:32,178
to<font color="#CCCCCC"> their workstation if you start doing</font>

678
00:24:30,590 --> 00:24:33,740
graphing looking at how user sessions

679
00:24:32,179 --> 00:24:35,660
are<font color="#E5E5E5"> used you'll start to see some</font>

680
00:24:33,740 --> 00:24:37,250
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> relationships and if they if</font>

681
00:24:35,660 --> 00:24:39,530
those relationships<font color="#CCCCCC"> actually change over</font>

682
00:24:37,250 --> 00:24:41,990
time<font color="#E5E5E5"> say a domain admin account such as</font>

683
00:24:39,530 --> 00:24:44,540
a thousand<font color="#E5E5E5"> workstations you know that's</font>

684
00:24:41,990 --> 00:24:45,590
pretty<font color="#E5E5E5"> anonymous</font><font color="#CCCCCC"> yeah there's</font><font color="#E5E5E5"> other data</font>

685
00:24:44,540 --> 00:24:49,809
<font color="#E5E5E5">sets to look at here</font>

686
00:24:45,590 --> 00:24:49,809
you know<font color="#E5E5E5"> network traffic user sessions</font>

687
00:24:50,070 --> 00:24:54,510
machine<font color="#CCCCCC"> learning is something</font><font color="#E5E5E5"> that's</font>

688
00:24:51,810 --> 00:24:56,159
been talked about<font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> in the security</font>

689
00:24:54,510 --> 00:24:57,090
industry and also<font color="#E5E5E5"> the wider</font><font color="#CCCCCC"> I guess IT</font>

690
00:24:56,160 --> 00:25:00,360
community<font color="#CCCCCC"> as well</font>

691
00:24:57,090 --> 00:25:03,959
I can't<font color="#CCCCCC"> accept</font><font color="#E5E5E5"> at least you know we use</font>

692
00:25:00,360 --> 00:25:08,760
<font color="#E5E5E5">two specific techniques to help us spot</font>

693
00:25:03,960 --> 00:25:10,530
anomalies<font color="#CCCCCC"> the first is clustering which</font>

694
00:25:08,760 --> 00:25:12,060
we actually<font color="#E5E5E5"> tzer's or as a data</font>

695
00:25:10,530 --> 00:25:14,129
reduction<font color="#E5E5E5"> technique</font><font color="#CCCCCC"> so if you take</font>

696
00:25:12,060 --> 00:25:16,679
<font color="#E5E5E5">process data and you cluster it together</font>

697
00:25:14,130 --> 00:25:18,480
based on say the arguments you'll see

698
00:25:16,680 --> 00:25:20,550
that<font color="#E5E5E5"> very similar things come together</font><font color="#CCCCCC"> a</font>

699
00:25:18,480 --> 00:25:22,230
<font color="#E5E5E5">normal things</font><font color="#CCCCCC"> kind of</font><font color="#E5E5E5"> come outside and</font>

700
00:25:20,550 --> 00:25:24,750
that's where you can kind of focus your

701
00:25:22,230 --> 00:25:26,700
<font color="#CCCCCC">analysis again it's it's not the be-all</font>

702
00:25:24,750 --> 00:25:28,380
end-all<font color="#CCCCCC"> but it's</font><font color="#E5E5E5"> just another metric you</font>

703
00:25:26,700 --> 00:25:31,020
can<font color="#E5E5E5"> add to your kind of series of</font>

704
00:25:28,380 --> 00:25:32,850
<font color="#CCCCCC">metrics</font><font color="#E5E5E5"> that you're using and also climb</font>

705
00:25:31,020 --> 00:25:34,950
series<font color="#E5E5E5"> normally detection is quite</font>

706
00:25:32,850 --> 00:25:36,659
interesting<font color="#CCCCCC"> I mentioned so user sessions</font>

707
00:25:34,950 --> 00:25:40,500
<font color="#E5E5E5">are min ago that's one one application</font>

708
00:25:36,660 --> 00:25:41,550
another<font color="#E5E5E5"> is on network transfers and this</font>

709
00:25:40,500 --> 00:25:44,490
is actually what<font color="#CCCCCC"> you</font><font color="#E5E5E5"> guys can see up on</font>

710
00:25:41,550 --> 00:25:48,090
<font color="#E5E5E5">the board here</font><font color="#CCCCCC"> so this is actually I</font>

711
00:25:44,490 --> 00:25:50,310
think<font color="#E5E5E5"> this is downloads and so you can</font>

712
00:25:48,090 --> 00:25:52,350
see<font color="#E5E5E5"> most people</font><font color="#CCCCCC"> fit at this bottom level</font>

713
00:25:50,310 --> 00:25:54,360
here but aggregating over time and using

714
00:25:52,350 --> 00:25:56,219
a kind<font color="#E5E5E5"> of baseline approach and you can</font>

715
00:25:54,360 --> 00:25:57,990
see there's some anomalies<font color="#CCCCCC"> to their</font>

716
00:25:56,220 --> 00:26:00,570
usual baselines<font color="#CCCCCC"> and it's going to pop</font>

717
00:25:57,990 --> 00:26:02,300
out<font color="#E5E5E5"> the top here</font><font color="#CCCCCC"> based on five standard</font>

718
00:26:00,570 --> 00:26:04,649
volumes

719
00:26:02,300 --> 00:26:06,680
another<font color="#CCCCCC"> approach is with</font><font color="#E5E5E5"> just touching</font>

720
00:26:04,650 --> 00:26:09,300
<font color="#E5E5E5">on quickly is supervised classification</font>

721
00:26:06,680 --> 00:26:11,640
<font color="#E5E5E5">so you can use that for files for</font>

722
00:26:09,300 --> 00:26:13,169
example<font color="#E5E5E5"> take a thousand bad files think</font>

723
00:26:11,640 --> 00:26:16,080
it has some good files<font color="#CCCCCC"> train your ml</font>

724
00:26:13,170 --> 00:26:17,070
<font color="#E5E5E5">model building XJ nav and whatnot</font><font color="#CCCCCC"> we</font>

725
00:26:16,080 --> 00:26:18,899
<font color="#CCCCCC">actually use this for ransomware</font>

726
00:26:17,070 --> 00:26:20,220
protection as part of our metrics that

727
00:26:18,900 --> 00:26:23,100
we use there's some other<font color="#E5E5E5"> ones we do as</font>

728
00:26:20,220 --> 00:26:26,220
well but<font color="#E5E5E5"> if you're sick</font><font color="#CCCCCC"> of hearing about</font>

729
00:26:23,100 --> 00:26:28,590
ml and on all the hype the other thing

730
00:26:26,220 --> 00:26:30,360
to do is<font color="#E5E5E5"> check out</font><font color="#CCCCCC"> our paper</font><font color="#E5E5E5"> and do it</font>

731
00:26:28,590 --> 00:26:32,760
on our<font color="#E5E5E5"> on our website</font><font color="#CCCCCC"> this actually cut</font>

732
00:26:30,360 --> 00:26:34,199
through<font color="#E5E5E5"> a lot of the kind</font><font color="#CCCCCC"> of like</font>

733
00:26:32,760 --> 00:26:37,550
<font color="#CCCCCC">billion screen gets to the point what</font>

734
00:26:34,200 --> 00:26:37,550
works and what<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> work and why</font>

735
00:26:38,620 --> 00:26:42,290
so<font color="#CCCCCC"> it's go up to do</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> that I've been</font>

736
00:26:40,760 --> 00:26:44,510
<font color="#CCCCCC">talking about so far and it's scalable</font>

737
00:26:42,290 --> 00:26:50,960
<font color="#E5E5E5">and an automated way you need to think</font>

738
00:26:44,510 --> 00:26:52,070
about<font color="#E5E5E5"> automation so I recently watched</font>

739
00:26:50,960 --> 00:26:55,220
<font color="#CCCCCC">the</font><font color="#E5E5E5"> movie called they're called</font><font color="#CCCCCC"> the</font>

740
00:26:52,070 --> 00:26:56,780
founder and<font color="#CCCCCC"> this is any we've not seen</font>

741
00:26:55,220 --> 00:27:00,050
it<font color="#CCCCCC"> especially the story of McDonald's</font>

742
00:26:56,780 --> 00:27:01,580
<font color="#E5E5E5">and there's an interesting scene in that</font>

743
00:27:00,050 --> 00:27:03,290
<font color="#CCCCCC">movie where they they go to this tennis</font>

744
00:27:01,580 --> 00:27:06,050
court and<font color="#CCCCCC"> they get some chalk</font><font color="#E5E5E5"> and</font>

745
00:27:03,290 --> 00:27:08,149
actually swore out the<font color="#E5E5E5"> module kitchen on</font>

746
00:27:06,050 --> 00:27:09,440
the ground<font color="#E5E5E5"> and they try and</font><font color="#CCCCCC"> figure out</font>

747
00:27:08,150 --> 00:27:11,330
where<font color="#CCCCCC"> to actually place everything in</font>

748
00:27:09,440 --> 00:27:13,700
the most<font color="#E5E5E5"> optimal configuration</font><font color="#CCCCCC"> so they</font>

749
00:27:11,330 --> 00:27:16,939
can make burgers in the most optimal<font color="#CCCCCC"> way</font>

750
00:27:13,700 --> 00:27:18,290
I guess or<font color="#CCCCCC"> something oh and this kind of</font>

751
00:27:16,940 --> 00:27:20,120
<font color="#E5E5E5">remind you of how important is for</font>

752
00:27:18,290 --> 00:27:23,330
<font color="#CCCCCC">security teams to be efficient and</font><font color="#E5E5E5"> work</font>

753
00:27:20,120 --> 00:27:24,919
together<font color="#E5E5E5"> if you think about with</font><font color="#CCCCCC"> dogs</font>

754
00:27:23,330 --> 00:27:26,840
you know<font color="#E5E5E5"> they suffered you know from</font>

755
00:27:24,920 --> 00:27:28,070
other competition in town<font color="#E5E5E5"> you know they</font>

756
00:27:26,840 --> 00:27:30,610
<font color="#E5E5E5">have to be fast they have to be</font>

757
00:27:28,070 --> 00:27:33,439
efficient they have to be cost effective

758
00:27:30,610 --> 00:27:35,510
<font color="#E5E5E5">it's the same for security teams we're</font>

759
00:27:33,440 --> 00:27:38,510
<font color="#E5E5E5">facing attackers who are also fighting</font>

760
00:27:35,510 --> 00:27:39,980
<font color="#E5E5E5">efficiency within own teams and</font><font color="#CCCCCC"> it's</font>

761
00:27:38,510 --> 00:27:41,660
<font color="#E5E5E5">whoever's the fastest wither the most</font>

762
00:27:39,980 --> 00:27:44,540
agile<font color="#E5E5E5"> whoever the most technically</font>

763
00:27:41,660 --> 00:27:45,740
competent<font color="#E5E5E5"> is going to win and it's</font>

764
00:27:44,540 --> 00:27:49,129
interesting<font color="#E5E5E5"> because when</font><font color="#CCCCCC"> you look at</font>

765
00:27:45,740 --> 00:27:50,990
<font color="#E5E5E5">less able security teams they just get</font>

766
00:27:49,130 --> 00:27:53,270
<font color="#E5E5E5">stomped on by attackers because they</font>

767
00:27:50,990 --> 00:27:57,800
<font color="#E5E5E5">just aren't able to be fast efficient or</font>

768
00:27:53,270 --> 00:27:59,480
technically hate bugs ideally<font color="#CCCCCC"> I think</font>

769
00:27:57,800 --> 00:28:01,070
you want<font color="#E5E5E5"> to review your workflow and</font>

770
00:27:59,480 --> 00:28:02,810
figure out where your<font color="#E5E5E5"> pain points</font><font color="#CCCCCC"> are</font>

771
00:28:01,070 --> 00:28:04,760
you know from the<font color="#E5E5E5"> tension or into</font>

772
00:28:02,810 --> 00:28:06,860
response what's taking the longest<font color="#E5E5E5"> you</font>

773
00:28:04,760 --> 00:28:08,150
know why aren't<font color="#CCCCCC"> things working and the</font>

774
00:28:06,860 --> 00:28:09,889
more you can speed up<font color="#E5E5E5"> the more awesome</font>

775
00:28:08,150 --> 00:28:11,720
<font color="#E5E5E5">resource you</font><font color="#CCCCCC"> can start doing</font><font color="#E5E5E5"> the more</font>

776
00:28:09,890 --> 00:28:16,340
<font color="#E5E5E5">capability you</font><font color="#CCCCCC"> can add and it</font><font color="#E5E5E5"> ends up as</font>

777
00:28:11,720 --> 00:28:18,050
a<font color="#E5E5E5"> sort of positive</font><font color="#CCCCCC"> feedback loop so I</font>

778
00:28:16,340 --> 00:28:20,030
want<font color="#E5E5E5"> to share I got a few more practical</font>

779
00:28:18,050 --> 00:28:21,710
<font color="#E5E5E5">tips around automation</font><font color="#CCCCCC"> I said it before</font>

780
00:28:20,030 --> 00:28:24,800
you know data<font color="#E5E5E5"> and ask using scoring</font>

781
00:28:21,710 --> 00:28:26,840
rules or 50<font color="#E5E5E5"> tons</font><font color="#CCCCCC"> this is really useful</font>

782
00:28:24,800 --> 00:28:30,080
<font color="#CCCCCC">you know if you see Power Cell running</font>

783
00:28:26,840 --> 00:28:31,189
with any kind of suspicious arguments

784
00:28:30,080 --> 00:28:33,139
they were doing in the memory injection

785
00:28:31,190 --> 00:28:34,970
for example you want<font color="#E5E5E5"> to highlight that</font>

786
00:28:33,140 --> 00:28:35,960
up<font color="#CCCCCC"> straightaway to</font><font color="#E5E5E5"> your team again don't</font>

787
00:28:34,970 --> 00:28:37,370
think<font color="#E5E5E5"> of it</font><font color="#CCCCCC"> as an alert</font>

788
00:28:35,960 --> 00:28:39,740
think of<font color="#E5E5E5"> it as something</font><font color="#CCCCCC"> that's</font>

789
00:28:37,370 --> 00:28:41,179
interesting<font color="#E5E5E5"> and worth investigating</font><font color="#CCCCCC"> it's</font>

790
00:28:39,740 --> 00:28:43,150
not as<font color="#E5E5E5"> simple as black and white</font><font color="#CCCCCC"> in</font>

791
00:28:41,180 --> 00:28:45,200
<font color="#E5E5E5">trout hunting it's all about scoring and</font>

792
00:28:43,150 --> 00:28:47,030
highlighting more interesting things

793
00:28:45,200 --> 00:28:48,169
less interesting things that<font color="#CCCCCC"> that</font><font color="#E5E5E5"> make</font>

794
00:28:47,030 --> 00:28:50,760
sense

795
00:28:48,169 --> 00:28:52,950
contact again adding more metrics to

796
00:28:50,760 --> 00:28:54,720
your views<font color="#E5E5E5"> making sure your guys can see</font>

797
00:28:52,950 --> 00:28:56,610
all the data they need<font color="#E5E5E5"> to and they don't</font>

798
00:28:54,720 --> 00:28:58,320
<font color="#E5E5E5">need to maybe click between different</font>

799
00:28:56,610 --> 00:29:00,149
systems<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that's that's</font><font color="#E5E5E5"> again</font>

800
00:28:58,320 --> 00:29:03,090
ridiculous<font color="#E5E5E5"> get it all in</font><font color="#CCCCCC"> one page</font><font color="#E5E5E5"> make</font>

801
00:29:00,150 --> 00:29:05,429
it easy<font color="#E5E5E5"> to use printer responds I talked</font>

802
00:29:03,090 --> 00:29:08,010
about<font color="#CCCCCC"> before</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> things a big one</font>

803
00:29:05,429 --> 00:29:11,279
I think<font color="#CCCCCC"> I think we all hate sitting fee</font>

804
00:29:08,010 --> 00:29:12,990
blood<font color="#CCCCCC"> it's it's very</font><font color="#E5E5E5"> time consuming but</font>

805
00:29:11,279 --> 00:29:14,520
it's not a necessary<font color="#CCCCCC"> evil I guess in</font>

806
00:29:12,990 --> 00:29:16,559
<font color="#E5E5E5">security you know you have to track</font>

807
00:29:14,520 --> 00:29:18,000
instance<font color="#E5E5E5"> you have to collaborate</font><font color="#CCCCCC"> with</font>

808
00:29:16,559 --> 00:29:20,820
<font color="#CCCCCC">people</font><font color="#E5E5E5"> you know using ticketing make</font>

809
00:29:18,000 --> 00:29:22,559
sense but again think about<font color="#E5E5E5"> automation</font>

810
00:29:20,820 --> 00:29:23,850
how can you<font color="#E5E5E5"> right-click on something and</font>

811
00:29:22,559 --> 00:29:25,918
have that automatically generate a

812
00:29:23,850 --> 00:29:28,379
ticket or you<font color="#E5E5E5"> seem to mean</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> over here</font>

813
00:29:25,919 --> 00:29:29,730
how do<font color="#E5E5E5"> you add that automatically don't</font>

814
00:29:28,380 --> 00:29:32,340
fall don't force the sort of<font color="#E5E5E5"> founding</font>

815
00:29:29,730 --> 00:29:36,690
<font color="#CCCCCC">team to</font><font color="#E5E5E5"> do anything manually type in</font>

816
00:29:32,340 --> 00:29:38,908
<font color="#E5E5E5">this</font><font color="#CCCCCC"> roll out</font><font color="#E5E5E5"> pillows</font><font color="#CCCCCC"> and answers as</font>

817
00:29:36,690 --> 00:29:40,409
well<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> malware</font><font color="#E5E5E5"> analysis can take</font>

818
00:29:38,909 --> 00:29:41,850
a long time<font color="#CCCCCC"> in general</font><font color="#E5E5E5"> any way you can</font>

819
00:29:40,409 --> 00:29:43,830
sort speed that up with things like

820
00:29:41,850 --> 00:29:47,010
<font color="#E5E5E5">plugins is really useful and lastly</font><font color="#CCCCCC"> BOTS</font>

821
00:29:43,830 --> 00:29:48,689
<font color="#E5E5E5">as well</font><font color="#CCCCCC"> a really interesting</font><font color="#E5E5E5"> area but</font><font color="#CCCCCC"> to</font>

822
00:29:47,010 --> 00:29:50,250
<font color="#E5E5E5">actually improve communication within</font>

823
00:29:48,690 --> 00:29:51,450
<font color="#CCCCCC">the business</font><font color="#E5E5E5"> this is something that's</font>

824
00:29:50,250 --> 00:29:52,950
<font color="#CCCCCC">quite new but I think it's</font><font color="#E5E5E5"> actually</font>

825
00:29:51,450 --> 00:29:55,940
<font color="#E5E5E5">really</font><font color="#CCCCCC"> interesting</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> they've got a lot</font>

826
00:29:52,950 --> 00:29:55,940
of promise going forward in the<font color="#E5E5E5"> future</font>

827
00:29:57,289 --> 00:30:00,539
so we'll just skip ahead a<font color="#E5E5E5"> little bit</font>

828
00:29:59,250 --> 00:30:03,480
excellent thing I'm running a bit late

829
00:30:00,539 --> 00:30:05,370
<font color="#CCCCCC">so I want</font><font color="#E5E5E5"> to talk about quick insider</font>

830
00:30:03,480 --> 00:30:06,870
attack and<font color="#E5E5E5"> this is a</font><font color="#CCCCCC"> real-world example</font>

831
00:30:05,370 --> 00:30:12,449
this<font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> something we've</font>

832
00:30:06,870 --> 00:30:14,070
detected a concept and<font color="#E5E5E5"> if you look at</font>

833
00:30:12,450 --> 00:30:17,100
<font color="#E5E5E5">this there was actually a binary we saw</font>

834
00:30:14,070 --> 00:30:18,600
through these frequency analysis and

835
00:30:17,100 --> 00:30:22,020
this was<font color="#E5E5E5"> actually in the startup</font><font color="#CCCCCC"> called</font>

836
00:30:18,600 --> 00:30:23,279
<font color="#CCCCCC">of multiple</font><font color="#E5E5E5"> systems actually and we</font>

837
00:30:22,020 --> 00:30:25,799
<font color="#CCCCCC">actually traced</font><font color="#E5E5E5"> this back and we did</font><font color="#CCCCCC"> a</font>

838
00:30:23,279 --> 00:30:28,080
wider search<font color="#E5E5E5"> across</font><font color="#CCCCCC"> the estate for this</font>

839
00:30:25,799 --> 00:30:30,450
file and I'm<font color="#E5E5E5"> finally running on multiple</font>

840
00:30:28,080 --> 00:30:32,158
<font color="#CCCCCC">systems</font><font color="#E5E5E5"> I'm pulling back the farm</font>

841
00:30:30,450 --> 00:30:34,470
analyzing it turned out<font color="#E5E5E5"> it was a Python</font>

842
00:30:32,159 --> 00:30:38,100
kilala<font color="#CCCCCC"> group and there was spitting out</font>

843
00:30:34,470 --> 00:30:39,450
a text<font color="#E5E5E5"> file to</font><font color="#CCCCCC"> the local machine</font><font color="#E5E5E5"> because</font>

844
00:30:38,100 --> 00:30:42,959
the<font color="#CCCCCC"> Cline lines is quite interesting</font>

845
00:30:39,450 --> 00:30:44,220
<font color="#E5E5E5">because we saw it when it was on a few</font>

846
00:30:42,960 --> 00:30:46,289
<font color="#E5E5E5">hosts and then</font><font color="#CCCCCC"> as we</font><font color="#E5E5E5"> investigating</font>

847
00:30:44,220 --> 00:30:47,880
actually<font color="#E5E5E5"> in Devon</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> host and we</font>

848
00:30:46,289 --> 00:30:50,070
traced<font color="#E5E5E5"> this back to the</font><font color="#CCCCCC"> timestamp</font>

849
00:30:47,880 --> 00:30:53,190
analysis and<font color="#E5E5E5"> found that</font><font color="#CCCCCC"> it started</font><font color="#E5E5E5"> on</font>

850
00:30:50,070 --> 00:30:56,039
one host<font color="#E5E5E5"> and it turns out</font><font color="#CCCCCC"> that this one</font>

851
00:30:53,190 --> 00:30:58,070
host was the insider<font color="#E5E5E5"> who'd foolish to</font>

852
00:30:56,039 --> 00:31:00,780
run the payload on his own machine first

853
00:30:58,070 --> 00:31:03,000
so<font color="#E5E5E5"> this is yeah lot</font>

854
00:31:00,780 --> 00:31:04,620
a difficult investigation right and

855
00:31:03,000 --> 00:31:06,150
looking<font color="#E5E5E5"> at his box more we found out</font>

856
00:31:04,620 --> 00:31:08,070
<font color="#CCCCCC">Hughes actually just to be in this room</font>

857
00:31:06,150 --> 00:31:09,360
through<font color="#CCCCCC"> Advanced</font><font color="#E5E5E5"> eyepiece now just tool</font>

858
00:31:08,070 --> 00:31:11,790
that I would<font color="#CCCCCC"> connect to multiple</font>

859
00:31:09,360 --> 00:31:13,229
machines<font color="#E5E5E5"> and we can see</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> network data</font>

860
00:31:11,790 --> 00:31:17,430
the user session there that tallied all

861
00:31:13,230 --> 00:31:20,100
<font color="#E5E5E5">this up you may wonder you know what's</font>

862
00:31:17,430 --> 00:31:21,180
the significance of<font color="#E5E5E5"> this attack well</font>

863
00:31:20,100 --> 00:31:23,070
this guy<font color="#CCCCCC"> was</font><font color="#E5E5E5"> actually trying to escalate</font>

864
00:31:21,180 --> 00:31:25,260
privileges to target an ATM network and

865
00:31:23,070 --> 00:31:27,120
try<font color="#CCCCCC"> to</font><font color="#E5E5E5"> steal money</font><font color="#CCCCCC"> we jumped in there</font>

866
00:31:25,260 --> 00:31:27,960
<font color="#CCCCCC">before he was able to</font><font color="#E5E5E5"> do any damage such</font>

867
00:31:27,120 --> 00:31:33,870
as a big win for us

868
00:31:27,960 --> 00:31:37,170
big win<font color="#CCCCCC"> for the client Imhotep is</font>

869
00:31:33,870 --> 00:31:39,540
<font color="#CCCCCC">astraying a commodity malware you know</font>

870
00:31:37,170 --> 00:31:40,980
and you<font color="#E5E5E5"> actually came out</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> early</font>

871
00:31:39,540 --> 00:31:43,350
this year<font color="#E5E5E5"> there's a whole sort campaign</font>

872
00:31:40,980 --> 00:31:44,880
<font color="#E5E5E5">like email distribution company and this</font>

873
00:31:43,350 --> 00:31:47,490
<font color="#CCCCCC">is when we</font><font color="#E5E5E5"> picked up and saw</font><font color="#CCCCCC"> it being</font>

874
00:31:44,880 --> 00:31:50,840
<font color="#E5E5E5">used in the world and</font><font color="#CCCCCC"> actually use the</font>

875
00:31:47,490 --> 00:31:53,250
<font color="#E5E5E5">macro with this with this payload here</font>

876
00:31:50,840 --> 00:31:54,840
picking apart this payload<font color="#E5E5E5"> you can see</font>

877
00:31:53,250 --> 00:31:57,330
some<font color="#E5E5E5"> pretty obvious things and</font><font color="#CCCCCC"> in terms</font>

878
00:31:54,840 --> 00:31:58,409
<font color="#E5E5E5">of affection hidden window you think</font>

879
00:31:57,330 --> 00:31:59,189
would be<font color="#E5E5E5"> very suspicious but it's</font>

880
00:31:58,410 --> 00:32:00,690
actually<font color="#CCCCCC"> really common</font>

881
00:31:59,190 --> 00:32:02,580
<font color="#E5E5E5">admins use it all the time it's actually</font>

882
00:32:00,690 --> 00:32:04,830
<font color="#E5E5E5">reaching a</font><font color="#CCCCCC"> three out of</font><font color="#E5E5E5"> 10 so this is</font>

883
00:32:02,580 --> 00:32:07,320
<font color="#E5E5E5">kind of based on how severe or important</font>

884
00:32:04,830 --> 00:32:08,250
I think is<font color="#E5E5E5"> website download this is</font>

885
00:32:07,320 --> 00:32:09,780
something that's<font color="#E5E5E5"> really</font><font color="#CCCCCC"> anomalous</font>

886
00:32:08,250 --> 00:32:12,480
<font color="#E5E5E5">staffing to me you should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> covering if</font>

887
00:32:09,780 --> 00:32:14,670
you're looking at<font color="#E5E5E5"> partial logs URLs as</font>

888
00:32:12,480 --> 00:32:16,980
well start process actually<font color="#E5E5E5"> sort of in</font>

889
00:32:14,670 --> 00:32:19,440
general<font color="#CCCCCC"> from</font><font color="#E5E5E5"> windward if you've seen</font>

890
00:32:16,980 --> 00:32:20,550
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> comms</font><font color="#CCCCCC"> and you see file rise to</font>

891
00:32:19,440 --> 00:32:22,230
specific<font color="#CCCCCC"> locations they'd be quite</font>

892
00:32:20,550 --> 00:32:23,790
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> or see this sample</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> it</font>

893
00:32:22,230 --> 00:32:25,500
just<font color="#CCCCCC"> basically</font><font color="#E5E5E5"> went out to</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> sites</font>

894
00:32:23,790 --> 00:32:29,010
downloaded binary<font color="#E5E5E5"> dumped on the local</font>

895
00:32:25,500 --> 00:32:31,500
machine<font color="#E5E5E5"> for starting it this is way too</font>

896
00:32:29,010 --> 00:32:35,220
easy right<font color="#E5E5E5"> you're thinking hey show me a</font>

897
00:32:31,500 --> 00:32:35,730
show me a real example so for those

898
00:32:35,220 --> 00:32:38,690
who've seen it

899
00:32:35,730 --> 00:32:41,250
<font color="#E5E5E5">Sandra Bohannon he's got an actual for</font>

900
00:32:38,690 --> 00:32:42,690
<font color="#CCCCCC">project song on github</font><font color="#E5E5E5"> called invoke</font>

901
00:32:41,250 --> 00:32:44,690
obfuscation<font color="#E5E5E5"> and this is all about</font>

902
00:32:42,690 --> 00:32:46,980
<font color="#CCCCCC">PowerShell obfuscation</font><font color="#E5E5E5"> and you can turn</font>

903
00:32:44,690 --> 00:32:50,610
reasonably easy to<font color="#E5E5E5"> read stuff like this</font>

904
00:32:46,980 --> 00:32:53,520
<font color="#E5E5E5">into horrible stuff</font><font color="#CCCCCC"> others again you can</font>

905
00:32:50,610 --> 00:32:54,179
do analysis<font color="#E5E5E5"> of this and</font><font color="#CCCCCC"> actually spot</font>

906
00:32:53,520 --> 00:32:56,850
this quite<font color="#E5E5E5"> easily</font>

907
00:32:54,180 --> 00:32:58,950
a few quick points<font color="#CCCCCC"> ix to</font><font color="#E5E5E5"> the top corner</font>

908
00:32:56,850 --> 00:33:00,629
<font color="#E5E5E5">here</font><font color="#CCCCCC"> spray indicator to look for it's</font>

909
00:32:58,950 --> 00:33:02,970
<font color="#CCCCCC">highly recommended and the bottom part</font>

910
00:33:00,630 --> 00:33:05,760
<font color="#E5E5E5">here as decoder</font><font color="#CCCCCC"> stuff these are static</font>

911
00:33:02,970 --> 00:33:07,470
<font color="#E5E5E5">and used in this framework</font><font color="#CCCCCC"> they change</font>

912
00:33:05,760 --> 00:33:08,910
<font color="#E5E5E5">slightly</font><font color="#CCCCCC"> you can just sync it to</font><font color="#E5E5E5"> this</font>

913
00:33:07,470 --> 00:33:10,500
and<font color="#E5E5E5"> in terms of this middle section</font>

914
00:33:08,910 --> 00:33:11,929
<font color="#CCCCCC">obviously this is</font><font color="#E5E5E5"> extremely anomalous</font>

915
00:33:10,500 --> 00:33:15,139
<font color="#CCCCCC">you've got all kinds of weird</font>

916
00:33:11,929 --> 00:33:16,850
numbers<font color="#E5E5E5"> there's no spaces</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> do</font>

917
00:33:15,139 --> 00:33:18,949
<font color="#E5E5E5">kind of</font><font color="#CCCCCC"> ratio analysis to separate this</font>

918
00:33:16,850 --> 00:33:20,269
from<font color="#E5E5E5"> more</font><font color="#CCCCCC"> legitimates or powershell and</font>

919
00:33:18,950 --> 00:33:22,460
also<font color="#E5E5E5"> length</font><font color="#CCCCCC"> is the other big</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> and</font>

920
00:33:20,269 --> 00:33:24,590
<font color="#E5E5E5">anything that gets obfuscated grows</font>

921
00:33:22,460 --> 00:33:30,200
massively in length<font color="#E5E5E5"> so</font><font color="#CCCCCC"> something you can</font>

922
00:33:24,590 --> 00:33:32,480
actually<font color="#E5E5E5"> use to detect it</font><font color="#CCCCCC"> so a</font><font color="#E5E5E5"> lot of</font>

923
00:33:30,200 --> 00:33:34,789
<font color="#E5E5E5">stuff I've talked about today</font><font color="#CCCCCC"> has been</font>

924
00:33:32,480 --> 00:33:36,710
<font color="#CCCCCC">very sore answer</font><font color="#E5E5E5"> and defense focus and</font>

925
00:33:34,789 --> 00:33:38,749
three offensive guys the<font color="#CCCCCC"> audience you</font>

926
00:33:36,710 --> 00:33:41,629
may be wondering<font color="#CCCCCC"> how do i how do i do</font>

927
00:33:38,749 --> 00:33:43,340
defense better<font color="#E5E5E5"> so I put down a few ideas</font>

928
00:33:41,629 --> 00:33:44,529
<font color="#E5E5E5">I'm just going to quickly run</font><font color="#CCCCCC"> through</font>

929
00:33:43,340 --> 00:33:47,418
this<font color="#E5E5E5"> um</font>

930
00:33:44,529 --> 00:33:49,279
macros<font color="#E5E5E5"> and HTA's those the primary ways</font>

931
00:33:47,419 --> 00:33:51,470
right now of delivering payloads<font color="#CCCCCC"> don't</font>

932
00:33:49,279 --> 00:33:53,720
use them it's my advice<font color="#E5E5E5"> um be more</font>

933
00:33:51,470 --> 00:33:56,960
creative<font color="#E5E5E5"> folks on social engineering</font>

934
00:33:53,720 --> 00:34:00,019
<font color="#E5E5E5">abuse their value services target users</font>

935
00:33:56,960 --> 00:34:02,210
directly or try to<font color="#E5E5E5"> use avenues that</font>

936
00:34:00,019 --> 00:34:07,190
won't create<font color="#CCCCCC"> state endpoint data or</font>

937
00:34:02,210 --> 00:34:08,480
easily<font color="#E5E5E5"> trackable data you know if you go</font>

938
00:34:07,190 --> 00:34:09,889
<font color="#CCCCCC">to a third</font><font color="#E5E5E5"> party service there's no way</font>

939
00:34:08,480 --> 00:34:11,659
as a<font color="#E5E5E5"> founding team we're going to have</font>

940
00:34:09,889 --> 00:34:15,200
those logs there's no way we can trace

941
00:34:11,659 --> 00:34:17,119
that<font color="#E5E5E5"> and also targeting personal assets</font>

942
00:34:15,199 --> 00:34:18,259
<font color="#E5E5E5">it's a gray area this one but I'm</font><font color="#CCCCCC"> just</font>

943
00:34:17,119 --> 00:34:18,679
telling<font color="#E5E5E5"> you as it is right that's the</font>

944
00:34:18,260 --> 00:34:20,030
reality

945
00:34:18,679 --> 00:34:21,409
a real will attack of will target

946
00:34:20,030 --> 00:34:22,819
personal assets<font color="#E5E5E5"> they'll tell you the</font>

947
00:34:21,409 --> 00:34:24,799
users directly<font color="#E5E5E5"> they won't care its</font>

948
00:34:22,819 --> 00:34:27,609
<font color="#CCCCCC">corporate or not they won't creds they</font>

949
00:34:24,799 --> 00:34:30,139
want<font color="#CCCCCC"> access so yeah we're</font><font color="#E5E5E5"> thinking about</font>

950
00:34:27,609 --> 00:34:31,520
<font color="#CCCCCC">Sue's execution avoiding all those</font>

951
00:34:30,139 --> 00:34:33,260
things<font color="#CCCCCC"> that I've talked about CMD</font>

952
00:34:31,520 --> 00:34:36,168
<font color="#E5E5E5">PowerShell all those standard utilities</font>

953
00:34:33,260 --> 00:34:38,149
<font color="#E5E5E5">we look for them they are really playing</font>

954
00:34:36,168 --> 00:34:40,699
the obvious in<font color="#E5E5E5"> terms of the</font>

955
00:34:38,149 --> 00:34:43,399
maliciousness<font color="#E5E5E5"> just don't use them if you</font>

956
00:34:40,699 --> 00:34:45,230
can<font color="#E5E5E5"> often dropping binaries it could be</font>

957
00:34:43,399 --> 00:34:48,558
a<font color="#E5E5E5"> better</font><font color="#CCCCCC"> option here as</font><font color="#E5E5E5"> long as you can</font>

958
00:34:45,230 --> 00:34:50,740
bypass a<font color="#E5E5E5"> B and also things like double</font>

959
00:34:48,559 --> 00:34:53,329
<font color="#E5E5E5">your mind again that</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> be detected</font><font color="#CCCCCC"> too</font>

960
00:34:50,739 --> 00:34:56,500
but it's just a bit harder<font color="#CCCCCC"> or often has</font>

961
00:34:53,329 --> 00:34:58,490
less coverage and security<font color="#E5E5E5"> teams um</font>

962
00:34:56,500 --> 00:35:00,290
<font color="#CCCCCC">windows api is a really interesting one</font>

963
00:34:58,490 --> 00:35:02,899
as well and if you look at the data

964
00:35:00,290 --> 00:35:04,759
stack from sort<font color="#E5E5E5"> of top to bottom</font><font color="#CCCCCC"> you</font>

965
00:35:02,900 --> 00:35:06,230
<font color="#CCCCCC">know you've got application level stuff</font>

966
00:35:04,760 --> 00:35:08,720
at the top in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> middle of you kind of</font>

967
00:35:06,230 --> 00:35:10,430
go<font color="#E5E5E5"> process sort of stuff and</font><font color="#CCCCCC"> then at the</font>

968
00:35:08,720 --> 00:35:12,410
bottom you can<font color="#E5E5E5"> I've got direct</font><font color="#CCCCCC"> windows</font>

969
00:35:10,430 --> 00:35:14,328
<font color="#CCCCCC">API stuff</font><font color="#E5E5E5"> and if you look at how these</font>

970
00:35:12,410 --> 00:35:17,240
<font color="#CCCCCC">data sets or stack up Gabe</font><font color="#E5E5E5"> cloud stuff</font>

971
00:35:14,329 --> 00:35:19,240
is huge<font color="#CCCCCC"> you get so much data if you</font>

972
00:35:17,240 --> 00:35:21,540
start monitoring<font color="#E5E5E5"> the windows</font><font color="#CCCCCC"> API right</font>

973
00:35:19,240 --> 00:35:24,060
<font color="#E5E5E5">so it makes it just not</font>

974
00:35:21,540 --> 00:35:26,009
<font color="#E5E5E5">to use that data often whereas opposes</font>

975
00:35:24,060 --> 00:35:28,740
<font color="#CCCCCC">theirs is pretty manageable so</font><font color="#E5E5E5"> as an</font>

976
00:35:26,010 --> 00:35:31,200
attacker<font color="#E5E5E5"> if you can compile a binary and</font>

977
00:35:28,740 --> 00:35:34,430
use that to access<font color="#CCCCCC"> the windows API</font><font color="#E5E5E5"> and</font>

978
00:35:31,200 --> 00:35:37,169
for<font color="#E5E5E5"> example to do net enumeration</font>

979
00:35:34,430 --> 00:35:39,330
instead of using net<font color="#CCCCCC"> yangtze where</font>

980
00:35:37,170 --> 00:35:41,520
you're<font color="#E5E5E5"> going to bypass any windows</font>

981
00:35:39,330 --> 00:35:43,560
<font color="#CCCCCC">utility is like rules</font><font color="#E5E5E5"> just by calling</font>

982
00:35:41,520 --> 00:35:44,970
the<font color="#CCCCCC"> API</font><font color="#E5E5E5"> direct and this applies</font><font color="#CCCCCC"> in a few</font>

983
00:35:43,560 --> 00:35:47,700
<font color="#CCCCCC">different</font><font color="#E5E5E5"> areas it's something that I</font>

984
00:35:44,970 --> 00:35:49,080
<font color="#E5E5E5">probably is a bit under researched but</font>

985
00:35:47,700 --> 00:35:51,750
<font color="#E5E5E5">yeah it's</font><font color="#CCCCCC"> something that I suggest</font>

986
00:35:49,080 --> 00:35:53,580
<font color="#E5E5E5">focused on because the</font><font color="#CCCCCC"> participants</font>

987
00:35:51,750 --> 00:35:55,080
don't<font color="#E5E5E5"> use the common locations we all</font>

988
00:35:53,580 --> 00:35:56,549
know about<font color="#E5E5E5"> them we know run keys are</font>

989
00:35:55,080 --> 00:35:58,620
<font color="#E5E5E5">used we know service and shadows</font><font color="#CCCCCC"> ask</font>

990
00:35:56,550 --> 00:36:00,930
<font color="#E5E5E5">please don't use them be more creative</font>

991
00:35:58,620 --> 00:36:02,520
<font color="#CCCCCC">and</font><font color="#E5E5E5"> double your mind calm again better</font>

992
00:36:00,930 --> 00:36:05,850
options here<font color="#E5E5E5"> often</font><font color="#CCCCCC"> people that monitor</font>

993
00:36:02,520 --> 00:36:07,830
them office templates<font color="#E5E5E5"> outlet rules this</font>

994
00:36:05,850 --> 00:36:09,960
<font color="#E5E5E5">is the more kind of on</font><font color="#CCCCCC"> Vogons the latest</font>

995
00:36:07,830 --> 00:36:11,370
cool thing pen testers use again

996
00:36:09,960 --> 00:36:11,970
coverage will come for that in the next

997
00:36:11,370 --> 00:36:14,040
<font color="#CCCCCC">few months</font>

998
00:36:11,970 --> 00:36:16,250
right now though it's<font color="#E5E5E5"> I'll argue not</font>

999
00:36:14,040 --> 00:36:18,870
very well covered<font color="#E5E5E5"> by</font><font color="#CCCCCC"> more security</font><font color="#E5E5E5"> teams</font>

1000
00:36:16,250 --> 00:36:20,850
develop a<font color="#CCCCCC"> DLL file loading is something</font>

1001
00:36:18,870 --> 00:36:22,259
that's taken off<font color="#CCCCCC"> quite a lot a lot</font><font color="#E5E5E5"> of</font>

1002
00:36:20,850 --> 00:36:24,060
apt groups of started using small

1003
00:36:22,260 --> 00:36:26,580
<font color="#E5E5E5">nation-state tractors</font>

1004
00:36:24,060 --> 00:36:28,620
so our to detect<font color="#E5E5E5"> there's not a single</font>

1005
00:36:26,580 --> 00:36:31,920
<font color="#E5E5E5">location you can query and say show me</font>

1006
00:36:28,620 --> 00:36:33,420
<font color="#CCCCCC">all things</font><font color="#E5E5E5"> DLL loaded you instead have</font>

1007
00:36:31,920 --> 00:36:34,980
<font color="#E5E5E5">to enumerate all the processes and the</font>

1008
00:36:33,420 --> 00:36:37,140
dealers<font color="#E5E5E5"> that they have loaded</font><font color="#CCCCCC"> then to</font>

1009
00:36:34,980 --> 00:36:39,870
release frequency analysis and that's a

1010
00:36:37,140 --> 00:36:43,670
bit more long-winded in general if you

1011
00:36:39,870 --> 00:36:43,670
don't need<font color="#E5E5E5"> to use don't don't use it so</font>

1012
00:36:43,790 --> 00:36:47,670
<font color="#CCCCCC">in terms</font><font color="#E5E5E5"> of Excel there's a few things</font>

1013
00:36:46,410 --> 00:36:49,259
here<font color="#CCCCCC"> I</font><font color="#E5E5E5"> touched on it earlier and you can</font>

1014
00:36:47,670 --> 00:36:51,570
legitimate<font color="#CCCCCC"> service as much as possible</font>

1015
00:36:49,260 --> 00:36:53,940
I'm Google Facebook Twitter you name it

1016
00:36:51,570 --> 00:36:55,500
this came up earlier<font color="#E5E5E5"> you know Taylor the</font>

1017
00:36:53,940 --> 00:36:57,240
Russian<font color="#E5E5E5"> apt group they were using</font><font color="#CCCCCC"> rows</font>

1018
00:36:55,500 --> 00:36:58,980
<font color="#CCCCCC">of Britney</font><font color="#E5E5E5"> Spears is</font><font color="#CCCCCC"> Instagram</font><font color="#E5E5E5"> you know</font>

1019
00:36:57,240 --> 00:37:01,049
if that<font color="#E5E5E5"> kind of stuff that's extremely</font>

1020
00:36:58,980 --> 00:37:03,390
hard<font color="#E5E5E5"> for us to detect we don't have the</font>

1021
00:37:01,050 --> 00:37:05,790
log from those services<font color="#CCCCCC"> and often that</font>

1022
00:37:03,390 --> 00:37:07,379
tracker will be encrypted<font color="#CCCCCC"> it can be</font>

1023
00:37:05,790 --> 00:37:09,900
quite difficult to detect<font color="#E5E5E5"> that</font><font color="#CCCCCC"> kind of</font>

1024
00:37:07,380 --> 00:37:11,850
stuff yeah as<font color="#E5E5E5"> tunneling isn't obtaining</font>

1025
00:37:09,900 --> 00:37:14,070
the<font color="#E5E5E5"> defenders</font><font color="#CCCCCC"> of love and they think is</font>

1026
00:37:11,850 --> 00:37:15,660
really<font color="#CCCCCC"> cool again if you've got</font><font color="#E5E5E5"> the</font>

1027
00:37:14,070 --> 00:37:18,570
network<font color="#E5E5E5"> traffic is really easy to detect</font>

1028
00:37:15,660 --> 00:37:20,069
<font color="#E5E5E5">I'd say avoid it if possible but again</font>

1029
00:37:18,570 --> 00:37:21,960
it assumes that the<font color="#E5E5E5"> defenders have that</font>

1030
00:37:20,070 --> 00:37:24,920
data<font color="#E5E5E5"> they don't you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> maybe you can</font>

1031
00:37:21,960 --> 00:37:27,360
use that<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> think going low and slow</font>

1032
00:37:24,920 --> 00:37:29,310
<font color="#E5E5E5">the age-old thing the particular time as</font>

1033
00:37:27,360 --> 00:37:31,110
a pen tester<font color="#E5E5E5"> don't be noisy don't create</font>

1034
00:37:29,310 --> 00:37:33,560
spikes on graphs<font color="#CCCCCC"> you're probably going</font>

1035
00:37:31,110 --> 00:37:33,560
to<font color="#E5E5E5"> speak fine</font>

1036
00:37:35,810 --> 00:37:38,810
Sakura to actually do<font color="#E5E5E5"> detection</font>

1037
00:37:37,880 --> 00:37:39,770
<font color="#E5E5E5">yourselves obviously a lot of us that</font>

1038
00:37:38,810 --> 00:37:42,290
<font color="#E5E5E5">I've talked about today is kind of</font>

1039
00:37:39,770 --> 00:37:43,849
<font color="#E5E5E5">enterprise level as an endpoint painful</font>

1040
00:37:42,290 --> 00:37:45,140
products and stuff<font color="#CCCCCC"> you may be</font><font color="#E5E5E5"> wondering</font>

1041
00:37:43,849 --> 00:37:46,760
how do you<font color="#CCCCCC"> actually do</font><font color="#E5E5E5"> this if you want</font>

1042
00:37:45,140 --> 00:37:48,680
<font color="#E5E5E5">to go home and tonight and then play</font>

1043
00:37:46,760 --> 00:37:50,420
<font color="#CCCCCC">with this stuff there's some open source</font>

1044
00:37:48,680 --> 00:37:51,290
<font color="#E5E5E5">stuff and that's free to use os query</font>

1045
00:37:50,420 --> 00:37:53,750
<font color="#E5E5E5">grr</font>

1046
00:37:51,290 --> 00:37:56,000
because this month<font color="#CCCCCC"> we really love these</font>

1047
00:37:53,750 --> 00:37:57,920
technologies<font color="#E5E5E5"> anyone can use them free to</font>

1048
00:37:56,000 --> 00:37:59,930
the point and<font color="#CCCCCC"> you could</font><font color="#E5E5E5"> just talk</font><font color="#CCCCCC"> about</font>

1049
00:37:57,920 --> 00:38:01,819
<font color="#E5E5E5">they turn to elastic again it's a very</font>

1050
00:37:59,930 --> 00:38:04,819
<font color="#E5E5E5">scalable technology it's efficient easy</font>

1051
00:38:01,819 --> 00:38:07,160
to use and free and there's a number<font color="#E5E5E5"> of</font>

1052
00:38:04,819 --> 00:38:09,470
<font color="#CCCCCC">different frameworks you can use so exci</font>

1053
00:38:07,160 --> 00:38:12,799
<font color="#CCCCCC">produce for</font><font color="#E5E5E5"> one there's a last bullet</font>

1054
00:38:09,470 --> 00:38:15,319
which I think was<font color="#E5E5E5"> Yelp</font><font color="#CCCCCC"> parsec</font><font color="#E5E5E5"> the SLS</font><font color="#CCCCCC"> is</font>

1055
00:38:12,800 --> 00:38:17,420
out of<font color="#E5E5E5"> the box</font><font color="#CCCCCC"> point by elastic and</font>

1056
00:38:15,319 --> 00:38:18,829
there's a<font color="#E5E5E5"> lot of options</font><font color="#CCCCCC"> here and</font><font color="#E5E5E5"> last</font>

1057
00:38:17,420 --> 00:38:20,660
<font color="#E5E5E5">the infrastructure</font><font color="#CCCCCC"> you'll notice there</font>

1058
00:38:18,829 --> 00:38:24,380
I've not talked<font color="#CCCCCC"> about</font><font color="#E5E5E5"> infrastructure at</font>

1059
00:38:20,660 --> 00:38:26,210
all<font color="#E5E5E5"> underpinning this whole threatening</font>

1060
00:38:24,380 --> 00:38:27,680
operational thing is a massive

1061
00:38:26,210 --> 00:38:29,480
infrastructure team with hundreds<font color="#E5E5E5"> of</font>

1062
00:38:27,680 --> 00:38:31,660
servers<font color="#E5E5E5"> and stuff</font><font color="#CCCCCC"> that's a whole other</font>

1063
00:38:29,480 --> 00:38:33,890
like<font color="#CCCCCC"> talkative conference to be honest</font>

1064
00:38:31,660 --> 00:38:36,740
but again thinking about scalability

1065
00:38:33,890 --> 00:38:37,790
puppet chef and support docker<font color="#E5E5E5"> these are</font>

1066
00:38:36,740 --> 00:38:44,240
the kinds of technologies want to be

1067
00:38:37,790 --> 00:38:45,619
thinking<font color="#CCCCCC"> about so I think over the</font><font color="#E5E5E5"> last</font>

1068
00:38:44,240 --> 00:38:47,990
few<font color="#CCCCCC"> years you</font><font color="#E5E5E5"> know we've seen</font><font color="#CCCCCC"> a bit</font><font color="#E5E5E5"> of a</font>

1069
00:38:45,619 --> 00:38:50,420
shift from<font color="#CCCCCC"> attackers having almost like</font>

1070
00:38:47,990 --> 00:38:51,618
free<font color="#E5E5E5"> rein over networks to be able to do</font>

1071
00:38:50,420 --> 00:38:54,730
what they want

1072
00:38:51,619 --> 00:38:56,810
compared to malware<font color="#E5E5E5"> with the proper</font>

1073
00:38:54,730 --> 00:38:58,579
detection of<font color="#E5E5E5"> of a prevention in place</font>

1074
00:38:56,810 --> 00:39:00,799
and it<font color="#CCCCCC"> can be quite hard to compromise</font>

1075
00:38:58,579 --> 00:39:02,869
<font color="#E5E5E5">an organization and but the only way I</font>

1076
00:39:00,800 --> 00:39:04,790
<font color="#E5E5E5">think defensive teams can continue to be</font>

1077
00:39:02,869 --> 00:39:06,560
successful<font color="#CCCCCC"> is working closely with the</font>

1078
00:39:04,790 --> 00:39:08,720
<font color="#E5E5E5">Red</font><font color="#CCCCCC"> Team</font><font color="#E5E5E5"> you're doing this kind of</font>

1079
00:39:06,560 --> 00:39:09,529
purple team<font color="#E5E5E5"> and thing where you will</font>

1080
00:39:08,720 --> 00:39:12,500
learn<font color="#E5E5E5"> from</font><font color="#CCCCCC"> each other</font>

1081
00:39:09,530 --> 00:39:13,790
you know I<font color="#E5E5E5"> learn how to bypass pen</font>

1082
00:39:12,500 --> 00:39:16,359
testers pen testers learn how to bypass

1083
00:39:13,790 --> 00:39:18,920
me right and it kind of helps everyone

1084
00:39:16,359 --> 00:39:22,009
<font color="#E5E5E5">and you know at least</font><font color="#CCCCCC"> thinks or</font><font color="#E5E5E5"> concepts</font>

1085
00:39:18,920 --> 00:39:24,410
<font color="#CCCCCC">you know a lot of us came from a sort of</font>

1086
00:39:22,010 --> 00:39:27,230
<font color="#E5E5E5">pen testing backgrounds right me myself</font>

1087
00:39:24,410 --> 00:39:29,089
as a pen tester<font color="#CCCCCC"> and you know I saw the</font>

1088
00:39:27,230 --> 00:39:32,000
state<font color="#E5E5E5"> of the defense industry</font><font color="#CCCCCC"> and I'll</font>

1089
00:39:29,089 --> 00:39:33,828
aim<font color="#CCCCCC"> for</font><font color="#E5E5E5"> fund this is awful man we've got</font>

1090
00:39:32,000 --> 00:39:35,900
<font color="#E5E5E5">to</font><font color="#CCCCCC"> do bad here</font><font color="#E5E5E5"> and I ended up moving</font>

1091
00:39:33,829 --> 00:39:38,599
across and now I'm in concept<font color="#CCCCCC"> doing</font>

1092
00:39:35,900 --> 00:39:41,119
<font color="#E5E5E5">traveling because it's funny you know</font>

1093
00:39:38,599 --> 00:39:42,410
<font color="#CCCCCC">you I</font><font color="#E5E5E5"> went to</font><font color="#CCCCCC"> InfoSec yesterday and you</font>

1094
00:39:41,119 --> 00:39:44,630
look all the vendors

1095
00:39:42,410 --> 00:39:47,930
and you look at these products and<font color="#CCCCCC"> you</font>

1096
00:39:44,630 --> 00:39:49,910
think<font color="#CCCCCC"> is</font><font color="#E5E5E5"> a lot of snake oil like so</font>

1097
00:39:47,930 --> 00:39:53,419
<font color="#E5E5E5">these products really work you know I</font>

1098
00:39:49,910 --> 00:39:55,220
don't know maybe<font color="#E5E5E5"> they</font><font color="#CCCCCC"> maybe some do but</font>

1099
00:39:53,420 --> 00:39:57,890
like a<font color="#CCCCCC"> cat except I guess</font><font color="#E5E5E5"> you know we</font>

1100
00:39:55,220 --> 00:39:59,240
wanted<font color="#E5E5E5"> to</font><font color="#CCCCCC"> improve the</font><font color="#E5E5E5"> situation</font><font color="#CCCCCC"> we knew</font>

1101
00:39:57,890 --> 00:40:00,890
<font color="#CCCCCC">that with the right data the right</font>

1102
00:39:59,240 --> 00:40:02,750
knowledge of attackers<font color="#E5E5E5"> we can improve</font>

1103
00:40:00,890 --> 00:40:04,038
<font color="#E5E5E5">this entire industry</font><font color="#CCCCCC"> and you saw you</font>

1104
00:40:02,750 --> 00:40:05,390
know<font color="#CCCCCC"> the stuff today you know I'm just</font>

1105
00:40:04,039 --> 00:40:07,010
<font color="#E5E5E5">sharing what what we're doing you know</font>

1106
00:40:05,390 --> 00:40:10,098
you don't have to pay this it's all

1107
00:40:07,010 --> 00:40:12,200
there<font color="#CCCCCC"> it's all free</font><font color="#E5E5E5"> and it's funny</font>

1108
00:40:10,099 --> 00:40:14,119
<font color="#CCCCCC">because I think if you look at the</font>

1109
00:40:12,200 --> 00:40:16,009
<font color="#E5E5E5">defensive industries right now it's</font>

1110
00:40:14,119 --> 00:40:18,950
<font color="#E5E5E5">pretty</font><font color="#CCCCCC"> much like what pentesting was</font>

1111
00:40:16,010 --> 00:40:21,079
like back<font color="#E5E5E5"> in like 2005 or whatever you</font>

1112
00:40:18,950 --> 00:40:23,779
know we're just<font color="#E5E5E5"> starting out</font><font color="#CCCCCC"> we've</font><font color="#E5E5E5"> just</font>

1113
00:40:21,079 --> 00:40:25,099
got nmap or whatever<font color="#E5E5E5"> like we don't have</font>

1114
00:40:23,780 --> 00:40:27,319
all the<font color="#E5E5E5"> cool stuff yet we don't have</font>

1115
00:40:25,099 --> 00:40:30,760
powers<font color="#E5E5E5"> quite we're still at the basic</font>

1116
00:40:27,319 --> 00:40:30,759
level will still learn still improving

1117
00:40:31,150 --> 00:40:35,359
so I'd say you know if if anyone in the

1118
00:40:34,039 --> 00:40:37,549
crowd you know is here you're looking

1119
00:40:35,359 --> 00:40:39,650
<font color="#E5E5E5">for a challenge</font><font color="#CCCCCC"> you're looking to define</font>

1120
00:40:37,549 --> 00:40:41,780
an industry and make the Metasploit<font color="#CCCCCC"> I</font>

1121
00:40:39,650 --> 00:40:45,109
guess as a defensive world you know<font color="#CCCCCC"> now</font>

1122
00:40:41,780 --> 00:40:48,410
<font color="#CCCCCC">is</font><font color="#E5E5E5"> the time to join and now is the time</font>

1123
00:40:45,109 --> 00:40:49,430
self just make an impact here<font color="#CCCCCC"> see if</font>

1124
00:40:48,410 --> 00:40:51,770
<font color="#E5E5E5">your instance to learn more about</font>

1125
00:40:49,430 --> 00:40:54,500
parenting<font color="#CCCCCC"> feel</font><font color="#E5E5E5"> free to grab me off this</font>

1126
00:40:51,770 --> 00:40:58,000
talk or message me message<font color="#E5E5E5"> KF</font><font color="#CCCCCC"> oh yeah</font>

1127
00:40:54,500 --> 00:40:58,000
<font color="#E5E5E5">that's pretty much it for</font><font color="#CCCCCC"> me thanks for</font>

1128
00:41:00,110 --> 00:41:04,690
[Applause]

