1
00:00:01,540 --> 00:00:06,850
um hello everybody very glad<font color="#E5E5E5"> to be here</font>

2
00:00:04,990 --> 00:00:09,700
so on the talk today<font color="#E5E5E5"> is going to be</font>

3
00:00:06,850 --> 00:00:13,450
about a toolkit<font color="#E5E5E5"> I developed for Caesar</font>

4
00:00:09,700 --> 00:00:16,509
fat<font color="#E5E5E5"> axe everybody can hear I mean is it</font>

5
00:00:13,450 --> 00:00:21,460
<font color="#CCCCCC">ok yeah perfect so really glad to be</font>

6
00:00:16,509 --> 00:00:26,110
here<font color="#CCCCCC"> even</font><font color="#E5E5E5"> with the strikes made it that</font>

7
00:00:21,460 --> 00:00:29,259
was hard but did<font color="#CCCCCC"> it just just a quick</font>

8
00:00:26,110 --> 00:00:32,140
side what is this talk<font color="#E5E5E5"> about so we're</font>

9
00:00:29,259 --> 00:00:34,330
very glad for you to be here just a

10
00:00:32,140 --> 00:00:37,240
really quick quick quick recap about

11
00:00:34,330 --> 00:00:40,300
Caesar fat tax because I guess everybody

12
00:00:37,240 --> 00:00:42,610
already knows about it so yeah just one

13
00:00:40,300 --> 00:00:46,059
slide about this then i will present the

14
00:00:42,610 --> 00:00:48,970
tool what you can do with it and all the

15
00:00:46,060 --> 00:00:54,370
motivations etc why I wanted to<font color="#E5E5E5"> create</font>

16
00:00:48,970 --> 00:00:56,950
such such toolkit<font color="#CCCCCC"> ok here we</font><font color="#E5E5E5"> go then I'm</font>

17
00:00:54,370 --> 00:01:01,239
gonna do some demos hopefully it's going

18
00:00:56,950 --> 00:01:04,329
to work should be<font color="#CCCCCC"> ok and then I'm</font><font color="#E5E5E5"> going</font>

19
00:01:01,239 --> 00:01:06,990
to talk about<font color="#E5E5E5"> some issues in some web</font>

20
00:01:04,328 --> 00:01:12,839
web site i just found on the internet

21
00:01:06,990 --> 00:01:16,240
mitigations and the<font color="#E5E5E5"> little surprise whoo</font>

22
00:01:12,840 --> 00:01:18,760
so the slides are the labor here it's my

23
00:01:16,240 --> 00:01:21,339
personal blog at the same time<font color="#CCCCCC"> I just</font>

24
00:01:18,760 --> 00:01:24,100
<font color="#CCCCCC">did a tweet on Twitter so you can you</font>

25
00:01:21,340 --> 00:01:26,320
know share it with<font color="#CCCCCC"> your friends and you</font>

26
00:01:24,100 --> 00:01:28,210
can yea maybe then instead of drinking

27
00:01:26,320 --> 00:01:30,070
beer that we come here and maybe

28
00:01:28,210 --> 00:01:34,059
drinking p.m. the<font color="#E5E5E5"> same time just coming</font>

29
00:01:30,070 --> 00:01:36,720
at the talks could be nice so yeah just

30
00:01:34,060 --> 00:01:39,040
a quick presentation before starting I

31
00:01:36,720 --> 00:01:43,360
guess you<font color="#CCCCCC"> already noticed it i'm french</font>

32
00:01:39,040 --> 00:01:46,390
with my accent I'm steer student master

33
00:01:43,360 --> 00:01:48,970
in computer science I graduated I end of

34
00:01:46,390 --> 00:01:52,090
August passionate about security and

35
00:01:48,970 --> 00:01:56,130
especially web security and I may open

36
00:01:52,090 --> 00:01:59,259
<font color="#CCCCCC">to developer even have the get up hoodie</font>

37
00:01:56,130 --> 00:02:01,380
so here is<font color="#E5E5E5"> my</font><font color="#CCCCCC"> Twitter account well if</font>

38
00:01:59,259 --> 00:02:04,689
you want you can follow me<font color="#E5E5E5"> and have some</font>

39
00:02:01,380 --> 00:02:07,479
information let us news about my my

40
00:02:04,689 --> 00:02:09,939
projects and what I'm<font color="#E5E5E5"> doing and here is</font>

41
00:02:07,479 --> 00:02:11,560
my github you can find I don't know

42
00:02:09,939 --> 00:02:12,549
maybe some relevant projects I'm working

43
00:02:11,560 --> 00:02:14,710
on

44
00:02:12,550 --> 00:02:16,600
and if you want you<font color="#E5E5E5"> can even contribute</font>

45
00:02:14,710 --> 00:02:18,730
to it so basically the two key time

46
00:02:16,600 --> 00:02:21,010
developing if you if you think about

47
00:02:18,730 --> 00:02:24,250
good features and some things you'd like

48
00:02:21,010 --> 00:02:27,880
<font color="#E5E5E5">to to get in this geography free and we</font>

49
00:02:24,250 --> 00:02:33,010
can speak about it later and<font color="#E5E5E5"> well we can</font>

50
00:02:27,880 --> 00:02:36,160
see so let's start why<font color="#E5E5E5"> csr ft wide is</font>

51
00:02:33,010 --> 00:02:38,950
<font color="#E5E5E5">toolkit basically i wanted something</font>

52
00:02:36,160 --> 00:02:41,440
lightweight and only they<font color="#CCCCCC"> dedicated</font><font color="#E5E5E5"> to</font>

53
00:02:38,950 --> 00:02:43,119
see self attacks so<font color="#E5E5E5"> basically what i</font>

54
00:02:41,440 --> 00:02:44,890
wanted was something that you could

55
00:02:43,120 --> 00:02:46,930
share with<font color="#E5E5E5"> your friends you know basic</font>

56
00:02:44,890 --> 00:02:48,910
configuration file and then you could

57
00:02:46,930 --> 00:02:50,500
deploy it really easily and you<font color="#E5E5E5"> could</font>

58
00:02:48,910 --> 00:02:51,790
you know share it with your friends you

59
00:02:50,500 --> 00:02:54,100
can share<font color="#E5E5E5"> it if you want with your</font>

60
00:02:51,790 --> 00:02:56,470
clients customers and something that

61
00:02:54,100 --> 00:02:58,989
<font color="#E5E5E5">could demonstrate them the strength of</font>

62
00:02:56,470 --> 00:03:01,450
those vulnerabilities I wanted as well

63
00:02:58,990 --> 00:03:03,490
yeah something cross-platform open

64
00:03:01,450 --> 00:03:07,179
source so all the code<font color="#E5E5E5"> has been released</font>

65
00:03:03,490 --> 00:03:10,000
<font color="#E5E5E5">and their license gplv3 so we have feel</font>

66
00:03:07,180 --> 00:03:12,700
<font color="#E5E5E5">free to fork the code do everything</font><font color="#CCCCCC"> you</font>

67
00:03:10,000 --> 00:03:14,440
<font color="#CCCCCC">want yeah and as</font><font color="#E5E5E5"> I said if</font><font color="#CCCCCC"> you want to</font>

68
00:03:12,700 --> 00:03:17,560
contribute<font color="#E5E5E5"> to the project you can even</font>

69
00:03:14,440 --> 00:03:19,030
do some poor request and I would be

70
00:03:17,560 --> 00:03:21,820
really glad if you<font color="#E5E5E5"> if you could</font>

71
00:03:19,030 --> 00:03:24,430
contribute it and I guess the key

72
00:03:21,820 --> 00:03:28,720
feature is that you can nice to combine

73
00:03:24,430 --> 00:03:31,090
see surf attacks so the result was there

74
00:03:28,720 --> 00:03:33,280
was not to kick for this if we look on

75
00:03:31,090 --> 00:03:35,350
the internet<font color="#CCCCCC"> for example exploit DB on</font>

76
00:03:33,280 --> 00:03:38,140
you know when there is an advisory about

77
00:03:35,350 --> 00:03:40,840
see self attacks it's mostly<font color="#E5E5E5"> okay you</font>

78
00:03:38,140 --> 00:03:43,119
got this URL or you get this form<font color="#CCCCCC"> you</font>

79
00:03:40,840 --> 00:03:45,280
just send it over to the victim and it's

80
00:03:43,120 --> 00:03:49,450
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> change</font><font color="#E5E5E5"> his password</font><font color="#CCCCCC"> okay so</font>

81
00:03:45,280 --> 00:03:50,920
just some kind of single attack but with

82
00:03:49,450 --> 00:03:53,350
this<font color="#E5E5E5"> toolkit what you can do is manage</font>

83
00:03:50,920 --> 00:03:55,359
to combine to combine it you know and

84
00:03:53,350 --> 00:03:57,609
<font color="#CCCCCC">you don't have only this assumption that</font>

85
00:03:55,360 --> 00:03:59,560
the user has to be connected to the

86
00:03:57,610 --> 00:04:03,880
platform because otherwise is going to

87
00:03:59,560 --> 00:04:07,390
fail<font color="#E5E5E5"> so here with this well</font><font color="#CCCCCC"> I will</font>

88
00:04:03,880 --> 00:04:10,120
explain later but i will describe a

89
00:04:07,390 --> 00:04:12,359
scenario which is actually composed of

90
00:04:10,120 --> 00:04:14,950
different kind<font color="#E5E5E5"> of steps you will do and</font>

91
00:04:12,360 --> 00:04:16,540
<font color="#E5E5E5">even if the user is not you know</font>

92
00:04:14,950 --> 00:04:18,519
connected to the platform you will be

93
00:04:16,540 --> 00:04:21,280
able to<font color="#E5E5E5"> where is it's going to be just</font>

94
00:04:18,519 --> 00:04:23,560
<font color="#CCCCCC">below Elliot it's going</font><font color="#E5E5E5"> to be one of my</font>

95
00:04:21,279 --> 00:04:25,510
first demo and you will be able to<font color="#CCCCCC"> log</font>

96
00:04:23,560 --> 00:04:26,050
the user in send some malicious payload

97
00:04:25,510 --> 00:04:27,969
and

98
00:04:26,050 --> 00:04:32,800
knock him<font color="#E5E5E5"> out so basically it's going to</font>

99
00:04:27,970 --> 00:04:34,720
be like transparent attack so here is

100
00:04:32,800 --> 00:04:39,729
<font color="#E5E5E5">the slide I hope you get you can just</font>

101
00:04:34,720 --> 00:04:41,800
see it well hope so if we take<font color="#CCCCCC"> a basic</font>

102
00:04:39,729 --> 00:04:43,719
scenario the user is going<font color="#E5E5E5"> to send a</font>

103
00:04:41,800 --> 00:04:45,550
request to a legit website or you know

104
00:04:43,720 --> 00:04:47,770
doing some social engineering or

105
00:04:45,550 --> 00:04:49,720
something you would send you will send<font color="#E5E5E5"> a</font>

106
00:04:47,770 --> 00:04:51,039
link it will going<font color="#E5E5E5"> to click on</font><font color="#CCCCCC"> it there</font>

107
00:04:49,720 --> 00:04:54,280
will<font color="#CCCCCC"> be some malicious payload on the</font>

108
00:04:51,039 --> 00:04:57,940
website the payload sir will be will be

109
00:04:54,280 --> 00:05:01,299
sent to the victim<font color="#E5E5E5"> and then it's going</font>

110
00:04:57,940 --> 00:05:03,370
<font color="#E5E5E5">to send</font><font color="#CCCCCC"> an wanted request to a renewable</font>

111
00:05:01,300 --> 00:05:06,520
platform so basically<font color="#E5E5E5"> if we're if you</font>

112
00:05:03,370 --> 00:05:08,259
just take an exploit on exploit DB well

113
00:05:06,520 --> 00:05:11,469
you're going to have your crafted form

114
00:05:08,259 --> 00:05:14,169
you just put it in some HTML file ok on

115
00:05:11,469 --> 00:05:16,539
your<font color="#E5E5E5"> Apache anjing server or</font><font color="#CCCCCC"> something</font>

116
00:05:14,169 --> 00:05:18,340
and then you're gonna you know just give

117
00:05:16,539 --> 00:05:20,740
the links entering to the victim and

118
00:05:18,340 --> 00:05:24,580
hopefully is going to click on it and

119
00:05:20,740 --> 00:05:28,569
and browse the page so that's<font color="#E5E5E5"> the basic</font>

120
00:05:24,580 --> 00:05:30,490
SI sirve scenario and what about with

121
00:05:28,569 --> 00:05:32,889
the<font color="#E5E5E5"> toolkit so basically it's quite the</font>

122
00:05:30,490 --> 00:05:35,969
<font color="#E5E5E5">same and the principal the how it's</font>

123
00:05:32,889 --> 00:05:39,759
working it's similar to beef so I guess

124
00:05:35,969 --> 00:05:42,880
ends up everybody here knows beef yeah

125
00:05:39,759 --> 00:05:44,949
<font color="#E5E5E5">okay so well okay there is a</font>

126
00:05:42,880 --> 00:05:49,210
<font color="#CCCCCC">communication between them the victim</font>

127
00:05:44,949 --> 00:05:50,610
and in the infected server<font color="#E5E5E5"> okay and then</font>

128
00:05:49,210 --> 00:05:54,159
there will be<font color="#CCCCCC"> a communication between</font>

129
00:05:50,610 --> 00:05:57,400
i'm using JSON and asha codes that<font color="#CCCCCC"> you</font>

130
00:05:54,159 --> 00:05:59,020
can do so it's fully<font color="#E5E5E5"> JavaScript and you</font>

131
00:05:57,400 --> 00:06:00,969
can you know it's just going<font color="#E5E5E5"> to gather</font>

132
00:05:59,020 --> 00:06:03,310
the next exploit to execute and then

133
00:06:00,969 --> 00:06:04,930
insert it into the dawn of the user so

134
00:06:03,310 --> 00:06:06,789
basically if you if you want to fake

135
00:06:04,930 --> 00:06:09,969
some get<font color="#E5E5E5"> requests you going to insert it</font>

136
00:06:06,789 --> 00:06:12,490
<font color="#CCCCCC">in some image tag and then otherwise you</font>

137
00:06:09,969 --> 00:06:14,800
can use iframe you know to<font color="#E5E5E5"> send some</font>

138
00:06:12,490 --> 00:06:17,500
some post<font color="#E5E5E5"> request and the victim is</font>

139
00:06:14,800 --> 00:06:19,419
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to send and what a request to you</font>

140
00:06:17,500 --> 00:06:21,250
know a venerable platform but it can be

141
00:06:19,419 --> 00:06:25,419
several one depending on the scenario

142
00:06:21,250 --> 00:06:29,469
<font color="#E5E5E5">that you want to run okay so how is</font><font color="#CCCCCC"> it</font>

143
00:06:25,419 --> 00:06:31,389
made<font color="#CCCCCC"> it's HTTP server that they develop</font>

144
00:06:29,469 --> 00:06:33,250
using not yes so it was a technology<font color="#E5E5E5"> I</font>

145
00:06:31,389 --> 00:06:36,190
didn't know about you know but with all

146
00:06:33,250 --> 00:06:38,350
those buzzwords etc<font color="#E5E5E5"> everything is GS and</font>

147
00:06:36,190 --> 00:06:40,680
I wanted<font color="#CCCCCC"> to give you a joy</font>

148
00:06:38,350 --> 00:06:43,060
and that's really<font color="#E5E5E5"> nice</font><font color="#CCCCCC"> you know I mean</font>

149
00:06:40,680 --> 00:06:50,170
<font color="#E5E5E5">are there some people here familiar with</font>

150
00:06:43,060 --> 00:06:51,820
not yes yeah oh ok 23 hands<font color="#CCCCCC"> ok ok but</font>

151
00:06:50,170 --> 00:06:53,470
it's a technology where you can manage

152
00:06:51,820 --> 00:06:56,890
to<font color="#CCCCCC"> do some proof of concept really easy</font>

153
00:06:53,470 --> 00:06:58,960
basically the the code here for this

154
00:06:56,890 --> 00:07:01,539
toolkit is something like maybe I don't

155
00:06:58,960 --> 00:07:03,310
<font color="#CCCCCC">know three and red lines</font><font color="#E5E5E5"> ok you can it's</font>

156
00:07:01,540 --> 00:07:07,900
quite generic and you can do a lot of

157
00:07:03,310 --> 00:07:09,940
stuff so<font color="#CCCCCC"> ok it's HTTP server which has</font>

158
00:07:07,900 --> 00:07:12,520
been developed not yes<font color="#E5E5E5"> you can fake it</font>

159
00:07:09,940 --> 00:07:14,980
get and post request HTTP<font color="#E5E5E5"> request</font><font color="#CCCCCC"> I</font>

160
00:07:12,520 --> 00:07:17,260
didn't<font color="#E5E5E5"> want to bother with you know put</font>

161
00:07:14,980 --> 00:07:19,480
delete etc because<font color="#E5E5E5"> if you want to target</font>

162
00:07:17,260 --> 00:07:21,849
those it means that<font color="#E5E5E5"> you already got some</font>

163
00:07:19,480 --> 00:07:23,380
injection on the place<font color="#CCCCCC"> so xss and then</font>

164
00:07:21,850 --> 00:07:25,510
you can do whatever you want so you can

165
00:07:23,380 --> 00:07:27,219
you know you<font color="#E5E5E5"> can run beef you can do a</font>

166
00:07:25,510 --> 00:07:29,440
lot of stuff so<font color="#E5E5E5"> I wanted really</font>

167
00:07:27,220 --> 00:07:33,240
something generic for you know remote<font color="#E5E5E5"> X</font>

168
00:07:29,440 --> 00:07:36,250
but not where<font color="#E5E5E5"> Caesar fat acts in general</font>

169
00:07:33,240 --> 00:07:38,620
and it creates payload on the<font color="#CCCCCC"> forum so</font>

170
00:07:36,250 --> 00:07:40,510
basically if you want to do a logger

171
00:07:38,620 --> 00:07:41,980
user in ok and<font color="#E5E5E5"> there is the parameter</font>

172
00:07:40,510 --> 00:07:44,560
password who is going to change because

173
00:07:41,980 --> 00:07:46,750
you<font color="#E5E5E5"> don't know its password so let's say</font>

174
00:07:44,560 --> 00:07:49,390
yes got some wit credentials and its

175
00:07:46,750 --> 00:07:52,990
password is in the top 20 worst password

176
00:07:49,390 --> 00:07:56,229
ok so if you want<font color="#E5E5E5"> to do it you will have</font>

177
00:07:52,990 --> 00:07:58,570
to create 25 20 different files HTML

178
00:07:56,230 --> 00:07:59,950
files containing the password ok which

179
00:07:58,570 --> 00:08:02,950
gonna<font color="#E5E5E5"> change so</font><font color="#CCCCCC"> I'd say i don't know</font>

180
00:07:59,950 --> 00:08:05,770
it's going to be password 123456 etc etc

181
00:08:02,950 --> 00:08:07,450
you will have 25 and here with this

182
00:08:05,770 --> 00:08:09,580
toolkit you just create the payloads

183
00:08:07,450 --> 00:08:12,550
sort of forms you create it on the fly

184
00:08:09,580 --> 00:08:14,620
so directly from the URL you can manage

185
00:08:12,550 --> 00:08:17,620
<font color="#CCCCCC">to create it so you just have a template</font>

186
00:08:14,620 --> 00:08:20,770
okay so you just say<font color="#CCCCCC"> ok this is going</font><font color="#E5E5E5"> to</font>

187
00:08:17,620 --> 00:08:23,080
be metal plate in my login form and then

188
00:08:20,770 --> 00:08:25,240
<font color="#E5E5E5">from the URL is going to get the</font>

189
00:08:23,080 --> 00:08:27,490
parameters etc and build the form

190
00:08:25,240 --> 00:08:29,620
automatically so basically<font color="#E5E5E5"> here you will</font>

191
00:08:27,490 --> 00:08:31,720
just have one template and if you want

192
00:08:29,620 --> 00:08:34,479
to<font color="#CCCCCC"> run the attack to log the user in you</font>

193
00:08:31,720 --> 00:08:36,340
will just you know call the code is your

194
00:08:34,479 --> 00:08:40,300
way with the<font color="#CCCCCC"> specific password that you</font>

195
00:08:36,340 --> 00:08:42,990
want so you will not have a lot of HTML

196
00:08:40,299 --> 00:08:46,089
<font color="#E5E5E5">files that you will be lost in etc etc</font>

197
00:08:42,990 --> 00:08:48,640
as<font color="#E5E5E5"> I</font><font color="#CCCCCC"> said there is the communication</font>

198
00:08:46,090 --> 00:08:50,460
part with which is in gs on everything

199
00:08:48,640 --> 00:08:52,980
is in JavaScript here sir

200
00:08:50,460 --> 00:08:57,600
I think for me<font color="#CCCCCC"> it</font><font color="#E5E5E5"> was the most</font>

201
00:08:52,980 --> 00:09:02,220
convenient and it resets the need and

202
00:08:57,600 --> 00:09:03,780
just a quick quick info this<font color="#E5E5E5"> weekend I</font>

203
00:09:02,220 --> 00:09:06,360
looked on the internet to find you know

204
00:09:03,780 --> 00:09:08,970
some real statistics about people

205
00:09:06,360 --> 00:09:16,770
discipline<font color="#E5E5E5"> JavaScript and do you know</font>

206
00:09:08,970 --> 00:09:19,880
something about the percentage<font color="#CCCCCC"> okay in</font>

207
00:09:16,770 --> 00:09:23,699
the<font color="#CCCCCC"> US in the u.s. it's only two percent</font>

208
00:09:19,880 --> 00:09:27,240
<font color="#CCCCCC">okay and if</font><font color="#E5E5E5"> we look at the Europe UK</font>

209
00:09:23,700 --> 00:09:30,210
it's a drum it's around one and two<font color="#CCCCCC"> okay</font>

210
00:09:27,240 --> 00:09:32,160
so i can understand<font color="#CCCCCC"> that some people you</font>

211
00:09:30,210 --> 00:09:34,800
know we will speak about the mitigation

212
00:09:32,160 --> 00:09:36,209
etc what you can do and you can say me

213
00:09:34,800 --> 00:09:38,310
okay but if i<font color="#CCCCCC"> don't have javascript</font>

214
00:09:36,210 --> 00:09:41,010
enabled so you cannot do anything with

215
00:09:38,310 --> 00:09:42,810
this took it that's true<font color="#E5E5E5"> but i mean if</font>

216
00:09:41,010 --> 00:09:44,790
you just look at if you want to<font color="#E5E5E5"> target</font>

217
00:09:42,810 --> 00:09:47,069
some people in a company etc you can

218
00:09:44,790 --> 00:09:48,990
<font color="#E5E5E5">manage to do it you know because most of</font>

219
00:09:47,070 --> 00:09:54,020
the people we just keep<font color="#CCCCCC"> javascript</font>

220
00:09:48,990 --> 00:09:56,580
enable you can you can do a lot<font color="#E5E5E5"> of stuff</font>

221
00:09:54,020 --> 00:09:58,620
there are<font color="#CCCCCC"> even so more features as</font><font color="#E5E5E5"> i</font>

222
00:09:56,580 --> 00:10:00,960
said you can<font color="#E5E5E5"> manage to combine CSF flows</font>

223
00:09:58,620 --> 00:10:04,560
and<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> i would say the key feature</font>

224
00:10:00,960 --> 00:10:07,410
of this tool i will just run after this

225
00:10:04,560 --> 00:10:10,500
during the demos what we can do this and

226
00:10:07,410 --> 00:10:12,360
we have to attack modes so if we<font color="#CCCCCC"> look on</font>

227
00:10:10,500 --> 00:10:15,210
exploit DB and all the sex but we have

228
00:10:12,360 --> 00:10:18,390
about CSF attacks we've got a special

229
00:10:15,210 --> 00:10:21,720
value you know you get a specific custom

230
00:10:18,390 --> 00:10:23,130
crafted form and here it<font color="#CCCCCC"> is the same you</font>

231
00:10:21,720 --> 00:10:26,700
know if you want<font color="#E5E5E5"> to craft your own</font>

232
00:10:23,130 --> 00:10:30,390
custom form or even targeted a URL you

233
00:10:26,700 --> 00:10:32,550
<font color="#CCCCCC">can do it by just choosing is dis dis</font>

234
00:10:30,390 --> 00:10:36,060
method and otherwise um there is a

235
00:10:32,550 --> 00:10:37,560
dictionary attack so yeah just a quick

236
00:10:36,060 --> 00:10:40,439
example if you want to try to log the

237
00:10:37,560 --> 00:10:42,180
user in you will just specify the attack

238
00:10:40,440 --> 00:10:44,430
the template form that you want to<font color="#CCCCCC"> use</font>

239
00:10:42,180 --> 00:10:46,170
or the target URL and<font color="#CCCCCC"> then you will</font>

240
00:10:44,430 --> 00:10:48,599
specify the dictionary file that you

241
00:10:46,170 --> 00:10:51,089
will want to use and then it's going to

242
00:10:48,600 --> 00:10:52,530
actually for each entry in the file its

243
00:10:51,090 --> 00:10:54,270
going to send the payload to the victim

244
00:10:52,530 --> 00:10:56,850
and the<font color="#E5E5E5"> victim we'll just you know</font>

245
00:10:54,270 --> 00:11:03,130
inserting into the dome and will execute

246
00:10:56,850 --> 00:11:04,930
it is it all clear yeah after after the

247
00:11:03,130 --> 00:11:06,430
the conference<font color="#E5E5E5"> I mean</font><font color="#CCCCCC"> after this talk I</font>

248
00:11:04,930 --> 00:11:09,310
<font color="#CCCCCC">think we will have something like I</font>

249
00:11:06,430 --> 00:11:10,569
don't<font color="#E5E5E5"> know maybe five or</font><font color="#CCCCCC"> ten minutes so</font>

250
00:11:09,310 --> 00:11:13,599
if you have some questions just feel

251
00:11:10,570 --> 00:11:15,700
free to<font color="#E5E5E5"> just keep them and if you're too</font>

252
00:11:13,600 --> 00:11:18,070
shy to just ask me where we<font color="#E5E5E5"> can maybe</font>

253
00:11:15,700 --> 00:11:21,070
take a beer after and we can speak about

254
00:11:18,070 --> 00:11:26,530
it or otherwise you can you can ask it

255
00:11:21,070 --> 00:11:29,500
directly feel free moreover there are

256
00:11:26,530 --> 00:11:32,350
some additional tools are there some

257
00:11:29,500 --> 00:11:37,450
people who know him Alonso Emma Alonso

258
00:11:32,350 --> 00:11:41,230
yeah okay is a very Spanish and the

259
00:11:37,450 --> 00:11:43,930
<font color="#E5E5E5">orphans goes to to</font><font color="#CCCCCC"> Def Con and where I</font>

260
00:11:41,230 --> 00:11:46,300
created some tools a<font color="#E5E5E5"> JavaScript proxy</font>

261
00:11:43,930 --> 00:11:48,370
which tempers the request and inserts a

262
00:11:46,300 --> 00:11:51,849
malicious I friend well it was inspired

263
00:11:48,370 --> 00:11:54,430
by the by this researcher because it did

264
00:11:51,850 --> 00:11:57,460
this presentation a dozen I mean do you

265
00:11:54,430 --> 00:12:00,310
know this presentation may be<font color="#CCCCCC"> okay long</font>

266
00:11:57,460 --> 00:12:02,050
story short what you wanted to worry

267
00:12:00,310 --> 00:12:03,880
Spanish it doesn't have a lot of money

268
00:12:02,050 --> 00:12:07,240
<font color="#E5E5E5">and he was doing a lot of joke about</font>

269
00:12:03,880 --> 00:12:10,510
this and it was lazy and you wanted<font color="#CCCCCC"> to</font>

270
00:12:07,240 --> 00:12:13,600
create<font color="#CCCCCC"> a botnet</font><font color="#E5E5E5"> okay but he didn't have</font>

271
00:12:10,510 --> 00:12:16,000
<font color="#E5E5E5">the money for this and ok and I think he</font>

272
00:12:13,600 --> 00:12:19,090
had in mind was you know to create<font color="#E5E5E5"> a</font>

273
00:12:16,000 --> 00:12:22,240
squid proxy and then register it on the

274
00:12:19,090 --> 00:12:24,340
internet and after a few days it got

275
00:12:22,240 --> 00:12:26,710
something like and at the same time<font color="#E5E5E5"> he</font>

276
00:12:24,340 --> 00:12:29,350
was tampering the request and injecting

277
00:12:26,710 --> 00:12:31,270
some JavaScript<font color="#CCCCCC"> ok and the thing is</font>

278
00:12:29,350 --> 00:12:36,430
after a few days<font color="#CCCCCC"> it got something like</font>

279
00:12:31,270 --> 00:12:39,220
more than 5,000 people<font color="#E5E5E5"> ok but all these</font>

280
00:12:36,430 --> 00:12:41,530
squid proxy etc I didn't want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> try it</font>

281
00:12:39,220 --> 00:12:46,840
so i just created the energy a script

282
00:12:41,530 --> 00:12:48,280
still no GS and it's a<font color="#CCCCCC"> JavaScript proxy</font>

283
00:12:46,840 --> 00:12:50,920
that you can launch on your<font color="#E5E5E5"> on your</font>

284
00:12:48,280 --> 00:12:53,709
machine you just specify<font color="#CCCCCC"> the DI frame</font>

285
00:12:50,920 --> 00:12:56,110
the<font color="#CCCCCC"> D target I frame that you want to to</font>

286
00:12:53,710 --> 00:12:57,700
insert<font color="#CCCCCC"> it into the pages it's going to</font>

287
00:12:56,110 --> 00:13:00,940
do the work for you so you can<font color="#E5E5E5"> give</font><font color="#CCCCCC"> it a</font>

288
00:12:57,700 --> 00:13:04,450
try it on my github account as well so

289
00:13:00,940 --> 00:13:07,360
you should give it<font color="#CCCCCC"> a try and as well</font>

290
00:13:04,450 --> 00:13:09,610
there is<font color="#E5E5E5"> another pie turn to I developed</font>

291
00:13:07,360 --> 00:13:11,530
which is a<font color="#CCCCCC"> common</font><font color="#E5E5E5"> line tool that</font>

292
00:13:09,610 --> 00:13:14,830
automates the usage of my two kids so

293
00:13:11,530 --> 00:13:15,730
basically if you find a c7<font color="#CCCCCC"> RBT on a</font>

294
00:13:14,830 --> 00:13:18,670
<font color="#CCCCCC">forum</font>

295
00:13:15,730 --> 00:13:21,579
then you just you can just<font color="#CCCCCC"> use this tool</font>

296
00:13:18,670 --> 00:13:23,769
and it will grab the phone will create a

297
00:13:21,579 --> 00:13:27,760
configuration file which are in gs on

298
00:13:23,769 --> 00:13:29,320
and we<font color="#CCCCCC"> launched a toolkit so just 11</font>

299
00:13:27,760 --> 00:13:31,240
<font color="#E5E5E5">command line and you can</font><font color="#CCCCCC"> manage to</font>

300
00:13:29,320 --> 00:13:34,180
target the people you<font color="#CCCCCC"> know you will not</font>

301
00:13:31,240 --> 00:13:36,160
have to just take you html5 just insert

302
00:13:34,180 --> 00:13:40,060
it into your apache server etc

303
00:13:36,160 --> 00:13:46,149
everything is done here<font color="#CCCCCC"> ok it's a type</font>

304
00:13:40,060 --> 00:13:54,849
and<font color="#E5E5E5"> problem let's say</font><font color="#CCCCCC"> ok are you</font><font color="#E5E5E5"> ready</font>

305
00:13:46,149 --> 00:13:57,519
for the demos yeah the the<font color="#E5E5E5"> first demo is</font>

306
00:13:54,850 --> 00:13:59,320
going to be a really custom one or i can

307
00:13:57,519 --> 00:14:00,880
show you there i would say key feature

308
00:13:59,320 --> 00:14:03,970
of these two so you<font color="#E5E5E5"> can manage to</font>

309
00:14:00,880 --> 00:14:06,189
<font color="#E5E5E5">combine the attacks so let's take I just</font>

310
00:14:03,970 --> 00:14:09,670
developed from scratch a web application

311
00:14:06,190 --> 00:14:13,690
that<font color="#CCCCCC"> will be available as well on the</font>

312
00:14:09,670 --> 00:14:17,229
internet and there are some flaws csrf

313
00:14:13,690 --> 00:14:20,500
<font color="#E5E5E5">loss obviously and then</font><font color="#CCCCCC"> what we're going</font>

314
00:14:17,230 --> 00:14:22,569
to try to do is try<font color="#CCCCCC"> to attend early to</font>

315
00:14:20,500 --> 00:14:24,940
log the user in ok send some malicious

316
00:14:22,569 --> 00:14:28,060
payload after<font color="#E5E5E5"> is locked in and then lock</font>

317
00:14:24,940 --> 00:14:29,470
the user out<font color="#E5E5E5"> ok so completely</font>

318
00:14:28,060 --> 00:14:31,599
transparent attack if you<font color="#CCCCCC"> man I can't</font>

319
00:14:29,470 --> 00:14:35,010
even<font color="#E5E5E5"> show you the I'm going to show you</font>

320
00:14:31,600 --> 00:14:35,010
yeah the stuff

321
00:14:58,580 --> 00:15:05,580
I don't know if you can see clearly but

322
00:15:02,430 --> 00:15:07,380
so we got the name this is a

323
00:15:05,580 --> 00:15:08,700
configuration file that you will just

324
00:15:07,380 --> 00:15:12,300
load with the toolkit<font color="#E5E5E5"> okay you just</font>

325
00:15:08,700 --> 00:15:14,040
don't launch it so you get the name if

326
00:15:12,300 --> 00:15:17,339
you<font color="#E5E5E5"> want to add</font><font color="#CCCCCC"> another custom name and</font>

327
00:15:14,040 --> 00:15:19,140
then we got<font color="#CCCCCC"> three steps here so three</font>

328
00:15:17,340 --> 00:15:21,600
different attacks that will be load

329
00:15:19,140 --> 00:15:23,580
separately so the first<font color="#E5E5E5"> one then the</font>

330
00:15:21,600 --> 00:15:26,420
second one and then the last one the

331
00:15:23,580 --> 00:15:30,050
<font color="#CCCCCC">first</font><font color="#E5E5E5"> one is a type of attack dictionary</font>

332
00:15:26,420 --> 00:15:33,209
is going to use the file past that txt

333
00:15:30,050 --> 00:15:34,709
with the form i can show you after what

334
00:15:33,210 --> 00:15:37,680
it is but actually it's just the

335
00:15:34,710 --> 00:15:41,520
template of the login form and then yeah

336
00:15:37,680 --> 00:15:43,530
just a<font color="#E5E5E5"> comment so that's what we're</font>

337
00:15:41,520 --> 00:15:45,449
going to try this<font color="#E5E5E5"> is the login face then</font>

338
00:15:43,530 --> 00:15:48,150
<font color="#CCCCCC">the special value here that because we</font>

339
00:15:45,450 --> 00:15:51,900
want to<font color="#E5E5E5"> change a user's password that we</font>

340
00:15:48,150 --> 00:15:54,660
can do and then the last<font color="#CCCCCC"> step is we want</font>

341
00:15:51,900 --> 00:15:57,510
to<font color="#E5E5E5"> log him out so yeah I just</font><font color="#CCCCCC"> I just</font>

342
00:15:54,660 --> 00:15:59,250
have some internal vm future machine

343
00:15:57,510 --> 00:16:04,310
which are running on my computer and and

344
00:15:59,250 --> 00:16:09,140
and we know we're going<font color="#CCCCCC"> to try</font><font color="#E5E5E5"> it yeah</font>

345
00:16:04,310 --> 00:16:09,140
you can show you the template as well

346
00:16:13,900 --> 00:16:25,000
what<font color="#CCCCCC"> okay we cannot see a lot of stuff</font>

347
00:16:22,120 --> 00:16:29,760
but it's just you know basic HTML and

348
00:16:25,000 --> 00:16:29,760
this is just the form nothing else<font color="#CCCCCC"> okay</font>

349
00:16:30,120 --> 00:16:35,730
i'm going<font color="#E5E5E5"> to show you the venerable</font>

350
00:16:32,650 --> 00:16:35,730
platform my developed

351
00:16:50,420 --> 00:16:56,610
so here<font color="#CCCCCC"> is the venerable platform</font><font color="#E5E5E5"> I</font>

352
00:16:53,730 --> 00:17:06,179
developed for the occasion we're going

353
00:16:56,610 --> 00:17:15,569
<font color="#E5E5E5">to create a an account besides okay with</font>

354
00:17:06,179 --> 00:17:25,350
the same password<font color="#E5E5E5"> okay anyway we can</font>

355
00:17:15,569 --> 00:17:28,050
even<font color="#E5E5E5"> login it's just a you know basic</font>

356
00:17:25,349 --> 00:17:31,830
basic web application week you know you

357
00:17:28,050 --> 00:17:33,840
can send you know<font color="#E5E5E5"> reach the users of</font>

358
00:17:31,830 --> 00:17:37,919
some information you<font color="#CCCCCC"> know send messages</font>

359
00:17:33,840 --> 00:17:40,530
etc etc obviously you can you can change

360
00:17:37,920 --> 00:17:45,510
your password it's not protected

361
00:17:40,530 --> 00:17:48,660
protected against Caesar flows<font color="#CCCCCC"> okay so</font>

362
00:17:45,510 --> 00:17:50,340
i'm just going to log out well this

363
00:17:48,660 --> 00:17:55,620
application you know<font color="#E5E5E5"> i just renamed it</font>

364
00:17:50,340 --> 00:17:57,870
intranet so the thing<font color="#CCCCCC"> is with this tool</font>

365
00:17:55,620 --> 00:17:59,428
you can<font color="#E5E5E5"> manage to target obviously</font><font color="#CCCCCC"> all</font>

366
00:17:57,870 --> 00:18:01,139
the internal web applications that you

367
00:17:59,429 --> 00:18:03,090
have so it could be<font color="#E5E5E5"> for example a router</font>

368
00:18:01,140 --> 00:18:05,940
interface because most of them

369
00:18:03,090 --> 00:18:08,159
absolutely not concerned about brute

370
00:18:05,940 --> 00:18:11,580
forcing logins etc and obviously they do

371
00:18:08,160 --> 00:18:13,020
not have token forms into you know if

372
00:18:11,580 --> 00:18:16,350
you want to change<font color="#E5E5E5"> the settings change</font>

373
00:18:13,020 --> 00:18:18,480
the dns settings passwords etc so well

374
00:18:16,350 --> 00:18:20,189
just<font color="#CCCCCC"> to</font><font color="#E5E5E5"> show you you know we</font><font color="#CCCCCC"> got the</font>

375
00:18:18,480 --> 00:18:24,090
internet here so the internal

376
00:18:20,190 --> 00:18:25,559
application to the user and the the

377
00:18:24,090 --> 00:18:28,290
attacker will<font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to send some</font>

378
00:18:25,559 --> 00:18:30,420
papers anyway even if the person is not

379
00:18:28,290 --> 00:18:33,120
logged<font color="#E5E5E5"> in so if the application you know</font>

380
00:18:30,420 --> 00:18:35,190
if the attacker has got an access to<font color="#CCCCCC"> d</font>

381
00:18:33,120 --> 00:18:37,139
<font color="#CCCCCC">to this application at home so let's</font><font color="#E5E5E5"> say</font>

382
00:18:35,190 --> 00:18:39,750
it<font color="#E5E5E5"> just bought the same router it cannot</font>

383
00:18:37,140 --> 00:18:42,330
manage to craft those requests and just

384
00:18:39,750 --> 00:18:44,429
you<font color="#CCCCCC"> know put this configuration fight</font>

385
00:18:42,330 --> 00:18:48,570
with remote server and then launched it

386
00:18:44,429 --> 00:18:52,280
in do everything<font color="#CCCCCC"> you want so okay let's</font>

387
00:18:48,570 --> 00:18:52,280
let's just start the toolkit

388
00:19:04,460 --> 00:19:14,430
<font color="#E5E5E5">okay so we launched it on port 80 okay</font>

389
00:19:11,250 --> 00:19:17,060
can't see<font color="#CCCCCC"> anything it's just on a</font>

390
00:19:14,430 --> 00:19:23,100
virtual machine that I'm<font color="#E5E5E5"> running here</font>

391
00:19:17,060 --> 00:19:25,860
yeah spider-man ok so its launch on port

392
00:19:23,100 --> 00:19:29,459
8080 and for example<font color="#CCCCCC"> if you just give</font>

393
00:19:25,860 --> 00:19:37,979
the link to the<font color="#CCCCCC"> malicious United to the</font>

394
00:19:29,460 --> 00:19:42,720
victim sorry<font color="#CCCCCC"> okay you got a page like</font>

395
00:19:37,980 --> 00:19:46,380
this so you know on page and let's back

396
00:19:42,720 --> 00:19:49,920
to the<font color="#E5E5E5"> console and we can see</font><font color="#CCCCCC"> that you</font>

397
00:19:46,380 --> 00:19:52,190
know the first<font color="#E5E5E5"> the first exploit /</font>

398
00:19:49,920 --> 00:19:56,490
exploit that we're doing<font color="#E5E5E5"> is just to grab</font>

399
00:19:52,190 --> 00:19:59,340
all the information to load all the

400
00:19:56,490 --> 00:20:01,800
exploits and then as we can see we're

401
00:19:59,340 --> 00:20:04,500
doing the first phase which is<font color="#E5E5E5"> the login</font>

402
00:20:01,800 --> 00:20:07,560
face so you<font color="#CCCCCC"> know we</font><font color="#E5E5E5"> are trying several</font>

403
00:20:04,500 --> 00:20:13,670
passwords so qwerty monkey dragon 1 2 3

404
00:20:07,560 --> 00:20:16,500
1<font color="#CCCCCC"> 2 3 etc and besides as well and then</font>

405
00:20:13,670 --> 00:20:18,660
the second phase here is that we're

406
00:20:16,500 --> 00:20:20,610
<font color="#E5E5E5">sending some payloads which is special</font>

407
00:20:18,660 --> 00:20:22,980
value so this is undefined this

408
00:20:20,610 --> 00:20:25,800
parameter<font color="#CCCCCC"> okay because the form is</font>

409
00:20:22,980 --> 00:20:31,890
already crafted and then the last step

410
00:20:25,800 --> 00:20:33,360
is that we want<font color="#E5E5E5"> to log out the user so</font>

411
00:20:31,890 --> 00:20:39,450
if<font color="#CCCCCC"> we just go back to</font><font color="#E5E5E5"> the to</font><font color="#CCCCCC"> the</font>

412
00:20:33,360 --> 00:20:42,139
platform okay we're not logged in we can

413
00:20:39,450 --> 00:20:42,140
try to<font color="#CCCCCC"> log in</font>

414
00:20:46,050 --> 00:20:53,470
and we got a message here and we

415
00:20:51,340 --> 00:20:56,199
couldn't manage to log in with us I

416
00:20:53,470 --> 00:20:59,890
<font color="#E5E5E5">besides obviously because</font><font color="#CCCCCC"> the password</font>

417
00:20:56,200 --> 00:21:01,510
was<font color="#E5E5E5"> changed just going to find a new</font>

418
00:20:59,890 --> 00:21:03,990
password because i don't remember

419
00:21:01,510 --> 00:21:03,990
clearly

420
00:21:19,250 --> 00:21:23,360
<font color="#E5E5E5">okay the password was wood wood</font>

421
00:21:30,890 --> 00:21:35,150
and we logged in with<font color="#CCCCCC"> their with the</font>

422
00:21:32,690 --> 00:21:37,340
password<font color="#E5E5E5"> would would ya so we managed to</font>

423
00:21:35,150 --> 00:21:39,920
<font color="#E5E5E5">do a completely transparent attack for</font>

424
00:21:37,340 --> 00:21:43,040
the for the victim and we managed<font color="#CCCCCC"> to</font>

425
00:21:39,920 --> 00:21:45,590
send<font color="#CCCCCC"> all</font><font color="#E5E5E5"> the requests within his you</font>

426
00:21:43,040 --> 00:21:48,620
<font color="#CCCCCC">know without him accepting it we</font>

427
00:21:45,590 --> 00:21:55,580
<font color="#E5E5E5">couldn't manage to do it so the first</font>

428
00:21:48,620 --> 00:21:57,889
demo was working whoo<font color="#CCCCCC"> ok and the second</font>

429
00:21:55,580 --> 00:22:00,949
demo I'm gonna do is the automated

430
00:21:57,890 --> 00:22:03,080
attack with<font color="#E5E5E5"> my Python utility just to</font>

431
00:22:00,950 --> 00:22:06,100
<font color="#CCCCCC">show you you know if you</font><font color="#E5E5E5"> manage to find</font>

432
00:22:03,080 --> 00:22:08,929
a reliable platform what you can do to

433
00:22:06,100 --> 00:22:10,580
you know to create some proof of concept

434
00:22:08,930 --> 00:22:13,880
really easily so just one command line

435
00:22:10,580 --> 00:22:15,679
and you will be able<font color="#E5E5E5"> to do it and it's</font>

436
00:22:13,880 --> 00:22:18,410
going<font color="#E5E5E5"> to send a real crafted request to</font>

437
00:22:15,680 --> 00:22:22,820
change the admin password so if<font color="#CCCCCC"> we take</font>

438
00:22:18,410 --> 00:22:25,630
<font color="#E5E5E5">the you know the work through what you</font>

439
00:22:22,820 --> 00:22:28,760
would<font color="#CCCCCC"> have to do otherwise is you know</font>

440
00:22:25,630 --> 00:22:31,430
go and change<font color="#E5E5E5"> the password get the HTML</font>

441
00:22:28,760 --> 00:22:34,520
source code and then insert it into some

442
00:22:31,430 --> 00:22:36,830
HTML file etc crafted as you want and

443
00:22:34,520 --> 00:22:39,740
then push it<font color="#E5E5E5"> to your remote server and</font>

444
00:22:36,830 --> 00:22:46,790
the<font color="#E5E5E5"> world all this processing but I did</font>

445
00:22:39,740 --> 00:22:50,710
it for you ok let's<font color="#E5E5E5"> try the next demo I</font>

446
00:22:46,790 --> 00:22:50,710
just<font color="#E5E5E5"> need the cookie</font>

447
00:23:00,350 --> 00:23:03,100
ok

448
00:23:03,330 --> 00:23:10,620
so yeah we got to utilities so<font color="#CCCCCC"> csrf tu</font>

449
00:23:09,180 --> 00:23:15,120
to use is the one we're<font color="#E5E5E5"> going to use and</font>

450
00:23:10,620 --> 00:23:19,080
<font color="#CCCCCC">fun dumper is taking some reason input</font>

451
00:23:15,120 --> 00:23:21,330
and then is creating a you know a form

452
00:23:19,080 --> 00:23:24,419
that you<font color="#CCCCCC"> can then use for example if you</font>

453
00:23:21,330 --> 00:23:27,980
if you found some<font color="#CCCCCC"> CSRF on the rest api</font>

454
00:23:24,420 --> 00:23:27,980
you just saying

455
00:23:46,669 --> 00:23:51,570
okay<font color="#E5E5E5"> I I don't know if you can see</font>

456
00:23:49,499 --> 00:23:54,239
clearly but you're just cutting the

457
00:23:51,570 --> 00:23:57,450
utilities<font color="#E5E5E5"> okay saying that the form is</font>

458
00:23:54,239 --> 00:24:00,749
located here to<font color="#CCCCCC"> decide to this IP</font>

459
00:23:57,450 --> 00:24:02,580
address using your authentication cookie

460
00:24:00,749 --> 00:24:09,479
<font color="#E5E5E5">then you know you can manage to access</font>

461
00:24:02,580 --> 00:24:11,158
the page ok and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> okay the other</font>

462
00:24:09,479 --> 00:24:13,139
<font color="#CCCCCC">parameters so you just saying that the</font>

463
00:24:11,159 --> 00:24:15,330
parameter which is renewable is why the

464
00:24:13,139 --> 00:24:17,339
password you're going to use a special

465
00:24:15,330 --> 00:24:18,839
value attack and the password is going

466
00:24:17,339 --> 00:24:22,049
to be wit would but we're<font color="#E5E5E5"> going to</font>

467
00:24:18,839 --> 00:24:28,200
change it which I change this back to

468
00:24:22,049 --> 00:24:30,509
besides<font color="#CCCCCC"> okay and with this tool I added</font>

469
00:24:28,200 --> 00:24:33,089
<font color="#CCCCCC">some selectors so if you found some</font>

470
00:24:30,509 --> 00:24:34,919
specific selectors for a specific form

471
00:24:33,089 --> 00:24:37,619
let's say I<font color="#E5E5E5"> don't know he has got the</font>

472
00:24:34,919 --> 00:24:40,049
class change password you know you can

473
00:24:37,619 --> 00:24:42,119
specify it and otherwise it going to

474
00:24:40,049 --> 00:24:44,009
iterate on all the form that you<font color="#E5E5E5"> can</font>

475
00:24:42,119 --> 00:24:49,070
have in the<font color="#E5E5E5"> web page and it's going to</font>

476
00:24:44,009 --> 00:24:53,190
<font color="#E5E5E5">ask you the one</font><font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to target okay</font>

477
00:24:49,070 --> 00:24:55,678
so you just launched it as it said no

478
00:24:53,190 --> 00:24:57,929
<font color="#E5E5E5">selectors define they just taking the</font>

479
00:24:55,679 --> 00:24:59,519
first one if there<font color="#E5E5E5"> is only one and</font>

480
00:24:57,929 --> 00:25:02,219
otherwise it's going to iterate and ask

481
00:24:59,519 --> 00:25:03,869
you<font color="#CCCCCC"> for the one that you</font><font color="#E5E5E5"> want and then</font>

482
00:25:02,219 --> 00:25:08,609
<font color="#E5E5E5">you know giving you some information</font>

483
00:25:03,869 --> 00:25:11,779
using the TMP / TMP csr ft GMP conf we

484
00:25:08,609 --> 00:25:11,779
can give it a try if you<font color="#CCCCCC"> want</font>

485
00:25:22,700 --> 00:25:24,760
you

486
00:25:29,630 --> 00:25:37,220
I don't know if you can if you can see

487
00:25:32,750 --> 00:25:38,780
but ok I just<font color="#E5E5E5"> went in /t MP yeah this is</font>

488
00:25:37,220 --> 00:25:40,550
the<font color="#E5E5E5"> the configuration file that you're</font>

489
00:25:38,780 --> 00:25:43,520
going to launch with the with a<font color="#CCCCCC"> tool kit</font>

490
00:25:40,550 --> 00:25:45,320
so basically just taking a form with the

491
00:25:43,520 --> 00:25:47,360
method post and the type of fatigue is

492
00:25:45,320 --> 00:25:51,200
special value<font color="#CCCCCC"> okay that's the only thing</font>

493
00:25:47,360 --> 00:26:00,979
it's doing so we can just check the form

494
00:25:51,200 --> 00:26:03,320
as well and<font color="#E5E5E5"> okay so as you can see you</font>

495
00:26:00,980 --> 00:26:08,510
know you just did a cat we get requests

496
00:26:03,320 --> 00:26:12,260
to the HTTP server got the got older the

497
00:26:08,510 --> 00:26:14,680
content the well the<font color="#CCCCCC"> inner HTML and just</font>

498
00:26:12,260 --> 00:26:16,970
dump the specific part that you want it

499
00:26:14,680 --> 00:26:19,580
you know by replacing all the

500
00:26:16,970 --> 00:26:20,810
information and as you can see here we

501
00:26:19,580 --> 00:26:28,879
got the password with the new value

502
00:26:20,810 --> 00:26:31,399
which is besides let's go<font color="#CCCCCC"> okay so as you</font>

503
00:26:28,880 --> 00:26:36,890
can see i'm logged in here I just reload

504
00:26:31,400 --> 00:26:38,540
the page and here as you can see it's in

505
00:26:36,890 --> 00:26:42,290
your initialization the session again

506
00:26:38,540 --> 00:26:44,300
it's ending one request payload and

507
00:26:42,290 --> 00:26:46,490
define because still it's a special

508
00:26:44,300 --> 00:26:55,010
specific value attack that we're doing

509
00:26:46,490 --> 00:27:05,920
and then normal payloads<font color="#E5E5E5"> okay I just</font>

510
00:26:55,010 --> 00:27:05,920
locked out<font color="#E5E5E5"> login again besides besides</font>

511
00:27:06,490 --> 00:27:21,900
oops

512
00:27:09,140 --> 00:27:27,150
the more effect<font color="#E5E5E5"> oh okay it should have</font>

513
00:27:21,900 --> 00:27:36,060
<font color="#E5E5E5">worked okay sorry for this okay i guess</font>

514
00:27:27,150 --> 00:27:43,980
i missed one step if you can change the

515
00:27:36,060 --> 00:27:52,340
admin password yes<font color="#E5E5E5"> i changed it but with</font>

516
00:27:43,980 --> 00:27:57,030
the value<font color="#CCCCCC"> b side yeah yeah but yeah yeah</font>

517
00:27:52,340 --> 00:28:00,510
okay something went wrong can I try to

518
00:27:57,030 --> 00:28:03,540
debug it okay sorry<font color="#E5E5E5"> for this it should</font>

519
00:28:00,510 --> 00:28:06,840
have<font color="#E5E5E5"> worked the more effect etcetera</font>

520
00:28:03,540 --> 00:28:09,870
etcetera sorry but<font color="#E5E5E5"> okay it just to show</font>

521
00:28:06,840 --> 00:28:12,419
you you know the strength of the tube I

522
00:28:09,870 --> 00:28:15,239
mean just win with one<font color="#CCCCCC"> common line you</font>

523
00:28:12,420 --> 00:28:17,100
can manage<font color="#CCCCCC"> to you</font><font color="#E5E5E5"> know just</font><font color="#CCCCCC"> set up HTTP</font>

524
00:28:15,240 --> 00:28:21,620
server with some malicious payload than

525
00:28:17,100 --> 00:28:28,379
just sending it to the to the victim etc

526
00:28:21,620 --> 00:28:30,840
it's okay I don't know why yeah sorry so

527
00:28:28,380 --> 00:28:32,670
now let's let's take a look at the bad

528
00:28:30,840 --> 00:28:35,399
design in some<font color="#CCCCCC"> web application so</font>

529
00:28:32,670 --> 00:28:38,190
obviously there was no token in login

530
00:28:35,400 --> 00:28:40,530
form and you can<font color="#E5E5E5"> manage to automate this</font>

531
00:28:38,190 --> 00:28:42,960
process and a lot of web application

532
00:28:40,530 --> 00:28:45,840
don't have any token in login form so

533
00:28:42,960 --> 00:28:48,990
this means that<font color="#E5E5E5"> okay the rest of the</font>

534
00:28:45,840 --> 00:28:50,820
application can be targeted and you know

535
00:28:48,990 --> 00:28:54,330
if there<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> I would say I don't know</font>

536
00:28:50,820 --> 00:28:56,939
<font color="#E5E5E5">zero day on you know some some HTML</font>

537
00:28:54,330 --> 00:28:59,250
forms etc you will be able<font color="#E5E5E5"> to reach it</font>

538
00:28:56,940 --> 00:29:01,700
and if you has got some<font color="#CCCCCC"> wii credentials</font>

539
00:28:59,250 --> 00:29:05,970
you will be able<font color="#E5E5E5"> to you know target some</font>

540
00:29:01,700 --> 00:29:09,630
some people so<font color="#E5E5E5"> that's the first case and</font>

541
00:29:05,970 --> 00:29:11,520
the second one<font color="#CCCCCC"> is you know</font><font color="#E5E5E5"> i'm sure a</font>

542
00:29:09,630 --> 00:29:13,320
lot of people are already had those kind

543
00:29:11,520 --> 00:29:17,160
<font color="#E5E5E5">of form when it's asking for your old</font>

544
00:29:13,320 --> 00:29:19,620
password and for the new one so here the

545
00:29:17,160 --> 00:29:21,570
same you don't have any token and if you

546
00:29:19,620 --> 00:29:23,820
has got some weak credentials

547
00:29:21,570 --> 00:29:25,560
you can manage<font color="#E5E5E5"> to you know the user will</font>

548
00:29:23,820 --> 00:29:27,659
be able<font color="#E5E5E5"> to breed force his own password</font>

549
00:29:25,560 --> 00:29:29,820
then you will see in the console<font color="#CCCCCC"> okay</font>

550
00:29:27,660 --> 00:29:31,530
<font color="#E5E5E5">but this year's re you know maybe</font>

551
00:29:29,820 --> 00:29:34,159
<font color="#CCCCCC">doesn't remember it's all password but</font>

552
00:29:31,530 --> 00:29:37,170
<font color="#E5E5E5">you want you really wants to change it</font>

553
00:29:34,160 --> 00:29:38,940
so this is<font color="#E5E5E5"> yeah some other bad design</font>

554
00:29:37,170 --> 00:29:44,280
that you can you know find on the

555
00:29:38,940 --> 00:29:47,220
internet and saw the mitigations that

556
00:29:44,280 --> 00:29:49,379
you can do here so basically we<font color="#CCCCCC"> have</font>

557
00:29:47,220 --> 00:29:52,200
this request token so the value which is

558
00:29:49,380 --> 00:29:55,020
random generated on server side and then

559
00:29:52,200 --> 00:29:56,880
processed checked etc on the server and

560
00:29:55,020 --> 00:29:59,790
<font color="#E5E5E5">it's one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the most use you know</font>

561
00:29:56,880 --> 00:30:02,100
mechanism nowadays otherwise we have

562
00:29:59,790 --> 00:30:04,139
<font color="#E5E5E5">this Rio tenth occasion like you know</font>

563
00:30:02,100 --> 00:30:05,790
the previous example when it's asking

564
00:30:04,140 --> 00:30:07,760
for your password if<font color="#E5E5E5"> you want to change</font>

565
00:30:05,790 --> 00:30:10,320
<font color="#E5E5E5">your settings if you have got</font><font color="#CCCCCC"> a week one</font>

566
00:30:07,760 --> 00:30:13,110
good for you you can<font color="#E5E5E5"> manage to you know</font>

567
00:30:10,320 --> 00:30:15,510
change these settings do everything and

568
00:30:13,110 --> 00:30:18,330
otherwise you get other metals capture

569
00:30:15,510 --> 00:30:20,120
<font color="#E5E5E5">timeout and I don't know if you heard</font>

570
00:30:18,330 --> 00:30:25,350
about it<font color="#E5E5E5"> you know there was a blog post</font>

571
00:30:20,120 --> 00:30:27,780
on<font color="#CCCCCC"> metasploit a blog about a noscript I</font>

572
00:30:25,350 --> 00:30:30,990
don't know if you heard about<font color="#E5E5E5"> it but</font>

573
00:30:27,780 --> 00:30:33,030
<font color="#CCCCCC">okay and if you just</font><font color="#E5E5E5"> use noscript with</font>

574
00:30:30,990 --> 00:30:35,940
the default configuration you still you

575
00:30:33,030 --> 00:30:40,170
know can manage<font color="#CCCCCC"> to send some see you</font>

576
00:30:35,940 --> 00:30:42,240
know take advantage of Caesar flows you

577
00:30:40,170 --> 00:30:44,070
will just need you know some custom

578
00:30:42,240 --> 00:30:46,470
interaction just an interaction like a

579
00:30:44,070 --> 00:30:49,200
click clicking direction and it would my

580
00:30:46,470 --> 00:30:52,410
two cents on payload I didn't have the

581
00:30:49,200 --> 00:30:56,340
time to to insert it as a new feature in

582
00:30:52,410 --> 00:30:57,960
the tool but it's working progress so if

583
00:30:56,340 --> 00:31:00,929
you want to<font color="#E5E5E5"> be you know completely</font>

584
00:30:57,960 --> 00:31:03,690
protected and just use no script with a

585
00:31:00,930 --> 00:31:08,070
be so but basically<font color="#E5E5E5"> a B is just set of</font>

586
00:31:03,690 --> 00:31:10,860
rules that you can set to ensure even

587
00:31:08,070 --> 00:31:13,669
more you know<font color="#CCCCCC"> security etc about HTTP</font>

588
00:31:10,860 --> 00:31:17,149
<font color="#CCCCCC">request that you're that</font><font color="#E5E5E5"> you're doing</font>

589
00:31:13,670 --> 00:31:20,880
and<font color="#CCCCCC"> I'm sure you waited for</font><font color="#E5E5E5"> the surprise</font>

590
00:31:17,150 --> 00:31:24,060
maybe not I<font color="#E5E5E5"> don't know so I created a</font>

591
00:31:20,880 --> 00:31:26,780
venerable machine with the web

592
00:31:24,060 --> 00:31:29,549
application<font color="#CCCCCC"> that we saw earlier okay I</font>

593
00:31:26,780 --> 00:31:32,820
promise there will be no bug

594
00:31:29,549 --> 00:31:34,950
I hope so<font color="#E5E5E5"> it will</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> all set on filling</font>

595
00:31:32,820 --> 00:31:40,289
up<font color="#E5E5E5"> I guess a lot of people here know</font>

596
00:31:34,950 --> 00:31:46,220
about this platform<font color="#E5E5E5"> okay it will be</font>

597
00:31:40,289 --> 00:31:48,869
ousted here so let's see<font color="#E5E5E5"> how it goes and</font>

598
00:31:46,220 --> 00:31:52,619
obviously you<font color="#E5E5E5"> must exploit seesaw flows</font>

599
00:31:48,869 --> 00:31:54,119
to get root access there are some tricky

600
00:31:52,619 --> 00:31:57,539
other in your abilities to be able to do

601
00:31:54,119 --> 00:32:02,399
this but spoiler one of the first one<font color="#CCCCCC"> is</font>

602
00:31:57,539 --> 00:32:04,019
a CSF flow<font color="#CCCCCC"> okay so good luck I don't</font>

603
00:32:02,399 --> 00:32:06,178
know if you're going to<font color="#E5E5E5"> try it but it's</font>

604
00:32:04,019 --> 00:32:08,190
good it should<font color="#CCCCCC"> be yeah on</font><font color="#E5E5E5"> the website I</font>

605
00:32:06,179 --> 00:32:10,470
know maybe end of the week or something

606
00:32:08,190 --> 00:32:12,749
because just going back to<font color="#CCCCCC"> friends it's</font>

607
00:32:10,470 --> 00:32:15,239
that<font color="#CCCCCC"> you have have a lot of stuff to</font><font color="#E5E5E5"> do</font>

608
00:32:12,749 --> 00:32:20,220
and fight again those strikes this is

609
00:32:15,239 --> 00:32:23,489
going<font color="#E5E5E5"> to be hard let's see</font><font color="#CCCCCC"> okay do you</font>

610
00:32:20,220 --> 00:32:25,950
have do you have any any questions well

611
00:32:23,489 --> 00:32:27,659
when you're using Caesar photogs it's

612
00:32:25,950 --> 00:32:29,480
completely blind so it means that<font color="#CCCCCC"> you're</font>

613
00:32:27,659 --> 00:32:32,129
going to send<font color="#E5E5E5"> a request but</font>

614
00:32:29,480 --> 00:32:34,619
<font color="#E5E5E5">unfortunately or fortunately but</font>

615
00:32:32,129 --> 00:32:36,178
depending on the side you are it's going

616
00:32:34,619 --> 00:32:39,480
to<font color="#E5E5E5"> be completely blind so you will not</font>

617
00:32:36,179 --> 00:32:41,940
be able<font color="#E5E5E5"> to you know get the output well</font>

618
00:32:39,480 --> 00:32:44,850
get the result i mean the result page so

619
00:32:41,940 --> 00:32:48,509
you're just<font color="#E5E5E5"> doing it by blind and yeah</font>

620
00:32:44,850 --> 00:32:50,998
the<font color="#E5E5E5"> assumption here then is that the</font>

621
00:32:48,509 --> 00:32:57,659
user use some weak credentials etc and

622
00:32:50,999 --> 00:33:01,759
<font color="#E5E5E5">you know</font><font color="#CCCCCC"> I finished really early but ok</font>

623
00:32:57,659 --> 00:33:01,759
thanks a lot hope you liked it

