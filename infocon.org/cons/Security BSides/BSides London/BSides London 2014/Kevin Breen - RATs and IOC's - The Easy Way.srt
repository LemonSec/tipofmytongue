1
00:00:01,520 --> 00:00:06,710
<font color="#CCCCCC">i apologies for those who didn't want</font><font color="#E5E5E5"> to</font>

2
00:00:04,520 --> 00:00:10,250
come see<font color="#CCCCCC"> me nobody voted for me so</font>

3
00:00:06,710 --> 00:00:12,320
unlucky someone is covering I'm going to

4
00:00:10,250 --> 00:00:16,940
talk about<font color="#CCCCCC"> some remarks s Trojans and</font>

5
00:00:12,320 --> 00:00:19,370
<font color="#CCCCCC">IOC's I am son satisfies reverse</font><font color="#E5E5E5"> India</font>

6
00:00:16,940 --> 00:00:22,430
malware and I'm independent researcher

7
00:00:19,370 --> 00:00:23,960
blogger so my views on my own and not of

8
00:00:22,430 --> 00:00:27,380
the employer i work for<font color="#CCCCCC"> I'm not going to</font>

9
00:00:23,960 --> 00:00:29,750
<font color="#E5E5E5">tell you it is so that's what my friends</font>

10
00:00:27,380 --> 00:00:33,040
think I do that's what my<font color="#E5E5E5"> wife thinks I</font>

11
00:00:29,750 --> 00:00:36,980
do that's what work think I do and

12
00:00:33,040 --> 00:00:38,480
that's pretty much what I really do if I

13
00:00:36,980 --> 00:00:41,180
<font color="#E5E5E5">was told who needs malware engineers</font>

14
00:00:38,480 --> 00:00:44,269
when you got BTW so what I'm going to

15
00:00:41,180 --> 00:00:47,720
talk about is what I write is who uses

16
00:00:44,270 --> 00:00:51,440
them what's in them why am<font color="#E5E5E5"> I so</font>

17
00:00:47,720 --> 00:00:54,800
interested in<font color="#E5E5E5"> them grubbing the useful</font>

18
00:00:51,440 --> 00:00:56,149
stuff out of them we're<font color="#E5E5E5"> going to make it</font>

19
00:00:54,800 --> 00:00:57,468
easy and then<font color="#CCCCCC"> we'll look at how we can</font>

20
00:00:56,149 --> 00:01:01,579
share all this information with the

21
00:00:57,469 --> 00:01:03,620
community so where's a<font color="#CCCCCC"> rap map is a</font>

22
00:01:01,579 --> 00:01:06,310
remote<font color="#CCCCCC"> access trojan or at all depending</font>

23
00:01:03,620 --> 00:01:08,899
on<font color="#E5E5E5"> whether you</font><font color="#CCCCCC"> the good guy the bad guy</font>

24
00:01:06,310 --> 00:01:10,520
here's a client server configuration

25
00:01:08,899 --> 00:01:12,889
that's slightly backward so how will

26
00:01:10,520 --> 00:01:14,869
normal enterprise client server is<font color="#CCCCCC"> the</font>

27
00:01:12,889 --> 00:01:16,899
server sent out to all<font color="#E5E5E5"> the end users the</font>

28
00:01:14,869 --> 00:01:20,090
client is<font color="#E5E5E5"> sat on my box is the attacker</font>

29
00:01:16,899 --> 00:01:23,149
so it is really backwards and they're

30
00:01:20,090 --> 00:01:24,799
typically reverse connection so when you

31
00:01:23,149 --> 00:01:26,539
run the file you will connect to<font color="#E5E5E5"> me</font>

32
00:01:24,799 --> 00:01:30,409
rather than me attempting to connect to

33
00:01:26,539 --> 00:01:33,229
you so I said the server side sits the

34
00:01:30,409 --> 00:01:35,090
insecticide<font color="#CCCCCC"> and if you</font><font color="#E5E5E5"> get one of these</font>

35
00:01:33,229 --> 00:01:37,310
on your machine it gives me full and

36
00:01:35,090 --> 00:01:38,929
federated access your machine not only

37
00:01:37,310 --> 00:01:41,929
to<font color="#CCCCCC"> the machine that I'm on blows to the</font>

38
00:01:38,929 --> 00:01:44,689
wider<font color="#E5E5E5"> network anything you can do i can</font>

39
00:01:41,929 --> 00:01:48,829
quite literally do better if i get a a

40
00:01:44,689 --> 00:01:51,439
right and planted on your box so black

41
00:01:48,829 --> 00:01:53,839
shades are up black shades is a<font color="#E5E5E5"> publicly</font>

42
00:01:51,439 --> 00:01:56,148
available remote access tool for sale I

43
00:01:53,840 --> 00:01:59,239
appreciate that's a bit difficult<font color="#E5E5E5"> for</font>

44
00:01:56,149 --> 00:02:00,799
you to read black<font color="#CCCCCC"> shade is mainly an IT</font>

45
00:01:59,239 --> 00:02:03,380
surveillance and security based

46
00:02:00,799 --> 00:02:05,509
organization directed at making your PC

47
00:02:03,380 --> 00:02:07,520
experience easier our main goal<font color="#CCCCCC"> is to</font>

48
00:02:05,509 --> 00:02:09,139
offer affordable software solutions and

49
00:02:07,520 --> 00:02:12,260
so on and<font color="#E5E5E5"> so forth so they make</font>

50
00:02:09,139 --> 00:02:14,480
themselves seem legitimate how many

51
00:02:12,260 --> 00:02:15,380
legitimate pieces of software would

52
00:02:14,480 --> 00:02:19,940
include

53
00:02:15,380 --> 00:02:22,519
ransomware as a<font color="#E5E5E5"> option so this option is</font>

54
00:02:19,940 --> 00:02:24,800
by de facto in black shades and will

55
00:02:22,520 --> 00:02:26,780
allow<font color="#CCCCCC"> you</font><font color="#E5E5E5"> to encrypt any file on your</font>

56
00:02:24,800 --> 00:02:28,700
box and then display a message to<font color="#E5E5E5"> the</font>

57
00:02:26,780 --> 00:02:32,150
user saying<font color="#E5E5E5"> I have encrypted your files</font>

58
00:02:28,700 --> 00:02:33,739
give me<font color="#E5E5E5"> something in return so yes they</font>

59
00:02:32,150 --> 00:02:35,150
mark you they tried to market then they

60
00:02:33,740 --> 00:02:37,790
sell them there's actually a really big

61
00:02:35,150 --> 00:02:40,220
market for these<font color="#E5E5E5"> things black shades is</font>

62
00:02:37,790 --> 00:02:42,530
about forty dollars you have to pay for

63
00:02:40,220 --> 00:02:43,910
<font color="#E5E5E5">this and</font><font color="#CCCCCC"> then the bank i thought you</font>

64
00:02:42,530 --> 00:02:45,500
know a lot<font color="#CCCCCC"> of people are buying this and</font>

65
00:02:43,910 --> 00:02:47,960
they're infected lots of machines and

66
00:02:45,500 --> 00:02:50,720
this<font color="#CCCCCC"> is being</font><font color="#E5E5E5"> used everywhere I want</font>

67
00:02:47,960 --> 00:02:52,850
more<font color="#E5E5E5"> for my money so the author of black</font>

68
00:02:50,720 --> 00:02:55,550
shades actually put a backdoor into

69
00:02:52,850 --> 00:02:57,049
every single server that goes<font color="#E5E5E5"> out so</font>

70
00:02:55,550 --> 00:02:59,720
when the bad guys<font color="#CCCCCC"> are out infecting all</font>

71
00:02:57,050 --> 00:03:01,490
their slaves they're actually infecting

72
00:02:59,720 --> 00:03:03,200
their slaves with a<font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> server so</font>

73
00:03:01,490 --> 00:03:04,670
they've got access black shades of good

74
00:03:03,200 --> 00:03:07,100
access<font color="#CCCCCC"> whatever the black shade sell it</font>

75
00:03:04,670 --> 00:03:11,959
to good access so it's a massive massive

76
00:03:07,100 --> 00:03:13,790
thing so who uses them script kiddies

77
00:03:11,960 --> 00:03:16,760
use them that's<font color="#E5E5E5"> a twelve-year-old boy in</font>

78
00:03:13,790 --> 00:03:20,900
his basement<font color="#CCCCCC"> ecran groups your big</font>

79
00:03:16,760 --> 00:03:25,670
Russian<font color="#E5E5E5"> II crimes they use these and apt</font>

80
00:03:20,900 --> 00:03:27,860
use them script kiddies they like<font color="#E5E5E5"> to do</font>

81
00:03:25,670 --> 00:03:30,530
that these are taken straight from some

82
00:03:27,860 --> 00:03:32,270
hacking forums so he started this thread

83
00:03:30,530 --> 00:03:36,890
so you can share his best moments with

84
00:03:32,270 --> 00:03:38,560
all his female slaves this guy he was

85
00:03:36,890 --> 00:03:40,970
told he was lying so we had his proof

86
00:03:38,560 --> 00:03:44,480
youtube video he streamed of her as he

87
00:03:40,970 --> 00:03:47,450
was hacking a webcam on a<font color="#CCCCCC"> facebook this</font>

88
00:03:44,480 --> 00:03:51,530
guy's really happy he currently has 126

89
00:03:47,450 --> 00:03:53,869
slaves on lines aiming<font color="#CCCCCC"> for 200 this</font>

90
00:03:51,530 --> 00:03:56,030
guy's not so<font color="#CCCCCC"> happy though he was</font>

91
00:03:53,870 --> 00:03:58,490
listening<font color="#E5E5E5"> in on her mic he alder calling</font>

92
00:03:56,030 --> 00:04:01,670
the police and<font color="#CCCCCC"> he didn't have his VPN</font>

93
00:03:58,490 --> 00:04:04,940
turned on sir he's being traced and this

94
00:04:01,670 --> 00:04:07,899
guy his slave got his mummy to call the

95
00:04:04,940 --> 00:04:09,800
police<font color="#E5E5E5"> say salt gives you the level of</font>

96
00:04:07,900 --> 00:04:12,380
people where we're talking about<font color="#E5E5E5"> we're</font>

97
00:04:09,800 --> 00:04:14,180
really not talking about you know addled

98
00:04:12,380 --> 00:04:15,980
<font color="#E5E5E5">Caesar these are kids who managed</font><font color="#CCCCCC"> to get</font>

99
00:04:14,180 --> 00:04:19,280
<font color="#E5E5E5">all this publicly available software and</font>

100
00:04:15,980 --> 00:04:20,930
they're<font color="#E5E5E5"> just sending it out there these</font>

101
00:04:19,279 --> 00:04:24,229
people the way they typically tend to

102
00:04:20,930 --> 00:04:26,570
distribute is there look at whatever the

103
00:04:24,229 --> 00:04:28,240
<font color="#CCCCCC">favor One</font><font color="#E5E5E5"> Direction song is they'll</font>

104
00:04:26,570 --> 00:04:31,030
rename their server to be

105
00:04:28,240 --> 00:04:32,860
<font color="#CCCCCC">One Direction</font><font color="#E5E5E5"> dat mp3 sends out as a</font>

106
00:04:31,030 --> 00:04:34,239
torrent or uploaded as a youtube video

107
00:04:32,860 --> 00:04:36,669
and waiting<font color="#E5E5E5"> for somebody to come</font><font color="#CCCCCC"> and</font>

108
00:04:34,240 --> 00:04:38,110
click on<font color="#E5E5E5"> it somebody clicks on it they</font>

109
00:04:36,669 --> 00:04:42,818
get the right installed then on the

110
00:04:38,110 --> 00:04:46,030
wiser a crime syndicates so<font color="#E5E5E5"> semantic</font>

111
00:04:42,819 --> 00:04:51,030
push the report out last month then the

112
00:04:46,030 --> 00:04:51,030
last month detailing<font color="#E5E5E5"> the this is a sorry</font>

113
00:04:51,330 --> 00:04:56,050
this is a publicly available<font color="#CCCCCC"> rap that's</font>

114
00:04:54,789 --> 00:04:58,479
out there in the world it's been

115
00:04:56,050 --> 00:05:02,430
actively used by equal critique round

116
00:04:58,479 --> 00:05:04,449
groups and this is this is massive apt

117
00:05:02,430 --> 00:05:06,430
anywhere you<font color="#E5E5E5"> look in</font><font color="#CCCCCC"> the news</font><font color="#E5E5E5"> over the</font>

118
00:05:04,449 --> 00:05:11,020
loss over the last year and you'll see

119
00:05:06,430 --> 00:05:14,470
the apt is using rats terminator they're

120
00:05:11,020 --> 00:05:16,330
all over<font color="#CCCCCC"> the place so what the apt</font>

121
00:05:14,470 --> 00:05:18,849
groups tend to do is they'll throw this

122
00:05:16,330 --> 00:05:20,680
this rat at you and use this<font color="#E5E5E5"> as a first</font>

123
00:05:18,849 --> 00:05:23,440
day Jim plan this for a couple of

124
00:05:20,680 --> 00:05:25,479
reasons one it's a nice simple piece<font color="#CCCCCC"> of</font>

125
00:05:23,440 --> 00:05:28,210
malware they haven't had<font color="#E5E5E5"> to expose their</font>

126
00:05:25,479 --> 00:05:30,849
their big<font color="#CCCCCC"> the subjects vent fortunes</font>

127
00:05:28,210 --> 00:05:33,159
building privately and also is low

128
00:05:30,849 --> 00:05:35,740
attribution these are all publicly

129
00:05:33,159 --> 00:05:36,880
available the<font color="#CCCCCC"> whole world uses them so</font>

130
00:05:35,740 --> 00:05:39,340
if you<font color="#E5E5E5"> were to get one of these infected</font>

131
00:05:36,880 --> 00:05:41,949
on your box how can you turn around and

132
00:05:39,340 --> 00:05:44,289
<font color="#E5E5E5">say that's state-sponsored attacks and</font>

133
00:05:41,949 --> 00:05:46,330
not say<font color="#E5E5E5"> that some kid in his basement</font>

134
00:05:44,289 --> 00:05:48,099
<font color="#E5E5E5">who's accidentally affected you so it's</font>

135
00:05:46,330 --> 00:05:51,070
that level of deniability that makes it

136
00:05:48,099 --> 00:05:55,539
a really useful<font color="#E5E5E5"> first-aid implant that</font>

137
00:05:51,070 --> 00:05:58,150
<font color="#CCCCCC">and they are ridiculously powerful so</font>

138
00:05:55,539 --> 00:05:59,318
that's what they<font color="#E5E5E5"> are us who uses them so</font>

139
00:05:58,150 --> 00:06:02,349
let's have a look and see<font color="#CCCCCC"> what we can</font>

140
00:05:59,319 --> 00:06:04,719
<font color="#E5E5E5">get of them so because a rat is reverse</font>

141
00:06:02,349 --> 00:06:07,330
<font color="#E5E5E5">collecting all the information is</font>

142
00:06:04,719 --> 00:06:08,860
already contained inside the<font color="#E5E5E5"> XE file so</font>

143
00:06:07,330 --> 00:06:11,370
it lands on your machine that has all

144
00:06:08,860 --> 00:06:15,430
the information that<font color="#E5E5E5"> needs to talk back</font>

145
00:06:11,370 --> 00:06:17,349
so domains and IP addresses passwords

146
00:06:15,430 --> 00:06:19,090
anything they use if they're encrypting

147
00:06:17,349 --> 00:06:22,030
the link the passwords are in there the

148
00:06:19,090 --> 00:06:25,448
ports are in there when this thing goes

149
00:06:22,030 --> 00:06:28,479
to install on<font color="#CCCCCC"> your box file names file</font>

150
00:06:25,449 --> 00:06:30,340
paths registry<font color="#E5E5E5"> keys mutexes all this</font>

151
00:06:28,479 --> 00:06:33,130
information is natively stored inside

152
00:06:30,340 --> 00:06:34,659
that file you've just got on your box so

153
00:06:33,130 --> 00:06:36,039
basically<font color="#CCCCCC"> the bad guys just said here</font>

154
00:06:34,659 --> 00:06:37,389
have every and single piece<font color="#CCCCCC"> of</font>

155
00:06:36,039 --> 00:06:39,820
information<font color="#E5E5E5"> you want to defend yourself</font>

156
00:06:37,389 --> 00:06:40,260
<font color="#E5E5E5">against me to find me and to locate me</font>

157
00:06:39,820 --> 00:06:48,870
there

158
00:06:40,260 --> 00:06:50,490
it all to you so grabbing the config so

159
00:06:48,870 --> 00:06:51,750
we know all this stuff's in there and

160
00:06:50,490 --> 00:06:54,690
this is the more technical bits o

161
00:06:51,750 --> 00:06:56,040
budgeted the workshop which took you

162
00:06:54,690 --> 00:07:02,730
through some of<font color="#E5E5E5"> the</font><font color="#CCCCCC"> states we go to do</font>

163
00:06:56,040 --> 00:07:04,710
this so a lot of these conflicts a lot

164
00:07:02,730 --> 00:07:07,200
<font color="#E5E5E5">of these</font><font color="#CCCCCC"> routes of poison ivy was</font>

165
00:07:04,710 --> 00:07:10,469
massively used the conflicts in clear

166
00:07:07,200 --> 00:07:13,050
beacon domains port numbers insulation

167
00:07:10,470 --> 00:07:16,140
names all in clear text so simply

168
00:07:13,050 --> 00:07:17,340
opening up in Santa like strings or in a

169
00:07:16,140 --> 00:07:19,560
hex editor and you're going to see all

170
00:07:17,340 --> 00:07:26,489
this information immediately in front of

171
00:07:19,560 --> 00:07:31,890
you sometimes we encrypt it with the

172
00:07:26,490 --> 00:07:33,300
encrypted stuff we still<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to find</font>

173
00:07:31,890 --> 00:07:36,659
the password apologies<font color="#CCCCCC"> that that's not</font>

174
00:07:33,300 --> 00:07:39,240
very clear in the bomb when they encrypt

175
00:07:36,660 --> 00:07:40,920
it the method of encryption has to be

176
00:07:39,240 --> 00:07:42,480
included<font color="#CCCCCC"> in the next file so the</font>

177
00:07:40,920 --> 00:07:43,920
encryption keys<font color="#E5E5E5"> there the encryption</font>

178
00:07:42,480 --> 00:07:46,800
scheme is there everything you need is

179
00:07:43,920 --> 00:07:49,440
<font color="#CCCCCC">sat inside it so what we can do is when</font>

180
00:07:46,800 --> 00:07:50,820
we start to analyze this we look for the

181
00:07:49,440 --> 00:07:53,400
encryption key we take the encryption

182
00:07:50,820 --> 00:07:55,140
key out and decode it most the<font color="#E5E5E5"> time this</font>

183
00:07:53,400 --> 00:07:56,849
this comes in a<font color="#CCCCCC"> couple places either sat</font>

184
00:07:55,140 --> 00:07:58,979
<font color="#E5E5E5">in a resource section or it's just</font>

185
00:07:56,850 --> 00:08:01,020
depended on the end<font color="#E5E5E5"> of the file and</font>

186
00:07:58,980 --> 00:08:02,220
depending on how we go for time by over

187
00:08:01,020 --> 00:08:04,349
couple of demos we can go<font color="#E5E5E5"> through the</font>

188
00:08:02,220 --> 00:08:08,390
end and show you how<font color="#CCCCCC"> simple it is just</font>

189
00:08:04,350 --> 00:08:08,390
to pop these bits of information out

190
00:08:14,540 --> 00:08:19,680
so now we know<font color="#CCCCCC"> what we're looking for</font>

191
00:08:16,290 --> 00:08:22,850
let's make<font color="#CCCCCC"> it easy so I've spent the</font>

192
00:08:19,680 --> 00:08:25,020
last two three<font color="#E5E5E5"> months looking at rats</font>

193
00:08:22,850 --> 00:08:29,610
and I've done all that<font color="#E5E5E5"> hard work for you</font>

194
00:08:25,020 --> 00:08:31,830
so I've released 23 scripts all hosts on

195
00:08:29,610 --> 00:08:34,260
my github and this will do all the work

196
00:08:31,830 --> 00:08:36,120
for<font color="#E5E5E5"> you so you put any rat in there as</font>

197
00:08:34,260 --> 00:08:37,710
long as it recognizes it and understands

198
00:08:36,120 --> 00:08:39,090
it then<font color="#CCCCCC"> they'll just extract that</font>

199
00:08:37,710 --> 00:08:42,210
conflict for you and give it<font color="#E5E5E5"> in a nice</font>

200
00:08:39,090 --> 00:08:44,070
easy way for you to view and then

201
00:08:42,210 --> 00:08:47,520
secondary it's what the main project

202
00:08:44,070 --> 00:08:49,710
designed run is my web.config calm so

203
00:08:47,520 --> 00:08:52,680
what I've done is I've taken a massive

204
00:08:49,710 --> 00:08:55,130
repository of malware over 16 million

205
00:08:52,680 --> 00:08:57,660
samples publicly available malware of

206
00:08:55,130 --> 00:08:59,840
that I've<font color="#E5E5E5"> indexing it I've sorted i</font>

207
00:08:57,660 --> 00:09:04,829
filtered it and I've extracted about

208
00:08:59,840 --> 00:09:06,570
45,000 remote access<font color="#E5E5E5"> Trojans from those</font>

209
00:09:04,830 --> 00:09:10,050
they're all currently<font color="#E5E5E5"> being indexed in</font>

210
00:09:06,570 --> 00:09:12,240
<font color="#E5E5E5">to the site and</font><font color="#CCCCCC"> I'll</font><font color="#E5E5E5"> show you the site</font>

211
00:09:10,050 --> 00:09:14,819
little bit later on so you've got<font color="#E5E5E5"> the</font>

212
00:09:12,240 --> 00:09:16,280
config so how can we<font color="#E5E5E5"> use this so</font>

213
00:09:14,820 --> 00:09:20,910
defensively it's nice and simple

214
00:09:16,280 --> 00:09:24,959
firewall rules port filters looking

215
00:09:20,910 --> 00:09:26,610
<font color="#CCCCCC">through logs snort rules and IOC files</font>

216
00:09:24,960 --> 00:09:28,110
these<font color="#E5E5E5"> are all things we can do very</font>

217
00:09:26,610 --> 00:09:30,210
quickly to<font color="#E5E5E5"> start providing defense</font>

218
00:09:28,110 --> 00:09:34,110
against you state now this doesn't

219
00:09:30,210 --> 00:09:36,120
<font color="#E5E5E5">really apply for those script kitty kind</font>

220
00:09:34,110 --> 00:09:37,200
of attacks because you nobody in their

221
00:09:36,120 --> 00:09:38,880
corporate vamps really going to give

222
00:09:37,200 --> 00:09:42,410
affected with those but as we've seen

223
00:09:38,880 --> 00:09:44,939
<font color="#E5E5E5">this is massive used by apt Andy crow so</font>

224
00:09:42,410 --> 00:09:47,400
if<font color="#E5E5E5"> we get a sample we get a spear fish</font>

225
00:09:44,940 --> 00:09:48,870
sampling we've got that X file we we

226
00:09:47,400 --> 00:09:51,840
decode it we take all that information

227
00:09:48,870 --> 00:09:54,060
out I can now write firewall rules or

228
00:09:51,840 --> 00:09:57,150
snort rules to explicitly block and stop

229
00:09:54,060 --> 00:09:59,069
that or depending on what my

230
00:09:57,150 --> 00:10:00,810
<font color="#E5E5E5">infrastructure is like that I can allow</font>

231
00:09:59,070 --> 00:10:03,660
those connections and limit them coming

232
00:10:00,810 --> 00:10:04,739
in and then to see what they're doing so

233
00:10:03,660 --> 00:10:06,510
there's a lot<font color="#E5E5E5"> of intelligence to be</font>

234
00:10:04,740 --> 00:10:08,790
gained and again this is all sent

235
00:10:06,510 --> 00:10:11,900
directly to you they give you everything

236
00:10:08,790 --> 00:10:11,900
you<font color="#E5E5E5"> need to figure this out</font>

237
00:10:16,009 --> 00:10:22,199
for those of<font color="#E5E5E5"> you that way inclined you</font>

238
00:10:18,480 --> 00:10:23,850
can also go offensive with this now i'll

239
00:10:22,199 --> 00:10:26,399
leave the morality of offensive security

240
00:10:23,850 --> 00:10:28,410
up to the individuals<font color="#CCCCCC"> i'm not saying go</font>

241
00:10:26,399 --> 00:10:30,629
and do<font color="#CCCCCC"> this by any means but again</font>

242
00:10:28,410 --> 00:10:32,790
you've<font color="#E5E5E5"> got all their information you've</font>

243
00:10:30,629 --> 00:10:35,819
got their domain name that gives your IP

244
00:10:32,790 --> 00:10:37,949
<font color="#CCCCCC">address you have the port number that</font>

245
00:10:35,819 --> 00:10:41,040
gives<font color="#E5E5E5"> you a socket and</font><font color="#CCCCCC"> you have their</font>

246
00:10:37,949 --> 00:10:43,529
password so i now have everything<font color="#E5E5E5"> i need</font>

247
00:10:41,040 --> 00:10:46,139
to create a legitimate connection back

248
00:10:43,529 --> 00:10:48,290
to you with the attacker so what<font color="#E5E5E5"> can</font><font color="#CCCCCC"> i</font>

249
00:10:46,139 --> 00:10:50,399
do<font color="#E5E5E5"> with that i can dodge the attacker i</font>

250
00:10:48,290 --> 00:10:54,360
know you're up here just<font color="#E5E5E5"> in your port so</font>

251
00:10:50,399 --> 00:10:56,819
what can<font color="#E5E5E5"> i do i will fake</font><font color="#CCCCCC"> 3000 remote</font>

252
00:10:54,360 --> 00:10:58,709
connections to your box make your make

253
00:10:56,819 --> 00:11:01,199
your<font color="#E5E5E5"> client unusable you are now either</font>

254
00:10:58,709 --> 00:11:03,599
forced to switch passwords switch IP

255
00:11:01,199 --> 00:11:05,309
addresses switch ports switch your<font color="#CCCCCC"> whole</font>

256
00:11:03,600 --> 00:11:06,480
infrastructure which now means that

257
00:11:05,309 --> 00:11:09,329
whole campaign you've just done

258
00:11:06,480 --> 00:11:10,649
completely useless to you anybody else

259
00:11:09,329 --> 00:11:12,089
you've wanted<font color="#E5E5E5"> to affect if you haven't</font>

260
00:11:10,649 --> 00:11:13,939
just targeted me you've targeted to

261
00:11:12,089 --> 00:11:16,410
other people on the same infrastructure

262
00:11:13,939 --> 00:11:18,329
there now useless to you as well because

263
00:11:16,410 --> 00:11:20,249
you can no longer figure out what are

264
00:11:18,329 --> 00:11:21,479
the real connections from the thousands

265
00:11:20,249 --> 00:11:25,019
of connections i'm sending you every

266
00:11:21,480 --> 00:11:28,170
second that's one way of doing it the

267
00:11:25,019 --> 00:11:31,139
other way<font color="#E5E5E5"> is to exploit the attacker so</font>

268
00:11:28,170 --> 00:11:33,748
a couple of big ones poison ivy and dark

269
00:11:31,139 --> 00:11:35,790
comet they're<font color="#E5E5E5"> well-known they're well</font>

270
00:11:33,749 --> 00:11:37,949
used and they've been used by<font color="#E5E5E5"> apt groups</font>

271
00:11:35,790 --> 00:11:40,019
for the last several years and<font color="#E5E5E5"> they're</font>

272
00:11:37,949 --> 00:11:42,329
still being<font color="#E5E5E5"> used now there are two</font>

273
00:11:40,019 --> 00:11:44,699
public exploits poison<font color="#CCCCCC"> ivy has a</font>

274
00:11:42,329 --> 00:11:48,420
metaphoric module so if you know the

275
00:11:44,699 --> 00:11:49,920
<font color="#CCCCCC">password the poor and the IP address you</font>

276
00:11:48,420 --> 00:11:51,809
can<font color="#CCCCCC"> actually get a remote shell on the</font>

277
00:11:49,920 --> 00:11:53,939
<font color="#E5E5E5">box</font><font color="#CCCCCC"> well they sent us all that</font>

278
00:11:51,809 --> 00:11:56,249
information inside the EXIF file so

279
00:11:53,939 --> 00:11:58,410
there we go<font color="#E5E5E5"> anybody poison ivy and plant</font>

280
00:11:56,249 --> 00:12:03,929
<font color="#CCCCCC">i can now start chopping shells on your</font>

281
00:11:58,410 --> 00:12:07,499
box i currently have<font color="#E5E5E5"> 13 and a half</font>

282
00:12:03,929 --> 00:12:10,199
thousand live poison ivy domains and

283
00:12:07,499 --> 00:12:11,369
passwords so there's a whole lot of

284
00:12:10,199 --> 00:12:14,669
infrastructure out there you<font color="#CCCCCC"> can just</font>

285
00:12:11,369 --> 00:12:16,259
<font color="#E5E5E5">start going to take and control of that</font>

286
00:12:14,669 --> 00:12:18,239
comment against without comment there's

287
00:12:16,259 --> 00:12:19,980
there's no remote code execution but

288
00:12:18,239 --> 00:12:22,679
what there is for comet is<font color="#CCCCCC"> are with your</font>

289
00:12:19,980 --> 00:12:24,569
<font color="#E5E5E5">file access so if</font><font color="#CCCCCC"> i know a file</font><font color="#E5E5E5"> half on</font>

290
00:12:22,679 --> 00:12:25,949
your<font color="#CCCCCC"> machine you the attacker</font><font color="#E5E5E5"> i can just</font>

291
00:12:24,569 --> 00:12:27,120
<font color="#CCCCCC">go and download that file from your</font>

292
00:12:25,949 --> 00:12:30,870
machine

293
00:12:27,120 --> 00:12:33,480
back to me this<font color="#E5E5E5"> has one really really</font>

294
00:12:30,870 --> 00:12:36,300
useful thing the<font color="#CCCCCC"> Wade outcome it works</font>

295
00:12:33,480 --> 00:12:38,790
is it logs every single connection every

296
00:12:36,300 --> 00:12:40,079
connection attempt and all the

297
00:12:38,790 --> 00:12:41,339
information<font color="#E5E5E5"> that comes back with it is</font>

298
00:12:40,080 --> 00:12:44,040
logged and sword in ask you like

299
00:12:41,339 --> 00:12:46,920
database that she like databases in one

300
00:12:44,040 --> 00:12:49,349
place so using<font color="#CCCCCC"> my arbitrary far read I</font>

301
00:12:46,920 --> 00:12:50,969
can now go pull that database down that

302
00:12:49,350 --> 00:12:53,850
tells me anybody<font color="#CCCCCC"> who has ever connected</font>

303
00:12:50,970 --> 00:12:55,170
to your machine it gives me all their

304
00:12:53,850 --> 00:12:56,520
key<font color="#E5E5E5"> logs as well so every piece of</font>

305
00:12:55,170 --> 00:13:00,510
information you've just managed to

306
00:12:56,520 --> 00:13:03,510
scrape I now also have<font color="#E5E5E5"> that as well and</font>

307
00:13:00,510 --> 00:13:05,520
there are a lot more most of the rats

308
00:13:03,510 --> 00:13:07,560
that<font color="#CCCCCC"> are out there have some sort of</font>

309
00:13:05,520 --> 00:13:09,600
vulnerability in them that if you were

310
00:13:07,560 --> 00:13:11,130
to take the time when<font color="#E5E5E5"> the research to go</font>

311
00:13:09,600 --> 00:13:13,980
through you could probably find yourself

312
00:13:11,130 --> 00:13:15,750
doing the the more offensive side<font color="#CCCCCC"> of</font>

313
00:13:13,980 --> 00:13:18,390
this again not advocating that everybody

314
00:13:15,750 --> 00:13:25,830
starts hacking script kiddies but it's

315
00:13:18,390 --> 00:13:29,580
an option so like I said I have a large

316
00:13:25,830 --> 00:13:31,050
data set and I like to share I've spent

317
00:13:29,580 --> 00:13:32,339
<font color="#E5E5E5">a lot of time doing the research and</font>

318
00:13:31,050 --> 00:13:33,359
rather<font color="#E5E5E5"> than just keeping it all to</font>

319
00:13:32,339 --> 00:13:39,570
myself I like to share with<font color="#E5E5E5"> the</font>

320
00:13:33,360 --> 00:13:41,400
community as I said<font color="#CCCCCC"> IOC files I know the</font>

321
00:13:39,570 --> 00:13:43,980
industry hasn't really settled on an<font color="#CCCCCC"> IOC</font>

322
00:13:41,400 --> 00:13:46,910
format so for those of you not familiar

323
00:13:43,980 --> 00:13:49,320
with<font color="#E5E5E5"> IOC it's an indicator of compromise</font>

324
00:13:46,910 --> 00:13:51,660
and these are files you can create that

325
00:13:49,320 --> 00:13:53,190
you can share with admins and and other

326
00:13:51,660 --> 00:13:56,010
providers and you can use<font color="#E5E5E5"> these to</font>

327
00:13:53,190 --> 00:13:59,190
identify infections there's lots<font color="#E5E5E5"> of them</font>

328
00:13:56,010 --> 00:14:02,640
there's open IOC sticks taxi there are

329
00:13:59,190 --> 00:14:04,529
<font color="#E5E5E5">plenty of formats out there IOC bucket</font>

330
00:14:02,640 --> 00:14:07,050
is the services up and running where you

331
00:14:04,529 --> 00:14:08,910
can share these are seized every<font color="#E5E5E5"> rap</font>

332
00:14:07,050 --> 00:14:13,199
that lands on that gets processed by my

333
00:14:08,910 --> 00:14:15,110
box I extract the<font color="#CCCCCC"> file path the</font><font color="#E5E5E5"> register</font>

334
00:14:13,200 --> 00:14:17,910
Keys the mutex is the domains the<font color="#E5E5E5"> ports</font>

335
00:14:15,110 --> 00:14:20,010
create an<font color="#E5E5E5"> IOC file to that and that gets</font>

336
00:14:17,910 --> 00:14:21,959
pushed over to ioc bucket as well so

337
00:14:20,010 --> 00:14:24,000
it's<font color="#E5E5E5"> a massive repository of known</font>

338
00:14:21,959 --> 00:14:26,310
malware when the real useful things

339
00:14:24,000 --> 00:14:28,650
about this method it's impossible<font color="#CCCCCC"> to</font>

340
00:14:26,310 --> 00:14:30,420
have a false positive you've extracted

341
00:14:28,650 --> 00:14:33,029
the config straight out of the sample

342
00:14:30,420 --> 00:14:36,860
exactly to this so it's impossible<font color="#CCCCCC"> to</font>

343
00:14:33,029 --> 00:14:39,600
get a<font color="#E5E5E5"> false positive on that</font><font color="#CCCCCC"> virus total</font>

344
00:14:36,860 --> 00:14:40,880
they have<font color="#CCCCCC"> every sample so any sample is</font>

345
00:14:39,600 --> 00:14:42,950
submitted to me

346
00:14:40,880 --> 00:14:45,290
take virustotal if virustotal has it

347
00:14:42,950 --> 00:14:48,650
i'll link to<font color="#E5E5E5"> them and say here's more</font>

348
00:14:45,290 --> 00:14:50,060
information on it and then if they don't

349
00:14:48,650 --> 00:14:51,770
have<font color="#CCCCCC"> it i'll push the sample up to them</font>

350
00:14:50,060 --> 00:14:55,250
and then there's a big<font color="#E5E5E5"> cross-reference</font>

351
00:14:51,770 --> 00:14:58,850
<font color="#E5E5E5">their standalone decoders</font><font color="#CCCCCC"> i mentioned</font>

352
00:14:55,250 --> 00:15:03,020
this earlier so I've done 23 so far i

353
00:14:58,850 --> 00:15:05,060
have another 26 or two right so head

354
00:15:03,020 --> 00:15:06,590
over to my get pull these decoders down

355
00:15:05,060 --> 00:15:09,050
and you<font color="#E5E5E5"> can just run these they're just</font>

356
00:15:06,590 --> 00:15:15,520
piping on pretty much standard Python

357
00:15:09,050 --> 00:15:15,520
<font color="#E5E5E5">about the modules and then</font><font color="#CCCCCC"> Marvel config</font>

358
00:15:17,890 --> 00:15:25,520
so I've got links at the end the other

359
00:15:22,370 --> 00:15:29,150
thing I've done anybody in fact<font color="#E5E5E5"> does</font>

360
00:15:25,520 --> 00:15:32,120
reverse engineering in here really<font color="#CCCCCC"> is in</font>

361
00:15:29,150 --> 00:15:37,640
my crowd is it sorry for<font color="#CCCCCC"> those of you on</font>

362
00:15:32,120 --> 00:15:40,070
boring so Viper is made by a guy who who

363
00:15:37,640 --> 00:15:41,949
wrote cooker with an automated<font color="#CCCCCC"> allows</font>

364
00:15:40,070 --> 00:15:44,690
<font color="#E5E5E5">his platform he works for rapid seven</font>

365
00:15:41,950 --> 00:15:45,920
and it's a framework there's a modular

366
00:15:44,690 --> 00:15:47,870
framework for reverse engineering

367
00:15:45,920 --> 00:15:50,089
malware so gone are the days where<font color="#CCCCCC"> you</font>

368
00:15:47,870 --> 00:15:51,590
need geeks like me to sit and stare at

369
00:15:50,090 --> 00:15:53,420
<font color="#CCCCCC">the assembly and figure this all out of</font>

370
00:15:51,590 --> 00:15:55,610
you there were nice modular frameworks

371
00:15:53,420 --> 00:15:59,449
where anybody with a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of</font>

372
00:15:55,610 --> 00:16:01,190
knowledge can just open up vipre import

373
00:15:59,450 --> 00:16:05,150
the<font color="#CCCCCC"> XE</font><font color="#E5E5E5"> file and then just run modules</font>

374
00:16:01,190 --> 00:16:07,610
like rat analysis and then it<font color="#CCCCCC"> just pops</font>

375
00:16:05,150 --> 00:16:09,949
straight out so you don't<font color="#CCCCCC"> need to</font><font color="#E5E5E5"> rely</font>

376
00:16:07,610 --> 00:16:11,480
on if you're working<font color="#E5E5E5"> for small business</font>

377
00:16:09,950 --> 00:16:13,940
who still getting targeted by these and

378
00:16:11,480 --> 00:16:15,950
you can't afford<font color="#CCCCCC"> to either outsource or</font>

379
00:16:13,940 --> 00:16:18,050
create your own<font color="#CCCCCC"> reverse-engineer miram</font>

380
00:16:15,950 --> 00:16:19,370
our team then things<font color="#E5E5E5"> like this</font><font color="#CCCCCC"> exist out</font>

381
00:16:18,050 --> 00:16:20,990
on the<font color="#E5E5E5"> internet where you can go and use</font>

382
00:16:19,370 --> 00:16:23,240
these as long as<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> not too</font>

383
00:16:20,990 --> 00:16:26,290
concerned about publicly broadcast and

384
00:16:23,240 --> 00:16:26,290
this is lots of this other

385
00:16:29,530 --> 00:16:35,360
there's a<font color="#CCCCCC"> screecher working so more</font>

386
00:16:33,980 --> 00:16:37,100
conflict like<font color="#E5E5E5"> I said it's a public site</font>

387
00:16:35,360 --> 00:16:38,780
that I've setup allows you to submit

388
00:16:37,100 --> 00:16:43,330
files up<font color="#CCCCCC"> to be analyzed and you can</font>

389
00:16:38,780 --> 00:16:43,329
search and there is an API coming soon

390
00:16:46,330 --> 00:16:51,260
these are sort of things<font color="#E5E5E5"> that will pull</font>

391
00:16:48,170 --> 00:16:54,650
out so there<font color="#E5E5E5"> you can see this was a</font>

392
00:16:51,260 --> 00:16:58,280
sample of poison ivy this is<font color="#CCCCCC"> non</font>

393
00:16:54,650 --> 00:17:00,050
interactive analysis so at no point do<font color="#E5E5E5"> I</font>

394
00:16:58,280 --> 00:17:01,400
run<font color="#E5E5E5"> the executable file and allow</font><font color="#CCCCCC"> it to</font>

395
00:17:00,050 --> 00:17:02,780
connect out to the into that I don't

396
00:17:01,400 --> 00:17:05,420
allow it<font color="#CCCCCC"> to connect back to the attack</font>

397
00:17:02,780 --> 00:17:07,730
aside it's all run on interactive or

398
00:17:05,420 --> 00:17:09,320
static<font color="#CCCCCC"> analysis so there's no way the</font>

399
00:17:07,730 --> 00:17:11,540
bad guys unless<font color="#E5E5E5"> they come and search the</font>

400
00:17:09,319 --> 00:17:14,510
site will see these connections coming

401
00:17:11,540 --> 00:17:17,810
in so you get all the values<font color="#CCCCCC"> in the</font>

402
00:17:14,510 --> 00:17:20,959
config file there's a virus total<font color="#E5E5E5"> look</font>

403
00:17:17,810 --> 00:17:22,458
up will do the domain an IP lookup so if

404
00:17:20,959 --> 00:17:25,010
there's a domain name it'll<font color="#E5E5E5"> grab you the</font>

405
00:17:22,459 --> 00:17:27,680
IP if it's got an IP org of the country

406
00:17:25,010 --> 00:17:29,120
code so if you start plotting all this

407
00:17:27,680 --> 00:17:30,440
together you can<font color="#E5E5E5"> really start to pull</font>

408
00:17:29,120 --> 00:17:33,409
together some some really interesting

409
00:17:30,440 --> 00:17:35,600
piece of information and<font color="#E5E5E5"> for those of</font>

410
00:17:33,410 --> 00:17:38,480
you in an<font color="#E5E5E5"> IDs this will automatically</font>

411
00:17:35,600 --> 00:17:40,040
generate you a snort rule so you can

412
00:17:38,480 --> 00:17:43,040
deploy this straight onto a sensor and

413
00:17:40,040 --> 00:17:46,720
you've got immediate media alerts to any

414
00:17:43,040 --> 00:17:52,370
time this land on<font color="#E5E5E5"> your box</font><font color="#CCCCCC"> yawn rules</font>

415
00:17:46,720 --> 00:17:53,690
<font color="#CCCCCC">yarra is I like to yard snort for for</font>

416
00:17:52,370 --> 00:17:55,520
malware but again I'm talking to my

417
00:17:53,690 --> 00:17:58,670
audience so I'm<font color="#E5E5E5"> afraid knowledge you can</font>

418
00:17:55,520 --> 00:18:00,639
understand that so Yara's

419
00:17:58,670 --> 00:18:03,110
signature-based detection on the host so

420
00:18:00,640 --> 00:18:05,390
<font color="#CCCCCC">IDs intrusion detection systems</font><font color="#E5E5E5"> these</font>

421
00:18:03,110 --> 00:18:07,010
look at the network analysis and these

422
00:18:05,390 --> 00:18:08,420
look at all the ones<font color="#E5E5E5"> and</font><font color="#CCCCCC"> zeros crossing</font>

423
00:18:07,010 --> 00:18:11,120
the wire and they'll analyze that and

424
00:18:08,420 --> 00:18:12,740
they'll alert you on that yard does the

425
00:18:11,120 --> 00:18:16,389
same sort of principle except it works

426
00:18:12,740 --> 00:18:18,620
on your<font color="#E5E5E5"> box so it's a bit like antivirus</font>

427
00:18:16,390 --> 00:18:21,260
except that this is a lot<font color="#CCCCCC"> more powerful</font>

428
00:18:18,620 --> 00:18:23,479
<font color="#CCCCCC">than you antivirus antivirus is tend to</font>

429
00:18:21,260 --> 00:18:26,840
use more heuristic analysis than they do

430
00:18:23,480 --> 00:18:30,170
with with string analysis and they rely

431
00:18:26,840 --> 00:18:33,290
more on looking at what happens when a

432
00:18:30,170 --> 00:18:35,060
file runs so pretty<font color="#E5E5E5"> much everybody</font>

433
00:18:33,290 --> 00:18:37,460
should know that antivirus is fairly

434
00:18:35,060 --> 00:18:39,950
<font color="#E5E5E5">well broken and can be trivially</font>

435
00:18:37,460 --> 00:18:42,380
bypassed innovated as far as static

436
00:18:39,950 --> 00:18:42,890
analysis goes well it's really<font color="#E5E5E5"> hard to</font>

437
00:18:42,380 --> 00:18:47,000
trick on

438
00:18:42,890 --> 00:18:50,240
taveras is at runtime so DLL injection

439
00:18:47,000 --> 00:18:52,670
process injection nobody<font color="#E5E5E5"> will be doing</font>

440
00:18:50,240 --> 00:18:55,640
these things so<font color="#E5E5E5"> av's got really good at</font>

441
00:18:52,670 --> 00:18:58,820
detecting that<font color="#CCCCCC"> yarra applies these sort</font>

442
00:18:55,640 --> 00:19:00,290
of principles to a static analysis and

443
00:18:58,820 --> 00:19:04,220
they're<font color="#E5E5E5"> really</font><font color="#CCCCCC"> good at identifying</font>

444
00:19:00,290 --> 00:19:06,590
malware families and as we said before

445
00:19:04,220 --> 00:19:09,530
you can jump our IRC file so you can

446
00:19:06,590 --> 00:19:11,689
Nativity<font color="#CCCCCC"> police ioc's so the</font><font color="#E5E5E5"> IOC that's</font>

447
00:19:09,530 --> 00:19:15,560
being used in a minute<font color="#CCCCCC"> is Mandiant's or</font>

448
00:19:11,690 --> 00:19:17,090
monday and fire eyes open<font color="#E5E5E5"> IRC format so</font>

449
00:19:15,560 --> 00:19:19,760
if you<font color="#CCCCCC"> think you've been infected with</font>

450
00:19:17,090 --> 00:19:22,970
one of these rats you pushed up tomorrow

451
00:19:19,760 --> 00:19:26,540
config you download the<font color="#CCCCCC"> IOC file you</font>

452
00:19:22,970 --> 00:19:29,060
then deploy Mandiant's IOC agent across

453
00:19:26,540 --> 00:19:31,310
your entire estate upload this one file

454
00:19:29,060 --> 00:19:33,980
it will instantly tell you every machine

455
00:19:31,310 --> 00:19:36,200
that's infected with it so you<font color="#E5E5E5"> don't</font>

456
00:19:33,980 --> 00:19:38,120
<font color="#E5E5E5">need</font><font color="#CCCCCC"> to pay big instant response teams</font>

457
00:19:36,200 --> 00:19:39,980
to come in you don't need to<font color="#E5E5E5"> do a lot of</font>

458
00:19:38,120 --> 00:19:43,070
this work itself with freely available

459
00:19:39,980 --> 00:19:46,250
tools and freely available resources you

460
00:19:43,070 --> 00:19:47,960
can now just upload download scan and

461
00:19:46,250 --> 00:19:53,000
get a full indication of if your

462
00:19:47,960 --> 00:19:56,030
networks compromised don't know so as<font color="#CCCCCC"> I</font>

463
00:19:53,000 --> 00:19:57,590
<font color="#CCCCCC">said I'd like</font><font color="#E5E5E5"> to share so as I'm</font>

464
00:19:56,030 --> 00:20:00,710
building this database I'm building a

465
00:19:57,590 --> 00:20:03,379
massive massive list of known bad

466
00:20:00,710 --> 00:20:06,950
malware and what's of most interest to

467
00:20:03,380 --> 00:20:10,790
people is this information so that the

468
00:20:06,950 --> 00:20:13,010
main names the IP addresses so most

469
00:20:10,790 --> 00:20:14,750
about guys what they like to do is they

470
00:20:13,010 --> 00:20:18,830
don't<font color="#E5E5E5"> like using their own IP address</font>

471
00:20:14,750 --> 00:20:20,780
they'll use dynamic dns and the big ones

472
00:20:18,830 --> 00:20:24,949
are again this really poor<font color="#E5E5E5"> quality on</font>

473
00:20:20,780 --> 00:20:27,500
there it's no IP<font color="#CCCCCC"> dine</font><font color="#E5E5E5"> dns zap total org</font>

474
00:20:24,950 --> 00:20:30,050
all these free dns providers where you

475
00:20:27,500 --> 00:20:32,300
just sign up get a domain name and<font color="#E5E5E5"> then</font>

476
00:20:30,050 --> 00:20:34,370
associated<font color="#E5E5E5"> with your IP address this</font>

477
00:20:32,300 --> 00:20:35,899
means you<font color="#CCCCCC"> can change IP address you can</font>

478
00:20:34,370 --> 00:20:37,850
<font color="#E5E5E5">change the main names very trivially</font>

479
00:20:35,900 --> 00:20:41,030
without having to read the<font color="#E5E5E5"> euro your</font>

480
00:20:37,850 --> 00:20:44,230
whole situ infrastructure what it does

481
00:20:41,030 --> 00:20:46,520
winds its way of us to track you though

482
00:20:44,230 --> 00:20:49,400
recently I upset a couple of thousand

483
00:20:46,520 --> 00:20:51,980
script kiddies so I run several thousand

484
00:20:49,400 --> 00:20:55,460
samples through this pulled out two

485
00:20:51,980 --> 00:20:58,070
thousand eight hundred no IP dine dns

486
00:20:55,460 --> 00:20:59,750
and lots more domain names I reached out

487
00:20:58,070 --> 00:21:01,668
to<font color="#CCCCCC"> a cup of the security list</font><font color="#E5E5E5"> someone</font>

488
00:20:59,750 --> 00:21:03,200
and said you know<font color="#E5E5E5"> anybody have any idea</font>

489
00:21:01,669 --> 00:21:06,429
what<font color="#E5E5E5"> I can do with this data I've got it</font>

490
00:21:03,200 --> 00:21:09,350
I can't use it can anybody else<font color="#E5E5E5"> use it</font>

491
00:21:06,429 --> 00:21:12,740
within hours<font color="#E5E5E5"> I had got responses back</font>

492
00:21:09,350 --> 00:21:14,600
from godaddy from no IP from<font color="#CCCCCC"> dan dns in</font>

493
00:21:12,740 --> 00:21:17,120
give me that information give me those

494
00:21:14,600 --> 00:21:20,899
IP addresses and<font color="#E5E5E5"> they then</font><font color="#CCCCCC"> canceled all</font>

495
00:21:17,120 --> 00:21:22,908
the accounts so it's really funny from

496
00:21:20,899 --> 00:21:25,879
<font color="#E5E5E5">my cell so as I'm doing all this</font>

497
00:21:22,909 --> 00:21:28,190
research as I'm analyzing these routes I

498
00:21:25,880 --> 00:21:29,690
have to go out<font color="#CCCCCC"> and get the actual build</font>

499
00:21:28,190 --> 00:21:31,429
kit so<font color="#E5E5E5"> I have to go into the underground</font>

500
00:21:29,690 --> 00:21:32,960
forums and into we're all the script

501
00:21:31,429 --> 00:21:35,210
kiddies are where they get their tool so

502
00:21:32,960 --> 00:21:37,659
I can get<font color="#E5E5E5"> them as well so I've been in</font>

503
00:21:35,210 --> 00:21:40,580
there I've<font color="#CCCCCC"> got the tools i go i</font>

504
00:21:37,659 --> 00:21:44,120
published the paper a couple<font color="#E5E5E5"> of weeks</font>

505
00:21:40,580 --> 00:21:46,000
<font color="#E5E5E5">ago all those get taken down</font><font color="#CCCCCC"> i go back</font>

506
00:21:44,120 --> 00:21:48,289
<font color="#E5E5E5">in to check and see if there any updates</font>

507
00:21:46,000 --> 00:21:50,690
and there's lots<font color="#E5E5E5"> of entries of kids</font>

508
00:21:48,289 --> 00:21:52,700
crying because<font color="#CCCCCC"> there's no IP accounts</font>

509
00:21:50,690 --> 00:21:54,260
are being<font color="#CCCCCC"> cancelled and I've lost all my</font>

510
00:21:52,700 --> 00:21:57,169
slaves and I can't spy on the pretty

511
00:21:54,260 --> 00:21:59,809
girls anymore so it's very funny it's

512
00:21:57,169 --> 00:22:01,850
really gratifying when you<font color="#CCCCCC"> can publish</font>

513
00:21:59,809 --> 00:22:05,149
<font color="#E5E5E5">this sort of work and you see that sort</font>

514
00:22:01,850 --> 00:22:07,699
response so I'm a superhero I've just

515
00:22:05,149 --> 00:22:12,168
<font color="#CCCCCC">saved I have just saved people's</font>

516
00:22:07,700 --> 00:22:13,610
internet and that's how I see myself so

517
00:22:12,169 --> 00:22:17,000
yeah there's a lot<font color="#CCCCCC"> you can get out of</font>

518
00:22:13,610 --> 00:22:20,418
this like I said it's all about showing

519
00:22:17,000 --> 00:22:22,970
a lot of<font color="#E5E5E5"> people that the community used</font>

520
00:22:20,419 --> 00:22:24,350
to take this information and they sit on

521
00:22:22,970 --> 00:22:26,659
<font color="#E5E5E5">it you know this is mine this is an</font>

522
00:22:24,350 --> 00:22:28,699
attack against me<font color="#E5E5E5"> I'm not going to lease</font>

523
00:22:26,659 --> 00:22:29,899
ended this information and what really

524
00:22:28,700 --> 00:22:31,580
kicks off was that was<font color="#E5E5E5"> actually in</font>

525
00:22:29,899 --> 00:22:32,928
mandan with the apt one<font color="#E5E5E5"> report is</font>

526
00:22:31,580 --> 00:22:36,379
anybody not familiar with the<font color="#E5E5E5"> apt one</font>

527
00:22:32,929 --> 00:22:38,000
<font color="#E5E5E5">report yes sir they were really bigger</font>

528
00:22:36,380 --> 00:22:39,440
you<font color="#E5E5E5"> know saying you know with enough is</font>

529
00:22:38,000 --> 00:22:42,470
enough we're really going<font color="#E5E5E5"> to start</font>

530
00:22:39,440 --> 00:22:46,279
outing people and that's what this is is

531
00:22:42,470 --> 00:22:48,380
hoping to<font color="#E5E5E5"> contribute to I have all this</font>

532
00:22:46,279 --> 00:22:49,760
information I have all these lists of

533
00:22:48,380 --> 00:22:51,649
bad people doing bad things on the

534
00:22:49,760 --> 00:22:53,960
internet and they're not just script

535
00:22:51,649 --> 00:22:56,689
kiddies then they're not just kids

536
00:22:53,960 --> 00:22:58,250
looking at girls cameras there's apt

537
00:22:56,690 --> 00:23:00,649
groups there's a crime groups there<font color="#CCCCCC"> are</font>

538
00:22:58,250 --> 00:23:05,720
people on here making absolute fortunes

539
00:23:00,649 --> 00:23:07,969
out of your computers so if I can run

540
00:23:05,720 --> 00:23:09,020
this and start sharing that information

541
00:23:07,970 --> 00:23:11,300
then

542
00:23:09,020 --> 00:23:16,160
safer based on then more than<font color="#CCCCCC"> marry</font><font color="#E5E5E5"> for</font>

543
00:23:11,300 --> 00:23:19,760
it so the future<font color="#E5E5E5"> I said I've created</font>

544
00:23:16,160 --> 00:23:22,250
about 23 so far I have 26 more which I'm

545
00:23:19,760 --> 00:23:25,190
in the process of writing so releasing

546
00:23:22,250 --> 00:23:28,430
those soon expanded to other malware

547
00:23:25,190 --> 00:23:29,780
families so for the last few<font color="#CCCCCC"> months</font><font color="#E5E5E5"> will</font>

548
00:23:28,430 --> 00:23:31,910
for the last eight months I've been

549
00:23:29,780 --> 00:23:34,550
researching only rats only with my taxes

550
00:23:31,910 --> 00:23:36,380
Trojans but as I've been<font color="#E5E5E5"> grabbing build</font>

551
00:23:34,550 --> 00:23:40,250
kits<font color="#E5E5E5"> there's a lot of</font><font color="#CCCCCC"> time over</font><font color="#E5E5E5"> between</font>

552
00:23:36,380 --> 00:23:42,050
things like keyloggers Zeus SpyEye they

553
00:23:40,250 --> 00:23:44,390
all use very similar tactics they've all

554
00:23:42,050 --> 00:23:46,250
got a configuration file this included

555
00:23:44,390 --> 00:23:49,070
<font color="#E5E5E5">in the malware they send to you they're</font>

556
00:23:46,250 --> 00:23:50,330
giving us everything we need so I'm

557
00:23:49,070 --> 00:23:51,740
expanding out to those forms as well

558
00:23:50,330 --> 00:23:53,840
using the same techniques and principles

559
00:23:51,740 --> 00:23:56,960
that I apply to rats applying it to

560
00:23:53,840 --> 00:23:58,699
<font color="#E5E5E5">those as well reverse engineering to the</font>

561
00:23:56,960 --> 00:24:00,530
masses you don't need a reverse

562
00:23:58,700 --> 00:24:02,810
engineering degrees to run this stuff

563
00:24:00,530 --> 00:24:06,440
it's a little bit of logic run my script

564
00:24:02,810 --> 00:24:08,210
and away you go volatility plugins again

565
00:24:06,440 --> 00:24:11,860
really focusing this<font color="#E5E5E5"> to the wrong</font>

566
00:24:08,210 --> 00:24:14,270
audience if you<font color="#CCCCCC"> do an instant response</font>

567
00:24:11,860 --> 00:24:16,490
it's one thing having the EXIF file then

568
00:24:14,270 --> 00:24:17,660
you can pull this con figure out most of

569
00:24:16,490 --> 00:24:20,120
time if you're going<font color="#E5E5E5"> into instant</font>

570
00:24:17,660 --> 00:24:22,490
response you're arriving after the fact

571
00:24:20,120 --> 00:24:24,260
<font color="#E5E5E5">so the sexy father was on those probably</font>

572
00:24:22,490 --> 00:24:29,150
<font color="#E5E5E5">gone now to replace</font><font color="#CCCCCC"> with other stages of</font>

573
00:24:24,260 --> 00:24:30,920
malware but everything's in memory<font color="#CCCCCC"> so</font>

574
00:24:29,150 --> 00:24:32,440
though<font color="#E5E5E5"> I'm currently writing volatility</font>

575
00:24:30,920 --> 00:24:34,790
plugins that do exactly the same thing

576
00:24:32,440 --> 00:24:36,650
they'll take<font color="#CCCCCC"> a memory sample they'll</font>

577
00:24:34,790 --> 00:24:38,450
look for<font color="#CCCCCC"> those indicators they look for</font>

578
00:24:36,650 --> 00:24:40,940
those things that mark this is piece of

579
00:24:38,450 --> 00:24:42,170
<font color="#E5E5E5">malware i extracted out I mean exactly</font>

580
00:24:40,940 --> 00:24:46,490
the same thing give you all that

581
00:24:42,170 --> 00:24:48,980
information and then<font color="#E5E5E5"> I said they'll be</font>

582
00:24:46,490 --> 00:24:50,330
coming to a get near you soon ish as

583
00:24:48,980 --> 00:24:52,730
soon<font color="#E5E5E5"> as I</font><font color="#CCCCCC"> finish</font><font color="#E5E5E5"> writing them it's</font>

584
00:24:50,330 --> 00:24:56,629
<font color="#E5E5E5">really hard right in all this</font><font color="#CCCCCC"> widely w</font>

585
00:24:52,730 --> 00:25:00,530
data as well again<font color="#CCCCCC"> apology sir I didn't</font>

586
00:24:56,630 --> 00:25:03,500
anticipate the slides these are<font color="#E5E5E5"> I like</font>

587
00:25:00,530 --> 00:25:05,300
to<font color="#CCCCCC"> stand on the shoulders of giants if</font>

588
00:25:03,500 --> 00:25:07,670
somebody else has done the hard work<font color="#CCCCCC"> for</font>

589
00:25:05,300 --> 00:25:09,740
me then I will happily take their

590
00:25:07,670 --> 00:25:11,330
research and then build on that but<font color="#E5E5E5"> I</font>

591
00:25:09,740 --> 00:25:14,510
won't seal it for myself I'll actually

592
00:25:11,330 --> 00:25:16,839
<font color="#E5E5E5">um give them credit which I've hidden</font>

593
00:25:14,510 --> 00:25:20,719
see nobody can read it

594
00:25:16,839 --> 00:25:22,129
<font color="#E5E5E5">so the guys at marbar</font><font color="#CCCCCC"> lu one</font><font color="#E5E5E5"> of the</font>

595
00:25:20,719 --> 00:25:23,839
first pieces of malware<font color="#CCCCCC"> oversight to</font>

596
00:25:22,129 --> 00:25:27,019
research was extreme the guys at Marvel

597
00:25:23,839 --> 00:25:28,969
you they were really nice writeup fire

598
00:25:27,019 --> 00:25:30,529
right man diem they're constantly

599
00:25:28,969 --> 00:25:36,259
releasing more information out to the

600
00:25:30,529 --> 00:25:38,359
public who else is on the motsognir so

601
00:25:36,259 --> 00:25:40,999
there<font color="#E5E5E5"> are a couple of guys they wrote a</font>

602
00:25:38,359 --> 00:25:43,699
paper looking<font color="#E5E5E5"> at offensively targeting</font>

603
00:25:40,999 --> 00:25:46,190
rats it's a really good<font color="#E5E5E5"> paper they</font>

604
00:25:43,700 --> 00:25:47,869
didn't look at the<font color="#E5E5E5"> static decode side of</font>

605
00:25:46,190 --> 00:25:49,509
stuff but as part<font color="#E5E5E5"> of their research they</font>

606
00:25:47,869 --> 00:25:52,458
figured<font color="#E5E5E5"> out all the encryption schemes</font>

607
00:25:49,509 --> 00:25:54,409
which means when I always put in my work

608
00:25:52,459 --> 00:26:00,739
together it was three less steps i had

609
00:25:54,409 --> 00:26:06,219
to do so they<font color="#E5E5E5"> saved me a lot of work are</font>

610
00:26:00,739 --> 00:26:06,219
there any questions yes

611
00:26:12,510 --> 00:26:18,070
so there are you can't<font color="#E5E5E5"> really have a</font>

612
00:26:16,870 --> 00:26:20,199
remote choice that doesn't carry its own

613
00:26:18,070 --> 00:26:22,809
configures there by native<font color="#CCCCCC"> their reverse</font>

614
00:26:20,200 --> 00:26:25,840
connection so the only way you do that

615
00:26:22,809 --> 00:26:28,000
is if you<font color="#E5E5E5"> have a listener so I drop</font>

616
00:26:25,840 --> 00:26:30,490
something on your box and<font color="#E5E5E5"> then I have</font><font color="#CCCCCC"> to</font>

617
00:26:28,000 --> 00:26:32,110
actively connect to you and then I

618
00:26:30,490 --> 00:26:34,330
connect to you when I'm telling you so

619
00:26:32,110 --> 00:26:36,040
you're only listening so all<font color="#E5E5E5"> you have to</font>

620
00:26:34,330 --> 00:26:39,960
<font color="#CCCCCC">know is a port number and possibly a</font>

621
00:26:36,040 --> 00:26:42,879
password to<font color="#CCCCCC"> authenticate my connection</font>

622
00:26:39,960 --> 00:26:45,549
they don't really<font color="#E5E5E5"> do that the way rats</font>

623
00:26:42,880 --> 00:26:47,049
were designed is they because of<font color="#CCCCCC"> the way</font>

624
00:26:45,549 --> 00:26:49,389
reverse connections work these things

625
00:26:47,049 --> 00:26:52,780
sales straight through firewalls because

626
00:26:49,390 --> 00:26:53,919
we implicitly trust the inside to turn

627
00:26:52,780 --> 00:26:57,570
that all the way through rather<font color="#E5E5E5"> than</font>

628
00:26:53,919 --> 00:27:03,010
blocking walking to the way so you could

629
00:26:57,570 --> 00:27:07,809
I've researched 132 rats I have yet to

630
00:27:03,010 --> 00:27:10,809
see one that doesn't do that with one

631
00:27:07,809 --> 00:27:15,370
exception there is a family<font color="#CCCCCC"> of rats that</font>

632
00:27:10,809 --> 00:27:17,799
are PHP based so they<font color="#CCCCCC"> launch a web</font>

633
00:27:15,370 --> 00:27:21,939
interface web shell on your box rather

634
00:27:17,799 --> 00:27:23,230
than a a remote connection basically

635
00:27:21,940 --> 00:27:24,730
it's the same sort of principle it still

636
00:27:23,230 --> 00:27:27,299
has<font color="#CCCCCC"> to contain all that's</font><font color="#E5E5E5"> all the sort</font>

637
00:27:24,730 --> 00:27:27,299
<font color="#E5E5E5">of</font><font color="#CCCCCC"> information</font>

638
00:27:38,510 --> 00:27:45,890
yes so Zeus does this so Zeus isn't a

639
00:27:44,100 --> 00:27:48,240
remote access Trojan it's a botnet

640
00:27:45,890 --> 00:27:50,640
although it has the same<font color="#CCCCCC"> kind of fun</font>

641
00:27:48,240 --> 00:27:52,620
counting what that does is it has a

642
00:27:50,640 --> 00:27:56,100
single look up and what it does actually

643
00:27:52,620 --> 00:28:00,389
goes and collects its config file from

644
00:27:56,100 --> 00:28:02,610
out on the<font color="#E5E5E5"> internet so it knows</font><font color="#CCCCCC"> that my</font>

645
00:28:00,390 --> 00:28:04,680
config file is<font color="#CCCCCC"> one</font><font color="#E5E5E5"> two three dot which</font>

646
00:28:02,610 --> 00:28:06,479
is sat on this URL so it just<font color="#E5E5E5"> doesn't</font>

647
00:28:04,680 --> 00:28:08,400
get requests for that pulls it down then

648
00:28:06,480 --> 00:28:11,550
will decrypt it in<font color="#E5E5E5"> real time</font><font color="#CCCCCC"> on the box</font>

649
00:28:08,400 --> 00:28:14,340
<font color="#CCCCCC">but again when we start to analyze this</font>

650
00:28:11,550 --> 00:28:15,450
we can pull that first request down it's

651
00:28:14,340 --> 00:28:17,459
got to go out somewhere it's going to

652
00:28:15,450 --> 00:28:19,140
pull something down now I can check my

653
00:28:17,460 --> 00:28:22,770
<font color="#E5E5E5">logs see if that files ever been pulled</font>

654
00:28:19,140 --> 00:28:24,690
down I can look<font color="#E5E5E5"> at the box see if that</font>

655
00:28:22,770 --> 00:28:27,210
file exists on the box and<font color="#E5E5E5"> then that can</font>

656
00:28:24,690 --> 00:28:30,590
tell that way so there are<font color="#CCCCCC"> ways of doing</font>

657
00:28:27,210 --> 00:28:32,580
that<font color="#CCCCCC"> erm there are a couple of go strap</font>

658
00:28:30,590 --> 00:28:35,850
ghostwriters of fluid flows<font color="#CCCCCC"> Randerson</font>

659
00:28:32,580 --> 00:28:37,710
they're very similar the the<font color="#CCCCCC"> actual</font>

660
00:28:35,850 --> 00:28:40,439
config file is just a single base64

661
00:28:37,710 --> 00:28:42,840
encoded line at the end which is just a

662
00:28:40,440 --> 00:28:45,180
URL and he goes out to the URL pulls

663
00:28:42,840 --> 00:28:47,760
down the config file and parks it and

664
00:28:45,180 --> 00:28:49,020
then it stores into memory the good

665
00:28:47,760 --> 00:28:51,600
thing about that is it uses<font color="#E5E5E5"> something</font>

666
00:28:49,020 --> 00:28:53,430
<font color="#E5E5E5">very similar so</font><font color="#CCCCCC"> it saves that that</font>

667
00:28:51,600 --> 00:28:56,370
config file on the disk now so if<font color="#CCCCCC"> I go</font>

668
00:28:53,430 --> 00:28:58,110
in as an interest bonds handler<font color="#E5E5E5"> I can i</font>

669
00:28:56,370 --> 00:29:00,000
<font color="#E5E5E5">can grab that config and again it it's</font>

670
00:28:58,110 --> 00:29:01,979
always got to interact it has to do

671
00:29:00,000 --> 00:29:04,050
something so as long as<font color="#CCCCCC"> I can figure out</font>

672
00:29:01,980 --> 00:29:06,030
what it's doing in the first<font color="#E5E5E5"> place then</font>

673
00:29:04,050 --> 00:29:08,190
it gives me something<font color="#E5E5E5"> to pivot on so I</font>

674
00:29:06,030 --> 00:29:10,860
<font color="#CCCCCC">can start blocking if I've got IDs or</font>

675
00:29:08,190 --> 00:29:12,690
IPs I can block those if I've got fire

676
00:29:10,860 --> 00:29:19,699
warlike say suck i can stop implicit

677
00:29:12,690 --> 00:29:19,700
<font color="#CCCCCC">bucking those as well the more</font>

678
00:29:20,000 --> 00:29:29,640
how am i doing for time as this is not

679
00:29:27,000 --> 00:29:32,280
my audience<font color="#E5E5E5"> I won't bore you going</font>

680
00:29:29,640 --> 00:29:33,510
through a technical demonstration unless

681
00:29:32,280 --> 00:29:37,309
anybody really wants to<font color="#CCCCCC"> see a talent for</font>

682
00:29:33,510 --> 00:29:39,450
demonstration I didn't<font color="#E5E5E5"> think so</font>

683
00:29:37,309 --> 00:29:41,040
apologies that you got me instead<font color="#CCCCCC"> of who</font>

684
00:29:39,450 --> 00:29:43,340
you were<font color="#E5E5E5"> really hit see but thank you</font>

685
00:29:41,040 --> 00:29:43,340
very much

