1
00:00:00,000 --> 00:00:06,660
hey guys um so<font color="#E5E5E5"> oh wow I lost my nerve</font>

2
00:00:05,069 --> 00:00:08,580
and the first dozen<font color="#E5E5E5"> people came in and</font>

3
00:00:06,660 --> 00:00:12,120
<font color="#E5E5E5">now there's like a dozen people trying</font>

4
00:00:08,580 --> 00:00:14,460
to<font color="#E5E5E5"> come in so our point number one is</font>

5
00:00:12,120 --> 00:00:15,660
I'm not<font color="#E5E5E5"> a public speaker and if I look a</font>

6
00:00:14,460 --> 00:00:18,270
little bit nervous it's because I'm

7
00:00:15,660 --> 00:00:20,670
absolutely petrified however we'll get

8
00:00:18,270 --> 00:00:23,279
through this together and this<font color="#CCCCCC"> is my</font>

9
00:00:20,670 --> 00:00:25,380
talk offensive anti analysis or what

10
00:00:23,279 --> 00:00:27,779
should probably more accurately be

11
00:00:25,380 --> 00:00:30,119
called adventures in antivirus evasion

12
00:00:27,779 --> 00:00:33,059
part 3 I don't quite a lot of<font color="#E5E5E5"> work over</font>

13
00:00:30,119 --> 00:00:34,620
the past maybe two years on antivirus

14
00:00:33,059 --> 00:00:36,809
evasion and this is kind of<font color="#CCCCCC"> the end of</font>

15
00:00:34,620 --> 00:00:38,218
<font color="#E5E5E5">it this is I've got</font><font color="#CCCCCC"> through everything</font>

16
00:00:36,809 --> 00:00:41,309
now I've talked about as much<font color="#CCCCCC"> as I want</font>

17
00:00:38,219 --> 00:00:45,800
to so here's a nice summary the TLDR of

18
00:00:41,309 --> 00:00:48,690
the me messing around with antivirus um

19
00:00:45,800 --> 00:00:50,160
so<font color="#E5E5E5"> I am the author of that pink</font>

20
00:00:48,690 --> 00:00:52,589
information security blog but these

21
00:00:50,160 --> 00:00:54,989
slides are themed around I write a lot

22
00:00:52,590 --> 00:00:56,610
of content online about penetration

23
00:00:54,989 --> 00:00:58,559
testing penetration testing is my day

24
00:00:56,610 --> 00:00:59,879
job breaking into computers and

25
00:00:58,559 --> 00:01:02,190
buildings<font color="#E5E5E5"> and I write</font><font color="#CCCCCC"> about</font>

26
00:00:59,879 --> 00:01:03,718
infrastructure security web application

27
00:01:02,190 --> 00:01:06,810
security but something that<font color="#CCCCCC"> I don't talk</font>

28
00:01:03,719 --> 00:01:09,840
<font color="#CCCCCC">about is what i would call my hobby</font>

29
00:01:06,810 --> 00:01:12,420
which is malicious software development

30
00:01:09,840 --> 00:01:15,240
yeah not<font color="#E5E5E5"> really analysis it's kind of</font>

31
00:01:12,420 --> 00:01:17,759
more development so because I'm not

32
00:01:15,240 --> 00:01:19,710
allowed<font color="#CCCCCC"> to do a talk on hey here's a</font>

33
00:01:17,759 --> 00:01:21,750
tutorial an outright botnet I'm going<font color="#E5E5E5"> to</font>

34
00:01:19,710 --> 00:01:24,179
<font color="#E5E5E5">do a tutorial on how revered antivirus</font>

35
00:01:21,750 --> 00:01:25,860
instead now antivirus has been around

36
00:01:24,180 --> 00:01:27,689
for a long time and i'll talk about the

37
00:01:25,860 --> 00:01:30,270
origins of any virus very very briefly

38
00:01:27,689 --> 00:01:33,270
and<font color="#E5E5E5"> i'll talk about the kind of previous</font>

39
00:01:30,270 --> 00:01:34,439
works through you know evading signature

40
00:01:33,270 --> 00:01:36,920
analysis and things like that very

41
00:01:34,439 --> 00:01:39,179
briefly and<font color="#E5E5E5"> i want to get on to</font>

42
00:01:36,920 --> 00:01:41,189
behavioral analysis engines towards the

43
00:01:39,180 --> 00:01:42,899
end and in particular online scanning

44
00:01:41,189 --> 00:01:45,839
engines like virustotal and<font color="#E5E5E5"> websites</font>

45
00:01:42,899 --> 00:01:48,479
like<font color="#E5E5E5"> that but starting right at the</font>

46
00:01:45,840 --> 00:01:50,130
beginning<font color="#E5E5E5"> one of the problems</font><font color="#CCCCCC"> with</font>

47
00:01:48,479 --> 00:01:53,000
malicious software one of the problems

48
00:01:50,130 --> 00:01:56,219
<font color="#E5E5E5">with detecting malicious software is</font>

49
00:01:53,000 --> 00:01:58,229
it's<font color="#E5E5E5"> really hard to determine you know</font><font color="#CCCCCC"> I</font>

50
00:01:56,219 --> 00:01:59,729
<font color="#E5E5E5">mean well what is malicious define</font>

51
00:01:58,229 --> 00:02:02,189
malicious and if we can't accurately

52
00:01:59,729 --> 00:02:05,009
define it then we can accurately<font color="#E5E5E5"> detect</font>

53
00:02:02,189 --> 00:02:08,609
it so if<font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to if I want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> know</font>

54
00:02:05,009 --> 00:02:10,919
what<font color="#E5E5E5"> something looks like i'll go hey ok</font>

55
00:02:08,610 --> 00:02:13,080
Google what's a horse look like

56
00:02:10,919 --> 00:02:14,970
and Google show me<font color="#E5E5E5"> images of a horse and</font>

57
00:02:13,080 --> 00:02:16,349
I'll go yeah man that's like those are

58
00:02:14,970 --> 00:02:20,190
definitely horses look at the stunning

59
00:02:16,349 --> 00:02:22,230
beasts easy apart from when it comes to

60
00:02:20,190 --> 00:02:23,700
the kind of stuff that we do I mean I

61
00:02:22,230 --> 00:02:25,738
introduced myself as a penetration

62
00:02:23,700 --> 00:02:28,079
tester sometimes i use the slang term

63
00:02:25,739 --> 00:02:29,400
hacker our<font color="#E5E5E5"> professional hacker or break</font>

64
00:02:28,080 --> 00:02:32,220
into computers and buildings and<font color="#E5E5E5"> stuff</font>

65
00:02:29,400 --> 00:02:37,830
like that Siri what's a hack it looked

66
00:02:32,220 --> 00:02:39,030
like oh so we<font color="#CCCCCC"> have a problem here we</font>

67
00:02:37,830 --> 00:02:41,130
have a<font color="#E5E5E5"> problem when it comes to</font><font color="#CCCCCC"> use</font>

68
00:02:39,030 --> 00:02:44,250
stereotypes<font color="#E5E5E5"> and we have a problem when</font>

69
00:02:41,130 --> 00:02:45,359
it comes to actually defining the thing

70
00:02:44,250 --> 00:02:46,769
that we're<font color="#CCCCCC"> looking for if we can't</font>

71
00:02:45,360 --> 00:02:50,190
define malicious we can't detect

72
00:02:46,769 --> 00:02:51,900
malicious so yeah google images is

73
00:02:50,190 --> 00:02:53,640
probably not the best place to go if

74
00:02:51,900 --> 00:02:56,610
you're looking for rigorous definitions

75
00:02:53,640 --> 00:02:58,950
but it's a good place to start now<font color="#E5E5E5"> I'm a</font>

76
00:02:56,610 --> 00:03:00,690
penetration tester<font color="#E5E5E5"> I hail from the red</font>

77
00:02:58,950 --> 00:03:02,640
team<font color="#CCCCCC"> and for</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> who are unfamiliar</font>

78
00:03:00,690 --> 00:03:04,739
information security is generally split

79
00:03:02,640 --> 00:03:06,720
into red team and blue team or the blue

80
00:03:04,739 --> 00:03:08,250
team are the defenders people who look

81
00:03:06,720 --> 00:03:09,989
after I network infrastructure and keep

82
00:03:08,250 --> 00:03:12,360
us safe online and<font color="#CCCCCC"> they're our team</font>

83
00:03:09,989 --> 00:03:14,069
other people who play<font color="#CCCCCC"> the part of the</font>

84
00:03:12,360 --> 00:03:16,109
attacker they're not malicious in nature

85
00:03:14,069 --> 00:03:19,589
they just play devil's advocate for the

86
00:03:16,109 --> 00:03:22,470
sake of network security so when it

87
00:03:19,590 --> 00:03:23,880
<font color="#E5E5E5">comes to being a member of red team we</font>

88
00:03:22,470 --> 00:03:25,440
have<font color="#E5E5E5"> an ethics foundry and in fact</font>

89
00:03:23,880 --> 00:03:27,239
anyone in information security you<font color="#E5E5E5"> can</font>

90
00:03:25,440 --> 00:03:30,090
talk to the ends of viewer the<font color="#E5E5E5"> world</font>

91
00:03:27,239 --> 00:03:31,739
about ethics<font color="#E5E5E5"> and where I joined the line</font>

92
00:03:30,090 --> 00:03:33,570
here<font color="#CCCCCC"> is yeah</font><font color="#E5E5E5"> I'm going to talk about</font>

93
00:03:31,739 --> 00:03:36,000
malicious software development but

94
00:03:33,570 --> 00:03:38,940
anything that we do should and always

95
00:03:36,000 --> 00:03:40,859
must assist the blue team more than it

96
00:03:38,940 --> 00:03:44,010
assists the malicious citizens of the

97
00:03:40,859 --> 00:03:45,269
internet so I wrote some tools and I rot

98
00:03:44,010 --> 00:03:46,768
some proof of concepts and I'll<font color="#E5E5E5"> release</font>

99
00:03:45,269 --> 00:03:48,930
those I<font color="#E5E5E5"> was</font><font color="#CCCCCC"> going to</font><font color="#E5E5E5"> download them</font>

100
00:03:46,769 --> 00:03:51,570
during this talk but we're on<font color="#E5E5E5"> Carol</font>

101
00:03:48,930 --> 00:03:52,709
number<font color="#CCCCCC"> 7</font><font color="#E5E5E5"> and laptop number two so I'm</font>

102
00:03:51,570 --> 00:03:56,130
<font color="#E5E5E5">not entirely convinced them I will</font>

103
00:03:52,709 --> 00:03:57,569
happen I'm afraid but<font color="#CCCCCC"> I</font><font color="#E5E5E5"> rossum malware</font>

104
00:03:56,130 --> 00:03:58,799
and it did some cool things to some

105
00:03:57,569 --> 00:04:01,018
antivirus scanners and I want<font color="#E5E5E5"> to talk</font>

106
00:03:58,799 --> 00:04:03,630
about that<font color="#E5E5E5"> and my relationship with</font>

107
00:04:01,019 --> 00:04:05,310
malware is a pretty simple<font color="#E5E5E5"> one I really</font>

108
00:04:03,630 --> 00:04:07,109
like malware I really like malicious

109
00:04:05,310 --> 00:04:10,260
software and I don't differentiate

110
00:04:07,109 --> 00:04:13,500
between the<font color="#CCCCCC"> tools that</font><font color="#E5E5E5"> I use in my day</font>

111
00:04:10,260 --> 00:04:14,910
job hacking tools and malicious software

112
00:04:13,500 --> 00:04:16,798
because they're doing<font color="#CCCCCC"> the same jobs for</font>

113
00:04:14,910 --> 00:04:18,418
the same reason I<font color="#E5E5E5"> just have a</font>

114
00:04:16,798 --> 00:04:20,488
certificate of ethics that says when I

115
00:04:18,418 --> 00:04:22,620
steal your credit cards I'm going<font color="#E5E5E5"> to</font>

116
00:04:20,488 --> 00:04:27,000
<font color="#E5E5E5">give them back</font>

117
00:04:22,620 --> 00:04:29,199
most of them so we're talking<font color="#E5E5E5"> about</font>

118
00:04:27,000 --> 00:04:31,330
detecting viruses detecting worms

119
00:04:29,199 --> 00:04:34,599
detecting malware you know what's a

120
00:04:31,330 --> 00:04:36,280
virus look like yeah man<font color="#E5E5E5"> this google</font>

121
00:04:34,599 --> 00:04:38,229
images things really not working<font color="#CCCCCC"> out for</font>

122
00:04:36,280 --> 00:04:40,239
it does<font color="#CCCCCC"> it tell you what well check out</font>

123
00:04:38,229 --> 00:04:45,370
some documentaries instead this is CSI

124
00:04:40,240 --> 00:04:47,289
cyber turns out it's really<font color="#E5E5E5"> easy guys</font>

125
00:04:45,370 --> 00:04:51,539
you just look for the red card it's all

126
00:04:47,289 --> 00:04:54,840
of the red that's the malware now um

127
00:04:51,539 --> 00:04:57,219
<font color="#E5E5E5">Yemen detected malware</font><font color="#CCCCCC"> detecting and</font>

128
00:04:54,840 --> 00:04:58,719
well detecting a malware attack is

129
00:04:57,220 --> 00:05:00,130
really<font color="#E5E5E5"> really simple you</font><font color="#CCCCCC"> know you turn</font>

130
00:04:58,720 --> 00:05:02,470
your laptop on<font color="#E5E5E5"> and it looks like that</font>

131
00:05:00,130 --> 00:05:06,460
and then you go yep that's malware

132
00:05:02,470 --> 00:05:10,830
that's definitely<font color="#E5E5E5"> malware so it's 2016</font>

133
00:05:06,460 --> 00:05:14,919
and our<font color="#CCCCCC"> our headlines today filled with</font>

134
00:05:10,830 --> 00:05:18,818
ransomware ransom was a pretty awesome

135
00:05:14,919 --> 00:05:21,508
thing it's um well<font color="#CCCCCC"> it's a really really</font>

136
00:05:18,819 --> 00:05:24,789
easy way of making money isn't it and

137
00:05:21,509 --> 00:05:29,909
you see ransom<font color="#CCCCCC"> where's</font><font color="#E5E5E5"> hanging the news</font>

138
00:05:24,789 --> 00:05:34,180
in 2016 but it's<font color="#E5E5E5"> not news it's not new a</font>

139
00:05:29,909 --> 00:05:35,740
quick pause a quick detour 1971 the

140
00:05:34,180 --> 00:05:37,630
first computer virus is released I'm

141
00:05:35,740 --> 00:05:39,190
talking about creepy<font color="#E5E5E5"> here and by</font>

142
00:05:37,630 --> 00:05:42,550
computer virus we're talking about

143
00:05:39,190 --> 00:05:44,229
pdp-10 s in the ARPANET creeper creeps

144
00:05:42,550 --> 00:05:47,349
through the ARPANET infecting machines

145
00:05:44,229 --> 00:05:49,120
and then<font color="#CCCCCC"> Reaper is</font><font color="#E5E5E5"> released and</font>

146
00:05:47,349 --> 00:05:53,680
repurchases creeper through the ARPANET

147
00:05:49,120 --> 00:05:56,860
and cleans it up to<font color="#E5E5E5"> 1971 and we have the</font>

148
00:05:53,680 --> 00:05:58,630
first virus<font color="#CCCCCC"> and the first antivirus that</font>

149
00:05:56,860 --> 00:06:01,300
is a long time ago do you<font color="#E5E5E5"> remember the</font>

150
00:05:58,630 --> 00:06:04,539
70s so nice and so only<font color="#E5E5E5"> one that's the</font>

151
00:06:01,300 --> 00:06:07,210
first<font color="#E5E5E5"> computer virus 1986 that's brand</font>

152
00:06:04,539 --> 00:06:09,068
as the<font color="#E5E5E5"> first pc virus pcs as we would</font>

153
00:06:07,210 --> 00:06:15,068
recognize him in this day and age IBM

154
00:06:09,069 --> 00:06:17,469
pcs 1986 1989 the first ransomware

155
00:06:15,069 --> 00:06:19,569
talking about the edge<font color="#E5E5E5"> trojan here a</font>

156
00:06:17,469 --> 00:06:21,909
piece of software that I'll encrypt the

157
00:06:19,569 --> 00:06:25,930
files on your computer and<font color="#CCCCCC"> then ask you</font>

158
00:06:21,909 --> 00:06:28,419
to<font color="#CCCCCC"> pay a ransom ransomware in 1989 it</font>

159
00:06:25,930 --> 00:06:30,279
wasn't perfect<font color="#CCCCCC"> he used symmetric key</font>

160
00:06:28,419 --> 00:06:32,409
cryptography as opposed to a symmetric

161
00:06:30,279 --> 00:06:33,339
key cryptography so any malware analysts

162
00:06:32,409 --> 00:06:33,830
out there<font color="#E5E5E5"> I'll tell</font><font color="#CCCCCC"> you that that's</font>

163
00:06:33,339 --> 00:06:36,050
terror

164
00:06:33,830 --> 00:06:38,120
<font color="#E5E5E5">we'll pull a key at the executable it's</font>

165
00:06:36,050 --> 00:06:42,140
trivially easy to buy a house but hey it

166
00:06:38,120 --> 00:06:46,450
was 1989 we were young some of us were i

167
00:06:42,140 --> 00:06:48,770
was<font color="#E5E5E5"> born in nineteen ninety malware and</font>

168
00:06:46,450 --> 00:06:53,840
specifically ransomware has been a

169
00:06:48,770 --> 00:06:55,940
problem longer than I have so so why is

170
00:06:53,840 --> 00:06:58,909
Hawaii's ransomware such a big thing in

171
00:06:55,940 --> 00:07:01,600
this day<font color="#CCCCCC"> why it wise ransomware working</font>

172
00:06:58,910 --> 00:07:03,830
out so well for the attackers well

173
00:07:01,600 --> 00:07:05,180
partly you can argue<font color="#CCCCCC"> improvement in</font>

174
00:07:03,830 --> 00:07:07,060
certain areas of security improvements

175
00:07:05,180 --> 00:07:09,920
in perimeter security things like that

176
00:07:07,060 --> 00:07:11,750
alternatively<font color="#CCCCCC"> you can argue take a</font>

177
00:07:09,920 --> 00:07:14,300
symmetric key cryptography<font color="#CCCCCC"> tech</font>

178
00:07:11,750 --> 00:07:16,700
<font color="#E5E5E5">malicious thrown a little bit coin and</font>

179
00:07:14,300 --> 00:07:20,210
you have a recipe for profit what kind

180
00:07:16,700 --> 00:07:22,760
of profits well taking a quick look on

181
00:07:20,210 --> 00:07:23,930
wikipedia the<font color="#E5E5E5"> source of all facts yeah</font>

182
00:07:22,760 --> 00:07:27,200
that's right<font color="#E5E5E5"> I don't only get my facts</font>

183
00:07:23,930 --> 00:07:29,360
from google images cryptolocker<font color="#CCCCCC"> there</font>

184
00:07:27,200 --> 00:07:32,030
made three million dollars that's pretty

185
00:07:29,360 --> 00:07:33,250
good not buying<font color="#E5E5E5"> a</font><font color="#CCCCCC"> new car with three</font>

186
00:07:32,030 --> 00:07:35,659
million dollars you buying an island

187
00:07:33,250 --> 00:07:38,510
crypto wall<font color="#E5E5E5"> there made 18 million</font>

188
00:07:35,660 --> 00:07:40,580
dollars I'm really<font color="#E5E5E5"> sorry this is</font>

189
00:07:38,510 --> 00:07:42,469
presentations kind of I'm<font color="#E5E5E5"> not trying to</font>

190
00:07:40,580 --> 00:07:44,750
convince you to write malware that's not

191
00:07:42,470 --> 00:07:48,440
<font color="#CCCCCC">the</font><font color="#E5E5E5"> end of it the end of this topic is</font>

192
00:07:44,750 --> 00:07:50,150
an incoherent 45 minute rant about some

193
00:07:48,440 --> 00:07:52,430
parts of information security that

194
00:07:50,150 --> 00:07:55,270
frustrate me you seem always<font color="#E5E5E5"> been around</font>

195
00:07:52,430 --> 00:07:57,200
for a long time<font color="#E5E5E5"> our advances in</font>

196
00:07:55,270 --> 00:07:59,150
defending against malware have been

197
00:07:57,200 --> 00:08:02,150
around<font color="#E5E5E5"> for</font><font color="#CCCCCC"> a long time</font><font color="#E5E5E5"> and we do some</font>

198
00:07:59,150 --> 00:08:03,530
really<font color="#CCCCCC"> cool stuff malware analysts put</font>

199
00:08:02,150 --> 00:08:05,510
an awful lot of<font color="#E5E5E5"> effort</font><font color="#CCCCCC"> into pulling</font>

200
00:08:03,530 --> 00:08:07,669
these these tools apart and writing

201
00:08:05,510 --> 00:08:10,760
quite fantastic blog posts about how

202
00:08:07,670 --> 00:08:12,980
naive from malware is and and how a lot

203
00:08:10,760 --> 00:08:14,780
<font color="#E5E5E5">of it is written like all software as</font>

204
00:08:12,980 --> 00:08:17,600
its copy and pasted from stack overflow

205
00:08:14,780 --> 00:08:18,950
I don't<font color="#E5E5E5"> have the slide in here because I</font>

206
00:08:17,600 --> 00:08:20,930
didn't want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> steal someone else's</font><font color="#CCCCCC"> work</font>

207
00:08:18,950 --> 00:08:23,750
but there's<font color="#E5E5E5"> a brilliant article where a</font>

208
00:08:20,930 --> 00:08:27,110
guy texted piece of malware pulls it

209
00:08:23,750 --> 00:08:28,790
apart<font color="#CCCCCC"> it's rainin basic and instead of</font>

210
00:08:27,110 --> 00:08:30,620
talking<font color="#E5E5E5"> about the features</font><font color="#CCCCCC"> of the</font>

211
00:08:28,790 --> 00:08:33,740
malware he links it back to the original

212
00:08:30,620 --> 00:08:35,330
stack overflow and articles calls if

213
00:08:33,740 --> 00:08:36,770
that's the right word<font color="#E5E5E5"> like yeah this is</font>

214
00:08:35,330 --> 00:08:38,310
copy and pasted from here<font color="#E5E5E5"> and then</font>

215
00:08:36,770 --> 00:08:40,529
that's<font color="#CCCCCC"> like copy</font><font color="#E5E5E5"> and pasted from that</font>

216
00:08:38,309 --> 00:08:42,718
so the malware analysts antivirus

217
00:08:40,529 --> 00:08:45,930
companies are doing absolutely next-gen

218
00:08:42,719 --> 00:08:48,090
stuff to detect this and then the

219
00:08:45,930 --> 00:08:49,500
malware writers are<font color="#CCCCCC"> just like we're</font>

220
00:08:48,090 --> 00:08:51,360
going<font color="#E5E5E5"> to learn my programming language</font>

221
00:08:49,500 --> 00:08:53,700
i'm just going to<font color="#CCCCCC"> use other people</font>

222
00:08:51,360 --> 00:08:55,290
snippets so run somewhere is very very

223
00:08:53,700 --> 00:08:59,540
<font color="#E5E5E5">strange my words very very strange on it</font>

224
00:08:55,290 --> 00:09:02,010
is absolutely all over the news and<font color="#CCCCCC"> i</font>

225
00:08:59,540 --> 00:09:03,569
said this<font color="#E5E5E5"> is an animation originally but</font>

226
00:09:02,010 --> 00:09:05,550
the problem was it west at about seven

227
00:09:03,570 --> 00:09:08,420
minutes of just news headlines just

228
00:09:05,550 --> 00:09:12,000
coming up there deep<font color="#E5E5E5"> that deep and</font>

229
00:09:08,420 --> 00:09:14,219
ransom was great because it gets around

230
00:09:12,000 --> 00:09:16,800
a lot of the problems<font color="#E5E5E5"> of traditional</font>

231
00:09:14,220 --> 00:09:18,960
security I don't have to do things like

232
00:09:16,800 --> 00:09:22,020
reaching the perimeter and<font color="#CCCCCC"> I don't have</font>

233
00:09:18,960 --> 00:09:26,040
<font color="#E5E5E5">to hack hardened servers and get into</font>

234
00:09:22,020 --> 00:09:28,740
<font color="#E5E5E5">the areas that we've invested in to</font>

235
00:09:26,040 --> 00:09:31,529
<font color="#E5E5E5">protect I just have</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> a user to</font>

236
00:09:28,740 --> 00:09:33,150
click a link in an email and I work as a

237
00:09:31,529 --> 00:09:34,410
penetration tester so sending phishing

238
00:09:33,150 --> 00:09:38,640
emails is something that I do quite

239
00:09:34,410 --> 00:09:40,620
regularly and my guests personal average

240
00:09:38,640 --> 00:09:42,630
my team's average is thirty-three

241
00:09:40,620 --> 00:09:45,390
percent of users will give us their

242
00:09:42,630 --> 00:09:46,950
password or email that's not a gardener

243
00:09:45,390 --> 00:09:49,680
statistic I can't link that back to a

244
00:09:46,950 --> 00:09:52,470
report our personal experiences our

245
00:09:49,680 --> 00:09:53,969
statistics<font color="#CCCCCC"> and team around fifty percent</font>

246
00:09:52,470 --> 00:09:55,530
of users look like a<font color="#E5E5E5"> link in around</font>

247
00:09:53,970 --> 00:09:57,930
<font color="#CCCCCC">thirty percent of users will give us</font>

248
00:09:55,530 --> 00:10:00,060
their passwords now it's not going to be

249
00:09:57,930 --> 00:10:03,469
as trivial as a bro what's password oh

250
00:10:00,060 --> 00:10:05,550
oh I lost my password can I borrow yours

251
00:10:03,470 --> 00:10:06,839
we're going<font color="#E5E5E5"> to set up a scenario we're</font>

252
00:10:05,550 --> 00:10:08,849
gonna set up you know we're going<font color="#E5E5E5"> to use</font>

253
00:10:06,839 --> 00:10:10,380
psychology against users and that's the

254
00:10:08,850 --> 00:10:12,570
brilliant thing I'm not attacking a

255
00:10:10,380 --> 00:10:15,210
hardened server I'm checking attacking a

256
00:10:12,570 --> 00:10:17,100
user<font color="#E5E5E5"> who's non-techie probably really</font>

257
00:10:15,210 --> 00:10:19,170
busy doesn't really<font color="#E5E5E5"> care about computers</font>

258
00:10:17,100 --> 00:10:21,390
in fact probably hits them as much as<font color="#E5E5E5"> I</font>

259
00:10:19,170 --> 00:10:23,880
do and just wants to get done with the

260
00:10:21,390 --> 00:10:26,069
task that set before<font color="#E5E5E5"> him so phishing</font>

261
00:10:23,880 --> 00:10:27,750
attacks are effective link ransomware to

262
00:10:26,070 --> 00:10:32,370
phishing attacks and they're very

263
00:10:27,750 --> 00:10:34,080
effective now in the context<font color="#E5E5E5"> of computer</font>

264
00:10:32,370 --> 00:10:35,459
security we opened with this problem<font color="#CCCCCC"> and</font>

265
00:10:34,080 --> 00:10:38,110
this is the problem<font color="#CCCCCC"> that</font><font color="#E5E5E5"> runs throughout</font>

266
00:10:35,459 --> 00:10:40,779
how do<font color="#E5E5E5"> we define malicious</font>

267
00:10:38,110 --> 00:10:42,760
now the certain well<font color="#CCCCCC"> there's security</font>

268
00:10:40,779 --> 00:10:44,649
<font color="#E5E5E5">devices out there that'll that'll detect</font>

269
00:10:42,760 --> 00:10:46,450
when our ability exploitation and detect

270
00:10:44,649 --> 00:10:48,820
things like privilege escalation and

271
00:10:46,450 --> 00:10:52,930
again ransomware is getting around those

272
00:10:48,820 --> 00:10:55,329
because we're taking<font color="#CCCCCC"> a</font><font color="#E5E5E5"> user's files that</font>

273
00:10:52,930 --> 00:10:57,310
<font color="#CCCCCC">they're have permission to and messing</font>

274
00:10:55,329 --> 00:10:59,050
with them in the context of that<font color="#E5E5E5"> user</font>

275
00:10:57,310 --> 00:11:01,029
the user is clicked a link in an email

276
00:10:59,050 --> 00:11:02,769
<font color="#E5E5E5">something like that a piece of software</font>

277
00:11:01,029 --> 00:11:05,620
running as that user is messing<font color="#CCCCCC"> with</font>

278
00:11:02,769 --> 00:11:07,060
that users files it's a<font color="#E5E5E5"> different</font>

279
00:11:05,620 --> 00:11:10,260
approach to security something we've

280
00:11:07,060 --> 00:11:10,260
never really come across<font color="#E5E5E5"> before</font>

281
00:11:11,220 --> 00:11:15,850
ransomware it's a type of malware we

282
00:11:13,959 --> 00:11:17,469
have anti-malware<font color="#E5E5E5"> it's existed for a</font>

283
00:11:15,850 --> 00:11:19,420
long time previously written about it

284
00:11:17,470 --> 00:11:21,910
like<font color="#E5E5E5"> I said really this talk is</font>

285
00:11:19,420 --> 00:11:26,019
adventures in antivirus evasion part 3

286
00:11:21,910 --> 00:11:28,360
and when it<font color="#E5E5E5"> comes to anti-malware</font>

287
00:11:26,019 --> 00:11:29,800
systems there's there's two types of

288
00:11:28,360 --> 00:11:31,360
engine and most people<font color="#E5E5E5"> in the room are</font>

289
00:11:29,800 --> 00:11:33,339
familiar with both of<font color="#E5E5E5"> these terms and</font>

290
00:11:31,360 --> 00:11:35,529
the fact that there's two types if you

291
00:11:33,339 --> 00:11:37,899
read any of the vendors<font color="#E5E5E5"> come flirt any</font>

292
00:11:35,529 --> 00:11:39,850
of that and information they'll tell you

293
00:11:37,899 --> 00:11:41,940
the seven types but<font color="#E5E5E5"> it's like the seven</font>

294
00:11:39,850 --> 00:11:44,500
signs of aging trust me there's<font color="#CCCCCC"> 22</font>

295
00:11:41,940 --> 00:11:46,360
<font color="#CCCCCC">detection engines the signature analysis</font>

296
00:11:44,500 --> 00:11:48,730
engines which everyone should know

297
00:11:46,360 --> 00:11:50,019
hopefully if your nit in your a security

298
00:11:48,730 --> 00:11:54,070
conference should know these are pretty

299
00:11:50,019 --> 00:11:56,199
broken they do have a place though they

300
00:11:54,070 --> 00:11:59,050
do exist for a reason a signature engine

301
00:11:56,199 --> 00:12:01,120
it's less computationally expensive than

302
00:11:59,050 --> 00:12:02,680
a behavioral analysis engine is the

303
00:12:01,120 --> 00:12:04,180
signature engine gets a detection you

304
00:12:02,680 --> 00:12:06,130
don't need to<font color="#E5E5E5"> worry about the</font>

305
00:12:04,180 --> 00:12:10,779
<font color="#CCCCCC">time-consuming</font><font color="#E5E5E5"> behavioral Avenger</font>

306
00:12:06,130 --> 00:12:12,430
behavioral analysis scan now there's two

307
00:12:10,779 --> 00:12:14,019
kinds<font color="#E5E5E5"> of behavioral engines really when</font>

308
00:12:12,430 --> 00:12:16,449
you think about<font color="#E5E5E5"> it or two approaches to</font>

309
00:12:14,019 --> 00:12:17,589
using them there's whatever it is that

310
00:12:16,449 --> 00:12:19,300
you're deploying in your endpoint

311
00:12:17,589 --> 00:12:22,000
security and then there's websites like

312
00:12:19,300 --> 00:12:24,819
this so when i'm on a penetration test

313
00:12:22,000 --> 00:12:26,529
and i upload a tool to a server and<font color="#E5E5E5"> i</font>

314
00:12:24,820 --> 00:12:29,500
get command execution on a server<font color="#E5E5E5"> i</font>

315
00:12:26,529 --> 00:12:31,060
don't have to bypass all<font color="#CCCCCC"> of the</font>

316
00:12:29,500 --> 00:12:32,949
antivirus in the world<font color="#CCCCCC"> i just have</font><font color="#E5E5E5"> to</font>

317
00:12:31,060 --> 00:12:35,880
bypass the one that you're using

318
00:12:32,949 --> 00:12:38,319
whatever your endpoint choice is i

319
00:12:35,880 --> 00:12:40,360
bypass that and<font color="#CCCCCC"> it's really</font><font color="#E5E5E5"> good I'm</font>

320
00:12:38,320 --> 00:12:41,980
good to go get my code execution however

321
00:12:40,360 --> 00:12:44,160
if we've<font color="#E5E5E5"> got a really on the ball sock</font>

322
00:12:41,980 --> 00:12:47,190
if anyone's ever met one

323
00:12:44,160 --> 00:12:50,339
then I'm sorry<font color="#E5E5E5"> red I shouldn't take a</font>

324
00:12:47,190 --> 00:12:51,569
look at a blue team that's unfair<font color="#CCCCCC"> and if</font>

325
00:12:50,339 --> 00:12:53,670
<font color="#E5E5E5">we have a really on the ball soccer</font>

326
00:12:51,569 --> 00:12:55,139
really<font color="#CCCCCC"> on the ball sysadmin and he picks</font>

327
00:12:53,670 --> 00:12:58,019
up and it's executable<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this service</font>

328
00:12:55,139 --> 00:12:59,759
<font color="#E5E5E5">and he's like looks dodgy you might</font>

329
00:12:58,019 --> 00:13:01,170
she'll choose to use a service like this

330
00:12:59,759 --> 00:13:02,670
you might choose to upload it<font color="#E5E5E5"> to virus</font>

331
00:13:01,170 --> 00:13:05,790
<font color="#E5E5E5">total to get effectively a second</font>

332
00:13:02,670 --> 00:13:07,829
opinion about the security so systems

333
00:13:05,790 --> 00:13:09,839
out there exists already to bypass any

334
00:13:07,829 --> 00:13:11,579
of antivirus things like the veil

335
00:13:09,839 --> 00:13:13,500
framework a fantastic framework that

336
00:13:11,579 --> 00:13:15,239
does what you need on a pentax took

337
00:13:13,500 --> 00:13:18,180
swell into<font color="#E5E5E5"> Kali Linux of nasty flavor</font>

338
00:13:15,240 --> 00:13:19,949
and now we've got the second system

339
00:13:18,180 --> 00:13:21,479
where people<font color="#CCCCCC"> are uploading tools to</font>

340
00:13:19,949 --> 00:13:24,599
virustotal and things like that we have

341
00:13:21,480 --> 00:13:27,779
to a bed doors as well the quick tldr

342
00:13:24,600 --> 00:13:29,399
for signature analysis of<font color="#CCCCCC"> asian lots of</font>

343
00:13:27,779 --> 00:13:31,019
different techniques<font color="#E5E5E5"> quick</font><font color="#CCCCCC"> google we</font>

344
00:13:29,399 --> 00:13:32,160
find out<font color="#E5E5E5"> about them don't bother with</font>

345
00:13:31,019 --> 00:13:34,589
<font color="#E5E5E5">encoding it's not going to get you</font>

346
00:13:32,160 --> 00:13:37,529
anywhere<font color="#CCCCCC"> auto-erotic exploitation is as</font>

347
00:13:34,589 --> 00:13:39,560
fun as its name suggests but my<font color="#E5E5E5"> personal</font>

348
00:13:37,529 --> 00:13:41,850
favorite is cryptic crippling is a

349
00:13:39,560 --> 00:13:43,349
really simple concept really it's a

350
00:13:41,850 --> 00:13:46,410
slang term from the dirty hacker

351
00:13:43,350 --> 00:13:48,509
underground it's an idea that we pull

352
00:13:46,410 --> 00:13:50,910
the meat out<font color="#E5E5E5"> of an executable we encrypt</font>

353
00:13:48,509 --> 00:13:52,949
it added decryption stub stick it all

354
00:13:50,910 --> 00:13:55,589
back together in and fire that as our

355
00:13:52,949 --> 00:13:57,630
payload and now a signature engine looks

356
00:13:55,589 --> 00:14:00,180
for previously seen patterns and an

357
00:13:57,630 --> 00:14:02,100
executable if<font color="#CCCCCC"> i encrypt the executable</font>

358
00:14:00,180 --> 00:14:03,859
there's no previously seen patterns<font color="#CCCCCC"> or</font>

359
00:14:02,100 --> 00:14:06,029
signatures don't work really really

360
00:14:03,860 --> 00:14:08,670
simple thing really really<font color="#E5E5E5"> simple</font>

361
00:14:06,029 --> 00:14:10,889
concept not quite so simple to write

362
00:14:08,670 --> 00:14:13,519
yourself you're<font color="#E5E5E5"> going to be needy fan</font>

363
00:14:10,889 --> 00:14:16,259
assembly and this talk is all about

364
00:14:13,519 --> 00:14:18,120
naive antivirus evasion of previously

365
00:14:16,259 --> 00:14:20,579
written about the technical<font color="#E5E5E5"> side I've</font>

366
00:14:18,120 --> 00:14:22,230
got tutorials on there about assembly

367
00:14:20,579 --> 00:14:23,849
and things like that and<font color="#E5E5E5"> when it comes</font>

368
00:14:22,230 --> 00:14:25,259
<font color="#E5E5E5">to conference talks getting a slide</font>

369
00:14:23,850 --> 00:14:27,029
filled with assembly and trying to root

370
00:14:25,259 --> 00:14:29,069
people through code doesn't work very

371
00:14:27,029 --> 00:14:31,769
well<font color="#CCCCCC"> so what I'm going to do instead is</font>

372
00:14:29,069 --> 00:14:34,349
I'm going<font color="#E5E5E5"> to say yeah antivirus evasion</font>

373
00:14:31,769 --> 00:14:36,990
is still a thing<font color="#E5E5E5"> 40 years after</font>

374
00:14:34,350 --> 00:14:39,660
antivirus came out and 27 years after

375
00:14:36,990 --> 00:14:43,430
ransomware was invented and also a lot

376
00:14:39,660 --> 00:14:45,449
<font color="#E5E5E5">of the time it's terrifyingly simple so</font>

377
00:14:43,430 --> 00:14:46,349
not<font color="#E5E5E5"> going to pick on all vendors I'm not</font>

378
00:14:45,449 --> 00:14:47,459
going to pick on any<font color="#CCCCCC"> vendors</font>

379
00:14:46,350 --> 00:14:49,829
specifically I'm just going to talk

380
00:14:47,459 --> 00:14:50,630
about some<font color="#CCCCCC"> of the things that I did when</font>

381
00:14:49,829 --> 00:14:52,880
as messy around

382
00:14:50,630 --> 00:14:54,830
with the<font color="#CCCCCC"> internet one of them was I</font>

383
00:14:52,880 --> 00:14:57,050
wanted to<font color="#CCCCCC"> download a tool that was</font><font color="#E5E5E5"> a</font>

384
00:14:54,830 --> 00:14:58,820
good control group a good hacking tool

385
00:14:57,050 --> 00:15:00,920
that should be detected by every

386
00:14:58,820 --> 00:15:02,810
antivirus out there I chose mimic hats

387
00:15:00,920 --> 00:15:04,490
for this round two brilliant tool any

388
00:15:02,810 --> 00:15:06,979
penetration tester I'll tell you exactly

389
00:15:04,490 --> 00:15:10,010
<font color="#CCCCCC">what mimic hats do does we absolutely</font>

390
00:15:06,980 --> 00:15:11,420
love it it pulls plain text credentials

391
00:15:10,010 --> 00:15:13,280
out of memory a fantastic thing if

392
00:15:11,420 --> 00:15:17,719
<font color="#E5E5E5">you're a penetration tester by default</font>

393
00:15:13,280 --> 00:15:20,630
<font color="#E5E5E5">it's detected 25 out</font><font color="#CCCCCC"> of 56 on virustotal</font>

394
00:15:17,720 --> 00:15:23,600
<font color="#CCCCCC">a score</font><font color="#E5E5E5"> of 25 okay point number one</font>

395
00:15:20,630 --> 00:15:25,010
<font color="#E5E5E5">that's terrifyingly low for an out of</font>

396
00:15:23,600 --> 00:15:27,820
<font color="#E5E5E5">the pot I haven't actually done any</font>

397
00:15:25,010 --> 00:15:32,439
aversion yet and I'm over halfway there

398
00:15:27,820 --> 00:15:35,510
so that<font color="#E5E5E5"> aside and what I did for my</font>

399
00:15:32,440 --> 00:15:38,390
opening evasion technique and this is

400
00:15:35,510 --> 00:15:43,310
naive lessons in antivirus aversion step

401
00:15:38,390 --> 00:15:46,630
<font color="#CCCCCC">one i renamed the file and it went from</font>

402
00:15:43,310 --> 00:15:46,630
25 to 20

403
00:15:47,170 --> 00:15:51,910
it's a good start it's the twenty

404
00:15:49,029 --> 00:15:53,920
percent<font color="#E5E5E5"> drop so i started</font><font color="#CCCCCC"> at below fifty</font>

405
00:15:51,910 --> 00:15:55,600
percent and dropped twenty percent I'm

406
00:15:53,920 --> 00:15:59,709
elite hacker let's be honest no

407
00:15:55,600 --> 00:16:00,790
seriously and an eagle-eyed viewers not

408
00:15:59,709 --> 00:16:02,260
at the back because<font color="#E5E5E5"> there's no way you</font>

409
00:16:00,790 --> 00:16:04,360
can even see<font color="#E5E5E5"> this slide but guys are</font><font color="#CCCCCC"> the</font>

410
00:16:02,260 --> 00:16:06,180
front my noise the hash is different so

411
00:16:04,360 --> 00:16:09,160
I'm lying to you NSA<font color="#CCCCCC"> Irene and the file</font>

412
00:16:06,180 --> 00:16:10,479
but not quite i renamed the file and

413
00:16:09,160 --> 00:16:12,430
then went into<font color="#E5E5E5"> the portable executable</font>

414
00:16:10,480 --> 00:16:14,230
and at the end of a<font color="#E5E5E5"> PE structure it has</font>

415
00:16:12,430 --> 00:16:16,149
<font color="#CCCCCC">a thing called original file name</font>

416
00:16:14,230 --> 00:16:18,190
<font color="#CCCCCC">installs what it was previously called</font><font color="#E5E5E5"> i</font>

417
00:16:16,149 --> 00:16:20,529
changed that as well so<font color="#CCCCCC"> get different</font>

418
00:16:18,190 --> 00:16:22,630
hash but yeah<font color="#E5E5E5"> i still rename the file</font>

419
00:16:20,529 --> 00:16:24,240
instead of<font color="#E5E5E5"> going right click rename i</font>

420
00:16:22,630 --> 00:16:27,610
opened it in a hex editor and renamed it

421
00:16:24,240 --> 00:16:30,639
basically the same thing not a difficult

422
00:16:27,610 --> 00:16:32,019
thing at all um but we're<font color="#CCCCCC"> at we're at 20</font>

423
00:16:30,639 --> 00:16:33,880
<font color="#E5E5E5">already and we haven't really done a lot</font>

424
00:16:32,019 --> 00:16:37,779
<font color="#CCCCCC">i would target by the end of the day</font>

425
00:16:33,880 --> 00:16:39,100
I'll be<font color="#CCCCCC"> 0 now the problem with</font>

426
00:16:37,779 --> 00:16:41,699
virustotal and the problem with playing

427
00:16:39,100 --> 00:16:44,740
around with the system or a guess and

428
00:16:41,699 --> 00:16:46,569
naive item number<font color="#CCCCCC"> two a lot of</font><font color="#E5E5E5"> people</font>

429
00:16:44,740 --> 00:16:49,810
don't realize<font color="#CCCCCC"> that</font><font color="#E5E5E5"> although virustotal</font>

430
00:16:46,570 --> 00:16:51,790
deploys a lot of antivirus engines 57

431
00:16:49,810 --> 00:16:54,339
ish engines depending on which day you

432
00:16:51,790 --> 00:16:58,269
catch it on and it doesn't deploy the

433
00:16:54,339 --> 00:17:00,070
full capability of those scanners so you

434
00:16:58,269 --> 00:17:02,230
<font color="#E5E5E5">might get a zero score on the front page</font>

435
00:17:00,070 --> 00:17:03,640
of virus total and then deploy it on a

436
00:17:02,230 --> 00:17:05,049
penetration test I'll deploy it when

437
00:17:03,640 --> 00:17:07,000
you're<font color="#E5E5E5"> pushing out your</font><font color="#CCCCCC"> ransom</font><font color="#E5E5E5"> we're</font>

438
00:17:05,049 --> 00:17:09,280
<font color="#E5E5E5">making your millions and it gets picked</font>

439
00:17:07,000 --> 00:17:12,280
up and that's frustrating<font color="#E5E5E5"> but we'll get</font>

440
00:17:09,280 --> 00:17:13,959
<font color="#CCCCCC">around there in a second and for those</font>

441
00:17:12,280 --> 00:17:15,609
<font color="#E5E5E5">that think I'm making that up no it's in</font>

442
00:17:13,959 --> 00:17:17,530
their faq they don't hide this fact

443
00:17:15,609 --> 00:17:19,479
<font color="#CCCCCC">Myra's total doesn't deploy the full</font>

444
00:17:17,530 --> 00:17:21,339
capability of each scanning engine don't

445
00:17:19,480 --> 00:17:23,860
worry you<font color="#E5E5E5"> don't have to read</font><font color="#CCCCCC"> that so</font>

446
00:17:21,339 --> 00:17:26,678
that you can trust me they<font color="#CCCCCC"> just use</font>

447
00:17:23,859 --> 00:17:28,149
command line versions of it deploy most

448
00:17:26,679 --> 00:17:29,860
of the<font color="#E5E5E5"> signature engines some of the</font>

449
00:17:28,150 --> 00:17:32,049
behavioral engines if you want virus

450
00:17:29,860 --> 00:17:34,090
<font color="#CCCCCC">orals for hair</font><font color="#E5E5E5"> real engine there's a</font>

451
00:17:32,049 --> 00:17:37,350
separate tab for it so scanners on the

452
00:17:34,090 --> 00:17:39,370
front page the<font color="#CCCCCC"> heavier on the fifth edge</font>

453
00:17:37,350 --> 00:17:40,870
so we're going to<font color="#CCCCCC"> start on the front</font>

454
00:17:39,370 --> 00:17:42,428
page bypass that we're going<font color="#E5E5E5"> to use</font>

455
00:17:40,870 --> 00:17:43,540
<font color="#E5E5E5">Krypton because it's pretty simple and</font>

456
00:17:42,429 --> 00:17:48,580
<font color="#CCCCCC">I'm going to look at the haverhill</font>

457
00:17:43,540 --> 00:17:51,668
engine and mess with it minka with it so

458
00:17:48,580 --> 00:17:53,530
I'm Krypton from that slide of like

459
00:17:51,669 --> 00:17:54,850
seven different evasion techniques

460
00:17:53,530 --> 00:17:56,800
crip gangs the one that<font color="#CCCCCC"> you're going</font><font color="#E5E5E5"> to</font>

461
00:17:54,850 --> 00:17:58,209
want<font color="#E5E5E5"> to go with if you're doing an E</font>

462
00:17:56,800 --> 00:18:00,879
virus evasion without actually learning

463
00:17:58,210 --> 00:18:02,170
how to program if you're a ransomware

464
00:18:00,880 --> 00:18:04,330
author and you want to write ransomware

465
00:18:02,170 --> 00:18:05,560
entirely from<font color="#E5E5E5"> stack overflow so</font>

466
00:18:04,330 --> 00:18:06,760
<font color="#E5E5E5">crippling is a really difficult thing to</font>

467
00:18:05,560 --> 00:18:08,770
actually pull off and it involves

468
00:18:06,760 --> 00:18:10,660
assembly and probably a difficult

469
00:18:08,770 --> 00:18:12,730
language to write<font color="#CCCCCC"> likessee brilliant</font>

470
00:18:10,660 --> 00:18:16,060
thing is and someone's already done it

471
00:18:12,730 --> 00:18:18,190
for you in fact there's a lot of working

472
00:18:16,060 --> 00:18:21,730
examples out there good one at the

473
00:18:18,190 --> 00:18:24,610
bottom hacked team hacking team

474
00:18:21,730 --> 00:18:27,720
graciously lent as their<font color="#CCCCCC"> krypter which</font>

475
00:18:24,610 --> 00:18:30,490
is nice of them the one in<font color="#E5E5E5"> the middle</font>

476
00:18:27,720 --> 00:18:33,190
presumably not familiar this it's a it's

477
00:18:30,490 --> 00:18:35,590
<font color="#CCCCCC">a tutorial it's a full walkthrough 99</font>

478
00:18:33,190 --> 00:18:37,210
page walkthrough on how<font color="#CCCCCC"> a rate corrector</font>

479
00:18:35,590 --> 00:18:38,620
where the give you example code the

480
00:18:37,210 --> 00:18:40,900
whole way through and<font color="#CCCCCC"> then at the end</font>

481
00:18:38,620 --> 00:18:42,310
<font color="#E5E5E5">they give you a working solution top</font>

482
00:18:40,900 --> 00:18:44,590
ones another example of that is actually

483
00:18:42,310 --> 00:18:46,990
a<font color="#E5E5E5"> compressors it sort of hacker not</font>

484
00:18:44,590 --> 00:18:49,419
correct over<font color="#CCCCCC"> so same area takes an</font>

485
00:18:46,990 --> 00:18:53,010
executable modifies it in aware that

486
00:18:49,420 --> 00:18:57,720
antivirus on pick up signatures and then

487
00:18:53,010 --> 00:18:59,740
you bypass the signature engine now a

488
00:18:57,720 --> 00:19:01,990
crypt is going to allow<font color="#E5E5E5"> you to bypass a</font>

489
00:18:59,740 --> 00:19:03,790
signature engine quite well these<font color="#E5E5E5"> crypt</font>

490
00:19:01,990 --> 00:19:05,680
<font color="#E5E5E5">is however those should be detected</font>

491
00:19:03,790 --> 00:19:07,030
<font color="#E5E5E5">their decryption stubs should be picked</font>

492
00:19:05,680 --> 00:19:11,200
up straight away the reason<font color="#E5E5E5"> for that is</font>

493
00:19:07,030 --> 00:19:14,410
one of those<font color="#E5E5E5"> is 13 years old now what's</font>

494
00:19:11,200 --> 00:19:16,090
just fine actually<font color="#CCCCCC"> so we work 25</font>

495
00:19:14,410 --> 00:19:19,060
originally got it down<font color="#CCCCCC"> to 20 my rename</font>

496
00:19:16,090 --> 00:19:22,480
the file got<font color="#E5E5E5"> it down to 12 by using a 13</font>

497
00:19:19,060 --> 00:19:25,600
<font color="#E5E5E5">year old evasion tool and</font><font color="#CCCCCC"> the virus is</font>

498
00:19:22,480 --> 00:19:27,160
awesome meal and so you download a tool

499
00:19:25,600 --> 00:19:28,750
you don't even learn how<font color="#CCCCCC"> to program you</font>

500
00:19:27,160 --> 00:19:31,050
run out the tools engine should be

501
00:19:28,750 --> 00:19:34,090
picked up in it kind of is picked<font color="#E5E5E5"> up but</font>

502
00:19:31,050 --> 00:19:35,530
so far we're almost all the way there in

503
00:19:34,090 --> 00:19:37,899
terms of antivirus evasion<font color="#E5E5E5"> we're not</font>

504
00:19:35,530 --> 00:19:39,010
done anything Lee and sorry what people

505
00:19:37,900 --> 00:19:41,710
expected me to<font color="#E5E5E5"> come in</font><font color="#CCCCCC"> here and drop</font>

506
00:19:39,010 --> 00:19:46,150
<font color="#CCCCCC">zero days and</font><font color="#E5E5E5"> stuff I</font><font color="#CCCCCC"> totally will when</font>

507
00:19:41,710 --> 00:19:47,980
I need to when a veg off when a version

508
00:19:46,150 --> 00:19:49,300
is difficult but there's still 12

509
00:19:47,980 --> 00:19:51,250
detections to get through<font color="#E5E5E5"> and we're</font>

510
00:19:49,300 --> 00:19:55,000
still going to continue on a naive

511
00:19:51,250 --> 00:19:57,310
evasion techniques sec look at some

512
00:19:55,000 --> 00:20:00,730
hacks then we feel like real hackers I

513
00:19:57,310 --> 00:20:02,020
opened a hex editor I am Lee so one of

514
00:20:00,730 --> 00:20:04,390
<font color="#E5E5E5">the problems and one of the reasons that</font>

515
00:20:02,020 --> 00:20:07,360
those 12 detection still<font color="#CCCCCC"> exists is the</font>

516
00:20:04,390 --> 00:20:09,130
fact that although the signature engine

517
00:20:07,360 --> 00:20:11,229
can't take a look at the sea and work

518
00:20:09,130 --> 00:20:14,050
out what the patterns are what it can do

519
00:20:11,230 --> 00:20:18,910
is take a look at the exe and say that's

520
00:20:14,050 --> 00:20:20,919
encrypted that looks weird and the way

521
00:20:18,910 --> 00:20:23,020
<font color="#E5E5E5">that it does this is it checks the</font>

522
00:20:20,920 --> 00:20:25,420
entropy of each section in of the

523
00:20:23,020 --> 00:20:27,250
entropy is particularly high above<font color="#E5E5E5"> 5</font>

524
00:20:25,420 --> 00:20:29,530
generally for anyone who wants<font color="#CCCCCC"> to get</font>

525
00:20:27,250 --> 00:20:31,920
into<font color="#E5E5E5"> the specifics it goes that's</font>

526
00:20:29,530 --> 00:20:36,070
<font color="#E5E5E5">encrypted at best flag it just in</font><font color="#CCCCCC"> case</font>

527
00:20:31,920 --> 00:20:39,190
so how do we drop the entropy a naive

528
00:20:36,070 --> 00:20:41,980
aversion step 3 throw a load of null

529
00:20:39,190 --> 00:20:44,140
bytes in there that is two lines of<font color="#CCCCCC"> C</font>

530
00:20:41,980 --> 00:20:46,030
really<font color="#E5E5E5"> sorry i did say</font><font color="#CCCCCC"> doctor learn any</font>

531
00:20:44,140 --> 00:20:49,620
programming you're going to<font color="#E5E5E5"> have to find</font>

532
00:20:46,030 --> 00:20:52,000
on Stack Overflow how to do a for loop

533
00:20:49,620 --> 00:20:53,949
and still for loop sticks and all<font color="#CCCCCC"> bikes</font>

534
00:20:52,000 --> 00:20:57,490
in there<font color="#E5E5E5"> and you get detection is down</font>

535
00:20:53,950 --> 00:20:58,660
even further so yeah they're detecting

536
00:20:57,490 --> 00:21:00,160
near the entropy and that's all<font color="#E5E5E5"> looking</font>

537
00:20:58,660 --> 00:21:02,110
<font color="#E5E5E5">to technically under that context from a</font>

538
00:21:00,160 --> 00:21:03,640
signature analysis engine drop the

539
00:21:02,110 --> 00:21:06,610
interview with no bites it's pretty easy

540
00:21:03,640 --> 00:21:09,430
the<font color="#E5E5E5"> next problem though is the fact that</font>

541
00:21:06,610 --> 00:21:10,810
the<font color="#CCCCCC"> behavioral engines are going to kick</font>

542
00:21:09,430 --> 00:21:12,580
in now we've successfully<font color="#CCCCCC"> bypass</font>

543
00:21:10,810 --> 00:21:14,590
signature engines this is not cool we

544
00:21:12,580 --> 00:21:17,800
did this<font color="#CCCCCC"> 10 years</font><font color="#E5E5E5"> ago</font><font color="#CCCCCC"> behavioral engine</font>

545
00:21:14,590 --> 00:21:20,230
kicks in if I encrypt my exe<font color="#CCCCCC"> the</font>

546
00:21:17,800 --> 00:21:22,090
behavioral engine execute<font color="#E5E5E5"> it as dynamic</font>

547
00:21:20,230 --> 00:21:24,460
analysis actually<font color="#E5E5E5"> fires it up in a</font>

548
00:21:22,090 --> 00:21:26,980
virtualized or emulated environment and

549
00:21:24,460 --> 00:21:29,320
watches execute so yeah I hid the

550
00:21:26,980 --> 00:21:31,780
<font color="#E5E5E5">patterns but as soon as the executable</font>

551
00:21:29,320 --> 00:21:33,639
runs they'll work out what it was

552
00:21:31,780 --> 00:21:35,980
they'll work out that<font color="#E5E5E5"> if in fact in this</font>

553
00:21:33,640 --> 00:21:37,930
case is min accounts so how do we<font color="#CCCCCC"> get</font>

554
00:21:35,980 --> 00:21:39,730
around<font color="#E5E5E5"> the behavioral engines and well</font>

555
00:21:37,930 --> 00:21:42,430
we take<font color="#E5E5E5"> a look at how they actually work</font>

556
00:21:39,730 --> 00:21:43,450
and we<font color="#E5E5E5"> take a look at that don't be mean</font>

557
00:21:42,430 --> 00:21:45,280
to the vendors they've got some

558
00:21:43,450 --> 00:21:47,620
difficult<font color="#E5E5E5"> challenges some difficult</font>

559
00:21:45,280 --> 00:21:49,149
problems it's a hard problem and one of

560
00:21:47,620 --> 00:21:51,280
<font color="#CCCCCC">the things that they're living with the</font>

561
00:21:49,150 --> 00:21:52,370
reality of they can<font color="#E5E5E5"> only scan for a</font>

562
00:21:51,280 --> 00:21:55,460
finite<font color="#E5E5E5"> amount of</font>

563
00:21:52,370 --> 00:21:57,620
I'm so if I can stall<font color="#E5E5E5"> the scanner long</font>

564
00:21:55,460 --> 00:21:59,450
<font color="#E5E5E5">enough that you know</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> do anything</font>

565
00:21:57,620 --> 00:22:02,090
malicious for the however long it scans

566
00:21:59,450 --> 00:22:04,280
for I can evade them that way a really

567
00:22:02,090 --> 00:22:06,020
good<font color="#E5E5E5"> example of</font><font color="#CCCCCC"> this is Google's player</font>

568
00:22:04,280 --> 00:22:07,700
store when they implemented their

569
00:22:06,020 --> 00:22:10,879
detection system their dynamic analysis

570
00:22:07,700 --> 00:22:13,100
called bouncer a researcher found out

571
00:22:10,880 --> 00:22:14,750
that if<font color="#E5E5E5"> you just wait five minutes</font>

572
00:22:13,100 --> 00:22:16,699
before doing anything malicious it

573
00:22:14,750 --> 00:22:18,620
bypasses that protection mechanism and

574
00:22:16,700 --> 00:22:20,450
it seems true the behavioral engines

575
00:22:18,620 --> 00:22:22,219
that I see apart from generally the ones

576
00:22:20,450 --> 00:22:24,410
that I work with the time that's a lot

577
00:22:22,220 --> 00:22:26,840
shorter<font color="#CCCCCC"> it's like 45 seconds on average</font>

578
00:22:24,410 --> 00:22:29,630
so the scanning engine chokes the XC 4

579
00:22:26,840 --> 00:22:31,879
45 seconds if<font color="#E5E5E5"> it if it doesn't do</font>

580
00:22:29,630 --> 00:22:34,730
<font color="#E5E5E5">anything bad they let to go through so</font>

581
00:22:31,880 --> 00:22:37,370
how do we stall for that time well if i

582
00:22:34,730 --> 00:22:38,870
<font color="#E5E5E5">just did sleep 45 at the top of my exe</font>

583
00:22:37,370 --> 00:22:40,340
obviously they're going to pick<font color="#E5E5E5"> up on</font>

584
00:22:38,870 --> 00:22:42,020
that they're<font color="#E5E5E5"> going to mess with the</font>

585
00:22:40,340 --> 00:22:43,760
system because<font color="#CCCCCC"> they're virtualizing are</font>

586
00:22:42,020 --> 00:22:45,470
emulating to have that benefit of that

587
00:22:43,760 --> 00:22:46,910
can increase the clock speed they<font color="#CCCCCC"> can</font>

588
00:22:45,470 --> 00:22:48,679
jump forward a day they can<font color="#E5E5E5"> jump forward</font>

589
00:22:46,910 --> 00:22:50,870
seven days things like that mess around

590
00:22:48,679 --> 00:22:53,660
<font color="#E5E5E5">with our execution environment I can't</font>

591
00:22:50,870 --> 00:22:57,500
just stall for 45 seconds one thing that

592
00:22:53,660 --> 00:23:00,080
<font color="#E5E5E5">can do though well I encrypted</font><font color="#CCCCCC"> my exe so</font>

593
00:22:57,500 --> 00:23:02,510
instead of including<font color="#CCCCCC"> the key in my</font>

594
00:23:00,080 --> 00:23:05,090
executable just brute force it at

595
00:23:02,510 --> 00:23:06,650
runtime and then if they step forward<font color="#E5E5E5"> if</font>

596
00:23:05,090 --> 00:23:08,689
<font color="#E5E5E5">this got oh now it's tomorrow</font><font color="#CCCCCC"> and now</font>

597
00:23:06,650 --> 00:23:10,340
it's<font color="#E5E5E5"> a weekend in the future kill still</font>

598
00:23:08,690 --> 00:23:11,660
<font color="#E5E5E5">don't know what the password is still</font>

599
00:23:10,340 --> 00:23:13,040
got to keep going and working on that

600
00:23:11,660 --> 00:23:15,080
password and again this is an old

601
00:23:13,040 --> 00:23:16,340
technique 2012 i think that technique

602
00:23:15,080 --> 00:23:20,629
came out it's implemented in Hyperion

603
00:23:16,340 --> 00:23:22,280
and academic purple is red so<font color="#CCCCCC"> again a</font>

604
00:23:20,630 --> 00:23:24,770
really naive way of getting around that

605
00:23:22,280 --> 00:23:26,360
that was 10 lines of<font color="#E5E5E5"> C for anyone who's</font>

606
00:23:24,770 --> 00:23:29,389
looking up the stack overflow<font color="#E5E5E5"> are called</font>

607
00:23:26,360 --> 00:23:31,399
<font color="#CCCCCC">that</font><font color="#E5E5E5"> take the password out run another</font>

608
00:23:29,390 --> 00:23:33,830
for loop I'm sorry<font color="#CCCCCC"> two for loops in one</font>

609
00:23:31,400 --> 00:23:36,350
day I know and brew foster on key and

610
00:23:33,830 --> 00:23:38,510
then that way you guarantee that you've

611
00:23:36,350 --> 00:23:41,629
delayed execution for the amount<font color="#E5E5E5"> of time</font>

612
00:23:38,510 --> 00:23:44,450
<font color="#CCCCCC">in</font><font color="#E5E5E5"> in most cases they evaded most</font>

613
00:23:41,630 --> 00:23:45,910
antivirus doing that technique again

614
00:23:44,450 --> 00:23:50,970
like a<font color="#CCCCCC"> four-year-old</font><font color="#E5E5E5"> technique and</font>

615
00:23:45,910 --> 00:23:53,130
however<font color="#E5E5E5"> going back a second 12 detection</font>

616
00:23:50,970 --> 00:23:54,750
tell the sections ok<font color="#E5E5E5"> like we're almost</font>

617
00:23:53,130 --> 00:23:57,120
all the way there but 12 still high

618
00:23:54,750 --> 00:24:00,720
number got this Hyperion thing to play

619
00:23:57,120 --> 00:24:02,340
with 12 12 12 that's annoying me scroll

620
00:24:00,720 --> 00:24:04,260
<font color="#CCCCCC">down the page a little</font><font color="#E5E5E5"> bit and we've got</font>

621
00:24:02,340 --> 00:24:05,970
the actual detection what this is

622
00:24:04,260 --> 00:24:08,250
virustotal<font color="#CCCCCC"> amusing here but or the</font>

623
00:24:05,970 --> 00:24:09,360
scanner engines exist<font color="#CCCCCC"> first virus</font>

624
00:24:08,250 --> 00:24:11,370
<font color="#E5E5E5">thought tells you what you're being</font>

625
00:24:09,360 --> 00:24:12,479
picked up for now you won't be<font color="#E5E5E5"> able to</font>

626
00:24:11,370 --> 00:24:15,870
see<font color="#E5E5E5"> it at the back but those are the</font>

627
00:24:12,480 --> 00:24:17,820
front this is custom code that I've

628
00:24:15,870 --> 00:24:21,000
written that no one has seen before and

629
00:24:17,820 --> 00:24:24,960
yet six of the engines give it<font color="#E5E5E5"> the exact</font>

630
00:24:21,000 --> 00:24:28,950
same name how did they all decide on the

631
00:24:24,960 --> 00:24:31,350
CNN they're<font color="#E5E5E5"> all the same engine it's not</font>

632
00:24:28,950 --> 00:24:35,070
12 scanning engines and those six in

633
00:24:31,350 --> 00:24:37,340
this case that's bitdefender so<font color="#CCCCCC"> x secure</font>

634
00:24:35,070 --> 00:24:40,110
use bitdefender's and your virus engine

635
00:24:37,340 --> 00:24:41,520
again they don't hide this fact to read

636
00:24:40,110 --> 00:24:43,860
the refuse go on the forums and<font color="#E5E5E5"> they</font>

637
00:24:41,520 --> 00:24:45,539
said<font color="#E5E5E5"> that yes we</font><font color="#CCCCCC"> licensed bitdefender</font>

638
00:24:43,860 --> 00:24:46,830
and f-secure make their money<font color="#E5E5E5"> and all of</font>

639
00:24:45,539 --> 00:24:48,900
the awesome research that they do and

640
00:24:46,830 --> 00:24:50,960
<font color="#CCCCCC">other things the value-add isn't the</font>

641
00:24:48,900 --> 00:24:53,270
engine it's the things around<font color="#E5E5E5"> the</font><font color="#CCCCCC"> engine</font>

642
00:24:50,960 --> 00:24:57,000
awesome company one of<font color="#E5E5E5"> my favorites but</font>

643
00:24:53,270 --> 00:24:58,440
naive item number four is the enemy

644
00:24:57,000 --> 00:25:00,539
isn't as numerous as we think they are

645
00:24:58,440 --> 00:25:03,150
it's not 57 scanning engines that were

646
00:25:00,539 --> 00:25:05,158
betting<font color="#CCCCCC"> its small collections of them</font>

647
00:25:03,150 --> 00:25:08,460
and the way<font color="#E5E5E5"> that we can bypass them is</font>

648
00:25:05,159 --> 00:25:10,169
you know through these simple little

649
00:25:08,460 --> 00:25:12,450
jumps whoever dropping out five a time

650
00:25:10,169 --> 00:25:13,770
the<font color="#E5E5E5"> reason we're dropping handfuls at</font>

651
00:25:12,450 --> 00:25:16,590
time is because<font color="#E5E5E5"> we're just by passing</font>

652
00:25:13,770 --> 00:25:18,299
one of the engines so if you couldn't

653
00:25:16,590 --> 00:25:20,520
read that forum post i increased it here

654
00:25:18,299 --> 00:25:22,639
this is f-secure saying yes we use

655
00:25:20,520 --> 00:25:27,900
bitdefender enough corporate products

656
00:25:22,640 --> 00:25:29,549
now and what<font color="#CCCCCC"> i</font><font color="#E5E5E5"> was doing originally was</font>

657
00:25:27,900 --> 00:25:32,159
hanging up to<font color="#E5E5E5"> part two of this talk</font>

658
00:25:29,549 --> 00:25:34,918
where we've joined in now is I was just

659
00:25:32,159 --> 00:25:37,530
arbitrarily messing with an executable

660
00:25:34,919 --> 00:25:39,179
to see if the detection went down trying

661
00:25:37,530 --> 00:25:40,530
things oh I wonder<font color="#E5E5E5"> if I rename it well</font>

662
00:25:39,179 --> 00:25:42,960
the detection is go down oh yeah they

663
00:25:40,530 --> 00:25:44,970
did that's awesome just blindly changing

664
00:25:42,960 --> 00:25:47,820
things<font color="#CCCCCC"> and at this point this is when I</font>

665
00:25:44,970 --> 00:25:49,559
said well maybe I can use some<font color="#E5E5E5"> of the</font>

666
00:25:47,820 --> 00:25:51,240
penetration texting skills that I've got

667
00:25:49,559 --> 00:25:52,770
<font color="#E5E5E5">maybe I can take some of that red team</font>

668
00:25:51,240 --> 00:25:55,620
knowledge and get a little<font color="#CCCCCC"> bit more</font>

669
00:25:52,770 --> 00:25:57,600
visibility into the engines so taking a

670
00:25:55,620 --> 00:25:59,879
look again virustotal malware those

671
00:25:57,600 --> 00:26:03,010
types of scanning engines and

672
00:25:59,880 --> 00:26:05,289
the virtual I systems cloud provided

673
00:26:03,010 --> 00:26:07,690
system software as a service previous

674
00:26:05,289 --> 00:26:13,090
work has been done on detecting and

675
00:26:07,690 --> 00:26:17,140
avoiding virtualized systems I didn't do

676
00:26:13,090 --> 00:26:19,539
this<font color="#E5E5E5"> I wanted to avoid scanners</font><font color="#CCCCCC"> not</font>

677
00:26:17,140 --> 00:26:23,590
virtual systems if you're a ransomware

678
00:26:19,539 --> 00:26:26,169
author it doesn't<font color="#E5E5E5"> matter yeah argument</font>

679
00:26:23,590 --> 00:26:28,120
if you evade virtual systems if<font color="#E5E5E5"> you're</font>

680
00:26:26,169 --> 00:26:30,700
malware doesn't run on virtual servers

681
00:26:28,120 --> 00:26:32,699
then you can't target the virtual

682
00:26:30,700 --> 00:26:36,010
servers that the IT companies deploying

683
00:26:32,700 --> 00:26:38,500
ransomware authors<font color="#E5E5E5"> done they target the</font>

684
00:26:36,010 --> 00:26:39,940
end devices the target humans they don't

685
00:26:38,500 --> 00:26:41,500
go after<font color="#CCCCCC"> the servers they go after the</font>

686
00:26:39,940 --> 00:26:43,570
doctors<font color="#E5E5E5"> and</font><font color="#CCCCCC"> the nurses in the offices</font>

687
00:26:41,500 --> 00:26:46,480
and that's how they make<font color="#CCCCCC"> their money so</font>

688
00:26:43,570 --> 00:26:48,220
ransomware authors can do all of this

689
00:26:46,480 --> 00:26:50,080
cool stuff they can apply<font color="#E5E5E5"> all of this</font>

690
00:26:48,220 --> 00:26:52,059
previous research and there's a whole

691
00:26:50,080 --> 00:26:54,189
world of proof of<font color="#E5E5E5"> concepts in here for</font>

692
00:26:52,059 --> 00:26:56,408
them to do it I'm a penetration tester

693
00:26:54,190 --> 00:26:58,029
and sadly I do have to<font color="#E5E5E5"> hack service so</font>

694
00:26:56,409 --> 00:26:59,710
we're going to step past this section

695
00:26:58,029 --> 00:27:01,559
well there's an awful lot of work

696
00:26:59,710 --> 00:27:03,700
already done for bypassing

697
00:27:01,559 --> 00:27:05,980
virtualization instead of bypassing

698
00:27:03,700 --> 00:27:07,659
virtualization what I did was I took a

699
00:27:05,980 --> 00:27:10,029
look at some<font color="#E5E5E5"> real-world scanning engines</font>

700
00:27:07,659 --> 00:27:12,610
and I wanted to detect when I'm being

701
00:27:10,029 --> 00:27:15,429
scanned by the engine and then not be

702
00:27:12,610 --> 00:27:17,830
malicious oh I'm in virustotal<font color="#CCCCCC"> okay I'll</font>

703
00:27:15,429 --> 00:27:19,149
be a good girl for a little while so I

704
00:27:17,830 --> 00:27:20,408
took a look at a<font color="#E5E5E5"> few engines and they</font>

705
00:27:19,149 --> 00:27:23,549
all worked in roughly the same<font color="#E5E5E5"> where</font>

706
00:27:20,409 --> 00:27:25,750
from<font color="#E5E5E5"> the point of view of this but</font>

707
00:27:23,549 --> 00:27:28,389
another frustration with information

708
00:27:25,750 --> 00:27:31,000
security is there's a lot of<font color="#E5E5E5"> a lot of</font>

709
00:27:28,390 --> 00:27:32,980
techniques that have been<font color="#E5E5E5"> deployed</font>

710
00:27:31,000 --> 00:27:35,860
already that work as a lot of academic

711
00:27:32,980 --> 00:27:37,840
work out there to fix these<font color="#E5E5E5"> problems and</font>

712
00:27:35,860 --> 00:27:40,330
all of these naive little jumps and

713
00:27:37,840 --> 00:27:44,049
making shouldn't work shouldn't work but

714
00:27:40,330 --> 00:27:45,220
why did was these<font color="#E5E5E5"> systems are</font><font color="#CCCCCC"> very</font>

715
00:27:44,049 --> 00:27:47,020
strange<font color="#E5E5E5"> you've got remote command</font>

716
00:27:45,220 --> 00:27:48,669
execution on virus<font color="#CCCCCC"> tall</font><font color="#E5E5E5"> of course you</font>

717
00:27:47,020 --> 00:27:50,980
have you give it an exe<font color="#E5E5E5"> and it executes</font>

718
00:27:48,669 --> 00:27:52,990
sit that's a strange starting point for

719
00:27:50,980 --> 00:27:56,440
a penetration tester but all I need to

720
00:27:52,990 --> 00:27:57,789
do is detect we're now being scanned if

721
00:27:56,440 --> 00:27:59,289
I can detect on a being scanned and

722
00:27:57,789 --> 00:28:01,220
better yet which scanning engine are men

723
00:27:59,289 --> 00:28:04,010
I can not

724
00:28:01,220 --> 00:28:06,860
do my<font color="#CCCCCC"> militia for heavier now the system</font>

725
00:28:04,010 --> 00:28:08,330
<font color="#E5E5E5">isn't going to let me just export a list</font>

726
00:28:06,860 --> 00:28:10,250
of well it's not gonna<font color="#E5E5E5"> let me map it</font>

727
00:28:08,330 --> 00:28:12,110
it's not going to say I hey virustotal

728
00:28:10,250 --> 00:28:13,909
can you give me a list of all of your

729
00:28:12,110 --> 00:28:16,280
files all of you users all of your

730
00:28:13,909 --> 00:28:17,960
running services and any other

731
00:28:16,280 --> 00:28:19,340
information<font color="#E5E5E5"> that you can think of so</font>

732
00:28:17,960 --> 00:28:20,809
that<font color="#E5E5E5"> i can draw an accurate map of the</font>

733
00:28:19,340 --> 00:28:23,689
scanner they're going to block you from

734
00:28:20,809 --> 00:28:25,370
doing that in<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> way that when</font>

735
00:28:23,690 --> 00:28:27,230
you're doing a web application

736
00:28:25,370 --> 00:28:30,049
penetration testing you're exploiting

737
00:28:27,230 --> 00:28:31,820
sequel injection the system might hide

738
00:28:30,049 --> 00:28:34,129
our messages from you it might hide that

739
00:28:31,820 --> 00:28:35,629
kind of information and blind sequel

740
00:28:34,130 --> 00:28:37,669
<font color="#E5E5E5">injection is a thing that's existed for</font>

741
00:28:35,630 --> 00:28:38,960
a long time some people in the room who

742
00:28:37,669 --> 00:28:40,400
do web application testing right now

743
00:28:38,960 --> 00:28:41,510
we're going to be<font color="#E5E5E5"> like why are we</font>

744
00:28:40,400 --> 00:28:43,280
talking about sequel injection all of a

745
00:28:41,510 --> 00:28:45,620
sudden because<font color="#CCCCCC"> the technique is</font><font color="#E5E5E5"> the same</font>

746
00:28:43,280 --> 00:28:48,230
so the<font color="#E5E5E5"> system won't let me just dump a</font>

747
00:28:45,620 --> 00:28:49,629
whole list of files but these systems do

748
00:28:48,230 --> 00:28:52,100
tell you the behavior that the

749
00:28:49,630 --> 00:28:53,659
executable talk they go out created

750
00:28:52,100 --> 00:28:57,740
these files that wrote these registry

751
00:28:53,659 --> 00:29:00,980
systems so in the most naive of ways<font color="#E5E5E5"> I</font>

752
00:28:57,740 --> 00:29:02,929
could just say<font color="#E5E5E5"> okay try and create a</font>

753
00:29:00,980 --> 00:29:05,120
file for every file that exists<font color="#E5E5E5"> on the</font>

754
00:29:02,929 --> 00:29:06,679
system<font color="#E5E5E5"> and then in the event log again</font>

755
00:29:05,120 --> 00:29:08,479
<font color="#CCCCCC">an error oh I tried to write all of</font>

756
00:29:06,679 --> 00:29:10,070
these files but I couldn't because those

757
00:29:08,480 --> 00:29:12,559
files exist so that's one<font color="#CCCCCC"> way of pulling</font>

758
00:29:10,070 --> 00:29:14,899
out alternatively<font color="#CCCCCC"> you could you know</font>

759
00:29:12,559 --> 00:29:17,750
<font color="#E5E5E5">elasa directory get a list of files</font>

760
00:29:14,900 --> 00:29:20,990
encode them pull them out that way or

761
00:29:17,750 --> 00:29:24,620
the hardest method to<font color="#E5E5E5"> be would be to use</font>

762
00:29:20,990 --> 00:29:26,120
boolean<font color="#E5E5E5"> and boolean inference which is</font>

763
00:29:24,620 --> 00:29:28,850
kind<font color="#E5E5E5"> of same thing we would do through</font>

764
00:29:26,120 --> 00:29:30,350
sequel injection I might take a value

765
00:29:28,850 --> 00:29:32,629
that<font color="#CCCCCC"> I want</font><font color="#E5E5E5"> to extract from a system</font>

766
00:29:30,350 --> 00:29:35,299
like the name of the current running

767
00:29:32,630 --> 00:29:37,220
user and also<font color="#E5E5E5"> oh if the first letter of</font>

768
00:29:35,299 --> 00:29:39,260
the current user is air perform this

769
00:29:37,220 --> 00:29:40,940
action if it's being perform that action

770
00:29:39,260 --> 00:29:42,590
<font color="#E5E5E5">its see perform that action and</font>

771
00:29:40,940 --> 00:29:44,240
therefore when I look at the output of

772
00:29:42,590 --> 00:29:47,480
<font color="#E5E5E5">the Behavioral Analysis engine I can</font>

773
00:29:44,240 --> 00:29:48,830
infer what these variables were now<font color="#E5E5E5"> the</font>

774
00:29:47,480 --> 00:29:50,539
reason that<font color="#E5E5E5"> I've given you all three of</font>

775
00:29:48,830 --> 00:29:52,580
those options<font color="#CCCCCC"> there from the very simple</font>

776
00:29:50,539 --> 00:29:54,590
literally listing files right down to

777
00:29:52,580 --> 00:29:57,110
boolean inference it's a fact that<font color="#E5E5E5"> this</font>

778
00:29:54,590 --> 00:29:58,730
<font color="#CCCCCC">is a hard problem so I'm saying that I</font>

779
00:29:57,110 --> 00:30:00,740
<font color="#E5E5E5">can map these scanners and I've written</font>

780
00:29:58,730 --> 00:30:02,360
a tool that will say hey I'm virustotal

781
00:30:00,740 --> 00:30:04,380
please don't do anything malicious and

782
00:30:02,360 --> 00:30:07,139
but the problem is difficult for

783
00:30:04,380 --> 00:30:09,150
<font color="#E5E5E5">effect so you know please don't please</font>

784
00:30:07,140 --> 00:30:11,880
please don't be mean to the vendors but

785
00:30:09,150 --> 00:30:13,170
however I write a tool it<font color="#CCCCCC"> Maps thyristor</font>

786
00:30:11,880 --> 00:30:14,460
<font color="#CCCCCC">the maps malware it gives me a whole</font>

787
00:30:13,170 --> 00:30:17,040
list of everything that's going on in

788
00:30:14,460 --> 00:30:18,330
<font color="#E5E5E5">those systems yeah let that one run</font>

789
00:30:17,040 --> 00:30:20,430
overnight that<font color="#E5E5E5"> took a long time</font>

790
00:30:18,330 --> 00:30:23,129
especially the whole pulling things out

791
00:30:20,430 --> 00:30:25,200
character at a time thing put your map

792
00:30:23,130 --> 00:30:27,150
the system and then you<font color="#E5E5E5"> don't give a</font>

793
00:30:25,200 --> 00:30:29,490
demo even though the slide says that I'm

794
00:30:27,150 --> 00:30:31,500
supposed to give a demo because we're<font color="#E5E5E5"> on</font>

795
00:30:29,490 --> 00:30:33,600
laptop number two right now<font color="#E5E5E5"> due to IT</font>

796
00:30:31,500 --> 00:30:36,570
difficulties if anyone wants<font color="#E5E5E5"> to see the</font>

797
00:30:33,600 --> 00:30:38,520
demo however I can show it<font color="#E5E5E5"> later on shot</font>

798
00:30:36,570 --> 00:30:40,800
<font color="#E5E5E5">some groups and things and there are</font>

799
00:30:38,520 --> 00:30:43,310
some screenshots of the<font color="#CCCCCC"> tool working so</font>

800
00:30:40,800 --> 00:30:46,290
we'll go through<font color="#E5E5E5"> those and center but I</font>

801
00:30:43,310 --> 00:30:48,690
can<font color="#CCCCCC"> achieve a zero</font><font color="#E5E5E5"> score and virus</font><font color="#CCCCCC"> toll</font>

802
00:30:46,290 --> 00:30:52,860
and I can control what the output<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

803
00:30:48,690 --> 00:30:55,380
behavioral engine is if I run the exe on

804
00:30:52,860 --> 00:30:57,330
my laptop it does bad<font color="#CCCCCC"> things if I run it</font>

805
00:30:55,380 --> 00:30:59,280
on virustotal it doesn't do bad things

806
00:30:57,330 --> 00:31:00,899
on malware or<font color="#E5E5E5"> expert or any of your</font>

807
00:30:59,280 --> 00:31:03,960
online scanning engines all the same

808
00:31:00,900 --> 00:31:06,660
issue so<font color="#E5E5E5"> I can control what the IT admin</font>

809
00:31:03,960 --> 00:31:08,760
sees and I think that's a bad thing

810
00:31:06,660 --> 00:31:11,160
antivirus evasion is a bad thing the

811
00:31:08,760 --> 00:31:13,610
ability to control a scanning engine is

812
00:31:11,160 --> 00:31:16,860
a bad thing so report it to<font color="#E5E5E5"> google i</font>

813
00:31:13,610 --> 00:31:18,479
said hey google a bit of a vulnerability

814
00:31:16,860 --> 00:31:22,919
it's a bit of a weird on what i can do

815
00:31:18,480 --> 00:31:24,870
is i can a very gently worse and<font color="#E5E5E5"> google</font>

816
00:31:22,920 --> 00:31:27,180
wrote back you're never going to read

817
00:31:24,870 --> 00:31:29,750
that made it bigger it's still probably

818
00:31:27,180 --> 00:31:32,760
not going to read that and how's that<font color="#CCCCCC"> um</font>

819
00:31:29,750 --> 00:31:35,130
so I<font color="#E5E5E5"> said to virus hall I can map your</font>

820
00:31:32,760 --> 00:31:36,900
scanning engine and using the map

821
00:31:35,130 --> 00:31:39,240
information i can<font color="#E5E5E5"> write a tool that will</font>

822
00:31:36,900 --> 00:31:40,980
accurately detect that<font color="#E5E5E5"> i am in your</font>

823
00:31:39,240 --> 00:31:43,410
scanning engine and therefore my malware

824
00:31:40,980 --> 00:31:49,380
won't perform any malicious behavior and

825
00:31:43,410 --> 00:31:51,540
therefore it's not detected apparently

826
00:31:49,380 --> 00:31:52,980
<font color="#E5E5E5">that's what happened this is not a</font>

827
00:31:51,540 --> 00:31:54,659
security vulnerability<font color="#E5E5E5"> I'm really sorry</font>

828
00:31:52,980 --> 00:31:56,130
<font color="#E5E5E5">guys I pulled you in for a 40-minute</font>

829
00:31:54,660 --> 00:32:01,200
talk about something<font color="#E5E5E5"> that's not security</font>

830
00:31:56,130 --> 00:32:04,080
vulnerability yeah I reckon it is so

831
00:32:01,200 --> 00:32:05,850
what i can do is my tool that I did say

832
00:32:04,080 --> 00:32:07,199
I was going<font color="#E5E5E5"> to release today but I use</font>

833
00:32:05,850 --> 00:32:09,870
two-factor authentication<font color="#CCCCCC"> uh my phone</font>

834
00:32:07,200 --> 00:32:10,460
died so now I now locked out of the

835
00:32:09,870 --> 00:32:12,290
<font color="#CCCCCC">internet</font>

836
00:32:10,460 --> 00:32:15,440
which is the<font color="#CCCCCC"> problem I won't be unfair</font>

837
00:32:12,290 --> 00:32:17,149
to death yeah but I will release the

838
00:32:15,440 --> 00:32:19,340
code and the full write-up of everything

839
00:32:17,150 --> 00:32:21,350
I'm saying right<font color="#CCCCCC"> now tonight or whenever</font>

840
00:32:19,340 --> 00:32:23,540
someone gets me an iphone charger and

841
00:32:21,350 --> 00:32:25,310
put my kill which is free for the open

842
00:32:23,540 --> 00:32:26,990
world can detect not only if<font color="#E5E5E5"> it's</font>

843
00:32:25,310 --> 00:32:29,690
virtualized in which virtual system it's

844
00:32:26,990 --> 00:32:31,340
in lying here it doesn't do then and

845
00:32:29,690 --> 00:32:32,900
<font color="#CCCCCC">kimmy yet because there's only</font><font color="#E5E5E5"> so many</font>

846
00:32:31,340 --> 00:32:33,980
hours in a day but it can't tell<font color="#E5E5E5"> you</font>

847
00:32:32,900 --> 00:32:36,260
when it's on<font color="#CCCCCC"> VMware and</font><font color="#E5E5E5"> waits on</font>

848
00:32:33,980 --> 00:32:39,740
VirtualBox and it does<font color="#CCCCCC"> that in the most</font>

849
00:32:36,260 --> 00:32:41,150
<font color="#E5E5E5">naive of where's even spots wine and</font>

850
00:32:39,740 --> 00:32:42,410
that's cool but<font color="#CCCCCC"> like I said that wasn't</font>

851
00:32:41,150 --> 00:32:44,150
<font color="#CCCCCC">the priority</font><font color="#E5E5E5"> this time around if you</font>

852
00:32:42,410 --> 00:32:45,650
want to write some ransomware write some

853
00:32:44,150 --> 00:32:47,600
better code than I did but it's a good

854
00:32:45,650 --> 00:32:49,970
proof of concept when I was interesting

855
00:32:47,600 --> 00:32:51,730
it interested in is writing a tool that

856
00:32:49,970 --> 00:32:54,710
can detect when it's in a scanner<font color="#E5E5E5"> and</font>

857
00:32:51,730 --> 00:32:56,090
which scanner it's in and it's<font color="#E5E5E5"> pretty</font>

858
00:32:54,710 --> 00:32:59,150
accurate and that's the scary thing

859
00:32:56,090 --> 00:33:01,189
because it's terrifyingly naive but

860
00:32:59,150 --> 00:33:03,920
it'll tell you if you're in a scanner

861
00:33:01,190 --> 00:33:06,800
which scanner you're in and then which

862
00:33:03,920 --> 00:33:08,300
node of that scan ER in so it's that

863
00:33:06,800 --> 00:33:10,430
accurate it can differentiate between

864
00:33:08,300 --> 00:33:14,000
the<font color="#E5E5E5"> nodes of the scanners and I name to</font>

865
00:33:10,430 --> 00:33:15,950
them because i needed to i needed a

866
00:33:14,000 --> 00:33:18,110
unique way of identifying them but it's

867
00:33:15,950 --> 00:33:20,540
<font color="#E5E5E5">not accurate that it can say this</font>

868
00:33:18,110 --> 00:33:22,669
executable is is being fired on virused

869
00:33:20,540 --> 00:33:24,230
<font color="#CCCCCC">hall and it does that by taking a look</font>

870
00:33:22,670 --> 00:33:26,570
<font color="#E5E5E5">at the system what's the name of the</font>

871
00:33:24,230 --> 00:33:30,140
current user what's the volume ID of the

872
00:33:26,570 --> 00:33:31,520
<font color="#E5E5E5">hard disk</font><font color="#CCCCCC"> its laptops about to run out</font>

873
00:33:30,140 --> 00:33:34,160
<font color="#E5E5E5">power so</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to talk a little bit</font>

874
00:33:31,520 --> 00:33:36,080
quickly it was the volume idea of the

875
00:33:34,160 --> 00:33:38,000
hardest what files exist what files are

876
00:33:36,080 --> 00:33:39,889
on the desktop really<font color="#E5E5E5"> really trivially</font>

877
00:33:38,000 --> 00:33:41,480
naive stuff and it can tell you that

878
00:33:39,890 --> 00:33:43,670
it's in a scanner on which scanning node

879
00:33:41,480 --> 00:33:45,620
it's on which means that<font color="#E5E5E5"> if I'm in a</font>

880
00:33:43,670 --> 00:33:47,540
scanner instead of doing malicious

881
00:33:45,620 --> 00:33:50,090
behavior I can control what the output

882
00:33:47,540 --> 00:33:52,129
<font color="#E5E5E5">of that scanning</font><font color="#CCCCCC"> engine it's and I can</font>

883
00:33:50,090 --> 00:33:54,500
lie to the sysadmin and I can lie to the

884
00:33:52,130 --> 00:33:56,120
sock so the sock<font color="#E5E5E5"> finds might secure but</font>

885
00:33:54,500 --> 00:33:59,030
it's like this looks like a botnet we'd

886
00:33:56,120 --> 00:34:01,659
best get it scanned and this is what

887
00:33:59,030 --> 00:34:01,660
<font color="#CCCCCC">they get and</font>

888
00:34:02,240 --> 00:34:06,770
yeah<font color="#E5E5E5"> I can literally make it say</font>

889
00:34:04,250 --> 00:34:07,790
<font color="#E5E5E5">anything I want to and so I'm going</font><font color="#CCCCCC"> to</font>

890
00:34:06,770 --> 00:34:10,790
be mean to them I'm going<font color="#E5E5E5"> to rip roll</font>

891
00:34:07,790 --> 00:34:13,580
them this is fear that's it telling me

892
00:34:10,790 --> 00:34:14,750
what you know them on so there's a shot

893
00:34:13,580 --> 00:34:18,860
number<font color="#E5E5E5"> of nodes and it's saying we're</font>

894
00:34:14,750 --> 00:34:20,449
running on fear today and it's on virus

895
00:34:18,860 --> 00:34:21,619
tall so I can accurately detect<font color="#CCCCCC"> one am</font>

896
00:34:20,449 --> 00:34:23,569
embarrassed I don't want to pick on<font color="#CCCCCC"> one</font>

897
00:34:21,619 --> 00:34:25,940
vendor though this is virustotal that's

898
00:34:23,570 --> 00:34:28,129
malware that's three expert works in the

899
00:34:25,940 --> 00:34:31,100
exact same where same naive level of

900
00:34:28,129 --> 00:34:32,569
detections so if anyone's to catch me

901
00:34:31,100 --> 00:34:34,069
later on and see the demo that's awesome

902
00:34:32,570 --> 00:34:35,600
if you don't<font color="#E5E5E5"> have time I'll release the</font>

903
00:34:34,070 --> 00:34:38,149
proof of concepts and stuff tonight you

904
00:34:35,600 --> 00:34:40,868
can catch those on the<font color="#CCCCCC"> internet my</font>

905
00:34:38,149 --> 00:34:44,029
output from this this conference talk is

906
00:34:40,869 --> 00:34:45,500
that's probably a bad thing the fact

907
00:34:44,030 --> 00:34:47,240
that i can get a zero output and the

908
00:34:45,500 --> 00:34:49,310
fact that i can control scanners is

909
00:34:47,239 --> 00:34:50,479
probably a bad thing<font color="#E5E5E5"> really sorry that I</font>

910
00:34:49,310 --> 00:34:55,340
lied to you though because it's totes

911
00:34:50,480 --> 00:34:59,680
not so that was my talk that is

912
00:34:55,340 --> 00:34:59,680
offensive anti analysis and naive look

