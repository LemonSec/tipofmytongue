1
00:00:02,310 --> 00:00:09,000
i'm here today to talk<font color="#CCCCCC"> about sa be but</font>

2
00:00:06,420 --> 00:00:11,160
<font color="#E5E5E5">from a fantastic perspective rather than</font>

3
00:00:09,000 --> 00:00:14,279
a full sort of trying to inform you all

4
00:00:11,160 --> 00:00:16,650
how the ins and outs of every aspect

5
00:00:14,279 --> 00:00:18,630
it's a massive system but what I'm not

6
00:00:16,650 --> 00:00:21,720
going to be doing<font color="#E5E5E5"> today is giving you</font>

7
00:00:18,630 --> 00:00:23,189
any<font color="#CCCCCC"> zero days old days any anything</font>

8
00:00:21,720 --> 00:00:25,439
<font color="#E5E5E5">that's really knew all this stuff has</font>

9
00:00:23,189 --> 00:00:27,029
been known for quite a while when<font color="#E5E5E5"> I</font>

10
00:00:25,439 --> 00:00:29,669
<font color="#E5E5E5">started looking at SOP these are the</font>

11
00:00:27,029 --> 00:00:31,859
guys that I found had done quite

12
00:00:29,669 --> 00:00:34,230
extensive research released lots of

13
00:00:31,859 --> 00:00:38,610
papers and presentations and I was

14
00:00:34,230 --> 00:00:40,800
looking<font color="#CCCCCC"> to build a toolset</font><font color="#E5E5E5"> but it was</font>

15
00:00:38,610 --> 00:00:41,850
kind of cumbersome so I decided to pick

16
00:00:40,800 --> 00:00:43,650
it up try<font color="#CCCCCC"> and condense all the</font>

17
00:00:41,850 --> 00:00:45,180
information that's<font color="#E5E5E5"> out there create a</font>

18
00:00:43,650 --> 00:00:47,129
testing methodology and it's all set to

19
00:00:45,180 --> 00:00:48,720
go along<font color="#CCCCCC"> with that but</font><font color="#E5E5E5"> really all my</font>

20
00:00:47,130 --> 00:00:51,630
work has been based off stuff that these

21
00:00:48,720 --> 00:00:54,150
guys have done when I put the original

22
00:00:51,630 --> 00:00:56,940
presentation together a<font color="#CCCCCC"> sort of</font><font color="#E5E5E5"> this</font>

23
00:00:54,150 --> 00:00:59,580
education workshop it was over about 140

24
00:00:56,940 --> 00:01:01,019
slides which is an hour it really isn't

25
00:00:59,580 --> 00:01:03,420
enough time to go into<font color="#CCCCCC"> that so I've</font>

26
00:01:01,020 --> 00:01:06,509
condensed it down today to give you<font color="#E5E5E5"> just</font>

27
00:01:03,420 --> 00:01:09,329
enough education to smash SI p quite

28
00:01:06,509 --> 00:01:11,100
easily and also created some<font color="#CCCCCC"> metasploit</font>

29
00:01:09,329 --> 00:01:17,178
modules that will allow you<font color="#E5E5E5"> to do</font><font color="#CCCCCC"> that</font>

30
00:01:11,100 --> 00:01:21,149
quite without much difficulty sap is

31
00:01:17,179 --> 00:01:23,130
absolutely massive product there's lots

32
00:01:21,149 --> 00:01:24,600
and lots of different concepts to get

33
00:01:23,130 --> 00:01:26,609
<font color="#E5E5E5">familiar with lots and lots of different</font>

34
00:01:24,600 --> 00:01:27,899
versions and product suites and there's

35
00:01:26,609 --> 00:01:28,649
simply sometimes go<font color="#CCCCCC"> into it so what</font><font color="#E5E5E5"> I'm</font>

36
00:01:27,899 --> 00:01:31,560
<font color="#E5E5E5">going to do is just give a brief</font>

37
00:01:28,649 --> 00:01:37,609
background<font color="#CCCCCC"> of</font><font color="#E5E5E5"> some SAP fundamentals and</font>

38
00:01:31,560 --> 00:01:39,929
a description<font color="#E5E5E5"> of an of you a typical</font>

39
00:01:37,609 --> 00:01:41,969
infrastructure how it would<font color="#CCCCCC"> be deployed</font>

40
00:01:39,929 --> 00:01:43,499
how it would<font color="#CCCCCC"> be architected some of the</font>

41
00:01:41,969 --> 00:01:45,509
core components<font color="#CCCCCC"> that make up a sap</font>

42
00:01:43,499 --> 00:01:46,920
environment such as the databases that

43
00:01:45,509 --> 00:01:50,549
they do support quite a few<font color="#CCCCCC"> different</font>

44
00:01:46,920 --> 00:01:52,139
back-end databases and some of which

45
00:01:50,549 --> 00:01:54,539
have different idiosyncrasies<font color="#E5E5E5"> that you</font>

46
00:01:52,139 --> 00:01:56,249
need to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> aware of</font><font color="#E5E5E5"> SAP connectivity how</font>

47
00:01:54,539 --> 00:01:57,329
we<font color="#E5E5E5"> talk two subsystems how users talk to</font>

48
00:01:56,249 --> 00:01:59,699
them how you're going to talk to<font color="#E5E5E5"> them</font>

49
00:01:57,329 --> 00:02:01,079
and some elements have<font color="#CCCCCC"> SAT that</font>

50
00:01:59,700 --> 00:02:03,179
important to understand such as

51
00:02:01,079 --> 00:02:04,829
transactions reports and programs which

52
00:02:03,179 --> 00:02:06,600
is really<font color="#E5E5E5"> the core of how SAP operates</font>

53
00:02:04,829 --> 00:02:09,538
and how people interoperate with it and

54
00:02:06,600 --> 00:02:14,549
then right there Bri<font color="#E5E5E5"> for some web</font>

55
00:02:09,538 --> 00:02:15,690
components so the background sap is one

56
00:02:14,549 --> 00:02:17,470
of the

57
00:02:15,690 --> 00:02:20,530
apparently one of<font color="#E5E5E5"> the world's largest</font>

58
00:02:17,470 --> 00:02:23,020
software providers you'd be amazed at

59
00:02:20,530 --> 00:02:26,140
<font color="#E5E5E5">how many industries actually purchase</font>

60
00:02:23,020 --> 00:02:28,270
and consume<font color="#E5E5E5"> sap services or have</font><font color="#CCCCCC"> SAP</font>

61
00:02:26,140 --> 00:02:29,619
infrastructure software it really forms

62
00:02:28,270 --> 00:02:32,220
the core<font color="#CCCCCC"> of many organizations</font>

63
00:02:29,620 --> 00:02:35,140
businesses whether it be financial

64
00:02:32,220 --> 00:02:37,750
product management customer relationship

65
00:02:35,140 --> 00:02:40,029
management it's really ingrained within

66
00:02:37,750 --> 00:02:41,530
a lot of organizations and people spend

67
00:02:40,030 --> 00:02:43,750
hundreds and hundreds of thousands in

68
00:02:41,530 --> 00:02:45,160
some cases millions of pounds getting

69
00:02:43,750 --> 00:02:47,530
this stuff into<font color="#E5E5E5"> their environments</font>

70
00:02:45,160 --> 00:02:50,260
apparently because it's all most

71
00:02:47,530 --> 00:02:52,269
successful businesses<font color="#CCCCCC"> one set the main</font>

72
00:02:50,260 --> 00:02:54,220
product they have is called ERP the

73
00:02:52,269 --> 00:02:58,230
<font color="#E5E5E5">entity enterprise resource planning etc</font>

74
00:02:54,220 --> 00:03:00,580
but there are other<font color="#E5E5E5"> products</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> CRM</font>

75
00:02:58,230 --> 00:03:01,750
SRM supplier relationship chain

76
00:03:00,580 --> 00:03:03,340
management accession but at the core

77
00:03:01,750 --> 00:03:04,989
they're all pretty much the same system

78
00:03:03,340 --> 00:03:06,610
it's just how that business might

79
00:03:04,989 --> 00:03:09,069
interact with them so from a pen testers

80
00:03:06,610 --> 00:03:10,660
perspective you don't need<font color="#CCCCCC"> to relearn</font>

81
00:03:09,069 --> 00:03:11,890
anything to jump from<font color="#E5E5E5"> one product suite</font>

82
00:03:10,660 --> 00:03:13,180
to another there might be some

83
00:03:11,890 --> 00:03:15,518
differences when you get deeper<font color="#CCCCCC"> into it</font>

84
00:03:13,180 --> 00:03:17,640
but at<font color="#E5E5E5"> the core most of the stuff</font><font color="#CCCCCC"> i'll</font>

85
00:03:15,519 --> 00:03:19,570
show you<font color="#E5E5E5"> so it will work lining of those</font>

86
00:03:17,640 --> 00:03:21,250
one thing you need<font color="#CCCCCC"> to get familiar with</font>

87
00:03:19,570 --> 00:03:23,769
is the sack<font color="#CCCCCC"> geary this is how most</font>

88
00:03:21,250 --> 00:03:25,840
people connect into the<font color="#CCCCCC"> SAP system and</font>

89
00:03:23,769 --> 00:03:28,840
it comes as a<font color="#E5E5E5"> Windows binary or a java</font>

90
00:03:25,840 --> 00:03:30,700
executable and if<font color="#E5E5E5"> you're familiar with</font>

91
00:03:28,840 --> 00:03:33,190
<font color="#E5E5E5">any type of application the concept</font>

92
00:03:30,700 --> 00:03:34,298
there is quite quite straightforward but

93
00:03:33,190 --> 00:03:36,130
right up in the top<font color="#CCCCCC"> left-hand corner</font>

94
00:03:34,299 --> 00:03:37,480
there's a little<font color="#E5E5E5"> input field there and</font>

95
00:03:36,130 --> 00:03:40,569
what that's for is entering a

96
00:03:37,480 --> 00:03:42,399
transaction codes so any<font color="#E5E5E5"> of these menu</font>

97
00:03:40,569 --> 00:03:45,040
options that you you click on depending

98
00:03:42,400 --> 00:03:46,750
<font color="#CCCCCC">on your access rights you could each</font>

99
00:03:45,040 --> 00:03:48,100
<font color="#E5E5E5">behind-the-scenes actually runs a</font>

100
00:03:46,750 --> 00:03:49,630
transaction code that corresponds with

101
00:03:48,100 --> 00:03:53,769
that and you could just<font color="#E5E5E5"> enter that in</font>

102
00:03:49,630 --> 00:03:56,530
the top<font color="#CCCCCC"> left-hand corner you don't even</font>

103
00:03:53,769 --> 00:03:58,870
need a thick client some<font color="#E5E5E5"> systems exposed</font>

104
00:03:56,530 --> 00:04:01,510
the entire thing via web browser and

105
00:03:58,870 --> 00:04:03,880
through the<font color="#CCCCCC"> i TS server and all that</font>

106
00:04:01,510 --> 00:04:09,399
does this translate the screens<font color="#CCCCCC"> into</font>

107
00:04:03,880 --> 00:04:12,130
HTML forms for you this bad boy<font color="#CCCCCC"> is the</font>

108
00:04:09,400 --> 00:04:14,380
super rich client still has<font color="#CCCCCC"> SAT behind</font>

109
00:04:12,130 --> 00:04:16,209
it power users use this thing<font color="#E5E5E5"> and it's</font>

110
00:04:14,380 --> 00:04:18,279
kind of like a thick client portal if

111
00:04:16,209 --> 00:04:20,950
you will you can run lots<font color="#E5E5E5"> of different</font>

112
00:04:18,279 --> 00:04:26,169
excuse book code within their HTML<font color="#E5E5E5"> adobe</font>

113
00:04:20,950 --> 00:04:28,840
sap GUI scripted objects and finally

114
00:04:26,169 --> 00:04:30,340
there's a there's an sdk

115
00:04:28,840 --> 00:04:31,659
available<font color="#E5E5E5"> from</font><font color="#CCCCCC"> SAP so you can</font>

116
00:04:30,340 --> 00:04:36,010
programmatically interact with<font color="#E5E5E5"> SAP</font>

117
00:04:31,660 --> 00:04:38,590
systems / RFC which like a saps

118
00:04:36,010 --> 00:04:41,830
implementation of a kind of omi concept

119
00:04:38,590 --> 00:04:45,369
or a dotnet remote remote remoting

120
00:04:41,830 --> 00:04:47,919
concept this<font color="#CCCCCC"> SDK is only available to</font>

121
00:04:45,370 --> 00:04:52,000
pay customers this is the problem with

122
00:04:47,919 --> 00:04:53,169
<font color="#CCCCCC">SAP there's a massive pay wall in front</font>

123
00:04:52,000 --> 00:04:54,760
of<font color="#E5E5E5"> everything that they do to avoid</font>

124
00:04:53,169 --> 00:04:56,049
anyone to prevent anyone actually

125
00:04:54,760 --> 00:04:57,610
getting to look at this stuff<font color="#CCCCCC"> i play</font>

126
00:04:56,050 --> 00:05:00,510
with<font color="#CCCCCC"> the stuff unless you're fully</font>

127
00:04:57,610 --> 00:05:02,919
paid-up SAP customer or you're a

128
00:05:00,510 --> 00:05:04,330
qualified sap consultant that's paid

129
00:05:02,919 --> 00:05:06,609
their dues and works for a<font color="#E5E5E5"> particular</font>

130
00:05:04,330 --> 00:05:07,990
set company etc so it's<font color="#E5E5E5"> really hard for</font>

131
00:05:06,610 --> 00:05:10,150
researchers and<font color="#E5E5E5"> pen testers to get</font>

132
00:05:07,990 --> 00:05:12,130
<font color="#CCCCCC">access to this stuff and however they do</font>

133
00:05:10,150 --> 00:05:13,900
make available some test systems you can

134
00:05:12,130 --> 00:05:15,310
<font color="#E5E5E5">download and those test systems</font>

135
00:05:13,900 --> 00:05:16,960
<font color="#CCCCCC">sometimes have some of these</font><font color="#E5E5E5"> components</font>

136
00:05:15,310 --> 00:05:20,229
within their specifically some of the

137
00:05:16,960 --> 00:05:21,940
libraries that come with the SDK so you

138
00:05:20,229 --> 00:05:24,729
can get can get all of<font color="#CCCCCC"> it that way</font><font color="#E5E5E5"> and</font>

139
00:05:21,940 --> 00:05:26,590
otherwise<font color="#E5E5E5"> you need to ask around because</font>

140
00:05:24,729 --> 00:05:28,240
the commercial restrictions on it mean

141
00:05:26,590 --> 00:05:31,049
it can't be distributed and I can't

142
00:05:28,240 --> 00:05:33,729
distribute it so please don't<font color="#E5E5E5"> ask and</font>

143
00:05:31,050 --> 00:05:35,820
there are third-party wrappers available

144
00:05:33,729 --> 00:05:37,750
to the SDK and they're really<font color="#E5E5E5"> cool i</font>

145
00:05:35,820 --> 00:05:39,810
play with quite a<font color="#CCCCCC"> few of</font><font color="#E5E5E5"> them</font><font color="#CCCCCC"> but I've</font>

146
00:05:37,750 --> 00:05:42,639
settled on using<font color="#CCCCCC"> martin sorrell's</font>

147
00:05:39,810 --> 00:05:43,780
wrapper and he's a cool guy as well<font color="#E5E5E5"> so</font>

148
00:05:42,639 --> 00:05:45,970
when you do play with any of this stuff

149
00:05:43,780 --> 00:05:49,260
he's<font color="#E5E5E5"> quite approachable and definitely</font>

150
00:05:45,970 --> 00:05:49,260
likes you finding<font color="#E5E5E5"> folks and his stuff</font>

151
00:05:49,560 --> 00:05:53,530
when you pen test in the SAP system

152
00:05:51,970 --> 00:05:56,530
you're really<font color="#E5E5E5"> going to have three goals</font>

153
00:05:53,530 --> 00:05:59,919
or one goal any one of these will let

154
00:05:56,530 --> 00:06:01,479
you achieve your angle there's an

155
00:05:59,919 --> 00:06:02,740
administrative account on every

156
00:06:01,479 --> 00:06:05,020
operating system that's a SAP

157
00:06:02,740 --> 00:06:07,330
administrative account and it'll have<font color="#E5E5E5"> a</font>

158
00:06:05,020 --> 00:06:09,669
three-letter identifier that corresponds

159
00:06:07,330 --> 00:06:12,219
to the<font color="#E5E5E5"> system</font><font color="#CCCCCC"> that you're looking at and</font>

160
00:06:09,669 --> 00:06:14,139
then<font color="#E5E5E5"> a DM so if you can gain access as</font>

161
00:06:12,220 --> 00:06:16,630
that user or privileges equal to that

162
00:06:14,139 --> 00:06:18,490
user you can own the SAP system if you

163
00:06:16,630 --> 00:06:20,770
can get DDA access to the database<font color="#E5E5E5"> that</font>

164
00:06:18,490 --> 00:06:23,470
supports the safe environment then it's

165
00:06:20,770 --> 00:06:26,080
game over and if there's a hierarchical

166
00:06:23,470 --> 00:06:28,840
role within SAP itself and step all

167
00:06:26,080 --> 00:06:31,090
being highest so it's like God etc get

168
00:06:28,840 --> 00:06:32,710
that and you win as<font color="#CCCCCC"> well but each one of</font>

169
00:06:31,090 --> 00:06:35,849
those if you get any one of them it's

170
00:06:32,710 --> 00:06:35,849
just trivial to get the others

171
00:06:38,590 --> 00:06:44,419
so that uses an n-tier stretcher<font color="#E5E5E5"> and as</font>

172
00:06:43,190 --> 00:06:46,010
I<font color="#CCCCCC"> seen before the different software</font>

173
00:06:44,420 --> 00:06:47,510
<font color="#CCCCCC">Suites and different modules and each</font>

174
00:06:46,010 --> 00:06:49,789
subsystem will consist usually just

175
00:06:47,510 --> 00:06:51,110
wanna one of those modules sometimes in

176
00:06:49,790 --> 00:06:53,990
dedicated service sometimes on a

177
00:06:51,110 --> 00:06:56,570
virtualized server and sap GUI web

178
00:06:53,990 --> 00:06:59,270
client for<font color="#E5E5E5"> a connectivity you might get</font>

179
00:06:56,570 --> 00:07:03,409
many instances on one system or one

180
00:06:59,270 --> 00:07:07,190
virtualized system it's<font color="#E5E5E5"> really up to how</font>

181
00:07:03,410 --> 00:07:11,570
it's been dished out this is a<font color="#E5E5E5"> very</font>

182
00:07:07,190 --> 00:07:15,469
simplified representation of a sap

183
00:07:11,570 --> 00:07:18,770
deployment this is usually the example

184
00:07:15,470 --> 00:07:19,940
Sapa will give but in reality it's going

185
00:07:18,770 --> 00:07:22,760
to be<font color="#E5E5E5"> much more complicated than this</font>

186
00:07:19,940 --> 00:07:25,010
but what you will find is that there's

187
00:07:22,760 --> 00:07:27,650
always a way from<font color="#CCCCCC"> the internet</font><font color="#E5E5E5"> into the</font>

188
00:07:25,010 --> 00:07:29,300
<font color="#E5E5E5">sap system because mandate</font><font color="#CCCCCC"> that they</font>

189
00:07:27,650 --> 00:07:32,030
need<font color="#CCCCCC"> to be able</font><font color="#E5E5E5"> to log into it in order</font>

190
00:07:29,300 --> 00:07:33,680
<font color="#CCCCCC">to do support or</font><font color="#E5E5E5"> mischief stuff</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> mean</font>

191
00:07:32,030 --> 00:07:34,909
it's not always open some people shut it

192
00:07:33,680 --> 00:07:36,860
down but there will always be<font color="#E5E5E5"> a routine</font>

193
00:07:34,910 --> 00:07:38,930
<font color="#E5E5E5">from the internet and then you've got</font>

194
00:07:36,860 --> 00:07:40,310
<font color="#CCCCCC">your land user here using these</font>

195
00:07:38,930 --> 00:07:42,229
surgeries come through the file into the

196
00:07:40,310 --> 00:07:43,400
DMZ environment and what both

197
00:07:42,229 --> 00:07:45,469
connections are coming<font color="#E5E5E5"> through here is</font>

198
00:07:43,400 --> 00:07:48,469
there something on<font color="#E5E5E5"> a web dispatcher or</font>

199
00:07:45,470 --> 00:07:50,840
separator the separate<font color="#E5E5E5"> is like a network</font>

200
00:07:48,470 --> 00:07:52,370
reverse proxy that can apply ACLs and

201
00:07:50,840 --> 00:07:54,830
the web dispatch is kind of the same

202
00:07:52,370 --> 00:07:58,490
thing<font color="#CCCCCC"> but for</font><font color="#E5E5E5"> web traffic for web</font>

203
00:07:54,830 --> 00:08:01,820
exposed and ICF they're sort of like JSP

204
00:07:58,490 --> 00:08:04,760
PHP stuff 4 sir four for the web-enabled

205
00:08:01,820 --> 00:08:06,260
set Gary you got your application server

206
00:08:04,760 --> 00:08:08,930
which<font color="#E5E5E5"> you know may well be a gateway</font>

207
00:08:06,260 --> 00:08:10,340
<font color="#E5E5E5">just another extra modular server and</font>

208
00:08:08,930 --> 00:08:13,250
then<font color="#E5E5E5"> a database server that supports it</font>

209
00:08:10,340 --> 00:08:16,039
at the back end<font color="#CCCCCC"> then you've got this</font>

210
00:08:13,250 --> 00:08:17,840
thing called<font color="#E5E5E5"> set landscapes where most</font>

211
00:08:16,040 --> 00:08:18,950
of you test different environmentally

212
00:08:17,840 --> 00:08:22,340
aware that you've got production<font color="#E5E5E5"> you've</font>

213
00:08:18,950 --> 00:08:23,900
got<font color="#CCCCCC"> debut your QA etc but in SAP this is</font>

214
00:08:22,340 --> 00:08:27,140
specifically designed for change control

215
00:08:23,900 --> 00:08:29,239
management not<font color="#E5E5E5"> redundancy and what they</font>

216
00:08:27,140 --> 00:08:35,299
have between each of the environments is

217
00:08:29,240 --> 00:08:38,479
a change transport system this is

218
00:08:35,299 --> 00:08:42,309
facilitated so that you can develop<font color="#E5E5E5"> all</font>

219
00:08:38,479 --> 00:08:42,310
your code<font color="#CCCCCC"> and then push it through this</font>

220
00:08:42,429 --> 00:08:48,170
this is transport through into a queue a

221
00:08:46,280 --> 00:08:50,240
system where it gets benchmark test it

222
00:08:48,170 --> 00:08:51,380
signed off and threw into production in

223
00:08:50,240 --> 00:08:52,970
<font color="#E5E5E5">the production environment</font>

224
00:08:51,380 --> 00:08:55,939
should strictly not allow any changes

225
00:08:52,970 --> 00:08:58,220
whatsoever but what this system gives

226
00:08:55,940 --> 00:09:00,440
you is a path through each environment

227
00:08:58,220 --> 00:09:01,280
so even if<font color="#E5E5E5"> these were firewalled off you</font>

228
00:09:00,440 --> 00:09:04,600
still<font color="#E5E5E5"> always going to have a</font>

229
00:09:01,280 --> 00:09:04,600
communication<font color="#E5E5E5"> channel between them</font>

230
00:09:07,060 --> 00:09:10,280
normally it's just changing the

231
00:09:08,750 --> 00:09:12,710
figuration options to get<font color="#CCCCCC"> pushed through</font>

232
00:09:10,280 --> 00:09:14,720
<font color="#E5E5E5">but with CT s</font><font color="#CCCCCC"> plus executable coconuts</font>

233
00:09:12,710 --> 00:09:17,660
will be pushed through so add that code

234
00:09:14,720 --> 00:09:21,230
<font color="#CCCCCC">and java objects so if you</font><font color="#E5E5E5"> could get</font>

235
00:09:17,660 --> 00:09:23,660
<font color="#CCCCCC">access to these shares where this is all</font>

236
00:09:21,230 --> 00:09:26,300
stored there either<font color="#CCCCCC"> samba shares or NFS</font>

237
00:09:23,660 --> 00:09:27,829
shares and you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> get right access to</font>

238
00:09:26,300 --> 00:09:29,420
that stuff you can<font color="#E5E5E5"> manipulate it put in</font>

239
00:09:27,830 --> 00:09:31,340
your own code and do lots of nefarious

240
00:09:29,420 --> 00:09:34,719
things and those would get passed

241
00:09:31,340 --> 00:09:34,720
through to the different environments

242
00:09:35,320 --> 00:09:40,220
any network tester that's come across

243
00:09:38,090 --> 00:09:42,200
when<font color="#CCCCCC"> i</font><font color="#E5E5E5"> first previous will know that</font>

244
00:09:40,220 --> 00:09:44,420
it's a trivial<font color="#E5E5E5"> thing to get a root shell</font>

245
00:09:42,200 --> 00:09:46,220
on NFS server and it's not different in

246
00:09:44,420 --> 00:09:48,260
set land the shares<font color="#CCCCCC"> are</font><font color="#E5E5E5"> all set up to be</font>

247
00:09:46,220 --> 00:09:50,180
shared by available to everyone and

248
00:09:48,260 --> 00:09:52,100
accessible I everyone and<font color="#E5E5E5"> they're often</font>

249
00:09:50,180 --> 00:09:57,410
mounted with without<font color="#E5E5E5"> the</font><font color="#CCCCCC"> know sue</font>

250
00:09:52,100 --> 00:09:59,600
adoption the supporting database is the

251
00:09:57,410 --> 00:10:02,680
database of the support by SI p are

252
00:09:59,600 --> 00:10:05,210
listed here the<font color="#E5E5E5"> the listed in order of</font>

253
00:10:02,680 --> 00:10:07,880
frequency that<font color="#CCCCCC"> i see them not based on</font>

254
00:10:05,210 --> 00:10:10,250
any<font color="#E5E5E5"> sort of statistics often i</font><font color="#CCCCCC"> compose</font>

255
00:10:07,880 --> 00:10:12,980
oracle and microsoft sequel and max DB

256
00:10:10,250 --> 00:10:15,830
is saps implementation of the sort<font color="#E5E5E5"> of a</font>

257
00:10:12,980 --> 00:10:18,080
bastardized my sequel and then db2

258
00:10:15,830 --> 00:10:22,190
sybase nympho mix<font color="#CCCCCC"> I really haven't come</font>

259
00:10:18,080 --> 00:10:23,540
across not say<font color="#E5E5E5"> that not in use I'm not</font>

260
00:10:22,190 --> 00:10:25,880
going to bother going through how to

261
00:10:23,540 --> 00:10:28,180
hack databases most people already know

262
00:10:25,880 --> 00:10:33,189
how to do this<font color="#E5E5E5"> and but there are some</font>

263
00:10:28,180 --> 00:10:36,160
SAP specifics such as a set mandate that

264
00:10:33,190 --> 00:10:39,170
remote<font color="#E5E5E5"> OSF event should be set to true</font>

265
00:10:36,160 --> 00:10:40,670
which allows the debt which means the

266
00:10:39,170 --> 00:10:43,160
database trust that they are the

267
00:10:40,670 --> 00:10:46,449
operating system has authenticated the

268
00:10:43,160 --> 00:10:46,449
user<font color="#E5E5E5"> it's requesting a connection</font>

269
00:10:47,890 --> 00:10:52,730
without having to spiny any password

270
00:10:51,050 --> 00:10:54,400
credentials so it's just a<font color="#CCCCCC"> matter of</font>

271
00:10:52,730 --> 00:10:56,570
creating the user on your box

272
00:10:54,400 --> 00:10:57,800
corresponding are a file and then<font color="#E5E5E5"> using</font>

273
00:10:56,570 --> 00:11:00,310
<font color="#CCCCCC">to equal plus if</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> communicate</font>

274
00:10:57,800 --> 00:11:03,469
directly with<font color="#E5E5E5"> the DV to gain access and</font>

275
00:11:00,310 --> 00:11:05,089
<font color="#CCCCCC">except to give some guidance around how</font>

276
00:11:03,470 --> 00:11:07,249
to reconfigure things and

277
00:11:05,089 --> 00:11:08,809
down and but that's not again only

278
00:11:07,249 --> 00:11:13,309
<font color="#E5E5E5">available to pay up customers to gonna</font>

279
00:11:08,809 --> 00:11:16,550
have a look the set max DV has a similar

280
00:11:13,309 --> 00:11:18,050
concept and it's called<font color="#CCCCCC"> x user and what</font>

281
00:11:16,550 --> 00:11:20,540
<font color="#E5E5E5">this</font><font color="#CCCCCC"> means is if the operating system</font>

282
00:11:18,050 --> 00:11:23,589
user has a file called<font color="#CCCCCC"> X user 62 in</font>

283
00:11:20,540 --> 00:11:25,969
their home directory this file contains

284
00:11:23,589 --> 00:11:27,800
different connection settings and

285
00:11:25,970 --> 00:11:29,980
details about various users it can

286
00:11:27,800 --> 00:11:32,839
access the database and<font color="#CCCCCC"> then sort</font><font color="#E5E5E5"> of</font>

287
00:11:29,980 --> 00:11:34,100
index with a key if<font color="#E5E5E5"> you know the key for</font>

288
00:11:32,839 --> 00:11:35,689
<font color="#E5E5E5">a user that's in that file and you</font><font color="#CCCCCC"> can</font>

289
00:11:34,100 --> 00:11:38,839
read<font color="#E5E5E5"> that file you</font><font color="#CCCCCC"> can log directly into</font>

290
00:11:35,689 --> 00:11:40,009
the database and the Kinect string at

291
00:11:38,839 --> 00:11:42,110
the bottom there you see I've

292
00:11:40,009 --> 00:11:43,610
highlighted the letter C which<font color="#CCCCCC"> is the</font>

293
00:11:42,110 --> 00:11:45,589
key so instead of<font color="#E5E5E5"> a username and</font>

294
00:11:43,610 --> 00:11:47,749
password we just pass in the letter C

295
00:11:45,589 --> 00:11:51,040
because we can read that<font color="#E5E5E5"> file</font><font color="#CCCCCC"> gain</font>

296
00:11:47,749 --> 00:11:51,040
straight access into the database

297
00:11:51,550 --> 00:11:55,878
connectivity talking to SAP what got

298
00:11:53,959 --> 00:11:57,469
your<font color="#E5E5E5"> work components you have available</font>

299
00:11:55,879 --> 00:11:59,509
is there the Satguru that we saw at the

300
00:11:57,470 --> 00:12:01,339
beginning that runs on<font color="#CCCCCC"> Windows and on</font>

301
00:11:59,509 --> 00:12:03,410
any<font color="#E5E5E5"> system that</font><font color="#CCCCCC"> will</font><font color="#E5E5E5"> wear support java</font>

302
00:12:01,339 --> 00:12:07,249
<font color="#E5E5E5">the web browser and then these remote</font>

303
00:12:03,410 --> 00:12:09,769
function calls everything in syrup is

304
00:12:07,249 --> 00:12:11,749
based is built around it and coding<font color="#CCCCCC"> this</font>

305
00:12:09,769 --> 00:12:13,429
core language called a bat which is kind

306
00:12:11,749 --> 00:12:15,740
<font color="#E5E5E5">of like COBOL</font><font color="#CCCCCC"> and sequel smash together</font>

307
00:12:13,429 --> 00:12:18,559
it's very logical procedural it's really

308
00:12:15,740 --> 00:12:20,300
easy to understand but you can take

309
00:12:18,559 --> 00:12:22,969
blocks<font color="#CCCCCC"> of how that and then make them</font>

310
00:12:20,300 --> 00:12:24,949
remotely callable and that's<font color="#E5E5E5"> what rfcs</font>

311
00:12:22,970 --> 00:12:27,439
are just remote function calls you call

312
00:12:24,949 --> 00:12:28,969
this<font color="#E5E5E5"> coppock and it'll there either</font>

313
00:12:27,439 --> 00:12:31,248
return data for you or just go off and

314
00:12:28,970 --> 00:12:32,929
process something there's a bunch of

315
00:12:31,249 --> 00:12:35,809
other<font color="#CCCCCC"> applications that you may come</font>

316
00:12:32,929 --> 00:12:37,100
across a visual admin mobile client it

317
00:12:35,809 --> 00:12:39,110
depends<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the environment that you're</font>

318
00:12:37,100 --> 00:12:40,309
looking<font color="#E5E5E5"> at but predominantly they use</font>

319
00:12:39,110 --> 00:12:44,720
all the same sort<font color="#E5E5E5"> of communication</font>

320
00:12:40,309 --> 00:12:47,480
channels most of them underneath use

321
00:12:44,720 --> 00:12:51,379
this protocol called diag which is a SAT

322
00:12:47,480 --> 00:12:54,110
proprietary protocol that's just

323
00:12:51,379 --> 00:12:55,939
compressed it's not encrypted by default

324
00:12:54,110 --> 00:13:01,759
you can encrypt it but no<font color="#CCCCCC"> one really</font>

325
00:12:55,939 --> 00:13:04,040
<font color="#E5E5E5">does and i'm looking</font><font color="#CCCCCC"> for a or do last</font>

326
00:13:01,759 --> 00:13:06,290
year at the nephron was at 44 con and

327
00:13:04,040 --> 00:13:09,199
<font color="#CCCCCC">saw Ian's talk on his</font><font color="#E5E5E5"> man-in-the-middle</font>

328
00:13:06,290 --> 00:13:10,429
proxy for the diet protocol where he was

329
00:13:09,199 --> 00:13:13,250
kind of like burp where you could just

330
00:13:10,429 --> 00:13:16,519
capture decompress and then replay and

331
00:13:13,250 --> 00:13:17,420
manipulate so who's playing people out

332
00:13:16,519 --> 00:13:18,089
there already playing with<font color="#E5E5E5"> this stuff</font>

333
00:13:17,420 --> 00:13:20,490
and<font color="#CCCCCC"> writing</font><font color="#E5E5E5"> mining</font>

334
00:13:18,089 --> 00:13:22,319
<font color="#CCCCCC">middle tools the web GUI is just don't</font>

335
00:13:20,490 --> 00:13:24,509
HTTP by default none of its encrypted by

336
00:13:22,319 --> 00:13:27,540
default there<font color="#E5E5E5"> are sequels that</font><font color="#CCCCCC"> you're</font>

337
00:13:24,509 --> 00:13:28,949
<font color="#E5E5E5">doing again they using the dial Crocker</font>

338
00:13:27,540 --> 00:13:31,319
but the credentials that are passed over

339
00:13:28,949 --> 00:13:32,849
a wreck sword and<font color="#E5E5E5"> but actual with a</font>

340
00:13:31,319 --> 00:13:35,009
static key that's been known for years

341
00:13:32,850 --> 00:13:36,269
and never changed so it's again trivial

342
00:13:35,009 --> 00:13:40,769
to gain access to the credentials if you

343
00:13:36,269 --> 00:13:41,930
can capture those<font color="#CCCCCC"> cons the set Ruta that</font>

344
00:13:40,769 --> 00:13:44,699
<font color="#CCCCCC">I showed you the beginning the</font>

345
00:13:41,930 --> 00:13:50,370
simplified network diagram which is a

346
00:13:44,699 --> 00:13:51,479
reverse proxy this can be placed be hey

347
00:13:50,370 --> 00:13:53,220
this is normally place behind a

348
00:13:51,480 --> 00:13:55,860
corporate<font color="#CCCCCC"> perimeter file an internal</font>

349
00:13:53,220 --> 00:13:58,110
firewall now the<font color="#E5E5E5"> SAP guy might go to the</font>

350
00:13:55,860 --> 00:13:59,759
firewall guy and say can I punch a hole

351
00:13:58,110 --> 00:14:01,410
<font color="#E5E5E5">in your firewall I only want one port</font>

352
00:13:59,759 --> 00:14:03,600
please give me that one port and<font color="#E5E5E5"> there</font>

353
00:14:01,410 --> 00:14:05,219
the final admin guys more than<font color="#E5E5E5"> likely to</font>

354
00:14:03,600 --> 00:14:07,920
score this one port what could possibly

355
00:14:05,220 --> 00:14:10,319
go wrong giving that and then he set so

356
00:14:07,920 --> 00:14:11,969
<font color="#E5E5E5">peace a true sir on this one port but</font>

357
00:14:10,319 --> 00:14:14,759
that can be used<font color="#E5E5E5"> to proxy anything</font>

358
00:14:11,970 --> 00:14:16,829
through and quite often when i look at

359
00:14:14,759 --> 00:14:18,600
the<font color="#E5E5E5"> SAP route or acl's its star star</font>

360
00:14:16,829 --> 00:14:20,729
star which means<font color="#CCCCCC"> you're proxying through</font>

361
00:14:18,600 --> 00:14:24,709
an opening up your<font color="#E5E5E5"> entire DMZ to attack</font>

362
00:14:20,730 --> 00:14:24,709
<font color="#CCCCCC">from the internet or the local network</font>

363
00:14:24,740 --> 00:14:30,689
it's got a very simple an ACL source

364
00:14:28,230 --> 00:14:31,709
destination and but it can enforce the

365
00:14:30,689 --> 00:14:33,990
encryption that<font color="#CCCCCC"> I was talking about as</font>

366
00:14:31,709 --> 00:14:35,429
<font color="#E5E5E5">well and it can also put a password so</font>

367
00:14:33,990 --> 00:14:39,720
you<font color="#E5E5E5"> might find a connection requires an</font>

368
00:14:35,429 --> 00:14:42,569
additional password to set up and the

369
00:14:39,720 --> 00:14:45,779
ACL is that's if we've got permit source

370
00:14:42,569 --> 00:14:48,540
destination subnet your wild cards host

371
00:14:45,779 --> 00:14:50,490
to host star service and the difference

372
00:14:48,540 --> 00:14:51,870
<font color="#CCCCCC">between the second and the third line is</font>

373
00:14:50,490 --> 00:14:55,319
that<font color="#E5E5E5"> you can see the P therefore</font><font color="#CCCCCC"> pamir</font>

374
00:14:51,870 --> 00:14:57,149
and that's any port you like the S is

375
00:14:55,319 --> 00:14:58,800
only SAP services so you<font color="#E5E5E5"> wouldn't have</font>

376
00:14:57,149 --> 00:15:05,429
<font color="#CCCCCC">liked SSH or something like that but</font>

377
00:14:58,800 --> 00:15:07,889
it's still supports<font color="#CCCCCC"> wildcard so a set</font>

378
00:15:05,429 --> 00:15:10,170
route itself if it's<font color="#CCCCCC"> an you can get</font>

379
00:15:07,889 --> 00:15:12,839
there that it's only<font color="#E5E5E5"> binaries runs on</font>

380
00:15:10,170 --> 00:15:14,370
linux runs on<font color="#CCCCCC"> windows i think rightly</font>

381
00:15:12,839 --> 00:15:17,699
comes in the<font color="#E5E5E5"> sdk but you can pull it off</font>

382
00:15:14,370 --> 00:15:19,829
boxes as well and you<font color="#CCCCCC"> can use it to call</font>

383
00:15:17,699 --> 00:15:22,139
to other sap Reuters<font color="#CCCCCC"> and ask it for</font>

384
00:15:19,829 --> 00:15:24,899
information basically a state table that

385
00:15:22,139 --> 00:15:26,009
it will return and tell you the current

386
00:15:24,899 --> 00:15:27,629
clients that are connected<font color="#CCCCCC"> and we're</font>

387
00:15:26,009 --> 00:15:29,279
connected<font color="#CCCCCC"> to so if it supports it and</font>

388
00:15:27,629 --> 00:15:30,929
you've got the binary you call it it'll

389
00:15:29,279 --> 00:15:31,410
return a lot of useful<font color="#E5E5E5"> information that</font>

390
00:15:30,929 --> 00:15:32,850
allows you<font color="#E5E5E5"> to</font>

391
00:15:31,410 --> 00:15:35,129
Matt the network will figure out who's

392
00:15:32,850 --> 00:15:39,209
connecting<font color="#E5E5E5"> where identify more boxes to</font>

393
00:15:35,129 --> 00:15:40,440
attack again<font color="#E5E5E5"> if it's been config with P</font>

394
00:15:39,209 --> 00:15:43,290
instead of s and things like that and

395
00:15:40,440 --> 00:15:44,850
<font color="#E5E5E5">wild card then you can use it to proxy</font>

396
00:15:43,290 --> 00:15:47,250
your comms through into all those

397
00:15:44,850 --> 00:15:49,110
networks port scan boxes and use tool

398
00:15:47,250 --> 00:15:50,910
sets like proxy chain or<font color="#CCCCCC"> T socks and</font>

399
00:15:49,110 --> 00:15:56,970
stuff and just start using your normal

400
00:15:50,910 --> 00:15:59,730
pen test tool kit when I<font color="#E5E5E5"> started playing</font>

401
00:15:56,970 --> 00:16:02,129
<font color="#E5E5E5">with this stuff I was mainly using this</font>

402
00:15:59,730 --> 00:16:04,019
<font color="#E5E5E5">Python framework attack framework</font>

403
00:16:02,129 --> 00:16:05,850
available from an abscess by<font color="#E5E5E5"> a guy</font>

404
00:16:04,019 --> 00:16:07,740
called<font color="#E5E5E5"> Mariano it's got a lot of</font>

405
00:16:05,850 --> 00:16:11,910
<font color="#CCCCCC">different plugins that sort of help you</font>

406
00:16:07,740 --> 00:16:14,819
automate your assessment it hasn't been

407
00:16:11,910 --> 00:16:16,529
<font color="#E5E5E5">updated since released and I haven't</font>

408
00:16:14,819 --> 00:16:18,089
seen<font color="#E5E5E5"> anyone really actively picking it</font>

409
00:16:16,529 --> 00:16:20,519
up and<font color="#E5E5E5"> do anything with it</font><font color="#CCCCCC"> but it's</font>

410
00:16:18,089 --> 00:16:21,930
really the<font color="#CCCCCC"> only</font><font color="#E5E5E5"> tool out there that you</font>

411
00:16:20,519 --> 00:16:23,279
really should have you<font color="#CCCCCC"> should</font><font color="#E5E5E5"> definitely</font>

412
00:16:21,930 --> 00:16:25,469
have it your toolbox if you're attacking

413
00:16:23,279 --> 00:16:27,360
these sort of systems and it's a lot I

414
00:16:25,470 --> 00:16:28,529
basically started pouring a lot of this

415
00:16:27,360 --> 00:16:31,199
stuff over to the<font color="#CCCCCC"> metasploit framework</font>

416
00:16:28,529 --> 00:16:33,420
and some stuff<font color="#E5E5E5"> that's in beloit some</font>

417
00:16:31,199 --> 00:16:35,550
stuff that's not just so<font color="#E5E5E5"> I can leverage</font>

418
00:16:33,420 --> 00:16:38,729
the<font color="#E5E5E5"> framework and also because my Python</font>

419
00:16:35,550 --> 00:16:40,050
coding skills are pretty pure but one of

420
00:16:38,730 --> 00:16:42,959
<font color="#CCCCCC">the plugins that</font><font color="#E5E5E5"> I haven't ported yet</font>

421
00:16:40,050 --> 00:16:44,939
<font color="#E5E5E5">that's pretty cool is the separate spy</font>

422
00:16:42,959 --> 00:16:46,709
that<font color="#E5E5E5"> he's got which you</font><font color="#CCCCCC"> just point it at</font>

423
00:16:44,939 --> 00:16:49,819
the<font color="#CCCCCC"> saporito and pointed a network or</font><font color="#E5E5E5"> a</font>

424
00:16:46,709 --> 00:16:53,489
horse behind it and ask its port scan it

425
00:16:49,819 --> 00:16:54,930
it'll come back with holistic ports that

426
00:16:53,490 --> 00:16:56,819
are available and also it will set up

427
00:16:54,930 --> 00:16:58,560
nice little connectors for you so you

428
00:16:56,819 --> 00:17:01,729
can<font color="#E5E5E5"> run other plugins that are available</font>

429
00:16:58,560 --> 00:17:05,639
in the framework against those servers

430
00:17:01,730 --> 00:17:07,740
scroll back<font color="#CCCCCC"> up you see their whole list</font>

431
00:17:05,640 --> 00:17:09,569
of services that<font color="#CCCCCC"> are available on</font><font color="#E5E5E5"> that</font>

432
00:17:07,740 --> 00:17:16,380
<font color="#E5E5E5">box including the max DB ports that</font>

433
00:17:09,569 --> 00:17:18,928
strictly<font color="#CCCCCC"> speaking on</font><font color="#E5E5E5"> ASAP boards</font><font color="#CCCCCC"> okay a</font>

434
00:17:16,380 --> 00:17:20,549
little bit<font color="#E5E5E5"> more</font><font color="#CCCCCC"> about the GUI you see</font>

435
00:17:18,929 --> 00:17:25,289
what it looks like and the fellows

436
00:17:20,549 --> 00:17:26,908
windows<font color="#CCCCCC"> ex usable or add other but what</font>

437
00:17:25,289 --> 00:17:29,879
above and beyond just using it like you

438
00:17:26,909 --> 00:17:31,409
<font color="#E5E5E5">would</font><font color="#CCCCCC"> expect like a web form it's got a</font>

439
00:17:29,880 --> 00:17:33,030
lot<font color="#E5E5E5"> of functionality that allows for a</font>

440
00:17:31,409 --> 00:17:34,440
file transfers back was<font color="#CCCCCC"> import from</font><font color="#E5E5E5"> the</font>

441
00:17:33,030 --> 00:17:35,970
server a lot of events<font color="#E5E5E5"> that can be</font>

442
00:17:34,440 --> 00:17:39,570
scripted the windows<font color="#CCCCCC"> version comes with</font>

443
00:17:35,970 --> 00:17:41,370
a lot of activex controls a lot of the

444
00:17:39,570 --> 00:17:42,480
ActiveX controls activex controls

445
00:17:41,370 --> 00:17:44,419
historically have suffered from like

446
00:17:42,480 --> 00:17:47,370
buffer overflows or

447
00:17:44,420 --> 00:17:48,990
command injection and that sort of stuff

448
00:17:47,370 --> 00:17:51,270
<font color="#E5E5E5">and instead of fixing a lot of the</font>

449
00:17:48,990 --> 00:17:52,800
issues except just set the kill bit so

450
00:17:51,270 --> 00:17:54,570
it's not remotely callable so you're<font color="#E5E5E5"> not</font>

451
00:17:52,800 --> 00:17:56,820
gonna get it by<font color="#E5E5E5"> seriously from a</font>

452
00:17:54,570 --> 00:17:59,429
drive-by attack but if your local<font color="#CCCCCC"> to</font>

453
00:17:56,820 --> 00:18:00,899
that box and you haven't got your tool

454
00:17:59,430 --> 00:18:03,000
set on there you could just bring up

455
00:18:00,900 --> 00:18:04,350
Internet Explorer VBS whatever you want

456
00:18:03,000 --> 00:18:06,480
<font color="#CCCCCC">it</font><font color="#E5E5E5"> and start using these activex</font>

457
00:18:04,350 --> 00:18:09,240
controls to to attack the system locally

458
00:18:06,480 --> 00:18:11,160
or if you own the internet on a

459
00:18:09,240 --> 00:18:18,930
particular environment then you know do

460
00:18:11,160 --> 00:18:21,540
you drive by from that window it'll SAP

461
00:18:18,930 --> 00:18:23,250
users basically they go in<font color="#E5E5E5"> use a set</font>

462
00:18:21,540 --> 00:18:25,290
theory execute different transactions

463
00:18:23,250 --> 00:18:27,390
forms and do the same task over and over

464
00:18:25,290 --> 00:18:29,340
over again and it's quite the boys to go

465
00:18:27,390 --> 00:18:30,600
through and<font color="#CCCCCC"> find</font><font color="#E5E5E5"> where you need to be so</font>

466
00:18:29,340 --> 00:18:33,480
the create shortcuts to particular

467
00:18:30,600 --> 00:18:34,290
<font color="#E5E5E5">transactions or screens just</font><font color="#CCCCCC"> to save</font>

468
00:18:33,480 --> 00:18:36,600
them having to<font color="#E5E5E5"> go through that</font>

469
00:18:34,290 --> 00:18:38,460
navigation each time but also<font color="#CCCCCC"> SAP sport</font>

470
00:18:36,600 --> 00:18:39,540
saving the password in the credential so

471
00:18:38,460 --> 00:18:42,300
you have to be bothered entering the

472
00:18:39,540 --> 00:18:43,980
credentials each time as well in all the

473
00:18:42,300 --> 00:18:45,629
versions the passwords encoded and

474
00:18:43,980 --> 00:18:47,790
there's a few decoding scripts available

475
00:18:45,630 --> 00:18:49,770
for the only internet to do that in the

476
00:18:47,790 --> 00:18:51,889
later ones it's encrypted I personally

477
00:18:49,770 --> 00:18:53,820
<font color="#CCCCCC">immersed in any sort of tool sets to</font>

478
00:18:51,890 --> 00:18:58,710
automatically decrypt or attack the

479
00:18:53,820 --> 00:19:00,899
crypto but while I say old versions the

480
00:18:58,710 --> 00:19:03,240
one component in a SAP environment that

481
00:19:00,900 --> 00:19:04,650
gets updated the least is<font color="#CCCCCC"> the client GUI</font>

482
00:19:03,240 --> 00:19:06,150
because unless there's a piece of

483
00:19:04,650 --> 00:19:08,250
functionality and a new release that

484
00:19:06,150 --> 00:19:10,350
someone really<font color="#E5E5E5"> needs then it's not going</font>

485
00:19:08,250 --> 00:19:12,810
<font color="#E5E5E5">to get updated and a lot of this</font>

486
00:19:10,350 --> 00:19:14,580
<font color="#E5E5E5">software falls outside the remit of your</font>

487
00:19:12,810 --> 00:19:15,570
IT security team you know it's hard

488
00:19:14,580 --> 00:19:17,310
<font color="#E5E5E5">enough to try and get them to update</font>

489
00:19:15,570 --> 00:19:20,879
<font color="#CCCCCC">Adobe you let alone start looking at set</font>

490
00:19:17,310 --> 00:19:22,320
theory so there's number of tax that<font color="#E5E5E5"> are</font>

491
00:19:20,880 --> 00:19:24,030
available if you can inject yourself

492
00:19:22,320 --> 00:19:28,500
into the stream just why I mentioned

493
00:19:24,030 --> 00:19:30,210
<font color="#CCCCCC">diems tool previously if you can get</font>

494
00:19:28,500 --> 00:19:31,530
<font color="#E5E5E5">into the comms and start calling some of</font>

495
00:19:30,210 --> 00:19:34,410
these api's and functions that are

496
00:19:31,530 --> 00:19:36,629
available you can abuse them by for a

497
00:19:34,410 --> 00:19:38,790
man-in-the-middle attack to upload files

498
00:19:36,630 --> 00:19:43,320
download files execute operating system

499
00:19:38,790 --> 00:19:44,520
commands so the windows if the server

500
00:19:43,320 --> 00:19:46,290
environments totally locked down you're

501
00:19:44,520 --> 00:19:49,129
not able to attack that then attacking

502
00:19:46,290 --> 00:19:52,020
the client is a sure way<font color="#CCCCCC"> of getting in I</font>

503
00:19:49,130 --> 00:19:58,110
think<font color="#CCCCCC"> I've got</font><font color="#E5E5E5"> a link to ins tool down</font>

504
00:19:52,020 --> 00:20:01,230
there and the<font color="#E5E5E5"> koi ASAP concept is that</font>

505
00:19:58,110 --> 00:20:03,120
clients are things you connect<font color="#CCCCCC"> to in sap</font>

506
00:20:01,230 --> 00:20:04,650
so you have you set GUI and that

507
00:20:03,120 --> 00:20:07,709
connects to one of the potential

508
00:20:04,650 --> 00:20:09,809
thousand clients each system will have a

509
00:20:07,710 --> 00:20:12,570
variable amount of clients available to

510
00:20:09,809 --> 00:20:16,980
it for<font color="#CCCCCC"> different purposes by default the</font>

511
00:20:12,570 --> 00:20:20,870
three listed there 2000 10 66 but any

512
00:20:16,980 --> 00:20:20,870
system may have a whole load more

513
00:20:21,230 --> 00:20:25,830
sometimes<font color="#CCCCCC"> as four different teams</font><font color="#E5E5E5"> for</font>

514
00:20:23,970 --> 00:20:27,510
different data sets and and start tries

515
00:20:25,830 --> 00:20:30,030
to implement a sort of data segregation

516
00:20:27,510 --> 00:20:31,770
from the front end<font color="#CCCCCC"> to make</font><font color="#E5E5E5"> sure that</font>

517
00:20:30,030 --> 00:20:33,178
someone has got access to one client

518
00:20:31,770 --> 00:20:34,320
can't access another<font color="#E5E5E5"> client and things</font>

519
00:20:33,179 --> 00:20:36,870
like that or at least the<font color="#CCCCCC"> data is stored</font>

520
00:20:34,320 --> 00:20:38,879
<font color="#CCCCCC">in there but if using</font><font color="#E5E5E5"> RFC to try and</font>

521
00:20:36,870 --> 00:20:40,678
connect to a<font color="#E5E5E5"> SAP system and you point it</font>

522
00:20:38,880 --> 00:20:44,070
to a client that doesn't exist it gives

523
00:20:40,679 --> 00:20:49,620
it a Bose error message so it's pretty

524
00:20:44,070 --> 00:20:51,570
trivial to use<font color="#E5E5E5"> that as a brute force so</font>

525
00:20:49,620 --> 00:20:53,790
what I've done is create a Metasploit

526
00:20:51,570 --> 00:20:57,149
module from now on<font color="#CCCCCC"> our bitch with much</font>

527
00:20:53,790 --> 00:20:58,678
more my modules because I wanted<font color="#E5E5E5"> to</font>

528
00:20:57,150 --> 00:21:00,270
leverage the capabilities of<font color="#E5E5E5"> metasploit</font>

529
00:20:58,679 --> 00:21:03,690
I took a look and<font color="#CCCCCC"> there's already about</font>

530
00:21:00,270 --> 00:21:06,299
<font color="#E5E5E5">20 auxiliary modules 10x point modules</font>

531
00:21:03,690 --> 00:21:08,850
but none of them use this RFC protocol

532
00:21:06,299 --> 00:21:10,620
they're all for a<font color="#CCCCCC"> web-based type</font>

533
00:21:08,850 --> 00:21:13,860
exploitation or client type exploitation

534
00:21:10,620 --> 00:21:16,739
i've crafted about 15 14 modules at the

535
00:21:13,860 --> 00:21:19,168
moment and<font color="#E5E5E5"> i have tried</font><font color="#CCCCCC"> to submit them</font>

536
00:21:16,740 --> 00:21:21,540
to Matt's point but because my cards

537
00:21:19,169 --> 00:21:24,179
relying on the<font color="#E5E5E5"> SDK and the Ruby rapper</font>

538
00:21:21,540 --> 00:21:26,820
that's available metasploit<font color="#E5E5E5"> seem to</font>

539
00:21:24,179 --> 00:21:28,830
think it might be problematic so today

540
00:21:26,820 --> 00:21:30,090
tomorrow be released on the<font color="#E5E5E5"> lab site</font>

541
00:21:28,830 --> 00:21:31,470
where people can go and grab it's really

542
00:21:30,090 --> 00:21:33,090
easy to run as long as<font color="#CCCCCC"> you get the</font>

543
00:21:31,470 --> 00:21:35,760
library files and eventually it might

544
00:21:33,090 --> 00:21:38,820
make itself into<font color="#E5E5E5"> metasploit but for</font><font color="#CCCCCC"> now</font>

545
00:21:35,760 --> 00:21:40,919
it's not there so quick demo of one of

546
00:21:38,820 --> 00:21:44,970
the first modules which just automates

547
00:21:40,919 --> 00:21:47,220
the enumeration of the clients available

548
00:21:44,970 --> 00:21:50,570
in a SAP system just point<font color="#E5E5E5"> it at the</font>

549
00:21:47,220 --> 00:21:52,890
gateway it'll go through trying to

550
00:21:50,570 --> 00:21:55,379
determine what's available based on the

551
00:21:52,890 --> 00:21:57,600
error message that come back so these

552
00:21:55,380 --> 00:21:59,640
just about a thousand doesn't take long

553
00:21:57,600 --> 00:22:00,899
to run<font color="#E5E5E5"> through the entire list and this</font>

554
00:21:59,640 --> 00:22:02,730
actually looks slower because it's all

555
00:22:00,900 --> 00:22:05,520
in on my desktop if you actually just

556
00:22:02,730 --> 00:22:08,130
<font color="#CCCCCC">find this against the</font><font color="#E5E5E5"> environment there</font>

557
00:22:05,520 --> 00:22:10,230
you go once you've determined the

558
00:22:08,130 --> 00:22:11,290
clients<font color="#CCCCCC"> that are available then the next</font>

559
00:22:10,230 --> 00:22:13,960
<font color="#E5E5E5">step is going to be</font>

560
00:22:11,290 --> 00:22:15,820
tu brute force the accounts<font color="#CCCCCC"> that are</font>

561
00:22:13,960 --> 00:22:18,670
available<font color="#CCCCCC"> in each client now the default</font>

562
00:22:15,820 --> 00:22:22,060
threshold is<font color="#CCCCCC"> 5 so you're going</font><font color="#E5E5E5"> to have</font>

563
00:22:18,670 --> 00:22:23,530
like four attempts previously in a lot

564
00:22:22,060 --> 00:22:26,020
<font color="#CCCCCC">of systems the default was to</font>

565
00:22:23,530 --> 00:22:29,770
automatically unlock after midnight any

566
00:22:26,020 --> 00:22:32,350
lot<font color="#E5E5E5"> two counts these days I very seldom</font>

567
00:22:29,770 --> 00:22:36,400
see a system that's set to automatically

568
00:22:32,350 --> 00:22:40,480
unlock but you can usually rely on there

569
00:22:36,400 --> 00:22:42,970
being about five attempts at<font color="#E5E5E5"> least if</font>

570
00:22:40,480 --> 00:22:46,150
you can talk to a particular service

571
00:22:42,970 --> 00:22:48,460
that's available by default on SAP

572
00:22:46,150 --> 00:22:49,900
systems you can<font color="#CCCCCC"> ask it to tell you what</font>

573
00:22:48,460 --> 00:22:51,130
the account lockout threshold is and

574
00:22:49,900 --> 00:22:54,250
what the current configuration settings

575
00:22:51,130 --> 00:22:56,200
are so do that first basically<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> a</font>

576
00:22:54,250 --> 00:22:57,310
bunch of<font color="#CCCCCC"> metasploit modules that were</font>

577
00:22:56,200 --> 00:23:00,010
written<font color="#E5E5E5"> by a guy called Chris John</font>

578
00:22:57,310 --> 00:23:01,389
<font color="#CCCCCC">Reilly and and what that does is</font>

579
00:23:00,010 --> 00:23:02,560
basically there's a<font color="#CCCCCC"> SAP administration</font>

580
00:23:01,390 --> 00:23:04,750
console is available to SAP

581
00:23:02,560 --> 00:23:07,120
administrators and by<font color="#E5E5E5"> default it also</font>

582
00:23:04,750 --> 00:23:09,520
listens externally and exposes a soap

583
00:23:07,120 --> 00:23:11,080
web service and there's a whole bunch<font color="#E5E5E5"> of</font>

584
00:23:09,520 --> 00:23:13,900
methods within that web service that are

585
00:23:11,080 --> 00:23:16,510
available to unauthenticated calls so

586
00:23:13,900 --> 00:23:18,760
you can fire some of these modules

587
00:23:16,510 --> 00:23:20,620
against it and pull back a lot<font color="#E5E5E5"> of</font>

588
00:23:18,760 --> 00:23:22,360
<font color="#E5E5E5">configuration settings and a lot of the</font>

589
00:23:20,620 --> 00:23:26,050
<font color="#CCCCCC">boss info I'll show something a</font><font color="#E5E5E5"> bit</font>

590
00:23:22,360 --> 00:23:27,370
later<font color="#E5E5E5"> on if you brute force in and it's</font>

591
00:23:26,050 --> 00:23:29,159
good to<font color="#E5E5E5"> know if there's any default user</font>

592
00:23:27,370 --> 00:23:31,270
names and passwords lists out there and

593
00:23:29,160 --> 00:23:33,340
these defaults have been around<font color="#E5E5E5"> for a</font>

594
00:23:31,270 --> 00:23:35,230
long time<font color="#CCCCCC"> and they still pop up I've yet</font>

595
00:23:33,340 --> 00:23:36,879
to do an assessment where I don't get in

596
00:23:35,230 --> 00:23:40,870
with some sort of default credential

597
00:23:36,880 --> 00:23:42,130
from this list the SAP star user even<font color="#E5E5E5"> if</font>

598
00:23:40,870 --> 00:23:43,510
you configure all your clients and then

599
00:23:42,130 --> 00:23:45,250
changed all these defaults when you

600
00:23:43,510 --> 00:23:47,440
create a new client the defaults reapply

601
00:23:45,250 --> 00:23:49,720
so you have to be quite religiously

602
00:23:47,440 --> 00:23:52,210
making sure<font color="#E5E5E5"> that you change that again</font>

603
00:23:49,720 --> 00:23:54,640
or configure the backends that it's an

604
00:23:52,210 --> 00:23:58,480
automatical process but typically<font color="#E5E5E5"> people</font>

605
00:23:54,640 --> 00:24:02,470
don't do that it's another module that i

606
00:23:58,480 --> 00:24:04,150
wrote to automate brute forcing the<font color="#E5E5E5"> SAP</font>

607
00:24:02,470 --> 00:24:06,010
clients using the information that<font color="#E5E5E5"> we</font>

608
00:24:04,150 --> 00:24:07,740
get up<font color="#E5E5E5"> previously about the available</font>

609
00:24:06,010 --> 00:24:10,330
clients just<font color="#CCCCCC"> using a common user</font>

610
00:24:07,740 --> 00:24:12,250
username password list that again I'll

611
00:24:10,330 --> 00:24:13,659
be dispute with the models you see<font color="#E5E5E5"> there</font>

612
00:24:12,250 --> 00:24:18,310
we've got locked accounts available

613
00:24:13,660 --> 00:24:22,620
accounts or with their defaults again

614
00:24:18,310 --> 00:24:22,620
that takes no time at all to run

615
00:24:23,080 --> 00:24:27,260
once you've actually gained access to<font color="#CCCCCC"> a</font>

616
00:24:25,940 --> 00:24:29,330
<font color="#E5E5E5">SAP system you're going</font><font color="#CCCCCC"> to be</font><font color="#E5E5E5"> looking to</font>

617
00:24:27,260 --> 00:24:31,160
actually use it<font color="#E5E5E5"> and they're</font>

618
00:24:29,330 --> 00:24:34,610
problematically or through the GUI and

619
00:24:31,160 --> 00:24:37,160
the core concept<font color="#E5E5E5"> behind so is this</font>

620
00:24:34,610 --> 00:24:38,540
concept of transactions so you<font color="#E5E5E5"> login you</font>

621
00:24:37,160 --> 00:24:41,060
execute<font color="#CCCCCC"> your transaction would be that</font>

622
00:24:38,540 --> 00:24:43,970
fire a transaction code or be it by

623
00:24:41,060 --> 00:24:46,310
clicking on buttons or menu objects and

624
00:24:43,970 --> 00:24:47,600
some will go away and<font color="#E5E5E5"> run reports and</font>

625
00:24:46,310 --> 00:24:49,580
depend<font color="#E5E5E5"> on the module that you're</font><font color="#CCCCCC"> looking</font>

626
00:24:47,600 --> 00:24:51,350
at that could be financial reports it

627
00:24:49,580 --> 00:24:53,149
could be shipping reports data

628
00:24:51,350 --> 00:24:56,240
warehousing or it could just be an

629
00:24:53,150 --> 00:24:57,320
interactive form that you you've got<font color="#E5E5E5"> to</font>

630
00:24:56,240 --> 00:25:01,130
do your job far there's lots<font color="#E5E5E5"> of</font>

631
00:24:57,320 --> 00:25:03,110
<font color="#CCCCCC">different functionality within SAP and I</font>

632
00:25:01,130 --> 00:25:06,050
don't really pretend to know it all or

633
00:25:03,110 --> 00:25:09,129
why its use to just try to get<font color="#E5E5E5"> access to</font>

634
00:25:06,050 --> 00:25:11,720
the data that clients don't want<font color="#E5E5E5"> me to</font>

635
00:25:09,130 --> 00:25:12,980
they can be called like<font color="#E5E5E5"> I said by</font>

636
00:25:11,720 --> 00:25:14,570
entering the command field but also from

637
00:25:12,980 --> 00:25:16,820
a bap if you can code you're on a bat

638
00:25:14,570 --> 00:25:18,590
<font color="#E5E5E5">and get that into</font><font color="#CCCCCC"> the system then you</font>

639
00:25:16,820 --> 00:25:20,510
can use these functions call transaction

640
00:25:18,590 --> 00:25:21,649
<font color="#CCCCCC">leave transaction which will execute</font>

641
00:25:20,510 --> 00:25:23,720
them in the background<font color="#E5E5E5"> and bring the</font>

642
00:25:21,650 --> 00:25:25,610
data back<font color="#CCCCCC"> to you or if it doesn't return</font>

643
00:25:23,720 --> 00:25:27,470
data just<font color="#E5E5E5"> leave it alone some</font>

644
00:25:25,610 --> 00:25:29,659
transactions that are going<font color="#E5E5E5"> to be most</font>

645
00:25:27,470 --> 00:25:31,760
interest to pen testers are the ones

646
00:25:29,660 --> 00:25:33,680
listed up here now is about 16,000

647
00:25:31,760 --> 00:25:37,129
transactions by default in a in a normal

648
00:25:33,680 --> 00:25:38,270
basic<font color="#CCCCCC"> SAP system and</font><font color="#E5E5E5"> lots of them can be</font>

649
00:25:37,130 --> 00:25:40,280
abused in lots of different ways

650
00:25:38,270 --> 00:25:42,680
depending on which ones are available

651
00:25:40,280 --> 00:25:44,420
and how they're authorized but typically

652
00:25:42,680 --> 00:25:45,680
if I get in with some sort<font color="#E5E5E5"> of level of</font>

653
00:25:44,420 --> 00:25:48,620
access these are the transactions I'm

654
00:25:45,680 --> 00:25:50,060
going to go far first sm 69 allows you

655
00:25:48,620 --> 00:25:51,320
to actually set<font color="#CCCCCC"> up your own operating</font>

656
00:25:50,060 --> 00:25:53,629
system commands<font color="#E5E5E5"> that we run on the</font>

657
00:25:51,320 --> 00:25:55,840
server that you're looking<font color="#CCCCCC"> at sm 49 just</font>

658
00:25:53,630 --> 00:25:57,950
allows you to call them<font color="#E5E5E5"> and execute them</font>

659
00:25:55,840 --> 00:26:00,290
the report there is the same thing<font color="#CCCCCC"> just</font>

660
00:25:57,950 --> 00:26:02,030
execute I very seldom see the display

661
00:26:00,290 --> 00:26:06,050
file and download UNIX file but I've

662
00:26:02,030 --> 00:26:10,610
come across it previously it's a<font color="#E5E5E5"> quick</font>

663
00:26:06,050 --> 00:26:14,210
demo of how to manually call sm 69 and

664
00:26:10,610 --> 00:26:16,189
abuse it now there's a whole<font color="#E5E5E5"> bunch of</font>

665
00:26:14,210 --> 00:26:18,680
pre-configured operating system commands

666
00:26:16,190 --> 00:26:21,110
for various different purposes and a

667
00:26:18,680 --> 00:26:23,000
<font color="#CCCCCC">window system sorry on linux and windows</font>

668
00:26:21,110 --> 00:26:25,639
systems some of them support additional

669
00:26:23,000 --> 00:26:26,660
parameters on<font color="#E5E5E5"> windows systems however</font>

670
00:26:25,640 --> 00:26:28,700
the ones that support additional

671
00:26:26,660 --> 00:26:30,980
parameters are also vulnerable to

672
00:26:28,700 --> 00:26:33,260
command injection so you can just

673
00:26:30,980 --> 00:26:34,600
ampersand or pipe or whatever<font color="#CCCCCC"> your on</font>

674
00:26:33,260 --> 00:26:37,990
arbitrary commands after that

675
00:26:34,600 --> 00:26:42,159
in<font color="#CCCCCC"> Linux by accident rather than design</font>

676
00:26:37,990 --> 00:26:43,750
it's not vulnerable<font color="#E5E5E5"> to the same thing</font><font color="#CCCCCC"> no</font>

677
00:26:42,160 --> 00:26:44,980
<font color="#E5E5E5">again I will said when I show all this</font>

678
00:26:43,750 --> 00:26:46,360
sort of stuff<font color="#E5E5E5"> to sat they come back</font>

679
00:26:44,980 --> 00:26:48,160
today we got<font color="#E5E5E5"> fixes for this and it's</font>

680
00:26:46,360 --> 00:26:50,020
here and here's a reference but again

681
00:26:48,160 --> 00:26:52,179
all those references point to a<font color="#E5E5E5"> paywall</font>

682
00:26:50,020 --> 00:26:54,220
for me so I can't<font color="#E5E5E5"> unsee if they are</font>

683
00:26:52,179 --> 00:26:56,590
fixed or<font color="#E5E5E5"> not but all this stuff was done</font>

684
00:26:54,220 --> 00:26:58,960
on the latest demo systems available

685
00:26:56,590 --> 00:27:00,659
from<font color="#CCCCCC"> SAP so</font><font color="#E5E5E5"> that at least not fixed in</font>

686
00:26:58,960 --> 00:27:03,220
the<font color="#E5E5E5"> latest versions they giving away</font>

687
00:27:00,660 --> 00:27:06,460
their what I've done is piping Who am I

688
00:27:03,220 --> 00:27:10,890
you see at the<font color="#E5E5E5"> bottom maybe not there is</font>

689
00:27:06,460 --> 00:27:10,890
a service account system level access

690
00:27:12,090 --> 00:27:15,459
once you gain access to a SEP system

691
00:27:14,350 --> 00:27:16,840
you've got various credentials you might

692
00:27:15,460 --> 00:27:18,730
not have brute force to all the possible

693
00:27:16,840 --> 00:27:21,580
user accounts that are available the

694
00:27:18,730 --> 00:27:23,770
password<font color="#CCCCCC"> hashes for</font><font color="#E5E5E5"> SAP users are stored</font>

695
00:27:21,580 --> 00:27:26,879
in two different tables and direct

696
00:27:23,770 --> 00:27:30,100
copies of the day<font color="#E5E5E5"> user to news ashl to</font>

697
00:27:26,880 --> 00:27:31,360
John the Ripper has support for cracking

698
00:27:30,100 --> 00:27:33,969
these hashes all<font color="#CCCCCC"> you've got to</font><font color="#E5E5E5"> do is get</font>

699
00:27:31,360 --> 00:27:37,418
them out and you can<font color="#E5E5E5"> get the fields you</font>

700
00:27:33,970 --> 00:27:38,890
looking for a<font color="#CCCCCC"> B card and passcode the</font>

701
00:27:37,419 --> 00:27:40,539
hashing mechanisms that are supported by

702
00:27:38,890 --> 00:27:42,909
sac or listed up there but<font color="#E5E5E5"> ones you're</font>

703
00:27:40,539 --> 00:27:45,789
going to come across more often or B and

704
00:27:42,909 --> 00:27:47,890
G with be being md5 so you can get<font color="#CCCCCC"> that</font>

705
00:27:45,789 --> 00:27:51,210
out it doesn't<font color="#E5E5E5"> take very long to crack</font>

706
00:27:47,890 --> 00:27:54,190
at all<font color="#E5E5E5"> G just a little bit longer and</font>

707
00:27:51,210 --> 00:27:56,140
this is it when you export from<font color="#E5E5E5"> SAP it's</font>

708
00:27:54,190 --> 00:27:57,580
not exactly consumable format and

709
00:27:56,140 --> 00:27:59,020
there's a little<font color="#E5E5E5"> perl script that comes</font>

710
00:27:57,580 --> 00:28:03,460
with<font color="#CCCCCC"> john that will convert it for you</font>

711
00:27:59,020 --> 00:28:07,750
into<font color="#E5E5E5"> john friendly format it's a quick</font>

712
00:28:03,460 --> 00:28:09,669
demo of using se6<font color="#E5E5E5"> dec16 which is a date</font>

713
00:28:07,750 --> 00:28:12,360
at browser transaction to actually

714
00:28:09,669 --> 00:28:17,500
export the data from these tables

715
00:28:12,360 --> 00:28:20,918
directly into<font color="#CCCCCC"> john for cracking se16 and</font>

716
00:28:17,500 --> 00:28:22,929
se11 and other two transactions that can

717
00:28:20,919 --> 00:28:25,299
be used<font color="#E5E5E5"> to start poking around inside a</font>

718
00:28:22,929 --> 00:28:27,490
<font color="#CCCCCC">SAP system looking at RFC looking at a</font>

719
00:28:25,299 --> 00:28:31,740
bar code looking at various different

720
00:28:27,490 --> 00:28:31,740
<font color="#E5E5E5">transactions reports or data tables</font>

721
00:28:37,020 --> 00:28:43,000
when this gets exported out it probably

722
00:28:40,960 --> 00:28:44,890
cracks quite quickly because already<font color="#CCCCCC"> out</font>

723
00:28:43,000 --> 00:28:46,179
in my dictionary lists and didn't<font color="#CCCCCC"> think</font>

724
00:28:44,890 --> 00:28:48,760
anyone would sit here waiting for her

725
00:28:46,179 --> 00:28:50,620
she's to crack but it didn't take that

726
00:28:48,760 --> 00:28:52,179
long at all it was probably about five

727
00:28:50,620 --> 00:28:56,489
minutes before<font color="#E5E5E5"> the hashes have been spat</font>

728
00:28:52,179 --> 00:28:56,490
out again just being the<font color="#CCCCCC"> default</font><font color="#E5E5E5"> I</font>

729
00:28:58,230 --> 00:29:02,400
mentioned<font color="#E5E5E5"> before the concept of all the</font>

730
00:29:00,190 --> 00:29:04,720
thousand clients that are<font color="#CCCCCC"> available and</font>

731
00:29:02,400 --> 00:29:07,179
the<font color="#E5E5E5"> data segregation that's in place</font>

732
00:29:04,720 --> 00:29:08,380
from sat is imposed client-side and

733
00:29:07,179 --> 00:29:09,309
basically<font color="#E5E5E5"> behind the scenes what</font>

734
00:29:08,380 --> 00:29:10,900
actually happens when you execute

735
00:29:09,309 --> 00:29:12,250
something<font color="#E5E5E5"> on ya skits return date it</font>

736
00:29:10,900 --> 00:29:14,049
like in the demo I just had their<font color="#CCCCCC"> the</font>

737
00:29:12,250 --> 00:29:16,510
user accounts that returned with for the

738
00:29:14,049 --> 00:29:18,280
clients that<font color="#CCCCCC"> are logged into not for all</font>

739
00:29:16,510 --> 00:29:19,780
clients available in the system because

740
00:29:18,280 --> 00:29:21,370
<font color="#E5E5E5">this where clause happens in the</font>

741
00:29:19,780 --> 00:29:23,350
background which basically says if you

742
00:29:21,370 --> 00:29:26,168
logged<font color="#CCCCCC"> into client 001 you can only</font><font color="#E5E5E5"> have</font>

743
00:29:23,350 --> 00:29:28,480
date others index 2001<font color="#E5E5E5"> i stunned by this</font>

744
00:29:26,169 --> 00:29:29,860
man t field so everything<font color="#CCCCCC"> you do through</font>

745
00:29:28,480 --> 00:29:31,630
the GUI when you logged<font color="#CCCCCC"> into the client</font>

746
00:29:29,860 --> 00:29:33,280
is pretty much gone<font color="#E5E5E5"> enforced this man t</font>

747
00:29:31,630 --> 00:29:35,020
field over the years<font color="#E5E5E5"> has been</font>

748
00:29:33,280 --> 00:29:37,899
transactions that failed to<font color="#E5E5E5"> do this lots</font>

749
00:29:35,020 --> 00:29:41,049
of different bypasses and bit by bit

750
00:29:37,900 --> 00:29:42,309
they've been closed off really to do it

751
00:29:41,049 --> 00:29:44,590
<font color="#E5E5E5">these days what you've got to do is get</font>

752
00:29:42,309 --> 00:29:45,870
into a transaction called se 80 which<font color="#CCCCCC"> is</font>

753
00:29:44,590 --> 00:29:48,610
kind<font color="#E5E5E5"> of like a built in visual studio</font>

754
00:29:45,870 --> 00:29:50,379
which allows you to write a bat code and

755
00:29:48,610 --> 00:29:51,909
if you can write your an<font color="#E5E5E5"> hour about code</font>

756
00:29:50,380 --> 00:29:55,059
or edit about code that's already there

757
00:29:51,910 --> 00:29:56,980
and inject some statements<font color="#CCCCCC"> that call</font>

758
00:29:55,059 --> 00:29:59,080
<font color="#CCCCCC">exec sequel which is native sequel</font>

759
00:29:56,980 --> 00:30:02,880
interrogating<font color="#E5E5E5"> the database directly and</font>

760
00:29:59,080 --> 00:30:02,879
this magic where clause isn't imposed

761
00:30:03,929 --> 00:30:08,470
about code as<font color="#E5E5E5"> I said before</font><font color="#CCCCCC"> is</font>

762
00:30:05,890 --> 00:30:11,140
whatsapp's basically built around and

763
00:30:08,470 --> 00:30:12,610
it's at the core the source code for all

764
00:30:11,140 --> 00:30:14,770
the a bat programs are actually stored

765
00:30:12,610 --> 00:30:16,750
in the database so you can get<font color="#CCCCCC"> access to</font>

766
00:30:14,770 --> 00:30:18,280
the database or you transaction se18

767
00:30:16,750 --> 00:30:20,530
pull that stuff out<font color="#E5E5E5"> and modify it</font>

768
00:30:18,280 --> 00:30:23,590
putting your backdoors play around with

769
00:30:20,530 --> 00:30:24,730
it and also generate<font color="#E5E5E5"> your code stuff</font>

770
00:30:23,590 --> 00:30:26,530
that's coming from sa p that might

771
00:30:24,730 --> 00:30:28,059
already be compiled<font color="#E5E5E5"> it's kind of in like</font>

772
00:30:26,530 --> 00:30:31,660
a byte code format and that's stored in

773
00:30:28,059 --> 00:30:34,500
the database as well in the<font color="#E5E5E5"> production</font>

774
00:30:31,660 --> 00:30:36,940
environment modification of this is is

775
00:30:34,500 --> 00:30:38,799
supposedly prohibited but again it's

776
00:30:36,940 --> 00:30:39,970
<font color="#E5E5E5">enforced</font><font color="#CCCCCC"> client-side so</font><font color="#E5E5E5"> you get into the</font>

777
00:30:38,799 --> 00:30:41,559
database you can<font color="#E5E5E5"> manipulate in a</font>

778
00:30:39,970 --> 00:30:43,510
production environment which people

779
00:30:41,559 --> 00:30:45,280
probably aren't expecting but also when

780
00:30:43,510 --> 00:30:46,440
this code is loaded there's no CRC check

781
00:30:45,280 --> 00:30:48,450
just

782
00:30:46,440 --> 00:30:53,610
politically believes that it's<font color="#E5E5E5"> not been</font>

783
00:30:48,450 --> 00:30:57,570
tampered with remote function calls that

784
00:30:53,610 --> 00:30:59,158
I've been talking about in order<font color="#CCCCCC"> to call</font>

785
00:30:57,570 --> 00:31:00,960
these code blocks you've got to go

786
00:30:59,159 --> 00:31:03,090
<font color="#CCCCCC">through something</font><font color="#E5E5E5"> called a SAP gateway</font>

787
00:31:00,960 --> 00:31:04,559
each instance of sat will have a<font color="#E5E5E5"> gateway</font>

788
00:31:03,090 --> 00:31:07,230
<font color="#E5E5E5">so you might have several SAP service</font>

789
00:31:04,559 --> 00:31:08,879
but one gateway that controls where

790
00:31:07,230 --> 00:31:11,700
these icy calls are routed for load

791
00:31:08,879 --> 00:31:13,139
balancing purposes may well execute them

792
00:31:11,700 --> 00:31:17,580
themselves or they may pass him off to

793
00:31:13,139 --> 00:31:18,600
another<font color="#E5E5E5"> application server some of them</font>

794
00:31:17,580 --> 00:31:20,699
<font color="#E5E5E5">can be called without authentication</font>

795
00:31:18,600 --> 00:31:24,408
some of them require authentication and

796
00:31:20,700 --> 00:31:28,019
some of them require certain privileges

797
00:31:24,409 --> 00:31:30,299
but with 16,000<font color="#CCCCCC"> rfcs available by</font>

798
00:31:28,019 --> 00:31:31,980
default and then a lot<font color="#E5E5E5"> of custom ones no</font>

799
00:31:30,299 --> 00:31:34,110
one really goes<font color="#E5E5E5"> to the trouble of doing</font>

800
00:31:31,980 --> 00:31:35,159
this at a granular level so you'll<font color="#E5E5E5"> find</font>

801
00:31:34,110 --> 00:31:36,209
that<font color="#E5E5E5"> if you've got permission for</font>

802
00:31:35,159 --> 00:31:38,460
particular one that<font color="#E5E5E5"> you probably could</font>

803
00:31:36,210 --> 00:31:41,460
have permission for<font color="#CCCCCC"> store again it's all</font>

804
00:31:38,460 --> 00:31:43,590
<font color="#E5E5E5">in all in clear text with the</font>

805
00:31:41,460 --> 00:31:45,240
<font color="#CCCCCC">credentials as being</font><font color="#E5E5E5"> xorg and there's a</font>

806
00:31:43,590 --> 00:31:46,949
link there to one of the first

807
00:31:45,240 --> 00:31:49,649
decompression tools that came out for

808
00:31:46,950 --> 00:31:51,960
this stuff the<font color="#CCCCCC"> ex walkie</font><font color="#E5E5E5"> I was talking</font>

809
00:31:49,649 --> 00:31:53,699
about<font color="#E5E5E5"> the static key there it is as</font>

810
00:31:51,960 --> 00:31:55,950
<font color="#E5E5E5">little</font><font color="#CCCCCC"> Python script comes with this</font>

811
00:31:53,700 --> 00:31:57,539
point this has been available<font color="#E5E5E5"> for years</font>

812
00:31:55,950 --> 00:31:59,460
and years just<font color="#E5E5E5"> Google that key and it's</font>

813
00:31:57,539 --> 00:32:04,110
everywhere why Seth<font color="#E5E5E5"> haven't changed it</font>

814
00:31:59,460 --> 00:32:07,110
or gone to something better this<font color="#E5E5E5"> three</font>

815
00:32:04,110 --> 00:32:08,610
at the moment<font color="#E5E5E5"> three RC calls that can be</font>

816
00:32:07,110 --> 00:32:10,258
called without<font color="#E5E5E5"> authentication that you</font>

817
00:32:08,610 --> 00:32:11,549
can use to<font color="#E5E5E5"> discover a lot more</font>

818
00:32:10,259 --> 00:32:13,440
<font color="#CCCCCC">information about the SAP system you</font>

819
00:32:11,549 --> 00:32:15,450
looking at I've see doc you you can

820
00:32:13,440 --> 00:32:16,919
actually cycle through and try to use<font color="#E5E5E5"> to</font>

821
00:32:15,450 --> 00:32:20,789
discover other RC functions are

822
00:32:16,919 --> 00:32:21,870
available system info are quick screen

823
00:32:20,789 --> 00:32:24,899
on x1 show you the information that

824
00:32:21,870 --> 00:32:27,199
returns and ping that just tells<font color="#E5E5E5"> you the</font>

825
00:32:24,899 --> 00:32:30,029
availability<font color="#CCCCCC"> of different systems so</font>

826
00:32:27,200 --> 00:32:32,159
I've SI system info here you call that

827
00:32:30,029 --> 00:32:33,990
again<font color="#E5E5E5"> without credentials it'll tell you</font>

828
00:32:32,159 --> 00:32:36,539
what sort of databases the back end is

829
00:32:33,990 --> 00:32:38,549
where that date they say there is the

830
00:32:36,539 --> 00:32:40,350
kernel version of the sap software so

831
00:32:38,549 --> 00:32:42,389
your knife<font color="#CCCCCC"> has any thorns with it just</font>

832
00:32:40,350 --> 00:32:47,879
lots of useful info by default just by

833
00:32:42,389 --> 00:32:50,639
asking for<font color="#CCCCCC"> it if you've</font><font color="#E5E5E5"> got the</font><font color="#CCCCCC"> SDK it's</font>

834
00:32:47,879 --> 00:32:52,469
been<font color="#CCCCCC"> deployed on a</font><font color="#E5E5E5"> SAP server typically</font>

835
00:32:50,639 --> 00:32:55,649
these it's in the<font color="#CCCCCC"> car see exec which</font>

836
00:32:52,470 --> 00:32:59,800
allows the execution<font color="#CCCCCC"> of external</font>

837
00:32:55,649 --> 00:33:02,590
operating system<font color="#E5E5E5"> commands by RFC we</font>

838
00:32:59,800 --> 00:33:03,700
if the classical version of the<font color="#CCCCCC"> SDK if</font>

839
00:33:02,590 --> 00:33:06,100
this<font color="#E5E5E5"> has been registered with</font><font color="#CCCCCC"> the</font>

840
00:33:03,700 --> 00:33:08,080
<font color="#CCCCCC">Gateway and this RFC is available then</font>

841
00:33:06,100 --> 00:33:10,449
wild cards are permitted<font color="#E5E5E5"> and by default</font>

842
00:33:08,080 --> 00:33:12,220
<font color="#CCCCCC">if someone turns it on you can call</font><font color="#E5E5E5"> it</font>

843
00:33:10,450 --> 00:33:15,490
from anywhere and execute any operating

844
00:33:12,220 --> 00:33:18,790
system command in the<font color="#CCCCCC"> latest version</font>

845
00:33:15,490 --> 00:33:20,200
it's been flipped so wild cards are no

846
00:33:18,790 --> 00:33:22,860
longer permitted you have to explicitly

847
00:33:20,200 --> 00:33:26,290
say which command needs to be executed

848
00:33:22,860 --> 00:33:28,120
<font color="#E5E5E5">and it's a lot</font><font color="#CCCCCC"> more robust but even in</font>

849
00:33:26,290 --> 00:33:31,060
the old version if you<font color="#E5E5E5"> have specifically</font>

850
00:33:28,120 --> 00:33:32,770
specified a command to<font color="#E5E5E5"> be executed</font><font color="#CCCCCC"> and</font>

851
00:33:31,060 --> 00:33:34,810
don't want<font color="#E5E5E5"> to allow wild cards and using</font>

852
00:33:32,770 --> 00:33:36,639
blacklisting it's trivial to bypass the

853
00:33:34,810 --> 00:33:39,040
engine that enforces that by just

854
00:33:36,640 --> 00:33:40,720
switching uppercase lowercase and usual

855
00:33:39,040 --> 00:33:43,330
types of bypasses that you be<font color="#CCCCCC"> familiar</font>

856
00:33:40,720 --> 00:33:44,830
with we're doing web app testing I've

857
00:33:43,330 --> 00:33:46,419
<font color="#CCCCCC">put the set nut up on this slide I</font>

858
00:33:44,830 --> 00:33:47,860
haven't put them on any other sites

859
00:33:46,420 --> 00:33:49,600
because this one you<font color="#CCCCCC"> can actually Google</font>

860
00:33:47,860 --> 00:33:55,050
for and find out<font color="#E5E5E5"> more information about</font>

861
00:33:49,600 --> 00:33:57,879
the failings of this stuff another

862
00:33:55,050 --> 00:34:01,000
default RFC that can be sometimes be

863
00:33:57,880 --> 00:34:03,730
able is SAP execute external program

864
00:34:01,000 --> 00:34:06,190
which is available on most of this app

865
00:34:03,730 --> 00:34:08,440
application service web<font color="#CCCCCC"> service now if</font>

866
00:34:06,190 --> 00:34:10,330
you kick this one off<font color="#E5E5E5"> and it will have a</font>

867
00:34:08,440 --> 00:34:11,710
look at a second<font color="#CCCCCC"> profile for its</font>

868
00:34:10,330 --> 00:34:13,900
restrictions if that file doesn't exist

869
00:34:11,710 --> 00:34:16,120
then<font color="#E5E5E5"> everything is allowed so you can</font>

870
00:34:13,900 --> 00:34:17,440
call this RFC<font color="#E5E5E5"> and execute operating</font>

871
00:34:16,120 --> 00:34:21,668
system commands to your<font color="#E5E5E5"> height extend</font>

872
00:34:17,440 --> 00:34:24,460
and then finally there's this other one

873
00:34:21,668 --> 00:34:26,350
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> similar names but this will only</font>

874
00:34:24,460 --> 00:34:29,710
allow you to execute<font color="#E5E5E5"> commands that have</font>

875
00:34:26,350 --> 00:34:32,168
been pre defined in the<font color="#E5E5E5"> NSM 69 and sm 49</font>

876
00:34:29,710 --> 00:34:34,179
transactions so you can't arbitrarily

877
00:34:32,168 --> 00:34:36,520
specify what<font color="#CCCCCC"> you want unless of course</font>

878
00:34:34,179 --> 00:34:39,340
you calling<font color="#E5E5E5"> it against window system and</font>

879
00:34:36,520 --> 00:34:41,440
use it for command injection so I've got

880
00:34:39,340 --> 00:34:46,030
a little<font color="#E5E5E5"> Metasploit module here exploit</font>

881
00:34:41,440 --> 00:34:47,860
module that i wrote the demo how to use

882
00:34:46,030 --> 00:34:50,440
the credentials that we've<font color="#E5E5E5"> brute force</font>

883
00:34:47,860 --> 00:34:51,760
previously to call a predefined

884
00:34:50,440 --> 00:34:54,880
transaction that's<font color="#E5E5E5"> available by default</font>

885
00:34:51,760 --> 00:34:56,740
called list<font color="#E5E5E5"> dbt</font><font color="#CCCCCC"> dump and this is</font>

886
00:34:54,880 --> 00:34:58,750
<font color="#E5E5E5">available and it's OS independence that</font>

887
00:34:56,739 --> 00:35:00,910
run on<font color="#CCCCCC"> Linux as well and use the command</font>

888
00:34:58,750 --> 00:35:03,670
injection vol.2 actually embed a

889
00:35:00,910 --> 00:35:07,660
<font color="#CCCCCC">metasploit meterpreter payload running</font>

890
00:35:03,670 --> 00:35:10,090
on a<font color="#E5E5E5"> Windows 2008 server to return and</font>

891
00:35:07,660 --> 00:35:13,210
meterpreter shell but it's got to<font color="#E5E5E5"> be</font>

892
00:35:10,090 --> 00:35:19,869
<font color="#CCCCCC">broken down into 256 choice max per</font>

893
00:35:13,210 --> 00:35:28,900
request but again<font color="#E5E5E5"> it doesn't take</font><font color="#CCCCCC"> very</font>

894
00:35:19,869 --> 00:35:30,820
long it's just the breaking up this is

895
00:35:28,900 --> 00:35:32,260
running on<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> only at the moment I</font>

896
00:35:30,820 --> 00:35:35,950
<font color="#CCCCCC">am still</font><font color="#E5E5E5"> trying to work on there on the</font>

897
00:35:32,260 --> 00:35:38,140
Linux version but there's no<font color="#CCCCCC"> pre-stage</font>

898
00:35:35,950 --> 00:35:41,549
are available in the framework for Linux

899
00:35:38,140 --> 00:35:46,540
so I have to<font color="#E5E5E5"> write it</font><font color="#CCCCCC"> or work around it</font>

900
00:35:41,550 --> 00:35:48,970
and<font color="#E5E5E5"> I</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> at the time just because I</font>

901
00:35:46,540 --> 00:35:52,180
<font color="#CCCCCC">can't get a meterpreter shell as easily</font>

902
00:35:48,970 --> 00:35:53,859
through on a windows box doesn't mean

903
00:35:52,180 --> 00:35:55,899
that on a<font color="#E5E5E5"> Linux box we can't do some</font>

904
00:35:53,859 --> 00:35:57,430
cool stuff so the commands that<font color="#E5E5E5"> are</font>

905
00:35:55,900 --> 00:35:59,500
available this is now running with the

906
00:35:57,430 --> 00:36:03,390
<font color="#E5E5E5">other function on it on a</font><font color="#CCCCCC"> linux setup</font>

907
00:35:59,500 --> 00:36:05,500
and using the built-in command<font color="#E5E5E5"> x user</font>

908
00:36:03,390 --> 00:36:07,750
will execute that and it will dump out

909
00:36:05,500 --> 00:36:10,330
the content to that x users 62 file that

910
00:36:07,750 --> 00:36:11,920
was available for set max DB we can walk

911
00:36:10,330 --> 00:36:15,098
<font color="#CCCCCC">through the output of that and look</font>

912
00:36:11,920 --> 00:36:18,040
further the superuser key for the

913
00:36:15,099 --> 00:36:20,500
database user once we found<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we can</font>

914
00:36:18,040 --> 00:36:22,330
use<font color="#E5E5E5"> the same RFC function to call</font>

915
00:36:20,500 --> 00:36:23,710
another predefined operating system

916
00:36:22,330 --> 00:36:27,069
command that's again<font color="#CCCCCC"> available by</font>

917
00:36:23,710 --> 00:36:32,500
default<font color="#E5E5E5"> and os independent to actually</font>

918
00:36:27,070 --> 00:36:35,530
execute a sequel query so the second one

919
00:36:32,500 --> 00:36:38,109
should<font color="#CCCCCC"> be dbm</font><font color="#E5E5E5"> cly that's available yeah</font>

920
00:36:35,530 --> 00:36:40,660
and the sequel statement have run their

921
00:36:38,109 --> 00:36:43,060
brings back all the users and password

922
00:36:40,660 --> 00:36:44,529
hashes right across all clients so if we

923
00:36:43,060 --> 00:36:46,540
brute forced and got the credentials for

924
00:36:44,530 --> 00:36:49,420
one client and we can call our city we

925
00:36:46,540 --> 00:36:50,890
<font color="#CCCCCC">can get all the other client users and</font>

926
00:36:49,420 --> 00:36:57,940
then do the<font color="#CCCCCC"> same thing</font><font color="#E5E5E5"> over and over and</font>

927
00:36:50,890 --> 00:36:59,799
over<font color="#E5E5E5"> again to get the data this RFC is</font>

928
00:36:57,940 --> 00:37:02,680
pretty cool because this allows you to

929
00:36:59,800 --> 00:37:04,810
remotely execute your honor about a<font color="#E5E5E5"> bat</font>

930
00:37:02,680 --> 00:37:09,069
code gets loaded into the table compiled

931
00:37:04,810 --> 00:37:10,869
executed and thrown away<font color="#E5E5E5"> it's deprecated</font>

932
00:37:09,070 --> 00:37:13,060
apparently calling such never been

933
00:37:10,869 --> 00:37:15,220
released<font color="#E5E5E5"> etc and in production</font>

934
00:37:13,060 --> 00:37:17,529
environments it's always disabled but

935
00:37:15,220 --> 00:37:18,939
before<font color="#CCCCCC"> I showed you the transport</font>

936
00:37:17,530 --> 00:37:21,790
communication channels that available

937
00:37:18,940 --> 00:37:24,310
<font color="#E5E5E5">from like QA dev through to prod if you</font>

938
00:37:21,790 --> 00:37:25,779
can break into one of those environments

939
00:37:24,310 --> 00:37:26,480
then you've got that communication

940
00:37:25,780 --> 00:37:29,960
channel through

941
00:37:26,480 --> 00:37:32,060
also because<font color="#CCCCCC"> of the the way set works</font>

942
00:37:29,960 --> 00:37:34,369
and you have people using the sack<font color="#CCCCCC"> Giri</font>

943
00:37:32,060 --> 00:37:36,470
connecting to<font color="#CCCCCC"> each different environment</font>

944
00:37:34,369 --> 00:37:37,609
and there's all those functions

945
00:37:36,470 --> 00:37:39,439
available that could be pre-configured

946
00:37:37,609 --> 00:37:40,759
in the self environment if you can<font color="#E5E5E5"> break</font>

947
00:37:39,440 --> 00:37:42,560
into one of those dev environments or

948
00:37:40,760 --> 00:37:44,630
the QA environments and plant some

949
00:37:42,560 --> 00:37:47,240
trojan eyes code and on the client and

950
00:37:44,630 --> 00:37:48,950
then jump back through to prod so sat

951
00:37:47,240 --> 00:37:52,399
down play this one a little bit but it's

952
00:37:48,950 --> 00:37:57,140
still<font color="#CCCCCC"> pretty dangerous so I wrote</font>

953
00:37:52,400 --> 00:38:00,050
another module to use this function to

954
00:37:57,140 --> 00:38:04,129
deliver some custom a bat code that

955
00:38:00,050 --> 00:38:05,990
calls the native sequel function to

956
00:38:04,130 --> 00:38:06,980
again do the<font color="#E5E5E5"> same thing and go through</font>

957
00:38:05,990 --> 00:38:16,009
and dump the<font color="#CCCCCC"> user names and passwords</font>

958
00:38:06,980 --> 00:38:19,640
<font color="#E5E5E5">for all clients in set land is this</font>

959
00:38:16,010 --> 00:38:21,800
concept<font color="#E5E5E5"> of external servers and IRC</font>

960
00:38:19,640 --> 00:38:22,879
server is known as an external server

961
00:38:21,800 --> 00:38:24,260
but it doesn't<font color="#E5E5E5"> have to be something</font>

962
00:38:22,880 --> 00:38:25,369
you've installed step on this could be

963
00:38:24,260 --> 00:38:28,550
something<font color="#E5E5E5"> that you've programmed with</font>

964
00:38:25,369 --> 00:38:30,470
the SDK and you exposing these remote

965
00:38:28,550 --> 00:38:32,330
function<font color="#E5E5E5"> calls and you can write your</font>

966
00:38:30,470 --> 00:38:33,799
<font color="#CCCCCC">own client again doesn't</font><font color="#E5E5E5"> need any sap</font>

967
00:38:32,330 --> 00:38:36,170
software other than what you've written

968
00:38:33,800 --> 00:38:38,300
against the SDK to call these rfcs

969
00:38:36,170 --> 00:38:40,490
that's why<font color="#E5E5E5"> I've been able to do it from</font>

970
00:38:38,300 --> 00:38:42,380
<font color="#CCCCCC">matts white all</font><font color="#E5E5E5"> the calls going through</font>

971
00:38:40,490 --> 00:38:43,910
the Gateway where they'll be executed

972
00:38:42,380 --> 00:38:45,619
locally or on these external servers

973
00:38:43,910 --> 00:38:49,520
which member don't exactly have to be

974
00:38:45,619 --> 00:38:51,890
<font color="#E5E5E5">SAP servers their work in two different</font>

975
00:38:49,520 --> 00:38:53,359
<font color="#E5E5E5">modes this started and registered in</font>

976
00:38:51,890 --> 00:38:55,730
started mode everything statically

977
00:38:53,359 --> 00:38:58,220
configured so you configure all of your

978
00:38:55,730 --> 00:38:59,720
sap servers to report to one gateway as

979
00:38:58,220 --> 00:39:03,740
which are<font color="#E5E5E5"> seas are available where they</font>

980
00:38:59,720 --> 00:39:07,368
are insta flat in in the second mode

981
00:39:03,740 --> 00:39:09,410
there the registered mode anyone can

982
00:39:07,369 --> 00:39:12,290
dynamically register as an external SAP

983
00:39:09,410 --> 00:39:16,220
server all you need<font color="#E5E5E5"> to do is present it</font>

984
00:39:12,290 --> 00:39:17,660
with a program<font color="#E5E5E5"> ID also as a TP name but</font>

985
00:39:16,220 --> 00:39:18,859
if you think<font color="#CCCCCC"> about these columns that</font>

986
00:39:17,660 --> 00:39:20,750
are gone<font color="#CCCCCC"> on</font><font color="#E5E5E5"> all the time these</font><font color="#CCCCCC"> the</font>

987
00:39:18,859 --> 00:39:22,430
dynamic registrations are taking place

988
00:39:20,750 --> 00:39:24,590
<font color="#E5E5E5">or calls are taking place this</font>

989
00:39:22,430 --> 00:39:26,810
information<font color="#CCCCCC"> is passed across the wire in</font>

990
00:39:24,590 --> 00:39:29,869
the clear you can<font color="#E5E5E5"> capture it</font><font color="#CCCCCC"> gain it and</font>

991
00:39:26,810 --> 00:39:32,029
then use it so what you could actually

992
00:39:29,869 --> 00:39:33,859
do with that is launched something

993
00:39:32,030 --> 00:39:35,720
called needle twin attack which Mariano

994
00:39:33,859 --> 00:39:38,540
from a nap sis first came up<font color="#CCCCCC"> with and</font>

995
00:39:35,720 --> 00:39:39,950
he's python-based white framework

996
00:39:38,540 --> 00:39:41,540
actually has<font color="#CCCCCC"> built-in</font>

997
00:39:39,950 --> 00:39:44,060
yet to port<font color="#E5E5E5"> this as well but what you</font>

998
00:39:41,540 --> 00:39:46,520
can do is register your own external

999
00:39:44,060 --> 00:39:48,290
server spoofing and already registered

1000
00:39:46,520 --> 00:39:51,020
server so that you can man in the<font color="#E5E5E5"> middle</font>

1001
00:39:48,290 --> 00:39:52,990
the communication so whoever's calling

1002
00:39:51,020 --> 00:39:57,070
these at RFC functions you can capture

1003
00:39:52,990 --> 00:39:59,839
manipulate replay steal credentials and

1004
00:39:57,070 --> 00:40:01,190
do lots of nefarious things all you've

1005
00:39:59,840 --> 00:40:02,900
got to do is actually block the

1006
00:40:01,190 --> 00:40:06,950
legitimate server and again<font color="#CCCCCC"> the</font>

1007
00:40:02,900 --> 00:40:08,240
<font color="#CCCCCC">framework has that built in second to</font>

1008
00:40:06,950 --> 00:40:09,589
the<font color="#E5E5E5"> evil twin attack which is</font><font color="#CCCCCC"> just a</font>

1009
00:40:08,240 --> 00:40:11,629
man-in-the-middle attack is<font color="#CCCCCC"> the callback</font>

1010
00:40:09,590 --> 00:40:13,910
attack is a routine that flips the

1011
00:40:11,630 --> 00:40:16,910
client-server relationship so you can

1012
00:40:13,910 --> 00:40:18,529
<font color="#E5E5E5">get into</font><font color="#CCCCCC"> this and then use this to call</font>

1013
00:40:16,910 --> 00:40:21,170
the callback routine you can get the

1014
00:40:18,530 --> 00:40:24,590
calling server to execute code of<font color="#E5E5E5"> your</font>

1015
00:40:21,170 --> 00:40:27,110
choice now that might be someone else on

1016
00:40:24,590 --> 00:40:29,270
the environment using an<font color="#E5E5E5"> SDK / honor it</font>

1017
00:40:27,110 --> 00:40:31,400
might be another SAP server call in IRC

1018
00:40:29,270 --> 00:40:36,620
function which<font color="#E5E5E5"> running</font><font color="#CCCCCC"> a sec or some</font>

1019
00:40:31,400 --> 00:40:40,700
kind of a<font color="#E5E5E5"> Ministry of account a brief</font>

1020
00:40:36,620 --> 00:40:42,470
look at set web and<font color="#E5E5E5"> I'm not going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> go</font>

1021
00:40:40,700 --> 00:40:43,939
into again what any web hacking because

1022
00:40:42,470 --> 00:40:47,899
most people in<font color="#E5E5E5"> this room probably know</font>

1023
00:40:43,940 --> 00:40:49,430
how to do where that hacking but the set

1024
00:40:47,900 --> 00:40:50,360
management console that I was<font color="#E5E5E5"> talking</font>

1025
00:40:49,430 --> 00:40:52,490
about<font color="#CCCCCC"> at the beginning</font><font color="#E5E5E5"> that you could</font>

1026
00:40:50,360 --> 00:40:55,330
call<font color="#E5E5E5"> and get through its soap service</font>

1027
00:40:52,490 --> 00:40:57,680
their account lockout threshold the

1028
00:40:55,330 --> 00:41:00,500
audit settings and configuration options

1029
00:40:57,680 --> 00:41:03,919
and things like that by default and SAP

1030
00:41:00,500 --> 00:41:06,650
service that's found on port 5 13<font color="#CCCCCC"> 5 14</font>

1031
00:41:03,920 --> 00:41:09,650
where X represents the instance number

1032
00:41:06,650 --> 00:41:16,940
of the SAP system which can<font color="#E5E5E5"> be from 0 to</font>

1033
00:41:09,650 --> 00:41:23,410
99 this is what it looks like it's<font color="#E5E5E5"> just</font>

1034
00:41:16,940 --> 00:41:26,450
a java-based console and there's a few

1035
00:41:23,410 --> 00:41:27,890
demo a quick demo of the Metasploit

1036
00:41:26,450 --> 00:41:30,799
module that's available from chris john

1037
00:41:27,890 --> 00:41:33,850
riley to interrogate the soap service

1038
00:41:30,800 --> 00:41:36,860
and return the account lockout threshold

1039
00:41:33,850 --> 00:41:38,720
it doesn't take very<font color="#E5E5E5"> long at all now sap</font>

1040
00:41:36,860 --> 00:41:40,400
also downplay the fact that a<font color="#E5E5E5"> lot of</font>

1041
00:41:38,720 --> 00:41:43,759
<font color="#E5E5E5">these methods are available unexposed</font>

1042
00:41:40,400 --> 00:41:46,220
and particularly some demo in a minute

1043
00:41:43,760 --> 00:41:47,990
which allows brute force and command

1044
00:41:46,220 --> 00:41:50,480
execution and things with<font color="#E5E5E5"> the argument</font>

1045
00:41:47,990 --> 00:41:51,529
that if you could<font color="#E5E5E5"> talk to the operating</font>

1046
00:41:50,480 --> 00:41:53,180
system you could do this sort of stuff

1047
00:41:51,530 --> 00:41:53,660
anyway but typically in a safe

1048
00:41:53,180 --> 00:41:55,788
environment

1049
00:41:53,660 --> 00:41:58,250
not<font color="#E5E5E5"> going to usually hopefully be able</font>

1050
00:41:55,789 --> 00:41:59,930
to<font color="#E5E5E5"> talk over SMB</font><font color="#CCCCCC"> and other transports</font>

1051
00:41:58,250 --> 00:42:03,920
it's going<font color="#E5E5E5"> to be locked down so</font><font color="#CCCCCC"> you can</font>

1052
00:41:59,930 --> 00:42:08,299
only talk over<font color="#CCCCCC"> SAP as a default look out</font>

1053
00:42:03,920 --> 00:42:11,569
five SAP services so what I've got is<font color="#E5E5E5"> a</font>

1054
00:42:08,299 --> 00:42:13,849
quick demo of using chris's<font color="#CCCCCC"> metasploit</font>

1055
00:42:11,569 --> 00:42:16,339
modules as well just to walk through and

1056
00:42:13,849 --> 00:42:18,619
talk interrogate the<font color="#CCCCCC"> soap service so</font>

1057
00:42:16,339 --> 00:42:21,049
i'll tell you its version within the

1058
00:42:18,619 --> 00:42:23,000
version string we should see the system

1059
00:42:21,049 --> 00:42:25,009
identified the<font color="#E5E5E5"> three-letter character</font>

1060
00:42:23,000 --> 00:42:26,420
that makes up<font color="#E5E5E5"> the administrative user</font>

1061
00:42:25,010 --> 00:42:31,309
account that should be<font color="#CCCCCC"> available on the</font>

1062
00:42:26,420 --> 00:42:34,130
box use it to pull back some log files

1063
00:42:31,309 --> 00:42:36,440
and search those log files for user

1064
00:42:34,130 --> 00:42:38,450
accounts we<font color="#E5E5E5"> found one there MPL ATM</font>

1065
00:42:36,440 --> 00:42:40,309
submissive account and another module

1066
00:42:38,450 --> 00:42:44,029
here but just brute force that user

1067
00:42:40,309 --> 00:42:46,160
account using default passwords or one

1068
00:42:44,030 --> 00:42:51,740
specified and then see<font color="#E5E5E5"> if it's got</font>

1069
00:42:46,160 --> 00:42:53,480
permissions to call a web call one of

1070
00:42:51,740 --> 00:42:57,740
the functions that allows the execution

1071
00:42:53,480 --> 00:42:59,150
of operating system commands and then we

1072
00:42:57,740 --> 00:43:00,919
use<font color="#E5E5E5"> that account and I actually</font>

1073
00:42:59,150 --> 00:43:02,329
operating system cows to actually call

1074
00:43:00,920 --> 00:43:05,359
the web service that allows us<font color="#E5E5E5"> to</font>

1075
00:43:02,329 --> 00:43:07,160
execute our Bertie commands this again

1076
00:43:05,359 --> 00:43:09,859
is<font color="#CCCCCC"> all run against one of the latest</font>

1077
00:43:07,160 --> 00:43:12,618
versions of<font color="#E5E5E5"> set gateway available for</font>

1078
00:43:09,859 --> 00:43:16,430
download and test sat tell me that a<font color="#E5E5E5"> lot</font>

1079
00:43:12,619 --> 00:43:18,500
<font color="#E5E5E5">of this has been fixed but I can't get</font>

1080
00:43:16,430 --> 00:43:22,240
to the set nuts to check it out but it

1081
00:43:18,500 --> 00:43:22,240
always seems to work when I try it

1082
00:43:22,630 --> 00:43:27,500
there's lots of<font color="#CCCCCC"> different web servers</font>

1083
00:43:26,089 --> 00:43:30,078
that set make available in different

1084
00:43:27,500 --> 00:43:32,900
software<font color="#CCCCCC"> Suites and modules and they can</font>

1085
00:43:30,079 --> 00:43:34,640
execute a bap and/or job you can get a

1086
00:43:32,900 --> 00:43:38,000
nav app stack and a Java stack or advice

1087
00:43:34,640 --> 00:43:40,069
just<font color="#E5E5E5"> want the first one is</font><font color="#CCCCCC"> the EITS</font>

1088
00:43:38,000 --> 00:43:42,349
server which simply just translates the

1089
00:43:40,069 --> 00:43:45,558
web GUI screens as the<font color="#E5E5E5"> dialog screens</font>

1090
00:43:42,349 --> 00:43:48,400
into web GUI screens and the ICM which

1091
00:43:45,559 --> 00:43:50,869
is the<font color="#E5E5E5"> next step up which actually</font>

1092
00:43:48,400 --> 00:43:52,430
implements this ICF<font color="#CCCCCC"> Internet</font>

1093
00:43:50,869 --> 00:43:53,690
communication framework which for all

1094
00:43:52,430 --> 00:43:57,259
intents and purposes is just kind of

1095
00:43:53,690 --> 00:43:59,569
like active scripting there arc into PHP

1096
00:43:57,260 --> 00:44:01,789
ASP but they call an<font color="#CCCCCC"> Abbott curve right</font>

1097
00:43:59,569 --> 00:44:03,380
<font color="#E5E5E5">down on the back end and there's lots of</font>

1098
00:44:01,789 --> 00:44:05,390
them available summer<font color="#CCCCCC"> publix some</font>

1099
00:44:03,380 --> 00:44:06,859
require authentication and there's

1100
00:44:05,390 --> 00:44:07,279
another Metasploit module that<font color="#E5E5E5"> you can</font>

1101
00:44:06,859 --> 00:44:09,410
use<font color="#CCCCCC"> to</font>

1102
00:44:07,280 --> 00:44:11,870
<font color="#E5E5E5">a in a sort of diversity fashion to try</font>

1103
00:44:09,410 --> 00:44:14,750
and find these but what it also does is

1104
00:44:11,870 --> 00:44:16,670
provide a soap interface to RFC so all

1105
00:44:14,750 --> 00:44:19,160
the RFC calls that we've been doing<font color="#CCCCCC"> and</font>

1106
00:44:16,670 --> 00:44:21,890
abusing to enumerate clients brute force

1107
00:44:19,160 --> 00:44:24,140
users execute code can all be done<font color="#E5E5E5"> for a</font>

1108
00:44:21,890 --> 00:44:25,220
self interface as well<font color="#E5E5E5"> and I just</font>

1109
00:44:24,140 --> 00:44:27,740
haven't got around to writing<font color="#E5E5E5"> those</font>

1110
00:44:25,220 --> 00:44:29,089
specific modules yet and again at the

1111
00:44:27,740 --> 00:44:32,750
moment it's a matter of firing up<font color="#CCCCCC"> their</font>

1112
00:44:29,090 --> 00:44:38,590
<font color="#E5E5E5">up and doing it manually then the web</font>

1113
00:44:32,750 --> 00:44:40,870
dispatcher sits in<font color="#CCCCCC"> the same</font><font color="#E5E5E5"> air as the</font>

1114
00:44:38,590 --> 00:44:43,910
<font color="#E5E5E5">root of that I</font><font color="#CCCCCC"> showed only on the first</font>

1115
00:44:40,870 --> 00:44:47,750
network architecture diagram and this<font color="#CCCCCC"> is</font>

1116
00:44:43,910 --> 00:44:52,490
can be used to<font color="#E5E5E5"> prevent execution of some</font>

1117
00:44:47,750 --> 00:44:54,860
of those ICF scripts and apply<font color="#E5E5E5"> it's kind</font>

1118
00:44:52,490 --> 00:44:57,560
of like a web application proxy firewall

1119
00:44:54,860 --> 00:44:59,600
here's an example URL for it<font color="#E5E5E5"> again</font>

1120
00:44:57,560 --> 00:45:02,900
sports wildcards permit<font color="#E5E5E5"> deny pretty</font>

1121
00:44:59,600 --> 00:45:05,630
basic stuff but nine times out of ten

1122
00:45:02,900 --> 00:45:08,240
whenever you one of these ACLs there's

1123
00:45:05,630 --> 00:45:09,820
massive gaps or you find<font color="#E5E5E5"> a lot really</font>

1124
00:45:08,240 --> 00:45:12,200
well configured at the beginning like

1125
00:45:09,820 --> 00:45:14,300
<font color="#CCCCCC">permit this restrict their cetera but</font>

1126
00:45:12,200 --> 00:45:16,730
somewhere along the line and this goes

1127
00:45:14,300 --> 00:45:18,920
for<font color="#E5E5E5"> the set</font><font color="#CCCCCC"> root proxy thing as well you</font>

1128
00:45:16,730 --> 00:45:25,180
get all stars because someone just<font color="#E5E5E5"> got</font>

1129
00:45:18,920 --> 00:45:25,180
sick of maintaining it or I who knows

1130
00:45:25,480 --> 00:45:32,180
<font color="#CCCCCC">the later web enabled</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> sat modules</font>

1131
00:45:29,870 --> 00:45:37,100
their portal which is kind<font color="#E5E5E5"> of an</font>

1132
00:45:32,180 --> 00:45:39,649
enterprise product that allows users to

1133
00:45:37,100 --> 00:45:42,710
go directly<font color="#E5E5E5"> to a website and gain access</font>

1134
00:45:39,650 --> 00:45:45,890
to corporate data internet data sap data

1135
00:45:42,710 --> 00:45:47,780
forms reports in a consumable fashion

1136
00:45:45,890 --> 00:45:49,160
that's presented to them and sometimes

1137
00:45:47,780 --> 00:45:51,410
they don't<font color="#CCCCCC"> even know the connection</font><font color="#E5E5E5"> to a</font>

1138
00:45:49,160 --> 00:45:53,330
<font color="#CCCCCC">sap system and it's like business</font>

1139
00:45:51,410 --> 00:45:56,089
objects which again does the same thing

1140
00:45:53,330 --> 00:45:57,259
<font color="#CCCCCC">but it sort of spiders its way into all</font>

1141
00:45:56,090 --> 00:45:59,930
sorts of<font color="#CCCCCC"> different enterprise resource</font>

1142
00:45:57,260 --> 00:46:02,120
resources like file system shares sama

1143
00:45:59,930 --> 00:46:06,649
shares and correlates all that data<font color="#E5E5E5"> and</font>

1144
00:46:02,120 --> 00:46:07,880
then makes it available p I lots of

1145
00:46:06,650 --> 00:46:12,200
different<font color="#CCCCCC"> things</font><font color="#E5E5E5"> that are just</font><font color="#CCCCCC"> designed</font>

1146
00:46:07,880 --> 00:46:14,510
to give different ways to<font color="#E5E5E5"> consume sap</font>

1147
00:46:12,200 --> 00:46:18,109
data and enterprise data all of these

1148
00:46:14,510 --> 00:46:20,780
built on the<font color="#CCCCCC"> sap j2ee engine which is</font>

1149
00:46:18,110 --> 00:46:21,170
very similar to other j2ee servers out

1150
00:46:20,780 --> 00:46:23,869
there

1151
00:46:21,170 --> 00:46:26,510
such as<font color="#E5E5E5"> Apache Tomcat weblogic websphere</font>

1152
00:46:23,869 --> 00:46:31,000
so it suffers from a lot of<font color="#CCCCCC"> the same</font>

1153
00:46:26,510 --> 00:46:34,220
issues that those systems suffer from

1154
00:46:31,000 --> 00:46:35,390
such as the invoker servlet<font color="#E5E5E5"> so</font><font color="#CCCCCC"> if</font>

1155
00:46:34,220 --> 00:46:36,828
<font color="#CCCCCC">anyone's been touched like Apache</font>

1156
00:46:35,390 --> 00:46:38,960
servers or any web servers and things

1157
00:46:36,829 --> 00:46:41,480
like that<font color="#E5E5E5"> okay if you're able invoke a</font>

1158
00:46:38,960 --> 00:46:44,750
server globally set then you can bypass

1159
00:46:41,480 --> 00:46:47,390
certain web.xml application filters so

1160
00:46:44,750 --> 00:46:48,380
if<font color="#CCCCCC"> it's slightly clearer I've tried to</font>

1161
00:46:47,390 --> 00:46:51,259
build it at the bottom<font color="#E5E5E5"> the web.xml</font>

1162
00:46:48,380 --> 00:46:53,869
config<font color="#E5E5E5"> therefore the servlet shows that</font>

1163
00:46:51,260 --> 00:46:55,970
if you access the servlet from admin

1164
00:46:53,869 --> 00:46:59,630
critical you should require

1165
00:46:55,970 --> 00:47:02,390
authentication however if they're

1166
00:46:59,630 --> 00:47:04,069
optionally set to true then what you<font color="#CCCCCC"> can</font>

1167
00:47:02,390 --> 00:47:06,290
actually do is call it directly from<font color="#E5E5E5"> its</font>

1168
00:47:04,069 --> 00:47:07,640
servlet container and execute the same

1169
00:47:06,290 --> 00:47:11,509
functionality without requiring

1170
00:47:07,640 --> 00:47:13,879
authentication so this exists in<font color="#E5E5E5"> sa p</font>

1171
00:47:11,510 --> 00:47:16,010
application<font color="#CCCCCC"> servers as well as</font><font color="#E5E5E5"> apache</font>

1172
00:47:13,880 --> 00:47:19,460
another web websphere and things like

1173
00:47:16,010 --> 00:47:21,589
app verb tempering is also something

1174
00:47:19,460 --> 00:47:24,109
that these SAP application servers are

1175
00:47:21,589 --> 00:47:26,480
vulnerable to this has been around again

1176
00:47:24,109 --> 00:47:28,069
<font color="#CCCCCC">for quite a while some rushing guys made</font>

1177
00:47:26,480 --> 00:47:31,040
a big thing about<font color="#E5E5E5"> this just</font><font color="#CCCCCC"> before</font>

1178
00:47:28,069 --> 00:47:34,730
Christmas and being sap specific in the

1179
00:47:31,040 --> 00:47:36,680
web portal what you're actually able to

1180
00:47:34,730 --> 00:47:39,020
<font color="#E5E5E5">do in one of the default configurations</font>

1181
00:47:36,680 --> 00:47:40,848
is call a servlet a quite dangerous

1182
00:47:39,020 --> 00:47:43,549
servlet that allows you<font color="#CCCCCC"> to add a local</font>

1183
00:47:40,849 --> 00:47:45,349
user on the system and add that to an

1184
00:47:43,549 --> 00:47:46,609
administrative users group so then you

1185
00:47:45,349 --> 00:47:49,099
can obviously<font color="#E5E5E5"> if you could access from a</font>

1186
00:47:46,609 --> 00:47:50,839
nice level getting interactive access to

1187
00:47:49,099 --> 00:47:52,970
the box and<font color="#E5E5E5"> the web.xml there what it</font>

1188
00:47:50,839 --> 00:47:56,089
shows you is that if<font color="#E5E5E5"> the URL pattern</font>

1189
00:47:52,970 --> 00:47:58,098
admin star whatever<font color="#E5E5E5"> is accessed via a</font>

1190
00:47:56,089 --> 00:48:00,710
get request it should require

1191
00:47:58,099 --> 00:48:03,140
authentication however because<font color="#CCCCCC"> it's not</font>

1192
00:48:00,710 --> 00:48:04,369
explicitly stated that if you<font color="#CCCCCC"> use a head</font>

1193
00:48:03,140 --> 00:48:06,170
request it should also require

1194
00:48:04,369 --> 00:48:07,910
authentication ahead<font color="#CCCCCC"> request will</font>

1195
00:48:06,170 --> 00:48:12,079
execute exactly the same<font color="#CCCCCC"> but won't</font>

1196
00:48:07,910 --> 00:48:14,990
require authentication so if you<font color="#E5E5E5"> sent</font>

1197
00:48:12,079 --> 00:48:17,210
ahead request to one of these to your

1198
00:48:14,990 --> 00:48:19,970
eyes instead of<font color="#E5E5E5"> a get request and a</font>

1199
00:48:17,210 --> 00:48:21,829
default<font color="#CCCCCC"> setup over satpur then you'll be</font>

1200
00:48:19,970 --> 00:48:24,348
<font color="#E5E5E5">able to create</font><font color="#CCCCCC"> a local user and add it</font>

1201
00:48:21,829 --> 00:48:25,790
to<font color="#E5E5E5"> a local domain user some reason</font>

1202
00:48:24,349 --> 00:48:27,650
certainly want me to show you these to

1203
00:48:25,790 --> 00:48:29,180
your eyes as far as they're concerned it

1204
00:48:27,650 --> 00:48:31,430
puts customers at risk but<font color="#E5E5E5"> this has been</font>

1205
00:48:29,180 --> 00:48:34,040
known about for quite a while again they

1206
00:48:31,430 --> 00:48:34,859
only publish their fix but<font color="#E5E5E5"> behind a</font>

1207
00:48:34,040 --> 00:48:36,930
paywall so

1208
00:48:34,860 --> 00:48:38,100
all who knows if<font color="#E5E5E5"> they're fix works but</font>

1209
00:48:36,930 --> 00:48:42,149
you really should<font color="#E5E5E5"> be exposing the stuff</font>

1210
00:48:38,100 --> 00:48:43,710
to the<font color="#E5E5E5"> internet anyway ok</font><font color="#CCCCCC"> I spoke all i</font>

1211
00:48:42,150 --> 00:48:46,710
got time for us to go through<font color="#E5E5E5"> we've got</font>

1212
00:48:43,710 --> 00:48:49,200
like 10 minutes ish left if anyone's got

1213
00:48:46,710 --> 00:48:51,600
any questions but<font color="#E5E5E5"> I wanted</font><font color="#CCCCCC"> to say thanks</font>

1214
00:48:49,200 --> 00:48:53,250
to these guys because I bounced the

1215
00:48:51,600 --> 00:48:55,259
slides and some of<font color="#E5E5E5"> my max quote modules</font>

1216
00:48:53,250 --> 00:48:59,400
off them to be a test and give me good

1217
00:48:55,260 --> 00:49:03,180
feedback so Chris in<font color="#E5E5E5"> uris Mariano Martin</font>

1218
00:48:59,400 --> 00:49:06,900
and Steve Ford does anyone<font color="#E5E5E5"> have any</font>

1219
00:49:03,180 --> 00:49:17,430
<font color="#CCCCCC">questions I</font><font color="#E5E5E5"> fight you too fast miss</font>

1220
00:49:06,900 --> 00:49:18,570
anything anyone<font color="#E5E5E5"> no no when I started</font>

1221
00:49:17,430 --> 00:49:20,339
playing<font color="#E5E5E5"> around with this stuff I said</font>

1222
00:49:18,570 --> 00:49:22,080
can I have demo versions can i play with

1223
00:49:20,340 --> 00:49:24,720
it<font color="#E5E5E5"> I'll</font><font color="#CCCCCC"> sheraton</font><font color="#E5E5E5"> I find you have all my</font>

1224
00:49:22,080 --> 00:49:27,660
tool sets no no go away so asked if I

1225
00:49:24,720 --> 00:49:30,029
could purchase access they said no you

1226
00:49:27,660 --> 00:49:31,080
have to buy the<font color="#CCCCCC"> software</font><font color="#E5E5E5"> you have to get</font>

1227
00:49:30,030 --> 00:49:33,360
the consultants in you have<font color="#E5E5E5"> to spend</font>

1228
00:49:31,080 --> 00:49:34,860
hundreds of thousands or millions or you

1229
00:49:33,360 --> 00:49:36,660
have to become<font color="#E5E5E5"> a qualified sap</font>

1230
00:49:34,860 --> 00:49:39,510
consultant by taking their training

1231
00:49:36,660 --> 00:49:41,730
courses and then get a job as a sap

1232
00:49:39,510 --> 00:49:45,290
consultant working for a set client who

1233
00:49:41,730 --> 00:49:45,290
then authorizes you to get<font color="#CCCCCC"> access to it</font>

1234
00:49:45,380 --> 00:49:49,080
yeah they've<font color="#E5E5E5"> got a security team they're</font>

1235
00:49:47,760 --> 00:49:57,240
quite nice to talk to<font color="#E5E5E5"> but they won't</font>

1236
00:49:49,080 --> 00:49:59,520
give you anything and so what questions

1237
00:49:57,240 --> 00:50:02,700
would you ask your client to scopus up

1238
00:49:59,520 --> 00:50:06,390
assessment typically what sort of

1239
00:50:02,700 --> 00:50:08,879
modules they've got deployed if it's an

1240
00:50:06,390 --> 00:50:10,410
in-house product so you if you're a

1241
00:50:08,880 --> 00:50:12,150
business and you want sat you can't just

1242
00:50:10,410 --> 00:50:14,160
<font color="#E5E5E5">go down to like Dixon's and take it off</font>

1243
00:50:12,150 --> 00:50:15,690
the shelf or order online you<font color="#E5E5E5"> go to a</font>

1244
00:50:14,160 --> 00:50:17,700
reseller and that reseller is either

1245
00:50:15,690 --> 00:50:19,470
going to sell you lots and lots of

1246
00:50:17,700 --> 00:50:20,730
consultancy days to come down and set it

1247
00:50:19,470 --> 00:50:22,680
up<font color="#E5E5E5"> for you or the hardware or the</font>

1248
00:50:20,730 --> 00:50:24,870
software all the different modules how

1249
00:50:22,680 --> 00:50:25,740
do you want them and then the sometimes

1250
00:50:24,870 --> 00:50:27,120
I tell you it's<font color="#CCCCCC"> pretty much off the</font>

1251
00:50:25,740 --> 00:50:28,290
<font color="#CCCCCC">shelf and they'll set it up but they're</font>

1252
00:50:27,120 --> 00:50:30,150
going<font color="#E5E5E5"> to be on site for months and</font>

1253
00:50:28,290 --> 00:50:31,860
months and months customizing it for

1254
00:50:30,150 --> 00:50:33,600
your environment she really needed a

1255
00:50:31,860 --> 00:50:35,910
deep and meaningful conversation with

1256
00:50:33,600 --> 00:50:37,200
the client about how they've architected

1257
00:50:35,910 --> 00:50:40,200
their infrastructure what else it plugs

1258
00:50:37,200 --> 00:50:41,910
into what modules they've purchased how

1259
00:50:40,200 --> 00:50:44,339
many tears they've got configured if

1260
00:50:41,910 --> 00:50:46,710
they're making use of the<font color="#E5E5E5"> typical dev QA</font>

1261
00:50:44,340 --> 00:50:48,450
prod I mean I show dev QA prod but

1262
00:50:46,710 --> 00:50:48,750
there's a particular client I've got

1263
00:50:48,450 --> 00:50:50,879
this

1264
00:50:48,750 --> 00:50:55,260
got like 15 20 different environments

1265
00:50:50,880 --> 00:50:57,630
with dev QA prod pre prod pre QA test

1266
00:50:55,260 --> 00:50:59,580
environments and each one of those

1267
00:50:57,630 --> 00:51:00,930
environments needs to communicate to

1268
00:50:59,580 --> 00:51:03,180
pass those transports<font color="#E5E5E5"> those changes</font>

1269
00:51:00,930 --> 00:51:04,290
through and other people also need<font color="#CCCCCC"> to</font>

1270
00:51:03,180 --> 00:51:06,600
communicate with it other different

1271
00:51:04,290 --> 00:51:08,550
transports so it's a massive information

1272
00:51:06,600 --> 00:51:09,870
discovery exercise sit down map out

1273
00:51:08,550 --> 00:51:12,000
their architecture what it looks like

1274
00:51:09,870 --> 00:51:14,339
what transports what<font color="#E5E5E5"> communication</font>

1275
00:51:12,000 --> 00:51:16,560
channels have that they partnering with

1276
00:51:14,340 --> 00:51:20,130
external companies is it all in-house

1277
00:51:16,560 --> 00:51:22,290
have you isolated users from desktop

1278
00:51:20,130 --> 00:51:24,180
users if you're a portal<font color="#CCCCCC"> plug into</font>

1279
00:51:22,290 --> 00:51:39,770
enterprise it's a massive conversation

1280
00:51:24,180 --> 00:51:39,770
tab anyone<font color="#E5E5E5"> else on the but not Chris</font>

1281
00:51:40,310 --> 00:51:43,650
<font color="#CCCCCC">great presentation by the way I</font><font color="#E5E5E5"> just</font>

1282
00:51:42,390 --> 00:51:46,680
<font color="#CCCCCC">want to</font><font color="#E5E5E5"> make a quick comment about the</font>

1283
00:51:43,650 --> 00:51:48,450
SAP<font color="#E5E5E5"> root of stuff and at</font><font color="#CCCCCC"> some point they</font>

1284
00:51:46,680 --> 00:51:51,210
snuck out a patch so that if you put

1285
00:51:48,450 --> 00:51:53,220
star star star the final star doesn't

1286
00:51:51,210 --> 00:51:56,490
mean anything anymore it simply<font color="#CCCCCC"> means</font>

1287
00:51:53,220 --> 00:51:58,649
all SI p protocols<font color="#CCCCCC"> I'll send that out</font>

1288
00:51:56,490 --> 00:52:01,950
<font color="#E5E5E5">waiting to get out no idea but it's</font>

1289
00:51:58,650 --> 00:52:04,920
behind a paywall sure someone knows when

1290
00:52:01,950 --> 00:52:07,649
they snuck it out it it was sometime

1291
00:52:04,920 --> 00:52:11,010
between 64 and 72 which is<font color="#E5E5E5"> pretty much</font>

1292
00:52:07,650 --> 00:52:12,870
<font color="#E5E5E5">any time in the last 10 years so still</font>

1293
00:52:11,010 --> 00:52:15,000
people what I found in quite a lot of

1294
00:52:12,870 --> 00:52:16,710
live tests is that people simply put in

1295
00:52:15,000 --> 00:52:19,710
things like remote desktop protocol

1296
00:52:16,710 --> 00:52:22,740
routing so they can do SI p management

1297
00:52:19,710 --> 00:52:26,090
from home or from<font color="#E5E5E5"> the beach I've got a</font>

1298
00:52:22,740 --> 00:52:26,089
Metasploit module at into that

1299
00:52:33,900 --> 00:52:43,089
and things<font color="#E5E5E5"> can go drastically wrong when</font>

1300
00:52:37,660 --> 00:52:46,089
a<font color="#CCCCCC"> SAP system gets owned but that's it</font>

1301
00:52:43,089 --> 00:52:48,279
sorry<font color="#CCCCCC"> own door mistakes happen because</font>

1302
00:52:46,089 --> 00:52:52,150
it's so integrated integrated into every

1303
00:52:48,280 --> 00:52:53,500
part<font color="#E5E5E5"> of the business environment so not</font>

1304
00:52:52,150 --> 00:52:55,810
specifically being called in because

1305
00:52:53,500 --> 00:52:58,030
ASAP system has<font color="#E5E5E5"> been owned and they know</font>

1306
00:52:55,810 --> 00:53:02,710
<font color="#CCCCCC">sepsis has</font><font color="#E5E5E5"> been owned a lot of the time</font>

1307
00:52:58,030 --> 00:53:05,560
unless they've absolutely invested a lot

1308
00:53:02,710 --> 00:53:08,109
of<font color="#CCCCCC"> money and time in figuring out how</font>

1309
00:53:05,560 --> 00:53:09,700
their<font color="#E5E5E5"> SAP system works so</font><font color="#CCCCCC"> let's say as</font>

1310
00:53:08,109 --> 00:53:12,369
an example a financial system that does

1311
00:53:09,700 --> 00:53:13,660
HR<font color="#E5E5E5"> and payroll it's if someone's</font>

1312
00:53:12,369 --> 00:53:15,760
breaking into<font color="#CCCCCC"> it</font><font color="#E5E5E5"> looking to profit</font>

1313
00:53:13,660 --> 00:53:17,259
financially they're not looking to make

1314
00:53:15,760 --> 00:53:18,700
a lot<font color="#CCCCCC"> of noise and bring it down or</font>

1315
00:53:17,260 --> 00:53:20,619
<font color="#CCCCCC">anything like that they want to be quite</font>

1316
00:53:18,700 --> 00:53:24,970
sly about it's not it's<font color="#E5E5E5"> not usually data</font>

1317
00:53:20,619 --> 00:53:28,030
stealing<font color="#E5E5E5"> it's fraud how can I add an</font>

1318
00:53:24,970 --> 00:53:30,819
extra employee how can<font color="#E5E5E5"> I add an extra</font>

1319
00:53:28,030 --> 00:53:34,180
order into the chain a supplier etc lat

1320
00:53:30,820 --> 00:53:37,960
so it's going to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> a financial type of</font>

1321
00:53:34,180 --> 00:53:40,750
investigation first before a technical

1322
00:53:37,960 --> 00:53:42,339
investigation into how they broke in so

1323
00:53:40,750 --> 00:53:45,369
now I'm not done incident response on

1324
00:53:42,339 --> 00:53:47,560
<font color="#CCCCCC">sap systems but those sap systems that</font>

1325
00:53:45,369 --> 00:53:49,710
have been compromised have usually been

1326
00:53:47,560 --> 00:53:55,089
done in a very targeted<font color="#E5E5E5"> specific and</font>

1327
00:53:49,710 --> 00:53:57,130
sophisticated way but<font color="#CCCCCC"> I have seen an</font>

1328
00:53:55,089 --> 00:53:58,750
example of saying when you buy this

1329
00:53:57,130 --> 00:54:00,400
stuff you can buy it you can have it

1330
00:53:58,750 --> 00:54:02,470
hosted you can get these intelligent

1331
00:54:00,400 --> 00:54:04,089
well qualified people apparently they

1332
00:54:02,470 --> 00:54:06,578
come in and set it up<font color="#E5E5E5"> for you but they</font>

1333
00:54:04,089 --> 00:54:09,160
set it up in a way<font color="#CCCCCC"> so it works not that</font>

1334
00:54:06,579 --> 00:54:10,420
it's secure and then like a lot of

1335
00:54:09,160 --> 00:54:12,848
consultancy obviously not security

1336
00:54:10,420 --> 00:54:14,410
consultancy but other consultancies may

1337
00:54:12,849 --> 00:54:16,630
well send some very clever guys at<font color="#CCCCCC"> the</font>

1338
00:54:14,410 --> 00:54:18,640
<font color="#E5E5E5">beginning then they start to send grads</font>

1339
00:54:16,630 --> 00:54:21,220
and people that maybe not so clever and

1340
00:54:18,640 --> 00:54:25,049
they do stupid things I've seen examples

1341
00:54:21,220 --> 00:54:27,970
of someone actually<font color="#CCCCCC"> migrated</font><font color="#E5E5E5"> data from a</font>

1342
00:54:25,050 --> 00:54:31,390
one specific module into another module

1343
00:54:27,970 --> 00:54:32,680
which never the twain overwrite in one

1344
00:54:31,390 --> 00:54:35,589
set a date with<font color="#CCCCCC"> another set</font><font color="#E5E5E5"> of data</font>

1345
00:54:32,680 --> 00:54:37,750
which led to lots of financial problems

1346
00:54:35,589 --> 00:54:39,520
etc and<font color="#CCCCCC"> you imagine however</font><font color="#E5E5E5"> one of the</font>

1347
00:54:37,750 --> 00:54:41,680
unexpected events that came out<font color="#CCCCCC"> of it</font>

1348
00:54:39,520 --> 00:54:42,190
was all of the employees that they

1349
00:54:41,680 --> 00:54:45,850
<font color="#E5E5E5">couldn't</font>

1350
00:54:42,190 --> 00:54:48,040
cause out the car park because client

1351
00:54:45,850 --> 00:54:50,890
<font color="#E5E5E5">date and overwritten hate joy data and</font>

1352
00:54:48,040 --> 00:54:52,540
that day it was exported to another

1353
00:54:50,890 --> 00:54:53,770
system<font color="#E5E5E5"> that looks after the car park and</font>

1354
00:54:52,540 --> 00:54:55,660
made sure that employees going in out

1355
00:54:53,770 --> 00:54:58,000
were actually employed there but now

1356
00:54:55,660 --> 00:54:59,379
they weren't they were<font color="#E5E5E5"> claims so we had</font>

1357
00:54:58,000 --> 00:55:03,340
hundreds of thousands of staff that

1358
00:54:59,380 --> 00:55:07,020
couldn't get there cause there's lots of

1359
00:55:03,340 --> 00:55:09,520
crazy things that happened anything else

1360
00:55:07,020 --> 00:55:13,030
the code is going to be available<font color="#E5E5E5"> on the</font>

1361
00:55:09,520 --> 00:55:15,700
website today tomorrow sometime forever

1362
00:55:13,030 --> 00:55:18,190
on to play with one<font color="#E5E5E5"> last question have</font>

1363
00:55:15,700 --> 00:55:20,410
you noticed if there's an internal<font color="#CCCCCC"> audit</font>

1364
00:55:18,190 --> 00:55:22,660
log is it shown of different if<font color="#E5E5E5"> you</font>

1365
00:55:20,410 --> 00:55:23,890
access the different modules<font color="#CCCCCC"> through the</font>

1366
00:55:22,660 --> 00:55:25,839
different ways so<font color="#E5E5E5"> instead of going</font>

1367
00:55:23,890 --> 00:55:27,460
through the actual clients there's lots

1368
00:55:25,840 --> 00:55:29,500
and lots of audit log data that can be

1369
00:55:27,460 --> 00:55:32,320
<font color="#CCCCCC">configured can be set up and what I</font>

1370
00:55:29,500 --> 00:55:35,500
don't pretend<font color="#E5E5E5"> to be is comprehensively</font>

1371
00:55:32,320 --> 00:55:37,690
understanding<font color="#E5E5E5"> a how you would configure</font>

1372
00:55:35,500 --> 00:55:40,330
a safe environment to catch all<font color="#E5E5E5"> the</font>

1373
00:55:37,690 --> 00:55:42,010
right data in the right places and there

1374
00:55:40,330 --> 00:55:43,509
are guys that specialize in going in and

1375
00:55:42,010 --> 00:55:45,850
making sure<font color="#CCCCCC"> sap system is configured</font>

1376
00:55:43,510 --> 00:55:48,490
completely to comply to various

1377
00:55:45,850 --> 00:55:52,270
different and mandates or veins oxley

1378
00:55:48,490 --> 00:55:54,279
<font color="#E5E5E5">PCI etc etc I never gone interrogated</font>

1379
00:55:52,270 --> 00:55:57,280
those logs what I've gone in as is can I

1380
00:55:54,280 --> 00:55:59,170
break into<font color="#E5E5E5"> this system and the advice I</font>

1381
00:55:57,280 --> 00:56:01,210
can give people about once I've broken

1382
00:55:59,170 --> 00:56:02,890
in how I broke the name is purely based

1383
00:56:01,210 --> 00:56:04,410
on my IT security technical background

1384
00:56:02,890 --> 00:56:06,580
rather than pointing them SAT notes

1385
00:56:04,410 --> 00:56:08,950
unless I've been told there's a setting

1386
00:56:06,580 --> 00:56:11,610
up my<font color="#CCCCCC"> report will say csat not foo I've</font>

1387
00:56:08,950 --> 00:56:20,169
no idea what it<font color="#CCCCCC"> says my advice is this</font>

1388
00:56:11,610 --> 00:56:22,570
get on with it kind of related are there

1389
00:56:20,170 --> 00:56:27,040
any interesting physical logs on so

1390
00:56:22,570 --> 00:56:29,170
client side with<font color="#CCCCCC"> some</font><font color="#E5E5E5"> physical access to</font>

1391
00:56:27,040 --> 00:56:33,570
someone's laptop give you<font color="#CCCCCC"> an and</font>

1392
00:56:29,170 --> 00:56:36,250
typically these<font color="#CCCCCC"> sap environments aren't</font>

1393
00:56:33,570 --> 00:56:38,950
the security teams and the IT teams

1394
00:56:36,250 --> 00:56:40,330
usually<font color="#E5E5E5"> told to stay away you spent</font>

1395
00:56:38,950 --> 00:56:42,069
hundreds of thousands<font color="#CCCCCC"> and millions</font><font color="#E5E5E5"> of</font>

1396
00:56:40,330 --> 00:56:44,080
<font color="#E5E5E5">pounds to get these things set up and</font>

1397
00:56:42,070 --> 00:56:46,840
apparently you've paid experts to do it

1398
00:56:44,080 --> 00:56:49,930
they leave them and trust them the guy

1399
00:56:46,840 --> 00:56:52,150
that<font color="#CCCCCC"> overall this data this is the crazy</font>

1400
00:56:49,930 --> 00:56:53,859
thing us for access to<font color="#E5E5E5"> SAP system to</font>

1401
00:56:52,150 --> 00:56:55,000
audit it to have a look<font color="#E5E5E5"> at it and they</font>

1402
00:56:53,860 --> 00:56:55,780
won't give it<font color="#E5E5E5"> to you and you show them</font>

1403
00:56:55,000 --> 00:56:56,980
you know

1404
00:56:55,780 --> 00:56:58,600
I've got all these<font color="#E5E5E5"> qualifications I've</font>

1405
00:56:56,980 --> 00:57:00,250
been doing<font color="#E5E5E5"> this for years you might even</font>

1406
00:56:58,600 --> 00:57:03,069
work for the company blah blah<font color="#CCCCCC"> blah and</font>

1407
00:57:00,250 --> 00:57:06,280
<font color="#E5E5E5">they won't give it you yet they'll give</font>

1408
00:57:03,070 --> 00:57:08,200
some grad that's working<font color="#CCCCCC"> for an external</font>

1409
00:57:06,280 --> 00:57:10,180
consultancy that<font color="#E5E5E5"> you don't even know you</font>

1410
00:57:08,200 --> 00:57:12,220
know his surname full access to the

1411
00:57:10,180 --> 00:57:13,330
environment to migrate data from you

1412
00:57:12,220 --> 00:57:14,290
know one production environment to

1413
00:57:13,330 --> 00:57:15,610
another production environment these

1414
00:57:14,290 --> 00:57:17,470
<font color="#E5E5E5">systems look after the core of their</font>

1415
00:57:15,610 --> 00:57:20,530
business yet they won't trust<font color="#E5E5E5"> their IT</font>

1416
00:57:17,470 --> 00:57:22,959
security team to<font color="#CCCCCC"> get access</font><font color="#E5E5E5"> to it so</font>

1417
00:57:20,530 --> 00:57:25,390
they have got no oversight what loves

1418
00:57:22,960 --> 00:57:26,950
are available or the ability to

1419
00:57:25,390 --> 00:57:28,299
implement any of these security controls

1420
00:57:26,950 --> 00:57:32,290
at least in my experience from what I've

1421
00:57:28,300 --> 00:57:33,610
seen and in<font color="#E5E5E5"> 11 provider that I actually</font>

1422
00:57:32,290 --> 00:57:34,779
spoke<font color="#CCCCCC"> to and started making</font>

1423
00:57:33,610 --> 00:57:36,550
recommendations about how they should<font color="#E5E5E5"> do</font>

1424
00:57:34,780 --> 00:57:37,810
this<font color="#CCCCCC"> and acted I'm really glad you came</font>

1425
00:57:36,550 --> 00:57:39,310
<font color="#E5E5E5">along and found all this stuff for us</font>

1426
00:57:37,810 --> 00:57:46,570
because now we can package it up and

1427
00:57:39,310 --> 00:57:53,400
sell it to our clients as a service got

1428
00:57:46,570 --> 00:57:53,400
it anyone<font color="#E5E5E5"> else</font><font color="#CCCCCC"> okay thanks very much</font>

