1
00:00:02,340 --> 00:00:09,389
so what<font color="#E5E5E5"> are we</font><font color="#CCCCCC"> going to do in the next</font>

2
00:00:05,680 --> 00:00:12,250
<font color="#E5E5E5">50 minutes let me go over</font><font color="#CCCCCC"> a quick agenda</font>

3
00:00:09,389 --> 00:00:15,190
what we'll do is we'll go or some of the

4
00:00:12,250 --> 00:00:18,670
<font color="#CCCCCC">SCADA basics and the reason for that is</font>

5
00:00:15,190 --> 00:00:21,789
there is some confusion in<font color="#E5E5E5"> the SCADA</font>

6
00:00:18,670 --> 00:00:25,000
world about what SCADA systems are what

7
00:00:21,789 --> 00:00:27,160
this person may think scada is would not

8
00:00:25,000 --> 00:00:29,289
be the<font color="#CCCCCC"> same as some other person would</font>

9
00:00:27,160 --> 00:00:32,500
think<font color="#E5E5E5"> about it so we'll go over some</font>

10
00:00:29,289 --> 00:00:34,800
SCADA basics we will look at some<font color="#E5E5E5"> of the</font>

11
00:00:32,500 --> 00:00:37,780
threats that affect scalar security

12
00:00:34,800 --> 00:00:40,328
where are the threats coming from where

13
00:00:37,780 --> 00:00:44,020
are the vulnerabilities why do they

14
00:00:40,329 --> 00:00:46,030
exist and how can<font color="#CCCCCC"> we protect against</font>

15
00:00:44,020 --> 00:00:48,520
them<font color="#CCCCCC"> so we'll look</font><font color="#E5E5E5"> at a little bit of</font>

16
00:00:46,030 --> 00:00:53,050
<font color="#CCCCCC">that we'll</font><font color="#E5E5E5"> look at some of the</font>

17
00:00:48,520 --> 00:00:55,750
challenges to securing SCADA systems and

18
00:00:53,050 --> 00:00:58,180
finally look at some of<font color="#E5E5E5"> the</font>

19
00:00:55,750 --> 00:01:02,140
recommendations or proposals that that

20
00:00:58,180 --> 00:01:05,649
we have oh and last but not least I'll

21
00:01:02,140 --> 00:01:08,880
introduce updated version<font color="#E5E5E5"> of a new open</font>

22
00:01:05,649 --> 00:01:14,979
source tool that we are just<font color="#E5E5E5"> releasing</font>

23
00:01:08,880 --> 00:01:17,439
with its<font color="#CCCCCC"> k-dub so I started working</font><font color="#E5E5E5"> on</font>

24
00:01:14,979 --> 00:01:22,450
<font color="#E5E5E5">SCADA systems about five to six years</font>

25
00:01:17,439 --> 00:01:25,960
<font color="#CCCCCC">ago this was a time when Stuxnet didn't</font>

26
00:01:22,450 --> 00:01:29,590
exist by the way how many<font color="#E5E5E5"> of you know</font>

27
00:01:25,960 --> 00:01:32,020
what Stuxnet is<font color="#CCCCCC"> okay almost all good so</font>

28
00:01:29,590 --> 00:01:34,180
I<font color="#CCCCCC"> don't have</font><font color="#E5E5E5"> to go into details of</font>

29
00:01:32,020 --> 00:01:37,270
Stuxnet<font color="#E5E5E5"> 44 for those of you don't</font>

30
00:01:34,180 --> 00:01:41,049
Stuxnet was a virus which of which

31
00:01:37,270 --> 00:01:43,720
basically targeted Siemens PLC's or

32
00:01:41,049 --> 00:01:47,380
Simmons hardware that was used in a

33
00:01:43,720 --> 00:01:49,570
specific nuclear power plant so I

34
00:01:47,380 --> 00:01:52,329
started this all started about five to

35
00:01:49,570 --> 00:01:55,600
six years<font color="#CCCCCC"> ago when my boss come came to</font>

36
00:01:52,329 --> 00:01:58,270
my cube and asked me that hey a mole do

37
00:01:55,600 --> 00:02:01,960
we have signatures to identify

38
00:01:58,270 --> 00:02:03,520
vulnerabilities in scalar systems now to

39
00:02:01,960 --> 00:02:06,429
give you a<font color="#E5E5E5"> little bit of a background</font>

40
00:02:03,520 --> 00:02:09,000
what my team does is we create

41
00:02:06,430 --> 00:02:10,979
signatures to identify

42
00:02:09,000 --> 00:02:13,860
the signatures which go into<font color="#E5E5E5"> our</font>

43
00:02:10,979 --> 00:02:16,680
vulnerability scanner and they identify

44
00:02:13,860 --> 00:02:20,690
vulnerabilities possible threads missing

45
00:02:16,680 --> 00:02:24,570
patches any sort of weakness in our

46
00:02:20,690 --> 00:02:27,060
customers network so at that<font color="#CCCCCC"> time I said</font>

47
00:02:24,570 --> 00:02:30,209
I knew what SCADA systems a war but was

48
00:02:27,060 --> 00:02:32,970
in no position to start writing security

49
00:02:30,209 --> 00:02:35,070
signatures for those so I said well let

50
00:02:32,970 --> 00:02:38,070
me investigate I<font color="#E5E5E5"> know what SCADA systems</font>

51
00:02:35,070 --> 00:02:40,049
are and i'll get<font color="#CCCCCC"> back to you so as</font><font color="#E5E5E5"> i</font>

52
00:02:38,070 --> 00:02:42,170
started<font color="#CCCCCC"> talking with people in the</font>

53
00:02:40,050 --> 00:02:44,850
<font color="#CCCCCC">industry some of our customers who had</font>

54
00:02:42,170 --> 00:02:47,790
industrial control systems distributed

55
00:02:44,850 --> 00:02:50,850
customer systems<font color="#CCCCCC"> i found</font><font color="#E5E5E5"> that there is a</font>

56
00:02:47,790 --> 00:02:53,760
lot of discrepancy in what scada is

57
00:02:50,850 --> 00:02:56,040
actually so some people call their

58
00:02:53,760 --> 00:02:57,660
system at SCADA systems some people said

59
00:02:56,040 --> 00:02:59,730
no no no these are not scalar system

60
00:02:57,660 --> 00:03:01,380
these are purely industrial control

61
00:02:59,730 --> 00:03:04,320
systems or these are distributed control

62
00:03:01,380 --> 00:03:07,890
systems and there are some differences

63
00:03:04,320 --> 00:03:10,859
<font color="#E5E5E5">between each of these but for this talk</font>

64
00:03:07,890 --> 00:03:13,920
i'll be using the term scale are pretty

65
00:03:10,860 --> 00:03:16,950
interchangeably and<font color="#CCCCCC"> use SCADA for dcs or</font>

66
00:03:13,920 --> 00:03:19,559
ICS so let<font color="#CCCCCC"> me</font><font color="#E5E5E5"> ask you a question what</font>

67
00:03:16,950 --> 00:03:24,859
type of what are the systems that come

68
00:03:19,560 --> 00:03:24,860
to your mind when<font color="#CCCCCC"> i say this word scalar</font>

69
00:03:24,950 --> 00:03:35,880
plcs<font color="#E5E5E5"> okay that's good industrial control</font>

70
00:03:30,320 --> 00:03:38,760
any any else<font color="#CCCCCC"> manufacturing yeah so these</font>

71
00:03:35,880 --> 00:03:42,209
<font color="#E5E5E5">are the systems that came to my mind</font>

72
00:03:38,760 --> 00:03:48,440
like that five or six years<font color="#CCCCCC"> ago power</font>

73
00:03:42,209 --> 00:03:52,079
plants<font color="#E5E5E5"> oil or gas transmission lines</font>

74
00:03:48,440 --> 00:03:55,680
wind turbines power generation and these

75
00:03:52,079 --> 00:03:58,019
are all<font color="#E5E5E5"> good examples of SCADA systems</font>

76
00:03:55,680 --> 00:04:00,720
the top three the rule of thumb that I

77
00:03:58,019 --> 00:04:03,209
used was that if<font color="#E5E5E5"> you sort of</font><font color="#CCCCCC"> tried</font><font color="#E5E5E5"> to</font>

78
00:04:00,720 --> 00:04:05,760
<font color="#E5E5E5">grab a SCADA system or hug a SCADA</font>

79
00:04:03,209 --> 00:04:07,829
system and you end up grabbing half of

80
00:04:05,760 --> 00:04:09,510
the country or possibly half of the

81
00:04:07,829 --> 00:04:11,760
continent then yeah that's a good

82
00:04:09,510 --> 00:04:15,420
possibility<font color="#E5E5E5"> that it's a scalar system</font>

83
00:04:11,760 --> 00:04:17,668
the<font color="#E5E5E5"> systems at the bottom are basically</font>

84
00:04:15,420 --> 00:04:20,370
what we just talked about industrial

85
00:04:17,668 --> 00:04:21,669
control systems which include<font color="#E5E5E5"> food</font>

86
00:04:20,370 --> 00:04:23,470
manufacturing

87
00:04:21,670 --> 00:04:25,990
automobile manufacturing and so on<font color="#E5E5E5"> and</font>

88
00:04:23,470 --> 00:04:28,360
so forth so these systems are pretty

89
00:04:25,990 --> 00:04:31,150
huge but usually they are confined<font color="#CCCCCC"> to</font>

90
00:04:28,360 --> 00:04:33,760
one physical plant or probably multiple

91
00:04:31,150 --> 00:04:36,849
plants but they are not as distributed

92
00:04:33,760 --> 00:04:39,610
at<font color="#E5E5E5"> SCADA but for our purpose as I</font>

93
00:04:36,850 --> 00:04:42,760
mentioned we will use these two terms

94
00:04:39,610 --> 00:04:45,940
interchangeably so as I was<font color="#E5E5E5"> thinking</font>

95
00:04:42,760 --> 00:04:47,590
about<font color="#CCCCCC"> SCADA systems I I wanted</font><font color="#E5E5E5"> to find</font>

96
00:04:45,940 --> 00:04:50,170
out why this origin need to add

97
00:04:47,590 --> 00:04:52,210
signatures because remember<font color="#E5E5E5"> at that time</font>

98
00:04:50,170 --> 00:04:55,360
there was no structure netscaler system

99
00:04:52,210 --> 00:04:58,030
was not<font color="#E5E5E5"> really in the</font><font color="#CCCCCC"> limelight as it is</font>

100
00:04:55,360 --> 00:05:00,790
today so I I was doing some

101
00:04:58,030 --> 00:05:03,549
investigation on accidents and there had

102
00:05:00,790 --> 00:05:06,850
been a couple of accidents as when it

103
00:05:03,550 --> 00:05:09,610
comes to SCADA systems and some of the

104
00:05:06,850 --> 00:05:13,510
examples that<font color="#E5E5E5"> I have here are root cause</font>

105
00:05:09,610 --> 00:05:16,990
analysis of liquid pipeline failures by

106
00:05:13,510 --> 00:05:21,490
by<font color="#E5E5E5"> the US government power failures by</font>

107
00:05:16,990 --> 00:05:23,470
newark and these basically go into a lot

108
00:05:21,490 --> 00:05:26,500
of<font color="#E5E5E5"> detail on what happened if it was an</font>

109
00:05:23,470 --> 00:05:29,260
operator error if it was a knowledge

110
00:05:26,500 --> 00:05:31,450
malfunctioning of an equipment or most

111
00:05:29,260 --> 00:05:33,490
probably both of them maybe the operator

112
00:05:31,450 --> 00:05:36,190
panicked and in dry out correctly so on

113
00:05:33,490 --> 00:05:39,400
and so forth so<font color="#CCCCCC"> I said</font><font color="#E5E5E5"> look you find</font>

114
00:05:36,190 --> 00:05:43,270
there have been a lot of accidents in

115
00:05:39,400 --> 00:05:45,010
the scalar systems and by<font color="#E5E5E5"> the way i'll</font>

116
00:05:43,270 --> 00:05:47,349
give you<font color="#CCCCCC"> my twitter handle where you</font>

117
00:05:45,010 --> 00:05:49,830
could download this presentation so you

118
00:05:47,350 --> 00:05:52,330
don't have to write<font color="#CCCCCC"> down all these links</font>

119
00:05:49,830 --> 00:05:54,940
there have<font color="#CCCCCC"> been cases of vandalism</font>

120
00:05:52,330 --> 00:05:57,370
against SCADA systems and the<font color="#E5E5E5"> example</font>

121
00:05:54,940 --> 00:05:59,620
here<font color="#E5E5E5"> I have in something close to where</font>

122
00:05:57,370 --> 00:06:03,700
I<font color="#CCCCCC"> am where I'm based from is in Portland</font>

123
00:05:59,620 --> 00:06:06,640
where some vandals they just they just

124
00:06:03,700 --> 00:06:09,520
destroyed some rubber gaskets on on

125
00:06:06,640 --> 00:06:11,169
electric supply line then really knew

126
00:06:09,520 --> 00:06:13,359
what they were doing they were just

127
00:06:11,170 --> 00:06:15,580
vandals they said<font color="#CCCCCC"> okay let's let's try</font>

128
00:06:13,360 --> 00:06:18,010
to destroy this I really don't know how

129
00:06:15,580 --> 00:06:20,440
they managed to<font color="#E5E5E5"> do it but they did it it</font>

130
00:06:18,010 --> 00:06:22,599
didn't cause a massive power disruption

131
00:06:20,440 --> 00:06:24,520
or anything but the company still had to

132
00:06:22,600 --> 00:06:26,650
the electrical company still had to go

133
00:06:24,520 --> 00:06:29,680
in and replace those rubber gaskets

134
00:06:26,650 --> 00:06:32,049
we're out power temporarily<font color="#CCCCCC"> by power</font>

135
00:06:29,680 --> 00:06:34,169
<font color="#E5E5E5">from other companies so basically caused</font>

136
00:06:32,050 --> 00:06:36,120
them

137
00:06:34,169 --> 00:06:38,310
a lot<font color="#CCCCCC"> of money so</font><font color="#E5E5E5"> as I'll okay when it</font>

138
00:06:36,120 --> 00:06:40,409
comes if some if someone is losing money

139
00:06:38,310 --> 00:06:43,349
<font color="#E5E5E5">that's a good enough reason to secure</font>

140
00:06:40,409 --> 00:06:45,599
those resources there have been<font color="#CCCCCC"> a lot of</font>

141
00:06:43,349 --> 00:06:47,490
insider threats when it comes to scalar

142
00:06:45,599 --> 00:06:50,990
security and the example<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I have I</font>

143
00:06:47,490 --> 00:06:55,199
have here is a very famous one from

144
00:06:50,990 --> 00:06:57,840
Australia what happened was an<font color="#E5E5E5"> incidence</font>

145
00:06:55,199 --> 00:06:59,340
where a person working at a water

146
00:06:57,840 --> 00:07:03,388
treatment plant or a waste treatment

147
00:06:59,340 --> 00:07:05,938
plant got fired<font color="#E5E5E5"> and the very</font><font color="#CCCCCC"> next day</font>

148
00:07:03,389 --> 00:07:07,860
what he does is because he had a lot of

149
00:07:05,939 --> 00:07:10,349
the blueprint of<font color="#CCCCCC"> the plant he knew how</font>

150
00:07:07,860 --> 00:07:14,610
the system works even after<font color="#CCCCCC"> being</font><font color="#E5E5E5"> fired</font>

151
00:07:10,349 --> 00:07:16,589
even after not having access to those

152
00:07:14,610 --> 00:07:20,699
systems he had enough information that

153
00:07:16,589 --> 00:07:24,419
he basically<font color="#E5E5E5"> drained all the all the bad</font>

154
00:07:20,699 --> 00:07:27,060
water into the rivers and flooded some

155
00:07:24,419 --> 00:07:30,810
of the parks caused a big embarrassment

156
00:07:27,060 --> 00:07:32,909
to the waste treatment company and

157
00:07:30,810 --> 00:07:35,699
generally to the country as well when

158
00:07:32,909 --> 00:07:39,479
such type of<font color="#E5E5E5"> things happen but what a</font>

159
00:07:35,699 --> 00:07:41,729
fail<font color="#E5E5E5"> to realize at that time was that</font>

160
00:07:39,479 --> 00:07:44,729
<font color="#CCCCCC">the real the real threats to SCADA</font>

161
00:07:41,729 --> 00:07:47,669
systems which what we are looking at

162
00:07:44,729 --> 00:07:51,479
today or what people are calling as a

163
00:07:47,669 --> 00:07:53,490
apt people<font color="#E5E5E5"> how many of you have look</font>

164
00:07:51,479 --> 00:07:55,680
pretty familiar<font color="#CCCCCC"> with the</font><font color="#E5E5E5"> APD term</font>

165
00:07:53,490 --> 00:07:59,159
advanced persistent threat so we have

166
00:07:55,680 --> 00:08:01,110
some of them are some in advanced

167
00:07:59,159 --> 00:08:03,539
<font color="#E5E5E5">persistent threat what basically happens</font>

168
00:08:01,110 --> 00:08:06,990
is the reason it's advanced is because

169
00:08:03,539 --> 00:08:10,050
it uses<font color="#CCCCCC"> zero-day everyone knows what are</font>

170
00:08:06,990 --> 00:08:12,659
the<font color="#E5E5E5"> zero days 0 days a vulnerability</font>

171
00:08:10,050 --> 00:08:14,189
which does not have a patch even the

172
00:08:12,659 --> 00:08:16,409
vendor may not know<font color="#CCCCCC"> that it's a</font>

173
00:08:14,189 --> 00:08:19,139
vulnerability it's just a security

174
00:08:16,409 --> 00:08:21,120
researcher or a hacker a bad guy or why

175
00:08:19,139 --> 00:08:23,270
or a white hat has found this

176
00:08:21,120 --> 00:08:25,499
vulnerability and no one knows about it

177
00:08:23,270 --> 00:08:28,318
that's why it's called<font color="#E5E5E5"> advanced it's</font>

178
00:08:25,499 --> 00:08:30,899
called it's<font color="#E5E5E5"> usually easier targeted</font>

179
00:08:28,319 --> 00:08:34,279
attack so<font color="#E5E5E5"> it it's not an generic worm</font>

180
00:08:30,899 --> 00:08:37,669
that tries to<font color="#CCCCCC"> grab passwords or steal</font>

181
00:08:34,279 --> 00:08:40,559
credit<font color="#CCCCCC"> card information it is almost</font>

182
00:08:37,669 --> 00:08:43,978
targeted as at you or at your company

183
00:08:40,559 --> 00:08:45,089
because<font color="#E5E5E5"> you are of some importance to</font>

184
00:08:43,979 --> 00:08:49,439
the attacker

185
00:08:45,089 --> 00:08:52,579
and lastly it<font color="#CCCCCC"> is usually backed by some</font>

186
00:08:49,439 --> 00:08:55,319
sort<font color="#E5E5E5"> of a state or a bigger agency</font>

187
00:08:52,579 --> 00:08:57,420
country or<font color="#E5E5E5"> something like that which has</font>

188
00:08:55,319 --> 00:08:59,490
unlimited resources so it's not

189
00:08:57,420 --> 00:09:01,469
basically done by script kiddies or

190
00:08:59,490 --> 00:09:03,839
people trying<font color="#E5E5E5"> to steal money or things</font>

191
00:09:01,470 --> 00:09:06,600
like that so Stuxnet the virus<font color="#E5E5E5"> that I</font>

192
00:09:03,839 --> 00:09:08,639
talked about it it falls and actually

193
00:09:06,600 --> 00:09:13,529
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was the virus which coined this</font>

194
00:09:08,639 --> 00:09:15,420
term apt it falls it sort of matches all

195
00:09:13,529 --> 00:09:18,559
the criteria<font color="#CCCCCC"> zyzz it was advanced it</font>

196
00:09:15,420 --> 00:09:21,089
used a zero-day vulnerability it was

197
00:09:18,559 --> 00:09:24,629
targeted to a particular nuclear power

198
00:09:21,089 --> 00:09:27,449
plant and it had some in some states

199
00:09:24,629 --> 00:09:29,999
sponsoring behind it if the creators of

200
00:09:27,449 --> 00:09:32,550
those<font color="#E5E5E5"> wires had unlimited sort of</font>

201
00:09:29,999 --> 00:09:35,399
resources<font color="#E5E5E5"> and the link that i have here</font>

202
00:09:32,550 --> 00:09:39,839
is not actually a for Stuxnet it's for

203
00:09:35,399 --> 00:09:42,329
the worm in Dooku how many of<font color="#E5E5E5"> you have</font>

204
00:09:39,839 --> 00:09:44,160
the worm Dooku so we have people who

205
00:09:42,329 --> 00:09:48,180
have heard Stuxnet also have heard about

206
00:09:44,160 --> 00:09:50,420
Dooku this was a worm that<font color="#E5E5E5"> came after</font>

207
00:09:48,180 --> 00:09:52,679
Stuxnet and it didn't do anything

208
00:09:50,420 --> 00:09:54,899
malicious but it's just collected

209
00:09:52,679 --> 00:09:58,499
information and the link that<font color="#E5E5E5"> i have</font>

210
00:09:54,899 --> 00:10:00,749
here is from<font color="#E5E5E5"> Symantec they did a very</font>

211
00:09:58,499 --> 00:10:04,079
nice static reverse engineering analysis

212
00:10:00,749 --> 00:10:05,639
on the worm and concluded that from the

213
00:10:04,079 --> 00:10:08,579
pad and from the<font color="#CCCCCC"> code pad and it's</font>

214
00:10:05,639 --> 00:10:10,709
almost they are at least hundred percent

215
00:10:08,579 --> 00:10:12,420
<font color="#CCCCCC">sure that people who wrote Stuxnet also</font>

216
00:10:10,709 --> 00:10:14,969
wrote Dooku because of the way it was

217
00:10:12,420 --> 00:10:17,550
written and it didn't do anything harm

218
00:10:14,970 --> 00:10:19,860
but it just collected information so we

219
00:10:17,550 --> 00:10:22,859
still don't know what what would happen

220
00:10:19,860 --> 00:10:26,339
with the information<font color="#E5E5E5"> that it collects so</font>

221
00:10:22,860 --> 00:10:29,429
we were like<font color="#E5E5E5"> okay this we need to</font><font color="#CCCCCC"> write</font>

222
00:10:26,339 --> 00:10:32,249
signatures for these what we usually do

223
00:10:29,429 --> 00:10:34,889
when we have such a task is if we have

224
00:10:32,249 --> 00:10:37,160
to write<font color="#E5E5E5"> a signature for a new database</font>

225
00:10:34,889 --> 00:10:40,470
or a new operating system or a new

226
00:10:37,160 --> 00:10:42,269
framework we usually get that device or

227
00:10:40,470 --> 00:10:45,800
the database or that operating system in

228
00:10:42,269 --> 00:10:48,779
our lab bank on it till it breaks and

229
00:10:45,800 --> 00:10:51,209
basically create signatures if there<font color="#E5E5E5"> are</font>

230
00:10:48,779 --> 00:10:52,410
existing vulnerabilities it's even

231
00:10:51,209 --> 00:10:53,939
simpler we don't have to

232
00:10:52,410 --> 00:10:56,040
new vulnerabilities we just add a

233
00:10:53,940 --> 00:10:58,800
<font color="#E5E5E5">signature for one of those existing</font>

234
00:10:56,040 --> 00:11:00,360
vulnerabilities but from<font color="#E5E5E5"> the pictures</font>

235
00:10:58,800 --> 00:11:03,180
<font color="#CCCCCC">that you saw earlier it was almost</font>

236
00:11:00,360 --> 00:11:06,120
impossible to get<font color="#E5E5E5"> any kind</font><font color="#CCCCCC"> of SCADA</font>

237
00:11:03,180 --> 00:11:08,040
system in our lab or to get our hands on

238
00:11:06,120 --> 00:11:11,250
<font color="#E5E5E5">to electrical power systems and things</font>

239
00:11:08,040 --> 00:11:15,629
like that<font color="#E5E5E5"> so what we did was we created</font>

240
00:11:11,250 --> 00:11:18,300
a sort of framework so that our

241
00:11:15,629 --> 00:11:22,379
engineers could understand better what

242
00:11:18,300 --> 00:11:24,060
means systems are and can write a one-er

243
00:11:22,379 --> 00:11:27,180
ability checks for signatures for that

244
00:11:24,060 --> 00:11:31,258
and that system looked something like

245
00:11:27,180 --> 00:11:34,019
this on<font color="#CCCCCC"> the left-hand side are the</font>

246
00:11:31,259 --> 00:11:39,269
devices which are in the<font color="#E5E5E5"> field so these</font>

247
00:11:34,019 --> 00:11:42,029
could be thousands of miles away from

248
00:11:39,269 --> 00:11:44,220
your main control station and your

249
00:11:42,029 --> 00:11:47,370
control center is on<font color="#E5E5E5"> the right so these</font>

250
00:11:44,220 --> 00:11:50,490
are as you come close to the control

251
00:11:47,370 --> 00:11:53,910
center<font color="#E5E5E5"> these are the devices which are</font>

252
00:11:50,490 --> 00:11:56,220
in<font color="#CCCCCC"> between so let's let's take a little</font>

253
00:11:53,910 --> 00:11:59,600
bit of a closer look at what these

254
00:11:56,220 --> 00:12:03,949
things are so as I<font color="#E5E5E5"> said on the left our</font>

255
00:11:59,600 --> 00:12:07,139
data acquisition devices so these are

256
00:12:03,949 --> 00:12:09,660
basically your sensors your meters your

257
00:12:07,139 --> 00:12:11,819
field devices and what they do<font color="#E5E5E5"> is</font>

258
00:12:09,660 --> 00:12:15,180
usually they collect signals or inputs

259
00:12:11,819 --> 00:12:18,540
like temperature light pressure and some

260
00:12:15,180 --> 00:12:20,339
of the examples here are of the I<font color="#E5E5E5"> think</font>

261
00:12:18,540 --> 00:12:23,279
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a photosensor it senses light</font>

262
00:12:20,339 --> 00:12:25,439
this is I<font color="#E5E5E5"> think of pressure sensor and</font>

263
00:12:23,279 --> 00:12:27,839
it's a temperature sensor so what they

264
00:12:25,439 --> 00:12:30,540
do is basically these devices could be

265
00:12:27,839 --> 00:12:33,269
mounted thousands of miles away on some

266
00:12:30,540 --> 00:12:35,430
electrical pole or some gas pipeline or

267
00:12:33,269 --> 00:12:37,199
somewhere or if<font color="#E5E5E5"> it's industrial control</font>

268
00:12:35,430 --> 00:12:40,258
system it may not be thousands<font color="#E5E5E5"> of miles</font>

269
00:12:37,199 --> 00:12:42,899
of it<font color="#E5E5E5"> could be inside</font><font color="#CCCCCC"> you're inside your</font>

270
00:12:40,259 --> 00:12:45,870
organization inside on some conveyor

271
00:12:42,899 --> 00:12:48,480
belts or things like that<font color="#E5E5E5"> the monitor</font>

272
00:12:45,870 --> 00:12:53,519
for these<font color="#E5E5E5"> parameters and convert them</font>

273
00:12:48,480 --> 00:12:55,199
into discrete or analog signals then

274
00:12:53,519 --> 00:12:57,209
there is<font color="#CCCCCC"> a two-way communication between</font>

275
00:12:55,199 --> 00:13:00,240
this component which is<font color="#E5E5E5"> the data</font>

276
00:12:57,209 --> 00:13:01,680
acquisition component and the data

277
00:13:00,240 --> 00:13:05,610
conversion component

278
00:13:01,680 --> 00:13:09,449
data conversion includes basically<font color="#CCCCCC"> plc's</font>

279
00:13:05,610 --> 00:13:10,800
like the ones<font color="#E5E5E5"> that we saw earlier PLC's</font>

280
00:13:09,450 --> 00:13:14,310
are basically programmable logic

281
00:13:10,800 --> 00:13:17,219
controllers IEDs or intelligent

282
00:13:14,310 --> 00:13:20,310
electronic devices or remote terminal

283
00:13:17,220 --> 00:13:23,310
units and what these components do is

284
00:13:20,310 --> 00:13:27,000
they convert the analog or discrete

285
00:13:23,310 --> 00:13:29,130
measures to digital so the examples here

286
00:13:27,000 --> 00:13:33,089
are is on the extreme light left there

287
00:13:29,130 --> 00:13:36,930
<font color="#CCCCCC">is a PLC there is a IED</font><font color="#E5E5E5"> and here there</font>

288
00:13:33,089 --> 00:13:38,910
is a RT you and to just<font color="#E5E5E5"> give</font><font color="#CCCCCC"> you a sense</font>

289
00:13:36,930 --> 00:13:41,790
of how big these things are I have

290
00:13:38,910 --> 00:13:45,240
included<font color="#CCCCCC"> a picture of a of a man holding</font>

291
00:13:41,790 --> 00:13:48,180
a PLC which is mounted most probably on

292
00:13:45,240 --> 00:13:50,160
a electrical<font color="#E5E5E5"> aren't on some sort of a</font>

293
00:13:48,180 --> 00:13:54,599
pole here I don't know what<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> but</font>

294
00:13:50,160 --> 00:13:56,520
what<font color="#E5E5E5"> they get is a</font><font color="#CCCCCC"> pc PLC so fine what</font>

295
00:13:54,600 --> 00:13:58,020
happens is data is acquired by this

296
00:13:56,520 --> 00:14:00,569
component there is a<font color="#E5E5E5"> two-way</font>

297
00:13:58,020 --> 00:14:01,649
communication to this component which we

298
00:14:00,570 --> 00:14:03,510
are looking at which<font color="#E5E5E5"> is the data</font>

299
00:14:01,649 --> 00:14:06,500
conversion component which converts

300
00:14:03,510 --> 00:14:10,830
these<font color="#E5E5E5"> discrete majors to digital and</font>

301
00:14:06,500 --> 00:14:13,680
then they these measures<font color="#E5E5E5"> is one of the</font>

302
00:14:10,830 --> 00:14:16,890
communication<font color="#E5E5E5"> mechanism to transfer all</font>

303
00:14:13,680 --> 00:14:20,040
that data to the<font color="#E5E5E5"> control center now</font>

304
00:14:16,890 --> 00:14:23,010
communication can be wired<font color="#CCCCCC"> Wireless</font>

305
00:14:20,040 --> 00:14:27,000
using radio any of the communication

306
00:14:23,010 --> 00:14:29,880
<font color="#E5E5E5">mediums and it uses one of the SCADA</font>

307
00:14:27,000 --> 00:14:32,940
protocols that I have<font color="#E5E5E5"> mentioned here it</font>

308
00:14:29,880 --> 00:14:35,310
said that<font color="#E5E5E5"> there are about a hundred</font>

309
00:14:32,940 --> 00:14:37,529
different scada protocols I have not

310
00:14:35,310 --> 00:14:40,319
been<font color="#E5E5E5"> able to count actually all hundred</font>

311
00:14:37,529 --> 00:14:42,540
of them but I can definitely at least

312
00:14:40,320 --> 00:14:43,950
list to design protocols of someone

313
00:14:42,540 --> 00:14:47,490
asked me hey tell me some skater

314
00:14:43,950 --> 00:14:54,260
protocols some famous protocols are

315
00:14:47,490 --> 00:14:57,150
Modbus<font color="#CCCCCC"> iccp dnp3</font><font color="#E5E5E5"> and basically their</font>

316
00:14:54,260 --> 00:15:01,290
their function is to communicate the

317
00:14:57,150 --> 00:15:04,800
data from this component to to the final

318
00:15:01,290 --> 00:15:08,069
<font color="#CCCCCC">component which is</font><font color="#E5E5E5"> the SCADA master this</font>

319
00:15:04,800 --> 00:15:10,560
kada master has components like the HMI

320
00:15:08,070 --> 00:15:12,940
or human machine interface that is the

321
00:15:10,560 --> 00:15:16,329
interface where a human being is

322
00:15:12,940 --> 00:15:18,400
is in front of like a big screen or many

323
00:15:16,330 --> 00:15:21,370
big screens and is continuously

324
00:15:18,400 --> 00:15:24,970
monitoring alerts so in a factory it

325
00:15:21,370 --> 00:15:27,400
could be that some some operator is 24

326
00:15:24,970 --> 00:15:29,380
by 7 and in this station<font color="#E5E5E5"> it's the secure</font>

327
00:15:27,400 --> 00:15:31,569
location and he's like looking for

328
00:15:29,380 --> 00:15:33,580
alerts it's something going wrong and if

329
00:15:31,570 --> 00:15:35,620
something<font color="#E5E5E5"> goes</font><font color="#CCCCCC"> wrong it gets alerted he</font>

330
00:15:33,580 --> 00:15:38,770
can adjust the temperature or pressure

331
00:15:35,620 --> 00:15:43,120
or<font color="#E5E5E5"> the conveyor bit or whatever that is</font>

332
00:15:38,770 --> 00:15:45,100
<font color="#E5E5E5">being monitored it used to look the</font>

333
00:15:43,120 --> 00:15:47,620
scada masters used<font color="#E5E5E5"> to look something</font>

334
00:15:45,100 --> 00:15:50,410
like this<font color="#E5E5E5"> where</font><font color="#CCCCCC"> you have as I mentioned</font>

335
00:15:47,620 --> 00:15:54,400
like some terminals and proprietary type

336
00:15:50,410 --> 00:15:56,860
of system but more<font color="#E5E5E5"> and</font><font color="#CCCCCC"> more it's looking</font>

337
00:15:54,400 --> 00:15:58,780
a little<font color="#E5E5E5"> bit familiar like this or</font>

338
00:15:56,860 --> 00:16:01,510
typical windows-based system and more

339
00:15:58,780 --> 00:16:03,610
more more on that later so these are

340
00:16:01,510 --> 00:16:05,560
basically<font color="#E5E5E5"> this is this what sort of a</font>

341
00:16:03,610 --> 00:16:08,800
framework that<font color="#E5E5E5"> we used everyone</font>

342
00:16:05,560 --> 00:16:11,609
following till now pretty simple data

343
00:16:08,800 --> 00:16:15,240
gets acquired converted communicated and

344
00:16:11,610 --> 00:16:18,430
here controlled by the SCADA master

345
00:16:15,240 --> 00:16:23,820
everyone<font color="#E5E5E5"> okay any questions</font><font color="#CCCCCC"> so far no</font>

346
00:16:18,430 --> 00:16:27,069
all right so where are the threats what

347
00:16:23,820 --> 00:16:31,630
to find out where the threats are what

348
00:16:27,070 --> 00:16:33,250
we did was<font color="#CCCCCC"> we first studied the IO and</font>

349
00:16:31,630 --> 00:16:37,810
the remote component where data gets

350
00:16:33,250 --> 00:16:40,060
acquired and it gets converted most of

351
00:16:37,810 --> 00:16:43,839
the time these threats require physical

352
00:16:40,060 --> 00:16:46,329
access so the<font color="#E5E5E5"> example that we saw the</font>

353
00:16:43,840 --> 00:16:48,370
vandalism example that sort<font color="#E5E5E5"> of falls</font>

354
00:16:46,330 --> 00:16:51,180
here where you require physical access

355
00:16:48,370 --> 00:16:53,980
to the sensor to basically vandalize it

356
00:16:51,180 --> 00:16:58,150
but usually<font color="#CCCCCC"> field equipment doesn't</font>

357
00:16:53,980 --> 00:17:00,430
generally have process knowledge so what

358
00:16:58,150 --> 00:17:04,569
you could get from<font color="#E5E5E5"> the sensor is that</font>

359
00:17:00,430 --> 00:17:07,540
<font color="#CCCCCC">valve 16 is on or break or 9 V is off or</font>

360
00:17:04,569 --> 00:17:10,030
<font color="#E5E5E5">something like that and without process</font>

361
00:17:07,540 --> 00:17:11,770
knowledge it leads to new sensor

362
00:17:10,030 --> 00:17:13,660
disruption so if without<font color="#CCCCCC"> knowing what</font>

363
00:17:11,770 --> 00:17:15,310
the function<font color="#E5E5E5"> of this thing is without</font>

364
00:17:13,660 --> 00:17:17,500
having the blueprint of the system if I

365
00:17:15,310 --> 00:17:19,810
just go and vandalize something it

366
00:17:17,500 --> 00:17:22,890
usually leads to nuisance disruption but

367
00:17:19,810 --> 00:17:25,159
it's not<font color="#E5E5E5"> targeted attack so our</font>

368
00:17:22,890 --> 00:17:30,770
vandalism example is really a perfect

369
00:17:25,160 --> 00:17:33,980
example<font color="#E5E5E5"> of this and at least now we are</font>

370
00:17:30,770 --> 00:17:36,670
not seeing a lot of threats in this area

371
00:17:33,980 --> 00:17:40,790
and if any of you know or have heard

372
00:17:36,670 --> 00:17:43,130
about threats which are which which

373
00:17:40,790 --> 00:17:48,740
affect this<font color="#E5E5E5"> IO component please let me</font>

374
00:17:43,130 --> 00:17:51,700
<font color="#CCCCCC">know so we said okay let's let's focus</font>

375
00:17:48,740 --> 00:17:55,340
our attention more on the communication

376
00:17:51,700 --> 00:17:57,710
component there are<font color="#CCCCCC"> various threads here</font>

377
00:17:55,340 --> 00:18:02,540
one of<font color="#E5E5E5"> the threads is you can manipulate</font>

378
00:17:57,710 --> 00:18:04,940
what gets sent from here and change its

379
00:18:02,540 --> 00:18:10,280
output so that this guy the<font color="#E5E5E5"> SCADA master</font>

380
00:18:04,940 --> 00:18:12,830
things or looks at wrong things you can

381
00:18:10,280 --> 00:18:16,510
change the fep output which<font color="#CCCCCC"> is basically</font>

382
00:18:12,830 --> 00:18:20,000
or HMI input and there are a lot of

383
00:18:16,510 --> 00:18:24,050
protocol threats remember I I mentioned

384
00:18:20,000 --> 00:18:26,810
<font color="#E5E5E5">that there are about 100 or at least few</font>

385
00:18:24,050 --> 00:18:28,909
dozen SCADA protocols so coming<font color="#E5E5E5"> from</font>

386
00:18:26,810 --> 00:18:30,770
computer science background we said okay

387
00:18:28,910 --> 00:18:32,930
this is something<font color="#CCCCCC"> that we kneel with</font>

388
00:18:30,770 --> 00:18:35,480
every day let's look let's<font color="#E5E5E5"> look at more</font>

389
00:18:32,930 --> 00:18:38,480
let's look more at some of the SCADA

390
00:18:35,480 --> 00:18:41,540
protocols that i use in communication so

391
00:18:38,480 --> 00:18:43,450
what we decided was to look at and

392
00:18:41,540 --> 00:18:48,560
that's<font color="#E5E5E5"> what we are going to look at here</font>

393
00:18:43,450 --> 00:18:50,930
first is a protocol called as Modbus how

394
00:18:48,560 --> 00:18:55,370
many of you have<font color="#E5E5E5"> heard of Modbus so well</font>

395
00:18:50,930 --> 00:18:57,650
I see if you feel hands the hands the

396
00:18:55,370 --> 00:19:00,320
number of<font color="#CCCCCC"> people knowing things are it's</font>

397
00:18:57,650 --> 00:19:03,140
like a funnel it's going down but I

398
00:19:00,320 --> 00:19:05,720
<font color="#E5E5E5">think it will go up again so madness is</font>

399
00:19:03,140 --> 00:19:09,650
a very<font color="#E5E5E5"> simple communication protocol if</font>

400
00:19:05,720 --> 00:19:12,110
you know any<font color="#CCCCCC"> of the normal tcp/ip</font>

401
00:19:09,650 --> 00:19:13,600
client-server protocols<font color="#E5E5E5"> telnet FTP or</font>

402
00:19:12,110 --> 00:19:16,490
something like that it's it's

403
00:19:13,600 --> 00:19:19,790
conceptually it did similar what you

404
00:19:16,490 --> 00:19:22,790
have is you have a<font color="#E5E5E5"> client and you have a</font>

405
00:19:19,790 --> 00:19:25,129
server the client sends requests to the

406
00:19:22,790 --> 00:19:27,100
server which is when it when the server

407
00:19:25,130 --> 00:19:30,020
receives it is called as an indication

408
00:19:27,100 --> 00:19:31,820
the server responds to the request and

409
00:19:30,020 --> 00:19:34,190
what you get back is called as

410
00:19:31,820 --> 00:19:37,669
confirmation so very simple clients are

411
00:19:34,190 --> 00:19:38,850
all protocol except except in case of

412
00:19:37,670 --> 00:19:41,910
<font color="#E5E5E5">mod bust</font>

413
00:19:38,850 --> 00:19:44,939
client is called as the master and<font color="#CCCCCC"> the</font>

414
00:19:41,910 --> 00:19:48,120
slave is called as the server so the

415
00:19:44,940 --> 00:19:50,670
client is basically it could be your HMI

416
00:19:48,120 --> 00:19:53,939
system where the operator sits and the

417
00:19:50,670 --> 00:19:55,950
server could be one<font color="#E5E5E5"> of your</font><font color="#CCCCCC"> plc's or</font>

418
00:19:53,940 --> 00:19:59,970
IEDs or something like that where the

419
00:19:55,950 --> 00:20:01,860
client which is the HMI station ask the

420
00:19:59,970 --> 00:20:05,610
server that hey tell me the temperature

421
00:20:01,860 --> 00:20:08,580
on this particular<font color="#E5E5E5"> PLC or tell me the</font>

422
00:20:05,610 --> 00:20:10,199
status of the conveyor belt number 19 or

423
00:20:08,580 --> 00:20:12,030
something<font color="#CCCCCC"> like that and then the server</font>

424
00:20:10,200 --> 00:20:13,970
would basically respond to that so it's

425
00:20:12,030 --> 00:20:16,950
a<font color="#E5E5E5"> pretty simple client-server protocol</font>

426
00:20:13,970 --> 00:20:19,830
we will look at it a little bit in

427
00:20:16,950 --> 00:20:24,660
detail and this is where you would get

428
00:20:19,830 --> 00:20:25,980
to see<font color="#E5E5E5"> some some packet sniff some zeros</font>

429
00:20:24,660 --> 00:20:29,910
and ones and something like<font color="#CCCCCC"> that</font><font color="#E5E5E5"> but</font>

430
00:20:25,980 --> 00:20:32,970
I'll try<font color="#E5E5E5"> to keep it keep it simple so</font>

431
00:20:29,910 --> 00:20:36,710
what modbus has is it has application

432
00:20:32,970 --> 00:20:39,450
data unit frame and program data unit

433
00:20:36,710 --> 00:20:42,510
<font color="#CCCCCC">Marvis is a pretty over protocol</font><font color="#E5E5E5"> it's 30</font>

434
00:20:39,450 --> 00:20:44,130
to 35<font color="#E5E5E5"> years old it was not really when</font>

435
00:20:42,510 --> 00:20:48,270
it came out first was not really

436
00:20:44,130 --> 00:20:51,240
designed to<font color="#E5E5E5"> work on tcp/ip but what has</font>

437
00:20:48,270 --> 00:20:54,020
happened recently recently as in in<font color="#E5E5E5"> the</font>

438
00:20:51,240 --> 00:20:57,930
<font color="#E5E5E5">last 10 to 15 years is it has been</font>

439
00:20:54,020 --> 00:21:01,590
modified to run on<font color="#CCCCCC"> TCP and</font><font color="#E5E5E5"> the way it</font>

440
00:20:57,930 --> 00:21:05,510
once on<font color="#CCCCCC"> TCP is</font><font color="#E5E5E5"> huge basically just slap</font>

441
00:21:01,590 --> 00:21:10,050
your TCP and the IP header to your

442
00:21:05,510 --> 00:21:15,240
Modbus frame put all your<font color="#CCCCCC"> modbus data</font>

443
00:21:10,050 --> 00:21:17,669
into a<font color="#E5E5E5"> TCP packet and send it off so now</font>

444
00:21:15,240 --> 00:21:20,910
Modbus can be compared to<font color="#E5E5E5"> our well-known</font>

445
00:21:17,670 --> 00:21:25,980
protocols like ftp telnet or whatever it

446
00:21:20,910 --> 00:21:28,950
did<font color="#CCCCCC"> just runs on tcp/ip so let's forget</font>

447
00:21:25,980 --> 00:21:31,220
<font color="#CCCCCC">for example all the tcp/ip and those</font>

448
00:21:28,950 --> 00:21:35,040
headers part and let's just<font color="#E5E5E5"> look at</font>

449
00:21:31,220 --> 00:21:37,560
Modbus for what it is what the Modbus

450
00:21:35,040 --> 00:21:39,750
frame consists of is a Modbus header

451
00:21:37,560 --> 00:21:42,090
like usually most protocols have<font color="#E5E5E5"> some</font>

452
00:21:39,750 --> 00:21:45,330
sort<font color="#E5E5E5"> of a protocol header it has a</font>

453
00:21:42,090 --> 00:21:48,500
function code and it has data the header

454
00:21:45,330 --> 00:21:51,570
consists of four parts it has a

455
00:21:48,500 --> 00:21:55,410
transaction ID which is<font color="#E5E5E5"> two bytes</font>

456
00:21:51,570 --> 00:21:58,169
a transaction ID is basically to

457
00:21:55,410 --> 00:22:03,240
identify the transaction so in a day if

458
00:21:58,170 --> 00:22:05,910
i'm<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to ask once every hour for a</font>

459
00:22:03,240 --> 00:22:08,100
reading from some sort of a sensor my

460
00:22:05,910 --> 00:22:10,200
first transaction ID<font color="#CCCCCC"> i could put it as</font>

461
00:22:08,100 --> 00:22:12,120
100 the next one<font color="#CCCCCC"> i</font><font color="#E5E5E5"> could put it as</font>

462
00:22:10,200 --> 00:22:14,880
hundred and one so that<font color="#E5E5E5"> when the server</font>

463
00:22:12,120 --> 00:22:17,219
responds when it responds<font color="#E5E5E5"> it puts that</font>

464
00:22:14,880 --> 00:22:19,860
transaction ID that the client had set

465
00:22:17,220 --> 00:22:22,500
so that the client knows that<font color="#CCCCCC"> ok this is</font>

466
00:22:19,860 --> 00:22:25,590
the<font color="#CCCCCC"> answer for the question</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> i asked</font>

467
00:22:22,500 --> 00:22:28,170
so I say okay my question number 100 is

468
00:22:25,590 --> 00:22:30,090
what is the temperature on blah blah

469
00:22:28,170 --> 00:22:32,340
blah and what I will receive<font color="#E5E5E5"> is the</font>

470
00:22:30,090 --> 00:22:34,939
temperature<font color="#CCCCCC"> on</font><font color="#E5E5E5"> blah blahblah is this for</font>

471
00:22:32,340 --> 00:22:38,760
your transaction so pretty simple

472
00:22:34,940 --> 00:22:41,040
transaction ID protocol IDS again to buy

473
00:22:38,760 --> 00:22:44,310
<font color="#CCCCCC">it's it's constant at 04</font><font color="#E5E5E5"> Modbus we won't</font>

474
00:22:41,040 --> 00:22:48,090
have to<font color="#E5E5E5"> worry</font><font color="#CCCCCC"> about it and length is</font>

475
00:22:44,310 --> 00:22:50,580
basically the length of the packet the

476
00:22:48,090 --> 00:22:52,350
last one byte which is unit ID is quite

477
00:22:50,580 --> 00:22:56,010
interesting it basic it basically tells

478
00:22:52,350 --> 00:22:59,219
the tells the server which unit<font color="#E5E5E5"> I am</font>

479
00:22:56,010 --> 00:23:00,990
referring to<font color="#E5E5E5"> so when I asked for a</font>

480
00:22:59,220 --> 00:23:03,420
temperature or pressure or some sort of

481
00:23:00,990 --> 00:23:06,570
reading i tell that and this reading is

482
00:23:03,420 --> 00:23:09,090
for the sensor number 200 which is

483
00:23:06,570 --> 00:23:11,639
connected to you or the sensor number

484
00:23:09,090 --> 00:23:13,530
500 which is connected to you so it

485
00:23:11,640 --> 00:23:17,940
tells the server which unit<font color="#CCCCCC"> i am talking</font>

486
00:23:13,530 --> 00:23:21,360
<font color="#CCCCCC">about so everyone okay with the header</font>

487
00:23:17,940 --> 00:23:22,590
and again it's we don't mean<font color="#E5E5E5"> you don't</font>

488
00:23:21,360 --> 00:23:25,679
<font color="#E5E5E5">have to understand each and every bit of</font>

489
00:23:22,590 --> 00:23:27,360
it but it's a pretty simple header then

490
00:23:25,680 --> 00:23:30,390
there are function codes we won't go

491
00:23:27,360 --> 00:23:32,729
into a lot of details for this but the

492
00:23:30,390 --> 00:23:34,950
function code basically tells the client

493
00:23:32,730 --> 00:23:37,890
tells the server that this is function

494
00:23:34,950 --> 00:23:40,680
code to which is basically read or this

495
00:23:37,890 --> 00:23:42,900
is function code 6 which is<font color="#E5E5E5"> basically</font>

496
00:23:40,680 --> 00:23:44,190
right so<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> I could the client</font>

497
00:23:42,900 --> 00:23:47,700
<font color="#E5E5E5">can tell the server hey give me the</font>

498
00:23:44,190 --> 00:23:49,470
reading or client can write the reading

499
00:23:47,700 --> 00:23:50,940
which basically means change the reading

500
00:23:49,470 --> 00:23:54,240
so if I want to change the pressure on

501
00:23:50,940 --> 00:23:55,980
on something then I would do a right or

502
00:23:54,240 --> 00:23:57,850
if I<font color="#E5E5E5"> want to do multiple reads there is</font>

503
00:23:55,980 --> 00:24:00,429
a function code for<font color="#E5E5E5"> that and there are</font>

504
00:23:57,850 --> 00:24:02,860
22 days and functional codes basically

505
00:24:00,429 --> 00:24:04,690
what they essentially do is actions what

506
00:24:02,860 --> 00:24:06,729
action does the client want to perform

507
00:24:04,690 --> 00:24:08,500
does the client want to get read data

508
00:24:06,730 --> 00:24:12,700
from server does it want<font color="#E5E5E5"> to write data</font>

509
00:24:08,500 --> 00:24:17,320
to the server so this<font color="#E5E5E5"> is a pretty simple</font>

510
00:24:12,700 --> 00:24:19,600
example in<font color="#E5E5E5"> Perl based on the frame that</font>

511
00:24:17,320 --> 00:24:22,120
we saw the reason I chose<font color="#E5E5E5"> pearl was that</font>

512
00:24:19,600 --> 00:24:26,320
it so it's<font color="#E5E5E5"> very simple you can put all</font>

513
00:24:22,120 --> 00:24:29,799
of that into this just one line of one

514
00:24:26,320 --> 00:24:31,510
page of<font color="#E5E5E5"> pole curved and if you go to C</font>

515
00:24:29,799 --> 00:24:34,179
or C++ it<font color="#CCCCCC"> will be lot difficult to</font>

516
00:24:31,510 --> 00:24:36,158
explain so what you do is you just

517
00:24:34,179 --> 00:24:38,950
create your buffer with the<font color="#E5E5E5"> transaction</font>

518
00:24:36,159 --> 00:24:42,429
ID here I choose one character one which

519
00:24:38,950 --> 00:24:44,799
would be 256 we put the protocol idea

520
00:24:42,429 --> 00:24:47,559
here which is<font color="#CCCCCC"> 0 we put the length of the</font>

521
00:24:44,799 --> 00:24:49,210
bakit we put the unit ID which<font color="#CCCCCC"> I chose</font>

522
00:24:47,559 --> 00:24:52,360
one let's say I want<font color="#CCCCCC"> to talk to you in</font>

523
00:24:49,210 --> 00:24:55,720
unit number one I put function code 3

524
00:24:52,360 --> 00:24:58,240
which is read holding registers so I

525
00:24:55,720 --> 00:25:02,049
want<font color="#E5E5E5"> to read</font><font color="#CCCCCC"> five registers or I want to</font>

526
00:24:58,240 --> 00:25:05,610
read what is the temperature pressure or

527
00:25:02,049 --> 00:25:08,620
whatever it is<font color="#E5E5E5"> connected to 45 registers</font>

528
00:25:05,610 --> 00:25:11,820
and I put the address<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the registers</font>

529
00:25:08,620 --> 00:25:16,330
that I want to<font color="#E5E5E5"> read into create a socket</font>

530
00:25:11,820 --> 00:25:18,908
send it along to do to my modest server

531
00:25:16,330 --> 00:25:21,600
so if you sniff this request in

532
00:25:18,909 --> 00:25:25,240
wireshark basically and by the way

533
00:25:21,600 --> 00:25:27,459
Wireshark and most of the sniffers are

534
00:25:25,240 --> 00:25:30,850
pretty good at Modbus we didn't have<font color="#CCCCCC"> to</font>

535
00:25:27,460 --> 00:25:32,500
write any custom Wireshark plugins or

536
00:25:30,850 --> 00:25:37,178
something like that to<font color="#E5E5E5"> decipher this</font>

537
00:25:32,500 --> 00:25:38,919
text just work out of<font color="#E5E5E5"> the box so why</font><font color="#CCCCCC"> our</font>

538
00:25:37,179 --> 00:25:41,409
<font color="#CCCCCC">source said okay the transaction ID was</font>

539
00:25:38,919 --> 00:25:45,010
to be able<font color="#E5E5E5"> to six protocol id0 and it's</font>

540
00:25:41,409 --> 00:25:46,960
6 i'm talking<font color="#CCCCCC"> to unit number one it</font>

541
00:25:45,010 --> 00:25:50,049
deciphered<font color="#CCCCCC"> three as read multiple</font>

542
00:25:46,960 --> 00:25:51,520
registers and word count of<font color="#E5E5E5"> five which</font>

543
00:25:50,049 --> 00:25:55,150
is basically<font color="#CCCCCC"> I want to read a five</font>

544
00:25:51,520 --> 00:25:58,600
registers and the response that I got

545
00:25:55,150 --> 00:26:01,059
was this basically it said okay this is

546
00:25:58,600 --> 00:26:03,730
it again just echoed back the

547
00:26:01,059 --> 00:26:06,520
transaction ID to me which is 256 it

548
00:26:03,730 --> 00:26:09,040
just echoed back the unit ID and it said

549
00:26:06,520 --> 00:26:10,168
<font color="#CCCCCC">okay you have 10 bytes of data for the</font>

550
00:26:09,040 --> 00:26:14,730
five registered

551
00:26:10,169 --> 00:26:18,749
requested two bites poor poor poor

552
00:26:14,730 --> 00:26:24,059
request so what<font color="#E5E5E5"> is wrong in this I mean</font>

553
00:26:18,749 --> 00:26:29,489
as did you do you find anything<font color="#CCCCCC"> wrong in</font>

554
00:26:24,059 --> 00:26:31,850
this particular code and the

555
00:26:29,489 --> 00:26:36,749
client-server communication that happen

556
00:26:31,850 --> 00:26:39,809
no encryption no authentication so this

557
00:26:36,749 --> 00:26:42,090
is<font color="#E5E5E5"> sort of the triangle that usually all</font>

558
00:26:39,809 --> 00:26:44,869
protocols or any security system is

559
00:26:42,090 --> 00:26:47,699
judged on confidentiality integrity

560
00:26:44,869 --> 00:26:50,340
availability in confidentiality you have

561
00:26:47,700 --> 00:26:53,129
basically authentication and

562
00:26:50,340 --> 00:26:57,570
authorization authentication as in who

563
00:26:53,129 --> 00:27:01,289
you are are you really who you<font color="#CCCCCC"> claim you</font>

564
00:26:57,570 --> 00:27:04,609
to be and authorization is<font color="#E5E5E5"> okay fine you</font>

565
00:27:01,289 --> 00:27:06,779
are who you are but do you really have

566
00:27:04,609 --> 00:27:09,449
are you really authorized to perform

567
00:27:06,779 --> 00:27:11,999
this action and in the previous example

568
00:27:09,450 --> 00:27:14,549
as we saw there was no authentication or

569
00:27:11,999 --> 00:27:17,609
authorization the client just said that

570
00:27:14,549 --> 00:27:19,230
<font color="#CCCCCC">okay give me the readings for these</font>

571
00:27:17,609 --> 00:27:23,189
registers and the server gave those

572
00:27:19,230 --> 00:27:25,259
readings there was no access control as

573
00:27:23,190 --> 00:27:27,869
in the server never asked is are you

574
00:27:25,259 --> 00:27:30,840
really permitted to do so to do this

575
00:27:27,869 --> 00:27:34,168
operation<font color="#E5E5E5"> there was no really in the</font>

576
00:27:30,840 --> 00:27:38,220
integrity checks either so we said okay

577
00:27:34,169 --> 00:27:40,950
Modbus was really a<font color="#CCCCCC"> old pretty old 30 40</font>

578
00:27:38,220 --> 00:27:43,859
years old protocol it was not really

579
00:27:40,950 --> 00:27:45,899
meant for it was meant for a different

580
00:27:43,859 --> 00:27:48,239
sort<font color="#E5E5E5"> of an area it was meant for</font>

581
00:27:45,899 --> 00:27:50,158
industrial control systems it didn't had

582
00:27:48,239 --> 00:27:52,590
security in mind because<font color="#E5E5E5"> at that time</font>

583
00:27:50,159 --> 00:27:54,570
that thought process was that this would

584
00:27:52,590 --> 00:27:56,279
<font color="#CCCCCC">be a completely sort of an air-gapped</font>

585
00:27:54,570 --> 00:27:59,249
system or there were basically no

586
00:27:56,279 --> 00:28:01,980
security concerns at that time so we

587
00:27:59,249 --> 00:28:04,489
said fine let's look at a different

588
00:28:01,980 --> 00:28:06,779
<font color="#E5E5E5">protocol or more recent protocol but</font>

589
00:28:04,489 --> 00:28:09,509
before<font color="#CCCCCC"> going there I want to show you a</font>

590
00:28:06,779 --> 00:28:11,249
slide of this tool that I<font color="#E5E5E5"> mentioned</font>

591
00:28:09,509 --> 00:28:14,879
which we are releasing the name of the

592
00:28:11,249 --> 00:28:17,940
tool is SCADA scan and in this

593
00:28:14,879 --> 00:28:20,428
screenshot it is<font color="#E5E5E5"> running in</font>

594
00:28:17,940 --> 00:28:24,440
the<font color="#E5E5E5"> modbus mode what it does is</font><font color="#CCCCCC"> it will</font>

595
00:28:20,429 --> 00:28:27,769
basically scan for all your Modbus

596
00:28:24,440 --> 00:28:31,769
servers on the network<font color="#E5E5E5"> and it will also</font>

597
00:28:27,769 --> 00:28:34,019
brute force all the slave IDs as far as

598
00:28:31,769 --> 00:28:35,909
signature writing was concerned which

599
00:28:34,019 --> 00:28:39,059
was basically the task that we started

600
00:28:35,909 --> 00:28:41,009
<font color="#CCCCCC">with we said that okay fine we will we</font>

601
00:28:39,059 --> 00:28:42,750
will say<font color="#CCCCCC"> that if any of our customers</font>

602
00:28:41,009 --> 00:28:45,509
have Modbus running we would

603
00:28:42,750 --> 00:28:48,019
automatically flag it as a possible

604
00:28:45,509 --> 00:28:51,090
vulnerability and say that you better

605
00:28:48,019 --> 00:28:53,190
protect your infrastructure with some

606
00:28:51,090 --> 00:28:58,850
other by covering it up with<font color="#E5E5E5"> some other</font>

607
00:28:53,190 --> 00:29:01,190
or security mechanism so we turned<font color="#E5E5E5"> our</font>

608
00:28:58,850 --> 00:29:05,428
everybody pretty pretty<font color="#CCCCCC"> okay till now</font>

609
00:29:01,190 --> 00:29:08,009
still<font color="#E5E5E5"> following okay so we turned our</font>

610
00:29:05,429 --> 00:29:10,500
attention to a more recent protocol

611
00:29:08,009 --> 00:29:12,840
called as dnp3<font color="#E5E5E5"> and don't worry</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> won't</font>

612
00:29:10,500 --> 00:29:17,309
go into<font color="#CCCCCC"> any of these a lot</font><font color="#E5E5E5"> of these</font>

613
00:29:12,840 --> 00:29:20,449
details<font color="#E5E5E5"> the mp3 was designed from the</font>

614
00:29:17,309 --> 00:29:24,539
ground sub for the electrical system and

615
00:29:20,450 --> 00:29:30,029
it had a lot of improvements on Marvel's

616
00:29:24,539 --> 00:29:33,570
so for example Modbus has this constant

617
00:29:30,029 --> 00:29:35,250
polling feature where the client as we

618
00:29:33,570 --> 00:29:36,899
saw in our previous example constantly

619
00:29:35,250 --> 00:29:38,370
polls say tell me the temperature tell

620
00:29:36,899 --> 00:29:43,139
me the pressure tell me tell me tell me

621
00:29:38,370 --> 00:29:46,590
in dnp3 what happens is and you get one

622
00:29:43,139 --> 00:29:49,519
response for each request in dnp3<font color="#E5E5E5"> the</font>

623
00:29:46,590 --> 00:29:52,259
server can sort of piggyback all the

624
00:29:49,519 --> 00:29:54,860
responses into one request so if you

625
00:29:52,259 --> 00:29:58,559
have five requests it can<font color="#E5E5E5"> just answer</font>

626
00:29:54,860 --> 00:30:02,370
with one response the<font color="#E5E5E5"> saving on network</font>

627
00:29:58,559 --> 00:30:04,678
bandwidth it had something<font color="#E5E5E5"> in which you</font>

628
00:30:02,370 --> 00:30:08,070
<font color="#CCCCCC">can tell the server that hey tell me the</font>

629
00:30:04,679 --> 00:30:09,539
temperature or pressure or whatever only

630
00:30:08,070 --> 00:30:13,950
if it changed so you don't even have<font color="#CCCCCC"> to</font>

631
00:30:09,539 --> 00:30:15,870
pull all the time it has features like

632
00:30:13,950 --> 00:30:19,279
time stamping which the electrical

633
00:30:15,870 --> 00:30:21,750
industry rainy really needed and that<font color="#CCCCCC"> is</font>

634
00:30:19,279 --> 00:30:24,210
<font color="#E5E5E5">basically in Modbus when I make a</font>

635
00:30:21,750 --> 00:30:26,100
request and receive a response with that

636
00:30:24,210 --> 00:30:26,650
transaction<font color="#E5E5E5"> ID I just have to assume</font>

637
00:30:26,100 --> 00:30:31,000
that

638
00:30:26,650 --> 00:30:32,920
<font color="#E5E5E5">I made the request at about 4 15 and I</font>

639
00:30:31,000 --> 00:30:36,460
got<font color="#CCCCCC"> the response so the temperature must</font>

640
00:30:32,920 --> 00:30:38,410
<font color="#E5E5E5">be at</font><font color="#CCCCCC"> 4 15</font><font color="#E5E5E5"> but there is no real time</font>

641
00:30:36,460 --> 00:30:40,600
stamping so the electrical system

642
00:30:38,410 --> 00:30:43,120
couldn't do without time stamping so

643
00:30:40,600 --> 00:30:45,040
here what we have is the<font color="#E5E5E5"> client sends a</font>

644
00:30:43,120 --> 00:30:47,530
<font color="#E5E5E5">time stamp and the server sends the time</font>

645
00:30:45,040 --> 00:30:49,570
stand that<font color="#CCCCCC"> okay the temperature you</font>

646
00:30:47,530 --> 00:30:51,100
requested some temperature reading or

647
00:30:49,570 --> 00:30:56,080
electric reading and this is the reading

648
00:30:51,100 --> 00:30:59,290
at this time so a lot of improvements on

649
00:30:56,080 --> 00:31:03,159
on dnp3<font color="#E5E5E5"> it's a three layer protocol it</font>

650
00:30:59,290 --> 00:31:08,050
has it has application layer a transport

651
00:31:03,160 --> 00:31:10,150
layer and a link layer and this is the

652
00:31:08,050 --> 00:31:14,800
application<font color="#CCCCCC"> layer packet and again let's</font>

653
00:31:10,150 --> 00:31:16,600
let's<font color="#E5E5E5"> not let's not try to get lost in</font>

654
00:31:14,800 --> 00:31:19,870
the back end details but it has

655
00:31:16,600 --> 00:31:23,139
basically same thing as Modbus server a

656
00:31:19,870 --> 00:31:25,330
client request response so it has

657
00:31:23,140 --> 00:31:27,970
<font color="#E5E5E5">similar chords like similar function</font>

658
00:31:25,330 --> 00:31:31,840
codes free ride like what we saw in

659
00:31:27,970 --> 00:31:34,180
Modbus it has a transport layer which

660
00:31:31,840 --> 00:31:36,909
tries to provide some transport type of

661
00:31:34,180 --> 00:31:38,440
mechanism and it has a link layer which

662
00:31:36,910 --> 00:31:42,730
is<font color="#E5E5E5"> the layer which is at the bottom</font>

663
00:31:38,440 --> 00:31:44,500
which has which provides basically

664
00:31:42,730 --> 00:31:47,320
source a traditional address and aha

665
00:31:44,500 --> 00:31:50,590
some sort of<font color="#E5E5E5"> a CRC so you have some some</font>

666
00:31:47,320 --> 00:31:52,450
error checking going on here so what we

667
00:31:50,590 --> 00:31:55,110
did was we<font color="#CCCCCC"> did exactly</font><font color="#E5E5E5"> the same thing</font>

668
00:31:52,450 --> 00:31:59,530
that<font color="#E5E5E5"> we did for more bus we created a</font>

669
00:31:55,110 --> 00:32:01,300
very simple pole script as you can see

670
00:31:59,530 --> 00:32:03,340
it's<font color="#CCCCCC"> just like one page along if you</font>

671
00:32:01,300 --> 00:32:06,129
literally copy paste this in<font color="#E5E5E5"> Perl it</font>

672
00:32:03,340 --> 00:32:09,189
will it will work well with some headers

673
00:32:06,130 --> 00:32:11,560
and things like that so<font color="#E5E5E5"> and this like</font>

674
00:32:09,190 --> 00:32:13,690
this<font color="#E5E5E5"> is from</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> open source tool that I</font>

675
00:32:11,560 --> 00:32:16,179
was talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> so you're basically</font>

676
00:32:13,690 --> 00:32:18,460
again create a dnp3<font color="#E5E5E5"> packet put the</font>

677
00:32:16,180 --> 00:32:21,000
destination address source address now

678
00:32:18,460 --> 00:32:23,260
you are actually calculating a<font color="#CCCCCC"> CRC here</font>

679
00:32:21,000 --> 00:32:25,890
here I've just hard coded to the crc

680
00:32:23,260 --> 00:32:31,470
because I know what the packet is and

681
00:32:25,890 --> 00:32:34,840
you send it away to to the dnp3 server

682
00:32:31,470 --> 00:32:37,330
basically<font color="#E5E5E5"> ask this is the request that</font>

683
00:32:34,840 --> 00:32:38,439
you see again<font color="#CCCCCC"> in this case Wireshark</font>

684
00:32:37,330 --> 00:32:41,740
aterial

685
00:32:38,440 --> 00:32:46,059
have most of the<font color="#E5E5E5"> packet sniffers already</font>

686
00:32:41,740 --> 00:32:48,429
knew<font color="#CCCCCC"> how to decipher this protocol you</font>

687
00:32:46,059 --> 00:32:50,830
see a request here which basically

688
00:32:48,429 --> 00:32:53,110
requests the link status so it<font color="#E5E5E5"> doesn't</font>

689
00:32:50,830 --> 00:32:55,990
ask<font color="#E5E5E5"> the server to perform a certain</font>

690
00:32:53,110 --> 00:32:57,610
<font color="#E5E5E5">action it just is a tell me what is the</font>

691
00:32:55,990 --> 00:32:59,710
status of the link is it up is it down

692
00:32:57,610 --> 00:33:02,610
and there are a lot of bit fields

693
00:32:59,710 --> 00:33:05,230
related to link so give me all those and

694
00:33:02,610 --> 00:33:08,110
the response<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you see is this which</font>

695
00:33:05,230 --> 00:33:10,840
is basically it says okay this<font color="#E5E5E5"> is</font>

696
00:33:08,110 --> 00:33:12,070
unsolicited response and this is the

697
00:33:10,840 --> 00:33:15,399
<font color="#E5E5E5">status of your link and there are</font>

698
00:33:12,070 --> 00:33:18,879
various bit fields for<font color="#CCCCCC"> the status</font><font color="#E5E5E5"> of the</font>

699
00:33:15,399 --> 00:33:21,370
link same<font color="#E5E5E5"> question again that we asked</font>

700
00:33:18,879 --> 00:33:24,840
<font color="#E5E5E5">to</font><font color="#CCCCCC"> Marcus what did it provide</font>

701
00:33:21,370 --> 00:33:27,129
confidentiality which has basically

702
00:33:24,840 --> 00:33:29,110
authentication not really we didn't

703
00:33:27,129 --> 00:33:32,350
authenticate against the server the

704
00:33:29,110 --> 00:33:35,370
<font color="#CCCCCC">server didn't ask us who we were it just</font>

705
00:33:32,350 --> 00:33:39,759
took our request and send us<font color="#CCCCCC"> the reply</font>

706
00:33:35,370 --> 00:33:43,029
no access control or authorization some

707
00:33:39,759 --> 00:33:44,710
integrity as part of as crc but as you

708
00:33:43,029 --> 00:33:46,029
know i<font color="#E5E5E5"> mean it can easily be broken you</font>

709
00:33:44,710 --> 00:33:48,909
can have a lot of man-in-the-middle

710
00:33:46,029 --> 00:33:52,539
attacks and but still some sort of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> crc</font>

711
00:33:48,909 --> 00:33:56,649
as compared to Modbus so we again did

712
00:33:52,539 --> 00:33:58,389
the same thing is if we found dnp3<font color="#E5E5E5"> in</font>

713
00:33:56,649 --> 00:34:01,000
our customers environment we said that

714
00:33:58,389 --> 00:34:05,110
<font color="#CCCCCC">okay our signature it said okay</font><font color="#E5E5E5"> you are</font>

715
00:34:01,000 --> 00:34:07,210
running dnp3<font color="#E5E5E5"> and this is the screenshot</font>

716
00:34:05,110 --> 00:34:10,569
from the open source<font color="#E5E5E5"> tool it basically</font>

717
00:34:07,210 --> 00:34:13,449
scans it was basically trying to<font color="#E5E5E5"> find</font>

718
00:34:10,569 --> 00:34:17,259
every dnp3<font color="#E5E5E5"> is running and if it does</font>

719
00:34:13,449 --> 00:34:21,310
then it says that<font color="#E5E5E5"> okay it's not a very</font>

720
00:34:17,260 --> 00:34:23,109
secure protocol so try to try to have

721
00:34:21,310 --> 00:34:26,139
your security in some other form around

722
00:34:23,109 --> 00:34:29,649
this protocol but well everything was

723
00:34:26,139 --> 00:34:34,089
not lost<font color="#E5E5E5"> what happened</font><font color="#CCCCCC"> was in 2007 dnp3</font>

724
00:34:29,649 --> 00:34:36,759
<font color="#E5E5E5">released a new specification which had a</font>

725
00:34:34,089 --> 00:34:41,649
lot of things<font color="#E5E5E5"> that we wanted to see so</font>

726
00:34:36,760 --> 00:34:44,470
it had a<font color="#E5E5E5"> cryptography in it it had new</font>

727
00:34:41,649 --> 00:34:48,509
status codes and it had new hashing<font color="#E5E5E5"> and</font>

728
00:34:44,469 --> 00:34:50,520
so on and<font color="#E5E5E5"> so forth so now when we</font>

729
00:34:48,510 --> 00:34:53,340
right the signature we check if it's

730
00:34:50,520 --> 00:34:55,440
just a dnp3<font color="#E5E5E5"> which is running or secured</font>

731
00:34:53,340 --> 00:34:58,080
in 15 that<font color="#E5E5E5"> is running so we can give</font>

732
00:34:55,440 --> 00:35:02,810
like a good<font color="#CCCCCC"> judgement of how secure that</font>

733
00:34:58,080 --> 00:35:06,120
protocol is so we looked at some of

734
00:35:02,810 --> 00:35:10,740
<font color="#E5E5E5">these protocols and said</font><font color="#CCCCCC"> okay a lot of</font>

735
00:35:06,120 --> 00:35:12,450
protocols are basically they are<font color="#E5E5E5"> old</font>

736
00:35:10,740 --> 00:35:15,569
protocols not really designed with

737
00:35:12,450 --> 00:35:18,779
security in mind so what other threads

738
00:35:15,570 --> 00:35:20,820
could there be in<font color="#CCCCCC"> SCADA systems we saw</font>

739
00:35:18,780 --> 00:35:22,470
some of the<font color="#CCCCCC"> physical threats here where</font>

740
00:35:20,820 --> 00:35:24,600
you could go and sort of physically

741
00:35:22,470 --> 00:35:27,720
damaged something<font color="#E5E5E5"> which is maybe miles</font>

742
00:35:24,600 --> 00:35:30,390
away we saw<font color="#E5E5E5"> some of the communication</font>

743
00:35:27,720 --> 00:35:32,450
<font color="#E5E5E5">threats in the protocols or in the way</font>

744
00:35:30,390 --> 00:35:34,859
the client communicates with the<font color="#E5E5E5"> server</font>

745
00:35:32,450 --> 00:35:37,259
now let's look at some<font color="#CCCCCC"> of the threats</font>

746
00:35:34,860 --> 00:35:39,420
<font color="#E5E5E5">that could affect directly the master</font>

747
00:35:37,260 --> 00:35:42,060
systems now this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a system if you</font>

748
00:35:39,420 --> 00:35:45,450
recall in the picture earlier was where

749
00:35:42,060 --> 00:35:47,610
there are these lot of screens where a

750
00:35:45,450 --> 00:35:50,009
human is looking at these different

751
00:35:47,610 --> 00:35:53,010
alerts it's<font color="#E5E5E5"> usually a very secure</font>

752
00:35:50,010 --> 00:35:55,170
facility where you either need some

753
00:35:53,010 --> 00:35:56,670
fingerprint or some biometric way to get

754
00:35:55,170 --> 00:35:58,230
inside<font color="#E5E5E5"> or usually there is a guard</font>

755
00:35:56,670 --> 00:36:01,770
standing outside to check your

756
00:35:58,230 --> 00:36:05,100
credentials your ID your badge and where

757
00:36:01,770 --> 00:36:07,440
the operator is monitoring 24 by 7

758
00:36:05,100 --> 00:36:10,830
what's happening on<font color="#CCCCCC"> the plant floor or</font>

759
00:36:07,440 --> 00:36:15,390
what's happening in the system and the

760
00:36:10,830 --> 00:36:17,759
number one thread that we found<font color="#E5E5E5"> to the</font>

761
00:36:15,390 --> 00:36:20,549
<font color="#E5E5E5">master system sort of the SCADA masters</font>

762
00:36:17,760 --> 00:36:23,880
is that they<font color="#CCCCCC"> are more and more connected</font>

763
00:36:20,550 --> 00:36:28,410
to the corporate intranet or even to the

764
00:36:23,880 --> 00:36:32,010
<font color="#E5E5E5">Internet so when Stuxnet hit and it was</font>

765
00:36:28,410 --> 00:36:35,330
<font color="#CCCCCC">all over the news mmm i did a showdown</font>

766
00:36:32,010 --> 00:36:40,310
search how many of<font color="#E5E5E5"> you know showed an</font>

767
00:36:35,330 --> 00:36:44,220
alright cool<font color="#CCCCCC"> so</font><font color="#E5E5E5"> show</font><font color="#CCCCCC"> Dan is basically a</font>

768
00:36:40,310 --> 00:36:46,890
it's a website<font color="#E5E5E5"> you can go</font><font color="#CCCCCC"> to shodan com</font>

769
00:36:44,220 --> 00:36:49,919
I or<font color="#CCCCCC"> cuales does not manage it it's from</font>

770
00:36:46,890 --> 00:36:52,500
some some guy and it's a scanner it's a

771
00:36:49,920 --> 00:36:56,010
banner based scanner so offline it scans

772
00:36:52,500 --> 00:36:58,890
all the public IPS and stores their

773
00:36:56,010 --> 00:37:01,410
banners so if it is<font color="#CCCCCC"> a HTTP service it</font>

774
00:36:58,890 --> 00:37:04,200
will store in its database that this I

775
00:37:01,410 --> 00:37:06,420
p has this banner if it is<font color="#E5E5E5"> a ftp service</font>

776
00:37:04,200 --> 00:37:08,910
it will store this IP this manner if

777
00:37:06,420 --> 00:37:11,070
<font color="#E5E5E5">it's telnet</font><font color="#CCCCCC"> ssh it will do this and</font>

778
00:37:08,910 --> 00:37:13,890
store it isn't it store it<font color="#E5E5E5"> in its</font>

779
00:37:11,070 --> 00:37:15,480
database what you can do is when you go

780
00:37:13,890 --> 00:37:18,690
to the website there is a search button

781
00:37:15,480 --> 00:37:21,690
you can say<font color="#E5E5E5"> poured Eddie string Apache</font>

782
00:37:18,690 --> 00:37:24,510
so it will give you all<font color="#E5E5E5"> the live eye</font>

783
00:37:21,690 --> 00:37:27,450
peas on the internet which have port 80

784
00:37:24,510 --> 00:37:32,430
open which has the banner that matches

785
00:37:27,450 --> 00:37:35,580
<font color="#CCCCCC">Apache so when Stuxnet hit I was I was</font>

786
00:37:32,430 --> 00:37:41,940
curious about when I was working on the

787
00:37:35,580 --> 00:37:44,759
Siemens and all those things so I<font color="#E5E5E5"> I did</font>

788
00:37:41,940 --> 00:37:47,850
my little search there<font color="#E5E5E5"> I said</font><font color="#CCCCCC"> ok siemens</font>

789
00:37:44,760 --> 00:37:49,670
plc<font color="#E5E5E5"> SCADA let's type it in let's type</font>

790
00:37:47,850 --> 00:37:52,980
this banner let's see what happens and

791
00:37:49,670 --> 00:37:55,530
sure enough there were some SCADA

792
00:37:52,980 --> 00:37:57,900
systems on the<font color="#E5E5E5"> internet connected to the</font>

793
00:37:55,530 --> 00:38:00,830
internet which<font color="#E5E5E5"> I could basically access</font>

794
00:37:57,900 --> 00:38:04,560
which gave some of<font color="#E5E5E5"> the banners which</font>

795
00:38:00,830 --> 00:38:07,920
which SCADA systems have and that is I

796
00:38:04,560 --> 00:38:11,190
<font color="#CCCCCC">mean obviously</font><font color="#E5E5E5"> it's ridiculous it showed</font>

797
00:38:07,920 --> 00:38:13,170
and also has a top search feature so<font color="#CCCCCC"> you</font>

798
00:38:11,190 --> 00:38:14,940
could see what are the what are the

799
00:38:13,170 --> 00:38:17,070
searches what are the top searches that

800
00:38:14,940 --> 00:38:18,840
people are doing and it changes every

801
00:38:17,070 --> 00:38:22,470
<font color="#CCCCCC">day every hour based on the searches</font>

802
00:38:18,840 --> 00:38:25,440
people are doing and it had after

803
00:38:22,470 --> 00:38:28,680
Stuxnet a lot of searches for Siemens

804
00:38:25,440 --> 00:38:31,020
for<font color="#CCCCCC"> plc's for scada related things in</font>

805
00:38:28,680 --> 00:38:32,609
there so initially<font color="#CCCCCC"> I was not able to</font>

806
00:38:31,020 --> 00:38:35,190
<font color="#CCCCCC">find anything because my search was</font>

807
00:38:32,610 --> 00:38:38,760
wrong but then I just<font color="#CCCCCC"> copy pasted one of</font>

808
00:38:35,190 --> 00:38:40,140
the top search and bingo<font color="#CCCCCC"> i</font><font color="#E5E5E5"> did find so</font>

809
00:38:38,760 --> 00:38:45,690
why did form some of the systems

810
00:38:40,140 --> 00:38:47,100
connected to the<font color="#E5E5E5"> internet so that's the</font>

811
00:38:45,690 --> 00:38:49,380
number<font color="#E5E5E5"> one threat that we see</font><font color="#CCCCCC"> that</font>

812
00:38:47,100 --> 00:38:51,830
systems are either connected to the

813
00:38:49,380 --> 00:38:54,210
<font color="#E5E5E5">Internet in</font><font color="#CCCCCC"> the worst case directly or</font>

814
00:38:51,830 --> 00:38:57,779
connected to the corporate network which

815
00:38:54,210 --> 00:39:00,810
is basically your network which the HR

816
00:38:57,780 --> 00:39:07,470
system has or which the admin has or<font color="#E5E5E5"> the</font>

817
00:39:00,810 --> 00:39:09,270
reception has and there is no

818
00:39:07,470 --> 00:39:11,819
authentication or poor user

819
00:39:09,270 --> 00:39:14,190
authentication so when you go into this

820
00:39:11,820 --> 00:39:16,740
room which has this scalar control

821
00:39:14,190 --> 00:39:18,900
you have as<font color="#E5E5E5"> I mentioned it has some</font>

822
00:39:16,740 --> 00:39:21,299
biometric type of fingerprinting some

823
00:39:18,900 --> 00:39:22,830
physical security but once you are

824
00:39:21,300 --> 00:39:24,300
inside<font color="#E5E5E5"> there</font><font color="#CCCCCC"> I mean when you are in</font>

825
00:39:22,830 --> 00:39:26,640
front<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those screens there is no</font>

826
00:39:24,300 --> 00:39:28,820
actually security on who can go and

827
00:39:26,640 --> 00:39:31,109
press any button<font color="#E5E5E5"> it's it's there is no</font>

828
00:39:28,820 --> 00:39:34,050
authentication or there is no poor user

829
00:39:31,110 --> 00:39:36,840
authentication and that was fine when

830
00:39:34,050 --> 00:39:40,970
these systems were sort of<font color="#CCCCCC"> air gapped</font>

831
00:39:36,840 --> 00:39:43,320
are not connected to<font color="#E5E5E5"> your intranet but</font>

832
00:39:40,970 --> 00:39:45,660
now since they are<font color="#CCCCCC"> connected to your</font>

833
00:39:43,320 --> 00:39:47,970
intranet the viruses or worms like

834
00:39:45,660 --> 00:39:50,549
Stuxnet they don't need to physically go

835
00:39:47,970 --> 00:39:52,919
into the room or and do something they

836
00:39:50,550 --> 00:39:55,680
can just jump from your corporate

837
00:39:52,920 --> 00:39:58,530
network which is your network that your

838
00:39:55,680 --> 00:40:01,259
receptionist to use your HR system<font color="#CCCCCC"> uses</font>

839
00:39:58,530 --> 00:40:05,550
your engineers use on to the SCADA

840
00:40:01,260 --> 00:40:07,320
Network and if there was authentic<font color="#CCCCCC"> Asian</font>

841
00:40:05,550 --> 00:40:11,430
on the SCADA software at<font color="#CCCCCC"> least it</font>

842
00:40:07,320 --> 00:40:13,500
provides some layer of<font color="#CCCCCC"> Defense where the</font>

843
00:40:11,430 --> 00:40:18,419
virus would have to know some sort<font color="#CCCCCC"> of a</font>

844
00:40:13,500 --> 00:40:22,200
credentials to talk to<font color="#E5E5E5"> to talk here of</font>

845
00:40:18,420 --> 00:40:24,090
course it can use protocols that we just

846
00:40:22,200 --> 00:40:26,310
saw because the protocols also do<font color="#E5E5E5"> not</font>

847
00:40:24,090 --> 00:40:29,640
<font color="#E5E5E5">have any authentication or access</font>

848
00:40:26,310 --> 00:40:32,549
control but using the protocols may be

849
00:40:29,640 --> 00:40:35,279
tricky so a lot<font color="#CCCCCC"> of times the virus could</font>

850
00:40:32,550 --> 00:40:37,500
just access the HMI system and click

851
00:40:35,280 --> 00:40:39,840
these buttons which usually the operator

852
00:40:37,500 --> 00:40:42,900
would do of course this would require

853
00:40:39,840 --> 00:40:45,360
<font color="#E5E5E5">the wireless to know what a SCADA system</font>

854
00:40:42,900 --> 00:40:49,830
is<font color="#E5E5E5"> being used and what how to manipulate</font>

855
00:40:45,360 --> 00:40:51,900
it but from Stuxnet as we saw there are

856
00:40:49,830 --> 00:40:56,220
wireless is written which know exactly

857
00:40:51,900 --> 00:40:58,610
how SCADA systems behave another issue

858
00:40:56,220 --> 00:41:02,549
that we saw was that there were no

859
00:40:58,610 --> 00:41:04,800
passwords or default passwords so if a

860
00:41:02,550 --> 00:41:07,770
<font color="#CCCCCC">virus</font><font color="#E5E5E5"> was able to identify the new are</font>

861
00:41:04,800 --> 00:41:10,710
running a BB or<font color="#E5E5E5"> Honeywell or rock will</font>

862
00:41:07,770 --> 00:41:12,690
systems it can<font color="#E5E5E5"> easily have it can easily</font>

863
00:41:10,710 --> 00:41:15,180
know what is the<font color="#CCCCCC"> default password for</font>

864
00:41:12,690 --> 00:41:17,910
that<font color="#E5E5E5"> system and get access to it even if</font>

865
00:41:15,180 --> 00:41:23,600
you have some sort of an authentication

866
00:41:17,910 --> 00:41:23,600
on it I was at the<font color="#E5E5E5"> schema conference and</font>

867
00:41:23,900 --> 00:41:29,420
and<font color="#E5E5E5"> basically</font>

868
00:41:26,480 --> 00:41:33,350
the number one reason for people<font color="#E5E5E5"> not</font>

869
00:41:29,420 --> 00:41:35,630
having passwords on these systems was

870
00:41:33,350 --> 00:41:38,450
that they said<font color="#CCCCCC"> that these</font><font color="#E5E5E5"> are critical</font>

871
00:41:35,630 --> 00:41:40,580
systems when there is an alarm there is

872
00:41:38,450 --> 00:41:42,560
a fire going on or maybe the conveyor

873
00:41:40,580 --> 00:41:44,840
belt it's stuck or some emergency that

874
00:41:42,560 --> 00:41:47,060
has happened the operator does not have

875
00:41:44,840 --> 00:41:49,100
<font color="#E5E5E5">enough time to input like a long</font>

876
00:41:47,060 --> 00:41:50,930
password and then oops wrong password

877
00:41:49,100 --> 00:41:52,549
input again the correct password because

878
00:41:50,930 --> 00:41:55,310
something really critical has happened

879
00:41:52,550 --> 00:41:59,600
there like you may have<font color="#E5E5E5"> heard of like a</font>

880
00:41:55,310 --> 00:42:03,830
<font color="#CCCCCC">PGA</font><font color="#E5E5E5"> again I</font><font color="#CCCCCC"> don't want to go or specific</font>

881
00:41:59,600 --> 00:42:06,290
companies but gas pipeline bursting and

882
00:42:03,830 --> 00:42:08,690
that's type of an emergency where you

883
00:42:06,290 --> 00:42:12,170
don't<font color="#E5E5E5"> want the operator to type password</font>

884
00:42:08,690 --> 00:42:14,900
and maybe type it wrong to get to that

885
00:42:12,170 --> 00:42:17,540
emergency but<font color="#E5E5E5"> again in the same</font>

886
00:42:14,900 --> 00:42:21,859
conference there was there was a

887
00:42:17,540 --> 00:42:25,369
military like US Marines guy Colonel he

888
00:42:21,859 --> 00:42:28,190
said that they have 19 year<font color="#E5E5E5"> over people</font>

889
00:42:25,369 --> 00:42:30,130
in the military<font color="#E5E5E5"> who input 25 digit long</font>

890
00:42:28,190 --> 00:42:32,840
passwords which change every two weeks

891
00:42:30,130 --> 00:42:35,210
<font color="#E5E5E5">so of course being in military you can</font>

892
00:42:32,840 --> 00:42:38,210
enforce a lot of<font color="#E5E5E5"> things like that but I</font>

893
00:42:35,210 --> 00:42:40,850
think<font color="#CCCCCC"> it's time for us to really think</font>

894
00:42:38,210 --> 00:42:43,520
of our critical infrastructure as as

895
00:42:40,850 --> 00:42:49,040
being military because it is of of that

896
00:42:43,520 --> 00:42:51,200
importance many times we saw there was

897
00:42:49,040 --> 00:42:52,730
no patching on<font color="#E5E5E5"> lead SCADA system and</font>

898
00:42:51,200 --> 00:42:56,419
this<font color="#E5E5E5"> is a very interesting issue as</font><font color="#CCCCCC"> far</font>

899
00:42:52,730 --> 00:42:58,910
as kayla is concerned a lot of earlier

900
00:42:56,420 --> 00:43:00,890
like a few years ago<font color="#E5E5E5"> many of these SCADA</font>

901
00:42:58,910 --> 00:43:04,160
systems were proprietary hardware and

902
00:43:00,890 --> 00:43:07,009
software so there was no question about

903
00:43:04,160 --> 00:43:10,509
patching or things like that but in the

904
00:43:07,010 --> 00:43:13,850
90s when<font color="#E5E5E5"> windows became the predominant</font>

905
00:43:10,510 --> 00:43:16,130
operating system what many of<font color="#E5E5E5"> the SCADA</font>

906
00:43:13,850 --> 00:43:17,600
owners asked their SCADA vendors is why

907
00:43:16,130 --> 00:43:21,380
don't you pour your system to windows

908
00:43:17,600 --> 00:43:23,299
because it will<font color="#CCCCCC"> be well cheaper that's</font>

909
00:43:21,380 --> 00:43:26,570
what the vendors did then they ported a

910
00:43:23,300 --> 00:43:29,300
lot of their systems to or their master

911
00:43:26,570 --> 00:43:31,010
heart here the control systems to run on

912
00:43:29,300 --> 00:43:33,770
windows so the HMI is not like a

913
00:43:31,010 --> 00:43:36,290
proprietary screen and buttons but it's

914
00:43:33,770 --> 00:43:36,970
just a<font color="#E5E5E5"> Windows desktop Windows has good</font>

915
00:43:36,290 --> 00:43:38,890
graphic

916
00:43:36,970 --> 00:43:41,830
is it can show all these alerts and

917
00:43:38,890 --> 00:43:44,680
people can react to<font color="#CCCCCC"> it but</font><font color="#E5E5E5"> the downside</font>

918
00:43:41,830 --> 00:43:49,720
of<font color="#CCCCCC"> that was and that was still even fine</font>

919
00:43:44,680 --> 00:43:54,430
when there was no internet in the early

920
00:43:49,720 --> 00:43:56,470
days windows 3.0 or<font color="#E5E5E5"> windows 2.9 but now</font>

921
00:43:54,430 --> 00:43:59,049
when these systems run off<font color="#CCCCCC"> the shelf</font>

922
00:43:56,470 --> 00:44:01,060
operating system like windows and they

923
00:43:59,050 --> 00:44:04,270
are<font color="#CCCCCC"> connected to the Internet that's a</font>

924
00:44:01,060 --> 00:44:07,119
pretty deadly combination because<font color="#E5E5E5"> they</font>

925
00:44:04,270 --> 00:44:09,400
get exposed to<font color="#E5E5E5"> all the attacks malware</font>

926
00:44:07,119 --> 00:44:13,060
and worms that could affect a<font color="#CCCCCC"> Windows</font>

927
00:44:09,400 --> 00:44:16,180
system and on top<font color="#E5E5E5"> of that you have to</font>

928
00:44:13,060 --> 00:44:17,770
patch<font color="#E5E5E5"> Windows systems and now I think</font>

929
00:44:16,180 --> 00:44:19,779
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> the question</font><font color="#E5E5E5"> but a lot of hands</font>

930
00:44:17,770 --> 00:44:23,320
<font color="#E5E5E5">will go up how many times does Microsoft</font>

931
00:44:19,780 --> 00:44:26,530
release a patch per year per month per

932
00:44:23,320 --> 00:44:28,270
week that's Tuesday so everyone knows

933
00:44:26,530 --> 00:44:31,300
that<font color="#CCCCCC"> ever because all of us are affected</font>

934
00:44:28,270 --> 00:44:33,310
by Patch Tuesday so every patch tuesday

935
00:44:31,300 --> 00:44:36,400
<font color="#E5E5E5">will mount now when</font><font color="#CCCCCC"> microsoft releases a</font>

936
00:44:33,310 --> 00:44:38,920
patch<font color="#CCCCCC"> i have to patch my SCADA hardware</font>

937
00:44:36,400 --> 00:44:42,550
I don't feel too comfortable running a

938
00:44:38,920 --> 00:44:45,130
patch on on a system<font color="#CCCCCC"> which controls</font>

939
00:44:42,550 --> 00:44:48,130
critical infrastructure on top of<font color="#CCCCCC"> that</font>

940
00:44:45,130 --> 00:44:50,140
there is no guidance from<font color="#CCCCCC"> esqueda vendor</font>

941
00:44:48,130 --> 00:44:52,240
on what that patch would do if<font color="#CCCCCC"> that</font>

942
00:44:50,140 --> 00:44:55,240
patch is really safe to apply on mascara

943
00:44:52,240 --> 00:44:57,279
system so if I am a SCADA engineer my

944
00:44:55,240 --> 00:44:59,979
vendor doesn't tell<font color="#CCCCCC"> me if that patch is</font>

945
00:44:57,280 --> 00:45:03,339
safe to install or not I most probably

946
00:44:59,980 --> 00:45:06,190
wouldn't install that patch this leads

947
00:45:03,339 --> 00:45:08,380
to a lot of systems not being patched

948
00:45:06,190 --> 00:45:11,140
and being exposed to a lot of

949
00:45:08,380 --> 00:45:14,950
vulnerabilities another issue here is

950
00:45:11,140 --> 00:45:18,250
many times my sis kada system doesn't

951
00:45:14,950 --> 00:45:21,098
run like a plane windows that all of us

952
00:45:18,250 --> 00:45:24,099
use it runs some modified version of

953
00:45:21,099 --> 00:45:25,839
windows by the<font color="#E5E5E5"> SCADA vendor so what</font>

954
00:45:24,099 --> 00:45:28,810
happens is when Microsoft releases a

955
00:45:25,839 --> 00:45:30,759
patch the vendor has to sort of

956
00:45:28,810 --> 00:45:32,710
recompile and it will release the patch

957
00:45:30,760 --> 00:45:35,380
for that vendors implementation of

958
00:45:32,710 --> 00:45:36,910
<font color="#CCCCCC">Windows and</font><font color="#E5E5E5"> as you can see it takes a</font>

959
00:45:35,380 --> 00:45:39,130
lot of time when Microsoft releases a

960
00:45:36,910 --> 00:45:41,259
patch then the vendor religious the

961
00:45:39,130 --> 00:45:45,900
patch then I get it and<font color="#E5E5E5"> then I install</font>

962
00:45:41,260 --> 00:45:47,670
it we have already seen we as<font color="#CCCCCC"> in</font>

963
00:45:45,900 --> 00:45:49,980
now I'm going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> refer a little bit to</font>

964
00:45:47,670 --> 00:45:53,610
my company his<font color="#CCCCCC"> cuales has already seen</font>

965
00:45:49,980 --> 00:45:56,970
that<font color="#CCCCCC"> the time to exploit a vulnerability</font>

966
00:45:53,610 --> 00:46:00,180
of the after the patches being released

967
00:45:56,970 --> 00:46:02,399
is getting less and less the people or

968
00:46:00,180 --> 00:46:05,160
hackers when Apaches<font color="#E5E5E5"> release they can</font>

969
00:46:02,400 --> 00:46:07,740
sort of been<font color="#E5E5E5"> diff or do a binary def of</font>

970
00:46:05,160 --> 00:46:12,420
<font color="#CCCCCC">the patch and try to guess what</font><font color="#E5E5E5"> was</font>

971
00:46:07,740 --> 00:46:15,859
changed<font color="#E5E5E5"> and ride worms or malware to</font>

972
00:46:12,420 --> 00:46:18,120
take advantage<font color="#CCCCCC"> of that</font><font color="#E5E5E5"> vulnerability</font>

973
00:46:15,860 --> 00:46:20,780
assuming that<font color="#CCCCCC"> you are</font><font color="#E5E5E5"> not fat so being</font>

974
00:46:18,120 --> 00:46:22,950
unpatched is is really<font color="#CCCCCC"> bad these days</font>

975
00:46:20,780 --> 00:46:26,640
there are systems that we saw that we

976
00:46:22,950 --> 00:46:28,680
are not restarted in years and when we

977
00:46:26,640 --> 00:46:30,930
<font color="#CCCCCC">ask like why have you not restarted this</font>

978
00:46:28,680 --> 00:46:34,259
system in years the simple<font color="#E5E5E5"> answer that</font>

979
00:46:30,930 --> 00:46:36,419
we got was<font color="#CCCCCC"> that they were not sure that</font>

980
00:46:34,260 --> 00:46:38,430
the system will come back up again if

981
00:46:36,420 --> 00:46:41,430
they started this is your critical

982
00:46:38,430 --> 00:46:43,319
infrastructure system so it's even i

983
00:46:41,430 --> 00:46:47,250
chuckled at the time had a little<font color="#E5E5E5"> laugh</font>

984
00:46:43,320 --> 00:46:48,840
but it is a fact<font color="#E5E5E5"> and it is we saw a</font>

985
00:46:47,250 --> 00:46:50,850
<font color="#E5E5E5">couple of systems that have got that</font>

986
00:46:48,840 --> 00:46:54,060
<font color="#E5E5E5">like that running Windows NT</font><font color="#CCCCCC"> Windows</font>

987
00:46:50,850 --> 00:46:56,730
2000 and systems which are actually

988
00:46:54,060 --> 00:47:01,410
absolute and for which patches are no

989
00:46:56,730 --> 00:47:04,080
longer there since these systems are now

990
00:47:01,410 --> 00:47:06,120
more or<font color="#E5E5E5"> less</font><font color="#CCCCCC"> Solaris or</font><font color="#E5E5E5"> Windows or more</font>

991
00:47:04,080 --> 00:47:08,340
of the sheriff oasis it has all the

992
00:47:06,120 --> 00:47:12,270
problems that we<font color="#CCCCCC"> have for common IT</font>

993
00:47:08,340 --> 00:47:14,310
systems like unnecessary services the

994
00:47:12,270 --> 00:47:16,170
system has<font color="#CCCCCC"> to be now really hardened</font>

995
00:47:14,310 --> 00:47:23,040
because it's a general-purpose OS not a

996
00:47:16,170 --> 00:47:25,650
specific OS so so to just<font color="#E5E5E5"> go over some</font>

997
00:47:23,040 --> 00:47:29,730
of some of<font color="#E5E5E5"> the things that we saw was</font>

998
00:47:25,650 --> 00:47:32,820
that the most the number one challenge

999
00:47:29,730 --> 00:47:35,430
for scada system apart from<font color="#E5E5E5"> the use of</font>

1000
00:47:32,820 --> 00:47:37,830
off-the-shelf operating systems which

1001
00:47:35,430 --> 00:47:40,230
were connected to internet is this which

1002
00:47:37,830 --> 00:47:42,840
is<font color="#CCCCCC"> the long life cycle of a SCADA system</font>

1003
00:47:40,230 --> 00:47:47,790
a SCADA system whenever it is installed

1004
00:47:42,840 --> 00:47:50,550
is usually meant to last for at least 10

1005
00:47:47,790 --> 00:47:53,520
years<font color="#E5E5E5"> or decade or multiple decades you</font>

1006
00:47:50,550 --> 00:47:54,990
cannot just change the entire forget

1007
00:47:53,520 --> 00:47:57,710
about changing<font color="#CCCCCC"> the entire system but</font>

1008
00:47:54,990 --> 00:48:01,580
even parts of the system in

1009
00:47:57,710 --> 00:48:03,410
a<font color="#E5E5E5"> few decades if it's</font><font color="#CCCCCC"> a if</font><font color="#E5E5E5"> it was</font>

1010
00:48:01,580 --> 00:48:05,690
something<font color="#CCCCCC"> like my laptop which gets out</font>

1011
00:48:03,410 --> 00:48:07,339
there updated every two years there was

1012
00:48:05,690 --> 00:48:09,140
no<font color="#E5E5E5"> problem</font><font color="#CCCCCC"> for two years</font><font color="#E5E5E5"> I'll just</font>

1013
00:48:07,339 --> 00:48:11,240
somehow bear with it and after that I'll

1014
00:48:09,140 --> 00:48:14,210
get<font color="#CCCCCC"> a new secure SCADA system but that's</font>

1015
00:48:11,240 --> 00:48:17,390
not the issue here SCADA systems are

1016
00:48:14,210 --> 00:48:20,180
meant to last for decades it's difficult

1017
00:48:17,390 --> 00:48:24,470
and costly to upgrade even parts of the

1018
00:48:20,180 --> 00:48:28,160
system this<font color="#E5E5E5"> is what we just talked no</font>

1019
00:48:24,470 --> 00:48:30,200
testing guidance from vendors some

1020
00:48:28,160 --> 00:48:33,259
<font color="#E5E5E5">systems are even managed by vendors so</font>

1021
00:48:30,200 --> 00:48:35,810
if as security consultants you go to a

1022
00:48:33,260 --> 00:48:38,390
pen tester system or you go to<font color="#E5E5E5"> the</font>

1023
00:48:35,810 --> 00:48:40,279
scanner system you see<font color="#CCCCCC"> oh it's a windows</font>

1024
00:48:38,390 --> 00:48:42,259
box our windows we have seen<font color="#E5E5E5"> windows</font>

1025
00:48:40,280 --> 00:48:44,990
many times what give us the credentials

1026
00:48:42,260 --> 00:48:46,490
and we'll tell you how it's doing they

1027
00:48:44,990 --> 00:48:50,629
don't have the credentials because<font color="#E5E5E5"> it's</font>

1028
00:48:46,490 --> 00:48:53,149
managed by their vendor there are other

1029
00:48:50,630 --> 00:48:54,560
systems in this network the master

1030
00:48:53,150 --> 00:48:56,900
<font color="#CCCCCC">network which has basically data</font>

1031
00:48:54,560 --> 00:48:59,839
historians which stores all<font color="#CCCCCC"> the others</font>

1032
00:48:56,900 --> 00:49:01,700
that are happening they are also nothing

1033
00:48:59,839 --> 00:49:04,460
but you are off the shelf databases

1034
00:49:01,700 --> 00:49:07,040
<font color="#E5E5E5">Oracle my sequel ms</font><font color="#CCCCCC"> equals things like</font>

1035
00:49:04,460 --> 00:49:13,359
that and they are<font color="#E5E5E5"> also susceptible to</font>

1036
00:49:07,040 --> 00:49:15,680
the same patching loop which we just<font color="#E5E5E5"> saw</font>

1037
00:49:13,359 --> 00:49:20,630
now<font color="#E5E5E5"> this is something interesting there</font>

1038
00:49:15,680 --> 00:49:23,149
in almost<font color="#E5E5E5"> all instances we saw when we</font>

1039
00:49:20,630 --> 00:49:25,760
go in we go in from the eyeties

1040
00:49:23,150 --> 00:49:27,920
perspective so some manager in ID says

1041
00:49:25,760 --> 00:49:30,950
okay let's try<font color="#CCCCCC"> qualis on our scalar</font>

1042
00:49:27,920 --> 00:49:33,589
<font color="#CCCCCC">network they bring us</font><font color="#E5E5E5"> in and then there</font>

1043
00:49:30,950 --> 00:49:35,390
are needs SCADA engineers or system

1044
00:49:33,589 --> 00:49:37,820
engineers who manage this system<font color="#E5E5E5"> and</font>

1045
00:49:35,390 --> 00:49:39,500
they<font color="#CCCCCC"> never get along and initially</font><font color="#E5E5E5"> we</font>

1046
00:49:37,820 --> 00:49:41,570
thought<font color="#E5E5E5"> that okay fine this is just</font>

1047
00:49:39,500 --> 00:49:45,440
<font color="#E5E5E5">something human beings don't get along</font>

1048
00:49:41,570 --> 00:49:47,480
not a new thing but when<font color="#E5E5E5"> you obsolete in</font>

1049
00:49:45,440 --> 00:49:49,460
each<font color="#E5E5E5"> and every instance what has what</font>

1050
00:49:47,480 --> 00:49:52,369
had happened in most of the cases was

1051
00:49:49,460 --> 00:49:55,070
that some IT engineer without really

1052
00:49:52,369 --> 00:49:56,780
understanding what the system is because

1053
00:49:55,070 --> 00:49:59,510
he had a piece of paper from<font color="#E5E5E5"> his</font>

1054
00:49:56,780 --> 00:50:02,119
management idea ago and secure SCADA

1055
00:49:59,510 --> 00:50:04,700
system ran a blind scan on the SCADA

1056
00:50:02,119 --> 00:50:06,800
system these<font color="#E5E5E5"> systems are very fragile</font>

1057
00:50:04,700 --> 00:50:09,290
they have very less processing power

1058
00:50:06,800 --> 00:50:10,070
many of those<font color="#CCCCCC"> plc's if they see a packet</font>

1059
00:50:09,290 --> 00:50:11,810
that they<font color="#E5E5E5"> don't know</font>

1060
00:50:10,070 --> 00:50:14,240
off if you<font color="#E5E5E5"> just ping them they will fall</font>

1061
00:50:11,810 --> 00:50:18,259
down because<font color="#E5E5E5"> they don't they were not</font>

1062
00:50:14,240 --> 00:50:22,430
designed to receive unexpected packets

1063
00:50:18,260 --> 00:50:25,610
as simple as a ping packet and because

1064
00:50:22,430 --> 00:50:29,089
of this the system engineers say that oh

1065
00:50:25,610 --> 00:50:31,730
you because of your scanning you<font color="#E5E5E5"> I had</font>

1066
00:50:29,090 --> 00:50:33,230
like a few hours<font color="#E5E5E5"> of downtime in my</font>

1067
00:50:31,730 --> 00:50:36,170
factory floor you are never going to

1068
00:50:33,230 --> 00:50:40,310
scan<font color="#CCCCCC"> my system again and this difference</font>

1069
00:50:36,170 --> 00:50:42,980
between<font color="#CCCCCC"> itn system engineers basically</font>

1070
00:50:40,310 --> 00:50:46,070
lead to the system being left unsecured

1071
00:50:42,980 --> 00:50:48,680
so if you are an IT person if<font color="#CCCCCC"> you have</font>

1072
00:50:46,070 --> 00:50:51,110
the task to scan a<font color="#E5E5E5"> SCADA system first</font>

1073
00:50:48,680 --> 00:50:53,839
really know what you are scanning ask

1074
00:50:51,110 --> 00:50:56,240
your vendor if their tool has ever

1075
00:50:53,840 --> 00:50:58,790
scanned this type of a skate or software

1076
00:50:56,240 --> 00:51:00,560
before and is it safe to do it and even

1077
00:50:58,790 --> 00:51:03,470
if the vendor says that it's safe to do

1078
00:51:00,560 --> 00:51:05,660
we do it when there is a maintenance

1079
00:51:03,470 --> 00:51:07,730
window like every factory or industry

1080
00:51:05,660 --> 00:51:10,549
afloat has a few hour of maintenance

1081
00:51:07,730 --> 00:51:12,680
once every quarter or once every month

1082
00:51:10,550 --> 00:51:15,580
to<font color="#CCCCCC"> clean up all the parts or things like</font>

1083
00:51:12,680 --> 00:51:18,680
that so taking that a portion you do it

1084
00:51:15,580 --> 00:51:20,420
this is changing wrong<font color="#E5E5E5"> mentality i think</font>

1085
00:51:18,680 --> 00:51:24,470
Stuxnet has sort<font color="#E5E5E5"> of changed the</font>

1086
00:51:20,420 --> 00:51:28,370
mentality and brought scalar to scalar

1087
00:51:24,470 --> 00:51:30,439
security to the limelight so having a

1088
00:51:28,370 --> 00:51:32,900
<font color="#CCCCCC">strategy for a password policy access</font>

1089
00:51:30,440 --> 00:51:35,390
control would help

1090
00:51:32,900 --> 00:51:39,170
having a<font color="#CCCCCC"> strategy for software upgrades</font>

1091
00:51:35,390 --> 00:51:41,120
and patches would help having<font color="#CCCCCC"> a SCADA</font>

1092
00:51:39,170 --> 00:51:42,790
<font color="#E5E5E5">test environment would help and again</font>

1093
00:51:41,120 --> 00:51:45,710
this is very these are<font color="#E5E5E5"> very easy</font>

1094
00:51:42,790 --> 00:51:48,980
proposals easy for me to say they are

1095
00:51:45,710 --> 00:51:51,440
not by any<font color="#E5E5E5"> means or very easy for scada</font>

1096
00:51:48,980 --> 00:51:54,410
system owners because having a test

1097
00:51:51,440 --> 00:51:56,210
environment which mimics at least half

1098
00:51:54,410 --> 00:51:58,549
or forty percent of what the real system

1099
00:51:56,210 --> 00:52:00,380
<font color="#E5E5E5">does will cost you a lot of</font><font color="#CCCCCC"> money and</font>

1100
00:51:58,550 --> 00:52:02,930
<font color="#E5E5E5">getting those different approvals and</font>

1101
00:52:00,380 --> 00:52:04,910
getting a test system of if you any of

1102
00:52:02,930 --> 00:52:06,830
you maintain a SCADA system would know

1103
00:52:04,910 --> 00:52:08,930
<font color="#CCCCCC">that there are very few people who have</font>

1104
00:52:06,830 --> 00:52:11,180
actually a test system where you can

1105
00:52:08,930 --> 00:52:13,879
<font color="#E5E5E5">test out your patches or you can test</font>

1106
00:52:11,180 --> 00:52:17,060
out things before applying to the<font color="#CCCCCC"> SCADA</font>

1107
00:52:13,880 --> 00:52:20,110
<font color="#CCCCCC">Network</font><font color="#E5E5E5"> mmm demand from your SCADA</font>

1108
00:52:17,060 --> 00:52:22,940
vendors that they expedite testing of

1109
00:52:20,110 --> 00:52:24,500
various patches and say that<font color="#E5E5E5"> okay this</font>

1110
00:52:22,940 --> 00:52:27,260
patch it's safe to apply go ahead and

1111
00:52:24,500 --> 00:52:31,460
apply<font color="#CCCCCC"> it so that things are not hosts</font>

1112
00:52:27,260 --> 00:52:34,910
are not left unpatched demand secure

1113
00:52:31,460 --> 00:52:36,470
protocols and also not just demanded

1114
00:52:34,910 --> 00:52:38,839
from your vendors but make sure that<font color="#CCCCCC"> you</font>

1115
00:52:36,470 --> 00:52:42,109
<font color="#E5E5E5">are running secure protocols because we</font>

1116
00:52:38,840 --> 00:52:45,620
have seen way too many times<font color="#E5E5E5"> in SCADA or</font>

1117
00:52:42,110 --> 00:52:47,930
even in our regular ite sort of network

1118
00:52:45,620 --> 00:52:50,029
is<font color="#E5E5E5"> that</font><font color="#CCCCCC"> okay your systems run all the</font>

1119
00:52:47,930 --> 00:52:52,220
latest and greatest secure protocols or

1120
00:52:50,030 --> 00:52:54,110
they have those protocols but they are

1121
00:52:52,220 --> 00:52:56,720
not<font color="#CCCCCC"> enabled so even though you have the</font>

1122
00:52:54,110 --> 00:52:58,880
security np3 still the communication

1123
00:52:56,720 --> 00:53:01,609
it's happening just in<font color="#CCCCCC"> the env3 it's not</font>

1124
00:52:58,880 --> 00:53:03,320
just a<font color="#CCCCCC"> check box on paper saying that ok</font>

1125
00:53:01,610 --> 00:53:07,340
<font color="#CCCCCC">i have secure protocol but it has to be</font>

1126
00:53:03,320 --> 00:53:09,410
running and generally apply your since

1127
00:53:07,340 --> 00:53:11,860
SCADA systems are starting<font color="#CCCCCC"> to look more</font>

1128
00:53:09,410 --> 00:53:14,600
and more like usual IT systems with

1129
00:53:11,860 --> 00:53:17,900
off-the-shelf operating systems<font color="#CCCCCC"> excel RS</font>

1130
00:53:14,600 --> 00:53:20,600
linux windows apply your<font color="#E5E5E5"> experience from</font>

1131
00:53:17,900 --> 00:53:22,640
your IT network management and security

1132
00:53:20,600 --> 00:53:26,299
to skate our system that<font color="#E5E5E5"> i think will</font>

1133
00:53:22,640 --> 00:53:28,520
will go a long way auditing and training

1134
00:53:26,300 --> 00:53:32,480
<font color="#E5E5E5">patriotic scanning of these systems will</font>

1135
00:53:28,520 --> 00:53:34,940
also work so finally last slide this is

1136
00:53:32,480 --> 00:53:37,820
the tool that we are releasing its

1137
00:53:34,940 --> 00:53:40,970
called SCADA scan it's in the<font color="#E5E5E5"> alpha</font>

1138
00:53:37,820 --> 00:53:43,670
version it<font color="#CCCCCC"> currently works on Modbus</font>

1139
00:53:40,970 --> 00:53:48,200
dnp3<font color="#E5E5E5"> in the beta version we</font>

1140
00:53:43,670 --> 00:53:50,690
to write signatures to identify master

1141
00:53:48,200 --> 00:53:52,520
vulnerability threats and in the final

1142
00:53:50,690 --> 00:53:55,280
<font color="#CCCCCC">version we want user-configurable</font>

1143
00:53:52,520 --> 00:53:57,680
signatures because at the end of the day

1144
00:53:55,280 --> 00:53:59,569
we as a vendor or no one is going to see

1145
00:53:57,680 --> 00:54:01,819
all type of SCADA systems because there

1146
00:53:59,569 --> 00:54:04,190
is a<font color="#E5E5E5"> lot of diversity so if the</font>

1147
00:54:01,819 --> 00:54:06,290
<font color="#E5E5E5">community comes together and uploads</font>

1148
00:54:04,190 --> 00:54:07,809
their fingerprints or run the tool<font color="#CCCCCC"> and</font>

1149
00:54:06,290 --> 00:54:10,308
uploads their fingerprint to the<font color="#E5E5E5"> tool</font>

1150
00:54:07,809 --> 00:54:13,940
that<font color="#E5E5E5"> would go a long way and that's the</font>

1151
00:54:10,309 --> 00:54:16,400
<font color="#E5E5E5">ultimate goal</font><font color="#CCCCCC"> of this too so where to</font>

1152
00:54:13,940 --> 00:54:20,839
find this tube that's<font color="#E5E5E5"> the link for the</font>

1153
00:54:16,400 --> 00:54:25,329
two I also tweet a lot of updates about

1154
00:54:20,839 --> 00:54:27,589
the tool as<font color="#CCCCCC"> well as a lot of security</font>

1155
00:54:25,329 --> 00:54:31,549
incidents that are happening so if you

1156
00:54:27,589 --> 00:54:33,980
follow me on<font color="#CCCCCC"> Twitter that you could</font><font color="#E5E5E5"> get</font>

1157
00:54:31,549 --> 00:54:37,329
updates about the tool and finally there

1158
00:54:33,980 --> 00:54:42,710
<font color="#CCCCCC">are some blogs here which would describe</font>

1159
00:54:37,329 --> 00:54:44,869
which adds security implications for

1160
00:54:42,710 --> 00:54:46,760
scada system or how to secure your SCADA

1161
00:54:44,869 --> 00:54:49,160
systems there is a blog called as some

1162
00:54:46,760 --> 00:54:53,030
six sins of SCADA systems and a lot of

1163
00:54:49,160 --> 00:54:56,930
<font color="#E5E5E5">other good security related original</font>

1164
00:54:53,030 --> 00:54:59,180
blogs here so with that a great thank

1165
00:54:56,930 --> 00:55:01,660
<font color="#E5E5E5">you and I'll open this up for any</font>

1166
00:54:59,180 --> 00:55:01,660
questions

1167
00:55:11,550 --> 00:55:30,300
I can hear you no we didn't did we

1168
00:55:27,420 --> 00:55:32,670
didn't investigate more we did try<font color="#E5E5E5"> to</font>

1169
00:55:30,300 --> 00:55:34,470
contact some of them or try to find whom

1170
00:55:32,670 --> 00:55:37,830
they belong<font color="#CCCCCC"> to so that we could contact</font>

1171
00:55:34,470 --> 00:55:41,790
<font color="#E5E5E5">them but that was that was the</font>

1172
00:55:37,830 --> 00:55:45,360
investigating or we didn't try to find

1173
00:55:41,790 --> 00:55:48,450
anyone<font color="#E5E5E5"> or abilities because I mean these</font>

1174
00:55:45,360 --> 00:55:51,000
are<font color="#E5E5E5"> SCADA host we don't want to for our</font>

1175
00:55:48,450 --> 00:55:54,620
pen testing purpose maybe bring them

1176
00:55:51,000 --> 00:55:57,540
down and we know<font color="#E5E5E5"> they are very fragile</font>

1177
00:55:54,620 --> 00:55:58,859
there were some I mean<font color="#E5E5E5"> not in</font><font color="#CCCCCC"> the</font>

1178
00:55:57,540 --> 00:56:00,930
<font color="#E5E5E5">showdown instance but in some other</font>

1179
00:55:58,860 --> 00:56:03,090
instance when we asked like why are<font color="#CCCCCC"> your</font>

1180
00:56:00,930 --> 00:56:04,740
<font color="#CCCCCC">sked a host connected to the Internet I</font>

1181
00:56:03,090 --> 00:56:07,800
mean some of the answers that we

1182
00:56:04,740 --> 00:56:10,080
received where that<font color="#E5E5E5"> let's say it's a</font>

1183
00:56:07,800 --> 00:56:12,780
electrical system they said<font color="#E5E5E5"> that we want</font>

1184
00:56:10,080 --> 00:56:15,480
<font color="#CCCCCC">to tell our customers where the Power</font>

1185
00:56:12,780 --> 00:56:18,990
has<font color="#CCCCCC"> been shut down or they're in some</font>

1186
00:56:15,480 --> 00:56:20,850
sort of emergency and I mean I see

1187
00:56:18,990 --> 00:56:23,040
<font color="#E5E5E5">already a lot of smiles on your faces is</font>

1188
00:56:20,850 --> 00:56:25,020
like you can do that a lot more securely

1189
00:56:23,040 --> 00:56:27,000
than just connecting the whole thing<font color="#E5E5E5"> to</font>

1190
00:56:25,020 --> 00:56:30,060
the internet and in<font color="#E5E5E5"> saying that okay now</font>

1191
00:56:27,000 --> 00:56:41,550
my customers can see accurately what's

1192
00:56:30,060 --> 00:56:45,900
happening so yeah thank<font color="#E5E5E5"> you are you</font>

1193
00:56:41,550 --> 00:56:48,480
seeing a lot of modbus over tcp/ip

1194
00:56:45,900 --> 00:56:50,730
because in my experience the rap of the

1195
00:56:48,480 --> 00:56:53,280
TTIP is not very reliable in a

1196
00:56:50,730 --> 00:56:57,360
production environment it's not reliable

1197
00:56:53,280 --> 00:57:00,360
I agree to that over the over tcp/ip but

1198
00:56:57,360 --> 00:57:02,760
we do see some instances of morbus

1199
00:57:00,360 --> 00:57:07,380
typically in smaller systems industrial

1200
00:57:02,760 --> 00:57:10,320
control systems over over tcp/ip but you

1201
00:57:07,380 --> 00:57:12,930
are right a lot of systems that we see

1202
00:57:10,320 --> 00:57:18,150
for Marvel's are non tcp/ip systems as

1203
00:57:12,930 --> 00:57:21,720
well yeah okay I<font color="#CCCCCC"> think we have to</font><font color="#E5E5E5"> have</font>

1204
00:57:18,150 --> 00:57:26,550
for one more all<font color="#CCCCCC"> right one more any</font>

1205
00:57:21,720 --> 00:57:30,169
other questions<font color="#E5E5E5"> okay oh all right thank</font>

1206
00:57:26,550 --> 00:57:30,170
<font color="#E5E5E5">you with damn thank you very much</font>

