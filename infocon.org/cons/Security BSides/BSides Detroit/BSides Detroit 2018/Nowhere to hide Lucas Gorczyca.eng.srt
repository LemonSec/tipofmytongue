1
00:00:00,000 --> 00:00:10,139
<font color="#E5E5E5">um</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> hello everyone my name is</font>

2
00:00:07,140 --> 00:00:14,759
<font color="#CCCCCC">Luke Corsica</font><font color="#E5E5E5"> my presentation is nowhere</font>

3
00:00:10,139 --> 00:00:16,470
<font color="#CCCCCC">to</font><font color="#E5E5E5"> hide</font><font color="#CCCCCC"> a look at</font><font color="#E5E5E5"> Network forensics</font><font color="#CCCCCC"> so a</font>

4
00:00:14,759 --> 00:00:18,330
little<font color="#E5E5E5"> bit about me I'm a native to</font>

5
00:00:16,470 --> 00:00:20,939
Jackson Michigan<font color="#CCCCCC"> I live</font><font color="#E5E5E5"> right here in</font>

6
00:00:18,330 --> 00:00:23,130
<font color="#E5E5E5">the</font><font color="#CCCCCC"> area I work</font><font color="#E5E5E5"> for an energy company</font>

7
00:00:20,939 --> 00:00:26,369
<font color="#E5E5E5">they didn't specifically sponsor my talk</font>

8
00:00:23,130 --> 00:00:28,710
<font color="#E5E5E5">so</font><font color="#CCCCCC"> I don't want</font><font color="#E5E5E5"> to say who but I'd work</font>

9
00:00:26,369 --> 00:00:30,720
<font color="#E5E5E5">for an energy</font><font color="#CCCCCC"> company in Michigan I do</font>

10
00:00:28,710 --> 00:00:33,930
mostly system<font color="#E5E5E5"> administration system</font>

11
00:00:30,720 --> 00:00:38,910
engineering<font color="#E5E5E5"> type work</font><font color="#CCCCCC"> I don't work</font><font color="#E5E5E5"> in</font>

12
00:00:33,930 --> 00:00:42,090
security<font color="#CCCCCC"> i working on servers and</font><font color="#E5E5E5"> that</font>

13
00:00:38,910 --> 00:00:45,269
kind of fun<font color="#CCCCCC"> stuff so it</font><font color="#E5E5E5"> forensics is a</font>

14
00:00:42,090 --> 00:00:47,570
hobby of<font color="#CCCCCC"> mine</font><font color="#E5E5E5"> i like memory forensics</font>

15
00:00:45,270 --> 00:00:50,160
<font color="#E5E5E5">network forensics and malware analysis</font>

16
00:00:47,570 --> 00:00:52,260
so i all<font color="#E5E5E5"> this is just stuff</font><font color="#CCCCCC"> i've</font><font color="#E5E5E5"> learned</font>

17
00:00:50,160 --> 00:00:55,019
on my own<font color="#E5E5E5"> time</font><font color="#CCCCCC"> this is something</font><font color="#E5E5E5"> i do at</font>

18
00:00:52,260 --> 00:01:01,739
<font color="#E5E5E5">work so i'm by no means an</font><font color="#CCCCCC"> expert on the</font>

19
00:00:55,020 --> 00:01:02,850
subject<font color="#CCCCCC"> so this is the</font><font color="#E5E5E5"> reason</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> says</font><font color="#CCCCCC"> i</font>

20
00:01:01,739 --> 00:01:05,759
want<font color="#CCCCCC"> you to take this with a grain of</font>

21
00:01:02,850 --> 00:01:08,159
salt<font color="#CCCCCC"> it's not like I've perfected</font><font color="#E5E5E5"> this</font>

22
00:01:05,760 --> 00:01:12,060
at a company<font color="#E5E5E5"> doing work this is more</font>

23
00:01:08,159 --> 00:01:14,130
just my own interest so if you were

24
00:01:12,060 --> 00:01:15,600
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> this at your company</font><font color="#CCCCCC"> I can</font>

25
00:01:14,130 --> 00:01:18,990
give you some<font color="#E5E5E5"> good information</font><font color="#CCCCCC"> but it's</font>

26
00:01:15,600 --> 00:01:21,839
<font color="#CCCCCC">not gonna</font><font color="#E5E5E5"> be the well all you know total</font>

27
00:01:18,990 --> 00:01:25,740
solution<font color="#E5E5E5"> and for the pictures on there</font>

28
00:01:21,840 --> 00:01:27,479
the<font color="#CCCCCC"> polish symbol there is my Twitter</font>

29
00:01:25,740 --> 00:01:30,229
picture so if you want to<font color="#CCCCCC"> look me up</font>

30
00:01:27,479 --> 00:01:34,110
they'll help you<font color="#E5E5E5"> find me a little easier</font>

31
00:01:30,229 --> 00:01:35,610
a couple quick disclaimers<font color="#E5E5E5"> I am not</font>

32
00:01:34,110 --> 00:01:38,729
<font color="#CCCCCC">endorsing any of the tools software</font>

33
00:01:35,610 --> 00:01:40,020
organizations etc involved in this the

34
00:01:38,729 --> 00:01:42,060
tools are<font color="#CCCCCC"> just the</font><font color="#E5E5E5"> ones I like to use</font>

35
00:01:40,020 --> 00:01:44,869
<font color="#CCCCCC">they're not the only</font><font color="#E5E5E5"> tools available I'm</font>

36
00:01:42,060 --> 00:01:47,460
not supporting anything<font color="#E5E5E5"> in</font><font color="#CCCCCC"> particular</font>

37
00:01:44,869 --> 00:01:50,100
<font color="#CCCCCC">scenario</font><font color="#E5E5E5"> was something I made myself I</font>

38
00:01:47,460 --> 00:01:53,130
set<font color="#CCCCCC"> up all the files it's not based</font><font color="#E5E5E5"> on</font>

39
00:01:50,100 --> 00:01:55,408
any<font color="#E5E5E5"> organization</font><font color="#CCCCCC"> real</font><font color="#E5E5E5"> life occurrence</font>

40
00:01:53,130 --> 00:01:56,908
any famous hacks or anything any

41
00:01:55,409 --> 00:01:58,409
similarity to<font color="#CCCCCC"> any actual person</font>

42
00:01:56,909 --> 00:02:00,570
organization<font color="#CCCCCC"> event it's purely</font>

43
00:01:58,409 --> 00:02:03,540
coincidental<font color="#CCCCCC"> I made up the</font><font color="#E5E5E5"> name of</font><font color="#CCCCCC"> the</font>

44
00:02:00,570 --> 00:02:04,740
<font color="#E5E5E5">company</font><font color="#CCCCCC"> I just random so if there</font><font color="#E5E5E5"> is</font>

45
00:02:03,540 --> 00:02:06,090
actually a company<font color="#CCCCCC"> out there</font><font color="#E5E5E5"> at that</font>

46
00:02:04,740 --> 00:02:09,359
name I apologize though it's<font color="#E5E5E5"> not my</font>

47
00:02:06,090 --> 00:02:11,700
intent and<font color="#E5E5E5"> finally all the ideas</font>

48
00:02:09,360 --> 00:02:13,069
opinions<font color="#E5E5E5"> etc are my own and should not</font>

49
00:02:11,700 --> 00:02:18,310
<font color="#CCCCCC">be</font><font color="#E5E5E5"> considered that of my</font>

50
00:02:13,069 --> 00:02:21,260
employer<font color="#E5E5E5"> so Network forensics what is it</font>

51
00:02:18,310 --> 00:02:23,810
<font color="#CCCCCC">Network forensics is this</font><font color="#E5E5E5"> is a lot of</font>

52
00:02:21,260 --> 00:02:25,849
different ways<font color="#CCCCCC"> to define it I</font><font color="#E5E5E5"> personally</font>

53
00:02:23,810 --> 00:02:27,980
like to<font color="#E5E5E5"> think of it just as observing</font>

54
00:02:25,849 --> 00:02:30,980
network traffic<font color="#E5E5E5"> to determine what</font>

55
00:02:27,980 --> 00:02:32,439
occurred on<font color="#E5E5E5"> that network so</font><font color="#CCCCCC"> you might</font>

56
00:02:30,980 --> 00:02:35,890
have a capture<font color="#E5E5E5"> my look at it</font><font color="#CCCCCC"> live</font>

57
00:02:32,439 --> 00:02:37,790
<font color="#E5E5E5">captures the easiest way to do it and</font>

58
00:02:35,890 --> 00:02:40,220
you're just<font color="#CCCCCC"> gonna look</font><font color="#E5E5E5"> at the traffic</font>

59
00:02:37,790 --> 00:02:42,469
<font color="#E5E5E5">determine who talked to who why were</font>

60
00:02:40,220 --> 00:02:44,989
they talking<font color="#CCCCCC"> to what</font><font color="#E5E5E5"> where they send in</font>

61
00:02:42,469 --> 00:02:47,450
what were they doing<font color="#CCCCCC"> there are some</font>

62
00:02:44,989 --> 00:02:49,159
<font color="#E5E5E5">subcategories</font><font color="#CCCCCC"> that gets broken into</font><font color="#E5E5E5"> this</font>

63
00:02:47,450 --> 00:02:51,790
is more academic he doesn't<font color="#E5E5E5"> really apply</font>

64
00:02:49,159 --> 00:02:54,349
<font color="#E5E5E5">to actually</font><font color="#CCCCCC"> doing</font><font color="#E5E5E5"> it</font>

65
00:02:51,790 --> 00:02:58,939
protocol analysis is looking at the

66
00:02:54,349 --> 00:03:01,879
individual protocols<font color="#E5E5E5"> and the the numbers</font>

67
00:02:58,939 --> 00:03:07,569
of<font color="#E5E5E5"> data that represent different</font><font color="#CCCCCC"> parts</font>

68
00:03:01,879 --> 00:03:10,010
<font color="#CCCCCC">of the individual protocols so like HTTP</font>

69
00:03:07,569 --> 00:03:11,988
<font color="#E5E5E5">you know is it a</font><font color="#CCCCCC"> git command as a post</font>

70
00:03:10,010 --> 00:03:14,480
command<font color="#CCCCCC"> what's happening within that</font>

71
00:03:11,989 --> 00:03:17,269
specific<font color="#E5E5E5"> protocol to determine what's</font>

72
00:03:14,480 --> 00:03:19,638
<font color="#E5E5E5">going on packet analysis looks more at</font>

73
00:03:17,269 --> 00:03:23,599
the packet as a whole including<font color="#E5E5E5"> IP</font>

74
00:03:19,639 --> 00:03:26,479
addresses MAC addresses<font color="#E5E5E5"> size that kind</font>

75
00:03:23,599 --> 00:03:28,250
<font color="#E5E5E5">of thing and then flow analysis is the</font>

76
00:03:26,479 --> 00:03:31,190
conversation<font color="#E5E5E5"> who's talking to who where</font>

77
00:03:28,250 --> 00:03:32,629
is the data<font color="#E5E5E5"> going volume of data is one</font>

78
00:03:31,190 --> 00:03:35,299
person sending<font color="#E5E5E5"> a lot of stuff</font><font color="#CCCCCC"> to much</font>

79
00:03:32,629 --> 00:03:36,409
people<font color="#E5E5E5"> is that</font><font color="#CCCCCC"> one-on-one is it</font><font color="#E5E5E5"> a lot of</font>

80
00:03:35,299 --> 00:03:38,120
data one-way<font color="#E5E5E5"> not a lot the</font><font color="#CCCCCC"> other</font>

81
00:03:36,409 --> 00:03:40,819
direction is it back and forth this is

82
00:03:38,120 --> 00:03:41,959
<font color="#E5E5E5">sporadic</font><font color="#CCCCCC"> that kind of thing that</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font>

83
00:03:40,819 --> 00:03:45,078
gives<font color="#E5E5E5"> you a good</font><font color="#CCCCCC"> idea of what's</font>

84
00:03:41,959 --> 00:03:46,340
occurring on the network who<font color="#E5E5E5"> is why are</font>

85
00:03:45,079 --> 00:03:50,750
they talking<font color="#E5E5E5"> to who and what type of</font>

86
00:03:46,340 --> 00:03:53,090
<font color="#E5E5E5">data might they be sending how do you do</font>

87
00:03:50,750 --> 00:03:55,760
<font color="#E5E5E5">it you generally you have</font><font color="#CCCCCC"> to have</font>

88
00:03:53,090 --> 00:03:57,319
there's a couple<font color="#E5E5E5"> tools that need the</font>

89
00:03:55,760 --> 00:03:59,599
tools to do different things first you

90
00:03:57,319 --> 00:04:02,569
have to<font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to capture the network</font>

91
00:03:59,599 --> 00:04:04,429
data<font color="#CCCCCC"> Wireshark</font><font color="#E5E5E5"> TCP dump are great for</font>

92
00:04:02,569 --> 00:04:07,179
<font color="#E5E5E5">that there's a lot of tools so I'm not</font>

93
00:04:04,430 --> 00:04:09,680
<font color="#CCCCCC">trying to focus</font><font color="#E5E5E5"> on these necessarily but</font>

94
00:04:07,180 --> 00:04:11,299
you<font color="#CCCCCC"> just have</font><font color="#E5E5E5"> to capture the data so</font>

95
00:04:09,680 --> 00:04:12,409
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you can look at it then you</font>

96
00:04:11,299 --> 00:04:15,379
<font color="#E5E5E5">actually have to look at it need to</font>

97
00:04:12,409 --> 00:04:17,238
analyze<font color="#CCCCCC"> why your sharks again a good</font>

98
00:04:15,379 --> 00:04:19,459
tool for<font color="#E5E5E5"> that</font><font color="#CCCCCC"> network miner is really</font>

99
00:04:17,238 --> 00:04:21,649
handy and<font color="#E5E5E5"> there there's a lot of tools</font>

100
00:04:19,459 --> 00:04:23,889
out<font color="#E5E5E5"> there so this is</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> meant to be you</font>

101
00:04:21,649 --> 00:04:26,609
know<font color="#E5E5E5"> an</font><font color="#CCCCCC"> actual list</font><font color="#E5E5E5"> just some examples</font>

102
00:04:23,889 --> 00:04:28,379
they make specialized tools so there's a

103
00:04:26,610 --> 00:04:32,300
cool<font color="#E5E5E5"> people in this industry</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> work on</font>

104
00:04:28,379 --> 00:04:35,460
this<font color="#E5E5E5"> so things like TCP flow TCP extract</font>

105
00:04:32,300 --> 00:04:38,340
<font color="#E5E5E5">TCP extract automatically carves files</font>

106
00:04:35,460 --> 00:04:40,888
from TCP<font color="#E5E5E5"> streams so that</font><font color="#CCCCCC"> was pretty</font><font color="#E5E5E5"> cool</font>

107
00:04:38,340 --> 00:04:43,049
there's<font color="#E5E5E5"> a there's endless endless number</font>

108
00:04:40,889 --> 00:04:45,479
<font color="#E5E5E5">of tools so if you're</font><font color="#CCCCCC"> interested</font><font color="#E5E5E5"> you</font>

109
00:04:43,050 --> 00:04:48,629
<font color="#CCCCCC">know this</font><font color="#E5E5E5"> github is a good place to</font><font color="#CCCCCC"> look</font>

110
00:04:45,479 --> 00:04:50,460
at him and local tools on systems

111
00:04:48,629 --> 00:04:52,909
involved can sometimes be useful<font color="#E5E5E5"> if you</font>

112
00:04:50,460 --> 00:04:57,840
need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> you can ping something</font>

113
00:04:52,909 --> 00:05:00,569
<font color="#CCCCCC">some of the inner like traceroute</font><font color="#E5E5E5"> do not</font>

114
00:04:57,840 --> 00:05:02,429
<font color="#E5E5E5">always best to use if you're trying not</font>

115
00:05:00,569 --> 00:05:03,689
<font color="#E5E5E5">to mess with the data that's occurring</font>

116
00:05:02,430 --> 00:05:07,439
if you don't want to interact<font color="#CCCCCC"> directly</font>

117
00:05:03,689 --> 00:05:09,180
with the<font color="#E5E5E5"> traffic but like netstat you</font>

118
00:05:07,439 --> 00:05:12,629
can<font color="#E5E5E5"> listen to you can see what they're</font>

119
00:05:09,180 --> 00:05:14,960
<font color="#E5E5E5">listening to ARP tables</font><font color="#CCCCCC"> you can also get</font>

120
00:05:12,629 --> 00:05:17,250
local logs from like switches routers

121
00:05:14,960 --> 00:05:20,489
<font color="#E5E5E5">those kind of things and then access</font>

122
00:05:17,250 --> 00:05:22,560
logs like on your network<font color="#CCCCCC"> or exchange</font>

123
00:05:20,490 --> 00:05:25,229
logs can also be very<font color="#E5E5E5"> handy even though</font>

124
00:05:22,560 --> 00:05:27,930
it's not<font color="#E5E5E5"> it's specifically a network</font>

125
00:05:25,229 --> 00:05:32,520
<font color="#E5E5E5">related thing and finally some non</font>

126
00:05:27,930 --> 00:05:34,409
network tools like hex editors is a good

127
00:05:32,520 --> 00:05:38,089
example<font color="#E5E5E5"> we're actually gonna use that an</font>

128
00:05:34,409 --> 00:05:40,740
example<font color="#CCCCCC"> today and the techniques on how</font>

129
00:05:38,089 --> 00:05:43,199
one big piece<font color="#E5E5E5"> of</font><font color="#CCCCCC"> advice that</font><font color="#E5E5E5"> can say is</font>

130
00:05:40,740 --> 00:05:45,029
<font color="#E5E5E5">to know the protocols you know it when</font>

131
00:05:43,199 --> 00:05:46,020
you<font color="#E5E5E5"> just start out you're really you're</font>

132
00:05:45,029 --> 00:05:47,699
not going<font color="#E5E5E5"> to know them very well you</font>

133
00:05:46,020 --> 00:05:51,359
have<font color="#E5E5E5"> to kind</font><font color="#CCCCCC"> of start looking</font><font color="#E5E5E5"> into it</font>

134
00:05:47,699 --> 00:05:53,729
<font color="#CCCCCC">but books on like</font><font color="#E5E5E5"> TCP how it works</font>

135
00:05:51,360 --> 00:05:57,240
Wikipedia gives<font color="#E5E5E5"> you a good breakdown</font><font color="#CCCCCC"> of</font>

136
00:05:53,729 --> 00:05:59,580
<font color="#E5E5E5">how the protocols themselves</font><font color="#CCCCCC"> and then to</font>

137
00:05:57,240 --> 00:06:01,650
just get some network traffic<font color="#E5E5E5"> and look</font>

138
00:05:59,580 --> 00:06:03,779
at it and then just study how the

139
00:06:01,650 --> 00:06:05,580
protocols work so you understand when

140
00:06:03,779 --> 00:06:08,969
you're looking at<font color="#E5E5E5"> it what's that normal</font>

141
00:06:05,580 --> 00:06:10,279
<font color="#E5E5E5">what's supposed to be there and</font><font color="#CCCCCC"> that</font>

142
00:06:08,969 --> 00:06:12,870
<font color="#E5E5E5">gives you a good understanding</font><font color="#CCCCCC"> of how it</font>

143
00:06:10,279 --> 00:06:14,310
<font color="#CCCCCC">operates</font><font color="#E5E5E5"> and choosing the right</font><font color="#CCCCCC"> tools</font>

144
00:06:12,870 --> 00:06:16,770
important you want<font color="#E5E5E5"> to pick</font><font color="#CCCCCC"> one that</font>

145
00:06:14,310 --> 00:06:18,839
<font color="#E5E5E5">works for you so just because Wireshark</font>

146
00:06:16,770 --> 00:06:20,818
<font color="#E5E5E5">it's a big one</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> very popular</font><font color="#CCCCCC"> but</font>

147
00:06:18,839 --> 00:06:25,020
that might<font color="#E5E5E5"> not</font><font color="#CCCCCC"> be something that's</font>

148
00:06:20,819 --> 00:06:26,759
<font color="#CCCCCC">really useful to</font><font color="#E5E5E5"> you and other than that</font>

149
00:06:25,020 --> 00:06:30,719
<font color="#E5E5E5">it's basically</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> looking at the data</font>

150
00:06:26,759 --> 00:06:32,969
<font color="#E5E5E5">and try</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> determine what it does so</font>

151
00:06:30,719 --> 00:06:34,229
most<font color="#E5E5E5"> people I'm sure here familiar with</font>

152
00:06:32,969 --> 00:06:36,639
encryption<font color="#CCCCCC"> I just wanted to do a quick</font>

153
00:06:34,229 --> 00:06:38,650
<font color="#E5E5E5">review because it's important</font><font color="#CCCCCC"> to</font>

154
00:06:36,639 --> 00:06:40,060
<font color="#CCCCCC">Network forensics in the sense of if</font>

155
00:06:38,650 --> 00:06:43,419
it's encrypted you can't look at it

156
00:06:40,060 --> 00:06:45,099
encryption is very useful for security<font color="#CCCCCC"> I</font>

157
00:06:43,419 --> 00:06:49,180
like having my<font color="#E5E5E5"> stuff encrypted when I</font>

158
00:06:45,099 --> 00:06:50,949
send it<font color="#E5E5E5"> but it's really hard to you know</font>

159
00:06:49,180 --> 00:06:53,620
it's<font color="#CCCCCC"> impossible</font><font color="#E5E5E5"> to look</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> let's</font>

160
00:06:50,949 --> 00:06:54,669
encrypt<font color="#E5E5E5"> didn't understand</font><font color="#CCCCCC"> that but</font><font color="#E5E5E5"> there</font>

161
00:06:53,620 --> 00:06:55,750
are<font color="#E5E5E5"> ways around it</font>

162
00:06:54,669 --> 00:06:57,878
because there's a difference<font color="#CCCCCC"> between</font>

163
00:06:55,750 --> 00:06:59,949
like<font color="#CCCCCC"> one-way ask to sell and two-way SSL</font>

164
00:06:57,879 --> 00:07:02,830
<font color="#E5E5E5">one way as to self you have</font><font color="#CCCCCC"> a private</font>

165
00:06:59,949 --> 00:07:06,099
key<font color="#CCCCCC"> of the exchange</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can decrypt it</font>

166
00:07:02,830 --> 00:07:08,080
<font color="#CCCCCC">and like a lot</font><font color="#E5E5E5"> of tools have plugins or</font>

167
00:07:06,099 --> 00:07:09,759
they're designed<font color="#E5E5E5"> to do that and you can</font>

168
00:07:08,080 --> 00:07:11,530
decrypt the traffic and look at it two

169
00:07:09,759 --> 00:07:13,719
ways<font color="#CCCCCC"> the different story</font>

170
00:07:11,530 --> 00:07:16,299
even if you have a key<font color="#CCCCCC"> SEC at hand</font><font color="#E5E5E5"> you</font>

171
00:07:13,719 --> 00:07:18,900
can do it<font color="#CCCCCC"> after the fact</font><font color="#E5E5E5"> it does that's</font>

172
00:07:16,300 --> 00:07:22,389
the<font color="#CCCCCC"> way it works and it's really</font><font color="#E5E5E5"> handy</font>

173
00:07:18,900 --> 00:07:25,239
the key<font color="#E5E5E5"> exchanges matter</font><font color="#CCCCCC"> - like RSA</font>

174
00:07:22,389 --> 00:07:26,889
<font color="#E5E5E5">there's a specific couple RSA exchanges</font>

175
00:07:25,240 --> 00:07:30,099
<font color="#E5E5E5">that can be decrypted within one way as</font>

176
00:07:26,889 --> 00:07:33,129
<font color="#CCCCCC">a cell</font><font color="#E5E5E5"> if it's diffie-hellman you're</font>

177
00:07:30,099 --> 00:07:34,930
done<font color="#CCCCCC"> but that makes</font><font color="#E5E5E5"> proxies really</font>

178
00:07:33,129 --> 00:07:36,460
useful<font color="#E5E5E5"> and this is where like if you're</font>

179
00:07:34,930 --> 00:07:39,250
<font color="#E5E5E5">gonna do if you want</font><font color="#CCCCCC"> to do a forensic</font>

180
00:07:36,460 --> 00:07:40,719
investigations at a company<font color="#CCCCCC"> proxies are</font>

181
00:07:39,250 --> 00:07:43,150
<font color="#E5E5E5">really</font><font color="#CCCCCC"> useful you</font><font color="#E5E5E5"> can set up a network</font>

182
00:07:40,719 --> 00:07:44,500
proxy then<font color="#CCCCCC"> decrypt the SSL you can</font>

183
00:07:43,150 --> 00:07:48,340
either have<font color="#CCCCCC"> that out put</font><font color="#E5E5E5"> it to the side</font>

184
00:07:44,500 --> 00:07:49,690
as decrypted<font color="#CCCCCC"> or like in the example I</font>

185
00:07:48,340 --> 00:07:51,549
did<font color="#E5E5E5"> I set it up so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the</font>

186
00:07:49,690 --> 00:07:54,219
communication between the proxy and the

187
00:07:51,550 --> 00:07:56,169
<font color="#E5E5E5">internal hosts is one way as to cell</font>

188
00:07:54,219 --> 00:07:59,650
<font color="#E5E5E5">that's decrypt a</font><font color="#CCCCCC"> ball but the two-way</font>

189
00:07:56,169 --> 00:08:01,539
SSL occurs on the<font color="#CCCCCC"> internet</font><font color="#E5E5E5"> so that way</font>

190
00:07:59,650 --> 00:08:04,239
you can intercept the traffic determine

191
00:08:01,539 --> 00:08:09,550
what it's doing and then it's still

192
00:08:04,240 --> 00:08:11,849
secure<font color="#E5E5E5"> going through public segments so</font>

193
00:08:09,550 --> 00:08:14,469
most<font color="#E5E5E5"> this talk is</font><font color="#CCCCCC"> gonna be a live demo</font>

194
00:08:11,849 --> 00:08:17,139
hopefully the demo<font color="#E5E5E5"> gods</font><font color="#CCCCCC"> liked the</font>

195
00:08:14,469 --> 00:08:21,039
sacrifice I<font color="#CCCCCC"> made</font><font color="#E5E5E5"> hopefully this goes</font>

196
00:08:17,139 --> 00:08:23,039
<font color="#E5E5E5">well but so here's a quick scenario that</font>

197
00:08:21,039 --> 00:08:25,960
<font color="#E5E5E5">I made up and we're gonna go</font><font color="#CCCCCC"> through it</font>

198
00:08:23,039 --> 00:08:28,360
<font color="#E5E5E5">Cydia is Fred an employee at solid water</font>

199
00:08:25,960 --> 00:08:30,159
<font color="#E5E5E5">solutions has shown some behavior</font>

200
00:08:28,360 --> 00:08:32,800
recently<font color="#E5E5E5"> that made his employer</font>

201
00:08:30,159 --> 00:08:34,539
concerned<font color="#E5E5E5"> he might be unhappy at work he</font>

202
00:08:32,799 --> 00:08:37,208
has access<font color="#E5E5E5"> to the company secret recipe</font>

203
00:08:34,539 --> 00:08:39,159
and some recent suspicious activity

204
00:08:37,208 --> 00:08:42,279
makes them<font color="#E5E5E5"> think that he's trying</font><font color="#CCCCCC"> to</font>

205
00:08:39,159 --> 00:08:44,260
<font color="#E5E5E5">steal the company's data as Network</font>

206
00:08:42,279 --> 00:08:46,870
investigator<font color="#E5E5E5"> you've been tasked to</font>

207
00:08:44,260 --> 00:08:50,580
examine what never<font color="#CCCCCC"> examined the traffic</font>

208
00:08:46,870 --> 00:08:54,040
and determine what he's been up<font color="#CCCCCC"> to</font>

209
00:08:50,580 --> 00:08:57,190
it's a quick piece<font color="#CCCCCC"> of information</font><font color="#E5E5E5"> going</font>

210
00:08:54,040 --> 00:08:57,819
<font color="#CCCCCC">forward they gave us in this scenario</font><font color="#E5E5E5"> we</font>

211
00:08:57,190 --> 00:09:02,320
have<font color="#E5E5E5"> Fred's</font>

212
00:08:57,820 --> 00:09:08,080
<font color="#E5E5E5">MAC address</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> local LAN is 192.168</font>

213
00:09:02,320 --> 00:09:11,950
<font color="#E5E5E5">to 17.0</font><font color="#CCCCCC"> / 24 the Gateway</font><font color="#E5E5E5"> is dot 254</font><font color="#CCCCCC"> and</font>

214
00:09:08,080 --> 00:09:14,320
it's running<font color="#E5E5E5"> an SSL decryption proxy the</font>

215
00:09:11,950 --> 00:09:17,680
certificate running on that proxy the

216
00:09:14,320 --> 00:09:22,270
key has<font color="#CCCCCC"> been given to</font><font color="#E5E5E5"> us and for the</font>

217
00:09:17,680 --> 00:09:23,939
sake of this scenario<font color="#E5E5E5"> 192 168 137 0/24</font>

218
00:09:22,270 --> 00:09:26,770
will represent the<font color="#CCCCCC"> Internet</font>

219
00:09:23,940 --> 00:09:30,340
because I didn't want<font color="#E5E5E5"> like actual public</font>

220
00:09:26,770 --> 00:09:32,710
<font color="#CCCCCC">Ivies going through this so we're gonna</font>

221
00:09:30,340 --> 00:09:34,210
and then in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> scenario a combination</font>

222
00:09:32,710 --> 00:09:36,580
of access logs and video surveillance

223
00:09:34,210 --> 00:09:38,860
<font color="#CCCCCC">has already shown</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> Fred</font><font color="#E5E5E5"> was at his</font>

224
00:09:36,580 --> 00:09:40,480
desk<font color="#E5E5E5"> logged into his computer so they</font>

225
00:09:38,860 --> 00:09:42,730
know everything<font color="#E5E5E5"> going on from Fred's</font>

226
00:09:40,480 --> 00:09:45,810
computer unless there<font color="#CCCCCC"> was malware was</font>

227
00:09:42,730 --> 00:09:45,810
<font color="#E5E5E5">Fred himself</font>

228
00:09:50,019 --> 00:09:57,889
it's gonna<font color="#E5E5E5"> pull up wireshark</font>

229
00:09:52,329 --> 00:10:00,739
and there's a lot<font color="#E5E5E5"> of traffic to</font><font color="#CCCCCC"> go</font>

230
00:09:57,889 --> 00:10:02,329
through but<font color="#E5E5E5"> so one</font><font color="#CCCCCC"> of the first things</font>

231
00:10:00,740 --> 00:10:07,220
you<font color="#CCCCCC"> want to do when you're investigating</font>

232
00:10:02,329 --> 00:10:11,180
<font color="#CCCCCC">is to look for anomalies so one thing</font>

233
00:10:07,220 --> 00:10:13,850
that<font color="#E5E5E5"> stands out with the</font><font color="#CCCCCC"> icmp paying is</font>

234
00:10:11,180 --> 00:10:18,138
the length of<font color="#E5E5E5"> this packet is 176 bytes</font>

235
00:10:13,850 --> 00:10:22,519
<font color="#E5E5E5">normally it should be about 74 76</font><font color="#CCCCCC"> so</font>

236
00:10:18,139 --> 00:10:24,740
that's abnormal<font color="#E5E5E5"> and so we might want</font><font color="#CCCCCC"> to</font>

237
00:10:22,519 --> 00:10:34,639
<font color="#E5E5E5">take a look at why is</font><font color="#CCCCCC"> that larger than</font>

238
00:10:24,740 --> 00:10:43,220
it<font color="#E5E5E5"> it should</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> and if we look at the</font>

239
00:10:34,639 --> 00:10:47,389
actual raw data<font color="#CCCCCC"> or</font><font color="#E5E5E5"> see some ASCII text</font>

240
00:10:43,220 --> 00:10:49,759
included in the data segment<font color="#CCCCCC"> seems to</font>

241
00:10:47,389 --> 00:10:52,819
spell out a little bit of a<font color="#E5E5E5"> message so</font>

242
00:10:49,759 --> 00:10:54,920
says hey shady dealer<font color="#CCCCCC"> its Fred</font><font color="#E5E5E5"> I'll do</font>

243
00:10:52,819 --> 00:10:57,769
the deal<font color="#CCCCCC"> the company</font><font color="#E5E5E5"> secret recipe for</font>

244
00:10:54,920 --> 00:11:00,649
<font color="#CCCCCC">the agreed 250,000</font><font color="#E5E5E5"> I'm uploading it to</font>

245
00:10:57,769 --> 00:11:04,790
<font color="#E5E5E5">your site now so right</font><font color="#CCCCCC"> off</font><font color="#E5E5E5"> this doesn't</font>

246
00:11:00,649 --> 00:11:08,209
<font color="#E5E5E5">look good for Fred he's mentioning his</font>

247
00:11:04,790 --> 00:11:12,949
name it came from his<font color="#E5E5E5"> computer if we go</font>

248
00:11:08,209 --> 00:11:16,790
back out here we can look there<font color="#E5E5E5"> you can</font>

249
00:11:12,949 --> 00:11:24,019
match his MAC address to the one they

250
00:11:16,790 --> 00:11:29,899
provided for<font color="#CCCCCC"> us so it's</font><font color="#E5E5E5"> zero zero zero</font>

251
00:11:24,019 --> 00:11:34,550
<font color="#CCCCCC">see twenty nine</font><font color="#E5E5E5"> Phoebe six for</font><font color="#CCCCCC"> FC if we</font>

252
00:11:29,899 --> 00:11:36,620
look<font color="#CCCCCC"> right here the source hardware</font>

253
00:11:34,550 --> 00:11:38,479
address matches<font color="#CCCCCC"> so we can</font><font color="#E5E5E5"> confirm</font><font color="#CCCCCC"> that</font>

254
00:11:36,620 --> 00:11:41,179
was Fred's<font color="#E5E5E5"> PC and they've already</font>

255
00:11:38,480 --> 00:11:47,949
<font color="#E5E5E5">confirm for us he was logged in so he</font>

256
00:11:41,179 --> 00:11:50,899
sent this parent message in a ICMP ping

257
00:11:47,949 --> 00:11:55,609
to someone addressed as shady dealer

258
00:11:50,899 --> 00:11:57,620
<font color="#CCCCCC">who's</font><font color="#E5E5E5"> obviously a law-abiding citizen</font><font color="#CCCCCC"> so</font>

259
00:11:55,610 --> 00:11:59,410
that's not<font color="#CCCCCC"> looking too good for Fred but</font>

260
00:11:57,620 --> 00:12:01,779
we can't<font color="#E5E5E5"> prove</font>

261
00:11:59,410 --> 00:12:03,819
that he did<font color="#E5E5E5"> anything wrong yeah other</font>

262
00:12:01,779 --> 00:12:09,399
<font color="#E5E5E5">than message this person and perhaps</font>

263
00:12:03,819 --> 00:12:10,899
this 192 168 137 139 which is on the

264
00:12:09,399 --> 00:12:12,040
<font color="#CCCCCC">Internet and</font><font color="#E5E5E5"> the scenario that could be</font>

265
00:12:10,899 --> 00:12:13,839
we could<font color="#CCCCCC"> check see if</font><font color="#E5E5E5"> that's a</font>

266
00:12:12,040 --> 00:12:20,170
<font color="#E5E5E5">blacklisted IP is he talking to someone</font>

267
00:12:13,839 --> 00:12:22,410
<font color="#E5E5E5">shouldn't be so the next step will be to</font>

268
00:12:20,170 --> 00:12:28,180
follow a little<font color="#E5E5E5"> bit more</font><font color="#CCCCCC"> onto this</font>

269
00:12:22,410 --> 00:12:32,769
<font color="#E5E5E5">communication so if we go down here we</font>

270
00:12:28,180 --> 00:12:37,329
<font color="#CCCCCC">see now we've got some SSL traffic or</font>

271
00:12:32,769 --> 00:12:43,000
TLS<font color="#E5E5E5"> and technically so they're</font>

272
00:12:37,329 --> 00:12:48,550
communicating and if we go down into the

273
00:12:43,000 --> 00:12:51,009
actual data<font color="#E5E5E5"> it's encrypted</font>

274
00:12:48,550 --> 00:12:52,689
all the data is<font color="#CCCCCC"> encrypted there's no way</font>

275
00:12:51,009 --> 00:12:55,870
for us<font color="#CCCCCC"> to actually</font><font color="#E5E5E5"> see what he's looking</font>

276
00:12:52,689 --> 00:12:58,120
<font color="#CCCCCC">at</font><font color="#E5E5E5"> unfortunately they're running a proxy</font>

277
00:12:55,870 --> 00:13:03,430
and<font color="#E5E5E5"> they</font><font color="#CCCCCC"> provided us the key</font><font color="#E5E5E5"> and</font>

278
00:12:58,120 --> 00:13:05,800
Wireshark has a handy built-in<font color="#CCCCCC"> plugin -</font>

279
00:13:03,430 --> 00:13:09,689
or it's built<font color="#E5E5E5"> into their preferences</font>

280
00:13:05,800 --> 00:13:14,229
<font color="#E5E5E5">um protocols we can actually decrypt it</font>

281
00:13:09,689 --> 00:13:17,170
so if you go to start this over<font color="#E5E5E5"> so you</font>

282
00:13:14,230 --> 00:13:18,850
can if you want<font color="#E5E5E5"> to follow</font><font color="#CCCCCC"> along so</font><font color="#E5E5E5"> if if</font>

283
00:13:17,170 --> 00:13:21,069
you're going<font color="#E5E5E5"> to do this at home under</font>

284
00:13:18,850 --> 00:13:25,660
Wireshark if you go to edit go down to

285
00:13:21,069 --> 00:13:31,120
preferences<font color="#CCCCCC"> select</font><font color="#E5E5E5"> open up</font><font color="#CCCCCC"> protocols and</font>

286
00:13:25,660 --> 00:13:33,850
then just find SSL<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> Horace's RSA</font>

287
00:13:31,120 --> 00:13:37,720
key<font color="#CCCCCC"> list again this is</font><font color="#E5E5E5"> only applies to</font>

288
00:13:33,850 --> 00:13:39,339
RSA key exchange so if it was another

289
00:13:37,720 --> 00:13:43,680
like diffie-hellman key exchange it's

290
00:13:39,339 --> 00:13:46,180
not going to work as well<font color="#E5E5E5"> go to edit</font><font color="#CCCCCC"> and</font>

291
00:13:43,680 --> 00:13:49,180
<font color="#CCCCCC">then this is one that I was using</font>

292
00:13:46,180 --> 00:13:51,790
through the CTF so also<font color="#E5E5E5"> if you do the</font>

293
00:13:49,180 --> 00:13:53,170
CTF CTF three one three it actually is a

294
00:13:51,790 --> 00:13:58,170
challenge that<font color="#E5E5E5"> works very similar to</font>

295
00:13:53,170 --> 00:13:58,170
this<font color="#E5E5E5"> so yes</font>

296
00:13:58,690 --> 00:14:19,820
it's not okay is that<font color="#E5E5E5"> good</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so</font>

297
00:14:17,089 --> 00:14:23,060
if you click the<font color="#E5E5E5"> plus button it'll add a</font>

298
00:14:19,820 --> 00:14:26,020
new one and so we'll<font color="#E5E5E5"> need the IP address</font>

299
00:14:23,060 --> 00:14:28,729
and<font color="#E5E5E5"> I generally prefer to go with the</font>

300
00:14:26,020 --> 00:14:30,170
<font color="#E5E5E5">the web server in this kind of</font>

301
00:14:28,730 --> 00:14:34,190
environment<font color="#CCCCCC"> because then it's easier to</font>

302
00:14:30,170 --> 00:14:36,680
pick the<font color="#E5E5E5"> the port because they're going</font>

303
00:14:34,190 --> 00:14:39,980
<font color="#E5E5E5">to use a the web server is</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be</font>

304
00:14:36,680 --> 00:14:48,130
<font color="#E5E5E5">using default</font><font color="#CCCCCC"> 443</font><font color="#E5E5E5"> but the client is</font>

305
00:14:39,980 --> 00:14:57,920
<font color="#E5E5E5">going to pick a random port so one 92168</font>

306
00:14:48,130 --> 00:15:00,290
<font color="#E5E5E5">137 139 or it's gonna be</font><font color="#CCCCCC"> 443 protocol</font>

307
00:14:57,920 --> 00:15:03,800
and this is the protocol it's going to

308
00:15:00,290 --> 00:15:08,870
decode into so in typical SSL or TLS

309
00:15:03,800 --> 00:15:11,839
<font color="#CCCCCC">it's going to go to</font><font color="#E5E5E5"> http content</font><font color="#CCCCCC"> so if</font>

310
00:15:08,870 --> 00:15:14,360
this was like<font color="#E5E5E5"> FTP over SSL</font><font color="#CCCCCC"> you would</font>

311
00:15:11,839 --> 00:15:20,210
need<font color="#E5E5E5"> to specify FTP here so it's the the</font>

312
00:15:14,360 --> 00:15:25,400
<font color="#E5E5E5">protocol it's being translated into the</font>

313
00:15:20,210 --> 00:15:28,880
key file and there's two ways<font color="#CCCCCC"> to get</font>

314
00:15:25,400 --> 00:15:30,800
<font color="#E5E5E5">this if you use like</font><font color="#CCCCCC"> Anna you</font><font color="#E5E5E5"> can</font>

315
00:15:28,880 --> 00:15:32,360
actually<font color="#E5E5E5"> use like a dot P 12 certificate</font>

316
00:15:30,800 --> 00:15:35,839
<font color="#E5E5E5">but then you'll have to specify a</font>

317
00:15:32,360 --> 00:15:37,940
password<font color="#E5E5E5"> because the P</font><font color="#CCCCCC"> 12s are secured</font>

318
00:15:35,839 --> 00:15:40,280
<font color="#CCCCCC">with a password</font><font color="#E5E5E5"> but a key file generally</font>

319
00:15:37,940 --> 00:15:43,339
has no password so<font color="#E5E5E5"> we don't have to put</font>

320
00:15:40,280 --> 00:15:44,810
anything in here and a note if you're

321
00:15:43,339 --> 00:15:47,750
gonna do this<font color="#CCCCCC"> especially at a company</font>

322
00:15:44,810 --> 00:15:51,589
<font color="#E5E5E5">that password is stored in Wireshark in</font>

323
00:15:47,750 --> 00:15:52,910
plain text<font color="#CCCCCC"> so if I would recommend if</font>

324
00:15:51,589 --> 00:15:58,010
you're<font color="#E5E5E5"> going to use an actual</font><font color="#CCCCCC"> production</font>

325
00:15:52,910 --> 00:15:58,939
cert that<font color="#E5E5E5"> you would want</font><font color="#CCCCCC"> to only put</font>

326
00:15:58,010 --> 00:16:00,520
this in here<font color="#E5E5E5"> when you're doing</font>

327
00:15:58,940 --> 00:16:02,420
<font color="#E5E5E5">investigations and then remove it</font>

328
00:16:00,520 --> 00:16:04,930
otherwise it'll be stored in plain text

329
00:16:02,420 --> 00:16:08,219
and that can

330
00:16:04,930 --> 00:16:13,239
ruining your day so once we apply<font color="#E5E5E5"> that</font>

331
00:16:08,220 --> 00:16:17,050
<font color="#CCCCCC">Wireshark will go through and decrypt</font>

332
00:16:13,240 --> 00:16:23,380
our stuff<font color="#E5E5E5"> and now we have clear text</font>

333
00:16:17,050 --> 00:16:24,969
HTTP packets we can look at so<font color="#E5E5E5"> that'll</font>

334
00:16:23,380 --> 00:16:27,399
<font color="#E5E5E5">give us now we can</font><font color="#CCCCCC"> actually see what's</font>

335
00:16:24,970 --> 00:16:29,320
<font color="#E5E5E5">going on</font><font color="#CCCCCC"> so we see a get request the</font>

336
00:16:27,399 --> 00:16:35,500
<font color="#CCCCCC">Fred</font><font color="#E5E5E5"> specie is reaching out</font><font color="#CCCCCC"> to the web</font>

337
00:16:29,320 --> 00:16:38,470
server<font color="#CCCCCC"> and requesting a</font><font color="#E5E5E5"> testing a</font>

338
00:16:35,500 --> 00:16:42,670
website and they got it<font color="#E5E5E5"> okay</font>

339
00:16:38,470 --> 00:16:45,610
there's also<font color="#E5E5E5"> apparently a picture but</font>

340
00:16:42,670 --> 00:16:48,490
according to this<font color="#CCCCCC"> traffic it's not</font><font color="#E5E5E5"> found</font>

341
00:16:45,610 --> 00:16:51,399
<font color="#E5E5E5">so through whatever picture was actually</font>

342
00:16:48,490 --> 00:16:55,870
<font color="#E5E5E5">didn't load not that that's significant</font>

343
00:16:51,399 --> 00:16:57,760
but it's you in other scenarios<font color="#CCCCCC"> that</font>

344
00:16:55,870 --> 00:17:00,130
might be important depending<font color="#CCCCCC"> on what</font>

345
00:16:57,760 --> 00:17:04,179
type of<font color="#E5E5E5"> traffic that they're doing what</font>

346
00:17:00,130 --> 00:17:06,429
<font color="#E5E5E5">they're looking at so a really good way</font>

347
00:17:04,179 --> 00:17:09,220
<font color="#CCCCCC">to get</font><font color="#E5E5E5"> a good grasp of what's going on</font>

348
00:17:06,429 --> 00:17:12,189
here is<font color="#E5E5E5"> to follow just that stream so if</font>

349
00:17:09,220 --> 00:17:15,309
you go to Wireshark<font color="#E5E5E5"> you can follow the</font>

350
00:17:12,189 --> 00:17:17,559
<font color="#E5E5E5">SSL stream and it also brings up this</font>

351
00:17:15,309 --> 00:17:21,399
thing of the data itself that we're

352
00:17:17,559 --> 00:17:24,730
<font color="#CCCCCC">looking at</font><font color="#E5E5E5"> and so if we want to find out</font>

353
00:17:21,400 --> 00:17:26,500
what Fred's<font color="#E5E5E5"> doing</font><font color="#CCCCCC"> we can look at</font><font color="#E5E5E5"> this a</font>

354
00:17:24,730 --> 00:17:28,870
<font color="#E5E5E5">bit closer</font><font color="#CCCCCC"> but we really want to</font><font color="#E5E5E5"> know is</font>

355
00:17:26,500 --> 00:17:30,640
did he<font color="#E5E5E5"> steal any data from the company</font>

356
00:17:28,870 --> 00:17:33,850
and in order<font color="#E5E5E5"> to prove that we're gonna</font>

357
00:17:30,640 --> 00:17:35,140
actually<font color="#E5E5E5"> have</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> that data to</font>

358
00:17:33,850 --> 00:17:37,389
present<font color="#CCCCCC"> to the companies that</font><font color="#E5E5E5"> hey is</font>

359
00:17:35,140 --> 00:17:39,940
this<font color="#CCCCCC"> the</font><font color="#E5E5E5"> information that you're worried</font>

360
00:17:37,390 --> 00:17:41,830
about losing<font color="#E5E5E5"> so like even</font><font color="#CCCCCC"> just a file</font>

361
00:17:39,940 --> 00:17:45,670
name it's probably<font color="#CCCCCC"> not gonna be enough</font>

362
00:17:41,830 --> 00:17:47,320
<font color="#CCCCCC">for like incriminating evidence so if we</font>

363
00:17:45,670 --> 00:17:54,970
go<font color="#CCCCCC"> through this data</font><font color="#E5E5E5"> here we can</font>

364
00:17:47,320 --> 00:17:58,510
<font color="#CCCCCC">actually get the</font><font color="#E5E5E5"> file itself so the good</font>

365
00:17:54,970 --> 00:18:01,929
way to do that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> to we can save this</font>

366
00:17:58,510 --> 00:18:05,650
file and as a file<font color="#E5E5E5"> and you want to make</font>

367
00:18:01,929 --> 00:18:08,110
<font color="#CCCCCC">sure you do it in a raw format because</font>

368
00:18:05,650 --> 00:18:09,940
<font color="#E5E5E5">if you it translates the Wireshark</font>

369
00:18:08,110 --> 00:18:13,030
<font color="#E5E5E5">automatically</font><font color="#CCCCCC"> translates</font><font color="#E5E5E5"> stuff into</font>

370
00:18:09,940 --> 00:18:15,910
whatever format it picks so if it's an

371
00:18:13,030 --> 00:18:18,070
<font color="#E5E5E5">ASCII code and you save</font><font color="#CCCCCC"> it off as an</font>

372
00:18:15,910 --> 00:18:18,340
<font color="#E5E5E5">ASCII then when you try to</font><font color="#CCCCCC"> open the</font>

373
00:18:18,070 --> 00:18:19,899
<font color="#E5E5E5">action</font>

374
00:18:18,340 --> 00:18:22,090
file<font color="#CCCCCC"> that'll already have translated</font>

375
00:18:19,900 --> 00:18:24,549
<font color="#CCCCCC">into ascii code</font><font color="#E5E5E5"> so if it's a text file</font>

376
00:18:22,090 --> 00:18:27,970
<font color="#E5E5E5">it'll we're great</font><font color="#CCCCCC"> you can just pull the</font>

377
00:18:24,549 --> 00:18:29,679
data and it'll work<font color="#E5E5E5"> fine but if it's an</font>

378
00:18:27,970 --> 00:18:31,900
<font color="#E5E5E5">actual like if it's an image or an</font>

379
00:18:29,679 --> 00:18:34,299
executable or<font color="#E5E5E5"> a video or</font><font color="#CCCCCC"> any other</font><font color="#E5E5E5"> type</font>

380
00:18:31,900 --> 00:18:36,120
of file like that<font color="#E5E5E5"> then it'll have</font>

381
00:18:34,299 --> 00:18:39,480
<font color="#E5E5E5">translated ascii and then you can't</font>

382
00:18:36,120 --> 00:18:49,449
reload it as an actual file it'll have

383
00:18:39,480 --> 00:18:51,130
corrupted<font color="#E5E5E5"> the code so there's a show and</font>

384
00:18:49,450 --> 00:18:54,730
save text<font color="#E5E5E5"> thing down here in the corner</font>

385
00:18:51,130 --> 00:18:57,669
and<font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to specify</font><font color="#CCCCCC"> that too raw and</font>

386
00:18:54,730 --> 00:19:00,460
it doesn't<font color="#E5E5E5"> look like anything here</font><font color="#CCCCCC"> but</font>

387
00:18:57,669 --> 00:19:02,919
<font color="#E5E5E5">this is the actual</font><font color="#CCCCCC"> raw data of the file</font>

388
00:19:00,460 --> 00:19:06,580
itself<font color="#CCCCCC"> and another</font><font color="#E5E5E5"> thing to know is this</font>

389
00:19:02,919 --> 00:19:11,289
<font color="#CCCCCC">is the two sides of</font><font color="#E5E5E5"> the conversation</font><font color="#CCCCCC"> so</font>

390
00:19:06,580 --> 00:19:14,049
<font color="#CCCCCC">this is the red up here is from Fred's</font>

391
00:19:11,289 --> 00:19:17,799
PC going this way the blue is everything

392
00:19:14,049 --> 00:19:20,590
that<font color="#E5E5E5"> came back</font><font color="#CCCCCC"> and so</font><font color="#E5E5E5"> on actually</font><font color="#CCCCCC"> in</font>

393
00:19:17,799 --> 00:19:23,260
<font color="#CCCCCC">this case we can even see the</font><font color="#E5E5E5"> web page</font>

394
00:19:20,590 --> 00:19:26,139
<font color="#E5E5E5">itself because that's just in direct</font>

395
00:19:23,260 --> 00:19:29,320
<font color="#E5E5E5">ASCII that's not any kind of special</font>

396
00:19:26,140 --> 00:19:33,370
format so if we want we can even<font color="#E5E5E5"> pull</font>

397
00:19:29,320 --> 00:19:35,580
this and look<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> website</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> Fred</font>

398
00:19:33,370 --> 00:19:35,580
saw

399
00:19:40,590 --> 00:19:52,080
<font color="#E5E5E5">drop this on</font><font color="#CCCCCC"> the desktop</font><font color="#E5E5E5"> here save it</font><font color="#CCCCCC"> as</font>

400
00:19:49,330 --> 00:19:52,080
HTML

401
00:20:04,710 --> 00:20:15,230
and so<font color="#E5E5E5"> this is the webpage</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> Fred</font>

402
00:20:07,860 --> 00:20:17,369
visited so it's up at the<font color="#CCCCCC"> top the name</font>

403
00:20:15,230 --> 00:20:19,999
displays in<font color="#E5E5E5"> the tab is digital back</font>

404
00:20:17,369 --> 00:20:23,309
alley<font color="#E5E5E5"> which doesn't</font><font color="#CCCCCC"> sound particularly</font>

405
00:20:19,999 --> 00:20:26,610
legitimate<font color="#E5E5E5"> and the page is pretty empty</font>

406
00:20:23,309 --> 00:20:30,029
<font color="#E5E5E5">just</font><font color="#CCCCCC"> to select an image to</font><font color="#E5E5E5"> upload with</font>

407
00:20:26,610 --> 00:20:32,459
<font color="#E5E5E5">the choose file button and then can</font>

408
00:20:30,029 --> 00:20:36,840
upload<font color="#E5E5E5"> whatever file that you uploaded</font>

409
00:20:32,460 --> 00:20:40,679
and as we noted<font color="#CCCCCC"> earlier the picture</font>

410
00:20:36,840 --> 00:20:42,629
doesn't<font color="#E5E5E5"> actually show up which if it had</font>

411
00:20:40,679 --> 00:20:44,669
showed<font color="#E5E5E5"> up in the webpage then we would</font>

412
00:20:42,629 --> 00:20:51,928
have to carve<font color="#CCCCCC"> that file out as well</font>

413
00:20:44,669 --> 00:20:53,940
and to put in the same<font color="#CCCCCC"> folder as the new</font>

414
00:20:51,929 --> 00:20:56,399
<font color="#CCCCCC">webpage that we just saved off</font><font color="#E5E5E5"> in order</font>

415
00:20:53,940 --> 00:20:57,869
<font color="#CCCCCC">to actually see it and even that</font>

416
00:20:56,399 --> 00:20:59,998
<font color="#E5E5E5">depending on how</font><font color="#CCCCCC"> they coded their</font>

417
00:20:57,869 --> 00:21:01,320
website might not<font color="#E5E5E5"> work because it</font><font color="#CCCCCC"> might</font>

418
00:20:59,999 --> 00:21:02,850
be looking for<font color="#CCCCCC"> a specific location</font>

419
00:21:01,320 --> 00:21:05,129
<font color="#E5E5E5">instead of the location of the</font><font color="#CCCCCC"> site</font>

420
00:21:02,850 --> 00:21:08,340
stored in but this is the<font color="#CCCCCC"> website</font><font color="#E5E5E5"> Fred</font>

421
00:21:05,129 --> 00:21:12,299
saw so that's more evidence<font color="#E5E5E5"> that Fred's</font>

422
00:21:08,340 --> 00:21:18,119
not necessarily behaving because<font color="#E5E5E5"> this</font>

423
00:21:12,299 --> 00:21:20,009
website<font color="#E5E5E5"> doesn't look very legitimate one</font>

424
00:21:18,119 --> 00:21:24,899
fun thing<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can also if</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> want to</font>

425
00:21:20,009 --> 00:21:26,309
start digging<font color="#E5E5E5"> through</font><font color="#CCCCCC"> the like this is</font>

426
00:21:24,899 --> 00:21:28,879
<font color="#CCCCCC">more</font><font color="#E5E5E5"> of the protocol analysis side you</font>

427
00:21:26,309 --> 00:21:34,590
can go through the HTTP code<font color="#E5E5E5"> and</font>

428
00:21:28,879 --> 00:21:37,590
determine like what<font color="#E5E5E5"> user agent was being</font>

429
00:21:34,590 --> 00:21:43,519
used<font color="#E5E5E5"> to look at this so</font><font color="#CCCCCC"> this is Mozilla</font>

430
00:21:37,590 --> 00:21:43,519
so Firefox<font color="#CCCCCC"> information about the</font><font color="#E5E5E5"> host</font>

431
00:21:45,230 --> 00:21:56,899
and then you can also see like what the

432
00:21:50,870 --> 00:22:01,158
web<font color="#CCCCCC"> servers like in</font><font color="#E5E5E5"> this case they're</font>

433
00:21:56,899 --> 00:22:03,580
running<font color="#E5E5E5"> high a 7.5 so this hacker</font>

434
00:22:01,159 --> 00:22:06,649
website<font color="#E5E5E5"> is not very secure</font><font color="#CCCCCC"> themselves</font>

435
00:22:03,580 --> 00:22:08,090
<font color="#CCCCCC">but there's</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> lot of information and</font>

436
00:22:06,649 --> 00:22:10,158
<font color="#E5E5E5">one of the things about</font><font color="#CCCCCC"> Network</font>

437
00:22:08,090 --> 00:22:11,480
forensics<font color="#CCCCCC"> is like all forensics there's</font>

438
00:22:10,159 --> 00:22:13,730
a lot of<font color="#E5E5E5"> data to go through</font><font color="#CCCCCC"> and you have</font>

439
00:22:11,480 --> 00:22:15,909
<font color="#E5E5E5">to figure</font><font color="#CCCCCC"> out what's important to you so</font>

440
00:22:13,730 --> 00:22:17,659
when you're<font color="#CCCCCC"> doing an investigation</font>

441
00:22:15,909 --> 00:22:21,710
<font color="#CCCCCC">information</font><font color="#E5E5E5"> you wanna you want to have a</font>

442
00:22:17,659 --> 00:22:23,870
list of like so like dirty words with

443
00:22:21,710 --> 00:22:28,039
dirty values of stuff you're<font color="#CCCCCC"> looking for</font>

444
00:22:23,870 --> 00:22:29,750
so<font color="#CCCCCC"> you know as does this contain</font><font color="#E5E5E5"> this</font>

445
00:22:28,039 --> 00:22:32,179
person's name does<font color="#E5E5E5"> it contain this IP</font>

446
00:22:29,750 --> 00:22:36,380
address does it contain<font color="#E5E5E5"> this file name</font>

447
00:22:32,179 --> 00:22:40,309
<font color="#E5E5E5">because this particular file is a I made</font>

448
00:22:36,380 --> 00:22:42,649
it for<font color="#CCCCCC"> this presentation and</font><font color="#E5E5E5"> it's 182</font>

449
00:22:40,309 --> 00:22:45,260
packets and then<font color="#E5E5E5"> this is not all</font>

450
00:22:42,649 --> 00:22:47,330
communication<font color="#CCCCCC"> between Fred and the</font>

451
00:22:45,260 --> 00:22:49,490
server in an actual environment<font color="#E5E5E5"> I'm sure</font>

452
00:22:47,330 --> 00:22:50,689
you know most of you have<font color="#CCCCCC"> seen and</font><font color="#E5E5E5"> it</font>

453
00:22:49,490 --> 00:22:53,990
could be hundreds of<font color="#E5E5E5"> thousands of</font>

454
00:22:50,690 --> 00:22:58,580
packets in a minute<font color="#E5E5E5"> so you can't just</font>

455
00:22:53,990 --> 00:22:59,480
scroll through<font color="#E5E5E5"> it and find necessarily</font>

456
00:22:58,580 --> 00:23:01,340
<font color="#E5E5E5">find where you're looking for very</font>

457
00:22:59,480 --> 00:23:06,500
easily because there's gonna<font color="#E5E5E5"> be way too</font>

458
00:23:01,340 --> 00:23:08,928
<font color="#E5E5E5">much traffic to sort through</font><font color="#CCCCCC"> so you</font>

459
00:23:06,500 --> 00:23:12,080
<font color="#E5E5E5">really have</font><font color="#CCCCCC"> to get</font><font color="#E5E5E5"> that's when you start</font>

460
00:23:08,929 --> 00:23:15,519
searching<font color="#E5E5E5"> for keywords and phrases which</font>

461
00:23:12,080 --> 00:23:19,549
Wireshark does have a fine packet option

462
00:23:15,519 --> 00:23:23,230
<font color="#CCCCCC">you can specify a hex value that</font><font color="#E5E5E5"> would</font>

463
00:23:19,549 --> 00:23:26,029
<font color="#E5E5E5">be in this data part down here</font><font color="#CCCCCC"> as</font>

464
00:23:23,230 --> 00:23:28,100
various expressions<font color="#E5E5E5"> string is one</font>

465
00:23:26,029 --> 00:23:32,809
that'll pull up information<font color="#E5E5E5"> from the</font>

466
00:23:28,100 --> 00:23:35,449
info tab so<font color="#E5E5E5"> you could search for get and</font>

467
00:23:32,809 --> 00:23:41,840
<font color="#E5E5E5">it will find all</font><font color="#CCCCCC"> of the packets that</font>

468
00:23:35,450 --> 00:23:43,940
<font color="#CCCCCC">have</font><font color="#E5E5E5"> get in the info</font><font color="#CCCCCC"> tab which is it's</font>

469
00:23:41,840 --> 00:23:48,309
<font color="#CCCCCC">the basic information</font><font color="#E5E5E5"> of what Wireshark</font>

470
00:23:43,940 --> 00:23:48,309
could find<font color="#E5E5E5"> about the packet itself</font>

471
00:23:50,360 --> 00:23:59,729
so now that we<font color="#E5E5E5"> have this data stream and</font>

472
00:23:56,009 --> 00:24:04,759
we've already<font color="#E5E5E5"> found the website see if</font>

473
00:23:59,730 --> 00:24:07,769
we can actually<font color="#E5E5E5"> find some the file that</font>

474
00:24:04,759 --> 00:24:10,139
the<font color="#E5E5E5"> company's worried about losing so</font>

475
00:24:07,769 --> 00:24:14,639
they provided<font color="#CCCCCC"> us with what they're</font>

476
00:24:10,139 --> 00:24:16,709
specifically concerned about is<font color="#CCCCCC"> their</font>

477
00:24:14,639 --> 00:24:19,350
secret<font color="#CCCCCC"> recipe which they gave</font><font color="#E5E5E5"> us a copy</font>

478
00:24:16,710 --> 00:24:21,690
<font color="#E5E5E5">of so we'll be able</font><font color="#CCCCCC"> to compare</font><font color="#E5E5E5"> once we</font>

479
00:24:19,350 --> 00:24:24,209
find<font color="#CCCCCC"> it the file that Fred may or may</font>

480
00:24:21,690 --> 00:24:29,070
<font color="#CCCCCC">not have done</font><font color="#E5E5E5"> anything with and compare</font>

481
00:24:24,210 --> 00:24:31,620
it<font color="#CCCCCC"> and</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> we do this another</font><font color="#E5E5E5"> thing</font>

482
00:24:29,070 --> 00:24:34,740
you might search<font color="#CCCCCC"> for is you know</font><font color="#E5E5E5"> if say</font>

483
00:24:31,620 --> 00:24:37,610
like if a<font color="#E5E5E5"> keyword</font><font color="#CCCCCC"> if we used</font><font color="#E5E5E5"> post</font>

484
00:24:34,740 --> 00:24:40,679
command<font color="#E5E5E5"> because of its HTTP stream and</font>

485
00:24:37,610 --> 00:24:46,350
we can check<font color="#CCCCCC"> and see if he</font><font color="#E5E5E5"> sent anything</font>

486
00:24:40,679 --> 00:24:49,110
which<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> one here and so there's a</font>

487
00:24:46,350 --> 00:24:52,799
post command of<font color="#CCCCCC"> uploaded there was a</font>

488
00:24:49,110 --> 00:24:55,019
file uploaded so that might be<font color="#E5E5E5"> our level</font>

489
00:24:52,799 --> 00:24:59,360
of<font color="#E5E5E5"> concern that there's a file uploaded</font>

490
00:24:55,019 --> 00:24:59,360
so maybe<font color="#E5E5E5"> Fred</font><font color="#CCCCCC"> actually did do</font><font color="#E5E5E5"> something</font>

491
00:25:00,640 --> 00:25:06,640
so we can save this and<font color="#CCCCCC"> it's raw data so</font>

492
00:25:05,559 --> 00:25:09,399
<font color="#E5E5E5">it's not actually gonna have a file</font>

493
00:25:06,640 --> 00:25:12,360
extension<font color="#CCCCCC"> which is</font><font color="#E5E5E5"> I'm sure windows</font>

494
00:25:09,400 --> 00:25:12,360
<font color="#CCCCCC">won't appreciate</font><font color="#E5E5E5"> it but</font>

495
00:25:14,780 --> 00:25:17,930
[Music]

496
00:25:19,940 --> 00:25:26,090
so now we have a file stream and this<font color="#E5E5E5"> is</font>

497
00:25:24,800 --> 00:25:27,320
where I like a hex editor<font color="#CCCCCC"> is going</font><font color="#E5E5E5"> to</font>

498
00:25:26,090 --> 00:25:29,179
come in because<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is just</font><font color="#E5E5E5"> raw binary</font>

499
00:25:27,320 --> 00:25:30,500
<font color="#E5E5E5">data so if we try to</font><font color="#CCCCCC"> open this in</font>

500
00:25:29,180 --> 00:25:32,620
<font color="#E5E5E5">something</font><font color="#CCCCCC"> else it's not</font><font color="#E5E5E5"> gonna like it</font>

501
00:25:30,500 --> 00:25:36,860
<font color="#CCCCCC">we're not</font><font color="#E5E5E5"> gonna be able to see anything</font>

502
00:25:32,620 --> 00:25:39,199
<font color="#CCCCCC">so I typically use the</font><font color="#E5E5E5"> blest hex editor</font>

503
00:25:36,860 --> 00:25:40,790
from working on like a Linux<font color="#E5E5E5"> box because</font>

504
00:25:39,200 --> 00:25:44,240
that's<font color="#E5E5E5"> that's my favorite hex editor but</font>

505
00:25:40,790 --> 00:25:48,530
I couldn't find a copy for Windows so I

506
00:25:44,240 --> 00:25:58,640
had to use coincidentally Fred as my hex

507
00:25:48,530 --> 00:26:01,760
editor and a hex editor basically is

508
00:25:58,640 --> 00:26:06,140
<font color="#CCCCCC">broken into two main</font><font color="#E5E5E5"> pans there's Thor 3</font>

509
00:26:01,760 --> 00:26:08,960
<font color="#E5E5E5">there's the byte offset the actual bytes</font>

510
00:26:06,140 --> 00:26:11,330
shown in<font color="#CCCCCC"> hexadecimal</font><font color="#E5E5E5"> and then an ASCII</font>

511
00:26:08,960 --> 00:26:13,010
representation on<font color="#CCCCCC"> the side and so</font><font color="#E5E5E5"> this</font>

512
00:26:11,330 --> 00:26:14,570
is helpful<font color="#E5E5E5"> for</font><font color="#CCCCCC"> finding where you need to</font>

513
00:26:13,010 --> 00:26:18,790
get<font color="#E5E5E5"> to to actually start carving the</font>

514
00:26:14,570 --> 00:26:21,639
data<font color="#CCCCCC"> so part</font><font color="#E5E5E5"> of the knowing protocols</font>

515
00:26:18,790 --> 00:26:23,690
<font color="#CCCCCC">does get</font><font color="#E5E5E5"> taken away a little bit if</font>

516
00:26:21,640 --> 00:26:27,490
depending on<font color="#E5E5E5"> the tool you use because</font>

517
00:26:23,690 --> 00:26:31,160
Wireshark<font color="#E5E5E5"> is really good showcasing</font>

518
00:26:27,490 --> 00:26:33,800
<font color="#E5E5E5">areas that where the different protocols</font>

519
00:26:31,160 --> 00:26:36,050
<font color="#E5E5E5">interact and there's tons of protocols</font>

520
00:26:33,800 --> 00:26:42,520
already<font color="#E5E5E5"> loaded into a Wireshark it tells</font>

521
00:26:36,050 --> 00:26:46,240
you where<font color="#E5E5E5"> everything goes</font><font color="#CCCCCC"> and so on the</font>

522
00:26:42,520 --> 00:26:49,700
post command<font color="#E5E5E5"> it'll show you where your</font>

523
00:26:46,240 --> 00:26:58,010
file<font color="#E5E5E5"> itself is and the boundaries</font>

524
00:26:49,700 --> 00:27:04,040
<font color="#CCCCCC">between them and</font><font color="#E5E5E5"> also when</font><font color="#CCCCCC"> we look</font><font color="#E5E5E5"> at</font>

525
00:26:58,010 --> 00:27:06,110
this section<font color="#E5E5E5"> here it says oh there's</font>

526
00:27:04,040 --> 00:27:08,300
also a file<font color="#E5E5E5"> name see if your company</font>

527
00:27:06,110 --> 00:27:10,639
recipe<font color="#CCCCCC"> dat DLC X which is the name of</font>

528
00:27:08,300 --> 00:27:12,919
the file that<font color="#CCCCCC"> they gave us so</font><font color="#E5E5E5"> starting</font>

529
00:27:10,640 --> 00:27:15,790
to look bad for<font color="#CCCCCC"> this</font><font color="#E5E5E5"> company and then it</font>

530
00:27:12,920 --> 00:27:19,280
shows that it's a compressed zip<font color="#CCCCCC"> file</font>

531
00:27:15,790 --> 00:27:21,590
which<font color="#CCCCCC"> you may or may not know docx files</font>

532
00:27:19,280 --> 00:27:24,410
are actually<font color="#CCCCCC"> zip files at the heart</font><font color="#E5E5E5"> of</font>

533
00:27:21,590 --> 00:27:27,760
it<font color="#E5E5E5"> so it's more evidence</font><font color="#CCCCCC"> that an actual</font>

534
00:27:24,410 --> 00:27:27,760
DLC X file was uploaded

535
00:27:28,930 --> 00:27:39,660
so this is and then if you<font color="#E5E5E5"> notice here</font>

536
00:27:35,530 --> 00:27:47,830
in the the hex part is that this says<font color="#CCCCCC"> PK</font>

537
00:27:39,660 --> 00:27:49,930
<font color="#CCCCCC">this is the header</font><font color="#E5E5E5"> signal for a zip file</font>

538
00:27:47,830 --> 00:27:54,310
<font color="#CCCCCC">so this is where the file actually</font>

539
00:27:49,930 --> 00:27:58,180
starts is right here<font color="#E5E5E5"> so we can look at</font>

540
00:27:54,310 --> 00:28:00,370
the bytes at the side<font color="#E5E5E5"> here and the</font>

541
00:27:58,180 --> 00:28:02,610
offset and determine where to start

542
00:28:00,370 --> 00:28:02,610
carving

543
00:28:08,970 --> 00:28:16,650
so<font color="#E5E5E5"> really we find we find</font><font color="#CCCCCC"> the matching</font>

544
00:28:11,220 --> 00:28:19,340
spot here and then<font color="#E5E5E5"> Wireshark</font><font color="#CCCCCC"> will</font>

545
00:28:16,650 --> 00:28:21,870
<font color="#CCCCCC">mention the different all the different</font>

546
00:28:19,340 --> 00:28:24,000
stuff like encapsulation<font color="#E5E5E5"> protocols and</font>

547
00:28:21,870 --> 00:28:26,969
<font color="#CCCCCC">wanna</font><font color="#E5E5E5"> so it'll say here you can also</font>

548
00:28:24,000 --> 00:28:30,540
notice<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> Mima format and a typical</font>

549
00:28:26,970 --> 00:28:36,420
<font color="#CCCCCC">sine of M</font><font color="#E5E5E5"> IME is that starts of files</font>

550
00:28:30,540 --> 00:28:38,580
are noted by this sequence of 0d 0a 0d

551
00:28:36,420 --> 00:28:40,830
0a so it's another good way to find it

552
00:28:38,580 --> 00:28:42,689
if if you're doing<font color="#E5E5E5"> this like by hand</font>

553
00:28:40,830 --> 00:28:45,480
through data that you<font color="#E5E5E5"> capture maybe</font>

554
00:28:42,690 --> 00:28:47,970
through TC<font color="#CCCCCC"> tcp dump</font><font color="#E5E5E5"> and you</font><font color="#CCCCCC"> don't have</font>

555
00:28:45,480 --> 00:28:53,790
<font color="#E5E5E5">access</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> wire sharks information on</font>

556
00:28:47,970 --> 00:28:56,820
where different stuff is within the data

557
00:28:53,790 --> 00:28:58,320
stream so that's again<font color="#CCCCCC"> where</font><font color="#E5E5E5"> like that</font>

558
00:28:56,820 --> 00:29:00,990
knowing<font color="#CCCCCC"> the protocols thing is</font><font color="#E5E5E5"> really</font>

559
00:28:58,320 --> 00:29:06,629
handy<font color="#E5E5E5"> if you know you know that</font><font color="#CCCCCC"> a miami</font>

560
00:29:00,990 --> 00:29:09,360
specifies with this segment<font color="#CCCCCC"> then that's</font>

561
00:29:06,630 --> 00:29:14,850
<font color="#E5E5E5">definitely helpful so everything that</font>

562
00:29:09,360 --> 00:29:20,399
came before<font color="#CCCCCC"> that is not the file so we</font>

563
00:29:14,850 --> 00:29:21,899
have to carve<font color="#E5E5E5"> all that out and so to</font>

564
00:29:20,400 --> 00:29:22,920
<font color="#E5E5E5">start there and then we now we just need</font>

565
00:29:21,900 --> 00:29:28,550
<font color="#CCCCCC">to find the end of the file</font>

566
00:29:22,920 --> 00:29:28,550
and again Wireshark<font color="#E5E5E5"> comes to the rescue</font>

567
00:29:37,120 --> 00:29:45,158
so there's a 0d0 a followed by<font color="#CCCCCC"> 2d fairly</font>

568
00:29:43,610 --> 00:29:47,840
repetitively

569
00:29:45,159 --> 00:29:50,720
<font color="#CCCCCC">so that that's something that shouldn't</font>

570
00:29:47,840 --> 00:29:52,899
be<font color="#E5E5E5"> too hard to find once we get near the</font>

571
00:29:50,720 --> 00:29:52,899
bottom

572
00:29:57,460 --> 00:30:04,190
absolutely<font color="#E5E5E5"> it</font><font color="#CCCCCC"> is so this is all stuff</font>

573
00:30:02,840 --> 00:30:09,500
<font color="#CCCCCC">that</font><font color="#E5E5E5"> came after the file in the data</font>

574
00:30:04,190 --> 00:30:11,000
stream so we cut that away<font color="#CCCCCC"> now this is</font>

575
00:30:09,500 --> 00:30:14,660
the part<font color="#E5E5E5"> where this is going to go wrong</font>

576
00:30:11,000 --> 00:30:22,630
it's going<font color="#E5E5E5"> to go wrong right now so</font>

577
00:30:14,660 --> 00:30:31,700
we'll just name<font color="#E5E5E5"> this file captured and</font>

578
00:30:22,630 --> 00:30:39,799
it will rename it do<font color="#CCCCCC"> CX</font><font color="#E5E5E5"> fire it up and</font>

579
00:30:31,700 --> 00:30:42,730
<font color="#CCCCCC">see</font><font color="#E5E5E5"> what looks like and so we've got top</font>

580
00:30:39,799 --> 00:30:45,679
secret recipe<font color="#CCCCCC"> for companies only and</font>

581
00:30:42,730 --> 00:30:50,179
there's their secret recipe<font color="#CCCCCC"> for ice</font>

582
00:30:45,679 --> 00:30:52,570
that's<font color="#CCCCCC"> solid water solutions so now we</font>

583
00:30:50,179 --> 00:30:58,210
can<font color="#E5E5E5"> compare this</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> one they gave us</font>

584
00:30:52,570 --> 00:31:03,770
looks pretty much the<font color="#CCCCCC"> same so there's a</font>

585
00:30:58,210 --> 00:31:07,299
indication that<font color="#CCCCCC"> so this is pretty</font><font color="#E5E5E5"> much</font>

586
00:31:03,770 --> 00:31:09,710
right<font color="#E5E5E5"> here pretty solid of that it was</font>

587
00:31:07,299 --> 00:31:14,440
the company's recipe we can take you<font color="#CCCCCC"> two</font>

588
00:31:09,710 --> 00:31:14,440
step further<font color="#E5E5E5"> and hash these</font>

589
00:31:21,300 --> 00:31:28,500
so you zoom in here this<font color="#CCCCCC"> is our shot</font><font color="#E5E5E5"> 256</font>

590
00:31:26,430 --> 00:31:33,240
and we'll<font color="#E5E5E5"> just look at the last couple</font>

591
00:31:28,500 --> 00:31:43,220
<font color="#CCCCCC">yell 7b</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> zero and</font><font color="#E5E5E5"> that's the one we</font>

592
00:31:33,240 --> 00:31:43,220
captured I think I<font color="#CCCCCC"> just closed</font><font color="#E5E5E5"> magnifier</font>

593
00:31:43,730 --> 00:31:49,700
if I could spell here we go

594
00:31:53,520 --> 00:32:03,780
so<font color="#CCCCCC"> 7b to zero so this</font><font color="#E5E5E5"> is in fact the</font>

595
00:31:58,290 --> 00:32:07,170
same<font color="#E5E5E5"> file</font><font color="#CCCCCC"> so yes</font><font color="#E5E5E5"> did Fred</font><font color="#CCCCCC"> steal company</font>

596
00:32:03,780 --> 00:32:07,889
information<font color="#CCCCCC"> we can say the answer is</font><font color="#E5E5E5"> in</font>

597
00:32:07,170 --> 00:32:11,820
<font color="#CCCCCC">fact yes</font>

598
00:32:07,890 --> 00:32:14,340
it's not so<font color="#E5E5E5"> great for the company</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> we</font>

599
00:32:11,820 --> 00:32:15,928
can<font color="#CCCCCC"> successfully proved by the you know</font>

600
00:32:14,340 --> 00:32:18,840
this<font color="#E5E5E5"> process of finding out what Fred's</font>

601
00:32:15,929 --> 00:32:20,940
doing decrypt to<font color="#E5E5E5"> the traffic</font><font color="#CCCCCC"> carve the</font>

602
00:32:18,840 --> 00:32:24,780
files<font color="#E5E5E5"> can prove that Fred did in fact</font>

603
00:32:20,940 --> 00:32:26,429
steal<font color="#E5E5E5"> this file from the company so for</font>

604
00:32:24,780 --> 00:32:30,178
<font color="#CCCCCC">Network forensics is pretty useful</font><font color="#E5E5E5"> in</font>

605
00:32:26,429 --> 00:32:31,740
that sense<font color="#E5E5E5"> that there are</font><font color="#CCCCCC"> a lot there</font>

606
00:32:30,179 --> 00:32:32,880
<font color="#CCCCCC">are other ways</font><font color="#E5E5E5"> like memory forensics can</font>

607
00:32:31,740 --> 00:32:34,440
probably give you a<font color="#E5E5E5"> pretty similar</font>

608
00:32:32,880 --> 00:32:36,090
picture of what happened but this<font color="#E5E5E5"> is a</font>

609
00:32:34,440 --> 00:32:37,890
<font color="#E5E5E5">really good way to indicate this</font><font color="#CCCCCC"> traffic</font>

610
00:32:36,090 --> 00:32:41,399
did go<font color="#E5E5E5"> through our network went out to</font>

611
00:32:37,890 --> 00:32:43,770
the<font color="#CCCCCC"> Internet</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know some what there's</font>

612
00:32:41,400 --> 00:32:46,760
response back from the<font color="#E5E5E5"> web server and we</font>

613
00:32:43,770 --> 00:32:50,040
can tell that<font color="#E5E5E5"> this file</font><font color="#CCCCCC"> fact we can</font>

614
00:32:46,760 --> 00:32:52,679
following the stream<font color="#CCCCCC"> mersive</font><font color="#E5E5E5"> post they</font>

615
00:32:50,040 --> 00:32:53,820
sent<font color="#E5E5E5"> back in</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> HTTP okay which means</font>

616
00:32:52,679 --> 00:32:57,150
they<font color="#CCCCCC"> receive</font><font color="#E5E5E5"> the file</font>

617
00:32:53,820 --> 00:32:59,309
<font color="#E5E5E5">so whatever malicious site this is that</font>

618
00:32:57,150 --> 00:33:02,670
file actually<font color="#E5E5E5"> was uploaded to it and we</font>

619
00:32:59,309 --> 00:33:06,000
can prove what file it was and so a

620
00:33:02,670 --> 00:33:09,420
quick<font color="#CCCCCC"> no on the some techniques you're</font>

621
00:33:06,000 --> 00:33:11,820
speaking of hashes<font color="#CCCCCC"> when you're</font><font color="#E5E5E5"> working</font>

622
00:33:09,420 --> 00:33:14,220
in<font color="#E5E5E5"> network forensics it's really</font>

623
00:33:11,820 --> 00:33:16,139
important to make sure you<font color="#E5E5E5"> don't are any</font>

624
00:33:14,220 --> 00:33:20,600
forensics<font color="#E5E5E5"> make sure you don't disturb</font>

625
00:33:16,140 --> 00:33:24,050
the actual data files<font color="#E5E5E5"> so you might we</font>

626
00:33:20,600 --> 00:33:27,000
common practice is<font color="#E5E5E5"> to save a copy of</font>

627
00:33:24,050 --> 00:33:30,629
like say the packet capture and then

628
00:33:27,000 --> 00:33:33,510
hash it and that way you can<font color="#E5E5E5"> when you do</font>

629
00:33:30,630 --> 00:33:35,760
your investigation<font color="#E5E5E5"> you can hash the file</font>

630
00:33:33,510 --> 00:33:37,170
the one<font color="#E5E5E5"> you worked on and compare it to</font>

631
00:33:35,760 --> 00:33:38,730
<font color="#CCCCCC">the hash of the original improve that</font>

632
00:33:37,170 --> 00:33:40,860
the file was not the file was not

633
00:33:38,730 --> 00:33:42,630
<font color="#E5E5E5">altered and the data was not altered so</font>

634
00:33:40,860 --> 00:33:45,870
in terms of<font color="#E5E5E5"> a criminal investigation</font>

635
00:33:42,630 --> 00:33:47,790
<font color="#CCCCCC">it's extremely important that</font><font color="#E5E5E5"> the file</font>

636
00:33:45,870 --> 00:33:49,409
<font color="#E5E5E5">not the data not be changed</font>

637
00:33:47,790 --> 00:33:52,020
<font color="#E5E5E5">because then they could you know that's</font>

638
00:33:49,410 --> 00:33:54,710
evidence is now<font color="#CCCCCC"> dismissible because you</font>

639
00:33:52,020 --> 00:33:54,710
could<font color="#E5E5E5"> have altered it</font>

640
00:34:09,480 --> 00:34:21,339
so<font color="#E5E5E5"> there we</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> so did Fred take the file</font>

641
00:34:18,429 --> 00:34:23,349
<font color="#E5E5E5">yes he did that's unfortunate for the</font>

642
00:34:21,339 --> 00:34:27,940
company but it's good for us<font color="#CCCCCC"> we did our</font>

643
00:34:23,349 --> 00:34:29,500
job that's<font color="#E5E5E5"> pretty much all I have if you</font>

644
00:34:27,940 --> 00:34:32,050
have any questions I'm happy to<font color="#E5E5E5"> take</font>

645
00:34:29,500 --> 00:34:33,849
those<font color="#CCCCCC"> there's a couple</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> resources if</font>

646
00:34:32,050 --> 00:34:36,909
you're interested<font color="#CCCCCC"> kind of some stuff</font>

647
00:34:33,849 --> 00:34:39,369
<font color="#CCCCCC">that</font><font color="#E5E5E5"> got me</font><font color="#CCCCCC"> started forensics</font><font color="#E5E5E5"> contest</font>

648
00:34:36,909 --> 00:34:41,859
comm<font color="#CCCCCC"> is a great resource they have a lot</font>

649
00:34:39,369 --> 00:34:47,589
of practice scenarios you can<font color="#CCCCCC"> do that's</font>

650
00:34:41,859 --> 00:34:49,449
<font color="#E5E5E5">how I started</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> the the other</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> on</font>

651
00:34:47,589 --> 00:34:51,339
here<font color="#E5E5E5"> is just a source of there's a lot</font>

652
00:34:49,449 --> 00:34:53,710
of pcap files I recently<font color="#E5E5E5"> discovered this</font>

653
00:34:51,339 --> 00:34:55,509
I'm eager to<font color="#E5E5E5"> look into them</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> they've</font>

654
00:34:53,710 --> 00:34:56,589
<font color="#E5E5E5">got tons and tons of pcap files of a</font>

655
00:34:55,510 --> 00:34:59,230
bunch of different<font color="#CCCCCC"> scenarios where</font>

656
00:34:56,589 --> 00:35:02,320
<font color="#E5E5E5">there's you</font><font color="#CCCCCC"> know malware involved</font><font color="#E5E5E5"> web</font>

657
00:34:59,230 --> 00:35:05,619
<font color="#E5E5E5">traffic</font><font color="#CCCCCC"> there's some from some like</font>

658
00:35:02,320 --> 00:35:08,589
cyber defense competitions on there so

659
00:35:05,619 --> 00:35:10,380
<font color="#E5E5E5">it's a lot of interesting stuff and then</font>

660
00:35:08,589 --> 00:35:13,930
at Lucas<font color="#E5E5E5"> Corsica that's me on Twitter</font>

661
00:35:10,380 --> 00:35:16,570
<font color="#E5E5E5">again the the</font><font color="#CCCCCC"> Polish</font><font color="#E5E5E5"> Falcon is my</font>

662
00:35:13,930 --> 00:35:20,080
<font color="#CCCCCC">Twitter picture so help you find me a</font>

663
00:35:16,570 --> 00:35:22,990
<font color="#E5E5E5">little easier but that's pretty much all</font>

664
00:35:20,080 --> 00:35:26,880
<font color="#E5E5E5">I have so does does anyone have any</font>

665
00:35:22,990 --> 00:35:26,879
<font color="#E5E5E5">questions yes</font>

666
00:35:29,180 --> 00:35:35,220
<font color="#CCCCCC">they're something</font><font color="#E5E5E5"> that they're</font><font color="#CCCCCC"> getting</font>

667
00:35:32,250 --> 00:35:38,210
rid of<font color="#E5E5E5"> that</font><font color="#CCCCCC"> so something</font><font color="#E5E5E5"> Fred could have</font>

668
00:35:35,220 --> 00:35:38,209
to make<font color="#E5E5E5"> your job harder</font>

669
00:35:43,570 --> 00:35:48,970
yeah<font color="#E5E5E5"> so the question</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> aside from you</font>

670
00:35:47,050 --> 00:35:50,440
know<font color="#E5E5E5"> trying to avoid the proxy is there</font>

671
00:35:48,970 --> 00:35:52,990
anything that<font color="#CCCCCC"> Fred could have done to</font>

672
00:35:50,440 --> 00:35:54,850
<font color="#E5E5E5">avoid detection</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this is a lot of</font>

673
00:35:52,990 --> 00:35:57,819
things<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> a very simple basic</font>

674
00:35:54,850 --> 00:35:59,500
analysis like for example<font color="#CCCCCC"> if you try and</font>

675
00:35:57,820 --> 00:36:01,810
<font color="#CCCCCC">avoid detection I probably wouldn't try</font>

676
00:35:59,500 --> 00:36:04,840
to hide a<font color="#CCCCCC"> plaintext</font><font color="#E5E5E5"> message in an ICMP</font>

677
00:36:01,810 --> 00:36:06,820
thing<font color="#CCCCCC"> but that actually though is a</font>

678
00:36:04,840 --> 00:36:10,780
viable exfiltration method people views

679
00:36:06,820 --> 00:36:14,020
so<font color="#CCCCCC"> you kind</font><font color="#E5E5E5"> of depends some obviously</font>

680
00:36:10,780 --> 00:36:15,640
like if if the shady dealer did his due

681
00:36:14,020 --> 00:36:18,610
diligence then he probably would<font color="#CCCCCC"> have</font>

682
00:36:15,640 --> 00:36:20,589
set up a better method<font color="#E5E5E5"> of getting</font><font color="#CCCCCC"> the</font>

683
00:36:18,610 --> 00:36:23,890
file or<font color="#E5E5E5"> Fred could have encrypted the</font>

684
00:36:20,590 --> 00:36:25,120
file<font color="#E5E5E5"> and then sent it in which</font><font color="#CCCCCC"> case it</font>

685
00:36:23,890 --> 00:36:26,560
would<font color="#CCCCCC"> be a lot harder for us to get</font>

686
00:36:25,120 --> 00:36:29,080
unless<font color="#E5E5E5"> he</font><font color="#CCCCCC"> sent the</font><font color="#E5E5E5"> password through the</font>

687
00:36:26,560 --> 00:36:30,160
same data stream<font color="#E5E5E5"> so there's a lot</font><font color="#CCCCCC"> of</font>

688
00:36:29,080 --> 00:36:33,549
stuff you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> do to hide your tracks</font>

689
00:36:30,160 --> 00:36:37,319
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is kind of more</font><font color="#CCCCCC"> of a</font><font color="#E5E5E5"> simple</font><font color="#CCCCCC"> setup</font>

690
00:36:33,550 --> 00:36:41,860
<font color="#CCCCCC">but yeah there's a</font><font color="#E5E5E5"> lot more</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> do</font>

691
00:36:37,320 --> 00:36:44,190
<font color="#CCCCCC">let's answer</font><font color="#E5E5E5"> your question</font><font color="#CCCCCC"> any other</font>

692
00:36:41,860 --> 00:36:44,190
questions

693
00:36:44,450 --> 00:36:47,919
<font color="#E5E5E5">all right well thank you</font>

