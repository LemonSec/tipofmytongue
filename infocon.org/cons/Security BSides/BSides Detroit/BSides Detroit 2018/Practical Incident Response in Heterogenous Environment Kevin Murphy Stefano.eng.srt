1
00:00:01,820 --> 00:00:10,019
hi my name is<font color="#E5E5E5"> Kevin</font><font color="#CCCCCC"> and joining me is</font>

2
00:00:05,339 --> 00:00:12,990
<font color="#CCCCCC">Stefano we are with or we work for RSA</font>

3
00:00:10,019 --> 00:00:16,590
we do Incident Response<font color="#E5E5E5"> and we're going</font>

4
00:00:12,990 --> 00:00:23,279
to talk<font color="#CCCCCC"> about it's a response in a hold</font>

5
00:00:16,590 --> 00:00:26,099
heterogeneous environment so the

6
00:00:23,279 --> 00:00:28,890
investigation<font color="#CCCCCC"> process</font><font color="#E5E5E5"> were primarily</font>

7
00:00:26,099 --> 00:00:31,980
talking<font color="#E5E5E5"> about triage</font><font color="#CCCCCC"> and this is</font><font color="#E5E5E5"> going</font>

8
00:00:28,890 --> 00:00:34,410
<font color="#CCCCCC">to be the key to</font><font color="#E5E5E5"> solving what the actor</font>

9
00:00:31,980 --> 00:00:37,230
is<font color="#CCCCCC"> doing inside your network</font><font color="#E5E5E5"> and then</font>

10
00:00:34,410 --> 00:00:39,809
finding machines<font color="#E5E5E5"> that the actor is</font>

11
00:00:37,230 --> 00:00:44,398
<font color="#E5E5E5">touched but one of the major problems</font>

12
00:00:39,809 --> 00:00:47,280
<font color="#CCCCCC">with most networks</font><font color="#E5E5E5"> is we have multiple</font>

13
00:00:44,399 --> 00:00:51,180
<font color="#CCCCCC">different os's</font><font color="#E5E5E5"> inside the network so</font>

14
00:00:47,280 --> 00:00:55,469
we'll<font color="#E5E5E5"> have Linux we'll have</font><font color="#CCCCCC"> Windows may</font>

15
00:00:51,180 --> 00:01:00,269
have<font color="#E5E5E5"> Solaris AIX and trying to find</font>

16
00:00:55,469 --> 00:01:03,570
tools that<font color="#CCCCCC"> can search all of</font><font color="#E5E5E5"> those os's</font>

17
00:01:00,270 --> 00:01:09,439
<font color="#E5E5E5">and pick out the</font><font color="#CCCCCC"> artifacts</font><font color="#E5E5E5"> that we're</font>

18
00:01:03,570 --> 00:01:09,439
looking<font color="#CCCCCC"> for is as few and far between</font>

19
00:01:09,770 --> 00:01:17,548
our goal<font color="#E5E5E5"> for our triage is to</font><font color="#CCCCCC"> identify</font>

20
00:01:13,799 --> 00:01:22,470
any artifacts<font color="#E5E5E5"> and any unusual</font>

21
00:01:17,549 --> 00:01:26,280
technologies that that the actors are

22
00:01:22,470 --> 00:01:30,048
using also<font color="#CCCCCC"> to is one of the problems is</font>

23
00:01:26,280 --> 00:01:32,970
<font color="#CCCCCC">is having</font><font color="#E5E5E5"> a single tool across all those</font>

24
00:01:30,049 --> 00:01:37,290
<font color="#CCCCCC">types of</font><font color="#E5E5E5"> devices is pretty hard to come</font>

25
00:01:32,970 --> 00:01:40,500
by<font color="#CCCCCC"> as well as</font><font color="#E5E5E5"> searching that environment</font>

26
00:01:37,290 --> 00:01:44,640
<font color="#E5E5E5">for</font><font color="#CCCCCC"> the IO sees that we do develop over</font>

27
00:01:40,500 --> 00:01:47,700
<font color="#CCCCCC">time</font><font color="#E5E5E5"> with the findings</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> we have the</font>

28
00:01:44,640 --> 00:01:52,189
<font color="#E5E5E5">last problem we have is pinpointing the</font>

29
00:01:47,700 --> 00:01:57,540
known badness within all of our os's

30
00:01:52,189 --> 00:01:59,880
<font color="#CCCCCC">which allows</font><font color="#E5E5E5"> us</font><font color="#CCCCCC"> for easier</font><font color="#E5E5E5"> mitigation so</font>

31
00:01:57,540 --> 00:02:03,119
<font color="#E5E5E5">in our approach we want to take all the</font>

32
00:01:59,880 --> 00:02:06,990
<font color="#CCCCCC">IO</font><font color="#E5E5E5"> sees that in play an important</font><font color="#CCCCCC"> role</font>

33
00:02:03,119 --> 00:02:08,848
in<font color="#CCCCCC"> our investigation and have a single</font>

34
00:02:06,990 --> 00:02:12,430
<font color="#E5E5E5">solution where I can touch every single</font>

35
00:02:08,848 --> 00:02:20,518
<font color="#E5E5E5">machine on my</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> in fine</font>

36
00:02:12,430 --> 00:02:24,430
any known indicators are compromised the

37
00:02:20,519 --> 00:02:27,939
traditional<font color="#CCCCCC"> IRA approach is in regards</font>

38
00:02:24,430 --> 00:02:31,120
to<font color="#E5E5E5"> IOC s as contacts so generally we can</font>

39
00:02:27,939 --> 00:02:33,608
IP address we<font color="#E5E5E5"> get M D</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> and we're told</font>

40
00:02:31,120 --> 00:02:35,980
to go search for<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we have no idea</font>

41
00:02:33,609 --> 00:02:38,890
where that<font color="#E5E5E5"> information has come</font><font color="#CCCCCC"> from</font><font color="#E5E5E5"> if</font>

42
00:02:35,980 --> 00:02:42,390
you're<font color="#E5E5E5"> on some of the government lists</font>

43
00:02:38,890 --> 00:02:45,518
where you get indicators of<font color="#E5E5E5"> compromise</font>

44
00:02:42,390 --> 00:02:48,339
<font color="#CCCCCC">you're not 100%</font><font color="#E5E5E5"> sure where those</font>

45
00:02:45,519 --> 00:02:51,129
indicators are coming from<font color="#E5E5E5"> the</font>

46
00:02:48,340 --> 00:02:54,670
application of IOC<font color="#CCCCCC"> s to the environment</font>

47
00:02:51,129 --> 00:02:58,090
is often<font color="#E5E5E5"> role based it's not behavioral</font>

48
00:02:54,670 --> 00:03:00,700
based and the<font color="#E5E5E5"> customized customization</font>

49
00:02:58,090 --> 00:03:04,120
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> IOC s and most of the commercial</font>

50
00:03:00,700 --> 00:03:06,879
<font color="#CCCCCC">products</font><font color="#E5E5E5"> is not</font><font color="#CCCCCC"> an option we you know if</font>

51
00:03:04,120 --> 00:03:10,659
we have<font color="#CCCCCC"> McAfee for example the</font><font color="#E5E5E5"> AV</font>

52
00:03:06,879 --> 00:03:13,590
scanner we just can't go and develop

53
00:03:10,659 --> 00:03:16,290
signatures for it for the most<font color="#CCCCCC"> part so</font>

54
00:03:13,590 --> 00:03:19,510
the other thing<font color="#E5E5E5"> is we have</font><font color="#CCCCCC"> rule-based</font>

55
00:03:16,290 --> 00:03:22,929
<font color="#E5E5E5">detection and a lot of</font><font color="#CCCCCC"> times</font><font color="#E5E5E5"> these tools</font>

56
00:03:19,510 --> 00:03:26,190
will miss changes that the actor is made

57
00:03:22,930 --> 00:03:30,879
so if the actor changes<font color="#E5E5E5"> one or two</font><font color="#CCCCCC"> bytes</font>

58
00:03:26,190 --> 00:03:32,409
<font color="#E5E5E5">md5 hash is no longer work</font><font color="#CCCCCC"> you know it</font>

59
00:03:30,879 --> 00:03:40,090
just<font color="#E5E5E5"> depends on what's all being changed</font>

60
00:03:32,409 --> 00:03:43,478
by<font color="#E5E5E5"> the actors so our</font><font color="#CCCCCC"> idea to</font><font color="#E5E5E5"> help</font>

61
00:03:40,090 --> 00:03:46,060
address this issue is we know<font color="#E5E5E5"> that</font>

62
00:03:43,479 --> 00:03:48,639
<font color="#E5E5E5">production of code always leaves traces</font>

63
00:03:46,060 --> 00:03:50,319
in any binary<font color="#E5E5E5"> so there's gonna be</font>

64
00:03:48,639 --> 00:03:53,109
certain<font color="#E5E5E5"> libraries there gonna be certain</font>

65
00:03:50,319 --> 00:03:55,018
pieces<font color="#E5E5E5"> of tax in each of the binaries</font>

66
00:03:53,109 --> 00:03:57,510
<font color="#CCCCCC">that we're gonna be able to look for</font>

67
00:03:55,019 --> 00:04:01,180
some<font color="#CCCCCC"> of the binaries may contain</font>

68
00:03:57,510 --> 00:04:03,190
debugging symbols<font color="#CCCCCC"> so if you get lucky to</font>

69
00:04:01,180 --> 00:04:06,090
have that you<font color="#CCCCCC"> have a lot of potential</font>

70
00:04:03,190 --> 00:04:09,010
information<font color="#CCCCCC"> within the binary and</font>

71
00:04:06,090 --> 00:04:11,949
oftentimes<font color="#E5E5E5"> a lot the</font><font color="#CCCCCC"> attacker's tools</font>

72
00:04:09,010 --> 00:04:15,989
<font color="#CCCCCC">only use certain libraries or certain</font>

73
00:04:11,949 --> 00:04:18,330
functions that we<font color="#E5E5E5"> can search for</font>

74
00:04:15,990 --> 00:04:21,240
a lot of the<font color="#CCCCCC"> fingerprinting</font><font color="#E5E5E5"> can be done</font>

75
00:04:18,329 --> 00:04:24,469
with software<font color="#E5E5E5"> and this is</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be</font>

76
00:04:21,240 --> 00:04:28,380
really<font color="#CCCCCC"> useful for our IR analysis</font>

77
00:04:24,470 --> 00:04:31,410
combining the<font color="#CCCCCC"> information of both</font><font color="#E5E5E5"> can</font>

78
00:04:28,380 --> 00:04:34,920
help solve the attribution problem<font color="#CCCCCC"> so we</font>

79
00:04:31,410 --> 00:04:37,710
want to you<font color="#CCCCCC"> know make sure we're helping</font>

80
00:04:34,920 --> 00:04:41,600
<font color="#E5E5E5">the assessment of the risk identifying</font>

81
00:04:37,710 --> 00:04:44,549
the end goals of the actors<font color="#E5E5E5"> and create</font>

82
00:04:41,600 --> 00:04:47,520
actionable<font color="#CCCCCC"> IO sees</font><font color="#E5E5E5"> that aren't</font>

83
00:04:44,550 --> 00:04:50,880
disposable<font color="#E5E5E5"> as we know iOS es are only</font>

84
00:04:47,520 --> 00:04:52,169
good for X<font color="#E5E5E5"> amount of days or weeks</font><font color="#CCCCCC"> so we</font>

85
00:04:50,880 --> 00:04:54,719
want<font color="#E5E5E5"> to have something</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> going to</font>

86
00:04:52,170 --> 00:04:58,410
be good for<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that's a</font><font color="#E5E5E5"> longer</font>

87
00:04:54,720 --> 00:05:04,620
period of time<font color="#E5E5E5"> than just you know</font><font color="#CCCCCC"> 20</font>

88
00:04:58,410 --> 00:05:09,840
days one of<font color="#CCCCCC"> the tools that I developed</font>

89
00:05:04,620 --> 00:05:13,440
to to help<font color="#E5E5E5"> when we do triage and</font>

90
00:05:09,840 --> 00:05:17,099
mitigation<font color="#CCCCCC"> this first tool is called RIF</font>

91
00:05:13,440 --> 00:05:20,880
retrieve interesting<font color="#CCCCCC"> files tool and</font>

92
00:05:17,100 --> 00:05:24,390
basically it takes a file that has<font color="#CCCCCC"> a red</font>

93
00:05:20,880 --> 00:05:27,780
<font color="#CCCCCC">X</font><font color="#E5E5E5"> a list</font><font color="#CCCCCC"> the next</font><font color="#E5E5E5"> slide will show that</font>

94
00:05:24,390 --> 00:05:31,500
<font color="#E5E5E5">but we're going to be able to grab those</font>

95
00:05:27,780 --> 00:05:34,770
files forensics<font color="#CCCCCC"> ly from a machine</font><font color="#E5E5E5"> use a</font>

96
00:05:31,500 --> 00:05:37,140
sleuth kit to grab those files<font color="#CCCCCC"> it's</font>

97
00:05:34,770 --> 00:05:40,740
going to output<font color="#CCCCCC"> the files into</font><font color="#E5E5E5"> a</font>

98
00:05:37,140 --> 00:05:43,260
directory<font color="#E5E5E5"> so it starts off with</font><font color="#CCCCCC"> a the</font>

99
00:05:40,740 --> 00:05:45,270
directory of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> machine and then</font><font color="#CCCCCC"> it</font>

100
00:05:43,260 --> 00:05:47,789
recreates<font color="#E5E5E5"> the whole directory</font><font color="#CCCCCC"> structure</font>

101
00:05:45,270 --> 00:05:51,030
<font color="#E5E5E5">and puts those files in to wherever we</font>

102
00:05:47,790 --> 00:05:54,720
we tell it that's not part of them the

103
00:05:51,030 --> 00:05:56,369
drive that<font color="#E5E5E5"> we're looking at so</font><font color="#CCCCCC"> initially</font>

104
00:05:54,720 --> 00:05:58,530
you know we can use this tool have

105
00:05:56,370 --> 00:06:08,910
everything's either saved to a remote

106
00:05:58,530 --> 00:06:11,729
share or a USB<font color="#E5E5E5"> just turn all these point</font>

107
00:06:08,910 --> 00:06:14,250
around<font color="#E5E5E5"> so in here this is this is all it</font>

108
00:06:11,730 --> 00:06:17,700
takes<font color="#E5E5E5"> to run the tool as long as</font>

109
00:06:14,250 --> 00:06:19,790
everything<font color="#E5E5E5"> is in</font><font color="#CCCCCC"> the directory that was</font>

110
00:06:17,700 --> 00:06:22,800
located<font color="#E5E5E5"> on the remote share for example</font>

111
00:06:19,790 --> 00:06:24,300
<font color="#CCCCCC">this is how we run it you guys</font><font color="#E5E5E5"> are</font>

112
00:06:22,800 --> 00:06:27,650
interested in the<font color="#E5E5E5"> project this is where</font>

113
00:06:24,300 --> 00:06:31,020
you can go<font color="#CCCCCC"> to download it</font>

114
00:06:27,650 --> 00:06:34,049
so this is a small sample of<font color="#E5E5E5"> some of the</font>

115
00:06:31,020 --> 00:06:37,320
artifacts that<font color="#E5E5E5"> we're going to grab when</font>

116
00:06:34,050 --> 00:06:40,350
we're doing triage on the machines<font color="#E5E5E5"> and</font>

117
00:06:37,320 --> 00:06:42,719
when I say triage I'm not talking<font color="#E5E5E5"> five</font>

118
00:06:40,350 --> 00:06:45,570
machines or<font color="#E5E5E5"> ten machines I'm talking</font>

119
00:06:42,720 --> 00:06:49,350
<font color="#CCCCCC">twenty thousand or thousand two hundred</font>

120
00:06:45,570 --> 00:06:50,639
thousand machines<font color="#E5E5E5"> so we're</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> grab a</font>

121
00:06:49,350 --> 00:06:58,970
whole bunch<font color="#CCCCCC"> of</font><font color="#E5E5E5"> files</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going to go</font>

122
00:06:50,639 --> 00:07:02,460
through<font color="#E5E5E5"> looking for IOC s now frac is</font>

123
00:06:58,970 --> 00:07:05,850
the forensics response acquisition<font color="#E5E5E5"> and</font>

124
00:07:02,460 --> 00:07:09,180
what<font color="#E5E5E5"> this is is basically allows us</font><font color="#CCCCCC"> to</font>

125
00:07:05,850 --> 00:07:10,979
<font color="#E5E5E5">run rift over the network so rift is was</font>

126
00:07:09,180 --> 00:07:14,520
originally<font color="#CCCCCC"> created so I can so I can</font>

127
00:07:10,979 --> 00:07:16,590
give it<font color="#CCCCCC"> to Johnny desktop admin go get</font>

128
00:07:14,520 --> 00:07:19,760
me files from single<font color="#CCCCCC"> machine this</font><font color="#E5E5E5"> one</font>

129
00:07:16,590 --> 00:07:24,960
allows me to do it across<font color="#E5E5E5"> the network</font><font color="#CCCCCC"> I</font>

130
00:07:19,760 --> 00:07:29,219
have built in there a CMD dot txt which

131
00:07:24,960 --> 00:07:33,599
has several examples<font color="#CCCCCC"> free pre configured</font>

132
00:07:29,220 --> 00:07:38,820
<font color="#E5E5E5">examples of using it to using rift to</font>

133
00:07:33,599 --> 00:07:42,990
grab files<font color="#CCCCCC"> we use PA exact or SSH if</font>

134
00:07:38,820 --> 00:07:45,840
we're or SSH<font color="#CCCCCC"> Pass if it's a Linux box it</font>

135
00:07:42,990 --> 00:07:48,840
does require<font color="#CCCCCC"> Emin rights and it does</font>

136
00:07:45,840 --> 00:07:51,119
<font color="#E5E5E5">require a remote share so as long as</font>

137
00:07:48,840 --> 00:07:55,489
whatever machine you're connecting it to

138
00:07:51,120 --> 00:07:59,699
can mount the remote share<font color="#E5E5E5"> you're golden</font>

139
00:07:55,490 --> 00:08:05,220
it supports<font color="#E5E5E5"> single IP</font><font color="#CCCCCC"> cider notation and</font>

140
00:07:59,699 --> 00:08:08,909
IP<font color="#CCCCCC"> arranged and just this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> what it</font>

141
00:08:05,220 --> 00:08:12,270
looks<font color="#E5E5E5"> like to run we have our IP list so</font>

142
00:08:08,909 --> 00:08:14,969
you know one of these examples from<font color="#E5E5E5"> here</font>

143
00:08:12,270 --> 00:08:17,639
we have the example command<font color="#E5E5E5"> text that we</font>

144
00:08:14,970 --> 00:08:22,729
wanted<font color="#E5E5E5"> to run and verbose if we just</font>

145
00:08:17,639 --> 00:08:25,500
want to see<font color="#E5E5E5"> what what's going on with</font><font color="#CCCCCC"> it</font>

146
00:08:22,729 --> 00:08:28,860
down here in these two boxes<font color="#CCCCCC"> here we</font>

147
00:08:25,500 --> 00:08:31,650
have a<font color="#CCCCCC"> Windows example PA exact I did</font>

148
00:08:28,860 --> 00:08:33,450
try<font color="#CCCCCC"> to get this</font><font color="#E5E5E5"> - well</font><font color="#CCCCCC"> it does work with</font>

149
00:08:31,650 --> 00:08:34,949
<font color="#E5E5E5">PS exact</font><font color="#CCCCCC"> what the problem is is that</font>

150
00:08:33,450 --> 00:08:37,740
user

151
00:08:34,950 --> 00:08:39,779
we'll see<font color="#E5E5E5"> that it's running</font><font color="#CCCCCC"> you know I</font>

152
00:08:37,740 --> 00:08:41,789
know you can say hide the window and all

153
00:08:39,779 --> 00:08:45,089
<font color="#CCCCCC">that but they can go in the task list</font>

154
00:08:41,789 --> 00:08:46,860
<font color="#E5E5E5">and and kill the</font><font color="#CCCCCC"> process with PA exact</font>

155
00:08:45,089 --> 00:08:48,990
it's a little harder for<font color="#E5E5E5"> a user to come</font>

156
00:08:46,860 --> 00:08:53,160
in and start<font color="#CCCCCC"> killing your processes when</font>

157
00:08:48,990 --> 00:08:55,560
you're trying to retrieve data<font color="#E5E5E5"> in here</font>

158
00:08:53,160 --> 00:08:59,790
there's a config file<font color="#CCCCCC"> what pulls in the</font>

159
00:08:55,560 --> 00:09:03,569
<font color="#E5E5E5">admin and admin password here's where</font>

160
00:08:59,790 --> 00:09:07,529
it's going to<font color="#E5E5E5"> mount the shared</font><font color="#CCCCCC"> drive and</font>

161
00:09:03,570 --> 00:09:11,970
then we get into seeding<font color="#CCCCCC"> into our save</font>

162
00:09:07,529 --> 00:09:16,560
<font color="#E5E5E5">shared drive run</font><font color="#CCCCCC"> Rift</font><font color="#E5E5E5"> and then we remove</font>

163
00:09:11,970 --> 00:09:20,250
<font color="#CCCCCC">the share so connects monster</font><font color="#E5E5E5"> drive runs</font>

164
00:09:16,560 --> 00:09:23,518
rift<font color="#E5E5E5"> grabs the files we need disconnects</font>

165
00:09:20,250 --> 00:09:26,519
<font color="#E5E5E5">the share and then exits so for the most</font>

166
00:09:23,519 --> 00:09:28,140
<font color="#E5E5E5">part there's there's nothing</font><font color="#CCCCCC"> net</font><font color="#E5E5E5"> there's</font>

167
00:09:26,519 --> 00:09:31,410
a<font color="#E5E5E5"> little bit that changes on the machine</font>

168
00:09:28,140 --> 00:09:33,800
<font color="#CCCCCC">but we don't do a whole</font><font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of changes</font>

169
00:09:31,410 --> 00:09:41,310
<font color="#CCCCCC">to the machine</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a UNIX example</font>

170
00:09:33,800 --> 00:09:45,209
use an<font color="#CCCCCC"> ssh pass and this is what the</font>

171
00:09:41,310 --> 00:09:47,550
output<font color="#CCCCCC"> of the tool</font><font color="#E5E5E5"> looks like so here</font><font color="#CCCCCC"> i</font>

172
00:09:45,209 --> 00:09:50,849
have machine a<font color="#E5E5E5"> so it it does resolve the</font>

173
00:09:47,550 --> 00:09:55,290
hostname we have the date<font color="#CCCCCC"> and time that</font>

174
00:09:50,850 --> 00:10:00,000
<font color="#E5E5E5">the directory was created and then here</font>

175
00:09:55,290 --> 00:10:02,430
is a list<font color="#E5E5E5"> of the files that it retrieved</font>

176
00:10:00,000 --> 00:10:05,670
<font color="#CCCCCC">now this is a UNIX example versus a</font>

177
00:10:02,430 --> 00:10:09,390
Windows example but<font color="#E5E5E5"> you know I've asked</font>

178
00:10:05,670 --> 00:10:12,560
for<font color="#E5E5E5"> all of</font><font color="#CCCCCC"> Etsy to be retrieved there's</font>

179
00:10:09,390 --> 00:10:13,980
<font color="#E5E5E5">information from home that I want like</font>

180
00:10:12,560 --> 00:10:22,500
<font color="#E5E5E5">SSH</font>

181
00:10:13,980 --> 00:10:27,449
bash history dot<font color="#E5E5E5"> be a bash anyways and</font>

182
00:10:22,500 --> 00:10:30,180
then<font color="#E5E5E5"> opt</font><font color="#CCCCCC"> routing</font><font color="#E5E5E5"> information</font><font color="#CCCCCC"> gif files</font>

183
00:10:27,449 --> 00:10:32,579
that's been contain all<font color="#CCCCCC"> of the files</font>

184
00:10:30,180 --> 00:10:34,529
retrieved<font color="#E5E5E5"> as well as the</font><font color="#CCCCCC"> ID</font><font color="#E5E5E5"> known</font>

185
00:10:32,579 --> 00:10:35,969
numbers<font color="#CCCCCC"> if for</font><font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> reason when</font>

186
00:10:34,529 --> 00:10:39,029
you're doing forensic so if you need it

187
00:10:35,970 --> 00:10:41,760
and because a tool does use sleuth kit

188
00:10:39,029 --> 00:10:43,680
we<font color="#CCCCCC"> have the FLS output so now we have</font>

189
00:10:41,760 --> 00:10:44,860
<font color="#CCCCCC">all our timestamps</font><font color="#E5E5E5"> I don't have to go</font>

190
00:10:43,680 --> 00:10:48,250
through<font color="#E5E5E5"> and parse anything</font>

191
00:10:44,860 --> 00:11:06,940
I have it all right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> in ASCII format</font>

192
00:10:48,250 --> 00:11:11,110
<font color="#CCCCCC">I think you</font><font color="#E5E5E5"> hear me</font>

193
00:11:06,940 --> 00:11:16,720
well so first apologize for my spaghetti

194
00:11:11,110 --> 00:11:19,980
English anyway<font color="#E5E5E5"> action of biases are one</font>

195
00:11:16,720 --> 00:11:23,140
of the items<font color="#CCCCCC"> where we focus our</font>

196
00:11:19,980 --> 00:11:25,540
investigation<font color="#CCCCCC"> all</font><font color="#E5E5E5"> men to</font><font color="#CCCCCC"> be precise our</font>

197
00:11:23,140 --> 00:11:29,050
methodology<font color="#CCCCCC"> so what</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> means what it</font>

198
00:11:25,540 --> 00:11:31,449
<font color="#E5E5E5">means basically</font><font color="#CCCCCC"> we have in time</font><font color="#E5E5E5"> develop</font>

199
00:11:29,050 --> 00:11:34,780
at a knowledge base that<font color="#CCCCCC"> is actionable</font>

200
00:11:31,450 --> 00:11:37,720
<font color="#CCCCCC">in the way that normally integrate it in</font>

201
00:11:34,780 --> 00:11:41,500
inside not<font color="#CCCCCC"> just the thermic</font><font color="#E5E5E5"> Isis but we</font>

202
00:11:37,720 --> 00:11:44,590
integrate<font color="#E5E5E5"> general generalized IOC s</font>

203
00:11:41,500 --> 00:11:47,440
<font color="#E5E5E5">coming from the atomic</font><font color="#CCCCCC"> iosys so normally</font>

204
00:11:44,590 --> 00:11:49,690
we create IOC<font color="#CCCCCC"> s for the Opera</font><font color="#E5E5E5"> for the</font>

205
00:11:47,440 --> 00:11:51,460
purpose<font color="#CCCCCC"> of resolving an incident you</font>

206
00:11:49,690 --> 00:11:55,150
<font color="#CCCCCC">know in an environment but we don't</font>

207
00:11:51,460 --> 00:11:58,780
normally destroy or forget<font color="#CCCCCC"> about</font><font color="#E5E5E5"> these</font>

208
00:11:55,150 --> 00:12:01,600
<font color="#E5E5E5">Isis we tend to integrate them we</font><font color="#CCCCCC"> tends</font>

209
00:11:58,780 --> 00:12:05,110
<font color="#E5E5E5">to understand the commonalities between</font>

210
00:12:01,600 --> 00:12:07,690
different situation<font color="#E5E5E5"> related to the same</font>

211
00:12:05,110 --> 00:12:10,180
attacker<font color="#E5E5E5"> so from that perspective</font><font color="#CCCCCC"> we</font>

212
00:12:07,690 --> 00:12:14,440
have at this point<font color="#CCCCCC"> a</font><font color="#E5E5E5"> number</font><font color="#CCCCCC"> of different</font>

213
00:12:10,180 --> 00:12:16,839
<font color="#CCCCCC">ICS that</font><font color="#E5E5E5"> try to integrate in a single</font>

214
00:12:14,440 --> 00:12:18,940
set of<font color="#CCCCCC"> expressions the entire set of the</font>

215
00:12:16,840 --> 00:12:21,970
tools<font color="#E5E5E5"> that</font><font color="#CCCCCC"> yet occur use and from that</font>

216
00:12:18,940 --> 00:12:25,270
perspective it pays<font color="#CCCCCC"> well</font><font color="#E5E5E5"> not much into</font>

217
00:12:21,970 --> 00:12:27,160
the searching part<font color="#E5E5E5"> but more into the</font>

218
00:12:25,270 --> 00:12:28,900
attribution part that is one of the most

219
00:12:27,160 --> 00:12:32,829
important aspect<font color="#E5E5E5"> during the</font>

220
00:12:28,900 --> 00:12:35,980
<font color="#E5E5E5">investigation the</font><font color="#CCCCCC"> IR investigation so</font>

221
00:12:32,830 --> 00:12:37,750
basically the<font color="#E5E5E5"> procedure the the</font>

222
00:12:35,980 --> 00:12:41,350
methodologies are set a procedure that

223
00:12:37,750 --> 00:12:43,780
<font color="#E5E5E5">we utilize analysis evidences in a</font>

224
00:12:41,350 --> 00:12:46,890
methodical<font color="#E5E5E5"> approach</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we don't just say</font>

225
00:12:43,780 --> 00:12:50,350
<font color="#E5E5E5">ok we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> this this and</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> systems</font>

226
00:12:46,890 --> 00:12:52,270
<font color="#E5E5E5">touched by the attacker but we also try</font>

227
00:12:50,350 --> 00:12:55,600
to figure<font color="#E5E5E5"> out the commonality between</font>

228
00:12:52,270 --> 00:12:56,899
this environment<font color="#E5E5E5"> and another customer we</font>

229
00:12:55,600 --> 00:12:59,420
<font color="#CCCCCC">have MS</font>

230
00:12:56,899 --> 00:13:01,639
in the past<font color="#E5E5E5"> related to potentially the</font>

231
00:12:59,420 --> 00:13:06,680
same<font color="#E5E5E5"> type of attacker or even the same</font>

232
00:13:01,639 --> 00:13:09,829
exact<font color="#CCCCCC"> apt group</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> thanks to this</font>

233
00:13:06,680 --> 00:13:12,109
when we<font color="#CCCCCC"> arranged the mitigation</font><font color="#E5E5E5"> and we</font>

234
00:13:09,829 --> 00:13:14,229
will still in the<font color="#E5E5E5"> process of resolving</font>

235
00:13:12,110 --> 00:13:17,540
the incident<font color="#E5E5E5"> during the investigation</font>

236
00:13:14,230 --> 00:13:21,019
<font color="#E5E5E5">knowing what who is the attacker</font><font color="#CCCCCC"> we can</font>

237
00:13:17,540 --> 00:13:24,410
figure out well how<font color="#CCCCCC"> to put our nose into</font>

238
00:13:21,019 --> 00:13:28,130
first to go<font color="#E5E5E5"> continue looking into into</font>

239
00:13:24,410 --> 00:13:29,899
the situation so the database creation

240
00:13:28,130 --> 00:13:31,220
the<font color="#E5E5E5"> knowledge</font><font color="#CCCCCC"> base creation is one of</font>

241
00:13:29,899 --> 00:13:33,980
the most important aspect of the

242
00:13:31,220 --> 00:13:36,800
actionable<font color="#CCCCCC"> IOC's methodology</font><font color="#E5E5E5"> the other</font>

243
00:13:33,980 --> 00:13:40,750
is<font color="#CCCCCC"> obviously the commitment to continue</font>

244
00:13:36,800 --> 00:13:45,139
to<font color="#CCCCCC"> integrate things into the database</font>

245
00:13:40,750 --> 00:13:47,630
<font color="#CCCCCC">the central part</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> our methodology</font><font color="#E5E5E5"> for</font>

246
00:13:45,139 --> 00:13:50,570
the actionable<font color="#E5E5E5"> Isis came from the Amara</font>

247
00:13:47,630 --> 00:13:52,939
<font color="#CCCCCC">Nasus I am the focal point in RSA I</font><font color="#E5E5E5"> our</font>

248
00:13:50,570 --> 00:13:55,820
team for them our analysis I normally

249
00:13:52,940 --> 00:13:58,639
tends to check also<font color="#E5E5E5"> the work of the</font>

250
00:13:55,820 --> 00:14:02,390
others and from this exact situation

251
00:13:58,639 --> 00:14:06,709
that runs every engagement<font color="#E5E5E5"> we have been</font>

252
00:14:02,390 --> 00:14:08,600
able to<font color="#E5E5E5"> centralize on me the creation of</font>

253
00:14:06,709 --> 00:14:10,760
<font color="#E5E5E5">this actionable IOC's knowledgebase</font>

254
00:14:08,600 --> 00:14:13,370
<font color="#E5E5E5">thanks it is basically</font><font color="#CCCCCC"> I normally</font>

255
00:14:10,760 --> 00:14:17,569
collect<font color="#E5E5E5"> the atomic Isis from the other</font>

256
00:14:13,370 --> 00:14:23,380
analysts the other<font color="#CCCCCC"> IR groups and I tend</font>

257
00:14:17,570 --> 00:14:26,870
to verify by<font color="#E5E5E5"> comparison by analysis by</font>

258
00:14:23,380 --> 00:14:30,019
debugging by disassembling<font color="#E5E5E5"> if we have</font>

259
00:14:26,870 --> 00:14:34,070
the<font color="#CCCCCC"> chance to expand our knowledge</font><font color="#E5E5E5"> base</font>

260
00:14:30,019 --> 00:14:35,959
for that particular type of attacker one

261
00:14:34,070 --> 00:14:39,890
example<font color="#CCCCCC"> oh sorry</font>

262
00:14:35,959 --> 00:14:42,979
so one example is<font color="#E5E5E5"> poison ivy</font><font color="#CCCCCC"> everybody</font>

263
00:14:39,890 --> 00:14:47,120
in the<font color="#CCCCCC"> ir field knows</font><font color="#E5E5E5"> post</font><font color="#CCCCCC"> navi</font><font color="#E5E5E5"> is even</font>

264
00:14:42,980 --> 00:14:49,579
not really an apt related tool more<font color="#CCCCCC"> as</font>

265
00:14:47,120 --> 00:14:52,550
<font color="#CCCCCC">cybercrime</font><font color="#E5E5E5"> no tool but in the past you</font>

266
00:14:49,579 --> 00:14:55,489
<font color="#CCCCCC">know apt groups tend also to to use what</font>

267
00:14:52,550 --> 00:14:57,829
is reliable and<font color="#CCCCCC"> and a poison ivy was</font>

268
00:14:55,490 --> 00:15:01,220
reliable<font color="#CCCCCC"> rat I mean definitely</font><font color="#E5E5E5"> one of</font>

269
00:14:57,829 --> 00:15:05,800
<font color="#E5E5E5">the most well coded in the past and up</font>

270
00:15:01,220 --> 00:15:08,630
to the<font color="#E5E5E5"> 2013 many attackers were using</font>

271
00:15:05,800 --> 00:15:10,160
poison ivy<font color="#E5E5E5"> obviously is difficult from</font>

272
00:15:08,630 --> 00:15:14,480
<font color="#E5E5E5">that perspective to con</font>

273
00:15:10,160 --> 00:15:18,920
the poison ivy<font color="#E5E5E5"> analysis able to define</font>

274
00:15:14,480 --> 00:15:21,529
one specific apt group many use it<font color="#CCCCCC"> as</font>

275
00:15:18,920 --> 00:15:23,420
like mimikatz you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> distribute by</font>

276
00:15:21,529 --> 00:15:25,040
looking and finding<font color="#E5E5E5"> mimikatz in the</font>

277
00:15:23,420 --> 00:15:29,269
system<font color="#E5E5E5"> who is behind this attack</font>

278
00:15:25,040 --> 00:15:33,250
obviously but in the end between 2013

279
00:15:29,269 --> 00:15:37,189
2014<font color="#E5E5E5"> the interest of the collectivities</font>

280
00:15:33,250 --> 00:15:41,240
<font color="#E5E5E5">related to the attacks</font><font color="#CCCCCC"> tends</font><font color="#E5E5E5"> to discard</font>

281
00:15:37,189 --> 00:15:43,599
<font color="#CCCCCC">the poison ivy well in recent days I</font>

282
00:15:41,240 --> 00:15:47,000
mean two years<font color="#E5E5E5"> ago we started</font><font color="#CCCCCC"> to notice</font>

283
00:15:43,600 --> 00:15:49,490
again<font color="#CCCCCC"> poison ivy coming in specific in</font>

284
00:15:47,000 --> 00:15:52,129
the Asian<font color="#E5E5E5"> area and for specific</font>

285
00:15:49,490 --> 00:15:56,000
<font color="#E5E5E5">attackers of that half of the place so</font>

286
00:15:52,129 --> 00:15:58,610
in this case the<font color="#E5E5E5"> the search code</font>

287
00:15:56,000 --> 00:16:02,180
especially<font color="#E5E5E5"> the variant of poison ivy</font>

288
00:15:58,610 --> 00:16:04,639
<font color="#CCCCCC">were using HTTP transmission and we're</font>

289
00:16:02,180 --> 00:16:06,258
able<font color="#E5E5E5"> to sneak through proxies something</font>

290
00:16:04,639 --> 00:16:09,319
that the original poison<font color="#CCCCCC"> ivy</font><font color="#E5E5E5"> was not</font>

291
00:16:06,259 --> 00:16:12,350
able<font color="#E5E5E5"> to so by looking at this by looking</font>

292
00:16:09,319 --> 00:16:14,269
<font color="#CCCCCC">up the content</font><font color="#E5E5E5"> into by looking at all</font>

293
00:16:12,350 --> 00:16:16,819
the<font color="#E5E5E5"> yarrow</font><font color="#CCCCCC"> rules already generated the</font>

294
00:16:14,269 --> 00:16:20,899
<font color="#CCCCCC">past by other researches we have been</font>

295
00:16:16,819 --> 00:16:23,649
able<font color="#E5E5E5"> to generate a single</font><font color="#CCCCCC"> yara that room</font>

296
00:16:20,899 --> 00:16:26,689
demo and from that perspective now

297
00:16:23,649 --> 00:16:29,360
having<font color="#E5E5E5"> that having specific items</font>

298
00:16:26,689 --> 00:16:32,060
related<font color="#CCCCCC"> to this particular type of</font>

299
00:16:29,360 --> 00:16:35,720
<font color="#E5E5E5">variant we can</font><font color="#CCCCCC"> easily start to</font>

300
00:16:32,060 --> 00:16:39,939
understand<font color="#CCCCCC"> which is behind the use of</font>

301
00:16:35,720 --> 00:16:42,949
<font color="#E5E5E5">poison ivy</font><font color="#CCCCCC"> in an environment</font><font color="#E5E5E5"> I don't</font>

302
00:16:39,939 --> 00:16:45,079
<font color="#E5E5E5">think it's important to go into</font><font color="#CCCCCC"> the</font>

303
00:16:42,949 --> 00:16:47,389
detail poison<font color="#E5E5E5"> I'm sorry</font><font color="#CCCCCC"> or for the</font>

304
00:16:45,079 --> 00:16:49,939
yellow<font color="#CCCCCC"> room poison ivy but</font><font color="#E5E5E5"> this is much</font>

305
00:16:47,389 --> 00:16:52,250
for<font color="#E5E5E5"> posterity</font><font color="#CCCCCC"> for you guys to see</font><font color="#E5E5E5"> okay</font>

306
00:16:49,939 --> 00:16:54,949
<font color="#E5E5E5">this is the first part is the latest</font>

307
00:16:52,250 --> 00:16:57,800
part the second part<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the string of</font>

308
00:16:54,949 --> 00:17:01,189
matching<font color="#E5E5E5"> the old version of poison ivy</font>

309
00:16:57,800 --> 00:17:04,099
<font color="#E5E5E5">and this is a the last part is for the</font>

310
00:17:01,189 --> 00:17:07,339
<font color="#CCCCCC">decompressor because being</font><font color="#E5E5E5"> so diffuse it</font>

311
00:17:04,099 --> 00:17:10,399
being so easy<font color="#E5E5E5"> to detect the attacker</font><font color="#CCCCCC"> in</font>

312
00:17:07,339 --> 00:17:14,569
the past<font color="#E5E5E5"> decided to use encryption to</font>

313
00:17:10,400 --> 00:17:18,500
<font color="#CCCCCC">protect</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> deportable acceptable 404</font>

314
00:17:14,569 --> 00:17:21,049
<font color="#CCCCCC">Yarra so this is when</font><font color="#E5E5E5"> you look</font><font color="#CCCCCC"> into the</font>

315
00:17:18,500 --> 00:17:23,630
code<font color="#E5E5E5"> of</font><font color="#CCCCCC"> inane execution in memory</font>

316
00:17:21,049 --> 00:17:27,680
because obviously you can now even

317
00:17:23,630 --> 00:17:29,990
go into this<font color="#CCCCCC"> chang-su yarra</font><font color="#E5E5E5"> so this is</font>

318
00:17:27,680 --> 00:17:33,920
the formalization<font color="#CCCCCC"> process for the action</font>

319
00:17:29,990 --> 00:17:36,830
of<font color="#E5E5E5"> Isis</font><font color="#CCCCCC"> we collect</font><font color="#E5E5E5"> atomic Isis then we</font>

320
00:17:33,920 --> 00:17:40,160
go for<font color="#E5E5E5"> classification and attribution</font>

321
00:17:36,830 --> 00:17:43,429
base of out<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> number of checks</font>

322
00:17:40,160 --> 00:17:46,940
especially the yarra<font color="#CCCCCC"> rule related to</font>

323
00:17:43,430 --> 00:17:48,890
this configuration of<font color="#CCCCCC"> the string of</font>

324
00:17:46,940 --> 00:17:52,940
presented<font color="#E5E5E5"> into the portable executable</font>

325
00:17:48,890 --> 00:17:57,650
<font color="#E5E5E5">but also we use the war into the</font><font color="#CCCCCC"> packet</font>

326
00:17:52,940 --> 00:18:00,170
analysis<font color="#E5E5E5"> so er can help also digging</font>

327
00:17:57,650 --> 00:18:04,100
<font color="#E5E5E5">into the</font><font color="#CCCCCC"> pickup's</font><font color="#E5E5E5"> so if you create a</font>

328
00:18:00,170 --> 00:18:07,100
single<font color="#CCCCCC"> yarra that is</font><font color="#E5E5E5"> able also to look</font>

329
00:18:04,100 --> 00:18:10,159
into the<font color="#CCCCCC"> pickup's with a proper type of</font>

330
00:18:07,100 --> 00:18:12,649
approach<font color="#E5E5E5"> you can continue</font><font color="#CCCCCC"> to keep one</font>

331
00:18:10,160 --> 00:18:14,840
<font color="#E5E5E5">everything in one single</font><font color="#CCCCCC"> yarra ruling</font>

332
00:18:12,650 --> 00:18:17,180
also<font color="#CCCCCC"> the communication so even in case</font>

333
00:18:14,840 --> 00:18:21,050
where you can't find immediate feedback

334
00:18:17,180 --> 00:18:24,260
<font color="#E5E5E5">out of the yarra description the the you</font>

335
00:18:21,050 --> 00:18:27,649
<font color="#E5E5E5">are up the the aspect of the portable</font>

336
00:18:24,260 --> 00:18:29,629
<font color="#E5E5E5">executable you can still identify the</font>

337
00:18:27,650 --> 00:18:32,650
attacker<font color="#E5E5E5"> and that particular type</font>

338
00:18:29,630 --> 00:18:35,720
<font color="#CCCCCC">version</font><font color="#E5E5E5"> thanks to the fact that the the</font>

339
00:18:32,650 --> 00:18:39,500
<font color="#CCCCCC">stream of communication continued</font><font color="#E5E5E5"> to be</font>

340
00:18:35,720 --> 00:18:42,800
almost the<font color="#CCCCCC"> same and</font><font color="#E5E5E5"> obviously other</font>

341
00:18:39,500 --> 00:18:45,410
<font color="#E5E5E5">items that we keep into our analysis is</font>

342
00:18:42,800 --> 00:18:47,810
a number of other items<font color="#E5E5E5"> like artifacts</font>

343
00:18:45,410 --> 00:18:50,860
<font color="#E5E5E5">in system mutex</font>

344
00:18:47,810 --> 00:18:53,419
for example stuff that it's obviously

345
00:18:50,860 --> 00:18:56,870
dynamic so it's not more into the<font color="#CCCCCC"> yarra</font>

346
00:18:53,420 --> 00:18:59,690
to look for but<font color="#CCCCCC"> still we</font><font color="#E5E5E5"> can have send</font>

347
00:18:56,870 --> 00:19:02,959
boxes to have that or<font color="#CCCCCC"> the bagging or</font>

348
00:18:59,690 --> 00:19:06,050
other way to check and still having the

349
00:19:02,960 --> 00:19:08,330
chance<font color="#CCCCCC"> to identify</font><font color="#E5E5E5"> this version is</font>

350
00:19:06,050 --> 00:19:11,389
<font color="#CCCCCC">linked</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> particular chakra the</font>

351
00:19:08,330 --> 00:19:14,899
particular campaign another one<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is</font>

352
00:19:11,390 --> 00:19:18,620
<font color="#CCCCCC">an example is a Trojan bison all by the</font>

353
00:19:14,900 --> 00:19:21,470
<font color="#CCCCCC">know</font><font color="#E5E5E5"> is a</font><font color="#CCCCCC"> backdoor</font><font color="#E5E5E5"> and it's mainly</font>

354
00:19:18,620 --> 00:19:25,040
separated in two<font color="#CCCCCC"> part</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> part is the</font>

355
00:19:21,470 --> 00:19:28,190
main module that is the<font color="#E5E5E5"> center of the</font>

356
00:19:25,040 --> 00:19:30,320
<font color="#E5E5E5">entire set</font><font color="#CCCCCC"> of capabilities</font><font color="#E5E5E5"> that the</font>

357
00:19:28,190 --> 00:19:31,790
sense of<font color="#E5E5E5"> the core of the of them our but</font>

358
00:19:30,320 --> 00:19:34,340
the<font color="#E5E5E5"> most important</font><font color="#CCCCCC"> aspect is the</font>

359
00:19:31,790 --> 00:19:36,379
<font color="#E5E5E5">communication module in this particular</font>

360
00:19:34,340 --> 00:19:38,990
case

361
00:19:36,380 --> 00:19:41,299
the communication give us visibility

362
00:19:38,990 --> 00:19:44,270
<font color="#E5E5E5">upon</font><font color="#CCCCCC"> a number of</font><font color="#E5E5E5"> parameters</font><font color="#CCCCCC"> that are</font>

363
00:19:41,299 --> 00:19:46,668
important to attribute<font color="#E5E5E5"> the attack on</font>

364
00:19:44,270 --> 00:19:48,830
<font color="#E5E5E5">bison</font><font color="#CCCCCC"> all to and obviously behind that</font>

365
00:19:46,669 --> 00:19:53,440
<font color="#E5E5E5">to the Chinese apt group that is behind</font>

366
00:19:48,830 --> 00:19:56,629
<font color="#CCCCCC">built by snow so we normally</font><font color="#E5E5E5"> do that by</font>

367
00:19:53,440 --> 00:19:58,730
<font color="#E5E5E5">even in this case having the chance</font><font color="#CCCCCC"> to</font>

368
00:19:56,630 --> 00:20:02,570
look at traffic<font color="#E5E5E5"> the</font><font color="#CCCCCC"> traffic is streaming</font>

369
00:19:58,730 --> 00:20:06,950
peculiar in a way that it contain<font color="#CCCCCC"> c2</font>

370
00:20:02,570 --> 00:20:08,928
domain information<font color="#CCCCCC"> flags</font><font color="#E5E5E5"> and information</font>

371
00:20:06,950 --> 00:20:12,049
<font color="#CCCCCC">about the host whereby the</font><font color="#E5E5E5"> null is</font>

372
00:20:08,929 --> 00:20:14,570
running<font color="#E5E5E5"> okay even in the case where is</font>

373
00:20:12,049 --> 00:20:16,879
slightly obfuscated<font color="#E5E5E5"> you can easily</font>

374
00:20:14,570 --> 00:20:19,490
identify this<font color="#E5E5E5"> parameter as a potential</font>

375
00:20:16,880 --> 00:20:23,780
good item to<font color="#E5E5E5"> develop your own to</font>

376
00:20:19,490 --> 00:20:26,210
<font color="#E5E5E5">identify the poison</font><font color="#CCCCCC"> or traffic the</font>

377
00:20:23,780 --> 00:20:29,770
resulting is a description of a number

378
00:20:26,210 --> 00:20:32,900
<font color="#E5E5E5">of different things that are useful for</font>

379
00:20:29,770 --> 00:20:36,320
<font color="#E5E5E5">identifying an attributing bi-zonal</font>

380
00:20:32,900 --> 00:20:38,960
internal environment so from the type<font color="#CCCCCC"> of</font>

381
00:20:36,320 --> 00:20:42,049
malware<font color="#E5E5E5"> that is a modulus</font><font color="#CCCCCC"> trojan in one</font>

382
00:20:38,960 --> 00:20:44,750
single stage whoever to the<font color="#CCCCCC"> beaconing</font>

383
00:20:42,049 --> 00:20:47,539
capability<font color="#E5E5E5"> the port listening the</font>

384
00:20:44,750 --> 00:20:49,220
dissemination strategy the type of

385
00:20:47,539 --> 00:20:54,919
<font color="#E5E5E5">client server communication that is</font>

386
00:20:49,220 --> 00:20:57,710
<font color="#E5E5E5">mainly HTTP and HTTPS and a number of</font>

387
00:20:54,919 --> 00:21:05,770
other<font color="#CCCCCC"> items like the you can see here</font>

388
00:20:57,710 --> 00:21:10,070
one second you you can see as a<font color="#E5E5E5"> point</font>

389
00:21:05,770 --> 00:21:15,110
<font color="#E5E5E5">here this is for you know just a second</font>

390
00:21:10,070 --> 00:21:18,439
<font color="#E5E5E5">okay this flag this flag identify the</font>

391
00:21:15,110 --> 00:21:21,530
specific victim in<font color="#E5E5E5"> specific they were</font>

392
00:21:18,440 --> 00:21:25,520
<font color="#CCCCCC">are coding a number of code into this</font>

393
00:21:21,530 --> 00:21:28,399
<font color="#E5E5E5">that we define</font><font color="#CCCCCC"> by investigation we're</font>

394
00:21:25,520 --> 00:21:31,010
behaving<font color="#E5E5E5"> for differently because they</font>

395
00:21:28,400 --> 00:21:33,559
were in different environment so we find

396
00:21:31,010 --> 00:21:35,450
this one on an environment<font color="#E5E5E5"> study it</font>

397
00:21:33,559 --> 00:21:38,059
obviously at the first<font color="#E5E5E5"> time it was not</font>

398
00:21:35,450 --> 00:21:40,940
giving us<font color="#CCCCCC"> much visibility upon anything</font>

399
00:21:38,059 --> 00:21:43,789
<font color="#CCCCCC">on a second check on a different</font>

400
00:21:40,940 --> 00:21:46,610
environment<font color="#CCCCCC"> we</font><font color="#E5E5E5"> identified</font><font color="#CCCCCC"> that these</font>

401
00:21:43,789 --> 00:21:48,260
<font color="#E5E5E5">parameters was different and we started</font>

402
00:21:46,610 --> 00:21:49,909
to understand that<font color="#E5E5E5"> this flag was</font>

403
00:21:48,260 --> 00:21:53,390
<font color="#E5E5E5">basically</font>

404
00:21:49,910 --> 00:21:56,570
this is one customer<font color="#E5E5E5"> one victim this is</font>

405
00:21:53,390 --> 00:21:58,850
another victim<font color="#CCCCCC"> and we compare</font><font color="#E5E5E5"> these</font><font color="#CCCCCC"> with</font>

406
00:21:56,570 --> 00:22:03,040
<font color="#E5E5E5">others that we have collected from</font>

407
00:21:58,850 --> 00:22:05,780
public sources and we identify others

408
00:22:03,040 --> 00:22:08,110
<font color="#CCCCCC">flags that were belonging to other</font>

409
00:22:05,780 --> 00:22:10,428
companies<font color="#CCCCCC"> so from</font><font color="#E5E5E5"> that perspective</font>

410
00:22:08,110 --> 00:22:15,979
<font color="#E5E5E5">looking at this is again very very</font>

411
00:22:10,429 --> 00:22:17,870
<font color="#E5E5E5">useful</font><font color="#CCCCCC"> okay so we also generate some ICS</font>

412
00:22:15,980 --> 00:22:22,210
out of the behavior of the<font color="#CCCCCC"> hour out of</font>

413
00:22:17,870 --> 00:22:24,979
<font color="#E5E5E5">the analysis by</font><font color="#CCCCCC"> donating samples into a</font>

414
00:22:22,210 --> 00:22:27,770
<font color="#CCCCCC">sandboxes for</font><font color="#E5E5E5"> example and so we have</font>

415
00:22:24,980 --> 00:22:30,380
been able to<font color="#E5E5E5"> identify IOC s for the</font>

416
00:22:27,770 --> 00:22:33,620
registry value or the type of<font color="#E5E5E5"> file</font>

417
00:22:30,380 --> 00:22:37,669
created that were<font color="#E5E5E5"> almost the same in in</font>

418
00:22:33,620 --> 00:22:40,549
<font color="#E5E5E5">general for the same same segment of</font>

419
00:22:37,669 --> 00:22:42,620
time so they run multiple<font color="#E5E5E5"> campaigns but</font>

420
00:22:40,549 --> 00:22:45,918
in the<font color="#E5E5E5"> segment of</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> three months</font>

421
00:22:42,620 --> 00:22:47,270
<font color="#E5E5E5">normally the name of</font><font color="#CCCCCC"> the of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> executor</font>

422
00:22:45,919 --> 00:22:51,410
mode<font color="#CCCCCC"> the one</font><font color="#E5E5E5"> that is referred</font><font color="#CCCCCC"> and</font>

423
00:22:47,270 --> 00:22:55,850
executed<font color="#E5E5E5"> it was almost the</font><font color="#CCCCCC"> same so this</font>

424
00:22:51,410 --> 00:23:03,230
is this<font color="#E5E5E5"> is the the yarra generated out</font>

425
00:22:55,850 --> 00:23:06,049
<font color="#CCCCCC">of all these analysis</font><font color="#E5E5E5"> you know from the</font>

426
00:23:03,230 --> 00:23:09,020
perspective<font color="#CCCCCC"> of the situation where you</font>

427
00:23:06,049 --> 00:23:11,540
<font color="#E5E5E5">don't have the chance to integrate one</font>

428
00:23:09,020 --> 00:23:13,910
single Yara<font color="#E5E5E5"> having just generate</font>

429
00:23:11,540 --> 00:23:16,010
expression<font color="#E5E5E5"> you can go for the super rule</font>

430
00:23:13,910 --> 00:23:17,990
so we're<font color="#CCCCCC"> only still at one Yara</font>

431
00:23:16,010 --> 00:23:20,090
but in this super rule you contain

432
00:23:17,990 --> 00:23:26,090
different<font color="#CCCCCC"> rules so in this case for</font>

433
00:23:20,090 --> 00:23:28,490
<font color="#CCCCCC">example</font><font color="#E5E5E5"> we define different campaign for</font>

434
00:23:26,090 --> 00:23:32,570
the same attacker coming<font color="#E5E5E5"> from you</font><font color="#CCCCCC"> know</font>

435
00:23:28,490 --> 00:23:36,169
these are the flags<font color="#CCCCCC"> sobei</font><font color="#E5E5E5"> by this you</font>

436
00:23:32,570 --> 00:23:38,389
can<font color="#CCCCCC"> even run into the</font><font color="#E5E5E5"> packets</font><font color="#CCCCCC"> these type</font>

437
00:23:36,169 --> 00:23:41,840
of<font color="#E5E5E5"> things you can understand who is the</font>

438
00:23:38,390 --> 00:23:49,700
victim of with a match to the<font color="#CCCCCC"> Yara so</font>

439
00:23:41,840 --> 00:23:53,059
can<font color="#E5E5E5"> okay you run down now again so we</font>

440
00:23:49,700 --> 00:23:55,970
don't finish with Yara<font color="#CCCCCC"> and with fractal</font>

441
00:23:53,059 --> 00:23:59,149
<font color="#E5E5E5">rift we use also we have defined to use</font>

442
00:23:55,970 --> 00:24:01,040
<font color="#E5E5E5">also claim IV time agree is an anti</font>

443
00:23:59,150 --> 00:24:03,480
virus okay<font color="#E5E5E5"> so everybody think</font><font color="#CCCCCC"> about</font>

444
00:24:01,040 --> 00:24:07,500
<font color="#E5E5E5">these like you know open source</font>

445
00:24:03,480 --> 00:24:10,230
of free to use<font color="#E5E5E5"> antivirus not really</font>

446
00:24:07,500 --> 00:24:12,510
powerful not really<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> into the</font>

447
00:24:10,230 --> 00:24:13,860
competitive chance against the the

448
00:24:12,510 --> 00:24:17,430
Challenger I mean it's not a challenge

449
00:24:13,860 --> 00:24:20,760
<font color="#E5E5E5">of corporate solution like McAfee or</font>

450
00:24:17,430 --> 00:24:22,650
whatever<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is true true</font><font color="#E5E5E5"> however we</font>

451
00:24:20,760 --> 00:24:25,950
<font color="#E5E5E5">think about</font><font color="#CCCCCC"> claim maybe in a different</font>

452
00:24:22,650 --> 00:24:30,060
<font color="#CCCCCC">way</font><font color="#E5E5E5"> being</font><font color="#CCCCCC"> an</font><font color="#E5E5E5"> open source code</font><font color="#CCCCCC"> being open</font>

453
00:24:25,950 --> 00:24:31,290
to<font color="#E5E5E5"> evaluate evolutions claim maybe</font>

454
00:24:30,060 --> 00:24:34,740
integrate<font color="#CCCCCC"> Yara</font>

455
00:24:31,290 --> 00:24:37,290
<font color="#E5E5E5">for example claim</font><font color="#CCCCCC"> a we integrate the</font>

456
00:24:34,740 --> 00:24:40,140
chance to develop custom signature<font color="#CCCCCC"> that</font>

457
00:24:37,290 --> 00:24:44,159
the others as<font color="#CCCCCC"> have been anticipated are</font>

458
00:24:40,140 --> 00:24:47,580
not really open<font color="#E5E5E5"> to do so in our massive</font>

459
00:24:44,160 --> 00:24:50,090
triage environment one environment

460
00:24:47,580 --> 00:24:53,520
evilly<font color="#E5E5E5"> compromised</font><font color="#CCCCCC"> where there</font><font color="#E5E5E5"> are</font>

461
00:24:50,090 --> 00:24:57,629
heterogeneous systems and where we need

462
00:24:53,520 --> 00:25:00,180
to<font color="#E5E5E5"> have the capability</font><font color="#CCCCCC"> to run</font><font color="#E5E5E5"> apply Isis</font>

463
00:24:57,630 --> 00:25:02,340
or<font color="#E5E5E5"> actionable Isis we need to have a</font>

464
00:25:00,180 --> 00:25:05,910
platform<font color="#E5E5E5"> that give us this</font><font color="#CCCCCC"> chance and</font>

465
00:25:02,340 --> 00:25:10,230
<font color="#E5E5E5">the platform is a supply</font><font color="#CCCCCC"> maybe remedy</font>

466
00:25:05,910 --> 00:25:13,320
came<font color="#E5E5E5"> from in in in package that includes</font>

467
00:25:10,230 --> 00:25:16,080
a<font color="#CCCCCC"> very very scanner</font><font color="#E5E5E5"> a common line virus</font>

468
00:25:13,320 --> 00:25:19,800
scanner a client-server right scanner so

469
00:25:16,080 --> 00:25:24,560
you can run a server pointing<font color="#E5E5E5"> to share</font>

470
00:25:19,800 --> 00:25:28,560
<font color="#E5E5E5">to folders and ask him</font><font color="#CCCCCC"> to share to scan</font>

471
00:25:24,560 --> 00:25:32,070
go for<font color="#E5E5E5"> update of the virus definition</font>

472
00:25:28,560 --> 00:25:35,129
<font color="#E5E5E5">database easily so from the</font><font color="#CCCCCC"> perspective</font>

473
00:25:32,070 --> 00:25:37,770
of<font color="#E5E5E5"> IR</font><font color="#CCCCCC"> it's a good product I mean</font><font color="#E5E5E5"> it's</font>

474
00:25:35,130 --> 00:25:40,500
definitely useful especially when<font color="#E5E5E5"> you</font>

475
00:25:37,770 --> 00:25:42,930
are investigating<font color="#E5E5E5"> upon UNIX systems that</font>

476
00:25:40,500 --> 00:25:48,890
are not<font color="#CCCCCC"> covered by vast majority of the</font>

477
00:25:42,930 --> 00:25:48,890
<font color="#E5E5E5">platforms the IR platform on today so</font>

478
00:25:50,810 --> 00:26:01,080
yeah map basically<font color="#E5E5E5"> clamavi is a sort of</font>

479
00:25:57,980 --> 00:26:03,630
integration of all that we<font color="#E5E5E5"> have</font>

480
00:26:01,080 --> 00:26:07,439
discussed<font color="#CCCCCC"> before into a</font><font color="#E5E5E5"> platform that</font>

481
00:26:03,630 --> 00:26:09,900
and<font color="#CCCCCC"> APIs solving the incident there are</font>

482
00:26:07,440 --> 00:26:11,730
it has also<font color="#E5E5E5"> other features</font><font color="#CCCCCC"> like the</font>

483
00:26:09,900 --> 00:26:14,250
quarantine<font color="#E5E5E5"> we don't discuss about</font><font color="#CCCCCC"> this</font>

484
00:26:11,730 --> 00:26:16,400
because<font color="#E5E5E5"> in terms of</font><font color="#CCCCCC"> I our forensic</font>

485
00:26:14,250 --> 00:26:19,910
<font color="#E5E5E5">quarantine is uh</font>

486
00:26:16,400 --> 00:26:21,860
risky<font color="#CCCCCC"> beasts</font><font color="#E5E5E5"> but let's say it's still a</font>

487
00:26:19,910 --> 00:26:23,840
chance<font color="#CCCCCC"> especially when you</font><font color="#E5E5E5"> are</font><font color="#CCCCCC"> looking</font>

488
00:26:21,860 --> 00:26:25,909
<font color="#E5E5E5">for ransomware stuff that is</font><font color="#CCCCCC"> not really</font>

489
00:26:23,840 --> 00:26:29,510
really important in the end<font color="#E5E5E5"> of in terms</font>

490
00:26:25,910 --> 00:26:34,880
of<font color="#E5E5E5"> IR</font><font color="#CCCCCC"> or you know coverage of protection</font>

491
00:26:29,510 --> 00:26:39,670
of attacks<font color="#E5E5E5"> from advanced adversaries but</font>

492
00:26:34,880 --> 00:26:41,960
still is a chance<font color="#E5E5E5"> so in the end Yara is</font>

493
00:26:39,670 --> 00:26:45,950
the Swiss<font color="#E5E5E5"> Army knife to create</font>

494
00:26:41,960 --> 00:26:49,220
actionable Isis<font color="#CCCCCC"> claim maybe</font><font color="#E5E5E5"> is the right</font>

495
00:26:45,950 --> 00:26:50,960
hand for Yara<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> able to to search</font>

496
00:26:49,220 --> 00:27:11,270
<font color="#CCCCCC">the section</font><font color="#E5E5E5"> of Isis in</font><font color="#CCCCCC"> the in</font>

497
00:26:50,960 --> 00:27:15,170
environment so Stefano was<font color="#E5E5E5"> saying is</font>

498
00:27:11,270 --> 00:27:17,840
<font color="#CCCCCC">that we've just found claim may be</font><font color="#E5E5E5"> a</font>

499
00:27:15,170 --> 00:27:22,820
awesome<font color="#E5E5E5"> tool for scanning multiple</font>

500
00:27:17,840 --> 00:27:24,949
<font color="#E5E5E5">machines it does take a little bit of</font>

501
00:27:22,820 --> 00:27:26,840
time<font color="#E5E5E5"> depends on you know how big those</font>

502
00:27:24,950 --> 00:27:29,900
hard<font color="#E5E5E5"> drives are if we're we're talking</font>

503
00:27:26,840 --> 00:27:33,470
<font color="#E5E5E5">to three terabyte</font><font color="#CCCCCC"> it be anywhere from an</font>

504
00:27:29,900 --> 00:27:56,180
hour to<font color="#CCCCCC"> two a</font><font color="#E5E5E5"> couple days you know</font>

505
00:27:33,470 --> 00:28:01,850
depends on systems<font color="#CCCCCC"> Nala</font><font color="#E5E5E5"> yeah well this</font>

506
00:27:56,180 --> 00:28:03,770
<font color="#E5E5E5">is yeah I don't want to push products</font>

507
00:28:01,850 --> 00:28:07,129
into presentation but we<font color="#CCCCCC"> have a solution</font>

508
00:28:03,770 --> 00:28:10,430
<font color="#E5E5E5">that</font><font color="#CCCCCC"> is basically our same base produce</font>

509
00:28:07,130 --> 00:28:12,170
it<font color="#E5E5E5"> that</font><font color="#CCCCCC"> is collecting</font><font color="#E5E5E5"> all the traffic in</font>

510
00:28:10,430 --> 00:28:15,220
environment when we resolve<font color="#CCCCCC"> incidents</font>

511
00:28:12,170 --> 00:28:18,770
<font color="#CCCCCC">okay it's</font><font color="#E5E5E5"> massive I mean it generates</font>

512
00:28:15,220 --> 00:28:21,800
<font color="#E5E5E5">every type of meter out of the packets</font>

513
00:28:18,770 --> 00:28:23,990
but it can also give you the packets so

514
00:28:21,800 --> 00:28:26,090
when you<font color="#E5E5E5"> collect this you can like the</font>

515
00:28:23,990 --> 00:28:28,220
packets you are suspecting<font color="#E5E5E5"> there are</font>

516
00:28:26,090 --> 00:28:29,870
interesting you<font color="#CCCCCC"> can run the yarder</font><font color="#E5E5E5"> pun</font>

517
00:28:28,220 --> 00:28:33,050
<font color="#CCCCCC">so if you have a good</font><font color="#E5E5E5"> action</font>

518
00:28:29,870 --> 00:28:35,360
<font color="#E5E5E5">I see upon the packet side you can</font>

519
00:28:33,050 --> 00:28:38,090
immediately identify occurrences that

520
00:28:35,360 --> 00:28:42,379
are<font color="#E5E5E5"> matching</font><font color="#CCCCCC"> poison alley in the</font><font color="#E5E5E5"> case</font>

521
00:28:38,090 --> 00:28:45,800
<font color="#E5E5E5">then you can expand the visibility upon</font>

522
00:28:42,380 --> 00:28:48,170
this traffic<font color="#CCCCCC"> configuring specific set of</font>

523
00:28:45,800 --> 00:28:50,240
<font color="#E5E5E5">rule event for the RSA product to be</font>

524
00:28:48,170 --> 00:28:52,940
able<font color="#E5E5E5"> to quickly identify other</font>

525
00:28:50,240 --> 00:28:55,210
occurrences<font color="#E5E5E5"> but for the most part</font><font color="#CCCCCC"> were</font>

526
00:28:52,940 --> 00:28:58,460
<font color="#CCCCCC">we're searching</font><font color="#E5E5E5"> what's on hard drive</font>

527
00:28:55,210 --> 00:29:02,750
yeah so but<font color="#E5E5E5"> you know this is all part of</font>

528
00:28:58,460 --> 00:29:07,210
a<font color="#E5E5E5"> layer process for doing</font><font color="#CCCCCC"> IR this</font><font color="#E5E5E5"> is</font>

529
00:29:02,750 --> 00:29:09,590
just one aspect now when we go<font color="#E5E5E5"> to scan</font>

530
00:29:07,210 --> 00:29:12,500
for<font color="#E5E5E5"> badness</font>

531
00:29:09,590 --> 00:29:14,959
basically this is what those command

532
00:29:12,500 --> 00:29:17,510
lines are<font color="#E5E5E5"> going to look like you know us</font>

533
00:29:14,960 --> 00:29:19,610
we're<font color="#CCCCCC"> just looking for</font><font color="#E5E5E5"> the infected we</font>

534
00:29:17,510 --> 00:29:22,550
want to encourage<font color="#CCCCCC"> n' so we want to make</font>

535
00:29:19,610 --> 00:29:26,479
<font color="#CCCCCC">sure we start at you know if it's a unix</font>

536
00:29:22,550 --> 00:29:28,460
drive<font color="#E5E5E5"> slash or the c drive c colon we</font>

537
00:29:26,480 --> 00:29:32,240
want to do all matches for our rules

538
00:29:28,460 --> 00:29:34,670
<font color="#E5E5E5">because the more times we see hit on a</font>

539
00:29:32,240 --> 00:29:36,740
particular file the greater we can

540
00:29:34,670 --> 00:29:39,350
<font color="#E5E5E5">determine its most likely bad because</font>

541
00:29:36,740 --> 00:29:41,679
sometimes<font color="#CCCCCC"> we</font><font color="#E5E5E5"> get false positives the</font>

542
00:29:39,350 --> 00:29:44,780
other thing that's really<font color="#E5E5E5"> nice about</font>

543
00:29:41,679 --> 00:29:49,760
<font color="#CCCCCC">clamavi</font><font color="#E5E5E5"> you it will search archives and</font>

544
00:29:44,780 --> 00:29:52,940
<font color="#E5E5E5">we will see actors use re our zip tar</font>

545
00:29:49,760 --> 00:29:55,460
files<font color="#CCCCCC"> what-have-you and</font><font color="#E5E5E5"> to be able</font><font color="#CCCCCC"> to</font>

546
00:29:52,940 --> 00:29:58,460
search<font color="#E5E5E5"> those files for our signatures</font><font color="#CCCCCC"> I</font>

547
00:29:55,460 --> 00:30:01,550
mean<font color="#CCCCCC"> Yarra doesn't do it by itself</font><font color="#E5E5E5"> so</font>

548
00:29:58,460 --> 00:30:04,760
you know<font color="#CCCCCC"> clamavi and Yarra really works</font>

549
00:30:01,550 --> 00:30:07,450
out for us<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then for the database</font>

550
00:30:04,760 --> 00:30:11,920
<font color="#E5E5E5">this is where</font><font color="#CCCCCC"> our custom signatures are</font>

551
00:30:07,450 --> 00:30:14,570
and then where our starting point is for

552
00:30:11,920 --> 00:30:17,600
clamavi to start<font color="#E5E5E5"> so usually we recommend</font>

553
00:30:14,570 --> 00:30:20,899
the very root of the drive<font color="#E5E5E5"> and you know</font>

554
00:30:17,600 --> 00:30:23,209
like the<font color="#CCCCCC"> c colon start off for windows</font>

555
00:30:20,900 --> 00:30:26,809
and then we want<font color="#E5E5E5"> to make sure that we</font>

556
00:30:23,210 --> 00:30:28,070
capture<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the output into a file so</font>

557
00:30:26,809 --> 00:30:30,649
we<font color="#E5E5E5"> can view it</font><font color="#CCCCCC"> later</font>

558
00:30:28,070 --> 00:30:33,290
<font color="#CCCCCC">I like using T</font><font color="#E5E5E5"> if if I have that</font>

559
00:30:30,650 --> 00:30:35,780
available because<font color="#E5E5E5"> then I can see</font><font color="#CCCCCC"> its</font>

560
00:30:33,290 --> 00:30:39,428
processing and then it's still capturing

561
00:30:35,780 --> 00:30:42,230
<font color="#E5E5E5">the output now to run</font><font color="#CCCCCC"> yaro rules</font>

562
00:30:39,429 --> 00:30:43,309
everything everything else is<font color="#CCCCCC"> the same</font>

563
00:30:42,230 --> 00:30:46,220
<font color="#CCCCCC">but</font>

564
00:30:43,309 --> 00:30:47,570
we're going to have a list of<font color="#CCCCCC"> yarra</font>

565
00:30:46,220 --> 00:30:53,210
signatures

566
00:30:47,570 --> 00:30:55,279
versus the clamavi database and this is

567
00:30:53,210 --> 00:30:59,330
what this is<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> look</font><font color="#CCCCCC"> like as far</font>

568
00:30:55,279 --> 00:31:01,659
as clamavi hits for our signatures<font color="#E5E5E5"> you</font>

569
00:30:59,330 --> 00:31:07,100
know here's our files<font color="#E5E5E5"> that it matched on</font>

570
00:31:01,659 --> 00:31:10,159
here is what's the string we said in the

571
00:31:07,100 --> 00:31:13,730
database what it's for<font color="#E5E5E5"> so I am pretty</font>

572
00:31:10,159 --> 00:31:16,789
<font color="#CCCCCC">good</font><font color="#E5E5E5"> certainly that this case</font><font color="#CCCCCC"> WAP</font><font color="#E5E5E5"> d0 is</font>

573
00:31:13,730 --> 00:31:20,600
a CPU<font color="#E5E5E5"> minor of some sort</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> may not</font><font color="#CCCCCC"> be</font>

574
00:31:16,789 --> 00:31:23,149
<font color="#CCCCCC">this exact version</font><font color="#E5E5E5"> just depends I hope</font>

575
00:31:20,600 --> 00:31:28,840
that your signatures are or how generic

576
00:31:23,149 --> 00:31:32,899
<font color="#CCCCCC">you've written them this is what a Yarra</font>

577
00:31:28,840 --> 00:31:37,639
rules<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> look like same sort</font><font color="#E5E5E5"> of</font>

578
00:31:32,899 --> 00:31:41,119
thing<font color="#CCCCCC"> it searched all these</font><font color="#E5E5E5"> files we</font>

579
00:31:37,639 --> 00:31:43,309
<font color="#CCCCCC">have just some generic hits now I</font><font color="#E5E5E5"> know</font>

580
00:31:41,119 --> 00:31:45,559
I'll talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> this a little bit later</font>

581
00:31:43,309 --> 00:31:49,490
but I find<font color="#CCCCCC"> Yarra is great for</font><font color="#E5E5E5"> small</font>

582
00:31:45,559 --> 00:31:52,158
signatures versus the clamavi<font color="#E5E5E5"> where we</font>

583
00:31:49,490 --> 00:31:56,320
can string a bunch of<font color="#E5E5E5"> things together</font><font color="#CCCCCC"> so</font>

584
00:31:52,159 --> 00:31:56,320
what<font color="#E5E5E5"> we'll cover that in</font><font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit</font>

585
00:32:01,110 --> 00:32:08,159
yeah so the<font color="#CCCCCC"> the good</font><font color="#E5E5E5"> thing about</font>

586
00:32:05,679 --> 00:32:10,929
clamavi<font color="#E5E5E5"> I told you is the chance to</font>

587
00:32:08,160 --> 00:32:13,480
<font color="#E5E5E5">create a database</font><font color="#CCCCCC"> of signatures or</font>

588
00:32:10,929 --> 00:32:16,530
integrate new signatures<font color="#E5E5E5"> into</font><font color="#CCCCCC"> a database</font>

589
00:32:13,480 --> 00:32:19,540
<font color="#E5E5E5">like the one that is publicly</font><font color="#CCCCCC"> available</font>

590
00:32:16,530 --> 00:32:23,850
<font color="#CCCCCC">the chance</font><font color="#E5E5E5"> to create rules is based on</font>

591
00:32:19,540 --> 00:32:27,639
<font color="#CCCCCC">psych - sexuality is part of the clamavi</font>

592
00:32:23,850 --> 00:32:29,530
project but need to<font color="#CCCCCC"> be downloaded</font>

593
00:32:27,640 --> 00:32:32,169
separately and need to be used

594
00:32:29,530 --> 00:32:35,320
<font color="#E5E5E5">accordingly</font><font color="#CCCCCC"> I mean with a little bit of</font>

595
00:32:32,169 --> 00:32:39,520
<font color="#E5E5E5">exposure to the to the way that the</font>

596
00:32:35,320 --> 00:32:43,960
rules<font color="#E5E5E5"> are</font><font color="#CCCCCC"> being created and</font><font color="#E5E5E5"> saved</font><font color="#CCCCCC"> onto</font>

597
00:32:39,520 --> 00:32:47,049
<font color="#CCCCCC">the databases so we can</font><font color="#E5E5E5"> generate custom</font>

598
00:32:43,960 --> 00:32:52,540
signatures out of atomic is is like md5

599
00:32:47,049 --> 00:32:57,580
or sha-1<font color="#E5E5E5"> ashes</font><font color="#CCCCCC"> simply by looking</font><font color="#E5E5E5"> through</font>

600
00:32:52,540 --> 00:33:01,510
<font color="#E5E5E5">SEC</font><font color="#CCCCCC"> - into the</font><font color="#E5E5E5"> the file or we can</font><font color="#CCCCCC"> use</font>

601
00:32:57,580 --> 00:33:04,409
the scripture<font color="#E5E5E5"> like section in the</font><font color="#CCCCCC"> edge</font>

602
00:33:01,510 --> 00:33:08,110
sections into the<font color="#E5E5E5"> pocket executable or</font>

603
00:33:04,410 --> 00:33:12,070
structure precise structure in<font color="#E5E5E5"> terms of</font>

604
00:33:08,110 --> 00:33:15,370
<font color="#CCCCCC">XE expression into into the file</font><font color="#E5E5E5"> itself</font>

605
00:33:12,070 --> 00:33:20,049
<font color="#E5E5E5">so it's pretty flexible and really</font>

606
00:33:15,370 --> 00:33:23,649
<font color="#E5E5E5">useful one just minimum step back think</font>

607
00:33:20,049 --> 00:33:30,418
about<font color="#CCCCCC"> it</font><font color="#E5E5E5"> you are</font><font color="#CCCCCC"> investigating a very</font>

608
00:33:23,650 --> 00:33:30,419
complex<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> 8090 turan</font>

609
00:33:33,780 --> 00:33:41,950
yeah<font color="#E5E5E5"> couple hundred thousand systems and</font>

610
00:33:38,880 --> 00:33:44,620
out of them there were about two

611
00:33:41,950 --> 00:33:49,360
thousand and four<font color="#CCCCCC"> hundred</font><font color="#E5E5E5"> UNIX system</font>

612
00:33:44,620 --> 00:33:53,320
like ax that's no solution have<font color="#CCCCCC"> to cover</font>

613
00:33:49,360 --> 00:33:56,290
right<font color="#E5E5E5"> there hp-ux so you name it they</font>

614
00:33:53,320 --> 00:34:01,480
had there<font color="#E5E5E5"> was an investigation covering</font>

615
00:33:56,290 --> 00:34:04,750
the<font color="#CCCCCC"> Swift</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> swift based</font><font color="#E5E5E5"> you know in</font>

616
00:34:01,480 --> 00:34:08,199
one<font color="#E5E5E5"> of the many banks that we're having</font>

617
00:34:04,750 --> 00:34:10,780
problem with<font color="#CCCCCC"> this so there was no</font>

618
00:34:08,199 --> 00:34:13,230
solution<font color="#CCCCCC"> to investigate that</font><font color="#E5E5E5"> unless you</font>

619
00:34:10,780 --> 00:34:16,050
put something<font color="#E5E5E5"> out</font><font color="#CCCCCC"> of your</font>

620
00:34:13,230 --> 00:34:18,659
bag<font color="#CCCCCC"> that</font><font color="#E5E5E5"> is good to run in these</font><font color="#CCCCCC"> systems</font>

621
00:34:16,050 --> 00:34:21,599
and<font color="#E5E5E5"> we'll use this exactly this we</font>

622
00:34:18,659 --> 00:34:23,730
generate a<font color="#E5E5E5"> number of biases we created</font>

623
00:34:21,599 --> 00:34:25,980
<font color="#E5E5E5">we take the previous</font><font color="#CCCCCC"> invention</font>

624
00:34:23,730 --> 00:34:29,070
investigation of the same incident<font color="#E5E5E5"> with</font>

625
00:34:25,980 --> 00:34:32,070
us and in this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> clay</font><font color="#E5E5E5"> maybe was our</font>

626
00:34:29,070 --> 00:34:36,690
solution<font color="#CCCCCC"> really I mean compared to the</font>

627
00:34:32,070 --> 00:34:40,379
chance to make<font color="#E5E5E5"> manual analysis</font><font color="#CCCCCC"> it speed</font>

628
00:34:36,690 --> 00:34:46,230
up the process<font color="#E5E5E5"> at at least 100 times</font><font color="#CCCCCC"> we</font>

629
00:34:40,379 --> 00:34:49,020
solve the body in 20 days<font color="#CCCCCC"> so anyway this</font>

630
00:34:46,230 --> 00:34:51,329
<font color="#E5E5E5">is how the signature can</font><font color="#CCCCCC"> be created you</font>

631
00:34:49,020 --> 00:34:54,750
can basically use<font color="#E5E5E5"> psych tool and you</font>

632
00:34:51,329 --> 00:34:59,160
express the -<font color="#E5E5E5"> - md5</font><font color="#CCCCCC"> in case you</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> a</font>

633
00:34:54,750 --> 00:35:02,970
md5<font color="#CCCCCC"> hash of the executable and throw</font>

634
00:34:59,160 --> 00:35:06,529
this into<font color="#E5E5E5"> a database</font><font color="#CCCCCC"> okay generate</font><font color="#E5E5E5"> the</font>

635
00:35:02,970 --> 00:35:09,359
proper string and you can then check

636
00:35:06,530 --> 00:35:13,170
what is<font color="#CCCCCC"> into this</font><font color="#E5E5E5"> signal file this is</font>

637
00:35:09,359 --> 00:35:18,029
the<font color="#E5E5E5"> entry look the name of the file the</font>

638
00:35:13,170 --> 00:35:21,329
indicator<font color="#CCCCCC"> I mean this is an ID and this</font>

639
00:35:18,030 --> 00:35:24,569
is the string generated<font color="#E5E5E5"> so that's good</font>

640
00:35:21,329 --> 00:35:27,359
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> easy I mean once you have a number</font>

641
00:35:24,569 --> 00:35:28,980
<font color="#E5E5E5">of items already discovered since the</font>

642
00:35:27,359 --> 00:35:32,520
beginning of the incident<font color="#E5E5E5"> you can</font>

643
00:35:28,980 --> 00:35:35,210
immediately<font color="#E5E5E5"> create a number of entries</font>

644
00:35:32,520 --> 00:35:37,800
in the database<font color="#E5E5E5"> and plug this into the</font>

645
00:35:35,210 --> 00:35:39,720
clamavi database or create<font color="#CCCCCC"> a separate</font>

646
00:35:37,800 --> 00:35:43,200
database just<font color="#E5E5E5"> for you</font><font color="#CCCCCC"> I mean depends on</font>

647
00:35:39,720 --> 00:35:45,959
you<font color="#CCCCCC"> in our case we</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> to integrate our</font>

648
00:35:43,200 --> 00:35:48,450
stuff<font color="#CCCCCC"> into the generic database</font><font color="#E5E5E5"> just to</font>

649
00:35:45,960 --> 00:35:51,630
<font color="#E5E5E5">have also matching off anything there</font>

650
00:35:48,450 --> 00:35:54,689
<font color="#E5E5E5">was malicious from the past</font><font color="#CCCCCC"> not related</font>

651
00:35:51,630 --> 00:36:00,180
to this attack but in the database of

652
00:35:54,690 --> 00:36:03,270
<font color="#CCCCCC">claim</font><font color="#E5E5E5"> maybe obviously you can save in</font>

653
00:36:00,180 --> 00:36:09,270
different type of<font color="#E5E5E5"> format the the rule I</font>

654
00:36:03,270 --> 00:36:11,880
mean the this I decide to entry<font color="#CCCCCC"> I told</font>

655
00:36:09,270 --> 00:36:13,890
you<font color="#E5E5E5"> depending on the type of thing one</font>

656
00:36:11,880 --> 00:36:15,660
<font color="#E5E5E5">question there what an aspect that Kevin</font>

657
00:36:13,890 --> 00:36:18,750
has already<font color="#E5E5E5"> highlighted is that you can</font>

658
00:36:15,660 --> 00:36:22,230
inspect archives<font color="#E5E5E5"> you can also</font>

659
00:36:18,750 --> 00:36:25,880
investigate<font color="#E5E5E5"> stuff like that file or you</font>

660
00:36:22,230 --> 00:36:29,000
know not necessarily acceptable or<font color="#E5E5E5"> not</font>

661
00:36:25,880 --> 00:36:30,950
<font color="#CCCCCC">surely executive all</font><font color="#E5E5E5"> that appears to the</font>

662
00:36:29,000 --> 00:36:35,540
system at the<font color="#CCCCCC"> beginning as excitable</font>

663
00:36:30,950 --> 00:36:40,430
<font color="#E5E5E5">that's that's important there</font><font color="#CCCCCC"> is also</font>

664
00:36:35,540 --> 00:36:44,060
the chance<font color="#E5E5E5"> I told you to create a rule</font>

665
00:36:40,430 --> 00:36:47,960
<font color="#CCCCCC">base on the base or at the body</font><font color="#E5E5E5"> of the</font>

666
00:36:44,060 --> 00:36:50,810
file<font color="#E5E5E5"> I mean a certain set of elements</font>

667
00:36:47,960 --> 00:36:52,280
into the file set a certain<font color="#CCCCCC"> set of</font>

668
00:36:50,810 --> 00:36:54,740
<font color="#E5E5E5">strings into the file that</font><font color="#CCCCCC"> are</font>

669
00:36:52,280 --> 00:36:57,650
<font color="#CCCCCC">sexagesimal string you can</font><font color="#E5E5E5"> use that</font>

670
00:36:54,740 --> 00:37:00,649
create an entry<font color="#E5E5E5"> so even this is good</font>

671
00:36:57,650 --> 00:37:02,030
<font color="#E5E5E5">obviously</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> climb</font><font color="#CCCCCC"> IV</font><font color="#E5E5E5"> we lose the</font><font color="#CCCCCC"> chance</font>

672
00:37:00,650 --> 00:37:04,100
to<font color="#CCCCCC"> investigate the network</font>

673
00:37:02,030 --> 00:37:07,010
this is just for<font color="#CCCCCC"> Yara but everything</font>

674
00:37:04,100 --> 00:37:10,339
else we can cover with<font color="#CCCCCC"> that so in terms</font>

675
00:37:07,010 --> 00:37:12,950
of what<font color="#E5E5E5"> we spoke the Trinity of the IR</font>

676
00:37:10,340 --> 00:37:16,940
meaning the visibility upon system

677
00:37:12,950 --> 00:37:19,339
<font color="#CCCCCC">network and logs</font><font color="#E5E5E5"> climb</font><font color="#CCCCCC"> Ivy solve the</font>

678
00:37:16,940 --> 00:37:23,200
system visibility while<font color="#CCCCCC"> yara so the</font>

679
00:37:19,340 --> 00:37:34,400
network visibility in<font color="#E5E5E5"> this case</font><font color="#CCCCCC"> okay</font>

680
00:37:23,200 --> 00:37:36,589
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> pass again so this is a graphical</font>

681
00:37:34,400 --> 00:37:41,390
method<font color="#E5E5E5"> of generating signatures so if</font>

682
00:37:36,590 --> 00:37:43,010
you have<font color="#CCCCCC"> Ida</font><font color="#E5E5E5"> and it's version 6.0 this</font>

683
00:37:41,390 --> 00:37:46,960
works out<font color="#E5E5E5"> pretty good</font>

684
00:37:43,010 --> 00:37:51,170
there's the<font color="#E5E5E5"> clampy signature creator</font>

685
00:37:46,960 --> 00:37:54,940
basically<font color="#E5E5E5"> come down here install a lucky</font>

686
00:37:51,170 --> 00:37:58,580
<font color="#CCCCCC">one any other</font><font color="#E5E5E5"> Ida</font><font color="#CCCCCC"> plug-in and then</font>

687
00:37:54,940 --> 00:38:04,250
you're going to<font color="#CCCCCC"> open</font><font color="#E5E5E5"> up the binary in</font>

688
00:37:58,580 --> 00:38:08,270
Ida and take open up the screens<font color="#CCCCCC"> I'm</font>

689
00:38:04,250 --> 00:38:11,810
sorry strings and then from there you're

690
00:38:08,270 --> 00:38:14,180
gonna start highlighting<font color="#E5E5E5"> anything that's</font>

691
00:38:11,810 --> 00:38:16,040
it makes sense for a signature<font color="#CCCCCC"> you want</font>

692
00:38:14,180 --> 00:38:19,580
to keep it somewhat generic but<font color="#E5E5E5"> you want</font>

693
00:38:16,040 --> 00:38:21,170
<font color="#E5E5E5">to keep it so</font><font color="#CCCCCC"> that you know you're not</font>

694
00:38:19,580 --> 00:38:23,600
<font color="#E5E5E5">just</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to hit on every</font><font color="#CCCCCC"> single file</font>

695
00:38:21,170 --> 00:38:28,250
so in this particular<font color="#E5E5E5"> crypto minor for</font>

696
00:38:23,600 --> 00:38:30,650
example you can see I have<font color="#CCCCCC"> pool dot mine</font>

697
00:38:28,250 --> 00:38:35,330
<font color="#CCCCCC">mr dot-com</font>

698
00:38:30,650 --> 00:38:39,440
I have stratum<font color="#CCCCCC"> TCP</font><font color="#E5E5E5"> minor gate and nice</font>

699
00:38:35,330 --> 00:38:45,049
hash<font color="#E5E5E5"> calm so you know a very simple</font>

700
00:38:39,440 --> 00:38:47,329
us select strings and these strings

701
00:38:45,049 --> 00:38:50,150
actually<font color="#E5E5E5"> hit on several different</font><font color="#CCCCCC"> types</font>

702
00:38:47,329 --> 00:38:54,230
of<font color="#E5E5E5"> minors so again we're getting to this</font>

703
00:38:50,150 --> 00:38:58,789
action<font color="#CCCCCC"> IOC s</font><font color="#E5E5E5"> we're not stricking so if</font>

704
00:38:54,230 --> 00:39:01,039
you can see up here the the line<font color="#E5E5E5"> I</font>

705
00:38:58,789 --> 00:39:05,109
<font color="#E5E5E5">didn't highlight is a very unique string</font>

706
00:39:01,039 --> 00:39:08,450
to this binary but it's not<font color="#E5E5E5"> actual</font>

707
00:39:05,109 --> 00:39:10,130
<font color="#E5E5E5">actionable IOC it's only going to hit on</font>

708
00:39:08,450 --> 00:39:13,009
<font color="#E5E5E5">this particular</font><font color="#CCCCCC"> barn</font><font color="#E5E5E5"> so we want</font>

709
00:39:10,130 --> 00:39:15,920
<font color="#E5E5E5">something a</font><font color="#CCCCCC"> little more generic so after</font>

710
00:39:13,010 --> 00:39:19,400
you highlight those you're going to

711
00:39:15,920 --> 00:39:21,200
<font color="#CCCCCC">right click and add string to claim</font>

712
00:39:19,400 --> 00:39:25,869
<font color="#CCCCCC">maybe creator which will give you this</font>

713
00:39:21,200 --> 00:39:25,868
and you can see what you selected here

714
00:39:28,030 --> 00:39:34,609
then<font color="#E5E5E5"> that you know this brings up on</font>

715
00:39:31,609 --> 00:39:35,900
<font color="#E5E5E5">there a little sub</font><font color="#CCCCCC"> panel with a list of</font>

716
00:39:34,609 --> 00:39:39,470
all the strings I don't have a

717
00:39:35,900 --> 00:39:42,200
<font color="#CCCCCC">screenshot</font><font color="#E5E5E5"> of that</font><font color="#CCCCCC"> but when you're ready</font>

718
00:39:39,470 --> 00:39:44,390
<font color="#E5E5E5">to actually create your string you're</font>

719
00:39:42,200 --> 00:39:47,259
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> select the strings that you're</font>

720
00:39:44,390 --> 00:39:50,180
interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> for the signatures and</font>

721
00:39:47,260 --> 00:39:53,210
click<font color="#E5E5E5"> the Create claim maybe signature</font>

722
00:39:50,180 --> 00:39:56,960
<font color="#E5E5E5">button which gives</font><font color="#CCCCCC"> you this window</font><font color="#E5E5E5"> here</font>

723
00:39:53,210 --> 00:40:01,220
that<font color="#E5E5E5"> pops up and in here you're going to</font>

724
00:39:56,960 --> 00:40:03,079
highlight this<font color="#CCCCCC"> and copy</font><font color="#E5E5E5"> that to a text</font>

725
00:40:01,220 --> 00:40:13,660
file and<font color="#E5E5E5"> that's</font><font color="#CCCCCC"> darning</font><font color="#E5E5E5"> your database</font>

726
00:40:03,079 --> 00:40:17,539
yeah so you<font color="#E5E5E5"> know we talked about how</font>

727
00:40:13,660 --> 00:40:20,270
<font color="#CCCCCC">you're going</font><font color="#E5E5E5"> to learn using clamavi to</font>

728
00:40:17,539 --> 00:40:25,670
scan<font color="#E5E5E5"> this is one</font><font color="#CCCCCC"> example of using</font><font color="#E5E5E5"> PS</font>

729
00:40:20,270 --> 00:40:28,700
exact to scan your<font color="#CCCCCC"> Windows machines you</font>

730
00:40:25,670 --> 00:40:31,220
know just<font color="#E5E5E5"> your typical PS exact command</font>

731
00:40:28,700 --> 00:40:34,879
<font color="#CCCCCC">lined username password for the admin</font>

732
00:40:31,220 --> 00:40:38,839
account<font color="#E5E5E5"> and then where the location of</font>

733
00:40:34,880 --> 00:40:43,700
the databases and or you know down<font color="#E5E5E5"> here</font>

734
00:40:38,839 --> 00:40:44,990
is a full example here and you know

735
00:40:43,700 --> 00:40:49,120
you're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> try</font><font color="#CCCCCC"> to do this</font>

736
00:40:44,990 --> 00:40:52,060
<font color="#E5E5E5">essentially as possible yeah</font>

737
00:40:49,120 --> 00:40:54,009
now<font color="#E5E5E5"> we had talked about frac in the</font>

738
00:40:52,060 --> 00:40:56,560
beginning of this the nice I said we

739
00:40:54,010 --> 00:40:59,580
<font color="#CCCCCC">used</font><font color="#E5E5E5"> frac to retrieve files</font><font color="#CCCCCC"> to start</font>

740
00:40:56,560 --> 00:41:02,650
<font color="#E5E5E5">triage well you can also use frac</font>

741
00:40:59,580 --> 00:41:05,710
<font color="#E5E5E5">technically to run any command you want</font>

742
00:41:02,650 --> 00:41:08,860
on a remote<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> so in this</font>

743
00:41:05,710 --> 00:41:13,900
particular<font color="#E5E5E5"> case I'm using frac to</font><font color="#CCCCCC"> run</font>

744
00:41:08,860 --> 00:41:16,030
<font color="#CCCCCC">clam IV on</font><font color="#E5E5E5"> all of the remote machines in</font>

745
00:41:13,900 --> 00:41:22,330
the environment<font color="#E5E5E5"> and it just goes through</font>

746
00:41:16,030 --> 00:41:23,830
<font color="#CCCCCC">PI IP</font><font color="#E5E5E5"> and kicks it off</font><font color="#CCCCCC"> one in it the</font>

747
00:41:22,330 --> 00:41:26,049
other<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that I probably</font><font color="#E5E5E5"> didn't touch</font>

748
00:41:23,830 --> 00:41:28,390
on<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> beginning it does track those</font>

749
00:41:26,050 --> 00:41:30,820
IP addresses<font color="#CCCCCC"> that</font><font color="#E5E5E5"> for whatever reason</font>

750
00:41:28,390 --> 00:41:33,790
didn't respond<font color="#CCCCCC"> so you'll get</font><font color="#E5E5E5"> us you'll</font>

751
00:41:30,820 --> 00:41:37,600
get a list of<font color="#E5E5E5"> those that all you have to</font>

752
00:41:33,790 --> 00:41:40,060
redo you take that the output of here

753
00:41:37,600 --> 00:41:44,740
<font color="#E5E5E5">the failed ones and just put the that</font>

754
00:41:40,060 --> 00:41:50,470
<font color="#E5E5E5">listand to the IP list there and it will</font>

755
00:41:44,740 --> 00:41:52,689
scan<font color="#E5E5E5"> those again the the the one other</font>

756
00:41:50,470 --> 00:41:56,939
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> I'm going to</font><font color="#E5E5E5"> suggest is if you</font>

757
00:41:52,690 --> 00:41:56,940
decide<font color="#CCCCCC"> to go</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> this method for frac</font>

758
00:41:57,060 --> 00:42:01,930
<font color="#CCCCCC">you should be able to do more</font><font color="#E5E5E5"> than 25</font>

759
00:41:59,830 --> 00:42:04,509
boxes<font color="#E5E5E5"> at a time</font><font color="#CCCCCC"> and it's configurable</font>

760
00:42:01,930 --> 00:42:06,460
<font color="#CCCCCC">within there there's a config de I and I</font>

761
00:42:04,510 --> 00:42:08,770
if you there's the documents<font color="#E5E5E5"> are up</font>

762
00:42:06,460 --> 00:42:13,060
there they're completely document the

763
00:42:08,770 --> 00:42:16,180
whole tool but you know try<font color="#E5E5E5"> it out in in</font>

764
00:42:13,060 --> 00:42:19,720
<font color="#E5E5E5">your environment</font><font color="#CCCCCC"> with a small subset of</font>

765
00:42:16,180 --> 00:42:20,410
boxes<font color="#CCCCCC"> to make</font><font color="#E5E5E5"> sure that your</font><font color="#CCCCCC"> network can</font>

766
00:42:19,720 --> 00:42:24,640
handle it

767
00:42:20,410 --> 00:42:28,060
so initially we're when we're using frac

768
00:42:24,640 --> 00:42:31,240
to<font color="#E5E5E5"> retrieve files and all that we keep</font>

769
00:42:28,060 --> 00:42:34,150
<font color="#CCCCCC">that under 25</font><font color="#E5E5E5"> because having it tried to</font>

770
00:42:31,240 --> 00:42:37,000
<font color="#E5E5E5">do</font><font color="#CCCCCC"> fifty to a hundred didn't really make</font>

771
00:42:34,150 --> 00:42:39,490
the tool go any faster and there's

772
00:42:37,000 --> 00:42:40,990
impact to the network<font color="#CCCCCC"> but as far as</font>

773
00:42:39,490 --> 00:42:42,759
<font color="#CCCCCC">claim maybe</font><font color="#E5E5E5"> goes there's not a whole lot</font>

774
00:42:40,990 --> 00:42:46,330
impact<font color="#CCCCCC"> cuz it's running locally on</font><font color="#E5E5E5"> the</font>

775
00:42:42,760 --> 00:42:49,510
box<font color="#E5E5E5"> and it's just sending the output to</font>

776
00:42:46,330 --> 00:42:52,590
<font color="#E5E5E5">your network sure so you should be able</font>

777
00:42:49,510 --> 00:42:52,590
to<font color="#E5E5E5"> run a lot more</font><font color="#CCCCCC"> than that</font>

778
00:42:56,070 --> 00:43:03,970
yeah coming<font color="#CCCCCC"> back</font><font color="#E5E5E5"> to the</font><font color="#CCCCCC"> poison</font><font color="#E5E5E5"> hi</font><font color="#CCCCCC"> baby</font>

779
00:43:00,130 --> 00:43:08,260
these are another notation another

780
00:43:03,970 --> 00:43:12,578
<font color="#CCCCCC">expression</font><font color="#E5E5E5"> of the tiara</font><font color="#CCCCCC"> for poison</font><font color="#E5E5E5"> ivy</font>

781
00:43:08,260 --> 00:43:18,339
<font color="#CCCCCC">that is basically run the same set we</font>

782
00:43:12,579 --> 00:43:21,190
have develop it<font color="#E5E5E5"> into</font><font color="#CCCCCC"> clam IV and you can</font>

783
00:43:18,339 --> 00:43:24,369
<font color="#CCCCCC">easily understand compared</font><font color="#E5E5E5"> to the</font>

784
00:43:21,190 --> 00:43:26,320
<font color="#CCCCCC">previous slide</font><font color="#E5E5E5"> related to the</font><font color="#CCCCCC"> yarra</font><font color="#E5E5E5"> that</font>

785
00:43:24,369 --> 00:43:33,579
this is<font color="#E5E5E5"> basically an import of the</font><font color="#CCCCCC"> yarra</font>

786
00:43:26,320 --> 00:43:36,820
into clam IV and this one<font color="#E5E5E5"> instead is a</font>

787
00:43:33,579 --> 00:43:39,720
notation for<font color="#CCCCCC"> climb av rule related to</font>

788
00:43:36,820 --> 00:43:43,150
bison<font color="#E5E5E5"> all that we have discussed</font><font color="#CCCCCC"> before</font>

789
00:43:39,720 --> 00:43:47,040
<font color="#CCCCCC">in this case we have been able also to</font>

790
00:43:43,150 --> 00:43:51,839
track<font color="#CCCCCC"> certain type of</font><font color="#E5E5E5"> items of sorry we</font>

791
00:43:47,040 --> 00:43:55,240
okay<font color="#E5E5E5"> certain type of items into into the</font>

792
00:43:51,839 --> 00:43:57,430
<font color="#E5E5E5">the P that</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> related also to the</font>

793
00:43:55,240 --> 00:44:00,310
behavior like like this<font color="#E5E5E5"> okay</font>

794
00:43:57,430 --> 00:44:03,098
this is<font color="#E5E5E5"> related to the fact that the</font>

795
00:44:00,310 --> 00:44:05,770
file will<font color="#E5E5E5"> drop the persistent</font><font color="#CCCCCC"> make</font>

796
00:44:03,099 --> 00:44:08,560
mechanism through executing a key in<font color="#E5E5E5"> a</font>

797
00:44:05,770 --> 00:44:11,050
<font color="#E5E5E5">run on system so we have been able to</font>

798
00:44:08,560 --> 00:44:13,270
<font color="#E5E5E5">implement also</font><font color="#CCCCCC"> these into the</font>

799
00:44:11,050 --> 00:44:16,030
<font color="#E5E5E5">description of the rule into the claim</font>

800
00:44:13,270 --> 00:44:18,940
IV so meaning<font color="#E5E5E5"> that trauma V is also able</font>

801
00:44:16,030 --> 00:44:21,369
<font color="#E5E5E5">to catch the chance of this particular</font>

802
00:44:18,940 --> 00:44:23,440
type of<font color="#E5E5E5"> key running in the system while</font>

803
00:44:21,369 --> 00:44:40,000
drop at<font color="#CCCCCC"> the file and executed so that's</font>

804
00:44:23,440 --> 00:44:42,490
good so one other thing that<font color="#E5E5E5"> at a recent</font>

805
00:44:40,000 --> 00:44:46,030
triage case I was doing<font color="#E5E5E5"> yeah as using</font>

806
00:44:42,490 --> 00:44:51,609
<font color="#CCCCCC">clamavi and</font><font color="#E5E5E5"> basically I had loaded all</font>

807
00:44:46,030 --> 00:44:54,810
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> signatures the from clam V that I</font>

808
00:44:51,609 --> 00:44:57,279
could and I ran across the entire<font color="#CCCCCC"> drive</font>

809
00:44:54,810 --> 00:44:59,730
<font color="#E5E5E5">and this is just kind</font><font color="#CCCCCC"> of a side note</font><font color="#E5E5E5"> for</font>

810
00:44:57,280 --> 00:44:59,730
<font color="#E5E5E5">y'all</font>

811
00:45:00,180 --> 00:45:11,230
clamavi was able to<font color="#CCCCCC"> detect basically</font>

812
00:45:06,690 --> 00:45:13,630
exploits and stuff<font color="#E5E5E5"> sitting in logs by</font>

813
00:45:11,230 --> 00:45:15,310
<font color="#CCCCCC">ice this was</font><font color="#E5E5E5"> just kind of floored me</font>

814
00:45:13,630 --> 00:45:18,340
because<font color="#E5E5E5"> I never saw I never knew</font><font color="#CCCCCC"> that</font>

815
00:45:15,310 --> 00:45:21,279
<font color="#CCCCCC">claim maybe would do this</font><font color="#E5E5E5"> and so this</font>

816
00:45:18,340 --> 00:45:24,100
mod<font color="#CCCCCC"> SEC audit log for example it's</font>

817
00:45:21,280 --> 00:45:27,640
literally modsecurity<font color="#E5E5E5"> log we have a post</font>

818
00:45:24,100 --> 00:45:29,710
request<font color="#CCCCCC"> and this</font><font color="#E5E5E5"> is regarding Windows</font>

819
00:45:27,640 --> 00:45:31,779
and we have the cert<font color="#E5E5E5"> util URL catch</font>

820
00:45:29,710 --> 00:45:36,160
<font color="#E5E5E5">trying to</font><font color="#CCCCCC"> download a piece</font><font color="#E5E5E5"> of malware</font>

821
00:45:31,780 --> 00:45:37,090
<font color="#E5E5E5">and claim maybe saw that in the log made</font>

822
00:45:36,160 --> 00:45:39,790
my job easier

823
00:45:37,090 --> 00:45:42,520
so rather than<font color="#E5E5E5"> parsing through a bunch</font>

824
00:45:39,790 --> 00:45:43,990
<font color="#E5E5E5">of logs and looking at every</font><font color="#CCCCCC"> single</font>

825
00:45:42,520 --> 00:45:48,160
thing<font color="#E5E5E5"> which could take hours</font>

826
00:45:43,990 --> 00:45:53,919
you know just run it real quick<font color="#E5E5E5"> and take</font>

827
00:45:48,160 --> 00:45:58,299
<font color="#CCCCCC">a quick</font><font color="#E5E5E5"> look at it and the the section</font>

828
00:45:53,920 --> 00:46:01,270
<font color="#E5E5E5">down</font><font color="#CCCCCC"> here that is what was in the</font><font color="#E5E5E5"> log so</font>

829
00:45:58,300 --> 00:46:04,120
it<font color="#CCCCCC"> was a bunch of URL</font><font color="#E5E5E5"> encoding and stuff</font>

830
00:46:01,270 --> 00:46:07,180
like that but this is<font color="#CCCCCC"> what the the</font><font color="#E5E5E5"> ASCII</font>

831
00:46:04,120 --> 00:46:16,210
output of that<font color="#E5E5E5"> command that was being</font>

832
00:46:07,180 --> 00:46:17,919
ran against the the web server so just

833
00:46:16,210 --> 00:46:21,520
summarize a<font color="#E5E5E5"> little bit in the beginning</font>

834
00:46:17,920 --> 00:46:23,710
<font color="#CCCCCC">of the</font><font color="#E5E5E5"> presentation we talked about what</font>

835
00:46:21,520 --> 00:46:25,990
action Iowa sees are and we want to make

836
00:46:23,710 --> 00:46:28,810
<font color="#CCCCCC">sure that we have solid</font><font color="#E5E5E5"> indicators now</font>

837
00:46:25,990 --> 00:46:31,919
<font color="#E5E5E5">we talked about riff in frac in the</font>

838
00:46:28,810 --> 00:46:34,420
beginning<font color="#E5E5E5"> and that's just part of</font>

839
00:46:31,920 --> 00:46:36,790
initiating the triage process when

840
00:46:34,420 --> 00:46:42,220
responding to<font color="#CCCCCC"> an incident</font><font color="#E5E5E5"> we need</font><font color="#CCCCCC"> to get</font>

841
00:46:36,790 --> 00:46:45,670
files<font color="#E5E5E5"> from</font><font color="#CCCCCC"> our boxes that we're going</font><font color="#E5E5E5"> to</font>

842
00:46:42,220 --> 00:46:49,750
analyze<font color="#E5E5E5"> looking for our first couple</font>

843
00:46:45,670 --> 00:46:52,030
threads with<font color="#E5E5E5"> the incident and then once</font>

844
00:46:49,750 --> 00:46:55,600
we have those first few threads that

845
00:46:52,030 --> 00:46:58,810
were able<font color="#E5E5E5"> to pull then we can start</font>

846
00:46:55,600 --> 00:47:02,190
<font color="#CCCCCC">bringing in clamavi for</font><font color="#E5E5E5"> example and</font>

847
00:46:58,810 --> 00:47:05,200
start taking<font color="#E5E5E5"> those action Elias ES and</font>

848
00:47:02,190 --> 00:47:07,870
<font color="#CCCCCC">Krane signatures</font><font color="#E5E5E5"> and start searching</font><font color="#CCCCCC"> for</font>

849
00:47:05,200 --> 00:47:10,470
<font color="#CCCCCC">all the other machines</font><font color="#E5E5E5"> within the</font>

850
00:47:07,870 --> 00:47:12,400
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> so they're you know the</font>

851
00:47:10,470 --> 00:47:16,779
let's say the first

852
00:47:12,400 --> 00:47:20,400
wave of triage gives us maybe<font color="#CCCCCC"> ten</font>

853
00:47:16,779 --> 00:47:23,289
<font color="#CCCCCC">machines</font><font color="#E5E5E5"> when we take those IOC s</font>

854
00:47:20,400 --> 00:47:30,029
<font color="#CCCCCC">run-through clamavi we may have you know</font>

855
00:47:23,289 --> 00:47:32,890
<font color="#CCCCCC">20 30</font><font color="#E5E5E5"> more</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> know it depends on</font>

856
00:47:30,029 --> 00:47:35,440
what we find<font color="#CCCCCC"> what</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> 20 30 more if we</font>

857
00:47:32,890 --> 00:47:37,900
have more IOC s and then we'll do

858
00:47:35,440 --> 00:47:41,520
another<font color="#E5E5E5"> wave with clamavi but the nice</font>

859
00:47:37,900 --> 00:47:44,890
<font color="#CCCCCC">thing is is nobody has to sit there and</font>

860
00:47:41,520 --> 00:47:47,770
be<font color="#CCCCCC"> hands on keyboard for</font><font color="#E5E5E5"> the entire scan</font>

861
00:47:44,890 --> 00:47:51,160
you scanned and<font color="#CCCCCC"> then you</font><font color="#E5E5E5"> analyze and if</font>

862
00:47:47,770 --> 00:47:55,000
we're only getting our hits back<font color="#E5E5E5"> and</font>

863
00:47:51,160 --> 00:47:57,190
just doing<font color="#E5E5E5"> a quick review</font><font color="#CCCCCC"> of that you're</font>

864
00:47:55,000 --> 00:48:00,400
talking<font color="#E5E5E5"> anywhere from</font><font color="#CCCCCC"> five minutes to</font>

865
00:47:57,190 --> 00:48:04,240
<font color="#E5E5E5">maybe an hour to go through output of</font>

866
00:48:00,400 --> 00:48:08,200
you know<font color="#CCCCCC"> 10,000 20,000</font><font color="#E5E5E5"> machines no</font>

867
00:48:04,240 --> 00:48:18,939
problem versus<font color="#E5E5E5"> having somebody log in</font>

868
00:48:08,200 --> 00:48:22,689
and then look<font color="#CCCCCC"> for them by hand the</font><font color="#E5E5E5"> this</font>

869
00:48:18,940 --> 00:48:25,240
one is<font color="#CCCCCC"> for posterity</font><font color="#E5E5E5"> thinking about</font>

870
00:48:22,690 --> 00:48:28,420
where<font color="#E5E5E5"> we hitting we are increasing the</font>

871
00:48:25,240 --> 00:48:32,319
number<font color="#CCCCCC"> of thank you the number of</font><font color="#E5E5E5"> items</font>

872
00:48:28,420 --> 00:48:35,380
we consider into the<font color="#E5E5E5"> actionable Isis so</font>

873
00:48:32,319 --> 00:48:37,750
we are expanding<font color="#CCCCCC"> even looking to the</font>

874
00:48:35,380 --> 00:48:40,150
chance<font color="#E5E5E5"> to integrate so</font><font color="#CCCCCC"> ricotta is</font><font color="#E5E5E5"> more</font>

875
00:48:37,750 --> 00:48:43,180
<font color="#E5E5E5">true and other things just</font><font color="#CCCCCC"> in order to</font>

876
00:48:40,150 --> 00:48:45,339
provide in potentially a single set of

877
00:48:43,180 --> 00:48:48,490
platform a single<font color="#CCCCCC"> smooth set a platform</font>

878
00:48:45,339 --> 00:48:51,130
even<font color="#CCCCCC"> openSUSE for</font><font color="#E5E5E5"> potentially free the</font>

879
00:48:48,490 --> 00:48:54,819
chance<font color="#E5E5E5"> to run biggest</font><font color="#CCCCCC"> investigation then</font>

880
00:48:51,130 --> 00:48:56,950
then normally<font color="#CCCCCC"> thought okay so</font><font color="#E5E5E5"> and this</font>

881
00:48:54,819 --> 00:49:00,400
<font color="#E5E5E5">is really really important on the other</font>

882
00:48:56,950 --> 00:49:02,740
<font color="#E5E5E5">end</font><font color="#CCCCCC"> consider the</font><font color="#E5E5E5"> fact that even if</font>

883
00:49:00,400 --> 00:49:06,549
actually the technology<font color="#CCCCCC"> is</font><font color="#E5E5E5"> moving</font><font color="#CCCCCC"> to</font>

884
00:49:02,740 --> 00:49:11,140
help support with new new platforms<font color="#E5E5E5"> the</font>

885
00:49:06,549 --> 00:49:13,720
<font color="#CCCCCC">IR from</font><font color="#E5E5E5"> the Oscar spective from the</font>

886
00:49:11,140 --> 00:49:16,690
network perspective<font color="#E5E5E5"> many of the vast</font>

887
00:49:13,720 --> 00:49:18,730
<font color="#E5E5E5">majority of these are not interested</font><font color="#CCCCCC"> in</font>

888
00:49:16,690 --> 00:49:22,210
developing<font color="#CCCCCC"> agents because normally they</font>

889
00:49:18,730 --> 00:49:24,549
are agent based<font color="#E5E5E5"> on system like hp-ux so</font>

890
00:49:22,210 --> 00:49:25,660
we think<font color="#E5E5E5"> that our approach will stay</font>

891
00:49:24,549 --> 00:49:30,880
forever<font color="#CCCCCC"> because</font>

892
00:49:25,660 --> 00:49:34,089
simply is easy<font color="#E5E5E5"> relatively low impact in</font>

893
00:49:30,880 --> 00:49:37,329
terms of you<font color="#CCCCCC"> know resources to use and</font>

894
00:49:34,089 --> 00:49:39,520
in the end<font color="#CCCCCC"> it's also potentially</font><font color="#E5E5E5"> if well</font>

895
00:49:37,329 --> 00:49:39,970
<font color="#CCCCCC">design in the in</font><font color="#E5E5E5"> in the begin at the</font>

896
00:49:39,520 --> 00:49:44,288
beginning

897
00:49:39,970 --> 00:49:45,848
really really performing so I mean from

898
00:49:44,289 --> 00:49:47,859
from<font color="#CCCCCC"> that perspective is definitely a</font>

899
00:49:45,849 --> 00:49:56,530
winning solution<font color="#CCCCCC"> thank you very</font><font color="#E5E5E5"> much you</font>

900
00:49:47,859 --> 00:50:03,808
guys<font color="#E5E5E5"> you have any question do you</font><font color="#CCCCCC"> have</font>

901
00:49:56,530 --> 00:50:03,809
<font color="#CCCCCC">any question yeah one</font><font color="#E5E5E5"> thing I'll say</font><font color="#CCCCCC"> -</font>

902
00:50:07,020 --> 00:50:13,150
<font color="#E5E5E5">under the sands blog</font><font color="#CCCCCC"> I have a bunch</font><font color="#E5E5E5"> of</font>

903
00:50:10,450 --> 00:50:15,220
articles<font color="#CCCCCC"> I'm in the process of writing</font>

904
00:50:13,150 --> 00:50:18,430
there's probably four or five right<font color="#E5E5E5"> now</font>

905
00:50:15,220 --> 00:50:22,270
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> about mass triage and the tools</font>

906
00:50:18,430 --> 00:50:25,299
that we use<font color="#CCCCCC"> none and some the tools</font><font color="#E5E5E5"> that</font>

907
00:50:22,270 --> 00:50:28,839
I go<font color="#CCCCCC"> through on the sand site is open</font>

908
00:50:25,299 --> 00:50:32,170
<font color="#E5E5E5">source</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I go through our methodology</font>

909
00:50:28,839 --> 00:50:34,690
<font color="#CCCCCC">and it's nothing that you know everybody</font>

910
00:50:32,170 --> 00:50:36,910
can do<font color="#CCCCCC"> it it's fairly</font><font color="#E5E5E5"> easy</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> just</font>

911
00:50:34,690 --> 00:50:43,079
<font color="#E5E5E5">learning the tools on and how to do that</font>

912
00:50:36,910 --> 00:50:43,078
and<font color="#CCCCCC"> that feeds these I OCS here thanks</font>

913
00:50:45,100 --> 00:50:48,170
[Music]

