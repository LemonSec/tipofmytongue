1
00:00:01,510 --> 00:00:06,420
oops jump on this stage to talk about

2
00:00:03,790 --> 00:00:06,420
security

3
00:00:06,510 --> 00:00:15,730
good morning I just want to preface this

4
00:00:13,690 --> 00:00:16,990
talk a little bit so this was actually a

5
00:00:15,730 --> 00:00:18,990
talk that was written out of frustration

6
00:00:16,990 --> 00:00:21,729
for a smaller conference in Australia

7
00:00:18,990 --> 00:00:23,020
earlier this year and someone came up to

8
00:00:21,730 --> 00:00:24,340
me afterwards and said you know man that

9
00:00:23,020 --> 00:00:27,280
would make a really good keynote and

10
00:00:24,340 --> 00:00:29,620
then a few months later halvah put in a

11
00:00:27,280 --> 00:00:31,660
slide deck that keynotes golf or retired

12
00:00:29,620 --> 00:00:35,140
researchers so this is not a keynote or

13
00:00:31,660 --> 00:00:36,640
anything related to it and it's a

14
00:00:35,140 --> 00:00:38,560
pleasure to be here about 10 years ago

15
00:00:36,640 --> 00:00:41,440
myself and a couple of friends started a

16
00:00:38,560 --> 00:00:42,910
conference here in Wellington and one of

17
00:00:41,440 --> 00:00:44,169
the things when you run a conference is

18
00:00:42,910 --> 00:00:45,790
you don't really get to attend for

19
00:00:44,170 --> 00:00:46,930
conference so it's actually pretty

20
00:00:45,790 --> 00:00:49,930
awesome just be able to tend them to

21
00:00:46,930 --> 00:00:51,820
speak at a conference so a little bit of

22
00:00:49,930 --> 00:00:53,950
introduction my name is Mark people call

23
00:00:51,820 --> 00:00:57,940
me pipes my official job title is

24
00:00:53,950 --> 00:01:00,070
anywhere and soccer and really what I

25
00:00:57,940 --> 00:01:01,360
wanted to talk to today is even though

26
00:01:00,070 --> 00:01:04,780
we're in the red team track this is more

27
00:01:01,360 --> 00:01:06,450
of a talk for the blue team and this is

28
00:01:04,780 --> 00:01:10,960
a talk about how to make my job harder

29
00:01:06,450 --> 00:01:12,549
right and that could be seen as a little

30
00:01:10,960 --> 00:01:14,350
bit why would you want to do that pipes

31
00:01:12,549 --> 00:01:17,139
and it's blue because I like a challenge

32
00:01:14,350 --> 00:01:17,949
I like it when my job started so what

33
00:01:17,139 --> 00:01:19,208
we're going to do is we're going to go

34
00:01:17,950 --> 00:01:20,259
through some strategies today we're

35
00:01:19,209 --> 00:01:22,240
going to go through some strategies

36
00:01:20,259 --> 00:01:24,159
related to how the red team and

37
00:01:22,240 --> 00:01:25,600
adversary's and attackers sort of play

38
00:01:24,159 --> 00:01:26,920
their game and how the blue team can

39
00:01:25,600 --> 00:01:28,780
sort of leverage understanding those

40
00:01:26,920 --> 00:01:31,479
strategies to get some really quick and

41
00:01:28,780 --> 00:01:33,579
simple wins across their systems we're

42
00:01:31,479 --> 00:01:37,560
going to go beyond patching I recently

43
00:01:33,579 --> 00:01:39,639
gave some talks to Microsoft and

44
00:01:37,560 --> 00:01:41,229
remember there were working out like

45
00:01:39,639 --> 00:01:43,029
what is the number one mitigation that

46
00:01:41,229 --> 00:01:44,798
you should be doing and unfortunately

47
00:01:43,029 --> 00:01:46,209
patching still came up tops and I'm like

48
00:01:44,799 --> 00:01:48,479
well I don't really care about patching

49
00:01:46,209 --> 00:01:50,889
everyone should be patching anyway

50
00:01:48,479 --> 00:01:52,450
before I get started I really wanted to

51
00:01:50,889 --> 00:01:54,369
touch on threat modeling how many people

52
00:01:52,450 --> 00:01:57,490
here saw Darren Bobby's talk a cubicle

53
00:01:54,369 --> 00:01:58,719
and I think it was last year yeah one of

54
00:01:57,490 --> 00:02:00,098
the things that Darren had was a really

55
00:01:58,719 --> 00:02:02,109
good point is that when it comes to

56
00:02:00,099 --> 00:02:04,149
looking at adversary's and when it comes

57
00:02:02,109 --> 00:02:05,229
to looking at attackers as we love to

58
00:02:04,149 --> 00:02:07,029
threat model and we don't do it very

59
00:02:05,229 --> 00:02:09,068
well and James Mickens from Microsoft

60
00:02:07,029 --> 00:02:10,840
Research gave this really awesome white

61
00:02:09,068 --> 00:02:13,030
papers sort of in to use necks which

62
00:02:10,840 --> 00:02:15,040
sort of outlined the fact that when it

63
00:02:13,030 --> 00:02:16,750
comes to understanding risk and

64
00:02:15,040 --> 00:02:18,939
comes to threat modeling we tend to go

65
00:02:16,750 --> 00:02:20,200
straight to the massage right like if

66
00:02:18,939 --> 00:02:21,489
Mossad wants to massage you they're

67
00:02:20,200 --> 00:02:24,670
going to massage you with Masotti things

68
00:02:21,489 --> 00:02:26,319
right and so one of the things that I

69
00:02:24,670 --> 00:02:28,780
want to keep in mind as we go through

70
00:02:26,319 --> 00:02:30,250
this morning is that strip modeling is

71
00:02:28,780 --> 00:02:31,930
important and it's important to go

72
00:02:30,250 --> 00:02:33,730
beyond what we see in the headlines is

73
00:02:31,930 --> 00:02:34,959
important to go beyond the apt threat

74
00:02:33,730 --> 00:02:37,390
reports it's important to go beyond

75
00:02:34,959 --> 00:02:41,459
nation-state as we like to call it and

76
00:02:37,390 --> 00:02:44,980
really consider ecosystems as a whole

77
00:02:41,459 --> 00:02:47,170
how many people know this guy yeah

78
00:02:44,980 --> 00:02:49,540
Willie Apiata sort of Victoria Cross

79
00:02:47,170 --> 00:02:52,420
winner it's a special forces operative

80
00:02:49,540 --> 00:02:55,000
leader stormed Kabul took out the

81
00:02:52,420 --> 00:02:56,108
terrorists and the Red Team a lot of

82
00:02:55,000 --> 00:02:57,459
people like to think we're this guy

83
00:02:56,109 --> 00:02:59,709
right we like to think that we're

84
00:02:57,459 --> 00:03:01,480
Special Forces operations that we have

85
00:02:59,709 --> 00:03:02,769
tactical gear and that we've got some

86
00:03:01,480 --> 00:03:04,480
cool tricks and we're going to come and

87
00:03:02,769 --> 00:03:06,730
show them off on your network or against

88
00:03:04,480 --> 00:03:09,090
your organization and it's gonna go

89
00:03:06,730 --> 00:03:11,048
through and we're going to win right

90
00:03:09,090 --> 00:03:12,700
it's not true we're talking about

91
00:03:11,049 --> 00:03:14,799
computer security right we're talking

92
00:03:12,700 --> 00:03:16,540
about what literally just laptops and

93
00:03:14,799 --> 00:03:18,549
servers and we're talking about like you

94
00:03:16,540 --> 00:03:21,578
know running scripts and sort of going

95
00:03:18,549 --> 00:03:22,959
through strategy but so one of the

96
00:03:21,579 --> 00:03:25,569
things I want people to consider and

97
00:03:22,959 --> 00:03:27,579
take away from today is that there is no

98
00:03:25,569 --> 00:03:30,099
magic when it comes to attack in an

99
00:03:27,579 --> 00:03:32,260
organization or a network right there's

100
00:03:30,099 --> 00:03:33,879
some considerations there's some

101
00:03:32,260 --> 00:03:36,220
technical thinking there's some process

102
00:03:33,879 --> 00:03:37,840
as we go through there's you know a

103
00:03:36,220 --> 00:03:39,609
little bit of creativity behind it but

104
00:03:37,840 --> 00:03:42,040
there's no magic right this isn't

105
00:03:39,609 --> 00:03:44,169
wizardry this isn't hardcore Special

106
00:03:42,040 --> 00:03:46,239
Forces operations this is just computer

107
00:03:44,169 --> 00:03:47,739
security so one of the things I want to

108
00:03:46,239 --> 00:03:49,269
do when we go through this morning is we

109
00:03:47,739 --> 00:03:50,799
want to break down sort of common

110
00:03:49,269 --> 00:03:52,209
strategies that attackers were use and

111
00:03:50,799 --> 00:03:54,400
how we can sort of mitigate against them

112
00:03:52,209 --> 00:03:55,780
and one of the things I was doing when I

113
00:03:54,400 --> 00:03:57,699
was working on this talk was thinking

114
00:03:55,780 --> 00:03:59,079
about how can we distill it down can we

115
00:03:57,699 --> 00:04:01,599
just still it down to us absolute

116
00:03:59,079 --> 00:04:03,879
essence on what this magic that people

117
00:04:01,599 --> 00:04:04,888
seem to perceive is and the answer is

118
00:04:03,879 --> 00:04:06,760
pretty simple

119
00:04:04,889 --> 00:04:09,729
attackers want to get creeds and own

120
00:04:06,760 --> 00:04:12,099
stuff right and if you look at any sort

121
00:04:09,729 --> 00:04:14,049
of modern attacker nowadays like the way

122
00:04:12,099 --> 00:04:15,790
they do it's very different sometimes

123
00:04:14,049 --> 00:04:19,209
the approach that we take is very

124
00:04:15,790 --> 00:04:20,649
different sometimes the may be like you

125
00:04:19,209 --> 00:04:21,880
know fishing for credentials or it may

126
00:04:20,649 --> 00:04:23,380
be fishing with a payload to get

127
00:04:21,880 --> 00:04:25,659
execution on a laptop and then getting

128
00:04:23,380 --> 00:04:27,340
credentials out of memory right the idea

129
00:04:25,659 --> 00:04:27,990
is is that we want to get creates and we

130
00:04:27,340 --> 00:04:30,210
want to use them

131
00:04:27,990 --> 00:04:32,460
to own stuff and it's pretty simple in

132
00:04:30,210 --> 00:04:34,138
its its most of the attacks I mean even

133
00:04:32,460 --> 00:04:35,789
some of the newer ransomware variants as

134
00:04:34,139 --> 00:04:37,830
I understand it are very much leveraging

135
00:04:35,789 --> 00:04:39,568
like you know out of memory credentials

136
00:04:37,830 --> 00:04:42,800
to spread laterally across networks to

137
00:04:39,569 --> 00:04:46,169
encrypt more files and stuff like that

138
00:04:42,800 --> 00:04:48,030
so my job my job is an immigrant checker

139
00:04:46,169 --> 00:04:49,859
it is to break into organizations it is

140
00:04:48,030 --> 00:04:51,750
to do application security testing it is

141
00:04:49,860 --> 00:04:52,919
through all the offensive security stuff

142
00:04:51,750 --> 00:04:54,300
that we left it over when it comes to

143
00:04:52,919 --> 00:04:55,219
explaining my job it's actually pretty

144
00:04:54,300 --> 00:04:57,770
difficult right

145
00:04:55,220 --> 00:05:01,830
my job is effectively playing pinball

146
00:04:57,770 --> 00:05:04,799
right I am on your network your network

147
00:05:01,830 --> 00:05:06,030
is the table applications the table if

148
00:05:04,800 --> 00:05:07,560
you've ever played pinball it's a really

149
00:05:06,030 --> 00:05:09,630
awesome game there's lots of ramps and

150
00:05:07,560 --> 00:05:10,560
traps and bonuses and combos and lots of

151
00:05:09,630 --> 00:05:13,050
tricks that you've got to go through

152
00:05:10,560 --> 00:05:14,940
with various trick shots so as an

153
00:05:13,050 --> 00:05:16,380
attacker I'm playing both pinball and in

154
00:05:14,940 --> 00:05:19,409
order to play pinball I have to get a

155
00:05:16,380 --> 00:05:20,940
ball on the table right so if I have a

156
00:05:19,409 --> 00:05:22,620
ball on your table what can I do with

157
00:05:20,940 --> 00:05:24,240
that ball I have to sort of maneuver it

158
00:05:22,620 --> 00:05:25,889
up a ramp or I have to get it up the

159
00:05:24,240 --> 00:05:27,509
same ramp three times in order to get

160
00:05:25,889 --> 00:05:28,860
the bonus points or want to trigger

161
00:05:27,509 --> 00:05:29,729
multi ball right motor pool would be

162
00:05:28,860 --> 00:05:31,259
awesome because it means I've got

163
00:05:29,729 --> 00:05:35,490
multiple credentials model always around

164
00:05:31,259 --> 00:05:38,310
your network or environment so when it

165
00:05:35,490 --> 00:05:40,229
comes to working through strategies it's

166
00:05:38,310 --> 00:05:42,690
kind of like okay can you make your

167
00:05:40,229 --> 00:05:44,250
table as hard as possible for me to play

168
00:05:42,690 --> 00:05:45,719
on can you make it as tricky as possible

169
00:05:44,250 --> 00:05:47,219
mid cloud can you make it easier for my

170
00:05:45,719 --> 00:05:48,889
ball to get sunk into a hole on your

171
00:05:47,219 --> 00:05:51,719
table can it make it easier for me to

172
00:05:48,889 --> 00:05:53,280
trigger tilt mode and shut down the the

173
00:05:51,719 --> 00:05:56,520
flippers so that the ball comes back out

174
00:05:53,280 --> 00:05:57,929
of in there work right and in order to

175
00:05:56,520 --> 00:05:59,400
play on your table I need to spend money

176
00:05:57,930 --> 00:06:00,810
like my mum used to get really grumpy

177
00:05:59,400 --> 00:06:02,400
whenever we went to coffin code because

178
00:06:00,810 --> 00:06:07,229
I demand 50cm pieces to play The

179
00:06:02,400 --> 00:06:08,880
Terminator 2 game and money is what we

180
00:06:07,229 --> 00:06:10,440
need to sort of get onto your table

181
00:06:08,880 --> 00:06:12,659
right now we're talking about money in

182
00:06:10,440 --> 00:06:14,699
the sense of coins in this case and not

183
00:06:12,659 --> 00:06:17,009
bitcoins or any other sort of dogecoin

184
00:06:14,699 --> 00:06:19,680
or whatever it is nowadays but really

185
00:06:17,009 --> 00:06:21,810
looking at there's an investment from my

186
00:06:19,680 --> 00:06:25,560
point right at some point I've decided

187
00:06:21,810 --> 00:06:28,440
to invest time or money or risk a

188
00:06:25,560 --> 00:06:32,190
strategy or a technique in order to get

189
00:06:28,440 --> 00:06:35,190
into your environment right and what

190
00:06:32,190 --> 00:06:36,270
that price is varies greatly and how I

191
00:06:35,190 --> 00:06:38,580
spend my money can vary greatly

192
00:06:36,270 --> 00:06:40,020
depending on who I am right so we love

193
00:06:38,580 --> 00:06:41,669
to talk about nation state having

194
00:06:40,020 --> 00:06:43,049
infinite resources and they've got

195
00:06:41,670 --> 00:06:45,360
lots and lots of budget and I've got all

196
00:06:43,050 --> 00:06:46,860
the cool techniques and they can come in

197
00:06:45,360 --> 00:06:48,330
and put it into the table and drop onto

198
00:06:46,860 --> 00:06:50,040
your network with six different balls

199
00:06:48,330 --> 00:06:51,450
and they can go to town and that may be

200
00:06:50,040 --> 00:06:52,800
true but there's also various other

201
00:06:51,450 --> 00:06:55,979
levels of attackers and various other

202
00:06:52,800 --> 00:06:57,750
levels of motivation for Venables

203
00:06:55,980 --> 00:06:59,250
sunless up really nicely after the

204
00:06:57,750 --> 00:07:02,130
Snowden leaks where he said attackers

205
00:06:59,250 --> 00:07:04,350
have bosses and budgets to write and if

206
00:07:02,130 --> 00:07:07,260
you think about it most attackers in

207
00:07:04,350 --> 00:07:09,600
2017 I'm motivated by Finance I'm

208
00:07:07,260 --> 00:07:13,200
motivated by money right some are

209
00:07:09,600 --> 00:07:16,500
motivated by more political aspects but

210
00:07:13,200 --> 00:07:18,120
they have effectively either themselves

211
00:07:16,500 --> 00:07:20,160
or someone else they have to justify

212
00:07:18,120 --> 00:07:22,230
their time and money to write and if

213
00:07:20,160 --> 00:07:24,930
they're not making money or achieving

214
00:07:22,230 --> 00:07:26,550
their goal inside an environment right

215
00:07:24,930 --> 00:07:28,530
then they're going to move on or try a

216
00:07:26,550 --> 00:07:31,760
different strategy or go go target you

217
00:07:28,530 --> 00:07:33,270
know the HVAC provider for your

218
00:07:31,760 --> 00:07:39,990
organization happens to have a

219
00:07:33,270 --> 00:07:41,310
point-of-sale network for example so he

220
00:07:39,990 --> 00:07:42,270
had a really good point about that and I

221
00:07:41,310 --> 00:07:43,740
thought it was really interesting then

222
00:07:42,270 --> 00:07:46,049
it was followed up by this awesome tweet

223
00:07:43,740 --> 00:07:47,430
by Dean Erdos Ovie which effectively

224
00:07:46,050 --> 00:07:49,050
dinner was sitting there saying look

225
00:07:47,430 --> 00:07:51,570
defenders have two approaches to

226
00:07:49,050 --> 00:07:53,910
reducing attacks raising cost right and

227
00:07:51,570 --> 00:07:55,980
decreasing value right so if you

228
00:07:53,910 --> 00:07:57,810
consider the most simple strategy is if

229
00:07:55,980 --> 00:07:59,340
the attackers have a budget and they

230
00:07:57,810 --> 00:08:00,810
have a motivation and a goal and data

231
00:07:59,340 --> 00:08:03,119
they're after or a goal that are after

232
00:08:00,810 --> 00:08:04,680
if you can raise the cost of them to be

233
00:08:03,120 --> 00:08:07,170
able to get onto the table to target

234
00:08:04,680 --> 00:08:08,430
that goal while reducing the value of

235
00:08:07,170 --> 00:08:10,530
what they can actually get out as they

236
00:08:08,430 --> 00:08:11,520
play the table right they're actually

237
00:08:10,530 --> 00:08:14,250
going to be in a better position than

238
00:08:11,520 --> 00:08:19,169
most and it's beyond patching right it's

239
00:08:14,250 --> 00:08:21,480
like how can we really drive some

240
00:08:19,170 --> 00:08:22,680
strategies around it and and that tweet

241
00:08:21,480 --> 00:08:23,790
stuck with me I can't exactly remember

242
00:08:22,680 --> 00:08:25,470
when he dropped out I think it was

243
00:08:23,790 --> 00:08:28,920
probably around 2015 and it's been

244
00:08:25,470 --> 00:08:30,900
ringing in my ears ever since right son

245
00:08:28,920 --> 00:08:32,700
a nutshell when it comes to the blue

246
00:08:30,900 --> 00:08:34,470
team and you've got the pinball table

247
00:08:32,700 --> 00:08:35,850
your job is to increase the cost and

248
00:08:34,470 --> 00:08:37,500
decrease the value of the data that I

249
00:08:35,850 --> 00:08:42,180
can get right so increase the cost to me

250
00:08:37,500 --> 00:08:43,770
decrease today what happens is when you

251
00:08:42,179 --> 00:08:45,870
do this when you when you change the way

252
00:08:43,770 --> 00:08:47,310
if we make us go off playbook if people

253
00:08:45,870 --> 00:08:48,810
abusing the same playbook across

254
00:08:47,310 --> 00:08:51,630
different environments over and over and

255
00:08:48,810 --> 00:08:53,550
over a results on a deviation I have to

256
00:08:51,630 --> 00:08:54,750
start taking risks right I have to start

257
00:08:53,550 --> 00:08:55,649
trying techniques that I may not have

258
00:08:54,750 --> 00:08:58,499
tried before

259
00:08:55,649 --> 00:08:59,819
attackers may try a different payload

260
00:08:58,499 --> 00:09:01,439
that they haven't tried before and you

261
00:08:59,819 --> 00:09:03,118
see this hugely at the moment across

262
00:09:01,439 --> 00:09:05,279
like the Microsoft Office payload space

263
00:09:03,119 --> 00:09:07,410
right but what happens is is that

264
00:09:05,279 --> 00:09:08,910
deviation increase risks and risks means

265
00:09:07,410 --> 00:09:10,319
mistakes and if we're making mistakes

266
00:09:08,910 --> 00:09:11,939
and attackers are making mistakes then

267
00:09:10,319 --> 00:09:14,610
you're more likely to catch them within

268
00:09:11,939 --> 00:09:16,160
the environment right and so when you're

269
00:09:14,610 --> 00:09:18,329
red teaming this is this is kind of

270
00:09:16,160 --> 00:09:19,889
always in the back of your mind right

271
00:09:18,329 --> 00:09:21,239
like we have this tried and proven

272
00:09:19,889 --> 00:09:22,589
method and all of a sudden it doesn't

273
00:09:21,240 --> 00:09:24,300
work so what are we going to try next

274
00:09:22,589 --> 00:09:25,829
what is the risk of trying there next

275
00:09:24,300 --> 00:09:28,019
are we gonna get quarterly edge leaving

276
00:09:25,829 --> 00:09:30,269
a achieve our objective where's it gonna

277
00:09:28,019 --> 00:09:31,889
go for right so the goal is to turn us

278
00:09:30,269 --> 00:09:33,360
into this guy right which is like it's

279
00:09:31,889 --> 00:09:35,040
ten past eleven and you want to order a

280
00:09:33,360 --> 00:09:37,290
McMuffin or some crap like that and just

281
00:09:35,040 --> 00:09:39,118
lose it right way one of the things that

282
00:09:37,290 --> 00:09:41,670
red teams don't talk about and one of

283
00:09:39,119 --> 00:09:43,589
the things that you don't often hear

284
00:09:41,670 --> 00:09:45,240
about is the frustration right there's

285
00:09:43,589 --> 00:09:46,740
nothing worse for example they're having

286
00:09:45,240 --> 00:09:48,089
credentials to an environment and not

287
00:09:46,740 --> 00:09:51,029
being in a position to be able to use

288
00:09:48,089 --> 00:09:52,439
them right there's nothing worse than it

289
00:09:51,029 --> 00:09:53,910
being eleven o'clock at night and it's

290
00:09:52,439 --> 00:09:55,230
week three of a test and you actually

291
00:09:53,910 --> 00:09:56,969
haven't been able to get into the

292
00:09:55,230 --> 00:09:59,160
organization because of various controls

293
00:09:56,970 --> 00:10:02,970
that are in place right it's frustrating

294
00:09:59,160 --> 00:10:05,370
and it's aggravating slow with that

295
00:10:02,970 --> 00:10:06,990
little sort of super basic introduction

296
00:10:05,370 --> 00:10:08,790
to attacker economics and and what our

297
00:10:06,990 --> 00:10:13,189
goal is today let's have a look at

298
00:10:08,790 --> 00:10:15,389
what's going on so strategy number one

299
00:10:13,189 --> 00:10:16,709
so we mentioned earlier that attackers

300
00:10:15,389 --> 00:10:19,290
love to get credentials and they love to

301
00:10:16,709 --> 00:10:22,079
use them to own stuff right so if you're

302
00:10:19,290 --> 00:10:24,449
the blue team Mada factor off and I mean

303
00:10:22,079 --> 00:10:25,559
proper multi factor authentication right

304
00:10:24,449 --> 00:10:28,139
one of the things that we see

305
00:10:25,559 --> 00:10:30,920
continuously is for example you'll have

306
00:10:28,139 --> 00:10:33,120
on-premise corporate network there'll be

307
00:10:30,920 --> 00:10:36,059
legions of controls that are in place

308
00:10:33,120 --> 00:10:38,129
there's VPNs or cell VPNs that all Madhi

309
00:10:36,059 --> 00:10:39,689
factor oft they all go through and then

310
00:10:38,129 --> 00:10:42,209
all of a sudden the organization is on

311
00:10:39,689 --> 00:10:44,730
office 365 with a TFS 1 factor auth

312
00:10:42,209 --> 00:10:46,079
right and it's kind of like what's going

313
00:10:44,730 --> 00:10:47,279
on here and they're like wow you know

314
00:10:46,079 --> 00:10:48,660
it's the cloud and we haven't quite

315
00:10:47,279 --> 00:10:51,179
figured out what we're going to do there

316
00:10:48,660 --> 00:10:53,129
and it's like well actually no like you

317
00:10:51,179 --> 00:10:54,240
know there's you need to consider where

318
00:10:53,129 --> 00:10:56,249
their credentials are going to be used

319
00:10:54,240 --> 00:10:59,220
from right there are Victor's from

320
00:10:56,249 --> 00:11:00,720
office 365 back onto on-prem right there

321
00:10:59,220 --> 00:11:04,860
are Victor's that have been being used

322
00:11:00,720 --> 00:11:07,290
quite successfully so when it comes to

323
00:11:04,860 --> 00:11:09,179
that non fishable is prepared right like

324
00:11:07,290 --> 00:11:09,569
we're talking UTF keys that sort of

325
00:11:09,179 --> 00:11:12,180
stuff

326
00:11:09,570 --> 00:11:15,570
right and if you're wondering about wine

327
00:11:12,180 --> 00:11:18,239
on fishable right it's like you know

328
00:11:15,570 --> 00:11:21,120
fishing proxies are a thing like being

329
00:11:18,240 --> 00:11:24,720
able to on pass like the agile TOTP and

330
00:11:21,120 --> 00:11:29,370
actually login decisions are a thing

331
00:11:24,720 --> 00:11:31,020
a quick note there there's a subject to

332
00:11:29,370 --> 00:11:32,730
much controversy as I'm actually an

333
00:11:31,020 --> 00:11:35,610
advocate for SMS if that's all you've

334
00:11:32,730 --> 00:11:37,320
got right like a lot of researchers and

335
00:11:35,610 --> 00:11:40,410
a lot of organizations say never assume

336
00:11:37,320 --> 00:11:41,910
is right the signal seven sort of issues

337
00:11:40,410 --> 00:11:43,350
there's number portability issues

338
00:11:41,910 --> 00:11:45,030
there's so many different ways to

339
00:11:43,350 --> 00:11:48,840
Jackies mess and even on red teams we

340
00:11:45,030 --> 00:11:50,760
have successfully got an SMS tokens to

341
00:11:48,840 --> 00:11:53,670
be able to log into other systems that

342
00:11:50,760 --> 00:11:55,770
are sensitive look if you have 3000

343
00:11:53,670 --> 00:11:58,709
users and you're choosing between one

344
00:11:55,770 --> 00:12:00,750
factor auth and one or an SMS go SMS

345
00:11:58,710 --> 00:12:03,210
right like it's a no-brainer

346
00:12:00,750 --> 00:12:05,550
like it's gonna add complexity it's

347
00:12:03,210 --> 00:12:07,800
gonna add risk why if I have the number

348
00:12:05,550 --> 00:12:09,630
portability attack a phone for example

349
00:12:07,800 --> 00:12:11,310
and swap out the Sun through social

350
00:12:09,630 --> 00:12:12,930
engineering there's an increased chance

351
00:12:11,310 --> 00:12:15,239
that the target that I just did it to

352
00:12:12,930 --> 00:12:16,859
goes my phone no longer works right and

353
00:12:15,240 --> 00:12:18,270
that happens right if you look at the

354
00:12:16,860 --> 00:12:21,330
coin based attack that went on where

355
00:12:18,270 --> 00:12:23,040
they actually did that against AT&T they

356
00:12:21,330 --> 00:12:24,450
noticed pretty much immediately that

357
00:12:23,040 --> 00:12:25,410
their phone wasn't working presumably

358
00:12:24,450 --> 00:12:27,360
because they couldn't get to Twitter

359
00:12:25,410 --> 00:12:29,790
right like it's it's that's the way it

360
00:12:27,360 --> 00:12:30,990
goes so anything's better than nothing

361
00:12:29,790 --> 00:12:32,790
and one of the other things about

362
00:12:30,990 --> 00:12:35,310
manufacture work that we we tend to

363
00:12:32,790 --> 00:12:37,260
forget is that ax is a very good sort of

364
00:12:35,310 --> 00:12:38,520
distributed alerting system right

365
00:12:37,260 --> 00:12:40,770
there's nothing worse than if you're on

366
00:12:38,520 --> 00:12:42,780
a very team you see an RDS service you

367
00:12:40,770 --> 00:12:44,490
log in is Remote Desktop Services these

368
00:12:42,780 --> 00:12:46,020
applications published you click on it

369
00:12:44,490 --> 00:12:48,840
and nothing happens

370
00:12:46,020 --> 00:12:50,340
right and the reason why nothing happens

371
00:12:48,840 --> 00:12:51,900
is because somewhere a user just got a

372
00:12:50,340 --> 00:12:53,520
notification saying hey we're trying to

373
00:12:51,900 --> 00:12:55,620
log into ba-ba-ba-ba-ba-ba-ba-ba-ba

374
00:12:53,520 --> 00:12:56,430
right and it's a sinking feeling for the

375
00:12:55,620 --> 00:12:57,720
attacker because it means that

376
00:12:56,430 --> 00:13:01,800
differently in court on that victor and

377
00:12:57,720 --> 00:13:03,480
those those things mean been right so

378
00:13:01,800 --> 00:13:05,040
Creed's often become useless right if

379
00:13:03,480 --> 00:13:06,120
you manage to fish credentials or you

380
00:13:05,040 --> 00:13:08,069
grab credentials and you identify

381
00:13:06,120 --> 00:13:10,170
credential reuse that of say like you

382
00:13:08,070 --> 00:13:12,240
know other slight compromises leaked

383
00:13:10,170 --> 00:13:14,130
database and stuff like that or even

384
00:13:12,240 --> 00:13:16,620
just being of a guess credentials right

385
00:13:14,130 --> 00:13:21,000
like you know went to 2017 still good

386
00:13:16,620 --> 00:13:22,920
most of the time you know they become

387
00:13:21,000 --> 00:13:23,490
useless they don't they are not a useful

388
00:13:22,920 --> 00:13:25,229
victim

389
00:13:23,490 --> 00:13:27,510
got the Croods but owning stuff becomes

390
00:13:25,230 --> 00:13:29,940
a lot harder right now sure why maybe we

391
00:13:27,510 --> 00:13:31,649
can reach strategize on how we're going

392
00:13:29,940 --> 00:13:33,690
to send a payload maybe we can go on

393
00:13:31,649 --> 00:13:34,890
site and try to plug into an e reporter

394
00:13:33,690 --> 00:13:37,980
we've got the main credentials at that

395
00:13:34,890 --> 00:13:39,449
point but really it becomes layers of

396
00:13:37,980 --> 00:13:40,500
frustration right and that's what we're

397
00:13:39,450 --> 00:13:41,910
after here because anytime we're

398
00:13:40,500 --> 00:13:46,830
frustrated you've increased the cost

399
00:13:41,910 --> 00:13:48,390
right strategy I'm too restricting

400
00:13:46,830 --> 00:13:50,970
operating environments so one of the

401
00:13:48,390 --> 00:13:52,319
things that once you've got credentials

402
00:13:50,970 --> 00:13:55,830
or even if you manage to sort of

403
00:13:52,320 --> 00:13:57,000
successfully fish with a docx or any K X

404
00:13:55,830 --> 00:13:59,630
or whatever for example you're on a

405
00:13:57,000 --> 00:14:03,029
laptop or inside the target environment

406
00:13:59,630 --> 00:14:04,920
right quite often there's absolutely no

407
00:14:03,029 --> 00:14:07,290
controls that are actually effective

408
00:14:04,920 --> 00:14:08,339
right like you know what one of it and

409
00:14:07,290 --> 00:14:10,410
when we say operating environment we

410
00:14:08,339 --> 00:14:12,300
don't just mean the laptop I mean it may

411
00:14:10,410 --> 00:14:14,100
be the video I if you're talking about

412
00:14:12,300 --> 00:14:15,479
applications and maybe the way that the

413
00:14:14,100 --> 00:14:16,800
web application sort of structured to

414
00:14:15,480 --> 00:14:19,140
presume the data back to the user and

415
00:14:16,800 --> 00:14:21,300
stuff like that but really what you want

416
00:14:19,140 --> 00:14:23,189
to do is you want to restrict execution

417
00:14:21,300 --> 00:14:24,209
right like any and all and we talked

418
00:14:23,190 --> 00:14:26,580
about AV and we talked about

419
00:14:24,209 --> 00:14:28,380
whitelisting and like you know I guess

420
00:14:26,580 --> 00:14:29,820
having a V's good if like you know I'm

421
00:14:28,380 --> 00:14:34,589
sure whatever so disagrees with us on

422
00:14:29,820 --> 00:14:36,120
that but the idea that you can restrict

423
00:14:34,589 --> 00:14:37,620
the operating environment right you want

424
00:14:36,120 --> 00:14:41,459
to lock me down right make a lateral

425
00:14:37,620 --> 00:14:43,350
movement more difficult it's a great way

426
00:14:41,459 --> 00:14:46,349
to bottleneck the attacker right so for

427
00:14:43,350 --> 00:14:47,820
example if it is a video environment for

428
00:14:46,350 --> 00:14:50,279
example you can put the controls and

429
00:14:47,820 --> 00:14:51,779
behind the background right so you may

430
00:14:50,279 --> 00:14:53,250
be on a desktop but what's actually

431
00:14:51,779 --> 00:14:54,149
happening in background what monitoring

432
00:14:53,250 --> 00:14:55,560
is happening in the background is

433
00:14:54,149 --> 00:14:56,910
they're anomaly might be happening at

434
00:14:55,560 --> 00:14:58,140
background is there traffic monitoring

435
00:14:56,910 --> 00:15:01,170
happen in the background there's their

436
00:14:58,140 --> 00:15:02,730
you know memory scanning file rights I'm

437
00:15:01,170 --> 00:15:05,189
going to the stand and that's the stuff

438
00:15:02,730 --> 00:15:07,140
right so anytime you can restrict the

439
00:15:05,190 --> 00:15:09,000
operating environment and cubes switches

440
00:15:07,140 --> 00:15:10,529
and the Petra is a great example of us

441
00:15:09,000 --> 00:15:11,250
means that you're gonna win and I mean

442
00:15:10,529 --> 00:15:13,410
if you're looking at something like

443
00:15:11,250 --> 00:15:15,209
windows like if you're looking at like

444
00:15:13,410 --> 00:15:16,589
you know device guard and and sort of

445
00:15:15,209 --> 00:15:18,089
various other technologies they're

446
00:15:16,589 --> 00:15:19,620
coming in at a Windows level it's

447
00:15:18,089 --> 00:15:22,380
getting pretty good but the idea is is

448
00:15:19,620 --> 00:15:25,079
that you want to restrict it the other

449
00:15:22,380 --> 00:15:27,480
thing that we sort of see a couple of

450
00:15:25,079 --> 00:15:28,620
times as we've seen a policy where the

451
00:15:27,480 --> 00:15:30,600
concept of privileged access

452
00:15:28,620 --> 00:15:32,640
workstations right pause right so that's

453
00:15:30,600 --> 00:15:34,199
where your domain admins have a separate

454
00:15:32,640 --> 00:15:36,150
workstation build and a separate

455
00:15:34,199 --> 00:15:36,959
environment for doing sensitive tasks

456
00:15:36,150 --> 00:15:38,220
there

457
00:15:36,960 --> 00:15:39,870
can be really frustrating because they

458
00:15:38,220 --> 00:15:41,400
may usually have a policy if we can't be

459
00:15:39,870 --> 00:15:43,590
bothered logging into that other sort of

460
00:15:41,400 --> 00:15:44,730
vdi of the user and and checking it out

461
00:15:43,590 --> 00:15:46,620
so we're just going to rebuild that

462
00:15:44,730 --> 00:15:47,970
video right so you can end up in

463
00:15:46,620 --> 00:15:50,190
positions for example where you've

464
00:15:47,970 --> 00:15:51,600
managed to compromise an endpoint and

465
00:15:50,190 --> 00:15:53,130
you may be rummaging in memory for those

466
00:15:51,600 --> 00:15:54,870
credentials that we love and we want to

467
00:15:53,130 --> 00:15:56,880
be able to use and you find that

468
00:15:54,870 --> 00:15:58,170
actually no administrator has logged in

469
00:15:56,880 --> 00:15:59,730
to this video I know when hovered and

470
00:15:58,170 --> 00:16:00,750
this user has logged into this video and

471
00:15:59,730 --> 00:16:03,630
there's no credentials cached in memory

472
00:16:00,750 --> 00:16:05,460
to sort of go onwards from there so you

473
00:16:03,630 --> 00:16:08,189
can do a lot of work when you lock down

474
00:16:05,460 --> 00:16:11,160
the operating environment for especially

475
00:16:08,190 --> 00:16:12,570
for your admins where you know either

476
00:16:11,160 --> 00:16:14,640
getting credentials will mean figuring

477
00:16:12,570 --> 00:16:16,050
out how to move on next and sure if we

478
00:16:14,640 --> 00:16:17,189
look at application whitelisting for

479
00:16:16,050 --> 00:16:18,780
example if you look at something like

480
00:16:17,190 --> 00:16:20,610
app Locker for example like there are

481
00:16:18,780 --> 00:16:22,290
bypasses right these magnitudes of

482
00:16:20,610 --> 00:16:23,670
bypasses but here's the thing quite

483
00:16:22,290 --> 00:16:24,839
often when you're dropping a payload and

484
00:16:23,670 --> 00:16:27,479
you're ending up on an environment

485
00:16:24,840 --> 00:16:29,940
you're doing it blind right not all

486
00:16:27,480 --> 00:16:32,250
bypasses are generic right not all

487
00:16:29,940 --> 00:16:34,530
bypasses apply to the same environments

488
00:16:32,250 --> 00:16:36,240
across different customers so working

489
00:16:34,530 --> 00:16:38,160
out stuff blind can be frustrating and

490
00:16:36,240 --> 00:16:40,260
increases cost right also increases the

491
00:16:38,160 --> 00:16:43,199
customer for likelihood of mistakes and

492
00:16:40,260 --> 00:16:46,740
therefore increases the likelihood of

493
00:16:43,200 --> 00:16:50,160
detection so when you restrict operating

494
00:16:46,740 --> 00:16:52,350
environments your innocent re here sort

495
00:16:50,160 --> 00:16:53,910
of it's just frustrating right if you

496
00:16:52,350 --> 00:16:55,260
can't actually execute the tasks that

497
00:16:53,910 --> 00:16:56,219
you want to do to move laterally on

498
00:16:55,260 --> 00:17:03,450
target

499
00:16:56,220 --> 00:17:06,329
it just really destroys it strategy

500
00:17:03,450 --> 00:17:07,880
number three who can name the guy on

501
00:17:06,329 --> 00:17:12,679
this slide

502
00:17:07,880 --> 00:17:15,450
Rob Joyce good cool who's seen this talk

503
00:17:12,680 --> 00:17:17,220
half-a-dozen hands maybe if you haven't

504
00:17:15,450 --> 00:17:20,610
seen Rob Joyce's talk from enigma last

505
00:17:17,220 --> 00:17:23,760
year go watch it Rob was the head of

506
00:17:20,609 --> 00:17:25,829
tailored access operations for the NSA

507
00:17:23,760 --> 00:17:28,230
and he showed up in the nygma which was

508
00:17:25,829 --> 00:17:29,669
kind of strange and he gave a talk about

509
00:17:28,230 --> 00:17:32,130
how nation-states are going to target

510
00:17:29,670 --> 00:17:33,930
you right and what was really pleasing

511
00:17:32,130 --> 00:17:35,280
about this talk is it aligns greatly

512
00:17:33,930 --> 00:17:36,750
with our the way that we operated

513
00:17:35,280 --> 00:17:39,889
insomnia right so I was like felt

514
00:17:36,750 --> 00:17:43,560
justified I was like yeah if indicated

515
00:17:39,890 --> 00:17:45,390
but it was as a talk that was kind of

516
00:17:43,560 --> 00:17:46,860
seen as flaky it was a talk that was

517
00:17:45,390 --> 00:17:48,720
kind of seen as like well you know he

518
00:17:46,860 --> 00:17:50,760
advocated using AV and we all know that

519
00:17:48,720 --> 00:17:52,950
they have

520
00:17:50,760 --> 00:17:54,770
but he had a really interesting point

521
00:17:52,950 --> 00:17:56,490
right and his point was

522
00:17:54,770 --> 00:17:58,500
attackers are going to know your

523
00:17:56,490 --> 00:18:00,750
environment as good as if not better

524
00:17:58,500 --> 00:18:02,400
than you right

525
00:18:00,750 --> 00:18:04,050
they're going to take the time to know

526
00:18:02,400 --> 00:18:05,910
the environment as good as if not better

527
00:18:04,050 --> 00:18:08,010
than you they know how you manage your

528
00:18:05,910 --> 00:18:10,290
environment right and this doesn't just

529
00:18:08,010 --> 00:18:11,940
apply to nation-state right if you look

530
00:18:10,290 --> 00:18:14,010
at the Swift banking hacks that occurred

531
00:18:11,940 --> 00:18:16,290
recently there was a reconnaissance

532
00:18:14,010 --> 00:18:19,110
phase where they set in there and they

533
00:18:16,290 --> 00:18:21,240
monitored how do you do your job which

534
00:18:19,110 --> 00:18:23,750
systems do you do your job on how do you

535
00:18:21,240 --> 00:18:28,460
go about it where is it locked right and

536
00:18:23,750 --> 00:18:31,560
it's the same for a lot of the more I

537
00:18:28,460 --> 00:18:33,300
guess financial like CFO have you seen

538
00:18:31,560 --> 00:18:34,649
the CFO fraud where email accounts are

539
00:18:33,300 --> 00:18:36,149
being compromised and you go away and

540
00:18:34,650 --> 00:18:37,920
you send off an invoice man in the

541
00:18:36,150 --> 00:18:39,570
middle of supplier they're taking the

542
00:18:37,920 --> 00:18:41,610
time to understand what is the process

543
00:18:39,570 --> 00:18:43,139
how does the business work where are the

544
00:18:41,610 --> 00:18:44,370
systems who manages those systems so

545
00:18:43,140 --> 00:18:46,290
he's responsible for them what are the

546
00:18:44,370 --> 00:18:48,239
users what are the users groups what are

547
00:18:46,290 --> 00:18:51,540
those users work and they go through

548
00:18:48,240 --> 00:18:54,480
their process right and so shadow IT is

549
00:18:51,540 --> 00:18:56,700
the buzzword right but the reality is is

550
00:18:54,480 --> 00:18:58,380
that it's getting people owned and it's

551
00:18:56,700 --> 00:19:00,570
getting people owned hard right and the

552
00:18:58,380 --> 00:19:02,910
reason is it's quite often easier to

553
00:19:00,570 --> 00:19:04,200
spot anomaly systems right like if you

554
00:19:02,910 --> 00:19:05,850
look at an environment and it's all

555
00:19:04,200 --> 00:19:07,560
standard build standard configured

556
00:19:05,850 --> 00:19:09,330
standard security controls there's like

557
00:19:07,560 --> 00:19:13,110
everything's in place and then all of a

558
00:19:09,330 --> 00:19:14,250
sudden this is one system right and it's

559
00:19:13,110 --> 00:19:16,080
out there and you look at it and it

560
00:19:14,250 --> 00:19:18,240
hasn't been patched or it's kind of like

561
00:19:16,080 --> 00:19:20,399
got no no sort of restrictions on it so

562
00:19:18,240 --> 00:19:21,720
I'm the domain if you're looking at

563
00:19:20,400 --> 00:19:23,160
cloud right for example the amount of

564
00:19:21,720 --> 00:19:24,540
times you can look at organization and

565
00:19:23,160 --> 00:19:26,880
I've got everything locked down they've

566
00:19:24,540 --> 00:19:28,470
got office 365 it's just sweet for the

567
00:19:26,880 --> 00:19:30,870
users and he mixes going through there

568
00:19:28,470 --> 00:19:32,130
they've got their own prem vp end and

569
00:19:30,870 --> 00:19:34,199
then all of a sudden you find like you

570
00:19:32,130 --> 00:19:35,580
know and i'll tasty Endura instance or

571
00:19:34,200 --> 00:19:37,350
saying that's just randomly up there

572
00:19:35,580 --> 00:19:38,760
that's got no - if a oh no that's got

573
00:19:37,350 --> 00:19:41,070
like credentials that can be reused and

574
00:19:38,760 --> 00:19:42,600
- and quite often when we go back to the

575
00:19:41,070 --> 00:19:44,850
organisation and talk to them away uh

576
00:19:42,600 --> 00:19:46,409
yeah we kind of knew about that box it

577
00:19:44,850 --> 00:19:47,550
was just like a vendor environment it's

578
00:19:46,410 --> 00:19:48,720
not really our problem and it's like

579
00:19:47,550 --> 00:19:51,570
well it is because it's on your domain

580
00:19:48,720 --> 00:19:52,650
right we designed it or they go oh yeah

581
00:19:51,570 --> 00:19:54,300
we didn't actually know that your

582
00:19:52,650 --> 00:19:55,680
instance was in use right up in the

583
00:19:54,300 --> 00:19:56,940
cloud and it's like because someone just

584
00:19:55,680 --> 00:19:59,730
went and got a manager's credit card

585
00:19:56,940 --> 00:20:01,500
after being told no right I got my

586
00:19:59,730 --> 00:20:04,320
managers critic card logged and signed

587
00:20:01,500 --> 00:20:06,450
up a new Juran's that's right so

588
00:20:04,320 --> 00:20:08,100
one of the biggest capability guests we

589
00:20:06,450 --> 00:20:10,140
see is that people don't know their

590
00:20:08,100 --> 00:20:12,300
environment or they don't want to know

591
00:20:10,140 --> 00:20:13,800
their environment right and the thing is

592
00:20:12,300 --> 00:20:14,909
attackers will know your environment and

593
00:20:13,800 --> 00:20:16,470
they will find the weaknesses and

594
00:20:14,910 --> 00:20:18,240
exploit it and they really understand

595
00:20:16,470 --> 00:20:20,280
trust relationships right the amount of

596
00:20:18,240 --> 00:20:24,620
times that we move from cloud into

597
00:20:20,280 --> 00:20:27,360
on-prem right is pretty decent and

598
00:20:24,620 --> 00:20:28,979
customers are always surprised right

599
00:20:27,360 --> 00:20:30,659
because it's up in the cloud it's not

600
00:20:28,980 --> 00:20:32,400
it's not on our premium it's up there

601
00:20:30,660 --> 00:20:34,050
but there's a trust relationship right

602
00:20:32,400 --> 00:20:37,410
in the case of Active Directory or maybe

603
00:20:34,050 --> 00:20:38,610
a forest relationship back up to zero in

604
00:20:37,410 --> 00:20:40,590
the case of something way you know

605
00:20:38,610 --> 00:20:41,969
Google services that maybe that drivers

606
00:20:40,590 --> 00:20:43,830
in use and they're syncing files down

607
00:20:41,970 --> 00:20:46,440
onto the file system right in the

608
00:20:43,830 --> 00:20:47,970
opening Word documents and a miss word

609
00:20:46,440 --> 00:20:50,190
on the file system from a trusted source

610
00:20:47,970 --> 00:20:53,850
as far as that concerned right so there

611
00:20:50,190 --> 00:20:56,220
is avenues to come back in so one of the

612
00:20:53,850 --> 00:21:01,320
things about saying yes is that you get

613
00:20:56,220 --> 00:21:03,750
to enforce your controls right so a

614
00:21:01,320 --> 00:21:06,780
great example of us was a little while

615
00:21:03,750 --> 00:21:08,610
ago I was doing a routine and during the

616
00:21:06,780 --> 00:21:11,100
routine we noticed that they had adopted

617
00:21:08,610 --> 00:21:12,510
a cloud storage service and we were like

618
00:21:11,100 --> 00:21:13,590
rubbing our hands because we're like

619
00:21:12,510 --> 00:21:14,640
yeah we're gonna get creates we're gonna

620
00:21:13,590 --> 00:21:16,889
pop into the air we're gonna own

621
00:21:14,640 --> 00:21:18,120
everything and we got crates and we

622
00:21:16,890 --> 00:21:19,650
popped into it and we could see all the

623
00:21:18,120 --> 00:21:21,689
files right and we started download in

624
00:21:19,650 --> 00:21:22,980
the morning going through and during the

625
00:21:21,690 --> 00:21:24,570
debrief afterwards were talking to them

626
00:21:22,980 --> 00:21:26,040
and they kind of had seen it right

627
00:21:24,570 --> 00:21:27,360
because one of the things they had gone

628
00:21:26,040 --> 00:21:29,340
through is they had leveraged the

629
00:21:27,360 --> 00:21:30,959
backend api's of the service to monitor

630
00:21:29,340 --> 00:21:32,550
where file downloads were coming from we

631
00:21:30,960 --> 00:21:36,690
were geographical organs working from

632
00:21:32,550 --> 00:21:41,010
where anomalous amount of volume of the

633
00:21:36,690 --> 00:21:42,420
downloads were going to and when we were

634
00:21:41,010 --> 00:21:44,910
on the internal network and we were

635
00:21:42,420 --> 00:21:48,690
stealing files the front of SMB shares

636
00:21:44,910 --> 00:21:49,740
they had no visibility of that right so

637
00:21:48,690 --> 00:21:51,600
they're actually in a better position

638
00:21:49,740 --> 00:21:52,890
because they decided to say yes because

639
00:21:51,600 --> 00:21:54,929
the business was asking for our

640
00:21:52,890 --> 00:21:56,370
customers were asking for it and to be

641
00:21:54,930 --> 00:21:57,630
able to share data and so what they did

642
00:21:56,370 --> 00:21:59,219
was when they said yes they actually

643
00:21:57,630 --> 00:22:01,050
went right what are the controls we can

644
00:21:59,220 --> 00:22:04,890
put in here and it's a classic example

645
00:22:01,050 --> 00:22:08,909
of where then modern technology controls

646
00:22:04,890 --> 00:22:10,890
can actually mean bit of visibility and

647
00:22:08,910 --> 00:22:12,720
bit a bit of restrictions on your data

648
00:22:10,890 --> 00:22:16,130
and your users than your traditional

649
00:22:12,720 --> 00:22:17,840
sort of enterprise network right

650
00:22:16,130 --> 00:22:18,860
and you also get to gain insight into

651
00:22:17,840 --> 00:22:20,959
what's happening in your environment

652
00:22:18,860 --> 00:22:22,340
right live especially with account life

653
00:22:20,960 --> 00:22:23,690
cycles like the amount of times that you

654
00:22:22,340 --> 00:22:25,189
look at an organization and they've got

655
00:22:23,690 --> 00:22:27,260
like you know Active Directory they've

656
00:22:25,190 --> 00:22:29,660
got like six thousand users or whatever

657
00:22:27,260 --> 00:22:31,340
and they had the stringent audit policy

658
00:22:29,660 --> 00:22:32,809
once a month someone's going through a

659
00:22:31,340 --> 00:22:34,850
matching Excel spreadsheets to what's

660
00:22:32,809 --> 00:22:36,980
actually an ad right and they're going

661
00:22:34,850 --> 00:22:40,610
through hardcore and then you find like

662
00:22:36,980 --> 00:22:43,850
you know the admin for that random box Y

663
00:22:40,610 --> 00:22:46,219
password is password right and that

664
00:22:43,850 --> 00:22:47,809
happens right it's because they're not

665
00:22:46,220 --> 00:22:50,030
understanding like what is the trust

666
00:22:47,809 --> 00:22:51,440
relationships where do they set and and

667
00:22:50,030 --> 00:22:53,120
keeping in control on it and everyone

668
00:22:51,440 --> 00:22:54,830
always comes back to me and say yes but

669
00:22:53,120 --> 00:22:56,030
pipes the vendor said in the SLA that

670
00:22:54,830 --> 00:22:58,159
they have to put the Box in we're not

671
00:22:56,030 --> 00:22:59,480
allowed to touch it right it's like fine

672
00:22:58,160 --> 00:23:01,400
figure out a way to get more visibility

673
00:22:59,480 --> 00:23:03,020
on that box figure out a way to get more

674
00:23:01,400 --> 00:23:04,880
visibility on the network that's going

675
00:23:03,020 --> 00:23:07,580
to that box right figure out a way that

676
00:23:04,880 --> 00:23:09,200
you can actually if you can't control it

677
00:23:07,580 --> 00:23:12,919
you can actually see what's going on as

678
00:23:09,200 --> 00:23:14,570
much as possible there right moving on

679
00:23:12,920 --> 00:23:18,290
quickly strategy number four distributed

680
00:23:14,570 --> 00:23:23,360
a living this is the newer one and one

681
00:23:18,290 --> 00:23:24,559
of my favorite ones so the idea that you

682
00:23:23,360 --> 00:23:26,678
know and one of the things that when it

683
00:23:24,559 --> 00:23:29,899
comes across incidents especially from

684
00:23:26,679 --> 00:23:31,940
modern incidences like it's very really

685
00:23:29,900 --> 00:23:34,850
the security operations into rings up

686
00:23:31,940 --> 00:23:37,730
and say hey we saw bus right it's a user

687
00:23:34,850 --> 00:23:38,928
saying my box does blue screen right and

688
00:23:37,730 --> 00:23:42,830
it's me sitting there going we do my

689
00:23:38,929 --> 00:23:45,650
shell go right or it's like you know

690
00:23:42,830 --> 00:23:47,629
it's anomalous stuff like users know how

691
00:23:45,650 --> 00:23:48,860
they use their systems they know what

692
00:23:47,630 --> 00:23:50,150
their day job looks like they know

693
00:23:48,860 --> 00:23:55,370
what's normal they know when it's not

694
00:23:50,150 --> 00:23:56,870
right you can monitor sort of help these

695
00:23:55,370 --> 00:23:58,939
tickets and really understand people

696
00:23:56,870 --> 00:24:00,379
that I've had why lots and lots of

697
00:23:58,940 --> 00:24:01,940
problems and then like you can look at

698
00:24:00,380 --> 00:24:03,410
it and say well actually what's the root

699
00:24:01,940 --> 00:24:05,660
cause here and this was a great example

700
00:24:03,410 --> 00:24:07,700
of us was the White House chief of staff

701
00:24:05,660 --> 00:24:09,590
recently right took his Android into the

702
00:24:07,700 --> 00:24:11,059
White House Sporty's can see I can't

703
00:24:09,590 --> 00:24:12,409
update to the latest version and I like

704
00:24:11,059 --> 00:24:14,090
this because Russia's been on this phone

705
00:24:12,410 --> 00:24:19,309
for the last three years right like and

706
00:24:14,090 --> 00:24:20,928
it's like that sort of you know people

707
00:24:19,309 --> 00:24:22,129
understanding how they do their job and

708
00:24:20,929 --> 00:24:23,420
the tools they use it's actually a

709
00:24:22,130 --> 00:24:26,240
really useful

710
00:24:23,420 --> 00:24:27,530
alerting mechanism right a really great

711
00:24:26,240 --> 00:24:29,010
example of this and there's a really

712
00:24:27,530 --> 00:24:31,040
good blog post too it was

713
00:24:29,010 --> 00:24:33,660
Ryan Hoover and the team at slack

714
00:24:31,040 --> 00:24:36,210
basically haven't pointed at for say SSH

715
00:24:33,660 --> 00:24:38,460
logins right and the idea is is that if

716
00:24:36,210 --> 00:24:40,679
the user logs into a privileged system

717
00:24:38,460 --> 00:24:42,570
over SSH or whatever they get a flake

718
00:24:40,679 --> 00:24:44,700
notification saying hey you just logged

719
00:24:42,570 --> 00:24:47,399
into the server was it you useful no and

720
00:24:44,700 --> 00:24:49,559
if you had no incidents raised right

721
00:24:47,400 --> 00:24:51,210
because it means that someone somehow I

722
00:24:49,559 --> 00:24:57,960
was managed to authenticate as you on to

723
00:24:51,210 --> 00:24:59,370
a sensitive server right and I actually

724
00:24:57,960 --> 00:25:00,840
emailed Ryan because late they dropped

725
00:24:59,370 --> 00:25:02,370
this blog post this if we've inflated

726
00:25:00,840 --> 00:25:03,809
this amazing distributed system we've

727
00:25:02,370 --> 00:25:05,850
got crowded leading going on yada yada

728
00:25:03,809 --> 00:25:07,410
yada and I said to him like how's it

729
00:25:05,850 --> 00:25:09,870
working for you right as I was including

730
00:25:07,410 --> 00:25:11,220
my own version of it I said why it can't

731
00:25:09,870 --> 00:25:12,689
give you specific numbers but at the

732
00:25:11,220 --> 00:25:15,450
moment we're probably responding to less

733
00:25:12,690 --> 00:25:17,490
than 10% of requests right so they were

734
00:25:15,450 --> 00:25:19,230
the the signal-to-noise had gone down

735
00:25:17,490 --> 00:25:20,850
for them they were getting when they got

736
00:25:19,230 --> 00:25:22,890
notified saying no actually I did not

737
00:25:20,850 --> 00:25:24,840
log into that server right they can take

738
00:25:22,890 --> 00:25:27,540
it seriously because the user knows what

739
00:25:24,840 --> 00:25:29,189
they're doing right go back to mod

740
00:25:27,540 --> 00:25:31,559
effect or authentication there's nothing

741
00:25:29,190 --> 00:25:33,240
worse than as I said as an attacker of

742
00:25:31,559 --> 00:25:34,230
you cooked something or you've done

743
00:25:33,240 --> 00:25:35,400
something and nothing's happening

744
00:25:34,230 --> 00:25:36,690
because you know these are prompt on

745
00:25:35,400 --> 00:25:38,669
someone's phone at 11 o'clock at night

746
00:25:36,690 --> 00:25:39,990
and then about 10 minutes later the

747
00:25:38,669 --> 00:25:48,720
security managers ringing you laughing

748
00:25:39,990 --> 00:25:49,830
right and caught you so this case you're

749
00:25:48,720 --> 00:25:52,049
gonna catch up and you're going to catch

750
00:25:49,830 --> 00:25:53,689
us pretty quickly right like it's it's

751
00:25:52,049 --> 00:25:55,830
it's a really effective mechanism

752
00:25:53,690 --> 00:25:57,330
whereas case we've got to have to move

753
00:25:55,830 --> 00:25:58,830
slower right because they'd say we've

754
00:25:57,330 --> 00:26:00,809
been caught once all of a sudden we know

755
00:25:58,830 --> 00:26:02,760
well any action I take as an assumed

756
00:26:00,809 --> 00:26:04,230
role of this user because that's what we

757
00:26:02,760 --> 00:26:06,690
do we get crits and own stuff as those

758
00:26:04,230 --> 00:26:07,980
users is gonna be noticed right and

759
00:26:06,690 --> 00:26:09,179
we're going to have to tread lightly how

760
00:26:07,980 --> 00:26:11,040
are we going to go about this we have to

761
00:26:09,179 --> 00:26:12,540
now go through and say well rather than

762
00:26:11,040 --> 00:26:14,220
just easy searching what are we paying

763
00:26:12,540 --> 00:26:15,720
to the server I'm going to have decision

764
00:26:14,220 --> 00:26:17,100
right on an existing session that the

765
00:26:15,720 --> 00:26:18,780
users authenticated thrown out to go

766
00:26:17,100 --> 00:26:21,090
through that process right and that is

767
00:26:18,780 --> 00:26:25,710
achievable and we can do it but it

768
00:26:21,090 --> 00:26:27,240
increases costs right restricting

769
00:26:25,710 --> 00:26:28,620
privilege so this is different than

770
00:26:27,240 --> 00:26:32,640
restricting operating environments so

771
00:26:28,620 --> 00:26:33,989
how many people here have domain admins

772
00:26:32,640 --> 00:26:36,230
that have low privilege and high

773
00:26:33,990 --> 00:26:38,760
privilege accounts

774
00:26:36,230 --> 00:26:42,169
yeah how many your admins reuse

775
00:26:38,760 --> 00:26:42,169
passwords across those accounts

776
00:26:43,080 --> 00:26:50,790
it's about 30% in our experience right

777
00:26:46,230 --> 00:26:52,770
and again why we love to talk about how

778
00:26:50,790 --> 00:26:54,510
much we hoard it's tough but how are you

779
00:26:52,770 --> 00:26:55,950
auditing the right things right I could

780
00:26:54,510 --> 00:26:58,020
take us have tools now like bloodhound

781
00:26:55,950 --> 00:26:59,760
if you haven't seen bloodhound it means

782
00:26:58,020 --> 00:27:02,010
that I can figure out where I landed on

783
00:26:59,760 --> 00:27:04,230
your network what credentials I have why

784
00:27:02,010 --> 00:27:05,700
I have where the users I'm interested

785
00:27:04,230 --> 00:27:07,380
are we're the groups that I'm interested

786
00:27:05,700 --> 00:27:09,210
are and we're the systems they are

787
00:27:07,380 --> 00:27:10,950
logged into and various other paths that

788
00:27:09,210 --> 00:27:15,450
I can take visualized in front of me

789
00:27:10,950 --> 00:27:17,790
right and so it means that you know we

790
00:27:15,450 --> 00:27:19,260
can understand it comes back to what Rob

791
00:27:17,790 --> 00:27:20,399
was saying we will take the time to

792
00:27:19,260 --> 00:27:21,629
understand your environment as good as

793
00:27:20,400 --> 00:27:22,680
it's not better than you right the first

794
00:27:21,630 --> 00:27:24,390
thing in the tech will do when they get

795
00:27:22,680 --> 00:27:26,010
onto a box is desync down your ID and

796
00:27:24,390 --> 00:27:28,200
then go through it and look at it right

797
00:27:26,010 --> 00:27:31,560
who is important who is the domain admin

798
00:27:28,200 --> 00:27:33,390
who manages finance right what groups

799
00:27:31,560 --> 00:27:34,409
are they as their vendor contracts who

800
00:27:33,390 --> 00:27:35,550
are the vendors what are the event

801
00:27:34,410 --> 00:27:36,660
accounts look like are they service

802
00:27:35,550 --> 00:27:38,040
accounts what are the service accounts

803
00:27:36,660 --> 00:27:39,840
look like what groups have privilege

804
00:27:38,040 --> 00:27:41,280
like we are they right because we're

805
00:27:39,840 --> 00:27:45,300
acting on a goal we have a target in

806
00:27:41,280 --> 00:27:47,070
mind we want to get to so being able to

807
00:27:45,300 --> 00:27:48,450
go through that is kind of important so

808
00:27:47,070 --> 00:27:50,490
one of the things we know about

809
00:27:48,450 --> 00:27:52,440
credentials is that they will always get

810
00:27:50,490 --> 00:27:55,140
stolen right and one of the things we

811
00:27:52,440 --> 00:27:56,040
know that password management is that

812
00:27:55,140 --> 00:27:57,690
we're terrible at it

813
00:27:56,040 --> 00:27:59,940
even the best are terrible at it right

814
00:27:57,690 --> 00:28:01,170
we're just not good at it right which is

815
00:27:59,940 --> 00:28:03,000
why we're seeing this increase in

816
00:28:01,170 --> 00:28:04,650
strategies for the the defense side

817
00:28:03,000 --> 00:28:06,330
where we can do stuff like and femoral

818
00:28:04,650 --> 00:28:08,970
access controls right like just-in-time

819
00:28:06,330 --> 00:28:11,250
access right like I need privileged

820
00:28:08,970 --> 00:28:13,200
access to conduct this task inside this

821
00:28:11,250 --> 00:28:15,090
environment and maybe a secondary

822
00:28:13,200 --> 00:28:17,090
approval occurs or maybe that approval

823
00:28:15,090 --> 00:28:19,260
occurs for just particular time window

824
00:28:17,090 --> 00:28:21,510
bliss is a great example of us from

825
00:28:19,260 --> 00:28:23,370
Netflix they open sourced it where like

826
00:28:21,510 --> 00:28:25,410
you know effectively every SSH session

827
00:28:23,370 --> 00:28:25,979
as a custom SSH key that's been assigned

828
00:28:25,410 --> 00:28:28,140
to the user

829
00:28:25,980 --> 00:28:30,360
keys revoked afterwards even if I

830
00:28:28,140 --> 00:28:32,550
managed to steal the key from the users

831
00:28:30,360 --> 00:28:34,050
workstation it's not reusable back into

832
00:28:32,550 --> 00:28:35,730
their system without some other sort of

833
00:28:34,050 --> 00:28:39,060
authorization process occurring in the

834
00:28:35,730 --> 00:28:42,810
background right and identity where

835
00:28:39,060 --> 00:28:44,429
access controls they think about ID

836
00:28:42,810 --> 00:28:46,440
anywhere access controls us you go okay

837
00:28:44,430 --> 00:28:47,940
well this is where fun logged into a

838
00:28:46,440 --> 00:28:50,310
particular workstation the network

839
00:28:47,940 --> 00:28:53,880
access controls presented to me for that

840
00:28:50,310 --> 00:28:55,230
ad users group right and they can be

841
00:28:53,880 --> 00:28:56,669
really frustrating right

842
00:28:55,230 --> 00:28:58,500
because all of a sudden if I'm inside an

843
00:28:56,669 --> 00:29:00,120
environment I can no longer RDP straight

844
00:28:58,500 --> 00:29:01,710
from the video to the domain controller

845
00:29:00,120 --> 00:29:03,870
for example or the laptop to the main

846
00:29:01,710 --> 00:29:05,190
controller so I have to go where's the

847
00:29:03,870 --> 00:29:06,600
domain admin and I have to fire up

848
00:29:05,190 --> 00:29:07,860
bloodhound to go hunting for the domain

849
00:29:06,600 --> 00:29:09,389
admin and then find out they're on a

850
00:29:07,860 --> 00:29:10,740
privileged access workstation and

851
00:29:09,390 --> 00:29:12,030
they're not on Windows 7 with no

852
00:29:10,740 --> 00:29:13,410
controls they're actually on the latest

853
00:29:12,030 --> 00:29:14,160
Windows 10 build with lots of controls

854
00:29:13,410 --> 00:29:17,700
and they've got multi-factor

855
00:29:14,160 --> 00:29:20,929
authentication and and then you find out

856
00:29:17,700 --> 00:29:22,919
they were use the password anyway but

857
00:29:20,929 --> 00:29:24,870
the point is it increases the

858
00:29:22,919 --> 00:29:27,720
frustration increases the cost right and

859
00:29:24,870 --> 00:29:29,189
it's some of them can be easy ones right

860
00:29:27,720 --> 00:29:30,990
one of the things about all of these

861
00:29:29,190 --> 00:29:33,179
strategies is that a lot of people go

862
00:29:30,990 --> 00:29:35,340
well pipes like you know we're a small

863
00:29:33,179 --> 00:29:37,950
organization we have 30,000 users and

864
00:29:35,340 --> 00:29:39,510
for admins and it's like well wait you

865
00:29:37,950 --> 00:29:41,280
can get these ones right you can't put

866
00:29:39,510 --> 00:29:44,309
them in I mean Darren's sitting here

867
00:29:41,280 --> 00:29:46,049
going beyond Corp and it's like yes it's

868
00:29:44,309 --> 00:29:48,059
nice if you're at Google scale like if

869
00:29:46,049 --> 00:29:50,460
you have resources I mean but like you

870
00:29:48,059 --> 00:29:51,889
know the strategies will increase preach

871
00:29:50,460 --> 00:29:54,510
the gospel

872
00:29:51,890 --> 00:29:55,110
so again figuring out where to go gets

873
00:29:54,510 --> 00:29:56,820
complicated

874
00:29:55,110 --> 00:29:58,080
impersonation becomes harder right

875
00:29:56,820 --> 00:29:59,790
because that's effectively what we like

876
00:29:58,080 --> 00:30:01,350
to do is attack is as a pure impersonate

877
00:29:59,790 --> 00:30:03,480
people and assume roles and become those

878
00:30:01,350 --> 00:30:06,530
roles right window of opportunity gets

879
00:30:03,480 --> 00:30:11,059
reduced as well hard

880
00:30:06,530 --> 00:30:13,530
short recommendations limit macros right

881
00:30:11,059 --> 00:30:15,450
even with Y and I'm going on about life

882
00:30:13,530 --> 00:30:17,309
including DDA and everything else

883
00:30:15,450 --> 00:30:18,600
anything that's dynamic as far as your

884
00:30:17,309 --> 00:30:20,879
office documents are considered just get

885
00:30:18,600 --> 00:30:23,520
rid of them right like why why is it in

886
00:30:20,880 --> 00:30:25,919
2017 that we just have time and time

887
00:30:23,520 --> 00:30:27,418
again about such-and-such was popped

888
00:30:25,919 --> 00:30:29,250
through a macro such-and-such was popped

889
00:30:27,419 --> 00:30:30,690
through a DDA explained it doesn't

890
00:30:29,250 --> 00:30:32,010
matter right there are very few times

891
00:30:30,690 --> 00:30:33,960
when we go into organizations and we

892
00:30:32,010 --> 00:30:35,040
talk to them and they're way oh yeah

893
00:30:33,960 --> 00:30:37,110
actually there's a hard business

894
00:30:35,040 --> 00:30:39,570
requirement to accept unsolicited Word

895
00:30:37,110 --> 00:30:42,990
documents so our helpdesk with macros

896
00:30:39,570 --> 00:30:44,879
enabled it's like okay like if you need

897
00:30:42,990 --> 00:30:46,770
to have them sign them right deny

898
00:30:44,880 --> 00:30:48,260
anything that isn't signed it's doable

899
00:30:46,770 --> 00:30:51,240
it's achievable it's not that difficult

900
00:30:48,260 --> 00:30:53,640
it's a reason why it's like in the top

901
00:30:51,240 --> 00:30:55,140
whatever on is DS anything is top for

902
00:30:53,640 --> 00:30:58,020
like it's number four and a s DS

903
00:30:55,140 --> 00:30:59,820
essential mitigations it's just no

904
00:30:58,020 --> 00:31:01,710
reason for it to actually be a risk and

905
00:30:59,820 --> 00:31:02,970
if you if you do have a requirement to

906
00:31:01,710 --> 00:31:04,559
accept macro enabled documents from

907
00:31:02,970 --> 00:31:06,270
other organizations like move it out of

908
00:31:04,559 --> 00:31:07,889
email right move it to an authenticated

909
00:31:06,270 --> 00:31:08,560
secure file transfer server or something

910
00:31:07,890 --> 00:31:10,720
like that

911
00:31:08,560 --> 00:31:14,290
a service that's sort of out-of-band

912
00:31:10,720 --> 00:31:19,480
away from email right and two-factor

913
00:31:14,290 --> 00:31:20,889
that file transfer service the last

914
00:31:19,480 --> 00:31:22,540
strategy they really want to touch on is

915
00:31:20,890 --> 00:31:24,520
again another soft one right but it's

916
00:31:22,540 --> 00:31:25,990
situational awareness now the amount of

917
00:31:24,520 --> 00:31:28,210
times that we go to places we storm

918
00:31:25,990 --> 00:31:30,910
through the network the team sort of has

919
00:31:28,210 --> 00:31:33,550
stolen everything got da five different

920
00:31:30,910 --> 00:31:36,340
ways owned the act of network that they

921
00:31:33,550 --> 00:31:37,990
were targeting and the customer sitting

922
00:31:36,340 --> 00:31:39,939
there going well we have a security

923
00:31:37,990 --> 00:31:41,500
operation center we've got AV we've got

924
00:31:39,940 --> 00:31:44,410
like a three million dollar Splunk

925
00:31:41,500 --> 00:31:46,540
deployment and we didn't see right

926
00:31:44,410 --> 00:31:47,890
and it's like whoa okay what were you

927
00:31:46,540 --> 00:31:49,810
looking for it's like well no one's

928
00:31:47,890 --> 00:31:51,010
reading the logs all right we pay

929
00:31:49,810 --> 00:31:53,230
someone else to do that well what are

930
00:31:51,010 --> 00:31:54,970
they looking for all right anything that

931
00:31:53,230 --> 00:31:56,290
can actually flag in a photo generally

932
00:31:54,970 --> 00:31:59,950
across all the customers that they're

933
00:31:56,290 --> 00:32:01,000
looking for right so there are some ones

934
00:31:59,950 --> 00:32:04,000
you can have a situational awareness

935
00:32:01,000 --> 00:32:05,590
right like Zayn from I think it was a HD

936
00:32:04,000 --> 00:32:07,240
at the time okay that just perfectly

937
00:32:05,590 --> 00:32:10,030
right know when your house is burning

938
00:32:07,240 --> 00:32:12,850
down you don't need to read every log

939
00:32:10,030 --> 00:32:14,440
but if you get a spike that says all of

940
00:32:12,850 --> 00:32:16,480
a sudden I have a ton of failed domain

941
00:32:14,440 --> 00:32:19,090
admin authentication going on right

942
00:32:16,480 --> 00:32:20,590
maybe that's a warning sign right

943
00:32:19,090 --> 00:32:22,419
because you can turn to Steve and say

944
00:32:20,590 --> 00:32:26,649
Steve did you just log into pity boxes

945
00:32:22,420 --> 00:32:28,420
no what's going on here right so it's

946
00:32:26,650 --> 00:32:30,340
not about reading all the logs right

947
00:32:28,420 --> 00:32:31,780
it's about visualizing the logs can you

948
00:32:30,340 --> 00:32:33,459
figure out baselines within your

949
00:32:31,780 --> 00:32:36,100
environment and do some really basic

950
00:32:33,460 --> 00:32:38,890
visualization keep pullin mark slippery

951
00:32:36,100 --> 00:32:40,480
items can you just pull out elastic

952
00:32:38,890 --> 00:32:42,370
instance and just actually start having

953
00:32:40,480 --> 00:32:44,560
a look at what visualization we can do

954
00:32:42,370 --> 00:32:46,510
with this data right and it means that

955
00:32:44,560 --> 00:32:48,100
you don't get lost in the details like

956
00:32:46,510 --> 00:32:49,030
how many people here have seen a

957
00:32:48,100 --> 00:32:51,100
suspicious have been in their

958
00:32:49,030 --> 00:32:52,840
environment and started looking at logs

959
00:32:51,100 --> 00:32:54,280
and all of a sudden thought that there

960
00:32:52,840 --> 00:32:55,300
was six different nation-state attackers

961
00:32:54,280 --> 00:32:59,980
in their environments telling what they

962
00:32:55,300 --> 00:33:01,180
data right like it's really hard to

963
00:32:59,980 --> 00:33:03,070
filter down and to watch actually

964
00:33:01,180 --> 00:33:05,110
concern about and what is normal right

965
00:33:03,070 --> 00:33:06,730
if you've seen an anomaly where you've

966
00:33:05,110 --> 00:33:08,439
seen a spike of failed logins quite

967
00:33:06,730 --> 00:33:10,150
often you'll be like I actually have no

968
00:33:08,440 --> 00:33:11,950
idea where to begin on this right but it

969
00:33:10,150 --> 00:33:14,440
gives you an indicator it gives you

970
00:33:11,950 --> 00:33:17,679
something that you can monitor just have

971
00:33:14,440 --> 00:33:20,320
on the side and it means that you don't

972
00:33:17,679 --> 00:33:21,700
have to have 37 thousand emails a week

973
00:33:20,320 --> 00:33:23,350
out of your scene going

974
00:33:21,700 --> 00:33:24,760
seen this for you to ignore because you

975
00:33:23,350 --> 00:33:28,139
know that it's like you know Joanne

976
00:33:24,760 --> 00:33:28,139
accounting doing something right

977
00:33:28,840 --> 00:33:32,289
canary tokens are another one that I

978
00:33:30,700 --> 00:33:34,240
really wanted to touch on canary tokens

979
00:33:32,289 --> 00:33:35,649
keep me awake at night right for those

980
00:33:34,240 --> 00:33:39,039
who aren't familiar with canary tokens

981
00:33:35,649 --> 00:33:44,830
the idea is is that you can place a

982
00:33:39,039 --> 00:33:46,929
document a service AWS API keys you can

983
00:33:44,830 --> 00:33:48,820
put them there's kind of like a classic

984
00:33:46,929 --> 00:33:50,500
honey neat example honeypot example but

985
00:33:48,820 --> 00:33:52,389
you put them in your environment and

986
00:33:50,500 --> 00:33:53,649
when someone is really document they

987
00:33:52,389 --> 00:33:55,750
should never be read you get a

988
00:33:53,649 --> 00:33:57,129
notification right when someone is you

989
00:33:55,750 --> 00:33:58,360
tried to use an API key that should

990
00:33:57,130 --> 00:34:02,260
never be used you get a notification

991
00:33:58,360 --> 00:34:05,049
when someone has tried to RDP to a

992
00:34:02,260 --> 00:34:08,589
server that should never be able to be

993
00:34:05,049 --> 00:34:10,869
RDP to you get a notification right so

994
00:34:08,589 --> 00:34:12,668
the idea is is that again it's almost

995
00:34:10,869 --> 00:34:13,960
like visualizing right like rather than

996
00:34:12,668 --> 00:34:15,399
worrying about what's going on within

997
00:34:13,960 --> 00:34:18,429
your logs you can actually be like I

998
00:34:15,399 --> 00:34:20,710
only care if someone tries to RDP to

999
00:34:18,429 --> 00:34:23,050
this box called DC zero one super

1000
00:34:20,710 --> 00:34:26,740
important internal organization right

1001
00:34:23,050 --> 00:34:29,619
and so or someone's just clicked on

1002
00:34:26,739 --> 00:34:32,199
payroll dot xlsx and the g-drive admin

1003
00:34:29,619 --> 00:34:35,230
temp do not open restricted access right

1004
00:34:32,199 --> 00:34:36,638
because that's what we do we go to G

1005
00:34:35,230 --> 00:34:40,780
Drive we go hey it says do not open

1006
00:34:36,639 --> 00:34:42,819
we're gonna open it have a look right so

1007
00:34:40,780 --> 00:34:46,649
it's really important way to consider

1008
00:34:42,819 --> 00:34:49,029
that as well sort of summarized right

1009
00:34:46,649 --> 00:34:51,129
attackers of budgets they have bosses

1010
00:34:49,030 --> 00:34:53,859
they have goals they have things they

1011
00:34:51,129 --> 00:34:55,118
want to go for right and if you can look

1012
00:34:53,859 --> 00:34:56,679
at these strategies and you can put in

1013
00:34:55,119 --> 00:34:58,720
some basic mitigations like if you adopt

1014
00:34:56,679 --> 00:35:01,900
one of the strategies that we looked at

1015
00:34:58,720 --> 00:35:03,578
today you're already doing about better

1016
00:35:01,900 --> 00:35:05,050
than 50 percent at least of the

1017
00:35:03,579 --> 00:35:07,300
organizations that we see if you adopt

1018
00:35:05,050 --> 00:35:10,420
to your all of the sudden on the top

1019
00:35:07,300 --> 00:35:13,030
twenty percent easy right and if you

1020
00:35:10,420 --> 00:35:14,829
work through it like all of the

1021
00:35:13,030 --> 00:35:17,170
strategies that I've discussed like you

1022
00:35:14,829 --> 00:35:19,270
know I have talked to customers about

1023
00:35:17,170 --> 00:35:20,980
we've gone through it doesn't matter if

1024
00:35:19,270 --> 00:35:23,560
they get oh like if your visualization

1025
00:35:20,980 --> 00:35:25,000
of your failed logins is ghetto and it's

1026
00:35:23,560 --> 00:35:25,960
horrible and it breaks every now and

1027
00:35:25,000 --> 00:35:29,200
doesn't matter because it's still better

1028
00:35:25,960 --> 00:35:30,550
than nothing right if your MFA is this

1029
00:35:29,200 --> 00:35:33,609
mess it's still better than nothing

1030
00:35:30,550 --> 00:35:34,630
right if you all of a sudden just slide

1031
00:35:33,609 --> 00:35:35,009
okay well we can't

1032
00:35:34,630 --> 00:35:36,240
really

1033
00:35:35,010 --> 00:35:37,260
change the way that passwords are

1034
00:35:36,240 --> 00:35:39,839
credentials managers it's kind of

1035
00:35:37,260 --> 00:35:41,790
privileged access workstations just for

1036
00:35:39,840 --> 00:35:43,470
our domain admins it's still better than

1037
00:35:41,790 --> 00:35:44,759
nothing right and all of them will

1038
00:35:43,470 --> 00:35:46,379
increase the cost to attackers when

1039
00:35:44,760 --> 00:35:50,240
they're executing inside your

1040
00:35:46,380 --> 00:35:52,410
environment so the last one is obviously

1041
00:35:50,240 --> 00:35:55,200
and then just joining macros are saying

1042
00:35:52,410 --> 00:35:57,480
yes right like shadow IT is a big

1043
00:35:55,200 --> 00:35:58,620
problem right attackers will know the

1044
00:35:57,480 --> 00:36:00,240
environment as good as it's not better

1045
00:35:58,620 --> 00:36:03,060
than you they'll do it in record time

1046
00:36:00,240 --> 00:36:04,950
which is always surprising and they will

1047
00:36:03,060 --> 00:36:06,330
take advantage of it right those trust

1048
00:36:04,950 --> 00:36:08,009
boundaries those trust relationships

1049
00:36:06,330 --> 00:36:09,750
matter right and even though they don't

1050
00:36:08,010 --> 00:36:11,580
fit in your architectural diagram when

1051
00:36:09,750 --> 00:36:14,730
you boot your network 23 3 years ago

1052
00:36:11,580 --> 00:36:15,720
they matched it today right and if you

1053
00:36:14,730 --> 00:36:17,130
really want to understand more about

1054
00:36:15,720 --> 00:36:20,009
that go see Middle School's talk

1055
00:36:17,130 --> 00:36:24,750
tomorrow afternoon because well I

1056
00:36:20,010 --> 00:36:26,310
enjoyed it anyway and you UAC users

1057
00:36:24,750 --> 00:36:28,770
knowledge right users are the best

1058
00:36:26,310 --> 00:36:31,920
protection mechanism in my opinion as

1059
00:36:28,770 --> 00:36:33,870
far as the anomalies right like that all

1060
00:36:31,920 --> 00:36:35,220
of a sudden like I got this two-factor

1061
00:36:33,870 --> 00:36:38,580
problem to like tell me about it all of

1062
00:36:35,220 --> 00:36:41,459
a sudden I noticed that I had a new

1063
00:36:38,580 --> 00:36:43,770
login to my cloud like you know file

1064
00:36:41,460 --> 00:36:47,190
service and my inbox and it wasn't me

1065
00:36:43,770 --> 00:36:49,110
right that sort of stuff matters so I

1066
00:36:47,190 --> 00:36:50,880
think I'm a couple of minutes over but I

1067
00:36:49,110 --> 00:36:53,960
can't really take questions here now but

1068
00:36:50,880 --> 00:36:57,770
I will be around for the conference and

1069
00:36:53,960 --> 00:37:02,960
yeah enjoy

1070
00:36:57,770 --> 00:37:02,960
[Applause]

