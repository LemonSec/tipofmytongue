1
00:00:04,300 --> 00:00:08,530
thank you very much I'm speaking and I

2
00:00:07,240 --> 00:00:11,440
microphone Wow

3
00:00:08,530 --> 00:00:16,029
hello everyone I'm Dan I'm going to be

4
00:00:11,440 --> 00:00:19,570
talking about the Internet of Things yes

5
00:00:16,029 --> 00:00:22,030
I have a slide this is a this is the

6
00:00:19,570 --> 00:00:24,400
official company slide I put this in so

7
00:00:22,030 --> 00:00:25,930
that I can come to these events without

8
00:00:24,400 --> 00:00:27,729
having to take annual leave and those

9
00:00:25,930 --> 00:00:29,789
sorts of things I work in the

10
00:00:27,730 --> 00:00:34,180
Christchurch office of lateral security

11
00:00:29,789 --> 00:00:38,790
you'll see some of staff wearing little

12
00:00:34,180 --> 00:00:41,739
security shirts and other things we a

13
00:00:38,790 --> 00:00:43,329
information security company we do these

14
00:00:41,739 --> 00:00:45,699
things there's more information on our

15
00:00:43,329 --> 00:00:47,140
website also we are looking for staff

16
00:00:45,700 --> 00:00:48,310
come have a chat with me I'll point you

17
00:00:47,140 --> 00:00:52,510
in the right direction of the people to

18
00:00:48,310 --> 00:00:55,059
speak to yeah but who am I really I am

19
00:00:52,510 --> 00:00:57,309
Dan my handle is Frieden he can probably

20
00:00:55,059 --> 00:00:59,349
no you probably can't see that on my tag

21
00:00:57,309 --> 00:01:01,239
from there I'm on Twitter I've got a

22
00:00:59,350 --> 00:01:03,460
website which has very little things on

23
00:01:01,239 --> 00:01:07,798
it I've ever said I work for lateral

24
00:01:03,460 --> 00:01:11,799
security I'm also involved in the local

25
00:01:07,799 --> 00:01:13,719
Christchurch IT community in that I am

26
00:01:11,799 --> 00:01:16,420
an organizer of check on which happened

27
00:01:13,719 --> 00:01:20,079
just recently - as I understand success

28
00:01:16,420 --> 00:01:23,200
I also look after the monthly meetups

29
00:01:20,079 --> 00:01:26,288
for AIESEC in Christchurch and then I

30
00:01:23,200 --> 00:01:29,229
have in my copious spare time haha I

31
00:01:26,289 --> 00:01:31,029
also have fun with family music and I'm

32
00:01:29,229 --> 00:01:33,569
dabbling a little bit with bit of web

33
00:01:31,029 --> 00:01:37,359
development which is a bit of my history

34
00:01:33,569 --> 00:01:40,270
so today I'm talking about the Internet

35
00:01:37,359 --> 00:01:41,740
of Things so it probably makes sense to

36
00:01:40,270 --> 00:01:44,319
start off and figure out what the heck

37
00:01:41,740 --> 00:01:47,708
thing what what is this Internet of

38
00:01:44,319 --> 00:01:48,789
Things so I did a bit of research and it

39
00:01:47,709 --> 00:01:53,889
turns out that the Internet of Things

40
00:01:48,789 --> 00:01:57,009
are connected things so we're looking at

41
00:01:53,889 --> 00:01:58,810
things being anything that you would

42
00:01:57,009 --> 00:02:00,669
probably use in your day-to-day life for

43
00:01:58,810 --> 00:02:03,639
example a fridge or a toaster or

44
00:02:00,669 --> 00:02:06,219
bathroom scales or lights in your in

45
00:02:03,639 --> 00:02:10,179
your house or an alarm system a camera a

46
00:02:06,219 --> 00:02:12,640
doorbell an a safety alarm a locking

47
00:02:10,179 --> 00:02:15,100
system could be any number of things

48
00:02:12,640 --> 00:02:17,569
basically anything with us with a sensor

49
00:02:15,100 --> 00:02:20,030
or an actuator or both

50
00:02:17,569 --> 00:02:25,849
or multiple of these that is also

51
00:02:20,030 --> 00:02:29,120
connected to the Internet so in order to

52
00:02:25,849 --> 00:02:32,268
play with this new fun Internet of

53
00:02:29,120 --> 00:02:36,469
Things I decided that I needed to get

54
00:02:32,269 --> 00:02:39,079
one or several and have a play so my

55
00:02:36,469 --> 00:02:41,239
main criterias for finding an Internet

56
00:02:39,079 --> 00:02:44,780
of Things thing that I could play with

57
00:02:41,239 --> 00:02:47,030
was that it would be using a technology

58
00:02:44,780 --> 00:02:48,859
that I was familiar with so for example

59
00:02:47,030 --> 00:02:50,510
so in this case Wi-Fi the the other

60
00:02:48,859 --> 00:02:56,569
alternatives are things like Bluetooth

61
00:02:50,510 --> 00:03:00,198
or other radio for example RFID is an

62
00:02:56,569 --> 00:03:03,918
option in my case Wi-Fi I understand

63
00:03:00,199 --> 00:03:06,290
bluetooth I'm still learning I I also

64
00:03:03,919 --> 00:03:08,000
wanted to not have a brick at the end of

65
00:03:06,290 --> 00:03:09,980
it I wanted to have something that I

66
00:03:08,000 --> 00:03:12,530
could potentially use in my real in my

67
00:03:09,980 --> 00:03:15,530
actual life and the other big factor for

68
00:03:12,530 --> 00:03:18,349
me was cost so I had had a look around

69
00:03:15,530 --> 00:03:20,989
my home and I thought what could I get

70
00:03:18,349 --> 00:03:24,168
that has potential use that I could hook

71
00:03:20,989 --> 00:03:25,939
up to the Internet I thought how about a

72
00:03:24,169 --> 00:03:28,819
toaster I mean there's that old gag from

73
00:03:25,939 --> 00:03:30,948
way back in the day that you can you can

74
00:03:28,819 --> 00:03:33,530
get knit bsd to run on anything even a

75
00:03:30,949 --> 00:03:38,139
toaster I mean it's pretty awesome

76
00:03:33,530 --> 00:03:41,030
but I did struggle to find a

77
00:03:38,139 --> 00:03:42,699
cost-effective Wi-Fi enabled toaster

78
00:03:41,030 --> 00:03:46,669
that I could potentially use in my home

79
00:03:42,699 --> 00:03:49,759
so toaster was out but then I had a

80
00:03:46,669 --> 00:03:52,729
light bulb moment I thought let's get a

81
00:03:49,759 --> 00:03:55,250
light bulb so I had a look around there

82
00:03:52,729 --> 00:03:58,549
are lots of different options the the

83
00:03:55,250 --> 00:04:01,849
bulb I ended up buying was a vowel me ye

84
00:03:58,549 --> 00:04:03,829
light which which has some pretty

85
00:04:01,849 --> 00:04:05,448
awesome features I mean it's easy into

86
00:04:03,829 --> 00:04:08,780
easy to install there are there are

87
00:04:05,449 --> 00:04:10,669
quite literally two steps you screw in

88
00:04:08,780 --> 00:04:14,359
the light bulb and you hold a phone in

89
00:04:10,669 --> 00:04:15,799
your hand also there's a there's a fun

90
00:04:14,359 --> 00:04:18,799
thing here you can fill your life with

91
00:04:15,799 --> 00:04:20,478
lights with an 11-year companion meaning

92
00:04:18,798 --> 00:04:25,219
I mean who doesn't want an 11-year

93
00:04:20,478 --> 00:04:26,529
companion and fun colors as well I mean

94
00:04:25,219 --> 00:04:30,770
there were lots of different options

95
00:04:26,529 --> 00:04:32,930
this one was an RGB light

96
00:04:30,770 --> 00:04:38,299
lots of others were just the standard

97
00:04:32,930 --> 00:04:42,970
white on/off so I bought one and in the

98
00:04:38,300 --> 00:04:46,509
box you get a bulb and some instructions

99
00:04:42,970 --> 00:04:46,509
so I've got one here

100
00:04:48,280 --> 00:05:02,419
so the instructions here you go here's a

101
00:04:54,710 --> 00:05:04,460
bulb an Internet of Things thing but the

102
00:05:02,419 --> 00:05:08,139
instructions are not in a language that

103
00:05:04,460 --> 00:05:12,919
I understand I speak French and English

104
00:05:08,139 --> 00:05:16,720
but I don't speak what this is so that

105
00:05:12,919 --> 00:05:21,530
as far as I can tell the instructions go

106
00:05:16,720 --> 00:05:24,740
number one turn the light on number two

107
00:05:21,530 --> 00:05:26,448
do something and number three must be

108
00:05:24,740 --> 00:05:29,270
profit I mean come on what else could

109
00:05:26,449 --> 00:05:33,830
that say so I had a look at the QR code

110
00:05:29,270 --> 00:05:36,740
and the QR code goes to home my comm

111
00:05:33,830 --> 00:05:41,539
download Michael this sounds easy let's

112
00:05:36,740 --> 00:05:45,289
try it oh now I have an apk so an apk is

113
00:05:41,539 --> 00:05:50,029
an Android app all built into the one

114
00:05:45,289 --> 00:05:52,550
file nice and easy to use don't even

115
00:05:50,029 --> 00:05:54,770
need to to go through the App Store and

116
00:05:52,550 --> 00:05:56,180
it's it's really easy to get I thought

117
00:05:54,770 --> 00:05:59,870
that finding the apk would be really

118
00:05:56,180 --> 00:06:01,400
difficult but turns out nope just go to

119
00:05:59,870 --> 00:06:04,550
the QR code in the instructions and

120
00:06:01,400 --> 00:06:07,880
here's an apk it mean I mean I did find

121
00:06:04,550 --> 00:06:10,759
the I did find the app in the App Store

122
00:06:07,880 --> 00:06:12,080
which was a benefit but it wasn't

123
00:06:10,759 --> 00:06:15,650
something that I needed to go out and

124
00:06:12,080 --> 00:06:17,659
find there are ways to get apks from app

125
00:06:15,650 --> 00:06:19,729
stores but this way made a whole lot

126
00:06:17,659 --> 00:06:23,150
easier for me to just open up the apk

127
00:06:19,729 --> 00:06:26,060
and have a look around so my first step

128
00:06:23,150 --> 00:06:30,289
was to plug the light in and when it

129
00:06:26,060 --> 00:06:33,979
comes up you get it is a Wi-Fi access

130
00:06:30,289 --> 00:06:38,120
point initially and I had this named Yi

131
00:06:33,979 --> 00:06:41,599
link light color one my app and then

132
00:06:38,120 --> 00:06:44,270
some numbers so the numbers you may note

133
00:06:41,599 --> 00:06:46,849
that so the last forward carrot

134
00:06:44,270 --> 00:06:48,409
of the SSID are actually the last four

135
00:06:46,850 --> 00:06:50,600
characters of the bulbs MAC address

136
00:06:48,410 --> 00:06:52,580
which makes it easy to find it in future

137
00:06:50,600 --> 00:06:56,150
and also to differentiate between the

138
00:06:52,580 --> 00:06:59,120
bulbs because I bought multiple so I

139
00:06:56,150 --> 00:07:02,150
connect it to the bulb Wi-Fi ID actually

140
00:06:59,120 --> 00:07:03,950
paid it gave me an address and I thought

141
00:07:02,150 --> 00:07:06,260
well let's have a look around let's see

142
00:07:03,950 --> 00:07:10,340
what this bulb is doing so I in mapped

143
00:07:06,260 --> 00:07:11,270
it and there was nothing there was no

144
00:07:10,340 --> 00:07:14,239
web interface

145
00:07:11,270 --> 00:07:15,590
there was no dodgy telnet there was no

146
00:07:14,240 --> 00:07:19,490
SSH port listening

147
00:07:15,590 --> 00:07:23,299
it was just not doing anything so that

148
00:07:19,490 --> 00:07:25,970
was a little bit disappointing so I then

149
00:07:23,300 --> 00:07:28,460
I went and I got the I download the apk

150
00:07:25,970 --> 00:07:30,320
and I put it on a throwaway phone that I

151
00:07:28,460 --> 00:07:32,169
hadn't attached to any App Store but I

152
00:07:30,320 --> 00:07:34,250
looked it up on the App Store and the

153
00:07:32,170 --> 00:07:38,360
permissions that it was asking for were

154
00:07:34,250 --> 00:07:41,750
really really broad so it's a little bit

155
00:07:38,360 --> 00:07:45,860
hard to read these pictures it's big but

156
00:07:41,750 --> 00:07:47,180
it's not enough pixels sorry guys but

157
00:07:45,860 --> 00:07:48,590
the the things that I wanted to know it

158
00:07:47,180 --> 00:07:51,080
wanted to know where you are it wanted

159
00:07:48,590 --> 00:07:54,890
to be able to read and send SMS and make

160
00:07:51,080 --> 00:07:56,630
phone calls and look at files and photos

161
00:07:54,890 --> 00:07:57,890
and use your camera the camera made

162
00:07:56,630 --> 00:08:00,710
sense because one of the features of the

163
00:07:57,890 --> 00:08:03,890
app is that you can point your phone at

164
00:08:00,710 --> 00:08:07,250
a thing and the bulb will turn that

165
00:08:03,890 --> 00:08:09,770
color which is a fun feature I guess but

166
00:08:07,250 --> 00:08:13,970
not something that I'm gonna use it also

167
00:08:09,770 --> 00:08:16,130
wants to use my microphone I don't know

168
00:08:13,970 --> 00:08:19,730
why it would need my microphone or Foe

169
00:08:16,130 --> 00:08:21,320
noise mess the the particularly scary

170
00:08:19,730 --> 00:08:23,810
things were in the the miscellaneous

171
00:08:21,320 --> 00:08:27,469
section it can download files without

172
00:08:23,810 --> 00:08:29,210
notification interact across users full

173
00:08:27,470 --> 00:08:32,450
license to interact across users

174
00:08:29,210 --> 00:08:38,390
transmit infrared modify secure system

175
00:08:32,450 --> 00:08:40,130
settings mmm this doesn't sound good so

176
00:08:38,390 --> 00:08:42,830
I put it on I put it on a device that I

177
00:08:40,130 --> 00:08:47,330
didn't care about throwing away and I

178
00:08:42,830 --> 00:08:49,670
set up a lab so I I fired up fired up

179
00:08:47,330 --> 00:08:53,840
the app and got it to control the bulb

180
00:08:49,670 --> 00:08:56,300
this is this is all without without

181
00:08:53,840 --> 00:08:58,070
sniffing this is all just using using

182
00:08:56,300 --> 00:09:01,310
the bulb as a regular home

183
00:08:58,070 --> 00:09:04,910
user would be intended to use the bulb

184
00:09:01,310 --> 00:09:07,359
so after I figured out that yes these

185
00:09:04,910 --> 00:09:12,290
bulbs actually work in New Zealand you I

186
00:09:07,360 --> 00:09:13,250
I said about getting a lab so I had my

187
00:09:12,290 --> 00:09:14,990
Android device

188
00:09:13,250 --> 00:09:17,480
I had the bulb without both Wi-Fi

189
00:09:14,990 --> 00:09:19,850
enabled and then instead of connecting

190
00:09:17,480 --> 00:09:21,710
them to my guest Wi-Fi in my house I can

191
00:09:19,850 --> 00:09:25,310
I set up an access point on my Raspberry

192
00:09:21,710 --> 00:09:28,450
Pi except the Wi-Fi card in my Raspberry

193
00:09:25,310 --> 00:09:31,369
Pi isn't able to do an access point so

194
00:09:28,450 --> 00:09:33,770
that was very frustrating for me so I

195
00:09:31,370 --> 00:09:36,410
went to my cupboard of things and I got

196
00:09:33,770 --> 00:09:38,930
out a really old voter router

197
00:09:36,410 --> 00:09:41,900
if you prefer and I say then I set this

198
00:09:38,930 --> 00:09:43,459
up so then it could do the Wi-Fi then

199
00:09:41,900 --> 00:09:45,140
the Raspberry Pi can capture all the in

200
00:09:43,460 --> 00:09:49,250
all the traffic so this is what it

201
00:09:45,140 --> 00:09:50,930
looked like but if you want to make it

202
00:09:49,250 --> 00:09:53,270
actually legible you got to put symbols

203
00:09:50,930 --> 00:09:58,310
on things but there's just too much

204
00:09:53,270 --> 00:10:00,350
noise so I had a because of the layout

205
00:09:58,310 --> 00:10:04,010
of my house I had my Raspberry Pi wife

206
00:10:00,350 --> 00:10:05,750
eyeing to my home Internet Ethernet into

207
00:10:04,010 --> 00:10:10,040
my new router or old route oh I guess

208
00:10:05,750 --> 00:10:12,650
that then it did Wi-Fi to the IOT and my

209
00:10:10,040 --> 00:10:13,880
Android this was great that that lit

210
00:10:12,650 --> 00:10:16,189
that means that I could capture all the

211
00:10:13,880 --> 00:10:17,630
traffic going from these things out to

212
00:10:16,190 --> 00:10:20,120
the Internet and back and find out what

213
00:10:17,630 --> 00:10:22,700
it's actually doing so if I fired up

214
00:10:20,120 --> 00:10:26,780
Wireshark and I had a look and yep sure

215
00:10:22,700 --> 00:10:28,400
enough it's going to China so when when

216
00:10:26,780 --> 00:10:30,260
when the bulb once once you've

217
00:10:28,400 --> 00:10:33,530
associated the bulb to an access point

218
00:10:30,260 --> 00:10:35,780
it phones home and this is the first

219
00:10:33,530 --> 00:10:39,199
thing it does it connects to it looks up

220
00:10:35,780 --> 00:10:42,740
some DNS and then it starts doing UDP

221
00:10:39,200 --> 00:10:46,580
something from five four three two one

222
00:10:42,740 --> 00:10:48,230
great port number to 80 53 but

223
00:10:46,580 --> 00:10:51,320
unfortunately the traffic is encrypted

224
00:10:48,230 --> 00:10:52,760
so I've got a I've got a code snippet

225
00:10:51,320 --> 00:10:55,970
later of showing you how that's that's

226
00:10:52,760 --> 00:10:57,439
done but the takeaway from this was the

227
00:10:55,970 --> 00:10:59,740
traffic is encrypted I can't just read

228
00:10:57,440 --> 00:11:03,980
it off the wire this was depressing

229
00:10:59,740 --> 00:11:08,080
so the phone phone phone sorry the the

230
00:11:03,980 --> 00:11:11,310
bulb phone's home to China this address

231
00:11:08,080 --> 00:11:12,300
about every 15 or 20 seconds

232
00:11:11,310 --> 00:11:14,910
depending on what it's been doing

233
00:11:12,300 --> 00:11:16,709
recently the the other thing that I

234
00:11:14,910 --> 00:11:20,399
tried was I set up multiple accounts and

235
00:11:16,709 --> 00:11:25,619
I associated the bulb with more than one

236
00:11:20,399 --> 00:11:28,980
account but the bulb this is at the zsa

237
00:11:25,620 --> 00:11:30,389
me and they they disassociate the bulb

238
00:11:28,980 --> 00:11:31,980
from the old account when you associate

239
00:11:30,389 --> 00:11:34,290
it to the new so that was a little bit a

240
00:11:31,980 --> 00:11:37,499
little bit sad but it was a good a good

241
00:11:34,290 --> 00:11:40,589
finding on the air on the account so all

242
00:11:37,499 --> 00:11:42,809
up I don't really have anything so far

243
00:11:40,589 --> 00:11:45,749
this is a bit depressing but I also

244
00:11:42,809 --> 00:11:48,149
noticed that I wasn't actually capturing

245
00:11:45,749 --> 00:11:49,980
all the traffic I was only getting the

246
00:11:48,149 --> 00:11:51,749
traffic that was on the internet side

247
00:11:49,980 --> 00:11:53,490
because I was on the Raspberry Pi during

248
00:11:51,749 --> 00:11:55,379
packet capture there but there was all

249
00:11:53,490 --> 00:11:57,059
this potential of the the phone to talk

250
00:11:55,379 --> 00:12:00,360
to the bulb direct without going to the

251
00:11:57,059 --> 00:12:01,980
internet I I had verified by putting the

252
00:12:00,360 --> 00:12:03,959
the phone on a separate Wi-Fi connection

253
00:12:01,980 --> 00:12:05,370
that it does go over the Internet and

254
00:12:03,959 --> 00:12:08,910
can control it that way which is how

255
00:12:05,370 --> 00:12:12,990
they how the online services would be

256
00:12:08,910 --> 00:12:15,300
phoning home to the device they call to

257
00:12:12,990 --> 00:12:17,610
the to the same address as the

258
00:12:15,300 --> 00:12:20,189
foreigners doing and then they can the

259
00:12:17,610 --> 00:12:21,689
bulb then when it phones home gets a

260
00:12:20,189 --> 00:12:26,519
response saying yep you should be blue

261
00:12:21,689 --> 00:12:28,469
or whatever it's told so I set up my

262
00:12:26,519 --> 00:12:31,680
desktop computer in the middle instead

263
00:12:28,470 --> 00:12:34,139
of the Raspberry Pi but again I had

264
00:12:31,680 --> 00:12:36,138
trouble with the Wi-Fi card so even

265
00:12:34,139 --> 00:12:39,029
though the Wi-Fi card was capable of

266
00:12:36,139 --> 00:12:39,360
doing all the things that it should be

267
00:12:39,029 --> 00:12:41,879
doing

268
00:12:39,360 --> 00:12:43,470
I just wasn't having any luck the the

269
00:12:41,879 --> 00:12:45,930
bulb was fine talking to up at the phone

270
00:12:43,470 --> 00:12:48,420
maybe my phone's just too old I mean it

271
00:12:45,930 --> 00:12:50,790
was a throwaway phone so maybe that was

272
00:12:48,420 --> 00:12:54,449
it so eventually I asked for some help

273
00:12:50,790 --> 00:12:58,459
from a colleague and he lent me a Wi-Fi

274
00:12:54,449 --> 00:13:03,809
adapter which was a bit larger than mine

275
00:12:58,459 --> 00:13:06,420
with a long aerial and i plugged this

276
00:13:03,809 --> 00:13:07,889
into my desktop and that worked so I was

277
00:13:06,420 --> 00:13:11,729
very happy so now I can see all the

278
00:13:07,889 --> 00:13:15,059
traffic that's going through except the

279
00:13:11,730 --> 00:13:17,309
local traffic is encrypted too so at

280
00:13:15,059 --> 00:13:19,439
this point I thought hang on why am i

281
00:13:17,309 --> 00:13:21,209
doing all this research into this bulb

282
00:13:19,439 --> 00:13:22,889
on my own surely other people have

283
00:13:21,209 --> 00:13:24,689
looked at these sorts of things so I had

284
00:13:22,889 --> 00:13:26,820
a look around the internet and

285
00:13:24,690 --> 00:13:28,530
found that yes there were some other

286
00:13:26,820 --> 00:13:32,010
people who had done research into these

287
00:13:28,530 --> 00:13:34,560
and they were quite willing to destroy

288
00:13:32,010 --> 00:13:36,300
the bulbs and also they know a thing or

289
00:13:34,560 --> 00:13:38,400
two about hardware and electronics which

290
00:13:36,300 --> 00:13:40,469
I'm still learning I'm not cool enough

291
00:13:38,400 --> 00:13:42,510
to do this sort of stuff but they've

292
00:13:40,470 --> 00:13:45,600
done it so I got in touch with these

293
00:13:42,510 --> 00:13:50,160
folk big thanks to URI and ila

294
00:13:45,600 --> 00:13:51,990
- just to find out what they got and to

295
00:13:50,160 --> 00:13:54,300
see if I could participate in that in

296
00:13:51,990 --> 00:13:55,680
any way so this is what the inside of

297
00:13:54,300 --> 00:13:57,599
the bulb looks like one of the findings

298
00:13:55,680 --> 00:14:01,410
was that they they took apart a

299
00:13:57,600 --> 00:14:06,150
white-only bulb but the board the

300
00:14:01,410 --> 00:14:07,829
control board was head pins labeled BG

301
00:14:06,150 --> 00:14:12,510
no idea why they're out of order but

302
00:14:07,830 --> 00:14:14,400
they they had RGB outputs showing that

303
00:14:12,510 --> 00:14:16,200
this can this board would probably being

304
00:14:14,400 --> 00:14:18,390
the same controller for the the color

305
00:14:16,200 --> 00:14:20,310
bulbs as well so I got in touch with him

306
00:14:18,390 --> 00:14:22,560
and said hey can I have a copy of the

307
00:14:20,310 --> 00:14:23,939
firmware that you got because I'm not

308
00:14:22,560 --> 00:14:26,099
gonna have much luck pulling it out of

309
00:14:23,940 --> 00:14:27,720
this without without doing the same

310
00:14:26,100 --> 00:14:32,610
sorts of things that they did except I

311
00:14:27,720 --> 00:14:35,640
don't know how so super big thanks to

312
00:14:32,610 --> 00:14:37,590
those guys for letting me be a part of

313
00:14:35,640 --> 00:14:39,720
that they hit me back pretty quickly

314
00:14:37,590 --> 00:14:41,040
actually and said yep here's a copy of

315
00:14:39,720 --> 00:14:42,990
the firmware here's the research that

316
00:14:41,040 --> 00:14:45,150
we've done and so I've been able to

317
00:14:42,990 --> 00:14:46,710
leverage on that so I had a quick look

318
00:14:45,150 --> 00:14:50,370
at the firmware and you start with the

319
00:14:46,710 --> 00:14:53,610
basics I ran strings and in the firmware

320
00:14:50,370 --> 00:14:55,590
the only thing of interest really was

321
00:14:53,610 --> 00:14:57,530
that there was an x.509 certificate for

322
00:14:55,590 --> 00:15:00,450
cloudy light com

323
00:14:57,530 --> 00:15:05,819
no I had not seen this DNS name in my

324
00:15:00,450 --> 00:15:07,710
sniffing in anyway and so I wasn't quite

325
00:15:05,820 --> 00:15:09,300
sure where that was going but probably

326
00:15:07,710 --> 00:15:09,630
they're doing cert panning or something

327
00:15:09,300 --> 00:15:13,109
like that

328
00:15:09,630 --> 00:15:15,540
I ran been walk and been walk found the

329
00:15:13,110 --> 00:15:18,960
same certificate but nothing of interest

330
00:15:15,540 --> 00:15:22,620
really beyond that so I thought okay

331
00:15:18,960 --> 00:15:25,080
well maybe this is pinning let's let's

332
00:15:22,620 --> 00:15:26,670
see what cert is on that domain the

333
00:15:25,080 --> 00:15:28,950
moment note it's a totally different

334
00:15:26,670 --> 00:15:31,110
search so the the search for the cert

335
00:15:28,950 --> 00:15:33,870
that's in the firmware is a self signed

336
00:15:31,110 --> 00:15:37,420
certificate the cert that's being served

337
00:15:33,870 --> 00:15:42,400
on the Internet is a from

338
00:15:37,420 --> 00:15:44,560
so so no sir pinning is not a thing so I

339
00:15:42,400 --> 00:15:47,860
then carried on and looked into some of

340
00:15:44,560 --> 00:15:49,599
the scripts that are available both on

341
00:15:47,860 --> 00:15:53,260
the internet and also I'm shared with me

342
00:15:49,600 --> 00:15:55,450
privately and I found that the bulb is

343
00:15:53,260 --> 00:15:57,130
completely controllable one of the good

344
00:15:55,450 --> 00:15:58,630
things about this particular bulb which

345
00:15:57,130 --> 00:16:03,270
I which I found out before purchasing

346
00:15:58,630 --> 00:16:06,520
was that the vendor publishes a

347
00:16:03,270 --> 00:16:07,260
interoperability PDF Oh short you later

348
00:16:06,520 --> 00:16:10,660
if you like

349
00:16:07,260 --> 00:16:15,270
it it has all the necessary information

350
00:16:10,660 --> 00:16:18,640
in it to to communicate with the bowl

351
00:16:15,270 --> 00:16:22,810
but not using the their proprietary

352
00:16:18,640 --> 00:16:24,670
cloud systems so I had a look and the

353
00:16:22,810 --> 00:16:27,939
the code that the card that I had access

354
00:16:24,670 --> 00:16:30,849
to said that yep in in the header of

355
00:16:27,940 --> 00:16:33,910
this so you can see in a particular

356
00:16:30,850 --> 00:16:36,580
packet to the device saying just it's

357
00:16:33,910 --> 00:16:41,350
just a hello packet but the response has

358
00:16:36,580 --> 00:16:43,990
a token in it now this token is reset

359
00:16:41,350 --> 00:16:49,600
when when you when you power on the bulb

360
00:16:43,990 --> 00:16:51,820
the the token is reset and it is it

361
00:16:49,600 --> 00:16:53,830
seems to be a random string I'm yet to

362
00:16:51,820 --> 00:16:56,970
to find the the algorithm within the

363
00:16:53,830 --> 00:16:59,950
firmware that produces these so

364
00:16:56,970 --> 00:17:01,840
basically you say hello bulb and the

365
00:16:59,950 --> 00:17:04,510
bulb becomes back saying hi here's my

366
00:17:01,840 --> 00:17:08,110
key this is very useful it means that I

367
00:17:04,510 --> 00:17:10,690
can then communicate with the bulb so

368
00:17:08,109 --> 00:17:12,639
when the bulb was unassociated to a

369
00:17:10,690 --> 00:17:14,320
network when it fires up its own access

370
00:17:12,640 --> 00:17:16,210
point and you connect to it you can

371
00:17:14,319 --> 00:17:19,929
communicate to it through through this

372
00:17:16,210 --> 00:17:21,340
UDP channel and say hey what's your just

373
00:17:19,930 --> 00:17:23,560
say hello it gives you the key and then

374
00:17:21,339 --> 00:17:25,750
you can tell it to do stuff so I've got

375
00:17:23,560 --> 00:17:30,070
a dimmer coming up which hopefully will

376
00:17:25,750 --> 00:17:33,040
work but the the gist of it is when you

377
00:17:30,070 --> 00:17:34,990
do a factory reset of the device it also

378
00:17:33,040 --> 00:17:37,540
resets its token so all these tokens

379
00:17:34,990 --> 00:17:42,250
came from actually this bulb

380
00:17:37,540 --> 00:17:44,680
yes this bulb all within a space of a

381
00:17:42,250 --> 00:17:46,420
few minutes so this this to me looks

382
00:17:44,680 --> 00:17:49,390
like it's not going to be predictable

383
00:17:46,420 --> 00:17:51,670
super awesomely I don't know maybe maybe

384
00:17:49,390 --> 00:17:53,890
you lot can say that's total

385
00:17:51,670 --> 00:17:56,559
ashhadu 5/6 counter or something I'm not

386
00:17:53,890 --> 00:17:59,200
sure but so factory resetting the bulb

387
00:17:56,559 --> 00:18:02,559
also resets the token if I have the

388
00:17:59,200 --> 00:18:05,830
token I can control the bulb if it's

389
00:18:02,559 --> 00:18:07,809
either talking to it directly or after

390
00:18:05,830 --> 00:18:09,129
its associated to our network like if I

391
00:18:07,809 --> 00:18:11,970
have the token then I can also

392
00:18:09,130 --> 00:18:15,130
communicate with it with that token I

393
00:18:11,970 --> 00:18:16,450
couldn't find any I there was no way

394
00:18:15,130 --> 00:18:18,850
that I could see that the token was

395
00:18:16,450 --> 00:18:22,270
being transmitted across the wire I did

396
00:18:18,850 --> 00:18:25,270
check that in all my P caps but that

397
00:18:22,270 --> 00:18:27,429
that wasn't showing up for me so I'm

398
00:18:25,270 --> 00:18:29,970
gonna do a bit of things that won't be

399
00:18:27,429 --> 00:18:32,620
on the screen hopefully this demo works

400
00:18:29,970 --> 00:18:42,750
I'm gonna what I'm gonna do is I'm gonna

401
00:18:32,620 --> 00:18:42,750
reset this bulb okay let's see if I can

402
00:19:14,950 --> 00:19:35,140
okay cool so I want to fun I can type I

403
00:19:31,270 --> 00:19:37,920
can type why can't I type all right

404
00:19:35,140 --> 00:19:40,630
let's see what wi-fi's are around Wow

405
00:19:37,920 --> 00:19:50,710
okay let's see what Wi-Fi access points

406
00:19:40,630 --> 00:19:52,870
around Wow all right let's see what

407
00:19:50,710 --> 00:19:59,560
Wi-Fi access points around that I can

408
00:19:52,870 --> 00:20:07,629
look at of course I can't type all right

409
00:19:59,560 --> 00:20:10,330
let's go to the top again is it working

410
00:20:07,630 --> 00:20:18,330
yeah there is okay so let's see if I can

411
00:20:10,330 --> 00:20:18,330
type again why is tab not working

412
00:20:20,770 --> 00:20:26,510
and then I want that one

413
00:20:22,790 --> 00:20:26,930
oh no I can't middle click this is going

414
00:20:26,510 --> 00:20:37,180
to be annoying

415
00:20:26,930 --> 00:20:37,180
alright I'll type an American car

416
00:20:38,590 --> 00:20:45,129
all right this is your opportunity to

417
00:20:40,609 --> 00:20:45,129
really mess with my demo please don't

418
00:20:47,139 --> 00:20:58,478
okay cool so I'm now I'm connected and

419
00:20:51,379 --> 00:20:58,478
I'm going to get a dress

420
00:21:01,470 --> 00:21:05,799
cool so I have an address I'm connect to

421
00:21:03,820 --> 00:21:12,570
the bulb so now hopefully my tip my

422
00:21:05,799 --> 00:21:12,570
works all right let's go that's going

423
00:21:20,670 --> 00:21:31,290
okay so I wrote a quick web in Python

424
00:21:26,880 --> 00:21:32,000
because Python have adding time okay I'm

425
00:21:31,290 --> 00:21:42,210
good

426
00:21:32,000 --> 00:21:45,480
so here you can see yeah that's one so

427
00:21:42,210 --> 00:21:48,030
in here I've got the so that this this

428
00:21:45,480 --> 00:21:50,360
web app is a very simple taught let's

429
00:21:48,030 --> 00:21:50,360
pull it up

430
00:21:58,070 --> 00:22:03,320
so this is a very simple bottle Python

431
00:22:01,030 --> 00:22:06,740
thing so basically what it's doing is

432
00:22:03,320 --> 00:22:08,450
it's sending a hello packet and then

433
00:22:06,740 --> 00:22:12,590
getting the reply and pulling the token

434
00:22:08,450 --> 00:22:17,780
out of it so the things that I've

435
00:22:12,590 --> 00:22:20,419
written so I've got a couple of buttons

436
00:22:17,780 --> 00:22:28,460
here so hopefully when I click this the

437
00:22:20,420 --> 00:22:31,970
light should go green way so this

438
00:22:28,460 --> 00:22:36,260
particular demonstration is the is the

439
00:22:31,970 --> 00:22:47,980
most basic so the the interoperability

440
00:22:36,260 --> 00:22:47,980
guide which I can pull up which is

441
00:22:51,749 --> 00:22:59,679
well that's frustrating all right I

442
00:22:56,169 --> 00:23:01,419
don't think I've got a PDF you just

443
00:22:59,679 --> 00:23:02,860
corrupt is some Firefox VP do snow

444
00:23:01,419 --> 00:23:06,369
that's crime okay

445
00:23:02,860 --> 00:23:10,508
oh it does okay let's try it here we go

446
00:23:06,369 --> 00:23:12,820
live demos right do I have to do some

447
00:23:10,509 --> 00:23:31,840
magic I'm being told no I just view the

448
00:23:12,820 --> 00:23:34,240
file okay so if I make this big then

449
00:23:31,840 --> 00:23:37,899
this interoperability guide shows you

450
00:23:34,240 --> 00:23:43,629
how stuff works it's pretty detailed but

451
00:23:37,899 --> 00:23:44,850
it has the it yeah it's it's got details

452
00:23:43,629 --> 00:23:48,129
in it in terms of what how to

453
00:23:44,850 --> 00:23:50,590
communicate with the device so you can

454
00:23:48,129 --> 00:23:52,299
do lots of different things so one of

455
00:23:50,590 --> 00:23:54,070
the one of the fun features of this

456
00:23:52,299 --> 00:23:58,330
particular bulb is that you can tell it

457
00:23:54,070 --> 00:24:02,519
turn off in X minutes so that's here

458
00:23:58,330 --> 00:24:06,039
you've got um crong crong get rondalee

459
00:24:02,519 --> 00:24:09,129
so the the the fun fun fun thing with

460
00:24:06,039 --> 00:24:11,769
that would be if you could control if

461
00:24:09,129 --> 00:24:13,869
you can control one of these then you

462
00:24:11,769 --> 00:24:17,379
can tell it hey turn off in six minutes

463
00:24:13,869 --> 00:24:21,549
and then leave for some reason the light

464
00:24:17,379 --> 00:24:28,029
just turns off randomly so I am going to

465
00:24:21,549 --> 00:24:30,519
go back to here and this one nice pads

466
00:24:28,029 --> 00:24:33,070
okay so the other the other things that

467
00:24:30,519 --> 00:24:36,009
the the bulb can do you can adjust the

468
00:24:33,070 --> 00:24:38,200
brightness so hopefully this works I

469
00:24:36,009 --> 00:24:40,809
mean so it's at 100% now so if i dim it

470
00:24:38,200 --> 00:24:45,669
down I should go to one percent which is

471
00:24:40,809 --> 00:24:51,759
fairly low but basically it's got a 1 3

472
00:24:45,669 --> 00:24:54,100
100 brightness scale another feature of

473
00:24:51,759 --> 00:24:57,429
this particular bulb is that you can

474
00:24:54,100 --> 00:25:00,998
change its color just for fun it looks

475
00:24:57,429 --> 00:25:02,380
like this is working yeah good news but

476
00:25:00,999 --> 00:25:06,520
you can also toggle it is the

477
00:25:02,380 --> 00:25:07,900
the kinda basic use case so I'm going to

478
00:25:06,520 --> 00:25:11,320
be pushing all these changes back up

479
00:25:07,900 --> 00:25:13,690
through the existing channel and

480
00:25:11,320 --> 00:25:15,700
research channels I intend to get these

481
00:25:13,690 --> 00:25:18,490
into the the repos that are available

482
00:25:15,700 --> 00:25:20,800
publicly to be able to control these

483
00:25:18,490 --> 00:25:31,090
things but basically if I go back to my

484
00:25:20,800 --> 00:25:35,290
slides which my takeaways from what I've

485
00:25:31,090 --> 00:25:36,760
found so far that the bulb phones home

486
00:25:35,290 --> 00:25:39,220
on UDP so there's nothing interesting

487
00:25:36,760 --> 00:25:41,590
happening on TCP I can't fuzz the bots I

488
00:25:39,220 --> 00:25:44,380
can't do anything fun on the box I did

489
00:25:41,590 --> 00:25:48,580
try sending random UDP packets by virtue

490
00:25:44,380 --> 00:25:52,000
of bad copy pasting and it just doesn't

491
00:25:48,580 --> 00:25:54,970
reply if you've seen it dodgy things all

492
00:25:52,000 --> 00:25:57,220
the traffic is encrypted locally and to

493
00:25:54,970 --> 00:25:58,480
the Internet the device gets removed

494
00:25:57,220 --> 00:26:02,500
from one account when when it's

495
00:25:58,480 --> 00:26:05,200
associated with another so I yeah I

496
00:26:02,500 --> 00:26:10,030
don't have time to do that demo the

497
00:26:05,200 --> 00:26:12,130
tokens are rolled when when the the the

498
00:26:10,030 --> 00:26:14,710
ball was reset so I can show you that if

499
00:26:12,130 --> 00:26:18,220
I run out if we don't have questions I

500
00:26:14,710 --> 00:26:19,990
can show you that yeah also the

501
00:26:18,220 --> 00:26:23,200
particular light fitting that this uses

502
00:26:19,990 --> 00:26:24,940
is a 27 which is surprisingly hard to

503
00:26:23,200 --> 00:26:27,970
find I mean I I eventually found a disc

504
00:26:24,940 --> 00:26:31,930
lamp that worked but I did I did give

505
00:26:27,970 --> 00:26:34,030
some promises in my in my blurb how much

506
00:26:31,930 --> 00:26:35,860
doubted to these bulbs leak can one user

507
00:26:34,030 --> 00:26:36,730
control another device universal plug

508
00:26:35,860 --> 00:26:40,300
and play and what happens when the

509
00:26:36,730 --> 00:26:42,970
internet goes away so how much data do

510
00:26:40,300 --> 00:26:46,690
they leak I can't see a lot going back

511
00:26:42,970 --> 00:26:48,550
and forth that's not encrypted can one

512
00:26:46,690 --> 00:26:50,650
user control another's devices well yes

513
00:26:48,550 --> 00:26:52,840
they can if they have the token but

514
00:26:50,650 --> 00:26:54,730
generally speaking no these bulbs are

515
00:26:52,840 --> 00:26:56,560
pretty good also if you fear that your

516
00:26:54,730 --> 00:27:00,970
token has been compromised reset the

517
00:26:56,560 --> 00:27:03,100
device it's really easy to do the

518
00:27:00,970 --> 00:27:05,200
universal plug and play no it doesn't

519
00:27:03,100 --> 00:27:07,659
matter it phones home to the Internet

520
00:27:05,200 --> 00:27:09,910
about every 20 seconds or so so it's not

521
00:27:07,660 --> 00:27:11,170
really a factor for this what happens

522
00:27:09,910 --> 00:27:13,150
when the internet goes away you can

523
00:27:11,170 --> 00:27:15,400
still control the device locally because

524
00:27:13,150 --> 00:27:16,359
the traffic only goes from your local

525
00:27:15,400 --> 00:27:20,139
device

526
00:27:16,359 --> 00:27:22,210
preferably it's the official app but

527
00:27:20,139 --> 00:27:25,959
totally you can do it through a dodgy

528
00:27:22,210 --> 00:27:28,149
laptop running on a USB stick but online

529
00:27:25,960 --> 00:27:29,440
services like IFFT and such are not

530
00:27:28,149 --> 00:27:32,100
going to work if the Internet's not

531
00:27:29,440 --> 00:27:36,159
there because the Internet's not there

532
00:27:32,100 --> 00:27:39,759
so I think that's all of my content yes

533
00:27:36,159 --> 00:27:41,229
that's all my content so I have a little

534
00:27:39,759 --> 00:27:43,179
bit of time for some questions if you

535
00:27:41,229 --> 00:27:47,559
want to ask things I can see a couple of

536
00:27:43,179 --> 00:27:49,029
hands so let's go questions yeah so I'm

537
00:27:47,559 --> 00:27:58,059
gonna point to people I'm gonna point to

538
00:27:49,029 --> 00:28:00,039
you first so the question was is the do

539
00:27:58,059 --> 00:28:02,590
I think that the excessive writes for

540
00:28:00,039 --> 00:28:05,200
the app is malicious or just lazy I

541
00:28:02,590 --> 00:28:06,879
think it's probably lazy there is a

542
00:28:05,200 --> 00:28:08,619
potential that it could be malicious I

543
00:28:06,879 --> 00:28:10,029
do have the apk I mean it's also

544
00:28:08,619 --> 00:28:13,090
available freely on the internet just

545
00:28:10,029 --> 00:28:19,119
hit that URL you'll get it home Mediacom

546
00:28:13,090 --> 00:28:22,749
flash download and yeah yes the the bulb

547
00:28:19,119 --> 00:28:26,139
is yeah I'm fairly sure that it's

548
00:28:22,749 --> 00:28:28,239
probably just lazy I I did I did scour

549
00:28:26,139 --> 00:28:29,889
the apk I did scour the firmware there

550
00:28:28,239 --> 00:28:32,580
wasn't really anything of particular

551
00:28:29,889 --> 00:28:32,580
interest in there

552
00:28:39,250 --> 00:28:47,060
yes that would be my feel as well that

553
00:28:42,350 --> 00:28:50,000
they're also the the app is also enabled

554
00:28:47,060 --> 00:28:51,980
to control more than just this bulb the

555
00:28:50,000 --> 00:28:54,830
app can also control other products by

556
00:28:51,980 --> 00:28:56,240
the same vendor there's definitely big

557
00:28:54,830 --> 00:28:57,830
sway there's a code in there too in

558
00:28:56,240 --> 00:29:00,290
terms of controlling temperature of

559
00:28:57,830 --> 00:29:03,470
things so maybe that could be my own at

560
00:29:00,290 --> 00:29:06,550
my next purchase cool I see another hand

561
00:29:03,470 --> 00:29:06,550
down here I'm gonna yep

562
00:29:12,080 --> 00:29:17,860
the interrupt guide should be

563
00:29:28,650 --> 00:29:33,250
I didn't know but that's a really good

564
00:29:32,590 --> 00:29:37,510
thing to try

565
00:29:33,250 --> 00:29:38,770
basically when when I sent it bogus or

566
00:29:37,510 --> 00:29:43,510
when I sent at things that it wasn't

567
00:29:38,770 --> 00:29:45,760
expecting from the in terms of if I send

568
00:29:43,510 --> 00:29:49,450
a packet that was bad in some way it

569
00:29:45,760 --> 00:29:51,520
just didn't reply and then carried on as

570
00:29:49,450 --> 00:29:57,370
normal thereafter so it was effectively

571
00:29:51,520 --> 00:29:58,210
just ignoring ignoring those that's my

572
00:29:57,370 --> 00:30:00,129
understanding yes

573
00:29:58,210 --> 00:30:04,620
cool I've been signaled that I'm out of

574
00:30:00,130 --> 00:30:04,620
time so I'm gonna say thanks

575
00:30:15,630 --> 00:30:17,690
you

