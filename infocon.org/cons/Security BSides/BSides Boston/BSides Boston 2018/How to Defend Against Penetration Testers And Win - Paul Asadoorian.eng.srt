1
00:00:00,000 --> 00:00:06,480
school so I don't really know how this

2
00:00:04,140 --> 00:00:08,518
talk kind of start actually I do it was

3
00:00:06,480 --> 00:00:10,740
a I was looking at open source tools

4
00:00:08,519 --> 00:00:13,679
that you can use in the enterprise and

5
00:00:10,740 --> 00:00:17,520
it somehow morphed into how to defend

6
00:00:13,679 --> 00:00:19,800
against penetration testers so lately I

7
00:00:17,520 --> 00:00:22,230
like to start my talks off with a story

8
00:00:19,800 --> 00:00:25,590
they kind of influenced me to give this

9
00:00:22,230 --> 00:00:27,930
particular talk who here has a hero or

10
00:00:25,590 --> 00:00:31,198
spends any time thinking about who their

11
00:00:27,930 --> 00:00:34,140
hero is just a couple of us it's kind of

12
00:00:31,199 --> 00:00:36,390
a fun exercise to do and I think what

13
00:00:34,140 --> 00:00:38,129
sparked this question was someone asked

14
00:00:36,390 --> 00:00:39,930
Tom Brady who's his hero and he said his

15
00:00:38,129 --> 00:00:44,610
mom and stuff like that which is really

16
00:00:39,930 --> 00:00:46,739
cool my hero is my grandfather passed

17
00:00:44,610 --> 00:00:49,800
away actually when I was writing wrt54g

18
00:00:46,739 --> 00:00:51,629
ultimate hacking and my grandfather one

19
00:00:49,800 --> 00:00:55,019
of the reasons why I called him my papa

20
00:00:51,629 --> 00:00:57,149
was he's my hero is because he told me

21
00:00:55,020 --> 00:01:00,390
the story one time when he was going on

22
00:00:57,149 --> 00:01:02,789
a boat to go to war and when they were

23
00:01:00,390 --> 00:01:04,589
on this boat there was just a transport

24
00:01:02,789 --> 00:01:07,350
wasn't my my papa's job to be on this

25
00:01:04,589 --> 00:01:09,658
boat it was just a transport everyone's

26
00:01:07,350 --> 00:01:11,580
getting sick with dysentery if you don't

27
00:01:09,659 --> 00:01:14,400
know what that is like do yourself a

28
00:01:11,580 --> 00:01:16,470
favor don't look it up like just take my

29
00:01:14,400 --> 00:01:18,659
word for it it's not something that you

30
00:01:16,470 --> 00:01:21,600
want and not something that you want any

31
00:01:18,659 --> 00:01:24,750
more details other than like bad food

32
00:01:21,600 --> 00:01:25,770
makes you sick okay I was like up last

33
00:01:24,750 --> 00:01:27,990
night I'm like I should probably look

34
00:01:25,770 --> 00:01:31,170
like the exact oh my god

35
00:01:27,990 --> 00:01:34,079
not a good exercise to go through so the

36
00:01:31,170 --> 00:01:35,820
captain pulls everyone aside he says

37
00:01:34,079 --> 00:01:37,798
look we're used to new people to run the

38
00:01:35,820 --> 00:01:39,750
kitchen because obviously whoever's

39
00:01:37,799 --> 00:01:42,450
running the kitchen beforehand had no

40
00:01:39,750 --> 00:01:44,790
idea what they were doing and now my

41
00:01:42,450 --> 00:01:46,770
papa being of Italian descent although

42
00:01:44,790 --> 00:01:48,869
my last name doesn't say it I am mostly

43
00:01:46,770 --> 00:01:51,090
Italian my grandfather was a hundred

44
00:01:48,869 --> 00:01:53,340
percent Italian and he was like I gotta

45
00:01:51,090 --> 00:01:53,850
eat like eating is important when you're

46
00:01:53,340 --> 00:01:55,799
Italian

47
00:01:53,850 --> 00:01:57,658
anyone here Italian like can vouch for

48
00:01:55,799 --> 00:02:00,299
how important is eating in your world

49
00:01:57,659 --> 00:02:01,799
like it consumes much of your day right

50
00:02:00,299 --> 00:02:04,320
so he was like I'm not letting this

51
00:02:01,799 --> 00:02:06,810
stuff happen so but being the leader

52
00:02:04,320 --> 00:02:08,910
that my grandfather was he told the

53
00:02:06,810 --> 00:02:09,840
captain look he's like so the captain's

54
00:02:08,910 --> 00:02:11,940
like you need a volunteer

55
00:02:09,840 --> 00:02:13,710
no one is volunteer I probably get I'll

56
00:02:11,940 --> 00:02:16,859
do it but there's

57
00:02:13,710 --> 00:02:20,070
one condition now I can't imagine that

58
00:02:16,860 --> 00:02:21,810
Papa knew the captain very well and the

59
00:02:20,070 --> 00:02:23,790
captain probably didn't know how much of

60
00:02:21,810 --> 00:02:25,800
a pain in the ass my papa was sometimes

61
00:02:23,790 --> 00:02:29,010
love them to death most inspirational

62
00:02:25,800 --> 00:02:30,330
person in my life pain in the ass um so

63
00:02:29,010 --> 00:02:33,899
these two are like meeting for the first

64
00:02:30,330 --> 00:02:35,490
time and the captain's like really okay

65
00:02:33,900 --> 00:02:37,440
you like you have demands for me that's

66
00:02:35,490 --> 00:02:39,390
interesting because I'm the captain and

67
00:02:37,440 --> 00:02:42,120
you're just volunteering to run the

68
00:02:39,390 --> 00:02:43,769
kitchen and pop was like alright I'll do

69
00:02:42,120 --> 00:02:45,630
it you got to give me three guys and I

70
00:02:43,770 --> 00:02:48,380
get to pick the men on the ship that

71
00:02:45,630 --> 00:02:50,040
help me oh and he was like well okay

72
00:02:48,380 --> 00:02:51,690
then you can do it

73
00:02:50,040 --> 00:02:53,579
so my grandfather grabbed three people

74
00:02:51,690 --> 00:02:55,620
he said the first thing I had them do

75
00:02:53,580 --> 00:02:59,280
was scrub that kitchen from top to

76
00:02:55,620 --> 00:03:00,840
bottom with bleach he's like and then I

77
00:02:59,280 --> 00:03:02,610
started cooking he's like I learned to

78
00:03:00,840 --> 00:03:04,890
cook for my mom it was awesome they had

79
00:03:02,610 --> 00:03:06,930
this big steamer thing we made pasta in

80
00:03:04,890 --> 00:03:08,429
it I was like what you thinking we use a

81
00:03:06,930 --> 00:03:09,900
dishwasher we made like big vats of

82
00:03:08,430 --> 00:03:12,150
pasta it was awesome

83
00:03:09,900 --> 00:03:14,100
he's like at like 11 o'clock at night

84
00:03:12,150 --> 00:03:16,170
everyone's just chilling out he's like I

85
00:03:14,100 --> 00:03:19,470
had a ham and cheese spread out because

86
00:03:16,170 --> 00:03:22,260
eating is important right and by the end

87
00:03:19,470 --> 00:03:26,220
of the trip the captain's like he won't

88
00:03:22,260 --> 00:03:27,570
you stay on and like help me how and my

89
00:03:26,220 --> 00:03:29,760
thumb's like no I got to do this

90
00:03:27,570 --> 00:03:32,040
interpreter thing he spoke four or five

91
00:03:29,760 --> 00:03:32,880
different languages so his job was to be

92
00:03:32,040 --> 00:03:34,350
an interpreter

93
00:03:32,880 --> 00:03:36,990
he's like I'm doing this interpreter

94
00:03:34,350 --> 00:03:39,329
thing but he proved that he was such a

95
00:03:36,990 --> 00:03:42,000
leader that the captain of a ship whose

96
00:03:39,330 --> 00:03:44,220
job was to get men into battle wanted to

97
00:03:42,000 --> 00:03:47,040
have him on there as a permanent staff

98
00:03:44,220 --> 00:03:48,900
that's the kind of leader and the reason

99
00:03:47,040 --> 00:03:50,880
it influences is talk that you have to

100
00:03:48,900 --> 00:03:53,340
be in order to build your network

101
00:03:50,880 --> 00:03:55,440
defenses to defend against penetration

102
00:03:53,340 --> 00:03:57,540
testers because let's face it they have

103
00:03:55,440 --> 00:03:58,650
the advantage the advantage you have is

104
00:03:57,540 --> 00:04:01,049
if you can be a leader in your

105
00:03:58,650 --> 00:04:02,310
organization and lead people to do the

106
00:04:01,050 --> 00:04:04,380
things that I'm about to teach you in

107
00:04:02,310 --> 00:04:07,470
this talk you're going to make some Penn

108
00:04:04,380 --> 00:04:10,140
trusters really really frustrated and I

109
00:04:07,470 --> 00:04:11,880
know because I didn't necessarily tell

110
00:04:10,140 --> 00:04:14,309
them the whole theme of this talk but I

111
00:04:11,880 --> 00:04:17,190
called up all my pentester friends and I

112
00:04:14,310 --> 00:04:19,500
was like hey so like tell me about how

113
00:04:17,190 --> 00:04:21,450
you break in like this way it's from a

114
00:04:19,500 --> 00:04:22,919
talk I'm doing like they're totally

115
00:04:21,450 --> 00:04:24,659
thinking I'm giving a talk about like

116
00:04:22,919 --> 00:04:26,070
how to be awesome at Penn testing and

117
00:04:24,660 --> 00:04:27,020
then they're going to watch this video

118
00:04:26,070 --> 00:04:29,629
and probably be really

119
00:04:27,020 --> 00:04:32,960
mad at me for a while but that's okay um

120
00:04:29,629 --> 00:04:34,970
so this is me the most important thing

121
00:04:32,960 --> 00:04:37,128
recently is I have serious hacking days

122
00:04:34,970 --> 00:04:39,020
those that saw Dave Kennedy this was

123
00:04:37,129 --> 00:04:41,150
something that he did and this was my

124
00:04:39,020 --> 00:04:42,799
serious hacking day maybe though there

125
00:04:41,150 --> 00:04:44,900
will be more this is my disclaimer I

126
00:04:42,800 --> 00:04:48,050
made talk about things that might offend

127
00:04:44,900 --> 00:04:53,210
some people it happens sometimes so if I

128
00:04:48,050 --> 00:04:54,620
do the get over it and then so I will

129
00:04:53,210 --> 00:04:56,239
talk about how I did actually come up

130
00:04:54,620 --> 00:04:58,909
with this talk and then we're going to

131
00:04:56,240 --> 00:05:00,349
talk about the practical stuff Active

132
00:04:58,909 --> 00:05:02,659
Directory defenses Network and data

133
00:05:00,349 --> 00:05:05,150
segmentation default credentials canary

134
00:05:02,659 --> 00:05:07,550
accounts dark space and analyzing app on

135
00:05:05,150 --> 00:05:10,940
that bomb trap network traffic okay

136
00:05:07,550 --> 00:05:14,000
so I tend to ask a lot of questions so I

137
00:05:10,940 --> 00:05:16,969
got to ask my pen tester friends that

138
00:05:14,000 --> 00:05:21,590
like why or penetration test so

139
00:05:16,970 --> 00:05:24,610
successful Jason why yeah because you're

140
00:05:21,590 --> 00:05:28,940
the most awesome pen tester in the world

141
00:05:24,610 --> 00:05:30,860
right and so obviously the answers I got

142
00:05:28,940 --> 00:05:33,560
to that question were well people don't

143
00:05:30,860 --> 00:05:35,750
patch stuff they use dumb passwords and

144
00:05:33,560 --> 00:05:37,550
I'm the best pen tester in the world

145
00:05:35,750 --> 00:05:40,370
like Jason Street but not quite that

146
00:05:37,550 --> 00:05:42,770
good and you should bow to my exploits

147
00:05:40,370 --> 00:05:45,259
and expert coding skills right like

148
00:05:42,770 --> 00:05:48,380
awesome I'm like all right I'm asking

149
00:05:45,259 --> 00:05:50,509
the question wrong maybe I need to ask a

150
00:05:48,380 --> 00:05:51,650
different question so a better question

151
00:05:50,509 --> 00:05:54,319
turns out get you slightly better

152
00:05:51,650 --> 00:05:56,599
answers so I started asking the question

153
00:05:54,319 --> 00:05:59,090
and this was totally based on Jabra from

154
00:05:56,599 --> 00:06:01,069
Praetorian so I quit the seed in my head

155
00:05:59,090 --> 00:06:03,830
to start talking about these things and

156
00:06:01,069 --> 00:06:07,130
so he asked the question of his own

157
00:06:03,830 --> 00:06:09,080
organization and said hey what in all of

158
00:06:07,130 --> 00:06:12,919
our hundred pen tests across 75

159
00:06:09,080 --> 00:06:16,400
customers what led to complete Network

160
00:06:12,919 --> 00:06:19,909
compromise and he got a specific set of

161
00:06:16,400 --> 00:06:22,460
answers I extended genres researched

162
00:06:19,909 --> 00:06:24,199
like unscientifically and I started

163
00:06:22,460 --> 00:06:25,969
asking all my friends and I'm like I

164
00:06:24,199 --> 00:06:28,009
asked one I'm like and he was like you

165
00:06:25,969 --> 00:06:31,039
know windows authentication is really a

166
00:06:28,009 --> 00:06:32,870
hot mess once I'm in I can pretty much

167
00:06:31,039 --> 00:06:35,330
roam free in the internal network and

168
00:06:32,870 --> 00:06:36,529
people used on passwords okay we got to

169
00:06:35,330 --> 00:06:39,199
seeing people use dumb passwords they

170
00:06:36,529 --> 00:06:40,639
get it so then I started asking more of

171
00:06:39,199 --> 00:06:42,919
my friends to do penetration

172
00:06:40,639 --> 00:06:45,379
testing I asked Joel McCrea and John

173
00:06:42,919 --> 00:06:47,389
strand and I went back and I asked Jabra

174
00:06:45,379 --> 00:06:48,830
again when I saw him and I asked my good

175
00:06:47,389 --> 00:06:51,319
friend Larry Pesch used on the podcast

176
00:06:48,830 --> 00:06:53,599
for me for going on 12 years who leads a

177
00:06:51,319 --> 00:06:55,699
pentest team today not only was the

178
00:06:53,599 --> 00:06:58,849
experience based on the Penta that they

179
00:06:55,699 --> 00:07:01,310
do but their teams as well and they all

180
00:06:58,849 --> 00:07:03,020
pretty much said like boiled down to

181
00:07:01,310 --> 00:07:06,199
pretty much two things like

182
00:07:03,020 --> 00:07:07,969
authentication sucks and no one does

183
00:07:06,199 --> 00:07:10,370
segmentation properly I'm like well

184
00:07:07,969 --> 00:07:13,129
those are kind of interesting themes I

185
00:07:10,370 --> 00:07:15,800
should really dig into like why people

186
00:07:13,129 --> 00:07:18,229
don't do these things and make

187
00:07:15,800 --> 00:07:19,729
penetration testing harder because lo

188
00:07:18,229 --> 00:07:22,250
and behold when I started digging into

189
00:07:19,729 --> 00:07:26,210
Windows authentication other than making

190
00:07:22,250 --> 00:07:27,830
we want to drink a lot made me think

191
00:07:26,210 --> 00:07:32,620
like these things should be easy to fix

192
00:07:27,830 --> 00:07:35,000
but they're not so I started asking like

193
00:07:32,620 --> 00:07:37,039
customers aren't really fixing the

194
00:07:35,000 --> 00:07:38,419
critical issues and this is something

195
00:07:37,039 --> 00:07:40,128
when I was doing penetration testing

196
00:07:38,419 --> 00:07:41,930
that I would notice I'd say you know

197
00:07:40,129 --> 00:07:43,490
here mister customer here is your report

198
00:07:41,930 --> 00:07:45,500
you know see you next year for your next

199
00:07:43,490 --> 00:07:46,909
pen test and then I give them a new

200
00:07:45,500 --> 00:07:48,169
report and I'm like wow there's like not

201
00:07:46,909 --> 00:07:50,300
a lot of differences like what were you

202
00:07:48,169 --> 00:07:52,729
doing the Holi were you on vacation for

203
00:07:50,300 --> 00:07:55,400
the whole year what happened there like

204
00:07:52,729 --> 00:07:57,949
you know like stuff and things and this

205
00:07:55,400 --> 00:07:59,659
IT project and you know we have to like

206
00:07:57,949 --> 00:08:02,089
make money and stuff so we had to do

207
00:07:59,659 --> 00:08:05,270
projects that help us make money and did

208
00:08:02,089 --> 00:08:06,889
nothing for security so I think so why

209
00:08:05,270 --> 00:08:08,779
did you pay for a pen test in the first

210
00:08:06,889 --> 00:08:10,639
place if you weren't going to fix the

211
00:08:08,779 --> 00:08:12,560
things that are in the pen test like you

212
00:08:10,639 --> 00:08:14,300
totally could have put that money to the

213
00:08:12,560 --> 00:08:15,889
six things that were on a previous slide

214
00:08:14,300 --> 00:08:18,259
that you could do to protect yourself

215
00:08:15,889 --> 00:08:19,819
and I can tell you those things for free

216
00:08:18,259 --> 00:08:23,349
don't tell my 10,000 friends I said that

217
00:08:19,819 --> 00:08:23,349
but I can tell you those things for free

218
00:08:23,439 --> 00:08:27,649
so why don't people continually get

219
00:08:25,819 --> 00:08:29,599
better over time and some of the themes

220
00:08:27,649 --> 00:08:32,990
that I get when I'm working with

221
00:08:29,599 --> 00:08:34,458
customers I'm a nine faculty member and

222
00:08:32,990 --> 00:08:36,169
I talk to all of you and we're at

223
00:08:34,458 --> 00:08:38,598
various conferences and venues and I

224
00:08:36,169 --> 00:08:41,510
interview people from the field is you

225
00:08:38,599 --> 00:08:43,940
know that a lot of people will buy stuff

226
00:08:41,510 --> 00:08:45,800
like hey we have this problem we got

227
00:08:43,940 --> 00:08:47,000
hacked or the pen tester came in and

228
00:08:45,800 --> 00:08:49,910
said you suck at this

229
00:08:47,000 --> 00:08:52,339
so we'll buy something and not

230
00:08:49,910 --> 00:08:54,170
necessarily the right way to go also

231
00:08:52,339 --> 00:08:55,850
what I notice this is a theme

232
00:08:54,170 --> 00:08:58,399
I'm going to come back to ineffective

233
00:08:55,850 --> 00:09:00,050
communications in leadership yes you

234
00:08:58,399 --> 00:09:02,810
will security people understand the

235
00:09:00,050 --> 00:09:04,910
problem however we have to communicate

236
00:09:02,810 --> 00:09:07,099
that problem to someone else in the

237
00:09:04,910 --> 00:09:10,189
organization to get them to do something

238
00:09:07,100 --> 00:09:11,600
that today may not be part of their job

239
00:09:10,190 --> 00:09:13,490
because they think security and

240
00:09:11,600 --> 00:09:16,459
Security's problem kind of interesting

241
00:09:13,490 --> 00:09:18,529
so this is the wrong answer

242
00:09:16,459 --> 00:09:21,050
and this is the endpoint security space

243
00:09:18,529 --> 00:09:24,079
as defined by that analyst firm that

244
00:09:21,050 --> 00:09:25,269
starts with a G and nothing anyone knows

245
00:09:24,079 --> 00:09:28,010
what I'm talking about

246
00:09:25,269 --> 00:09:31,579
well but this is a lot of times people

247
00:09:28,010 --> 00:09:32,899
say I have a problem my endpoints people

248
00:09:31,579 --> 00:09:34,939
are doing phishing attacks they're

249
00:09:32,899 --> 00:09:36,529
putting malware on my endpoints and then

250
00:09:34,940 --> 00:09:38,209
it's spreading to the rest of my

251
00:09:36,529 --> 00:09:40,220
organization and then they have how do

252
00:09:38,209 --> 00:09:43,160
they have domain admin already this is

253
00:09:40,220 --> 00:09:46,070
really bad and a lot of people think

254
00:09:43,160 --> 00:09:48,709
that products specifically endpoint

255
00:09:46,070 --> 00:09:50,209
products are the answer they're really

256
00:09:48,709 --> 00:09:51,529
this is the wrong until you've done the

257
00:09:50,209 --> 00:09:53,540
six things that I'm going to talk about

258
00:09:51,529 --> 00:09:55,550
today this is the wrong answer

259
00:09:53,540 --> 00:09:56,959
fine if you have endpoint protection and

260
00:09:55,550 --> 00:09:58,490
you're making it work that's great

261
00:09:56,959 --> 00:10:00,469
you still need to do those six things

262
00:09:58,490 --> 00:10:02,480
before you go out and seek out an

263
00:10:00,470 --> 00:10:04,310
endpoint protection vendor they are not

264
00:10:02,480 --> 00:10:07,100
going to solve these problems for you

265
00:10:04,310 --> 00:10:08,268
they are just really like it's a needle

266
00:10:07,100 --> 00:10:11,149
in a haystack problem for these

267
00:10:08,269 --> 00:10:12,769
endpoints attackers are morphing all the

268
00:10:11,149 --> 00:10:15,050
time more and more morphing these

269
00:10:12,769 --> 00:10:17,089
attacks and you're not going to spot all

270
00:10:15,050 --> 00:10:18,380
of them unless you do some fundamental

271
00:10:17,089 --> 00:10:23,209
things to improve the security of your

272
00:10:18,380 --> 00:10:26,029
network okay so commercial tools can

273
00:10:23,209 --> 00:10:27,739
help but it's good to have goals in a

274
00:10:26,029 --> 00:10:30,050
plan like I said this is some of the

275
00:10:27,740 --> 00:10:32,720
building blocks for making your network

276
00:10:30,050 --> 00:10:34,670
secure is to do these six things and

277
00:10:32,720 --> 00:10:37,100
like I said commercial tools can help

278
00:10:34,670 --> 00:10:40,870
that's fine but let's have a plan and

279
00:10:37,100 --> 00:10:44,899
let's do these six tips okay number one

280
00:10:40,870 --> 00:10:46,850
this is by far the number one thing that

281
00:10:44,899 --> 00:10:50,839
everyone talks about this could be its

282
00:10:46,850 --> 00:10:52,760
own to our talk in and of itself in fact

283
00:10:50,839 --> 00:10:54,260
when I started bringing in some of my

284
00:10:52,760 --> 00:10:55,880
pen tester friends one of them is John

285
00:10:54,260 --> 00:10:58,160
strand he's like you know we should do a

286
00:10:55,880 --> 00:10:59,839
webcast I'm like this isn't going to fit

287
00:10:58,160 --> 00:11:01,670
in one webcast I'm like this is two

288
00:10:59,839 --> 00:11:02,750
webcast and I started rounding off the

289
00:11:01,670 --> 00:11:05,240
list of issues he's like yeah you're

290
00:11:02,750 --> 00:11:06,949
right then he's like to understand

291
00:11:05,240 --> 00:11:08,000
everything you really should take a six

292
00:11:06,949 --> 00:11:09,290
day class with Jason

293
00:11:08,000 --> 00:11:11,030
Boston at cents I'm like dude you're

294
00:11:09,290 --> 00:11:12,620
probably right that is probably the only

295
00:11:11,030 --> 00:11:14,270
source you can go to today that I know

296
00:11:12,620 --> 00:11:17,330
of where you can get all this

297
00:11:14,270 --> 00:11:20,000
information so if you're a defender

298
00:11:17,330 --> 00:11:22,160
today if you're a penetration tester

299
00:11:20,000 --> 00:11:23,780
today or want to be a penetration tester

300
00:11:22,160 --> 00:11:27,620
you're going to want to learn Active

301
00:11:23,780 --> 00:11:31,250
Directory like a lot so these there are

302
00:11:27,620 --> 00:11:33,260
five things based in Active Directory I

303
00:11:31,250 --> 00:11:35,300
mean one is a password policy which is

304
00:11:33,260 --> 00:11:37,840
somewhat active directory the other four

305
00:11:35,300 --> 00:11:40,130
things are really deep heavy

306
00:11:37,840 --> 00:11:44,480
meat-and-potatoes Active Directory

307
00:11:40,130 --> 00:11:46,040
issues and what I found is that talking

308
00:11:44,480 --> 00:11:47,420
to all of my pens because I call them

309
00:11:46,040 --> 00:11:49,550
all back up and I asked them about this

310
00:11:47,420 --> 00:11:51,740
specific thing and I'm like when we talk

311
00:11:49,550 --> 00:11:55,040
about those specific issues I was like

312
00:11:51,740 --> 00:11:57,770
so you can just like disable the past

313
00:11:55,040 --> 00:11:59,390
the hash and the answer I get on all of

314
00:11:57,770 --> 00:12:02,270
them when I'm like well you can just

315
00:11:59,390 --> 00:12:05,569
like disable those NB NS protocol is

316
00:12:02,270 --> 00:12:07,550
like well then there's like this thing

317
00:12:05,570 --> 00:12:09,650
and then it depends on if you have this

318
00:12:07,550 --> 00:12:11,150
in your environment and it like my brain

319
00:12:09,650 --> 00:12:13,160
wanted to explode and I wanted to go

320
00:12:11,150 --> 00:12:15,350
back to drinking again because it was

321
00:12:13,160 --> 00:12:17,240
just so confusing to work through all

322
00:12:15,350 --> 00:12:20,150
those issues I think I've distilled it

323
00:12:17,240 --> 00:12:23,000
down for all of you so let's try and go

324
00:12:20,150 --> 00:12:25,850
through it this dude is so excited about

325
00:12:23,000 --> 00:12:28,010
Windows 95 I've never seen anyone more

326
00:12:25,850 --> 00:12:31,010
excited about Windows 95 in my entire

327
00:12:28,010 --> 00:12:35,030
life you must be a pen tester because it

328
00:12:31,010 --> 00:12:36,950
plays into discontinuing the use of LM

329
00:12:35,030 --> 00:12:39,410
right stores your passwords super weak

330
00:12:36,950 --> 00:12:41,600
format now you can do a group policy

331
00:12:39,410 --> 00:12:44,839
setting to make this go away in your

332
00:12:41,600 --> 00:12:47,960
environment but and well the users have

333
00:12:44,839 --> 00:12:50,480
to change their passwords and it depends

334
00:12:47,960 --> 00:12:53,630
on this that and the other thing so yeah

335
00:12:50,480 --> 00:12:55,490
you can do that now if you do that you

336
00:12:53,630 --> 00:12:57,830
will have combated compatibility

337
00:12:55,490 --> 00:13:01,070
problems in your network with things

338
00:12:57,830 --> 00:13:04,610
like Windows 95 and Windows 98

339
00:13:01,070 --> 00:13:06,380
who here has Windows 95 or when no one

340
00:13:04,610 --> 00:13:09,560
wants to admit Amazon I'm not raising my

341
00:13:06,380 --> 00:13:11,600
hand no way no way you know you know who

342
00:13:09,560 --> 00:13:13,729
you are all right we'll find you later

343
00:13:11,600 --> 00:13:15,380
you have it in your network but the

344
00:13:13,730 --> 00:13:18,260
Macintosh clients those are kind of

345
00:13:15,380 --> 00:13:19,970
interesting too so it can break a lot of

346
00:13:18,260 --> 00:13:21,889
stuff which is why people don't do it

347
00:13:19,970 --> 00:13:23,809
but you need to be able to do this

348
00:13:21,889 --> 00:13:25,009
your environment you don't want LM

349
00:13:23,809 --> 00:13:29,238
hashes floating around your environment

350
00:13:25,009 --> 00:13:31,939
it's really really bad oh and there is a

351
00:13:29,239 --> 00:13:33,949
Microsoft help thing on how to like

352
00:13:31,939 --> 00:13:35,629
prevent that kind of Microsoft is

353
00:13:33,949 --> 00:13:38,149
actually pretty helpful in having

354
00:13:35,629 --> 00:13:40,309
articles that will help you do this so

355
00:13:38,149 --> 00:13:41,660
use this slide take a picture of it go

356
00:13:40,309 --> 00:13:43,730
to your Windows admins if you're not

357
00:13:41,660 --> 00:13:46,368
already the Windows admin and say hey

358
00:13:43,730 --> 00:13:48,709
can we do this because this is important

359
00:13:46,369 --> 00:13:51,589
also this was important so we should do

360
00:13:48,709 --> 00:13:52,939
it right also it makes their job better

361
00:13:51,589 --> 00:13:57,919
because it means you'll get rid of

362
00:13:52,939 --> 00:14:00,410
Windows 95 and windows 98 and Macs yeah

363
00:13:57,919 --> 00:14:02,600
I'm beautiful everyone is Linux and the

364
00:14:00,410 --> 00:14:04,488
latest version of Windows great all

365
00:14:02,600 --> 00:14:06,980
right configure Active Directory to

366
00:14:04,489 --> 00:14:08,419
prevent pass the hash attacks so in this

367
00:14:06,980 --> 00:14:10,220
case obviously I don't have to crack the

368
00:14:08,419 --> 00:14:14,899
password hash I can just replay it on

369
00:14:10,220 --> 00:14:17,629
the network now I read is it on the next

370
00:14:14,899 --> 00:14:19,699
next slot in there I've read harm joins

371
00:14:17,629 --> 00:14:21,799
articles I talked to all my friend about

372
00:14:19,699 --> 00:14:23,389
path the hash and every time I talk with

373
00:14:21,799 --> 00:14:24,829
the most scenario I'm like simple like

374
00:14:23,389 --> 00:14:27,139
if you do this like you're good and

375
00:14:24,829 --> 00:14:29,118
they're like well there's like this one

376
00:14:27,139 --> 00:14:31,489
case if you've got this that and the

377
00:14:29,119 --> 00:14:37,549
other thing and I'm like oh my god so

378
00:14:31,489 --> 00:14:40,220
you can disable LM and ntlm altogether

379
00:14:37,549 --> 00:14:41,720
right which essentially means all your

380
00:14:40,220 --> 00:14:44,389
Windows Active Directory authentication

381
00:14:41,720 --> 00:14:46,850
is using Kerberos is anyone doing this

382
00:14:44,389 --> 00:14:49,459
today and it would know of anyone doing

383
00:14:46,850 --> 00:14:50,660
this today I know some of my pen tester

384
00:14:49,459 --> 00:14:53,209
friends they they've encountered

385
00:14:50,660 --> 00:14:53,660
networks like this ok so that's kind of

386
00:14:53,209 --> 00:14:55,459
interesting

387
00:14:53,660 --> 00:14:58,549
I mean I've probably breaks more things

388
00:14:55,459 --> 00:15:00,799
than just disabling LM but the other

389
00:14:58,549 --> 00:15:04,160
recommendation from Microsoft to prevent

390
00:15:00,799 --> 00:15:07,579
against passed the hash is to implement

391
00:15:04,160 --> 00:15:09,919
this thing called laps it's the local

392
00:15:07,579 --> 00:15:11,748
something privilege and privilege thing

393
00:15:09,919 --> 00:15:14,299
which basically you're giving the thumbs

394
00:15:11,749 --> 00:15:16,879
up so you read the 40 page document that

395
00:15:14,299 --> 00:15:18,079
accompanies laps and did the two or

396
00:15:16,879 --> 00:15:21,889
three we how long it take you to

397
00:15:18,079 --> 00:15:23,329
implement it a couple of weeks so that

398
00:15:21,889 --> 00:15:24,559
but that's significant I mean that's not

399
00:15:23,329 --> 00:15:26,329
just a group policy setting you're

400
00:15:24,559 --> 00:15:28,608
pushing out and you're done it's a to

401
00:15:26,329 --> 00:15:30,529
two to four week process from what I'm

402
00:15:28,609 --> 00:15:32,779
told to implement this in your network

403
00:15:30,529 --> 00:15:34,850
this is I mean props to you thumbs up

404
00:15:32,779 --> 00:15:35,540
for doing that this is you're going to

405
00:15:34,850 --> 00:15:38,060
your windows

406
00:15:35,540 --> 00:15:39,680
admins and you're like I need you to

407
00:15:38,060 --> 00:15:41,420
like put some other stuff aside that's

408
00:15:39,680 --> 00:15:42,920
like making the business work like that

409
00:15:41,420 --> 00:15:44,300
you don't need that and we're going to

410
00:15:42,920 --> 00:15:46,370
implement this thing called laps and

411
00:15:44,300 --> 00:15:48,079
they're like what why do I need a unique

412
00:15:46,370 --> 00:15:49,940
administrator password and every single

413
00:15:48,079 --> 00:15:51,979
one of my workstations and you can just

414
00:15:49,940 --> 00:15:53,959
tell because Paul said so now obviously

415
00:15:51,980 --> 00:15:55,699
because of past the hash right it's a

416
00:15:53,959 --> 00:15:57,349
common method used by pen testers and

417
00:15:55,699 --> 00:15:59,829
the attackers are like to get into all

418
00:15:57,350 --> 00:16:02,630
of your systems but it's pretty

419
00:15:59,829 --> 00:16:04,699
complicated I'm more of a Linux guy but

420
00:16:02,630 --> 00:16:07,279
a two to four week project is not

421
00:16:04,699 --> 00:16:09,949
insignificant and it's you have to read

422
00:16:07,279 --> 00:16:12,529
and plan and implement it so that's

423
00:16:09,949 --> 00:16:14,329
pretty much the recommendation to get

424
00:16:12,529 --> 00:16:16,540
rid of pass the hash not insignificant

425
00:16:14,329 --> 00:16:19,550
in your environment

426
00:16:16,540 --> 00:16:22,699
so then you're like okay well if I do

427
00:16:19,550 --> 00:16:26,000
laps and I'm Kerberos only like I'm good

428
00:16:22,699 --> 00:16:28,430
right I'm awesome and then John strands

429
00:16:26,000 --> 00:16:31,790
like wall no there was like this one

430
00:16:28,430 --> 00:16:33,739
time at Derby con when Tim Medina gives

431
00:16:31,790 --> 00:16:36,740
presentation about capturing Kerberos

432
00:16:33,740 --> 00:16:39,019
authentication and cracking the hashes

433
00:16:36,740 --> 00:16:42,050
now what Johnson was the hashes are not

434
00:16:39,019 --> 00:16:44,660
as easy to crack but the defenses for

435
00:16:42,050 --> 00:16:47,779
this really suck so Tim actually did the

436
00:16:44,660 --> 00:16:50,510
research and said that you can capture

437
00:16:47,779 --> 00:16:53,029
Kerberos and you can crack it and the

438
00:16:50,510 --> 00:16:55,069
defense is like basically he just should

439
00:16:53,029 --> 00:16:55,880
have put two words on the side like

440
00:16:55,069 --> 00:16:58,339
you're screwed

441
00:16:55,880 --> 00:17:00,500
like that's basically the defense for

442
00:16:58,339 --> 00:17:03,920
this from what I surmised the defensive

443
00:17:00,500 --> 00:17:05,869
is there but it's not very good what's

444
00:17:03,920 --> 00:17:08,510
interesting is like no one really knew

445
00:17:05,869 --> 00:17:10,458
what to was talking about and John

446
00:17:08,510 --> 00:17:11,929
picked up on it and Tim was getting

447
00:17:10,459 --> 00:17:14,600
rejected when he was submitting his

448
00:17:11,929 --> 00:17:16,880
talks to various places and finally John

449
00:17:14,599 --> 00:17:19,010
had to call up people that ran

450
00:17:16,880 --> 00:17:21,530
conferences and was like no Lee can you

451
00:17:19,010 --> 00:17:24,290
just listen to what Tim has to say so

452
00:17:21,530 --> 00:17:26,569
and the example he gave was it was he

453
00:17:24,290 --> 00:17:28,309
called Dave Kenny he's like Dave you got

454
00:17:26,569 --> 00:17:30,408
it and I don't know if dad had even seen

455
00:17:28,309 --> 00:17:32,120
Tim's talk at this point Jones I gave

456
00:17:30,409 --> 00:17:33,470
you got it you got to hear Tim's talk

457
00:17:32,120 --> 00:17:35,719
we'll set up a call come we'll go

458
00:17:33,470 --> 00:17:38,270
through it and Tim gets about halfway

459
00:17:35,720 --> 00:17:39,470
through and John says Dave goes hold on

460
00:17:38,270 --> 00:17:41,049
stop stop stop stop stop

461
00:17:39,470 --> 00:17:43,760
you mean to tell me that that is

462
00:17:41,049 --> 00:17:45,650
possible in terms like yeah here's a

463
00:17:43,760 --> 00:17:46,610
guard you're in and it in Tim saw cave

464
00:17:45,650 --> 00:17:49,290
was given a derbycon

465
00:17:46,610 --> 00:17:50,820
and it's like a thing now which is

466
00:17:49,290 --> 00:17:52,409
really depressing because it's kind of

467
00:17:50,820 --> 00:17:56,189
like we're screwed when it comes to

468
00:17:52,410 --> 00:18:00,660
defending Active Directory so these are

469
00:17:56,190 --> 00:18:06,210
the two articles by harm Joy extremely

470
00:18:00,660 --> 00:18:07,980
brilliant yes question yes you are

471
00:18:06,210 --> 00:18:11,610
correct really long service account

472
00:18:07,980 --> 00:18:13,290
passwords yes it because it does is the

473
00:18:11,610 --> 00:18:15,689
only service accounts that it is

474
00:18:13,290 --> 00:18:23,430
attacking or is it regular user accounts

475
00:18:15,690 --> 00:18:25,950
as well yeah yeah yeah it is that's the

476
00:18:23,430 --> 00:18:27,690
other well there's this other use case

477
00:18:25,950 --> 00:18:30,720
yeah and that's what we get into right

478
00:18:27,690 --> 00:18:32,790
so hangzhou has some awesome posts i

479
00:18:30,720 --> 00:18:34,590
mean like everything you ever wanted to

480
00:18:32,790 --> 00:18:36,780
know about past the hashing and all the

481
00:18:34,590 --> 00:18:38,810
nuances are there if you want to go read

482
00:18:36,780 --> 00:18:41,970
it and whenever i talk to someone about

483
00:18:38,810 --> 00:18:44,120
past the hash they'd be like so did you

484
00:18:41,970 --> 00:18:46,170
read harm joyce are i'm like yes yes i

485
00:18:44,120 --> 00:18:48,270
painstakingly tried to read all the

486
00:18:46,170 --> 00:18:49,710
details in both of his articles in my

487
00:18:48,270 --> 00:18:52,470
brain hurts now which is why I'm calling

488
00:18:49,710 --> 00:18:53,520
you to get like the 30,000 foot view and

489
00:18:52,470 --> 00:18:55,020
they're like what you really need to

490
00:18:53,520 --> 00:18:56,820
read harm to us I'm like I get that I

491
00:18:55,020 --> 00:19:00,770
get that okay so I'm telling all of you

492
00:18:56,820 --> 00:19:03,389
go read the articles now at the end of

493
00:19:00,770 --> 00:19:05,820
arms your second article pasta hash is

494
00:19:03,390 --> 00:19:07,230
dead long live local account token

495
00:19:05,820 --> 00:19:09,210
filter policy he says it's also worth

496
00:19:07,230 --> 00:19:11,940
noting that lapse effectively renders

497
00:19:09,210 --> 00:19:13,950
everything here a moot point that's good

498
00:19:11,940 --> 00:19:16,800
to hear right we know we have a path

499
00:19:13,950 --> 00:19:18,570
it's not the easiest thing to do there

500
00:19:16,800 --> 00:19:25,649
is a project some communication involved

501
00:19:18,570 --> 00:19:28,379
but we can do that yes oh here we go the

502
00:19:25,650 --> 00:19:31,710
well is that your but you're absolutely

503
00:19:28,380 --> 00:19:33,960
right I did read that yes so again thank

504
00:19:31,710 --> 00:19:35,730
you for backing up my point that we're

505
00:19:33,960 --> 00:19:37,770
all screwed when it comes to Active

506
00:19:35,730 --> 00:19:40,680
Directory security which is really the

507
00:19:37,770 --> 00:19:44,150
point of these types okay now implement

508
00:19:40,680 --> 00:19:44,150
a password pop-ups

509
00:19:53,120 --> 00:19:57,229
I tried to put something funnier up

510
00:19:55,310 --> 00:19:59,419
there other than implement a password

511
00:19:57,230 --> 00:20:04,780
policy which in and of itself is funny

512
00:19:59,420 --> 00:20:07,130
and that certainly seemed to trump it so

513
00:20:04,780 --> 00:20:10,190
we can you can give a whole presentation

514
00:20:07,130 --> 00:20:12,560
about password policies right but what a

515
00:20:10,190 --> 00:20:14,450
lot of people will say is actually a lot

516
00:20:12,560 --> 00:20:16,790
of what I used to think was well if I

517
00:20:14,450 --> 00:20:18,620
have multi-factor authentication the

518
00:20:16,790 --> 00:20:21,170
password doesn't become as critical

519
00:20:18,620 --> 00:20:22,939
right because I need something I have in

520
00:20:21,170 --> 00:20:24,620
something I know so there's something I

521
00:20:22,940 --> 00:20:27,470
know is only part of the equation so

522
00:20:24,620 --> 00:20:31,250
it's not you don't have to have an a 40

523
00:20:27,470 --> 00:20:33,680
character password except as we move

524
00:20:31,250 --> 00:20:35,390
into modern technology with apps and web

525
00:20:33,680 --> 00:20:37,370
applications and api's and all this

526
00:20:35,390 --> 00:20:40,100
wonderful technology I run to the

527
00:20:37,370 --> 00:20:43,399
situation where I happen to lose my

528
00:20:40,100 --> 00:20:44,990
phone long story it's painful it hurts I

529
00:20:43,400 --> 00:20:47,270
got a new phone it's really expensive

530
00:20:44,990 --> 00:20:49,160
anyway I lose my phone so I'm putting

531
00:20:47,270 --> 00:20:50,780
LastPass back on my phone I have

532
00:20:49,160 --> 00:20:53,390
two-factor authentication enabled for

533
00:20:50,780 --> 00:20:55,430
LastPass and when I put it on my phone

534
00:20:53,390 --> 00:20:57,410
it just is all just give me your

535
00:20:55,430 --> 00:20:58,970
password ah yeah you're good you don't

536
00:20:57,410 --> 00:21:00,920
need the second fact you're on a phone

537
00:20:58,970 --> 00:21:03,230
like what could go wrong I'm like I just

538
00:21:00,920 --> 00:21:05,660
lost my phone I want that's where I want

539
00:21:03,230 --> 00:21:06,980
the two factor authentication and what

540
00:21:05,660 --> 00:21:08,840
I've seen in the industry and what I've

541
00:21:06,980 --> 00:21:10,580
talked with people about is that

542
00:21:08,840 --> 00:21:12,770
two-factor authentication is great

543
00:21:10,580 --> 00:21:15,020
except for when they just leave it out

544
00:21:12,770 --> 00:21:17,000
for convenience such as on a mobile

545
00:21:15,020 --> 00:21:18,980
application so you can have a really

546
00:21:17,000 --> 00:21:21,500
great multi-factor authentication scheme

547
00:21:18,980 --> 00:21:23,560
going except when they put the mobile

548
00:21:21,500 --> 00:21:25,940
app for whatever service it is it

549
00:21:23,560 --> 00:21:29,409
doesn't ask them it doesn't ask them at

550
00:21:25,940 --> 00:21:29,410
all question

551
00:21:36,310 --> 00:21:39,649
ya know there and that's why I didn't

552
00:21:38,630 --> 00:21:41,690
spend a lot of time because you're

553
00:21:39,650 --> 00:21:44,840
absolutely right the question was what's

554
00:21:41,690 --> 00:21:46,880
the minimum length I would say over like

555
00:21:44,840 --> 00:21:49,429
15 characters or more to get around some

556
00:21:46,880 --> 00:21:50,540
of the issues with the previous hashing

557
00:21:49,430 --> 00:21:52,550
depending on what you're using because

558
00:21:50,540 --> 00:21:54,470
of all the backwards compatibility you

559
00:21:52,550 --> 00:21:57,470
know outside of that you're right it's I

560
00:21:54,470 --> 00:22:01,070
mean 2 bit yeah are you in Active

561
00:21:57,470 --> 00:22:07,330
Directory admin ok ok you're doing good

562
00:22:01,070 --> 00:22:07,330
you have another question alright I'm ok

563
00:22:12,790 --> 00:22:21,620
gotcha gotcha so 14 is a mess the

564
00:22:19,520 --> 00:22:23,060
highest minimum see we're all screwed

565
00:22:21,620 --> 00:22:27,399
because I like to go one past the

566
00:22:23,060 --> 00:22:32,300
highest minimum good lord

567
00:22:27,400 --> 00:22:33,470
yes but the minimum yes thank you so

568
00:22:32,300 --> 00:22:35,570
those are some of the gaps with

569
00:22:33,470 --> 00:22:36,980
two-factor authentication and we just

570
00:22:35,570 --> 00:22:39,340
had a great discussion about minimum

571
00:22:36,980 --> 00:22:42,590
password length so thank you for that

572
00:22:39,340 --> 00:22:46,040
the other problem is so basically this

573
00:22:42,590 --> 00:22:51,350
can be surmised as software trying to be

574
00:22:46,040 --> 00:22:53,899
really helpful right so if I can't find

575
00:22:51,350 --> 00:22:56,120
the proxy server to be able to browse

576
00:22:53,900 --> 00:22:58,400
the internet so I can go to youtube and

577
00:22:56,120 --> 00:23:01,280
watch videos adjacent street and stuff

578
00:22:58,400 --> 00:23:03,620
like that my network in Active Directory

579
00:23:01,280 --> 00:23:05,960
likes to be helpful and give me some

580
00:23:03,620 --> 00:23:09,830
kind of automatic proxy discovery right

581
00:23:05,960 --> 00:23:12,290
if let's say I connect to a website and

582
00:23:09,830 --> 00:23:14,780
it takes authentication or a file server

583
00:23:12,290 --> 00:23:15,980
that takes authentication the protocol

584
00:23:14,780 --> 00:23:18,800
likes to be really helpful

585
00:23:15,980 --> 00:23:20,600
so that I like sends my credentials to

586
00:23:18,800 --> 00:23:22,520
places so that I can authenticate and

587
00:23:20,600 --> 00:23:24,889
it's trying to be helpful it turns out

588
00:23:22,520 --> 00:23:27,110
trying to be helpful in these situations

589
00:23:24,890 --> 00:23:29,450
goes into all the technical details and

590
00:23:27,110 --> 00:23:32,510
all these protocols that essentially

591
00:23:29,450 --> 00:23:35,000
means that my password hash is going

592
00:23:32,510 --> 00:23:37,129
across the network in some kind of

593
00:23:35,000 --> 00:23:39,230
hashed format depending on the

594
00:23:37,130 --> 00:23:42,680
configuration in a number of different

595
00:23:39,230 --> 00:23:45,440
things it can be LM it can be ntlm v1 or

596
00:23:42,680 --> 00:23:46,010
I think even v2 over the network in this

597
00:23:45,440 --> 00:23:48,230
case

598
00:23:46,010 --> 00:23:49,610
right and using the tool called

599
00:23:48,230 --> 00:23:52,490
responder and a bunch of other things

600
00:23:49,610 --> 00:23:54,409
this article from Praetorian is probably

601
00:23:52,490 --> 00:23:56,330
the best one that I've seen that walks

602
00:23:54,410 --> 00:23:57,200
you through both the attack and the

603
00:23:56,330 --> 00:23:58,909
defense for this

604
00:23:57,200 --> 00:24:00,679
I thought Jabbar did a nice job with

605
00:23:58,910 --> 00:24:03,530
that he does really good this one is

606
00:24:00,679 --> 00:24:06,320
also good on this topic it's like the

607
00:24:03,530 --> 00:24:07,370
number like pen testers and how like you

608
00:24:06,320 --> 00:24:08,389
used to think they get on the network

609
00:24:07,370 --> 00:24:09,709
and they do pore scanning of

610
00:24:08,390 --> 00:24:10,640
vulnerability scanning now they just

611
00:24:09,710 --> 00:24:12,500
come in on the network they run

612
00:24:10,640 --> 00:24:13,669
responder they grab a bunch of hashes

613
00:24:12,500 --> 00:24:15,530
and then they're breaking into all of

614
00:24:13,669 --> 00:24:19,010
your stuff that's like the dirty secret

615
00:24:15,530 --> 00:24:21,230
now in pen testing is that really

616
00:24:19,010 --> 00:24:23,990
they're just exploiting this particular

617
00:24:21,230 --> 00:24:25,340
vulnerability not necessarily the W pad

618
00:24:23,990 --> 00:24:29,210
vulnerability where if you create a DMS

619
00:24:25,340 --> 00:24:32,120
entry someone can't step on it but using

620
00:24:29,210 --> 00:24:34,250
these other legacy and newer protocols

621
00:24:32,120 --> 00:24:36,229
that are essentially exploiting the fact

622
00:24:34,250 --> 00:24:40,100
that software is trying to be helpful so

623
00:24:36,230 --> 00:24:42,500
that you can log into stuff so that is

624
00:24:40,100 --> 00:24:45,559
these two articles talk about the

625
00:24:42,500 --> 00:24:46,880
defense to that group policy again to

626
00:24:45,559 --> 00:24:47,870
turn that off in your environment that's

627
00:24:46,880 --> 00:24:49,730
something you're going to want to test

628
00:24:47,870 --> 00:24:52,040
that's also another project that you're

629
00:24:49,730 --> 00:24:53,929
going to want to tackle with your Active

630
00:24:52,040 --> 00:24:57,049
Directory environment it does especially

631
00:24:53,929 --> 00:24:58,820
NetBIOS naming service right have the

632
00:24:57,049 --> 00:25:00,049
potential to break some backwards

633
00:24:58,820 --> 00:25:05,418
compatibility with other Microsoft

634
00:25:00,049 --> 00:25:07,400
operating systems so ok so this is the

635
00:25:05,419 --> 00:25:09,160
protection against mini caps many of you

636
00:25:07,400 --> 00:25:13,760
probably familiar with the in-memory

637
00:25:09,160 --> 00:25:19,700
attacks this is a well again this is the

638
00:25:13,760 --> 00:25:22,309
well but so you can do the to a 7 1 1997

639
00:25:19,700 --> 00:25:24,830
and put this group policy slash registry

640
00:25:22,309 --> 00:25:26,149
change in place or use group policy to

641
00:25:24,830 --> 00:25:29,270
make the registry change in all of your

642
00:25:26,150 --> 00:25:32,929
systems but the problem with that is the

643
00:25:29,270 --> 00:25:35,780
well thought is that if I gain admin

644
00:25:32,929 --> 00:25:38,179
rights to one of your workstations I can

645
00:25:35,780 --> 00:25:40,190
revert that change in oh by the way

646
00:25:38,179 --> 00:25:43,220
reverting that change doesn't require a

647
00:25:40,190 --> 00:25:45,799
reboot so if I'm an attacker I get a man

648
00:25:43,220 --> 00:25:48,470
on one of your systems I revert the

649
00:25:45,799 --> 00:25:49,400
change then I have to wait I don't need

650
00:25:48,470 --> 00:25:50,780
to it doesn't need to be an

651
00:25:49,400 --> 00:25:52,340
administrator that's machine an

652
00:25:50,780 --> 00:25:54,260
administrator just needs to log into

653
00:25:52,340 --> 00:25:56,209
that machine then their credentials will

654
00:25:54,260 --> 00:25:59,000
throw to memory then I can use mini caps

655
00:25:56,210 --> 00:26:00,390
to extract them so while there is a fix

656
00:25:59,000 --> 00:26:04,080
for

657
00:26:00,390 --> 00:26:13,110
there are limitations to the fix good

658
00:26:04,080 --> 00:26:14,699
good good good interesting so it

659
00:26:13,110 --> 00:26:26,280
apparently this fix doesn't work on

660
00:26:14,700 --> 00:26:29,010
Windows 7 in certain circles in both are

661
00:26:26,280 --> 00:26:30,270
like the critical 5 things that I think

662
00:26:29,010 --> 00:26:31,980
everyone needs to do in Active Directory

663
00:26:30,270 --> 00:26:34,200
we've already heard from people in the

664
00:26:31,980 --> 00:26:35,820
community that are like yeah but there's

665
00:26:34,200 --> 00:26:38,670
like a different thing these things are

666
00:26:35,820 --> 00:26:40,470
not easy it requires planning it

667
00:26:38,670 --> 00:26:42,420
requires working together as a team with

668
00:26:40,470 --> 00:26:43,740
your Windows administrators I can tell

669
00:26:42,420 --> 00:26:45,540
you that I could probably stop the

670
00:26:43,740 --> 00:26:48,060
presentation right here and you would

671
00:26:45,540 --> 00:26:49,889
stop most pentest I mean not Jason

672
00:26:48,060 --> 00:26:52,500
because Jason is like hiding under your

673
00:26:49,890 --> 00:26:54,870
desk like but I did all those things

674
00:26:52,500 --> 00:26:58,110
Paul said but Jason still under my desk

675
00:26:54,870 --> 00:26:59,790
look most pen testers would like stop

676
00:26:58,110 --> 00:27:01,379
and just want to cry like right here at

677
00:26:59,790 --> 00:27:05,520
this point okay so let's go on to

678
00:27:01,380 --> 00:27:07,470
network segmentation which it's kind of

679
00:27:05,520 --> 00:27:10,800
interesting so this comes from the

680
00:27:07,470 --> 00:27:12,950
analyst firm the source of the G and I

681
00:27:10,800 --> 00:27:15,480
just want to point out their advice or

682
00:27:12,950 --> 00:27:17,400
someone's advice not the analyst from

683
00:27:15,480 --> 00:27:19,650
the source of the G on network

684
00:27:17,400 --> 00:27:23,910
segmentation are you ready okay

685
00:27:19,650 --> 00:27:25,470
don't over segment okay that's good good

686
00:27:23,910 --> 00:27:27,840
advice don't you shouldn't over sit and

687
00:27:25,470 --> 00:27:32,100
don't understand either because that's

688
00:27:27,840 --> 00:27:34,980
that's bad that's bad okay thank you

689
00:27:32,100 --> 00:27:36,899
thank you for that that's fantastic I'm

690
00:27:34,980 --> 00:27:38,640
like I want to try and do better than

691
00:27:36,900 --> 00:27:40,950
that now I'm sure this article in all

692
00:27:38,640 --> 00:27:43,500
fairness like goes into more details I

693
00:27:40,950 --> 00:27:45,300
hope it goes into more details than that

694
00:27:43,500 --> 00:27:47,430
but I wanted to go in a little more

695
00:27:45,300 --> 00:27:49,800
details about network network

696
00:27:47,430 --> 00:27:51,330
segmentation so this is what ID in the

697
00:27:49,800 --> 00:27:53,370
wrong way and this is oftentimes how I

698
00:27:51,330 --> 00:27:56,610
see network segmentation is we take

699
00:27:53,370 --> 00:27:58,560
these blocks of systems and we put them

700
00:27:56,610 --> 00:27:59,129
in their own networks right like you're

701
00:27:58,560 --> 00:28:00,810
not done yet

702
00:27:59,130 --> 00:28:03,480
that's just networking that's about

703
00:28:00,810 --> 00:28:05,340
segmentation and we've got like wireless

704
00:28:03,480 --> 00:28:06,660
networks and remote offices and

705
00:28:05,340 --> 00:28:09,030
conference rooms and Printers in one

706
00:28:06,660 --> 00:28:10,530
segment we got like our Windows stuff in

707
00:28:09,030 --> 00:28:12,840
here like the important stuff like

708
00:28:10,530 --> 00:28:14,820
Active Directory and DNS and DHCP

709
00:28:12,840 --> 00:28:16,889
and then like we had this vulnerable

710
00:28:14,820 --> 00:28:19,049
stuff there was a bunch of stuff that

711
00:28:16,889 --> 00:28:22,428
was just so vulnerable we had to put it

712
00:28:19,049 --> 00:28:25,200
all by itself like put it in the corner

713
00:28:22,429 --> 00:28:26,460
shove it over there like no one will see

714
00:28:25,200 --> 00:28:29,850
this it's fine

715
00:28:26,460 --> 00:28:31,350
and then IT administrator workstations

716
00:28:29,850 --> 00:28:32,309
and then I got like all this Linux stuff

717
00:28:31,350 --> 00:28:33,840
I don't know what to do that so I just

718
00:28:32,309 --> 00:28:35,999
put that in a segment that's good and

719
00:28:33,840 --> 00:28:37,830
then I got like all my user stuff it

720
00:28:35,999 --> 00:28:39,539
desktops and printers right so then I

721
00:28:37,830 --> 00:28:41,668
connect this all the network and I put

722
00:28:39,539 --> 00:28:43,769
it in through a firewall and that

723
00:28:41,669 --> 00:28:45,659
firewall just allows a bunch of stuff in

724
00:28:43,769 --> 00:28:48,990
a bunch of different directions which

725
00:28:45,659 --> 00:28:52,320
means as a pen tester when I was testing

726
00:28:48,990 --> 00:28:54,629
a security company and gotten into one

727
00:28:52,320 --> 00:28:57,509
of their AI networks I was able to

728
00:28:54,629 --> 00:28:59,248
exploit a pathway into their IT

729
00:28:57,509 --> 00:29:02,249
administrator workstations because they

730
00:28:59,249 --> 00:29:03,779
needed that to exist so this is where

731
00:29:02,249 --> 00:29:04,860
people fall down with network segments

732
00:29:03,779 --> 00:29:09,149
because this can get really complicated

733
00:29:04,860 --> 00:29:13,139
right so my suggestion is to simplify

734
00:29:09,149 --> 00:29:15,689
okay and start with something simple I

735
00:29:13,139 --> 00:29:17,699
should have made this box red or some

736
00:29:15,690 --> 00:29:19,289
different color pretend this is a

737
00:29:17,700 --> 00:29:21,629
different color all your user stuff

738
00:29:19,289 --> 00:29:23,309
depth stops and Printers enable the

739
00:29:21,629 --> 00:29:28,199
local firewall on the systems there's

740
00:29:23,309 --> 00:29:30,749
really no need for desktops to be able

741
00:29:28,200 --> 00:29:32,429
to talk to each other we're good we're

742
00:29:30,749 --> 00:29:33,990
good there okay there's no need for

743
00:29:32,429 --> 00:29:37,499
desktops to be able to talk to each

744
00:29:33,990 --> 00:29:39,360
other and killing that lateral movement

745
00:29:37,499 --> 00:29:41,129
right in your user desktop segment

746
00:29:39,360 --> 00:29:42,479
awesome like you're on the way to

747
00:29:41,129 --> 00:29:44,189
network mean it's not really networked

748
00:29:42,480 --> 00:29:47,659
it is segmentations micro segmentation

749
00:29:44,190 --> 00:29:49,080
in that area by all means do that okay

750
00:29:47,659 --> 00:29:51,299
um

751
00:29:49,080 --> 00:29:53,158
don't let anything connect to IT

752
00:29:51,299 --> 00:29:55,710
administrator workstations I mean your

753
00:29:53,159 --> 00:29:59,070
incoming policy for those workstations

754
00:29:55,710 --> 00:30:02,460
should be like scrutinized very very

755
00:29:59,070 --> 00:30:05,759
heavily okay so start there just as your

756
00:30:02,460 --> 00:30:08,039
user accounts in your domain or in you

757
00:30:05,759 --> 00:30:09,720
know Linux that have administrator

758
00:30:08,039 --> 00:30:11,700
access to your entire domain and all of

759
00:30:09,720 --> 00:30:13,889
your systems those accounts should be

760
00:30:11,700 --> 00:30:15,809
protected as well their workstations

761
00:30:13,889 --> 00:30:18,299
should be protected as well you're

762
00:30:15,809 --> 00:30:20,279
vulnerable stuff like don't just hang it

763
00:30:18,299 --> 00:30:22,769
in a different subnet like that's like

764
00:30:20,279 --> 00:30:25,559
my we just pointed that and laugh at the

765
00:30:22,769 --> 00:30:26,700
security subnet you have to actually put

766
00:30:25,559 --> 00:30:29,250
some filtering rules in there

767
00:30:26,700 --> 00:30:31,110
and so they stopped connect to it that

768
00:30:29,250 --> 00:30:33,390
it shooting a printer is a great example

769
00:30:31,110 --> 00:30:35,550
there's like eight million protocols

770
00:30:33,390 --> 00:30:37,170
enabled by default on a printer I don't

771
00:30:35,550 --> 00:30:39,120
know why people need to SCP to the

772
00:30:37,170 --> 00:30:42,900
printer has anyone had a legitimate

773
00:30:39,120 --> 00:30:43,679
reason to FTP to a printer okay that's

774
00:30:42,900 --> 00:30:46,100
what I thought

775
00:30:43,680 --> 00:30:48,000
so why is it open on the firewall

776
00:30:46,100 --> 00:30:49,379
although there has been some research

777
00:30:48,000 --> 00:30:51,180
along those lines recently if people

778
00:30:49,380 --> 00:30:54,900
completely broke printer security which

779
00:30:51,180 --> 00:30:57,930
is interesting but so yeah filter that

780
00:30:54,900 --> 00:31:00,690
very very heavily and then like all your

781
00:30:57,930 --> 00:31:02,730
other stuff wireless networks and remote

782
00:31:00,690 --> 00:31:04,490
offices and conference rooms and more

783
00:31:02,730 --> 00:31:07,500
because there's always more printers

784
00:31:04,490 --> 00:31:10,110
don't let that connect like give them

785
00:31:07,500 --> 00:31:12,870
their own DNS and DHCP treat that as a

786
00:31:10,110 --> 00:31:15,149
separate Network why because Jason's

787
00:31:12,870 --> 00:31:17,159
probably done it a hundred times I did

788
00:31:15,150 --> 00:31:19,020
it when I'm pen testing you walk into

789
00:31:17,160 --> 00:31:20,760
the space the reception this is always

790
00:31:19,020 --> 00:31:22,920
very nice you'd be very pleasant you put

791
00:31:20,760 --> 00:31:24,750
on your Jason smile and she's like you

792
00:31:22,920 --> 00:31:26,460
can go wherever you want it's fine I

793
00:31:24,750 --> 00:31:28,740
don't quite have that I have to work out

794
00:31:26,460 --> 00:31:31,050
a little harder and then I go into the

795
00:31:28,740 --> 00:31:32,340
conference room and then I actually was

796
00:31:31,050 --> 00:31:34,710
actually a Poland poking Pony Express

797
00:31:32,340 --> 00:31:36,570
you plug it into the conference room and

798
00:31:34,710 --> 00:31:38,340
you're like okay see you later

799
00:31:36,570 --> 00:31:41,189
and then you compromise the entire

800
00:31:38,340 --> 00:31:43,290
network like segmentation can help with

801
00:31:41,190 --> 00:31:46,830
that a lot provided you do it

802
00:31:43,290 --> 00:31:48,840
appropriately so okay so this is a

803
00:31:46,830 --> 00:31:51,330
better not saying it's the right way

804
00:31:48,840 --> 00:31:53,730
there are some tips to do some network

805
00:31:51,330 --> 00:31:57,030
segmentation your firewall rules should

806
00:31:53,730 --> 00:31:59,810
restrict more than allow between these

807
00:31:57,030 --> 00:32:02,040
and if you draw these much more simpler

808
00:31:59,810 --> 00:32:04,740
delineations your life will be a lot

809
00:32:02,040 --> 00:32:07,200
easier now if you want to go like full

810
00:32:04,740 --> 00:32:10,470
nack like props to you I mean there's

811
00:32:07,200 --> 00:32:13,080
probably in black of information

812
00:32:10,470 --> 00:32:14,610
security I like I prepper John with

813
00:32:13,080 --> 00:32:16,590
questions he gets really tired of me

814
00:32:14,610 --> 00:32:18,330
asking for statistics like so how many

815
00:32:16,590 --> 00:32:20,490
of your pen tests like have an ax

816
00:32:18,330 --> 00:32:22,379
solution that's built in in it like

817
00:32:20,490 --> 00:32:26,100
really slowed you down he's like like

818
00:32:22,380 --> 00:32:27,720
like 1% less than 1% which is kind of

819
00:32:26,100 --> 00:32:29,639
interesting it just goes to show you how

820
00:32:27,720 --> 00:32:31,710
hard it is to do that in the environment

821
00:32:29,640 --> 00:32:32,520
but that is another solution as well

822
00:32:31,710 --> 00:32:34,080
that can help to this network

823
00:32:32,520 --> 00:32:39,080
segmentation thing and it's something

824
00:32:34,080 --> 00:32:42,360
that slows penetration tester 7 ok

825
00:32:39,080 --> 00:32:44,939
default credentials and I really think

826
00:32:42,360 --> 00:32:46,709
and I kind of have proof that I might be

827
00:32:44,940 --> 00:32:49,470
one of the only people like really truly

828
00:32:46,710 --> 00:32:51,810
thinking about this problem because when

829
00:32:49,470 --> 00:32:54,090
I google search I find my own articles

830
00:32:51,810 --> 00:33:00,659
I'm like no I want to find other

831
00:32:54,090 --> 00:33:02,220
people's articles not my own so I am

832
00:33:00,660 --> 00:33:04,050
thinking about default credentials and

833
00:33:02,220 --> 00:33:06,450
when people think about defaults right

834
00:33:04,050 --> 00:33:09,120
they're like a it's a Linksys wrt54g

835
00:33:06,450 --> 00:33:11,010
router and it's got admin no password or

836
00:33:09,120 --> 00:33:12,090
admin admin and yes we all know it has a

837
00:33:11,010 --> 00:33:14,760
default credential

838
00:33:12,090 --> 00:33:17,550
however default credentials trickle down

839
00:33:14,760 --> 00:33:19,410
into your entire enterprise in fact we

840
00:33:17,550 --> 00:33:21,210
were just interviewing Alex Horne from

841
00:33:19,410 --> 00:33:23,190
an abscess and he said well I say P

842
00:33:21,210 --> 00:33:25,530
systems like pretty much the number one

843
00:33:23,190 --> 00:33:27,180
attack vector is default credentials I'm

844
00:33:25,530 --> 00:33:28,860
like that's interesting they exist on

845
00:33:27,180 --> 00:33:31,440
your printers they exist in other

846
00:33:28,860 --> 00:33:33,719
applications they exist an audio-video

847
00:33:31,440 --> 00:33:36,000
gear because we have some of that in our

848
00:33:33,720 --> 00:33:39,630
studio quite a bit in fact and I got

849
00:33:36,000 --> 00:33:41,430
this really awesome HDMI router I mean

850
00:33:39,630 --> 00:33:42,960
it's a router right so I can take 8

851
00:33:41,430 --> 00:33:45,450
inputs 8 outputs

852
00:33:42,960 --> 00:33:48,960
I was excited about I'm a nerd 8 inputs

853
00:33:45,450 --> 00:33:51,270
8 outputs HDMI comes in I can say that

854
00:33:48,960 --> 00:33:53,430
can go to any number of outputs you can

855
00:33:51,270 --> 00:33:54,930
go to one output or more than one output

856
00:33:53,430 --> 00:33:56,700
like that's awesome

857
00:33:54,930 --> 00:33:58,590
I plug it into the net when it's got a

858
00:33:56,700 --> 00:34:00,690
network port we should plug it in let's

859
00:33:58,590 --> 00:34:02,490
see ok it's got telling it open all

860
00:34:00,690 --> 00:34:03,960
right I'm going to town it to it and

861
00:34:02,490 --> 00:34:07,080
like while I'm doing that look up with

862
00:34:03,960 --> 00:34:08,880
the default oh wait there is no there is

863
00:34:07,080 --> 00:34:10,770
no password well surely there's got to

864
00:34:08,880 --> 00:34:13,260
be a way to set it no there's no way to

865
00:34:10,770 --> 00:34:15,300
set a password I like how why would you

866
00:34:13,260 --> 00:34:17,040
do that now someone can just tell them

867
00:34:15,300 --> 00:34:19,320
that you wouldn rican so that goes to

868
00:34:17,040 --> 00:34:23,070
show you how much security they put in

869
00:34:19,320 --> 00:34:26,910
place and you put thought into for this

870
00:34:23,070 --> 00:34:28,620
particular device so it's kind of

871
00:34:26,909 --> 00:34:30,389
interesting I wrote a script that is a

872
00:34:28,620 --> 00:34:33,060
web interface to let you know them

873
00:34:30,389 --> 00:34:35,370
change the images on all the screens and

874
00:34:33,060 --> 00:34:37,350
all that stuff and I'm like it's going

875
00:34:35,370 --> 00:34:39,060
to be just a lot like a Raspberry Pi is

876
00:34:37,350 --> 00:34:40,560
going to have multiple interfaces and

877
00:34:39,060 --> 00:34:42,360
one's going to go to this device and the

878
00:34:40,560 --> 00:34:43,889
other side is going to connect to the

879
00:34:42,360 --> 00:34:46,140
network like I'm not putting this on the

880
00:34:43,889 --> 00:34:49,560
network and it's sad that we had to make

881
00:34:46,139 --> 00:34:51,659
those so not only kids systems have no

882
00:34:49,560 --> 00:34:52,590
password but I mean default passwords

883
00:34:51,659 --> 00:34:56,810
they can have no path

884
00:34:52,590 --> 00:34:59,310
- in these existing in web applications

885
00:34:56,810 --> 00:35:02,310
all different types of web applications

886
00:34:59,310 --> 00:35:03,900
that attackers attack all the time and

887
00:35:02,310 --> 00:35:05,820
have very well-documented default

888
00:35:03,900 --> 00:35:08,700
passwords that people just leave in

889
00:35:05,820 --> 00:35:11,460
place and the more complex the project

890
00:35:08,700 --> 00:35:13,980
the more likely the contractor comes in

891
00:35:11,460 --> 00:35:15,540
to setup like ASAP for example and it's

892
00:35:13,980 --> 00:35:17,280
like okay you know here it is I've been

893
00:35:15,540 --> 00:35:21,450
here for a year like you're all good I'm

894
00:35:17,280 --> 00:35:22,950
leaving now as the like person being

895
00:35:21,450 --> 00:35:24,930
left with that project you're like you

896
00:35:22,950 --> 00:35:27,089
know we should go change like all the

897
00:35:24,930 --> 00:35:29,279
default passwords and stuff because now

898
00:35:27,090 --> 00:35:31,200
you get to send the person back to fix

899
00:35:29,280 --> 00:35:33,150
which you're going to break by changing

900
00:35:31,200 --> 00:35:35,460
all those passwords so the default

901
00:35:33,150 --> 00:35:38,280
password I think is a a problem on

902
00:35:35,460 --> 00:35:41,820
multiple levels for every single

903
00:35:38,280 --> 00:35:44,610
enterprise that exists today so much so

904
00:35:41,820 --> 00:35:46,950
that once when I was on a pen test that

905
00:35:44,610 --> 00:35:48,990
was awesome when I was looking for AI

906
00:35:46,950 --> 00:35:52,490
low and remote management systems which

907
00:35:48,990 --> 00:35:55,529
still exists today I'm not that old and

908
00:35:52,490 --> 00:35:56,910
you would connect to the device it would

909
00:35:55,530 --> 00:35:58,800
either have a default password or no

910
00:35:56,910 --> 00:36:01,049
password this is the management system

911
00:35:58,800 --> 00:36:02,970
and you'd connect to the console and

912
00:36:01,050 --> 00:36:05,700
someone accidentally left themselves

913
00:36:02,970 --> 00:36:08,009
logged in as root on the console so a

914
00:36:05,700 --> 00:36:10,620
default or non-existent password on your

915
00:36:08,010 --> 00:36:12,120
management system just instantly led to

916
00:36:10,620 --> 00:36:13,560
a root prompt like that was pretty

917
00:36:12,120 --> 00:36:16,830
awesome I wish we could do that all the

918
00:36:13,560 --> 00:36:18,060
time it's a great party trick so the

919
00:36:16,830 --> 00:36:19,710
point is that stuff matters in your

920
00:36:18,060 --> 00:36:22,230
environment and pen testers are going to

921
00:36:19,710 --> 00:36:23,640
find this stuff and I'm like why aren't

922
00:36:22,230 --> 00:36:25,560
we finding this stuff why aren't we

923
00:36:23,640 --> 00:36:28,080
looking in our network for all these

924
00:36:25,560 --> 00:36:32,180
exposures and then I searched high and

925
00:36:28,080 --> 00:36:35,670
low for solutions that would detect

926
00:36:32,180 --> 00:36:37,830
default passwords and I really didn't I

927
00:36:35,670 --> 00:36:40,800
found some my own articles I didn't

928
00:36:37,830 --> 00:36:44,250
really find anyone have suggestions

929
00:36:40,800 --> 00:36:46,230
where do you is there a tool that there

930
00:36:44,250 --> 00:36:51,030
was a lot of ads from a product company

931
00:36:46,230 --> 00:36:53,220
that I saw that was interesting I really

932
00:36:51,030 --> 00:36:55,650
didn't find a good solution to discover

933
00:36:53,220 --> 00:36:58,560
default credentials because here's the

934
00:36:55,650 --> 00:37:02,370
problem you can't just take if you have

935
00:36:58,560 --> 00:37:05,580
a database of 5000 default credentials

936
00:37:02,370 --> 00:37:06,650
and you scan a network if I am NOT

937
00:37:05,580 --> 00:37:09,650
fingerprinting

938
00:37:06,650 --> 00:37:11,330
the device is I have to send all 5,000

939
00:37:09,650 --> 00:37:12,650
of my passwords to that device and

940
00:37:11,330 --> 00:37:16,970
likely it's going to fall over and die

941
00:37:12,650 --> 00:37:19,400
or trip some kind of password threshold

942
00:37:16,970 --> 00:37:20,750
and lock people out of their accounts so

943
00:37:19,400 --> 00:37:22,610
I think that the real problem is not

944
00:37:20,750 --> 00:37:24,350
testing for the credentials

945
00:37:22,610 --> 00:37:26,630
the real problem is who's got the best

946
00:37:24,350 --> 00:37:28,009
technology to identify all of the

947
00:37:26,630 --> 00:37:30,680
devices in my network on an ongoing

948
00:37:28,010 --> 00:37:33,380
basis and then have the hook to know

949
00:37:30,680 --> 00:37:35,930
which of those default passwords to send

950
00:37:33,380 --> 00:37:37,370
to Oracle si P gets these default

951
00:37:35,930 --> 00:37:39,919
passwords Linksys routers get these

952
00:37:37,370 --> 00:37:41,990
default passwords Paul's crappy HTM is

953
00:37:39,920 --> 00:37:44,660
router gets these two oh no way I don't

954
00:37:41,990 --> 00:37:52,160
need it for Paul's crappy HDMI router to

955
00:37:44,660 --> 00:37:54,109
have a question yeah yeah and that's a

956
00:37:52,160 --> 00:37:56,359
manual process and also that's just web

957
00:37:54,110 --> 00:37:58,370
servers yeah and web applications are a

958
00:37:56,360 --> 00:38:02,510
huge culprit of default passwords it

959
00:37:58,370 --> 00:38:06,170
extends beyond that so yeah so you can

960
00:38:02,510 --> 00:38:08,270
use messes to do this and I was like

961
00:38:06,170 --> 00:38:10,370
great there's like two blog articles out

962
00:38:08,270 --> 00:38:12,259
there on using methods to find default

963
00:38:10,370 --> 00:38:16,400
credentials and ID over the first one

964
00:38:12,260 --> 00:38:18,260
I'm like I wrote that and then some I go

965
00:38:16,400 --> 00:38:18,980
to the other one I'm like no I wrote

966
00:38:18,260 --> 00:38:21,410
that one too

967
00:38:18,980 --> 00:38:24,440
so like I'm the only one thinking about

968
00:38:21,410 --> 00:38:26,060
this problem I actually while I was at

969
00:38:24,440 --> 00:38:29,150
temos if we should make this better we

970
00:38:26,060 --> 00:38:30,950
should get people the ability to not

971
00:38:29,150 --> 00:38:32,930
just look for default passwords but my

972
00:38:30,950 --> 00:38:35,419
whole thing was like I think everyone

973
00:38:32,930 --> 00:38:38,450
has like this list of passwords that you

974
00:38:35,420 --> 00:38:41,660
used on everything right like one of the

975
00:38:38,450 --> 00:38:44,870
companies I worked at it was let's just

976
00:38:41,660 --> 00:38:46,310
say it was football okay and you know

977
00:38:44,870 --> 00:38:47,779
the other company work that had this

978
00:38:46,310 --> 00:38:49,910
like this was always the default

979
00:38:47,780 --> 00:38:52,850
password until I said we should change

980
00:38:49,910 --> 00:38:54,620
that but then you get to a router or

981
00:38:52,850 --> 00:38:56,150
switch and you believe the new password

982
00:38:54,620 --> 00:38:59,450
is not working oh that's the old

983
00:38:56,150 --> 00:39:02,360
password so I think in addition to no

984
00:38:59,450 --> 00:39:03,890
authentication default credentials we

985
00:39:02,360 --> 00:39:06,500
run into this problem where we have like

986
00:39:03,890 --> 00:39:08,690
our own list of default passwords that

987
00:39:06,500 --> 00:39:11,330
we have to check for on our network all

988
00:39:08,690 --> 00:39:13,130
the time because if you have 10,000

989
00:39:11,330 --> 00:39:15,650
networking devices you might miss

990
00:39:13,130 --> 00:39:18,020
something so having this technology is

991
00:39:15,650 --> 00:39:20,240
important I don't find that the

992
00:39:18,020 --> 00:39:22,190
commercial products today for volt

993
00:39:20,240 --> 00:39:28,970
ability scanning and is this being

994
00:39:22,190 --> 00:39:32,780
recorded okay so never mind we're moving

995
00:39:28,970 --> 00:39:36,009
right along products today aren't and

996
00:39:32,780 --> 00:39:39,020
set up to handle this particular problem

997
00:39:36,010 --> 00:39:41,030
which is kind of it makes me cry a

998
00:39:39,020 --> 00:39:45,500
little on the inside because no one

999
00:39:41,030 --> 00:39:47,060
wants to tickle me I guess okay so now

1000
00:39:45,500 --> 00:39:49,340
let's move into a little more deception

1001
00:39:47,060 --> 00:39:50,210
right that's what was before us more

1002
00:39:49,340 --> 00:39:53,240
fundamentals

1003
00:39:50,210 --> 00:39:55,760
now it's deception in Canary accounts

1004
00:39:53,240 --> 00:39:57,560
and these are just really this is like

1005
00:39:55,760 --> 00:39:59,060
free like I talked to the commercial

1006
00:39:57,560 --> 00:40:01,400
vendors all the time and they're like

1007
00:39:59,060 --> 00:40:03,680
hey if you buy our product we can make

1008
00:40:01,400 --> 00:40:04,910
all your other products better it

1009
00:40:03,680 --> 00:40:07,040
actually there are products on the

1010
00:40:04,910 --> 00:40:09,290
market that can do that but you're going

1011
00:40:07,040 --> 00:40:11,660
to buy a bunch of products and then

1012
00:40:09,290 --> 00:40:13,430
you're going to buy another product that

1013
00:40:11,660 --> 00:40:15,710
like make all your other products better

1014
00:40:13,430 --> 00:40:17,899
this is like a free thing that you can

1015
00:40:15,710 --> 00:40:20,420
do that'll make your products better and

1016
00:40:17,900 --> 00:40:23,180
essentially it means creating a fake

1017
00:40:20,420 --> 00:40:25,970
account and you know this account and

1018
00:40:23,180 --> 00:40:28,339
this isn't a new thing right but this is

1019
00:40:25,970 --> 00:40:30,319
going to detect when someone's trying to

1020
00:40:28,340 --> 00:40:32,450
send you a phishing campaign and let's

1021
00:40:30,320 --> 00:40:34,040
be honest the number one way pen testers

1022
00:40:32,450 --> 00:40:36,169
are getting in is where the phishing

1023
00:40:34,040 --> 00:40:38,900
campaign unless Jason streets onto your

1024
00:40:36,170 --> 00:40:42,260
desk that sounds really bad nevermind

1025
00:40:38,900 --> 00:40:44,450
okay so you then you monitor this email

1026
00:40:42,260 --> 00:40:46,610
for spam or other activity you monitor

1027
00:40:44,450 --> 00:40:48,439
the domain account for any activity

1028
00:40:46,610 --> 00:40:50,660
right like if it hasn't got an email

1029
00:40:48,440 --> 00:40:53,270
it's someone using it to log in someone

1030
00:40:50,660 --> 00:40:55,310
is it in the logs anywhere there

1031
00:40:53,270 --> 00:40:57,259
shouldn't be any activity with this

1032
00:40:55,310 --> 00:40:59,779
account because it's not associated with

1033
00:40:57,260 --> 00:41:07,930
a real person at all

1034
00:40:59,780 --> 00:41:07,930
yeah good Jason yeah

1035
00:41:22,189 --> 00:41:28,199
gotcha did everyone hear that okay yeah

1036
00:41:26,549 --> 00:41:34,169
to create a domain admin account it said

1037
00:41:28,199 --> 00:41:36,509
to login hours yeah

1038
00:41:34,169 --> 00:41:38,939
log make sure you said login hours to

1039
00:41:36,509 --> 00:41:40,469
zero on a fake domain admin account that

1040
00:41:38,939 --> 00:41:42,269
has the password in the description and

1041
00:41:40,469 --> 00:41:44,609
then monitor for when someone tries to

1042
00:41:42,269 --> 00:41:45,988
log in so okay that's good I'm glad my

1043
00:41:44,609 --> 00:41:47,609
tactic is validated because there I

1044
00:41:45,989 --> 00:41:50,369
don't find a lot written about this

1045
00:41:47,609 --> 00:41:52,499
today five minutes okay so we're moving

1046
00:41:50,369 --> 00:41:55,769
on to the next topic which is creating

1047
00:41:52,499 --> 00:41:57,718
fake LinkedIn accounts now you can go

1048
00:41:55,769 --> 00:41:59,968
crazy with this right because fishing is

1049
00:41:57,719 --> 00:42:02,609
popular LinkedIn is the most popular one

1050
00:41:59,969 --> 00:42:05,849
so what I did was I'd read an article

1051
00:42:02,609 --> 00:42:08,640
about how to create fake LinkedIn

1052
00:42:05,849 --> 00:42:11,339
account or spot fake LinkedIn accounts

1053
00:42:08,640 --> 00:42:12,868
and then I wrote these tips so like this

1054
00:42:11,339 --> 00:42:14,249
is how you create a fake LinkedIn

1055
00:42:12,869 --> 00:42:17,309
account so people don't know that it's

1056
00:42:14,249 --> 00:42:19,259
fake so much because if you put fake

1057
00:42:17,309 --> 00:42:21,299
LinkedIn and Google like all you get is

1058
00:42:19,259 --> 00:42:23,489
how to spot fake legs in accounts I'm

1059
00:42:21,299 --> 00:42:24,989
like no no I want to know how to create

1060
00:42:23,489 --> 00:42:27,239
them and they're like well here's how

1061
00:42:24,989 --> 00:42:28,679
you create them to like span people I'm

1062
00:42:27,239 --> 00:42:30,509
like no I want to know how to create

1063
00:42:28,679 --> 00:42:32,489
them so it looks like a legit user in my

1064
00:42:30,509 --> 00:42:36,119
organization so I came up with my own

1065
00:42:32,489 --> 00:42:38,999
list now be careful with stock photos

1066
00:42:36,119 --> 00:42:40,949
because those can be traced use your

1067
00:42:38,999 --> 00:42:44,098
real email address that points to your

1068
00:42:40,949 --> 00:42:45,749
honeypot account have other co-workers

1069
00:42:44,099 --> 00:42:47,219
or people recommend the profile I mean

1070
00:42:45,749 --> 00:42:49,198
we can really get out of control here

1071
00:42:47,219 --> 00:42:50,640
right they create other social media

1072
00:42:49,199 --> 00:42:52,349
accounts you're basically want to create

1073
00:42:50,640 --> 00:42:53,939
a fake presence now the danger is and

1074
00:42:52,349 --> 00:42:56,339
why I don't think more people do this is

1075
00:42:53,939 --> 00:42:58,649
once it's been discovered you have to

1076
00:42:56,339 --> 00:43:00,749
start over completely and that stuff can

1077
00:42:58,650 --> 00:43:05,069
be a lot of work to make it look truly

1078
00:43:00,749 --> 00:43:06,538
fake so no I would definitely talk to

1079
00:43:05,069 --> 00:43:08,400
you every time I give a talk on

1080
00:43:06,539 --> 00:43:10,259
offensive countermeasures of or active

1081
00:43:08,400 --> 00:43:12,089
defense of some kind everyone always has

1082
00:43:10,259 --> 00:43:13,559
that comment I am NOT a lawyer you

1083
00:43:12,089 --> 00:43:14,909
should talk to your lawyer before you do

1084
00:43:13,559 --> 00:43:18,079
anything I say because I don't want to

1085
00:43:14,909 --> 00:43:18,079
be held responsible yes

1086
00:43:19,150 --> 00:43:24,289
what is your title Jason network

1087
00:43:21,710 --> 00:43:26,740
security Ranger or something InfoSec

1088
00:43:24,289 --> 00:43:29,180
Ranger something like that something fun

1089
00:43:26,740 --> 00:43:30,950
or something related to a business

1090
00:43:29,180 --> 00:43:33,200
function could be fine I think you know

1091
00:43:30,950 --> 00:43:34,669
title really doesn't matter I don't

1092
00:43:33,200 --> 00:43:36,919
think they're really going to discover

1093
00:43:34,670 --> 00:43:38,960
it's fake because of a title more so

1094
00:43:36,920 --> 00:43:43,160
like they Google image search your image

1095
00:43:38,960 --> 00:43:46,279
and it's a stock image yes

1096
00:43:43,160 --> 00:43:47,930
exactly yeah I love to open word

1097
00:43:46,279 --> 00:43:50,599
attachments should be somewhere in their

1098
00:43:47,930 --> 00:43:53,058
social network profile okay darkness are

1099
00:43:50,599 --> 00:43:54,890
also not a new thing you define a knock

1100
00:43:53,059 --> 00:43:57,440
you submit not in use you had some

1101
00:43:54,890 --> 00:43:59,180
routes to it you put a sniffer on it or

1102
00:43:57,440 --> 00:44:01,819
I used to actually monitor my document

1103
00:43:59,180 --> 00:44:03,740
with NetFlow that works too and don't

1104
00:44:01,819 --> 00:44:05,569
don't put live systems on your dark net

1105
00:44:03,740 --> 00:44:07,578
that's bad people the whole point is

1106
00:44:05,569 --> 00:44:09,349
that there are no live systems on your

1107
00:44:07,579 --> 00:44:11,839
dark net its IP space that you're not

1108
00:44:09,349 --> 00:44:16,190
using there's a great article in there

1109
00:44:11,839 --> 00:44:17,690
as well okay now but the dark end is

1110
00:44:16,190 --> 00:44:19,970
just a foundation to do some of the

1111
00:44:17,690 --> 00:44:22,369
other deceptive things you want some

1112
00:44:19,970 --> 00:44:24,709
HTTP redirects right you want something

1113
00:44:22,369 --> 00:44:26,390
in your robots.txt that magically

1114
00:44:24,710 --> 00:44:27,920
redirects them into your dark net so you

1115
00:44:26,390 --> 00:44:29,058
know when people are curious and going

1116
00:44:27,920 --> 00:44:31,009
where they think they shouldn't be going

1117
00:44:29,059 --> 00:44:33,170
you're collecting it you want to put

1118
00:44:31,009 --> 00:44:34,759
some fake DNS entries DNS names that

1119
00:44:33,170 --> 00:44:37,069
don't exist in your environment but

1120
00:44:34,759 --> 00:44:39,470
point to fake IP addresses in your

1121
00:44:37,069 --> 00:44:41,808
doctor same with file servers also word

1122
00:44:39,470 --> 00:44:43,970
macros that just ping back to your dark

1123
00:44:41,809 --> 00:44:46,190
net so if you put a macro or some other

1124
00:44:43,970 --> 00:44:48,288
kind of call back lots of ways to do

1125
00:44:46,190 --> 00:44:50,720
that in Microsoft Word inside of your

1126
00:44:48,289 --> 00:44:52,940
word document that just sends a ping

1127
00:44:50,720 --> 00:44:55,038
request into your dark net you'll know

1128
00:44:52,940 --> 00:44:57,230
that someone has opened this document

1129
00:44:55,039 --> 00:45:00,259
that is fake you know maybe you say it's

1130
00:44:57,230 --> 00:45:01,880
SSN dot doc and you'll know when someone

1131
00:45:00,259 --> 00:45:03,769
opens it and put fake social security

1132
00:45:01,880 --> 00:45:05,450
numbers in there okay so that's the

1133
00:45:03,769 --> 00:45:08,209
deception technology kind of drive

1134
00:45:05,450 --> 00:45:09,618
traffic to your dark net as always in my

1135
00:45:08,210 --> 00:45:11,779
strategy it's a blending of the

1136
00:45:09,619 --> 00:45:15,130
deception I've talked about before with

1137
00:45:11,779 --> 00:45:17,809
some of the darknet stuff okay now

1138
00:45:15,130 --> 00:45:19,789
monitoring the darknet like I said net

1139
00:45:17,809 --> 00:45:22,309
flow and darkness should then be

1140
00:45:19,789 --> 00:45:24,460
integrated into your sim so that it's

1141
00:45:22,309 --> 00:45:26,359
giving you context into your other

1142
00:45:24,460 --> 00:45:30,230
monitoring tools whether it's sim

1143
00:45:26,359 --> 00:45:32,840
security intelligence big data

1144
00:45:30,230 --> 00:45:33,500
learning artificial you know what I'm

1145
00:45:32,840 --> 00:45:35,150
talking about

1146
00:45:33,500 --> 00:45:36,859
all those buzzwords whatever you're

1147
00:45:35,150 --> 00:45:37,160
using you should integrate it to make it

1148
00:45:36,859 --> 00:45:41,779
better

1149
00:45:37,160 --> 00:45:42,950
okay now analyze network traffic I don't

1150
00:45:41,780 --> 00:45:44,570
know why that image is there but I

1151
00:45:42,950 --> 00:45:46,129
thought it was really funny it has

1152
00:45:44,570 --> 00:45:47,990
absolutely no meaning to this topic

1153
00:45:46,130 --> 00:45:48,470
whatsoever other than I thought it was

1154
00:45:47,990 --> 00:45:50,839
funny

1155
00:45:48,470 --> 00:45:52,220
bask in the glory of its outstanding

1156
00:45:50,840 --> 00:45:56,660
humor okay

1157
00:45:52,220 --> 00:45:58,640
next slide so math is easy and math

1158
00:45:56,660 --> 00:46:00,589
really isn't easy but when John strand

1159
00:45:58,640 --> 00:46:02,569
explained it to me this is how we look

1160
00:46:00,590 --> 00:46:04,040
at outgoing traffic inside of a network

1161
00:46:02,570 --> 00:46:05,840
in our open source and commercial

1162
00:46:04,040 --> 00:46:06,980
product that we're doing this is

1163
00:46:05,840 --> 00:46:08,960
completely open source

1164
00:46:06,980 --> 00:46:11,300
it's called Rita you can go download it

1165
00:46:08,960 --> 00:46:12,350
so here's what we do very quickly

1166
00:46:11,300 --> 00:46:15,280
because I probably have about two

1167
00:46:12,350 --> 00:46:18,920
minutes left we look at four different

1168
00:46:15,280 --> 00:46:20,990
criteria of the outgoing packets right

1169
00:46:18,920 --> 00:46:24,470
these are packets leaving your network

1170
00:46:20,990 --> 00:46:27,379
we look at the connection time how long

1171
00:46:24,470 --> 00:46:29,480
was a session established between these

1172
00:46:27,380 --> 00:46:31,520
two hosts and we start drawing some plot

1173
00:46:29,480 --> 00:46:32,900
lines and we're like hey you know like

1174
00:46:31,520 --> 00:46:34,850
this hose in your internal network has

1175
00:46:32,900 --> 00:46:36,800
it's like cluster here and it was

1176
00:46:34,850 --> 00:46:40,490
contacting the same host on the internet

1177
00:46:36,800 --> 00:46:42,470
with the same time of connections and

1178
00:46:40,490 --> 00:46:45,410
it's plotted here and that's interesting

1179
00:46:42,470 --> 00:46:47,089
then we look at connection interval how

1180
00:46:45,410 --> 00:46:49,040
many different it was at once a day was

1181
00:46:47,090 --> 00:46:51,380
it every hour was it every 10 seconds

1182
00:46:49,040 --> 00:46:53,990
what was the interval and we plot the

1183
00:46:51,380 --> 00:46:56,630
interval using some super fancy smart

1184
00:46:53,990 --> 00:46:58,189
math machine learning type stuff and we

1185
00:46:56,630 --> 00:47:00,020
say okay well the connection interval

1186
00:46:58,190 --> 00:47:01,850
for this internal host of that external

1187
00:47:00,020 --> 00:47:03,410
host has a grouping like that your

1188
00:47:01,850 --> 00:47:05,299
groupings are never going to be perfect

1189
00:47:03,410 --> 00:47:07,069
in a network there is jitter you're

1190
00:47:05,300 --> 00:47:08,210
always going to have some like

1191
00:47:07,070 --> 00:47:10,010
scattering but you're gonna look at

1192
00:47:08,210 --> 00:47:12,590
groupings then we look at the number of

1193
00:47:10,010 --> 00:47:14,930
packets well in the 24-hour period this

1194
00:47:12,590 --> 00:47:17,180
host like the connection time was always

1195
00:47:14,930 --> 00:47:19,279
roughly the same the connection interval

1196
00:47:17,180 --> 00:47:20,779
was roughly the same and the number of

1197
00:47:19,280 --> 00:47:23,630
packets at send in that 24 hour period

1198
00:47:20,780 --> 00:47:25,550
was also roughly the same and then the

1199
00:47:23,630 --> 00:47:28,190
size of all those packets were the same

1200
00:47:25,550 --> 00:47:30,800
and if all those factors match up we

1201
00:47:28,190 --> 00:47:32,240
call the host infected okay now what's

1202
00:47:30,800 --> 00:47:35,030
interesting is you also see this green

1203
00:47:32,240 --> 00:47:35,750
is infected as well if in a 24-hour

1204
00:47:35,030 --> 00:47:38,780
period

1205
00:47:35,750 --> 00:47:40,730
I had one connection from an internal

1206
00:47:38,780 --> 00:47:43,890
host of one connection in an external

1207
00:47:40,730 --> 00:47:46,440
host my number of packets was like one

1208
00:47:43,890 --> 00:47:48,538
in my connection interval was really

1209
00:47:46,440 --> 00:47:49,200
short or really long or stood out in

1210
00:47:48,539 --> 00:47:51,299
some way

1211
00:47:49,200 --> 00:47:52,230
you're also compromised actually this is

1212
00:47:51,299 --> 00:47:54,089
how we found malware in a lot of

1213
00:47:52,230 --> 00:47:56,910
organizations it's just looking at the

1214
00:47:54,089 --> 00:47:58,319
outliers inside of our data the other

1215
00:47:56,910 --> 00:47:58,618
ones that are scattered all over the

1216
00:47:58,319 --> 00:48:00,569
place

1217
00:47:58,619 --> 00:48:02,309
that's normal traffic right when you go

1218
00:48:00,569 --> 00:48:05,999
to Google when you browse the web and do

1219
00:48:02,309 --> 00:48:07,230
other things it's pretty random so we

1220
00:48:05,999 --> 00:48:10,078
distribute this as a free open-source

1221
00:48:07,230 --> 00:48:11,670
tool called rita we regularly do web

1222
00:48:10,079 --> 00:48:13,440
cast on it and talk about it in more

1223
00:48:11,670 --> 00:48:15,569
detail at conferences you need bro logs

1224
00:48:13,440 --> 00:48:17,910
in order to do it bro is completely free

1225
00:48:15,569 --> 00:48:20,279
Rita is completely free you can go to

1226
00:48:17,910 --> 00:48:22,828
that URL you can download it you can

1227
00:48:20,279 --> 00:48:24,359
analyze your traffic the exact same way

1228
00:48:22,829 --> 00:48:26,849
that I just showed you in the previous

1229
00:48:24,359 --> 00:48:29,400
graph except it'll look like that I

1230
00:48:26,849 --> 00:48:32,789
believe it has column headings now but

1231
00:48:29,400 --> 00:48:34,470
that's basically that those are all

1232
00:48:32,789 --> 00:48:35,819
those numbers that correspond to

1233
00:48:34,470 --> 00:48:38,038
connection time and interval and all

1234
00:48:35,819 --> 00:48:39,749
that other stuff and this right here is

1235
00:48:38,039 --> 00:48:43,019
a confidence score that we built for you

1236
00:48:39,749 --> 00:48:43,769
so we're 99% sure that that IP address

1237
00:48:43,019 --> 00:48:46,859
right there

1238
00:48:43,769 --> 00:48:50,970
was compromised okay so that's kind of

1239
00:48:46,859 --> 00:48:53,940
fun in a way to detect attackers bonus

1240
00:48:50,970 --> 00:48:55,950
tip communication rather than phrasing

1241
00:48:53,940 --> 00:48:58,200
your question it's your statement to

1242
00:48:55,950 --> 00:49:00,598
your Active Directory or other teams you

1243
00:48:58,200 --> 00:49:02,999
must secure a patch harden all these

1244
00:49:00,599 --> 00:49:05,009
things or else say how can I help you do

1245
00:49:02,999 --> 00:49:07,348
your job more efficiently phrase it as

1246
00:49:05,009 --> 00:49:15,710
you're helping not making them do

1247
00:49:07,349 --> 00:49:15,710
something ok and that's it thank you

1248
00:49:18,750 --> 00:49:23,580
I put that in there cuz that's really

1249
00:49:23,250 --> 00:49:32,730
funny

1250
00:49:23,580 --> 00:49:35,598
defense kind of graphic okay I think is

1251
00:49:32,730 --> 00:49:35,599
there another talking here

