1
00:00:00,589 --> 00:00:12,920
helps if I turn this on first so we have

2
00:00:13,309 --> 00:00:19,350
we have David Kennedy he is the founder

3
00:00:16,079 --> 00:00:21,448
of trusted SEC LLC and he's also the

4
00:00:19,350 --> 00:00:24,630
co-founder and CTO of binary defense

5
00:00:21,449 --> 00:00:27,930
systems Dave had guest appearances on

6
00:00:24,630 --> 00:00:31,759
Fox News CNN in other high-profile media

7
00:00:27,930 --> 00:00:33,840
outlets such as the Katie Couric show

8
00:00:31,759 --> 00:00:38,030
where he was dubbed the sexiest man

9
00:00:33,840 --> 00:00:38,030
alive I can't disagree

10
00:00:38,600 --> 00:00:42,450
Dave's also the founder of derbycon a

11
00:00:40,920 --> 00:00:43,860
large-scale security conference in

12
00:00:42,450 --> 00:00:46,340
Louisville Kentucky I'm sure many of you

13
00:00:43,860 --> 00:00:49,050
have been to it if you haven't please do

14
00:00:46,340 --> 00:00:50,730
dave also co-authored Metasploit the

15
00:00:49,050 --> 00:00:52,709
penetration testers guidebook which was

16
00:00:50,730 --> 00:00:55,078
number one on amazon.com security for

17
00:00:52,710 --> 00:00:56,399
over six months david's also one of the

18
00:00:55,079 --> 00:00:59,129
founding members of the penetration

19
00:00:56,399 --> 00:01:01,289
testing execution standard and i also

20
00:00:59,129 --> 00:01:07,289
asked for quotes about dave from some of

21
00:01:01,289 --> 00:01:08,700
his friends Paul comm of security weekly

22
00:01:07,290 --> 00:01:11,790
had a few choice things to say but I

23
00:01:08,700 --> 00:01:14,130
kind of kept it clean for the hour Dave

24
00:01:11,790 --> 00:01:15,509
defined the serious hacking day for me

25
00:01:14,130 --> 00:01:19,949
which I think has something to do with

26
00:01:15,509 --> 00:01:22,590
bucks and watches that's Paul and Dave

27
00:01:19,950 --> 00:01:25,619
loves his box so Dave is also the

28
00:01:22,590 --> 00:01:27,720
creator of the severely sorry soap of

29
00:01:25,619 --> 00:01:30,659
several widely popular open-source tools

30
00:01:27,720 --> 00:01:33,119
including these social engineers toolkit

31
00:01:30,659 --> 00:01:35,490
and many more who's ever used set the

32
00:01:33,119 --> 00:01:37,110
social engineers toolkit awesome that's

33
00:01:35,490 --> 00:01:39,649
good to say but if you ever read the

34
00:01:37,110 --> 00:01:43,220
terms and conditions

35
00:01:39,650 --> 00:01:45,740
it's kind of important if you've never

36
00:01:43,220 --> 00:01:47,780
read it it says also note that by using

37
00:01:45,740 --> 00:01:49,100
the software if you ever see the creator

38
00:01:47,780 --> 00:01:51,230
of set in a bar you should give him a

39
00:01:49,100 --> 00:02:04,280
hug and should buy him a beer and a

40
00:01:51,230 --> 00:02:06,080
bourbon I don't have a beer but lastly

41
00:02:04,280 --> 00:02:09,289
Dave was a US Marine

42
00:02:06,080 --> 00:02:15,800
thank you for service working for the

43
00:02:09,289 --> 00:02:18,140
intelligence community and spent several

44
00:02:15,800 --> 00:02:20,900
years in the Middle East including Iraq

45
00:02:18,140 --> 00:02:30,649
I am proud and honored to introduce our

46
00:02:20,900 --> 00:02:32,830
keynote speaker Dave Kennedy Wow how do

47
00:02:30,650 --> 00:02:32,830
I uh

48
00:02:48,660 --> 00:02:54,069
all right well thank you everybody for

49
00:02:51,220 --> 00:02:55,600
coming on a Saturday morning to come

50
00:02:54,069 --> 00:02:57,730
hear me talk and a lot of other great

51
00:02:55,600 --> 00:03:00,069
speakers here today hopefully you get to

52
00:02:57,730 --> 00:03:02,079
see a lot of great great talks the list

53
00:03:00,069 --> 00:03:04,149
here is absolutely amazing but after

54
00:03:02,080 --> 00:03:05,860
warning I lost my voice two days ago and

55
00:03:04,150 --> 00:03:07,420
it came back slightly yesterday and this

56
00:03:05,860 --> 00:03:08,680
morning got worse but it actually sounds

57
00:03:07,420 --> 00:03:10,208
like it got a little bit better so we'll

58
00:03:08,680 --> 00:03:12,550
play with it and see how it goes but my

59
00:03:10,209 --> 00:03:14,770
son brought home the plague and

60
00:03:12,550 --> 00:03:16,360
literally destroyed our entire household

61
00:03:14,770 --> 00:03:18,610
so I got back from Hong Kong on Monday

62
00:03:16,360 --> 00:03:19,870
attacked like Jason Street was right

63
00:03:18,610 --> 00:03:20,800
there a Jason this Jason's tree right

64
00:03:19,870 --> 00:03:26,920
there right making brown applause for

65
00:03:20,800 --> 00:03:29,650
Jason he hates that he hates that that's

66
00:03:26,920 --> 00:03:30,850
I waited I got back from Hong Kong on

67
00:03:29,650 --> 00:03:32,170
Monday and actually as I was getting the

68
00:03:30,850 --> 00:03:34,209
Hong Kong Jason was flying away from

69
00:03:32,170 --> 00:03:36,280
Hong Kong but my son went on a Cub Scout

70
00:03:34,209 --> 00:03:38,230
thing and they went to a naval vessel to

71
00:03:36,280 --> 00:03:39,640
kind of see the naval vessels when they

72
00:03:38,230 --> 00:03:41,109
got home everybody that went on the Cub

73
00:03:39,640 --> 00:03:43,179
Scout Pack was completely definitely

74
00:03:41,110 --> 00:03:44,319
sick including my dad who took them and

75
00:03:43,180 --> 00:03:47,800
then killed her a whole household so

76
00:03:44,319 --> 00:03:51,399
that was wonderful but we were glad to

77
00:03:47,800 --> 00:03:56,440
be here glad to be in Boston go Cavs so

78
00:03:51,400 --> 00:03:58,540
I made the mistake I didn't realize

79
00:03:56,440 --> 00:04:00,670
where I was going yesterday today and I

80
00:03:58,540 --> 00:04:01,900
wore the Cleveland shirt you know big

81
00:04:00,670 --> 00:04:03,730
cap sure I went down to the bar

82
00:04:01,900 --> 00:04:04,989
yesterday go get a drink and I literally

83
00:04:03,730 --> 00:04:08,018
got stopped like eight people that

84
00:04:04,989 --> 00:04:08,290
weren't happy with me so we'll see how

85
00:04:08,019 --> 00:04:10,720
it goes

86
00:04:08,290 --> 00:04:12,970
good luck I don't need to go through any

87
00:04:10,720 --> 00:04:15,430
of the bouts but what I'm talking about

88
00:04:12,970 --> 00:04:17,019
today is you know if you look at at what

89
00:04:15,430 --> 00:04:18,640
we're dealing with in information

90
00:04:17,019 --> 00:04:19,930
security there's a lot of different

91
00:04:18,640 --> 00:04:20,769
things I mean obviously everybody's been

92
00:04:19,930 --> 00:04:22,630
seeing a lot of what's been happening

93
00:04:20,769 --> 00:04:23,650
with the whole shadow brokers dump and

94
00:04:22,630 --> 00:04:24,729
I'll talk a little about that I was

95
00:04:23,650 --> 00:04:26,710
actually up till two o'clock in the

96
00:04:24,729 --> 00:04:28,539
morning getting a remote code execution

97
00:04:26,710 --> 00:04:29,500
working with our own custom payload so

98
00:04:28,539 --> 00:04:31,240
I'll show you how to do that here in

99
00:04:29,500 --> 00:04:32,919
this a little bit but what was

100
00:04:31,240 --> 00:04:34,930
interesting what we see out there is

101
00:04:32,919 --> 00:04:36,849
this industry has a lot of things coming

102
00:04:34,930 --> 00:04:38,080
at it a lot of different attack vectors

103
00:04:36,850 --> 00:04:41,169
everything from fishing all the way to

104
00:04:38,080 --> 00:04:43,210
zero days and it's really difficult for

105
00:04:41,169 --> 00:04:45,490
us in companies to get a handle around

106
00:04:43,210 --> 00:04:47,080
what we need to do and a lot of the

107
00:04:45,490 --> 00:04:49,660
technology a lot of Defense's that we

108
00:04:47,080 --> 00:04:51,400
build are real generic in nature to stop

109
00:04:49,660 --> 00:04:52,570
some of the most basic of things but

110
00:04:51,400 --> 00:04:53,799
they don't look for a lot of the

111
00:04:52,570 --> 00:04:56,740
patterns of behavior that we do as

112
00:04:53,800 --> 00:04:58,900
attackers and as an attacker going into

113
00:04:56,740 --> 00:05:00,760
you know countless organizations most of

114
00:04:58,900 --> 00:05:01,310
the stuff that is built is literally for

115
00:05:00,760 --> 00:05:03,080
off the show

116
00:05:01,310 --> 00:05:05,360
you know what you can download from the

117
00:05:03,080 --> 00:05:07,340
internet good example is PowerShell a

118
00:05:05,360 --> 00:05:09,710
lot of people flag on encoded command

119
00:05:07,340 --> 00:05:11,060
for a PowerShell flag there's 12

120
00:05:09,710 --> 00:05:12,409
different iterations of encoder

121
00:05:11,060 --> 00:05:13,850
community here's a call and coded

122
00:05:12,410 --> 00:05:16,010
command in order to get power sucks

123
00:05:13,850 --> 00:05:17,810
execution so some of the things that I

124
00:05:16,010 --> 00:05:18,860
just see commonly in the industry some

125
00:05:17,810 --> 00:05:20,420
things that can hopefully help you out

126
00:05:18,860 --> 00:05:24,290
with but also show you some cool hacks

127
00:05:20,420 --> 00:05:26,750
along the way and so first how about

128
00:05:24,290 --> 00:05:27,860
them leaks that happen right

129
00:05:26,750 --> 00:05:29,540
so if you're not familiar with what

130
00:05:27,860 --> 00:05:32,930
leaks happened over as of yesterday

131
00:05:29,540 --> 00:05:34,070
actually happened last night the leak

132
00:05:32,930 --> 00:05:35,630
should be no surprise and I'll talk

133
00:05:34,070 --> 00:05:37,130
about what the leaks are here in just a

134
00:05:35,630 --> 00:05:38,810
second but the link should be no

135
00:05:37,130 --> 00:05:40,010
surprise I'll contain a mixture of 0

136
00:05:38,810 --> 00:05:42,560
days as well as already patched

137
00:05:40,010 --> 00:05:43,880
vulnerabilities that are out there but

138
00:05:42,560 --> 00:05:45,530
what was interesting to see is that you

139
00:05:43,880 --> 00:05:47,420
know a lot of these countries including

140
00:05:45,530 --> 00:05:48,919
ourselves have capabilities of 0 dates

141
00:05:47,420 --> 00:05:50,690
as we've been saying for years and years

142
00:05:48,920 --> 00:05:52,220
and years and years so there's no real

143
00:05:50,690 --> 00:05:55,070
surprise on what our capabilities are

144
00:05:52,220 --> 00:05:56,450
who they are and what they're doing the

145
00:05:55,070 --> 00:05:58,190
interesting thing though is that we just

146
00:05:56,450 --> 00:06:00,440
didn't expect a large leak like this all

147
00:05:58,190 --> 00:06:01,760
at once or now we have a whole stash of

148
00:06:00,440 --> 00:06:03,290
code they have to go through and a lot

149
00:06:01,760 --> 00:06:04,909
of it's actually executable so we have

150
00:06:03,290 --> 00:06:07,220
to disassemble reverse-engineer how it's

151
00:06:04,910 --> 00:06:08,630
working do packet packet dumps already a

152
00:06:07,220 --> 00:06:10,970
lot of research going into that in fact

153
00:06:08,630 --> 00:06:13,460
as of like five minutes ago I think we

154
00:06:10,970 --> 00:06:17,390
just got our Python prototype done for

155
00:06:13,460 --> 00:06:18,919
the latest it's a mess 1710 which is

156
00:06:17,390 --> 00:06:20,900
remote code execution and SMB version

157
00:06:18,920 --> 00:06:22,610
one for all versions of Windows so

158
00:06:20,900 --> 00:06:24,380
that's a fantastic one it's MSO a 2 6 7

159
00:06:22,610 --> 00:06:26,630
on steroids I'm sorry I think it's

160
00:06:24,380 --> 00:06:28,190
Windows 8 1 but it also reported to

161
00:06:26,630 --> 00:06:29,870
Windows 10 which is fantastic so it's

162
00:06:28,190 --> 00:06:33,670
the next MSO 86 7 so we can all

163
00:06:29,870 --> 00:06:33,670
celebrate for like the next 9 years so

164
00:06:34,820 --> 00:06:38,640
we can have birthday cakes and

165
00:06:36,870 --> 00:06:39,990
everything else made for MST I wish you

166
00:06:38,640 --> 00:06:42,659
wouldn't have been amazing like the

167
00:06:39,990 --> 00:06:43,920
world aligning if it had been ms70 no 67

168
00:06:42,660 --> 00:06:45,360
I mean it would just would have been I

169
00:06:43,920 --> 00:06:48,270
would have I would have just I could

170
00:06:45,360 --> 00:06:50,550
have died happy so but if you're not

171
00:06:48,270 --> 00:06:52,109
familiar what's happening you know the

172
00:06:50,550 --> 00:06:53,160
Shadow Broker is is loosely attributed

173
00:06:52,110 --> 00:06:55,350
or attributed to Russia

174
00:06:53,160 --> 00:06:56,550
okay the equation group has been loosely

175
00:06:55,350 --> 00:06:58,440
attributed to the NSA

176
00:06:56,550 --> 00:06:59,970
Kaspersky was one of the first ones but

177
00:06:58,440 --> 00:07:01,200
you know I've tied it back the Stuxnet a

178
00:06:59,970 --> 00:07:03,270
lot of the other components where we

179
00:07:01,200 --> 00:07:05,550
kind of become public and a lot of our

180
00:07:03,270 --> 00:07:07,169
offensive capabilities and so what's

181
00:07:05,550 --> 00:07:09,000
been happening lately is that and what

182
00:07:07,170 --> 00:07:11,250
the shadow brokers claim which seems to

183
00:07:09,000 --> 00:07:13,830
align up is that the equation group ie

184
00:07:11,250 --> 00:07:15,870
the NSA was conducting operations abroad

185
00:07:13,830 --> 00:07:17,729
including compromising a large

186
00:07:15,870 --> 00:07:19,140
percentage of the Swift Network for the

187
00:07:17,730 --> 00:07:20,670
banking transactions and the financial

188
00:07:19,140 --> 00:07:22,409
backbones to monitor transactions

189
00:07:20,670 --> 00:07:24,960
intelligence gaining purposes

190
00:07:22,410 --> 00:07:27,030
things like that and what Russia did is

191
00:07:24,960 --> 00:07:28,650
they identified where the equation group

192
00:07:27,030 --> 00:07:30,179
is coming from and by way I'm not going

193
00:07:28,650 --> 00:07:31,260
to talk about anything classified so if

194
00:07:30,180 --> 00:07:32,790
you're in the military don't worry I'm

195
00:07:31,260 --> 00:07:34,760
not going to start seeing any TSS CI

196
00:07:32,790 --> 00:07:37,320
stuff then you have to leave the room so

197
00:07:34,760 --> 00:07:38,580
I'll make sure not to go to any

198
00:07:37,320 --> 00:07:40,440
classified information that's been

199
00:07:38,580 --> 00:07:43,200
leaked because you still are subject to

200
00:07:40,440 --> 00:07:44,820
that but what the shadow brokers ended

201
00:07:43,200 --> 00:07:46,860
up doing was tracing back the

202
00:07:44,820 --> 00:07:49,650
infrastructure that the NSA was using to

203
00:07:46,860 --> 00:07:51,000
conduct operations abroad and so they

204
00:07:49,650 --> 00:07:53,729
actually hacked the infrastructure that

205
00:07:51,000 --> 00:07:55,740
the NSA was using and and stole a large

206
00:07:53,730 --> 00:07:57,270
percentage of their tools so we saw a

207
00:07:55,740 --> 00:07:59,460
couple weeks ago that the Shadow Broker

208
00:07:57,270 --> 00:08:02,219
dump was actually released they had put

209
00:07:59,460 --> 00:08:03,419
it up on a dark red for auction for a

210
00:08:02,220 --> 00:08:05,040
significant amount of money I think was

211
00:08:03,419 --> 00:08:06,810
like like fifty million dollars or

212
00:08:05,040 --> 00:08:09,510
something crazy and then literally as

213
00:08:06,810 --> 00:08:11,010
soon as we bomb Syria the you know lo

214
00:08:09,510 --> 00:08:12,419
and behold the the first dump was

215
00:08:11,010 --> 00:08:14,909
released which contained a lot of remote

216
00:08:12,419 --> 00:08:16,859
exploits for Linux based systems then we

217
00:08:14,910 --> 00:08:18,180
saw just yesterday where they released a

218
00:08:16,860 --> 00:08:20,760
large cache of Windows exploits

219
00:08:18,180 --> 00:08:23,520
everything ranging from IAS 6 exploits

220
00:08:20,760 --> 00:08:25,110
all the way to you know SMB exploits and

221
00:08:23,520 --> 00:08:27,570
everything else there's also a really

222
00:08:25,110 --> 00:08:29,100
cool exploitation framework which I'll

223
00:08:27,570 --> 00:08:30,690
talk about here in a little bit that the

224
00:08:29,100 --> 00:08:32,669
NSA also got leaked on it's basically

225
00:08:30,690 --> 00:08:34,229
the Metasploit for the NSA which is now

226
00:08:32,669 --> 00:08:35,010
getting forked and now developed now so

227
00:08:34,229 --> 00:08:36,419
it's gonna be like the next you know

228
00:08:35,010 --> 00:08:38,250
python-based Metasploit which will be

229
00:08:36,419 --> 00:08:40,169
fantastic I'm just curious what's the

230
00:08:38,250 --> 00:08:41,820
licensing for using NSA's Co can you

231
00:08:40,169 --> 00:08:43,770
fork it and like do like a BSD license

232
00:08:41,820 --> 00:08:45,360
how does that work you know I guess it's

233
00:08:43,770 --> 00:08:46,439
taxpayer dollars and technically you

234
00:08:45,360 --> 00:08:48,180
know like the government has

235
00:08:46,440 --> 00:08:49,200
no copyright over there material so

236
00:08:48,180 --> 00:08:51,510
technically we should be able to use it

237
00:08:49,200 --> 00:08:53,580
right so there's a lot of great stuff

238
00:08:51,510 --> 00:08:55,650
that was actually released inside of it

239
00:08:53,580 --> 00:08:57,840
but it just shows you what's actually

240
00:08:55,650 --> 00:09:00,000
happening right now is a lot of of

241
00:08:57,840 --> 00:09:01,050
information warfare around you know

242
00:09:00,000 --> 00:09:02,880
different government attacking each

243
00:09:01,050 --> 00:09:05,400
other exposing other data and based on

244
00:09:02,880 --> 00:09:07,020
on foreign policy releasing a lot of the

245
00:09:05,400 --> 00:09:09,030
data on that's out there so it's kind of

246
00:09:07,020 --> 00:09:11,970
a scary time when you actually look at

247
00:09:09,030 --> 00:09:14,100
it and so let's just say hypothetically

248
00:09:11,970 --> 00:09:16,110
the shadow brokers are Russia and at the

249
00:09:14,100 --> 00:09:17,490
equation group is the NSA there's some

250
00:09:16,110 --> 00:09:19,680
serious stuff going on right now between

251
00:09:17,490 --> 00:09:22,470
the two countries between US and Russia

252
00:09:19,680 --> 00:09:24,000
obviously escalation criteria Tromp has

253
00:09:22,470 --> 00:09:25,110
said that you know it's probably the

254
00:09:24,000 --> 00:09:26,910
worst relations that we've had same

255
00:09:25,110 --> 00:09:28,560
thing for Putin we're launching

256
00:09:26,910 --> 00:09:30,600
offensives in Syria or going after North

257
00:09:28,560 --> 00:09:32,819
Korea cut key allies of those Iran is

258
00:09:30,600 --> 00:09:34,140
against us so there's a lot of foreign

259
00:09:32,820 --> 00:09:36,480
policy things that are happening around

260
00:09:34,140 --> 00:09:37,830
this time and the release is coincide

261
00:09:36,480 --> 00:09:40,230
with a lot of what's actually happening

262
00:09:37,830 --> 00:09:42,810
out there in the industry now the scary

263
00:09:40,230 --> 00:09:45,540
part about a lot of this is you know if

264
00:09:42,810 --> 00:09:47,099
you look at what Russia leaked as far as

265
00:09:45,540 --> 00:09:48,990
the exploits that means that Russia

266
00:09:47,100 --> 00:09:50,280
either has had already been using those

267
00:09:48,990 --> 00:09:52,530
exploits for a large period time because

268
00:09:50,280 --> 00:09:54,180
the dump goes back to about 2013 so

269
00:09:52,530 --> 00:09:57,060
these exports have been compromised

270
00:09:54,180 --> 00:09:58,589
since 2013 they've been known to be

271
00:09:57,060 --> 00:10:00,420
compromised since 2013 we've never

272
00:09:58,590 --> 00:10:02,130
published anything around that to say

273
00:10:00,420 --> 00:10:03,360
hey these exploits are on the wild

274
00:10:02,130 --> 00:10:04,650
Microsoft you should go to fix these

275
00:10:03,360 --> 00:10:06,570
Linux you should go on fix these things

276
00:10:04,650 --> 00:10:07,110
there has been any release to actually

277
00:10:06,570 --> 00:10:08,580
go and do it

278
00:10:07,110 --> 00:10:10,980
now a lot of these have actually been

279
00:10:08,580 --> 00:10:13,200
fixed luckily just through normal

280
00:10:10,980 --> 00:10:15,150
disclosure Lee Google's zero-day Pross

281
00:10:13,200 --> 00:10:16,560
your project has actually gone through

282
00:10:15,150 --> 00:10:18,209
and fixed a lot even found these blogs

283
00:10:16,560 --> 00:10:20,069
ahead of time they're actively being

284
00:10:18,210 --> 00:10:22,290
used that means that Russia probably has

285
00:10:20,070 --> 00:10:24,660
the same capabilities if not better to

286
00:10:22,290 --> 00:10:26,219
launch offensives against us and didn't

287
00:10:24,660 --> 00:10:28,709
care if we burn these specific sources

288
00:10:26,220 --> 00:10:31,320
on them now one thing I want to say is I

289
00:10:28,710 --> 00:10:32,760
you know I it's not a good day for our

290
00:10:31,320 --> 00:10:34,530
intelligence community when you leak a

291
00:10:32,760 --> 00:10:36,720
large amount of this data especially

292
00:10:34,530 --> 00:10:38,850
exploitation frameworks direct exploits

293
00:10:36,720 --> 00:10:42,060
that we use for offensives implants a

294
00:10:38,850 --> 00:10:43,650
large percentage of what was leaked was

295
00:10:42,060 --> 00:10:45,510
still what we would consider today as

296
00:10:43,650 --> 00:10:47,130
being very significant around you know

297
00:10:45,510 --> 00:10:49,050
hey we fish first we get access to an

298
00:10:47,130 --> 00:10:50,220
infrastructure and then we need to do

299
00:10:49,050 --> 00:10:51,569
lateral movement to move to other

300
00:10:50,220 --> 00:10:52,560
systems and how do we do that latter

301
00:10:51,570 --> 00:10:53,910
movement well hey we have a whole bunch

302
00:10:52,560 --> 00:10:55,500
of zero days and implants that we can

303
00:10:53,910 --> 00:10:57,959
use to get access to different systems

304
00:10:55,500 --> 00:10:59,460
so you know it's a bad day for the

305
00:10:57,960 --> 00:11:00,000
intelligence community because they lost

306
00:10:59,460 --> 00:11:02,100
a large

307
00:11:00,000 --> 00:11:03,389
sentence in cash around what they do as

308
00:11:02,100 --> 00:11:04,620
far as weaponization of their stuff so

309
00:11:03,389 --> 00:11:05,790
it's not a good day for the intelligent

310
00:11:04,620 --> 00:11:07,019
it shouldn't be a good day for United

311
00:11:05,790 --> 00:11:08,699
States we should be bragging like hey

312
00:11:07,019 --> 00:11:10,560
know hey we got these great exploits

313
00:11:08,699 --> 00:11:13,290
that's fantastic well yeah as a security

314
00:11:10,560 --> 00:11:15,000
researcher it's great to be able to say

315
00:11:13,290 --> 00:11:16,769
okay yeah you know the zero de inglês

316
00:11:15,000 --> 00:11:18,930
still a very big play in what we're

317
00:11:16,769 --> 00:11:20,310
seeing today but at the same time we

318
00:11:18,930 --> 00:11:21,779
should be pretty alarmed at what's been

319
00:11:20,310 --> 00:11:24,989
happening around these the leaking of a

320
00:11:21,779 --> 00:11:27,540
lot of this data so I want to say a

321
00:11:24,990 --> 00:11:30,420
special thanks to exploit as possible

322
00:11:27,540 --> 00:11:32,730
you know it's you know to me personally

323
00:11:30,420 --> 00:11:34,349
and this is you know you maybe have

324
00:11:32,730 --> 00:11:36,480
different varies of views but I believe

325
00:11:34,350 --> 00:11:38,430
that we need to have these types of

326
00:11:36,480 --> 00:11:40,009
exploits and capabilities on for our

327
00:11:38,430 --> 00:11:41,758
military it's extremely important our

328
00:11:40,009 --> 00:11:43,589
adversaries have the same type of

329
00:11:41,759 --> 00:11:45,089
capabilities they're using the same

330
00:11:43,589 --> 00:11:47,069
things against us so in order for us to

331
00:11:45,089 --> 00:11:49,410
be able to go on the offense as well we

332
00:11:47,069 --> 00:11:50,490
need a same type but at that same time

333
00:11:49,410 --> 00:11:51,839
with great power comes with a great

334
00:11:50,490 --> 00:11:54,149
responsibility effort right a big

335
00:11:51,839 --> 00:11:55,319
spider-man fan right so with that I mean

336
00:11:54,149 --> 00:11:58,110
you can learn everything you can in life

337
00:11:55,319 --> 00:11:59,699
based on spider-man including how to be

338
00:11:58,110 --> 00:12:01,290
cool in a uniform and tights and stuff

339
00:11:59,699 --> 00:12:03,839
like that I try that doesn't work very

340
00:12:01,290 --> 00:12:05,790
well but um but what we learned from

341
00:12:03,839 --> 00:12:07,620
that is you know the government does

342
00:12:05,790 --> 00:12:10,500
have a responsibility that once an

343
00:12:07,620 --> 00:12:11,819
exploit has been burned to work with you

344
00:12:10,500 --> 00:12:13,889
know the different parties like

345
00:12:11,819 --> 00:12:15,449
Microsoft and Cisco and Linux to

346
00:12:13,889 --> 00:12:17,639
actually address those exposures because

347
00:12:15,449 --> 00:12:18,000
they are actively being used that wasn't

348
00:12:17,639 --> 00:12:20,129
done here

349
00:12:18,000 --> 00:12:21,629
it doesn't 13 it was it was compromised

350
00:12:20,129 --> 00:12:23,790
the infrastructure was known burned and

351
00:12:21,629 --> 00:12:24,930
they didn't contact anybody to notify

352
00:12:23,790 --> 00:12:26,849
them that something had actually been

353
00:12:24,930 --> 00:12:28,378
compromised that's a problem so we have

354
00:12:26,850 --> 00:12:29,939
no responsible disclosure method when it

355
00:12:28,379 --> 00:12:31,500
comes to developing these weapons and

356
00:12:29,939 --> 00:12:33,930
then when we're conducting operations

357
00:12:31,500 --> 00:12:38,790
our offensives to have them actively

358
00:12:33,930 --> 00:12:40,739
going fixed afterwards so what this

359
00:12:38,790 --> 00:12:41,969
league tells us is you know the

360
00:12:40,740 --> 00:12:44,610
information warfare campaign is not

361
00:12:41,970 --> 00:12:47,699
dying down it's legit and there's a lot

362
00:12:44,610 --> 00:12:49,199
of power against this I mean there's a

363
00:12:47,699 --> 00:12:50,519
lot of people developing significant

364
00:12:49,199 --> 00:12:52,319
substantial amounts of efforts I mean

365
00:12:50,519 --> 00:12:54,120
like literally what the shadow brokers

366
00:12:52,319 --> 00:12:56,250
leaked was probably a couple mil worth

367
00:12:54,120 --> 00:12:57,569
of exploits a couple of million dollars

368
00:12:56,250 --> 00:12:59,220
he just like literally lit on fire and

369
00:12:57,569 --> 00:13:00,779
you know didn't care about what was

370
00:12:59,220 --> 00:13:03,569
actually happening because of how we're

371
00:13:00,779 --> 00:13:05,579
actively going and doing things and so

372
00:13:03,569 --> 00:13:06,990
you're looking at a time now where we're

373
00:13:05,579 --> 00:13:09,750
literally having the best military

374
00:13:06,990 --> 00:13:11,759
doesn't mean anything right now you know

375
00:13:09,750 --> 00:13:13,500
we haven't we are a direct peer

376
00:13:11,759 --> 00:13:15,030
competitive

377
00:13:13,500 --> 00:13:17,220
playing field when it comes to who we're

378
00:13:15,030 --> 00:13:19,020
going after Iran is probably a couple

379
00:13:17,220 --> 00:13:20,100
years behind us but Russia and China are

380
00:13:19,020 --> 00:13:22,650
very close to what we're doing if not

381
00:13:20,100 --> 00:13:24,810
better so we have a problem now where

382
00:13:22,650 --> 00:13:26,189
you know military capability wise having

383
00:13:24,810 --> 00:13:27,390
the best military the most amount of

384
00:13:26,190 --> 00:13:28,800
bombs the most amount of you know

385
00:13:27,390 --> 00:13:30,120
advanced military doesn't mean squat

386
00:13:28,800 --> 00:13:32,579
when it comes to what we could do

387
00:13:30,120 --> 00:13:35,820
offensive ly so here's a video that I

388
00:13:32,580 --> 00:13:37,170
did two years ago when I was on by the

389
00:13:35,820 --> 00:13:38,520
way is Fox News sorry I should have put

390
00:13:37,170 --> 00:13:42,420
a medal in here as well I try to balance

391
00:13:38,520 --> 00:13:42,750
so much here I don't care which one come

392
00:13:42,420 --> 00:13:45,449
on

393
00:13:42,750 --> 00:13:48,720
I tried to them all I think all politics

394
00:13:45,450 --> 00:13:50,580
suck so I don't felt anything so this is

395
00:13:48,720 --> 00:13:53,010
one thing where two years ago this is

396
00:13:50,580 --> 00:13:54,630
general Dempsey and and I don't know the

397
00:13:53,010 --> 00:13:56,010
military has been and especially the NSA

398
00:13:54,630 --> 00:13:58,170
director I'm everyone else has been very

399
00:13:56,010 --> 00:13:59,370
open about what our capabilities are and

400
00:13:58,170 --> 00:14:00,719
where our shortfalls are and they're not

401
00:13:59,370 --> 00:14:02,610
joking around with what we're talking

402
00:14:00,720 --> 00:14:04,230
that's not a way to scare us and to

403
00:14:02,610 --> 00:14:06,240
giving away privacy and stuff like that

404
00:14:04,230 --> 00:14:08,280
which by the way and I got in a huge

405
00:14:06,240 --> 00:14:09,870
argument on Fox and I'm judged mean

406
00:14:08,280 --> 00:14:11,280
where I got three people yelling at me

407
00:14:09,870 --> 00:14:13,050
that I was wrong about giving the FBI

408
00:14:11,280 --> 00:14:14,760
the backdoor to an iPhone would be you

409
00:14:13,050 --> 00:14:17,880
know kinda like the downfall if we can't

410
00:14:14,760 --> 00:14:19,980
protect our most awesome weapons how is

411
00:14:17,880 --> 00:14:22,290
the FBI going to protect having access

412
00:14:19,980 --> 00:14:25,200
to every iPhone so anyway so it's all

413
00:14:22,290 --> 00:14:27,480
coming fruition which is great this is

414
00:14:25,200 --> 00:14:29,310
back in 2015 and general Dempsey I was

415
00:14:27,480 --> 00:14:30,800
talking about our our cyber capabilities

416
00:14:29,310 --> 00:14:32,849
and what that actually means the

417
00:14:30,800 --> 00:14:35,430
incredibly destructive it can be

418
00:14:32,850 --> 00:14:38,610
disruptive it can disrupt anything

419
00:14:35,430 --> 00:14:42,030
destroy and it can destroy Hardware it

420
00:14:38,610 --> 00:14:44,130
can it can it can disable critical

421
00:14:42,030 --> 00:14:46,650
infrastructure which could lead to loss

422
00:14:44,130 --> 00:14:48,600
of life and I think those capabilities

423
00:14:46,650 --> 00:14:54,230
are out there and you know we have in

424
00:14:48,600 --> 00:14:56,820
every domain Chris we generally enjoy a

425
00:14:54,230 --> 00:15:00,180
significant military advantage but we

426
00:14:56,820 --> 00:15:01,470
have peer competitors in cyber in other

427
00:15:00,180 --> 00:15:03,959
words we don't have an advantage over

428
00:15:01,470 --> 00:15:05,610
that we we don't have an advantage it's

429
00:15:03,960 --> 00:15:08,250
a level playing field and that makes

430
00:15:05,610 --> 00:15:09,839
this chairman very uncomfortable so why

431
00:15:08,250 --> 00:15:11,370
are we not ready how devastating could

432
00:15:09,839 --> 00:15:13,680
this be in assists just beginning

433
00:15:11,370 --> 00:15:15,839
tech expert David Sanders joins us David

434
00:15:13,680 --> 00:15:18,729
should the is this the tip of the

435
00:15:15,839 --> 00:15:24,580
iceberg this awarding or advancing this

436
00:15:18,730 --> 00:15:26,230
I have a gym shorts on memo I do the

437
00:15:24,580 --> 00:15:27,850
Charles Barkley you're not familiar with

438
00:15:26,230 --> 00:15:29,920
that Charles Rossini's I need like a

439
00:15:27,850 --> 00:15:32,440
suit and tie on and it doesn't typically

440
00:15:29,920 --> 00:15:33,189
wear pants I do the same thing there's

441
00:15:32,440 --> 00:15:35,110
no big deal

442
00:15:33,190 --> 00:15:36,070
so walking is stupid eyes for Greta and

443
00:15:35,110 --> 00:15:37,540
it's not really a thing we've been

444
00:15:36,070 --> 00:15:39,010
actually warning about this for a number

445
00:15:37,540 --> 00:15:40,900
of years in the security industry you've

446
00:15:39,010 --> 00:15:42,790
had some big players like Russia and

447
00:15:40,900 --> 00:15:46,870
China where they've hacked into us for

448
00:15:42,790 --> 00:15:49,480
more military preparedness and that was

449
00:15:46,870 --> 00:15:51,250
so that was two years ago so you know we

450
00:15:49,480 --> 00:15:52,800
know that this is a problem with what

451
00:15:51,250 --> 00:15:55,450
we're dealing with today

452
00:15:52,800 --> 00:15:56,859
now if shadow brokers are responding to

453
00:15:55,450 --> 00:15:58,150
world events of bring reliable exports

454
00:15:56,860 --> 00:15:59,920
again it means that they already have

455
00:15:58,150 --> 00:16:02,350
things that are comparable or better

456
00:15:59,920 --> 00:16:04,030
than what they released out there so

457
00:16:02,350 --> 00:16:05,410
it's good to understand you know what

458
00:16:04,030 --> 00:16:07,150
our adversaries now there hasn't been a

459
00:16:05,410 --> 00:16:08,980
large leak of Russian exploits or

460
00:16:07,150 --> 00:16:09,790
Chinese exploits we know a lot of what

461
00:16:08,980 --> 00:16:11,200
they do from an infrastructure

462
00:16:09,790 --> 00:16:13,270
perspective like China like using plug

463
00:16:11,200 --> 00:16:15,310
acts Russia likes using PowerShell and W

464
00:16:13,270 --> 00:16:16,720
my persistence but we don't know their

465
00:16:15,310 --> 00:16:18,310
exploitation techniques or how good

466
00:16:16,720 --> 00:16:20,080
their a teams or Tier one and tier two

467
00:16:18,310 --> 00:16:24,219
teams actually re at at this point at

468
00:16:20,080 --> 00:16:25,480
least not in our our field so if you

469
00:16:24,220 --> 00:16:27,070
look at the leaks what was actually

470
00:16:25,480 --> 00:16:30,100
caption though this is a screenshot from

471
00:16:27,070 --> 00:16:31,030
campus coding so here's a list of all

472
00:16:30,100 --> 00:16:32,380
the different things that we're

473
00:16:31,030 --> 00:16:35,949
releasing this last dump here yesterday

474
00:16:32,380 --> 00:16:37,689
so we have everything from you know em

475
00:16:35,950 --> 00:16:41,490
daemon email server vulnerability to

476
00:16:37,690 --> 00:16:45,550
Lotus Notes exploits to is-6 exploits a

477
00:16:41,490 --> 00:16:47,140
reliable 2000 RDP 2003 exploit it was

478
00:16:45,550 --> 00:16:48,579
nice about it is it if you had a EULA a

479
00:16:47,140 --> 00:16:49,840
license agreement it even clicked

480
00:16:48,580 --> 00:16:50,950
through for you and hit OK and then

481
00:16:49,840 --> 00:16:52,840
exploit the machine which is great so

482
00:16:50,950 --> 00:16:54,790
it's accepting the licensing agreements

483
00:16:52,840 --> 00:16:55,990
is fantastic that you won't hack

484
00:16:54,790 --> 00:16:59,020
unauthorized there anyway should perform

485
00:16:55,990 --> 00:17:01,090
so thank you thank you we have a number

486
00:16:59,020 --> 00:17:03,579
of smbx boys talking everything from

487
00:17:01,090 --> 00:17:06,100
windows xp service pack our Windows XP

488
00:17:03,580 --> 00:17:08,319
fully past no patches obviously can be

489
00:17:06,099 --> 00:17:11,230
released past this point all the way to

490
00:17:08,319 --> 00:17:12,780
Server 2012 so a large range of

491
00:17:11,230 --> 00:17:15,220
different exploits that are out there

492
00:17:12,780 --> 00:17:17,530
currently everything affecting SMB

493
00:17:15,220 --> 00:17:19,780
version 1 and SMB version 2 now I know

494
00:17:17,530 --> 00:17:21,639
I'm the guy that wrote responder I was

495
00:17:19,780 --> 00:17:23,410
talking yesterday about the specific

496
00:17:21,640 --> 00:17:25,510
vulnerability version 1 there was a

497
00:17:23,410 --> 00:17:27,670
project currently back in 1996 or so

498
00:17:25,510 --> 00:17:29,290
called Cairo which was integrated into

499
00:17:27,670 --> 00:17:31,210
SME version 1 that never got fully

500
00:17:29,290 --> 00:17:32,230
implemented that's where a lot of these

501
00:17:31,210 --> 00:17:34,360
bugs and them

502
00:17:32,230 --> 00:17:35,230
and as of late is in the Cairo project

503
00:17:34,360 --> 00:17:36,879
which was actually never fully

504
00:17:35,230 --> 00:17:38,590
implemented but is in actual every

505
00:17:36,880 --> 00:17:41,590
version of SMB version one that's out

506
00:17:38,590 --> 00:17:43,389
there so a lot of good exploits that are

507
00:17:41,590 --> 00:17:45,549
coming from this one specifically that's

508
00:17:43,390 --> 00:17:47,020
out there now good news is a lot of use

509
00:17:45,549 --> 00:17:48,850
of our demon address you know as

510
00:17:47,020 --> 00:17:51,639
security researchers go through these

511
00:17:48,850 --> 00:17:53,559
protocols when they find things you know

512
00:17:51,640 --> 00:17:55,660
there are obviously proof of concept

513
00:17:53,559 --> 00:17:56,230
denial services and may not be actively

514
00:17:55,660 --> 00:17:57,970
weaponized

515
00:17:56,230 --> 00:18:01,799
Microsoft's actually fix a lot of these

516
00:17:57,970 --> 00:18:04,600
the the big one which was eternal blue

517
00:18:01,799 --> 00:18:08,370
which is which is the new MSD way 267

518
00:18:04,600 --> 00:18:11,649
which is ms 1701 0 got fixed on Tuesday

519
00:18:08,370 --> 00:18:14,168
Tuesday so it's been accurately exported

520
00:18:11,650 --> 00:18:16,870
since 2013 by Russia and other

521
00:18:14,169 --> 00:18:20,710
adversaries and by the way I'm not a

522
00:18:16,870 --> 00:18:22,149
conspiracy theorist here but in 2013 you

523
00:18:20,710 --> 00:18:24,669
know it all the information around the

524
00:18:22,150 --> 00:18:28,750
swift anon banking network got hacked by

525
00:18:24,669 --> 00:18:30,549
Russia okay and then in 2015 to 2016 all

526
00:18:28,750 --> 00:18:32,309
of the Swift infrastructure got hacked

527
00:18:30,549 --> 00:18:34,210
and a whole bunch of money got sent out

528
00:18:32,309 --> 00:18:36,399
that seems kind of suspicious or

529
00:18:34,210 --> 00:18:37,929
coincidental right and it's Lucy

530
00:18:36,400 --> 00:18:39,880
attributed back to North Korea at that

531
00:18:37,929 --> 00:18:41,440
point so it's all weird how this is all

532
00:18:39,880 --> 00:18:44,169
kind of playing together in this

533
00:18:41,440 --> 00:18:46,630
specific dumper leak but eternal blues

534
00:18:44,169 --> 00:18:48,370
really the the most awesomeness one they

535
00:18:46,630 --> 00:18:49,660
had their own MSO a two six seven so he

536
00:18:48,370 --> 00:18:51,399
knew about emissary six seven well

537
00:18:49,660 --> 00:18:53,710
before I was ever publicly released out

538
00:18:51,400 --> 00:18:57,820
there so a lot of great capabilities you

539
00:18:53,710 --> 00:19:00,429
can see kind of coming from the NSA what

540
00:18:57,820 --> 00:19:02,500
was less about and probably I got to

541
00:19:00,429 --> 00:19:05,790
give the NSA a round of applause floor

542
00:19:02,500 --> 00:19:05,790
ASCII art it is

543
00:19:06,940 --> 00:19:11,029
that's some legit hackers okay when you

544
00:19:09,230 --> 00:19:12,499
got ASCII art and you got like beer mugs

545
00:19:11,029 --> 00:19:14,450
and you know you got a bunch of other

546
00:19:12,499 --> 00:19:16,039
things they're legit on what they're

547
00:19:14,450 --> 00:19:18,350
doing as far as hacker so every good

548
00:19:16,039 --> 00:19:21,320
hacker has to have a ski yarder it's not

549
00:19:18,350 --> 00:19:23,418
not legit but you look at eternal

550
00:19:21,320 --> 00:19:25,039
romance what would happen and the way

551
00:19:23,419 --> 00:19:27,169
that the the framework of working I'll

552
00:19:25,039 --> 00:19:29,749
talk of it about fuzz here in second FP

553
00:19:27,169 --> 00:19:32,240
is you would compromise a system and

554
00:19:29,749 --> 00:19:34,460
then you would use on their exploitation

555
00:19:32,240 --> 00:19:35,690
framework as a pivot point and what I

556
00:19:34,460 --> 00:19:37,820
mean thermal romance would do is a

557
00:19:35,690 --> 00:19:39,769
profile a target system looking for

558
00:19:37,820 --> 00:19:41,928
vulnerabilities in and say hey this this

559
00:19:39,769 --> 00:19:43,970
specific system is vulnerable to six

560
00:19:41,929 --> 00:19:45,590
exploits do you want to deploy these and

561
00:19:43,970 --> 00:19:46,789
it would go in and run an exploit and

562
00:19:45,590 --> 00:19:47,749
then it would hit an implant and then it

563
00:19:46,789 --> 00:19:49,009
wouldn't you know call back to the

564
00:19:47,749 --> 00:19:50,240
command control infrastructure for the

565
00:19:49,009 --> 00:19:52,190
NSA and then have full access to

566
00:19:50,240 --> 00:19:54,379
everything so a lot of really cool stuff

567
00:19:52,190 --> 00:19:55,879
on being built and you know very similar

568
00:19:54,379 --> 00:19:57,709
to what we would use in the private

569
00:19:55,879 --> 00:20:00,889
sector so good at the station around

570
00:19:57,710 --> 00:20:02,059
what we're doing in the industry so just

571
00:20:00,889 --> 00:20:04,219
when we thought MSA to six seven was

572
00:20:02,059 --> 00:20:05,509
killed we got as bigger brothers nine

573
00:20:04,220 --> 00:20:09,409
hundred pounds and carries guns riding a

574
00:20:05,509 --> 00:20:11,869
flaming unicorn breathe fire so what was

575
00:20:09,409 --> 00:20:14,090
nice about this one specifically is it

576
00:20:11,869 --> 00:20:15,740
targets all versions of Windows so it's

577
00:20:14,090 --> 00:20:17,029
fantastic for us you know less for the

578
00:20:15,740 --> 00:20:18,139
next nine years because we are still

579
00:20:17,029 --> 00:20:20,119
absolutely terrible

580
00:20:18,139 --> 00:20:21,678
with patch management we just got rid of

581
00:20:20,119 --> 00:20:23,629
like MSO two six seven like last month

582
00:20:21,679 --> 00:20:24,799
like literally people just started

583
00:20:23,629 --> 00:20:27,019
patching and finally got rid of that

584
00:20:24,799 --> 00:20:28,789
last you know legacy server they finally

585
00:20:27,019 --> 00:20:30,110
went through hell in a handbasket or

586
00:20:28,789 --> 00:20:32,119
change control like seven million

587
00:20:30,110 --> 00:20:33,320
dollars to remediate a old version that

588
00:20:32,119 --> 00:20:34,970
they couldn't get their ERP system up

589
00:20:33,320 --> 00:20:36,559
Korea to and finally got rid that last

590
00:20:34,970 --> 00:20:38,240
MSO two six seven only to have this one

591
00:20:36,559 --> 00:20:42,590
pop up so let me give for like the next

592
00:20:38,240 --> 00:20:43,940
nine years as pen testers so you look at

593
00:20:42,590 --> 00:20:45,860
it multiple zero days I'm a lot of them

594
00:20:43,940 --> 00:20:48,110
again have been addressed but we finally

595
00:20:45,860 --> 00:20:49,610
have multiple windows XP and Server 2003

596
00:20:48,110 --> 00:20:49,998
ones which there's still plenty of them

597
00:20:49,610 --> 00:20:52,309
out there

598
00:20:49,999 --> 00:20:55,940
um someone did a showdown query on who

599
00:20:52,309 --> 00:20:58,158
has Microsoft Windows out there with 4.5

600
00:20:55,940 --> 00:20:59,509
or 135 open you know something like two

601
00:20:58,159 --> 00:21:01,669
million three hundred thousand different

602
00:20:59,509 --> 00:21:04,070
IP still had NetBIOS and our PC expose

603
00:21:01,669 --> 00:21:05,360
in the outside like five hundred ninety

604
00:21:04,070 --> 00:21:10,490
thousand were in the United States I'm

605
00:21:05,360 --> 00:21:11,719
like seriously what's wrong with us so

606
00:21:10,490 --> 00:21:13,970
last night I didn't go to bed for like 2

607
00:21:11,720 --> 00:21:15,710
a.m. because we're working on trying to

608
00:21:13,970 --> 00:21:17,119
get on a stable payload

609
00:21:15,710 --> 00:21:18,769
through the framework in order to get

610
00:21:17,119 --> 00:21:19,330
some like COBOL strike or Metasploit I'm

611
00:21:18,769 --> 00:21:21,310
directing

612
00:21:19,330 --> 00:21:24,580
to it and so it was just recently

613
00:21:21,310 --> 00:21:26,020
present Tuesday but ms 1710 does work we

614
00:21:24,580 --> 00:21:28,600
got to fully work out a window seven

615
00:21:26,020 --> 00:21:31,629
fully patched - the patch off of Tuesday

616
00:21:28,600 --> 00:21:37,270
and so here's an example of using fuzz

617
00:21:31,630 --> 00:21:39,130
bunch so funds punched by the ways that

618
00:21:37,270 --> 00:21:40,420
men tom is a framework and obviously

619
00:21:39,130 --> 00:21:42,430
blow this up a little bit in fact I'll

620
00:21:40,420 --> 00:21:51,070
actually go to full screen on this one

621
00:21:42,430 --> 00:21:54,690
real quick hang in just just a little

622
00:21:51,070 --> 00:21:54,689
bit loose mover

623
00:21:59,980 --> 00:22:04,059
so this is fuzz Bunch and when you to do

624
00:22:02,169 --> 00:22:06,760
in Windows is just basically install PI

625
00:22:04,059 --> 00:22:09,279
132 Python and you're all set

626
00:22:06,760 --> 00:22:10,990
and you just run FB dot P Y which is

627
00:22:09,279 --> 00:22:12,370
fuzz Bunch which is the exploitation

628
00:22:10,990 --> 00:22:14,049
framework is very similar to Metasploit

629
00:22:12,370 --> 00:22:15,729
half it has a lot of different

630
00:22:14,049 --> 00:22:18,370
similarities you can type things like

631
00:22:15,730 --> 00:22:20,380
help use these different payloads you

632
00:22:18,370 --> 00:22:20,889
know it's very similar to do everything

633
00:22:20,380 --> 00:22:22,389
else out there

634
00:22:20,889 --> 00:22:25,840
now we're and here we're going to be

635
00:22:22,389 --> 00:22:29,139
using on the specific exploit of ms 1710

636
00:22:25,840 --> 00:22:33,010
we enter IP address in where we want to

637
00:22:29,139 --> 00:22:34,479
put our logs at and any specific project

638
00:22:33,010 --> 00:22:38,139
if we're working on specific campaign to

639
00:22:34,480 --> 00:22:43,299
target somebody so let's call this demo

640
00:22:38,139 --> 00:22:49,449
one now you can see it even has tab

641
00:22:43,299 --> 00:22:50,679
completion which is fantastic and so

642
00:22:49,450 --> 00:22:52,000
we're going to the eternal blue which is

643
00:22:50,679 --> 00:22:53,230
the export that we're gonna actually go

644
00:22:52,000 --> 00:22:54,519
on target we're going to send the target

645
00:22:53,230 --> 00:22:56,980
IP address which is we've already

646
00:22:54,519 --> 00:23:00,820
predefined we're going to verify the

647
00:22:56,980 --> 00:23:02,440
backdoor it's actually implanted and we

648
00:23:00,820 --> 00:23:09,750
can target the different specific

649
00:23:02,440 --> 00:23:12,549
systems and which payload we want to use

650
00:23:09,750 --> 00:23:14,139
it has the two built-in ones and then

651
00:23:12,549 --> 00:23:18,700
we'll go and execute it it goes in

652
00:23:14,139 --> 00:23:21,428
triggers the overflow uses a hunter

653
00:23:18,700 --> 00:23:22,870
which is a way of searching for your

654
00:23:21,429 --> 00:23:26,159
shellcode somewhere in the memory so

655
00:23:22,870 --> 00:23:26,158
it's probably a memory corruption flow

656
00:23:27,360 --> 00:23:32,469
once the triggers our backdoor is

657
00:23:30,100 --> 00:23:34,149
installed now we have access to the

658
00:23:32,470 --> 00:23:36,460
computer now this is using their implant

659
00:23:34,149 --> 00:23:38,139
right so this is something that we

660
00:23:36,460 --> 00:23:42,700
wouldn't necessarily be able to leverage

661
00:23:38,139 --> 00:23:46,439
yet so we did this we earned a second

662
00:23:42,700 --> 00:23:46,440
video let me blow this up again

663
00:23:48,990 --> 00:23:54,929
this is using our own custom payload in

664
00:23:52,380 --> 00:23:59,399
this case we're using a octave skated

665
00:23:54,929 --> 00:24:00,570
cobalt strike payload but you can use an

666
00:23:59,399 --> 00:24:04,580
interpreter anything else I'll we just

667
00:24:00,570 --> 00:24:04,580
use the DLL but it supports shell code

668
00:24:06,470 --> 00:24:10,440
so over here we're going to go ahead and

669
00:24:08,309 --> 00:24:20,010
use the exploit again so we turn a

670
00:24:10,440 --> 00:24:21,480
balloon in the IP address we specify our

671
00:24:20,010 --> 00:24:23,720
target just like the same steps as we

672
00:24:21,480 --> 00:24:23,720
did before

673
00:24:29,750 --> 00:24:33,320
and once we get into our exploit itself

674
00:24:31,490 --> 00:24:40,160
before we execute we actually import our

675
00:24:33,320 --> 00:24:41,510
dll and we run artifacts that dll we get

676
00:24:40,160 --> 00:24:43,520
access the COBOL strek most down on the

677
00:24:41,510 --> 00:24:45,830
bottom or cobalt red pale it's been

678
00:24:43,520 --> 00:24:55,310
imported will see a beacon here in just

679
00:24:45,830 --> 00:24:58,790
a second so we have to specify our dll

680
00:24:55,310 --> 00:25:00,050
that we're going to checked the way that

681
00:24:58,790 --> 00:25:01,639
we use this is all what we call double

682
00:25:00,050 --> 00:25:07,399
pulsar so we have deploying our own

683
00:25:01,640 --> 00:25:14,450
payload head cool names so set function

684
00:25:07,400 --> 00:25:17,260
run DLL we have our artifact ID allows

685
00:25:14,450 --> 00:25:17,260
we're going to be using

686
00:25:32,060 --> 00:25:35,780
sorry for the delay we're literally at 2

687
00:25:34,040 --> 00:25:38,080
o'clock in the morning trying to type

688
00:25:35,780 --> 00:25:38,080
all this

689
00:25:44,610 --> 00:25:51,429
so we set the dll orbital our orbital to

690
00:25:48,550 --> 00:25:54,820
five and then we actually set the DLL

691
00:25:51,430 --> 00:25:59,040
payload which is execute to the actual

692
00:25:54,820 --> 00:25:59,040
path and then we execute it

693
00:26:12,070 --> 00:26:17,149
now once we execute takes a second we'll

694
00:26:15,530 --> 00:26:24,070
see our beacon hit back in just a second

695
00:26:17,150 --> 00:26:30,500
execute plugin yes and we get our beacon

696
00:26:24,070 --> 00:26:37,280
pretty awesome stuff free exploits so we

697
00:26:30,500 --> 00:26:38,990
want to pull right up if you want to

698
00:26:37,280 --> 00:26:39,350
pull right up in a step-by-step it's up

699
00:26:38,990 --> 00:26:40,850
there

700
00:26:39,350 --> 00:26:42,620
it also has analysis on all the

701
00:26:40,850 --> 00:26:44,959
different exploits on what was contained

702
00:26:42,620 --> 00:26:46,790
in the dump files analysis of all the

703
00:26:44,960 --> 00:26:48,650
different structure payloads everything

704
00:26:46,790 --> 00:26:50,870
that's out there all up on that site

705
00:26:48,650 --> 00:26:51,860
plus we'll be continuing on more and

706
00:26:50,870 --> 00:26:53,419
more than alysus we're actually

707
00:26:51,860 --> 00:26:56,389
disassembling the executables because

708
00:26:53,420 --> 00:26:57,920
the actual source code for these for FBI

709
00:26:56,390 --> 00:26:59,930
py and stuff like that that was all the

710
00:26:57,920 --> 00:27:02,120
framework is all open source to the

711
00:26:59,930 --> 00:27:03,590
actual exploits were in executables so

712
00:27:02,120 --> 00:27:04,550
we have to disassemble and do packet

713
00:27:03,590 --> 00:27:05,810
captures to figure out what's actually

714
00:27:04,550 --> 00:27:07,070
triggering those in the next with

715
00:27:05,810 --> 00:27:08,780
themselves we're currently underway for

716
00:27:07,070 --> 00:27:10,310
the prototypes of that so we should

717
00:27:08,780 --> 00:27:12,200
hopefully have those done within the

718
00:27:10,310 --> 00:27:14,629
next day or so for a lot of the exploits

719
00:27:12,200 --> 00:27:16,790
out there but if you look at what the

720
00:27:14,630 --> 00:27:20,390
tactics techniques and procedures what

721
00:27:16,790 --> 00:27:21,800
we call TTP sr of this you know it's

722
00:27:20,390 --> 00:27:23,240
nice to look at what's happening with

723
00:27:21,800 --> 00:27:24,230
the NSA what's happening with russia

724
00:27:23,240 --> 00:27:25,460
it's happening with china what's

725
00:27:24,230 --> 00:27:26,450
happening with organized crime and

726
00:27:25,460 --> 00:27:29,330
ransomware and everything else that we

727
00:27:26,450 --> 00:27:31,280
see out there because as Assessors and

728
00:27:29,330 --> 00:27:32,780
pen testers were supposed to be

729
00:27:31,280 --> 00:27:34,700
simulating what's happening in the real

730
00:27:32,780 --> 00:27:37,040
world we're supposed to be doing things

731
00:27:34,700 --> 00:27:38,330
that that are very similar to what our

732
00:27:37,040 --> 00:27:40,070
risks and threats are going to be in

733
00:27:38,330 --> 00:27:41,720
this landscape in this or in this

734
00:27:40,070 --> 00:27:43,939
community in order to build better

735
00:27:41,720 --> 00:27:45,350
defenses and so looking at something of

736
00:27:43,940 --> 00:27:46,400
what the NSA the capabilities are the

737
00:27:45,350 --> 00:27:48,110
equation of group's capabilities are

738
00:27:46,400 --> 00:27:49,670
it's very beneficial for us to get an

739
00:27:48,110 --> 00:27:51,320
understanding around the zero two angles

740
00:27:49,670 --> 00:27:52,640
because a lot of what we eat here today

741
00:27:51,320 --> 00:27:53,870
is just hey it's just phishing it's just

742
00:27:52,640 --> 00:27:55,550
basically it's just phishing no we still

743
00:27:53,870 --> 00:27:56,300
on zero days out there let's go a lot of

744
00:27:55,550 --> 00:27:57,409
them out there it's just gone

745
00:27:56,300 --> 00:28:01,070
underground because they're very

746
00:27:57,410 --> 00:28:02,030
expensive to develop nowadays and so

747
00:28:01,070 --> 00:28:03,950
what is the information that we've

748
00:28:02,030 --> 00:28:05,389
actually learned from from this and what

749
00:28:03,950 --> 00:28:06,290
can we learn from this specific dump

750
00:28:05,390 --> 00:28:08,450
with all the other dumps have been

751
00:28:06,290 --> 00:28:10,550
happening out there so the first thing

752
00:28:08,450 --> 00:28:12,620
is understanding that users are still by

753
00:28:10,550 --> 00:28:14,570
far the number one most attack surface

754
00:28:12,620 --> 00:28:15,979
out there today that's not changing you

755
00:28:14,570 --> 00:28:17,840
know if you look at a lot of what the

756
00:28:15,980 --> 00:28:19,970
tools were for the NSA in the equation

757
00:28:17,840 --> 00:28:21,649
group it was specifically designed for

758
00:28:19,970 --> 00:28:23,510
lateral movement it was designed to

759
00:28:21,650 --> 00:28:24,980
compromise a host and goes to the next

760
00:28:23,510 --> 00:28:26,600
one until they get access to the

761
00:28:24,980 --> 00:28:27,890
objective data they needed to you or the

762
00:28:26,600 --> 00:28:30,559
intelligence gaining purposes or for

763
00:28:27,890 --> 00:28:33,020
collection so what we learn too is is

764
00:28:30,559 --> 00:28:35,720
what the NSA does is not magic right

765
00:28:33,020 --> 00:28:37,309
what the CIA is doing is not magic what

766
00:28:35,720 --> 00:28:39,230
Russia's doing is not magic there's no

767
00:28:37,309 --> 00:28:40,549
magic out there you know we have a lot

768
00:28:39,230 --> 00:28:42,440
of money we spend millions of dollars

769
00:28:40,549 --> 00:28:44,270
with third-party contractors with

770
00:28:42,440 --> 00:28:45,770
exploit researchers to build these and

771
00:28:44,270 --> 00:28:47,450
then weaponize them that we can use for

772
00:28:45,770 --> 00:28:49,010
intelligence purposes we conduct

773
00:28:47,450 --> 00:28:50,270
operations the same thing that Russia

774
00:28:49,010 --> 00:28:53,120
does same thing that everybody else does

775
00:28:50,270 --> 00:28:54,559
it's just not you know it's just more

776
00:28:53,120 --> 00:28:57,080
public now in Asia because we're seeing

777
00:28:54,559 --> 00:28:58,820
a lot of information leaked so that's

778
00:28:57,080 --> 00:29:01,070
the top right is what you see from the

779
00:28:58,820 --> 00:29:03,110
jar file now by the way that's probably

780
00:29:01,070 --> 00:29:04,610
the best well-made graphic I've ever

781
00:29:03,110 --> 00:29:05,959
seen come from the government it

782
00:29:04,610 --> 00:29:08,990
probably cost like seven million dollars

783
00:29:05,960 --> 00:29:10,580
of taxpayer money so I'm going to use

784
00:29:08,990 --> 00:29:14,720
the heck out of it because I know I paid

785
00:29:10,580 --> 00:29:17,629
for that for that diagram but we know

786
00:29:14,720 --> 00:29:19,340
from what we can see you know from from

787
00:29:17,630 --> 00:29:20,960
a lot of what happened from grisly step

788
00:29:19,340 --> 00:29:22,459
and all the whole DNC hacking stuff

789
00:29:20,960 --> 00:29:23,960
which is all now in question by the way

790
00:29:22,460 --> 00:29:26,030
of you saw that happened but I guess

791
00:29:23,960 --> 00:29:27,830
Crosstrek retracted their statement that

792
00:29:26,030 --> 00:29:29,120
it was Russia because didn't actually do

793
00:29:27,830 --> 00:29:30,379
a lot of the analysis and they didn't

794
00:29:29,120 --> 00:29:31,790
get a lot of access to the server stuff

795
00:29:30,380 --> 00:29:32,960
so they actually work recanted a lot of

796
00:29:31,790 --> 00:29:36,260
it so who knows what's going out there

797
00:29:32,960 --> 00:29:39,290
but what we're seeing is a lot of a lot

798
00:29:36,260 --> 00:29:42,169
of massive resources stuff at going and

799
00:29:39,290 --> 00:29:44,570
targeting specific infrastructure and

800
00:29:42,169 --> 00:29:46,790
what the other thing what was

801
00:29:44,570 --> 00:29:48,110
interesting about the CIA leaks is not

802
00:29:46,790 --> 00:29:51,080
necessarily code which by the way a huge

803
00:29:48,110 --> 00:29:51,889
fan at if anybody here or listening is

804
00:29:51,080 --> 00:29:53,750
part of the CIA

805
00:29:51,890 --> 00:29:56,299
you guys look like you have a ton of fun

806
00:29:53,750 --> 00:29:57,530
I mean like the CIA playbook said

807
00:29:56,299 --> 00:29:59,299
everything that the programs they had

808
00:29:57,530 --> 00:30:01,220
were huge Doctor Who fans so you're near

809
00:29:59,299 --> 00:30:03,290
near in my heart the weeping angel

810
00:30:01,220 --> 00:30:04,549
program the sonic screwdriver program

811
00:30:03,290 --> 00:30:05,870
those are all sweet things that I

812
00:30:04,549 --> 00:30:08,929
thought was really cool

813
00:30:05,870 --> 00:30:10,939
but the codes and techniques that were

814
00:30:08,929 --> 00:30:12,410
used by the CIA wasn't necessarily the

815
00:30:10,940 --> 00:30:14,630
most interesting piece the most damaging

816
00:30:12,410 --> 00:30:16,010
was the CIA playbooks the politicus

817
00:30:14,630 --> 00:30:18,559
actually talked about how they conduct

818
00:30:16,010 --> 00:30:19,730
operations how they do espionage how

819
00:30:18,559 --> 00:30:22,639
they do all that like and that's very

820
00:30:19,730 --> 00:30:23,870
hard to change tactics and shift tactics

821
00:30:22,640 --> 00:30:26,299
based off of that information being

822
00:30:23,870 --> 00:30:29,149
leaked so here's a thing that I did on

823
00:30:26,299 --> 00:30:30,450
on Fox I get it in as Fox again some of

824
00:30:29,150 --> 00:30:33,210
them I need to

825
00:30:30,450 --> 00:30:38,040
I know jasonich I would have switched

826
00:30:33,210 --> 00:30:39,330
him out let me because getting caught

827
00:30:38,040 --> 00:30:41,639
off a little bit minam moved down here

828
00:30:39,330 --> 00:30:43,889
today here's when I did it Fox talking

829
00:30:41,640 --> 00:30:46,140
about the CIA playbook and they most

830
00:30:43,890 --> 00:30:47,820
specifically why it's important for us

831
00:30:46,140 --> 00:30:53,190
to have these capabilities in general

832
00:30:47,820 --> 00:30:56,460
and hopefully not get them leaked it's

833
00:30:53,190 --> 00:30:58,800
been 48 hours is close to 9,000 pages

834
00:30:56,460 --> 00:31:00,420
from the CIA cyber spying playbook

835
00:30:58,800 --> 00:31:03,030
revealed all kinds of holes in our

836
00:31:00,420 --> 00:31:05,400
laptops and smartphones the documents

837
00:31:03,030 --> 00:31:07,260
flooded the internet silence until today

838
00:31:05,400 --> 00:31:10,530
when that died the WikiLeaks founder

839
00:31:07,260 --> 00:31:12,000
Julian Assange surfaced saying he's the

840
00:31:10,530 --> 00:31:13,950
one who put it all out there and that

841
00:31:12,000 --> 00:31:16,850
the CIA has lost control of this entire

842
00:31:13,950 --> 00:31:19,890
weapons arsenal but then there's this

843
00:31:16,850 --> 00:31:22,169
Assange now says he plans on helping the

844
00:31:19,890 --> 00:31:26,190
tech companies protect their devices

845
00:31:22,170 --> 00:31:29,180
with hearing these calls from some of

846
00:31:26,190 --> 00:31:32,940
the manufacturers we have decided to

847
00:31:29,180 --> 00:31:35,430
work with them to give them some

848
00:31:32,940 --> 00:31:38,220
exclusive access to the additional

849
00:31:35,430 --> 00:31:39,780
technical details we have so Bali they

850
00:31:38,220 --> 00:31:42,090
may know what the stipulation was in

851
00:31:39,780 --> 00:31:43,620
order to get access to the files if you

852
00:31:42,090 --> 00:31:45,570
had a promise in sign legal documents

853
00:31:43,620 --> 00:31:51,870
and never ever work with the government

854
00:31:45,570 --> 00:31:54,810
ever again okay so that fixes can be

855
00:31:51,870 --> 00:31:58,770
developed and pushed out so people can

856
00:31:54,810 --> 00:32:01,080
be secured how sweet of him it's Asajj

857
00:31:58,770 --> 00:32:03,840
suddenly becoming an angel of assistance

858
00:32:01,080 --> 00:32:05,370
by offering to do what some say that CIA

859
00:32:03,840 --> 00:32:06,870
should have done from the start and

860
00:32:05,370 --> 00:32:09,629
that's warn companies about their own

861
00:32:06,870 --> 00:32:11,399
vulnerabilities let's bring in two white

862
00:32:09,630 --> 00:32:13,500
hat hackers they get picked always team

863
00:32:11,400 --> 00:32:15,620
outfit by the way how look at that look

864
00:32:13,500 --> 00:32:15,620
at that

865
00:32:16,090 --> 00:32:20,980
to expose lapses in security at firms

866
00:32:19,130 --> 00:32:25,040
across the country

867
00:32:20,980 --> 00:32:28,010
CTO Alex rice and trusted trusted sects

868
00:32:25,040 --> 00:32:37,070
founder and CEO David Kennedy welcome -

869
00:32:28,010 --> 00:32:38,720
hi I'm glad I named my company trusted

870
00:32:37,070 --> 00:32:40,010
sack because news anchor people have the

871
00:32:38,720 --> 00:32:44,480
worst time pronouncing because they

872
00:32:40,010 --> 00:32:47,510
don't want to say trusted so they always

873
00:32:44,480 --> 00:32:49,910
either abbreviate it to trusted SEC are

874
00:32:47,510 --> 00:32:51,860
they like trusted trusted trusted SEC

875
00:32:49,910 --> 00:32:52,970
you know so every time every time you

876
00:32:51,860 --> 00:32:58,850
look at all my news interviews it's like

877
00:32:52,970 --> 00:33:00,890
trusted SEC SEC security advisors every

878
00:32:58,850 --> 00:33:02,000
time never failed and really been asking

879
00:33:00,890 --> 00:33:03,559
beforehand like hey how do you pronounce

880
00:33:02,000 --> 00:33:05,150
your company like its trusted SEC okay

881
00:33:03,559 --> 00:33:09,620
got it got it got me still stumbled

882
00:33:05,150 --> 00:33:11,480
great the view I'm Alex I'll begin with

883
00:33:09,620 --> 00:33:12,949
you and before we get to whether the CIA

884
00:33:11,480 --> 00:33:16,669
should have notified these companies

885
00:33:12,950 --> 00:33:20,360
it's Julian Assange bluffing or is he to

886
00:33:16,669 --> 00:33:22,429
be trusted these tech companies are

887
00:33:20,360 --> 00:33:24,379
defending against attacks every day and

888
00:33:22,429 --> 00:33:25,850
it's a battle that most of them have

889
00:33:24,380 --> 00:33:27,919
been losing and so they need every

890
00:33:25,850 --> 00:33:29,750
advantage they can get they they

891
00:33:27,919 --> 00:33:31,850
absolutely should receive and and

892
00:33:29,750 --> 00:33:35,660
analyze this information independently

893
00:33:31,850 --> 00:33:37,040
verify all of it it is a a positive step

894
00:33:35,660 --> 00:33:39,470
no matter what the motivations behind

895
00:33:37,040 --> 00:33:42,350
WikiLeaks might be but David Assange is

896
00:33:39,470 --> 00:33:44,960
saying that he is willing to to extend a

897
00:33:42,350 --> 00:33:47,449
hand and help them boy

898
00:33:44,960 --> 00:33:50,210
is that the devil and angels close I'm

899
00:33:47,450 --> 00:33:51,559
just wondering well we've seen previous

900
00:33:50,210 --> 00:33:53,059
WikiLeaks before word that hasn't been

901
00:33:51,559 --> 00:33:55,490
the case where they've exposed a lot of

902
00:33:53,059 --> 00:33:56,960
data that was very damaging and there's

903
00:33:55,490 --> 00:33:58,370
there's two components to what was

904
00:33:56,960 --> 00:33:59,870
released there's the the documents in

905
00:33:58,370 --> 00:34:01,909
the play books but there is also code

906
00:33:59,870 --> 00:34:03,620
and techniques the CIA actively used in

907
00:34:01,910 --> 00:34:05,450
order to go after different government

908
00:34:03,620 --> 00:34:07,570
agencies that seriously really goodies

909
00:34:05,450 --> 00:34:11,449
names from it's amazing wrecking crew

910
00:34:07,570 --> 00:34:13,668
crunchy lime skies elder piggie anger

911
00:34:11,449 --> 00:34:14,639
quake McNugget Magog I can understand

912
00:34:13,668 --> 00:34:17,460
but

913
00:34:14,639 --> 00:34:18,929
fully damaging both to the intelligence

914
00:34:17,460 --> 00:34:21,300
operations that we perform abroad as

915
00:34:18,929 --> 00:34:23,580
well as put you know the United States

916
00:34:21,300 --> 00:34:24,630
in harm's way against adversaries that

917
00:34:23,580 --> 00:34:26,730
is you know there were they were

918
00:34:24,630 --> 00:34:28,470
actively doing campaigns again I'm

919
00:34:26,730 --> 00:34:30,600
against these so we have to have these

920
00:34:28,469 --> 00:34:32,040
trades of craft we should definitely be

921
00:34:30,600 --> 00:34:34,799
hoarding these exploits and keeping them

922
00:34:32,040 --> 00:34:36,600
for going act after these different

923
00:34:34,800 --> 00:34:37,800
countries for what types of technology

924
00:34:36,600 --> 00:34:39,659
that they're using because the same

925
00:34:37,800 --> 00:34:41,490
things happening to us Russia China they

926
00:34:39,659 --> 00:34:42,839
all have the same I won't go through all

927
00:34:41,489 --> 00:34:43,979
the specifics and those are the kind of

928
00:34:42,840 --> 00:34:45,570
long segments but what was interesting

929
00:34:43,980 --> 00:34:47,490
that it and you could be on either side

930
00:34:45,570 --> 00:34:48,900
and so there's a lot of arguments made

931
00:34:47,489 --> 00:34:50,219
for all sides of this aisle to hey we

932
00:34:48,900 --> 00:34:51,780
the government should give all of the

933
00:34:50,219 --> 00:34:53,549
security exposures that we get better on

934
00:34:51,780 --> 00:34:56,640
defense and that's that's that's a very

935
00:34:53,550 --> 00:34:57,540
plausible way as well you know I firstly

936
00:34:56,639 --> 00:34:58,680
believe that we should keep them because

937
00:34:57,540 --> 00:35:00,509
everybody else has them as well and then

938
00:34:58,680 --> 00:35:02,609
we we actually burned them and it gets

939
00:35:00,510 --> 00:35:04,140
noticed we should fix those issues but

940
00:35:02,610 --> 00:35:05,970
you look at a lifecycle of an attack and

941
00:35:04,140 --> 00:35:07,290
what we're seeing everybody's doing the

942
00:35:05,970 --> 00:35:10,319
exact same thing regardless if you're

943
00:35:07,290 --> 00:35:12,240
the CIA the FBI a hacker pentester or

944
00:35:10,320 --> 00:35:13,890
anybody else we all follow very much the

945
00:35:12,240 --> 00:35:16,950
same consistent format about how we

946
00:35:13,890 --> 00:35:18,270
target our organizations first thing we

947
00:35:16,950 --> 00:35:19,620
do is we define who we're going to hack

948
00:35:18,270 --> 00:35:21,450
right we're going to go after a company

949
00:35:19,620 --> 00:35:23,040
we've got their individual people what

950
00:35:21,450 --> 00:35:25,319
are we going to actively go and do we

951
00:35:23,040 --> 00:35:26,880
build or buy our tools in the NSA's case

952
00:35:25,320 --> 00:35:28,620
or you create in a group they a lot of

953
00:35:26,880 --> 00:35:30,330
them are BOTS from the you know

954
00:35:28,620 --> 00:35:32,040
excellent market or third-party

955
00:35:30,330 --> 00:35:33,960
contractors or they may have on people

956
00:35:32,040 --> 00:35:36,450
at house doing them or build your own

957
00:35:33,960 --> 00:35:38,580
tools build an attack profile maybe test

958
00:35:36,450 --> 00:35:39,750
for some detection via some fishing to

959
00:35:38,580 --> 00:35:41,819
understand what organization you're

960
00:35:39,750 --> 00:35:43,080
targeting for and then from there on the

961
00:35:41,820 --> 00:35:44,400
deployment of the infrastructure that

962
00:35:43,080 --> 00:35:46,680
we're going to actively go and use and

963
00:35:44,400 --> 00:35:48,510
then the initial intrusion now in the

964
00:35:46,680 --> 00:35:50,160
security industry we have all of our

965
00:35:48,510 --> 00:35:52,380
eggs in one basket right now around that

966
00:35:50,160 --> 00:35:54,750
one component that initial intrusion so

967
00:35:52,380 --> 00:35:56,640
if our endpoint agents don't detect

968
00:35:54,750 --> 00:35:57,900
something and all of a sudden now an

969
00:35:56,640 --> 00:36:00,000
attacker is sitting on our system

970
00:35:57,900 --> 00:36:01,500
becomes much more difficult for us to

971
00:36:00,000 --> 00:36:02,730
detect the patterns of behavior about

972
00:36:01,500 --> 00:36:04,200
moving to different systems such as

973
00:36:02,730 --> 00:36:05,760
lateral movement and everything else

974
00:36:04,200 --> 00:36:07,230
that's why we design these things called

975
00:36:05,760 --> 00:36:08,610
Sims because they'd be all this

976
00:36:07,230 --> 00:36:10,440
aggregator of data that we can then use

977
00:36:08,610 --> 00:36:12,030
all this information so that we could

978
00:36:10,440 --> 00:36:13,740
you know hopefully find you know weird

979
00:36:12,030 --> 00:36:15,000
abnormal patterns in our environment but

980
00:36:13,740 --> 00:36:17,250
what we found is that there's so much

981
00:36:15,000 --> 00:36:19,440
data we have no idea what to do with it

982
00:36:17,250 --> 00:36:21,150
it's like literally all we look for now

983
00:36:19,440 --> 00:36:22,740
is if someone added a domain admin today

984
00:36:21,150 --> 00:36:24,090
the domain admins group and that's our

985
00:36:22,740 --> 00:36:26,040
that's our sim use cases that we spent

986
00:36:24,090 --> 00:36:26,440
five million dollars on right fantastic

987
00:36:26,040 --> 00:36:30,190
right

988
00:36:26,440 --> 00:36:31,420
there's a good return on investment you

989
00:36:30,190 --> 00:36:32,829
know once once we don't detect the

990
00:36:31,420 --> 00:36:34,059
persistent sucks maybe I'm using power

991
00:36:32,829 --> 00:36:35,680
shell injection I'm using a way of

992
00:36:34,059 --> 00:36:36,940
getting around application whitelisting

993
00:36:35,680 --> 00:36:38,319
there's a lot of techniques around

994
00:36:36,940 --> 00:36:40,660
application whitelisting Power Cells a

995
00:36:38,319 --> 00:36:41,890
great version red just VR 32 is also

996
00:36:40,660 --> 00:36:44,230
another green one has a built-in browser

997
00:36:41,890 --> 00:36:45,430
too which is awesome so these are all

998
00:36:44,230 --> 00:36:46,780
different techniques that you can use to

999
00:36:45,430 --> 00:36:48,480
get around things like application

1000
00:36:46,780 --> 00:36:50,980
whitelisting or traditional techniques

1001
00:36:48,480 --> 00:36:53,020
you know once I do lateral movement try

1002
00:36:50,980 --> 00:36:54,819
to find what I need get my get my

1003
00:36:53,020 --> 00:36:56,470
information and then move out maybe a

1004
00:36:54,819 --> 00:36:57,700
whole persistence if I want to on the

1005
00:36:56,470 --> 00:36:59,319
stain in the facility and more

1006
00:36:57,700 --> 00:37:01,899
information but one thing's for certain

1007
00:36:59,319 --> 00:37:04,930
humans still continue to be the largest

1008
00:37:01,900 --> 00:37:06,369
exposures we have like you know 99% of

1009
00:37:04,930 --> 00:37:09,308
the issues that we have today still come

1010
00:37:06,369 --> 00:37:11,289
to the users and so if you you make

1011
00:37:09,309 --> 00:37:12,579
something anything believable like

1012
00:37:11,289 --> 00:37:14,349
literally you could like call the

1013
00:37:12,579 --> 00:37:15,520
salesperson you're like hey I'm going to

1014
00:37:14,349 --> 00:37:16,960
give you a million dollars because I

1015
00:37:15,520 --> 00:37:18,640
need to spend it by Friday but I need to

1016
00:37:16,960 --> 00:37:20,680
infect your system with soft malicious

1017
00:37:18,640 --> 00:37:22,930
software can you open up this executable

1018
00:37:20,680 --> 00:37:23,980
it says malware died exe the sales guys

1019
00:37:22,930 --> 00:37:27,069
do me like woah am I still going to get

1020
00:37:23,980 --> 00:37:28,210
the million dollars well yeah ok long as

1021
00:37:27,069 --> 00:37:30,549
it's believable we're good right

1022
00:37:28,210 --> 00:37:32,650
so you know certain scenarios and

1023
00:37:30,549 --> 00:37:34,720
situations make things extremely easy

1024
00:37:32,650 --> 00:37:36,490
for us because people are are

1025
00:37:34,720 --> 00:37:37,839
trustworthy and in their positions were

1026
00:37:36,490 --> 00:37:39,910
designed to trust and culturally were

1027
00:37:37,839 --> 00:37:41,410
designed to trust and so when we were

1028
00:37:39,910 --> 00:37:43,509
talking about building security programs

1029
00:37:41,410 --> 00:37:46,058
we have to build a program that is built

1030
00:37:43,510 --> 00:37:48,069
off of abnormal behavior things that

1031
00:37:46,059 --> 00:37:49,390
aren't normal in our environments so the

1032
00:37:48,069 --> 00:37:51,190
times the perimeter like we have no

1033
00:37:49,390 --> 00:37:52,868
perimeter whatsoever anymore right we

1034
00:37:51,190 --> 00:37:54,700
decided to move to the cloud and all BYO

1035
00:37:52,869 --> 00:37:56,710
DS and everything else that we're doing

1036
00:37:54,700 --> 00:37:59,230
out there we've become less and less on

1037
00:37:56,710 --> 00:38:02,289
tone to more restrictions a good example

1038
00:37:59,230 --> 00:38:04,869
is we decided to get next-gen with with

1039
00:38:02,289 --> 00:38:06,039
next-generation firewalls right so we

1040
00:38:04,869 --> 00:38:07,750
all have next-generation firewalls now

1041
00:38:06,039 --> 00:38:12,130
or next-generation right it all stopped

1042
00:38:07,750 --> 00:38:13,750
all the hacking right let me ask when

1043
00:38:12,130 --> 00:38:14,950
you went with that next-gen solution ok

1044
00:38:13,750 --> 00:38:17,500
so let's just say you're a Cisco shop

1045
00:38:14,950 --> 00:38:20,049
right and and you have you know all

1046
00:38:17,500 --> 00:38:21,789
these awesome old-school Cisco guys that

1047
00:38:20,049 --> 00:38:22,900
are all command-line dudes and like you

1048
00:38:21,789 --> 00:38:23,980
know like they're rocking out and like

1049
00:38:22,900 --> 00:38:25,960
you don't talk to them because they're

1050
00:38:23,980 --> 00:38:27,339
like you know deep into the crazy

1051
00:38:25,960 --> 00:38:29,170
network voodoo stuff that they do and

1052
00:38:27,339 --> 00:38:30,609
Cisco and you're like hey we're going to

1053
00:38:29,170 --> 00:38:32,200
go a Palo Alto because like your next

1054
00:38:30,609 --> 00:38:33,369
generation right and you have all these

1055
00:38:32,200 --> 00:38:35,618
dudes that have like you know 10 years

1056
00:38:33,369 --> 00:38:36,819
of Cisco experience you're like hey

1057
00:38:35,619 --> 00:38:38,230
we're going to switch you to a brand new

1058
00:38:36,819 --> 00:38:39,940
technology of no idea what it does

1059
00:38:38,230 --> 00:38:42,310
that's all gooey

1060
00:38:39,940 --> 00:38:43,150
to be great right yeah yeah okay so so

1061
00:38:42,310 --> 00:38:44,740
what we're going to do is we're going to

1062
00:38:43,150 --> 00:38:45,970
redesign our network architecture to do

1063
00:38:44,740 --> 00:38:47,950
network segmentation to find roles

1064
00:38:45,970 --> 00:38:49,120
responsibilities and actually RER

1065
00:38:47,950 --> 00:38:50,859
connect our solutions so that we no

1066
00:38:49,120 --> 00:38:53,500
longer have like it's wide open network

1067
00:38:50,860 --> 00:38:55,210
right or are we going to use the Cisco

1068
00:38:53,500 --> 00:38:58,860
importer tool to Palo Alto and take

1069
00:38:55,210 --> 00:39:01,810
those 10 years of about an hour next-gen

1070
00:38:58,860 --> 00:39:03,430
fantastic so a lot of things that we do

1071
00:39:01,810 --> 00:39:05,650
don't make sense in the industry but hey

1072
00:39:03,430 --> 00:39:06,790
that's fine we have the tools that we

1073
00:39:05,650 --> 00:39:08,500
already have in our environments they

1074
00:39:06,790 --> 00:39:09,880
work we just have to think a little bit

1075
00:39:08,500 --> 00:39:11,980
differently on how we protect our

1076
00:39:09,880 --> 00:39:14,320
infrastructure a good example is we move

1077
00:39:11,980 --> 00:39:17,230
to the cloud you know we need to either

1078
00:39:14,320 --> 00:39:18,430
a have the same type of detection

1079
00:39:17,230 --> 00:39:21,130
capabilities or prevention capabilities

1080
00:39:18,430 --> 00:39:23,649
or better right that would be my

1081
00:39:21,130 --> 00:39:24,910
criteria to reduce risk or to have the

1082
00:39:23,650 --> 00:39:26,020
same level of risk that I've already

1083
00:39:24,910 --> 00:39:28,690
looked at when moving to a new

1084
00:39:26,020 --> 00:39:32,140
infrastructure now a good example is is

1085
00:39:28,690 --> 00:39:33,850
on office 365 I got a little bit of a

1086
00:39:32,140 --> 00:39:34,900
tiff out well with somebody on Twitter

1087
00:39:33,850 --> 00:39:36,160
recently one of the employees at

1088
00:39:34,900 --> 00:39:39,820
Microsoft long story I'm not going to go

1089
00:39:36,160 --> 00:39:40,899
into it at all it's all go we're all

1090
00:39:39,820 --> 00:39:42,880
happy now we're all friends we Pat each

1091
00:39:40,900 --> 00:39:45,460
other back but what it caused me to do

1092
00:39:42,880 --> 00:39:47,920
is do analysis around office 365 and its

1093
00:39:45,460 --> 00:39:49,870
protection mechanisms now obviously five

1094
00:39:47,920 --> 00:39:51,790
has a product called ATP advanced threat

1095
00:39:49,870 --> 00:39:53,109
protection or a promoters that advance

1096
00:39:51,790 --> 00:39:54,970
reputation has two components you have

1097
00:39:53,110 --> 00:39:56,980
safe attachment and you have Seif links

1098
00:39:54,970 --> 00:40:00,490
now save attachments is supposed to be a

1099
00:39:56,980 --> 00:40:02,110
competitor to Palo Alto wildfire or fire

1100
00:40:00,490 --> 00:40:03,459
I or things else what's interesting

1101
00:40:02,110 --> 00:40:05,620
about that is if you send an email it

1102
00:40:03,460 --> 00:40:06,730
takes 15 minutes of analysis so that

1103
00:40:05,620 --> 00:40:08,890
means if someone sends you an attachment

1104
00:40:06,730 --> 00:40:12,040
you have to wait 15 minutes does that

1105
00:40:08,890 --> 00:40:13,359
work for anybody in business can you

1106
00:40:12,040 --> 00:40:14,680
imagine like hey we're gonna put in this

1107
00:40:13,360 --> 00:40:17,290
we're gonna go to officers if I be up to

1108
00:40:14,680 --> 00:40:19,450
8 15 minutes to get your attachment ok

1109
00:40:17,290 --> 00:40:21,310
I'm sure once I'm sure it's fine anyways

1110
00:40:19,450 --> 00:40:23,500
so I started doing analysis around hey

1111
00:40:21,310 --> 00:40:25,450
I'm going to office 365 am I going to

1112
00:40:23,500 --> 00:40:27,490
get the same or better than I could have

1113
00:40:25,450 --> 00:40:29,319
on Prem and so when I started looking at

1114
00:40:27,490 --> 00:40:30,640
what's a flakes at first now what's

1115
00:40:29,320 --> 00:40:32,710
interesting about safe links is they

1116
00:40:30,640 --> 00:40:34,750
tout dynamic inspection of content also

1117
00:40:32,710 --> 00:40:36,520
other stuff right now what they do is

1118
00:40:34,750 --> 00:40:39,100
they when you get a link sent to you in

1119
00:40:36,520 --> 00:40:40,780
an email it rewrites the link and makes

1120
00:40:39,100 --> 00:40:42,490
it a safe links so when you hover over

1121
00:40:40,780 --> 00:40:45,730
the link it says safe links now why is

1122
00:40:42,490 --> 00:40:49,000
that a problem what do we tell our users

1123
00:40:45,730 --> 00:40:49,930
to do over over that link right no

1124
00:40:49,000 --> 00:40:51,850
longer you do it anymore you have to

1125
00:40:49,930 --> 00:40:53,348
trust Microsoft now what I started doing

1126
00:40:51,850 --> 00:40:54,578
is saying ok what was mine Mike

1127
00:40:53,349 --> 00:40:56,380
sugar maybe have some amazing

1128
00:40:54,579 --> 00:40:57,430
protections and I can trust it my users

1129
00:40:56,380 --> 00:40:57,819
can just click whatever they want to

1130
00:40:57,430 --> 00:40:59,288
right

1131
00:40:57,819 --> 00:41:01,299
what I found out is they aren't doing

1132
00:40:59,289 --> 00:41:02,950
anything if they have a basically a

1133
00:41:01,299 --> 00:41:05,259
static black list of sites that they

1134
00:41:02,950 --> 00:41:07,960
know are compromised sites they do a

1135
00:41:05,259 --> 00:41:09,940
comparison to Iran m/s 14 o 78 which is

1136
00:41:07,960 --> 00:41:11,289
an IE memory corruption flaw that gets

1137
00:41:09,940 --> 00:41:12,940
checked about every single antivirus

1138
00:41:11,289 --> 00:41:14,999
vendor out there got right through an

1139
00:41:12,940 --> 00:41:17,799
executed code and crash my browser I

1140
00:41:14,999 --> 00:41:19,149
used HCA files that were not octa skated

1141
00:41:17,799 --> 00:41:20,890
doing PowerShell injections got right

1142
00:41:19,150 --> 00:41:22,690
past that I'm like okay well let me just

1143
00:41:20,890 --> 00:41:25,150
write it like random malware like I mean

1144
00:41:22,690 --> 00:41:26,319
you sub seven from like the 90s got

1145
00:41:25,150 --> 00:41:27,819
right past that no problem download

1146
00:41:26,319 --> 00:41:30,519
executable is no problem

1147
00:41:27,819 --> 00:41:31,599
so doesn't do anything safe attachment

1148
00:41:30,519 --> 00:41:33,729
same thing if it does if it gets past

1149
00:41:31,599 --> 00:41:35,440
Windows Defender you're okay so you can

1150
00:41:33,729 --> 00:41:37,509
it does do a little bit on macro so

1151
00:41:35,440 --> 00:41:38,470
don't use auto open just use unclick so

1152
00:41:37,509 --> 00:41:40,239
when something clicks it it just

1153
00:41:38,470 --> 00:41:44,049
compromised them anyway no big deal

1154
00:41:40,239 --> 00:41:45,759
all good so we have to think about

1155
00:41:44,049 --> 00:41:47,380
things a little bit differently and I'm

1156
00:41:45,759 --> 00:41:48,910
a huge advocate as is the number of us

1157
00:41:47,380 --> 00:41:50,559
in industry I'm like Matthew graver

1158
00:41:48,910 --> 00:41:51,640
who's a fantastic resource he now works

1159
00:41:50,559 --> 00:41:53,259
at Microsoft so they're gonna be doing

1160
00:41:51,640 --> 00:41:54,999
fantastic things but this isn't a ripoff

1161
00:41:53,259 --> 00:41:57,670
Microsoft it anyway I think it's very

1162
00:41:54,999 --> 00:41:59,468
difficult to put you know things in the

1163
00:41:57,670 --> 00:42:01,539
cloud and scale to the size that

1164
00:41:59,469 --> 00:42:03,400
Microsoft has to deal with so they will

1165
00:42:01,539 --> 00:42:04,630
get better and and with the team that

1166
00:42:03,400 --> 00:42:07,210
they have in Matthew an everybody else

1167
00:42:04,630 --> 00:42:09,009
in lis homes and you know just Justin

1168
00:42:07,210 --> 00:42:10,539
over the Creator PowerShell the father

1169
00:42:09,009 --> 00:42:11,920
PowerShell they have some brilliant

1170
00:42:10,539 --> 00:42:14,519
brilliant people there so they will get

1171
00:42:11,920 --> 00:42:17,349
better but right now I not not confident

1172
00:42:14,519 --> 00:42:18,488
but the concept unknown good is saying

1173
00:42:17,349 --> 00:42:20,430
okay what's my baseline in my

1174
00:42:18,489 --> 00:42:23,170
environment and how do I make it better

1175
00:42:20,430 --> 00:42:25,390
how do I look for deviations of behavior

1176
00:42:23,170 --> 00:42:26,650
in my environment that are abnormal so

1177
00:42:25,390 --> 00:42:27,940
you've seen to certain concepts of this

1178
00:42:26,650 --> 00:42:29,259
come out like purple teaming and hunt

1179
00:42:27,940 --> 00:42:30,910
teaming looking for things that are

1180
00:42:29,259 --> 00:42:32,619
outside of our traditional monitoring

1181
00:42:30,910 --> 00:42:34,299
detection programs of hey there's an

1182
00:42:32,619 --> 00:42:35,559
alarm let's go investigate that alarm

1183
00:42:34,299 --> 00:42:37,089
there are things that we need to do

1184
00:42:35,559 --> 00:42:40,299
outside of that to make a little bit

1185
00:42:37,089 --> 00:42:41,170
better the first thing of known-good is

1186
00:42:40,299 --> 00:42:42,999
baselining

1187
00:42:41,170 --> 00:42:44,140
I'm a huge advocate of application

1188
00:42:42,999 --> 00:42:46,569
whitelisting everybody cringes when I

1189
00:42:44,140 --> 00:42:47,859
say that but you need to do it you need

1190
00:42:46,569 --> 00:42:49,359
to say hey application but you say by

1191
00:42:47,859 --> 00:42:50,529
the way it's got a lot easier like if

1192
00:42:49,359 --> 00:42:53,440
you could just say hey I'm gonna block

1193
00:42:50,529 --> 00:42:54,640
all not non code signing executables in

1194
00:42:53,440 --> 00:42:55,059
my environment only put exceptions in

1195
00:42:54,640 --> 00:42:57,160
for where I know

1196
00:42:55,059 --> 00:42:59,140
you literally reduce like 90% of your

1197
00:42:57,160 --> 00:43:01,180
noise out there like 90% of the malware

1198
00:42:59,140 --> 00:43:02,828
infections 90% of the ransomware

1199
00:43:01,180 --> 00:43:05,440
you know you literally get 90 percent of

1200
00:43:02,829 --> 00:43:07,020
your noise gone by a really easy tick

1201
00:43:05,440 --> 00:43:08,490
and if your vendors aren't come

1202
00:43:07,020 --> 00:43:09,780
signing you need to boot them the hell

1203
00:43:08,490 --> 00:43:12,419
out of your company cuz that's not right

1204
00:43:09,780 --> 00:43:14,040
so don't allow any non-code sign so you

1205
00:43:12,420 --> 00:43:15,990
compiled you can do it by default in

1206
00:43:14,040 --> 00:43:17,670
device guard and Windows 10 you have the

1207
00:43:15,990 --> 00:43:20,399
the technology right now to do it right

1208
00:43:17,670 --> 00:43:22,320
now so base lining your environment

1209
00:43:20,400 --> 00:43:23,370
unknown unknown good and what your

1210
00:43:22,320 --> 00:43:24,900
environment isn't based on your

1211
00:43:23,370 --> 00:43:26,910
configurations is one thing that you can

1212
00:43:24,900 --> 00:43:28,980
do to make it substantially easier right

1213
00:43:26,910 --> 00:43:30,540
today to make it harder for attackers

1214
00:43:28,980 --> 00:43:32,460
the second thing is monitoring

1215
00:43:30,540 --> 00:43:33,660
monitoring for deviations there are ways

1216
00:43:32,460 --> 00:43:35,730
of circumventing application

1217
00:43:33,660 --> 00:43:37,830
whitelisting monitor off of those why is

1218
00:43:35,730 --> 00:43:40,250
notepad.exe contacting not to China

1219
00:43:37,830 --> 00:43:42,330
that's straight up not legit right

1220
00:43:40,250 --> 00:43:44,610
by the way equation group likes using

1221
00:43:42,330 --> 00:43:46,049
minesweeper so why is minesweeper

1222
00:43:44,610 --> 00:43:48,090
beaconing out to an infrastructure in

1223
00:43:46,050 --> 00:43:49,560
the United States strange that legit you

1224
00:43:48,090 --> 00:43:51,810
know you're probably targeted NSA right

1225
00:43:49,560 --> 00:43:54,480
so minesweeper is also one there's like

1226
00:43:51,810 --> 00:43:56,040
too cool for notepad and then when you

1227
00:43:54,480 --> 00:43:57,690
figure out is when I start to monitor

1228
00:43:56,040 --> 00:44:00,150
flows deviations what can we do to help

1229
00:43:57,690 --> 00:44:01,770
after that so they started getting some

1230
00:44:00,150 --> 00:44:03,480
of cool stuff however it looks a lateral

1231
00:44:01,770 --> 00:44:06,390
movement lateral move it is very easy to

1232
00:44:03,480 --> 00:44:07,680
spot why is one user minting um and you

1233
00:44:06,390 --> 00:44:10,170
can do this in your sims by the way I

1234
00:44:07,680 --> 00:44:12,810
look for network login type 3 which is

1235
00:44:10,170 --> 00:44:14,280
remote logins look for a key length of 0

1236
00:44:12,810 --> 00:44:16,500
which means that they're using a lower

1237
00:44:14,280 --> 00:44:18,690
level protocol such as SMB version 1 and

1238
00:44:16,500 --> 00:44:20,280
maintain record active sessions are on

1239
00:44:18,690 --> 00:44:22,290
who's logging into what systems based on

1240
00:44:20,280 --> 00:44:23,820
those two criteria you can see where

1241
00:44:22,290 --> 00:44:26,430
people are logging into why is Jane and

1242
00:44:23,820 --> 00:44:28,650
sales now logging into Bob and IT that's

1243
00:44:26,430 --> 00:44:29,970
not legitimate that's weird behavior why

1244
00:44:28,650 --> 00:44:31,470
is this service account now spring

1245
00:44:29,970 --> 00:44:33,060
across the network in our environment

1246
00:44:31,470 --> 00:44:34,080
that's lateral movement those are things

1247
00:44:33,060 --> 00:44:36,390
that you can predict patterns on

1248
00:44:34,080 --> 00:44:37,950
deception techniques putting in fake

1249
00:44:36,390 --> 00:44:40,259
things in your environment such as fake

1250
00:44:37,950 --> 00:44:41,910
credentials on spraying multicast across

1251
00:44:40,260 --> 00:44:44,010
your network giving things for attackers

1252
00:44:41,910 --> 00:44:45,720
like hey make a domain admin account

1253
00:44:44,010 --> 00:44:47,370
that is like the most God of all domain

1254
00:44:45,720 --> 00:44:49,470
names make them enterprise admin I make

1255
00:44:47,370 --> 00:44:51,150
make make that that that that domain

1256
00:44:49,470 --> 00:44:52,950
name account look like the sexiest thing

1257
00:44:51,150 --> 00:44:55,080
ever right I mean it's like the super

1258
00:44:52,950 --> 00:44:57,600
God of your entire infrastructure

1259
00:44:55,080 --> 00:44:58,980
give it a super long password and then

1260
00:44:57,600 --> 00:45:00,330
use something like honey tokens and

1261
00:44:58,980 --> 00:45:01,560
spray that password across the board and

1262
00:45:00,330 --> 00:45:03,360
wait for someone to login with that

1263
00:45:01,560 --> 00:45:04,170
account now it put a fake password in

1264
00:45:03,360 --> 00:45:05,910
there you know what I'm logging into

1265
00:45:04,170 --> 00:45:07,050
your infrastructure to be bad but you

1266
00:45:05,910 --> 00:45:08,850
know when you see a failed login at

1267
00:45:07,050 --> 00:45:10,170
after that one user account that's just

1268
00:45:08,850 --> 00:45:12,089
sure sign indicator that something's

1269
00:45:10,170 --> 00:45:14,040
wrong I'm looking up for suspicious

1270
00:45:12,090 --> 00:45:16,230
behavior you know PowerShell injection

1271
00:45:14,040 --> 00:45:17,130
device guard is so much more um if

1272
00:45:16,230 --> 00:45:18,930
you're from if you want to look up the

1273
00:45:17,130 --> 00:45:21,030
honey tokens on one of our guys a trust

1274
00:45:18,930 --> 00:45:21,359
it's like been 10 if you go to github

1275
00:45:21,030 --> 00:45:24,869
that

1276
00:45:21,359 --> 00:45:26,400
/ Ben 0xa he created a honey tokens

1277
00:45:24,869 --> 00:45:28,559
PowerShell script that you can run as a

1278
00:45:26,400 --> 00:45:30,329
scheduled task that creates deception

1279
00:45:28,559 --> 00:45:32,940
tokens across your network as well as

1280
00:45:30,329 --> 00:45:34,680
does multicast so you can send fake lmn

1281
00:45:32,940 --> 00:45:36,029
our usernames and passwords across the

1282
00:45:34,680 --> 00:45:37,680
network can be see that username with a

1283
00:45:36,029 --> 00:45:38,819
failed login attempt there's a good

1284
00:45:37,680 --> 00:45:41,609
chance that someone's using invader

1285
00:45:38,819 --> 00:45:43,259
respond during the infrastructure pass

1286
00:45:41,609 --> 00:45:46,348
the hash detection very easy to detect

1287
00:45:43,259 --> 00:45:47,969
on event log 4624 login type 3 remote

1288
00:45:46,349 --> 00:45:49,589
login key link 0 which means that it's

1289
00:45:47,969 --> 00:45:52,380
using a lower level protocol and the

1290
00:45:49,589 --> 00:45:55,259
account name ntlmssp now there might be

1291
00:45:52,380 --> 00:45:57,719
some false positives things like necess

1292
00:45:55,259 --> 00:46:00,229
services scanners can use on low level

1293
00:45:57,719 --> 00:46:02,670
protocols to authenticate with but you

1294
00:46:00,229 --> 00:46:04,140
waitlist those and look for deviations

1295
00:46:02,670 --> 00:46:07,319
to pattern off of those so another great

1296
00:46:04,140 --> 00:46:08,759
one suspicious processes these are some

1297
00:46:07,319 --> 00:46:11,190
process that you can use they get remote

1298
00:46:08,759 --> 00:46:11,640
code execution to bypass application

1299
00:46:11,190 --> 00:46:15,089
whitelisting

1300
00:46:11,640 --> 00:46:16,950
tracker 90hz run dll 32 msbuild

1301
00:46:15,089 --> 00:46:18,680
you see msbuild calling out to unc path

1302
00:46:16,950 --> 00:46:22,259
that's probably not a good good thing

1303
00:46:18,680 --> 00:46:24,440
register our city to CBD THC as well as

1304
00:46:22,259 --> 00:46:26,640
many many more that's out there

1305
00:46:24,440 --> 00:46:28,499
monitoring for specific registry changes

1306
00:46:26,640 --> 00:46:30,328
everybody familiar with the sticky keys

1307
00:46:28,499 --> 00:46:31,890
um thing that you can do this like it's

1308
00:46:30,329 --> 00:46:33,029
like old-school right like you know back

1309
00:46:31,890 --> 00:46:34,650
in the day we feel like you know reboot

1310
00:46:33,029 --> 00:46:36,839
and like kali and then rename like you

1311
00:46:34,650 --> 00:46:38,670
know or backtrack or wapis and iraq's

1312
00:46:36,839 --> 00:46:40,469
before that you still like take you know

1313
00:46:38,670 --> 00:46:42,209
command a DHT and then rename it to set

1314
00:46:40,469 --> 00:46:44,309
HCG which is sticky keys then you reboot

1315
00:46:42,209 --> 00:46:46,348
the computer a shift key five times and

1316
00:46:44,309 --> 00:46:48,239
it pop about command prompt running a

1317
00:46:46,349 --> 00:46:49,769
system now you get a reboot during that

1318
00:46:48,239 --> 00:46:51,119
period of time well with this registry

1319
00:46:49,769 --> 00:46:52,799
key you don't have to reboot you can

1320
00:46:51,119 --> 00:46:54,479
actually set on a specific window of

1321
00:46:52,799 --> 00:46:56,579
Windows protective process and debug

1322
00:46:54,479 --> 00:46:58,379
mode and give it another specific

1323
00:46:56,579 --> 00:47:01,170
executable and so you can actually

1324
00:46:58,380 --> 00:47:02,249
backdoor on the new sticky keys in

1325
00:47:01,170 --> 00:47:03,809
environment that what's interesting is

1326
00:47:02,249 --> 00:47:06,479
the past 5 pen test that I've been on

1327
00:47:03,809 --> 00:47:09,930
past 5 I have found sticky keys on all

1328
00:47:06,479 --> 00:47:11,009
five machines developers love those guys

1329
00:47:09,930 --> 00:47:13,979
they forget to pass this all the time

1330
00:47:11,009 --> 00:47:14,969
guys in Galilee they forget their

1331
00:47:13,979 --> 00:47:16,229
passwords all the time and they'll use

1332
00:47:14,969 --> 00:47:16,829
sticky keys and forget to change it back

1333
00:47:16,229 --> 00:47:18,629
afterwards

1334
00:47:16,829 --> 00:47:19,890
so I recommend going through your

1335
00:47:18,630 --> 00:47:20,969
environment looking for sticky keys

1336
00:47:19,890 --> 00:47:23,598
because they're always out there for

1337
00:47:20,969 --> 00:47:26,430
some reason I don't know why I'm

1338
00:47:23,599 --> 00:47:28,469
detecting non PowerShell stuff MPs is

1339
00:47:26,430 --> 00:47:30,509
another thing from from Ben you can do

1340
00:47:28,469 --> 00:47:32,430
things like a inject PowerShell without

1341
00:47:30,509 --> 00:47:35,040
ever using PowerShell itself you can

1342
00:47:32,430 --> 00:47:38,190
detect that if you see

1343
00:47:35,040 --> 00:47:40,109
system management automation DLL running

1344
00:47:38,190 --> 00:47:42,390
from not power saw a THC and not power

1345
00:47:40,109 --> 00:47:43,529
shot underscore is exe it's probably a

1346
00:47:42,390 --> 00:47:45,600
good indication that someone's trying to

1347
00:47:43,530 --> 00:47:48,500
inject and use PowerShell in your

1348
00:47:45,600 --> 00:47:51,509
environment to actually go and use it

1349
00:47:48,500 --> 00:47:53,280
technique specific commands now we try

1350
00:47:51,510 --> 00:47:54,720
to flag off of things like encoded

1351
00:47:53,280 --> 00:47:57,000
command and things like that that's not

1352
00:47:54,720 --> 00:47:58,200
a very reliable method like we go into

1353
00:47:57,000 --> 00:47:58,980
customers all time they have a carbon

1354
00:47:58,200 --> 00:48:01,740
black any of these things called

1355
00:47:58,980 --> 00:48:04,410
watchlist but oh we look for DHE - you

1356
00:48:01,740 --> 00:48:06,868
see - en - en co and co2 come in do you

1357
00:48:04,410 --> 00:48:08,100
know you it's possible to using coded

1358
00:48:06,869 --> 00:48:10,920
command without ever calling a code of

1359
00:48:08,100 --> 00:48:12,089
command ever so there's a recent version

1360
00:48:10,920 --> 00:48:17,010
of unicorn that just updated recently

1361
00:48:12,090 --> 00:48:18,210
and here's using - string and this never

1362
00:48:17,010 --> 00:48:19,500
calls in co2 command ever and it

1363
00:48:18,210 --> 00:48:21,359
resembled a co2 command after it's

1364
00:48:19,500 --> 00:48:22,740
executed so you never call on co2

1365
00:48:21,359 --> 00:48:25,380
command you get full execution rights

1366
00:48:22,740 --> 00:48:26,879
it's all random eyes variable names and

1367
00:48:25,380 --> 00:48:28,920
everything else so doesn't get picked up

1368
00:48:26,880 --> 00:48:30,300
by any antivirus and it also chunks the

1369
00:48:28,920 --> 00:48:31,980
commands up so the PowerShell commands

1370
00:48:30,300 --> 00:48:34,050
are chunked up so if you take one string

1371
00:48:31,980 --> 00:48:36,210
it's not basics different going to be at

1372
00:48:34,050 --> 00:48:37,890
everything else it works perfectly fine

1373
00:48:36,210 --> 00:48:39,300
so a way of getting around most of the

1374
00:48:37,890 --> 00:48:40,799
detection capabilities just by using two

1375
00:48:39,300 --> 00:48:44,250
string there's a whole bunch of them ah

1376
00:48:40,800 --> 00:48:45,450
daniel has invoke a key station which

1377
00:48:44,250 --> 00:48:46,920
totally mangles the code which you're

1378
00:48:45,450 --> 00:48:48,689
never going to see you need to be

1379
00:48:46,920 --> 00:48:50,220
looking more at the length size and

1380
00:48:48,690 --> 00:48:55,290
behavior on PowerShell than anything

1381
00:48:50,220 --> 00:48:57,419
else a good example of power so is

1382
00:48:55,290 --> 00:49:01,020
recently John stranded us John strands

1383
00:48:57,420 --> 00:49:04,740
company Bo who's loved John and Bono's

1384
00:49:01,020 --> 00:49:07,040
guys are amazing folks they did a part

1385
00:49:04,740 --> 00:49:09,509
one of five series I think of silence

1386
00:49:07,040 --> 00:49:10,920
and so obviously a lot of claims being

1387
00:49:09,510 --> 00:49:12,510
made around artificial intelligence and

1388
00:49:10,920 --> 00:49:13,830
machine learning we are nowhere near

1389
00:49:12,510 --> 00:49:15,780
artificial intelligence and machine

1390
00:49:13,830 --> 00:49:17,279
learning in this industry by the way but

1391
00:49:15,780 --> 00:49:18,960
one thing that was interesting is sign

1392
00:49:17,280 --> 00:49:20,700
Lansford flag on if you ever ran

1393
00:49:18,960 --> 00:49:23,100
PowerShell that eh scene so what do you

1394
00:49:20,700 --> 00:49:24,480
do just rename powershot ADC to whatever

1395
00:49:23,100 --> 00:49:27,750
you want student no longer detected it

1396
00:49:24,480 --> 00:49:29,820
so simple things to get around a lot of

1397
00:49:27,750 --> 00:49:32,910
these technologies out there based off

1398
00:49:29,820 --> 00:49:34,460
of that and not off of behavior if

1399
00:49:32,910 --> 00:49:36,569
you're not familiar with system on

1400
00:49:34,460 --> 00:49:38,940
system on is absolutely amazing it's

1401
00:49:36,570 --> 00:49:41,160
free so a system on is a Microsoft

1402
00:49:38,940 --> 00:49:43,020
product it's MSI install and it opens up

1403
00:49:41,160 --> 00:49:44,910
what's called etw or event log tracing

1404
00:49:43,020 --> 00:49:47,520
and it exposes a lot of things like

1405
00:49:44,910 --> 00:49:47,940
process injection a lot of memory things

1406
00:49:47,520 --> 00:49:49,860
that are half

1407
00:49:47,940 --> 00:49:50,940
out there and you can put these in and

1408
00:49:49,860 --> 00:49:52,530
use like windows event forwarding a

1409
00:49:50,940 --> 00:49:54,240
movement to your sim and there's so many

1410
00:49:52,530 --> 00:49:55,950
things you can detect with just egw it's

1411
00:49:54,240 --> 00:49:57,390
a little small footprint environment but

1412
00:49:55,950 --> 00:49:59,879
you can design things like Mimi Kats a

1413
00:49:57,390 --> 00:50:02,009
good example Mimi Katz calls vault Clyde

1414
00:49:59,880 --> 00:50:03,480
at dll and if you see that happening

1415
00:50:02,010 --> 00:50:05,370
from a non-windows process is probably

1416
00:50:03,480 --> 00:50:06,960
good indication that he had Mimi cats in

1417
00:50:05,370 --> 00:50:08,220
your environment or why is power cell

1418
00:50:06,960 --> 00:50:09,810
calling the baulk line ideal I should

1419
00:50:08,220 --> 00:50:11,759
never happen in any way shape or form so

1420
00:50:09,810 --> 00:50:12,900
patterns are behavior you can do you can

1421
00:50:11,760 --> 00:50:14,850
find everything from like process

1422
00:50:12,900 --> 00:50:16,590
injection I'm injecting my memory space

1423
00:50:14,850 --> 00:50:18,180
into another memory space sis Mon sees

1424
00:50:16,590 --> 00:50:19,410
all that so those are great things that

1425
00:50:18,180 --> 00:50:21,270
you can look for I'm gonna get

1426
00:50:19,410 --> 00:50:24,350
indicators off of just based off a free

1427
00:50:21,270 --> 00:50:26,310
stuff that's out there but regardless

1428
00:50:24,350 --> 00:50:27,870
though I just went through a lot of

1429
00:50:26,310 --> 00:50:30,330
information right and I'm about poster

1430
00:50:27,870 --> 00:50:32,339
slides up but regardless of what we talk

1431
00:50:30,330 --> 00:50:34,290
about this stuff takes hard work it

1432
00:50:32,340 --> 00:50:35,700
requires us actually understanding what

1433
00:50:34,290 --> 00:50:37,680
our environment is first having good

1434
00:50:35,700 --> 00:50:39,390
configuration management good you know

1435
00:50:37,680 --> 00:50:40,950
patch management things that we all talk

1436
00:50:39,390 --> 00:50:42,830
about as the foundation of the security

1437
00:50:40,950 --> 00:50:44,850
principles which we should be doing and

1438
00:50:42,830 --> 00:50:46,830
focusing on making application

1439
00:50:44,850 --> 00:50:49,080
whitelisting a priority and then looking

1440
00:50:46,830 --> 00:50:50,880
for deviations of patterns in there it's

1441
00:50:49,080 --> 00:50:52,710
just a matter is it is hard work it

1442
00:50:50,880 --> 00:50:54,030
takes a lot of effort but it's something

1443
00:50:52,710 --> 00:50:55,830
that once you get to a maintainable

1444
00:50:54,030 --> 00:50:57,210
state it is manageable it is something

1445
00:50:55,830 --> 00:50:59,580
that you can actually go and use and it

1446
00:50:57,210 --> 00:51:00,990
reduces our risk substantially for

1447
00:50:59,580 --> 00:51:02,640
technology you probably already have in

1448
00:51:00,990 --> 00:51:04,109
your company today does it require

1449
00:51:02,640 --> 00:51:05,940
purchasing a new piece of technology or

1450
00:51:04,110 --> 00:51:07,710
going something next generation it

1451
00:51:05,940 --> 00:51:09,630
allows you to use what you have in your

1452
00:51:07,710 --> 00:51:10,920
existing tool sets be able to leverage

1453
00:51:09,630 --> 00:51:12,900
what we see a lot of these these

1454
00:51:10,920 --> 00:51:14,400
specific attacks happening what the

1455
00:51:12,900 --> 00:51:16,140
equation group did is no different these

1456
00:51:14,400 --> 00:51:18,030
lateral movement you should be able to

1457
00:51:16,140 --> 00:51:19,830
detect that you mean they use some crazy

1458
00:51:18,030 --> 00:51:22,200
awesome 0 that no one's ever seen before

1459
00:51:19,830 --> 00:51:23,340
using SMB version 1 that's all memory as

1460
00:51:22,200 --> 00:51:26,009
soon as they move the different systems

1461
00:51:23,340 --> 00:51:27,810
you should spot-on no one person being

1462
00:51:26,010 --> 00:51:29,400
compromised is irrelevant compared to

1463
00:51:27,810 --> 00:51:31,410
the mass organization or company being

1464
00:51:29,400 --> 00:51:32,640
compromised but it requires us to do and

1465
00:51:31,410 --> 00:51:33,930
understanding around what our

1466
00:51:32,640 --> 00:51:37,160
environment is first in order to do it

1467
00:51:33,930 --> 00:51:37,160
last but not least

1468
00:51:37,859 --> 00:51:45,630
oh alright but no I just joking at your

1469
00:51:43,709 --> 00:51:47,038
fair fair play but I want to thank you

1470
00:51:45,630 --> 00:51:50,690
only thing everybody who puts on b-sides

1471
00:51:47,039 --> 00:51:50,690
I made this possible thank you very much

1472
00:51:58,240 --> 00:52:00,299
you

