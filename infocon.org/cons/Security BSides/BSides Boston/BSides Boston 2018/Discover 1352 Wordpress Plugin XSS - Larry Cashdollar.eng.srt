1
00:00:07,680 --> 00:00:18,720
I like the not quite hear that in the

2
00:00:13,650 --> 00:00:23,400
title yeah yeah yeah so we'll get into

3
00:00:18,720 --> 00:00:27,119
that so I'm Malorie cashdollar a hog is

4
00:00:23,400 --> 00:00:30,810
on Billy researcher working akamai I've

5
00:00:27,119 --> 00:00:33,120
been doing this since 1998 was a first

6
00:00:30,810 --> 00:00:35,879
one will be found in SGI Eric's and mini

7
00:00:33,120 --> 00:00:39,030
keys to get me room and subsequently

8
00:00:35,879 --> 00:00:42,989
great can I SGI to piss off a bunch of

9
00:00:39,030 --> 00:00:47,670
army army admirals and generals i'm not

10
00:00:42,989 --> 00:00:49,620
sure what they were angry but yeah so

11
00:00:47,670 --> 00:00:52,200
HTTP penetration testing I was what I

12
00:00:49,620 --> 00:00:54,209
was winning back then bagdana was a

13
00:00:52,200 --> 00:00:56,640
little less formal my boss pretty much

14
00:00:54,210 --> 00:00:58,350
said we want you to breaks up she's

15
00:00:56,640 --> 00:01:01,800
going to be good at it you tell us about

16
00:00:58,350 --> 00:01:03,420
it when you do it and usually did unless

17
00:01:01,800 --> 00:01:06,780
I broke something like that and they're

18
00:01:03,420 --> 00:01:10,490
cold later when it cool down I have for

19
00:01:06,780 --> 00:01:14,310
100 cd's my name everything ranges from

20
00:01:10,490 --> 00:01:16,949
buffer overflows to exploiting citywide

21
00:01:14,310 --> 00:01:20,280
ihrough binaries for ten race conditions

22
00:01:16,950 --> 00:01:24,750
to wordpress plugins for inclusion stuff

23
00:01:20,280 --> 00:01:28,170
like that I work in alkaline Security

24
00:01:24,750 --> 00:01:30,360
Response keen eye and Patrick wasn't

25
00:01:28,170 --> 00:01:31,950
that he wasn't in that he wasn't that

26
00:01:30,360 --> 00:01:34,890
group for a while and you decided leave

27
00:01:31,950 --> 00:01:37,770
us let me in the bag he was the only guy

28
00:01:34,890 --> 00:01:39,960
in our office of the guys down in North

29
00:01:37,770 --> 00:01:44,130
Carolina the other guys are in Florida

30
00:01:39,960 --> 00:01:45,720
so now my boss my koon who's at least

31
00:01:44,130 --> 00:01:50,699
two feet taller than I am has only one

32
00:01:45,720 --> 00:01:53,039
person to take on he doesn't pick on you

33
00:01:50,700 --> 00:01:55,380
guys he just picks on me he just picks

34
00:01:53,040 --> 00:02:00,390
it out on me yeah cuz I'm shorter than

35
00:01:55,380 --> 00:02:03,929
everybody so people are asking why

36
00:02:00,390 --> 00:02:06,360
cross-site scripting I was looking

37
00:02:03,930 --> 00:02:08,619
through wordpress plugins at mostly like

38
00:02:06,360 --> 00:02:11,860
local file inclusion

39
00:02:08,619 --> 00:02:13,690
fujian SQL injection I like getting a

40
00:02:11,860 --> 00:02:16,420
shell on things i like getting a

41
00:02:13,690 --> 00:02:18,280
database home I don't like cross-site

42
00:02:16,420 --> 00:02:20,018
scripting how much but I kept seeing

43
00:02:18,280 --> 00:02:22,659
these things in the code they kept

44
00:02:20,019 --> 00:02:24,670
seeing these blatant you know echoing

45
00:02:22,659 --> 00:02:27,940
user input write me back to the browser

46
00:02:24,670 --> 00:02:29,890
so idea what I'm going to see how many

47
00:02:27,940 --> 00:02:31,209
bees I can find I just figure out great

48
00:02:29,890 --> 00:02:33,578
an index of them's just see how many

49
00:02:31,209 --> 00:02:36,310
there are and I thought these were a

50
00:02:33,579 --> 00:02:38,829
sure thing I thought that you know if

51
00:02:36,310 --> 00:02:43,209
you were seeing again the angle back was

52
00:02:38,829 --> 00:02:46,329
cross-eyed terrific over that later mess

53
00:02:43,209 --> 00:02:48,459
up slide I had a lot of curiosity about

54
00:02:46,329 --> 00:02:50,890
vulnerability discovery automated I

55
00:02:48,459 --> 00:02:53,170
wanted to automate vulnerability

56
00:02:50,890 --> 00:02:55,059
discovery and vulnerability proof of

57
00:02:53,170 --> 00:02:57,670
concept generation and vulnerability

58
00:02:55,060 --> 00:02:59,560
proof of concept verification so it

59
00:02:57,670 --> 00:03:01,569
wasn't really so much about cross-site

60
00:02:59,560 --> 00:03:03,220
scripting was more about can I get my

61
00:03:01,569 --> 00:03:06,790
computer to do this for me and then

62
00:03:03,220 --> 00:03:08,440
check the logs every couple hours and

63
00:03:06,790 --> 00:03:11,108
also I figured these would be pretty

64
00:03:08,440 --> 00:03:13,750
easy to create call center pane coupons

65
00:03:11,109 --> 00:03:16,599
up on the body should just be a break a

66
00:03:13,750 --> 00:03:19,120
script tag I go up alert drama walks in

67
00:03:16,599 --> 00:03:23,530
and close the script a guy should I work

68
00:03:19,120 --> 00:03:25,750
most cases assumptions and all you I

69
00:03:23,530 --> 00:03:27,549
seen you know WordPress is as you know

70
00:03:25,750 --> 00:03:30,010
across as creepy nezumi know what a

71
00:03:27,549 --> 00:03:31,599
wordpress plugins and I've seen you're

72
00:03:30,010 --> 00:03:34,239
not coming to violence I'm disappointed

73
00:03:31,599 --> 00:03:40,480
because I'm small I get eaten hopping

74
00:03:34,239 --> 00:03:42,940
you guys see the rest of this let's see

75
00:03:40,480 --> 00:03:46,179
s'alright first step was to collect

76
00:03:42,940 --> 00:03:49,930
plugins I wanted to collect all the

77
00:03:46,180 --> 00:03:51,639
buttons at once I wanted all 50,000

78
00:03:49,930 --> 00:03:54,099
plugins I didn't want to grab thousand

79
00:03:51,639 --> 00:03:57,760
to two thousand I wanted to grab all so

80
00:03:54,099 --> 00:04:01,089
i decided to shrink wordpress plugin Sen

81
00:03:57,760 --> 00:04:07,720
source of oz buried age then I piss off

82
00:04:01,090 --> 00:04:10,870
a lot Mikey rosary months also I got a

83
00:04:07,720 --> 00:04:13,239
lot of crops I got plugin versions or

84
00:04:10,870 --> 00:04:16,899
you know the same plugin with eight

85
00:04:13,239 --> 00:04:21,489
conversions I got plugins that had been

86
00:04:16,899 --> 00:04:23,169
removed four years ago I I got just a

87
00:04:21,488 --> 00:04:26,799
bunch of stuff but I didn't need and we

88
00:04:23,169 --> 00:04:28,330
just take them back to this so i had to

89
00:04:26,800 --> 00:04:30,130
talk with another another way to do this

90
00:04:28,330 --> 00:04:33,580
i also want to met idiot i want to

91
00:04:30,130 --> 00:04:36,490
collect hits off plugin so a plugin much

92
00:04:33,580 --> 00:04:40,659
and dwell was i used list of plugins

93
00:04:36,490 --> 00:04:44,320
from the code repository as minutes and

94
00:04:40,659 --> 00:04:46,620
I strength each plate or each page on

95
00:04:44,320 --> 00:04:48,969
the work our site for that plugin I

96
00:04:46,620 --> 00:04:51,880
high-five over the proxy change because

97
00:04:48,969 --> 00:04:54,729
I didn't want I didn't want wordpress to

98
00:04:51,880 --> 00:04:57,870
block me game and you have to read route

99
00:04:54,729 --> 00:05:00,340
it through another proxy somewhere and

100
00:04:57,870 --> 00:05:03,610
so I got this little running and I let

101
00:05:00,340 --> 00:05:08,049
it run and it took all five ease in all

102
00:05:03,610 --> 00:05:11,349
it downloaded 40 2478 plugins look at

103
00:05:08,050 --> 00:05:16,570
how it was 10 gigabytes of disk like

104
00:05:11,349 --> 00:05:18,750
that baby was 15 the next step was how

105
00:05:16,570 --> 00:05:21,909
was I going to buy all these plugins for

106
00:05:18,750 --> 00:05:24,460
cross-site scripting long Billy's so a

107
00:05:21,909 --> 00:05:28,479
couple of years ago I had done this same

108
00:05:24,460 --> 00:05:30,310
sort of research with Ruby gems so I

109
00:05:28,479 --> 00:05:32,050
took one of my old Perl scripts that I

110
00:05:30,310 --> 00:05:34,180
used to look at command injection

111
00:05:32,050 --> 00:05:36,940
rubygems modified it to look for

112
00:05:34,180 --> 00:05:41,020
cross-site scripting in WordPress

113
00:05:36,940 --> 00:05:43,719
plugins and just you know set up a loop

114
00:05:41,020 --> 00:05:45,219
for echo get no posts at a request and i

115
00:05:43,719 --> 00:05:47,590
think i define different variations

116
00:05:45,219 --> 00:05:50,050
where the plugin author would either put

117
00:05:47,590 --> 00:05:52,239
a single forward or double quotes space

118
00:05:50,050 --> 00:05:55,330
before single course paid for double

119
00:05:52,240 --> 00:05:57,400
quote i also wanted to grab my number

120
00:05:55,330 --> 00:05:59,529
and a similar vulnerable code because

121
00:05:57,400 --> 00:06:01,479
whenever I you an advisory I like

122
00:05:59,529 --> 00:06:03,039
providing sitting up with a code that

123
00:06:01,479 --> 00:06:05,919
the one abilities in in case the author

124
00:06:03,039 --> 00:06:07,570
change it or a steel authors finally

125
00:06:05,919 --> 00:06:09,729
fixes it I can at least go back to what

126
00:06:07,570 --> 00:06:12,039
I originally saw did fit it to do and

127
00:06:09,729 --> 00:06:15,900
say okay this is you know some of it all

128
00:06:12,039 --> 00:06:18,610
the change maybe they did it wrong maybe

129
00:06:15,900 --> 00:06:20,888
something in there I didn't know I also

130
00:06:18,610 --> 00:06:23,200
wanted to automatically generate the

131
00:06:20,889 --> 00:06:25,930
exploit title so i wanted to generate

132
00:06:23,200 --> 00:06:27,639
whoever comes up exploit based on the

133
00:06:25,930 --> 00:06:29,770
code snippet where i extracted the

134
00:06:27,639 --> 00:06:31,449
variables from it and also want me to

135
00:06:29,770 --> 00:06:33,008
just put a generic title in airoli

136
00:06:31,449 --> 00:06:37,840
process with people on mobility and

137
00:06:33,009 --> 00:06:39,250
plug-in foo bar baz version 1.03 and

138
00:06:37,840 --> 00:06:42,219
then as i mentioned i collected the

139
00:06:39,250 --> 00:06:43,870
global variables that made it easier to

140
00:06:42,220 --> 00:06:47,229
just automatically every contact

141
00:06:43,870 --> 00:06:51,310
demanded use that variable to be the

142
00:06:47,229 --> 00:06:57,508
payload injector for my javascript for

143
00:06:51,310 --> 00:07:00,669
our boss generate the processor thing

144
00:06:57,509 --> 00:07:02,470
cooper concepts I only looked at that in

145
00:07:00,669 --> 00:07:05,139
request only I didn't want to try a new

146
00:07:02,470 --> 00:07:06,930
post because that's just a little harder

147
00:07:05,139 --> 00:07:09,039
this was you know I'm gonna see this

148
00:07:06,930 --> 00:07:13,419
community I startled the easy stuff a

149
00:07:09,039 --> 00:07:16,990
little any group I wanted to just create

150
00:07:13,419 --> 00:07:20,590
a generic most like most likely to

151
00:07:16,990 --> 00:07:23,800
succeed excellent protesting so I figure

152
00:07:20,590 --> 00:07:26,530
of just you know at a script tag ending

153
00:07:23,800 --> 00:07:30,220
script tag beginning just trying break

154
00:07:26,530 --> 00:07:34,138
the HTML after attending HTML tag and

155
00:07:30,220 --> 00:07:37,210
then just generally holes on the fly

156
00:07:34,139 --> 00:07:39,550
kind of needed some restore all this I

157
00:07:37,210 --> 00:07:42,638
figured I had 900 more abilities with

158
00:07:39,550 --> 00:07:46,979
900 technical concepts what should i do

159
00:07:42,639 --> 00:07:50,560
I build the database mysql database

160
00:07:46,979 --> 00:07:54,430
rated database ability only me because

161
00:07:50,560 --> 00:07:55,620
I'm so you know originally created I

162
00:07:54,430 --> 00:07:58,270
couldn't think of any better name

163
00:07:55,620 --> 00:08:00,879
superleague cross-sector and irritating

164
00:07:58,270 --> 00:08:06,128
done in stages and then I had to think

165
00:08:00,879 --> 00:08:10,539
about what columns the store I guys for

166
00:08:06,129 --> 00:08:13,460
the title filing plugin aim vulnerable

167
00:08:10,539 --> 00:08:14,900
code proof of concept because you know

168
00:08:13,460 --> 00:08:17,090
to have that associated with the

169
00:08:14,900 --> 00:08:19,130
database the variables that were

170
00:08:17,090 --> 00:08:21,979
vulnerable to cross-site scripting

171
00:08:19,130 --> 00:08:24,289
injection and then a date just so I knew

172
00:08:21,979 --> 00:08:26,539
when the table is great or that internet

173
00:08:24,289 --> 00:08:29,060
table is created I wanted to collect

174
00:08:26,539 --> 00:08:30,919
some data data along with it popularly

175
00:08:29,060 --> 00:08:34,039
more fields in the database like version

176
00:08:30,919 --> 00:08:36,049
number alter download links down below I

177
00:08:34,039 --> 00:08:38,779
had the number of downloads I could sort

178
00:08:36,049 --> 00:08:41,809
the table by plugging in popularity so I

179
00:08:38,779 --> 00:08:45,080
could look at the top plugins for number

180
00:08:41,809 --> 00:08:46,939
of downloads and start to peter out

181
00:08:45,080 --> 00:08:48,589
which ones might be more interesting

182
00:08:46,940 --> 00:08:50,959
others that have more downloads at Mike

183
00:08:48,589 --> 00:08:54,800
more prolific across the internet cases

184
00:08:50,959 --> 00:08:56,239
got really serious and then you know in

185
00:08:54,800 --> 00:08:57,740
the midst of doing all this I thought to

186
00:08:56,240 --> 00:09:03,130
myself you know I should probably give

187
00:08:57,740 --> 00:09:05,089
people like wordpress sort of a

188
00:09:03,130 --> 00:09:07,790
notification that I'm doing this because

189
00:09:05,089 --> 00:09:10,220
you know if I suddenly get this out of a

190
00:09:07,790 --> 00:09:12,079
spilt and then I give them 24 hours to

191
00:09:10,220 --> 00:09:13,940
react to it that'd be kind of a jerk

192
00:09:12,080 --> 00:09:17,839
move you figure out your tongue look I'm

193
00:09:13,940 --> 00:09:19,610
building this database I'm starting to

194
00:09:17,839 --> 00:09:22,190
put it together you guys have any

195
00:09:19,610 --> 00:09:23,720
suggestions recommendations I figured I

196
00:09:22,190 --> 00:09:26,180
would just let you know if there's any

197
00:09:23,720 --> 00:09:27,500
way you can help just let me know and

198
00:09:26,180 --> 00:09:31,849
I'll be wherever it is to help you guys

199
00:09:27,500 --> 00:09:34,279
get this off result so I separate

200
00:09:31,850 --> 00:09:38,510
realize I was over over my head she

201
00:09:34,279 --> 00:09:40,279
doesn't take much to me so i realized i

202
00:09:38,510 --> 00:09:43,160
need an adult i probably should ask

203
00:09:40,279 --> 00:09:45,620
people who are smart what i should do

204
00:09:43,160 --> 00:09:49,760
but you know how i should organize this

205
00:09:45,620 --> 00:09:52,730
data who I should notify sort of bounces

206
00:09:49,760 --> 00:09:54,589
my ideas off of other folks so I first

207
00:09:52,730 --> 00:09:57,740
person her first group I notified was

208
00:09:54,589 --> 00:09:59,899
WordPress they were flabbergasted at

209
00:09:57,740 --> 00:10:01,279
first they were like in shock they're

210
00:09:59,899 --> 00:10:04,459
like we can't believe you have a

211
00:10:01,279 --> 00:10:06,170
database of 1352 across that I could if

212
00:10:04,459 --> 00:10:07,760
he wanted to leave what the hell are we

213
00:10:06,170 --> 00:10:10,069
going to do we only can address one of

214
00:10:07,760 --> 00:10:13,339
these why the time it exists days to

215
00:10:10,070 --> 00:10:15,829
verify if you have to they create a

216
00:10:13,339 --> 00:10:17,810
proof of concept verify it and notify

217
00:10:15,829 --> 00:10:19,279
the author if you also doesn't pull on

218
00:10:17,810 --> 00:10:20,750
the plug and they pull down the plugin

219
00:10:19,279 --> 00:10:21,230
or if they alter doesn't fix the plug

220
00:10:20,750 --> 00:10:24,410
and they

221
00:10:21,230 --> 00:10:27,200
so they had this very slow manual cycle

222
00:10:24,410 --> 00:10:28,699
of heading this time so I gone back and

223
00:10:27,200 --> 00:10:31,130
forth with him for a little while about

224
00:10:28,700 --> 00:10:32,270
you know my expectations and I just

225
00:10:31,130 --> 00:10:36,020
willing to help in any way they could

226
00:10:32,270 --> 00:10:38,030
and they were kinda quiet and just sort

227
00:10:36,020 --> 00:10:40,490
of like assume they were just chugging

228
00:10:38,030 --> 00:10:43,040
through the database and then I notify

229
00:10:40,490 --> 00:10:44,990
Brian Martin derecho de fishing because

230
00:10:43,040 --> 00:10:48,079
he's just been collecting

231
00:10:44,990 --> 00:10:51,320
vulnerabilities since I can remember he

232
00:10:48,080 --> 00:10:53,690
was he was running the OSCE he would

233
00:10:51,320 --> 00:10:57,380
know I handle this sort of all thing he

234
00:10:53,690 --> 00:10:58,760
I think actually a bird for a kitten

235
00:10:57,380 --> 00:11:00,980
when he heard about this because he's

236
00:10:58,760 --> 00:11:03,890
like I've been wanting to write a story

237
00:11:00,980 --> 00:11:06,500
about someone who's to you know giving a

238
00:11:03,890 --> 00:11:08,030
thousand or 4,000 vulnerabilities at

239
00:11:06,500 --> 00:11:10,010
once it would be a great blog entry

240
00:11:08,030 --> 00:11:11,660
please homie how does have easy i have

241
00:11:10,010 --> 00:11:13,130
this database and here it is you can

242
00:11:11,660 --> 00:11:15,920
have it just don't share with anybody

243
00:11:13,130 --> 00:11:17,960
else and then I notified sophomore I DMX

244
00:11:15,920 --> 00:11:19,819
source because he's been on old friend

245
00:11:17,960 --> 00:11:21,980
and I figured he would probably

246
00:11:19,820 --> 00:11:24,950
shouldn't know about it notify Brian new

247
00:11:21,980 --> 00:11:27,200
hurts because he runs the wordpress on

248
00:11:24,950 --> 00:11:28,610
ability database so I'm going to give

249
00:11:27,200 --> 00:11:30,620
him thirteen hundred entries he should

250
00:11:28,610 --> 00:11:33,410
know about it and then I conscious on

251
00:11:30,620 --> 00:11:36,140
the friends at Akamai and I cold Patrick

252
00:11:33,410 --> 00:11:37,969
and a little people when I grew couple

253
00:11:36,140 --> 00:11:39,830
of people equals ecru because they're

254
00:11:37,970 --> 00:11:42,590
really smart I figured you know they

255
00:11:39,830 --> 00:11:44,150
should know they might guide me or tell

256
00:11:42,590 --> 00:11:46,790
me if I'm being idiot and they were all

257
00:11:44,150 --> 00:11:48,920
like that's really cool in your second

258
00:11:46,790 --> 00:11:50,240
head is the house and that was I'm

259
00:11:48,920 --> 00:11:53,240
trying to find this up they thought it

260
00:11:50,240 --> 00:11:54,680
was great and then sold the designer

261
00:11:53,240 --> 00:11:56,450
because I did eventually i will send

262
00:11:54,680 --> 00:12:00,530
this stuff to the day or security list

263
00:11:56,450 --> 00:12:04,040
hehe i can't send 1352 wanna Billy's at

264
00:12:00,530 --> 00:12:05,990
once people are going to murder me are

265
00:12:04,040 --> 00:12:08,329
you that you can send an email to those

266
00:12:05,990 --> 00:12:09,860
shirtless so the 9-ball go what could I

267
00:12:08,330 --> 00:12:12,440
sent him in blocks of like laundry

268
00:12:09,860 --> 00:12:15,020
because then it blocks 500 but I talked

269
00:12:12,440 --> 00:12:16,670
to solar designer for a couple of days

270
00:12:15,020 --> 00:12:18,020
going back and forth about you know what

271
00:12:16,670 --> 00:12:19,010
fields we should send and how much you

272
00:12:18,020 --> 00:12:20,960
4matic

273
00:12:19,010 --> 00:12:24,069
email but it should be easily possible

274
00:12:20,960 --> 00:12:27,500
so we wanted through this magnet for and

275
00:12:24,070 --> 00:12:30,860
so I started mode finally hold up all

276
00:12:27,500 --> 00:12:34,100
these people I had a friend of mine who

277
00:12:30,860 --> 00:12:37,210
shall remain nameless sense the database

278
00:12:34,100 --> 00:12:39,350
on requested me to some ELP read

279
00:12:37,210 --> 00:12:41,510
security list which you don't know what

280
00:12:39,350 --> 00:12:45,110
the traffic light or call this LP red is

281
00:12:41,510 --> 00:12:48,200
even though only it's you know the only

282
00:12:45,110 --> 00:12:49,670
people receiving information are swarms

283
00:12:48,200 --> 00:12:51,200
and not share with anybody else it's

284
00:12:49,670 --> 00:12:55,760
muscle to be shared out of who's ever

285
00:12:51,200 --> 00:12:58,280
received it so a group of people had got

286
00:12:55,760 --> 00:12:59,960
hold it in Germany and he's these were a

287
00:12:58,280 --> 00:13:02,540
group of security researchers old

288
00:12:59,960 --> 00:13:06,470
doctors in computer science and they

289
00:13:02,540 --> 00:13:08,030
were looking for a they were doing a

290
00:13:06,470 --> 00:13:09,230
study on wordpress plugin

291
00:13:08,030 --> 00:13:11,870
vulnerabilities with cross-site

292
00:13:09,230 --> 00:13:15,350
scripting on 0 days so these eyes flip

293
00:13:11,870 --> 00:13:18,290
out there like holy cow you're this is

294
00:13:15,350 --> 00:13:21,470
dizzle Dotel right into our research

295
00:13:18,290 --> 00:13:22,699
this is break that cycle I was like I'm

296
00:13:21,470 --> 00:13:24,680
going to be one of the cool kids now

297
00:13:22,700 --> 00:13:27,200
these guys are actually my sighting 8

298
00:13:24,680 --> 00:13:29,239
and there they got a degree in computer

299
00:13:27,200 --> 00:13:31,820
science at popular poppers it was like

300
00:13:29,240 --> 00:13:33,200
like equivalent of the Big Bang Theory

301
00:13:31,820 --> 00:13:37,450
except they were in Germany and they

302
00:13:33,200 --> 00:13:37,450
were drinking here they weren't awkward

303
00:13:38,140 --> 00:13:42,199
so I thought I was becoming one of the

304
00:13:40,370 --> 00:13:48,040
cool kids you know I guess it's pretty

305
00:13:42,200 --> 00:13:50,300
cool homeland maybe I'll be accepted so

306
00:13:48,040 --> 00:13:55,640
ok a lot of short jokes because if I

307
00:13:50,300 --> 00:13:57,890
don't do my CSO ghelani open so I think

308
00:13:55,640 --> 00:13:59,150
I i customized the data for everybody

309
00:13:57,890 --> 00:14:01,550
everybody was like can you add this

310
00:13:59,150 --> 00:14:04,550
table can you add that table people want

311
00:14:01,550 --> 00:14:07,579
customs his fees the WordPress people

312
00:14:04,550 --> 00:14:09,439
Jericho brawny Martin he and I went back

313
00:14:07,580 --> 00:14:10,769
and forth and we were fixing something

314
00:14:09,440 --> 00:14:13,860
the tables we were

315
00:14:10,769 --> 00:14:16,170
angle entries sort of suggestions I sent

316
00:14:13,860 --> 00:14:17,999
people SQL database and the PHP code

317
00:14:16,170 --> 00:14:19,800
surrender into a pretty web page that

318
00:14:17,999 --> 00:14:25,860
showed you the Christ ray that I created

319
00:14:19,800 --> 00:14:28,498
and everything I had more columns people

320
00:14:25,860 --> 00:14:30,269
like hey why don't you add these columns

321
00:14:28,499 --> 00:14:32,999
you know you need to you should its CBE

322
00:14:30,269 --> 00:14:36,449
IDs for these and at the time I just

323
00:14:32,999 --> 00:14:41,929
became involved with the sugar weakness

324
00:14:36,449 --> 00:14:45,118
filing or sort of taking part of the TDE

325
00:14:41,929 --> 00:14:47,549
CDE database I were sort of doing our

326
00:14:45,119 --> 00:14:49,410
own thing for supporting the stuff that

327
00:14:47,549 --> 00:14:52,439
they all supports that everything has CD

328
00:14:49,410 --> 00:14:55,259
ie so they had given me a block of

329
00:14:52,439 --> 00:14:58,349
thousand IES which I could never do so

330
00:14:55,259 --> 00:15:00,779
the year and i'm going to use like 900

331
00:14:58,350 --> 00:15:04,319
right now so i just assigned all the ec

332
00:15:00,779 --> 00:15:06,959
v WF ID so all these vulnerabilities on

333
00:15:04,319 --> 00:15:09,089
a database i added a type field so that

334
00:15:06,959 --> 00:15:11,128
i could tell if the injection was he

335
00:15:09,089 --> 00:15:15,059
again hosted a request so i could sort

336
00:15:11,129 --> 00:15:16,769
by no I can sort by if I wanted to look

337
00:15:15,059 --> 00:15:20,459
at and requests or post request one

338
00:15:16,769 --> 00:15:21,929
abilities or hope or requests I did you

339
00:15:20,459 --> 00:15:24,839
know pulls out of the database is really

340
00:15:21,929 --> 00:15:27,029
easy the guys in Germany wanted to check

341
00:15:24,839 --> 00:15:28,860
and see if third plug for using on C so

342
00:15:27,029 --> 00:15:31,170
I edit that in there if it was a plague

343
00:15:28,860 --> 00:15:34,920
I hope a one if it was plugging to do

344
00:15:31,170 --> 00:15:36,240
not see I added um auto verify which

345
00:15:34,920 --> 00:15:38,939
we'll get into it was just a bully

346
00:15:36,240 --> 00:15:40,649
statement that will be part of the

347
00:15:38,939 --> 00:15:43,980
automatic exploit stuff they'll get us

348
00:15:40,649 --> 00:15:45,929
on the next couple of slides um people

349
00:15:43,980 --> 00:15:48,360
wanted the filename about before half I

350
00:15:45,929 --> 00:15:49,799
used I needed the filing with the full

351
00:15:48,360 --> 00:15:52,769
path but they wanted without so I had

352
00:15:49,799 --> 00:15:54,959
partial those out free entry just make

353
00:15:52,769 --> 00:15:57,899
things easier for those guys and I

354
00:15:54,959 --> 00:16:00,329
wanted a vendor contacting um so that

355
00:15:57,899 --> 00:16:02,910
when I eventually found a way to notify

356
00:16:00,329 --> 00:16:04,049
these guys are the plugin office we

357
00:16:02,910 --> 00:16:08,459
could at least keep track of who was

358
00:16:04,049 --> 00:16:11,699
notified it wasn't and then I want to I

359
00:16:08,459 --> 00:16:13,410
wanted to you know I want about the

360
00:16:11,699 --> 00:16:15,479
valley a group of concepts i figured

361
00:16:13,410 --> 00:16:19,850
proof of concept or go home I want to

362
00:16:15,480 --> 00:16:22,150
know that all 1352 if possible of these

363
00:16:19,850 --> 00:16:26,950
vulnerabilities were valid at the

364
00:16:22,150 --> 00:16:29,740
shuel javascript executed I had an idea

365
00:16:26,950 --> 00:16:33,130
about how it would test this I was I was

366
00:16:29,740 --> 00:16:35,560
on a flight from back from RV trip in

367
00:16:33,130 --> 00:16:39,790
California and thought of a way to

368
00:16:35,560 --> 00:16:42,310
tested and I thought it would be really

369
00:16:39,790 --> 00:16:44,290
cool to release a database that was you

370
00:16:42,310 --> 00:16:46,420
know over a thousand vulnerabilities

371
00:16:44,290 --> 00:16:48,400
with over a thousand Hoover concept

372
00:16:46,420 --> 00:16:50,949
exploits with it I were verified I'll

373
00:16:48,400 --> 00:16:55,780
prove that either thousand homes and

374
00:16:50,950 --> 00:16:57,220
here the thousand exploits warm yeah so

375
00:16:55,780 --> 00:17:00,699
the first version of the automatic

376
00:16:57,220 --> 00:17:05,770
exploiter was I was going to try and

377
00:17:00,700 --> 00:17:08,230
send the payload to all of our or these

378
00:17:05,770 --> 00:17:12,190
all the data requests as also be the

379
00:17:08,230 --> 00:17:15,730
easiest exploit there were 900 of those

380
00:17:12,190 --> 00:17:17,320
the rest were post request so I didn't

381
00:17:15,730 --> 00:17:19,450
figured I wouldn't bother with those yet

382
00:17:17,319 --> 00:17:24,458
well now I guess I should go back and

383
00:17:19,450 --> 00:17:27,010
check those just for fun um I inside the

384
00:17:24,459 --> 00:17:30,220
set up such a cgi bin mark i figured i

385
00:17:27,010 --> 00:17:32,770
could use PHP cgi to just execute the

386
00:17:30,220 --> 00:17:37,390
PHP code and generate an HTML file with

387
00:17:32,770 --> 00:17:39,900
the table embedded in it and then i

388
00:17:37,390 --> 00:17:42,130
could exact that javascript you know the

389
00:17:39,900 --> 00:17:45,970
whole payload and see if it actually

390
00:17:42,130 --> 00:17:48,280
execute i needed i could use an alert

391
00:17:45,970 --> 00:17:50,230
that's i'm not going to look at on drew

392
00:17:48,280 --> 00:17:53,110
older boxes that have been rendered to

393
00:17:50,230 --> 00:17:56,770
PNG so I figured easiest way would be to

394
00:17:53,110 --> 00:17:58,689
had it view a pulley image have that

395
00:17:56,770 --> 00:18:01,800
image to be a PHP spirit that just

396
00:17:58,690 --> 00:18:04,060
specifies as a argument the

397
00:18:01,800 --> 00:18:10,930
vulnerability database number to the

398
00:18:04,060 --> 00:18:14,379
mark as auto verified so that PHP all it

399
00:18:10,930 --> 00:18:14,770
does is set one to verify the dollar

400
00:18:14,380 --> 00:18:17,800
sign

401
00:18:14,770 --> 00:18:21,970
navigates source for each user can

402
00:18:17,800 --> 00:18:24,790
imagine and to set up the environment

403
00:18:21,970 --> 00:18:27,130
variables for PHP CGI you just need us

404
00:18:24,790 --> 00:18:30,700
out the gateway interface equal to CGI

405
00:18:27,130 --> 00:18:33,160
one that one you need half translated

406
00:18:30,700 --> 00:18:36,430
equals horrible PHP file name where is

407
00:18:33,160 --> 00:18:41,020
showing equals payload rewrite SATA cgi

408
00:18:36,430 --> 00:18:43,360
method is capable of appendages I first

409
00:18:41,020 --> 00:18:46,120
started doing this when I was testing LF

410
00:18:43,360 --> 00:18:49,149
I and archive I didn't want to just

411
00:18:46,120 --> 00:18:52,209
anyone have to stick a PHP file on a web

412
00:18:49,150 --> 00:18:54,940
server and then fire it off I got tired

413
00:18:52,210 --> 00:18:58,270
of trying to play with curl and stuff

414
00:18:54,940 --> 00:19:01,810
like I had created a just a script that

415
00:18:58,270 --> 00:19:03,580
would run vulnerable or run my exploit

416
00:19:01,810 --> 00:19:05,860
code you will post requests where I have

417
00:19:03,580 --> 00:19:07,810
requests against a plug-in that had an l

418
00:19:05,860 --> 00:19:09,070
a-- fire an RFI vulnerability and i

419
00:19:07,810 --> 00:19:10,870
thought this might work pretty well for

420
00:19:09,070 --> 00:19:14,679
just passing the cross I soothing song

421
00:19:10,870 --> 00:19:16,989
so I made this little script called fast

422
00:19:14,680 --> 00:19:21,030
ejects warrior really easy i don't you

423
00:19:16,990 --> 00:19:23,650
guys can see it you know just being in

424
00:19:21,030 --> 00:19:26,040
so all it does is just popularly all of

425
00:19:23,650 --> 00:19:27,940
those all those environment variables

426
00:19:26,040 --> 00:19:31,230
specifically the ones of interests are

427
00:19:27,940 --> 00:19:33,960
you know where E string sent Aine our

428
00:19:31,230 --> 00:19:37,660
payload for cross-site scripting

429
00:19:33,960 --> 00:19:39,520
JavaScript and then you know regular

430
00:19:37,660 --> 00:19:43,030
valuables are just building with the

431
00:19:39,520 --> 00:19:47,260
fall CGI rear exercise dijo mi forget

432
00:19:43,030 --> 00:19:52,110
that translate is the actual filing to

433
00:19:47,260 --> 00:19:52,110
the AP file that we're going to target

434
00:19:53,190 --> 00:20:02,110
so the process to render to die HTML I

435
00:19:58,240 --> 00:20:04,270
needed to run all of these vulnerable

436
00:20:02,110 --> 00:20:08,560
PHP files that I distracted from the

437
00:20:04,270 --> 00:20:12,280
database with you know through this trip

438
00:20:08,560 --> 00:20:16,210
that I agree it with a payload of script

439
00:20:12,280 --> 00:20:20,070
new emission source equals my URL to go

440
00:20:16,210 --> 00:20:24,410
and set the database auto verified one

441
00:20:20,070 --> 00:20:27,780
add an idea process the

442
00:20:24,410 --> 00:20:32,580
HTML and JavaScript saw by using phantom

443
00:20:27,780 --> 00:20:35,160
JSON JavaScript Antonov sure if you

444
00:20:32,580 --> 00:20:38,760
hadn't heard it it's a full-fledged sack

445
00:20:35,160 --> 00:20:41,700
is no its command line even citizens a

446
00:20:38,760 --> 00:20:44,010
web browser on the command line it'll it

447
00:20:41,700 --> 00:20:47,340
will process JavaScript will execute our

448
00:20:44,010 --> 00:20:49,440
payload there's lots it has a lot of

449
00:20:47,340 --> 00:20:51,059
functionality I just wanted to use it

450
00:20:49,440 --> 00:20:53,970
for this one thing I really wanted to

451
00:20:51,059 --> 00:20:56,879
just to read all the HTML files out of

452
00:20:53,970 --> 00:21:00,390
my directory that I rendered from that

453
00:20:56,880 --> 00:21:03,210
for loop with that CGI district and then

454
00:21:00,390 --> 00:21:06,420
just create dot PNG files that you look

455
00:21:03,210 --> 00:21:11,550
at and the doc PNG files like at least

456
00:21:06,420 --> 00:21:13,890
he'll um depending on size if the

457
00:21:11,550 --> 00:21:16,678
JavaScript and fire or not or if I got

458
00:21:13,890 --> 00:21:18,840
an error just based on file size I knew

459
00:21:16,679 --> 00:21:21,090
if I knew the file size was bigger I

460
00:21:18,840 --> 00:21:23,159
knew something that happened and it at

461
00:21:21,090 --> 00:21:28,050
least executed or I got an error message

462
00:21:23,160 --> 00:21:30,690
or something like that so identifying

463
00:21:28,050 --> 00:21:33,330
this the sander but somebody had written

464
00:21:30,690 --> 00:21:36,059
in JavaScript that would go through and

465
00:21:33,330 --> 00:21:38,699
do exactly what he wanted it would you

466
00:21:36,059 --> 00:21:40,080
specify a directory of all of your HTML

467
00:21:38,700 --> 00:21:42,390
files in it would read through that

468
00:21:40,080 --> 00:21:45,300
directory and render the JavaScript and

469
00:21:42,390 --> 00:21:47,850
he fondles HTML files and create an

470
00:21:45,300 --> 00:21:53,790
image file of what what a browser would

471
00:21:47,850 --> 00:21:56,840
have seen as a source of energy I'd ran

472
00:21:53,790 --> 00:21:59,730
this thing I was watching more log

473
00:21:56,840 --> 00:22:02,550
access log and I was dancing I was

474
00:21:59,730 --> 00:22:06,360
watching stuff come true I will see boom

475
00:22:02,550 --> 00:22:09,000
you know this this script fire off or

476
00:22:06,360 --> 00:22:10,979
this is jobs required off at javascript

477
00:22:09,000 --> 00:22:12,660
Pardo I could see these things coming in

478
00:22:10,980 --> 00:22:14,940
and setting themselves auto verified

479
00:22:12,660 --> 00:22:18,090
light in my database and I was just like

480
00:22:14,940 --> 00:22:21,179
this is the coolest fake dancing around

481
00:22:18,090 --> 00:22:25,230
like this is so awesome and what are

482
00:22:21,179 --> 00:22:26,650
they I can't dance like that in its that

483
00:22:25,230 --> 00:22:29,440
was filmed in like what

484
00:22:26,650 --> 00:22:31,750
nineteen ninety seven or six I mean it

485
00:22:29,440 --> 00:22:33,970
dance like that then oh I don't have I

486
00:22:31,750 --> 00:22:36,340
have no rhythm ask my wife oh really she

487
00:22:33,970 --> 00:22:40,270
smells and dancing anymore their dance

488
00:22:36,340 --> 00:22:42,909
with them off yes oh so here's what it

489
00:22:40,270 --> 00:22:45,639
looked like this is what the this is

490
00:22:42,910 --> 00:22:47,710
what the actual output of that directory

491
00:22:45,640 --> 00:22:49,900
look like when it was done it taking

492
00:22:47,710 --> 00:22:53,320
these these HTML files that were

493
00:22:49,900 --> 00:22:54,880
generated by the PHP 5 CGI environment

494
00:22:53,320 --> 00:22:58,120
that I had created with a little script

495
00:22:54,880 --> 00:23:02,790
and then render them down to about HTML

496
00:22:58,120 --> 00:23:05,199
PNG's seem that it executed the

497
00:23:02,790 --> 00:23:09,280
JavaScript or not you're just looking at

498
00:23:05,200 --> 00:23:10,810
the dailies so it was easy I can to this

499
00:23:09,280 --> 00:23:12,430
day I still go through look at the Java

500
00:23:10,810 --> 00:23:15,179
or the file size because i have go to

501
00:23:12,430 --> 00:23:19,480
the mall see exactly what happened i did

502
00:23:15,180 --> 00:23:22,360
it was an easy way just to see what had

503
00:23:19,480 --> 00:23:24,670
gone off would had broken what didn't

504
00:23:22,360 --> 00:23:26,409
work what might be more interesting more

505
00:23:24,670 --> 00:23:28,450
ability later on i think some of these i

506
00:23:26,410 --> 00:23:31,000
looked at might have SQL injection but i

507
00:23:28,450 --> 00:23:35,410
didn't investigate fully so there was

508
00:23:31,000 --> 00:23:37,990
some interesting results and results

509
00:23:35,410 --> 00:23:39,730
were there was 38 exploits that had

510
00:23:37,990 --> 00:23:43,510
fired off and set to auto verify the

511
00:23:39,730 --> 00:23:45,100
database I thought it was going to be

512
00:23:43,510 --> 00:23:46,240
the way I was looking at the laws I

513
00:23:45,100 --> 00:23:48,719
thought there was going to be at least

514
00:23:46,240 --> 00:23:53,020
another occasion in there no somewhere

515
00:23:48,720 --> 00:23:56,160
138 380 or you know something bigger

516
00:23:53,020 --> 00:23:58,780
than 38 e so I was pretty disappointed

517
00:23:56,160 --> 00:24:02,260
it's kind of kind of like you know I

518
00:23:58,780 --> 00:24:06,090
think this kind of failed it was only

519
00:24:02,260 --> 00:24:08,050
four percent of those 900 actually work

520
00:24:06,090 --> 00:24:11,560
and then I started thinking about it

521
00:24:08,050 --> 00:24:13,629
they'd work damn it actually rendered 38

522
00:24:11,560 --> 00:24:16,870
of these things fire off I didn't look

523
00:24:13,630 --> 00:24:18,760
at the proof of concept that i created

524
00:24:16,870 --> 00:24:21,729
for they were automatically generated

525
00:24:18,760 --> 00:24:23,740
and then just stuffed into a variable

526
00:24:21,730 --> 00:24:26,340
that I tease out from the code and then

527
00:24:23,740 --> 00:24:28,750
had the phantom j/s test to see if that

528
00:24:26,340 --> 00:24:33,820
javascript was fired back and executed

529
00:24:28,750 --> 00:24:36,150
sawing the process work and I thought

530
00:24:33,820 --> 00:24:39,419
well this is my mic

531
00:24:36,150 --> 00:24:43,050
so I thought to myself if the if the

532
00:24:39,420 --> 00:24:45,090
JavaScript 16 in executing I knew that

533
00:24:43,050 --> 00:24:47,159
the proof of concept was escaping the

534
00:24:45,090 --> 00:24:48,419
tag properly and that that JavaScript

535
00:24:47,160 --> 00:24:52,260
was actually reaching a broad authority

536
00:24:48,420 --> 00:24:55,740
being rendered I knew that in order for

537
00:24:52,260 --> 00:24:57,510
us to reach the code I say us any myself

538
00:24:55,740 --> 00:25:01,170
and my imaginary friend hangs out with

539
00:24:57,510 --> 00:25:02,790
me in my basement I knew that Houston

540
00:25:01,170 --> 00:25:04,370
saying us as a certain team Barack

541
00:25:02,790 --> 00:25:06,570
alliance of you because we're always

542
00:25:04,370 --> 00:25:08,939
collaborating but I knew that the

543
00:25:06,570 --> 00:25:10,590
execution didn't require authentication

544
00:25:08,940 --> 00:25:13,020
I didn't even go to any hate the word

545
00:25:10,590 --> 00:25:14,580
press so it wasn't that it often any

546
00:25:13,020 --> 00:25:18,450
kada cross-site scripting vulnerability

547
00:25:14,580 --> 00:25:20,850
in that plugin I knew that it also

548
00:25:18,450 --> 00:25:24,450
wasn't just a class that was defined in

549
00:25:20,850 --> 00:25:27,139
a page ping file that wasn't reachable

550
00:25:24,450 --> 00:25:29,220
in some cases you'll see of HP pilot has

551
00:25:27,140 --> 00:25:31,680
cross-site scripting vulnerability in it

552
00:25:29,220 --> 00:25:35,220
and it's just a class file you can get a

553
00:25:31,680 --> 00:25:37,650
code and I knew that the injection

554
00:25:35,220 --> 00:25:40,860
wasn't being sanitized all there wasn't

555
00:25:37,650 --> 00:25:43,950
something tricky going on by the plugin

556
00:25:40,860 --> 00:25:46,560
author so I knew that it was pretty

557
00:25:43,950 --> 00:25:48,840
valid and most likely if it wasn't

558
00:25:46,560 --> 00:25:50,070
successful I knew that the injection

559
00:25:48,840 --> 00:25:52,169
point might be sanitized there's

560
00:25:50,070 --> 00:25:54,870
something else going on that I didn't

561
00:25:52,170 --> 00:25:59,100
see encode that might exist around code

562
00:25:54,870 --> 00:26:02,250
in some cases you'll see a gap request

563
00:25:59,100 --> 00:26:04,560
or a variable and then the plugin author

564
00:26:02,250 --> 00:26:08,340
is casting a variable zoom in so you can

565
00:26:04,560 --> 00:26:10,950
jack any coding an industry you know

566
00:26:08,340 --> 00:26:12,240
anything with it and I also knew that

567
00:26:10,950 --> 00:26:15,360
some of the code might require

568
00:26:12,240 --> 00:26:18,300
authentication you might admin or

569
00:26:15,360 --> 00:26:20,100
whatever to reach the code or is not

570
00:26:18,300 --> 00:26:22,909
escaping tags properly which in some

571
00:26:20,100 --> 00:26:22,909
cases I found out

572
00:26:26,229 --> 00:26:37,059
let's see those there's people Gungor

573
00:26:31,579 --> 00:26:39,438
than 20 in this room where I mess up I

574
00:26:37,059 --> 00:26:43,069
was frustrated when I did this with

575
00:26:39,439 --> 00:26:45,559
slide but where I mess up I didn't have

576
00:26:43,069 --> 00:26:48,678
WordPress installed where the plugins

577
00:26:45,559 --> 00:26:51,229
could reach it so if if a plugin was

578
00:26:48,679 --> 00:26:54,439
looking reaching out for include for a

579
00:26:51,229 --> 00:26:58,369
while wordpress plugin our WordPress

580
00:26:54,439 --> 00:27:03,439
core file like WP dash Hammond espeed it

581
00:26:58,369 --> 00:27:07,059
will just error 500 I shouldn't probably

582
00:27:03,439 --> 00:27:10,389
notified everybody later on my research

583
00:27:07,059 --> 00:27:14,329
we should have put it that Barbara now

584
00:27:10,389 --> 00:27:17,958
listen um I didn't have the entire

585
00:27:14,329 --> 00:27:20,089
plugin copies so I had only copied the

586
00:27:17,959 --> 00:27:23,359
vulnerable PHP file out of the plug-in

587
00:27:20,089 --> 00:27:26,809
into my testing environment if that PHP

588
00:27:23,359 --> 00:27:30,829
file was including each p files from the

589
00:27:26,809 --> 00:27:31,999
plug-in itself it would fail it would be

590
00:27:30,829 --> 00:27:34,369
able to improve the file and it will

591
00:27:31,999 --> 00:27:40,609
just fail out and error if i put it

592
00:27:34,369 --> 00:27:43,668
again php5 doesn't set headers it

593
00:27:40,609 --> 00:27:45,799
ignores them because it's cgi execution

594
00:27:43,669 --> 00:27:48,259
it's not actually service tax a little

595
00:27:45,799 --> 00:27:50,209
time as it headers so some of the

596
00:27:48,259 --> 00:27:52,939
plugins were actually staying header

597
00:27:50,209 --> 00:27:54,289
types of like content types CSS and

598
00:27:52,939 --> 00:27:56,629
those aren't going to be rendered by the

599
00:27:54,289 --> 00:27:58,399
browser going to be interpreted as text

600
00:27:56,629 --> 00:28:02,448
so you're not going to get any tops of

601
00:27:58,399 --> 00:28:05,079
execution anyway the big kicker was I

602
00:28:02,449 --> 00:28:11,209
found out that WordPress is escaping the

603
00:28:05,079 --> 00:28:13,399
GPC or the GPR CS it post request cookie

604
00:28:11,209 --> 00:28:16,279
and server variables to Louisville two

605
00:28:13,399 --> 00:28:20,629
remotes air using and slashes on those

606
00:28:16,279 --> 00:28:23,449
if you include the word press the

607
00:28:20,629 --> 00:28:24,168
WordPress or utilities are for code in

608
00:28:23,449 --> 00:28:27,590
your plugin

609
00:28:24,169 --> 00:28:30,350
they all do in some cases you know they

610
00:28:27,590 --> 00:28:31,699
may not be because they're plugin Marlon

611
00:28:30,350 --> 00:28:34,459
you're hitting is actually outside of

612
00:28:31,700 --> 00:28:37,389
work are singing offers including it but

613
00:28:34,460 --> 00:28:41,989
for the ones that it is it made them all

614
00:28:37,389 --> 00:28:43,820
context-dependent the double star was

615
00:28:41,989 --> 00:28:49,119
the entire plug-in haan kabhi actually

616
00:28:43,820 --> 00:28:55,340
gave me a false negative six yeah so

617
00:28:49,119 --> 00:28:57,320
WordPress is doing this if you look at

618
00:28:55,340 --> 00:29:00,949
their code base now they did this like

619
00:28:57,320 --> 00:29:04,850
four or a five years ago I didn't notice

620
00:29:00,950 --> 00:29:09,379
i somehow i missed it I i guess i never

621
00:29:04,850 --> 00:29:10,939
noticed when i was when i was doing SQL

622
00:29:09,379 --> 00:29:13,009
injection that sometimes it will try and

623
00:29:10,940 --> 00:29:15,769
check well actually the reason why i was

624
00:29:13,009 --> 00:29:17,600
when i found was well i guess i would i

625
00:29:15,769 --> 00:29:19,519
somehow i see this i guess because I was

626
00:29:17,600 --> 00:29:20,869
missing I was only looking at

627
00:29:19,519 --> 00:29:24,820
authenticate install because i thought

628
00:29:20,869 --> 00:29:27,350
those are the most fun so i ended up

629
00:29:24,820 --> 00:29:28,850
finding this out hard way when I'm like

630
00:29:27,350 --> 00:29:32,149
why why are all these things being

631
00:29:28,850 --> 00:29:33,830
escape faculty I want to skate misc you

632
00:29:32,149 --> 00:29:36,018
only think the author the funny halters

633
00:29:33,830 --> 00:29:39,320
not escaping anything so something is

634
00:29:36,019 --> 00:29:41,259
escaping it and one of the smart guys or

635
00:29:39,320 --> 00:29:45,230
two of the smart guys on the cert team

636
00:29:41,259 --> 00:29:47,749
eric Oberon and chad semen they started

637
00:29:45,230 --> 00:29:50,450
poking at the wordpress trunk code our

638
00:29:47,749 --> 00:29:52,070
workers a core library code and I like

639
00:29:50,450 --> 00:29:55,279
yeah this is it like look at the look

640
00:29:52,070 --> 00:29:58,820
what's happening here I added these well

641
00:29:55,279 --> 00:30:01,210
in case people take pictures in simply

642
00:29:58,820 --> 00:30:04,158
click those you can reason over to go

643
00:30:01,210 --> 00:30:10,460
you can click them if you want entertain

644
00:30:04,159 --> 00:30:14,210
yourself um so this made all of my stuff

645
00:30:10,460 --> 00:30:17,509
so they're different I realized that

646
00:30:14,210 --> 00:30:19,070
with honoring the headers I only had 27

647
00:30:17,509 --> 00:30:21,590
without were automatically cross-site

648
00:30:19,070 --> 00:30:26,960
scripting our prospect script for not

649
00:30:21,590 --> 00:30:28,800
only in I found three manually I think

650
00:30:26,960 --> 00:30:32,760
just to make myself feel better

651
00:30:28,800 --> 00:30:34,500
solid 30 i manually validated they

652
00:30:32,760 --> 00:30:37,020
needed some tweaking they just needed a

653
00:30:34,500 --> 00:30:38,730
few of them needed an extra variable to

654
00:30:37,020 --> 00:30:41,280
be defined so that they could reach

655
00:30:38,730 --> 00:30:44,340
horrible Code one of them actually had

656
00:30:41,280 --> 00:30:46,110
two of them actually needed the entire

657
00:30:44,340 --> 00:30:49,709
plug-in copy was ever doing includes

658
00:30:46,110 --> 00:30:51,479
from their plug-in diet yes and as I

659
00:30:49,710 --> 00:30:56,190
mentioned before I've seen some stuff

660
00:30:51,480 --> 00:30:57,990
like this where the the actual code was

661
00:30:56,190 --> 00:31:00,330
vulnerable except for that line which

662
00:30:57,990 --> 00:31:04,830
made it not normally so that was a whole

663
00:31:00,330 --> 00:31:07,110
positive that over to Mike Olga says I

664
00:31:04,830 --> 00:31:10,080
was in I'm like that's it I'm not

665
00:31:07,110 --> 00:31:12,689
kidding more I thought maybe I could you

666
00:31:10,080 --> 00:31:15,090
know if I if I would have found a

667
00:31:12,690 --> 00:31:16,980
thousand plus own abilities maybe I can

668
00:31:15,090 --> 00:31:18,810
submit it to DEFCON its peak there or

669
00:31:16,980 --> 00:31:23,400
something like that and then like no

670
00:31:18,810 --> 00:31:25,919
movie that's it I'm done now so what

671
00:31:23,400 --> 00:31:29,400
I've learned this is the what I learned

672
00:31:25,920 --> 00:31:31,350
slide test yourself end-to-end I shave a

673
00:31:29,400 --> 00:31:34,470
full service tag for testing at the

674
00:31:31,350 --> 00:31:37,050
cross-site scripting I should have had

675
00:31:34,470 --> 00:31:39,120
an Apache server running PHP with

676
00:31:37,050 --> 00:31:42,510
wordpress on it with all the plugins

677
00:31:39,120 --> 00:31:44,040
located and then started firing the r9

678
00:31:42,510 --> 00:31:46,950
hexaploid right back I shouldn't have

679
00:31:44,040 --> 00:31:49,680
done the CGI page be CGI it was I

680
00:31:46,950 --> 00:31:52,920
thought it was a good idea it bit me and

681
00:31:49,680 --> 00:31:55,860
I know sometimes that's what good ideas

682
00:31:52,920 --> 00:31:57,720
do I should have researched any odd

683
00:31:55,860 --> 00:32:00,719
results that for making sense in

684
00:31:57,720 --> 00:32:03,080
hindsight I remember poking at SQL

685
00:32:00,720 --> 00:32:04,950
injection in a plugin that was

686
00:32:03,080 --> 00:32:07,770
authenticated or require authentication

687
00:32:04,950 --> 00:32:10,050
and seeing these weird slashes that were

688
00:32:07,770 --> 00:32:12,629
coming through that we're scheming the

689
00:32:10,050 --> 00:32:14,310
SQL injection and at the time I thought

690
00:32:12,630 --> 00:32:16,320
it was the plugin author who was doing

691
00:32:14,310 --> 00:32:18,659
it now I realize it was actually

692
00:32:16,320 --> 00:32:24,240
wordpress plugin or the world par score

693
00:32:18,660 --> 00:32:27,450
that was didn't realize so the word

694
00:32:24,240 --> 00:32:31,340
versus key things up made all the fall

695
00:32:27,450 --> 00:32:31,340
saturated plugging stuff work

696
00:32:31,970 --> 00:32:39,680
yeah so the word purse escaping stuff

697
00:32:35,660 --> 00:32:42,050
made everything contact dependent and

698
00:32:39,680 --> 00:32:43,940
you know that the aunt Celeste office

699
00:32:42,050 --> 00:32:47,090
States disqus seems you can't escape by

700
00:32:43,940 --> 00:32:52,190
the HTML tag so the context dependent

701
00:32:47,090 --> 00:32:54,230
stuff if it's loading up WordPress is

702
00:32:52,190 --> 00:32:56,450
putting work first load it's going to

703
00:32:54,230 --> 00:32:58,610
automatically estate anything I think

704
00:32:56,450 --> 00:33:00,950
that but you can still send this in

705
00:32:58,610 --> 00:33:02,570
because we're not seeking a HTML tag

706
00:33:00,950 --> 00:33:10,730
this is school going to send the hot wax

707
00:33:02,570 --> 00:33:14,300
of oxygen browser in this instance I

708
00:33:10,730 --> 00:33:16,820
can't escape this because you know the

709
00:33:14,300 --> 00:33:19,430
cross site scripting the variable is

710
00:33:16,820 --> 00:33:21,710
embedded in HTML tags I can't if I say

711
00:33:19,430 --> 00:33:24,260
that a cold or double go in its gonna

712
00:33:21,710 --> 00:33:30,500
end up seeking out I can't I can't break

713
00:33:24,260 --> 00:33:35,980
out of it which it it sucks because I

714
00:33:30,500 --> 00:33:40,190
have to manually go through all 1322

715
00:33:35,980 --> 00:33:42,380
entries and look and see and check their

716
00:33:40,190 --> 00:33:43,970
context are the inside an HTML tag on

717
00:33:42,380 --> 00:33:45,560
the inside of the house for Taylor it's

718
00:33:43,970 --> 00:33:50,720
not a job for today I might be able to

719
00:33:45,560 --> 00:33:52,840
you know do something um hi cant look at

720
00:33:50,720 --> 00:33:55,190
these things anymore 1300 of these

721
00:33:52,840 --> 00:33:58,010
cookies I started dreaming about

722
00:33:55,190 --> 00:33:59,060
cross-site scripting at PHP I went

723
00:33:58,010 --> 00:34:00,860
through the same thing when i was

724
00:33:59,060 --> 00:34:02,600
looking at rubygems two years ago I was

725
00:34:00,860 --> 00:34:05,209
on a dream about Ruby gems I just

726
00:34:02,600 --> 00:34:08,889
thought it got stopped when you have

727
00:34:05,210 --> 00:34:17,210
dreams on a giant Ruby gym chasing you

728
00:34:08,889 --> 00:34:19,369
so so what's next I'm kind of done with

729
00:34:17,210 --> 00:34:23,059
the wordpress plugin processor I really

730
00:34:19,369 --> 00:34:25,819
like finding like alafaya offer i mean i

731
00:34:23,059 --> 00:34:27,679
don't wanna I don't want to rely on

732
00:34:25,819 --> 00:34:29,569
social engineering someone who exploit

733
00:34:27,679 --> 00:34:31,609
something I just want to exploit it

734
00:34:29,569 --> 00:34:32,799
because I found it under the code and i

735
00:34:31,609 --> 00:34:36,440
don't mean something clicked something

736
00:34:32,799 --> 00:34:38,268
and i tried playing with the high school

737
00:34:36,440 --> 00:34:42,589
stuff some more just the sort of finish

738
00:34:38,268 --> 00:34:43,699
it out see what does i still feel like i

739
00:34:42,589 --> 00:34:45,859
should look at some of the entries to

740
00:34:43,699 --> 00:34:48,589
see infra valid I didn't share this with

741
00:34:45,859 --> 00:34:50,268
those guys in Germany and they said they

742
00:34:48,589 --> 00:34:54,018
had found some that were valid I'm not

743
00:34:50,268 --> 00:34:55,518
sure they were looking for more in-depth

744
00:34:54,018 --> 00:34:57,618
ones and I work they were looking to

745
00:34:55,518 --> 00:34:59,058
actually use these to exploit the

746
00:34:57,619 --> 00:35:01,220
plug-in and actually have like an

747
00:34:59,059 --> 00:35:03,349
administrative user like that i was

748
00:35:01,220 --> 00:35:05,569
looking to the Senate floor box so i

749
00:35:03,349 --> 00:35:08,180
might contact MSD with result they came

750
00:35:05,569 --> 00:35:10,339
up with I thought about applying this to

751
00:35:08,180 --> 00:35:14,319
see how functions like I open with in

752
00:35:10,339 --> 00:35:17,390
use or liquor SQL injection or si sirve

753
00:35:14,319 --> 00:35:19,569
see how emailed me news alafaya are

754
00:35:17,390 --> 00:35:25,069
quiet kind you know use this to find

755
00:35:19,569 --> 00:35:26,599
more drastic vulnerabilities and maybe

756
00:35:25,069 --> 00:35:29,569
work on some see stuff for a while I

757
00:35:26,599 --> 00:35:33,079
gotta stop looking at PHP get back to

758
00:35:29,569 --> 00:35:38,089
something that was equally painful but

759
00:35:33,079 --> 00:35:40,819
such as a different painting it this is

760
00:35:38,089 --> 00:35:42,950
my thank you slide thanking everyone

761
00:35:40,819 --> 00:35:45,380
here to listen you ramble about this I

762
00:35:42,950 --> 00:35:47,779
wanted to call out Brian Martin Scott

763
00:35:45,380 --> 00:35:52,160
water Ryan Hurst mica wordpress folder

764
00:35:47,779 --> 00:35:53,750
designer because these guys were I think

765
00:35:52,160 --> 00:35:57,379
got really had been involved with this

766
00:35:53,750 --> 00:35:59,750
they were you know helping me out and I

767
00:35:57,380 --> 00:36:02,410
had to tell them that I didn't realize

768
00:35:59,750 --> 00:36:05,869
that word parts was doing this and I

769
00:36:02,410 --> 00:36:08,029
wonder if she did and just figured she'd

770
00:36:05,869 --> 00:36:10,350
let me wrap myself up in my you know my

771
00:36:08,029 --> 00:36:12,990
own axle I just let it rip

772
00:36:10,350 --> 00:36:15,240
my shoelaces just like oh yeah you're an

773
00:36:12,990 --> 00:36:18,870
elite hacker dude we're scared what

774
00:36:15,240 --> 00:36:20,220
would we ever do I wonder how long it'll

775
00:36:18,870 --> 00:36:22,410
be till he figures out word these are

776
00:36:20,220 --> 00:36:24,509
all contacts of appended so I don't know

777
00:36:22,410 --> 00:36:27,149
no she she says that she really

778
00:36:24,510 --> 00:36:29,100
appreciated the work I did she said

779
00:36:27,150 --> 00:36:32,790
really then I don't know if that was

780
00:36:29,100 --> 00:36:35,819
sarcasm and so I assume it wasn't and

781
00:36:32,790 --> 00:36:37,560
she's just being nice and then like I'm

782
00:36:35,820 --> 00:36:39,270
sorry slide as the same as my thank you

783
00:36:37,560 --> 00:36:44,549
slide you but I kind of wasted these

784
00:36:39,270 --> 00:36:51,020
people's time maybe they learn something

785
00:36:44,550 --> 00:36:55,620
like go popular anymore I don't know I

786
00:36:51,020 --> 00:36:59,070
but it was all of all it was pretty much

787
00:36:55,620 --> 00:37:01,319
a big learning experience it was pretty

788
00:36:59,070 --> 00:37:03,470
much seeing if I could do something and

789
00:37:01,320 --> 00:37:06,420
then harshly succeeding and then just

790
00:37:03,470 --> 00:37:08,160
vetting out the stuff that I messed up

791
00:37:06,420 --> 00:37:10,290
on and hoping that other people can

792
00:37:08,160 --> 00:37:12,629
learn from it and you know see my

793
00:37:10,290 --> 00:37:16,950
mistakes this is sort of like my I have

794
00:37:12,630 --> 00:37:19,140
a people lab notebook on google docs of

795
00:37:16,950 --> 00:37:21,210
all my stuff this was sort of all the

796
00:37:19,140 --> 00:37:26,339
notes from that burden into this slide

797
00:37:21,210 --> 00:37:29,790
aking if anyone has any questions that's

798
00:37:26,340 --> 00:37:32,220
my Twitter handle I am Larry aqua calm

799
00:37:29,790 --> 00:37:33,630
because I've had number 16 years so back

800
00:37:32,220 --> 00:37:36,180
then they said we want to email

801
00:37:33,630 --> 00:37:37,680
addressed to be gone like Larry and I

802
00:37:36,180 --> 00:37:41,759
also had access to be all that server

803
00:37:37,680 --> 00:37:46,410
back then so I may not I wanted any

804
00:37:41,760 --> 00:37:49,320
questions tomatoes have you considered

805
00:37:46,410 --> 00:37:50,940
doing the same thing for no gift no I

806
00:37:49,320 --> 00:37:53,550
haven't thought about it I mean if

807
00:37:50,940 --> 00:37:56,660
there's a pattern there to begin it

808
00:37:53,550 --> 00:37:59,040
seems like the next step

809
00:37:56,660 --> 00:38:02,940
take a look at that I have a look at ojs

810
00:37:59,040 --> 00:38:05,550
at all so I am open to suggestions now

811
00:38:02,940 --> 00:38:08,760
because when I was doing the ruby gem

812
00:38:05,550 --> 00:38:10,560
stuff my former boss Mike Smith did you

813
00:38:08,760 --> 00:38:13,560
know we shall look at WordPress plugins

814
00:38:10,560 --> 00:38:14,820
you have a few day so now it's like at

815
00:38:13,560 --> 00:38:16,410
the time I was like yeah you know

816
00:38:14,820 --> 00:38:19,410
wordpress plugin down playing these

817
00:38:16,410 --> 00:38:22,290
rubygems and now together wordpress was

818
00:38:19,410 --> 00:38:25,020
a lot of fun because with rubygems you

819
00:38:22,290 --> 00:38:27,119
needed a you needed to create a project

820
00:38:25,020 --> 00:38:29,070
to put a ruby jamming this has to see if

821
00:38:27,119 --> 00:38:32,070
you wanna build Eva Cooper concept with

822
00:38:29,070 --> 00:38:33,780
WordPress it's right there you just set

823
00:38:32,070 --> 00:38:35,490
up WordPress and since take the plug-in

824
00:38:33,780 --> 00:38:41,910
and then see if your proof of concept

825
00:38:35,490 --> 00:38:47,220
exploit works other questions oh no not

826
00:38:41,910 --> 00:38:49,710
a question better comment I'm very

827
00:38:47,220 --> 00:39:07,348
thankful to you for talking about the

828
00:38:49,710 --> 00:39:17,180
failures or limitation oh did one thing

829
00:39:07,349 --> 00:39:17,180
I yeah I mean it worked

830
00:39:25,089 --> 00:39:34,700
yeah yeah I mean the fact that i found

831
00:39:31,970 --> 00:39:36,589
38 corner abilities at once is kind of

832
00:39:34,700 --> 00:39:39,680
significant is 30 of them were

833
00:39:36,589 --> 00:39:42,859
legitimately vulnerable than so 30 at

834
00:39:39,680 --> 00:39:44,930
once in one whack is that's pretty

835
00:39:42,859 --> 00:39:46,460
telling him right there you just and i

836
00:39:44,930 --> 00:39:48,078
gave it it's not like i looked at most

837
00:39:46,460 --> 00:39:50,059
plugin specifically i just grabbed the

838
00:39:48,079 --> 00:39:52,010
whole bunch said i'm going to have a

839
00:39:50,059 --> 00:39:53,869
computer go through and look through the

840
00:39:52,010 --> 00:39:55,490
code for vulnerabilities generated an

841
00:39:53,869 --> 00:39:58,970
exploit those and point heck we're at

842
00:39:55,490 --> 00:40:00,379
thirty of them the work so ya know what

843
00:39:58,970 --> 00:40:01,970
plugins you're running on your wordpress

844
00:40:00,380 --> 00:40:04,579
site is your writing wordpress site and

845
00:40:01,970 --> 00:40:07,430
if you're okie HP you might want to go

846
00:40:04,579 --> 00:40:18,730
through and look for simple bugs and

847
00:40:07,430 --> 00:40:18,730
things like other questions thanks Lori

