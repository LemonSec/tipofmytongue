1
00:00:00,979 --> 00:00:05,879
all right welcome everybody I think it's

2
00:00:03,840 --> 00:00:07,649
time for me to start I'm so glad you

3
00:00:05,879 --> 00:00:10,320
guys are here thank you so much for

4
00:00:07,649 --> 00:00:12,090
coming my name is Joshua right I'm a

5
00:00:10,320 --> 00:00:13,710
senior instructor with the SANS

6
00:00:12,090 --> 00:00:16,560
Institute I've been teaching with sands

7
00:00:13,710 --> 00:00:18,779
for about 13 years now I've written the

8
00:00:16,560 --> 00:00:21,390
classes on mobile hacking wireless

9
00:00:18,779 --> 00:00:23,759
hacking and a bunch of other things but

10
00:00:21,390 --> 00:00:25,500
frankly I teach first and so much

11
00:00:23,760 --> 00:00:28,199
because I love the opportunity to get up

12
00:00:25,500 --> 00:00:31,259
and speak to people about my favorite

13
00:00:28,199 --> 00:00:33,059
subjects and this is a topic that I have

14
00:00:31,260 --> 00:00:35,190
really enjoyed working on a project that

15
00:00:33,059 --> 00:00:36,839
I really enjoyed and you know I've got a

16
00:00:35,190 --> 00:00:38,910
couple of goals coming into this today I

17
00:00:36,840 --> 00:00:41,190
said you know I have an opportunity to

18
00:00:38,910 --> 00:00:43,260
speak and in front of b-sides I was born

19
00:00:41,190 --> 00:00:44,849
in Massachusetts I've since transported

20
00:00:43,260 --> 00:00:46,649
to Rhode Island

21
00:00:44,850 --> 00:00:48,149
I'll always be a transplant and now

22
00:00:46,649 --> 00:00:50,250
Massachusetts people don't like me

23
00:00:48,149 --> 00:00:52,379
either but I feel like I'm home here

24
00:00:50,250 --> 00:00:54,690
like I like this place and and and I

25
00:00:52,379 --> 00:00:56,399
love Boston and you know I love besides

26
00:00:54,690 --> 00:00:58,709
everything that a stands for everything

27
00:00:56,399 --> 00:01:00,960
that you know it serves the community to

28
00:00:58,710 --> 00:01:02,460
do and I thought you know I want to do a

29
00:01:00,960 --> 00:01:04,769
couple things here number one on my

30
00:01:02,460 --> 00:01:06,150
agenda today is to entertain you I want

31
00:01:04,769 --> 00:01:07,530
you to laugh I want you to enjoy this

32
00:01:06,150 --> 00:01:10,799
presentation I want you to think back

33
00:01:07,530 --> 00:01:13,020
and say man I really learned a lot and I

34
00:01:10,799 --> 00:01:14,880
really had fun and even know I could do

35
00:01:13,020 --> 00:01:17,399
both together so that's really what I'm

36
00:01:14,880 --> 00:01:20,580
hoping I want you to laugh at enjoy this

37
00:01:17,400 --> 00:01:22,530
presentation and I'm hoping that you

38
00:01:20,580 --> 00:01:25,140
leave here with some skills that you

39
00:01:22,530 --> 00:01:26,970
might not have known before so this

40
00:01:25,140 --> 00:01:30,329
presentation is called ghost in the

41
00:01:26,970 --> 00:01:32,729
Droid and it started last year when I

42
00:01:30,329 --> 00:01:34,079
started doing some Android application

43
00:01:32,729 --> 00:01:36,530
in our office and I've been doing that

44
00:01:34,079 --> 00:01:39,929
for several years but I wanted to get

45
00:01:36,530 --> 00:01:41,790
much better at Android app analysis and

46
00:01:39,930 --> 00:01:43,590
you know customers come to me and they

47
00:01:41,790 --> 00:01:45,810
bring their applications and I do work

48
00:01:43,590 --> 00:01:47,790
on that and that's great but I really

49
00:01:45,810 --> 00:01:50,100
wanted to get remarkably better at app

50
00:01:47,790 --> 00:01:54,270
analysis so I came up with this project

51
00:01:50,100 --> 00:02:00,089
idea and it helps if I plug this little

52
00:01:54,270 --> 00:02:03,000
stick in okay I was watching a TV show

53
00:02:00,090 --> 00:02:04,710
with my daughter called a haunting she

54
00:02:03,000 --> 00:02:06,570
loves all these TV shows they be seen a

55
00:02:04,710 --> 00:02:08,728
haunting before this there's all these

56
00:02:06,570 --> 00:02:11,370
TV shows on like Discovery Network and

57
00:02:08,729 --> 00:02:12,470
it's about haunted places and things

58
00:02:11,370 --> 00:02:14,180
like that

59
00:02:12,470 --> 00:02:16,609
and I learned about this thing called a

60
00:02:14,180 --> 00:02:20,600
ghost box which I had never heard of

61
00:02:16,610 --> 00:02:22,610
before so I you know stole this clip

62
00:02:20,600 --> 00:02:29,570
totally k so I thought I would play for

63
00:02:22,610 --> 00:02:32,600
you so you can see what I saw but one

64
00:02:29,570 --> 00:02:35,150
evening Darren has a lapse in judgment

65
00:02:32,600 --> 00:02:39,470
he ignores Stephens warning and

66
00:02:35,150 --> 00:02:42,850
downloads a ghost box my cousin had

67
00:02:39,470 --> 00:02:45,740
passed away and I was a little upset

68
00:02:42,850 --> 00:02:47,359
I've downloaded this app from my phone

69
00:02:45,740 --> 00:02:56,140
and I don't think you not only had

70
00:02:47,360 --> 00:02:56,140
whatever there's anybody here talk to me

71
00:02:56,200 --> 00:02:58,790
hi

72
00:02:57,490 --> 00:03:01,610
[Music]

73
00:02:58,790 --> 00:03:07,250
only one person the world called a Baldy

74
00:03:01,610 --> 00:03:09,730
and it was him watch the vid jumps down

75
00:03:07,250 --> 00:03:09,730
ready

76
00:03:12,680 --> 00:03:19,660
[Music]

77
00:03:15,569 --> 00:03:21,250
all right so I watched that video and I

78
00:03:19,660 --> 00:03:24,730
couldn't believe that there's a thing

79
00:03:21,250 --> 00:03:27,130
called a Ghost Box app okay so yes there

80
00:03:24,730 --> 00:03:29,649
are hundreds of apps in the Android

81
00:03:27,130 --> 00:03:31,750
Marketplace that claim to detect the

82
00:03:29,650 --> 00:03:34,090
presence of the supernatural that have

83
00:03:31,750 --> 00:03:37,870
all these capabilities to detect ghosts

84
00:03:34,090 --> 00:03:40,780
so I came up with this idea I'm going to

85
00:03:37,870 --> 00:03:42,640
spend $200 on crappy Android

86
00:03:40,780 --> 00:03:44,680
applications I'm not going to get

87
00:03:42,640 --> 00:03:46,750
anything that's free I'm only going to

88
00:03:44,680 --> 00:03:49,959
get stuff that is actually marketed as

89
00:03:46,750 --> 00:03:52,090
Pro ghost detection and I want to

90
00:03:49,959 --> 00:03:53,709
evaluate what do they really do by

91
00:03:52,090 --> 00:03:55,290
reverse engineering all these apps and

92
00:03:53,709 --> 00:03:58,050
they fell into four categories

93
00:03:55,290 --> 00:04:00,880
electromagnetic frequency analysis tools

94
00:03:58,050 --> 00:04:03,370
electronic voice phenomenon or EVP tools

95
00:04:00,880 --> 00:04:06,280
ghost radar and visual identification

96
00:04:03,370 --> 00:04:08,650
and ghost communication tools and then

97
00:04:06,280 --> 00:04:10,780
for all these apps I would use them in

98
00:04:08,650 --> 00:04:12,610
areas that I thought would be the most

99
00:04:10,780 --> 00:04:15,640
likely when I would experience the

100
00:04:12,610 --> 00:04:18,400
supernatural in cemeteries late at night

101
00:04:15,640 --> 00:04:20,890
in a cabin in the woods you get the idea

102
00:04:18,399 --> 00:04:22,750
okay and so I used all these apps and

103
00:04:20,890 --> 00:04:25,390
then I reverse engineered them to find

104
00:04:22,750 --> 00:04:28,000
out you know are these apps really doing

105
00:04:25,390 --> 00:04:29,770
what they claimed or are they full of

106
00:04:28,000 --> 00:04:32,350
crap okay and these are the five apps

107
00:04:29,770 --> 00:04:35,380
that I chose here okay they range

108
00:04:32,350 --> 00:04:38,470
between $1 and $30 for these

109
00:04:35,380 --> 00:04:40,659
applications gang and only the apps that

110
00:04:38,470 --> 00:04:41,740
were Pro in genuine ghost detection

111
00:04:40,660 --> 00:04:43,750
nothing that was meant for entertainment

112
00:04:41,740 --> 00:04:45,310
so we're going to talk about these five

113
00:04:43,750 --> 00:04:48,490
apps that I pulled apart and what I

114
00:04:45,310 --> 00:04:49,780
learned in the process the first half

115
00:04:48,490 --> 00:04:52,150
that I looked at is an app called the

116
00:04:49,780 --> 00:04:55,570
ghost hunter this is published by Intel

117
00:04:52,150 --> 00:04:58,049
attack it was 99 cents 3.6 stars 10 to

118
00:04:55,570 --> 00:05:01,360
50,000 downloads it is your all-in-one

119
00:04:58,050 --> 00:05:03,280
go to ghost detection app it does EMF

120
00:05:01,360 --> 00:05:06,190
scanning electronic voice phenomenon

121
00:05:03,280 --> 00:05:08,409
analysis visual decoding and it even has

122
00:05:06,190 --> 00:05:10,750
a spirit board which is a category I

123
00:05:08,410 --> 00:05:12,400
didn't even cover I love the coach and

124
00:05:10,750 --> 00:05:15,039
you read these evals and I think they're

125
00:05:12,400 --> 00:05:17,799
fascinating Julie gave this app a four

126
00:05:15,039 --> 00:05:20,050
star rating I use a lot of ghost hunting

127
00:05:17,800 --> 00:05:21,909
apps I have tested my phone against the

128
00:05:20,050 --> 00:05:24,610
equipment used by pros and his work I

129
00:05:21,909 --> 00:05:27,069
could tell a fake app when I see it well

130
00:05:24,610 --> 00:05:30,219
Julie I don't really know if that's true

131
00:05:27,069 --> 00:05:32,409
okay so this is what the app does and

132
00:05:30,219 --> 00:05:34,509
the app has like electromagnetic

133
00:05:32,409 --> 00:05:38,050
frequency detection where it records

134
00:05:34,509 --> 00:05:39,939
these XY and you know that supposed to

135
00:05:38,050 --> 00:05:41,949
be Z I think that's a typo I'm not

136
00:05:39,939 --> 00:05:44,710
really sure okay

137
00:05:41,949 --> 00:05:46,979
it's got this like histogram thing it

138
00:05:44,710 --> 00:05:49,628
even gives you a Google map with ghost

139
00:05:46,979 --> 00:05:51,550
locations where hauntings have been

140
00:05:49,629 --> 00:05:53,349
reported to have happened which frankly

141
00:05:51,550 --> 00:05:54,939
I found rather useful I kind of liked

142
00:05:53,349 --> 00:05:58,270
that that was the only useful thing here

143
00:05:54,939 --> 00:06:00,219
okay so I took a little video of what

144
00:05:58,270 --> 00:06:01,779
this application does and I wanted to

145
00:06:00,219 --> 00:06:04,389
show you this is this is what it does

146
00:06:01,779 --> 00:06:05,889
now I want you to watch closely because

147
00:06:04,389 --> 00:06:10,590
you there may be evidence of ghost

148
00:06:05,889 --> 00:06:10,590
activity here okay so well I'll show you

149
00:06:11,400 --> 00:06:19,620
now that it makes in it scanning again

150
00:06:22,919 --> 00:06:30,870
now watch closely

151
00:06:24,810 --> 00:06:30,870
Green is no ghost but red red is warning

152
00:06:33,770 --> 00:06:40,520
did you see it oh the spectral

153
00:06:37,819 --> 00:06:41,389
phenomenon right there those are those

154
00:06:40,520 --> 00:06:43,250
are ghosts

155
00:06:41,389 --> 00:06:45,440
ladies and gentlemen those and you can

156
00:06:43,250 --> 00:06:47,630
see on the graph those are ghosts that

157
00:06:45,440 --> 00:06:49,580
are being reported at the moment and

158
00:06:47,630 --> 00:06:52,819
this is what this application does okay

159
00:06:49,580 --> 00:06:55,400
so on my rooted android device i

160
00:06:52,819 --> 00:06:57,410
connected over USB cable with debug mode

161
00:06:55,400 --> 00:06:58,729
turned on and i used the Android debug

162
00:06:57,410 --> 00:07:01,310
bridge tool that comes with the

163
00:06:58,729 --> 00:07:03,560
development tools to identify what was

164
00:07:01,310 --> 00:07:05,870
the app name and then I downloaded it

165
00:07:03,560 --> 00:07:08,720
from my Android device so now I have the

166
00:07:05,870 --> 00:07:11,330
android APK you can just go to APK monk

167
00:07:08,720 --> 00:07:13,400
calm and download any APK you want

168
00:07:11,330 --> 00:07:15,199
including this one it's a little on the

169
00:07:13,400 --> 00:07:17,690
sketchy side because they do sell it but

170
00:07:15,199 --> 00:07:20,479
you know if it's for research I'm sure

171
00:07:17,690 --> 00:07:23,569
that's okay okay now apk files are just

172
00:07:20,479 --> 00:07:26,000
zip files you just unzip them and so I

173
00:07:23,569 --> 00:07:30,319
unzip this file and I see all these

174
00:07:26,000 --> 00:07:33,650
things like a you know layout Android

175
00:07:30,319 --> 00:07:36,440
audio main to XML audio recorder draw

176
00:07:33,650 --> 00:07:38,359
XML EMF XML and these are all the

177
00:07:36,440 --> 00:07:40,490
application activities in Android which

178
00:07:38,360 --> 00:07:42,680
are the screens and Android and then a

179
00:07:40,490 --> 00:07:45,889
whole bunch of these images read scan

180
00:07:42,680 --> 00:07:48,500
one read scan to read skin to read scan

181
00:07:45,889 --> 00:07:50,419
21 tons and tons of different graphic

182
00:07:48,500 --> 00:07:51,889
images so I'm like oh well that looks

183
00:07:50,419 --> 00:07:54,320
interesting what's going on with that

184
00:07:51,889 --> 00:07:56,270
and then I opened up Explorer and I

185
00:07:54,320 --> 00:07:58,669
realized the app is just eight static

186
00:07:56,270 --> 00:08:02,568
images of white blobs that are actual

187
00:07:58,669 --> 00:08:04,099
goes okay and that's that's not is

188
00:08:02,569 --> 00:08:06,110
that's all it does and then when you

189
00:08:04,099 --> 00:08:08,300
look at the source code it does a bunch

190
00:08:06,110 --> 00:08:10,069
of random number generation here and the

191
00:08:08,300 --> 00:08:12,110
random number generator says things like

192
00:08:10,069 --> 00:08:15,530
you know generate a random number that's

193
00:08:12,110 --> 00:08:17,690
between zero and ten if it's less than

194
00:08:15,530 --> 00:08:19,400
four then it's going to be green but

195
00:08:17,690 --> 00:08:22,009
then do another random number and if

196
00:08:19,400 --> 00:08:24,258
it's zero to 100 if it's greater than 70

197
00:08:22,009 --> 00:08:27,409
then it's a ghostly image and it draws

198
00:08:24,259 --> 00:08:29,240
that so you know about you know thirty

199
00:08:27,409 --> 00:08:32,779
percent of the time you're going to get

200
00:08:29,240 --> 00:08:34,579
ghosts out of the experience game so you

201
00:08:32,779 --> 00:08:36,380
know looking at this I'm going to say

202
00:08:34,578 --> 00:08:38,779
this is busted I'm going to say this is

203
00:08:36,380 --> 00:08:41,088
not actually doing any ghost detection

204
00:08:38,779 --> 00:08:43,610
activity this is just not cool it's just

205
00:08:41,089 --> 00:08:46,040
a bunch of static images random numbers

206
00:08:43,610 --> 00:08:47,779
no I'm just going to go with this is not

207
00:08:46,040 --> 00:08:50,579
okay so I cross that off the

208
00:08:47,779 --> 00:08:53,490
the next step I looked at is Joe's ghost

209
00:08:50,580 --> 00:08:55,080
box okay now Joe's ghost box is written

210
00:08:53,490 --> 00:08:57,600
by a guy named Steve Holt a which is

211
00:08:55,080 --> 00:09:00,720
apparently one of the original Joe's

212
00:08:57,600 --> 00:09:02,730
disciples now Joe was well known in the

213
00:09:00,720 --> 00:09:05,459
ghost hunting field he actually produced

214
00:09:02,730 --> 00:09:07,830
not an app but a real electronic device

215
00:09:05,459 --> 00:09:10,199
in like a beige kind of box that looks

216
00:09:07,830 --> 00:09:12,060
almost exactly like that and then you

217
00:09:10,200 --> 00:09:14,160
would tune it and adjust the speed and

218
00:09:12,060 --> 00:09:17,130
it was electronic voice phenomenon

219
00:09:14,160 --> 00:09:19,199
analysis where it would pick up spectral

220
00:09:17,130 --> 00:09:20,520
activity out of the airwaves and then

221
00:09:19,200 --> 00:09:22,529
play it on the speaker and then you

222
00:09:20,520 --> 00:09:26,310
could hear what the ghosts were saying

223
00:09:22,529 --> 00:09:30,149
to you this was $1.00 at 11 cents 65

224
00:09:26,310 --> 00:09:32,399
ratings 5,000 downloads I loved iflores

225
00:09:30,149 --> 00:09:34,230
comment here I was just looking at my

226
00:09:32,399 --> 00:09:36,360
dad's picture in my head telling him

227
00:09:34,230 --> 00:09:39,600
that I missed him then on my third try

228
00:09:36,360 --> 00:09:41,550
using the app I hear I love u2 in

229
00:09:39,600 --> 00:09:44,490
Spanish which is the language he spoke

230
00:09:41,550 --> 00:09:46,199
clearly there's a connection there okay

231
00:09:44,490 --> 00:09:48,330
so clearly you know that that's what's

232
00:09:46,200 --> 00:09:50,370
going on so this is an app you can get

233
00:09:48,330 --> 00:09:53,970
for Android where you can install it and

234
00:09:50,370 --> 00:09:55,140
then get this kind of activity so the

235
00:09:53,970 --> 00:09:57,209
app is very simple

236
00:09:55,140 --> 00:10:00,089
that's good old Joe who's now sadly

237
00:09:57,209 --> 00:10:02,310
departed from us is little bust up there

238
00:10:00,089 --> 00:10:04,320
at the top but in the application here

239
00:10:02,310 --> 00:10:07,469
you just turn it on and it starts

240
00:10:04,320 --> 00:10:10,529
playing audio and it claims the decode

241
00:10:07,470 --> 00:10:12,510
audio it extracts that electronic voice

242
00:10:10,529 --> 00:10:15,300
phenomenon information it's getting this

243
00:10:12,510 --> 00:10:17,579
audio from somewhere you control the

244
00:10:15,300 --> 00:10:20,880
speed of playback and then you can ask

245
00:10:17,579 --> 00:10:23,729
it questions and then it responds would

246
00:10:20,880 --> 00:10:25,770
answer okay so you know I download this

247
00:10:23,730 --> 00:10:27,839
application and and I'm taking a look at

248
00:10:25,770 --> 00:10:30,300
it here and it looks just like this and

249
00:10:27,839 --> 00:10:45,209
I took a little audio recording and I

250
00:10:30,300 --> 00:10:47,990
want you to hear what I heard on this to

251
00:10:45,209 --> 00:10:47,989
make it faster

252
00:10:52,199 --> 00:10:59,289
and that's all it does okay so people

253
00:10:56,769 --> 00:11:02,289
listen to the application and then they

254
00:10:59,289 --> 00:11:05,019
strain to hear some message and they ask

255
00:11:02,289 --> 00:11:07,119
questions and they listen for responses

256
00:11:05,019 --> 00:11:08,859
to try to find out is this app really

257
00:11:07,119 --> 00:11:10,829
communicating with the dead and

258
00:11:08,859 --> 00:11:12,789
sometimes they hear things like a

259
00:11:10,829 --> 00:11:15,248
flurries here okay

260
00:11:12,789 --> 00:11:19,319
so again with this application it's just

261
00:11:15,249 --> 00:11:24,009
an apk file so I unzipped it and

262
00:11:19,319 --> 00:11:26,889
interestingly there were 14,000 mp3

263
00:11:24,009 --> 00:11:30,069
files embedded in this application and I

264
00:11:26,889 --> 00:11:33,309
thought that's curious isn't it that's

265
00:11:30,069 --> 00:11:35,079
that's interesting so there are certain

266
00:11:33,309 --> 00:11:38,679
look at the source code I saw code like

267
00:11:35,079 --> 00:11:41,169
this there's a try block and what it

268
00:11:38,679 --> 00:11:43,419
does is it generates a new random value

269
00:11:41,169 --> 00:11:46,149
based off of the number of songs that

270
00:11:43,419 --> 00:11:49,209
are registered like between 0 and 14,000

271
00:11:46,149 --> 00:11:51,729
and then it chooses a random value and

272
00:11:49,209 --> 00:11:54,878
then it plays that value and then it

273
00:11:51,729 --> 00:11:58,269
initializes the counter all it does is

274
00:11:54,879 --> 00:11:59,859
play random one second clips over and

275
00:11:58,269 --> 00:12:02,409
over and over again and you can make it

276
00:11:59,859 --> 00:12:04,599
play faster or slower but because

277
00:12:02,409 --> 00:12:06,309
there's so many clips it doesn't really

278
00:12:04,599 --> 00:12:09,609
ever sound like the same experience

279
00:12:06,309 --> 00:12:11,769
twice you're very unlikely to decode one

280
00:12:09,609 --> 00:12:13,959
specific sound repeating multiple times

281
00:12:11,769 --> 00:12:15,459
or if you are able to do that you'll

282
00:12:13,959 --> 00:12:19,539
likely attributed to some kind of a

283
00:12:15,459 --> 00:12:21,429
ghostly activity now I have a I don't

284
00:12:19,539 --> 00:12:23,649
know I'm going to call it a stroke of

285
00:12:21,429 --> 00:12:25,629
compassion here and then I had a

286
00:12:23,649 --> 00:12:29,349
question that I wasn't sure I knew the

287
00:12:25,629 --> 00:12:34,989
answer to can ghost influence the random

288
00:12:29,349 --> 00:12:37,359
number generator on Android devices I'm

289
00:12:34,989 --> 00:12:38,799
not really sure but I'm going to call

290
00:12:37,359 --> 00:12:42,099
this plausible I'm going to say that

291
00:12:38,799 --> 00:12:44,228
this could be the case I'm not really

292
00:12:42,099 --> 00:12:49,059
positive but I think this could be the

293
00:12:44,229 --> 00:12:50,799
real deal here okay all right the third

294
00:12:49,059 --> 00:12:54,368
app I want to talk about is an app

295
00:12:50,799 --> 00:12:56,799
called the psb7 ghost box application

296
00:12:54,369 --> 00:13:00,489
and this is published by Luna spirit

297
00:12:56,799 --> 00:13:03,429
detection it's $15 okay now as far as

298
00:13:00,489 --> 00:13:04,089
apps go unless it's like keno or

299
00:13:03,429 --> 00:13:07,240
something

300
00:13:04,089 --> 00:13:09,879
you know final cut I don't pay $15 for

301
00:13:07,240 --> 00:13:11,949
moblab very often okay but but but I got

302
00:13:09,879 --> 00:13:15,939
this application I downloaded it here

303
00:13:11,949 --> 00:13:19,479
okay it has 11 ratings 2.9 stars

304
00:13:15,939 --> 00:13:22,360
it's an EVP app and it claims to decode

305
00:13:19,480 --> 00:13:25,029
am/fm radio frequency waves and it does

306
00:13:22,360 --> 00:13:26,379
noise cancellation now I'm getting all

307
00:13:25,029 --> 00:13:28,029
kinds of suspicious here

308
00:13:26,379 --> 00:13:30,160
because I'm pretty sure my Android

309
00:13:28,029 --> 00:13:31,749
devices not have an am/fm radio in it

310
00:13:30,160 --> 00:13:34,420
yeah and it's claiming to capture and

311
00:13:31,749 --> 00:13:35,620
decode an FM radio waves I'm not saying

312
00:13:34,420 --> 00:13:37,748
that they couldn't be doing some magic

313
00:13:35,620 --> 00:13:41,290
SDR thing but I'm getting a little

314
00:13:37,749 --> 00:13:44,220
doubtful here okay Billy Allen here gave

315
00:13:41,290 --> 00:13:47,199
it a five star rating says I own a real

316
00:13:44,220 --> 00:13:49,149
PBS b7 this is just the app version of

317
00:13:47,199 --> 00:13:51,699
it and not excited to compare this to my

318
00:13:49,149 --> 00:13:54,040
to it to my surprise they picked up

319
00:13:51,699 --> 00:13:58,569
nearly exactly the same readings I

320
00:13:54,040 --> 00:14:01,300
highly recommend this app okay I don't

321
00:13:58,569 --> 00:14:04,059
know what I have to say about the real

322
00:14:01,300 --> 00:14:05,349
PS v7 software on the you know they

323
00:14:04,059 --> 00:14:07,029
actually sell that it's a hardware

324
00:14:05,350 --> 00:14:09,550
device you can buy it on Amazon I think

325
00:14:07,029 --> 00:14:11,800
it's like $400 or something okay so you

326
00:14:09,550 --> 00:14:14,319
can buy the real deal or you could just

327
00:14:11,800 --> 00:14:18,939
get this app $15 and now it seems like a

328
00:14:14,319 --> 00:14:20,649
real bargain at this okay so so so far

329
00:14:18,939 --> 00:14:22,779
we've been looking at applications where

330
00:14:20,649 --> 00:14:25,779
you know I unzip it and the answers just

331
00:14:22,779 --> 00:14:27,699
fell into my lap okay the first app had

332
00:14:25,779 --> 00:14:30,699
the ghostly images in it the second apps

333
00:14:27,699 --> 00:14:32,170
had the 15,000 mp3 files and I showed

334
00:14:30,699 --> 00:14:34,089
you some source code associated with

335
00:14:32,170 --> 00:14:36,009
those apps but I want to show you how to

336
00:14:34,089 --> 00:14:37,959
get at that source code so you can do

337
00:14:36,009 --> 00:14:40,059
the same kind of analysis sometimes

338
00:14:37,959 --> 00:14:41,949
unzipping an app is all you need to do

339
00:14:40,059 --> 00:14:45,490
and then you look at preference files

340
00:14:41,949 --> 00:14:47,829
XML files images files you unzip Pokemon

341
00:14:45,490 --> 00:14:50,529
go and every pokemon that ever exists is

342
00:14:47,829 --> 00:14:53,109
there okay sometimes all it does is an

343
00:14:50,529 --> 00:14:54,759
unzip and that's all you need but there

344
00:14:53,110 --> 00:14:57,790
are other ways that we can do this as

345
00:14:54,759 --> 00:14:59,769
well so with this app you just press the

346
00:14:57,790 --> 00:15:02,410
on button that's the only functionality

347
00:14:59,769 --> 00:15:04,929
in this application if the instructions

348
00:15:02,410 --> 00:15:07,480
say tap on and then wait two to three

349
00:15:04,929 --> 00:15:11,589
minutes for calibration for best results

350
00:15:07,480 --> 00:15:13,449
I'm like okay well that seems like a big

351
00:15:11,589 --> 00:15:17,019
lie but okay I'm going to go with that

352
00:15:13,449 --> 00:15:17,890
array that psb7 will cancel out noise

353
00:15:17,019 --> 00:15:20,680
and

354
00:15:17,890 --> 00:15:22,930
AM FM frequency waves and it's proven to

355
00:15:20,680 --> 00:15:25,209
work on many accounts and it's even

356
00:15:22,930 --> 00:15:28,060
featured on the Travel Channel no it's

357
00:15:25,209 --> 00:15:30,399
nice okay so I've started taking a look

358
00:15:28,060 --> 00:15:33,399
at this app and when you click the on

359
00:15:30,399 --> 00:15:37,170
button here which I'm going to do in

360
00:15:33,399 --> 00:15:37,170
this video you'll see what it does

361
00:15:38,339 --> 00:15:44,940
did you guys hear it listen to the post

362
00:15:56,180 --> 00:16:01,609
I let it run for two three minutes I'm

363
00:15:59,390 --> 00:16:03,319
not going to put you through that but

364
00:16:01,610 --> 00:16:06,200
that's about all I heard though that was

365
00:16:03,320 --> 00:16:09,740
about the entirety of the response that

366
00:16:06,200 --> 00:16:11,660
I got from the psb7 Ghost Box app so I

367
00:16:09,740 --> 00:16:13,940
started doing some reverse engineering

368
00:16:11,660 --> 00:16:17,000
now I wanted to talk about Android app

369
00:16:13,940 --> 00:16:19,460
compilation now if you're doing mobile

370
00:16:17,000 --> 00:16:21,080
application analysis you don't have to

371
00:16:19,460 --> 00:16:22,670
be a programmer and a lot of the

372
00:16:21,080 --> 00:16:24,410
students and I talked to a lot of people

373
00:16:22,670 --> 00:16:26,599
they say you know what I'm just not a

374
00:16:24,410 --> 00:16:28,969
programmer I think people when they did

375
00:16:26,600 --> 00:16:32,030
computer science in college had you know

376
00:16:28,970 --> 00:16:34,280
they were doing Pascal or god forbid

377
00:16:32,030 --> 00:16:36,980
objective-c and they just had a really

378
00:16:34,280 --> 00:16:39,350
bad experience okay and like a you know

379
00:16:36,980 --> 00:16:41,750
a bubble sort I just can't do that

380
00:16:39,350 --> 00:16:43,310
anymore and people just a shoe coating

381
00:16:41,750 --> 00:16:46,280
and like no I'm not doing that

382
00:16:43,310 --> 00:16:48,589
okay well you don't have to be a coder

383
00:16:46,280 --> 00:16:51,110
to do app reverse engineering but you

384
00:16:48,590 --> 00:16:53,180
need to be able to look at code okay now

385
00:16:51,110 --> 00:16:54,830
what is involved with looking at code

386
00:16:53,180 --> 00:16:56,780
well we're going to look at some tools

387
00:16:54,830 --> 00:16:59,600
but even when you got the source code

388
00:16:56,780 --> 00:17:01,610
all that's involved looking at code is a

389
00:16:59,600 --> 00:17:03,880
lot of Google and Stack Overflow

390
00:17:01,610 --> 00:17:06,589
okay and that's really yes okay I'm

391
00:17:03,880 --> 00:17:08,630
convinced that's the best programmers

392
00:17:06,589 --> 00:17:11,179
spend 90% of their day just looking

393
00:17:08,630 --> 00:17:14,000
stuff up on Stack Overflow I'm convinced

394
00:17:11,180 --> 00:17:16,730
that's what programmers do ok that's

395
00:17:14,000 --> 00:17:18,560
what I do you need to have some comfort

396
00:17:16,730 --> 00:17:20,540
and familiarity with the Android

397
00:17:18,560 --> 00:17:21,889
software development kit you need to be

398
00:17:20,540 --> 00:17:24,319
able to understand what these different

399
00:17:21,890 --> 00:17:27,170
API calls do and how they actually

400
00:17:24,319 --> 00:17:29,840
function but besides use googling things

401
00:17:27,170 --> 00:17:33,740
and a little bit of patience you can

402
00:17:29,840 --> 00:17:35,810
understand code now android apk files

403
00:17:33,740 --> 00:17:37,910
are like java jar files

404
00:17:35,810 --> 00:17:40,190
okay now java jar files are popular

405
00:17:37,910 --> 00:17:42,320
because like for instance on how many be

406
00:17:40,190 --> 00:17:43,820
overrun burp suite before okay when you

407
00:17:42,320 --> 00:17:47,149
run burp suite what platform do you

408
00:17:43,820 --> 00:17:49,550
wrote on windows linux mac yes because

409
00:17:47,150 --> 00:17:51,800
it's a jar file and you have a java

410
00:17:49,550 --> 00:17:53,870
runtime engine that will interpret that

411
00:17:51,800 --> 00:17:56,389
jar file and turn it into executable

412
00:17:53,870 --> 00:17:58,189
code android apps are the same way most

413
00:17:56,390 --> 00:18:02,060
android phones are armed where there's

414
00:17:58,190 --> 00:18:03,710
also mips and risk and x86 intel mix

415
00:18:02,060 --> 00:18:05,540
android phones and they're not using ARM

416
00:18:03,710 --> 00:18:07,610
processors so there's all these

417
00:18:05,540 --> 00:18:09,500
different processor architectures so

418
00:18:07,610 --> 00:18:12,080
program is running android apps are

419
00:18:09,500 --> 00:18:15,080
not distributing apps compiled for a

420
00:18:12,080 --> 00:18:16,909
single platform not very frequently okay

421
00:18:15,080 --> 00:18:19,550
what they're typically doing is writing

422
00:18:16,910 --> 00:18:22,130
the code in Java and then they compile

423
00:18:19,550 --> 00:18:24,710
it into an intermediary bytecode format

424
00:18:22,130 --> 00:18:27,530
called the dalvik executive or Dex file

425
00:18:24,710 --> 00:18:30,740
okay a Dalek executive is essentially a

426
00:18:27,530 --> 00:18:32,899
Java jar file and you can use it with

427
00:18:30,740 --> 00:18:35,960
the dalvik interpreter on an Android

428
00:18:32,900 --> 00:18:38,840
device whether it's Armour x86 or some

429
00:18:35,960 --> 00:18:41,420
other kind of processor type so this is

430
00:18:38,840 --> 00:18:44,209
very convenient for Android programmers

431
00:18:41,420 --> 00:18:46,310
one programming language Java I compile

432
00:18:44,210 --> 00:18:48,980
my app and it runs on all these Android

433
00:18:46,310 --> 00:18:51,050
devices that exist out there it's also

434
00:18:48,980 --> 00:18:53,840
very very convenient for us doing

435
00:18:51,050 --> 00:18:57,320
reverse engineering like a Java jar file

436
00:18:53,840 --> 00:18:59,870
Android X files are not compiled for

437
00:18:57,320 --> 00:19:01,730
native processors so there are reverse

438
00:18:59,870 --> 00:19:04,429
engineering tools that we can take this

439
00:19:01,730 --> 00:19:06,980
APK file or the dex file which is inside

440
00:19:04,430 --> 00:19:09,170
the APK file and then open it up in a

441
00:19:06,980 --> 00:19:10,970
reverse engineering tool and then get

442
00:19:09,170 --> 00:19:13,700
source code sometimes the source code

443
00:19:10,970 --> 00:19:15,560
isn't perfect but there's a great way

444
00:19:13,700 --> 00:19:17,570
for us to learn about these applications

445
00:19:15,560 --> 00:19:19,909
just very quickly by understanding some

446
00:19:17,570 --> 00:19:22,760
of these tools now historically the

447
00:19:19,910 --> 00:19:24,380
process is you take an android APK file

448
00:19:22,760 --> 00:19:26,690
that you download from the Google Play

449
00:19:24,380 --> 00:19:29,270
Store or apk monk or you get it from a

450
00:19:26,690 --> 00:19:31,340
rooted Android device you run Dex to jar

451
00:19:29,270 --> 00:19:35,480
on it it converts into a Java jar file

452
00:19:31,340 --> 00:19:37,429
and then you use a JD GUI to reverse

453
00:19:35,480 --> 00:19:39,800
engineer it and that's been the classic

454
00:19:37,430 --> 00:19:42,230
Android reverse engineering device I'm

455
00:19:39,800 --> 00:19:44,360
here to tell you to stop using JD GUI if

456
00:19:42,230 --> 00:19:47,390
you're using JD GUI just stopped

457
00:19:44,360 --> 00:19:50,209
Dexter jar does not do a really great

458
00:19:47,390 --> 00:19:52,340
job converting from apk to jar and JD

459
00:19:50,210 --> 00:19:55,130
GUI is not being maintained anymore a

460
00:19:52,340 --> 00:19:57,919
far far superior reverse engineering

461
00:19:55,130 --> 00:20:00,080
tool for Android is jad X jad X written

462
00:19:57,920 --> 00:20:02,630
by sky lot you don't even need extra

463
00:20:00,080 --> 00:20:06,439
jari more you just open up an APK file

464
00:20:02,630 --> 00:20:08,960
and now you have source code right so

465
00:20:06,440 --> 00:20:11,960
this is the decompiled Ghost Box app

466
00:20:08,960 --> 00:20:14,720
literally all I did was take this psb7

467
00:20:11,960 --> 00:20:17,000
app download it for my rooted device and

468
00:20:14,720 --> 00:20:19,040
then I opened it up injects and then I

469
00:20:17,000 --> 00:20:20,870
get source code that looks like this and

470
00:20:19,040 --> 00:20:22,850
on the Left you can navigate to the

471
00:20:20,870 --> 00:20:23,830
different Android packages and on the

472
00:20:22,850 --> 00:20:26,199
right there

473
00:20:23,830 --> 00:20:30,340
Java code now the Java code is not

474
00:20:26,200 --> 00:20:32,049
perfect but it is fairly readable and we

475
00:20:30,340 --> 00:20:33,879
can look at this to try to understand

476
00:20:32,049 --> 00:20:36,010
what's going on in the application so

477
00:20:33,880 --> 00:20:38,950
when I started looking at it I started

478
00:20:36,010 --> 00:20:43,240
seeing things like this media player dot

479
00:20:38,950 --> 00:20:46,450
create this r dot raw ghost now R in

480
00:20:43,240 --> 00:20:49,600
Android is a package which is a resource

481
00:20:46,450 --> 00:20:52,149
lookup so all of those mp3 files in the

482
00:20:49,600 --> 00:20:54,219
Joe's ghost box application all of that

483
00:20:52,149 --> 00:20:55,840
stuff those are all resources and R is a

484
00:20:54,220 --> 00:20:58,000
package name that's used to map

485
00:20:55,840 --> 00:20:58,990
resources that exist the file system -

486
00:20:58,000 --> 00:21:01,659
how I can reference them

487
00:20:58,990 --> 00:21:03,789
programmatically ok so r dot R odd

488
00:21:01,659 --> 00:21:06,880
that's the broad directory ghost and I

489
00:21:03,789 --> 00:21:08,320
thought well what is r dot R a ghost and

490
00:21:06,880 --> 00:21:11,649
what does it have to do with a media

491
00:21:08,320 --> 00:21:14,019
player right so again I went back to

492
00:21:11,649 --> 00:21:19,120
unzipping my files and I unzipped it and

493
00:21:14,019 --> 00:21:20,230
in the rod directory is a Ghost Dog okay

494
00:21:19,120 --> 00:21:24,809
and I was like oh

495
00:21:20,230 --> 00:21:24,809
Ghost Dog let's let's go stop OGG

496
00:21:34,140 --> 00:21:37,559
now I'll save you the extended

497
00:21:35,970 --> 00:21:41,400
experience because there's nothing else

498
00:21:37,559 --> 00:21:44,460
to hear it is literally a two minute of

499
00:21:41,400 --> 00:21:46,559
2 minute static OGG file like an mp3

500
00:21:44,460 --> 00:21:48,900
file different compression format that

501
00:21:46,559 --> 00:21:52,590
just looks over and over and over again

502
00:21:48,900 --> 00:21:57,929
and it's $15 that people are selling

503
00:21:52,590 --> 00:22:00,090
this for and yet it does just as well

504
00:21:57,929 --> 00:22:03,090
it's the $400 version you can get on

505
00:22:00,090 --> 00:22:05,370
Amazon so I'm going to call this one

506
00:22:03,090 --> 00:22:07,620
busted I'm going to say this is not

507
00:22:05,370 --> 00:22:10,590
actually detecting ghosts here I'm

508
00:22:07,620 --> 00:22:16,290
really not done with this application

509
00:22:10,590 --> 00:22:18,360
then I mentioned $15 the next app is the

510
00:22:16,290 --> 00:22:21,330
ghost speaker app and when I saw this

511
00:22:18,360 --> 00:22:23,760
app I was thrilled because it was my

512
00:22:21,330 --> 00:22:26,340
first opportunity not just to hear from

513
00:22:23,760 --> 00:22:28,799
the supernatural but to communicate with

514
00:22:26,340 --> 00:22:31,709
the supernatural and I could speak to

515
00:22:28,799 --> 00:22:36,900
the ghosts that are near me okay so in

516
00:22:31,710 --> 00:22:39,660
this application here you it's a $3 403

517
00:22:36,900 --> 00:22:41,760
ratings it is an EVP app so it does

518
00:22:39,660 --> 00:22:45,450
electronic voice phenomenon again claims

519
00:22:41,760 --> 00:22:48,629
to decode am/fm radio does frequency

520
00:22:45,450 --> 00:22:51,450
waves noise noise cancellation awesome

521
00:22:48,630 --> 00:22:54,929
okay but the thing that's so awesome is

522
00:22:51,450 --> 00:22:57,840
you type into this application and then

523
00:22:54,929 --> 00:22:59,460
it responds so you can ask a questions

524
00:22:57,840 --> 00:23:01,860
it will actually respond with different

525
00:22:59,460 --> 00:23:04,620
keywords and decode that from the

526
00:23:01,860 --> 00:23:06,479
electronic voice area Joe Joe gave it a

527
00:23:04,620 --> 00:23:10,139
five star rating got names that a

528
00:23:06,480 --> 00:23:11,790
cemetery George for one turned around

529
00:23:10,140 --> 00:23:14,730
was standing in front of a George's

530
00:23:11,790 --> 00:23:18,450
headstone this app is real and can

531
00:23:14,730 --> 00:23:20,130
manipulate it by spirit okay so so I was

532
00:23:18,450 --> 00:23:22,880
thrilled about this so I was really

533
00:23:20,130 --> 00:23:26,429
excited to see what's going on here okay

534
00:23:22,880 --> 00:23:27,780
so with this application the values are

535
00:23:26,429 --> 00:23:29,910
processed through what they call the

536
00:23:27,780 --> 00:23:31,590
speech translation software you actually

537
00:23:29,910 --> 00:23:35,480
type in little questions here on the

538
00:23:31,590 --> 00:23:37,530
bottom it calculates the energy of

539
00:23:35,480 --> 00:23:39,720
paranormal entities that might be

540
00:23:37,530 --> 00:23:41,700
projecting in the area so I've started

541
00:23:39,720 --> 00:23:45,780
talking with ghosts and I set out you

542
00:23:41,700 --> 00:23:47,100
know hello its me I was wondering if

543
00:23:45,780 --> 00:23:50,850
after all these gee

544
00:23:47,100 --> 00:23:53,309
is you'd like to meet okay to go over

545
00:23:50,850 --> 00:23:55,918
everything they say that times supposed

546
00:23:53,309 --> 00:23:59,850
to heal ya okay and then it responded

547
00:23:55,919 --> 00:24:02,100
loud and I was like oh okay

548
00:23:59,850 --> 00:24:07,469
but I ain't done much healing periwinkle

549
00:24:02,100 --> 00:24:10,199
oil hello from the other side okay so

550
00:24:07,470 --> 00:24:12,510
it's gonna Dell song all right so it

551
00:24:10,200 --> 00:24:14,400
responds well to Adele okay so I thought

552
00:24:12,510 --> 00:24:15,330
alright well what's going on with this

553
00:24:14,400 --> 00:24:18,150
application

554
00:24:15,330 --> 00:24:21,000
I don't normally sing that when I do

555
00:24:18,150 --> 00:24:22,919
this talk okay so when I open this

556
00:24:21,000 --> 00:24:25,049
application again I'm going back to jad

557
00:24:22,919 --> 00:24:27,870
X and I'm doing application source code

558
00:24:25,049 --> 00:24:29,610
reverse engineering here I opened up the

559
00:24:27,870 --> 00:24:32,459
apk file in Jagex

560
00:24:29,610 --> 00:24:34,799
and I was a little disappointed normally

561
00:24:32,460 --> 00:24:36,330
when you get an Android application and

562
00:24:34,799 --> 00:24:38,429
you open it a reverse engineering tool

563
00:24:36,330 --> 00:24:40,260
you will get a lot of contextual

564
00:24:38,429 --> 00:24:42,780
information that helps you reverse

565
00:24:40,260 --> 00:24:44,760
engineer the data essentially the

566
00:24:42,780 --> 00:24:46,770
variable names the package names the

567
00:24:44,760 --> 00:24:49,530
class names the method names that the

568
00:24:46,770 --> 00:24:52,260
programmer chose are embedded inside the

569
00:24:49,530 --> 00:24:54,570
application itself so that is very

570
00:24:52,260 --> 00:24:58,679
useful to me because now there's a

571
00:24:54,570 --> 00:25:00,418
variable called Arad ghost and that is

572
00:24:58,679 --> 00:25:03,210
the file that existed on the file system

573
00:25:00,419 --> 00:25:04,799
for the psb7 application but for this

574
00:25:03,210 --> 00:25:07,260
application it was a little different

575
00:25:04,799 --> 00:25:12,658
when I open the application I saw all of

576
00:25:07,260 --> 00:25:16,169
the stuff on the left a a a a b b c d e

577
00:25:12,659 --> 00:25:20,730
f g and then if you go into the G class

578
00:25:16,169 --> 00:25:23,760
there's something called abcdefgh IgA

579
00:25:20,730 --> 00:25:26,370
and then even inside of this code all

580
00:25:23,760 --> 00:25:29,340
the variables have names that are

581
00:25:26,370 --> 00:25:31,979
sensible anymore now some of the code is

582
00:25:29,340 --> 00:25:36,899
preserved the actual method names like

583
00:25:31,980 --> 00:25:39,360
set adapter add is directory those

584
00:25:36,900 --> 00:25:41,340
actual API names cannot be removed

585
00:25:39,360 --> 00:25:42,600
because they have to be present for the

586
00:25:41,340 --> 00:25:44,459
code to know what to do

587
00:25:42,600 --> 00:25:47,158
but anything that can be uniquely

588
00:25:44,460 --> 00:25:50,190
selected by a programmer variable names

589
00:25:47,159 --> 00:25:53,250
method names class names package names

590
00:25:50,190 --> 00:25:55,320
those are all obfuscated when the

591
00:25:53,250 --> 00:25:57,540
developer wrote this application before

592
00:25:55,320 --> 00:25:59,970
he distributed it he turned on what's

593
00:25:57,540 --> 00:26:01,830
called an Android obfuscation tool

594
00:25:59,970 --> 00:26:03,990
the Android up the skater allows the

595
00:26:01,830 --> 00:26:06,030
programmer to still look at the source

596
00:26:03,990 --> 00:26:08,910
code and see all the original variable

597
00:26:06,030 --> 00:26:11,070
names but when it compiles the app all

598
00:26:08,910 --> 00:26:13,200
those original names go away

599
00:26:11,070 --> 00:26:14,669
and this is designed to thwart reverse

600
00:26:13,200 --> 00:26:16,290
engineering it's one of the things that

601
00:26:14,670 --> 00:26:18,090
we would recommend for our customers

602
00:26:16,290 --> 00:26:19,950
when we're doing an app assessment if

603
00:26:18,090 --> 00:26:22,470
you're doing Android apps and you're not

604
00:26:19,950 --> 00:26:24,000
doing occupation you should because it

605
00:26:22,470 --> 00:26:27,480
makes it much harder to reverse engineer

606
00:26:24,000 --> 00:26:29,730
the code so here I have a whole bunch of

607
00:26:27,480 --> 00:26:32,670
code this app was probably 15,000 lines

608
00:26:29,730 --> 00:26:34,500
of Java okay but it's all obvious catted

609
00:26:32,670 --> 00:26:37,560
so now it's difficult for me to try to

610
00:26:34,500 --> 00:26:39,900
understand what's actually going on so I

611
00:26:37,560 --> 00:26:41,760
needed to figure out a way where I could

612
00:26:39,900 --> 00:26:44,280
understand what's happening in this app

613
00:26:41,760 --> 00:26:48,450
to find that out is it really detecting

614
00:26:44,280 --> 00:26:51,450
ghosts okay so one of the great features

615
00:26:48,450 --> 00:26:53,340
of jad X is not just the GUI tool that

616
00:26:51,450 --> 00:26:55,320
we can use that gives us the interactive

617
00:26:53,340 --> 00:26:57,810
view to look at the source code but also

618
00:26:55,320 --> 00:26:59,909
a command line tool where you can create

619
00:26:57,810 --> 00:27:02,490
a directory here I create a directory

620
00:26:59,910 --> 00:27:05,700
called ghost speaker and then I ran jad

621
00:27:02,490 --> 00:27:07,920
XD ghost speaker and then the apk file

622
00:27:05,700 --> 00:27:09,660
and what that does is instead of just

623
00:27:07,920 --> 00:27:12,540
showing me the decompiled code in the

624
00:27:09,660 --> 00:27:15,030
GUI it takes all the code D compiles all

625
00:27:12,540 --> 00:27:17,340
of it and then save it in the directory

626
00:27:15,030 --> 00:27:19,320
tree that I've specified now this is

627
00:27:17,340 --> 00:27:22,379
super helpful if you're searching for

628
00:27:19,320 --> 00:27:24,570
strings you d compile it grep - r and

629
00:27:22,380 --> 00:27:27,470
then a string or select string and

630
00:27:24,570 --> 00:27:29,639
powershell or fine string from cmd.exe

631
00:27:27,470 --> 00:27:32,490
whatever tool you like to use now you

632
00:27:29,640 --> 00:27:34,800
can search all of that content for a URL

633
00:27:32,490 --> 00:27:37,320
for any string reference that might be

634
00:27:34,800 --> 00:27:39,930
interesting things like that but I found

635
00:27:37,320 --> 00:27:42,120
an even better way to use this you can

636
00:27:39,930 --> 00:27:45,420
actually take that decompiled code and

637
00:27:42,120 --> 00:27:47,010
import it right into Android studio now

638
00:27:45,420 --> 00:27:49,650
Android studio is not a hacking tool

639
00:27:47,010 --> 00:27:51,600
Android studio is the iv'e that Google

640
00:27:49,650 --> 00:27:54,420
makes available for programmers to write

641
00:27:51,600 --> 00:27:55,980
Android apps you would download Android

642
00:27:54,420 --> 00:27:57,570
studio installed on your system and

643
00:27:55,980 --> 00:28:00,090
start pounding out your code in Java

644
00:27:57,570 --> 00:28:02,460
right from Android studio but when we

645
00:28:00,090 --> 00:28:04,320
reverse engineer it we can actually take

646
00:28:02,460 --> 00:28:07,110
the code and bring it right back into

647
00:28:04,320 --> 00:28:10,169
Android studio from reverse engineering

648
00:28:07,110 --> 00:28:13,110
content now it's not perfect you can't

649
00:28:10,170 --> 00:28:13,860
import into Android studio say compile

650
00:28:13,110 --> 00:28:15,510
and then you get

651
00:28:13,860 --> 00:28:17,610
the exact same application that will

652
00:28:15,510 --> 00:28:20,400
never happen the decompilers are not

653
00:28:17,610 --> 00:28:22,020
that good but it's good enough where

654
00:28:20,400 --> 00:28:24,360
we'll import right into Android studio

655
00:28:22,020 --> 00:28:27,480
and allow me to now start editing

656
00:28:24,360 --> 00:28:29,540
annotating renaming and refactoring

657
00:28:27,480 --> 00:28:34,260
what's going on inside the application

658
00:28:29,540 --> 00:28:36,149
right so here's Android studio where

659
00:28:34,260 --> 00:28:38,010
I've now imported the application in

660
00:28:36,150 --> 00:28:40,440
literally an Android studio it's file

661
00:28:38,010 --> 00:28:42,720
import project and then I just hit next

662
00:28:40,440 --> 00:28:44,220
next next next next next finish there

663
00:28:42,720 --> 00:28:46,140
might be one more next in there I'm

664
00:28:44,220 --> 00:28:48,150
never sure if it's five or six but

665
00:28:46,140 --> 00:28:50,820
literally that's all I do and now it's

666
00:28:48,150 --> 00:28:54,929
in Android studio okay now the great

667
00:28:50,820 --> 00:28:56,820
thing here is that we get syntax color

668
00:28:54,929 --> 00:28:58,919
highlighting which is a little better

669
00:28:56,820 --> 00:29:00,960
than what you get in jad X but we can

670
00:28:58,919 --> 00:29:03,660
edit this code we can add our own

671
00:29:00,960 --> 00:29:05,490
comments we can rename things and we

672
00:29:03,660 --> 00:29:08,970
could start analyzing the application

673
00:29:05,490 --> 00:29:10,740
now the code is still obfuscated so it

674
00:29:08,970 --> 00:29:11,580
doesn't make a lot of sense yet but I'm

675
00:29:10,740 --> 00:29:13,350
going to give you several

676
00:29:11,580 --> 00:29:16,139
recommendations now to turn the

677
00:29:13,350 --> 00:29:18,719
nonsensical into sensible okay my

678
00:29:16,140 --> 00:29:20,760
recommendation is to start small the

679
00:29:18,720 --> 00:29:22,049
people that I talk to that say I tried

680
00:29:20,760 --> 00:29:24,120
reverse engineering and I could make

681
00:29:22,049 --> 00:29:25,350
heads or tail of it because you go and

682
00:29:24,120 --> 00:29:27,719
you try to understand the big picture

683
00:29:25,350 --> 00:29:30,000
too quickly when you're doing reverse

684
00:29:27,720 --> 00:29:33,600
engineering your goal is to understand

685
00:29:30,000 --> 00:29:35,669
small pieces a lot okay and then as you

686
00:29:33,600 --> 00:29:38,100
understand more and more small pieces as

687
00:29:35,669 --> 00:29:40,919
you had comments that explains to

688
00:29:38,100 --> 00:29:43,020
yourself what this actually does and you

689
00:29:40,919 --> 00:29:44,790
start renaming things and now it starts

690
00:29:43,020 --> 00:29:47,429
to make sense that's what we reverse

691
00:29:44,790 --> 00:29:49,889
engineering analysts do nobody opens up

692
00:29:47,429 --> 00:29:51,360
a you know hex dump and says blonde

693
00:29:49,890 --> 00:29:54,030
brunette nobody does that

694
00:29:51,360 --> 00:29:55,860
it's all understanding little pieces and

695
00:29:54,030 --> 00:29:59,480
then putting together all the little

696
00:29:55,860 --> 00:30:03,090
pieces to form a really big picture so

697
00:29:59,480 --> 00:30:05,309
what I did here was I started looking at

698
00:30:03,090 --> 00:30:07,110
these different variables so for example

699
00:30:05,309 --> 00:30:11,070
because it's obfuscated you'll see

700
00:30:07,110 --> 00:30:13,860
variables like this dot as AF I mean

701
00:30:11,070 --> 00:30:18,090
this afk that's something else Kay this

702
00:30:13,860 --> 00:30:21,689
dot AF equal secure dot get string get

703
00:30:18,090 --> 00:30:23,730
content resolver Android ID okay now

704
00:30:21,690 --> 00:30:27,090
what does get content resolver actually

705
00:30:23,730 --> 00:30:30,840
do I have no idea but

706
00:30:27,090 --> 00:30:33,570
who knows Google but but more to the

707
00:30:30,840 --> 00:30:34,620
point stackoverflow no okay there is a

708
00:30:33,570 --> 00:30:37,169
reference out there

709
00:30:34,620 --> 00:30:40,260
developer.android.com knows what that is

710
00:30:37,170 --> 00:30:41,910
okay so it returns a context for the

711
00:30:40,260 --> 00:30:44,010
activity which is the screen that you're

712
00:30:41,910 --> 00:30:46,560
using in basically it's a way to refer

713
00:30:44,010 --> 00:30:48,690
to yourself in an open application okay

714
00:30:46,560 --> 00:30:52,320
and it's returning a constant string

715
00:30:48,690 --> 00:30:54,090
called Android ID so what do you think

716
00:30:52,320 --> 00:30:56,129
if the programmer we're choosing that

717
00:30:54,090 --> 00:31:00,810
variable he would have called it not

718
00:30:56,130 --> 00:31:02,880
this dot AF but what probably Android ID

719
00:31:00,810 --> 00:31:05,070
that would make more sense and I can

720
00:31:02,880 --> 00:31:09,030
rename that variable now don't just type

721
00:31:05,070 --> 00:31:12,870
over this AF highlight it right click

722
00:31:09,030 --> 00:31:15,750
and go to refactor rename then enter the

723
00:31:12,870 --> 00:31:17,939
new name string Android ID because I

724
00:31:15,750 --> 00:31:19,950
know it's a type string and now I think

725
00:31:17,940 --> 00:31:22,350
it's something related to Android ID

726
00:31:19,950 --> 00:31:24,840
why do you refactor insider' typing in

727
00:31:22,350 --> 00:31:27,090
the new name because Android studio will

728
00:31:24,840 --> 00:31:29,639
rename every other reference net

729
00:31:27,090 --> 00:31:31,560
variable at the same time instead of you

730
00:31:29,640 --> 00:31:33,660
just typing over one and then seeing

731
00:31:31,560 --> 00:31:36,240
this dot AF later and not even knowing

732
00:31:33,660 --> 00:31:38,460
if it's the same variable allow Android

733
00:31:36,240 --> 00:31:42,240
studio to do that work for you right

734
00:31:38,460 --> 00:31:45,690
click refactor rename this AF becomes

735
00:31:42,240 --> 00:31:47,610
this string Android ID okay now it

736
00:31:45,690 --> 00:31:49,110
doesn't seem like much it's just a

737
00:31:47,610 --> 00:31:51,929
little improvement in the source code

738
00:31:49,110 --> 00:31:54,600
but when you do that a thousand times it

739
00:31:51,930 --> 00:31:56,990
becomes much more legible okay so

740
00:31:54,600 --> 00:32:00,659
strings are always valuable to rename

741
00:31:56,990 --> 00:32:03,660
hey also logging messages are super

742
00:32:00,660 --> 00:32:05,610
valuable logging messages in code will

743
00:32:03,660 --> 00:32:08,040
often give you a hint as to what's going

744
00:32:05,610 --> 00:32:11,510
on look at this code this is private int

745
00:32:08,040 --> 00:32:13,770
B okay I don't know what it does and I

746
00:32:11,510 --> 00:32:18,570
have no idea what that is

747
00:32:13,770 --> 00:32:21,600
okay preferences put int L counts okay

748
00:32:18,570 --> 00:32:23,610
and it commits catch throwable and here

749
00:32:21,600 --> 00:32:26,399
it is lada II which means give me an

750
00:32:23,610 --> 00:32:30,750
error log with the string ghost speaker

751
00:32:26,400 --> 00:32:32,430
update bad license count okay now I

752
00:32:30,750 --> 00:32:34,890
don't know what this method really does

753
00:32:32,430 --> 00:32:38,160
but by looking at the contextual string

754
00:32:34,890 --> 00:32:40,350
detail now I can rename that so instead

755
00:32:38,160 --> 00:32:43,080
of int B now it's in

756
00:32:40,350 --> 00:32:45,719
set bad license count again highlight

757
00:32:43,080 --> 00:32:47,820
right-click refactor rename why are we

758
00:32:45,720 --> 00:32:49,830
doing that because every other place in

759
00:32:47,820 --> 00:32:51,000
the code that calls this method will now

760
00:32:49,830 --> 00:32:53,639
have the new name

761
00:32:51,000 --> 00:32:55,710
now the other methods I look at that

762
00:32:53,640 --> 00:32:57,090
have this name suddenly make a lot more

763
00:32:55,710 --> 00:32:58,679
sense because it's dealing with

764
00:32:57,090 --> 00:33:02,820
something relating to license management

765
00:32:58,679 --> 00:33:04,500
and license handling okay so you keep

766
00:33:02,820 --> 00:33:07,230
doing this process you keep going

767
00:33:04,500 --> 00:33:08,880
through okay now in Android we have a

768
00:33:07,230 --> 00:33:11,100
lot of what we call complex Android

769
00:33:08,880 --> 00:33:13,260
types there's simple types string and

770
00:33:11,100 --> 00:33:16,730
float things like that but there's also

771
00:33:13,260 --> 00:33:21,539
complex types things like a

772
00:33:16,730 --> 00:33:23,520
text-to-speech P image button Q okay now

773
00:33:21,539 --> 00:33:25,559
if you saw the variable P later you

774
00:33:23,520 --> 00:33:27,929
would have no idea what it means I don't

775
00:33:25,559 --> 00:33:30,658
know what it's used for but I can give

776
00:33:27,929 --> 00:33:32,880
it a much better name than P or Q so

777
00:33:30,659 --> 00:33:34,770
here I'll rename them just based off of

778
00:33:32,880 --> 00:33:37,100
the complex object types that they are

779
00:33:34,770 --> 00:33:41,490
so instead of P and Q it becomes

780
00:33:37,100 --> 00:33:43,860
text-to-speech or image body and now

781
00:33:41,490 --> 00:33:46,500
again because I'm refactoring it I'm

782
00:33:43,860 --> 00:33:48,899
adding little contextual details just by

783
00:33:46,500 --> 00:33:50,730
making little tiny changes and now the

784
00:33:48,900 --> 00:33:53,610
whole code is starting to come together

785
00:33:50,730 --> 00:33:56,820
okay I saw this weird array that looked

786
00:33:53,610 --> 00:33:58,439
like this new byte array 20 ok and I

787
00:33:56,820 --> 00:34:00,750
looked at it and I went that's weird

788
00:33:58,440 --> 00:34:02,610
there's only 8 to there's only 19

789
00:34:00,750 --> 00:34:05,250
variables here ok

790
00:34:02,610 --> 00:34:07,168
byte array 17 is missing out of this

791
00:34:05,250 --> 00:34:09,810
array of course you start at 0 goes to

792
00:34:07,169 --> 00:34:13,200
19 but 17 is missing I didn't know what

793
00:34:09,810 --> 00:34:16,649
it was so I renamed it weird 20 byte

794
00:34:13,199 --> 00:34:20,069
array missing by 17 I have no idea what

795
00:34:16,649 --> 00:34:22,500
it does but by doing that later I saw

796
00:34:20,070 --> 00:34:25,619
that reference and I saw other context

797
00:34:22,500 --> 00:34:28,619
and I went oh that's a sha-1 hash it

798
00:34:25,619 --> 00:34:31,500
just happened to have byte 17 as zero so

799
00:34:28,619 --> 00:34:33,300
it was omitted because it was compiled

800
00:34:31,500 --> 00:34:35,668
out because the optimizer said you don't

801
00:34:33,300 --> 00:34:37,409
need to set it it's already zero now

802
00:34:35,668 --> 00:34:39,540
stuff is starting to come together and

803
00:34:37,409 --> 00:34:40,859
now I see all these different fields and

804
00:34:39,540 --> 00:34:45,659
they make sense as we're going through

805
00:34:40,859 --> 00:34:48,509
it ok so I probably spent I don't know

806
00:34:45,659 --> 00:34:50,760
six hours doing that and I probably did

807
00:34:48,510 --> 00:34:52,169
it a lot more than I needed to but I got

808
00:34:50,760 --> 00:34:52,850
super excited about it

809
00:34:52,168 --> 00:34:54,589
because

810
00:34:52,850 --> 00:34:56,360
as I kept doing it and adding more

811
00:34:54,590 --> 00:34:58,730
pieces and every little change that you

812
00:34:56,360 --> 00:35:01,430
make now the other stuff starts making

813
00:34:58,730 --> 00:35:03,590
sense to me and now this August gated

814
00:35:01,430 --> 00:35:06,140
application is no longer obfuscated now

815
00:35:03,590 --> 00:35:08,450
it's sensible and I can read it like any

816
00:35:06,140 --> 00:35:12,350
other Java code and then our sadducees

817
00:35:08,450 --> 00:35:14,569
code that looks like this okay and so I

818
00:35:12,350 --> 00:35:16,700
don't know what this why was I never

819
00:35:14,570 --> 00:35:19,310
really looked at it but mag filled

820
00:35:16,700 --> 00:35:22,009
reading equals float math dot square

821
00:35:19,310 --> 00:35:24,799
root sensor data two times sensor data

822
00:35:22,010 --> 00:35:27,500
two plus sensor data one and you know

823
00:35:24,800 --> 00:35:29,240
what is L dot n ldlr

824
00:35:27,500 --> 00:35:32,810
well it turns out that it's type

825
00:35:29,240 --> 00:35:36,379
magnetic field type orientation and type

826
00:35:32,810 --> 00:35:37,850
azimuth okay so looking at this code we

827
00:35:36,380 --> 00:35:41,360
see things that look like this

828
00:35:37,850 --> 00:35:44,210
this ghost speaker dot a equals mass

829
00:35:41,360 --> 00:35:46,580
square root double of whatever sensor

830
00:35:44,210 --> 00:35:49,190
data to is time sensor data to and

831
00:35:46,580 --> 00:35:51,170
sensor data to is pitch which is I'm

832
00:35:49,190 --> 00:35:54,530
sorry's roll which is at rotation around

833
00:35:51,170 --> 00:35:58,010
the y axis plus sensor data 0 which is

834
00:35:54,530 --> 00:36:01,070
azimuth plus sensor data 1 which is the

835
00:35:58,010 --> 00:36:03,650
pitch all it's doing is it's getting the

836
00:36:01,070 --> 00:36:05,450
GPS coordinates from the phone and

837
00:36:03,650 --> 00:36:07,820
that's what it's using to make that

838
00:36:05,450 --> 00:36:10,189
little graph that says how far away the

839
00:36:07,820 --> 00:36:12,410
ghost is so as you're walking around in

840
00:36:10,190 --> 00:36:14,810
doing this you're changing the pitch the

841
00:36:12,410 --> 00:36:16,850
X the Y the azimuth and it's taking

842
00:36:14,810 --> 00:36:19,070
those values it's just multiplying them

843
00:36:16,850 --> 00:36:21,860
into some big number and that's how it's

844
00:36:19,070 --> 00:36:23,680
saying how far away the ghost is ok so I

845
00:36:21,860 --> 00:36:27,080
started seeing close it looks like this

846
00:36:23,680 --> 00:36:28,910
speak dictionary word handler integer I

847
00:36:27,080 --> 00:36:31,460
okay and I was like alright what's that

848
00:36:28,910 --> 00:36:33,529
about okay it looks like it has

849
00:36:31,460 --> 00:36:36,050
something called array of dictionary

850
00:36:33,530 --> 00:36:38,000
words ok get size keep adding array of

851
00:36:36,050 --> 00:36:40,130
dictionary words and then it uses

852
00:36:38,000 --> 00:36:41,930
something called text-to-speech cue add

853
00:36:40,130 --> 00:36:43,700
Android apps have a text-to-speech

854
00:36:41,930 --> 00:36:44,779
feature where can actually speak words

855
00:36:43,700 --> 00:36:47,149
to you ok

856
00:36:44,780 --> 00:36:50,420
and then I started seeing things like

857
00:36:47,150 --> 00:36:53,090
this ok this dot array of dictionary

858
00:36:50,420 --> 00:36:56,990
words add a dictionary word but more

859
00:36:53,090 --> 00:36:59,270
importantly up here open dictionary okay

860
00:36:56,990 --> 00:37:02,120
from get assets and I went all right

861
00:36:59,270 --> 00:37:05,780
this is not cool okay what is this up

862
00:37:02,120 --> 00:37:07,580
doing it is a file called dictionary it

863
00:37:05,780 --> 00:37:09,800
randomly picks a word from that

864
00:37:07,580 --> 00:37:12,680
dictionary and then speaks it to you

865
00:37:09,800 --> 00:37:14,690
using text-to-speech software so this

866
00:37:12,680 --> 00:37:17,149
was definitely busted all over the place

867
00:37:14,690 --> 00:37:18,620
and they try to hide for me but there

868
00:37:17,150 --> 00:37:23,470
was a lot of interesting stuff that I

869
00:37:18,620 --> 00:37:23,470
learned about this let me see

870
00:37:25,630 --> 00:37:30,620
so I grabbed the dictionary file here

871
00:37:28,790 --> 00:37:34,100
and it had a bunch of word that look

872
00:37:30,620 --> 00:37:42,350
like this scream headstone sit oh that's

873
00:37:34,100 --> 00:37:47,110
not what I wanted oh it L yeah that's a

874
00:37:42,350 --> 00:37:47,110
I do love that image

875
00:37:51,319 --> 00:37:58,670
that's better okay all right so it has

876
00:37:54,150 --> 00:38:00,780
all these words in there Hong Kong fixed

877
00:37:58,670 --> 00:38:03,000
semies which I think it's an

878
00:38:00,780 --> 00:38:06,329
anti-semitic word I'm not really sure

879
00:38:03,000 --> 00:38:07,829
okay IIIi don't really know I didn't

880
00:38:06,329 --> 00:38:10,079
mean that as a joke I mean it's probably

881
00:38:07,829 --> 00:38:12,000
like that because sometimes ghosts or

882
00:38:10,079 --> 00:38:15,059
angry I mean I don't know but you know

883
00:38:12,000 --> 00:38:24,990
nothing okay Danielle Tourmaline cabin

884
00:38:15,059 --> 00:38:27,660
Jacob okay so um sorry totally yeah

885
00:38:24,990 --> 00:38:30,598
George is totally in there yeah George

886
00:38:27,660 --> 00:38:33,149
is in there so I'm just to have a little

887
00:38:30,599 --> 00:38:35,670
fun with this I wrote an app okay a

888
00:38:33,150 --> 00:38:38,400
little Python script and it uses the

889
00:38:35,670 --> 00:38:40,230
stay command which will speak any text

890
00:38:38,400 --> 00:38:42,000
from the command line and it uses the

891
00:38:40,230 --> 00:38:43,920
scary voices that come with the say

892
00:38:42,000 --> 00:38:46,349
command and what it does is it picks

893
00:38:43,920 --> 00:38:50,309
four words and it just says them right

894
00:38:46,349 --> 00:38:56,520
in a row okay and so you know just like

895
00:38:50,309 --> 00:39:03,960
this thrust master blue smoke right so

896
00:38:56,520 --> 00:39:04,680
you like you know oh you know it's just

897
00:39:03,960 --> 00:39:09,260
like uh-uh

898
00:39:04,680 --> 00:39:12,690
no I just I just do this all day so what

899
00:39:09,260 --> 00:39:17,430
Lamberty where is he no no he's gone

900
00:39:12,690 --> 00:39:20,069
okay all right leverage is not here all

901
00:39:17,430 --> 00:39:21,509
right so yeah that's all that's all this

902
00:39:20,069 --> 00:39:24,270
is there's a little script to say those

903
00:39:21,510 --> 00:39:27,510
words okay now the last step I analyzed

904
00:39:24,270 --> 00:39:29,579
is what is an online Ouija board

905
00:39:27,510 --> 00:39:31,920
application though we Jap Lakai ssin

906
00:39:29,579 --> 00:39:34,980
this is published by red work board it

907
00:39:31,920 --> 00:39:36,990
was $3 84 cents converse with ghosts and

908
00:39:34,980 --> 00:39:37,829
spirits right from your phone how

909
00:39:36,990 --> 00:39:42,450
convenient

910
00:39:37,829 --> 00:39:45,540
okay MOOC test says connected with the

911
00:39:42,450 --> 00:39:48,359
spirit named P naturally this app should

912
00:39:45,540 --> 00:39:50,910
be strictly prohibited to cold-hearted

913
00:39:48,359 --> 00:39:52,410
users that sentence doesn't really grok

914
00:39:50,910 --> 00:39:54,750
for me but I'm just going to let that go

915
00:39:52,410 --> 00:39:59,129
I couldn't sleep last night and I feel

916
00:39:54,750 --> 00:40:02,309
like I am possessed now okay bye yeah so

917
00:39:59,130 --> 00:40:04,190
I want that okay so this era is actually

918
00:40:02,309 --> 00:40:07,849
using a little Ouija board okay

919
00:40:04,190 --> 00:40:10,430
so you actually type into the little

920
00:40:07,849 --> 00:40:13,130
with a little keyboard okay what have

921
00:40:10,430 --> 00:40:15,379
you done and then the pancetta bear kind

922
00:40:13,130 --> 00:40:17,420
of animates and then it says that's for

923
00:40:15,380 --> 00:40:20,030
me to know and for you to find out okay

924
00:40:17,420 --> 00:40:22,789
and I love like the app authors now this

925
00:40:20,030 --> 00:40:24,950
was again not a pretend app this is not

926
00:40:22,789 --> 00:40:28,640
a game this is professional ghost

927
00:40:24,950 --> 00:40:30,500
detection tools for which they say no

928
00:40:28,640 --> 00:40:32,210
spirits were hurt during the involved

929
00:40:30,500 --> 00:40:34,099
development of this project okay

930
00:40:32,210 --> 00:40:35,680
well that's nice okay though it smells

931
00:40:34,099 --> 00:40:37,910
good I'm glad about that

932
00:40:35,680 --> 00:40:40,339
now here's the thing when you start this

933
00:40:37,910 --> 00:40:44,000
application you get this big splash page

934
00:40:40,339 --> 00:40:45,589
unity okay now a lot of developers that

935
00:40:44,000 --> 00:40:48,020
are working for mobile applications

936
00:40:45,589 --> 00:40:50,240
don't want to make an Android app in iOS

937
00:40:48,020 --> 00:40:52,849
app so they go to one of the third-party

938
00:40:50,240 --> 00:40:55,868
app development platforms unity is a big

939
00:40:52,849 --> 00:40:59,119
one PhoneGap is another one xamarin is

940
00:40:55,869 --> 00:41:00,799
Adobe's product okay and they have third

941
00:40:59,119 --> 00:41:03,260
party platforms where you write the app

942
00:41:00,799 --> 00:41:05,990
in the third-party language and then you

943
00:41:03,260 --> 00:41:07,940
say build Android build iOS and you

944
00:41:05,990 --> 00:41:09,140
maintain one app but it spits out the

945
00:41:07,940 --> 00:41:11,809
application for all these different

946
00:41:09,140 --> 00:41:13,490
platforms and unity is one platform we

947
00:41:11,809 --> 00:41:15,859
see lots and lots of mobile games a

948
00:41:13,490 --> 00:41:18,348
developer can choose to write in blue or

949
00:41:15,859 --> 00:41:20,779
c-sharp or JavaScript and they produce

950
00:41:18,349 --> 00:41:25,039
an app that will then run on iOS or

951
00:41:20,779 --> 00:41:27,319
Android right so again this is an APK

952
00:41:25,039 --> 00:41:29,569
file so I just unzipped it and I saw a

953
00:41:27,319 --> 00:41:30,859
bunch of files Android manifest XML

954
00:41:29,569 --> 00:41:32,150
which is where you see permission

955
00:41:30,859 --> 00:41:33,920
declarations things like that

956
00:41:32,150 --> 00:41:36,319
classes.dex

957
00:41:33,920 --> 00:41:38,390
this is the Android executive all but

958
00:41:36,319 --> 00:41:40,579
it's just a stub all it does is launch

959
00:41:38,390 --> 00:41:43,220
the unity runtime engine and then start

960
00:41:40,579 --> 00:41:44,990
to run the unity application the really

961
00:41:43,220 --> 00:41:48,140
interesting stuff was in assets been

962
00:41:44,990 --> 00:41:51,379
data that's in like shaders and textures

963
00:41:48,140 --> 00:41:54,470
and other graphics used for unity

964
00:41:51,380 --> 00:41:59,000
applications and also assets bin data

965
00:41:54,470 --> 00:42:00,078
manage assembly star DLL yes it's time

966
00:41:59,000 --> 00:42:02,359
of the apocalypse

967
00:42:00,079 --> 00:42:04,460
we're running dll's on Android devices

968
00:42:02,359 --> 00:42:08,089
now okay the world's coming to an end

969
00:42:04,460 --> 00:42:09,950
okay so these dll's are installed with

970
00:42:08,089 --> 00:42:12,529
this application but they're just

971
00:42:09,950 --> 00:42:14,598
interpreted by the unity engine okay now

972
00:42:12,529 --> 00:42:17,270
here's the good thing you're the apps

973
00:42:14,599 --> 00:42:17,960
are not compiled again if you're going

974
00:42:17,270 --> 00:42:20,270
to run on

975
00:42:17,960 --> 00:42:22,070
you have to support x86 and MIPS an arm

976
00:42:20,270 --> 00:42:23,630
and all these other processor types so

977
00:42:22,070 --> 00:42:25,790
you can't distribute them as compiled

978
00:42:23,630 --> 00:42:31,220
code your the apps are what's called a

979
00:42:25,790 --> 00:42:33,200
CIL file a common intermediate language

980
00:42:31,220 --> 00:42:35,629
format I couldn't ever the acronym okay

981
00:42:33,200 --> 00:42:38,060
a common intermediate language format

982
00:42:35,630 --> 00:42:42,740
which is just like a Java jar file but

983
00:42:38,060 --> 00:42:45,259
different okay so fortunately this wee

984
00:42:42,740 --> 00:42:48,259
chap was written in C sharp so you can

985
00:42:45,260 --> 00:42:50,750
take a C sharp D compilation tool which

986
00:42:48,260 --> 00:42:53,030
is also CIL based an intermediate

987
00:42:50,750 --> 00:42:55,490
bytecode format like jar files or Dex

988
00:42:53,030 --> 00:42:57,349
files and the one I used is JetBrains

989
00:42:55,490 --> 00:43:00,200
dot peak and there's many others as well

990
00:42:57,349 --> 00:43:02,510
you open up the file and now you have

991
00:43:00,200 --> 00:43:03,200
your source code now I'm not a c-sharp

992
00:43:02,510 --> 00:43:04,940
programmer

993
00:43:03,200 --> 00:43:06,589
I don't really know c-sharp I wrote a

994
00:43:04,940 --> 00:43:08,599
c-sharp app a long time ago and I don't

995
00:43:06,589 --> 00:43:10,460
really remember any of it but again it's

996
00:43:08,599 --> 00:43:12,650
just Google once you understand the

997
00:43:10,460 --> 00:43:15,890
fundamentals of programming loops

998
00:43:12,650 --> 00:43:18,890
variables methods parameters overloads

999
00:43:15,890 --> 00:43:21,049
classes packages it's all the same no

1000
00:43:18,890 --> 00:43:22,790
matter what language except Objective C

1001
00:43:21,050 --> 00:43:25,730
Objective C is where everything goes

1002
00:43:22,790 --> 00:43:28,220
crazy okay now if you know Objective C

1003
00:43:25,730 --> 00:43:30,440
I'm sorry because your life is worse for

1004
00:43:28,220 --> 00:43:32,930
it okay it's just like you know it's

1005
00:43:30,440 --> 00:43:37,250
just not a good time but everything else

1006
00:43:32,930 --> 00:43:39,290
is pretty sensible okay so I started

1007
00:43:37,250 --> 00:43:41,480
taking a look at this code and I saw

1008
00:43:39,290 --> 00:43:44,180
something called the spirit AI class

1009
00:43:41,480 --> 00:43:46,880
okay in the Miss purity I class I saw

1010
00:43:44,180 --> 00:43:49,879
code that looks like chatter bot factory

1011
00:43:46,880 --> 00:43:53,930
equals new chatterbox factory Pandora

1012
00:43:49,880 --> 00:43:56,960
balls chatterbox factory create Pandora

1013
00:43:53,930 --> 00:43:58,730
bot with some kind of a key that later

1014
00:43:56,960 --> 00:44:00,619
became useful and I'm not gonna talk

1015
00:43:58,730 --> 00:44:03,380
about today okay so you know little

1016
00:44:00,619 --> 00:44:05,240
things like that okay and then I started

1017
00:44:03,380 --> 00:44:06,920
looking at the chatterbox factory code

1018
00:44:05,240 --> 00:44:10,368
and I saw stuff that looks like this

1019
00:44:06,920 --> 00:44:13,700
shadowbot factory's new cleverbot HTTP

1020
00:44:10,369 --> 00:44:17,900
colon slash slash cleverbot comm huh

1021
00:44:13,700 --> 00:44:20,180
Jabberwocky dot-com like whoa what what

1022
00:44:17,900 --> 00:44:22,040
is clever blah what is Jabberwocky and

1023
00:44:20,180 --> 00:44:24,290
so I went there and it's like an AI

1024
00:44:22,040 --> 00:44:27,230
bought like you asked questions you know

1025
00:44:24,290 --> 00:44:29,599
is there a spirit present there is

1026
00:44:27,230 --> 00:44:30,349
always some spirit in the machine are

1027
00:44:29,599 --> 00:44:30,980
you a bot

1028
00:44:30,349 --> 00:44:34,630
I'm all

1029
00:44:30,980 --> 00:44:37,670
you're balling it's just stupid you know

1030
00:44:34,630 --> 00:44:39,770
so when you ask this Ouija board

1031
00:44:37,670 --> 00:44:42,410
questions it's just talking to a

1032
00:44:39,770 --> 00:44:44,210
back-end web server it's asking the AI

1033
00:44:42,410 --> 00:44:46,759
question and it's getting the response

1034
00:44:44,210 --> 00:44:48,650
back and showing it to you but still it

1035
00:44:46,760 --> 00:44:51,740
was weird because I asked a questions

1036
00:44:48,650 --> 00:44:54,290
like are you a bot and it says I am NOT

1037
00:44:51,740 --> 00:44:55,640
a ghost I'm as real as you and I went

1038
00:44:54,290 --> 00:44:58,970
that was not my question

1039
00:44:55,640 --> 00:45:00,680
that was weird because very strange so I

1040
00:44:58,970 --> 00:45:02,779
started digging into a little more and

1041
00:45:00,680 --> 00:45:05,210
the only thing it does is it has a

1042
00:45:02,780 --> 00:45:08,810
function called replace words an in

1043
00:45:05,210 --> 00:45:11,990
replace words if you ask it if it's a BA

1044
00:45:08,810 --> 00:45:14,420
it chooses spirit ghosts psyche or soul

1045
00:45:11,990 --> 00:45:17,390
as a response okay they thought of

1046
00:45:14,420 --> 00:45:23,869
everything this is amazing right like

1047
00:45:17,390 --> 00:45:26,629
wow so much word right and then all it

1048
00:45:23,869 --> 00:45:28,430
does is you know choose random words and

1049
00:45:26,630 --> 00:45:32,350
send them back to you and clearly this

1050
00:45:28,430 --> 00:45:32,350
is uh this is not ghost activity either

1051
00:45:37,480 --> 00:45:43,850
yeah well yes I mean you know I mean you

1052
00:45:42,380 --> 00:45:45,290
know you could see somebody to the

1053
00:45:43,850 --> 00:45:47,240
gentleman's comments right if I could

1054
00:45:45,290 --> 00:45:49,100
paraphrase right it's sending that

1055
00:45:47,240 --> 00:45:51,618
conversations we use this thing like you

1056
00:45:49,100 --> 00:45:53,540
know data I'm so sorry that I never

1057
00:45:51,619 --> 00:45:56,210
confessed that you know you know I

1058
00:45:53,540 --> 00:45:58,940
killed the dog like you know I'm sorry

1059
00:45:56,210 --> 00:46:01,430
you know I I always feel guilty about it

1060
00:45:58,940 --> 00:46:03,500
you know I you know I used to I used to

1061
00:46:01,430 --> 00:46:05,000
always you know pee on the floor I don't

1062
00:46:03,500 --> 00:46:09,410
know whatever I'll be able to keep

1063
00:46:05,000 --> 00:46:11,450
looking Sasuke whatever thing what if

1064
00:46:09,410 --> 00:46:14,118
the Nerds can control the web server one

1065
00:46:11,450 --> 00:46:21,350
thing that's interesting is that as far

1066
00:46:14,119 --> 00:46:25,010
as I could tell these are all HTTP based

1067
00:46:21,350 --> 00:46:27,140
transactions here so so yeah there's all

1068
00:46:25,010 --> 00:46:29,600
sorts of fun stuff but like imagine like

1069
00:46:27,140 --> 00:46:32,000
the domain registration expired on

1070
00:46:29,600 --> 00:46:33,560
cleverbot like imagine the fun that you

1071
00:46:32,000 --> 00:46:36,080
could have with that right and all the

1072
00:46:33,560 --> 00:46:39,020
applications that use that that would be

1073
00:46:36,080 --> 00:46:40,970
so wonderful like I would quit my job

1074
00:46:39,020 --> 00:46:43,310
just to do that full-time like I think

1075
00:46:40,970 --> 00:46:44,810
that that would be a

1076
00:46:43,310 --> 00:46:50,990
easing think of the entertainment value

1077
00:46:44,810 --> 00:46:52,790
okay so I evaluated 20 different Android

1078
00:46:50,990 --> 00:46:55,490
apps and I can't talk about all of them

1079
00:46:52,790 --> 00:46:58,850
for signs of otherworldly experience

1080
00:46:55,490 --> 00:47:01,520
okay you know obfuscated apps took me

1081
00:46:58,850 --> 00:47:03,799
four plus hours okay you know many apps

1082
00:47:01,520 --> 00:47:05,900
took less than an hour and what I came

1083
00:47:03,800 --> 00:47:08,960
out with was 18 apps that were clearly

1084
00:47:05,900 --> 00:47:11,360
busted tooth I was like feeling generous

1085
00:47:08,960 --> 00:47:12,890
and I said plausible mostly because I

1086
00:47:11,360 --> 00:47:14,960
don't know ghosts control an Android

1087
00:47:12,890 --> 00:47:17,509
random number generator okay and no

1088
00:47:14,960 --> 00:47:19,280
confirmed right I wanted I was hoping

1089
00:47:17,510 --> 00:47:20,480
there would be some confirmed apps I was

1090
00:47:19,280 --> 00:47:22,010
really going to be thrilled about that

1091
00:47:20,480 --> 00:47:25,070
but no okay

1092
00:47:22,010 --> 00:47:28,130
so the question is was this a colossal

1093
00:47:25,070 --> 00:47:30,650
waste of my time okay what is just like

1094
00:47:28,130 --> 00:47:32,990
a complete fool's errand that I should

1095
00:47:30,650 --> 00:47:35,870
not have done this and my answer is

1096
00:47:32,990 --> 00:47:37,580
absolutely not okay here's the critical

1097
00:47:35,870 --> 00:47:39,319
things that I learned that if you've

1098
00:47:37,580 --> 00:47:41,480
paid attention to nothing else in this

1099
00:47:39,320 --> 00:47:44,240
presentation I want you to live with

1100
00:47:41,480 --> 00:47:46,250
these couple of facts okay for Android

1101
00:47:44,240 --> 00:47:49,100
apps you can learn a lot just by

1102
00:47:46,250 --> 00:47:51,260
unzipping the apk file system analysis

1103
00:47:49,100 --> 00:47:52,759
revealed so many secrets to me in so

1104
00:47:51,260 --> 00:47:56,330
many of these applications okay

1105
00:47:52,760 --> 00:47:59,030
secondly jaw Dex is a superior tool

1106
00:47:56,330 --> 00:48:00,650
thank goodness for Scylla in the open

1107
00:47:59,030 --> 00:48:03,200
source community that makes tools like

1108
00:48:00,650 --> 00:48:05,330
this possible we use tools like Firefox

1109
00:48:03,200 --> 00:48:06,980
on a regular basis and what would we do

1110
00:48:05,330 --> 00:48:08,569
without them you know we just take for

1111
00:48:06,980 --> 00:48:10,850
granted that they're free but they're

1112
00:48:08,570 --> 00:48:13,760
amazing and I'm so thankful that we have

1113
00:48:10,850 --> 00:48:16,640
these tools available to us okay using

1114
00:48:13,760 --> 00:48:18,620
jad xqe to browse the source using the

1115
00:48:16,640 --> 00:48:20,150
gen-x command line and then searching

1116
00:48:18,620 --> 00:48:22,339
what graph or select string or fine

1117
00:48:20,150 --> 00:48:25,280
string whatever you like to use Android

1118
00:48:22,340 --> 00:48:27,050
studio is essential with Android studio

1119
00:48:25,280 --> 00:48:29,690
now I'm not looking at a read-only copy

1120
00:48:27,050 --> 00:48:31,670
of the code in jad X I can edit it I can

1121
00:48:29,690 --> 00:48:34,070
annotate it I can factor in the rename

1122
00:48:31,670 --> 00:48:35,840
even for code that's not obfuscated

1123
00:48:34,070 --> 00:48:37,910
being able to put variables in there or

1124
00:48:35,840 --> 00:48:39,560
be able to put comments this function

1125
00:48:37,910 --> 00:48:42,109
does this I figured it out after an hour

1126
00:48:39,560 --> 00:48:43,880
and I never want to forget that having a

1127
00:48:42,110 --> 00:48:44,420
way to edit and annotate is very very

1128
00:48:43,880 --> 00:48:46,820
useful

1129
00:48:44,420 --> 00:48:49,190
and finally cross-platform app

1130
00:48:46,820 --> 00:48:51,890
development frameworks you need xamarin

1131
00:48:49,190 --> 00:48:54,500
for gap app for things like that they

1132
00:48:51,890 --> 00:48:56,450
are not that much different and you can

1133
00:48:54,500 --> 00:48:57,110
attack those platforms as well although

1134
00:48:56,450 --> 00:48:58,430
the tools

1135
00:48:57,110 --> 00:49:01,850
change a little bit with these different

1136
00:48:58,430 --> 00:49:03,259
platforms so how should you apply this

1137
00:49:01,850 --> 00:49:05,270
what do you do next

1138
00:49:03,260 --> 00:49:07,370
okay how can you apply this kind of work

1139
00:49:05,270 --> 00:49:09,740
here's a couple of things start

1140
00:49:07,370 --> 00:49:11,660
evaluating your own apps patrick said to

1141
00:49:09,740 --> 00:49:13,339
me Josh we're starting up the DC for one

1142
00:49:11,660 --> 00:49:15,230
group again presence around them from

1143
00:49:13,340 --> 00:49:17,120
Rhode Island okay and so we're going to

1144
00:49:15,230 --> 00:49:18,320
start doing that again and I said here's

1145
00:49:17,120 --> 00:49:20,839
what we're going to do we're going to

1146
00:49:18,320 --> 00:49:22,850
put ten apps we're gonna put them on USB

1147
00:49:20,840 --> 00:49:24,200
drives throw them on the table and then

1148
00:49:22,850 --> 00:49:26,540
we're just going to tear them apart and

1149
00:49:24,200 --> 00:49:29,180
find out what makes them tick okay that

1150
00:49:26,540 --> 00:49:31,759
is a really really informative exercise

1151
00:49:29,180 --> 00:49:33,560
okay just on itself understand the API

1152
00:49:31,760 --> 00:49:35,540
is how to do up analysis how the tools

1153
00:49:33,560 --> 00:49:38,330
work and even just as importantly how

1154
00:49:35,540 --> 00:49:40,580
the tools fail you write your own app

1155
00:49:38,330 --> 00:49:42,860
okay again you don't have to be a

1156
00:49:40,580 --> 00:49:44,420
programmer I'm not a programmer people

1157
00:49:42,860 --> 00:49:46,310
would say Josh you're a programmer and I

1158
00:49:44,420 --> 00:49:48,260
say no I'm not because it would be wrong

1159
00:49:46,310 --> 00:49:50,779
to admit that okay I don't do it

1160
00:49:48,260 --> 00:49:52,280
professionally I can code but it's just

1161
00:49:50,780 --> 00:49:55,970
because I want to get something done

1162
00:49:52,280 --> 00:49:57,560
okay get an idea in your head what other

1163
00:49:55,970 --> 00:50:00,640
industry do you work in do you work in

1164
00:49:57,560 --> 00:50:03,440
you know fashion or retail or healthcare

1165
00:50:00,640 --> 00:50:05,870
you know do you have a passion for

1166
00:50:03,440 --> 00:50:08,180
automotive photography or things like

1167
00:50:05,870 --> 00:50:09,799
that find something that marries that

1168
00:50:08,180 --> 00:50:11,810
together that you love that will

1169
00:50:09,800 --> 00:50:13,550
motivate you and write an app but

1170
00:50:11,810 --> 00:50:15,590
doesn't have to be complicated make an

1171
00:50:13,550 --> 00:50:17,510
IP subnet calculator that doesn't suck

1172
00:50:15,590 --> 00:50:20,750
I've never found one when you make it

1173
00:50:17,510 --> 00:50:22,490
please let me know okay that will help

1174
00:50:20,750 --> 00:50:24,320
you understand what programmers really

1175
00:50:22,490 --> 00:50:27,500
do and will make you a better analyst as

1176
00:50:24,320 --> 00:50:29,540
well okay become a better pen tester by

1177
00:50:27,500 --> 00:50:33,380
building skills and put them into action

1178
00:50:29,540 --> 00:50:36,130
I spent $200 on ghost boss at Ghost Box

1179
00:50:33,380 --> 00:50:38,240
apps and I think it was well spent okay

1180
00:50:36,130 --> 00:50:40,550
none of the apps conclusively

1181
00:50:38,240 --> 00:50:43,459
communicated with the Dead but file

1182
00:50:40,550 --> 00:50:45,920
system analysis reverse engineering D

1183
00:50:43,460 --> 00:50:47,780
obfuscation and third party platform

1184
00:50:45,920 --> 00:50:50,360
analysis gave me the answers that I was

1185
00:50:47,780 --> 00:50:53,680
looking for and I want to leave you with

1186
00:50:50,360 --> 00:50:57,920
a message from our friend Darren here

1187
00:50:53,680 --> 00:51:00,160
there's someone here with me how are you

1188
00:50:57,920 --> 00:51:04,780
doing

1189
00:51:00,160 --> 00:51:06,670
is that ghosts or even putting up the

1190
00:51:04,780 --> 00:51:10,680
mess around with stuff like that we have

1191
00:51:06,670 --> 00:51:10,680
a baby get rid of it

1192
00:51:13,230 --> 00:51:16,560
thank you very much

