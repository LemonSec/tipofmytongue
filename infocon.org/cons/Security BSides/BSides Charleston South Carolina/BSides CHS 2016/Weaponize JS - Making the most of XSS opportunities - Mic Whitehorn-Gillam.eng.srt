1
00:00:16,580 --> 00:00:21,528
um this is like the<font color="#E5E5E5"> first time I'm done</font>

2
00:00:19,970 --> 00:00:24,049
public speaking since I was<font color="#CCCCCC"> in grade</font>

3
00:00:21,529 --> 00:00:25,700
school so if<font color="#E5E5E5"> you can't hear me just you</font>

4
00:00:24,050 --> 00:00:32,090
<font color="#CCCCCC">know stick like a finger up so I know</font>

5
00:00:25,700 --> 00:00:37,970
you<font color="#CCCCCC"> can't hear me yeah for that yeah</font><font color="#E5E5E5"> all</font>

6
00:00:32,090 --> 00:00:39,710
<font color="#E5E5E5">right so making the most of your of your</font>

7
00:00:37,970 --> 00:00:41,839
cross site scripting opportunities now

8
00:00:39,710 --> 00:00:43,309
do I<font color="#CCCCCC"> have</font><font color="#E5E5E5"> any</font><font color="#CCCCCC"> web developers in the room</font>

9
00:00:41,840 --> 00:00:46,430
people with web development experience

10
00:00:43,309 --> 00:00:49,729
yeah we got a few<font color="#E5E5E5"> okay you might be</font>

11
00:00:46,430 --> 00:00:51,729
bored<font color="#CCCCCC"> all right I'm what I'm going to</font>

12
00:00:49,729 --> 00:00:54,710
cover is a lot of sort<font color="#E5E5E5"> of elementary</font>

13
00:00:51,729 --> 00:00:57,799
javascript stuff you can use to do some

14
00:00:54,710 --> 00:01:02,330
cool things but you probably already

15
00:00:57,799 --> 00:01:05,360
know how to do a lot<font color="#E5E5E5"> of it okay so quick</font>

16
00:01:02,330 --> 00:01:10,190
bit about me I'm just<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to pop all</font>

17
00:01:05,360 --> 00:01:12,320
those up so yeah i'm a senior security

18
00:01:10,190 --> 00:01:14,689
consultant at secure ideas which is

19
00:01:12,320 --> 00:01:16,220
based in jacksonville although i'm

20
00:01:14,689 --> 00:01:20,690
actually based in Rock Hill South

21
00:01:16,220 --> 00:01:23,020
Carolina I'm a sort of a long time

22
00:01:20,690 --> 00:01:26,740
software developer I professionally

23
00:01:23,020 --> 00:01:29,179
about 10<font color="#E5E5E5"> years and then before that</font>

24
00:01:26,740 --> 00:01:31,130
upwards of 10 years as sort of a

25
00:01:29,180 --> 00:01:35,810
hobbyist as well and most of<font color="#CCCCCC"> that was</font>

26
00:01:31,130 --> 00:01:40,820
was web app development so I've<font color="#E5E5E5"> always</font>

27
00:01:35,810 --> 00:01:43,190
been sort of a security enthusiast found

28
00:01:40,820 --> 00:01:47,119
a few security flaws in the wild one of

29
00:01:43,190 --> 00:01:51,380
my sort<font color="#E5E5E5"> of favorites was everybody knows</font>

30
00:01:47,120 --> 00:01:53,630
Gawker probably so not the current

31
00:01:51,380 --> 00:01:55,399
platform but an older platform<font color="#E5E5E5"> I</font>

32
00:01:53,630 --> 00:01:57,380
discovered at one point they<font color="#CCCCCC"> had a bunch</font>

33
00:01:55,400 --> 00:02:01,340
of admin controls for comments that<font color="#E5E5E5"> were</font>

34
00:01:57,380 --> 00:02:03,050
just<font color="#E5E5E5"> hitting with CSS there was some</font>

35
00:02:01,340 --> 00:02:05,540
back-end protection on most of those

36
00:02:03,050 --> 00:02:07,908
buttons<font color="#E5E5E5"> but one of them the delete</font>

37
00:02:05,540 --> 00:02:11,720
comment button did not have<font color="#E5E5E5"> back-end</font>

38
00:02:07,909 --> 00:02:14,930
protection so kind of quietly reported

39
00:02:11,720 --> 00:02:16,250
that one and went away but that was that

40
00:02:14,930 --> 00:02:17,720
was before I<font color="#CCCCCC"> was actually doing</font><font color="#E5E5E5"> it</font>

41
00:02:16,250 --> 00:02:19,790
intentionally I just kind of picked

42
00:02:17,720 --> 00:02:21,930
through<font color="#CCCCCC"> the site in there was and and</font>

43
00:02:19,790 --> 00:02:24,120
that was really<font color="#CCCCCC"> early in my in my web</font>

44
00:02:21,930 --> 00:02:28,349
her career and so I<font color="#E5E5E5"> kind of took off</font>

45
00:02:24,120 --> 00:02:31,680
<font color="#E5E5E5">from their security as my does my main</font>

46
00:02:28,349 --> 00:02:34,649
job function is a really recent move for

47
00:02:31,680 --> 00:02:38,639
me actually only been doing it since

48
00:02:34,650 --> 00:02:41,239
kind of earlier<font color="#E5E5E5"> this year if you want to</font>

49
00:02:38,639 --> 00:02:44,519
look<font color="#E5E5E5"> at looking up on github I've got my</font>

50
00:02:41,239 --> 00:02:45,870
countdown Gilliam and also my<font color="#E5E5E5"> Twitter</font>

51
00:02:44,519 --> 00:02:48,659
and<font color="#E5E5E5"> so if you just want to take out your</font>

52
00:02:45,870 --> 00:02:50,129
phone really quick launch Twitter tweet

53
00:02:48,659 --> 00:02:51,209
about how<font color="#E5E5E5"> awesome this talk isn't how</font>

54
00:02:50,129 --> 00:02:57,480
all the people are drinking beer right

55
00:02:51,209 --> 00:02:59,790
now are missing out<font color="#CCCCCC"> all right so just a</font>

56
00:02:57,480 --> 00:03:01,590
quick why not<font color="#CCCCCC"> just do an alert one why</font>

57
00:02:59,790 --> 00:03:03,150
you're in the middle of a pen test that

58
00:03:01,590 --> 00:03:08,419
proves execution you can move on to some

59
00:03:03,150 --> 00:03:10,469
better findings you could do that

60
00:03:08,419 --> 00:03:12,810
sometimes the clients just<font color="#E5E5E5"> not going to</font>

61
00:03:10,469 --> 00:03:14,668
get<font color="#E5E5E5"> it because the even developers I've</font>

62
00:03:12,810 --> 00:03:17,700
worked with people have been<font color="#CCCCCC"> doing apps</font>

63
00:03:14,669 --> 00:03:19,950
for 15 years they see I show them a

64
00:03:17,700 --> 00:03:23,429
cross-site scripting flaw and they go so

65
00:03:19,950 --> 00:03:26,250
what what can you do with that sometimes

66
00:03:23,430 --> 00:03:29,069
it's within scope to exploit that in

67
00:03:26,250 --> 00:03:31,669
order to proceed further with the test

68
00:03:29,069 --> 00:03:34,078
maybe to capture credentials for example

69
00:03:31,669 --> 00:03:35,699
so it's good<font color="#E5E5E5"> to have the tools to do</font>

70
00:03:34,079 --> 00:03:37,439
that and so<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to show you a</font>

71
00:03:35,699 --> 00:03:39,659
couple of JavaScript tricks that you can

72
00:03:37,439 --> 00:03:45,689
probably<font color="#CCCCCC"> use if you want to develop</font><font color="#E5E5E5"> some</font>

73
00:03:39,659 --> 00:03:47,459
more advanced payloads<font color="#E5E5E5"> all right so</font>

74
00:03:45,689 --> 00:03:50,159
<font color="#CCCCCC">here's what we're</font><font color="#E5E5E5"> gonna hear is what I'm</font>

75
00:03:47,459 --> 00:03:54,569
going<font color="#E5E5E5"> to go through a little bit of</font><font color="#CCCCCC"> Dom</font>

76
00:03:50,159 --> 00:03:56,970
traversal<font color="#CCCCCC"> it's elementary if you've been</font>

77
00:03:54,569 --> 00:03:58,589
doing a lot of web stuff but it's sort

78
00:03:56,970 --> 00:04:03,120
of critical it's more critical now with

79
00:03:58,590 --> 00:04:05,519
stuff like angular and react amber where

80
00:04:03,120 --> 00:04:07,379
you've got binding with with templates

81
00:04:05,519 --> 00:04:08,759
because they don't have IDs as much so

82
00:04:07,379 --> 00:04:10,918
you can't necessarily easily get a

83
00:04:08,759 --> 00:04:12,478
handle on the element<font color="#E5E5E5"> you want sometimes</font>

84
00:04:10,919 --> 00:04:14,939
<font color="#E5E5E5">you need to get the nearest element you</font>

85
00:04:12,479 --> 00:04:18,169
can and then<font color="#E5E5E5"> kind of traverse the Dom to</font>

86
00:04:14,939 --> 00:04:18,168
get the one that you really want

87
00:04:18,289 --> 00:04:24,930
stealing HTML forms my example here is

88
00:04:22,409 --> 00:04:27,560
going to be actually just you find the

89
00:04:24,930 --> 00:04:29,930
<font color="#E5E5E5">form get a handle on it</font>

90
00:04:27,560 --> 00:04:31,700
add<font color="#E5E5E5"> an on submit function that gives you</font>

91
00:04:29,930 --> 00:04:37,040
a copy of<font color="#E5E5E5"> the contents of the form first</font>

92
00:04:31,700 --> 00:04:42,139
and then submit<font color="#CCCCCC"> it to their server basic</font>

93
00:04:37,040 --> 00:04:43,700
rewriting the<font color="#CCCCCC"> Dom fetching hosted</font>

94
00:04:42,139 --> 00:04:45,290
resources you got a<font color="#CCCCCC"> JavaScript file or</font>

95
00:04:43,700 --> 00:04:48,080
an HTML file that you want to<font color="#E5E5E5"> use</font><font color="#CCCCCC"> in</font>

96
00:04:45,290 --> 00:04:50,300
your<font color="#E5E5E5"> exploit that you're hosting on your</font>

97
00:04:48,080 --> 00:04:53,229
own server that you<font color="#E5E5E5"> control just</font>

98
00:04:50,300 --> 00:04:55,850
generally how to pull it in and use it

99
00:04:53,230 --> 00:04:57,620
I'm introducing malicious objects I'm

100
00:04:55,850 --> 00:04:59,570
going to spend<font color="#CCCCCC"> a fair bit of time on</font>

101
00:04:57,620 --> 00:05:02,210
that<font color="#E5E5E5"> one and that's basically without</font>

102
00:04:59,570 --> 00:05:04,310
breaking their program getting your

103
00:05:02,210 --> 00:05:10,609
malicious code into the sort<font color="#E5E5E5"> of logical</font>

104
00:05:04,310 --> 00:05:12,860
flow of it probably I'm<font color="#E5E5E5"> thinking we'll</font>

105
00:05:10,610 --> 00:05:15,710
have more time<font color="#CCCCCC"> than we need so if you</font>

106
00:05:12,860 --> 00:05:19,610
have questions as we go just stick not a

107
00:05:15,710 --> 00:05:22,190
finger<font color="#E5E5E5"> but a whole hand up and we'll try</font>

108
00:05:19,610 --> 00:05:23,690
<font color="#E5E5E5">to address those as we go so a lot of</font>

109
00:05:22,190 --> 00:05:25,760
this is<font color="#E5E5E5"> going to build on top of itself</font>

110
00:05:23,690 --> 00:05:27,590
you got questions or I haven't<font color="#E5E5E5"> explained</font>

111
00:05:25,760 --> 00:05:29,930
something well which<font color="#CCCCCC"> is why you would</font>

112
00:05:27,590 --> 00:05:34,760
have questions then let's<font color="#E5E5E5"> get it out of</font>

113
00:05:29,930 --> 00:05:37,700
the way right<font color="#CCCCCC"> away</font><font color="#E5E5E5"> just quickly want to</font>

114
00:05:34,760 --> 00:05:40,039
mention jquery because it's it is almost

115
00:05:37,700 --> 00:05:42,260
everywhere but<font color="#E5E5E5"> i'm not going</font><font color="#CCCCCC"> to use it</font>

116
00:05:40,039 --> 00:05:43,700
in my examples<font color="#CCCCCC"> is it not because</font><font color="#E5E5E5"> you</font>

117
00:05:42,260 --> 00:05:48,409
shouldn't use it<font color="#E5E5E5"> if it's there by all</font>

118
00:05:43,700 --> 00:05:51,409
means take advantage of it but<font color="#E5E5E5"> I don't</font>

119
00:05:48,410 --> 00:05:53,570
<font color="#E5E5E5">want</font><font color="#CCCCCC"> you to be</font><font color="#E5E5E5"> dependent on it so my</font>

120
00:05:51,410 --> 00:05:59,150
examples don't use it certainly<font color="#E5E5E5"> feel</font>

121
00:05:53,570 --> 00:06:01,700
free to use in the<font color="#CCCCCC"> wild though uh oh hey</font>

122
00:05:59,150 --> 00:06:02,840
there's another one I he was dropping on

123
00:06:01,700 --> 00:06:05,300
asynchronous communication this<font color="#E5E5E5"> is</font>

124
00:06:02,840 --> 00:06:09,138
<font color="#E5E5E5">actually extending the idea of of</font>

125
00:06:05,300 --> 00:06:11,510
introducing malicious objects but it'll

126
00:06:09,139 --> 00:06:13,789
be actually an example<font color="#CCCCCC"> that involves</font>

127
00:06:11,510 --> 00:06:18,880
listening in all basically the<font color="#E5E5E5"> Ajax</font>

128
00:06:13,789 --> 00:06:20,990
activity so that you can get<font color="#E5E5E5"> a copy of</font>

129
00:06:18,880 --> 00:06:22,700
first of all the payload their second

130
00:06:20,990 --> 00:06:24,169
innings second of all their response

131
00:06:22,700 --> 00:06:33,740
without breaking their<font color="#E5E5E5"> applique</font>

132
00:06:24,169 --> 00:06:37,039
again<font color="#E5E5E5"> all right so Dom traversal it's</font>

133
00:06:33,740 --> 00:06:45,229
easy when you have an ID attribute like

134
00:06:37,039 --> 00:06:46,580
whereas my ID attribute my<font color="#E5E5E5"> idea no gave</font>

135
00:06:45,229 --> 00:06:50,659
some<font color="#CCCCCC"> of these could have an ID attribute</font>

136
00:06:46,580 --> 00:06:52,248
well those are big oversight and and so

137
00:06:50,659 --> 00:06:54,129
if you<font color="#CCCCCC"> got one that should be unique it</font>

138
00:06:52,249 --> 00:06:55,999
should be on one element and you can do

139
00:06:54,129 --> 00:06:57,729
document.getelementbyid grab that

140
00:06:55,999 --> 00:07:00,860
element do whatever<font color="#E5E5E5"> you want with it</font>

141
00:06:57,729 --> 00:07:04,310
that's great<font color="#E5E5E5"> if it's there if it's not</font>

142
00:07:00,860 --> 00:07:05,749
there you got to get<font color="#E5E5E5"> more creative you</font>

143
00:07:04,310 --> 00:07:10,099
<font color="#E5E5E5">have to get what you can get and then</font>

144
00:07:05,749 --> 00:07:13,430
<font color="#CCCCCC">Traverse from there so you had a lot</font><font color="#E5E5E5"> of</font>

145
00:07:10,099 --> 00:07:15,370
options<font color="#E5E5E5"> for getting a handle get element</font>

146
00:07:13,430 --> 00:07:17,900
by ID if you if there is an element that

147
00:07:15,370 --> 00:07:20,060
isn't the one you want but as near it is

148
00:07:17,900 --> 00:07:22,128
often your preferred option because

149
00:07:20,060 --> 00:07:25,460
again you get one element you get the

150
00:07:22,129 --> 00:07:27,080
specific element it implies that it's

151
00:07:25,460 --> 00:07:28,549
not going to be some dynamic thing where

152
00:07:27,080 --> 00:07:32,419
you're working through<font color="#E5E5E5"> a list of items</font>

153
00:07:28,550 --> 00:07:34,669
and you want a<font color="#CCCCCC"> specific one um you could</font>

154
00:07:32,419 --> 00:07:36,560
get on<font color="#E5E5E5"> payments by name which name</font>

155
00:07:34,669 --> 00:07:38,719
property mostly you'll see<font color="#E5E5E5"> that on forms</font>

156
00:07:36,560 --> 00:07:40,909
a lot of the time they're only be one

157
00:07:38,719 --> 00:07:44,839
with that name anyway but not always

158
00:07:40,909 --> 00:07:47,569
that returns an array get elements by

159
00:07:44,839 --> 00:07:50,629
tag name it's<font color="#CCCCCC"> actually the name of the</font>

160
00:07:47,569 --> 00:07:55,159
tag so if it's div<font color="#CCCCCC"> its div</font><font color="#E5E5E5"> its paragraph</font>

161
00:07:50,629 --> 00:07:56,779
it'll be a p hey those tend to be

162
00:07:55,159 --> 00:08:00,110
sequential in the order they appear in

163
00:07:56,779 --> 00:08:02,710
the markup you can't necessarily always

164
00:08:00,110 --> 00:08:05,599
count on that but but it they tend to be

165
00:08:02,710 --> 00:08:08,870
by class name that's CSS classes you'll

166
00:08:05,599 --> 00:08:10,819
see a lot<font color="#E5E5E5"> of those and query selector</font>

167
00:08:08,870 --> 00:08:12,680
<font color="#E5E5E5">I'm not going</font><font color="#CCCCCC"> to dig into that too much</font>

168
00:08:10,819 --> 00:08:14,029
first of all because I would actually

169
00:08:12,680 --> 00:08:15,259
<font color="#E5E5E5">need to call the reference material on</font>

170
00:08:14,029 --> 00:08:19,849
that to write the selector in the first

171
00:08:15,259 --> 00:08:21,919
place um second of all I think<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> just</font>

172
00:08:19,849 --> 00:08:25,339
a<font color="#E5E5E5"> little bit much this late in the day</font>

173
00:08:21,919 --> 00:08:26,539
but that will let you do some<font color="#CCCCCC"> of the</font>

174
00:08:25,339 --> 00:08:28,639
sort<font color="#E5E5E5"> of flexible things that you could</font>

175
00:08:26,539 --> 00:08:30,620
do with jquery as well fairly easily

176
00:08:28,639 --> 00:08:34,029
like when an attribute has a certain

177
00:08:30,620 --> 00:08:39,589
value of that tag matches your selector

178
00:08:34,029 --> 00:08:43,610
uh all right<font color="#CCCCCC"> Dom traversal so what I've</font>

179
00:08:39,589 --> 00:08:48,769
done set to green people<font color="#E5E5E5"> actually read</font>

180
00:08:43,610 --> 00:08:54,350
that<font color="#CCCCCC"> okay um what about like a</font><font color="#E5E5E5"> family</font>

181
00:08:48,769 --> 00:08:56,510
tree here so if I've got<font color="#E5E5E5"> okay that's you</font>

182
00:08:54,350 --> 00:08:57,800
so that's the element you that's the

183
00:08:56,510 --> 00:09:00,500
element you can get that<font color="#CCCCCC"> one's got the</font>

184
00:08:57,800 --> 00:09:04,880
ID and you want to get to to your cousin

185
00:09:00,500 --> 00:09:11,050
over here basically<font color="#E5E5E5"> you got a concept of</font>

186
00:09:04,880 --> 00:09:13,130
kind of one parent to to an element and

187
00:09:11,050 --> 00:09:14,899
as many children as you want and

188
00:09:13,130 --> 00:09:19,730
siblings everybody else is a sibling to

189
00:09:14,899 --> 00:09:26,300
it so you'd sort of be moving up a level

190
00:09:19,730 --> 00:09:34,519
to the parent hot so don't you jump this

191
00:09:26,300 --> 00:09:38,420
is the<font color="#E5E5E5"> button yeah all right nice right</font>

192
00:09:34,519 --> 00:09:42,890
so I go from I do get element by ID you

193
00:09:38,420 --> 00:09:46,430
so I get this one dot parent node to

194
00:09:42,890 --> 00:09:49,550
move up and then the aunt is the sibling

195
00:09:46,430 --> 00:09:50,839
of the parent and then one of<font color="#E5E5E5"> the</font>

196
00:09:49,550 --> 00:09:52,339
children of<font color="#E5E5E5"> the ant is the cousin and</font>

197
00:09:50,839 --> 00:09:56,029
that's pretty much all there is to but

198
00:09:52,339 --> 00:09:58,010
<font color="#CCCCCC">it's up and around I'm</font><font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> see this is</font>

199
00:09:56,029 --> 00:10:02,110
gonna be interesting I'm gonna<font color="#E5E5E5"> see if I</font>

200
00:09:58,010 --> 00:10:02,110
can pull a code example that I have

201
00:10:06,490 --> 00:10:17,470
yeah<font color="#E5E5E5"> got it that's it you see that can't</font>

202
00:10:15,160 --> 00:10:24,120
see<font color="#CCCCCC"> back in wow that's</font><font color="#E5E5E5"> not even on the</font>

203
00:10:17,470 --> 00:10:26,800
right screen that's way way small<font color="#CCCCCC"> okay</font>

204
00:10:24,120 --> 00:10:30,240
let's give it a quick try anyway we'll

205
00:10:26,800 --> 00:10:30,240
keep that in mind now that's blurry

206
00:10:30,720 --> 00:10:44,560
shove that every way I so it would look

207
00:10:35,709 --> 00:10:46,719
like document dot get element by ID yeah

208
00:10:44,560 --> 00:10:49,060
kind<font color="#E5E5E5"> of covered document dot get element</font>

209
00:10:46,720 --> 00:10:52,180
<font color="#E5E5E5">by ID one thing you need</font><font color="#CCCCCC"> to check with</font>

210
00:10:49,060 --> 00:10:54,040
<font color="#E5E5E5">those is there's often a difference</font>

211
00:10:52,180 --> 00:11:00,579
between<font color="#E5E5E5"> like getting a sibling for</font>

212
00:10:54,040 --> 00:11:02,500
example and an element sibling is what

213
00:11:00,580 --> 00:11:04,390
the actual method is to the two

214
00:11:02,500 --> 00:11:06,459
different things there's slightly

215
00:11:04,390 --> 00:11:08,980
different implications the one you want

216
00:11:06,459 --> 00:11:10,390
is the element<font color="#CCCCCC"> one usually</font><font color="#E5E5E5"> because the</font>

217
00:11:08,980 --> 00:11:11,890
other one will get you<font color="#E5E5E5"> text nodes as</font>

218
00:11:10,390 --> 00:11:20,410
well which you probably don't want<font color="#CCCCCC"> to</font>

219
00:11:11,890 --> 00:11:21,579
act on so it's just rude rudimentary

220
00:11:20,410 --> 00:11:22,990
that you're moving up and down the tree

221
00:11:21,579 --> 00:11:24,699
if you're moving up you're moving up one

222
00:11:22,990 --> 00:11:27,329
level if you're moving down you're

223
00:11:24,700 --> 00:11:29,290
moving into it one of the many children

224
00:11:27,329 --> 00:11:30,430
when you interact with<font color="#CCCCCC"> children you're</font>

225
00:11:29,290 --> 00:11:37,680
dealing with<font color="#E5E5E5"> an array rather than a</font>

226
00:11:30,430 --> 00:11:37,680
single<font color="#E5E5E5"> element stealing HTML forms</font>

227
00:11:42,089 --> 00:11:47,639
there are a few ways to<font color="#CCCCCC"> do it you do</font>

228
00:11:45,300 --> 00:11:53,790
some some gymnastics with<font color="#CCCCCC"> cross-domain</font>

229
00:11:47,639 --> 00:11:55,350
posting and redirecting i don't i don't

230
00:11:53,790 --> 00:11:57,199
<font color="#E5E5E5">like</font><font color="#CCCCCC"> that approach i think it's it's</font>

231
00:11:55,350 --> 00:11:59,730
more difficult and more prone to failure

232
00:11:57,199 --> 00:12:01,920
but if you hold the event on<font color="#E5E5E5"> a non</font>

233
00:11:59,730 --> 00:12:04,079
submit event then you can run an

234
00:12:01,920 --> 00:12:05,819
asynchronous post like an AJAX call to

235
00:12:04,079 --> 00:12:08,040
your own server to pass everything you

236
00:12:05,819 --> 00:12:11,069
want to there and then let it submit

237
00:12:08,040 --> 00:12:16,019
normally or resubmitted as the case may

238
00:12:11,069 --> 00:12:17,430
be trying to think how my examples are

239
00:12:16,019 --> 00:12:19,589
gonna work here<font color="#CCCCCC"> i'm</font><font color="#E5E5E5"> not sure they're big</font>

240
00:12:17,430 --> 00:12:22,829
enough fit on this screen we might<font color="#CCCCCC"> end</font>

241
00:12:19,589 --> 00:12:24,870
up having to pull<font color="#E5E5E5"> people in and kind of</font>

242
00:12:22,829 --> 00:12:29,609
<font color="#E5E5E5">go over it i'm also going to throw it up</font>

243
00:12:24,870 --> 00:12:32,279
<font color="#E5E5E5">on github after as</font><font color="#CCCCCC"> well uh but let's</font>

244
00:12:29,610 --> 00:12:34,490
give to try it give it<font color="#E5E5E5"> one more quick</font>

245
00:12:32,279 --> 00:12:34,490
try

246
00:12:45,430 --> 00:12:52,420
no no I observing

247
00:12:54,780 --> 00:13:04,650
ah hey<font color="#E5E5E5"> there we go that's better a</font>

248
00:12:59,850 --> 00:13:07,350
little awkward from here so we could

249
00:13:04,650 --> 00:13:12,930
<font color="#E5E5E5">actually do that that dom's reversal</font>

250
00:13:07,350 --> 00:13:14,760
really quick there's us there's a cousin

251
00:13:12,930 --> 00:13:15,900
that we want<font color="#E5E5E5"> to get to this is exactly</font>

252
00:13:14,760 --> 00:13:21,200
the same as the<font color="#E5E5E5"> one that was in the</font>

253
00:13:15,900 --> 00:13:23,400
slide ya know if I can get to<font color="#E5E5E5"> Melanie</font>

254
00:13:21,200 --> 00:13:29,780
it's hard to<font color="#E5E5E5"> tell where my console is</font>

255
00:13:23,400 --> 00:13:29,780
right now move that over so

256
00:13:38,670 --> 00:13:44,670
<font color="#E5E5E5">alright so it's that to love you see</font>

257
00:13:42,520 --> 00:13:44,670
that

258
00:13:51,980 --> 00:13:57,200
yeah I call that it returns term returns

259
00:13:55,850 --> 00:13:59,320
that element by ID just like you'd

260
00:13:57,200 --> 00:13:59,320
expect

261
00:14:04,350 --> 00:14:08,900
simple you can change it together parent

262
00:14:06,360 --> 00:14:08,900
<font color="#E5E5E5">node moves you up</font>

263
00:14:15,329 --> 00:14:21,170
elements Hitler that room that's wrong

264
00:14:23,720 --> 00:14:30,929
and siblings<font color="#CCCCCC"> going to get us a text now</font>

265
00:14:27,449 --> 00:14:39,809
I was next siblings what it is that's

266
00:14:30,929 --> 00:14:44,879
what<font color="#CCCCCC"> I want there we go and you can do</font>

267
00:14:39,809 --> 00:14:48,629
first child our first element child but

268
00:14:44,879 --> 00:14:50,189
I'm<font color="#E5E5E5"> gonna do children there we go we got</font>

269
00:14:48,629 --> 00:14:59,910
<font color="#E5E5E5">to our cousin just sort of by chaining</font>

270
00:14:50,189 --> 00:15:02,998
together those moves so going<font color="#CCCCCC"> back to</font><font color="#E5E5E5"> it</font>

271
00:14:59,910 --> 00:15:09,499
to where we'd sort of moved on to try

272
00:15:02,999 --> 00:15:09,499
this again yeah

273
00:15:18,310 --> 00:15:22,029
by the way I like to do this I like to

274
00:15:20,590 --> 00:15:25,690
start of work it out in<font color="#E5E5E5"> the browser when</font>

275
00:15:22,029 --> 00:15:27,400
I can so I've<font color="#CCCCCC"> just changed it on an</font>

276
00:15:25,690 --> 00:15:29,110
exact payload button because i figured

277
00:15:27,400 --> 00:15:31,329
i'm doing a presentation it's probably

278
00:15:29,110 --> 00:15:37,260
going to go<font color="#E5E5E5"> wrong so i wrote it in</font>

279
00:15:31,330 --> 00:15:43,600
advance stuck on a button but there's

280
00:15:37,260 --> 00:15:48,189
there's my actual script again<font color="#E5E5E5"> probably</font>

281
00:15:43,600 --> 00:15:49,930
easier<font color="#CCCCCC"> to look at it</font><font color="#E5E5E5"> on get up after the</font>

282
00:15:48,190 --> 00:15:54,760
thick but let's see<font color="#E5E5E5"> if i can expand that</font>

283
00:15:49,930 --> 00:16:00,630
<font color="#CCCCCC">up so we can see it is or pull it up in</font>

284
00:15:54,760 --> 00:16:00,630
a code editor yeah<font color="#E5E5E5"> let's do that</font>

285
00:16:22,440 --> 00:16:25,280
there we go

286
00:16:25,820 --> 00:16:38,180
so that's functions<font color="#CCCCCC"> they're sort of</font>

287
00:16:28,490 --> 00:16:40,340
simulate the payload executing just

288
00:16:38,180 --> 00:16:41,930
going to login message there to say that

289
00:16:40,340 --> 00:16:43,130
it's armed you<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> don't want</font><font color="#E5E5E5"> to do</font>

290
00:16:41,930 --> 00:16:48,890
that if you're actually trying to use it

291
00:16:43,130 --> 00:16:50,570
for<font color="#CCCCCC"> an exploit and then I access form</font>

292
00:16:48,890 --> 00:16:53,060
element itself in this case I gave it an

293
00:16:50,570 --> 00:16:57,410
ID to make it easy tag into the on

294
00:16:53,060 --> 00:17:03,739
submit event handler and give this

295
00:16:57,410 --> 00:17:06,949
function that<font color="#E5E5E5"> I created here so it's a</font>

296
00:17:03,740 --> 00:17:09,440
little<font color="#CCCCCC"> bit weird this Z this</font><font color="#E5E5E5"> function</font>

297
00:17:06,949 --> 00:17:10,970
gets called right<font color="#CCCCCC"> away when I'm</font>

298
00:17:09,440 --> 00:17:12,860
assigning the event handler and returns

299
00:17:10,970 --> 00:17:16,760
this function which<font color="#CCCCCC"> is what will</font>

300
00:17:12,859 --> 00:17:18,260
actually<font color="#E5E5E5"> be the event handler kind of</font>

301
00:17:16,760 --> 00:17:20,839
covered how that works a little bit more

302
00:17:18,260 --> 00:17:23,150
<font color="#E5E5E5">later but so I passed this fall saying</font>

303
00:17:20,839 --> 00:17:24,589
this Zed is the false which is what i

304
00:17:23,150 --> 00:17:26,900
use to tell whether it's been called

305
00:17:24,589 --> 00:17:30,560
before so that<font color="#E5E5E5"> i can do what i'm going</font>

306
00:17:26,900 --> 00:17:33,020
to do so I'm grabbing the elements by

307
00:17:30,560 --> 00:17:34,429
the tag name here in<font color="#CCCCCC"> this case I just</font>

308
00:17:33,020 --> 00:17:35,660
logged them it to the console again you

309
00:17:34,430 --> 00:17:37,280
probably want<font color="#E5E5E5"> to throw them off onto</font>

310
00:17:35,660 --> 00:17:39,860
your server or wherever you want<font color="#E5E5E5"> to if</font>

311
00:17:37,280 --> 00:17:42,740
you're capturing credentials in<font color="#E5E5E5"> this</font>

312
00:17:39,860 --> 00:17:44,449
case that's all I'm doing<font color="#CCCCCC"> and then if</font>

313
00:17:42,740 --> 00:17:46,460
that is false which means the first time

314
00:17:44,450 --> 00:17:48,860
it's<font color="#E5E5E5"> the first</font><font color="#CCCCCC"> time through I set it to</font>

315
00:17:46,460 --> 00:17:50,240
true run a set time out this case I made

316
00:17:48,860 --> 00:17:52,969
it a little bit more pronounced I set it

317
00:17:50,240 --> 00:17:55,100
at<font color="#CCCCCC"> 23 thousand milliseconds it's sort of</font>

318
00:17:52,970 --> 00:17:57,380
to simulate the the delay you would have

319
00:17:55,100 --> 00:18:00,860
the past off asynchronously then I

320
00:17:57,380 --> 00:18:02,920
<font color="#E5E5E5">return a false which will actually keep</font>

321
00:18:00,860 --> 00:18:09,969
the<font color="#E5E5E5"> form because I'm returning this</font>

322
00:18:02,920 --> 00:18:13,310
it'll<font color="#E5E5E5"> keep the form from submitting then</font>

323
00:18:09,970 --> 00:18:17,030
inside this time out when it actually

324
00:18:13,310 --> 00:18:18,919
happens i call the submit on the phone<font color="#E5E5E5"> i</font>

325
00:18:17,030 --> 00:18:22,550
get the form again a<font color="#E5E5E5"> call submit it'll</font>

326
00:18:18,920 --> 00:18:23,690
pass through<font color="#CCCCCC"> Zen will be true it</font><font color="#E5E5E5"> will</font>

327
00:18:22,550 --> 00:18:26,840
return true and it will get submitted

328
00:18:23,690 --> 00:18:28,970
normally now if<font color="#E5E5E5"> I shorten up that delay</font>

329
00:18:26,840 --> 00:18:30,470
to something you sort of need to kind of

330
00:18:28,970 --> 00:18:31,940
take a guess at<font color="#CCCCCC"> what your latency is but</font>

331
00:18:30,470 --> 00:18:33,080
I<font color="#E5E5E5"> five to make that six hundred</font>

332
00:18:31,940 --> 00:18:36,169
milliseconds that's going to be fine

333
00:18:33,080 --> 00:18:38,239
it'll<font color="#CCCCCC"> be less pronounced and it'll work</font>

334
00:18:36,169 --> 00:18:39,289
pass those<font color="#E5E5E5"> foreign values to me first</font>

335
00:18:38,239 --> 00:18:42,559
then the<font color="#E5E5E5"> form will get submitted</font>

336
00:18:39,289 --> 00:18:44,450
normally user won't<font color="#E5E5E5"> even know</font><font color="#CCCCCC"> that</font>

337
00:18:42,559 --> 00:18:47,950
anything is wrong and all have<font color="#E5E5E5"> a copy of</font>

338
00:18:44,450 --> 00:18:47,950
the credentials that were on that<font color="#E5E5E5"> form</font>

339
00:18:51,910 --> 00:19:05,500
how are we doing so far good losing my

340
00:19:01,270 --> 00:19:06,460
cursor yep oh I'm<font color="#E5E5E5"> looking at two</font>

341
00:19:05,500 --> 00:19:10,930
different screens that are mirroring the

342
00:19:06,460 --> 00:19:18,760
exact same thing looking for it there we

343
00:19:10,930 --> 00:19:20,680
go I know sort<font color="#E5E5E5"> of explains exactly what</font>

344
00:19:18,760 --> 00:19:22,720
I was<font color="#CCCCCC"> just</font><font color="#E5E5E5"> talking about so I hold the</font>

345
00:19:20,680 --> 00:19:29,110
the on submit event while I wait for the

346
00:19:22,720 --> 00:19:32,230
new synchronous post it to happen and

347
00:19:29,110 --> 00:19:33,399
then execute it changing the Dom you're

348
00:19:32,230 --> 00:19:37,600
<font color="#E5E5E5">not going to spend a lot of time on this</font>

349
00:19:33,400 --> 00:19:39,250
is most of the<font color="#E5E5E5"> time</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> going to use</font>

350
00:19:37,600 --> 00:19:40,659
you<font color="#CCCCCC"> going to get</font><font color="#E5E5E5"> a hold of your element</font>

351
00:19:39,250 --> 00:19:41,950
you're going to do a dot<font color="#E5E5E5"> in turn HTML</font>

352
00:19:40,660 --> 00:19:43,690
and throw in the market<font color="#CCCCCC"> that you want</font>

353
00:19:41,950 --> 00:19:45,100
usually that's going to be the<font color="#CCCCCC"> easiest</font>

354
00:19:43,690 --> 00:19:46,240
way to do it it's also a<font color="#E5E5E5"> good thing to</font>

355
00:19:45,100 --> 00:19:47,590
look for if you're looking for a

356
00:19:46,240 --> 00:19:51,250
cross-site scripting vulnerability by

357
00:19:47,590 --> 00:19:52,870
the way this<font color="#E5E5E5"> tends to be taking a value</font>

358
00:19:51,250 --> 00:19:57,820
and throwing it in some place that it

359
00:19:52,870 --> 00:19:58,929
will render the other one that you might

360
00:19:57,820 --> 00:20:01,210
want to do if you<font color="#E5E5E5"> want to hide an</font>

361
00:19:58,930 --> 00:20:03,190
element show it again later it's just

362
00:20:01,210 --> 00:20:05,620
style that display none CSS hides it

363
00:20:03,190 --> 00:20:07,120
takes out<font color="#CCCCCC"> of the flow and you can</font>

364
00:20:05,620 --> 00:20:10,750
rerender it later when you need to<font color="#E5E5E5"> buy</font>

365
00:20:07,120 --> 00:20:12,310
doing a display you<font color="#E5E5E5"> can actually pass it</font>

366
00:20:10,750 --> 00:20:16,060
an empty string and it'll it'll show up

367
00:20:12,310 --> 00:20:17,770
again usually you might have to do in

368
00:20:16,060 --> 00:20:19,870
line depending<font color="#CCCCCC"> on what you're changing</font>

369
00:20:17,770 --> 00:20:22,420
if it has a display property said

370
00:20:19,870 --> 00:20:24,100
already that can be useful<font color="#CCCCCC"> if you're</font>

371
00:20:22,420 --> 00:20:26,740
doing<font color="#E5E5E5"> something like hiding a form</font>

372
00:20:24,100 --> 00:20:29,020
showing something that's saying hey you

373
00:20:26,740 --> 00:20:32,580
time don't need to<font color="#CCCCCC"> login again</font><font color="#E5E5E5"> and then</font>

374
00:20:29,020 --> 00:20:32,580
showing that form again when they do

375
00:20:36,210 --> 00:20:41,470
that<font color="#E5E5E5"> one second the other thing this</font>

376
00:20:40,150 --> 00:20:42,940
sort of thing is good for changing the

377
00:20:41,470 --> 00:20:45,190
dump place where I found it<font color="#CCCCCC"> valuable</font>

378
00:20:42,940 --> 00:20:46,930
before you find a vulnerability but it's

379
00:20:45,190 --> 00:20:49,000
not on a page that you wanted on find

380
00:20:46,930 --> 00:20:50,740
another registration page I'm<font color="#E5E5E5"> going to</font>

381
00:20:49,000 --> 00:20:52,720
<font color="#E5E5E5">use that effectively</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> like a social</font>

382
00:20:50,740 --> 00:20:55,690
engineering attack you got to get

383
00:20:52,720 --> 00:21:00,190
somebody who what you get<font color="#E5E5E5"> somebody to</font>

384
00:20:55,690 --> 00:21:02,620
register a little bit silly or you going

385
00:21:00,190 --> 00:21:04,490
to somehow convince an existing user

386
00:21:02,620 --> 00:21:06,659
that<font color="#E5E5E5"> they need to register again</font>

387
00:21:04,490 --> 00:21:09,210
neither that was really practical you

388
00:21:06,660 --> 00:21:12,240
would like it to be<font color="#E5E5E5"> a login page so make</font>

389
00:21:09,210 --> 00:21:18,179
it a login page on their domain and then

390
00:21:12,240 --> 00:21:21,470
direct them there and<font color="#E5E5E5"> I think I've got</font>

391
00:21:18,179 --> 00:21:21,470
another quick example for that

392
00:21:33,420 --> 00:21:36,050
so

393
00:21:38,940 --> 00:21:46,080
this is sort of a normal login page very

394
00:21:42,600 --> 00:21:47,639
simple<font color="#E5E5E5"> one that I threw together sort of</font>

395
00:21:46,080 --> 00:21:48,840
<font color="#E5E5E5">like my reference implementation or</font>

396
00:21:47,640 --> 00:21:56,060
login page and<font color="#E5E5E5"> I'll show you the</font>

397
00:21:48,840 --> 00:21:58,260
rendered version in a second and my

398
00:21:56,060 --> 00:22:00,120
registration page follows the same kind

399
00:21:58,260 --> 00:22:02,100
<font color="#CCCCCC">of</font><font color="#E5E5E5"> design concepts it's on the same site</font>

400
00:22:00,120 --> 00:22:05,120
it usually does in fact a lot<font color="#CCCCCC"> of people</font>

401
00:22:02,100 --> 00:22:09,419
use something like a master page from

402
00:22:05,120 --> 00:22:11,010
dotnet or use a partial template to

403
00:22:09,420 --> 00:22:12,540
include the exact same JavaScript

404
00:22:11,010 --> 00:22:15,030
resources so even if they're<font color="#E5E5E5"> not using</font>

405
00:22:12,540 --> 00:22:18,560
them yell aloft and have all the<font color="#CCCCCC"> same</font>

406
00:22:15,030 --> 00:22:18,560
JavaScript resources on every page

407
00:22:35,490 --> 00:22:37,550
ah

408
00:23:02,320 --> 00:23:07,960
so there's the registration<font color="#E5E5E5"> page in this</font>

409
00:23:06,190 --> 00:23:09,220
<font color="#E5E5E5">case again I took a shortcut figuring</font>

410
00:23:07,960 --> 00:23:13,870
<font color="#E5E5E5">its presentation things</font><font color="#CCCCCC"> are going to</font>

411
00:23:09,220 --> 00:23:16,779
definitely go wrong and<font color="#E5E5E5"> I created a</font>

412
00:23:13,870 --> 00:23:18,758
variable already on the page<font color="#CCCCCC"> that has</font>

413
00:23:16,779 --> 00:23:19,929
the mark up from the<font color="#E5E5E5"> login page normally</font>

414
00:23:18,759 --> 00:23:31,779
I would just go to<font color="#E5E5E5"> the login page and</font>

415
00:23:19,929 --> 00:23:33,250
grab a copy of that but in this case put

416
00:23:31,779 --> 00:23:36,059
a div at the top level i'm going to use

417
00:23:33,250 --> 00:23:36,059
that<font color="#E5E5E5"> as my handle</font>

418
00:23:55,600 --> 00:24:03,080
there we go I know I've got a handle oh

419
00:23:57,860 --> 00:24:08,959
my did in fact<font color="#E5E5E5"> that's a collection and I</font>

420
00:24:03,080 --> 00:24:11,439
want the individual element there's my

421
00:24:08,960 --> 00:24:11,440
template

422
00:24:19,500 --> 00:24:29,220
let's see if it worked<font color="#E5E5E5"> it uh and it's</font>

423
00:24:27,600 --> 00:24:32,070
great it's already on the domain that

424
00:24:29,220 --> 00:24:34,980
the registration page was on even less

425
00:24:32,070 --> 00:24:37,139
<font color="#CCCCCC">likely to look at a place probably using</font>

426
00:24:34,980 --> 00:24:39,270
the same valid ssl certificate and if

427
00:24:37,140 --> 00:24:40,440
you point the<font color="#CCCCCC"> forearm action at the same</font>

428
00:24:39,270 --> 00:24:42,060
place they'll actually<font color="#E5E5E5"> login</font>

429
00:24:40,440 --> 00:24:43,590
successfully but you can rig it up so

430
00:24:42,060 --> 00:24:46,070
<font color="#CCCCCC">that you can capture credentials with it</font>

431
00:24:43,590 --> 00:24:46,070
at the same time

432
00:24:55,970 --> 00:25:06,179
yeah what about fetching HTML for

433
00:24:58,590 --> 00:25:07,439
another another host<font color="#CCCCCC"> yep and I i hope i</font>

434
00:25:06,179 --> 00:25:11,280
have a working example<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that I</font><font color="#E5E5E5"> think I</font>

435
00:25:07,440 --> 00:25:14,429
do but that's absolutely a possibility

436
00:25:11,280 --> 00:25:16,110
you can set it<font color="#E5E5E5"> up on</font><font color="#CCCCCC"> a different host if</font>

437
00:25:14,429 --> 00:25:17,580
you can't pass in the whole payload it's

438
00:25:16,110 --> 00:25:19,649
always nice if you can<font color="#CCCCCC"> just kind of edit</font>

439
00:25:17,580 --> 00:25:21,570
it in line through the vulnerability

440
00:25:19,650 --> 00:25:24,240
that you already have but<font color="#E5E5E5"> if you can't</font>

441
00:25:21,570 --> 00:25:27,870
do that then<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> always a positive</font>

442
00:25:24,240 --> 00:25:29,280
thing if you can ok you can fetch it

443
00:25:27,870 --> 00:25:30,989
from someplace else you can write a

444
00:25:29,280 --> 00:25:33,270
minimal payload to go and get<font color="#CCCCCC"> it and</font>

445
00:25:30,990 --> 00:25:38,190
just shove it in where you want it

446
00:25:33,270 --> 00:25:41,879
anyway I think probably will do the

447
00:25:38,190 --> 00:25:43,740
JavaScript version of<font color="#CCCCCC"> that first set a</font>

448
00:25:41,880 --> 00:25:46,280
<font color="#E5E5E5">little small as a little small let's</font>

449
00:25:43,740 --> 00:25:46,280
zoom<font color="#E5E5E5"> in a little</font>

450
00:25:55,789 --> 00:26:00,919
so this has a<font color="#E5E5E5"> little bit of sort of</font>

451
00:25:58,460 --> 00:26:04,299
extra going on that's not<font color="#E5E5E5"> entirely</font>

452
00:26:00,919 --> 00:26:07,159
necessary but the idea is still there

453
00:26:04,299 --> 00:26:12,220
xmlhttprequest everybody know<font color="#E5E5E5"> what that</font>

454
00:26:07,159 --> 00:26:15,889
is<font color="#CCCCCC"> okay anybody</font><font color="#E5E5E5"> not know what that is</font>

455
00:26:12,220 --> 00:26:18,039
people use that for<font color="#E5E5E5"> Ajax this is the</font>

456
00:26:15,889 --> 00:26:20,449
object native object that underpins

457
00:26:18,039 --> 00:26:23,330
everybody's Ajax implementation doesn't

458
00:26:20,450 --> 00:26:26,509
matter jquery's is backed by this yet

459
00:26:23,330 --> 00:26:30,918
the mini<font color="#CCCCCC"> jQuery version in angular is</font>

460
00:26:26,509 --> 00:26:32,509
backed by this whatever implementation

461
00:26:30,919 --> 00:26:37,789
you're using with reacts is backed by

462
00:26:32,509 --> 00:26:39,769
the same thing if you've<font color="#E5E5E5"> got an easier</font>

463
00:26:37,789 --> 00:26:42,200
one to use like the jQuery one is

464
00:26:39,769 --> 00:26:47,899
<font color="#CCCCCC">available and more concise definitely</font>

465
00:26:42,200 --> 00:26:51,099
use<font color="#CCCCCC"> it in this case I didn't but I'm</font>

466
00:26:47,899 --> 00:26:53,330
just right I got my<font color="#CCCCCC"> URL I'm fetching it</font>

467
00:26:51,099 --> 00:26:57,460
when it<font color="#CCCCCC"> comes</font><font color="#E5E5E5"> back I throw it into an</font>

468
00:26:53,330 --> 00:27:01,189
eval just plain old JavaScript eval and

469
00:26:57,460 --> 00:27:02,989
it'll execute the script file it's the

470
00:27:01,190 --> 00:27:07,070
same<font color="#E5E5E5"> reason why you don't want</font><font color="#CCCCCC"> to see</font>

471
00:27:02,989 --> 00:27:09,619
evals on the client site walk maybe as<font color="#CCCCCC"> a</font>

472
00:27:07,070 --> 00:27:11,418
<font color="#E5E5E5">pen</font><font color="#CCCCCC"> tester maybe you do depends it's</font>

473
00:27:09,619 --> 00:27:13,639
always<font color="#E5E5E5"> sort of difficult to reconcile</font>

474
00:27:11,419 --> 00:27:17,239
wanting to find things with wanting the

475
00:27:13,639 --> 00:27:20,359
client to be secure but it's a bad thing

476
00:27:17,239 --> 00:27:22,519
to<font color="#E5E5E5"> see normally because it's it's the</font>

477
00:27:20,359 --> 00:27:24,049
sort of thing where if you can get

478
00:27:22,519 --> 00:27:26,389
<font color="#E5E5E5">something into it you can get script to</font>

479
00:27:24,049 --> 00:27:32,119
execute in this<font color="#E5E5E5"> case we're using it for</font>

480
00:27:26,389 --> 00:27:36,769
exactly that purpose now and the same

481
00:27:32,119 --> 00:27:38,478
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> essentially can be done for HTML</font>

482
00:27:36,769 --> 00:27:40,789
from another source the only thing is

483
00:27:38,479 --> 00:27:43,970
instead of<font color="#E5E5E5"> using eval and here i would</font>

484
00:27:40,789 --> 00:27:46,340
<font color="#E5E5E5">do document ID enter HTML whatever the</font>

485
00:27:43,970 --> 00:27:48,979
object is<font color="#CCCCCC"> the Dom Dom object the element</font>

486
00:27:46,340 --> 00:27:52,939
is dot<font color="#E5E5E5"> enter HTML and shove the response</font>

487
00:27:48,979 --> 00:27:54,139
text into that instead you<font color="#CCCCCC"> could</font>

488
00:27:52,940 --> 00:27:56,210
reference style sheets that are

489
00:27:54,139 --> 00:27:58,070
available on that page it reference

490
00:27:56,210 --> 00:28:00,870
other JavaScript that's available on

491
00:27:58,070 --> 00:28:05,460
that page you just shove it in there

492
00:28:00,870 --> 00:28:07,409
and it will get rendered which can be

493
00:28:05,460 --> 00:28:09,300
really effective delivery mechanism if

494
00:28:07,410 --> 00:28:11,610
you've got a big pelo a big big chunk<font color="#E5E5E5"> of</font>

495
00:28:09,300 --> 00:28:14,690
HTML and<font color="#E5E5E5"> you can't stick it in through</font>

496
00:28:11,610 --> 00:28:14,689
your initial attack vector

497
00:28:29,600 --> 00:28:37,320
okay this gets a<font color="#E5E5E5"> little bit scripty so</font>

498
00:28:35,419 --> 00:28:38,549
we've got to kind of build it up with<font color="#CCCCCC"> a</font>

499
00:28:37,320 --> 00:28:42,720
little bit of the time try to bear with

500
00:28:38,549 --> 00:28:46,918
me it's so injecting malicious objects

501
00:28:42,720 --> 00:28:48,360
into the<font color="#E5E5E5"> end of the flow it's hard to</font>

502
00:28:46,919 --> 00:28:52,440
not make it sound complicated but it's

503
00:28:48,360 --> 00:28:53,789
not complicated really so it's going<font color="#E5E5E5"> to</font>

504
00:28:52,440 --> 00:28:54,990
go through<font color="#CCCCCC"> some really basic stuff but</font>

505
00:28:53,789 --> 00:28:57,120
<font color="#CCCCCC">we'll build up to some advanced stuff</font>

506
00:28:54,990 --> 00:29:00,539
within like three or four slides<font color="#E5E5E5"> don't</font>

507
00:28:57,120 --> 00:29:02,340
worry we<font color="#CCCCCC"> got a function we're going</font><font color="#E5E5E5"> to</font>

508
00:29:00,539 --> 00:29:04,020
<font color="#E5E5E5">add function takes two parameters a and</font>

509
00:29:02,340 --> 00:29:08,039
B<font color="#CCCCCC"> add them together and returns that</font>

510
00:29:04,020 --> 00:29:09,720
that value right next to hello world

511
00:29:08,039 --> 00:29:17,908
it's one of the most basic<font color="#E5E5E5"> examples of</font>

512
00:29:09,720 --> 00:29:21,240
anything ever next one down is almost

513
00:29:17,909 --> 00:29:25,950
identical<font color="#CCCCCC"> as a variable</font><font color="#E5E5E5"> add receives a</font>

514
00:29:21,240 --> 00:29:27,510
function assigns it to that variable you

515
00:29:25,950 --> 00:29:29,279
call it exactly the same way afterwards

516
00:29:27,510 --> 00:29:31,289
it's just taking an anonymous upon

517
00:29:29,279 --> 00:29:33,390
function in assigning a reference to it

518
00:29:31,289 --> 00:29:35,220
in the form of a variable think that

519
00:29:33,390 --> 00:29:38,309
would be different there is that<font color="#E5E5E5"> I</font><font color="#CCCCCC"> could</font>

520
00:29:35,220 --> 00:29:40,200
assign something else to add I can do it

521
00:29:38,309 --> 00:29:41,970
in either case actually but I can assign

522
00:29:40,200 --> 00:29:43,409
something else to add a<font color="#E5E5E5"> different</font>

523
00:29:41,970 --> 00:29:45,990
function and that function would get

524
00:29:43,409 --> 00:29:48,419
called instead from<font color="#E5E5E5"> all the functions</font>

525
00:29:45,990 --> 00:29:50,130
that<font color="#E5E5E5"> already reference it by name now</font>

526
00:29:48,419 --> 00:29:54,570
that's<font color="#E5E5E5"> just sort of an artifact of of</font>

527
00:29:50,130 --> 00:29:57,210
<font color="#E5E5E5">being an interpreted language really so</font>

528
00:29:54,570 --> 00:29:58,740
let's modify it a little bit here i<font color="#E5E5E5"> have</font>

529
00:29:57,210 --> 00:30:01,559
a function that returns a function that

530
00:29:58,740 --> 00:30:05,820
does the adding thing<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> my</font><font color="#CCCCCC"> ADD</font>

531
00:30:01,559 --> 00:30:07,850
factory function<font color="#E5E5E5"> it's anybody has worked</font>

532
00:30:05,820 --> 00:30:12,899
around you has certainly seen the

533
00:30:07,850 --> 00:30:14,520
factory method before<font color="#E5E5E5"> is it's sometimes</font>

534
00:30:12,899 --> 00:30:16,739
an overused design pattern in this case

535
00:30:14,520 --> 00:30:20,220
this is just sort<font color="#E5E5E5"> of</font><font color="#CCCCCC"> a step on the way</font>

536
00:30:16,740 --> 00:30:21,809
to to where we're going for<font color="#CCCCCC"> us but so</font>

537
00:30:20,220 --> 00:30:24,990
it's a function returning a function and

538
00:30:21,809 --> 00:30:26,639
<font color="#CCCCCC">I'm assigning a variable assignment at a</font>

539
00:30:24,990 --> 00:30:32,000
reference to that function to this

540
00:30:26,640 --> 00:30:32,000
variable add<font color="#E5E5E5"> one I could call add one</font>

541
00:30:32,790 --> 00:30:37,450
and it would<font color="#CCCCCC"> be calling that function</font>

542
00:30:35,049 --> 00:30:38,889
essentially that that returned one which

543
00:30:37,450 --> 00:30:45,190
<font color="#CCCCCC">is the same</font><font color="#E5E5E5"> ad one that we saw before</font>

544
00:30:38,890 --> 00:30:48,610
but it would<font color="#CCCCCC"> be called</font><font color="#E5E5E5"> add one here I</font>

545
00:30:45,190 --> 00:30:53,320
made it more generic so we've got this

546
00:30:48,610 --> 00:30:55,649
math factory same<font color="#E5E5E5"> idea function</font>

547
00:30:53,320 --> 00:30:59,860
returning a function but in this case

548
00:30:55,650 --> 00:31:08,559
I'm passing in and value and treating

549
00:30:59,860 --> 00:31:11,620
<font color="#E5E5E5">that value as a function so it</font><font color="#CCCCCC"> doesn't</font>

550
00:31:08,559 --> 00:31:13,210
make<font color="#E5E5E5"> a lot of sense</font><font color="#CCCCCC"> to actually do this</font>

551
00:31:11,620 --> 00:31:15,760
if<font color="#E5E5E5"> you want to write an add and subtract</font>

552
00:31:13,210 --> 00:31:19,570
function but it illustrates the example

553
00:31:15,760 --> 00:31:23,770
while I think I passing the logic as a

554
00:31:19,570 --> 00:31:27,100
parameter<font color="#E5E5E5"> in form of a function and then</font>

555
00:31:23,770 --> 00:31:28,840
I use it and this function<font color="#E5E5E5"> does enter</font>

556
00:31:27,100 --> 00:31:30,040
one that I'm returning which is what

557
00:31:28,840 --> 00:31:32,980
it's<font color="#CCCCCC"> going to get assigned to add or</font>

558
00:31:30,040 --> 00:31:35,320
subtract respectively maintains a

559
00:31:32,980 --> 00:31:38,970
reference to this value even<font color="#CCCCCC"> though this</font>

560
00:31:35,320 --> 00:31:41,350
is essentially gone out<font color="#CCCCCC"> of scope and</font>

561
00:31:38,970 --> 00:31:44,850
there's a<font color="#E5E5E5"> reason we're doing this and</font>

562
00:31:41,350 --> 00:31:44,850
we're<font color="#E5E5E5"> right about to get there</font>

563
00:31:47,900 --> 00:32:00,680
<font color="#E5E5E5">I did this yeah ah so the main</font><font color="#CCCCCC"> thing to</font>

564
00:31:59,210 --> 00:32:04,610
<font color="#E5E5E5">look at this changed here that I've done</font>

565
00:32:00,680 --> 00:32:06,110
so I've wrapped it in a set of brackets

566
00:32:04,610 --> 00:32:07,850
is that same thing that<font color="#E5E5E5"> looked weird</font>

567
00:32:06,110 --> 00:32:09,620
before<font color="#E5E5E5"> that false that was passed in I</font>

568
00:32:07,850 --> 00:32:12,050
brought<font color="#E5E5E5"> to set of brackets around my</font>

569
00:32:09,620 --> 00:32:13,969
function and then another set of

570
00:32:12,050 --> 00:32:17,050
brackets afterward that have the

571
00:32:13,970 --> 00:32:22,910
parameter and when you see this<font color="#E5E5E5"> is this</font>

572
00:32:17,050 --> 00:32:25,450
<font color="#CCCCCC">JavaScript closure syntax this outer</font>

573
00:32:22,910 --> 00:32:27,710
function will<font color="#CCCCCC"> be immediately</font><font color="#E5E5E5"> invoked and</font>

574
00:32:25,450 --> 00:32:32,210
this will be returned right away and

575
00:32:27,710 --> 00:32:34,790
assigned to the variable and for the

576
00:32:32,210 --> 00:32:40,400
practical purposes of what we're about

577
00:32:34,790 --> 00:32:41,480
to do that's really<font color="#E5E5E5"> good so this is what</font>

578
00:32:40,400 --> 00:32:45,890
<font color="#E5E5E5">we're going to do we're going to modify</font>

579
00:32:41,480 --> 00:32:47,390
this fetch stuff from the server set as

580
00:32:45,890 --> 00:32:48,740
an existing<font color="#E5E5E5"> function on your</font><font color="#CCCCCC"> client site</font>

581
00:32:47,390 --> 00:32:53,920
this is what we're going to hijack on

582
00:32:48,740 --> 00:32:55,970
them so what do we do we reference

583
00:32:53,920 --> 00:32:57,770
reassign the reference to it so that

584
00:32:55,970 --> 00:33:00,680
anything<font color="#E5E5E5"> that's calling it cause our</font>

585
00:32:57,770 --> 00:33:03,290
function instead but we<font color="#E5E5E5"> still need the</font>

586
00:33:00,680 --> 00:33:05,630
original functions that it can work

587
00:33:03,290 --> 00:33:07,940
normally so they don't detect that

588
00:33:05,630 --> 00:33:14,070
there's anything wrong to the page so

589
00:33:07,940 --> 00:33:16,050
when we<font color="#E5E5E5"> created we pass it in</font><font color="#CCCCCC"> ok</font>

590
00:33:14,070 --> 00:33:18,540
so that we have the<font color="#E5E5E5"> only reference to it</font>

591
00:33:16,050 --> 00:33:21,180
and everything but there anywhere that

592
00:33:18,540 --> 00:33:24,270
they are referencing it is now repointed

593
00:33:21,180 --> 00:33:26,640
our function in this case all I've done

594
00:33:24,270 --> 00:33:28,320
is logged the payload when it comes in

595
00:33:26,640 --> 00:33:31,530
and then I call their function normally

596
00:33:28,320 --> 00:33:33,540
anyway and again even<font color="#CCCCCC"> though</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> use log</font>

597
00:33:31,530 --> 00:33:36,980
in<font color="#E5E5E5"> this case I can do this as an</font>

598
00:33:33,540 --> 00:33:42,060
asynchronous post off to my site 22

599
00:33:36,980 --> 00:33:45,740
grand values and then probably<font color="#E5E5E5"> in the</font>

600
00:33:42,060 --> 00:33:48,899
call back or promise if using promises

601
00:33:45,740 --> 00:33:52,350
call the normal function let it perceive

602
00:33:48,900 --> 00:33:57,450
as it normally does but what I'm missing

603
00:33:52,350 --> 00:33:58,919
at this stage is what response they're

604
00:33:57,450 --> 00:34:01,380
actually getting from the server which I

605
00:33:58,920 --> 00:34:07,430
might be interested<font color="#CCCCCC"> in so that's where</font>

606
00:34:01,380 --> 00:34:10,770
we're going to<font color="#E5E5E5"> go next and that's what I</font>

607
00:34:07,430 --> 00:34:15,659
right here I've created an evil success

608
00:34:10,770 --> 00:34:17,670
function recall that that grabs the

609
00:34:15,659 --> 00:34:19,469
response and then cause their success

610
00:34:17,670 --> 00:34:23,130
callback with that same response passed

611
00:34:19,469 --> 00:34:26,459
to it same thing for<font color="#CCCCCC"> the fail this would</font>

612
00:34:23,130 --> 00:34:31,790
be<font color="#E5E5E5"> of course inside of that previous one</font>

613
00:34:26,460 --> 00:34:34,409
rape where this dot dot dot is so that

614
00:34:31,790 --> 00:34:36,179
when there's is called when when the

615
00:34:34,409 --> 00:34:38,879
original function is called we use those

616
00:34:36,179 --> 00:34:40,889
callbacks my evil<font color="#E5E5E5"> once there's still get</font>

617
00:34:38,880 --> 00:34:46,950
called normally but we grab a copy of

618
00:34:40,889 --> 00:34:52,609
their responses first and that it's

619
00:34:46,949 --> 00:34:54,960
<font color="#E5E5E5">really pretty much it for stealing Ajax</font>

620
00:34:52,610 --> 00:34:57,120
which if you're using it for

621
00:34:54,960 --> 00:34:59,520
intelligence rather than credential

622
00:34:57,120 --> 00:35:03,029
capture or if they're using<font color="#CCCCCC"> page hex to</font>

623
00:34:59,520 --> 00:35:05,250
do authentication it's a really good

624
00:35:03,030 --> 00:35:06,810
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> to to steal maybe you can steal</font>

625
00:35:05,250 --> 00:35:08,910
sensitive information that way because

626
00:35:06,810 --> 00:35:11,670
you're on a page that's using Ajax to do

627
00:35:08,910 --> 00:35:15,020
with the infinite<font color="#E5E5E5"> scroll thing and you</font>

628
00:35:11,670 --> 00:35:15,020
just want to<font color="#E5E5E5"> grab records as they scroll</font>

629
00:35:16,410 --> 00:35:28,319
it was<font color="#E5E5E5"> more I didn't know there's more</font>

630
00:35:19,150 --> 00:35:31,119
um<font color="#CCCCCC"> right and yeah okay</font><font color="#E5E5E5"> so this is if</font>

631
00:35:28,319 --> 00:35:33,519
instead of<font color="#CCCCCC"> is just a made-up function by</font>

632
00:35:31,119 --> 00:35:38,710
it this is an example<font color="#CCCCCC"> I'm using I'm</font>

633
00:35:33,519 --> 00:35:40,660
using an asynchronous function and<font color="#CCCCCC"> daisy</font>

634
00:35:38,710 --> 00:35:42,359
changing in the on response rather than

635
00:35:40,660 --> 00:35:44,078
kind of doing it in line like I was

636
00:35:42,359 --> 00:35:45,848
fundamentals<font color="#CCCCCC"> of it</font><font color="#E5E5E5"> are really very</font>

637
00:35:44,079 --> 00:35:47,739
different it<font color="#CCCCCC"> just means that you're</font>

638
00:35:45,849 --> 00:35:50,470
<font color="#E5E5E5">calling their function in like a call</font>

639
00:35:47,739 --> 00:35:56,289
back or promise rather than calling it

640
00:35:50,470 --> 00:35:59,828
in line in a synchronous call and that's

641
00:35:56,289 --> 00:36:01,960
<font color="#E5E5E5">like hmm well I started early I started</font>

642
00:35:59,829 --> 00:36:05,230
two minutes early so<font color="#E5E5E5"> we're almost at 40</font>

643
00:36:01,960 --> 00:36:06,430
minutes a couple of useful resources if

644
00:36:05,230 --> 00:36:07,829
you've<font color="#E5E5E5"> been doing anything on the web</font>

645
00:36:06,430 --> 00:36:11,649
you<font color="#E5E5E5"> probably already know about them but</font>

646
00:36:07,829 --> 00:36:13,239
<font color="#E5E5E5">we're going to point them out anyway mdn</font>

647
00:36:11,650 --> 00:36:15,869
you want to figure<font color="#E5E5E5"> out how any kind of</font>

648
00:36:13,239 --> 00:36:18,609
objects in JavaScript working that's

649
00:36:15,869 --> 00:36:20,349
w3schools is worth a mention it was used

650
00:36:18,609 --> 00:36:23,589
to be my<font color="#E5E5E5"> first stop now mdn is my</font>

651
00:36:20,349 --> 00:36:25,450
preferred result either one of those

652
00:36:23,589 --> 00:36:27,220
though kind of they've got a listing<font color="#E5E5E5"> of</font>

653
00:36:25,450 --> 00:36:29,980
all<font color="#CCCCCC"> the methods</font><font color="#E5E5E5"> that have that are there</font>

654
00:36:27,220 --> 00:36:31,209
look at document for example we're doing

655
00:36:29,980 --> 00:36:32,499
a lot of<font color="#E5E5E5"> things that were document I get</font>

656
00:36:31,210 --> 00:36:34,390
element by ID you don't know how

657
00:36:32,499 --> 00:36:36,879
<font color="#E5E5E5">something works look at document itself</font>

658
00:36:34,390 --> 00:36:38,259
or look up element and find the generic

659
00:36:36,880 --> 00:36:39,910
stuff that every element has because

660
00:36:38,259 --> 00:36:43,210
that sort of stuff is useful for

661
00:36:39,910 --> 00:36:46,149
interacting with<font color="#CCCCCC"> it but really</font><font color="#E5E5E5"> once you</font>

662
00:36:43,210 --> 00:36:47,920
got<font color="#E5E5E5"> JavaScript execution your</font>

663
00:36:46,150 --> 00:36:49,539
imagination<font color="#CCCCCC"> is sort of the biggest limit</font>

664
00:36:47,920 --> 00:36:52,960
you<font color="#CCCCCC"> can do a lot</font><font color="#E5E5E5"> more than</font><font color="#CCCCCC"> just pop up</font>

665
00:36:49,539 --> 00:36:54,940
an alert box you kind of do whatever<font color="#E5E5E5"> you</font>

666
00:36:52,960 --> 00:36:59,220
want as long as its client side and

667
00:36:54,940 --> 00:36:59,220
maybe a<font color="#E5E5E5"> few things server side as well</font>

668
00:37:00,270 --> 00:37:17,090
anybody any questions yes yeah I any

669
00:37:16,080 --> 00:37:19,590
sort of cross-site scripting

670
00:37:17,090 --> 00:37:24,540
vulnerability and there it's hard to do

671
00:37:19,590 --> 00:37:28,820
a generic kind of thing to use every

672
00:37:24,540 --> 00:37:31,890
time because everyone is different so a

673
00:37:28,820 --> 00:37:33,420
lot of those well I did showed you a

674
00:37:31,890 --> 00:37:35,730
couple of<font color="#E5E5E5"> ways to pull it in through</font>

675
00:37:33,420 --> 00:37:37,980
through your own Ajax call and use it

676
00:37:35,730 --> 00:37:41,250
that<font color="#CCCCCC"> way you might be able to use that</font>

677
00:37:37,980 --> 00:37:44,100
to also use a payload that is that obeys

678
00:37:41,250 --> 00:37:47,190
the filter I didn't cover getting the

679
00:37:44,100 --> 00:37:51,690
excellent actual execution didn't think

680
00:37:47,190 --> 00:37:54,080
<font color="#E5E5E5">I'd have time I guess I did but one</font>

681
00:37:51,690 --> 00:37:56,460
really good reference you know wasp

682
00:37:54,080 --> 00:37:59,220
there's a<font color="#E5E5E5"> good filter</font><font color="#CCCCCC"> evasion cheat</font>

683
00:37:56,460 --> 00:38:00,660
sheet<font color="#CCCCCC"> they're usually</font><font color="#E5E5E5"> the best telltale</font>

684
00:37:59,220 --> 00:38:02,790
be the easiest telltale that<font color="#E5E5E5"> you've</font>

685
00:38:00,660 --> 00:38:04,950
probably<font color="#E5E5E5"> got something you throw a</font>

686
00:38:02,790 --> 00:38:08,550
regular double quote into a into a field

687
00:38:04,950 --> 00:38:12,419
and it gets reflected and escapes the

688
00:38:08,550 --> 00:38:16,950
field then you've got something probably

689
00:38:12,420 --> 00:38:23,300
that you<font color="#E5E5E5"> can work</font><font color="#CCCCCC"> with that answer the</font>

690
00:38:16,950 --> 00:38:23,299
question yes how do you guys

691
00:38:24,049 --> 00:38:28,509
edge like your ex

692
00:38:30,000 --> 00:38:35,020
the end is sort of a case by case

693
00:38:31,990 --> 00:38:37,598
scenario i haven't really had to do a

694
00:38:35,020 --> 00:38:40,538
<font color="#CCCCCC">lot of it and i've done testing and</font>

695
00:38:37,599 --> 00:38:42,250
chrome<font color="#E5E5E5"> i think part of is just that</font>

696
00:38:40,539 --> 00:38:46,150
those filters don't seem to be all that

697
00:38:42,250 --> 00:38:49,000
effective if<font color="#CCCCCC"> the site is vulnerable but</font>

698
00:38:46,150 --> 00:38:51,760
<font color="#CCCCCC">i can't say that</font><font color="#E5E5E5"> i've tested it in</font>

699
00:38:49,000 --> 00:38:58,890
enough depth to really know what the

700
00:38:51,760 --> 00:39:02,160
limits are there any else<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font>

701
00:38:58,890 --> 00:39:02,160
beers right

