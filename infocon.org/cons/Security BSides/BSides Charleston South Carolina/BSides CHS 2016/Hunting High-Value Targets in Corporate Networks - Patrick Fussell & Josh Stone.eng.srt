1
00:00:18,790 --> 00:00:25,520
so as the slide says i'm josh Stone this

2
00:00:22,580 --> 00:00:28,070
is<font color="#CCCCCC"> Patrick fussell we're pen testers if</font>

3
00:00:25,520 --> 00:00:30,050
we if we specialize in anything I guess

4
00:00:28,070 --> 00:00:31,910
in terms of research interest and you'll

5
00:00:30,050 --> 00:00:33,200
see it<font color="#E5E5E5"> in this talk a little bit and</font>

6
00:00:31,910 --> 00:00:35,750
we're kind<font color="#E5E5E5"> of all about post</font>

7
00:00:33,200 --> 00:00:37,610
exploitation so<font color="#E5E5E5"> yeah that's a lot of</font>

8
00:00:35,750 --> 00:00:39,830
what this talk is going<font color="#E5E5E5"> to be about we</font>

9
00:00:37,610 --> 00:00:43,640
work for<font color="#CCCCCC"> a company</font><font color="#E5E5E5"> called PSC don't let</font>

10
00:00:39,830 --> 00:00:46,550
the be a simple seeming acronym scary

11
00:00:43,640 --> 00:00:48,620
too much we do PCI compliance but you

12
00:00:46,550 --> 00:00:50,360
get<font color="#E5E5E5"> a sense for how we do a pen testing</font>

13
00:00:48,620 --> 00:00:52,519
at least in this talk and we were

14
00:00:50,360 --> 00:00:54,470
<font color="#CCCCCC">recently acquired by ncc groups i think</font>

15
00:00:52,519 --> 00:00:56,839
i have<font color="#E5E5E5"> to say</font><font color="#CCCCCC"> that we probably should</font>

16
00:00:54,470 --> 00:00:58,370
have gotten<font color="#CCCCCC"> the new and updated logo so</font>

17
00:00:56,839 --> 00:01:01,070
if you're familiar with them they'll

18
00:00:58,370 --> 00:01:03,830
show you where<font color="#CCCCCC"> we kind</font><font color="#E5E5E5"> of fit</font><font color="#CCCCCC"> in things</font>

19
00:01:01,070 --> 00:01:05,840
perhaps hopping right into it one

20
00:01:03,830 --> 00:01:08,539
valuable question these days i think<font color="#CCCCCC"> is</font>

21
00:01:05,840 --> 00:01:11,060
there's a lack of industrial definition

22
00:01:08,540 --> 00:01:14,690
about what<font color="#E5E5E5"> really is pentesting anymore</font>

23
00:01:11,060 --> 00:01:16,479
strangely part<font color="#E5E5E5"> of me wants to say that</font>

24
00:01:14,690 --> 00:01:18,649
pen testing is when you<font color="#CCCCCC"> just hack stuff</font>

25
00:01:16,479 --> 00:01:20,510
and sometimes<font color="#CCCCCC"> i think</font><font color="#E5E5E5"> that's what</font><font color="#CCCCCC"> we</font>

26
00:01:18,650 --> 00:01:23,180
really want it<font color="#E5E5E5"> to feel</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> if you go</font>

27
00:01:20,510 --> 00:01:25,189
take a hacking class you get a you know

28
00:01:23,180 --> 00:01:27,020
take some training get a certain

29
00:01:25,189 --> 00:01:29,419
certification or something in a pen

30
00:01:27,020 --> 00:01:30,798
testing related topic you'll<font color="#E5E5E5"> find out</font>

31
00:01:29,420 --> 00:01:32,539
<font color="#CCCCCC">that there are some different formal</font>

32
00:01:30,799 --> 00:01:35,090
ways to define what pen testing is we

33
00:01:32,539 --> 00:01:38,030
got some set of different<font color="#E5E5E5"> phases that we</font>

34
00:01:35,090 --> 00:01:40,130
run through too<font color="#E5E5E5"> often i think in real</font>

35
00:01:38,030 --> 00:01:43,189
life for<font color="#E5E5E5"> a lot of places pen testing</font>

36
00:01:40,130 --> 00:01:45,020
looks more like this and i'm on the<font color="#CCCCCC"> the</font>

37
00:01:43,189 --> 00:01:47,029
side of the fence that thinks<font color="#CCCCCC"> this isn't</font>

38
00:01:45,020 --> 00:01:50,000
what<font color="#E5E5E5"> i remember pen testing being</font><font color="#CCCCCC"> 16</font>

39
00:01:47,030 --> 00:01:53,570
years<font color="#E5E5E5"> ago and i started it and so that's</font>

40
00:01:50,000 --> 00:01:55,280
<font color="#CCCCCC">not actually a pen test but what we're</font>

41
00:01:53,570 --> 00:01:57,609
talking about today is the sense in

42
00:01:55,280 --> 00:01:59,509
which all pen tests have an objective

43
00:01:57,609 --> 00:02:01,850
there's something<font color="#CCCCCC"> that you're trying to</font>

44
00:01:59,509 --> 00:02:03,590
<font color="#CCCCCC">achieve it's not just about hey i'll</font>

45
00:02:01,850 --> 00:02:05,329
scan and i'll find some stuff and tell

46
00:02:03,590 --> 00:02:06,829
you about a few things that you might

47
00:02:05,329 --> 00:02:09,049
want to patch but<font color="#E5E5E5"> i don't even know</font><font color="#CCCCCC"> how</font>

48
00:02:06,829 --> 00:02:11,090
to exploit them the real goal of a pen

49
00:02:09,050 --> 00:02:13,280
test<font color="#E5E5E5"> really ought to</font><font color="#CCCCCC"> be finding the</font>

50
00:02:11,090 --> 00:02:15,530
crown jewels in the environment we work

51
00:02:13,280 --> 00:02:18,260
in a PCI environment so for us the crown

52
00:02:15,530 --> 00:02:19,430
jewels are usually pan data we're

53
00:02:18,260 --> 00:02:21,799
looking<font color="#E5E5E5"> for credit card numbers</font>

54
00:02:19,430 --> 00:02:23,600
themselves we find those then they're

55
00:02:21,800 --> 00:02:26,530
not PCI compliant kind of by definition

56
00:02:23,600 --> 00:02:28,600
then it's a matter of figuring out yeah

57
00:02:26,530 --> 00:02:31,510
how do<font color="#E5E5E5"> we fix that now</font><font color="#CCCCCC"> what this talk is</font>

58
00:02:28,600 --> 00:02:34,540
<font color="#E5E5E5">going to be about is not so much yeah</font>

59
00:02:31,510 --> 00:02:36,880
new vulnerabilities or exploitation

60
00:02:34,540 --> 00:02:38,920
techniques but post exploitation tales

61
00:02:36,880 --> 00:02:41,319
from the trenches examples from real pen

62
00:02:38,920 --> 00:02:43,390
tests where you know we're talking about

63
00:02:41,319 --> 00:02:45,780
the mindset or the thought process that

64
00:02:43,390 --> 00:02:49,208
<font color="#E5E5E5">takes us two things I think</font><font color="#CCCCCC"> this is</font>

65
00:02:45,780 --> 00:02:51,540
<font color="#E5E5E5">valuable for a defender as well as an</font>

66
00:02:49,209 --> 00:02:54,690
offender how many of you are defenders

67
00:02:51,540 --> 00:02:58,660
<font color="#E5E5E5">okay cool how many of you are offenders</font>

68
00:02:54,690 --> 00:03:00,400
if that's what's the<font color="#E5E5E5"> third category I'm</font>

69
00:02:58,660 --> 00:03:05,500
not<font color="#CCCCCC"> sure I just</font><font color="#E5E5E5"> an enthusiast perhaps</font>

70
00:03:00,400 --> 00:03:08,019
but uh we're being coy so if you're a

71
00:03:05,500 --> 00:03:09,519
defender pay attention<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the thought</font>

72
00:03:08,019 --> 00:03:11,350
process<font color="#CCCCCC"> that we're presenting as we go</font>

73
00:03:09,519 --> 00:03:13,630
through these scenarios because a lot of

74
00:03:11,350 --> 00:03:15,340
times what we find is if you have really

75
00:03:13,630 --> 00:03:16,959
good hygiene in your network you've

76
00:03:15,340 --> 00:03:18,880
fixed a lot<font color="#E5E5E5"> of the things</font><font color="#CCCCCC"> that you can</font>

77
00:03:16,959 --> 00:03:20,709
scan for there's still a lot of

78
00:03:18,880 --> 00:03:23,380
architectural decisions that have been

79
00:03:20,709 --> 00:03:25,600
made that<font color="#E5E5E5"> help us work our way through a</font>

80
00:03:23,380 --> 00:03:26,590
network to find those crown jewels so

81
00:03:25,600 --> 00:03:28,120
we'll probably make sure we get a little

82
00:03:26,590 --> 00:03:32,850
<font color="#E5E5E5">bit</font><font color="#CCCCCC"> of coverage here and there from that</font>

83
00:03:28,120 --> 00:03:32,850
defensive side as well so first one

84
00:03:36,600 --> 00:03:42,060
<font color="#E5E5E5">alright um so one of the things that</font>

85
00:03:38,670 --> 00:03:45,209
that we<font color="#E5E5E5"> always do we kick off a pen test</font>

86
00:03:42,060 --> 00:03:47,610
is try<font color="#E5E5E5"> to look for what's our early</font>

87
00:03:45,210 --> 00:03:49,920
access or how are we going to gain that

88
00:03:47,610 --> 00:03:51,240
that initial access that will be<font color="#CCCCCC"> Josh to</font>

89
00:03:49,920 --> 00:03:53,339
talk a little<font color="#E5E5E5"> bit about we focus on a</font>

90
00:03:51,240 --> 00:03:55,470
post exploitation but we<font color="#E5E5E5"> still have to</font>

91
00:03:53,340 --> 00:03:56,820
get that that<font color="#CCCCCC"> first compromise is going</font>

92
00:03:55,470 --> 00:03:58,980
to give<font color="#CCCCCC"> us the things we need to start</font>

93
00:03:56,820 --> 00:04:01,980
that post exploitation process that's

94
00:03:58,980 --> 00:04:03,540
<font color="#E5E5E5">always our low hanging fruit in sort of</font>

95
00:04:01,980 --> 00:04:05,299
the traditional model that Josh was

96
00:04:03,540 --> 00:04:07,380
talking about that might be some

97
00:04:05,300 --> 00:04:10,080
vulnerability you find with with with

98
00:04:07,380 --> 00:04:11,519
<font color="#CCCCCC">nessus</font><font color="#E5E5E5"> I think one of the things that's</font>

99
00:04:10,080 --> 00:04:13,290
a little more interesting though from

100
00:04:11,520 --> 00:04:15,660
<font color="#E5E5E5">the pen testing perspective is</font><font color="#CCCCCC"> that</font>

101
00:04:13,290 --> 00:04:18,390
there are<font color="#E5E5E5"> a lot of vulnerabilities they</font>

102
00:04:15,660 --> 00:04:19,529
can give you that access that aren't

103
00:04:18,390 --> 00:04:22,469
<font color="#CCCCCC">necessarily something you would find</font>

104
00:04:19,529 --> 00:04:24,239
with<font color="#CCCCCC"> nessus and as we kick off our pen</font>

105
00:04:22,470 --> 00:04:25,650
test we look at you know scanning a

106
00:04:24,240 --> 00:04:27,180
numeration trying to build a picture in

107
00:04:25,650 --> 00:04:29,280
it and probably even before the pen test

108
00:04:27,180 --> 00:04:30,930
we start with scoping calls and speaking

109
00:04:29,280 --> 00:04:33,119
with<font color="#E5E5E5"> a customer trying to define what</font>

110
00:04:30,930 --> 00:04:34,890
are we<font color="#E5E5E5"> actually going to be testing as</font>

111
00:04:33,120 --> 00:04:36,960
the pen test progresses as we get a

112
00:04:34,890 --> 00:04:39,990
better picture of what the network

113
00:04:36,960 --> 00:04:41,430
actually looks like we start to see what

114
00:04:39,990 --> 00:04:45,060
goes where and how do these things

115
00:04:41,430 --> 00:04:48,330
relate to each other one situation that

116
00:04:45,060 --> 00:04:50,970
we find pretty frequently is after an

117
00:04:48,330 --> 00:04:54,020
organization's had pen test for maybe

118
00:04:50,970 --> 00:04:56,370
three or four years<font color="#E5E5E5"> that they start to</font>

119
00:04:54,020 --> 00:04:57,870
have the better hygiene instead they've

120
00:04:56,370 --> 00:05:00,120
cleaned up a lot<font color="#CCCCCC"> of the the low-hanging</font>

121
00:04:57,870 --> 00:05:02,430
fruit and it becomes a<font color="#CCCCCC"> little bit harder</font>

122
00:05:00,120 --> 00:05:04,230
to<font color="#E5E5E5"> gain</font><font color="#CCCCCC"> that initial access I think from</font>

123
00:05:02,430 --> 00:05:05,910
the pen testing perspective then it

124
00:05:04,230 --> 00:05:07,380
becomes more important to<font color="#E5E5E5"> think a little</font>

125
00:05:05,910 --> 00:05:09,630
bit more<font color="#CCCCCC"> about those vulnerabilities</font>

126
00:05:07,380 --> 00:05:11,610
that are maybe a little bit harder to

127
00:05:09,630 --> 00:05:13,290
frame as vulnerabilities there's lots of

128
00:05:11,610 --> 00:05:15,300
<font color="#E5E5E5">interesting things</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> are inherent to</font>

129
00:05:13,290 --> 00:05:18,330
a network that we can exploit<font color="#E5E5E5"> that give</font>

130
00:05:15,300 --> 00:05:21,270
us the access we need in<font color="#CCCCCC"> that excuse me</font>

131
00:05:18,330 --> 00:05:24,300
in<font color="#E5E5E5"> this initial phase just to sort of</font>

132
00:05:21,270 --> 00:05:25,979
highlight this one thing I want<font color="#E5E5E5"> to walk</font>

133
00:05:24,300 --> 00:05:27,720
through is a couple of pieces of

134
00:05:25,980 --> 00:05:31,140
<font color="#E5E5E5">information you might gather that become</font>

135
00:05:27,720 --> 00:05:32,670
real relevant so one of the things<font color="#E5E5E5"> I</font>

136
00:05:31,140 --> 00:05:35,370
like<font color="#E5E5E5"> to do as soon as I kick off with</font>

137
00:05:32,670 --> 00:05:36,600
pentasa just look at what are<font color="#CCCCCC"> the some</font>

138
00:05:35,370 --> 00:05:39,420
of<font color="#CCCCCC"> the naming conventions that are</font>

139
00:05:36,600 --> 00:05:44,520
that are used<font color="#E5E5E5"> at</font><font color="#CCCCCC"> DNS is a really</font><font color="#E5E5E5"> great</font>

140
00:05:39,420 --> 00:05:46,860
place to look here so you know run

141
00:05:44,520 --> 00:05:49,950
through uh you just in map you can

142
00:05:46,860 --> 00:05:52,620
whatever tool you're actually using to

143
00:05:49,950 --> 00:05:54,960
look at this we look and see<font color="#E5E5E5"> okay it</font>

144
00:05:52,620 --> 00:05:57,090
<font color="#CCCCCC">looks like a lot of our users are a lot</font>

145
00:05:54,960 --> 00:06:02,039
of our systems are related to<font color="#E5E5E5"> specific</font>

146
00:05:57,090 --> 00:06:06,060
users so we can see this looks like you

147
00:06:02,040 --> 00:06:07,770
know we've<font color="#E5E5E5"> got mr. a Smith & J pen way</font>

148
00:06:06,060 --> 00:06:09,750
these are look like<font color="#E5E5E5"> that they're</font>

149
00:06:07,770 --> 00:06:11,760
probably people we don't<font color="#E5E5E5"> know for a fact</font>

150
00:06:09,750 --> 00:06:12,990
that<font color="#E5E5E5"> these are their usernames or what</font>

151
00:06:11,760 --> 00:06:15,539
the actual relation is but we can

152
00:06:12,990 --> 00:06:16,740
probably<font color="#E5E5E5"> start to guess here so if</font><font color="#CCCCCC"> we if</font>

153
00:06:15,540 --> 00:06:17,820
we can<font color="#CCCCCC"> give a little more efficient</font>

154
00:06:16,740 --> 00:06:19,890
about the naming conventions that are

155
00:06:17,820 --> 00:06:21,920
used in the network we might<font color="#E5E5E5"> be able to</font>

156
00:06:19,890 --> 00:06:23,940
<font color="#E5E5E5">create</font><font color="#CCCCCC"> something useful from this</font>

157
00:06:21,920 --> 00:06:25,770
another thing that's fairly ubiquitous

158
00:06:23,940 --> 00:06:29,010
and especially in Windows environments

159
00:06:25,770 --> 00:06:31,010
is is remote desktop and this is another

160
00:06:29,010 --> 00:06:33,330
thing<font color="#CCCCCC"> that we can kind of play in here</font>

161
00:06:31,010 --> 00:06:34,770
so<font color="#E5E5E5"> if we look at if we connect to a</font>

162
00:06:33,330 --> 00:06:36,000
session that's already alive somebody's

163
00:06:34,770 --> 00:06:39,810
already logged into a lot<font color="#E5E5E5"> of times</font>

164
00:06:36,000 --> 00:06:42,240
you'll see remote desktop watch to show

165
00:06:39,810 --> 00:06:46,590
you the the<font color="#CCCCCC"> Active Directory</font><font color="#E5E5E5"> or the</font>

166
00:06:42,240 --> 00:06:49,080
domain as well as a user name if we plug

167
00:06:46,590 --> 00:06:51,450
these things in together we can create a

168
00:06:49,080 --> 00:06:52,710
list of users potentially because we

169
00:06:51,450 --> 00:06:54,840
know the<font color="#E5E5E5"> naming convention that's used</font>

170
00:06:52,710 --> 00:06:56,130
for<font color="#E5E5E5"> the domain as well as now we've got</font>

171
00:06:54,840 --> 00:06:58,500
a list of usernames if we can match

172
00:06:56,130 --> 00:06:59,730
those up and there's a lot<font color="#CCCCCC"> of ways we</font>

173
00:06:58,500 --> 00:07:01,530
can actually might want to create that

174
00:06:59,730 --> 00:07:04,380
list but now we've got a great starting

175
00:07:01,530 --> 00:07:05,820
point and again<font color="#E5E5E5"> I think what's important</font>

176
00:07:04,380 --> 00:07:07,710
about this is these are things that are

177
00:07:05,820 --> 00:07:08,670
inherent<font color="#CCCCCC"> to environment this is</font><font color="#E5E5E5"> just the</font>

178
00:07:07,710 --> 00:07:10,469
way that they've run this isn't

179
00:07:08,670 --> 00:07:12,570
necessarily a vulnerability but<font color="#E5E5E5"> now</font>

180
00:07:10,470 --> 00:07:14,160
we've got a great way to run maybe some

181
00:07:12,570 --> 00:07:16,080
password guessing attacks that can get

182
00:07:14,160 --> 00:07:18,440
us to that that initial access that

183
00:07:16,080 --> 00:07:18,440
we're looking for

184
00:07:21,860 --> 00:07:26,639
yeah<font color="#E5E5E5"> I'll say on that one I've seen a</font>

185
00:07:24,960 --> 00:07:28,409
lot of<font color="#E5E5E5"> people go nuts over trying to</font>

186
00:07:26,639 --> 00:07:29,639
<font color="#E5E5E5">close anonymous user enumeration on</font>

187
00:07:28,410 --> 00:07:31,740
their domain controllers kill their

188
00:07:29,639 --> 00:07:33,120
trust so they can get<font color="#E5E5E5"> rid of that stuff</font>

189
00:07:31,740 --> 00:07:34,680
<font color="#E5E5E5">it stuff along those lines and then</font>

190
00:07:33,120 --> 00:07:37,139
don't realize that DNS leaks the same

191
00:07:34,680 --> 00:07:39,240
information then I've actually I don't

192
00:07:37,139 --> 00:07:41,790
<font color="#E5E5E5">know if I've ever seen a</font><font color="#CCCCCC"> customer</font><font color="#E5E5E5"> after</font>

193
00:07:39,240 --> 00:07:43,860
I find that actually rename their

194
00:07:41,790 --> 00:07:46,770
systems so it's an eternal vulnerability

195
00:07:43,860 --> 00:07:48,419
it's always going<font color="#E5E5E5"> to be there so next</font>

196
00:07:46,770 --> 00:07:50,250
year it picks up where we've got some

197
00:07:48,419 --> 00:07:51,870
basic credentials maybe we did what

198
00:07:50,250 --> 00:07:53,699
Patrick just talked about<font color="#E5E5E5"> now we got</font>

199
00:07:51,870 --> 00:07:55,830
ourselves a regular account we got Joe

200
00:07:53,699 --> 00:07:57,330
schmo's password and as we might think

201
00:07:55,830 --> 00:08:00,030
Joe<font color="#E5E5E5"> Schmo doesn't sound like the most</font>

202
00:07:57,330 --> 00:08:02,099
exciting and interesting user we go and

203
00:08:00,030 --> 00:08:04,349
check<font color="#E5E5E5"> on the domain and unfortunately</font>

204
00:08:02,100 --> 00:08:07,320
he's<font color="#E5E5E5"> just a domain user would be really</font>

205
00:08:04,350 --> 00:08:11,729
<font color="#E5E5E5">really cool if that was domain admins</font>

206
00:08:07,320 --> 00:08:13,710
group membership but nevertheless we

207
00:08:11,729 --> 00:08:15,870
find a lot<font color="#CCCCCC"> of times and in my opinion</font>

208
00:08:13,710 --> 00:08:17,820
has been<font color="#E5E5E5"> for a number of years now</font><font color="#CCCCCC"> the</font>

209
00:08:15,870 --> 00:08:19,590
hard part of a pen test is the initial

210
00:08:17,820 --> 00:08:21,659
entry point once you have<font color="#CCCCCC"> the initial</font>

211
00:08:19,590 --> 00:08:23,400
entry point then escalation and post

212
00:08:21,660 --> 00:08:26,220
exploitation just follows real quickly

213
00:08:23,400 --> 00:08:28,440
so the<font color="#E5E5E5"> question is since we got a user</font>

214
00:08:26,220 --> 00:08:30,720
but he's not<font color="#E5E5E5"> a very valuable user you</font>

215
00:08:28,440 --> 00:08:32,610
know what does it get us and for the

216
00:08:30,720 --> 00:08:34,680
defenders I see a lot<font color="#E5E5E5"> of cases where</font>

217
00:08:32,610 --> 00:08:35,640
<font color="#E5E5E5">I'll say well I got Joe schmo's password</font>

218
00:08:34,679 --> 00:08:38,309
and they'll say well<font color="#E5E5E5"> that doesn't matter</font>

219
00:08:35,640 --> 00:08:40,439
he's just a you<font color="#E5E5E5"> know he's a temp or</font>

220
00:08:38,309 --> 00:08:42,779
something who knows what it is but

221
00:08:40,440 --> 00:08:44,219
people don't take it seriously and you

222
00:08:42,779 --> 00:08:47,330
know in real life there's some things we

223
00:08:44,219 --> 00:08:50,700
can do with<font color="#E5E5E5"> this so one thing that</font>

224
00:08:47,330 --> 00:08:53,420
domain user gets us is we've now gone

225
00:08:50,700 --> 00:08:55,950
from accessing nothing we have the

226
00:08:53,420 --> 00:08:58,260
singularity of compromise battery if you

227
00:08:55,950 --> 00:09:00,300
will we have<font color="#E5E5E5"> literally infinitely</font>

228
00:08:58,260 --> 00:09:02,459
nothing that we can talk<font color="#CCCCCC"> to you suddenly</font>

229
00:09:00,300 --> 00:09:04,709
we have things<font color="#E5E5E5"> that we can access and</font>

230
00:09:02,459 --> 00:09:07,140
even though domain user doesn't control

231
00:09:04,709 --> 00:09:10,709
systems he does have access to a lot of

232
00:09:07,140 --> 00:09:12,959
files and<font color="#CCCCCC"> I found I think that</font><font color="#E5E5E5"> I was</font>

233
00:09:10,709 --> 00:09:15,630
adding it up a couple<font color="#E5E5E5"> days ago I've done</font>

234
00:09:12,959 --> 00:09:18,449
about 180<font color="#E5E5E5"> on-site engagements in the</font>

235
00:09:15,630 --> 00:09:19,920
last five years<font color="#E5E5E5"> and I have twice ever</font>

236
00:09:18,450 --> 00:09:22,980
found a case where I didn't find

237
00:09:19,920 --> 00:09:25,140
<font color="#CCCCCC">something juicy in a file share so some</font>

238
00:09:22,980 --> 00:09:27,209
file shares are or some files are much

239
00:09:25,140 --> 00:09:29,130
more interesting<font color="#CCCCCC"> than others yeah you</font>

240
00:09:27,209 --> 00:09:31,589
can find batch files maybe that have

241
00:09:29,130 --> 00:09:32,320
credentials in them web config files as

242
00:09:31,589 --> 00:09:34,150
a show

243
00:09:32,320 --> 00:09:36,100
<font color="#CCCCCC">we're a lot of times a web developer</font>

244
00:09:34,150 --> 00:09:37,990
wanted to do something with<font color="#E5E5E5"> the web root</font>

245
00:09:36,100 --> 00:09:39,910
and so he opened<font color="#CCCCCC"> up the permissions on</font>

246
00:09:37,990 --> 00:09:41,730
it and never thought about<font color="#E5E5E5"> it again but</font>

247
00:09:39,910 --> 00:09:43,900
<font color="#E5E5E5">now everybody has access to a database</font>

248
00:09:41,730 --> 00:09:45,760
service account credential if they only

249
00:09:43,900 --> 00:09:48,160
thought to go and look for it nobody

250
00:09:45,760 --> 00:09:49,870
made that share with knowledge IT

251
00:09:48,160 --> 00:09:53,319
doesn't even know it's there but we can

252
00:09:49,870 --> 00:09:55,900
find<font color="#E5E5E5"> it so we're looking for you know</font>

253
00:09:53,320 --> 00:09:58,090
big files<font color="#E5E5E5"> you find dis backups</font><font color="#CCCCCC"> vm decays</font>

254
00:09:55,900 --> 00:10:00,520
<font color="#E5E5E5">for virtual machines I've had a couple</font>

255
00:09:58,090 --> 00:10:02,260
times<font color="#E5E5E5"> where i found a an appliance with</font>

256
00:10:00,520 --> 00:10:04,260
a share that was readable by everybody

257
00:10:02,260 --> 00:10:06,010
with vm decays for a domain controller

258
00:10:04,260 --> 00:10:09,520
there's there's nothing more valuable

259
00:10:06,010 --> 00:10:11,920
than that so in a little<font color="#CCCCCC"> network</font><font color="#E5E5E5"> that's</font>

260
00:10:09,520 --> 00:10:15,220
not so hard a little<font color="#E5E5E5"> network</font><font color="#CCCCCC"> you've got</font>

261
00:10:11,920 --> 00:10:16,750
30 users in an office somewhere you're

262
00:10:15,220 --> 00:10:19,210
talking to a few thousands of files that

263
00:10:16,750 --> 00:10:21,490
<font color="#E5E5E5">probably any user can get access to so</font>

264
00:10:19,210 --> 00:10:23,020
you can go<font color="#CCCCCC"> through that in afternoon but</font>

265
00:10:21,490 --> 00:10:25,060
when<font color="#E5E5E5"> you scale this up to any</font>

266
00:10:23,020 --> 00:10:27,760
organization of size a real corporate

267
00:10:25,060 --> 00:10:30,760
environment<font color="#E5E5E5"> maybe national or global in</font>

268
00:10:27,760 --> 00:10:32,770
scope we're talking<font color="#CCCCCC"> about 30,000 users a</font>

269
00:10:30,760 --> 00:10:34,360
hundred thousand users now instead<font color="#E5E5E5"> of</font>

270
00:10:32,770 --> 00:10:36,370
thousands<font color="#E5E5E5"> of files were thinking about</font>

271
00:10:34,360 --> 00:10:38,130
thousands of shares I guess very

272
00:10:36,370 --> 00:10:40,390
difficult to start<font color="#E5E5E5"> going</font><font color="#CCCCCC"> through those</font>

273
00:10:38,130 --> 00:10:42,960
you can go<font color="#CCCCCC"> through the manually and this</font>

274
00:10:40,390 --> 00:10:44,980
will probably actually drive you crazy

275
00:10:42,960 --> 00:10:46,270
because<font color="#E5E5E5"> every time you click on</font>

276
00:10:44,980 --> 00:10:47,800
something you don't have<font color="#E5E5E5"> access to you</font>

277
00:10:46,270 --> 00:10:50,560
get a<font color="#E5E5E5"> pop-up oh you don't have access to</font>

278
00:10:47,800 --> 00:10:53,560
<font color="#CCCCCC">that hit okay that's really</font><font color="#E5E5E5"> annoying you</font>

279
00:10:50,560 --> 00:10:54,579
can use<font color="#CCCCCC"> some tools script up some</font><font color="#E5E5E5"> things</font>

280
00:10:53,560 --> 00:10:56,800
but there aren't a lot of<font color="#E5E5E5"> things that</font>

281
00:10:54,580 --> 00:10:58,690
are specifically well designed for it so

282
00:10:56,800 --> 00:11:00,339
it can<font color="#E5E5E5"> be a real pain you know that</font>

283
00:10:58,690 --> 00:11:02,920
there are jewels out there there's stuff

284
00:11:00,340 --> 00:11:04,720
that's going to get us collation and you

285
00:11:02,920 --> 00:11:08,530
just don't<font color="#E5E5E5"> have the time I'm there for a</font>

286
00:11:04,720 --> 00:11:10,510
week maybe two weeks it's really really

287
00:11:08,530 --> 00:11:11,439
fun engagement and that's just<font color="#E5E5E5"> not</font>

288
00:11:10,510 --> 00:11:13,300
enough<font color="#E5E5E5"> time in some of these</font>

289
00:11:11,440 --> 00:11:17,290
environments to go through hundreds of

290
00:11:13,300 --> 00:11:19,359
thousands or millions of files so yeah I

291
00:11:17,290 --> 00:11:20,319
have a tool you can get the current

292
00:11:19,360 --> 00:11:21,460
<font color="#CCCCCC">version of</font><font color="#E5E5E5"> the tool there's new and</font>

293
00:11:20,320 --> 00:11:23,770
coming out<font color="#E5E5E5"> I'll tell you little bit more</font>

294
00:11:21,460 --> 00:11:25,510
<font color="#E5E5E5">about</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> in a minute</font><font color="#CCCCCC"> but plundering</font>

295
00:11:23,770 --> 00:11:29,680
file shares is something that needs<font color="#E5E5E5"> to</font>

296
00:11:25,510 --> 00:11:34,090
become an automated process so just a

297
00:11:29,680 --> 00:11:36,459
quick how to do it nmap find some SMB

298
00:11:34,090 --> 00:11:38,710
servers turn that into a list of SMB

299
00:11:36,460 --> 00:11:41,180
URLs these are all<font color="#E5E5E5"> the shares or all the</font>

300
00:11:38,710 --> 00:11:43,610
systems that may have shares

301
00:11:41,180 --> 00:11:45,650
then in<font color="#E5E5E5"> multi-threaded fashion you know</font>

302
00:11:43,610 --> 00:11:48,680
scan the tar out of it I find that

303
00:11:45,650 --> 00:11:51,530
simply indexing all of the file shares

304
00:11:48,680 --> 00:11:54,560
if you do it properly with a decent tool

305
00:11:51,530 --> 00:11:57,140
which I like<font color="#E5E5E5"> to think mine is decent you</font>

306
00:11:54,560 --> 00:11:59,599
know I can do this what used to<font color="#CCCCCC"> it takes</font>

307
00:11:57,140 --> 00:12:00,920
me an afternoon and a little company now

308
00:11:59,600 --> 00:12:04,070
takes me an afternoon<font color="#E5E5E5"> in a big company</font>

309
00:12:00,920 --> 00:12:06,199
because I get back<font color="#CCCCCC"> a big list and i grep</font>

310
00:12:04,070 --> 00:12:08,870
through all of my spider results and i

311
00:12:06,200 --> 00:12:12,020
end up with hey there are 310 web config

312
00:12:08,870 --> 00:12:14,060
files in<font color="#E5E5E5"> this environment so with over</font>

313
00:12:12,020 --> 00:12:16,640
300 of them how long does it take<font color="#CCCCCC"> for me</font>

314
00:12:14,060 --> 00:12:19,910
<font color="#E5E5E5">to go look at 300 web config files well</font>

315
00:12:16,640 --> 00:12:21,740
that also<font color="#E5E5E5"> takes a whole afternoon and so</font>

316
00:12:19,910 --> 00:12:23,569
automate that too we do an automated

317
00:12:21,740 --> 00:12:25,070
mirror we just pull all those down run

318
00:12:23,570 --> 00:12:27,620
all those<font color="#E5E5E5"> URLs right back in</font><font color="#CCCCCC"> through</font>

319
00:12:25,070 --> 00:12:30,770
plunder pull all those down and we

320
00:12:27,620 --> 00:12:32,930
automate that that process and like I

321
00:12:30,770 --> 00:12:36,020
said I<font color="#E5E5E5"> think out</font><font color="#CCCCCC"> of 180 something</font>

322
00:12:32,930 --> 00:12:37,550
engagements I've had to<font color="#CCCCCC"> where I didn't</font>

323
00:12:36,020 --> 00:12:39,319
find<font color="#CCCCCC"> something juicy on a file share and</font>

324
00:12:37,550 --> 00:12:40,969
the reason is<font color="#CCCCCC"> because most people don't</font>

325
00:12:39,320 --> 00:12:43,580
<font color="#E5E5E5">know what file shares they have they'll</font>

326
00:12:40,970 --> 00:12:45,950
think of their file server but actually

327
00:12:43,580 --> 00:12:48,140
if you have 600 or six thousand machines

328
00:12:45,950 --> 00:12:49,520
in your environment many many hundreds

329
00:12:48,140 --> 00:12:52,220
of them have shares you probably don't

330
00:12:49,520 --> 00:12:53,780
even know are there and what happens is

331
00:12:52,220 --> 00:12:55,460
somebody says I need to share something

332
00:12:53,780 --> 00:12:57,319
they right click on a directory they

333
00:12:55,460 --> 00:12:58,940
make a share they don't realize<font color="#CCCCCC"> that the</font>

334
00:12:57,320 --> 00:13:01,160
default permissions are going to be

335
00:12:58,940 --> 00:13:02,990
everyone read they won't be everyone

336
00:13:01,160 --> 00:13:05,000
right they'll<font color="#E5E5E5"> be everyone read and</font>

337
00:13:02,990 --> 00:13:06,860
there's enough stuff out there that you

338
00:13:05,000 --> 00:13:08,600
<font color="#E5E5E5">want to be able to get it so to do this</font>

339
00:13:06,860 --> 00:13:09,950
effectively scaling this up to large

340
00:13:08,600 --> 00:13:11,660
environments want to automate it

341
00:13:09,950 --> 00:13:13,760
<font color="#CCCCCC">paralyze it to scale there's some</font>

342
00:13:11,660 --> 00:13:15,350
business logic you don't ago you get

343
00:13:13,760 --> 00:13:17,300
some<font color="#E5E5E5"> places like a financial institution</font>

344
00:13:15,350 --> 00:13:19,550
as an imaging system where every single

345
00:13:17,300 --> 00:13:20,900
receipt every single signature card is

346
00:13:19,550 --> 00:13:23,270
in there so you might have literally

347
00:13:20,900 --> 00:13:25,069
millions of files in a directory yeah

348
00:13:23,270 --> 00:13:27,829
there's some business logic involved in

349
00:13:25,070 --> 00:13:30,320
doing it and<font color="#E5E5E5"> that's why i wrote plunder</font>

350
00:13:27,830 --> 00:13:32,420
I have a new version coming out that's

351
00:13:30,320 --> 00:13:34,250
going to do this<font color="#E5E5E5"> a little bit better and</font>

352
00:13:32,420 --> 00:13:36,829
add some extra capabilities I've been

353
00:13:34,250 --> 00:13:38,990
proof testing it last time we presented

354
00:13:36,830 --> 00:13:40,760
this talk I<font color="#CCCCCC"> had said I was going</font><font color="#E5E5E5"> to get</font>

355
00:13:38,990 --> 00:13:42,620
it out real soon but then my house

356
00:13:40,760 --> 00:13:44,330
started to look like this because i live

357
00:13:42,620 --> 00:13:45,710
in Baton Rouge and so I've<font color="#E5E5E5"> been a little</font>

358
00:13:44,330 --> 00:13:48,230
bit delayed on the project but it should

359
00:13:45,710 --> 00:13:51,620
be coming hoping by end of the<font color="#CCCCCC"> year to</font>

360
00:13:48,230 --> 00:13:55,650
get plunder<font color="#CCCCCC"> to out which has a few of</font>

361
00:13:51,620 --> 00:13:57,930
beneficial features so thinking about

362
00:13:55,650 --> 00:14:00,480
<font color="#E5E5E5">the the strategy though think about how</font>

363
00:13:57,930 --> 00:14:03,449
I get access to something that<font color="#E5E5E5"> everybody</font>

364
00:14:00,480 --> 00:14:05,400
considers useless most IT administrators

365
00:14:03,450 --> 00:14:06,930
most<font color="#E5E5E5"> security people will consider Joe</font>

366
00:14:05,400 --> 00:14:08,699
schmo's account useless they'll say

367
00:14:06,930 --> 00:14:10,920
that'll never get you anywhere but I

368
00:14:08,700 --> 00:14:13,260
<font color="#CCCCCC">promise 99 and a half percent of the</font>

369
00:14:10,920 --> 00:14:22,650
time it gets me everywhere eventually

370
00:14:13,260 --> 00:14:24,480
just<font color="#E5E5E5"> by poking around and looking huh so</font>

371
00:14:22,650 --> 00:14:26,640
one of the ideas<font color="#E5E5E5"> I think we like to have</font>

372
00:14:24,480 --> 00:14:28,350
when we<font color="#E5E5E5"> go into the pen test isms just</font>

373
00:14:26,640 --> 00:14:33,120
assume that there is<font color="#E5E5E5"> a problem somewhere</font>

374
00:14:28,350 --> 00:14:35,550
and our job as good pen testers is to

375
00:14:33,120 --> 00:14:39,060
help identify those issues and how I how

376
00:14:35,550 --> 00:14:40,530
they<font color="#E5E5E5"> might be used realistically and so</font>

377
00:14:39,060 --> 00:14:42,930
we have to start the pen test with this

378
00:14:40,530 --> 00:14:45,360
concept of we're going to go find the

379
00:14:42,930 --> 00:14:47,219
problems I don't know I've<font color="#E5E5E5"> been telling</font>

380
00:14:45,360 --> 00:14:49,110
with ideas is there anybody anywhere who

381
00:14:47,220 --> 00:14:51,420
would say my network and my systems are

382
00:14:49,110 --> 00:14:54,060
one hundred percent secure I don't think

383
00:14:51,420 --> 00:14:57,150
<font color="#CCCCCC">that there is that would be a a bold</font>

384
00:14:54,060 --> 00:15:00,209
<font color="#E5E5E5">claim if there was so one of the</font>

385
00:14:57,150 --> 00:15:03,449
concepts that that we tend to to work

386
00:15:00,210 --> 00:15:06,260
with fairly commonly is because we do a

387
00:15:03,450 --> 00:15:08,520
<font color="#E5E5E5">lot of</font><font color="#CCCCCC"> pci pen testing is that we have</font>

388
00:15:06,260 --> 00:15:11,220
networks where there's essentially two

389
00:15:08,520 --> 00:15:13,949
environments one of higher security and

390
00:15:11,220 --> 00:15:16,980
one of lower security this isn't always

391
00:15:13,950 --> 00:15:18,240
necessarily directly<font color="#CCCCCC"> PCI related work of</font>

392
00:15:16,980 --> 00:15:19,140
lots of companies who have<font color="#E5E5E5"> just you know</font>

393
00:15:18,240 --> 00:15:21,030
might<font color="#E5E5E5"> be your production environment</font>

394
00:15:19,140 --> 00:15:23,069
versus your corporate environment

395
00:15:21,030 --> 00:15:24,390
whatever it<font color="#E5E5E5"> is this can fall into lots</font>

396
00:15:23,070 --> 00:15:26,340
of different categories I'm it's just

397
00:15:24,390 --> 00:15:27,540
convenient to talk<font color="#E5E5E5"> about pci-x we can</font>

398
00:15:26,340 --> 00:15:29,340
say we want to<font color="#E5E5E5"> always keep our</font>

399
00:15:27,540 --> 00:15:31,589
cardholder data somewhere nice and

400
00:15:29,340 --> 00:15:33,030
secure so so we have these we<font color="#E5E5E5"> have these</font>

401
00:15:31,590 --> 00:15:36,030
varying environments and we have some

402
00:15:33,030 --> 00:15:39,630
way<font color="#E5E5E5"> to separate them what we see</font><font color="#CCCCCC"> here is</font>

403
00:15:36,030 --> 00:15:41,459
<font color="#E5E5E5">just one one version of it or one way</font>

404
00:15:39,630 --> 00:15:43,380
this kind of falls out where may we have

405
00:15:41,460 --> 00:15:45,330
all our users in one place some

406
00:15:43,380 --> 00:15:47,640
intermediary hose the bastion host that

407
00:15:45,330 --> 00:15:50,150
they'll connect to and then we have all

408
00:15:47,640 --> 00:15:54,030
over a valuable data somewhere else a

409
00:15:50,150 --> 00:15:55,410
couple<font color="#E5E5E5"> things to note about this is we</font>

410
00:15:54,030 --> 00:15:57,120
have to<font color="#E5E5E5"> make we're gonna have to</font>

411
00:15:55,410 --> 00:15:59,769
administer this this network so we have

412
00:15:57,120 --> 00:16:00,670
to have a<font color="#CCCCCC"> way to deal with</font><font color="#E5E5E5"> these and</font>

413
00:15:59,769 --> 00:16:03,369
we know<font color="#CCCCCC"> that our users are gonna be</font>

414
00:16:00,670 --> 00:16:05,589
connecting through so keeping that in

415
00:16:03,369 --> 00:16:08,679
mind what starts out looking like this

416
00:16:05,589 --> 00:16:10,089
kind<font color="#E5E5E5"> of turns out looking like this we</font>

417
00:16:08,679 --> 00:16:11,829
all we've all seen<font color="#E5E5E5"> a situation where we</font>

418
00:16:10,089 --> 00:16:14,319
put one hole for one day because this

419
00:16:11,829 --> 00:16:22,299
<font color="#E5E5E5">one guy needed the one thing and you</font>

420
00:16:14,319 --> 00:16:25,689
multiply that 365 times and now we've

421
00:16:22,299 --> 00:16:27,009
got a pretty pretty different situation

422
00:16:25,689 --> 00:16:28,389
I mean this is one of<font color="#E5E5E5"> the things we're</font>

423
00:16:27,009 --> 00:16:30,999
looking for in the pen test is how<font color="#CCCCCC"> can</font>

424
00:16:28,389 --> 00:16:33,399
we leverage this to get what we<font color="#E5E5E5"> need so</font>

425
00:16:30,999 --> 00:16:36,579
real quickly this just look<font color="#E5E5E5"> at a</font><font color="#CCCCCC"> typical</font>

426
00:16:33,399 --> 00:16:39,249
pen test scenario we started off with

427
00:16:36,579 --> 00:16:40,479
all our scanning enumeration we learned

428
00:16:39,249 --> 00:16:42,730
a little about<font color="#CCCCCC"> the environment</font><font color="#E5E5E5"> we got</font>

429
00:16:40,480 --> 00:16:44,860
some initial access we're able<font color="#CCCCCC"> to use</font>

430
00:16:42,730 --> 00:16:45,999
that<font color="#CCCCCC"> to escalate maybe like</font><font color="#E5E5E5"> what Josh</font>

431
00:16:44,860 --> 00:16:48,730
was talking about where we<font color="#E5E5E5"> found some</font>

432
00:16:45,999 --> 00:16:50,589
credentials on a share so now we've got

433
00:16:48,730 --> 00:16:52,720
da creds domain administrators are great

434
00:16:50,589 --> 00:16:54,610
but what does that really mean nothing

435
00:16:52,720 --> 00:16:56,110
essentially I mean<font color="#CCCCCC"> that's yeah great</font>

436
00:16:54,610 --> 00:16:59,079
you've got<font color="#CCCCCC"> demain administrator but can</font>

437
00:16:56,110 --> 00:17:00,610
<font color="#E5E5E5">I use it</font><font color="#CCCCCC"> to get me</font><font color="#E5E5E5"> anything and how do</font>

438
00:16:59,079 --> 00:17:03,008
we<font color="#E5E5E5"> leverage that access to actually get</font>

439
00:17:00,610 --> 00:17:04,059
to the CDE or maybe get to<font color="#CCCCCC"> our</font>

440
00:17:03,009 --> 00:17:06,010
production environment where our

441
00:17:04,059 --> 00:17:07,629
valuable data is now that's where the

442
00:17:06,010 --> 00:17:11,439
value<font color="#E5E5E5"> of this this process comes into</font>

443
00:17:07,630 --> 00:17:13,480
play so how so how do<font color="#E5E5E5"> we do that that's</font>

444
00:17:11,439 --> 00:17:17,709
a good<font color="#E5E5E5"> question we want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get to</font><font color="#CCCCCC"> the</font>

445
00:17:13,480 --> 00:17:20,049
<font color="#E5E5E5">Prophet step so so going back</font><font color="#CCCCCC"> to that</font>

446
00:17:17,709 --> 00:17:21,520
<font color="#E5E5E5">that initial concept of we always know</font>

447
00:17:20,049 --> 00:17:27,369
there's there's problems we want to make

448
00:17:21,520 --> 00:17:29,408
sure we can<font color="#E5E5E5"> use the</font><font color="#CCCCCC"> DA creds and look at</font>

449
00:17:27,369 --> 00:17:30,939
our ability to know something about<font color="#E5E5E5"> the</font>

450
00:17:29,409 --> 00:17:32,350
environment so in our first places we

451
00:17:30,940 --> 00:17:34,720
were building some clear picture of the

452
00:17:32,350 --> 00:17:37,389
environment so how do we<font color="#E5E5E5"> do that I think</font>

453
00:17:34,720 --> 00:17:40,570
<font color="#E5E5E5">one thing that we've we've process we</font>

454
00:17:37,389 --> 00:17:42,729
sort<font color="#E5E5E5"> of perfected is looking at active</font>

455
00:17:40,570 --> 00:17:46,330
network connections so looking at that

456
00:17:42,730 --> 00:17:47,500
that<font color="#E5E5E5"> a fashion host scenario we know</font>

457
00:17:46,330 --> 00:17:49,840
that we want to<font color="#E5E5E5"> know something about</font>

458
00:17:47,500 --> 00:17:52,889
who's connected to those hosts and water

459
00:17:49,840 --> 00:17:56,350
you know where am I my potential targets

460
00:17:52,889 --> 00:17:58,360
<font color="#CCCCCC">nest</font><font color="#E5E5E5"> that is a great indicator so if</font>

461
00:17:56,350 --> 00:18:00,760
I've got domain administrator creds I

462
00:17:58,360 --> 00:18:03,539
can hypothetically collect net stats

463
00:18:00,760 --> 00:18:07,710
from all the systems were that

464
00:18:03,539 --> 00:18:09,658
has privileges so let's<font color="#E5E5E5"> just imagine or</font>

465
00:18:07,710 --> 00:18:12,330
one<font color="#CCCCCC"> of the ways this actually plays out</font>

466
00:18:09,659 --> 00:18:14,159
during a pen test is we gather the nest

467
00:18:12,330 --> 00:18:15,899
at information<font color="#E5E5E5"> from all of the host and</font>

468
00:18:14,159 --> 00:18:18,179
the maybe in that corporate network or

469
00:18:15,899 --> 00:18:21,840
that use reveal and what can we<font color="#CCCCCC"> do</font><font color="#E5E5E5"> with</font>

470
00:18:18,179 --> 00:18:23,309
that data so now let's take<font color="#E5E5E5"> a look</font><font color="#CCCCCC"> at do</font>

471
00:18:21,840 --> 00:18:24,539
we<font color="#CCCCCC"> have any direct connections</font><font color="#E5E5E5"> into our</font>

472
00:18:23,309 --> 00:18:27,658
valuable networks we can<font color="#E5E5E5"> just use a</font>

473
00:18:24,539 --> 00:18:30,179
<font color="#CCCCCC">little bit</font><font color="#E5E5E5"> of creative prepping about</font>

474
00:18:27,659 --> 00:18:31,350
the first time<font color="#E5E5E5"> I ever did this it turns</font>

475
00:18:30,179 --> 00:18:32,759
out that there were no direct

476
00:18:31,350 --> 00:18:34,859
connections and I thought well let's

477
00:18:32,759 --> 00:18:36,929
<font color="#CCCCCC">take</font><font color="#E5E5E5"> a step back and</font><font color="#CCCCCC"> look at</font><font color="#E5E5E5"> what else</font>

478
00:18:34,859 --> 00:18:38,908
we know<font color="#E5E5E5"> about this environment to build</font>

479
00:18:36,929 --> 00:18:39,659
a<font color="#E5E5E5"> little bit clearer picture and maybe</font>

480
00:18:38,909 --> 00:18:40,799
there's something else that's

481
00:18:39,659 --> 00:18:42,330
interesting even<font color="#CCCCCC"> if</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't see the</font>

482
00:18:40,799 --> 00:18:45,450
<font color="#E5E5E5">different connections into my target</font>

483
00:18:42,330 --> 00:18:47,549
Network so actually<font color="#CCCCCC"> from a</font>

484
00:18:45,450 --> 00:18:51,629
recommendation from from Josh and a

485
00:18:47,549 --> 00:18:54,149
little scripting what we would I what do

486
00:18:51,629 --> 00:18:57,209
<font color="#E5E5E5">we process we've we've come up with</font><font color="#CCCCCC"> is</font>

487
00:18:54,149 --> 00:18:58,678
actually turning those net stats into

488
00:18:57,210 --> 00:19:00,059
<font color="#E5E5E5">something that's a little more graphical</font>

489
00:18:58,679 --> 00:19:03,389
it's something that has some meaningful

490
00:19:00,059 --> 00:19:06,599
data in<font color="#E5E5E5"> it so using</font><font color="#CCCCCC"> a tool called graph</font>

491
00:19:03,389 --> 00:19:08,570
is if anybody is familiar with<font color="#CCCCCC"> that we</font>

492
00:19:06,599 --> 00:19:12,658
can we can use<font color="#CCCCCC"> that to draw grass from</font>

493
00:19:08,570 --> 00:19:13,799
<font color="#CCCCCC">such textual information and something</font>

494
00:19:12,659 --> 00:19:16,919
you might get that<font color="#CCCCCC"> it looks something</font>

495
00:19:13,799 --> 00:19:18,269
<font color="#CCCCCC">like this so there's</font><font color="#E5E5E5"> lots of ways</font><font color="#CCCCCC"> you</font>

496
00:19:16,919 --> 00:19:22,049
might parse this data out and turn this

497
00:19:18,269 --> 00:19:23,970
into actual actual grass but this is

498
00:19:22,049 --> 00:19:25,710
<font color="#CCCCCC">just an example of something that</font><font color="#E5E5E5"> might</font>

499
00:19:23,970 --> 00:19:27,330
<font color="#CCCCCC">be interesting in that set of data where</font>

500
00:19:25,710 --> 00:19:30,210
we have tons of<font color="#CCCCCC"> income and connections</font>

501
00:19:27,330 --> 00:19:31,649
into a single host and that might tell

502
00:19:30,210 --> 00:19:37,590
you that there's something<font color="#E5E5E5"> special about</font>

503
00:19:31,649 --> 00:19:38,969
this hose and now this<font color="#E5E5E5"> is really</font>

504
00:19:37,590 --> 00:19:41,039
<font color="#CCCCCC">interesting because what does this mean</font>

505
00:19:38,970 --> 00:19:43,499
is this some sort of<font color="#E5E5E5"> a bastion host or</font>

506
00:19:41,039 --> 00:19:47,009
if we see tons of incoming connections

507
00:19:43,499 --> 00:19:49,889
it might be a database or a file share

508
00:19:47,009 --> 00:19:51,509
<font color="#CCCCCC">of some sort but I also think that uh if</font>

509
00:19:49,889 --> 00:19:52,949
you look towards the<font color="#E5E5E5"> top right there you</font>

510
00:19:51,509 --> 00:19:54,419
see that there's a one-house connected

511
00:19:52,950 --> 00:19:55,470
to one another host those can be

512
00:19:54,419 --> 00:19:57,629
interesting too so there are<font color="#E5E5E5"> lots of</font>

513
00:19:55,470 --> 00:20:04,619
cool<font color="#CCCCCC"> things we can tease out the sort of</font>

514
00:19:57,629 --> 00:20:06,570
information but another direction you

515
00:20:04,619 --> 00:20:09,269
might go is or I think<font color="#E5E5E5"> maybe the more</font>

516
00:20:06,570 --> 00:20:11,730
meaningful<font color="#E5E5E5"> piece is those things</font><font color="#CCCCCC"> that</font>

517
00:20:09,269 --> 00:20:12,840
the people at your client or the IT

518
00:20:11,730 --> 00:20:14,130
department or the networking

519
00:20:12,840 --> 00:20:16,139
this<font color="#E5E5E5"> traders can't tell you or won't</font>

520
00:20:14,130 --> 00:20:18,450
tell you or maybe they don't know<font color="#E5E5E5"> about</font>

521
00:20:16,140 --> 00:20:20,070
you might find connections that<font color="#CCCCCC"> they</font>

522
00:20:18,450 --> 00:20:21,809
thought were gone or we're not we're not

523
00:20:20,070 --> 00:20:24,539
aware of and these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> the places we</font>

524
00:20:21,809 --> 00:20:27,240
usually find the most<font color="#E5E5E5"> valuable access so</font>

525
00:20:24,539 --> 00:20:30,090
in several situations in a pen test

526
00:20:27,240 --> 00:20:32,400
what's actually come out is oh we had an

527
00:20:30,090 --> 00:20:35,070
old bastion host we set up that doesn't

528
00:20:32,400 --> 00:20:37,470
<font color="#E5E5E5">have this doesn't have MFA can figure it</font>

529
00:20:35,070 --> 00:20:39,870
on it and we can see<font color="#E5E5E5"> that those</font>

530
00:20:37,470 --> 00:20:42,330
connections are live and now I<font color="#E5E5E5"> don't</font>

531
00:20:39,870 --> 00:20:45,418
<font color="#E5E5E5">have to use MFA to get to my protected</font>

532
00:20:42,330 --> 00:20:47,250
environment and you'll see<font color="#E5E5E5"> that there</font>

533
00:20:45,419 --> 00:20:48,929
are often dozens of cases of these

534
00:20:47,250 --> 00:20:58,289
<font color="#CCCCCC">source connections in</font><font color="#E5E5E5"> a pen test if you</font>

535
00:20:48,929 --> 00:20:59,340
<font color="#E5E5E5">can tease out that that data so next</font>

536
00:20:58,289 --> 00:21:01,919
scenario is a little bit different this

537
00:20:59,340 --> 00:21:04,500
one's not not a PCI example we do mostly

538
00:21:01,919 --> 00:21:06,059
pci but we do a little bit not this

539
00:21:04,500 --> 00:21:07,890
situation we're working with<font color="#E5E5E5"> the product</font>

540
00:21:06,059 --> 00:21:10,250
company that's concerned about public

541
00:21:07,890 --> 00:21:13,230
leaks about new new products coming up

542
00:21:10,250 --> 00:21:16,110
and so instead<font color="#E5E5E5"> of looking</font><font color="#CCCCCC"> for those you</font>

543
00:21:13,230 --> 00:21:18,179
know cool 16 digit numbers what we're

544
00:21:16,110 --> 00:21:19,830
really looking<font color="#E5E5E5"> for here is you know</font>

545
00:21:18,179 --> 00:21:22,440
finding the<font color="#E5E5E5"> marketing assets for</font>

546
00:21:19,830 --> 00:21:23,639
unreleased products this is it messes up

547
00:21:22,440 --> 00:21:24,960
a product company quite a bit because

548
00:21:23,640 --> 00:21:26,399
you might<font color="#E5E5E5"> get somebody who decides I'm</font>

549
00:21:24,960 --> 00:21:27,720
not going to buy the current round of

550
00:21:26,399 --> 00:21:29,340
stuff because<font color="#E5E5E5"> I know the next things</font>

551
00:21:27,720 --> 00:21:31,440
coming out messes up the sales

552
00:21:29,340 --> 00:21:34,529
projections causes real problems for

553
00:21:31,440 --> 00:21:37,020
them<font color="#E5E5E5"> I figured that with this not being</font>

554
00:21:34,529 --> 00:21:38,429
necessarily a PCI segmentation problem I

555
00:21:37,020 --> 00:21:40,559
thought there's probably not going to be

556
00:21:38,429 --> 00:21:42,270
<font color="#E5E5E5">a substantial segmentation boundary is</font>

557
00:21:40,559 --> 00:21:44,428
protecting that kind of information I

558
00:21:42,270 --> 00:21:47,610
<font color="#E5E5E5">should just be able and to do the the</font>

559
00:21:44,429 --> 00:21:50,100
regular exploit escalade post exploit

560
00:21:47,610 --> 00:21:51,539
find the thing and<font color="#E5E5E5"> then I'm done and I</font>

561
00:21:50,100 --> 00:21:54,600
don't know about<font color="#CCCCCC"> you but</font><font color="#E5E5E5"> I attends to</font>

562
00:21:51,539 --> 00:21:58,020
kind of overly romanticize my job so I

563
00:21:54,600 --> 00:22:00,090
think of pen testing<font color="#E5E5E5"> and network as some</font>

564
00:21:58,020 --> 00:22:03,320
sort of medieval conquer the world

565
00:22:00,090 --> 00:22:06,418
scenario yes I I figured this company is

566
00:22:03,320 --> 00:22:08,279
as some some chunk of the world and it

567
00:22:06,419 --> 00:22:09,659
breaks up<font color="#E5E5E5"> into little fiefdom and then</font>

568
00:22:08,279 --> 00:22:10,940
within those you've got towns and

569
00:22:09,659 --> 00:22:12,899
Hamlet's and if I can just find

570
00:22:10,940 --> 00:22:15,179
ultimately the keys to the entire

571
00:22:12,899 --> 00:22:17,039
kingdom then I'll<font color="#CCCCCC"> just go to the part</font>

572
00:22:15,179 --> 00:22:19,919
where the marketing people live and

573
00:22:17,039 --> 00:22:21,450
bada-bing bada-boom and so it's doing

574
00:22:19,919 --> 00:22:22,919
also if we're talking<font color="#E5E5E5"> about before</font><font color="#CCCCCC"> I'd</font>

575
00:22:21,450 --> 00:22:23,370
<font color="#E5E5E5">gone through the file sharers found</font>

576
00:22:22,919 --> 00:22:25,080
nothing

577
00:22:23,370 --> 00:22:27,000
I went<font color="#E5E5E5"> through all the the net stats</font>

578
00:22:25,080 --> 00:22:28,500
didn't find anything that wasn't like

579
00:22:27,000 --> 00:22:30,090
something that's not the domain or

580
00:22:28,500 --> 00:22:32,430
something<font color="#CCCCCC"> interesting that I might be</font>

581
00:22:30,090 --> 00:22:34,559
able to jump over to and I'm<font color="#E5E5E5"> getting to</font>

582
00:22:32,430 --> 00:22:36,750
that that<font color="#CCCCCC"> 11th hour and just starting to</font>

583
00:22:34,559 --> 00:22:38,639
<font color="#E5E5E5">think oh now this is this was supposed</font>

584
00:22:36,750 --> 00:22:40,530
to be an easy assessment this doesn't

585
00:22:38,640 --> 00:22:42,330
<font color="#E5E5E5">have any really substantial boundaries I</font>

586
00:22:40,530 --> 00:22:45,360
<font color="#E5E5E5">don't understand why I can't find these</font>

587
00:22:42,330 --> 00:22:47,370
files and as I<font color="#CCCCCC"> was saying before a</font><font color="#E5E5E5"> pen</font>

588
00:22:45,360 --> 00:22:49,320
<font color="#E5E5E5">test have an objective sure I can hack</font>

589
00:22:47,370 --> 00:22:50,429
some stuff<font color="#E5E5E5"> but if i can't find were</font>

590
00:22:49,320 --> 00:22:52,530
these things<font color="#CCCCCC"> that they're concerned</font>

591
00:22:50,430 --> 00:22:54,180
about protecting our then maybe they're

592
00:22:52,530 --> 00:22:56,340
pretty protected and then<font color="#E5E5E5"> i start to</font>

593
00:22:54,180 --> 00:22:59,880
look like<font color="#E5E5E5"> I don't have success criteria</font>

594
00:22:56,340 --> 00:23:01,709
for my pen test one of the things<font color="#CCCCCC"> I had</font>

595
00:22:59,880 --> 00:23:03,690
gotten along the way I think<font color="#E5E5E5"> at the time</font>

596
00:23:01,710 --> 00:23:05,820
what<font color="#E5E5E5"> I was doing is trying to figure</font><font color="#CCCCCC"> out</font>

597
00:23:03,690 --> 00:23:08,400
you know what defensive suites are they

598
00:23:05,820 --> 00:23:10,470
using I'd collected a listing of running

599
00:23:08,400 --> 00:23:13,590
services on all the systems in the

600
00:23:10,470 --> 00:23:15,450
<font color="#E5E5E5">domain now so this listing</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see</font>

601
00:23:13,590 --> 00:23:17,100
here we've got a variety of services

602
00:23:15,450 --> 00:23:19,440
running yeah<font color="#E5E5E5"> this is just for one</font>

603
00:23:17,100 --> 00:23:20,820
particular IP I have you know a thousand

604
00:23:19,440 --> 00:23:23,820
or a<font color="#E5E5E5"> couple thousand of these whatever</font>

605
00:23:20,820 --> 00:23:24,809
it is and I thought well I'll just<font color="#E5E5E5"> start</font>

606
00:23:23,820 --> 00:23:27,300
looking in there maybe there's something

607
00:23:24,809 --> 00:23:29,220
interesting so first thing I did is<font color="#CCCCCC"> just</font>

608
00:23:27,300 --> 00:23:31,139
a<font color="#E5E5E5"> quick visualization you can see you</font>

609
00:23:29,220 --> 00:23:33,900
know some services show up everywhere

610
00:23:31,140 --> 00:23:35,580
every system has you know the

611
00:23:33,900 --> 00:23:37,710
workstation service or the<font color="#E5E5E5"> server</font>

612
00:23:35,580 --> 00:23:39,960
service or something<font color="#E5E5E5"> like that but then</font>

613
00:23:37,710 --> 00:23:43,559
sometimes there are some others that<font color="#CCCCCC"> are</font>

614
00:23:39,960 --> 00:23:45,420
much less common down here so these are

615
00:23:43,559 --> 00:23:47,399
<font color="#CCCCCC">the ones where and there's only</font><font color="#E5E5E5"> one</font>

616
00:23:45,420 --> 00:23:49,470
<font color="#E5E5E5">system that has this service that's</font>

617
00:23:47,400 --> 00:23:52,470
going to be like the guy with the nvidia

618
00:23:49,470 --> 00:23:53,880
card or the guy with the HP or something

619
00:23:52,470 --> 00:23:55,530
like that right they're gonna have some

620
00:23:53,880 --> 00:23:57,540
special<font color="#CCCCCC"> hardware some special drivers</font>

621
00:23:55,530 --> 00:23:58,950
and<font color="#E5E5E5"> I started thinking you know I bet in</font>

622
00:23:57,540 --> 00:24:00,420
this company there's going to be a group

623
00:23:58,950 --> 00:24:02,309
that puts together these marketing

624
00:24:00,420 --> 00:24:04,260
assets it's going<font color="#E5E5E5"> to be a team</font><font color="#CCCCCC"> of people</font>

625
00:24:02,309 --> 00:24:05,970
it's going to be I<font color="#E5E5E5"> don't know you know</font>

626
00:24:04,260 --> 00:24:07,800
<font color="#E5E5E5">five to ten people something like that</font>

627
00:24:05,970 --> 00:24:09,330
<font color="#CCCCCC">just guessing based on size a company I</font>

628
00:24:07,800 --> 00:24:10,530
thought these would be the<font color="#E5E5E5"> ones that are</font>

629
00:24:09,330 --> 00:24:12,480
most interesting maybe<font color="#E5E5E5"> there's some</font>

630
00:24:10,530 --> 00:24:15,750
distinctive feature here that may lead

631
00:24:12,480 --> 00:24:16,980
me to my objective and so as I refill

632
00:24:15,750 --> 00:24:18,990
true the data pulled out all the ones

633
00:24:16,980 --> 00:24:21,929
that just show up five to<font color="#CCCCCC"> twenty times</font>

634
00:24:18,990 --> 00:24:23,929
or so I noticed that other 12 boxes

635
00:24:21,929 --> 00:24:27,179
running the solidworks<font color="#E5E5E5"> Licensing Service</font>

636
00:24:23,929 --> 00:24:28,980
anybody know it solid work says yeah So

637
00:24:27,179 --> 00:24:31,320
Solid Works is slightly too expensive

638
00:24:28,980 --> 00:24:33,810
for me to have it<font color="#E5E5E5"> but I wish I</font><font color="#CCCCCC"> did it's</font>

639
00:24:31,320 --> 00:24:34,639
a 3d<font color="#CCCCCC"> modelling package since I got my 3d</font>

640
00:24:33,810 --> 00:24:37,220
printer I do

641
00:24:34,640 --> 00:24:39,740
like solidworks and I thought you know I

642
00:24:37,220 --> 00:24:42,680
bet<font color="#E5E5E5"> their new products have CAD models</font>

643
00:24:39,740 --> 00:24:44,690
so somebody is a cad designer and

644
00:24:42,680 --> 00:24:46,910
they're putting these things together<font color="#E5E5E5"> so</font>

645
00:24:44,690 --> 00:24:49,280
now<font color="#CCCCCC"> I have those 12 systems instead of</font>

646
00:24:46,910 --> 00:24:50,810
looking at a thousand boxes and trying

647
00:24:49,280 --> 00:24:53,780
to guess where stuff is and<font color="#E5E5E5"> just</font>

648
00:24:50,810 --> 00:24:55,760
flailing about like mad now I<font color="#E5E5E5"> have a</font>

649
00:24:53,780 --> 00:24:57,500
specific target people that are

650
00:24:55,760 --> 00:25:00,260
interesting or more interesting<font color="#CCCCCC"> than</font>

651
00:24:57,500 --> 00:25:01,730
other systems on the network so look at

652
00:25:00,260 --> 00:25:03,200
their system and I find out why I never

653
00:25:01,730 --> 00:25:04,970
found any<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this stuff on the file</font>

654
00:25:03,200 --> 00:25:07,190
shares and that is because they don't

655
00:25:04,970 --> 00:25:08,690
use the file shares most companies this

656
00:25:07,190 --> 00:25:09,620
<font color="#E5E5E5">would be a policy violation probably</font>

657
00:25:08,690 --> 00:25:12,410
because they're putting everything on

658
00:25:09,620 --> 00:25:14,929
there c drive but that gets me the<font color="#E5E5E5"> cad</font>

659
00:25:12,410 --> 00:25:17,510
models for the new products<font color="#E5E5E5"> and i have</font>

660
00:25:14,930 --> 00:25:19,010
my success criteria and<font color="#E5E5E5"> i finished that</font>

661
00:25:17,510 --> 00:25:20,540
up and<font color="#E5E5E5"> i thought wow that was really fun</font>

662
00:25:19,010 --> 00:25:22,340
pen test you know<font color="#CCCCCC"> i just had</font><font color="#E5E5E5"> that kind</font>

663
00:25:20,540 --> 00:25:24,590
<font color="#CCCCCC">of lucky stroke there at the last minute</font>

664
00:25:22,340 --> 00:25:26,360
but then I<font color="#E5E5E5"> started to realize how often</font>

665
00:25:24,590 --> 00:25:29,240
I could have done something similar in

666
00:25:26,360 --> 00:25:32,179
other pen tests how often<font color="#CCCCCC"> can i find</font>

667
00:25:29,240 --> 00:25:35,540
some sort of idiosyncratic data point

668
00:25:32,180 --> 00:25:36,980
that illustrates or brings out the fact

669
00:25:35,540 --> 00:25:39,470
that some groups of systems are

670
00:25:36,980 --> 00:25:41,570
different from others<font color="#CCCCCC"> so I started to</font>

671
00:25:39,470 --> 00:25:45,140
think through now as part of my modus

672
00:25:41,570 --> 00:25:47,060
operandi I need to have a<font color="#E5E5E5"> a bevy of</font>

673
00:25:45,140 --> 00:25:48,890
different distinctive features I look

674
00:25:47,060 --> 00:25:50,810
for things that will help me categorize

675
00:25:48,890 --> 00:25:52,850
the network because I've<font color="#E5E5E5"> only got three</font>

676
00:25:50,810 --> 00:25:54,500
<font color="#CCCCCC">days I've only got a week or whatever it</font>

677
00:25:52,850 --> 00:25:57,439
<font color="#E5E5E5">is to do this assessment</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I've got to</font>

678
00:25:54,500 --> 00:25:59,870
understand<font color="#E5E5E5"> 4,300 machines by the end of</font>

679
00:25:57,440 --> 00:26:01,700
this week so you start seeing these

680
00:25:59,870 --> 00:26:03,469
things everywhere like what if I had a

681
00:26:01,700 --> 00:26:05,660
listing of all the network interfaces on

682
00:26:03,470 --> 00:26:07,760
all the systems in<font color="#CCCCCC"> the domain well the</font>

683
00:26:05,660 --> 00:26:09,410
guy that has that<font color="#E5E5E5"> one VPN or the guy</font>

684
00:26:07,760 --> 00:26:10,940
that has two cards and<font color="#E5E5E5"> he's still home</font>

685
00:26:09,410 --> 00:26:13,970
din to the CDE or something like that

686
00:26:10,940 --> 00:26:15,580
<font color="#E5E5E5">and those show up pretty quick yeah or</font>

687
00:26:13,970 --> 00:26:18,860
what if I had a list of all the

688
00:26:15,580 --> 00:26:20,389
processes running everywhere and you

689
00:26:18,860 --> 00:26:23,000
find really interesting stuff<font color="#CCCCCC"> there or</font>

690
00:26:20,390 --> 00:26:25,640
you know every system that has a cisco

691
00:26:23,000 --> 00:26:27,230
directory in program files<font color="#CCCCCC"> that's a</font>

692
00:26:25,640 --> 00:26:28,640
distinct as a distinctive feature you

693
00:26:27,230 --> 00:26:31,520
can easily scan for is just a shell

694
00:26:28,640 --> 00:26:33,350
script away but that helped me one time

695
00:26:31,520 --> 00:26:35,810
I had an<font color="#CCCCCC"> environment with tens of</font>

696
00:26:33,350 --> 00:26:37,790
thousands<font color="#E5E5E5"> of users but only 300 people</font>

697
00:26:35,810 --> 00:26:40,129
had a cisco directory those are<font color="#E5E5E5"> the ones</font>

698
00:26:37,790 --> 00:26:42,950
with VPNs and some of those VPN to the

699
00:26:40,130 --> 00:26:44,900
CDE so now I<font color="#E5E5E5"> can focus my attack I get</font>

700
00:26:42,950 --> 00:26:46,820
there a lot faster instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> having to</font>

701
00:26:44,900 --> 00:26:48,740
you know it's all a keylogger on

702
00:26:46,820 --> 00:26:50,840
four thousand machines and fry my box

703
00:26:48,740 --> 00:26:52,970
and<font color="#E5E5E5"> probably take somebody off now I can</font>

704
00:26:50,840 --> 00:26:55,158
focus on those specific targets and it

705
00:26:52,970 --> 00:26:57,529
leads me to the jewels so think of this

706
00:26:55,159 --> 00:26:59,059
<font color="#E5E5E5">not so much as yeah Oh neat you could</font>

707
00:26:57,529 --> 00:27:01,009
look<font color="#CCCCCC"> at services and that leads</font>

708
00:26:59,059 --> 00:27:02,899
somewhere it's not<font color="#E5E5E5"> just</font><font color="#CCCCCC"> about services</font>

709
00:27:01,009 --> 00:27:05,360
it's the thought process where you say I

710
00:27:02,899 --> 00:27:08,000
must find some data point that with my

711
00:27:05,360 --> 00:27:10,189
current<font color="#E5E5E5"> network</font><font color="#CCCCCC"> position I can collect</font>

712
00:27:08,000 --> 00:27:12,049
<font color="#E5E5E5">from the network that may help me</font>

713
00:27:10,190 --> 00:27:13,519
discriminate between different groups of

714
00:27:12,049 --> 00:27:16,549
systems and find the ones that are most

715
00:27:13,519 --> 00:27:18,769
interesting and this<font color="#E5E5E5"> is all it's not</font>

716
00:27:16,549 --> 00:27:21,559
exploitative there's there's nothing

717
00:27:18,769 --> 00:27:24,320
exploit<font color="#CCCCCC"> avula</font><font color="#E5E5E5"> a list of processes on</font>

718
00:27:21,559 --> 00:27:26,330
assistive that's not hacking or is it

719
00:27:24,320 --> 00:27:28,730
because<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> just using that i'm</font><font color="#CCCCCC"> using</font>

720
00:27:26,330 --> 00:27:31,129
the computer yeah in a way that maybe

721
00:27:28,730 --> 00:27:33,049
wasn't anticipated and so no one's ever

722
00:27:31,129 --> 00:27:34,399
going to patch that as long<font color="#E5E5E5"> as</font><font color="#CCCCCC"> I got</font><font color="#E5E5E5"> the</font>

723
00:27:33,049 --> 00:27:40,340
creds now I've got a way to<font color="#E5E5E5"> move through</font>

724
00:27:34,399 --> 00:27:42,110
the network fast so next scenario is it

725
00:27:40,340 --> 00:27:44,269
is kind<font color="#E5E5E5"> of fun I think we made a couple</font>

726
00:27:42,110 --> 00:27:45,830
references to it the idea already there

727
00:27:44,269 --> 00:27:47,509
are<font color="#E5E5E5"> certain eternal vulnerabilities</font>

728
00:27:45,830 --> 00:27:49,370
there are these these attack

729
00:27:47,509 --> 00:27:53,179
opportunities that will never go away

730
00:27:49,370 --> 00:27:55,699
because<font color="#E5E5E5"> either they depend on something</font>

731
00:27:53,179 --> 00:27:57,649
<font color="#CCCCCC">that no one's responsible for so like if</font>

732
00:27:55,700 --> 00:27:59,809
if it isn't a vendor's fault there will

733
00:27:57,649 --> 00:28:01,820
never be a patch right so like dumb

734
00:27:59,809 --> 00:28:03,259
passwords is an eternal vulnerability if

735
00:28:01,820 --> 00:28:06,350
someone's always going to choose winter

736
00:28:03,259 --> 00:28:08,330
2016 and no one can no one will patch

737
00:28:06,350 --> 00:28:09,949
that you can solve it<font color="#E5E5E5"> with a filter but</font>

738
00:28:08,330 --> 00:28:12,590
that's apparently painful so nobody ever

739
00:28:09,950 --> 00:28:14,870
fixes it eternal vulnerability I will

740
00:28:12,590 --> 00:28:18,199
always<font color="#E5E5E5"> try to now this is another</font><font color="#CCCCCC"> one</font>

741
00:28:14,870 --> 00:28:20,299
that's kind of fun when the pen tester

742
00:28:18,200 --> 00:28:22,190
sees something like this you know it

743
00:28:20,299 --> 00:28:23,990
<font color="#CCCCCC">used to be especially earlier in my pen</font>

744
00:28:22,190 --> 00:28:25,759
testing career this would give<font color="#E5E5E5"> me extra</font>

745
00:28:23,990 --> 00:28:29,059
heartbeats because I'd be like you know

746
00:28:25,759 --> 00:28:30,429
it doesn't<font color="#CCCCCC"> really matter how advanced a</font>

747
00:28:29,059 --> 00:28:32,299
position I get in this network

748
00:28:30,429 --> 00:28:34,070
multi-factor<font color="#CCCCCC"> is just going</font><font color="#E5E5E5"> to shoot me</font>

749
00:28:32,299 --> 00:28:36,470
down because I can't get hold of that

750
00:28:34,070 --> 00:28:38,450
token that that guy has and this puts me

751
00:28:36,470 --> 00:28:41,059
<font color="#E5E5E5">in a position of failure from the very</font>

752
00:28:38,450 --> 00:28:42,259
beginning yeah but over time you start

753
00:28:41,059 --> 00:28:44,720
<font color="#CCCCCC">thinking about</font><font color="#E5E5E5"> the problem and like</font>

754
00:28:42,259 --> 00:28:46,309
patrick said there's no unassailable

755
00:28:44,720 --> 00:28:48,139
network there's<font color="#E5E5E5"> always going to be</font>

756
00:28:46,309 --> 00:28:49,730
something you can do even if it's

757
00:28:48,139 --> 00:28:51,289
<font color="#E5E5E5">something that was</font><font color="#CCCCCC"> outside the rules of</font>

758
00:28:49,730 --> 00:28:53,120
engagement we should be able to think<font color="#E5E5E5"> of</font>

759
00:28:51,289 --> 00:28:55,129
something<font color="#E5E5E5"> that could work anyway and</font>

760
00:28:53,120 --> 00:28:57,110
then we start thinking<font color="#E5E5E5"> well once we get</font>

761
00:28:55,129 --> 00:28:59,449
super creative we start figuring these

762
00:28:57,110 --> 00:29:01,279
things out can we fit these somehow in

763
00:28:59,450 --> 00:29:04,070
our process<font color="#CCCCCC"> can we do these in real time</font>

764
00:29:01,279 --> 00:29:05,690
during the pen test so a couple<font color="#E5E5E5"> years</font>

765
00:29:04,070 --> 00:29:07,010
ago I presented<font color="#E5E5E5"> a number of things that</font>

766
00:29:05,690 --> 00:29:08,480
<font color="#E5E5E5">we do to bypass multi-factor</font>

767
00:29:07,010 --> 00:29:10,730
authentication actually turns out to be

768
00:29:08,480 --> 00:29:13,370
a very fun problem it's a very

769
00:29:10,730 --> 00:29:15,980
compelling and the one I'm going to<font color="#E5E5E5"> talk</font>

770
00:29:13,370 --> 00:29:18,408
about today<font color="#E5E5E5"> is not those ones this one's</font>

771
00:29:15,980 --> 00:29:20,659
different didn't fit into that talk but

772
00:29:18,409 --> 00:29:22,580
and I actually find now I use this one

773
00:29:20,659 --> 00:29:24,830
more than any other if I have a

774
00:29:22,580 --> 00:29:27,439
situation where we're using a bastion

775
00:29:24,830 --> 00:29:29,000
host that's remote desktop and protected

776
00:29:27,440 --> 00:29:31,370
<font color="#CCCCCC">by multi-factor authentication and</font>

777
00:29:29,000 --> 00:29:32,870
that's how I<font color="#E5E5E5"> get into the sea de well</font>

778
00:29:31,370 --> 00:29:35,178
this<font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> my number one attacked</font>

779
00:29:32,870 --> 00:29:38,949
technique right now successful

780
00:29:35,179 --> 00:29:42,380
shockingly successful in many places and

781
00:29:38,950 --> 00:29:43,970
also very difficult to fix so in order

782
00:29:42,380 --> 00:29:46,700
to explain the scenario we're going to

783
00:29:43,970 --> 00:29:49,549
start with Bob yeah so<font color="#CCCCCC"> Bob is your</font>

784
00:29:46,700 --> 00:29:52,269
average mark one corporate employee Bob

785
00:29:49,549 --> 00:29:56,629
lives with the faceless masses in the

786
00:29:52,269 --> 00:30:00,169
infinite cube farm and he eats out his

787
00:29:56,630 --> 00:30:02,299
his existence and mostly ruled by harsh

788
00:30:00,169 --> 00:30:04,700
and unforgiving task mistress which is

789
00:30:02,299 --> 00:30:06,470
his outlet calendar I assume you guys

790
00:30:04,700 --> 00:30:08,330
have seen these before usually they're

791
00:30:06,470 --> 00:30:10,190
full of all kinds of meaningless

792
00:30:08,330 --> 00:30:12,970
meetings that just take up nothing but

793
00:30:10,190 --> 00:30:15,500
time occasionally you get the joy of

794
00:30:12,970 --> 00:30:17,210
eating you get to<font color="#E5E5E5"> go out at least once a</font>

795
00:30:15,500 --> 00:30:19,549
day try to stretch that two hour and a

796
00:30:17,210 --> 00:30:21,260
half if you can then you know

797
00:30:19,549 --> 00:30:22,970
occasionally you have to be social you

798
00:30:21,260 --> 00:30:25,490
have to talk with<font color="#CCCCCC"> the coworkers around</font>

799
00:30:22,970 --> 00:30:26,899
the break room or maybe you go go<font color="#E5E5E5"> get</font>

800
00:30:25,490 --> 00:30:28,159
the starbucks or something somewhere in

801
00:30:26,899 --> 00:30:31,639
the day and of<font color="#E5E5E5"> course there's the</font>

802
00:30:28,159 --> 00:30:33,919
biological imperative and this and this

803
00:30:31,639 --> 00:30:36,320
means if you think about<font color="#E5E5E5"> the</font><font color="#CCCCCC"> average</font>

804
00:30:33,919 --> 00:30:38,960
corporate employee that most of the time

805
00:30:36,320 --> 00:30:41,899
most of the day their screen looks like

806
00:30:38,960 --> 00:30:43,760
<font color="#E5E5E5">this</font><font color="#CCCCCC"> right and this is this is</font>

807
00:30:41,899 --> 00:30:45,918
uninteresting we<font color="#E5E5E5"> even think of this as a</font>

808
00:30:43,760 --> 00:30:49,279
security feature this is something<font color="#CCCCCC"> that</font>

809
00:30:45,919 --> 00:30:52,700
keeps bad guys<font color="#E5E5E5"> out but underneath this</font>

810
00:30:49,279 --> 00:30:55,399
screen if I could only get past it is an

811
00:30:52,700 --> 00:30:59,269
already logged in remote desktop<font color="#E5E5E5"> session</font>

812
00:30:55,399 --> 00:31:01,010
to the CDE if I can get into this then I

813
00:30:59,269 --> 00:31:03,080
get my success criteria I get an

814
00:31:01,010 --> 00:31:04,610
interactive session right so I start

815
00:31:03,080 --> 00:31:06,678
<font color="#CCCCCC">thinking about well what am I going to</font>

816
00:31:04,610 --> 00:31:09,949
<font color="#E5E5E5">do I mean wait until Bob doesn't go to</font>

817
00:31:06,679 --> 00:31:12,960
the CD he<font color="#E5E5E5"> washe</font><font color="#CCCCCC"> Rona's screen locks</font><font color="#E5E5E5"> Mimi</font>

818
00:31:09,950 --> 00:31:15,690
<font color="#CCCCCC">Katz's</font><font color="#E5E5E5"> password right or key log it</font>

819
00:31:12,960 --> 00:31:17,580
along the<font color="#CCCCCC"> way and then I'll rdp to his</font>

820
00:31:15,690 --> 00:31:19,919
desktop and I'll steal this session

821
00:31:17,580 --> 00:31:21,870
right I find some way to persist in the

822
00:31:19,919 --> 00:31:23,669
CDE maybe it's through DNS I think we're

823
00:31:21,870 --> 00:31:26,129
talking<font color="#E5E5E5"> about</font><font color="#CCCCCC"> that earlier I can tunnel</font>

824
00:31:23,669 --> 00:31:27,659
that out or maybe ICMP or maybe the CDE

825
00:31:26,130 --> 00:31:29,309
can talk back out to me or talk<font color="#CCCCCC"> to the</font>

826
00:31:27,659 --> 00:31:30,570
<font color="#CCCCCC">Internet I'll find something taking</font>

827
00:31:29,309 --> 00:31:32,490
about five or ten minutes figure that

828
00:31:30,570 --> 00:31:37,110
out and<font color="#CCCCCC"> then I don't ever</font><font color="#E5E5E5"> have to do mfa</font>

829
00:31:32,490 --> 00:31:40,289
again I'm all set so as<font color="#CCCCCC"> a common theme</font>

830
00:31:37,110 --> 00:31:42,658
if we're in a small<font color="#CCCCCC"> network this is</font><font color="#E5E5E5"> easy</font>

831
00:31:40,289 --> 00:31:44,940
to<font color="#E5E5E5"> do but it's also really low yield</font>

832
00:31:42,659 --> 00:31:46,980
because we might only have a couple

833
00:31:44,940 --> 00:31:50,070
users that actually access this crown

834
00:31:46,980 --> 00:31:52,010
jewel environment so that means I gotta

835
00:31:50,070 --> 00:31:55,110
hope it happens at least once this week

836
00:31:52,010 --> 00:31:57,529
maybe maybe it isn't so likely but this

837
00:31:55,110 --> 00:32:00,928
is a fun attack method because as the

838
00:31:57,529 --> 00:32:04,110
<font color="#E5E5E5">environment scales the probabilities</font>

839
00:32:00,929 --> 00:32:06,210
start to change and so we might have

840
00:32:04,110 --> 00:32:07,408
hundreds of targets in a big company or

841
00:32:06,210 --> 00:32:09,390
some places we might<font color="#E5E5E5"> actually have</font>

842
00:32:07,409 --> 00:32:11,130
thousands of people that are regularly

843
00:32:09,390 --> 00:32:14,159
interacting with the crown jewels own

844
00:32:11,130 --> 00:32:15,899
and if I can only find this specific

845
00:32:14,159 --> 00:32:19,380
moment relevant to one of those sessions

846
00:32:15,899 --> 00:32:21,510
that I win so when we're looking<font color="#E5E5E5"> at it</font>

847
00:32:19,380 --> 00:32:23,580
this is really and we're<font color="#E5E5E5"> just playing</font>

848
00:32:21,510 --> 00:32:26,190
the numbers here if you've got<font color="#E5E5E5"> enough</font>

849
00:32:23,580 --> 00:32:28,830
people then this small subset of people

850
00:32:26,190 --> 00:32:32,520
that are currently lock screens on top

851
00:32:28,830 --> 00:32:34,678
of active sessions to the CDE then I can

852
00:32:32,520 --> 00:32:36,510
execute this attack right so the point

853
00:32:34,679 --> 00:32:39,870
<font color="#E5E5E5">being as the network grows in size a</font>

854
00:32:36,510 --> 00:32:42,480
<font color="#E5E5E5">little black shaded area approaches a</font>

855
00:32:39,870 --> 00:32:45,629
probability<font color="#CCCCCC"> of one that it exists in the</font>

856
00:32:42,480 --> 00:32:48,000
network so the challenge is we<font color="#E5E5E5"> need to</font>

857
00:32:45,630 --> 00:32:49,529
find people with lock screens if you

858
00:32:48,000 --> 00:32:51,450
search on<font color="#E5E5E5"> Stack Overflow they'll say</font><font color="#CCCCCC"> Oh</font>

859
00:32:49,529 --> 00:32:53,549
use this function in this dll blah blah

860
00:32:51,450 --> 00:32:55,470
<font color="#CCCCCC">blah</font><font color="#E5E5E5"> I have to put some sort of payload</font>

861
00:32:53,549 --> 00:32:57,510
on the system and then I'm thinking<font color="#CCCCCC"> then</font>

862
00:32:55,470 --> 00:32:59,640
I have to<font color="#E5E5E5"> bypass</font><font color="#CCCCCC"> the Navy I hope they</font>

863
00:32:57,510 --> 00:33:03,240
don't have<font color="#E5E5E5"> some sandboxing bit9 will</font>

864
00:32:59,640 --> 00:33:05,789
drive me nuts and that's<font color="#CCCCCC"> really hard and</font>

865
00:33:03,240 --> 00:33:07,200
I'm a hacker right so hackers don't do

866
00:33:05,789 --> 00:33:09,990
hard stuff on purpose they do fun stuff

867
00:33:07,200 --> 00:33:11,490
on purpose and so the easy way is

868
00:33:09,990 --> 00:33:14,159
something I<font color="#E5E5E5"> already talked about and</font>

869
00:33:11,490 --> 00:33:15,990
that is<font color="#E5E5E5"> I just need</font><font color="#CCCCCC"> to know when log on</font>

870
00:33:14,159 --> 00:33:17,250
you i dot exe is running because it

871
00:33:15,990 --> 00:33:20,760
happens that every time your screen is

872
00:33:17,250 --> 00:33:22,559
locked that process exists so now i<font color="#CCCCCC"> have</font>

873
00:33:20,760 --> 00:33:24,389
the<font color="#E5E5E5"> Civil</font><font color="#CCCCCC"> 4-step attack I find</font>

874
00:33:22,559 --> 00:33:25,158
connections to the target<font color="#CCCCCC"> zone we do</font>

875
00:33:24,389 --> 00:33:26,779
have

876
00:33:25,159 --> 00:33:28,519
whispering like Patrick is talking about

877
00:33:26,779 --> 00:33:30,619
<font color="#CCCCCC">earlier I find all</font><font color="#E5E5E5"> the people with lock</font>

878
00:33:28,519 --> 00:33:32,450
screens<font color="#CCCCCC"> that I just</font><font color="#E5E5E5"> do it</font><font color="#CCCCCC"> a song about</font>

879
00:33:30,619 --> 00:33:34,519
in the previous scenario to pull a list

880
00:33:32,450 --> 00:33:37,840
of all the running processes I use the

881
00:33:34,519 --> 00:33:39,710
the super lead hacking tool grep to

882
00:33:37,840 --> 00:33:42,470
calculate the intersection those two

883
00:33:39,710 --> 00:33:45,320
sets and then i use the also equally

884
00:33:42,470 --> 00:33:47,299
leet hacking tool remote desktop to

885
00:33:45,320 --> 00:33:49,580
connect to it right so think about this

886
00:33:47,299 --> 00:33:51,349
<font color="#E5E5E5">all i have is creds i found some way to</font>

887
00:33:49,580 --> 00:33:53,359
escalate and then the rest of<font color="#E5E5E5"> what</font><font color="#CCCCCC"> i'm</font>

888
00:33:51,349 --> 00:33:55,999
doing is really system administration is

889
00:33:53,359 --> 00:33:58,009
post exploitation but it's<font color="#E5E5E5"> not really</font>

890
00:33:55,999 --> 00:34:00,619
hacking per se and there's<font color="#CCCCCC"> nothing here</font>

891
00:33:58,009 --> 00:34:02,289
that anybody can patch without making

892
00:34:00,619 --> 00:34:05,988
their network unadmitted straight able

893
00:34:02,289 --> 00:34:08,210
so once<font color="#E5E5E5"> I do this I get my list I've got</font>

894
00:34:05,989 --> 00:34:10,099
you know at any given time what happens

895
00:34:08,210 --> 00:34:11,960
<font color="#CCCCCC">is</font><font color="#E5E5E5"> I'll put this all together into a</font>

896
00:34:10,099 --> 00:34:13,609
shell script and<font color="#E5E5E5"> I'll just run it and at</font>

897
00:34:11,960 --> 00:34:16,760
any time<font color="#E5E5E5"> through</font><font color="#CCCCCC"> the day it'll come back</font>

898
00:34:13,609 --> 00:34:19,699
with 25 you know seven<font color="#E5E5E5"> IPS or something</font>

899
00:34:16,760 --> 00:34:24,349
like that those are currently attackable

900
00:34:19,699 --> 00:34:26,569
entry points into the CDE now one of the

901
00:34:24,349 --> 00:34:28,639
objections there's some delicacy to the

902
00:34:26,569 --> 00:34:31,399
attack right it's<font color="#E5E5E5"> not it's not just a</font>

903
00:34:28,639 --> 00:34:32,929
fire-and-forget but probably the biggest

904
00:34:31,399 --> 00:34:34,969
objection I've heard from people is

905
00:34:32,929 --> 00:34:37,250
they'll say that you know baby bear will

906
00:34:34,969 --> 00:34:39,288
come back<font color="#E5E5E5"> to his computer and see that</font>

907
00:34:37,250 --> 00:34:40,699
someone's been<font color="#E5E5E5"> sleeping in his bed right</font>

908
00:34:39,289 --> 00:34:42,559
though they'll unlock their screen and

909
00:34:40,699 --> 00:34:44,598
see all these scary windows up that he'd

910
00:34:42,559 --> 00:34:46,309
never seen before<font color="#E5E5E5"> or you know we</font><font color="#CCCCCC"> won't</font>

911
00:34:44,599 --> 00:34:48,500
see the mouse moving but you know along

912
00:34:46,309 --> 00:34:50,299
those lines and then the jig is up and

913
00:34:48,500 --> 00:34:52,010
I'm gonna<font color="#E5E5E5"> have to worry about you know</font>

914
00:34:50,299 --> 00:34:54,649
having<font color="#E5E5E5"> to burn all my bridges on my way</font>

915
00:34:52,010 --> 00:34:56,629
out<font color="#E5E5E5"> and it's actually not really</font><font color="#CCCCCC"> a</font>

916
00:34:54,649 --> 00:34:59,299
concern at all because as I had started

917
00:34:56,629 --> 00:35:01,940
<font color="#E5E5E5">this scenario there's one piece of</font>

918
00:34:59,299 --> 00:35:05,480
<font color="#E5E5E5">information I absolutely have about</font>

919
00:35:01,940 --> 00:35:06,740
Bob's day and that is his calendar and I

920
00:35:05,480 --> 00:35:08,270
know he's going<font color="#E5E5E5"> to be trapped in that</font>

921
00:35:06,740 --> 00:35:11,569
meeting let's change control meeting for

922
00:35:08,270 --> 00:35:13,700
an hour if I do this and<font color="#CCCCCC"> I see nothing</font>

923
00:35:11,569 --> 00:35:15,079
on the calendar it's<font color="#E5E5E5"> okay oh wait a few</font>

924
00:35:13,700 --> 00:35:17,089
minutes I'll find somebody else I'll try

925
00:35:15,079 --> 00:35:18,740
the second IP on the list it turns out

926
00:35:17,089 --> 00:35:20,869
that you can always find somebody where

927
00:35:18,740 --> 00:35:21,799
you can have reasonable confidence that

928
00:35:20,869 --> 00:35:23,359
they're<font color="#E5E5E5"> not going to be at their desk</font>

929
00:35:21,799 --> 00:35:25,910
for a little while and it only<font color="#E5E5E5"> takes you</font>

930
00:35:23,359 --> 00:35:26,930
five minutes<font color="#E5E5E5"> ten minutes max to tell</font>

931
00:35:25,910 --> 00:35:29,000
whether<font color="#E5E5E5"> you're going to have an easy</font>

932
00:35:26,930 --> 00:35:31,700
persistence vector on that box in the

933
00:35:29,000 --> 00:35:34,490
CDE and then you're like<font color="#CCCCCC"> your</font><font color="#E5E5E5"> one agent</font>

934
00:35:31,700 --> 00:35:36,169
away from a persistent pivot then you're

935
00:35:34,490 --> 00:35:38,069
swimming in the sea de network scanning

936
00:35:36,170 --> 00:35:39,240
stuff and probably having too

937
00:35:38,070 --> 00:35:43,560
tell them so that you don't bring down

938
00:35:39,240 --> 00:35:46,500
the CDE during your desk right so this<font color="#CCCCCC"> I</font>

939
00:35:43,560 --> 00:35:48,450
think is<font color="#E5E5E5"> really fun like I said it's my</font>

940
00:35:46,500 --> 00:35:49,920
number<font color="#CCCCCC"> one technique now for mfa just</font>

941
00:35:48,450 --> 00:35:53,189
because it's so dumb<font color="#E5E5E5"> I can't believe it</font>

942
00:35:49,920 --> 00:35:54,930
works but it's also really safe and<font color="#CCCCCC"> very</font>

943
00:35:53,190 --> 00:35:56,960
reliable and it kind of doesn't go away

944
00:35:54,930 --> 00:35:59,339
if<font color="#E5E5E5"> you're using rdp as a bastion host</font>

945
00:35:56,960 --> 00:36:00,450
protocol you got to think about<font color="#E5E5E5"> that</font>

946
00:35:59,340 --> 00:36:01,830
<font color="#E5E5E5">there a couple things you can do if</font>

947
00:36:00,450 --> 00:36:04,109
<font color="#E5E5E5">you're interested ask me afterwards I</font>

948
00:36:01,830 --> 00:36:12,270
want to use too terribly much time on it

949
00:36:04,110 --> 00:36:15,120
<font color="#CCCCCC">but there we go</font><font color="#E5E5E5"> alright so then the last</font>

950
00:36:12,270 --> 00:36:17,570
situation<font color="#E5E5E5"> I want to talk about is one</font>

951
00:36:15,120 --> 00:36:20,580
where maybe we've we've gained access

952
00:36:17,570 --> 00:36:22,110
but to really find the data<font color="#E5E5E5"> that we're</font>

953
00:36:20,580 --> 00:36:24,029
<font color="#CCCCCC">looking forward to be meaningful</font><font color="#E5E5E5"> for</font>

954
00:36:22,110 --> 00:36:25,230
success criteria we need to have a

955
00:36:24,030 --> 00:36:28,710
little<font color="#E5E5E5"> understanding of the business</font>

956
00:36:25,230 --> 00:36:31,140
<font color="#CCCCCC">process so</font><font color="#E5E5E5"> we talked a little bit</font>

957
00:36:28,710 --> 00:36:32,640
<font color="#E5E5E5">earlier about you know developing this</font>

958
00:36:31,140 --> 00:36:35,220
picture of the network and getting<font color="#E5E5E5"> a</font>

959
00:36:32,640 --> 00:36:37,259
little bit deeper understanding so in

960
00:36:35,220 --> 00:36:39,359
this situation or you know we've already

961
00:36:37,260 --> 00:36:41,160
gained domain administrator access let's

962
00:36:39,360 --> 00:36:43,800
say to the entire environment we've

963
00:36:41,160 --> 00:36:45,990
perhaps the customer has as two domains

964
00:36:43,800 --> 00:36:47,730
one for their high security networking

965
00:36:45,990 --> 00:36:49,350
one for their low we've gotten both of

966
00:36:47,730 --> 00:36:51,110
those we feel like we've got a full

967
00:36:49,350 --> 00:36:53,310
access maybe we have a bunch of

968
00:36:51,110 --> 00:36:54,990
meterpreter shell is open or whatever

969
00:36:53,310 --> 00:36:58,470
your post exploitation payload of

970
00:36:54,990 --> 00:37:00,930
choices whatever it is we know we've got

971
00:36:58,470 --> 00:37:03,120
<font color="#E5E5E5">the access but we can't find her data</font>

972
00:37:00,930 --> 00:37:05,399
we're looking so in a<font color="#CCCCCC"> pci pentest this</font>

973
00:37:03,120 --> 00:37:08,400
might be looking<font color="#CCCCCC"> for that cardholder</font>

974
00:37:05,400 --> 00:37:11,610
data we've poked around we can't find it

975
00:37:08,400 --> 00:37:14,070
<font color="#E5E5E5">but we do have the access we need so the</font>

976
00:37:11,610 --> 00:37:15,360
thought process then might become when

977
00:37:14,070 --> 00:37:17,610
<font color="#E5E5E5">you take a step back</font><font color="#CCCCCC"> and think about</font>

978
00:37:15,360 --> 00:37:19,230
<font color="#E5E5E5">okay we know that somebody somewhere in</font>

979
00:37:17,610 --> 00:37:21,540
this organization is looking at this

980
00:37:19,230 --> 00:37:23,040
data so we just<font color="#CCCCCC"> need to understand who</font>

981
00:37:21,540 --> 00:37:26,910
that might be and how we<font color="#CCCCCC"> can leverage</font>

982
00:37:23,040 --> 00:37:28,710
that so a couple pieces of information

983
00:37:26,910 --> 00:37:30,540
in them that that are useful and

984
00:37:28,710 --> 00:37:32,040
actually this is kind of jumping jumping

985
00:37:30,540 --> 00:37:33,600
off from

986
00:37:32,040 --> 00:37:35,250
talking<font color="#E5E5E5"> about before where we're trying</font>

987
00:37:33,600 --> 00:37:37,860
to<font color="#E5E5E5"> build a</font><font color="#CCCCCC"> clear picture by looking at</font>

988
00:37:35,250 --> 00:37:40,350
what's actually happening on on<font color="#CCCCCC"> our</font><font color="#E5E5E5"> host</font>

989
00:37:37,860 --> 00:37:45,570
so we looked at who's logged into each

990
00:37:40,350 --> 00:37:48,690
host we might look at what what user

991
00:37:45,570 --> 00:37:51,510
groups they belong to<font color="#E5E5E5"> an ad what group</font>

992
00:37:48,690 --> 00:37:53,010
membership they have and then we can

993
00:37:51,510 --> 00:37:55,680
also<font color="#E5E5E5"> look at an individual system</font>

994
00:37:53,010 --> 00:37:58,110
looking at what the processes are so so

995
00:37:55,680 --> 00:37:59,669
<font color="#CCCCCC">this becomes you know let's say</font><font color="#E5E5E5"> that we</font>

996
00:37:58,110 --> 00:38:01,500
don't don't understand a lot about what

997
00:37:59,670 --> 00:38:03,090
this how this client operates maybe

998
00:38:01,500 --> 00:38:04,290
throw their very large and they didn't

999
00:38:03,090 --> 00:38:06,660
tell<font color="#CCCCCC"> you very much in your and your</font>

1000
00:38:04,290 --> 00:38:09,210
kickoff meetings so we're trying<font color="#E5E5E5"> to</font>

1001
00:38:06,660 --> 00:38:10,589
<font color="#E5E5E5">build a better picture</font><font color="#CCCCCC"> of their</font>

1002
00:38:09,210 --> 00:38:13,950
processes about looking with actually

1003
00:38:10,590 --> 00:38:16,170
happening on their systems um so in this

1004
00:38:13,950 --> 00:38:18,390
situation my process becomes<font color="#E5E5E5"> okay who's</font>

1005
00:38:16,170 --> 00:38:20,430
logged<font color="#E5E5E5"> into what what groups they belong</font>

1006
00:38:18,390 --> 00:38:23,220
<font color="#CCCCCC">to and what processes are unique to</font>

1007
00:38:20,430 --> 00:38:26,640
those to the<font color="#E5E5E5"> systems to try to build</font>

1008
00:38:23,220 --> 00:38:29,399
that that clear picture in a large

1009
00:38:26,640 --> 00:38:31,140
network this becomes this<font color="#CCCCCC"> commedia sand</font>

1010
00:38:29,400 --> 00:38:33,090
and even with a<font color="#E5E5E5"> little bit of</font><font color="#CCCCCC"> AKI and</font>

1011
00:38:31,140 --> 00:38:34,200
gripping you might have a hard time

1012
00:38:33,090 --> 00:38:36,540
putting all these pieces of information

1013
00:38:34,200 --> 00:38:38,339
together that's when it might<font color="#E5E5E5"> be useful</font>

1014
00:38:36,540 --> 00:38:40,620
to turn this<font color="#CCCCCC"> into something that's a</font>

1015
00:38:38,340 --> 00:38:42,600
little bit<font color="#CCCCCC"> easier to</font><font color="#E5E5E5"> look at so maybe</font>

1016
00:38:40,620 --> 00:38:45,540
using a tool to convert this into

1017
00:38:42,600 --> 00:38:47,730
something like JSON and now we can apply

1018
00:38:45,540 --> 00:38:50,820
<font color="#CCCCCC">a little bit of a data science magic</font>

1019
00:38:47,730 --> 00:38:52,800
when we can turn this into something

1020
00:38:50,820 --> 00:38:54,870
that's a little<font color="#E5E5E5"> bit more meaningful so</font>

1021
00:38:52,800 --> 00:38:56,670
now we have<font color="#E5E5E5"> a graph of what users groups</font>

1022
00:38:54,870 --> 00:38:59,310
and processes are unique and how did

1023
00:38:56,670 --> 00:39:01,020
those group together especially in an

1024
00:38:59,310 --> 00:39:02,759
environment that's large where we have

1025
00:39:01,020 --> 00:39:04,590
lots of users and lots of different

1026
00:39:02,760 --> 00:39:06,660
groups<font color="#E5E5E5"> it becomes important to be able</font>

1027
00:39:04,590 --> 00:39:11,100
to identify how these things<font color="#CCCCCC"> were put</font>

1028
00:39:06,660 --> 00:39:12,390
together so in this situation we know

1029
00:39:11,100 --> 00:39:14,339
something about there's a marketing

1030
00:39:12,390 --> 00:39:16,950
department maybe some customer service

1031
00:39:14,340 --> 00:39:18,840
an IT department we want to know a

1032
00:39:16,950 --> 00:39:20,910
little bit more<font color="#E5E5E5"> about</font><font color="#CCCCCC"> how these things</font>

1033
00:39:18,840 --> 00:39:22,830
fit together so once we look at that

1034
00:39:20,910 --> 00:39:23,910
that data set now we can<font color="#E5E5E5"> break this down</font>

1035
00:39:22,830 --> 00:39:26,310
a little bit further<font color="#E5E5E5"> away it can</font>

1036
00:39:23,910 --> 00:39:28,109
<font color="#E5E5E5">identify which systems belong to each</font>

1037
00:39:26,310 --> 00:39:30,870
one<font color="#E5E5E5"> of these groups what</font><font color="#CCCCCC"> maybe what</font>

1038
00:39:28,110 --> 00:39:32,340
vlans<font color="#CCCCCC"> therein and now we can look at</font>

1039
00:39:30,870 --> 00:39:36,020
specifically what's going on which<font color="#CCCCCC"> of</font>

1040
00:39:32,340 --> 00:39:38,840
the<font color="#E5E5E5"> systems the first time I actually</font>

1041
00:39:36,020 --> 00:39:40,700
applied this one thing you know things

1042
00:39:38,840 --> 00:39:42,400
or whether<font color="#E5E5E5"> the</font><font color="#CCCCCC"> king became useful in</font>

1043
00:39:40,700 --> 00:39:44,919
analyzing their business<font color="#CCCCCC"> process is</font>

1044
00:39:42,400 --> 00:39:48,320
everybody<font color="#E5E5E5"> in the n-body in the</font>

1045
00:39:44,920 --> 00:39:50,750
environment<font color="#CCCCCC"> was using</font><font color="#E5E5E5"> google chrome</font>

1046
00:39:48,320 --> 00:39:53,240
which doesn't mean that<font color="#E5E5E5"> doesn't mean a</font>

1047
00:39:50,750 --> 00:39:55,520
lot except for<font color="#E5E5E5"> two groups are using</font>

1048
00:39:53,240 --> 00:39:57,080
<font color="#CCCCCC">Internet Explorer which seems kinda</font>

1049
00:39:55,520 --> 00:39:58,400
strange because everybody hates it<font color="#E5E5E5"> so</font>

1050
00:39:57,080 --> 00:40:01,819
there must be some reason<font color="#E5E5E5"> behind that</font>

1051
00:39:58,400 --> 00:40:04,310
and what<font color="#E5E5E5"> I found is looking at those</font>

1052
00:40:01,820 --> 00:40:06,500
groups that are customer service people

1053
00:40:04,310 --> 00:40:08,570
were using<font color="#E5E5E5"> Internet Explorer to access</font>

1054
00:40:06,500 --> 00:40:10,220
an application<font color="#E5E5E5"> the CDE and that was</font>

1055
00:40:08,570 --> 00:40:12,470
really handy because internet explorer

1056
00:40:10,220 --> 00:40:15,230
was cashing some of these the cardholder

1057
00:40:12,470 --> 00:40:17,540
data locally on the machine and using a

1058
00:40:15,230 --> 00:40:20,720
little CC search magic were able to find

1059
00:40:17,540 --> 00:40:22,910
that information so now we're<font color="#E5E5E5"> able to go</font>

1060
00:40:20,720 --> 00:40:25,310
from maybe something where we don't

1061
00:40:22,910 --> 00:40:26,390
<font color="#E5E5E5">really have a great success criteria we</font>

1062
00:40:25,310 --> 00:40:28,430
haven't<font color="#E5E5E5"> actually found the date of the</font>

1063
00:40:26,390 --> 00:40:29,690
were looking for to<font color="#E5E5E5"> identifying</font>

1064
00:40:28,430 --> 00:40:30,890
something that's really meaning for the

1065
00:40:29,690 --> 00:40:36,230
customer and<font color="#E5E5E5"> helping them straight</font>

1066
00:40:30,890 --> 00:40:37,910
environment so in<font color="#CCCCCC"> conclusion I think one</font>

1067
00:40:36,230 --> 00:40:40,130
of the things that Josh and<font color="#CCCCCC"> I really</font>

1068
00:40:37,910 --> 00:40:42,170
tried to hone in<font color="#CCCCCC"> on with what this is</font>

1069
00:40:40,130 --> 00:40:43,790
what<font color="#E5E5E5"> are our thought processes we've put</font>

1070
00:40:42,170 --> 00:40:46,430
a lot of<font color="#E5E5E5"> energy and trying to mimic the</font>

1071
00:40:43,790 --> 00:40:48,259
the bad guy we actually<font color="#E5E5E5"> want to think</font>

1072
00:40:46,430 --> 00:40:49,279
<font color="#CCCCCC">about how do</font><font color="#E5E5E5"> we move through an</font>

1073
00:40:48,260 --> 00:40:50,960
environment how r we're leveraging

1074
00:40:49,280 --> 00:40:53,360
things that are inherent to a system

1075
00:40:50,960 --> 00:40:56,530
that<font color="#E5E5E5"> that give us the access that we're</font>

1076
00:40:53,360 --> 00:41:00,050
looking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> turning those into</font>

1077
00:40:56,530 --> 00:41:02,090
discrete thought processes because I

1078
00:41:00,050 --> 00:41:04,520
think communicating this in a way that

1079
00:41:02,090 --> 00:41:06,560
<font color="#E5E5E5">that helps maybe other pen testers but</font>

1080
00:41:04,520 --> 00:41:07,880
also people on the defending side see

1081
00:41:06,560 --> 00:41:11,049
what are the things that<font color="#E5E5E5"> you're doing</font>

1082
00:41:07,880 --> 00:41:14,270
<font color="#E5E5E5">that are built into the network that may</font>

1083
00:41:11,050 --> 00:41:15,920
may<font color="#E5E5E5"> be useful to a bad guy or definitely</font>

1084
00:41:14,270 --> 00:41:18,620
<font color="#E5E5E5">useful to that the pen tester and where</font>

1085
00:41:15,920 --> 00:41:20,200
do those intersect excuse me and

1086
00:41:18,620 --> 00:41:22,640
hopefully each one of these sections<font color="#E5E5E5"> was</font>

1087
00:41:20,200 --> 00:41:23,839
reflective of those you<font color="#E5E5E5"> know each one of</font>

1088
00:41:22,640 --> 00:41:34,299
those thought processes we're trying to

1089
00:41:23,840 --> 00:41:38,319
get<font color="#E5E5E5"> across any questions so we're</font><font color="#CCCCCC"> doing</font>

1090
00:41:34,299 --> 00:41:41,439
little SMB scan I always<font color="#E5E5E5"> see that yeah</font>

1091
00:41:38,319 --> 00:41:43,929
it's it's not too hard second<font color="#E5E5E5"> for</font>

1092
00:41:41,439 --> 00:41:45,670
recording purposes<font color="#E5E5E5"> question is if we're</font>

1093
00:41:43,929 --> 00:41:48,160
SMB scanning like crazy on the network

1094
00:41:45,670 --> 00:41:49,569
yeah how does somebody detect that it

1095
00:41:48,160 --> 00:41:51,069
turns out it's not<font color="#E5E5E5"> too hard it's just</font>

1096
00:41:49,569 --> 00:41:53,189
<font color="#E5E5E5">something that most people don't monitor</font>

1097
00:41:51,069 --> 00:41:55,179
too well if you monitor authentication

1098
00:41:53,189 --> 00:41:57,489
velocity or authentication volume

1099
00:41:55,179 --> 00:41:59,130
essentially with whatever your sim or

1100
00:41:57,489 --> 00:42:01,989
monitoring environment looks like

1101
00:41:59,130 --> 00:42:03,849
that'll be a<font color="#E5E5E5"> good indicator and I think</font>

1102
00:42:01,989 --> 00:42:06,160
<font color="#CCCCCC">one of the best detective measures you</font>

1103
00:42:03,849 --> 00:42:08,799
can have is not so much having a bunch

1104
00:42:06,160 --> 00:42:10,239
<font color="#E5E5E5">of signatures that look for specific you</font>

1105
00:42:08,799 --> 00:42:12,429
know tools or exploit payloads or

1106
00:42:10,239 --> 00:42:15,819
something but if you just have<font color="#E5E5E5"> something</font>

1107
00:42:12,429 --> 00:42:17,979
that says our usual authentication

1108
00:42:15,819 --> 00:42:20,799
behavior in the<font color="#E5E5E5"> network looks like this</font>

1109
00:42:17,979 --> 00:42:23,259
it's this level<font color="#E5E5E5"> and then one</font><font color="#CCCCCC"> day it's</font>

1110
00:42:20,799 --> 00:42:30,880
like 10 times that somebody's doing

1111
00:42:23,259 --> 00:42:35,319
something really weird yeah the users

1112
00:42:30,880 --> 00:42:37,809
login yeah now be aware<font color="#E5E5E5"> I mean so we're</font>

1113
00:42:35,319 --> 00:42:39,729
<font color="#CCCCCC">doing this as a professional service</font>

1114
00:42:37,809 --> 00:42:41,529
we're there for one or<font color="#CCCCCC"> two weeks or</font>

1115
00:42:39,729 --> 00:42:43,718
something so we're<font color="#E5E5E5"> going to do it super</font>

1116
00:42:41,529 --> 00:42:46,089
fast there's no there's no waiting in

1117
00:42:43,719 --> 00:42:48,009
between now if somebody's casing the

1118
00:42:46,089 --> 00:42:50,439
environment in more malicious scenario

1119
00:42:48,009 --> 00:42:52,209
the main way to keep from<font color="#CCCCCC"> being detected</font>

1120
00:42:50,439 --> 00:42:53,890
is going to be to slow it down probably

1121
00:42:52,209 --> 00:42:56,410
use a lot<font color="#CCCCCC"> of different</font><font color="#E5E5E5"> source points and</font>

1122
00:42:53,890 --> 00:42:58,749
find some way to make<font color="#CCCCCC"> it look as close</font>

1123
00:42:56,410 --> 00:43:01,868
to regular authentication as possible I

1124
00:42:58,749 --> 00:43:05,529
have actually seen a couple suggestions

1125
00:43:01,869 --> 00:43:08,829
for it's not<font color="#CCCCCC"> a honeypot per se but that</font>

1126
00:43:05,529 --> 00:43:10,779
you you deploy it's not quite a honeypot

1127
00:43:08,829 --> 00:43:12,789
but it's similar yeah the idea that you

1128
00:43:10,779 --> 00:43:16,199
have a<font color="#E5E5E5"> certain account or a certain</font>

1129
00:43:12,789 --> 00:43:19,420
system that is literally not used yeah

1130
00:43:16,199 --> 00:43:21,160
specifically I see this log with right

1131
00:43:19,420 --> 00:43:23,019
everyone a user whatever it's going to

1132
00:43:21,160 --> 00:43:25,660
be and that way you can<font color="#CCCCCC"> even configure</font>

1133
00:43:23,019 --> 00:43:27,578
specific specific rules if anything ever

1134
00:43:25,660 --> 00:43:29,678
enumerates all the shares off this

1135
00:43:27,579 --> 00:43:32,499
system then somebody's scanning because

1136
00:43:29,679 --> 00:43:33,880
nobody uses that system for anything so

1137
00:43:32,499 --> 00:43:35,709
some of those are kind<font color="#E5E5E5"> of fun thoughts</font>

1138
00:43:33,880 --> 00:43:37,089
to play with I think<font color="#E5E5E5"> I think you have to</font>

1139
00:43:35,709 --> 00:43:39,189
be you have to<font color="#CCCCCC"> be fairly mature</font>

1140
00:43:37,089 --> 00:43:40,660
industrially speaking to be at the level

1141
00:43:39,189 --> 00:43:43,899
where you<font color="#E5E5E5"> can start playing around with</font>

1142
00:43:40,660 --> 00:43:47,060
those kinds of detection methods

1143
00:43:43,900 --> 00:43:49,130
raspberry PI's with SMB shares<font color="#E5E5E5"> at an</font>

1144
00:43:47,060 --> 00:43:51,049
awful bitch just to see if<font color="#E5E5E5"> somebody scan</font>

1145
00:43:49,130 --> 00:43:53,060
for us to be yeah it's a red canary

1146
00:43:51,050 --> 00:43:55,250
right there yeah perfect yeah the other

1147
00:43:53,060 --> 00:43:57,020
one i've seen is like LM and r and<font color="#CCCCCC"> n</font><font color="#E5E5E5"> B</font>

1148
00:43:55,250 --> 00:43:59,690
<font color="#E5E5E5">and s everybody's favorite you know</font>

1149
00:43:57,020 --> 00:44:02,750
infrared risk vulnerabilities if you

1150
00:43:59,690 --> 00:44:07,040
have a system that logs in across the

1151
00:44:02,750 --> 00:44:09,560
<font color="#CCCCCC">network with a disabled account but if</font>

1152
00:44:07,040 --> 00:44:11,630
you ever<font color="#E5E5E5"> see somebody an IP other than</font>

1153
00:44:09,560 --> 00:44:13,250
that one authenticate with that account

1154
00:44:11,630 --> 00:44:14,930
then you<font color="#E5E5E5"> know for sure somebody is</font>

1155
00:44:13,250 --> 00:44:16,880
<font color="#CCCCCC">man-in-the-middle</font><font color="#E5E5E5"> Inge there your</font>

1156
00:44:14,930 --> 00:44:18,500
proxying those connections or their SMB

1157
00:44:16,880 --> 00:44:20,690
relaying or something<font color="#CCCCCC"> interesting with</font>

1158
00:44:18,500 --> 00:44:34,330
that because no one can use<font color="#E5E5E5"> that account</font>

1159
00:44:20,690 --> 00:44:34,330
so yeah there's mystic things there yeah

1160
00:44:37,200 --> 00:44:43,270
and<font color="#E5E5E5"> users are able to go so if it's so</font>

1161
00:44:41,080 --> 00:44:45,400
prevalent so always<font color="#CCCCCC"> bails</font><font color="#E5E5E5"> are always use</font>

1162
00:44:43,270 --> 00:44:47,670
<font color="#CCCCCC">it successfully when you're done with</font>

1163
00:44:45,400 --> 00:44:52,030
<font color="#E5E5E5">your assessment are you telling lies</font>

1164
00:44:47,670 --> 00:44:54,060
yeah so we do a couple things one is you

1165
00:44:52,030 --> 00:44:56,830
have to make sure<font color="#E5E5E5"> that your screen lock</font>

1166
00:44:54,060 --> 00:44:58,690
policies are the same and on in the

1167
00:44:56,830 --> 00:45:00,730
secured zone as they are inside or maybe

1168
00:44:58,690 --> 00:45:02,890
slightly more aggressive that way if the

1169
00:45:00,730 --> 00:45:04,360
screen locks on this side then it's

1170
00:45:02,890 --> 00:45:07,120
guaranteed that the remote desktop

1171
00:45:04,360 --> 00:45:08,830
session has already locked right another

1172
00:45:07,120 --> 00:45:10,330
one would<font color="#CCCCCC"> be that you</font><font color="#E5E5E5"> require a</font>

1173
00:45:08,830 --> 00:45:12,520
multi-factor to unlock the screen

1174
00:45:10,330 --> 00:45:14,650
occasionally some people say oh is so

1175
00:45:12,520 --> 00:45:17,500
inconvenient<font color="#CCCCCC"> f2 MFA to unlock the screen</font>

1176
00:45:14,650 --> 00:45:19,360
it will just be MFA to log in but you

1177
00:45:17,500 --> 00:45:21,580
don't<font color="#CCCCCC"> mfa to unlock that's really bad</font>

1178
00:45:19,360 --> 00:45:23,650
idea the other one is to start thinking

1179
00:45:21,580 --> 00:45:26,319
<font color="#E5E5E5">about what does somebody need in order</font>

1180
00:45:23,650 --> 00:45:28,630
to carry this out<font color="#CCCCCC"> I need to have remote</font>

1181
00:45:26,320 --> 00:45:31,270
code execution probably on that<font color="#CCCCCC"> system</font>

1182
00:45:28,630 --> 00:45:33,010
and these days we live in an era where

1183
00:45:31,270 --> 00:45:36,130
there's no reason you can't turn the

1184
00:45:33,010 --> 00:45:37,810
firewall on on a<font color="#CCCCCC"> Windows client it still</font>

1185
00:45:36,130 --> 00:45:40,240
boggles my mind how many conversations I

1186
00:45:37,810 --> 00:45:41,290
have with implementers that where they

1187
00:45:40,240 --> 00:45:42,700
say oh we can't turn the firewall on

1188
00:45:41,290 --> 00:45:43,930
because something will break it's like

1189
00:45:42,700 --> 00:45:46,419
now your domain will work fine

1190
00:45:43,930 --> 00:45:47,830
<font color="#E5E5E5">everything's a pull like your system</font>

1191
00:45:46,420 --> 00:45:50,140
goes to the domain controller for<font color="#E5E5E5"> the</font>

1192
00:45:47,830 --> 00:45:52,960
gps it goes to the AV system to pull

1193
00:45:50,140 --> 00:45:56,740
<font color="#E5E5E5">down debts right so it turns out if you</font>

1194
00:45:52,960 --> 00:45:58,720
firewall the the workstation well then

1195
00:45:56,740 --> 00:46:01,930
you force me to<font color="#E5E5E5"> do something elaborate</font>

1196
00:45:58,720 --> 00:46:03,580
to get rce on that box right so now<font color="#CCCCCC"> I</font>

1197
00:46:01,930 --> 00:46:06,399
have to do things like change the logon

1198
00:46:03,580 --> 00:46:07,779
script well you can detect<font color="#E5E5E5"> when someone</font>

1199
00:46:06,400 --> 00:46:09,340
changes your logon scripts you could

1200
00:46:07,780 --> 00:46:12,430
monitor the records in<font color="#CCCCCC"> the directory or</font>

1201
00:46:09,340 --> 00:46:14,320
you can monitor files to netlogon etc or

1202
00:46:12,430 --> 00:46:16,029
you make me do things like change<font color="#CCCCCC"> GPOs</font>

1203
00:46:14,320 --> 00:46:17,530
<font color="#CCCCCC">I'm going to use the task scheduler or</font>

1204
00:46:16,030 --> 00:46:19,690
something in the domain to run something

1205
00:46:17,530 --> 00:46:21,640
on that firewall box so if you start

1206
00:46:19,690 --> 00:46:23,980
thinking<font color="#CCCCCC"> about multi layering your</font>

1207
00:46:21,640 --> 00:46:25,480
workstation environment and in a lot of

1208
00:46:23,980 --> 00:46:28,060
cases because we're looking at<font color="#E5E5E5"> PCI</font>

1209
00:46:25,480 --> 00:46:29,710
scenario so you might have 10,000

1210
00:46:28,060 --> 00:46:31,630
<font color="#E5E5E5">employees but only 300 of them have to</font>

1211
00:46:29,710 --> 00:46:33,880
access<font color="#CCCCCC"> the CDE so that's only</font><font color="#E5E5E5"> 300</font>

1212
00:46:31,630 --> 00:46:37,320
workstations that you have to armor so

1213
00:46:33,880 --> 00:46:37,320
you can attack it a<font color="#E5E5E5"> few different</font><font color="#CCCCCC"> ways</font>

1214
00:46:39,079 --> 00:46:52,890
anything else going<font color="#CCCCCC"> on</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> make what I'm</font>

1215
00:46:46,680 --> 00:46:54,509
sorry yeah yeah you can also train

1216
00:46:52,890 --> 00:46:56,368
people like it<font color="#CCCCCC"> really should be the</font>

1217
00:46:54,510 --> 00:46:58,619
procedure to close your CD window when

1218
00:46:56,369 --> 00:47:02,070
you get up just<font color="#E5E5E5"> like you train people to</font>

1219
00:46:58,619 --> 00:47:03,510
lock screens kind of works but

1220
00:47:02,070 --> 00:47:05,250
<font color="#E5E5E5">unfortunately those are the scenarios</font>

1221
00:47:03,510 --> 00:47:06,990
where it's like the passwords again all

1222
00:47:05,250 --> 00:47:08,670
but two of the users in your<font color="#E5E5E5"> network</font>

1223
00:47:06,990 --> 00:47:10,470
might choose good passwords but it says

1224
00:47:08,670 --> 00:47:12,930
remaining<font color="#E5E5E5"> two that bring the whole</font>

1225
00:47:10,470 --> 00:47:15,029
network down right so relying on on

1226
00:47:12,930 --> 00:47:17,160
training is difficult but if you can

1227
00:47:15,030 --> 00:47:21,270
automate killing that idle session

1228
00:47:17,160 --> 00:47:23,549
that's cool also application

1229
00:47:21,270 --> 00:47:25,230
whitelisting you know those kinds of

1230
00:47:23,550 --> 00:47:27,089
<font color="#E5E5E5">things are real handy because it makes</font>

1231
00:47:25,230 --> 00:47:30,710
it hard for me to to do my post

1232
00:47:27,089 --> 00:47:32,970
exploitative things on your<font color="#E5E5E5"> system but</font>

1233
00:47:30,710 --> 00:47:34,440
before<font color="#E5E5E5"> we left ankle on oh I thank our</font>

1234
00:47:32,970 --> 00:47:36,118
speakers here<font color="#E5E5E5"> we have a new gifts for</font>

1235
00:47:34,440 --> 00:47:38,790
our speakers<font color="#E5E5E5"> were on a college campus at</font>

1236
00:47:36,119 --> 00:47:41,130
some flavored water so you<font color="#CCCCCC"> can fight</font>

1237
00:47:38,790 --> 00:47:42,300
<font color="#CCCCCC">over this pineapple and strawberry and</font>

1238
00:47:41,130 --> 00:47:48,319
you probably want<font color="#E5E5E5"> to fly with</font><font color="#CCCCCC"> it because</font>

1239
00:47:42,300 --> 00:47:48,319
<font color="#CCCCCC">it's a it sets on Freddie</font>

