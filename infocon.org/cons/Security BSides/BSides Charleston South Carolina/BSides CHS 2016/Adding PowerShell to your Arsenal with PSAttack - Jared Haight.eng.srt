1
00:00:16,570 --> 00:00:21,430
<font color="#E5E5E5">alright so this is a incorporating</font>

2
00:00:19,480 --> 00:00:25,060
PowerShell into your arsenal with PS

3
00:00:21,430 --> 00:00:26,830
check my name is Jared hey I'm a

4
00:00:25,060 --> 00:00:29,950
security<font color="#E5E5E5"> engineer with a company called</font>

5
00:00:26,830 --> 00:00:33,129
Gotham digital science we're a pen

6
00:00:29,950 --> 00:00:35,769
testing firm here in the US when I am

7
00:00:33,129 --> 00:00:37,420
<font color="#E5E5E5">not staring at</font><font color="#CCCCCC"> a computer I enjoy going</font>

8
00:00:35,769 --> 00:00:41,170
out into the woods and getting as far

9
00:00:37,420 --> 00:00:43,330
away from technology as possible I'm the

10
00:00:41,170 --> 00:00:46,030
co-owner of the most adorable dog on

11
00:00:43,330 --> 00:00:48,430
face the<font color="#CCCCCC"> earth his name is Eli and he</font>

12
00:00:46,030 --> 00:00:50,739
has no sense personal space and<font color="#E5E5E5"> a really</font>

13
00:00:48,430 --> 00:00:52,809
<font color="#E5E5E5">adorable underbite and that is kind of</font>

14
00:00:50,739 --> 00:00:56,019
led<font color="#CCCCCC"> to it is he has no concept of what</font>

15
00:00:52,809 --> 00:00:57,610
the words like<font color="#E5E5E5"> no or bad mean because</font><font color="#CCCCCC"> he</font>

16
00:00:56,020 --> 00:01:00,309
just likes he with<font color="#E5E5E5"> that underbite and</font>

17
00:00:57,610 --> 00:01:02,769
it's<font color="#E5E5E5"> like all</font><font color="#CCCCCC"> right whatever you can go</font>

18
00:01:00,309 --> 00:01:04,030
back<font color="#CCCCCC"> to eating bunny poop or digging</font>

19
00:01:02,770 --> 00:01:06,700
through the trash or whatever you were

20
00:01:04,030 --> 00:01:09,220
doing speaking of bunny poop i also own

21
00:01:06,700 --> 00:01:11,710
a really adorable bunny his name is

22
00:01:09,220 --> 00:01:14,229
bruiser and he had<font color="#E5E5E5"> a really bad night a</font>

23
00:01:11,710 --> 00:01:17,440
couple not a year ago a<font color="#E5E5E5"> little bit over</font>

24
00:01:14,229 --> 00:01:19,990
a year ago and now his head<font color="#E5E5E5"> stuck like</font>

25
00:01:17,440 --> 00:01:21,520
that he had a medical<font color="#CCCCCC"> issue that has</font>

26
00:01:19,990 --> 00:01:23,740
basically led to his head being

27
00:01:21,520 --> 00:01:25,479
permanently tilted so he walks around

28
00:01:23,740 --> 00:01:30,548
looking really adorable and really

29
00:01:25,479 --> 00:01:35,170
curious all the time so let's go ahead

30
00:01:30,549 --> 00:01:37,590
and grab power show<font color="#E5E5E5"> for it</font><font color="#CCCCCC"> Herschel's</font>

31
00:01:35,170 --> 00:01:40,810
gotten a ton of attention in the last

32
00:01:37,590 --> 00:01:42,850
you know couple years<font color="#CCCCCC"> to to the</font><font color="#E5E5E5"> three</font>

33
00:01:40,810 --> 00:01:45,610
years I really has picked up<font color="#E5E5E5"> a lot of</font>

34
00:01:42,850 --> 00:01:47,610
attention a lot about<font color="#E5E5E5"> chatter basically</font>

35
00:01:45,610 --> 00:01:50,229
<font color="#E5E5E5">PowerShell is this command line</font>

36
00:01:47,610 --> 00:01:53,320
scripting language that Microsoft came

37
00:01:50,229 --> 00:01:55,390
up with it's just celebrated its 10-year

38
00:01:53,320 --> 00:01:59,139
anniversary it's been around<font color="#E5E5E5"> since 2006</font>

39
00:01:55,390 --> 00:02:01,270
and it's a scripting language that

40
00:01:59,140 --> 00:02:04,810
microsoft created to make managing

41
00:02:01,270 --> 00:02:06,850
<font color="#E5E5E5">windows easier and so what they did is</font>

42
00:02:04,810 --> 00:02:08,860
they built it on top of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> net</font>

43
00:02:06,850 --> 00:02:12,760
framework which is already this very

44
00:02:08,860 --> 00:02:15,150
robust<font color="#E5E5E5"> api framework that developers can</font>

45
00:02:12,760 --> 00:02:17,950
leverage they built it into this and

46
00:02:15,150 --> 00:02:20,440
basically as part of that it gains

47
00:02:17,950 --> 00:02:21,690
access to really all the existing

48
00:02:20,440 --> 00:02:22,920
windows management

49
00:02:21,690 --> 00:02:25,980
in<font color="#E5E5E5"> Japan players that you might already</font>

50
00:02:22,920 --> 00:02:28,410
be familiar with wmi calm stuff like

51
00:02:25,980 --> 00:02:30,570
that so it's a very very<font color="#E5E5E5"> powerful</font>

52
00:02:28,410 --> 00:02:32,790
language ties in with all<font color="#E5E5E5"> Microsoft's</font>

53
00:02:30,570 --> 00:02:34,680
existing api's very<font color="#CCCCCC"> well-thought-out</font>

54
00:02:32,790 --> 00:02:39,269
language there<font color="#CCCCCC"> is a reason why it's</font>

55
00:02:34,680 --> 00:02:41,550
gotten such positive vibe lately what

56
00:02:39,270 --> 00:02:44,070
makes it really cool is being a

57
00:02:41,550 --> 00:02:46,080
relatively modern language<font color="#CCCCCC"> microsoft was</font>

58
00:02:44,070 --> 00:02:47,609
able to kind<font color="#E5E5E5"> of look at the existing</font>

59
00:02:46,080 --> 00:02:49,860
scripting languages that were out there

60
00:02:47,610 --> 00:02:52,320
and figure out what worked what could be

61
00:02:49,860 --> 00:02:55,080
improved upon and that led<font color="#E5E5E5"> them to make</font>

62
00:02:52,320 --> 00:02:58,320
some really<font color="#E5E5E5"> interesting very very</font><font color="#CCCCCC"> good</font>

63
00:02:55,080 --> 00:03:00,150
conventions one of the things which a

64
00:02:58,320 --> 00:03:03,060
lot of people hate about parishes it's

65
00:03:00,150 --> 00:03:05,970
very verbose so all the commands in

66
00:03:03,060 --> 00:03:08,520
<font color="#CCCCCC">PowerShell have a verb noun syntax and</font>

67
00:03:05,970 --> 00:03:10,380
while that is very verbose it also makes

68
00:03:08,520 --> 00:03:13,110
it really easy to understand what<font color="#E5E5E5"> you're</font>

69
00:03:10,380 --> 00:03:15,900
working with you know if you're<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font>

70
00:03:13,110 --> 00:03:19,170
set the content of a file<font color="#E5E5E5"> with the set</font>

71
00:03:15,900 --> 00:03:21,180
content content command 'let you can

72
00:03:19,170 --> 00:03:23,130
kind of figure out<font color="#E5E5E5"> that get content is</font>

73
00:03:21,180 --> 00:03:24,540
what's going<font color="#E5E5E5"> to read the content of a</font>

74
00:03:23,130 --> 00:03:26,970
file so it makes it really easy once you

75
00:03:24,540 --> 00:03:29,010
get used to<font color="#E5E5E5"> those verbs kind of makes it</font>

76
00:03:26,970 --> 00:03:31,020
easy to approach PowerShell and really

77
00:03:29,010 --> 00:03:33,410
quickly get<font color="#CCCCCC"> up to speed and start doing</font>

78
00:03:31,020 --> 00:03:36,360
some interesting<font color="#E5E5E5"> stuff with the</font><font color="#CCCCCC"> language</font>

79
00:03:33,410 --> 00:03:39,180
the<font color="#CCCCCC"> other great thing is it's being a</font>

80
00:03:36,360 --> 00:03:41,790
language that was developed whole cloth

81
00:03:39,180 --> 00:03:43,830
by a single entity<font color="#E5E5E5"> they were able</font><font color="#CCCCCC"> to</font>

82
00:03:41,790 --> 00:03:47,640
implement conventions as far as

83
00:03:43,830 --> 00:03:50,940
parameters go so all of the hamlets in

84
00:03:47,640 --> 00:03:53,458
<font color="#E5E5E5">PowerShell use similar parameters if you</font>

85
00:03:50,940 --> 00:03:55,530
need to talk to a remote<font color="#CCCCCC"> computer that</font>

86
00:03:53,459 --> 00:03:57,239
is always<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> be the computer name</font>

87
00:03:55,530 --> 00:03:59,340
parameter no matter what command<font color="#E5E5E5"> what</font>

88
00:03:57,239 --> 00:04:01,380
you're actually working with real

89
00:03:59,340 --> 00:04:04,800
different from coming from like bash

90
00:04:01,380 --> 00:04:07,500
where you know said awk<font color="#CCCCCC"> creb all have</font>

91
00:04:04,800 --> 00:04:09,510
their own individual oops parameters and

92
00:04:07,500 --> 00:04:11,880
stuff like that you know<font color="#E5E5E5"> you have to</font>

93
00:04:09,510 --> 00:04:13,829
<font color="#CCCCCC">really do research on each individual</font>

94
00:04:11,880 --> 00:04:16,019
tool to figure out what you're trying to

95
00:04:13,830 --> 00:04:20,459
do powershell is a lot<font color="#CCCCCC"> more intuitive</font>

96
00:04:16,019 --> 00:04:23,070
that way the other great thing is they

97
00:04:20,459 --> 00:04:24,930
have a<font color="#E5E5E5"> they from the beginning</font><font color="#CCCCCC"> put a</font>

98
00:04:23,070 --> 00:04:26,340
heavy emphasis on their health system

99
00:04:24,930 --> 00:04:28,650
they have<font color="#E5E5E5"> a help system that's run</font>

100
00:04:26,340 --> 00:04:30,840
through its called get help and it's

101
00:04:28,650 --> 00:04:34,340
kind<font color="#CCCCCC"> of the equivalent of like Linux man</font>

102
00:04:30,840 --> 00:04:37,070
pages except the get help

103
00:04:34,340 --> 00:04:39,320
documentation was actually written<font color="#E5E5E5"> by</font>

104
00:04:37,070 --> 00:04:41,570
like normal sane people as opposed to

105
00:04:39,320 --> 00:04:43,669
like computer doctorates from like 20

106
00:04:41,570 --> 00:04:45,650
<font color="#E5E5E5">years ago that were programming and like</font>

107
00:04:43,669 --> 00:04:48,198
seein assembly and developing Linux

108
00:04:45,650 --> 00:04:49,969
tools from scratch github actually was

109
00:04:48,199 --> 00:04:51,800
written by like normal people who

110
00:04:49,970 --> 00:04:54,199
actually use these tools to administer

111
00:04:51,800 --> 00:04:56,360
systems so in a real change<font color="#E5E5E5"> of pace</font>

112
00:04:54,199 --> 00:04:59,020
<font color="#E5E5E5">Microsoft actually made a usable help</font>

113
00:04:56,360 --> 00:05:01,250
system which is greatly appreciated

114
00:04:59,020 --> 00:05:03,169
there's tab completion throughout the

115
00:05:01,250 --> 00:05:04,580
whole thing all the parameters lot of

116
00:05:03,169 --> 00:05:06,400
parameter values all the commandments

117
00:05:04,580 --> 00:05:10,370
everything you can just have complete

118
00:05:06,400 --> 00:05:12,830
super helpful and something<font color="#CCCCCC"> that's maybe</font>

119
00:05:10,370 --> 00:05:14,270
not as obvious of a benefit unless maybe

120
00:05:12,830 --> 00:05:16,810
you're you have a development background

121
00:05:14,270 --> 00:05:20,870
is<font color="#CCCCCC"> that power shell is an</font>

122
00:05:16,810 --> 00:05:24,110
<font color="#E5E5E5">object-oriented language so instead of</font>

123
00:05:20,870 --> 00:05:26,720
<font color="#E5E5E5">in Linux when you type you know you cat</font>

124
00:05:24,110 --> 00:05:28,880
something out you pipe it to grab you're

125
00:05:26,720 --> 00:05:30,560
taking a string of text and really

126
00:05:28,880 --> 00:05:32,180
whenever your piping commands in Linux

127
00:05:30,560 --> 00:05:34,940
you're always dealing with the string of

128
00:05:32,180 --> 00:05:38,240
texts ultimately with<font color="#E5E5E5"> PowerShell you're</font>

129
00:05:34,940 --> 00:05:41,870
actually dealing with objects so you can

130
00:05:38,240 --> 00:05:44,419
take a service<font color="#E5E5E5"> from get service and pipe</font>

131
00:05:41,870 --> 00:05:45,950
that to restart service and the restart

132
00:05:44,419 --> 00:05:47,750
service automatically<font color="#E5E5E5"> knows what to do</font>

133
00:05:45,950 --> 00:05:49,940
it knows<font color="#CCCCCC"> how to handle a service object</font>

134
00:05:47,750 --> 00:05:53,780
so really easy to<font color="#CCCCCC"> work with</font><font color="#E5E5E5"> very</font>

135
00:05:49,940 --> 00:05:56,300
powerful really cool<font color="#CCCCCC"> stuff there is some</font>

136
00:05:53,780 --> 00:05:58,388
I've gotten some pushback on calling

137
00:05:56,300 --> 00:06:00,950
PowerShell an object oriented language

138
00:05:58,389 --> 00:06:03,800
because I guess it doesn't fit the

139
00:06:00,950 --> 00:06:06,740
<font color="#E5E5E5">minutia details of</font><font color="#CCCCCC"> what makes an object</font>

140
00:06:03,800 --> 00:06:10,280
oriented language my background is I was

141
00:06:06,740 --> 00:06:13,099
a sysadmin for<font color="#CCCCCC"> 10-12</font><font color="#E5E5E5"> years before moving</font>

142
00:06:10,280 --> 00:06:16,130
into<font color="#CCCCCC"> infosec I don't have a development</font>

143
00:06:13,099 --> 00:06:18,770
background so looking at PowerShell you

144
00:06:16,130 --> 00:06:21,139
have objects and the language<font color="#E5E5E5"> seems to</font>

145
00:06:18,770 --> 00:06:22,789
deal a lot with said objects so as<font color="#E5E5E5"> far</font>

146
00:06:21,139 --> 00:06:27,289
as I'm concerned it's an<font color="#CCCCCC"> object-oriented</font>

147
00:06:22,789 --> 00:06:29,450
language so like I said right now it's

148
00:06:27,289 --> 00:06:33,320
being<font color="#E5E5E5"> used for a lot of administration</font>

149
00:06:29,450 --> 00:06:38,900
if you run exchange management console

150
00:06:33,320 --> 00:06:40,880
since 2008 I think the exchange

151
00:06:38,900 --> 00:06:42,320
management console is basically just a

152
00:06:40,880 --> 00:06:44,540
front end for<font color="#E5E5E5"> PowerShell it's</font>

153
00:06:42,320 --> 00:06:45,650
PowerShell commands in the background if

154
00:06:44,540 --> 00:06:47,390
you run<font color="#E5E5E5"> the new active directory</font>

155
00:06:45,650 --> 00:06:49,849
administrative<font color="#E5E5E5"> center which is the</font>

156
00:06:47,390 --> 00:06:52,280
replacement for a<font color="#E5E5E5"> doc users and</font>

157
00:06:49,850 --> 00:06:53,840
computers same thing it's a GUI that

158
00:06:52,280 --> 00:06:55,460
you're interacting with but you can

159
00:06:53,840 --> 00:06:57,409
actually toggle the tab and see all the

160
00:06:55,460 --> 00:06:59,719
PowerShell commands<font color="#E5E5E5"> that it's running in</font>

161
00:06:57,410 --> 00:07:02,090
the background so really Microsoft is

162
00:06:59,720 --> 00:07:04,970
pushing all of<font color="#E5E5E5"> their management to using</font>

163
00:07:02,090 --> 00:07:06,830
PowerShell it's used for a<font color="#E5E5E5"> lot of</font>

164
00:07:04,970 --> 00:07:09,200
automation so if you're<font color="#E5E5E5"> familiar with</font>

165
00:07:06,830 --> 00:07:10,820
puppet or chef microsoft recently

166
00:07:09,200 --> 00:07:12,890
started pushing out something called

167
00:07:10,820 --> 00:07:15,200
desired state config which is kind of

168
00:07:12,890 --> 00:07:18,490
their<font color="#E5E5E5"> take on systems automation and</font>

169
00:07:15,200 --> 00:07:22,030
it's all powered through powershell and

170
00:07:18,490 --> 00:07:24,560
it's because you have this modern

171
00:07:22,030 --> 00:07:26,929
<font color="#E5E5E5">network of where language that speaks</font>

172
00:07:24,560 --> 00:07:30,050
windows works you<font color="#E5E5E5"> know at scale really</font>

173
00:07:26,930 --> 00:07:32,060
<font color="#E5E5E5">well it's an excellent tool</font><font color="#CCCCCC"> for instant</font>

174
00:07:30,050 --> 00:07:34,700
response and blue teams because you have

175
00:07:32,060 --> 00:07:37,130
<font color="#CCCCCC">this you know language that makes it</font>

176
00:07:34,700 --> 00:07:39,080
really easy to query all the computers

177
00:07:37,130 --> 00:07:41,270
in<font color="#CCCCCC"> your environment for a specific</font><font color="#E5E5E5"> event</font>

178
00:07:39,080 --> 00:07:44,180
log or for the file contents or a hash

179
00:07:41,270 --> 00:07:46,120
of a<font color="#CCCCCC"> specific file so real easy</font><font color="#E5E5E5"> to work</font>

180
00:07:44,180 --> 00:07:50,390
with blue team's<font color="#E5E5E5"> really latched</font><font color="#CCCCCC"> onto it</font>

181
00:07:46,120 --> 00:07:52,010
I'm not a blue team<font color="#CCCCCC"> ur I'm</font><font color="#E5E5E5"> trying to</font>

182
00:07:50,390 --> 00:07:55,159
learn<font color="#CCCCCC"> as much as I can</font><font color="#E5E5E5"> but it's just not</font>

183
00:07:52,010 --> 00:07:56,960
<font color="#CCCCCC">my area of expertise if that's something</font>

184
00:07:55,160 --> 00:07:58,940
that you're into you want<font color="#CCCCCC"> to learn more</font>

185
00:07:56,960 --> 00:08:02,020
about PowerShell and I are I definitely

186
00:07:58,940 --> 00:08:04,910
suggest checking out invoke<font color="#E5E5E5"> dir comm</font>

187
00:08:02,020 --> 00:08:09,620
that's a site run by this guy named

188
00:08:04,910 --> 00:08:12,680
Jared Addison and really smart dude just

189
00:08:09,620 --> 00:08:15,800
really the last<font color="#E5E5E5"> time I checked his blog</font>

190
00:08:12,680 --> 00:08:17,840
he at a entry on like reading raw file

191
00:08:15,800 --> 00:08:20,060
tables using<font color="#E5E5E5"> PowerShell and stuff like</font>

192
00:08:17,840 --> 00:08:22,400
that and<font color="#E5E5E5"> like reconstructing mb ours and</font>

193
00:08:20,060 --> 00:08:24,050
stuff like<font color="#E5E5E5"> that dudes just crazy smart</font>

194
00:08:22,400 --> 00:08:27,080
so I definitely<font color="#E5E5E5"> suggest checking out his</font>

195
00:08:24,050 --> 00:08:29,800
site they do taking pictures to my right

196
00:08:27,080 --> 00:08:29,800
it's<font color="#E5E5E5"> kind of freaking me out</font>

197
00:08:30,510 --> 00:08:35,110
alright so we're red teamers right like

198
00:08:33,130 --> 00:08:36,820
that's great<font color="#E5E5E5"> we can administer stuff but</font>

199
00:08:35,110 --> 00:08:39,490
how do<font color="#E5E5E5"> we break things with</font><font color="#CCCCCC"> powershell</font>

200
00:08:36,820 --> 00:08:41,500
and why do<font color="#E5E5E5"> we want to use powershell to</font>

201
00:08:39,490 --> 00:08:44,650
break things why is everybody so excited

202
00:08:41,500 --> 00:08:47,380
about<font color="#E5E5E5"> this or scared so</font><font color="#CCCCCC"> PowerShell is</font>

203
00:08:44,650 --> 00:08:50,260
actually really hard to block because

204
00:08:47,380 --> 00:08:54,070
it's part<font color="#E5E5E5"> of the dotnet framework a lot</font>

205
00:08:50,260 --> 00:08:55,390
<font color="#E5E5E5">of</font><font color="#CCCCCC"> people a lot of</font><font color="#E5E5E5"> CISOs a lot of you</font>

206
00:08:54,070 --> 00:08:57,190
know<font color="#E5E5E5"> high tea departments they say like</font>

207
00:08:55,390 --> 00:08:59,110
oh my god<font color="#CCCCCC"> PowerShell is being used to</font>

208
00:08:57,190 --> 00:09:02,290
reckon pleat havoc how do we<font color="#E5E5E5"> stop</font>

209
00:08:59,110 --> 00:09:05,920
<font color="#E5E5E5">PowerShell and you really you really</font>

210
00:09:02,290 --> 00:09:09,160
can't at least<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> not easy because</font>

211
00:09:05,920 --> 00:09:11,410
it's actually<font color="#CCCCCC"> a dll with in.net so you</font>

212
00:09:09,160 --> 00:09:13,719
can block access to powershell dot exe

213
00:09:11,410 --> 00:09:15,969
you can blog access to like the script

214
00:09:13,720 --> 00:09:18,130
editor you're still<font color="#E5E5E5"> not going to block</font>

215
00:09:15,970 --> 00:09:20,230
the user's ability to run PowerShell

216
00:09:18,130 --> 00:09:23,410
commands as will kind of cover a little

217
00:09:20,230 --> 00:09:26,050
bit later there's also just<font color="#E5E5E5"> not a</font><font color="#CCCCCC"> lot of</font>

218
00:09:23,410 --> 00:09:27,790
awareness on the sysadmin side Microsoft

219
00:09:26,050 --> 00:09:31,150
despite you know pushing this for 10

220
00:09:27,790 --> 00:09:33,640
<font color="#E5E5E5">years sysadmin still want to point and</font>

221
00:09:31,150 --> 00:09:34,810
<font color="#E5E5E5">click at stuff windows admins at least</font>

222
00:09:33,640 --> 00:09:37,540
want to point<font color="#E5E5E5"> and click add stuff to</font>

223
00:09:34,810 --> 00:09:39,760
configure their windows boxes<font color="#E5E5E5"> I know</font>

224
00:09:37,540 --> 00:09:41,860
this<font color="#CCCCCC"> because I spent the last like four</font>

225
00:09:39,760 --> 00:09:44,050
years<font color="#E5E5E5"> of my career as a sysadmin telling</font>

226
00:09:41,860 --> 00:09:46,090
everybody like guys you need<font color="#E5E5E5"> to actually</font>

227
00:09:44,050 --> 00:09:47,770
learn how to type into a console

228
00:09:46,090 --> 00:09:50,950
else you're going<font color="#E5E5E5"> to be back at help</font>

229
00:09:47,770 --> 00:09:52,000
desk within<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> 10 years and nobody</font>

230
00:09:50,950 --> 00:09:53,650
would listen<font color="#E5E5E5"> to me and I would teach</font>

231
00:09:52,000 --> 00:09:55,090
classes and be like look<font color="#CCCCCC"> this is how</font>

232
00:09:53,650 --> 00:09:56,319
cool<font color="#E5E5E5"> PowerShell it is here's all the</font>

233
00:09:55,090 --> 00:09:58,120
cool stuff<font color="#E5E5E5"> I'm doing here with</font>

234
00:09:56,320 --> 00:09:59,680
PowerShell and that would<font color="#CCCCCC"> just kind of</font>

235
00:09:58,120 --> 00:10:01,420
lead to me writing PowerShell scripts

236
00:09:59,680 --> 00:10:04,599
for everybody else in the windows I you

237
00:10:01,420 --> 00:10:06,160
know systems admin department so windows

238
00:10:04,600 --> 00:10:07,930
<font color="#E5E5E5">has Edmonds they really really like</font>

239
00:10:06,160 --> 00:10:10,000
Mouse's and they're just<font color="#E5E5E5"> not aware of</font>

240
00:10:07,930 --> 00:10:12,130
what powershell can do they're not

241
00:10:10,000 --> 00:10:13,360
looking to block it they're not<font color="#E5E5E5"> they</font><font color="#CCCCCC"> are</font>

242
00:10:12,130 --> 00:10:18,130
not aware of how can bite them in the

243
00:10:13,360 --> 00:10:19,960
ass this is also<font color="#E5E5E5"> led because of this</font>

244
00:10:18,130 --> 00:10:21,610
kind of environment because PowerShell

245
00:10:19,960 --> 00:10:22,960
is so powerful and it's really<font color="#CCCCCC"> hard to</font>

246
00:10:21,610 --> 00:10:25,300
block and there's you know lack of

247
00:10:22,960 --> 00:10:27,730
awareness the info the red team the

248
00:10:25,300 --> 00:10:30,069
offensive security side of the community

249
00:10:27,730 --> 00:10:33,490
is really latched onto power show so a

250
00:10:30,070 --> 00:10:35,140
lot of really great developers have a

251
00:10:33,490 --> 00:10:36,910
kind<font color="#E5E5E5"> of latch on cheap our show and</font>

252
00:10:35,140 --> 00:10:39,280
<font color="#E5E5E5">they're doing</font><font color="#CCCCCC"> just incredible stuff</font>

253
00:10:36,910 --> 00:10:40,839
with it and what's great about the guys

254
00:10:39,280 --> 00:10:43,900
are really leading this charge is

255
00:10:40,840 --> 00:10:46,090
they're<font color="#E5E5E5"> very mature red teamers so they</font>

256
00:10:43,900 --> 00:10:50,500
have very mature methodologies and a big

257
00:10:46,090 --> 00:10:52,990
focus on being aware of data forensics

258
00:10:50,500 --> 00:10:54,610
and stuff like that<font color="#E5E5E5"> so there are tools</font>

259
00:10:52,990 --> 00:10:56,590
they'll make<font color="#CCCCCC"> sure they run in memory and</font>

260
00:10:54,610 --> 00:10:59,260
they don't leave a trace behind and you

261
00:10:56,590 --> 00:11:00,880
<font color="#CCCCCC">know stuff</font><font color="#E5E5E5"> like that they also bring</font>

262
00:10:59,260 --> 00:11:03,340
with them a lot of them have a heavy

263
00:11:00,880 --> 00:11:04,990
development background so they bring

264
00:11:03,340 --> 00:11:07,390
with them very mature development

265
00:11:04,990 --> 00:11:10,000
methodologies as well to the point<font color="#CCCCCC"> that</font>

266
00:11:07,390 --> 00:11:11,860
I really think a lot of<font color="#E5E5E5"> the PowerShell</font>

267
00:11:10,000 --> 00:11:14,080
scripts that the<font color="#E5E5E5"> offensive community has</font>

268
00:11:11,860 --> 00:11:16,030
put together they're really like the

269
00:11:14,080 --> 00:11:18,550
gold standard of like how anybody should

270
00:11:16,030 --> 00:11:21,069
write a powershell script get help

271
00:11:18,550 --> 00:11:23,439
totally works with most any offensive

272
00:11:21,070 --> 00:11:25,390
powershell script out there if you guys

273
00:11:23,440 --> 00:11:27,460
<font color="#E5E5E5">are familiar with invoke mimikatz that's</font>

274
00:11:25,390 --> 00:11:29,949
one of the like big powershell offensive

275
00:11:27,460 --> 00:11:31,990
scripts totally has a<font color="#E5E5E5"> man dog you know</font>

276
00:11:29,950 --> 00:11:34,750
associated with<font color="#E5E5E5"> they get help and see</font>

277
00:11:31,990 --> 00:11:36,610
how to use the command from the way it's

278
00:11:34,750 --> 00:11:38,800
actually structured like it's just a

279
00:11:36,610 --> 00:11:40,990
beautifully written script and it

280
00:11:38,800 --> 00:11:44,709
behaves exactly as you would expect a

281
00:11:40,990 --> 00:11:47,500
powershell script to behave so just a

282
00:11:44,710 --> 00:11:53,350
lot<font color="#E5E5E5"> of really good solid work on the red</font>

283
00:11:47,500 --> 00:11:55,300
team<font color="#E5E5E5"> PowerShell side but we've</font><font color="#CCCCCC"> been</font>

284
00:11:53,350 --> 00:11:58,660
talking about<font color="#E5E5E5"> PowerShell as a community</font>

285
00:11:55,300 --> 00:12:01,959
for years now and there is still a<font color="#CCCCCC"> lot</font>

286
00:11:58,660 --> 00:12:05,380
of you<font color="#CCCCCC"> know from</font><font color="#E5E5E5"> the offensive side</font><font color="#CCCCCC"> of</font>

287
00:12:01,960 --> 00:12:06,910
things like people<font color="#E5E5E5"> they they love their</font>

288
00:12:05,380 --> 00:12:08,680
<font color="#CCCCCC">python and their responder in their</font>

289
00:12:06,910 --> 00:12:12,640
<font color="#CCCCCC">metasploit and they don't</font><font color="#E5E5E5"> know what</font><font color="#CCCCCC"> to</font>

290
00:12:08,680 --> 00:12:14,829
do<font color="#CCCCCC"> if they got a</font><font color="#E5E5E5"> PowerShell console you</font>

291
00:12:12,640 --> 00:12:16,600
known on<font color="#CCCCCC"> the defensive side you still</font>

292
00:12:14,830 --> 00:12:19,630
have a lot of people<font color="#CCCCCC"> that</font><font color="#E5E5E5"> think</font><font color="#CCCCCC"> that the</font>

293
00:12:16,600 --> 00:12:21,670
best<font color="#E5E5E5"> way to resolve PowerShell is to try</font>

294
00:12:19,630 --> 00:12:24,970
to block it so there's just a lot of

295
00:12:21,670 --> 00:12:27,160
<font color="#E5E5E5">lack</font><font color="#CCCCCC"> of knowledge to powershell and i</font>

296
00:12:24,970 --> 00:12:30,220
think a large part of that comes<font color="#E5E5E5"> from</font>

297
00:12:27,160 --> 00:12:33,719
the<font color="#E5E5E5"> fact that it's still development on</font>

298
00:12:30,220 --> 00:12:36,490
<font color="#E5E5E5">windows is</font><font color="#CCCCCC"> not cool windows is not a</font>

299
00:12:33,720 --> 00:12:39,430
platform that people look to to develop

300
00:12:36,490 --> 00:12:40,830
on or use like to us red teamers windows

301
00:12:39,430 --> 00:12:42,689
is a target<font color="#E5E5E5"> it's not</font>

302
00:12:40,830 --> 00:12:45,000
something to be productive<font color="#E5E5E5"> on like</font>

303
00:12:42,690 --> 00:12:46,860
that's what linux is for<font color="#CCCCCC"> Windows is</font>

304
00:12:45,000 --> 00:12:48,720
there so we can<font color="#E5E5E5"> get da and then write a</font>

305
00:12:46,860 --> 00:12:53,760
pretty report about how we totally owned

306
00:12:48,720 --> 00:12:55,800
<font color="#CCCCCC">everybody and I</font><font color="#E5E5E5"> think Microsoft has</font>

307
00:12:53,760 --> 00:12:58,080
done a lot recently that has made them a

308
00:12:55,800 --> 00:13:00,180
cooler company but they have definitely

309
00:12:58,080 --> 00:13:02,220
some Croft that people just don't<font color="#CCCCCC"> care</font>

310
00:13:00,180 --> 00:13:03,900
about and so unless<font color="#CCCCCC"> you're really</font>

311
00:13:02,220 --> 00:13:05,340
following the PowerShell community

312
00:13:03,900 --> 00:13:07,199
unless you're really following like you

313
00:13:05,340 --> 00:13:11,010
know the offensive like you know windows

314
00:13:07,200 --> 00:13:12,870
sides of things you're not aware of even

315
00:13:11,010 --> 00:13:14,310
just<font color="#E5E5E5"> how cool all this stuff is that's</font>

316
00:13:12,870 --> 00:13:16,080
coming out like<font color="#E5E5E5"> a lot of people are</font>

317
00:13:14,310 --> 00:13:18,449
aware of invoke mimikatz but they're not

318
00:13:16,080 --> 00:13:21,210
aware<font color="#E5E5E5"> of like in</font><font color="#CCCCCC"> Bay which is basically</font>

319
00:13:18,450 --> 00:13:23,010
a version of responder that's totally

320
00:13:21,210 --> 00:13:25,020
written in PowerShell it's super cool

321
00:13:23,010 --> 00:13:26,580
but<font color="#E5E5E5"> unless you're in the clerk in the</font>

322
00:13:25,020 --> 00:13:29,280
<font color="#E5E5E5">community or you're just not aware it's</font>

323
00:13:26,580 --> 00:13:30,990
just not cool stuff<font color="#E5E5E5"> hmm the other</font>

324
00:13:29,280 --> 00:13:32,939
problem is<font color="#CCCCCC"> it's it can be low</font>

325
00:13:30,990 --> 00:13:35,820
intimidating you<font color="#CCCCCC"> know a lot of pen</font>

326
00:13:32,940 --> 00:13:37,440
testers I talked<font color="#E5E5E5"> to like learning python</font>

327
00:13:35,820 --> 00:13:38,790
is still on their list of<font color="#E5E5E5"> things to do</font>

328
00:13:37,440 --> 00:13:40,050
they haven't gotten around to it despite

329
00:13:38,790 --> 00:13:42,150
the fact that you<font color="#CCCCCC"> know we've been using</font>

330
00:13:40,050 --> 00:13:45,150
<font color="#CCCCCC">Python to hack ship for the past like 15</font>

331
00:13:42,150 --> 00:13:47,010
<font color="#CCCCCC">years to come at them and say like hey</font>

332
00:13:45,150 --> 00:13:48,930
now there's this new language on<font color="#E5E5E5"> this</font>

333
00:13:47,010 --> 00:13:51,210
platform you don't respect<font color="#CCCCCC"> that you know</font>

334
00:13:48,930 --> 00:13:54,599
<font color="#E5E5E5">you really should learn it's just not</font>

335
00:13:51,210 --> 00:13:57,180
going<font color="#E5E5E5"> to click and you know where do you</font>

336
00:13:54,600 --> 00:13:58,560
start like you have this whole<font color="#E5E5E5"> new</font>

337
00:13:57,180 --> 00:14:00,209
language learner ultimately you just

338
00:13:58,560 --> 00:14:02,219
want to<font color="#E5E5E5"> learn how to hack stuff with</font><font color="#CCCCCC"> it</font>

339
00:14:00,210 --> 00:14:03,930
like you<font color="#E5E5E5"> don't care about managing DSC</font>

340
00:14:02,220 --> 00:14:05,490
or like Active Directory or whatever

341
00:14:03,930 --> 00:14:07,680
though you should<font color="#E5E5E5"> but we'll get it to</font>

342
00:14:05,490 --> 00:14:10,470
that in a minute you know where do you

343
00:14:07,680 --> 00:14:12,030
start so I wanted<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make something that</font>

344
00:14:10,470 --> 00:14:14,100
kind<font color="#E5E5E5"> of addressed all this right like</font>

345
00:14:12,030 --> 00:14:16,880
how do we make<font color="#CCCCCC"> it easier for people to</font>

346
00:14:14,100 --> 00:14:19,260
get<font color="#E5E5E5"> started using PowerShell offensively</font>

347
00:14:16,880 --> 00:14:24,540
so let me create the school called PS

348
00:14:19,260 --> 00:14:26,790
attack and PS attack is a custom console

349
00:14:24,540 --> 00:14:28,709
that allows you to<font color="#E5E5E5"> run PowerShell</font>

350
00:14:26,790 --> 00:14:31,770
commands and it's it's designed to

351
00:14:28,710 --> 00:14:36,450
emulate PowerShell dot exe but it

352
00:14:31,770 --> 00:14:38,640
<font color="#E5E5E5">doesn't rely on parish</font><font color="#CCCCCC"> ldx see it has a</font>

353
00:14:36,450 --> 00:14:39,930
real powerful tab completion so just

354
00:14:38,640 --> 00:14:41,970
like<font color="#E5E5E5"> PowerShell you know you sit</font><font color="#CCCCCC"> down</font>

355
00:14:39,930 --> 00:14:44,790
you can tap complete commands<font color="#E5E5E5"> parameters</font>

356
00:14:41,970 --> 00:14:46,470
file path stuff like that and it's a

357
00:14:44,790 --> 00:14:48,180
single executable you just download it

358
00:14:46,470 --> 00:14:50,640
run PS attack and<font color="#E5E5E5"> you</font>

359
00:14:48,180 --> 00:14:54,060
this console ray to go what's cool about

360
00:14:50,640 --> 00:14:56,699
this console is it's fully weaponized so

361
00:14:54,060 --> 00:14:58,770
it<font color="#E5E5E5"> contains over 100 commands that cover</font>

362
00:14:56,700 --> 00:15:02,910
the<font color="#E5E5E5"> full gamut of like what you would</font>

363
00:14:58,770 --> 00:15:04,410
expect<font color="#E5E5E5"> to encounter on a pen test so we</font>

364
00:15:02,910 --> 00:15:06,449
have commands<font color="#E5E5E5"> from more popular</font>

365
00:15:04,410 --> 00:15:09,719
frameworks such as power tools and power

366
00:15:06,450 --> 00:15:11,520
<font color="#E5E5E5">supply we have a lesser known tools as</font>

367
00:15:09,720 --> 00:15:13,890
well like<font color="#E5E5E5"> inve that</font><font color="#CCCCCC"> I talked about you</font>

368
00:15:11,520 --> 00:15:16,680
know recently<font color="#E5E5E5"> or power cat or DNS cat</font>

369
00:15:13,890 --> 00:15:19,709
you<font color="#E5E5E5"> know and stuff like that and then</font>

370
00:15:16,680 --> 00:15:21,989
because you end up<font color="#E5E5E5"> at the same situation</font>

371
00:15:19,709 --> 00:15:24,180
of<font color="#E5E5E5"> okay I got this scary blue box that</font>

372
00:15:21,990 --> 00:15:27,060
was supposed to type stuff into but what

373
00:15:24,180 --> 00:15:28,979
do i type so I wrote a family called get

374
00:15:27,060 --> 00:15:30,989
attack and get attacked kind of

375
00:15:28,980 --> 00:15:34,290
functions as a search engine for

376
00:15:30,990 --> 00:15:36,839
PowerShell attacks with NPS attack so

377
00:15:34,290 --> 00:15:38,910
what you<font color="#E5E5E5"> can do is type get attack</font>

378
00:15:36,839 --> 00:15:41,610
passwords and it's going<font color="#E5E5E5"> to return back</font>

379
00:15:38,910 --> 00:15:43,230
a list of all the commands in PS attack

380
00:15:41,610 --> 00:15:45,600
that have something<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> with passwords</font>

381
00:15:43,230 --> 00:15:47,670
so in this case<font color="#E5E5E5"> you can see we have you</font>

382
00:15:45,600 --> 00:15:50,040
know invoke mimikatz and get gpp

383
00:15:47,670 --> 00:15:51,660
password you know so real helpful way<font color="#E5E5E5"> to</font>

384
00:15:50,040 --> 00:15:53,849
kind of get you pointed in the right

385
00:15:51,660 --> 00:15:59,189
direction to do whatever<font color="#E5E5E5"> it is you're</font>

386
00:15:53,850 --> 00:16:01,940
trying to do<font color="#E5E5E5"> and I wanted to create a</font>

387
00:15:59,190 --> 00:16:04,260
tool that wasn't just useful for the lab

388
00:16:01,940 --> 00:16:06,360
so I wanted this be something<font color="#E5E5E5"> that</font>

389
00:16:04,260 --> 00:16:09,089
people could actually use on engagements

390
00:16:06,360 --> 00:16:13,680
so one of the things that it does is

391
00:16:09,089 --> 00:16:16,170
when PS attack is built it downloads all

392
00:16:13,680 --> 00:16:18,779
of the tools that it relies on so powers

393
00:16:16,170 --> 00:16:23,040
Floyd and nisha and in<font color="#CCCCCC"> Bay and all that</font>

394
00:16:18,779 --> 00:16:25,050
it encrypts<font color="#E5E5E5"> them using AES and stores</font>

395
00:16:23,040 --> 00:16:27,930
those encrypted blobs within the actual

396
00:16:25,050 --> 00:16:30,209
console within the actual binary exe and

397
00:16:27,930 --> 00:16:32,400
then when you<font color="#E5E5E5"> double-click that exe when</font>

398
00:16:30,209 --> 00:16:34,529
you run it it takes all those encrypted

399
00:16:32,400 --> 00:16:38,370
blobs and<font color="#E5E5E5"> it</font><font color="#CCCCCC"> D crypts them straight into</font>

400
00:16:34,529 --> 00:16:40,320
memory so the actual malicious files the

401
00:16:38,370 --> 00:16:42,300
raw payloads never actually touch<font color="#E5E5E5"> disk</font>

402
00:16:40,320 --> 00:16:44,130
the computer is<font color="#E5E5E5"> not aware that they're</font>

403
00:16:42,300 --> 00:16:46,380
there unless<font color="#CCCCCC"> it's actually a scanning</font>

404
00:16:44,130 --> 00:16:50,010
<font color="#CCCCCC">ram which is real rare just doesn't</font>

405
00:16:46,380 --> 00:16:51,270
happen it also doesn't like<font color="#E5E5E5"> I said it</font>

406
00:16:50,010 --> 00:16:53,250
<font color="#E5E5E5">before it doesn't rely on</font><font color="#CCCCCC"> PowerShell</font>

407
00:16:51,270 --> 00:16:54,480
<font color="#E5E5E5">DHCS so if you have an environment where</font>

408
00:16:53,250 --> 00:16:56,940
you<font color="#E5E5E5"> can't run</font>

409
00:16:54,480 --> 00:16:59,190
shot<font color="#CCCCCC"> exe you</font><font color="#E5E5E5"> were probably going to be</font>

410
00:16:56,940 --> 00:17:01,920
able to run PS attack and still be able

411
00:16:59,190 --> 00:17:04,350
to<font color="#E5E5E5"> run those PowerShell commands and</font>

412
00:17:01,920 --> 00:17:07,319
it's designed to work on everything<font color="#CCCCCC"> from</font>

413
00:17:04,349 --> 00:17:09,208
a<font color="#E5E5E5"> brand new windows seven install to the</font>

414
00:17:07,319 --> 00:17:11,609
<font color="#E5E5E5">latest versions of Windows 10 basically</font>

415
00:17:09,209 --> 00:17:13,230
anything that has power shell on it PS

416
00:17:11,609 --> 00:17:20,369
<font color="#CCCCCC">attacks should</font><font color="#E5E5E5"> be able to run and be</font>

417
00:17:13,230 --> 00:17:23,130
able to<font color="#E5E5E5"> wrexham shop because</font><font color="#CCCCCC"> it is using</font>

418
00:17:20,369 --> 00:17:25,049
the built-in net PowerShell it's

419
00:17:23,130 --> 00:17:27,870
basically just a PowerShell console it

420
00:17:25,049 --> 00:17:29,250
still includes access to get help so you

421
00:17:27,869 --> 00:17:31,139
can figure<font color="#E5E5E5"> out what command you're</font>

422
00:17:29,250 --> 00:17:32,640
trying to run with good attack and then

423
00:17:31,140 --> 00:17:35,760
you can<font color="#E5E5E5"> use get help to figure out how</font>

424
00:17:32,640 --> 00:17:37,650
to use that command that you<font color="#E5E5E5"> found one</font>

425
00:17:35,760 --> 00:17:40,799
of the great<font color="#CCCCCC"> things about it</font><font color="#E5E5E5"> help is it</font>

426
00:17:37,650 --> 00:17:43,590
has an examples parameter so for example

427
00:17:40,799 --> 00:17:45,570
<font color="#E5E5E5">if you run get help invoke mimikatz dash</font>

428
00:17:43,590 --> 00:17:47,070
examples it prints out like four

429
00:17:45,570 --> 00:17:52,200
different examples of what you can do

430
00:17:47,070 --> 00:17:53,820
with invoke mimic cats so let me grab

431
00:17:52,200 --> 00:17:57,290
some water and<font color="#E5E5E5"> we will do a little demo</font>

432
00:17:53,820 --> 00:17:57,290
of how<font color="#E5E5E5"> great PS jackets</font>

433
00:18:10,539 --> 00:18:14,080
that was real fun

434
00:18:14,520 --> 00:18:23,080
alright so in this case I'm sitting at a

435
00:18:19,780 --> 00:18:25,870
windows 7 box as a<font color="#E5E5E5"> low-level user so</font>

436
00:18:23,080 --> 00:18:26,949
maybe<font color="#E5E5E5"> I found some rdp creds that you</font>

437
00:18:25,870 --> 00:18:30,100
know<font color="#E5E5E5"> I was able to get into somebody's</font>

438
00:18:26,950 --> 00:18:32,620
box or physically<font color="#E5E5E5"> on site came across an</font>

439
00:18:30,100 --> 00:18:35,909
unmarked machine and I drop PS attack on

440
00:18:32,620 --> 00:18:41,139
there so we'll go<font color="#CCCCCC"> ahead and run PS check</font>

441
00:18:35,910 --> 00:18:42,910
and the first<font color="#E5E5E5"> thing I want to do is try</font>

442
00:18:41,140 --> 00:18:44,830
<font color="#CCCCCC">to see what i can do to escalate</font>

443
00:18:42,910 --> 00:18:47,140
privileges<font color="#CCCCCC"> Reich's</font><font color="#E5E5E5"> I'm a low-level user</font>

444
00:18:44,830 --> 00:18:53,730
I want to try to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> around that so</font>

445
00:18:47,140 --> 00:18:53,730
let's do get attack let me just<font color="#E5E5E5"> do prove</font>

446
00:18:55,470 --> 00:19:00,610
see if that works one of the things

447
00:18:58,960 --> 00:19:03,400
about good attack you can see each

448
00:19:00,610 --> 00:19:06,490
command has a type so I tried to<font color="#E5E5E5"> group</font>

449
00:19:03,400 --> 00:19:07,750
similar types of commands so primp

450
00:19:06,490 --> 00:19:10,120
didn't actually get me the command that

451
00:19:07,750 --> 00:19:14,919
<font color="#E5E5E5">I wanted for this demo so let's do</font>

452
00:19:10,120 --> 00:19:17,939
escalation there we go so all sorts cool

453
00:19:14,919 --> 00:19:21,880
<font color="#E5E5E5">stuff in here a lot of</font><font color="#CCCCCC"> it is</font><font color="#E5E5E5"> provided by</font>

454
00:19:17,940 --> 00:19:25,419
the<font color="#E5E5E5"> powerup package of commands which is</font>

455
00:19:21,880 --> 00:19:27,820
basically<font color="#CCCCCC"> suite for fine being typical</font>

456
00:19:25,419 --> 00:19:31,840
privilege escalation issues with windows

457
00:19:27,820 --> 00:19:35,049
box so services<font color="#E5E5E5"> that are over privileged</font>

458
00:19:31,840 --> 00:19:36,908
but run commands that are run exe s that

459
00:19:35,049 --> 00:19:40,450
you may have write privileges to or

460
00:19:36,909 --> 00:19:42,450
unattended ml files power up is going to

461
00:19:40,450 --> 00:19:46,659
be able<font color="#E5E5E5"> to help you find all this stuff</font>

462
00:19:42,450 --> 00:19:50,320
the command that I really enjoyed

463
00:19:46,659 --> 00:19:56,380
running though is called invoke ms 1603

464
00:19:50,320 --> 00:19:59,620
<font color="#CCCCCC">too and this exploits a recent windows</font>

465
00:19:56,380 --> 00:20:02,020
flaw with the secondary<font color="#E5E5E5"> logon service</font>

466
00:19:59,620 --> 00:20:04,959
that basically allows us to get system

467
00:20:02,020 --> 00:20:07,780
creds our system privileges on a windows

468
00:20:04,960 --> 00:20:10,360
box it isn't patched for this so let's

469
00:20:07,780 --> 00:20:13,750
go ahead and just run invoke ms 16 32

470
00:20:10,360 --> 00:20:15,699
and that's going to pop us at a command

471
00:20:13,750 --> 00:20:16,650
prompt and you can see we have system

472
00:20:15,700 --> 00:20:20,220
access

473
00:20:16,650 --> 00:20:23,270
man around<font color="#E5E5E5"> that computer so let's go</font>

474
00:20:20,220 --> 00:20:25,920
ahead and run PS attack now as system

475
00:20:23,270 --> 00:20:28,590
now that<font color="#CCCCCC"> I have system rights the next</font>

476
00:20:25,920 --> 00:20:30,780
thing I'd want to do is start looking at

477
00:20:28,590 --> 00:20:33,689
mimic<font color="#E5E5E5"> cats right because we</font><font color="#CCCCCC"> can use</font>

478
00:20:30,780 --> 00:20:35,910
mimic ads to start getting<font color="#E5E5E5"> credentials</font>

479
00:20:33,690 --> 00:20:39,440
off the box how many<font color="#CCCCCC"> people in the room</font>

480
00:20:35,910 --> 00:20:43,830
are familiar with mimic cats<font color="#E5E5E5"> okay so</font>

481
00:20:39,440 --> 00:20:46,200
mimic cats is really like a Swiss Army

482
00:20:43,830 --> 00:20:49,379
knife like windows credentials

483
00:20:46,200 --> 00:20:52,020
awesomeness what we're going to see here

484
00:20:49,380 --> 00:20:55,460
is<font color="#E5E5E5"> it's commonly used to dump</font>

485
00:20:52,020 --> 00:20:58,110
credentials from memory on a windows box

486
00:20:55,460 --> 00:21:00,090
and that's what most people use<font color="#CCCCCC"> it for</font>

487
00:20:58,110 --> 00:21:02,490
you can<font color="#CCCCCC"> actually leverage mimic</font><font color="#E5E5E5"> cats to</font>

488
00:21:00,090 --> 00:21:04,320
do all sorts of really cool like ticket

489
00:21:02,490 --> 00:21:06,840
based attacks like golden ticket and

490
00:21:04,320 --> 00:21:07,980
stuff like that in this case though

491
00:21:06,840 --> 00:21:10,649
we're just going to<font color="#E5E5E5"> keep it simple and</font>

492
00:21:07,980 --> 00:21:15,200
we're going<font color="#CCCCCC"> to look at</font><font color="#E5E5E5"> what we can do</font>

493
00:21:10,650 --> 00:21:19,920
with<font color="#E5E5E5"> nimma cats so let's run get help</font>

494
00:21:15,200 --> 00:21:22,170
you can see it gives us a synopsis some

495
00:21:19,920 --> 00:21:23,850
links here gives us all these<font color="#E5E5E5"> switches</font>

496
00:21:22,170 --> 00:21:27,440
that we could<font color="#CCCCCC"> use with the command</font>

497
00:21:23,850 --> 00:21:33,929
description blah blah blah great stuff

498
00:21:27,440 --> 00:21:40,160
let's go<font color="#E5E5E5"> ahead and run whoops that's my</font>

499
00:21:33,930 --> 00:21:43,500
supposed map oops let's try that again

500
00:21:40,160 --> 00:21:45,330
that was a bug in PS attack it's<font color="#E5E5E5"> open</font>

501
00:21:43,500 --> 00:21:47,980
<font color="#E5E5E5">source you're welcome to figure out what</font>

502
00:21:45,330 --> 00:21:53,409
caused that and try to fix<font color="#E5E5E5"> it</font>

503
00:21:47,980 --> 00:22:01,700
alright so let's do get help and vogue

504
00:21:53,410 --> 00:22:04,010
Democrats examples<font color="#CCCCCC"> all right so we can</font>

505
00:22:01,700 --> 00:22:05,690
dump certs we could dump creds we can

506
00:22:04,010 --> 00:22:08,060
give it a list or computer names to try

507
00:22:05,690 --> 00:22:10,340
to dump creds against so we can run this

508
00:22:08,060 --> 00:22:13,730
over the network or we<font color="#E5E5E5"> can just run</font>

509
00:22:10,340 --> 00:22:15,560
straight commands that mimic at supports

510
00:22:13,730 --> 00:22:20,590
in this<font color="#E5E5E5"> case we're just going to dump</font>

511
00:22:15,560 --> 00:22:22,879
creds vogue Democrats breads and

512
00:22:20,590 --> 00:22:24,830
hopefully the creds that I have staged

513
00:22:22,880 --> 00:22:26,210
here will work I think this bombed out

514
00:22:24,830 --> 00:22:33,520
when I<font color="#E5E5E5"> did</font><font color="#CCCCCC"> it at dirty tony is very</font>

515
00:22:26,210 --> 00:22:33,520
<font color="#CCCCCC">embarrassing all right</font>

516
00:22:42,150 --> 00:22:48,420
oh cool so we have the local users creds

517
00:22:46,410 --> 00:22:51,390
we are apparently<font color="#E5E5E5"> running as be banner</font>

518
00:22:48,420 --> 00:22:52,830
with the password<font color="#CCCCCC"> was so angry there's</font>

519
00:22:51,390 --> 00:22:56,640
also a<font color="#E5E5E5"> different set of credits</font>

520
00:22:52,830 --> 00:22:59,159
<font color="#CCCCCC">thattekad</font><font color="#E5E5E5"> here a user name called back</font>

521
00:22:56,640 --> 00:23:04,110
or<font color="#CCCCCC"> upper with a password of change me</font>

522
00:22:59,160 --> 00:23:11,340
one I think that's<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the creds</font><font color="#E5E5E5"> will</font>

523
00:23:04,110 --> 00:23:14,399
<font color="#CCCCCC">have in here so let's uh so we're</font>

524
00:23:11,340 --> 00:23:16,679
running a system on in this window what

525
00:23:14,400 --> 00:23:20,460
I want<font color="#E5E5E5"> to do is maybe investigate that</font>

526
00:23:16,680 --> 00:23:22,170
back rubber account and see what we can

527
00:23:20,460 --> 00:23:24,780
do with that account so we'll go back to

528
00:23:22,170 --> 00:23:27,050
<font color="#E5E5E5">my user account because he has domain</font>

529
00:23:24,780 --> 00:23:30,450
access he can start query in the domain

530
00:23:27,050 --> 00:23:38,480
so let's do a good attack will look for

531
00:23:30,450 --> 00:23:43,430
a user saw privilege escalation stuff

532
00:23:38,480 --> 00:23:43,430
find user field find local admin

533
00:23:54,870 --> 00:24:00,820
almost there we<font color="#E5E5E5"> go all right so Power</font>

534
00:23:57,940 --> 00:24:02,890
View is a selection of a PowerShell

535
00:24:00,820 --> 00:24:05,678
command lights are used for a recon it's

536
00:24:02,890 --> 00:24:07,600
part of<font color="#E5E5E5"> its now part of PS attack but</font>

537
00:24:05,679 --> 00:24:11,590
it's developed by some of<font color="#E5E5E5"> the guys out</font>

538
00:24:07,600 --> 00:24:12,909
<font color="#CCCCCC">of Barras harm joy and those</font><font color="#E5E5E5"> guys a lot</font>

539
00:24:11,590 --> 00:24:14,678
of really great stuff what we're going

540
00:24:12,910 --> 00:24:17,110
to use here is a command line called get

541
00:24:14,679 --> 00:24:19,150
net user which is really just kind of a

542
00:24:17,110 --> 00:24:21,820
replacement<font color="#CCCCCC"> for the net users domain</font>

543
00:24:19,150 --> 00:24:29,770
command but we're<font color="#E5E5E5"> going to use this to</font>

544
00:24:21,820 --> 00:24:33,428
<font color="#E5E5E5">query that</font><font color="#CCCCCC"> backer upper account and see</font>

545
00:24:29,770 --> 00:24:35,200
what we can find out about<font color="#CCCCCC"> alright so we</font>

546
00:24:33,429 --> 00:24:44,200
can see that he is<font color="#CCCCCC"> a member of the</font>

547
00:24:35,200 --> 00:24:46,929
service count so you and he's a member

548
00:24:44,200 --> 00:24:49,210
<font color="#E5E5E5">of</font><font color="#CCCCCC"> the domain admins group because he's</font>

549
00:24:46,929 --> 00:24:50,290
a backup account so of<font color="#E5E5E5"> course we're</font>

550
00:24:49,210 --> 00:24:52,030
gonna put them in the domain admins

551
00:24:50,290 --> 00:24:53,440
group it's too hard<font color="#E5E5E5"> to figure out how</font>

552
00:24:52,030 --> 00:24:58,720
not to put him in the domain admins

553
00:24:53,440 --> 00:25:03,000
group so let's go ahead and start a PS

554
00:24:58,720 --> 00:25:03,000
attack as our backer upper account

555
00:25:09,980 --> 00:25:14,179
alright so I don't know how much longer

556
00:25:12,470 --> 00:25:16,299
I'm gonna have access to this box right

557
00:25:14,179 --> 00:25:19,130
like I may be sitting at some dudes cube

558
00:25:16,299 --> 00:25:20,360
or maybe i think is already peak reading

559
00:25:19,130 --> 00:25:23,510
is going to<font color="#E5E5E5"> log in again sometime soon</font>

560
00:25:20,360 --> 00:25:26,510
whatever so<font color="#CCCCCC"> i want to</font><font color="#E5E5E5"> set up some sort</font>

561
00:25:23,510 --> 00:25:31,340
of persistence right so let's go ahead

562
00:25:26,510 --> 00:25:33,679
and do get attack persist and there is

563
00:25:31,340 --> 00:25:39,049
<font color="#CCCCCC">one command because that's the only</font>

564
00:25:33,679 --> 00:25:44,059
command that i have written so far there

565
00:25:39,049 --> 00:25:46,760
is not a lot<font color="#E5E5E5"> of persistence commands in</font>

566
00:25:44,059 --> 00:25:49,490
<font color="#E5E5E5">powershell that worked the way</font><font color="#CCCCCC"> i would</font>

567
00:25:46,760 --> 00:25:51,919
want them to work there's they always

568
00:25:49,490 --> 00:25:55,010
<font color="#E5E5E5">seem very like overly complicated and</font>

569
00:25:51,919 --> 00:25:56,990
for example<font color="#E5E5E5"> scheduled tasks my stuff</font>

570
00:25:55,010 --> 00:25:59,510
didn't add support for a scheduled task

571
00:25:56,990 --> 00:26:01,250
man<font color="#CCCCCC"> let's in Silla</font><font color="#E5E5E5"> powershell 30 which</font><font color="#CCCCCC"> i</font>

572
00:25:59,510 --> 00:26:02,570
<font color="#E5E5E5">think came out with like vista and won't</font>

573
00:26:01,250 --> 00:26:06,049
necessarily be installed on windows

574
00:26:02,570 --> 00:26:08,120
seven boxes and it to set up a schedule

575
00:26:06,049 --> 00:26:09,770
test using the built-in command lets is

576
00:26:08,120 --> 00:26:11,389
like seven different commands or

577
00:26:09,770 --> 00:26:13,010
something like that it's not<font color="#E5E5E5"> like i just</font>

578
00:26:11,390 --> 00:26:16,520
want to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able to say like hey at this</font>

579
00:26:13,010 --> 00:26:18,650
time run this command so what I did is I

580
00:26:16,520 --> 00:26:20,840
went ahead<font color="#E5E5E5"> and wrote a new</font><font color="#CCCCCC"> schedule</font><font color="#E5E5E5"> task</font>

581
00:26:18,650 --> 00:26:23,990
<font color="#E5E5E5">Z that way doesn't conflict with the</font>

582
00:26:20,840 --> 00:26:29,600
<font color="#E5E5E5">existing new schedule tasks so if we do</font>

583
00:26:23,990 --> 00:26:31,130
get help new scheduled task we can see

584
00:26:29,600 --> 00:26:33,649
all<font color="#E5E5E5"> the crazy parameters we can run here</font>

585
00:26:31,130 --> 00:26:41,510
give<font color="#E5E5E5"> it a time we told to run on log on</font>

586
00:26:33,650 --> 00:26:44,390
on boot if<font color="#E5E5E5"> we do the examples we can see</font>

587
00:26:41,510 --> 00:26:45,860
I provided three different examples of

588
00:26:44,390 --> 00:26:52,400
just different commands that you could

589
00:26:45,860 --> 00:26:57,439
run just set up a scheduled task but i'm

590
00:26:52,400 --> 00:27:00,470
going<font color="#E5E5E5"> to cheap here so a lot of you have</font>

591
00:26:57,440 --> 00:27:04,090
probably seen this right here or

592
00:27:00,470 --> 00:27:08,410
something similar so what this does is

593
00:27:04,090 --> 00:27:11,990
this is a download cradle for<font color="#E5E5E5"> powershell</font>

594
00:27:08,410 --> 00:27:15,140
what it does is creates a dot net web

595
00:27:11,990 --> 00:27:15,940
client tells it to<font color="#E5E5E5"> download whatever is</font>

596
00:27:15,140 --> 00:27:20,289
at this<font color="#E5E5E5"> you are</font>

597
00:27:15,940 --> 00:27:21,820
as a string and then<font color="#E5E5E5"> this I</font><font color="#CCCCCC"> X is</font><font color="#E5E5E5"> Elias</font>

598
00:27:20,289 --> 00:27:23,679
for a<font color="#E5E5E5"> commandment called invoke</font>

599
00:27:21,820 --> 00:27:25,928
expression so basically what we're

600
00:27:23,679 --> 00:27:29,919
saying is hey go download this ps1 file

601
00:27:25,929 --> 00:27:32,379
and<font color="#E5E5E5"> then run it this colon then lets us</font>

602
00:27:29,919 --> 00:27:34,840
run<font color="#E5E5E5"> whatever that was in that ps1 file</font>

603
00:27:32,379 --> 00:27:37,899
so in this case it's downloading a

604
00:27:34,840 --> 00:27:41,350
PowerShell pile for invoke<font color="#CCCCCC"> metasploit</font>

605
00:27:37,899 --> 00:27:44,139
payload which is a commandment that<font color="#CCCCCC"> I</font>

606
00:27:41,350 --> 00:27:47,500
wrote that allows you to<font color="#CCCCCC"> use</font><font color="#E5E5E5"> metasploit</font>

607
00:27:44,139 --> 00:27:48,879
<font color="#CCCCCC">web delivery</font><font color="#E5E5E5"> module and powers that's a</font>

608
00:27:47,500 --> 00:27:50,649
PowerShell script that will just go out

609
00:27:48,879 --> 00:27:52,418
download<font color="#CCCCCC"> whatever payload you're giving</font>

610
00:27:50,649 --> 00:27:54,250
through the web delivery module and it

611
00:27:52,419 --> 00:27:55,690
will go ahead and execute it so in this

612
00:27:54,250 --> 00:27:58,059
case we're running invoke<font color="#CCCCCC"> metasploit</font>

613
00:27:55,690 --> 00:28:02,500
payload and pointing it to the URL<font color="#E5E5E5"> of</font>

614
00:27:58,059 --> 00:28:05,549
<font color="#E5E5E5">pwnage example.com / payload then what i</font>

615
00:28:02,500 --> 00:28:08,200
did is this is another real common

616
00:28:05,549 --> 00:28:10,658
PowerShell trick is<font color="#E5E5E5"> PowerShell natively</font>

617
00:28:08,200 --> 00:28:14,500
supports commands that are encoded with

618
00:28:10,659 --> 00:28:15,909
base64 they did this to<font color="#E5E5E5"> kind of help get</font>

619
00:28:14,500 --> 00:28:18,149
around a lot<font color="#E5E5E5"> of the issues you come up</font>

620
00:28:15,909 --> 00:28:21,539
with where like you're trying to use

621
00:28:18,149 --> 00:28:24,250
different quotes or brackets or params

622
00:28:21,539 --> 00:28:26,220
friends in like a command line prompt

623
00:28:24,250 --> 00:28:28,419
and like you have to escape everything

624
00:28:26,220 --> 00:28:30,519
this makes a lot<font color="#CCCCCC"> easier because</font><font color="#E5E5E5"> you can</font>

625
00:28:28,419 --> 00:28:31,779
just base64 the entire command you know

626
00:28:30,519 --> 00:28:33,460
it's going to be safe no matter where

627
00:28:31,779 --> 00:28:35,590
you pass it through and powershell would

628
00:28:33,460 --> 00:28:40,360
decode it and run it this also makes it

629
00:28:35,590 --> 00:28:41,769
a lot a real benefit for us<font color="#E5E5E5"> as red</font>

630
00:28:40,360 --> 00:28:44,289
teamers because it makes it really easy

631
00:28:41,769 --> 00:28:47,970
to pass these commands over shells or

632
00:28:44,289 --> 00:28:51,009
you know you know just a real basic

633
00:28:47,970 --> 00:28:54,100
obfuscation of the command so what I did

634
00:28:51,009 --> 00:28:58,149
is I took this string right here and

635
00:28:54,100 --> 00:29:01,570
this is<font color="#E5E5E5"> the base64 encoded version of</font>

636
00:28:58,149 --> 00:29:03,189
this<font color="#E5E5E5"> command</font><font color="#CCCCCC"> alright so what we're going</font>

637
00:29:01,570 --> 00:29:04,480
to do is we're in run new<font color="#CCCCCC"> schedule task</font>

638
00:29:03,190 --> 00:29:06,789
we're going<font color="#E5E5E5"> to tell it to run a</font>

639
00:29:04,480 --> 00:29:09,250
time-based task<font color="#E5E5E5"> this is going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font>

640
00:29:06,789 --> 00:29:11,529
called updater it's going to repeat

641
00:29:09,250 --> 00:29:14,860
every 90 minutes it's going<font color="#CCCCCC"> to run</font>

642
00:29:11,529 --> 00:29:17,769
powershell as the back<font color="#E5E5E5"> rubber account</font>

643
00:29:14,860 --> 00:29:19,090
password changeme one and when it runs

644
00:29:17,769 --> 00:29:20,710
<font color="#E5E5E5">powershell these are the arguments</font>

645
00:29:19,090 --> 00:29:21,908
that's going to present power<font color="#CCCCCC"> Schultz</font>

646
00:29:20,710 --> 00:29:23,799
can say it's an honor interactive

647
00:29:21,909 --> 00:29:25,779
session the window is<font color="#E5E5E5"> going to be hidden</font>

648
00:29:23,799 --> 00:29:27,000
and here's the encoded command to run so

649
00:29:25,779 --> 00:29:29,670
every 90 minutes it's<font color="#E5E5E5"> going to</font>

650
00:29:27,000 --> 00:29:30,750
go ahead<font color="#E5E5E5"> and do this going to</font><font color="#CCCCCC"> 90 minutes</font>

651
00:29:29,670 --> 00:29:32,940
it's going<font color="#E5E5E5"> to reach out to this URL</font>

652
00:29:30,750 --> 00:29:37,590
download this<font color="#E5E5E5"> ps1 file and run in both</font>

653
00:29:32,940 --> 00:29:39,420
<font color="#CCCCCC">metasploit payload before I do that let</font>

654
00:29:37,590 --> 00:29:41,780
me make sure I actually have<font color="#E5E5E5"> metasploit</font>

655
00:29:39,420 --> 00:29:41,780
<font color="#CCCCCC">set up</font>

656
00:29:49,770 --> 00:29:53,210
pincode<font color="#E5E5E5"> brain doesn't</font>

657
00:29:53,780 --> 00:29:58,060
that's true

658
00:29:56,550 --> 00:30:01,060
two

659
00:29:58,060 --> 00:30:01,060
yes

660
00:30:01,970 --> 00:30:09,620
<font color="#E5E5E5">i'm glad</font><font color="#CCCCCC"> i checked this ok so python a</font>

661
00:30:06,140 --> 00:30:09,620
simple HTTP

662
00:30:13,590 --> 00:30:16,279
new

663
00:30:22,650 --> 00:30:26,240
I'll go ahead and let this<font color="#E5E5E5"> start up</font>

664
00:30:40,690 --> 00:30:44,240
for those who<font color="#E5E5E5"> haven't played around with</font>

665
00:30:42,530 --> 00:30:48,410
web delivery payload pretty

666
00:30:44,240 --> 00:30:50,840
straightforward so you specify a server

667
00:30:48,410 --> 00:30:53,210
host that's going to spin up<font color="#E5E5E5"> a web</font>

668
00:30:50,840 --> 00:30:54,470
server and then you tell it what payload

669
00:30:53,210 --> 00:30:58,640
to get back in<font color="#E5E5E5"> this case we're going to</font>

670
00:30:54,470 --> 00:31:02,330
get back a reverse<font color="#CCCCCC"> HTTPS and</font><font color="#E5E5E5"> then it</font>

671
00:30:58,640 --> 00:31:05,960
<font color="#CCCCCC">just runs so whenever a box hits this</font>

672
00:31:02,330 --> 00:31:09,490
URL it's going<font color="#E5E5E5"> to respond back with that</font>

673
00:31:05,960 --> 00:31:09,490
reverse HTTPS payload

674
00:31:14,440 --> 00:31:17,129
<font color="#E5E5E5">alright</font>

675
00:31:42,060 --> 00:31:47,669
<font color="#E5E5E5">alright so we're going to run that</font>

676
00:31:44,220 --> 00:31:49,860
<font color="#E5E5E5">Earthwise back with some</font><font color="#CCCCCC"> xml so by</font>

677
00:31:47,670 --> 00:31:52,440
default when we do a time-based task

678
00:31:49,860 --> 00:31:54,209
using that new<font color="#E5E5E5"> scheduled task command</font>

679
00:31:52,440 --> 00:31:56,580
line it's<font color="#E5E5E5"> going to run that task in 30</font>

680
00:31:54,210 --> 00:31:58,710
seconds one of the things<font color="#E5E5E5"> I learned from</font>

681
00:31:56,580 --> 00:32:00,570
my<font color="#CCCCCC"> Derby common presentation is if</font>

682
00:31:58,710 --> 00:32:02,040
you're on battery power schedule test

683
00:32:00,570 --> 00:32:04,610
doesn't give a and it's not<font color="#E5E5E5"> going</font>

684
00:32:02,040 --> 00:32:07,379
to run that scheduled task at all so

685
00:32:04,610 --> 00:32:10,320
yeah the<font color="#CCCCCC"> the demo at dirty was a</font>

686
00:32:07,380 --> 00:32:12,060
complete fail it was great so let's go

687
00:32:10,320 --> 00:32:14,810
ahead and cheat her we're going<font color="#E5E5E5"> to run</font>

688
00:32:12,060 --> 00:32:14,810
this manually

689
00:32:33,270 --> 00:32:38,850
on this forgot the password have changed

690
00:32:35,400 --> 00:32:40,380
me one that's pathetic<font color="#CCCCCC"> all right so</font>

691
00:32:38,850 --> 00:32:47,879
there's our scheduled task let's go

692
00:32:40,380 --> 00:32:49,860
<font color="#CCCCCC">ahead and manually run this there we go</font>

693
00:32:47,880 --> 00:32:58,400
so we see it come across download the

694
00:32:49,860 --> 00:33:02,459
IMS file and it should create a payload

695
00:32:58,400 --> 00:33:04,440
<font color="#CCCCCC">metasploit show their am so web delivery</font>

696
00:33:02,460 --> 00:33:08,850
is delivering the payload and we should

697
00:33:04,440 --> 00:33:11,160
get our meterpreter shell back cool so

698
00:33:08,850 --> 00:33:13,500
we have a<font color="#CCCCCC"> mature procession and this</font>

699
00:33:11,160 --> 00:33:14,580
scheduled task yeah that's you know if

700
00:33:13,500 --> 00:33:20,310
you want to cheer and applaud that's

701
00:33:14,580 --> 00:33:22,379
cool<font color="#E5E5E5"> yeah the schedule test run every 90</font>

702
00:33:20,310 --> 00:33:25,139
minutes we're running as a main admin

703
00:33:22,380 --> 00:33:26,640
account so pretty successful little you

704
00:33:25,140 --> 00:33:35,600
know<font color="#CCCCCC"> 10-minute trip</font><font color="#E5E5E5"> to somebody's</font>

705
00:33:26,640 --> 00:33:35,600
computer<font color="#E5E5E5"> all right</font>

706
00:33:42,300 --> 00:33:44,899
good

707
00:33:47,240 --> 00:33:53,730
<font color="#E5E5E5">okay so i think PS</font><font color="#CCCCCC"> attack</font><font color="#E5E5E5"> is really cool</font>

708
00:33:51,060 --> 00:33:55,649
i think it's it's a great way for<font color="#E5E5E5"> people</font>

709
00:33:53,730 --> 00:33:57,360
to get started with<font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> I've</font>

710
00:33:55,650 --> 00:33:59,610
<font color="#E5E5E5">tried to make it so that</font><font color="#CCCCCC"> anything you</font>

711
00:33:57,360 --> 00:34:01,530
learn use aim PS attack will hopefully

712
00:33:59,610 --> 00:34:04,409
translate over to actual just regular

713
00:34:01,530 --> 00:34:06,930
PowerShell prompts but there's definite

714
00:34:04,410 --> 00:34:10,260
areas for improvement one of the

715
00:34:06,930 --> 00:34:13,770
problems<font color="#CCCCCC"> that I really wanted to</font><font color="#E5E5E5"> address</font>

716
00:34:10,260 --> 00:34:16,440
is that all it takes<font color="#CCCCCC"> is for somebody to</font>

717
00:34:13,770 --> 00:34:19,199
download that PS attack exe binary and

718
00:34:16,440 --> 00:34:20,940
upload<font color="#CCCCCC"> it to virustotal and now virus</font>

719
00:34:19,199 --> 00:34:23,040
you know<font color="#CCCCCC"> abies</font><font color="#E5E5E5"> across the board are</font>

720
00:34:20,940 --> 00:34:24,720
going to be start flagging on the<font color="#E5E5E5"> EPS</font>

721
00:34:23,040 --> 00:34:26,850
<font color="#E5E5E5">check binary because it all uses the</font>

722
00:34:24,719 --> 00:34:28,350
same encrypted strings it doesn't matter

723
00:34:26,850 --> 00:34:29,699
that<font color="#E5E5E5"> they are encrypted at this point</font>

724
00:34:28,350 --> 00:34:35,790
they're part of a bio signature

725
00:34:29,699 --> 00:34:39,029
somewhere the other issue is that the

726
00:34:35,790 --> 00:34:40,860
tools themselves are a static so you

727
00:34:39,030 --> 00:34:43,200
know there's such an active development

728
00:34:40,860 --> 00:34:44,850
community in PowerShell that you know

729
00:34:43,199 --> 00:34:46,560
when we download these you know

730
00:34:44,850 --> 00:34:49,168
<font color="#E5E5E5">PowerShell tools we embed them in this</font>

731
00:34:46,560 --> 00:34:50,759
binary you know within a week they're

732
00:34:49,168 --> 00:34:52,710
out of date because be able to<font color="#E5E5E5"> push out</font>

733
00:34:50,760 --> 00:34:56,159
fixes or enhancements or you know

734
00:34:52,710 --> 00:35:01,050
whatever so I wanted<font color="#E5E5E5"> to come up</font><font color="#CCCCCC"> with a</font>

735
00:34:56,159 --> 00:35:04,170
way to make it<font color="#E5E5E5"> easy for people</font><font color="#CCCCCC"> to really</font>

736
00:35:01,050 --> 00:35:07,380
build their own PS attack which is why I

737
00:35:04,170 --> 00:35:09,840
created the<font color="#E5E5E5"> build tool so what the build</font>

738
00:35:07,380 --> 00:35:11,600
tool does is it downloads the latest

739
00:35:09,840 --> 00:35:13,830
release of<font color="#CCCCCC"> PS attack from github</font>

740
00:35:11,600 --> 00:35:16,799
downloads the actual source code for it

741
00:35:13,830 --> 00:35:18,720
it downloads all of the modules and

742
00:35:16,800 --> 00:35:21,060
everything that PS tag depends on it

743
00:35:18,720 --> 00:35:24,029
then encrypts those modules with the

744
00:35:21,060 --> 00:35:25,950
unique key it goes through and then

745
00:35:24,030 --> 00:35:27,900
<font color="#CCCCCC">obfuscated certain strings within the</font>

746
00:35:25,950 --> 00:35:31,910
source code<font color="#E5E5E5"> of PS attack so for example</font>

747
00:35:27,900 --> 00:35:34,980
the actual phrase PS attack and then

748
00:35:31,910 --> 00:35:36,930
take some<font color="#E5E5E5"> of the values that AV had</font>

749
00:35:34,980 --> 00:35:40,080
<font color="#E5E5E5">started tripping on encrypts those</font>

750
00:35:36,930 --> 00:35:42,569
sources and basically it's<font color="#CCCCCC"> like a CSB</font>

751
00:35:40,080 --> 00:35:44,009
that it's an encrypted CSV that PS

752
00:35:42,570 --> 00:35:45,540
attack is<font color="#E5E5E5"> going to open up and start</font>

753
00:35:44,010 --> 00:35:48,060
<font color="#E5E5E5">reading values from when it's compiled</font>

754
00:35:45,540 --> 00:35:51,000
and then it compiles everything for you

755
00:35:48,060 --> 00:35:53,070
super easy like you don't<font color="#E5E5E5"> you</font><font color="#CCCCCC"> don't need</font>

756
00:35:51,000 --> 00:35:54,220
to know how to compile stuff this build

757
00:35:53,070 --> 00:35:56,260
tool is going to go ahead<font color="#E5E5E5"> and take</font>

758
00:35:54,220 --> 00:35:58,779
of that and at the end<font color="#CCCCCC"> you get your own</font>

759
00:35:56,260 --> 00:36:00,760
<font color="#CCCCCC">custom made version of PS attack that</font>

760
00:35:58,780 --> 00:36:03,040
has unique foul signatures it's

761
00:36:00,760 --> 00:36:06,609
completely up to date and hopefully

762
00:36:03,040 --> 00:36:08,890
should ave davie for another day so to

763
00:36:06,609 --> 00:36:11,859
demonstrate this this is basically<font color="#E5E5E5"> how</font>

764
00:36:08,890 --> 00:36:17,170
easy it is to run the build tool whoops

765
00:36:11,859 --> 00:36:18,730
that's not it for the<font color="#E5E5E5"> life of me I</font>

766
00:36:17,170 --> 00:36:21,369
cannot get that video<font color="#E5E5E5"> to play when I'm</font>

767
00:36:18,730 --> 00:36:25,030
actually doing a presentation<font color="#CCCCCC"> okay so</font>

768
00:36:21,369 --> 00:36:27,369
all<font color="#CCCCCC"> this stuff that I said</font><font color="#E5E5E5"> here this</font>

769
00:36:25,030 --> 00:36:28,780
video goes through<font color="#CCCCCC"> that except it was</font>

770
00:36:27,369 --> 00:36:30,070
also really<font color="#E5E5E5"> slow cuz i was on hotel</font>

771
00:36:28,780 --> 00:36:31,900
internet when<font color="#E5E5E5"> i recorded that so you're</font>

772
00:36:30,070 --> 00:36:35,020
probably better off for not seeing this

773
00:36:31,900 --> 00:36:38,650
<font color="#E5E5E5">video the cool thing</font><font color="#CCCCCC"> i want to</font><font color="#E5E5E5"> reiterate</font>

774
00:36:35,020 --> 00:36:40,180
though is that you<font color="#E5E5E5"> don't need to know</font>

775
00:36:38,650 --> 00:36:43,000
how to build software for this to work

776
00:36:40,180 --> 00:36:45,940
it actually leverages a lot of stuff

777
00:36:43,000 --> 00:36:50,950
that's<font color="#E5E5E5"> in.net to build these software 4</font>

778
00:36:45,940 --> 00:36:53,140
u.net provides ms build exe which is the

779
00:36:50,950 --> 00:36:55,660
same thing visual studio uses to compile

780
00:36:53,140 --> 00:36:59,650
C sharp applications so I'm<font color="#E5E5E5"> just as long</font>

781
00:36:55,660 --> 00:37:02,710
as<font color="#E5E5E5"> you have net 35 and 45 on your box</font>

782
00:36:59,650 --> 00:37:05,830
you'll<font color="#E5E5E5"> be able to compile PS</font><font color="#CCCCCC"> tag using</font>

783
00:37:02,710 --> 00:37:07,300
<font color="#CCCCCC">this build tool I also want to</font><font color="#E5E5E5"> make it</font>

784
00:37:05,830 --> 00:37:10,359
<font color="#CCCCCC">really easy for people to add their own</font>

785
00:37:07,300 --> 00:37:13,240
tools so the<font color="#CCCCCC"> way it loads tools is</font>

786
00:37:10,359 --> 00:37:16,180
through a JSON file that's<font color="#E5E5E5"> just in the</font>

787
00:37:13,240 --> 00:37:17,859
root of wherever the bill tool is a real

788
00:37:16,180 --> 00:37:19,839
simple<font color="#E5E5E5"> format you just give it a name</font>

789
00:37:17,859 --> 00:37:22,089
<font color="#E5E5E5">tell if we're to download the ps1 file</font>

790
00:37:19,839 --> 00:37:24,310
from and now whenever you run the build

791
00:37:22,089 --> 00:37:26,770
tool that will get pulled in as part of

792
00:37:24,310 --> 00:37:28,330
PS attack automatically so you can add

793
00:37:26,770 --> 00:37:29,980
as<font color="#E5E5E5"> many tools as you want you can strip</font>

794
00:37:28,330 --> 00:37:32,529
out stuff if for whatever reason you

795
00:37:29,980 --> 00:37:36,280
<font color="#E5E5E5">don't want to include something real</font>

796
00:37:32,530 --> 00:37:38,920
flexible real easy to<font color="#E5E5E5"> use both</font><font color="#CCCCCC"> of these</font>

797
00:37:36,280 --> 00:37:42,369
are<font color="#E5E5E5"> available on my github github.com /</font>

798
00:37:38,920 --> 00:37:44,770
<font color="#CCCCCC">jared hey they both come with pre</font>

799
00:37:42,369 --> 00:37:45,849
compiled binaries so if you<font color="#E5E5E5"> don't want</font>

800
00:37:44,770 --> 00:37:47,640
to run through the whole build tool

801
00:37:45,849 --> 00:37:49,720
thing you can just go to PS attack

802
00:37:47,640 --> 00:37:55,440
download from the<font color="#E5E5E5"> release file the</font>

803
00:37:49,720 --> 00:37:59,049
latest binary exe and run it<font color="#E5E5E5"> there are</font>

804
00:37:55,440 --> 00:38:01,420
last I checked there were seven or<font color="#E5E5E5"> 14</font>

805
00:37:59,050 --> 00:38:02,240
virus vendors that actually detect PS

806
00:38:01,420 --> 00:38:05,510
attack

807
00:38:02,240 --> 00:38:07,339
github as malicious so probably only

808
00:38:05,510 --> 00:38:09,320
good for lab work but you know if you

809
00:38:07,340 --> 00:38:11,600
want to<font color="#E5E5E5"> just get running that's a really</font>

810
00:38:09,320 --> 00:38:14,450
easy way to do it the build tool as well

811
00:38:11,600 --> 00:38:16,279
has a binary precompiled for you can

812
00:38:14,450 --> 00:38:21,399
just download it run it and get your

813
00:38:16,280 --> 00:38:29,000
custom made PS attack so I wanted<font color="#CCCCCC"> to</font>

814
00:38:21,400 --> 00:38:32,030
tell<font color="#E5E5E5"> a little story so at last year's</font>

815
00:38:29,000 --> 00:38:35,510
besides Charleston I gave my first like

816
00:38:32,030 --> 00:38:38,300
public talk where it wasn't just you

817
00:38:35,510 --> 00:38:39,980
know 20<font color="#E5E5E5"> friends and you know little</font>

818
00:38:38,300 --> 00:38:42,650
<font color="#E5E5E5">hacker meetups that we have at Charlotte</font>

819
00:38:39,980 --> 00:38:44,570
like this was I went through<font color="#CCCCCC"> a CFP and</font>

820
00:38:42,650 --> 00:38:46,220
like<font color="#E5E5E5"> people I didn't know</font><font color="#CCCCCC"> that I might</font>

821
00:38:44,570 --> 00:38:50,060
actually have something to say and be

822
00:38:46,220 --> 00:38:51,529
worthwhile so I gave a talk on an intro

823
00:38:50,060 --> 00:38:55,430
to powershell and how to use it<font color="#CCCCCC"> for evil</font>

824
00:38:51,530 --> 00:38:58,970
and it went really well uh the only

825
00:38:55,430 --> 00:39:02,419
<font color="#CCCCCC">thing that</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> really felt bad about was</font>

826
00:38:58,970 --> 00:39:04,910
at the end of the talk somebody had

827
00:39:02,420 --> 00:39:07,660
asked<font color="#CCCCCC"> me how do you defend against you</font>

828
00:39:04,910 --> 00:39:10,549
know this stuff that you've laid out and

829
00:39:07,660 --> 00:39:13,520
what<font color="#E5E5E5"> I meant to say was that you know</font>

830
00:39:10,550 --> 00:39:15,350
look I work primarily an offense you

831
00:39:13,520 --> 00:39:18,500
know defense and forensics hasn't really

832
00:39:15,350 --> 00:39:19,549
been a focus of mine you know<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font>

833
00:39:18,500 --> 00:39:21,050
know it's kind<font color="#E5E5E5"> of something you have to</font>

834
00:39:19,550 --> 00:39:23,240
research on your own own have a lot to

835
00:39:21,050 --> 00:39:25,460
contribute<font color="#E5E5E5"> to that what actually came</font>

836
00:39:23,240 --> 00:39:28,490
<font color="#E5E5E5">out of my mouth is I break things I</font>

837
00:39:25,460 --> 00:39:30,260
<font color="#E5E5E5">don't fix them which as those words were</font>

838
00:39:28,490 --> 00:39:32,479
queuing up like I already knew like that

839
00:39:30,260 --> 00:39:35,270
is the most immature like you know that

840
00:39:32,480 --> 00:39:36,950
that's<font color="#E5E5E5"> not my approach to infosec like</font>

841
00:39:35,270 --> 00:39:39,380
that's such an immature like shitty

842
00:39:36,950 --> 00:39:40,819
thing to say of course like but I said

843
00:39:39,380 --> 00:39:42,890
<font color="#E5E5E5">it anyway isn't God publish to youtube</font>

844
00:39:40,820 --> 00:39:44,510
<font color="#E5E5E5">but I</font><font color="#CCCCCC"> earn that like it was a super</font>

845
00:39:42,890 --> 00:39:46,430
successful talk like you know for a

846
00:39:44,510 --> 00:39:48,320
first talk<font color="#E5E5E5"> I was very proud of it and it</font>

847
00:39:46,430 --> 00:39:51,169
was<font color="#CCCCCC"> actually credible because a while</font>

848
00:39:48,320 --> 00:39:52,730
ago a while after<font color="#CCCCCC"> the talk it got</font>

849
00:39:51,170 --> 00:39:55,310
published by like security tube or

850
00:39:52,730 --> 00:39:57,530
something like that and Jeffrey's nobre

851
00:39:55,310 --> 00:40:00,410
actually retweeted it and quoted me in

852
00:39:57,530 --> 00:40:04,000
it if you don't know Jeffrey<font color="#CCCCCC"> snowbirds</font>

853
00:40:00,410 --> 00:40:06,890
which you probably shouldn't he is the

854
00:40:04,000 --> 00:40:08,540
he's a technical fellow at Microsoft

855
00:40:06,890 --> 00:40:10,040
like one of eight like it's the highest

856
00:40:08,540 --> 00:40:12,200
engineering position you can

857
00:40:10,040 --> 00:40:14,630
at<font color="#E5E5E5"> Microsoft Jeffrey's never actually</font>

858
00:40:12,200 --> 00:40:17,089
created PowerShell this is his baby and

859
00:40:14,630 --> 00:40:20,540
now he runs like<font color="#E5E5E5"> their entire server</font>

860
00:40:17,090 --> 00:40:22,670
like wine like it's<font color="#CCCCCC"> Jeffrey snipers</font>

861
00:40:20,540 --> 00:40:25,460
awesome it's why you see things<font color="#E5E5E5"> now like</font>

862
00:40:22,670 --> 00:40:28,520
Server 2016 we're like<font color="#E5E5E5"> it's there's no</font>

863
00:40:25,460 --> 00:40:30,320
GUI it's just you know console he is on

864
00:40:28,520 --> 00:40:32,690
record of saying like if a server has a

865
00:40:30,320 --> 00:40:35,870
GUI it you're<font color="#E5E5E5"> doing it wrong like it's</font>

866
00:40:32,690 --> 00:40:37,310
 up so really cool dude like this

867
00:40:35,870 --> 00:40:38,779
is you know<font color="#E5E5E5"> the dude the creative power</font>

868
00:40:37,310 --> 00:40:40,970
shows like talking<font color="#E5E5E5"> about me</font>

869
00:40:38,780 --> 00:40:44,120
that's<font color="#E5E5E5"> awesome and then shortly after</font>

870
00:40:40,970 --> 00:40:46,430
this tweet this tweet came out if you're

871
00:40:44,120 --> 00:40:48,380
not<font color="#E5E5E5"> familiar with manifestation he's</font>

872
00:40:46,430 --> 00:40:50,870
like he's like he's been my role model

873
00:40:48,380 --> 00:40:53,270
for a long time manifestation is like

874
00:40:50,870 --> 00:40:55,009
really dude that late took offensive

875
00:40:53,270 --> 00:40:57,440
<font color="#CCCCCC">powershell to a whole new level like</font>

876
00:40:55,010 --> 00:41:01,460
he's a genius super cool dude like

877
00:40:57,440 --> 00:41:03,530
pushes out so much great stuff and he

878
00:41:01,460 --> 00:41:06,050
was it was nice enough to not call me

879
00:41:03,530 --> 00:41:07,970
out<font color="#E5E5E5"> directly on this but like I tweeted</font>

880
00:41:06,050 --> 00:41:10,130
at him I'm<font color="#E5E5E5"> like dude you know you're</font>

881
00:41:07,970 --> 00:41:12,500
absolutely<font color="#E5E5E5"> right like I screwed up you</font>

882
00:41:10,130 --> 00:41:14,360
know I'm so sorry blah blah<font color="#CCCCCC"> blah so we</font>

883
00:41:12,500 --> 00:41:18,010
actually<font color="#E5E5E5"> ended up working it out this is</font>

884
00:41:14,360 --> 00:41:20,840
a completely unedited DM that he sent me

885
00:41:18,010 --> 00:41:23,030
and I mean super cool we're actually

886
00:41:20,840 --> 00:41:25,640
we're on pretty friendly terms now we

887
00:41:23,030 --> 00:41:29,660
<font color="#E5E5E5">talk regularly you know things kind of</font>

888
00:41:25,640 --> 00:41:31,430
worked out in the end if you're not

889
00:41:29,660 --> 00:41:33,589
familiar<font color="#E5E5E5"> with harm joy or enigma those</font>

890
00:41:31,430 --> 00:41:36,049
are the<font color="#E5E5E5"> guys that do Empire which is</font>

891
00:41:33,590 --> 00:41:40,040
another great<font color="#CCCCCC"> parish all product and</font>

892
00:41:36,050 --> 00:41:42,710
they are<font color="#E5E5E5"> really fun to troll so what I</font>

893
00:41:40,040 --> 00:41:45,320
wanted to do is make up<font color="#E5E5E5"> for my b sides</font>

894
00:41:42,710 --> 00:41:48,470
<font color="#CCCCCC">Charleston talk right because it's</font>

895
00:41:45,320 --> 00:41:50,360
important that as security professionals

896
00:41:48,470 --> 00:41:52,370
we're not just here to break like

897
00:41:50,360 --> 00:41:56,600
we're here to<font color="#CCCCCC"> actually try to make</font>

898
00:41:52,370 --> 00:41:58,460
<font color="#E5E5E5">things better so I wanted to hit the</font>

899
00:41:56,600 --> 00:42:00,950
right button and let's talk about

900
00:41:58,460 --> 00:42:06,010
actually defending against<font color="#CCCCCC"> powershell in</font>

901
00:42:00,950 --> 00:42:08,180
an enterprise environment so the

902
00:42:06,010 --> 00:42:10,220
important thing<font color="#CCCCCC"> to know about</font><font color="#E5E5E5"> PowerShell</font>

903
00:42:08,180 --> 00:42:13,580
especially when you're defending against

904
00:42:10,220 --> 00:42:16,310
it is that it's<font color="#E5E5E5"> not special powershell</font>

905
00:42:13,580 --> 00:42:18,360
is a post exploitation framework<font color="#E5E5E5"> like</font>

906
00:42:16,310 --> 00:42:20,009
nobody's popping<font color="#E5E5E5"> zero days</font>

907
00:42:18,360 --> 00:42:23,220
powershell they're using<font color="#CCCCCC"> powershell</font>

908
00:42:20,010 --> 00:42:26,370
leverage existing access to either

909
00:42:23,220 --> 00:42:28,439
target other vulnerabilities in the

910
00:42:26,370 --> 00:42:30,480
environment<font color="#E5E5E5"> or misuse privileges that</font>

911
00:42:28,440 --> 00:42:32,670
the account<font color="#E5E5E5"> already has access to so</font>

912
00:42:30,480 --> 00:42:34,200
para show is<font color="#E5E5E5"> really just a programming</font>

913
00:42:32,670 --> 00:42:36,230
language it's not<font color="#E5E5E5"> a scripting language</font>

914
00:42:34,200 --> 00:42:39,089
<font color="#E5E5E5">it's not you know super special it's not</font>

915
00:42:36,230 --> 00:42:41,400
it's<font color="#E5E5E5"> not mimic cats you know it's</font><font color="#CCCCCC"> just a</font>

916
00:42:39,090 --> 00:42:43,890
scripting language and so really

917
00:42:41,400 --> 00:42:45,630
defending against<font color="#CCCCCC"> PowerShell really</font>

918
00:42:43,890 --> 00:42:48,960
comes back to just basic security

919
00:42:45,630 --> 00:42:51,030
hygiene you know talking<font color="#E5E5E5"> about like</font>

920
00:42:48,960 --> 00:42:53,730
protecting your privilege tax<font color="#CCCCCC"> your</font>

921
00:42:51,030 --> 00:42:55,140
privileged accounts and logging what's

922
00:42:53,730 --> 00:42:56,820
actually happening within your

923
00:42:55,140 --> 00:42:58,920
<font color="#E5E5E5">environment and keeping your systems</font>

924
00:42:56,820 --> 00:43:00,630
patched that really is going<font color="#E5E5E5"> to mitigate</font>

925
00:42:58,920 --> 00:43:02,640
like ninety-eight percent of what you

926
00:43:00,630 --> 00:43:06,090
see happening in like offensive

927
00:43:02,640 --> 00:43:08,910
<font color="#E5E5E5">powershell one of the big things that I</font>

928
00:43:06,090 --> 00:43:12,990
see in environments is shared local

929
00:43:08,910 --> 00:43:15,750
admin passwords so you know you<font color="#E5E5E5"> have all</font>

930
00:43:12,990 --> 00:43:17,669
these you know and end points throughout

931
00:43:15,750 --> 00:43:20,250
your work straight or your environment

932
00:43:17,670 --> 00:43:22,110
and they're all using the same local

933
00:43:20,250 --> 00:43:25,080
admin password of you know<font color="#E5E5E5"> and it could</font>

934
00:43:22,110 --> 00:43:28,410
<font color="#CCCCCC">be like hyper like super leet and 20</font>

935
00:43:25,080 --> 00:43:30,870
<font color="#E5E5E5">characters long but if i can run mimic</font>

936
00:43:28,410 --> 00:43:33,180
cats and you know get that password now

937
00:43:30,870 --> 00:43:36,720
i have local admin privs to every single

938
00:43:33,180 --> 00:43:39,359
<font color="#E5E5E5">box in</font><font color="#CCCCCC"> your environment and if</font><font color="#E5E5E5"> those</font>

939
00:43:36,720 --> 00:43:41,609
local admin privs can be used to<font color="#E5E5E5"> log</font>

940
00:43:39,360 --> 00:43:44,010
them remotely to other machines then

941
00:43:41,610 --> 00:43:45,990
like why do I<font color="#CCCCCC"> really need to main admin</font>

942
00:43:44,010 --> 00:43:47,070
anymore like I can now just run free

943
00:43:45,990 --> 00:43:48,720
throughout your environment and

944
00:43:47,070 --> 00:43:51,360
administer everything to my heart's

945
00:43:48,720 --> 00:43:53,520
content<font color="#E5E5E5"> like as an attacker I'm not out</font>

946
00:43:51,360 --> 00:43:55,740
to do schema upgrades I don't need like

947
00:43:53,520 --> 00:43:57,180
you know domain admin access I just want

948
00:43:55,740 --> 00:44:01,350
to<font color="#E5E5E5"> be</font><font color="#CCCCCC"> able to install and run on</font>

949
00:43:57,180 --> 00:44:03,899
your boxes so there's a couple ways you

950
00:44:01,350 --> 00:44:05,759
can address this one is you should be

951
00:44:03,900 --> 00:44:09,030
randomizing your local admin passwords

952
00:44:05,760 --> 00:44:11,520
and Microsoft provides a great solution

953
00:44:09,030 --> 00:44:14,510
for this that they just don't advertise

954
00:44:11,520 --> 00:44:19,140
well enough I think and it's called laps

955
00:44:14,510 --> 00:44:22,020
it is super<font color="#CCCCCC"> easy to</font><font color="#E5E5E5"> implement it works</font>

956
00:44:19,140 --> 00:44:25,259
as basically<font color="#E5E5E5"> what a-what</font><font color="#CCCCCC"> lapse does is</font>

957
00:44:22,020 --> 00:44:27,840
it installs a client on<font color="#CCCCCC"> the local</font>

958
00:44:25,260 --> 00:44:29,600
workstation it extends the Active

959
00:44:27,840 --> 00:44:32,420
Directory schema to

960
00:44:29,600 --> 00:44:35,390
a password<font color="#E5E5E5"> field to your computer</font>

961
00:44:32,420 --> 00:44:37,130
objects and then through group policy it

962
00:44:35,390 --> 00:44:38,150
just communicates with that client says

963
00:44:37,130 --> 00:44:41,540
hey it's time<font color="#E5E5E5"> to update your password</font>

964
00:44:38,150 --> 00:44:43,640
the client sends<font color="#E5E5E5"> password to that field</font>

965
00:44:41,540 --> 00:44:45,290
and Active Directory that active

966
00:44:43,640 --> 00:44:47,089
directory is what's called a<font color="#E5E5E5"> protectant</font>

967
00:44:45,290 --> 00:44:49,400
or that Active Directory field is what's

968
00:44:47,090 --> 00:44:51,200
called a protected field so only your

969
00:44:49,400 --> 00:44:52,940
domain admins have access to initially

970
00:44:51,200 --> 00:44:54,950
and you can kind of dole out access as

971
00:44:52,940 --> 00:44:57,260
you see fit and what's<font color="#E5E5E5"> great is you can</font>

972
00:44:54,950 --> 00:45:01,370
totally log all of that it's also fully

973
00:44:57,260 --> 00:45:02,750
supported by microsoft they have gone on

974
00:45:01,370 --> 00:45:04,370
record saying like hey if you want to

975
00:45:02,750 --> 00:45:06,560
run this and reset your local admin

976
00:45:04,370 --> 00:45:09,259
passwords every single day like you can

977
00:45:06,560 --> 00:45:11,029
still call<font color="#E5E5E5"> us up and we'll support it so</font>

978
00:45:09,260 --> 00:45:13,700
<font color="#E5E5E5">super easy to set up definitely</font><font color="#CCCCCC"> worth</font>

979
00:45:11,030 --> 00:45:15,230
looking into absolutely free<font color="#CCCCCC"> there is no</font>

980
00:45:13,700 --> 00:45:18,049
<font color="#E5E5E5">reason this shouldn't be running in your</font>

981
00:45:15,230 --> 00:45:20,720
environment the other great thing is

982
00:45:18,050 --> 00:45:22,700
that should be done is preventing local

983
00:45:20,720 --> 00:45:25,819
admins from logging into other boxes

984
00:45:22,700 --> 00:45:27,589
there's really no reason in an

985
00:45:25,820 --> 00:45:31,310
<font color="#E5E5E5">environment that a local admin should</font>

986
00:45:27,590 --> 00:45:33,530
log<font color="#CCCCCC"> into another computer remotely and</font>

987
00:45:31,310 --> 00:45:35,450
that's another real easy fix through

988
00:45:33,530 --> 00:45:39,280
group policy you<font color="#E5E5E5"> can just update the</font>

989
00:45:35,450 --> 00:45:42,560
denying access group policy object to

990
00:45:39,280 --> 00:45:44,060
omit local administrators and prevent

991
00:45:42,560 --> 00:45:45,860
that from happening so now with this

992
00:45:44,060 --> 00:45:48,200
<font color="#E5E5E5">configuration if I get a local admin</font>

993
00:45:45,860 --> 00:45:49,790
password it's good<font color="#E5E5E5"> for that box and</font>

994
00:45:48,200 --> 00:45:51,410
that's it<font color="#E5E5E5"> and it's</font><font color="#CCCCCC"> probably going to</font>

995
00:45:49,790 --> 00:45:53,150
change in 20 days or whatever you have

996
00:45:51,410 --> 00:45:55,850
<font color="#CCCCCC">it configured</font><font color="#E5E5E5"> for it so you greatly</font>

997
00:45:53,150 --> 00:46:00,560
reduce the risk of just you know loose

998
00:45:55,850 --> 00:46:02,420
creds the other<font color="#CCCCCC"> interesting thing that</font>

999
00:46:00,560 --> 00:46:06,200
I've kind of seen mentioned recently is

1000
00:46:02,420 --> 00:46:08,780
we regularly approach<font color="#E5E5E5"> privileged access</font>

1001
00:46:06,200 --> 00:46:10,430
protecting privileged access from from a

1002
00:46:08,780 --> 00:46:13,940
bottom-up sort of standpoint<font color="#E5E5E5"> we don't</font>

1003
00:46:10,430 --> 00:46:16,060
want lower user lower level<font color="#E5E5E5"> users</font>

1004
00:46:13,940 --> 00:46:20,690
performing administrative actions right

1005
00:46:16,060 --> 00:46:22,460
so it's also starting to<font color="#E5E5E5"> come out that</font>

1006
00:46:20,690 --> 00:46:24,020
<font color="#CCCCCC">really this idea that</font><font color="#E5E5E5"> you should be</font>

1007
00:46:22,460 --> 00:46:26,030
<font color="#CCCCCC">approaching</font><font color="#E5E5E5"> is from the reverse side as</font>

1008
00:46:24,020 --> 00:46:28,460
well you don't want your domain admins

1009
00:46:26,030 --> 00:46:31,970
logging into local workstations<font color="#E5E5E5"> there's</font>

1010
00:46:28,460 --> 00:46:33,680
no reason for<font color="#CCCCCC"> that you know your your</font>

1011
00:46:31,970 --> 00:46:35,209
<font color="#E5E5E5">domain admin accounts these high</font>

1012
00:46:33,680 --> 00:46:38,419
privileged accounts should be used

1013
00:46:35,210 --> 00:46:40,190
solely for administering the domain so

1014
00:46:38,420 --> 00:46:42,650
many people treat domain admin account

1015
00:46:40,190 --> 00:46:44,869
says basically a administrator account

1016
00:46:42,650 --> 00:46:46,369
like<font color="#E5E5E5"> I need to install software so I'm</font>

1017
00:46:44,869 --> 00:46:48,140
going to<font color="#E5E5E5"> use the domain admin account</font>

1018
00:46:46,369 --> 00:46:50,300
it's like know the the domain admin

1019
00:46:48,140 --> 00:46:52,549
account is should be you know extending

1020
00:46:50,300 --> 00:46:53,930
schemas and cleaning up ad objects<font color="#E5E5E5"> and</font>

1021
00:46:52,550 --> 00:46:57,589
 like that it shouldn't be<font color="#E5E5E5"> used for</font>

1022
00:46:53,930 --> 00:47:01,009
installing photoshop on<font color="#E5E5E5"> an endpoint so</font>

1023
00:46:57,589 --> 00:47:02,540
setting up your domain which is starts

1024
00:47:01,010 --> 00:47:04,910
to where you get into privileged access

1025
00:47:02,540 --> 00:47:07,190
<font color="#E5E5E5">workstations which microsoft has a lot</font>

1026
00:47:04,910 --> 00:47:08,598
of great documentation on that you<font color="#E5E5E5"> know</font>

1027
00:47:07,190 --> 00:47:11,300
if you go to that<font color="#E5E5E5"> link it kind of links</font>

1028
00:47:08,599 --> 00:47:13,609
to<font color="#E5E5E5"> their documentation on</font><font color="#CCCCCC"> that but</font>

1029
00:47:11,300 --> 00:47:15,710
definitely something to look into is you

1030
00:47:13,609 --> 00:47:17,900
know administrating boxes from a

1031
00:47:15,710 --> 00:47:20,329
dedicated machine a vm or something like

1032
00:47:17,900 --> 00:47:22,250
that and using<font color="#CCCCCC"> those accounts solely for</font>

1033
00:47:20,329 --> 00:47:23,810
administration using a lesser user

1034
00:47:22,250 --> 00:47:28,490
account for your<font color="#E5E5E5"> day-to-day web browsing</font>

1035
00:47:23,810 --> 00:47:30,170
and stuff like that same boat service

1036
00:47:28,490 --> 00:47:32,450
accounts never need to main admin access

1037
00:47:30,170 --> 00:47:34,280
like they should never need domain admin

1038
00:47:32,450 --> 00:47:36,140
access and<font color="#CCCCCC"> i know it's really</font><font color="#E5E5E5"> hard</font><font color="#CCCCCC"> when</font>

1039
00:47:34,280 --> 00:47:38,119
it comes to things<font color="#E5E5E5"> like backups and</font>

1040
00:47:36,140 --> 00:47:40,520
stuff like that but<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> you come</font>

1041
00:47:38,119 --> 00:47:43,190
across so many accounts where it's like

1042
00:47:40,520 --> 00:47:45,050
I need the schedule test to like copy

1043
00:47:43,190 --> 00:47:46,880
some files from A to B so I'm going to

1044
00:47:45,050 --> 00:47:49,339
<font color="#E5E5E5">run them as a domain admin so you know</font>

1045
00:47:46,880 --> 00:47:51,980
that's that's completely abusing the

1046
00:47:49,339 --> 00:47:54,740
domain admin privileges so these real

1047
00:47:51,980 --> 00:47:59,000
basic concepts like it addresses most of

1048
00:47:54,740 --> 00:48:01,578
what PowerShell is being used for any

1049
00:47:59,000 --> 00:48:04,240
other thing that I<font color="#E5E5E5"> definitely want to</font>

1050
00:48:01,579 --> 00:48:07,960
talk<font color="#CCCCCC"> about and this is</font><font color="#E5E5E5"> just general</font>

1051
00:48:04,240 --> 00:48:11,180
<font color="#CCCCCC">Windows security</font><font color="#E5E5E5"> is logging what matters</font>

1052
00:48:07,960 --> 00:48:14,390
when I was a sysadmin it was really hard

1053
00:48:11,180 --> 00:48:16,549
for<font color="#CCCCCC"> me to</font><font color="#E5E5E5"> find resources on</font><font color="#CCCCCC"> okay</font>

1054
00:48:14,390 --> 00:48:19,250
<font color="#CCCCCC">Microsoft has you know like</font>

1055
00:48:16,550 --> 00:48:22,190
20,000 of nids how do I know which<font color="#E5E5E5"> ones</font>

1056
00:48:19,250 --> 00:48:24,619
actually matter<font color="#E5E5E5"> Jessica pain is a</font>

1057
00:48:22,190 --> 00:48:28,460
instant responder for Microsoft and she

1058
00:48:24,619 --> 00:48:31,010
put together a great article<font color="#E5E5E5"> on login</font>

1059
00:48:28,460 --> 00:48:34,190
what matters and using Windows built-in

1060
00:48:31,010 --> 00:48:37,190
event log forwarding almost as a cheap

1061
00:48:34,190 --> 00:48:39,230
free sim<font color="#E5E5E5"> for your environment so</font>

1062
00:48:37,190 --> 00:48:42,050
<font color="#E5E5E5">basically she covers how to log things</font>

1063
00:48:39,230 --> 00:48:44,060
like your event log is being cleared

1064
00:48:42,050 --> 00:48:45,710
which that should raise red welcome<font color="#E5E5E5"> you</font>

1065
00:48:44,060 --> 00:48:47,060
know alarm bells throughout your

1066
00:48:45,710 --> 00:48:49,430
environment there's never a good reason

1067
00:48:47,060 --> 00:48:50,090
for<font color="#E5E5E5"> event logs to be manually cleared</font>

1068
00:48:49,430 --> 00:48:52,460
when

1069
00:48:50,090 --> 00:48:55,700
somebody clears event logs that logs an

1070
00:48:52,460 --> 00:48:57,650
event that should be instantly forwarded

1071
00:48:55,700 --> 00:48:59,299
to your sim to your sock you know tears

1072
00:48:57,650 --> 00:49:02,480
this admins whoever's monitoring the

1073
00:48:59,300 --> 00:49:04,550
sort of<font color="#E5E5E5"> stuff you can also monitor dcs</font>

1074
00:49:02,480 --> 00:49:06,650
for stuff like you know domain admins or

1075
00:49:04,550 --> 00:49:09,710
<font color="#E5E5E5">enterprise admins groups being changed</font>

1076
00:49:06,650 --> 00:49:13,970
this<font color="#CCCCCC"> is a very ok thanks a very rare</font>

1077
00:49:09,710 --> 00:49:15,500
event<font color="#E5E5E5"> that you know should be brought to</font>

1078
00:49:13,970 --> 00:49:18,830
your attention when it<font color="#E5E5E5"> happens same goes</font>

1079
00:49:15,500 --> 00:49:21,350
for local groups local admins how often

1080
00:49:18,830 --> 00:49:23,720
<font color="#E5E5E5">is a local account created in</font><font color="#CCCCCC"> your</font>

1081
00:49:21,350 --> 00:49:26,420
enterprise you know hon a and users

1082
00:49:23,720 --> 00:49:29,060
workstation it should<font color="#CCCCCC"> be once a quarter</font>

1083
00:49:26,420 --> 00:49:31,430
maybe so definitely<font color="#CCCCCC"> something you want</font>

1084
00:49:29,060 --> 00:49:33,830
<font color="#E5E5E5">to be aware of if that's happening same</font>

1085
00:49:31,430 --> 00:49:35,450
goes for new services not something that

1086
00:49:33,830 --> 00:49:36,980
happens super often when a new service

1087
00:49:35,450 --> 00:49:38,419
is created on an<font color="#E5E5E5"> endpoint you should</font>

1088
00:49:36,980 --> 00:49:39,980
probably be aware that that is happening

1089
00:49:38,420 --> 00:49:42,590
<font color="#E5E5E5">because that's a great sign of</font>

1090
00:49:39,980 --> 00:49:43,930
compromise within your environment now

1091
00:49:42,590 --> 00:49:46,280
if<font color="#E5E5E5"> we want to talk specifically about</font>

1092
00:49:43,930 --> 00:49:48,919
<font color="#E5E5E5">PowerShell and how to secure against</font>

1093
00:49:46,280 --> 00:49:51,710
<font color="#E5E5E5">PowerShell power show offers insane</font>

1094
00:49:48,920 --> 00:49:54,200
amounts of logging each version para

1095
00:49:51,710 --> 00:49:56,540
show creates more and more logs to the

1096
00:49:54,200 --> 00:49:59,149
point where with powershell version 5

1097
00:49:56,540 --> 00:50:01,520
which<font color="#CCCCCC"> is the most recent version but you</font>

1098
00:49:59,150 --> 00:50:04,490
can install<font color="#CCCCCC"> it on any you know windows 7</font>

1099
00:50:01,520 --> 00:50:06,620
and up offers basically over the

1100
00:50:04,490 --> 00:50:08,390
shoulder transcription logging where you

1101
00:50:06,620 --> 00:50:10,520
can<font color="#E5E5E5"> see every single thing that's typed</font>

1102
00:50:08,390 --> 00:50:12,759
into<font color="#E5E5E5"> the console and it gets logged to</font>

1103
00:50:10,520 --> 00:50:16,759
<font color="#E5E5E5">an event log and you can ship that out</font>

1104
00:50:12,760 --> 00:50:18,740
the other thing is if you are deploying

1105
00:50:16,760 --> 00:50:20,960
newer versions of PowerShell make sure

1106
00:50:18,740 --> 00:50:23,149
to remove PowerShell 20 when you do this

1107
00:50:20,960 --> 00:50:26,180
a lot of the PowerShell upgrades aren't

1108
00:50:23,150 --> 00:50:27,710
an in-place upgrade excuse me so

1109
00:50:26,180 --> 00:50:31,399
PowerShell 20 is still going to<font color="#E5E5E5"> be</font>

1110
00:50:27,710 --> 00:50:34,370
<font color="#CCCCCC">available if you run PS attack on a box</font>

1111
00:50:31,400 --> 00:50:36,710
<font color="#CCCCCC">that has both 2 dot</font><font color="#E5E5E5"> 0 and you know</font><font color="#CCCCCC"> four</font>

1112
00:50:34,370 --> 00:50:38,569
<font color="#CCCCCC">or five dot 0 PS attack is going</font><font color="#E5E5E5"> to use</font>

1113
00:50:36,710 --> 00:50:40,700
<font color="#CCCCCC">two dot 0 by default because none of</font>

1114
00:50:38,570 --> 00:50:44,089
that<font color="#CCCCCC"> login</font><font color="#E5E5E5"> is there so you know</font>

1115
00:50:40,700 --> 00:50:47,149
leverage that but as an example this<font color="#CCCCCC"> is</font>

1116
00:50:44,089 --> 00:50:48,950
when you run PS attack on a box as an

1117
00:50:47,150 --> 00:50:51,500
<font color="#CCCCCC">ant's logging this is the sort of stuff</font>

1118
00:50:48,950 --> 00:50:54,560
<font color="#E5E5E5">you see you can see hey we are running</font>

1119
00:50:51,500 --> 00:50:56,510
in both mimic<font color="#E5E5E5"> cats right now it logs it</font>

1120
00:50:54,560 --> 00:51:00,349
after<font color="#CCCCCC"> all that encryption and</font>

1121
00:50:56,510 --> 00:51:02,089
obfuscation none of<font color="#CCCCCC"> that matters to the</font>

1122
00:51:00,349 --> 00:51:04,480
event log<font color="#E5E5E5"> it's log in it right when it's</font>

1123
00:51:02,089 --> 00:51:07,970
right when it's<font color="#E5E5E5"> about</font><font color="#CCCCCC"> to run that</font><font color="#E5E5E5"> script</font>

1124
00:51:04,480 --> 00:51:09,500
so when you run PS attack with<font color="#E5E5E5"> lot of</font>

1125
00:51:07,970 --> 00:51:10,759
<font color="#CCCCCC">games totally turned up I think it</font>

1126
00:51:09,500 --> 00:51:13,430
generates something like nine hundred

1127
00:51:10,760 --> 00:51:17,270
some odd events in the event log like it

1128
00:51:13,430 --> 00:51:19,879
is the noisiest like language ever so in

1129
00:51:17,270 --> 00:51:22,280
a properly configured environment

1130
00:51:19,880 --> 00:51:24,230
powershell is the absolute worst thing

1131
00:51:22,280 --> 00:51:28,160
an attacker can use because it<font color="#E5E5E5"> is noisy</font>

1132
00:51:24,230 --> 00:51:30,800
as like I would<font color="#CCCCCC"> much rather go back</font>

1133
00:51:28,160 --> 00:51:32,210
to visual basic or Python or something

1134
00:51:30,800 --> 00:51:34,820
like that<font color="#E5E5E5"> where there isn't that log</font>

1135
00:51:32,210 --> 00:51:38,450
game you know its power shell shouldn't

1136
00:51:34,820 --> 00:51:39,770
be scary that kind of leads to some of

1137
00:51:38,450 --> 00:51:43,730
the last reading they'll leave you guys

1138
00:51:39,770 --> 00:51:46,310
off with there's a goatee PFE did a

1139
00:51:43,730 --> 00:51:49,760
great summary of the modern state of

1140
00:51:46,310 --> 00:51:53,150
PowerShell security you can get to that

1141
00:51:49,760 --> 00:51:55,250
<font color="#E5E5E5">at that link there Sean Metcalf if</font>

1142
00:51:53,150 --> 00:51:59,060
you're not<font color="#E5E5E5"> familiar with him super cool</font>

1143
00:51:55,250 --> 00:52:01,099
dude basically the like the voice for

1144
00:51:59,060 --> 00:52:04,130
securing active directory<font color="#CCCCCC"> in windows</font>

1145
00:52:01,099 --> 00:52:06,109
today like just<font color="#E5E5E5"> a great guy he wrote a</font>

1146
00:52:04,130 --> 00:52:09,410
great article on defending against

1147
00:52:06,109 --> 00:52:10,640
PowerShell attack tools and everybody

1148
00:52:09,410 --> 00:52:12,200
should just follow jessica pain on

1149
00:52:10,640 --> 00:52:14,990
<font color="#E5E5E5">twitter and do whatever she says because</font>

1150
00:52:12,200 --> 00:52:17,060
she just treats constant gold as far as

1151
00:52:14,990 --> 00:52:18,439
like defending windows and working as an

1152
00:52:17,060 --> 00:52:24,049
incident under a lot of great stuff

1153
00:52:18,440 --> 00:52:26,930
<font color="#CCCCCC">coming</font><font color="#E5E5E5"> from her alright so we talked</font>

1154
00:52:24,050 --> 00:52:29,450
about PS attack that's the tool that i

1155
00:52:26,930 --> 00:52:31,009
wrote makes it easy to use<font color="#CCCCCC"> Farish all</font>

1156
00:52:29,450 --> 00:52:35,118
offensively<font color="#CCCCCC"> you should totally use the</font>

1157
00:52:31,010 --> 00:52:38,690
build tool it is<font color="#CCCCCC"> open source so if you</font>

1158
00:52:35,119 --> 00:52:40,900
guys have any suggestions feel free to

1159
00:52:38,690 --> 00:52:42,430
<font color="#E5E5E5">submit either issues</font>

1160
00:52:40,900 --> 00:52:43,750
or if you don't<font color="#CCCCCC"> have a code if you want</font>

1161
00:52:42,430 --> 00:52:46,569
to submit a<font color="#CCCCCC"> pro request that would be</font>

1162
00:52:43,750 --> 00:52:48,030
super appreciated but really I just love

1163
00:52:46,570 --> 00:52:50,770
hearing any sort<font color="#E5E5E5"> of feedback whatsoever</font>

1164
00:52:48,030 --> 00:52:53,110
you know if you used on engagement and

1165
00:52:50,770 --> 00:52:54,759
it was great let me know if you tried to

1166
00:52:53,110 --> 00:52:56,380
<font color="#E5E5E5">run something it didn't behave the way</font>

1167
00:52:54,760 --> 00:52:58,510
you expected I want to hear<font color="#E5E5E5"> about that</font>

1168
00:52:56,380 --> 00:53:01,810
<font color="#E5E5E5">too so you know whatever</font><font color="#CCCCCC"> you want to</font>

1169
00:52:58,510 --> 00:53:03,760
talk<font color="#E5E5E5"> to me about like as long as it's</font>

1170
00:53:01,810 --> 00:53:06,549
related<font color="#CCCCCC"> to PS attack I'll talk to you</font>

1171
00:53:03,760 --> 00:53:09,640
about it otherwise I have very<font color="#E5E5E5"> small</font>

1172
00:53:06,550 --> 00:53:12,040
this stuff I'm interested in so we'll

1173
00:53:09,640 --> 00:53:13,720
<font color="#E5E5E5">see if we hit up on that the last thing</font>

1174
00:53:12,040 --> 00:53:16,330
<font color="#E5E5E5">I want to leave off on is if you are</font>

1175
00:53:13,720 --> 00:53:18,970
<font color="#E5E5E5">working in defense there is no</font><font color="#CCCCCC"> reason to</font>

1176
00:53:16,330 --> 00:53:21,900
be afraid of power show any properly

1177
00:53:18,970 --> 00:53:25,299
configured environment PowerShell is

1178
00:53:21,900 --> 00:53:29,830
useless to offenders it's it's crazy

1179
00:53:25,300 --> 00:53:31,270
<font color="#E5E5E5">nosy I want to wrap up with if I'd</font>

1180
00:53:29,830 --> 00:53:33,220
mentioned earlier<font color="#CCCCCC"> about the PowerShell</font>

1181
00:53:31,270 --> 00:53:34,960
click that you know if you're if you're

1182
00:53:33,220 --> 00:53:36,939
not following the PowerShell community

1183
00:53:34,960 --> 00:53:38,590
then you know you're<font color="#E5E5E5"> kind of missing out</font>

1184
00:53:36,940 --> 00:53:41,140
<font color="#E5E5E5">on all the cool stuff that's happening</font>

1185
00:53:38,590 --> 00:53:44,710
out there this is a great starting point

1186
00:53:41,140 --> 00:53:46,900
for<font color="#CCCCCC"> that click these guys are really</font>

1187
00:53:44,710 --> 00:53:49,030
they<font color="#CCCCCC"> are the people that developed all</font>

1188
00:53:46,900 --> 00:53:52,150
the cool offensive<font color="#E5E5E5"> stuff that went into</font>

1189
00:53:49,030 --> 00:53:54,190
PS attack so<font color="#E5E5E5"> definitely worth following</font>

1190
00:53:52,150 --> 00:53:55,600
them and you know giving them the

1191
00:53:54,190 --> 00:53:58,810
attention that they deserve a lot<font color="#CCCCCC"> of</font>

1192
00:53:55,600 --> 00:54:01,060
great stuff coming out of that group and

1193
00:53:58,810 --> 00:54:04,750
that's it for<font color="#E5E5E5"> me I am Jared</font><font color="#CCCCCC"> 8 on twitter</font>

1194
00:54:01,060 --> 00:54:06,790
if<font color="#CCCCCC"> you want to email me j'ai hate at</font><font color="#E5E5E5"> GDS</font>

1195
00:54:04,750 --> 00:54:08,830
security com if you're in the Charlotte

1196
00:54:06,790 --> 00:54:11,080
area a group of us get together about

1197
00:54:08,830 --> 00:54:13,690
once a month<font color="#CCCCCC"> for Charlotte hackers</font>

1198
00:54:11,080 --> 00:54:16,390
anonymous where we talk about hacking

1199
00:54:13,690 --> 00:54:19,060
stuff so totally worth checking that out

1200
00:54:16,390 --> 00:54:21,220
and all of the links that i posted

1201
00:54:19,060 --> 00:54:23,410
throughout this talk are available at

1202
00:54:21,220 --> 00:54:27,520
that website down there Jared hate

1203
00:54:23,410 --> 00:54:29,140
<font color="#E5E5E5">key-based pal so yeah I think we have a</font>

1204
00:54:27,520 --> 00:54:34,200
little bit<font color="#CCCCCC"> of time questions or you guys</font>

1205
00:54:29,140 --> 00:54:34,200
can go run and get food question

1206
00:54:38,290 --> 00:54:44,470
so yeah the question<font color="#CCCCCC"> is how does the</font>

1207
00:54:41,330 --> 00:54:47,540
PowerShell login handle base64 encoding

1208
00:54:44,470 --> 00:54:49,459
<font color="#CCCCCC">powershell login what it does is it's</font>

1209
00:54:47,540 --> 00:54:51,680
going<font color="#E5E5E5"> to log everything right before it</font>

1210
00:54:49,460 --> 00:54:54,440
hits the<font color="#E5E5E5"> scripting knows which is the</font>

1211
00:54:51,680 --> 00:54:56,839
<font color="#E5E5E5">actual engine that runs scripting stuff</font>

1212
00:54:54,440 --> 00:54:59,900
in Windows so yeah it would totally you

1213
00:54:56,839 --> 00:55:04,549
would see the decoded command being

1214
00:54:59,900 --> 00:55:07,520
wrong so yeah same goes for encryption

1215
00:55:04,550 --> 00:55:10,130
the only thing that can really mess with

1216
00:55:07,520 --> 00:55:12,259
it and from what I understand<font color="#E5E5E5"> is like</font>

1217
00:55:10,130 --> 00:55:14,240
obfuscation because it's still legit

1218
00:55:12,260 --> 00:55:17,510
PowerShell that you're running there's

1219
00:55:14,240 --> 00:55:19,729
nothing for it to try to like d you know

1220
00:55:17,510 --> 00:55:21,290
compress or whatever but you'll still

1221
00:55:19,730 --> 00:55:24,890
see at<font color="#E5E5E5"> least what the obfuscating</font>

1222
00:55:21,290 --> 00:55:29,180
command was that was wrong so any other

1223
00:55:24,890 --> 00:55:33,129
questions<font color="#CCCCCC"> alright guys well thank</font><font color="#E5E5E5"> you</font>

1224
00:55:29,180 --> 00:55:33,129
<font color="#E5E5E5">very much I'm</font><font color="#CCCCCC"> very calm</font>

