1
00:00:28,550 --> 00:00:32,668
all right so welcome welcome to having a

2
00:00:32,668 --> 00:00:34,770
picket illiterate or malware stagers and

3
00:00:34,770 --> 00:00:36,870
Enterprise Services this is a very

4
00:00:36,870 --> 00:00:41,579
windows heavy Oh a little bit about

5
00:00:41,579 --> 00:00:43,199
myself I'm with the Department of

6
00:00:43,199 --> 00:00:44,610
Defense been within roughly eighteen

7
00:00:44,610 --> 00:00:46,199
years started off as a system

8
00:00:46,199 --> 00:00:50,010
administrator moved into sock defense if

9
00:00:50,010 --> 00:00:53,309
you will about six years ago let an

10
00:00:53,309 --> 00:00:55,589
incident response team through a number

11
00:00:55,589 --> 00:00:58,979
of high visibility incident and then

12
00:00:58,979 --> 00:01:01,290
moved over to vulnerability assessment

13
00:01:01,290 --> 00:01:03,720
Red Team if you will and now I'm going

14
00:01:03,720 --> 00:01:05,519
to the director of an operation center

15
00:01:05,519 --> 00:01:07,890
where we do both vulnerability

16
00:01:07,890 --> 00:01:10,170
assessment Red Team and incident

17
00:01:10,170 --> 00:01:10,799
response

18
00:01:10,799 --> 00:01:13,409
I'm a adjunct sub security professor and

19
00:01:13,409 --> 00:01:14,790
a local college down in the gusted

20
00:01:14,790 --> 00:01:16,229
Georgia that's why I come to you all

21
00:01:16,229 --> 00:01:16,530
from

22
00:01:16,530 --> 00:01:18,210
I developed a number of red and blue

23
00:01:18,210 --> 00:01:21,180
team tools I like PowerShell you'll see

24
00:01:21,180 --> 00:01:23,400
that throughout this and I'm out

25
00:01:23,400 --> 00:01:24,750
throwing the interwebz in a couple of

26
00:01:24,750 --> 00:01:28,290
places alright so here's the agenda well

27
00:01:28,290 --> 00:01:30,990
really highlight really the history of

28
00:01:30,990 --> 00:01:33,360
such talking about some malware talking

29
00:01:33,360 --> 00:01:35,370
about the kill chain or a methodology

30
00:01:35,370 --> 00:01:39,060
will go through utilizing said

31
00:01:39,060 --> 00:01:42,300
methodology or tactic to to hide stagers

32
00:01:42,300 --> 00:01:44,310
and enterprise services and then I'll

33
00:01:44,310 --> 00:01:46,830
end this with a demo in which I'll

34
00:01:46,830 --> 00:01:48,360
highlight or really walk through each

35
00:01:48,360 --> 00:01:51,540
one of those all right so first we got

36
00:01:51,540 --> 00:01:53,370
to kind of start off with definition so

37
00:01:53,370 --> 00:01:55,260
this whole malware thing all right what

38
00:01:55,260 --> 00:01:55,650
is it

39
00:01:55,650 --> 00:01:57,900
well you see a lot of text up there but

40
00:01:57,900 --> 00:01:59,520
really the meaning potatoes of it is is

41
00:01:59,520 --> 00:02:02,400
that malware is gonna be an actual piece

42
00:02:02,400 --> 00:02:03,840
of code developed by somebody to

43
00:02:03,840 --> 00:02:06,900
actually inflict something on a person's

44
00:02:06,900 --> 00:02:08,610
machine whether they want to actually

45
00:02:08,610 --> 00:02:10,348
take it down whether they want to take

46
00:02:10,348 --> 00:02:12,360
over it but nonetheless it's gonna be

47
00:02:12,360 --> 00:02:15,030
code at heart it's kind of interesting

48
00:02:15,030 --> 00:02:16,439
when we think about malware

49
00:02:16,439 --> 00:02:18,330
now there's different variations of it

50
00:02:18,330 --> 00:02:20,069
but before we even get into that let's

51
00:02:20,069 --> 00:02:21,750
let's talk about where it all started

52
00:02:21,750 --> 00:02:24,840
well roughly back in 1971 there was a

53
00:02:24,840 --> 00:02:26,730
guy by the name of Ben Thomas who

54
00:02:26,730 --> 00:02:28,950
actually developed the creeper malware

55
00:02:28,950 --> 00:02:31,140
and literally what it did is right

56
00:02:31,140 --> 00:02:33,060
through the screen I'm a creeper

57
00:02:33,060 --> 00:02:35,909
catching me if you can and it propagated

58
00:02:35,909 --> 00:02:38,400
by hand it was very manual in nature

59
00:02:38,400 --> 00:02:40,139
we're talking floppy disks right can't

60
00:02:40,139 --> 00:02:41,569
even find a floppy disk these days

61
00:02:41,569 --> 00:02:43,819
I say that like some organization still

62
00:02:43,819 --> 00:02:47,269
have um but that's that was the first

63
00:02:47,269 --> 00:02:50,569
piece of what we know to be malware and

64
00:02:50,569 --> 00:02:53,150
it relied on human interaction that's

65
00:02:53,150 --> 00:02:55,640
kind of interesting because now today we

66
00:02:55,640 --> 00:02:57,379
don't see human interaction being a

67
00:02:57,379 --> 00:03:01,640
necessity as much right and today we see

68
00:03:01,640 --> 00:03:03,459
things that are much more sophisticated

69
00:03:03,459 --> 00:03:06,170
right much more streamlined may be

70
00:03:06,170 --> 00:03:08,090
broken up to different phases if you

71
00:03:08,090 --> 00:03:09,860
will and they're constantly evolving

72
00:03:09,860 --> 00:03:12,709
it's a constant cat-and-mouse game from

73
00:03:12,709 --> 00:03:14,030
a defense perspective you're

74
00:03:14,030 --> 00:03:16,329
consistently trying to highlight what

75
00:03:16,329 --> 00:03:18,440
adversaries are doing trying to put

76
00:03:18,440 --> 00:03:19,700
things in place in which you can

77
00:03:19,700 --> 00:03:21,349
articulate and really highlight the

78
00:03:21,349 --> 00:03:22,849
activities that they're doing and as a

79
00:03:22,849 --> 00:03:24,440
red team where vulnerability assessment

80
00:03:24,440 --> 00:03:26,090
person you're just sitting there trying

81
00:03:26,090 --> 00:03:28,609
to find some loophole buzz that software

82
00:03:28,609 --> 00:03:30,560
and find something that allows you to

83
00:03:30,560 --> 00:03:32,930
gain some code execution and even better

84
00:03:32,930 --> 00:03:36,109
a shell a root shell is really what

85
00:03:36,109 --> 00:03:38,959
we're after right but it also has some

86
00:03:38,959 --> 00:03:41,000
financial gain with it because we have

87
00:03:41,000 --> 00:03:43,640
criminals doing it for the purpose of

88
00:03:43,640 --> 00:03:44,959
financial gain

89
00:03:44,959 --> 00:03:48,230
we have government's doing it right

90
00:03:48,230 --> 00:03:50,060
trying to get after the political game

91
00:03:50,060 --> 00:03:52,790
and in all honesty it's almost like a

92
00:03:52,790 --> 00:03:55,549
silent war happening that we don't see

93
00:03:55,549 --> 00:03:58,190
on the streets or really see as much in

94
00:03:58,190 --> 00:04:00,739
the news and let's it's some wine owned

95
00:04:00,739 --> 00:04:04,250
company of source so when we look at the

96
00:04:04,250 --> 00:04:07,720
common types of malware all right we see

97
00:04:07,720 --> 00:04:10,760
what's before us and generally speaking

98
00:04:10,760 --> 00:04:14,030
I think worms and viruses are kind of

99
00:04:14,030 --> 00:04:16,099
the thing we previously always thought

100
00:04:16,099 --> 00:04:19,220
about when we mentioned malware but now

101
00:04:19,220 --> 00:04:20,720
we see a lot of rant so we're definitely

102
00:04:20,720 --> 00:04:23,150
financial game right where somebody's

103
00:04:23,150 --> 00:04:24,349
trying to get code execution on the

104
00:04:24,349 --> 00:04:26,120
system they want to encrypt the drive

105
00:04:26,120 --> 00:04:28,090
they want to hold the system for ransom

106
00:04:28,090 --> 00:04:30,620
we see root kits that's always been a

107
00:04:30,620 --> 00:04:33,349
thing all right there's user mode most

108
00:04:33,349 --> 00:04:37,370
common there's actual kernel level very

109
00:04:37,370 --> 00:04:39,440
sophisticated right at that point it

110
00:04:39,440 --> 00:04:40,669
makes it a little bit more difficult to

111
00:04:40,669 --> 00:04:42,740
trust the system to really even identify

112
00:04:42,740 --> 00:04:44,930
it and then you have like a hypervisor

113
00:04:44,930 --> 00:04:47,330
version of it so we can get in the inner

114
00:04:47,330 --> 00:04:49,099
workings of actual working with virtual

115
00:04:49,099 --> 00:04:51,740
machines Trojans kind of go without

116
00:04:51,740 --> 00:04:54,760
saying key logs are definitely much more

117
00:04:54,760 --> 00:04:56,200
prevalent especially when you think

118
00:04:56,200 --> 00:04:57,700
about people trying to do things for

119
00:04:57,700 --> 00:05:00,970
financial gains or gain in execution or

120
00:05:00,970 --> 00:05:03,730
access to a machine then we have great

121
00:05:03,730 --> 00:05:07,030
we're right adware spyware the bloatware

122
00:05:07,030 --> 00:05:08,980
that comes on brand-new computers if you

123
00:05:08,980 --> 00:05:11,350
will those are rare we're gonna be

124
00:05:11,350 --> 00:05:16,300
around but all the malware has to have

125
00:05:16,300 --> 00:05:19,300
some very have to have some method to

126
00:05:19,300 --> 00:05:20,500
hide all right

127
00:05:20,500 --> 00:05:22,150
unless you're like Rick James and you

128
00:05:22,150 --> 00:05:23,950
don't really care typically you're gonna

129
00:05:23,950 --> 00:05:25,870
want to hide your malware and some

130
00:05:25,870 --> 00:05:27,610
typical aspects to do that is you're

131
00:05:27,610 --> 00:05:29,470
gonna use some type of packer maybe A to

132
00:05:29,470 --> 00:05:31,510
B X or something else where you want to

133
00:05:31,510 --> 00:05:33,760
add your malware in with some legitimate

134
00:05:33,760 --> 00:05:35,470
program maybe you want to use a new

135
00:05:35,470 --> 00:05:37,840
krypter in which if somebody was trying

136
00:05:37,840 --> 00:05:40,420
to re a to reverse engineer then that

137
00:05:40,420 --> 00:05:42,430
payload and aspects of that data may be

138
00:05:42,430 --> 00:05:44,560
encrypted may be much more difficult for

139
00:05:44,560 --> 00:05:47,470
them to actually understand polymorphic

140
00:05:47,470 --> 00:05:49,930
much more sophisticated consistently

141
00:05:49,930 --> 00:05:52,840
changing its data set and itself as it

142
00:05:52,840 --> 00:05:55,300
traverses right think of how signatures

143
00:05:55,300 --> 00:05:57,460
are ever gonna find that heuristics um

144
00:05:57,460 --> 00:05:59,800
good luck right so polymorphic is

145
00:05:59,800 --> 00:06:01,360
definitely much more sophisticated then

146
00:06:01,360 --> 00:06:04,780
we have stagers they've definitely on

147
00:06:04,780 --> 00:06:07,570
the rise and this allows us to really

148
00:06:07,570 --> 00:06:10,210
survey a machine or do something to a

149
00:06:10,210 --> 00:06:12,760
machine before the real malware come

150
00:06:12,760 --> 00:06:15,160
right so we can all think about some

151
00:06:15,160 --> 00:06:16,810
sport maybe it's boxing

152
00:06:16,810 --> 00:06:18,910
there's the main ticket and then there's

153
00:06:18,910 --> 00:06:21,340
these other people who are boxing before

154
00:06:21,340 --> 00:06:23,080
the main ticket we can almost think of

155
00:06:23,080 --> 00:06:25,420
those other folks as the stages right

156
00:06:25,420 --> 00:06:26,890
there prepping the battlefield if you

157
00:06:26,890 --> 00:06:28,570
will getting everybody height or the

158
00:06:28,570 --> 00:06:30,430
real deal and the real deal is gonna be

159
00:06:30,430 --> 00:06:32,380
the malware I wish the stages come give

160
00:06:32,380 --> 00:06:34,680
so a little bit more about these stages

161
00:06:34,680 --> 00:06:37,510
we know the mesh droppers downloaders

162
00:06:37,510 --> 00:06:39,520
but nonetheless they're they should be

163
00:06:39,520 --> 00:06:40,120
tiny

164
00:06:40,120 --> 00:06:41,800
all right you typically would not want

165
00:06:41,800 --> 00:06:46,180
to use a full mega to payload as a

166
00:06:46,180 --> 00:06:48,820
stager but generally speaking if we're

167
00:06:48,820 --> 00:06:50,470
going to exploit on if that is the

168
00:06:50,470 --> 00:06:51,730
method in which we're going to use to

169
00:06:51,730 --> 00:06:53,800
get on the system we may have a little

170
00:06:53,800 --> 00:06:55,600
minute limited amount of space that we

171
00:06:55,600 --> 00:06:58,030
can actually use for our payload and

172
00:06:58,030 --> 00:06:59,410
this is where stage are actually coming

173
00:06:59,410 --> 00:07:02,230
good with us and once we get access to

174
00:07:02,230 --> 00:07:04,450
that machine our stages should allow us

175
00:07:04,450 --> 00:07:07,120
to actually interact with that machine

176
00:07:07,120 --> 00:07:08,680
ie our stage will

177
00:07:08,680 --> 00:07:12,039
that machine contact us so we can then

178
00:07:12,039 --> 00:07:14,229
either task it for something else

179
00:07:14,229 --> 00:07:17,560
or send an actual real payload that's

180
00:07:17,560 --> 00:07:19,570
gonna actually sit residue on the system

181
00:07:19,570 --> 00:07:22,210
now the big thing about this is it

182
00:07:22,210 --> 00:07:25,020
allows us to break down our toolset

183
00:07:25,020 --> 00:07:28,509
malware development is really expensive

184
00:07:28,509 --> 00:07:30,460
either money-wise

185
00:07:30,460 --> 00:07:33,550
or man our wise but nonetheless I'm not

186
00:07:33,550 --> 00:07:35,320
gonna free willy nilly just throw my

187
00:07:35,320 --> 00:07:37,090
payload all over the place and see what

188
00:07:37,090 --> 00:07:39,639
sticks I want to get on a system survey

189
00:07:39,639 --> 00:07:41,800
it understand if it's even a good

190
00:07:41,800 --> 00:07:43,419
candidate for me to do something with it

191
00:07:43,419 --> 00:07:45,849
and then at that point then lay it down

192
00:07:45,849 --> 00:07:48,160
right maybe my surveying is what type of

193
00:07:48,160 --> 00:07:49,810
antivirus they have on there what's the

194
00:07:49,810 --> 00:07:52,360
state of the system is this a system

195
00:07:52,360 --> 00:07:54,580
owned by somebody like my mother who

196
00:07:54,580 --> 00:07:57,490
doesn't know much of what's going on in

197
00:07:57,490 --> 00:07:59,680
the system or is this some aspiring

198
00:07:59,680 --> 00:08:02,289
young computer science or some type of

199
00:08:02,289 --> 00:08:04,570
admin a person who's really into the

200
00:08:04,570 --> 00:08:07,630
machine now looking at the delivery

201
00:08:07,630 --> 00:08:09,940
mechanism we have something like this we

202
00:08:09,940 --> 00:08:12,280
have the system being exploited in our

203
00:08:12,280 --> 00:08:14,710
stage or being part of it and then we

204
00:08:14,710 --> 00:08:16,960
have the system reaching back out to our

205
00:08:16,960 --> 00:08:20,229
c2 server generally speaking when that

206
00:08:20,229 --> 00:08:22,120
system reaches back out is probably

207
00:08:22,120 --> 00:08:24,550
gonna be on some type of well-known port

208
00:08:24,550 --> 00:08:27,580
in which general client machines would

209
00:08:27,580 --> 00:08:29,349
talk on right so I probably wouldn't

210
00:08:29,349 --> 00:08:31,060
have my stage ever hosted at you know

211
00:08:31,060 --> 00:08:34,390
quad floors or something like that in

212
00:08:34,390 --> 00:08:36,159
that case would blend in a lot more with

213
00:08:36,159 --> 00:08:38,440
normal traffic but when it reaches back

214
00:08:38,440 --> 00:08:39,940
out and we're talking that military

215
00:08:39,940 --> 00:08:41,919
there then I may have something else for

216
00:08:41,919 --> 00:08:44,800
it to grab and it could be virus worm

217
00:08:44,800 --> 00:08:46,870
something else right it could be just

218
00:08:46,870 --> 00:08:49,630
other instructions but nonetheless it's

219
00:08:49,630 --> 00:08:52,150
like that main ticket or that

220
00:08:52,150 --> 00:08:54,940
heavyweight fight right my system is

221
00:08:54,940 --> 00:08:56,500
gonna I'm sorry that systems gonna then

222
00:08:56,500 --> 00:08:58,390
reach out grab whatever that next stage

223
00:08:58,390 --> 00:09:01,029
is once we have that we're gonna set up

224
00:09:01,029 --> 00:09:03,550
some type of encrypted c2 channel where

225
00:09:03,550 --> 00:09:06,700
periodically every or whatever the case

226
00:09:06,700 --> 00:09:08,290
we would then have the ability to

227
00:09:08,290 --> 00:09:09,700
interact with each other

228
00:09:09,700 --> 00:09:11,649
generally I wouldn't have that c2 server

229
00:09:11,649 --> 00:09:14,170
actually initiate communication with

230
00:09:14,170 --> 00:09:17,589
that implant or whatever my follow-on

231
00:09:17,589 --> 00:09:20,589
payload is I'd have this guy on some

232
00:09:20,589 --> 00:09:21,670
period of time

233
00:09:21,670 --> 00:09:23,620
random period of time like I don't want

234
00:09:23,620 --> 00:09:25,630
the periodicity to be so clear-cut where

235
00:09:25,630 --> 00:09:26,950
you could be like hey every three hours

236
00:09:26,950 --> 00:09:28,750
on the dot this thing is actually

237
00:09:28,750 --> 00:09:31,030
reaching out with some periodicity in

238
00:09:31,030 --> 00:09:33,670
which this guy may come out check my c2

239
00:09:33,670 --> 00:09:35,500
server see if I got anything else for it

240
00:09:35,500 --> 00:09:38,620
and then execute the mother who common

241
00:09:38,620 --> 00:09:40,480
task goes without saying I want to

242
00:09:40,480 --> 00:09:42,340
survey it what is this data the machine

243
00:09:42,340 --> 00:09:44,680
I may have some other payloads that I

244
00:09:44,680 --> 00:09:47,410
want to lay down but I want to ensure

245
00:09:47,410 --> 00:09:50,610
that that system is has the requisite

246
00:09:50,610 --> 00:09:53,350
software installed or maybe this thing

247
00:09:53,350 --> 00:09:55,720
doesn't hold any true wealth for me to

248
00:09:55,720 --> 00:09:57,970
be able to do something follow-on within

249
00:09:57,970 --> 00:10:01,050
the organization this also allows me to

250
00:10:01,050 --> 00:10:02,980
validate whether it's running in a

251
00:10:02,980 --> 00:10:04,720
virtual machine or not right maybe this

252
00:10:04,720 --> 00:10:06,700
is some honeypot of stores or if I

253
00:10:06,700 --> 00:10:08,350
understand that organization and most of

254
00:10:08,350 --> 00:10:10,090
their stuff is virtualized then I could

255
00:10:10,090 --> 00:10:12,720
really deem that is normal if you will

256
00:10:12,720 --> 00:10:15,460
the other thing about issues in a stager

257
00:10:15,460 --> 00:10:18,460
is that additional payload we reach out

258
00:10:18,460 --> 00:10:20,590
to grab we could actually inject that

259
00:10:20,590 --> 00:10:22,900
into memory reflectively inject that DLL

260
00:10:22,900 --> 00:10:25,090
and at that point our DLL wouldn't touch

261
00:10:25,090 --> 00:10:27,190
disk the work being a little bit more

262
00:10:27,190 --> 00:10:30,270
stealthier in that aspect

263
00:10:30,829 --> 00:10:32,509
when we look at just a generalized

264
00:10:32,509 --> 00:10:34,970
methodology of sorts we can refer to the

265
00:10:34,970 --> 00:10:36,679
cyber kill chain cyber kill chain has

266
00:10:36,679 --> 00:10:38,839
been around since roughly 2011 developed

267
00:10:38,839 --> 00:10:40,369
by Lockheed Martin and there are a

268
00:10:40,369 --> 00:10:43,749
number of methodologies that all kind of

269
00:10:43,749 --> 00:10:46,730
articulate the same thing but ultimately

270
00:10:46,730 --> 00:10:49,399
just highlight really how somebody would

271
00:10:49,399 --> 00:10:51,439
look to do something so the interesting

272
00:10:51,439 --> 00:10:52,999
thing about this is this is gonna be

273
00:10:52,999 --> 00:10:55,970
linear in nature every step is almost

274
00:10:55,970 --> 00:10:58,790
required for the next so if I had my

275
00:10:58,790 --> 00:11:01,160
young child here you know my little five

276
00:11:01,160 --> 00:11:03,889
year old and I was chasing him it would

277
00:11:03,889 --> 00:11:06,079
be me trying to catch up to him instead

278
00:11:06,079 --> 00:11:08,809
I'm gonna try to pass him get in front

279
00:11:08,809 --> 00:11:10,670
of him so I can then block him or

280
00:11:10,670 --> 00:11:12,559
entertain them or whatever it is my goal

281
00:11:12,559 --> 00:11:15,019
is so the goal here are really idea here

282
00:11:15,019 --> 00:11:17,360
from a defense perspective if you can

283
00:11:17,360 --> 00:11:19,339
identify the methodology in which an

284
00:11:19,339 --> 00:11:21,980
attack or an adversary would take you

285
00:11:21,980 --> 00:11:24,529
can then get ahead of them so that way

286
00:11:24,529 --> 00:11:25,850
you're not sitting there trying to

287
00:11:25,850 --> 00:11:27,889
follow but you're more or less getting

288
00:11:27,889 --> 00:11:30,559
around and then blocking stopping

289
00:11:30,559 --> 00:11:34,100
identifying a mitigating aspects of

290
00:11:34,100 --> 00:11:36,049
which they would need to achieve the

291
00:11:36,049 --> 00:11:39,160
further go along

292
00:11:39,460 --> 00:11:41,740
we're really gonna focus on here though

293
00:11:41,740 --> 00:11:44,260
is not the exploitation perspective

294
00:11:44,260 --> 00:11:46,120
we're gonna focus more on the

295
00:11:46,120 --> 00:11:47,770
installment piece where we're actually

296
00:11:47,770 --> 00:11:50,410
going to lay something down and then

297
00:11:50,410 --> 00:11:52,090
we're going to utilize that to

298
00:11:52,090 --> 00:11:56,260
communicate back with Darcy to serve all

299
00:11:56,260 --> 00:11:59,830
right a common tactic to do this I wish

300
00:11:59,830 --> 00:12:01,600
I had disclaimer here because this is

301
00:12:01,600 --> 00:12:03,910
not the only way it is one of a few ways

302
00:12:03,910 --> 00:12:05,740
to actually get off through it it's

303
00:12:05,740 --> 00:12:07,180
almost like eating a rhesus right

304
00:12:07,180 --> 00:12:08,550
there's no long way to really do that

305
00:12:08,550 --> 00:12:10,840
unless you dip it in milk that just

306
00:12:10,840 --> 00:12:15,280
that's not right oh so a way to do this

307
00:12:15,280 --> 00:12:17,890
is we'll take whatever our data is we'll

308
00:12:17,890 --> 00:12:19,240
convert it to bytes

309
00:12:19,240 --> 00:12:21,250
well base64 and then we'll store it

310
00:12:21,250 --> 00:12:23,740
somewhere so the premise of this talk is

311
00:12:23,740 --> 00:12:26,230
utilized in Enterprise Services this is

312
00:12:26,230 --> 00:12:27,940
specifically Microsoft we're gonna

313
00:12:27,940 --> 00:12:30,040
utilize the very things that Microsoft

314
00:12:30,040 --> 00:12:31,810
calls features and we're gonna store

315
00:12:31,810 --> 00:12:34,360
some code there this code today is gonna

316
00:12:34,360 --> 00:12:36,280
be benign it's just gonna print a string

317
00:12:36,280 --> 00:12:38,290
back to the screen to let you know all

318
00:12:38,290 --> 00:12:40,180
those well but this approach is very

319
00:12:40,180 --> 00:12:42,850
post exploitation all right

320
00:12:42,850 --> 00:12:44,410
this isn't telling you how to get on the

321
00:12:44,410 --> 00:12:46,690
Box you're already on there now you're

322
00:12:46,690 --> 00:12:48,850
looking at the next stage and this kind

323
00:12:48,850 --> 00:12:51,280
of fits the category of paulus if you

324
00:12:51,280 --> 00:12:53,560
know the interesting thing about this is

325
00:12:53,560 --> 00:12:55,120
what we're going to lay down is our

326
00:12:55,120 --> 00:12:57,790
stager is going to be an IP address or

327
00:12:57,790 --> 00:13:00,010
it could be a URL and then we're gonna

328
00:13:00,010 --> 00:13:03,460
lay down a URI off after that actually

329
00:13:03,460 --> 00:13:04,990
specifying the file that we want

330
00:13:04,990 --> 00:13:06,940
it's a download so what do we lose if

331
00:13:06,940 --> 00:13:08,830
that gets burned well I lose an IP

332
00:13:08,830 --> 00:13:11,260
address if I'm using an IP if I'm using

333
00:13:11,260 --> 00:13:13,630
a domain I lost the domain I can go buy

334
00:13:13,630 --> 00:13:14,890
another one for a dollar ninety-nine

335
00:13:14,890 --> 00:13:17,890
cent and then whatever I specify is the

336
00:13:17,890 --> 00:13:20,140
file that I'm downloading I could lose

337
00:13:20,140 --> 00:13:21,940
that name right that doesn't really help

338
00:13:21,940 --> 00:13:25,270
a defender because today the file that

339
00:13:25,270 --> 00:13:26,920
I'm gonna host is call it stage or dot

340
00:13:26,920 --> 00:13:29,530
ps1 but if you ask somebody what's in

341
00:13:29,530 --> 00:13:31,510
that file nobody would know unless they

342
00:13:31,510 --> 00:13:33,100
went out there and downloaded the sample

343
00:13:33,100 --> 00:13:35,620
of it so what are you really losing

344
00:13:35,620 --> 00:13:38,590
right I'm lessening the surface in which

345
00:13:38,590 --> 00:13:41,590
I is an offensive person could become

346
00:13:41,590 --> 00:13:44,710
burnt or show my hand as to what I'm

347
00:13:44,710 --> 00:13:46,140
doing

348
00:13:46,140 --> 00:13:48,000
all right so we'll start with Active

349
00:13:48,000 --> 00:13:49,500
Directory Active Directory from an

350
00:13:49,500 --> 00:13:51,540
enterprise perspective that's gonna be

351
00:13:51,540 --> 00:13:52,769
the authentication authorization

352
00:13:52,769 --> 00:13:55,529
mechanism for user accounts throughout a

353
00:13:55,529 --> 00:13:58,829
network same thing with computers Active

354
00:13:58,829 --> 00:14:01,980
Directory is a structure in which is

355
00:14:01,980 --> 00:14:04,170
typically a raid of objects and the most

356
00:14:04,170 --> 00:14:06,839
common objects are the users computers

357
00:14:06,839 --> 00:14:09,510
and actual groups now the database

358
00:14:09,510 --> 00:14:12,899
itself is stored in system 32 and TDS

359
00:14:12,899 --> 00:14:15,630
that so if we were trying to take over

360
00:14:15,630 --> 00:14:18,390
an organization maybe dump some hashes

361
00:14:18,390 --> 00:14:20,190
it's not about us getting the same high

362
00:14:20,190 --> 00:14:21,630
because that's gonna be local and

363
00:14:21,630 --> 00:14:23,070
enterprise we would want that

364
00:14:23,070 --> 00:14:25,170
that's another top the big thing about

365
00:14:25,170 --> 00:14:27,120
this is when we look at Active Directory

366
00:14:27,120 --> 00:14:30,560
users and computers we see the top

367
00:14:30,560 --> 00:14:33,720
screenshot there cool we see things like

368
00:14:33,720 --> 00:14:36,660
Oh use organizational units and then we

369
00:14:36,660 --> 00:14:39,450
have sub oh use there as well and in

370
00:14:39,450 --> 00:14:41,220
each under each one of those

371
00:14:41,220 --> 00:14:44,100
organization units we may have other

372
00:14:44,100 --> 00:14:46,170
objects in this case we have some users

373
00:14:46,170 --> 00:14:48,620
we have some groups we also see some sub

374
00:14:48,620 --> 00:14:51,269
organizational units as well interesting

375
00:14:51,269 --> 00:14:53,250
thing about this is people aren't

376
00:14:53,250 --> 00:14:56,699
typically quick to create users they're

377
00:14:56,699 --> 00:14:58,890
not always typically quick to delete

378
00:14:58,890 --> 00:15:01,410
users or if I move from one section to

379
00:15:01,410 --> 00:15:03,959
the next they may give me or change my

380
00:15:03,959 --> 00:15:05,790
rights it may not go back and take those

381
00:15:05,790 --> 00:15:07,350
so we see things like privilege creep

382
00:15:07,350 --> 00:15:09,779
and a number of other things come up but

383
00:15:09,779 --> 00:15:12,329
from a GUI perspective that's how an

384
00:15:12,329 --> 00:15:15,750
admin may look to actually access Active

385
00:15:15,750 --> 00:15:17,760
Directory we can utilize something like

386
00:15:17,760 --> 00:15:19,680
PowerShell and access Active Directory

387
00:15:19,680 --> 00:15:22,440
as well and we see the same names there

388
00:15:22,440 --> 00:15:25,410
that we see as part of that oh you there

389
00:15:25,410 --> 00:15:27,570
if we were to click on an actual object

390
00:15:27,570 --> 00:15:29,790
we're presented with a number of

391
00:15:29,790 --> 00:15:32,339
properties about that object roughly

392
00:15:32,339 --> 00:15:34,680
there's about 50 of them if we go tab

393
00:15:34,680 --> 00:15:36,480
the tab we'll see these properties and

394
00:15:36,480 --> 00:15:38,160
generally speaking each one of those

395
00:15:38,160 --> 00:15:42,120
properties has the ability to store some

396
00:15:42,120 --> 00:15:45,120
amount of data whether it's one

397
00:15:45,120 --> 00:15:48,240
character 512 right it just really

398
00:15:48,240 --> 00:15:50,850
varies from field to field now there's

399
00:15:50,850 --> 00:15:52,589
also a number of fields that are not

400
00:15:52,589 --> 00:15:55,860
shown by default generally speaking in

401
00:15:55,860 --> 00:15:57,540
each one of those tabs if you're

402
00:15:57,540 --> 00:15:58,960
familiar with acting director

403
00:15:58,960 --> 00:16:01,000
you can go along the toolbar and

404
00:16:01,000 --> 00:16:03,880
actually enable advanced features and

405
00:16:03,880 --> 00:16:05,980
you'll get things like attribute editor

406
00:16:05,980 --> 00:16:08,500
now an attribute editor will be able to

407
00:16:08,500 --> 00:16:11,230
see the fields that are not typically

408
00:16:11,230 --> 00:16:13,180
shown by default and I'll highlight that

409
00:16:13,180 --> 00:16:16,270
is I do the demo so when we looked at

410
00:16:16,270 --> 00:16:18,760
this user we're looking at the same

411
00:16:18,760 --> 00:16:22,149
stuff within powershell so this is good

412
00:16:22,149 --> 00:16:24,490
because if we can get our code in there

413
00:16:24,490 --> 00:16:27,279
our stager domain users by default have

414
00:16:27,279 --> 00:16:30,040
the ability to read objects in Active

415
00:16:30,040 --> 00:16:32,770
Directory so that's cool now I can

416
00:16:32,770 --> 00:16:34,990
almost beast using this as a file share

417
00:16:34,990 --> 00:16:36,970
if you will and I can go from box to box

418
00:16:36,970 --> 00:16:39,760
and have that user read that actual

419
00:16:39,760 --> 00:16:43,130
account and grab that code

420
00:16:43,130 --> 00:16:45,480
so now we we kind of moved to the

421
00:16:45,480 --> 00:16:47,550
registry registry goes without saying it

422
00:16:47,550 --> 00:16:50,040
is amazing from a defense perspective

423
00:16:50,040 --> 00:16:53,550
it's awesome for forensics and artifacts

424
00:16:53,550 --> 00:16:56,090
from an offense perspective

425
00:16:56,090 --> 00:16:58,490
it is like a kid in a candy store

426
00:16:58,490 --> 00:17:00,260
they're just too much right so if you've

427
00:17:00,260 --> 00:17:01,820
ever been an admin I can tell you about

428
00:17:01,820 --> 00:17:04,910
every key in the registry I'd be

429
00:17:04,910 --> 00:17:06,560
interested right because there's just

430
00:17:06,560 --> 00:17:08,599
way too much in there for any one person

431
00:17:08,599 --> 00:17:10,819
to be able to know every particular key

432
00:17:10,819 --> 00:17:13,280
so if that's the case that makes a good

433
00:17:13,280 --> 00:17:15,530
place for us to get our code in and the

434
00:17:15,530 --> 00:17:17,689
fact that we can get our code in allows

435
00:17:17,689 --> 00:17:19,670
us to really skate under the radar a

436
00:17:19,670 --> 00:17:22,670
little bit more now when we look at the

437
00:17:22,670 --> 00:17:25,640
registry we have the hives that sit on

438
00:17:25,640 --> 00:17:28,790
disk and then we have the hives that are

439
00:17:28,790 --> 00:17:31,600
loaded into or what they assemble into

440
00:17:31,600 --> 00:17:35,060
in memory upon the system booting up or

441
00:17:35,060 --> 00:17:37,490
this or somebody actually logging in so

442
00:17:37,490 --> 00:17:40,010
and the users profile there's an into

443
00:17:40,010 --> 00:17:42,170
user that that is specific to the

444
00:17:42,170 --> 00:17:44,780
individual user when he or she logs on

445
00:17:44,780 --> 00:17:48,470
it becomes their HBCU and then we have a

446
00:17:48,470 --> 00:17:53,630
system 32 we have stuff like hklm I'm

447
00:17:53,630 --> 00:17:57,140
sorry a software system those along with

448
00:17:57,140 --> 00:17:59,060
a number of other ones become what we

449
00:17:59,060 --> 00:18:03,800
know is hklm now we also see the linkage

450
00:18:03,800 --> 00:18:06,380
between those items so we have our hives

451
00:18:06,380 --> 00:18:08,420
on this on the left and then we have

452
00:18:08,420 --> 00:18:10,700
what they become and memory on the right

453
00:18:10,700 --> 00:18:12,620
the good thing about this or not really

454
00:18:12,620 --> 00:18:14,930
the good thing is if we were trying to

455
00:18:14,930 --> 00:18:18,230
affect the security hi when the system

456
00:18:18,230 --> 00:18:20,270
boots up it gets loaded into memory and

457
00:18:20,270 --> 00:18:21,080
it's locked

458
00:18:21,080 --> 00:18:23,690
all right so that's really really good

459
00:18:23,690 --> 00:18:26,060
in the sense that we know it's gonna get

460
00:18:26,060 --> 00:18:29,300
used it's gonna be loaded in so we can

461
00:18:29,300 --> 00:18:31,220
get code in there it's a high

462
00:18:31,220 --> 00:18:33,620
availability method for us to actually

463
00:18:33,620 --> 00:18:35,900
use if we were just looking at the

464
00:18:35,900 --> 00:18:38,540
registry we're used to seeing reg

465
00:18:38,540 --> 00:18:42,020
editor right and for us to store code

466
00:18:42,020 --> 00:18:44,960
there I like to go several layers deep I

467
00:18:44,960 --> 00:18:47,390
like to look for just random places I

468
00:18:47,390 --> 00:18:48,530
don't even care what the key is really

469
00:18:48,530 --> 00:18:51,080
used for all right because the more

470
00:18:51,080 --> 00:18:53,750
deeper is less likely somebody's gonna

471
00:18:53,750 --> 00:18:56,360
be looking at it so in this case we're

472
00:18:56,360 --> 00:18:59,240
not very deep but we're in the users

473
00:18:59,240 --> 00:19:01,760
hive were within software and then

474
00:19:01,760 --> 00:19:02,690
sysinternals

475
00:19:02,690 --> 00:19:04,640
and then I see a key for the EULA so

476
00:19:04,640 --> 00:19:07,100
they've used strings before and they

477
00:19:07,100 --> 00:19:09,380
accepted that EULA and then

478
00:19:09,380 --> 00:19:11,780
I can look at the same data by utilizing

479
00:19:11,780 --> 00:19:13,310
PowerShell and I see the EULA

480
00:19:13,310 --> 00:19:15,200
highlighted there the short here is

481
00:19:15,200 --> 00:19:17,600
we're showing that you can utilize the

482
00:19:17,600 --> 00:19:19,880
GUI but you can also utilize the command

483
00:19:19,880 --> 00:19:21,470
line this is gonna be key once we get

484
00:19:21,470 --> 00:19:23,270
into the demo piece because largely

485
00:19:23,270 --> 00:19:24,890
everything I'm gonna do is then command

486
00:19:24,890 --> 00:19:27,140
line and then we'll go back to what it

487
00:19:27,140 --> 00:19:28,640
looks like in the GUI because that's

488
00:19:28,640 --> 00:19:32,800
what most admins are gonna be utilizing

489
00:19:32,850 --> 00:19:34,800
so have event logs so this is gonna be

490
00:19:34,800 --> 00:19:36,930
detailed records of things happening on

491
00:19:36,930 --> 00:19:38,850
the system generally speaking we have

492
00:19:38,850 --> 00:19:41,010
audit entries that if enabled were right

493
00:19:41,010 --> 00:19:43,410
to event logs if somebody was gonna wipe

494
00:19:43,410 --> 00:19:45,420
an event log it would generate an event

495
00:19:45,420 --> 00:19:49,110
11:02 so that gives some reassurance to

496
00:19:49,110 --> 00:19:50,940
an admin that if they can write stuff to

497
00:19:50,940 --> 00:19:52,650
the event log they have a good record

498
00:19:52,650 --> 00:19:54,810
the interesting thing about this is

499
00:19:54,810 --> 00:19:58,170
there's a huge amount of event logs like

500
00:19:58,170 --> 00:20:01,290
huge right we see where those event logs

501
00:20:01,290 --> 00:20:03,660
are stored at on this there are some

502
00:20:03,660 --> 00:20:06,150
tactics to wipe event logs in a good way

503
00:20:06,150 --> 00:20:07,680
actually I can't think of any good

504
00:20:07,680 --> 00:20:09,390
reason why anybody would want to do it

505
00:20:09,390 --> 00:20:10,980
but if we were doing it from an

506
00:20:10,980 --> 00:20:12,630
adversary perspective there's a couple

507
00:20:12,630 --> 00:20:14,100
of tactics that we can do it without

508
00:20:14,100 --> 00:20:17,040
admin being able to see it they do

509
00:20:17,040 --> 00:20:20,280
overwrite themselves so an admin likely

510
00:20:20,280 --> 00:20:21,750
would have something write to the event

511
00:20:21,750 --> 00:20:24,000
log and then ship it off to like Elks

512
00:20:24,000 --> 00:20:26,400
Blanc or whatever their centralized log

513
00:20:26,400 --> 00:20:28,470
aggregation server is but when we talk

514
00:20:28,470 --> 00:20:30,480
about there's a huge amount just looking

515
00:20:30,480 --> 00:20:34,080
after a server 2016 virtual machine I

516
00:20:34,080 --> 00:20:36,750
had deep bought nothing special i had a

517
00:20:36,750 --> 00:20:41,040
roughly 380 unique Long's not talking

518
00:20:41,040 --> 00:20:43,110
about log entries we're talking about

519
00:20:43,110 --> 00:20:44,520
unique logs

520
00:20:44,520 --> 00:20:47,480
now generally admins know about security

521
00:20:47,480 --> 00:20:50,070
system application may be some small

522
00:20:50,070 --> 00:20:52,530
other ones but I don't know how many

523
00:20:52,530 --> 00:20:54,870
people can name more than 15 20 logs

524
00:20:54,870 --> 00:20:57,120
that are actually in the system so the

525
00:20:57,120 --> 00:20:59,100
fact that we have several hundred gives

526
00:20:59,100 --> 00:21:02,700
me some pleasure and utilizing this now

527
00:21:02,700 --> 00:21:05,070
reading an event log we would use Event

528
00:21:05,070 --> 00:21:07,710
Viewer the GUI aspect and we would see

529
00:21:07,710 --> 00:21:10,440
an actual message and we see some other

530
00:21:10,440 --> 00:21:12,900
data about it we can utilize power show

531
00:21:12,900 --> 00:21:15,180
as you see below to essentially read

532
00:21:15,180 --> 00:21:17,640
that log as well now if that's not

533
00:21:17,640 --> 00:21:19,560
enough for you you have the ability to

534
00:21:19,560 --> 00:21:22,440
write custom logs so from a defense

535
00:21:22,440 --> 00:21:25,350
perspective maybe I have my dev shop who

536
00:21:25,350 --> 00:21:27,450
developed this in-house tool and they

537
00:21:27,450 --> 00:21:29,610
didn't build in any inherent logging so

538
00:21:29,610 --> 00:21:31,440
now I can utilize something like

539
00:21:31,440 --> 00:21:33,570
PowerShell write my own custom logging

540
00:21:33,570 --> 00:21:37,500
to get it in the event logs from an

541
00:21:37,500 --> 00:21:40,020
offense perspective I see a place in

542
00:21:40,020 --> 00:21:42,450
which we create our own event log that

543
00:21:42,450 --> 00:21:45,270
could we already got 385 what does it

544
00:21:45,270 --> 00:21:46,310
matter we have 300

545
00:21:46,310 --> 00:21:48,470
86 right we'll just add one more on to

546
00:21:48,470 --> 00:21:50,390
it and now we can write our code there

547
00:21:50,390 --> 00:21:52,040
and go back and retrieve it at another

548
00:21:52,040 --> 00:21:55,490
time reading it is such like this so

549
00:21:55,490 --> 00:21:58,100
I've made a new event log or actually I

550
00:21:58,100 --> 00:21:59,990
made a source within the application

551
00:21:59,990 --> 00:22:03,410
event log and then I wrote just an app

552
00:22:03,410 --> 00:22:05,480
has started and then when I go look at

553
00:22:05,480 --> 00:22:06,440
that an event viewer

554
00:22:06,440 --> 00:22:08,930
I see the actual message that I depicted

555
00:22:08,930 --> 00:22:11,420
and then I also am able to read that

556
00:22:11,420 --> 00:22:13,940
very same thing utilizing some power

557
00:22:13,940 --> 00:22:16,210
ship

558
00:22:16,410 --> 00:22:19,440
we have group policy so group policy is

559
00:22:19,440 --> 00:22:21,510
gonna be that that infrastructure that

560
00:22:21,510 --> 00:22:23,370
utilizes implement specific

561
00:22:23,370 --> 00:22:25,860
configurations across an enterprise all

562
00:22:25,860 --> 00:22:29,310
right I remember my time as a as a

563
00:22:29,310 --> 00:22:31,590
helpdesk person right they told me I had

564
00:22:31,590 --> 00:22:32,580
the most important job in the

565
00:22:32,580 --> 00:22:34,470
organization that was right before they

566
00:22:34,470 --> 00:22:35,610
gave me the most work in the

567
00:22:35,610 --> 00:22:37,890
organization right it was like hey we

568
00:22:37,890 --> 00:22:39,360
need to update these machines and we

569
00:22:39,360 --> 00:22:40,860
didn't have centralized management so I

570
00:22:40,860 --> 00:22:42,780
was walking around with my disk now I'm

571
00:22:42,780 --> 00:22:44,610
dating myself I had city booked but all

572
00:22:44,610 --> 00:22:46,830
kinds of software and I realized that

573
00:22:46,830 --> 00:22:48,870
was no way to treat a human being right

574
00:22:48,870 --> 00:22:50,970
and you know we have things like goo

575
00:22:50,970 --> 00:22:52,710
policy where we can set it once and

576
00:22:52,710 --> 00:22:54,180
didn't have those settings proliferate

577
00:22:54,180 --> 00:22:55,830
across an organization so it's a

578
00:22:55,830 --> 00:22:58,620
wonderful thing and then again we find

579
00:22:58,620 --> 00:23:00,390
areas that we can take advantage of it

580
00:23:00,390 --> 00:23:03,540
from within Microsoft group policy

581
00:23:03,540 --> 00:23:05,220
itself there's an enterprise management

582
00:23:05,220 --> 00:23:06,690
perspective through policy management

583
00:23:06,690 --> 00:23:08,700
and then we have the local machine has a

584
00:23:08,700 --> 00:23:12,000
local group policy editor as well so

585
00:23:12,000 --> 00:23:13,590
we're gonna look at doing it from a

586
00:23:13,590 --> 00:23:15,870
enterprise perspective that's gonna give

587
00:23:15,870 --> 00:23:17,580
us the most bang for the buck but either

588
00:23:17,580 --> 00:23:20,070
one of them will suffice and the way

589
00:23:20,070 --> 00:23:22,140
we're gonna do that is we'll look at the

590
00:23:22,140 --> 00:23:23,460
group policy management from a server

591
00:23:23,460 --> 00:23:26,340
perspective I have a default domain

592
00:23:26,340 --> 00:23:28,770
policy which every domain would have

593
00:23:28,770 --> 00:23:31,620
that I don't care if it's enforced

594
00:23:31,620 --> 00:23:34,560
length or not but we have this think all

595
00:23:34,560 --> 00:23:37,530
comments and over there I've never seen

596
00:23:37,530 --> 00:23:40,470
an admin actually used it ever so for

597
00:23:40,470 --> 00:23:43,380
this uh for the sake of this screenshot

598
00:23:43,380 --> 00:23:45,450
here I just put in that this is the

599
00:23:45,450 --> 00:23:47,640
default policy link to the domain or

600
00:23:47,640 --> 00:23:49,650
whatever the right I'm gonna put text

601
00:23:49,650 --> 00:23:51,870
there now but we're gonna utilize that

602
00:23:51,870 --> 00:23:55,040
area to store our code awesome now

603
00:23:55,040 --> 00:23:57,660
before I lay any code down I'm gonna

604
00:23:57,660 --> 00:23:59,850
understand the infrastructure to really

605
00:23:59,850 --> 00:24:02,820
highlight would this tactic work like

606
00:24:02,820 --> 00:24:04,710
I'm not gonna go to every machine and

607
00:24:04,710 --> 00:24:07,050
try to use MSO eight zero six seven

608
00:24:07,050 --> 00:24:08,310
right because that's not gonna work

609
00:24:08,310 --> 00:24:09,990
everywhere but I would want to

610
00:24:09,990 --> 00:24:11,610
understand targeting which I'm

611
00:24:11,610 --> 00:24:14,490
interacting with now our next one is

612
00:24:14,490 --> 00:24:16,980
alternate data stream and some of you

613
00:24:16,980 --> 00:24:19,710
may be like man really yeah hey it still

614
00:24:19,710 --> 00:24:22,230
works all right just like that at six

615
00:24:22,230 --> 00:24:23,370
seven one I just talked about

616
00:24:23,370 --> 00:24:25,560
so alternate data streams resident

617
00:24:25,560 --> 00:24:27,240
within NTFS filesystem

618
00:24:27,240 --> 00:24:28,740
I'm generally speaking that's what our

619
00:24:28,740 --> 00:24:29,720
systems are going to be

620
00:24:29,720 --> 00:24:32,330
or Windows perspective um we have the

621
00:24:32,330 --> 00:24:35,420
ability to really add in the stream of

622
00:24:35,420 --> 00:24:37,730
data if you will and if we looked at the

623
00:24:37,730 --> 00:24:41,330
size of the file our data stream size

624
00:24:41,330 --> 00:24:45,020
does not affect our actual size of our

625
00:24:45,020 --> 00:24:47,360
files so that's good now this was really

626
00:24:47,360 --> 00:24:51,800
developed to have any capability match

627
00:24:51,800 --> 00:24:54,020
with Macintosh systems but it's still

628
00:24:54,020 --> 00:24:56,450
something that's available so every file

629
00:24:56,450 --> 00:25:00,080
has a dollar sign data stream and then

630
00:25:00,080 --> 00:25:02,360
we have specific files depending on how

631
00:25:02,360 --> 00:25:04,640
your system is a raid but we could also

632
00:25:04,640 --> 00:25:07,250
have zone identifiers have you ever been

633
00:25:07,250 --> 00:25:09,890
downloading the file try to run it and a

634
00:25:09,890 --> 00:25:11,690
pop-up said hey be careful this came

635
00:25:11,690 --> 00:25:12,920
from the internet you shouldn't trust

636
00:25:12,920 --> 00:25:14,900
stuff blah blah blah well that was a

637
00:25:14,900 --> 00:25:18,230
zone identify 80s that was attached to

638
00:25:18,230 --> 00:25:21,770
your file Sam that zone 3 or 4 whichever

639
00:25:21,770 --> 00:25:23,600
one it is that tags it saying it came

640
00:25:23,600 --> 00:25:25,010
from the Internet that's what

641
00:25:25,010 --> 00:25:27,380
highlighting or really stopping you and

642
00:25:27,380 --> 00:25:29,390
prompting you it's that zone identifier

643
00:25:29,390 --> 00:25:32,670
80s that's being tad

644
00:25:32,670 --> 00:25:34,799
so an example of this is really good so

645
00:25:34,799 --> 00:25:37,500
I have a file that I created and right

646
00:25:37,500 --> 00:25:40,170
now it has zero bytes I created an

647
00:25:40,170 --> 00:25:41,370
alternate data stream that I'm gonna

648
00:25:41,370 --> 00:25:44,010
call my stream and I'm gonna put my

649
00:25:44,010 --> 00:25:46,410
son's favorite write dr. Seuss in there

650
00:25:46,410 --> 00:25:48,870
and right now the length of that is

651
00:25:48,870 --> 00:25:52,350
$35.99 but still the original file the

652
00:25:52,350 --> 00:25:54,480
donor if you will is still that zero

653
00:25:54,480 --> 00:25:57,270
bytes so if I'm gonna use this I would

654
00:25:57,270 --> 00:25:59,460
look to want to do it on a bow that I

655
00:25:59,460 --> 00:26:01,830
know that's gonna be there right

656
00:26:01,830 --> 00:26:04,620
and one for example not the only one is

657
00:26:04,620 --> 00:26:07,559
the host file right the host file if I'm

658
00:26:07,559 --> 00:26:09,830
going to try to sinkhole a domain or

659
00:26:09,830 --> 00:26:12,960
maybe redirect something locally then I

660
00:26:12,960 --> 00:26:15,150
could utilize this host file and put in

661
00:26:15,150 --> 00:26:19,020
an IP in an actual domain but regardless

662
00:26:19,020 --> 00:26:21,780
of what's in the actual file itself I'm

663
00:26:21,780 --> 00:26:23,549
just gonna be a straphanger with my

664
00:26:23,549 --> 00:26:25,470
alternate data stream and really this

665
00:26:25,470 --> 00:26:28,820
thing it's gonna be a donor form

666
00:26:29,370 --> 00:26:30,809
we have environment variables they're

667
00:26:30,809 --> 00:26:32,820
gonna be dynamic in nature so we were

668
00:26:32,820 --> 00:26:35,970
using the environment variable username

669
00:26:35,970 --> 00:26:39,150
I'm sorry user profile it would really

670
00:26:39,150 --> 00:26:42,090
highlight the profile path for the user

671
00:26:42,090 --> 00:26:44,220
that you're logged in it for example if

672
00:26:44,220 --> 00:26:46,470
I'm logged in as a user called wolf and

673
00:26:46,470 --> 00:26:48,650
I said hey change directory to

674
00:26:48,650 --> 00:26:52,230
environment variable user profile it was

675
00:26:52,230 --> 00:26:54,480
dynamically set to that environment

676
00:26:54,480 --> 00:26:56,309
variable that might use a profile that's

677
00:26:56,309 --> 00:27:00,780
the path of see users wolf blah blah

678
00:27:00,780 --> 00:27:03,090
blah alright so it can be dynamically

679
00:27:03,090 --> 00:27:05,880
set and this is good now we also have

680
00:27:05,880 --> 00:27:08,550
the ability to have user environment

681
00:27:08,550 --> 00:27:10,890
variables and system ones we're going to

682
00:27:10,890 --> 00:27:12,420
look to get in the system one so that

683
00:27:12,420 --> 00:27:14,190
way it doesn't matter per se which

684
00:27:14,190 --> 00:27:16,890
person there's a lot of information

685
00:27:16,890 --> 00:27:19,260
that's being utilized here to really set

686
00:27:19,260 --> 00:27:21,059
what's going on in our operating system

687
00:27:21,059 --> 00:27:22,260
and the same could be said about

688
00:27:22,260 --> 00:27:24,300
whatever programs we have installed

689
00:27:24,300 --> 00:27:26,220
there the same way we have our

690
00:27:26,220 --> 00:27:28,380
environment path we can add other things

691
00:27:28,380 --> 00:27:29,920
in

692
00:27:29,920 --> 00:27:32,590
so in this case we have our user

693
00:27:32,590 --> 00:27:35,049
environment variables up top I have the

694
00:27:35,049 --> 00:27:36,880
system ones that are down in the bottom

695
00:27:36,880 --> 00:27:39,850
these user ones are in my NT user diet

696
00:27:39,850 --> 00:27:41,920
that for whatever user it is that I'm

697
00:27:41,920 --> 00:27:43,929
logged in as and then these system ones

698
00:27:43,929 --> 00:27:46,270
are part of hklm

699
00:27:46,270 --> 00:27:48,309
from a GUI perspective a more from

700
00:27:48,309 --> 00:27:51,220
ingoing perspective I have where I can

701
00:27:51,220 --> 00:27:54,010
go into properties of computer and then

702
00:27:54,010 --> 00:27:57,100
I can see up top my user environment

703
00:27:57,100 --> 00:27:59,260
variables and down below my system ones

704
00:27:59,260 --> 00:28:01,840
so we're gonna add one into our system

705
00:28:01,840 --> 00:28:03,460
one we'll come back and check this

706
00:28:03,460 --> 00:28:05,860
screen and we'll look at what an admin

707
00:28:05,860 --> 00:28:07,809
would actually see and how he or she

708
00:28:07,809 --> 00:28:10,030
could actually highlight that we have

709
00:28:10,030 --> 00:28:15,669
something going on and we have a WMI and

710
00:28:15,669 --> 00:28:19,450
sim alright so from this perspective WMI

711
00:28:19,450 --> 00:28:23,110
was Microsoft's implementation of W bean

712
00:28:23,110 --> 00:28:25,570
so w bins like how we're going to share

713
00:28:25,570 --> 00:28:27,750
information across a subset of machines

714
00:28:27,750 --> 00:28:29,950
within the last couple of years

715
00:28:29,950 --> 00:28:31,690
Microsoft has gone away from that and

716
00:28:31,690 --> 00:28:34,299
went to sim which is common information

717
00:28:34,299 --> 00:28:38,140
module or model both of them somewhat do

718
00:28:38,140 --> 00:28:41,400
the same thing WMI is gonna use decomp

719
00:28:41,400 --> 00:28:45,250
sim is gonna use a thing called WS man

720
00:28:45,250 --> 00:28:47,950
but ultimately the namespaces and

721
00:28:47,950 --> 00:28:50,110
classes that were accustomed to from W

722
00:28:50,110 --> 00:28:52,210
and Mark are still available so we're

723
00:28:52,210 --> 00:28:54,460
gonna take advantage of that in the

724
00:28:54,460 --> 00:28:58,020
sense of we have these classes

725
00:28:58,020 --> 00:29:02,429
namespaces that have a particular set of

726
00:29:02,429 --> 00:29:05,710
information about them so these classes

727
00:29:05,710 --> 00:29:07,960
has properties and methods and

728
00:29:07,960 --> 00:29:09,160
properties are nothing more than

729
00:29:09,160 --> 00:29:11,080
attributes methods are nothing more than

730
00:29:11,080 --> 00:29:13,090
actions and then if we want to interact

731
00:29:13,090 --> 00:29:15,220
with them from a GUI perspective on our

732
00:29:15,220 --> 00:29:18,370
system W beam has an actual executable

733
00:29:18,370 --> 00:29:21,250
assistant 32 that we can connect to our

734
00:29:21,250 --> 00:29:23,890
machine and access all our namespaces

735
00:29:23,890 --> 00:29:25,840
and classes and we'll highlight that too

736
00:29:25,840 --> 00:29:27,970
in our demo as far as how an admin can

737
00:29:27,970 --> 00:29:29,830
see that but when we talk about the

738
00:29:29,830 --> 00:29:32,080
sheer amount of them is gonna vary from

739
00:29:32,080 --> 00:29:34,900
system to system just like when I add a

740
00:29:34,900 --> 00:29:36,580
particular piece of software on my

741
00:29:36,580 --> 00:29:40,059
system it may add a new registry key the

742
00:29:40,059 --> 00:29:41,150
same is

743
00:29:41,150 --> 00:29:45,200
or WMI and sim as far as classes so on

744
00:29:45,200 --> 00:29:48,080
the machine that I ran a demo on I had

745
00:29:48,080 --> 00:29:50,960
roughly 10,000 right refer back to my

746
00:29:50,960 --> 00:29:53,750
comment about the registry if I can find

747
00:29:53,750 --> 00:29:55,220
an admin that can tell me about more

748
00:29:55,220 --> 00:29:58,760
than 10 classes I would be I wouldn't be

749
00:29:58,760 --> 00:30:00,140
shocked I would want to actually talk a

750
00:30:00,140 --> 00:30:02,720
little bit more right but 10,000 that's

751
00:30:02,720 --> 00:30:05,330
a lot just on my system so if I have

752
00:30:05,330 --> 00:30:08,510
10,000 112 what difference is it gonna

753
00:30:08,510 --> 00:30:10,550
make if I add one more to it alright and

754
00:30:10,550 --> 00:30:13,280
that's what we'll do this is gonna help

755
00:30:13,280 --> 00:30:16,010
us with storing our code having it in

756
00:30:16,010 --> 00:30:18,650
the place in which an admin largely it's

757
00:30:18,650 --> 00:30:21,020
not going to see it so that makes it

758
00:30:21,020 --> 00:30:22,280
great for us when we want to come back

759
00:30:22,280 --> 00:30:25,360
and actually grab

760
00:30:30,460 --> 00:30:34,960
okay so now we're going to demo

761
00:30:34,960 --> 00:30:37,080
and

762
00:30:38,809 --> 00:30:41,790
and think this port through is I didn't

763
00:30:41,790 --> 00:30:44,899
mirror it so

764
00:30:48,480 --> 00:30:50,419
you

765
00:30:50,419 --> 00:30:52,420
you

766
00:30:52,420 --> 00:30:54,710
okay

767
00:30:54,710 --> 00:30:56,770
you

768
00:30:59,270 --> 00:31:02,880
all right cool so I have another machine

769
00:31:02,880 --> 00:31:09,870
that is running a web server and this

770
00:31:09,870 --> 00:31:12,000
web server is really dirty it's really

771
00:31:12,000 --> 00:31:14,400
dirty in that so you heard of a Python

772
00:31:14,400 --> 00:31:16,620
on simple HTTP server all right so we

773
00:31:16,620 --> 00:31:18,060
did the same thing in PowerShell we're

774
00:31:18,060 --> 00:31:20,160
talking 19 lines probably get it down

775
00:31:20,160 --> 00:31:22,200
more than that all right so it's really

776
00:31:22,200 --> 00:31:24,570
quick and dirty it's HTTP I can add a

777
00:31:24,570 --> 00:31:26,670
certificate on to it if I needed to but

778
00:31:26,670 --> 00:31:29,040
nonetheless I can utilize something like

779
00:31:29,040 --> 00:31:32,370
invoke web request and I can access that

780
00:31:32,370 --> 00:31:34,500
server so I'm just ensuring that I have

781
00:31:34,500 --> 00:31:36,870
access to it I see I have a status code

782
00:31:36,870 --> 00:31:40,860
of 200 cool so I'm gonna take what is

783
00:31:40,860 --> 00:31:43,920
really my stager and it's that bit of

784
00:31:43,920 --> 00:31:47,040
code that bit of code where I'm going to

785
00:31:47,040 --> 00:31:49,590
reach out download whatever is being

786
00:31:49,590 --> 00:31:51,780
held there and I'm gonna store it in the

787
00:31:51,780 --> 00:31:54,900
context of memory so that whole string

788
00:31:54,900 --> 00:31:57,180
itself is going to be my stager if this

789
00:31:57,180 --> 00:31:59,850
gets caught I lose an IP address I lose

790
00:31:59,850 --> 00:32:01,500
that I was reaching for something called

791
00:32:01,500 --> 00:32:04,290
stage or ps1 but honestly I couldn't

792
00:32:04,290 --> 00:32:08,760
call it it 1 2 3 or ABC Mickey Mouse or

793
00:32:08,760 --> 00:32:12,240
whatever right or not United States or

794
00:32:12,240 --> 00:32:15,630
whatever right cool so I'm gonna go

795
00:32:15,630 --> 00:32:17,700
through and I'm gonna take that string

796
00:32:17,700 --> 00:32:20,250
I'm gonna convert it to bytes and then

797
00:32:20,250 --> 00:32:23,400
I'm going to convert it to base64 and

798
00:32:23,400 --> 00:32:25,710
then I had that base64 code so now

799
00:32:25,710 --> 00:32:27,720
there's my off you stated string in

800
00:32:27,720 --> 00:32:29,700
which I'm gonna lay down in a number of

801
00:32:29,700 --> 00:32:33,120
places as you see I have it is encoded

802
00:32:33,120 --> 00:32:35,040
text so as I go through these examples

803
00:32:35,040 --> 00:32:37,920
I'll be storing encoded text the

804
00:32:37,920 --> 00:32:40,200
variable and all these random different

805
00:32:40,200 --> 00:32:42,840
places and it will call upon it so I'm

806
00:32:42,840 --> 00:32:45,450
gonna utilize this person Nick shank and

807
00:32:45,450 --> 00:32:47,580
I'm gonna look at a couple of properties

808
00:32:47,580 --> 00:32:49,680
associated with their account right now

809
00:32:49,680 --> 00:32:51,570
we see employee ID employee number

810
00:32:51,570 --> 00:32:53,160
division those are the three I called

811
00:32:53,160 --> 00:32:55,670
upon and they have nothing their

812
00:32:55,670 --> 00:32:59,490
division can hold 256 characters I want

813
00:32:59,490 --> 00:33:01,440
to say employee numbers like 512

814
00:33:01,440 --> 00:33:04,890
employee IDs like 16 and there are many

815
00:33:04,890 --> 00:33:06,660
more that you can find but those three

816
00:33:06,660 --> 00:33:09,210
aren't available by default so what I'm

817
00:33:09,210 --> 00:33:10,350
going to do is

818
00:33:10,350 --> 00:33:16,879
go into Active Directory and I'll go

819
00:33:17,590 --> 00:33:20,660
into Schenk's computer I'm sorry shanks

820
00:33:20,660 --> 00:33:22,700
account and I'll come into attribute

821
00:33:22,700 --> 00:33:26,870
editor when I come into attribute editor

822
00:33:26,870 --> 00:33:28,929
you

823
00:33:29,040 --> 00:33:31,100
you

824
00:33:33,440 --> 00:33:36,170
I noticed that division has nothing

825
00:33:36,170 --> 00:33:38,630
there so that is the one place that an

826
00:33:38,630 --> 00:33:40,610
admin would see it in attribute editor

827
00:33:40,610 --> 00:33:42,950
now I would have had to essentially do

828
00:33:42,950 --> 00:33:45,410
an advanced view and I don't know admins

829
00:33:45,410 --> 00:33:47,060
that just scroll down attribute editor

830
00:33:47,060 --> 00:33:48,740
like oh let me see what's going on in

831
00:33:48,740 --> 00:33:49,160
here

832
00:33:49,160 --> 00:33:51,410
so if that is the case where an admin is

833
00:33:51,410 --> 00:33:53,810
gonna do that then I'm gonna get a

834
00:33:53,810 --> 00:33:55,670
little bit more stealthier but first I'm

835
00:33:55,670 --> 00:33:58,910
gonna store this base64 code there we'll

836
00:33:58,910 --> 00:34:01,400
look at what it looks like cool so it's

837
00:34:01,400 --> 00:34:03,320
there from a command line perspective

838
00:34:03,320 --> 00:34:07,810
from a GUI perspective

839
00:34:10,980 --> 00:34:15,329
we now see our base64 code and depending

840
00:34:15,329 --> 00:34:17,309
on the target I might be like cool it's

841
00:34:17,309 --> 00:34:19,559
there let's go or we may want to get a

842
00:34:19,559 --> 00:34:20,819
little bit more stealth there with that

843
00:34:20,819 --> 00:34:22,619
so we're going to push that down a

844
00:34:22,619 --> 00:34:24,389
little bit and what I mean by push that

845
00:34:24,389 --> 00:34:27,089
down is I'm gonna Pat it with spaces

846
00:34:27,089 --> 00:34:29,129
right I'm gonna push it off the screen

847
00:34:29,129 --> 00:34:31,349
so that way it forces an admin to

848
00:34:31,349 --> 00:34:32,699
actually interact with it

849
00:34:32,699 --> 00:34:34,889
to know what's there now I said division

850
00:34:34,889 --> 00:34:40,918
takes 256 characters right employee

851
00:34:40,918 --> 00:34:43,168
number takes 512 so if I'm already gonna

852
00:34:43,168 --> 00:34:46,469
Pat it with 250 blank spaces then I'm

853
00:34:46,469 --> 00:34:50,500
gonna now put it in employee number

854
00:34:50,500 --> 00:34:52,210
now when I go back in here and I look at

855
00:34:52,210 --> 00:34:57,160
employee number we'll see what that

856
00:34:57,160 --> 00:34:59,640
looks like

857
00:35:01,160 --> 00:35:04,640
so employee number shows blank but

858
00:35:04,640 --> 00:35:06,019
notice everything else around it that's

859
00:35:06,019 --> 00:35:09,140
not set right it actually says not sit

860
00:35:09,140 --> 00:35:11,420
if an admin gets to this point it was

861
00:35:11,420 --> 00:35:13,640
like huh why does that one not said and

862
00:35:13,640 --> 00:35:14,779
why does it doesn't have anything else

863
00:35:14,779 --> 00:35:16,309
next to it and they want to double click

864
00:35:16,309 --> 00:35:16,670
it

865
00:35:16,670 --> 00:35:19,640
oh you got right so let's go a step

866
00:35:19,640 --> 00:35:22,369
further with this we're gonna actually

867
00:35:22,369 --> 00:35:25,279
add in not set so we're gonna add in not

868
00:35:25,279 --> 00:35:30,470
set we're then gonna push it down 250

869
00:35:30,470 --> 00:35:32,509
white spaces and then we'll add in our

870
00:35:32,509 --> 00:35:36,230
text so I'm gonna now overwrite employee

871
00:35:36,230 --> 00:35:38,180
number with that so we'll go back in

872
00:35:38,180 --> 00:35:46,609
here and we'll look at that so now when

873
00:35:46,609 --> 00:35:48,500
I look at employee number nothing to see

874
00:35:48,500 --> 00:35:50,599
here right now look if an atom is gonna

875
00:35:50,599 --> 00:35:52,579
go double click every one of these

876
00:35:52,579 --> 00:35:55,789
look bro you gotta write like you have

877
00:35:55,789 --> 00:35:59,420
no real job right but now when I go in

878
00:35:59,420 --> 00:36:01,519
here to actually interact with it I see

879
00:36:01,519 --> 00:36:04,339
my code I see my whitespace and I see

880
00:36:04,339 --> 00:36:07,160
not set I've pushed it off the screen

881
00:36:07,160 --> 00:36:09,349
making it more difficult for me to find

882
00:36:09,349 --> 00:36:11,000
now when it's time for me to actually

883
00:36:11,000 --> 00:36:13,640
execute this what I'm gonna do is call

884
00:36:13,640 --> 00:36:16,579
upon that property I'm gonna trim not

885
00:36:16,579 --> 00:36:18,650
set and I'm gonna get rid of the white

886
00:36:18,650 --> 00:36:20,599
space there and I'm gonna actually feed

887
00:36:20,599 --> 00:36:23,569
that base64 the PowerShell and what I

888
00:36:23,569 --> 00:36:25,730
have this stage or that ps1 is nothing

889
00:36:25,730 --> 00:36:27,319
more than that green text saying stage

890
00:36:27,319 --> 00:36:30,680
and test right call it a proof dot text

891
00:36:30,680 --> 00:36:32,630
on the desktop if you will the old STP

892
00:36:32,630 --> 00:36:35,029
Amazon all right whoo so that's a way

893
00:36:35,029 --> 00:36:38,450
for me to do it now if I was if I get a

894
00:36:38,450 --> 00:36:40,430
new guy on my team right everybody's got

895
00:36:40,430 --> 00:36:41,990
a cut they teach somehow so by hey man

896
00:36:41,990 --> 00:36:43,339
welcome to the team hey check this out

897
00:36:43,339 --> 00:36:45,079
we're working on Active Directory I need

898
00:36:45,079 --> 00:36:46,460
you to go through every property known

899
00:36:46,460 --> 00:36:48,259
to man kind of research and find us a

900
00:36:48,259 --> 00:36:50,029
property that we can throw data into

901
00:36:50,029 --> 00:36:52,069
right good luck right we all have to

902
00:36:52,069 --> 00:36:54,440
like start somewhere so that's a way for

903
00:36:54,440 --> 00:36:56,509
us to do it now from a registry

904
00:36:56,509 --> 00:36:59,150
perspective I'm gonna utilize this key

905
00:36:59,150 --> 00:37:06,079
called console and console itself it's

906
00:37:06,079 --> 00:37:08,119
like super random I just scroll down in

907
00:37:08,119 --> 00:37:12,309
and found it somewhere

908
00:37:16,340 --> 00:37:18,570
that's how random is now I can't find

909
00:37:18,570 --> 00:37:19,320
all right cool

910
00:37:19,320 --> 00:37:22,020
so there it is so we see nothing's under

911
00:37:22,020 --> 00:37:23,970
console other than something that says

912
00:37:23,970 --> 00:37:26,910
default that's awesome so I'm going to

913
00:37:26,910 --> 00:37:30,119
create a new item there and I'm gonna

914
00:37:30,119 --> 00:37:33,420
call that value updater 32 and then I'm

915
00:37:33,420 --> 00:37:34,740
gonna store my code there

916
00:37:34,740 --> 00:37:36,780
well why are you calling the updater 32

917
00:37:36,780 --> 00:37:39,330
because let's be real here if you add 32

918
00:37:39,330 --> 00:37:42,690
and 64 people will make themselves feel

919
00:37:42,690 --> 00:37:45,240
like it's legit yeah looks legit it's

920
00:37:45,240 --> 00:37:48,900
got 32 on it all right so we come back

921
00:37:48,900 --> 00:37:52,440
in here we look at this and you're like

922
00:37:52,440 --> 00:37:55,680
that's ugly now we'll go back before cuz

923
00:37:55,680 --> 00:37:57,240
I'm like bro this thing is like six

924
00:37:57,240 --> 00:37:58,830
layers deep ain't no way I'm ain't gonna

925
00:37:58,830 --> 00:38:01,710
find that yes they will okay fine we'll

926
00:38:01,710 --> 00:38:03,210
do something similar like what we did

927
00:38:03,210 --> 00:38:05,280
before we're gonna push that thing down

928
00:38:05,280 --> 00:38:08,040
in this case I'm gonna do updater 64 I'm

929
00:38:08,040 --> 00:38:10,740
gonna Pat it with 250 white spaces and

930
00:38:10,740 --> 00:38:13,830
we're right there as well so when we

931
00:38:13,830 --> 00:38:17,880
come look at this we now have that so if

932
00:38:17,880 --> 00:38:19,140
an admin is at a point where they're

933
00:38:19,140 --> 00:38:20,580
looking at registry keys and they see

934
00:38:20,580 --> 00:38:23,400
the key with no value and they want to

935
00:38:23,400 --> 00:38:24,780
click on it really I guess they're

936
00:38:24,780 --> 00:38:26,460
indication there these three dots here

937
00:38:26,460 --> 00:38:27,900
but if they get to a point where they

938
00:38:27,900 --> 00:38:29,070
see this and they want to click on it

939
00:38:29,070 --> 00:38:32,609
then cool I guess they'll stop there but

940
00:38:32,609 --> 00:38:34,530
if they're really nosy they could scroll

941
00:38:34,530 --> 00:38:36,510
over and see my code now if I want to

942
00:38:36,510 --> 00:38:38,250
make this blend in a little bit more you

943
00:38:38,250 --> 00:38:40,170
see how we have this key default and it

944
00:38:40,170 --> 00:38:42,570
says value not set that seems really

945
00:38:42,570 --> 00:38:45,060
legit so I'm gonna do that alright so in

946
00:38:45,060 --> 00:38:47,339
this case I'm gonna do app cache 32 I'm

947
00:38:47,339 --> 00:38:50,430
gonna add in value not set add in my 250

948
00:38:50,430 --> 00:38:52,890
white spaces and I'll add in my code so

949
00:38:52,890 --> 00:38:56,330
now when we have this

950
00:38:56,520 --> 00:38:59,350
we have value not set we have some three

951
00:38:59,350 --> 00:39:01,120
dots out to the side so that triggers

952
00:39:01,120 --> 00:39:03,370
them so be it but when they click on it

953
00:39:03,370 --> 00:39:05,680
we have value not set all the white

954
00:39:05,680 --> 00:39:08,950
space and then we have our code so if I

955
00:39:08,950 --> 00:39:11,590
get this in such a place where a rest is

956
00:39:11,590 --> 00:39:13,110
short no admin is looking forward

957
00:39:13,110 --> 00:39:16,090
depending on the defenses I feel like I

958
00:39:16,090 --> 00:39:17,950
can get around it when it's time for me

959
00:39:17,950 --> 00:39:19,780
to call upon it I'll trim that white

960
00:39:19,780 --> 00:39:21,010
space and everything else associated

961
00:39:21,010 --> 00:39:23,730
with it and I'll be able to execute it

962
00:39:23,730 --> 00:39:27,640
now from a event log perspective I'm

963
00:39:27,640 --> 00:39:29,650
gonna create an event log a brand new

964
00:39:29,650 --> 00:39:31,390
one it's not gonna be system security

965
00:39:31,390 --> 00:39:32,230
anything like that

966
00:39:32,230 --> 00:39:33,670
I'm gonna create one called Windows

967
00:39:33,670 --> 00:39:36,790
Update so that is really legit and I'm

968
00:39:36,790 --> 00:39:39,490
gonna utilize a source call updater 64

969
00:39:39,490 --> 00:39:42,370
so now that I created this event log I'm

970
00:39:42,370 --> 00:39:45,520
gonna write data to it and the data I'm

971
00:39:45,520 --> 00:39:47,320
gonna write to it is gonna be an event

972
00:39:47,320 --> 00:39:49,660
ID of 10 and you guessed it it's gonna

973
00:39:49,660 --> 00:39:52,750
be my base64 code so when I come in here

974
00:39:52,750 --> 00:39:56,530
and I look at this we'll be able to

975
00:39:56,530 --> 00:39:59,820
actually see it

976
00:40:00,240 --> 00:40:01,770
you

977
00:40:01,770 --> 00:40:04,109
okay

978
00:40:04,109 --> 00:40:06,430
you ever had a talk with the demo gods

979
00:40:06,430 --> 00:40:07,930
and it was like yo bro I got you you're

980
00:40:07,930 --> 00:40:10,109
gonna be good

981
00:40:10,109 --> 00:40:13,329
all right there's my updater 64 or my

982
00:40:13,329 --> 00:40:15,280
windows updater when I look at that I

983
00:40:15,280 --> 00:40:16,930
got basic before sitting right there

984
00:40:16,930 --> 00:40:18,670
right so I'm like cool

985
00:40:18,670 --> 00:40:21,520
there's 386 logs now what if they see

986
00:40:21,520 --> 00:40:23,980
this and I'm also doing this in my own

987
00:40:23,980 --> 00:40:25,569
log because if I did it in the

988
00:40:25,569 --> 00:40:27,190
application and everything else we've

989
00:40:27,190 --> 00:40:28,900
already said it's gonna roll it's gonna

990
00:40:28,900 --> 00:40:30,550
overwrite so I don't want to lay down

991
00:40:30,550 --> 00:40:32,589
something today try to come back and

992
00:40:32,589 --> 00:40:35,020
utilize it tomorrow and then like the

993
00:40:35,020 --> 00:40:37,900
network had so much activity that my log

994
00:40:37,900 --> 00:40:42,339
or my entry is now rolled so we'll add

995
00:40:42,339 --> 00:40:44,890
some white space in there all right cuz

996
00:40:44,890 --> 00:40:47,170
white space saves everything when we

997
00:40:47,170 --> 00:40:50,619
come back in here now and look at our

998
00:40:50,619 --> 00:40:53,200
next entry we see nothing there we

999
00:40:53,200 --> 00:40:56,290
scroll down we'll see our code so now

1000
00:40:56,290 --> 00:40:58,359
what I want to do is I want to

1001
00:40:58,359 --> 00:41:00,609
essentially when I look at like an

1002
00:41:00,609 --> 00:41:02,410
application log or something there's

1003
00:41:02,410 --> 00:41:05,950
some text there and I'm good I typically

1004
00:41:05,950 --> 00:41:07,359
don't interact with it we're trying to

1005
00:41:07,359 --> 00:41:10,170
scroll down if I see text whitespace I

1006
00:41:10,170 --> 00:41:13,480
assess that that's the end of it so what

1007
00:41:13,480 --> 00:41:15,640
we're gonna do is try to get past a

1008
00:41:15,640 --> 00:41:17,799
human nature in that same respect and

1009
00:41:17,799 --> 00:41:20,950
I'm gonna say an update was detected

1010
00:41:20,950 --> 00:41:23,589
we'll add in 50 white spaces in our code

1011
00:41:23,589 --> 00:41:26,170
all right surely if this is the Windows

1012
00:41:26,170 --> 00:41:29,680
Update err event log surely something

1013
00:41:29,680 --> 00:41:34,710
like an update was detected is legit

1014
00:41:35,340 --> 00:41:37,930
so now we come here we see an update was

1015
00:41:37,930 --> 00:41:40,480
detected if they scroll down they'll see

1016
00:41:40,480 --> 00:41:42,820
my code but at that point I feel pretty

1017
00:41:42,820 --> 00:41:43,270
good

1018
00:41:43,270 --> 00:41:47,050
I'll sleep good that night I may worry

1019
00:41:47,050 --> 00:41:48,220
the next day if I'm waiting on the

1020
00:41:48,220 --> 00:41:49,690
beacon and we're like three minutes past

1021
00:41:49,690 --> 00:41:52,030
that time I might go smoke a cigarette

1022
00:41:52,030 --> 00:41:56,590
now any smoke all right so cool from an

1023
00:41:56,590 --> 00:41:59,110
event log perspective and the same thing

1024
00:41:59,110 --> 00:42:01,150
when it's time for me to actually run it

1025
00:42:01,150 --> 00:42:03,760
I'm going to call upon that entry I'll

1026
00:42:03,760 --> 00:42:05,650
trim all the white space and everything

1027
00:42:05,650 --> 00:42:08,020
else that I have on there and I will let

1028
00:42:08,020 --> 00:42:12,490
it rip now from a event log perspective

1029
00:42:12,490 --> 00:42:15,610
we have the comment field there's not a

1030
00:42:15,610 --> 00:42:18,010
way from the GUI that we can edit to

1031
00:42:18,010 --> 00:42:19,510
comment though it would force somebody

1032
00:42:19,510 --> 00:42:21,880
if they're gonna use it to utilize the

1033
00:42:21,880 --> 00:42:24,850
command line so for us to get after this

1034
00:42:24,850 --> 00:42:28,510
we're going to read in or call upon the

1035
00:42:28,510 --> 00:42:30,850
default domain policy I'm going to

1036
00:42:30,850 --> 00:42:33,220
change the description with you guessed

1037
00:42:33,220 --> 00:42:36,190
it my text and now when I come look at

1038
00:42:36,190 --> 00:42:38,740
this I'm like whoa that can't be good

1039
00:42:38,740 --> 00:42:40,950
right because even if an admin is just

1040
00:42:40,950 --> 00:42:43,240
quickly browsing through getting ready

1041
00:42:43,240 --> 00:42:45,250
to interact with it something like that

1042
00:42:45,250 --> 00:42:49,240
may stand out so you can kind of see

1043
00:42:49,240 --> 00:42:50,710
what we're gonna do here we're gonna

1044
00:42:50,710 --> 00:42:51,760
suppress everything

1045
00:42:51,760 --> 00:42:54,900
now before I was able to use backtick in

1046
00:42:54,900 --> 00:42:57,490
for new line but for some reason

1047
00:42:57,490 --> 00:42:59,590
backtick end did not work here so I

1048
00:42:59,590 --> 00:43:01,360
found myself almost like I was trying to

1049
00:43:01,360 --> 00:43:03,310
overflow a buffer where I was writing in

1050
00:43:03,310 --> 00:43:05,350
like no characters like Oh Craig I can

1051
00:43:05,350 --> 00:43:07,390
still see it let me do another okay now

1052
00:43:07,390 --> 00:43:08,910
I can't see it that's the magic number

1053
00:43:08,910 --> 00:43:11,950
cool so I added in roughly 40 or so

1054
00:43:11,950 --> 00:43:14,800
blank spaces and then we'll be able to

1055
00:43:14,800 --> 00:43:17,470
actually write it there so we'll execute

1056
00:43:17,470 --> 00:43:19,830
that

1057
00:43:20,549 --> 00:43:22,609
you

1058
00:43:23,210 --> 00:43:25,609
cool now we'll come back in here and

1059
00:43:25,609 --> 00:43:28,579
we'll look at it

1060
00:43:28,579 --> 00:43:32,400
and we see it's now off the screen

1061
00:43:32,400 --> 00:43:38,250
awesome if we want to actually call upon

1062
00:43:38,250 --> 00:43:41,369
it or just read it we'll see something

1063
00:43:41,369 --> 00:43:42,869
like that well we have all this blank

1064
00:43:42,869 --> 00:43:45,780
space and our code if an admins reading

1065
00:43:45,780 --> 00:43:48,930
a group policy objects utilizing command

1066
00:43:48,930 --> 00:43:51,900
line like this our mileage will vary but

1067
00:43:51,900 --> 00:43:53,730
when it's time for us to execute you

1068
00:43:53,730 --> 00:43:55,770
guessed it we can trim everything and be

1069
00:43:55,770 --> 00:44:01,440
good to go from a host file perspective

1070
00:44:01,440 --> 00:44:03,900
I'm gonna just call in or read in that

1071
00:44:03,900 --> 00:44:07,109
string and then I'm going to add content

1072
00:44:07,109 --> 00:44:10,920
to that file a value of my base64 code

1073
00:44:10,920 --> 00:44:13,079
and I'm gonna add it to a stream called

1074
00:44:13,079 --> 00:44:16,109
zones right why zones because it felt

1075
00:44:16,109 --> 00:44:19,369
good on my soul um when you look at this

1076
00:44:19,369 --> 00:44:24,180
right just looking at what uh ATS is are

1077
00:44:24,180 --> 00:44:28,020
there we'll see something like this and

1078
00:44:28,020 --> 00:44:30,569
if somebody's looking that data dollar

1079
00:44:30,569 --> 00:44:32,310
sign data is gonna be the default one

1080
00:44:32,310 --> 00:44:34,050
and I just added in zones because it

1081
00:44:34,050 --> 00:44:36,839
felt good it looked good smell good all

1082
00:44:36,839 --> 00:44:39,810
that good stuff so now I'm going to read

1083
00:44:39,810 --> 00:44:43,740
in that data and then I'm going to pass

1084
00:44:43,740 --> 00:44:45,780
that to PowerShell so I can actually

1085
00:44:45,780 --> 00:44:46,680
have it

1086
00:44:46,680 --> 00:44:52,050
execute all right all right all right so

1087
00:44:52,050 --> 00:44:55,619
we got two more the second to last one

1088
00:44:55,619 --> 00:44:56,880
here is going to be dealing with

1089
00:44:56,880 --> 00:44:59,790
environment variables so when I utilize

1090
00:44:59,790 --> 00:45:02,280
PowerShell to affect part environment

1091
00:45:02,280 --> 00:45:05,819
variables I'm going to create one but it

1092
00:45:05,819 --> 00:45:07,859
doesn't persist past my current session

1093
00:45:07,859 --> 00:45:10,109
and I'm also gonna create a system one

1094
00:45:10,109 --> 00:45:12,839
but it needs to restart this the system

1095
00:45:12,839 --> 00:45:15,060
needs to restart before it kicks in so

1096
00:45:15,060 --> 00:45:17,640
this first one is creating a temporary

1097
00:45:17,640 --> 00:45:19,680
one and then that cept second one

1098
00:45:19,680 --> 00:45:22,619
creates my permanent one but it again

1099
00:45:22,619 --> 00:45:24,329
won't kick in into the system restarts

1100
00:45:24,329 --> 00:45:26,910
what I'm gonna do is come back over here

1101
00:45:26,910 --> 00:45:33,420
and really look at where that's at so I

1102
00:45:33,420 --> 00:45:38,140
have a number of things that are there

1103
00:45:38,140 --> 00:45:41,980
and we see the one that we created there

1104
00:45:41,980 --> 00:45:45,579
was already a w6 six four three two so I

1105
00:45:45,579 --> 00:45:48,430
created a w6 for cuz it felt good but

1106
00:45:48,430 --> 00:45:50,739
again it stands out if somebody's

1107
00:45:50,739 --> 00:45:53,829
looking at this so we're gonna Pat it

1108
00:45:53,829 --> 00:45:56,579
with some white space

1109
00:45:57,839 --> 00:46:02,260
awesome come back in here look at it

1110
00:46:02,260 --> 00:46:06,660
and now we have this ugly blank one so

1111
00:46:06,660 --> 00:46:09,609
instead of us doing value not set here

1112
00:46:09,609 --> 00:46:12,580
I'm gonna use a donor if you will I'm

1113
00:46:12,580 --> 00:46:14,680
just gonna copy what six four three two

1114
00:46:14,680 --> 00:46:17,560
has its entry also save it here and

1115
00:46:17,560 --> 00:46:20,200
steadily have my white space and push

1116
00:46:20,200 --> 00:46:21,700
down my actual code

1117
00:46:21,700 --> 00:46:24,880
so I'll read in what six four three two

1118
00:46:24,880 --> 00:46:27,430
has and then I'll execute nearly the

1119
00:46:27,430 --> 00:46:30,820
same thing starting that entry off with

1120
00:46:30,820 --> 00:46:33,460
the code that six four three two has and

1121
00:46:33,460 --> 00:46:36,600
when we look at that

1122
00:46:37,530 --> 00:46:42,190
we see our w66 with the same thing as

1123
00:46:42,190 --> 00:46:44,410
six four three two and if we were to

1124
00:46:44,410 --> 00:46:47,380
open it up and interact with it we have

1125
00:46:47,380 --> 00:46:49,630
our code we have some white space and

1126
00:46:49,630 --> 00:46:53,920
then we have C Program Files common

1127
00:46:53,920 --> 00:46:56,680
files ultimately I want an admin if

1128
00:46:56,680 --> 00:46:58,810
they're gonna investigate this I want

1129
00:46:58,810 --> 00:47:00,190
them to feel like there's nothing to see

1130
00:47:00,190 --> 00:47:02,920
here just keep moving right I also want

1131
00:47:02,920 --> 00:47:04,270
to be a snitch and be like hey man don't

1132
00:47:04,270 --> 00:47:06,819
look at this event code um go look at

1133
00:47:06,819 --> 00:47:08,980
I'm sorry this registry key don't look

1134
00:47:08,980 --> 00:47:10,270
at that one over there that's who you're

1135
00:47:10,270 --> 00:47:13,150
really looking for when it's time for me

1136
00:47:13,150 --> 00:47:15,670
to run it trim my whitespace and be good

1137
00:47:15,670 --> 00:47:19,650
to go from aw on my sim perspective

1138
00:47:19,650 --> 00:47:22,540
again roughly 10,000 on my machine I'm

1139
00:47:22,540 --> 00:47:24,520
going to create one called

1140
00:47:24,520 --> 00:47:29,020
win 30 to defend 64 cuz largely locked a

1141
00:47:29,020 --> 00:47:30,819
decent amount of the classes begin with

1142
00:47:30,819 --> 00:47:34,000
win32 so I want this to blend in I'm

1143
00:47:34,000 --> 00:47:38,109
going to create a property called path

1144
00:47:38,109 --> 00:47:41,079
and I'm gonna store my code there and

1145
00:47:41,079 --> 00:47:43,839
then when I go back to read it I'll be

1146
00:47:43,839 --> 00:47:46,839
able to see my code now this class is

1147
00:47:46,839 --> 00:47:50,020
now one of 10,000 plus entries on this

1148
00:47:50,020 --> 00:47:52,270
system when it's time for me to execute

1149
00:47:52,270 --> 00:47:52,660
it

1150
00:47:52,660 --> 00:47:55,510
I just called upon now I don't feel like

1151
00:47:55,510 --> 00:47:57,750
I need to further off you scape that if

1152
00:47:57,750 --> 00:47:59,770
somebody wanted to actually look at

1153
00:47:59,770 --> 00:48:02,079
these classes a little bit deeper and

1154
00:48:02,079 --> 00:48:03,490
they knew which one they were looking at

1155
00:48:03,490 --> 00:48:05,710
they could actually use this program

1156
00:48:05,710 --> 00:48:08,619
inherent to Windows and from here they

1157
00:48:08,619 --> 00:48:12,040
could specify recursively all roughly

1158
00:48:12,040 --> 00:48:13,660
10,000 or so or they can do the

1159
00:48:13,660 --> 00:48:15,280
immediate ones in that namespace and

1160
00:48:15,280 --> 00:48:17,500
from that perspective they can then

1161
00:48:17,500 --> 00:48:19,119
scroll down to something that they're

1162
00:48:19,119 --> 00:48:21,400
looking for maybe get to a point where

1163
00:48:21,400 --> 00:48:24,280
they see when defend 64 notice we don't

1164
00:48:24,280 --> 00:48:27,490
see our code there and if they had a WoW

1165
00:48:27,490 --> 00:48:29,560
hair they could then interact with it

1166
00:48:29,560 --> 00:48:31,240
come down and they would see the

1167
00:48:31,240 --> 00:48:34,270
property in which we've created lots of

1168
00:48:34,270 --> 00:48:37,589
work that's good

1169
00:48:37,960 --> 00:48:39,790
you

1170
00:48:39,790 --> 00:48:41,630
you

1171
00:48:41,630 --> 00:48:43,690
you

1172
00:48:44,710 --> 00:48:46,770
you

1173
00:48:49,849 --> 00:48:51,650
all right so as you see there's a number

1174
00:48:51,650 --> 00:48:53,420
of ways for us to do this now

1175
00:48:53,420 --> 00:48:55,549
you may be wondering well people really

1176
00:48:55,549 --> 00:48:57,650
using this hey look from the objective

1177
00:48:57,650 --> 00:48:59,630
perspective oh don't trust what I'm

1178
00:48:59,630 --> 00:49:01,789
saying let's look at what the data say

1179
00:49:01,789 --> 00:49:04,119
right says so we have a number of

1180
00:49:04,119 --> 00:49:06,259
organizations the nation-state

1181
00:49:06,259 --> 00:49:07,729
hacktivists whatever you want to call

1182
00:49:07,729 --> 00:49:10,579
them that are utilizing stagers in some

1183
00:49:10,579 --> 00:49:12,859
form of fashion alright and this is just

1184
00:49:12,859 --> 00:49:15,049
a small list when you think about it it

1185
00:49:15,049 --> 00:49:19,430
only makes sense like why go all in when

1186
00:49:19,430 --> 00:49:21,109
you can kind of taste the water a little

1187
00:49:21,109 --> 00:49:22,849
bit to make sure it's what you want

1188
00:49:22,849 --> 00:49:26,539
before you put your hard-earned equity

1189
00:49:26,539 --> 00:49:29,370
on that actual system

1190
00:49:29,370 --> 00:49:31,290
now we do have some pros and we have

1191
00:49:31,290 --> 00:49:33,000
some cons so the pros very lightweight

1192
00:49:33,000 --> 00:49:35,550
could be low equity absolutely because

1193
00:49:35,550 --> 00:49:37,230
again if I lose that what do I lose and

1194
00:49:37,230 --> 00:49:39,930
domain maybe an IP address maybe you

1195
00:49:39,930 --> 00:49:42,450
know just a name of what I call the foul

1196
00:49:42,450 --> 00:49:44,520
and that doesn't even mean anything it's

1197
00:49:44,520 --> 00:49:47,220
modular so I have this stager that

1198
00:49:47,220 --> 00:49:49,680
literally goes and has one job and then

1199
00:49:49,680 --> 00:49:51,420
depending on what it brings back to me

1200
00:49:51,420 --> 00:49:53,430
for information I could have a module

1201
00:49:53,430 --> 00:49:55,410
that then surveys I have a module that's

1202
00:49:55,410 --> 00:49:57,330
a key logger I have a module does this

1203
00:49:57,330 --> 00:50:00,030
that's this right so it's very modular

1204
00:50:00,030 --> 00:50:02,370
in nature where I don't have to bring

1205
00:50:02,370 --> 00:50:06,140
everything at one time and literally my

1206
00:50:06,140 --> 00:50:09,450
c2 server could be hosted anywhere the

1207
00:50:09,450 --> 00:50:11,490
same with my stager it's like if there

1208
00:50:11,490 --> 00:50:13,710
is a place for me to store it in Windows

1209
00:50:13,710 --> 00:50:15,660
and there is a million places they call

1210
00:50:15,660 --> 00:50:18,420
it features um it's a place in which I

1211
00:50:18,420 --> 00:50:20,670
can go back and grab it now with that

1212
00:50:20,670 --> 00:50:22,650
there's some work that has to be done to

1213
00:50:22,650 --> 00:50:24,210
even get to this thing we're talking

1214
00:50:24,210 --> 00:50:26,220
post exploitation so if you can't even

1215
00:50:26,220 --> 00:50:28,260
get in the door you won't even get to

1216
00:50:28,260 --> 00:50:30,960
the point of using it and some defenders

1217
00:50:30,960 --> 00:50:32,640
are better than others we can all agree

1218
00:50:32,640 --> 00:50:35,370
with that so as we begin to use this

1219
00:50:35,370 --> 00:50:38,070
really it's visible then next stage of

1220
00:50:38,070 --> 00:50:41,370
our retrieval it's going to create a

1221
00:50:41,370 --> 00:50:44,310
connection so if there's real decent

1222
00:50:44,310 --> 00:50:47,160
logging and somebody is actually looking

1223
00:50:47,160 --> 00:50:49,860
it could highlight if the organization

1224
00:50:49,860 --> 00:50:53,880
has a good EDR we could be seen as well

1225
00:50:53,880 --> 00:50:56,280
right this is where you understand the

1226
00:50:56,280 --> 00:50:58,380
environment and then you pick which tool

1227
00:50:58,380 --> 00:51:01,650
is applicable or to tasks at hand we

1228
00:51:01,650 --> 00:51:03,750
could have ourselves we could find

1229
00:51:03,750 --> 00:51:05,250
ourselves rather in a place in which our

1230
00:51:05,250 --> 00:51:07,830
c2 server is blocked if we're using a

1231
00:51:07,830 --> 00:51:09,840
domain or really even an IP if we're

1232
00:51:09,840 --> 00:51:12,720
using a domain if the organization finds

1233
00:51:12,720 --> 00:51:14,580
it they could sinkhole the domain and

1234
00:51:14,580 --> 00:51:16,920
really new to our communication so

1235
00:51:16,920 --> 00:51:19,170
there's a lot riding on issues in a

1236
00:51:19,170 --> 00:51:22,470
stager and at perspective some detection

1237
00:51:22,470 --> 00:51:23,760
mitigation strategies

1238
00:51:23,760 --> 00:51:26,820
well proactive threat hunting like come

1239
00:51:26,820 --> 00:51:30,900
to work and actively go look at stuff on

1240
00:51:30,900 --> 00:51:34,230
your network assume breach well it's

1241
00:51:34,230 --> 00:51:36,360
quiet that's because they're good I'm

1242
00:51:36,360 --> 00:51:38,130
telling you if you go look you'll find

1243
00:51:38,130 --> 00:51:40,350
stuff all right reputation based web

1244
00:51:40,350 --> 00:51:42,190
analysis what does the

1245
00:51:42,190 --> 00:51:44,050
rest of the community think about this

1246
00:51:44,050 --> 00:51:46,660
domain or this file or whatever case

1247
00:51:46,660 --> 00:51:48,250
what is the rest of what is my

1248
00:51:48,250 --> 00:51:50,740
organization think about it in the sense

1249
00:51:50,740 --> 00:51:52,390
of is this file

1250
00:51:52,390 --> 00:51:54,870
resident somewhere else am i my system

1251
00:51:54,870 --> 00:51:57,030
mitigations least privileged

1252
00:51:57,030 --> 00:51:59,350
segmentation isolation application

1253
00:51:59,350 --> 00:52:01,930
whitelisting it hurts what man if you do

1254
00:52:01,930 --> 00:52:04,990
it it's worthwhile right somebody still

1255
00:52:04,990 --> 00:52:07,300
can do some nefarious stuff but at the

1256
00:52:07,300 --> 00:52:08,770
end of the day we're making it harder

1257
00:52:08,770 --> 00:52:11,080
for them it goes without saying patch

1258
00:52:11,080 --> 00:52:15,010
patch patch all right so cool now I'm on

1259
00:52:15,010 --> 00:52:17,950
the down stream right making my descent

1260
00:52:17,950 --> 00:52:20,020
down and I gotta get these shameless

1261
00:52:20,020 --> 00:52:21,640
plugs out right it is what it is I

1262
00:52:21,640 --> 00:52:23,830
apologize right so you see me use a lot

1263
00:52:23,830 --> 00:52:25,930
of power Schiller you guess it I like

1264
00:52:25,930 --> 00:52:27,670
power shield so I run a site called

1265
00:52:27,670 --> 00:52:29,710
under the wired I tech myself into other

1266
00:52:29,710 --> 00:52:32,140
people and been around for roughly 20

1267
00:52:32,140 --> 00:52:35,740
since 2015 we've had over 90,000 people

1268
00:52:35,740 --> 00:52:39,100
play from 78 countries when I google how

1269
00:52:39,100 --> 00:52:40,870
many countries there are I get somewhere

1270
00:52:40,870 --> 00:52:44,380
between 192 and 196 either way I'm

1271
00:52:44,380 --> 00:52:46,810
pretty happy with those stats it's free

1272
00:52:46,810 --> 00:52:49,120
and it's persistent it's going after the

1273
00:52:49,120 --> 00:52:51,280
core aspects of the language so if

1274
00:52:51,280 --> 00:52:53,350
you're looking to utilize the language a

1275
00:52:53,350 --> 00:52:55,630
little bit more because you maybe

1276
00:52:55,630 --> 00:52:57,400
thought what I was using it for was

1277
00:52:57,400 --> 00:52:59,170
pretty cool then here's a way to kind of

1278
00:52:59,170 --> 00:52:59,890
get after it

1279
00:52:59,890 --> 00:53:01,630
now if you feel like you know the

1280
00:53:01,630 --> 00:53:03,550
language I also run a site called posh

1281
00:53:03,550 --> 00:53:06,850
hunter so Posh hunter is very often sand

1282
00:53:06,850 --> 00:53:09,220
defensive-minded I'm gonna put you in a

1283
00:53:09,220 --> 00:53:11,320
scenario in which are either a defender

1284
00:53:11,320 --> 00:53:13,420
or your vulnerability penetration tester

1285
00:53:13,420 --> 00:53:17,350
and you're going to answer questions

1286
00:53:17,350 --> 00:53:19,750
utilize in an operating system or a

1287
00:53:19,750 --> 00:53:23,700
Windows instance that we're providing

1288
00:53:24,269 --> 00:53:26,519
all right so if you have questions I'll

1289
00:53:26,519 --> 00:53:28,589
step off to the side and answer them if

1290
00:53:28,589 --> 00:53:29,849
there is anything that you want to take

1291
00:53:29,849 --> 00:53:32,339
a picture of this is it when I get back

1292
00:53:32,339 --> 00:53:34,589
home to Augusta tonight I'm gonna put

1293
00:53:34,589 --> 00:53:36,299
these slides up there if you want to

1294
00:53:36,299 --> 00:53:37,889
interact with me on Twitter or anything

1295
00:53:37,889 --> 00:53:39,989
there's that and there's my code so

1296
00:53:39,989 --> 00:53:41,999
again I'm gonna step off to the side so

1297
00:53:41,999 --> 00:53:43,169
if there's any questions I'll take them

1298
00:53:43,169 --> 00:53:44,850
in thank you

1299
00:53:44,850 --> 00:53:48,900
[Applause]

