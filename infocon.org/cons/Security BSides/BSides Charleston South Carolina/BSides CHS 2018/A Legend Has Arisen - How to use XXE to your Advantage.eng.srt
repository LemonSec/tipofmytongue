1
00:00:38,790 --> 00:00:45,269
as a lesson<font color="#CCCCCC"> learned so I came</font><font color="#E5E5E5"> back in</font>

2
00:00:42,320 --> 00:00:46,830
2016<font color="#E5E5E5"> I believe and gave this talk and a</font>

3
00:00:45,270 --> 00:00:48,360
lot<font color="#CCCCCC"> has changed since</font><font color="#E5E5E5"> then I've updated</font>

4
00:00:46,830 --> 00:00:51,360
<font color="#E5E5E5">some of</font><font color="#CCCCCC"> this research I've done</font>

5
00:00:48,360 --> 00:00:54,420
<font color="#E5E5E5">I'm availing another unveiling but I'm</font>

6
00:00:51,360 --> 00:00:56,550
demonstrating<font color="#E5E5E5"> this tool that I built</font><font color="#CCCCCC"> so</font>

7
00:00:54,420 --> 00:00:58,590
with that in mind<font color="#CCCCCC"> I know that they</font><font color="#E5E5E5"> don't</font>

8
00:00:56,550 --> 00:01:01,760
<font color="#E5E5E5">have the best lighting in this</font><font color="#CCCCCC"> room</font><font color="#E5E5E5"> so</font>

9
00:00:58,590 --> 00:01:06,270
real quick<font color="#E5E5E5"> here is where you can</font><font color="#CCCCCC"> find</font>

10
00:01:01,760 --> 00:01:08,160
these slides<font color="#E5E5E5"> they're already viewed or</font>

11
00:01:06,270 --> 00:01:10,080
excuse me<font color="#E5E5E5"> they're already live on my</font>

12
00:01:08,160 --> 00:01:12,600
website so<font color="#CCCCCC"> feel free to go check them</font>

13
00:01:10,080 --> 00:01:14,220
out there<font color="#E5E5E5"> so</font><font color="#CCCCCC"> something about</font><font color="#E5E5E5"> me so I'm a</font>

14
00:01:12,600 --> 00:01:16,770
cyber operations officer I'm also a

15
00:01:14,220 --> 00:01:18,660
technical mentor for node SC which is a

16
00:01:16,770 --> 00:01:21,060
local nonprofit<font color="#E5E5E5"> in Charleston that</font>

17
00:01:18,660 --> 00:01:23,789
<font color="#E5E5E5">focuses on entrepreneurs or teaching</font>

18
00:01:21,060 --> 00:01:25,560
entrepreneurship<font color="#CCCCCC"> cybersecurity</font><font color="#E5E5E5"> and</font>

19
00:01:23,790 --> 00:01:27,090
information technology to high school

20
00:01:25,560 --> 00:01:29,910
students<font color="#CCCCCC"> college students and</font><font color="#E5E5E5"> just the</font>

21
00:01:27,090 --> 00:01:31,830
local community I'm a code<font color="#CCCCCC"> monkey</font><font color="#E5E5E5"> I code</font>

22
00:01:29,910 --> 00:01:34,350
in a lot of different languages<font color="#CCCCCC"> I and by</font>

23
00:01:31,830 --> 00:01:35,789
no<font color="#CCCCCC"> means a developer</font><font color="#E5E5E5"> but these are just</font>

24
00:01:34,350 --> 00:01:39,479
<font color="#E5E5E5">some of the things that I've had to</font>

25
00:01:35,790 --> 00:01:41,160
learn<font color="#CCCCCC"> not only through my time here at</font>

26
00:01:39,479 --> 00:01:43,830
College of Charleston so I<font color="#E5E5E5"> graduated in</font>

27
00:01:41,160 --> 00:01:45,899
2016<font color="#E5E5E5"> but also some of the projects that</font>

28
00:01:43,830 --> 00:01:48,870
I've<font color="#CCCCCC"> been working on</font><font color="#E5E5E5"> over the</font><font color="#CCCCCC"> last X</font>

29
00:01:45,900 --> 00:01:51,840
years<font color="#CCCCCC"> ten years I like to build</font><font color="#E5E5E5"> a lot of</font>

30
00:01:48,870 --> 00:01:54,450
Legos<font color="#E5E5E5"> and I'm currently trying to make a</font>

31
00:01:51,840 --> 00:01:59,220
be a perfect<font color="#CCCCCC"> old fashioned which is</font>

32
00:01:54,450 --> 00:02:02,010
still eluded me to this day right<font color="#CCCCCC"> so in</font>

33
00:01:59,220 --> 00:02:04,289
in doing<font color="#E5E5E5"> in doing this talk this started</font>

34
00:02:02,010 --> 00:02:06,360
off as a as a professional<font color="#E5E5E5"> development</font>

35
00:02:04,290 --> 00:02:10,440
<font color="#E5E5E5">for one of one of the soldiers</font><font color="#CCCCCC"> that</font>

36
00:02:06,360 --> 00:02:12,230
works with me<font color="#E5E5E5"> however</font><font color="#CCCCCC"> he's not here</font>

37
00:02:10,440 --> 00:02:14,820
right<font color="#CCCCCC"> now he is in</font><font color="#E5E5E5"> another country</font>

38
00:02:12,230 --> 00:02:15,260
<font color="#CCCCCC">called away on business so you're stuck</font>

39
00:02:14,820 --> 00:02:18,329
with me

40
00:02:15,260 --> 00:02:20,548
and also<font color="#E5E5E5"> this is a case you're wondering</font>

41
00:02:18,330 --> 00:02:21,959
who this handsome devil is right here

42
00:02:20,549 --> 00:02:23,340
this is<font color="#CCCCCC"> Clyde the cougar he's a mascot</font>

43
00:02:21,959 --> 00:02:26,940
at<font color="#E5E5E5"> college it's</font><font color="#CCCCCC"> awesome</font>

44
00:02:23,340 --> 00:02:28,080
this is me as the as<font color="#E5E5E5"> the mascot at</font>

45
00:02:26,940 --> 00:02:30,780
college after<font color="#CCCCCC"> all someone</font><font color="#E5E5E5"> he got his</font>

46
00:02:28,080 --> 00:02:31,860
class ring<font color="#CCCCCC"> his name is Clyde so I put a</font>

47
00:02:30,780 --> 00:02:32,940
photo<font color="#CCCCCC"> Clyde out</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> because you know</font>

48
00:02:31,860 --> 00:02:36,660
what I look<font color="#CCCCCC"> like I'm standing</font><font color="#E5E5E5"> in front</font>

49
00:02:32,940 --> 00:02:38,700
of you<font color="#CCCCCC"> so here's our roadmap so</font><font color="#E5E5E5"> we're</font>

50
00:02:36,660 --> 00:02:39,989
<font color="#CCCCCC">going to talk about what is xxe and what</font>

51
00:02:38,700 --> 00:02:42,329
can we do with<font color="#CCCCCC"> it</font>

52
00:02:39,989 --> 00:02:47,340
the different types are different<font color="#CCCCCC"> xxe</font>

53
00:02:42,330 --> 00:02:49,470
attacks<font color="#E5E5E5"> and it types that that there are</font>

54
00:02:47,340 --> 00:02:52,139
which you<font color="#CCCCCC"> can use and</font><font color="#E5E5E5"> just general</font><font color="#CCCCCC"> pin</font>

55
00:02:49,470 --> 00:02:52,470
<font color="#E5E5E5">testing but to understand</font><font color="#CCCCCC"> sxe you have</font>

56
00:02:52,139 --> 00:02:55,740
to<font color="#E5E5E5"> enter</font>

57
00:02:52,470 --> 00:02:58,500
<font color="#CCCCCC">and XML right so</font><font color="#E5E5E5"> just a quick down and</font>

58
00:02:55,740 --> 00:03:02,070
dirty<font color="#E5E5E5"> discussion on that as well and in</font>

59
00:02:58,500 --> 00:03:05,880
a demo using<font color="#CCCCCC"> our tool Doulos so Doulos</font>

60
00:03:02,070 --> 00:03:08,370
<font color="#E5E5E5">is the Greek god of tricks in trickery</font>

61
00:03:05,880 --> 00:03:10,170
<font color="#CCCCCC">so that's where</font><font color="#E5E5E5"> that comes from</font>

62
00:03:08,370 --> 00:03:13,500
next we'll talk<font color="#CCCCCC"> about the defense</font>

63
00:03:10,170 --> 00:03:17,369
<font color="#E5E5E5">against</font><font color="#CCCCCC"> xxe after and some limitations</font>

64
00:03:13,500 --> 00:03:21,390
of<font color="#CCCCCC"> xxe right</font><font color="#E5E5E5"> so depending on how you</font><font color="#CCCCCC"> use</font>

65
00:03:17,370 --> 00:03:25,709
your attacks<font color="#CCCCCC"> how you actually attack a</font>

66
00:03:21,390 --> 00:03:29,640
web app<font color="#E5E5E5"> or some other thing</font><font color="#CCCCCC"> that parses</font>

67
00:03:25,709 --> 00:03:32,610
<font color="#CCCCCC">xml files we'll talk about those</font>

68
00:03:29,640 --> 00:03:34,079
limitations<font color="#CCCCCC"> lastly we'll talk about</font><font color="#E5E5E5"> our</font>

69
00:03:32,610 --> 00:03:36,630
red blue and<font color="#E5E5E5"> purple teams and how they</font>

70
00:03:34,080 --> 00:03:37,950
can<font color="#CCCCCC"> use that</font><font color="#E5E5E5"> sexy and then open it up</font>

71
00:03:36,630 --> 00:03:40,970
the questions questions that<font color="#E5E5E5"> are</font>

72
00:03:37,950 --> 00:03:44,119
authorized through<font color="#E5E5E5"> any portion of this</font>

73
00:03:40,970 --> 00:03:46,709
talk<font color="#CCCCCC"> so feel free to just</font><font color="#E5E5E5"> blurt them out</font>

74
00:03:44,120 --> 00:03:48,330
<font color="#E5E5E5">so the key takeaways right so if you</font>

75
00:03:46,709 --> 00:03:49,560
don't get anything else<font color="#E5E5E5"> from this the</font>

76
00:03:48,330 --> 00:03:51,959
three<font color="#CCCCCC"> things</font><font color="#E5E5E5"> I want</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> to get</font><font color="#CCCCCC"> away from</font>

77
00:03:49,560 --> 00:03:53,930
the takeaway from this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> understand XML</font>

78
00:03:51,959 --> 00:03:56,100
and<font color="#E5E5E5"> how it's used for good and</font><font color="#CCCCCC"> bad</font>

79
00:03:53,930 --> 00:03:59,280
<font color="#CCCCCC">understand how web applications</font><font color="#E5E5E5"> are</font>

80
00:03:56,100 --> 00:04:00,780
exploited using<font color="#E5E5E5"> xxe and then lastly I</font>

81
00:03:59,280 --> 00:04:02,100
want you to understand and see<font color="#CCCCCC"> the</font>

82
00:04:00,780 --> 00:04:03,480
attack through the eyes of<font color="#CCCCCC"> the red team</font>

83
00:04:02,100 --> 00:04:05,790
the blue team<font color="#E5E5E5"> in a purple team so the</font>

84
00:04:03,480 --> 00:04:09,290
red<font color="#CCCCCC"> team is pretty self-explanatory</font>

85
00:04:05,790 --> 00:04:14,190
<font color="#E5E5E5">this talk is more red team based</font><font color="#CCCCCC"> however</font>

86
00:04:09,290 --> 00:04:16,560
in my work as working in<font color="#E5E5E5"> security</font>

87
00:04:14,190 --> 00:04:20,370
operation centers and working in

88
00:04:16,560 --> 00:04:22,740
offensive<font color="#CCCCCC"> security there there</font><font color="#E5E5E5"> isn't a</font>

89
00:04:20,370 --> 00:04:25,560
<font color="#CCCCCC">very good blend of</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> right so this</font>

90
00:04:22,740 --> 00:04:27,960
idea of purple teaming isn't new<font color="#CCCCCC"> but</font>

91
00:04:25,560 --> 00:04:30,270
<font color="#CCCCCC">it's not it's starting to become adopted</font>

92
00:04:27,960 --> 00:04:32,549
<font color="#CCCCCC">as people are starting more</font><font color="#E5E5E5"> to more and</font>

93
00:04:30,270 --> 00:04:36,330
<font color="#E5E5E5">more to talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> it so I would like</font>

94
00:04:32,550 --> 00:04:37,590
<font color="#E5E5E5">for the red teamers to really look not</font>

95
00:04:36,330 --> 00:04:39,180
through the<font color="#CCCCCC"> eyes</font><font color="#E5E5E5"> of the red team</font><font color="#CCCCCC"> or how</font>

96
00:04:37,590 --> 00:04:41,549
I can<font color="#CCCCCC"> use this in my toolkit you can</font>

97
00:04:39,180 --> 00:04:43,350
<font color="#CCCCCC">always do that</font><font color="#E5E5E5"> later look through the</font>

98
00:04:41,550 --> 00:04:46,260
eyes of<font color="#E5E5E5"> the blue team so what artifacts</font>

99
00:04:43,350 --> 00:04:48,690
am i leaving behind<font color="#CCCCCC"> how can I be</font>

100
00:04:46,260 --> 00:04:51,409
detected in this right and<font color="#E5E5E5"> then the blue</font>

101
00:04:48,690 --> 00:04:54,719
team members<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is how this is one way</font>

102
00:04:51,410 --> 00:04:57,090
one<font color="#CCCCCC"> of you know probably thousands</font>

103
00:04:54,720 --> 00:05:01,860
hundreds of thousands<font color="#E5E5E5"> of ways</font><font color="#CCCCCC"> web apps</font>

104
00:04:57,090 --> 00:05:04,060
can become exploited right so<font color="#E5E5E5"> so let's</font>

105
00:05:01,860 --> 00:05:06,010
go to begin what<font color="#CCCCCC"> does that</font><font color="#E5E5E5"> sexy</font>

106
00:05:04,060 --> 00:05:08,530
how do we<font color="#E5E5E5"> use it right so</font><font color="#CCCCCC"> xxe by</font>

107
00:05:06,010 --> 00:05:11,260
definition from<font color="#E5E5E5"> a loss is an XML</font>

108
00:05:08,530 --> 00:05:13,719
external entity attack against an

109
00:05:11,260 --> 00:05:15,700
application<font color="#E5E5E5"> that parses</font><font color="#CCCCCC"> XML input right</font>

110
00:05:13,720 --> 00:05:17,320
so<font color="#E5E5E5"> this attack occurs when an XML input</font>

111
00:05:15,700 --> 00:05:19,210
containing a reference to an<font color="#CCCCCC"> external</font>

112
00:05:17,320 --> 00:05:21,280
entity<font color="#E5E5E5"> is processed by a weakly</font>

113
00:05:19,210 --> 00:05:25,450
configured XML parser<font color="#E5E5E5"> so weakly</font>

114
00:05:21,280 --> 00:05:28,869
configured XML parser is the the key you

115
00:05:25,450 --> 00:05:31,419
<font color="#E5E5E5">know to this whole attack right so so</font>

116
00:05:28,870 --> 00:05:34,000
what does that mean<font color="#CCCCCC"> right so</font><font color="#E5E5E5"> I you know</font>

117
00:05:31,419 --> 00:05:36,820
<font color="#CCCCCC">it's basic level you craft some XML</font>

118
00:05:34,000 --> 00:05:39,669
payload<font color="#E5E5E5"> right and then this payload is</font>

119
00:05:36,820 --> 00:05:42,969
pushed to an XML parser<font color="#CCCCCC"> right so an XML</font>

120
00:05:39,669 --> 00:05:45,159
parser<font color="#E5E5E5"> can be written in Java PHP really</font>

121
00:05:42,970 --> 00:05:48,700
anything<font color="#CCCCCC"> that can handle and take in</font>

122
00:05:45,160 --> 00:05:51,760
input<font color="#E5E5E5"> XML input and an output</font><font color="#CCCCCC"> you know</font>

123
00:05:48,700 --> 00:05:55,419
some thing<font color="#CCCCCC"> can do some function can do</font>

124
00:05:51,760 --> 00:05:57,219
some thing period right<font color="#E5E5E5"> the parser will</font>

125
00:05:55,419 --> 00:06:00,370
then interpret<font color="#CCCCCC"> that payload</font><font color="#E5E5E5"> that's that</font>

126
00:05:57,220 --> 00:06:02,740
thing and then pwnage whatever whatever

127
00:06:00,370 --> 00:06:05,350
<font color="#E5E5E5">that payload was crafted and designed to</font>

128
00:06:02,740 --> 00:06:08,110
do right<font color="#E5E5E5"> so some of the attacks you can</font>

129
00:06:05,350 --> 00:06:11,260
do remote code execution is<font color="#E5E5E5"> number one</font>

130
00:06:08,110 --> 00:06:13,150
however<font color="#E5E5E5"> is extremely unlikely just in</font>

131
00:06:11,260 --> 00:06:14,680
modern web apps you're not really gonna

132
00:06:13,150 --> 00:06:16,900
see this but if you're going<font color="#E5E5E5"> through</font>

133
00:06:14,680 --> 00:06:19,000
this xxe route and you want to test this

134
00:06:16,900 --> 00:06:21,489
out through a file upload feature or

135
00:06:19,000 --> 00:06:24,190
some other thing<font color="#E5E5E5"> it's a simple quick</font>

136
00:06:21,490 --> 00:06:27,340
check to<font color="#E5E5E5"> see especially if it's a PHP</font>

137
00:06:24,190 --> 00:06:30,060
application just<font color="#E5E5E5"> check</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> see I forgot</font>

138
00:06:27,340 --> 00:06:33,549
the the library or excuse me the

139
00:06:30,060 --> 00:06:36,070
function but you know if it<font color="#CCCCCC"> comes back</font>

140
00:06:33,550 --> 00:06:39,280
<font color="#E5E5E5">that it's there you know that's that's a</font>

141
00:06:36,070 --> 00:06:41,139
strong indicator<font color="#E5E5E5"> next</font><font color="#CCCCCC"> is denial service</font>

142
00:06:39,280 --> 00:06:43,090
<font color="#E5E5E5">to the billion last attack</font><font color="#CCCCCC"> so it's</font>

143
00:06:41,139 --> 00:06:47,650
really just<font color="#E5E5E5"> an entity</font><font color="#CCCCCC"> that calls another</font>

144
00:06:43,090 --> 00:06:51,880
entity<font color="#CCCCCC"> that within that entity</font><font color="#E5E5E5"> that was</font>

145
00:06:47,650 --> 00:06:54,580
called there might be<font color="#E5E5E5"> you know like</font>

146
00:06:51,880 --> 00:06:57,340
<font color="#E5E5E5">seven</font><font color="#CCCCCC"> A's right and then the the second</font>

147
00:06:54,580 --> 00:07:00,010
entity<font color="#E5E5E5"> is calling</font><font color="#CCCCCC"> that one</font><font color="#E5E5E5"> four times</font>

148
00:06:57,340 --> 00:07:02,200
and<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the third entity is calling</font><font color="#CCCCCC"> that</font>

149
00:07:00,010 --> 00:07:04,539
one four times so really you see how it

150
00:07:02,200 --> 00:07:07,060
can just become exponential<font color="#E5E5E5"> right and</font>

151
00:07:04,539 --> 00:07:10,150
<font color="#E5E5E5">just toss it next to the server side</font>

152
00:07:07,060 --> 00:07:12,669
request forgery this is I want your web

153
00:07:10,150 --> 00:07:14,310
app I want<font color="#E5E5E5"> it I want you web application</font>

154
00:07:12,669 --> 00:07:16,630
to<font color="#E5E5E5"> go grab something and go do something</font>

155
00:07:14,310 --> 00:07:17,169
<font color="#CCCCCC">pull something demonstrate something</font>

156
00:07:16,630 --> 00:07:18,550
<font color="#E5E5E5">show me</font>

157
00:07:17,169 --> 00:07:22,930
something but I want you to<font color="#CCCCCC"> do it</font>

158
00:07:18,550 --> 00:07:26,020
running as yourself<font color="#E5E5E5"> or another thing or</font>

159
00:07:22,930 --> 00:07:27,759
another with another permission set<font color="#E5E5E5"> I</font>

160
00:07:26,020 --> 00:07:30,549
<font color="#E5E5E5">don't want you to tell anybody I don't</font>

161
00:07:27,759 --> 00:07:31,719
<font color="#E5E5E5">want any anybody else to know</font><font color="#CCCCCC"> and then</font>

162
00:07:30,550 --> 00:07:35,080
when<font color="#E5E5E5"> you get that</font><font color="#CCCCCC"> information just</font>

163
00:07:31,719 --> 00:07:36,909
<font color="#E5E5E5">display it</font><font color="#CCCCCC"> to me only</font><font color="#E5E5E5"> right excuse me</font>

164
00:07:35,080 --> 00:07:39,520
<font color="#CCCCCC">Nexus directory traversal so this is</font>

165
00:07:36,909 --> 00:07:41,529
just you know<font color="#E5E5E5"> navigating the directory</font>

166
00:07:39,520 --> 00:07:43,900
seeing what's there<font color="#CCCCCC"> getting</font><font color="#E5E5E5"> a lay of the</font>

167
00:07:41,529 --> 00:07:46,840
land essentially<font color="#E5E5E5"> port scanning and</font>

168
00:07:43,900 --> 00:07:48,159
self-explanatory<font color="#CCCCCC"> there local remote file</font>

169
00:07:46,840 --> 00:07:51,369
inclusions<font color="#CCCCCC"> to</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> you know what files</font>

170
00:07:48,159 --> 00:07:53,919
are there<font color="#CCCCCC"> so next let's actually start</font>

171
00:07:51,370 --> 00:07:55,749
<font color="#CCCCCC">talking about XML</font><font color="#E5E5E5"> right so XML is just</font>

172
00:07:53,919 --> 00:07:57,938
an extensible markup language<font color="#CCCCCC"> just</font>

173
00:07:55,749 --> 00:08:00,069
arrived from sgml<font color="#E5E5E5"> which</font><font color="#CCCCCC"> is a standard</font>

174
00:07:57,939 --> 00:08:05,620
generalized markup language<font color="#CCCCCC"> it</font><font color="#E5E5E5"> falls</font>

175
00:08:00,069 --> 00:08:08,169
from<font color="#E5E5E5"> the same family</font><font color="#CCCCCC"> of HTML so it's</font>

176
00:08:05,620 --> 00:08:09,969
<font color="#E5E5E5">really the the</font><font color="#CCCCCC"> HTML</font><font color="#E5E5E5"> is the international</font>

177
00:08:08,169 --> 00:08:11,169
standard<font color="#CCCCCC"> for defining</font><font color="#E5E5E5"> markup to describe</font>

178
00:08:09,969 --> 00:08:12,939
the structure<font color="#CCCCCC"> of different types of</font>

179
00:08:11,169 --> 00:08:15,339
<font color="#E5E5E5">electronic</font><font color="#CCCCCC"> documents</font><font color="#E5E5E5"> all right</font>

180
00:08:12,939 --> 00:08:17,379
HTML being one of them so<font color="#E5E5E5"> actual</font><font color="#CCCCCC"> web</font>

181
00:08:15,339 --> 00:08:19,180
pages<font color="#CCCCCC"> it's software</font><font color="#E5E5E5"> and hardware</font>

182
00:08:17,379 --> 00:08:22,180
independent and it's extremely

183
00:08:19,180 --> 00:08:24,399
<font color="#E5E5E5">lightweight so there's a simple</font>

184
00:08:22,180 --> 00:08:25,599
misconception which you'll see<font color="#E5E5E5"> here in</font>

185
00:08:24,399 --> 00:08:29,229
the next<font color="#CCCCCC"> couple slides but I'll actually</font>

186
00:08:25,599 --> 00:08:31,930
show you what<font color="#CCCCCC"> a very simple XML file</font>

187
00:08:29,229 --> 00:08:34,569
looks<font color="#CCCCCC"> like but it looks</font><font color="#E5E5E5"> extremely like</font>

188
00:08:31,930 --> 00:08:36,039
HTML<font color="#E5E5E5"> but the the core</font><font color="#CCCCCC"> focus and the</font>

189
00:08:34,570 --> 00:08:38,229
difference<font color="#E5E5E5"> between the two is that XML</font>

190
00:08:36,039 --> 00:08:41,740
holds data whereas<font color="#CCCCCC"> html's job is to</font>

191
00:08:38,229 --> 00:08:44,350
<font color="#E5E5E5">display data right so couple displaying</font>

192
00:08:41,740 --> 00:08:46,540
<font color="#E5E5E5">data with CSS</font><font color="#CCCCCC"> stylesheets</font><font color="#E5E5E5"> and then</font>

193
00:08:44,350 --> 00:08:54,310
you've got a pretty<font color="#E5E5E5"> hopefully if you</font>

194
00:08:46,540 --> 00:08:56,529
know how to style you know website<font color="#E5E5E5"> so so</font>

195
00:08:54,310 --> 00:08:59,260
what uses<font color="#E5E5E5"> XML right so we have Microsoft</font>

196
00:08:56,529 --> 00:09:02,410
Office<font color="#E5E5E5"> products so this is spreadsheets</font>

197
00:08:59,260 --> 00:09:06,220
Word documents powerpoints Apple<font color="#E5E5E5"> I work</font>

198
00:09:02,410 --> 00:09:08,079
open<font color="#CCCCCC"> offer a Libre Office are you seeing</font>

199
00:09:06,220 --> 00:09:10,500
the trend<font color="#E5E5E5"> so like all these office</font>

200
00:09:08,079 --> 00:09:14,260
documents have adopted this new standard

201
00:09:10,500 --> 00:09:17,290
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> the OpenOffice standard SVG</font>

202
00:09:14,260 --> 00:09:18,730
images are also XML so if you were to

203
00:09:17,290 --> 00:09:24,250
really look at these things<font color="#E5E5E5"> you would</font>

204
00:09:18,730 --> 00:09:27,490
see<font color="#CCCCCC"> XML structures and data X</font><font color="#E5E5E5"> HTML and X</font>

205
00:09:24,250 --> 00:09:29,019
CSS is HTML and CSS<font color="#E5E5E5"> written in XML</font>

206
00:09:27,490 --> 00:09:30,670
<font color="#CCCCCC">there's a matter of time someone</font><font color="#E5E5E5"> was</font>

207
00:09:29,019 --> 00:09:36,430
<font color="#E5E5E5">going to build it and find some useful</font>

208
00:09:30,670 --> 00:09:39,430
<font color="#E5E5E5">it</font><font color="#CCCCCC"> html5 derives from XHTML and X CSS</font>

209
00:09:36,430 --> 00:09:41,949
<font color="#E5E5E5">the RSS and atom feeds are also XML and</font>

210
00:09:39,430 --> 00:09:46,089
<font color="#E5E5E5">then</font><font color="#CCCCCC"> you can also</font><font color="#E5E5E5"> use XML through sip</font>

211
00:09:41,950 --> 00:09:48,010
and rest<font color="#CCCCCC"> web services right</font><font color="#E5E5E5"> so with all</font>

212
00:09:46,090 --> 00:09:49,750
this background knowledge<font color="#CCCCCC"> now let's</font>

213
00:09:48,010 --> 00:09:51,939
actually talk about classifications

214
00:09:49,750 --> 00:09:55,620
<font color="#CCCCCC">right so XML</font><font color="#E5E5E5"> has</font><font color="#CCCCCC"> two fossa</font><font color="#E5E5E5"> fication</font><font color="#CCCCCC"> z'</font>

215
00:09:51,940 --> 00:09:58,930
it's either valid or it's well-formed<font color="#E5E5E5"> so</font>

216
00:09:55,620 --> 00:10:00,760
<font color="#E5E5E5">all XML files must be well-formed so</font>

217
00:09:58,930 --> 00:10:04,000
well form means that there must<font color="#E5E5E5"> be a</font>

218
00:10:00,760 --> 00:10:07,600
root element<font color="#E5E5E5"> so in the next slide you'll</font>

219
00:10:04,000 --> 00:10:10,000
see<font color="#E5E5E5"> I will have a root element so it's</font>

220
00:10:07,600 --> 00:10:12,700
one element that<font color="#E5E5E5"> houses</font><font color="#CCCCCC"> atma this entire</font>

221
00:10:10,000 --> 00:10:14,290
<font color="#E5E5E5">file it could be note it could be file</font>

222
00:10:12,700 --> 00:10:17,170
it could<font color="#E5E5E5"> be whatever you want it to be</font>

223
00:10:14,290 --> 00:10:19,120
doesn't<font color="#CCCCCC"> XML doesn't care as long as</font><font color="#E5E5E5"> it</font>

224
00:10:17,170 --> 00:10:23,310
sees<font color="#E5E5E5"> that this is the root and this is</font>

225
00:10:19,120 --> 00:10:23,310
where the root ends right yes

226
00:10:27,180 --> 00:10:33,310
<font color="#CCCCCC">mm-hmm yep so then again if it</font><font color="#E5E5E5"> has a</font>

227
00:10:31,750 --> 00:10:34,959
root element<font color="#CCCCCC"> obviously it has to have a</font>

228
00:10:33,310 --> 00:10:38,319
closing<font color="#CCCCCC"> tag so if you have an open tag</font>

229
00:10:34,959 --> 00:10:41,258
you need a<font color="#E5E5E5"> closing tag right just simple</font>

230
00:10:38,319 --> 00:10:42,550
HTML tags are case sensitive<font color="#CCCCCC"> and must</font>

231
00:10:41,259 --> 00:10:46,180
match right

232
00:10:42,550 --> 00:10:47,920
they must be<font color="#E5E5E5"> properly nested</font><font color="#CCCCCC"> so exactly</font>

233
00:10:46,180 --> 00:10:49,839
what<font color="#E5E5E5"> you were saying earlier and then</font>

234
00:10:47,920 --> 00:10:52,719
all attribute values must be quoted

235
00:10:49,839 --> 00:10:54,939
right so if I say<font color="#E5E5E5"> that this is gonna be</font>

236
00:10:52,720 --> 00:10:56,800
a string of some sort<font color="#CCCCCC"> that string needs</font>

237
00:10:54,939 --> 00:11:00,099
to<font color="#E5E5E5"> be quoted so it can be interpreted as</font>

238
00:10:56,800 --> 00:11:02,050
<font color="#E5E5E5">such</font><font color="#CCCCCC"> XML does not require document type</font>

239
00:11:00,100 --> 00:11:03,579
definitions<font color="#E5E5E5"> but they can and most</font>

240
00:11:02,050 --> 00:11:05,769
<font color="#E5E5E5">definitely</font><font color="#CCCCCC"> do use them so the exploit</font>

241
00:11:03,579 --> 00:11:07,508
<font color="#CCCCCC">that you'll see today the proof of</font>

242
00:11:05,769 --> 00:11:11,110
concept today you'll you'll see that<font color="#E5E5E5"> I</font>

243
00:11:07,509 --> 00:11:13,360
am<font color="#E5E5E5"> using a document type definition and</font>

244
00:11:11,110 --> 00:11:14,980
<font color="#CCCCCC">well-formed just means your XML file is</font>

245
00:11:13,360 --> 00:11:17,319
correct syntax<font color="#E5E5E5"> so this is the basic</font>

246
00:11:14,980 --> 00:11:19,360
<font color="#CCCCCC">syntax there's a couple</font><font color="#E5E5E5"> more rules if</font>

247
00:11:17,319 --> 00:11:24,069
you<font color="#E5E5E5"> want to go</font><font color="#CCCCCC"> check out and</font><font color="#E5E5E5"> actually</font>

248
00:11:19,360 --> 00:11:26,230
read the manual<font color="#E5E5E5"> and the worker that</font>

249
00:11:24,069 --> 00:11:29,860
developed XML if you are one<font color="#E5E5E5"> of those</font>

250
00:11:26,230 --> 00:11:31,779
people<font color="#CCCCCC"> then I</font><font color="#E5E5E5"> have the the final slide</font>

251
00:11:29,860 --> 00:11:33,339
that's also on my website<font color="#E5E5E5"> has all these</font>

252
00:11:31,779 --> 00:11:37,870
resources<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can go</font><font color="#CCCCCC"> do for further</font>

253
00:11:33,339 --> 00:11:40,389
<font color="#E5E5E5">reading right</font><font color="#CCCCCC"> next is the valid</font><font color="#E5E5E5"> right so</font>

254
00:11:37,870 --> 00:11:42,730
valid is what happens when you have a

255
00:11:40,389 --> 00:11:44,829
<font color="#E5E5E5">document type definition so if you</font>

256
00:11:42,730 --> 00:11:48,310
declare and actually I think<font color="#E5E5E5"> this might</font>

257
00:11:44,829 --> 00:11:51,638
<font color="#CCCCCC">be a little</font><font color="#E5E5E5"> bit simpler</font><font color="#CCCCCC"> if you declare</font>

258
00:11:48,310 --> 00:11:53,949
this document type definition here right

259
00:11:51,639 --> 00:11:56,350
XML doesn't even try<font color="#E5E5E5"> to guess what it</font><font color="#CCCCCC"> is</font>

260
00:11:53,949 --> 00:11:59,139
that you're the structure of your<font color="#E5E5E5"> file</font>

261
00:11:56,350 --> 00:12:01,420
<font color="#E5E5E5">or</font><font color="#CCCCCC"> whatever is parsing your XML code</font>

262
00:11:59,139 --> 00:12:03,130
<font color="#E5E5E5">right so it says oh you have a document</font>

263
00:12:01,420 --> 00:12:05,439
<font color="#E5E5E5">type definition</font><font color="#CCCCCC"> well let me</font><font color="#E5E5E5"> go to this</font>

264
00:12:03,130 --> 00:12:07,930
document<font color="#E5E5E5"> type definition and understand</font>

265
00:12:05,439 --> 00:12:10,750
how you're structuring<font color="#E5E5E5"> your code here</font>

266
00:12:07,930 --> 00:12:13,449
<font color="#E5E5E5">right so I know what all</font><font color="#CCCCCC"> of this is so I</font>

267
00:12:10,750 --> 00:12:16,990
see an element<font color="#CCCCCC"> of note</font><font color="#E5E5E5"> should have a two</font>

268
00:12:13,449 --> 00:12:18,609
from heading and body<font color="#E5E5E5"> section in it</font>

269
00:12:16,990 --> 00:12:21,880
<font color="#E5E5E5">right so note here being the root</font>

270
00:12:18,610 --> 00:12:24,579
element and then the element<font color="#CCCCCC"> two from</font>

271
00:12:21,880 --> 00:12:26,680
heading a body<font color="#CCCCCC"> is PC data PC data two</font>

272
00:12:24,579 --> 00:12:29,469
stands for<font color="#E5E5E5"> parsed</font><font color="#CCCCCC"> character data</font><font color="#E5E5E5"> it just</font>

273
00:12:26,680 --> 00:12:31,059
<font color="#CCCCCC">says what's there print it like if you</font>

274
00:12:29,470 --> 00:12:35,649
can understand the characters within<font color="#E5E5E5"> it</font>

275
00:12:31,059 --> 00:12:39,459
<font color="#CCCCCC">XML supports</font><font color="#E5E5E5"> Unicode so just go</font><font color="#CCCCCC"> ahead</font>

276
00:12:35,649 --> 00:12:40,630
and print<font color="#CCCCCC"> it</font><font color="#E5E5E5"> right so going back here</font><font color="#CCCCCC"> is</font>

277
00:12:39,459 --> 00:12:43,449
the exact<font color="#E5E5E5"> same</font>

278
00:12:40,630 --> 00:12:48,459
that<font color="#E5E5E5"> I showed here the only difference</font>

279
00:12:43,449 --> 00:12:50,620
is is that<font color="#CCCCCC"> there's no DTD</font><font color="#E5E5E5"> right so again</font>

280
00:12:48,459 --> 00:12:52,329
<font color="#CCCCCC">like I said</font><font color="#E5E5E5"> you don't need a DTD but</font>

281
00:12:50,620 --> 00:12:54,579
you're leaving<font color="#CCCCCC"> it up to</font><font color="#E5E5E5"> chance for</font>

282
00:12:52,329 --> 00:12:57,819
<font color="#CCCCCC">whatever's parsing your XML file to</font>

283
00:12:54,579 --> 00:12:59,769
understand<font color="#E5E5E5"> XML and mate and make sure</font>

284
00:12:57,819 --> 00:13:03,029
your stuff is<font color="#CCCCCC"> written well</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so here</font>

285
00:12:59,769 --> 00:13:07,420
<font color="#CCCCCC">we have a declaration</font><font color="#E5E5E5"> of the XML version</font>

286
00:13:03,029 --> 00:13:11,410
of 1.0<font color="#CCCCCC"> so for my first candy bar</font><font color="#E5E5E5"> what is</font>

287
00:13:07,420 --> 00:13:13,199
the latest version<font color="#CCCCCC"> of XML and take a</font>

288
00:13:11,410 --> 00:13:16,990
guess

289
00:13:13,199 --> 00:13:18,399
1.1<font color="#CCCCCC"> who said</font><font color="#E5E5E5"> that you got it so you can</font>

290
00:13:16,990 --> 00:13:20,529
<font color="#E5E5E5">come take your pick up candy up here</font>

291
00:13:18,399 --> 00:13:22,630
whatever<font color="#E5E5E5"> one you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> if I throw</font>

292
00:13:20,529 --> 00:13:24,310
it I'll<font color="#E5E5E5"> just I'll nail you</font><font color="#CCCCCC"> and it or I</font>

293
00:13:22,630 --> 00:13:27,819
may miss you completely and<font color="#E5E5E5"> hit the</font>

294
00:13:24,310 --> 00:13:30,569
<font color="#CCCCCC">person to your left</font><font color="#E5E5E5"> so here you can also</font>

295
00:13:27,819 --> 00:13:33,939
set the encoding<font color="#E5E5E5"> so you got utf-8 utf-16</font>

296
00:13:30,569 --> 00:13:35,709
<font color="#CCCCCC">and then</font><font color="#E5E5E5"> the standalone so standalone</font>

297
00:13:33,940 --> 00:13:37,029
means there's<font color="#E5E5E5"> nothing else there's no</font>

298
00:13:35,709 --> 00:13:38,800
dependencies anywhere you don't<font color="#E5E5E5"> need to</font>

299
00:13:37,029 --> 00:13:40,899
go search for<font color="#E5E5E5"> it it's all right here</font>

300
00:13:38,800 --> 00:13:43,779
<font color="#E5E5E5">right so then we have our note which is</font>

301
00:13:40,899 --> 00:13:46,089
<font color="#E5E5E5">our</font><font color="#CCCCCC"> root and then two from heading a</font>

302
00:13:43,779 --> 00:13:48,009
body so we have a note from<font color="#CCCCCC"> Aubree to</font>

303
00:13:46,089 --> 00:13:49,449
<font color="#CCCCCC">keke</font><font color="#E5E5E5"> with a question asking do you love</font>

304
00:13:48,009 --> 00:13:55,060
<font color="#CCCCCC">me right</font>

305
00:13:49,449 --> 00:13:57,099
so again<font color="#E5E5E5"> well-formed example valid</font>

306
00:13:55,060 --> 00:13:59,439
<font color="#CCCCCC">example is the exact same note</font><font color="#E5E5E5"> the only</font>

307
00:13:57,100 --> 00:14:01,750
<font color="#E5E5E5">difference is is that</font><font color="#CCCCCC"> I am explicitly</font>

308
00:13:59,439 --> 00:14:05,800
stating what each of these elements are

309
00:14:01,750 --> 00:14:09,339
right so again if it's well if it's

310
00:14:05,800 --> 00:14:11,109
<font color="#E5E5E5">well-formed then it's good if it's</font><font color="#CCCCCC"> valid</font>

311
00:14:09,339 --> 00:14:13,060
and<font color="#E5E5E5"> it passes the check then it's</font>

312
00:14:11,110 --> 00:14:15,850
automatically assumed to be well-formed

313
00:14:13,060 --> 00:14:18,518
it's anybody<font color="#E5E5E5"> experienced in the room see</font>

314
00:14:15,850 --> 00:14:20,050
an issue<font color="#E5E5E5"> with</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> it's automatically</font>

315
00:14:18,519 --> 00:14:23,319
assumed<font color="#E5E5E5"> that is well-formed</font>

316
00:14:20,050 --> 00:14:26,349
right<font color="#CCCCCC"> so now let's start</font><font color="#E5E5E5"> getting into</font>

317
00:14:23,319 --> 00:14:27,759
the actual<font color="#CCCCCC"> xxe exploitation all</font><font color="#E5E5E5"> right so</font>

318
00:14:26,350 --> 00:14:29,680
there's three types<font color="#E5E5E5"> of attacks you got</font>

319
00:14:27,759 --> 00:14:31,899
<font color="#CCCCCC">in-band blunt blind and out-of-band</font><font color="#E5E5E5"> so</font>

320
00:14:29,680 --> 00:14:34,540
you might hear these terms<font color="#CCCCCC"> you know used</font>

321
00:14:31,899 --> 00:14:38,050
around<font color="#CCCCCC"> when talking about exploitation</font>

322
00:14:34,540 --> 00:14:41,709
<font color="#CCCCCC">so in band</font><font color="#E5E5E5"> you can essentially think</font><font color="#CCCCCC"> of</font>

323
00:14:38,050 --> 00:14:43,149
this as it's within the<font color="#CCCCCC"> same browser</font><font color="#E5E5E5"> or</font>

324
00:14:41,709 --> 00:14:47,768
<font color="#E5E5E5">a terminal window that you're shooting</font>

325
00:14:43,149 --> 00:14:49,420
code to<font color="#CCCCCC"> write blind is you're all you're</font>

326
00:14:47,769 --> 00:14:51,459
gonna get is an error<font color="#CCCCCC"> so then at</font><font color="#E5E5E5"> that</font>

327
00:14:49,420 --> 00:14:52,870
point you're blind you have you don't

328
00:14:51,459 --> 00:14:53,349
<font color="#E5E5E5">know you only know the errors that</font>

329
00:14:52,870 --> 00:14:55,450
<font color="#E5E5E5">you're getting</font>

330
00:14:53,350 --> 00:14:56,590
<font color="#E5E5E5">back and through enough errors hopefully</font>

331
00:14:55,450 --> 00:14:58,150
you'll be<font color="#E5E5E5"> able to get</font><font color="#CCCCCC"> a lay of</font><font color="#E5E5E5"> the land</font>

332
00:14:56,590 --> 00:15:00,670
and understand the<font color="#CCCCCC"> application that</font>

333
00:14:58,150 --> 00:15:04,000
<font color="#E5E5E5">you're dealing with</font><font color="#CCCCCC"> lastly is the out of</font>

334
00:15:00,670 --> 00:15:06,490
<font color="#CCCCCC">ban</font><font color="#E5E5E5"> so you may upload a file for</font>

335
00:15:04,000 --> 00:15:08,650
something or you may push like through a

336
00:15:06,490 --> 00:15:11,770
curl push something<font color="#E5E5E5"> to your server to</font>

337
00:15:08,650 --> 00:15:13,689
<font color="#E5E5E5">your web server and not get anything</font>

338
00:15:11,770 --> 00:15:16,449
back from<font color="#E5E5E5"> that same terminal window but</font>

339
00:15:13,690 --> 00:15:19,300
<font color="#E5E5E5">you might have</font><font color="#CCCCCC"> an in cat or netcat</font>

340
00:15:16,450 --> 00:15:22,180
listener<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> waiting</font><font color="#CCCCCC"> for a</font><font color="#E5E5E5"> connection</font>

341
00:15:19,300 --> 00:15:24,699
back<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> again here's an</font><font color="#E5E5E5"> in band</font>

342
00:15:22,180 --> 00:15:28,510
<font color="#CCCCCC">so this is an example</font><font color="#E5E5E5"> I just grabbed off</font>

343
00:15:24,700 --> 00:15:30,850
<font color="#E5E5E5">Google</font><font color="#CCCCCC"> Images of an ex sexy attack</font><font color="#E5E5E5"> using</font>

344
00:15:28,510 --> 00:15:33,100
burp suite<font color="#E5E5E5"> right so you crafted this</font>

345
00:15:30,850 --> 00:15:35,740
payload it sent some stuff<font color="#E5E5E5"> up just to</font>

346
00:15:33,100 --> 00:15:37,960
get the<font color="#CCCCCC"> etsy password file</font><font color="#E5E5E5"> and then it</font>

347
00:15:35,740 --> 00:15:42,490
was the server responded to this within

348
00:15:37,960 --> 00:15:45,880
the same window<font color="#CCCCCC"> using</font><font color="#E5E5E5"> quotes right</font><font color="#CCCCCC"> next</font>

349
00:15:42,490 --> 00:15:48,190
is example<font color="#CCCCCC"> two is</font><font color="#E5E5E5"> blind so</font><font color="#CCCCCC"> they try</font><font color="#E5E5E5"> to</font>

350
00:15:45,880 --> 00:15:51,390
do the exact<font color="#CCCCCC"> same</font><font color="#E5E5E5"> thing again</font>

351
00:15:48,190 --> 00:15:53,800
they<font color="#E5E5E5"> just sent some random cat just</font>

352
00:15:51,390 --> 00:15:55,390
arbitrary commands to<font color="#CCCCCC"> the server</font><font color="#E5E5E5"> just</font>

353
00:15:53,800 --> 00:15:58,359
let me see what I get<font color="#E5E5E5"> back in and you</font>

354
00:15:55,390 --> 00:16:02,710
<font color="#E5E5E5">get some error and</font><font color="#CCCCCC"> then some UID that</font>

355
00:15:58,360 --> 00:16:05,110
<font color="#CCCCCC">gets back right bless you and then</font>

356
00:16:02,710 --> 00:16:09,090
lastly you<font color="#E5E5E5"> get out of band right so here</font>

357
00:16:05,110 --> 00:16:12,550
<font color="#CCCCCC">we have this Etsy password file</font><font color="#E5E5E5"> that is</font>

358
00:16:09,090 --> 00:16:14,320
sent<font color="#E5E5E5"> using this login form</font><font color="#CCCCCC"> here and then</font>

359
00:16:12,550 --> 00:16:16,719
this<font color="#E5E5E5"> is supposed to represent like a</font>

360
00:16:14,320 --> 00:16:20,140
netcat listener or<font color="#E5E5E5"> terminal of some sort</font>

361
00:16:16,720 --> 00:16:23,290
so here's my<font color="#CCCCCC"> callback and</font><font color="#E5E5E5"> then we get to</font>

362
00:16:20,140 --> 00:16:29,470
the fun stuff<font color="#CCCCCC"> so demo it doulos alright</font>

363
00:16:23,290 --> 00:16:33,610
so I made a small<font color="#CCCCCC"> sacrifice to the UH</font>

364
00:16:29,470 --> 00:16:35,970
you can't see that so I made a small

365
00:16:33,610 --> 00:16:38,560
<font color="#CCCCCC">sacrifice to</font><font color="#E5E5E5"> the demo gods last night</font><font color="#CCCCCC"> so</font>

366
00:16:35,970 --> 00:16:42,690
hopefully this<font color="#E5E5E5"> works if it</font><font color="#CCCCCC"> doesn't work</font>

367
00:16:38,560 --> 00:16:42,689
it's all good because<font color="#E5E5E5"> I recorded this</font>

368
00:16:43,860 --> 00:16:56,230
<font color="#CCCCCC">alright cool so</font><font color="#E5E5E5"> here we're gonna walk</font>

369
00:16:48,640 --> 00:16:57,850
through<font color="#CCCCCC"> doulos real quick so I</font><font color="#E5E5E5"> presented</font>

370
00:16:56,230 --> 00:16:59,920
as<font color="#CCCCCC"> Abbie</font><font color="#E5E5E5"> sighs Augusta and I had like</font>

371
00:16:57,850 --> 00:17:01,450
some super cool font that had like

372
00:16:59,920 --> 00:17:03,250
<font color="#E5E5E5">ghosts and stuff that's why this is</font>

373
00:17:01,450 --> 00:17:05,740
orange<font color="#CCCCCC"> I had like ghosts and stuff</font>

374
00:17:03,250 --> 00:17:09,699
coming<font color="#CCCCCC"> off of this</font><font color="#E5E5E5"> this ASCII art</font>

375
00:17:05,740 --> 00:17:11,620
<font color="#CCCCCC">loves ASCII art right also fun fact</font><font color="#E5E5E5"> I</font>

376
00:17:09,699 --> 00:17:15,189
had a web server<font color="#CCCCCC"> selling</font><font color="#E5E5E5"> over speakers</font>

377
00:17:11,619 --> 00:17:17,919
<font color="#E5E5E5">today I had a web server that I my</font>

378
00:17:15,189 --> 00:17:20,290
original payload was<font color="#E5E5E5"> a dot docx file so</font>

379
00:17:17,920 --> 00:17:22,990
it was<font color="#E5E5E5"> just a Word document</font><font color="#CCCCCC"> and it</font>

380
00:17:20,290 --> 00:17:24,550
worked<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then two</font><font color="#CCCCCC"> months</font><font color="#E5E5E5"> later it</font>

381
00:17:22,990 --> 00:17:27,880
decided<font color="#E5E5E5"> it didn't</font><font color="#CCCCCC"> want to work anymore</font>

382
00:17:24,550 --> 00:17:29,678
<font color="#CCCCCC">and I spent</font><font color="#E5E5E5"> like a week</font><font color="#CCCCCC"> or two</font><font color="#E5E5E5"> trying to</font>

383
00:17:27,880 --> 00:17:30,940
figure this out figure this out and then

384
00:17:29,679 --> 00:17:33,550
I said all<font color="#CCCCCC"> right I got a pivot I gotta</font>

385
00:17:30,940 --> 00:17:35,679
<font color="#E5E5E5">find something else</font><font color="#CCCCCC"> so then me and</font>

386
00:17:33,550 --> 00:17:37,210
Miller came up with<font color="#E5E5E5"> this dot txt file</font>

387
00:17:35,679 --> 00:17:38,920
and then we just threw this in here made

388
00:17:37,210 --> 00:17:41,530
it experimental<font color="#E5E5E5"> because you're still</font>

389
00:17:38,920 --> 00:17:43,660
<font color="#E5E5E5">playing with it</font><font color="#CCCCCC"> I did not so this tool</font>

390
00:17:41,530 --> 00:17:45,639
<font color="#CCCCCC">is on</font><font color="#E5E5E5"> github it's private right now I</font>

391
00:17:43,660 --> 00:17:47,290
forgot to set it to<font color="#CCCCCC"> public so probably</font>

392
00:17:45,640 --> 00:17:50,290
<font color="#E5E5E5">within</font><font color="#CCCCCC"> the next day</font><font color="#E5E5E5"> or two as I traveled</font>

393
00:17:47,290 --> 00:17:52,000
back<font color="#E5E5E5"> to where I'm going</font><font color="#CCCCCC"> all my flight so</font>

394
00:17:50,290 --> 00:17:54,270
I'll make this public<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you guys can</font>

395
00:17:52,000 --> 00:17:56,980
poke<font color="#CCCCCC"> around</font><font color="#E5E5E5"> and look at my terrible code</font>

396
00:17:54,270 --> 00:17:59,260
<font color="#CCCCCC">so anyway</font><font color="#E5E5E5"> so we're gonna create</font><font color="#CCCCCC"> an XML</font>

397
00:17:56,980 --> 00:18:01,600
dot txt payload right so we're<font color="#E5E5E5"> gonna</font>

398
00:17:59,260 --> 00:18:06,010
choose<font color="#CCCCCC"> two and what</font><font color="#E5E5E5"> is the IP of your</font>

399
00:18:01,600 --> 00:18:08,110
server that<font color="#CCCCCC"> is hosting your DTD so I'm</font>

400
00:18:06,010 --> 00:18:12,250
just<font color="#E5E5E5"> going to do a spike on simple HTTP</font>

401
00:18:08,110 --> 00:18:14,229
server on my<font color="#CCCCCC"> local machine so that's the</font>

402
00:18:12,250 --> 00:18:16,030
IP of it what is the listening port of

403
00:18:14,230 --> 00:18:19,330
your server that<font color="#E5E5E5"> is hosting your DTD by</font>

404
00:18:16,030 --> 00:18:21,040
default that<font color="#E5E5E5"> is</font><font color="#CCCCCC"> 8000 what is the IP you</font>

405
00:18:19,330 --> 00:18:25,000
want the<font color="#E5E5E5"> victim's server the callback</font><font color="#CCCCCC"> to</font>

406
00:18:21,040 --> 00:18:27,460
so again<font color="#CCCCCC"> that's gonna be the same</font><font color="#E5E5E5"> IP and</font>

407
00:18:25,000 --> 00:18:30,340
then what does the port 1 through<font color="#E5E5E5"> 37</font>

408
00:18:27,460 --> 00:18:33,790
because we're elite<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so now</font>

409
00:18:30,340 --> 00:18:35,740
we've got<font color="#E5E5E5"> it creates our payload spits</font>

410
00:18:33,790 --> 00:18:38,379
out<font color="#E5E5E5"> where you where it saved and then</font>

411
00:18:35,740 --> 00:18:39,910
same thing<font color="#E5E5E5"> for your DTD file right so</font>

412
00:18:38,380 --> 00:18:44,230
now we're gonna move<font color="#CCCCCC"> to our payloads</font>

413
00:18:39,910 --> 00:18:47,500
folder do an LS and here we're looking

414
00:18:44,230 --> 00:18:52,720
<font color="#CCCCCC">for</font><font color="#E5E5E5"> this actual payload</font><font color="#CCCCCC"> exe which is</font>

415
00:18:47,500 --> 00:18:56,260
right here<font color="#E5E5E5"> awesome no errors right so</font>

416
00:18:52,720 --> 00:19:00,820
now<font color="#CCCCCC"> now we're gonna actually start our</font>

417
00:18:56,260 --> 00:19:03,700
<font color="#E5E5E5">Python simple HTTP server</font><font color="#CCCCCC"> so something</font>

418
00:19:00,820 --> 00:19:04,840
<font color="#E5E5E5">else to</font><font color="#CCCCCC"> note</font><font color="#E5E5E5"> so me and Miller also</font>

419
00:19:03,700 --> 00:19:06,160
decided to<font color="#E5E5E5"> do this</font><font color="#CCCCCC"> to build our</font>

420
00:19:04,840 --> 00:19:08,199
developer chops<font color="#E5E5E5"> back up because I</font>

421
00:19:06,160 --> 00:19:10,510
haven't<font color="#CCCCCC"> coded in a while and he hasn't</font>

422
00:19:08,200 --> 00:19:16,950
coded in<font color="#E5E5E5"> Python and quite some time also</font>

423
00:19:10,510 --> 00:19:19,140
<font color="#E5E5E5">so he wrote it in Python</font><font color="#CCCCCC"> 2.7 and</font><font color="#E5E5E5"> then I</font>

424
00:19:16,950 --> 00:19:21,929
started<font color="#CCCCCC"> playing in Python 3</font>

425
00:19:19,140 --> 00:19:23,880
and we couldn't figure<font color="#E5E5E5"> out why it wasn't</font>

426
00:19:21,929 --> 00:19:26,160
working<font color="#CCCCCC"> for either of</font><font color="#E5E5E5"> us and then after</font>

427
00:19:23,880 --> 00:19:28,470
some finagling<font color="#CCCCCC"> in the python</font>

428
00:19:26,160 --> 00:19:31,380
environments we finally figured<font color="#E5E5E5"> out like</font>

429
00:19:28,470 --> 00:19:33,030
oh you're<font color="#CCCCCC"> using Python</font><font color="#E5E5E5"> to syntax and I'm</font>

430
00:19:31,380 --> 00:19:35,460
trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> run it Python 3 and it's just</font>

431
00:19:33,030 --> 00:19:37,200
<font color="#E5E5E5">not working</font><font color="#CCCCCC"> so I said alright we're</font><font color="#E5E5E5"> at</font>

432
00:19:35,460 --> 00:19:39,240
our<font color="#E5E5E5"> first crossroads what do we do</font><font color="#CCCCCC"> right</font>

433
00:19:37,200 --> 00:19:41,460
<font color="#CCCCCC">do we make it backwards compatible or do</font>

434
00:19:39,240 --> 00:19:43,530
we force people to new<font color="#E5E5E5"> standards</font><font color="#CCCCCC"> we</font>

435
00:19:41,460 --> 00:19:45,090
chose<font color="#E5E5E5"> to do</font><font color="#CCCCCC"> we chose to force people</font><font color="#E5E5E5"> to</font>

436
00:19:43,530 --> 00:19:46,740
new<font color="#E5E5E5"> standards but if you use the Python</font>

437
00:19:45,090 --> 00:19:49,620
<font color="#E5E5E5">environment</font><font color="#CCCCCC"> super simple to switch</font><font color="#E5E5E5"> it</font>

438
00:19:46,740 --> 00:19:52,110
right<font color="#CCCCCC"> so now we have a Python</font><font color="#E5E5E5"> server</font>

439
00:19:49,620 --> 00:19:54,659
<font color="#E5E5E5">that sets</font><font color="#CCCCCC"> up also</font><font color="#E5E5E5"> fun fact when you set</font>

440
00:19:52,110 --> 00:19:56,340
up<font color="#E5E5E5"> your Python server</font><font color="#CCCCCC"> wherever directory</font>

441
00:19:54,660 --> 00:19:57,630
you set that Python server<font color="#E5E5E5"> is now your</font>

442
00:19:56,340 --> 00:20:00,570
root<font color="#E5E5E5"> directories for your web server</font>

443
00:19:57,630 --> 00:20:03,990
<font color="#CCCCCC">didn't know</font><font color="#E5E5E5"> that so found that out which</font>

444
00:20:00,570 --> 00:20:07,260
is super fun<font color="#CCCCCC"> it's like why is</font><font color="#E5E5E5"> they not</font>

445
00:20:03,990 --> 00:20:09,620
finding my DTD<font color="#CCCCCC"> Oh how do I</font><font color="#E5E5E5"> set a direct</font>

446
00:20:07,260 --> 00:20:12,960
route path<font color="#CCCCCC"> oh this is how you can do</font><font color="#E5E5E5"> it</font>

447
00:20:09,620 --> 00:20:16,530
right<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that was</font><font color="#E5E5E5"> fine</font><font color="#CCCCCC"> next we're gonna</font>

448
00:20:12,960 --> 00:20:20,400
set and in an<font color="#CCCCCC"> Inc hat set it to verbose</font>

449
00:20:16,530 --> 00:20:23,910
so show me<font color="#E5E5E5"> everything on the screen</font><font color="#CCCCCC"> set</font>

450
00:20:20,400 --> 00:20:26,309
it<font color="#E5E5E5"> to listen on port 1 3 3 7 awesome so</font>

451
00:20:23,910 --> 00:20:28,169
now<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> in cat listening on port 1 3</font>

452
00:20:26,309 --> 00:20:32,040
3<font color="#E5E5E5"> 7 willing to accept</font><font color="#CCCCCC"> anything that</font>

453
00:20:28,169 --> 00:20:33,690
comes<font color="#E5E5E5"> its way cool we're now</font><font color="#CCCCCC"> staged for</font>

454
00:20:32,040 --> 00:20:38,549
<font color="#E5E5E5">this proof of</font><font color="#CCCCCC"> concept for</font><font color="#E5E5E5"> this attack</font>

455
00:20:33,690 --> 00:20:43,290
<font color="#CCCCCC">right so now let's we're in our payloads</font>

456
00:20:38,549 --> 00:20:46,620
folder so now<font color="#CCCCCC"> we will curl this payload</font>

457
00:20:43,290 --> 00:20:49,590
<font color="#E5E5E5">our curl the payload text to this IP</font>

458
00:20:46,620 --> 00:20:52,260
<font color="#CCCCCC">address right</font><font color="#E5E5E5"> so my machine is gonna</font>

459
00:20:49,590 --> 00:20:54,059
push this file to<font color="#E5E5E5"> the web server for it</font>

460
00:20:52,260 --> 00:21:01,400
to interpret<font color="#CCCCCC"> so what's on the back end</font>

461
00:20:54,059 --> 00:21:05,160
<font color="#E5E5E5">is just an extremely simple PHP XML</font>

462
00:21:01,400 --> 00:21:07,350
parser and it's just waiting<font color="#CCCCCC"> for XML</font><font color="#E5E5E5"> to</font>

463
00:21:05,160 --> 00:21:11,100
get parse<font color="#E5E5E5"> right so now we're gonna run</font>

464
00:21:07,350 --> 00:21:12,990
it<font color="#E5E5E5"> so it's now</font><font color="#CCCCCC"> curl is waiting for a</font>

465
00:21:11,100 --> 00:21:17,699
call for something<font color="#CCCCCC"> to come back right</font>

466
00:21:12,990 --> 00:21:19,260
<font color="#E5E5E5">and it's not gonna get it</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> here</font>

467
00:21:17,700 --> 00:21:20,700
again<font color="#E5E5E5"> is our server so</font><font color="#CCCCCC"> if we</font><font color="#E5E5E5"> got an</font>

468
00:21:19,260 --> 00:21:24,740
<font color="#E5E5E5">Apache went back and look at our Apache</font>

469
00:21:20,700 --> 00:21:28,200
logs or whatever whatever<font color="#E5E5E5"> other web</font>

470
00:21:24,740 --> 00:21:32,300
platform you're using<font color="#CCCCCC"> we see that we get</font>

471
00:21:28,200 --> 00:21:34,160
<font color="#E5E5E5">a get for evil DTD</font><font color="#CCCCCC"> and we get a 200</font>

472
00:21:32,300 --> 00:21:37,490
that's exactly what we wanted<font color="#E5E5E5"> so</font><font color="#CCCCCC"> it</font>

473
00:21:34,160 --> 00:21:39,770
grabbed it<font color="#CCCCCC"> - it grabbed a DTD next you</font>

474
00:21:37,490 --> 00:21:44,860
get<font color="#CCCCCC"> a whole</font><font color="#E5E5E5"> bunch of gibberish</font><font color="#CCCCCC"> and then</font>

475
00:21:39,770 --> 00:21:44,860
we see we now have a call back from

476
00:21:45,160 --> 00:21:54,230
<font color="#E5E5E5">somewhere think it yeah so we get a we</font>

477
00:21:49,670 --> 00:21:56,360
get<font color="#E5E5E5"> a connection from dot 131 on from</font>

478
00:21:54,230 --> 00:21:59,660
port<font color="#CCCCCC"> four</font><font color="#E5E5E5"> seven zero nine eight and then</font>

479
00:21:56,360 --> 00:22:04,250
we get a<font color="#E5E5E5"> base64 encoded string super</font>

480
00:21:59,660 --> 00:22:09,350
<font color="#CCCCCC">awesome</font><font color="#E5E5E5"> so what do I do now</font><font color="#CCCCCC"> well now you</font>

481
00:22:04,250 --> 00:22:11,090
can<font color="#CCCCCC"> go into</font><font color="#E5E5E5"> Python</font><font color="#CCCCCC"> write import</font><font color="#E5E5E5"> base64</font>

482
00:22:09,350 --> 00:22:15,520
right so we're gonna import<font color="#E5E5E5"> the base64</font>

483
00:22:11,090 --> 00:22:21,010
library and then base64 dot<font color="#CCCCCC"> be 64 decode</font>

484
00:22:15,520 --> 00:22:32,750
and now we're gonna decode this base64

485
00:22:21,010 --> 00:22:36,460
<font color="#E5E5E5">stream and now we have the Etsy</font><font color="#CCCCCC"> password</font>

486
00:22:32,750 --> 00:22:38,870
file of this of this machine right so

487
00:22:36,460 --> 00:22:40,610
looking<font color="#CCCCCC"> back now</font><font color="#E5E5E5"> I guess it's important</font>

488
00:22:38,870 --> 00:22:43,159
to note<font color="#CCCCCC"> that our payload</font><font color="#E5E5E5"> was supposed to</font>

489
00:22:40,610 --> 00:22:45,770
grab the Etsy<font color="#E5E5E5"> / password file of this</font>

490
00:22:43,160 --> 00:22:48,230
machine but that's arbitrary that could

491
00:22:45,770 --> 00:22:51,580
be<font color="#CCCCCC"> deci shadow file that could be you</font>

492
00:22:48,230 --> 00:22:56,480
<font color="#CCCCCC">know</font><font color="#E5E5E5"> it really any file that</font><font color="#CCCCCC"> you wanted</font>

493
00:22:51,580 --> 00:23:01,550
<font color="#CCCCCC">so with that proof of concept works this</font>

494
00:22:56,480 --> 00:23:05,750
parser is vulnerable to<font color="#E5E5E5"> xxe right so now</font>

495
00:23:01,550 --> 00:23:07,460
let's go back<font color="#CCCCCC"> to our talk alright so we</font>

496
00:23:05,750 --> 00:23:10,040
<font color="#E5E5E5">just demonstrated this tool that</font><font color="#CCCCCC"> does</font>

497
00:23:07,460 --> 00:23:13,309
this thing that will be public later<font color="#CCCCCC"> and</font>

498
00:23:10,040 --> 00:23:14,990
it now<font color="#E5E5E5"> you know rains from the heavens</font>

499
00:23:13,309 --> 00:23:17,059
everybody's high-fiving each<font color="#E5E5E5"> other</font><font color="#CCCCCC"> right</font>

500
00:23:14,990 --> 00:23:20,390
red team<font color="#CCCCCC"> did their</font><font color="#E5E5E5"> job</font><font color="#CCCCCC"> offensive</font>

501
00:23:17,059 --> 00:23:23,360
security<font color="#E5E5E5"> is cool</font><font color="#CCCCCC"> so what does this mean</font>

502
00:23:20,390 --> 00:23:27,530
for your for your defenders right well

503
00:23:23,360 --> 00:23:30,290
in with this defense that you're about

504
00:23:27,530 --> 00:23:32,600
to<font color="#CCCCCC"> see comes limitations of this exploit</font>

505
00:23:30,290 --> 00:23:34,070
just with any<font color="#CCCCCC"> other type of exploit it</font>

506
00:23:32,600 --> 00:23:36,980
always has<font color="#CCCCCC"> its</font><font color="#E5E5E5"> weakness its Achilles</font>

507
00:23:34,070 --> 00:23:38,240
heels<font color="#E5E5E5"> so XML parsers can break if</font><font color="#CCCCCC"> they</font>

508
00:23:36,980 --> 00:23:41,540
don't understand the characters they

509
00:23:38,240 --> 00:23:45,430
encounter<font color="#CCCCCC"> in your XML / DTD files</font><font color="#E5E5E5"> right</font>

510
00:23:41,540 --> 00:23:48,129
so in<font color="#E5E5E5"> developing the</font>

511
00:23:45,430 --> 00:23:50,950
perfect payload to craft for<font color="#CCCCCC"> this tool</font>

512
00:23:48,130 --> 00:23:53,950
<font color="#E5E5E5">it's why is my payload not being crafted</font>

513
00:23:50,950 --> 00:23:56,740
like why<font color="#E5E5E5"> why is my exploit not working</font>

514
00:23:53,950 --> 00:24:00,160
right<font color="#CCCCCC"> and it goes</font><font color="#E5E5E5"> through trial and</font>

515
00:23:56,740 --> 00:24:03,430
error<font color="#CCCCCC"> of perfecting you know your actual</font>

516
00:24:00,160 --> 00:24:05,410
<font color="#E5E5E5">payload stuff right</font><font color="#CCCCCC"> so that code that</font>

517
00:24:03,430 --> 00:24:08,290
you're<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> putting in there so see</font>

518
00:24:05,410 --> 00:24:12,220
data is another<font color="#E5E5E5"> way is similar to the PC</font>

519
00:24:08,290 --> 00:24:14,320
data<font color="#E5E5E5"> but it just says if I have</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> I</font>

520
00:24:12,220 --> 00:24:17,200
wanted to<font color="#E5E5E5"> grab a file that had</font>

521
00:24:14,320 --> 00:24:19,899
characters in<font color="#E5E5E5"> it that could not be</font><font color="#CCCCCC"> parse</font>

522
00:24:17,200 --> 00:24:22,660
<font color="#E5E5E5">through HTTP whether they be escape</font>

523
00:24:19,900 --> 00:24:26,380
characters or<font color="#E5E5E5"> something</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> and I</font>

524
00:24:22,660 --> 00:24:27,550
only get partial or nothing because HTTP

525
00:24:26,380 --> 00:24:28,750
is just like I don't<font color="#E5E5E5"> know how to handle</font>

526
00:24:27,550 --> 00:24:31,930
this so I'm<font color="#E5E5E5"> just going to toss it to the</font>

527
00:24:28,750 --> 00:24:34,570
side<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> what can you do well you</font>

528
00:24:31,930 --> 00:24:36,400
<font color="#CCCCCC">can get a little square</font><font color="#E5E5E5"> a little</font>

529
00:24:34,570 --> 00:24:39,639
creativity and innovation comes in and

530
00:24:36,400 --> 00:24:41,860
you can say well I want<font color="#E5E5E5"> you to craft</font><font color="#CCCCCC"> I</font>

531
00:24:39,640 --> 00:24:46,030
want you to start this<font color="#CCCCCC"> seed data right</font>

532
00:24:41,860 --> 00:24:49,590
<font color="#CCCCCC">with start and then end it there and</font>

533
00:24:46,030 --> 00:24:52,240
then or create another<font color="#E5E5E5"> entity called end</font>

534
00:24:49,590 --> 00:24:54,970
<font color="#E5E5E5">and then another one that has all and</font>

535
00:24:52,240 --> 00:24:59,920
then within<font color="#E5E5E5"> all include this right here</font>

536
00:24:54,970 --> 00:25:01,120
right<font color="#CCCCCC"> so now I have now this is exactly</font>

537
00:24:59,920 --> 00:25:03,780
<font color="#CCCCCC">what it will</font><font color="#E5E5E5"> look like</font>

538
00:25:01,120 --> 00:25:07,870
right so<font color="#CCCCCC"> xml knows c data is just</font>

539
00:25:03,780 --> 00:25:12,639
<font color="#E5E5E5">execute this right here so file</font><font color="#CCCCCC"> st /s s</font>

540
00:25:07,870 --> 00:25:15,280
<font color="#CCCCCC">tab and then parse it down here so put</font>

541
00:25:12,640 --> 00:25:18,340
<font color="#E5E5E5">all of this together right it's not as</font>

542
00:25:15,280 --> 00:25:22,060
clean as what<font color="#E5E5E5"> i did before but it it's</font>

543
00:25:18,340 --> 00:25:23,740
it is a way to to manipulate your<font color="#E5E5E5"> xml</font>

544
00:25:22,060 --> 00:25:29,409
parser to give you what it is<font color="#E5E5E5"> that</font>

545
00:25:23,740 --> 00:25:31,390
<font color="#CCCCCC">you're looking for</font><font color="#E5E5E5"> right next you know</font>

546
00:25:29,410 --> 00:25:32,470
again<font color="#E5E5E5"> XML parsers can break if</font><font color="#CCCCCC"> they</font>

547
00:25:31,390 --> 00:25:35,700
don't understand characters they

548
00:25:32,470 --> 00:25:38,470
encounter and your files<font color="#E5E5E5"> if it's a</font><font color="#CCCCCC"> PHP</font>

549
00:25:35,700 --> 00:25:40,540
based web application you<font color="#E5E5E5"> can base 64</font>

550
00:25:38,470 --> 00:25:42,820
encoded which is how<font color="#E5E5E5"> I was</font><font color="#CCCCCC"> able to</font><font color="#E5E5E5"> get</font>

551
00:25:40,540 --> 00:25:45,580
<font color="#E5E5E5">that C /</font><font color="#CCCCCC"> password file especially with</font>

552
00:25:42,820 --> 00:25:48,250
the slashes the<font color="#E5E5E5"> back or backwards or</font>

553
00:25:45,580 --> 00:25:51,129
forward slashes<font color="#E5E5E5"> one of the slashes</font><font color="#CCCCCC"> to</font>

554
00:25:48,250 --> 00:25:56,410
get through<font color="#CCCCCC"> right you got the example in</font>

555
00:25:51,130 --> 00:25:59,350
the demo so now how do we<font color="#E5E5E5"> detect slash</font>

556
00:25:56,410 --> 00:26:02,710
<font color="#CCCCCC">prevent so in talking</font><font color="#E5E5E5"> to a lot</font>

557
00:25:59,350 --> 00:26:06,370
blue teamers<font color="#E5E5E5"> and and just in my</font><font color="#CCCCCC"> own</font>

558
00:26:02,710 --> 00:26:11,830
experience I've I've kind of gotten more

559
00:26:06,370 --> 00:26:13,719
from let's keep the bad guys<font color="#E5E5E5"> now to a</font>

560
00:26:11,830 --> 00:26:16,539
mindset<font color="#CCCCCC"> of keep the bad guys out too</font>

561
00:26:13,720 --> 00:26:20,590
detecting<font color="#E5E5E5"> detecting bad guys are in</font>

562
00:26:16,539 --> 00:26:23,770
malicious users or whatever<font color="#CCCCCC"> and with</font>

563
00:26:20,590 --> 00:26:28,570
that<font color="#CCCCCC"> I've I've thought about it and</font><font color="#E5E5E5"> I</font>

564
00:26:23,770 --> 00:26:30,940
was like well adversaries have something

565
00:26:28,570 --> 00:26:34,090
that traditional people and just

566
00:26:30,940 --> 00:26:37,120
generally everybody<font color="#CCCCCC"> don't have we they</font>

567
00:26:34,090 --> 00:26:40,059
have more time<font color="#E5E5E5"> they have more</font><font color="#CCCCCC"> energy and</font>

568
00:26:37,120 --> 00:26:42,340
<font color="#CCCCCC">they have more</font><font color="#E5E5E5"> resources</font><font color="#CCCCCC"> so I for one am</font>

569
00:26:40,059 --> 00:26:45,190
<font color="#CCCCCC">juggling</font><font color="#E5E5E5"> like six or</font><font color="#CCCCCC"> seven</font><font color="#E5E5E5"> different</font>

570
00:26:42,340 --> 00:26:46,840
projects<font color="#E5E5E5"> right now</font><font color="#CCCCCC"> and whereas this</font>

571
00:26:45,190 --> 00:26:50,020
adversary might only have one project

572
00:26:46,840 --> 00:26:54,908
<font color="#E5E5E5">and it's me right so whereas they can</font>

573
00:26:50,020 --> 00:26:57,250
dedicate 12 16 hours<font color="#CCCCCC"> a day to why one of</font>

574
00:26:54,909 --> 00:27:00,370
<font color="#E5E5E5">my projects</font><font color="#CCCCCC"> I can only dedicate maybe 45</font>

575
00:26:57,250 --> 00:27:03,100
<font color="#CCCCCC">minutes a day so again they have energy</font>

576
00:27:00,370 --> 00:27:05,979
<font color="#E5E5E5">time and resources</font><font color="#CCCCCC"> that I don't have</font><font color="#E5E5E5"> so</font>

577
00:27:03,100 --> 00:27:09,100
with that being said I'm focusing more

578
00:27:05,980 --> 00:27:11,470
<font color="#E5E5E5">on prevention how can we our excuse me</font>

579
00:27:09,100 --> 00:27:13,840
detection so how can<font color="#CCCCCC"> I detect</font><font color="#E5E5E5"> right so</font>

580
00:27:11,470 --> 00:27:15,100
everybody's heard the stat<font color="#CCCCCC"> you know</font>

581
00:27:13,840 --> 00:27:17,439
adversaries are typically<font color="#E5E5E5"> in</font><font color="#CCCCCC"> your</font>

582
00:27:15,100 --> 00:27:19,990
network<font color="#CCCCCC"> two hundred plus</font><font color="#E5E5E5"> days right</font>

583
00:27:17,440 --> 00:27:22,990
before being being detected<font color="#CCCCCC"> well how do</font>

584
00:27:19,990 --> 00:27:27,490
I<font color="#CCCCCC"> get that</font><font color="#E5E5E5"> number down from 200 plus</font><font color="#CCCCCC"> to</font>

585
00:27:22,990 --> 00:27:30,429
<font color="#CCCCCC">90 to</font><font color="#E5E5E5"> thirty to thirty minutes</font>

586
00:27:27,490 --> 00:27:32,950
right so how can<font color="#CCCCCC"> i how can I get</font><font color="#E5E5E5"> such a</font>

587
00:27:30,429 --> 00:27:37,090
<font color="#E5E5E5">well-oiled machine</font><font color="#CCCCCC"> that is my network</font><font color="#E5E5E5"> in</font>

588
00:27:32,950 --> 00:27:39,940
my applications and my stuff<font color="#CCCCCC"> down</font><font color="#E5E5E5"> to</font>

589
00:27:37,090 --> 00:27:42,070
that level<font color="#E5E5E5"> well for this particular</font><font color="#CCCCCC"> case</font>

590
00:27:39,940 --> 00:27:43,690
in<font color="#CCCCCC"> xxe the first thing you</font><font color="#E5E5E5"> can do is</font>

591
00:27:42,070 --> 00:27:46,418
disable the use<font color="#CCCCCC"> of external</font><font color="#E5E5E5"> entities</font>

592
00:27:43,690 --> 00:27:49,600
right<font color="#CCCCCC"> if you're developing custom made</font>

593
00:27:46,419 --> 00:27:51,640
<font color="#E5E5E5">XML applications</font><font color="#CCCCCC"> or custom applications</font>

594
00:27:49,600 --> 00:27:54,490
that utilize XML to transport<font color="#E5E5E5"> data so</font>

595
00:27:51,640 --> 00:27:56,590
they could<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> to one another</font><font color="#E5E5E5"> I really</font>

596
00:27:54,490 --> 00:27:58,600
<font color="#E5E5E5">don't see a need for you to have</font>

597
00:27:56,590 --> 00:28:01,658
external<font color="#E5E5E5"> entities hosted on someone's</font>

598
00:27:58,600 --> 00:28:03,820
github page right<font color="#CCCCCC"> you know take that</font>

599
00:28:01,659 --> 00:28:06,460
little<font color="#E5E5E5"> due diligence and just say well</font>

600
00:28:03,820 --> 00:28:11,139
if I have<font color="#CCCCCC"> to use external</font><font color="#E5E5E5"> then make it</font>

601
00:28:06,460 --> 00:28:12,340
internal right<font color="#E5E5E5"> the the next one</font><font color="#CCCCCC"> is</font>

602
00:28:11,140 --> 00:28:16,750
verified at the<font color="#E5E5E5"> XML</font>

603
00:28:12,340 --> 00:28:18,159
<font color="#CCCCCC">or the XSL which is file upload</font>

604
00:28:16,750 --> 00:28:20,980
functionality so if you do have a file

605
00:28:18,160 --> 00:28:24,940
upload function<font color="#CCCCCC"> Allen your web app is is</font>

606
00:28:20,980 --> 00:28:27,880
income it uses it validates the incoming

607
00:28:24,940 --> 00:28:31,240
accent XML with XML schema definition

608
00:28:27,880 --> 00:28:33,280
<font color="#E5E5E5">right so your watch what your</font>

609
00:28:31,240 --> 00:28:36,460
application is expecting to<font color="#CCCCCC"> receive is</font>

610
00:28:33,280 --> 00:28:39,970
actually what it's receiving<font color="#E5E5E5"> so that's a</font>

611
00:28:36,460 --> 00:28:43,540
you<font color="#CCCCCC"> know</font><font color="#E5E5E5"> that's just an XML way of input</font>

612
00:28:39,970 --> 00:28:45,340
validation<font color="#CCCCCC"> right and in last patching</font>

613
00:28:43,540 --> 00:28:50,020
upgrade<font color="#E5E5E5"> your XML parsers using one of</font>

614
00:28:45,340 --> 00:28:52,360
<font color="#E5E5E5">the</font><font color="#CCCCCC"> underlying or in</font><font color="#E5E5E5"> underlying OS</font><font color="#CCCCCC"> with</font>

615
00:28:50,020 --> 00:28:53,139
the<font color="#E5E5E5"> latest version of</font><font color="#CCCCCC"> PHP five if</font><font color="#E5E5E5"> you</font>

616
00:28:52,360 --> 00:28:55,449
can support<font color="#CCCCCC"> it</font>

617
00:28:53,140 --> 00:28:58,930
go to PHP<font color="#E5E5E5"> seven if you tested it</font><font color="#CCCCCC"> within</font>

618
00:28:55,450 --> 00:29:03,100
<font color="#E5E5E5">your web apps</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> Oh boss has a super</font>

619
00:28:58,930 --> 00:29:06,190
awesome<font color="#E5E5E5"> list that continues to grow</font><font color="#CCCCCC"> on</font>

620
00:29:03,100 --> 00:29:08,860
how<font color="#E5E5E5"> to defend against xxe in a wide</font>

621
00:29:06,190 --> 00:29:13,930
range<font color="#CCCCCC"> of applications Java PHP there's</font>

622
00:29:08,860 --> 00:29:15,520
even iOS that<font color="#CCCCCC"> Olas is covered right so</font>

623
00:29:13,930 --> 00:29:16,690
now for the blue teamers and for the red

624
00:29:15,520 --> 00:29:17,980
teamers in<font color="#CCCCCC"> the room to kind</font><font color="#E5E5E5"> of get a</font>

625
00:29:16,690 --> 00:29:20,650
general<font color="#CCCCCC"> a</font><font color="#E5E5E5"> little bit better</font>

626
00:29:17,980 --> 00:29:23,070
understanding<font color="#CCCCCC"> in what you're defenders</font>

627
00:29:20,650 --> 00:29:25,690
are actually doing<font color="#E5E5E5"> and thinking about</font>

628
00:29:23,070 --> 00:29:28,929
how about<font color="#E5E5E5"> any content type header is</font>

629
00:29:25,690 --> 00:29:30,880
coming across<font color="#E5E5E5"> text or XML or application</font>

630
00:29:28,930 --> 00:29:33,640
XML when they should<font color="#E5E5E5"> be JSON right so</font>

631
00:29:30,880 --> 00:29:36,520
typically what<font color="#CCCCCC"> I've found in my research</font>

632
00:29:33,640 --> 00:29:39,160
<font color="#E5E5E5">and just talking</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> reading other</font>

633
00:29:36,520 --> 00:29:43,210
people's work is that a way<font color="#E5E5E5"> of getting</font>

634
00:29:39,160 --> 00:29:46,090
<font color="#CCCCCC">around</font><font color="#E5E5E5"> are exploiting these web apps as</font>

635
00:29:43,210 --> 00:29:48,100
if they're accepting JSON right so it's

636
00:29:46,090 --> 00:29:51,959
super simple<font color="#CCCCCC"> just to change the header</font>

637
00:29:48,100 --> 00:29:56,620
information<font color="#E5E5E5"> and see if it accepts XML</font>

638
00:29:51,960 --> 00:29:58,270
<font color="#E5E5E5">most of the time it does any outbound</font>

639
00:29:56,620 --> 00:29:59,530
requests<font color="#E5E5E5"> from your web server web app</font>

640
00:29:58,270 --> 00:30:02,860
<font color="#CCCCCC">that you shouldn't write so that's a</font>

641
00:29:59,530 --> 00:30:05,530
<font color="#E5E5E5">kind of a self-explanatory one</font><font color="#CCCCCC"> if like</font>

642
00:30:02,860 --> 00:30:08,889
why is<font color="#E5E5E5"> my web server talking to IP</font>

643
00:30:05,530 --> 00:30:13,450
address directly<font color="#E5E5E5"> like you know</font>

644
00:30:08,890 --> 00:30:18,010
<font color="#E5E5E5">hard-coded IP address or you know a</font>

645
00:30:13,450 --> 00:30:21,760
random random<font color="#E5E5E5"> domain name right so my</font>

646
00:30:18,010 --> 00:30:23,710
web server<font color="#E5E5E5"> should only be used for file</font>

647
00:30:21,760 --> 00:30:24,960
uploading it should not be talking<font color="#E5E5E5"> to</font>

648
00:30:23,710 --> 00:30:28,440
<font color="#E5E5E5">anything outside</font>

649
00:30:24,960 --> 00:30:30,510
internal network right<font color="#CCCCCC"> is there any use</font>

650
00:30:28,440 --> 00:30:33,390
of<font color="#CCCCCC"> basic c4 in your environment right</font><font color="#E5E5E5"> so</font>

651
00:30:30,510 --> 00:30:37,890
this one can kind of vary so<font color="#E5E5E5"> working as</font>

652
00:30:33,390 --> 00:30:41,039
a sake analyst<font color="#E5E5E5"> I saw</font><font color="#CCCCCC"> we would see basic</font>

653
00:30:37,890 --> 00:30:43,830
c4 stuff come across right instantly and

654
00:30:41,039 --> 00:30:45,870
one of our<font color="#E5E5E5"> rule set to a flag</font><font color="#CCCCCC"> I go</font>

655
00:30:43,830 --> 00:30:48,840
investigate<font color="#CCCCCC"> decode it it's a PowerShell</font>

656
00:30:45,870 --> 00:30:51,120
<font color="#E5E5E5">script to upload a remote server</font>

657
00:30:48,840 --> 00:30:53,340
somewhere<font color="#E5E5E5"> right and they're just like</font>

658
00:30:51,120 --> 00:30:55,949
straight pure go out to<font color="#E5E5E5"> windows and</font>

659
00:30:53,340 --> 00:30:58,168
update yourself<font color="#E5E5E5"> right and it's like why</font>

660
00:30:55,950 --> 00:31:00,720
are<font color="#E5E5E5"> you why are</font><font color="#CCCCCC"> you the administrator</font>

661
00:30:58,169 --> 00:31:04,380
<font color="#E5E5E5">like</font><font color="#CCCCCC"> basic C for encoding your updates</font>

662
00:31:00,720 --> 00:31:08,460
<font color="#E5E5E5">you know just go out right I you know</font>

663
00:31:04,380 --> 00:31:09,899
that's a little<font color="#E5E5E5"> suspicious</font><font color="#CCCCCC"> and then is</font>

664
00:31:08,460 --> 00:31:12,480
your parser accessing directories and

665
00:31:09,899 --> 00:31:16,379
files that it shouldn't<font color="#CCCCCC"> right so if you</font>

666
00:31:12,480 --> 00:31:17,940
<font color="#E5E5E5">don't limit</font><font color="#CCCCCC"> why is your web server that</font>

667
00:31:16,380 --> 00:31:20,100
<font color="#E5E5E5">doesn't have any login authentication</font>

668
00:31:17,940 --> 00:31:23,370
whatsoever there's nothing to<font color="#E5E5E5"> login to</font>

669
00:31:20,100 --> 00:31:25,439
there's no portal<font color="#E5E5E5"> why is it accessing</font>

670
00:31:23,370 --> 00:31:27,840
the<font color="#E5E5E5"> Etsy password file right or why is</font>

671
00:31:25,440 --> 00:31:29,730
it accessing areas of your<font color="#CCCCCC"> own server</font>

672
00:31:27,840 --> 00:31:31,740
that<font color="#E5E5E5"> you shouldn't really be paying</font>

673
00:31:29,730 --> 00:31:33,360
attention<font color="#E5E5E5"> to or I shouldn't even be</font>

674
00:31:31,740 --> 00:31:36,570
touching<font color="#E5E5E5"> excuse me not paying</font><font color="#CCCCCC"> attention</font>

675
00:31:33,360 --> 00:31:39,120
<font color="#E5E5E5">to you that's bad</font><font color="#CCCCCC"> language you know like</font>

676
00:31:36,570 --> 00:31:41,309
the root directory<font color="#CCCCCC"> why's</font><font color="#E5E5E5"> your web server</font>

677
00:31:39,120 --> 00:31:46,350
going<font color="#E5E5E5"> to the server directory not the</font>

678
00:31:41,309 --> 00:31:49,289
web<font color="#E5E5E5"> root directory</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so with</font>

679
00:31:46,350 --> 00:31:50,730
that in<font color="#CCCCCC"> mind let's move into</font><font color="#E5E5E5"> the red</font>

680
00:31:49,289 --> 00:31:51,929
blue<font color="#CCCCCC"> and purple teams and how they</font><font color="#E5E5E5"> can</font>

681
00:31:50,730 --> 00:31:55,049
<font color="#E5E5E5">actually use</font><font color="#CCCCCC"> it so we</font><font color="#E5E5E5"> kind of just</font>

682
00:31:51,929 --> 00:31:58,230
covered the red<font color="#CCCCCC"> team's</font><font color="#E5E5E5"> and we cover the</font>

683
00:31:55,049 --> 00:31:59,789
blue<font color="#CCCCCC"> teams so there's not</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font>

684
00:31:58,230 --> 00:32:01,950
offensive security<font color="#CCCCCC"> people</font><font color="#E5E5E5"> in this talk</font>

685
00:31:59,789 --> 00:32:05,279
and<font color="#E5E5E5"> that's because it's not really sexy</font>

686
00:32:01,950 --> 00:32:07,080
<font color="#CCCCCC">alright xxe is not a you know</font><font color="#E5E5E5"> it's not</font>

687
00:32:05,279 --> 00:32:09,870
going to get<font color="#E5E5E5"> me root it's not gonna get</font>

688
00:32:07,080 --> 00:32:11,820
me<font color="#CCCCCC"> shell immediately it's not gonna you</font>

689
00:32:09,870 --> 00:32:15,149
<font color="#CCCCCC">know</font><font color="#E5E5E5"> it's not gonna give me that</font><font color="#CCCCCC"> rcee</font>

690
00:32:11,820 --> 00:32:17,460
you're not<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> see you know in today's</font>

691
00:32:15,149 --> 00:32:20,459
age it's been around for you know<font color="#CCCCCC"> at</font>

692
00:32:17,460 --> 00:32:22,890
least a decade now this exploit<font color="#CCCCCC"> you're</font>

693
00:32:20,460 --> 00:32:24,690
not gonna see you know<font color="#E5E5E5"> fifty thousand</font>

694
00:32:22,890 --> 00:32:26,820
<font color="#E5E5E5">dollar bug bounties go out for this type</font>

695
00:32:24,690 --> 00:32:29,850
<font color="#CCCCCC">of deal right but there are some pretty</font>

696
00:32:26,820 --> 00:32:33,330
<font color="#E5E5E5">cool research to has been done to show</font>

697
00:32:29,850 --> 00:32:36,399
that<font color="#CCCCCC"> this</font><font color="#E5E5E5"> can be done</font><font color="#CCCCCC"> this exploit can</font>

698
00:32:33,330 --> 00:32:38,949
be used<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know route more</font>

699
00:32:36,400 --> 00:32:41,440
in one way of just like give me a shadow

700
00:32:38,950 --> 00:32:45,150
file<font color="#CCCCCC"> give me a password</font><font color="#E5E5E5"> file this it can</font>

701
00:32:41,440 --> 00:32:47,410
<font color="#E5E5E5">be used more for you know like</font>

702
00:32:45,150 --> 00:32:50,710
enumerated an internal network that you

703
00:32:47,410 --> 00:32:53,050
otherwise can't<font color="#E5E5E5"> write it could be a you</font>

704
00:32:50,710 --> 00:32:55,360
might<font color="#E5E5E5"> have to send a lot of XML files to</font>

705
00:32:53,050 --> 00:32:58,710
this thing for the<font color="#E5E5E5"> parse and execute and</font>

706
00:32:55,360 --> 00:33:03,310
such<font color="#CCCCCC"> but</font><font color="#E5E5E5"> you I think you'll be surprised</font>

707
00:32:58,710 --> 00:33:05,200
<font color="#CCCCCC">you know the</font><font color="#E5E5E5"> the what you can do with</font>

708
00:33:03,310 --> 00:33:08,560
this<font color="#E5E5E5"> and utilizing this really is more</font>

709
00:33:05,200 --> 00:33:10,480
<font color="#E5E5E5">about</font><font color="#CCCCCC"> your imagination</font><font color="#E5E5E5"> right so through</font>

710
00:33:08,560 --> 00:33:12,700
the red team's eyes this can be used in

711
00:33:10,480 --> 00:33:15,820
an adversarial engagement commutes for

712
00:33:12,700 --> 00:33:18,280
intelligence gathering<font color="#E5E5E5"> obviously</font><font color="#CCCCCC"> it can</font>

713
00:33:15,820 --> 00:33:19,570
be used<font color="#E5E5E5"> for threat modeling right so if</font>

714
00:33:18,280 --> 00:33:21,760
you're dealing<font color="#CCCCCC"> with a web app why not</font>

715
00:33:19,570 --> 00:33:24,820
<font color="#E5E5E5">throw this on your threat</font><font color="#CCCCCC"> model and see</font>

716
00:33:21,760 --> 00:33:28,300
if it's excellent<font color="#E5E5E5"> you know applicable</font>

717
00:33:24,820 --> 00:33:30,250
<font color="#E5E5E5">right</font><font color="#CCCCCC"> vulnerability analysis is kind</font><font color="#E5E5E5"> of</font>

718
00:33:28,300 --> 00:33:31,930
the same thing and in exploitation and

719
00:33:30,250 --> 00:33:34,450
<font color="#CCCCCC">employs post exploitation right so it</font>

720
00:33:31,930 --> 00:33:36,460
can be used in<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of these manners that</font>

721
00:33:34,450 --> 00:33:39,220
we've already previously<font color="#E5E5E5"> discussed again</font>

722
00:33:36,460 --> 00:33:42,250
less likely to fine<font color="#CCCCCC"> our</font><font color="#E5E5E5"> see it's more</font>

723
00:33:39,220 --> 00:33:43,960
for<font color="#E5E5E5"> it's more mostly used</font><font color="#CCCCCC"> for file</font>

724
00:33:42,250 --> 00:33:46,270
inclusion and pivoting to other systems

725
00:33:43,960 --> 00:33:49,210
right so I'm able to<font color="#E5E5E5"> get in</font><font color="#CCCCCC"> through web</font>

726
00:33:46,270 --> 00:33:52,450
server this way and then I'm gonna move

727
00:33:49,210 --> 00:33:54,490
<font color="#E5E5E5">to your database server what either</font>

728
00:33:52,450 --> 00:33:57,970
<font color="#CCCCCC">weather whatever else is your target</font>

729
00:33:54,490 --> 00:34:00,460
<font color="#CCCCCC">right it's more</font><font color="#E5E5E5"> of a way in and a lay of</font>

730
00:33:57,970 --> 00:34:02,980
the land<font color="#CCCCCC"> right so it's kind of</font><font color="#E5E5E5"> a passing</font>

731
00:34:00,460 --> 00:34:04,690
through you're limited in options for

732
00:34:02,980 --> 00:34:07,420
<font color="#E5E5E5">exploiting webmaster</font><font color="#CCCCCC"> xic</font><font color="#E5E5E5"> given the</font>

733
00:34:04,690 --> 00:34:09,580
protocols<font color="#E5E5E5"> that you're using</font><font color="#CCCCCC"> there are</font>

734
00:34:07,420 --> 00:34:13,000
other ways<font color="#E5E5E5"> you</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> need creativity</font>

735
00:34:09,580 --> 00:34:16,810
right innovation<font color="#CCCCCC"> so this is where you</font>

736
00:34:13,000 --> 00:34:20,380
<font color="#E5E5E5">get to put your fun hat on and</font><font color="#CCCCCC"> say hmm I</font>

737
00:34:16,810 --> 00:34:21,820
wonder what<font color="#E5E5E5"> else I</font><font color="#CCCCCC"> can do right so again</font>

738
00:34:20,380 --> 00:34:23,980
<font color="#E5E5E5">let's talk about more about the blue</font>

739
00:34:21,820 --> 00:34:25,240
team's<font color="#CCCCCC"> eyes right so 200 days how do we</font>

740
00:34:23,980 --> 00:34:27,969
get it<font color="#E5E5E5"> down</font>

741
00:34:25,239 --> 00:34:30,639
well we can<font color="#CCCCCC"> use the loop of course so</font>

742
00:34:27,969 --> 00:34:33,428
<font color="#E5E5E5">observe orient make a decision in an act</font>

743
00:34:30,639 --> 00:34:35,139
so<font color="#E5E5E5"> acting</font><font color="#CCCCCC"> is important but</font><font color="#E5E5E5"> only if you</font>

744
00:34:33,429 --> 00:34:36,760
do<font color="#E5E5E5"> it in the right way right so</font>

745
00:34:35,139 --> 00:34:37,810
<font color="#CCCCCC">sometimes</font><font color="#E5E5E5"> you obviously don't</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to</font>

746
00:34:36,760 --> 00:34:40,210
kick people<font color="#E5E5E5"> out of your</font><font color="#CCCCCC"> network</font>

747
00:34:37,810 --> 00:34:41,409
immediately<font color="#CCCCCC"> cuz and you'll</font><font color="#E5E5E5"> never really</font>

748
00:34:40,210 --> 00:34:43,449
<font color="#E5E5E5">know what their true intentions or</font>

749
00:34:41,409 --> 00:34:44,919
<font color="#CCCCCC">alright so I recently just finished</font>

750
00:34:43,449 --> 00:34:46,330
<font color="#E5E5E5">reading a book called</font><font color="#CCCCCC"> the Cuckoo's egg</font>

751
00:34:44,918 --> 00:34:48,668
and if you never read it's by cliff

752
00:34:46,330 --> 00:34:49,840
Stoll<font color="#E5E5E5"> I highly recommend that</font><font color="#CCCCCC"> you guys</font>

753
00:34:48,668 --> 00:34:52,150
take a look<font color="#E5E5E5"> at it</font>

754
00:34:49,840 --> 00:34:54,010
and check it out<font color="#E5E5E5"> it's a</font><font color="#CCCCCC"> pretty simple</font>

755
00:34:52,150 --> 00:34:57,370
read it doesn't go way down in the<font color="#E5E5E5"> weeds</font>

756
00:34:54,010 --> 00:35:01,270
<font color="#CCCCCC">is</font><font color="#E5E5E5"> an astronomer</font><font color="#CCCCCC"> that wrote this book</font>

757
00:34:57,370 --> 00:35:03,339
right so<font color="#CCCCCC"> it's it's pretty good and</font>

758
00:35:01,270 --> 00:35:05,470
there's even I found surprising today

759
00:35:03,340 --> 00:35:07,030
that it's even<font color="#E5E5E5"> applicable</font><font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the</font>

760
00:35:05,470 --> 00:35:10,270
<font color="#E5E5E5">lessons learned in this book and how</font>

761
00:35:07,030 --> 00:35:12,910
much it applies today<font color="#E5E5E5"> from good taking</font>

762
00:35:10,270 --> 00:35:17,140
good documents<font color="#CCCCCC"> chain-of-custody and your</font>

763
00:35:12,910 --> 00:35:18,430
logs and such<font color="#CCCCCC"> you know just really an</font>

764
00:35:17,140 --> 00:35:19,810
understanding<font color="#CCCCCC"> of how the</font><font color="#E5E5E5"> federal</font>

765
00:35:18,430 --> 00:35:22,540
government works in the various<font color="#CCCCCC"> agencies</font>

766
00:35:19,810 --> 00:35:25,450
<font color="#E5E5E5">and how they still today don't work as</font>

767
00:35:22,540 --> 00:35:27,880
well<font color="#CCCCCC"> as they could together so I</font>

768
00:35:25,450 --> 00:35:33,029
<font color="#E5E5E5">encourage</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> but getting back to this</font>

769
00:35:27,880 --> 00:35:37,090
<font color="#E5E5E5">so you see here that we were using</font>

770
00:35:33,030 --> 00:35:40,390
base64 to encode our results back from

771
00:35:37,090 --> 00:35:42,880
<font color="#E5E5E5">this web server</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so ways that we</font>

772
00:35:40,390 --> 00:35:45,609
can you also saw that<font color="#E5E5E5"> if I saw</font><font color="#CCCCCC"> that in</font>

773
00:35:42,880 --> 00:35:47,050
the<font color="#CCCCCC"> clear I can just snatch that</font><font color="#E5E5E5"> decode</font>

774
00:35:45,610 --> 00:35:49,780
it myself and say oh I know what they

775
00:35:47,050 --> 00:35:53,980
got<font color="#CCCCCC"> I now know where to go</font><font color="#E5E5E5"> but what if I</font>

776
00:35:49,780 --> 00:35:56,740
were to<font color="#E5E5E5"> encode</font><font color="#CCCCCC"> that 64 then encode that</font>

777
00:35:53,980 --> 00:35:59,770
64 and then<font color="#E5E5E5"> encode that 64 then encode</font>

778
00:35:56,740 --> 00:36:01,509
<font color="#E5E5E5">that one right</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> research shows</font>

779
00:35:59,770 --> 00:36:04,600
that the<font color="#E5E5E5"> more that you encode something</font>

780
00:36:01,510 --> 00:36:08,740
<font color="#E5E5E5">the more the exponential the size will</font>

781
00:36:04,600 --> 00:36:11,380
go each<font color="#CCCCCC"> time</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> if you're already</font>

782
00:36:08,740 --> 00:36:13,450
<font color="#E5E5E5">operating on an extremely</font><font color="#CCCCCC"> limited</font>

783
00:36:11,380 --> 00:36:18,010
network with a<font color="#E5E5E5"> lot of</font><font color="#CCCCCC"> latency</font><font color="#E5E5E5"> right</font>

784
00:36:13,450 --> 00:36:20,169
moving a<font color="#CCCCCC"> 3 3</font><font color="#E5E5E5"> Meg file 5 Meg file</font><font color="#CCCCCC"> might</font>

785
00:36:18,010 --> 00:36:24,610
not<font color="#E5E5E5"> be the best way forward especially</font>

786
00:36:20,170 --> 00:36:26,530
with text<font color="#E5E5E5"> right so with you you encode</font>

787
00:36:24,610 --> 00:36:29,920
<font color="#E5E5E5">it</font><font color="#CCCCCC"> so this is just one example that I</font>

788
00:36:26,530 --> 00:36:31,900
thought of<font color="#E5E5E5"> but the obviously the</font><font color="#CCCCCC"> more</font>

789
00:36:29,920 --> 00:36:33,520
<font color="#CCCCCC">you encode</font><font color="#E5E5E5"> it the bigger their size and</font>

790
00:36:31,900 --> 00:36:35,830
<font color="#E5E5E5">the stronger you're gonna get caught</font>

791
00:36:33,520 --> 00:36:39,759
<font color="#E5E5E5">alright so again blue team that's</font>

792
00:36:35,830 --> 00:36:41,710
another way of<font color="#CCCCCC"> looking at it so xxe 3-d</font>

793
00:36:39,760 --> 00:36:43,960
eyes<font color="#CCCCCC"> - the purple team right so</font><font color="#E5E5E5"> for my</font>

794
00:36:41,710 --> 00:36:45,430
<font color="#CCCCCC">necks</font><font color="#E5E5E5"> I have a lot of candy</font><font color="#CCCCCC"> so for my</font>

795
00:36:43,960 --> 00:36:47,850
next<font color="#E5E5E5"> candy who can tell me what purple</font>

796
00:36:45,430 --> 00:36:47,850
team<font color="#E5E5E5"> is</font>

797
00:36:50,190 --> 00:36:57,570
makes<font color="#CCCCCC"> between blue and red</font><font color="#E5E5E5"> come pick</font>

798
00:36:52,440 --> 00:36:59,070
your candy choice<font color="#E5E5E5"> right so</font><font color="#CCCCCC"> ecstasy three</font>

799
00:36:57,570 --> 00:37:01,230
eyes at a purple team right so we'll

800
00:36:59,070 --> 00:37:03,870
just<font color="#E5E5E5"> start in a blue so blue</font><font color="#CCCCCC"> team's</font>

801
00:37:01,230 --> 00:37:05,220
<font color="#E5E5E5">mostly focus obtain situational</font>

802
00:37:03,870 --> 00:37:09,779
awareness of<font color="#E5E5E5"> your environment</font><font color="#CCCCCC"> right</font>

803
00:37:05,220 --> 00:37:10,830
networks hardware devices users<font color="#E5E5E5"> user</font>

804
00:37:09,780 --> 00:37:12,720
skill levels

805
00:37:10,830 --> 00:37:13,860
you know organization doesn't<font color="#E5E5E5"> you know</font>

806
00:37:12,720 --> 00:37:16,740
<font color="#E5E5E5">the whole nine yards</font>

807
00:37:13,860 --> 00:37:18,540
your key thing is<font color="#CCCCCC"> to detect investigate</font>

808
00:37:16,740 --> 00:37:21,180
analyze and mitigate prevent the threat

809
00:37:18,540 --> 00:37:23,340
whatever the threat<font color="#E5E5E5"> is</font><font color="#CCCCCC"> reka gonna be</font>

810
00:37:21,180 --> 00:37:26,640
<font color="#E5E5E5">hardware could be people could be</font>

811
00:37:23,340 --> 00:37:28,260
anything<font color="#CCCCCC"> and</font><font color="#E5E5E5"> in understand evaluate and</font>

812
00:37:26,640 --> 00:37:29,730
then<font color="#E5E5E5"> mitigate the risk right so that's</font>

813
00:37:28,260 --> 00:37:32,490
really where<font color="#E5E5E5"> your blue team comes into</font>

814
00:37:29,730 --> 00:37:38,190
play is mitigating that risk<font color="#CCCCCC"> to the</font>

815
00:37:32,490 --> 00:37:40,770
<font color="#E5E5E5">business owner of your organization and</font>

816
00:37:38,190 --> 00:37:42,390
then red teaming goes a lot different it

817
00:37:40,770 --> 00:37:44,970
goes a lot deeper

818
00:37:42,390 --> 00:37:48,870
excuse me than<font color="#E5E5E5"> just ones and</font><font color="#CCCCCC"> zeros right</font>

819
00:37:44,970 --> 00:37:50,730
so who can<font color="#E5E5E5"> tell</font><font color="#CCCCCC"> me what</font><font color="#E5E5E5"> the neck are</font>

820
00:37:48,870 --> 00:37:54,020
where the term red teaming came from

821
00:37:50,730 --> 00:37:54,020
<font color="#E5E5E5">wants to take a guess</font>

822
00:37:57,519 --> 00:38:05,229
Tiger teams<font color="#CCCCCC"> no it goes it goes way</font>

823
00:38:00,699 --> 00:38:07,199
deeper<font color="#E5E5E5"> than that way for their</font><font color="#CCCCCC"> bag</font><font color="#E5E5E5"> come</font>

824
00:38:05,229 --> 00:38:11,609
further<font color="#E5E5E5"> than that</font>

825
00:38:07,199 --> 00:38:11,609
<font color="#E5E5E5">there's no permanent</font><font color="#CCCCCC"> revolution here</font>

826
00:38:12,609 --> 00:38:15,209
deeper<font color="#CCCCCC"> than that</font>

827
00:38:17,369 --> 00:38:30,069
maybe<font color="#E5E5E5"> maybe so so red teaming</font><font color="#CCCCCC"> the term</font>

828
00:38:25,689 --> 00:38:33,399
red team comes down comes<font color="#CCCCCC"> from the back</font>

829
00:38:30,069 --> 00:38:37,209
in early<font color="#E5E5E5"> Catholic days like when the</font>

830
00:38:33,399 --> 00:38:39,009
<font color="#E5E5E5">Catholic Church ruled the world</font><font color="#CCCCCC"> for for</font>

831
00:38:37,209 --> 00:38:41,319
sainthood for people who were<font color="#E5E5E5"> going up</font>

832
00:38:39,009 --> 00:38:42,729
for sainthood<font color="#CCCCCC"> and the Cardinals</font><font color="#E5E5E5"> would</font>

833
00:38:41,319 --> 00:38:44,679
come together<font color="#E5E5E5"> and they would discuss</font>

834
00:38:42,729 --> 00:38:48,279
amongst<font color="#E5E5E5"> themselves who would be deemed a</font>

835
00:38:44,679 --> 00:38:50,229
saint<font color="#CCCCCC"> it was in the view of the Catholic</font>

836
00:38:48,279 --> 00:38:52,509
Church<font color="#CCCCCC"> that everyone gets</font><font color="#E5E5E5"> a voice to</font>

837
00:38:50,229 --> 00:38:54,698
include the<font color="#CCCCCC"> double right so the term red</font>

838
00:38:52,509 --> 00:38:57,130
team<font color="#CCCCCC"> where</font><font color="#E5E5E5"> that term devil's advocate</font>

839
00:38:54,699 --> 00:38:58,630
<font color="#E5E5E5">that's where it comes from</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> that hurt</font>

840
00:38:57,130 --> 00:39:01,029
there was one person<font color="#E5E5E5"> in that person's</font>

841
00:38:58,630 --> 00:39:03,459
<font color="#CCCCCC">soul job was to try</font><font color="#E5E5E5"> to discredit every</font>

842
00:39:01,029 --> 00:39:06,579
single<font color="#E5E5E5"> act that that person did</font><font color="#CCCCCC"> to deny</font>

843
00:39:03,459 --> 00:39:08,919
them sainthood<font color="#CCCCCC"> you're acting</font><font color="#E5E5E5"> as the</font>

844
00:39:06,579 --> 00:39:13,239
adversary<font color="#E5E5E5"> that's where the term red</font>

845
00:39:08,919 --> 00:39:15,359
<font color="#CCCCCC">team's come from</font><font color="#E5E5E5"> right so</font><font color="#CCCCCC"> there was</font><font color="#E5E5E5"> no</font>

846
00:39:13,239 --> 00:39:17,979
one's there's no zeros ones and<font color="#CCCCCC"> zeros</font>

847
00:39:15,359 --> 00:39:21,538
<font color="#E5E5E5">wasn't probably around then I</font><font color="#CCCCCC"> wasn't</font>

848
00:39:17,979 --> 00:39:25,058
there<font color="#E5E5E5"> I don't</font><font color="#CCCCCC"> know but I'm assuming</font><font color="#E5E5E5"> but</font>

849
00:39:21,539 --> 00:39:27,579
red<font color="#CCCCCC"> teaming itself is is significantly</font>

850
00:39:25,059 --> 00:39:31,689
deeper<font color="#E5E5E5"> it's it's so much more deeper</font>

851
00:39:27,579 --> 00:39:34,209
there's there's physiological aspects of

852
00:39:31,689 --> 00:39:36,178
it there's sociological aspects<font color="#E5E5E5"> right so</font>

853
00:39:34,209 --> 00:39:39,808
if you<font color="#E5E5E5"> had a problem from adversary or</font>

854
00:39:36,179 --> 00:39:42,189
competitors perspective right

855
00:39:39,809 --> 00:39:46,439
utilizing alternative<font color="#E5E5E5"> analysis and again</font>

856
00:39:42,189 --> 00:39:49,178
acting as devil's advocate purple team

857
00:39:46,439 --> 00:39:50,709
man which is<font color="#E5E5E5"> perfect because I have a</font>

858
00:39:49,179 --> 00:39:53,709
blue dot<font color="#CCCCCC"> and a red dot</font><font color="#E5E5E5"> and they make</font>

859
00:39:50,709 --> 00:39:55,629
purple<font color="#E5E5E5"> when mixed together right</font><font color="#CCCCCC"> so</font>

860
00:39:53,709 --> 00:39:58,118
purple team<font color="#E5E5E5"> is used to demystify each</font>

861
00:39:55,630 --> 00:40:00,339
other's operations<font color="#E5E5E5"> right so in a lot of</font>

862
00:39:58,119 --> 00:40:02,380
environments<font color="#CCCCCC"> red team goes off and does</font>

863
00:40:00,339 --> 00:40:04,959
red team things and then they do red

864
00:40:02,380 --> 00:40:06,309
team stuff and they and<font color="#CCCCCC"> then</font><font color="#E5E5E5"> the blue</font>

865
00:40:04,959 --> 00:40:08,078
team goes off and does blue team things

866
00:40:06,309 --> 00:40:10,119
and they do blue team stuff<font color="#E5E5E5"> right and</font>

867
00:40:08,079 --> 00:40:13,749
it's this<font color="#E5E5E5"> cat-and-mouse game</font>

868
00:40:10,119 --> 00:40:16,119
<font color="#E5E5E5">where the cat and mouse never meet ever</font>

869
00:40:13,749 --> 00:40:18,519
<font color="#CCCCCC">right like physically never meet in the</font>

870
00:40:16,119 --> 00:40:19,960
same room<font color="#E5E5E5"> and if they</font><font color="#CCCCCC"> do it's</font><font color="#E5E5E5"> typically</font>

871
00:40:18,519 --> 00:40:21,189
<font color="#E5E5E5">the red team and</font><font color="#CCCCCC"> they're leaning back</font>

872
00:40:19,960 --> 00:40:23,980
because I<font color="#CCCCCC"> got their feet on their</font><font color="#E5E5E5"> table</font>

873
00:40:21,190 --> 00:40:26,710
saying<font color="#E5E5E5"> you know we got you here's a</font>

874
00:40:23,980 --> 00:40:29,799
report<font color="#CCCCCC"> here's how you keep us out</font><font color="#E5E5E5"> we'll</font>

875
00:40:26,710 --> 00:40:32,650
check back in<font color="#E5E5E5"> six months right</font><font color="#CCCCCC"> we're</font>

876
00:40:29,799 --> 00:40:35,980
<font color="#E5E5E5">we're purple team comes into play is</font>

877
00:40:32,650 --> 00:40:38,410
when<font color="#CCCCCC"> you say</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right I'm gonna pair</font><font color="#E5E5E5"> a</font>

878
00:40:35,980 --> 00:40:41,470
blue team member a defender with a red

879
00:40:38,410 --> 00:40:44,308
team member an offensive<font color="#E5E5E5"> person and</font>

880
00:40:41,470 --> 00:40:46,569
piece them<font color="#E5E5E5"> together and I'm gonna let</font>

881
00:40:44,309 --> 00:40:49,029
both of<font color="#E5E5E5"> them come to the table with</font>

882
00:40:46,569 --> 00:40:50,558
<font color="#E5E5E5">their own play books and let them just</font>

883
00:40:49,029 --> 00:40:52,180
execute their play books<font color="#CCCCCC"> and then they</font>

884
00:40:50,559 --> 00:40:56,200
communicate with<font color="#CCCCCC"> each other</font><font color="#E5E5E5"> right so</font>

885
00:40:52,180 --> 00:40:59,410
<font color="#CCCCCC">it's this environment where it's okay to</font>

886
00:40:56,200 --> 00:41:02,200
say I<font color="#E5E5E5"> don't know to say here's what I'm</font>

887
00:40:59,410 --> 00:41:06,160
doing right<font color="#E5E5E5"> I may not show</font><font color="#CCCCCC"> you my entire</font>

888
00:41:02,200 --> 00:41:08,379
playbook<font color="#E5E5E5"> but I'm gonna show you the vast</font>

889
00:41:06,160 --> 00:41:10,058
majority<font color="#CCCCCC"> of it right</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> that you can get</font>

890
00:41:08,380 --> 00:41:13,569
a better<font color="#CCCCCC"> understanding of what I see and</font>

891
00:41:10,059 --> 00:41:15,549
where I come from<font color="#E5E5E5"> on both sides right so</font>

892
00:41:13,569 --> 00:41:18,249
you've got<font color="#CCCCCC"> your</font><font color="#E5E5E5"> blue team person saying</font>

893
00:41:15,549 --> 00:41:20,109
well I<font color="#E5E5E5"> see you ran this attack I'm</font>

894
00:41:18,249 --> 00:41:23,049
showing this<font color="#E5E5E5"> NetFlow data I'm showing</font>

895
00:41:20,109 --> 00:41:24,848
<font color="#CCCCCC">this peak</font><font color="#E5E5E5"> I captured this</font><font color="#CCCCCC"> pcap I'm doing</font>

896
00:41:23,049 --> 00:41:27,069
<font color="#E5E5E5">these things here's what I'm seeing</font>

897
00:41:24,849 --> 00:41:29,200
<font color="#E5E5E5">here's what I'm here's my indicators</font>

898
00:41:27,069 --> 00:41:33,369
<font color="#CCCCCC">that I'm popping off on here's here's</font>

899
00:41:29,200 --> 00:41:36,489
what<font color="#E5E5E5"> I'm getting from this attack</font><font color="#CCCCCC"> or I'm</font>

900
00:41:33,369 --> 00:41:39,430
not seeing any<font color="#CCCCCC"> of</font><font color="#E5E5E5"> this man</font><font color="#CCCCCC"> can you teach</font>

901
00:41:36,489 --> 00:41:42,249
me more<font color="#CCCCCC"> about</font><font color="#E5E5E5"> this so I can learn</font><font color="#CCCCCC"> to</font>

902
00:41:39,430 --> 00:41:44,109
detect<font color="#E5E5E5"> this</font><font color="#CCCCCC"> type of stuff right it</font>

903
00:41:42,249 --> 00:41:45,788
enhances communication flow between<font color="#E5E5E5"> your</font>

904
00:41:44,109 --> 00:41:49,450
two teams so it says iron sharpens iron

905
00:41:45,789 --> 00:41:51,549
mentality<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> know coming from</font><font color="#E5E5E5"> the</font>

906
00:41:49,450 --> 00:41:54,249
army communication is everything<font color="#CCCCCC"> right</font>

907
00:41:51,549 --> 00:41:56,470
especially<font color="#CCCCCC"> on the battlefield so</font><font color="#E5E5E5"> the</font>

908
00:41:54,249 --> 00:42:00,279
greatest<font color="#E5E5E5"> way to cause chaos</font><font color="#CCCCCC"> and mayhem</font>

909
00:41:56,470 --> 00:42:02,049
<font color="#E5E5E5">is to prevent</font><font color="#CCCCCC"> two members of the</font><font color="#E5E5E5"> same</font>

910
00:42:00,279 --> 00:42:04,690
team just kill their communication and

911
00:42:02,049 --> 00:42:07,390
<font color="#E5E5E5">they can't communicate especially as an</font>

912
00:42:04,690 --> 00:42:09,549
officer in a commander level<font color="#E5E5E5"> when I have</font>

913
00:42:07,390 --> 00:42:11,170
to maneuver<font color="#E5E5E5"> my people on the</font><font color="#CCCCCC"> battlefield</font>

914
00:42:09,549 --> 00:42:13,359
and<font color="#E5E5E5"> I can't communicate to them to</font>

915
00:42:11,170 --> 00:42:14,859
<font color="#CCCCCC">direct the fight that becomes a huge</font>

916
00:42:13,359 --> 00:42:19,569
huge<font color="#E5E5E5"> problem for me</font>

917
00:42:14,859 --> 00:42:21,730
right so<font color="#CCCCCC"> putting</font><font color="#E5E5E5"> these two people</font>

918
00:42:19,569 --> 00:42:24,220
together side by side<font color="#E5E5E5"> and</font>

919
00:42:21,730 --> 00:42:26,650
and making them communicate with each

920
00:42:24,220 --> 00:42:28,450
other<font color="#E5E5E5"> will</font><font color="#CCCCCC"> only make in my opinion your</font>

921
00:42:26,650 --> 00:42:30,160
organization better if they<font color="#E5E5E5"> both come</font>

922
00:42:28,450 --> 00:42:33,040
with<font color="#E5E5E5"> a good attitude</font><font color="#CCCCCC"> now they come with</font>

923
00:42:30,160 --> 00:42:34,839
a bad attitude<font color="#E5E5E5"> then you know other than</font>

924
00:42:33,040 --> 00:42:37,330
a<font color="#E5E5E5"> heavy hand you will do this you know</font>

925
00:42:34,840 --> 00:42:38,710
there's nothing<font color="#CCCCCC"> else but again</font><font color="#E5E5E5"> that's</font>

926
00:42:37,330 --> 00:42:41,590
counterproductive<font color="#E5E5E5"> if you go down that</font>

927
00:42:38,710 --> 00:42:42,880
rabbit hole<font color="#CCCCCC"> and in each element gains</font>

928
00:42:41,590 --> 00:42:44,950
valuable<font color="#E5E5E5"> skill since he's behind the</font>

929
00:42:42,880 --> 00:42:48,190
curtain of<font color="#CCCCCC"> the others right so red teams</font>

930
00:42:44,950 --> 00:42:49,839
learn blue team<font color="#E5E5E5"> TTP or</font><font color="#CCCCCC"> tie vex</font>

931
00:42:48,190 --> 00:42:53,109
techniques<font color="#CCCCCC"> procedures they're learning</font>

932
00:42:49,840 --> 00:42:56,490
blue team products<font color="#CCCCCC"> they're learning</font><font color="#E5E5E5"> how</font>

933
00:42:53,109 --> 00:42:59,980
can I take these tools<font color="#E5E5E5"> that you use and</font>

934
00:42:56,490 --> 00:43:02,529
then mimic<font color="#E5E5E5"> them in my own</font><font color="#CCCCCC"> environment</font><font color="#E5E5E5"> to</font>

935
00:42:59,980 --> 00:43:06,430
create<font color="#CCCCCC"> my own</font><font color="#E5E5E5"> test cases as I test my</font>

936
00:43:02,530 --> 00:43:08,619
<font color="#CCCCCC">own stuff</font><font color="#E5E5E5"> right and flipside</font><font color="#CCCCCC"> blue team</font>

937
00:43:06,430 --> 00:43:11,350
sees these red team tools<font color="#E5E5E5"> maybe cats</font>

938
00:43:08,619 --> 00:43:13,720
right<font color="#CCCCCC"> all these other in the vast</font>

939
00:43:11,350 --> 00:43:15,460
majority<font color="#CCCCCC"> doulas you should include out</font>

940
00:43:13,720 --> 00:43:17,140
in their library<font color="#E5E5E5"> right but they can go</font>

941
00:43:15,460 --> 00:43:18,850
back<font color="#E5E5E5"> and take a</font><font color="#CCCCCC"> look at it and say well</font>

942
00:43:17,140 --> 00:43:21,160
it's creating this payload<font color="#CCCCCC"> or it's</font>

943
00:43:18,850 --> 00:43:22,660
creating<font color="#E5E5E5"> this</font><font color="#CCCCCC"> thing right so maybe we</font>

944
00:43:21,160 --> 00:43:25,060
<font color="#CCCCCC">need to be on the lookout for</font><font color="#E5E5E5"> this stuff</font>

945
00:43:22,660 --> 00:43:26,859
<font color="#E5E5E5">I'm not creating a signature</font><font color="#CCCCCC"> for the</font>

946
00:43:25,060 --> 00:43:33,580
tool<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> creating a signature</font><font color="#CCCCCC"> for the</font>

947
00:43:26,859 --> 00:43:35,799
action<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so with that what are</font><font color="#E5E5E5"> your</font>

948
00:43:33,580 --> 00:43:38,740
questions<font color="#E5E5E5"> anybody have any questions</font><font color="#CCCCCC"> we</font>

949
00:43:35,800 --> 00:43:43,060
<font color="#E5E5E5">have like</font><font color="#CCCCCC"> ten more minutes I can just</font>

950
00:43:38,740 --> 00:43:50,709
stare awkwardly at everybody I have a

951
00:43:43,060 --> 00:44:01,920
lot of candy<font color="#CCCCCC"> to nothing</font><font color="#E5E5E5"> okay</font>

952
00:43:50,710 --> 00:44:01,920
yeah so yeah it's challenging isn't it

953
00:44:19,430 --> 00:44:27,629
um<font color="#E5E5E5"> so PHP is my test case</font><font color="#CCCCCC"> I I didn't</font>

954
00:44:23,790 --> 00:44:29,779
test<font color="#E5E5E5"> I so my ignorant is showing I</font>

955
00:44:27,630 --> 00:44:34,670
really don't know<font color="#E5E5E5"> anything about is</font>

956
00:44:29,780 --> 00:44:38,610
other<font color="#E5E5E5"> than Microsoft I was the market</font><font color="#CCCCCC"> so</font>

957
00:44:34,670 --> 00:44:40,950
I I have so that this<font color="#E5E5E5"> web server is</font>

958
00:44:38,610 --> 00:44:44,790
running<font color="#E5E5E5"> Apache</font><font color="#CCCCCC"> on it</font>

959
00:44:40,950 --> 00:44:50,399
so I guess what<font color="#CCCCCC"> might help</font>

960
00:44:44,790 --> 00:44:58,110
it is PHP<font color="#E5E5E5"> right but going do I have</font>

961
00:44:50,400 --> 00:45:02,750
<font color="#CCCCCC">Internet's I think I have</font><font color="#E5E5E5"> Internet can</font>

962
00:44:58,110 --> 00:45:02,750
you guys see<font color="#CCCCCC"> that</font><font color="#E5E5E5"> yeah cool</font><font color="#CCCCCC"> so</font>

963
00:45:08,340 --> 00:45:24,180
in my<font color="#E5E5E5"> minute</font><font color="#CCCCCC"> trying</font><font color="#E5E5E5"> here you go</font>

964
00:45:19,410 --> 00:45:30,240
so<font color="#E5E5E5"> oh</font><font color="#CCCCCC"> wow it's cheap seat right</font><font color="#E5E5E5"> so in a</font>

965
00:45:24,180 --> 00:45:31,859
lot of<font color="#E5E5E5"> these it's really it's for</font><font color="#CCCCCC"> a lot</font>

966
00:45:30,240 --> 00:45:34,529
<font color="#E5E5E5">of these it's it's pretty simple you're</font>

967
00:45:31,860 --> 00:45:38,690
really just like adding one line<font color="#E5E5E5"> to your</font>

968
00:45:34,530 --> 00:45:42,900
config file<font color="#CCCCCC"> and say don't</font><font color="#E5E5E5"> allow DT DS or</font>

969
00:45:38,690 --> 00:45:44,520
analyze certain things right<font color="#E5E5E5"> only allow</font>

970
00:45:42,900 --> 00:45:46,800
these<font color="#CCCCCC"> things right</font>

971
00:45:44,520 --> 00:45:49,500
<font color="#CCCCCC">Oh wasps again does a pretty good job of</font>

972
00:45:46,800 --> 00:45:51,990
like highlighting those and say include

973
00:45:49,500 --> 00:45:55,950
this to prevent this<font color="#E5E5E5"> obviously if you</font>

974
00:45:51,990 --> 00:45:57,600
<font color="#E5E5E5">can so in in regards</font><font color="#CCCCCC"> to testing like</font>

975
00:45:55,950 --> 00:46:00,210
<font color="#CCCCCC">Java applications</font><font color="#E5E5E5"> and other stuff I</font>

976
00:45:57,600 --> 00:46:02,339
haven't<font color="#E5E5E5"> gone that far in testing</font><font color="#CCCCCC"> it's</font>

977
00:46:00,210 --> 00:46:05,070
most definitely<font color="#CCCCCC"> on our roadmap me and</font>

978
00:46:02,340 --> 00:46:06,090
<font color="#CCCCCC">mill with me and Donald's</font><font color="#E5E5E5"> roadmap</font><font color="#CCCCCC"> that's</font>

979
00:46:05,070 --> 00:46:08,580
a pretty good question

980
00:46:06,090 --> 00:46:11,190
<font color="#CCCCCC">PHP was just the base case cuz it's what</font>

981
00:46:08,580 --> 00:46:15,779
I've been<font color="#E5E5E5"> playing with lately you get a</font>

982
00:46:11,190 --> 00:46:21,890
<font color="#E5E5E5">candy</font><font color="#CCCCCC"> again if you want more</font><font color="#E5E5E5"> candy cool</font>

983
00:46:15,780 --> 00:46:21,890
yes<font color="#E5E5E5"> okay</font>

984
00:46:34,549 --> 00:46:40,589
so uh so for<font color="#E5E5E5"> the viewers at</font><font color="#CCCCCC"> home the</font>

985
00:46:38,190 --> 00:46:44,039
<font color="#CCCCCC">question was for purple team</font><font color="#E5E5E5"> is there a</font>

986
00:46:40,589 --> 00:46:47,759
way to<font color="#E5E5E5"> capture blue team</font><font color="#CCCCCC"> stuffs and red</font>

987
00:46:44,039 --> 00:46:49,349
<font color="#E5E5E5">team stuffs during an</font><font color="#CCCCCC"> engagement and if</font>

988
00:46:47,759 --> 00:46:51,349
there was a commercial<font color="#E5E5E5"> product that did</font>

989
00:46:49,349 --> 00:46:54,989
that<font color="#E5E5E5"> as far as</font><font color="#CCCCCC"> I know there isn't</font>

990
00:46:51,349 --> 00:46:56,789
<font color="#CCCCCC">however there's nothing saying that you</font>

991
00:46:54,989 --> 00:46:59,279
can't if<font color="#E5E5E5"> you do an</font><font color="#CCCCCC"> engagement with the</font>

992
00:46:56,789 --> 00:47:02,789
red team<font color="#CCCCCC"> and a blue team</font><font color="#E5E5E5"> to say</font>

993
00:46:59,279 --> 00:47:05,190
beforehand<font color="#CCCCCC"> you guys are gonna do</font><font color="#E5E5E5"> packet</font>

994
00:47:02,789 --> 00:47:07,549
captures on your stuff<font color="#E5E5E5"> you guys</font><font color="#CCCCCC"> are</font>

995
00:47:05,190 --> 00:47:11,279
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> you know produce your artifacts</font>

996
00:47:07,549 --> 00:47:13,710
<font color="#CCCCCC">after the fact you know we're</font><font color="#E5E5E5"> gonna I</font>

997
00:47:11,279 --> 00:47:15,329
<font color="#E5E5E5">mean pcaps don't lie</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so if you're</font>

998
00:47:13,710 --> 00:47:16,950
<font color="#CCCCCC">just gonna</font><font color="#E5E5E5"> do full packet captures of</font>

999
00:47:15,329 --> 00:47:18,960
your stuff which<font color="#E5E5E5"> obviously you would</font>

1000
00:47:16,950 --> 00:47:22,229
<font color="#CCCCCC">need to support sighs</font><font color="#E5E5E5"> and are the data</font>

1001
00:47:18,960 --> 00:47:23,930
set or<font color="#E5E5E5"> the data stores just to port</font>

1002
00:47:22,229 --> 00:47:26,399
these<font color="#E5E5E5"> huge</font><font color="#CCCCCC"> pcaps you're gonna generate</font>

1003
00:47:23,930 --> 00:47:29,700
<font color="#E5E5E5">anything go through right so in actual</font>

1004
00:47:26,400 --> 00:47:31,920
automation I'm sure there<font color="#CCCCCC"> is</font><font color="#E5E5E5"> that can do</font>

1005
00:47:29,700 --> 00:47:33,299
that piece<font color="#E5E5E5"> but it's not automated so</font>

1006
00:47:31,920 --> 00:47:36,989
maybe you just<font color="#CCCCCC"> came</font><font color="#E5E5E5"> up with</font><font color="#CCCCCC"> a new</font>

1007
00:47:33,299 --> 00:47:41,339
business right in<font color="#CCCCCC"> this room in my talk</font>

1008
00:47:36,989 --> 00:47:44,640
<font color="#CCCCCC">you heard it here</font><font color="#E5E5E5"> first</font><font color="#CCCCCC"> right maybe I as</font>

1009
00:47:41,339 --> 00:47:47,489
far<font color="#CCCCCC"> as I know no so this</font><font color="#E5E5E5"> is again</font>

1010
00:47:44,640 --> 00:47:50,249
relatively new<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> used quotes because</font>

1011
00:47:47,489 --> 00:47:51,630
<font color="#E5E5E5">it's been around for you</font><font color="#CCCCCC"> know many many</font>

1012
00:47:50,249 --> 00:47:53,999
many<font color="#E5E5E5"> years it says people are now</font>

1013
00:47:51,630 --> 00:47:56,880
starting<font color="#CCCCCC"> to</font><font color="#E5E5E5"> adopt it so it's more it's</font>

1014
00:47:53,999 --> 00:48:00,118
<font color="#E5E5E5">more instead</font><font color="#CCCCCC"> of you know a new niche</font>

1015
00:47:56,880 --> 00:48:02,489
market<font color="#E5E5E5"> it's more</font><font color="#CCCCCC"> of a you know</font><font color="#E5E5E5"> a</font>

1016
00:48:00,119 --> 00:48:03,479
leadership management<font color="#E5E5E5"> perspective</font><font color="#CCCCCC"> to</font>

1017
00:48:02,489 --> 00:48:05,969
kind of just get your<font color="#E5E5E5"> team's</font>

1018
00:48:03,479 --> 00:48:07,379
collaborating to make<font color="#E5E5E5"> them sharper and</font>

1019
00:48:05,969 --> 00:48:09,930
make them and make<font color="#E5E5E5"> your</font><font color="#CCCCCC"> organization</font>

1020
00:48:07,380 --> 00:48:12,119
better if that<font color="#E5E5E5"> makes sense</font><font color="#CCCCCC"> so really</font>

1021
00:48:09,930 --> 00:48:14,308
again in a long way a<font color="#E5E5E5"> long</font><font color="#CCCCCC"> winded way</font>

1022
00:48:12,119 --> 00:48:15,839
<font color="#E5E5E5">about it's not</font><font color="#CCCCCC"> - each team really to</font>

1023
00:48:14,309 --> 00:48:18,450
provide those artifacts and maybe your

1024
00:48:15,839 --> 00:48:21,390
purple team can be your you know<font color="#CCCCCC"> your</font>

1025
00:48:18,450 --> 00:48:22,919
white cell for lack of a<font color="#CCCCCC"> better where</font>

1026
00:48:21,390 --> 00:48:24,868
the person that goes in<font color="#E5E5E5"> between and</font>

1027
00:48:22,920 --> 00:48:26,880
compiles it and then generates the

1028
00:48:24,869 --> 00:48:30,359
<font color="#CCCCCC">report with representatives from each</font>

1029
00:48:26,880 --> 00:48:34,019
side to<font color="#CCCCCC"> kind of recreate your whole</font>

1030
00:48:30,359 --> 00:48:35,219
timeline maybe that's it<font color="#E5E5E5"> so if you</font>

1031
00:48:34,019 --> 00:48:37,640
figure<font color="#CCCCCC"> out</font><font color="#E5E5E5"> a way</font><font color="#CCCCCC"> to automate that yeah</font>

1032
00:48:35,219 --> 00:48:37,640
go for<font color="#E5E5E5"> it</font>

1033
00:48:40,210 --> 00:48:46,700
yes that's a good<font color="#E5E5E5"> one</font>

1034
00:48:43,780 --> 00:48:49,760
yep<font color="#E5E5E5"> so so</font><font color="#CCCCCC"> The MITRE attack framework is</font>

1035
00:48:46,700 --> 00:48:53,899
a it's a framework created by<font color="#CCCCCC"> mitre that</font>

1036
00:48:49,760 --> 00:48:59,800
targets<font color="#E5E5E5"> Windows environments so we</font><font color="#CCCCCC"> have</font>

1037
00:48:53,900 --> 00:49:01,880
the<font color="#CCCCCC"> internet we have the</font><font color="#E5E5E5"> internet yeah</font><font color="#CCCCCC"> I</font>

1038
00:48:59,800 --> 00:49:09,110
spoke about<font color="#E5E5E5"> that like two years</font><font color="#CCCCCC"> ago I</font>

1039
00:49:01,880 --> 00:49:10,860
can't<font color="#E5E5E5"> believe I didn't think of it yeah</font>

1040
00:49:09,110 --> 00:49:13,989
absolutely

1041
00:49:10,860 --> 00:49:13,989
[Music]

1042
00:49:21,539 --> 00:49:28,619
<font color="#CCCCCC">right</font><font color="#E5E5E5"> yeah yeah so um</font><font color="#CCCCCC"> man they've really</font>

1043
00:49:27,209 --> 00:49:32,729
cleaned up this<font color="#CCCCCC"> website last</font><font color="#E5E5E5"> time I was</font>

1044
00:49:28,619 --> 00:49:34,679
here it was like<font color="#CCCCCC"> a wiki so you see you</font>

1045
00:49:32,729 --> 00:49:36,928
<font color="#CCCCCC">have initial access execution so if we</font>

1046
00:49:34,679 --> 00:49:39,019
just click<font color="#E5E5E5"> on initial access right these</font>

1047
00:49:36,929 --> 00:49:42,029
are<font color="#E5E5E5"> all the techniques</font><font color="#CCCCCC"> that you can do</font>

1048
00:49:39,019 --> 00:49:44,729
<font color="#E5E5E5">initial access so really they created</font>

1049
00:49:42,029 --> 00:49:47,309
<font color="#E5E5E5">this wiki that</font><font color="#CCCCCC"> a miner created this wiki</font>

1050
00:49:44,729 --> 00:49:48,718
through a lot<font color="#E5E5E5"> of research that says here</font>

1051
00:49:47,309 --> 00:49:50,369
<font color="#E5E5E5">are all the ways you can attack a</font>

1052
00:49:48,719 --> 00:49:52,769
network<font color="#CCCCCC"> your all the ways that</font><font color="#E5E5E5"> you can</font>

1053
00:49:50,369 --> 00:49:55,729
exploit a network or application or

1054
00:49:52,769 --> 00:49:58,049
<font color="#E5E5E5">whatever right</font><font color="#CCCCCC"> and then broken</font><font color="#E5E5E5"> down by</font>

1055
00:49:55,729 --> 00:50:00,779
these things<font color="#E5E5E5"> like initial access so you</font>

1056
00:49:58,049 --> 00:50:02,839
do<font color="#E5E5E5"> drive-by</font><font color="#CCCCCC"> compromise so within Drive I</font>

1057
00:50:00,779 --> 00:50:05,999
<font color="#E5E5E5">compromise it gives you all this data</font>

1058
00:50:02,839 --> 00:50:08,399
<font color="#CCCCCC">you know all everything you</font><font color="#E5E5E5"> could ever</font>

1059
00:50:05,999 --> 00:50:12,209
care<font color="#CCCCCC"> to know</font><font color="#E5E5E5"> along with examples in the</font>

1060
00:50:08,399 --> 00:50:14,249
wild so apt<font color="#E5E5E5"> 19</font><font color="#CCCCCC"> 32</font><font color="#E5E5E5"> 37 right the list goes</font>

1061
00:50:12,209 --> 00:50:16,709
on<font color="#E5E5E5"> and then a whole</font><font color="#CCCCCC"> bunch of</font><font color="#E5E5E5"> resources</font>

1062
00:50:14,249 --> 00:50:18,569
about<font color="#CCCCCC"> it</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is an awesome</font>

1063
00:50:16,709 --> 00:50:21,779
<font color="#E5E5E5">tool</font><font color="#CCCCCC"> for your</font><font color="#E5E5E5"> blue teamers to really</font>

1064
00:50:18,569 --> 00:50:22,949
look at to say well<font color="#CCCCCC"> I supposed to</font><font color="#E5E5E5"> be</font>

1065
00:50:21,779 --> 00:50:25,409
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> for stuff what do I look for</font>

1066
00:50:22,949 --> 00:50:28,469
<font color="#CCCCCC">well this is a great place to go</font><font color="#E5E5E5"> look at</font>

1067
00:50:25,409 --> 00:50:30,209
you're not<font color="#E5E5E5"> only gonna get ideas on how</font>

1068
00:50:28,469 --> 00:50:31,859
to create<font color="#E5E5E5"> your signatures</font><font color="#CCCCCC"> and everything</font>

1069
00:50:30,209 --> 00:50:33,799
<font color="#E5E5E5">but you're also gonna learn to TTP's of</font>

1070
00:50:31,859 --> 00:50:36,449
your adversary and your offensive<font color="#CCCCCC"> people</font>

1071
00:50:33,799 --> 00:50:39,179
<font color="#CCCCCC">and in</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> teamers this is a great way</font>

1072
00:50:36,449 --> 00:50:42,239
to kind<font color="#CCCCCC"> of add more</font><font color="#E5E5E5"> stuff to your</font>

1073
00:50:39,179 --> 00:50:44,369
PlayBook<font color="#E5E5E5"> and more like</font><font color="#CCCCCC"> your more to get</font>

1074
00:50:42,239 --> 00:50:47,069
more skills<font color="#E5E5E5"> if you haven't been</font><font color="#CCCCCC"> exposed</font>

1075
00:50:44,369 --> 00:50:50,399
<font color="#E5E5E5">to these things before as well so yeah</font>

1076
00:50:47,069 --> 00:50:52,349
thank you<font color="#E5E5E5"> for that that's</font><font color="#CCCCCC"> awesome you</font>

1077
00:50:50,399 --> 00:50:53,959
get<font color="#CCCCCC"> a candy if you want to I know that's</font>

1078
00:50:52,349 --> 00:50:57,989
<font color="#CCCCCC">what you've been waiting for</font>

1079
00:50:53,959 --> 00:50:59,919
any other questions awesome well I

1080
00:50:57,989 --> 00:51:00,580
<font color="#CCCCCC">appreciate</font><font color="#E5E5E5"> it thank you guys so much</font>

1081
00:50:59,920 --> 00:51:04,900
[Music]

1082
00:51:00,580 --> 00:51:04,900
[Applause]

