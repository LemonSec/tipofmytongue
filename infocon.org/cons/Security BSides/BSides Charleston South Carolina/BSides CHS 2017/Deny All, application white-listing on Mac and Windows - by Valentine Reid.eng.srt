1
00:00:17,800 --> 00:00:26,060
morning everyone<font color="#CCCCCC"> so much</font>

2
00:00:22,250 --> 00:00:29,239
my name is Valentine and who I am<font color="#CCCCCC"> I'm</font>

3
00:00:26,060 --> 00:00:33,410
the engineering manager<font color="#E5E5E5"> at</font><font color="#CCCCCC"> Pocket Doc</font><font color="#E5E5E5"> we</font>

4
00:00:29,239 --> 00:00:35,570
are a<font color="#E5E5E5"> San</font><font color="#CCCCCC"> Matteo based organization</font>

5
00:00:33,410 --> 00:00:37,129
however<font color="#E5E5E5"> we do keep a significant</font>

6
00:00:35,570 --> 00:00:40,550
engineering presence here in Charleston

7
00:00:37,129 --> 00:00:43,089
so I'm not<font color="#E5E5E5"> a stranger</font><font color="#CCCCCC"> to the city we</font><font color="#E5E5E5"> are</font>

8
00:00:40,550 --> 00:00:47,089
a<font color="#CCCCCC"> health care</font><font color="#E5E5E5"> software company</font>

9
00:00:43,089 --> 00:00:49,699
developing API platforms<font color="#CCCCCC"> and so we're</font>

10
00:00:47,089 --> 00:00:52,370
not necessarily an InfoSec company but

11
00:00:49,699 --> 00:00:55,010
security<font color="#E5E5E5"> is extremely important in the</font>

12
00:00:52,370 --> 00:00:57,500
<font color="#CCCCCC">healthcare</font><font color="#E5E5E5"> industry</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> so that's I</font>

13
00:00:55,010 --> 00:00:58,820
think<font color="#CCCCCC"> it</font><font color="#E5E5E5"> should</font><font color="#CCCCCC"> be important everyone my</font>

14
00:00:57,500 --> 00:01:02,870
background so<font color="#E5E5E5"> I have 10 years</font><font color="#CCCCCC"> of</font>

15
00:00:58,820 --> 00:01:05,349
<font color="#E5E5E5">information information</font><font color="#CCCCCC"> technology</font><font color="#E5E5E5"> it's</font>

16
00:01:02,870 --> 00:01:07,820
all been blue team it's all been

17
00:01:05,349 --> 00:01:10,070
<font color="#E5E5E5">business analytics system administration</font>

18
00:01:07,820 --> 00:01:15,529
<font color="#E5E5E5">compliance I've been in utility I've</font>

19
00:01:10,070 --> 00:01:18,678
been in heavy industry<font color="#CCCCCC"> so so I've been</font>

20
00:01:15,530 --> 00:01:25,670
<font color="#E5E5E5">around</font><font color="#CCCCCC"> I say that I like to build things</font>

21
00:01:18,679 --> 00:01:26,810
<font color="#E5E5E5">not break them</font><font color="#CCCCCC"> and so today's agenda so</font>

22
00:01:25,670 --> 00:01:28,130
we're going to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about why you want</font>

23
00:01:26,810 --> 00:01:29,899
application whitelisting in your

24
00:01:28,130 --> 00:01:31,310
environment<font color="#CCCCCC"> we're gonna talk about</font><font color="#E5E5E5"> why</font>

25
00:01:29,899 --> 00:01:33,950
you won't want application whitelisting

26
00:01:31,310 --> 00:01:35,750
in your environment<font color="#CCCCCC"> this</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> is</font>

27
00:01:33,950 --> 00:01:37,220
designed to be zero to hero<font color="#CCCCCC"> so if you've</font>

28
00:01:35,750 --> 00:01:38,239
never interacted with application

29
00:01:37,220 --> 00:01:40,099
whitelisting<font color="#CCCCCC"> i'm going to take you</font>

30
00:01:38,239 --> 00:01:41,259
through the fundamentals<font color="#CCCCCC"> and then i'm</font>

31
00:01:40,099 --> 00:01:42,920
gonna bring you all<font color="#CCCCCC"> the way through</font>

32
00:01:41,259 --> 00:01:45,080
<font color="#CCCCCC">microsoft</font><font color="#E5E5E5"> AppLocker</font>

33
00:01:42,920 --> 00:01:47,660
<font color="#E5E5E5">which is an in operating system product</font>

34
00:01:45,080 --> 00:01:49,220
and they're not<font color="#E5E5E5"> on Mac OS I'm going to</font>

35
00:01:47,660 --> 00:01:57,560
talk about<font color="#E5E5E5"> Google Santa which is an</font>

36
00:01:49,220 --> 00:01:59,090
<font color="#CCCCCC">open-source product and so we why do we</font>

37
00:01:57,560 --> 00:02:01,610
want application whitelisting well we

38
00:01:59,090 --> 00:02:02,840
start with<font color="#CCCCCC"> deny all</font><font color="#E5E5E5"> on our firewalls so</font>

39
00:02:01,610 --> 00:02:06,349
why don't we<font color="#E5E5E5"> do the same thing on our</font>

40
00:02:02,840 --> 00:02:09,800
endpoints on our servers it seems simple

41
00:02:06,349 --> 00:02:10,970
right<font color="#E5E5E5"> well it's hard right application</font>

42
00:02:09,800 --> 00:02:13,580
whitelisting you up to know what's

43
00:02:10,970 --> 00:02:15,500
<font color="#CCCCCC">supposed to</font><font color="#E5E5E5"> run on your your devices do</font>

44
00:02:13,580 --> 00:02:17,750
you know every process every<font color="#E5E5E5"> application</font>

45
00:02:15,500 --> 00:02:20,530
running<font color="#E5E5E5"> no we've</font><font color="#CCCCCC"> been trained to just</font>

46
00:02:17,750 --> 00:02:23,209
use the operating system as it is

47
00:02:20,530 --> 00:02:25,069
there's<font color="#E5E5E5"> known</font><font color="#CCCCCC"> pipe passes</font><font color="#E5E5E5"> everything</font><font color="#CCCCCC"> I'm</font>

48
00:02:23,209 --> 00:02:27,409
going<font color="#E5E5E5"> to talk</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> today</font><font color="#CCCCCC"> if you have</font>

49
00:02:25,069 --> 00:02:28,760
one<font color="#E5E5E5"> of those red teamers out there get</font>

50
00:02:27,409 --> 00:02:29,670
on your box they're<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to be able</font><font color="#CCCCCC"> to</font>

51
00:02:28,760 --> 00:02:31,859
bypass<font color="#CCCCCC"> it that's</font>

52
00:02:29,670 --> 00:02:33,780
fact<font color="#CCCCCC"> but that's true with antivirus and</font>

53
00:02:31,860 --> 00:02:35,340
you still install it the idea of

54
00:02:33,780 --> 00:02:37,080
application whitelisting is you're

55
00:02:35,340 --> 00:02:43,260
building<font color="#CCCCCC"> an onion</font><font color="#E5E5E5"> you're defending in</font>

56
00:02:37,080 --> 00:02:46,170
depth so it's impossible<font color="#CCCCCC"> to manage and</font>

57
00:02:43,260 --> 00:02:47,429
if<font color="#E5E5E5"> you're in for if you don't have good</font>

58
00:02:46,170 --> 00:02:48,149
inventory<font color="#E5E5E5"> of what you're running</font><font color="#CCCCCC"> that</font>

59
00:02:47,430 --> 00:02:50,910
could be true

60
00:02:48,150 --> 00:02:52,440
you might enable<font color="#E5E5E5"> this and end up in a</font>

61
00:02:50,910 --> 00:02:55,709
<font color="#CCCCCC">situation that you can't manage your</font>

62
00:02:52,440 --> 00:02:57,540
rules<font color="#E5E5E5"> and all</font><font color="#CCCCCC"> the sudden a CEO is</font>

63
00:02:55,709 --> 00:02:58,769
knocking at your door saying why<font color="#CCCCCC"> can't I</font>

64
00:02:57,540 --> 00:03:01,170
<font color="#CCCCCC">open this PDF</font>

65
00:02:58,769 --> 00:03:02,700
I need<font color="#E5E5E5"> this PDF to send to a customer</font><font color="#CCCCCC"> or</font>

66
00:03:01,170 --> 00:03:08,010
<font color="#CCCCCC">not you turn off all your controls and</font>

67
00:03:02,700 --> 00:03:09,390
<font color="#E5E5E5">it failed it's</font><font color="#CCCCCC"> time-consuming</font><font color="#E5E5E5"> yep</font>

68
00:03:08,010 --> 00:03:12,200
Security's<font color="#CCCCCC"> time-consuming</font><font color="#E5E5E5"> I don't know</font>

69
00:03:09,390 --> 00:03:15,690
how to break<font color="#CCCCCC"> it any other</font><font color="#E5E5E5"> way than that</font>

70
00:03:12,200 --> 00:03:16,920
and it's not worth it<font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> a</font>

71
00:03:15,690 --> 00:03:18,660
decision<font color="#E5E5E5"> you and your business have to</font>

72
00:03:16,920 --> 00:03:20,280
<font color="#E5E5E5">make personally I think whitelisting is</font>

73
00:03:18,660 --> 00:03:22,769
worth it<font color="#CCCCCC"> I think if you're coming</font><font color="#E5E5E5"> from</font>

74
00:03:20,280 --> 00:03:26,250
<font color="#E5E5E5">information security and you've already</font>

75
00:03:22,769 --> 00:03:27,680
done<font color="#E5E5E5"> privileged control and you've</font>

76
00:03:26,250 --> 00:03:35,250
already done<font color="#CCCCCC"> it full disk encryption</font>

77
00:03:27,680 --> 00:03:37,019
<font color="#CCCCCC">maybe this is the</font><font color="#E5E5E5"> next step and so like</font>

78
00:03:35,250 --> 00:03:39,420
I<font color="#CCCCCC"> said good security takes work part of</font>

79
00:03:37,019 --> 00:03:41,640
<font color="#E5E5E5">your defense</font><font color="#CCCCCC"> in-depth</font><font color="#E5E5E5"> strategy so you're</font>

80
00:03:39,420 --> 00:03:44,250
not<font color="#CCCCCC"> relying on an</font><font color="#E5E5E5"> antivirus vendor to</font>

81
00:03:41,640 --> 00:03:46,230
update signatures<font color="#E5E5E5"> you're starting with a</font>

82
00:03:44,250 --> 00:03:49,530
<font color="#E5E5E5">deny all and white listing what should</font>

83
00:03:46,230 --> 00:03:50,578
work or what should run<font color="#CCCCCC"> if you put it</font>

84
00:03:49,530 --> 00:03:52,049
out<font color="#CCCCCC"> on your endpoints</font><font color="#E5E5E5"> you're</font><font color="#CCCCCC"> going to</font>

85
00:03:50,579 --> 00:03:53,280
prevent<font color="#E5E5E5"> your users from going out and</font>

86
00:03:52,049 --> 00:03:55,019
downloading<font color="#E5E5E5"> the next screensaver</font>

87
00:03:53,280 --> 00:03:57,480
application which happens to be

88
00:03:55,019 --> 00:03:58,920
cryptolocker<font color="#E5E5E5"> if they get a cryptolocker</font>

89
00:03:57,480 --> 00:04:01,100
in their email and they<font color="#CCCCCC"> double-click</font>

90
00:03:58,920 --> 00:04:03,480
that executable and they're all excited

91
00:04:01,100 --> 00:04:06,690
<font color="#E5E5E5">white listing might save you you might</font>

92
00:04:03,480 --> 00:04:08,160
save<font color="#E5E5E5"> your company</font><font color="#CCCCCC"> with it because your</font>

93
00:04:06,690 --> 00:04:10,709
default deny all will<font color="#E5E5E5"> not let that</font>

94
00:04:08,160 --> 00:04:12,840
executable run now if it's<font color="#CCCCCC"> sophisticated</font>

95
00:04:10,709 --> 00:04:15,090
<font color="#E5E5E5">it's going through</font><font color="#CCCCCC"> office and it's a VBA</font>

96
00:04:12,840 --> 00:04:18,840
malware and it's doing in memory maybe

97
00:04:15,090 --> 00:04:21,329
<font color="#CCCCCC">whitelisting won't help but uh</font><font color="#E5E5E5"> why take</font>

98
00:04:18,839 --> 00:04:23,520
the chances all right why not add

99
00:04:21,329 --> 00:04:25,110
another<font color="#CCCCCC"> layer</font><font color="#E5E5E5"> it also right raises</font><font color="#CCCCCC"> the</font>

100
00:04:23,520 --> 00:04:26,880
bar<font color="#CCCCCC"> for any active attacker attempting</font>

101
00:04:25,110 --> 00:04:28,590
to execute<font color="#E5E5E5"> code on the box so yes</font>

102
00:04:26,880 --> 00:04:30,270
there's bypasses but<font color="#E5E5E5"> maybe the person</font>

103
00:04:28,590 --> 00:04:31,650
who popped on your box doesn't<font color="#E5E5E5"> know</font>

104
00:04:30,270 --> 00:04:35,219
about<font color="#CCCCCC"> whitelisting maybe they've never</font>

105
00:04:31,650 --> 00:04:36,479
interacted<font color="#E5E5E5"> with maybe they're lazy right</font>

106
00:04:35,220 --> 00:04:38,460
<font color="#E5E5E5">I mean they get on the box and they try</font>

107
00:04:36,479 --> 00:04:40,590
<font color="#E5E5E5">to run you know</font><font color="#CCCCCC"> Metasploit and they get</font>

108
00:04:38,460 --> 00:04:42,099
oh<font color="#E5E5E5"> I can't run executables on this box</font>

109
00:04:40,590 --> 00:04:46,989
<font color="#E5E5E5">that's weird and they just move on</font>

110
00:04:42,100 --> 00:04:48,400
you know so why not application

111
00:04:46,990 --> 00:04:50,350
<font color="#CCCCCC">whitelisting so I'm going to I'm</font><font color="#E5E5E5"> gonna</font>

112
00:04:48,400 --> 00:04:52,030
tell you why<font color="#CCCCCC"> not to pay</font><font color="#E5E5E5"> attention to my</font>

113
00:04:50,350 --> 00:04:54,550
talk<font color="#E5E5E5"> if you're not doing</font><font color="#CCCCCC"> full disk</font>

114
00:04:52,030 --> 00:04:57,609
encryption<font color="#CCCCCC"> you're not doing credential</font>

115
00:04:54,550 --> 00:04:59,980
hygiene<font color="#CCCCCC"> you're your users are full admin</font>

116
00:04:57,610 --> 00:05:01,750
on their laptops<font color="#E5E5E5"> this is not a</font>

117
00:04:59,980 --> 00:05:03,580
<font color="#E5E5E5">technology for you you're you need to</font>

118
00:05:01,750 --> 00:05:06,100
<font color="#CCCCCC">mature your</font><font color="#E5E5E5"> security organization</font><font color="#CCCCCC"> before</font>

119
00:05:03,580 --> 00:05:08,020
you invest this time because this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

120
00:05:06,100 --> 00:05:12,160
<font color="#E5E5E5">time consuming</font><font color="#CCCCCC"> process to implement this</font>

121
00:05:08,020 --> 00:05:14,260
across<font color="#CCCCCC"> your organization so right here I</font>

122
00:05:12,160 --> 00:05:17,770
reference<font color="#E5E5E5"> Jessica Payne's build the</font>

123
00:05:14,260 --> 00:05:20,950
attackers playground<font color="#E5E5E5"> it's a pretty good</font>

124
00:05:17,770 --> 00:05:22,359
checklist if if you use that to go over

125
00:05:20,950 --> 00:05:26,170
your environment<font color="#CCCCCC"> and</font><font color="#E5E5E5"> say yes I'm doing</font>

126
00:05:22,360 --> 00:05:27,730
<font color="#E5E5E5">that yes I'm doing that you know that's</font>

127
00:05:26,170 --> 00:05:30,150
a good place<font color="#CCCCCC"> to start maybe maybe</font>

128
00:05:27,730 --> 00:05:33,390
that'll give you some ideas<font color="#CCCCCC"> like laps</font>

129
00:05:30,150 --> 00:05:36,010
<font color="#CCCCCC">local administration password</font><font color="#E5E5E5"> management</font>

130
00:05:33,390 --> 00:05:37,510
<font color="#CCCCCC">also the</font><font color="#E5E5E5"> person talking after me a</font>

131
00:05:36,010 --> 00:05:40,060
gentleman named Eric<font color="#CCCCCC"> who I met earlier</font>

132
00:05:37,510 --> 00:05:41,409
<font color="#E5E5E5">his talk is easy wins</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> Active</font>

133
00:05:40,060 --> 00:05:43,480
Directory so he might<font color="#E5E5E5"> give you some</font>

134
00:05:41,410 --> 00:05:49,660
other<font color="#E5E5E5"> ideas</font><font color="#CCCCCC"> to do before you take on</font>

135
00:05:43,480 --> 00:05:50,620
<font color="#CCCCCC">waitlisting and so what is whitelisting</font>

136
00:05:49,660 --> 00:05:52,510
like<font color="#CCCCCC"> I</font><font color="#E5E5E5"> said</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to take</font><font color="#E5E5E5"> you to</font>

137
00:05:50,620 --> 00:05:55,360
zero to hero<font color="#E5E5E5"> and so this is the NIST</font>

138
00:05:52,510 --> 00:05:58,840
definition<font color="#E5E5E5"> application whitelisting</font>

139
00:05:55,360 --> 00:06:00,310
technologies<font color="#E5E5E5"> use white lists to control</font>

140
00:05:58,840 --> 00:06:02,799
which applications<font color="#E5E5E5"> are permitted to</font>

141
00:06:00,310 --> 00:06:04,510
<font color="#E5E5E5">execute on a host this helps to stop the</font>

142
00:06:02,800 --> 00:06:06,190
<font color="#E5E5E5">execution of malware on licensed</font>

143
00:06:04,510 --> 00:06:09,520
<font color="#CCCCCC">software and other odd unauthorized</font>

144
00:06:06,190 --> 00:06:12,550
software<font color="#CCCCCC"> I don't know I</font><font color="#E5E5E5"> miss definitions</font>

145
00:06:09,520 --> 00:06:15,430
always I get lost there<font color="#E5E5E5"> I don't know</font>

146
00:06:12,550 --> 00:06:17,710
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> their government standards so I'm</font>

147
00:06:15,430 --> 00:06:19,060
gonna walk<font color="#CCCCCC"> you through</font><font color="#E5E5E5"> it so let's say</font>

148
00:06:17,710 --> 00:06:22,090
you're running your computer<font color="#CCCCCC"> and you and</font>

149
00:06:19,060 --> 00:06:23,560
and<font color="#E5E5E5"> you want to open</font><font color="#CCCCCC"> up utorrent if you</font>

150
00:06:22,090 --> 00:06:25,390
don't have a<font color="#CCCCCC"> B you</font><font color="#E5E5E5"> don't have a white</font>

151
00:06:23,560 --> 00:06:27,640
listing it just works<font color="#E5E5E5"> your</font><font color="#CCCCCC"> computer's</font>

152
00:06:25,390 --> 00:06:31,210
loves running code it's gonna work like

153
00:06:27,640 --> 00:06:33,760
a champ<font color="#E5E5E5"> so you take the next step you've</font>

154
00:06:31,210 --> 00:06:36,130
installed<font color="#E5E5E5"> antivirus and you got a</font>

155
00:06:33,760 --> 00:06:38,710
naughty list<font color="#CCCCCC"> so now anything</font><font color="#E5E5E5"> that's</font>

156
00:06:36,130 --> 00:06:41,200
known bad it will<font color="#E5E5E5"> be blocked that's</font>

157
00:06:38,710 --> 00:06:44,020
great<font color="#CCCCCC"> you know</font><font color="#E5E5E5"> the next generation anti</font>

158
00:06:41,200 --> 00:06:45,820
<font color="#CCCCCC">viruses are using machine learning but</font>

159
00:06:44,020 --> 00:06:47,950
effectively<font color="#E5E5E5"> they</font><font color="#CCCCCC"> can only stop what</font>

160
00:06:45,820 --> 00:06:49,330
they've noticed<font color="#CCCCCC"> stopped they're gonna if</font>

161
00:06:47,950 --> 00:06:51,909
they don't recognize<font color="#CCCCCC"> that as malicious</font>

162
00:06:49,330 --> 00:06:55,450
they're gonna let<font color="#CCCCCC"> it run and so as of</font>

163
00:06:51,910 --> 00:06:56,139
2017 November 11th<font color="#E5E5E5"> utorrent was</font>

164
00:06:55,450 --> 00:06:57,669
classified

165
00:06:56,139 --> 00:07:01,840
not<font color="#E5E5E5"> malicious and</font><font color="#CCCCCC"> so it's gonna run on a</font>

166
00:06:57,669 --> 00:07:04,270
<font color="#CCCCCC">V it's just gonna</font><font color="#E5E5E5"> happen so if you have</font>

167
00:07:01,840 --> 00:07:05,888
application whitelisting solution it's

168
00:07:04,270 --> 00:07:08,498
not<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> get that far it's gonna</font>

169
00:07:05,889 --> 00:07:11,169
stop it at<font color="#E5E5E5"> the kernel level</font><font color="#CCCCCC"> so if you're</font>

170
00:07:08,499 --> 00:07:13,599
on Windows this is going to block<font color="#CCCCCC"> before</font>

171
00:07:11,169 --> 00:07:14,948
<font color="#E5E5E5">you</font><font color="#CCCCCC"> AC and if you're on Mac it's gonna</font>

172
00:07:13,599 --> 00:07:16,330
stop you I don't know what the process

173
00:07:14,949 --> 00:07:18,490
<font color="#E5E5E5">is called we get that little thing that</font>

174
00:07:16,330 --> 00:07:21,669
says you have<font color="#CCCCCC"> to go into security</font><font color="#E5E5E5"> to run</font>

175
00:07:18,490 --> 00:07:28,360
it that's what<font color="#CCCCCC"> waitlisting is for it's</font>

176
00:07:21,669 --> 00:07:30,580
to stop it before code<font color="#E5E5E5"> executes</font><font color="#CCCCCC"> alright</font>

177
00:07:28,360 --> 00:07:33,219
so<font color="#E5E5E5"> some foundational terms</font><font color="#CCCCCC"> once again</font>

178
00:07:30,580 --> 00:07:35,770
zero to hero stuff<font color="#CCCCCC"> app</font><font color="#E5E5E5"> Locker</font>

179
00:07:33,219 --> 00:07:39,189
<font color="#CCCCCC">as I mentioned is a Microsoft Windows</font>

180
00:07:35,770 --> 00:07:43,240
<font color="#E5E5E5">built in an application</font><font color="#CCCCCC"> google santa has</font>

181
00:07:39,189 --> 00:07:46,120
an<font color="#CCCCCC"> open-source</font><font color="#E5E5E5"> tool for mac OS so an</font>

182
00:07:43,240 --> 00:07:49,139
application signature an application

183
00:07:46,120 --> 00:07:51,069
signature is a digital signature that

184
00:07:49,139 --> 00:07:54,310
validates<font color="#E5E5E5"> that an application</font><font color="#CCCCCC"> is</font>

185
00:07:51,069 --> 00:07:56,020
authentic<font color="#E5E5E5"> from a specific publisher and</font>

186
00:07:54,310 --> 00:07:57,729
this of course<font color="#CCCCCC"> assumes that the</font>

187
00:07:56,020 --> 00:08:01,029
certificate supply chain has not been

188
00:07:57,729 --> 00:08:03,128
breached<font color="#E5E5E5"> as we know that can not always</font>

189
00:08:01,029 --> 00:08:05,099
<font color="#E5E5E5">be relied on we've had we've seen</font>

190
00:08:03,129 --> 00:08:11,069
antivirus vendors lose their certs

191
00:08:05,099 --> 00:08:11,069
that happens<font color="#E5E5E5"> if CC cleaner</font>

192
00:08:13,870 --> 00:08:17,870
absolutely<font color="#E5E5E5"> and so you're only as secure</font>

193
00:08:16,310 --> 00:08:20,780
as your supply<font color="#CCCCCC"> chain with application</font>

194
00:08:17,870 --> 00:08:23,180
signature<font color="#E5E5E5"> so in this case know what your</font>

195
00:08:20,780 --> 00:08:24,679
security<font color="#E5E5E5"> boundary is in this case we're</font>

196
00:08:23,180 --> 00:08:28,219
using application signature as a

197
00:08:24,680 --> 00:08:28,879
security boundary you know that's that's

198
00:08:28,219 --> 00:08:31,159
reality

199
00:08:28,879 --> 00:08:34,430
another option is<font color="#E5E5E5"> application hash</font>

200
00:08:31,159 --> 00:08:36,549
<font color="#E5E5E5">that's a</font><font color="#CCCCCC"> mathematical representation of</font>

201
00:08:34,429 --> 00:08:39,978
an executable<font color="#E5E5E5"> that's difficult to spoof</font>

202
00:08:36,549 --> 00:08:41,838
<font color="#E5E5E5">so if you did sha-1 sha-1 broke a couple</font>

203
00:08:39,979 --> 00:08:44,329
<font color="#CCCCCC">of years ago</font><font color="#E5E5E5"> so maybe that's not a good</font>

204
00:08:41,839 --> 00:08:46,940
security<font color="#E5E5E5"> boundary anymore</font><font color="#CCCCCC"> it's also</font><font color="#E5E5E5"> hard</font>

205
00:08:44,329 --> 00:08:49,370
to<font color="#E5E5E5"> keep up so if you patch windows</font><font color="#CCCCCC"> all</font>

206
00:08:46,940 --> 00:08:51,680
<font color="#CCCCCC">those hashes</font><font color="#E5E5E5"> are gonna change</font><font color="#CCCCCC"> that's not</font>

207
00:08:49,370 --> 00:08:53,990
a<font color="#CCCCCC"> sustainable way to to build</font><font color="#E5E5E5"> your rules</font>

208
00:08:51,680 --> 00:09:00,349
on but sometimes<font color="#E5E5E5"> applications aren't</font>

209
00:08:53,990 --> 00:09:02,540
signed and<font color="#E5E5E5"> you have to they are</font>

210
00:09:00,350 --> 00:09:04,970
different device guard is more

211
00:09:02,540 --> 00:09:07,730
sophisticated<font color="#E5E5E5"> it requires for</font><font color="#CCCCCC"> its more</font>

212
00:09:04,970 --> 00:09:11,300
<font color="#E5E5E5">in-depth functionality needs TPM chips</font>

213
00:09:07,730 --> 00:09:14,560
<font color="#CCCCCC">I'm less familiar with</font><font color="#E5E5E5"> it but yeah</font>

214
00:09:11,300 --> 00:09:14,560
they're<font color="#E5E5E5"> they're different products</font>

215
00:09:15,370 --> 00:09:19,970
application paths<font color="#E5E5E5"> so that's easy that's</font>

216
00:09:17,570 --> 00:09:29,149
<font color="#CCCCCC">the directory that the execute the</font>

217
00:09:19,970 --> 00:09:31,790
executable launches<font color="#E5E5E5"> from nope still</font>

218
00:09:29,149 --> 00:09:33,920
still<font color="#E5E5E5"> app Locker</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> if you're familiar</font>

219
00:09:31,790 --> 00:09:35,689
with<font color="#E5E5E5"> it</font><font color="#CCCCCC"> from Windows</font><font color="#E5E5E5"> 7 it's still gonna</font>

220
00:09:33,920 --> 00:09:49,870
<font color="#CCCCCC">be about the</font><font color="#E5E5E5"> same I go into the</font>

221
00:09:35,690 --> 00:09:53,000
differences though between<font color="#CCCCCC"> 7</font><font color="#E5E5E5"> and 10 so</font>

222
00:09:49,870 --> 00:09:55,130
if if you mean<font color="#E5E5E5"> so a signature is a</font>

223
00:09:53,000 --> 00:09:57,410
digital<font color="#CCCCCC"> certificate of</font><font color="#E5E5E5"> the executable</font>

224
00:09:55,130 --> 00:09:59,630
and<font color="#CCCCCC"> so if you were to say</font><font color="#E5E5E5"> open</font><font color="#CCCCCC"> up any</font>

225
00:09:57,410 --> 00:10:01,100
Microsoft executable on<font color="#E5E5E5"> Windows right</font>

226
00:09:59,630 --> 00:10:03,350
click go<font color="#E5E5E5"> to properties you'll see a</font>

227
00:10:01,100 --> 00:10:06,470
<font color="#E5E5E5">little certificate</font><font color="#CCCCCC"> that means that that</font>

228
00:10:03,350 --> 00:10:10,820
application<font color="#CCCCCC"> has been signed</font><font color="#E5E5E5"> so if you so</font>

229
00:10:06,470 --> 00:10:12,470
the hash<font color="#E5E5E5"> or signature the hash is</font>

230
00:10:10,820 --> 00:10:15,140
different from<font color="#E5E5E5"> that the hash is if you</font>

231
00:10:12,470 --> 00:10:16,760
took say md5<font color="#E5E5E5"> you could run a calculation</font>

232
00:10:15,140 --> 00:10:20,500
on them on the executable<font color="#CCCCCC"> and</font><font color="#E5E5E5"> get a</font>

233
00:10:16,760 --> 00:10:20,500
<font color="#E5E5E5">value and check it yeah</font>

234
00:10:20,589 --> 00:10:24,749
so basically<font color="#E5E5E5"> how like a file</font><font color="#CCCCCC"> of code</font>

235
00:10:28,649 --> 00:10:34,839
<font color="#CCCCCC">that's correct yes and with certificates</font>

236
00:10:32,230 --> 00:10:37,120
that that if the code has been<font color="#E5E5E5"> modified</font>

237
00:10:34,839 --> 00:10:45,879
<font color="#E5E5E5">the certificate will no longer be valid</font>

238
00:10:37,120 --> 00:10:47,529
for<font color="#E5E5E5"> the code well there</font><font color="#CCCCCC"> just won't be</font>

239
00:10:45,879 --> 00:10:49,029
signed anymore or at least<font color="#E5E5E5"> the signature</font>

240
00:10:47,529 --> 00:10:51,309
will be<font color="#E5E5E5"> invalid now I could be wrong I</font>

241
00:10:49,029 --> 00:10:55,170
don't<font color="#E5E5E5"> know</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> in depth so you do your</font>

242
00:10:51,309 --> 00:10:55,170
research<font color="#CCCCCC"> if I'm wrong I apologize</font>

243
00:11:04,930 --> 00:11:09,060
<font color="#E5E5E5">first iteration</font>

244
00:11:09,950 --> 00:11:13,750
that can absolutely<font color="#E5E5E5"> happen yep</font>

245
00:11:14,660 --> 00:11:18,140
yeah the person<font color="#E5E5E5"> who developed</font><font color="#CCCCCC"> the</font>

246
00:11:16,880 --> 00:11:21,200
application we have to update it<font color="#CCCCCC"> yeah</font>

247
00:11:18,140 --> 00:11:24,140
<font color="#E5E5E5">and in Windows 10 Windows 10 and 16 is</font>

248
00:11:21,200 --> 00:11:25,550
doing certificate<font color="#E5E5E5"> revocation</font><font color="#CCCCCC"> I don't</font>

249
00:11:24,140 --> 00:11:27,590
<font color="#CCCCCC">think that Windows haven't had that</font>

250
00:11:25,550 --> 00:11:35,329
functionality<font color="#CCCCCC"> I'm not a hundred percent</font>

251
00:11:27,590 --> 00:11:37,810
<font color="#CCCCCC">on that you'd be amazed how long</font>

252
00:11:35,330 --> 00:11:40,550
operating systems live in the wild

253
00:11:37,810 --> 00:11:44,510
having come having lived in industrial

254
00:11:40,550 --> 00:11:50,079
control<font color="#E5E5E5"> I I've seen I've</font><font color="#CCCCCC"> seen things</font>

255
00:11:44,510 --> 00:11:50,080
like<font color="#E5E5E5"> NT 3.1 and when in</font><font color="#CCCCCC"> 2012</font>

256
00:11:51,490 --> 00:11:55,880
<font color="#E5E5E5">anyway it's okay so uh just</font><font color="#CCCCCC"> moving</font>

257
00:11:54,920 --> 00:11:58,550
swiftly onwards

258
00:11:55,880 --> 00:12:00,860
so when<font color="#E5E5E5"> AppLocker interruption</font><font color="#CCCCCC"> it</font>

259
00:11:58,550 --> 00:12:05,209
requires Server 2008<font color="#E5E5E5"> and it requires</font>

260
00:12:00,860 --> 00:12:07,400
Enterprise Windows<font color="#CCCCCC"> 7 this</font><font color="#E5E5E5"> is different I</font>

261
00:12:05,210 --> 00:12:10,130
<font color="#CCCCCC">think you mentioned</font><font color="#E5E5E5"> software restriction</font>

262
00:12:07,400 --> 00:12:12,560
policies<font color="#E5E5E5"> so if you don't have enterprise</font>

263
00:12:10,130 --> 00:12:15,770
software restriction policies is a

264
00:12:12,560 --> 00:12:18,050
separate product that predates<font color="#CCCCCC"> AppLocker</font>

265
00:12:15,770 --> 00:12:19,970
<font color="#E5E5E5">you can use that on the professional</font>

266
00:12:18,050 --> 00:12:22,189
editions<font color="#CCCCCC"> I think it still exists in</font>

267
00:12:19,970 --> 00:12:25,130
Windows 10<font color="#CCCCCC"> um not don't quote me on that</font>

268
00:12:22,190 --> 00:12:27,760
I've<font color="#E5E5E5"> net I haven't used it so for</font>

269
00:12:25,130 --> 00:12:30,950
enterprise<font color="#E5E5E5"> you app Locker absolutely</font>

270
00:12:27,760 --> 00:12:32,000
<font color="#E5E5E5">education I am mostly certain concludes</font>

271
00:12:30,950 --> 00:12:34,970
<font color="#E5E5E5">app Locker</font>

272
00:12:32,000 --> 00:12:37,360
<font color="#E5E5E5">well</font><font color="#CCCCCC"> I by reviewing the docs I remember</font>

273
00:12:34,970 --> 00:12:40,870
them<font color="#CCCCCC"> saying that but do your homework</font>

274
00:12:37,360 --> 00:12:40,870
<font color="#E5E5E5">any other questions</font>

275
00:12:46,090 --> 00:12:56,480
<font color="#CCCCCC">I'm not entirely certain no so</font><font color="#E5E5E5"> I'll go</font>

276
00:12:54,890 --> 00:12:59,120
into how you build the<font color="#E5E5E5"> rule so it</font>

277
00:12:56,480 --> 00:13:01,160
<font color="#E5E5E5">probably depends on how PowerShell got</font>

278
00:12:59,120 --> 00:13:03,740
launched so if it's in memory<font color="#E5E5E5"> AppLocker</font>

279
00:13:01,160 --> 00:13:06,620
might not give<font color="#CCCCCC"> you that granularity that</font>

280
00:13:03,740 --> 00:13:08,570
which is some<font color="#E5E5E5"> of the bypasses</font><font color="#CCCCCC"> I'm not a</font>

281
00:13:06,620 --> 00:13:11,660
hundred<font color="#E5E5E5"> percent certain I can't talk to</font>

282
00:13:08,570 --> 00:13:13,370
the bypasses specifically any other

283
00:13:11,660 --> 00:13:15,260
questions so<font color="#CCCCCC"> like it</font><font color="#E5E5E5"> so file types</font>

284
00:13:13,370 --> 00:13:17,870
<font color="#E5E5E5">packaged apps which is that new Windows</font>

285
00:13:15,260 --> 00:13:21,350
Store<font color="#E5E5E5"> method of delivering</font><font color="#CCCCCC"> applications</font>

286
00:13:17,870 --> 00:13:23,720
you have<font color="#CCCCCC"> DLLs treat DL treat dll's as</font>

287
00:13:21,350 --> 00:13:25,280
executables you absolutely<font color="#E5E5E5"> they're just</font>

288
00:13:23,720 --> 00:13:29,930
they're just exe<font color="#E5E5E5"> is in a different</font>

289
00:13:25,280 --> 00:13:31,189
wrapper<font color="#CCCCCC"> xes installers scripts so that's</font>

290
00:13:29,930 --> 00:13:33,849
how you base your that's how you start

291
00:13:31,190 --> 00:13:33,850
building your rules

292
00:13:41,620 --> 00:13:47,180
<font color="#CCCCCC">No so so what I mean</font><font color="#E5E5E5"> by Server 2008</font><font color="#CCCCCC"> is</font>

293
00:13:45,320 --> 00:13:50,779
that you can if you have<font color="#CCCCCC"> a non domain</font>

294
00:13:47,180 --> 00:13:53,660
joint 2008<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> you can just use</font>

295
00:13:50,779 --> 00:13:56,029
local group policy<font color="#CCCCCC"> to enable it which is</font>

296
00:13:53,660 --> 00:13:58,069
an<font color="#E5E5E5"> excellent segue and to</font><font color="#CCCCCC"> hear</font>

297
00:13:56,029 --> 00:13:59,180
<font color="#E5E5E5">let's implementation prerequisites so</font>

298
00:13:58,070 --> 00:14:01,790
you need to be able<font color="#E5E5E5"> to run the</font>

299
00:13:59,180 --> 00:14:03,709
application<font color="#E5E5E5"> identity service so that</font>

300
00:14:01,790 --> 00:14:05,810
identifies the applications running<font color="#E5E5E5"> on</font>

301
00:14:03,709 --> 00:14:07,699
your system<font color="#CCCCCC"> so if you implement</font><font color="#E5E5E5"> this</font>

302
00:14:05,810 --> 00:14:08,959
that's<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of a cool alert because if</font>

303
00:14:07,700 --> 00:14:12,230
that service stops it means<font color="#E5E5E5"> your</font>

304
00:14:08,959 --> 00:14:15,649
whitelisting stopped<font color="#CCCCCC"> so in Windows</font><font color="#E5E5E5"> 7</font>

305
00:14:12,230 --> 00:14:17,810
<font color="#E5E5E5">through 2012 r2</font><font color="#CCCCCC"> you just set it to</font>

306
00:14:15,649 --> 00:14:20,209
automatic<font color="#E5E5E5"> and you're good to</font><font color="#CCCCCC"> go if</font>

307
00:14:17,810 --> 00:14:22,699
you're on<font color="#E5E5E5"> 10 or 2016 it's a protected</font>

308
00:14:20,209 --> 00:14:23,540
service<font color="#E5E5E5"> which is a different way that</font>

309
00:14:22,700 --> 00:14:27,680
<font color="#CCCCCC">service is launched</font>

310
00:14:23,540 --> 00:14:30,620
so on 2010<font color="#E5E5E5"> - 2016 you're supposed to use</font>

311
00:14:27,680 --> 00:14:32,180
a domain<font color="#E5E5E5"> there so I might</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> a</font>

312
00:14:30,620 --> 00:14:34,040
<font color="#E5E5E5">reference slide that walks through</font><font color="#CCCCCC"> all</font>

313
00:14:32,180 --> 00:14:36,979
<font color="#CCCCCC">of that and the reason I don't</font><font color="#E5E5E5"> talk</font>

314
00:14:34,040 --> 00:14:38,959
<font color="#CCCCCC">about</font><font color="#E5E5E5"> it take half the time to walk you</font>

315
00:14:36,980 --> 00:14:41,209
through<font color="#E5E5E5"> it if you have</font><font color="#CCCCCC"> a non domain</font>

316
00:14:38,959 --> 00:14:43,430
machine<font color="#E5E5E5"> tech</font><font color="#CCCCCC"> what Microsoft's</font>

317
00:14:41,209 --> 00:14:45,649
documentation<font color="#E5E5E5"> does not allow you to run</font>

318
00:14:43,430 --> 00:14:49,160
<font color="#CCCCCC">a plonker but it's a registry hack away</font>

319
00:14:45,649 --> 00:14:51,620
<font color="#CCCCCC">so your mileage may vary with how well</font>

320
00:14:49,160 --> 00:14:53,019
<font color="#E5E5E5">that's supported but in my testing it</font>

321
00:14:51,620 --> 00:14:59,120
worked<font color="#E5E5E5"> great</font>

322
00:14:53,019 --> 00:15:00,829
any questions<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so for all of</font><font color="#CCCCCC"> you</font>

323
00:14:59,120 --> 00:15:03,140
who have<font color="#CCCCCC"> never been within group policy</font>

324
00:15:00,829 --> 00:15:06,099
<font color="#E5E5E5">go into a Windows machine type</font>

325
00:15:03,140 --> 00:15:10,010
gpedit.msc<font color="#CCCCCC"> and you'll get</font><font color="#E5E5E5"> this friendly</font>

326
00:15:06,100 --> 00:15:12,140
<font color="#CCCCCC">drop-down</font><font color="#E5E5E5"> this is where if you</font><font color="#CCCCCC"> can set</font>

327
00:15:10,010 --> 00:15:14,110
<font color="#CCCCCC">everything</font><font color="#E5E5E5"> those of you who use</font><font color="#CCCCCC"> group</font>

328
00:15:12,140 --> 00:15:22,480
policy<font color="#CCCCCC"> for</font><font color="#E5E5E5"> years and know it and love</font><font color="#CCCCCC"> it</font>

329
00:15:14,110 --> 00:15:22,480
<font color="#CCCCCC">there it</font><font color="#E5E5E5"> is policies rules</font>

330
00:15:24,630 --> 00:15:30,280
so to enable DLL rules you<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to go</font>

331
00:15:27,820 --> 00:15:32,710
into<font color="#E5E5E5"> the properties and check a checkbox</font>

332
00:15:30,280 --> 00:15:34,390
<font color="#E5E5E5">you get a warning</font><font color="#CCCCCC"> that says</font><font color="#E5E5E5"> hey this</font>

333
00:15:32,710 --> 00:15:36,400
might<font color="#CCCCCC"> affect your system performance I</font>

334
00:15:34,390 --> 00:15:37,990
have no idea how this is<font color="#E5E5E5"> gonna affect</font>

335
00:15:36,400 --> 00:15:40,840
<font color="#E5E5E5">your</font><font color="#CCCCCC"> system performance I've never seen</font>

336
00:15:37,990 --> 00:15:45,100
it<font color="#CCCCCC"> caused issues</font><font color="#E5E5E5"> maybe if you're running</font>

337
00:15:40,840 --> 00:15:46,390
<font color="#E5E5E5">at minimum spec it would but something</font>

338
00:15:45,100 --> 00:15:48,070
you<font color="#E5E5E5"> can do</font><font color="#CCCCCC"> today if</font><font color="#E5E5E5"> you're if you're</font>

339
00:15:46,390 --> 00:15:51,689
<font color="#CCCCCC">running a Windows environment to do this</font>

340
00:15:48,070 --> 00:15:53,830
turn<font color="#E5E5E5"> on logging increase your telemetry</font>

341
00:15:51,690 --> 00:15:55,810
<font color="#E5E5E5">you could do this to every machine in</font>

342
00:15:53,830 --> 00:15:57,940
<font color="#E5E5E5">your environment today and start</font><font color="#CCCCCC"> logging</font>

343
00:15:55,810 --> 00:16:00,969
every application<font color="#CCCCCC"> every script that runs</font>

344
00:15:57,940 --> 00:16:03,040
<font color="#E5E5E5">on that box</font><font color="#CCCCCC"> that's super powerful if you</font>

345
00:16:00,970 --> 00:16:05,980
have a cryptolocker<font color="#CCCCCC"> go through your</font>

346
00:16:03,040 --> 00:16:08,800
<font color="#CCCCCC">environment you'll log it if if</font>

347
00:16:05,980 --> 00:16:10,860
someone's running executables or scripts

348
00:16:08,800 --> 00:16:19,750
<font color="#E5E5E5">and they've been doing it</font><font color="#CCCCCC"> for years</font>

349
00:16:10,860 --> 00:16:21,130
<font color="#E5E5E5">that's how you backtrack exactly the</font>

350
00:16:19,750 --> 00:16:24,270
computer will keep a record of

351
00:16:21,130 --> 00:16:27,880
everything that<font color="#E5E5E5"> launched on</font><font color="#CCCCCC"> the machine</font>

352
00:16:24,270 --> 00:16:28,870
it's no different well<font color="#E5E5E5"> as far as I'm</font>

353
00:16:27,880 --> 00:16:31,060
aware it's no different than<font color="#E5E5E5"> any other</font>

354
00:16:28,870 --> 00:16:32,770
<font color="#E5E5E5">Windows event logging</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so if you</font>

355
00:16:31,060 --> 00:16:34,839
have your rotation set up appropriately

356
00:16:32,770 --> 00:16:37,390
and archiving shouldn't be an<font color="#E5E5E5"> issue if</font>

357
00:16:34,840 --> 00:16:40,300
you let your security<font color="#E5E5E5"> log run</font><font color="#CCCCCC"> till it's</font>

358
00:16:37,390 --> 00:16:43,449
full<font color="#CCCCCC"> and that's gonna run till it's full</font>

359
00:16:40,300 --> 00:16:44,890
<font color="#CCCCCC">- but in terms of</font><font color="#E5E5E5"> overhead it's no more</font>

360
00:16:43,450 --> 00:16:47,650
overhead than<font color="#E5E5E5"> running a blocker in</font>

361
00:16:44,890 --> 00:16:49,420
itself I've never like I said I've<font color="#CCCCCC"> never</font>

362
00:16:47,650 --> 00:16:52,319
seen a system degradation this is built

363
00:16:49,420 --> 00:16:52,319
into<font color="#E5E5E5"> the operating system</font>

364
00:16:58,220 --> 00:17:04,579
<font color="#E5E5E5">you would have to do log aggregation</font>

365
00:17:00,280 --> 00:17:10,430
<font color="#CCCCCC">such as any other when you write you use</font>

366
00:17:04,579 --> 00:17:16,159
the<font color="#E5E5E5"> product of choice</font><font color="#CCCCCC"> a CCM</font><font color="#E5E5E5"> elk any</font>

367
00:17:10,430 --> 00:17:18,020
other questions<font color="#E5E5E5"> all right so what do</font>

368
00:17:16,160 --> 00:17:19,280
those logs look<font color="#E5E5E5"> like so once again if</font>

369
00:17:18,020 --> 00:17:21,639
you're brand new to Windows<font color="#CCCCCC"> and</font><font color="#E5E5E5"> you've</font>

370
00:17:19,280 --> 00:17:24,280
never<font color="#CCCCCC"> opened up</font><font color="#E5E5E5"> Event Viewer</font>

371
00:17:21,640 --> 00:17:26,600
<font color="#CCCCCC">you go to you search for Event Viewer</font>

372
00:17:24,280 --> 00:17:29,360
<font color="#E5E5E5">application services Microsoft Windows</font>

373
00:17:26,599 --> 00:17:30,530
app Locker<font color="#E5E5E5"> and then you'll have three</font>

374
00:17:29,360 --> 00:17:32,959
different<font color="#E5E5E5"> groups for different</font><font color="#CCCCCC"> groups</font>

375
00:17:30,530 --> 00:17:34,670
<font color="#E5E5E5">and then you'll have some</font><font color="#CCCCCC"> details so</font>

376
00:17:32,960 --> 00:17:36,950
this will tell you what's blocked<font color="#E5E5E5"> what's</font>

377
00:17:34,670 --> 00:17:39,920
allowed the groups<font color="#E5E5E5"> and users affected by</font>

378
00:17:36,950 --> 00:17:41,630
the role<font color="#E5E5E5"> rule type and so you got event</font>

379
00:17:39,920 --> 00:17:43,880
IDs<font color="#E5E5E5"> they're unique so you can build</font><font color="#CCCCCC"> your</font>

380
00:17:41,630 --> 00:17:54,320
alerts on these<font color="#E5E5E5"> events if you're using</font>

381
00:17:43,880 --> 00:17:56,390
<font color="#CCCCCC">Splunk it's a so the bit core concept is</font>

382
00:17:54,320 --> 00:17:59,179
you have lots of<font color="#E5E5E5"> endpoints</font><font color="#CCCCCC"> and they feed</font>

383
00:17:56,390 --> 00:18:02,900
logs<font color="#E5E5E5"> into a centralized location</font><font color="#CCCCCC"> for</font>

384
00:17:59,180 --> 00:18:05,300
security analysts to monitor and make

385
00:18:02,900 --> 00:18:10,880
<font color="#CCCCCC">decisions and I don't know spunked super</font>

386
00:18:05,300 --> 00:18:13,240
well either<font color="#CCCCCC"> but I</font><font color="#E5E5E5"> think that's a yeah no</font>

387
00:18:10,880 --> 00:18:18,670
no it's<font color="#E5E5E5"> very crazy</font>

388
00:18:13,240 --> 00:18:23,080
<font color="#CCCCCC">a good one</font><font color="#E5E5E5"> a good</font><font color="#CCCCCC"> one to look</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> is</font>

389
00:18:18,670 --> 00:18:24,910
alienvault for free alienvault<font color="#E5E5E5"> is a good</font>

390
00:18:23,080 --> 00:18:27,669
free version no need to have an open<font color="#CCCCCC"> elk</font>

391
00:18:24,910 --> 00:18:29,920
stack<font color="#E5E5E5"> elk stack also has good for free</font>

392
00:18:27,670 --> 00:18:31,900
logging

393
00:18:29,920 --> 00:18:54,760
yes<font color="#CCCCCC"> Blanc's definitely not free if you</font>

394
00:18:31,900 --> 00:18:55,450
put enough logs in it cool<font color="#E5E5E5"> that does</font>

395
00:18:54,760 --> 00:19:14,830
sound awesome

396
00:18:55,450 --> 00:19:16,480
<font color="#E5E5E5">I should look</font><font color="#CCCCCC"> for that</font><font color="#E5E5E5"> you could do it</font>

397
00:19:14,830 --> 00:19:18,310
in<font color="#CCCCCC"> professional so the logging</font>

398
00:19:16,480 --> 00:19:19,870
capabilities<font color="#E5E5E5"> and usually there's an</font>

399
00:19:18,310 --> 00:19:27,010
agent that<font color="#E5E5E5"> will back haul the logs back</font>

400
00:19:19,870 --> 00:19:29,949
<font color="#CCCCCC">so you could do that in professional you</font>

401
00:19:27,010 --> 00:19:32,080
could<font color="#E5E5E5"> yeah it with the correct agent</font>

402
00:19:29,950 --> 00:19:33,460
running on the<font color="#E5E5E5"> end point yeah you don't</font>

403
00:19:32,080 --> 00:19:38,050
<font color="#E5E5E5">you don't need Enterprise Edition for</font>

404
00:19:33,460 --> 00:19:39,790
that but there would be<font color="#E5E5E5"> some</font><font color="#CCCCCC"> setup so</font>

405
00:19:38,050 --> 00:19:43,540
<font color="#E5E5E5">let's talk defaults so there's a bunch</font>

406
00:19:39,790 --> 00:19:46,480
of default<font color="#E5E5E5"> rules</font><font color="#CCCCCC"> defaults are for</font>

407
00:19:43,540 --> 00:19:48,340
dummies<font color="#E5E5E5"> these are terrible</font><font color="#CCCCCC"> I mean if</font>

408
00:19:46,480 --> 00:19:51,730
you're stuck<font color="#E5E5E5"> and you need something</font><font color="#CCCCCC"> then</font>

409
00:19:48,340 --> 00:19:54,370
I guess they work but so the executable

410
00:19:51,730 --> 00:19:56,410
rules allows everyone to<font color="#E5E5E5"> run anything in</font>

411
00:19:54,370 --> 00:19:59,229
Program Files<font color="#E5E5E5"> and windows and then</font>

412
00:19:56,410 --> 00:20:01,420
<font color="#CCCCCC">what's admins run anything anywhere why</font>

413
00:19:59,230 --> 00:20:04,330
is that bad it's bad because<font color="#E5E5E5"> printer</font>

414
00:20:01,420 --> 00:20:06,610
drivers will allow<font color="#E5E5E5"> users to</font><font color="#CCCCCC"> write to the</font>

415
00:20:04,330 --> 00:20:08,620
windows<font color="#CCCCCC"> directory</font><font color="#E5E5E5"> and so one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

416
00:20:06,610 --> 00:20:10,270
known bypasses out there is a script

417
00:20:08,620 --> 00:20:13,959
that<font color="#E5E5E5"> will crawl the windows directory</font>

418
00:20:10,270 --> 00:20:16,360
for all writable locations and so it

419
00:20:13,960 --> 00:20:17,800
does<font color="#E5E5E5"> that it drops its malware and then</font>

420
00:20:16,360 --> 00:20:21,399
it will<font color="#CCCCCC"> just</font><font color="#E5E5E5"> run from your protected</font>

421
00:20:17,800 --> 00:20:23,120
place<font color="#E5E5E5"> it's not super</font><font color="#CCCCCC"> useful the install</font>

422
00:20:21,400 --> 00:20:26,240
rules are similar<font color="#CCCCCC"> their paths</font>

423
00:20:23,120 --> 00:20:29,090
admins<font color="#CCCCCC"> they're more</font><font color="#E5E5E5"> of the same script</font>

424
00:20:26,240 --> 00:20:31,309
<font color="#E5E5E5">rules more</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same more path rules</font>

425
00:20:29,090 --> 00:20:37,699
allow everyone<font color="#E5E5E5"> run scripts and protected</font>

426
00:20:31,309 --> 00:20:39,680
directories<font color="#CCCCCC"> DLL rules more the same</font><font color="#E5E5E5"> and</font>

427
00:20:37,700 --> 00:20:41,620
I don't I've never worked with packaged

428
00:20:39,680 --> 00:20:44,170
apps so I don't know how good or<font color="#E5E5E5"> bad</font>

429
00:20:41,620 --> 00:20:47,239
allowing all signed packaged apps are

430
00:20:44,170 --> 00:20:49,370
but I would<font color="#CCCCCC"> assume</font><font color="#E5E5E5"> that since the</font>

431
00:20:47,240 --> 00:20:52,070
Android Google<font color="#CCCCCC"> Play Store is filled with</font>

432
00:20:49,370 --> 00:20:56,120
malware<font color="#E5E5E5"> probably the Windows Store</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> I</font>

433
00:20:52,070 --> 00:20:57,439
don't<font color="#CCCCCC"> know</font><font color="#E5E5E5"> but they're all signed so you</font>

434
00:20:56,120 --> 00:21:01,760
know you know what's coming from him

435
00:20:57,440 --> 00:21:03,110
<font color="#E5E5E5">from someone all</font><font color="#CCCCCC"> right so then</font><font color="#E5E5E5"> you could</font>

436
00:21:01,760 --> 00:21:05,809
<font color="#E5E5E5">automatically generate rules that's</font>

437
00:21:03,110 --> 00:21:07,459
another option<font color="#CCCCCC"> so I'm gonna walk you</font>

438
00:21:05,809 --> 00:21:14,300
<font color="#CCCCCC">through in</font><font color="#E5E5E5"> screenshots</font><font color="#CCCCCC"> what that looks</font>

439
00:21:07,460 --> 00:21:16,490
like so<font color="#CCCCCC"> you windows directory</font><font color="#E5E5E5"> and we're</font>

440
00:21:14,300 --> 00:21:17,720
going to create publisher rules<font color="#E5E5E5"> for the</font>

441
00:21:16,490 --> 00:21:20,450
<font color="#CCCCCC">digital signatures and</font><font color="#E5E5E5"> then we're gonna</font>

442
00:21:17,720 --> 00:21:22,970
reduce the number of<font color="#E5E5E5"> rules created by</font>

443
00:21:20,450 --> 00:21:26,179
<font color="#E5E5E5">grouping similar files then you get</font>

444
00:21:22,970 --> 00:21:27,440
three<font color="#E5E5E5"> hundred</font><font color="#CCCCCC"> and nine rules do you guys</font>

445
00:21:26,179 --> 00:21:29,750
want to manage three hundred<font color="#E5E5E5"> and nine</font>

446
00:21:27,440 --> 00:21:35,330
rules I mean it looks like<font color="#E5E5E5"> this I don't</font>

447
00:21:29,750 --> 00:21:40,160
know I certainly don't you you possibly

448
00:21:35,330 --> 00:21:42,230
could<font color="#E5E5E5"> but in my experience application</font>

449
00:21:40,160 --> 00:21:44,630
whitelisting is kind of<font color="#E5E5E5"> hands-on does</font>

450
00:21:42,230 --> 00:21:46,400
take some manipulation there and most<font color="#E5E5E5"> of</font>

451
00:21:44,630 --> 00:21:47,840
<font color="#E5E5E5">these are hash rules by the way it's</font>

452
00:21:46,400 --> 00:21:50,059
<font color="#E5E5E5">because those are the executables and</font>

453
00:21:47,840 --> 00:21:54,740
dll's that<font color="#E5E5E5"> microsoft did not sign in the</font>

454
00:21:50,059 --> 00:21:56,660
<font color="#E5E5E5">operating system and so I do have a demo</font>

455
00:21:54,740 --> 00:21:58,580
<font color="#E5E5E5">the sort of unfortunate</font><font color="#CCCCCC"> thing is</font><font color="#E5E5E5"> when I</font>

456
00:21:56,660 --> 00:22:01,820
time them they<font color="#E5E5E5"> don't fit into this talk</font>

457
00:21:58,580 --> 00:22:03,830
<font color="#E5E5E5">and so I have a link</font><font color="#CCCCCC"> there that I walk</font>

458
00:22:01,820 --> 00:22:05,659
through<font color="#E5E5E5"> what this demo does if I have</font>

459
00:22:03,830 --> 00:22:06,740
time at the<font color="#CCCCCC"> end of</font><font color="#E5E5E5"> this or like maybe</font>

460
00:22:05,660 --> 00:22:09,110
during<font color="#E5E5E5"> the lunch break if you</font><font color="#CCCCCC"> want to</font>

461
00:22:06,740 --> 00:22:14,660
catch me<font color="#CCCCCC"> in a hallway all I'll</font><font color="#E5E5E5"> show you</font>

462
00:22:09,110 --> 00:22:16,870
some things<font color="#E5E5E5"> so will yeah yeah of</font><font color="#CCCCCC"> course</font>

463
00:22:14,660 --> 00:22:16,870
<font color="#E5E5E5">okay</font>

464
00:22:19,139 --> 00:22:22,899
but what the demo is going<font color="#CCCCCC"> to show you</font>

465
00:22:21,099 --> 00:22:24,700
so I create a rule<font color="#E5E5E5"> set that allows</font>

466
00:22:22,899 --> 00:22:27,369
anyone to<font color="#E5E5E5"> run anything</font><font color="#CCCCCC"> signed by</font>

467
00:22:24,700 --> 00:22:28,450
Microsoft<font color="#CCCCCC"> and then I exclude</font><font color="#E5E5E5"> Internet</font>

468
00:22:27,369 --> 00:22:30,609
<font color="#CCCCCC">Explorer</font><font color="#E5E5E5"> because I don't want that</font>

469
00:22:28,450 --> 00:22:31,989
<font color="#E5E5E5">running anywhere</font><font color="#CCCCCC"> I will then try to</font>

470
00:22:30,609 --> 00:22:34,539
launch Internet Explorer<font color="#E5E5E5"> and it will</font>

471
00:22:31,989 --> 00:22:36,070
fail<font color="#CCCCCC"> as it</font><font color="#E5E5E5"> should and then I'll try</font><font color="#CCCCCC"> to</font>

472
00:22:34,539 --> 00:22:38,469
install<font color="#CCCCCC"> Google Chrome which will</font><font color="#E5E5E5"> also</font>

473
00:22:36,070 --> 00:22:40,570
fail<font color="#CCCCCC"> so then I'll create</font><font color="#E5E5E5"> a rule set</font><font color="#CCCCCC"> that</font>

474
00:22:38,469 --> 00:22:43,419
allows<font color="#E5E5E5"> Google signed executables to run</font>

475
00:22:40,570 --> 00:22:45,580
<font color="#CCCCCC">I also want</font><font color="#E5E5E5"> Google signed installers</font><font color="#CCCCCC"> to</font>

476
00:22:43,419 --> 00:22:47,440
run since I want to be<font color="#CCCCCC"> able to update</font><font color="#E5E5E5"> it</font>

477
00:22:45,580 --> 00:22:48,639
<font color="#E5E5E5">and then I'll show you</font><font color="#CCCCCC"> some logs so</font>

478
00:22:47,440 --> 00:22:53,409
that's that's what that demo walks

479
00:22:48,639 --> 00:23:08,168
through so<font color="#E5E5E5"> any questions this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the end</font>

480
00:22:53,409 --> 00:23:11,919
of the introduction<font color="#CCCCCC"> to app Locker I'm</font>

481
00:23:08,169 --> 00:23:12,519
I'm uncertain<font color="#CCCCCC"> I would assume not</font><font color="#E5E5E5"> but</font>

482
00:23:11,919 --> 00:23:15,339
it's worth a shot

483
00:23:12,519 --> 00:23:16,779
<font color="#CCCCCC">I mean you can push the group policy</font>

484
00:23:15,339 --> 00:23:24,158
down and maybe<font color="#E5E5E5"> it works I'm just not</font>

485
00:23:16,779 --> 00:23:26,469
sure any other questions<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so this</font>

486
00:23:24,159 --> 00:23:27,700
<font color="#E5E5E5">is a kind</font><font color="#CCCCCC"> of a find I don't know if any</font>

487
00:23:26,469 --> 00:23:31,330
<font color="#E5E5E5">of you watch Rick and Morty but</font>

488
00:23:27,700 --> 00:23:33,940
existence is pain<font color="#CCCCCC"> so I tried to find</font>

489
00:23:31,330 --> 00:23:36,119
some scripts<font color="#CCCCCC"> that were signed</font><font color="#E5E5E5"> on default</font>

490
00:23:33,940 --> 00:23:38,139
builds of Windows 10 or server 16 and

491
00:23:36,119 --> 00:23:39,879
Microsoft<font color="#E5E5E5"> doesn't sign anything</font>

492
00:23:38,139 --> 00:23:42,039
script wise on their<font color="#E5E5E5"> operating system by</font>

493
00:23:39,879 --> 00:23:44,589
default<font color="#CCCCCC"> so if you're building whitelist</font>

494
00:23:42,039 --> 00:23:45,460
script rules good luck I<font color="#CCCCCC"> don't I don't</font>

495
00:23:44,589 --> 00:23:47,289
<font color="#E5E5E5">have to tell you I don't know how you</font>

496
00:23:45,460 --> 00:23:49,149
can whitelist<font color="#E5E5E5"> the the operating system</font>

497
00:23:47,289 --> 00:23:54,549
in this case you might just break

498
00:23:49,149 --> 00:23:57,668
<font color="#CCCCCC">everything and here's some tips and</font>

499
00:23:54,549 --> 00:23:59,950
tricks<font color="#E5E5E5"> so anti</font><font color="#CCCCCC"> lockout one</font><font color="#E5E5E5"> of the things</font>

500
00:23:57,669 --> 00:24:01,359
that's super scary is I created a rule

501
00:23:59,950 --> 00:24:04,719
set and now I can't<font color="#E5E5E5"> log</font><font color="#CCCCCC"> into my machine</font>

502
00:24:01,359 --> 00:24:07,389
<font color="#CCCCCC">and that's because you've denied</font>

503
00:24:04,719 --> 00:24:09,219
everything<font color="#E5E5E5"> and and that's that is if you</font>

504
00:24:07,389 --> 00:24:12,580
remove availability<font color="#E5E5E5"> it's super and</font>

505
00:24:09,219 --> 00:24:14,950
secure right so fix that restart<font color="#CCCCCC"> in</font><font color="#E5E5E5"> safe</font>

506
00:24:12,580 --> 00:24:16,509
mode<font color="#E5E5E5"> disabled a service or disable it an</font>

507
00:24:14,950 --> 00:24:19,509
<font color="#CCCCCC">active directory and you'll get yourself</font>

508
00:24:16,509 --> 00:24:22,119
out of<font color="#E5E5E5"> that bind fun fact if you set</font>

509
00:24:19,509 --> 00:24:24,070
<font color="#E5E5E5">windows to deny all the</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> that</font>

510
00:24:22,119 --> 00:24:27,119
launches pre<font color="#E5E5E5"> login like sticky keys will</font>

511
00:24:24,070 --> 00:24:29,649
still work yeah<font color="#E5E5E5"> think</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> that</font>

512
00:24:27,119 --> 00:24:30,770
<font color="#E5E5E5">something</font><font color="#CCCCCC"> that where</font><font color="#E5E5E5"> app Locker is</font>

513
00:24:29,649 --> 00:24:35,659
running is now

514
00:24:30,770 --> 00:24:37,070
<font color="#E5E5E5">that execution chain that's fun</font><font color="#CCCCCC"> alright</font>

515
00:24:35,660 --> 00:24:38,900
so<font color="#CCCCCC"> AppLocker has an import and export</font>

516
00:24:37,070 --> 00:24:41,419
feature that lets<font color="#E5E5E5"> you work with policies</font>

517
00:24:38,900 --> 00:24:43,580
in<font color="#E5E5E5"> XML and so that where that leads me</font>

518
00:24:41,420 --> 00:24:46,220
is an<font color="#E5E5E5"> opportunity</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us the community</font>

519
00:24:43,580 --> 00:24:47,990
<font color="#CCCCCC">is to start creating a repository of</font>

520
00:24:46,220 --> 00:24:50,060
least privilege<font color="#E5E5E5"> for common systems like</font>

521
00:24:47,990 --> 00:24:51,890
Active Directory<font color="#E5E5E5"> and</font><font color="#CCCCCC"> Exchange so you</font>

522
00:24:50,060 --> 00:24:54,379
start<font color="#CCCCCC"> with that deny all you deny all</font>

523
00:24:51,890 --> 00:24:56,030
<font color="#E5E5E5">DLL files and then you build out what's</font>

524
00:24:54,380 --> 00:24:58,640
required<font color="#E5E5E5"> for your</font><font color="#CCCCCC"> domain controller</font><font color="#E5E5E5"> to</font>

525
00:24:56,030 --> 00:25:00,170
<font color="#CCCCCC">run that would</font><font color="#E5E5E5"> be super cool I'd love us</font>

526
00:24:58,640 --> 00:25:02,210
to build<font color="#CCCCCC"> that as a community I'd love to</font>

527
00:25:00,170 --> 00:25:04,750
build it myself<font color="#E5E5E5"> but I don't</font><font color="#CCCCCC"> have the</font>

528
00:25:02,210 --> 00:25:09,490
time<font color="#CCCCCC"> nor am i running exchange</font><font color="#E5E5E5"> anymore</font>

529
00:25:04,750 --> 00:25:09,490
and so uh so yeah there's an opportunity

530
00:25:10,630 --> 00:25:14,030
dynamic link library and I'm the wrong

531
00:25:12,920 --> 00:25:16,430
person to<font color="#E5E5E5"> ask</font>

532
00:25:14,030 --> 00:25:21,200
I<font color="#E5E5E5"> know</font><font color="#CCCCCC"> it's effectively executable code</font>

533
00:25:16,430 --> 00:25:23,090
used by<font color="#CCCCCC"> applications but anyone here</font>

534
00:25:21,200 --> 00:25:30,170
have a good<font color="#E5E5E5"> explanation 30 seconds for</font>

535
00:25:23,090 --> 00:25:31,760
<font color="#CCCCCC">DLLs yeah that sounds right</font><font color="#E5E5E5"> so if you</font>

536
00:25:30,170 --> 00:25:37,570
have two<font color="#CCCCCC"> applications that need a common</font>

537
00:25:31,760 --> 00:25:40,070
library and lets<font color="#E5E5E5"> them run that</font><font color="#CCCCCC"> thank</font><font color="#E5E5E5"> you</font>

538
00:25:37,570 --> 00:25:41,389
so another great<font color="#E5E5E5"> use cases this is</font><font color="#CCCCCC"> SCADA</font>

539
00:25:40,070 --> 00:25:43,939
like I said my backgrounds heavy

540
00:25:41,390 --> 00:25:46,580
industry<font color="#E5E5E5"> so if you know exactly</font><font color="#CCCCCC"> what</font>

541
00:25:43,940 --> 00:25:49,820
<font color="#E5E5E5">your your operating system is supposed</font>

542
00:25:46,580 --> 00:25:52,669
<font color="#CCCCCC">to do you could build</font><font color="#E5E5E5"> an app</font><font color="#CCCCCC"> lock or</font>

543
00:25:49,820 --> 00:25:54,290
policy to<font color="#CCCCCC"> deny all only do</font><font color="#E5E5E5"> that thing</font>

544
00:25:52,670 --> 00:25:56,180
<font color="#E5E5E5">and then you can ship it off all over</font>

545
00:25:54,290 --> 00:26:00,020
<font color="#CCCCCC">the</font><font color="#E5E5E5"> world and it's</font><font color="#CCCCCC"> just gonna</font><font color="#E5E5E5"> have that</font>

546
00:25:56,180 --> 00:26:02,450
policy<font color="#CCCCCC"> that'd be super</font><font color="#E5E5E5"> cool if I were</font>

547
00:26:00,020 --> 00:26:05,210
<font color="#E5E5E5">building a SCADA device with the HMI I</font>

548
00:26:02,450 --> 00:26:07,250
would absolutely do that<font color="#E5E5E5"> because usually</font>

549
00:26:05,210 --> 00:26:08,720
antivirus doesn't get deployed<font color="#E5E5E5"> in SCADA</font>

550
00:26:07,250 --> 00:26:14,870
environments<font color="#E5E5E5"> and I'd rather have</font>

551
00:26:08,720 --> 00:26:17,060
whitelisting anyways<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so that</font>

552
00:26:14,870 --> 00:26:19,010
brings<font color="#E5E5E5"> me</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> Google Santa I'm not gonna</font>

553
00:26:17,060 --> 00:26:22,340
read this giant blurb of Texas to save

554
00:26:19,010 --> 00:26:24,379
you from hearing<font color="#CCCCCC"> it so but effectively</font>

555
00:26:22,340 --> 00:26:26,419
<font color="#CCCCCC">what Google</font><font color="#E5E5E5"> Santa is it's a white</font>

556
00:26:24,380 --> 00:26:28,840
spacing product developed by Google put

557
00:26:26,420 --> 00:26:32,440
out onto the<font color="#CCCCCC"> internet updated regularly</font>

558
00:26:28,840 --> 00:26:36,889
<font color="#E5E5E5">it's on github that's the link it works</font>

559
00:26:32,440 --> 00:26:38,930
it's pretty<font color="#CCCCCC"> neat</font><font color="#E5E5E5"> it's too bad that Apple</font>

560
00:26:36,890 --> 00:26:39,380
<font color="#CCCCCC">doesn't put this into</font><font color="#E5E5E5"> the operating</font>

561
00:26:38,930 --> 00:26:42,470
<font color="#E5E5E5">system</font>

562
00:26:39,380 --> 00:26:44,100
<font color="#CCCCCC">and so having pivoted from</font><font color="#E5E5E5"> a Windows</font>

563
00:26:42,470 --> 00:26:46,410
environment<font color="#CCCCCC"> to a Mac environment I'm</font>

564
00:26:44,100 --> 00:26:49,439
give this part of the presentation<font color="#CCCCCC"> as</font>

565
00:26:46,410 --> 00:26:52,550
sort of the<font color="#CCCCCC"> max support forms</font><font color="#E5E5E5"> so here's</font>

566
00:26:49,440 --> 00:26:55,470
Google Santa<font color="#CCCCCC"> and thank you goodnight</font>

567
00:26:52,550 --> 00:26:57,960
you've ever managed<font color="#E5E5E5"> Mac OS that's how</font>

568
00:26:55,470 --> 00:26:59,460
their forms work<font color="#E5E5E5"> but actually I'm not</font>

569
00:26:57,960 --> 00:27:00,920
<font color="#E5E5E5">gonna do</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> I'm gonna walk</font><font color="#CCCCCC"> you through</font>

570
00:26:59,460 --> 00:27:03,390
it just<font color="#E5E5E5"> like the others</font>

571
00:27:00,920 --> 00:27:05,460
so you got rules<font color="#CCCCCC"> so we've already talked</font>

572
00:27:03,390 --> 00:27:07,160
about signatures hashes and<font color="#E5E5E5"> paths</font><font color="#CCCCCC"> so</font>

573
00:27:05,460 --> 00:27:09,900
Santa lets you do all<font color="#CCCCCC"> that</font>

574
00:27:07,160 --> 00:27:12,300
implementation<font color="#CCCCCC"> Google Santa</font><font color="#E5E5E5"> has a sync</font>

575
00:27:09,900 --> 00:27:14,600
server<font color="#E5E5E5"> and using a sync server will</font>

576
00:27:12,300 --> 00:27:18,090
enable an admin<font color="#E5E5E5"> to configure rules</font><font color="#CCCCCC"> and</font>

577
00:27:14,600 --> 00:27:19,469
other settings and so that doesn't

578
00:27:18,090 --> 00:27:20,790
<font color="#CCCCCC">appear in</font><font color="#E5E5E5"> this talk</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the reason that</font>

579
00:27:19,470 --> 00:27:22,110
<font color="#CCCCCC">doesn't appear in</font><font color="#E5E5E5"> this talk is</font><font color="#CCCCCC"> I</font>

580
00:27:20,790 --> 00:27:24,360
couldn't for the life of<font color="#E5E5E5"> me figure</font><font color="#CCCCCC"> out</font>

581
00:27:22,110 --> 00:27:26,879
how<font color="#E5E5E5"> to make that work I read their</font>

582
00:27:24,360 --> 00:27:30,060
documents for about a day<font color="#E5E5E5"> I tried</font>

583
00:27:26,880 --> 00:27:31,620
different things so I don't<font color="#E5E5E5"> know I mean</font>

584
00:27:30,060 --> 00:27:33,000
<font color="#CCCCCC">I don't know if that's</font><font color="#E5E5E5"> talking over an</font>

585
00:27:31,620 --> 00:27:34,919
encrypted<font color="#CCCCCC"> channel I</font><font color="#E5E5E5"> don't know if it's</font>

586
00:27:33,000 --> 00:27:36,630
authenticated<font color="#E5E5E5"> I don't I know nothing</font>

587
00:27:34,920 --> 00:27:38,820
<font color="#E5E5E5">about that sync server but</font><font color="#CCCCCC"> it's it's in</font>

588
00:27:36,630 --> 00:27:40,740
there in the<font color="#E5E5E5"> functionality so your</font>

589
00:27:38,820 --> 00:27:43,639
<font color="#E5E5E5">mileage may vary there if you find out</font>

590
00:27:40,740 --> 00:27:46,500
how to make<font color="#CCCCCC"> it</font><font color="#E5E5E5"> work write a blog please</font>

591
00:27:43,640 --> 00:27:47,970
<font color="#CCCCCC">there the database so what you can do as</font>

592
00:27:46,500 --> 00:27:50,460
an alternative there's a<font color="#E5E5E5"> local database</font>

593
00:27:47,970 --> 00:27:52,560
file you can<font color="#E5E5E5"> build a whitelist and</font><font color="#CCCCCC"> a VM</font>

594
00:27:50,460 --> 00:27:54,750
or in a sandbox<font color="#CCCCCC"> export that and deploy</font>

595
00:27:52,560 --> 00:27:58,350
<font color="#CCCCCC">it with your standard Mac tools such as</font>

596
00:27:54,750 --> 00:28:03,570
monkey or<font color="#E5E5E5"> jammed or chef or ansible I</font>

597
00:27:58,350 --> 00:28:05,520
mean<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> Unix so do what</font><font color="#E5E5E5"> you want so to</font>

598
00:28:03,570 --> 00:28:09,120
install it it's super<font color="#CCCCCC"> easy you</font><font color="#E5E5E5"> download</font>

599
00:28:05,520 --> 00:28:10,920
the precompiled<font color="#CCCCCC"> signed binary Mac</font><font color="#E5E5E5"> OS is</font>

600
00:28:09,120 --> 00:28:12,000
gonna warn you<font color="#E5E5E5"> with their attempt at</font>

601
00:28:10,920 --> 00:28:13,620
application whitelisting

602
00:28:12,000 --> 00:28:16,800
so you just click<font color="#E5E5E5"> through everything and</font>

603
00:28:13,620 --> 00:28:19,560
<font color="#E5E5E5">you click</font><font color="#CCCCCC"> next to success once it's on</font>

604
00:28:16,800 --> 00:28:24,360
there figure<font color="#CCCCCC"> out</font><font color="#E5E5E5"> if it's running tail</font>

605
00:28:19,560 --> 00:28:25,980
<font color="#CCCCCC">tack f VAR DB santa-santa log</font><font color="#E5E5E5"> and you'll</font>

606
00:28:24,360 --> 00:28:27,750
<font color="#E5E5E5">it'll start generating logs immediately</font>

607
00:28:25,980 --> 00:28:34,470
<font color="#E5E5E5">no reason no need to restart</font><font color="#CCCCCC"> the</font>

608
00:28:27,750 --> 00:28:36,540
operating system<font color="#CCCCCC"> any questions so here's</font>

609
00:28:34,470 --> 00:28:39,240
some basics<font color="#CCCCCC"> it once again just</font><font color="#E5E5E5"> like app</font>

610
00:28:36,540 --> 00:28:41,040
<font color="#CCCCCC">Locker audit</font><font color="#E5E5E5"> mode and</font><font color="#CCCCCC"> enforce mode</font><font color="#E5E5E5"> so</font>

611
00:28:39,240 --> 00:28:45,360
<font color="#E5E5E5">when you first install Santa it's in</font>

612
00:28:41,040 --> 00:28:47,310
audit mode so to configure it there

613
00:28:45,360 --> 00:28:50,909
here's a couple<font color="#E5E5E5"> of</font><font color="#CCCCCC"> basic things</font><font color="#E5E5E5"> you have</font>

614
00:28:47,310 --> 00:28:52,620
configuration config<font color="#CCCCCC"> key list that's a</font>

615
00:28:50,910 --> 00:28:54,330
super<font color="#E5E5E5"> short text file so</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> edit</font>

616
00:28:52,620 --> 00:28:57,189
<font color="#E5E5E5">that in VI or atom</font>

617
00:28:54,330 --> 00:29:02,559
send it to<font color="#CCCCCC"> one audit</font><font color="#E5E5E5"> mode set it to to</font>

618
00:28:57,190 --> 00:29:04,179
enforce the logs I'd<font color="#E5E5E5"> already showed you</font>

619
00:29:02,559 --> 00:29:06,570
and<font color="#E5E5E5"> then you can you could actually make</font>

620
00:29:04,179 --> 00:29:09,099
a<font color="#E5E5E5"> plain</font><font color="#CCCCCC"> text dump of the</font><font color="#E5E5E5"> rule database</font>

621
00:29:06,570 --> 00:29:10,239
<font color="#E5E5E5">include the commands there someone on</font>

622
00:29:09,099 --> 00:29:18,820
the internet was very helpful

623
00:29:10,239 --> 00:29:21,190
<font color="#E5E5E5">and posted that so Google Santa is all</font>

624
00:29:18,820 --> 00:29:22,869
built around<font color="#E5E5E5"> the Santa CTL command it</font>

625
00:29:21,190 --> 00:29:25,029
contains all the functionality<font color="#E5E5E5"> for</font>

626
00:29:22,869 --> 00:29:26,889
<font color="#E5E5E5">syncing with a sync server allows you to</font>

627
00:29:25,029 --> 00:29:29,080
view the<font color="#E5E5E5"> state and configuration it can</font>

628
00:29:26,889 --> 00:29:33,789
inspect individual files<font color="#CCCCCC"> manage</font><font color="#E5E5E5"> the</font>

629
00:29:29,080 --> 00:29:35,439
rural database and so sort of<font color="#E5E5E5"> the easy</font>

630
00:29:33,789 --> 00:29:39,179
stuff find the certificate<font color="#CCCCCC"> information</font>

631
00:29:35,440 --> 00:29:42,099
<font color="#E5E5E5">of an application</font><font color="#CCCCCC"> santa CTL point it</font>

632
00:29:39,179 --> 00:29:45,909
<font color="#E5E5E5">whitelist an application</font><font color="#CCCCCC"> santa CTL rule</font>

633
00:29:42,099 --> 00:29:47,499
whitelist certificate<font color="#E5E5E5"> sha-256 so i'm</font>

634
00:29:45,909 --> 00:29:52,029
gonna break this<font color="#E5E5E5"> down for</font><font color="#CCCCCC"> if you remove</font>

635
00:29:47,499 --> 00:29:54,389
certificate<font color="#E5E5E5"> sha-256 is the hash rule so</font>

636
00:29:52,029 --> 00:29:56,619
if you don't<font color="#E5E5E5"> put certificate and you put</font>

637
00:29:54,389 --> 00:30:03,570
<font color="#E5E5E5">sha-256 or only doing the file hash not</font>

638
00:29:56,619 --> 00:30:06,820
the actual publisher yeah that's correct

639
00:30:03,570 --> 00:30:09,369
not<font color="#E5E5E5"> as far as I'm</font><font color="#CCCCCC"> aware</font>

640
00:30:06,820 --> 00:30:11,499
<font color="#E5E5E5">I mean Mac OS is using the</font><font color="#CCCCCC"> mock colonel</font>

641
00:30:09,369 --> 00:30:14,589
not the Linux kernel so and these are

642
00:30:11,499 --> 00:30:15,969
reliant on<font color="#E5E5E5"> kernel hooks so I don't</font>

643
00:30:14,589 --> 00:30:18,219
actually know of<font color="#CCCCCC"> an application</font>

644
00:30:15,969 --> 00:30:21,789
whitelisting product<font color="#E5E5E5"> like these two on</font>

645
00:30:18,219 --> 00:30:23,979
<font color="#E5E5E5">Linux so I guess part of the challenge</font>

646
00:30:21,789 --> 00:30:28,929
<font color="#CCCCCC">is that Linux is signed binaries by</font>

647
00:30:23,979 --> 00:30:31,200
default so kinda have<font color="#CCCCCC"> to trust the repos</font>

648
00:30:28,929 --> 00:30:31,200
there

649
00:30:32,710 --> 00:30:37,659
<font color="#CCCCCC">alright so the anatomy of</font><font color="#E5E5E5"> a log so you</font>

650
00:30:35,470 --> 00:30:39,700
<font color="#CCCCCC">tail</font><font color="#E5E5E5"> tack out this log</font><font color="#CCCCCC"> in June they're</font>

651
00:30:37,659 --> 00:30:41,919
just gonna vomit logs at you<font color="#E5E5E5"> I mean it's</font>

652
00:30:39,700 --> 00:30:45,610
awesome<font color="#CCCCCC"> you get</font><font color="#E5E5E5"> you see everything right</font>

653
00:30:41,919 --> 00:30:47,649
so I don't know about you<font color="#CCCCCC"> but I'm not</font>

654
00:30:45,610 --> 00:30:49,269
<font color="#E5E5E5">gonna be like the matrix</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

655
00:30:47,649 --> 00:30:50,709
tell you what was<font color="#CCCCCC"> supposed to run and</font>

656
00:30:49,269 --> 00:30:54,820
<font color="#E5E5E5">what wasn't it's just gonna flow at me</font>

657
00:30:50,710 --> 00:30:56,230
<font color="#E5E5E5">like noise and so I'm walk you through</font>

658
00:30:54,820 --> 00:30:58,658
what<font color="#E5E5E5"> the log looks like so you've got</font>

659
00:30:56,230 --> 00:31:02,100
<font color="#CCCCCC">date/time stamp you have the action</font><font color="#E5E5E5"> that</font>

660
00:30:58,659 --> 00:31:08,769
was taken the reason why it was allowed

661
00:31:02,100 --> 00:31:09,969
<font color="#E5E5E5">so what and why you have the sha-256 so</font>

662
00:31:08,769 --> 00:31:14,080
that's gonna give<font color="#E5E5E5"> you the hash of the</font>

663
00:31:09,970 --> 00:31:17,769
application you got the search<font color="#CCCCCC"> Shaw 5256</font>

664
00:31:14,080 --> 00:31:21,220
which<font color="#E5E5E5"> is the certificate you</font><font color="#CCCCCC"> have the</font>

665
00:31:17,769 --> 00:31:23,529
name of<font color="#CCCCCC"> the certificate</font><font color="#E5E5E5"> and then you've</font>

666
00:31:21,220 --> 00:31:25,029
got your user<font color="#E5E5E5"> information man don't you</font>

667
00:31:23,529 --> 00:31:26,559
<font color="#E5E5E5">wish</font><font color="#CCCCCC"> Windows you know</font><font color="#E5E5E5"> you just click</font>

668
00:31:25,029 --> 00:31:30,999
<font color="#CCCCCC">next to success and you get some logs</font>

669
00:31:26,559 --> 00:31:32,499
and<font color="#E5E5E5"> you're done no this is the UNIX so</font>

670
00:31:30,999 --> 00:31:34,450
you can grip on all that though<font color="#CCCCCC"> so you</font>

671
00:31:32,499 --> 00:31:37,720
<font color="#E5E5E5">can build your your grip you can tail</font>

672
00:31:34,450 --> 00:31:42,669
pack up pipe<font color="#CCCCCC"> to grep and search for say</font>

673
00:31:37,720 --> 00:31:46,090
decision<font color="#CCCCCC"> blocked</font><font color="#E5E5E5"> or denied</font><font color="#CCCCCC"> and so here</font>

674
00:31:42,669 --> 00:31:48,429
<font color="#E5E5E5">are some some terms to</font><font color="#CCCCCC"> help you while</font>

675
00:31:46,090 --> 00:31:51,490
<font color="#E5E5E5">you're building those grep statements so</font>

676
00:31:48,429 --> 00:31:53,159
allow<font color="#CCCCCC"> reason cert</font><font color="#E5E5E5"> applications executed</font>

677
00:31:51,490 --> 00:31:56,409
<font color="#CCCCCC">because the cert was trusted by Santa</font>

678
00:31:53,159 --> 00:31:58,210
<font color="#E5E5E5">allow reason unknown that's because it's</font>

679
00:31:56,409 --> 00:31:59,590
an audit mode<font color="#E5E5E5"> and it didn't know what to</font>

680
00:31:58,210 --> 00:32:03,039
do with<font color="#CCCCCC"> that executable</font><font color="#E5E5E5"> so it's a sin</font><font color="#CCCCCC"> to</font>

681
00:31:59,590 --> 00:32:04,360
allow it<font color="#E5E5E5"> denied reason unknown well</font>

682
00:32:03,039 --> 00:32:06,369
that's a good<font color="#CCCCCC"> thing that means you're</font>

683
00:32:04,360 --> 00:32:09,008
you have<font color="#E5E5E5"> deny all on and it didn't</font>

684
00:32:06,369 --> 00:32:15,689
recognize any binary<font color="#E5E5E5"> so it's turning it</font>

685
00:32:09,009 --> 00:32:15,690
off<font color="#E5E5E5"> it's not allowing me</font><font color="#CCCCCC"> to run it yeah</font>

686
00:32:18,480 --> 00:32:23,820
from executing<font color="#E5E5E5"> because</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> Pacific</font>

687
00:32:21,700 --> 00:32:26,650
<font color="#CCCCCC">shuttle</font><font color="#E5E5E5"> right so you can actually</font>

688
00:32:23,820 --> 00:32:28,860
declare a<font color="#E5E5E5"> block you can blacklist</font>

689
00:32:26,650 --> 00:32:32,110
<font color="#CCCCCC">there's a blacklist flag that lets you</font>

690
00:32:28,860 --> 00:32:37,709
so<font color="#CCCCCC"> did the program did something take</font>

691
00:32:32,110 --> 00:32:37,709
this<font color="#E5E5E5"> binary code rather into shock I</font>

692
00:32:39,510 --> 00:32:43,090
would assume that's how it works I<font color="#CCCCCC"> don't</font>

693
00:32:41,560 --> 00:32:47,020
know the functional<font color="#E5E5E5"> code details but yes</font>

694
00:32:43,090 --> 00:32:48,639
<font color="#E5E5E5">that that's how it assumes oh okay so</font>

695
00:32:47,020 --> 00:32:50,080
like this is a great way to<font color="#E5E5E5"> block iTunes</font>

696
00:32:48,640 --> 00:32:51,550
<font color="#CCCCCC">let's say you're running a Mac</font>

697
00:32:50,080 --> 00:32:53,500
<font color="#CCCCCC">environment you don't</font><font color="#E5E5E5"> want iTunes</font>

698
00:32:51,550 --> 00:32:56,530
running on your your your endpoints

699
00:32:53,500 --> 00:32:59,170
throw this on there and<font color="#E5E5E5"> all sudden it</font>

700
00:32:56,530 --> 00:33:01,540
won't work<font color="#E5E5E5"> although then an iTunes will</font>

701
00:32:59,170 --> 00:33:03,190
update and then the shot<font color="#CCCCCC"> changes so you</font>

702
00:33:01,540 --> 00:33:08,020
<font color="#E5E5E5">have to keep</font><font color="#CCCCCC"> managing it member</font>

703
00:33:03,190 --> 00:33:10,090
<font color="#E5E5E5">Security's hard and time-consuming so</font>

704
00:33:08,020 --> 00:33:13,960
once again I built the demo once again

705
00:33:10,090 --> 00:33:15,730
it's long we<font color="#E5E5E5"> are at 36 and so I may have</font>

706
00:33:13,960 --> 00:33:19,360
<font color="#E5E5E5">a time for one of the demos so maybe</font>

707
00:33:15,730 --> 00:33:20,830
I'll do a poll of<font color="#CCCCCC"> the class but the</font><font color="#E5E5E5"> demo</font>

708
00:33:19,360 --> 00:33:25,570
is gonna set to enforce its gonna show

709
00:33:20,830 --> 00:33:28,090
<font color="#CCCCCC">whitelisting behavior reen able audit</font>

710
00:33:25,570 --> 00:33:28,840
mode<font color="#CCCCCC"> launched chrome review logs you</font>

711
00:33:28,090 --> 00:33:32,040
build a whitelist

712
00:33:28,840 --> 00:33:34,570
<font color="#E5E5E5">you set</font><font color="#CCCCCC"> santo enforce and then it works</font>

713
00:33:32,040 --> 00:33:39,040
just like<font color="#E5E5E5"> AppLocker except more steps</font>

714
00:33:34,570 --> 00:33:40,360
and<font color="#E5E5E5"> more grubbing</font><font color="#CCCCCC"> alright so that's kind</font>

715
00:33:39,040 --> 00:33:42,159
of the<font color="#CCCCCC"> end of</font><font color="#E5E5E5"> my talk like I said I'll</font>

716
00:33:40,360 --> 00:33:43,479
do the demos here at the end I'll take a

717
00:33:42,160 --> 00:33:45,490
poll see which<font color="#E5E5E5"> ones you guys want to see</font>

718
00:33:43,480 --> 00:33:47,290
if you want to<font color="#E5E5E5"> see any of them but first</font>

719
00:33:45,490 --> 00:33:48,910
<font color="#E5E5E5">I want to thank Reglan</font><font color="#CCCCCC"> Eris he's the one</font>

720
00:33:47,290 --> 00:33:53,050
who brought<font color="#E5E5E5"> me</font><font color="#CCCCCC"> into InfoSec from a</font>

721
00:33:48,910 --> 00:33:55,420
regular sysadmin<font color="#CCCCCC"> he introduced me</font><font color="#E5E5E5"> to the</font>

722
00:33:53,050 --> 00:33:57,070
<font color="#CCCCCC">community and so he's awesome Thomas</font>

723
00:33:55,420 --> 00:33:58,540
<font color="#CCCCCC">Eggman and Bill kafra</font><font color="#E5E5E5"> they taught me</font>

724
00:33:57,070 --> 00:34:01,060
<font color="#E5E5E5">that max can</font><font color="#CCCCCC"> be managed at the</font>

725
00:33:58,540 --> 00:34:03,129
enterprise level<font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> believe them</font>

726
00:34:01,060 --> 00:34:04,990
and then they they taught me<font color="#CCCCCC"> the ways</font>

727
00:34:03,130 --> 00:34:07,030
and<font color="#CCCCCC"> then I want to thank the following</font>

728
00:34:04,990 --> 00:34:10,480
folks Liz my wife<font color="#CCCCCC"> Andy Bailey bill</font>

729
00:34:07,030 --> 00:34:12,670
<font color="#E5E5E5">Finlayson</font><font color="#CCCCCC"> Devin</font><font color="#E5E5E5"> Emma Gerald Jacob Jared</font>

730
00:34:10,480 --> 00:34:15,040
Jessica Payne Jim

731
00:34:12,670 --> 00:34:16,480
<font color="#CCCCCC">Jonathan</font><font color="#E5E5E5"> Sean and West so friend follow</font>

732
00:34:15,040 --> 00:34:18,159
<font color="#E5E5E5">those are all great people on Twitter</font>

733
00:34:16,480 --> 00:34:20,320
<font color="#E5E5E5">the ones who don't have Twitter you know</font>

734
00:34:18,159 --> 00:34:22,799
I don't know<font color="#E5E5E5"> I guess they're not an</font>

735
00:34:20,320 --> 00:34:22,800
<font color="#E5E5E5">InfoSec</font>

736
00:34:23,179 --> 00:34:28,099
yeah<font color="#E5E5E5"> so that's me I'm Deidre</font><font color="#CCCCCC"> Shaq on</font>

737
00:34:26,119 --> 00:34:32,359
<font color="#E5E5E5">Twitter I host a blog sometimes I play</font>

738
00:34:28,099 --> 00:34:34,579
<font color="#E5E5E5">with Unicode and and sometimes I play</font>

739
00:34:32,359 --> 00:34:36,049
<font color="#E5E5E5">with whitelisting but all my activities</font>

740
00:34:34,579 --> 00:34:37,059
are blue team related I don't I don't

741
00:34:36,049 --> 00:34:43,129
<font color="#E5E5E5">break things very well</font>

742
00:34:37,059 --> 00:34:47,289
<font color="#CCCCCC">so I'm</font><font color="#E5E5E5"> not but</font><font color="#CCCCCC"> I meant I'm interested I</font>

743
00:34:43,129 --> 00:34:51,139
saw the<font color="#CCCCCC"> last talk but</font><font color="#E5E5E5"> now look into that</font>

744
00:34:47,289 --> 00:34:55,039
so any questions any so this is this<font color="#E5E5E5"> is</font>

745
00:34:51,139 --> 00:34:58,039
the end<font color="#E5E5E5"> my friends does anyone want to</font>

746
00:34:55,039 --> 00:34:59,329
see a demo anyone care I am<font color="#E5E5E5"> at 38 which</font>

747
00:34:58,039 --> 00:35:03,200
means I<font color="#CCCCCC"> could probably run you through</font>

748
00:34:59,329 --> 00:35:06,680
one of<font color="#E5E5E5"> them</font><font color="#CCCCCC"> Santo demo</font><font color="#E5E5E5"> anyone else for</font>

749
00:35:03,200 --> 00:35:08,930
Santa<font color="#CCCCCC"> and you one Santa Santa cool</font>

750
00:35:06,680 --> 00:35:13,520
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> let's let's let's me show</font><font color="#CCCCCC"> you</font>

751
00:35:08,930 --> 00:35:15,589
some Santa's give me a second while<font color="#CCCCCC"> I</font>

752
00:35:13,520 --> 00:35:18,339
try to figure<font color="#E5E5E5"> out my dual screen</font>

753
00:35:15,589 --> 00:35:18,339
situation

754
00:35:28,500 --> 00:35:36,260
<font color="#E5E5E5">there's my mouse</font><font color="#CCCCCC"> there we go all</font><font color="#E5E5E5"> right</font>

755
00:35:36,440 --> 00:35:53,119
Google Santa demo that's weird

756
00:35:47,130 --> 00:35:53,119
why<font color="#CCCCCC"> is that like that</font><font color="#E5E5E5"> okay</font>

757
00:36:03,109 --> 00:36:09,769
<font color="#CCCCCC">alright so in</font><font color="#E5E5E5"> this demo like I said I've</font>

758
00:36:06,349 --> 00:36:15,259
installed Google<font color="#E5E5E5"> Chrome Mozilla Firefox</font>

759
00:36:09,769 --> 00:36:20,118
and<font color="#CCCCCC"> santé</font><font color="#E5E5E5"> and so this is a clean</font>

760
00:36:15,259 --> 00:36:21,140
install<font color="#CCCCCC"> of yes running</font><font color="#E5E5E5"> I'm not</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font>

761
00:36:20,119 --> 00:36:24,079
show you how<font color="#E5E5E5"> to click Next on an</font>

762
00:36:21,140 --> 00:36:25,848
executable so this<font color="#E5E5E5"> this is configuring</font>

763
00:36:24,079 --> 00:36:27,890
<font color="#E5E5E5">santa-santa has already been installed</font>

764
00:36:25,849 --> 00:36:29,660
off of github<font color="#CCCCCC"> but it's in its default</font>

765
00:36:27,890 --> 00:36:31,609
<font color="#CCCCCC">state so this is</font><font color="#E5E5E5"> I've changed nothing</font>

766
00:36:29,660 --> 00:36:35,660
about Santa other than installing<font color="#E5E5E5"> it and</font>

767
00:36:31,609 --> 00:36:37,759
so Chrome's gonna work<font color="#E5E5E5"> great this is</font>

768
00:36:35,660 --> 00:36:40,009
<font color="#E5E5E5">gonna pop</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> and say</font><font color="#CCCCCC"> oh hey you've never</font>

769
00:36:37,759 --> 00:36:42,410
opened<font color="#CCCCCC"> this and I'm so that that that is</font>

770
00:36:40,009 --> 00:36:47,509
<font color="#E5E5E5">Mac OS is version of</font><font color="#CCCCCC"> whitelisting I</font>

771
00:36:42,410 --> 00:36:51,038
guess and I'm gonna say yes<font color="#CCCCCC"> and you know</font>

772
00:36:47,509 --> 00:36:55,660
<font color="#CCCCCC">Chrome's</font><font color="#E5E5E5"> already running so awesome</font>

773
00:36:51,039 --> 00:36:55,660
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> so let's go into a terminal</font>

774
00:37:04,440 --> 00:37:07,800
<font color="#E5E5E5">all right so here you</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> in a terminal</font>

775
00:37:06,060 --> 00:37:12,410
<font color="#CCCCCC">so let's go ahead and become a bigger</font>

776
00:37:07,800 --> 00:37:12,410
<font color="#E5E5E5">person than we are today</font><font color="#CCCCCC"> so sudo</font><font color="#E5E5E5"> tak I</font>

777
00:37:14,690 --> 00:37:18,630
<font color="#E5E5E5">all right now now we're the root user</font>

778
00:37:16,920 --> 00:37:22,370
now we can cause some<font color="#CCCCCC"> serious</font><font color="#E5E5E5"> damage so</font>

779
00:37:18,630 --> 00:37:28,380
we're gonna go ahead and do VI<font color="#E5E5E5"> VAR DB</font>

780
00:37:22,370 --> 00:37:30,660
<font color="#E5E5E5">Santa config</font><font color="#CCCCCC"> alright so remember</font><font color="#E5E5E5"> I said</font>

781
00:37:28,380 --> 00:37:33,570
<font color="#CCCCCC">this is a super simple plist</font><font color="#E5E5E5"> plain text</font>

782
00:37:30,660 --> 00:37:38,009
file<font color="#E5E5E5"> so</font><font color="#CCCCCC"> we're just gonna change</font><font color="#E5E5E5"> that</font>

783
00:37:33,570 --> 00:37:40,050
number<font color="#CCCCCC"> to</font><font color="#E5E5E5"> - now we're enforced so by</font>

784
00:37:38,010 --> 00:37:42,600
<font color="#CCCCCC">default Google Santa white lists</font>

785
00:37:40,050 --> 00:37:45,720
everything<font color="#E5E5E5"> signed by Apple that's their</font>

786
00:37:42,600 --> 00:37:55,589
anti<font color="#CCCCCC"> lockout feature</font><font color="#E5E5E5"> so hopefully you</font>

787
00:37:45,720 --> 00:37:57,330
trust<font color="#CCCCCC"> Apple</font><font color="#E5E5E5"> so now</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> it is as far as</font>

788
00:37:55,590 --> 00:37:59,940
<font color="#CCCCCC">I'm aware it's not hooking</font><font color="#E5E5E5"> back I</font>

789
00:37:57,330 --> 00:38:01,470
haven't<font color="#CCCCCC"> done a network analysis I mean</font>

790
00:37:59,940 --> 00:38:02,760
this tool is not particularly popular

791
00:38:01,470 --> 00:38:05,220
it's not particularly<font color="#E5E5E5"> well known</font>

792
00:38:02,760 --> 00:38:08,700
<font color="#E5E5E5">Google's not it's not an official Google</font>

793
00:38:05,220 --> 00:38:11,359
product<font color="#CCCCCC"> I don't know I'm not application</font>

794
00:38:08,700 --> 00:38:15,029
<font color="#E5E5E5">hacker so someone should read the code</font>

795
00:38:11,360 --> 00:38:17,160
but still I trust Google to have

796
00:38:15,030 --> 00:38:19,290
knowledge<font color="#E5E5E5"> of applications on endpoints</font>

797
00:38:17,160 --> 00:38:23,609
more than I trust<font color="#E5E5E5"> my users to run the</font>

798
00:38:19,290 --> 00:38:25,710
<font color="#CCCCCC">next cryptolocker</font><font color="#E5E5E5"> so so now we're going</font>

799
00:38:23,610 --> 00:38:27,900
to<font color="#E5E5E5"> start getting issues cuz a chrome was</font>

800
00:38:25,710 --> 00:38:32,190
running now it's being<font color="#E5E5E5"> denied so let's</font>

801
00:38:27,900 --> 00:38:34,140
go<font color="#CCCCCC"> ahead</font><font color="#E5E5E5"> and close</font><font color="#CCCCCC"> chrome so now we're</font>

802
00:38:32,190 --> 00:38:37,890
gonna<font color="#CCCCCC"> open up</font><font color="#E5E5E5"> Firefox</font><font color="#CCCCCC"> I have not opened</font>

803
00:38:34,140 --> 00:38:39,779
<font color="#E5E5E5">Firefox and it's denied you don't get to</font>

804
00:38:37,890 --> 00:38:44,160
the<font color="#CCCCCC"> Mac screen because it's not</font><font color="#E5E5E5"> allowed</font>

805
00:38:39,780 --> 00:38:47,970
<font color="#E5E5E5">to run its kernel hook and then uh oops</font>

806
00:38:44,160 --> 00:38:50,940
<font color="#CCCCCC">Launchpad works great</font><font color="#E5E5E5"> Safari works works</font>

807
00:38:47,970 --> 00:38:53,850
great and it<font color="#E5E5E5"> works great because</font><font color="#CCCCCC"> apples</font>

808
00:38:50,940 --> 00:38:56,240
trusted right Safari<font color="#CCCCCC"> as far as the one</font>

809
00:38:53,850 --> 00:38:56,240
true<font color="#E5E5E5"> way</font>

810
00:38:57,160 --> 00:39:05,740
that<font color="#E5E5E5"> that's correct yeah hey man</font><font color="#CCCCCC"> III fix</font>

811
00:39:04,299 --> 00:39:07,630
<font color="#CCCCCC">things I don't</font><font color="#E5E5E5"> break them I have no idea</font>

812
00:39:05,740 --> 00:39:10,240
how to do<font color="#E5E5E5"> that stuff</font><font color="#CCCCCC"> but I you</font><font color="#E5E5E5"> should</font>

813
00:39:07,630 --> 00:39:13,059
you should try it I'm curious<font color="#CCCCCC"> I don't</font>

814
00:39:10,240 --> 00:39:15,279
know how to<font color="#E5E5E5"> break things</font><font color="#CCCCCC"> I used MSO 867</font>

815
00:39:13,059 --> 00:39:16,539
once because the red team<font color="#E5E5E5"> are</font><font color="#CCCCCC"> on my team</font>

816
00:39:15,280 --> 00:39:19,030
thought<font color="#E5E5E5"> I should probably know how that</font>

817
00:39:16,539 --> 00:39:21,250
works<font color="#E5E5E5"> and it was cool</font>

818
00:39:19,030 --> 00:39:26,170
but I'm not I<font color="#E5E5E5"> don't have the mindset for</font>

819
00:39:21,250 --> 00:39:29,890
<font color="#E5E5E5">that</font><font color="#CCCCCC"> alright so let's go</font><font color="#E5E5E5"> ahead and do</font>

820
00:39:26,170 --> 00:39:32,710
some some log reviews weird my mouse go

821
00:39:29,890 --> 00:39:35,259
there we<font color="#E5E5E5"> go and I'm I've got</font><font color="#CCCCCC"> 8</font><font color="#E5E5E5"> minutes</font>

822
00:39:32,710 --> 00:39:36,910
<font color="#E5E5E5">remaining</font><font color="#CCCCCC"> so I think</font><font color="#E5E5E5"> I'm good here so</font>

823
00:39:35,260 --> 00:39:42,130
we're hoping up another terminal window

824
00:39:36,910 --> 00:39:46,410
and<font color="#CCCCCC"> OOP that's</font><font color="#E5E5E5"> the wrong operating</font>

825
00:39:42,130 --> 00:39:46,410
system let's<font color="#E5E5E5"> not do that</font>

826
00:39:50,630 --> 00:39:53,829
maybe it launches

827
00:39:56,089 --> 00:40:02,538
it's a new window<font color="#E5E5E5"> sorry I'm there we go</font>

828
00:40:00,859 --> 00:40:04,279
<font color="#CCCCCC">alright so now we're just</font><font color="#E5E5E5"> a standard</font>

829
00:40:02,539 --> 00:40:13,779
user so we're gonna go ahead and tail

830
00:40:04,279 --> 00:40:16,729
<font color="#CCCCCC">tack f VAR law or VAR DB santa-santa log</font>

831
00:40:13,779 --> 00:40:18,949
and then we're gonna<font color="#E5E5E5"> go ahead and pipe</font>

832
00:40:16,729 --> 00:40:23,058
that to grep<font color="#E5E5E5"> and I already did the pain</font>

833
00:40:18,949 --> 00:40:32,209
of<font color="#E5E5E5"> trying to figure</font><font color="#CCCCCC"> out the string tak e</font>

834
00:40:23,059 --> 00:40:34,069
<font color="#E5E5E5">on a known period star Google</font><font color="#CCCCCC"> alright so</font>

835
00:40:32,209 --> 00:40:38,299
what this is gonna do if I did this

836
00:40:34,069 --> 00:40:40,430
<font color="#CCCCCC">right is</font><font color="#E5E5E5"> this is gonna just</font><font color="#CCCCCC"> run and so</font>

837
00:40:38,299 --> 00:40:43,069
when I open up Firefox<font color="#CCCCCC"> it's not gonna</font>

838
00:40:40,430 --> 00:40:46,549
<font color="#E5E5E5">show</font><font color="#CCCCCC"> up</font><font color="#E5E5E5"> in the log because I'm filtering</font>

839
00:40:43,069 --> 00:40:48,529
<font color="#E5E5E5">it notice the</font><font color="#CCCCCC"> the log doesn't do</font>

840
00:40:46,549 --> 00:40:51,949
anything<font color="#E5E5E5"> so now let's go ahead and run</font>

841
00:40:48,529 --> 00:40:59,869
Google<font color="#E5E5E5"> Chrome and hey lots lots of noise</font>

842
00:40:51,949 --> 00:41:11,119
and lots<font color="#CCCCCC"> of windows that are so remember</font>

843
00:40:59,869 --> 00:41:18,799
how I talked about<font color="#E5E5E5"> the search</font><font color="#CCCCCC"> shot</font><font color="#E5E5E5"> so</font>

844
00:41:11,119 --> 00:41:22,099
we're gonna go ahead and<font color="#CCCCCC"> copy this</font><font color="#E5E5E5"> we're</font>

845
00:41:18,799 --> 00:41:28,429
go back to the other terminal<font color="#E5E5E5"> window</font><font color="#CCCCCC"> and</font>

846
00:41:22,099 --> 00:41:31,959
we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> santé CTO tactic</font><font color="#E5E5E5"> or</font>

847
00:41:28,429 --> 00:41:31,959
<font color="#E5E5E5">sorry rule</font><font color="#CCCCCC"> tack</font><font color="#E5E5E5"> tack</font>

848
00:41:35,910 --> 00:41:40,288
sorry I'm not able<font color="#CCCCCC"> to spell</font><font color="#E5E5E5"> and speak at</font>

849
00:41:38,789 --> 00:41:42,450
the<font color="#CCCCCC"> same</font><font color="#E5E5E5"> time it's like chewing</font>

850
00:41:40,289 --> 00:41:45,539
<font color="#CCCCCC">bubblegum and walking alright so we're</font>

851
00:41:42,450 --> 00:41:50,939
gonna go<font color="#CCCCCC"> ahead and paste</font><font color="#E5E5E5"> that in we've</font>

852
00:41:45,539 --> 00:41:59,000
added a rule that so uh<font color="#E5E5E5"> so let's go</font>

853
00:41:50,940 --> 00:41:59,000
ahead<font color="#E5E5E5"> and go</font><font color="#CCCCCC"> back to our</font><font color="#E5E5E5"> log here oops</font>

854
00:41:59,420 --> 00:42:09,329
clear<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> and let's run that same</font>

855
00:42:04,799 --> 00:42:10,009
again right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> where'd that mouse go</font>

856
00:42:09,329 --> 00:42:13,530
there we<font color="#E5E5E5"> go</font>

857
00:42:10,010 --> 00:42:15,630
run<font color="#CCCCCC"> google chrome</font><font color="#E5E5E5"> again</font><font color="#CCCCCC"> well launch but</font>

858
00:42:13,530 --> 00:42:17,480
<font color="#CCCCCC">it broke again</font><font color="#E5E5E5"> so why is that that's</font>

859
00:42:15,630 --> 00:42:21,660
because<font color="#E5E5E5"> Google used two different</font>

860
00:42:17,480 --> 00:42:24,930
certificates to run in<font color="#E5E5E5"> this case the</font>

861
00:42:21,660 --> 00:42:28,440
there's a helper<font color="#CCCCCC"> sub application that</font>

862
00:42:24,930 --> 00:42:30,450
uses a different<font color="#CCCCCC"> sort of</font><font color="#E5E5E5"> certificate but</font>

863
00:42:28,440 --> 00:42:32,280
<font color="#E5E5E5">Google will launch but I don't think</font>

864
00:42:30,450 --> 00:42:33,689
<font color="#E5E5E5">that's gonna</font><font color="#CCCCCC"> work for</font><font color="#E5E5E5"> my users I don't</font>

865
00:42:32,280 --> 00:42:37,500
want to teach them<font color="#E5E5E5"> to just click through</font>

866
00:42:33,690 --> 00:42:39,480
warnings so that's a different cert from

867
00:42:37,500 --> 00:42:44,970
<font color="#E5E5E5">the last time so we're gonna go</font><font color="#CCCCCC"> ahead</font>

868
00:42:39,480 --> 00:42:48,859
<font color="#CCCCCC">and copy that</font><font color="#E5E5E5"> and we're gonna go back</font>

869
00:42:44,970 --> 00:42:48,859
here I'm<font color="#CCCCCC"> going to do</font>

870
00:42:54,780 --> 00:43:10,140
white<font color="#CCCCCC"> whitelist</font>

871
00:42:58,640 --> 00:43:13,440
tactic not<font color="#CCCCCC"> 245 256 cool all right so now</font>

872
00:43:10,140 --> 00:43:19,379
<font color="#E5E5E5">that's added</font><font color="#CCCCCC"> I know</font><font color="#E5E5E5"> let's</font><font color="#CCCCCC"> go ahead and</font>

873
00:43:13,440 --> 00:43:20,910
close<font color="#E5E5E5"> Chrome launch it again success no</font>

874
00:43:19,380 --> 00:43:23,850
errors<font color="#E5E5E5"> works like a champ</font>

875
00:43:20,910 --> 00:43:27,240
what<font color="#E5E5E5"> about Firefox get out of here don't</font>

876
00:43:23,850 --> 00:43:29,279
<font color="#E5E5E5">work so that's that's Google Santa in a</font>

877
00:43:27,240 --> 00:43:31,169
nutshell it AppLocker works the same way

878
00:43:29,280 --> 00:43:33,060
<font color="#E5E5E5">just a lot more click Next it's a lot</font>

879
00:43:31,170 --> 00:43:36,000
more pretty GUI dialog boxes for your

880
00:43:33,060 --> 00:43:37,230
<font color="#CCCCCC">junior admins</font><font color="#E5E5E5"> one cool</font><font color="#CCCCCC"> thing you</font><font color="#E5E5E5"> could</font>

881
00:43:36,000 --> 00:43:40,140
do with this one thing I'd love to see

882
00:43:37,230 --> 00:43:42,600
done is piping these logs back into an

883
00:43:40,140 --> 00:43:44,370
elk stack and then aggregating them so

884
00:43:42,600 --> 00:43:46,020
say you're running<font color="#E5E5E5"> Mac OS on say</font><font color="#CCCCCC"> a</font>

885
00:43:44,370 --> 00:43:47,940
<font color="#CCCCCC">hundred</font><font color="#E5E5E5"> users and you've never done</font>

886
00:43:46,020 --> 00:43:50,310
<font color="#CCCCCC">white</font><font color="#E5E5E5"> listing I want to pipe that all</font>

887
00:43:47,940 --> 00:43:52,710
<font color="#CCCCCC">into</font><font color="#E5E5E5"> elk aggregate what applications are</font>

888
00:43:50,310 --> 00:43:53,430
being run<font color="#E5E5E5"> and then start pushing</font><font color="#CCCCCC"> out</font>

889
00:43:52,710 --> 00:43:56,220
<font color="#CCCCCC">whitelist</font>

890
00:43:53,430 --> 00:43:58,350
<font color="#E5E5E5">audits and decrease the noise and then</font>

891
00:43:56,220 --> 00:43:59,879
enforce<font color="#E5E5E5"> it on</font><font color="#CCCCCC"> a single day</font><font color="#E5E5E5"> because you</font>

892
00:43:58,350 --> 00:44:02,190
should be<font color="#CCCCCC"> able to aggregate these logs</font>

893
00:43:59,880 --> 00:44:03,990
<font color="#CCCCCC">across your environment and elk</font><font color="#E5E5E5"> figure</font>

894
00:44:02,190 --> 00:44:06,390
<font color="#E5E5E5">out what the common applications are in</font>

895
00:44:03,990 --> 00:44:08,640
your<font color="#CCCCCC"> environment</font><font color="#E5E5E5"> and whitelist them but</font>

896
00:44:06,390 --> 00:44:14,509
I haven't<font color="#E5E5E5"> gotten there Security's hard</font>

897
00:44:08,640 --> 00:44:16,819
and<font color="#CCCCCC"> time consuming</font><font color="#E5E5E5"> so any any questions</font>

898
00:44:14,510 --> 00:44:20,370
<font color="#E5E5E5">what's that</font>

899
00:44:16,820 --> 00:44:22,890
you sure can yeah Google<font color="#E5E5E5"> Santa allows</font>

900
00:44:20,370 --> 00:44:25,100
for path and hash so you could in theory

901
00:44:22,890 --> 00:44:27,420
whitelist<font color="#CCCCCC"> uh I</font><font color="#E5E5E5"> just don't trust paths</font>

902
00:44:25,100 --> 00:44:30,560
<font color="#CCCCCC">people like you get into the path</font><font color="#E5E5E5"> and</font>

903
00:44:27,420 --> 00:44:30,560
drop binaries<font color="#E5E5E5"> and then run them</font>

904
00:44:30,700 --> 00:44:34,910
[Laughter]

905
00:44:44,420 --> 00:44:55,110
yeah that's correct<font color="#E5E5E5"> right</font><font color="#CCCCCC"> well we're</font>

906
00:44:52,530 --> 00:44:57,420
we're<font color="#E5E5E5"> uh whitelisting the certificate</font>

907
00:44:55,110 --> 00:44:59,130
signing<font color="#E5E5E5"> and so hopefully</font><font color="#CCCCCC"> and I don't</font>

908
00:44:57,420 --> 00:45:01,200
know this<font color="#CCCCCC"> for a fact I know on Windows</font>

909
00:44:59,130 --> 00:45:02,970
this is true hopefully the shot of<font color="#E5E5E5"> the</font>

910
00:45:01,200 --> 00:45:04,680
certificate<font color="#CCCCCC"> doesn't change</font><font color="#E5E5E5"> particularly</font>

911
00:45:02,970 --> 00:45:06,419
often<font color="#E5E5E5"> right because certificates are</font>

912
00:45:04,680 --> 00:45:09,330
usually valid<font color="#E5E5E5"> for three years</font>

913
00:45:06,420 --> 00:45:10,950
so usually<font color="#CCCCCC"> MIT vendors don't</font><font color="#E5E5E5"> change that</font>

914
00:45:09,330 --> 00:45:14,330
certificate particularly<font color="#CCCCCC"> often</font><font color="#E5E5E5"> and</font>

915
00:45:10,950 --> 00:45:16,109
that's<font color="#E5E5E5"> why I'm pushing using certificate</font>

916
00:45:14,330 --> 00:45:18,990
<font color="#CCCCCC">whitelisting is because it's a more</font>

917
00:45:16,110 --> 00:45:21,750
reliable<font color="#E5E5E5"> way than than</font><font color="#CCCCCC"> just the path or</font>

918
00:45:18,990 --> 00:45:23,850
the hash of the file<font color="#E5E5E5"> itself the signing</font>

919
00:45:21,750 --> 00:45:25,770
certificates rarely change<font color="#E5E5E5"> it's like the</font>

920
00:45:23,850 --> 00:45:29,250
SSL certs on websites<font color="#E5E5E5"> right how those</font>

921
00:45:25,770 --> 00:45:35,490
get<font color="#CCCCCC"> rotated every</font><font color="#E5E5E5"> three years</font><font color="#CCCCCC"> so usually</font>

922
00:45:29,250 --> 00:45:40,530
they're a reliable indicator usually any

923
00:45:35,490 --> 00:45:44,120
other questions awesome<font color="#CCCCCC"> so thank you</font>

924
00:45:40,530 --> 00:45:44,120
everyone<font color="#CCCCCC"> hope this taught you</font><font color="#E5E5E5"> something</font>

