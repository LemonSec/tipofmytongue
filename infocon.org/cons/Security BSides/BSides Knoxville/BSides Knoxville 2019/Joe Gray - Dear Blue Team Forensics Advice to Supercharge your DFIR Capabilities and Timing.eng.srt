1
00:00:00,860 --> 00:00:07,410
all right cool so welcome to dear blue

2
00:00:04,799 --> 00:00:10,950
team so basically I'm just trying to

3
00:00:07,410 --> 00:00:12,690
provide a little bit of advice from a

4
00:00:10,950 --> 00:00:15,120
forensics point of view for non

5
00:00:12,690 --> 00:00:17,400
forensics people to basically expedite

6
00:00:15,120 --> 00:00:19,020
your capabilities before we get started

7
00:00:17,400 --> 00:00:21,330
the thoughts and opinions that I express

8
00:00:19,020 --> 00:00:23,070
today do not really reflect those of IBM

9
00:00:21,330 --> 00:00:24,389
I say this because I'm a senior security

10
00:00:23,070 --> 00:00:26,699
architect at IBM

11
00:00:24,390 --> 00:00:27,900
I'm also 2017 derbycon social

12
00:00:26,699 --> 00:00:30,599
engineering capture the flag winner

13
00:00:27,900 --> 00:00:32,879
member of the no lacan third place

14
00:00:30,599 --> 00:00:34,980
ascent capture the flag team

15
00:00:32,880 --> 00:00:36,870
I write for Forbes I used to navigate

16
00:00:34,980 --> 00:00:38,809
submarines I'm writing a book with no

17
00:00:36,870 --> 00:00:42,059
starch that's about it with that so

18
00:00:38,809 --> 00:00:46,890
basically why this topic in this talk so

19
00:00:42,059 --> 00:00:50,399
I was working on sans forensics 508

20
00:00:46,890 --> 00:00:52,770
which corresponds to G CFA basically

21
00:00:50,399 --> 00:00:54,539
it's advanced Incident Response digital

22
00:00:52,770 --> 00:00:57,930
forensics and threat hunting and

23
00:00:54,539 --> 00:01:01,800
basically I'm somewhat of an academic at

24
00:00:57,930 --> 00:01:04,349
heart so I always try to synthesize the

25
00:01:01,800 --> 00:01:05,489
synergy and cohesion okay I was just

26
00:01:04,349 --> 00:01:07,589
playing buzzword bingo there for a

27
00:01:05,489 --> 00:01:10,439
second but I do try to synthesize the

28
00:01:07,590 --> 00:01:14,970
things that I that I'm learning and find

29
00:01:10,439 --> 00:01:16,830
application for it sometimes in a use

30
00:01:14,970 --> 00:01:18,390
case scenario sometimes in the abuse

31
00:01:16,830 --> 00:01:21,570
case scenario it's just whichever is

32
00:01:18,390 --> 00:01:23,820
more appropriate in this case it's a use

33
00:01:21,570 --> 00:01:26,520
case scenario so basically this is the

34
00:01:23,820 --> 00:01:27,779
whole outcome of those thoughts so to

35
00:01:26,520 --> 00:01:30,450
start out with like baseline knowledge

36
00:01:27,780 --> 00:01:33,000
just to level the playing field d fear

37
00:01:30,450 --> 00:01:36,900
DF ir it's digital forensics an incident

38
00:01:33,000 --> 00:01:39,090
response basically Incident Response is

39
00:01:36,900 --> 00:01:42,119
the big picture of what you're doing to

40
00:01:39,090 --> 00:01:44,159
overcome an adverse event so an incident

41
00:01:42,119 --> 00:01:45,600
is an adverse event of an event is

42
00:01:44,159 --> 00:01:50,759
anything that happens on an information

43
00:01:45,600 --> 00:01:54,119
system incident handling is also the big

44
00:01:50,759 --> 00:01:55,590
picture even even more so than incident

45
00:01:54,119 --> 00:01:56,939
response because Incident Response is

46
00:01:55,590 --> 00:01:58,680
considered the technical components

47
00:01:56,939 --> 00:02:01,139
whereas incident handling brings in the

48
00:01:58,680 --> 00:02:03,689
business unit may bring in legal and

49
00:02:01,140 --> 00:02:07,259
some other organizations and that's per

50
00:02:03,689 --> 00:02:08,818
the Internet storm center so we commonly

51
00:02:07,259 --> 00:02:11,370
hear about pike curl that's the actual

52
00:02:08,818 --> 00:02:13,540
incident response process NIST has a

53
00:02:11,370 --> 00:02:16,200
similar process but

54
00:02:13,540 --> 00:02:19,120
it's not quite as catchy in terms of

55
00:02:16,200 --> 00:02:22,048
nomenclature as pike girl so basically

56
00:02:19,120 --> 00:02:25,090
it's preparation identification

57
00:02:22,049 --> 00:02:28,000
containment eradication recovery lessons

58
00:02:25,090 --> 00:02:29,739
learned so basically at any given time

59
00:02:28,000 --> 00:02:31,090
if you're not actively involved in an

60
00:02:29,739 --> 00:02:34,030
incident you are in the preparation

61
00:02:31,090 --> 00:02:36,040
phase or maybe on the cusp of lessons

62
00:02:34,030 --> 00:02:39,849
learned in preparation depending on when

63
00:02:36,040 --> 00:02:42,459
the last incident occurred so something

64
00:02:39,849 --> 00:02:45,310
that we also put into the equation is

65
00:02:42,459 --> 00:02:48,159
threat intelligence so where does it fit

66
00:02:45,310 --> 00:02:50,379
in is threat intelligence derivative of

67
00:02:48,159 --> 00:02:54,239
incident response or is it consumed by

68
00:02:50,379 --> 00:02:58,358
Incident Response so I mean with that

69
00:02:54,239 --> 00:03:00,790
the answer to that is yes so especially

70
00:02:58,359 --> 00:03:03,069
if you're doing like threat hunting

71
00:03:00,790 --> 00:03:04,900
you're certainly going to be consuming

72
00:03:03,069 --> 00:03:06,220
threat intelligence but if you're

73
00:03:04,900 --> 00:03:08,049
responding to something you may be

74
00:03:06,220 --> 00:03:09,670
producing it or comparing it against

75
00:03:08,049 --> 00:03:12,879
someone else's threat intelligence to

76
00:03:09,670 --> 00:03:14,768
try to do that pesky attribution that

77
00:03:12,879 --> 00:03:18,040
every vendor wants to wants everyone to

78
00:03:14,769 --> 00:03:20,739
believe that they're doing so with

79
00:03:18,040 --> 00:03:23,410
regards to that yet I would say that D

80
00:03:20,739 --> 00:03:25,299
fear and threat intelligence in this

81
00:03:23,410 --> 00:03:29,590
case I used CT I for cyber threat

82
00:03:25,299 --> 00:03:31,780
intelligence are they one of the same no

83
00:03:29,590 --> 00:03:35,530
there they're complementary to each

84
00:03:31,780 --> 00:03:37,660
other so a preconceived notion that I

85
00:03:35,530 --> 00:03:39,519
had taking the course I had didn't

86
00:03:37,660 --> 00:03:42,430
really have a whole lot of forensics

87
00:03:39,519 --> 00:03:45,250
knowledge going in and I was familiar

88
00:03:42,430 --> 00:03:47,650
with like file carving and things like

89
00:03:45,250 --> 00:03:49,359
file system forensics so anything you

90
00:03:47,650 --> 00:03:51,699
could do with like sleuth kit autopsy

91
00:03:49,359 --> 00:03:54,099
that kind of stuff I didn't even think

92
00:03:51,699 --> 00:03:56,799
about network and memory forensics so a

93
00:03:54,099 --> 00:03:59,138
lot of this is actually heavy on the

94
00:03:56,799 --> 00:04:02,790
memory forensics side so I've detailed a

95
00:03:59,139 --> 00:04:05,889
few tools that you could play with

96
00:04:02,790 --> 00:04:08,319
actually they're free as well the only

97
00:04:05,889 --> 00:04:10,299
one that could cost would be network

98
00:04:08,319 --> 00:04:12,369
miner if you pay for the license with

99
00:04:10,299 --> 00:04:16,630
that but the free version is a pretty

100
00:04:12,370 --> 00:04:19,060
hardcore in itself but anyway if you

101
00:04:16,630 --> 00:04:20,589
download sift the sands investigative

102
00:04:19,060 --> 00:04:22,110
forensic toolkit most of the things are

103
00:04:20,589 --> 00:04:27,250
already there there are other

104
00:04:22,110 --> 00:04:27,630
distributions similar to sift one used

105
00:04:27,250 --> 00:04:29,610
to be

106
00:04:27,630 --> 00:04:31,080
kein the computer-aided investigative

107
00:04:29,610 --> 00:04:34,350
networking environment it's not been

108
00:04:31,080 --> 00:04:36,330
maintained so I mean sift is pretty much

109
00:04:34,350 --> 00:04:38,010
the most up-to-date one that you're

110
00:04:36,330 --> 00:04:39,479
going to get most of these things are

111
00:04:38,010 --> 00:04:43,710
already there except for the things that

112
00:04:39,480 --> 00:04:46,020
have to be Windows like network miner so

113
00:04:43,710 --> 00:04:47,520
and to some degree Kali has the

114
00:04:46,020 --> 00:04:49,890
capability I mean I don't necessarily

115
00:04:47,520 --> 00:04:51,000
think I would use Kali for that but if

116
00:04:49,890 --> 00:04:53,070
you're in a pinch and that's all you've

117
00:04:51,000 --> 00:04:54,630
got it'll work you've got volatility

118
00:04:53,070 --> 00:04:56,159
there you've got some of the other tools

119
00:04:54,630 --> 00:04:57,480
but they're not necessarily there for

120
00:04:56,160 --> 00:05:00,320
the purpose of doing forensics they're

121
00:04:57,480 --> 00:05:02,280
more there for more nefarious reasons

122
00:05:00,320 --> 00:05:04,170
also we have rim necks the reverse

123
00:05:02,280 --> 00:05:06,450
engineering malware distribution you can

124
00:05:04,170 --> 00:05:08,880
install it on top of sift or sift on top

125
00:05:06,450 --> 00:05:11,460
of it whichever you see fit so you could

126
00:05:08,880 --> 00:05:14,100
play the two off of each other but

127
00:05:11,460 --> 00:05:15,719
anyway the third type of forensics aside

128
00:05:14,100 --> 00:05:17,940
from file system and memory would be

129
00:05:15,720 --> 00:05:19,500
networking that's dealing with breaking

130
00:05:17,940 --> 00:05:23,640
pcaps up figuring out what's going on

131
00:05:19,500 --> 00:05:26,250
there and the one thing to think about

132
00:05:23,640 --> 00:05:27,719
with this is I know by the talk title

133
00:05:26,250 --> 00:05:30,870
and I deliberately did this because I'm

134
00:05:27,720 --> 00:05:32,970
a huge fan of clickbait talk titles this

135
00:05:30,870 --> 00:05:36,390
is not a thread hunting presentation so

136
00:05:32,970 --> 00:05:38,700
the proactive advice I'm giving you has

137
00:05:36,390 --> 00:05:41,039
nothing to do with like thread hunting

138
00:05:38,700 --> 00:05:43,110
I'll discuss it on this slide in the

139
00:05:41,040 --> 00:05:45,570
next but it's not something that we're

140
00:05:43,110 --> 00:05:47,190
gonna go into the fine details with so I

141
00:05:45,570 --> 00:05:48,570
mean when we talk about thread hunting

142
00:05:47,190 --> 00:05:50,460
and we want to look at tools and

143
00:05:48,570 --> 00:05:51,540
techniques a lot of a lot of the tools

144
00:05:50,460 --> 00:05:53,010
and techniques you're going to use for

145
00:05:51,540 --> 00:05:54,540
thread hunting are identical to those

146
00:05:53,010 --> 00:05:57,630
that you're going to use in responding

147
00:05:54,540 --> 00:06:00,300
to an incident basically thread hunting

148
00:05:57,630 --> 00:06:02,010
versus forensics thread hunting is

149
00:06:00,300 --> 00:06:03,870
before you know you have an incident

150
00:06:02,010 --> 00:06:06,289
forensics is after you know you have one

151
00:06:03,870 --> 00:06:08,340
so it's pretty much the same thing

152
00:06:06,290 --> 00:06:09,930
there's a lot of benefits to it because

153
00:06:08,340 --> 00:06:12,000
it's going to expedite your incident

154
00:06:09,930 --> 00:06:13,710
response time it's going to help you

155
00:06:12,000 --> 00:06:16,200
maintain some cleaner architecture

156
00:06:13,710 --> 00:06:18,840
probably save some brand reputation

157
00:06:16,200 --> 00:06:22,140
damage that could come about but the

158
00:06:18,840 --> 00:06:23,669
problem with that is maturity using the

159
00:06:22,140 --> 00:06:25,110
Center for internet securities critical

160
00:06:23,670 --> 00:06:27,090
security controls formerly known as the

161
00:06:25,110 --> 00:06:28,950
sans top 20 if you're not meeting about

162
00:06:27,090 --> 00:06:31,049
15 of those you're probably not at a

163
00:06:28,950 --> 00:06:33,450
maturity level to even invest in that

164
00:06:31,050 --> 00:06:35,580
because thread hunting is based about on

165
00:06:33,450 --> 00:06:36,360
what is deviating from what is

166
00:06:35,580 --> 00:06:39,930
considered normal

167
00:06:36,360 --> 00:06:41,280
if you don't have say an inventory of

168
00:06:39,930 --> 00:06:43,230
authorized and unauthorized

169
00:06:41,280 --> 00:06:47,070
software or authorized an unauthorized

170
00:06:43,230 --> 00:06:48,510
Hardware how can you do hunt operations

171
00:06:47,070 --> 00:06:52,409
against it if you don't know what's

172
00:06:48,510 --> 00:06:54,240
there if you don't have your access

173
00:06:52,410 --> 00:06:55,800
management in check and everybody has a

174
00:06:54,240 --> 00:06:57,780
local admin what's the point

175
00:06:55,800 --> 00:07:00,840
you've got other fish to fry so you need

176
00:06:57,780 --> 00:07:03,510
that level of maturity with it so

177
00:07:00,840 --> 00:07:05,580
looking at the comparison for forensics

178
00:07:03,510 --> 00:07:07,950
it's very reactive you don't really need

179
00:07:05,580 --> 00:07:10,830
the prerequisites like you would with

180
00:07:07,950 --> 00:07:14,130
threat hunting sometimes you're notified

181
00:07:10,830 --> 00:07:18,659
via law enforcement could be monitoring

182
00:07:14,130 --> 00:07:20,219
it could be activity I'll specifically

183
00:07:18,660 --> 00:07:21,990
phrase this a certain way

184
00:07:20,220 --> 00:07:24,690
Jason Street used to say that a certain

185
00:07:21,990 --> 00:07:26,250
journalist should not be your IDs so in

186
00:07:24,690 --> 00:07:27,600
light of the whole doxxing thing that

187
00:07:26,250 --> 00:07:31,050
happened I'm just gonna say that

188
00:07:27,600 --> 00:07:33,930
journalists should not be your IDs but

189
00:07:31,050 --> 00:07:36,510
basically the aim of forensics like the

190
00:07:33,930 --> 00:07:37,380
D fair process is to get things back up

191
00:07:36,510 --> 00:07:39,450
and running as quickly as possible

192
00:07:37,380 --> 00:07:41,880
because time is money and most

193
00:07:39,450 --> 00:07:45,539
businesses want to get everything back

194
00:07:41,880 --> 00:07:47,070
up out of the incident scenario and back

195
00:07:45,540 --> 00:07:49,050
to normal as quickly as possible and

196
00:07:47,070 --> 00:07:50,969
that creates a huge dilemma between the

197
00:07:49,050 --> 00:07:53,040
security office and the rest of the

198
00:07:50,970 --> 00:07:54,300
business not that there was already any

199
00:07:53,040 --> 00:07:57,479
tension between security and the

200
00:07:54,300 --> 00:07:59,100
business but it's there so again with

201
00:07:57,479 --> 00:08:01,289
threat hunting you've got your maturity

202
00:07:59,100 --> 00:08:02,880
your size your capabilities if you if

203
00:08:01,289 --> 00:08:05,669
you don't have that maturity level then

204
00:08:02,880 --> 00:08:06,960
you probably don't need to do it if you

205
00:08:05,669 --> 00:08:10,169
don't have your own Incident Response

206
00:08:06,960 --> 00:08:12,960
Team it may be better that you don't do

207
00:08:10,169 --> 00:08:15,390
it because you can hire a consulting

208
00:08:12,960 --> 00:08:18,000
firm to come in and give them 40 60 80

209
00:08:15,390 --> 00:08:20,070
hours to do it but you've got to factor

210
00:08:18,000 --> 00:08:21,690
in that they aren't they're only gonna

211
00:08:20,070 --> 00:08:23,580
know what you tell them and that could

212
00:08:21,690 --> 00:08:25,890
be derivative of what you volunteer them

213
00:08:23,580 --> 00:08:28,440
or what they ask they're probably not

214
00:08:25,890 --> 00:08:30,000
going to have the intricate knowledge of

215
00:08:28,440 --> 00:08:32,969
your architecture to understand

216
00:08:30,000 --> 00:08:34,169
normality so as a by-product is that

217
00:08:32,969 --> 00:08:36,659
you're going to kind of sell yourself a

218
00:08:34,169 --> 00:08:39,449
little bit short if you need to consult

219
00:08:36,659 --> 00:08:40,530
someone to do it you could but if you

220
00:08:39,450 --> 00:08:42,659
have your own incident response team

221
00:08:40,530 --> 00:08:43,890
that understands what is normal and

222
00:08:42,659 --> 00:08:45,000
maybe even throw a few system

223
00:08:43,890 --> 00:08:46,980
administrators maybe a network

224
00:08:45,000 --> 00:08:49,170
administrator on that team you're gonna

225
00:08:46,980 --> 00:08:50,970
get far better results again it's

226
00:08:49,170 --> 00:08:53,010
proactive in nature it is based around

227
00:08:50,970 --> 00:08:54,100
what's normal and a lot of times it's

228
00:08:53,010 --> 00:08:56,439
very similar to a red teaming

229
00:08:54,100 --> 00:08:58,060
gage Minh a red team engagement versus a

230
00:08:56,440 --> 00:09:00,399
pen test is focusing on a specific

231
00:08:58,060 --> 00:09:02,709
objective such as like detection times

232
00:09:00,399 --> 00:09:04,779
detection capabilities it's not just

233
00:09:02,709 --> 00:09:05,888
trying to get in get domain admin before

234
00:09:04,779 --> 00:09:08,649
lunch and ring the bell

235
00:09:05,889 --> 00:09:10,060
right so with this you're taking a

236
00:09:08,649 --> 00:09:12,639
specific piece of threat intelligence

237
00:09:10,060 --> 00:09:14,439
and you are searching for it you're

238
00:09:12,639 --> 00:09:15,819
doing active tests against your

239
00:09:14,440 --> 00:09:18,370
infrastructure for it

240
00:09:15,819 --> 00:09:20,769
so within reason it's not based on the

241
00:09:18,370 --> 00:09:22,509
time objective so if you do have your

242
00:09:20,769 --> 00:09:24,190
own internal Incident Response Team it

243
00:09:22,509 --> 00:09:26,259
may be best suited that when they're not

244
00:09:24,190 --> 00:09:28,480
actively in incidents in other words in

245
00:09:26,259 --> 00:09:30,009
the preparation phase they're hunting

246
00:09:28,480 --> 00:09:32,769
and that's going to keep their skills

247
00:09:30,009 --> 00:09:34,269
sharp too so anyway here's the standard

248
00:09:32,769 --> 00:09:36,730
forensics talk we'll go ahead and get

249
00:09:34,269 --> 00:09:40,240
this out of the way logging you need to

250
00:09:36,730 --> 00:09:41,680
do it you need to do it verbose Lee send

251
00:09:40,240 --> 00:09:44,110
your logs somewhere else when possible

252
00:09:41,680 --> 00:09:45,638
solely on the fact of adversaries are

253
00:09:44,110 --> 00:09:48,269
gonna get in they're gonna try to cover

254
00:09:45,639 --> 00:09:50,560
their tracks they may do that via

255
00:09:48,269 --> 00:09:53,889
overwriting the logs they may do it

256
00:09:50,560 --> 00:10:00,099
using something like SRM which is going

257
00:09:53,889 --> 00:10:02,500
to delete the file and then run as or

258
00:10:00,100 --> 00:10:05,319
function over it so that it makes it

259
00:10:02,500 --> 00:10:06,939
even harder to recover and then

260
00:10:05,319 --> 00:10:08,110
obviously logs are gonna make you or

261
00:10:06,939 --> 00:10:11,680
break you

262
00:10:08,110 --> 00:10:13,630
inventory everything same thing the

263
00:10:11,680 --> 00:10:14,680
whole critical security controls number

264
00:10:13,630 --> 00:10:16,149
one and number two know what's

265
00:10:14,680 --> 00:10:18,160
authorized and unauthorized from the

266
00:10:16,149 --> 00:10:19,329
software and the hardware perspective if

267
00:10:18,160 --> 00:10:20,829
you're in a Windows environment there's

268
00:10:19,329 --> 00:10:22,689
a powershell script called con so that

269
00:10:20,829 --> 00:10:25,479
can help you with this basically you

270
00:10:22,689 --> 00:10:26,139
just write a for loop so for hosts in

271
00:10:25,480 --> 00:10:29,170
this file

272
00:10:26,139 --> 00:10:30,970
duquan so this dump it to a file and

273
00:10:29,170 --> 00:10:32,500
there you have it and then you could

274
00:10:30,970 --> 00:10:35,889
just parse that using regular expression

275
00:10:32,500 --> 00:10:37,120
into whatever tool you want to use but

276
00:10:35,889 --> 00:10:38,410
you need to update that inventory

277
00:10:37,120 --> 00:10:40,899
frequently it reminds me of that

278
00:10:38,410 --> 00:10:41,110
commercial comes on TV every now and

279
00:10:40,899 --> 00:10:42,670
then

280
00:10:41,110 --> 00:10:44,170
it's the woman that's got her credit

281
00:10:42,670 --> 00:10:45,670
score tattooed on her arm and she

282
00:10:44,170 --> 00:10:47,469
doesn't want to check her credit because

283
00:10:45,670 --> 00:10:48,790
she's afraid the scores gonna it'll

284
00:10:47,470 --> 00:10:50,740
affect the score and her tattoo will be

285
00:10:48,790 --> 00:10:51,279
null and void don't treat it like a

286
00:10:50,740 --> 00:10:54,100
tattoo

287
00:10:51,279 --> 00:10:57,040
I mean treat it like face painting you

288
00:10:54,100 --> 00:10:59,410
can change it it's going to change take

289
00:10:57,040 --> 00:11:00,969
take the time inventory it make sure

290
00:10:59,410 --> 00:11:02,500
that you're up to speed you know what's

291
00:11:00,970 --> 00:11:04,180
there because I mean so in some

292
00:11:02,500 --> 00:11:06,970
organizations things are going to change

293
00:11:04,180 --> 00:11:07,750
daily some weekly I would say monthly or

294
00:11:06,970 --> 00:11:09,430
quarterly might be

295
00:11:07,750 --> 00:11:13,090
your best interval for this depending on

296
00:11:09,430 --> 00:11:14,109
how fast your organization moves if

297
00:11:13,090 --> 00:11:15,820
you're in like a small mom-and-pop

298
00:11:14,110 --> 00:11:18,100
office I wouldn't worry about this too

299
00:11:15,820 --> 00:11:20,140
much but if you cover multiple time

300
00:11:18,100 --> 00:11:22,930
zones you might want to consider using

301
00:11:20,140 --> 00:11:24,460
UTC for your long time so you're not

302
00:11:22,930 --> 00:11:26,170
having to take your shoes off and count

303
00:11:24,460 --> 00:11:29,650
on your fingers and toes the time

304
00:11:26,170 --> 00:11:30,849
difference you probably do need NTP to

305
00:11:29,650 --> 00:11:33,340
make sure that everything is

306
00:11:30,850 --> 00:11:35,770
synchronized if you've got like a 30

307
00:11:33,340 --> 00:11:37,810
second lag between hosts that's going to

308
00:11:35,770 --> 00:11:39,460
skew any analysis that you do and when

309
00:11:37,810 --> 00:11:42,310
you drop this into a time line it's

310
00:11:39,460 --> 00:11:44,020
going to skew it further and baselines

311
00:11:42,310 --> 00:11:45,040
I can't hammer on baselines enough we're

312
00:11:44,020 --> 00:11:47,470
going to talk a little bit more about

313
00:11:45,040 --> 00:11:51,640
that later on some other things with

314
00:11:47,470 --> 00:11:54,210
this is notifications who do we notify

315
00:11:51,640 --> 00:11:56,770
when do we notify how do we notify

316
00:11:54,210 --> 00:11:59,260
because I do a lot of research in the

317
00:11:56,770 --> 00:12:03,100
social engineering field if someone

318
00:11:59,260 --> 00:12:04,840
clicks a fish reporting that they

319
00:12:03,100 --> 00:12:06,250
clicked it to trigger the incident

320
00:12:04,840 --> 00:12:08,530
response process of via email is

321
00:12:06,250 --> 00:12:10,270
probably not a good idea you should

322
00:12:08,530 --> 00:12:12,280
probably just go ahead and assume that

323
00:12:10,270 --> 00:12:14,579
it's compromised so you need to look it

324
00:12:12,280 --> 00:12:18,670
out-of-band communications things like

325
00:12:14,580 --> 00:12:20,650
encrypted texting apps texting walking

326
00:12:18,670 --> 00:12:23,709
over there I know for some of us that's

327
00:12:20,650 --> 00:12:25,300
a very foreign concept we don't want to

328
00:12:23,710 --> 00:12:28,960
get out of our cube but you kind of have

329
00:12:25,300 --> 00:12:31,599
to phone calls work if you want to go a

330
00:12:28,960 --> 00:12:33,100
little bit less conventional I mean

331
00:12:31,600 --> 00:12:37,420
there's always carrier pigeons you can

332
00:12:33,100 --> 00:12:39,580
do soup soup cans on a string if you're

333
00:12:37,420 --> 00:12:41,610
savvy with it and work outdoors you

334
00:12:39,580 --> 00:12:44,050
might be able to do like smoke signals

335
00:12:41,610 --> 00:12:46,000
Morse code if you've got some crypto

336
00:12:44,050 --> 00:12:49,089
nerds in your organization various ways

337
00:12:46,000 --> 00:12:51,370
you just don't want to necessarily say

338
00:12:49,089 --> 00:12:53,110
hey I think I've been compromised via

339
00:12:51,370 --> 00:12:54,610
email because depending on the adversary

340
00:12:53,110 --> 00:12:56,470
they can be reading every email anyway

341
00:12:54,610 --> 00:12:58,360
and when they see that they could very

342
00:12:56,470 --> 00:12:59,470
easily just drop it or modify there's so

343
00:12:58,360 --> 00:13:02,500
many things that could happen with it

344
00:12:59,470 --> 00:13:05,940
just don't even hedge that and then

345
00:13:02,500 --> 00:13:08,170
actions to take this is something that I

346
00:13:05,940 --> 00:13:11,140
wish there was a lot more discussion on

347
00:13:08,170 --> 00:13:12,670
so when something happens when you click

348
00:13:11,140 --> 00:13:14,800
a fish or something weird happens to

349
00:13:12,670 --> 00:13:16,300
your computer or the the not Pecha

350
00:13:14,800 --> 00:13:17,740
screen comes up or than what a Christ

351
00:13:16,300 --> 00:13:21,670
screen comes up what do you want them to

352
00:13:17,740 --> 00:13:23,080
do and this comes to a dichotomy that

353
00:13:21,670 --> 00:13:25,780
that kind of doesn't bother me within

354
00:13:23,080 --> 00:13:27,970
industry oftentimes we hear users are so

355
00:13:25,780 --> 00:13:30,699
stupid why can't they understand how to

356
00:13:27,970 --> 00:13:32,590
do security blah blah blah but at the

357
00:13:30,700 --> 00:13:35,590
same time we as security people don't

358
00:13:32,590 --> 00:13:37,180
care about how to interpret HR policy we

359
00:13:35,590 --> 00:13:39,810
don't care about how to maintain a

360
00:13:37,180 --> 00:13:41,949
ledger for accounting or a journal I

361
00:13:39,810 --> 00:13:44,079
really don't care about procurement as

362
00:13:41,950 --> 00:13:45,670
long as the people in procurement buy

363
00:13:44,080 --> 00:13:47,710
procure the things that I need to be

364
00:13:45,670 --> 00:13:50,020
procured in a timely manner so why

365
00:13:47,710 --> 00:13:52,480
should we expect people not in security

366
00:13:50,020 --> 00:13:54,010
to do security functions yes they need

367
00:13:52,480 --> 00:13:55,960
to be aware of it just as we need to be

368
00:13:54,010 --> 00:13:59,250
aware of other things outside of our

369
00:13:55,960 --> 00:14:01,960
bubble but we need to actually say

370
00:13:59,250 --> 00:14:04,570
explicitly these are the actions you

371
00:14:01,960 --> 00:14:05,890
take so do we want them to hibernate the

372
00:14:04,570 --> 00:14:07,840
system do we want them to power it off

373
00:14:05,890 --> 00:14:10,480
do we want them to lock it reset it do

374
00:14:07,840 --> 00:14:11,650
nothing log off I can't tell you the

375
00:14:10,480 --> 00:14:14,260
right answer because it depends on your

376
00:14:11,650 --> 00:14:17,560
organization of what's coming next so if

377
00:14:14,260 --> 00:14:19,300
you're just going to take it and rebuild

378
00:14:17,560 --> 00:14:21,280
it from scratch with known good media

379
00:14:19,300 --> 00:14:22,630
and not do a forensics process the

380
00:14:21,280 --> 00:14:24,870
answer might just be shut it off or

381
00:14:22,630 --> 00:14:27,580
unplug from the network one or the other

382
00:14:24,870 --> 00:14:28,540
and also with this you know we've got a

383
00:14:27,580 --> 00:14:29,620
factor in that we've got some

384
00:14:28,540 --> 00:14:31,839
non-technical employees in our

385
00:14:29,620 --> 00:14:33,430
organizations so I always think how

386
00:14:31,840 --> 00:14:35,530
would I instruct my mom to do this

387
00:14:33,430 --> 00:14:39,069
my mom's not exactly computer illiterate

388
00:14:35,530 --> 00:14:40,860
but she's maybe on a first grade reading

389
00:14:39,070 --> 00:14:43,630
level when it comes to technology

390
00:14:40,860 --> 00:14:44,980
proverbially speaking so I think about

391
00:14:43,630 --> 00:14:49,300
it from the perspective of she's sitting

392
00:14:44,980 --> 00:14:51,910
at a desk and something happens and the

393
00:14:49,300 --> 00:14:55,180
instruction is to remove the network

394
00:14:51,910 --> 00:14:57,280
cable if she looks at the back of that

395
00:14:55,180 --> 00:14:58,839
computer and everything is black cables

396
00:14:57,280 --> 00:15:03,189
everything's getting unplugged or

397
00:14:58,840 --> 00:15:06,310
nothing but if we say unplug the yellow

398
00:15:03,190 --> 00:15:09,610
cable and it's yellow cat5 she could do

399
00:15:06,310 --> 00:15:11,260
it if she's not confident with that she

400
00:15:09,610 --> 00:15:13,600
could just as easily cut it there's no

401
00:15:11,260 --> 00:15:16,060
risk of being shocked with that whereas

402
00:15:13,600 --> 00:15:18,100
if you cut the power cable you might

403
00:15:16,060 --> 00:15:21,989
look like Marv from home alone a little

404
00:15:18,100 --> 00:15:25,000
bit but basically you have to understand

405
00:15:21,990 --> 00:15:27,010
what what the response is and it depends

406
00:15:25,000 --> 00:15:28,660
on what you're going to do next some

407
00:15:27,010 --> 00:15:30,670
things that I definitely would say not

408
00:15:28,660 --> 00:15:33,189
to do and again these are highly

409
00:15:30,670 --> 00:15:35,199
dependent upon your own policy but a few

410
00:15:33,190 --> 00:15:38,139
things would be

411
00:15:35,200 --> 00:15:40,630
contaminate the Chain of Custody if a

412
00:15:38,139 --> 00:15:42,490
user account gets compromised don't go

413
00:15:40,630 --> 00:15:46,420
changing the password just disable the

414
00:15:42,490 --> 00:15:47,740
account or set up verbose logging with

415
00:15:46,420 --> 00:15:48,729
that setup simav ents depending on what

416
00:15:47,740 --> 00:15:50,529
you're gonna let them do if you're gonna

417
00:15:48,730 --> 00:15:52,510
let them continue then just increase

418
00:15:50,529 --> 00:15:53,860
your logging level if you want to stop

419
00:15:52,510 --> 00:15:55,420
them in their tracks just disable the

420
00:15:53,860 --> 00:15:57,370
account don't change the password

421
00:15:55,420 --> 00:15:59,860
because if you do have to go to court

422
00:15:57,370 --> 00:16:01,269
for any sort of litigious activities you

423
00:15:59,860 --> 00:16:04,899
have to have that chain of custody or

424
00:16:01,269 --> 00:16:07,980
else that person could walk so another

425
00:16:04,899 --> 00:16:11,430
example would be you get compromised

426
00:16:07,980 --> 00:16:15,639
with ransomware I think it was Sam Sam

427
00:16:11,430 --> 00:16:18,790
because you had RDP hanging open on the

428
00:16:15,639 --> 00:16:20,050
public internet without a VPN in between

429
00:16:18,790 --> 00:16:23,319
so it's just there for the scanning

430
00:16:20,050 --> 00:16:24,849
probably on show den and you log in via

431
00:16:23,320 --> 00:16:26,260
the administrator account with a four

432
00:16:24,850 --> 00:16:29,290
character password not that this has

433
00:16:26,260 --> 00:16:30,850
ever happened at all and then when you

434
00:16:29,290 --> 00:16:32,589
have someone come in to do incident

435
00:16:30,850 --> 00:16:34,779
response and they say hey could I see

436
00:16:32,589 --> 00:16:37,660
the host to poke around and look and

437
00:16:34,779 --> 00:16:39,010
they say oh no we deleted the VM it's

438
00:16:37,660 --> 00:16:40,060
probably not a good action to take if

439
00:16:39,010 --> 00:16:44,050
you actually want to find out what the

440
00:16:40,060 --> 00:16:46,000
real problem is so with that again so

441
00:16:44,050 --> 00:16:47,979
let's get into the cool stuff so with

442
00:16:46,000 --> 00:16:49,990
memory analysis there's a lot of ways

443
00:16:47,980 --> 00:16:52,480
that you could actually acquire the

444
00:16:49,990 --> 00:16:55,060
memory image in the Windows environment

445
00:16:52,480 --> 00:16:57,899
I'm a huge fan of using ftk imager lite

446
00:16:55,060 --> 00:17:01,449
it's free which is my favorite price

447
00:16:57,899 --> 00:17:03,670
there's a paid version as well also

448
00:17:01,449 --> 00:17:05,559
recall is a good tool for doing that

449
00:17:03,670 --> 00:17:08,079
it's built into Google Rapid Response

450
00:17:05,559 --> 00:17:10,329
the other cool thing about recall is it

451
00:17:08,079 --> 00:17:11,948
used to be a fork of volatility so it

452
00:17:10,329 --> 00:17:14,049
shares some aspects of the same source

453
00:17:11,949 --> 00:17:16,660
code but as it forked it's been

454
00:17:14,049 --> 00:17:20,020
maintained by Google and recall actually

455
00:17:16,660 --> 00:17:23,829
also works on Mac so that's something to

456
00:17:20,020 --> 00:17:27,760
keep in keep in mind lime that'll work

457
00:17:23,829 --> 00:17:30,220
for Linux and there's a mandate an

458
00:17:27,760 --> 00:17:32,260
intelligent response as well in terms of

459
00:17:30,220 --> 00:17:34,980
assessment volatility and recall or your

460
00:17:32,260 --> 00:17:38,230
primary command-line assessment tools

461
00:17:34,980 --> 00:17:39,610
from a GUI you've got red line one thing

462
00:17:38,230 --> 00:17:41,860
I'll warn you use something before

463
00:17:39,610 --> 00:17:45,070
version 1.2 0 they did away with what's

464
00:17:41,860 --> 00:17:47,049
called the MRI the malware risk index it

465
00:17:45,070 --> 00:17:47,439
takes forever to load if you're using an

466
00:17:47,049 --> 00:17:50,830
old

467
00:17:47,440 --> 00:17:54,610
version it's a java application but you

468
00:17:50,830 --> 00:17:56,259
get this you get a red circle on the

469
00:17:54,610 --> 00:17:58,750
left hand side and basically there's

470
00:17:56,259 --> 00:18:01,389
several heuristic checks they do within

471
00:17:58,750 --> 00:18:03,700
the script and the more malicious it

472
00:18:01,389 --> 00:18:05,080
seems the higher the number so you see

473
00:18:03,700 --> 00:18:06,669
something in the 90s it's definitely

474
00:18:05,080 --> 00:18:08,289
worth looking into

475
00:18:06,669 --> 00:18:10,899
the thing about redline is it's like a

476
00:18:08,289 --> 00:18:12,250
30,000 foot view and you're digging to

477
00:18:10,899 --> 00:18:16,469
the core of the earth when you're in

478
00:18:12,250 --> 00:18:20,620
volatility or recall so in that regard

479
00:18:16,470 --> 00:18:21,909
so with memory analysis you're trying to

480
00:18:20,620 --> 00:18:24,219
find out what's going on with the system

481
00:18:21,909 --> 00:18:26,740
you can you can spoof network

482
00:18:24,220 --> 00:18:28,299
connections you can modify files on the

483
00:18:26,740 --> 00:18:31,299
file system but if it's in memory it's

484
00:18:28,299 --> 00:18:32,918
more or less truth so if you want to

485
00:18:31,299 --> 00:18:36,610
find out when something was installed

486
00:18:32,919 --> 00:18:40,389
and it's saying 1 1 1970 and you're like

487
00:18:36,610 --> 00:18:42,158
I don't think that's the case if there's

488
00:18:40,389 --> 00:18:43,658
a registry key associated with it

489
00:18:42,159 --> 00:18:45,279
there's actually a volatility plug-in

490
00:18:43,659 --> 00:18:47,950
called the registry key creation date

491
00:18:45,279 --> 00:18:49,750
and when taking the course Rob Lee the

492
00:18:47,950 --> 00:18:51,639
course author basically says that to his

493
00:18:49,750 --> 00:18:55,330
knowledge there were no adversaries

494
00:18:51,639 --> 00:18:56,740
capable of spoofing that yet so I mean

495
00:18:55,330 --> 00:19:00,460
acknowledging that it can be spoofed

496
00:18:56,740 --> 00:19:02,500
later yes absolutely anything can be I

497
00:19:00,460 --> 00:19:04,330
mean it at one point in time someone

498
00:19:02,500 --> 00:19:08,529
thought ntlm couldn't be correct

499
00:19:04,330 --> 00:19:13,840
I mean at one point we considered our c4

500
00:19:08,529 --> 00:19:14,860
to be safe md5 sha-1 so it's a matter of

501
00:19:13,840 --> 00:19:17,889
time before something like that happens

502
00:19:14,860 --> 00:19:19,539
but as of right now and then you can

503
00:19:17,889 --> 00:19:21,279
also look at things outside of your

504
00:19:19,539 --> 00:19:22,480
system your syslog or your event log

505
00:19:21,279 --> 00:19:23,559
that's going to give you indications of

506
00:19:22,480 --> 00:19:25,809
what's going on in terms of the

507
00:19:23,559 --> 00:19:28,059
processes the execution and then you're

508
00:19:25,809 --> 00:19:31,450
able to cohesively look at things with

509
00:19:28,059 --> 00:19:32,918
like Network ports you can actually use

510
00:19:31,450 --> 00:19:35,529
it to replace a lot of the system kernel

511
00:19:32,919 --> 00:19:36,730
stuff because you've got proc Mon proc

512
00:19:35,529 --> 00:19:37,990
dump these are all plugins that are

513
00:19:36,730 --> 00:19:39,730
already there you don't have to download

514
00:19:37,990 --> 00:19:41,529
anything especially if you're using sift

515
00:19:39,730 --> 00:19:43,000
they're already there so you don't have

516
00:19:41,529 --> 00:19:44,080
to like if you're doing this in a lab

517
00:19:43,000 --> 00:19:45,490
environment you don't have to have

518
00:19:44,080 --> 00:19:47,740
sysinternals running that's one less

519
00:19:45,490 --> 00:19:49,720
thing and the good thing is some malware

520
00:19:47,740 --> 00:19:51,850
that you may play with if it sees

521
00:19:49,720 --> 00:19:53,889
sysinternals on there it's not going to

522
00:19:51,850 --> 00:19:55,539
execute so you can snap that memory

523
00:19:53,889 --> 00:19:56,260
image run the same tools out of the

524
00:19:55,539 --> 00:19:59,320
memory

525
00:19:56,260 --> 00:20:01,360
and the malware's none the wiser

526
00:19:59,320 --> 00:20:03,669
cross-reference of course you can feed

527
00:20:01,360 --> 00:20:05,320
it into a timeline you can look at the

528
00:20:03,670 --> 00:20:07,810
registry analysis and you can look for

529
00:20:05,320 --> 00:20:09,250
malware so lots of things you can do

530
00:20:07,810 --> 00:20:11,110
there here's some cooler things you can

531
00:20:09,250 --> 00:20:14,830
do so there's actually a Mimi Katz

532
00:20:11,110 --> 00:20:15,969
plugin so my social for indication talks

533
00:20:14,830 --> 00:20:18,129
that I gave yesterday and that I'm

534
00:20:15,970 --> 00:20:19,990
giving tomorrow actually deals with

535
00:20:18,130 --> 00:20:21,520
stealing a memory image for the purpose

536
00:20:19,990 --> 00:20:25,300
of using some of these more nefarious

537
00:20:21,520 --> 00:20:27,220
scripts like Mimi cats and hash dump but

538
00:20:25,300 --> 00:20:29,169
you can also look at the running

539
00:20:27,220 --> 00:20:32,620
processes and identify rogue ones via

540
00:20:29,170 --> 00:20:34,240
the for processed ones there you've got

541
00:20:32,620 --> 00:20:36,790
Malphite mouse this proc that's pretty

542
00:20:34,240 --> 00:20:39,370
fun and then you can actually get the

543
00:20:36,790 --> 00:20:41,409
processes in two samples so you could

544
00:20:39,370 --> 00:20:43,090
actually get that sample uploaded into a

545
00:20:41,410 --> 00:20:45,370
virus total or something and actually

546
00:20:43,090 --> 00:20:48,459
get some sort of near immediate feedback

547
00:20:45,370 --> 00:20:50,469
some other stuff to consider you got

548
00:20:48,460 --> 00:20:52,150
prefetch so prefetch partially there's a

549
00:20:50,470 --> 00:20:55,170
good tool to deal with that it's a

550
00:20:52,150 --> 00:21:00,150
feature came with XP still in use now

551
00:20:55,170 --> 00:21:03,070
basically if you have prefetch

552
00:21:00,150 --> 00:21:04,000
configured and you don't have some

553
00:21:03,070 --> 00:21:06,700
prefetch files when you're conducting

554
00:21:04,000 --> 00:21:09,190
analysis that's a little sketchy but

555
00:21:06,700 --> 00:21:11,140
basically all it's going to do is it's

556
00:21:09,190 --> 00:21:13,000
going to get the specific data it's kind

557
00:21:11,140 --> 00:21:16,590
of like a cache if you will to help you

558
00:21:13,000 --> 00:21:21,040
help the applications run more smoothly

559
00:21:16,590 --> 00:21:23,409
from the same vein of caches you have

560
00:21:21,040 --> 00:21:25,780
the shim cache also known as the

561
00:21:23,410 --> 00:21:27,790
application compatibility hash or cache

562
00:21:25,780 --> 00:21:29,470
same thing it's going to look for the

563
00:21:27,790 --> 00:21:31,810
compatibility issues it's just basically

564
00:21:29,470 --> 00:21:34,060
trying to help things execute faster and

565
00:21:31,810 --> 00:21:35,470
more efficiently but you're also going

566
00:21:34,060 --> 00:21:36,850
to get other things recorded with this

567
00:21:35,470 --> 00:21:41,350
that you're not necessarily going to get

568
00:21:36,850 --> 00:21:43,629
with say prefetch such as the process

569
00:21:41,350 --> 00:21:45,820
execution flag modification times full

570
00:21:43,630 --> 00:21:48,880
file path all that fun stuff and that's

571
00:21:45,820 --> 00:21:50,379
in the registry as you can see there so

572
00:21:48,880 --> 00:21:53,800
now let's get into some of the more fun

573
00:21:50,380 --> 00:21:55,330
things so with this with processes you

574
00:21:53,800 --> 00:21:58,870
can always get hashes of your vital

575
00:21:55,330 --> 00:22:03,570
stuff and this really this is the true

576
00:21:58,870 --> 00:22:06,189
dear blue team part of this so system32

577
00:22:03,570 --> 00:22:06,840
maybe in the Windows environment you or

578
00:22:06,190 --> 00:22:08,100
I'm sorry the

579
00:22:06,840 --> 00:22:12,240
environment you might want to look at

580
00:22:08,100 --> 00:22:13,860
like Etsy bin and s been basically go in

581
00:22:12,240 --> 00:22:16,710
there you could do this very simple with

582
00:22:13,860 --> 00:22:20,370
like a batch a PowerShell Bosch whatever

583
00:22:16,710 --> 00:22:21,390
you want to use Python I mean if you're

584
00:22:20,370 --> 00:22:23,429
a glutton for punishment you could

585
00:22:21,390 --> 00:22:24,960
probably even write it and see but

586
00:22:23,430 --> 00:22:27,030
basically you'll write a for loop for

587
00:22:24,960 --> 00:22:28,560
all the files within the directory

588
00:22:27,030 --> 00:22:31,320
excluding whatever you want to exclude

589
00:22:28,560 --> 00:22:33,990
get an md5 of it because again we're not

590
00:22:31,320 --> 00:22:38,220
doing this for integrity we don't care

591
00:22:33,990 --> 00:22:39,480
about how secure the md5 is because

592
00:22:38,220 --> 00:22:41,190
we're just using it to check to see if

593
00:22:39,480 --> 00:22:44,100
something's been modified we're not

594
00:22:41,190 --> 00:22:47,460
trying to store passwords with it so get

595
00:22:44,100 --> 00:22:48,870
an md5 you can use md5 deep for that but

596
00:22:47,460 --> 00:22:50,670
then there's another thing called fuzzy

597
00:22:48,870 --> 00:22:54,800
hashing which is byte by byte hashing

598
00:22:50,670 --> 00:22:57,240
accomplished using SS deep and with that

599
00:22:54,800 --> 00:22:59,370
get a sample of that for each file as

600
00:22:57,240 --> 00:23:01,590
well so when you go through and you're

601
00:22:59,370 --> 00:23:04,139
doing analysis you can compare to the

602
00:23:01,590 --> 00:23:06,030
md5 s match yes okay move on do they not

603
00:23:04,140 --> 00:23:07,590
match okay what changed in the SS deep

604
00:23:06,030 --> 00:23:08,940
now you have a better understanding if

605
00:23:07,590 --> 00:23:10,980
what's changed in that file and you can

606
00:23:08,940 --> 00:23:12,510
actually ascertain is this something

607
00:23:10,980 --> 00:23:14,220
significant is this authorized as a

608
00:23:12,510 --> 00:23:16,530
sudden authorized is this collateral

609
00:23:14,220 --> 00:23:18,750
damage what's going on same thing with

610
00:23:16,530 --> 00:23:22,410
the registry catalog as much of it as

611
00:23:18,750 --> 00:23:24,480
possible but you could script it to

612
00:23:22,410 --> 00:23:27,090
parse for certain keys whatever you want

613
00:23:24,480 --> 00:23:28,830
to do but basically you want to look at

614
00:23:27,090 --> 00:23:30,959
those registry key creation dates with

615
00:23:28,830 --> 00:23:33,120
the updates with every time you do

616
00:23:30,960 --> 00:23:35,730
significant updates to the computer so

617
00:23:33,120 --> 00:23:37,409
that whenever something happens you can

618
00:23:35,730 --> 00:23:40,680
go back and say well here's the creation

619
00:23:37,410 --> 00:23:43,380
date with this so I said we're going to

620
00:23:40,680 --> 00:23:45,660
talk about baselines here we are with

621
00:23:43,380 --> 00:23:48,170
baselines there are three baseline

622
00:23:45,660 --> 00:23:51,840
plugins associated with volatility

623
00:23:48,170 --> 00:23:54,750
process server and Driver so if you have

624
00:23:51,840 --> 00:23:57,899
a known good memory image you can

625
00:23:54,750 --> 00:24:01,080
compare your probably not so good memory

626
00:23:57,900 --> 00:24:04,020
image with this and actually find out

627
00:24:01,080 --> 00:24:06,570
what changed so there's two ways we can

628
00:24:04,020 --> 00:24:08,220
go about this every time you update any

629
00:24:06,570 --> 00:24:10,230
system you can take a memory image if

630
00:24:08,220 --> 00:24:12,570
you're a mom-and-pop place with like

631
00:24:10,230 --> 00:24:18,760
eight computers and one server this is

632
00:24:12,570 --> 00:24:22,090
plausible if you are Walmart good luck

633
00:24:18,760 --> 00:24:23,740
so my recommendation for that instead of

634
00:24:22,090 --> 00:24:26,439
taking a memory image of every single

635
00:24:23,740 --> 00:24:28,120
host taking them have a standard

636
00:24:26,440 --> 00:24:30,429
baseline your golden image if you will

637
00:24:28,120 --> 00:24:33,580
have one for the entire organization but

638
00:24:30,429 --> 00:24:38,470
then utilize overlays for things like HR

639
00:24:33,580 --> 00:24:39,760
accounting IT PR whomever and you have

640
00:24:38,470 --> 00:24:41,080
that standard image so that when

641
00:24:39,760 --> 00:24:43,169
something happens you have an image to

642
00:24:41,080 --> 00:24:45,428
bounce it off of that's going to require

643
00:24:43,169 --> 00:24:47,799
duplicate hardware profiles all that fun

644
00:24:45,429 --> 00:24:49,690
stuff but nevertheless you can script it

645
00:24:47,799 --> 00:24:53,980
as well but you've got a factor in

646
00:24:49,690 --> 00:24:55,540
storage because for a memory image if

647
00:24:53,980 --> 00:24:57,160
you have 12 gigs of RAM your memory

648
00:24:55,540 --> 00:25:02,470
image is going to take up 12 gigs of

649
00:24:57,160 --> 00:25:05,770
storage so keep that in mind so with

650
00:25:02,470 --> 00:25:08,799
that just dumping into the whole network

651
00:25:05,770 --> 00:25:10,720
forensics thing momentarily get peak

652
00:25:08,799 --> 00:25:13,960
apps as often as possible retain them as

653
00:25:10,720 --> 00:25:16,870
long as possible but again storage is

654
00:25:13,960 --> 00:25:18,610
money so we don't have unlimited budget

655
00:25:16,870 --> 00:25:20,918
so keep that in mind

656
00:25:18,610 --> 00:25:24,790
integrate with your sim net flow is

657
00:25:20,919 --> 00:25:26,919
highly underrated because with it being

658
00:25:24,790 --> 00:25:28,990
metadata it's going to tell you things

659
00:25:26,919 --> 00:25:30,970
maybe it won't tell you exactly what's

660
00:25:28,990 --> 00:25:33,130
going on but it will give you some

661
00:25:30,970 --> 00:25:36,340
indication of what's happening if we

662
00:25:33,130 --> 00:25:39,340
think back to the whole controversy with

663
00:25:36,340 --> 00:25:41,500
NSA collecting metadata I mean they said

664
00:25:39,340 --> 00:25:43,299
oh well we're not collecting actual data

665
00:25:41,500 --> 00:25:44,590
so it's okay well let's think about what

666
00:25:43,299 --> 00:25:48,520
NetFlow does right so we're talking

667
00:25:44,590 --> 00:25:50,830
about who communicated with whom at what

668
00:25:48,520 --> 00:25:53,559
time for how long how much data was

669
00:25:50,830 --> 00:25:56,710
passed fundamentally that's what NetFlow

670
00:25:53,559 --> 00:25:58,178
is going to give you so okay you can see

671
00:25:56,710 --> 00:25:59,980
that this host was compromised was

672
00:25:58,179 --> 00:26:01,270
communicating with this compromised host

673
00:25:59,980 --> 00:26:02,710
there was this much data sent there's a

674
00:26:01,270 --> 00:26:06,220
good chance data exfiltration occurred

675
00:26:02,710 --> 00:26:08,080
also you can look at it within any sort

676
00:26:06,220 --> 00:26:11,020
of analyzer or your sim to actually see

677
00:26:08,080 --> 00:26:13,570
spikes so hmm three o'clock in the

678
00:26:11,020 --> 00:26:15,970
morning we're not doing updates no one's

679
00:26:13,570 --> 00:26:18,220
in the office from 10:00 p.m. to 7:00

680
00:26:15,970 --> 00:26:19,090
a.m. something happened at 3:00 what's

681
00:26:18,220 --> 00:26:21,280
going on here

682
00:26:19,090 --> 00:26:23,490
so that's giving you something to

683
00:26:21,280 --> 00:26:25,840
investigate something to dig deeper with

684
00:26:23,490 --> 00:26:27,370
your logs same thing they should be

685
00:26:25,840 --> 00:26:28,330
feeding into your sim so that you can

686
00:26:27,370 --> 00:26:30,309
get that information

687
00:26:28,330 --> 00:26:32,110
some sims will do peak apps for you

688
00:26:30,309 --> 00:26:33,340
automatically which that's

689
00:26:32,110 --> 00:26:35,919
pretty awesome if you can get that to

690
00:26:33,340 --> 00:26:37,330
work and then some integrate with

691
00:26:35,920 --> 00:26:39,670
vulnerability data so you're basically

692
00:26:37,330 --> 00:26:42,909
looking at this from all layers on top

693
00:26:39,670 --> 00:26:45,760
of each other in opportunities where you

694
00:26:42,910 --> 00:26:47,410
can carve the peak apps out as much as

695
00:26:45,760 --> 00:26:49,330
possible you can do it manually with

696
00:26:47,410 --> 00:26:52,299
Wireshark or network miner will do it a

697
00:26:49,330 --> 00:26:54,090
little bit more scripted for you not

698
00:26:52,299 --> 00:26:58,049
even scripted it's just point and click

699
00:26:54,090 --> 00:27:01,510
so one thing that I always like to do

700
00:26:58,049 --> 00:27:04,389
with it when doing the demonstration I'm

701
00:27:01,510 --> 00:27:06,669
not doing that demonstration today just

702
00:27:04,390 --> 00:27:09,910
because it's not one to play in my VM

703
00:27:06,669 --> 00:27:11,530
environment but anyway I'll open up a

704
00:27:09,910 --> 00:27:14,200
peek app and there's a file transfer

705
00:27:11,530 --> 00:27:16,928
over SMB that is what the peak app is

706
00:27:14,200 --> 00:27:18,100
and I always show hey I don't have putty

707
00:27:16,929 --> 00:27:20,950
on the system I don't have putty

708
00:27:18,100 --> 00:27:22,689
installed it's not there but it carved

709
00:27:20,950 --> 00:27:24,520
out putty and you can just double click

710
00:27:22,690 --> 00:27:26,950
on it and all of a sudden putty pops up

711
00:27:24,520 --> 00:27:30,040
so you've got the executable that was

712
00:27:26,950 --> 00:27:31,720
transferred over SMB other things you

713
00:27:30,040 --> 00:27:33,370
can do it makes it really easy to trace

714
00:27:31,720 --> 00:27:36,160
what happened like in terms of which

715
00:27:33,370 --> 00:27:38,760
hosts communicated with which the data

716
00:27:36,160 --> 00:27:41,710
streams the sessions all that fun stuff

717
00:27:38,760 --> 00:27:44,110
you can with file so you can also get

718
00:27:41,710 --> 00:27:45,309
the hashes or you can even open them you

719
00:27:44,110 --> 00:27:47,260
can open the file you can look at the

720
00:27:45,309 --> 00:27:49,299
path you can get the hash so that works

721
00:27:47,260 --> 00:27:52,030
out really well with uploading things

722
00:27:49,299 --> 00:27:56,440
into virustotal and then creating your

723
00:27:52,030 --> 00:27:57,129
own threat intelligence feeds so that's

724
00:27:56,440 --> 00:28:02,700
pretty much that

725
00:27:57,130 --> 00:28:04,990
so just to kind of wind down on this so

726
00:28:02,700 --> 00:28:07,320
Brian Austin and I created through the

727
00:28:04,990 --> 00:28:10,270
hacking glass it's a mentorship platform

728
00:28:07,320 --> 00:28:12,370
not with peer list anymore but I've not

729
00:28:10,270 --> 00:28:14,260
updated this slide but basically we

730
00:28:12,370 --> 00:28:16,299
understand that academia serves a

731
00:28:14,260 --> 00:28:18,309
purpose and certifications serve a

732
00:28:16,299 --> 00:28:20,139
different purpose but we still have

733
00:28:18,309 --> 00:28:25,120
employers looking for people with 14

734
00:28:20,140 --> 00:28:28,450
years of aetherium experience hey I just

735
00:28:25,120 --> 00:28:29,979
saw it on indeed but anyway because of

736
00:28:28,450 --> 00:28:31,990
that we want to help people get

737
00:28:29,980 --> 00:28:34,690
experience with things outside of

738
00:28:31,990 --> 00:28:36,340
certification and formal education

739
00:28:34,690 --> 00:28:38,080
so basically we're trying to pair people

740
00:28:36,340 --> 00:28:40,090
with mentors or pair of people with

741
00:28:38,080 --> 00:28:43,300
mentees and look at things such as

742
00:28:40,090 --> 00:28:44,820
hardening system attack so like the pen

743
00:28:43,300 --> 00:28:47,570
testing side

744
00:28:44,820 --> 00:28:50,279
entering incident response and analysis

745
00:28:47,570 --> 00:28:53,039
so and at some point will have a range

746
00:28:50,279 --> 00:28:55,830
built that will actually have it to

747
00:28:53,039 --> 00:28:57,779
where you will go in someone will go in

748
00:28:55,830 --> 00:28:59,460
and harden a system then the person

749
00:28:57,779 --> 00:29:01,799
doing the attack phase will attack that

750
00:28:59,460 --> 00:29:03,389
same system or systems there's varying

751
00:29:01,799 --> 00:29:05,158
levels of difficulty while someone's

752
00:29:03,389 --> 00:29:06,658
monitoring it they'll pass that off to

753
00:29:05,159 --> 00:29:09,120
incident response and at the end we'll

754
00:29:06,659 --> 00:29:10,320
all hop on probably a WebEx or something

755
00:29:09,120 --> 00:29:12,570
and talk about it at the very end

756
00:29:10,320 --> 00:29:13,799
so that'll provide the pen tester the

757
00:29:12,570 --> 00:29:16,350
opportunity to tell the guy that

758
00:29:13,799 --> 00:29:18,870
hardened it or the gal or whomever

759
00:29:16,350 --> 00:29:20,668
hardened it hey I really like that you

760
00:29:18,870 --> 00:29:22,139
set this thing here this way I couldn't

761
00:29:20,669 --> 00:29:23,850
get in I was planning on trying to make

762
00:29:22,139 --> 00:29:26,519
it in this way but because you had this

763
00:29:23,850 --> 00:29:27,899
setting in place I couldn't do it or hey

764
00:29:26,519 --> 00:29:29,190
you know I know what you were trying to

765
00:29:27,899 --> 00:29:30,629
do with this but you left this hangin

766
00:29:29,190 --> 00:29:33,149
wide open and I walk right in the front

767
00:29:30,629 --> 00:29:35,820
door whatever something to that effect

768
00:29:33,149 --> 00:29:37,289
so to sign up for it just go to the

769
00:29:35,820 --> 00:29:38,700
Twitter or the Facebook we've got links

770
00:29:37,289 --> 00:29:41,009
to the mailing list that's actually what

771
00:29:38,700 --> 00:29:44,159
we're using right now for the sign up

772
00:29:41,009 --> 00:29:46,409
that's on we're using MailChimp with

773
00:29:44,159 --> 00:29:49,379
that it's gdpr enabled so we're pretty

774
00:29:46,409 --> 00:29:50,639
good with that I guess future speaking

775
00:29:49,379 --> 00:29:54,059
engagements I'll be in Atlanta tomorrow

776
00:29:50,639 --> 00:29:58,799
that NOLA con and then a few other

777
00:29:54,059 --> 00:30:01,110
things so I like to give away free stuff

778
00:29:58,799 --> 00:30:04,740
so if anybody wants to come to hacker

779
00:30:01,110 --> 00:30:06,629
halted in Atlanta in October here is a

780
00:30:04,740 --> 00:30:10,259
coupon code to get free tickets tickets

781
00:30:06,629 --> 00:30:13,230
are normally $199 if you want 15% off of

782
00:30:10,259 --> 00:30:14,490
any ec-council training there's a coupon

783
00:30:13,230 --> 00:30:17,610
code for that they're offering

784
00:30:14,490 --> 00:30:20,639
everything so see eh CH fi e si si el

785
00:30:17,610 --> 00:30:21,209
PTC C so whatever you want to do good

786
00:30:20,639 --> 00:30:22,799
conference

787
00:30:21,210 --> 00:30:26,190
we've not announced any speakers yet the

788
00:30:22,799 --> 00:30:28,799
CFP just closed but I will say that the

789
00:30:26,190 --> 00:30:30,929
keynotes the two that I can remember off

790
00:30:28,799 --> 00:30:33,779
the top of my head are KCl is from

791
00:30:30,929 --> 00:30:36,149
bugcrowd and Paul acid Orion from

792
00:30:33,779 --> 00:30:40,409
security weekly so we've got that going

793
00:30:36,149 --> 00:30:43,110
on as well and if you want to attend my

794
00:30:40,409 --> 00:30:44,159
full-day social engineering and open

795
00:30:43,110 --> 00:30:47,820
source intelligence training I'll be

796
00:30:44,159 --> 00:30:49,460
giving it on June 7th layer 8 security

797
00:30:47,820 --> 00:30:51,779
conference I forgot the 8th in the slide

798
00:30:49,460 --> 00:30:53,010
that's what happens when you fly in late

799
00:30:51,779 --> 00:30:54,899
at night and you're trying to get to bed

800
00:30:53,010 --> 00:30:56,879
didn't make it here on time and you're

801
00:30:54,899 --> 00:30:58,709
just like drugging through it but anyway

802
00:30:56,879 --> 00:31:00,059
there's where you sign up if you

803
00:30:58,710 --> 00:31:03,510
the promo code at the bottom you'll get

804
00:31:00,059 --> 00:31:06,870
$50 off so I think the sticker price on

805
00:31:03,510 --> 00:31:09,000
it's $4.99 that'll get you for like 449

806
00:31:06,870 --> 00:31:10,830
but either way it's a full-day course

807
00:31:09,000 --> 00:31:12,000
covers both go cent and social

808
00:31:10,830 --> 00:31:14,340
engineering and there are labs

809
00:31:12,000 --> 00:31:17,450
associated with it so with that being

810
00:31:14,340 --> 00:31:17,449
said any questions

811
00:31:20,220 --> 00:31:23,640
yeah probably see me afterwards I'll

812
00:31:22,529 --> 00:31:25,380
give you my card just shoot me an email

813
00:31:23,640 --> 00:31:28,169
or hit me on LinkedIn or Twitter and

814
00:31:25,380 --> 00:31:39,380
I'll hook you up any other questions

815
00:31:28,169 --> 00:31:42,179
concerns compliance grievances yes there

816
00:31:39,380 --> 00:31:43,770
and that's a possibility but even if

817
00:31:42,179 --> 00:31:45,330
with a collision with md5 you're gonna

818
00:31:43,770 --> 00:31:47,460
back it up with the SS deep so you're

819
00:31:45,330 --> 00:31:49,260
not relying on it the same if we were

820
00:31:47,460 --> 00:31:53,070
talking about passwords I would be 100%

821
00:31:49,260 --> 00:31:55,590
onboard with it and yes but if you feel

822
00:31:53,070 --> 00:31:57,809
more secure going with like sha-1 or

823
00:31:55,590 --> 00:31:58,980
shot 256 whatever you're more

824
00:31:57,809 --> 00:32:00,240
comfortable with the only thing you have

825
00:31:58,980 --> 00:32:01,710
to think about when you're hashing this

826
00:32:00,240 --> 00:32:04,980
is the time to hash so if you're using

827
00:32:01,710 --> 00:32:07,529
like you know Shaw it's going to take a

828
00:32:04,980 --> 00:32:13,799
little bit longer so but it's the time

829
00:32:07,529 --> 00:32:27,120
coefficient it's such a new possibility

830
00:32:13,799 --> 00:32:29,970
that honestly exactly so right okay so

831
00:32:27,120 --> 00:32:31,500
so I mean and again you could have that

832
00:32:29,970 --> 00:32:33,809
engineered collision and yes it's going

833
00:32:31,500 --> 00:32:35,490
to cause a headache you may be you know

834
00:32:33,809 --> 00:32:37,110
wasting a little bit of time with it

835
00:32:35,490 --> 00:32:38,730
but at the same time you just have to

836
00:32:37,110 --> 00:32:41,010
look at the time you would waste with

837
00:32:38,730 --> 00:32:43,020
that comparing it to the md5 that's the

838
00:32:41,010 --> 00:32:45,330
engineered collision versus the SS deep

839
00:32:43,020 --> 00:32:47,220
because they're not going to get the SS

840
00:32:45,330 --> 00:32:48,990
deep collision so you'll see that and be

841
00:32:47,220 --> 00:32:52,320
like okay which would be an indication

842
00:32:48,990 --> 00:32:53,130
of something nefarious in itself or you

843
00:32:52,320 --> 00:32:55,260
know do you want to spend more time

844
00:32:53,130 --> 00:32:59,640
using Shaw you know whether you want to

845
00:32:55,260 --> 00:33:02,429
use one 256 or 512 whichever any other

846
00:32:59,640 --> 00:33:06,500
questions concerns complaints grievances

847
00:33:02,429 --> 00:33:14,500
if not then that's all folks

848
00:33:06,500 --> 00:33:14,500
[Applause]

849
00:33:23,870 --> 00:33:29,959
thank you under budget and ahead of

850
00:33:27,390 --> 00:33:29,960
schedule right

