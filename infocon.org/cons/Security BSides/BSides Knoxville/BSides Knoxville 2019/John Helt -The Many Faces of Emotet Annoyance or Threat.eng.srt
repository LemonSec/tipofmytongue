1
00:00:00,030 --> 00:00:25,380
I tried to pick something obscure that

2
00:00:23,880 --> 00:00:30,060
he'd have a hard time finding and he

3
00:00:25,380 --> 00:00:32,610
found it I'm impressed so all right well

4
00:00:30,060 --> 00:00:35,160
welcome thank you I didn't get as much

5
00:00:32,610 --> 00:00:38,219
of a turnout as Joe I hope that my topic

6
00:00:35,160 --> 00:00:42,120
is at least as interesting as his so but

7
00:00:38,219 --> 00:00:44,670
welcome there we go yeah everybody's in

8
00:00:42,120 --> 00:00:48,899
the comfortable seats all right

9
00:00:44,670 --> 00:00:51,059
a motet is it an annoyance or is it a

10
00:00:48,899 --> 00:00:53,399
threat how many of you have experienced

11
00:00:51,059 --> 00:00:55,530
tea motet in your environments or have

12
00:00:53,399 --> 00:00:57,840
just heard about it or have no idea what

13
00:00:55,530 --> 00:00:59,520
it is all right so good it's so good

14
00:00:57,840 --> 00:01:01,530
we've got a wide range excellent a

15
00:00:59,520 --> 00:01:03,930
little bit about me I'm not an expert

16
00:01:01,530 --> 00:01:05,400
right I love to be at conferences like

17
00:01:03,930 --> 00:01:07,619
this where I can be surrounded by people

18
00:01:05,400 --> 00:01:09,930
who are way smarter than me so I can

19
00:01:07,619 --> 00:01:11,430
just absorb and glean so I'm hoping that

20
00:01:09,930 --> 00:01:13,049
I can share something that's of interest

21
00:01:11,430 --> 00:01:15,810
to you and and if not there will be

22
00:01:13,049 --> 00:01:17,729
other people here that can but you know

23
00:01:15,810 --> 00:01:19,140
I'm I may be able to answer your

24
00:01:17,729 --> 00:01:20,850
questions I may point you in another

25
00:01:19,140 --> 00:01:23,970
direction I have a lot of resources that

26
00:01:20,850 --> 00:01:26,039
I depended on for this but yeah

27
00:01:23,970 --> 00:01:28,259
what I am is I consider myself an

28
00:01:26,040 --> 00:01:31,470
experienced curmudgeon I've been playing

29
00:01:28,259 --> 00:01:34,590
around with computers since well my

30
00:01:31,470 --> 00:01:36,840
first computer was a TI 99 for a with 16

31
00:01:34,590 --> 00:01:40,170
K of RAM so that may give you a little

32
00:01:36,840 --> 00:01:42,240
bit of perspective but again I love to

33
00:01:40,170 --> 00:01:45,479
learn new things to play with things to

34
00:01:42,240 --> 00:01:47,310
go from there I did work as an engineer

35
00:01:45,479 --> 00:01:48,509
with HP for about 10 years field

36
00:01:47,310 --> 00:01:51,000
engineer travelling around East

37
00:01:48,509 --> 00:01:54,090
Tennessee Southwest Virginia southeast

38
00:01:51,000 --> 00:01:56,159
Kentucky fixing stuff whether it was

39
00:01:54,090 --> 00:01:59,280
networks whether it was PCs whether it

40
00:01:56,159 --> 00:02:01,380
was HP 9000 HP 3000 s so a lot of

41
00:01:59,280 --> 00:02:03,210
experience there did a little bit of

42
00:02:01,380 --> 00:02:05,009
pre-sales technical consulting and

43
00:02:03,210 --> 00:02:07,559
mission critical systems engineering for

44
00:02:05,009 --> 00:02:10,709
them back at the the time of the the.com

45
00:02:07,560 --> 00:02:12,239
boom later transitioned to Scripps

46
00:02:10,709 --> 00:02:13,020
Networks which is now discovery have

47
00:02:12,239 --> 00:02:15,990
been there for about

48
00:02:13,020 --> 00:02:18,510
teen years currently managed the global

49
00:02:15,990 --> 00:02:22,530
security operations center there lots of

50
00:02:18,510 --> 00:02:24,780
fun and I get to teach for University of

51
00:02:22,530 --> 00:02:26,400
Phoenix online I also have been doing

52
00:02:24,780 --> 00:02:28,830
some courses for New Horizons on

53
00:02:26,400 --> 00:02:31,770
networking and information security so I

54
00:02:28,830 --> 00:02:33,900
get to play get to share I'm consider

55
00:02:31,770 --> 00:02:36,360
myself an awareness advocate so I love

56
00:02:33,900 --> 00:02:37,770
to share the things that I do glean with

57
00:02:36,360 --> 00:02:40,470
other people and you know when I have

58
00:02:37,770 --> 00:02:43,860
the opportunity to work with schools or

59
00:02:40,470 --> 00:02:49,530
churches or other organizations I've got

60
00:02:43,860 --> 00:02:50,910
to go down to oh goodness I got to share

61
00:02:49,530 --> 00:02:52,620
with one of the the retirement

62
00:02:50,910 --> 00:02:54,720
communities on how they could protect

63
00:02:52,620 --> 00:02:56,880
themselves and that was really really

64
00:02:54,720 --> 00:02:58,770
exciting so I'm an awareness advocate

65
00:02:56,880 --> 00:03:01,710
and as part of that I also lead the East

66
00:02:58,770 --> 00:03:03,090
Tennessee is c-squared chapter we're

67
00:03:01,710 --> 00:03:05,220
chartering right now hopefully within

68
00:03:03,090 --> 00:03:07,650
the next month we will be a full-blown

69
00:03:05,220 --> 00:03:10,890
chapter so if you see these over on the

70
00:03:07,650 --> 00:03:12,540
table grab one skin the QR code to send

71
00:03:10,890 --> 00:03:15,510
us an email if you want to become part

72
00:03:12,540 --> 00:03:18,390
of that chapter right now because we're

73
00:03:15,510 --> 00:03:20,970
still chartering members need to have

74
00:03:18,390 --> 00:03:22,500
need to be is c-squared certified so if

75
00:03:20,970 --> 00:03:24,810
you have an is c-squared number include

76
00:03:22,500 --> 00:03:26,160
that in the email if not still send us

77
00:03:24,810 --> 00:03:30,270
an e-mail if you want to be part of it

78
00:03:26,160 --> 00:03:31,709
and we can then add you to the the guest

79
00:03:30,270 --> 00:03:34,020
list and as soon as we get our charter

80
00:03:31,709 --> 00:03:36,000
completed the attorneys are working

81
00:03:34,020 --> 00:03:38,280
right now on getting us all all the

82
00:03:36,000 --> 00:03:41,459
stuff we need then you can join as well

83
00:03:38,280 --> 00:03:42,590
we're focused on networking with other

84
00:03:41,459 --> 00:03:44,850
people in the environment

85
00:03:42,590 --> 00:03:47,790
self-improvement learning from each

86
00:03:44,850 --> 00:03:49,829
other and outreach into the community so

87
00:03:47,790 --> 00:03:52,980
it's it's an exciting opportunity for

88
00:03:49,830 --> 00:03:55,080
folks that want to get involved alright

89
00:03:52,980 --> 00:03:57,390
enough about that why did I decide to

90
00:03:55,080 --> 00:03:58,080
talk about this particular topic on

91
00:03:57,390 --> 00:04:00,570
Imhotep

92
00:03:58,080 --> 00:04:03,090
well again I I recently transitioned

93
00:04:00,570 --> 00:04:05,100
jobs and I manage our Security

94
00:04:03,090 --> 00:04:07,890
Operations Center and when I started

95
00:04:05,100 --> 00:04:09,989
doing that in September of 2018 we

96
00:04:07,890 --> 00:04:13,019
started to see a lot of this pattern of

97
00:04:09,989 --> 00:04:15,750
activity in our environment or at least

98
00:04:13,020 --> 00:04:18,470
I started to get visibility into it

99
00:04:15,750 --> 00:04:21,660
right in our ETR we'd see you know

100
00:04:18,470 --> 00:04:24,000
Outlook opening Word opening a command

101
00:04:21,660 --> 00:04:25,940
shell which isn't shown here then

102
00:04:24,000 --> 00:04:28,370
opening PowerShell from there

103
00:04:25,940 --> 00:04:30,469
and then other bad stuff happening and

104
00:04:28,370 --> 00:04:31,940
the more we would research these the

105
00:04:30,470 --> 00:04:35,690
more we would look into them the more we

106
00:04:31,940 --> 00:04:39,380
would find connections back to oh that's

107
00:04:35,690 --> 00:04:42,290
a motet oh that's a motet I like this

108
00:04:39,380 --> 00:04:44,690
this is happening a lot and we're seeing

109
00:04:42,290 --> 00:04:46,010
various but it wasn't always the same

110
00:04:44,690 --> 00:04:47,900
indicators of compromise it was

111
00:04:46,010 --> 00:04:50,090
different indicators of compromised same

112
00:04:47,900 --> 00:04:52,280
pattern but I started to dig into it

113
00:04:50,090 --> 00:04:54,789
well what is this threat and the more I

114
00:04:52,280 --> 00:04:56,809
dug the more interesting it became and

115
00:04:54,790 --> 00:05:00,290
so that's why I had thought I would

116
00:04:56,810 --> 00:05:02,300
share what I learned from you all and

117
00:05:00,290 --> 00:05:04,040
the other thing on it is there's there's

118
00:05:02,300 --> 00:05:06,550
two differing opinions on it right and

119
00:05:04,040 --> 00:05:09,170
that's kind of why we had the topic talk

120
00:05:06,550 --> 00:05:10,700
topic title that we did you know some

121
00:05:09,170 --> 00:05:13,040
people are saying the emo head is like

122
00:05:10,700 --> 00:05:14,599
the end of the world it's it's doing

123
00:05:13,040 --> 00:05:16,460
damage massive damage and we'll talk

124
00:05:14,600 --> 00:05:18,220
about some of the massive damage that it

125
00:05:16,460 --> 00:05:20,570
has led to in the last couple years

126
00:05:18,220 --> 00:05:22,100
later on in the side but people are

127
00:05:20,570 --> 00:05:24,860
treating it as the end of the world you

128
00:05:22,100 --> 00:05:26,660
know I saw this tweet just earlier this

129
00:05:24,860 --> 00:05:28,960
year if you can dodge a motet you can

130
00:05:26,660 --> 00:05:31,790
dodging an advanced persistent threat

131
00:05:28,960 --> 00:05:34,340
that that kind of puts it up there in a

132
00:05:31,790 --> 00:05:37,340
range that you might want to be aware of

133
00:05:34,340 --> 00:05:39,229
and then I I listen to podcasts and I

134
00:05:37,340 --> 00:05:41,900
listen to to malware archaeology on

135
00:05:39,230 --> 00:05:43,850
several occasions going yeah we saw some

136
00:05:41,900 --> 00:05:46,310
Mima Ted again this week you know it was

137
00:05:43,850 --> 00:05:47,990
noisy we saw it was not you know it was

138
00:05:46,310 --> 00:05:51,230
nothing interesting so there's this

139
00:05:47,990 --> 00:05:52,580
dichotomy of approaches to it some poke

140
00:05:51,230 --> 00:05:54,260
saying yeah it's just it's something out

141
00:05:52,580 --> 00:05:56,500
there you know it's it's not a big deal

142
00:05:54,260 --> 00:05:59,599
other people oh no hair on fire you know

143
00:05:56,500 --> 00:06:00,740
so hopefully by the end of this

144
00:05:59,600 --> 00:06:02,960
presentation you'll have your own

145
00:06:00,740 --> 00:06:05,900
opinions of it and we'll go from there

146
00:06:02,960 --> 00:06:10,280
so what is a motet well this is not what

147
00:06:05,900 --> 00:06:11,750
it is this is not what it is but I do

148
00:06:10,280 --> 00:06:13,909
have a colleague that every time I say

149
00:06:11,750 --> 00:06:16,010
it he's like oh yeah that Egyptian thing

150
00:06:13,910 --> 00:06:18,740
yet this is not it

151
00:06:16,010 --> 00:06:22,219
what it is it started out as a banking

152
00:06:18,740 --> 00:06:24,770
Trojan back in 2014 by a group that's

153
00:06:22,220 --> 00:06:27,500
called mealy bug and we don't really

154
00:06:24,770 --> 00:06:29,180
know a lot about mealy bug but we've

155
00:06:27,500 --> 00:06:31,310
associated them with this this banking

156
00:06:29,180 --> 00:06:33,590
Trojan and it started out as a classic

157
00:06:31,310 --> 00:06:35,419
mal spam you know that you see the

158
00:06:33,590 --> 00:06:38,409
topics here you know invoice emails

159
00:06:35,419 --> 00:06:40,020
deliveries financial transactions

160
00:06:38,410 --> 00:06:44,129
sending out the email

161
00:06:40,020 --> 00:06:46,080
and seeing who can click right started

162
00:06:44,129 --> 00:06:49,560
out with primarily links in the emails

163
00:06:46,080 --> 00:06:52,020
also links to drive-by downloads so they

164
00:06:49,560 --> 00:06:53,610
would have compromised websites that

165
00:06:52,020 --> 00:06:55,530
would have a pop-up that would start

166
00:06:53,610 --> 00:06:57,240
this or they'd have the links in the

167
00:06:55,530 --> 00:06:58,710
messages that would go to compromised

168
00:06:57,240 --> 00:07:02,129
sites that would then then lead you from

169
00:06:58,710 --> 00:07:04,020
their classic attacks right in this

170
00:07:02,129 --> 00:07:07,050
particular case they started out

171
00:07:04,020 --> 00:07:09,090
targeting German and Austrian banks or

172
00:07:07,050 --> 00:07:14,930
customers of German and Austrian banks

173
00:07:09,090 --> 00:07:17,250
and so it was very limited in scope and

174
00:07:14,930 --> 00:07:22,020
from the beginning they had it designed

175
00:07:17,250 --> 00:07:25,199
with a modular payload so they could

176
00:07:22,020 --> 00:07:26,430
could very easily shift it around and

177
00:07:25,199 --> 00:07:29,250
move different things into different

178
00:07:26,430 --> 00:07:31,560
places but the payloads that they

179
00:07:29,250 --> 00:07:33,180
started out with were scanning your

180
00:07:31,560 --> 00:07:34,800
filesystem looking for banking

181
00:07:33,180 --> 00:07:36,680
information looking for files that might

182
00:07:34,800 --> 00:07:38,430
have account names usernames passwords

183
00:07:36,680 --> 00:07:41,400
other things like that

184
00:07:38,430 --> 00:07:45,120
they also from the beginning were able

185
00:07:41,400 --> 00:07:47,340
to intercept network traffic even if

186
00:07:45,120 --> 00:07:49,229
your traffic was SSL and TLS encrypted

187
00:07:47,340 --> 00:07:51,299
they weren't it intercepting at the

188
00:07:49,229 --> 00:07:54,020
network layer they were intercepting it

189
00:07:51,300 --> 00:07:56,130
by compromising your browser itself and

190
00:07:54,020 --> 00:07:58,198
gathering that information when you were

191
00:07:56,130 --> 00:08:00,449
having your browser sessions so it was a

192
00:07:58,199 --> 00:08:02,159
pretty interesting approach it

193
00:08:00,449 --> 00:08:04,560
established persistency through a number

194
00:08:02,159 --> 00:08:08,340
of different methods and they operated

195
00:08:04,560 --> 00:08:10,440
in 2014 from the summertime when they

196
00:08:08,340 --> 00:08:14,969
first manifested to December and then

197
00:08:10,440 --> 00:08:16,849
poof they vanished they were gone and so

198
00:08:14,969 --> 00:08:19,319
they made an impact at that point

199
00:08:16,849 --> 00:08:21,120
relatively small impact but they got a

200
00:08:19,319 --> 00:08:23,240
little bit of notice and then just

201
00:08:21,120 --> 00:08:26,580
disappeared

202
00:08:23,240 --> 00:08:29,699
ok you know another passing fad you know

203
00:08:26,580 --> 00:08:31,919
or a threat you know well then in the

204
00:08:29,699 --> 00:08:34,050
summer of 2015 like a year from when

205
00:08:31,919 --> 00:08:36,929
they first started they came back and

206
00:08:34,049 --> 00:08:38,510
they came back with a new version again

207
00:08:36,929 --> 00:08:40,409
they were still doing the mal spam

208
00:08:38,510 --> 00:08:43,649
typical types of things invoice

209
00:08:40,409 --> 00:08:45,060
deliveries financial transactions still

210
00:08:43,649 --> 00:08:46,110
had the links to drive-by downloads but

211
00:08:45,060 --> 00:08:47,849
now they started working with

212
00:08:46,110 --> 00:08:49,500
attachments as opposed to just having

213
00:08:47,850 --> 00:08:51,510
links in the email they started to have

214
00:08:49,500 --> 00:08:53,590
attachments in their email primarily

215
00:08:51,510 --> 00:08:56,920
word attachments and do

216
00:08:53,590 --> 00:08:59,560
PDF files with links that would go out

217
00:08:56,920 --> 00:09:02,079
to other places they expanded their

218
00:08:59,560 --> 00:09:03,910
target right now not only were they

219
00:09:02,080 --> 00:09:05,500
dealing with German and Austrian bank

220
00:09:03,910 --> 00:09:07,870
customers but also they were targeting

221
00:09:05,500 --> 00:09:09,310
Swiss banks gathering more and more

222
00:09:07,870 --> 00:09:12,040
information about people in those

223
00:09:09,310 --> 00:09:13,630
company in those countries they switch

224
00:09:12,040 --> 00:09:15,670
up the payload a little bit so they

225
00:09:13,630 --> 00:09:17,680
could still do recording of your network

226
00:09:15,670 --> 00:09:21,520
traffic but now new and improved they

227
00:09:17,680 --> 00:09:22,900
could harvest credentials credentials

228
00:09:21,520 --> 00:09:24,189
from within the browser itself so when

229
00:09:22,900 --> 00:09:26,410
you saved credentials in your browser

230
00:09:24,190 --> 00:09:27,790
whether you were using them or not while

231
00:09:26,410 --> 00:09:29,920
you were infected they could begin to

232
00:09:27,790 --> 00:09:31,569
grab those it was still in its infancy

233
00:09:29,920 --> 00:09:34,750
at that point but it was it was

234
00:09:31,570 --> 00:09:37,780
effective they changed their persistence

235
00:09:34,750 --> 00:09:40,630
mechanisms so that they were becoming a

236
00:09:37,780 --> 00:09:43,180
more persistent threat and again they

237
00:09:40,630 --> 00:09:46,810
operated from the summer of 2015 through

238
00:09:43,180 --> 00:09:49,810
December and vanished again so it's kind

239
00:09:46,810 --> 00:09:51,699
of an interesting model you know five

240
00:09:49,810 --> 00:09:58,329
six seven months of operation and then

241
00:09:51,700 --> 00:10:01,630
gone 2016 we didn't hear from them they

242
00:09:58,330 --> 00:10:03,460
it was like okay is this thing gone what

243
00:10:01,630 --> 00:10:05,500
happened we you know they would just

244
00:10:03,460 --> 00:10:10,600
there's there's not much about them in

245
00:10:05,500 --> 00:10:12,880
2016 then in April of 2017 they ramped

246
00:10:10,600 --> 00:10:15,540
up again now those patterns we thought

247
00:10:12,880 --> 00:10:18,040
were interesting and later on we'll talk

248
00:10:15,540 --> 00:10:20,980
about why we think they were interesting

249
00:10:18,040 --> 00:10:23,020
but these long breaks and then a new

250
00:10:20,980 --> 00:10:27,010
thing and then another long break and a

251
00:10:23,020 --> 00:10:30,040
new thing and now in April of 2017 they

252
00:10:27,010 --> 00:10:33,220
started a two-week campaign attacking in

253
00:10:30,040 --> 00:10:36,099
the UK this time they get the same type

254
00:10:33,220 --> 00:10:38,050
of spam campaigns the same type of

255
00:10:36,100 --> 00:10:40,510
attack techniques the same loader that

256
00:10:38,050 --> 00:10:42,699
was being effective but they switched

257
00:10:40,510 --> 00:10:45,069
out the payload again it was modular

258
00:10:42,700 --> 00:10:46,900
this is like a lego malware kind of

259
00:10:45,070 --> 00:10:49,660
thing they switched out the payload to

260
00:10:46,900 --> 00:10:51,550
use the dry decks banking Trojan as the

261
00:10:49,660 --> 00:10:53,800
payload itself dry decks had been

262
00:10:51,550 --> 00:10:55,300
effective in 2016 while they were taking

263
00:10:53,800 --> 00:10:57,099
their break they're like hey if you've

264
00:10:55,300 --> 00:11:00,339
worked for them let's switch it out and

265
00:10:57,100 --> 00:11:03,160
put it in here so they worked for two

266
00:11:00,340 --> 00:11:06,260
weeks attacking UK customers and then

267
00:11:03,160 --> 00:11:09,319
again they stopped

268
00:11:06,260 --> 00:11:11,720
but they didn't stop for very long on

269
00:11:09,320 --> 00:11:15,410
April 24th they started their campaign

270
00:11:11,720 --> 00:11:17,180
against the United States this time it

271
00:11:15,410 --> 00:11:21,790
was targeted toward government employees

272
00:11:17,180 --> 00:11:21,790
federal state local government employees

273
00:11:22,150 --> 00:11:26,180
changed up the features of it again this

274
00:11:24,350 --> 00:11:27,980
was a different version now they have

275
00:11:26,180 --> 00:11:29,479
something that's that's different

276
00:11:27,980 --> 00:11:30,980
they had a centralized commanding

277
00:11:29,480 --> 00:11:33,470
control where they could start to get

278
00:11:30,980 --> 00:11:35,150
automatic updates so now once you're

279
00:11:33,470 --> 00:11:37,670
infected and once they have persistence

280
00:11:35,150 --> 00:11:39,920
they can give you a new version and new

281
00:11:37,670 --> 00:11:42,280
they can patch their malware better than

282
00:11:39,920 --> 00:11:44,569
we patch our stuff right

283
00:11:42,280 --> 00:11:46,610
they had enhanced their browser

284
00:11:44,570 --> 00:11:49,100
credential harvesting so that they could

285
00:11:46,610 --> 00:11:52,340
now work with different browsers and get

286
00:11:49,100 --> 00:11:54,200
more effectively get those passwords and

287
00:11:52,340 --> 00:11:57,890
credentials that you've stored within

288
00:11:54,200 --> 00:12:00,950
your browsers they now added a email

289
00:11:57,890 --> 00:12:04,100
scraping opportunity so now if you're

290
00:12:00,950 --> 00:12:05,600
doing web-based email they could start

291
00:12:04,100 --> 00:12:07,520
to intercept some of that information

292
00:12:05,600 --> 00:12:10,580
and get your who you're sending to who

293
00:12:07,520 --> 00:12:12,560
you're sending from contents of email

294
00:12:10,580 --> 00:12:14,210
other pieces like that so that they

295
00:12:12,560 --> 00:12:17,239
could make their spam tank spam

296
00:12:14,210 --> 00:12:19,190
campaigns more effective and at this

297
00:12:17,240 --> 00:12:21,170
point they also made a dramatic change

298
00:12:19,190 --> 00:12:24,260
in that they added a polymorphic loader

299
00:12:21,170 --> 00:12:27,050
so the Imhotep loader itself the loader

300
00:12:24,260 --> 00:12:29,270
is what we now refer to as Imhotep they

301
00:12:27,050 --> 00:12:31,819
changed it to be polymorphic so it was

302
00:12:29,270 --> 00:12:33,620
having different signatures and it was

303
00:12:31,820 --> 00:12:35,840
generating different hashes and

304
00:12:33,620 --> 00:12:39,170
antivirus really started to struggle

305
00:12:35,840 --> 00:12:40,640
with it in 2017 malwarebytes's talking

306
00:12:39,170 --> 00:12:42,979
about you know what what they defined is

307
00:12:40,640 --> 00:12:44,689
polymorphic there but um it was just

308
00:12:42,980 --> 00:12:46,910
slipping past all of the different

309
00:12:44,690 --> 00:12:49,580
antivirus and still to this day that

310
00:12:46,910 --> 00:12:54,140
loader portion is very often missed by

311
00:12:49,580 --> 00:12:59,480
antivirus so that was when they started

312
00:12:54,140 --> 00:13:02,330
attacking America they did that attack

313
00:12:59,480 --> 00:13:05,540
in April and then changed it up again

314
00:13:02,330 --> 00:13:07,220
right when all else fails mutate they

315
00:13:05,540 --> 00:13:09,319
changed it up again and they started to

316
00:13:07,220 --> 00:13:12,260
with a new version attack hospitality

317
00:13:09,320 --> 00:13:16,220
industries medical facilities they were

318
00:13:12,260 --> 00:13:18,560
using the same polymorphic loader they

319
00:13:16,220 --> 00:13:20,550
started to change some of their ability

320
00:13:18,560 --> 00:13:22,319
to spread so now it was not

321
00:13:20,550 --> 00:13:25,589
just infecting the people that click the

322
00:13:22,320 --> 00:13:27,750
link but now from there it was doing

323
00:13:25,589 --> 00:13:30,180
some other things to to spread through

324
00:13:27,750 --> 00:13:35,310
your network taking advantage of open

325
00:13:30,180 --> 00:13:37,079
SMB ports other things with with network

326
00:13:35,310 --> 00:13:39,149
shares other vulnerabilities on your

327
00:13:37,079 --> 00:13:40,890
local networks as well as sending out

328
00:13:39,149 --> 00:13:43,560
through spam so using the information

329
00:13:40,890 --> 00:13:44,850
that they captured with email addresses

330
00:13:43,560 --> 00:13:47,130
and that to send them back to command

331
00:13:44,850 --> 00:13:49,230
and control to allow them to spend send

332
00:13:47,130 --> 00:13:53,700
out more spams or even sending spam

333
00:13:49,230 --> 00:13:57,500
messages from the infected systems they

334
00:13:53,700 --> 00:14:01,170
took out some of their banking payloads

335
00:13:57,500 --> 00:14:02,959
so they weren't now so much looking for

336
00:14:01,170 --> 00:14:08,339
ways to find that financial information

337
00:14:02,959 --> 00:14:10,800
but they were yeah sorry they added the

338
00:14:08,339 --> 00:14:12,810
the rig exploit kit instead and it was

339
00:14:10,800 --> 00:14:14,279
doing some other things and attacking in

340
00:14:12,810 --> 00:14:15,959
different ways again they just took

341
00:14:14,279 --> 00:14:18,269
somebody else's payload and threw it in

342
00:14:15,959 --> 00:14:22,079
there and now they started venturing

343
00:14:18,269 --> 00:14:26,760
into the the ransomware market that went

344
00:14:22,079 --> 00:14:29,459
through December of 2017 and then they

345
00:14:26,760 --> 00:14:32,430
took a tiny bit of a break and then they

346
00:14:29,459 --> 00:14:34,500
ramped it up again right early 2018 they

347
00:14:32,430 --> 00:14:36,209
started something that was once again

348
00:14:34,500 --> 00:14:38,990
different they pivoted they changed they

349
00:14:36,209 --> 00:14:41,459
changed quickly and this time they were

350
00:14:38,990 --> 00:14:43,680
indeed focusing on the United States so

351
00:14:41,459 --> 00:14:47,729
you can see the ratios of other regions

352
00:14:43,680 --> 00:14:50,060
to the United States in 2017 ramping up

353
00:14:47,730 --> 00:14:52,260
at the end of 2017 and then in 2018

354
00:14:50,060 --> 00:14:53,640
going along and there this was just for

355
00:14:52,260 --> 00:14:55,290
that quarter I didn't have newer

356
00:14:53,640 --> 00:14:57,870
statistics with that but it's been

357
00:14:55,290 --> 00:14:59,240
continuing with there and will we'll

358
00:14:57,870 --> 00:15:01,560
talk about that in a minute

359
00:14:59,240 --> 00:15:03,270
so what did they do when they changed in

360
00:15:01,560 --> 00:15:05,339
2018 well they had more enhancements

361
00:15:03,270 --> 00:15:07,110
this time they could start to move into

362
00:15:05,339 --> 00:15:08,730
preferred directories they started to

363
00:15:07,110 --> 00:15:11,070
use symbolic links and place those

364
00:15:08,730 --> 00:15:13,890
symbolic links in areas that would help

365
00:15:11,070 --> 00:15:15,990
them to maintain persistence and to

366
00:15:13,890 --> 00:15:19,769
start up over to over reboots and

367
00:15:15,990 --> 00:15:20,880
survive reboots they were collecting

368
00:15:19,769 --> 00:15:22,380
more and more information about the

369
00:15:20,880 --> 00:15:25,350
victim machine and sending those to

370
00:15:22,380 --> 00:15:27,720
their command and control servers and

371
00:15:25,350 --> 00:15:30,120
hey let's add an API because everybody's

372
00:15:27,720 --> 00:15:32,790
doing it right so now your malware has

373
00:15:30,120 --> 00:15:34,290
an API - so that was kind of interesting

374
00:15:32,790 --> 00:15:36,149
they changed their

375
00:15:34,290 --> 00:15:39,329
Appa Gatien methodology though in early

376
00:15:36,149 --> 00:15:41,449
2018 and they took the quake bot worm no

377
00:15:39,329 --> 00:15:44,550
quick bot was also very successful in

378
00:15:41,449 --> 00:15:49,680
quick bot or quack bot who can pronounce

379
00:15:44,550 --> 00:15:50,969
it but it was successful in 2016 it does

380
00:15:49,680 --> 00:15:53,130
some things with living off the land

381
00:15:50,970 --> 00:15:55,199
using the utilities that are on your

382
00:15:53,130 --> 00:15:57,839
system to spread again spreading by SM

383
00:15:55,199 --> 00:16:00,120
be using some powershell had some mimi

384
00:15:57,839 --> 00:16:02,160
cats in there with the worm to be able

385
00:16:00,120 --> 00:16:06,470
to harvest passwords in other ways now

386
00:16:02,160 --> 00:16:08,790
and they changed their payloads and the

387
00:16:06,470 --> 00:16:10,769
different variants of this may have had

388
00:16:08,790 --> 00:16:13,019
one or more of these payloads on there

389
00:16:10,769 --> 00:16:15,209
so they brought back the banking module

390
00:16:13,019 --> 00:16:16,680
right so they're starting to again go

391
00:16:15,209 --> 00:16:18,089
back to looking at network traffic and

392
00:16:16,680 --> 00:16:23,250
browser traffic for stealing your

393
00:16:18,089 --> 00:16:24,449
banking details they it was like the

394
00:16:23,250 --> 00:16:25,769
origins of where they were they went

395
00:16:24,449 --> 00:16:29,040
back to where they were where they had

396
00:16:25,769 --> 00:16:32,220
been successful they also added the

397
00:16:29,040 --> 00:16:33,029
email client info stealer module so that

398
00:16:32,220 --> 00:16:36,470
was what we talked about for

399
00:16:33,029 --> 00:16:39,300
browser-based email and they made that

400
00:16:36,470 --> 00:16:41,550
enhanced and it was even more effective

401
00:16:39,300 --> 00:16:43,560
they had other browser info stealing's

402
00:16:41,550 --> 00:16:45,870
so they could start to now gain access

403
00:16:43,560 --> 00:16:48,239
to your browser history your saved

404
00:16:45,870 --> 00:16:49,920
passwords other pieces there that were

405
00:16:48,240 --> 00:16:51,449
information in the browser that might be

406
00:16:49,920 --> 00:16:52,469
valuable to the attacker sending that

407
00:16:51,449 --> 00:16:55,589
all to the command and control

408
00:16:52,470 --> 00:16:57,720
infrastructure and then they also added

409
00:16:55,589 --> 00:16:59,790
a PST info stealer and this is the one

410
00:16:57,720 --> 00:17:02,130
that kind of made the news last year

411
00:16:59,790 --> 00:17:04,260
more with the ability to go into your

412
00:17:02,130 --> 00:17:06,780
Outlook message client and your Outlook

413
00:17:04,260 --> 00:17:10,199
message archives extract sender names

414
00:17:06,780 --> 00:17:12,119
email addresses from messages contents

415
00:17:10,199 --> 00:17:13,620
of messages send those up to the command

416
00:17:12,119 --> 00:17:17,569
and control infrastructure so they could

417
00:17:13,619 --> 00:17:17,569
have more effective targeted attacks

418
00:17:19,250 --> 00:17:22,949
change it up a little bit in the summer

419
00:17:21,480 --> 00:17:26,339
of 2018

420
00:17:22,949 --> 00:17:27,959
to more sophisticated emails and here

421
00:17:26,339 --> 00:17:30,240
they started actually using that

422
00:17:27,959 --> 00:17:31,440
information that they were gathering

423
00:17:30,240 --> 00:17:32,940
from all of the emails that they

424
00:17:31,440 --> 00:17:35,040
compromised earlier especially with the

425
00:17:32,940 --> 00:17:37,350
outlook plugins to be able to

426
00:17:35,040 --> 00:17:39,059
impersonate your people within your

427
00:17:37,350 --> 00:17:40,230
organization and start to send out the

428
00:17:39,059 --> 00:17:43,408
emails with that and this is kind of

429
00:17:40,230 --> 00:17:45,990
where I started to get involved in in

430
00:17:43,409 --> 00:17:47,490
dealing with the threat so here we have

431
00:17:45,990 --> 00:17:51,750
a sample email right

432
00:17:47,490 --> 00:17:53,370
document attachment from somebody in the

433
00:17:51,750 --> 00:17:56,460
organization to somebody in the same

434
00:17:53,370 --> 00:17:59,449
organization so they were you're making

435
00:17:56,460 --> 00:18:02,309
it look like it was an internal email

436
00:17:59,450 --> 00:18:04,740
and what did they have well they had you

437
00:18:02,309 --> 00:18:07,770
know macro attachments now all of us

438
00:18:04,740 --> 00:18:10,440
tell our users you know if it has the

439
00:18:07,770 --> 00:18:13,080
buttons don't enable macros don't do

440
00:18:10,440 --> 00:18:14,760
that right well they already thought

441
00:18:13,080 --> 00:18:16,678
about that they planned for it and now

442
00:18:14,760 --> 00:18:18,510
here they they have these easy-to-follow

443
00:18:16,679 --> 00:18:20,400
instructions you can't open this we're

444
00:18:18,510 --> 00:18:22,020
sorry but we're gonna make it easy for

445
00:18:20,400 --> 00:18:23,850
you to open this because it's important

446
00:18:22,020 --> 00:18:25,379
so you know here's the instructions for

447
00:18:23,850 --> 00:18:27,809
defeating that control that we've put in

448
00:18:25,380 --> 00:18:29,460
place to prevent macros from opening

449
00:18:27,809 --> 00:18:31,740
automatically for our users so they were

450
00:18:29,460 --> 00:18:33,300
just guiding them through step by step

451
00:18:31,740 --> 00:18:34,890
on how to do that with instructions that

452
00:18:33,300 --> 00:18:38,370
are easier than what we usually give

453
00:18:34,890 --> 00:18:40,920
them so what did they have from there

454
00:18:38,370 --> 00:18:44,250
well when you when you look at the macro

455
00:18:40,920 --> 00:18:45,990
itself the macro didn't have the

456
00:18:44,250 --> 00:18:47,640
commands just spelled out purely within

457
00:18:45,990 --> 00:18:50,400
the macro they obfuscated it at the

458
00:18:47,640 --> 00:18:52,500
macro loader level at the VBA level in

459
00:18:50,400 --> 00:18:54,540
the document and they'd have components

460
00:18:52,500 --> 00:18:56,730
of the malware or at least of the next

461
00:18:54,540 --> 00:18:58,260
step that were hidden in different parts

462
00:18:56,730 --> 00:19:00,240
of the document some of them may have

463
00:18:58,260 --> 00:19:01,950
been in metadata about the document some

464
00:19:00,240 --> 00:19:03,900
of them may have been in the text boxes

465
00:19:01,950 --> 00:19:06,450
that were in different spots of the dark

466
00:19:03,900 --> 00:19:09,510
document and they would put all that

467
00:19:06,450 --> 00:19:11,970
together and then when it's arranged it

468
00:19:09,510 --> 00:19:15,090
opened up a command shell but your

469
00:19:11,970 --> 00:19:17,250
command shell was the commands that were

470
00:19:15,090 --> 00:19:19,699
going that were being executed from the

471
00:19:17,250 --> 00:19:21,900
command prompt we're also obfuscated

472
00:19:19,700 --> 00:19:23,340
I'll zoom in there a little bit so you

473
00:19:21,900 --> 00:19:25,350
can see some of the commands line

474
00:19:23,340 --> 00:19:27,689
obfuscation that they had with DOS

475
00:19:25,350 --> 00:19:29,879
commands that was kind of interesting

476
00:19:27,690 --> 00:19:32,220
that was a technique that again this is

477
00:19:29,880 --> 00:19:35,429
summer of 2018 but that was a technique

478
00:19:32,220 --> 00:19:38,730
that was shared by Daniel Bohannon at

479
00:19:35,429 --> 00:19:40,350
blackhat 20 blackhat Asia 2018 earlier

480
00:19:38,730 --> 00:19:42,270
in March so within just a couple months

481
00:19:40,350 --> 00:19:44,909
they took the techniques that they saw

482
00:19:42,270 --> 00:19:47,370
demonstrated here with the invoked

483
00:19:44,910 --> 00:19:50,630
ossification and applied them to what

484
00:19:47,370 --> 00:19:53,178
they were doing so you now got to see

485
00:19:50,630 --> 00:19:56,880
this type of thing at the command line

486
00:19:53,179 --> 00:19:59,610
so that was kind of interesting from

487
00:19:56,880 --> 00:20:01,049
there so let's say once that executed

488
00:19:59,610 --> 00:20:04,258
the command it would launch a power

489
00:20:01,049 --> 00:20:09,299
script and your power shell was

490
00:20:04,259 --> 00:20:11,399
base64-encoded okay so once you go

491
00:20:09,299 --> 00:20:14,009
through and decode the base64 you end up

492
00:20:11,399 --> 00:20:16,049
with powershell obfuscation - so they've

493
00:20:14,009 --> 00:20:17,879
got layer after layer after layer of

494
00:20:16,049 --> 00:20:19,529
hiding what they're trying to do before

495
00:20:17,879 --> 00:20:21,330
they even get to the point of

496
00:20:19,529 --> 00:20:22,739
downloading the emote at loader this is

497
00:20:21,330 --> 00:20:26,100
just the stuff that's built into the

498
00:20:22,739 --> 00:20:27,869
document into the payload but when you

499
00:20:26,100 --> 00:20:30,269
finally sort it all out they're going to

500
00:20:27,869 --> 00:20:32,840
the websites and downloading the the

501
00:20:30,269 --> 00:20:35,129
next stage which is the emote at loader

502
00:20:32,840 --> 00:20:37,350
the version of the emote at loader they

503
00:20:35,129 --> 00:20:38,369
were using here is once again

504
00:20:37,350 --> 00:20:40,289
new-and-improved

505
00:20:38,369 --> 00:20:44,279
it's very different but this particular

506
00:20:40,289 --> 00:20:47,489
attack also what they started in the

507
00:20:44,279 --> 00:20:48,929
summer of 2018 was an alliance they you

508
00:20:47,489 --> 00:20:51,389
know we talked about this lego malware

509
00:20:48,929 --> 00:20:53,759
and this this building block modular

510
00:20:51,389 --> 00:20:56,758
approach they took there a motet loader

511
00:20:53,759 --> 00:20:58,710
and their distribution methods they

512
00:20:56,759 --> 00:21:01,230
combine it with trick-trick BOTS and

513
00:20:58,710 --> 00:21:04,529
with ryuk so we started to see this this

514
00:21:01,230 --> 00:21:07,470
unholy alliance this triad of tools that

515
00:21:04,529 --> 00:21:09,629
were working together but the Imhotep

516
00:21:07,470 --> 00:21:11,190
loader itself it still established

517
00:21:09,629 --> 00:21:12,899
persistence right it could do that

518
00:21:11,190 --> 00:21:14,669
through creating a service through

519
00:21:12,899 --> 00:21:16,918
scheduled tasks through a couple other

520
00:21:14,669 --> 00:21:18,720
methods - to just be on the system and

521
00:21:16,919 --> 00:21:20,039
stay on the system it was still checking

522
00:21:18,720 --> 00:21:22,019
in with command and control doing

523
00:21:20,039 --> 00:21:24,090
automatic updates again staying better

524
00:21:22,019 --> 00:21:27,389
updated than we our systems are staying

525
00:21:24,090 --> 00:21:29,580
updated they built in VM protection our

526
00:21:27,389 --> 00:21:30,748
VM detection so you know they could tell

527
00:21:29,580 --> 00:21:33,029
if it was running on a virtual machine

528
00:21:30,749 --> 00:21:34,889
or not and changed the behavior of it if

529
00:21:33,029 --> 00:21:37,379
it's being analyzed so if you've got

530
00:21:34,889 --> 00:21:39,389
some sandboxing techniques involved it

531
00:21:37,379 --> 00:21:40,980
may not necessarily set off any alarms

532
00:21:39,389 --> 00:21:44,070
in your sandbox because they detected

533
00:21:40,980 --> 00:21:46,259
that and change the behavior still

534
00:21:44,070 --> 00:21:48,269
polymorphic they enhanced their poly the

535
00:21:46,259 --> 00:21:49,830
ways that they were changing to slip

536
00:21:48,269 --> 00:21:54,059
past Devi slipped past some of your

537
00:21:49,830 --> 00:21:56,519
other controls and very effective there

538
00:21:54,059 --> 00:21:58,049
and now they established a botnet of

539
00:21:56,519 --> 00:22:00,059
infected systems since they had the

540
00:21:58,049 --> 00:22:02,399
persistence and since they had the

541
00:22:00,059 --> 00:22:04,289
ability to update and change these

542
00:22:02,399 --> 00:22:06,149
systems that were infected we now see a

543
00:22:04,289 --> 00:22:09,480
botnet of hundreds of thousands of

544
00:22:06,149 --> 00:22:11,310
systems infected with emote at and still

545
00:22:09,480 --> 00:22:13,350
running and still doing stuff and

546
00:22:11,310 --> 00:22:15,300
you know just waiting so they started to

547
00:22:13,350 --> 00:22:16,889
leverage that they took the email

548
00:22:15,300 --> 00:22:19,409
harvesting module that we had and

549
00:22:16,890 --> 00:22:22,470
started to feed that back to their

550
00:22:19,410 --> 00:22:24,960
botnet of infected sources to use them

551
00:22:22,470 --> 00:22:26,760
to start to send out the spam so

552
00:22:24,960 --> 00:22:28,500
remember you know they infected Robins

553
00:22:26,760 --> 00:22:29,490
computer and they got robinzine they

554
00:22:28,500 --> 00:22:31,040
didn't really infect her out in this

555
00:22:29,490 --> 00:22:33,630
computer I just like to pick on Robin

556
00:22:31,040 --> 00:22:35,190
but they got all of her contacts and

557
00:22:33,630 --> 00:22:37,740
they got her and they started sending

558
00:22:35,190 --> 00:22:39,870
out from the spam bot from a lot of

559
00:22:37,740 --> 00:22:41,910
different sources emails that look like

560
00:22:39,870 --> 00:22:43,739
they were coming from Robin to other

561
00:22:41,910 --> 00:22:45,570
people in her contacts list increase the

562
00:22:43,740 --> 00:22:47,550
probability that people are gonna click

563
00:22:45,570 --> 00:22:50,220
on it and open the attachment and run

564
00:22:47,550 --> 00:22:51,720
the macros and what-have-you and they're

565
00:22:50,220 --> 00:22:53,940
uploading all this data to cloud storage

566
00:22:51,720 --> 00:22:58,140
because you know hey it's the cloud

567
00:22:53,940 --> 00:23:02,880
right it's it's not just for not just

568
00:22:58,140 --> 00:23:05,520
for the good guys so then they they had

569
00:23:02,880 --> 00:23:06,660
the trick payload that they once the

570
00:23:05,520 --> 00:23:09,870
loader was established they would

571
00:23:06,660 --> 00:23:11,520
download trick bot was also modular just

572
00:23:09,870 --> 00:23:16,050
like he motets and now they've got lego

573
00:23:11,520 --> 00:23:18,180
malware inside of lego malware trick bot

574
00:23:16,050 --> 00:23:20,250
this is interesting in November they

575
00:23:18,180 --> 00:23:23,550
said it was one of the top business

576
00:23:20,250 --> 00:23:26,250
threats at the time it had a data

577
00:23:23,550 --> 00:23:29,280
stealer still has a daily data stealer

578
00:23:26,250 --> 00:23:31,230
uses web injection attacks still also is

579
00:23:29,280 --> 00:23:34,649
if a motet didn't do enough to harvest

580
00:23:31,230 --> 00:23:36,330
your emails the trick bots malware is

581
00:23:34,650 --> 00:23:40,020
also harvesting emails and doing its own

582
00:23:36,330 --> 00:23:42,090
thing running me me me cats it also

583
00:23:40,020 --> 00:23:44,129
would search through your system and

584
00:23:42,090 --> 00:23:46,350
look for now it's looking for altcoin

585
00:23:44,130 --> 00:23:47,940
wallets and bitcoin wallets and grabbing

586
00:23:46,350 --> 00:23:49,949
that information and sending that to the

587
00:23:47,940 --> 00:23:53,940
attackers so that they can raid your

588
00:23:49,950 --> 00:23:55,410
crypto currency accounts trick bot uses

589
00:23:53,940 --> 00:23:58,410
some interesting ways to spread it's

590
00:23:55,410 --> 00:24:03,360
also spreading through SMB a lot of the

591
00:23:58,410 --> 00:24:08,970
classic attacks that we saw with I'm

592
00:24:03,360 --> 00:24:12,090
drawing a blank now the yeah the SMB

593
00:24:08,970 --> 00:24:13,710
attacks SMB one SMB be to just spread

594
00:24:12,090 --> 00:24:16,230
through your networks using RPC calls

595
00:24:13,710 --> 00:24:17,850
other ways of spreading eternal blue

596
00:24:16,230 --> 00:24:19,740
that's the term most look at three using

597
00:24:17,850 --> 00:24:21,030
a lot of the eternal blue methodologies

598
00:24:19,740 --> 00:24:23,640
that you know some people had patched

599
00:24:21,030 --> 00:24:24,840
and other people hadn't that was the

600
00:24:23,640 --> 00:24:27,510
trick box side of it and then

601
00:24:24,840 --> 00:24:30,080
we have the ryuk met ryuk ransomware and

602
00:24:27,510 --> 00:24:34,169
that was running concurrently and that

603
00:24:30,080 --> 00:24:36,000
that was spreading pretty wild in fact

604
00:24:34,169 --> 00:24:38,070
this whole thing shifted to target

605
00:24:36,000 --> 00:24:40,110
enterprises and governments during this

606
00:24:38,070 --> 00:24:42,570
during this time frame if you remember

607
00:24:40,110 --> 00:24:44,279
earlier in 2018 the Allentown

608
00:24:42,570 --> 00:24:47,939
Pennsylvania where the whole town was

609
00:24:44,279 --> 00:24:49,950
was just hit by ransomware that was ryuk

610
00:24:47,940 --> 00:24:52,130
and that looks like it had initially

611
00:24:49,950 --> 00:24:55,200
started through a NEMA tat infection

612
00:24:52,130 --> 00:24:57,990
later in 2018 right around Christmas

613
00:24:55,200 --> 00:25:00,000
time when the Tribune publishing went

614
00:24:57,990 --> 00:25:01,830
down and they were taken offline by

615
00:25:00,000 --> 00:25:04,140
ransomware same attack same attack

616
00:25:01,830 --> 00:25:06,029
series that took the LA Times and a

617
00:25:04,140 --> 00:25:07,860
number of folks there so and the data

618
00:25:06,029 --> 00:25:10,230
resolution cloud hosting platform that

619
00:25:07,860 --> 00:25:12,149
happened right after Christmas that was

620
00:25:10,230 --> 00:25:14,669
also the same thing looking at the

621
00:25:12,149 --> 00:25:17,399
numbers in the Bitcoin wallets that were

622
00:25:14,669 --> 00:25:19,470
associated with ryuk so for when they

623
00:25:17,399 --> 00:25:21,320
said you know pay us the ransom and

624
00:25:19,470 --> 00:25:23,909
we'll we'll give you the keys back

625
00:25:21,320 --> 00:25:25,889
tracing those wallets we saw that the

626
00:25:23,909 --> 00:25:30,799
ransomware associated with this campaign

627
00:25:25,890 --> 00:25:34,350
earned about 3.7 million dollars in 2018

628
00:25:30,799 --> 00:25:39,270
so that was kind of interesting and that

629
00:25:34,350 --> 00:25:41,520
ran through January 7th now why did I

630
00:25:39,270 --> 00:25:42,840
say January 7th I was very specific on

631
00:25:41,520 --> 00:25:44,850
that because it was interesting and it

632
00:25:42,840 --> 00:25:46,110
made a lot of news at the beginning of

633
00:25:44,850 --> 00:25:48,809
the year this year because it was such a

634
00:25:46,110 --> 00:25:53,729
prolific campaign and then it just came

635
00:25:48,809 --> 00:25:55,559
to a stop an interesting little tidbit

636
00:25:53,730 --> 00:25:58,860
and we don't know if it's valuable at

637
00:25:55,559 --> 00:26:01,950
attribution or not but they took a break

638
00:25:58,860 --> 00:26:04,260
from January 7th to a little bit later

639
00:26:01,950 --> 00:26:07,020
in January and it happens that the break

640
00:26:04,260 --> 00:26:11,629
they took coincides with the Orthodox

641
00:26:07,020 --> 00:26:14,399
Christian Orthodox Christmas holiday

642
00:26:11,630 --> 00:26:16,049
again we don't know if that at all is

643
00:26:14,399 --> 00:26:17,959
tied to attribution of who's doing it

644
00:26:16,049 --> 00:26:20,700
attribution is kind of a slippery slope

645
00:26:17,960 --> 00:26:22,980
there's some people that say the ryuk

646
00:26:20,700 --> 00:26:24,779
ryuk ransomware can be attributed to

647
00:26:22,980 --> 00:26:26,730
North Korea because of some of the code

648
00:26:24,779 --> 00:26:28,500
that they use there's other folks that

649
00:26:26,730 --> 00:26:31,860
say the banking Trojan parts can be

650
00:26:28,500 --> 00:26:34,049
attributed to Eastern Europe and and

651
00:26:31,860 --> 00:26:36,149
Russia and other places but we don't

652
00:26:34,049 --> 00:26:37,010
have any real solid attribution on any

653
00:26:36,149 --> 00:26:38,540
of it it's kind

654
00:26:37,010 --> 00:26:40,250
kind of mysterious but it was

655
00:26:38,540 --> 00:26:42,559
interesting that a lot of their other

656
00:26:40,250 --> 00:26:44,000
breaks also included some of those

657
00:26:42,559 --> 00:26:46,360
holidays they were much bigger breaks

658
00:26:44,000 --> 00:26:49,010
and now they took this shorter break

659
00:26:46,360 --> 00:26:49,729
that just covered that holiday so that

660
00:26:49,010 --> 00:26:53,840
was interesting

661
00:26:49,730 --> 00:26:55,040
the other thing that that's interesting

662
00:26:53,840 --> 00:26:57,110
is when they came back they came back

663
00:26:55,040 --> 00:26:59,720
with a vengeance they changed it up just

664
00:26:57,110 --> 00:27:02,418
a little bit not too much this time and

665
00:26:59,720 --> 00:27:06,470
immediately started attacking large

666
00:27:02,419 --> 00:27:09,770
targets beginning of 2019 you see the

667
00:27:06,470 --> 00:27:11,559
town of Albany city of Albany province

668
00:27:09,770 --> 00:27:13,610
about I don't know Albany New York

669
00:27:11,559 --> 00:27:15,799
Capital New York that they took down

670
00:27:13,610 --> 00:27:17,719
with the the same attacks Stewart

671
00:27:15,799 --> 00:27:20,150
Florida got taken down with the same

672
00:27:17,720 --> 00:27:22,400
attacks and it's still happening right

673
00:27:20,150 --> 00:27:25,370
we're seeing this still going on now

674
00:27:22,400 --> 00:27:28,280
through through the last several months

675
00:27:25,370 --> 00:27:31,280
of 2019 this just came up earlier this

676
00:27:28,280 --> 00:27:33,260
week in my research a motet is now

677
00:27:31,280 --> 00:27:34,668
considered the most prevalent threat in

678
00:27:33,260 --> 00:27:38,950
our healthcare systems and you can see

679
00:27:34,669 --> 00:27:41,450
that was April of April 30th so it's

680
00:27:38,950 --> 00:27:43,760
it's still a threat and it's still

681
00:27:41,450 --> 00:27:50,720
happening it's it's quite quite verily

682
00:27:43,760 --> 00:27:52,280
can I pose thank you so let's talk about

683
00:27:50,720 --> 00:27:53,960
it a little bit and what they've been

684
00:27:52,280 --> 00:27:56,030
doing they've adopted an agile

685
00:27:53,960 --> 00:27:58,070
development lifecycle if you go back to

686
00:27:56,030 --> 00:28:00,559
the beginning of the attacks they were

687
00:27:58,070 --> 00:28:02,510
more consistent with a waterfall style

688
00:28:00,559 --> 00:28:04,490
development methodology right they had

689
00:28:02,510 --> 00:28:05,809
this big release they do their thing for

690
00:28:04,490 --> 00:28:08,150
about six months and then they'd have to

691
00:28:05,809 --> 00:28:10,549
take like six months or a year to

692
00:28:08,150 --> 00:28:12,620
develop a new version and then do the

693
00:28:10,549 --> 00:28:14,870
same thing again and then they took off

694
00:28:12,620 --> 00:28:15,889
all of 2016 to develop a new version at

695
00:28:14,870 --> 00:28:18,110
least that's that's what we're

696
00:28:15,890 --> 00:28:19,790
speculating at but now after that they

697
00:28:18,110 --> 00:28:20,959
came back in the boom new version boom

698
00:28:19,790 --> 00:28:22,700
new version let's do it a little bit

699
00:28:20,960 --> 00:28:24,440
different so they're adopting the same

700
00:28:22,700 --> 00:28:27,320
agile development life cycles that are

701
00:28:24,440 --> 00:28:28,549
allowing our IT to be successful to

702
00:28:27,320 --> 00:28:32,750
allow their their malware to be

703
00:28:28,549 --> 00:28:35,059
successful so you can see if any of you

704
00:28:32,750 --> 00:28:37,580
listen to Johan Stahl wreck sands

705
00:28:35,059 --> 00:28:41,000
internet storm center storm cast it's a

706
00:28:37,580 --> 00:28:42,949
great 10-15 minute podcast every morning

707
00:28:41,000 --> 00:28:45,470
to get an idea of what's going on there

708
00:28:42,950 --> 00:28:47,920
but over the last several months a motet

709
00:28:45,470 --> 00:28:49,420
has been a regular occurrence in

710
00:28:47,920 --> 00:28:50,860
podcasts with some of the new things

711
00:28:49,420 --> 00:28:53,170
that are coming out there and you can

712
00:28:50,860 --> 00:28:54,669
see that they're changing and they're

713
00:28:53,170 --> 00:28:56,770
speculating on some of the things that

714
00:28:54,670 --> 00:28:58,480
that we can see moving forward one of

715
00:28:56,770 --> 00:29:00,430
the things that we anticipate is some

716
00:28:58,480 --> 00:29:01,960
increased efficiencies right because

717
00:29:00,430 --> 00:29:03,520
that they're doing that they're doing a

718
00:29:01,960 --> 00:29:05,230
lot of R&D and they're investing in it

719
00:29:03,520 --> 00:29:08,080
it's paying off and they're using those

720
00:29:05,230 --> 00:29:09,460
profits to reinvest in it just like you

721
00:29:08,080 --> 00:29:13,419
know a business or a cyber criminal

722
00:29:09,460 --> 00:29:15,220
enterprise expect to see some

723
00:29:13,420 --> 00:29:16,510
distributed credential stuffing again

724
00:29:15,220 --> 00:29:18,130
they have this botnet that's all

725
00:29:16,510 --> 00:29:20,680
together there right that's already

726
00:29:18,130 --> 00:29:22,560
getting these email addresses and

727
00:29:20,680 --> 00:29:25,120
getting credential information

728
00:29:22,560 --> 00:29:26,620
credential stuffing is a very successful

729
00:29:25,120 --> 00:29:29,020
type of attack that's happening right

730
00:29:26,620 --> 00:29:32,620
now and that's a completely different

731
00:29:29,020 --> 00:29:34,510
thing but we expect to see them possibly

732
00:29:32,620 --> 00:29:35,800
using some of these credentials that

733
00:29:34,510 --> 00:29:37,780
they may have just been selling to other

734
00:29:35,800 --> 00:29:39,820
people to do credential stuffing to now

735
00:29:37,780 --> 00:29:41,230
use their network of infected machines

736
00:29:39,820 --> 00:29:42,669
to start to do some of the credential

737
00:29:41,230 --> 00:29:45,070
stuffing attacks so that's just

738
00:29:42,670 --> 00:29:46,720
speculation right now one of the other

739
00:29:45,070 --> 00:29:49,389
things that we expect to see though is

740
00:29:46,720 --> 00:29:51,130
for them to adapt the information

741
00:29:49,390 --> 00:29:53,200
they're gathering from email harvesting

742
00:29:51,130 --> 00:29:55,090
to transition into some of the B EC

743
00:29:53,200 --> 00:29:56,830
business email compromised style attacks

744
00:29:55,090 --> 00:29:59,590
I don't know if any of you all saw the

745
00:29:56,830 --> 00:30:01,179
report from the FBI just a few weeks ago

746
00:29:59,590 --> 00:30:04,090
maybe a month ago

747
00:30:01,180 --> 00:30:07,000
business email compromised in 2018 one

748
00:30:04,090 --> 00:30:09,820
point eight billion one point eight yeah

749
00:30:07,000 --> 00:30:11,830
one point eight billion with a B in 2018

750
00:30:09,820 --> 00:30:13,389
so it's a very successful attack they're

751
00:30:11,830 --> 00:30:15,070
looking at possibly you know getting

752
00:30:13,390 --> 00:30:16,660
into that business again it's a criminal

753
00:30:15,070 --> 00:30:18,340
enterprise saying how can we be

754
00:30:16,660 --> 00:30:20,410
successful how can we change how can we

755
00:30:18,340 --> 00:30:21,939
pivot just like our businesses do but

756
00:30:20,410 --> 00:30:25,510
this time it's it's the the bad guys

757
00:30:21,940 --> 00:30:29,460
that are doing it so conclusions what

758
00:30:25,510 --> 00:30:31,650
can we do to to protect ourselves right

759
00:30:29,460 --> 00:30:35,950
one of the things that we can do

760
00:30:31,650 --> 00:30:37,810
obviously is defense in depth we can go

761
00:30:35,950 --> 00:30:40,240
back to our thing here you know do we

762
00:30:37,810 --> 00:30:42,220
consider this maybe to be a advanced

763
00:30:40,240 --> 00:30:43,870
persistent threat do we consider maybe

764
00:30:42,220 --> 00:30:46,780
that the defensive strategies that we're

765
00:30:43,870 --> 00:30:48,580
going to apply against our apts might be

766
00:30:46,780 --> 00:30:51,250
effective against this I don't know it's

767
00:30:48,580 --> 00:30:52,810
up to you to consider but you know we go

768
00:30:51,250 --> 00:30:54,130
back to the same things that we always

769
00:30:52,810 --> 00:30:55,929
say defense-in-depth

770
00:30:54,130 --> 00:30:57,520
what are the different layers that we

771
00:30:55,930 --> 00:30:59,560
might want to protect for this

772
00:30:57,520 --> 00:31:01,120
particular threat well we might want to

773
00:30:59,560 --> 00:31:03,159
protect your email gateway our

774
00:31:01,120 --> 00:31:06,159
points are our web gateways might

775
00:31:03,160 --> 00:31:08,080
possibly I don't know maybe use

776
00:31:06,160 --> 00:31:09,850
something for authentication other than

777
00:31:08,080 --> 00:31:13,270
just a username and password I know it's

778
00:31:09,850 --> 00:31:14,679
a wild crazy idea out there but um you

779
00:31:13,270 --> 00:31:17,860
know might want to take that away from

780
00:31:14,680 --> 00:31:19,570
the attackers so talking about the the

781
00:31:17,860 --> 00:31:21,250
email gateway why might that be

782
00:31:19,570 --> 00:31:25,330
something we want to do well maybe begin

783
00:31:21,250 --> 00:31:27,370
to filter your emails based on what they

784
00:31:25,330 --> 00:31:29,080
have in there obviously all of our email

785
00:31:27,370 --> 00:31:31,419
systems have filters that are already

786
00:31:29,080 --> 00:31:33,159
part of it if you're using Gmail you're

787
00:31:31,420 --> 00:31:38,020
getting some pretty good filtering if

788
00:31:33,160 --> 00:31:40,870
you're using office 365 SATP you're

789
00:31:38,020 --> 00:31:43,120
getting some filtering it's it's not

790
00:31:40,870 --> 00:31:44,199
anywhere near as good as Microsoft says

791
00:31:43,120 --> 00:31:46,419
it was again there was a report a few

792
00:31:44,200 --> 00:31:47,500
weeks ago about what they're actually

793
00:31:46,420 --> 00:31:49,330
getting and what they're not getting

794
00:31:47,500 --> 00:31:50,710
from some of the email vendors but you

795
00:31:49,330 --> 00:31:53,080
know you might want to look at

796
00:31:50,710 --> 00:31:55,120
increasing your filtering maybe filter

797
00:31:53,080 --> 00:31:57,580
out the ability to have attachments that

798
00:31:55,120 --> 00:31:59,530
have macros enabled in them obviously

799
00:31:57,580 --> 00:32:01,659
that's going to have a business impact

800
00:31:59,530 --> 00:32:03,610
especially if any of you have accounting

801
00:32:01,660 --> 00:32:05,290
folks that are using Excel spreadsheets

802
00:32:03,610 --> 00:32:07,479
with macros that are our business part

803
00:32:05,290 --> 00:32:10,629
of it but you have to make that business

804
00:32:07,480 --> 00:32:13,150
threat versus business decision maybe

805
00:32:10,630 --> 00:32:14,950
add some sandboxing to your email

806
00:32:13,150 --> 00:32:17,170
gateways so that attachments that come

807
00:32:14,950 --> 00:32:20,530
in can be detonated in a sandbox is it

808
00:32:17,170 --> 00:32:22,270
going to be fully effective no again you

809
00:32:20,530 --> 00:32:24,399
know they can detect a lot of the the

810
00:32:22,270 --> 00:32:26,410
virtual machines and other things for

811
00:32:24,400 --> 00:32:27,790
sandboxing and adapt but it's another

812
00:32:26,410 --> 00:32:30,760
layer that you probably should have

813
00:32:27,790 --> 00:32:32,820
anyways again it's going to have a

814
00:32:30,760 --> 00:32:36,550
business impact your sandboxing now adds

815
00:32:32,820 --> 00:32:38,950
time to email delivery and it can delay

816
00:32:36,550 --> 00:32:40,510
the ability for people to actually open

817
00:32:38,950 --> 00:32:42,490
attachments or they may get an email

818
00:32:40,510 --> 00:32:44,530
that they can't open the attachment on

819
00:32:42,490 --> 00:32:46,120
until the sandboxing is done depending

820
00:32:44,530 --> 00:32:47,620
on your technology there but it's

821
00:32:46,120 --> 00:32:52,030
another approach to defending against

822
00:32:47,620 --> 00:32:54,580
this having a good SPF and Demark system

823
00:32:52,030 --> 00:32:56,290
in place for your email you know how

824
00:32:54,580 --> 00:32:58,179
were these emails being spread most of

825
00:32:56,290 --> 00:32:59,830
them were email impersonation attacks

826
00:32:58,180 --> 00:33:02,010
right they weren't coming from valid

827
00:32:59,830 --> 00:33:04,210
senders well if you can stop those

828
00:33:02,010 --> 00:33:07,330
unauthenticated emails from coming into

829
00:33:04,210 --> 00:33:09,610
your systems you can stop a lot of these

830
00:33:07,330 --> 00:33:13,030
attacks but again it's it's a bit of a

831
00:33:09,610 --> 00:33:14,649
heavy lift Demark is not easy even using

832
00:33:13,030 --> 00:33:16,660
SPF and using it properly

833
00:33:14,650 --> 00:33:18,820
is not going to be easy if you're

834
00:33:16,660 --> 00:33:20,440
partnering with other organizations to

835
00:33:18,820 --> 00:33:22,480
send email on your behalf if you're

836
00:33:20,440 --> 00:33:23,800
using you know Constant Contact and all

837
00:33:22,480 --> 00:33:25,300
these other different things you know

838
00:33:23,800 --> 00:33:27,190
stand up another web service it's gonna

839
00:33:25,300 --> 00:33:28,810
send out emails as you now you've got a

840
00:33:27,190 --> 00:33:31,150
lot of people that are authorized to

841
00:33:28,810 --> 00:33:33,129
send on your behalf but if you don't

842
00:33:31,150 --> 00:33:35,470
have the necessary records in place to

843
00:33:33,130 --> 00:33:37,720
say who's legit and who's not and you

844
00:33:35,470 --> 00:33:39,190
just start to turn this stuff on you can

845
00:33:37,720 --> 00:33:41,080
break stuff from a business standpoint

846
00:33:39,190 --> 00:33:43,210
so make sure you approach it and plan

847
00:33:41,080 --> 00:33:43,870
accordingly but but definitely get doing

848
00:33:43,210 --> 00:33:45,970
this

849
00:33:43,870 --> 00:33:47,649
finally government agencies have got

850
00:33:45,970 --> 00:33:50,440
their act together with Demark because

851
00:33:47,650 --> 00:33:52,060
they were forced to but a lot of our

852
00:33:50,440 --> 00:33:54,970
other businesses are falling behind in

853
00:33:52,060 --> 00:33:56,950
that so that's one way to protect it the

854
00:33:54,970 --> 00:33:59,500
email gateway level how about at your

855
00:33:56,950 --> 00:34:02,050
endpoint well again think of policies

856
00:33:59,500 --> 00:34:04,090
maybe policies that block macros a

857
00:34:02,050 --> 00:34:06,159
little more thoroughly not just the the

858
00:34:04,090 --> 00:34:08,679
ability for users to go in and enable

859
00:34:06,160 --> 00:34:10,840
them that but block them more rigidly

860
00:34:08,679 --> 00:34:12,159
again it's going to be a threat versus

861
00:34:10,840 --> 00:34:13,540
business trade-off you know your

862
00:34:12,159 --> 00:34:15,010
accounting departments are gonna scream

863
00:34:13,540 --> 00:34:18,219
bloody murder because they're using

864
00:34:15,010 --> 00:34:20,200
macros all the time it may be something

865
00:34:18,219 --> 00:34:22,000
you can enable for a certain sector of

866
00:34:20,199 --> 00:34:24,009
your populace something to consider from

867
00:34:22,000 --> 00:34:27,429
a policy standpoint how about blocking

868
00:34:24,010 --> 00:34:29,230
PowerShell you know how many users need

869
00:34:27,429 --> 00:34:31,179
PowerShell running on their system well

870
00:34:29,230 --> 00:34:33,149
from a user standpoint most of your

871
00:34:31,179 --> 00:34:35,470
users probably don't from an IT

872
00:34:33,149 --> 00:34:37,600
management standpoint an orchestration

873
00:34:35,469 --> 00:34:39,459
platform your IT people are probably

874
00:34:37,600 --> 00:34:41,168
going to scream bloody murder no we use

875
00:34:39,460 --> 00:34:43,480
that for managing and updating in that

876
00:34:41,168 --> 00:34:46,149
so again maybe put some controls around

877
00:34:43,480 --> 00:34:47,310
that on what it can be initiated from or

878
00:34:46,149 --> 00:34:49,600
other things like that

879
00:34:47,310 --> 00:34:51,100
but it's not something you can just turn

880
00:34:49,600 --> 00:34:51,460
on it's a little bit more of a heavy

881
00:34:51,100 --> 00:34:53,830
lift

882
00:34:51,460 --> 00:34:55,840
maybe block execution from the users

883
00:34:53,830 --> 00:34:57,759
profile you know these commands that

884
00:34:55,840 --> 00:34:59,650
were downloaded when they did actually

885
00:34:57,760 --> 00:35:01,150
have files the files were stored in the

886
00:34:59,650 --> 00:35:02,860
profiles a lot of these are stored in

887
00:35:01,150 --> 00:35:04,330
memory and running from memory but if

888
00:35:02,860 --> 00:35:06,790
you can block execution from their

889
00:35:04,330 --> 00:35:09,640
profile you can protect from from some

890
00:35:06,790 --> 00:35:12,670
things maybe consider privileged access

891
00:35:09,640 --> 00:35:14,859
management policies so that your users

892
00:35:12,670 --> 00:35:16,390
that are running maybe don't have rights

893
00:35:14,860 --> 00:35:17,560
to be able to do some other things on

894
00:35:16,390 --> 00:35:19,690
their computer that would allow it to

895
00:35:17,560 --> 00:35:22,480
establish persistence and spread because

896
00:35:19,690 --> 00:35:25,640
our our users don't always have to be

897
00:35:22,480 --> 00:35:28,380
admins despite what they say

898
00:35:25,640 --> 00:35:30,120
have a good a V client that that's up to

899
00:35:28,380 --> 00:35:31,620
date and manageable again it slips past

900
00:35:30,120 --> 00:35:33,359
AV but you can't take it out of the

901
00:35:31,620 --> 00:35:35,940
equation maybe partner to that with a

902
00:35:33,360 --> 00:35:38,400
good EDR solution because despite

903
00:35:35,940 --> 00:35:40,650
whether it slips past your AV or not if

904
00:35:38,400 --> 00:35:43,110
you have an endpoint detection and

905
00:35:40,650 --> 00:35:45,000
response solution that shows processes

906
00:35:43,110 --> 00:35:47,220
you know this process did this did this

907
00:35:45,000 --> 00:35:49,170
did this then you can start to track

908
00:35:47,220 --> 00:35:51,990
down when it's happening even if it's

909
00:35:49,170 --> 00:35:53,850
obfuscated you may be able to set rules

910
00:35:51,990 --> 00:35:55,169
around that to be able to block some

911
00:35:53,850 --> 00:35:57,029
things or you may just have to do the

912
00:35:55,170 --> 00:35:59,610
whack-a-mole approach and find where it

913
00:35:57,030 --> 00:36:01,710
happened and then go shut it down but a

914
00:35:59,610 --> 00:36:03,600
goodie be our solution is is going to

915
00:36:01,710 --> 00:36:06,480
give you some of that insight log

916
00:36:03,600 --> 00:36:08,370
management collect some logs from your

917
00:36:06,480 --> 00:36:09,720
endpoints that would be able to see some

918
00:36:08,370 --> 00:36:10,740
of the activities that are around this

919
00:36:09,720 --> 00:36:13,140
and some of the things that are being

920
00:36:10,740 --> 00:36:15,330
done to establish persistence so that

921
00:36:13,140 --> 00:36:18,690
again you can at least detect and

922
00:36:15,330 --> 00:36:20,310
respond and good vulnerability and patch

923
00:36:18,690 --> 00:36:22,230
management I hate it when the attackers

924
00:36:20,310 --> 00:36:23,610
are able to keep their software more

925
00:36:22,230 --> 00:36:25,950
up-to-date than we're able to keep our

926
00:36:23,610 --> 00:36:27,390
endpoints up-to-date so that's that's

927
00:36:25,950 --> 00:36:30,450
another solution that you might want to

928
00:36:27,390 --> 00:36:32,460
look into there a lot of the times when

929
00:36:30,450 --> 00:36:34,919
these were being spread by those SMB v1

930
00:36:32,460 --> 00:36:35,730
SMB v 2 vulnerabilities the eternal blue

931
00:36:34,920 --> 00:36:37,790
type exploits

932
00:36:35,730 --> 00:36:39,690
if the endpoints had just been patched

933
00:36:37,790 --> 00:36:41,509
they wouldn't have been able to spread

934
00:36:39,690 --> 00:36:45,500
and those patches have been out since

935
00:36:41,510 --> 00:36:48,540
2017 so you know something to consider

936
00:36:45,500 --> 00:36:51,180
and again look at it from your your

937
00:36:48,540 --> 00:36:52,860
webmail Gateway standpoint so when once

938
00:36:51,180 --> 00:36:54,299
a system is there and it's trying to

939
00:36:52,860 --> 00:36:56,100
reach out to command and control or when

940
00:36:54,300 --> 00:36:58,440
it's trying to reach out to those sites

941
00:36:56,100 --> 00:37:00,990
to download the the loader modules and

942
00:36:58,440 --> 00:37:03,930
other things like that how many of us

943
00:37:00,990 --> 00:37:05,910
have protections in place to restrict

944
00:37:03,930 --> 00:37:08,700
our ability for our endpoints to reach

945
00:37:05,910 --> 00:37:10,560
out to unknown web sites sites that are

946
00:37:08,700 --> 00:37:12,660
not categorized by whatever our web

947
00:37:10,560 --> 00:37:14,570
filtering solution is or sites that

948
00:37:12,660 --> 00:37:17,490
domains that have been recently stood up

949
00:37:14,570 --> 00:37:19,560
those types of controls can can be

950
00:37:17,490 --> 00:37:21,569
effective again it's a heavy lift right

951
00:37:19,560 --> 00:37:23,310
you're gonna have people that are you

952
00:37:21,570 --> 00:37:24,870
know connecting to new sites and are

953
00:37:23,310 --> 00:37:26,970
gonna be mad because they can't get to

954
00:37:24,870 --> 00:37:28,589
it on the company computer or you know

955
00:37:26,970 --> 00:37:30,319
when they try to reach out to a site

956
00:37:28,590 --> 00:37:33,180
that just hasn't been categorized yet

957
00:37:30,320 --> 00:37:35,700
you're gonna create more calls for your

958
00:37:33,180 --> 00:37:37,230
for your support staff are you gonna

959
00:37:35,700 --> 00:37:38,529
have as many calls as you'd get if you

960
00:37:37,230 --> 00:37:41,230
have an outbreak of this thing

961
00:37:38,530 --> 00:37:44,380
not but you do have to plan it and and

962
00:37:41,230 --> 00:37:46,450
react accordingly and again multi-factor

963
00:37:44,380 --> 00:37:48,520
authentication you use something so that

964
00:37:46,450 --> 00:37:50,350
when those passwords get out not if the

965
00:37:48,520 --> 00:37:51,970
path of passwords get out when the

966
00:37:50,350 --> 00:37:55,480
passwords get out they're going to be

967
00:37:51,970 --> 00:37:56,560
less effective for our attackers because

968
00:37:55,480 --> 00:37:57,850
more and more of the things that we're

969
00:37:56,560 --> 00:37:58,990
doing our cloud-based right we're

970
00:37:57,850 --> 00:38:01,540
pushing it all up there to make it more

971
00:37:58,990 --> 00:38:02,859
efficient for us but if the attacker can

972
00:38:01,540 --> 00:38:04,750
get in there with just a username and

973
00:38:02,860 --> 00:38:06,400
password if the user can get in there

974
00:38:04,750 --> 00:38:07,990
with just a username and password the

975
00:38:06,400 --> 00:38:09,880
attackers will - and they're getting

976
00:38:07,990 --> 00:38:13,810
those those those pieces of information

977
00:38:09,880 --> 00:38:47,770
so that's all I got questions comments 9

978
00:38:13,810 --> 00:38:49,900
remarks yes 42 so that's a good question

979
00:38:47,770 --> 00:38:53,410
and we've seen a lot of different pieces

980
00:38:49,900 --> 00:38:55,720
there again different payloads and as

981
00:38:53,410 --> 00:38:57,700
they change their their their payload

982
00:38:55,720 --> 00:38:59,470
model the vex exfiltrated data

983
00:38:57,700 --> 00:39:01,720
differently so you can look at some of

984
00:38:59,470 --> 00:39:03,370
the ways that the different Trojans that

985
00:39:01,720 --> 00:39:05,379
they then have as their payload did

986
00:39:03,370 --> 00:39:07,920
their exfiltration a lot of times we're

987
00:39:05,380 --> 00:39:10,240
seeing connections through SSL HTTPS

988
00:39:07,920 --> 00:39:12,520
connections just sending data out over

989
00:39:10,240 --> 00:39:15,759
HTTP so your your net flow might show

990
00:39:12,520 --> 00:39:18,100
connection to this with a large amount

991
00:39:15,760 --> 00:39:19,810
of data or a lot of connections to this

992
00:39:18,100 --> 00:39:22,660
with small amounts of data in each one

993
00:39:19,810 --> 00:39:25,060
but with the SSL inspection that they're

994
00:39:22,660 --> 00:39:28,899
doing there unless you're doing SSL

995
00:39:25,060 --> 00:39:30,820
inspection or you know anything like

996
00:39:28,900 --> 00:39:32,200
that at your network layer you're not

997
00:39:30,820 --> 00:39:35,950
gonna be able to see the payloads and

998
00:39:32,200 --> 00:39:37,750
and few of us are actually doing SSL

999
00:39:35,950 --> 00:39:40,540
inspection there are edges because you

1000
00:39:37,750 --> 00:39:43,589
know certificate pinning and other

1001
00:39:40,540 --> 00:39:46,089
things like that we break things right

1002
00:39:43,589 --> 00:39:47,410
yeah you can see destinations and a lot

1003
00:39:46,089 --> 00:39:49,690
of times the the command/ctrl

1004
00:39:47,410 --> 00:39:58,690
infrastructures for these are very

1005
00:39:49,690 --> 00:40:00,489
dynamic good question yes what is

1006
00:39:58,690 --> 00:40:02,920
credential stuffing it's not part of

1007
00:40:00,489 --> 00:40:04,930
this credential stuffing is an attack

1008
00:40:02,920 --> 00:40:07,029
that's that's going on right now we're

1009
00:40:04,930 --> 00:40:09,700
seeing it a lot as a media company

1010
00:40:07,029 --> 00:40:11,079
because we have a lot of Internet facing

1011
00:40:09,700 --> 00:40:13,359
things where we're clients are going on

1012
00:40:11,079 --> 00:40:15,670
but credential stuffing is basically the

1013
00:40:13,359 --> 00:40:18,160
ability for an attacker with a very very

1014
00:40:15,670 --> 00:40:20,859
low investment to be able to get hold of

1015
00:40:18,160 --> 00:40:22,299
a list of email addresses that have been

1016
00:40:20,859 --> 00:40:23,348
out there you know I mean think of all

1017
00:40:22,299 --> 00:40:24,729
the different breaches that are out

1018
00:40:23,349 --> 00:40:26,499
there get hold of those email addresses

1019
00:40:24,729 --> 00:40:28,598
and get a hold of a set of credentials

1020
00:40:26,499 --> 00:40:30,488
that may be associated with these email

1021
00:40:28,599 --> 00:40:32,619
addresses maybe not maybe just

1022
00:40:30,489 --> 00:40:35,769
credentials that are you know commonly

1023
00:40:32,619 --> 00:40:37,119
used and then start to use them so you

1024
00:40:35,769 --> 00:40:39,098
know we'll take all these people in the

1025
00:40:37,119 --> 00:40:40,539
room and I've got all of your email

1026
00:40:39,099 --> 00:40:42,789
addresses and I'm gonna attack some

1027
00:40:40,539 --> 00:40:45,999
service with those email addresses but

1028
00:40:42,789 --> 00:40:47,890
I'm not just going to take Robins and

1029
00:40:45,999 --> 00:40:49,209
say all right I'm gonna try Robins log

1030
00:40:47,890 --> 00:40:50,710
in here and I'm gonna use this password

1031
00:40:49,210 --> 00:40:52,329
and I'm gonna use this password now I'm

1032
00:40:50,710 --> 00:40:53,920
gonna use the next password that's an

1033
00:40:52,329 --> 00:40:55,869
easy way to get detected and locked out

1034
00:40:53,920 --> 00:40:57,549
instead we're gonna distribute that to a

1035
00:40:55,869 --> 00:40:59,410
bunch of different proxies so you have a

1036
00:40:57,549 --> 00:41:01,420
distributed attack coming from a variety

1037
00:40:59,410 --> 00:41:03,460
of different IP addresses and we're

1038
00:41:01,420 --> 00:41:04,630
going to take your email and we're gonna

1039
00:41:03,460 --> 00:41:05,950
try it with this password and we're

1040
00:41:04,630 --> 00:41:06,999
gonna take his email we're gonna try

1041
00:41:05,950 --> 00:41:08,769
with the same password then we're gonna

1042
00:41:06,999 --> 00:41:10,029
take the next person's email try it with

1043
00:41:08,769 --> 00:41:11,618
that password and go through the list

1044
00:41:10,029 --> 00:41:13,660
there so by the time we go through this

1045
00:41:11,619 --> 00:41:16,180
list of a hundred thousand passwords we

1046
00:41:13,660 --> 00:41:18,670
can hundred thousand email addresses to

1047
00:41:16,180 --> 00:41:22,089
login with we're gonna start again with

1048
00:41:18,670 --> 00:41:23,979
a different password now you know we're

1049
00:41:22,089 --> 00:41:25,808
not gonna do an account lockout and it's

1050
00:41:23,979 --> 00:41:28,118
much less likely for us to get attacked

1051
00:41:25,809 --> 00:41:31,269
or to get detected and then when we do

1052
00:41:28,119 --> 00:41:31,719
get a login we just save that and say

1053
00:41:31,269 --> 00:41:33,069
okay

1054
00:41:31,719 --> 00:41:35,979
now I've got something that was

1055
00:41:33,069 --> 00:41:37,599
successful I know that your email

1056
00:41:35,979 --> 00:41:39,160
address used this particular password I

1057
00:41:37,599 --> 00:41:43,029
save that information and I maybe sell

1058
00:41:39,160 --> 00:41:45,249
it or I try some other things now that I

1059
00:41:43,029 --> 00:41:46,539
have a valid combination I maybe put

1060
00:41:45,249 --> 00:41:49,269
that into the next phase of the attack

1061
00:41:46,539 --> 00:41:51,069
that tries other services and puts some

1062
00:41:49,269 --> 00:41:52,538
variations on that because nobody would

1063
00:41:51,069 --> 00:41:54,130
ever take the same password and put

1064
00:41:52,539 --> 00:41:54,999
maybe an exclamation point or a number

1065
00:41:54,130 --> 00:41:55,760
or something like that

1066
00:41:54,999 --> 00:41:57,740
after

1067
00:41:55,760 --> 00:42:00,200
right I mean we know buddy reuses

1068
00:41:57,740 --> 00:42:05,029
passwords or changes them so and they're

1069
00:42:00,200 --> 00:42:13,730
very successful right now anything else

1070
00:42:05,030 --> 00:42:15,950
yes so there are some tools out there

1071
00:42:13,730 --> 00:42:17,690
some endpoint security tools that can

1072
00:42:15,950 --> 00:42:21,259
lock down your computer so that

1073
00:42:17,690 --> 00:42:23,240
basically you can't run executables that

1074
00:42:21,260 --> 00:42:24,980
are stored in the profile they say the

1075
00:42:23,240 --> 00:42:26,450
computer will run executables that are

1076
00:42:24,980 --> 00:42:27,830
in these specific directories and if

1077
00:42:26,450 --> 00:42:30,109
anything tries to execute out of them

1078
00:42:27,830 --> 00:42:32,770
we're just not gonna let it run so

1079
00:42:30,109 --> 00:42:35,660
there's I think you can enable that with

1080
00:42:32,770 --> 00:42:35,990
I think Symantec lets you do some of

1081
00:42:35,660 --> 00:42:38,118
that

1082
00:42:35,990 --> 00:42:39,700
I know pelo Alto traps lets you do some

1083
00:42:38,119 --> 00:42:43,040
of that

1084
00:42:39,700 --> 00:42:44,720
ESET lets you do some of that several

1085
00:42:43,040 --> 00:42:45,920
other endpoint solutions will allow you

1086
00:42:44,720 --> 00:42:47,750
to do that more than just a regular

1087
00:42:45,920 --> 00:42:55,540
antivirus so you'd need a more expansive

1088
00:42:47,750 --> 00:42:59,480
endpoint security solution yes the data

1089
00:42:55,540 --> 00:43:02,390
the value of the data and and probably

1090
00:42:59,480 --> 00:43:03,619
because they're an easy target if you

1091
00:43:02,390 --> 00:43:05,330
look at most of our healthcare

1092
00:43:03,619 --> 00:43:09,140
organizations I haven't worked in health

1093
00:43:05,330 --> 00:43:10,850
care for 20 years but most of our

1094
00:43:09,140 --> 00:43:14,029
healthcare organizations are running on

1095
00:43:10,850 --> 00:43:16,130
a tight budget right and so they're

1096
00:43:14,030 --> 00:43:17,840
limited in their ability to put some of

1097
00:43:16,130 --> 00:43:19,850
these controls in place they may have a

1098
00:43:17,840 --> 00:43:21,170
lot of outdated equipment that's on the

1099
00:43:19,850 --> 00:43:24,440
network that has to say they're you know

1100
00:43:21,170 --> 00:43:26,030
you buy an MRI machine you expect to sit

1101
00:43:24,440 --> 00:43:28,609
there for 30 years and be effective

1102
00:43:26,030 --> 00:43:31,609
that's what that's what your your

1103
00:43:28,609 --> 00:43:32,420
capital investment is based on well you

1104
00:43:31,609 --> 00:43:35,840
can't do that

1105
00:43:32,420 --> 00:43:37,430
in IT now it just it doesn't work but

1106
00:43:35,840 --> 00:43:39,830
they have to then keep other things not

1107
00:43:37,430 --> 00:43:42,919
quite up to date in order to communicate

1108
00:43:39,830 --> 00:43:49,810
with those and it's a lot of hurdles but

1109
00:43:42,920 --> 00:43:49,810
again that's just guessing Tyler

1110
00:43:51,250 --> 00:43:57,110
that's a good question and if any of you

1111
00:43:54,260 --> 00:43:58,610
were in Joe's presentation earlier that

1112
00:43:57,110 --> 00:44:00,680
really falls into the categories of what

1113
00:43:58,610 --> 00:44:03,580
he talked about what are your your

1114
00:44:00,680 --> 00:44:05,540
incident response and forensics

1115
00:44:03,580 --> 00:44:07,100
approaches what are your policies on

1116
00:44:05,540 --> 00:44:08,210
that you know do you want do you take

1117
00:44:07,100 --> 00:44:10,520
the Machine and pull it off line and

1118
00:44:08,210 --> 00:44:13,220
reimage it do you try to get in there

1119
00:44:10,520 --> 00:44:14,930
and remove it do you set it aside so you

1120
00:44:13,220 --> 00:44:16,250
can do forensics on it and find out more

1121
00:44:14,930 --> 00:44:18,680
about what's happened and if it tried to

1122
00:44:16,250 --> 00:44:20,480
spread that's really up to your your

1123
00:44:18,680 --> 00:44:24,460
incident response and what your your

1124
00:44:20,480 --> 00:44:24,460
particular enterprise is willing to do

1125
00:44:24,580 --> 00:44:47,990
yes yes so the best detections I've seen

1126
00:44:46,490 --> 00:44:50,419
it the delivery phase have been in your

1127
00:44:47,990 --> 00:44:53,060
EDR solution when they detect that

1128
00:44:50,420 --> 00:44:55,490
pattern of behavior that somebody had an

1129
00:44:53,060 --> 00:44:57,799
Outlook client open or an email client

1130
00:44:55,490 --> 00:44:59,540
opened that then launched a word

1131
00:44:57,800 --> 00:45:01,190
attachment or an Excel attachment that

1132
00:44:59,540 --> 00:45:03,590
then tried to do this other thing so

1133
00:45:01,190 --> 00:45:08,770
that behavior recognition is really the

1134
00:45:03,590 --> 00:45:08,770
most effective yes

1135
00:45:14,880 --> 00:45:27,930
yes from what I've been able to find and

1136
00:45:26,340 --> 00:45:30,450
again I just started digging into this

1137
00:45:27,930 --> 00:45:32,419
you know over the past year so some of

1138
00:45:30,450 --> 00:45:35,189
the older information isn't quite as

1139
00:45:32,420 --> 00:45:36,480
up-to-date anymore well older

1140
00:45:35,190 --> 00:45:39,600
information not up-to-date that's

1141
00:45:36,480 --> 00:45:40,680
redundant what I've been able to find is

1142
00:45:39,600 --> 00:45:42,330
they mainly looked for certain

1143
00:45:40,680 --> 00:45:44,940
particular file types and then would

1144
00:45:42,330 --> 00:45:46,560
either look for things that matched

1145
00:45:44,940 --> 00:45:48,000
patterns in those file types are they

1146
00:45:46,560 --> 00:45:50,610
just uploaded and let them be scanned

1147
00:45:48,000 --> 00:45:53,160
somewhere else so you know document file

1148
00:45:50,610 --> 00:46:00,600
types excel file types text file types

1149
00:45:53,160 --> 00:46:02,220
were kind of the main ones all right one

1150
00:46:00,600 --> 00:46:04,230
more question has anybody got one more

1151
00:46:02,220 --> 00:46:06,689
question because the the next question

1152
00:46:04,230 --> 00:46:08,430
is going to get steal this computer 4.0

1153
00:46:06,690 --> 00:46:10,230
from no starch publishing there's got to

1154
00:46:08,430 --> 00:46:21,419
be a good question I forgot to hand it

1155
00:46:10,230 --> 00:46:24,090
out earlier yes ah hand him the book so

1156
00:46:21,420 --> 00:46:28,020
the pattern I primarily see on the email

1157
00:46:24,090 --> 00:46:30,500
side is that email impersonation attack

1158
00:46:28,020 --> 00:46:32,970
a message coming in from outside of your

1159
00:46:30,500 --> 00:46:34,680
organization that has a source address

1160
00:46:32,970 --> 00:46:36,959
that's associated with inside your

1161
00:46:34,680 --> 00:46:39,359
organization that's the pattern we see

1162
00:46:36,960 --> 00:46:41,580
most that's where the SPF and and Demark

1163
00:46:39,360 --> 00:46:44,160
can come into play to to help to protect

1164
00:46:41,580 --> 00:46:46,500
their or at least even Flags put a flag

1165
00:46:44,160 --> 00:46:49,230
on there that says this is an external

1166
00:46:46,500 --> 00:46:50,850
email and then the user well it looks

1167
00:46:49,230 --> 00:46:52,410
like an internal email address maybe I

1168
00:46:50,850 --> 00:46:54,480
oughta not open it maybe I ought to call

1169
00:46:52,410 --> 00:46:57,980
security or click and see what happens

1170
00:46:54,480 --> 00:46:57,980
if I click fast it won't break anything

1171
00:46:58,470 --> 00:47:23,859
I've heard that okay so those were from

1172
00:47:20,620 --> 00:47:41,109
external senders interesting that's good

1173
00:47:23,860 --> 00:47:43,210
enough yeah I'd love to send me some of

1174
00:47:41,110 --> 00:47:46,300
your regex queries I'd love to learn

1175
00:47:43,210 --> 00:47:48,880
more great all right thank you very much

1176
00:47:46,300 --> 00:47:50,620
again if you're interested in the East

1177
00:47:48,880 --> 00:47:58,510
Tennessee is c-squared organization

1178
00:47:50,620 --> 00:47:58,509
[Applause]

