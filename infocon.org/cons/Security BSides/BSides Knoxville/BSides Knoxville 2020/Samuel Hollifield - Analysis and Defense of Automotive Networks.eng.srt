1
00:00:00,719 --> 00:00:06,319
okay everybody let's get started

2
00:00:03,679 --> 00:00:07,919
today first we have samuel samuel is

3
00:00:06,319 --> 00:00:09,120
going to be going over analysis and

4
00:00:07,919 --> 00:00:12,399
defense of automated

5
00:00:09,120 --> 00:00:14,919
automate motive networks i'm gonna hand

6
00:00:12,400 --> 00:00:16,480
over control to him and he's gonna get

7
00:00:14,920 --> 00:00:17,920
started all right

8
00:00:16,480 --> 00:00:19,920
so thanks for waking up early with me

9
00:00:17,920 --> 00:00:21,600
guys my name is sam holyfield this is

10
00:00:19,920 --> 00:00:24,320
analysis and defense of automotive

11
00:00:21,600 --> 00:00:25,039
networks and uh that's my team just

12
00:00:24,320 --> 00:00:27,199
below

13
00:00:25,039 --> 00:00:29,359
my name i work with a talented group of

14
00:00:27,199 --> 00:00:30,960
individuals and

15
00:00:29,359 --> 00:00:32,480
we work with the cyber and applied data

16
00:00:30,960 --> 00:00:34,559
analytics division at the oakridge

17
00:00:32,479 --> 00:00:36,800
national lab and i can even show you my

18
00:00:34,559 --> 00:00:36,800
face

19
00:00:40,320 --> 00:00:45,440
perfect so we're at the uh

20
00:00:43,680 --> 00:00:46,879
inside the national security sciences

21
00:00:45,440 --> 00:00:49,680
directorate at orml

22
00:00:46,879 --> 00:00:51,680
and um our primary project has been to

23
00:00:49,680 --> 00:00:53,600
try and develop some sort of

24
00:00:51,680 --> 00:00:55,440
vehicle agnostic way to defend

25
00:00:53,600 --> 00:00:57,199
automotive networks and um

26
00:00:55,440 --> 00:00:59,280
so my goal today is to tell you a little

27
00:00:57,199 --> 00:01:01,199
bit about the work we're doing at or and

28
00:00:59,280 --> 00:01:02,480
now maybe give you some breadcrumbs to

29
00:01:01,199 --> 00:01:05,039
be able to do some

30
00:01:02,480 --> 00:01:06,880
automotive analysis on your own and get

31
00:01:05,040 --> 00:01:08,720
you excited about acting on cars because

32
00:01:06,880 --> 00:01:10,000
it's something that's really

33
00:01:08,720 --> 00:01:12,080
blown up the last few years it's

34
00:01:10,000 --> 00:01:14,799
something you can do on the cheap

35
00:01:12,080 --> 00:01:16,880
and it's quite a bit of fun so i say

36
00:01:14,799 --> 00:01:17,920
that also with the preface of i've never

37
00:01:16,880 --> 00:01:19,679
bricked my car

38
00:01:17,920 --> 00:01:22,880
um it would probably be a whole lot less

39
00:01:19,680 --> 00:01:24,799
fun if i permanently damaged it

40
00:01:22,880 --> 00:01:26,798
um so tell me a little bit first about

41
00:01:24,799 --> 00:01:29,680
the oak ridge national land so

42
00:01:26,799 --> 00:01:32,159
we started on the backbone of uh you

43
00:01:29,680 --> 00:01:35,439
know the manhattan project so

44
00:01:32,159 --> 00:01:35,840
back in like the 1940s there was a need

45
00:01:35,439 --> 00:01:38,000
for

46
00:01:35,840 --> 00:01:40,240
some plutonium to become enriched and

47
00:01:38,000 --> 00:01:43,840
build a big old bomb because we were

48
00:01:40,240 --> 00:01:46,158
in a serious war so uh oak ridge was

49
00:01:43,840 --> 00:01:47,280
chosen as the site for the very first

50
00:01:46,159 --> 00:01:49,200
national lab

51
00:01:47,280 --> 00:01:51,119
or what wasn't at that time but we ended

52
00:01:49,200 --> 00:01:53,200
up being the first and also being the

53
00:01:51,119 --> 00:01:54,240
largest there are about 17 national labs

54
00:01:53,200 --> 00:01:56,240
in the nation

55
00:01:54,240 --> 00:01:57,600
and uh i'm a little bit biased but i

56
00:01:56,240 --> 00:01:59,759
think we're the best

57
00:01:57,600 --> 00:02:02,000
so of course you know the story the war

58
00:01:59,759 --> 00:02:04,479
ended and then we still had all these

59
00:02:02,000 --> 00:02:07,759
facilities that were used to produce

60
00:02:04,479 --> 00:02:10,160
nuclear materials and radio isotopes and

61
00:02:07,759 --> 00:02:12,560
a bunch of really nasty stuff

62
00:02:10,160 --> 00:02:13,760
so instead of going more toward like

63
00:02:12,560 --> 00:02:16,560
weapons grade

64
00:02:13,760 --> 00:02:18,879
research we went more toward the open

65
00:02:16,560 --> 00:02:20,480
community of science research and that

66
00:02:18,879 --> 00:02:22,079
we now had all these facilities to be

67
00:02:20,480 --> 00:02:25,040
able to develop some really cool

68
00:02:22,080 --> 00:02:26,720
like uh medical isotopes so we could be

69
00:02:25,040 --> 00:02:28,799
some cool cancers and then

70
00:02:26,720 --> 00:02:30,959
you know the the lab kind of exploded

71
00:02:28,800 --> 00:02:32,319
and i like to say if you can get the phd

72
00:02:30,959 --> 00:02:35,920
in the field then you can

73
00:02:32,319 --> 00:02:38,640
research it here so anything from uh

74
00:02:35,920 --> 00:02:40,000
like advanced material design to

75
00:02:38,640 --> 00:02:42,559
biological studies

76
00:02:40,000 --> 00:02:43,360
chemical and you know of course my group

77
00:02:42,560 --> 00:02:45,200
we work in

78
00:02:43,360 --> 00:02:47,200
uh cyber security i'm in the cyber

79
00:02:45,200 --> 00:02:49,359
security research group

80
00:02:47,200 --> 00:02:51,119
and one of the main things that's

81
00:02:49,360 --> 00:02:52,000
interesting about working at a lab is

82
00:02:51,120 --> 00:02:53,519
that we're

83
00:02:52,000 --> 00:02:55,360
we're not really industry we're not

84
00:02:53,519 --> 00:02:56,959
really academia so

85
00:02:55,360 --> 00:02:58,480
i know a lot of folks are in industry

86
00:02:56,959 --> 00:03:00,560
you know how that works you're building

87
00:02:58,480 --> 00:03:03,679
tools either for customers or profit or

88
00:03:00,560 --> 00:03:05,280
for you know some reason uh academia

89
00:03:03,680 --> 00:03:07,440
whereas is more on like the highly

90
00:03:05,280 --> 00:03:08,959
theoretical side of things where

91
00:03:07,440 --> 00:03:10,480
you're the guardians of knowledge you

92
00:03:08,959 --> 00:03:13,360
know teach it discover it

93
00:03:10,480 --> 00:03:14,159
preserve it pass it on and national labs

94
00:03:13,360 --> 00:03:16,720
really exist

95
00:03:14,159 --> 00:03:17,599
to find problems that the nation's

96
00:03:16,720 --> 00:03:19,359
currently having

97
00:03:17,599 --> 00:03:21,200
and figure out a way to solve those so

98
00:03:19,360 --> 00:03:22,959
we take a lot of problems from

99
00:03:21,200 --> 00:03:24,319
the very theoretical side and

100
00:03:22,959 --> 00:03:27,120
fundamental side

101
00:03:24,319 --> 00:03:27,518
to actually applying them and using them

102
00:03:27,120 --> 00:03:30,400
in

103
00:03:27,519 --> 00:03:31,280
some real world situations uh of course

104
00:03:30,400 --> 00:03:34,080
one of those things

105
00:03:31,280 --> 00:03:34,879
is vehicle security so we actually have

106
00:03:34,080 --> 00:03:37,200
a

107
00:03:34,879 --> 00:03:38,079
laboratory dedicated just for vehicle

108
00:03:37,200 --> 00:03:39,679
security

109
00:03:38,080 --> 00:03:41,360
and it's out at the national

110
00:03:39,680 --> 00:03:42,720
transportation research center in our

111
00:03:41,360 --> 00:03:44,480
hardin valley campus

112
00:03:42,720 --> 00:03:47,280
so we can put a car on a rolling

113
00:03:44,480 --> 00:03:48,000
dynamometer have it in motion in a safe

114
00:03:47,280 --> 00:03:50,959
environment

115
00:03:48,000 --> 00:03:53,200
and perform more or less like cyber

116
00:03:50,959 --> 00:03:55,680
evaluations to see if

117
00:03:53,200 --> 00:03:58,238
we can develop and tool and create some

118
00:03:55,680 --> 00:04:01,519
defenses for vehicles

119
00:03:58,239 --> 00:04:03,040
so this is one i like to show is uh so

120
00:04:01,519 --> 00:04:06,560
our cars really

121
00:04:03,040 --> 00:04:11,439
truly uh hackable are they vulnerable

122
00:04:06,560 --> 00:04:13,040
this was a video of a gentleman we had

123
00:04:11,439 --> 00:04:14,640
there we go this is the video of a

124
00:04:13,040 --> 00:04:15,439
gentleman we had uh coming from the air

125
00:04:14,640 --> 00:04:17,120
force

126
00:04:15,439 --> 00:04:18,798
and he was a fighter pilot so he was

127
00:04:17,120 --> 00:04:20,639
actually our first guinea pig we figure

128
00:04:18,798 --> 00:04:23,359
if he can uh fly jets really

129
00:04:20,639 --> 00:04:25,280
really fast we probably put him in a car

130
00:04:23,360 --> 00:04:28,080
and hack it and he'll be okay

131
00:04:25,280 --> 00:04:28,479
this is just an arduino board with a can

132
00:04:28,080 --> 00:04:30,800
bus

133
00:04:28,479 --> 00:04:31,599
addition that plugs into the obd port of

134
00:04:30,800 --> 00:04:33,280
the car

135
00:04:31,600 --> 00:04:35,360
and he's going to accelerate to about 10

136
00:04:33,280 --> 00:04:37,039
miles per hour the arduino is going to

137
00:04:35,360 --> 00:04:39,040
recognize the speed of the vehicle

138
00:04:37,040 --> 00:04:41,120
and then it's going to trigger an attack

139
00:04:39,040 --> 00:04:41,680
and all this attack's doing is it's just

140
00:04:41,120 --> 00:04:44,800
sending

141
00:04:41,680 --> 00:04:46,479
like junk into the port and you see some

142
00:04:44,800 --> 00:04:48,479
like really scary flashes

143
00:04:46,479 --> 00:04:50,880
uh you don't get audio through the

144
00:04:48,479 --> 00:04:53,280
meeting but the engine revs like way up

145
00:04:50,880 --> 00:04:56,159
and then all the relays start clicking

146
00:04:53,280 --> 00:04:57,039
uh and this is like a dumb attack like

147
00:04:56,160 --> 00:04:59,680
you you just

148
00:04:57,040 --> 00:05:01,360
you plug in and you have like a random

149
00:04:59,680 --> 00:05:04,960
number generator that just sends a

150
00:05:01,360 --> 00:05:04,960
random payload across messages

151
00:05:06,080 --> 00:05:10,240
so what really allows us to do this kind

152
00:05:09,039 --> 00:05:13,360
of like scary

153
00:05:10,240 --> 00:05:15,120
uh infiltrating of the vehicle

154
00:05:13,360 --> 00:05:16,880
well it's uh it's a network inside of

155
00:05:15,120 --> 00:05:17,520
the car that's called a controller area

156
00:05:16,880 --> 00:05:19,919
network

157
00:05:17,520 --> 00:05:22,000
and uh i'll call it a can or a can bus

158
00:05:19,919 --> 00:05:24,400
interchangeably throughout the talk

159
00:05:22,000 --> 00:05:26,880
but in a sense there are a variety of

160
00:05:24,400 --> 00:05:28,960
networks that actually exist on your car

161
00:05:26,880 --> 00:05:31,120
um from everything that handles

162
00:05:28,960 --> 00:05:33,680
multimedia to like your

163
00:05:31,120 --> 00:05:35,759
interior inside your like door panel

164
00:05:33,680 --> 00:05:38,080
will have its own little kind of network

165
00:05:35,759 --> 00:05:40,000
but the one that is really critical is

166
00:05:38,080 --> 00:05:41,039
the can and the reason for that is kind

167
00:05:40,000 --> 00:05:43,680
of twofold

168
00:05:41,039 --> 00:05:44,880
one is that this is the network that

169
00:05:43,680 --> 00:05:47,039
primarily connects

170
00:05:44,880 --> 00:05:49,600
all of the critical electronic control

171
00:05:47,039 --> 00:05:51,759
units or ecu's in your car

172
00:05:49,600 --> 00:05:53,199
and allows them to talk to each other

173
00:05:51,759 --> 00:05:54,240
the other problem is that it's actually

174
00:05:53,199 --> 00:05:57,199
mandated so

175
00:05:54,240 --> 00:05:58,960
any vehicle produced after 2008 has to

176
00:05:57,199 --> 00:06:00,720
have this thing called a can bus

177
00:05:58,960 --> 00:06:02,080
and the reason for that is largely like

178
00:06:00,720 --> 00:06:05,840
emissions purposes

179
00:06:02,080 --> 00:06:06,479
for for most of it and that's because

180
00:06:05,840 --> 00:06:09,919
you know

181
00:06:06,479 --> 00:06:12,000
prior to 2008 oems would kind of have

182
00:06:09,919 --> 00:06:13,758
whatever proprietary network that

183
00:06:12,000 --> 00:06:15,440
they wanted to have in their car and so

184
00:06:13,759 --> 00:06:17,440
it became kind of cumbersome to do

185
00:06:15,440 --> 00:06:20,160
testing when you had to have

186
00:06:17,440 --> 00:06:21,919
15 different devices to speed the right

187
00:06:20,160 --> 00:06:23,199
language to be able to interact with the

188
00:06:21,919 --> 00:06:27,120
car

189
00:06:23,199 --> 00:06:30,160
um so the cam was mandated in 2008

190
00:06:27,120 --> 00:06:31,840
it's got to be on every vehicle and in

191
00:06:30,160 --> 00:06:34,720
terms of electronic control units or

192
00:06:31,840 --> 00:06:38,159
ecu's your vehicle can have upwards of

193
00:06:34,720 --> 00:06:39,840
i mean 100 or more of these on a brand

194
00:06:38,160 --> 00:06:41,440
new luxury vehicle

195
00:06:39,840 --> 00:06:43,679
everything from like engine control

196
00:06:41,440 --> 00:06:47,280
module transmission control module

197
00:06:43,680 --> 00:06:48,240
like seat belt safety status control

198
00:06:47,280 --> 00:06:50,400
module you can

199
00:06:48,240 --> 00:06:51,440
essentially take a noun and then stick

200
00:06:50,400 --> 00:06:52,880
control module

201
00:06:51,440 --> 00:06:54,800
after it and your car will almost

202
00:06:52,880 --> 00:06:56,479
certainly have it

203
00:06:54,800 --> 00:06:58,720
so now we have a ton of ecu's in your

204
00:06:56,479 --> 00:07:00,560
car and they're connected to a network

205
00:06:58,720 --> 00:07:02,240
but the kicker is this network has some

206
00:07:00,560 --> 00:07:04,560
inherent vulnerabilities

207
00:07:02,240 --> 00:07:06,560
uh so once it's an open broadcast bus

208
00:07:04,560 --> 00:07:08,400
network meaning

209
00:07:06,560 --> 00:07:10,400
anywhere you plug in on this network

210
00:07:08,400 --> 00:07:12,400
like the obd port you can see all of the

211
00:07:10,400 --> 00:07:14,479
messages that are being sent

212
00:07:12,400 --> 00:07:15,520
from everywhere else that that's on that

213
00:07:14,479 --> 00:07:17,359
same can

214
00:07:15,520 --> 00:07:19,280
there's also no way to really verify

215
00:07:17,360 --> 00:07:21,039
that who's sending the message is who

216
00:07:19,280 --> 00:07:22,080
they say they are like the attack on the

217
00:07:21,039 --> 00:07:23,840
previous slide

218
00:07:22,080 --> 00:07:25,520
we were using an arduino to spoof a

219
00:07:23,840 --> 00:07:26,960
bunch of messages i mean

220
00:07:25,520 --> 00:07:28,799
randomly we didn't even know what we

221
00:07:26,960 --> 00:07:30,719
were sending and the car

222
00:07:28,800 --> 00:07:32,160
seemed to accept it as if it were

223
00:07:30,720 --> 00:07:33,840
absolute truth

224
00:07:32,160 --> 00:07:36,000
uh and it's super easy to actually

225
00:07:33,840 --> 00:07:39,919
identify a can bus and connect to it

226
00:07:36,000 --> 00:07:41,680
um so for one it's located in your obd

227
00:07:39,919 --> 00:07:43,280
port the onboard diagnostics port on

228
00:07:41,680 --> 00:07:45,280
your vehicle which is like right

229
00:07:43,280 --> 00:07:47,198
usually next to your steering wheel you

230
00:07:45,280 --> 00:07:48,559
may have had a mechanic hook into it

231
00:07:47,199 --> 00:07:50,319
or if you you're in a state that does

232
00:07:48,560 --> 00:07:51,199
emissions testing they may use that as

233
00:07:50,319 --> 00:07:53,280
well

234
00:07:51,199 --> 00:07:56,000
um more specifically it's actually

235
00:07:53,280 --> 00:07:59,119
located on these two pins so pick

236
00:07:56,000 --> 00:08:00,960
pin 6 and 14 on the obd port if you're

237
00:07:59,120 --> 00:08:02,479
looking at the little chart here and

238
00:08:00,960 --> 00:08:05,758
this is where it's mandated to be

239
00:08:02,479 --> 00:08:07,280
on every car after 2008 so not only does

240
00:08:05,759 --> 00:08:09,039
the vehicle have to have can

241
00:08:07,280 --> 00:08:10,878
it actually has to exist on these two

242
00:08:09,039 --> 00:08:12,479
pins as well because that to the

243
00:08:10,879 --> 00:08:14,160
reason of you don't want to have 15

244
00:08:12,479 --> 00:08:16,878
different tools to

245
00:08:14,160 --> 00:08:17,520
accomplish one task so at a glance you

246
00:08:16,879 --> 00:08:19,599
can say

247
00:08:17,520 --> 00:08:22,080
well i know where it's at i can connect

248
00:08:19,599 --> 00:08:25,280
to it and i can play around

249
00:08:22,080 --> 00:08:28,719
i will say this that maybe

250
00:08:25,280 --> 00:08:30,479
since um 2018 2019

251
00:08:28,720 --> 00:08:32,240
automakers have been getting kind of hip

252
00:08:30,479 --> 00:08:33,120
to the fact that people are plugging

253
00:08:32,240 --> 00:08:35,680
into their obd

254
00:08:33,120 --> 00:08:36,159
ports and messing around with their cars

255
00:08:35,679 --> 00:08:38,958
and

256
00:08:36,159 --> 00:08:40,080
so a lot of a lot of oems have started

257
00:08:38,958 --> 00:08:42,079
putting like a filter

258
00:08:40,080 --> 00:08:43,599
or a gateway on the other side of that

259
00:08:42,080 --> 00:08:46,000
obd port where

260
00:08:43,599 --> 00:08:48,240
you don't get all the raw data from the

261
00:08:46,000 --> 00:08:50,480
ecu's you can only request

262
00:08:48,240 --> 00:08:52,320
the specific things for like emissions

263
00:08:50,480 --> 00:08:53,680
testing or diagnostic purposes

264
00:08:52,320 --> 00:08:55,760
you don't get that that kind of

265
00:08:53,680 --> 00:08:58,560
unadulterated access

266
00:08:55,760 --> 00:09:00,560
um that's okay though because i said can

267
00:08:58,560 --> 00:09:02,560
exist on two wires i just wanted to show

268
00:09:00,560 --> 00:09:03,199
this little slide to kind of illustrate

269
00:09:02,560 --> 00:09:05,359
that

270
00:09:03,200 --> 00:09:07,440
that you have two wires on can one's

271
00:09:05,360 --> 00:09:09,360
called a can high and a can low

272
00:09:07,440 --> 00:09:11,839
and the reason for that is there a

273
00:09:09,360 --> 00:09:13,440
differential signaling bus so

274
00:09:11,839 --> 00:09:15,120
high will kind of move up in voltage and

275
00:09:13,440 --> 00:09:16,320
can low will move down and that's how

276
00:09:15,120 --> 00:09:19,120
you transmit your

277
00:09:16,320 --> 00:09:19,839
your ones and zeros um because the

278
00:09:19,120 --> 00:09:22,480
vehicle

279
00:09:19,839 --> 00:09:24,320
is really inherently noisy like from an

280
00:09:22,480 --> 00:09:27,120
electromagnetic standpoint

281
00:09:24,320 --> 00:09:27,839
uh these guys are twisted together to

282
00:09:27,120 --> 00:09:29,519
try and

283
00:09:27,839 --> 00:09:30,880
do a little bit of shielding to avoid

284
00:09:29,519 --> 00:09:33,680
any sort of

285
00:09:30,880 --> 00:09:34,640
integrity loss from the messages so um

286
00:09:33,680 --> 00:09:37,680
kind of simply

287
00:09:34,640 --> 00:09:39,920
even if you have a car where the oem has

288
00:09:37,680 --> 00:09:40,959
disabled some of the access at the obd

289
00:09:39,920 --> 00:09:43,439
port you can

290
00:09:40,959 --> 00:09:44,000
maybe pull apart your dash or under your

291
00:09:43,440 --> 00:09:46,959
hood

292
00:09:44,000 --> 00:09:49,200
or inside of your wheel well and find a

293
00:09:46,959 --> 00:09:50,800
pair of twisted wires and typically the

294
00:09:49,200 --> 00:09:51,760
only pair of twisted wires you're going

295
00:09:50,800 --> 00:09:54,479
to see on a car

296
00:09:51,760 --> 00:09:55,760
are from this can bus so as an example

297
00:09:54,480 --> 00:09:57,519
of that we had a

298
00:09:55,760 --> 00:10:00,480
big bus we were doing a little bit of

299
00:09:57,519 --> 00:10:00,480
evaluation on

300
00:10:01,120 --> 00:10:05,279
and this guy was actually filtered

301
00:10:03,360 --> 00:10:06,880
pretty heavily at the obd port so we

302
00:10:05,279 --> 00:10:08,880
couldn't plug in and get

303
00:10:06,880 --> 00:10:11,360
you know raw data we were only getting

304
00:10:08,880 --> 00:10:15,120
what the manufacturer wanted us to see

305
00:10:11,360 --> 00:10:16,959
um however this bus had a really nifty

306
00:10:15,120 --> 00:10:18,640
service port where you could just unlock

307
00:10:16,959 --> 00:10:20,880
and open up this big bay

308
00:10:18,640 --> 00:10:22,720
and then have access to all of the ecu

309
00:10:20,880 --> 00:10:25,279
so these are all easy to use inside of

310
00:10:22,720 --> 00:10:26,560
the right side of the picture

311
00:10:25,279 --> 00:10:29,040
and then all we have to do is take a

312
00:10:26,560 --> 00:10:31,439
pair of piercing alligator clips

313
00:10:29,040 --> 00:10:33,120
find the twisted wires clip into them

314
00:10:31,440 --> 00:10:34,560
and then we're getting every message on

315
00:10:33,120 --> 00:10:34,959
the network that we're not supposed to

316
00:10:34,560 --> 00:10:36,399
see

317
00:10:34,959 --> 00:10:38,239
or they don't want us to see they don't

318
00:10:36,399 --> 00:10:42,480
want to see that

319
00:10:38,240 --> 00:10:44,480
um so that's kind of the physical side

320
00:10:42,480 --> 00:10:46,800
of your canvas now if you if you're

321
00:10:44,480 --> 00:10:49,200
interested in maybe interpreting data

322
00:10:46,800 --> 00:10:50,319
or looking at some of the logical stuff

323
00:10:49,200 --> 00:10:53,760
inside of cam

324
00:10:50,320 --> 00:10:55,440
this is actually a can frame so this is

325
00:10:53,760 --> 00:10:58,000
more or less what you're going to see

326
00:10:55,440 --> 00:10:59,920
once you you plug into your car

327
00:10:58,000 --> 00:11:02,160
and everything's running you're going to

328
00:10:59,920 --> 00:11:04,640
get a whole bunch of data that probably

329
00:11:02,160 --> 00:11:06,240
goes super fast and there's a lot that

330
00:11:04,640 --> 00:11:07,279
goes on inside of a cam frame but there

331
00:11:06,240 --> 00:11:09,680
are really two

332
00:11:07,279 --> 00:11:11,439
two really important fields that exist

333
00:11:09,680 --> 00:11:12,719
uh one's the arbitration field or the

334
00:11:11,440 --> 00:11:15,680
arbitration id

335
00:11:12,720 --> 00:11:17,040
or aid i might interchange that i'll try

336
00:11:15,680 --> 00:11:19,120
to spit it all the way out so i don't

337
00:11:17,040 --> 00:11:22,160
have acronym soup everyone

338
00:11:19,120 --> 00:11:25,920
so the arbitration id exists to kind of

339
00:11:22,160 --> 00:11:28,079
give the message a name or an id and

340
00:11:25,920 --> 00:11:30,079
allows us to index and prioritize that

341
00:11:28,079 --> 00:11:33,199
message uh so in a sense

342
00:11:30,079 --> 00:11:34,959
an arbitration id

343
00:11:33,200 --> 00:11:37,040
kind of determines the priority of who

344
00:11:34,959 --> 00:11:39,199
gets to speak on the bus

345
00:11:37,040 --> 00:11:41,439
and a simple way to kind of think about

346
00:11:39,200 --> 00:11:43,200
that is the lower the arbitration id the

347
00:11:41,440 --> 00:11:44,880
more precedence they have to actually

348
00:11:43,200 --> 00:11:46,959
talk inside of the vehicle

349
00:11:44,880 --> 00:11:48,880
so a really simple dumb attack like the

350
00:11:46,959 --> 00:11:50,719
one i showed you earlier

351
00:11:48,880 --> 00:11:52,639
that could be accomplished by just

352
00:11:50,720 --> 00:11:56,079
spamming id

353
00:11:52,639 --> 00:11:57,600
0 0 0 at a rate that every other ecu

354
00:11:56,079 --> 00:11:59,120
or faster than a rate that every other

355
00:11:57,600 --> 00:12:00,959
ecu talks at

356
00:11:59,120 --> 00:12:02,560
and because of zero zero zero is the

357
00:12:00,959 --> 00:12:04,560
lowest arbitration id

358
00:12:02,560 --> 00:12:06,239
you can have no other message will be

359
00:12:04,560 --> 00:12:07,518
able to actually propagate throughout

360
00:12:06,240 --> 00:12:09,360
the bus

361
00:12:07,519 --> 00:12:12,079
now the other important field is your

362
00:12:09,360 --> 00:12:14,079
data field and this is kind of as it

363
00:12:12,079 --> 00:12:15,519
as you would expect your payload or your

364
00:12:14,079 --> 00:12:18,560
actual your

365
00:12:15,519 --> 00:12:20,399
message contents and the data field is

366
00:12:18,560 --> 00:12:24,239
super small so it's one of the

367
00:12:20,399 --> 00:12:24,800
the real kind of handicaps of can is it

368
00:12:24,240 --> 00:12:27,440
can only

369
00:12:24,800 --> 00:12:29,519
transmit up to 64 bits of data so that

370
00:12:27,440 --> 00:12:31,680
makes it really hard to add any sort of

371
00:12:29,519 --> 00:12:33,519
like encryption schemes or

372
00:12:31,680 --> 00:12:35,760
ways to further obfuscate the data

373
00:12:33,519 --> 00:12:38,399
outside of just filtering firewalling

374
00:12:35,760 --> 00:12:39,519
and not providing access um there are

375
00:12:38,399 --> 00:12:41,440
some more technical

376
00:12:39,519 --> 00:12:43,680
things that go on inside of here as well

377
00:12:41,440 --> 00:12:45,120
but we're not going to dive into that

378
00:12:43,680 --> 00:12:46,959
just for the purpose of this i want you

379
00:12:45,120 --> 00:12:48,639
guys to be familiar with the arbitration

380
00:12:46,959 --> 00:12:50,160
id in the data field

381
00:12:48,639 --> 00:12:52,480
um so now you kind of know what a

382
00:12:50,160 --> 00:12:54,399
message may look like

383
00:12:52,480 --> 00:12:55,839
we use a lot of tools on our day-to-day

384
00:12:54,399 --> 00:12:58,079
when it comes to

385
00:12:55,839 --> 00:12:59,279
uh reading can from the data like

386
00:12:58,079 --> 00:13:02,319
software tools

387
00:12:59,279 --> 00:13:02,800
and the most useful and versatile i

388
00:13:02,320 --> 00:13:04,800
would say

389
00:13:02,800 --> 00:13:06,479
is a linux tool called canutil so you

390
00:13:04,800 --> 00:13:09,359
can you know you can do like

391
00:13:06,480 --> 00:13:11,680
get install canutils and it's a tool

392
00:13:09,360 --> 00:13:14,320
that was actually made by volkswagen

393
00:13:11,680 --> 00:13:15,279
and was released to be open source and

394
00:13:14,320 --> 00:13:18,000
it works with

395
00:13:15,279 --> 00:13:18,560
a lot of things so it works particularly

396
00:13:18,000 --> 00:13:21,839
with

397
00:13:18,560 --> 00:13:22,479
any linux based systems so say raspberry

398
00:13:21,839 --> 00:13:26,959
pi's

399
00:13:22,480 --> 00:13:27,600
beagle bones your own laptop so on so

400
00:13:26,959 --> 00:13:31,119
forth

401
00:13:27,600 --> 00:13:33,360
you can install canutels and use it to

402
00:13:31,120 --> 00:13:34,320
translate send receive data from your

403
00:13:33,360 --> 00:13:36,800
vehicle

404
00:13:34,320 --> 00:13:38,800
and this is just a screenshot of one of

405
00:13:36,800 --> 00:13:42,240
the tools inside of can utils

406
00:13:38,800 --> 00:13:44,560
called a can dom and this just like

407
00:13:42,240 --> 00:13:46,560
dumbly dumps all the messages as they

408
00:13:44,560 --> 00:13:48,800
come in on message receive print message

409
00:13:46,560 --> 00:13:50,319
more or less so on the left hand side

410
00:13:48,800 --> 00:13:53,040
you've got the timestamp

411
00:13:50,320 --> 00:13:55,360
and zero just denotes the interface and

412
00:13:53,040 --> 00:13:58,160
like wlan0

413
00:13:55,360 --> 00:13:59,360
and then the actual message or frame is

414
00:13:58,160 --> 00:14:00,880
over on the right so you have the

415
00:13:59,360 --> 00:14:02,800
arbitration id

416
00:14:00,880 --> 00:14:04,240
and then it's separated by the pound

417
00:14:02,800 --> 00:14:06,880
sign and then

418
00:14:04,240 --> 00:14:08,399
uh 64 bits or eight bytes of data in

419
00:14:06,880 --> 00:14:09,920
half

420
00:14:08,399 --> 00:14:11,519
so there are some nuances to can right

421
00:14:09,920 --> 00:14:13,760
like you can't just

422
00:14:11,519 --> 00:14:15,760
um expect everything to work the first

423
00:14:13,760 --> 00:14:17,439
time and i was told when i started

424
00:14:15,760 --> 00:14:19,439
on this project there's a steep learning

425
00:14:17,440 --> 00:14:20,160
curve and then after that it gets really

426
00:14:19,440 --> 00:14:22,800
easy

427
00:14:20,160 --> 00:14:23,760
uh so some of the nuances are that each

428
00:14:22,800 --> 00:14:26,479
vehicle's can

429
00:14:23,760 --> 00:14:27,279
will have a preset bit rate for all the

430
00:14:26,480 --> 00:14:28,720
messages that

431
00:14:27,279 --> 00:14:31,120
are probably ec used to talk to each

432
00:14:28,720 --> 00:14:34,480
other properly most modern cars

433
00:14:31,120 --> 00:14:36,560
it's a 500k but it can vary and that's

434
00:14:34,480 --> 00:14:38,320
important because if you get inspired

435
00:14:36,560 --> 00:14:39,199
after this talk and want to hack on your

436
00:14:38,320 --> 00:14:40,639
own car

437
00:14:39,199 --> 00:14:42,800
you can actually plug in with the wrong

438
00:14:40,639 --> 00:14:44,240
bit rate and cause some pretty scary

439
00:14:42,800 --> 00:14:45,920
errors to pop up and

440
00:14:44,240 --> 00:14:47,519
interrupt communication between all the

441
00:14:45,920 --> 00:14:48,959
ecu's

442
00:14:47,519 --> 00:14:51,839
another thing is it's actually meant to

443
00:14:48,959 --> 00:14:52,719
be terminated with the 120 ohm resistor

444
00:14:51,839 --> 00:14:55,680
as well

445
00:14:52,720 --> 00:14:57,360
so practically a lot of times if you're

446
00:14:55,680 --> 00:14:58,319
just messing around in your garage that

447
00:14:57,360 --> 00:15:00,639
doesn't

448
00:14:58,320 --> 00:15:02,399
doesn't quite matter um but it's

449
00:15:00,639 --> 00:15:04,079
occasionally happened to me that i

450
00:15:02,399 --> 00:15:05,760
plugged everything in it's all working

451
00:15:04,079 --> 00:15:08,079
right i can't figure out why i'm not

452
00:15:05,760 --> 00:15:10,480
getting any messages and it's because

453
00:15:08,079 --> 00:15:11,519
this car is very finicky and it requires

454
00:15:10,480 --> 00:15:14,480
actual

455
00:15:11,519 --> 00:15:14,480
termination to work

456
00:15:15,519 --> 00:15:19,040
i also mentioned earlier that you can

457
00:15:17,839 --> 00:15:21,839
have upwards of

458
00:15:19,040 --> 00:15:24,480
say 100 ecu's in your car but you can

459
00:15:21,839 --> 00:15:28,320
also have like

460
00:15:24,480 --> 00:15:30,800
200 or 250 arbitration ids on your car

461
00:15:28,320 --> 00:15:31,519
so as a result that that simply means

462
00:15:30,800 --> 00:15:34,479
that

463
00:15:31,519 --> 00:15:36,000
each ecu may broadcast more than one

464
00:15:34,480 --> 00:15:38,079
arbitration id in fact

465
00:15:36,000 --> 00:15:40,079
one ecu may broadcast the bulk of the

466
00:15:38,079 --> 00:15:41,839
arbitration ids in your car

467
00:15:40,079 --> 00:15:43,359
meaning that many different messages

468
00:15:41,839 --> 00:15:46,320
types can come from

469
00:15:43,360 --> 00:15:48,079
one ecu another important distinction

470
00:15:46,320 --> 00:15:50,560
about can is that

471
00:15:48,079 --> 00:15:51,120
each vehicle from like year make model

472
00:15:50,560 --> 00:15:53,518
trim

473
00:15:51,120 --> 00:15:55,279
will likely have unique encodings for

474
00:15:53,519 --> 00:15:58,959
their cam messages meaning that

475
00:15:55,279 --> 00:16:02,000
um you know my my 2015 volt

476
00:15:58,959 --> 00:16:05,279
will not be entirely the same as

477
00:16:02,000 --> 00:16:07,440
a 2016 volt

478
00:16:05,279 --> 00:16:09,680
the reason for that is is partly just

479
00:16:07,440 --> 00:16:11,199
simply different devices and as vehicles

480
00:16:09,680 --> 00:16:13,040
get upgraded new

481
00:16:11,199 --> 00:16:15,040
you know messages are needed to support

482
00:16:13,040 --> 00:16:16,719
all the functions but another reason for

483
00:16:15,040 --> 00:16:18,959
that is that uh

484
00:16:16,720 --> 00:16:20,160
automakers follow largely security

485
00:16:18,959 --> 00:16:22,638
through obscurity

486
00:16:20,160 --> 00:16:23,519
so they don't really want to broadcast

487
00:16:22,639 --> 00:16:25,600
or

488
00:16:23,519 --> 00:16:27,360
really enumerate and tell you what the

489
00:16:25,600 --> 00:16:29,040
encodings of their messages are

490
00:16:27,360 --> 00:16:30,720
you avoid a lot of intense reverse

491
00:16:29,040 --> 00:16:32,240
engineering efforts and you know of

492
00:16:30,720 --> 00:16:33,360
course the big ones like performance

493
00:16:32,240 --> 00:16:35,440
tuning you don't

494
00:16:33,360 --> 00:16:38,160
really want someone to break into your

495
00:16:35,440 --> 00:16:39,279
ecu pull out your firmware and have fun

496
00:16:38,160 --> 00:16:42,560
with it

497
00:16:39,279 --> 00:16:44,160
um another important thing to think of

498
00:16:42,560 --> 00:16:45,839
is that you actually may have more than

499
00:16:44,160 --> 00:16:48,160
one can on a vehicle

500
00:16:45,839 --> 00:16:49,279
so although in your obd port those two

501
00:16:48,160 --> 00:16:51,519
pins are

502
00:16:49,279 --> 00:16:52,639
mandated and legislated and required to

503
00:16:51,519 --> 00:16:54,480
exist

504
00:16:52,639 --> 00:16:55,759
like in my volt for instance it's got

505
00:16:54,480 --> 00:16:57,759
like four cans

506
00:16:55,759 --> 00:16:59,759
throughout it so each one of those has

507
00:16:57,759 --> 00:17:02,560
its own separate

508
00:16:59,759 --> 00:17:04,640
uh stream of data and some of them are

509
00:17:02,560 --> 00:17:07,198
more important than others

510
00:17:04,640 --> 00:17:08,160
and of course you can't just like take a

511
00:17:07,199 --> 00:17:10,319
usb cable

512
00:17:08,160 --> 00:17:11,679
cut the ends wire it up and then expect

513
00:17:10,319 --> 00:17:13,280
everything to work when you have it

514
00:17:11,679 --> 00:17:14,160
plugged into your laptop so you do have

515
00:17:13,280 --> 00:17:16,079
to have

516
00:17:14,160 --> 00:17:17,600
a little bit of specialized hardware in

517
00:17:16,079 --> 00:17:19,198
order to talk in

518
00:17:17,599 --> 00:17:21,119
and uh at minimum you need like a

519
00:17:19,199 --> 00:17:23,120
processing unit like laptop

520
00:17:21,119 --> 00:17:24,239
raspberry pi uh you know like single

521
00:17:23,119 --> 00:17:26,639
board computer that

522
00:17:24,240 --> 00:17:27,439
that can support can and then you need

523
00:17:26,640 --> 00:17:29,919
some of the

524
00:17:27,439 --> 00:17:31,520
hardware that actually talks can so one

525
00:17:29,919 --> 00:17:35,360
of those is a cam controller

526
00:17:31,520 --> 00:17:38,320
so that actually uh take like sends to

527
00:17:35,360 --> 00:17:40,159
the processing unit the logical frame

528
00:17:38,320 --> 00:17:41,439
format that says this is an arbitration

529
00:17:40,160 --> 00:17:42,960
id this is a message

530
00:17:41,440 --> 00:17:44,840
now i'm going to dump it to your

531
00:17:42,960 --> 00:17:47,919
terminal the can

532
00:17:44,840 --> 00:17:49,840
transceiver passes the actual physical

533
00:17:47,919 --> 00:17:52,480
bits to the cam controller

534
00:17:49,840 --> 00:17:53,360
so that it can pack those into the right

535
00:17:52,480 --> 00:17:55,760
message structure

536
00:17:53,360 --> 00:17:57,918
and send it to the processing unit and

537
00:17:55,760 --> 00:17:58,720
uh vice versa the processing unit will

538
00:17:57,919 --> 00:18:01,039
say

539
00:17:58,720 --> 00:18:03,840
send this on the cam controller will

540
00:18:01,039 --> 00:18:05,760
pack it into arbitration id and message

541
00:18:03,840 --> 00:18:07,199
then send to the can transceiver which

542
00:18:05,760 --> 00:18:09,039
will turn it into

543
00:18:07,200 --> 00:18:11,919
physical voltages that will send over

544
00:18:09,039 --> 00:18:14,799
the two can wires

545
00:18:11,919 --> 00:18:15,440
and um i probably should have said this

546
00:18:14,799 --> 00:18:18,639
earlier

547
00:18:15,440 --> 00:18:21,200
um but it can be super dangerous to like

548
00:18:18,640 --> 00:18:23,200
just plug something up to your obd port

549
00:18:21,200 --> 00:18:24,960
uh i gave a version of this talk at code

550
00:18:23,200 --> 00:18:28,080
match this year and i didn't

551
00:18:24,960 --> 00:18:28,640
put enough disclaimers into the talk

552
00:18:28,080 --> 00:18:30,799
itself

553
00:18:28,640 --> 00:18:32,880
so one of the attendees got really

554
00:18:30,799 --> 00:18:33,280
excited we built little devices for this

555
00:18:32,880 --> 00:18:35,200
talk

556
00:18:33,280 --> 00:18:36,639
based on a teensy and and they were

557
00:18:35,200 --> 00:18:38,559
actually like going out to the

558
00:18:36,640 --> 00:18:42,160
uh parking lot and plugging into their

559
00:18:38,559 --> 00:18:45,280
car and so one guy didn't cut all of the

560
00:18:42,160 --> 00:18:47,039
like wires that the extra wires that

561
00:18:45,280 --> 00:18:48,879
come from your obd port because we only

562
00:18:47,039 --> 00:18:50,640
need two but there's like 16

563
00:18:48,880 --> 00:18:52,960
in there and so when he plugged into his

564
00:18:50,640 --> 00:18:54,480
obd port his wires crossed and touched

565
00:18:52,960 --> 00:18:56,720
and he had like really big sparks and it

566
00:18:54,480 --> 00:18:58,720
was kind of scary and i'm like oh man

567
00:18:56,720 --> 00:19:00,799
can i be held liable for this

568
00:18:58,720 --> 00:19:02,160
um so as a result now i'm going to tell

569
00:19:00,799 --> 00:19:05,280
you all the way through the talk

570
00:19:02,160 --> 00:19:08,559
not to do anything i say and

571
00:19:05,280 --> 00:19:11,360
don't plug stuff into your car

572
00:19:08,559 --> 00:19:11,840
so now that we plugged into our car uh

573
00:19:11,360 --> 00:19:13,600
but

574
00:19:11,840 --> 00:19:16,000
so i want to demonstrate for you guys

575
00:19:13,600 --> 00:19:17,760
actually using the can util software to

576
00:19:16,000 --> 00:19:19,039
do a little bit of reverse engineering

577
00:19:17,760 --> 00:19:20,960
on your vehicle

578
00:19:19,039 --> 00:19:22,960
and so i'm using this tool called uh

579
00:19:20,960 --> 00:19:25,360
icsem or it's instrument cluster

580
00:19:22,960 --> 00:19:26,720
simulator it's written by uh craig smith

581
00:19:25,360 --> 00:19:28,240
so if you're familiar with the car

582
00:19:26,720 --> 00:19:29,679
hacker's handbook this is a hole he

583
00:19:28,240 --> 00:19:30,880
actually created

584
00:19:29,679 --> 00:19:32,960
and so what i'm doing here is i'm

585
00:19:30,880 --> 00:19:34,640
messing around without an actual car

586
00:19:32,960 --> 00:19:36,559
so i'm bringing up what's called a v cam

587
00:19:34,640 --> 00:19:39,120
it's a virtual can interface so

588
00:19:36,559 --> 00:19:41,678
it allows my computer to speak and

589
00:19:39,120 --> 00:19:44,159
without any sort of hardware required

590
00:19:41,679 --> 00:19:46,080
and then i'm actually going to feed this

591
00:19:44,160 --> 00:19:48,080
this virtual can interface to the

592
00:19:46,080 --> 00:19:49,760
instrument cluster simulator

593
00:19:48,080 --> 00:19:51,199
and the instrument cluster simulator

594
00:19:49,760 --> 00:19:54,160
will transmit

595
00:19:51,200 --> 00:19:55,039
actual cam messages uh through the

596
00:19:54,160 --> 00:19:57,200
virtual can

597
00:19:55,039 --> 00:19:58,080
as if it were a car and it will allow us

598
00:19:57,200 --> 00:19:59,679
to

599
00:19:58,080 --> 00:20:01,760
practice some reverse engineering

600
00:19:59,679 --> 00:20:02,240
techniques before plugging into our own

601
00:20:01,760 --> 00:20:04,840
car

602
00:20:02,240 --> 00:20:06,799
which we shouldn't do anyway so that's

603
00:20:04,840 --> 00:20:09,280
okay

604
00:20:06,799 --> 00:20:10,960
you can use um like an xbox controller

605
00:20:09,280 --> 00:20:14,480
or something and get really fancy with

606
00:20:10,960 --> 00:20:16,080
it i was just using my keyboard

607
00:20:14,480 --> 00:20:17,440
but there's a lot of functions inside of

608
00:20:16,080 --> 00:20:18,080
this tool that you can try to reverse

609
00:20:17,440 --> 00:20:20,880
engineer

610
00:20:18,080 --> 00:20:21,280
and what i actually want to try to work

611
00:20:20,880 --> 00:20:24,640
on

612
00:20:21,280 --> 00:20:26,000
uh is the uh we'll do the turn signal so

613
00:20:24,640 --> 00:20:27,760
this tool i brought up is called can

614
00:20:26,000 --> 00:20:30,400
sniffer it's another one of the tools

615
00:20:27,760 --> 00:20:32,720
that's inside of the can utils package

616
00:20:30,400 --> 00:20:33,440
and this allows us to see which messages

617
00:20:32,720 --> 00:20:36,000
are

618
00:20:33,440 --> 00:20:37,120
changing so there's a ton of messages

619
00:20:36,000 --> 00:20:39,280
inside of a can

620
00:20:37,120 --> 00:20:40,879
and it can get really messy to try and

621
00:20:39,280 --> 00:20:42,158
try to look through the manually this

622
00:20:40,880 --> 00:20:44,080
guy helps us out

623
00:20:42,159 --> 00:20:45,280
i'm gonna hit left turn signal and see

624
00:20:44,080 --> 00:20:47,199
if i can find a

625
00:20:45,280 --> 00:20:49,840
message that's changing based on the

626
00:20:47,200 --> 00:20:49,840
turn signal

627
00:20:50,640 --> 00:20:54,159
well i didn't hold right turn so i saw

628
00:20:53,039 --> 00:20:56,960
arbitration id

629
00:20:54,159 --> 00:20:58,000
188 there and kind of the middle is

630
00:20:56,960 --> 00:21:02,559
flashing 0

631
00:20:58,000 --> 00:21:06,000
2 when i hit the right turn signal

632
00:21:02,559 --> 00:21:07,200
and i think 0 1 when i hit the left

633
00:21:06,000 --> 00:21:10,480
so it leaves me to believe this

634
00:21:07,200 --> 00:21:13,760
arbitration id encodes the turn signal

635
00:21:10,480 --> 00:21:13,760
i just want to double check that

636
00:21:14,880 --> 00:21:18,960
so i'm going to use can send which is

637
00:21:16,640 --> 00:21:20,880
also one of the utilities inside of the

638
00:21:18,960 --> 00:21:22,240
uh the can utils package

639
00:21:20,880 --> 00:21:24,400
and i'm going to send that one and see

640
00:21:22,240 --> 00:21:26,640
if i get a response

641
00:21:24,400 --> 00:21:27,440
okay cool so i'm getting some left turn

642
00:21:26,640 --> 00:21:30,400
signal

643
00:21:27,440 --> 00:21:32,159
uh for all intents and purposes right

644
00:21:30,400 --> 00:21:35,520
like this is a cyber attack

645
00:21:32,159 --> 00:21:38,240
right this is something that

646
00:21:35,520 --> 00:21:38,960
we probably shouldn't be able to do is

647
00:21:38,240 --> 00:21:41,919
simulate

648
00:21:38,960 --> 00:21:43,360
the the turn signal so i'm gonna try o3

649
00:21:41,919 --> 00:21:44,000
and then we get hazard lights which

650
00:21:43,360 --> 00:21:47,360
isn't even an

651
00:21:44,000 --> 00:21:50,559
option or a feature inside of icsun uh

652
00:21:47,360 --> 00:21:52,080
this was kind of a a simple attack it's

653
00:21:50,559 --> 00:21:53,840
an injection attack

654
00:21:52,080 --> 00:21:55,360
and it's really messy so what happens

655
00:21:53,840 --> 00:21:56,000
and the reason that the turn signal

656
00:21:55,360 --> 00:21:57,918
doesn't

657
00:21:56,000 --> 00:21:59,280
like stay lit all the time and i had to

658
00:21:57,919 --> 00:22:02,159
keep resending it

659
00:21:59,280 --> 00:22:03,918
is because the actual legitimate car is

660
00:22:02,159 --> 00:22:06,320
saying well my turn signal is off and it

661
00:22:03,919 --> 00:22:08,400
keeps repeating that message until

662
00:22:06,320 --> 00:22:10,399
you flip your turn signal switch and the

663
00:22:08,400 --> 00:22:11,039
legitimate ecu says well the turn

664
00:22:10,400 --> 00:22:12,640
signals

665
00:22:11,039 --> 00:22:14,879
so we're always fighting with the fact

666
00:22:12,640 --> 00:22:16,640
that the turn signal is physically off

667
00:22:14,880 --> 00:22:18,640
but it's still considered i mean for

668
00:22:16,640 --> 00:22:20,159
intents and purposes and attack

669
00:22:18,640 --> 00:22:21,840
so i'm going to go ahead and accelerate

670
00:22:20,159 --> 00:22:24,159
my car up to 60.

671
00:22:21,840 --> 00:22:25,120
and uh what we're going to see is if we

672
00:22:24,159 --> 00:22:28,159
can figure out

673
00:22:25,120 --> 00:22:31,840
where maybe my speed is located

674
00:22:28,159 --> 00:22:33,280
inside of these messages and that's

675
00:22:31,840 --> 00:22:37,360
actually pretty hard

676
00:22:33,280 --> 00:22:39,120
so uh while it's easy well easier

677
00:22:37,360 --> 00:22:41,280
to identify these kind of binary

678
00:22:39,120 --> 00:22:43,840
messages like turn signal on

679
00:22:41,280 --> 00:22:44,399
turn signal off or hazard on hazard off

680
00:22:43,840 --> 00:22:47,280
or

681
00:22:44,400 --> 00:22:49,120
door open door closed locks on locks off

682
00:22:47,280 --> 00:22:51,520
that's kind of a scary one

683
00:22:49,120 --> 00:22:53,600
it's far more difficult to identify some

684
00:22:51,520 --> 00:22:55,039
sort of like time series dynamically

685
00:22:53,600 --> 00:22:57,520
changing value

686
00:22:55,039 --> 00:22:58,559
and you will spend a lot of time in your

687
00:22:57,520 --> 00:23:00,720
driveway

688
00:22:58,559 --> 00:23:01,678
messing with this just to figure out

689
00:23:00,720 --> 00:23:03,919
where your

690
00:23:01,679 --> 00:23:04,720
odometer may report the speed so there

691
00:23:03,919 --> 00:23:07,120
are easy ways

692
00:23:04,720 --> 00:23:09,200
easier ways to go about analyzing some

693
00:23:07,120 --> 00:23:11,439
of the data inside your vehicle

694
00:23:09,200 --> 00:23:13,520
uh one way to do that is through the

695
00:23:11,440 --> 00:23:16,320
onboard diagnostic service

696
00:23:13,520 --> 00:23:18,158
so this is uh like i mentioned earlier

697
00:23:16,320 --> 00:23:20,158
you may have like a mechanic that

698
00:23:18,159 --> 00:23:21,679
will plug into your vehicle and do some

699
00:23:20,159 --> 00:23:23,360
analysis

700
00:23:21,679 --> 00:23:25,440
and this is actually the the kind of

701
00:23:23,360 --> 00:23:27,360
service they use in order to get

702
00:23:25,440 --> 00:23:29,520
ground truth or to get the actual

703
00:23:27,360 --> 00:23:31,360
happenings from your vehicle

704
00:23:29,520 --> 00:23:32,639
so you can request a whole bunch of

705
00:23:31,360 --> 00:23:34,000
information from the car

706
00:23:32,640 --> 00:23:35,840
and instead of trying to read some

707
00:23:34,000 --> 00:23:38,080
obfuscated cam messages

708
00:23:35,840 --> 00:23:39,918
you can enumerate and figure out exactly

709
00:23:38,080 --> 00:23:42,399
what it's doing so if you're like a

710
00:23:39,919 --> 00:23:44,640
performance tuning guy or like i had an

711
00:23:42,400 --> 00:23:47,120
older car that didn't really

712
00:23:44,640 --> 00:23:47,840
clearly enumerate like my actual miles

713
00:23:47,120 --> 00:23:49,439
per gallon

714
00:23:47,840 --> 00:23:52,480
over the lifetime so i wanted to figure

715
00:23:49,440 --> 00:23:54,159
that out i just use these services to

716
00:23:52,480 --> 00:23:56,240
do a little bit of math to figure out my

717
00:23:54,159 --> 00:23:59,039
fuel consumption versus my

718
00:23:56,240 --> 00:23:59,039
distance ribbon

719
00:23:59,360 --> 00:24:02,559
now the uh the actual onboard diagnostic

720
00:24:01,760 --> 00:24:04,400
service

721
00:24:02,559 --> 00:24:06,480
it fits on top of cans so if you're

722
00:24:04,400 --> 00:24:09,200
familiar with the osi model

723
00:24:06,480 --> 00:24:09,919
it's closer to like an application layer

724
00:24:09,200 --> 00:24:12,640
whereas

725
00:24:09,919 --> 00:24:14,559
the actual can protocol is closer to our

726
00:24:12,640 --> 00:24:16,480
like network down to

727
00:24:14,559 --> 00:24:17,600
physical layer so there are actually

728
00:24:16,480 --> 00:24:19,039
some other things

729
00:24:17,600 --> 00:24:20,719
that i'm not going to get into but there

730
00:24:19,039 --> 00:24:22,640
are some other kind of

731
00:24:20,720 --> 00:24:24,640
additions to can that are built on top

732
00:24:22,640 --> 00:24:27,919
of it and can is largely just

733
00:24:24,640 --> 00:24:30,480
a network and you can do

734
00:24:27,919 --> 00:24:32,080
a lot of things with it including

735
00:24:30,480 --> 00:24:33,919
retrieving diagnostics

736
00:24:32,080 --> 00:24:35,279
um so there's a really cool wikipedia

737
00:24:33,919 --> 00:24:37,039
article here and

738
00:24:35,279 --> 00:24:38,240
if you don't want to remember it i know

739
00:24:37,039 --> 00:24:39,440
it's kind of hard to click from a

740
00:24:38,240 --> 00:24:42,320
powerpoint

741
00:24:39,440 --> 00:24:43,360
uh you can actually just google like obd

742
00:24:42,320 --> 00:24:46,480
two

743
00:24:43,360 --> 00:24:47,760
pids stands for parameter id and those

744
00:24:46,480 --> 00:24:49,679
are the

745
00:24:47,760 --> 00:24:51,200
enumerated values that we can actually

746
00:24:49,679 --> 00:24:53,679
request from a vehicle

747
00:24:51,200 --> 00:24:54,400
and so the way that it works is you must

748
00:24:53,679 --> 00:24:56,720
figure out

749
00:24:54,400 --> 00:24:58,400
what sort of data you want to ask for

750
00:24:56,720 --> 00:25:00,240
and then you just ask the car

751
00:24:58,400 --> 00:25:02,480
and the car will immediately shoot back

752
00:25:00,240 --> 00:25:05,120
and say well here's the info

753
00:25:02,480 --> 00:25:05,840
so because this is all standardized and

754
00:25:05,120 --> 00:25:08,158
it's used by

755
00:25:05,840 --> 00:25:08,959
you know emissions testing and mechanic

756
00:25:08,159 --> 00:25:10,720
shops

757
00:25:08,960 --> 00:25:12,559
this all works on a standardized

758
00:25:10,720 --> 00:25:15,919
arbitration id scheme

759
00:25:12,559 --> 00:25:18,960
so you don't actually learn which raw

760
00:25:15,919 --> 00:25:21,520
arbitration id is transmitting this data

761
00:25:18,960 --> 00:25:22,000
so instead you learn what the data

762
00:25:21,520 --> 00:25:23,760
actually

763
00:25:22,000 --> 00:25:25,520
is and then maybe try to match that or

764
00:25:23,760 --> 00:25:28,039
find that elsewhere and how it works is

765
00:25:25,520 --> 00:25:32,080
you send a request on arbitration id

766
00:25:28,039 --> 00:25:33,360
7df and then many other ecu's will reply

767
00:25:32,080 --> 00:25:36,799
to this broadcast

768
00:25:33,360 --> 00:25:38,080
for diagnostic queries most commonly

769
00:25:36,799 --> 00:25:41,279
just as a tidbit

770
00:25:38,080 --> 00:25:43,840
your engine like main ecu will

771
00:25:41,279 --> 00:25:44,880
live on 78 and that'll tell you a whole

772
00:25:43,840 --> 00:25:46,399
bunch of data

773
00:25:44,880 --> 00:25:49,200
and then you just parse the data that's

774
00:25:46,400 --> 00:25:50,159
given back from the standardized message

775
00:25:49,200 --> 00:25:51,840
structure

776
00:25:50,159 --> 00:25:53,760
and you can get a ton of data from this

777
00:25:51,840 --> 00:25:56,399
this is just pulled from the wikipedia

778
00:25:53,760 --> 00:25:58,640
article current data you can get stored

779
00:25:56,400 --> 00:26:00,080
diagnostic codes you can get some test

780
00:25:58,640 --> 00:26:02,640
results you can

781
00:26:00,080 --> 00:26:04,158
like request sorry reset your check

782
00:26:02,640 --> 00:26:05,520
engine light so you don't have to buy

783
00:26:04,159 --> 00:26:07,919
like a fancy tool

784
00:26:05,520 --> 00:26:10,400
or like go to advance or something and

785
00:26:07,919 --> 00:26:12,640
have them do it

786
00:26:10,400 --> 00:26:14,400
and this is just a quick snapshot of

787
00:26:12,640 --> 00:26:15,520
kind of all the information that you can

788
00:26:14,400 --> 00:26:18,000
ask from your car

789
00:26:15,520 --> 00:26:18,879
so there's over 150 possible parameter

790
00:26:18,000 --> 00:26:21,600
ids

791
00:26:18,880 --> 00:26:23,440
and there's no way that one car will

792
00:26:21,600 --> 00:26:24,240
support all of these for no other reason

793
00:26:23,440 --> 00:26:26,480
then

794
00:26:24,240 --> 00:26:28,000
a lot of these are specific for like

795
00:26:26,480 --> 00:26:30,320
electric cars or

796
00:26:28,000 --> 00:26:31,039
um maybe not electric cars maybe more

797
00:26:30,320 --> 00:26:33,120
like

798
00:26:31,039 --> 00:26:35,039
gas cars versus diesel cars like you

799
00:26:33,120 --> 00:26:37,840
can't have both types of

800
00:26:35,039 --> 00:26:39,360
fuel in one vehicle that i really know

801
00:26:37,840 --> 00:26:42,480
of

802
00:26:39,360 --> 00:26:44,240
um and so you can actually ask your car

803
00:26:42,480 --> 00:26:46,640
which messages it will reply to that's

804
00:26:44,240 --> 00:26:48,559
one of the the standardized

805
00:26:46,640 --> 00:26:50,159
parameter ids that you can request

806
00:26:48,559 --> 00:26:51,360
that's available in that wikipedia

807
00:26:50,159 --> 00:26:52,720
article

808
00:26:51,360 --> 00:26:54,240
so you just send the request at the

809
00:26:52,720 --> 00:26:55,279
start and you say hey what will you

810
00:26:54,240 --> 00:26:56,960
reply to

811
00:26:55,279 --> 00:26:59,039
it'll shoot back a whole bunch of hex

812
00:26:56,960 --> 00:27:00,880
and you just parse that as binary uh

813
00:26:59,039 --> 00:27:02,480
you know one means yes i support it and

814
00:27:00,880 --> 00:27:04,320
zero means no i don't

815
00:27:02,480 --> 00:27:06,159
and then you can build a list to request

816
00:27:04,320 --> 00:27:08,799
from your car based on that

817
00:27:06,159 --> 00:27:11,120
um so once we discovered that this kind

818
00:27:08,799 --> 00:27:13,679
of onboard diagnostic

819
00:27:11,120 --> 00:27:15,760
service exists we realized that we were

820
00:27:13,679 --> 00:27:18,480
going to waste a lot of time

821
00:27:15,760 --> 00:27:19,360
trying to understand cam data from the

822
00:27:18,480 --> 00:27:20,960
driveway

823
00:27:19,360 --> 00:27:23,600
when maybe we could leverage some of

824
00:27:20,960 --> 00:27:25,520
these diagnostic queries in order to

825
00:27:23,600 --> 00:27:27,600
automatically look at the encodings of

826
00:27:25,520 --> 00:27:28,240
messages and that's really important

827
00:27:27,600 --> 00:27:31,760
because

828
00:27:28,240 --> 00:27:33,440
can inherently has like a tokenization

829
00:27:31,760 --> 00:27:34,158
and translation problem so i mentioned

830
00:27:33,440 --> 00:27:36,000
earlier that

831
00:27:34,159 --> 00:27:37,600
all the networks are obfuscated so you

832
00:27:36,000 --> 00:27:40,320
don't know what

833
00:27:37,600 --> 00:27:41,918
is being said by each message further

834
00:27:40,320 --> 00:27:44,720
than that it's not really

835
00:27:41,919 --> 00:27:46,720
clear when you're getting bytes back

836
00:27:44,720 --> 00:27:48,559
where the actual functional message

837
00:27:46,720 --> 00:27:49,279
happens so this one kind of makes sense

838
00:27:48,559 --> 00:27:52,799
you have

839
00:27:49,279 --> 00:27:56,559
a can signal of engine rpm this is a

840
00:27:52,799 --> 00:27:59,440
an 8x8 grid layout of a 64-bit

841
00:27:56,559 --> 00:27:59,760
cam message so the bytes go all the way

842
00:27:59,440 --> 00:28:03,120
you know

843
00:27:59,760 --> 00:28:03,679
from seven to zero there the engine rpm

844
00:28:03,120 --> 00:28:06,559
takes up

845
00:28:03,679 --> 00:28:06,960
the first two bytes so that kind of

846
00:28:06,559 --> 00:28:09,600
makes

847
00:28:06,960 --> 00:28:10,720
sense right like takes up two bytes then

848
00:28:09,600 --> 00:28:13,039
in the next fight down

849
00:28:10,720 --> 00:28:14,000
you have battery voltage takes up the

850
00:28:13,039 --> 00:28:17,279
first five

851
00:28:14,000 --> 00:28:20,799
bits of the third byte and then

852
00:28:17,279 --> 00:28:23,440
the current gear is the last three bits

853
00:28:20,799 --> 00:28:25,120
so there's not a clear separation when

854
00:28:23,440 --> 00:28:27,120
you're reading in hex

855
00:28:25,120 --> 00:28:29,439
where these different message encodings

856
00:28:27,120 --> 00:28:32,479
are or i'll call them signals now

857
00:28:29,440 --> 00:28:34,559
where these different signals will be

858
00:28:32,480 --> 00:28:35,679
split and where that byte boundary

859
00:28:34,559 --> 00:28:37,520
exists

860
00:28:35,679 --> 00:28:39,760
uh and further than that so you can run

861
00:28:37,520 --> 00:28:42,559
into issues of like is this also a sign

862
00:28:39,760 --> 00:28:43,039
number does it include negatives and the

863
00:28:42,559 --> 00:28:44,960
most

864
00:28:43,039 --> 00:28:46,640
like frustrating thing is that your

865
00:28:44,960 --> 00:28:49,200
indian-ness can actually switch

866
00:28:46,640 --> 00:28:51,120
mid-byte too so you can go from reading

867
00:28:49,200 --> 00:28:52,640
five bits little ndm and then you have

868
00:28:51,120 --> 00:28:54,239
to switch your order ring and read the

869
00:28:52,640 --> 00:28:56,399
next three as a big endian

870
00:28:54,240 --> 00:28:57,679
and there's no real you know cohesive

871
00:28:56,399 --> 00:29:00,000
way to

872
00:28:57,679 --> 00:29:02,080
be able to understand that um or i

873
00:29:00,000 --> 00:29:02,559
should say that there used to not be up

874
00:29:02,080 --> 00:29:05,678
until

875
00:29:02,559 --> 00:29:06,960
maybe a year or two ago so we developed

876
00:29:05,679 --> 00:29:09,919
this pipeline it's called

877
00:29:06,960 --> 00:29:10,799
uh automotive and tokenization and

878
00:29:09,919 --> 00:29:15,120
translation

879
00:29:10,799 --> 00:29:17,520
we call it and this tool allows us to

880
00:29:15,120 --> 00:29:18,959
leverage diagnostic queries in order to

881
00:29:17,520 --> 00:29:21,600
automatically

882
00:29:18,960 --> 00:29:23,440
extract these signals from a car without

883
00:29:21,600 --> 00:29:25,600
spending time in our driveway

884
00:29:23,440 --> 00:29:27,440
and the way that it works is first we

885
00:29:25,600 --> 00:29:29,600
just learn maybe where those

886
00:29:27,440 --> 00:29:31,760
probabilities happen so like going from

887
00:29:29,600 --> 00:29:33,520
the first five bits we try to learn

888
00:29:31,760 --> 00:29:35,840
that the next three bits are a separate

889
00:29:33,520 --> 00:29:37,679
signal then we try to determine if that

890
00:29:35,840 --> 00:29:39,199
ending in this problem does happen

891
00:29:37,679 --> 00:29:41,440
where we have to start reading the bits

892
00:29:39,200 --> 00:29:42,960
in the opposite order once we do that we

893
00:29:41,440 --> 00:29:44,720
can figure out if there might be some

894
00:29:42,960 --> 00:29:46,320
negative numbers that exist inside of

895
00:29:44,720 --> 00:29:47,279
here whether they need to be signed or

896
00:29:46,320 --> 00:29:50,240
unsigned

897
00:29:47,279 --> 00:29:52,240
and finally and the really cool thing is

898
00:29:50,240 --> 00:29:52,960
we leveraged the diagnostic services

899
00:29:52,240 --> 00:29:55,200
earlier

900
00:29:52,960 --> 00:29:56,000
but then find where those signals might

901
00:29:55,200 --> 00:29:58,159
exist

902
00:29:56,000 --> 00:30:00,720
like practically in the can and i have

903
00:29:58,159 --> 00:30:03,360
just another quick demo so

904
00:30:00,720 --> 00:30:06,080
i'm using a raspberry pi here and i'm

905
00:30:03,360 --> 00:30:08,320
going to plug her into the obd port

906
00:30:06,080 --> 00:30:10,639
and then we're going to go for a short

907
00:30:08,320 --> 00:30:12,480
drive i'm going to record some data

908
00:30:10,640 --> 00:30:13,840
so the device is right there above my

909
00:30:12,480 --> 00:30:14,559
steering wheel the green light is

910
00:30:13,840 --> 00:30:16,158
flashing

911
00:30:14,559 --> 00:30:18,399
that means it's trying to determine the

912
00:30:16,159 --> 00:30:19,360
speed of the can so that we don't break

913
00:30:18,399 --> 00:30:21,760
my car

914
00:30:19,360 --> 00:30:22,639
um then the red light flashes with the

915
00:30:21,760 --> 00:30:24,640
drain that means

916
00:30:22,640 --> 00:30:25,840
we're requesting the vin of the vehicle

917
00:30:24,640 --> 00:30:27,840
and then we're trying to figure out

918
00:30:25,840 --> 00:30:28,879
which diagnostic queries it'll actually

919
00:30:27,840 --> 00:30:30,399
reply to

920
00:30:28,880 --> 00:30:32,159
when i press the button and the blue

921
00:30:30,399 --> 00:30:34,158
light starts flashing we're actually

922
00:30:32,159 --> 00:30:36,080
sending a ton of diagnostic requests to

923
00:30:34,159 --> 00:30:37,679
this vehicle so i'm saying like what's

924
00:30:36,080 --> 00:30:38,480
your speed what's your rpm what's your

925
00:30:37,679 --> 00:30:40,320
mass airflow

926
00:30:38,480 --> 00:30:42,000
over and over and over at a really fast

927
00:30:40,320 --> 00:30:44,559
rate and so i'm just going to go on a

928
00:30:42,000 --> 00:30:44,559
short drive

929
00:30:45,120 --> 00:30:48,399
and this is actually my wife's car

930
00:30:46,720 --> 00:30:49,279
because one thing i learned early on

931
00:30:48,399 --> 00:30:52,799
working at the lab

932
00:30:49,279 --> 00:30:53,760
is that you don't want to break your own

933
00:30:52,799 --> 00:30:55,360
vehicle

934
00:30:53,760 --> 00:30:57,279
it's always best to break the lab's

935
00:30:55,360 --> 00:30:58,879
vehicle but can't go on campus right now

936
00:30:57,279 --> 00:31:00,480
because of the kovid situation

937
00:30:58,880 --> 00:31:02,559
and my wife's car's a little bit older

938
00:31:00,480 --> 00:31:03,519
so i told her i'd rather break her

939
00:31:02,559 --> 00:31:05,120
vehicle

940
00:31:03,519 --> 00:31:08,880
and then she got mad until she realized

941
00:31:05,120 --> 00:31:08,879
like oh that means i might get a new car

942
00:31:09,039 --> 00:31:11,840
so i collected a bunch of diagnostic

943
00:31:10,480 --> 00:31:12,799
data here and then we're actually going

944
00:31:11,840 --> 00:31:16,080
to be able to

945
00:31:12,799 --> 00:31:18,080
uh parse this so on the back end that i

946
00:31:16,080 --> 00:31:19,360
didn't record i ran the act pipeline

947
00:31:18,080 --> 00:31:22,320
because it takes a few minutes on the

948
00:31:19,360 --> 00:31:25,760
raspberry pi they're not exactly like

949
00:31:22,320 --> 00:31:25,760
beefy processing units

950
00:31:25,840 --> 00:31:29,760
but essentially we've written a little

951
00:31:27,840 --> 00:31:32,879
tool that

952
00:31:29,760 --> 00:31:36,640
once we get the translated database file

953
00:31:32,880 --> 00:31:38,480
back from the vehicle that lets us

954
00:31:36,640 --> 00:31:39,360
understand the signals that are encoded

955
00:31:38,480 --> 00:31:41,120
inside of cam

956
00:31:39,360 --> 00:31:43,199
we can actually visualize these now in

957
00:31:41,120 --> 00:31:44,959
real time and so i've got a little

958
00:31:43,200 --> 00:31:46,960
screen

959
00:31:44,960 --> 00:31:48,320
there it is so i've got a little screen

960
00:31:46,960 --> 00:31:49,919
um and this guy's

961
00:31:48,320 --> 00:31:52,559
actually going to give us every

962
00:31:49,919 --> 00:31:54,960
arbitration idea that we see on the card

963
00:31:52,559 --> 00:31:55,600
and then enumerate the extracted signals

964
00:31:54,960 --> 00:31:57,760
from

965
00:31:55,600 --> 00:31:58,799
act so that we can see this stuff in

966
00:31:57,760 --> 00:32:01,600
real time without

967
00:31:58,799 --> 00:32:01,918
requesting diagnostic data anymore and

968
00:32:01,600 --> 00:32:04,879
so

969
00:32:01,919 --> 00:32:07,120
there's like timing advance in here um

970
00:32:04,880 --> 00:32:09,440
then i think another one has

971
00:32:07,120 --> 00:32:11,039
vehicle speed engine coolant temperature

972
00:32:09,440 --> 00:32:14,240
rpm

973
00:32:11,039 --> 00:32:17,919
and of course

974
00:32:14,240 --> 00:32:19,360
i select rpm uh we get zero because the

975
00:32:17,919 --> 00:32:21,919
volts an electric hybrid car

976
00:32:19,360 --> 00:32:23,760
runs on battery most of the time but one

977
00:32:21,919 --> 00:32:24,240
thing i i figured out was if you pull

978
00:32:23,760 --> 00:32:26,640
your

979
00:32:24,240 --> 00:32:27,279
uh your hood latch actually then it will

980
00:32:26,640 --> 00:32:29,440
force the

981
00:32:27,279 --> 00:32:33,279
combustion engine to kick on and then we

982
00:32:29,440 --> 00:32:35,440
get the spike up to about 1 600 rpms

983
00:32:33,279 --> 00:32:36,720
and um that's just one signal we can

984
00:32:35,440 --> 00:32:39,760
also view like

985
00:32:36,720 --> 00:32:41,360
uh coolant temperature and see like what

986
00:32:39,760 --> 00:32:45,200
it is right now

987
00:32:41,360 --> 00:32:47,199
um among every other you know the 150

988
00:32:45,200 --> 00:32:49,200
possible parameter ids that can be

989
00:32:47,200 --> 00:32:50,799
extracted from arbitration ids in this

990
00:32:49,200 --> 00:32:52,159
car

991
00:32:50,799 --> 00:32:54,320
and then there are also some unknown

992
00:32:52,159 --> 00:32:55,279
signals and what the unknown ones mean

993
00:32:54,320 --> 00:32:58,320
are that

994
00:32:55,279 --> 00:33:00,880
we weren't able to find these messages

995
00:32:58,320 --> 00:33:02,639
inside of the known diagnostic queries

996
00:33:00,880 --> 00:33:04,880
but we were able to identify

997
00:33:02,640 --> 00:33:06,480
that they're a unique signal that's

998
00:33:04,880 --> 00:33:08,159
encoded within the message so we can

999
00:33:06,480 --> 00:33:10,480
still graph these as well

1000
00:33:08,159 --> 00:33:12,880
and understand them and there's a big

1001
00:33:10,480 --> 00:33:14,559
motivation for understanding this data

1002
00:33:12,880 --> 00:33:16,320
uh so for one we're using this for

1003
00:33:14,559 --> 00:33:18,320
intrusion detection systems because we

1004
00:33:16,320 --> 00:33:20,240
want to extract signals turn them into a

1005
00:33:18,320 --> 00:33:23,120
time series and tell when they're

1006
00:33:20,240 --> 00:33:24,960
no longer continuous uh another thing

1007
00:33:23,120 --> 00:33:26,080
maybe after market understanding so as

1008
00:33:24,960 --> 00:33:29,440
mentioned earlier if you're

1009
00:33:26,080 --> 00:33:31,199
a car person and you want to

1010
00:33:29,440 --> 00:33:33,760
figure out your fuel economy or you're

1011
00:33:31,200 --> 00:33:36,000
like 0 to 60 time but you don't want to

1012
00:33:33,760 --> 00:33:36,799
send stuff to your vehicle while it's

1013
00:33:36,000 --> 00:33:38,960
driving

1014
00:33:36,799 --> 00:33:41,519
well you can use this kind of tool in

1015
00:33:38,960 --> 00:33:43,360
order to read dynamically from the bus

1016
00:33:41,519 --> 00:33:45,200
so that you're not requesting diagnostic

1017
00:33:43,360 --> 00:33:47,120
queries and then of course there's a big

1018
00:33:45,200 --> 00:33:50,240
market for performance tuning

1019
00:33:47,120 --> 00:33:53,120
where it may be valuable to understand

1020
00:33:50,240 --> 00:33:53,440
which arbitration id and ecu are sending

1021
00:33:53,120 --> 00:33:56,399
say

1022
00:33:53,440 --> 00:33:58,159
the like the the throttle percentage and

1023
00:33:56,399 --> 00:34:00,158
then figuring out an easy way to

1024
00:33:58,159 --> 00:34:02,799
identify that and then manipulate it so

1025
00:34:00,159 --> 00:34:04,559
that more power is going to the car

1026
00:34:02,799 --> 00:34:06,320
um so we're using it for intrusion

1027
00:34:04,559 --> 00:34:09,119
detection so i gotta talk a little bit

1028
00:34:06,320 --> 00:34:12,480
about that from a security standpoint

1029
00:34:09,119 --> 00:34:14,800
um because hands limited in the

1030
00:34:12,480 --> 00:34:15,918
amount of bits it can transmit it's very

1031
00:34:14,800 --> 00:34:17,599
small

1032
00:34:15,918 --> 00:34:20,158
it's hard to develop like i said some

1033
00:34:17,599 --> 00:34:21,679
sort of encryption scheme so

1034
00:34:20,159 --> 00:34:23,839
we're looking at more of a vehicle

1035
00:34:21,679 --> 00:34:25,040
agnostic way to create an intrusion

1036
00:34:23,839 --> 00:34:28,239
detection system

1037
00:34:25,040 --> 00:34:30,159
and most ibs research so far has fallen

1038
00:34:28,239 --> 00:34:31,839
into three categories where

1039
00:34:30,159 --> 00:34:34,399
it's either physical so you're looking

1040
00:34:31,839 --> 00:34:34,799
at primarily the voltage or the physical

1041
00:34:34,399 --> 00:34:36,480
layer

1042
00:34:34,800 --> 00:34:38,399
and that kind of has some drawbacks

1043
00:34:36,480 --> 00:34:40,079
because each car can be really finicky

1044
00:34:38,399 --> 00:34:41,839
and further it's a really noisy

1045
00:34:40,079 --> 00:34:44,159
environment from an electromagnetic

1046
00:34:41,839 --> 00:34:45,359
standpoint and so we don't really look

1047
00:34:44,159 --> 00:34:47,919
too much at physical

1048
00:34:45,359 --> 00:34:48,960
so far at the lab we looked at frequency

1049
00:34:47,918 --> 00:34:51,520
and timing based

1050
00:34:48,960 --> 00:34:53,520
and this one really only uses like

1051
00:34:51,520 --> 00:34:55,040
message headers and the frequency that

1052
00:34:53,520 --> 00:34:57,280
each message is set

1053
00:34:55,040 --> 00:34:59,520
and then the next uh kind of field of

1054
00:34:57,280 --> 00:35:01,520
research is the data field inspection so

1055
00:34:59,520 --> 00:35:03,920
that's where we're actually looking at

1056
00:35:01,520 --> 00:35:04,720
the contents of each message and trying

1057
00:35:03,920 --> 00:35:07,599
to determine

1058
00:35:04,720 --> 00:35:09,118
if it's an anomalous or an attack and

1059
00:35:07,599 --> 00:35:09,520
there are two ways to look at this one

1060
00:35:09,119 --> 00:35:13,680
is like

1061
00:35:09,520 --> 00:35:16,160
payload saying um our

1062
00:35:13,680 --> 00:35:18,000
kind of treating each field is just a

1063
00:35:16,160 --> 00:35:19,920
binary blob and then the next is our

1064
00:35:18,000 --> 00:35:22,560
signal based idea where we extract a

1065
00:35:19,920 --> 00:35:24,640
time series of data from the car

1066
00:35:22,560 --> 00:35:25,759
and most research done so far in this

1067
00:35:24,640 --> 00:35:28,720
field has been

1068
00:35:25,760 --> 00:35:30,800
either frequency or payload based but

1069
00:35:28,720 --> 00:35:32,799
our act tool has really allowed us to do

1070
00:35:30,800 --> 00:35:35,359
some signal based research that a lot of

1071
00:35:32,800 --> 00:35:38,240
people haven't haven't been exposed to

1072
00:35:35,359 --> 00:35:39,920
um an idea of the timing based detection

1073
00:35:38,240 --> 00:35:42,399
of automotive cyber attacks is here

1074
00:35:39,920 --> 00:35:44,400
and the idea is that each hand message

1075
00:35:42,400 --> 00:35:46,079
is set at a regular interval

1076
00:35:44,400 --> 00:35:47,680
and so when you do a dumb injection

1077
00:35:46,079 --> 00:35:50,240
attack like you're trying to

1078
00:35:47,680 --> 00:35:51,839
you know turn the turn signal on or off

1079
00:35:50,240 --> 00:35:54,640
that should be able to be detected

1080
00:35:51,839 --> 00:35:57,279
because now you've added extra messages

1081
00:35:54,640 --> 00:35:58,640
into this arbitration id so we really

1082
00:35:57,280 --> 00:36:01,280
simply just look at

1083
00:35:58,640 --> 00:36:01,680
a snapshot of time get some data and

1084
00:36:01,280 --> 00:36:04,960
then

1085
00:36:01,680 --> 00:36:06,879
if the timing of the message is off

1086
00:36:04,960 --> 00:36:08,800
by a certain percentage or a threshold

1087
00:36:06,880 --> 00:36:09,440
then we alert and say that an attack has

1088
00:36:08,800 --> 00:36:11,040
happened

1089
00:36:09,440 --> 00:36:13,200
so this one requires very little

1090
00:36:11,040 --> 00:36:15,359
overhead it's really easy to

1091
00:36:13,200 --> 00:36:17,359
put on a raspberry pi and work but the

1092
00:36:15,359 --> 00:36:18,880
downfall is that

1093
00:36:17,359 --> 00:36:21,598
let's say there's like a poison the well

1094
00:36:18,880 --> 00:36:23,040
attack and messages are being sent at

1095
00:36:21,599 --> 00:36:26,560
the correct interval

1096
00:36:23,040 --> 00:36:29,040
but they're not being like correct

1097
00:36:26,560 --> 00:36:29,040
messages

1098
00:36:29,359 --> 00:36:33,598
so we also look at uh payload base so

1099
00:36:32,000 --> 00:36:35,200
the idea of a payload base is that we

1100
00:36:33,599 --> 00:36:38,880
break each message into

1101
00:36:35,200 --> 00:36:40,879
like uh bits so either zeros or ones and

1102
00:36:38,880 --> 00:36:42,720
we try to determine the probability that

1103
00:36:40,880 --> 00:36:45,359
the next message will

1104
00:36:42,720 --> 00:36:46,799
have a zero or a one and so here's our

1105
00:36:45,359 --> 00:36:49,279
here's a little illustration

1106
00:36:46,800 --> 00:36:50,320
of the predicted data and then an attack

1107
00:36:49,280 --> 00:36:52,240
that had been

1108
00:36:50,320 --> 00:36:54,480
sent to the vehicle and you see that

1109
00:36:52,240 --> 00:36:56,479
like some of the bits i colored in red

1110
00:36:54,480 --> 00:36:57,760
aren't the predicted value and we

1111
00:36:56,480 --> 00:36:59,920
essentially just generate

1112
00:36:57,760 --> 00:37:01,200
some sort of threshold saying if you

1113
00:36:59,920 --> 00:37:03,599
know any number of bits

1114
00:37:01,200 --> 00:37:04,720
are outside of the threshold then an

1115
00:37:03,599 --> 00:37:06,079
attack has happened

1116
00:37:04,720 --> 00:37:08,240
but it's still kind of difficult to

1117
00:37:06,079 --> 00:37:09,119
determine how to glance like whether or

1118
00:37:08,240 --> 00:37:11,680
not there's

1119
00:37:09,119 --> 00:37:13,920
there's been an attack um which leads us

1120
00:37:11,680 --> 00:37:15,680
to our signal based results

1121
00:37:13,920 --> 00:37:18,160
so the idea here is that we can use our

1122
00:37:15,680 --> 00:37:19,520
act pipeline to extract a whole bunch of

1123
00:37:18,160 --> 00:37:21,359
signals from this vehicle

1124
00:37:19,520 --> 00:37:23,759
and even if we can't translate them but

1125
00:37:21,359 --> 00:37:26,640
we can identify that they're signals

1126
00:37:23,760 --> 00:37:27,520
we try to learn what maybe the next

1127
00:37:26,640 --> 00:37:29,200
value will be

1128
00:37:27,520 --> 00:37:31,119
here's a here's an example of like an

1129
00:37:29,200 --> 00:37:31,919
engine rpm attack where we're trying to

1130
00:37:31,119 --> 00:37:34,640
spoof the

1131
00:37:31,920 --> 00:37:36,000
engine rpm you see this one at a glance

1132
00:37:34,640 --> 00:37:38,160
is a lot more obvious

1133
00:37:36,000 --> 00:37:39,359
like on data point eight it drops down

1134
00:37:38,160 --> 00:37:43,279
to zero and then

1135
00:37:39,359 --> 00:37:45,119
you know back up to like 2600 which

1136
00:37:43,280 --> 00:37:47,119
really clearly demonstrates that there's

1137
00:37:45,119 --> 00:37:48,560
been an attack launched on this car

1138
00:37:47,119 --> 00:37:50,000
and so that leads us to believe that our

1139
00:37:48,560 --> 00:37:51,279
signal based approach will be more

1140
00:37:50,000 --> 00:37:54,160
effective but

1141
00:37:51,280 --> 00:37:55,520
we're still in kind of the mid stages of

1142
00:37:54,160 --> 00:37:58,319
this and we need to do a lot more

1143
00:37:55,520 --> 00:38:01,759
testing to really verify that hypothesis

1144
00:37:58,320 --> 00:38:04,640
um so here's a quick demo of

1145
00:38:01,760 --> 00:38:06,560
one of our detection scheme so this is a

1146
00:38:04,640 --> 00:38:08,960
really simple timing based detector that

1147
00:38:06,560 --> 00:38:10,640
will just count the number of messages

1148
00:38:08,960 --> 00:38:12,800
an important thing to think of is we

1149
00:38:10,640 --> 00:38:14,960
need to attack an attack on the car

1150
00:38:12,800 --> 00:38:16,320
before the car physically reacts once

1151
00:38:14,960 --> 00:38:17,440
the car reacts you know there's an

1152
00:38:16,320 --> 00:38:19,359
attack

1153
00:38:17,440 --> 00:38:22,000
so the device up on the top is actually

1154
00:38:19,359 --> 00:38:23,759
the ids that's a raspberry pi

1155
00:38:22,000 --> 00:38:25,920
and then the raspberry pi down on the

1156
00:38:23,760 --> 00:38:27,680
bottom uh underneath the speedometer is

1157
00:38:25,920 --> 00:38:28,320
our attack device it's got a button on

1158
00:38:27,680 --> 00:38:29,839
it

1159
00:38:28,320 --> 00:38:31,520
but when i press the button it's going

1160
00:38:29,839 --> 00:38:32,000
to launch an attack for the car one of

1161
00:38:31,520 --> 00:38:35,280
those dumb

1162
00:38:32,000 --> 00:38:36,000
injection attacks and i want to catch it

1163
00:38:35,280 --> 00:38:38,800
before the car

1164
00:38:36,000 --> 00:38:39,599
physically reacts so we're gonna launch

1165
00:38:38,800 --> 00:38:41,599
the attack

1166
00:38:39,599 --> 00:38:43,040
and then i want to see a red light on

1167
00:38:41,599 --> 00:38:46,640
this ids

1168
00:38:43,040 --> 00:38:47,440
oh perfect red light before the car

1169
00:38:46,640 --> 00:38:49,359
reacts

1170
00:38:47,440 --> 00:38:50,800
so there's not a whole lot of time i

1171
00:38:49,359 --> 00:38:52,960
mean you know the attacks launched and

1172
00:38:50,800 --> 00:38:55,440
the car reacts immediately the engine

1173
00:38:52,960 --> 00:38:57,440
revs up it wants us to stop safely now

1174
00:38:55,440 --> 00:39:00,720
we lose all power on the

1175
00:38:57,440 --> 00:39:01,200
gas pedal we need to be able to detect

1176
00:39:00,720 --> 00:39:04,959
that

1177
00:39:01,200 --> 00:39:06,560
quickly and there's a lot of research

1178
00:39:04,960 --> 00:39:09,119
going into this now so

1179
00:39:06,560 --> 00:39:11,119
uh some of the recent work on this has

1180
00:39:09,119 --> 00:39:13,680
really exploded since say

1181
00:39:11,119 --> 00:39:14,960
2016 but if you're interested in getting

1182
00:39:13,680 --> 00:39:17,279
into this field

1183
00:39:14,960 --> 00:39:18,880
it's it's brand new it's uh it's quite

1184
00:39:17,280 --> 00:39:21,599
exciting to be working on

1185
00:39:18,880 --> 00:39:23,440
some like cutting edge sort of research

1186
00:39:21,599 --> 00:39:24,079
because this is a field that's projected

1187
00:39:23,440 --> 00:39:27,119
to grow

1188
00:39:24,079 --> 00:39:28,320
and continue to grow and with the

1189
00:39:27,119 --> 00:39:30,480
ultimate goal of

1190
00:39:28,320 --> 00:39:32,480
making our vehicles more secure chances

1191
00:39:30,480 --> 00:39:33,440
are honestly you might you probably

1192
00:39:32,480 --> 00:39:37,119
won't get hacked

1193
00:39:33,440 --> 00:39:39,440
yourself um but for someone who may

1194
00:39:37,119 --> 00:39:41,440
manage a large fleet of vehicles or like

1195
00:39:39,440 --> 00:39:43,040
rental cars particularly like rental car

1196
00:39:41,440 --> 00:39:44,079
companies hate when they went to me

1197
00:39:43,040 --> 00:39:48,720
because i

1198
00:39:44,079 --> 00:39:50,800
i miss i mess with all those new cars um

1199
00:39:48,720 --> 00:39:52,560
all right so we're about to wind down

1200
00:39:50,800 --> 00:39:54,079
now and i just want to recap make sure

1201
00:39:52,560 --> 00:39:55,359
we're all on the same page

1202
00:39:54,079 --> 00:39:57,280
so we learned a little bit about

1203
00:39:55,359 --> 00:39:58,000
candidate how to send and receive some

1204
00:39:57,280 --> 00:39:59,520
messages

1205
00:39:58,000 --> 00:40:01,599
how we can use message timing to

1206
00:39:59,520 --> 00:40:02,640
prototype a really basic but effective

1207
00:40:01,599 --> 00:40:04,720
ids

1208
00:40:02,640 --> 00:40:06,400
how the diagnostic service can be used

1209
00:40:04,720 --> 00:40:07,279
to generate some ground truth from our

1210
00:40:06,400 --> 00:40:10,160
vehicles

1211
00:40:07,280 --> 00:40:11,520
and like to reiterate that you should

1212
00:40:10,160 --> 00:40:14,480
not do as i say

1213
00:40:11,520 --> 00:40:15,599
as i do and don't plug anything into

1214
00:40:14,480 --> 00:40:19,040
your car

1215
00:40:15,599 --> 00:40:20,560
at my uh my vision

1216
00:40:19,040 --> 00:40:21,759
um so if you guys are interested in this

1217
00:40:20,560 --> 00:40:22,319
research and want to do some more

1218
00:40:21,760 --> 00:40:23,760
reading

1219
00:40:22,319 --> 00:40:26,400
i'd recommend starting with the car

1220
00:40:23,760 --> 00:40:27,920
hackers handbook it's fantastic and has

1221
00:40:26,400 --> 00:40:30,319
a lot of good resources

1222
00:40:27,920 --> 00:40:33,440
and a lot of good details on like can

1223
00:40:30,319 --> 00:40:34,880
you tills and using diagnostic services

1224
00:40:33,440 --> 00:40:37,760
if you want to get more technical into

1225
00:40:34,880 --> 00:40:39,520
cam the kvaser education on cambus is

1226
00:40:37,760 --> 00:40:40,880
completely free and it goes more into

1227
00:40:39,520 --> 00:40:43,280
like the protocol layer

1228
00:40:40,880 --> 00:40:46,000
and the nuts and bolts of what a cam

1229
00:40:43,280 --> 00:40:47,520
message is and how can network operates

1230
00:40:46,000 --> 00:40:49,599
you want to spend a little bit of money

1231
00:40:47,520 --> 00:40:51,520
to learn about it i really recommend

1232
00:40:49,599 --> 00:40:54,160
the automotive electrics and automotive

1233
00:40:51,520 --> 00:40:56,720
electronics this is like a textbook

1234
00:40:54,160 --> 00:40:58,560
so it costs a little bit of money but

1235
00:40:56,720 --> 00:41:00,640
the information contained there

1236
00:40:58,560 --> 00:41:01,599
is i mean invaluable it goes very

1237
00:41:00,640 --> 00:41:03,359
in-depth

1238
00:41:01,599 --> 00:41:04,960
and of course it's not a good conference

1239
00:41:03,359 --> 00:41:06,319
talk without a shameless plug so if you

1240
00:41:04,960 --> 00:41:08,880
want to learn

1241
00:41:06,319 --> 00:41:10,319
about some of the math that we use to

1242
00:41:08,880 --> 00:41:12,000
create our act pipeline

1243
00:41:10,319 --> 00:41:13,839
then that's available on archive and you

1244
00:41:12,000 --> 00:41:17,119
can like i think just search

1245
00:41:13,839 --> 00:41:18,480
and archive and go rnl for the pop-up

1246
00:41:17,119 --> 00:41:19,920
type

1247
00:41:18,480 --> 00:41:22,560
so if you want to get started with some

1248
00:41:19,920 --> 00:41:25,680
hands-on tools uh i use the kvaser

1249
00:41:22,560 --> 00:41:27,839
can to usb tools um i use one called the

1250
00:41:25,680 --> 00:41:29,279
cave offer leaflight v2 it's a couple

1251
00:41:27,839 --> 00:41:31,359
hundred dollars but

1252
00:41:29,280 --> 00:41:32,319
you can plug it up to your laptop or you

1253
00:41:31,359 --> 00:41:35,040
can run a vm

1254
00:41:32,319 --> 00:41:36,160
and it works fine with linux and it's

1255
00:41:35,040 --> 00:41:37,680
fantastic

1256
00:41:36,160 --> 00:41:39,520
if you want to go to the cheap route you

1257
00:41:37,680 --> 00:41:41,359
notice i mean throughout my talk that we

1258
00:41:39,520 --> 00:41:42,720
use a lot of raspberry pi to do this

1259
00:41:41,359 --> 00:41:44,960
stuff at the lab

1260
00:41:42,720 --> 00:41:47,200
and pretty much any consumer level

1261
00:41:44,960 --> 00:41:49,119
single board computer now can run cam

1262
00:41:47,200 --> 00:41:50,799
with some really cheap add-ons

1263
00:41:49,119 --> 00:41:52,240
if you need some more processing power

1264
00:41:50,800 --> 00:41:54,319
like for some of the

1265
00:41:52,240 --> 00:41:56,160
like more in-depth machine learning

1266
00:41:54,319 --> 00:41:57,920
stuff we do it to

1267
00:41:56,160 --> 00:41:59,920
try and understand like time series

1268
00:41:57,920 --> 00:42:00,640
detection the raspberry pi can't quite

1269
00:41:59,920 --> 00:42:02,720
run that

1270
00:42:00,640 --> 00:42:04,160
we have to use something like an nvidia

1271
00:42:02,720 --> 00:42:07,040
jetson tx2

1272
00:42:04,160 --> 00:42:08,399
that has a couple of hundred dollars um

1273
00:42:07,040 --> 00:42:10,880
but it has onboard cam

1274
00:42:08,400 --> 00:42:11,760
and it works great for processing some

1275
00:42:10,880 --> 00:42:13,040
models and

1276
00:42:11,760 --> 00:42:15,359
of course if you want to you want to

1277
00:42:13,040 --> 00:42:16,240
break the bank and go the professional

1278
00:42:15,359 --> 00:42:18,400
route

1279
00:42:16,240 --> 00:42:19,359
you can get something like vehicle spy

1280
00:42:18,400 --> 00:42:21,599
uh which just

1281
00:42:19,359 --> 00:42:23,279
it's a tool that has a nice gui and it

1282
00:42:21,599 --> 00:42:26,240
supports a bunch of networks

1283
00:42:23,280 --> 00:42:27,760
outside of can so some of the the other

1284
00:42:26,240 --> 00:42:29,040
ones i mentioned at the beginning of the

1285
00:42:27,760 --> 00:42:30,480
talk you can also read

1286
00:42:29,040 --> 00:42:32,480
with vehicle spy but it's quite

1287
00:42:30,480 --> 00:42:34,160
expensive

1288
00:42:32,480 --> 00:42:35,920
and then uh finally i do have a special

1289
00:42:34,160 --> 00:42:38,000
offer for you guys so this might be

1290
00:42:35,920 --> 00:42:40,079
alarm shot i uh i gave this offer

1291
00:42:38,000 --> 00:42:41,920
when i did the code match presentation

1292
00:42:40,079 --> 00:42:44,079
in january and that was like a four hour

1293
00:42:41,920 --> 00:42:45,760
talk where we built tnc devices

1294
00:42:44,079 --> 00:42:47,359
and then walk people through the like

1295
00:42:45,760 --> 00:42:50,319
coding scripts and everything

1296
00:42:47,359 --> 00:42:51,839
but i love my knoxvillians so if you

1297
00:42:50,319 --> 00:42:54,240
want to not spend time

1298
00:42:51,839 --> 00:42:55,200
wasting in your driveway to understand

1299
00:42:54,240 --> 00:42:57,520
some signals

1300
00:42:55,200 --> 00:42:58,240
and you have a car you can generate your

1301
00:42:57,520 --> 00:43:01,040
own data

1302
00:42:58,240 --> 00:43:03,040
meaning like i do love my knoxvillians

1303
00:43:01,040 --> 00:43:04,880
but i can't like help you get started

1304
00:43:03,040 --> 00:43:07,759
from scratch on

1305
00:43:04,880 --> 00:43:09,119
getting diagnostic queries from your car

1306
00:43:07,760 --> 00:43:11,359
if you can collect the data

1307
00:43:09,119 --> 00:43:13,440
augment it with diagnostic queries then

1308
00:43:11,359 --> 00:43:16,560
get into contact with me through email

1309
00:43:13,440 --> 00:43:17,200
or twitter or this board or however you

1310
00:43:16,560 --> 00:43:18,640
can

1311
00:43:17,200 --> 00:43:20,720
and we'll try to coordinate some of the

1312
00:43:18,640 --> 00:43:21,440
analysis so we can run the pipeline on

1313
00:43:20,720 --> 00:43:23,759
your car

1314
00:43:21,440 --> 00:43:24,560
and get you some signals back and maybe

1315
00:43:23,760 --> 00:43:26,800
get us some

1316
00:43:24,560 --> 00:43:28,319
some good samples as well um but i

1317
00:43:26,800 --> 00:43:29,760
appreciate you guys waking up really for

1318
00:43:28,319 --> 00:43:31,040
this first talk today

1319
00:43:29,760 --> 00:43:33,359
and i hope you were able to learn a

1320
00:43:31,040 --> 00:43:34,720
little bit about cars and uh

1321
00:43:33,359 --> 00:43:36,880
maybe you're you're a little bit more

1322
00:43:34,720 --> 00:43:39,919
scared now to take a trip postcode

1323
00:43:36,880 --> 00:43:41,440
thank you okay we do have a few

1324
00:43:39,920 --> 00:43:44,160
questions for you

1325
00:43:41,440 --> 00:43:46,000
first from heather white we have does

1326
00:43:44,160 --> 00:43:48,960
the national transportation research

1327
00:43:46,000 --> 00:43:53,119
center work with the army ngcz

1328
00:43:48,960 --> 00:43:55,440
in ng cv center in detroit

1329
00:43:53,119 --> 00:43:56,319
i we i'm pretty sure we have in the past

1330
00:43:55,440 --> 00:43:58,319
i'm not sure

1331
00:43:56,319 --> 00:44:00,640
to what capacity we still do i was

1332
00:43:58,319 --> 00:44:01,920
actually lucky to be able to visit that

1333
00:44:00,640 --> 00:44:04,078
facility

1334
00:44:01,920 --> 00:44:05,440
uh last year and we talked about doing

1335
00:44:04,079 --> 00:44:07,119
some visits but

1336
00:44:05,440 --> 00:44:08,560
due to the situation right now nothing's

1337
00:44:07,119 --> 00:44:10,240
really panned out but there's a lot that

1338
00:44:08,560 --> 00:44:13,279
goes on at ntrc

1339
00:44:10,240 --> 00:44:17,359
uh outside of vehicle security

1340
00:44:13,280 --> 00:44:20,720
um so it's on telling to be honest

1341
00:44:17,359 --> 00:44:23,119
okay we also have mike who asked

1342
00:44:20,720 --> 00:44:23,839
i heard that at one point in time the

1343
00:44:23,119 --> 00:44:26,319
odb

1344
00:44:23,839 --> 00:44:28,319
port was only active when the car was in

1345
00:44:26,319 --> 00:44:30,640
park was that true

1346
00:44:28,319 --> 00:44:32,240
i'm not sure about that one um i've not

1347
00:44:30,640 --> 00:44:34,480
i've not seen a case where that's

1348
00:44:32,240 --> 00:44:36,160
explicitly true just yet

1349
00:44:34,480 --> 00:44:38,400
but most of the cars that that i've

1350
00:44:36,160 --> 00:44:40,480
worked on for 2015

1351
00:44:38,400 --> 00:44:41,599
are or newer and the biggest thing i've

1352
00:44:40,480 --> 00:44:44,079
seen there is that

1353
00:44:41,599 --> 00:44:45,520
they'll work all the time but a lot of

1354
00:44:44,079 --> 00:44:47,520
them will only respond to

1355
00:44:45,520 --> 00:44:49,040
the diagnostic queries so you don't get

1356
00:44:47,520 --> 00:44:53,599
any sort of

1357
00:44:49,040 --> 00:44:53,599
raw can data to be able to do analysis

1358
00:44:54,160 --> 00:44:59,680
okay david asked have you looked at bmws

1359
00:44:57,920 --> 00:45:01,119
how do their systems compare to other

1360
00:44:59,680 --> 00:45:04,799
manufacturers

1361
00:45:01,119 --> 00:45:07,599
and i'm able to use tools to modify

1362
00:45:04,800 --> 00:45:09,920
i am able to use tools to modify many

1363
00:45:07,599 --> 00:45:12,480
settings in my 2016.

1364
00:45:09,920 --> 00:45:13,440
newer models have aftermarket software

1365
00:45:12,480 --> 00:45:16,880
changes

1366
00:45:13,440 --> 00:45:16,880
that are warranty supported

1367
00:45:17,200 --> 00:45:22,399
so that is actually um one one brand

1368
00:45:20,480 --> 00:45:25,040
that has been elusive for me is i

1369
00:45:22,400 --> 00:45:26,480
i've never plugged into a bmw so i can't

1370
00:45:25,040 --> 00:45:29,279
really answer that

1371
00:45:26,480 --> 00:45:29,680
um but if you're around knoxville kevin

1372
00:45:29,280 --> 00:45:32,640
after

1373
00:45:29,680 --> 00:45:34,240
the covet ends then then let me know and

1374
00:45:32,640 --> 00:45:35,680
i'll i can give it a shot if you want me

1375
00:45:34,240 --> 00:45:37,759
to

1376
00:45:35,680 --> 00:45:39,680
samuel wants to know if you can fudge a

1377
00:45:37,760 --> 00:45:43,599
legit message

1378
00:45:39,680 --> 00:45:46,560
timed eg a timed one you know is coming

1379
00:45:43,599 --> 00:45:48,640
by forcing bits high or low can you not

1380
00:45:46,560 --> 00:45:52,240
bypass any ids

1381
00:45:48,640 --> 00:45:55,118
in a seemingly unfixable way

1382
00:45:52,240 --> 00:45:58,319
so that is a good example of how the

1383
00:45:55,119 --> 00:46:00,319
timing based ids has some flaws

1384
00:45:58,319 --> 00:46:01,440
because the the way the priority works

1385
00:46:00,319 --> 00:46:04,400
on the can

1386
00:46:01,440 --> 00:46:05,520
uh i said the lower arbitration id will

1387
00:46:04,400 --> 00:46:07,920
win

1388
00:46:05,520 --> 00:46:09,200
the priority to speak on the bus um that

1389
00:46:07,920 --> 00:46:10,640
actually works all the way through the

1390
00:46:09,200 --> 00:46:12,399
message so if you have two messages

1391
00:46:10,640 --> 00:46:15,118
queued up at the same time

1392
00:46:12,400 --> 00:46:16,319
a zero will effectively overwrite a one

1393
00:46:15,119 --> 00:46:17,280
and then stop that message from

1394
00:46:16,319 --> 00:46:20,319
broadcasting

1395
00:46:17,280 --> 00:46:22,480
but that can also get kind of messy um

1396
00:46:20,319 --> 00:46:24,560
and that's why some techniques such as

1397
00:46:22,480 --> 00:46:26,480
being able to extract signals and figure

1398
00:46:24,560 --> 00:46:28,480
out the discontinuity between it

1399
00:46:26,480 --> 00:46:31,119
could be really effective in finding

1400
00:46:28,480 --> 00:46:31,119
some attacks

1401
00:46:31,440 --> 00:46:36,480
and lastly we have alex asking have you

1402
00:46:34,319 --> 00:46:39,119
tested any vehicles that can implement

1403
00:46:36,480 --> 00:46:42,880
cam message authentication protocols

1404
00:46:39,119 --> 00:46:46,240
what are your impressions

1405
00:46:42,880 --> 00:46:48,319
um so i'm not sure i'm not sure what

1406
00:46:46,240 --> 00:46:51,118
really constitutes a cam message like

1407
00:46:48,319 --> 00:46:53,040
authentication protocol um we've seen a

1408
00:46:51,119 --> 00:46:56,880
lot of vehicles that will have

1409
00:46:53,040 --> 00:46:59,040
like counters or um maybe some kind of

1410
00:46:56,880 --> 00:47:00,560
bits appended at the end that are some

1411
00:46:59,040 --> 00:47:04,000
kind of identifier

1412
00:47:00,560 --> 00:47:05,359
and in a lot of cases those work but in

1413
00:47:04,000 --> 00:47:08,400
some cases

1414
00:47:05,359 --> 00:47:11,119
uh the vehicle seems to respond in kind

1415
00:47:08,400 --> 00:47:15,040
even though there's not a correct

1416
00:47:11,119 --> 00:47:15,040
counter or not a correct identifier

1417
00:47:17,440 --> 00:47:22,160
all right thank you samuel

