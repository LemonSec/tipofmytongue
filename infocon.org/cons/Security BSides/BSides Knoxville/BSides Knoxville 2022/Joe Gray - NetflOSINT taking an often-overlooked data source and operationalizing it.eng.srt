1
00:00:01,040 --> 00:00:03,360
it is time for our first talk our first

2
00:00:03,360 --> 00:00:06,480
speaker is joe gray he is presenting

3
00:00:06,480 --> 00:00:08,800
net flossant i think i'm supposed to

4
00:00:08,800 --> 00:00:11,120
pronounce it like that taking an often

5
00:00:11,120 --> 00:00:12,719
overlooked data source and

6
00:00:12,719 --> 00:00:16,759
operationalizing it

7
00:00:20,480 --> 00:00:22,640
gripping your pillow

8
00:00:22,640 --> 00:00:25,119
tight

9
00:00:26,480 --> 00:00:27,920
so thanks for coming to the talk we've

10
00:00:27,920 --> 00:00:29,599
already had the mic drop so my job here

11
00:00:29,599 --> 00:00:31,199
is done

12
00:00:31,199 --> 00:00:32,640
so

13
00:00:32,640 --> 00:00:34,000
it's been great

14
00:00:34,000 --> 00:00:34,880
um

15
00:00:34,880 --> 00:00:37,280
all jokes aside uh thanks for coming out

16
00:00:37,280 --> 00:00:39,760
thanks for coming to the first

17
00:00:39,760 --> 00:00:41,920
b-sides back in person

18
00:00:41,920 --> 00:00:44,480
it's so good to actually have people

19
00:00:44,480 --> 00:00:46,000
nearby and not be

20
00:00:46,000 --> 00:00:48,160
communicating via discord and go to

21
00:00:48,160 --> 00:00:50,480
webinar and zoom and

22
00:00:50,480 --> 00:00:52,719
all of those fun things

23
00:00:52,719 --> 00:00:55,280
please have fun and

24
00:00:55,280 --> 00:00:59,039
be safe but safety third of course

25
00:00:59,039 --> 00:01:01,600
that being said welcome to

26
00:01:01,600 --> 00:01:03,440
net flucent

27
00:01:03,440 --> 00:01:06,080
taking an often overlooked data source

28
00:01:06,080 --> 00:01:08,320
and operationalizing it

29
00:01:08,320 --> 00:01:10,640
anyone who knows me knows i like click

30
00:01:10,640 --> 00:01:12,640
bait titles so that's kind of what this

31
00:01:12,640 --> 00:01:14,320
is

32
00:01:14,320 --> 00:01:16,960
and uh we'll get down to the meat and

33
00:01:16,960 --> 00:01:19,439
potatoes of it in a moment so

34
00:01:19,439 --> 00:01:21,600
about me i'm the founder and instructor

35
00:01:21,600 --> 00:01:24,560
for the ascension by day i'm a threat

36
00:01:24,560 --> 00:01:26,000
hunt and intelligence engineer at

37
00:01:26,000 --> 00:01:27,680
mercari

38
00:01:27,680 --> 00:01:29,280
i wrote practical social engineering

39
00:01:29,280 --> 00:01:30,640
which if you're interested i'll be

40
00:01:30,640 --> 00:01:33,119
selling downstairs

41
00:01:33,119 --> 00:01:35,920
once this is done

42
00:01:35,920 --> 00:01:38,159
and i like to compete quite a bit as

43
00:01:38,159 --> 00:01:40,479
well i'm the 2017 derbycon social

44
00:01:40,479 --> 00:01:42,640
engineering capture the flag winner and

45
00:01:42,640 --> 00:01:44,560
a member of the ocean search party

46
00:01:44,560 --> 00:01:47,439
winning teams at defcon 28 and 29.

47
00:01:47,439 --> 00:01:48,159
so

48
00:01:48,159 --> 00:01:50,880
moving into the actual context of the

49
00:01:50,880 --> 00:01:54,479
presentation why this presentation

50
00:01:54,479 --> 00:01:57,520
well when we think network forensics

51
00:01:57,520 --> 00:01:59,600
what immediately comes to mind

52
00:01:59,600 --> 00:02:00,960
i mean

53
00:02:00,960 --> 00:02:03,520
pcapps right pcaps or it didn't happen

54
00:02:03,520 --> 00:02:06,000
that's a very common phrase that we hear

55
00:02:06,000 --> 00:02:09,840
and pcaps are universal truths

56
00:02:09,840 --> 00:02:11,840
but that's what we

57
00:02:11,840 --> 00:02:14,319
normally gravitate to because of the

58
00:02:14,319 --> 00:02:16,959
additional rich context that you get

59
00:02:16,959 --> 00:02:19,200
from a packet capture and i'm not going

60
00:02:19,200 --> 00:02:20,800
to stand up here and dispute the

61
00:02:20,800 --> 00:02:22,400
validity of

62
00:02:22,400 --> 00:02:26,480
a pcap in terms of the importance

63
00:02:26,480 --> 00:02:28,319
or the value

64
00:02:28,319 --> 00:02:29,120
but

65
00:02:29,120 --> 00:02:31,440
it leaves another source

66
00:02:31,440 --> 00:02:34,080
overlooked and that other source is

67
00:02:34,080 --> 00:02:35,599
netflow

68
00:02:35,599 --> 00:02:38,000
and honestly a lot of devices natively

69
00:02:38,000 --> 00:02:39,680
generate netflow

70
00:02:39,680 --> 00:02:40,480
but

71
00:02:40,480 --> 00:02:42,080
you know really

72
00:02:42,080 --> 00:02:44,560
do we do we really even look at it right

73
00:02:44,560 --> 00:02:46,879
it's does it become just another data

74
00:02:46,879 --> 00:02:49,040
source is it just another

75
00:02:49,040 --> 00:02:51,599
log source for us to import into the sim

76
00:02:51,599 --> 00:02:53,200
so that we can

77
00:02:53,200 --> 00:02:54,560
you know make

78
00:02:54,560 --> 00:02:57,120
sim companies that charge by

79
00:02:57,120 --> 00:03:00,319
data in and data out exponentially rich

80
00:03:00,319 --> 00:03:02,159
is is that the case

81
00:03:02,159 --> 00:03:05,519
so within this the agenda for today

82
00:03:05,519 --> 00:03:07,200
we're going to talk about the basis of

83
00:03:07,200 --> 00:03:08,640
network forensics we're going to talk

84
00:03:08,640 --> 00:03:11,280
about what is netflow we'll do a little

85
00:03:11,280 --> 00:03:12,879
bit of a comparison between packet

86
00:03:12,879 --> 00:03:14,640
captures and netflow

87
00:03:14,640 --> 00:03:15,840
and then

88
00:03:15,840 --> 00:03:17,920
i struggle with whether to use the term

89
00:03:17,920 --> 00:03:20,159
extracting

90
00:03:20,159 --> 00:03:24,239
or deducing or inferring

91
00:03:24,239 --> 00:03:27,120
net flow from pcaps

92
00:03:27,120 --> 00:03:29,280
and then we'll talk about analysis and

93
00:03:29,280 --> 00:03:31,519
next steps the next steps that's where

94
00:03:31,519 --> 00:03:34,080
the word osen comes into play so with

95
00:03:34,080 --> 00:03:36,879
this the basis of network forensics we

96
00:03:36,879 --> 00:03:39,280
typically have three main sources and

97
00:03:39,280 --> 00:03:41,680
that would be your logs your packet

98
00:03:41,680 --> 00:03:44,239
captures and netflow

99
00:03:44,239 --> 00:03:47,920
so when we talk about logs by definition

100
00:03:47,920 --> 00:03:49,200
they are

101
00:03:49,200 --> 00:03:52,480
evidence generated chronicling a

102
00:03:52,480 --> 00:03:54,480
sequence of events

103
00:03:54,480 --> 00:03:56,720
from something like say a firewall a

104
00:03:56,720 --> 00:03:58,959
switch a load balancer

105
00:03:58,959 --> 00:04:01,360
but either way it's memorializing that

106
00:04:01,360 --> 00:04:03,360
an event occurred

107
00:04:03,360 --> 00:04:05,840
and yes there are problems with logs

108
00:04:05,840 --> 00:04:09,439
they can be overwritten they can be

109
00:04:09,439 --> 00:04:11,280
somewhat altered depending on who has

110
00:04:11,280 --> 00:04:13,519
access and what capability they have

111
00:04:13,519 --> 00:04:14,799
that would be

112
00:04:14,799 --> 00:04:16,798
fairly sinister

113
00:04:16,798 --> 00:04:18,720
you have problems such as things like

114
00:04:18,720 --> 00:04:20,880
time stomping that can affect the

115
00:04:20,880 --> 00:04:23,440
validity of a log

116
00:04:23,440 --> 00:04:25,840
packet captures it's the collection of

117
00:04:25,840 --> 00:04:27,360
network data

118
00:04:27,360 --> 00:04:30,720
in basically bytes and bits that's going

119
00:04:30,720 --> 00:04:34,240
to allow further analysis reconstruction

120
00:04:34,240 --> 00:04:36,880
extraction and then even going as far as

121
00:04:36,880 --> 00:04:39,680
to say carve files out

122
00:04:39,680 --> 00:04:43,199
if that's what was occurring

123
00:04:43,199 --> 00:04:44,960
and then with that you've got netflow

124
00:04:44,960 --> 00:04:47,759
which is metadata metadata being data

125
00:04:47,759 --> 00:04:51,840
about the data data to explain the data

126
00:04:51,840 --> 00:04:52,880
to say

127
00:04:52,880 --> 00:04:57,440
that besides knoxville is on may 13th of

128
00:04:57,440 --> 00:04:58,720
2020

129
00:04:58,720 --> 00:04:59,520
that

130
00:04:59,520 --> 00:05:02,080
would be a log that memorializes the

131
00:05:02,080 --> 00:05:04,080
event of today

132
00:05:04,080 --> 00:05:07,759
saying that at 906 a.m

133
00:05:07,759 --> 00:05:09,440
the temperature was 66 degrees

134
00:05:09,440 --> 00:05:10,800
fahrenheit that's what i was looking at

135
00:05:10,800 --> 00:05:13,440
with my watch

136
00:05:13,440 --> 00:05:16,479
that is an example also of memorializing

137
00:05:16,479 --> 00:05:19,120
but it's also data about the data it's

138
00:05:19,120 --> 00:05:20,880
data about today

139
00:05:20,880 --> 00:05:24,160
so you could consider that

140
00:05:24,160 --> 00:05:26,400
metadata of sorts

141
00:05:26,400 --> 00:05:29,039
it's still an irrefutable data point

142
00:05:29,039 --> 00:05:29,759
but

143
00:05:29,759 --> 00:05:31,680
it's data about

144
00:05:31,680 --> 00:05:35,360
the data so data about today and please

145
00:05:35,360 --> 00:05:39,560
do not play a drinking game

146
00:05:39,840 --> 00:05:41,600
consuming alcohol for every time i

147
00:05:41,600 --> 00:05:44,639
mentioned the word data

148
00:05:44,960 --> 00:05:47,360
i i will say that

149
00:05:47,360 --> 00:05:49,199
fort sanders and children's hospital are

150
00:05:49,199 --> 00:05:51,120
relatively close we're not far from

151
00:05:51,120 --> 00:05:52,800
university of tennessee but i do not

152
00:05:52,800 --> 00:05:55,440
want to be the cause of a congested

153
00:05:55,440 --> 00:05:58,080
emergency room so please do not play a

154
00:05:58,080 --> 00:05:59,840
drinking game with that

155
00:05:59,840 --> 00:06:03,039
with that though um

156
00:06:03,039 --> 00:06:05,440
you can ascertain a lot of

157
00:06:05,440 --> 00:06:08,160
valuable insight from

158
00:06:08,160 --> 00:06:11,600
this netflow from two perspectives the

159
00:06:11,600 --> 00:06:12,960
the east-west which would be your

160
00:06:12,960 --> 00:06:14,960
lateral movement communications between

161
00:06:14,960 --> 00:06:18,319
two internal hosts or your north south

162
00:06:18,319 --> 00:06:20,160
which would be internal to external or

163
00:06:20,160 --> 00:06:21,759
vice versa

164
00:06:21,759 --> 00:06:24,160
so as we look at this here are some of

165
00:06:24,160 --> 00:06:25,759
the pros and cons and i've kind of

166
00:06:25,759 --> 00:06:28,080
already touched on some of this

167
00:06:28,080 --> 00:06:30,240
logs are great and they are considered

168
00:06:30,240 --> 00:06:32,400
universal truths

169
00:06:32,400 --> 00:06:35,360
until they aren't until they are stomped

170
00:06:35,360 --> 00:06:37,680
uh until they are altered until they are

171
00:06:37,680 --> 00:06:40,720
corrupted until they are deleted and

172
00:06:40,720 --> 00:06:42,479
you know oftentimes

173
00:06:42,479 --> 00:06:44,319
uh anyone in here working and consulting

174
00:06:44,319 --> 00:06:46,400
how many times have you went into a

175
00:06:46,400 --> 00:06:48,960
present or into a

176
00:06:48,960 --> 00:06:51,280
consulting engagement only to find out

177
00:06:51,280 --> 00:06:53,919
that logging is not properly configured

178
00:06:53,919 --> 00:06:55,360
and if you do incident response i'm

179
00:06:55,360 --> 00:06:56,639
going to say that you're probably going

180
00:06:56,639 --> 00:06:58,639
to say that you see that more often than

181
00:06:58,639 --> 00:07:01,039
if you do pin testing

182
00:07:01,039 --> 00:07:03,280
right because unless someone is

183
00:07:03,280 --> 00:07:05,759
directing and this is something that

184
00:07:05,759 --> 00:07:08,400
through my time doing uh full-time for

185
00:07:08,400 --> 00:07:10,960
about the last five years that i've

186
00:07:10,960 --> 00:07:12,080
learned

187
00:07:12,080 --> 00:07:14,639
if there's not an explicit directive to

188
00:07:14,639 --> 00:07:18,000
say thou shalt do this this particular

189
00:07:18,000 --> 00:07:19,360
way

190
00:07:19,360 --> 00:07:20,400
they

191
00:07:20,400 --> 00:07:22,960
it typically is not even i wouldn't even

192
00:07:22,960 --> 00:07:25,280
say minimum viable product

193
00:07:25,280 --> 00:07:28,000
not even minimum viable security right

194
00:07:28,000 --> 00:07:30,800
if you want an example of that look at

195
00:07:30,800 --> 00:07:33,360
the dmarc records for any given

196
00:07:33,360 --> 00:07:35,120
organization unless they're operating in

197
00:07:35,120 --> 00:07:37,520
the federal government which is uh

198
00:07:37,520 --> 00:07:39,120
covered by department of homeland

199
00:07:39,120 --> 00:07:40,639
security binding operating directive

200
00:07:40,639 --> 00:07:42,000
1801

201
00:07:42,000 --> 00:07:44,639
um which basically says you must have

202
00:07:44,639 --> 00:07:47,759
dmarc and it must be set to reject

203
00:07:47,759 --> 00:07:49,199
go look at dmarc records you're going to

204
00:07:49,199 --> 00:07:51,199
see so many that have a policy set to

205
00:07:51,199 --> 00:07:52,800
none

206
00:07:52,800 --> 00:07:54,720
i can guarantee you

207
00:07:54,720 --> 00:07:58,160
that more than likely the reason that it

208
00:07:58,160 --> 00:08:00,960
is set that way is because someone said

209
00:08:00,960 --> 00:08:02,479
you have to be compliant with this

210
00:08:02,479 --> 00:08:03,919
framework and this framework says you

211
00:08:03,919 --> 00:08:05,919
have to have a dmarc record it does

212
00:08:05,919 --> 00:08:08,000
doesn't say you have to be in

213
00:08:08,000 --> 00:08:09,919
uh quarantine or reject it just says you

214
00:08:09,919 --> 00:08:11,520
have to have a record so therefore

215
00:08:11,520 --> 00:08:14,240
you're checking the box and we and

216
00:08:14,240 --> 00:08:16,240
but it accomplishes nothing

217
00:08:16,240 --> 00:08:17,280
right

218
00:08:17,280 --> 00:08:19,840
logging is really no different because

219
00:08:19,840 --> 00:08:22,639
the thing about logging is you have a

220
00:08:22,639 --> 00:08:24,000
coefficient

221
00:08:24,000 --> 00:08:25,199
of

222
00:08:25,199 --> 00:08:29,039
storage time and security that you also

223
00:08:29,039 --> 00:08:31,280
have to maintain with that when i'm

224
00:08:31,280 --> 00:08:32,958
giving ocean training and i'm talking to

225
00:08:32,958 --> 00:08:34,399
people who are just coming up through

226
00:08:34,399 --> 00:08:36,000
the ranks in ocean i have the

227
00:08:36,000 --> 00:08:38,159
conversation quite frequently of if you

228
00:08:38,159 --> 00:08:40,719
collect it you are obligated to secure

229
00:08:40,719 --> 00:08:42,880
it if you collect it you've got to store

230
00:08:42,880 --> 00:08:44,159
it

231
00:08:44,159 --> 00:08:45,519
it doesn't matter

232
00:08:45,519 --> 00:08:47,440
where you're storing it

233
00:08:47,440 --> 00:08:48,560
you're going to have to pay for that

234
00:08:48,560 --> 00:08:50,480
storage in some way shape or form

235
00:08:50,480 --> 00:08:51,600
eventually

236
00:08:51,600 --> 00:08:53,440
that five terabyte external hard drive

237
00:08:53,440 --> 00:08:55,519
that you have it's going to fill up

238
00:08:55,519 --> 00:08:57,600
eventually you're going to have to pay

239
00:08:57,600 --> 00:08:59,279
your monthly

240
00:08:59,279 --> 00:09:01,519
cloud storage bill it's going to cost

241
00:09:01,519 --> 00:09:03,040
money and then with that you've got to

242
00:09:03,040 --> 00:09:05,200
secure it so that's another

243
00:09:05,200 --> 00:09:06,880
i wouldn't say pro and i wouldn't say

244
00:09:06,880 --> 00:09:09,120
con but it's a blessing and a curse a

245
00:09:09,120 --> 00:09:11,440
pro and a con if you will

246
00:09:11,440 --> 00:09:13,680
as it relates to logging you also have

247
00:09:13,680 --> 00:09:15,920
things like deletion time stomping and

248
00:09:15,920 --> 00:09:17,760
honestly they vary in file size

249
00:09:17,760 --> 00:09:18,880
depending on the size of your

250
00:09:18,880 --> 00:09:20,880
architecture

251
00:09:20,880 --> 00:09:22,720
you may have exceptionally small log

252
00:09:22,720 --> 00:09:25,120
files or you may have tremendous log

253
00:09:25,120 --> 00:09:26,320
files

254
00:09:26,320 --> 00:09:27,120
so

255
00:09:27,120 --> 00:09:29,519
keep that in mind with packet captures

256
00:09:29,519 --> 00:09:31,680
they are excellent and they are also

257
00:09:31,680 --> 00:09:34,399
considered universal truths but they are

258
00:09:34,399 --> 00:09:36,720
somewhat short-sighted at times due to

259
00:09:36,720 --> 00:09:38,080
things like

260
00:09:38,080 --> 00:09:40,399
encrypted protocols if you don't have

261
00:09:40,399 --> 00:09:41,440
the key

262
00:09:41,440 --> 00:09:43,920
to be able to decrypt encrypted

263
00:09:43,920 --> 00:09:45,440
communications

264
00:09:45,440 --> 00:09:47,440
it's useless right you can see the

265
00:09:47,440 --> 00:09:49,279
traffic occurred you can see oh well

266
00:09:49,279 --> 00:09:51,920
this client was connected to a vpn

267
00:09:51,920 --> 00:09:53,920
but you can't see what was going on in

268
00:09:53,920 --> 00:09:55,920
the vpn right

269
00:09:55,920 --> 00:09:57,360
and

270
00:09:57,360 --> 00:09:58,640
does that really is that really going to

271
00:09:58,640 --> 00:10:00,000
help you

272
00:10:00,000 --> 00:10:02,959
the big con i would say really with

273
00:10:02,959 --> 00:10:05,519
packet captures would be the file size

274
00:10:05,519 --> 00:10:08,000
because if you're transferring a four

275
00:10:08,000 --> 00:10:09,839
terabyte file

276
00:10:09,839 --> 00:10:11,279
guess how big your packet capture is

277
00:10:11,279 --> 00:10:13,680
going to be

278
00:10:13,839 --> 00:10:15,600
at least that size

279
00:10:15,600 --> 00:10:17,279
so it's

280
00:10:17,279 --> 00:10:20,560
cumbersome to store and secure something

281
00:10:20,560 --> 00:10:22,720
of that size

282
00:10:22,720 --> 00:10:25,360
and honestly using wireshark it's kind

283
00:10:25,360 --> 00:10:27,279
of difficult to

284
00:10:27,279 --> 00:10:30,240
natively do statistic analysis you can

285
00:10:30,240 --> 00:10:32,000
do a lot of analysis i am not going to

286
00:10:32,000 --> 00:10:34,640
tell you that wireshark is not worth its

287
00:10:34,640 --> 00:10:36,959
weight in gold and in fact i'll actually

288
00:10:36,959 --> 00:10:38,560
say it's probably worth my weight in

289
00:10:38,560 --> 00:10:40,560
gold uh since software really doesn't

290
00:10:40,560 --> 00:10:41,839
weigh anything

291
00:10:41,839 --> 00:10:42,720
right

292
00:10:42,720 --> 00:10:44,880
but that being said

293
00:10:44,880 --> 00:10:47,120
you can't see the complete picture

294
00:10:47,120 --> 00:10:49,200
so that leads us to

295
00:10:49,200 --> 00:10:51,120
netflow so

296
00:10:51,120 --> 00:10:53,279
it's often not used because the

297
00:10:53,279 --> 00:10:55,279
philosophy is we've got logs we've got

298
00:10:55,279 --> 00:10:57,279
pcaps why do we need this

299
00:10:57,279 --> 00:10:58,839
right

300
00:10:58,839 --> 00:11:01,920
but it's often

301
00:11:01,920 --> 00:11:04,640
comparable in size to log files

302
00:11:04,640 --> 00:11:06,000
sometimes a little bit bigger sometimes

303
00:11:06,000 --> 00:11:07,839
a little bit smaller but it's definitely

304
00:11:07,839 --> 00:11:10,399
not the size of a packet capture you do

305
00:11:10,399 --> 00:11:12,000
have less visibility i'm going to put

306
00:11:12,000 --> 00:11:13,519
that out there for you right now you

307
00:11:13,519 --> 00:11:17,120
have less visibility but it is easy to

308
00:11:17,120 --> 00:11:19,519
analyze and perform that statistic

309
00:11:19,519 --> 00:11:20,880
analysis

310
00:11:20,880 --> 00:11:23,839
so in talking about netflow

311
00:11:23,839 --> 00:11:25,839
we'll hit a brief history and then talk

312
00:11:25,839 --> 00:11:29,040
about netflow versus ipfix so basically

313
00:11:29,040 --> 00:11:32,000
it was introduced in 1996 by cisco to

314
00:11:32,000 --> 00:11:34,160
collect traffic as it traverses an

315
00:11:34,160 --> 00:11:36,320
interface

316
00:11:36,320 --> 00:11:38,160
as with many other things

317
00:11:38,160 --> 00:11:40,320
it was designed with the purpose of

318
00:11:40,320 --> 00:11:41,519
troubleshooting

319
00:11:41,519 --> 00:11:45,040
it's still used for troubleshooting

320
00:11:45,040 --> 00:11:46,800
but i mean look at how many other things

321
00:11:46,800 --> 00:11:49,200
that we use in a security context that

322
00:11:49,200 --> 00:11:52,079
was made for troubleshooting

323
00:11:52,079 --> 00:11:54,560
for all you pin testers here i mean

324
00:11:54,560 --> 00:11:57,360
factor in that ps exec

325
00:11:57,360 --> 00:11:59,519
if you're living off the land

326
00:11:59,519 --> 00:12:00,399
was

327
00:12:00,399 --> 00:12:02,399
created for

328
00:12:02,399 --> 00:12:04,480
troubleshooting and remote system

329
00:12:04,480 --> 00:12:06,800
administration so

330
00:12:06,800 --> 00:12:09,680
it's the use in the abuse case scenario

331
00:12:09,680 --> 00:12:10,959
but with that

332
00:12:10,959 --> 00:12:12,720
within netflow it requires three

333
00:12:12,720 --> 00:12:14,320
components

334
00:12:14,320 --> 00:12:17,519
the exporter the collector and storage

335
00:12:17,519 --> 00:12:18,480
so

336
00:12:18,480 --> 00:12:20,480
that's the three elements that you need

337
00:12:20,480 --> 00:12:23,200
it's not going to affect your files but

338
00:12:23,200 --> 00:12:25,440
if you're going to set up quote

339
00:12:25,440 --> 00:12:27,920
proper netflow within your architecture

340
00:12:27,920 --> 00:12:30,000
that's what you're going to need

341
00:12:30,000 --> 00:12:30,800
so

342
00:12:30,800 --> 00:12:32,880
a device to export it a device to

343
00:12:32,880 --> 00:12:34,160
collect it

344
00:12:34,160 --> 00:12:36,240
possibly your sim and then of course

345
00:12:36,240 --> 00:12:38,959
some place to store it comparing netflow

346
00:12:38,959 --> 00:12:40,720
to ipfix

347
00:12:40,720 --> 00:12:43,279
we have several versions of netflow

348
00:12:43,279 --> 00:12:46,720
version 5 is probably the most common

349
00:12:46,720 --> 00:12:48,399
through my research i found that version

350
00:12:48,399 --> 00:12:50,639
9 is probably the second most common

351
00:12:50,639 --> 00:12:52,320
basically the thing that varies between

352
00:12:52,320 --> 00:12:55,440
it would be the names of the fields and

353
00:12:55,440 --> 00:12:57,440
some have more fields than others so you

354
00:12:57,440 --> 00:12:58,959
have other

355
00:12:58,959 --> 00:13:01,600
potentials for

356
00:13:01,600 --> 00:13:03,760
analysis with that

357
00:13:03,760 --> 00:13:06,320
technically ipfix has nothing to do with

358
00:13:06,320 --> 00:13:07,440
netflow

359
00:13:07,440 --> 00:13:09,040
um but

360
00:13:09,040 --> 00:13:10,000
it

361
00:13:10,000 --> 00:13:12,320
at the same time is also technically

362
00:13:12,320 --> 00:13:14,880
called netflow version 10. so

363
00:13:14,880 --> 00:13:16,079
one of those

364
00:13:16,079 --> 00:13:17,200
weird

365
00:13:17,200 --> 00:13:20,320
kind of legacy things right

366
00:13:20,320 --> 00:13:22,399
so with that here are your standard

367
00:13:22,399 --> 00:13:24,959
fields for netflow pretty much

368
00:13:24,959 --> 00:13:27,200
universally across the board

369
00:13:27,200 --> 00:13:29,839
if you've played with packet captures

370
00:13:29,839 --> 00:13:32,480
these probably look familiar to you so

371
00:13:32,480 --> 00:13:33,519
time

372
00:13:33,519 --> 00:13:35,440
source and destination

373
00:13:35,440 --> 00:13:36,720
ip

374
00:13:36,720 --> 00:13:38,000
and port

375
00:13:38,000 --> 00:13:40,320
it could be your ip protocol your type

376
00:13:40,320 --> 00:13:41,519
of service

377
00:13:41,519 --> 00:13:44,160
you could see it as bytes or packets or

378
00:13:44,160 --> 00:13:46,959
octets sent and received

379
00:13:46,959 --> 00:13:51,279
so as we look at this

380
00:13:52,720 --> 00:13:55,760
this is going back into what is netflow

381
00:13:55,760 --> 00:13:57,120
but this is to kind of help us

382
00:13:57,120 --> 00:13:59,040
understand it a little bit more

383
00:13:59,040 --> 00:14:01,199
factor in

384
00:14:01,199 --> 00:14:02,639
think of it this way

385
00:14:02,639 --> 00:14:05,519
netflow is like kleenex

386
00:14:05,519 --> 00:14:06,959
or q-tip

387
00:14:06,959 --> 00:14:08,959
or google

388
00:14:08,959 --> 00:14:11,040
we have facial tissues we have cotton

389
00:14:11,040 --> 00:14:13,600
swabs and we have search engines

390
00:14:13,600 --> 00:14:14,800
but

391
00:14:14,800 --> 00:14:16,560
the fact that i was on a sales call

392
00:14:16,560 --> 00:14:18,480
about 10 years ago with someone trying

393
00:14:18,480 --> 00:14:20,880
to sell a search appliance and they

394
00:14:20,880 --> 00:14:22,399
were a competitor to google and they

395
00:14:22,399 --> 00:14:24,480
used google as a verb

396
00:14:24,480 --> 00:14:27,839
when discussing their own product

397
00:14:27,839 --> 00:14:29,680
it's kind of the same thing with netflow

398
00:14:29,680 --> 00:14:30,560
right

399
00:14:30,560 --> 00:14:33,040
you have netflow you have ipfix at the

400
00:14:33,040 --> 00:14:34,639
end of the day kind of think of it like

401
00:14:34,639 --> 00:14:36,320
a hammer if you're a hammer everything's

402
00:14:36,320 --> 00:14:37,440
a nail

403
00:14:37,440 --> 00:14:39,279
so if you're doing this everything's in

404
00:14:39,279 --> 00:14:40,480
netflow

405
00:14:40,480 --> 00:14:42,000
you can you can get into the weeds if

406
00:14:42,000 --> 00:14:42,880
you're talking to the network

407
00:14:42,880 --> 00:14:46,480
administrators network engineers

408
00:14:46,560 --> 00:14:48,000
they're probably

409
00:14:48,000 --> 00:14:50,000
more apt than many to get been out of

410
00:14:50,000 --> 00:14:51,440
shape about whether it's netflow or

411
00:14:51,440 --> 00:14:53,279
ipfix but

412
00:14:53,279 --> 00:14:55,519
it's it's a semantics thing

413
00:14:55,519 --> 00:14:58,880
so with that you've got some rfcs to

414
00:14:58,880 --> 00:15:01,279
discuss it but you know

415
00:15:01,279 --> 00:15:03,360
this is early in the morning but and

416
00:15:03,360 --> 00:15:04,959
normally i would not be awake this early

417
00:15:04,959 --> 00:15:07,199
my work day normally starts at 11 but

418
00:15:07,199 --> 00:15:08,959
i'm not going to bore you with rfcs to

419
00:15:08,959 --> 00:15:11,360
put you to sleep this early

420
00:15:11,360 --> 00:15:13,600
that would be more of a

421
00:15:13,600 --> 00:15:17,360
appropriate for closing closing time

422
00:15:17,360 --> 00:15:20,959
so comparing pcaps and netflow

423
00:15:20,959 --> 00:15:21,839
right

424
00:15:21,839 --> 00:15:23,839
netflow it's going to abbreviate the

425
00:15:23,839 --> 00:15:28,480
story it is the tldr it is the macro

426
00:15:28,480 --> 00:15:30,880
perspective of

427
00:15:30,880 --> 00:15:32,160
the story

428
00:15:32,160 --> 00:15:33,680
you're going to have your smaller file

429
00:15:33,680 --> 00:15:35,839
sizes meaning it's you're going to be

430
00:15:35,839 --> 00:15:38,399
able to store more and it's going to be

431
00:15:38,399 --> 00:15:40,639
easier to traverse around and allow

432
00:15:40,639 --> 00:15:42,800
others to gain access to it

433
00:15:42,800 --> 00:15:44,399
and honestly it's

434
00:15:44,399 --> 00:15:46,639
fairly easy to import into pretty much

435
00:15:46,639 --> 00:15:48,240
any sim

436
00:15:48,240 --> 00:15:51,680
and honestly also in csv format so with

437
00:15:51,680 --> 00:15:53,680
csv format the beautiful thing with that

438
00:15:53,680 --> 00:15:54,639
is

439
00:15:54,639 --> 00:15:56,160
oh well i'm just doing independent

440
00:15:56,160 --> 00:15:58,800
research i don't have a sim i don't have

441
00:15:58,800 --> 00:16:00,800
the ability to stand up something like

442
00:16:00,800 --> 00:16:02,320
elk or

443
00:16:02,320 --> 00:16:05,839
uh alien vault osim or graylog how do i

444
00:16:05,839 --> 00:16:08,399
do this it's like it's a csv do you have

445
00:16:08,399 --> 00:16:11,519
excel or do you have

446
00:16:11,519 --> 00:16:14,959
python pandas do you have openoffice

447
00:16:14,959 --> 00:16:16,160
there's a lot of ways that you can

448
00:16:16,160 --> 00:16:19,120
analyze it which is good but it doesn't

449
00:16:19,120 --> 00:16:22,399
include the packet contents even if we

450
00:16:22,399 --> 00:16:25,440
have a stream of connection over http

451
00:16:25,440 --> 00:16:28,000
and you transfer a file just a text file

452
00:16:28,000 --> 00:16:29,920
that says hello world

453
00:16:29,920 --> 00:16:32,160
with a packet capture you could carve

454
00:16:32,160 --> 00:16:33,199
that out

455
00:16:33,199 --> 00:16:35,440
with a net flow you're not going to be

456
00:16:35,440 --> 00:16:36,560
able to

457
00:16:36,560 --> 00:16:37,360
but

458
00:16:37,360 --> 00:16:39,680
at the end of the day it's valuable

459
00:16:39,680 --> 00:16:40,880
moving to

460
00:16:40,880 --> 00:16:43,759
packet captures

461
00:16:43,839 --> 00:16:46,720
it tells the whole story

462
00:16:46,720 --> 00:16:48,720
it is the

463
00:16:48,720 --> 00:16:50,560
token version

464
00:16:50,560 --> 00:16:53,040
of the story you're gonna have 30 pages

465
00:16:53,040 --> 00:16:56,880
describing what the trees smelled like

466
00:16:56,880 --> 00:17:00,160
you're going to have 19 hours of movies

467
00:17:00,160 --> 00:17:02,079
walking around

468
00:17:02,079 --> 00:17:04,880
i'm not a big lord of the rings fan

469
00:17:04,880 --> 00:17:06,720
but either way

470
00:17:06,720 --> 00:17:08,799
it's going to tell the whole story it's

471
00:17:08,799 --> 00:17:10,799
not going to be the cliff notes that you

472
00:17:10,799 --> 00:17:14,640
read three days before your ap english 4

473
00:17:14,640 --> 00:17:19,000
exam about lord of the rings

474
00:17:19,760 --> 00:17:23,439
the cliff notes or netflow will tell you

475
00:17:23,439 --> 00:17:25,199
that there were trees

476
00:17:25,199 --> 00:17:27,039
and it may tell you that the trees had a

477
00:17:27,039 --> 00:17:28,640
scent

478
00:17:28,640 --> 00:17:29,760
but

479
00:17:29,760 --> 00:17:31,520
if you want to know the whole story

480
00:17:31,520 --> 00:17:32,799
you've got to go the other route and

481
00:17:32,799 --> 00:17:35,280
that's basically packet captures

482
00:17:35,280 --> 00:17:37,840
so with that as i said earlier

483
00:17:37,840 --> 00:17:39,760
there is the philosophy that's prevalent

484
00:17:39,760 --> 00:17:41,679
across industry if p caps or it didn't

485
00:17:41,679 --> 00:17:43,679
happen

486
00:17:43,679 --> 00:17:46,799
i can't disagree with that

487
00:17:46,799 --> 00:17:48,559
and with that

488
00:17:48,559 --> 00:17:50,400
it also allows things like stream

489
00:17:50,400 --> 00:17:52,320
filtering so you can hone in on a

490
00:17:52,320 --> 00:17:54,000
particular line of conversation between

491
00:17:54,000 --> 00:17:57,440
two hosts and it also allows carving

492
00:17:57,440 --> 00:17:59,840
but again you have that larger file size

493
00:17:59,840 --> 00:18:02,640
and it's also

494
00:18:02,640 --> 00:18:05,120
valuable which is good because that's

495
00:18:05,120 --> 00:18:06,480
what we're trying to do we're trying to

496
00:18:06,480 --> 00:18:08,320
bring value right

497
00:18:08,320 --> 00:18:09,039
so

498
00:18:09,039 --> 00:18:10,799
continuing with this we're going to talk

499
00:18:10,799 --> 00:18:13,120
about how we would go about

500
00:18:13,120 --> 00:18:15,360
extracting or

501
00:18:15,360 --> 00:18:18,400
i like the term inferring

502
00:18:18,400 --> 00:18:19,919
i stuck with

503
00:18:19,919 --> 00:18:22,880
extracting in the presentation but

504
00:18:22,880 --> 00:18:25,760
it's not truly extracting as much as it

505
00:18:25,760 --> 00:18:26,840
more is

506
00:18:26,840 --> 00:18:30,480
inferring um the net flow from pcaps so

507
00:18:30,480 --> 00:18:32,400
if you come across a packet capture and

508
00:18:32,400 --> 00:18:33,520
you don't

509
00:18:33,520 --> 00:18:36,160
have access to a net flow interface or

510
00:18:36,160 --> 00:18:37,600
you know you're just

511
00:18:37,600 --> 00:18:39,760
you're doing some google foo and you do

512
00:18:39,760 --> 00:18:42,160
a google door for something with file

513
00:18:42,160 --> 00:18:43,840
type pcapp and you come across it and

514
00:18:43,840 --> 00:18:44,640
you're like

515
00:18:44,640 --> 00:18:46,080
hey you know i might want to actually

516
00:18:46,080 --> 00:18:49,120
analyze this as if it's netflow

517
00:18:49,120 --> 00:18:50,640
so you wouldn't have access to the

518
00:18:50,640 --> 00:18:52,799
interface that captured it so

519
00:18:52,799 --> 00:18:54,320
how would you come across it well i've

520
00:18:54,320 --> 00:18:55,440
got some tools and scripts that i'm

521
00:18:55,440 --> 00:18:58,080
going to hook you up with

522
00:18:58,080 --> 00:19:00,400
so what we'll need for this

523
00:19:00,400 --> 00:19:02,720
basically you need your packet capture

524
00:19:02,720 --> 00:19:05,120
if you want packet captures to use for

525
00:19:05,120 --> 00:19:06,400
this

526
00:19:06,400 --> 00:19:08,880
the one that i'm going to use in the

527
00:19:08,880 --> 00:19:11,600
admittedly pre-recorded demonstration

528
00:19:11,600 --> 00:19:14,000
came from active countermeasures

529
00:19:14,000 --> 00:19:15,520
they have a thing on their website

530
00:19:15,520 --> 00:19:17,679
called malware of the day

531
00:19:17,679 --> 00:19:19,760
and with it basically it's to help you

532
00:19:19,760 --> 00:19:21,520
get used to doing

533
00:19:21,520 --> 00:19:23,520
various types of

534
00:19:23,520 --> 00:19:26,960
analysis or hunt type activities so with

535
00:19:26,960 --> 00:19:29,039
that you can download those p caps and

536
00:19:29,039 --> 00:19:30,880
run them through the tool test them that

537
00:19:30,880 --> 00:19:34,000
way if you're doing any ctfs like in the

538
00:19:34,000 --> 00:19:36,080
intelligence village there are no packet

539
00:19:36,080 --> 00:19:39,600
captures today so sorry you can't test

540
00:19:39,600 --> 00:19:40,640
it there

541
00:19:40,640 --> 00:19:42,559
but anywhere you have a packet capture

542
00:19:42,559 --> 00:19:44,559
you can do this

543
00:19:44,559 --> 00:19:49,120
you'll need a linux host with silk

544
00:19:49,120 --> 00:19:53,280
if you use the sans soft elk system i

545
00:19:53,280 --> 00:19:55,600
believe it is native there

546
00:19:55,600 --> 00:19:57,760
you it may also be native on just

547
00:19:57,760 --> 00:20:01,679
regular sift i'm not 100 certain on that

548
00:20:01,679 --> 00:20:03,919
but you can just install silk wherever

549
00:20:03,919 --> 00:20:05,679
as well

550
00:20:05,679 --> 00:20:07,679
optionally for analysis you could use

551
00:20:07,679 --> 00:20:10,960
excel openoffice any of the above

552
00:20:10,960 --> 00:20:14,000
you could also use something like elk in

553
00:20:14,000 --> 00:20:15,679
the pre-recorded

554
00:20:15,679 --> 00:20:19,039
demo piece i actually have elk

555
00:20:19,039 --> 00:20:20,480
uh as part of that

556
00:20:20,480 --> 00:20:22,240
and then also

557
00:20:22,240 --> 00:20:25,039
you've got jupiter notebook with pandas

558
00:20:25,039 --> 00:20:27,360
and unfortunately that was the one thing

559
00:20:27,360 --> 00:20:29,120
that was going to be a live demo today

560
00:20:29,120 --> 00:20:32,320
and wouldn't you know i ran an update

561
00:20:32,320 --> 00:20:35,039
and it fell and went boom

562
00:20:35,039 --> 00:20:37,280
wouldn't you know

563
00:20:37,280 --> 00:20:38,080
so

564
00:20:38,080 --> 00:20:40,240
uh but with that i mean

565
00:20:40,240 --> 00:20:42,799
we can still talk through it so

566
00:20:42,799 --> 00:20:44,640
to do this basically

567
00:20:44,640 --> 00:20:47,679
here's the script for it um if anyone

568
00:20:47,679 --> 00:20:50,000
wants it i'll share my contact info at

569
00:20:50,000 --> 00:20:52,000
the very end and you can just either

570
00:20:52,000 --> 00:20:54,080
stop by the intel village or shoot me a

571
00:20:54,080 --> 00:20:55,600
message on twitter or linkedin or

572
00:20:55,600 --> 00:20:57,440
whatever i'll give you these commands no

573
00:20:57,440 --> 00:20:58,799
big deal

574
00:20:58,799 --> 00:21:01,200
but basically within silk you're using

575
00:21:01,200 --> 00:21:03,840
rwp to flow

576
00:21:03,840 --> 00:21:05,760
and then the path to the actual pcap and

577
00:21:05,760 --> 00:21:08,640
then you have to give it an output path

578
00:21:08,640 --> 00:21:12,080
that's going to create a file type of rw

579
00:21:12,080 --> 00:21:14,559
from there you run the next script which

580
00:21:14,559 --> 00:21:16,400
would be rw cut

581
00:21:16,400 --> 00:21:18,720
set the delimiter to a comma

582
00:21:18,720 --> 00:21:21,039
so you can have a comma separated value

583
00:21:21,039 --> 00:21:23,520
csv

584
00:21:23,520 --> 00:21:25,280
you choose your timestamp format in this

585
00:21:25,280 --> 00:21:26,080
case

586
00:21:26,080 --> 00:21:28,080
i'm going with iso

587
00:21:28,080 --> 00:21:29,840
and then your output path that's going

588
00:21:29,840 --> 00:21:30,880
to be

589
00:21:30,880 --> 00:21:33,520
the name of your csv file that you're

590
00:21:33,520 --> 00:21:35,360
going to create and then

591
00:21:35,360 --> 00:21:36,320
your

592
00:21:36,320 --> 00:21:38,400
uh rw file

593
00:21:38,400 --> 00:21:41,200
and then once you're done with that

594
00:21:41,200 --> 00:21:43,760
now you have a csv that you can analyze

595
00:21:43,760 --> 00:21:46,480
using any of the above

596
00:21:46,480 --> 00:21:47,919
so

597
00:21:47,919 --> 00:21:48,799
and

598
00:21:48,799 --> 00:21:51,200
i accidentally duplicated that

599
00:21:51,200 --> 00:21:52,799
so now

600
00:21:52,799 --> 00:21:55,760
we are up at the demonstration piece so

601
00:21:55,760 --> 00:21:56,720
let me

602
00:21:56,720 --> 00:21:59,840
shift my displays momentarily

603
00:21:59,840 --> 00:22:02,240
and we'll start here so

604
00:22:02,240 --> 00:22:03,919
this is

605
00:22:03,919 --> 00:22:05,840
uh basically

606
00:22:05,840 --> 00:22:07,520
an instance of

607
00:22:07,520 --> 00:22:10,559
silk so i stood up a custom host with

608
00:22:10,559 --> 00:22:13,840
this this dfir techniques host this was

609
00:22:13,840 --> 00:22:15,200
basically

610
00:22:15,200 --> 00:22:17,120
during my period of unemployment me

611
00:22:17,120 --> 00:22:19,919
tinkering with various uh forensics and

612
00:22:19,919 --> 00:22:21,760
incident response tools

613
00:22:21,760 --> 00:22:24,159
so i installed it there

614
00:22:24,159 --> 00:22:25,120
and

615
00:22:25,120 --> 00:22:27,919
ultimately uh this is just basically

616
00:22:27,919 --> 00:22:29,679
running through it so

617
00:22:29,679 --> 00:22:32,880
uh right here is that rwp to flow so p

618
00:22:32,880 --> 00:22:35,919
caps uh we're using the evil os 10

619
00:22:35,919 --> 00:22:38,400
underscore one hour p cap

620
00:22:38,400 --> 00:22:40,080
uh and then basically we're just putting

621
00:22:40,080 --> 00:22:42,480
it in a different directory

622
00:22:42,480 --> 00:22:44,640
keeping the host name or the file name

623
00:22:44,640 --> 00:22:48,559
intact with dot rw

624
00:22:49,520 --> 00:22:52,559
do that cool oh i messed up when you

625
00:22:52,559 --> 00:22:55,559
know

626
00:22:56,480 --> 00:22:58,000
so now

627
00:22:58,000 --> 00:22:59,440
still messing up

628
00:22:59,440 --> 00:23:01,840
there we go and at this point we've

629
00:23:01,840 --> 00:23:03,919
executed the rw cut

630
00:23:03,919 --> 00:23:06,720
with the delimited with the comma

631
00:23:06,720 --> 00:23:08,799
timestamp format iso

632
00:23:08,799 --> 00:23:11,520
output path evil os 10

633
00:23:11,520 --> 00:23:13,520
uh underscore one and then there's the

634
00:23:13,520 --> 00:23:16,480
dot rw file and then at that point we

635
00:23:16,480 --> 00:23:19,360
have it and we can verify it

636
00:23:19,360 --> 00:23:21,120
so here's all of them

637
00:23:21,120 --> 00:23:23,679
as you can see i put all the rw files

638
00:23:23,679 --> 00:23:24,720
into

639
00:23:24,720 --> 00:23:28,080
one particular location so that was what

640
00:23:28,080 --> 00:23:31,360
caused the hiccup with the uh

641
00:23:31,360 --> 00:23:33,840
the command earlier but basically you

642
00:23:33,840 --> 00:23:35,440
know we have

643
00:23:35,440 --> 00:23:39,039
the csvs and the rws as well

644
00:23:39,039 --> 00:23:42,080
and that's really all there is to doing

645
00:23:42,080 --> 00:23:43,919
the actual conversion

646
00:23:43,919 --> 00:23:46,799
um moving from there though

647
00:23:46,799 --> 00:23:48,840
right here we have

648
00:23:48,840 --> 00:23:50,559
elk

649
00:23:50,559 --> 00:23:53,520
so i will tell you i

650
00:23:53,520 --> 00:23:55,360
i appreciate elk

651
00:23:55,360 --> 00:23:57,039
but

652
00:23:57,039 --> 00:23:59,919
standing elk stack elastic search log

653
00:23:59,919 --> 00:24:02,159
stash and cabana standing it up from the

654
00:24:02,159 --> 00:24:05,039
ground up can be a major pain

655
00:24:05,039 --> 00:24:05,919
in

656
00:24:05,919 --> 00:24:08,080
the derriere

657
00:24:08,080 --> 00:24:10,080
major

658
00:24:10,080 --> 00:24:11,279
so

659
00:24:11,279 --> 00:24:13,360
if you're going to test this out

660
00:24:13,360 --> 00:24:14,559
what i did

661
00:24:14,559 --> 00:24:17,919
was i signed up on elastic's website for

662
00:24:17,919 --> 00:24:21,360
a 14-day free trial

663
00:24:21,520 --> 00:24:23,840
be careful if you go past that 14-day

664
00:24:23,840 --> 00:24:25,760
free trial because i also had all my

665
00:24:25,760 --> 00:24:28,400
honey pots connected to a free trial

666
00:24:28,400 --> 00:24:30,080
and once i got out of the free trial

667
00:24:30,080 --> 00:24:32,159
period it was supposed to cost me 50 a

668
00:24:32,159 --> 00:24:34,080
month 13 days in the month my bill was

669
00:24:34,080 --> 00:24:36,640
375

670
00:24:36,640 --> 00:24:38,720
be careful what you connect to it

671
00:24:38,720 --> 00:24:40,080
if you're only doing this kind of stuff

672
00:24:40,080 --> 00:24:42,159
you're probably safe if you connect it

673
00:24:42,159 --> 00:24:43,600
to a bunch of honey pots hanging out on

674
00:24:43,600 --> 00:24:45,520
digital ocean

675
00:24:45,520 --> 00:24:49,039
probably not the best of ideas

676
00:24:49,520 --> 00:24:53,918
my my wallet learned and overcame

677
00:24:54,559 --> 00:24:56,080
fortunately that was before i was

678
00:24:56,080 --> 00:24:58,000
unemployed

679
00:24:58,000 --> 00:24:59,760
so anyway to do this it's actually

680
00:24:59,760 --> 00:25:01,039
fairly simple

681
00:25:01,039 --> 00:25:03,600
you literally just say upload a file and

682
00:25:03,600 --> 00:25:05,360
oh wouldn't you know there's a netflow

683
00:25:05,360 --> 00:25:06,320
file

684
00:25:06,320 --> 00:25:09,120
so this is what the csv looks like start

685
00:25:09,120 --> 00:25:12,159
time source ip address source cc

686
00:25:12,159 --> 00:25:14,400
destination ip address

687
00:25:14,400 --> 00:25:16,240
and so on i don't need to read all of

688
00:25:16,240 --> 00:25:18,080
them but basically we are able to see

689
00:25:18,080 --> 00:25:20,640
what this looks like and then each entry

690
00:25:20,640 --> 00:25:23,200
right here there's your

691
00:25:23,200 --> 00:25:26,080
uh date and your time

692
00:25:26,080 --> 00:25:28,080
and then from here you have your ip

693
00:25:28,080 --> 00:25:29,039
address

694
00:25:29,039 --> 00:25:31,360
cc being country code in this case

695
00:25:31,360 --> 00:25:33,279
that's an additional field that that

696
00:25:33,279 --> 00:25:36,720
particular file has so they've used

697
00:25:36,720 --> 00:25:38,400
something like

698
00:25:38,400 --> 00:25:40,880
geojson or some other

699
00:25:40,880 --> 00:25:42,799
geo geolocation

700
00:25:42,799 --> 00:25:45,600
mechanism to say this ip address

701
00:25:45,600 --> 00:25:48,799
is assigned to say the united states an

702
00:25:48,799 --> 00:25:50,960
organization in the u.s or

703
00:25:50,960 --> 00:25:52,960
as we see over here

704
00:25:52,960 --> 00:25:54,080
brazil

705
00:25:54,080 --> 00:25:57,440
right and then we have the actual

706
00:25:57,440 --> 00:25:59,279
um

707
00:25:59,279 --> 00:26:02,000
the protocol the source port

708
00:26:02,000 --> 00:26:03,679
so forth and so on and we can go all the

709
00:26:03,679 --> 00:26:04,880
way across

710
00:26:04,880 --> 00:26:06,480
some of these you're gonna see the same

711
00:26:06,480 --> 00:26:08,000
some you're not going to see the same

712
00:26:08,000 --> 00:26:10,480
it's going to vary depending on what

713
00:26:10,480 --> 00:26:12,000
inputs you have

714
00:26:12,000 --> 00:26:14,240
uh if it's coming native

715
00:26:14,240 --> 00:26:16,080
netflow you're more likely going to have

716
00:26:16,080 --> 00:26:18,960
something like this if it's coming from

717
00:26:18,960 --> 00:26:21,120
uh silk it's going to be like

718
00:26:21,120 --> 00:26:23,039
lowercase s

719
00:26:23,039 --> 00:26:26,799
uh ip and then the ipo b upper case

720
00:26:26,799 --> 00:26:29,360
so it's going to vary but ultimately as

721
00:26:29,360 --> 00:26:32,320
with anything once you do the analysis

722
00:26:32,320 --> 00:26:33,840
once you run that initial script you

723
00:26:33,840 --> 00:26:35,520
need to validate what you have anyway so

724
00:26:35,520 --> 00:26:37,440
that you know your your field names and

725
00:26:37,440 --> 00:26:39,840
your headers anyway so

726
00:26:39,840 --> 00:26:41,919
just go through and check it to see what

727
00:26:41,919 --> 00:26:43,120
you have

728
00:26:43,120 --> 00:26:44,640
from there you know we can scroll

729
00:26:44,640 --> 00:26:46,720
through look at all this this gives us

730
00:26:46,720 --> 00:26:49,840
everything as it's put into elk we give

731
00:26:49,840 --> 00:26:51,760
it an index name

732
00:26:51,760 --> 00:26:53,279
in this case

733
00:26:53,279 --> 00:26:55,120
like if you're using soft elk for

734
00:26:55,120 --> 00:26:57,039
example

735
00:26:57,039 --> 00:26:58,880
they already have

736
00:26:58,880 --> 00:27:02,080
elk built into it because it's soft elk

737
00:27:02,080 --> 00:27:03,840
and it was built for

738
00:27:03,840 --> 00:27:08,559
network forensics but the caveat is it

739
00:27:08,559 --> 00:27:10,960
to be able to import stuff directly to

740
00:27:10,960 --> 00:27:13,200
it is a little bit trickier than if you

741
00:27:13,200 --> 00:27:16,400
do just a generic elk instance

742
00:27:16,400 --> 00:27:18,000
because you have to match your

743
00:27:18,000 --> 00:27:19,360
field names up and make sure that

744
00:27:19,360 --> 00:27:21,600
everything is compliant uh because

745
00:27:21,600 --> 00:27:23,200
they've already predetermined the

746
00:27:23,200 --> 00:27:26,399
indexes uh they've already

747
00:27:26,399 --> 00:27:28,640
indexes or should i say indices either

748
00:27:28,640 --> 00:27:29,679
way

749
00:27:29,679 --> 00:27:32,399
um with that it's already predetermined

750
00:27:32,399 --> 00:27:33,760
and they've already got the dashboards

751
00:27:33,760 --> 00:27:36,399
built so if you're doing it on your own

752
00:27:36,399 --> 00:27:38,159
you'll have to build your own dashboards

753
00:27:38,159 --> 00:27:39,120
but

754
00:27:39,120 --> 00:27:39,919
it's

755
00:27:39,919 --> 00:27:42,000
pretty much point and click it's not

756
00:27:42,000 --> 00:27:43,679
terribly challenging

757
00:27:43,679 --> 00:27:46,320
but from there i just gave it

758
00:27:46,320 --> 00:27:48,000
i try to start everything with netflow

759
00:27:48,000 --> 00:27:50,000
hyphen so that way i can use the same

760
00:27:50,000 --> 00:27:52,880
dashboards repetitively because

761
00:27:52,880 --> 00:27:56,000
i try to work smarter not harder

762
00:27:56,000 --> 00:27:57,120
try

763
00:27:57,120 --> 00:27:59,360
um and then from there let me skip ahead

764
00:27:59,360 --> 00:28:00,799
a little bit so i ended up naming it

765
00:28:00,799 --> 00:28:03,279
demo one it goes through so it's going

766
00:28:03,279 --> 00:28:04,799
to process the file it's going to create

767
00:28:04,799 --> 00:28:07,120
the index have your ingest pipeline

768
00:28:07,120 --> 00:28:08,720
because at the end of the day elk was

769
00:28:08,720 --> 00:28:11,279
built to receive files on

770
00:28:11,279 --> 00:28:13,360
on the fly not just whenever you upload

771
00:28:13,360 --> 00:28:15,600
it but in this case we're only using it

772
00:28:15,600 --> 00:28:17,360
for the upload portion

773
00:28:17,360 --> 00:28:19,440
so it's going to do that

774
00:28:19,440 --> 00:28:21,919
sometimes it takes a little bit

775
00:28:21,919 --> 00:28:24,640
and now we have everything there

776
00:28:24,640 --> 00:28:26,799
so

777
00:28:27,360 --> 00:28:30,240
it's just going to search across here

778
00:28:30,240 --> 00:28:32,960
and this is the same data so this is

779
00:28:32,960 --> 00:28:35,279
just exploring it so it's using the

780
00:28:35,279 --> 00:28:38,559
discover tab to look at it this i mean

781
00:28:38,559 --> 00:28:40,720
you can do this exact same thing in

782
00:28:40,720 --> 00:28:43,600
excel you can do the exact same thing i

783
00:28:43,600 --> 00:28:45,440
mean from the linux command line it's

784
00:28:45,440 --> 00:28:47,120
not going to be as pretty

785
00:28:47,120 --> 00:28:49,120
it's not going to be as delimited it'll

786
00:28:49,120 --> 00:28:51,679
be just as delimited but

787
00:28:51,679 --> 00:28:54,559
it won't be as aesthetically pleasing

788
00:28:54,559 --> 00:28:58,000
but you could still do it

789
00:28:58,000 --> 00:29:00,320
and then from there you can literally

790
00:29:00,320 --> 00:29:02,879
run through

791
00:29:03,440 --> 00:29:06,480
just have a look around verify

792
00:29:06,480 --> 00:29:08,320
verify the fidelity of your data you

793
00:29:08,320 --> 00:29:10,000
want to make sure that you've got good

794
00:29:10,000 --> 00:29:12,159
quality data and something's not flubbed

795
00:29:12,159 --> 00:29:13,200
up

796
00:29:13,200 --> 00:29:15,760
like whenever i pull certain things from

797
00:29:15,760 --> 00:29:18,000
an api like from one of the data breach

798
00:29:18,000 --> 00:29:20,559
apis that i connect to it never fails

799
00:29:20,559 --> 00:29:23,200
that somewhere in the usernames field is

800
00:29:23,200 --> 00:29:26,080
a file hash and somewhere under address

801
00:29:26,080 --> 00:29:27,039
is

802
00:29:27,039 --> 00:29:30,000
probably a password so you've got to go

803
00:29:30,000 --> 00:29:31,520
through and take a look at it clean it

804
00:29:31,520 --> 00:29:34,559
up make sure everything's correct

805
00:29:34,559 --> 00:29:36,799
but anyway we go through creating some

806
00:29:36,799 --> 00:29:38,799
visualizations here like i said it's

807
00:29:38,799 --> 00:29:41,760
literally point and click so right here

808
00:29:41,760 --> 00:29:43,600
we've got

809
00:29:43,600 --> 00:29:45,600
client ip addresses

810
00:29:45,600 --> 00:29:48,799
so with this particular field uh

811
00:29:48,799 --> 00:29:50,640
you've got client ip address but then

812
00:29:50,640 --> 00:29:52,240
you've also got source and destination

813
00:29:52,240 --> 00:29:55,120
so client ip address takes both

814
00:29:55,120 --> 00:29:57,600
source and destination into account

815
00:29:57,600 --> 00:29:59,360
but in this right now

816
00:29:59,360 --> 00:30:01,600
you know for example

817
00:30:01,600 --> 00:30:03,039
you're working in a sock you've got

818
00:30:03,039 --> 00:30:05,600
netflow data and they say hey

819
00:30:05,600 --> 00:30:08,000
we've just got smacked with a denial of

820
00:30:08,000 --> 00:30:11,679
service who are the top five

821
00:30:11,679 --> 00:30:14,720
chattiest hosts

822
00:30:14,720 --> 00:30:16,799
you can find it out with netflow

823
00:30:16,799 --> 00:30:17,919
or i'm sorry you can find that out with

824
00:30:17,919 --> 00:30:19,360
a pcap

825
00:30:19,360 --> 00:30:20,960
honestly your sim should be able to tell

826
00:30:20,960 --> 00:30:23,360
you this but

827
00:30:23,360 --> 00:30:26,159
for example maybe you don't have

828
00:30:26,159 --> 00:30:28,000
a sim or

829
00:30:28,000 --> 00:30:30,399
you don't have access to the sim

830
00:30:30,399 --> 00:30:32,240
or

831
00:30:32,240 --> 00:30:34,799
you might just want a challenge

832
00:30:34,799 --> 00:30:36,320
you might be chasing one of those

833
00:30:36,320 --> 00:30:37,840
promotions or

834
00:30:37,840 --> 00:30:39,440
or something to that effect you might

835
00:30:39,440 --> 00:30:41,520
want to be demonstrating your

836
00:30:41,520 --> 00:30:43,679
ability to automate or think outside the

837
00:30:43,679 --> 00:30:45,279
box

838
00:30:45,279 --> 00:30:47,440
here's a here's a way for you to do it

839
00:30:47,440 --> 00:30:49,279
so you can accomplish the same thing

840
00:30:49,279 --> 00:30:51,840
here

841
00:30:52,000 --> 00:30:53,919
and then there you go there's your top

842
00:30:53,919 --> 00:30:57,120
five talkers so boom we have this now

843
00:30:57,120 --> 00:30:59,600
the next time that i import netflow i

844
00:30:59,600 --> 00:31:01,919
can change it uh right over here instead

845
00:31:01,919 --> 00:31:04,399
of netflow demo to netflow whatever

846
00:31:04,399 --> 00:31:06,799
whatever i named the next one

847
00:31:06,799 --> 00:31:08,240
populated

848
00:31:08,240 --> 00:31:13,039
so now we see client and destinations

849
00:31:13,519 --> 00:31:14,960
what do we what are we going to do next

850
00:31:14,960 --> 00:31:17,519
oh ports

851
00:31:17,519 --> 00:31:19,600
so what happens when you see a bunch of

852
00:31:19,600 --> 00:31:21,840
port 500

853
00:31:21,840 --> 00:31:24,559
any ideas

854
00:31:25,679 --> 00:31:27,679
it's a vpn

855
00:31:27,679 --> 00:31:28,640
so

856
00:31:28,640 --> 00:31:29,919
it's going to tell you just as much as a

857
00:31:29,919 --> 00:31:31,279
pcap will

858
00:31:31,279 --> 00:31:34,000
except it's a smaller file

859
00:31:34,000 --> 00:31:35,279
and it can give you a little bit more

860
00:31:35,279 --> 00:31:37,519
information because you can look at it

861
00:31:37,519 --> 00:31:39,360
if you're filtering by a particular port

862
00:31:39,360 --> 00:31:41,840
like say for example port 500 and you

863
00:31:41,840 --> 00:31:43,679
could actually look and see

864
00:31:43,679 --> 00:31:48,559
who patient zero is so you can do your

865
00:31:48,559 --> 00:31:49,840
your

866
00:31:49,840 --> 00:31:52,080
basic analysis to find out the root

867
00:31:52,080 --> 00:31:53,600
cause of things

868
00:31:53,600 --> 00:31:55,600
i will say with ports because it's a

869
00:31:55,600 --> 00:31:58,320
numeric value

870
00:31:58,320 --> 00:32:00,799
at times

871
00:32:00,799 --> 00:32:02,799
elk will try to add all those numbers up

872
00:32:02,799 --> 00:32:04,480
for you

873
00:32:04,480 --> 00:32:05,519
it's like

874
00:32:05,519 --> 00:32:10,200
i know we don't have a port 73814

875
00:32:10,799 --> 00:32:12,559
unless there's a new rfc that i've not

876
00:32:12,559 --> 00:32:14,399
heard about

877
00:32:14,399 --> 00:32:16,639
oh

878
00:32:18,000 --> 00:32:21,240
it's ipv7

879
00:32:26,480 --> 00:32:29,200
totally saying that in jest

880
00:32:29,200 --> 00:32:30,559
but like right here

881
00:32:30,559 --> 00:32:32,640
number of octets that's one way to look

882
00:32:32,640 --> 00:32:36,000
at it cool oh look right here we have a

883
00:32:36,000 --> 00:32:38,320
median right so think about this from a

884
00:32:38,320 --> 00:32:41,120
statistic analysis perspective

885
00:32:41,120 --> 00:32:43,760
let's go back to high school or college

886
00:32:43,760 --> 00:32:44,799
stats

887
00:32:44,799 --> 00:32:46,799
we're not going to go into any like

888
00:32:46,799 --> 00:32:47,919
really

889
00:32:47,919 --> 00:32:49,600
disgusting things like confidence

890
00:32:49,600 --> 00:32:53,039
intervals or anything like that

891
00:32:53,039 --> 00:32:55,600
you've got three measurements that make

892
00:32:55,600 --> 00:32:59,120
the most sense for you right

893
00:32:59,120 --> 00:33:00,880
mean

894
00:33:00,880 --> 00:33:02,080
median

895
00:33:02,080 --> 00:33:03,919
standard deviation

896
00:33:03,919 --> 00:33:04,960
right

897
00:33:04,960 --> 00:33:07,279
mean is going to be your average so

898
00:33:07,279 --> 00:33:09,679
that's going to be of all

899
00:33:09,679 --> 00:33:12,559
data points this most accurately

900
00:33:12,559 --> 00:33:14,159
describes

901
00:33:14,159 --> 00:33:17,679
the general tendency of all other data

902
00:33:17,679 --> 00:33:19,760
points

903
00:33:19,760 --> 00:33:22,799
right you've got median which means that

904
00:33:22,799 --> 00:33:26,720
across the board this is the most

905
00:33:26,720 --> 00:33:27,840
center

906
00:33:27,840 --> 00:33:29,200
data point

907
00:33:29,200 --> 00:33:30,399
it

908
00:33:30,399 --> 00:33:32,159
in some cases if we're talking about a

909
00:33:32,159 --> 00:33:34,000
perfect bell-shaped curve

910
00:33:34,000 --> 00:33:36,799
the mean and the median should be the

911
00:33:36,799 --> 00:33:40,399
same but this is real life we don't have

912
00:33:40,399 --> 00:33:42,399
bell-shaped curves well we do

913
00:33:42,399 --> 00:33:44,399
occasionally but

914
00:33:44,399 --> 00:33:47,120
not a perfect one so as a byproduct

915
00:33:47,120 --> 00:33:48,480
there's a difference

916
00:33:48,480 --> 00:33:50,320
and then finally you have your standard

917
00:33:50,320 --> 00:33:52,399
deviation which speaks to

918
00:33:52,399 --> 00:33:55,760
the general tendency to deviate from

919
00:33:55,760 --> 00:33:56,720
the mean

920
00:33:56,720 --> 00:33:58,960
so that shows you how much variance you

921
00:33:58,960 --> 00:34:01,279
have a very high standard of standard

922
00:34:01,279 --> 00:34:03,120
deviation indicates there's a lot of

923
00:34:03,120 --> 00:34:04,880
variance a very low one indicates that

924
00:34:04,880 --> 00:34:05,840
everything everything's clustered up

925
00:34:05,840 --> 00:34:08,480
together pretty nicely so with that you

926
00:34:08,480 --> 00:34:10,079
have those three measurements that you

927
00:34:10,079 --> 00:34:11,918
could do here in this case we have the

928
00:34:11,918 --> 00:34:14,320
median number of octets that's

929
00:34:14,320 --> 00:34:17,440
indicative that of in this pcapp the

930
00:34:17,440 --> 00:34:22,560
average is 114 000 uh octets or bytes

931
00:34:22,560 --> 00:34:23,520
so

932
00:34:23,520 --> 00:34:25,599
all right we have that cool

933
00:34:25,599 --> 00:34:27,839
well

934
00:34:29,839 --> 00:34:32,960
so there's the median

935
00:34:32,960 --> 00:34:34,719
again

936
00:34:34,719 --> 00:34:36,399
so you know just showing it different

937
00:34:36,399 --> 00:34:37,760
ways

938
00:34:37,760 --> 00:34:40,480
i mean the social engineer in me says

939
00:34:40,480 --> 00:34:42,000
everybody interprets and learns

940
00:34:42,000 --> 00:34:43,520
differently some people learn better

941
00:34:43,520 --> 00:34:45,760
visually some people learn better by

942
00:34:45,760 --> 00:34:48,480
reading some audibly some by seeing so

943
00:34:48,480 --> 00:34:49,918
have it as many different ways as you

944
00:34:49,918 --> 00:34:52,159
want now look i'm changing i'm creating

945
00:34:52,159 --> 00:34:54,159
a new one that's the average so now

946
00:34:54,159 --> 00:34:57,599
we're getting the mean here

947
00:34:57,599 --> 00:34:59,200
that's

948
00:34:59,200 --> 00:35:01,040
pretty

949
00:35:01,040 --> 00:35:04,160
different wouldn't you think

950
00:35:04,320 --> 00:35:06,000
that's

951
00:35:06,000 --> 00:35:10,960
quite a bit larger than 114 000

952
00:35:11,119 --> 00:35:14,480
without going deep into the actual

953
00:35:14,480 --> 00:35:16,720
pcap and what was really happening

954
00:35:16,720 --> 00:35:18,800
basically that lower number for the

955
00:35:18,800 --> 00:35:22,160
median was indicative of beaconing

956
00:35:22,160 --> 00:35:23,440
uh over

957
00:35:23,440 --> 00:35:25,839
it's basically dns requests for text

958
00:35:25,839 --> 00:35:30,400
records uh so that had a very small

959
00:35:30,400 --> 00:35:33,200
packet size so that drove the number

960
00:35:33,200 --> 00:35:35,359
down in that regard but in terms of the

961
00:35:35,359 --> 00:35:37,200
higher average

962
00:35:37,200 --> 00:35:39,200
there were several

963
00:35:39,200 --> 00:35:40,880
file transfers

964
00:35:40,880 --> 00:35:42,320
that were

965
00:35:42,320 --> 00:35:45,040
very large that

966
00:35:45,040 --> 00:35:46,800
basically offset it

967
00:35:46,800 --> 00:35:49,599
so you had all the beaconing which drove

968
00:35:49,599 --> 00:35:51,920
the median there but then to get the

969
00:35:51,920 --> 00:35:53,599
average it's because of the large file

970
00:35:53,599 --> 00:35:56,079
sizes

971
00:35:56,079 --> 00:35:57,520
oh and look you can drag and drop and

972
00:35:57,520 --> 00:35:59,359
move things around

973
00:35:59,359 --> 00:36:00,880
you know do all the hokey pokeys you

974
00:36:00,880 --> 00:36:03,200
want

975
00:36:03,920 --> 00:36:06,240
so we can edit this so in this case i

976
00:36:06,240 --> 00:36:10,479
said client let's change that to

977
00:36:10,839 --> 00:36:13,839
source so it's not final right

978
00:36:13,839 --> 00:36:15,760
and then with this you have other i

979
00:36:15,760 --> 00:36:17,760
always like to turn the other off

980
00:36:17,760 --> 00:36:18,800
because

981
00:36:18,800 --> 00:36:20,320
with a large data set that other is

982
00:36:20,320 --> 00:36:22,079
going to skew it pretty hard

983
00:36:22,079 --> 00:36:25,119
so now we have source and we can look

984
00:36:25,119 --> 00:36:27,200
and say oh well you know what our number

985
00:36:27,200 --> 00:36:27,920
one

986
00:36:27,920 --> 00:36:30,240
top talking source

987
00:36:30,240 --> 00:36:33,119
is also the top talking destination

988
00:36:33,119 --> 00:36:35,520
what's going on with this hmm that's

989
00:36:35,520 --> 00:36:38,960
also an internet-facing ip address

990
00:36:38,960 --> 00:36:41,680
enter the word oscent of the netflow

991
00:36:41,680 --> 00:36:44,640
cent you now have an ip address to go

992
00:36:44,640 --> 00:36:47,599
you know snooping on you you have a

993
00:36:47,599 --> 00:36:49,359
target of interest for

994
00:36:49,359 --> 00:36:52,079
say showdown or

995
00:36:52,079 --> 00:36:55,040
url scan or

996
00:36:55,040 --> 00:36:58,400
any of the tools du jour i mean honestly

997
00:36:58,400 --> 00:37:00,800
google

998
00:37:01,359 --> 00:37:02,079
so

999
00:37:02,079 --> 00:37:04,480
you have all these mechanisms that you

1000
00:37:04,480 --> 00:37:07,440
can poke around with and find stuff and

1001
00:37:07,440 --> 00:37:10,960
then oh you want to filter it cool oh oh

1002
00:37:10,960 --> 00:37:12,880
actually you know what

1003
00:37:12,880 --> 00:37:15,119
i lied here's some jupiter

1004
00:37:15,119 --> 00:37:15,920
but

1005
00:37:15,920 --> 00:37:18,000
it's recorded um

1006
00:37:18,000 --> 00:37:19,839
so

1007
00:37:19,839 --> 00:37:22,240
if i were a fan of the band

1008
00:37:22,240 --> 00:37:23,920
train i would make a reference to drops

1009
00:37:23,920 --> 00:37:26,079
of jupiter but

1010
00:37:26,079 --> 00:37:27,920
i really i really lost interest when

1011
00:37:27,920 --> 00:37:31,119
hazel's sister came out

1012
00:37:32,240 --> 00:37:34,160
i would make a joke about my sisters not

1013
00:37:34,160 --> 00:37:37,040
having souls

1014
00:37:37,040 --> 00:37:38,640
but anyway this is what it looks like in

1015
00:37:38,640 --> 00:37:40,000
jupiter so

1016
00:37:40,000 --> 00:37:42,560
importing the csv file into jupiter

1017
00:37:42,560 --> 00:37:44,400
which is basically

1018
00:37:44,400 --> 00:37:47,760
a web-based python interface that allows

1019
00:37:47,760 --> 00:37:49,839
you immediate gratification that's why i

1020
00:37:49,839 --> 00:37:51,200
like jupiter

1021
00:37:51,200 --> 00:37:52,800
i've actually started writing all of my

1022
00:37:52,800 --> 00:37:55,119
ocean tools in jupiter now

1023
00:37:55,119 --> 00:37:56,640
because you can test it out and when

1024
00:37:56,640 --> 00:37:57,920
you're debugging it you don't have to

1025
00:37:57,920 --> 00:38:00,640
put like print works to here number one

1026
00:38:00,640 --> 00:38:03,760
works to hear number three works to hear

1027
00:38:03,760 --> 00:38:06,240
you see the exact line and

1028
00:38:06,240 --> 00:38:08,400
you're able to edit that data on the fly

1029
00:38:08,400 --> 00:38:10,960
without having to re-execute the entire

1030
00:38:10,960 --> 00:38:12,720
script you can copy and paste it and

1031
00:38:12,720 --> 00:38:14,000
move it on

1032
00:38:14,000 --> 00:38:15,599
so it works out really well so in this

1033
00:38:15,599 --> 00:38:18,560
case this is that same csv input into a

1034
00:38:18,560 --> 00:38:20,000
jupyter notebook

1035
00:38:20,000 --> 00:38:22,160
also with jupiter you can also analyze

1036
00:38:22,160 --> 00:38:25,760
it using the r language or also

1037
00:38:25,760 --> 00:38:28,000
uh the julia language i know a little

1038
00:38:28,000 --> 00:38:29,440
bit with r

1039
00:38:29,440 --> 00:38:31,200
not so much with julia but that's where

1040
00:38:31,200 --> 00:38:34,000
the word jupiter comes from

1041
00:38:34,000 --> 00:38:37,920
so with this i imported it into a pandas

1042
00:38:37,920 --> 00:38:40,079
data frame a pandas data frame is

1043
00:38:40,079 --> 00:38:42,720
basically an excel spreadsheet in memory

1044
00:38:42,720 --> 00:38:44,480
existing in python

1045
00:38:44,480 --> 00:38:46,079
it's very popular in the data science

1046
00:38:46,079 --> 00:38:49,680
world i'm a huge fan of it but anyway

1047
00:38:49,680 --> 00:38:51,520
what i've done here is

1048
00:38:51,520 --> 00:38:54,000
i i've said okay well we're doing it

1049
00:38:54,000 --> 00:38:56,240
iterating across the rows

1050
00:38:56,240 --> 00:38:58,079
and i want to know in terms of the

1051
00:38:58,079 --> 00:39:00,640
destination ip address i wanna know

1052
00:39:00,640 --> 00:39:04,000
the top four talkers hence the colon

1053
00:39:04,000 --> 00:39:05,200
four

1054
00:39:05,200 --> 00:39:06,720
and

1055
00:39:06,720 --> 00:39:10,240
right here we have them

1056
00:39:10,240 --> 00:39:12,400
and i apologize it's not showing as good

1057
00:39:12,400 --> 00:39:14,880
on the projector but

1058
00:39:14,880 --> 00:39:16,720
you're doing this from a browser it's

1059
00:39:16,720 --> 00:39:19,200
fairly easy to work with it

1060
00:39:19,200 --> 00:39:20,400
so

1061
00:39:20,400 --> 00:39:22,320
same thing with source

1062
00:39:22,320 --> 00:39:24,240
we get that same data

1063
00:39:24,240 --> 00:39:25,520
for the mean

1064
00:39:25,520 --> 00:39:28,079
literally it's just dot mean or dot

1065
00:39:28,079 --> 00:39:33,200
median or dot std for standard deviation

1066
00:39:33,920 --> 00:39:36,880
so from that we can do value counts so

1067
00:39:36,880 --> 00:39:38,720
right here doing the value counts this

1068
00:39:38,720 --> 00:39:42,000
is telling you on a per ip basis

1069
00:39:42,000 --> 00:39:44,800
how many entries there are for each

1070
00:39:44,800 --> 00:39:47,599
individual ip address this is giving you

1071
00:39:47,599 --> 00:39:51,280
context can you get this from a pcap yes

1072
00:39:51,280 --> 00:39:54,000
is it easy not always

1073
00:39:54,000 --> 00:39:55,680
because you have to filter it on strings

1074
00:39:55,680 --> 00:39:58,000
and do this and do that this right here

1075
00:39:58,000 --> 00:40:00,640
natively poof you could have all of the

1076
00:40:00,640 --> 00:40:03,359
queries that you want

1077
00:40:03,359 --> 00:40:05,839
built into a jupyter notebook import

1078
00:40:05,839 --> 00:40:08,720
that csv literally go up here

1079
00:40:08,720 --> 00:40:10,800
and click run

1080
00:40:10,800 --> 00:40:12,880
run across all the cells

1081
00:40:12,880 --> 00:40:15,440
your analysis is done with this

1082
00:40:15,440 --> 00:40:17,599
then you can go back to digging through

1083
00:40:17,599 --> 00:40:18,960
the pcap

1084
00:40:18,960 --> 00:40:21,440
going through the logs

1085
00:40:21,440 --> 00:40:23,119
silencing the alerts

1086
00:40:23,119 --> 00:40:24,960
contacting management

1087
00:40:24,960 --> 00:40:26,800
triggering incident response all the

1088
00:40:26,800 --> 00:40:28,480
things that you want to do all the

1089
00:40:28,480 --> 00:40:30,160
things that you should be doing that i'm

1090
00:40:30,160 --> 00:40:32,319
not telling you not to be doing i'm just

1091
00:40:32,319 --> 00:40:33,200
saying

1092
00:40:33,200 --> 00:40:34,880
this is another step that you can gain

1093
00:40:34,880 --> 00:40:37,520
additional context with

1094
00:40:37,520 --> 00:40:40,160
so as a byproduct you know we've got all

1095
00:40:40,160 --> 00:40:42,400
of this cool that's the same ip address

1096
00:40:42,400 --> 00:40:45,280
we saw before

1097
00:40:45,359 --> 00:40:48,160
oh and now we're back in elk with it so

1098
00:40:48,160 --> 00:40:49,839
we get that exact same thing so we're

1099
00:40:49,839 --> 00:40:52,400
able to filter and then when you do that

1100
00:40:52,400 --> 00:40:54,240
filter you can run that same analysis

1101
00:40:54,240 --> 00:40:55,760
and say

1102
00:40:55,760 --> 00:40:57,920
okay with this host what are the top

1103
00:40:57,920 --> 00:41:00,480
five hosts that talked to this host what

1104
00:41:00,480 --> 00:41:02,720
are the top five hosts that this host

1105
00:41:02,720 --> 00:41:03,839
talked to

1106
00:41:03,839 --> 00:41:07,440
if you know for example

1107
00:41:07,440 --> 00:41:08,480
if you know

1108
00:41:08,480 --> 00:41:10,319
for example within

1109
00:41:10,319 --> 00:41:12,079
a particular event

1110
00:41:12,079 --> 00:41:14,240
that

1111
00:41:14,240 --> 00:41:16,960
this host was compromised

1112
00:41:16,960 --> 00:41:19,599
at such and such time

1113
00:41:19,599 --> 00:41:22,319
you could set a filter

1114
00:41:22,319 --> 00:41:24,720
for around that time

1115
00:41:24,720 --> 00:41:26,400
and then you could filter based on that

1116
00:41:26,400 --> 00:41:27,440
hosts

1117
00:41:27,440 --> 00:41:29,599
and if you're trying to triage to

1118
00:41:29,599 --> 00:41:31,760
determine which host you should either

1119
00:41:31,760 --> 00:41:35,839
take off the network or investigate next

1120
00:41:35,920 --> 00:41:38,079
you now have context

1121
00:41:38,079 --> 00:41:40,319
you can do it with logs as well

1122
00:41:40,319 --> 00:41:41,280
but

1123
00:41:41,280 --> 00:41:43,839
do you really with a log do you really

1124
00:41:43,839 --> 00:41:45,200
care if

1125
00:41:45,200 --> 00:41:47,599
the compromise host literally just

1126
00:41:47,599 --> 00:41:50,319
pinged the other host or do you care

1127
00:41:50,319 --> 00:41:53,200
that it connected to the host via rdp or

1128
00:41:53,200 --> 00:41:55,119
ssh

1129
00:41:55,119 --> 00:41:55,920
right

1130
00:41:55,920 --> 00:41:58,480
pings can be important but

1131
00:41:58,480 --> 00:42:00,720
they don't provide you the full context

1132
00:42:00,720 --> 00:42:02,560
so this is going to give you more of

1133
00:42:02,560 --> 00:42:05,200
that so and again you can literally just

1134
00:42:05,200 --> 00:42:07,440
tinker around with this uh however you

1135
00:42:07,440 --> 00:42:10,079
see fit there's no right or wrong answer

1136
00:42:10,079 --> 00:42:12,160
uh you know with many things here

1137
00:42:12,160 --> 00:42:14,000
quite honestly the beautiful thing about

1138
00:42:14,000 --> 00:42:17,280
this with using with having the csv uh

1139
00:42:17,280 --> 00:42:18,880
you could do it natively in excel you

1140
00:42:18,880 --> 00:42:20,480
could put it in elk or you can run the

1141
00:42:20,480 --> 00:42:23,440
jupiter notebook but most importantly

1142
00:42:23,440 --> 00:42:25,280
i don't have to tell you which way works

1143
00:42:25,280 --> 00:42:26,240
best

1144
00:42:26,240 --> 00:42:28,079
i don't have to make that decision you

1145
00:42:28,079 --> 00:42:28,960
do

1146
00:42:28,960 --> 00:42:30,960
because i don't know your organization

1147
00:42:30,960 --> 00:42:32,560
just as much as you don't know mine

1148
00:42:32,560 --> 00:42:34,160
unless you might sell some clothes on

1149
00:42:34,160 --> 00:42:37,040
mercari but at the end of the day

1150
00:42:37,040 --> 00:42:39,280
what it boils down to is

1151
00:42:39,280 --> 00:42:40,319
you

1152
00:42:40,319 --> 00:42:42,160
can make it your own you can build your

1153
00:42:42,160 --> 00:42:43,520
own queries you can have your own

1154
00:42:43,520 --> 00:42:45,440
dashboards and honestly you can make

1155
00:42:45,440 --> 00:42:48,319
yourself look like a rock star

1156
00:42:48,319 --> 00:42:50,480
doing some of this so

1157
00:42:50,480 --> 00:42:53,040
with that

1158
00:42:53,599 --> 00:42:57,880
let me get back to powerpoint

1159
00:43:02,880 --> 00:43:05,280
so with that we've looked through it

1160
00:43:05,280 --> 00:43:08,160
uh just to reiterate here

1161
00:43:08,160 --> 00:43:10,560
you've got uh excel

1162
00:43:10,560 --> 00:43:12,160
you already have it right we've already

1163
00:43:12,160 --> 00:43:15,119
talked about this with elk

1164
00:43:15,119 --> 00:43:16,960
i'm not saying that excel cannot provide

1165
00:43:16,960 --> 00:43:18,400
visualization i'm not saying that

1166
00:43:18,400 --> 00:43:20,640
jupiter cannot provide visualization

1167
00:43:20,640 --> 00:43:21,839
both can

1168
00:43:21,839 --> 00:43:24,079
it's just a little bit heavier of a lift

1169
00:43:24,079 --> 00:43:26,000
so if you use elk you've got the native

1170
00:43:26,000 --> 00:43:27,440
vis the native capability of

1171
00:43:27,440 --> 00:43:30,160
visualization uh and then you can also

1172
00:43:30,160 --> 00:43:32,480
if you're using elk is a sim you can

1173
00:43:32,480 --> 00:43:35,280
import log data and other data points to

1174
00:43:35,280 --> 00:43:37,280
be able to integrate there if you go

1175
00:43:37,280 --> 00:43:39,200
with jupiter if you've got the python

1176
00:43:39,200 --> 00:43:41,440
chops you can go with jupiter

1177
00:43:41,440 --> 00:43:42,880
it's a little bit more complicated but

1178
00:43:42,880 --> 00:43:44,240
you're going to get better statistic

1179
00:43:44,240 --> 00:43:45,440
analysis

1180
00:43:45,440 --> 00:43:46,240
and

1181
00:43:46,240 --> 00:43:48,319
it's easier to repeat

1182
00:43:48,319 --> 00:43:50,480
and basically you reuse the same

1183
00:43:50,480 --> 00:43:52,160
notebook for

1184
00:43:52,160 --> 00:43:53,200
multiple

1185
00:43:53,200 --> 00:43:55,040
uh p caps

1186
00:43:55,040 --> 00:43:55,760
so

1187
00:43:55,760 --> 00:43:58,480
you know basically with that that leads

1188
00:43:58,480 --> 00:44:01,359
to the next steps the next steps as i

1189
00:44:01,359 --> 00:44:02,720
stated before

1190
00:44:02,720 --> 00:44:04,640
uh would be

1191
00:44:04,640 --> 00:44:07,839
you could ocent ocean the planet

1192
00:44:07,839 --> 00:44:11,040
start dropping some things into

1193
00:44:11,040 --> 00:44:14,640
things like virustotal or otx or just

1194
00:44:14,640 --> 00:44:17,839
your favorite threat intelligence ioc

1195
00:44:17,839 --> 00:44:21,040
ttp feed of choice

1196
00:44:21,040 --> 00:44:22,400
whatever you want there

1197
00:44:22,400 --> 00:44:24,560
but also importantly

1198
00:44:24,560 --> 00:44:27,040
it it can make for some really darn good

1199
00:44:27,040 --> 00:44:28,880
things to put into your reports

1200
00:44:28,880 --> 00:44:29,839
and that's where you're going to look

1201
00:44:29,839 --> 00:44:31,200
like a rock star

1202
00:44:31,200 --> 00:44:32,560
because

1203
00:44:32,560 --> 00:44:35,200
i said this in conversation yesterday i

1204
00:44:35,200 --> 00:44:39,440
meant it and i mean even continuing now

1205
00:44:39,440 --> 00:44:41,440
all the stuff that we just talked about

1206
00:44:41,440 --> 00:44:42,880
like it's all

1207
00:44:42,880 --> 00:44:45,119
for show right

1208
00:44:45,119 --> 00:44:47,839
what what do we get paid for

1209
00:44:47,839 --> 00:44:48,839
the

1210
00:44:48,839 --> 00:44:50,960
reports like

1211
00:44:50,960 --> 00:44:53,680
doing ocean investigations i mean

1212
00:44:53,680 --> 00:44:56,000
i've done some pretty wild stuff i found

1213
00:44:56,000 --> 00:44:57,599
some stuff that

1214
00:44:57,599 --> 00:45:00,079
quite frankly terrified me

1215
00:45:00,079 --> 00:45:01,440
but you know what the client didn't care

1216
00:45:01,440 --> 00:45:02,240
about

1217
00:45:02,240 --> 00:45:05,119
how i found it they cared that i had a

1218
00:45:05,119 --> 00:45:06,880
picture of it and some sort of

1219
00:45:06,880 --> 00:45:08,880
irrefutable proof saying that this was

1220
00:45:08,880 --> 00:45:10,800
what the case was so that they could do

1221
00:45:10,800 --> 00:45:12,400
whatever they needed to do

1222
00:45:12,400 --> 00:45:14,319
the same thing exists here having all

1223
00:45:14,319 --> 00:45:16,400
the cool tools is great

1224
00:45:16,400 --> 00:45:18,800
but at the same time

1225
00:45:18,800 --> 00:45:20,960
we do the tools for the show

1226
00:45:20,960 --> 00:45:22,960
reports for the dough and i didn't make

1227
00:45:22,960 --> 00:45:24,480
that up i really wish i did that came

1228
00:45:24,480 --> 00:45:27,440
that came from john strand actually so

1229
00:45:27,440 --> 00:45:29,839
i really wish i'd have thought it up but

1230
00:45:29,839 --> 00:45:32,079
here we are but basically that's what

1231
00:45:32,079 --> 00:45:33,920
you can do with it you can take the

1232
00:45:33,920 --> 00:45:35,920
screenshots from elk you can take those

1233
00:45:35,920 --> 00:45:38,960
data points from jupiter you can

1234
00:45:38,960 --> 00:45:40,000
i mean you can create the same

1235
00:45:40,000 --> 00:45:41,920
visualizations in jupyter write them to

1236
00:45:41,920 --> 00:45:45,359
a file import them in there as well and

1237
00:45:45,359 --> 00:45:47,359
i mean it's going to help going back to

1238
00:45:47,359 --> 00:45:49,200
what i said some people learn by hearing

1239
00:45:49,200 --> 00:45:51,760
some by seeing some by doing some by

1240
00:45:51,760 --> 00:45:52,880
reading

1241
00:45:52,880 --> 00:45:55,040
it allows you to

1242
00:45:55,040 --> 00:45:56,800
encompass this across the board as much

1243
00:45:56,800 --> 00:45:59,280
as possible so that people can get the

1244
00:45:59,280 --> 00:46:01,680
maximum comprehension from it and that's

1245
00:46:01,680 --> 00:46:05,118
ultimately what we want because

1246
00:46:05,839 --> 00:46:07,280
i arrived at the conclusion that

1247
00:46:07,280 --> 00:46:09,839
everybody working in infosec basically

1248
00:46:09,839 --> 00:46:12,160
works in some form of intelligence

1249
00:46:12,160 --> 00:46:13,440
right

1250
00:46:13,440 --> 00:46:15,760
intelligence at the end of the day uh i

1251
00:46:15,760 --> 00:46:17,839
mean

1252
00:46:17,839 --> 00:46:19,359
give or take whatever you want with it

1253
00:46:19,359 --> 00:46:20,560
but

1254
00:46:20,560 --> 00:46:22,720
the purpose of intelligence is to assist

1255
00:46:22,720 --> 00:46:25,359
in decision making

1256
00:46:25,359 --> 00:46:27,760
so our deliverables our products our

1257
00:46:27,760 --> 00:46:28,800
reports

1258
00:46:28,800 --> 00:46:29,839
should be

1259
00:46:29,839 --> 00:46:32,400
to inform in a mo in the most unbiased

1260
00:46:32,400 --> 00:46:34,000
way possible to assist in decision

1261
00:46:34,000 --> 00:46:36,720
making so having maximum comprehension

1262
00:46:36,720 --> 00:46:37,680
is

1263
00:46:37,680 --> 00:46:39,680
key with that being said i'll open it up

1264
00:46:39,680 --> 00:46:42,720
for questions

1265
00:46:42,720 --> 00:46:45,359
and while it's open for questions here's

1266
00:46:45,359 --> 00:46:48,400
my contact information

1267
00:46:48,400 --> 00:46:49,280
but

1268
00:46:49,280 --> 00:46:50,240
any

1269
00:46:50,240 --> 00:46:52,160
questions concerns complaints grievances

1270
00:46:52,160 --> 00:46:53,440
thoughts opinions or otherwise not that

1271
00:46:53,440 --> 00:46:57,160
i've ever rehearsed that phrase

1272
00:47:00,319 --> 00:47:03,920
okay i'll leave this up for a moment

1273
00:47:03,920 --> 00:47:04,800
and

1274
00:47:04,800 --> 00:47:07,520
uh with that being said

1275
00:47:07,520 --> 00:47:08,800
we've got the book signings in the

1276
00:47:08,800 --> 00:47:11,280
intelligence village downstairs corey

1277
00:47:11,280 --> 00:47:13,040
and myself are both selling our books

1278
00:47:13,040 --> 00:47:15,760
and signing them and uh the intelligence

1279
00:47:15,760 --> 00:47:18,560
village ctf will officially kick off at

1280
00:47:18,560 --> 00:47:20,240
10. the only thing you need is an

1281
00:47:20,240 --> 00:47:21,760
internet connection it could be on a

1282
00:47:21,760 --> 00:47:24,559
laptop could be on a phone tablet

1283
00:47:24,559 --> 00:47:26,960
um we're in knox county so i don't think

1284
00:47:26,960 --> 00:47:28,640
you have too much to worry about with ip

1285
00:47:28,640 --> 00:47:30,319
over avian carrier if we were a little

1286
00:47:30,319 --> 00:47:32,079
bit closer like monroe county might be a

1287
00:47:32,079 --> 00:47:33,920
little bit of a problem

1288
00:47:33,920 --> 00:47:36,079
i joke because my mom lives down in that

1289
00:47:36,079 --> 00:47:38,319
area and has dsl and it's awful i was

1290
00:47:38,319 --> 00:47:39,440
like

1291
00:47:39,440 --> 00:47:40,800
you got to get your neighbors to stop

1292
00:47:40,800 --> 00:47:43,200
hunting your ipo over avian carriers

1293
00:47:43,200 --> 00:47:44,319
your neighbors keep shooting your

1294
00:47:44,319 --> 00:47:46,160
carriers out of the sky

1295
00:47:46,160 --> 00:47:47,280
but anyway

1296
00:47:47,280 --> 00:47:48,960
that's that

1297
00:47:48,960 --> 00:47:51,359
if there are no questions uh thanks

1298
00:47:51,359 --> 00:47:53,359
everyone for coming out thanks for your

1299
00:47:53,359 --> 00:47:55,440
patience and uh

1300
00:47:55,440 --> 00:47:56,960
have a blast if i can be of any

1301
00:47:56,960 --> 00:47:59,040
assistance i will be in the intelligence

1302
00:47:59,040 --> 00:48:03,558
village pretty much all day thanks

1303
00:48:03,650 --> 00:48:06,269
[Applause]

