1
00:00:00,240 --> 00:00:02,560
my name is dave branscombe

2
00:00:02,560 --> 00:00:04,560
we're going to be talking about the tool

3
00:00:04,560 --> 00:00:06,080
called detect

4
00:00:06,080 --> 00:00:07,919
and how it works together with the miter

5
00:00:07,919 --> 00:00:09,920
attack framework to help you get a

6
00:00:09,920 --> 00:00:11,840
better understanding

7
00:00:11,840 --> 00:00:14,719
of your logging in your environment and

8
00:00:14,719 --> 00:00:17,039
what you'll be able to identify as

9
00:00:17,039 --> 00:00:21,359
attacker behavior in your environment

10
00:00:21,359 --> 00:00:23,199
so

11
00:00:23,199 --> 00:00:25,199
this is me

12
00:00:25,199 --> 00:00:27,359
so i do work for microsoft i work in

13
00:00:27,359 --> 00:00:28,640
what's called the global partner

14
00:00:28,640 --> 00:00:30,720
solutions group i'm a security

15
00:00:30,720 --> 00:00:34,480
compliance identity and now management

16
00:00:34,480 --> 00:00:37,440
lead so it's now skim

17
00:00:37,440 --> 00:00:38,879
i've been at microsoft for about 14

18
00:00:38,879 --> 00:00:40,800
years i live in raleigh

19
00:00:40,800 --> 00:00:42,399
and you're welcome to come back connect

20
00:00:42,399 --> 00:00:43,840
with me on linkedin are there any

21
00:00:43,840 --> 00:00:45,600
microsoft partners here i'm sure some of

22
00:00:45,600 --> 00:00:47,920
you are microsoft partners

23
00:00:47,920 --> 00:00:50,079
okay so so we work with microsoft

24
00:00:50,079 --> 00:00:51,680
partners to train them on the security

25
00:00:51,680 --> 00:00:53,840
tools that are available

26
00:00:53,840 --> 00:00:55,760
i'm going to try to make this

27
00:00:55,760 --> 00:00:58,640
as vendor neutral as i can but i will

28
00:00:58,640 --> 00:01:00,399
tell you how some of the things work

29
00:01:00,399 --> 00:01:02,879
with microsoft stuff

30
00:01:02,879 --> 00:01:04,239
all right so let's talk first about

31
00:01:04,239 --> 00:01:06,320
attack the the miter attack framework

32
00:01:06,320 --> 00:01:07,680
and probably most of you are already

33
00:01:07,680 --> 00:01:09,119
familiar with this

34
00:01:09,119 --> 00:01:12,560
to a certain extent

35
00:01:12,560 --> 00:01:14,960
mitre attack was developed by the mitre

36
00:01:14,960 --> 00:01:17,600
corporation back in 2013

37
00:01:17,600 --> 00:01:19,680
and the the reason behind it was they

38
00:01:19,680 --> 00:01:22,000
wanted to document some of the common

39
00:01:22,000 --> 00:01:24,560
tactics techniques and sub-techniques

40
00:01:24,560 --> 00:01:26,560
that are being used

41
00:01:26,560 --> 00:01:29,520
by advanced persistent threats

42
00:01:29,520 --> 00:01:31,119
to attack

43
00:01:31,119 --> 00:01:33,200
windows and and other enterprise

44
00:01:33,200 --> 00:01:34,560
networks

45
00:01:34,560 --> 00:01:36,479
so it was really created out of a need

46
00:01:36,479 --> 00:01:38,560
to document a couple different things

47
00:01:38,560 --> 00:01:42,479
that didn't exist in other frameworks so

48
00:01:42,479 --> 00:01:44,880
uh there there are other frameworks

49
00:01:44,880 --> 00:01:47,439
lockheed's got a a kill chain framework

50
00:01:47,439 --> 00:01:49,840
and and there's other ones you can use

51
00:01:49,840 --> 00:01:52,159
but there's something unique about mitre

52
00:01:52,159 --> 00:01:53,520
attack

53
00:01:53,520 --> 00:01:55,200
when you compare it to those other

54
00:01:55,200 --> 00:01:57,119
frameworks

55
00:01:57,119 --> 00:01:58,479
so

56
00:01:58,479 --> 00:02:01,200
first of all it was addressing four

57
00:02:01,200 --> 00:02:03,600
primary issues number one was

58
00:02:03,600 --> 00:02:06,399
identifying adversary behaviors

59
00:02:06,399 --> 00:02:07,840
so

60
00:02:07,840 --> 00:02:09,038
typically

61
00:02:09,038 --> 00:02:11,760
one of the or some of the things that um

62
00:02:11,760 --> 00:02:14,000
uh threat hunters would look for are

63
00:02:14,000 --> 00:02:16,319
things like common domains that

64
00:02:16,319 --> 00:02:19,599
attackers are using or ip addresses or

65
00:02:19,599 --> 00:02:22,480
file hashes things like that

66
00:02:22,480 --> 00:02:24,319
but the problem with that obviously is

67
00:02:24,319 --> 00:02:26,160
that that's easily changeable right an

68
00:02:26,160 --> 00:02:27,760
attacker can change domains they can

69
00:02:27,760 --> 00:02:30,160
change ip addresses at the blink of an

70
00:02:30,160 --> 00:02:32,800
eye they can automate it

71
00:02:32,800 --> 00:02:35,440
so we wanted to look and or mitre wanted

72
00:02:35,440 --> 00:02:37,760
to look and see how do we identify the

73
00:02:37,760 --> 00:02:40,000
behavior rather than the specific

74
00:02:40,000 --> 00:02:42,000
indicator right

75
00:02:42,000 --> 00:02:43,200
secondly

76
00:02:43,200 --> 00:02:46,560
as i mentioned there were other

77
00:02:46,560 --> 00:02:49,680
adversary models or life cycle models

78
00:02:49,680 --> 00:02:51,840
that didn't really fit into what we're

79
00:02:51,840 --> 00:02:53,840
trying to do

80
00:02:53,840 --> 00:02:54,800
so

81
00:02:54,800 --> 00:02:57,440
the cyber kill chain concepts were maybe

82
00:02:57,440 --> 00:02:59,680
a little bit too high level two too

83
00:02:59,680 --> 00:03:01,120
abstract

84
00:03:01,120 --> 00:03:02,239
and so

85
00:03:02,239 --> 00:03:05,120
the miter attack framework was designed

86
00:03:05,120 --> 00:03:06,080
to

87
00:03:06,080 --> 00:03:07,920
give very specific

88
00:03:07,920 --> 00:03:10,560
behaviors to look for and how those

89
00:03:10,560 --> 00:03:14,560
behaviors were performed by an adversary

90
00:03:14,560 --> 00:03:16,080
it needed to be applicable to real

91
00:03:16,080 --> 00:03:18,879
environments so this is

92
00:03:18,879 --> 00:03:21,040
what we see in the attack framework is

93
00:03:21,040 --> 00:03:23,680
what we actually see in the wild these

94
00:03:23,680 --> 00:03:25,680
are things that adversaries are actively

95
00:03:25,680 --> 00:03:26,640
using

96
00:03:26,640 --> 00:03:29,280
and it becomes more real world to us

97
00:03:29,280 --> 00:03:31,760
rather than kind of a theoretical

98
00:03:31,760 --> 00:03:32,959
concept

99
00:03:32,959 --> 00:03:34,799
and then the last one which is not a

100
00:03:34,799 --> 00:03:37,920
trivial issue is common text i can't

101
00:03:37,920 --> 00:03:40,319
read that

102
00:03:41,840 --> 00:03:44,560
speak up okay

103
00:03:44,560 --> 00:03:46,799
so we want to have a common taxonomy so

104
00:03:46,799 --> 00:03:49,599
so think about a scenario where you are

105
00:03:49,599 --> 00:03:51,440
um you're managing your enterprise

106
00:03:51,440 --> 00:03:53,040
environment

107
00:03:53,040 --> 00:03:54,799
and in that enterprise environment you

108
00:03:54,799 --> 00:03:57,280
identify that you've been breached

109
00:03:57,280 --> 00:03:59,760
so you call in mandiant you call in

110
00:03:59,760 --> 00:04:02,159
microsoft you call in the fbi whoever

111
00:04:02,159 --> 00:04:05,280
right they come in and you may have two

112
00:04:05,280 --> 00:04:08,400
different ways of describing the same

113
00:04:08,400 --> 00:04:10,400
type of behavior you may have two

114
00:04:10,400 --> 00:04:13,120
different ways of identifying where the

115
00:04:13,120 --> 00:04:14,799
attacker is

116
00:04:14,799 --> 00:04:16,720
in the breach

117
00:04:16,720 --> 00:04:19,358
and so the mitre attack framework gives

118
00:04:19,358 --> 00:04:22,160
everybody a common taxonomy we all know

119
00:04:22,160 --> 00:04:24,960
what reconnaissance is made up of we all

120
00:04:24,960 --> 00:04:27,520
know what initial access is made up of

121
00:04:27,520 --> 00:04:30,080
we know what persistence is made up of

122
00:04:30,080 --> 00:04:31,040
and so

123
00:04:31,040 --> 00:04:32,479
these different groups that have to

124
00:04:32,479 --> 00:04:34,720
communicate about an attack

125
00:04:34,720 --> 00:04:36,960
can use this common framework

126
00:04:36,960 --> 00:04:38,960
for communicating

127
00:04:38,960 --> 00:04:41,600
the the aspects of the attack so attack

128
00:04:41,600 --> 00:04:43,360
stands for adversarial tactics

129
00:04:43,360 --> 00:04:45,280
techniques and common knowledge

130
00:04:45,280 --> 00:04:47,120
and if uh uh

131
00:04:47,120 --> 00:04:50,000
the the the way it's made up if you've

132
00:04:50,000 --> 00:04:51,280
seen the attack framework and i'll show

133
00:04:51,280 --> 00:04:53,919
you here in just a few minutes

134
00:04:53,919 --> 00:04:56,479
oh i forgot to check uh wi-fi but we'll

135
00:04:56,479 --> 00:05:00,240
see um so one of the things that uh that

136
00:05:00,240 --> 00:05:01,520
you're trying to identify are the

137
00:05:01,520 --> 00:05:02,880
tactics and the techniques and the

138
00:05:02,880 --> 00:05:04,639
difference between tactics and

139
00:05:04,639 --> 00:05:08,080
techniques is a tactic is identifying

140
00:05:08,080 --> 00:05:10,880
why an attacker did something what are

141
00:05:10,880 --> 00:05:12,880
they trying to to do

142
00:05:12,880 --> 00:05:14,720
when they um

143
00:05:14,720 --> 00:05:15,440
are

144
00:05:15,440 --> 00:05:17,759
performing these actions so

145
00:05:17,759 --> 00:05:20,560
maybe their their goal is persistence in

146
00:05:20,560 --> 00:05:22,639
your network maybe their goal is

147
00:05:22,639 --> 00:05:25,840
exfiltration of data that's the why part

148
00:05:25,840 --> 00:05:27,199
the technique

149
00:05:27,199 --> 00:05:28,479
describes

150
00:05:28,479 --> 00:05:30,560
how they're going to accomplish that

151
00:05:30,560 --> 00:05:32,560
right so if they're trying to establish

152
00:05:32,560 --> 00:05:36,000
persistence maybe they

153
00:05:36,000 --> 00:05:38,160
change your startup folder maybe they

154
00:05:38,160 --> 00:05:41,280
modify registry keys that's the how of

155
00:05:41,280 --> 00:05:43,120
what they're trying to accomplish so

156
00:05:43,120 --> 00:05:44,720
that's the tactics and techniques part

157
00:05:44,720 --> 00:05:47,120
of it um just for those of you that may

158
00:05:47,120 --> 00:05:49,199
be curious or are going to be taking

159
00:05:49,199 --> 00:05:50,320
pictures

160
00:05:50,320 --> 00:05:52,000
there's a link at the end of the deck

161
00:05:52,000 --> 00:05:54,080
where you can download the entire deck

162
00:05:54,080 --> 00:05:54,960
and and

163
00:05:54,960 --> 00:05:57,600
you're welcome to it

164
00:05:57,600 --> 00:06:00,160
um so in microsoft tools the this is the

165
00:06:00,160 --> 00:06:02,560
you know the sales pitch thing right so

166
00:06:02,560 --> 00:06:04,960
um in the uh the different microsoft

167
00:06:04,960 --> 00:06:06,560
threat hunting tools

168
00:06:06,560 --> 00:06:08,479
miter attack is becoming more and more

169
00:06:08,479 --> 00:06:10,479
prominent in in how we

170
00:06:10,479 --> 00:06:12,880
talk about adversary behavior so if

171
00:06:12,880 --> 00:06:15,039
you're using sentinel or if you're

172
00:06:15,039 --> 00:06:17,520
looking at sentinel in the hunting blade

173
00:06:17,520 --> 00:06:19,360
you see in the in the red box those are

174
00:06:19,360 --> 00:06:20,880
the um

175
00:06:20,880 --> 00:06:22,479
the the miter

176
00:06:22,479 --> 00:06:26,400
tactics that are identifiable uh using

177
00:06:26,400 --> 00:06:30,560
different uh queries and and so on

178
00:06:30,560 --> 00:06:32,080
if you're using microsoft defender for

179
00:06:32,080 --> 00:06:34,800
endpoint our endpoint protection tool

180
00:06:34,800 --> 00:06:37,520
it will identify miter attack techniques

181
00:06:37,520 --> 00:06:39,919
in the specific alert so you get an

182
00:06:39,919 --> 00:06:42,080
alert on one of your endpoints you can

183
00:06:42,080 --> 00:06:44,160
go in and find out

184
00:06:44,160 --> 00:06:46,880
what tactic what technique is being

185
00:06:46,880 --> 00:06:50,800
leveraged by the attacker

186
00:06:51,520 --> 00:06:52,880
if you're using microsoft defender for

187
00:06:52,880 --> 00:06:54,319
cloud what we used to call azure

188
00:06:54,319 --> 00:06:56,319
security center it's available in the

189
00:06:56,319 --> 00:06:59,520
resource health so it'll tell you

190
00:06:59,520 --> 00:07:01,360
what what

191
00:07:01,360 --> 00:07:03,120
it gives you recommendations about what

192
00:07:03,120 --> 00:07:05,360
needs to be changed and

193
00:07:05,360 --> 00:07:07,520
why in other words what type of

194
00:07:07,520 --> 00:07:09,520
adversary behavior would you be

195
00:07:09,520 --> 00:07:10,960
preventing

196
00:07:10,960 --> 00:07:13,199
by making these recommendations by

197
00:07:13,199 --> 00:07:14,840
performing these

198
00:07:14,840 --> 00:07:17,360
recommendations so i said uh

199
00:07:17,360 --> 00:07:18,960
you know that the the mitre attack

200
00:07:18,960 --> 00:07:20,720
framework is a matrix this is what it

201
00:07:20,720 --> 00:07:23,199
looks like so along the top those are

202
00:07:23,199 --> 00:07:25,280
the tactics right and it may be a little

203
00:07:25,280 --> 00:07:27,759
bit hard to read but uh you have initial

204
00:07:27,759 --> 00:07:30,000
access execution persistence privilege

205
00:07:30,000 --> 00:07:32,240
escalation and so on and then underneath

206
00:07:32,240 --> 00:07:35,440
those are your techniques so how the

207
00:07:35,440 --> 00:07:36,960
adversary

208
00:07:36,960 --> 00:07:39,599
achieves that objective and some of them

209
00:07:39,599 --> 00:07:42,000
you see have a like a little gray

210
00:07:42,000 --> 00:07:43,840
box beside them that just means that

211
00:07:43,840 --> 00:07:46,160
they're expandable in other words

212
00:07:46,160 --> 00:07:49,360
as as an example uh on the on the far

213
00:07:49,360 --> 00:07:52,639
far left side here in the middle uh the

214
00:07:52,639 --> 00:07:55,360
the gray box is talking about fishing so

215
00:07:55,360 --> 00:07:57,280
the sub techniques for that might be

216
00:07:57,280 --> 00:07:58,720
spearfishing

217
00:07:58,720 --> 00:08:00,720
you know and things like that so so it's

218
00:08:00,720 --> 00:08:01,759
giving you

219
00:08:01,759 --> 00:08:04,560
more specific types of behavior that an

220
00:08:04,560 --> 00:08:07,199
adversary might use to to accomplish

221
00:08:07,199 --> 00:08:10,360
their goal

222
00:08:12,400 --> 00:08:15,280
there are different matrices in attack

223
00:08:15,280 --> 00:08:18,000
for different types of environments so

224
00:08:18,000 --> 00:08:19,919
it was originally designed with windows

225
00:08:19,919 --> 00:08:21,280
in mind

226
00:08:21,280 --> 00:08:24,080
but it has since expanded to cover

227
00:08:24,080 --> 00:08:28,479
mobile os's linux mac os cloud platforms

228
00:08:28,479 --> 00:08:33,760
like office 365 azure ad google

229
00:08:33,760 --> 00:08:36,320
you see here an example of office 365

230
00:08:36,320 --> 00:08:37,599
and you can see that there's obviously a

231
00:08:37,599 --> 00:08:40,320
difference right in in the the number of

232
00:08:40,320 --> 00:08:42,719
tactics or the number of techniques

233
00:08:42,719 --> 00:08:44,959
available to an attacker

234
00:08:44,959 --> 00:08:48,480
in office 365 versus on a windows

235
00:08:48,480 --> 00:08:51,200
machine that they can you know

236
00:08:51,200 --> 00:08:54,399
do a lot more stuff on

237
00:08:54,399 --> 00:08:57,519
recently they also released version 11

238
00:08:57,519 --> 00:09:00,399
of the ics

239
00:09:00,399 --> 00:09:02,560
attack framework so for industrial

240
00:09:02,560 --> 00:09:04,080
control systems

241
00:09:04,080 --> 00:09:05,279
they have

242
00:09:05,279 --> 00:09:08,160
an attack framework as well

243
00:09:08,160 --> 00:09:10,720
so what else is in attack

244
00:09:10,720 --> 00:09:13,440
you can use attack when you when you dig

245
00:09:13,440 --> 00:09:15,600
into it there's different

246
00:09:15,600 --> 00:09:18,560
tools or or capabilities within it

247
00:09:18,560 --> 00:09:20,480
that can help you to identify who the

248
00:09:20,480 --> 00:09:22,959
adversaries are what type of behaviors

249
00:09:22,959 --> 00:09:24,720
they might be engaged in

250
00:09:24,720 --> 00:09:27,200
and and all this is going to play into

251
00:09:27,200 --> 00:09:29,920
later on we want to identify

252
00:09:29,920 --> 00:09:32,800
am i logging the right things

253
00:09:32,800 --> 00:09:33,519
for

254
00:09:33,519 --> 00:09:36,240
the adversaries i'm trying to defend

255
00:09:36,240 --> 00:09:37,839
against

256
00:09:37,839 --> 00:09:38,800
okay

257
00:09:38,800 --> 00:09:40,399
so in this case

258
00:09:40,399 --> 00:09:42,800
you can look up different threat groups

259
00:09:42,800 --> 00:09:45,040
what i've shown here is uh the cobalt

260
00:09:45,040 --> 00:09:46,399
group

261
00:09:46,399 --> 00:09:48,160
so the cobalt group

262
00:09:48,160 --> 00:09:50,399
is also identified as

263
00:09:50,399 --> 00:09:52,640
gold kingswood they're known as the

264
00:09:52,640 --> 00:09:55,360
cobalt gang cobalt spider

265
00:09:55,360 --> 00:09:57,279
it's it's good to know

266
00:09:57,279 --> 00:09:59,600
when these groups are linked together or

267
00:09:59,600 --> 00:10:01,519
or that they they have similar tactics

268
00:10:01,519 --> 00:10:03,600
because then your coverage for your

269
00:10:03,600 --> 00:10:04,720
logging

270
00:10:04,720 --> 00:10:05,600
can

271
00:10:05,600 --> 00:10:07,760
cover the attack techniques for for a

272
00:10:07,760 --> 00:10:09,920
variety of different attackers

273
00:10:09,920 --> 00:10:12,720
it also sometimes will give you

274
00:10:12,720 --> 00:10:14,160
attribution

275
00:10:14,160 --> 00:10:16,640
so what country is involved or if it's

276
00:10:16,640 --> 00:10:19,760
just a cyber criminal gang that's kind

277
00:10:19,760 --> 00:10:22,000
of a hard one right attribution is not

278
00:10:22,000 --> 00:10:24,240
always the easiest thing to to provide

279
00:10:24,240 --> 00:10:24,959
but

280
00:10:24,959 --> 00:10:26,480
sometimes they're pretty certain that

281
00:10:26,480 --> 00:10:28,240
it's an iranian act or a russian or

282
00:10:28,240 --> 00:10:30,480
chinese actor and they'll they'll call

283
00:10:30,480 --> 00:10:32,959
that out but the thing that that's

284
00:10:32,959 --> 00:10:34,800
important here is that they'll also

285
00:10:34,800 --> 00:10:36,399
identify

286
00:10:36,399 --> 00:10:39,279
who typical targets have been

287
00:10:39,279 --> 00:10:40,640
so

288
00:10:40,640 --> 00:10:42,959
if you're in the energy sector if you're

289
00:10:42,959 --> 00:10:44,839
a government agency if you're a

290
00:10:44,839 --> 00:10:47,680
non-profit sometimes they'll call out

291
00:10:47,680 --> 00:10:49,760
those industries as being particularly

292
00:10:49,760 --> 00:10:52,640
targeted by those groups and that can

293
00:10:52,640 --> 00:10:54,240
help you to frame

294
00:10:54,240 --> 00:10:56,959
and and shape the way that you do your

295
00:10:56,959 --> 00:10:59,360
logging in your environment if you know

296
00:10:59,360 --> 00:11:01,760
that these are the types of attacks that

297
00:11:01,760 --> 00:11:04,079
are being performed against your type of

298
00:11:04,079 --> 00:11:06,640
industry

299
00:11:07,279 --> 00:11:08,880
somebody have a question thought i heard

300
00:11:08,880 --> 00:11:09,920
somebody

301
00:11:09,920 --> 00:11:11,920
okay incidentally if you ask a really

302
00:11:11,920 --> 00:11:15,519
good question i got prizes um

303
00:11:15,519 --> 00:11:18,160
all the hands go up no

304
00:11:18,160 --> 00:11:19,839
all right so so let's take a quick look

305
00:11:19,839 --> 00:11:23,120
at the attack framework

306
00:11:23,120 --> 00:11:26,160
and hopefully my

307
00:11:26,720 --> 00:11:28,640
yeah i don't have a browser

308
00:11:28,640 --> 00:11:31,040
let me fix this real quick

309
00:11:31,040 --> 00:11:33,040
um what's the uh

310
00:11:33,040 --> 00:11:35,680
the wireless here i'm sorry i

311
00:11:35,680 --> 00:11:38,560
i meant to ask

312
00:11:40,320 --> 00:11:42,800
relics variety yes that works uh yeah

313
00:11:42,800 --> 00:11:44,480
you can connect them i don't need

314
00:11:44,480 --> 00:11:46,800
anything super intensive just to make

315
00:11:46,800 --> 00:11:49,760
sure this works okay so this is the

316
00:11:49,760 --> 00:11:51,600
attack framework

317
00:11:51,600 --> 00:11:52,560
i'll try to make this a little bit

318
00:11:52,560 --> 00:11:55,279
bigger for you

319
00:11:55,440 --> 00:11:58,160
so as you can see um in this case

320
00:11:58,160 --> 00:12:00,399
uh if we want to take a look for example

321
00:12:00,399 --> 00:12:02,240
at persistence persistence is a is a

322
00:12:02,240 --> 00:12:04,880
pretty common one to take a look at

323
00:12:04,880 --> 00:12:07,279
so it gives you ideas about the way that

324
00:12:07,279 --> 00:12:09,760
an attacker will achieve persistence so

325
00:12:09,760 --> 00:12:11,279
maybe they'll manipulate an account

326
00:12:11,279 --> 00:12:14,079
they'll they'll escalate privileges from

327
00:12:14,079 --> 00:12:15,519
from one account to another or they'll

328
00:12:15,519 --> 00:12:18,000
move from one account to another

329
00:12:18,000 --> 00:12:19,120
maybe they'll

330
00:12:19,120 --> 00:12:20,720
change a login script or an

331
00:12:20,720 --> 00:12:22,720
initialization script

332
00:12:22,720 --> 00:12:24,720
they might create or modify a system

333
00:12:24,720 --> 00:12:26,880
process and now if we click on the gray

334
00:12:26,880 --> 00:12:30,079
bar here it tells us some of the things

335
00:12:30,079 --> 00:12:32,399
that fall under that system process

336
00:12:32,399 --> 00:12:35,120
capability so some of this is linux

337
00:12:35,120 --> 00:12:38,560
based some of it's windows based right

338
00:12:38,560 --> 00:12:40,800
and if we

339
00:12:40,800 --> 00:12:42,480
you can also look in each of these

340
00:12:42,480 --> 00:12:43,839
individual

341
00:12:43,839 --> 00:12:46,480
well great

342
00:12:46,800 --> 00:12:49,920
i thought that was working

343
00:12:51,360 --> 00:12:55,160
i apologize folks

344
00:13:09,600 --> 00:13:12,639
oh i spelled it wrong

345
00:13:12,639 --> 00:13:14,800
all right don't worry about it um what

346
00:13:14,800 --> 00:13:16,880
you can do i'll i'll get this this setup

347
00:13:16,880 --> 00:13:20,839
right here in a second

348
00:13:36,959 --> 00:13:38,639
there we go okay

349
00:13:38,639 --> 00:13:40,800
so

350
00:13:41,279 --> 00:13:43,120
if we look at

351
00:13:43,120 --> 00:13:44,720
the

352
00:13:44,720 --> 00:13:47,720
whoops

353
00:13:50,880 --> 00:13:52,959
up here along the top

354
00:13:52,959 --> 00:13:54,240
so remember i was talking about the

355
00:13:54,240 --> 00:13:56,880
groups so you can look at groups here

356
00:13:56,880 --> 00:13:59,519
and you can find the different

357
00:13:59,519 --> 00:14:02,000
adversary groups listed here so if we

358
00:14:02,000 --> 00:14:03,839
want to look at back door diplomacy for

359
00:14:03,839 --> 00:14:05,760
example so here it tells us that

360
00:14:05,760 --> 00:14:07,199
backdoor diplomacy has targeted

361
00:14:07,199 --> 00:14:09,440
ministries of foreign affairs telecom

362
00:14:09,440 --> 00:14:11,920
community companies in africa europe the

363
00:14:11,920 --> 00:14:14,160
middle east and asia

364
00:14:14,160 --> 00:14:16,320
tells us some of the techniques that are

365
00:14:16,320 --> 00:14:20,720
commonly used by backdoor diplomacy

366
00:14:20,720 --> 00:14:22,240
some of the software that they're known

367
00:14:22,240 --> 00:14:24,160
to use mini cats and

368
00:14:24,160 --> 00:14:27,120
quasar rat and so on right so so we can

369
00:14:27,120 --> 00:14:28,800
go ahead and look at those

370
00:14:28,800 --> 00:14:31,199
and then if we go to different tactics

371
00:14:31,199 --> 00:14:33,440
then the tactics tell us how they

372
00:14:33,440 --> 00:14:36,000
accomplish these things right so how

373
00:14:36,000 --> 00:14:38,480
they perform this what the mitigations

374
00:14:38,480 --> 00:14:41,360
are and how you detect these things all

375
00:14:41,360 --> 00:14:44,800
these pieces come into play with detect

376
00:14:44,800 --> 00:14:48,240
so detect again is designed to show you

377
00:14:48,240 --> 00:14:51,199
where you have gaps in your logging

378
00:14:51,199 --> 00:14:52,639
that would help you to identify

379
00:14:52,639 --> 00:14:55,120
attackers okay

380
00:14:55,120 --> 00:14:58,480
so let's pop back into the the deck here

381
00:14:58,480 --> 00:15:00,800
and

382
00:15:02,800 --> 00:15:05,120
all right

383
00:15:05,760 --> 00:15:07,839
so just an example the the techniques

384
00:15:07,839 --> 00:15:09,680
and sub techniques uh here again you

385
00:15:09,680 --> 00:15:11,839
have the the fishing example with

386
00:15:11,839 --> 00:15:13,600
spearfishing attachments spearfishing

387
00:15:13,600 --> 00:15:16,320
link spearfishing via service it tells

388
00:15:16,320 --> 00:15:18,480
you

389
00:15:18,800 --> 00:15:20,560
the sub techniques but it also tells you

390
00:15:20,560 --> 00:15:22,800
which platforms may be vulnerable to

391
00:15:22,800 --> 00:15:25,279
this type of of an attack so in this

392
00:15:25,279 --> 00:15:28,880
case google workspace linux office 365

393
00:15:28,880 --> 00:15:31,279
kind of everything

394
00:15:31,279 --> 00:15:32,800
then the procedure examples and the

395
00:15:32,800 --> 00:15:34,720
mitigations as we were talking about

396
00:15:34,720 --> 00:15:36,720
shows you how an attacker performs this

397
00:15:36,720 --> 00:15:39,040
type of attack what software they may

398
00:15:39,040 --> 00:15:40,399
have been using

399
00:15:40,399 --> 00:15:42,399
to perform this attack and then again

400
00:15:42,399 --> 00:15:45,680
the mitigations so mitigations are you

401
00:15:45,680 --> 00:15:47,839
know kind of iffy sometimes that they're

402
00:15:47,839 --> 00:15:49,839
very generic like in this case you know

403
00:15:49,839 --> 00:15:52,720
use antivirus and malware all right well

404
00:15:52,720 --> 00:15:54,320
probably most people are already using

405
00:15:54,320 --> 00:15:56,800
that but it didn't catch it so

406
00:15:56,800 --> 00:15:58,800
you might have to find some other ways

407
00:15:58,800 --> 00:16:02,399
of preventing this

408
00:16:02,399 --> 00:16:04,959
the detections are the important part

409
00:16:04,959 --> 00:16:07,600
so with detections

410
00:16:07,600 --> 00:16:10,320
all this information about attackers all

411
00:16:10,320 --> 00:16:11,920
the information about the techniques

412
00:16:11,920 --> 00:16:14,399
that they use the tactics that they use

413
00:16:14,399 --> 00:16:17,040
none of it matters if you can't see them

414
00:16:17,040 --> 00:16:18,079
right

415
00:16:18,079 --> 00:16:20,399
if they're just operating in in

416
00:16:20,399 --> 00:16:22,720
under an invisibility cloak

417
00:16:22,720 --> 00:16:24,720
that's that's no good to you to to know

418
00:16:24,720 --> 00:16:26,399
all the stuff that they might be doing

419
00:16:26,399 --> 00:16:28,399
right you want to know how they're doing

420
00:16:28,399 --> 00:16:32,000
it and how do i identify it so detection

421
00:16:32,000 --> 00:16:34,160
um in the miter attack framework is what

422
00:16:34,160 --> 00:16:37,040
we're going to key in on with the detect

423
00:16:37,040 --> 00:16:38,959
tool

424
00:16:38,959 --> 00:16:40,880
so what is detect

425
00:16:40,880 --> 00:16:43,839
so detect is an open source tool

426
00:16:43,839 --> 00:16:46,000
and it's designed to help you i

427
00:16:46,000 --> 00:16:47,360
understand

428
00:16:47,360 --> 00:16:48,959
the quality

429
00:16:48,959 --> 00:16:51,680
the visibility the coverage

430
00:16:51,680 --> 00:16:54,560
and help you to identify specific threat

431
00:16:54,560 --> 00:16:56,240
actor behaviors

432
00:16:56,240 --> 00:16:58,880
it's made up of a python tool some yaml

433
00:16:58,880 --> 00:17:01,279
administration files

434
00:17:01,279 --> 00:17:03,360
the detect editor is just a web browser

435
00:17:03,360 --> 00:17:05,599
interface and then what we call scoring

436
00:17:05,599 --> 00:17:07,039
tables

437
00:17:07,039 --> 00:17:07,919
so

438
00:17:07,919 --> 00:17:10,799
in this deck i have step by step exactly

439
00:17:10,799 --> 00:17:12,959
how to set this up

440
00:17:12,959 --> 00:17:15,599
i set this up on a brand new machine

441
00:17:15,599 --> 00:17:18,640
last night on this on this laptop

442
00:17:18,640 --> 00:17:20,400
starting from

443
00:17:20,400 --> 00:17:23,119
building my my hyper-v vm it was a

444
00:17:23,119 --> 00:17:24,880
windows 10 vm

445
00:17:24,880 --> 00:17:26,559
to the time that it was functional was

446
00:17:26,559 --> 00:17:28,799
about an hour and 15 minutes so and then

447
00:17:28,799 --> 00:17:31,360
most of that was installing the os right

448
00:17:31,360 --> 00:17:33,440
so it's not complicated and if you

449
00:17:33,440 --> 00:17:36,720
follow this step by step it will work

450
00:17:36,720 --> 00:17:38,960
i've done it several times just to

451
00:17:38,960 --> 00:17:41,200
confirm that i haven't missed any steps

452
00:17:41,200 --> 00:17:43,520
or overlooked anything

453
00:17:43,520 --> 00:17:45,360
so what it gives you in the end is

454
00:17:45,360 --> 00:17:46,799
something like this

455
00:17:46,799 --> 00:17:48,559
it gives you a heat map

456
00:17:48,559 --> 00:17:51,360
of where your logging is good and where

457
00:17:51,360 --> 00:17:53,760
your logging needs to be shored up

458
00:17:53,760 --> 00:17:56,240
to detect certain types of behaviors

459
00:17:56,240 --> 00:17:57,039
right

460
00:17:57,039 --> 00:17:57,760
so

461
00:17:57,760 --> 00:17:59,840
where where you see the the the color

462
00:17:59,840 --> 00:18:02,000
coding is white that means you have no

463
00:18:02,000 --> 00:18:04,400
logging visibility for that specific

464
00:18:04,400 --> 00:18:06,640
technique where it's dark purple and in

465
00:18:06,640 --> 00:18:08,640
this case where it's dark purple it

466
00:18:08,640 --> 00:18:10,799
tells you that you've got good logging

467
00:18:10,799 --> 00:18:13,520
you're very likely to identify this type

468
00:18:13,520 --> 00:18:15,679
of technique it doesn't

469
00:18:15,679 --> 00:18:17,600
write queries or anything for you it's

470
00:18:17,600 --> 00:18:19,919
just telling you you've got good enough

471
00:18:19,919 --> 00:18:21,600
logging that you should be able to

472
00:18:21,600 --> 00:18:23,919
identify this type of thing

473
00:18:23,919 --> 00:18:26,000
if you're looking for it right that make

474
00:18:26,000 --> 00:18:28,240
sense

475
00:18:28,240 --> 00:18:29,360
okay

476
00:18:29,360 --> 00:18:31,120
so you might say

477
00:18:31,120 --> 00:18:33,440
wait a minute i have looked in sentinel

478
00:18:33,440 --> 00:18:34,640
isn't there something like that in

479
00:18:34,640 --> 00:18:35,760
sentinel

480
00:18:35,760 --> 00:18:38,799
and the answer is kind of

481
00:18:38,799 --> 00:18:40,799
so there is a

482
00:18:40,799 --> 00:18:43,440
a form of a heat map in sentinel that

483
00:18:43,440 --> 00:18:44,799
does this

484
00:18:44,799 --> 00:18:48,080
but what it's looking at is do you have

485
00:18:48,080 --> 00:18:50,799
a rule an analytic rule

486
00:18:50,799 --> 00:18:54,000
that looks for this type of behavior

487
00:18:54,000 --> 00:18:56,080
it's not telling you whether the logging

488
00:18:56,080 --> 00:18:58,960
that you're ingesting is good

489
00:18:58,960 --> 00:19:01,440
it's telling you do i have a rule that

490
00:19:01,440 --> 00:19:02,960
looks for this

491
00:19:02,960 --> 00:19:03,919
okay

492
00:19:03,919 --> 00:19:05,200
so

493
00:19:05,200 --> 00:19:07,520
this is valuable up to a point

494
00:19:07,520 --> 00:19:09,600
but what if you're you want to go to

495
00:19:09,600 --> 00:19:11,120
your boss and you're trying to make a

496
00:19:11,120 --> 00:19:12,240
case for

497
00:19:12,240 --> 00:19:13,039
um

498
00:19:13,039 --> 00:19:14,880
you know you have to

499
00:19:14,880 --> 00:19:16,320
buy more storage you have to buy a

500
00:19:16,320 --> 00:19:18,559
different tool for logging what if

501
00:19:18,559 --> 00:19:20,000
scenarios

502
00:19:20,000 --> 00:19:22,799
detect is much better at providing you

503
00:19:22,799 --> 00:19:25,360
that sort of information

504
00:19:25,360 --> 00:19:27,679
that will allow you to make your case

505
00:19:27,679 --> 00:19:30,080
right so

506
00:19:30,080 --> 00:19:32,240
yeah sentinel has some stuff but it's

507
00:19:32,240 --> 00:19:33,679
not uh

508
00:19:33,679 --> 00:19:35,679
in my opinion it's not quite as good as

509
00:19:35,679 --> 00:19:37,200
detect

510
00:19:37,200 --> 00:19:38,880
and you didn't hear that from me and it

511
00:19:38,880 --> 00:19:41,280
should be edited out

512
00:19:41,280 --> 00:19:43,039
all right so installing detect on

513
00:19:43,039 --> 00:19:45,440
windows the this is the the step-by-step

514
00:19:45,440 --> 00:19:46,880
stuff i know you're not going to be able

515
00:19:46,880 --> 00:19:48,960
to read it it's some of it's a little

516
00:19:48,960 --> 00:19:51,679
bit small on the slide again download

517
00:19:51,679 --> 00:19:53,600
the slides there's a link at the end of

518
00:19:53,600 --> 00:19:55,520
the deck

519
00:19:55,520 --> 00:19:58,080
and and i promise you it'll work so

520
00:19:58,080 --> 00:19:59,760
again i start off with a brand new

521
00:19:59,760 --> 00:20:01,919
windows 10 vm

522
00:20:01,919 --> 00:20:04,159
on my laptop you install the windows

523
00:20:04,159 --> 00:20:07,120
subsystem for linux that'll give you an

524
00:20:07,120 --> 00:20:11,039
ubuntu environment on your windows vm

525
00:20:11,039 --> 00:20:13,200
so the way you install it is this wsl

526
00:20:13,200 --> 00:20:16,400
dash dash install dash d ubuntu

527
00:20:16,400 --> 00:20:18,400
you restart your machine

528
00:20:18,400 --> 00:20:19,840
one thing you have to keep in mind if

529
00:20:19,840 --> 00:20:23,520
you're if you're doing this on a vm

530
00:20:23,520 --> 00:20:25,600
as i was

531
00:20:25,600 --> 00:20:28,480
you may have to configure what we call

532
00:20:28,480 --> 00:20:31,039
nested virtualization

533
00:20:31,039 --> 00:20:32,559
so essentially what you're trying to do

534
00:20:32,559 --> 00:20:34,640
is is on your vm

535
00:20:34,640 --> 00:20:36,159
you've got a virtual machine and you're

536
00:20:36,159 --> 00:20:38,000
creating another virtual machine inside

537
00:20:38,000 --> 00:20:40,799
it okay that's the nested part

538
00:20:40,799 --> 00:20:42,960
so you have to

539
00:20:42,960 --> 00:20:45,679
configure these the extensions

540
00:20:45,679 --> 00:20:47,440
using the

541
00:20:47,440 --> 00:20:49,360
the powershell commandlet there that

542
00:20:49,360 --> 00:20:51,679
will allow you to configure or that

543
00:20:51,679 --> 00:20:53,360
allow you to run this virtual

544
00:20:53,360 --> 00:20:55,440
environment for ubuntu inside your

545
00:20:55,440 --> 00:20:57,600
virtual environment for windows make

546
00:20:57,600 --> 00:20:58,960
make sense

547
00:20:58,960 --> 00:21:00,240
okay

548
00:21:00,240 --> 00:21:02,400
once you log in again the ubuntu

549
00:21:02,400 --> 00:21:03,760
environment will come back up it'll ask

550
00:21:03,760 --> 00:21:05,600
you for a username and password if

551
00:21:05,600 --> 00:21:07,520
you've only worked in windows make sure

552
00:21:07,520 --> 00:21:09,120
you remember

553
00:21:09,120 --> 00:21:11,280
linux does not like capital letters

554
00:21:11,280 --> 00:21:13,679
right so you have to use lowercase

555
00:21:13,679 --> 00:21:15,280
letters you know you can you can use

556
00:21:15,280 --> 00:21:17,200
whatever name you need it doesn't have

557
00:21:17,200 --> 00:21:18,960
to relate in any way

558
00:21:18,960 --> 00:21:20,960
to the windows machine that it's running

559
00:21:20,960 --> 00:21:24,080
on right it can be john it can be detect

560
00:21:24,080 --> 00:21:26,080
whatever

561
00:21:26,080 --> 00:21:28,640
but set up the username and password

562
00:21:28,640 --> 00:21:31,120
good practice is to update your distro

563
00:21:31,120 --> 00:21:34,640
so use a sudo apt to update and sudo apt

564
00:21:34,640 --> 00:21:37,440
upgrade that'll get your distribution up

565
00:21:37,440 --> 00:21:39,679
to or your distro up to

566
00:21:39,679 --> 00:21:42,880
the latest uh latest and greatest

567
00:21:42,880 --> 00:21:45,039
then what you do is you go in

568
00:21:45,039 --> 00:21:48,320
so detect is stored up on github so you

569
00:21:48,320 --> 00:21:50,720
need to clone the github repository down

570
00:21:50,720 --> 00:21:53,760
to that ubuntu distro and that's the the

571
00:21:53,760 --> 00:21:55,600
command to do it it's a pretty simple

572
00:21:55,600 --> 00:21:58,080
thing that's that's the entirety of what

573
00:21:58,080 --> 00:22:00,080
it shows you on your screen

574
00:22:00,080 --> 00:22:02,559
and then you've got the files from the

575
00:22:02,559 --> 00:22:07,200
github repository in the ubuntu distro

576
00:22:07,200 --> 00:22:08,240
from there

577
00:22:08,240 --> 00:22:10,240
you're going to cd into the detect

578
00:22:10,240 --> 00:22:11,440
directory

579
00:22:11,440 --> 00:22:13,280
and you're going to install the python

580
00:22:13,280 --> 00:22:14,640
environment

581
00:22:14,640 --> 00:22:16,080
and the the steps for installing that

582
00:22:16,080 --> 00:22:18,000
python environment are there

583
00:22:18,000 --> 00:22:19,760
the last thing that you that you might

584
00:22:19,760 --> 00:22:21,360
want to do is run this last command

585
00:22:21,360 --> 00:22:23,440
python detect.py

586
00:22:23,440 --> 00:22:25,760
and that'll just give you the syntax for

587
00:22:25,760 --> 00:22:28,240
the detect script right so

588
00:22:28,240 --> 00:22:29,840
it's not going to do anything amazing

589
00:22:29,840 --> 00:22:30,880
when you do that it's just going to give

590
00:22:30,880 --> 00:22:32,559
you syntax but that'll tell you that

591
00:22:32,559 --> 00:22:33,919
everything's installed correctly and

592
00:22:33,919 --> 00:22:36,240
ready to go

593
00:22:36,240 --> 00:22:40,080
again this part probably took 15 minutes

594
00:22:40,080 --> 00:22:44,080
right it's it's not that complicated

595
00:22:44,080 --> 00:22:45,919
so once it's installed

596
00:22:45,919 --> 00:22:49,440
you can uh start using the detect script

597
00:22:49,440 --> 00:22:50,960
to

598
00:22:50,960 --> 00:22:54,240
do detecty things right so one of the

599
00:22:54,240 --> 00:22:55,840
the easy things to do

600
00:22:55,840 --> 00:22:59,200
is run this python detect.py generic ds

601
00:22:59,200 --> 00:23:00,559
and that'll give you information about

602
00:23:00,559 --> 00:23:04,159
data sources so what data sources

603
00:23:04,159 --> 00:23:06,080
are are interesting in your environment

604
00:23:06,080 --> 00:23:08,480
or where do you get the most visibility

605
00:23:08,480 --> 00:23:11,120
so as you look at this

606
00:23:11,120 --> 00:23:12,880
and again it might be hard to read from

607
00:23:12,880 --> 00:23:15,200
from back in the back but like the the

608
00:23:15,200 --> 00:23:17,039
top uh listed

609
00:23:17,039 --> 00:23:20,559
data source is command execution

610
00:23:20,559 --> 00:23:23,200
and it says it shows up 255 times in

611
00:23:23,200 --> 00:23:24,320
detect

612
00:23:24,320 --> 00:23:25,919
so

613
00:23:25,919 --> 00:23:27,440
one thing that you don't want to do is

614
00:23:27,440 --> 00:23:28,960
make the mistake of believing that

615
00:23:28,960 --> 00:23:30,559
anything that's low

616
00:23:30,559 --> 00:23:32,400
on this list or or that has fewer

617
00:23:32,400 --> 00:23:34,960
instances of the list on the list that

618
00:23:34,960 --> 00:23:36,480
it's not important

619
00:23:36,480 --> 00:23:38,960
right that's not the case just because

620
00:23:38,960 --> 00:23:41,520
something only has a few instances

621
00:23:41,520 --> 00:23:43,360
may only mean that there's only a few

622
00:23:43,360 --> 00:23:45,120
ways to do something but it could be

623
00:23:45,120 --> 00:23:46,880
something that's very bad

624
00:23:46,880 --> 00:23:48,000
so

625
00:23:48,000 --> 00:23:50,480
don't don't view this as a ranking it's

626
00:23:50,480 --> 00:23:53,679
just giving you um an idea of how many

627
00:23:53,679 --> 00:23:56,240
times this data source shows up in in

628
00:23:56,240 --> 00:23:58,880
the attack framework

629
00:23:58,880 --> 00:24:00,880
um it's also important to know the kinds

630
00:24:00,880 --> 00:24:02,159
of data that you can get from each

631
00:24:02,159 --> 00:24:06,320
platform or service so for example

632
00:24:06,320 --> 00:24:09,679
dhcp right dacp logs are often very

633
00:24:09,679 --> 00:24:11,200
valuable

634
00:24:11,200 --> 00:24:13,200
you're not going to get dhcp logs from

635
00:24:13,200 --> 00:24:17,120
office 365 right you're not going to get

636
00:24:17,120 --> 00:24:19,120
dhcp logs from

637
00:24:19,120 --> 00:24:21,279
google workspace you will get it from

638
00:24:21,279 --> 00:24:24,640
your on-prem windows environment so this

639
00:24:24,640 --> 00:24:27,039
this table is kind of useful in just

640
00:24:27,039 --> 00:24:29,440
understanding where you can expect to

641
00:24:29,440 --> 00:24:32,080
get certain types of logs

642
00:24:32,080 --> 00:24:34,640
within your environment

643
00:24:34,640 --> 00:24:36,559
okay so what does this thing do

644
00:24:36,559 --> 00:24:38,559
how do you use it right so you've got it

645
00:24:38,559 --> 00:24:40,880
installed you've got the environment set

646
00:24:40,880 --> 00:24:42,880
up it's ready to go what do you do with

647
00:24:42,880 --> 00:24:43,679
it

648
00:24:43,679 --> 00:24:44,880
so the first thing is you open the

649
00:24:44,880 --> 00:24:47,760
detect editor the detect editor is a web

650
00:24:47,760 --> 00:24:50,240
page it's just a very simple web page

651
00:24:50,240 --> 00:24:51,840
and on that web page you're going to

652
00:24:51,840 --> 00:24:55,200
create a yaml file the yaml file is

653
00:24:55,200 --> 00:24:58,159
going to be comprised of

654
00:24:58,159 --> 00:25:00,559
your opinion

655
00:25:00,559 --> 00:25:03,200
and i emphasize this is your opinion

656
00:25:03,200 --> 00:25:06,080
of the quality of your logging okay i'll

657
00:25:06,080 --> 00:25:08,720
show you a screw a picture of that in a

658
00:25:08,720 --> 00:25:10,000
minute

659
00:25:10,000 --> 00:25:12,080
but remember this is not doing an

660
00:25:12,080 --> 00:25:13,600
automated

661
00:25:13,600 --> 00:25:16,320
evaluation of your logging it's asking

662
00:25:16,320 --> 00:25:17,120
you

663
00:25:17,120 --> 00:25:18,720
how well do you think you're doing in

664
00:25:18,720 --> 00:25:20,480
this how well are you doing as far as

665
00:25:20,480 --> 00:25:23,279
retention and then from there it applies

666
00:25:23,279 --> 00:25:25,919
that against the miter attack framework

667
00:25:25,919 --> 00:25:27,760
and gives you some information

668
00:25:27,760 --> 00:25:30,159
so once you create this yaml file

669
00:25:30,159 --> 00:25:32,320
you save it and then you need to convert

670
00:25:32,320 --> 00:25:35,039
the yaml file from from the ammo format

671
00:25:35,039 --> 00:25:38,080
into json format so attack navigator

672
00:25:38,080 --> 00:25:41,039
uses json so there's a one-line script

673
00:25:41,039 --> 00:25:43,360
that you use to convert the yaml into

674
00:25:43,360 --> 00:25:45,919
json format then you upload that json

675
00:25:45,919 --> 00:25:47,760
file into attack navigator so you can

676
00:25:47,760 --> 00:25:50,080
get the visualization

677
00:25:50,080 --> 00:25:51,840
so to run the

678
00:25:51,840 --> 00:25:53,279
editor

679
00:25:53,279 --> 00:25:54,320
it's just that

680
00:25:54,320 --> 00:25:56,960
python detect.py editor it brings up

681
00:25:56,960 --> 00:26:00,400
this webpage as you see here

682
00:26:00,400 --> 00:26:02,400
so as you as you see in the lighter blue

683
00:26:02,400 --> 00:26:04,240
you've got data sources techniques and

684
00:26:04,240 --> 00:26:05,520
groups there's different ways that you

685
00:26:05,520 --> 00:26:07,440
can evaluate your logging i'm going to

686
00:26:07,440 --> 00:26:10,640
show you how to do it with data sources

687
00:26:10,640 --> 00:26:12,320
when you open

688
00:26:12,320 --> 00:26:16,720
the the data sources page you

689
00:26:17,039 --> 00:26:20,400
initially you're going to say new file

690
00:26:20,400 --> 00:26:23,600
when you say new file you identify

691
00:26:23,600 --> 00:26:25,840
what are the logging sources that you're

692
00:26:25,840 --> 00:26:28,000
going to be evaluating am i going to be

693
00:26:28,000 --> 00:26:30,000
looking at my windows environment am i

694
00:26:30,000 --> 00:26:31,919
going to be looking at linux am i going

695
00:26:31,919 --> 00:26:33,360
to be looking at azure id am i going to

696
00:26:33,360 --> 00:26:36,320
be looking at everything

697
00:26:36,880 --> 00:26:39,840
okay so uh that's the data sources that

698
00:26:39,840 --> 00:26:41,600
you see listed in green down there

699
00:26:41,600 --> 00:26:43,360
[Music]

700
00:26:43,360 --> 00:26:45,600
and then you give it a unique name so in

701
00:26:45,600 --> 00:26:48,400
this case it's just contoso logging

702
00:26:48,400 --> 00:26:50,559
so the way that the the yaml file is

703
00:26:50,559 --> 00:26:53,200
constructed is this

704
00:26:53,200 --> 00:26:54,960
you'll add a data source over here on

705
00:26:54,960 --> 00:26:56,240
the side

706
00:26:56,240 --> 00:26:58,320
and you can either add all the data

707
00:26:58,320 --> 00:26:59,440
sources

708
00:26:59,440 --> 00:27:01,600
just automatically run through all of

709
00:27:01,600 --> 00:27:05,200
them or you can add individual

710
00:27:05,200 --> 00:27:08,640
techniques and and and data source uh

711
00:27:08,640 --> 00:27:09,919
things that are interesting to you so

712
00:27:09,919 --> 00:27:12,159
maybe you want to look at registry key

713
00:27:12,159 --> 00:27:14,080
behavior though so are they creating

714
00:27:14,080 --> 00:27:16,400
registry keys are they modifying them

715
00:27:16,400 --> 00:27:17,679
are they deleting them you can look at

716
00:27:17,679 --> 00:27:20,399
those very specific behaviors or you can

717
00:27:20,399 --> 00:27:23,600
say just give me everything

718
00:27:23,919 --> 00:27:26,799
the next thing you're going to do is say

719
00:27:26,799 --> 00:27:29,600
for that type of data source

720
00:27:29,600 --> 00:27:32,880
how good is my logging okay

721
00:27:32,880 --> 00:27:33,760
so

722
00:27:33,760 --> 00:27:35,840
down here you're gonna say uh when the

723
00:27:35,840 --> 00:27:38,320
logging source was was connected

724
00:27:38,320 --> 00:27:40,720
and then um when it was enabled is it

725
00:27:40,720 --> 00:27:43,120
available for data analytics

726
00:27:43,120 --> 00:27:44,960
but this is the part that that makes up

727
00:27:44,960 --> 00:27:45,679
the

728
00:27:45,679 --> 00:27:47,440
uh the the bulk of what you're going to

729
00:27:47,440 --> 00:27:48,399
do

730
00:27:48,399 --> 00:27:50,159
you're going to evaluate the data source

731
00:27:50,159 --> 00:27:52,320
according to the completeness

732
00:27:52,320 --> 00:27:54,000
of the logging

733
00:27:54,000 --> 00:27:57,279
the timeliness the retention the quality

734
00:27:57,279 --> 00:28:00,000
of the log so you kind of have to know

735
00:28:00,000 --> 00:28:02,399
about your environment in order to fill

736
00:28:02,399 --> 00:28:04,799
this out right so so if you know you're

737
00:28:04,799 --> 00:28:06,240
not logging

738
00:28:06,240 --> 00:28:07,600
um

739
00:28:07,600 --> 00:28:09,919
you know your iis servers right if you

740
00:28:09,919 --> 00:28:11,120
know you're not capturing any of that

741
00:28:11,120 --> 00:28:13,120
log and then dumping it into your sim

742
00:28:13,120 --> 00:28:15,279
then you'd put the the the slider far

743
00:28:15,279 --> 00:28:17,440
down right you don't have uh good

744
00:28:17,440 --> 00:28:18,960
logging in that on the other hand if

745
00:28:18,960 --> 00:28:20,720
you're capturing all the logs from your

746
00:28:20,720 --> 00:28:23,440
domain controllers then maybe you'd bump

747
00:28:23,440 --> 00:28:25,520
the the slider up uh

748
00:28:25,520 --> 00:28:27,600
further to the right

749
00:28:27,600 --> 00:28:29,279
and you'll go through all the different

750
00:28:29,279 --> 00:28:32,159
data sources and evaluate

751
00:28:32,159 --> 00:28:34,399
those what is the five

752
00:28:34,399 --> 00:28:38,959
characteristics of the the data

753
00:28:40,480 --> 00:28:42,080
next you're going to

754
00:28:42,080 --> 00:28:45,279
save the yaml file

755
00:28:45,279 --> 00:28:47,120
which is just this little button down

756
00:28:47,120 --> 00:28:49,279
here save yaml file

757
00:28:49,279 --> 00:28:50,960
and then the next step is you want to

758
00:28:50,960 --> 00:28:54,559
convert that yaml file into json format

759
00:28:54,559 --> 00:28:56,880
to convert it into json format

760
00:28:56,880 --> 00:28:58,960
again because you're using the detect

761
00:28:58,960 --> 00:29:01,679
tool and the detect tool had started the

762
00:29:01,679 --> 00:29:04,880
editor the the web page you need to stop

763
00:29:04,880 --> 00:29:07,200
that so you do control c to stop the

764
00:29:07,200 --> 00:29:09,679
editor so you can kind of shift gears

765
00:29:09,679 --> 00:29:10,880
and run the script that does the

766
00:29:10,880 --> 00:29:14,399
conversion of the yaml file into json

767
00:29:14,399 --> 00:29:17,360
and that's the the the command that you

768
00:29:17,360 --> 00:29:19,039
run

769
00:29:19,039 --> 00:29:20,559
and what it's going to do is it's going

770
00:29:20,559 --> 00:29:23,200
to take that json file

771
00:29:23,200 --> 00:29:25,039
and it's going to put it

772
00:29:25,039 --> 00:29:26,640
in a directory

773
00:29:26,640 --> 00:29:29,600
on your ubuntu system

774
00:29:29,600 --> 00:29:31,760
okay so now you've got this file that

775
00:29:31,760 --> 00:29:33,039
you need

776
00:29:33,039 --> 00:29:34,559
on ubuntu

777
00:29:34,559 --> 00:29:35,520
and

778
00:29:35,520 --> 00:29:37,200
you need to get it out of that system

779
00:29:37,200 --> 00:29:40,559
into windows so that you can do stuff

780
00:29:40,559 --> 00:29:42,240
with it

781
00:29:42,240 --> 00:29:45,440
so the way that you do that is as you

782
00:29:45,440 --> 00:29:48,399
see here

783
00:29:49,279 --> 00:29:52,159
if you go to this whack wsl dollar sign

784
00:29:52,159 --> 00:29:53,760
in file explorer

785
00:29:53,760 --> 00:29:56,320
that is windows subsystem for linux and

786
00:29:56,320 --> 00:29:58,320
that allows you to browse directly into

787
00:29:58,320 --> 00:30:00,559
that ubuntu subsystem

788
00:30:00,559 --> 00:30:02,399
and from there you browse to the

789
00:30:02,399 --> 00:30:03,919
directory where

790
00:30:03,919 --> 00:30:06,720
that file has been stored and just copy

791
00:30:06,720 --> 00:30:08,559
it right over to your windows system and

792
00:30:08,559 --> 00:30:10,000
then you can upload it into attack

793
00:30:10,000 --> 00:30:11,840
navigator

794
00:30:11,840 --> 00:30:14,399
make sense

795
00:30:15,279 --> 00:30:16,720
and if you want to run the editor again

796
00:30:16,720 --> 00:30:19,679
the the web page you just run the that

797
00:30:19,679 --> 00:30:20,720
same

798
00:30:20,720 --> 00:30:23,679
command python detect.py editor

799
00:30:23,679 --> 00:30:26,080
okay so now you've got this json file

800
00:30:26,080 --> 00:30:27,840
it's in your windows system or if you're

801
00:30:27,840 --> 00:30:29,360
using mac whatever it doesn't really

802
00:30:29,360 --> 00:30:31,279
matter

803
00:30:31,279 --> 00:30:33,600
you go to the attack navigator page

804
00:30:33,600 --> 00:30:36,159
and as you see here you're going to go

805
00:30:36,159 --> 00:30:39,679
to um open upload from local

806
00:30:39,679 --> 00:30:41,760
and then you find that json file that

807
00:30:41,760 --> 00:30:44,320
you copied out of your ubuntu system you

808
00:30:44,320 --> 00:30:46,640
upload it into attack navigator and you

809
00:30:46,640 --> 00:30:48,080
get this

810
00:30:48,080 --> 00:30:51,039
okay so now it's telling you these are

811
00:30:51,039 --> 00:30:53,440
the data sources that you're logging for

812
00:30:53,440 --> 00:30:55,039
or or based on the data sources that

813
00:30:55,039 --> 00:30:56,480
you're logging for

814
00:30:56,480 --> 00:30:58,720
these are the different techniques

815
00:30:58,720 --> 00:31:00,480
that you can identify

816
00:31:00,480 --> 00:31:01,760
and

817
00:31:01,760 --> 00:31:03,200
it can kind of give you an idea of the

818
00:31:03,200 --> 00:31:05,039
likelihood that you'll identify these

819
00:31:05,039 --> 00:31:07,600
techniques based on the the the heat of

820
00:31:07,600 --> 00:31:10,399
the color right

821
00:31:10,399 --> 00:31:12,000
so that's not the only thing you can do

822
00:31:12,000 --> 00:31:13,760
however

823
00:31:13,760 --> 00:31:14,720
so

824
00:31:14,720 --> 00:31:17,440
you can export the data to excel

825
00:31:17,440 --> 00:31:19,919
so for example if you want to

826
00:31:19,919 --> 00:31:22,320
store this data and and have kind of a

827
00:31:22,320 --> 00:31:24,559
running history of how well you've

828
00:31:24,559 --> 00:31:27,279
improved the data sources or the logging

829
00:31:27,279 --> 00:31:30,000
in your environment you can run this

830
00:31:30,000 --> 00:31:32,880
detect tool periodically

831
00:31:32,880 --> 00:31:35,279
and identify areas where you've improved

832
00:31:35,279 --> 00:31:37,360
your logging and it can kind of just be

833
00:31:37,360 --> 00:31:38,080
a

834
00:31:38,080 --> 00:31:41,439
you know an improvement catalog

835
00:31:42,320 --> 00:31:44,720
you can also be very specific about the

836
00:31:44,720 --> 00:31:47,120
things that you're looking for

837
00:31:47,120 --> 00:31:49,120
with detect so

838
00:31:49,120 --> 00:31:50,640
one of the things is identifying your

839
00:31:50,640 --> 00:31:52,320
logging coverage against all major

840
00:31:52,320 --> 00:31:54,720
threat groups so

841
00:31:54,720 --> 00:31:56,799
based on the logging that i have right

842
00:31:56,799 --> 00:31:58,880
now

843
00:31:58,880 --> 00:32:01,279
how am i doing against the major threat

844
00:32:01,279 --> 00:32:05,039
groups that are identified in attack

845
00:32:05,039 --> 00:32:07,039
right and so it'll give you

846
00:32:07,039 --> 00:32:09,519
a sense of whether or not your logging

847
00:32:09,519 --> 00:32:11,279
is good to detect

848
00:32:11,279 --> 00:32:14,480
that type of behavior

849
00:32:14,480 --> 00:32:16,399
if you're interested in specific threat

850
00:32:16,399 --> 00:32:18,480
groups so in this case

851
00:32:18,480 --> 00:32:19,760
we care about

852
00:32:19,760 --> 00:32:22,320
fin 7 and the cobalt group

853
00:32:22,320 --> 00:32:24,640
so maybe those are or attack groups that

854
00:32:24,640 --> 00:32:25,600
you know

855
00:32:25,600 --> 00:32:27,120
are targeting your industry maybe you're

856
00:32:27,120 --> 00:32:28,480
in the financial industry

857
00:32:28,480 --> 00:32:29,760
and you know that those are people that

858
00:32:29,760 --> 00:32:32,159
you're trying to defend against

859
00:32:32,159 --> 00:32:34,480
so maybe you want to say

860
00:32:34,480 --> 00:32:37,279
okay based on the way that they act

861
00:32:37,279 --> 00:32:40,159
show me how my logging compares to their

862
00:32:40,159 --> 00:32:41,360
tactics

863
00:32:41,360 --> 00:32:45,199
right and it'll give you a comparison

864
00:32:46,799 --> 00:32:49,840
as you see here

865
00:32:49,840 --> 00:32:52,559
it tells you which threat groups

866
00:32:52,559 --> 00:32:56,279
you're comparing against

867
00:32:56,880 --> 00:32:59,840
you can also get a very comprehensive uh

868
00:32:59,840 --> 00:33:02,720
coverage so so where is your visibility

869
00:33:02,720 --> 00:33:04,799
and where is your coverage

870
00:33:04,799 --> 00:33:08,559
um or where you know maybe both right

871
00:33:08,559 --> 00:33:10,480
so let's take a quick look and hopefully

872
00:33:10,480 --> 00:33:13,600
my vm didn't crash in the meantime but

873
00:33:13,600 --> 00:33:15,039
but i'll show you what this kind of

874
00:33:15,039 --> 00:33:17,600
looks like

875
00:33:19,679 --> 00:33:22,000
okay

876
00:33:22,799 --> 00:33:25,360
so this is the the the

877
00:33:25,360 --> 00:33:27,760
detect editor

878
00:33:27,760 --> 00:33:29,919
i go into data sources well i'll start

879
00:33:29,919 --> 00:33:31,039
at home there

880
00:33:31,039 --> 00:33:34,080
so i go into data sources

881
00:33:34,080 --> 00:33:36,240
in this case i'll say new

882
00:33:36,240 --> 00:33:38,159
i'm going to name it i'll call it

883
00:33:38,159 --> 00:33:39,919
b-sides

884
00:33:39,919 --> 00:33:41,760
nox

885
00:33:41,760 --> 00:33:43,440
here's where identify the platforms that

886
00:33:43,440 --> 00:33:47,519
i'm interested in so i'll say windows

887
00:33:47,919 --> 00:33:52,360
and i'll say add data source

888
00:33:52,399 --> 00:33:54,080
add applicable

889
00:33:54,080 --> 00:33:57,120
i'll say the date it registered was

890
00:33:57,120 --> 00:33:59,279
january 1st

891
00:33:59,279 --> 00:34:02,559
date it was connected was

892
00:34:02,559 --> 00:34:04,720
january 2nd

893
00:34:04,720 --> 00:34:06,559
yes yes

894
00:34:06,559 --> 00:34:08,320
and then down here is where i'm

895
00:34:08,320 --> 00:34:11,119
identifying the data quality right

896
00:34:11,119 --> 00:34:12,239
so

897
00:34:12,239 --> 00:34:14,239
what i'm looking at here

898
00:34:14,239 --> 00:34:16,079
is i'm

899
00:34:16,079 --> 00:34:18,399
i'm identifying this for all the data

900
00:34:18,399 --> 00:34:19,520
sources

901
00:34:19,520 --> 00:34:22,159
that uh that are possible

902
00:34:22,159 --> 00:34:24,399
so i can say

903
00:34:24,399 --> 00:34:25,760
you know maybe my data field

904
00:34:25,760 --> 00:34:27,520
completeness so so data field

905
00:34:27,520 --> 00:34:30,639
completeness think about this

906
00:34:31,119 --> 00:34:32,560
just because you're logging something in

907
00:34:32,560 --> 00:34:33,918
windows doesn't mean you're logging

908
00:34:33,918 --> 00:34:35,918
everything you can for that specific

909
00:34:35,918 --> 00:34:37,040
event

910
00:34:37,040 --> 00:34:38,159
right

911
00:34:38,159 --> 00:34:39,280
so

912
00:34:39,280 --> 00:34:41,440
command line execution

913
00:34:41,440 --> 00:34:42,800
you may be able to capture that with

914
00:34:42,800 --> 00:34:44,560
sysmon

915
00:34:44,560 --> 00:34:46,320
but it's not captured by default in

916
00:34:46,320 --> 00:34:48,560
windows so you might say i'm not

917
00:34:48,560 --> 00:34:51,040
capturing all the data i should

918
00:34:51,040 --> 00:34:53,440
for this type of event

919
00:34:53,440 --> 00:34:55,359
and so i need to improve that so we'll

920
00:34:55,359 --> 00:34:56,719
say it's good

921
00:34:56,719 --> 00:34:58,720
consistency you know i'm getting it for

922
00:34:58,720 --> 00:35:00,720
about fifty percent of the machines

923
00:35:00,720 --> 00:35:03,119
timeliness pretty good

924
00:35:03,119 --> 00:35:06,560
we get the logs every day and retention

925
00:35:06,560 --> 00:35:08,720
we're storing it pretty well

926
00:35:08,720 --> 00:35:09,920
okay

927
00:35:09,920 --> 00:35:11,040
so now

928
00:35:11,040 --> 00:35:13,200
i go back here and hopefully this will

929
00:35:13,200 --> 00:35:17,280
work right so save the ammo file

930
00:35:17,280 --> 00:35:19,280
now what's happened is the yaml file has

931
00:35:19,280 --> 00:35:22,800
been saved here's my detect editor

932
00:35:22,800 --> 00:35:24,560
you see i ran the the command once

933
00:35:24,560 --> 00:35:25,839
before

934
00:35:25,839 --> 00:35:29,799
but we'll run it again

935
00:35:30,720 --> 00:35:33,440
okay so it gave me this output of a json

936
00:35:33,440 --> 00:35:36,079
file so all i did was convert the yaml

937
00:35:36,079 --> 00:35:37,920
file into json

938
00:35:37,920 --> 00:35:39,839
now i have this json file that i need to

939
00:35:39,839 --> 00:35:42,000
get over into windows so that i can work

940
00:35:42,000 --> 00:35:43,040
with it

941
00:35:43,040 --> 00:35:46,240
so whack whack wsl dollar sign

942
00:35:46,240 --> 00:35:48,880
it prompts me ubuntu is the share

943
00:35:48,880 --> 00:35:51,200
then i go to home

944
00:35:51,200 --> 00:35:53,759
detect

945
00:35:53,920 --> 00:35:55,200
detect

946
00:35:55,200 --> 00:35:56,400
output

947
00:35:56,400 --> 00:35:59,040
and b sides two is the json file i just

948
00:35:59,040 --> 00:36:00,720
copy it

949
00:36:00,720 --> 00:36:03,919
over to my c drive

950
00:36:04,560 --> 00:36:09,040
now i go over to the attack navigator

951
00:36:09,119 --> 00:36:11,359
let's kill this

952
00:36:11,359 --> 00:36:13,599
do open existing layer

953
00:36:13,599 --> 00:36:16,079
upload from local

954
00:36:16,079 --> 00:36:17,280
and maybe i did this right maybe i

955
00:36:17,280 --> 00:36:19,599
didn't wrong i'm not sure we'll see

956
00:36:19,599 --> 00:36:22,000
okay so it only gives me a couple things

957
00:36:22,000 --> 00:36:24,480
that i'm uh identifying in this case so

958
00:36:24,480 --> 00:36:26,720
i can i can find pass the hash pass the

959
00:36:26,720 --> 00:36:30,480
ticket type of attacks um any any uh uh

960
00:36:30,480 --> 00:36:32,079
some

961
00:36:32,079 --> 00:36:34,000
you know it's it's clear i've got some

962
00:36:34,000 --> 00:36:35,839
work to do in my logging right that's

963
00:36:35,839 --> 00:36:37,680
that's the key but it's giving you an

964
00:36:37,680 --> 00:36:40,400
idea of where you can start

965
00:36:40,400 --> 00:36:41,119
with

966
00:36:41,119 --> 00:36:42,960
with identifying the logs that are

967
00:36:42,960 --> 00:36:45,839
necessary so again this is very very

968
00:36:45,839 --> 00:36:47,440
easy to set up

969
00:36:47,440 --> 00:36:49,040
i set it up on a vm i could just as

970
00:36:49,040 --> 00:36:50,800
easily have set it up on my on my

971
00:36:50,800 --> 00:36:52,320
machine but i don't want to mess it up

972
00:36:52,320 --> 00:36:54,480
and microsoft would probably scream if

973
00:36:54,480 --> 00:36:58,240
they saw me installing linux

974
00:36:58,640 --> 00:37:00,320
okay

975
00:37:00,320 --> 00:37:02,560
so to kind of wrap things up what does

976
00:37:02,560 --> 00:37:04,800
detect allow you to do it lets you score

977
00:37:04,800 --> 00:37:06,960
the quality of your data sources

978
00:37:06,960 --> 00:37:08,720
you get insight on the detection

979
00:37:08,720 --> 00:37:10,640
visibility that you have

980
00:37:10,640 --> 00:37:13,119
you can map your detection coverage

981
00:37:13,119 --> 00:37:16,320
map your coverage versus a threat actors

982
00:37:16,320 --> 00:37:17,520
behaviors

983
00:37:17,520 --> 00:37:19,119
and it can identify areas for

984
00:37:19,119 --> 00:37:21,280
improvement in your logging so you can

985
00:37:21,280 --> 00:37:22,800
increase your chances of threat

986
00:37:22,800 --> 00:37:24,079
detection

987
00:37:24,079 --> 00:37:27,119
so there's some good resources here

988
00:37:27,119 --> 00:37:30,160
this guy rob roberto rodriguez

989
00:37:30,160 --> 00:37:32,800
he's his

990
00:37:32,800 --> 00:37:35,040
twitter his cyber war dog he actually

991
00:37:35,040 --> 00:37:36,640
works for microsoft now he's in the

992
00:37:36,640 --> 00:37:39,200
mystic threat hunters team

993
00:37:39,200 --> 00:37:41,520
he's got some really really good

994
00:37:41,520 --> 00:37:44,240
miter attack framework models that he's

995
00:37:44,240 --> 00:37:45,280
created

996
00:37:45,280 --> 00:37:48,560
so he's pretty interesting to to follow

997
00:37:48,560 --> 00:37:50,320
and then if you want the deck that's

998
00:37:50,320 --> 00:37:53,440
where it is right now so ak.ms besides

999
00:37:53,440 --> 00:37:55,839
knox

1000
00:37:58,160 --> 00:38:01,160
questions

1001
00:38:04,000 --> 00:38:05,599
of get those data points on where you're

1002
00:38:05,599 --> 00:38:07,200
laughing in detection

1003
00:38:07,200 --> 00:38:09,200
is there any way or like any possible

1004
00:38:09,200 --> 00:38:11,839
addition into like identifying what what

1005
00:38:11,839 --> 00:38:14,880
is the most important organization

1006
00:38:14,880 --> 00:38:18,359
now or is

1007
00:38:18,560 --> 00:38:20,160
uh you mean like prioritizing which

1008
00:38:20,160 --> 00:38:23,599
things you should tackle first um

1009
00:38:23,599 --> 00:38:25,920
so

1010
00:38:26,640 --> 00:38:29,599
the question was once you identify

1011
00:38:29,599 --> 00:38:32,160
the gaps in your logging how do you

1012
00:38:32,160 --> 00:38:35,359
prioritize where you should start

1013
00:38:35,359 --> 00:38:37,599
and and and really that that's a that's

1014
00:38:37,599 --> 00:38:39,200
a little bit of a tricky question i i

1015
00:38:39,200 --> 00:38:40,720
would first start with saying what are

1016
00:38:40,720 --> 00:38:42,720
the things you most want to protect

1017
00:38:42,720 --> 00:38:44,720
right and if you don't have logging for

1018
00:38:44,720 --> 00:38:46,480
those then clearly that's that's one of

1019
00:38:46,480 --> 00:38:48,160
the first things you should do

1020
00:38:48,160 --> 00:38:50,240
um

1021
00:38:50,240 --> 00:38:51,839
but but yeah it's it

1022
00:38:51,839 --> 00:38:53,280
there is going to be some art and

1023
00:38:53,280 --> 00:38:55,680
science to that kind of combined uh by

1024
00:38:55,680 --> 00:38:57,920
the way here's your

1025
00:38:57,920 --> 00:38:59,680
prize um

1026
00:38:59,680 --> 00:39:01,839
so

1027
00:39:02,079 --> 00:39:05,200
there are some articles that

1028
00:39:05,200 --> 00:39:07,920
you can find on microsoft.com about

1029
00:39:07,920 --> 00:39:09,599
things that you absolutely should be

1030
00:39:09,599 --> 00:39:10,720
logging

1031
00:39:10,720 --> 00:39:13,280
you know at a bare minimum

1032
00:39:13,280 --> 00:39:15,839
i don't have a link to them on this but

1033
00:39:15,839 --> 00:39:17,839
but those are things i would start with

1034
00:39:17,839 --> 00:39:19,440
and then kind of branch out from there

1035
00:39:19,440 --> 00:39:20,720
you know

1036
00:39:20,720 --> 00:39:22,720
what are the

1037
00:39:22,720 --> 00:39:24,720
what are the most important but also

1038
00:39:24,720 --> 00:39:27,200
what are the most prevalent

1039
00:39:27,200 --> 00:39:29,280
machines you know you have one linux

1040
00:39:29,280 --> 00:39:31,839
machine or do you have 10 000 right so

1041
00:39:31,839 --> 00:39:33,200
so kind of figure out

1042
00:39:33,200 --> 00:39:37,359
which ones uh expose you the most

1043
00:39:37,599 --> 00:39:38,960
uh

1044
00:39:38,960 --> 00:39:40,970
oh yeah go ahead

1045
00:39:40,970 --> 00:39:50,149
[Music]

1046
00:39:56,480 --> 00:39:57,599
i mean there's

1047
00:39:57,599 --> 00:39:58,960
so so the question is are there any

1048
00:39:58,960 --> 00:40:00,240
other offensive

1049
00:40:00,240 --> 00:40:01,839
uh

1050
00:40:01,839 --> 00:40:04,560
frameworks that are on our radar

1051
00:40:04,560 --> 00:40:06,799
um

1052
00:40:07,040 --> 00:40:09,520
honestly i i i i don't have anything

1053
00:40:09,520 --> 00:40:11,839
specifically uh this is one that we're

1054
00:40:11,839 --> 00:40:13,599
focusing on with microsoft just because

1055
00:40:13,599 --> 00:40:16,400
it's kind of industry standard and is

1056
00:40:16,400 --> 00:40:18,640
well known so so that's where we're

1057
00:40:18,640 --> 00:40:21,839
putting a lot of our attention

1058
00:40:21,839 --> 00:40:22,640
uh

1059
00:40:22,640 --> 00:40:25,839
let's go here

1060
00:40:28,079 --> 00:40:31,280
this looks uh useful

1061
00:40:31,280 --> 00:40:32,880
i'm having real trouble hearing i'm

1062
00:40:32,880 --> 00:40:35,119
sorry

1063
00:40:37,440 --> 00:40:39,359
if you um gave this assessment to

1064
00:40:39,359 --> 00:40:41,280
different people on your team guarantee

1065
00:40:41,280 --> 00:40:44,920
you'd get different results

1066
00:40:53,040 --> 00:40:54,880
[Laughter]

1067
00:40:54,880 --> 00:40:56,240
how do you keep people from lying

1068
00:40:56,240 --> 00:41:00,040
basically is a question

1069
00:41:08,319 --> 00:41:10,000
i'll agree with you so so the statement

1070
00:41:10,000 --> 00:41:10,880
is

1071
00:41:10,880 --> 00:41:13,839
how good can or how valuable can this be

1072
00:41:13,839 --> 00:41:15,760
if it's based on your opinion

1073
00:41:15,760 --> 00:41:17,200
and the answer is

1074
00:41:17,200 --> 00:41:18,640
you know absolutely that's correct right

1075
00:41:18,640 --> 00:41:21,599
so so you have to be um

1076
00:41:21,599 --> 00:41:23,200
very clinical in the way that you

1077
00:41:23,200 --> 00:41:26,720
evaluate your your logs right you

1078
00:41:26,720 --> 00:41:27,839
this isn't something that you

1079
00:41:27,839 --> 00:41:30,079
necessarily have to show your boss right

1080
00:41:30,079 --> 00:41:32,319
this is kind of an evaluation of your

1081
00:41:32,319 --> 00:41:34,240
own environment and you want your

1082
00:41:34,240 --> 00:41:36,240
environment to be good

1083
00:41:36,240 --> 00:41:37,440
so

1084
00:41:37,440 --> 00:41:39,119
you know lying about it doesn't help

1085
00:41:39,119 --> 00:41:41,040
anybody

1086
00:41:41,040 --> 00:41:42,800
that's not a good answer i understand

1087
00:41:42,800 --> 00:41:44,880
but uh but yeah maybe using some kind of

1088
00:41:44,880 --> 00:41:46,880
a common information model to say you

1089
00:41:46,880 --> 00:41:48,079
know these are things that must be

1090
00:41:48,079 --> 00:41:50,160
logged

1091
00:41:50,160 --> 00:41:52,079
that might be one way to do it but but

1092
00:41:52,079 --> 00:41:54,240
it's kind of informational more than you

1093
00:41:54,240 --> 00:41:56,880
know a a real tool that you would use to

1094
00:41:56,880 --> 00:41:59,680
prove something in your environment i i

1095
00:41:59,680 --> 00:42:01,440
get what you're saying but

1096
00:42:01,440 --> 00:42:02,960
i don't have a good answer

1097
00:42:02,960 --> 00:42:05,280
ready

1098
00:42:06,079 --> 00:42:08,400
any other questions i'm out of toys yes

1099
00:42:08,400 --> 00:42:11,400
ma'am

1100
00:42:30,400 --> 00:42:33,400
um

1101
00:42:49,040 --> 00:42:52,160
i'm sorry i i literally heard very very

1102
00:42:52,160 --> 00:42:54,800
very very little of that i it's very

1103
00:42:54,800 --> 00:42:56,079
echoey

1104
00:42:56,079 --> 00:42:59,079
um

1105
00:43:01,280 --> 00:43:04,000
i i i can't hear i'm sorry

1106
00:43:04,000 --> 00:43:05,359
come on up here so that's what i can

1107
00:43:05,359 --> 00:43:08,359
hear

1108
00:43:16,880 --> 00:43:18,640
okay

1109
00:43:18,640 --> 00:43:21,739
[Music]

1110
00:43:39,359 --> 00:43:42,359
is

1111
00:44:02,000 --> 00:44:04,319
um

1112
00:44:04,720 --> 00:44:06,720
again i didn't catch everything that you

1113
00:44:06,720 --> 00:44:08,800
were saying there but uh

1114
00:44:08,800 --> 00:44:11,280
you're talking about the cvs framework

1115
00:44:11,280 --> 00:44:14,319
and and asking for a comparison so so i

1116
00:44:14,319 --> 00:44:16,800
i honestly can't truthfully say i've

1117
00:44:16,800 --> 00:44:18,800
done a comparison between them so i

1118
00:44:18,800 --> 00:44:20,240
don't know that i could give you a good

1119
00:44:20,240 --> 00:44:22,640
answer

1120
00:44:25,760 --> 00:44:27,920
i think the the the the one of the

1121
00:44:27,920 --> 00:44:29,920
advantages that i see in this and maybe

1122
00:44:29,920 --> 00:44:32,720
cbs has the same same advantage this is

1123
00:44:32,720 --> 00:44:34,400
open source it's free right you can

1124
00:44:34,400 --> 00:44:36,720
download and do it just on a vm it

1125
00:44:36,720 --> 00:44:38,160
doesn't doesn't take much time to get up

1126
00:44:38,160 --> 00:44:39,280
and running

1127
00:44:39,280 --> 00:44:42,000
is cvs free as well

1128
00:44:42,000 --> 00:44:45,000
okay

1129
00:44:58,800 --> 00:45:01,359
oh okay okay okay

1130
00:45:01,359 --> 00:45:04,240
yeah i mean

1131
00:45:04,240 --> 00:45:06,400
i i mean i'm all for any tool that will

1132
00:45:06,400 --> 00:45:07,920
help you identify weaknesses

1133
00:45:07,920 --> 00:45:10,400
vulnerabilities i'm not like like i

1134
00:45:10,400 --> 00:45:12,800
don't i don't sell this right it's just

1135
00:45:12,800 --> 00:45:14,640
it's just a thing so

1136
00:45:14,640 --> 00:45:16,640
um yeah i mean whatever works and gives

1137
00:45:16,640 --> 00:45:20,240
you the information that you need use it

1138
00:45:20,560 --> 00:45:22,800
anything else yes sir so just to be

1139
00:45:22,800 --> 00:45:25,040
clear

1140
00:45:28,560 --> 00:45:30,240
correct

1141
00:45:30,240 --> 00:45:32,720
it's just based on what you think your

1142
00:45:32,720 --> 00:45:35,680
logging is i mean some of it is is

1143
00:45:35,680 --> 00:45:37,760
verifiable like your retention

1144
00:45:37,760 --> 00:45:39,359
you know you can say i'm retaining these

1145
00:45:39,359 --> 00:45:41,440
logs or i'm not right so

1146
00:45:41,440 --> 00:45:43,040
that's that's

1147
00:45:43,040 --> 00:45:43,839
uh

1148
00:45:43,839 --> 00:45:46,000
a pretty pretty clear cut one but

1149
00:45:46,000 --> 00:45:49,760
timeliness you know what's timely

1150
00:45:52,960 --> 00:45:53,839
so

1151
00:45:53,839 --> 00:45:55,520
yeah if you if you go to the repo it'll

1152
00:45:55,520 --> 00:45:56,960
give you the the instructions for how to

1153
00:45:56,960 --> 00:45:58,720
set this up in docker

1154
00:45:58,720 --> 00:46:00,720
it's much harder to set up in docker

1155
00:46:00,720 --> 00:46:02,640
than it is here

1156
00:46:02,640 --> 00:46:03,520
so

1157
00:46:03,520 --> 00:46:04,720
if you if you're not familiar with

1158
00:46:04,720 --> 00:46:06,240
docker or you just want to get this set

1159
00:46:06,240 --> 00:46:08,960
up in 15 minutes use this

1160
00:46:08,960 --> 00:46:09,920
so

1161
00:46:09,920 --> 00:46:11,760
that's just my opinion

1162
00:46:11,760 --> 00:46:13,280
for what it's worth

1163
00:46:13,280 --> 00:46:15,440
anything else

1164
00:46:15,440 --> 00:46:17,359
oh yeah so uh

1165
00:46:17,359 --> 00:46:20,079
what's the advantage of using this

1166
00:46:20,079 --> 00:46:22,079
versus like if you have a scene that's

1167
00:46:22,079 --> 00:46:24,800
got a plug-in

1168
00:46:25,280 --> 00:46:27,119
yeah so so the question is what's what's

1169
00:46:27,119 --> 00:46:29,119
different between using this and using a

1170
00:46:29,119 --> 00:46:30,480
sim that has

1171
00:46:30,480 --> 00:46:33,359
a miter attack plug-in

1172
00:46:33,359 --> 00:46:34,640
if you have something like that that's

1173
00:46:34,640 --> 00:46:36,480
great

1174
00:46:36,480 --> 00:46:39,440
one thing again what i would ask is can

1175
00:46:39,440 --> 00:46:42,319
you do what-if scenarios with with that

1176
00:46:42,319 --> 00:46:45,359
plug-in will allow you to to model

1177
00:46:45,359 --> 00:46:47,760
um improvements in your logging

1178
00:46:47,760 --> 00:46:49,760
to um

1179
00:46:49,760 --> 00:46:52,800
to to kind of make a budget case with

1180
00:46:52,800 --> 00:46:54,839
your with your boss or

1181
00:46:54,839 --> 00:46:57,920
whatever uh when you defend the config

1182
00:46:57,920 --> 00:46:58,960
file

1183
00:46:58,960 --> 00:47:00,480
and you have the heat map you were able

1184
00:47:00,480 --> 00:47:02,160
to hover over it and it showed some

1185
00:47:02,160 --> 00:47:04,560
information does it break down based off

1186
00:47:04,560 --> 00:47:06,240
of like source by source kind of where

1187
00:47:06,240 --> 00:47:09,040
you're lacking and how it generated yeah

1188
00:47:09,040 --> 00:47:12,560
so let's take a look so the question was

1189
00:47:12,560 --> 00:47:16,480
when you see the the the heat map

1190
00:47:16,480 --> 00:47:18,160
does

1191
00:47:18,160 --> 00:47:19,440
what is some of the information it gives

1192
00:47:19,440 --> 00:47:21,760
you there

1193
00:47:21,760 --> 00:47:23,680
so

1194
00:47:23,680 --> 00:47:25,119
let's take a look at this user use

1195
00:47:25,119 --> 00:47:27,359
alternate authentication so you see what

1196
00:47:27,359 --> 00:47:29,760
uh and i know it's really really hard to

1197
00:47:29,760 --> 00:47:30,640
read

1198
00:47:30,640 --> 00:47:31,760
let's see if we can make it a little bit

1199
00:47:31,760 --> 00:47:34,079
bigger

1200
00:47:34,240 --> 00:47:36,000
let's go with phishing

1201
00:47:36,000 --> 00:47:39,240
we can't

1202
00:47:45,200 --> 00:47:46,640
so if we go with pass the hash for

1203
00:47:46,640 --> 00:47:50,240
example it tells you

1204
00:47:50,319 --> 00:47:52,319
where this state uh where this type of

1205
00:47:52,319 --> 00:47:53,680
behavior is

1206
00:47:53,680 --> 00:47:56,400
identified in your data sources

1207
00:47:56,400 --> 00:47:57,680
right so

1208
00:47:57,680 --> 00:47:58,480
um

1209
00:47:58,480 --> 00:47:59,680
you know you're gonna be looking for

1210
00:47:59,680 --> 00:48:01,119
credential requests user account

1211
00:48:01,119 --> 00:48:02,319
authentication

1212
00:48:02,319 --> 00:48:04,960
uh request log on session creation and

1213
00:48:04,960 --> 00:48:06,720
then um

1214
00:48:06,720 --> 00:48:08,960
in this particular case uh it gives you

1215
00:48:08,960 --> 00:48:10,720
an example of like what your coverage

1216
00:48:10,720 --> 00:48:12,559
level is i'm sorry i forgot it's a

1217
00:48:12,559 --> 00:48:13,870
question actually

1218
00:48:13,870 --> 00:48:16,980
[Music]

1219
00:48:19,200 --> 00:48:21,359
okay okay

1220
00:48:21,359 --> 00:48:23,440
anything else

1221
00:48:23,440 --> 00:48:25,839
hope this was useful it's a cool tool

1222
00:48:25,839 --> 00:48:26,960
it's free

1223
00:48:26,960 --> 00:48:29,200
might as well use it

1224
00:48:29,200 --> 00:48:32,359
all right

1225
00:48:32,470 --> 00:48:35,270
[Applause]

