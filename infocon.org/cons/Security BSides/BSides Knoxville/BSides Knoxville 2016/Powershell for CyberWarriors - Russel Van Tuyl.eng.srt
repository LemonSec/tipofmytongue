1
00:00:00,030 --> 00:00:03,570
hey guys if<font color="#E5E5E5"> you want to screw that</font>

2
00:00:02,100 --> 00:00:05,939
<font color="#CCCCCC">there's a lot</font><font color="#E5E5E5"> of console output you</font>

3
00:00:03,570 --> 00:00:07,140
<font color="#CCCCCC">probable to see from</font><font color="#E5E5E5"> the back</font><font color="#CCCCCC"> save you</font>

4
00:00:05,940 --> 00:00:08,519
<font color="#E5E5E5">the</font><font color="#CCCCCC"> eyestrain or you can look</font><font color="#E5E5E5"> at the</font>

5
00:00:07,140 --> 00:00:09,840
slides<font color="#E5E5E5"> later or if you don't care to see</font>

6
00:00:08,519 --> 00:00:11,849
the console<font color="#CCCCCC"> output there'll be a</font><font color="#E5E5E5"> lot of</font>

7
00:00:09,840 --> 00:00:14,969
console output<font color="#CCCCCC"> you</font><font color="#E5E5E5"> probably can't see</font>

8
00:00:11,849 --> 00:00:16,440
from<font color="#E5E5E5"> way back</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the back Eric Eric</font>

9
00:00:14,969 --> 00:00:20,580
especially if you're short like<font color="#E5E5E5"> Eric if</font>

10
00:00:16,440 --> 00:00:22,529
<font color="#E5E5E5">I want to scoot up hey guys</font><font color="#CCCCCC"> thanks for</font>

11
00:00:20,580 --> 00:00:24,180
<font color="#CCCCCC">coming out listening</font><font color="#E5E5E5"> to me talk I'm</font>

12
00:00:22,529 --> 00:00:25,619
giving<font color="#CCCCCC"> this talk kind</font><font color="#E5E5E5"> of once before at</font>

13
00:00:24,180 --> 00:00:28,349
<font color="#E5E5E5">ETSU I don't know if any of you guys are</font>

14
00:00:25,619 --> 00:00:29,519
<font color="#E5E5E5">from ETSU if you are</font><font color="#CCCCCC"> if you've</font><font color="#E5E5E5"> heard</font>

15
00:00:28,349 --> 00:00:30,869
this talk<font color="#CCCCCC"> before you</font><font color="#E5E5E5"> might want to go to</font>

16
00:00:29,519 --> 00:00:32,850
the<font color="#E5E5E5"> other one</font><font color="#CCCCCC"> because you</font><font color="#E5E5E5"> probably say</font>

17
00:00:30,869 --> 00:00:36,090
heard<font color="#E5E5E5"> of this</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> if not I got lots of</font>

18
00:00:32,850 --> 00:00:39,510
great stuff for you<font color="#E5E5E5"> in store</font><font color="#CCCCCC"> then go</font>

19
00:00:36,090 --> 00:00:41,570
<font color="#E5E5E5">over a little bit</font><font color="#CCCCCC"> about myself that's me</font>

20
00:00:39,510 --> 00:00:44,160
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> my pretty picture my glamour shot</font>

21
00:00:41,570 --> 00:00:46,079
<font color="#CCCCCC">spear</font><font color="#E5E5E5"> the analyst</font><font color="#CCCCCC"> at sword and shield</font>

22
00:00:44,160 --> 00:00:47,578
I'm also<font color="#E5E5E5"> remember the Tennessee</font><font color="#CCCCCC"> Oh</font>

23
00:00:46,079 --> 00:00:51,600
<font color="#E5E5E5">National Guard I'm working on my</font>

24
00:00:47,579 --> 00:00:55,949
master's degree through<font color="#CCCCCC"> sans got two</font>

25
00:00:51,600 --> 00:00:57,989
kids<font color="#E5E5E5"> just</font><font color="#CCCCCC"> one wife right now if you want</font>

26
00:00:55,949 --> 00:01:00,239
to get<font color="#CCCCCC"> ahold</font><font color="#E5E5E5"> of me this is my</font><font color="#CCCCCC"> personal</font>

27
00:00:57,989 --> 00:01:01,649
email and my<font color="#E5E5E5"> Twitter handle</font><font color="#CCCCCC"> I don't</font>

28
00:01:00,239 --> 00:01:03,570
really don't<font color="#E5E5E5"> use</font><font color="#CCCCCC"> Twitter too often but</font>

29
00:01:01,649 --> 00:01:04,799
feel free to<font color="#E5E5E5"> email about anything</font><font color="#CCCCCC"> that</font>

30
00:01:03,570 --> 00:01:07,939
you<font color="#E5E5E5"> ever want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk about I'd be glad</font>

31
00:01:04,799 --> 00:01:09,780
<font color="#CCCCCC">to</font><font color="#E5E5E5"> answer and respond pretty open guy I</font>

32
00:01:07,939 --> 00:01:12,240
think I like<font color="#E5E5E5"> to give a little</font><font color="#CCCCCC"> bit</font>

33
00:01:09,780 --> 00:01:14,040
slammer before I get started<font color="#CCCCCC"> no matter</font>

34
00:01:12,240 --> 00:01:15,899
how<font color="#E5E5E5"> smart</font><font color="#CCCCCC"> i think i am i don't actually</font>

35
00:01:14,040 --> 00:01:17,369
know everything so if you find a

36
00:01:15,900 --> 00:01:19,530
technical<font color="#E5E5E5"> and accuracy with what</font><font color="#CCCCCC"> i</font><font color="#E5E5E5"> have</font>

37
00:01:17,369 --> 00:01:21,270
to say<font color="#E5E5E5"> or</font><font color="#CCCCCC"> what i've said or just let me</font>

38
00:01:19,530 --> 00:01:22,470
know we can talk<font color="#E5E5E5"> about it</font><font color="#CCCCCC"> but please</font>

39
00:01:21,270 --> 00:01:23,729
don't<font color="#E5E5E5"> expect me perfect</font><font color="#CCCCCC"> i wouldn't</font>

40
00:01:22,470 --> 00:01:25,350
<font color="#CCCCCC">expect that of</font><font color="#E5E5E5"> you but</font><font color="#CCCCCC"> i'm just letting</font>

41
00:01:23,729 --> 00:01:29,158
<font color="#E5E5E5">you know</font><font color="#CCCCCC"> i could</font><font color="#E5E5E5"> have got something</font>

42
00:01:25,350 --> 00:01:30,619
<font color="#CCCCCC">wrong here's a</font><font color="#E5E5E5"> brief outline of the</font>

43
00:01:29,159 --> 00:01:32,579
things we're going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> talk about</font><font color="#E5E5E5"> today</font>

44
00:01:30,619 --> 00:01:33,780
we're gonna go<font color="#E5E5E5"> over a little bit</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> bit</font>

45
00:01:32,579 --> 00:01:35,908
<font color="#CCCCCC">powershell give you a</font><font color="#E5E5E5"> little background</font>

46
00:01:33,780 --> 00:01:37,320
<font color="#E5E5E5">information and i'm gonna talk a lot</font>

47
00:01:35,909 --> 00:01:38,610
about attack tools it's probably pretty

48
00:01:37,320 --> 00:01:41,339
heavy<font color="#E5E5E5"> on the tack tools because that's</font>

49
00:01:38,610 --> 00:01:42,270
what<font color="#CCCCCC"> i use on a</font><font color="#E5E5E5"> day-to-day basis then</font>

50
00:01:41,340 --> 00:01:43,979
i'm going<font color="#E5E5E5"> to move into a</font><font color="#CCCCCC"> little bit</font>

51
00:01:42,270 --> 00:01:46,289
<font color="#E5E5E5">about malware</font><font color="#CCCCCC"> a little bit about</font>

52
00:01:43,979 --> 00:01:48,000
forensics tools and then<font color="#E5E5E5"> i'm gonna close</font>

53
00:01:46,290 --> 00:01:51,619
up with ways you can<font color="#E5E5E5"> kind of block these</font>

54
00:01:48,000 --> 00:01:51,619
attacks or find ways to defend<font color="#E5E5E5"> them</font>

55
00:01:52,070 --> 00:01:56,758
here's the<font color="#CCCCCC"> definition that powershell</font>

56
00:01:54,210 --> 00:01:58,140
pulled it off of a website<font color="#CCCCCC"> also real</font>

57
00:01:56,759 --> 00:02:01,500
quick<font color="#E5E5E5"> my slides will be available in</font>

58
00:01:58,140 --> 00:02:03,360
sworn shields blog afterwards<font color="#CCCCCC"> and my</font>

59
00:02:01,500 --> 00:02:04,890
slides have tons of<font color="#CCCCCC"> notes and reference</font>

60
00:02:03,360 --> 00:02:07,320
links<font color="#CCCCCC"> so you can</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> all this</font><font color="#E5E5E5"> content</font>

61
00:02:04,890 --> 00:02:08,610
from so if<font color="#E5E5E5"> i go through this stuff</font>

62
00:02:07,320 --> 00:02:10,619
quickly<font color="#E5E5E5"> you don't get the chance</font><font color="#CCCCCC"> to</font>

63
00:02:08,610 --> 00:02:11,790
write it<font color="#E5E5E5"> down</font><font color="#CCCCCC"> or take pictures</font><font color="#E5E5E5"> it'll all</font>

64
00:02:10,619 --> 00:02:13,260
be available<font color="#E5E5E5"> later</font>

65
00:02:11,790 --> 00:02:15,209
there was this a definition of

66
00:02:13,260 --> 00:02:16,500
<font color="#CCCCCC">powershell do we have any programmers in</font>

67
00:02:15,209 --> 00:02:19,650
who have ever<font color="#E5E5E5"> programmed</font><font color="#CCCCCC"> anything</font><font color="#E5E5E5"> in a</font>

68
00:02:16,500 --> 00:02:22,500
batch or in<font color="#E5E5E5"> wrote an batch script</font><font color="#CCCCCC"> that's</font>

69
00:02:19,650 --> 00:02:25,519
script yeah<font color="#E5E5E5"> we got some candy</font><font color="#CCCCCC"> too those</font>

70
00:02:22,500 --> 00:02:25,519
have written batch scripts because

71
00:02:26,900 --> 00:02:38,010
<font color="#CCCCCC">anyone</font><font color="#E5E5E5"> else here you go sir</font><font color="#CCCCCC"> it's you</font>

72
00:02:32,730 --> 00:02:39,149
back there well anyways if<font color="#E5E5E5"> you bring</font>

73
00:02:38,010 --> 00:02:40,620
<font color="#CCCCCC">anything in a batch script before you</font>

74
00:02:39,150 --> 00:02:41,909
know how awful<font color="#E5E5E5"> it is especially with</font>

75
00:02:40,620 --> 00:02:45,379
<font color="#CCCCCC">today's modern programming languages</font>

76
00:02:41,909 --> 00:02:48,000
<font color="#E5E5E5">PowerShell is beautiful for many reasons</font>

77
00:02:45,379 --> 00:02:49,980
these<font color="#E5E5E5"> are the reasons why PowerShell is</font>

78
00:02:48,000 --> 00:02:52,349
beautiful<font color="#E5E5E5"> as you know it's Microsoft's</font>

79
00:02:49,980 --> 00:02:54,388
new<font color="#E5E5E5"> updated you know old dos prompt it</font>

80
00:02:52,349 --> 00:02:56,670
can do a lot<font color="#CCCCCC"> of things it's primarily</font>

81
00:02:54,389 --> 00:02:59,000
built on<font color="#E5E5E5"> the.net framework</font><font color="#CCCCCC"> and you use</font>

82
00:02:56,670 --> 00:03:01,048
<font color="#CCCCCC">it</font><font color="#E5E5E5"> to interact with the</font><font color="#CCCCCC"> windows API</font>

83
00:02:59,000 --> 00:03:02,879
everything works off of verb<font color="#CCCCCC"> noun</font>

84
00:03:01,049 --> 00:03:04,409
completion so like if<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to do</font>

85
00:03:02,879 --> 00:03:06,090
something<font color="#CCCCCC"> like get help you just type</font>

86
00:03:04,409 --> 00:03:07,440
the<font color="#CCCCCC"> words get - help you know</font><font color="#E5E5E5"> the verb</font>

87
00:03:06,090 --> 00:03:09,540
and<font color="#CCCCCC"> now and what it is you want to</font><font color="#E5E5E5"> do</font>

88
00:03:07,440 --> 00:03:12,060
has tab completion<font color="#E5E5E5"> that's always great</font>

89
00:03:09,540 --> 00:03:14,250
<font color="#CCCCCC">especially they're coming from</font><font color="#E5E5E5"> Linux or</font>

90
00:03:12,060 --> 00:03:16,260
anything like<font color="#CCCCCC"> that that</font><font color="#E5E5E5"> has it and</font><font color="#CCCCCC"> it's</font>

91
00:03:14,250 --> 00:03:17,790
<font color="#E5E5E5">stuff in your path you could alias any</font>

92
00:03:16,260 --> 00:03:19,768
command you<font color="#CCCCCC"> want how many of you have</font>

93
00:03:17,790 --> 00:03:23,040
<font color="#CCCCCC">ever been in a</font><font color="#E5E5E5"> Linux command prompt and</font>

94
00:03:19,769 --> 00:03:25,440
<font color="#E5E5E5">type LS oh yeah with PowerShell guess</font>

95
00:03:23,040 --> 00:03:26,970
what it works it'll<font color="#E5E5E5"> give because the</font>

96
00:03:25,440 --> 00:03:28,799
alias<font color="#E5E5E5"> the command over so you can</font>

97
00:03:26,970 --> 00:03:30,120
straight up<font color="#E5E5E5"> hit LS and PowerShell and it</font>

98
00:03:28,799 --> 00:03:31,650
<font color="#E5E5E5">will give you a listing of what you want</font>

99
00:03:30,120 --> 00:03:36,180
so<font color="#CCCCCC"> you can alias any command</font><font color="#E5E5E5"> that you</font>

100
00:03:31,650 --> 00:03:37,169
want<font color="#E5E5E5"> to but the most one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the good</font>

101
00:03:36,180 --> 00:03:38,609
things about PowerShell is that

102
00:03:37,169 --> 00:03:40,290
everything comes<font color="#E5E5E5"> out on objects if</font>

103
00:03:38,609 --> 00:03:42,299
you've done any<font color="#CCCCCC"> object-oriented program</font>

104
00:03:40,290 --> 00:03:43,590
if any sort PowerShell works<font color="#CCCCCC"> and objects</font>

105
00:03:42,299 --> 00:03:45,000
so<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can literally craft up your own</font>

106
00:03:43,590 --> 00:03:46,560
object or you can use the built-in

107
00:03:45,000 --> 00:03:48,090
objects<font color="#E5E5E5"> that they have and you can do</font>

108
00:03:46,560 --> 00:03:49,829
smart things with<font color="#E5E5E5"> the data when you get</font>

109
00:03:48,090 --> 00:03:52,260
<font color="#E5E5E5">an</font><font color="#CCCCCC"> object back</font><font color="#E5E5E5"> as opposed to the</font><font color="#CCCCCC"> old</font>

110
00:03:49,829 --> 00:03:54,510
<font color="#E5E5E5">command</font><font color="#CCCCCC"> shell where you just get text</font>

111
00:03:52,260 --> 00:03:56,340
strings on<font color="#CCCCCC"> your spoon on your monitor</font>

112
00:03:54,510 --> 00:03:57,810
<font color="#E5E5E5">that's all you get a PowerShell has</font>

113
00:03:56,340 --> 00:03:59,819
actual structures you can<font color="#E5E5E5"> build your own</font>

114
00:03:57,810 --> 00:04:02,069
or<font color="#CCCCCC"> use ones they got syntax highlighting</font>

115
00:03:59,819 --> 00:04:03,599
is available in version 5 it looks like

116
00:04:02,069 --> 00:04:06,000
that with the<font color="#E5E5E5"> yellow and then you'll see</font>

117
00:04:03,599 --> 00:04:08,129
lots of<font color="#E5E5E5"> slides later was green and</font><font color="#CCCCCC"> gray</font>

118
00:04:06,000 --> 00:04:09,810
<font color="#E5E5E5">and all kinds of other stuff about</font><font color="#CCCCCC"> it</font>

119
00:04:08,129 --> 00:04:13,409
<font color="#E5E5E5">PowerShell has been around for a long</font>

120
00:04:09,810 --> 00:04:14,430
time<font color="#E5E5E5"> it came default on Vista probably</font>

121
00:04:13,409 --> 00:04:15,900
probably<font color="#E5E5E5"> don't know that</font><font color="#CCCCCC"> was there</font><font color="#E5E5E5"> and</font>

122
00:04:14,430 --> 00:04:19,440
<font color="#E5E5E5">you could install it on XP if you'd</font>

123
00:04:15,900 --> 00:04:20,728
wanted<font color="#E5E5E5"> to but please don't use XP</font><font color="#CCCCCC"> it's</font>

124
00:04:19,440 --> 00:04:22,530
been around I think<font color="#E5E5E5"> it's coming up on</font>

125
00:04:20,728 --> 00:04:22,770
<font color="#CCCCCC">its 10-year anniversary</font><font color="#E5E5E5"> here soon on how</font>

126
00:04:22,530 --> 00:04:25,198
long

127
00:04:22,770 --> 00:04:26,758
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> has been around and because</font>

128
00:04:25,199 --> 00:04:28,889
<font color="#E5E5E5">that version</font><font color="#CCCCCC"> 5 is a news release version</font>

129
00:04:26,759 --> 00:04:30,990
5 came on Windows 10<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> upgrade</font>

130
00:04:28,889 --> 00:04:35,129
your<font color="#CCCCCC"> pack</font><font color="#E5E5E5"> passive versions up</font><font color="#CCCCCC"> to version</font>

131
00:04:30,990 --> 00:04:36,539
5 now<font color="#CCCCCC"> a powershell script instant PS 1</font>

132
00:04:35,129 --> 00:04:38,099
those<font color="#E5E5E5"> things are not clickable you can't</font>

133
00:04:36,539 --> 00:04:39,960
<font color="#E5E5E5">double click and run a</font><font color="#CCCCCC"> PowerShell script</font>

134
00:04:38,099 --> 00:04:41,190
like you can a shell script or<font color="#CCCCCC"> something</font>

135
00:04:39,960 --> 00:04:42,299
like that<font color="#E5E5E5"> you actually have</font><font color="#CCCCCC"> to run</font><font color="#E5E5E5"> it</font>

136
00:04:41,190 --> 00:04:43,680
from<font color="#E5E5E5"> the command prompt Microsoft</font>

137
00:04:42,300 --> 00:04:45,810
intentionally did that where you can't

138
00:04:43,680 --> 00:04:48,180
double<font color="#E5E5E5"> click and</font><font color="#CCCCCC"> run a script</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font>

139
00:04:45,810 --> 00:04:49,620
can set up<font color="#E5E5E5"> a module like</font><font color="#CCCCCC"> a lot better</font>

140
00:04:48,180 --> 00:04:51,210
<font color="#E5E5E5">terms it's like a function or a class</font>

141
00:04:49,620 --> 00:04:52,770
you can put all<font color="#CCCCCC"> your other stuff in</font>

142
00:04:51,210 --> 00:04:54,810
there and<font color="#E5E5E5"> use the PowerShell module</font><font color="#CCCCCC"> a</font>

143
00:04:52,770 --> 00:04:56,520
<font color="#E5E5E5">power saw also comes with the integrated</font>

144
00:04:54,810 --> 00:04:58,650
scripting<font color="#CCCCCC"> environment so</font><font color="#E5E5E5"> you know you</font>

145
00:04:56,520 --> 00:05:00,090
can open<font color="#CCCCCC"> up the IDE that as you will to</font>

146
00:04:58,650 --> 00:05:02,068
mess with<font color="#CCCCCC"> your PowerShell programs and</font>

147
00:05:00,090 --> 00:05:04,109
one of the other<font color="#E5E5E5"> cool things you</font><font color="#CCCCCC"> can</font>

148
00:05:02,069 --> 00:05:06,330
strip compile<font color="#E5E5E5"> PowerShell script to exe</font>

149
00:05:04,110 --> 00:05:07,620
if you want to do and distribute it<font color="#E5E5E5"> out</font>

150
00:05:06,330 --> 00:05:12,599
that way<font color="#E5E5E5"> if you don't</font><font color="#CCCCCC"> want people to see</font>

151
00:05:07,620 --> 00:05:15,840
your source code here's an<font color="#E5E5E5"> example of</font>

152
00:05:12,599 --> 00:05:17,759
the again the verb noun<font color="#CCCCCC"> hears</font><font color="#E5E5E5"> get help</font><font color="#CCCCCC"> I</font>

153
00:05:15,840 --> 00:05:20,008
got help<font color="#E5E5E5"> on the command get alias and</font>

154
00:05:17,759 --> 00:05:22,020
this is what it looks<font color="#E5E5E5"> like with these</font>

155
00:05:20,009 --> 00:05:24,000
things are called commandlets<font color="#CCCCCC"> and so get</font>

156
00:05:22,020 --> 00:05:25,560
help<font color="#E5E5E5"> as a command line there's tons of</font>

157
00:05:24,000 --> 00:05:27,900
information most people that write

158
00:05:25,560 --> 00:05:29,159
scripts<font color="#E5E5E5"> they all document really well so</font>

159
00:05:27,900 --> 00:05:30,630
gone are<font color="#E5E5E5"> the days where you don't have</font>

160
00:05:29,159 --> 00:05:32,490
to<font color="#E5E5E5"> can't figure out what's going on how</font>

161
00:05:30,630 --> 00:05:35,479
<font color="#E5E5E5">you run a tool most powershell</font>

162
00:05:32,490 --> 00:05:35,479
commandlets are pretty<font color="#E5E5E5"> good with that</font>

163
00:05:36,949 --> 00:05:40,620
let's see you can pipe<font color="#CCCCCC"> the data</font>

164
00:05:39,000 --> 00:05:42,690
structures around<font color="#CCCCCC"> that's what I was</font>

165
00:05:40,620 --> 00:05:44,819
doing<font color="#CCCCCC"> here I did a get process which got</font>

166
00:05:42,690 --> 00:05:46,409
me<font color="#CCCCCC"> a list of all the processes</font><font color="#E5E5E5"> and then</font>

167
00:05:44,819 --> 00:05:48,090
I piped it to a command that called get

168
00:05:46,409 --> 00:05:49,349
member get members really<font color="#E5E5E5"> nice because</font>

169
00:05:48,090 --> 00:05:50,789
if you ever have an object<font color="#CCCCCC"> you know</font>

170
00:05:49,349 --> 00:05:53,069
<font color="#CCCCCC">migrate I got an object now what am I</font>

171
00:05:50,789 --> 00:05:54,930
gonna do with this thing<font color="#CCCCCC"> well get member</font>

172
00:05:53,069 --> 00:05:57,000
tells you that<font color="#E5E5E5"> this object has</font><font color="#CCCCCC"> methods</font>

173
00:05:54,930 --> 00:05:58,169
and properties and<font color="#E5E5E5"> aliases and events</font>

174
00:05:57,000 --> 00:05:59,159
and all kinds of stuff<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you can figure</font>

175
00:05:58,169 --> 00:06:00,419
out how these are<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to use this</font>

176
00:05:59,159 --> 00:06:03,120
<font color="#E5E5E5">object for what it</font><font color="#CCCCCC"> is you're gonna do</font>

177
00:06:00,419 --> 00:06:08,340
with it and<font color="#E5E5E5"> just limit it to</font><font color="#CCCCCC"> ten ten</font>

178
00:06:03,120 --> 00:06:10,860
items<font color="#CCCCCC"> some of the good use cases for</font>

179
00:06:08,340 --> 00:06:13,039
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> again I</font><font color="#CCCCCC"> always</font><font color="#E5E5E5"> like us early</font>

180
00:06:10,860 --> 00:06:14,729
<font color="#CCCCCC">it's its integrated in Windows it's</font>

181
00:06:13,039 --> 00:06:17,610
everyone's using<font color="#E5E5E5"> it for everything</font><font color="#CCCCCC"> in</font>

182
00:06:14,729 --> 00:06:19,560
fact<font color="#E5E5E5"> if you get Server 2016</font><font color="#CCCCCC"> Nano I</font>

183
00:06:17,610 --> 00:06:21,240
believe it is it has no GUI you just

184
00:06:19,560 --> 00:06:22,919
have to<font color="#E5E5E5"> interact with a</font><font color="#CCCCCC"> PowerShell</font><font color="#E5E5E5"> only</font>

185
00:06:21,240 --> 00:06:25,440
<font color="#CCCCCC">that's one of the ways to do</font><font color="#E5E5E5"> and you do</font>

186
00:06:22,919 --> 00:06:27,510
that through PS remoting<font color="#E5E5E5"> which is like</font>

187
00:06:25,440 --> 00:06:30,300
<font color="#E5E5E5">SSH for like about turns but it's a way</font>

188
00:06:27,510 --> 00:06:32,039
<font color="#E5E5E5">does their</font><font color="#CCCCCC"> own stuff and you can with PS</font>

189
00:06:30,300 --> 00:06:34,280
<font color="#CCCCCC">Ramona you can run one command across</font>

190
00:06:32,040 --> 00:06:36,210
<font color="#E5E5E5">your whole network from one</font><font color="#CCCCCC"> workstation</font>

191
00:06:34,280 --> 00:06:38,010
<font color="#CCCCCC">but</font><font color="#E5E5E5"> that wasn't good enough for you</font>

192
00:06:36,210 --> 00:06:39,630
<font color="#E5E5E5">Microsoft's participating in the</font><font color="#CCCCCC"> OpenSSH</font>

193
00:06:38,010 --> 00:06:44,659
project and they said they're gonna have

194
00:06:39,630 --> 00:06:48,300
<font color="#CCCCCC">OpenSSH integration here soon and then</font>

195
00:06:44,660 --> 00:06:50,010
<font color="#E5E5E5">antivirus uses it actually malware</font>

196
00:06:48,300 --> 00:06:51,900
writers use it right team people<font color="#E5E5E5"> use it</font>

197
00:06:50,010 --> 00:06:53,700
<font color="#CCCCCC">one</font><font color="#E5E5E5"> of the better things about it has</font>

198
00:06:51,900 --> 00:06:58,409
in-memory<font color="#E5E5E5"> code execution which I'll</font>

199
00:06:53,700 --> 00:06:59,820
touch on<font color="#CCCCCC"> here a minute here's an</font><font color="#E5E5E5"> example</font>

200
00:06:58,410 --> 00:07:03,120
of PS<font color="#E5E5E5"> remoting like I said I got</font><font color="#CCCCCC"> a lot</font>

201
00:06:59,820 --> 00:07:04,080
<font color="#CCCCCC">of screenshots I had a laptop that</font><font color="#E5E5E5"> was</font>

202
00:07:03,120 --> 00:07:05,670
going to use and I was<font color="#E5E5E5"> gonna show</font><font color="#CCCCCC"> you</font>

203
00:07:04,080 --> 00:07:06,900
guys<font color="#CCCCCC"> some stuff on the VMS except for my</font>

204
00:07:05,670 --> 00:07:08,940
<font color="#E5E5E5">laptops like 20 years old</font>

205
00:07:06,900 --> 00:07:11,250
it only has VGA output<font color="#E5E5E5"> and my boss won't</font>

206
00:07:08,940 --> 00:07:17,100
<font color="#E5E5E5">buy me a new</font><font color="#CCCCCC"> one so I had to use the had</font>

207
00:07:11,250 --> 00:07:18,510
to<font color="#E5E5E5"> use their slide deck which is an</font>

208
00:07:17,100 --> 00:07:20,370
example of<font color="#CCCCCC"> PSR voting's to another</font>

209
00:07:18,510 --> 00:07:22,230
<font color="#CCCCCC">computer it's like youth an</font><font color="#E5E5E5"> SSH I was</font>

210
00:07:20,370 --> 00:07:24,960
<font color="#E5E5E5">just</font><font color="#CCCCCC"> connected to</font><font color="#E5E5E5"> another computer over</font>

211
00:07:22,230 --> 00:07:26,460
there<font color="#E5E5E5"> and you can</font><font color="#CCCCCC"> see once you remote</font>

212
00:07:24,960 --> 00:07:27,659
over to the computer<font color="#E5E5E5"> it puts out the</font>

213
00:07:26,460 --> 00:07:30,440
hostname<font color="#E5E5E5"> up they</font><font color="#CCCCCC"> say</font><font color="#E5E5E5"> you know which</font>

214
00:07:27,660 --> 00:07:33,660
computer it is<font color="#E5E5E5"> you're connected in</font>

215
00:07:30,440 --> 00:07:35,640
there's four ways<font color="#E5E5E5"> to</font><font color="#CCCCCC"> load scripts or to</font>

216
00:07:33,660 --> 00:07:37,800
use the scripts in PowerShell<font color="#CCCCCC"> the top</font>

217
00:07:35,640 --> 00:07:39,210
one actually saw there's three ways<font color="#CCCCCC"> the</font>

218
00:07:37,800 --> 00:07:40,410
top ones the execution policy<font color="#CCCCCC"> any of</font><font color="#E5E5E5"> you</font>

219
00:07:39,210 --> 00:07:41,359
guys heard<font color="#CCCCCC"> of the</font><font color="#E5E5E5"> power</font><font color="#CCCCCC"> saw execution</font>

220
00:07:40,410 --> 00:07:44,040
policy

221
00:07:41,360 --> 00:07:45,810
not<font color="#E5E5E5"> too many</font><font color="#CCCCCC"> idea people</font><font color="#E5E5E5"> think that it's</font>

222
00:07:44,040 --> 00:07:48,300
a security boundary because if it's set

223
00:07:45,810 --> 00:07:49,320
to signed only<font color="#E5E5E5"> then they think that you</font>

224
00:07:48,300 --> 00:07:50,700
can't<font color="#E5E5E5"> run their PowerShell scripts to</font>

225
00:07:49,320 --> 00:07:51,990
try and run one the<font color="#E5E5E5"> very first time</font><font color="#CCCCCC"> I</font>

226
00:07:50,700 --> 00:07:53,700
computer and I'll say<font color="#E5E5E5"> that you can't run</font>

227
00:07:51,990 --> 00:07:55,230
it<font color="#CCCCCC"> because you're not authorized so you</font>

228
00:07:53,700 --> 00:07:57,510
change the execution<font color="#CCCCCC"> policy to</font>

229
00:07:55,230 --> 00:07:58,980
unrestricted or<font color="#CCCCCC"> assigned</font><font color="#E5E5E5"> or whatever but</font>

230
00:07:57,510 --> 00:08:00,990
<font color="#CCCCCC">that can be</font><font color="#E5E5E5"> changed by anybody and that</font>

231
00:07:58,980 --> 00:08:03,150
<font color="#CCCCCC">wasn't good enough or</font><font color="#E5E5E5"> you can just tell</font>

232
00:08:00,990 --> 00:08:04,440
<font color="#E5E5E5">it hey let's bypass the security policy</font>

233
00:08:03,150 --> 00:08:07,560
for now in PowerShell let you do that

234
00:08:04,440 --> 00:08:08,880
you<font color="#E5E5E5"> can just</font><font color="#CCCCCC"> continue on but one of</font><font color="#E5E5E5"> the</font>

235
00:08:07,560 --> 00:08:10,560
ways<font color="#E5E5E5"> is</font><font color="#CCCCCC"> you can import a module with the</font>

236
00:08:08,880 --> 00:08:11,820
import module<font color="#CCCCCC"> clan there's an example in</font>

237
00:08:10,560 --> 00:08:14,160
<font color="#E5E5E5">the import module or you can use dot</font>

238
00:08:11,820 --> 00:08:15,599
sourcing which is just a dot<font color="#CCCCCC"> and in the</font>

239
00:08:14,160 --> 00:08:16,830
path<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the extra</font><font color="#CCCCCC"> powershell script and</font>

240
00:08:15,600 --> 00:08:18,720
we'll pull it all<font color="#E5E5E5"> into memory and</font><font color="#CCCCCC"> that</font>

241
00:08:16,830 --> 00:08:22,140
in that<font color="#E5E5E5"> session you have there there's</font>

242
00:08:18,720 --> 00:08:23,880
one<font color="#CCCCCC"> other way a real</font><font color="#E5E5E5"> popular way amongst</font>

243
00:08:22,140 --> 00:08:28,080
attackers anybody happen to<font color="#E5E5E5"> know what</font>

244
00:08:23,880 --> 00:08:31,020
the other way is<font color="#CCCCCC"> no well</font><font color="#E5E5E5"> you don't know</font>

245
00:08:28,080 --> 00:08:32,970
cuz I'm<font color="#E5E5E5"> going to show you its the</font><font color="#CCCCCC"> IEX</font>

246
00:08:31,020 --> 00:08:34,289
download cradle this thing is very

247
00:08:32,970 --> 00:08:36,440
<font color="#E5E5E5">important for you to</font><font color="#CCCCCC"> pay attention to</font>

248
00:08:34,289 --> 00:08:38,270
<font color="#E5E5E5">you'll see</font><font color="#CCCCCC"> this used over and</font><font color="#E5E5E5"> over</font>

249
00:08:36,440 --> 00:08:41,419
and over and<font color="#E5E5E5"> over and over and over</font>

250
00:08:38,270 --> 00:08:44,270
<font color="#E5E5E5">everywhere</font><font color="#CCCCCC"> in all my slides IEX is a</font>

251
00:08:41,419 --> 00:08:47,300
short alias for invoke expression<font color="#E5E5E5"> and</font>

252
00:08:44,270 --> 00:08:49,550
what this does is it creates a web

253
00:08:47,300 --> 00:08:50,870
object and then it downloads your power

254
00:08:49,550 --> 00:08:52,099
of the shell<font color="#E5E5E5"> script from wherever you</font>

255
00:08:50,870 --> 00:08:53,360
can download it from<font color="#E5E5E5"> the internet you</font>

256
00:08:52,100 --> 00:08:56,330
<font color="#CCCCCC">can download</font><font color="#E5E5E5"> it from another</font><font color="#CCCCCC"> machine you</font>

257
00:08:53,360 --> 00:08:58,400
can download from SMB you can you and

258
00:08:56,330 --> 00:09:00,200
then it pulls<font color="#CCCCCC"> onto memory</font><font color="#E5E5E5"> so like this</font>

259
00:08:58,400 --> 00:09:02,270
<font color="#CCCCCC">PowerShell script right here and any</font>

260
00:09:00,200 --> 00:09:05,810
militia malicious ones that I have they

261
00:09:02,270 --> 00:09:07,430
never<font color="#E5E5E5"> touch the disk</font><font color="#CCCCCC"> i from a</font><font color="#E5E5E5"> powershell</font>

262
00:09:05,810 --> 00:09:08,750
session<font color="#CCCCCC"> I'll go out to the internet I'll</font>

263
00:09:07,430 --> 00:09:10,189
grab the script<font color="#CCCCCC"> that I want pull in the</font>

264
00:09:08,750 --> 00:09:12,820
memory forensically there's nothing on

265
00:09:10,190 --> 00:09:14,600
the computer<font color="#E5E5E5"> for you to know that</font>

266
00:09:12,820 --> 00:09:17,540
<font color="#CCCCCC">there'll be nothing for</font><font color="#E5E5E5"> you to know</font><font color="#CCCCCC"> that</font>

267
00:09:14,600 --> 00:09:19,040
I pulled that script in there and here's

268
00:09:17,540 --> 00:09:23,050
an example<font color="#CCCCCC"> of</font><font color="#E5E5E5"> me pulling the script down</font>

269
00:09:19,040 --> 00:09:23,050
and then executing the details on there

270
00:09:24,160 --> 00:09:29,480
here's some<font color="#E5E5E5"> of the tools that I'm</font><font color="#CCCCCC"> gonna</font>

271
00:09:26,150 --> 00:09:30,980
<font color="#CCCCCC">go</font><font color="#E5E5E5"> over the list</font><font color="#CCCCCC"> looks quite longer and</font>

272
00:09:29,480 --> 00:09:32,930
as I started<font color="#E5E5E5"> building my presentation I</font>

273
00:09:30,980 --> 00:09:34,070
didn't have enough time to<font color="#CCCCCC"> get it all in</font>

274
00:09:32,930 --> 00:09:35,689
<font color="#E5E5E5">there push you probably want to say it</font>

275
00:09:34,070 --> 00:09:37,610
<font color="#E5E5E5">for three hours</font><font color="#CCCCCC"> so I took some</font><font color="#E5E5E5"> of the</font>

276
00:09:35,690 --> 00:09:41,930
tools off but these are the kind<font color="#CCCCCC"> of the</font>

277
00:09:37,610 --> 00:09:45,470
attack tools that I'm gonna<font color="#E5E5E5"> go over how</font>

278
00:09:41,930 --> 00:09:47,359
many<font color="#E5E5E5"> guys</font><font color="#CCCCCC"> have heard of me me cats me me</font>

279
00:09:45,470 --> 00:09:48,340
cats is a really<font color="#E5E5E5"> great tool I'll show</font>

280
00:09:47,360 --> 00:09:50,950
you a<font color="#CCCCCC"> little bit</font><font color="#E5E5E5"> more about</font><font color="#CCCCCC"> that later</font>

281
00:09:48,340 --> 00:09:53,840
<font color="#CCCCCC">this one</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> hear is</font><font color="#E5E5E5"> called power memory</font>

282
00:09:50,950 --> 00:09:55,910
of you that are familiar with<font color="#E5E5E5"> me me cats</font>

283
00:09:53,840 --> 00:10:00,260
<font color="#E5E5E5">does anybody know what version</font><font color="#CCCCCC"> of</font>

284
00:09:55,910 --> 00:10:02,270
Windows it won't work in by default<font color="#E5E5E5"> no</font>

285
00:10:00,260 --> 00:10:04,610
no well Microsoft put some protections

286
00:10:02,270 --> 00:10:06,860
in place and Server 2012 and Windows<font color="#E5E5E5"> 10</font>

287
00:10:04,610 --> 00:10:09,050
and 8.1<font color="#E5E5E5"> that keep me</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> cats from</font>

288
00:10:06,860 --> 00:10:11,780
running you can't make a registry change

289
00:10:09,050 --> 00:10:13,339
and reboot<font color="#CCCCCC"> the machine but anyways this</font>

290
00:10:11,780 --> 00:10:15,800
program I hear a power memory<font color="#E5E5E5"> it does a</font>

291
00:10:13,340 --> 00:10:19,160
lot<font color="#CCCCCC"> of things</font><font color="#E5E5E5"> but the primary use case</font>

292
00:10:15,800 --> 00:10:21,670
for<font color="#E5E5E5"> it is for</font><font color="#CCCCCC"> getting a dump</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> alsace</font>

293
00:10:19,160 --> 00:10:23,900
which stores those credentials in it and

294
00:10:21,670 --> 00:10:25,010
it'll<font color="#E5E5E5"> work on all the</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> to Windows 10</font>

295
00:10:23,900 --> 00:10:26,630
<font color="#CCCCCC">it doesn't care</font><font color="#E5E5E5"> what your operating</font>

296
00:10:25,010 --> 00:10:27,980
system is it will grab<font color="#E5E5E5"> you can grab a</font>

297
00:10:26,630 --> 00:10:31,520
clear text credentials<font color="#E5E5E5"> out of memory</font>

298
00:10:27,980 --> 00:10:33,500
<font color="#E5E5E5">from any computer one of the ways it</font>

299
00:10:31,520 --> 00:10:36,110
does is<font color="#CCCCCC"> that use Windows</font><font color="#E5E5E5"> signed binaries</font>

300
00:10:33,500 --> 00:10:37,850
<font color="#E5E5E5">so there's again</font><font color="#CCCCCC"> no no other tools on</font>

301
00:10:36,110 --> 00:10:39,980
the<font color="#CCCCCC"> disk</font><font color="#E5E5E5"> that are kind of weird you</font><font color="#CCCCCC"> just</font>

302
00:10:37,850 --> 00:10:43,040
<font color="#E5E5E5">use straight up Microsoft tools and</font>

303
00:10:39,980 --> 00:10:44,840
you've got a copy<font color="#E5E5E5"> of the memory here's</font>

304
00:10:43,040 --> 00:10:47,360
an<font color="#E5E5E5"> example</font><font color="#CCCCCC"> over here</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is the</font><font color="#E5E5E5"> main</font>

305
00:10:44,840 --> 00:10:48,860
screen<font color="#CCCCCC"> when you run a tool up</font><font color="#E5E5E5"> and then</font>

306
00:10:47,360 --> 00:10:53,240
this one<font color="#CCCCCC"> over to</font><font color="#E5E5E5"> the right</font><font color="#CCCCCC"> over here was</font>

307
00:10:48,860 --> 00:10:54,770
me<font color="#E5E5E5"> extracting the memory from</font><font color="#CCCCCC"> my my own</font>

308
00:10:53,240 --> 00:10:56,660
computer<font color="#E5E5E5"> was a Windows 10 computer</font>

309
00:10:54,770 --> 00:11:00,590
<font color="#E5E5E5">there's kind of the steps</font><font color="#CCCCCC"> that it</font><font color="#E5E5E5"> went</font>

310
00:10:56,660 --> 00:11:02,780
<font color="#E5E5E5">through that</font><font color="#CCCCCC"> notice down towards the</font>

311
00:11:00,590 --> 00:11:04,760
bottom<font color="#CCCCCC"> s</font><font color="#E5E5E5"> if I want exfiltrate data you</font>

312
00:11:02,780 --> 00:11:06,650
can have it send your<font color="#E5E5E5"> stuff to paste in</font>

313
00:11:04,760 --> 00:11:08,120
if you want<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that way you can have set</font>

314
00:11:06,650 --> 00:11:09,770
up a private repo so<font color="#CCCCCC"> that was</font><font color="#E5E5E5"> not open</font>

315
00:11:08,120 --> 00:11:12,800
<font color="#E5E5E5">to the</font><font color="#CCCCCC"> public</font><font color="#E5E5E5"> but it'll</font><font color="#CCCCCC"> just exfiltrate</font>

316
00:11:09,770 --> 00:11:15,079
<font color="#CCCCCC">it straight out for you</font><font color="#E5E5E5"> and there's an</font>

317
00:11:12,800 --> 00:11:17,859
<font color="#CCCCCC">example there's my password</font><font color="#E5E5E5"> don't don't</font>

318
00:11:15,080 --> 00:11:20,060
use it please<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> my super strong</font><font color="#CCCCCC"> but</font>

319
00:11:17,860 --> 00:11:21,800
<font color="#CCCCCC">this</font><font color="#E5E5E5"> again was on a Windows 10 computer</font>

320
00:11:20,060 --> 00:11:23,630
and<font color="#E5E5E5"> this is what it looks like</font><font color="#CCCCCC"> I forgot</font>

321
00:11:21,800 --> 00:11:25,640
<font color="#E5E5E5">to mention earlier all the tools that</font>

322
00:11:23,630 --> 00:11:27,170
I'm<font color="#CCCCCC"> talking about the</font><font color="#E5E5E5"> light</font><font color="#CCCCCC"> grey text</font>

323
00:11:25,640 --> 00:11:29,330
<font color="#E5E5E5">underneath the tool name has</font><font color="#CCCCCC"> the tool</font>

324
00:11:27,170 --> 00:11:31,189
author<font color="#E5E5E5"> the Twitter handle up I knew it</font>

325
00:11:29,330 --> 00:11:32,510
and a place where you can get the tool

326
00:11:31,190 --> 00:11:33,860
if you<font color="#E5E5E5"> wanted to use it trying to give</font>

327
00:11:32,510 --> 00:11:37,939
attribution<font color="#E5E5E5"> where it's due to all the</font>

328
00:11:33,860 --> 00:11:39,770
people that<font color="#E5E5E5"> wrote these tools another</font>

329
00:11:37,940 --> 00:11:41,930
set of tools is<font color="#CCCCCC"> called a</font><font color="#E5E5E5"> PowerShell</font>

330
00:11:39,770 --> 00:11:43,730
ad recon<font color="#CCCCCC"> Shedden Shawn</font><font color="#E5E5E5"> Metcalf he's</font>

331
00:11:41,930 --> 00:11:45,530
really<font color="#CCCCCC"> being in the PowerShell space he</font>

332
00:11:43,730 --> 00:11:47,060
actually gave a talk<font color="#E5E5E5"> very similar this</font>

333
00:11:45,530 --> 00:11:50,209
one<font color="#E5E5E5"> recently but he develops a lot</font><font color="#CCCCCC"> of</font>

334
00:11:47,060 --> 00:11:51,410
tools as well but this<font color="#E5E5E5"> tool set</font><font color="#CCCCCC"> is used</font>

335
00:11:50,210 --> 00:11:53,090
<font color="#E5E5E5">for interacting with Active Directory</font>

336
00:11:51,410 --> 00:11:55,250
like the title says<font color="#CCCCCC"> in gathering</font>

337
00:11:53,090 --> 00:11:56,960
<font color="#E5E5E5">information and some of the other some</font>

338
00:11:55,250 --> 00:11:58,790
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the scripts of note are</font><font color="#CCCCCC"> the discover</font>

339
00:11:56,960 --> 00:12:01,520
of interesting services and<font color="#E5E5E5"> exchange</font>

340
00:11:58,790 --> 00:12:02,630
<font color="#E5E5E5">server and the sequel server of you that</font>

341
00:12:01,520 --> 00:12:04,910
work with Active Directory are you

342
00:12:02,630 --> 00:12:08,120
<font color="#CCCCCC">familiar with</font><font color="#E5E5E5"> SPN the service principle</font>

343
00:12:04,910 --> 00:12:09,680
<font color="#E5E5E5">name you can ask a domain controller for</font>

344
00:12:08,120 --> 00:12:11,240
<font color="#CCCCCC">its</font><font color="#E5E5E5"> available services without actually</font>

345
00:12:09,680 --> 00:12:12,770
running<font color="#E5E5E5"> an nmap scan on the network you</font>

346
00:12:11,240 --> 00:12:14,330
just tell the domain control hey tell<font color="#CCCCCC"> me</font>

347
00:12:12,770 --> 00:12:15,500
where all your sequel servers are and it

348
00:12:14,330 --> 00:12:17,510
<font color="#E5E5E5">will answer you back with that you</font><font color="#CCCCCC"> don't</font>

349
00:12:15,500 --> 00:12:21,350
<font color="#E5E5E5">have to do any nmap scan or whatever so</font>

350
00:12:17,510 --> 00:12:24,500
these tools<font color="#E5E5E5"> are good for that here's an</font>

351
00:12:21,350 --> 00:12:26,450
<font color="#E5E5E5">example of</font><font color="#CCCCCC"> top-tier in my lab network</font>

352
00:12:24,500 --> 00:12:29,080
<font color="#CCCCCC">mat we're talking about Skynet</font><font color="#E5E5E5"> taken</font>

353
00:12:26,450 --> 00:12:32,470
over I'm<font color="#E5E5E5"> on my way to make that happen</font>

354
00:12:29,080 --> 00:12:34,990
<font color="#CCCCCC">dinette set up at work</font><font color="#E5E5E5"> but this one up</font>

355
00:12:32,470 --> 00:12:37,090
here<font color="#CCCCCC"> again I</font><font color="#E5E5E5"> asked the domain controller</font>

356
00:12:34,990 --> 00:12:39,010
with this tool tell me where the sequel

357
00:12:37,090 --> 00:12:40,180
servers are and this one down<font color="#CCCCCC"> here in</font>

358
00:12:39,010 --> 00:12:41,920
the<font color="#CCCCCC"> bottom right hand</font><font color="#E5E5E5"> corner I said tell</font>

359
00:12:40,180 --> 00:12:43,630
<font color="#E5E5E5">me where the service accounts are the</font>

360
00:12:41,920 --> 00:12:47,380
service accounts are of special<font color="#CCCCCC"> note</font>

361
00:12:43,630 --> 00:12:49,000
because<font color="#E5E5E5"> typically on network people</font><font color="#CCCCCC"> will</font>

362
00:12:47,380 --> 00:12:50,410
set their user accounts to change the

363
00:12:49,000 --> 00:12:52,750
passwords regularly<font color="#CCCCCC"> but</font><font color="#E5E5E5"> they won't</font>

364
00:12:50,410 --> 00:12:54,430
<font color="#E5E5E5">change their service accounts and then</font>

365
00:12:52,750 --> 00:12:57,880
do another<font color="#E5E5E5"> attack</font><font color="#CCCCCC"> that I don't really go</font>

366
00:12:54,430 --> 00:12:59,829
into detail<font color="#CCCCCC"> here I can grab a Kerberos</font>

367
00:12:57,880 --> 00:13:01,689
ticket from all the service accounts and

368
00:12:59,830 --> 00:13:03,220
then just go to town<font color="#E5E5E5"> cracking them and</font>

369
00:13:01,690 --> 00:13:04,570
if it takes<font color="#E5E5E5"> me two months that's cool</font>

370
00:13:03,220 --> 00:13:05,710
<font color="#E5E5E5">because your</font><font color="#CCCCCC"> password still</font><font color="#E5E5E5"> going to be</font>

371
00:13:04,570 --> 00:13:08,020
the same<font color="#E5E5E5"> however long it takes</font><font color="#CCCCCC"> me to</font>

372
00:13:05,710 --> 00:13:10,120
crack it but I can use Kerberos<font color="#E5E5E5"> to grab</font>

373
00:13:08,020 --> 00:13:11,470
a<font color="#E5E5E5"> ticket and then crack</font><font color="#CCCCCC"> the password of</font>

374
00:13:10,120 --> 00:13:13,810
the service account it<font color="#E5E5E5"> will take longer</font>

375
00:13:11,470 --> 00:13:14,920
and<font color="#E5E5E5"> then use it</font><font color="#CCCCCC"> later</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> that's why that</font>

376
00:13:13,810 --> 00:13:16,209
<font color="#CCCCCC">one is interesting finding all those</font>

377
00:13:14,920 --> 00:13:21,370
service accounts on the network so I

378
00:13:16,210 --> 00:13:23,290
know what the target<font color="#CCCCCC"> next if you ever</font>

379
00:13:21,370 --> 00:13:25,330
made your<font color="#E5E5E5"> way to another computer and</font>

380
00:13:23,290 --> 00:13:28,660
<font color="#E5E5E5">you needed some tools that</font><font color="#CCCCCC"> weren't there</font>

381
00:13:25,330 --> 00:13:30,100
again you can use<font color="#E5E5E5"> the FTP</font><font color="#CCCCCC"> without</font><font color="#E5E5E5"> having</font>

382
00:13:28,660 --> 00:13:32,469
<font color="#E5E5E5">to download a client you</font><font color="#CCCCCC"> can just use</font>

383
00:13:30,100 --> 00:13:34,990
this<font color="#CCCCCC"> powershell ftp</font><font color="#E5E5E5"> script here's an</font>

384
00:13:32,470 --> 00:13:36,370
<font color="#CCCCCC">example up here of me setting up</font><font color="#E5E5E5"> the</font>

385
00:13:34,990 --> 00:13:38,080
<font color="#CCCCCC">connection and</font><font color="#E5E5E5"> then I just made the</font>

386
00:13:36,370 --> 00:13:39,430
connection over<font color="#E5E5E5"> you know these things</font>

387
00:13:38,080 --> 00:13:42,610
come in<font color="#E5E5E5"> handy if you're trying to</font>

388
00:13:39,430 --> 00:13:46,140
exfiltrate data<font color="#E5E5E5"> and get things off</font><font color="#CCCCCC"> the</font>

389
00:13:42,610 --> 00:13:46,140
<font color="#E5E5E5">network or from another</font><font color="#CCCCCC"> NOAA computer</font>

390
00:13:53,530 --> 00:13:58,510
the<font color="#CCCCCC"> ideas internal power</font><font color="#E5E5E5"> PowerShell</font>

391
00:13:56,560 --> 00:14:00,699
module<font color="#CCCCCC"> those things are</font><font color="#E5E5E5"> great as</font><font color="#CCCCCC"> well</font>

392
00:13:58,510 --> 00:14:03,360
this guy has wrote<font color="#CCCCCC"> a ton of</font>

393
00:14:00,700 --> 00:14:05,590
<font color="#CCCCCC">functionality and</font><font color="#E5E5E5"> his</font><font color="#CCCCCC"> tool set</font>

394
00:14:03,360 --> 00:14:07,030
<font color="#CCCCCC">PowerShell version 5</font><font color="#E5E5E5"> also comes with the</font>

395
00:14:05,590 --> 00:14:08,860
way you guys<font color="#E5E5E5"> familiar with the apt</font>

396
00:14:07,030 --> 00:14:11,949
packet manager or the yum packet manager

397
00:14:08,860 --> 00:14:13,870
in Linux<font color="#E5E5E5"> Windows PowerShell version 5</font>

398
00:14:11,950 --> 00:14:15,070
has something very<font color="#E5E5E5"> similar</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> option is</font>

399
00:14:13,870 --> 00:14:16,390
called<font color="#CCCCCC"> new gate</font><font color="#E5E5E5"> Machamer with</font><font color="#CCCCCC"> the other</font>

400
00:14:15,070 --> 00:14:20,380
ones called that<font color="#E5E5E5"> you can straight up say</font>

401
00:14:16,390 --> 00:14:22,540
import<font color="#CCCCCC"> das</font><font color="#E5E5E5"> internals module</font><font color="#CCCCCC"> a camera</font>

402
00:14:20,380 --> 00:14:23,710
with actual command<font color="#CCCCCC"> but you can it'll go</font>

403
00:14:22,540 --> 00:14:24,910
<font color="#CCCCCC">out to the repository and</font><font color="#E5E5E5"> get it from</font>

404
00:14:23,710 --> 00:14:26,260
<font color="#CCCCCC">the</font><font color="#E5E5E5"> command line just kind of like app</font>

405
00:14:24,910 --> 00:14:27,850
does it<font color="#E5E5E5"> doesn't actually you</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have</font>

406
00:14:26,260 --> 00:14:29,380
to<font color="#E5E5E5"> download and install any of that kind</font>

407
00:14:27,850 --> 00:14:33,640
<font color="#CCCCCC">of stuff that's a PowerShell</font><font color="#E5E5E5"> version but</font>

408
00:14:29,380 --> 00:14:35,080
anyways these<font color="#E5E5E5"> are some</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the scripts</font>

409
00:14:33,640 --> 00:14:35,949
<font color="#CCCCCC">that he has the functionality in</font><font color="#E5E5E5"> there</font>

410
00:14:35,080 --> 00:14:39,280
<font color="#E5E5E5">and I'm</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> with over a couple</font>

411
00:14:35,950 --> 00:14:40,420
screenshots on them but<font color="#E5E5E5"> notice up on the</font>

412
00:14:39,280 --> 00:14:42,069
upper right corner talks about

413
00:14:40,420 --> 00:14:43,990
converting<font color="#E5E5E5"> hashes if you need to know a</font>

414
00:14:42,070 --> 00:14:45,280
you know<font color="#CCCCCC"> a password</font><font color="#E5E5E5"> and you want to try</font>

415
00:14:43,990 --> 00:14:46,480
and pass the hash across<font color="#CCCCCC"> the net where</font>

416
00:14:45,280 --> 00:14:47,890
<font color="#E5E5E5">you can go give it</font><font color="#CCCCCC"> you know the clear</font>

417
00:14:46,480 --> 00:14:52,930
text password and then create the hash

418
00:14:47,890 --> 00:14:54,670
so that you<font color="#E5E5E5"> could pass it around but one</font>

419
00:14:52,930 --> 00:14:55,839
of<font color="#E5E5E5"> my favorites I</font><font color="#CCCCCC"> love</font><font color="#E5E5E5"> the MTD s that</font>

420
00:14:54,670 --> 00:14:58,120
<font color="#E5E5E5">bit file I'm not sure if you guys know</font>

421
00:14:55,840 --> 00:14:59,350
you<font color="#E5E5E5"> most talked about</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> actually</font><font color="#CCCCCC"> David</font>

422
00:14:58,120 --> 00:15:01,120
you talked<font color="#CCCCCC"> about it</font><font color="#E5E5E5"> earlier in your home</font>

423
00:14:59,350 --> 00:15:03,370
lab about<font color="#E5E5E5"> how you extricated with with</font>

424
00:15:01,120 --> 00:15:06,370
crack<font color="#E5E5E5"> map here is another way to do it</font>

425
00:15:03,370 --> 00:15:08,620
with a<font color="#E5E5E5"> PowerShell only tool</font><font color="#CCCCCC"> first you</font>

426
00:15:06,370 --> 00:15:10,590
got<font color="#CCCCCC"> to get a copy</font><font color="#E5E5E5"> that's this key and</font>

427
00:15:08,620 --> 00:15:13,180
then you add<font color="#CCCCCC"> that to an object</font><font color="#E5E5E5"> and</font>

428
00:15:10,590 --> 00:15:15,490
PowerShell<font color="#CCCCCC"> and then you come down</font><font color="#E5E5E5"> here</font>

429
00:15:13,180 --> 00:15:17,109
and you just<font color="#CCCCCC"> use this tool from the</font>

430
00:15:15,490 --> 00:15:20,410
<font color="#CCCCCC">DEA's internal suite and it will</font><font color="#E5E5E5"> extract</font>

431
00:15:17,110 --> 00:15:23,500
all the<font color="#E5E5E5"> all the</font><font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> NTDs</font><font color="#CCCCCC"> zip file it</font>

432
00:15:20,410 --> 00:15:25,120
<font color="#E5E5E5">actually gives you back an object that</font>

433
00:15:23,500 --> 00:15:26,320
contains all the<font color="#CCCCCC"> information about</font><font color="#E5E5E5"> the</font>

434
00:15:25,120 --> 00:15:27,340
user I didn't show here<font color="#E5E5E5"> because it's</font>

435
00:15:26,320 --> 00:15:29,320
<font color="#E5E5E5">really long so there's a lot of</font>

436
00:15:27,340 --> 00:15:31,030
<font color="#E5E5E5">information associated</font><font color="#CCCCCC"> with the user but</font>

437
00:15:29,320 --> 00:15:32,800
some<font color="#E5E5E5"> of those things</font><font color="#CCCCCC"> have no or comments</font>

438
00:15:31,030 --> 00:15:35,949
<font color="#E5E5E5">that are typed in about the user or</font>

439
00:15:32,800 --> 00:15:37,810
let's say<font color="#CCCCCC"> they're past ten password</font>

440
00:15:35,950 --> 00:15:39,490
hashes<font color="#CCCCCC"> are in there so again you get</font>

441
00:15:37,810 --> 00:15:40,959
back an<font color="#E5E5E5"> object out of PowerShell you can</font>

442
00:15:39,490 --> 00:15:42,130
do something<font color="#E5E5E5"> with you can automate</font><font color="#CCCCCC"> an</font>

443
00:15:40,960 --> 00:15:46,000
script and do lots<font color="#E5E5E5"> of things with it</font>

444
00:15:42,130 --> 00:15:47,860
after<font color="#E5E5E5"> that this one down here also after</font>

445
00:15:46,000 --> 00:15:50,950
I pulled everything out<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> Dead file</font>

446
00:15:47,860 --> 00:15:52,600
with<font color="#E5E5E5"> this module it has a nice other</font>

447
00:15:50,950 --> 00:15:53,800
script<font color="#CCCCCC"> we'll give</font><font color="#E5E5E5"> it out</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> an hash cap</font>

448
00:15:52,600 --> 00:15:55,510
format so you<font color="#E5E5E5"> can send it straight</font><font color="#CCCCCC"> to</font>

449
00:15:53,800 --> 00:15:56,740
your cracker without it has one for John

450
00:15:55,510 --> 00:15:58,540
John<font color="#E5E5E5"> the Ripper is</font>

451
00:15:56,740 --> 00:16:00,250
so<font color="#E5E5E5"> that was comes in handy</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know it's</font>

452
00:15:58,540 --> 00:16:01,810
like right now if you<font color="#E5E5E5"> use any of the</font>

453
00:16:00,250 --> 00:16:03,250
<font color="#CCCCCC">other tools</font><font color="#E5E5E5"> you had to kind of format</font>

454
00:16:01,810 --> 00:16:05,109
your text file for whichever password

455
00:16:03,250 --> 00:16:06,580
cracker you're gonna use but this one

456
00:16:05,110 --> 00:16:08,380
has<font color="#CCCCCC"> it built right into the pipe to</font>

457
00:16:06,580 --> 00:16:14,380
object to it<font color="#E5E5E5"> and they'll spit it on the</font>

458
00:16:08,380 --> 00:16:15,880
<font color="#CCCCCC">formatting it another</font><font color="#E5E5E5"> great tool is</font>

459
00:16:14,380 --> 00:16:17,080
called dark observer<font color="#CCCCCC"> it has a ton of</font>

460
00:16:15,880 --> 00:16:18,640
functionality I'm not gonna go over<font color="#CCCCCC"> all</font>

461
00:16:17,080 --> 00:16:20,350
<font color="#CCCCCC">of it</font><font color="#E5E5E5"> you can see I try</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> list it</font><font color="#CCCCCC"> all</font>

462
00:16:18,640 --> 00:16:21,790
here so you<font color="#E5E5E5"> can see but it's great for</font>

463
00:16:20,350 --> 00:16:23,230
basically<font color="#E5E5E5"> once you get on a box</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> a</font>

464
00:16:21,790 --> 00:16:24,699
network you<font color="#E5E5E5"> can just start enumerate</font>

465
00:16:23,230 --> 00:16:28,180
about the network you<font color="#E5E5E5"> want to find</font>

466
00:16:24,700 --> 00:16:32,800
sensitive files<font color="#CCCCCC"> so there you go</font>

467
00:16:28,180 --> 00:16:35,219
<font color="#CCCCCC">Network shares</font><font color="#E5E5E5"> can do a</font><font color="#CCCCCC"> pink sweep looks</font>

468
00:16:32,800 --> 00:16:37,479
like it'll do<font color="#E5E5E5"> virustotal hash analysis</font>

469
00:16:35,220 --> 00:16:38,950
the nice thing about this is someone

470
00:16:37,480 --> 00:16:41,050
wrote<font color="#CCCCCC"> in all PowerShell functionality</font>

471
00:16:38,950 --> 00:16:42,730
how to do all these<font color="#CCCCCC"> things so you</font><font color="#E5E5E5"> don't</font>

472
00:16:41,050 --> 00:16:44,260
<font color="#CCCCCC">need to again</font><font color="#E5E5E5"> put custom binaries</font>

473
00:16:42,730 --> 00:16:46,000
PowerShell is technically a script

474
00:16:44,260 --> 00:16:47,860
language so again you<font color="#E5E5E5"> just pull these</font>

475
00:16:46,000 --> 00:16:49,240
scripts down that do all kinds of<font color="#E5E5E5"> stuff</font>

476
00:16:47,860 --> 00:16:52,090
for you and<font color="#CCCCCC"> I'm just</font><font color="#E5E5E5"> showing you the</font>

477
00:16:49,240 --> 00:16:53,290
functionality<font color="#CCCCCC"> you get with</font><font color="#E5E5E5"> it and</font><font color="#CCCCCC"> then</font>

478
00:16:52,090 --> 00:16:56,470
when you<font color="#CCCCCC"> get access</font><font color="#E5E5E5"> to a remote machine</font>

479
00:16:53,290 --> 00:16:57,880
<font color="#E5E5E5">for me because I'm an attacker</font><font color="#CCCCCC"> my tools</font>

480
00:16:56,470 --> 00:17:00,400
aren't<font color="#E5E5E5"> necessarily on the computer</font><font color="#CCCCCC"> that</font>

481
00:16:57,880 --> 00:17:02,500
<font color="#E5E5E5">compromised and historically you'll you</font>

482
00:17:00,400 --> 00:17:03,910
you might upload<font color="#E5E5E5"> your own binaries and</font>

483
00:17:02,500 --> 00:17:06,339
when you do they'll get flagged by<font color="#E5E5E5"> AV</font>

484
00:17:03,910 --> 00:17:07,599
and then you'll lose but this method<font color="#E5E5E5"> you</font>

485
00:17:06,339 --> 00:17:09,369
know you don't<font color="#E5E5E5"> have to worry about that</font>

486
00:17:07,599 --> 00:17:11,379
<font color="#E5E5E5">connect your computer use PowerShell</font>

487
00:17:09,369 --> 00:17:13,208
<font color="#E5E5E5">then download my tool in memory and you</font>

488
00:17:11,380 --> 00:17:18,640
the computers on the wiser that my tools

489
00:17:13,209 --> 00:17:20,650
that's<font color="#CCCCCC"> they're doing its thing and you</font>

490
00:17:18,640 --> 00:17:23,170
guys I<font color="#E5E5E5"> hear you use</font><font color="#CCCCCC"> OWA</font><font color="#E5E5E5"> or familiar with</font>

491
00:17:20,650 --> 00:17:24,820
owh owh great for us when we're doing

492
00:17:23,170 --> 00:17:27,430
<font color="#E5E5E5">external assessments because it provides</font>

493
00:17:24,819 --> 00:17:28,510
an interface<font color="#E5E5E5"> to one act or interact with</font>

494
00:17:27,430 --> 00:17:29,920
Active Directory<font color="#E5E5E5"> because they're</font>

495
00:17:28,510 --> 00:17:32,230
typically using Active Directory creds

496
00:17:29,920 --> 00:17:34,090
<font color="#CCCCCC">and it's a good way</font><font color="#E5E5E5"> to do</font><font color="#CCCCCC"> password</font>

497
00:17:32,230 --> 00:17:39,310
<font color="#E5E5E5">spring anybody know what password spring</font>

498
00:17:34,090 --> 00:17:40,750
is brute-forcing is where you do<font color="#E5E5E5"> one</font>

499
00:17:39,310 --> 00:17:42,730
user<font color="#E5E5E5"> can't with multiple passwords over</font>

500
00:17:40,750 --> 00:17:44,590
<font color="#E5E5E5">and over password spring is the inverse</font>

501
00:17:42,730 --> 00:17:46,600
of I know all the user accounts<font color="#CCCCCC"> and I</font>

502
00:17:44,590 --> 00:17:48,850
just try one password<font color="#CCCCCC"> across</font><font color="#E5E5E5"> all of them</font>

503
00:17:46,600 --> 00:17:51,490
so if<font color="#E5E5E5"> I use something like the harvester</font>

504
00:17:48,850 --> 00:17:54,100
or anything<font color="#E5E5E5"> else to scrape your</font>

505
00:17:51,490 --> 00:17:56,170
organization's<font color="#E5E5E5"> email accounts I now have</font>

506
00:17:54,100 --> 00:17:58,330
a full list of<font color="#CCCCCC"> user names</font><font color="#E5E5E5"> and I could</font>

507
00:17:56,170 --> 00:18:00,460
take<font color="#CCCCCC"> that set of user names</font><font color="#E5E5E5"> I can use</font>

508
00:17:58,330 --> 00:18:02,020
<font color="#E5E5E5">something like this</font><font color="#CCCCCC"> OWA toolkit and I</font>

509
00:18:00,460 --> 00:18:05,080
can<font color="#E5E5E5"> launch a brute force attack against</font>

510
00:18:02,020 --> 00:18:06,400
all<font color="#E5E5E5"> the user names with one password</font><font color="#CCCCCC"> a</font>

511
00:18:05,080 --> 00:18:06,870
good<font color="#E5E5E5"> one right now would be something</font>

512
00:18:06,400 --> 00:18:08,910
like

513
00:18:06,870 --> 00:18:11,550
<font color="#E5E5E5">or 2016 that's guaranteed to give me at</font>

514
00:18:08,910 --> 00:18:14,480
least<font color="#CCCCCC"> one hit</font><font color="#E5E5E5"> and that's frankly all we</font>

515
00:18:11,550 --> 00:18:16,710
need is just<font color="#CCCCCC"> one connection after that</font>

516
00:18:14,480 --> 00:18:17,820
and if that<font color="#E5E5E5"> wasn't good enough for you</font>

517
00:18:16,710 --> 00:18:19,050
you<font color="#CCCCCC"> can also again this is all from</font>

518
00:18:17,820 --> 00:18:20,429
<font color="#E5E5E5">external from</font><font color="#CCCCCC"> internet this isn't</font>

519
00:18:19,050 --> 00:18:22,440
<font color="#E5E5E5">required to be local in the network</font><font color="#CCCCCC"> for</font>

520
00:18:20,430 --> 00:18:24,030
<font color="#E5E5E5">this tool I can use it to</font><font color="#CCCCCC"> download a</font>

521
00:18:22,440 --> 00:18:25,890
<font color="#E5E5E5">copy of your address book the gal the</font>

522
00:18:24,030 --> 00:18:28,020
global<font color="#CCCCCC"> address list</font><font color="#E5E5E5"> off your email</font>

523
00:18:25,890 --> 00:18:29,730
server but once I have valid creds that

524
00:18:28,020 --> 00:18:31,139
have to<font color="#CCCCCC"> Cobell creds first but this is a</font>

525
00:18:29,730 --> 00:18:32,580
good tool for<font color="#E5E5E5"> that here's some</font><font color="#CCCCCC"> of the</font>

526
00:18:31,140 --> 00:18:34,380
<font color="#E5E5E5">other modules that it has in there you</font>

527
00:18:32,580 --> 00:18:36,240
can you can use this<font color="#CCCCCC"> PowerShell script</font>

528
00:18:34,380 --> 00:18:38,520
to just strip write a message<font color="#E5E5E5"> you can</font>

529
00:18:36,240 --> 00:18:40,110
see that<font color="#E5E5E5"> last command down at the bottom</font>

530
00:18:38,520 --> 00:18:43,490
<font color="#CCCCCC">I can write email from PowerShell and</font>

531
00:18:40,110 --> 00:18:43,490
<font color="#E5E5E5">just turn on send it out after that</font>

532
00:18:45,140 --> 00:18:51,600
anybody know what the Swiss Army<font color="#CCCCCC"> knife</font>

533
00:18:47,220 --> 00:18:54,270
<font color="#CCCCCC">of</font><font color="#E5E5E5"> network security</font><font color="#CCCCCC"> is netcat</font><font color="#E5E5E5"> yeah well</font>

534
00:18:51,600 --> 00:18:56,428
someone<font color="#CCCCCC"> put it in PowerShell</font><font color="#E5E5E5"> which is</font>

535
00:18:54,270 --> 00:18:59,340
great again net cats a binary I'm<font color="#CCCCCC"> not to</font>

536
00:18:56,429 --> 00:19:02,250
put on your box<font color="#CCCCCC"> this isn't a binary I</font>

537
00:18:59,340 --> 00:19:03,360
don't have to again<font color="#CCCCCC"> who's the</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> yet to</font>

538
00:19:02,250 --> 00:19:05,460
<font color="#E5E5E5">download string I was talking about</font>

539
00:19:03,360 --> 00:19:07,199
earlier<font color="#E5E5E5"> get connect to your computer</font><font color="#CCCCCC"> I</font>

540
00:19:05,460 --> 00:19:08,340
don't have my<font color="#E5E5E5"> tools</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> there so what do</font>

541
00:19:07,200 --> 00:19:09,720
i do<font color="#E5E5E5"> I just download it from the</font>

542
00:19:08,340 --> 00:19:11,270
internet<font color="#CCCCCC"> this woman I actually had on a</font>

543
00:19:09,720 --> 00:19:13,920
<font color="#E5E5E5">local computer</font><font color="#CCCCCC"> but you can give it</font>

544
00:19:11,270 --> 00:19:16,500
<font color="#E5E5E5">wherever it's at download it it's in</font>

545
00:19:13,920 --> 00:19:20,030
memory<font color="#E5E5E5"> then you can use it so what I</font><font color="#CCCCCC"> did</font>

546
00:19:16,500 --> 00:19:22,200
<font color="#CCCCCC">here was set up</font><font color="#E5E5E5"> a bind show listening</font>

547
00:19:20,030 --> 00:19:26,100
<font color="#E5E5E5">and</font><font color="#CCCCCC"> it was gonna give</font><font color="#E5E5E5"> back PowerShell</font>

548
00:19:22,200 --> 00:19:27,660
afterwards and there's an<font color="#CCCCCC"> example</font>

549
00:19:26,100 --> 00:19:29,580
<font color="#E5E5E5">connected with the netcat on my attacker</font>

550
00:19:27,660 --> 00:19:31,140
machine<font color="#E5E5E5"> over to that barn shell and</font><font color="#CCCCCC"> as</font>

551
00:19:29,580 --> 00:19:33,360
<font color="#CCCCCC">you notice I</font><font color="#E5E5E5"> got the PowerShell terminal</font>

552
00:19:31,140 --> 00:19:35,750
right<font color="#E5E5E5"> off the bat so that's always nice</font>

553
00:19:33,360 --> 00:19:35,750
as well

554
00:19:40,170 --> 00:19:46,120
and you guys say my talk last<font color="#CCCCCC"> year</font><font color="#E5E5E5"> on w</font>

555
00:19:42,940 --> 00:19:48,040
pad or<font color="#CCCCCC"> NetBIOS spoofing honestly offs</font><font color="#E5E5E5"> my</font>

556
00:19:46,120 --> 00:19:49,060
favorite way to<font color="#E5E5E5"> attack a network</font><font color="#CCCCCC"> i used</font>

557
00:19:48,040 --> 00:19:50,530
to roll into a network<font color="#E5E5E5"> and do a</font>

558
00:19:49,060 --> 00:19:52,120
<font color="#E5E5E5">vulnerability</font><font color="#CCCCCC"> assessment first now i'd</font>

559
00:19:50,530 --> 00:19:53,440
know<font color="#CCCCCC"> i just</font><font color="#E5E5E5"> go in and start spoofing</font>

560
00:19:52,120 --> 00:19:54,969
names and collecting hashes right off

561
00:19:53,440 --> 00:19:57,970
the bat<font color="#CCCCCC"> i don't even</font><font color="#E5E5E5"> waste my time</font>

562
00:19:54,970 --> 00:19:59,950
trying<font color="#CCCCCC"> to find</font><font color="#E5E5E5"> other vulnerabilities but</font>

563
00:19:57,970 --> 00:20:01,660
i use the tool called<font color="#E5E5E5"> python responder</font>

564
00:19:59,950 --> 00:20:04,800
which david also<font color="#E5E5E5"> talked about in his</font>

565
00:20:01,660 --> 00:20:07,480
talk it's a great tool<font color="#CCCCCC"> i love using it</font>

566
00:20:04,800 --> 00:20:08,440
<font color="#E5E5E5">this is that</font><font color="#CCCCCC"> packed with like python</font>

567
00:20:07,480 --> 00:20:09,970
responder<font color="#CCCCCC"> but this is written</font><font color="#E5E5E5"> in</font>

568
00:20:08,440 --> 00:20:11,410
<font color="#E5E5E5">powershell it's called in bay and it</font>

569
00:20:09,970 --> 00:20:13,480
does the same<font color="#CCCCCC"> thing it listens on</font><font color="#E5E5E5"> the</font>

570
00:20:11,410 --> 00:20:15,610
network for<font color="#CCCCCC"> NetBIOS traffic or</font>

571
00:20:13,480 --> 00:20:18,100
link-local multicast<font color="#E5E5E5"> name resolution</font>

572
00:20:15,610 --> 00:20:20,020
traffic and<font color="#E5E5E5"> it's spoofs to it and then</font>

573
00:20:18,100 --> 00:20:21,070
people will send<font color="#CCCCCC"> back their hashes</font><font color="#E5E5E5"> and</font>

574
00:20:20,020 --> 00:20:23,350
then you can start<font color="#CCCCCC"> trying to crack the</font>

575
00:20:21,070 --> 00:20:25,230
password hashes<font color="#CCCCCC"> from there again this is</font>

576
00:20:23,350 --> 00:20:28,330
<font color="#E5E5E5">great especially for trying to pivot</font>

577
00:20:25,230 --> 00:20:30,160
<font color="#E5E5E5">compromised a machine in the DMZ</font><font color="#CCCCCC"> I don't</font>

578
00:20:28,330 --> 00:20:32,560
want to upload my<font color="#CCCCCC"> own tools I can't run</font>

579
00:20:30,160 --> 00:20:34,990
Python responder on<font color="#E5E5E5"> that domain</font>

580
00:20:32,560 --> 00:20:36,940
<font color="#E5E5E5">controller that I just got to so instead</font>

581
00:20:34,990 --> 00:20:39,520
I will<font color="#E5E5E5"> just</font><font color="#CCCCCC"> upload this</font><font color="#E5E5E5"> with the</font><font color="#CCCCCC"> i-x</font>

582
00:20:36,940 --> 00:20:41,140
download cradle<font color="#E5E5E5"> in the memory and I will</font>

583
00:20:39,520 --> 00:20:43,720
run<font color="#E5E5E5"> my own</font><font color="#CCCCCC"> net</font><font color="#E5E5E5"> by a spoofer straight</font>

584
00:20:41,140 --> 00:20:48,900
from that<font color="#CCCCCC"> computer</font><font color="#E5E5E5"> instead</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> here is</font>

585
00:20:43,720 --> 00:20:50,620
a example<font color="#CCCCCC"> of me capturing</font><font color="#E5E5E5"> two HTTP ntlm</font>

586
00:20:48,900 --> 00:20:53,050
hashes coming back

587
00:20:50,620 --> 00:20:54,399
<font color="#CCCCCC">I'd have</font><font color="#E5E5E5"> to crack them but trust me</font>

588
00:20:53,050 --> 00:20:56,560
<font color="#E5E5E5">typically always be at least one</font>

589
00:20:54,400 --> 00:21:01,750
password<font color="#CCCCCC"> it can we only</font><font color="#E5E5E5"> need one</font><font color="#CCCCCC"> to kind</font>

590
00:20:56,560 --> 00:21:03,639
of go on<font color="#CCCCCC"> alright power tools this is</font>

591
00:21:01,750 --> 00:21:05,740
this is one my favorite<font color="#E5E5E5"> I got a secret</font>

592
00:21:03,640 --> 00:21:07,860
<font color="#E5E5E5">man crush on will shoulder he wrote a</font>

593
00:21:05,740 --> 00:21:09,910
lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> tools that I talked</font><font color="#CCCCCC"> about</font>

594
00:21:07,860 --> 00:21:11,530
<font color="#CCCCCC">he's one of</font><font color="#E5E5E5"> my favorite guys when it</font>

595
00:21:09,910 --> 00:21:14,110
comes to<font color="#E5E5E5"> PowerShell especially offensive</font>

596
00:21:11,530 --> 00:21:16,180
tool tools power tools has all of<font color="#E5E5E5"> these</font>

597
00:21:14,110 --> 00:21:20,080
<font color="#E5E5E5">tools in it</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> personally have not used</font>

598
00:21:16,180 --> 00:21:23,260
the<font color="#E5E5E5"> pewpewpew or the power</font><font color="#CCCCCC"> breech</font><font color="#E5E5E5"> I have</font>

599
00:21:20,080 --> 00:21:25,990
used<font color="#E5E5E5"> power pick power pick is I think</font>

600
00:21:23,260 --> 00:21:30,070
it's a<font color="#E5E5E5"> c-sharp but it might be see if it</font>

601
00:21:25,990 --> 00:21:31,330
says on there now<font color="#CCCCCC"> it's either C sharp</font>

602
00:21:30,070 --> 00:21:33,760
<font color="#CCCCCC">received plus plus but</font><font color="#E5E5E5"> it's a way to</font>

603
00:21:31,330 --> 00:21:35,590
execute power shell<font color="#E5E5E5"> in a compiled</font>

604
00:21:33,760 --> 00:21:37,300
<font color="#E5E5E5">language like C sharp and it doesn't</font>

605
00:21:35,590 --> 00:21:38,439
it's not<font color="#E5E5E5"> you it's not a tool you can</font>

606
00:21:37,300 --> 00:21:39,879
<font color="#CCCCCC">actually download it run you'll have to</font>

607
00:21:38,440 --> 00:21:41,480
download<font color="#CCCCCC"> it into</font><font color="#E5E5E5"> the visual</font><font color="#CCCCCC"> studio and</font>

608
00:21:39,880 --> 00:21:43,100
<font color="#E5E5E5">use it to compile</font><font color="#CCCCCC"> your code</font>

609
00:21:41,480 --> 00:21:49,700
stuff but it's a way to run PowerShell

610
00:21:43,100 --> 00:21:51,168
commands from executable<font color="#CCCCCC"> power up</font><font color="#E5E5E5"> again</font>

611
00:21:49,700 --> 00:21:53,120
Andrew<font color="#CCCCCC"> sniffs and</font><font color="#E5E5E5"> my coworker he's gonna</font>

612
00:21:51,169 --> 00:21:55,640
talk on press collation<font color="#E5E5E5"> across the way</font>

613
00:21:53,120 --> 00:21:58,100
<font color="#CCCCCC">power</font><font color="#E5E5E5"> up does that it's a one powershell</font>

614
00:21:55,640 --> 00:22:00,799
script<font color="#E5E5E5"> again</font><font color="#CCCCCC"> he's</font><font color="#E5E5E5"> IX</font><font color="#CCCCCC"> down low cradle on</font>

615
00:21:58,100 --> 00:22:02,689
<font color="#CCCCCC">commas compromise</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> machine pull it</font>

616
00:22:00,799 --> 00:22:04,250
<font color="#E5E5E5">down it does all the privilege</font>

617
00:22:02,690 --> 00:22:06,320
escalation checks for you checks for

618
00:22:04,250 --> 00:22:07,760
<font color="#CCCCCC">unquoted</font><font color="#E5E5E5"> service</font><font color="#CCCCCC"> paths and</font><font color="#E5E5E5"> places</font><font color="#CCCCCC"> that</font>

619
00:22:06,320 --> 00:22:09,260
you can write to and service that<font color="#CCCCCC"> you</font>

620
00:22:07,760 --> 00:22:11,270
can<font color="#E5E5E5"> change</font><font color="#CCCCCC"> and it gives you a nice</font>

621
00:22:09,260 --> 00:22:12,500
little<font color="#CCCCCC"> report when you're done so</font><font color="#E5E5E5"> gone</font>

622
00:22:11,270 --> 00:22:14,150
<font color="#E5E5E5">are the days oh I have to manually go</font>

623
00:22:12,500 --> 00:22:15,710
<font color="#CCCCCC">through</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> do a process</font><font color="#E5E5E5"> list and see</font>

624
00:22:14,150 --> 00:22:17,570
<font color="#E5E5E5">well the service</font><font color="#CCCCCC"> paths are and see if I</font>

625
00:22:15,710 --> 00:22:19,250
can change<font color="#CCCCCC"> any of them</font><font color="#E5E5E5"> just run this</font>

626
00:22:17,570 --> 00:22:24,379
<font color="#CCCCCC">powerup</font><font color="#E5E5E5"> script and will tell me my</font>

627
00:22:19,250 --> 00:22:27,140
methods for being able to privilege<font color="#CCCCCC"> my</font>

628
00:22:24,380 --> 00:22:28,340
privileges<font color="#E5E5E5"> and to top that off it'll</font>

629
00:22:27,140 --> 00:22:29,570
tell you where it's done<font color="#E5E5E5"> and then you</font>

630
00:22:28,340 --> 00:22:31,418
<font color="#E5E5E5">can just run another command</font><font color="#CCCCCC"> let's it</font>

631
00:22:29,570 --> 00:22:33,710
actually do it for<font color="#E5E5E5"> you so it'll say this</font>

632
00:22:31,419 --> 00:22:35,179
service has<font color="#CCCCCC"> a unquoted service path and</font>

633
00:22:33,710 --> 00:22:36,650
if you run this command it<font color="#CCCCCC"> will go ahead</font>

634
00:22:35,179 --> 00:22:37,940
<font color="#E5E5E5">and replace</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> command with your own</font>

635
00:22:36,650 --> 00:22:40,340
service path and you're buying air and

636
00:22:37,940 --> 00:22:42,049
you're good<font color="#E5E5E5"> to go but</font><font color="#CCCCCC"> my all-time</font>

637
00:22:40,340 --> 00:22:43,399
favorite is<font color="#E5E5E5"> Power View if I've ever</font>

638
00:22:42,049 --> 00:22:45,139
worked with<font color="#E5E5E5"> any of you before</font><font color="#CCCCCC"> you'll</font>

639
00:22:43,400 --> 00:22:46,730
<font color="#CCCCCC">thing we talked about</font><font color="#E5E5E5"> power of</font><font color="#CCCCCC"> you power</font>

640
00:22:45,140 --> 00:22:50,660
for<font color="#CCCCCC"> you</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> Power View</font><font color="#E5E5E5"> is a beautiful</font>

641
00:22:46,730 --> 00:22:52,549
tool and I'm about to<font color="#CCCCCC"> show you</font><font color="#E5E5E5"> why this</font>

642
00:22:50,660 --> 00:22:54,290
can<font color="#CCCCCC"> actually be used by blue teamers on</font>

643
00:22:52,549 --> 00:22:55,639
a<font color="#E5E5E5"> network I think there's a practical</font>

644
00:22:54,290 --> 00:22:59,659
<font color="#CCCCCC">application for</font><font color="#E5E5E5"> that as well but I've</font>

645
00:22:55,640 --> 00:23:01,160
typically<font color="#E5E5E5"> use it as red teamer so the</font>

646
00:22:59,660 --> 00:23:04,250
kind of the layout<font color="#CCCCCC"> that I did here was</font>

647
00:23:01,160 --> 00:23:06,679
the<font color="#CCCCCC"> boulder</font><font color="#E5E5E5"> the bull text is like the</font>

648
00:23:04,250 --> 00:23:08,630
category and the<font color="#E5E5E5"> below are some</font><font color="#CCCCCC"> of the</font>

649
00:23:06,679 --> 00:23:10,400
<font color="#E5E5E5">functions in that category</font><font color="#CCCCCC"> the number</font>

650
00:23:08,630 --> 00:23:11,750
indicates the total<font color="#E5E5E5"> number of modules I</font>

651
00:23:10,400 --> 00:23:13,160
don't want to list<font color="#E5E5E5"> them all</font><font color="#CCCCCC"> out here I</font>

652
00:23:11,750 --> 00:23:14,630
just want to kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> highlight some of</font>

653
00:23:13,160 --> 00:23:16,130
the better ones<font color="#CCCCCC"> I'll get into some</font>

654
00:23:14,630 --> 00:23:18,169
screenshots here<font color="#CCCCCC"> to actually</font><font color="#E5E5E5"> show them I</font>

655
00:23:16,130 --> 00:23:23,480
<font color="#E5E5E5">knew that as you can see there's a</font><font color="#CCCCCC"> ton</font>

656
00:23:18,169 --> 00:23:24,830
of functionality going on in here one of

657
00:23:23,480 --> 00:23:28,750
our<font color="#CCCCCC"> particular favorite ones</font><font color="#E5E5E5"> is user</font>

658
00:23:24,830 --> 00:23:30,020
hunting<font color="#E5E5E5"> which I'll get into in a second</font>

659
00:23:28,750 --> 00:23:32,419
all right

660
00:23:30,020 --> 00:23:34,790
here's an<font color="#CCCCCC"> example</font><font color="#E5E5E5"> of Power View Power</font>

661
00:23:32,419 --> 00:23:36,380
View does require<font color="#E5E5E5"> to me to have one set</font>

662
00:23:34,790 --> 00:23:38,210
<font color="#E5E5E5">of</font><font color="#CCCCCC"> ballad user</font><font color="#E5E5E5"> domain so typically when</font>

663
00:23:36,380 --> 00:23:40,820
I start an engagement<font color="#E5E5E5"> I connect my</font>

664
00:23:38,210 --> 00:23:43,100
computer to<font color="#E5E5E5"> your network and I have no</font>

665
00:23:40,820 --> 00:23:44,540
I'm not a domain<font color="#CCCCCC"> joined machine I</font><font color="#E5E5E5"> don't</font>

666
00:23:43,100 --> 00:23:44,719
have any domain<font color="#E5E5E5"> user accounts I don't</font>

667
00:23:44,540 --> 00:23:46,730
have

668
00:23:44,720 --> 00:23:49,700
<font color="#E5E5E5">like that so then I'll do stuff like the</font>

669
00:23:46,730 --> 00:23:51,679
<font color="#E5E5E5">W pad or the</font><font color="#CCCCCC"> N</font><font color="#E5E5E5"> Bay is some broadcast</font>

670
00:23:49,700 --> 00:23:54,020
spoofing get some hashes back crack one

671
00:23:51,679 --> 00:23:56,510
and then all these commands that you'll

672
00:23:54,020 --> 00:23:57,799
see<font color="#E5E5E5"> run in Power View can be any normal</font>

673
00:23:56,510 --> 00:23:59,480
user<font color="#CCCCCC"> they don't have to be admin user</font>

674
00:23:57,799 --> 00:24:01,270
none of the such just a normal user

675
00:23:59,480 --> 00:24:02,809
account works to do everything<font color="#CCCCCC"> and</font>

676
00:24:01,270 --> 00:24:04,879
<font color="#E5E5E5">essentially what it's doing in the</font>

677
00:24:02,809 --> 00:24:07,070
<font color="#CCCCCC">background is</font><font color="#E5E5E5"> it's asking Active</font>

678
00:24:04,880 --> 00:24:08,510
Directory a ton of questions<font color="#E5E5E5"> and it puts</font>

679
00:24:07,070 --> 00:24:11,059
it into<font color="#CCCCCC"> powerful objects that</font><font color="#E5E5E5"> you can do</font>

680
00:24:08,510 --> 00:24:12,919
<font color="#CCCCCC">stuff with</font><font color="#E5E5E5"> so for this one I want to</font>

681
00:24:11,059 --> 00:24:14,870
know the domain Sid<font color="#E5E5E5"> which is probably</font>

682
00:24:12,919 --> 00:24:17,150
pretty<font color="#CCCCCC"> boring</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> if you</font><font color="#E5E5E5"> ever wanted to</font>

683
00:24:14,870 --> 00:24:19,340
<font color="#CCCCCC">brute-force the domain admin account</font><font color="#E5E5E5"> and</font>

684
00:24:17,150 --> 00:24:20,720
they happen to have changed<font color="#E5E5E5"> a username</font>

685
00:24:19,340 --> 00:24:23,110
from administrator to something else

686
00:24:20,720 --> 00:24:25,640
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is how you can find</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> what it is</font>

687
00:24:23,110 --> 00:24:27,918
<font color="#CCCCCC">the administrator account on every</font>

688
00:24:25,640 --> 00:24:29,299
computer<font color="#E5E5E5"> ends with a</font><font color="#CCCCCC"> writ or</font><font color="#E5E5E5"> relative</font>

689
00:24:27,919 --> 00:24:30,350
identifier and it says the number<font color="#CCCCCC"> is</font>

690
00:24:29,299 --> 00:24:33,620
anybody know what that<font color="#CCCCCC"> number is that</font>

691
00:24:30,350 --> 00:24:36,379
<font color="#CCCCCC">all administrators in 10500 that's right</font>

692
00:24:33,620 --> 00:24:38,449
so<font color="#E5E5E5"> I got the domain Sid</font><font color="#CCCCCC"> I put - 500 on</font>

693
00:24:36,380 --> 00:24:40,309
and I found<font color="#E5E5E5"> out well</font><font color="#CCCCCC"> on this domain the</font>

694
00:24:38,450 --> 00:24:42,710
domain administrators name is super

695
00:24:40,309 --> 00:24:44,178
<font color="#E5E5E5">admin not admin so that was handy for me</font>

696
00:24:42,710 --> 00:24:48,890
to use a<font color="#CCCCCC"> Power View began</font><font color="#E5E5E5"> from a normal</font>

697
00:24:44,179 --> 00:24:51,350
<font color="#CCCCCC">user over here I wanted</font><font color="#E5E5E5"> to find out</font>

698
00:24:48,890 --> 00:24:52,730
<font color="#E5E5E5">stuff about users so I just sent a query</font>

699
00:24:51,350 --> 00:24:55,010
<font color="#E5E5E5">over and ad told me all this stuff</font>

700
00:24:52,730 --> 00:24:56,390
<font color="#CCCCCC">what's</font><font color="#E5E5E5"> interesting here is you</font><font color="#CCCCCC"> notice I</font>

701
00:24:55,010 --> 00:24:58,669
asked for the<font color="#E5E5E5"> description field that's</font>

702
00:24:56,390 --> 00:25:00,370
an<font color="#E5E5E5"> active directory if you look down</font>

703
00:24:58,669 --> 00:25:02,750
here<font color="#E5E5E5"> there's a bunch of</font><font color="#CCCCCC"> passwords</font><font color="#E5E5E5"> some</font>

704
00:25:00,370 --> 00:25:04,010
smart guy put all the<font color="#CCCCCC"> passwords in</font><font color="#E5E5E5"> the</font>

705
00:25:02,750 --> 00:25:06,260
description comments<font color="#E5E5E5"> and</font><font color="#CCCCCC"> active</font>

706
00:25:04,010 --> 00:25:07,730
<font color="#CCCCCC">directory you'd laugh and say nobody</font>

707
00:25:06,260 --> 00:25:09,340
<font color="#CCCCCC">would ever</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> that but</font><font color="#E5E5E5"> they do I mean</font><font color="#CCCCCC"> I</font>

708
00:25:07,730 --> 00:25:11,450
did this for<font color="#E5E5E5"> my lab environment but</font>

709
00:25:09,340 --> 00:25:13,370
<font color="#CCCCCC">you'll be</font><font color="#E5E5E5"> surprised what you</font><font color="#CCCCCC"> can find</font>

710
00:25:11,450 --> 00:25:15,230
scraping the<font color="#CCCCCC"> comments sections of Active</font>

711
00:25:13,370 --> 00:25:17,570
Directory user objects to see what kind

712
00:25:15,230 --> 00:25:19,070
of information<font color="#CCCCCC"> you can get back if you</font>

713
00:25:17,570 --> 00:25:20,870
don't get password you<font color="#E5E5E5"> can get tons of</font>

714
00:25:19,070 --> 00:25:26,990
other useful information at the<font color="#E5E5E5"> very</font>

715
00:25:20,870 --> 00:25:29,719
least again<font color="#CCCCCC"> here's just a user object</font>

716
00:25:26,990 --> 00:25:31,070
back of the super admin you can<font color="#CCCCCC"> see</font>

717
00:25:29,720 --> 00:25:35,960
there's tons<font color="#E5E5E5"> and tons of stuff on there</font>

718
00:25:31,070 --> 00:25:37,370
<font color="#CCCCCC">about it for</font><font color="#E5E5E5"> this particular</font><font color="#CCCCCC"> engagement</font>

719
00:25:35,960 --> 00:25:39,260
<font color="#E5E5E5">I wanted to know where the enterprise</font>

720
00:25:37,370 --> 00:25:40,489
admins are you know<font color="#E5E5E5"> domain admin</font>

721
00:25:39,260 --> 00:25:42,140
<font color="#CCCCCC">enterprises</font><font color="#E5E5E5"> I mean that's the place I</font>

722
00:25:40,490 --> 00:25:43,970
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be so I was like I don't know</font>

723
00:25:42,140 --> 00:25:46,640
who who's in the enterprise admin so

724
00:25:43,970 --> 00:25:48,500
again I use<font color="#E5E5E5"> Power View from a</font>

725
00:25:46,640 --> 00:25:50,840
non domain computer with a normal user

726
00:25:48,500 --> 00:25:55,700
account<font color="#CCCCCC"> to find out who the enterprise</font>

727
00:25:50,840 --> 00:25:58,100
admins were<font color="#E5E5E5"> that's who they were</font><font color="#CCCCCC"> you can</font>

728
00:25:55,700 --> 00:25:59,510
<font color="#CCCCCC">get some stuff</font><font color="#E5E5E5"> about the</font><font color="#CCCCCC"> gpo's or the</font>

729
00:25:58,100 --> 00:26:01,189
domain<font color="#E5E5E5"> policy</font><font color="#CCCCCC"> as the top tells me the</font>

730
00:25:59,510 --> 00:26:02,420
<font color="#E5E5E5">password policy it allows me to do smart</font>

731
00:26:01,190 --> 00:26:05,179
group<font color="#CCCCCC"> forcings if I know your password</font>

732
00:26:02,420 --> 00:26:06,410
policy seven characters and<font color="#CCCCCC"> complexities</font>

733
00:26:05,179 --> 00:26:07,790
turned off then I won't waste my time

734
00:26:06,410 --> 00:26:09,140
trying complex passwords I'll probably

735
00:26:07,790 --> 00:26:12,500
try the password password and I'll

736
00:26:09,140 --> 00:26:13,640
probably work down here<font color="#CCCCCC"> I get GPL</font>

737
00:26:12,500 --> 00:26:15,380
information sometimes<font color="#E5E5E5"> people save</font>

738
00:26:13,640 --> 00:26:21,620
passwords and GPOs that's a nice place

739
00:26:15,380 --> 00:26:23,179
to<font color="#E5E5E5"> look well the way the GPO is used to</font>

740
00:26:21,620 --> 00:26:24,590
work Microsoft<font color="#CCCCCC"> has fix it now where you</font>

741
00:26:23,179 --> 00:26:26,210
can't do it but<font color="#E5E5E5"> you used to be able to</font>

742
00:26:24,590 --> 00:26:29,600
<font color="#E5E5E5">push the GPO that would set a local</font>

743
00:26:26,210 --> 00:26:31,190
admin password and it was<font color="#E5E5E5"> want to say</font>

744
00:26:29,600 --> 00:26:32,719
encrypted<font color="#E5E5E5"> I don't think it was encoded</font>

745
00:26:31,190 --> 00:26:34,190
I'm pretty sure was encrypted<font color="#CCCCCC"> but then</font>

746
00:26:32,720 --> 00:26:36,200
the key got put<font color="#CCCCCC"> out for it so that way</font>

747
00:26:34,190 --> 00:26:41,750
<font color="#E5E5E5">anybody can decrypt the</font><font color="#CCCCCC"> user</font><font color="#E5E5E5"> the</font>

748
00:26:36,200 --> 00:26:42,980
<font color="#CCCCCC">password</font><font color="#E5E5E5"> from a GPO anyways so I found</font>

749
00:26:41,750 --> 00:26:44,210
<font color="#E5E5E5">out who the enterprise admins were and I</font>

750
00:26:42,980 --> 00:26:47,090
want to know where they're logged in at

751
00:26:44,210 --> 00:26:49,309
so then I use this part of<font color="#E5E5E5"> Power View</font>

752
00:26:47,090 --> 00:26:50,689
called a<font color="#CCCCCC"> VOC user hunter</font><font color="#E5E5E5"> and it will if</font>

753
00:26:49,309 --> 00:26:52,040
you<font color="#E5E5E5"> don't be to any flags will automate</font>

754
00:26:50,690 --> 00:26:53,990
to tell you where all<font color="#E5E5E5"> the domain admins</font>

755
00:26:52,040 --> 00:26:55,940
logged in I want to<font color="#E5E5E5"> know which computers</font>

756
00:26:53,990 --> 00:26:56,929
the domain admins are logged<font color="#E5E5E5"> into so</font>

757
00:26:55,940 --> 00:26:57,919
that<font color="#E5E5E5"> way I can try and break into that</font>

758
00:26:56,929 --> 00:26:59,720
<font color="#CCCCCC">computer because that's where I want to</font>

759
00:26:57,919 --> 00:27:00,890
<font color="#E5E5E5">be wherever the domain admins are but</font>

760
00:26:59,720 --> 00:27:02,030
that doesn't<font color="#E5E5E5"> work if you got a buddy</font>

761
00:27:00,890 --> 00:27:03,020
who's on the network<font color="#CCCCCC"> somewhere and you</font>

762
00:27:02,030 --> 00:27:05,540
want<font color="#E5E5E5"> to know where he's logged in that</font>

763
00:27:03,020 --> 00:27:07,280
<font color="#E5E5E5">and his IP address</font><font color="#CCCCCC"> run this and book use</font>

764
00:27:05,540 --> 00:27:10,330
<font color="#E5E5E5">100 give it the</font><font color="#CCCCCC"> username flag and it</font>

765
00:27:07,280 --> 00:27:10,330
will tell you where<font color="#CCCCCC"> they're logged in it</font>

766
00:27:14,600 --> 00:27:18,800
on to the<font color="#E5E5E5"> next</font><font color="#CCCCCC"> toolkit this one's called</font>

767
00:27:16,460 --> 00:27:20,300
<font color="#E5E5E5">power sploit again same same thing</font><font color="#CCCCCC"> with</font>

768
00:27:18,800 --> 00:27:22,190
the module category and some modules

769
00:27:20,300 --> 00:27:24,110
that are<font color="#E5E5E5"> in it it does a lot of</font><font color="#CCCCCC"> neat</font>

770
00:27:22,190 --> 00:27:25,460
<font color="#CCCCCC">stuff in here it's more of an attack</font>

771
00:27:24,110 --> 00:27:32,479
tool you can<font color="#E5E5E5"> do lots of cool things</font><font color="#CCCCCC"> with</font>

772
00:27:25,460 --> 00:27:34,430
<font color="#E5E5E5">that this tool power split actually</font>

773
00:27:32,480 --> 00:27:36,260
holds what's called an oak<font color="#CCCCCC"> Mimi</font><font color="#E5E5E5"> cats</font>

774
00:27:34,430 --> 00:27:39,380
it is a<font color="#CCCCCC"> powershell implementation of</font>

775
00:27:36,260 --> 00:27:40,520
mini cats<font color="#CCCCCC"> so that way i can again run</font>

776
00:27:39,380 --> 00:27:42,500
<font color="#CCCCCC">mimi cats on your computer</font><font color="#E5E5E5"> without</font>

777
00:27:40,520 --> 00:27:43,550
downloading any binaries<font color="#CCCCCC"> onto your box</font><font color="#E5E5E5"> i</font>

778
00:27:42,500 --> 00:27:50,150
can<font color="#E5E5E5"> just nail it in the memory of the</font>

779
00:27:43,550 --> 00:27:53,510
<font color="#CCCCCC">i-x cradle the power tools that</font><font color="#E5E5E5"> I talked</font>

780
00:27:50,150 --> 00:27:55,070
about before the<font color="#CCCCCC"> Power</font><font color="#E5E5E5"> View and power up</font>

781
00:27:53,510 --> 00:27:56,420
<font color="#E5E5E5">there now part of the power sploit</font>

782
00:27:55,070 --> 00:27:57,980
project that I started<font color="#CCCCCC"> using them before</font>

783
00:27:56,420 --> 00:27:59,300
<font color="#CCCCCC">they kind of merged and I still think of</font>

784
00:27:57,980 --> 00:28:00,500
<font color="#E5E5E5">them as separate and I want to talk</font>

785
00:27:59,300 --> 00:28:02,600
about them separate cuz I like Power

786
00:28:00,500 --> 00:28:08,060
View a lot but they're<font color="#CCCCCC"> not actually</font><font color="#E5E5E5"> part</font>

787
00:28:02,600 --> 00:28:09,919
of<font color="#E5E5E5"> this project I typically do a demo</font>

788
00:28:08,060 --> 00:28:12,260
but this is an<font color="#E5E5E5"> example of me creating</font>

789
00:28:09,920 --> 00:28:14,930
<font color="#E5E5E5">shell code</font><font color="#CCCCCC"> I just</font><font color="#E5E5E5"> use the MSF venom and</font>

790
00:28:12,260 --> 00:28:17,180
I created myself<font color="#CCCCCC"> Windows payload that</font>

791
00:28:14,930 --> 00:28:19,700
executed to open the calculator it's

792
00:28:17,180 --> 00:28:23,840
this cool<font color="#CCCCCC"> thing that</font><font color="#E5E5E5"> you do getting</font><font color="#CCCCCC"> out</font>

793
00:28:19,700 --> 00:28:25,520
here is that's<font color="#E5E5E5"> the shell code</font><font color="#CCCCCC"> then I got</font>

794
00:28:23,840 --> 00:28:26,899
I got<font color="#CCCCCC"> the name of a process I</font><font color="#E5E5E5"> was</font>

795
00:28:25,520 --> 00:28:28,700
looking for a process<font color="#CCCCCC"> to inject my shell</font>

796
00:28:26,900 --> 00:28:30,740
code into so I<font color="#E5E5E5"> just asked for use</font>

797
00:28:28,700 --> 00:28:33,560
PowerShell got the name with<font color="#CCCCCC"> explore</font>

798
00:28:30,740 --> 00:28:36,430
process and using<font color="#CCCCCC"> the invoke shell code</font>

799
00:28:33,560 --> 00:28:38,480
which is part of how our<font color="#CCCCCC"> spike I gave it</font>

800
00:28:36,430 --> 00:28:40,790
<font color="#E5E5E5">basically</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> the process that I want to</font>

801
00:28:38,480 --> 00:28:42,080
inject into and then all the shell code

802
00:28:40,790 --> 00:28:43,460
that I wanted<font color="#E5E5E5"> to inject into and then</font>

803
00:28:42,080 --> 00:28:45,110
using power<font color="#CCCCCC"> spiders</font><font color="#E5E5E5"> and checked with my</font>

804
00:28:43,460 --> 00:28:47,690
shell code straight<font color="#E5E5E5"> into another</font><font color="#CCCCCC"> process</font>

805
00:28:45,110 --> 00:28:49,340
on a box again all the memory all done

806
00:28:47,690 --> 00:28:56,580
through PowerShell no binaries touching

807
00:28:49,340 --> 00:28:59,820
the disk nothing<font color="#E5E5E5"> as such what's that</font>

808
00:28:56,580 --> 00:29:01,020
yeah<font color="#E5E5E5"> oh yeah</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Sun here</font><font color="#CCCCCC"> do you</font><font color="#E5E5E5"> wish to</font>

809
00:28:59,820 --> 00:29:10,350
carry<font color="#E5E5E5"> out your evil plans which is</font>

810
00:29:01,020 --> 00:29:12,540
pretty funny<font color="#CCCCCC"> I didn't mention this</font>

811
00:29:10,350 --> 00:29:14,909
earlier PowerShell can take encoded and

812
00:29:12,540 --> 00:29:17,490
compressed commands<font color="#E5E5E5"> so if you wanted</font><font color="#CCCCCC"> to</font>

813
00:29:14,910 --> 00:29:19,530
encode<font color="#E5E5E5"> what you're gonna execute power</font>

814
00:29:17,490 --> 00:29:21,210
shell for a little bit of application

815
00:29:19,530 --> 00:29:23,850
you can<font color="#E5E5E5"> take this thing up here I got</font>

816
00:29:21,210 --> 00:29:25,860
the<font color="#CCCCCC"> IEX download cradle</font><font color="#E5E5E5"> and then I just</font>

817
00:29:23,850 --> 00:29:28,080
<font color="#CCCCCC">used this power sploit module to encode</font>

818
00:29:25,860 --> 00:29:30,389
it all this stuff you see here<font color="#E5E5E5"> should be</font>

819
00:29:28,080 --> 00:29:32,129
a bunch<font color="#E5E5E5"> of base64 of the encoded command</font>

820
00:29:30,390 --> 00:29:33,750
<font color="#E5E5E5">that I want to run and you</font><font color="#CCCCCC"> can quite</font>

821
00:29:32,130 --> 00:29:35,850
literally<font color="#E5E5E5"> down at the</font><font color="#CCCCCC"> bottom you see</font>

822
00:29:33,750 --> 00:29:38,160
<font color="#E5E5E5">right</font><font color="#CCCCCC"> here I ran</font><font color="#E5E5E5"> PowerShell - II four</font>

823
00:29:35,850 --> 00:29:39,870
encoded command and then my base64

824
00:29:38,160 --> 00:29:41,760
string and it executes<font color="#CCCCCC"> the command after</font>

825
00:29:39,870 --> 00:29:42,719
<font color="#CCCCCC">when it's great for obfuscation so you</font>

826
00:29:41,760 --> 00:29:45,000
don't know what I'm doing<font color="#E5E5E5"> on your</font>

827
00:29:42,720 --> 00:29:46,560
<font color="#CCCCCC">computer you</font><font color="#E5E5E5"> just if you</font><font color="#CCCCCC"> ever see me run</font>

828
00:29:45,000 --> 00:29:48,090
that<font color="#E5E5E5"> for some reason you</font><font color="#CCCCCC"> happen to</font><font color="#E5E5E5"> see</font>

829
00:29:46,560 --> 00:29:53,429
it you would<font color="#CCCCCC"> just see a bunch of base64</font>

830
00:29:48,090 --> 00:29:58,770
string<font color="#CCCCCC"> now here's an example</font><font color="#E5E5E5"> of a</font>

831
00:29:53,430 --> 00:30:00,390
<font color="#CCCCCC">keylogger</font><font color="#E5E5E5"> from that module see you can</font>

832
00:29:58,770 --> 00:30:02,190
use<font color="#CCCCCC"> power sploit to do port scans again</font>

833
00:30:00,390 --> 00:30:04,260
<font color="#CCCCCC">I connect to a computer I don't have any</font>

834
00:30:02,190 --> 00:30:06,690
my tools there<font color="#E5E5E5"> can't exactly install</font>

835
00:30:04,260 --> 00:30:08,760
<font color="#E5E5E5">nmap on your computer but</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> can download</font>

836
00:30:06,690 --> 00:30:10,890
this power<font color="#CCCCCC"> sploit module</font><font color="#E5E5E5"> in the memory</font>

837
00:30:08,760 --> 00:30:13,560
<font color="#E5E5E5">and then do a port scan on your network</font>

838
00:30:10,890 --> 00:30:15,720
<font color="#E5E5E5">from there using PowerShell only and</font>

839
00:30:13,560 --> 00:30:17,940
again<font color="#CCCCCC"> what's nice about it</font><font color="#E5E5E5"> is it gives</font>

840
00:30:15,720 --> 00:30:19,920
<font color="#CCCCCC">you back data objects so what you see</font>

841
00:30:17,940 --> 00:30:21,990
down here<font color="#CCCCCC"> at the</font><font color="#E5E5E5"> bottom</font><font color="#CCCCCC"> part is</font><font color="#E5E5E5"> a data</font>

842
00:30:19,920 --> 00:30:24,750
object<font color="#CCCCCC"> with with</font><font color="#E5E5E5"> certain</font><font color="#CCCCCC"> things about it</font>

843
00:30:21,990 --> 00:30:26,610
and<font color="#CCCCCC"> I what I did over towards and where</font>

844
00:30:24,750 --> 00:30:28,020
it says where object<font color="#CCCCCC"> alive</font><font color="#E5E5E5"> equals true I</font>

845
00:30:26,610 --> 00:30:29,610
<font color="#E5E5E5">basically said only give me back</font><font color="#CCCCCC"> the</font>

846
00:30:28,020 --> 00:30:31,560
objects where the host was alive I don't

847
00:30:29,610 --> 00:30:33,419
<font color="#CCCCCC">want the other objects back but again</font>

848
00:30:31,560 --> 00:30:34,800
you can programmatically handle<font color="#E5E5E5"> this</font>

849
00:30:33,420 --> 00:30:36,210
data when<font color="#E5E5E5"> you do a port scan and do lots</font>

850
00:30:34,800 --> 00:30:39,950
<font color="#E5E5E5">of</font><font color="#CCCCCC"> things because</font><font color="#E5E5E5"> you have</font><font color="#CCCCCC"> back actual</font>

851
00:30:36,210 --> 00:30:39,950
data objects you<font color="#E5E5E5"> can do something with</font>

852
00:30:40,280 --> 00:30:43,470
here's invoke<font color="#CCCCCC"> mimikatz I was talking</font>

853
00:30:42,540 --> 00:30:45,060
about if you guys haven't<font color="#E5E5E5"> seen it before</font>

854
00:30:43,470 --> 00:30:46,740
it's great<font color="#E5E5E5"> graphs clear text passwords</font>

855
00:30:45,060 --> 00:30:48,270
out of memory<font color="#E5E5E5"> no matter how strong they</font>

856
00:30:46,740 --> 00:30:49,430
are<font color="#E5E5E5"> they can</font><font color="#CCCCCC"> be a</font><font color="#E5E5E5"> 30 character password</font>

857
00:30:48,270 --> 00:30:52,830
<font color="#E5E5E5">it'll grab it straight out of memory</font>

858
00:30:49,430 --> 00:30:54,930
<font color="#E5E5E5">here's an example that running I use the</font>

859
00:30:52,830 --> 00:30:57,540
short<font color="#CCCCCC"> URL because</font><font color="#E5E5E5"> I if you type the full</font>

860
00:30:54,930 --> 00:30:59,100
path but the invoke mimikatz<font color="#CCCCCC"> script is</font>

861
00:30:57,540 --> 00:31:00,690
available<font color="#CCCCCC"> and github public so</font><font color="#E5E5E5"> you can</font>

862
00:30:59,100 --> 00:31:01,860
just pull it<font color="#E5E5E5"> from there every time you</font>

863
00:31:00,690 --> 00:31:02,940
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use it you</font><font color="#CCCCCC"> don't have</font><font color="#E5E5E5"> to host it</font>

864
00:31:01,860 --> 00:31:04,649
yourself anywhere<font color="#CCCCCC"> just pull it straight</font>

865
00:31:02,940 --> 00:31:07,730
<font color="#E5E5E5">from</font><font color="#CCCCCC"> their github repo every time and</font>

866
00:31:04,650 --> 00:31:07,730
then run on the computer

867
00:31:09,560 --> 00:31:13,440
last year I<font color="#CCCCCC"> gave a miw pad talk I talked</font>

868
00:31:12,390 --> 00:31:15,690
about<font color="#CCCCCC"> it</font><font color="#E5E5E5"> quickly I just</font><font color="#CCCCCC"> thought I'd</font>

869
00:31:13,440 --> 00:31:19,910
<font color="#CCCCCC">noted</font><font color="#E5E5E5"> again using that PowerShell</font>

870
00:31:15,690 --> 00:31:23,340
functionality<font color="#CCCCCC"> I was able to do a big old</font>

871
00:31:19,910 --> 00:31:25,020
<font color="#E5E5E5">PS exec loop in PowerShell and</font><font color="#CCCCCC"> I just</font>

872
00:31:23,340 --> 00:31:26,699
basically sprayed the<font color="#CCCCCC"> whole network</font><font color="#E5E5E5"> with</font>

873
00:31:25,020 --> 00:31:28,740
this<font color="#E5E5E5"> loop and it down</font><font color="#CCCCCC"> so I connected to</font>

874
00:31:26,700 --> 00:31:30,330
every<font color="#CCCCCC"> computer on</font><font color="#E5E5E5"> the domain</font><font color="#CCCCCC"> I ran a</font>

875
00:31:28,740 --> 00:31:31,800
<font color="#E5E5E5">PowerShell command that downloaded me me</font>

876
00:31:30,330 --> 00:31:33,389
cats<font color="#E5E5E5"> into memory</font>

877
00:31:31,800 --> 00:31:35,370
got the password<font color="#E5E5E5"> out and sent it to my</font>

878
00:31:33,390 --> 00:31:36,570
SMB server and I did that<font color="#CCCCCC"> on like</font><font color="#E5E5E5"> 200</font>

879
00:31:35,370 --> 00:31:38,969
computers<font color="#CCCCCC"> on our network all using</font>

880
00:31:36,570 --> 00:31:40,169
PowerShell and<font color="#CCCCCC"> beau</font><font color="#E5E5E5"> communicates never</font>

881
00:31:38,970 --> 00:31:41,340
<font color="#E5E5E5">touched</font><font color="#CCCCCC"> a disk on a computer so</font>

882
00:31:40,170 --> 00:31:45,510
forensically you don't know that Iran

883
00:31:41,340 --> 00:31:47,459
<font color="#CCCCCC">Navy cats on your computer just take</font>

884
00:31:45,510 --> 00:31:49,650
this<font color="#E5E5E5"> example that running I wrote a</font>

885
00:31:47,460 --> 00:31:53,130
parser to handle<font color="#E5E5E5"> 200 output now there's</font>

886
00:31:49,650 --> 00:31:55,050
an example<font color="#CCCCCC"> of it running nice thing is</font>

887
00:31:53,130 --> 00:31:56,910
another another<font color="#CCCCCC"> great tool set I don't</font>

888
00:31:55,050 --> 00:31:59,190
<font color="#E5E5E5">spend much time work this one not for</font>

889
00:31:56,910 --> 00:32:00,510
any particular reason and and I find the

890
00:31:59,190 --> 00:32:03,030
tool sets I need<font color="#CCCCCC"> and all other things</font>

891
00:32:00,510 --> 00:32:04,379
but<font color="#CCCCCC"> nickel middle I think that's how you</font>

892
00:32:03,030 --> 00:32:05,760
say his<font color="#CCCCCC"> name he provides a lot of</font>

893
00:32:04,380 --> 00:32:07,440
<font color="#E5E5E5">training on PowerShell - he's really</font>

894
00:32:05,760 --> 00:32:09,270
prominent<font color="#E5E5E5"> in the PowerShell space on his</font>

895
00:32:07,440 --> 00:32:11,220
tool development<font color="#E5E5E5"> same thing with the</font>

896
00:32:09,270 --> 00:32:13,110
functionality group and some<font color="#E5E5E5"> tools going</font>

897
00:32:11,220 --> 00:32:18,540
<font color="#E5E5E5">on down here</font><font color="#CCCCCC"> you can do lots of neat</font>

898
00:32:13,110 --> 00:32:20,909
<font color="#E5E5E5">things there's some more modules on it</font>

899
00:32:18,540 --> 00:32:25,260
one of the nice<font color="#CCCCCC"> things down here you got</font>

900
00:32:20,910 --> 00:32:26,700
this one<font color="#E5E5E5"> um invoke mimikatz</font><font color="#CCCCCC"> WGCI</font><font color="#E5E5E5"> great</font>

901
00:32:25,260 --> 00:32:29,129
earlier<font color="#E5E5E5"> I</font><font color="#CCCCCC"> told you</font><font color="#E5E5E5"> that on</font><font color="#CCCCCC"> Windows 8.1</font>

902
00:32:26,700 --> 00:32:31,050
and<font color="#E5E5E5"> up and Windows Server 2012</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can't</font>

903
00:32:29,130 --> 00:32:32,280
grab credentials out<font color="#E5E5E5"> of memory you</font><font color="#CCCCCC"> gotta</font>

904
00:32:31,050 --> 00:32:34,080
<font color="#E5E5E5">do what's called a</font><font color="#CCCCCC"> debbie</font><font color="#E5E5E5"> digest</font>

905
00:32:32,280 --> 00:32:35,790
downgrade we go set a registry setting

906
00:32:34,080 --> 00:32:37,470
<font color="#CCCCCC">and tell windows to keep store in the</font>

907
00:32:35,790 --> 00:32:38,790
<font color="#CCCCCC">password</font><font color="#E5E5E5"> of memory it's built in this</font>

908
00:32:37,470 --> 00:32:42,330
tool you can<font color="#E5E5E5"> just</font><font color="#CCCCCC"> run it and no one</font><font color="#E5E5E5"> do</font>

909
00:32:38,790 --> 00:32:44,610
<font color="#E5E5E5">it for you the show target screen is</font>

910
00:32:42,330 --> 00:32:47,129
nice this guy wrote a<font color="#E5E5E5"> PowerShell script</font>

911
00:32:44,610 --> 00:32:49,649
that will stream somebody's desktop<font color="#E5E5E5"> over</font>

912
00:32:47,130 --> 00:32:51,450
with MPEG across the network so<font color="#CCCCCC"> you know</font>

913
00:32:49,650 --> 00:32:52,980
screenshots are cool but<font color="#E5E5E5"> I can stream</font>

914
00:32:51,450 --> 00:32:54,210
your<font color="#E5E5E5"> whole desktop like a movie using</font>

915
00:32:52,980 --> 00:32:55,470
<font color="#CCCCCC">this thing I'm gonna sit</font><font color="#E5E5E5"> there and watch</font>

916
00:32:54,210 --> 00:32:56,430
<font color="#CCCCCC">you the whole time as opposed to</font><font color="#E5E5E5"> just</font>

917
00:32:55,470 --> 00:32:57,960
taking<font color="#CCCCCC"> a screenshot screenshot</font>

918
00:32:56,430 --> 00:33:00,390
screenshot I can just stream it<font color="#E5E5E5"> over the</font>

919
00:32:57,960 --> 00:33:02,160
network<font color="#E5E5E5"> and he's written a blog post</font><font color="#CCCCCC"> on</font>

920
00:33:00,390 --> 00:33:04,430
<font color="#CCCCCC">how to do</font><font color="#E5E5E5"> it again that's in my my</font>

921
00:33:02,160 --> 00:33:04,430
slides

922
00:33:06,499 --> 00:33:10,559
here's<font color="#CCCCCC"> example of me running one of</font><font color="#E5E5E5"> his</font>

923
00:33:08,850 --> 00:33:12,178
scripts<font color="#CCCCCC"> windows is very nice and it will</font>

924
00:33:10,559 --> 00:33:13,739
store your<font color="#E5E5E5"> password for all the Wi-Fi</font>

925
00:33:12,179 --> 00:33:14,580
<font color="#E5E5E5">networks that you've ever connected to I</font>

926
00:33:13,739 --> 00:33:16,799
don't<font color="#E5E5E5"> know how many of you have</font><font color="#CCCCCC"> your</font>

927
00:33:14,580 --> 00:33:18,600
laptop<font color="#CCCCCC"> for a couple of</font><font color="#E5E5E5"> years</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> you can</font>

928
00:33:16,799 --> 00:33:19,889
run<font color="#E5E5E5"> this script on</font><font color="#CCCCCC"> your victim and</font><font color="#E5E5E5"> you</font>

929
00:33:18,600 --> 00:33:21,689
can get all the<font color="#CCCCCC"> Wi-Fi passwords for all</font>

930
00:33:19,889 --> 00:33:23,369
<font color="#E5E5E5">the</font><font color="#CCCCCC"> networks they ever connect to here's</font>

931
00:33:21,690 --> 00:33:25,499
an<font color="#CCCCCC"> example</font><font color="#E5E5E5"> of me getting out the</font>

932
00:33:23,369 --> 00:33:27,149
password<font color="#E5E5E5"> to my</font><font color="#CCCCCC"> iPhone</font><font color="#E5E5E5"> Wi-Fi network so</font>

933
00:33:25,499 --> 00:33:28,710
when<font color="#E5E5E5"> I tether my laptop to my thing I</font>

934
00:33:27,149 --> 00:33:31,979
ran<font color="#E5E5E5"> this script on my Windows computer</font>

935
00:33:28,710 --> 00:33:33,570
<font color="#E5E5E5">pulled out the Wi-Fi password</font><font color="#CCCCCC"> that's</font>

936
00:33:31,980 --> 00:33:35,700
great especially<font color="#CCCCCC"> if I catch you at</font>

937
00:33:33,570 --> 00:33:37,408
<font color="#E5E5E5">Starbucks a compromiser machine and I</font>

938
00:33:35,700 --> 00:33:38,940
would like your corporate machine or

939
00:33:37,409 --> 00:33:40,230
your<font color="#E5E5E5"> corporate networks Wi-Fi password I</font>

940
00:33:38,940 --> 00:33:42,649
can grab<font color="#CCCCCC"> all the new information from</font>

941
00:33:40,230 --> 00:33:42,649
<font color="#E5E5E5">one place</font>

942
00:33:42,919 --> 00:33:47,309
<font color="#CCCCCC">PowerShell suite yet another set</font><font color="#E5E5E5"> of</font>

943
00:33:45,299 --> 00:33:51,559
tools the two main ones I'll talk about

944
00:33:47,309 --> 00:33:51,559
<font color="#E5E5E5">here are invoke run</font><font color="#CCCCCC"> ads and subvert PE</font>

945
00:33:51,980 --> 00:33:55,619
<font color="#E5E5E5">earlier I talked</font><font color="#CCCCCC"> about how I just need</font>

946
00:33:53,999 --> 00:33:57,299
one set of<font color="#E5E5E5"> valid user credentials even</font>

947
00:33:55,619 --> 00:33:59,279
though I'm not the<font color="#E5E5E5"> part of the domain</font>

948
00:33:57,299 --> 00:34:00,418
<font color="#E5E5E5">join machine I use a program called run</font>

949
00:33:59,279 --> 00:34:02,309
<font color="#E5E5E5">ass to do that it allows me</font><font color="#CCCCCC"> to</font>

950
00:34:00,419 --> 00:34:04,649
<font color="#E5E5E5">impersonate</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> network user and give it</font>

951
00:34:02,309 --> 00:34:06,389
the username password<font color="#E5E5E5"> and whenever I run</font>

952
00:34:04,649 --> 00:34:08,699
a<font color="#E5E5E5"> command it runs it as that user just</font>

953
00:34:06,389 --> 00:34:10,109
<font color="#E5E5E5">like the things called but if you ever</font>

954
00:34:08,699 --> 00:34:11,189
find<font color="#E5E5E5"> your place in</font><font color="#CCCCCC"> a company where they</font>

955
00:34:10,109 --> 00:34:13,049
were trying<font color="#CCCCCC"> to up the security</font><font color="#E5E5E5"> and</font>

956
00:34:11,190 --> 00:34:14,579
removed<font color="#CCCCCC"> run as like Exe from a computer</font>

957
00:34:13,049 --> 00:34:15,750
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> all right</font><font color="#E5E5E5"> somebody wrote</font><font color="#CCCCCC"> in</font>

958
00:34:14,579 --> 00:34:17,609
PowerShell<font color="#E5E5E5"> you can just use this</font>

959
00:34:15,750 --> 00:34:19,469
<font color="#CCCCCC">PowerShell run as to do</font><font color="#E5E5E5"> all in</font>

960
00:34:17,609 --> 00:34:21,029
PowerShell<font color="#CCCCCC"> or if you'd like</font><font color="#E5E5E5"> to run all</font>

961
00:34:19,469 --> 00:34:23,009
your<font color="#E5E5E5"> tools from PowerShell without using</font>

962
00:34:21,030 --> 00:34:24,869
the binary at all<font color="#E5E5E5"> just pull this thing</font>

963
00:34:23,010 --> 00:34:27,059
<font color="#CCCCCC">down here's an example</font><font color="#E5E5E5"> of me doing it</font>

964
00:34:24,869 --> 00:34:28,260
again using<font color="#E5E5E5"> the</font><font color="#CCCCCC"> i-x download cradle that</font>

965
00:34:27,059 --> 00:34:30,750
<font color="#CCCCCC">I talked about over and over and</font><font color="#E5E5E5"> over</font>

966
00:34:28,260 --> 00:34:32,220
<font color="#E5E5E5">what's interesting this</font><font color="#CCCCCC"> time I used SMB</font>

967
00:34:30,750 --> 00:34:32,879
connection<font color="#E5E5E5"> I'm pretty sure it will take</font>

968
00:34:32,219 --> 00:34:35,578
any URI

969
00:34:32,879 --> 00:34:37,799
<font color="#CCCCCC">I haven't only tried HTTP and SMB I</font>

970
00:34:35,579 --> 00:34:39,480
haven't<font color="#E5E5E5"> tried</font><font color="#CCCCCC"> any other URI but</font><font color="#E5E5E5"> you</font>

971
00:34:37,799 --> 00:34:40,980
don't even<font color="#CCCCCC"> have</font><font color="#E5E5E5"> to connect over HTTP if</font>

972
00:34:39,480 --> 00:34:43,260
some reason to have a web proxy<font color="#CCCCCC"> but they</font>

973
00:34:40,980 --> 00:34:44,460
<font color="#E5E5E5">let for for out over four for five out</font>

974
00:34:43,260 --> 00:34:45,899
over the network<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can just make an</font>

975
00:34:44,460 --> 00:34:49,379
SMB connection instead you don't need to

976
00:34:45,899 --> 00:34:52,848
<font color="#E5E5E5">make HTTP that's the example of me</font>

977
00:34:49,379 --> 00:34:52,848
spawning a new<font color="#CCCCCC"> shell is a different user</font>

978
00:34:53,030 --> 00:34:56,460
subvert PE is really nice there's this

979
00:34:55,109 --> 00:34:58,200
thing called<font color="#CCCCCC"> code</font><font color="#E5E5E5"> caves when someone</font>

980
00:34:56,460 --> 00:35:00,720
compiles a program there's empty<font color="#E5E5E5"> space</font>

981
00:34:58,200 --> 00:35:03,390
in there for various reasons subvert the

982
00:35:00,720 --> 00:35:04,859
subvert PE<font color="#E5E5E5"> will go through find a nice</font>

983
00:35:03,390 --> 00:35:05,720
place<font color="#CCCCCC"> and I'll put your</font><font color="#E5E5E5"> shell code right</font>

984
00:35:04,859 --> 00:35:07,190
<font color="#E5E5E5">in that</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> that</font>

985
00:35:05,720 --> 00:35:08,299
and that<font color="#CCCCCC"> program will continue to</font><font color="#E5E5E5"> run</font>

986
00:35:07,190 --> 00:35:09,140
after<font color="#E5E5E5"> the fact so you can basically</font>

987
00:35:08,300 --> 00:35:10,880
<font color="#E5E5E5">backdoor</font>

988
00:35:09,140 --> 00:35:12,650
whatever executables<font color="#CCCCCC"> that you want to</font>

989
00:35:10,880 --> 00:35:17,570
and you<font color="#CCCCCC"> can use this</font><font color="#E5E5E5"> PowerShell script</font>

990
00:35:12,650 --> 00:35:19,150
to do it so I<font color="#E5E5E5"> told subvert PE the path I</font>

991
00:35:17,570 --> 00:35:22,940
wanted to backdoor<font color="#E5E5E5"> the notepad dot</font>

992
00:35:19,150 --> 00:35:24,440
notepad plus plus<font color="#E5E5E5"> DX e and then so I</font>

993
00:35:22,940 --> 00:35:26,720
told it<font color="#E5E5E5"> where the</font><font color="#CCCCCC"> XE was and it found a</font>

994
00:35:24,440 --> 00:35:28,400
code cave and it put put my shell code

995
00:35:26,720 --> 00:35:30,020
in there actually<font color="#CCCCCC"> it's a default with</font>

996
00:35:28,400 --> 00:35:31,190
its own<font color="#CCCCCC"> and</font><font color="#E5E5E5"> just opens calculator but</font>

997
00:35:30,020 --> 00:35:34,660
you can go in and<font color="#E5E5E5"> change the shell code</font>

998
00:35:31,190 --> 00:35:34,660
<font color="#E5E5E5">to whatever you want</font><font color="#CCCCCC"> it to actually</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> I</font>

999
00:35:37,450 --> 00:35:42,410
didn't have a<font color="#E5E5E5"> screenshot of</font><font color="#CCCCCC"> it but</font>

1000
00:35:40,160 --> 00:35:43,549
basically<font color="#E5E5E5"> once after you run this and</font>

1001
00:35:42,410 --> 00:35:45,170
you double click<font color="#E5E5E5"> on notepad</font>

1002
00:35:43,550 --> 00:35:46,250
Exe it'll spawn whatever program you

1003
00:35:45,170 --> 00:35:47,300
<font color="#E5E5E5">told it to you in this case</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> would</font>

1004
00:35:46,250 --> 00:35:50,750
open<font color="#E5E5E5"> up a calc</font>

1005
00:35:47,300 --> 00:35:53,599
on top<font color="#E5E5E5"> of that but if if you don't have</font>

1006
00:35:50,750 --> 00:35:54,740
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> exe on your computer or you</font>

1007
00:35:53,599 --> 00:35:57,080
happen<font color="#CCCCCC"> to have</font><font color="#E5E5E5"> been administrator you</font>

1008
00:35:54,740 --> 00:35:58,310
block the use of<font color="#CCCCCC"> PowerShell DXE that's</font>

1009
00:35:57,080 --> 00:36:01,069
no problem<font color="#CCCCCC"> there's</font><font color="#E5E5E5"> plenty of tools</font>

1010
00:35:58,310 --> 00:36:04,880
<font color="#CCCCCC">around that and you guys been on</font><font color="#E5E5E5"> network</font>

1011
00:36:01,070 --> 00:36:06,230
that<font color="#CCCCCC"> block cmd.exe before no I</font><font color="#E5E5E5"> have I</font>

1012
00:36:04,880 --> 00:36:07,910
been on<font color="#CCCCCC"> somewhere</font><font color="#E5E5E5"> they won't allow you</font>

1013
00:36:06,230 --> 00:36:09,410
to<font color="#E5E5E5"> run CMD that you</font><font color="#CCCCCC"> see but you</font><font color="#E5E5E5"> can run</font>

1014
00:36:07,910 --> 00:36:10,520
PowerShell<font color="#CCCCCC"> I</font><font color="#E5E5E5"> actually I don't know why</font>

1015
00:36:09,410 --> 00:36:14,180
it<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> make any</font><font color="#E5E5E5"> sense power so you</font>

1016
00:36:10,520 --> 00:36:15,980
<font color="#CCCCCC">can do lots more stuff with but if they</font>

1017
00:36:14,180 --> 00:36:17,629
have application whitelisting<font color="#CCCCCC"> and that</font>

1018
00:36:15,980 --> 00:36:19,760
you can't use PowerShell<font color="#CCCCCC"> bat</font><font color="#E5E5E5"> exe at all</font>

1019
00:36:17,630 --> 00:36:21,410
that's no<font color="#E5E5E5"> problem this guy right</font><font color="#CCCCCC"> here</font>

1020
00:36:19,760 --> 00:36:23,810
<font color="#CCCCCC">Jarrid height he wrote a tool called PS</font>

1021
00:36:21,410 --> 00:36:26,750
attack not<font color="#E5E5E5"> only does</font><font color="#CCCCCC"> it run PowerShell</font>

1022
00:36:23,810 --> 00:36:27,950
commands without<font color="#CCCCCC"> powershell exe this guy</font>

1023
00:36:26,750 --> 00:36:29,210
has<font color="#E5E5E5"> taken all the tools that</font><font color="#CCCCCC"> i</font>

1024
00:36:27,950 --> 00:36:32,000
previously talked to you about and<font color="#E5E5E5"> he</font>

1025
00:36:29,210 --> 00:36:33,530
crammed him into this compiled binary to

1026
00:36:32,000 --> 00:36:35,660
make it<font color="#E5E5E5"> even better than</font><font color="#CCCCCC"> that he's</font>

1027
00:36:33,530 --> 00:36:37,339
encrypted all the modules<font color="#CCCCCC"> when it's</font>

1028
00:36:35,660 --> 00:36:39,170
stored on disk when it's saved there and

1029
00:36:37,339 --> 00:36:41,359
when you<font color="#CCCCCC"> double-click</font><font color="#E5E5E5"> the program and</font>

1030
00:36:39,170 --> 00:36:43,010
run it he loads those<font color="#E5E5E5"> encrypted modules</font>

1031
00:36:41,359 --> 00:36:44,420
<font color="#E5E5E5">into memory and then decrypt them that</font>

1032
00:36:43,010 --> 00:36:46,700
makes it really hard<font color="#CCCCCC"> for antivirus to</font>

1033
00:36:44,420 --> 00:36:48,500
tell what's<font color="#E5E5E5"> going on because although if</font>

1034
00:36:46,700 --> 00:36:50,450
it<font color="#CCCCCC"> was gonna flag on some PowerShell</font>

1035
00:36:48,500 --> 00:36:51,589
module based off the text of it it's not

1036
00:36:50,450 --> 00:36:53,629
<font color="#E5E5E5">gonna know because about time it gets</font>

1037
00:36:51,589 --> 00:36:55,490
decrypted it's already in memory<font color="#E5E5E5"> so</font>

1038
00:36:53,630 --> 00:36:56,869
there's there's some of the tool list

1039
00:36:55,490 --> 00:36:59,000
that he has over there power sploit

1040
00:36:56,869 --> 00:37:00,740
power tools<font color="#CCCCCC"> nice sharing</font><font color="#E5E5E5"> power cat in</font>

1041
00:36:59,000 --> 00:37:02,660
bed just<font color="#CCCCCC"> like all the tools I was just</font>

1042
00:37:00,740 --> 00:37:04,368
telling you<font color="#E5E5E5"> about he has a</font><font color="#CCCCCC"> mall compiled</font>

1043
00:37:02,660 --> 00:37:06,049
in this one binary<font color="#E5E5E5"> you just run on your</font>

1044
00:37:04,369 --> 00:37:08,930
computer<font color="#E5E5E5"> and you're good to</font><font color="#CCCCCC"> go</font>

1045
00:37:06,050 --> 00:37:11,530
<font color="#E5E5E5">and it does it does tons of other</font><font color="#CCCCCC"> stuff</font>

1046
00:37:08,930 --> 00:37:11,529
on<font color="#E5E5E5"> top of that</font>

1047
00:37:12,990 --> 00:37:16,799
if that was a good enough<font color="#E5E5E5"> for you guy</font>

1048
00:37:14,970 --> 00:37:18,540
<font color="#E5E5E5">named Benton he's also</font><font color="#CCCCCC"> very prominent in</font>

1049
00:37:16,800 --> 00:37:21,900
<font color="#E5E5E5">the</font><font color="#CCCCCC"> PowerShell space he wrote a tool</font>

1050
00:37:18,540 --> 00:37:25,620
called not<font color="#CCCCCC"> PowerShell it's just the exe</font>

1051
00:37:21,900 --> 00:37:26,850
<font color="#CCCCCC">and it runs PowerShell commands for you</font>

1052
00:37:25,620 --> 00:37:28,380
the one<font color="#E5E5E5"> thing to know about parish</font><font color="#CCCCCC"> are</font>

1053
00:37:26,850 --> 00:37:30,029
earlier when we<font color="#E5E5E5"> first started talking I</font>

1054
00:37:28,380 --> 00:37:32,370
was talking<font color="#CCCCCC"> about how it works with</font>

1055
00:37:30,030 --> 00:37:34,890
dotnet PowerShell is really just an

1056
00:37:32,370 --> 00:37:37,830
interface that<font color="#E5E5E5"> deals</font><font color="#CCCCCC"> with the</font><font color="#E5E5E5"> common</font>

1057
00:37:34,890 --> 00:37:39,450
language interface that dotnet uses so

1058
00:37:37,830 --> 00:37:40,590
if you take<font color="#E5E5E5"> away PowerShell that you see</font>

1059
00:37:39,450 --> 00:37:42,899
that's<font color="#E5E5E5"> no problem somebody will just</font>

1060
00:37:40,590 --> 00:37:45,330
<font color="#E5E5E5">write their</font><font color="#CCCCCC"> own tool that talks straight</font>

1061
00:37:42,900 --> 00:37:46,470
to that<font color="#E5E5E5"> common language interface and</font>

1062
00:37:45,330 --> 00:37:48,900
<font color="#E5E5E5">this is the</font><font color="#CCCCCC"> node tool it does that</font>

1063
00:37:46,470 --> 00:37:50,609
here's an example<font color="#E5E5E5"> of me just using again</font>

1064
00:37:48,900 --> 00:37:53,880
<font color="#CCCCCC">the</font><font color="#E5E5E5"> i-x download cradle without</font>

1065
00:37:50,610 --> 00:37:54,840
<font color="#E5E5E5">PowerShell</font><font color="#CCCCCC"> downloading power view</font><font color="#E5E5E5"> and</font>

1066
00:37:53,880 --> 00:37:58,820
<font color="#E5E5E5">then finding out where the domain</font>

1067
00:37:54,840 --> 00:38:02,150
controller was that was<font color="#CCCCCC"> I use</font><font color="#E5E5E5"> that for</font>

1068
00:37:58,820 --> 00:38:06,060
<font color="#E5E5E5">not to step it up here</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> little by</font>

1069
00:38:02,150 --> 00:38:08,640
remote access tools<font color="#E5E5E5"> here's one called</font>

1070
00:38:06,060 --> 00:38:09,660
posh<font color="#CCCCCC"> rap by Casey Smith</font><font color="#E5E5E5"> these are some</font>

1071
00:38:08,640 --> 00:38:11,220
of<font color="#E5E5E5"> the functionalities but you can</font>

1072
00:38:09,660 --> 00:38:12,509
<font color="#E5E5E5">basically use to set up a web</font><font color="#CCCCCC"> server and</font>

1073
00:38:11,220 --> 00:38:14,520
<font color="#CCCCCC">then you</font><font color="#E5E5E5"> can see the connect web shells</font>

1074
00:38:12,510 --> 00:38:16,890
back and forth<font color="#CCCCCC"> I don't use it too often</font>

1075
00:38:14,520 --> 00:38:18,150
<font color="#E5E5E5">but again you should use the i-x</font>

1076
00:38:16,890 --> 00:38:22,230
download cradle to get yourself remote

1077
00:38:18,150 --> 00:38:23,820
access to a computer<font color="#CCCCCC"> Metasploit has a</font>

1078
00:38:22,230 --> 00:38:25,080
ton of<font color="#CCCCCC"> functionality for</font><font color="#E5E5E5"> PowerShell</font>

1079
00:38:23,820 --> 00:38:26,490
these are some<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the modules that</font><font color="#CCCCCC"> are</font>

1080
00:38:25,080 --> 00:38:27,900
listed in there I know it's a lot<font color="#E5E5E5"> I'm</font>

1081
00:38:26,490 --> 00:38:32,279
not<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> move on to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> next</font><font color="#CCCCCC"> sexual</font>

1082
00:38:27,900 --> 00:38:34,350
where I show you some<font color="#E5E5E5"> images</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can set</font>

1083
00:38:32,280 --> 00:38:40,230
up<font color="#E5E5E5"> a reverse</font><font color="#CCCCCC"> powershell payload this is</font>

1084
00:38:34,350 --> 00:38:41,220
kind of how<font color="#E5E5E5"> that's set up but one of the</font>

1085
00:38:40,230 --> 00:38:42,960
better<font color="#E5E5E5"> things that to note about</font>

1086
00:38:41,220 --> 00:38:44,879
PowerShell is they recently added<font color="#E5E5E5"> a</font>

1087
00:38:42,960 --> 00:38:48,180
PowerShell extension so you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> actually</font>

1088
00:38:44,880 --> 00:38:49,380
have a fully native<font color="#CCCCCC"> PowerShell shell</font>

1089
00:38:48,180 --> 00:38:51,060
inside of your meterpreter session

1090
00:38:49,380 --> 00:38:52,020
before<font color="#E5E5E5"> you could run PowerShell command</font>

1091
00:38:51,060 --> 00:38:53,400
but it<font color="#E5E5E5"> wouldn't</font><font color="#CCCCCC"> let you do anything</font>

1092
00:38:52,020 --> 00:38:55,020
after<font color="#CCCCCC"> that I wouldn't give back</font><font color="#E5E5E5"> feedback</font>

1093
00:38:53,400 --> 00:38:56,340
now you got just<font color="#E5E5E5"> like you have</font>

1094
00:38:55,020 --> 00:38:58,650
PowerShell at your fingertips through

1095
00:38:56,340 --> 00:39:00,450
meterpreter<font color="#E5E5E5"> so here's an example</font><font color="#CCCCCC"> of me</font>

1096
00:38:58,650 --> 00:39:02,910
loading PowerShell then I imported my

1097
00:39:00,450 --> 00:39:05,669
<font color="#E5E5E5">own tool again I had a matter Pro access</font>

1098
00:39:02,910 --> 00:39:07,129
<font color="#E5E5E5">I in downloaded</font><font color="#CCCCCC"> power view script and</font>

1099
00:39:05,670 --> 00:39:11,030
then I ran a command and<font color="#E5E5E5"> tell me</font>

1100
00:39:07,130 --> 00:39:13,460
where the domain was<font color="#E5E5E5"> they've also</font>

1101
00:39:11,030 --> 00:39:14,480
exposed some of<font color="#CCCCCC"> the mature protection</font>

1102
00:39:13,460 --> 00:39:16,250
<font color="#CCCCCC">ality as.net</font>

1103
00:39:14,480 --> 00:39:17,570
namespaces so you can interact with it

1104
00:39:16,250 --> 00:39:20,810
<font color="#E5E5E5">that's kind of what's going on here</font><font color="#CCCCCC"> I</font>

1105
00:39:17,570 --> 00:39:23,390
basically<font color="#E5E5E5"> use this is a dotnet namespace</font>

1106
00:39:20,810 --> 00:39:28,070
<font color="#E5E5E5">to use that to run</font><font color="#CCCCCC"> me me cats through</font>

1107
00:39:23,390 --> 00:39:29,600
meterpreter<font color="#E5E5E5"> but one of the more popular</font>

1108
00:39:28,070 --> 00:39:31,520
things is<font color="#E5E5E5"> called web</font><font color="#CCCCCC"> delivery again</font>

1109
00:39:29,600 --> 00:39:32,750
<font color="#E5E5E5">Andrew Smith who's across the way he</font>

1110
00:39:31,520 --> 00:39:35,270
wrote<font color="#E5E5E5"> he was a co-author on this</font>

1111
00:39:32,750 --> 00:39:37,520
particular power<font color="#E5E5E5"> particular Metasploit</font>

1112
00:39:35,270 --> 00:39:38,780
module<font color="#E5E5E5"> you basically go when you set up</font>

1113
00:39:37,520 --> 00:39:40,640
<font color="#CCCCCC">a Metasploit and then you get this</font>

1114
00:39:38,780 --> 00:39:43,100
command back up here it's<font color="#E5E5E5"> PowerShell the</font>

1115
00:39:40,640 --> 00:39:44,629
<font color="#CCCCCC">knop stands for no profile the</font><font color="#E5E5E5"> dash W is</font>

1116
00:39:43,100 --> 00:39:46,940
hidden hide the<font color="#CCCCCC"> windows so nobody</font><font color="#E5E5E5"> sees</font>

1117
00:39:44,630 --> 00:39:49,130
<font color="#CCCCCC">it and then the</font><font color="#E5E5E5"> dash C has run this</font>

1118
00:39:46,940 --> 00:39:50,810
command<font color="#CCCCCC"> so what I do is I connect to a</font>

1119
00:39:49,130 --> 00:39:51,830
computer<font color="#CCCCCC"> and I just run this command and</font>

1120
00:39:50,810 --> 00:39:53,870
<font color="#E5E5E5">it gives me</font><font color="#CCCCCC"> back on meterpreter shell</font>

1121
00:39:51,830 --> 00:39:55,640
right back on the<font color="#CCCCCC"> computer</font><font color="#E5E5E5"> again it uses</font>

1122
00:39:53,870 --> 00:39:57,170
the<font color="#CCCCCC"> IX download cradle</font><font color="#E5E5E5"> to make a</font>

1123
00:39:55,640 --> 00:39:58,460
<font color="#E5E5E5">connection back to</font><font color="#CCCCCC"> Metasploit and get</font>

1124
00:39:57,170 --> 00:40:02,450
<font color="#E5E5E5">that motor</font><font color="#CCCCCC"> power running in memory on</font>

1125
00:39:58,460 --> 00:40:05,300
the other box<font color="#CCCCCC"> I don't really have a demo</font>

1126
00:40:02,450 --> 00:40:06,410
I was just kidding<font color="#CCCCCC"> Empire again</font><font color="#E5E5E5"> written</font>

1127
00:40:05,300 --> 00:40:08,890
<font color="#CCCCCC">by that guy that I was</font><font color="#E5E5E5"> talking about</font>

1128
00:40:06,410 --> 00:40:12,500
<font color="#E5E5E5">will</font><font color="#CCCCCC"> Schroeder</font><font color="#E5E5E5"> and a couple other people</font>

1129
00:40:08,890 --> 00:40:15,710
<font color="#E5E5E5">but what's unique about Empire is that</font>

1130
00:40:12,500 --> 00:40:17,240
it is a<font color="#CCCCCC"> powershell</font><font color="#E5E5E5"> only agent that stays</font>

1131
00:40:15,710 --> 00:40:17,720
in<font color="#CCCCCC"> memory so again it all runs in</font>

1132
00:40:17,240 --> 00:40:19,399
PowerShell

1133
00:40:17,720 --> 00:40:20,870
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> like meterpreter has like</font><font color="#E5E5E5"> motor</font>

1134
00:40:19,400 --> 00:40:23,330
prototype functionality but<font color="#E5E5E5"> it runs all</font>

1135
00:40:20,870 --> 00:40:28,100
in PowerShell<font color="#CCCCCC"> all in memory on the</font>

1136
00:40:23,330 --> 00:40:33,710
target<font color="#E5E5E5"> computer now you got yet to setup</font>

1137
00:40:28,100 --> 00:40:35,750
persistence for<font color="#E5E5E5"> that you can configure</font>

1138
00:40:33,710 --> 00:40:38,120
just like with<font color="#CCCCCC"> Metasploit the</font><font color="#E5E5E5"> timeout</font>

1139
00:40:35,750 --> 00:40:40,670
for the connection so you can say hey if

1140
00:40:38,120 --> 00:40:42,680
you can't reach<font color="#CCCCCC"> the server</font><font color="#E5E5E5"> for six weeks</font>

1141
00:40:40,670 --> 00:40:44,180
<font color="#E5E5E5">then</font><font color="#CCCCCC"> you can die or you can set</font><font color="#E5E5E5"> it for</font>

1142
00:40:42,680 --> 00:40:45,589
<font color="#E5E5E5">two days you</font><font color="#CCCCCC"> can set it</font><font color="#E5E5E5"> for whatever you</font>

1143
00:40:44,180 --> 00:40:47,600
want<font color="#E5E5E5"> to but you can keep trying for as</font>

1144
00:40:45,590 --> 00:40:48,770
long<font color="#E5E5E5"> as</font><font color="#CCCCCC"> it wants</font><font color="#E5E5E5"> but if you reboot the</font>

1145
00:40:47,600 --> 00:40:52,610
computer you'll lose<font color="#E5E5E5"> because it's in</font>

1146
00:40:48,770 --> 00:40:55,360
memory<font color="#CCCCCC"> you'll lose it some of</font><font color="#E5E5E5"> the ways</font>

1147
00:40:52,610 --> 00:40:55,360
<font color="#CCCCCC">to use</font><font color="#E5E5E5"> Empire</font>

1148
00:40:57,140 --> 00:41:02,900
power<font color="#CCCCCC"> empire is a</font><font color="#E5E5E5"> PowerShell interface</font>

1149
00:40:59,750 --> 00:41:04,730
that connects to the Empire server<font color="#E5E5E5"> again</font>

1150
00:41:02,900 --> 00:41:06,559
talking about<font color="#CCCCCC"> PowerShell tool</font><font color="#E5E5E5"> the Empire</font>

1151
00:41:04,730 --> 00:41:11,029
has a REST API<font color="#CCCCCC"> these are some of</font><font color="#E5E5E5"> the</font>

1152
00:41:06,559 --> 00:41:12,940
functions<font color="#CCCCCC"> that</font><font color="#E5E5E5"> it has there's an example</font>

1153
00:41:11,029 --> 00:41:15,650
<font color="#E5E5E5">of me connecting back</font><font color="#CCCCCC"> to my PowerShell</font>

1154
00:41:12,940 --> 00:41:19,089
<font color="#E5E5E5">sorry my</font><font color="#CCCCCC"> Empire server</font><font color="#E5E5E5"> getting back</font>

1155
00:41:15,650 --> 00:41:19,089
<font color="#CCCCCC">information about the agents I have</font>

1156
00:41:19,510 --> 00:41:23,510
another web interface is<font color="#CCCCCC"> called</font>

1157
00:41:21,619 --> 00:41:25,250
PowerShell<font color="#CCCCCC"> Empire</font><font color="#E5E5E5"> web this one's</font>

1158
00:41:23,510 --> 00:41:27,849
actually written<font color="#E5E5E5"> in PHP it's not part</font>

1159
00:41:25,250 --> 00:41:30,319
it's<font color="#E5E5E5"> not a PowerShell implementation</font>

1160
00:41:27,849 --> 00:41:31,490
<font color="#CCCCCC">alright talk with some malware how many</font>

1161
00:41:30,319 --> 00:41:32,538
you<font color="#E5E5E5"> guys went to Aaron Lancaster's</font>

1162
00:41:31,490 --> 00:41:34,750
talked earlier heard about some

1163
00:41:32,539 --> 00:41:36,950
ransomware

1164
00:41:34,750 --> 00:41:39,619
<font color="#E5E5E5">w-well PowerShell they did the same</font>

1165
00:41:36,950 --> 00:41:40,490
<font color="#CCCCCC">thing that happens in PowerShell looks</font>

1166
00:41:39,619 --> 00:41:41,839
like I'm<font color="#CCCCCC"> little run with the</font><font color="#E5E5E5"> hole in</font>

1167
00:41:40,490 --> 00:41:43,700
<font color="#E5E5E5">time so I kind of give you this short</font>

1168
00:41:41,839 --> 00:41:46,099
and skinny on<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> PowerShell</font>

1169
00:41:43,700 --> 00:41:47,689
malware comes through mostly through

1170
00:41:46,099 --> 00:41:50,420
infected<font color="#E5E5E5"> word documents that runs a</font>

1171
00:41:47,690 --> 00:41:52,250
visual<font color="#E5E5E5"> basic code not visual</font><font color="#CCCCCC"> at VBA code</font>

1172
00:41:50,420 --> 00:41:54,079
that will<font color="#E5E5E5"> launch a PowerShell session</font>

1173
00:41:52,250 --> 00:41:55,609
and guess what it uses<font color="#E5E5E5"> it uses the</font><font color="#CCCCCC"> i-x</font>

1174
00:41:54,079 --> 00:41:57,559
download cradle when you have macros

1175
00:41:55,609 --> 00:41:58,880
<font color="#CCCCCC">enabling your word documents to execute</font>

1176
00:41:57,559 --> 00:42:02,089
and deal<font color="#CCCCCC"> with what it needs to do after</font>

1177
00:41:58,880 --> 00:42:03,380
<font color="#CCCCCC">that this particular one use PowerShell</font>

1178
00:42:02,089 --> 00:42:04,640
and<font color="#E5E5E5"> then it would go in fact all your</font>

1179
00:42:03,380 --> 00:42:06,970
other<font color="#E5E5E5"> Word documents so when you spread</font>

1180
00:42:04,640 --> 00:42:09,410
<font color="#E5E5E5">them around it would just keep going</font>

1181
00:42:06,970 --> 00:42:11,149
<font color="#CCCCCC">this one came through a malicious link</font>

1182
00:42:09,410 --> 00:42:12,348
as an attachment<font color="#E5E5E5"> but if you see down</font>

1183
00:42:11,150 --> 00:42:14,690
<font color="#E5E5E5">here here's</font><font color="#CCCCCC"> the code they were running</font>

1184
00:42:12,349 --> 00:42:16,880
<font color="#E5E5E5">again they bypassed execution</font><font color="#CCCCCC"> policy and</font>

1185
00:42:14,690 --> 00:42:20,809
then they use the<font color="#E5E5E5"> i-x download string to</font>

1186
00:42:16,880 --> 00:42:22,220
download the code<font color="#E5E5E5"> right after that power</font>

1187
00:42:20,809 --> 00:42:25,880
snip is a different set of malware

1188
00:42:22,220 --> 00:42:27,890
running<font color="#E5E5E5"> through a campaign again it</font>

1189
00:42:25,880 --> 00:42:30,049
downloads its<font color="#E5E5E5"> shell code you can</font>

1190
00:42:27,890 --> 00:42:31,578
<font color="#CCCCCC">actually download into memory DLL files</font>

1191
00:42:30,049 --> 00:42:35,119
as well and execute those on top of

1192
00:42:31,579 --> 00:42:37,609
normal<font color="#CCCCCC"> PowerShell stuff but again right</font>

1193
00:42:35,119 --> 00:42:39,910
down<font color="#E5E5E5"> here it is</font><font color="#CCCCCC"> using the i-x download</font>

1194
00:42:37,609 --> 00:42:39,910
cradle

1195
00:42:42,570 --> 00:42:49,320
here's<font color="#CCCCCC"> another set this one kind of</font>

1196
00:42:44,220 --> 00:42:50,430
persisted in memory<font color="#E5E5E5"> can't remember</font>

1197
00:42:49,320 --> 00:42:52,050
<font color="#CCCCCC">anything</font><font color="#E5E5E5"> else unique about this one</font>

1198
00:42:50,430 --> 00:42:53,220
<font color="#E5E5E5">anyways</font><font color="#CCCCCC"> PowerShell it does the</font>

1199
00:42:52,050 --> 00:42:54,210
PowerShell malware<font color="#E5E5E5"> it does the same</font>

1200
00:42:53,220 --> 00:42:55,649
<font color="#CCCCCC">thing it's just</font><font color="#E5E5E5"> a different way</font><font color="#CCCCCC"> to</font>

1201
00:42:54,210 --> 00:42:57,810
execute<font color="#E5E5E5"> code on the Box the tip that</font>

1202
00:42:55,650 --> 00:42:59,280
<font color="#E5E5E5">comes an infected Word document one</font>

1203
00:42:57,810 --> 00:43:02,190
thing to note this one actually<font color="#E5E5E5"> came</font>

1204
00:42:59,280 --> 00:43:04,230
with infected PDF documents as well

1205
00:43:02,190 --> 00:43:06,180
<font color="#E5E5E5">there's a way that you can run code on</font><font color="#CCCCCC"> a</font>

1206
00:43:04,230 --> 00:43:07,950
Windows<font color="#E5E5E5"> box through a function and PDF</font>

1207
00:43:06,180 --> 00:43:12,480
so it's not<font color="#E5E5E5"> just</font><font color="#CCCCCC"> limited to</font><font color="#E5E5E5"> Windows</font>

1208
00:43:07,950 --> 00:43:14,370
<font color="#CCCCCC">Doc's this one</font><font color="#E5E5E5"> is actually ransomware</font>

1209
00:43:12,480 --> 00:43:16,650
<font color="#CCCCCC">they use this power shell game with the</font>

1210
00:43:14,370 --> 00:43:18,240
<font color="#CCCCCC">i-x download cradle</font><font color="#E5E5E5"> but this time the</font>

1211
00:43:16,650 --> 00:43:19,500
<font color="#CCCCCC">PowerShell</font><font color="#E5E5E5"> actually does the encrypting</font>

1212
00:43:18,240 --> 00:43:21,270
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the file itself</font><font color="#CCCCCC"> so it</font><font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> use</font>

1213
00:43:19,500 --> 00:43:22,620
some<font color="#E5E5E5"> other functionality again what's</font>

1214
00:43:21,270 --> 00:43:23,880
unique about it forensically there's

1215
00:43:22,620 --> 00:43:25,950
nothing on disk for you to go back<font color="#CCCCCC"> and</font>

1216
00:43:23,880 --> 00:43:26,880
<font color="#CCCCCC">look at to see</font><font color="#E5E5E5"> what happened it'll</font><font color="#CCCCCC"> just</font>

1217
00:43:25,950 --> 00:43:28,410
sit<font color="#E5E5E5"> there</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> start locking up your</font>

1218
00:43:26,880 --> 00:43:31,580
files for you encrypting and<font color="#E5E5E5"> then throw</font>

1219
00:43:28,410 --> 00:43:31,580
up this message<font color="#CCCCCC"> saying it wants</font><font color="#E5E5E5"> money</font>

1220
00:43:32,960 --> 00:43:37,530
Konza is a Incident Response framework<font color="#CCCCCC"> I</font>

1221
00:43:36,420 --> 00:43:38,550
know you see a bunch of<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> on the</font>

1222
00:43:37,530 --> 00:43:40,650
side<font color="#CCCCCC"> of screen</font><font color="#E5E5E5"> it probably doesn't mean</font>

1223
00:43:38,550 --> 00:43:42,030
<font color="#CCCCCC">nothing what it pretty much does is it</font>

1224
00:43:40,650 --> 00:43:43,950
will remotely connect to any computer

1225
00:43:42,030 --> 00:43:45,360
<font color="#E5E5E5">and it will grab all the files you would</font>

1226
00:43:43,950 --> 00:43:47,339
<font color="#E5E5E5">normally grab as an incident response</font>

1227
00:43:45,360 --> 00:43:48,780
person and it will pull it back for you

1228
00:43:47,340 --> 00:43:50,220
you kind<font color="#E5E5E5"> of configure that if you have a</font>

1229
00:43:48,780 --> 00:43:52,200
certain<font color="#CCCCCC"> way that you grab files</font><font color="#E5E5E5"> when you</font>

1230
00:43:50,220 --> 00:43:53,879
<font color="#E5E5E5">do forensics discovery or forensics</font>

1231
00:43:52,200 --> 00:43:55,140
response and that's<font color="#E5E5E5"> what kind</font><font color="#CCCCCC"> of what's</font>

1232
00:43:53,880 --> 00:43:56,850
<font color="#E5E5E5">going on here it's grabbing a buncha</font>

1233
00:43:55,140 --> 00:43:58,560
<font color="#CCCCCC">logs a bunch of configuration settings</font>

1234
00:43:56,850 --> 00:43:59,970
<font color="#CCCCCC">Auto runs all that kind of</font><font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> it</font>

1235
00:43:58,560 --> 00:44:01,740
grabs<font color="#E5E5E5"> all the data it sticks into the</font>

1236
00:43:59,970 --> 00:44:03,810
objects again you can do powerful<font color="#CCCCCC"> things</font>

1237
00:44:01,740 --> 00:44:05,220
<font color="#CCCCCC">with what data objects and you</font><font color="#E5E5E5"> can go</font>

1238
00:44:03,810 --> 00:44:11,210
operate on them to do other<font color="#E5E5E5"> things</font><font color="#CCCCCC"> after</font>

1239
00:44:05,220 --> 00:44:13,439
that power forensics is yet another<font color="#E5E5E5"> tool</font>

1240
00:44:11,210 --> 00:44:16,010
<font color="#CCCCCC">you can grab some stuff about</font><font color="#E5E5E5"> the Boot</font>

1241
00:44:13,440 --> 00:44:18,450
Record with his or the<font color="#E5E5E5"> NTFS filesystem</font>

1242
00:44:16,010 --> 00:44:19,740
<font color="#E5E5E5">he has a lot of neat stuff on here but I</font>

1243
00:44:18,450 --> 00:44:22,259
like the bottom<font color="#CCCCCC"> one on the right</font><font color="#E5E5E5"> hand</font>

1244
00:44:19,740 --> 00:44:23,640
<font color="#E5E5E5">corner it</font><font color="#CCCCCC"> invokes forensics dd</font><font color="#E5E5E5"> pretty</font>

1245
00:44:22,260 --> 00:44:26,510
sure it just<font color="#E5E5E5"> makes like a DD</font><font color="#CCCCCC"> image of a</font>

1246
00:44:23,640 --> 00:44:28,710
hard drive across<font color="#E5E5E5"> the network</font>

1247
00:44:26,510 --> 00:44:30,570
PowerShell<font color="#CCCCCC"> arsenal is for</font><font color="#E5E5E5"> reverse</font>

1248
00:44:28,710 --> 00:44:31,920
<font color="#CCCCCC">engineering again another</font><font color="#E5E5E5"> tool set</font><font color="#CCCCCC"> it</font>

1249
00:44:30,570 --> 00:44:34,470
has a bunch<font color="#E5E5E5"> of functionality</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you</font>

1250
00:44:31,920 --> 00:44:35,460
can use<font color="#E5E5E5"> again the tools are</font><font color="#CCCCCC"> in power so</font>

1251
00:44:34,470 --> 00:44:38,000
<font color="#CCCCCC">you</font><font color="#E5E5E5"> can use it</font><font color="#CCCCCC"> to do reverse</font><font color="#E5E5E5"> engineering</font>

1252
00:44:35,460 --> 00:44:38,000
<font color="#CCCCCC">with that</font>

1253
00:44:41,940 --> 00:44:45,880
all right a<font color="#CCCCCC"> little bit</font><font color="#E5E5E5"> of Defense</font><font color="#CCCCCC"> yeah I</font>

1254
00:44:44,619 --> 00:44:47,079
told you a lot<font color="#CCCCCC"> about</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> lot of ways to</font>

1255
00:44:45,880 --> 00:44:52,319
get<font color="#E5E5E5"> owned in a lot of ways to have fun</font>

1256
00:44:47,079 --> 00:44:54,400
<font color="#E5E5E5">but one of the ways</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can work with</font>

1257
00:44:52,319 --> 00:44:56,770
<font color="#CCCCCC">PowerShell to</font><font color="#E5E5E5"> kind of stop</font><font color="#CCCCCC"> attacks is to</font>

1258
00:44:54,400 --> 00:44:58,240
<font color="#CCCCCC">up your logging I recommend everybody</font>

1259
00:44:56,770 --> 00:45:00,790
upgrade any computer<font color="#CCCCCC"> that have the</font>

1260
00:44:58,240 --> 00:45:02,290
<font color="#E5E5E5">PowerShell version</font><font color="#CCCCCC"> 5</font><font color="#E5E5E5"> again Windows 10</font>

1261
00:45:00,790 --> 00:45:04,210
and comes<font color="#E5E5E5"> with it by default</font><font color="#CCCCCC"> but you can</font>

1262
00:45:02,290 --> 00:45:05,829
<font color="#E5E5E5">upgrade</font><font color="#CCCCCC"> Windows 7 up to</font><font color="#E5E5E5"> PowerShell</font>

1263
00:45:04,210 --> 00:45:08,740
version 5 as well<font color="#E5E5E5"> and the reason</font><font color="#CCCCCC"> for</font>

1264
00:45:05,829 --> 00:45:10,299
<font color="#CCCCCC">that is because it</font><font color="#E5E5E5"> has extended</font>

1265
00:45:08,740 --> 00:45:11,410
PowerShell logging<font color="#E5E5E5"> in it before you</font>

1266
00:45:10,299 --> 00:45:13,030
would just see that someone ran

1267
00:45:11,410 --> 00:45:14,279
PowerShell but if I use<font color="#CCCCCC"> the encoded</font>

1268
00:45:13,030 --> 00:45:17,079
command you wouldn't know what I ran

1269
00:45:14,280 --> 00:45:19,210
<font color="#E5E5E5">PowerShell version 5 has the</font><font color="#CCCCCC"> ability to</font>

1270
00:45:17,079 --> 00:45:20,710
<font color="#E5E5E5">do script block logging so that long</font>

1271
00:45:19,210 --> 00:45:23,230
string<font color="#E5E5E5"> of code that</font><font color="#CCCCCC"> I showed you</font><font color="#E5E5E5"> is all</font>

1272
00:45:20,710 --> 00:45:25,720
base64 stuff<font color="#E5E5E5"> it'll actually show you the</font>

1273
00:45:23,230 --> 00:45:28,030
<font color="#E5E5E5">D abuse kata code in the log system so</font>

1274
00:45:25,720 --> 00:45:29,379
if you pipe those logs to something like

1275
00:45:28,030 --> 00:45:30,760
<font color="#CCCCCC">Splunk and then you can turn around you</font>

1276
00:45:29,380 --> 00:45:32,109
can<font color="#CCCCCC"> actually see what's going on</font><font color="#E5E5E5"> now you</font>

1277
00:45:30,760 --> 00:45:34,210
can<font color="#E5E5E5"> see the code that's being executed</font>

1278
00:45:32,109 --> 00:45:36,240
<font color="#E5E5E5">on</font><font color="#CCCCCC"> a computer so if somebody on your</font>

1279
00:45:34,210 --> 00:45:38,140
network<font color="#E5E5E5"> use the</font><font color="#CCCCCC"> IX download string</font>

1280
00:45:36,240 --> 00:45:39,819
download cradle and download other

1281
00:45:38,140 --> 00:45:42,540
<font color="#E5E5E5">malware and you're</font><font color="#CCCCCC"> checking your logs</font>

1282
00:45:39,819 --> 00:45:44,799
you<font color="#CCCCCC"> can see that they actually</font><font color="#E5E5E5"> did that</font>

1283
00:45:42,540 --> 00:45:46,839
<font color="#CCCCCC">and it also has</font><font color="#E5E5E5"> system-wide</font>

1284
00:45:44,799 --> 00:45:48,400
transcription so like you can record on

1285
00:45:46,839 --> 00:45:50,380
every<font color="#E5E5E5"> computer on your entire domain or</font>

1286
00:45:48,400 --> 00:45:51,640
just specific<font color="#E5E5E5"> ones of high value every</font>

1287
00:45:50,380 --> 00:45:53,109
parish<font color="#CCCCCC"> of command that's entered</font><font color="#E5E5E5"> from</font>

1288
00:45:51,640 --> 00:45:56,430
<font color="#E5E5E5">the terminal save it</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> logging file</font>

1289
00:45:53,109 --> 00:45:56,430
<font color="#E5E5E5">just kind of like linux shell logging</font>

1290
00:45:57,150 --> 00:46:01,540
<font color="#CCCCCC">this is the ankle</font><font color="#E5E5E5"> of me again creating</font>

1291
00:45:59,530 --> 00:46:02,799
some<font color="#E5E5E5"> encoded command this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what it</font>

1292
00:46:01,540 --> 00:46:04,750
looked like again it's<font color="#CCCCCC"> just a bunch</font><font color="#E5E5E5"> of</font>

1293
00:46:02,799 --> 00:46:08,950
base64 string<font color="#CCCCCC"> all that was to</font><font color="#E5E5E5"> set up</font>

1294
00:46:04,750 --> 00:46:10,990
<font color="#E5E5E5">this when I executed</font><font color="#CCCCCC"> the command on the</font>

1295
00:46:08,950 --> 00:46:12,609
system<font color="#E5E5E5"> when I executed it with the base</font>

1296
00:46:10,990 --> 00:46:14,140
64 encoded stream this<font color="#E5E5E5"> is what gets</font>

1297
00:46:12,609 --> 00:46:17,410
stored<font color="#E5E5E5"> in the log you can actually see</font>

1298
00:46:14,140 --> 00:46:18,910
down<font color="#CCCCCC"> here it's that it's the</font><font color="#E5E5E5"> actual</font>

1299
00:46:17,410 --> 00:46:20,618
clear text of the string it's not that

1300
00:46:18,910 --> 00:46:22,509
long base64 encoded<font color="#E5E5E5"> string that you</font>

1301
00:46:20,619 --> 00:46:27,819
didn't know what I was talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> so</font>

1302
00:46:22,510 --> 00:46:29,799
you<font color="#CCCCCC"> can you</font><font color="#E5E5E5"> can do basics before can you</font>

1303
00:46:27,819 --> 00:46:32,529
can XOR it you can<font color="#E5E5E5"> rot13 and you can</font>

1304
00:46:29,799 --> 00:46:34,240
compress<font color="#CCCCCC"> it on top of that but when</font><font color="#E5E5E5"> it</font>

1305
00:46:32,530 --> 00:46:36,690
goes<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the log file it do you have to</font>

1306
00:46:34,240 --> 00:46:36,689
use gates it

1307
00:46:39,279 --> 00:46:42,319
<font color="#CCCCCC">PowerShell has this thing called cos</font>

1308
00:46:41,089 --> 00:46:43,880
<font color="#E5E5E5">strain language mode and it's probably</font>

1309
00:46:42,319 --> 00:46:45,788
<font color="#E5E5E5">the most</font><font color="#CCCCCC"> powerful way to stop people</font>

1310
00:46:43,880 --> 00:46:48,619
from using<font color="#E5E5E5"> PowerShell in nefarious ways</font>

1311
00:46:45,789 --> 00:46:49,760
<font color="#CCCCCC">there's many many language modes</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> the</font>

1312
00:46:48,619 --> 00:46:51,710
one I wanna talk<font color="#CCCCCC"> to</font><font color="#E5E5E5"> you about today</font><font color="#CCCCCC"> is</font>

1313
00:46:49,760 --> 00:46:53,059
<font color="#CCCCCC">called constrain</font><font color="#E5E5E5"> language mode again</font>

1314
00:46:51,710 --> 00:46:55,039
I've told you before the<font color="#E5E5E5"> PowerShell is</font>

1315
00:46:53,059 --> 00:46:56,990
primarily interacting with dotnet<font color="#E5E5E5"> when</font>

1316
00:46:55,039 --> 00:46:59,000
you configure<font color="#CCCCCC"> your</font><font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> to operate</font>

1317
00:46:56,990 --> 00:47:00,259
and constrain the language mode<font color="#E5E5E5"> you can</font>

1318
00:46:59,000 --> 00:47:02,750
no longer interact<font color="#E5E5E5"> with the dotnet</font>

1319
00:47:00,260 --> 00:47:04,700
service anymore<font color="#E5E5E5"> you're also not allowed</font>

1320
00:47:02,750 --> 00:47:06,140
<font color="#E5E5E5">to interact with win32 API s and you</font>

1321
00:47:04,700 --> 00:47:07,819
can't interact with calm objects<font color="#E5E5E5"> anymore</font>

1322
00:47:06,140 --> 00:47:11,000
so pretty much neuters<font color="#E5E5E5"> powershell you</font>

1323
00:47:07,819 --> 00:47:12,500
can't do<font color="#E5E5E5"> much of anything with it</font><font color="#CCCCCC"> now</font>

1324
00:47:11,000 --> 00:47:14,720
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can set</font><font color="#E5E5E5"> it through an environment</font>

1325
00:47:12,500 --> 00:47:15,980
<font color="#CCCCCC">variable which I show here</font><font color="#E5E5E5"> we could push</font>

1326
00:47:14,720 --> 00:47:17,509
it<font color="#E5E5E5"> out with the GPO but if you have</font>

1327
00:47:15,980 --> 00:47:18,980
<font color="#E5E5E5">local admin on the</font><font color="#CCCCCC"> box you</font><font color="#E5E5E5"> can just turn</font>

1328
00:47:17,510 --> 00:47:20,329
around<font color="#E5E5E5"> and reset it</font><font color="#CCCCCC"> back but</font><font color="#E5E5E5"> if it's a</font>

1329
00:47:18,980 --> 00:47:21,859
<font color="#E5E5E5">normal user and they don't have admin</font>

1330
00:47:20,329 --> 00:47:23,059
<font color="#CCCCCC">rights and you didn't give them local</font>

1331
00:47:21,859 --> 00:47:25,430
admin please don't do<font color="#CCCCCC"> that</font><font color="#E5E5E5"> please</font><font color="#CCCCCC"> don't</font>

1332
00:47:23,059 --> 00:47:26,779
<font color="#CCCCCC">give people</font><font color="#E5E5E5"> local admin then they'll be</font>

1333
00:47:25,430 --> 00:47:28,190
stuck with<font color="#E5E5E5"> that environment variable and</font>

1334
00:47:26,779 --> 00:47:29,390
they won't be<font color="#E5E5E5"> allowed</font><font color="#CCCCCC"> their PowerShell</font>

1335
00:47:28,190 --> 00:47:32,539
will be stuck in constraint language

1336
00:47:29,390 --> 00:47:34,430
mode<font color="#E5E5E5"> but if you have a blocker deployed</font>

1337
00:47:32,539 --> 00:47:36,440
on your network<font color="#CCCCCC"> AppLocker can when</font>

1338
00:47:34,430 --> 00:47:39,470
configured in allow mode so whitelist

1339
00:47:36,440 --> 00:47:41,450
mode<font color="#CCCCCC"> it will treat all powershell script</font>

1340
00:47:39,470 --> 00:47:43,549
as constrained language mode and and

1341
00:47:41,450 --> 00:47:44,990
even<font color="#CCCCCC"> if</font><font color="#E5E5E5"> somebody is a local admin they</font>

1342
00:47:43,549 --> 00:47:47,690
can't<font color="#E5E5E5"> set they can't change</font><font color="#CCCCCC"> that</font>

1343
00:47:44,990 --> 00:47:50,689
particular control<font color="#E5E5E5"> of a blocker first so</font>

1344
00:47:47,690 --> 00:47:52,450
if it's in tandem with<font color="#CCCCCC"> a blocker</font><font color="#E5E5E5"> and you</font>

1345
00:47:50,690 --> 00:47:54,650
have<font color="#CCCCCC"> constraint language mode set</font>

1346
00:47:52,450 --> 00:47:56,419
<font color="#CCCCCC">because you're using allow</font><font color="#E5E5E5"> only mode</font>

1347
00:47:54,650 --> 00:48:00,109
then<font color="#E5E5E5"> attackers will have a hard time</font>

1348
00:47:56,420 --> 00:48:02,119
<font color="#E5E5E5">executing code on</font><font color="#CCCCCC"> your box here's</font><font color="#E5E5E5"> an</font>

1349
00:48:00,109 --> 00:48:03,799
<font color="#E5E5E5">example of that</font><font color="#CCCCCC"> I did I checked this top</font>

1350
00:48:02,119 --> 00:48:05,690
one<font color="#E5E5E5"> is me checking my language mode</font><font color="#CCCCCC"> I</font>

1351
00:48:03,799 --> 00:48:07,549
<font color="#CCCCCC">said I had full language mode and then</font>

1352
00:48:05,690 --> 00:48:08,690
below it I set the<font color="#CCCCCC"> environment variable</font>

1353
00:48:07,549 --> 00:48:11,299
so<font color="#CCCCCC"> that would be put in constrained</font>

1354
00:48:08,690 --> 00:48:12,410
language mode<font color="#E5E5E5"> I had to open up a new</font>

1355
00:48:11,299 --> 00:48:16,520
<font color="#CCCCCC">window because it was a new environment</font>

1356
00:48:12,410 --> 00:48:18,618
<font color="#CCCCCC">and</font><font color="#E5E5E5"> then I checked my language mode</font>

1357
00:48:16,520 --> 00:48:19,940
again<font color="#E5E5E5"> you see here it</font><font color="#CCCCCC"> says I make a</font>

1358
00:48:18,619 --> 00:48:21,619
<font color="#CCCCCC">strand language mode and then I tried to</font>

1359
00:48:19,940 --> 00:48:23,029
<font color="#E5E5E5">use</font><font color="#CCCCCC"> that beautiful IEX download</font><font color="#E5E5E5"> cradle I</font>

1360
00:48:21,619 --> 00:48:25,160
talked about<font color="#E5E5E5"> and it didn't work it</font>

1361
00:48:23,029 --> 00:48:28,839
wouldn't<font color="#CCCCCC"> do anything</font><font color="#E5E5E5"> because because the</font>

1362
00:48:25,160 --> 00:48:28,839
<font color="#CCCCCC">PowerShell language was</font><font color="#E5E5E5"> constrained</font>

1363
00:48:29,180 --> 00:48:35,270
I<font color="#E5E5E5"> can get some other way go find</font><font color="#CCCCCC"> ie</font>

1364
00:48:33,250 --> 00:48:37,279
<font color="#E5E5E5">about the box or something</font>

1365
00:48:35,270 --> 00:48:39,349
now<font color="#CCCCCC"> ie X is just</font><font color="#E5E5E5"> shorthand for invoke</font>

1366
00:48:37,279 --> 00:48:42,380
expression<font color="#E5E5E5"> so it's just another</font>

1367
00:48:39,349 --> 00:48:43,369
command-line<font color="#E5E5E5"> PowerShell right yeah it's</font>

1368
00:48:42,380 --> 00:48:44,930
just it's<font color="#CCCCCC"> just running</font><font color="#E5E5E5"> a different</font>

1369
00:48:43,369 --> 00:48:46,609
PowerShell command<font color="#E5E5E5"> that I don't</font>

1370
00:48:44,930 --> 00:48:48,169
personally<font color="#CCCCCC"> know how</font><font color="#E5E5E5"> IX works in the</font>

1371
00:48:46,609 --> 00:48:49,578
background<font color="#CCCCCC"> but I'm willing to bet</font><font color="#E5E5E5"> that</font>

1372
00:48:48,170 --> 00:48:53,710
interacts with dotnet and<font color="#E5E5E5"> that</font>

1373
00:48:49,579 --> 00:48:56,180
<font color="#E5E5E5">functionalities are moved yeah yeah</font>

1374
00:48:53,710 --> 00:48:57,920
these additional resources

1375
00:48:56,180 --> 00:49:00,109
I think<font color="#E5E5E5"> if chance to talk about it but</font>

1376
00:48:57,920 --> 00:49:01,940
<font color="#CCCCCC">WMI is kind of</font><font color="#E5E5E5"> like becoming a really</font>

1377
00:49:00,109 --> 00:49:03,558
<font color="#E5E5E5">popular thing and what's neat about</font><font color="#CCCCCC"> WMI</font>

1378
00:49:01,940 --> 00:49:05,510
is you can use it<font color="#CCCCCC"> to</font><font color="#E5E5E5"> execute power shell</font>

1379
00:49:03,559 --> 00:49:06,770
code as well<font color="#E5E5E5"> one of the malware is I</font>

1380
00:49:05,510 --> 00:49:09,170
didn't stop and<font color="#CCCCCC"> talk about what</font><font color="#E5E5E5"> actually</font>

1381
00:49:06,770 --> 00:49:10,970
<font color="#E5E5E5">executes</font><font color="#CCCCCC"> it's</font><font color="#E5E5E5"> PowerShell code through W</font>

1382
00:49:09,170 --> 00:49:13,190
mine these<font color="#E5E5E5"> are some tools and some</font>

1383
00:49:10,970 --> 00:49:14,450
<font color="#E5E5E5">reports on W my tools that you can use</font>

1384
00:49:13,190 --> 00:49:19,549
but<font color="#CCCCCC"> I didn't</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about in this</font>

1385
00:49:14,450 --> 00:49:20,899
presentation<font color="#CCCCCC"> all right that's it you</font>

1386
00:49:19,549 --> 00:49:22,220
guys<font color="#CCCCCC"> any questions I</font><font color="#E5E5E5"> know it's really</font>

1387
00:49:20,900 --> 00:49:23,599
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> just meant to scratch the</font><font color="#E5E5E5"> surface</font>

1388
00:49:22,220 --> 00:49:25,098
and<font color="#CCCCCC"> just get you</font><font color="#E5E5E5"> in touch</font><font color="#CCCCCC"> with some of</font>

1389
00:49:23,599 --> 00:49:26,930
<font color="#CCCCCC">the PowerShell attack tools and</font><font color="#E5E5E5"> defense</font>

1390
00:49:25,099 --> 00:49:32,960
tools and all that kind of<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> if</font>

1391
00:49:26,930 --> 00:49:34,339
anyone's got<font color="#E5E5E5"> any questions</font><font color="#CCCCCC"> I think you</font>

1392
00:49:32,960 --> 00:49:36,349
can set the language mode all the<font color="#CCCCCC"> way</font>

1393
00:49:34,339 --> 00:49:39,259
back as far<font color="#CCCCCC"> as</font><font color="#E5E5E5"> three but I know you</font>

1394
00:49:36,349 --> 00:49:40,930
leaves<font color="#E5E5E5"> me in version 4.5 or</font><font color="#CCCCCC"> five to work</font>

1395
00:49:39,260 --> 00:49:43,579
with<font color="#CCCCCC"> AppLocker</font>

1396
00:49:40,930 --> 00:49:44,598
and if I'm<font color="#CCCCCC"> not a</font><font color="#E5E5E5"> hundred percent sure</font><font color="#CCCCCC"> on</font>

1397
00:49:43,579 --> 00:49:45,829
that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> could point you in the right</font>

1398
00:49:44,599 --> 00:49:46,609
place where I know you<font color="#CCCCCC"> can get</font><font color="#E5E5E5"> the</font>

1399
00:49:45,829 --> 00:49:48,410
answer for<font color="#CCCCCC"> sure</font>

1400
00:49:46,609 --> 00:49:51,078
<font color="#E5E5E5">I've not personally deployed a blocker</font>

1401
00:49:48,410 --> 00:49:52,460
<font color="#E5E5E5">or deployed Christian language motor</font>

1402
00:49:51,079 --> 00:49:53,809
network like Matt was<font color="#E5E5E5"> saying earlier I</font>

1403
00:49:52,460 --> 00:49:55,130
get the beauty of breaking<font color="#CCCCCC"> people stuff</font>

1404
00:49:53,809 --> 00:49:57,440
and tell them to<font color="#E5E5E5"> fix it I don't have</font><font color="#CCCCCC"> to</font>

1405
00:49:55,130 --> 00:49:59,599
<font color="#E5E5E5">fix anything so blue</font><font color="#CCCCCC"> team stuff is kind</font>

1406
00:49:57,440 --> 00:50:00,859
<font color="#E5E5E5">of I see I know what I'm</font><font color="#CCCCCC"> supposed to do</font>

1407
00:49:59,599 --> 00:50:02,510
<font color="#E5E5E5">the donation I've never had to implement</font>

1408
00:50:00,859 --> 00:50:03,980
<font color="#E5E5E5">it you know you got that</font><font color="#CCCCCC"> thing at how</font>

1409
00:50:02,510 --> 00:50:05,150
<font color="#CCCCCC">technology is supposed to</font><font color="#E5E5E5"> work and are</font>

1410
00:50:03,980 --> 00:50:06,200
you<font color="#E5E5E5"> trying to roll it out and it was</font>

1411
00:50:05,150 --> 00:50:07,309
really<font color="#CCCCCC"> paying the button you would</font><font color="#E5E5E5"> have</font>

1412
00:50:06,200 --> 00:50:09,799
<font color="#E5E5E5">never thought it would be</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> way</font>

1413
00:50:07,309 --> 00:50:12,859
so in theory that's all you got to do

1414
00:50:09,799 --> 00:50:15,250
<font color="#E5E5E5">I've not actually set it up you have</font>

1415
00:50:12,859 --> 00:50:15,250
<font color="#E5E5E5">questions</font>

1416
00:50:15,830 --> 00:50:23,060
the i-x<font color="#CCCCCC"> diamond</font><font color="#E5E5E5"> cradle oh yes yes in</font>

1417
00:50:20,780 --> 00:50:24,830
<font color="#E5E5E5">fact I just did a pretext engagement a</font>

1418
00:50:23,060 --> 00:50:26,480
week ago where I called somebody<font color="#CCCCCC"> on the</font>

1419
00:50:24,830 --> 00:50:28,400
phone<font color="#E5E5E5"> and I told</font><font color="#CCCCCC"> them I needed them to</font>

1420
00:50:26,480 --> 00:50:29,810
download<font color="#E5E5E5"> this web form for me</font><font color="#CCCCCC"> I didn't</font>

1421
00:50:28,400 --> 00:50:32,030
know what to go I didn't know what goes

1422
00:50:29,810 --> 00:50:34,220
in this block<font color="#E5E5E5"> 8 I told him so he</font>

1423
00:50:32,030 --> 00:50:36,080
downloads it and his company had macros

1424
00:50:34,220 --> 00:50:37,459
enabled<font color="#CCCCCC"> onboard documents as soon as he</font>

1425
00:50:36,080 --> 00:50:38,900
opened the word doc I had an empire

1426
00:50:37,460 --> 00:50:41,270
<font color="#CCCCCC">shell back because I use PowerShell</font>

1427
00:50:38,900 --> 00:50:43,220
<font color="#CCCCCC">Nayak's</font><font color="#E5E5E5"> demo cradle and I got myself an</font>

1428
00:50:41,270 --> 00:50:44,930
empire agent on his computer right<font color="#E5E5E5"> off</font>

1429
00:50:43,220 --> 00:50:46,819
<font color="#E5E5E5">the bat just</font><font color="#CCCCCC"> effective we're talking</font>

1430
00:50:44,930 --> 00:50:48,980
just<font color="#CCCCCC"> like</font><font color="#E5E5E5"> the malware does again I use</font>

1431
00:50:46,820 --> 00:50:52,720
<font color="#E5E5E5">the i-x download cradle to pull my shut</font>

1432
00:50:48,980 --> 00:50:56,630
myself<font color="#E5E5E5"> an empire shell</font><font color="#CCCCCC"> onto the computer</font>

1433
00:50:52,720 --> 00:50:59,169
any other questions<font color="#CCCCCC"> No thanks for</font><font color="#E5E5E5"> your</font>

1434
00:50:56,630 --> 00:50:59,170
time appreciate

