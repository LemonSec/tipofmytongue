1
00:00:45,100 --> 00:00:49,250
we want to thank all the<font color="#E5E5E5"> sponsors</font>

2
00:00:47,600 --> 00:00:50,990
because<font color="#CCCCCC"> without the sponsors</font><font color="#E5E5E5"> helping us</font>

3
00:00:49,250 --> 00:00:51,610
pay for<font color="#E5E5E5"> this</font><font color="#CCCCCC"> we wouldn't</font><font color="#E5E5E5"> be able to do</font>

4
00:00:50,990 --> 00:00:57,010
it at all

5
00:00:51,610 --> 00:01:00,220
um<font color="#CCCCCC"> so first off</font><font color="#E5E5E5"> our platinum sponsors is</font>

6
00:00:57,010 --> 00:01:02,690
<font color="#E5E5E5">cadre information security and</font>

7
00:01:00,220 --> 00:01:05,479
<font color="#E5E5E5">checkpoint software</font><font color="#CCCCCC"> you'll see them out</font>

8
00:01:02,690 --> 00:01:08,840
front<font color="#CCCCCC"> and</font><font color="#E5E5E5"> Cisco Systems which you'll see</font>

9
00:01:05,479 --> 00:01:11,000
upstairs<font color="#E5E5E5"> our gold sponsors</font><font color="#CCCCCC"> you'll see</font>

10
00:01:08,840 --> 00:01:12,590
them on<font color="#E5E5E5"> your bags</font><font color="#CCCCCC"> sword and shield</font>

11
00:01:11,000 --> 00:01:14,479
<font color="#CCCCCC">they'll be out front over there they've</font>

12
00:01:12,590 --> 00:01:16,520
<font color="#CCCCCC">got some cool giveaways for you</font>

13
00:01:14,479 --> 00:01:19,520
tenable network security which<font color="#CCCCCC"> is going</font>

14
00:01:16,520 --> 00:01:22,580
<font color="#E5E5E5">to be over</font><font color="#CCCCCC"> in the kec</font><font color="#E5E5E5"> tech systems which</font>

15
00:01:19,520 --> 00:01:24,649
is right here<font color="#E5E5E5"> in the wallet where you</font>

16
00:01:22,580 --> 00:01:26,298
walk<font color="#CCCCCC"> in the venue</font><font color="#E5E5E5"> and Optive which is</font>

17
00:01:24,650 --> 00:01:29,960
going<font color="#E5E5E5"> to be over</font><font color="#CCCCCC"> in the KC as well and</font>

18
00:01:26,299 --> 00:01:32,750
then also we've<font color="#CCCCCC"> got AB set security</font><font color="#E5E5E5"> and</font>

19
00:01:29,960 --> 00:01:35,210
<font color="#CCCCCC">ry</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> c-corp and they'll be over in the</font>

20
00:01:32,750 --> 00:01:37,930
<font color="#CCCCCC">the kec from there</font><font color="#E5E5E5"> so round of applause</font>

21
00:01:35,210 --> 00:01:37,929
<font color="#CCCCCC">for the sponsors</font>

22
00:01:39,900 --> 00:01:44,500
and as you may or may<font color="#CCCCCC"> not have noticed</font>

23
00:01:42,700 --> 00:01:46,150
<font color="#CCCCCC">by popular demand</font>

24
00:01:44,500 --> 00:01:47,440
everybody wanted posters last year we

25
00:01:46,150 --> 00:01:49,810
ran out<font color="#E5E5E5"> we did a run of posters</font>

26
00:01:47,440 --> 00:01:52,240
<font color="#E5E5E5">everybody gets a poster this year so</font>

27
00:01:49,810 --> 00:01:53,560
it's<font color="#E5E5E5"> either orange or blue it's just a</font>

28
00:01:52,240 --> 00:01:55,240
luck thing<font color="#CCCCCC"> whatever was in your bag</font>

29
00:01:53,560 --> 00:01:57,310
that's what you got so hope you guys

30
00:01:55,240 --> 00:01:58,690
<font color="#E5E5E5">enjoy</font><font color="#CCCCCC"> that we've also got some</font><font color="#E5E5E5"> other</font>

31
00:01:57,310 --> 00:02:01,930
<font color="#E5E5E5">giveaways that we'll be doing</font><font color="#CCCCCC"> during the</font>

32
00:01:58,690 --> 00:02:03,490
talks<font color="#CCCCCC"> books soldering iron kits and</font>

33
00:02:01,930 --> 00:02:05,440
<font color="#CCCCCC">lockpicks there's a lockpick village</font>

34
00:02:03,490 --> 00:02:08,169
again upstairs on the second floor<font color="#CCCCCC"> for</font>

35
00:02:05,440 --> 00:02:10,000
you<font color="#E5E5E5"> to try everything out</font><font color="#CCCCCC"> so from the</font>

36
00:02:08,169 --> 00:02:12,910
logistics<font color="#CCCCCC"> side</font><font color="#E5E5E5"> of things</font>

37
00:02:10,000 --> 00:02:17,410
<font color="#E5E5E5">first and foremost</font><font color="#CCCCCC"> how do you get fed</font>

38
00:02:12,910 --> 00:02:20,470
how do you drink things will go with

39
00:02:17,410 --> 00:02:22,600
food first right<font color="#E5E5E5"> in your bags there are</font>

40
00:02:20,470 --> 00:02:25,420
<font color="#E5E5E5">tickets okay do not lose these tickets</font>

41
00:02:22,600 --> 00:02:28,269
um a blue<font color="#E5E5E5"> ticket there's one of them</font>

42
00:02:25,420 --> 00:02:32,980
<font color="#E5E5E5">that is for food when you want to be fed</font>

43
00:02:28,270 --> 00:02:36,250
<font color="#E5E5E5">around lunch</font><font color="#CCCCCC"> come here</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> scruffy</font><font color="#E5E5E5"> stuff</font>

44
00:02:32,980 --> 00:02:37,840
<font color="#CCCCCC">this</font><font color="#E5E5E5"> aisle right here for drinks</font><font color="#CCCCCC"> we</font>

45
00:02:36,250 --> 00:02:39,340
include alcoholic drinks<font color="#E5E5E5"> because we know</font>

46
00:02:37,840 --> 00:02:42,400
everybody<font color="#E5E5E5"> likes</font><font color="#CCCCCC"> to drink</font><font color="#E5E5E5"> or a lot of</font>

47
00:02:39,340 --> 00:02:44,410
people do so<font color="#E5E5E5"> everybody gets two tickets</font>

48
00:02:42,400 --> 00:02:46,300
<font color="#CCCCCC">these</font><font color="#E5E5E5"> two purple tickets that</font><font color="#CCCCCC"> are in</font>

49
00:02:44,410 --> 00:02:49,090
your bags don't<font color="#E5E5E5"> lose them</font><font color="#CCCCCC"> that's how you</font>

50
00:02:46,300 --> 00:02:51,070
get alcohol<font color="#CCCCCC"> the bar</font><font color="#E5E5E5"> is open now they do</font>

51
00:02:49,090 --> 00:02:54,010
mimosas and<font color="#E5E5E5"> in whatever you want so uh</font>

52
00:02:51,070 --> 00:02:58,269
have at<font color="#E5E5E5"> it just make it through the day</font>

53
00:02:54,010 --> 00:03:00,850
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> if you drink too</font><font color="#E5E5E5"> much there's water</font>

54
00:02:58,269 --> 00:03:03,670
on<font color="#E5E5E5"> the bar too there is coffee over here</font>

55
00:03:00,850 --> 00:03:05,079
<font color="#CCCCCC">in this corner and the bar also</font><font color="#E5E5E5"> serves</font>

56
00:03:03,670 --> 00:03:07,268
fountain drinks and those are<font color="#CCCCCC"> included</font>

57
00:03:05,080 --> 00:03:08,200
so<font color="#E5E5E5"> you can have fountain drinks whenever</font>

58
00:03:07,269 --> 00:03:10,750
you<font color="#E5E5E5"> want</font>

59
00:03:08,200 --> 00:03:12,399
the other thing<font color="#E5E5E5"> logistics wise you will</font>

60
00:03:10,750 --> 00:03:14,620
<font color="#E5E5E5">notice wow</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> got complicated this</font>

61
00:03:12,400 --> 00:03:16,660
year<font color="#CCCCCC"> you will</font><font color="#E5E5E5"> notice there is a</font>

62
00:03:14,620 --> 00:03:20,530
wristband<font color="#CCCCCC"> this wristband gets you in the</font>

63
00:03:16,660 --> 00:03:24,160
after party tonight<font color="#E5E5E5"> okay cool all right</font>

64
00:03:20,530 --> 00:03:25,810
last but<font color="#CCCCCC"> not least where</font><font color="#E5E5E5"> all the tracks</font>

65
00:03:24,160 --> 00:03:29,350
we didn't put up signs<font color="#CCCCCC"> somebody just</font>

66
00:03:25,810 --> 00:03:33,459
told me<font color="#CCCCCC"> that so awesome</font><font color="#E5E5E5"> main track is</font>

67
00:03:29,350 --> 00:03:35,890
here in the<font color="#E5E5E5"> in scruffy City</font><font color="#CCCCCC"> kec will</font><font color="#E5E5E5"> be</font>

68
00:03:33,459 --> 00:03:38,350
track number<font color="#E5E5E5"> two and next</font><font color="#CCCCCC"> door in Prez</font>

69
00:03:35,890 --> 00:03:39,820
pod will be our third track<font color="#CCCCCC"> the third</font>

70
00:03:38,350 --> 00:03:41,970
track<font color="#CCCCCC"> is only</font><font color="#E5E5E5"> going to be running from</font><font color="#CCCCCC"> 9</font>

71
00:03:39,820 --> 00:03:46,150
to<font color="#CCCCCC"> 11 and</font><font color="#E5E5E5"> those</font><font color="#CCCCCC"> are remote talks ok</font>

72
00:03:41,970 --> 00:03:47,950
<font color="#CCCCCC">keynote is at 1:00 today</font><font color="#E5E5E5"> and check</font><font color="#CCCCCC"> the</font>

73
00:03:46,150 --> 00:03:50,350
b-sides<font color="#E5E5E5"> Knoxville website in sked org</font>

74
00:03:47,950 --> 00:03:52,640
for<font color="#E5E5E5"> the schedule for the day we're going</font>

75
00:03:50,350 --> 00:03:54,680
<font color="#E5E5E5">to try to get it on the monitors here</font>

76
00:03:52,640 --> 00:03:57,799
so people<font color="#E5E5E5"> can see it</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> venue as</font>

77
00:03:54,680 --> 00:03:59,450
well<font color="#E5E5E5"> but that's it</font><font color="#CCCCCC"> thanks everybody for</font>

78
00:03:57,800 --> 00:04:00,230
<font color="#CCCCCC">coming out I hope you guys have a</font><font color="#E5E5E5"> good</font>

79
00:03:59,450 --> 00:04:01,970
time

80
00:04:00,230 --> 00:04:03,619
and let us<font color="#E5E5E5"> know if</font><font color="#CCCCCC"> you need</font><font color="#E5E5E5"> anything so</font>

81
00:04:01,970 --> 00:04:06,310
with that we'll<font color="#E5E5E5"> start up the first</font>

82
00:04:03,620 --> 00:04:06,310
presentation

83
00:04:25,510 --> 00:04:33,039
hi<font color="#E5E5E5"> everyone</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> Ariel from Cisco stair</font>

84
00:04:29,680 --> 00:04:34,900
<font color="#E5E5E5">stair</font><font color="#CCCCCC"> Center</font><font color="#E5E5E5"> and Cisco the stair</font><font color="#CCCCCC"> Center</font>

85
00:04:33,040 --> 00:04:36,640
is got a pretty long name it's a

86
00:04:34,900 --> 00:04:38,710
security<font color="#E5E5E5"> threat analysis and reverse</font>

87
00:04:36,640 --> 00:04:42,070
engineering<font color="#CCCCCC"> Center we're located in</font>

88
00:04:38,710 --> 00:04:44,979
Haifa in Israel we<font color="#CCCCCC"> have we do we perform</font>

89
00:04:42,070 --> 00:04:46,930
blackbox testing on embedded<font color="#CCCCCC"> devices we</font>

90
00:04:44,980 --> 00:04:50,190
have<font color="#E5E5E5"> two main teams the hardware team</font>

91
00:04:46,930 --> 00:04:52,360
which is a very much<font color="#E5E5E5"> hardware they do a</font>

92
00:04:50,190 --> 00:04:54,219
<font color="#E5E5E5">silicon reverse engineering the layering</font>

93
00:04:52,360 --> 00:04:56,800
of chips using<font color="#E5E5E5"> electron microscopes</font>

94
00:04:54,220 --> 00:04:59,470
<font color="#CCCCCC">laser glitching and</font><font color="#E5E5E5"> all kinds of heavy</font>

95
00:04:56,800 --> 00:05:01,240
stuff<font color="#CCCCCC"> and then there's the software</font><font color="#E5E5E5"> team</font>

96
00:04:59,470 --> 00:05:03,010
which I'm part<font color="#E5E5E5"> of which we do reverse</font>

97
00:05:01,240 --> 00:05:06,700
<font color="#CCCCCC">engineering of all the anything which</font>

98
00:05:03,010 --> 00:05:09,789
runs code for the past three years or so

99
00:05:06,700 --> 00:05:13,180
<font color="#E5E5E5">or so we've been</font><font color="#CCCCCC"> working with the carry</font>

100
00:05:09,790 --> 00:05:15,310
<font color="#CCCCCC">industry mainly North</font><font color="#E5E5E5"> American vehicle</font>

101
00:05:13,180 --> 00:05:17,230
manufacturers we've been<font color="#E5E5E5"> helping them</font>

102
00:05:15,310 --> 00:05:18,940
test their systems look for<font color="#E5E5E5"> security</font>

103
00:05:17,230 --> 00:05:20,830
vulnerabilities<font color="#E5E5E5"> before they get sent out</font>

104
00:05:18,940 --> 00:05:22,650
<font color="#CCCCCC">to the</font><font color="#E5E5E5"> field hopefully we'll find the</font>

105
00:05:20,830 --> 00:05:24,490
problems<font color="#E5E5E5"> before</font><font color="#CCCCCC"> somebody else finds them</font>

106
00:05:22,650 --> 00:05:26,080
for obvious<font color="#E5E5E5"> reasons I won't</font><font color="#CCCCCC"> be</font>

107
00:05:24,490 --> 00:05:28,090
mentioning specific names or models of

108
00:05:26,080 --> 00:05:30,070
cars but it's pretty<font color="#CCCCCC"> safe to say that</font>

109
00:05:28,090 --> 00:05:33,460
some<font color="#CCCCCC"> of you drove in today with cars</font>

110
00:05:30,070 --> 00:05:35,890
<font color="#E5E5E5">that we've had a look at in the</font><font color="#CCCCCC"> past so</font>

111
00:05:33,460 --> 00:05:38,049
<font color="#E5E5E5">what we'll be talking about today</font><font color="#CCCCCC"> first</font>

112
00:05:35,890 --> 00:05:39,849
of<font color="#E5E5E5"> all I have a look and see from a</font>

113
00:05:38,050 --> 00:05:41,500
hackers perspective how we see a car

114
00:05:39,850 --> 00:05:44,020
when we look<font color="#E5E5E5"> at it</font><font color="#CCCCCC"> we'll learn</font><font color="#E5E5E5"> a bit</font>

115
00:05:41,500 --> 00:05:47,170
<font color="#CCCCCC">about the ecosystem</font><font color="#E5E5E5"> connections inside</font>

116
00:05:44,020 --> 00:05:49,510
and out<font color="#E5E5E5"> we'll touch a few common</font>

117
00:05:47,170 --> 00:05:50,950
security<font color="#E5E5E5"> problems that we see we'll go</font>

118
00:05:49,510 --> 00:05:52,960
through a<font color="#E5E5E5"> few of</font><font color="#CCCCCC"> our tools</font><font color="#E5E5E5"> and at the</font>

119
00:05:50,950 --> 00:05:54,430
end to wrap it all up and bring<font color="#CCCCCC"> into</font>

120
00:05:52,960 --> 00:05:56,049
context I'll walk you<font color="#CCCCCC"> through a project</font>

121
00:05:54,430 --> 00:05:58,270
<font color="#CCCCCC">that we</font><font color="#E5E5E5"> did from beginning to end</font><font color="#CCCCCC"> from</font>

122
00:05:56,050 --> 00:06:00,250
<font color="#CCCCCC">the</font><font color="#E5E5E5"> stage of receiving the design and</font>

123
00:05:58,270 --> 00:06:02,280
analyzing it until the<font color="#E5E5E5"> actual</font>

124
00:06:00,250 --> 00:06:04,720
development<font color="#CCCCCC"> of an exploit</font><font color="#E5E5E5"> for that car</font>

125
00:06:02,280 --> 00:06:06,219
<font color="#E5E5E5">yeah it's not going to be very deep</font><font color="#CCCCCC"> oh</font>

126
00:06:04,720 --> 00:06:09,550
very<font color="#E5E5E5"> technical don't worry it's more of</font>

127
00:06:06,220 --> 00:06:12,180
a more of<font color="#CCCCCC"> a overview of</font><font color="#E5E5E5"> the field the</font>

128
00:06:09,550 --> 00:06:14,590
first question<font color="#CCCCCC"> to ask is what is the car</font>

129
00:06:12,180 --> 00:06:16,720
well that depends very much<font color="#E5E5E5"> you ask him</font>

130
00:06:14,590 --> 00:06:18,130
<font color="#E5E5E5">right if you ask a</font><font color="#CCCCCC"> traveller</font><font color="#E5E5E5"> he'll</font>

131
00:06:16,720 --> 00:06:20,040
<font color="#E5E5E5">probably say it's a vehicle which takes</font>

132
00:06:18,130 --> 00:06:22,930
people<font color="#CCCCCC"> from one place to another</font>

133
00:06:20,040 --> 00:06:24,430
she<font color="#CCCCCC"> ask a mechanic he'll say it's an</font>

134
00:06:22,930 --> 00:06:26,830
<font color="#E5E5E5">internal combustion engine with the</font>

135
00:06:24,430 --> 00:06:28,990
transmission<font color="#E5E5E5"> final drive wheels steering</font>

136
00:06:26,830 --> 00:06:31,300
chassis all the rest of the mechanical

137
00:06:28,990 --> 00:06:33,550
parts<font color="#CCCCCC"> of a car you ask a hacker or</font><font color="#E5E5E5"> water</font>

138
00:06:31,300 --> 00:06:35,140
carries<font color="#E5E5E5"> it's just a pile of computers</font>

139
00:06:33,550 --> 00:06:37,480
<font color="#E5E5E5">there's a whole lot of computers</font>

140
00:06:35,140 --> 00:06:38,610
connected<font color="#CCCCCC"> inside a car nowadays I say a</font>

141
00:06:37,480 --> 00:06:41,159
pile<font color="#E5E5E5"> because there are a few</font>

142
00:06:38,610 --> 00:06:43,080
usually in modern<font color="#E5E5E5"> cars</font><font color="#CCCCCC"> all talking to</font>

143
00:06:41,159 --> 00:06:44,969
each other<font color="#CCCCCC"> the big</font><font color="#E5E5E5"> difference to</font>

144
00:06:43,080 --> 00:06:46,560
remember between<font color="#E5E5E5"> these</font><font color="#CCCCCC"> paolo computers</font>

145
00:06:44,969 --> 00:06:47,520
and any other computers<font color="#E5E5E5"> that you have in</font>

146
00:06:46,560 --> 00:06:49,650
your house or<font color="#CCCCCC"> office</font>

147
00:06:47,520 --> 00:06:51,960
<font color="#CCCCCC">these ones are sitting on wheels</font><font color="#E5E5E5"> and</font>

148
00:06:49,650 --> 00:06:54,900
<font color="#CCCCCC">your</font><font color="#E5E5E5"> possibly inside the car driving at</font>

149
00:06:51,960 --> 00:06:56,128
65 miles<font color="#CCCCCC"> per hour</font><font color="#E5E5E5"> so when it's at</font><font color="#CCCCCC"> home</font>

150
00:06:54,900 --> 00:06:57,900
something<font color="#E5E5E5"> goes wrong in your computer if</font>

151
00:06:56,129 --> 00:06:59,280
somebody<font color="#E5E5E5"> takes it over or crashes</font>

152
00:06:57,900 --> 00:07:01,520
something<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> not the end of the world</font>

153
00:06:59,280 --> 00:07:03,508
you<font color="#E5E5E5"> might lose some</font><font color="#CCCCCC"> money lose some data</font>

154
00:07:01,520 --> 00:07:06,719
<font color="#E5E5E5">when you're driving in a</font><font color="#CCCCCC"> car</font><font color="#E5E5E5"> something</font>

155
00:07:03,509 --> 00:07:08,129
goes wrong it could be<font color="#E5E5E5"> very bad now all</font>

156
00:07:06,719 --> 00:07:09,810
this stuff<font color="#E5E5E5"> has</font><font color="#CCCCCC"> been true for the last</font>

157
00:07:08,129 --> 00:07:11,370
that<font color="#E5E5E5"> know</font><font color="#CCCCCC"> 20 30 years</font><font color="#E5E5E5"> since they</font>

158
00:07:09,810 --> 00:07:14,189
invented<font color="#E5E5E5"> the fuel injection probably</font>

159
00:07:11,370 --> 00:07:16,560
thing goes back in the 80s or 70s<font color="#E5E5E5"> what's</font>

160
00:07:14,189 --> 00:07:20,279
new nowadays in the modern cars what we

161
00:07:16,560 --> 00:07:22,560
call a connected car<font color="#CCCCCC"> a connected car is</font>

162
00:07:20,279 --> 00:07:25,740
a car with lots<font color="#E5E5E5"> and lots of cool attack</font>

163
00:07:22,560 --> 00:07:27,360
vectors or supposedly<font color="#E5E5E5"> connection</font>

164
00:07:25,740 --> 00:07:29,460
interfaces to<font color="#CCCCCC"> the world</font><font color="#E5E5E5"> right you have</font>

165
00:07:27,360 --> 00:07:31,349
your<font color="#E5E5E5"> entertainment system which connects</font>

166
00:07:29,460 --> 00:07:33,120
<font color="#E5E5E5">up to</font><font color="#CCCCCC"> the internet to download</font><font color="#E5E5E5"> media and</font>

167
00:07:31,349 --> 00:07:34,800
<font color="#E5E5E5">applications and stuff you have a</font>

168
00:07:33,120 --> 00:07:37,580
diagnostic<font color="#E5E5E5"> system connecting back</font><font color="#CCCCCC"> to the</font>

169
00:07:34,800 --> 00:07:39,719
<font color="#CCCCCC">cars back-end</font><font color="#E5E5E5"> to report errors</font>

170
00:07:37,580 --> 00:07:41,938
<font color="#E5E5E5">diagnostic problems</font><font color="#CCCCCC"> and maintenance</font><font color="#E5E5E5"> and</font>

171
00:07:39,719 --> 00:07:44,789
<font color="#CCCCCC">whatever you</font><font color="#E5E5E5"> have RF connections to your</font>

172
00:07:41,939 --> 00:07:47,159
<font color="#CCCCCC">key fob you have maybe a mobile phone</font>

173
00:07:44,789 --> 00:07:50,550
app to remotely start the car it's cold

174
00:07:47,159 --> 00:07:52,589
you<font color="#E5E5E5"> got</font><font color="#CCCCCC"> up before you</font><font color="#E5E5E5"> get the car</font><font color="#CCCCCC"> this</font>

175
00:07:50,550 --> 00:07:54,690
<font color="#E5E5E5">hair you</font><font color="#CCCCCC"> have satellite radio</font><font color="#E5E5E5"> digital</font>

176
00:07:52,589 --> 00:07:56,310
terrestrial radio soon<font color="#E5E5E5"> cars</font><font color="#CCCCCC"> gonna be</font>

177
00:07:54,690 --> 00:07:58,830
talking<font color="#E5E5E5"> to each other as you</font><font color="#CCCCCC"> can see</font>

178
00:07:56,310 --> 00:08:01,889
there are many many connections<font color="#E5E5E5"> many</font>

179
00:07:58,830 --> 00:08:03,628
networks<font color="#CCCCCC"> going out of this</font><font color="#E5E5E5"> car on a</font>

180
00:08:01,889 --> 00:08:05,009
personal note a<font color="#E5E5E5"> couple of years</font><font color="#CCCCCC"> ago our</font>

181
00:08:03,629 --> 00:08:07,289
leasing company wanted to upgrade<font color="#CCCCCC"> the</font>

182
00:08:05,009 --> 00:08:08,639
cars to new cars<font color="#E5E5E5"> and the salesperson was</font>

183
00:08:07,289 --> 00:08:09,960
<font color="#E5E5E5">trying to convince me how great this car</font>

184
00:08:08,639 --> 00:08:11,669
is it's fully connected<font color="#E5E5E5"> straight to</font>

185
00:08:09,960 --> 00:08:13,469
their internet into their computers they

186
00:08:11,669 --> 00:08:15,060
can<font color="#E5E5E5"> control everything I said no thank</font>

187
00:08:13,469 --> 00:08:18,629
you<font color="#CCCCCC"> I have the first</font><font color="#E5E5E5"> thing with my old</font>

188
00:08:15,060 --> 00:08:20,520
car had all these computers talk to each

189
00:08:18,629 --> 00:08:21,839
other inside<font color="#CCCCCC"> the car</font><font color="#E5E5E5"> there's a series of</font>

190
00:08:20,520 --> 00:08:23,698
<font color="#E5E5E5">buses of network connections between</font>

191
00:08:21,839 --> 00:08:25,849
them<font color="#CCCCCC"> they're the canvas</font><font color="#E5E5E5"> the Flex</font>

192
00:08:23,699 --> 00:08:27,839
robustly<font color="#E5E5E5"> in bus different names but</font>

193
00:08:25,849 --> 00:08:29,128
ultimately the<font color="#E5E5E5"> rest ways for the</font>

194
00:08:27,839 --> 00:08:30,860
different<font color="#CCCCCC"> notes to talk to each other</font><font color="#E5E5E5"> I</font>

195
00:08:29,129 --> 00:08:32,849
don't<font color="#E5E5E5"> expect you to read all the</font>

196
00:08:30,860 --> 00:08:34,440
specific thoughts but<font color="#E5E5E5"> you can you see</font>

197
00:08:32,849 --> 00:08:36,449
there are quite<font color="#CCCCCC"> a few points</font><font color="#E5E5E5"> connected</font>

198
00:08:34,440 --> 00:08:38,459
<font color="#E5E5E5">from one to another in the car starting</font>

199
00:08:36,448 --> 00:08:40,289
from the door handle<font color="#CCCCCC"> to the to the</font>

200
00:08:38,458 --> 00:08:43,529
pedals to<font color="#E5E5E5"> anything else in the car</font><font color="#CCCCCC"> air</font>

201
00:08:40,289 --> 00:08:45,360
<font color="#E5E5E5">bags whatever it is and this trend is</font>

202
00:08:43,529 --> 00:08:47,010
increasing<font color="#E5E5E5"> right the the cars of</font>

203
00:08:45,360 --> 00:08:48,360
tomorrow<font color="#E5E5E5"> are getting more and more</font>

204
00:08:47,010 --> 00:08:49,560
<font color="#E5E5E5">advanced we're having seen more more</font>

205
00:08:48,360 --> 00:08:51,300
interfaces<font color="#E5E5E5"> and more and more automatic</font>

206
00:08:49,560 --> 00:08:52,319
features of the car which is computer

207
00:08:51,300 --> 00:08:54,150
controlled<font color="#CCCCCC"> you know like</font>

208
00:08:52,320 --> 00:08:58,380
<font color="#E5E5E5">services assisted parking all those</font>

209
00:08:54,150 --> 00:09:01,140
stuff one of the main<font color="#E5E5E5"> buses in a car is</font>

210
00:08:58,380 --> 00:09:03,450
called<font color="#CCCCCC"> a can bus it's very common bus</font>

211
00:09:01,140 --> 00:09:04,680
<font color="#E5E5E5">these are some of the example example</font>

212
00:09:03,450 --> 00:09:05,970
messages you see<font color="#E5E5E5"> running on the</font><font color="#CCCCCC"> cam</font>

213
00:09:04,680 --> 00:09:09,319
<font color="#CCCCCC">Buster's like the air conditioning</font>

214
00:09:05,970 --> 00:09:12,210
control<font color="#E5E5E5"> the radio volume lights the</font>

215
00:09:09,320 --> 00:09:14,880
cruise control<font color="#E5E5E5"> as you can see some</font><font color="#CCCCCC"> of</font>

216
00:09:12,210 --> 00:09:16,080
these<font color="#CCCCCC"> messages are quite harmless</font><font color="#E5E5E5"> some</font>

217
00:09:14,880 --> 00:09:18,240
of them might be less because<font color="#E5E5E5"> cruise</font>

218
00:09:16,080 --> 00:09:21,750
control can control<font color="#CCCCCC"> your accelerator</font><font color="#E5E5E5"> and</font>

219
00:09:18,240 --> 00:09:24,120
your brakes<font color="#E5E5E5"> in the current the can bus</font>

220
00:09:21,750 --> 00:09:27,240
the control<font color="#E5E5E5"> area network is a simple bus</font>

221
00:09:24,120 --> 00:09:29,240
it's a single line<font color="#CCCCCC"> or</font><font color="#E5E5E5"> differential</font><font color="#CCCCCC"> two</font>

222
00:09:27,240 --> 00:09:32,700
line bus with a few nodes connected<font color="#E5E5E5"> a</font>

223
00:09:29,240 --> 00:09:34,560
pretty standard packet<font color="#E5E5E5"> structure</font><font color="#CCCCCC"> you</font>

224
00:09:32,700 --> 00:09:36,810
have<font color="#CCCCCC"> an ID and</font><font color="#E5E5E5"> a payload and a CRC and</font>

225
00:09:34,560 --> 00:09:38,189
stuff<font color="#E5E5E5"> anyone who connects the bus can</font>

226
00:09:36,810 --> 00:09:39,209
listen to all the messages<font color="#E5E5E5"> and consent</font>

227
00:09:38,190 --> 00:09:41,780
messages on the bus there's no

228
00:09:39,210 --> 00:09:43,560
<font color="#CCCCCC">master/slave or any special</font><font color="#E5E5E5"> set up there</font>

229
00:09:41,780 --> 00:09:45,209
interesting thing to know<font color="#CCCCCC"> about the cam</font>

230
00:09:43,560 --> 00:09:47,069
<font color="#CCCCCC">bass is that the idea of</font><font color="#E5E5E5"> the message is</font>

231
00:09:45,210 --> 00:09:48,930
also<font color="#E5E5E5"> the priority of the message the</font>

232
00:09:47,070 --> 00:09:50,880
message<font color="#E5E5E5"> with a lower ID</font><font color="#CCCCCC"> let missing with</font>

233
00:09:48,930 --> 00:09:52,530
more<font color="#CCCCCC"> zeros takes precedence over other</font>

234
00:09:50,880 --> 00:09:54,300
messages so if someone is trying<font color="#E5E5E5"> to send</font>

235
00:09:52,530 --> 00:09:55,860
<font color="#E5E5E5">a message</font><font color="#CCCCCC"> and at</font><font color="#E5E5E5"> the same time I send a</font>

236
00:09:54,300 --> 00:09:57,300
<font color="#CCCCCC">message</font><font color="#E5E5E5"> with more zeros my message goes</font>

237
00:09:55,860 --> 00:09:59,190
through so it's<font color="#CCCCCC"> very</font><font color="#E5E5E5"> easy once</font><font color="#CCCCCC"> you</font>

238
00:09:57,300 --> 00:10:00,240
connect it<font color="#E5E5E5"> to the bus just take over</font><font color="#CCCCCC"> the</font>

239
00:09:59,190 --> 00:10:03,020
<font color="#E5E5E5">whole bus and</font><font color="#CCCCCC"> flood</font><font color="#E5E5E5"> up with your</font>

240
00:10:00,240 --> 00:10:07,050
messages<font color="#CCCCCC"> or no one else can communicate</font>

241
00:10:03,020 --> 00:10:09,510
<font color="#E5E5E5">yeah some of you might be</font><font color="#CCCCCC"> aware some not</font>

242
00:10:07,050 --> 00:10:11,400
you can you have a clear access to the

243
00:10:09,510 --> 00:10:13,020
<font color="#CCCCCC">can bus in your car</font><font color="#E5E5E5"> although all modern</font>

244
00:10:11,400 --> 00:10:14,699
<font color="#E5E5E5">cars have</font><font color="#CCCCCC"> a connector called the obd2</font>

245
00:10:13,020 --> 00:10:16,650
connector<font color="#E5E5E5"> it's under the steering wheel</font>

246
00:10:14,700 --> 00:10:18,510
that's they using the<font color="#E5E5E5"> garage to connect</font>

247
00:10:16,650 --> 00:10:21,270
and get diagnostic information and stuff

248
00:10:18,510 --> 00:10:22,500
<font color="#E5E5E5">it's very</font><font color="#CCCCCC"> easy</font><font color="#E5E5E5"> to buy a</font><font color="#CCCCCC"> third-party</font><font color="#E5E5E5"> tool</font>

249
00:10:21,270 --> 00:10:24,120
you<font color="#E5E5E5"> can get one from the</font><font color="#CCCCCC"> internet you</font>

250
00:10:22,500 --> 00:10:25,470
could sniff the can bus<font color="#E5E5E5"> read the</font>

251
00:10:24,120 --> 00:10:27,780
messages you<font color="#CCCCCC"> can write on the can bus</font>

252
00:10:25,470 --> 00:10:29,840
and you can experiment with<font color="#E5E5E5"> it if if you</font>

253
00:10:27,780 --> 00:10:32,040
want to if you're brave enough to try

254
00:10:29,840 --> 00:10:33,570
<font color="#E5E5E5">okay in the past if you wanted to do</font>

255
00:10:32,040 --> 00:10:35,790
<font color="#E5E5E5">something bad to someone you would crawl</font>

256
00:10:33,570 --> 00:10:38,520
under their car<font color="#E5E5E5"> and cut the brake lines</font>

257
00:10:35,790 --> 00:10:39,839
<font color="#E5E5E5">when they</font><font color="#CCCCCC"> are not looking</font><font color="#E5E5E5"> yeah excuse me</font>

258
00:10:38,520 --> 00:10:43,230
<font color="#E5E5E5">for the photo is not really a cutter</font>

259
00:10:39,840 --> 00:10:46,800
it's more of a crimping tool but it was

260
00:10:43,230 --> 00:10:48,780
a<font color="#E5E5E5"> good photo and by crawling under a car</font>

261
00:10:46,800 --> 00:10:49,740
<font color="#E5E5E5">is the first of all</font><font color="#CCCCCC"> it's dirty</font><font color="#E5E5E5"> right</font>

262
00:10:48,780 --> 00:10:51,990
you're lying on<font color="#E5E5E5"> the floor the brake</font>

263
00:10:49,740 --> 00:10:53,280
fluid might spill on you and second<font color="#E5E5E5"> of</font>

264
00:10:51,990 --> 00:10:54,630
all it's dangerous as an attacker you

265
00:10:53,280 --> 00:10:57,329
<font color="#E5E5E5">have to get very</font><font color="#CCCCCC"> close you're actually</font>

266
00:10:54,630 --> 00:10:58,680
touching<font color="#CCCCCC"> the car</font><font color="#E5E5E5"> you can get caught</font><font color="#CCCCCC"> it</font>

267
00:10:57,330 --> 00:11:01,170
will be much nicer<font color="#CCCCCC"> on if you can do the</font>

268
00:10:58,680 --> 00:11:02,760
same<font color="#CCCCCC"> much nicer and cleaner if you could</font>

269
00:11:01,170 --> 00:11:04,790
<font color="#CCCCCC">ascend the can message on the bus which</font>

270
00:11:02,760 --> 00:11:07,610
does exactly the<font color="#CCCCCC"> same</font><font color="#E5E5E5"> thing</font>

271
00:11:04,790 --> 00:11:11,030
when we look at<font color="#E5E5E5"> the attacks on cars</font>

272
00:11:07,610 --> 00:11:13,030
<font color="#E5E5E5">their severity we grade the severity by</font>

273
00:11:11,030 --> 00:11:14,990
the distance<font color="#CCCCCC"> from the car</font><font color="#E5E5E5"> the the</font>

274
00:11:13,030 --> 00:11:16,760
<font color="#CCCCCC">weakest attacks are</font><font color="#E5E5E5"> the ones that you</font>

275
00:11:14,990 --> 00:11:18,620
need physical<font color="#CCCCCC"> access to</font><font color="#E5E5E5"> the car actually</font>

276
00:11:16,760 --> 00:11:20,840
<font color="#CCCCCC">plugging in a USB</font><font color="#E5E5E5"> connector or</font><font color="#CCCCCC"> the can</font>

277
00:11:18,620 --> 00:11:22,640
bus or<font color="#E5E5E5"> anything else</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> can do bad</font><font color="#CCCCCC"> stuff</font>

278
00:11:20,840 --> 00:11:24,470
but<font color="#E5E5E5"> you have to be close you the same</font>

279
00:11:22,640 --> 00:11:27,830
distance<font color="#CCCCCC"> you could have actually cut the</font>

280
00:11:24,470 --> 00:11:28,910
brake lines<font color="#CCCCCC"> further</font><font color="#E5E5E5"> away attacks from a</font>

281
00:11:27,830 --> 00:11:30,830
few<font color="#E5E5E5"> meters if you connect to the</font>

282
00:11:28,910 --> 00:11:32,480
Bluetooth or Wi-Fi or<font color="#E5E5E5"> something else</font>

283
00:11:30,830 --> 00:11:33,410
<font color="#E5E5E5">like the way you can</font><font color="#CCCCCC"> actually attack a</font>

284
00:11:32,480 --> 00:11:35,420
car<font color="#CCCCCC"> or open a car from</font><font color="#E5E5E5"> the outside</font>

285
00:11:33,410 --> 00:11:37,189
<font color="#E5E5E5">without physically being inside the car</font>

286
00:11:35,420 --> 00:11:38,630
or physically touching it<font color="#E5E5E5"> and the best</font>

287
00:11:37,190 --> 00:11:40,250
attacks are ones which are<font color="#E5E5E5"> done over the</font>

288
00:11:38,630 --> 00:11:42,650
<font color="#E5E5E5">internet from far</font><font color="#CCCCCC"> away</font><font color="#E5E5E5"> you can actually</font>

289
00:11:40,250 --> 00:11:56,740
<font color="#CCCCCC">attack a car anywhere</font><font color="#E5E5E5"> in the world from</font>

290
00:11:42,650 --> 00:11:59,720
<font color="#E5E5E5">your hello connection somewhere</font><font color="#CCCCCC"> oh okay</font>

291
00:11:56,740 --> 00:12:02,210
<font color="#CCCCCC">okay you can say that the</font><font color="#E5E5E5"> frost the holy</font>

292
00:11:59,720 --> 00:12:04,490
grail of attacks is attacking a car from

293
00:12:02,210 --> 00:12:06,110
<font color="#E5E5E5">far away from the internet and gaining</font>

294
00:12:04,490 --> 00:12:08,380
control over<font color="#E5E5E5"> the canvas to send</font>

295
00:12:06,110 --> 00:12:10,280
arbitrary<font color="#E5E5E5"> messages</font><font color="#CCCCCC"> whatever we want</font>

296
00:12:08,380 --> 00:12:12,230
let's talk about<font color="#E5E5E5"> about</font><font color="#CCCCCC"> Internet</font>

297
00:12:10,280 --> 00:12:13,610
connectivity<font color="#CCCCCC"> how do</font><font color="#E5E5E5"> the cars connect to</font>

298
00:12:12,230 --> 00:12:14,840
the<font color="#E5E5E5"> Internet well it's obviously not</font>

299
00:12:13,610 --> 00:12:16,910
<font color="#E5E5E5">wired because they're</font><font color="#CCCCCC"> moving around</font>

300
00:12:14,840 --> 00:12:18,620
<font color="#CCCCCC">that's</font><font color="#E5E5E5"> unless you're in</font><font color="#CCCCCC"> the amusement</font>

301
00:12:16,910 --> 00:12:20,750
<font color="#CCCCCC">park</font><font color="#E5E5E5"> in those cars would have that metal</font>

302
00:12:18,620 --> 00:12:22,610
<font color="#E5E5E5">thing into the ceiling and</font><font color="#CCCCCC"> Wi-Fi</font>

303
00:12:20,750 --> 00:12:23,600
wouldn't work also<font color="#CCCCCC"> cuz keep moving</font>

304
00:12:22,610 --> 00:12:26,210
<font color="#E5E5E5">around you get out of range</font>

305
00:12:23,600 --> 00:12:27,500
so the standard the connectivity is done

306
00:12:26,210 --> 00:12:30,530
through<font color="#E5E5E5"> cellular connections right just</font>

307
00:12:27,500 --> 00:12:31,940
<font color="#E5E5E5">like a mobile phone the two standard</font>

308
00:12:30,530 --> 00:12:34,130
ways are either<font color="#CCCCCC"> go</font><font color="#E5E5E5"> through your actual</font>

309
00:12:31,940 --> 00:12:35,930
mobile<font color="#E5E5E5"> phone you set up a</font><font color="#CCCCCC"> hotspot in in</font>

310
00:12:34,130 --> 00:12:36,860
the phone tethering and it connects

311
00:12:35,930 --> 00:12:38,810
through your phone to the<font color="#CCCCCC"> Internet</font>

312
00:12:36,860 --> 00:12:40,850
<font color="#E5E5E5">that's very useful for attacker because</font>

313
00:12:38,810 --> 00:12:41,750
<font color="#E5E5E5">first of all we can see</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> traffic</font>

314
00:12:40,850 --> 00:12:44,270
going<font color="#E5E5E5"> through our phone it helped us</font>

315
00:12:41,750 --> 00:12:45,590
analyze the<font color="#E5E5E5"> traffic and second of all</font>

316
00:12:44,270 --> 00:12:46,850
gives us more attack surface because

317
00:12:45,590 --> 00:12:48,740
this<font color="#E5E5E5"> way you can attack someone's phone</font>

318
00:12:46,850 --> 00:12:51,140
instead of<font color="#E5E5E5"> attacking the car and get</font>

319
00:12:48,740 --> 00:12:53,060
inside the stream of data the<font color="#CCCCCC"> other</font>

320
00:12:51,140 --> 00:12:55,010
option which we also see is that<font color="#CCCCCC"> the car</font>

321
00:12:53,060 --> 00:12:58,010
itself<font color="#E5E5E5"> connects the internet directly it</font>

322
00:12:55,010 --> 00:13:00,350
has a cellular mobile<font color="#E5E5E5"> chip inside out</font>

323
00:12:58,010 --> 00:13:02,120
with a SIM card<font color="#CCCCCC"> or whatever</font><font color="#E5E5E5"> and it just</font>

324
00:13:00,350 --> 00:13:04,400
straight up<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Internet that's</font><font color="#E5E5E5"> a bit</font>

325
00:13:02,120 --> 00:13:07,070
harder to to get in the middle<font color="#E5E5E5"> of</font><font color="#CCCCCC"> that</font>

326
00:13:04,400 --> 00:13:09,050
connection<font color="#E5E5E5"> what kind of things we look</font>

327
00:13:07,070 --> 00:13:11,630
<font color="#E5E5E5">for well the obvious thing is look for</font>

328
00:13:09,050 --> 00:13:13,819
<font color="#E5E5E5">open ports some was listening on a some</font>

329
00:13:11,630 --> 00:13:15,860
<font color="#E5E5E5">kind of service an open port in a car or</font>

330
00:13:13,820 --> 00:13:17,930
<font color="#CCCCCC">in any computers just</font><font color="#E5E5E5"> like a door with a</font>

331
00:13:15,860 --> 00:13:20,330
welcome mat<font color="#CCCCCC"> for a hacker to</font><font color="#E5E5E5"> come in</font>

332
00:13:17,930 --> 00:13:22,069
<font color="#CCCCCC">just like at home you wouldn't</font><font color="#E5E5E5"> expect to</font>

333
00:13:20,330 --> 00:13:22,790
<font color="#CCCCCC">see</font><font color="#E5E5E5"> open ports in your computer external</font>

334
00:13:22,070 --> 00:13:24,200
facing ports

335
00:13:22,790 --> 00:13:26,089
unless you're trying<font color="#E5E5E5"> to host some kind</font>

336
00:13:24,200 --> 00:13:28,220
of service<font color="#CCCCCC"> you</font><font color="#E5E5E5"> definitely would not like</font>

337
00:13:26,089 --> 00:13:29,960
to<font color="#CCCCCC"> see them in cars but we still do see</font>

338
00:13:28,220 --> 00:13:32,300
them sometimes people leave them open

339
00:13:29,960 --> 00:13:33,680
<font color="#CCCCCC">for</font><font color="#E5E5E5"> all kinds of reasons now since</font>

340
00:13:32,300 --> 00:13:35,300
they're connecting to<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Internet</font>

341
00:13:33,680 --> 00:13:37,069
you want the connection<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be secure</font>

342
00:13:35,300 --> 00:13:39,430
<font color="#E5E5E5">just like any other computer connecting</font>

343
00:13:37,070 --> 00:13:42,200
to a secure site they use the standard

344
00:13:39,430 --> 00:13:43,579
protocols<font color="#E5E5E5"> like SSL Secure Sockets Layer</font>

345
00:13:42,200 --> 00:13:47,480
to encrypt and authenticate the

346
00:13:43,580 --> 00:13:49,370
connection but<font color="#E5E5E5"> unfortunately SSL has</font>

347
00:13:47,480 --> 00:13:53,270
many many configuration parameters and

348
00:13:49,370 --> 00:13:55,520
quite often we<font color="#CCCCCC"> see that some</font><font color="#E5E5E5"> of them are</font>

349
00:13:53,270 --> 00:13:56,990
<font color="#E5E5E5">wrong it's fair to say that most of the</font>

350
00:13:55,520 --> 00:13:58,819
<font color="#E5E5E5">most of the</font><font color="#CCCCCC"> Susilo configurations that</font>

351
00:13:56,990 --> 00:14:02,029
we've seen there<font color="#CCCCCC"> was something</font><font color="#E5E5E5"> wrong if</font>

352
00:13:58,820 --> 00:14:03,470
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> the wrong cipher suite or something</font>

353
00:14:02,029 --> 00:14:05,089
wrong with the keys or sometimes they

354
00:14:03,470 --> 00:14:06,950
<font color="#E5E5E5">have too many certificates</font><font color="#CCCCCC"> people don't</font>

355
00:14:05,089 --> 00:14:09,380
don't<font color="#E5E5E5"> the camera</font><font color="#CCCCCC"> effect</font><font color="#E5E5E5"> you don't always</font>

356
00:14:06,950 --> 00:14:10,790
realize that a car<font color="#CCCCCC"> is not a browser at</font>

357
00:14:09,380 --> 00:14:12,290
home your browser's got to connect to

358
00:14:10,790 --> 00:14:14,089
thousands and<font color="#E5E5E5"> thousands of websites that</font>

359
00:14:12,290 --> 00:14:16,339
<font color="#E5E5E5">need tons of certificates to connect to</font>

360
00:14:14,089 --> 00:14:18,860
all the different places<font color="#E5E5E5"> the cache will</font>

361
00:14:16,339 --> 00:14:21,500
only connect to one preferably<font color="#E5E5E5"> one or</font>

362
00:14:18,860 --> 00:14:22,970
two<font color="#E5E5E5"> servers there's no need to have so</font>

363
00:14:21,500 --> 00:14:25,160
many having too many<font color="#CCCCCC"> certificates in</font><font color="#E5E5E5"> the</font>

364
00:14:22,970 --> 00:14:26,390
system can<font color="#E5E5E5"> help somebody like</font><font color="#CCCCCC"> ass</font>

365
00:14:25,160 --> 00:14:29,060
<font color="#CCCCCC">getting</font><font color="#E5E5E5"> and with one of the certificates</font>

366
00:14:26,390 --> 00:14:30,860
<font color="#E5E5E5">that they</font><font color="#CCCCCC"> enable</font><font color="#E5E5E5"> an example</font>

367
00:14:29,060 --> 00:14:32,900
configuration<font color="#E5E5E5"> problems is in this little</font>

368
00:14:30,860 --> 00:14:35,000
which we've seen<font color="#CCCCCC"> used in the past</font>

369
00:14:32,900 --> 00:14:36,620
there are many flags to set one of<font color="#E5E5E5"> them</font>

370
00:14:35,000 --> 00:14:38,029
is called<font color="#CCCCCC"> a</font><font color="#E5E5E5"> verified</font><font color="#CCCCCC"> peer which means</font>

371
00:14:36,620 --> 00:14:40,040
you're<font color="#E5E5E5"> doing server side authentication</font>

372
00:14:38,029 --> 00:14:42,140
checking that the<font color="#E5E5E5"> server's who you think</font>

373
00:14:40,040 --> 00:14:43,910
it is the second<font color="#E5E5E5"> one is a verified host</font>

374
00:14:42,140 --> 00:14:46,100
which says actually check<font color="#E5E5E5"> that the</font>

375
00:14:43,910 --> 00:14:47,360
server name in the<font color="#E5E5E5"> the common name in</font>

376
00:14:46,100 --> 00:14:48,260
the<font color="#E5E5E5"> certificate is the correct name that</font>

377
00:14:47,360 --> 00:14:50,720
you're trying<font color="#E5E5E5"> to connect to or not</font>

378
00:14:48,260 --> 00:14:52,490
<font color="#E5E5E5">another server so some</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> think that</font>

379
00:14:50,720 --> 00:14:53,690
just<font color="#E5E5E5"> setting verify</font><font color="#CCCCCC"> host is enough</font>

380
00:14:52,490 --> 00:14:55,279
setting it to<font color="#E5E5E5"> one or</font><font color="#CCCCCC"> something but if</font>

381
00:14:53,690 --> 00:14:57,200
you read the<font color="#E5E5E5"> man page it says that when</font>

382
00:14:55,279 --> 00:14:58,730
the verify value is<font color="#CCCCCC"> zero</font><font color="#E5E5E5"> the condition</font>

383
00:14:57,200 --> 00:15:00,140
succeeds regret regardless of the names

384
00:14:58,730 --> 00:15:02,390
<font color="#E5E5E5">so if you couldn't</font><font color="#CCCCCC"> read the fine print</font>

385
00:15:00,140 --> 00:15:04,910
<font color="#E5E5E5">in the</font><font color="#CCCCCC"> main pages</font><font color="#E5E5E5"> it's very easy</font><font color="#CCCCCC"> to make</font>

386
00:15:02,390 --> 00:15:06,410
a<font color="#E5E5E5"> mistake and</font><font color="#CCCCCC"> let us get</font><font color="#E5E5E5"> in and we've</font>

387
00:15:04,910 --> 00:15:08,900
done this more than<font color="#E5E5E5"> once</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the past by</font>

388
00:15:06,410 --> 00:15:10,189
impersonating<font color="#E5E5E5"> other servers and finding</font>

389
00:15:08,900 --> 00:15:13,970
slight differences in certificate today

390
00:15:10,190 --> 00:15:15,579
<font color="#E5E5E5">they weren't looking for another thing</font>

391
00:15:13,970 --> 00:15:17,720
<font color="#E5E5E5">that you have in cars</font>

392
00:15:15,579 --> 00:15:19,699
<font color="#CCCCCC">listen other computers perhaps</font><font color="#E5E5E5"> what we</font>

393
00:15:17,720 --> 00:15:20,959
call remote commands this<font color="#E5E5E5"> is an</font><font color="#CCCCCC"> example</font>

394
00:15:19,700 --> 00:15:23,029
<font color="#E5E5E5">of a</font><font color="#CCCCCC"> mobile app you might have</font><font color="#E5E5E5"> seen</font>

395
00:15:20,959 --> 00:15:24,290
something similar<font color="#E5E5E5"> we haven't looked at</font>

396
00:15:23,029 --> 00:15:26,600
this one specifically<font color="#E5E5E5"> I just chose an</font>

397
00:15:24,290 --> 00:15:29,949
example which is<font color="#CCCCCC"> not from</font><font color="#E5E5E5"> our from our</font>

398
00:15:26,600 --> 00:15:32,680
area<font color="#E5E5E5"> they give you option to stand</font>

399
00:15:29,950 --> 00:15:34,720
thank you give you options<font color="#E5E5E5"> to start and</font>

400
00:15:32,680 --> 00:15:35,949
stop<font color="#CCCCCC"> the</font><font color="#E5E5E5"> car from afar</font><font color="#CCCCCC"> open the doors</font>

401
00:15:34,720 --> 00:15:38,200
and<font color="#E5E5E5"> lock on all kinds of other stuff</font>

402
00:15:35,950 --> 00:15:40,450
check the<font color="#E5E5E5"> location in the</font><font color="#CCCCCC"> carpark</font><font color="#E5E5E5"> how do</font>

403
00:15:38,200 --> 00:15:42,670
these commands get from your phone or

404
00:15:40,450 --> 00:15:45,180
<font color="#CCCCCC">from</font><font color="#E5E5E5"> your computer</font><font color="#CCCCCC"> to the car</font><font color="#E5E5E5"> there all</font>

405
00:15:42,670 --> 00:15:48,959
<font color="#CCCCCC">kinds of</font><font color="#E5E5E5"> systems one of them is</font><font color="#CCCCCC"> using a</font>

406
00:15:45,180 --> 00:15:51,819
special<font color="#CCCCCC"> service</font><font color="#E5E5E5"> for example</font><font color="#CCCCCC"> MQTT</font><font color="#E5E5E5"> brokers</font>

407
00:15:48,959 --> 00:15:54,180
<font color="#CCCCCC">one kind of system that does</font><font color="#E5E5E5"> this kind</font>

408
00:15:51,820 --> 00:15:56,470
<font color="#CCCCCC">of messaging mqt broker is a</font>

409
00:15:54,180 --> 00:15:58,569
<font color="#CCCCCC">publish/subscribe system you define</font>

410
00:15:56,470 --> 00:16:00,010
<font color="#E5E5E5">queues you can publish messages to a</font>

411
00:15:58,570 --> 00:16:01,720
queue anyone subscribe to the queue will

412
00:16:00,010 --> 00:16:03,819
receive the message<font color="#CCCCCC"> it's very flexible</font>

413
00:16:01,720 --> 00:16:06,279
<font color="#E5E5E5">very dynamic</font><font color="#CCCCCC"> you can invent any name of</font>

414
00:16:03,820 --> 00:16:08,199
a cube<font color="#CCCCCC"> just type whatever you</font><font color="#E5E5E5"> want</font><font color="#CCCCCC"> ABC</font>

415
00:16:06,279 --> 00:16:10,300
<font color="#E5E5E5">if someone</font><font color="#CCCCCC"> registers the ABC he'll get</font>

416
00:16:08,199 --> 00:16:11,949
the messages it's so flexible<font color="#CCCCCC"> that it</font>

417
00:16:10,300 --> 00:16:14,829
has<font color="#E5E5E5"> many configuration parameters also</font>

418
00:16:11,949 --> 00:16:17,620
<font color="#E5E5E5">and we've seen mistakes and these kind</font>

419
00:16:14,829 --> 00:16:18,790
of things too we've had systems where<font color="#E5E5E5"> we</font>

420
00:16:17,620 --> 00:16:20,769
could connect from<font color="#E5E5E5"> the public Internet</font>

421
00:16:18,790 --> 00:16:22,360
to a live system<font color="#E5E5E5"> actually this is a live</font>

422
00:16:20,769 --> 00:16:24,220
system<font color="#E5E5E5"> connect from the public Internet</font>

423
00:16:22,360 --> 00:16:26,110
to the<font color="#CCCCCC"> mqtt broker</font><font color="#E5E5E5"> and send a</font><font color="#CCCCCC"> message to</font>

424
00:16:24,220 --> 00:16:29,160
<font color="#E5E5E5">any car</font><font color="#CCCCCC"> on the system or to all the cars</font>

425
00:16:26,110 --> 00:16:31,480
at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> same time giving them commands</font>

426
00:16:29,160 --> 00:16:32,589
sometimes your car goes<font color="#CCCCCC"> to sleep you're</font>

427
00:16:31,480 --> 00:16:34,390
parking<font color="#E5E5E5"> for a long time they don't want</font>

428
00:16:32,589 --> 00:16:36,220
to<font color="#CCCCCC"> don't want</font><font color="#E5E5E5"> to be online the whole</font>

429
00:16:34,390 --> 00:16:37,600
<font color="#E5E5E5">time so how do they get a message to the</font>

430
00:16:36,220 --> 00:16:39,370
<font color="#E5E5E5">cars you want to send their command they</font>

431
00:16:37,600 --> 00:16:41,199
use SMS is something called a SMS

432
00:16:39,370 --> 00:16:43,209
shoulder<font color="#E5E5E5"> tap it's kind of a wake up</font>

433
00:16:41,199 --> 00:16:45,250
package they<font color="#E5E5E5"> have all kinds of formats</font>

434
00:16:43,209 --> 00:16:46,719
<font color="#E5E5E5">sometimes they have the server URL</font>

435
00:16:45,250 --> 00:16:48,279
<font color="#E5E5E5">inside that tells the car where to</font>

436
00:16:46,720 --> 00:16:50,620
connect and get commands sometimes the

437
00:16:48,279 --> 00:16:53,920
actual<font color="#E5E5E5"> command is inside has some kind</font>

438
00:16:50,620 --> 00:16:56,500
<font color="#E5E5E5">of identification</font><font color="#CCCCCC"> these things too are</font>

439
00:16:53,920 --> 00:16:57,699
another way in for us hackers if there's

440
00:16:56,500 --> 00:16:59,019
a<font color="#CCCCCC"> mistake in passing the message</font>

441
00:16:57,699 --> 00:17:00,849
sometimes<font color="#E5E5E5"> we can find</font><font color="#CCCCCC"> it variability</font>

442
00:16:59,019 --> 00:17:03,010
just by sending<font color="#CCCCCC"> a mail phone message</font>

443
00:17:00,850 --> 00:17:04,360
sometimes they<font color="#CCCCCC"> don't check</font><font color="#E5E5E5"> properly that</font>

444
00:17:03,010 --> 00:17:05,799
the server is<font color="#E5E5E5"> actually one of their</font>

445
00:17:04,359 --> 00:17:07,540
<font color="#E5E5E5">servers and we can direct the car to</font>

446
00:17:05,799 --> 00:17:09,520
connect to<font color="#E5E5E5"> our server</font><font color="#CCCCCC"> all kinds of other</font>

447
00:17:07,540 --> 00:17:12,699
funky stuff<font color="#E5E5E5"> that</font><font color="#CCCCCC"> can be</font><font color="#E5E5E5"> done through</font>

448
00:17:09,520 --> 00:17:15,189
these sms's<font color="#CCCCCC"> a good solution to all this</font>

449
00:17:12,699 --> 00:17:17,260
would<font color="#E5E5E5"> be obviously to isolate the</font>

450
00:17:15,189 --> 00:17:19,839
network right there's no<font color="#E5E5E5"> reason for me</font>

451
00:17:17,260 --> 00:17:21,369
<font color="#E5E5E5">for my from public IP address to be able</font>

452
00:17:19,839 --> 00:17:23,559
<font color="#E5E5E5">to</font><font color="#CCCCCC"> connect to a car right the car</font><font color="#E5E5E5"> should</font>

453
00:17:21,369 --> 00:17:25,359
be<font color="#E5E5E5"> part of a private network for the car</font>

454
00:17:23,559 --> 00:17:26,889
manufacturer no reason for<font color="#CCCCCC"> it to be</font>

455
00:17:25,359 --> 00:17:30,820
<font color="#E5E5E5">connected</font><font color="#CCCCCC"> to the Internet if you block</font>

456
00:17:26,890 --> 00:17:32,169
<font color="#CCCCCC">it off</font><font color="#E5E5E5"> both for sms's and for IP it</font>

457
00:17:30,820 --> 00:17:33,490
seems like a pretty<font color="#CCCCCC"> good solution all</font>

458
00:17:32,169 --> 00:17:36,460
<font color="#E5E5E5">right when a car connects to the</font>

459
00:17:33,490 --> 00:17:38,740
cellular<font color="#E5E5E5"> operator uses since the the SIM</font>

460
00:17:36,460 --> 00:17:40,510
cards<font color="#E5E5E5"> iccid some kind of identifier</font>

461
00:17:38,740 --> 00:17:43,120
which connects to the APM<font color="#CCCCCC"> Mac gives it a</font>

462
00:17:40,510 --> 00:17:45,520
IP address in the<font color="#E5E5E5"> specific</font><font color="#CCCCCC"> range which</font>

463
00:17:43,120 --> 00:17:46,928
no one<font color="#E5E5E5"> else can</font><font color="#CCCCCC"> access so in order</font><font color="#E5E5E5"> to</font>

464
00:17:45,520 --> 00:17:48,490
access<font color="#E5E5E5"> these cars we need to get a</font>

465
00:17:46,929 --> 00:17:50,919
computer<font color="#CCCCCC"> somehow inside that network</font>

466
00:17:48,490 --> 00:17:52,360
<font color="#E5E5E5">which gets the same range of IPs to</font>

467
00:17:50,919 --> 00:17:55,330
<font color="#E5E5E5">attack them but</font><font color="#CCCCCC"> where can</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> find a</font>

468
00:17:52,360 --> 00:17:57,189
<font color="#E5E5E5">Linux computer inside that</font><font color="#CCCCCC"> Network well</font>

469
00:17:55,330 --> 00:17:59,168
lucky for<font color="#CCCCCC"> us</font><font color="#E5E5E5"> as we said before the cars</font>

470
00:17:57,190 --> 00:18:00,520
themselves<font color="#E5E5E5"> are computers so in cases</font>

471
00:17:59,169 --> 00:18:02,770
<font color="#CCCCCC">like</font><font color="#E5E5E5"> this when we see this kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> setup</font>

472
00:18:00,520 --> 00:18:04,270
we attack one car locally once we have

473
00:18:02,770 --> 00:18:07,590
access<font color="#E5E5E5"> in</font><font color="#CCCCCC"> that car we could just hop</font>

474
00:18:04,270 --> 00:18:07,590
<font color="#CCCCCC">around to the rest of the of the network</font>

475
00:18:07,679 --> 00:18:11,980
<font color="#E5E5E5">obviously</font><font color="#CCCCCC"> a better solution will be to</font>

476
00:18:09,809 --> 00:18:13,418
<font color="#CCCCCC">probably</font><font color="#E5E5E5"> isolate each car from each</font>

477
00:18:11,980 --> 00:18:15,429
other and make sure that messages<font color="#E5E5E5"> only</font>

478
00:18:13,419 --> 00:18:17,380
go to who they're intended to from the

479
00:18:15,429 --> 00:18:20,080
<font color="#CCCCCC">cab back</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> back end</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> the other</font>

480
00:18:17,380 --> 00:18:21,549
<font color="#E5E5E5">way it should be some kind of layered</font>

481
00:18:20,080 --> 00:18:22,780
security<font color="#E5E5E5"> you know</font><font color="#CCCCCC"> altogether close the</font>

482
00:18:21,549 --> 00:18:24,760
<font color="#E5E5E5">port I had firewalls and all the</font>

483
00:18:22,780 --> 00:18:28,059
configurations but often<font color="#E5E5E5"> enough it's not</font>

484
00:18:24,760 --> 00:18:31,210
implemented<font color="#E5E5E5"> properly</font><font color="#CCCCCC"> even</font><font color="#E5E5E5"> car systems</font>

485
00:18:28,059 --> 00:18:33,760
today<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so understand</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the</font>

486
00:18:31,210 --> 00:18:36,190
attacker is trying to to<font color="#E5E5E5"> connect the car</font>

487
00:18:33,760 --> 00:18:38,169
from from a<font color="#E5E5E5"> farm</font><font color="#CCCCCC"> how do we start</font><font color="#E5E5E5"> about</font>

488
00:18:36,190 --> 00:18:40,480
getting<font color="#E5E5E5"> into the car at about about</font>

489
00:18:38,169 --> 00:18:42,220
attacking<font color="#E5E5E5"> the computer even for our for</font>

490
00:18:40,480 --> 00:18:43,690
our<font color="#E5E5E5"> testing purposes</font><font color="#CCCCCC"> even not for a real</font>

491
00:18:42,220 --> 00:18:47,590
attack just to learn<font color="#E5E5E5"> about the system</font>

492
00:18:43,690 --> 00:18:49,059
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is black box system well first of</font>

493
00:18:47,590 --> 00:18:50,889
all<font color="#CCCCCC"> for the port's we do with a regular</font>

494
00:18:49,059 --> 00:18:53,110
<font color="#CCCCCC">port scanning</font><font color="#E5E5E5"> port scanning techniques</font>

495
00:18:50,890 --> 00:18:54,250
like you would on<font color="#E5E5E5"> a computer which is</font>

496
00:18:53,110 --> 00:18:55,270
easy enough<font color="#E5E5E5"> if it goes through your cell</font>

497
00:18:54,250 --> 00:18:57,070
phone<font color="#E5E5E5"> like we said</font><font color="#CCCCCC"> before because</font>

498
00:18:55,270 --> 00:18:58,389
<font color="#E5E5E5">sulfone is a computer also</font><font color="#CCCCCC"> I can just</font>

499
00:18:57,070 --> 00:18:59,530
see all the traffic<font color="#CCCCCC"> how do we do</font><font color="#E5E5E5"> it when</font>

500
00:18:58,390 --> 00:19:02,320
it connects straight to the cellular

501
00:18:59,530 --> 00:19:04,658
<font color="#CCCCCC">network</font><font color="#E5E5E5"> well for example in our office</font>

502
00:19:02,320 --> 00:19:07,480
in Haifa we've got this pretty large box

503
00:19:04,659 --> 00:19:10,390
<font color="#CCCCCC">called a base station</font><font color="#E5E5E5"> simulation it's</font>

504
00:19:07,480 --> 00:19:12,190
actually<font color="#E5E5E5"> like a mobile it's a cellular</font>

505
00:19:10,390 --> 00:19:14,500
tower inside your office<font color="#CCCCCC"> assuming you</font>

506
00:19:12,190 --> 00:19:16,419
<font color="#E5E5E5">don't mind the radiation you can</font>

507
00:19:14,500 --> 00:19:18,130
simulate any any operator you just put

508
00:19:16,419 --> 00:19:19,299
all the right parameters<font color="#CCCCCC"> it's actually</font>

509
00:19:18,130 --> 00:19:21,700
not that bad<font color="#E5E5E5"> the radiation is sort of</font>

510
00:19:19,299 --> 00:19:23,168
pointed at the car and you<font color="#CCCCCC"> can make it</font>

511
00:19:21,700 --> 00:19:24,790
connect<font color="#E5E5E5"> to the cellular</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> through</font>

512
00:19:23,169 --> 00:19:27,280
our<font color="#CCCCCC"> setup they're</font><font color="#E5E5E5"> also cheaper things</font>

513
00:19:24,790 --> 00:19:29,620
like femtocells which<font color="#CCCCCC"> are for home use</font>

514
00:19:27,280 --> 00:19:32,080
but this is a more professional solution

515
00:19:29,620 --> 00:19:33,879
which has<font color="#CCCCCC"> other capabilities</font><font color="#E5E5E5"> now this</font>

516
00:19:32,080 --> 00:19:35,740
kind<font color="#E5E5E5"> of cellular connectivity is not</font>

517
00:19:33,880 --> 00:19:38,440
something you<font color="#E5E5E5"> can do only inside an</font>

518
00:19:35,740 --> 00:19:41,590
<font color="#E5E5E5">office inside</font><font color="#CCCCCC"> a lab like a few</font><font color="#E5E5E5"> years ago</font>

519
00:19:38,440 --> 00:19:42,390
those a protocol wasp<font color="#CCCCCC"> which was a aerial</font>

520
00:19:41,590 --> 00:19:44,590
surveillance

521
00:19:42,390 --> 00:19:46,870
<font color="#CCCCCC">something I can't</font><font color="#E5E5E5"> remember the acronym</font>

522
00:19:44,590 --> 00:19:48,730
<font color="#CCCCCC">we had this drone flying around</font><font color="#E5E5E5"> with</font>

523
00:19:46,870 --> 00:19:49,870
Wi-Fi and<font color="#CCCCCC"> cellular capabilities to</font>

524
00:19:48,730 --> 00:19:50,630
connect make people<font color="#E5E5E5"> connect to the</font>

525
00:19:49,870 --> 00:19:52,428
cellular

526
00:19:50,630 --> 00:19:54,110
<font color="#E5E5E5">signal so theoretically you could float</font>

527
00:19:52,429 --> 00:19:57,260
on top<font color="#E5E5E5"> of cars and make them connect to</font>

528
00:19:54,110 --> 00:19:59,809
you how else<font color="#E5E5E5"> do we</font><font color="#CCCCCC"> you try and get in we</font>

529
00:19:57,260 --> 00:20:01,220
use<font color="#CCCCCC"> the fighting techniques like you</font>

530
00:19:59,809 --> 00:20:02,990
<font color="#E5E5E5">wouldn't a nine yeah the system we've</font>

531
00:20:01,220 --> 00:20:06,559
<font color="#CCCCCC">got a tool that we was built in a house</font>

532
00:20:02,990 --> 00:20:08,900
called<font color="#CCCCCC"> the</font><font color="#E5E5E5"> kitty which is more it's more</font>

533
00:20:06,559 --> 00:20:11,629
suited for<font color="#E5E5E5"> use for black box testing and</font>

534
00:20:08,900 --> 00:20:13,280
we just we face all kinds<font color="#CCCCCC"> of entrances</font>

535
00:20:11,630 --> 00:20:15,230
into<font color="#CCCCCC"> Ockham's</font><font color="#E5E5E5"> and interfaces into the</font>

536
00:20:13,280 --> 00:20:17,090
<font color="#CCCCCC">car we start with a</font><font color="#E5E5E5"> network fuzzing both</font>

537
00:20:15,230 --> 00:20:18,049
server and clients that<font color="#E5E5E5"> servers and</font>

538
00:20:17,090 --> 00:20:20,149
clients which<font color="#E5E5E5"> are on the car</font>

539
00:20:18,049 --> 00:20:22,639
we also fuzz the<font color="#E5E5E5"> Bluetooth stacks right</font>

540
00:20:20,150 --> 00:20:24,169
<font color="#E5E5E5">we impersonate a phone and go through</font>

541
00:20:22,640 --> 00:20:26,450
the whole pairing process and dry<font color="#E5E5E5"> find</font>

542
00:20:24,169 --> 00:20:28,309
errors in<font color="#E5E5E5"> their Bluetooth protocols we</font>

543
00:20:26,450 --> 00:20:30,049
<font color="#E5E5E5">go in the USB stack we see if there's</font>

544
00:20:28,309 --> 00:20:32,030
<font color="#E5E5E5">any errors</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> use be passing itself</font>

545
00:20:30,049 --> 00:20:34,730
we have to remember<font color="#E5E5E5"> that these cars are</font>

546
00:20:32,030 --> 00:20:37,549
often<font color="#E5E5E5"> a proprietary code it's not the</font>

547
00:20:34,730 --> 00:20:38,840
same<font color="#CCCCCC"> you know the versions and libraries</font>

548
00:20:37,549 --> 00:20:40,129
which have been around<font color="#E5E5E5"> our homes for few</font>

549
00:20:38,840 --> 00:20:41,389
years<font color="#CCCCCC"> and being testing</font><font color="#E5E5E5"> and debug some</font>

550
00:20:40,130 --> 00:20:42,890
of this stuff is quite<font color="#E5E5E5"> new code so</font>

551
00:20:41,390 --> 00:20:45,710
there's more chances of<font color="#E5E5E5"> find finding</font>

552
00:20:42,890 --> 00:20:47,630
bugs in them we also try media formats

553
00:20:45,710 --> 00:20:49,940
<font color="#E5E5E5">right all the media</font><font color="#CCCCCC"> files and stuff</font><font color="#E5E5E5"> like</font>

554
00:20:47,630 --> 00:20:52,750
that a few<font color="#CCCCCC"> years ago we took over a car</font>

555
00:20:49,940 --> 00:20:55,940
through a Bluetooth<font color="#E5E5E5"> connection just by</font>

556
00:20:52,750 --> 00:20:58,159
<font color="#E5E5E5">giving it a malformed song</font><font color="#CCCCCC"> named him now</font>

557
00:20:55,940 --> 00:21:01,400
one<font color="#E5E5E5"> of the song lists that was enough to</font>

558
00:20:58,159 --> 00:21:02,539
get<font color="#E5E5E5"> in okay another</font><font color="#CCCCCC"> thing we look</font><font color="#E5E5E5"> at</font>

559
00:21:01,400 --> 00:21:04,909
when we try<font color="#E5E5E5"> to connect to the car is</font>

560
00:21:02,539 --> 00:21:08,059
they<font color="#CCCCCC"> put the hardware connections to try</font>

561
00:21:04,909 --> 00:21:09,169
and see<font color="#E5E5E5"> what it's a well what's</font>

562
00:21:08,059 --> 00:21:11,059
happening in the<font color="#E5E5E5"> connection obviously</font>

563
00:21:09,169 --> 00:21:13,370
this picture is<font color="#E5E5E5"> not from a real car</font>

564
00:21:11,059 --> 00:21:16,070
because this is a computer<font color="#CCCCCC"> from ten</font>

565
00:21:13,370 --> 00:21:17,000
<font color="#E5E5E5">years</font><font color="#CCCCCC"> ago at least but that's the</font><font color="#E5E5E5"> idea</font>

566
00:21:16,070 --> 00:21:18,139
where do you find these kind<font color="#CCCCCC"> of</font>

567
00:21:17,000 --> 00:21:20,000
connection from the car<font color="#E5E5E5"> right a car</font>

568
00:21:18,140 --> 00:21:22,309
<font color="#E5E5E5">doesn't expose a whole set of connectors</font>

569
00:21:20,000 --> 00:21:24,350
to connect to well the thing is<font color="#E5E5E5"> you</font>

570
00:21:22,309 --> 00:21:26,178
connect to the back of it<font color="#CCCCCC"> if you if you</font>

571
00:21:24,350 --> 00:21:28,039
wouldn't mind<font color="#E5E5E5"> dismantling your car the</font>

572
00:21:26,179 --> 00:21:29,360
<font color="#CCCCCC">the whole panel behind the shiny</font>

573
00:21:28,039 --> 00:21:30,830
touchscreen<font color="#E5E5E5"> all the buttons you</font><font color="#CCCCCC"> have a</font>

574
00:21:29,360 --> 00:21:32,418
computer<font color="#E5E5E5"> case and inside you have</font><font color="#CCCCCC"> the</font>

575
00:21:30,830 --> 00:21:34,220
motherboard and the motherboard<font color="#CCCCCC"> it's got</font>

576
00:21:32,419 --> 00:21:35,539
all the chips and<font color="#E5E5E5"> the connectors now in</font>

577
00:21:34,220 --> 00:21:38,240
a production<font color="#E5E5E5"> system there's no reason to</font>

578
00:21:35,539 --> 00:21:40,580
<font color="#E5E5E5">have connectors for testing in debug but</font>

579
00:21:38,240 --> 00:21:42,350
often we find test<font color="#E5E5E5"> points left on the</font>

580
00:21:40,580 --> 00:21:45,668
board one of<font color="#E5E5E5"> the things we look for a</font>

581
00:21:42,350 --> 00:21:47,809
JTAG connection<font color="#CCCCCC"> JTAG is the standard for</font>

582
00:21:45,669 --> 00:21:50,360
performing on<font color="#E5E5E5"> chip instrumentation and</font>

583
00:21:47,809 --> 00:21:52,039
testing chips some architectures you get

584
00:21:50,360 --> 00:21:54,620
full debugging capabilities<font color="#CCCCCC"> now</font><font color="#E5E5E5"> I'm a</font>

585
00:21:52,039 --> 00:21:56,360
<font color="#E5E5E5">mips</font><font color="#CCCCCC"> so we look for places like this</font>

586
00:21:54,620 --> 00:21:59,178
with the<font color="#CCCCCC"> 20 connecting</font><font color="#E5E5E5"> point somewhere</font>

587
00:21:56,360 --> 00:22:01,100
on the board try testing them all to

588
00:21:59,179 --> 00:22:02,360
find it's<font color="#CCCCCC"> pretty hard to</font><font color="#E5E5E5"> find which wire</font>

589
00:22:01,100 --> 00:22:03,709
to connect where because it's not

590
00:22:02,360 --> 00:22:05,389
labeled<font color="#E5E5E5"> it's not supposed</font>

591
00:22:03,710 --> 00:22:07,159
<font color="#E5E5E5">be used there</font><font color="#CCCCCC"> are tools like jtagulator</font>

592
00:22:05,390 --> 00:22:09,260
which<font color="#E5E5E5"> sort of brute forces all the</font>

593
00:22:07,159 --> 00:22:10,429
<font color="#E5E5E5">connections sending signals to the wires</font>

594
00:22:09,260 --> 00:22:12,200
trying to find the right ones

595
00:22:10,429 --> 00:22:13,159
if we find<font color="#CCCCCC"> the JTAG connection and we</font>

596
00:22:12,200 --> 00:22:15,110
<font color="#CCCCCC">managed to connect to it with the</font>

597
00:22:13,159 --> 00:22:17,960
debugger<font color="#CCCCCC"> it's game over we're full</font>

598
00:22:15,110 --> 00:22:20,360
control over<font color="#E5E5E5"> the over the chip another</font>

599
00:22:17,960 --> 00:22:22,490
thing we often<font color="#CCCCCC"> look</font><font color="#E5E5E5"> for very often find</font>

600
00:22:20,360 --> 00:22:24,350
<font color="#E5E5E5">our serial console</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> you have a you</font>

601
00:22:22,490 --> 00:22:26,059
<font color="#CCCCCC">are connection</font><font color="#E5E5E5"> to like many other</font>

602
00:22:24,350 --> 00:22:30,289
embedded<font color="#E5E5E5"> devices the you are connection</font>

603
00:22:26,059 --> 00:22:32,178
for development<font color="#E5E5E5"> phase</font><font color="#CCCCCC"> to do stuff</font><font color="#E5E5E5"> you</font>

604
00:22:30,289 --> 00:22:34,460
<font color="#E5E5E5">almost always see something coming out</font>

605
00:22:32,179 --> 00:22:36,200
<font color="#E5E5E5">of the console during</font><font color="#CCCCCC"> the boot up</font><font color="#E5E5E5"> boot</font>

606
00:22:34,460 --> 00:22:37,970
messages<font color="#E5E5E5"> the kernel all kinds</font><font color="#CCCCCC"> of</font>

607
00:22:36,200 --> 00:22:39,950
<font color="#CCCCCC">information which could</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> useful</font><font color="#E5E5E5"> in</font>

608
00:22:37,970 --> 00:22:42,620
this example here which is a you boot

609
00:22:39,950 --> 00:22:44,659
<font color="#CCCCCC">system</font><font color="#E5E5E5"> see the last line here says hit</font>

610
00:22:42,620 --> 00:22:45,979
any key<font color="#CCCCCC"> to stop auto boot which is</font>

611
00:22:44,659 --> 00:22:48,230
<font color="#CCCCCC">something that you</font><font color="#E5E5E5"> would like</font><font color="#CCCCCC"> at</font><font color="#E5E5E5"> your</font>

612
00:22:45,980 --> 00:22:49,340
house<font color="#E5E5E5"> so we had</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> thing connected to</font>

613
00:22:48,230 --> 00:22:52,250
the<font color="#CCCCCC"> Chi you press</font><font color="#E5E5E5"> ENTER on your keyboard</font>

614
00:22:49,340 --> 00:22:53,959
<font color="#E5E5E5">and next thing you</font><font color="#CCCCCC"> know you're</font><font color="#E5E5E5"> in the</font>

615
00:22:52,250 --> 00:22:55,279
<font color="#E5E5E5">new boot menu which is before the kernel</font>

616
00:22:53,960 --> 00:22:57,200
boot and you can control<font color="#E5E5E5"> the whole box</font>

617
00:22:55,279 --> 00:22:59,779
<font color="#E5E5E5">and do whatever you want you</font><font color="#CCCCCC"> have full</font>

618
00:22:57,200 --> 00:23:01,429
access<font color="#E5E5E5"> to the</font><font color="#CCCCCC"> filesystem sometimes its</font>

619
00:22:59,779 --> 00:23:03,169
developers developments are nicer to<font color="#CCCCCC"> us</font>

620
00:23:01,429 --> 00:23:04,580
<font color="#E5E5E5">they actually leave debug logs running</font>

621
00:23:03,169 --> 00:23:05,799
the whole time<font color="#CCCCCC"> so</font><font color="#E5E5E5"> while the</font><font color="#CCCCCC"> Bhatkar is</font>

622
00:23:04,580 --> 00:23:07,908
<font color="#CCCCCC">running you see</font><font color="#E5E5E5"> all kinds</font><font color="#CCCCCC"> of messages</font>

623
00:23:05,799 --> 00:23:10,039
<font color="#E5E5E5">explaining what's happening which is</font>

624
00:23:07,909 --> 00:23:12,919
<font color="#E5E5E5">very helpful for an attacker if they're</font>

625
00:23:10,039 --> 00:23:15,860
even<font color="#E5E5E5"> friendlier to us they leave a</font><font color="#CCCCCC"> login</font>

626
00:23:12,919 --> 00:23:18,649
console on<font color="#E5E5E5"> the on the on the serial</font>

627
00:23:15,860 --> 00:23:21,439
connection<font color="#E5E5E5"> so you get this you know</font>

628
00:23:18,649 --> 00:23:23,110
prompt the username login to connect to

629
00:23:21,440 --> 00:23:25,429
the car<font color="#E5E5E5"> and if we can crack the password</font>

630
00:23:23,110 --> 00:23:27,590
then we're in and we have a<font color="#CCCCCC"> controller</font>

631
00:23:25,429 --> 00:23:29,450
<font color="#CCCCCC">over</font><font color="#E5E5E5"> the car and if they're even</font>

632
00:23:27,590 --> 00:23:31,459
friendlier than that<font color="#E5E5E5"> they just have a</font>

633
00:23:29,450 --> 00:23:32,990
root shell<font color="#CCCCCC"> straightaway you just connect</font>

634
00:23:31,460 --> 00:23:37,929
the<font color="#CCCCCC"> keyboard and you're in full control</font>

635
00:23:32,990 --> 00:23:37,929
these<font color="#E5E5E5"> things are exist in in our cars</font>

636
00:23:38,500 --> 00:23:42,409
<font color="#CCCCCC">another connection point which I</font>

637
00:23:40,820 --> 00:23:43,908
mentioned before<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the can bus right we</font>

638
00:23:42,409 --> 00:23:45,409
connect to<font color="#E5E5E5"> the canvas we have all kinds</font>

639
00:23:43,909 --> 00:23:46,909
of<font color="#CCCCCC"> tools for sniffing we will listen</font><font color="#E5E5E5"> to</font>

640
00:23:45,409 --> 00:23:48,230
<font color="#E5E5E5">the communication we press different</font>

641
00:23:46,909 --> 00:23:51,039
buttons in the car see what goes in the

642
00:23:48,230 --> 00:23:53,360
bus to learn what commands<font color="#E5E5E5"> they use and</font>

643
00:23:51,039 --> 00:23:54,649
on top of<font color="#E5E5E5"> command on top of can there</font>

644
00:23:53,360 --> 00:23:55,729
all<font color="#E5E5E5"> kinds</font><font color="#CCCCCC"> of other protocols can is a</font>

645
00:23:54,649 --> 00:23:57,979
<font color="#CCCCCC">low-level</font><font color="#E5E5E5"> layer there are other</font>

646
00:23:55,730 --> 00:24:01,309
<font color="#CCCCCC">high-level</font><font color="#E5E5E5"> protocols like UDS which is a</font>

647
00:23:57,980 --> 00:24:03,020
universal<font color="#E5E5E5"> diagnostic service that's how</font>

648
00:24:01,309 --> 00:24:04,610
you check the<font color="#E5E5E5"> others diagnostic messages</font>

649
00:24:03,020 --> 00:24:06,408
<font color="#E5E5E5">in your car the different area on values</font>

650
00:24:04,610 --> 00:24:07,760
<font color="#CCCCCC">and</font><font color="#E5E5E5"> stuff but it has all kinds of cool</font>

651
00:24:06,409 --> 00:24:10,130
<font color="#E5E5E5">commands like reading or writing</font>

652
00:24:07,760 --> 00:24:11,990
<font color="#E5E5E5">memory or sometimes you can enter</font>

653
00:24:10,130 --> 00:24:14,360
programming mode<font color="#E5E5E5"> and actually reflash</font>

654
00:24:11,990 --> 00:24:16,370
<font color="#E5E5E5">the</font><font color="#CCCCCC"> whole CPU through the canvas</font><font color="#E5E5E5"> if</font>

655
00:24:14,360 --> 00:24:17,209
these things<font color="#E5E5E5"> are left open</font><font color="#CCCCCC"> it's a big</font>

656
00:24:16,370 --> 00:24:19,520
problem<font color="#E5E5E5"> and</font>

657
00:24:17,210 --> 00:24:20,570
the authentication system they exist

658
00:24:19,520 --> 00:24:22,250
some kind of mechanism but they're not

659
00:24:20,570 --> 00:24:27,590
<font color="#CCCCCC">very secure and they're not done</font>

660
00:24:22,250 --> 00:24:28,910
<font color="#E5E5E5">properly</font><font color="#CCCCCC"> okay so we had a look at the</font>

661
00:24:27,590 --> 00:24:31,280
<font color="#CCCCCC">box who tried to</font><font color="#E5E5E5"> attack it thought that</font>

662
00:24:28,910 --> 00:24:32,330
<font color="#CCCCCC">maybe something crashed but still we</font>

663
00:24:31,280 --> 00:24:33,559
<font color="#CCCCCC">don't know what looks like inside this</font>

664
00:24:32,330 --> 00:24:35,059
<font color="#E5E5E5">is black box we need</font><font color="#CCCCCC"> to get the</font><font color="#E5E5E5"> phone</font>

665
00:24:33,559 --> 00:24:36,980
<font color="#E5E5E5">where to actually understand what's</font>

666
00:24:35,059 --> 00:24:38,540
<font color="#CCCCCC">running inside to see what the</font>

667
00:24:36,980 --> 00:24:40,130
vulnerability<font color="#E5E5E5"> is and see how to attack</font>

668
00:24:38,540 --> 00:24:42,409
it<font color="#E5E5E5"> where do we find the phone world for</font>

669
00:24:40,130 --> 00:24:44,480
the car one place to get<font color="#CCCCCC"> its download</font>

670
00:24:42,410 --> 00:24:46,250
from the<font color="#E5E5E5"> website if you check in</font><font color="#CCCCCC"> your</font>

671
00:24:44,480 --> 00:24:48,500
<font color="#E5E5E5">car's a manufacturer's website you often</font>

672
00:24:46,250 --> 00:24:50,270
see in the customer support page there's

673
00:24:48,500 --> 00:24:52,520
a place<font color="#E5E5E5"> to download updated firmware for</font>

674
00:24:50,270 --> 00:24:54,350
your entertainment system that's one

675
00:24:52,520 --> 00:24:56,300
place to get<font color="#E5E5E5"> the code</font><font color="#CCCCCC"> it could be</font>

676
00:24:54,350 --> 00:24:58,309
<font color="#E5E5E5">encrypted sometimes but often isn't</font>

677
00:24:56,300 --> 00:25:00,320
<font color="#E5E5E5">often designed so it</font><font color="#CCCCCC"> is downloaded</font><font color="#E5E5E5"> and</font>

678
00:24:58,309 --> 00:25:02,780
we can open<font color="#E5E5E5"> up the code and</font><font color="#CCCCCC"> have a look</font>

679
00:25:00,320 --> 00:25:04,340
if it doesn't<font color="#E5E5E5"> exist in a website</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can</font>

680
00:25:02,780 --> 00:25:06,290
be sure it exists in the local<font color="#CCCCCC"> garage</font>

681
00:25:04,340 --> 00:25:07,730
<font color="#E5E5E5">right the the dealership has to update</font>

682
00:25:06,290 --> 00:25:11,030
<font color="#CCCCCC">the software</font><font color="#E5E5E5"> all these cars are</font>

683
00:25:07,730 --> 00:25:13,220
<font color="#E5E5E5">updatable to fix bugs and to revoke</font>

684
00:25:11,030 --> 00:25:14,420
<font color="#E5E5E5">eight certificates and new features and</font>

685
00:25:13,220 --> 00:25:16,010
<font color="#E5E5E5">stuff</font><font color="#CCCCCC"> so you</font><font color="#E5E5E5"> just have to find the right</font>

686
00:25:14,420 --> 00:25:20,300
person<font color="#E5E5E5"> paying a bit and you'll get to</font>

687
00:25:16,010 --> 00:25:21,770
get your your phone where sometimes<font color="#E5E5E5"> if</font>

688
00:25:20,300 --> 00:25:23,120
we can't<font color="#E5E5E5"> find it anywhere else we can't</font>

689
00:25:21,770 --> 00:25:25,580
get its<font color="#CCCCCC"> name to the run or else</font><font color="#E5E5E5"> we</font>

690
00:25:23,120 --> 00:25:28,100
actually lift the physical flash from

691
00:25:25,580 --> 00:25:29,840
<font color="#E5E5E5">the board</font><font color="#CCCCCC"> right a regular</font><font color="#E5E5E5"> PC keeps all</font>

692
00:25:28,100 --> 00:25:31,790
the programs<font color="#CCCCCC"> and code inside a hard disk</font>

693
00:25:29,840 --> 00:25:34,550
in an embedded<font color="#E5E5E5"> system it will be</font><font color="#CCCCCC"> in a</font>

694
00:25:31,790 --> 00:25:36,500
flash memory so we pick<font color="#E5E5E5"> up the flash</font>

695
00:25:34,550 --> 00:25:37,940
<font color="#E5E5E5">memory from the board and we've got</font>

696
00:25:36,500 --> 00:25:39,920
these flash reading machines which reads

697
00:25:37,940 --> 00:25:41,660
out all the<font color="#E5E5E5"> data from the flash this is</font>

698
00:25:39,920 --> 00:25:43,790
especially useful in the<font color="#CCCCCC"> system which</font>

699
00:25:41,660 --> 00:25:45,620
have encrypt encrypted code<font color="#E5E5E5"> sometimes</font>

700
00:25:43,790 --> 00:25:47,899
the the<font color="#E5E5E5"> coded download of the Internet</font>

701
00:25:45,620 --> 00:25:50,300
encrypted<font color="#E5E5E5"> but when it's installed the</font>

702
00:25:47,900 --> 00:25:53,179
often decrypted<font color="#E5E5E5"> during installation so</font>

703
00:25:50,300 --> 00:25:54,409
on the flash it's already clear<font color="#CCCCCC"> so it's</font>

704
00:25:53,179 --> 00:25:55,720
a good place to<font color="#E5E5E5"> find the code the</font>

705
00:25:54,410 --> 00:25:58,010
problem is that it's quite<font color="#E5E5E5"> destructive</font>

706
00:25:55,720 --> 00:25:59,660
<font color="#E5E5E5">very rarely we</font><font color="#CCCCCC"> manage to</font><font color="#E5E5E5"> put the flash</font>

707
00:25:58,010 --> 00:26:02,720
back and get the car<font color="#CCCCCC"> to working and</font><font color="#E5E5E5"> so</font>

708
00:25:59,660 --> 00:26:05,360
we need a few<font color="#E5E5E5"> a few sets before we start</font>

709
00:26:02,720 --> 00:26:07,340
trying<font color="#E5E5E5"> these kind of things another</font>

710
00:26:05,360 --> 00:26:09,139
<font color="#E5E5E5">option that we do sometimes if</font><font color="#CCCCCC"> we if</font>

711
00:26:07,340 --> 00:26:10,399
we're lucky<font color="#E5E5E5"> sometimes we have the serial</font>

712
00:26:09,140 --> 00:26:12,140
console<font color="#E5E5E5"> some kind of access to the</font>

713
00:26:10,400 --> 00:26:13,850
system before<font color="#E5E5E5"> we get the firmware</font><font color="#CCCCCC"> and</font>

714
00:26:12,140 --> 00:26:16,220
then once we're inside<font color="#CCCCCC"> you just</font><font color="#E5E5E5"> found</font>

715
00:26:13,850 --> 00:26:18,559
all that out through USB<font color="#E5E5E5"> or SSH or any</font>

716
00:26:16,220 --> 00:26:20,570
other way that we can<font color="#E5E5E5"> okay so now we've</font>

717
00:26:18,559 --> 00:26:22,100
got our<font color="#CCCCCC"> firmware we have in the hand</font>

718
00:26:20,570 --> 00:26:25,520
we've got to understand<font color="#E5E5E5"> what's inside</font>

719
00:26:22,100 --> 00:26:28,040
<font color="#CCCCCC">it's a big blob of</font><font color="#E5E5E5"> binary data</font><font color="#CCCCCC"> doesn't</font>

720
00:26:25,520 --> 00:26:29,360
<font color="#CCCCCC">make much sense it's</font><font color="#E5E5E5"> not a nice</font><font color="#CCCCCC"> wrapper</font>

721
00:26:28,040 --> 00:26:30,020
<font color="#E5E5E5">to installation package like you would</font>

722
00:26:29,360 --> 00:26:31,790
see on a<font color="#CCCCCC"> computer</font>

723
00:26:30,020 --> 00:26:34,160
we use tools<font color="#CCCCCC"> like bean walk which helps</font>

724
00:26:31,790 --> 00:26:35,840
us analyze the<font color="#E5E5E5"> the</font><font color="#CCCCCC"> blob and tell us</font>

725
00:26:34,160 --> 00:26:37,429
where there are file systems where there

726
00:26:35,840 --> 00:26:39,230
are all kinds of zip files and all kinds

727
00:26:37,429 --> 00:26:44,840
of other formats<font color="#E5E5E5"> we start extracting a</font>

728
00:26:39,230 --> 00:26:47,270
bit by a bit and unpacking them<font color="#CCCCCC"> once we</font>

729
00:26:44,840 --> 00:26:49,669
have an unpacked<font color="#E5E5E5"> we use a favorite</font>

730
00:26:47,270 --> 00:26:51,470
disassembler<font color="#CCCCCC"> ida</font><font color="#E5E5E5"> pro</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> a main</font><font color="#CCCCCC"> the</font>

731
00:26:49,670 --> 00:26:52,960
<font color="#E5E5E5">main</font><font color="#CCCCCC"> tool we work with to</font><font color="#E5E5E5"> actually</font>

732
00:26:51,470 --> 00:26:55,490
reverse engineer<font color="#E5E5E5"> older code and</font>

733
00:26:52,960 --> 00:26:56,809
understand what's<font color="#E5E5E5"> happening inside now</font>

734
00:26:55,490 --> 00:26:58,160
part of<font color="#E5E5E5"> the challenges are there are</font>

735
00:26:56,809 --> 00:27:01,030
<font color="#E5E5E5">many different architectures this is not</font>

736
00:26:58,160 --> 00:27:03,260
just your x86 home<font color="#E5E5E5"> pc or just your</font>

737
00:27:01,030 --> 00:27:07,280
mobile phone we see all<font color="#E5E5E5"> kinds of stuff</font>

738
00:27:03,260 --> 00:27:12,230
we see a mips PowerPC<font color="#E5E5E5"> v8 50 all kinds of</font>

739
00:27:07,280 --> 00:27:13,370
some less common architectures first of

740
00:27:12,230 --> 00:27:14,420
all the first<font color="#E5E5E5"> challenge is actually to</font>

741
00:27:13,370 --> 00:27:16,070
identify what architecture<font color="#E5E5E5"> you're</font>

742
00:27:14,420 --> 00:27:18,080
looking at if you open either<font color="#CCCCCC"> the Roman</font>

743
00:27:16,070 --> 00:27:19,730
architecture<font color="#E5E5E5"> it can't read the code so</font>

744
00:27:18,080 --> 00:27:22,460
it takes us a while sometimes to by

745
00:27:19,730 --> 00:27:24,070
reading<font color="#CCCCCC"> the chip engravings</font><font color="#E5E5E5"> and stuff to</font>

746
00:27:22,460 --> 00:27:27,020
see<font color="#CCCCCC"> what we're actually</font><font color="#E5E5E5"> dealing with and</font>

747
00:27:24,070 --> 00:27:28,639
sometimes unfortunately<font color="#CCCCCC"> Ida doesn't know</font>

748
00:27:27,020 --> 00:27:30,710
of that architecture<font color="#CCCCCC"> recently we had a</font>

749
00:27:28,640 --> 00:27:32,929
thing<font color="#E5E5E5"> cause last year we had a new</font>

750
00:27:30,710 --> 00:27:33,679
version of v8<font color="#E5E5E5"> 50 chip which is a</font>

751
00:27:32,929 --> 00:27:36,280
Renaissance chip

752
00:27:33,679 --> 00:27:38,240
I just didn't<font color="#E5E5E5"> disassemble it properly</font>

753
00:27:36,280 --> 00:27:39,530
<font color="#E5E5E5">and we had to write</font><font color="#CCCCCC"> our own</font><font color="#E5E5E5"> Ida</font>

754
00:27:38,240 --> 00:27:42,110
processor which took us<font color="#E5E5E5"> quite a while to</font>

755
00:27:39,530 --> 00:27:43,490
teach Ida<font color="#CCCCCC"> you know we read the</font>

756
00:27:42,110 --> 00:27:46,040
instruction manual we thought I'd I had

757
00:27:43,490 --> 00:27:48,350
to actually understand the<font color="#E5E5E5"> code needless</font>

758
00:27:46,040 --> 00:27:50,360
to<font color="#E5E5E5"> say that people</font><font color="#CCCCCC"> know either there's</font>

759
00:27:48,350 --> 00:27:52,969
also a<font color="#CCCCCC"> decompiler tool</font><font color="#E5E5E5"> hex</font><font color="#CCCCCC"> race which</font>

760
00:27:50,360 --> 00:27:54,830
it's<font color="#CCCCCC"> very helpful when you're doing x86</font>

761
00:27:52,970 --> 00:27:56,900
<font color="#E5E5E5">or arm it actually compiles the code to</font>

762
00:27:54,830 --> 00:27:58,220
like human readable C<font color="#CCCCCC"> language the many</font>

763
00:27:56,900 --> 00:28:02,150
of these architectures don't have it so

764
00:27:58,220 --> 00:28:03,770
we're stuck<font color="#E5E5E5"> with the disassembly another</font>

765
00:28:02,150 --> 00:28:06,860
one of the<font color="#E5E5E5"> challenges we</font><font color="#CCCCCC"> have is the the</font>

766
00:28:03,770 --> 00:28:09,350
memory layouts<font color="#CCCCCC"> often</font><font color="#E5E5E5"> these binaries are</font>

767
00:28:06,860 --> 00:28:11,629
not organized<font color="#E5E5E5"> in a known format it's not</font>

768
00:28:09,350 --> 00:28:12,889
an elf<font color="#CCCCCC"> or or executable or something</font>

769
00:28:11,630 --> 00:28:15,140
which has a header which explains how

770
00:28:12,890 --> 00:28:16,550
how<font color="#E5E5E5"> would you be opened when it's</font>

771
00:28:15,140 --> 00:28:17,870
running<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I doesn't</font><font color="#E5E5E5"> know how to read</font>

772
00:28:16,550 --> 00:28:19,730
the<font color="#E5E5E5"> code which parts</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> code which</font><font color="#CCCCCC"> are</font>

773
00:28:17,870 --> 00:28:20,989
<font color="#E5E5E5">data</font><font color="#CCCCCC"> how are they aligned so I have</font>

774
00:28:19,730 --> 00:28:23,420
<font color="#E5E5E5">quite a challenge sometimes to get this</font>

775
00:28:20,990 --> 00:28:24,710
blob of<font color="#E5E5E5"> data into something</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> makes</font>

776
00:28:23,420 --> 00:28:26,600
<font color="#E5E5E5">sense we have to start shifting parts</font>

777
00:28:24,710 --> 00:28:27,920
around<font color="#E5E5E5"> we've got</font><font color="#CCCCCC"> all kinds of</font><font color="#E5E5E5"> scripts we</font>

778
00:28:26,600 --> 00:28:29,449
try to<font color="#E5E5E5"> look for cross references</font><font color="#CCCCCC"> between</font>

779
00:28:27,920 --> 00:28:30,950
different commands<font color="#E5E5E5"> looking for strings</font>

780
00:28:29,450 --> 00:28:32,840
finding printer<font color="#CCCCCC"> functions all kinds of</font>

781
00:28:30,950 --> 00:28:34,730
<font color="#E5E5E5">tricks to</font><font color="#CCCCCC"> get it aligned properly in the</font>

782
00:28:32,840 --> 00:28:36,020
memory and<font color="#E5E5E5"> to understand what we're</font>

783
00:28:34,730 --> 00:28:39,520
looking at which is coding which is data

784
00:28:36,020 --> 00:28:39,520
<font color="#E5E5E5">at beginnings just a big mess</font>

785
00:28:40,350 --> 00:28:45,010
sometimes when we when we start<font color="#E5E5E5"> then</font>

786
00:28:43,480 --> 00:28:47,770
<font color="#CCCCCC">forgot</font><font color="#E5E5E5"> to mention these</font><font color="#CCCCCC"> phone which can</font>

787
00:28:45,010 --> 00:28:48,850
<font color="#CCCCCC">be gigabytes of</font><font color="#E5E5E5"> size the the monstrous</font>

788
00:28:47,770 --> 00:28:50,830
and now there's no way you can

789
00:28:48,850 --> 00:28:52,300
disassemble a whole firmware<font color="#E5E5E5"> read</font>

790
00:28:50,830 --> 00:28:53,980
<font color="#E5E5E5">through the</font><font color="#CCCCCC"> whole</font><font color="#E5E5E5"> thing and and</font>

791
00:28:52,300 --> 00:28:55,540
<font color="#E5E5E5">understand all the words we have to</font>

792
00:28:53,980 --> 00:28:57,130
pinpoint<font color="#E5E5E5"> our efforts the places that</font>

793
00:28:55,540 --> 00:28:58,810
<font color="#CCCCCC">interests us how do you know the</font>

794
00:28:57,130 --> 00:29:00,100
<font color="#CCCCCC">interesting parts</font><font color="#E5E5E5"> if there are strings</font>

795
00:28:58,810 --> 00:29:01,510
or other kind of debug symbols that

796
00:29:00,100 --> 00:29:03,429
point us in the right direction<font color="#CCCCCC"> if there</font>

797
00:29:01,510 --> 00:29:05,290
aren't symbols<font color="#E5E5E5"> we look for other kind of</font>

798
00:29:03,430 --> 00:29:06,910
anchors in the<font color="#E5E5E5"> inside the code for</font>

799
00:29:05,290 --> 00:29:08,889
<font color="#E5E5E5">example</font><font color="#CCCCCC"> if you know</font><font color="#E5E5E5"> that the chip has</font><font color="#CCCCCC"> a</font>

800
00:29:06,910 --> 00:29:10,600
<font color="#E5E5E5">flex can interface</font><font color="#CCCCCC"> for talking to the</font>

801
00:29:08,890 --> 00:29:12,130
can and we see the<font color="#CCCCCC"> datasheet that it's</font>

802
00:29:10,600 --> 00:29:13,840
at a certain<font color="#E5E5E5"> address</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> look for that</font>

803
00:29:12,130 --> 00:29:16,000
<font color="#E5E5E5">address that number two or nine zero</font>

804
00:29:13,840 --> 00:29:17,320
zero zero<font color="#E5E5E5"> somewhere in the binary once</font>

805
00:29:16,000 --> 00:29:18,880
we find<font color="#E5E5E5"> that we'll start constructing</font>

806
00:29:17,320 --> 00:29:20,560
our function which is we call<font color="#CCCCCC"> it up no</font>

807
00:29:18,880 --> 00:29:22,840
configure can then<font color="#E5E5E5"> we'll find the other</font>

808
00:29:20,560 --> 00:29:24,100
one which has<font color="#CCCCCC"> the control registered and</font>

809
00:29:22,840 --> 00:29:25,330
we'll call<font color="#CCCCCC"> that function right</font><font color="#E5E5E5"> can</font><font color="#CCCCCC"> and</font>

810
00:29:24,100 --> 00:29:28,300
<font color="#CCCCCC">will</font><font color="#E5E5E5"> start</font><font color="#CCCCCC"> booting</font><font color="#E5E5E5"> up backwards from</font>

811
00:29:25,330 --> 00:29:30,689
those<font color="#E5E5E5"> low-level blocks until we get the</font>

812
00:29:28,300 --> 00:29:32,590
<font color="#E5E5E5">whole</font><font color="#CCCCCC"> area of code which</font><font color="#E5E5E5"> interests us</font>

813
00:29:30,690 --> 00:29:34,240
one thing<font color="#E5E5E5"> which is very</font><font color="#CCCCCC"> helpful</font>

814
00:29:32,590 --> 00:29:38,350
I mentioned before<font color="#E5E5E5"> are strings and debug</font>

815
00:29:34,240 --> 00:29:39,640
symbols in the code<font color="#CCCCCC"> look at</font><font color="#E5E5E5"> this example</font>

816
00:29:38,350 --> 00:29:42,550
function here is some<font color="#E5E5E5"> kind of a</font>

817
00:29:39,640 --> 00:29:44,530
subroutine<font color="#E5E5E5"> receives a number compares it</font>

818
00:29:42,550 --> 00:29:46,629
to a structure and returns a<font color="#CCCCCC"> 0 or</font><font color="#E5E5E5"> a 1</font><font color="#CCCCCC"> we</font>

819
00:29:44,530 --> 00:29:48,879
have no<font color="#E5E5E5"> idea what it</font><font color="#CCCCCC"> does but if the</font>

820
00:29:46,630 --> 00:29:50,170
developer was nice enough to leave<font color="#E5E5E5"> this</font>

821
00:29:48,880 --> 00:29:52,150
<font color="#E5E5E5">kind of string inside which says</font>

822
00:29:50,170 --> 00:29:53,830
software<font color="#E5E5E5"> update version is less advanced</font>

823
00:29:52,150 --> 00:29:59,920
<font color="#E5E5E5">than the version it's obvious what it</font>

824
00:29:53,830 --> 00:30:01,510
does it's very very very<font color="#E5E5E5"> often we still</font>

825
00:29:59,920 --> 00:30:03,850
see strings in the in the code and<font color="#E5E5E5"> the</font>

826
00:30:01,510 --> 00:30:06,010
amount of effort with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> way a string</font>

827
00:30:03,850 --> 00:30:07,240
it son comparable you can take us days

828
00:30:06,010 --> 00:30:08,740
to<font color="#E5E5E5"> understand a piece of code without</font>

829
00:30:07,240 --> 00:30:10,360
<font color="#E5E5E5">strings or minutes if you have the</font>

830
00:30:08,740 --> 00:30:12,310
strings<font color="#E5E5E5"> and even though it's so easy to</font>

831
00:30:10,360 --> 00:30:14,050
<font color="#E5E5E5">take them out and the so important</font>

832
00:30:12,310 --> 00:30:17,139
developers often<font color="#E5E5E5"> still leave them in</font>

833
00:30:14,050 --> 00:30:18,430
production<font color="#E5E5E5"> systems</font><font color="#CCCCCC"> too</font><font color="#E5E5E5"> often other</font>

834
00:30:17,140 --> 00:30:20,440
<font color="#E5E5E5">things that we</font><font color="#CCCCCC"> sign</font><font color="#E5E5E5"> find which</font><font color="#CCCCCC"> will help</font>

835
00:30:18,430 --> 00:30:22,330
help<font color="#E5E5E5"> us when we're attacking a system</font><font color="#CCCCCC"> I</font>

836
00:30:20,440 --> 00:30:24,910
always left over the<font color="#CCCCCC"> bug tools sometimes</font>

837
00:30:22,330 --> 00:30:27,340
<font color="#E5E5E5">they leave debuggers inside like a gdb</font>

838
00:30:24,910 --> 00:30:28,630
server or<font color="#CCCCCC"> Q Conan Q next systems</font><font color="#E5E5E5"> stuff</font>

839
00:30:27,340 --> 00:30:30,639
like<font color="#E5E5E5"> that how these generic tools</font>

840
00:30:28,630 --> 00:30:32,230
<font color="#E5E5E5">sometimes we see proprietary test tools</font>

841
00:30:30,640 --> 00:30:34,030
<font color="#CCCCCC">proprietary tools can help us in</font><font color="#E5E5E5"> all</font>

842
00:30:32,230 --> 00:30:35,320
kinds of way<font color="#E5E5E5"> sometimes they help us</font>

843
00:30:34,030 --> 00:30:37,870
understand the flow<font color="#E5E5E5"> like if there's a</font>

844
00:30:35,320 --> 00:30:40,030
function<font color="#CCCCCC"> in the script that says</font><font color="#E5E5E5"> flash</font>

845
00:30:37,870 --> 00:30:41,530
secondary<font color="#E5E5E5"> CPU and it has all the steps</font>

846
00:30:40,030 --> 00:30:42,879
<font color="#CCCCCC">that helps us understand how it</font><font color="#E5E5E5"> works</font>

847
00:30:41,530 --> 00:30:44,350
<font color="#E5E5E5">sometimes</font><font color="#CCCCCC"> the tools themselves</font>

848
00:30:42,880 --> 00:30:46,180
<font color="#E5E5E5">vulnerable we get in through the tools</font>

849
00:30:44,350 --> 00:30:47,990
<font color="#E5E5E5">all kinds of useful</font><font color="#CCCCCC"> things that we find</font>

850
00:30:46,180 --> 00:30:50,090
there

851
00:30:47,990 --> 00:30:52,610
sometimes<font color="#E5E5E5"> we also find these hidden</font>

852
00:30:50,090 --> 00:30:53,899
<font color="#CCCCCC">backdoors</font><font color="#E5E5E5"> that the engineers left inside</font>

853
00:30:52,610 --> 00:30:56,510
all<font color="#E5E5E5"> kinds of menus press these buttons</font>

854
00:30:53,900 --> 00:30:58,040
do this so if you<font color="#E5E5E5"> have a certain</font><font color="#CCCCCC"> final</font>

855
00:30:56,510 --> 00:30:59,360
name<font color="#E5E5E5"> on the on the USB key like if it's</font>

856
00:30:58,040 --> 00:31:01,280
a media<font color="#E5E5E5"> file the place if it's a</font><font color="#CCCCCC"> pin</font>

857
00:30:59,360 --> 00:31:03,080
file installs the firmware<font color="#E5E5E5"> but if it's a</font>

858
00:31:01,280 --> 00:31:04,430
certain<font color="#CCCCCC"> directory with a special name</font>

859
00:31:03,080 --> 00:31:07,280
and SH at the end or<font color="#E5E5E5"> run a shell script</font>

860
00:31:04,430 --> 00:31:09,050
directly<font color="#E5E5E5"> gets a</font><font color="#CCCCCC"> stratum some reason</font>

861
00:31:07,280 --> 00:31:13,100
people think<font color="#E5E5E5"> that</font><font color="#CCCCCC"> they this</font><font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of</font>

862
00:31:09,050 --> 00:31:14,060
<font color="#CCCCCC">secretin can't be seen</font><font color="#E5E5E5"> but obviously are</font>

863
00:31:13,100 --> 00:31:15,620
not experienced enough<font color="#CCCCCC"> in reverse</font>

864
00:31:14,060 --> 00:31:19,780
<font color="#E5E5E5">engineering because one</font><font color="#CCCCCC"> of the first</font>

865
00:31:15,620 --> 00:31:22,909
things you see<font color="#E5E5E5"> okay so let's say</font>

866
00:31:19,780 --> 00:31:24,620
<font color="#CCCCCC">attacker</font><font color="#E5E5E5"> managed to attack a process in</font>

867
00:31:22,910 --> 00:31:26,360
<font color="#CCCCCC">the in the car and got</font><font color="#E5E5E5"> in and took over</font>

868
00:31:24,620 --> 00:31:27,889
a<font color="#E5E5E5"> process which</font><font color="#CCCCCC"> was say interface in the</font>

869
00:31:26,360 --> 00:31:29,840
web and<font color="#E5E5E5"> now he's controlling the process</font>

870
00:31:27,890 --> 00:31:31,760
<font color="#E5E5E5">what kind of damage can he do in the car</font>

871
00:31:29,840 --> 00:31:33,439
<font color="#CCCCCC">that</font><font color="#E5E5E5"> depends</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> everything</font><font color="#CCCCCC"> runs</font><font color="#E5E5E5"> as route</font>

872
00:31:31,760 --> 00:31:34,520
as often happens in<font color="#E5E5E5"> embedded</font><font color="#CCCCCC"> systems</font>

873
00:31:33,440 --> 00:31:38,060
because it's much<font color="#CCCCCC"> easier</font><font color="#E5E5E5"> to configure</font>

874
00:31:34,520 --> 00:31:41,030
then you have full<font color="#E5E5E5"> control over the over</font>

875
00:31:38,060 --> 00:31:42,050
the<font color="#E5E5E5"> whole processor but when when not</font>

876
00:31:41,030 --> 00:31:43,610
everything runs<font color="#CCCCCC"> this</font><font color="#E5E5E5"> route when I do</font>

877
00:31:42,050 --> 00:31:45,110
have<font color="#CCCCCC"> a separate proper separation for</font>

878
00:31:43,610 --> 00:31:46,850
users where do we<font color="#E5E5E5"> look to get the</font>

879
00:31:45,110 --> 00:31:50,120
<font color="#CCCCCC">privilege escalation one good place to</font>

880
00:31:46,850 --> 00:31:52,129
look boot up scripts when the<font color="#CCCCCC"> Box</font><font color="#E5E5E5"> boots</font>

881
00:31:50,120 --> 00:31:54,050
<font color="#CCCCCC">or the et Cie</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> his script</font><font color="#E5E5E5"> and stuff</font>

882
00:31:52,130 --> 00:31:55,700
<font color="#E5E5E5">like that they run his route so we look</font>

883
00:31:54,050 --> 00:31:57,020
for<font color="#CCCCCC"> errors in</font><font color="#E5E5E5"> those scripts as I said</font>

884
00:31:55,700 --> 00:31:58,460
before a lot<font color="#CCCCCC"> of the code in the cars is</font>

885
00:31:57,020 --> 00:31:59,960
not<font color="#CCCCCC"> a standard code they have</font><font color="#E5E5E5"> already</font>

886
00:31:58,460 --> 00:32:01,730
<font color="#E5E5E5">prepared a script</font><font color="#CCCCCC"> that they added and</font>

887
00:31:59,960 --> 00:32:03,460
then are always<font color="#E5E5E5"> careful enough for</font>

888
00:32:01,730 --> 00:32:05,630
example this<font color="#E5E5E5"> script to be found once</font>

889
00:32:03,460 --> 00:32:06,680
there was a user called<font color="#E5E5E5"> browser who was</font>

890
00:32:05,630 --> 00:32:09,350
in<font color="#CCCCCC"> charge of</font><font color="#E5E5E5"> browsing the internet and</font>

891
00:32:06,680 --> 00:32:11,840
he had a lower<font color="#E5E5E5"> privilege and they had a</font>

892
00:32:09,350 --> 00:32:14,449
command<font color="#CCCCCC"> to do</font><font color="#E5E5E5"> John -</font><font color="#CCCCCC"> are on his home</font>

893
00:32:11,840 --> 00:32:15,590
directory<font color="#E5E5E5"> or every boot up we don't know</font>

894
00:32:14,450 --> 00:32:17,180
why they had this code<font color="#E5E5E5"> there for every</font>

895
00:32:15,590 --> 00:32:18,379
boot up we think was a mistake<font color="#CCCCCC"> it was</font>

896
00:32:17,180 --> 00:32:20,030
<font color="#E5E5E5">probably something that you would do one</font>

897
00:32:18,380 --> 00:32:22,220
time when preparing<font color="#E5E5E5"> the</font><font color="#CCCCCC"> filesystem but</font>

898
00:32:20,030 --> 00:32:23,930
it was there<font color="#CCCCCC"> to ask ourself is with</font>

899
00:32:22,220 --> 00:32:24,980
<font color="#E5E5E5">besides being wasteful if there's any</font>

900
00:32:23,930 --> 00:32:26,630
damage<font color="#CCCCCC"> that can be done through</font><font color="#E5E5E5"> the</font>

901
00:32:24,980 --> 00:32:29,630
<font color="#E5E5E5">script and the answer is yes because</font>

902
00:32:26,630 --> 00:32:31,430
John - our<font color="#CCCCCC"> follows soft links</font><font color="#E5E5E5"> symlinks</font>

903
00:32:29,630 --> 00:32:32,990
<font color="#E5E5E5">out of the out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the directory see if</font>

904
00:32:31,430 --> 00:32:34,250
you can get a file<font color="#E5E5E5"> pointing from your</font>

905
00:32:32,990 --> 00:32:35,360
home directory<font color="#CCCCCC"> out to a system file</font>

906
00:32:34,250 --> 00:32:37,460
somewhere<font color="#E5E5E5"> it will change the ownership</font>

907
00:32:35,360 --> 00:32:39,949
to<font color="#CCCCCC"> be the lower the ownership of the</font>

908
00:32:37,460 --> 00:32:41,240
browser user which<font color="#E5E5E5"> exactly what we did</font>

909
00:32:39,950 --> 00:32:43,460
we<font color="#CCCCCC"> took over the browser process</font><font color="#E5E5E5"> we</font>

910
00:32:41,240 --> 00:32:46,280
<font color="#CCCCCC">created a soft link to another</font><font color="#E5E5E5"> directory</font>

911
00:32:43,460 --> 00:32:47,930
<font color="#E5E5E5">outside and the next reboot</font><font color="#CCCCCC"> we had the</font>

912
00:32:46,280 --> 00:32:50,110
<font color="#E5E5E5">control of</font><font color="#CCCCCC"> other files</font><font color="#E5E5E5"> in the system and</font>

913
00:32:47,930 --> 00:32:52,610
we<font color="#E5E5E5"> started from there</font>

914
00:32:50,110 --> 00:32:54,379
other place to look for<font color="#CCCCCC"> a</font><font color="#E5E5E5"> privilege</font>

915
00:32:52,610 --> 00:32:56,360
escalation are all kinds of IPC daemons

916
00:32:54,380 --> 00:32:57,560
there are lots of processes usually

917
00:32:56,360 --> 00:32:59,360
<font color="#E5E5E5">running in these</font><font color="#CCCCCC"> systems and they</font>

918
00:32:57,560 --> 00:33:00,310
communicate between themselves with

919
00:32:59,360 --> 00:33:02,290
inter-process

920
00:33:00,310 --> 00:33:04,000
<font color="#E5E5E5">either some</font><font color="#CCCCCC"> kind of proprietary system</font>

921
00:33:02,290 --> 00:33:05,710
<font color="#CCCCCC">where they have some sockets they say</font>

922
00:33:04,000 --> 00:33:09,010
messages to each<font color="#E5E5E5"> other or standard</font>

923
00:33:05,710 --> 00:33:10,840
systems like<font color="#CCCCCC"> d-bus if you can send a</font>

924
00:33:09,010 --> 00:33:12,190
message<font color="#CCCCCC"> from a low privileged process to</font>

925
00:33:10,840 --> 00:33:14,800
a high<font color="#E5E5E5"> privilege processing make it</font>

926
00:33:12,190 --> 00:33:17,680
perform the the<font color="#CCCCCC"> command</font><font color="#E5E5E5"> then you're</font>

927
00:33:14,800 --> 00:33:19,659
<font color="#CCCCCC">actually adding your</font><font color="#E5E5E5"> you're dumping your</font>

928
00:33:17,680 --> 00:33:21,030
<font color="#E5E5E5">privilege but if you find an error in</font>

929
00:33:19,660 --> 00:33:23,500
the<font color="#E5E5E5"> passing event even better could you</font>

930
00:33:21,030 --> 00:33:25,270
take control<font color="#E5E5E5"> over the process this</font>

931
00:33:23,500 --> 00:33:29,050
<font color="#CCCCCC">example</font><font color="#E5E5E5"> here it's from Charlie</font><font color="#CCCCCC"> Miller's</font>

932
00:33:25,270 --> 00:33:30,639
<font color="#CCCCCC">a report and from back in</font><font color="#E5E5E5"> August it said</font>

933
00:33:29,050 --> 00:33:32,320
the bus can<font color="#E5E5E5"> require authentication on</font>

934
00:33:30,640 --> 00:33:33,580
the<font color="#CCCCCC"> jeep</font><font color="#E5E5E5"> head unit the authentication is</font>

935
00:33:32,320 --> 00:33:35,110
<font color="#E5E5E5">open to our anonymous action as shown</font>

936
00:33:33,580 --> 00:33:36,610
below<font color="#CCCCCC"> and you see Oh someone tell</font>

937
00:33:35,110 --> 00:33:38,469
anything<font color="#E5E5E5"> from outside</font><font color="#CCCCCC"> our open port on</font>

938
00:33:36,610 --> 00:33:42,399
<font color="#E5E5E5">the bus</font><font color="#CCCCCC"> I sent messages to all the</font>

939
00:33:38,470 --> 00:33:43,360
processes on this<font color="#E5E5E5"> system now you mean</font>

940
00:33:42,400 --> 00:33:44,760
you'd probably<font color="#E5E5E5"> had to believe it</font>

941
00:33:43,360 --> 00:33:47,620
<font color="#E5E5E5">Leeson's actually existing cars today</font>

942
00:33:44,760 --> 00:33:49,300
<font color="#E5E5E5">it's so easy to</font><font color="#CCCCCC"> take a control</font><font color="#E5E5E5"> of a car</font>

943
00:33:47,620 --> 00:33:51,280
<font color="#E5E5E5">but you can just ask the guy who was in</font>

944
00:33:49,300 --> 00:33:58,149
the<font color="#CCCCCC"> Jeepers got pushed off</font><font color="#E5E5E5"> the road</font>

945
00:33:51,280 --> 00:34:00,580
<font color="#CCCCCC">these things to exist another</font><font color="#E5E5E5"> place we</font>

946
00:33:58,150 --> 00:34:02,140
look for<font color="#E5E5E5"> is a firmware update right</font>

947
00:34:00,580 --> 00:34:03,730
<font color="#E5E5E5">dissimilar to startup scripts firmware</font>

948
00:34:02,140 --> 00:34:05,320
updates<font color="#CCCCCC"> runners route because you have</font>

949
00:34:03,730 --> 00:34:08,199
to mount stuff and install stuff<font color="#E5E5E5"> on all</font>

950
00:34:05,320 --> 00:34:10,480
kinds of heavy<font color="#CCCCCC"> things so</font><font color="#E5E5E5"> far up there is</font>

951
00:34:08,199 --> 00:34:13,949
a good good place together<font color="#E5E5E5"> to get a</font>

952
00:34:10,480 --> 00:34:13,949
foothold as an attacker into the system

953
00:34:14,460 --> 00:34:18,190
for the phone<font color="#E5E5E5"> where it surface we said</font>

954
00:34:16,690 --> 00:34:20,050
it usually<font color="#E5E5E5"> comes from usb or some other</font>

955
00:34:18,190 --> 00:34:20,460
source could be encrypted<font color="#E5E5E5"> could be</font>

956
00:34:20,050 --> 00:34:22,480
<font color="#CCCCCC">signed</font>

957
00:34:20,460 --> 00:34:23,800
<font color="#CCCCCC">even if it's signed there's some kind of</font>

958
00:34:22,480 --> 00:34:25,570
<font color="#E5E5E5">manifest like a table of contents</font>

959
00:34:23,800 --> 00:34:27,130
<font color="#E5E5E5">explaining what we what</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> we have</font>

960
00:34:25,570 --> 00:34:29,080
inside the bundle<font color="#E5E5E5"> usually there's like a</font>

961
00:34:27,130 --> 00:34:30,310
list of files and<font color="#CCCCCC"> and the hashes and</font>

962
00:34:29,080 --> 00:34:31,779
then there'll be a signature file full

963
00:34:30,310 --> 00:34:33,779
of all the<font color="#E5E5E5"> signatures and cryptographic</font>

964
00:34:31,780 --> 00:34:37,120
signatures of all<font color="#E5E5E5"> the files but</font>

965
00:34:33,780 --> 00:34:38,890
sometimes in<font color="#E5E5E5"> the path in this example</font>

966
00:34:37,120 --> 00:34:40,600
here the the signature<font color="#E5E5E5"> file itself is</font>

967
00:34:38,889 --> 00:34:42,339
listed inside the manifest file<font color="#E5E5E5"> so it's</font>

968
00:34:40,600 --> 00:34:43,960
not<font color="#E5E5E5"> a fixed name the name is here so</font>

969
00:34:42,340 --> 00:34:45,700
<font color="#E5E5E5">obviously the manifest file itself can't</font>

970
00:34:43,960 --> 00:34:47,679
be signed<font color="#E5E5E5"> which means we can play with</font>

971
00:34:45,699 --> 00:34:50,168
the manifest file and all kinds of bugs

972
00:34:47,679 --> 00:34:54,520
<font color="#CCCCCC">and stuff</font><font color="#E5E5E5"> in the</font><font color="#CCCCCC"> past manifest files are</font>

973
00:34:50,168 --> 00:34:56,649
often<font color="#E5E5E5"> used by us to get inside another</font>

974
00:34:54,520 --> 00:34:58,960
<font color="#E5E5E5">thing which we see too often</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> user of</font>

975
00:34:56,649 --> 00:35:00,609
the system<font color="#E5E5E5"> function command</font><font color="#CCCCCC"> the system</font>

976
00:34:58,960 --> 00:35:02,710
function<font color="#E5E5E5"> command takes a string of</font>

977
00:35:00,610 --> 00:35:04,840
passed it to a shell<font color="#E5E5E5"> it's a perfect</font>

978
00:35:02,710 --> 00:35:06,910
place<font color="#CCCCCC"> to</font><font color="#E5E5E5"> get the shell code insertion</font>

979
00:35:04,840 --> 00:35:08,320
into the box like<font color="#E5E5E5"> in these kind of</font>

980
00:35:06,910 --> 00:35:10,480
functions<font color="#CCCCCC"> which install stuff on the</font>

981
00:35:08,320 --> 00:35:11,830
from the USB<font color="#CCCCCC"> it takes a name straight</font>

982
00:35:10,480 --> 00:35:12,640
for the manifest file runs the shell

983
00:35:11,830 --> 00:35:13,870
command on<font color="#E5E5E5"> it</font>

984
00:35:12,640 --> 00:35:16,870
if you put a<font color="#E5E5E5"> semicolon and some other</font>

985
00:35:13,870 --> 00:35:18,250
command<font color="#E5E5E5"> you're inside the box other more</font>

986
00:35:16,870 --> 00:35:21,040
complicated<font color="#E5E5E5"> stuff that we do sometimes</font>

987
00:35:18,250 --> 00:35:23,470
<font color="#CCCCCC">our talk to your tax time of check</font><font color="#E5E5E5"> time</font>

988
00:35:21,040 --> 00:35:25,540
<font color="#E5E5E5">of use time of check time of use is when</font>

989
00:35:23,470 --> 00:35:27,700
something is done in a non atomic manner

990
00:35:25,540 --> 00:35:29,620
<font color="#E5E5E5">like reading</font><font color="#CCCCCC"> a file from the USB</font><font color="#E5E5E5"> that</font>

991
00:35:27,700 --> 00:35:31,120
read at one time<font color="#E5E5E5"> check the signature</font><font color="#CCCCCC"> if</font>

992
00:35:29,620 --> 00:35:33,250
it's<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> the reader begin</font><font color="#E5E5E5"> and install</font>

993
00:35:31,120 --> 00:35:35,650
now if you can get in between<font color="#E5E5E5"> those two</font>

994
00:35:33,250 --> 00:35:37,510
reads and swap the file to something

995
00:35:35,650 --> 00:35:38,650
else<font color="#E5E5E5"> you can trick the box into</font>

996
00:35:37,510 --> 00:35:41,020
installing<font color="#E5E5E5"> something which is not signed</font>

997
00:35:38,650 --> 00:35:43,540
<font color="#CCCCCC">but</font><font color="#E5E5E5"> you exactly what we do we have a</font>

998
00:35:41,020 --> 00:35:45,460
<font color="#CCCCCC">setup</font><font color="#E5E5E5"> using an</font><font color="#CCCCCC"> MX 5</font><font color="#E5E5E5"> bar which has a USB</font>

999
00:35:43,540 --> 00:35:46,810
stack on it<font color="#E5E5E5"> and it gets an image file</font>

1000
00:35:45,460 --> 00:35:50,920
which is actually the file system on the

1001
00:35:46,810 --> 00:35:52,900
<font color="#CCCCCC">USB and we actually</font><font color="#E5E5E5"> switch the images</font>

1002
00:35:50,920 --> 00:35:55,180
<font color="#CCCCCC">between the two reads</font><font color="#E5E5E5"> in cases like this</font>

1003
00:35:52,900 --> 00:35:56,890
<font color="#E5E5E5">sometimes you have to have precise</font>

1004
00:35:55,180 --> 00:36:01,240
timing sometimes it's easier it depends

1005
00:35:56,890 --> 00:36:03,190
on the system obviously<font color="#E5E5E5"> secure boot if</font>

1006
00:36:01,240 --> 00:36:05,470
if the bootloader would actually check

1007
00:36:03,190 --> 00:36:06,700
the<font color="#E5E5E5"> signature of the whole image every</font>

1008
00:36:05,470 --> 00:36:09,580
time<font color="#CCCCCC"> there</font><font color="#E5E5E5"> boots up</font><font color="#CCCCCC"> to make sure no</font>

1009
00:36:06,700 --> 00:36:12,009
one's touched it<font color="#E5E5E5"> that's a good help in</font>

1010
00:36:09,580 --> 00:36:14,080
<font color="#CCCCCC">making our system</font><font color="#E5E5E5"> safer this does exist</font>

1011
00:36:12,010 --> 00:36:15,700
sometimes<font color="#CCCCCC"> but not</font><font color="#E5E5E5"> enough and actually</font>

1012
00:36:14,080 --> 00:36:17,140
<font color="#CCCCCC">recently</font><font color="#E5E5E5"> with some one of our team</font>

1013
00:36:15,700 --> 00:36:19,419
members found a bug in<font color="#CCCCCC"> the secure boot</font>

1014
00:36:17,140 --> 00:36:22,299
mechanism and took over the<font color="#CCCCCC"> box even</font>

1015
00:36:19,420 --> 00:36:24,640
<font color="#E5E5E5">though it had a secure boot inside</font><font color="#CCCCCC"> ok go</font>

1016
00:36:22,300 --> 00:36:26,320
past this stage let's see our attackers

1017
00:36:24,640 --> 00:36:28,629
inside he's got<font color="#CCCCCC"> route privilege on the</font>

1018
00:36:26,320 --> 00:36:30,730
<font color="#E5E5E5">on the main processor he's controlling</font>

1019
00:36:28,630 --> 00:36:31,900
all the processes<font color="#CCCCCC"> can he send the</font><font color="#E5E5E5"> carry</font>

1020
00:36:30,730 --> 00:36:34,390
messages<font color="#E5E5E5"> in the car can he do bad stuff</font>

1021
00:36:31,900 --> 00:36:35,920
<font color="#CCCCCC">well that depends if the application CPU</font>

1022
00:36:34,390 --> 00:36:37,930
is connected to the<font color="#E5E5E5"> can bus then yes</font>

1023
00:36:35,920 --> 00:36:40,000
<font color="#E5E5E5">once you're inside in your route you can</font>

1024
00:36:37,930 --> 00:36:42,910
just send using the driver straight on

1025
00:36:40,000 --> 00:36:44,650
the<font color="#E5E5E5"> canvas</font><font color="#CCCCCC"> a better design</font><font color="#E5E5E5"> would</font><font color="#CCCCCC"> be</font>

1026
00:36:42,910 --> 00:36:46,690
<font color="#E5E5E5">something like this</font><font color="#CCCCCC"> we separate it to 2</font>

1027
00:36:44,650 --> 00:36:48,550
<font color="#E5E5E5">separate processors it's something we</font>

1028
00:36:46,690 --> 00:36:49,930
often<font color="#E5E5E5"> see the one processor in charge of</font>

1029
00:36:48,550 --> 00:36:51,940
the entertainment<font color="#E5E5E5"> connects the internet</font>

1030
00:36:49,930 --> 00:36:54,460
and showing all the movies<font color="#CCCCCC"> and stuff</font><font color="#E5E5E5"> and</font>

1031
00:36:51,940 --> 00:36:55,870
that's like the less secure<font color="#E5E5E5"> processor</font>

1032
00:36:54,460 --> 00:36:57,970
and there's a totally separate<font color="#CCCCCC"> possessor</font>

1033
00:36:55,870 --> 00:36:59,259
<font color="#E5E5E5">who's in charge of talking to the canvas</font>

1034
00:36:57,970 --> 00:37:02,169
<font color="#E5E5E5">and all the other critical systems on</font>

1035
00:36:59,260 --> 00:37:03,550
the car<font color="#E5E5E5"> this way if you take over one if</font>

1036
00:37:02,170 --> 00:37:06,490
you<font color="#CCCCCC"> compromised one processor the other</font>

1037
00:37:03,550 --> 00:37:08,350
one<font color="#E5E5E5"> still stays safe but you still have</font>

1038
00:37:06,490 --> 00:37:09,549
to send<font color="#CCCCCC"> information form processor to</font>

1039
00:37:08,350 --> 00:37:10,630
the<font color="#E5E5E5"> other because the main processor</font>

1040
00:37:09,550 --> 00:37:12,610
wants<font color="#CCCCCC"> to read I don't know your current</font>

1041
00:37:10,630 --> 00:37:13,060
<font color="#E5E5E5">speed or get your location</font><font color="#CCCCCC"> and stuff</font>

1042
00:37:12,610 --> 00:37:15,010
like that

1043
00:37:13,060 --> 00:37:16,779
<font color="#E5E5E5">so you how you define a set of</font><font color="#CCCCCC"> messages</font>

1044
00:37:15,010 --> 00:37:18,160
<font color="#E5E5E5">going between the processors a fixed set</font>

1045
00:37:16,780 --> 00:37:21,430
of<font color="#E5E5E5"> messages</font><font color="#CCCCCC"> like a</font><font color="#E5E5E5"> enum you know message</font>

1046
00:37:18,160 --> 00:37:22,750
<font color="#CCCCCC">1 2 3 4 5</font><font color="#E5E5E5"> only safe messages that's all</font>

1047
00:37:21,430 --> 00:37:23,940
the goes across<font color="#E5E5E5"> on the wire between the</font>

1048
00:37:22,750 --> 00:37:26,849
two<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font>

1049
00:37:23,940 --> 00:37:28,740
kind of<font color="#E5E5E5"> a safe</font><font color="#CCCCCC"> set up but something to</font>

1050
00:37:26,849 --> 00:37:29,940
remember<font color="#E5E5E5"> is that if you have two</font>

1051
00:37:28,740 --> 00:37:32,339
<font color="#CCCCCC">processors with some kind of</font><font color="#E5E5E5"> remote</font>

1052
00:37:29,940 --> 00:37:34,589
procedure call<font color="#E5E5E5"> in between</font><font color="#CCCCCC"> them that adds</font>

1053
00:37:32,339 --> 00:37:36,509
another<font color="#E5E5E5"> attack surface for us to get in</font>

1054
00:37:34,589 --> 00:37:38,759
between<font color="#E5E5E5"> to attack the processor which is</font>

1055
00:37:36,510 --> 00:37:40,740
performing the IPC often these<font color="#CCCCCC"> are</font>

1056
00:37:38,760 --> 00:37:42,390
proprietary<font color="#E5E5E5"> systems proprietary code</font>

1057
00:37:40,740 --> 00:37:45,118
writing<font color="#E5E5E5"> the RPC between the two</font>

1058
00:37:42,390 --> 00:37:47,220
<font color="#CCCCCC">processors and this example</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> there</font>

1059
00:37:45,119 --> 00:37:49,980
was a project<font color="#E5E5E5"> when we had a arm CPU a</font>

1060
00:37:47,220 --> 00:37:52,589
<font color="#CCCCCC">dual core</font><font color="#E5E5E5"> on one side the</font><font color="#CCCCCC"> applications</font>

1061
00:37:49,980 --> 00:37:54,539
<font color="#CCCCCC">he</font><font color="#E5E5E5"> was running was running Linux for the</font>

1062
00:37:52,589 --> 00:37:56,520
media the other side was running some

1063
00:37:54,539 --> 00:37:59,099
kind of a<font color="#CCCCCC"> real-time system with</font><font color="#E5E5E5"> T engine</font>

1064
00:37:56,520 --> 00:38:01,020
<font color="#CCCCCC">or something</font><font color="#E5E5E5"> and they defined the shared</font>

1065
00:37:59,099 --> 00:38:02,579
memory<font color="#E5E5E5"> to get</font><font color="#CCCCCC"> messages from side to side</font>

1066
00:38:01,020 --> 00:38:05,880
<font color="#E5E5E5">and in order to use the shared memory</font>

1067
00:38:02,579 --> 00:38:07,319
they wrote a kernel model which give<font color="#CCCCCC"> us</font>

1068
00:38:05,880 --> 00:38:09,690
some<font color="#E5E5E5"> kind</font><font color="#CCCCCC"> of cue</font><font color="#E5E5E5"> it's gonna kind of a</font>

1069
00:38:07,319 --> 00:38:11,130
<font color="#CCCCCC">cue node</font><font color="#E5E5E5"> you put it in the queue that's</font>

1070
00:38:09,690 --> 00:38:13,140
<font color="#E5E5E5">how to read the message</font><font color="#CCCCCC"> send the</font><font color="#E5E5E5"> ki</font>

1071
00:38:11,130 --> 00:38:16,710
message etc but<font color="#E5E5E5"> a bug that</font><font color="#CCCCCC"> we found</font>

1072
00:38:13,140 --> 00:38:18,868
inside<font color="#E5E5E5"> the implementation of this driver</font>

1073
00:38:16,710 --> 00:38:21,900
<font color="#CCCCCC">act</font><font color="#E5E5E5"> actually allowed us</font><font color="#CCCCCC"> to gain kernel</font>

1074
00:38:18,869 --> 00:38:23,760
privileges on the<font color="#CCCCCC"> main CPU that was from</font>

1075
00:38:21,900 --> 00:38:27,619
a regular user so it gave us<font color="#E5E5E5"> quite a</font>

1076
00:38:23,760 --> 00:38:30,450
boost that<font color="#E5E5E5"> mistake they</font><font color="#CCCCCC"> had in the RPC</font>

1077
00:38:27,619 --> 00:38:33,480
<font color="#CCCCCC">okay now got to reach the</font><font color="#E5E5E5"> maybe more</font>

1078
00:38:30,450 --> 00:38:35,788
interesting<font color="#E5E5E5"> part</font><font color="#CCCCCC"> now we'll</font><font color="#E5E5E5"> take you</font>

1079
00:38:33,480 --> 00:38:40,140
<font color="#CCCCCC">through a project from beginning</font><font color="#E5E5E5"> to end</font>

1080
00:38:35,789 --> 00:38:41,640
<font color="#CCCCCC">to see what it looks</font><font color="#E5E5E5"> like this project</font>

1081
00:38:40,140 --> 00:38:44,098
<font color="#CCCCCC">that we</font><font color="#E5E5E5"> received this was a design that</font>

1082
00:38:41,640 --> 00:38:45,660
we saw those infotainment unit<font color="#CCCCCC"> I didn't</font>

1083
00:38:44,099 --> 00:38:47,099
mention it earlier but we mainly look at

1084
00:38:45,660 --> 00:38:48,390
the infotainment<font color="#E5E5E5"> in units because they</font>

1085
00:38:47,099 --> 00:38:49,650
are the ones that have most connectivity

1086
00:38:48,390 --> 00:38:52,230
to the<font color="#CCCCCC"> Internet and</font><font color="#E5E5E5"> to the other stuff</font>

1087
00:38:49,650 --> 00:38:55,559
<font color="#E5E5E5">it had the application CPU inside it was</font>

1088
00:38:52,230 --> 00:38:56,940
sitting on the can bus and<font color="#E5E5E5"> infotainment</font>

1089
00:38:55,559 --> 00:38:58,980
unit<font color="#E5E5E5"> would connect straight to the</font>

1090
00:38:56,940 --> 00:39:01,799
<font color="#E5E5E5">Internet</font><font color="#CCCCCC"> to the convent</font><font color="#E5E5E5"> of the servers</font>

1091
00:38:58,980 --> 00:39:04,079
<font color="#E5E5E5">in</font><font color="#CCCCCC"> order</font><font color="#E5E5E5"> to download media</font><font color="#CCCCCC"> and all kinds</font>

1092
00:39:01,799 --> 00:39:06,119
<font color="#E5E5E5">of applications and stuff now all the</font>

1093
00:39:04,079 --> 00:39:09,210
communication was done<font color="#E5E5E5"> securely and</font>

1094
00:39:06,119 --> 00:39:11,220
<font color="#E5E5E5">properly with SSL anything which had</font>

1095
00:39:09,210 --> 00:39:12,329
<font color="#E5E5E5">uses</font><font color="#CCCCCC"> passwords or important information</font>

1096
00:39:11,220 --> 00:39:14,459
was done secure

1097
00:39:12,329 --> 00:39:16,230
besides the media files themselves<font color="#CCCCCC"> which</font>

1098
00:39:14,460 --> 00:39:17,789
came<font color="#E5E5E5"> from all kinds of other CD endless</font>

1099
00:39:16,230 --> 00:39:20,630
stuff<font color="#CCCCCC"> that were passed in</font><font color="#E5E5E5"> the clear</font>

1100
00:39:17,789 --> 00:39:24,119
because no need to encrypt a music file

1101
00:39:20,630 --> 00:39:26,490
but<font color="#E5E5E5"> we notice that besides the</font><font color="#CCCCCC"> music</font>

1102
00:39:24,119 --> 00:39:28,470
<font color="#E5E5E5">files being downloaded those also a</font>

1103
00:39:26,490 --> 00:39:29,788
terms and conditions page<font color="#CCCCCC"> just a text</font>

1104
00:39:28,470 --> 00:39:30,990
<font color="#E5E5E5">page there's annoying ones that pop up</font>

1105
00:39:29,789 --> 00:39:32,880
at the<font color="#CCCCCC"> beginning when</font><font color="#E5E5E5"> you install an</font>

1106
00:39:30,990 --> 00:39:34,319
application<font color="#E5E5E5"> says you know do you agree</font>

1107
00:39:32,880 --> 00:39:35,789
to<font color="#E5E5E5"> all the stuff and</font><font color="#CCCCCC"> you scroll</font><font color="#E5E5E5"> Scroll</font>

1108
00:39:34,319 --> 00:39:36,880
scroll<font color="#E5E5E5"> and you say yes</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> whatever it</font>

1109
00:39:35,789 --> 00:39:39,910
says

1110
00:39:36,880 --> 00:39:40,960
some kind of radio application<font color="#CCCCCC"> that was</font>

1111
00:39:39,910 --> 00:39:45,519
another<font color="#E5E5E5"> one</font><font color="#CCCCCC"> in the pages that was</font>

1112
00:39:40,960 --> 00:39:47,470
downloaded via HTTP and<font color="#E5E5E5"> not HTTP okay so</font>

1113
00:39:45,519 --> 00:39:49,379
we look<font color="#E5E5E5"> at the system who observe it</font>

1114
00:39:47,470 --> 00:39:51,578
<font color="#E5E5E5">from all sides see what we can find</font>

1115
00:39:49,380 --> 00:39:53,019
<font color="#E5E5E5">first thing we notice</font><font color="#CCCCCC"> from the design is</font>

1116
00:39:51,579 --> 00:39:54,700
<font color="#E5E5E5">that the application CPU has full access</font>

1117
00:39:53,019 --> 00:39:58,319
to the<font color="#E5E5E5"> campus</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> I mentioned before</font>

1118
00:39:54,700 --> 00:40:01,058
<font color="#CCCCCC">which is</font><font color="#E5E5E5"> a not to not to secure design</font>

1119
00:39:58,319 --> 00:40:03,190
<font color="#CCCCCC">the second thing was that</font><font color="#E5E5E5"> the firm</font><font color="#CCCCCC"> one</font>

1120
00:40:01,059 --> 00:40:04,420
was<font color="#E5E5E5"> available on the web</font><font color="#CCCCCC"> so as we said</font>

1121
00:40:03,190 --> 00:40:07,569
<font color="#E5E5E5">before we download the firmware and</font>

1122
00:40:04,420 --> 00:40:08,829
started<font color="#CCCCCC"> a reverse</font><font color="#E5E5E5"> engineering it another</font>

1123
00:40:07,569 --> 00:40:11,499
thing<font color="#E5E5E5"> which was very</font><font color="#CCCCCC"> helpful we had the</font>

1124
00:40:08,829 --> 00:40:14,170
shell calls on console UART with a<font color="#E5E5E5"> login</font>

1125
00:40:11,499 --> 00:40:17,410
<font color="#E5E5E5">shell we didn't have the credentials but</font>

1126
00:40:14,170 --> 00:40:18,519
we had the the shell itself and in which

1127
00:40:17,410 --> 00:40:20,529
I mentioned<font color="#E5E5E5"> before is that</font><font color="#CCCCCC"> there was</font><font color="#E5E5E5"> a</font>

1128
00:40:18,519 --> 00:40:22,328
web<font color="#E5E5E5"> page which was downloaded of HTTP</font>

1129
00:40:20,529 --> 00:40:24,630
<font color="#E5E5E5">that one page that we identified in the</font>

1130
00:40:22,329 --> 00:40:24,630
whole system

1131
00:40:24,989 --> 00:40:28,660
<font color="#CCCCCC">looking at</font><font color="#E5E5E5"> reverse engineering the code</font>

1132
00:40:27,249 --> 00:40:31,359
and looking at all the components<font color="#CCCCCC"> we</font>

1133
00:40:28,660 --> 00:40:33,489
noticed that the WebKit library was an

1134
00:40:31,359 --> 00:40:35,380
old<font color="#CCCCCC"> version</font><font color="#E5E5E5"> now this often happens in</font>

1135
00:40:33,489 --> 00:40:36,789
<font color="#CCCCCC">embedded systems</font><font color="#E5E5E5"> that the software</font>

1136
00:40:35,380 --> 00:40:38,950
<font color="#E5E5E5">components aren't updated as frequently</font>

1137
00:40:36,789 --> 00:40:41,410
<font color="#E5E5E5">as we would like them to</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> it's much</font>

1138
00:40:38,950 --> 00:40:43,538
<font color="#E5E5E5">harder to send out an</font><font color="#CCCCCC"> update to a car</font>

1139
00:40:41,410 --> 00:40:44,589
some<font color="#CCCCCC"> we have</font><font color="#E5E5E5"> to wait for the next</font><font color="#CCCCCC"> time</font>

1140
00:40:43,539 --> 00:40:46,690
<font color="#E5E5E5">goes to service and it could be</font>

1141
00:40:44,589 --> 00:40:49,058
expensive<font color="#E5E5E5"> don't know don't update don't</font>

1142
00:40:46,690 --> 00:40:52,239
update the systems as frequently as<font color="#E5E5E5"> you</font>

1143
00:40:49,059 --> 00:40:53,619
would in your home computer<font color="#CCCCCC"> and one</font><font color="#E5E5E5"> of</font>

1144
00:40:52,239 --> 00:40:54,880
the things we look<font color="#CCCCCC"> for our known</font>

1145
00:40:53,619 --> 00:40:57,849
vulnerabilities we look in the<font color="#E5E5E5"> CV</font>

1146
00:40:54,880 --> 00:41:01,119
databases to see if there's anything<font color="#E5E5E5"> in</font>

1147
00:40:57,849 --> 00:41:02,890
<font color="#E5E5E5">which we can attack this</font><font color="#CCCCCC"> library so we</font>

1148
00:41:01,119 --> 00:41:04,839
<font color="#E5E5E5">saw</font><font color="#CCCCCC"> this and another thing we saw was</font>

1149
00:41:02,890 --> 00:41:06,339
<font color="#CCCCCC">that there were</font><font color="#E5E5E5"> some tools still</font>

1150
00:41:04,839 --> 00:41:07,960
installed in the system<font color="#CCCCCC"> that was cuke</font><font color="#E5E5E5"> on</font>

1151
00:41:06,339 --> 00:41:10,119
which this is a<font color="#CCCCCC"> qnx system which is</font>

1152
00:41:07,960 --> 00:41:11,739
similar<font color="#CCCCCC"> to linux but</font><font color="#E5E5E5"> not exactly it's a</font>

1153
00:41:10,119 --> 00:41:14,499
bit more complicated because not all the

1154
00:41:11,739 --> 00:41:16,269
<font color="#E5E5E5">standard tools work</font><font color="#CCCCCC"> but they do have a Q</font>

1155
00:41:14,499 --> 00:41:18,939
Khan<font color="#E5E5E5"> debugger installed and they had FTP</font>

1156
00:41:16,269 --> 00:41:20,499
and other useful useful utilities

1157
00:41:18,940 --> 00:41:21,880
already inside<font color="#CCCCCC"> the system which saved us</font>

1158
00:41:20,499 --> 00:41:25,209
<font color="#E5E5E5">compiling them and putting them inside</font>

1159
00:41:21,880 --> 00:41:29,289
<font color="#CCCCCC">so with all this we</font><font color="#E5E5E5"> started planning our</font>

1160
00:41:25,210 --> 00:41:31,809
attack first<font color="#CCCCCC"> thing we did</font><font color="#E5E5E5"> was as soon as</font>

1161
00:41:29,289 --> 00:41:34,329
we got the the firmware a firmware<font color="#E5E5E5"> image</font>

1162
00:41:31,809 --> 00:41:35,859
we took out the shadow with the<font color="#E5E5E5"> password</font>

1163
00:41:34,329 --> 00:41:37,930
a shadow files and started cracking<font color="#E5E5E5"> the</font>

1164
00:41:35,859 --> 00:41:39,640
password the root password using John

1165
00:41:37,930 --> 00:41:41,019
the Ripper<font color="#CCCCCC"> one of the</font><font color="#E5E5E5"> tools</font><font color="#CCCCCC"> in fact</font>

1166
00:41:39,640 --> 00:41:42,129
password<font color="#CCCCCC"> which takes quite a while</font><font color="#E5E5E5"> in</font>

1167
00:41:41,019 --> 00:41:43,660
this<font color="#E5E5E5"> case</font><font color="#CCCCCC"> I think</font><font color="#E5E5E5"> it took</font><font color="#CCCCCC"> about two</font>

1168
00:41:42,130 --> 00:41:45,579
weeks<font color="#CCCCCC"> of working we</font><font color="#E5E5E5"> computers working</font>

1169
00:41:43,660 --> 00:41:46,839
but we had enough to do<font color="#E5E5E5"> in the</font><font color="#CCCCCC"> mean time</font>

1170
00:41:45,579 --> 00:41:48,900
so we don't care just<font color="#E5E5E5"> let the computer</font>

1171
00:41:46,839 --> 00:41:52,529
work in the<font color="#E5E5E5"> background and we</font>

1172
00:41:48,900 --> 00:41:56,069
<font color="#E5E5E5">with</font><font color="#CCCCCC"> our reverse engineering</font><font color="#E5E5E5"> in that</font>

1173
00:41:52,529 --> 00:41:59,069
<font color="#CCCCCC">WebKit</font><font color="#E5E5E5"> version that we identified we saw</font>

1174
00:41:56,069 --> 00:42:02,279
that there was a there<font color="#CCCCCC"> was a</font><font color="#E5E5E5"> JavaScript</font>

1175
00:41:59,069 --> 00:42:04,619
<font color="#E5E5E5">use after free vulnerability it's a kind</font>

1176
00:42:02,279 --> 00:42:05,789
of<font color="#CCCCCC"> vulnerability which you can if you</font>

1177
00:42:04,619 --> 00:42:07,019
allocate<font color="#E5E5E5"> a certain kind of structure</font>

1178
00:42:05,789 --> 00:42:08,160
then afterward you<font color="#CCCCCC"> Delocated</font><font color="#E5E5E5"> then you</font>

1179
00:42:07,019 --> 00:42:10,879
allocate<font color="#CCCCCC"> another structure in the same</font>

1180
00:42:08,160 --> 00:42:12,899
slot<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can get</font><font color="#E5E5E5"> control</font><font color="#CCCCCC"> and using</font><font color="#E5E5E5"> that</font>

1181
00:42:10,880 --> 00:42:14,940
that<font color="#E5E5E5"> vulnerability you can actually</font>

1182
00:42:12,900 --> 00:42:18,359
<font color="#E5E5E5">access we can get</font><font color="#CCCCCC"> read/write control</font>

1183
00:42:14,940 --> 00:42:21,119
anywhere<font color="#E5E5E5"> in the memory space this is</font>

1184
00:42:18,359 --> 00:42:22,740
really<font color="#E5E5E5"> cool it's really</font><font color="#CCCCCC"> cool</font><font color="#E5E5E5"> a bug to do</font>

1185
00:42:21,119 --> 00:42:24,269
a really cool vulnerability to attack

1186
00:42:22,740 --> 00:42:26,848
but it's quite complicated<font color="#E5E5E5"> to get this</font>

1187
00:42:24,269 --> 00:42:28,078
to<font color="#CCCCCC"> work because</font><font color="#E5E5E5"> it's heap memory in the</font>

1188
00:42:26,849 --> 00:42:29,759
memory region some<font color="#E5E5E5"> of</font><font color="#CCCCCC"> them are</font><font color="#E5E5E5"> not</font>

1189
00:42:28,079 --> 00:42:33,059
executable and<font color="#CCCCCC"> unrideable</font><font color="#E5E5E5"> it wasn't easy</font>

1190
00:42:29,759 --> 00:42:34,920
to<font color="#E5E5E5"> know exactly what addresses to to to</font>

1191
00:42:33,059 --> 00:42:37,140
write on how to help<font color="#E5E5E5"> do this correctly</font>

1192
00:42:34,920 --> 00:42:38,819
<font color="#E5E5E5">but lucky for us we had the</font><font color="#CCCCCC"> cue cone</font>

1193
00:42:37,140 --> 00:42:40,788
inside<font color="#E5E5E5"> the debugger and we had a full</font>

1194
00:42:38,819 --> 00:42:42,808
debugging suite actually<font color="#CCCCCC"> qnx give you a</font>

1195
00:42:40,789 --> 00:42:45,269
client tool<font color="#E5E5E5"> also which is got</font><font color="#CCCCCC"> this</font>

1196
00:42:42,809 --> 00:42:46,410
graphical user interface that<font color="#CCCCCC"> we checked</font>

1197
00:42:45,269 --> 00:42:47,848
<font color="#E5E5E5">all the memory regions we found</font><font color="#CCCCCC"> the</font>

1198
00:42:46,410 --> 00:42:51,058
place which is writable<font color="#CCCCCC"> and we chose</font>

1199
00:42:47,849 --> 00:42:53,910
<font color="#E5E5E5">exactly where</font><font color="#CCCCCC"> to write our shellcode</font>

1200
00:42:51,059 --> 00:42:54,390
attack<font color="#E5E5E5"> I will use this actually to write</font>

1201
00:42:53,910 --> 00:42:56,788
<font color="#E5E5E5">a shellcode</font>

1202
00:42:54,390 --> 00:42:59,190
inside the box<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is what the</font>

1203
00:42:56,789 --> 00:43:00,749
attack looks<font color="#E5E5E5"> like see in the</font><font color="#CCCCCC"> system we</font>

1204
00:42:59,190 --> 00:43:02,339
have the application<font color="#CCCCCC"> CPU inside is</font><font color="#E5E5E5"> our</font>

1205
00:43:00,749 --> 00:43:05,339
attack vector that's<font color="#CCCCCC"> the JavaScript</font>

1206
00:43:02,339 --> 00:43:08,220
engine<font color="#CCCCCC"> inside WebKit and there's the car</font>

1207
00:43:05,339 --> 00:43:10,529
vendors<font color="#CCCCCC"> website and there's our server</font>

1208
00:43:08,220 --> 00:43:13,348
instead now the car<font color="#CCCCCC"> once wants</font><font color="#E5E5E5"> to</font>

1209
00:43:10,529 --> 00:43:16,950
connect to to their server but the<font color="#E5E5E5"> same</font>

1210
00:43:13,349 --> 00:43:18,690
thing that<font color="#E5E5E5"> it's HTTP not</font><font color="#CCCCCC"> HTTP we were</font>

1211
00:43:16,950 --> 00:43:20,339
able<font color="#E5E5E5"> to intercept the communication</font><font color="#CCCCCC"> in</font>

1212
00:43:18,690 --> 00:43:24,599
the middle and direct it to a server

1213
00:43:20,339 --> 00:43:26,430
instead once we got<font color="#E5E5E5"> to a server we</font>

1214
00:43:24,599 --> 00:43:28,289
downloaded our page<font color="#E5E5E5"> with the terms and</font>

1215
00:43:26,430 --> 00:43:31,259
conditions<font color="#E5E5E5"> and had a little iframe with</font>

1216
00:43:28,289 --> 00:43:35,130
our JavaScript inside<font color="#E5E5E5"> our JavaScript ran</font>

1217
00:43:31,259 --> 00:43:37,259
the code<font color="#E5E5E5"> inside and from that it jumped</font>

1218
00:43:35,130 --> 00:43:39,930
out and it wrote<font color="#E5E5E5"> a</font><font color="#CCCCCC"> shell code</font><font color="#E5E5E5"> and took</font>

1219
00:43:37,259 --> 00:43:41,279
over<font color="#CCCCCC"> the whole application CPU now the</font>

1220
00:43:39,930 --> 00:43:44,609
first thing we did once we were in<font color="#E5E5E5"> the</font>

1221
00:43:41,279 --> 00:43:46,380
application CPU is we used the<font color="#CCCCCC"> FTP</font>

1222
00:43:44,609 --> 00:43:49,078
client which was<font color="#E5E5E5"> there downloading more</font>

1223
00:43:46,380 --> 00:43:52,319
scripts<font color="#E5E5E5"> and more tools of our own and</font><font color="#CCCCCC"> we</font>

1224
00:43:49,079 --> 00:43:54,119
set us up like<font color="#CCCCCC"> a persistent</font><font color="#E5E5E5"> system which</font>

1225
00:43:52,319 --> 00:43:55,829
<font color="#E5E5E5">would connect to</font><font color="#CCCCCC"> a server all the time</font>

1226
00:43:54,119 --> 00:43:57,269
<font color="#E5E5E5">appalling the server asking for commands</font>

1227
00:43:55,829 --> 00:43:58,420
<font color="#E5E5E5">we had the command and control center</font>

1228
00:43:57,269 --> 00:44:01,149
like a nice

1229
00:43:58,420 --> 00:44:03,760
web GUI<font color="#E5E5E5"> I think we called it yes we can</font>

1230
00:44:01,150 --> 00:44:06,670
<font color="#CCCCCC">and</font><font color="#E5E5E5"> you can just go to that website and</font>

1231
00:44:03,760 --> 00:44:08,319
type in your commands<font color="#CCCCCC"> and</font><font color="#E5E5E5"> those client</font>

1232
00:44:06,670 --> 00:44:10,660
commands will go<font color="#E5E5E5"> straight down the</font>

1233
00:44:08,319 --> 00:44:12,339
internet into<font color="#CCCCCC"> your canvas</font><font color="#E5E5E5"> of the car now</font>

1234
00:44:10,660 --> 00:44:13,839
the nice thing<font color="#CCCCCC"> is that all</font><font color="#E5E5E5"> the cars of</font>

1235
00:44:12,339 --> 00:44:15,308
<font color="#CCCCCC">this manufacturer all the tens of</font>

1236
00:44:13,839 --> 00:44:17,200
thousands<font color="#CCCCCC"> of cars or</font><font color="#E5E5E5"> whatever they were</font>

1237
00:44:15,309 --> 00:44:19,240
all<font color="#E5E5E5"> connected to the same</font><font color="#CCCCCC"> terms</font><font color="#E5E5E5"> and</font>

1238
00:44:17,200 --> 00:44:20,890
conditions<font color="#CCCCCC"> page</font><font color="#E5E5E5"> so if we manage to take</font>

1239
00:44:19,240 --> 00:44:22,390
control of the original server of<font color="#E5E5E5"> the</font>

1240
00:44:20,890 --> 00:44:24,640
terms and conditions and inject<font color="#E5E5E5"> that</font>

1241
00:44:22,390 --> 00:44:26,890
JavaScript over there<font color="#E5E5E5"> would have control</font>

1242
00:44:24,640 --> 00:44:29,440
<font color="#CCCCCC">over</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> the cars driving around</font><font color="#E5E5E5"> the</font>

1243
00:44:26,890 --> 00:44:31,299
world at the<font color="#E5E5E5"> same time so we went back</font>

1244
00:44:29,440 --> 00:44:34,210
<font color="#CCCCCC">to the</font><font color="#E5E5E5"> client with our findings it got a</font>

1245
00:44:31,299 --> 00:44:35,349
<font color="#E5E5E5">bit of a fright</font><font color="#CCCCCC"> after</font><font color="#E5E5E5"> this don't worry</font>

1246
00:44:34,210 --> 00:44:38,829
this is quite a while<font color="#E5E5E5"> back it's been</font>

1247
00:44:35,349 --> 00:44:41,440
<font color="#CCCCCC">fixed since</font><font color="#E5E5E5"> then and they gave back the</font>

1248
00:44:38,829 --> 00:44:43,599
security<font color="#E5E5E5"> architect to redesign and lucky</font>

1249
00:44:41,440 --> 00:44:46,480
<font color="#CCCCCC">enough they said it's not</font><font color="#E5E5E5"> enough just</font><font color="#CCCCCC"> to</font>

1250
00:44:43,599 --> 00:44:48,369
patch the that WebKit version we want a

1251
00:44:46,480 --> 00:44:49,990
proper design<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> assume</font><font color="#CCCCCC"> that</font>

1252
00:44:48,369 --> 00:44:51,579
the application CPU will always be

1253
00:44:49,990 --> 00:44:52,808
compromised<font color="#E5E5E5"> which is a good assumption</font>

1254
00:44:51,579 --> 00:44:55,270
because<font color="#E5E5E5"> there are many processes</font><font color="#CCCCCC"> running</font>

1255
00:44:52,809 --> 00:44:57,000
<font color="#E5E5E5">many websites and stuff someone's gonna</font>

1256
00:44:55,270 --> 00:44:59,530
attack<font color="#E5E5E5"> one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the processes</font><font color="#CCCCCC"> on the way</font>

1257
00:44:57,000 --> 00:45:01,599
so<font color="#E5E5E5"> what they did</font><font color="#CCCCCC"> is they</font><font color="#E5E5E5"> introduced the</font>

1258
00:44:59,530 --> 00:45:05,859
secondary vehicle CPU<font color="#E5E5E5"> we mentioned</font>

1259
00:45:01,599 --> 00:45:07,089
before<font color="#E5E5E5"> this was a v8 50 chip it was</font><font color="#CCCCCC"> a</font>

1260
00:45:05,859 --> 00:45:08,828
totally<font color="#CCCCCC"> new design they had the</font>

1261
00:45:07,089 --> 00:45:11,380
application CPU and<font color="#E5E5E5"> the secondary CPU</font>

1262
00:45:08,829 --> 00:45:12,700
though connected<font color="#E5E5E5"> over a spy</font><font color="#CCCCCC"> bus so we've</font>

1263
00:45:11,380 --> 00:45:13,930
got the system<font color="#E5E5E5"> again and</font><font color="#CCCCCC"> we said you</font>

1264
00:45:12,700 --> 00:45:16,089
know<font color="#E5E5E5"> this time we're stumped we can't</font>

1265
00:45:13,930 --> 00:45:16,390
can't get the cameras just what can we

1266
00:45:16,089 --> 00:45:18,880
do

1267
00:45:16,390 --> 00:45:19,868
<font color="#CCCCCC">looked at it again we notice for the</font>

1268
00:45:18,880 --> 00:45:21,339
follows we noticed that the

1269
00:45:19,869 --> 00:45:23,290
communication goes over spy

1270
00:45:21,339 --> 00:45:25,359
we noticed that<font color="#E5E5E5"> only predefined</font>

1271
00:45:23,290 --> 00:45:26,890
chemistry's can be sent we even<font color="#E5E5E5"> reverse</font>

1272
00:45:25,359 --> 00:45:29,980
engineer the v8<font color="#E5E5E5"> 50 and so there's a</font>

1273
00:45:26,890 --> 00:45:31,089
switch case with the fixed<font color="#CCCCCC"> number of</font>

1274
00:45:29,980 --> 00:45:33,760
<font color="#E5E5E5">messages that</font><font color="#CCCCCC"> he would accept</font><font color="#E5E5E5"> him that</font>

1275
00:45:31,089 --> 00:45:35,410
was it<font color="#E5E5E5"> nothing else</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> sold all the</font>

1276
00:45:33,760 --> 00:45:37,510
firmware<font color="#E5E5E5"> is signed</font><font color="#CCCCCC"> we can't just</font><font color="#E5E5E5"> change</font>

1277
00:45:35,410 --> 00:45:38,770
the<font color="#CCCCCC"> firmware</font><font color="#E5E5E5"> and you know override that</font>

1278
00:45:37,510 --> 00:45:42,609
function with on the<font color="#E5E5E5"> other camp can't</font>

1279
00:45:38,770 --> 00:45:46,599
patch it<font color="#E5E5E5"> but 210 points</font><font color="#CCCCCC"> that we did find</font>

1280
00:45:42,609 --> 00:45:48,279
one that the new<font color="#CCCCCC"> vehicle CPU firmware is</font>

1281
00:45:46,599 --> 00:45:51,190
written<font color="#CCCCCC"> over the spy by the</font><font color="#E5E5E5"> application</font>

1282
00:45:48,280 --> 00:45:52,240
CPU right there those are all the phone

1283
00:45:51,190 --> 00:45:53,589
were<font color="#E5E5E5"> came in through the USB the</font>

1284
00:45:52,240 --> 00:45:55,808
application CPU would read the firmware

1285
00:45:53,589 --> 00:45:57,369
inside pass it some of<font color="#E5E5E5"> it</font><font color="#CCCCCC"> would install</font>

1286
00:45:55,809 --> 00:45:59,230
in its own<font color="#CCCCCC"> CPU and</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> pad would send</font>

1287
00:45:57,369 --> 00:46:02,890
over<font color="#E5E5E5"> the</font><font color="#CCCCCC"> spy to the vehicle CPU to</font>

1288
00:45:59,230 --> 00:46:05,200
install<font color="#E5E5E5"> in the vehicle CPUs memory and</font>

1289
00:46:02,890 --> 00:46:06,368
the<font color="#E5E5E5"> most</font><font color="#CCCCCC"> interesting point was that the</font>

1290
00:46:05,200 --> 00:46:07,960
signature<font color="#CCCCCC"> was verified in</font><font color="#E5E5E5"> the</font>

1291
00:46:06,369 --> 00:46:10,119
application CPU<font color="#E5E5E5"> and not in the vehicle</font>

1292
00:46:07,960 --> 00:46:11,619
CPU right so the applications if you

1293
00:46:10,119 --> 00:46:12,150
would check the<font color="#CCCCCC"> very the signature</font><font color="#E5E5E5"> one</font>

1294
00:46:11,619 --> 00:46:14,670
<font color="#E5E5E5">begin</font>

1295
00:46:12,150 --> 00:46:19,380
say it's safe<font color="#E5E5E5"> and then install</font><font color="#CCCCCC"> it in the</font>

1296
00:46:14,670 --> 00:46:20,549
<font color="#E5E5E5">vehicles</font><font color="#CCCCCC"> EPO</font><font color="#E5E5E5"> what does this enable us if</font>

1297
00:46:19,380 --> 00:46:22,079
we take what happened<font color="#CCCCCC"> if we</font><font color="#E5E5E5"> take control</font>

1298
00:46:20,549 --> 00:46:23,730
<font color="#E5E5E5">over the application CPU like before</font>

1299
00:46:22,079 --> 00:46:25,470
<font color="#CCCCCC">right we can</font><font color="#E5E5E5"> just ignore this is</font>

1300
00:46:23,730 --> 00:46:26,940
signature checks for the vehicle CPU and

1301
00:46:25,470 --> 00:46:29,098
<font color="#E5E5E5">stand it across and the vehicle CPU</font>

1302
00:46:26,940 --> 00:46:32,539
wouldn't<font color="#E5E5E5"> check it again which is exactly</font>

1303
00:46:29,099 --> 00:46:35,160
what we did setup is<font color="#CCCCCC"> similar as before</font>

1304
00:46:32,539 --> 00:46:37,950
the they try to connect<font color="#E5E5E5"> to the server</font>

1305
00:46:35,160 --> 00:46:40,520
and reach our<font color="#CCCCCC"> servers this</font><font color="#E5E5E5"> time we start</font>

1306
00:46:37,950 --> 00:46:42,629
off by downloading our JavaScript

1307
00:46:40,520 --> 00:46:44,579
<font color="#CCCCCC">payload and taking over that location</font>

1308
00:46:42,630 --> 00:46:46,890
CPU<font color="#E5E5E5"> just as</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> but</font><font color="#CCCCCC"> here is another</font>

1309
00:46:44,579 --> 00:46:50,240
<font color="#E5E5E5">stage what we did was we took the</font>

1310
00:46:46,890 --> 00:46:52,950
vehicle CPU<font color="#E5E5E5"> for the original firmware we</font>

1311
00:46:50,240 --> 00:46:54,479
understood we after reverse engineering

1312
00:46:52,950 --> 00:46:56,038
we understood where to patch the

1313
00:46:54,480 --> 00:46:57,569
firmware<font color="#E5E5E5"> and we actually patched the</font>

1314
00:46:56,039 --> 00:47:00,420
function which did the<font color="#E5E5E5"> switch case to</font>

1315
00:46:57,569 --> 00:47:02,490
unable to receive any<font color="#E5E5E5"> can message and</font>

1316
00:47:00,420 --> 00:47:04,470
seeing that no one checked the signature

1317
00:47:02,490 --> 00:47:06,569
no one actually noticed that the binary

1318
00:47:04,470 --> 00:47:08,730
<font color="#E5E5E5">has changed</font><font color="#CCCCCC"> so this stage using FTP we</font>

1319
00:47:06,569 --> 00:47:11,069
have to downloaded a whole<font color="#E5E5E5"> firmware</font>

1320
00:47:08,730 --> 00:47:13,920
image for the second CPU it took a

1321
00:47:11,069 --> 00:47:14,069
<font color="#E5E5E5">couple</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> minutes but it was worth</font><font color="#CCCCCC"> the</font>

1322
00:47:13,920 --> 00:47:18,180
wait

1323
00:47:14,069 --> 00:47:19,319
<font color="#E5E5E5">and then</font><font color="#CCCCCC"> imitating the SPI commands we</font>

1324
00:47:18,180 --> 00:47:21,299
actually I<font color="#E5E5E5"> think was</font><font color="#CCCCCC"> also</font><font color="#E5E5E5"> using one of</font>

1325
00:47:19,319 --> 00:47:22,980
<font color="#E5E5E5">their tools they had a tool which which</font>

1326
00:47:21,299 --> 00:47:24,660
did the flashing<font color="#CCCCCC"> itself though</font><font color="#E5E5E5"> some kind</font>

1327
00:47:22,980 --> 00:47:26,460
of script so<font color="#CCCCCC"> it was quite easy to</font>

1328
00:47:24,660 --> 00:47:29,160
understand the protocol over the<font color="#E5E5E5"> SPI to</font>

1329
00:47:26,460 --> 00:47:30,900
send send the firmware across we didn't

1330
00:47:29,160 --> 00:47:33,509
have to sniff the hardware<font color="#CCCCCC"> just looked</font>

1331
00:47:30,900 --> 00:47:35,039
at the<font color="#E5E5E5"> software and using the same using</font>

1332
00:47:33,510 --> 00:47:37,529
<font color="#E5E5E5">their</font><font color="#CCCCCC"> own tools we actually reflashed</font>

1333
00:47:35,039 --> 00:47:40,589
<font color="#E5E5E5">the vehicle CPU from the application CPU</font>

1334
00:47:37,529 --> 00:47:42,599
and from here the<font color="#E5E5E5"> continue is exactly</font>

1335
00:47:40,589 --> 00:47:44,970
the<font color="#E5E5E5"> same as before</font><font color="#CCCCCC"> again we send</font><font color="#E5E5E5"> the cam</font>

1336
00:47:42,599 --> 00:47:46,859
messages<font color="#E5E5E5"> this attack was actually shown</font>

1337
00:47:44,970 --> 00:47:50,819
as<font color="#E5E5E5"> a demo to the some of the managers in</font>

1338
00:47:46,859 --> 00:47:52,288
<font color="#E5E5E5">that camera company quite impressed at</font>

1339
00:47:50,819 --> 00:47:54,660
the time and I think<font color="#CCCCCC"> it</font><font color="#E5E5E5"> gave a big boost</font>

1340
00:47:52,289 --> 00:47:58,440
to their<font color="#E5E5E5"> efforts in improving the</font>

1341
00:47:54,660 --> 00:48:00,868
security<font color="#E5E5E5"> of their systems okay so let's</font>

1342
00:47:58,440 --> 00:48:03,960
just wrap it<font color="#E5E5E5"> up and conclude what</font><font color="#CCCCCC"> we saw</font>

1343
00:48:00,869 --> 00:48:05,910
the first<font color="#E5E5E5"> thing is</font><font color="#CCCCCC"> that today's cars</font>

1344
00:48:03,960 --> 00:48:08,160
<font color="#E5E5E5">contain computers if you remember it's a</font>

1345
00:48:05,910 --> 00:48:09,569
system full of computers another thing

1346
00:48:08,160 --> 00:48:11,160
to notice is that tomorrow's cars are

1347
00:48:09,569 --> 00:48:13,440
<font color="#E5E5E5">gonna contain more computers now with</font>

1348
00:48:11,160 --> 00:48:15,270
all the automatic<font color="#CCCCCC"> Parking all these</font><font color="#E5E5E5"> soon</font>

1349
00:48:13,440 --> 00:48:16,890
<font color="#E5E5E5">you have cars driving themselves they</font>

1350
00:48:15,270 --> 00:48:18,390
even lived in the past<font color="#CCCCCC"> only some of the</font>

1351
00:48:16,890 --> 00:48:19,950
system will<font color="#E5E5E5"> computerized now everything</font>

1352
00:48:18,390 --> 00:48:23,339
is<font color="#E5E5E5"> going to be computerized steering at</font>

1353
00:48:19,950 --> 00:48:25,140
all<font color="#CCCCCC"> of course</font><font color="#E5E5E5"> we should</font><font color="#CCCCCC"> remember</font><font color="#E5E5E5"> that</font>

1354
00:48:23,339 --> 00:48:28,740
hacking cars is a dangerous how

1355
00:48:25,140 --> 00:48:30,299
and one of<font color="#E5E5E5"> the important takeaways</font><font color="#CCCCCC"> and</font>

1356
00:48:28,740 --> 00:48:31,919
security issues<font color="#CCCCCC"> that we find</font><font color="#E5E5E5"> in the cars</font>

1357
00:48:30,300 --> 00:48:33,540
are very<font color="#E5E5E5"> similar to</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> embedded</font>

1358
00:48:31,920 --> 00:48:35,760
systems<font color="#E5E5E5"> and nothing new in the regular</font>

1359
00:48:33,540 --> 00:48:37,680
<font color="#E5E5E5">port and SSL and</font><font color="#CCCCCC"> shell commander stuff</font>

1360
00:48:35,760 --> 00:48:41,430
it's it's just the<font color="#CCCCCC"> same</font><font color="#E5E5E5"> kind of system</font>

1361
00:48:37,680 --> 00:48:42,930
<font color="#E5E5E5">but the thing which is the more</font>

1362
00:48:41,430 --> 00:48:46,259
problematic in the<font color="#E5E5E5"> cars</font><font color="#CCCCCC"> it that they're</font>

1363
00:48:42,930 --> 00:48:46,680
lagging<font color="#E5E5E5"> behind the home PC seen by quite</font>

1364
00:48:46,260 --> 00:48:48,480
a bit

1365
00:48:46,680 --> 00:48:50,100
security I mean<font color="#E5E5E5"> only recently cars that</font>

1366
00:48:48,480 --> 00:48:51,480
it can be<font color="#E5E5E5"> connected a lot of the code is</font>

1367
00:48:50,100 --> 00:48:53,490
<font color="#CCCCCC">too prepared</font><font color="#E5E5E5"> here it's not open</font><font color="#CCCCCC"> source</font>

1368
00:48:51,480 --> 00:48:55,560
it's not checked<font color="#E5E5E5"> enough so quite a few</font>

1369
00:48:53,490 --> 00:48:56,910
<font color="#CCCCCC">errors to be found quite a few</font>

1370
00:48:55,560 --> 00:48:58,860
vulnerabilities to<font color="#E5E5E5"> be found in the cars</font>

1371
00:48:56,910 --> 00:49:03,480
<font color="#CCCCCC">today</font><font color="#E5E5E5"> and which can</font><font color="#CCCCCC"> be taken advantage</font>

1372
00:48:58,860 --> 00:49:05,750
by<font color="#E5E5E5"> attackers that's it thank you</font><font color="#CCCCCC"> very</font>

1373
00:49:03,480 --> 00:49:05,750
<font color="#E5E5E5">much</font>

