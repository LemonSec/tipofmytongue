1
00:00:26,590 --> 00:00:34,330
hello everyone welcome<font color="#E5E5E5"> to besides Iowa</font>

2
00:00:29,840 --> 00:00:37,460
2018<font color="#E5E5E5"> this is a conversation</font><font color="#CCCCCC"> or a</font>

3
00:00:34,330 --> 00:00:39,860
<font color="#E5E5E5">presentation on device exploitation</font><font color="#CCCCCC"> or</font>

4
00:00:37,460 --> 00:00:42,620
post exploitation sorry<font color="#E5E5E5"> so we're going</font>

5
00:00:39,860 --> 00:00:44,900
to<font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about what you</font><font color="#E5E5E5"> can do with the</font>

6
00:00:42,620 --> 00:00:47,510
device<font color="#CCCCCC"> after you have</font><font color="#E5E5E5"> the shell on it</font>

7
00:00:44,900 --> 00:00:52,309
basically<font color="#E5E5E5"> and I really want to make this</font>

8
00:00:47,510 --> 00:00:55,430
like interactive<font color="#E5E5E5"> and if you have a</font>

9
00:00:52,309 --> 00:00:58,280
question for me and you<font color="#E5E5E5"> ask and it has</font>

10
00:00:55,430 --> 00:01:02,930
to do<font color="#E5E5E5"> with this this presentation</font><font color="#CCCCCC"> you're</font>

11
00:00:58,280 --> 00:01:04,610
gonna get a<font color="#CCCCCC"> IOT hacking starter kit from</font>

12
00:01:02,930 --> 00:01:07,190
this boss<font color="#E5E5E5"> you can choose whichever one</font>

13
00:01:04,610 --> 00:01:10,220
<font color="#E5E5E5">you want</font><font color="#CCCCCC"> or I can just choose</font><font color="#E5E5E5"> one for</font>

14
00:01:07,190 --> 00:01:12,080
you<font color="#E5E5E5"> wanted to do so I want to encourage</font>

15
00:01:10,220 --> 00:01:14,300
<font color="#CCCCCC">that feedback those questions I want to</font>

16
00:01:12,080 --> 00:01:15,830
encourage everyone have<font color="#CCCCCC"> fun</font>

17
00:01:14,300 --> 00:01:19,929
I certainly had fun<font color="#E5E5E5"> putting this</font>

18
00:01:15,830 --> 00:01:22,399
<font color="#E5E5E5">together and we'll just jump right in</font>

19
00:01:19,930 --> 00:01:24,770
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> Who am I</font>

20
00:01:22,399 --> 00:01:26,630
let's see I<font color="#E5E5E5"> am a Des Moines based</font>

21
00:01:24,770 --> 00:01:29,600
<font color="#E5E5E5">security researcher penetration tester</font>

22
00:01:26,630 --> 00:01:32,229
by day<font color="#CCCCCC"> open-source</font><font color="#E5E5E5"> security researcher</font>

23
00:01:29,600 --> 00:01:35,270
by night IOT security researcher so

24
00:01:32,229 --> 00:01:40,039
really this this IOT stuff is just

25
00:01:35,270 --> 00:01:43,220
started to do in my<font color="#E5E5E5"> spare</font><font color="#CCCCCC"> time</font><font color="#E5E5E5"> so that's</font>

26
00:01:40,039 --> 00:01:46,459
a little<font color="#E5E5E5"> bit about me if you want to</font>

27
00:01:43,220 --> 00:01:51,380
know more come talk to me afterwards<font color="#CCCCCC"> ok</font>

28
00:01:46,459 --> 00:01:53,360
like I<font color="#E5E5E5"> said this</font><font color="#CCCCCC"> clock is it is</font><font color="#E5E5E5"> about</font>

29
00:01:51,380 --> 00:01:55,970
the ones once you have a shell right<font color="#CCCCCC"> so</font>

30
00:01:53,360 --> 00:01:58,160
once you have compromised data<font color="#CCCCCC"> by a</font>

31
00:01:55,970 --> 00:01:59,780
device or<font color="#E5E5E5"> otherwise have administrative</font>

32
00:01:58,160 --> 00:02:02,390
access<font color="#CCCCCC"> to it</font><font color="#E5E5E5"> that's what this</font>

33
00:01:59,780 --> 00:02:05,300
presentation is<font color="#CCCCCC"> gonna be on what's not</font>

34
00:02:02,390 --> 00:02:08,360
gonna be on is<font color="#E5E5E5"> about device exploitation</font>

35
00:02:05,300 --> 00:02:10,340
itself<font color="#E5E5E5"> so I'm not gonna show</font><font color="#CCCCCC"> you how</font><font color="#E5E5E5"> to</font>

36
00:02:08,360 --> 00:02:12,110
gain administrative access it's just

37
00:02:10,340 --> 00:02:14,090
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be taken as like a prerequisite</font>

38
00:02:12,110 --> 00:02:17,030
<font color="#CCCCCC">to the rest of the conversation that you</font>

39
00:02:14,090 --> 00:02:20,330
<font color="#CCCCCC">already have a root shell</font><font color="#E5E5E5"> you already</font>

40
00:02:17,030 --> 00:02:23,750
have some way<font color="#E5E5E5"> to execute binaries on the</font>

41
00:02:20,330 --> 00:02:26,390
system<font color="#E5E5E5"> and preferably you have root</font>

42
00:02:23,750 --> 00:02:32,750
<font color="#E5E5E5">access you know you</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> have like</font>

43
00:02:26,390 --> 00:02:35,510
system level access so just a couple<font color="#E5E5E5"> of</font>

44
00:02:32,750 --> 00:02:37,390
introductions<font color="#CCCCCC"> to things I don't know</font>

45
00:02:35,510 --> 00:02:39,160
what everyone's like

46
00:02:37,390 --> 00:02:40,809
you know experience level<font color="#E5E5E5"> is so I'm</font>

47
00:02:39,160 --> 00:02:43,660
gonna<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> going to start really basic</font>

48
00:02:40,810 --> 00:02:47,170
and get kind of more complicated towards

49
00:02:43,660 --> 00:02:49,720
the end<font color="#CCCCCC"> and other things is basically</font>

50
00:02:47,170 --> 00:02:52,480
any sort of<font color="#E5E5E5"> device that's not a desktop</font>

51
00:02:49,720 --> 00:02:54,670
<font color="#E5E5E5">or server that can communicate</font><font color="#CCCCCC"> we're</font>

52
00:02:52,480 --> 00:02:56,530
gonna be talking about<font color="#CCCCCC"> IP devices today</font>

53
00:02:54,670 --> 00:02:58,750
<font color="#E5E5E5">so there's other protocols like</font>

54
00:02:56,530 --> 00:03:00,490
<font color="#CCCCCC">Bluetooth ZigBee z-wave like there's a</font>

55
00:02:58,750 --> 00:03:01,990
lot of different ways<font color="#CCCCCC"> to these</font><font color="#E5E5E5"> devices</font>

56
00:03:00,490 --> 00:03:06,400
<font color="#CCCCCC">to communicate so I'm</font><font color="#E5E5E5"> only going to</font>

57
00:03:01,990 --> 00:03:09,489
<font color="#CCCCCC">focus on IP devices</font><font color="#E5E5E5"> and specifically</font><font color="#CCCCCC"> I</font>

58
00:03:06,400 --> 00:03:11,680
have<font color="#CCCCCC"> a like consumer grade router</font><font color="#E5E5E5"> from a</font>

59
00:03:09,489 --> 00:03:12,940
couple<font color="#E5E5E5"> years</font><font color="#CCCCCC"> ago up here that's what I'm</font>

60
00:03:11,680 --> 00:03:15,820
going to<font color="#E5E5E5"> demonstrate some</font><font color="#CCCCCC"> of these</font>

61
00:03:12,940 --> 00:03:18,700
techniques on<font color="#E5E5E5"> so we're really gonna be</font>

62
00:03:15,820 --> 00:03:23,760
<font color="#E5E5E5">talking about like networking gear</font><font color="#CCCCCC"> IP</font>

63
00:03:18,700 --> 00:03:27,250
cameras<font color="#E5E5E5"> DVR</font><font color="#CCCCCC"> NPR's those type of like</font>

64
00:03:23,760 --> 00:03:30,880
devices<font color="#E5E5E5"> so not like you know your</font>

65
00:03:27,250 --> 00:03:34,600
<font color="#CCCCCC">bluetooth drill or your you know z-wave</font>

66
00:03:30,880 --> 00:03:37,510
thing that turns your<font color="#E5E5E5"> lights on</font><font color="#CCCCCC"> so just</font>

67
00:03:34,600 --> 00:03:39,609
wanted<font color="#CCCCCC"> to you know define</font><font color="#E5E5E5"> that so that</font>

68
00:03:37,510 --> 00:03:49,359
we know it's kind of in scope for<font color="#E5E5E5"> this</font>

69
00:03:39,610 --> 00:03:52,360
conversation<font color="#E5E5E5"> so why is IOT important so</font>

70
00:03:49,360 --> 00:03:55,060
just the number<font color="#CCCCCC"> of devices alone that</font>

71
00:03:52,360 --> 00:03:57,730
<font color="#CCCCCC">are attached</font><font color="#E5E5E5"> to the public Internet</font>

72
00:03:55,060 --> 00:04:00,070
publicly exposed was an interface on the

73
00:03:57,730 --> 00:04:01,840
device map to like you know a public<font color="#E5E5E5"> IP</font>

74
00:04:00,070 --> 00:04:04,780
address is enormous

75
00:04:01,840 --> 00:04:06,730
so I don't have<font color="#E5E5E5"> numbers with me but</font>

76
00:04:04,780 --> 00:04:08,620
there's probably<font color="#E5E5E5"> millions of these</font>

77
00:04:06,730 --> 00:04:09,730
<font color="#E5E5E5">things out</font><font color="#CCCCCC"> there if not like even</font><font color="#E5E5E5"> more</font>

78
00:04:08,620 --> 00:04:11,380
<font color="#CCCCCC">than that like tens of millions</font><font color="#E5E5E5"> or</font>

79
00:04:09,730 --> 00:04:13,030
hundreds of<font color="#E5E5E5"> millions</font><font color="#CCCCCC"> there's there's</font>

80
00:04:11,380 --> 00:04:17,440
<font color="#E5E5E5">just tons and</font><font color="#CCCCCC"> tons of these devices</font>

81
00:04:13,030 --> 00:04:19,540
connected and you combine<font color="#CCCCCC"> that with how</font>

82
00:04:17,440 --> 00:04:22,450
easy<font color="#CCCCCC"> it is to exploit these things</font>

83
00:04:19,540 --> 00:04:25,479
<font color="#E5E5E5">because security considerations were</font>

84
00:04:22,450 --> 00:04:28,419
minimal when they were designed and you

85
00:04:25,479 --> 00:04:31,690
get the scenario where like you can get

86
00:04:28,419 --> 00:04:35,710
a lot<font color="#E5E5E5"> of you can manipulate a large</font>

87
00:04:31,690 --> 00:04:37,300
<font color="#E5E5E5">number of devices concurrently to</font><font color="#CCCCCC"> do</font>

88
00:04:35,710 --> 00:04:40,599
things like generate traffic to<font color="#CCCCCC"> take</font>

89
00:04:37,300 --> 00:04:42,610
down Brian Krebs<font color="#E5E5E5"> website so it's a real</font>

90
00:04:40,600 --> 00:04:44,770
kind of<font color="#CCCCCC"> low-hanging</font><font color="#E5E5E5"> fruit thing right I</font>

91
00:04:42,610 --> 00:04:46,690
mean you know you have<font color="#CCCCCC"> really hardened</font>

92
00:04:44,770 --> 00:04:47,549
hosts<font color="#E5E5E5"> on the internet</font><font color="#CCCCCC"> why attack those</font>

93
00:04:46,690 --> 00:04:50,520
when you can lie

94
00:04:47,550 --> 00:04:53,400
get one that<font color="#E5E5E5"> you know it requires no</font>

95
00:04:50,520 --> 00:04:56,570
authentication<font color="#E5E5E5"> to you know get the</font>

96
00:04:53,400 --> 00:05:01,620
telnet<font color="#E5E5E5"> daemon</font><font color="#CCCCCC"> running or something and</font>

97
00:04:56,570 --> 00:05:03,510
use<font color="#E5E5E5"> that to compromise the device</font><font color="#CCCCCC"> you</font>

98
00:05:01,620 --> 00:05:05,850
know I mean there's no hackers gonna

99
00:05:03,510 --> 00:05:08,130
take the<font color="#CCCCCC"> looking free right it's you</font>

100
00:05:05,850 --> 00:05:09,870
know it's<font color="#E5E5E5"> it's that's why there's so</font>

101
00:05:08,130 --> 00:05:12,270
many of<font color="#E5E5E5"> these like botnets that have</font>

102
00:05:09,870 --> 00:05:12,690
come<font color="#CCCCCC"> out recently and</font><font color="#E5E5E5"> that leads me to</font>

103
00:05:12,270 --> 00:05:16,799
<font color="#CCCCCC">Mirai</font>

104
00:05:12,690 --> 00:05:20,090
so Mirai was this<font color="#E5E5E5"> enormous botnet that</font>

105
00:05:16,800 --> 00:05:23,970
<font color="#CCCCCC">was the one that took down Krebs ah's</font>

106
00:05:20,090 --> 00:05:26,969
<font color="#E5E5E5">website and then took down</font><font color="#CCCCCC"> dyeing the</font>

107
00:05:23,970 --> 00:05:28,830
DNS provider<font color="#CCCCCC"> it was a big deal</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> it</font>

108
00:05:26,970 --> 00:05:32,280
was for it when it<font color="#E5E5E5"> when</font><font color="#CCCCCC"> it took</font><font color="#E5E5E5"> down</font>

109
00:05:28,830 --> 00:05:34,620
dyeing especially<font color="#E5E5E5"> and it was composed</font>

110
00:05:32,280 --> 00:05:36,239
<font color="#E5E5E5">almost entirely of</font><font color="#CCCCCC"> ioki</font><font color="#E5E5E5"> devices I mean</font>

111
00:05:34,620 --> 00:05:40,950
there were some<font color="#CCCCCC"> c2</font><font color="#E5E5E5"> servers in there</font>

112
00:05:36,240 --> 00:05:43,020
<font color="#E5E5E5">telling the IOT devices what to do but I</font>

113
00:05:40,950 --> 00:05:45,390
mean<font color="#CCCCCC"> we're talking</font><font color="#E5E5E5"> hundreds of thousands</font>

114
00:05:43,020 --> 00:05:50,669
<font color="#E5E5E5">of nodes the largest botnet ever created</font>

115
00:05:45,390 --> 00:05:55,140
at that<font color="#E5E5E5"> point so that's kind of one of</font>

116
00:05:50,670 --> 00:05:57,360
<font color="#E5E5E5">the one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the two big nefarious ways</font>

117
00:05:55,140 --> 00:06:01,680
that<font color="#E5E5E5"> these IOT devices can be used</font><font color="#CCCCCC"> in</font>

118
00:05:57,360 --> 00:06:04,980
mass can be used<font color="#E5E5E5"> after</font><font color="#CCCCCC"> you have a bunch</font>

119
00:06:01,680 --> 00:06:09,000
of them collected and willing<font color="#CCCCCC"> to do your</font>

120
00:06:04,980 --> 00:06:11,070
bidding<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't know anything about</font>

121
00:06:09,000 --> 00:06:13,140
<font color="#E5E5E5">Mariah than when I just told</font><font color="#CCCCCC"> you I've</font>

122
00:06:11,070 --> 00:06:14,969
<font color="#CCCCCC">never</font><font color="#E5E5E5"> examined the source code the</font>

123
00:06:13,140 --> 00:06:17,969
source<font color="#E5E5E5"> code was released on the</font><font color="#CCCCCC"> internet</font>

124
00:06:14,970 --> 00:06:19,410
and it's pretty widely available from

125
00:06:17,970 --> 00:06:21,390
what I understand if you know where<font color="#CCCCCC"> to</font>

126
00:06:19,410 --> 00:06:25,020
<font color="#E5E5E5">look but I don't</font><font color="#CCCCCC"> know where to</font><font color="#E5E5E5"> look and</font>

127
00:06:21,390 --> 00:06:26,880
I<font color="#E5E5E5"> never looked at the source code in any</font>

128
00:06:25,020 --> 00:06:28,530
detail and basically all I<font color="#CCCCCC"> have is the</font>

129
00:06:26,880 --> 00:06:31,830
headlines in the news to go<font color="#CCCCCC"> off</font><font color="#E5E5E5"> loads</font>

130
00:06:28,530 --> 00:06:33,750
<font color="#E5E5E5">but knowing what I do know I can offer</font>

131
00:06:31,830 --> 00:06:36,479
<font color="#E5E5E5">some educated guesses on how they</font><font color="#CCCCCC"> did</font>

132
00:06:33,750 --> 00:06:38,850
what they<font color="#CCCCCC"> did</font><font color="#E5E5E5"> and has anyone looked at</font>

133
00:06:36,480 --> 00:06:40,290
the Mirage source code yeah I'm<font color="#E5E5E5"> really</font>

134
00:06:38,850 --> 00:06:42,240
interested to<font color="#E5E5E5"> hear</font><font color="#CCCCCC"> your thoughts on</font>

135
00:06:40,290 --> 00:06:43,950
whether or not<font color="#E5E5E5"> I'm accurate and how they</font>

136
00:06:42,240 --> 00:06:45,270
do some<font color="#E5E5E5"> of this</font><font color="#CCCCCC"> stuff when we get a</font>

137
00:06:43,950 --> 00:06:50,490
little<font color="#E5E5E5"> further into the presentation</font>

138
00:06:45,270 --> 00:06:53,210
oh<font color="#E5E5E5"> okay well</font><font color="#CCCCCC"> I mean just maybe maybe</font>

139
00:06:50,490 --> 00:06:55,560
afterwards we<font color="#E5E5E5"> can catch up or something</font>

140
00:06:53,210 --> 00:06:57,799
<font color="#CCCCCC">so there's a lot of these</font><font color="#E5E5E5"> botnets out</font>

141
00:06:55,560 --> 00:07:01,159
there now<font color="#E5E5E5"> like</font>

142
00:06:57,800 --> 00:07:02,930
<font color="#CCCCCC">I think the last one</font><font color="#E5E5E5"> they have like</font>

143
00:07:01,159 --> 00:07:05,960
<font color="#E5E5E5">families now like there's the</font><font color="#CCCCCC"> Mirai</font>

144
00:07:02,930 --> 00:07:07,580
<font color="#E5E5E5">family because the the the source code</font>

145
00:07:05,960 --> 00:07:10,128
was leaked<font color="#E5E5E5"> and people started</font><font color="#CCCCCC"> modifying</font>

146
00:07:07,580 --> 00:07:13,400
it and spinning up their<font color="#E5E5E5"> own</font><font color="#CCCCCC"> Mirai</font>

147
00:07:10,129 --> 00:07:15,949
botnet<font color="#E5E5E5"> clones</font><font color="#CCCCCC"> there's a couple other big</font>

148
00:07:13,400 --> 00:07:17,739
ones like there was<font color="#E5E5E5"> one that was</font>

149
00:07:15,949 --> 00:07:19,819
<font color="#CCCCCC">actually leveraging exploits to</font>

150
00:07:17,740 --> 00:07:24,830
compromised devices<font color="#CCCCCC"> and that</font><font color="#E5E5E5"> was like a</font>

151
00:07:19,819 --> 00:07:26,569
big like quantum leap in in botnet

152
00:07:24,830 --> 00:07:28,969
<font color="#E5E5E5">curation was when they started using</font>

153
00:07:26,569 --> 00:07:31,550
<font color="#E5E5E5">like really</font><font color="#CCCCCC"> high-end exploits to</font><font color="#E5E5E5"> capture</font>

154
00:07:28,970 --> 00:07:33,590
devices<font color="#E5E5E5"> I don't remember the name of</font>

155
00:07:31,550 --> 00:07:36,020
<font color="#E5E5E5">that one though off the top of my head</font>

156
00:07:33,590 --> 00:07:37,940
and<font color="#E5E5E5"> basically what you want what these</font>

157
00:07:36,020 --> 00:07:40,159
bad<font color="#E5E5E5"> actors want to do is grab as much</font>

158
00:07:37,940 --> 00:07:42,860
<font color="#E5E5E5">many many of these devices as possible</font>

159
00:07:40,159 --> 00:07:45,050
<font color="#E5E5E5">to maximize the amount of bandwidth</font><font color="#CCCCCC"> that</font>

160
00:07:42,860 --> 00:07:46,969
they can send to<font color="#E5E5E5"> anywhere</font><font color="#CCCCCC"> you know that</font>

161
00:07:45,050 --> 00:07:49,250
they can sell off to the highest bidder

162
00:07:46,969 --> 00:07:54,080
to do things<font color="#E5E5E5"> like take down Brian</font><font color="#CCCCCC"> codes</font>

163
00:07:49,250 --> 00:07:56,150
website<font color="#E5E5E5"> so this is kind of where this</font>

164
00:07:54,080 --> 00:07:58,669
presentation<font color="#E5E5E5"> takes a turn like we've</font>

165
00:07:56,150 --> 00:08:02,840
seen every I'm sure<font color="#E5E5E5"> most of you</font><font color="#CCCCCC"> guys</font><font color="#E5E5E5"> are</font>

166
00:07:58,669 --> 00:08:05,779
aware<font color="#CCCCCC"> of the like ddosed implications of</font>

167
00:08:02,840 --> 00:08:09,080
<font color="#CCCCCC">IOT and</font><font color="#E5E5E5"> how it can be you know</font><font color="#CCCCCC"> leveraged</font>

168
00:08:05,779 --> 00:08:12,380
to do bad things<font color="#CCCCCC"> but there's there's one</font>

169
00:08:09,080 --> 00:08:15,620
other<font color="#CCCCCC"> really like nefarious track you</font>

170
00:08:12,380 --> 00:08:19,310
can go down<font color="#E5E5E5"> with regard to like</font>

171
00:08:15,620 --> 00:08:22,190
compromising an IOT device<font color="#E5E5E5"> so like the</font>

172
00:08:19,310 --> 00:08:24,979
<font color="#E5E5E5">big one for me is complete network</font>

173
00:08:22,190 --> 00:08:28,490
traffic<font color="#CCCCCC"> surveillance</font><font color="#E5E5E5"> so if you can like</font>

174
00:08:24,979 --> 00:08:29,628
get on to someone's home router and you

175
00:08:28,490 --> 00:08:31,279
know what to do with it

176
00:08:29,629 --> 00:08:32,990
you can<font color="#CCCCCC"> monitor all</font><font color="#E5E5E5"> their internet</font>

177
00:08:31,279 --> 00:08:34,219
<font color="#CCCCCC">traffic right I mean</font><font color="#E5E5E5"> all the traffic</font>

178
00:08:32,990 --> 00:08:36,979
goes through the router to get to the

179
00:08:34,219 --> 00:08:38,360
rest of the world<font color="#E5E5E5"> and if they have</font>

180
00:08:36,979 --> 00:08:40,099
anything<font color="#E5E5E5"> going on interesting on the</font>

181
00:08:38,360 --> 00:08:42,729
land<font color="#E5E5E5"> you'll be able to see that</font><font color="#CCCCCC"> -</font>

182
00:08:40,099 --> 00:08:44,959
because<font color="#CCCCCC"> you're between those as well so</font>

183
00:08:42,729 --> 00:08:48,440
<font color="#E5E5E5">that lends</font><font color="#CCCCCC"> itself to things like</font>

184
00:08:44,959 --> 00:08:50,449
extortion<font color="#CCCCCC"> me</font><font color="#E5E5E5"> and the middle attacks DNS</font>

185
00:08:48,440 --> 00:08:52,610
poisoning attacks<font color="#E5E5E5"> like if I have control</font>

186
00:08:50,449 --> 00:08:56,329
of<font color="#E5E5E5"> this router and you haven't</font>

187
00:08:52,610 --> 00:08:56,720
configured your<font color="#E5E5E5"> DNS settings on</font><font color="#CCCCCC"> your on</font>

188
00:08:56,329 --> 00:08:59,719
your

189
00:08:56,720 --> 00:09:02,000
<font color="#E5E5E5">on your desktop your desktop is going to</font>

190
00:08:59,720 --> 00:09:04,400
use the router<font color="#E5E5E5"> as a DNS server which is</font>

191
00:09:02,000 --> 00:09:05,930
<font color="#E5E5E5">then then use whatever DNS server the</font>

192
00:09:04,400 --> 00:09:08,420
routers<font color="#E5E5E5"> programmed to use as the</font>

193
00:09:05,930 --> 00:09:10,430
upstream<font color="#E5E5E5"> DNS server so if I change that</font>

194
00:09:08,420 --> 00:09:12,050
upstream DNS server to<font color="#CCCCCC"> a server that</font><font color="#E5E5E5"> I</font>

195
00:09:10,430 --> 00:09:14,810
control and<font color="#E5E5E5"> start directing all of your</font>

196
00:09:12,050 --> 00:09:16,810
<font color="#E5E5E5">traffic to my malicious domain whenever</font>

197
00:09:14,810 --> 00:09:19,219
you try<font color="#E5E5E5"> to make a request to paypal.com</font>

198
00:09:16,810 --> 00:09:20,810
you know you start seeing some

199
00:09:19,220 --> 00:09:23,480
interesting phishing scenarios and

200
00:09:20,810 --> 00:09:25,310
interesting credential harvesting

201
00:09:23,480 --> 00:09:26,840
scenarios that you can get into and<font color="#CCCCCC"> you</font>

202
00:09:25,310 --> 00:09:28,760
know get bank account information or

203
00:09:26,840 --> 00:09:30,260
whatever<font color="#E5E5E5"> you know I mean the sky's the</font>

204
00:09:28,760 --> 00:09:33,590
limit with that sort of<font color="#E5E5E5"> thing</font>

205
00:09:30,260 --> 00:09:36,560
so it's a very very<font color="#CCCCCC"> powerful position to</font>

206
00:09:33,590 --> 00:09:38,630
be well in terms of<font color="#E5E5E5"> on a network you</font>

207
00:09:36,560 --> 00:09:40,849
know<font color="#E5E5E5"> what we're not taught these sort of</font>

208
00:09:38,630 --> 00:09:42,470
devices<font color="#E5E5E5"> are not used in really really</font>

209
00:09:40,850 --> 00:09:44,990
sensitive<font color="#E5E5E5"> context right like no one's</font>

210
00:09:42,470 --> 00:09:49,570
running a data center off of a home

211
00:09:44,990 --> 00:09:54,560
router<font color="#E5E5E5"> right</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> mean they're really</font>

212
00:09:49,570 --> 00:09:57,410
they're<font color="#CCCCCC"> really only used in like home</font>

213
00:09:54,560 --> 00:10:01,040
and small office<font color="#E5E5E5"> contexts most of the</font>

214
00:09:57,410 --> 00:10:02,660
time so like you're you're<font color="#E5E5E5"> basically</font>

215
00:10:01,040 --> 00:10:04,939
<font color="#E5E5E5">attacking an individual but if you could</font>

216
00:10:02,660 --> 00:10:07,310
<font color="#E5E5E5">automate all</font><font color="#CCCCCC"> of it then you can attack</font>

217
00:10:04,940 --> 00:10:08,690
individuals<font color="#CCCCCC"> in masse to perform this</font>

218
00:10:07,310 --> 00:10:10,550
kind<font color="#E5E5E5"> of like network traffic</font>

219
00:10:08,690 --> 00:10:12,620
surveillance<font color="#CCCCCC"> and do these form</font><font color="#E5E5E5"> of</font>

220
00:10:10,550 --> 00:10:14,540
nefarious<font color="#E5E5E5"> things and I haven't</font><font color="#CCCCCC"> really</font>

221
00:10:12,620 --> 00:10:17,360
seen any botnets doing that sort of

222
00:10:14,540 --> 00:10:19,730
thing I have heard about it<font color="#CCCCCC"> I have all</font>

223
00:10:17,360 --> 00:10:22,820
I've<font color="#CCCCCC"> really heard about is IOT botnets</font>

224
00:10:19,730 --> 00:10:25,760
<font color="#CCCCCC">that are generating traffic</font><font color="#E5E5E5"> for the</font>

225
00:10:22,820 --> 00:10:28,940
malicious botnet<font color="#CCCCCC"> of bad actors</font><font color="#E5E5E5"> so</font>

226
00:10:25,760 --> 00:10:30,410
there's like a whole<font color="#CCCCCC"> new evolution I</font>

227
00:10:28,940 --> 00:10:32,690
<font color="#CCCCCC">think that's gonna</font><font color="#E5E5E5"> happen eventually</font><font color="#CCCCCC"> one</font>

228
00:10:30,410 --> 00:10:34,430
<font color="#CCCCCC">that</font><font color="#E5E5E5"> woman attackers start realizing</font>

229
00:10:32,690 --> 00:10:37,010
like how they can leverage<font color="#E5E5E5"> this really</font>

230
00:10:34,430 --> 00:10:38,660
powerful position on the network to make

231
00:10:37,010 --> 00:10:41,180
<font color="#E5E5E5">more money</font><font color="#CCCCCC"> basically you know</font><font color="#E5E5E5"> to scam</font>

232
00:10:38,660 --> 00:10:44,140
more people<font color="#CCCCCC"> harvest more credentials</font><font color="#E5E5E5"> I</font>

233
00:10:41,180 --> 00:10:47,209
think we're gonna see another wave of

234
00:10:44,140 --> 00:10:52,640
<font color="#E5E5E5">IOT botnet malware that's going to do</font>

235
00:10:47,210 --> 00:10:54,260
some<font color="#E5E5E5"> very nasty things so that's that's</font>

236
00:10:52,640 --> 00:10:56,330
kind<font color="#E5E5E5"> of what I want to focus on for this</font>

237
00:10:54,260 --> 00:10:59,360
presentation is<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> that angle to it</font>

238
00:10:56,330 --> 00:11:01,310
like you know I can get<font color="#E5E5E5"> on here</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I</font>

239
00:10:59,360 --> 00:11:02,780
can make web requests really easily<font color="#E5E5E5"> it's</font>

240
00:11:01,310 --> 00:11:04,130
not<font color="#CCCCCC"> that difficult</font><font color="#E5E5E5"> you know and that's</font>

241
00:11:02,780 --> 00:11:06,380
that's<font color="#E5E5E5"> one of the ways they generate</font>

242
00:11:04,130 --> 00:11:10,400
<font color="#CCCCCC">level-7</font><font color="#E5E5E5"> traffic that can bypass all</font><font color="#CCCCCC"> the</font>

243
00:11:06,380 --> 00:11:10,819
<font color="#E5E5E5">DDoS filters on its way</font><font color="#CCCCCC"> to Brian Krebs</font>

244
00:11:10,400 --> 00:11:17,269
as well

245
00:11:10,819 --> 00:11:18,498
<font color="#E5E5E5">site so that's not a big</font><font color="#CCCCCC"> deal</font><font color="#E5E5E5"> with what</font>

246
00:11:17,269 --> 00:11:20,239
I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> is the big deal is what I just</font>

247
00:11:18,499 --> 00:11:25,459
<font color="#CCCCCC">said the complete network traffic</font>

248
00:11:20,239 --> 00:11:27,169
<font color="#E5E5E5">surveillance</font><font color="#CCCCCC"> however like I said no</font>

249
00:11:25,459 --> 00:11:33,079
one's<font color="#E5E5E5"> really doing this yet because it's</font>

250
00:11:27,169 --> 00:11:34,789
pretty<font color="#E5E5E5"> difficult</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> it's basically</font><font color="#CCCCCC"> to</font>

251
00:11:33,079 --> 00:11:36,349
having these capabilities you're gonna

252
00:11:34,789 --> 00:11:38,839
have to be able<font color="#E5E5E5"> to compile binaries that</font>

253
00:11:36,350 --> 00:11:43,009
will run on<font color="#CCCCCC"> a</font><font color="#E5E5E5"> device like</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> so that's</font>

254
00:11:38,839 --> 00:11:49,939
possible<font color="#CCCCCC"> but</font><font color="#E5E5E5"> it's it's pretty difficult</font>

255
00:11:43,009 --> 00:11:50,539
to<font color="#E5E5E5"> do so</font><font color="#CCCCCC"> wouldn't</font><font color="#E5E5E5"> you get one of these</font>

256
00:11:49,939 --> 00:11:52,789
devices

257
00:11:50,539 --> 00:11:55,819
it comes with firmware pre-installed on

258
00:11:52,789 --> 00:11:57,499
it right and you many times<font color="#E5E5E5"> update that</font>

259
00:11:55,819 --> 00:11:59,858
firmware with another manufacturer

260
00:11:57,499 --> 00:12:03,379
firmware or like an open source firmware

261
00:11:59,859 --> 00:12:07,910
<font color="#E5E5E5">the particular example we're gonna focus</font>

262
00:12:03,379 --> 00:12:09,979
on manufacturer firmware but when you

263
00:12:07,910 --> 00:12:11,569
flash the device with that firmware you

264
00:12:09,979 --> 00:12:12,949
have a certain<font color="#E5E5E5"> set</font><font color="#CCCCCC"> of binaries that</font><font color="#E5E5E5"> are</font>

265
00:12:11,569 --> 00:12:16,519
pre-installed<font color="#E5E5E5"> that come with you know</font>

266
00:12:12,949 --> 00:12:18,949
<font color="#CCCCCC">Linux and that you can have you could</font>

267
00:12:16,519 --> 00:12:23,089
access well and run wants you to have

268
00:12:18,949 --> 00:12:26,569
shell access<font color="#E5E5E5"> on the device so really</font>

269
00:12:23,089 --> 00:12:30,409
what we want<font color="#E5E5E5"> to do is expand our binary</font>

270
00:12:26,569 --> 00:12:32,988
base we want to expand our capabilities

271
00:12:30,409 --> 00:12:39,499
<font color="#E5E5E5">on</font><font color="#CCCCCC"> the device beyond what's provided</font><font color="#E5E5E5"> by</font>

272
00:12:32,989 --> 00:12:41,419
the manufacturer<font color="#CCCCCC"> so</font><font color="#E5E5E5"> I'm gonna walk you</font>

273
00:12:39,499 --> 00:12:44,029
<font color="#CCCCCC">through kind of my</font><font color="#E5E5E5"> process on</font><font color="#CCCCCC"> what I do</font>

274
00:12:41,419 --> 00:12:47,389
once I have a shell<font color="#CCCCCC"> on a device the</font>

275
00:12:44,029 --> 00:12:49,039
first<font color="#E5E5E5"> thing is</font><font color="#CCCCCC"> he numeration I start</font>

276
00:12:47,389 --> 00:12:51,470
with enumerating the binaries on the

277
00:12:49,039 --> 00:12:54,259
device<font color="#CCCCCC"> there's other things</font><font color="#E5E5E5"> you can do</font>

278
00:12:51,470 --> 00:12:57,379
<font color="#E5E5E5">like</font><font color="#CCCCCC"> checking the mount structure seeing</font>

279
00:12:54,259 --> 00:12:59,049
what file systems are mounted<font color="#E5E5E5"> which ones</font>

280
00:12:57,379 --> 00:13:01,939
are read-only which ones are rewrite

281
00:12:59,049 --> 00:13:04,608
<font color="#E5E5E5">which ones are persistent which ones are</font>

282
00:13:01,939 --> 00:13:06,228
<font color="#CCCCCC">not</font><font color="#E5E5E5"> you also probably want to see what</font>

283
00:13:04,609 --> 00:13:08,029
file systems are available<font color="#CCCCCC"> in the kernel</font>

284
00:13:06,229 --> 00:13:11,539
in case you need<font color="#CCCCCC"> to mount an NFS server</font>

285
00:13:08,029 --> 00:13:12,829
or something<font color="#E5E5E5"> to get files on and off</font><font color="#CCCCCC"> so</font>

286
00:13:11,539 --> 00:13:18,439
there's there's a<font color="#CCCCCC"> lot of little things</font>

287
00:13:12,829 --> 00:13:20,118
<font color="#E5E5E5">to do but like the big one is is is is</font>

288
00:13:18,439 --> 00:13:22,160
finding<font color="#E5E5E5"> all the binaries on</font><font color="#CCCCCC"> the device</font>

289
00:13:20,119 --> 00:13:26,029
what's up

290
00:13:22,160 --> 00:13:28,069
<font color="#E5E5E5">this are you</font><font color="#CCCCCC"> or are you just kind of</font>

291
00:13:26,029 --> 00:13:29,180
<font color="#E5E5E5">doing this like all</font><font color="#CCCCCC"> through the command</font>

292
00:13:28,069 --> 00:13:30,920
<font color="#E5E5E5">line or are you doing</font><font color="#CCCCCC"> something like</font>

293
00:13:29,180 --> 00:13:32,329
<font color="#E5E5E5">dump the firmware and then you've been</font>

294
00:13:30,920 --> 00:13:34,819
<font color="#E5E5E5">walking to like try to enumerate</font>

295
00:13:32,329 --> 00:13:36,709
binaries are you yeah<font color="#E5E5E5"> so I do both of</font>

296
00:13:34,819 --> 00:13:38,420
those<font color="#CCCCCC"> things and</font><font color="#E5E5E5"> I'll show you a little</font>

297
00:13:36,709 --> 00:13:41,719
<font color="#CCCCCC">bit of</font><font color="#E5E5E5"> the second one the the bin walk</font>

298
00:13:38,420 --> 00:13:43,189
stuff<font color="#CCCCCC"> in my live demo but I'm</font><font color="#E5E5E5"> not gonna</font>

299
00:13:41,720 --> 00:13:44,360
focus too much on that<font color="#E5E5E5"> today it's a</font>

300
00:13:43,189 --> 00:13:48,199
<font color="#E5E5E5">really effective way of getting</font>

301
00:13:44,360 --> 00:13:51,230
<font color="#CCCCCC">information about</font><font color="#E5E5E5"> firmware but you know</font>

302
00:13:48,199 --> 00:13:53,209
I I'm just<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> use like when you're</font>

303
00:13:51,230 --> 00:13:54,709
<font color="#E5E5E5">new radio you just kind of like is</font><font color="#CCCCCC"> that</font>

304
00:13:53,209 --> 00:13:56,660
<font color="#E5E5E5">the</font><font color="#CCCCCC"> systemic thing or you</font><font color="#E5E5E5"> just kind of</font>

305
00:13:54,709 --> 00:13:57,109
<font color="#E5E5E5">like wandering around just poking your</font>

306
00:13:56,660 --> 00:13:59,180
nose

307
00:13:57,110 --> 00:14:01,300
well that<font color="#CCCCCC"> dist directory okay yeah I</font>

308
00:13:59,180 --> 00:14:04,329
mean I do both<font color="#CCCCCC"> of those</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> I I do</font>

309
00:14:01,300 --> 00:14:06,769
<font color="#E5E5E5">you know I I do the</font><font color="#CCCCCC"> file system</font>

310
00:14:04,329 --> 00:14:11,239
availability<font color="#E5E5E5"> in</font><font color="#CCCCCC"> the kernel the mounting</font>

311
00:14:06,769 --> 00:14:13,129
<font color="#E5E5E5">structure the binary available listing</font>

312
00:14:11,240 --> 00:14:14,870
and then like if they have find on there

313
00:14:13,129 --> 00:14:16,579
I'll run find against the entire<font color="#CCCCCC"> root</font>

314
00:14:14,870 --> 00:14:19,009
structure and like dump it<font color="#CCCCCC"> to a file</font>

315
00:14:16,579 --> 00:14:20,989
somewhere so I can<font color="#E5E5E5"> review it later</font><font color="#CCCCCC"> so do</font>

316
00:14:19,009 --> 00:14:22,850
you also like look at<font color="#E5E5E5"> like the</font><font color="#CCCCCC"> NVRAM</font>

317
00:14:20,990 --> 00:14:24,589
like where they store like the answer

318
00:14:22,850 --> 00:14:27,019
credentials from<font color="#E5E5E5"> yeah the DSL Network</font>

319
00:14:24,589 --> 00:14:29,089
<font color="#CCCCCC">yeah because</font><font color="#E5E5E5"> like some of the things</font><font color="#CCCCCC"> I</font>

320
00:14:27,019 --> 00:14:31,279
worry<font color="#CCCCCC"> about it's like you know a lot of</font>

321
00:14:29,089 --> 00:14:33,230
times your<font color="#CCCCCC"> ISP like set you up with a</font>

322
00:14:31,279 --> 00:14:35,569
webmail account that uses the same

323
00:14:33,230 --> 00:14:37,279
credentials<font color="#E5E5E5"> on your DSL modem and then</font>

324
00:14:35,569 --> 00:14:39,290
the bad<font color="#E5E5E5"> guy can go you know essentially</font>

325
00:14:37,279 --> 00:14:40,339
<font color="#E5E5E5">go</font><font color="#CCCCCC"> login to that account for you yeah if</font>

326
00:14:39,290 --> 00:14:43,209
you've never because a lot of<font color="#E5E5E5"> people</font>

327
00:14:40,339 --> 00:14:45,230
<font color="#CCCCCC">don't know that they've got a webmail</font>

328
00:14:43,210 --> 00:14:48,060
[Music]

329
00:14:45,230 --> 00:14:51,440
so that's<font color="#E5E5E5"> really interesting I try I was</font>

330
00:14:48,060 --> 00:14:54,420
looking at how to browse the<font color="#CCCCCC"> NVRAM on</font>

331
00:14:51,440 --> 00:14:56,250
this device in particular<font color="#CCCCCC"> I couldn't</font>

332
00:14:54,420 --> 00:14:58,199
find it<font color="#CCCCCC"> with</font><font color="#E5E5E5"> a limited amount of time</font><font color="#CCCCCC"> I</font>

333
00:14:56,250 --> 00:15:01,050
had I could not<font color="#E5E5E5"> find the binary which</font>

334
00:14:58,200 --> 00:15:03,210
did that<font color="#E5E5E5"> so in other instances you just</font>

335
00:15:01,050 --> 00:15:05,030
run<font color="#CCCCCC"> NVRAM show and then grip pipe</font><font color="#E5E5E5"> it to</font>

336
00:15:03,210 --> 00:15:07,530
grep and<font color="#CCCCCC"> then you can see</font><font color="#E5E5E5"> like the user</font>

337
00:15:05,030 --> 00:15:10,199
the<font color="#E5E5E5"> user</font><font color="#CCCCCC"> names the</font><font color="#E5E5E5"> pad if you grab for</font>

338
00:15:07,530 --> 00:15:12,480
<font color="#CCCCCC">pass you can see the passwords of you</font>

339
00:15:10,200 --> 00:15:14,520
know the Wi-Fi the Wi-Fi access point

340
00:15:12,480 --> 00:15:17,070
<font color="#E5E5E5">all kinds of stuff like and that's</font>

341
00:15:14,520 --> 00:15:19,079
another useful<font color="#E5E5E5"> component to the data you</font>

342
00:15:17,070 --> 00:15:21,300
<font color="#CCCCCC">can harvest from from having</font><font color="#E5E5E5"> that you</font>

343
00:15:19,080 --> 00:15:23,520
<font color="#E5E5E5">know privileged position on the network</font>

344
00:15:21,300 --> 00:15:25,770
you know you could if you were really

345
00:15:23,520 --> 00:15:29,040
<font color="#E5E5E5">looking</font><font color="#CCCCCC"> to target</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> specific individual</font>

346
00:15:25,770 --> 00:15:32,400
<font color="#E5E5E5">you could get like the Wi-Fi password or</font>

347
00:15:29,040 --> 00:15:33,900
public private public<font color="#CCCCCC"> cherokee and</font><font color="#E5E5E5"> you</font>

348
00:15:32,400 --> 00:15:35,760
know drive by their house<font color="#E5E5E5"> while on their</font>

349
00:15:33,900 --> 00:15:38,790
network<font color="#E5E5E5"> and then you have a full full</font>

350
00:15:35,760 --> 00:15:40,830
<font color="#E5E5E5">node like a</font><font color="#CCCCCC"> Kali instance on their</font>

351
00:15:38,790 --> 00:15:46,860
network<font color="#E5E5E5"> this requires physical</font><font color="#CCCCCC"> proximity</font>

352
00:15:40,830 --> 00:15:58,980
at that point<font color="#E5E5E5"> any other questions by the</font>

353
00:15:46,860 --> 00:16:04,260
<font color="#E5E5E5">way you guys get to pick one out that's</font>

354
00:15:58,980 --> 00:16:07,220
like Socrates<font color="#E5E5E5"> that works too and I clean</font>

355
00:16:04,260 --> 00:16:07,220
all this up

356
00:16:31,120 --> 00:16:34,120
yep

357
00:16:34,240 --> 00:16:38,870
the question was<font color="#E5E5E5"> what what's actually on</font>

358
00:16:37,280 --> 00:16:42,290
<font color="#CCCCCC">the device in terms</font><font color="#E5E5E5"> of available</font>

359
00:16:38,870 --> 00:16:45,440
binaries<font color="#E5E5E5"> I will show you during my</font><font color="#CCCCCC"> live</font>

360
00:16:42,290 --> 00:16:49,459
thing<font color="#E5E5E5"> but</font><font color="#CCCCCC"> also it's just</font><font color="#E5E5E5"> the basic Linux</font>

361
00:16:45,440 --> 00:16:51,020
<font color="#E5E5E5">like utilities like LS cat</font><font color="#CCCCCC"> you know like</font>

362
00:16:49,460 --> 00:16:52,340
sometimes<font color="#CCCCCC"> W get will be</font><font color="#E5E5E5"> on there</font>

363
00:16:51,020 --> 00:16:54,230
sometimes<font color="#E5E5E5"> curl will be on there</font>

364
00:16:52,340 --> 00:16:55,220
sometimes<font color="#CCCCCC"> neither sometimes it's like</font>

365
00:16:54,230 --> 00:16:58,400
<font color="#CCCCCC">FTP</font>

366
00:16:55,220 --> 00:17:00,500
sometimes<font color="#CCCCCC"> it's TFTP</font><font color="#E5E5E5"> I mean there's</font>

367
00:16:58,400 --> 00:17:03,380
there's almost always some way of making

368
00:17:00,500 --> 00:17:05,329
<font color="#E5E5E5">network traffic</font><font color="#CCCCCC"> but like in terms of</font>

369
00:17:03,380 --> 00:17:07,640
transferring things on not the device it

370
00:17:05,329 --> 00:17:09,290
gets difficult if you don't<font color="#CCCCCC"> have curl or</font>

371
00:17:07,640 --> 00:17:09,680
<font color="#E5E5E5">W yet you have to set up</font><font color="#CCCCCC"> its</font><font color="#E5E5E5"> the FTP</font>

372
00:17:09,290 --> 00:17:12,379
server

373
00:17:09,680 --> 00:17:15,140
almost always and transfer things that

374
00:17:12,380 --> 00:17:22,040
way<font color="#CCCCCC"> there's also all kinds of</font><font color="#E5E5E5"> firmware</font>

375
00:17:15,140 --> 00:17:24,680
updating capabilities there's<font color="#E5E5E5"> there</font>

376
00:17:22,040 --> 00:17:27,170
there's<font color="#CCCCCC"> other</font><font color="#E5E5E5"> light there's like the</font>

377
00:17:24,680 --> 00:17:29,140
HTTP<font color="#CCCCCC"> demons on there usually</font><font color="#E5E5E5"> so there's</font>

378
00:17:27,170 --> 00:17:31,460
a couple<font color="#E5E5E5"> different</font><font color="#CCCCCC"> things you know oh</font>

379
00:17:29,140 --> 00:17:35,240
I'll show<font color="#E5E5E5"> you more in detail when I go</font>

380
00:17:31,460 --> 00:17:36,710
<font color="#CCCCCC">through the live presentation</font><font color="#E5E5E5"> so like I</font>

381
00:17:35,240 --> 00:17:40,610
<font color="#CCCCCC">said</font><font color="#E5E5E5"> you really want to look</font><font color="#CCCCCC"> for</font>

382
00:17:36,710 --> 00:17:42,860
binaries<font color="#CCCCCC"> that can create network traffic</font>

383
00:17:40,610 --> 00:17:45,500
<font color="#E5E5E5">one because</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the first goal right</font>

384
00:17:42,860 --> 00:17:47,959
to<font color="#E5E5E5"> create network traffic to hit a big</font>

385
00:17:45,500 --> 00:17:49,670
target<font color="#E5E5E5"> but second of all you want to be</font>

386
00:17:47,960 --> 00:17:53,690
able<font color="#E5E5E5"> to transfer things on and off the</font>

387
00:17:49,670 --> 00:17:55,280
device so one of the ways that<font color="#CCCCCC"> I one of</font>

388
00:17:53,690 --> 00:17:59,050
<font color="#E5E5E5">the first things I did when I was trying</font>

389
00:17:55,280 --> 00:18:02,149
<font color="#E5E5E5">to compile binaries for this device was</font>

390
00:17:59,050 --> 00:18:04,790
pull a file off of it and run the file

391
00:18:02,150 --> 00:18:07,160
<font color="#CCCCCC">command on that</font><font color="#E5E5E5"> file on</font><font color="#CCCCCC"> that binary</font><font color="#E5E5E5"> I</font>

392
00:18:04,790 --> 00:18:10,129
pulled the<font color="#CCCCCC"> httpd file off there which is</font>

393
00:18:07,160 --> 00:18:12,620
<font color="#E5E5E5">the HTTP daemon that runs the server on</font>

394
00:18:10,130 --> 00:18:14,690
port 80<font color="#E5E5E5"> so</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> pulled that off there and</font><font color="#CCCCCC"> I</font>

395
00:18:12,620 --> 00:18:16,399
run file on<font color="#CCCCCC"> it</font><font color="#E5E5E5"> and you know later on</font>

396
00:18:14,690 --> 00:18:18,020
<font color="#E5E5E5">I'll run it through binary ninja and</font>

397
00:18:16,400 --> 00:18:20,720
take a deeper look<font color="#E5E5E5"> at it looking for</font>

398
00:18:18,020 --> 00:18:23,470
other interesting things but the file

399
00:18:20,720 --> 00:18:25,910
command alone<font color="#E5E5E5"> like tells me so much that</font>

400
00:18:23,470 --> 00:18:27,560
I was able<font color="#E5E5E5"> to really kind of</font>

401
00:18:25,910 --> 00:18:31,940
troubleshoot some of my compilation

402
00:18:27,560 --> 00:18:34,100
issues<font color="#CCCCCC"> by by just knowing what kind of</font>

403
00:18:31,940 --> 00:18:37,100
architecture<font color="#CCCCCC"> and</font><font color="#E5E5E5"> what kind of you know</font>

404
00:18:34,100 --> 00:18:41,870
<font color="#E5E5E5">binaries are on the device itself you</font>

405
00:18:37,100 --> 00:18:43,309
by<font color="#E5E5E5"> default so yeah anything</font><font color="#CCCCCC"> that's</font>

406
00:18:41,870 --> 00:18:46,549
anything that's<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> create network</font>

407
00:18:43,309 --> 00:18:48,410
traffic is interesting<font color="#E5E5E5"> if you want to be</font>

408
00:18:46,549 --> 00:18:50,418
really destructive the<font color="#CCCCCC"> form or update</font>

409
00:18:48,410 --> 00:18:57,620
capabilities are pretty interesting too

410
00:18:50,419 --> 00:18:59,150
you can do some bad things<font color="#CCCCCC"> with those no</font>

411
00:18:57,620 --> 00:19:04,189
not on the device

412
00:18:59,150 --> 00:19:11,809
never<font color="#E5E5E5"> never once have I seen GCC</font><font color="#CCCCCC"> G + +</font>

413
00:19:04,190 --> 00:19:14,140
CC<font color="#E5E5E5"> GDB GDB</font><font color="#CCCCCC"> LLVM</font><font color="#E5E5E5"> g DB server known that</font>

414
00:19:11,809 --> 00:19:16,309
stuff is ever on<font color="#E5E5E5"> these things by default</font>

415
00:19:14,140 --> 00:19:17,690
<font color="#CCCCCC">okay</font>

416
00:19:16,309 --> 00:19:19,610
that's a great question though because

417
00:19:17,690 --> 00:19:24,350
that<font color="#E5E5E5"> would make things easy right yeah</font>

418
00:19:19,610 --> 00:19:26,059
<font color="#E5E5E5">well it turns out those</font><font color="#CCCCCC"> those binaries -</font>

419
00:19:24,350 --> 00:19:29,980
<font color="#CCCCCC">did like</font><font color="#E5E5E5"> you were talking about like GCC</font>

420
00:19:26,059 --> 00:19:36,530
are available just<font color="#E5E5E5"> not on the device so</font>

421
00:19:29,980 --> 00:19:39,860
we'll go over<font color="#CCCCCC"> that in a minute here so</font>

422
00:19:36,530 --> 00:19:43,059
like like the malware<font color="#E5E5E5"> that I the might</font>

423
00:19:39,860 --> 00:19:46,250
and<font color="#CCCCCC"> Moriah botnet for example like</font><font color="#E5E5E5"> I</font>

424
00:19:43,059 --> 00:19:47,990
<font color="#E5E5E5">assume the payload the initial like x</font>

425
00:19:46,250 --> 00:19:50,390
<font color="#E5E5E5">boy paylo that was written to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> file</font>

426
00:19:47,990 --> 00:19:51,650
system<font color="#E5E5E5"> was just</font><font color="#CCCCCC"> a shell</font><font color="#E5E5E5"> script</font><font color="#CCCCCC"> i don't</font>

427
00:19:50,390 --> 00:19:54,230
know that like<font color="#CCCCCC"> obviously actually</font><font color="#E5E5E5"> i</font>

428
00:19:51,650 --> 00:19:57,080
haven't<font color="#E5E5E5"> looked</font><font color="#CCCCCC"> at the i'ma</font><font color="#E5E5E5"> look to the</font>

429
00:19:54,230 --> 00:19:59,630
source<font color="#CCCCCC"> or anything but</font><font color="#E5E5E5"> I imagine it</font>

430
00:19:57,080 --> 00:20:01,610
<font color="#E5E5E5">would given the</font><font color="#CCCCCC"> given the difficulty in</font>

431
00:19:59,630 --> 00:20:03,350
compiling almost anything for<font color="#E5E5E5"> these</font>

432
00:20:01,610 --> 00:20:05,719
<font color="#E5E5E5">devices and especially how they won't</font>

433
00:20:03,350 --> 00:20:09,379
they<font color="#CCCCCC"> based because of the G Lib C</font>

434
00:20:05,720 --> 00:20:11,000
version<font color="#CCCCCC"> how you can't really port</font><font color="#E5E5E5"> you</font>

435
00:20:09,380 --> 00:20:14,780
<font color="#E5E5E5">know a binary</font><font color="#CCCCCC"> coupon for</font><font color="#E5E5E5"> this to another</font>

436
00:20:11,000 --> 00:20:18,520
device by another manufacturer<font color="#E5E5E5"> like the</font>

437
00:20:14,780 --> 00:20:20,780
<font color="#E5E5E5">the amount of trouble there leads me to</font>

438
00:20:18,520 --> 00:20:25,520
<font color="#E5E5E5">speculate that they use</font><font color="#CCCCCC"> scroll shell</font>

439
00:20:20,780 --> 00:20:30,139
scripts<font color="#E5E5E5"> to to you know contact the</font><font color="#CCCCCC"> c2</font>

440
00:20:25,520 --> 00:20:31,820
server and figure out what to<font color="#CCCCCC"> run and</font>

441
00:20:30,140 --> 00:20:34,760
that's<font color="#E5E5E5"> not where you know that's that's</font>

442
00:20:31,820 --> 00:20:39,918
that's not legitimate software<font color="#E5E5E5"> I wrote</font>

443
00:20:34,760 --> 00:20:43,669
<font color="#CCCCCC">this</font><font color="#E5E5E5"> up at a earlier point in time to</font>

444
00:20:39,919 --> 00:20:46,610
<font color="#E5E5E5">demonstrate how I think this could work</font>

445
00:20:43,669 --> 00:20:49,370
<font color="#E5E5E5">as a shell script like it I mean you</font>

446
00:20:46,610 --> 00:20:50,580
just if you<font color="#E5E5E5"> have for example</font><font color="#CCCCCC"> W get which</font>

447
00:20:49,370 --> 00:20:51,989
this<font color="#E5E5E5"> device has</font>

448
00:20:50,580 --> 00:20:53,820
you make a<font color="#CCCCCC"> double you</font><font color="#E5E5E5"> get requests</font>

449
00:20:51,990 --> 00:20:57,029
<font color="#CCCCCC">Thornton</font><font color="#E5E5E5"> an environment variable and</font>

450
00:20:53,820 --> 00:21:00,529
then loop<font color="#E5E5E5"> you know a thousand ten</font>

451
00:20:57,029 --> 00:21:02,549
thousand five<font color="#E5E5E5"> hundred in number of</font><font color="#CCCCCC"> times</font>

452
00:21:00,529 --> 00:21:05,700
<font color="#CCCCCC">executing that command</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> you</font>

453
00:21:02,549 --> 00:21:08,820
retrieved<font color="#E5E5E5"> from the c2 server</font><font color="#CCCCCC"> you know</font>

454
00:21:05,700 --> 00:21:11,610
and that<font color="#E5E5E5"> commands gonna look like W get</font>

455
00:21:08,820 --> 00:21:14,850
<font color="#E5E5E5">HTTP Brian Krebs calm or Krebs on</font>

456
00:21:11,610 --> 00:21:16,559
security calm you<font color="#CCCCCC"> know so the the</font><font color="#E5E5E5"> c2</font>

457
00:21:14,850 --> 00:21:19,559
<font color="#CCCCCC">server's gonna</font><font color="#E5E5E5"> control like what gets</font>

458
00:21:16,559 --> 00:21:22,289
attacked<font color="#E5E5E5"> or what happens there</font>

459
00:21:19,559 --> 00:21:23,879
you know what command gets run on the

460
00:21:22,289 --> 00:21:24,899
device<font color="#E5E5E5"> and then you know you don't want</font>

461
00:21:23,880 --> 00:21:29,460
<font color="#E5E5E5">to you don't</font><font color="#CCCCCC"> want to create all that</font>

462
00:21:24,899 --> 00:21:30,870
back traffic to your your your<font color="#E5E5E5"> c2 server</font>

463
00:21:29,460 --> 00:21:33,389
so like when<font color="#E5E5E5"> you're done attacking you</font>

464
00:21:30,870 --> 00:21:37,379
change that payload txt to like<font color="#E5E5E5"> echo</font><font color="#CCCCCC"> 1</font>

465
00:21:33,389 --> 00:21:40,340
or<font color="#CCCCCC"> something so that you know the the</font>

466
00:21:37,380 --> 00:21:43,440
shell script<font color="#E5E5E5"> the the malware is not</font>

467
00:21:40,340 --> 00:21:44,879
doing anything malicious and because you

468
00:21:43,440 --> 00:21:46,289
know if your<font color="#E5E5E5"> customer is</font><font color="#CCCCCC"> not paying you</font>

469
00:21:44,880 --> 00:21:50,940
don't want to be delivering product for

470
00:21:46,289 --> 00:21:55,320
them<font color="#CCCCCC"> ok</font><font color="#E5E5E5"> yeah so this</font><font color="#CCCCCC"> is the mean break</font>

471
00:21:50,940 --> 00:21:56,970
break<font color="#CCCCCC"> I thought that was funny</font><font color="#E5E5E5"> no</font><font color="#CCCCCC"> one's</font>

472
00:21:55,320 --> 00:22:02,070
<font color="#E5E5E5">laughing right now but I thought it was</font>

473
00:21:56,970 --> 00:22:04,590
good<font color="#E5E5E5"> so next slide so now I really want</font>

474
00:22:02,070 --> 00:22:07,620
to get<font color="#E5E5E5"> into like what I call the path to</font>

475
00:22:04,590 --> 00:22:09,480
compilation and just talk through the

476
00:22:07,620 --> 00:22:13,289
difficulties and<font color="#CCCCCC"> the challenges</font><font color="#E5E5E5"> as I</font>

477
00:22:09,480 --> 00:22:17,549
experienced<font color="#E5E5E5"> trying to get something to</font>

478
00:22:13,289 --> 00:22:19,590
run on this this device<font color="#E5E5E5"> and then trying</font>

479
00:22:17,549 --> 00:22:21,870
to get<font color="#E5E5E5"> something complex to run on this</font>

480
00:22:19,590 --> 00:22:23,250
device<font color="#E5E5E5"> turns out they're just</font><font color="#CCCCCC"> like an</font>

481
00:22:21,870 --> 00:22:26,100
order of magnitude difficulty between

482
00:22:23,250 --> 00:22:34,320
<font color="#E5E5E5">just those two</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> let alone</font><font color="#CCCCCC"> the easy</font>

483
00:22:26,100 --> 00:22:36,870
stuff<font color="#E5E5E5"> so processors right I've looked at</font>

484
00:22:34,320 --> 00:22:40,379
a<font color="#CCCCCC"> lot of IOT</font><font color="#E5E5E5"> devices the newer ones all</font>

485
00:22:36,870 --> 00:22:43,199
seem to be ARM based a lot of the older

486
00:22:40,380 --> 00:22:47,240
almost all<font color="#E5E5E5"> the older ones are lecturer</font>

487
00:22:43,200 --> 00:22:51,690
or<font color="#CCCCCC"> mips and this one is Electra</font>

488
00:22:47,240 --> 00:22:53,850
processor and what<font color="#E5E5E5"> lecturer is is it's a</font>

489
00:22:51,690 --> 00:22:58,080
subset<font color="#E5E5E5"> of myths</font><font color="#CCCCCC"> without the</font><font color="#E5E5E5"> unaligned</font>

490
00:22:53,850 --> 00:23:02,399
<font color="#CCCCCC">load and store commands are</font><font color="#E5E5E5"> op codes so</font>

491
00:22:58,080 --> 00:23:03,409
<font color="#E5E5E5">if you compile a mips binary it's likely</font>

492
00:23:02,399 --> 00:23:05,479
to<font color="#E5E5E5"> have those</font>

493
00:23:03,410 --> 00:23:07,760
codes in it well if it has those op

494
00:23:05,480 --> 00:23:09,950
codes<font color="#E5E5E5"> in it it won't run because this</font>

495
00:23:07,760 --> 00:23:11,810
processor does not accept those op codes

496
00:23:09,950 --> 00:23:13,250
and I'll show you<font color="#E5E5E5"> that</font><font color="#CCCCCC"> in a minute</font><font color="#E5E5E5"> but</font>

497
00:23:11,810 --> 00:23:14,659
<font color="#CCCCCC">it's that's</font><font color="#E5E5E5"> a really important note</font>

498
00:23:13,250 --> 00:23:17,780
that's<font color="#E5E5E5"> like the crux of this whole</font>

499
00:23:14,660 --> 00:23:20,330
<font color="#CCCCCC">problem if it was just the MIPS like the</font>

500
00:23:17,780 --> 00:23:22,520
standard<font color="#CCCCCC"> MIPS opcode set you can compile</font>

501
00:23:20,330 --> 00:23:23,990
this using the gnu toolchain<font color="#CCCCCC"> you know</font>

502
00:23:22,520 --> 00:23:28,389
the cross compiler that<font color="#E5E5E5"> you can get off</font>

503
00:23:23,990 --> 00:23:30,560
aptitude or<font color="#E5E5E5"> fedora or eople and just</font>

504
00:23:28,390 --> 00:23:31,940
compile right there and you know you're

505
00:23:30,560 --> 00:23:34,639
done<font color="#E5E5E5"> you don't have any additional work</font>

506
00:23:31,940 --> 00:23:36,260
to<font color="#E5E5E5"> do</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> in that case</font><font color="#CCCCCC"> i would think</font>

507
00:23:34,640 --> 00:23:37,490
there<font color="#CCCCCC"> would be a lot more bad now we're</font>

508
00:23:36,260 --> 00:23:39,340
out there<font color="#CCCCCC"> because</font><font color="#E5E5E5"> I think it'd be</font><font color="#CCCCCC"> really</font>

509
00:23:37,490 --> 00:23:41,450
<font color="#CCCCCC">easy to compiled binaries that do</font>

510
00:23:39,340 --> 00:23:46,490
horrible<font color="#E5E5E5"> things</font><font color="#CCCCCC"> that get on</font><font color="#E5E5E5"> these</font>

511
00:23:41,450 --> 00:23:49,070
<font color="#CCCCCC">devices so more difficulties with the</font>

512
00:23:46,490 --> 00:23:50,990
<font color="#CCCCCC">lexer processor the linux kernel the</font>

513
00:23:49,070 --> 00:23:54,409
main source tree does<font color="#CCCCCC"> not support</font>

514
00:23:50,990 --> 00:23:57,530
<font color="#E5E5E5">compiling</font><font color="#CCCCCC"> the lecturer</font><font color="#E5E5E5"> so if you want to</font>

515
00:23:54,410 --> 00:23:59,960
compile a version of the of the Linux

516
00:23:57,530 --> 00:24:03,379
<font color="#E5E5E5">kernel that is devoid of those unaligned</font>

517
00:23:59,960 --> 00:24:07,820
store and load commands you have<font color="#CCCCCC"> to use</font>

518
00:24:03,380 --> 00:24:11,570
these<font color="#E5E5E5"> these patches that this guy on</font>

519
00:24:07,820 --> 00:24:13,189
this website<font color="#CCCCCC"> provides</font><font color="#E5E5E5"> and run them</font>

520
00:24:11,570 --> 00:24:15,560
against<font color="#E5E5E5"> your Linux kernel and then send</font>

521
00:24:13,190 --> 00:24:17,000
<font color="#E5E5E5">it out</font><font color="#CCCCCC"> on millions of devices</font><font color="#E5E5E5"> that's</font>

522
00:24:15,560 --> 00:24:19,419
that's<font color="#E5E5E5"> literally some guy on the</font>

523
00:24:17,000 --> 00:24:19,420
<font color="#CCCCCC">Internet</font>

524
00:24:24,740 --> 00:24:29,550
it's very very likely<font color="#E5E5E5"> if not they're</font>

525
00:24:28,110 --> 00:24:34,260
gonna have<font color="#E5E5E5"> patches that are internally</font>

526
00:24:29,550 --> 00:24:35,700
developed<font color="#CCCCCC"> but I that's a lot of</font><font color="#E5E5E5"> work and</font>

527
00:24:34,260 --> 00:24:36,990
from what I've seen<font color="#E5E5E5"> people don't put a</font>

528
00:24:35,700 --> 00:24:40,380
lot<font color="#E5E5E5"> of work into these things</font>

529
00:24:36,990 --> 00:24:41,880
so I'm guessing<font color="#CCCCCC"> a lot of them you</font><font color="#E5E5E5"> know</font>

530
00:24:40,380 --> 00:24:48,390
<font color="#CCCCCC">just use</font><font color="#E5E5E5"> some guy</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the Internet's</font>

531
00:24:41,880 --> 00:24:50,970
patches you have a kernel<font color="#E5E5E5"> exploit well</font>

532
00:24:48,390 --> 00:24:52,320
you see I mean yes and no<font color="#E5E5E5"> that sounds</font>

533
00:24:50,970 --> 00:24:54,000
awesome<font color="#E5E5E5"> but you know what if you get a</font>

534
00:24:52,320 --> 00:24:55,800
<font color="#E5E5E5">shell on these it's a root</font><font color="#CCCCCC"> shell anyway</font>

535
00:24:54,000 --> 00:24:59,670
<font color="#E5E5E5">so there's no like need for privilege</font>

536
00:24:55,800 --> 00:25:01,139
<font color="#E5E5E5">escalation or anything but it's a good</font>

537
00:24:59,670 --> 00:25:02,580
point I mean<font color="#E5E5E5"> there's there's other</font>

538
00:25:01,140 --> 00:25:04,080
things you<font color="#E5E5E5"> could find you using that</font>

539
00:25:02,580 --> 00:25:07,860
<font color="#CCCCCC">methodology that</font><font color="#E5E5E5"> would that</font><font color="#CCCCCC"> would lead</font>

540
00:25:04,080 --> 00:25:12,480
to<font color="#E5E5E5"> interesting results I think do you</font>

541
00:25:07,860 --> 00:25:18,899
want an IOT starter kit sure maybe<font color="#E5E5E5"> later</font>

542
00:25:12,480 --> 00:25:22,590
that's a no<font color="#E5E5E5"> okay we know each other I'll</font>

543
00:25:18,900 --> 00:25:23,460
get you afterwards so<font color="#E5E5E5"> okay I like I</font>

544
00:25:22,590 --> 00:25:27,060
mentioned before

545
00:25:23,460 --> 00:25:27,870
no<font color="#E5E5E5"> no GCC no compilation tools on the</font>

546
00:25:27,060 --> 00:25:30,629
device<font color="#CCCCCC"> itself</font>

547
00:25:27,870 --> 00:25:32,669
<font color="#E5E5E5">however most of those tool chains and in</font>

548
00:25:30,630 --> 00:25:35,640
fact the Linux kernel<font color="#CCCCCC"> itself is licensed</font>

549
00:25:32,670 --> 00:25:37,680
under the GPL license you know so part

550
00:25:35,640 --> 00:25:42,180
<font color="#E5E5E5">of the GPL licenses I understand is you</font>

551
00:25:37,680 --> 00:25:44,610
<font color="#CCCCCC">have to provide the source code</font><font color="#E5E5E5"> and like</font>

552
00:25:42,180 --> 00:25:46,650
if<font color="#E5E5E5"> anyone who gets if you use a GPL</font><font color="#CCCCCC"> and</font>

553
00:25:44,610 --> 00:25:49,889
<font color="#E5E5E5">your product</font><font color="#CCCCCC"> you provide the source code</font>

554
00:25:46,650 --> 00:25:53,340
for<font color="#E5E5E5"> free to all</font><font color="#CCCCCC"> your end-users</font><font color="#E5E5E5"> so the</font>

555
00:25:49,890 --> 00:25:55,620
way that<font color="#E5E5E5"> manufacturers typically handle</font>

556
00:25:53,340 --> 00:25:57,419
this is by<font color="#E5E5E5"> making</font><font color="#CCCCCC"> available on the</font>

557
00:25:55,620 --> 00:25:59,699
internet on<font color="#CCCCCC"> their on the manufacturer</font>

558
00:25:57,420 --> 00:26:04,830
website<font color="#CCCCCC"> what's called GPL code and</font>

559
00:25:59,700 --> 00:26:07,320
that's<font color="#E5E5E5"> like usually let's see that's</font>

560
00:26:04,830 --> 00:26:09,600
<font color="#E5E5E5">like you</font><font color="#CCCCCC"> know the Linux</font><font color="#E5E5E5"> kernel itself is</font>

561
00:26:07,320 --> 00:26:13,860
<font color="#E5E5E5">almost always is always in there you</font>

562
00:26:09,600 --> 00:26:15,120
know it's some version of<font color="#E5E5E5"> it at least</font><font color="#CCCCCC"> so</font>

563
00:26:13,860 --> 00:26:17,070
that's that's the big one

564
00:26:15,120 --> 00:26:19,199
<font color="#E5E5E5">but then additionally a lot of these</font>

565
00:26:17,070 --> 00:26:21,810
manufacturers<font color="#E5E5E5"> put the the tool chain</font>

566
00:26:19,200 --> 00:26:27,720
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you need to use to compile these</font>

567
00:26:21,810 --> 00:26:29,580
binaries<font color="#CCCCCC"> in that code so that's how you</font>

568
00:26:27,720 --> 00:26:32,190
get it<font color="#E5E5E5"> that's how you get</font><font color="#CCCCCC"> a compiler</font><font color="#E5E5E5"> for</font>

569
00:26:29,580 --> 00:26:32,939
these<font color="#E5E5E5"> devices now once you</font><font color="#CCCCCC"> have a</font>

570
00:26:32,190 --> 00:26:36,570
compiler

571
00:26:32,940 --> 00:26:38,790
for them<font color="#CCCCCC"> we'll go</font><font color="#E5E5E5"> over this in</font><font color="#CCCCCC"> a minute</font>

572
00:26:36,570 --> 00:26:40,740
<font color="#CCCCCC">once</font><font color="#E5E5E5"> you have a compiler form though</font>

573
00:26:38,790 --> 00:26:42,750
<font color="#E5E5E5">like that that gets you the first step</font>

574
00:26:40,740 --> 00:26:44,730
the easy<font color="#E5E5E5"> the easy</font><font color="#CCCCCC"> binaries</font><font color="#E5E5E5"> right there</font>

575
00:26:42,750 --> 00:26:47,400
like the hello world binaries that<font color="#E5E5E5"> are</font>

576
00:26:44,730 --> 00:26:52,160
you know a demonstration of a<font color="#CCCCCC"> concepts</font>

577
00:26:47,400 --> 00:26:54,830
but<font color="#E5E5E5"> are you know a hair shy of a real</font>

578
00:26:52,160 --> 00:27:04,320
capability<font color="#CCCCCC"> for lack of a better</font><font color="#E5E5E5"> phrase</font>

579
00:26:54,830 --> 00:27:06,540
<font color="#E5E5E5">so after after after I got</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the point</font>

580
00:27:04,320 --> 00:27:08,129
<font color="#E5E5E5">of being able to compile these binaries</font>

581
00:27:06,540 --> 00:27:10,379
and take it takes a while<font color="#CCCCCC"> you have to</font>

582
00:27:08,130 --> 00:27:12,300
find the exact GPL code for the exact

583
00:27:10,380 --> 00:27:16,530
device<font color="#E5E5E5"> the exact version of the firmware</font>

584
00:27:12,300 --> 00:27:18,629
<font color="#E5E5E5">and know where to look within that 500</font>

585
00:27:16,530 --> 00:27:21,180
or 600 megabyte file

586
00:27:18,630 --> 00:27:23,070
<font color="#E5E5E5">you know zip archive you downloaded for</font>

587
00:27:21,180 --> 00:27:27,480
where to find all<font color="#E5E5E5"> the</font><font color="#CCCCCC"> stuff and things</font>

588
00:27:23,070 --> 00:27:29,909
to compile your<font color="#CCCCCC"> own binaries then you</font>

589
00:27:27,480 --> 00:27:33,810
know we're<font color="#CCCCCC"> the more the GCC</font><font color="#E5E5E5"> and the</font><font color="#CCCCCC"> G+</font>

590
00:27:29,910 --> 00:27:35,100
plus exists and once once you get those

591
00:27:33,810 --> 00:27:39,419
in<font color="#CCCCCC"> a place where you can use them</font>

592
00:27:35,100 --> 00:27:41,429
<font color="#CCCCCC">effectively like there's a lot of make</font>

593
00:27:39,420 --> 00:27:44,850
file manipulation a lot of like<font color="#E5E5E5"> auto</font>

594
00:27:41,430 --> 00:27:50,600
comm stuff that you have<font color="#E5E5E5"> to set exactly</font>

595
00:27:44,850 --> 00:27:50,600
the right parameters to<font color="#CCCCCC"> it you have to</font>

596
00:27:50,720 --> 00:27:54,960
go<font color="#E5E5E5"> into the make files</font><font color="#CCCCCC"> that generates</font>

597
00:27:53,160 --> 00:27:59,220
and monkey around with<font color="#E5E5E5"> those so that</font>

598
00:27:54,960 --> 00:28:02,400
they include the<font color="#E5E5E5"> proper header files not</font>

599
00:27:59,220 --> 00:28:06,570
not the like<font color="#E5E5E5"> host operating systems</font>

600
00:28:02,400 --> 00:28:08,160
<font color="#E5E5E5">header files so that part was the most</font>

601
00:28:06,570 --> 00:28:10,439
<font color="#E5E5E5">complicated because like at that point</font>

602
00:28:08,160 --> 00:28:13,320
<font color="#E5E5E5">you're in uncharted territory</font><font color="#CCCCCC"> like no no</font>

603
00:28:10,440 --> 00:28:16,230
one has the Stack Overflow post on how

604
00:28:13,320 --> 00:28:19,379
to<font color="#E5E5E5"> modify</font><font color="#CCCCCC"> a make file to config to</font>

605
00:28:16,230 --> 00:28:21,030
compile curl on a<font color="#E5E5E5"> lexer processor in</font>

606
00:28:19,380 --> 00:28:22,710
fact there's almost nothing<font color="#E5E5E5"> on the</font>

607
00:28:21,030 --> 00:28:25,889
internet<font color="#CCCCCC"> about lecture</font><font color="#E5E5E5"> processors and</font><font color="#CCCCCC"> in</font>

608
00:28:22,710 --> 00:28:27,930
general<font color="#E5E5E5"> you know that there's just very</font>

609
00:28:25,890 --> 00:28:29,910
<font color="#E5E5E5">little information at this point and</font>

610
00:28:27,930 --> 00:28:32,160
it's like<font color="#E5E5E5"> for me it was like walking</font>

611
00:28:29,910 --> 00:28:33,960
through<font color="#E5E5E5"> a dark room trying to find the</font>

612
00:28:32,160 --> 00:28:36,150
<font color="#CCCCCC">white switch</font><font color="#E5E5E5"> so that</font><font color="#CCCCCC"> you can find the</font>

613
00:28:33,960 --> 00:28:39,390
door<font color="#CCCCCC"> to the next dark room to find the</font>

614
00:28:36,150 --> 00:28:42,300
next<font color="#E5E5E5"> light switch it was a interesting</font>

615
00:28:39,390 --> 00:28:44,430
process but<font color="#CCCCCC"> difficult and frustrating so</font>

616
00:28:42,300 --> 00:28:45,010
we're getting kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> close to the point</font>

617
00:28:44,430 --> 00:28:47,680
where I wanted

618
00:28:45,010 --> 00:28:52,120
demonstrates and stuff<font color="#E5E5E5"> so I want to say</font>

619
00:28:47,680 --> 00:28:55,600
this<font color="#E5E5E5"> first</font><font color="#CCCCCC"> I am today going</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> demo on</font>

620
00:28:52,120 --> 00:28:56,889
this like this device right and I<font color="#E5E5E5"> don't</font>

621
00:28:55,600 --> 00:28:59,020
want<font color="#E5E5E5"> to like single out this</font>

622
00:28:56,890 --> 00:29:01,210
manufacturers being better<font color="#E5E5E5"> or worse than</font>

623
00:28:59,020 --> 00:29:04,540
any<font color="#E5E5E5"> other manufacturer</font><font color="#CCCCCC"> it was just an</font>

624
00:29:01,210 --> 00:29:06,820
easy demonstration device<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of the</font>

625
00:29:04,540 --> 00:29:08,649
<font color="#CCCCCC">manufacturers all of them have all of</font>

626
00:29:06,820 --> 00:29:10,540
them have their<font color="#CCCCCC"> own</font><font color="#E5E5E5"> problems right</font><font color="#CCCCCC"> so I</font>

627
00:29:08,650 --> 00:29:12,340
<font color="#E5E5E5">don't want to be up here</font><font color="#CCCCCC"> like bashing on</font>

628
00:29:10,540 --> 00:29:13,810
one particular<font color="#E5E5E5"> manufacturer because I</font>

629
00:29:12,340 --> 00:29:15,820
don't<font color="#E5E5E5"> feel like that's helpful and</font><font color="#CCCCCC"> I</font>

630
00:29:13,810 --> 00:29:19,810
don't<font color="#E5E5E5"> feel like that's even accurate you</font>

631
00:29:15,820 --> 00:29:22,840
<font color="#CCCCCC">know so and software in general is hard</font>

632
00:29:19,810 --> 00:29:25,629
embedded software<font color="#E5E5E5"> additionally is super</font>

633
00:29:22,840 --> 00:29:27,159
hard<font color="#E5E5E5"> to do so I I don't even want to</font>

634
00:29:25,630 --> 00:29:29,260
fault the<font color="#E5E5E5"> people for these issues</font><font color="#CCCCCC"> you</font>

635
00:29:27,160 --> 00:29:31,000
<font color="#CCCCCC">know they're</font><font color="#E5E5E5"> getting better at</font>

636
00:29:29,260 --> 00:29:34,510
<font color="#CCCCCC">remediating them once they're reported</font>

637
00:29:31,000 --> 00:29:38,170
but I don't like<font color="#E5E5E5"> bashing on software</font>

638
00:29:34,510 --> 00:29:40,720
developers I just feel like software<font color="#E5E5E5"> is</font>

639
00:29:38,170 --> 00:29:42,280
hard<font color="#E5E5E5"> so I want to make that</font><font color="#CCCCCC"> point at</font>

640
00:29:40,720 --> 00:29:43,960
<font color="#CCCCCC">least that I'm not I'm not</font><font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to</font>

641
00:29:42,280 --> 00:29:45,820
<font color="#E5E5E5">single</font><font color="#CCCCCC"> out this</font><font color="#E5E5E5"> particular manufacturer</font>

642
00:29:43,960 --> 00:29:47,260
I'm not I'm not<font color="#E5E5E5"> gonna like actually tell</font>

643
00:29:45,820 --> 00:29:49,510
you what it<font color="#CCCCCC"> is</font><font color="#E5E5E5"> but you'll</font><font color="#CCCCCC"> be able</font><font color="#E5E5E5"> to</font>

644
00:29:47,260 --> 00:29:52,120
tell by by when I start doing the things

645
00:29:49,510 --> 00:29:57,430
and the stuff on<font color="#E5E5E5"> terminal so I just</font>

646
00:29:52,120 --> 00:29:59,979
<font color="#CCCCCC">wanna make</font><font color="#E5E5E5"> that point</font><font color="#CCCCCC"> the GPL code that</font>

647
00:29:57,430 --> 00:30:03,430
comes for<font color="#E5E5E5"> that comes off the</font><font color="#CCCCCC"> website for</font>

648
00:29:59,980 --> 00:30:07,180
this device has this readme.txt file in

649
00:30:03,430 --> 00:30:08,950
it and it's there's a little more<font color="#CCCCCC"> to it</font>

650
00:30:07,180 --> 00:30:10,870
than<font color="#E5E5E5"> this but like really this is the</font>

651
00:30:08,950 --> 00:30:14,650
bulk<font color="#E5E5E5"> of the instructions on how</font><font color="#CCCCCC"> to</font>

652
00:30:10,870 --> 00:30:16,810
compile your<font color="#CCCCCC"> own kernel</font><font color="#E5E5E5"> that'll then and</font>

653
00:30:14,650 --> 00:30:21,160
binaries and programs that will run<font color="#CCCCCC"> on</font>

654
00:30:16,810 --> 00:30:22,600
<font color="#E5E5E5">this device so the one of the</font>

655
00:30:21,160 --> 00:30:24,280
interesting things I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> this is</font>

656
00:30:22,600 --> 00:30:27,520
interesting<font color="#CCCCCC"> under</font><font color="#E5E5E5"> three building the</font>

657
00:30:24,280 --> 00:30:30,040
image<font color="#CCCCCC"> it says make three times</font><font color="#E5E5E5"> in a row</font>

658
00:30:27,520 --> 00:30:31,629
<font color="#E5E5E5">you</font><font color="#CCCCCC"> actually have to run make three</font>

659
00:30:30,040 --> 00:30:35,860
times in a row<font color="#CCCCCC"> in the same directory to</font>

660
00:30:31,630 --> 00:30:37,000
get<font color="#CCCCCC"> it to do its thing which I didn't</font>

661
00:30:35,860 --> 00:30:39,490
<font color="#CCCCCC">know at first I</font><font color="#E5E5E5"> thought it</font><font color="#CCCCCC"> was like</font><font color="#E5E5E5"> a</font>

662
00:30:37,000 --> 00:30:41,410
typo<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they had make make make and I</font>

663
00:30:39,490 --> 00:30:44,200
was like<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> and run make once and then</font>

664
00:30:41,410 --> 00:30:51,040
do the things so I<font color="#CCCCCC"> I had to run it three</font>

665
00:30:44,200 --> 00:30:54,670
times it's not very effective<font color="#CCCCCC"> the one of</font>

666
00:30:51,040 --> 00:30:57,340
the<font color="#E5E5E5"> the really</font><font color="#CCCCCC"> big thing here is the</font>

667
00:30:54,670 --> 00:31:00,010
<font color="#E5E5E5">copy - RF</font><font color="#CCCCCC"> our SDK</font>

668
00:30:57,340 --> 00:31:04,659
that contains all<font color="#E5E5E5"> the compilation tool</font>

669
00:31:00,010 --> 00:31:06,970
<font color="#E5E5E5">chains and all the assets and</font><font color="#CCCCCC"> a header</font>

670
00:31:04,660 --> 00:31:10,160
files you'll need to compile<font color="#CCCCCC"> your own</font>

671
00:31:06,970 --> 00:31:11,610
<font color="#E5E5E5">kernel to compile your</font><font color="#CCCCCC"> own binaries and</font>

672
00:31:10,160 --> 00:31:15,330
[Music]

673
00:31:11,610 --> 00:31:22,419
<font color="#E5E5E5">it's it's</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> proprietary SDK provided by</font>

674
00:31:15,330 --> 00:31:30,790
a giant board manufacturer<font color="#CCCCCC"> okay so let's</font>

675
00:31:22,420 --> 00:31:37,020
do some presentation time<font color="#E5E5E5"> okay</font>

676
00:31:30,790 --> 00:31:37,020
so let's let's get on<font color="#E5E5E5"> to the device</font>

677
00:31:42,240 --> 00:31:46,790
<font color="#E5E5E5">okay God do something</font><font color="#CCCCCC"> first sorry guys</font>

678
00:31:48,710 --> 00:31:51,860
got it

679
00:32:04,559 --> 00:32:08,690
sorry for the delay<font color="#CCCCCC"> it'll just take</font><font color="#E5E5E5"> a</font>

680
00:32:06,240 --> 00:32:08,690
second

681
00:32:41,920 --> 00:32:47,560
it's gonna become<font color="#E5E5E5"> reachable this is fun</font>

682
00:32:46,090 --> 00:33:08,429
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is the fun you have when you do</font>

683
00:32:47,560 --> 00:33:10,960
live demos about<font color="#CCCCCC"> it</font><font color="#E5E5E5"> there we go</font><font color="#CCCCCC"> alright</font>

684
00:33:08,430 --> 00:33:13,330
<font color="#E5E5E5">so the first</font><font color="#CCCCCC"> thing I want to</font><font color="#E5E5E5"> show you on</font>

685
00:33:10,960 --> 00:33:16,090
this<font color="#CCCCCC"> we're not logged in yet</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so</font>

686
00:33:13,330 --> 00:33:24,790
<font color="#CCCCCC">what if I type in</font><font color="#E5E5E5"> like a random</font><font color="#CCCCCC"> username</font>

687
00:33:16,090 --> 00:33:26,949
<font color="#E5E5E5">what would you expect</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> happen next so</font>

688
00:33:24,790 --> 00:33:29,730
this allows you to<font color="#E5E5E5"> figure</font><font color="#CCCCCC"> out what the</font>

689
00:33:26,950 --> 00:33:29,730
<font color="#CCCCCC">username</font><font color="#E5E5E5"> is</font>

690
00:33:37,180 --> 00:33:44,210
<font color="#E5E5E5">okay so now we're on the device we have</font>

691
00:33:42,080 --> 00:33:47,090
<font color="#E5E5E5">we have our root shell that had so</font>

692
00:33:44,210 --> 00:33:51,050
kindly returned to us without any other

693
00:33:47,090 --> 00:33:52,730
like sub privileges so I'll go through

694
00:33:51,050 --> 00:33:55,310
<font color="#CCCCCC">my enumeration and then I'll like to</font>

695
00:33:52,730 --> 00:34:03,290
<font color="#E5E5E5">start doing the fun stuff so like you</font>

696
00:33:55,310 --> 00:34:05,419
know you echo out the path you see<font color="#E5E5E5"> this</font>

697
00:34:03,290 --> 00:34:07,730
<font color="#E5E5E5">list the binary is this big enough</font><font color="#CCCCCC"> for</font>

698
00:34:05,420 --> 00:34:13,520
<font color="#E5E5E5">everyone to see you by the way</font><font color="#CCCCCC"> okay cool</font>

699
00:34:07,730 --> 00:34:17,418
<font color="#CCCCCC">so</font><font color="#E5E5E5"> you see some fun stuff in here you</font>

700
00:34:13,520 --> 00:34:19,070
<font color="#CCCCCC">see like W get and you see</font><font color="#E5E5E5"> although</font><font color="#CCCCCC"> all</font>

701
00:34:17,418 --> 00:34:24,850
the<font color="#E5E5E5"> de-facto</font>

702
00:34:19,070 --> 00:34:28,129
<font color="#E5E5E5">Linux commands like you name you mount</font>

703
00:34:24,850 --> 00:34:33,620
<font color="#CCCCCC">all you know</font><font color="#E5E5E5"> just random different</font>

704
00:34:28,129 --> 00:34:35,480
things<font color="#CCCCCC"> so you the next thing I would do</font>

705
00:34:33,620 --> 00:34:39,409
is check the mounted file systems

706
00:34:35,480 --> 00:34:45,050
<font color="#E5E5E5">it looks like</font><font color="#CCCCCC"> the VAR slash bar slash</font>

707
00:34:39,409 --> 00:34:50,080
this slash dev<font color="#E5E5E5"> and slash temp which is</font>

708
00:34:45,050 --> 00:34:50,080
assembling<font color="#CCCCCC"> two dash bar</font><font color="#E5E5E5"> or rewritable</font>

709
00:34:51,699 --> 00:34:55,790
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's seen everything else at</font>

710
00:34:54,320 --> 00:34:58,400
the root is<font color="#E5E5E5"> read-only</font>

711
00:34:55,790 --> 00:35:02,600
okay that's that<font color="#E5E5E5"> makes sense something</font>

712
00:34:58,400 --> 00:35:05,510
else I would do is like cat proc<font color="#E5E5E5"> CPU and</font>

713
00:35:02,600 --> 00:35:08,710
this is basic you know<font color="#E5E5E5"> enumeration stuff</font>

714
00:35:05,510 --> 00:35:08,710
this isn't<font color="#CCCCCC"> anything fancy</font>

715
00:35:14,310 --> 00:35:19,859
<font color="#CCCCCC">these are the file systems</font><font color="#E5E5E5"> that are</font>

716
00:35:16,630 --> 00:35:22,480
<font color="#E5E5E5">available</font><font color="#CCCCCC"> you can</font><font color="#E5E5E5"> see NFS</font><font color="#CCCCCC"> is available</font>

717
00:35:19,859 --> 00:35:25,119
<font color="#CCCCCC">sometimes you can actually</font><font color="#E5E5E5"> mount an NFS</font>

718
00:35:22,480 --> 00:35:27,220
<font color="#CCCCCC">server</font><font color="#E5E5E5"> on these things to you</font><font color="#CCCCCC"> know take</font>

719
00:35:25,119 --> 00:35:30,430
files off<font color="#CCCCCC"> of them</font><font color="#E5E5E5"> sometimes like it</font>

720
00:35:27,220 --> 00:35:33,009
doesn't work<font color="#CCCCCC"> quite great but I've</font>

721
00:35:30,430 --> 00:35:38,129
definitely seen<font color="#CCCCCC"> that done that and had</font>

722
00:35:33,010 --> 00:35:40,900
some good fun there<font color="#CCCCCC"> this file the</font>

723
00:35:38,130 --> 00:35:45,400
binaries file systems in the mount

724
00:35:40,900 --> 00:35:49,990
structure so we have what we<font color="#CCCCCC"> need</font><font color="#E5E5E5"> now to</font>

725
00:35:45,400 --> 00:35:52,780
<font color="#E5E5E5">go and have some fun</font><font color="#CCCCCC"> so I'm in the I'm</font>

726
00:35:49,990 --> 00:35:55,509
<font color="#E5E5E5">in the temp directory right now we're</font>

727
00:35:52,780 --> 00:36:05,200
gonna<font color="#E5E5E5"> start up a web server over here</font><font color="#CCCCCC"> on</font>

728
00:35:55,510 --> 00:36:09,150
<font color="#CCCCCC">my host operating system</font><font color="#E5E5E5"> and we're gonna</font>

729
00:36:05,200 --> 00:36:09,149
use<font color="#CCCCCC"> W get to pull curl</font><font color="#E5E5E5"> over</font>

730
00:36:20,200 --> 00:36:25,089
<font color="#E5E5E5">okay now we should have cruel on here</font>

731
00:36:22,290 --> 00:36:30,490
<font color="#E5E5E5">kind of changed the execution</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> a</font>

732
00:36:25,089 --> 00:36:31,808
<font color="#E5E5E5">privilege</font><font color="#CCCCCC"> on the binary</font><font color="#E5E5E5"> now now what</font>

733
00:36:30,490 --> 00:36:34,959
should happen is I should<font color="#E5E5E5"> be able to run</font>

734
00:36:31,809 --> 00:36:39,790
this binary<font color="#E5E5E5"> against this web server</font>

735
00:36:34,960 --> 00:36:43,299
<font color="#E5E5E5">that's running over here that I just</font>

736
00:36:39,790 --> 00:36:49,990
<font color="#CCCCCC">used the</font><font color="#E5E5E5"> pull curl with we can</font><font color="#CCCCCC"> actually</font>

737
00:36:43,299 --> 00:36:52,329
<font color="#E5E5E5">just do the index</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we get the stuff in</font>

738
00:36:49,990 --> 00:36:53,770
<font color="#E5E5E5">the things and you can see over</font><font color="#CCCCCC"> on the</font>

739
00:36:52,329 --> 00:36:56,230
<font color="#CCCCCC">right</font><font color="#E5E5E5"> hand side they made the request</font>

740
00:36:53,770 --> 00:36:59,530
<font color="#CCCCCC">now curl does not come on this device by</font>

741
00:36:56,230 --> 00:37:02,349
default I ran compiled curl to be<font color="#E5E5E5"> able</font>

742
00:36:59,530 --> 00:37:03,750
<font color="#E5E5E5">to run it on this device so that's</font>

743
00:37:02,349 --> 00:37:06,369
<font color="#E5E5E5">pretty cool right</font>

744
00:37:03,750 --> 00:37:07,960
<font color="#CCCCCC">no this device already iw get on it it's</font>

745
00:37:06,369 --> 00:37:11,980
<font color="#CCCCCC">not cool at all it's really really</font>

746
00:37:07,960 --> 00:37:16,569
really<font color="#CCCCCC"> stupid so we want to maybe do</font>

747
00:37:11,980 --> 00:37:19,470
something<font color="#E5E5E5"> a</font><font color="#CCCCCC"> little more risque like pull</font>

748
00:37:16,569 --> 00:37:19,470
<font color="#E5E5E5">over in</font><font color="#CCCCCC"> mad</font>

749
00:37:28,460 --> 00:37:33,890
so at this<font color="#E5E5E5"> point now I'm an attacker on</font>

750
00:37:31,310 --> 00:37:40,490
your router that<font color="#E5E5E5"> has in</font><font color="#CCCCCC"> that on your</font>

751
00:37:33,890 --> 00:37:43,129
router<font color="#CCCCCC"> that</font><font color="#E5E5E5"> can be used just first of</font>

752
00:37:40,490 --> 00:37:45,680
<font color="#E5E5E5">all I got a points on now this</font><font color="#CCCCCC"> is in map</font>

753
00:37:43,130 --> 00:37:46,760
<font color="#CCCCCC">7.7 was</font><font color="#E5E5E5"> the least like seven point seven</font>

754
00:37:45,680 --> 00:37:49,279
<font color="#E5E5E5">point zero which</font><font color="#CCCCCC"> is at least like a</font>

755
00:37:46,760 --> 00:37:50,840
month ago<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is running in map four</font>

756
00:37:49,280 --> 00:37:51,410
point five point five four point five

757
00:37:50,840 --> 00:37:55,070
three

758
00:37:51,410 --> 00:37:56,509
it's an ancient version of in map<font color="#E5E5E5"> but it</font>

759
00:37:55,070 --> 00:38:04,990
still does all the stuff<font color="#E5E5E5"> and the things</font>

760
00:37:56,510 --> 00:38:07,430
<font color="#E5E5E5">that we need to do oops</font>

761
00:38:04,990 --> 00:38:09,700
of course<font color="#E5E5E5"> I</font><font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have any of this in my</font>

762
00:38:07,430 --> 00:38:09,700
path

763
00:38:12,810 --> 00:38:20,460
so I can now<font color="#CCCCCC"> port scan your network from</font>

764
00:38:15,960 --> 00:38:22,230
<font color="#E5E5E5">the</font><font color="#CCCCCC"> router and if that if</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> doesn't</font>

765
00:38:20,460 --> 00:38:24,450
<font color="#CCCCCC">seem</font><font color="#E5E5E5"> like a big deal like if you have</font>

766
00:38:22,230 --> 00:38:26,430
<font color="#E5E5E5">anything on</font><font color="#CCCCCC"> your home network that I</font>

767
00:38:24,450 --> 00:38:30,359
mean you can<font color="#E5E5E5"> find a way to get to it now</font>

768
00:38:26,430 --> 00:38:32,279
<font color="#E5E5E5">I mean and you can find other things</font><font color="#CCCCCC"> all</font>

769
00:38:30,360 --> 00:38:33,690
kinds of stuff<font color="#CCCCCC"> just</font><font color="#E5E5E5"> by doing port</font>

770
00:38:32,280 --> 00:38:37,440
scanning and see what else<font color="#E5E5E5"> is accessible</font>

771
00:38:33,690 --> 00:38:40,680
behind the firewall<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is the now when</font>

772
00:38:37,440 --> 00:38:42,840
I say is this cool<font color="#E5E5E5"> this is cool</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

773
00:38:40,680 --> 00:38:45,419
uh this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> a new capability that did not</font>

774
00:38:42,840 --> 00:38:47,730
exist<font color="#E5E5E5"> before on this device</font><font color="#CCCCCC"> that we have</font>

775
00:38:45,420 --> 00:38:50,760
added to<font color="#CCCCCC"> it by</font><font color="#E5E5E5"> using this</font><font color="#CCCCCC"> very</font>

776
00:38:47,730 --> 00:38:54,480
convoluted complex tool chain<font color="#E5E5E5"> that we</font>

777
00:38:50,760 --> 00:38:56,160
got off the<font color="#CCCCCC"> internet so that's pretty</font>

778
00:38:54,480 --> 00:38:57,570
pretty<font color="#E5E5E5"> cool I mean</font><font color="#CCCCCC"> I think that's</font><font color="#E5E5E5"> better</font>

779
00:38:56,160 --> 00:39:00,930
than<font color="#CCCCCC"> curling</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> W</font><font color="#E5E5E5"> get already</font>

780
00:38:57,570 --> 00:39:05,840
existed<font color="#E5E5E5"> so let's take</font><font color="#CCCCCC"> it up to like 11</font>

781
00:39:00,930 --> 00:39:05,839
now let's take over

782
00:39:13,619 --> 00:39:34,329
TCP dump so now if<font color="#E5E5E5"> I run well now</font><font color="#CCCCCC"> uh yes</font>

783
00:39:32,559 --> 00:39:39,480
thank<font color="#CCCCCC"> you very</font><font color="#E5E5E5"> much girls getting to</font>

784
00:39:34,329 --> 00:39:39,480
have<font color="#CCCCCC"> myself thank you very</font><font color="#E5E5E5"> much Andy</font>

785
00:39:48,930 --> 00:39:51,649
<font color="#CCCCCC">mm-hmm</font>

786
00:40:02,650 --> 00:40:09,100
<font color="#E5E5E5">oh hey there's some DNS traffic coming</font>

787
00:40:04,660 --> 00:40:11,230
<font color="#E5E5E5">over your network</font><font color="#CCCCCC"> now this is super cool</font>

788
00:40:09,100 --> 00:40:14,410
because now<font color="#E5E5E5"> now I can see all</font><font color="#CCCCCC"> your</font>

789
00:40:11,230 --> 00:40:19,030
network<font color="#CCCCCC"> traffic</font><font color="#E5E5E5"> so if I come over here</font>

790
00:40:14,410 --> 00:40:28,720
<font color="#CCCCCC">to</font><font color="#E5E5E5"> my browser and hit up the web</font>

791
00:40:19,030 --> 00:40:30,520
interface<font color="#E5E5E5"> for for the router</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> I mean</font>

792
00:40:28,720 --> 00:40:32,859
<font color="#E5E5E5">all the traffic is like you can see poor</font>

793
00:40:30,520 --> 00:40:35,920
ad there<font color="#E5E5E5"> it's dumping all the traffic so</font>

794
00:40:32,860 --> 00:40:41,110
this doesn't<font color="#E5E5E5"> really represent the</font><font color="#CCCCCC"> the</font>

795
00:40:35,920 --> 00:40:44,110
actual you know<font color="#CCCCCC"> TCP body of the request</font>

796
00:40:41,110 --> 00:40:46,510
<font color="#CCCCCC">of the HTTP traffic</font><font color="#E5E5E5"> but you can dump all</font>

797
00:40:44,110 --> 00:40:48,250
<font color="#CCCCCC">that out</font><font color="#E5E5E5"> really easily</font><font color="#CCCCCC"> you can dump it</font>

798
00:40:46,510 --> 00:40:49,590
out to a file on<font color="#E5E5E5"> the file system and</font>

799
00:40:48,250 --> 00:40:52,480
come and<font color="#E5E5E5"> give it every once in a while</font>

800
00:40:49,590 --> 00:40:54,220
<font color="#CCCCCC">you could</font><font color="#E5E5E5"> use net cat and pipe this</font>

801
00:40:52,480 --> 00:40:56,500
<font color="#E5E5E5">output there and send it to</font><font color="#CCCCCC"> a remote</font>

802
00:40:54,220 --> 00:40:58,720
<font color="#E5E5E5">server that way there's a lot of way to</font>

803
00:40:56,500 --> 00:41:03,160
get<font color="#E5E5E5"> this very very sensitive data off</font>

804
00:40:58,720 --> 00:41:05,140
this<font color="#E5E5E5"> device in somewhere</font><font color="#CCCCCC"> else</font><font color="#E5E5E5"> so this is</font>

805
00:41:03,160 --> 00:41:08,080
very cool from<font color="#E5E5E5"> a technical perspective</font>

806
00:41:05,140 --> 00:41:09,339
but from<font color="#E5E5E5"> a perspective of a victim this</font>

807
00:41:08,080 --> 00:41:11,620
<font color="#CCCCCC">is like the worst</font><font color="#E5E5E5"> thing you could</font>

808
00:41:09,340 --> 00:41:14,740
possibly<font color="#E5E5E5"> think of on your home router or</font>

809
00:41:11,620 --> 00:41:17,850
someone who<font color="#E5E5E5"> has installed a TCP dump</font>

810
00:41:14,740 --> 00:41:20,109
<font color="#E5E5E5">compiled for your</font><font color="#CCCCCC"> Lex for processor</font>

811
00:41:17,850 --> 00:41:21,549
<font color="#CCCCCC">monitoring monitoring your traffic you</font>

812
00:41:20,110 --> 00:41:25,570
know a bad actor<font color="#E5E5E5"> doing that that's like</font>

813
00:41:21,550 --> 00:41:28,150
the<font color="#E5E5E5"> worst thing ever</font><font color="#CCCCCC"> so that's</font><font color="#E5E5E5"> basically</font>

814
00:41:25,570 --> 00:41:29,980
my<font color="#E5E5E5"> live demonstration I'm gonna go ahead</font>

815
00:41:28,150 --> 00:41:32,890
and<font color="#E5E5E5"> yeah you can see something</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> the</font>

816
00:41:29,980 --> 00:41:38,050
<font color="#E5E5E5">Apple iPhone traffic</font><font color="#CCCCCC"> cuz I think my my</font>

817
00:41:32,890 --> 00:41:40,089
phone<font color="#CCCCCC"> is connected that</font><font color="#E5E5E5"> Network so I'm</font>

818
00:41:38,050 --> 00:41:42,160
<font color="#E5E5E5">gonna I'm gonna kill</font><font color="#CCCCCC"> that web server</font>

819
00:41:40,090 --> 00:41:45,670
<font color="#E5E5E5">will let the other</font><font color="#CCCCCC"> one run but I wanted</font>

820
00:41:42,160 --> 00:41:49,720
<font color="#E5E5E5">to briefly talk about like next steps</font>

821
00:41:45,670 --> 00:41:52,630
<font color="#E5E5E5">here</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> the limitation on this is that</font>

822
00:41:49,720 --> 00:41:54,819
like<font color="#E5E5E5"> if the device is rebooted or it</font>

823
00:41:52,630 --> 00:41:58,810
otherwise loses power<font color="#E5E5E5"> or whatever you</font>

824
00:41:54,820 --> 00:42:00,430
know<font color="#E5E5E5"> you'll lose like all your binaries</font>

825
00:41:58,810 --> 00:42:02,980
on<font color="#E5E5E5"> here like you saw when I booted this</font>

826
00:42:00,430 --> 00:42:04,839
up and started doing<font color="#CCCCCC"> telenet sessions</font>

827
00:42:02,980 --> 00:42:06,670
none of<font color="#CCCCCC"> this binaries existed</font><font color="#E5E5E5"> I've been</font>

828
00:42:04,840 --> 00:42:08,130
moving<font color="#E5E5E5"> them over all day you know just</font>

829
00:42:06,670 --> 00:42:10,000
every time<font color="#CCCCCC"> this thing powers down</font>

830
00:42:08,130 --> 00:42:12,940
everything in the temp directory goes

831
00:42:10,000 --> 00:42:14,710
away<font color="#CCCCCC"> obviously and since the temp</font>

832
00:42:12,940 --> 00:42:15,940
directory is really the only writable

833
00:42:14,710 --> 00:42:18,609
spot

834
00:42:15,940 --> 00:42:20,650
that's where they have to go so a next

835
00:42:18,609 --> 00:42:26,619
step<font color="#E5E5E5"> in this research which I which</font><font color="#CCCCCC"> I</font>

836
00:42:20,650 --> 00:42:28,150
looked at very briefly<font color="#E5E5E5"> was that</font><font color="#CCCCCC"> company</font>

837
00:42:26,619 --> 00:42:30,549
<font color="#E5E5E5">you can compile your own firmware with a</font>

838
00:42:28,150 --> 00:42:33,250
GPL code compile your own<font color="#E5E5E5"> firmware and</font>

839
00:42:30,549 --> 00:42:36,549
package it<font color="#E5E5E5"> with</font><font color="#CCCCCC"> TCP dump already built</font>

840
00:42:33,250 --> 00:42:38,380
into<font color="#E5E5E5"> it and then flash on the device now</font>

841
00:42:36,549 --> 00:42:41,349
I<font color="#CCCCCC"> couldn't the practical</font><font color="#E5E5E5"> reason why I</font>

842
00:42:38,380 --> 00:42:43,450
couldn't<font color="#E5E5E5"> do that was I've tried messing</font>

843
00:42:41,349 --> 00:42:46,299
around with flashing devices before<font color="#E5E5E5"> and</font>

844
00:42:43,450 --> 00:42:47,710
<font color="#E5E5E5">sometimes the device it's bricked</font><font color="#CCCCCC"> didn't</font>

845
00:42:46,299 --> 00:42:50,950
want to break this guy right<font color="#CCCCCC"> before my</font>

846
00:42:47,710 --> 00:42:53,530
<font color="#E5E5E5">big presentation so I wasn't able to</font>

847
00:42:50,950 --> 00:42:55,899
<font color="#E5E5E5">like start messing around with that</font><font color="#CCCCCC"> but</font>

848
00:42:53,530 --> 00:42:58,240
I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> that's the logical</font><font color="#CCCCCC"> endpoint for</font>

849
00:42:55,900 --> 00:43:00,670
<font color="#E5E5E5">this is having your own firmware you can</font>

850
00:42:58,240 --> 00:43:03,609
compile<font color="#CCCCCC"> using the manufacturer</font><font color="#E5E5E5"> of GPL</font>

851
00:43:00,670 --> 00:43:05,730
code and you know get<font color="#E5E5E5"> somehow</font>

852
00:43:03,609 --> 00:43:08,109
maliciously on to someone's home router

853
00:43:05,730 --> 00:43:27,220
that's<font color="#E5E5E5"> all I've gotten a I know I've</font>

854
00:43:08,109 --> 00:43:29,770
<font color="#E5E5E5">gone pretty close to the time compiler</font>

855
00:43:27,220 --> 00:43:35,980
<font color="#CCCCCC">that</font><font color="#E5E5E5"> you know my processor type so you</font>

856
00:43:29,770 --> 00:43:37,420
know oh no you I mean yeah you<font color="#CCCCCC"> right you</font>

857
00:43:35,980 --> 00:43:39,309
all you need<font color="#E5E5E5"> is the binaries that can</font>

858
00:43:37,420 --> 00:43:42,329
compile them right like<font color="#E5E5E5"> GCC but you</font>

859
00:43:39,309 --> 00:43:42,329
don't need<font color="#E5E5E5"> like</font><font color="#CCCCCC"> their GPL</font>

860
00:43:42,480 --> 00:43:47,589
<font color="#CCCCCC">yes</font><font color="#E5E5E5"> but the</font><font color="#CCCCCC"> toolchain is additionally</font>

861
00:43:45,250 --> 00:43:51,160
included in the GPL stuff<font color="#E5E5E5"> and that</font>

862
00:43:47,589 --> 00:43:55,630
that's what I didn't have the GPL<font color="#CCCCCC"> are</font>

863
00:43:51,160 --> 00:43:57,520
the the<font color="#E5E5E5"> tool chain</font><font color="#CCCCCC"> like yes</font><font color="#E5E5E5"> and that's</font>

864
00:43:55,630 --> 00:43:59,380
what<font color="#E5E5E5"> that</font><font color="#CCCCCC"> can for some reason that's</font>

865
00:43:57,520 --> 00:44:02,380
included<font color="#CCCCCC"> with</font><font color="#E5E5E5"> the GPL code for this</font>

866
00:43:59,380 --> 00:44:04,119
device and that's why that's<font color="#CCCCCC"> how I got</font>

867
00:44:02,380 --> 00:44:06,460
<font color="#E5E5E5">this tool chains from the manufacturer</font>

868
00:44:04,119 --> 00:44:12,849
themself<font color="#E5E5E5"> but you're right you</font><font color="#CCCCCC"> don't need</font>

869
00:44:06,460 --> 00:44:14,890
the<font color="#CCCCCC"> Lynx kernel at all yeah but the</font>

870
00:44:12,849 --> 00:44:16,779
advantage of having all the kernel

871
00:44:14,890 --> 00:44:18,430
source code and all that stuff<font color="#E5E5E5"> is if you</font>

872
00:44:16,779 --> 00:44:20,920
wanted to compile your<font color="#CCCCCC"> own</font><font color="#E5E5E5"> firmware and</font>

873
00:44:18,430 --> 00:44:23,410
<font color="#E5E5E5">bundle that up all the tools to do all</font>

874
00:44:20,920 --> 00:44:25,190
<font color="#E5E5E5">those</font><font color="#CCCCCC"> things are</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> that GPL package so</font>

875
00:44:23,410 --> 00:44:26,899
that's where you<font color="#E5E5E5"> would want to</font>

876
00:44:25,190 --> 00:44:41,660
the<font color="#E5E5E5"> kernel source code and all that</font>

877
00:44:26,900 --> 00:44:44,480
stuff there we go that's<font color="#E5E5E5"> that's where I</font>

878
00:44:41,660 --> 00:44:46,848
was going to talk about the<font color="#CCCCCC"> one</font><font color="#E5E5E5"> I</font>

879
00:44:44,480 --> 00:44:50,660
extract<font color="#E5E5E5"> I downloaded the firmware for</font>

880
00:44:46,849 --> 00:44:56,030
<font color="#E5E5E5">the</font><font color="#CCCCCC"> device I extracted it using bin walk</font>

881
00:44:50,660 --> 00:44:58,009
-<font color="#CCCCCC"> II and yeah well I didn't have to do</font>

882
00:44:56,030 --> 00:44:59,660
that<font color="#E5E5E5"> if L PHP files</font><font color="#CCCCCC"> so I</font><font color="#E5E5E5"> just like I</font>

883
00:44:58,010 --> 00:45:02,539
knew exactly where<font color="#CCCCCC"> it was I just went in</font>

884
00:44:59,660 --> 00:45:03,980
and<font color="#E5E5E5"> found it you know and got it yeah so</font>

885
00:45:02,539 --> 00:45:06,410
that's<font color="#E5E5E5"> that's I meant to go into that</font>

886
00:45:03,980 --> 00:45:11,109
more<font color="#E5E5E5"> but you</font><font color="#CCCCCC"> know that's a good</font><font color="#E5E5E5"> question</font>

887
00:45:06,410 --> 00:45:15,109
<font color="#CCCCCC">do you want another</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> okay</font>

888
00:45:11,109 --> 00:45:17,180
any other questions if you would<font color="#E5E5E5"> like to</font>

889
00:45:15,109 --> 00:45:19,970
get<font color="#E5E5E5"> started on IOT hacking you can come</font>

890
00:45:17,180 --> 00:45:23,450
<font color="#CCCCCC">up and get a</font><font color="#E5E5E5"> kit for free you</font><font color="#CCCCCC"> can have</font>

891
00:45:19,970 --> 00:45:25,069
one yeah and I encourage<font color="#E5E5E5"> you if</font><font color="#CCCCCC"> you find</font>

892
00:45:23,450 --> 00:45:27,319
something<font color="#E5E5E5"> cool come and present on it</font>

893
00:45:25,069 --> 00:45:28,940
<font color="#E5E5E5">next year you know that would be awesome</font>

894
00:45:27,319 --> 00:45:31,099
I'd be an awesome<font color="#E5E5E5"> thing to</font><font color="#CCCCCC"> see is just</font>

895
00:45:28,940 --> 00:45:32,569
you<font color="#E5E5E5"> know the community doing this stuff</font>

896
00:45:31,099 --> 00:45:34,279
and there's still some cool stuff<font color="#CCCCCC"> in</font>

897
00:45:32,569 --> 00:45:37,538
<font color="#CCCCCC">here like</font><font color="#E5E5E5"> there's some crappy stuff in</font>

898
00:45:34,279 --> 00:45:37,539
here too but<font color="#CCCCCC"> there's some cool stuff</font>

899
00:45:52,750 --> 00:45:57,370
it's not the latest<font color="#E5E5E5"> one but this one's</font>

900
00:45:55,900 --> 00:46:00,520
pretty old this one's<font color="#E5E5E5"> probably newest</font>

901
00:45:57,370 --> 00:46:06,390
<font color="#E5E5E5">thing I have that</font><font color="#CCCCCC"> won't</font><font color="#E5E5E5"> be fun to play</font>

902
00:46:00,520 --> 00:46:10,030
<font color="#E5E5E5">with all right thank you</font>

903
00:46:06,390 --> 00:46:10,029
[Applause]

