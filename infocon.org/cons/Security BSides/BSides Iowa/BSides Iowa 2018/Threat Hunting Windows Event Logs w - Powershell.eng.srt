1
00:00:25,110 --> 00:00:29,939
thanks everybody for waiting through my

2
00:00:28,320 --> 00:00:33,450
technical difficulties trying<font color="#CCCCCC"> to get a</font>

3
00:00:29,940 --> 00:00:35,370
display<font color="#E5E5E5"> up and working</font><font color="#CCCCCC"> today I'm going</font>

4
00:00:33,450 --> 00:00:37,670
to<font color="#E5E5E5"> be talking about threat hunting with</font>

5
00:00:35,370 --> 00:00:40,589
event logs in PowerShell

6
00:00:37,670 --> 00:00:42,390
<font color="#CCCCCC">we're pretty much</font><font color="#E5E5E5"> not what I'm</font><font color="#CCCCCC"> looking</font>

7
00:00:40,590 --> 00:00:45,870
at<font color="#E5E5E5"> doing with this talk is looking at</font>

8
00:00:42,390 --> 00:00:47,250
expanding into newer<font color="#CCCCCC"> solutions if you</font>

9
00:00:45,870 --> 00:00:49,890
don't have like<font color="#CCCCCC"> a</font><font color="#E5E5E5"> seam in place that</font>

10
00:00:47,250 --> 00:00:52,050
you're already using<font color="#CCCCCC"> or</font><font color="#E5E5E5"> we're looking to</font>

11
00:00:49,890 --> 00:00:53,930
how to build<font color="#E5E5E5"> upon</font><font color="#CCCCCC"> our existing seams and</font>

12
00:00:52,050 --> 00:00:56,970
<font color="#E5E5E5">put more tools into place to be able to</font>

13
00:00:53,930 --> 00:00:59,070
kind<font color="#CCCCCC"> of tweak those</font><font color="#E5E5E5"> rule sets that we're</font>

14
00:00:56,970 --> 00:01:01,350
using and give better logic and better

15
00:00:59,070 --> 00:01:03,360
things<font color="#E5E5E5"> out of it and then the last</font><font color="#CCCCCC"> thing</font>

16
00:01:01,350 --> 00:01:05,070
<font color="#E5E5E5">is kind of looking at ways that we</font><font color="#CCCCCC"> can</font>

17
00:01:03,360 --> 00:01:06,630
maybe move beyond our critical

18
00:01:05,069 --> 00:01:08,520
infrastructure because a lot of our

19
00:01:06,630 --> 00:01:10,229
monitoring and things like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> we're</font>

20
00:01:08,520 --> 00:01:12,000
only focusing<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the critical</font>

21
00:01:10,229 --> 00:01:17,729
<font color="#E5E5E5">infrastructure we're not really focusing</font>

22
00:01:12,000 --> 00:01:20,160
on the<font color="#E5E5E5"> entire big picture so before we</font>

23
00:01:17,729 --> 00:01:23,340
go down this<font color="#E5E5E5"> hole a little bit about me</font>

24
00:01:20,160 --> 00:01:26,399
<font color="#CCCCCC">my name is</font><font color="#E5E5E5"> Justin Williams</font><font color="#CCCCCC"> I am an</font>

25
00:01:23,340 --> 00:01:29,460
<font color="#CCCCCC">information security professional prior</font>

26
00:01:26,399 --> 00:01:31,170
<font color="#CCCCCC">to</font><font color="#E5E5E5"> that I've worked in numerous</font>

27
00:01:29,460 --> 00:01:33,169
<font color="#CCCCCC">different areas in IT have been in</font>

28
00:01:31,170 --> 00:01:36,409
<font color="#CCCCCC">helpdesk database administration</font>

29
00:01:33,170 --> 00:01:39,000
<font color="#CCCCCC">primarily development</font><font color="#E5E5E5"> I'm an absolute</font>

30
00:01:36,409 --> 00:01:43,770
<font color="#E5E5E5">gigantic fanboy of Microsoft products in</font>

31
00:01:39,000 --> 00:01:45,900
PowerShell<font color="#CCCCCC"> and as a whole and then</font>

32
00:01:43,770 --> 00:01:48,000
currently I just I'm actually three

33
00:01:45,900 --> 00:01:51,810
weeks<font color="#E5E5E5"> into a new managers gig and an</font>

34
00:01:48,000 --> 00:01:54,060
<font color="#E5E5E5">information security role</font><font color="#CCCCCC"> so the other</font>

35
00:01:51,810 --> 00:01:57,150
thing I want to touch on is I am part of

36
00:01:54,060 --> 00:01:58,560
the Omaha wasp<font color="#E5E5E5"> chapter leadership so if</font>

37
00:01:57,150 --> 00:02:00,330
any<font color="#E5E5E5"> of you want to make a trip over</font><font color="#CCCCCC"> to</font>

38
00:01:58,560 --> 00:02:06,680
Omaha and talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> app</font><font color="#CCCCCC"> sec with our</font>

39
00:02:00,330 --> 00:02:10,049
group just reach out<font color="#E5E5E5"> to me</font><font color="#CCCCCC"> all right so</font>

40
00:02:06,680 --> 00:02:13,380
kind<font color="#E5E5E5"> of some of the goals for this talk</font>

41
00:02:10,049 --> 00:02:15,510
is first off and foremost I wanted<font color="#E5E5E5"> to</font>

42
00:02:13,380 --> 00:02:18,000
talk about<font color="#E5E5E5"> where do we look</font><font color="#CCCCCC"> for events</font>

43
00:02:15,510 --> 00:02:22,140
in<font color="#CCCCCC"> Windows</font><font color="#E5E5E5"> and how do we get at</font><font color="#CCCCCC"> that</font>

44
00:02:18,000 --> 00:02:24,000
<font color="#E5E5E5">information what files and things like</font>

45
00:02:22,140 --> 00:02:27,268
that<font color="#E5E5E5"> in logs might be useful to find</font>

46
00:02:24,000 --> 00:02:31,620
information<font color="#E5E5E5"> where can you look to</font>

47
00:02:27,269 --> 00:02:33,420
extract data from<font color="#E5E5E5"> those logs kind of do</font>

48
00:02:31,620 --> 00:02:36,930
a little<font color="#CCCCCC"> bit of an</font><font color="#E5E5E5"> introduction</font><font color="#CCCCCC"> into sis</font>

49
00:02:33,420 --> 00:02:38,640
mine not really a deep dive<font color="#CCCCCC"> but more so</font>

50
00:02:36,930 --> 00:02:39,010
working with the output<font color="#CCCCCC"> that it gives us</font>

51
00:02:38,640 --> 00:02:44,140
after

52
00:02:39,010 --> 00:02:46,030
install it and<font color="#E5E5E5"> we're running it</font><font color="#CCCCCC"> and then</font>

53
00:02:44,140 --> 00:02:47,649
the last thing<font color="#E5E5E5"> is</font><font color="#CCCCCC"> is I</font><font color="#E5E5E5"> want to give</font>

54
00:02:46,030 --> 00:02:49,950
everybody an introduction into

55
00:02:47,650 --> 00:02:53,530
PowerShell<font color="#CCCCCC"> to put everything together</font>

56
00:02:49,950 --> 00:02:56,560
<font color="#E5E5E5">because as I found when administration</font>

57
00:02:53,530 --> 00:02:58,090
and those rules<font color="#E5E5E5"> just adding the tiniest</font>

58
00:02:56,560 --> 00:02:59,290
<font color="#E5E5E5">little bit of scripting like that into</font>

59
00:02:58,090 --> 00:03:01,720
<font color="#CCCCCC">your arsenal kind of makes</font><font color="#E5E5E5"> everything</font>

60
00:02:59,290 --> 00:03:03,340
more powerful and makes you a lot<font color="#E5E5E5"> more</font>

61
00:03:01,720 --> 00:03:07,230
useful<font color="#E5E5E5"> and being able to determine</font>

62
00:03:03,340 --> 00:03:07,230
<font color="#E5E5E5">what's going on in your</font><font color="#CCCCCC"> environment</font><font color="#E5E5E5"> so</font>

63
00:03:07,470 --> 00:03:14,519
<font color="#CCCCCC">first and foremost we're going to look</font>

64
00:03:09,730 --> 00:03:16,629
<font color="#E5E5E5">at what</font><font color="#CCCCCC"> our typical seem scenario is</font>

65
00:03:14,519 --> 00:03:19,810
most of the time we're gonna<font color="#E5E5E5"> be logging</font>

66
00:03:16,629 --> 00:03:24,578
servers work and that that's<font color="#E5E5E5"> pretty much</font>

67
00:03:19,810 --> 00:03:27,280
it<font color="#E5E5E5"> so nothing else workstations are</font>

68
00:03:24,579 --> 00:03:29,920
<font color="#CCCCCC">going to be what's spending most of your</font>

69
00:03:27,280 --> 00:03:31,359
<font color="#E5E5E5">time</font><font color="#CCCCCC"> actually accessing unprotected</font>

70
00:03:29,920 --> 00:03:32,470
areas of the<font color="#CCCCCC"> internet not</font><font color="#E5E5E5"> many people</font>

71
00:03:31,359 --> 00:03:33,670
<font color="#E5E5E5">are going to be surfing the</font><font color="#CCCCCC"> internet on</font>

72
00:03:32,470 --> 00:03:35,409
their servers not many<font color="#CCCCCC"> people are</font><font color="#E5E5E5"> going</font>

73
00:03:33,670 --> 00:03:38,260
to<font color="#E5E5E5"> be downloading</font><font color="#CCCCCC"> malicious</font><font color="#E5E5E5"> tools</font><font color="#CCCCCC"> onto</font>

74
00:03:35,409 --> 00:03:41,019
their servers but your<font color="#CCCCCC"> end-users are</font>

75
00:03:38,260 --> 00:03:42,849
going<font color="#E5E5E5"> to so at most with the</font>

76
00:03:41,019 --> 00:03:44,799
<font color="#E5E5E5">workstations we might be looking</font><font color="#CCCCCC"> at logs</font>

77
00:03:42,849 --> 00:03:46,840
and event logs and<font color="#E5E5E5"> things</font><font color="#CCCCCC"> like that but</font>

78
00:03:44,799 --> 00:03:48,370
what<font color="#E5E5E5"> we're</font><font color="#CCCCCC"> really getting</font><font color="#E5E5E5"> is is we're</font>

79
00:03:46,840 --> 00:03:51,549
getting alerted by our seems that our

80
00:03:48,370 --> 00:03:53,590
AVS<font color="#CCCCCC"> are</font><font color="#E5E5E5"> catching things right</font><font color="#CCCCCC"> so we're</font>

81
00:03:51,549 --> 00:03:57,819
not<font color="#E5E5E5"> getting anything useful out of that</font>

82
00:03:53,590 --> 00:04:03,370
information<font color="#CCCCCC"> other</font><font color="#E5E5E5"> than the system that</font>

83
00:03:57,819 --> 00:04:04,988
<font color="#E5E5E5">we're running is working and then lastly</font>

84
00:04:03,370 --> 00:04:07,629
like just touched on before<font color="#E5E5E5"> with the</font>

85
00:04:04,989 --> 00:04:09,730
critical infrastructure you could in

86
00:04:07,629 --> 00:04:12,638
some instances we're only looking at our

87
00:04:09,730 --> 00:04:16,389
PCI compliance areas right<font color="#CCCCCC"> we're looking</font>

88
00:04:12,639 --> 00:04:18,430
<font color="#CCCCCC">at that's where</font><font color="#E5E5E5"> the money is</font><font color="#CCCCCC"> that's</font>

89
00:04:16,389 --> 00:04:19,989
where<font color="#E5E5E5"> our biggest fines are so that's</font>

90
00:04:18,430 --> 00:04:21,430
where the organization wants to<font color="#E5E5E5"> invest</font>

91
00:04:19,988 --> 00:04:23,888
that's where they want<font color="#E5E5E5"> to protect it so</font>

92
00:04:21,430 --> 00:04:25,389
when you start<font color="#E5E5E5"> looking at your seams and</font>

93
00:04:23,889 --> 00:04:27,190
the licensing costs and<font color="#E5E5E5"> things like that</font>

94
00:04:25,389 --> 00:04:29,380
that<font color="#CCCCCC"> are getting</font><font color="#E5E5E5"> out of</font><font color="#CCCCCC"> control you're</font>

95
00:04:27,190 --> 00:04:32,050
looking at putting your all<font color="#CCCCCC"> of your</font>

96
00:04:29,380 --> 00:04:33,639
costs<font color="#E5E5E5"> into that and then kind of</font>

97
00:04:32,050 --> 00:04:37,510
ignoring<font color="#E5E5E5"> everything else unless it</font>

98
00:04:33,639 --> 00:04:40,419
<font color="#CCCCCC">starts to hit</font><font color="#E5E5E5"> that environment and so</font>

99
00:04:37,510 --> 00:04:42,610
with that this kind<font color="#E5E5E5"> of</font><font color="#CCCCCC"> sum it adds up to</font>

100
00:04:40,419 --> 00:04:46,090
just pretty<font color="#E5E5E5"> much a gigantic</font><font color="#CCCCCC"> failure for</font>

101
00:04:42,610 --> 00:04:48,010
everybody<font color="#CCCCCC"> if you try to catch everything</font>

102
00:04:46,090 --> 00:04:50,830
<font color="#E5E5E5">from the start you end up with too much</font>

103
00:04:48,010 --> 00:04:52,060
<font color="#E5E5E5">data</font><font color="#CCCCCC"> and you're not</font><font color="#E5E5E5"> getting anything</font><font color="#CCCCCC"> any</font>

104
00:04:50,830 --> 00:04:54,669
<font color="#E5E5E5">value</font><font color="#CCCCCC"> out of that</font>

105
00:04:52,060 --> 00:04:56,560
if you're only<font color="#E5E5E5"> looking at PCI</font>

106
00:04:54,670 --> 00:05:00,310
environments<font color="#E5E5E5"> and things like</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you're</font>

107
00:04:56,560 --> 00:05:03,090
not<font color="#E5E5E5"> getting</font><font color="#CCCCCC"> enough data to</font><font color="#E5E5E5"> actually get</font>

108
00:05:00,310 --> 00:05:06,100
a big<font color="#CCCCCC"> picture of your environment and</font>

109
00:05:03,090 --> 00:05:08,469
<font color="#E5E5E5">the last thing is is where this kind of</font>

110
00:05:06,100 --> 00:05:11,200
comes in all together is is the data

111
00:05:08,470 --> 00:05:12,430
<font color="#E5E5E5">that we're getting into</font><font color="#CCCCCC"> if we're getting</font>

112
00:05:11,200 --> 00:05:14,860
too much or<font color="#CCCCCC"> too little</font>

113
00:05:12,430 --> 00:05:18,340
how actionable is that data<font color="#CCCCCC"> we</font><font color="#E5E5E5"> said</font>

114
00:05:14,860 --> 00:05:20,650
we're getting<font color="#E5E5E5"> notified that our next-gen</font>

115
00:05:18,340 --> 00:05:23,859
antivirus is<font color="#CCCCCC"> taught</font><font color="#E5E5E5"> is stopping</font>

116
00:05:20,650 --> 00:05:26,560
something<font color="#E5E5E5"> but we have users on</font><font color="#CCCCCC"> our</font>

117
00:05:23,860 --> 00:05:29,080
network<font color="#CCCCCC"> that our front end users</font><font color="#E5E5E5"> they</font>

118
00:05:26,560 --> 00:05:32,950
are admin users that are explicitly

119
00:05:29,080 --> 00:05:34,210
calling wmic<font color="#E5E5E5"> or PS exec and moving</font>

120
00:05:32,950 --> 00:05:36,099
laterally<font color="#CCCCCC"> across the network when they</font>

121
00:05:34,210 --> 00:05:37,690
really shouldn't<font color="#CCCCCC"> be using those</font><font color="#E5E5E5"> and</font>

122
00:05:36,100 --> 00:05:42,870
we're not<font color="#E5E5E5"> seeing things like that</font>

123
00:05:37,690 --> 00:05:46,030
<font color="#CCCCCC">necessarily through those products so</font>

124
00:05:42,870 --> 00:05:49,360
kind of starting out with this<font color="#E5E5E5"> want to</font>

125
00:05:46,030 --> 00:05:51,789
look at the<font color="#E5E5E5"> windows event logs and some</font>

126
00:05:49,360 --> 00:05:53,830
<font color="#E5E5E5">of the some</font><font color="#CCCCCC"> of the ways to look</font><font color="#E5E5E5"> at what</font>

127
00:05:51,790 --> 00:05:55,930
would be<font color="#CCCCCC"> built-in functionality that</font>

128
00:05:53,830 --> 00:05:57,609
would exist without having to install

129
00:05:55,930 --> 00:06:00,610
any additional<font color="#E5E5E5"> components to be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

130
00:05:57,610 --> 00:06:03,100
<font color="#E5E5E5">maybe find some information first and</font>

131
00:06:00,610 --> 00:06:05,290
<font color="#E5E5E5">foremost is the system the system event</font>

132
00:06:03,100 --> 00:06:07,180
log<font color="#CCCCCC"> that's typically</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> give you</font>

133
00:06:05,290 --> 00:06:09,190
<font color="#E5E5E5">things like service information service</font>

134
00:06:07,180 --> 00:06:12,070
installation<font color="#E5E5E5"> information what status it</font>

135
00:06:09,190 --> 00:06:15,100
is<font color="#CCCCCC"> and you might get some</font><font color="#E5E5E5"> windows update</font>

136
00:06:12,070 --> 00:06:19,450
information<font color="#CCCCCC"> out of</font><font color="#E5E5E5"> that as well the next</font>

137
00:06:15,100 --> 00:06:22,840
<font color="#CCCCCC">one is the application log we'll see</font>

138
00:06:19,450 --> 00:06:25,930
things<font color="#E5E5E5"> like</font><font color="#CCCCCC"> install events and then</font>

139
00:06:22,840 --> 00:06:27,729
you'll see<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> your security events</font>

140
00:06:25,930 --> 00:06:29,380
and window<font color="#E5E5E5"> and antivirus events will</font>

141
00:06:27,730 --> 00:06:33,610
<font color="#E5E5E5">actually log into</font><font color="#CCCCCC"> the application lock</font>

142
00:06:29,380 --> 00:06:35,230
system log and then the last<font color="#E5E5E5"> one is the</font>

143
00:06:33,610 --> 00:06:37,450
<font color="#E5E5E5">security log is pretty much the next</font>

144
00:06:35,230 --> 00:06:41,650
<font color="#E5E5E5">where next place to look at for</font><font color="#CCCCCC"> all your</font>

145
00:06:37,450 --> 00:06:42,909
all<font color="#CCCCCC"> your information it's where pretty</font>

146
00:06:41,650 --> 00:06:44,620
<font color="#E5E5E5">much the bread-and-butter</font><font color="#CCCCCC"> for everything</font>

147
00:06:42,910 --> 00:06:45,700
on<font color="#CCCCCC"> your</font><font color="#E5E5E5"> own that system is going to be</font>

148
00:06:44,620 --> 00:06:47,410
that's<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> give you things like</font>

149
00:06:45,700 --> 00:06:49,719
<font color="#CCCCCC">your logged on events</font><font color="#E5E5E5"> who's logging</font><font color="#CCCCCC"> into</font>

150
00:06:47,410 --> 00:06:51,670
<font color="#CCCCCC">in and out of the system it'll give you</font>

151
00:06:49,720 --> 00:06:53,680
auditing process<font color="#CCCCCC"> creation process</font>

152
00:06:51,670 --> 00:06:55,480
termination things like that<font color="#E5E5E5"> are all</font>

153
00:06:53,680 --> 00:06:58,050
going<font color="#E5E5E5"> to be contained within within the</font>

154
00:06:55,480 --> 00:06:58,050
security log

155
00:06:59,169 --> 00:07:07,120
so kind of when I first started out in

156
00:07:03,280 --> 00:07:15,520
IT<font color="#E5E5E5"> I started looking at</font><font color="#CCCCCC"> my window or at</font>

157
00:07:07,120 --> 00:07:19,449
my event logs<font color="#E5E5E5"> and everybody probably</font>

158
00:07:15,520 --> 00:07:21,580
recognizes Event Viewer<font color="#E5E5E5"> right so the</font>

159
00:07:19,449 --> 00:07:30,939
<font color="#E5E5E5">thing about this is it's hard to get</font>

160
00:07:21,580 --> 00:07:33,279
actionable data out of Event Viewer<font color="#E5E5E5"> when</font>

161
00:07:30,939 --> 00:07:36,550
it's pretty<font color="#CCCCCC"> much going</font><font color="#E5E5E5"> through each</font>

162
00:07:33,279 --> 00:07:38,050
thing step by step and<font color="#E5E5E5"> then each</font><font color="#CCCCCC"> message</font>

163
00:07:36,550 --> 00:07:41,400
things like that are gonna<font color="#E5E5E5"> be kind</font><font color="#CCCCCC"> of</font>

164
00:07:38,050 --> 00:07:43,990
kind of different<font color="#E5E5E5"> within</font><font color="#CCCCCC"> the environment</font>

165
00:07:41,400 --> 00:07:46,359
<font color="#E5E5E5">between depending upon which log you're</font>

166
00:07:43,990 --> 00:07:49,419
looking at so it's hard<font color="#E5E5E5"> to get good</font>

167
00:07:46,360 --> 00:07:52,930
things<font color="#E5E5E5"> it's scale to do your collaborate</font>

168
00:07:49,419 --> 00:07:53,909
your event<font color="#CCCCCC"> correlation and things like</font>

169
00:07:52,930 --> 00:08:01,110
that

170
00:07:53,909 --> 00:08:01,110
<font color="#CCCCCC">so</font><font color="#E5E5E5"> where that's changed with this</font>

171
00:08:09,990 --> 00:08:15,780
is you can<font color="#E5E5E5"> start getting at</font><font color="#CCCCCC"> that</font>

172
00:08:13,020 --> 00:08:19,530
information<font color="#CCCCCC"> using PowerShell a lot</font>

173
00:08:15,780 --> 00:08:21,030
easier<font color="#CCCCCC"> if you look at there's one</font>

174
00:08:19,530 --> 00:08:23,969
command<font color="#E5E5E5"> there's actually two commandlets</font>

175
00:08:21,030 --> 00:08:26,969
one<font color="#CCCCCC"> we'll talk about right now get event</font>

176
00:08:23,970 --> 00:08:29,130
log is going to be problem for looking

177
00:08:26,970 --> 00:08:31,590
at<font color="#E5E5E5"> your basic system</font><font color="#CCCCCC"> information you can</font>

178
00:08:29,130 --> 00:08:37,230
use<font color="#E5E5E5"> this to get to get at that stuff</font>

179
00:08:31,590 --> 00:08:39,510
<font color="#E5E5E5">directly</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> PowerShell the you can</font>

180
00:08:37,230 --> 00:08:42,539
use different<font color="#CCCCCC"> filters you can you can</font>

181
00:08:39,510 --> 00:08:45,900
query things by type using it<font color="#CCCCCC"> and then</font>

182
00:08:42,539 --> 00:08:47,699
you can<font color="#E5E5E5"> look by source log and then I'll</font>

183
00:08:45,900 --> 00:08:49,829
talk about<font color="#E5E5E5"> it a little bit later more</font>

184
00:08:47,700 --> 00:08:51,210
<font color="#CCCCCC">in-depth but you can take the output of</font>

185
00:08:49,830 --> 00:08:52,710
<font color="#E5E5E5">it with the thing that's nice about</font>

186
00:08:51,210 --> 00:08:54,510
PowerShell is the output of everything

187
00:08:52,710 --> 00:08:56,520
is a custom object<font color="#CCCCCC"> or it's an</font><font color="#E5E5E5"> object and</font>

188
00:08:54,510 --> 00:08:58,260
then<font color="#CCCCCC"> you can format that to</font><font color="#E5E5E5"> create a</font>

189
00:08:56,520 --> 00:09:01,800
custom object<font color="#E5E5E5"> so when you start wanting</font>

190
00:08:58,260 --> 00:09:04,740
<font color="#E5E5E5">to analyze and move the data</font><font color="#CCCCCC"> around you</font>

191
00:09:01,800 --> 00:09:08,250
can take<font color="#CCCCCC"> the</font><font color="#E5E5E5"> message if you like with</font>

192
00:09:04,740 --> 00:09:10,830
the event messages<font color="#E5E5E5"> you can take if you</font>

193
00:09:08,250 --> 00:09:13,230
know the specific ID you can enumerate

194
00:09:10,830 --> 00:09:14,700
through that to create<font color="#CCCCCC"> an object that</font>

195
00:09:13,230 --> 00:09:20,100
you<font color="#CCCCCC"> can</font><font color="#E5E5E5"> put into</font><font color="#CCCCCC"> someplace that you</font><font color="#E5E5E5"> can</font>

196
00:09:14,700 --> 00:09:21,720
then have better analytics against<font color="#E5E5E5"> the</font>

197
00:09:20,100 --> 00:09:24,900
only<font color="#E5E5E5"> thing with</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> is is when we talk</font>

198
00:09:21,720 --> 00:09:31,140
about<font color="#E5E5E5"> the original system logs that kind</font>

199
00:09:24,900 --> 00:09:33,030
of going over<font color="#E5E5E5"> now the discrepancies</font>

200
00:09:31,140 --> 00:09:37,520
between<font color="#E5E5E5"> the formatting and between the</font>

201
00:09:33,030 --> 00:09:37,520
types<font color="#E5E5E5"> of messages do exist so</font>

202
00:09:45,510 --> 00:09:57,269
so what you'll see<font color="#E5E5E5"> is the message itself</font>

203
00:09:54,589 --> 00:10:00,540
is this right<font color="#CCCCCC"> there's gonna</font><font color="#E5E5E5"> be right</font>

204
00:09:57,269 --> 00:10:02,579
here<font color="#CCCCCC"> each new line and the typical</font>

205
00:10:00,540 --> 00:10:04,829
message is terminated just with the with

206
00:10:02,579 --> 00:10:06,569
a new line<font color="#E5E5E5"> terminator but when you look</font>

207
00:10:04,829 --> 00:10:08,729
at the message between<font color="#E5E5E5"> the application</font>

208
00:10:06,570 --> 00:10:11,220
<font color="#E5E5E5">log between the system log between the</font>

209
00:10:08,730 --> 00:10:12,630
security<font color="#CCCCCC"> log each one's going donessa</font>

210
00:10:11,220 --> 00:10:14,880
not necessarily going to be formatted

211
00:10:12,630 --> 00:10:17,100
<font color="#CCCCCC">exactly the same so you</font><font color="#E5E5E5"> can't just take</font>

212
00:10:14,880 --> 00:10:22,100
<font color="#CCCCCC">a generic and build the object</font><font color="#E5E5E5"> out that</font>

213
00:10:17,100 --> 00:10:22,100
way<font color="#CCCCCC"> so</font><font color="#E5E5E5"> lame</font>

214
00:10:25,970 --> 00:10:30,410
the best example is<font color="#E5E5E5"> gonna be when you</font>

215
00:10:28,470 --> 00:10:38,160
<font color="#E5E5E5">start</font><font color="#CCCCCC"> getting</font><font color="#E5E5E5"> into your security events</font>

216
00:10:30,410 --> 00:10:51,779
and as you<font color="#E5E5E5"> can</font><font color="#CCCCCC"> see this is the message</font>

217
00:10:38,160 --> 00:10:55,589
<font color="#E5E5E5">here it's gonna be</font><font color="#CCCCCC"> mine itself is going</font>

218
00:10:51,779 --> 00:10:56,639
to<font color="#E5E5E5"> be a new event so when you start</font>

219
00:10:55,589 --> 00:10:59,190
getting<font color="#E5E5E5"> into some</font><font color="#CCCCCC"> of the formatting</font>

220
00:10:56,639 --> 00:11:01,680
<font color="#E5E5E5">things like that that's where it starts</font>

221
00:10:59,190 --> 00:11:04,350
to become a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> difficult to</font>

222
00:11:01,680 --> 00:11:07,260
<font color="#CCCCCC">work with one of the things that</font><font color="#E5E5E5"> I've</font>

223
00:11:04,350 --> 00:11:10,620
found<font color="#E5E5E5"> is if</font><font color="#CCCCCC"> you take</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> output</font><font color="#E5E5E5"> and you</font>

224
00:11:07,260 --> 00:11:12,149
do a<font color="#E5E5E5"> split on the new line and build an</font>

225
00:11:10,620 --> 00:11:13,680
array out of it and then look<font color="#CCCCCC"> through</font>

226
00:11:12,149 --> 00:11:15,630
that knowing where the<font color="#CCCCCC"> end from which</font>

227
00:11:13,680 --> 00:11:17,579
part<font color="#CCCCCC"> of the array</font><font color="#E5E5E5"> the information is</font>

228
00:11:15,630 --> 00:11:20,250
<font color="#E5E5E5">that you want to get at you'll start</font>

229
00:11:17,579 --> 00:11:22,589
seeing<font color="#E5E5E5"> you'll you can start querying the</font>

230
00:11:20,250 --> 00:11:30,930
data a<font color="#E5E5E5"> little bit eat a little bit more</font>

231
00:11:22,589 --> 00:11:32,279
easy<font color="#CCCCCC"> and that's where doing the things</font>

232
00:11:30,930 --> 00:11:33,420
like<font color="#E5E5E5"> building the custom objects and</font>

233
00:11:32,279 --> 00:11:35,810
<font color="#E5E5E5">things like that will really start to</font>

234
00:11:33,420 --> 00:11:35,810
<font color="#E5E5E5">help you</font>

235
00:11:38,380 --> 00:11:42,790
so going<font color="#E5E5E5"> back</font><font color="#CCCCCC"> to a slideshow</font>

236
00:11:46,370 --> 00:11:49,819
and then the last thing and the<font color="#E5E5E5"> other</font>

237
00:11:48,290 --> 00:11:52,819
reason<font color="#E5E5E5"> why I like working with</font>

238
00:11:49,819 --> 00:11:54,889
<font color="#E5E5E5">PowerShell becomes a lot better than</font>

239
00:11:52,819 --> 00:11:57,019
just<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> things like within the Event</font>

240
00:11:54,889 --> 00:12:01,850
Viewer<font color="#E5E5E5"> is</font><font color="#CCCCCC"> because of the commute the</font>

241
00:11:57,019 --> 00:12:06,139
computer<font color="#CCCCCC"> name switch</font><font color="#E5E5E5"> you start being</font>

242
00:12:01,850 --> 00:12:09,290
<font color="#E5E5E5">able to see your correlation that way</font><font color="#CCCCCC"> if</font>

243
00:12:06,139 --> 00:12:11,209
I want to run a command on once if I see

244
00:12:09,290 --> 00:12:15,290
something<font color="#CCCCCC"> like PS</font><font color="#E5E5E5"> exec being ran on one</font>

245
00:12:11,209 --> 00:12:17,660
<font color="#E5E5E5">system if anybody's familiar with a</font>

246
00:12:15,290 --> 00:12:19,969
<font color="#E5E5E5">Japanese cert they did a manual about</font>

247
00:12:17,660 --> 00:12:22,219
lateral<font color="#E5E5E5"> movement techniques and you can</font>

248
00:12:19,970 --> 00:12:25,189
and get event correlation<font color="#E5E5E5"> so you can see</font>

249
00:12:22,220 --> 00:12:26,809
things like<font color="#E5E5E5"> if PS exec is ran</font><font color="#CCCCCC"> on one</font>

250
00:12:25,189 --> 00:12:28,339
system<font color="#CCCCCC"> what's it going to look like</font>

251
00:12:26,809 --> 00:12:30,410
<font color="#E5E5E5">what's it going to do on the</font><font color="#CCCCCC"> other</font><font color="#E5E5E5"> host</font>

252
00:12:28,339 --> 00:12:31,639
<font color="#E5E5E5">so you can start you see it on one</font>

253
00:12:30,410 --> 00:12:34,249
<font color="#E5E5E5">system you can use the computer name</font>

254
00:12:31,639 --> 00:12:36,019
switch to then crawl your network<font color="#E5E5E5"> look</font>

255
00:12:34,249 --> 00:12:40,639
for all systems on your<font color="#E5E5E5"> domain and see</font>

256
00:12:36,019 --> 00:12:44,569
where it was<font color="#E5E5E5"> executed and on the other</font>

257
00:12:40,639 --> 00:12:48,189
system so you<font color="#E5E5E5"> can do that with the with</font>

258
00:12:44,569 --> 00:12:50,479
we said this Japanese<font color="#E5E5E5"> cert manual or</font>

259
00:12:48,189 --> 00:12:53,719
<font color="#E5E5E5">minor attacks framework you can use</font>

260
00:12:50,480 --> 00:12:55,819
known indicators through that as<font color="#E5E5E5"> well to</font>

261
00:12:53,720 --> 00:12:58,069
be able<font color="#E5E5E5"> to detect lateral movement that</font>

262
00:12:55,819 --> 00:13:04,550
you<font color="#CCCCCC"> may be missing through your seam and</font>

263
00:12:58,069 --> 00:13:06,939
other tools<font color="#CCCCCC"> that you have so the last</font>

264
00:13:04,550 --> 00:13:13,189
thing<font color="#E5E5E5"> within the windows logs is the</font>

265
00:13:06,939 --> 00:13:15,319
<font color="#CCCCCC">windows event forwarding that if you</font>

266
00:13:13,189 --> 00:13:17,360
have the<font color="#E5E5E5"> ability to it's</font><font color="#CCCCCC"> actually a</font>

267
00:13:15,319 --> 00:13:18,800
<font color="#CCCCCC">built-in centralized logging solution</font>

268
00:13:17,360 --> 00:13:22,970
and<font color="#E5E5E5"> windows that not a lot</font><font color="#CCCCCC"> of people are</font>

269
00:13:18,800 --> 00:13:27,170
using<font color="#E5E5E5"> just a campaign put together an</font>

270
00:13:22,970 --> 00:13:29,300
<font color="#CCCCCC">article in 2015 if you search for her</font>

271
00:13:27,170 --> 00:13:30,679
and monitoring<font color="#CCCCCC"> what matters</font><font color="#E5E5E5"> it'll give</font>

272
00:13:29,300 --> 00:13:33,800
you you'll be able<font color="#E5E5E5"> to find</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> article</font>

273
00:13:30,679 --> 00:13:35,870
<font color="#E5E5E5">on the</font><font color="#CCCCCC"> TechNet site and in summary it</font>

274
00:13:33,800 --> 00:13:38,300
talks about even if you are using a

275
00:13:35,870 --> 00:13:40,279
<font color="#CCCCCC">scene</font><font color="#E5E5E5"> that this information could be</font>

276
00:13:38,300 --> 00:13:41,660
bent<font color="#E5E5E5"> this could be beneficial to your</font>

277
00:13:40,279 --> 00:13:42,860
environments because of the systems that

278
00:13:41,660 --> 00:13:45,499
you're not catching<font color="#E5E5E5"> it gives you a</font>

279
00:13:42,860 --> 00:13:48,529
centralized area<font color="#E5E5E5"> to look at so instead</font>

280
00:13:45,499 --> 00:13:50,480
of having to see that it's<font color="#CCCCCC"> see something</font>

281
00:13:48,529 --> 00:13:52,939
in the<font color="#E5E5E5"> event and then crawl your network</font>

282
00:13:50,480 --> 00:13:54,439
looking for that data<font color="#CCCCCC"> that's all in a</font>

283
00:13:52,939 --> 00:13:58,790
centralized location so you see the

284
00:13:54,439 --> 00:13:59,630
event fire and in the<font color="#CCCCCC"> log</font><font color="#E5E5E5"> you can also</font>

285
00:13:58,790 --> 00:14:01,939
look for<font color="#CCCCCC"> the</font>

286
00:13:59,630 --> 00:14:03,410
corresponding<font color="#CCCCCC"> event for and the</font>

287
00:14:01,940 --> 00:14:10,730
different system<font color="#CCCCCC"> that it ran on at that</font>

288
00:14:03,410 --> 00:14:13,130
point<font color="#E5E5E5"> and then the other benefit</font><font color="#CCCCCC"> to the</font>

289
00:14:10,730 --> 00:14:14,510
<font color="#CCCCCC">windows event</font><font color="#E5E5E5"> forwarding is is</font><font color="#CCCCCC"> that when</font>

290
00:14:13,130 --> 00:14:16,670
you're first<font color="#E5E5E5"> setting it up when we</font><font color="#CCCCCC"> talk</font>

291
00:14:14,510 --> 00:14:19,250
<font color="#CCCCCC">about that</font><font color="#E5E5E5"> information overload you can</font>

292
00:14:16,670 --> 00:14:21,890
select what you<font color="#E5E5E5"> want to be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to put</font>

293
00:14:19,250 --> 00:14:23,750
<font color="#E5E5E5">into the law so if you</font><font color="#CCCCCC"> want</font><font color="#E5E5E5"> to only</font>

294
00:14:21,890 --> 00:14:25,880
<font color="#E5E5E5">focus on your user tracking events you</font>

295
00:14:23,750 --> 00:14:28,190
can do that<font color="#E5E5E5"> if you only want to</font><font color="#CCCCCC"> look at</font>

296
00:14:25,880 --> 00:14:30,200
the process events and look at what's

297
00:14:28,190 --> 00:14:31,700
being what processes<font color="#E5E5E5"> are</font><font color="#CCCCCC"> running</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> your</font>

298
00:14:30,200 --> 00:14:34,250
networks you can<font color="#CCCCCC"> do that</font><font color="#E5E5E5"> as well and</font>

299
00:14:31,700 --> 00:14:36,560
it's a great<font color="#CCCCCC"> way for you to be able</font><font color="#E5E5E5"> to</font>

300
00:14:34,250 --> 00:14:40,130
look at<font color="#CCCCCC"> everything without</font><font color="#E5E5E5"> being</font>

301
00:14:36,560 --> 00:14:41,540
<font color="#E5E5E5">overloaded on the amount of data that's</font>

302
00:14:40,130 --> 00:14:45,490
<font color="#E5E5E5">coming through and trying to make sense</font>

303
00:14:41,540 --> 00:14:45,490
<font color="#E5E5E5">of all</font><font color="#CCCCCC"> of that at the exact same time so</font>

304
00:14:46,450 --> 00:14:52,310
<font color="#CCCCCC">with that that kind</font><font color="#E5E5E5"> of leads me into a</font>

305
00:14:49,370 --> 00:14:54,620
little bit<font color="#E5E5E5"> more talking</font><font color="#CCCCCC"> about sis Mon</font>

306
00:14:52,310 --> 00:14:58,160
and adding that<font color="#CCCCCC"> into this type of</font>

307
00:14:54,620 --> 00:15:01,220
<font color="#E5E5E5">framework</font><font color="#CCCCCC"> it's been around</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> quite a</font>

308
00:14:58,160 --> 00:15:04,010
while<font color="#CCCCCC"> it's part of the SIS internal</font>

309
00:15:01,220 --> 00:15:06,740
suite of apps<font color="#E5E5E5"> and when you start getting</font>

310
00:15:04,010 --> 00:15:09,830
<font color="#E5E5E5">into</font><font color="#CCCCCC"> vlogging</font><font color="#E5E5E5"> specific types of events</font>

311
00:15:06,740 --> 00:15:12,170
it's incredibly<font color="#E5E5E5"> useful for</font><font color="#CCCCCC"> that there's</font>

312
00:15:09,830 --> 00:15:15,790
quite a bit of<font color="#CCCCCC"> information out</font><font color="#E5E5E5"> there in</font>

313
00:15:12,170 --> 00:15:18,319
and<font color="#E5E5E5"> around it</font><font color="#CCCCCC"> and in my experience</font>

314
00:15:15,790 --> 00:15:19,969
<font color="#E5E5E5">working with it the general purpose of</font>

315
00:15:18,320 --> 00:15:21,530
like the events are all standardized

316
00:15:19,970 --> 00:15:24,920
<font color="#E5E5E5">into the same type of a message output</font>

317
00:15:21,530 --> 00:15:26,510
so<font color="#E5E5E5"> we don't start running</font><font color="#CCCCCC"> into the same</font>

318
00:15:24,920 --> 00:15:27,920
type of<font color="#CCCCCC"> scenario that I was talking</font>

319
00:15:26,510 --> 00:15:29,569
<font color="#CCCCCC">about with</font><font color="#E5E5E5"> the system and event logs</font>

320
00:15:27,920 --> 00:15:31,310
where every message<font color="#E5E5E5"> is different</font><font color="#CCCCCC"> you can</font>

321
00:15:29,570 --> 00:15:32,870
start parsing<font color="#CCCCCC"> those</font><font color="#E5E5E5"> messages as</font><font color="#CCCCCC"> they</font>

322
00:15:31,310 --> 00:15:35,270
come in and they're<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> same format</font>

323
00:15:32,870 --> 00:15:38,840
<font color="#CCCCCC">so once you</font><font color="#E5E5E5"> kind of have your</font><font color="#CCCCCC"> object</font>

324
00:15:35,270 --> 00:15:40,340
<font color="#E5E5E5">output to work with it's</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> same format</font>

325
00:15:38,840 --> 00:15:42,800
pretty much for all<font color="#CCCCCC"> the</font><font color="#E5E5E5"> events</font><font color="#CCCCCC"> that are</font>

326
00:15:40,340 --> 00:15:45,260
<font color="#CCCCCC">firing there might be</font><font color="#E5E5E5"> each event is</font>

327
00:15:42,800 --> 00:15:49,060
standardized by it but<font color="#E5E5E5"> the way that the</font>

328
00:15:45,260 --> 00:15:49,060
type is you can build objects on the fly

329
00:15:49,540 --> 00:15:54,920
and<font color="#E5E5E5"> then some of</font><font color="#CCCCCC"> that may seem like</font>

330
00:15:53,180 --> 00:15:58,969
duplication with the system and<font color="#E5E5E5"> security</font>

331
00:15:54,920 --> 00:16:01,189
logs<font color="#CCCCCC"> and while it</font><font color="#E5E5E5"> might</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> there's</font>

332
00:15:58,970 --> 00:16:03,650
<font color="#E5E5E5">additional it more advanced information</font>

333
00:16:01,190 --> 00:16:05,270
<font color="#CCCCCC">that you can get out of</font><font color="#E5E5E5"> it that</font><font color="#CCCCCC"> you</font>

334
00:16:03,650 --> 00:16:10,520
might<font color="#E5E5E5"> not necessarily catch things like</font>

335
00:16:05,270 --> 00:16:12,860
process<font color="#E5E5E5"> hooking and then you can even</font>

336
00:16:10,520 --> 00:16:13,520
take<font color="#E5E5E5"> it one step further by putting out</font>

337
00:16:12,860 --> 00:16:16,400
so there

338
00:16:13,520 --> 00:16:19,069
some great<font color="#E5E5E5"> articles in and around</font>

339
00:16:16,400 --> 00:16:23,150
filtering it<font color="#E5E5E5"> Swiss</font><font color="#CCCCCC"> alone</font><font color="#E5E5E5"> security puts</font>

340
00:16:19,070 --> 00:16:28,780
out the decent<font color="#CCCCCC"> security</font><font color="#E5E5E5"> on their site</font>

341
00:16:23,150 --> 00:16:31,430
<font color="#E5E5E5">for decent security</font><font color="#CCCCCC"> comm they put out a</font>

342
00:16:28,780 --> 00:16:32,990
XML file that<font color="#CCCCCC"> you can load in for</font><font color="#E5E5E5"> the</font>

343
00:16:31,430 --> 00:16:35,479
<font color="#E5E5E5">configuration</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> will kind of filter</font>

344
00:16:32,990 --> 00:16:40,850
out<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> the duplicate things Mathieu</font>

345
00:16:35,480 --> 00:16:42,860
<font color="#CCCCCC">Graber</font><font color="#E5E5E5"> puts out a lot</font><font color="#CCCCCC"> or he did a great</font>

346
00:16:40,850 --> 00:16:47,570
write-up on the<font color="#CCCCCC"> spectra</font><font color="#E5E5E5"> office blog</font>

347
00:16:42,860 --> 00:16:49,610
<font color="#E5E5E5">talking about how he uses or how he</font>

348
00:16:47,570 --> 00:16:53,510
actually<font color="#E5E5E5"> builds custom configurations</font>

349
00:16:49,610 --> 00:16:55,310
<font color="#E5E5E5">within system on as well and then last</font>

350
00:16:53,510 --> 00:16:57,260
one<font color="#E5E5E5"> would</font><font color="#CCCCCC"> be Carlos</font><font color="#E5E5E5"> Perez is constantly</font>

351
00:16:55,310 --> 00:17:01,579
writing<font color="#E5E5E5"> new and updated articles in and</font>

352
00:16:57,260 --> 00:17:05,240
<font color="#E5E5E5">around it as</font><font color="#CCCCCC"> well so</font><font color="#E5E5E5"> when you</font><font color="#CCCCCC"> install it</font>

353
00:17:01,580 --> 00:17:08,480
<font color="#E5E5E5">you're just going to download it from</font>

354
00:17:05,240 --> 00:17:12,440
<font color="#E5E5E5">this internal site on Microsoft site</font><font color="#CCCCCC"> and</font>

355
00:17:08,480 --> 00:17:14,540
then you'll<font color="#E5E5E5"> just run it with a - I</font>

356
00:17:12,440 --> 00:17:15,890
switch<font color="#E5E5E5"> and</font><font color="#CCCCCC"> that will install it runs as</font>

357
00:17:14,540 --> 00:17:19,459
a service on the system<font color="#CCCCCC"> that you're</font>

358
00:17:15,890 --> 00:17:20,810
running<font color="#E5E5E5"> it on and you have to be an</font>

359
00:17:19,459 --> 00:17:23,800
<font color="#E5E5E5">administrator to be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to install</font><font color="#CCCCCC"> it</font>

360
00:17:20,810 --> 00:17:28,639
<font color="#E5E5E5">or or</font><font color="#CCCCCC"> maaan it modify it</font><font color="#E5E5E5"> on the system</font>

361
00:17:23,800 --> 00:17:31,120
<font color="#CCCCCC">I'm</font><font color="#E5E5E5"> starting out and then like so you</font>

362
00:17:28,640 --> 00:17:34,250
can<font color="#CCCCCC"> from the configuration</font><font color="#E5E5E5"> standpoint</font>

363
00:17:31,120 --> 00:17:35,780
you can centralized or decentralized the

364
00:17:34,250 --> 00:17:37,010
configuration files<font color="#E5E5E5"> and that's kind of a</font>

365
00:17:35,780 --> 00:17:38,710
choose-your-own-adventure on how you

366
00:17:37,010 --> 00:17:42,980
want to do that

367
00:17:38,710 --> 00:17:47,810
you can there's pluses<font color="#E5E5E5"> and minuses to</font>

368
00:17:42,980 --> 00:17:49,220
both<font color="#E5E5E5"> either</font><font color="#CCCCCC"> way like one</font><font color="#E5E5E5"> I've seen it</font>

369
00:17:47,810 --> 00:17:51,500
pushed out there<font color="#CCCCCC"> doop through group</font>

370
00:17:49,220 --> 00:17:53,270
policy<font color="#CCCCCC"> to each individual system</font><font color="#E5E5E5"> and</font>

371
00:17:51,500 --> 00:17:55,460
then<font color="#E5E5E5"> I've seen</font><font color="#CCCCCC"> it where</font><font color="#E5E5E5"> people talk</font>

372
00:17:53,270 --> 00:17:57,139
about<font color="#E5E5E5"> just having a file share that all</font>

373
00:17:55,460 --> 00:18:00,070
<font color="#E5E5E5">systems access with the config file</font>

374
00:17:57,140 --> 00:18:00,070
loaded within<font color="#E5E5E5"> that</font>

375
00:18:03,090 --> 00:18:06,080
so

376
00:18:20,909 --> 00:18:24,979
doing the same<font color="#CCCCCC"> thing with</font><font color="#E5E5E5"> PowerShell</font>

377
00:18:26,419 --> 00:18:32,879
<font color="#CCCCCC">running</font><font color="#E5E5E5"> through you can still get to</font><font color="#CCCCCC"> the</font>

378
00:18:30,899 --> 00:18:34,379
<font color="#E5E5E5">same</font><font color="#CCCCCC"> law the</font><font color="#E5E5E5"> same way that you would</font>

379
00:18:32,879 --> 00:18:36,840
<font color="#CCCCCC">have you would</font><font color="#E5E5E5"> interact with</font><font color="#CCCCCC"> the system</font>

380
00:18:34,379 --> 00:18:39,840
application logs in that you'd still

381
00:18:36,840 --> 00:18:42,959
you're still<font color="#CCCCCC"> able to get at the syslog</font>

382
00:18:39,840 --> 00:18:52,289
events the difference is is if you look

383
00:18:42,960 --> 00:18:53,639
at the that's actually there's I<font color="#E5E5E5"> don't</font>

384
00:18:52,289 --> 00:18:55,289
know why they do<font color="#CCCCCC"> it</font><font color="#E5E5E5"> but there's two</font>

385
00:18:53,639 --> 00:18:58,439
there's<font color="#CCCCCC"> two different ways that you can</font>

386
00:18:55,289 --> 00:18:59,820
<font color="#E5E5E5">interact with the system logs and one</font>

387
00:18:58,440 --> 00:19:01,409
was<font color="#E5E5E5"> the get event log like I showed you</font>

388
00:18:59,820 --> 00:19:05,239
<font color="#CCCCCC">earlier but you can't work with any</font><font color="#E5E5E5"> of</font>

389
00:19:01,409 --> 00:19:08,460
the advanced<font color="#E5E5E5"> more modern of system logs</font>

390
00:19:05,239 --> 00:19:12,349
with get event log<font color="#E5E5E5"> that's only for like</font>

391
00:19:08,460 --> 00:19:16,169
your basic<font color="#E5E5E5"> five event logs to look at</font>

392
00:19:12,349 --> 00:19:20,460
<font color="#E5E5E5">where as get</font><font color="#CCCCCC"> win event like if you you</font>

393
00:19:16,169 --> 00:19:22,649
know<font color="#E5E5E5"> they have</font><font color="#CCCCCC"> Microsoft's the like 50</font>

394
00:19:20,460 --> 00:19:24,359
60 different Microsoft event logs

395
00:19:22,649 --> 00:19:26,549
<font color="#E5E5E5">underneath in their advanced system</font>

396
00:19:24,359 --> 00:20:03,960
that's how you<font color="#E5E5E5"> would look at and</font><font color="#CCCCCC"> be able</font>

397
00:19:26,549 --> 00:20:07,470
<font color="#E5E5E5">to</font><font color="#CCCCCC"> query and that is taking the output</font>

398
00:20:03,960 --> 00:20:10,979
<font color="#E5E5E5">and converting it to an</font><font color="#CCCCCC"> an actual custom</font>

399
00:20:07,470 --> 00:20:13,019
PS object by doing<font color="#E5E5E5"> that it now takes the</font>

400
00:20:10,979 --> 00:20:14,940
<font color="#CCCCCC">message it formats it is an</font><font color="#E5E5E5"> object so</font>

401
00:20:13,019 --> 00:20:17,879
then<font color="#E5E5E5"> I can now if I want to put it into</font>

402
00:20:14,940 --> 00:20:19,080
<font color="#CCCCCC">a CSV</font><font color="#E5E5E5"> file to load into a database so</font>

403
00:20:17,879 --> 00:20:23,820
<font color="#CCCCCC">that I can get additional collection</font>

404
00:20:19,080 --> 00:20:25,619
data there<font color="#E5E5E5"> if I want to just load it</font>

405
00:20:23,820 --> 00:20:29,460
<font color="#E5E5E5">into Excel</font><font color="#CCCCCC"> and look at events there I</font>

406
00:20:25,619 --> 00:20:31,918
can do that so it's one<font color="#E5E5E5"> of the it's a</font>

407
00:20:29,460 --> 00:20:33,960
that's one of the things that you can do

408
00:20:31,919 --> 00:20:34,690
that you can't do<font color="#E5E5E5"> that you can do</font><font color="#CCCCCC"> a sis</font>

409
00:20:33,960 --> 00:20:37,090
mind that you can't

410
00:20:34,690 --> 00:20:38,770
<font color="#CCCCCC">to Sara Lee do with the</font><font color="#E5E5E5"> output from all</font>

411
00:20:37,090 --> 00:20:43,149
of the windows logs and the thing is is

412
00:20:38,770 --> 00:20:52,540
if I change<font color="#CCCCCC"> my event ID which I</font><font color="#E5E5E5"> think</font>

413
00:20:43,150 --> 00:20:55,480
<font color="#E5E5E5">three no matter what my event ID is the</font>

414
00:20:52,540 --> 00:20:59,980
same<font color="#E5E5E5"> format of the</font><font color="#CCCCCC"> message the way that</font>

415
00:20:55,480 --> 00:21:01,570
it<font color="#CCCCCC"> formats the output of the message</font><font color="#E5E5E5"> it</font>

416
00:20:59,980 --> 00:21:12,010
<font color="#CCCCCC">doesn't matter how many lines or what's</font>

417
00:21:01,570 --> 00:21:14,439
in there<font color="#E5E5E5"> it will</font><font color="#CCCCCC"> be able to format the</font>

418
00:21:12,010 --> 00:21:15,790
same on each<font color="#CCCCCC"> line so when you split like</font>

419
00:21:14,440 --> 00:21:17,680
I was<font color="#CCCCCC"> talking about being able to split</font>

420
00:21:15,790 --> 00:21:19,899
<font color="#E5E5E5">into a</font><font color="#CCCCCC"> newline</font><font color="#E5E5E5"> build an array and</font><font color="#CCCCCC"> then</font>

421
00:21:17,680 --> 00:21:21,550
split off of that string<font color="#E5E5E5"> it's the same</font>

422
00:21:19,900 --> 00:21:25,990
type of concept<font color="#CCCCCC"> so that</font><font color="#E5E5E5"> you're able</font><font color="#CCCCCC"> to</font>

423
00:21:21,550 --> 00:21:29,020
then parse the data<font color="#E5E5E5"> a lot easier</font><font color="#CCCCCC"> and be</font>

424
00:21:25,990 --> 00:21:31,050
able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> see get at things that are going</font>

425
00:21:29,020 --> 00:21:33,340
on on your<font color="#E5E5E5"> network a little bit better</font>

426
00:21:31,050 --> 00:21:36,870
<font color="#CCCCCC">it's not like it's not</font><font color="#E5E5E5"> something that</font>

427
00:21:33,340 --> 00:21:40,209
<font color="#CCCCCC">you necessarily have</font><font color="#E5E5E5"> to use and there's</font>

428
00:21:36,870 --> 00:21:43,540
benefits<font color="#E5E5E5"> to it but it's also not</font>

429
00:21:40,210 --> 00:21:47,950
necessarily meant<font color="#E5E5E5"> to scale the way that</font>

430
00:21:43,540 --> 00:21:49,360
<font color="#E5E5E5">people</font><font color="#CCCCCC"> have been using</font><font color="#E5E5E5"> it but it is it</font>

431
00:21:47,950 --> 00:21:51,190
<font color="#CCCCCC">is an additional tool that you can</font><font color="#E5E5E5"> use</font>

432
00:21:49,360 --> 00:21:54,419
<font color="#E5E5E5">in in your</font><font color="#CCCCCC"> arsenal to</font><font color="#E5E5E5"> be able to get at</font>

433
00:21:51,190 --> 00:21:54,420
the<font color="#CCCCCC"> information</font><font color="#E5E5E5"> that you have</font>

434
00:22:04,880 --> 00:22:10,190
so<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> much from there working you</font>

435
00:22:08,510 --> 00:22:12,230
what can you do<font color="#CCCCCC"> you can do pretty</font><font color="#E5E5E5"> much</font>

436
00:22:10,190 --> 00:22:13,790
<font color="#E5E5E5">if you can log it you can</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> start</font>

437
00:22:12,230 --> 00:22:16,580
<font color="#E5E5E5">building logic off of it</font><font color="#CCCCCC"> you don't</font>

438
00:22:13,790 --> 00:22:20,210
necessarily<font color="#E5E5E5"> need a</font><font color="#CCCCCC"> seam to be able</font><font color="#E5E5E5"> to do</font>

439
00:22:16,580 --> 00:22:22,730
it<font color="#E5E5E5"> you can also use it use this</font>

440
00:22:20,210 --> 00:22:24,890
information<font color="#E5E5E5"> as a</font><font color="#CCCCCC"> way to tweak</font><font color="#E5E5E5"> your your</font>

441
00:22:22,730 --> 00:22:26,780
existing scene<font color="#E5E5E5"> without actually making</font>

442
00:22:24,890 --> 00:22:28,100
modifications<font color="#E5E5E5"> to it while it's</font><font color="#CCCCCC"> running</font>

443
00:22:26,780 --> 00:22:29,510
in production<font color="#E5E5E5"> and so you're not messing</font>

444
00:22:28,100 --> 00:22:31,669
<font color="#E5E5E5">with any of the data logic that you're</font>

445
00:22:29,510 --> 00:22:33,020
already getting<font color="#E5E5E5"> so it's a way</font><font color="#CCCCCC"> to kind of</font>

446
00:22:31,670 --> 00:22:35,240
see what's happening you can mess with

447
00:22:33,020 --> 00:22:38,510
<font color="#E5E5E5">your audit policies and then just take</font>

448
00:22:35,240 --> 00:22:40,100
<font color="#E5E5E5">the</font><font color="#CCCCCC"> information from from these law from</font>

449
00:22:38,510 --> 00:22:41,240
those logs off of your audit policies to

450
00:22:40,100 --> 00:22:46,580
make<font color="#E5E5E5"> sure that you're getting actionable</font>

451
00:22:41,240 --> 00:22:49,400
data out of<font color="#CCCCCC"> that as well and then in my</font>

452
00:22:46,580 --> 00:22:52,250
case<font color="#CCCCCC"> like probably</font><font color="#E5E5E5"> where it clicked the</font>

453
00:22:49,400 --> 00:22:53,630
most with me for this type of scenario

454
00:22:52,250 --> 00:22:55,160
was I didn't really have anything

455
00:22:53,630 --> 00:22:58,160
monitoring my Active Directory

456
00:22:55,160 --> 00:23:01,280
environment at the time<font color="#E5E5E5"> but I wanted to</font>

457
00:22:58,160 --> 00:23:03,230
be able<font color="#E5E5E5"> to see who was</font><font color="#CCCCCC"> mod any type of</font>

458
00:23:01,280 --> 00:23:04,850
<font color="#CCCCCC">anytime a modification on</font><font color="#E5E5E5"> any type of</font>

459
00:23:03,230 --> 00:23:07,280
<font color="#E5E5E5">special event on my domain I wanted to</font>

460
00:23:04,850 --> 00:23:10,629
be able<font color="#E5E5E5"> to see that that happen so I had</font>

461
00:23:07,280 --> 00:23:13,160
a<font color="#E5E5E5"> scheduled task that ran periodically</font>

462
00:23:10,630 --> 00:23:14,810
<font color="#CCCCCC">that</font><font color="#E5E5E5"> would go and get</font><font color="#CCCCCC"> all the events</font>

463
00:23:13,160 --> 00:23:16,730
<font color="#E5E5E5">that occurred within since the last time</font>

464
00:23:14,810 --> 00:23:18,379
the scheduled<font color="#CCCCCC"> tasks</font><font color="#E5E5E5"> ran and it would</font>

465
00:23:16,730 --> 00:23:20,570
look at those<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then see if there were</font>

466
00:23:18,380 --> 00:23:23,630
any group additions and look at see

467
00:23:20,570 --> 00:23:25,490
things like<font color="#E5E5E5"> if a user modified my domain</font>

468
00:23:23,630 --> 00:23:27,320
admins group for example<font color="#E5E5E5"> and it would</font>

469
00:23:25,490 --> 00:23:29,150
<font color="#CCCCCC">tell me that that</font><font color="#E5E5E5"> group got modified and</font>

470
00:23:27,320 --> 00:23:30,590
it<font color="#CCCCCC"> would telling me who</font><font color="#E5E5E5"> modified it and</font>

471
00:23:29,150 --> 00:23:32,090
<font color="#E5E5E5">it would tell me the time and</font><font color="#CCCCCC"> then I</font>

472
00:23:30,590 --> 00:23:33,679
could go back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> whoever</font><font color="#CCCCCC"> did that</font><font color="#E5E5E5"> to</font>

473
00:23:32,090 --> 00:23:36,280
<font color="#CCCCCC">make sure that it was actually there was</font>

474
00:23:33,680 --> 00:23:40,880
a legitimate<font color="#E5E5E5"> reason why it was happening</font>

475
00:23:36,280 --> 00:23:42,350
<font color="#CCCCCC">and so</font><font color="#E5E5E5"> if you don't have the tools it's</font>

476
00:23:40,880 --> 00:23:44,390
a way<font color="#E5E5E5"> that you can start getting</font><font color="#CCCCCC"> some of</font>

477
00:23:42,350 --> 00:23:47,600
<font color="#CCCCCC">that insight and then you can start</font>

478
00:23:44,390 --> 00:23:49,550
using that<font color="#E5E5E5"> as even potentially like is a</font>

479
00:23:47,600 --> 00:23:54,590
proof<font color="#E5E5E5"> of</font><font color="#CCCCCC"> concept to</font><font color="#E5E5E5"> get you those tools</font>

480
00:23:49,550 --> 00:23:59,180
later on down the road so more

481
00:23:54,590 --> 00:24:06,220
<font color="#E5E5E5">information</font><font color="#CCCCCC"> we said</font><font color="#E5E5E5"> you can look at</font>

482
00:23:59,180 --> 00:24:08,630
<font color="#E5E5E5">Carlos Perez and Jessica</font><font color="#CCCCCC"> Payne</font><font color="#E5E5E5"> are two</font>

483
00:24:06,220 --> 00:24:10,940
people<font color="#E5E5E5"> that kind</font><font color="#CCCCCC"> of talked about</font><font color="#E5E5E5"> this a</font>

484
00:24:08,630 --> 00:24:13,400
little<font color="#E5E5E5"> bit more</font><font color="#CCCCCC"> in depth jessica</font>

485
00:24:10,940 --> 00:24:15,410
actually just wrote one<font color="#E5E5E5"> back in</font><font color="#CCCCCC"> December</font>

486
00:24:13,400 --> 00:24:17,820
that<font color="#CCCCCC"> was really interesting about doing</font>

487
00:24:15,410 --> 00:24:23,100
something<font color="#E5E5E5"> similar with the event forward</font>

488
00:24:17,820 --> 00:24:26,970
and loading it loading the data into bi

489
00:24:23,100 --> 00:24:29,399
<font color="#E5E5E5">to get more analytics and and some of</font>

490
00:24:26,970 --> 00:24:31,140
the Microsoft Azure automation behind it

491
00:24:29,400 --> 00:24:34,140
<font color="#E5E5E5">to be able to parse your events and</font>

492
00:24:31,140 --> 00:24:36,090
<font color="#E5E5E5">alert off of that</font><font color="#CCCCCC"> and the specter</font><font color="#E5E5E5"> ops</font>

493
00:24:34,140 --> 00:24:39,690
group puts out quite a bit<font color="#CCCCCC"> of</font>

494
00:24:36,090 --> 00:24:41,040
information<font color="#CCCCCC"> and normally when they put</font>

495
00:24:39,690 --> 00:24:44,580
out<font color="#CCCCCC"> a tool they'll talk a little bit</font>

496
00:24:41,040 --> 00:24:47,340
about this mine<font color="#CCCCCC"> and configurations like</font>

497
00:24:44,580 --> 00:24:50,909
<font color="#E5E5E5">that as well and then last is the</font><font color="#CCCCCC"> Swift</font>

498
00:24:47,340 --> 00:24:52,110
<font color="#E5E5E5">land security</font><font color="#CCCCCC"> log</font><font color="#E5E5E5"> Twitter handle there's</font>

499
00:24:50,910 --> 00:24:54,720
<font color="#CCCCCC">quite a bit of information under</font><font color="#E5E5E5"> there</font>

500
00:24:52,110 --> 00:24:55,760
as well if you want<font color="#E5E5E5"> to talk to me more</font>

501
00:24:54,720 --> 00:25:00,090
<font color="#E5E5E5">about</font><font color="#CCCCCC"> it</font>

502
00:24:55,760 --> 00:25:02,820
<font color="#CCCCCC">I'm on Twitter at eff pieces you can</font>

503
00:25:00,090 --> 00:25:05,340
email me<font color="#E5E5E5"> at</font><font color="#CCCCCC"> my</font><font color="#E5E5E5"> email address</font><font color="#CCCCCC"> and then</font>

504
00:25:02,820 --> 00:25:07,080
I'm<font color="#E5E5E5"> on numerous different slack channels</font>

505
00:25:05,340 --> 00:25:10,620
but these ones<font color="#CCCCCC"> here the primary</font><font color="#E5E5E5"> ones at</font>

506
00:25:07,080 --> 00:25:11,850
<font color="#CCCCCC">online so with that</font><font color="#E5E5E5"> I'll kind of open it</font>

507
00:25:10,620 --> 00:25:14,060
up<font color="#E5E5E5"> for</font><font color="#CCCCCC"> any questions</font><font color="#E5E5E5"> anyone</font><font color="#CCCCCC"> it might</font>

508
00:25:11,850 --> 00:25:14,060
have

509
00:25:29,910 --> 00:25:36,780
<font color="#E5E5E5">I'm not sure on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> things that</font><font color="#CCCCCC"> aren't</font>

510
00:25:33,840 --> 00:25:38,699
<font color="#E5E5E5">being caught by default and when I'm</font>

511
00:25:36,780 --> 00:25:40,230
starting<font color="#E5E5E5"> out looking at the things that</font>

512
00:25:38,700 --> 00:25:42,660
are<font color="#E5E5E5"> running in my environments and that</font>

513
00:25:40,230 --> 00:25:47,220
<font color="#CCCCCC">I'm looking</font><font color="#E5E5E5"> at the</font><font color="#CCCCCC"> types of processes</font>

514
00:25:42,660 --> 00:25:49,740
<font color="#CCCCCC">that are</font><font color="#E5E5E5"> being created</font><font color="#CCCCCC"> and where they're</font>

515
00:25:47,220 --> 00:25:52,080
being ran from and that type of

516
00:25:49,740 --> 00:25:55,190
<font color="#CCCCCC">information and the thing is is like</font><font color="#E5E5E5"> I</font>

517
00:25:52,080 --> 00:25:58,830
want<font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> things like that</font>

518
00:25:55,190 --> 00:26:01,260
there's a lot of legit<font color="#CCCCCC"> there's a lot</font><font color="#E5E5E5"> of</font>

519
00:25:58,830 --> 00:26:03,629
new<font color="#CCCCCC"> tool tools that are being that are</font>

520
00:26:01,260 --> 00:26:06,270
used<font color="#E5E5E5"> for legitimate</font><font color="#CCCCCC"> purposes</font><font color="#E5E5E5"> that aren't</font>

521
00:26:03,630 --> 00:26:09,150
being<font color="#E5E5E5"> used legitimately anymore</font><font color="#CCCCCC"> and so</font>

522
00:26:06,270 --> 00:26:10,650
making sure or checking<font color="#E5E5E5"> finding out if</font>

523
00:26:09,150 --> 00:26:12,750
those types<font color="#E5E5E5"> of things are running on</font>

524
00:26:10,650 --> 00:26:14,100
your and where they're running<font color="#CCCCCC"> from and</font>

525
00:26:12,750 --> 00:26:16,370
if they're supposed<font color="#CCCCCC"> to be running</font><font color="#E5E5E5"> from</font>

526
00:26:14,100 --> 00:26:16,370
there

527
00:26:25,090 --> 00:26:33,459
I'm sorry not in my current neighborhood

528
00:26:30,559 --> 00:26:37,730
<font color="#E5E5E5">in the current</font><font color="#CCCCCC"> environment</font><font color="#E5E5E5"> no so I I</font>

529
00:26:33,460 --> 00:26:41,450
won't<font color="#E5E5E5"> use</font><font color="#CCCCCC"> their PS</font><font color="#E5E5E5"> exact is now one of</font>

530
00:26:37,730 --> 00:26:43,100
<font color="#E5E5E5">those things that it's disabled I'll</font>

531
00:26:41,450 --> 00:26:45,259
push people towards using<font color="#CCCCCC"> PowerShell</font>

532
00:26:43,100 --> 00:26:49,309
remoting things like that<font color="#E5E5E5"> versus using</font>

533
00:26:45,259 --> 00:26:51,590
PS exec<font color="#E5E5E5"> so that's just something</font><font color="#CCCCCC"> that I</font>

534
00:26:49,309 --> 00:26:53,029
know<font color="#CCCCCC"> that I can I can I can</font><font color="#E5E5E5"> alert on</font>

535
00:26:51,590 --> 00:26:54,830
because I know that it's<font color="#E5E5E5"> not going it</font>

536
00:26:53,029 --> 00:26:57,190
should not be legitimately being used in

537
00:26:54,830 --> 00:26:57,189
my environment

538
00:27:05,809 --> 00:27:13,918
<font color="#E5E5E5">all right thank you everybody</font>

539
00:27:10,390 --> 00:27:13,919
[Applause]

