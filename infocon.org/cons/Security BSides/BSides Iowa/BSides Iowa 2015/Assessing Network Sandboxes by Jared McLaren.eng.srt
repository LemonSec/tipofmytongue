1
00:00:40,609 --> 00:00:45,480
<font color="#E5E5E5">okay so we're going to be talking about</font>

2
00:00:42,570 --> 00:00:48,539
assessing networks and boxing solutions

3
00:00:45,480 --> 00:00:51,480
and a quick start about me one of the

4
00:00:48,539 --> 00:00:53,280
obligatory slides I'm<font color="#CCCCCC"> Jared</font><font color="#E5E5E5"> McLaren I've</font>

5
00:00:51,480 --> 00:00:56,010
been working<font color="#CCCCCC"> here in town for about 15</font>

6
00:00:53,280 --> 00:00:57,600
years or so worked with<font color="#E5E5E5"> the state</font>

7
00:00:56,010 --> 00:01:00,000
government for a bit a couple financial

8
00:00:57,600 --> 00:01:03,149
institutions and network for health

9
00:01:00,000 --> 00:01:05,069
company downtown kind of the alphabet

10
00:01:03,149 --> 00:01:09,119
soup as far as you know security

11
00:01:05,069 --> 00:01:11,130
<font color="#E5E5E5">certifications go yada yada personal</font>

12
00:01:09,119 --> 00:01:14,580
side I'm a competitive cyclist big

13
00:01:11,130 --> 00:01:17,158
Belgian beer fan and a new father so

14
00:01:14,580 --> 00:01:19,950
thumbs up to the Belgian beer and the

15
00:01:17,159 --> 00:01:21,780
new father over there all right so

16
00:01:19,950 --> 00:01:23,039
coffee is hopefully going to work its

17
00:01:21,780 --> 00:01:24,780
wonders and you won't see me<font color="#E5E5E5"> asleep at</font>

18
00:01:23,039 --> 00:01:29,039
the wheel today so<font color="#E5E5E5"> just throw something</font>

19
00:01:24,780 --> 00:01:32,250
at me if I go down<font color="#E5E5E5"> high level overview</font>

20
00:01:29,039 --> 00:01:33,780
of what we're looking at today so you'll

21
00:01:32,250 --> 00:01:35,580
see a few different<font color="#E5E5E5"> designs and</font>

22
00:01:33,780 --> 00:01:38,130
architectures of some of these systems

23
00:01:35,580 --> 00:01:39,600
<font color="#E5E5E5">will discuss</font><font color="#CCCCCC"> that maybe some product</font>

24
00:01:38,130 --> 00:01:41,460
considerations they all have their own

25
00:01:39,600 --> 00:01:43,919
feature sets specialize in certain

26
00:01:41,460 --> 00:01:46,440
things some are better in some areas

27
00:01:43,920 --> 00:01:48,929
than others how are we<font color="#E5E5E5"> going to then</font>

28
00:01:46,440 --> 00:01:51,300
assess these products take a look<font color="#E5E5E5"> at if</font>

29
00:01:48,929 --> 00:01:54,780
they do what they say they're going to

30
00:01:51,300 --> 00:01:57,599
do and then we're going to attack them

31
00:01:54,780 --> 00:01:59,129
and end with a<font color="#CCCCCC"> real-world scenario that</font>

32
00:01:57,599 --> 00:02:00,420
<font color="#E5E5E5">I believe is the first</font><font color="#CCCCCC"> network based</font>

33
00:01:59,129 --> 00:02:05,340
sandbox break out in one of these

34
00:02:00,420 --> 00:02:07,770
environments so to kind<font color="#E5E5E5"> of level set on</font>

35
00:02:05,340 --> 00:02:09,149
this one standard definition<font color="#E5E5E5"> this is how</font>

36
00:02:07,770 --> 00:02:11,849
I'm going to define it<font color="#CCCCCC"> for this</font>

37
00:02:09,149 --> 00:02:13,739
presentation it's networks and boxing

38
00:02:11,849 --> 00:02:15,390
we're basically talking about this is an

39
00:02:13,739 --> 00:02:17,580
environment where we're going to run and

40
00:02:15,390 --> 00:02:18,750
detonate code we're going<font color="#E5E5E5"> to see what it</font>

41
00:02:17,580 --> 00:02:20,280
does we're going<font color="#E5E5E5"> to see if it's</font>

42
00:02:18,750 --> 00:02:22,250
malicious and we're going to<font color="#E5E5E5"> look for</font>

43
00:02:20,280 --> 00:02:25,470
signs of exploitation coming out of that

44
00:02:22,250 --> 00:02:27,180
so<font color="#CCCCCC"> fireeye being</font><font color="#E5E5E5"> the prime example in</font>

45
00:02:25,470 --> 00:02:29,910
the market space of this one we've all

46
00:02:27,180 --> 00:02:32,310
heard<font color="#E5E5E5"> of them know what they do so kind</font>

47
00:02:29,910 --> 00:02:33,629
of think of them you know throughout

48
00:02:32,310 --> 00:02:35,340
this presentation is that's kind of the

49
00:02:33,629 --> 00:02:40,170
general theme of these types of boxes

50
00:02:35,340 --> 00:02:42,060
we're talking<font color="#CCCCCC"> about and as far as</font><font color="#E5E5E5"> design</font>

51
00:02:40,170 --> 00:02:45,869
and architecture goes it seems there are

52
00:02:42,060 --> 00:02:48,180
about three general styles in line

53
00:02:45,870 --> 00:02:50,610
blocking maybe one certain style that

54
00:02:48,180 --> 00:02:52,290
you see and sometimes that's<font color="#E5E5E5"> like Palo</font>

55
00:02:50,610 --> 00:02:53,790
Alto<font color="#E5E5E5"> is a perfect example they've got I</font>

56
00:02:52,290 --> 00:02:56,290
believe it's<font color="#E5E5E5"> their wildfire so</font>

57
00:02:53,790 --> 00:02:57,849
so they can take<font color="#E5E5E5"> a look at malware</font>

58
00:02:56,290 --> 00:02:59,439
coming in and<font color="#E5E5E5"> out and they're right</font>

59
00:02:57,849 --> 00:03:01,929
there in line and<font color="#E5E5E5"> they can block when</font>

60
00:02:59,439 --> 00:03:05,200
they see certain things coming in so

61
00:03:01,930 --> 00:03:06,610
pretty reactive<font color="#E5E5E5"> and there you know dead</font>

62
00:03:05,200 --> 00:03:09,369
in<font color="#E5E5E5"> the network if you see anything bad</font>

63
00:03:06,610 --> 00:03:11,230
<font color="#E5E5E5">coming through from a network tap and</font>

64
00:03:09,370 --> 00:03:14,200
analysis standpoint a lot of<font color="#CCCCCC"> people use</font>

65
00:03:11,230 --> 00:03:17,048
fire I this<font color="#E5E5E5"> way maybe you know stick</font>

66
00:03:14,200 --> 00:03:18,819
<font color="#CCCCCC">your core feed right to the right to the</font>

67
00:03:17,049 --> 00:03:20,560
fire I it'll<font color="#E5E5E5"> take a look at the traffic</font>

68
00:03:18,819 --> 00:03:23,018
parse out files that it sees going

69
00:03:20,560 --> 00:03:25,150
across my over you know HTTP pop3

70
00:03:23,019 --> 00:03:27,459
whatever whatever protocols it

71
00:03:25,150 --> 00:03:29,530
understands grabs those files sends them

72
00:03:27,459 --> 00:03:32,200
off to its own network stack<font color="#E5E5E5"> to and</font>

73
00:03:29,530 --> 00:03:33,989
sandbox to detonate in there and then

74
00:03:32,200 --> 00:03:37,358
there are a few in the marketplace

75
00:03:33,989 --> 00:03:39,909
excuse me that do a centralized

76
00:03:37,359 --> 00:03:43,599
offloading architecture and this is a

77
00:03:39,909 --> 00:03:45,280
really<font color="#CCCCCC"> interesting one you have</font><font color="#E5E5E5"> to kind</font>

78
00:03:43,599 --> 00:03:47,260
of get a little bit monolithic in your

79
00:03:45,280 --> 00:03:48,609
<font color="#E5E5E5">security endpoint protections and</font>

80
00:03:47,260 --> 00:03:50,230
network protections for something like

81
00:03:48,609 --> 00:03:54,159
this to work because<font color="#E5E5E5"> all the devices</font>

82
00:03:50,230 --> 00:04:00,099
have to communicate seamlessly excuse me

83
00:03:54,159 --> 00:04:03,578
a great<font color="#E5E5E5"> example of</font><font color="#CCCCCC"> this one is Intel</font>

84
00:04:00,099 --> 00:04:07,418
security formerly McAfee their advanced

85
00:04:03,579 --> 00:04:12,639
threat defense product that that one it

86
00:04:07,419 --> 00:04:14,319
works<font color="#E5E5E5"> really nicely sku works really</font>

87
00:04:12,639 --> 00:04:16,180
nicely as far as integration goes with

88
00:04:14,319 --> 00:04:17,649
the<font color="#E5E5E5"> network censors if they see</font>

89
00:04:16,180 --> 00:04:19,269
something going across the wire they can

90
00:04:17,649 --> 00:04:21,339
grab it right off shove it to a

91
00:04:19,269 --> 00:04:22,690
centralized sandbox so those network

92
00:04:21,339 --> 00:04:25,388
<font color="#E5E5E5">censors aren't spending their time</font>

93
00:04:22,690 --> 00:04:27,520
spinning on a sandbox or the endpoints

94
00:04:25,389 --> 00:04:29,979
and that's a pretty interesting

95
00:04:27,520 --> 00:04:32,380
perspective because if you have a sensor

96
00:04:29,979 --> 00:04:35,590
on an endpoint it can see things post

97
00:04:32,380 --> 00:04:37,930
<font color="#CCCCCC">SSL so it's a little bit</font><font color="#E5E5E5"> better as</font>

98
00:04:35,590 --> 00:04:41,940
seeing<font color="#E5E5E5"> things where transport encryption</font>

99
00:04:37,930 --> 00:04:45,849
may block what a network censor can see

100
00:04:41,940 --> 00:04:48,550
and as far as product considerations go

101
00:04:45,849 --> 00:04:50,169
these will vary a little bit based on

102
00:04:48,550 --> 00:04:52,810
one of those three styles and design

103
00:04:50,169 --> 00:04:55,960
that you're going to<font color="#E5E5E5"> be looking at first</font>

104
00:04:52,810 --> 00:04:57,430
of all<font color="#CCCCCC"> fire a</font><font color="#E5E5E5"> great example here you'll</font>

105
00:04:55,960 --> 00:04:59,409
see a lot<font color="#E5E5E5"> of those license based on</font>

106
00:04:57,430 --> 00:05:02,169
bandwidth so how many of those do you

107
00:04:59,409 --> 00:05:03,969
need to deploy maybe you want one at

108
00:05:02,169 --> 00:05:05,719
your edge probably the best point where

109
00:05:03,969 --> 00:05:08,450
you're<font color="#E5E5E5"> going to be looking at that</font>

110
00:05:05,720 --> 00:05:10,400
the main product might not work with

111
00:05:08,450 --> 00:05:13,099
your email system so you may need to

112
00:05:10,400 --> 00:05:15,979
purchase an email system dedicated<font color="#E5E5E5"> to</font>

113
00:05:13,100 --> 00:05:19,030
analyzing malware as well and then

114
00:05:15,980 --> 00:05:22,040
stepping back<font color="#CCCCCC"> to the mcafee a TD</font>

115
00:05:19,030 --> 00:05:24,409
deployment maybe it's a centralized

116
00:05:22,040 --> 00:05:25,970
sandbox architecture so it may<font color="#CCCCCC"> be in one</font>

117
00:05:24,410 --> 00:05:29,150
of those environments you buy one

118
00:05:25,970 --> 00:05:31,370
solution and everything feeds to that if

119
00:05:29,150 --> 00:05:33,080
you get<font color="#CCCCCC"> into you know the</font><font color="#E5E5E5"> fire I for</font>

120
00:05:31,370 --> 00:05:35,270
example and bandwidth limitations you

121
00:05:33,080 --> 00:05:37,280
<font color="#E5E5E5">may end up buying one for</font><font color="#CCCCCC"> your regress</font>

122
00:05:35,270 --> 00:05:39,560
one for<font color="#E5E5E5"> your partner networks one that</font>

123
00:05:37,280 --> 00:05:41,929
watches certain things inside<font color="#CCCCCC"> your</font>

124
00:05:39,560 --> 00:05:43,190
network so you know it can really<font color="#E5E5E5"> start</font>

125
00:05:41,930 --> 00:05:44,960
affecting the budget pretty quickly

126
00:05:43,190 --> 00:05:48,550
depending on<font color="#E5E5E5"> what architecture and</font>

127
00:05:44,960 --> 00:05:52,310
design your product has and from a

128
00:05:48,550 --> 00:05:53,570
sandboxed<font color="#E5E5E5"> system images standpoint I've</font>

129
00:05:52,310 --> 00:05:56,540
<font color="#E5E5E5">heard a lot of things</font><font color="#CCCCCC"> from the vendors</font>

130
00:05:53,570 --> 00:05:59,360
on on what they recommend for deploying

131
00:05:56,540 --> 00:06:02,240
some people say<font color="#CCCCCC"> we'll throw on a</font><font color="#E5E5E5"> Windows</font>

132
00:05:59,360 --> 00:06:04,400
<font color="#E5E5E5">XP service pack 2 1 patched and you know</font>

133
00:06:02,240 --> 00:06:06,800
office 97 on<font color="#CCCCCC"> there let we'll just</font><font color="#E5E5E5"> catch</font>

134
00:06:04,400 --> 00:06:08,299
everything we can I mean show of hands

135
00:06:06,800 --> 00:06:12,410
how many<font color="#CCCCCC"> people out there run all that</font>

136
00:06:08,300 --> 00:06:14,270
on their network nobody so when when you

137
00:06:12,410 --> 00:06:18,110
<font color="#E5E5E5">see vendors like fire I saying that</font><font color="#CCCCCC"> they</font>

138
00:06:14,270 --> 00:06:20,210
never have false positives it's I find

139
00:06:18,110 --> 00:06:21,860
that a little misleading it's a false

140
00:06:20,210 --> 00:06:23,090
positive to me if it's not something

141
00:06:21,860 --> 00:06:25,100
<font color="#CCCCCC">that's going</font><font color="#E5E5E5"> to actually exploit my</font>

142
00:06:23,090 --> 00:06:27,710
network so always check if you can

143
00:06:25,100 --> 00:06:29,979
upload<font color="#E5E5E5"> a gold image of what you have on</font>

144
00:06:27,710 --> 00:06:32,659
your network to one of<font color="#E5E5E5"> these boxes</font><font color="#CCCCCC"> and</font>

145
00:06:29,979 --> 00:06:34,729
there may be some limitations to that as

146
00:06:32,660 --> 00:06:37,460
well because<font color="#E5E5E5"> some of them have size</font>

147
00:06:34,729 --> 00:06:39,380
limitations of the actual images that

148
00:06:37,460 --> 00:06:41,770
you can<font color="#CCCCCC"> upload so make sure that</font><font color="#E5E5E5"> you're</font>

149
00:06:39,380 --> 00:06:44,479
compatible with that as well it may

150
00:06:41,770 --> 00:06:45,799
limit your deployment to not being<font color="#E5E5E5"> able</font>

151
00:06:44,479 --> 00:06:47,599
to<font color="#E5E5E5"> install office on it because that</font>

152
00:06:45,800 --> 00:06:50,510
<font color="#E5E5E5">makes it too big so just a few</font>

153
00:06:47,600 --> 00:06:53,570
considerations there and let's say you

154
00:06:50,510 --> 00:06:56,300
buy this big box that can run you know

155
00:06:53,570 --> 00:06:58,700
80 concurrent images and just fire

156
00:06:56,300 --> 00:07:01,160
<font color="#E5E5E5">everything that you can shove it in the</font>

157
00:06:58,700 --> 00:07:03,469
sandbox and it just keeps churning well

158
00:07:01,160 --> 00:07:05,780
as far as<font color="#CCCCCC"> I know fortinet is the only</font>

159
00:07:03,470 --> 00:07:08,150
device out there that actually licenses

160
00:07:05,780 --> 00:07:10,609
those images that you're<font color="#E5E5E5"> running in</font>

161
00:07:08,150 --> 00:07:12,080
there so keep that in mind<font color="#E5E5E5"> from a cost</font>

162
00:07:10,610 --> 00:07:14,450
standpoint because if you buy this big

163
00:07:12,080 --> 00:07:16,849
box that can run 80 images you<font color="#CCCCCC"> need to</font>

164
00:07:14,450 --> 00:07:17,909
buy 80 licenses of whatever software

165
00:07:16,849 --> 00:07:20,849
you're running in there

166
00:07:17,910 --> 00:07:22,050
that's kind of a hidden costs that tends

167
00:07:20,850 --> 00:07:28,970
to<font color="#E5E5E5"> come up that a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> people don't</font>

168
00:07:22,050 --> 00:07:31,650
<font color="#CCCCCC">think through so some of the things</font>

169
00:07:28,970 --> 00:07:32,850
<font color="#E5E5E5">network monitoring that may be something</font>

170
00:07:31,650 --> 00:07:35,190
that you see on some of these<font color="#E5E5E5"> devices</font>

171
00:07:32,850 --> 00:07:36,690
<font color="#E5E5E5">fireEye's really good at that one you'll</font>

172
00:07:35,190 --> 00:07:38,700
see that they also monitor the<font color="#CCCCCC"> network</font>

173
00:07:36,690 --> 00:07:40,980
connections for this is a known<font color="#CCCCCC"> cnc</font>

174
00:07:38,700 --> 00:07:42,330
channel these are this<font color="#E5E5E5"> is bad traffic</font>

175
00:07:40,980 --> 00:07:43,410
coming<font color="#E5E5E5"> out</font><font color="#CCCCCC"> of here they'll they'll</font>

176
00:07:42,330 --> 00:07:45,960
really take a look at a lot of<font color="#E5E5E5"> those</font>

177
00:07:43,410 --> 00:07:48,690
other things maybe some dns detection as

178
00:07:45,960 --> 00:07:51,989
well we saw you know a DNS request from

179
00:07:48,690 --> 00:07:53,190
this box to a known bad domain so those

180
00:07:51,990 --> 00:07:54,450
<font color="#E5E5E5">are some great features that you might</font>

181
00:07:53,190 --> 00:07:56,370
not get from that centralized

182
00:07:54,450 --> 00:08:00,510
architecture that's<font color="#E5E5E5"> something that</font>

183
00:07:56,370 --> 00:08:02,970
monitors the network can do the having

184
00:08:00,510 --> 00:08:05,099
the<font color="#E5E5E5"> ability to integrate with some</font>

185
00:08:02,970 --> 00:08:06,570
threat intelligence I heard that was the

186
00:08:05,100 --> 00:08:09,030
buzz word<font color="#CCCCCC"> from last year sorry</font><font color="#E5E5E5"> i'm a</font>

187
00:08:06,570 --> 00:08:10,650
year behind but if you can integrate

188
00:08:09,030 --> 00:08:13,289
with any<font color="#E5E5E5"> kind of threat intelligence</font>

189
00:08:10,650 --> 00:08:15,659
that helps a lot<font color="#E5E5E5"> i keep going back to</font>

190
00:08:13,290 --> 00:08:17,520
some examples<font color="#CCCCCC"> of intel security and</font>

191
00:08:15,660 --> 00:08:20,280
<font color="#E5E5E5">McAfee they have a GTI their group of</font>

192
00:08:17,520 --> 00:08:22,500
global threat intelligence if you can

193
00:08:20,280 --> 00:08:24,539
start<font color="#E5E5E5"> tying tying some of that</font>

194
00:08:22,500 --> 00:08:26,100
<font color="#E5E5E5">information into your sandbox insane</font>

195
00:08:24,540 --> 00:08:28,650
boxing environment you might have some

196
00:08:26,100 --> 00:08:30,240
efficiencies we see<font color="#E5E5E5"> that</font><font color="#CCCCCC"> an md5 hash</font>

197
00:08:28,650 --> 00:08:31,169
some matches so we know it's bad we

198
00:08:30,240 --> 00:08:33,120
don't have to throw<font color="#E5E5E5"> it off to</font><font color="#CCCCCC"> the</font>

199
00:08:31,170 --> 00:08:34,770
sandbox therefore we saved a lot of time

200
00:08:33,120 --> 00:08:38,460
and analysis and we can shut<font color="#CCCCCC"> it off a</font>

201
00:08:34,770 --> 00:08:40,770
lot quicker and it's<font color="#E5E5E5"> that ties right</font>

202
00:08:38,460 --> 00:08:43,020
into resource efficiency some of these

203
00:08:40,770 --> 00:08:44,490
boxes every single time they see a file

204
00:08:43,020 --> 00:08:46,829
they shove it straight<font color="#E5E5E5"> to the sandbox</font>

205
00:08:44,490 --> 00:08:48,660
don't check antivirus first don't check

206
00:08:46,830 --> 00:08:51,480
if it's a known whitelisted file and

207
00:08:48,660 --> 00:08:53,910
that's extremely resource intensive and

208
00:08:51,480 --> 00:08:55,440
if<font color="#E5E5E5"> I'm an attacker and I'm going after</font>

209
00:08:53,910 --> 00:08:57,089
<font color="#CCCCCC">someone that I know has this on their</font>

210
00:08:55,440 --> 00:09:01,200
network i'm going<font color="#E5E5E5"> to send off you know</font>

211
00:08:57,090 --> 00:09:02,580
200 non malicious files just to chug

212
00:09:01,200 --> 00:09:04,770
their time down on their<font color="#E5E5E5"> sandbox</font>

213
00:09:02,580 --> 00:09:06,450
environment and then you know slap my

214
00:09:04,770 --> 00:09:08,430
executable off in the middle of that and

215
00:09:06,450 --> 00:09:10,260
it's going<font color="#E5E5E5"> to be a while before they</font>

216
00:09:08,430 --> 00:09:13,620
catch on<font color="#E5E5E5"> to my attack and you know maybe</font>

217
00:09:10,260 --> 00:09:15,000
slide through at that point some

218
00:09:13,620 --> 00:09:17,130
considerations in<font color="#CCCCCC"> the corporate</font>

219
00:09:15,000 --> 00:09:20,670
environment to is local versus cloud

220
00:09:17,130 --> 00:09:23,970
analysis and<font color="#E5E5E5"> I know this is a pretty big</font>

221
00:09:20,670 --> 00:09:26,130
one when take one step<font color="#CCCCCC"> back a lot</font><font color="#E5E5E5"> of</font>

222
00:09:23,970 --> 00:09:28,589
these products look at<font color="#E5E5E5"> PDFs for</font>

223
00:09:26,130 --> 00:09:30,540
malicious content and in your corporate

224
00:09:28,589 --> 00:09:31,500
environment you may have an imaging

225
00:09:30,540 --> 00:09:33,990
system that take

226
00:09:31,500 --> 00:09:36,420
I don't know claims reports financial

227
00:09:33,990 --> 00:09:37,950
information whatever images it to PDFs

228
00:09:36,420 --> 00:09:40,740
so every time<font color="#E5E5E5"> one of those is seen on</font>

229
00:09:37,950 --> 00:09:42,630
the wire it may be shoved off to a to

230
00:09:40,740 --> 00:09:45,120
the cloud environment for a given vendor

231
00:09:42,630 --> 00:09:46,830
for analysis and think about the

232
00:09:45,120 --> 00:09:50,250
considerations of that one from<font color="#E5E5E5"> a</font>

233
00:09:46,830 --> 00:09:51,300
compliance standpoint so something to

234
00:09:50,250 --> 00:09:52,740
definitely keep in mind their

235
00:09:51,300 --> 00:09:55,170
efficiencies sending it off to the<font color="#E5E5E5"> cloud</font>

236
00:09:52,740 --> 00:09:57,120
because you know elasticity it can be

237
00:09:55,170 --> 00:09:59,040
done pretty quickly but if it<font color="#E5E5E5"> doesn't</font>

238
00:09:57,120 --> 00:10:00,720
work with compliance then that's<font color="#E5E5E5"> not</font>

239
00:09:59,040 --> 00:10:04,230
something you<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> go down not at all</font>

240
00:10:00,720 --> 00:10:07,140
and then one of the one of<font color="#E5E5E5"> the more</font>

241
00:10:04,230 --> 00:10:09,960
interesting<font color="#E5E5E5"> features that you may see on</font>

242
00:10:07,140 --> 00:10:13,380
<font color="#CCCCCC">a couple devices is the ability</font><font color="#E5E5E5"> to add</font>

243
00:10:09,960 --> 00:10:15,030
internet access to the sandbox and<font color="#CCCCCC"> will</font>

244
00:10:13,380 --> 00:10:17,670
touch more on<font color="#E5E5E5"> that one in a little while</font>

245
00:10:15,030 --> 00:10:21,810
but that's one you want<font color="#E5E5E5"> to be extremely</font>

246
00:10:17,670 --> 00:10:24,180
<font color="#CCCCCC">careful</font><font color="#E5E5E5"> and deliberate about doing for</font>

247
00:10:21,810 --> 00:10:25,770
multiple reasons think about what's

248
00:10:24,180 --> 00:10:32,040
running in<font color="#E5E5E5"> that environment that you're</font>

249
00:10:25,770 --> 00:10:33,600
granting internet access to you know a

250
00:10:32,040 --> 00:10:36,030
lot<font color="#CCCCCC"> of these products cover about the</font>

251
00:10:33,600 --> 00:10:38,040
same protocols and<font color="#E5E5E5"> I'll show an example</font>

252
00:10:36,030 --> 00:10:42,540
on the next slide of some file types and

253
00:10:38,040 --> 00:10:44,010
such you<font color="#CCCCCC"> know HTTP SMTP any clear text</font>

254
00:10:42,540 --> 00:10:47,189
protocol they're pretty good at doing

255
00:10:44,010 --> 00:10:49,010
anything encrypted you know good luck

256
00:10:47,190 --> 00:10:51,110
unless you have an<font color="#E5E5E5"> SSL off loader or</font>

257
00:10:49,010 --> 00:10:53,340
kind<font color="#E5E5E5"> of stepping back</font><font color="#CCCCCC"> to mcafee a</font>

258
00:10:51,110 --> 00:10:56,880
centralized design where the endpoints

259
00:10:53,340 --> 00:10:59,790
can grab things and send them in just

260
00:10:56,880 --> 00:11:03,090
<font color="#E5E5E5">about all of them cover office files up</font>

261
00:10:59,790 --> 00:11:04,500
<font color="#CCCCCC">to a certain version a compatibility guy</font>

262
00:11:03,090 --> 00:11:06,060
it'll show you which version they go up

263
00:11:04,500 --> 00:11:07,140
<font color="#E5E5E5">to but</font><font color="#CCCCCC"> if you're on the latest</font><font color="#E5E5E5"> and</font>

264
00:11:06,060 --> 00:11:08,459
greatest there's a chance that there's

265
00:11:07,140 --> 00:11:10,050
going<font color="#E5E5E5"> to be some lag in the marketplace</font>

266
00:11:08,460 --> 00:11:13,620
before<font color="#CCCCCC"> they can actually</font><font color="#E5E5E5"> scan those</font>

267
00:11:10,050 --> 00:11:16,589
latest files PDFs pretty much<font color="#E5E5E5"> everyone</font>

268
00:11:13,620 --> 00:11:20,130
does that so you know when when you're

269
00:11:16,590 --> 00:11:21,840
assessing one of these devices just get

270
00:11:20,130 --> 00:11:24,360
to<font color="#CCCCCC"> know the environment what what can</font>

271
00:11:21,840 --> 00:11:26,010
they do what can they handle as you're

272
00:11:24,360 --> 00:11:28,350
assessing them take a look at you know

273
00:11:26,010 --> 00:11:31,590
transport layer encryption can they do

274
00:11:28,350 --> 00:11:33,030
<font color="#CCCCCC">anything with TLS do they getting back</font>

275
00:11:31,590 --> 00:11:34,530
to<font color="#CCCCCC"> some</font><font color="#E5E5E5"> of the network monitoring things</font>

276
00:11:33,030 --> 00:11:36,900
can they take a look at okay<font color="#E5E5E5"> this is</font>

277
00:11:34,530 --> 00:11:39,420
signed<font color="#CCCCCC"> by a known bad certificate or or</font>

278
00:11:36,900 --> 00:11:41,310
anything along those lines and then as

279
00:11:39,420 --> 00:11:43,229
you're assessing this<font color="#E5E5E5"> device and walking</font>

280
00:11:41,310 --> 00:11:45,300
through it just slowly raise the bar as

281
00:11:43,230 --> 00:11:47,160
I've walked through some of these

282
00:11:45,300 --> 00:11:49,949
product assessments before<font color="#E5E5E5"> I'll start</font>

283
00:11:47,160 --> 00:11:52,199
off with a known<font color="#CCCCCC"> Trojan then make my own</font>

284
00:11:49,950 --> 00:11:57,690
executable<font color="#E5E5E5"> and then you know keep</font>

285
00:11:52,200 --> 00:12:00,089
stepping it up though here's a here's a

286
00:11:57,690 --> 00:12:02,399
nice example once<font color="#E5E5E5"> again from the mcafee</font>

287
00:12:00,089 --> 00:12:04,440
atv side these<font color="#CCCCCC"> are the types of files</font>

288
00:12:02,399 --> 00:12:07,350
<font color="#E5E5E5">that you'll typically see supported by</font>

289
00:12:04,440 --> 00:12:10,220
some<font color="#E5E5E5"> of these you know windows windows</font>

290
00:12:07,350 --> 00:12:14,790
PE files basically the executables<font color="#CCCCCC"> dll's</font>

291
00:12:10,220 --> 00:12:17,279
office files image files you know if

292
00:12:14,790 --> 00:12:18,779
you've seen<font color="#CCCCCC"> any</font><font color="#E5E5E5"> of the</font><font color="#CCCCCC"> Microsoft</font>

293
00:12:17,279 --> 00:12:20,910
bulletins in the last few years about

294
00:12:18,779 --> 00:12:22,890
the GDI library vulnerabilities you know

295
00:12:20,910 --> 00:12:24,870
a lot of<font color="#E5E5E5"> those</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> in images so we see a</font>

296
00:12:22,890 --> 00:12:26,819
lot of exploits going over those so

297
00:12:24,870 --> 00:12:31,110
honestly a kind<font color="#E5E5E5"> of an important one to</font>

298
00:12:26,820 --> 00:12:32,399
pay attention<font color="#E5E5E5"> to</font><font color="#CCCCCC"> and I love some of</font><font color="#E5E5E5"> this</font>

299
00:12:31,110 --> 00:12:35,459
information from<font color="#E5E5E5"> an assessment</font>

300
00:12:32,399 --> 00:12:37,470
standpoint straight out of a public faq

301
00:12:35,459 --> 00:12:40,229
you know a<font color="#E5E5E5"> lot of high-end corporate</font>

302
00:12:37,470 --> 00:12:42,899
products they'll password protect a lot

303
00:12:40,230 --> 00:12:45,240
of their support documents but no<font color="#CCCCCC"> Intel</font>

304
00:12:42,899 --> 00:12:47,279
didn't do it on this case so if you want

305
00:12:45,240 --> 00:12:49,230
<font color="#E5E5E5">to bypass look at that first box up</font>

306
00:12:47,279 --> 00:12:51,899
there<font color="#E5E5E5"> it'll show you these are</font><font color="#CCCCCC"> the</font>

307
00:12:49,230 --> 00:12:54,029
characters that you<font color="#E5E5E5"> can use so</font><font color="#CCCCCC"> that the</font>

308
00:12:51,899 --> 00:12:56,550
sandbox environment will not assess that

309
00:12:54,029 --> 00:12:58,320
executable so if you can slide one of

310
00:12:56,550 --> 00:13:00,149
those in you should<font color="#CCCCCC"> be able to slide</font>

311
00:12:58,320 --> 00:13:03,720
right<font color="#CCCCCC"> through and the sandbox cannot</font>

312
00:13:00,149 --> 00:13:05,670
analyze you in the<font color="#E5E5E5"> middle on</font><font color="#CCCCCC"> the right</font>

313
00:13:03,720 --> 00:13:09,660
side there's the default<font color="#CCCCCC"> password to the</font>

314
00:13:05,670 --> 00:13:11,160
administrator account the CLI admin

315
00:13:09,660 --> 00:13:15,560
basically the command line interface via

316
00:13:11,160 --> 00:13:17,910
<font color="#CCCCCC">SSH there are many many other</font>

317
00:13:15,560 --> 00:13:20,609
integration accounts that are listed<font color="#CCCCCC"> in</font>

318
00:13:17,910 --> 00:13:23,040
<font color="#E5E5E5">their public faq the lower right hand</font>

319
00:13:20,610 --> 00:13:25,620
corner talks about the operating systems

320
00:13:23,040 --> 00:13:28,020
that are supported I don't see windows 8

321
00:13:25,620 --> 00:13:29,610
on<font color="#CCCCCC"> the list</font><font color="#E5E5E5"> so something to keep in mind</font>

322
00:13:28,020 --> 00:13:31,529
when you're looking at these products as

323
00:13:29,610 --> 00:13:34,079
far as what they can support if you're a

324
00:13:31,529 --> 00:13:35,279
Citrix environment very important

325
00:13:34,079 --> 00:13:37,349
consideration as<font color="#CCCCCC"> well because you're</font>

326
00:13:35,279 --> 00:13:40,760
<font color="#E5E5E5">probably running a server OS and you</font>

327
00:13:37,350 --> 00:13:43,709
know may throw some kinks into that and

328
00:13:40,760 --> 00:13:45,569
then lower<font color="#CCCCCC"> left-hand corner of the</font>

329
00:13:43,709 --> 00:13:47,609
<font color="#E5E5E5">screen here we've</font><font color="#CCCCCC"> got these</font><font color="#E5E5E5"> are the</font>

330
00:13:45,570 --> 00:13:49,560
ports and communication protocols that

331
00:13:47,610 --> 00:13:53,250
are taking place on the<font color="#CCCCCC"> backend for this</font>

332
00:13:49,560 --> 00:13:54,599
sandboxing environment so personally

333
00:13:53,250 --> 00:13:56,370
when<font color="#E5E5E5"> I'm attacking a device i just love</font>

334
00:13:54,600 --> 00:13:58,620
gleaming all the information<font color="#E5E5E5"> i can off a</font>

335
00:13:56,370 --> 00:13:59,100
public site and you find<font color="#CCCCCC"> some</font><font color="#E5E5E5"> pretty</font>

336
00:13:58,620 --> 00:14:03,570
helpful in

337
00:13:59,100 --> 00:14:06,270
formation out there so<font color="#CCCCCC"> thanks mcafee and</font>

338
00:14:03,570 --> 00:14:07,410
as far<font color="#E5E5E5"> as the tools</font><font color="#CCCCCC"> I go</font><font color="#E5E5E5"> we'll start</font>

339
00:14:06,270 --> 00:14:10,410
getting<font color="#E5E5E5"> into a little bit of the meat of</font>

340
00:14:07,410 --> 00:14:12,209
<font color="#E5E5E5">the assessment</font><font color="#CCCCCC"> process these are</font><font color="#E5E5E5"> some of</font>

341
00:14:10,410 --> 00:14:15,150
the<font color="#E5E5E5"> some of the standard tools plus a</font>

342
00:14:12,210 --> 00:14:18,210
couple<font color="#E5E5E5"> other interesting tools that have</font>

343
00:14:15,150 --> 00:14:21,090
come out recently a PE cloak for example

344
00:14:18,210 --> 00:14:22,740
<font color="#E5E5E5">that's one just very recently came out</font>

345
00:14:21,090 --> 00:14:24,470
kind<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> proof-of-concept</font><font color="#E5E5E5"> tool I'll</font>

346
00:14:22,740 --> 00:14:26,700
briefly touch on that one in a minute

347
00:14:24,470 --> 00:14:31,500
but then some<font color="#E5E5E5"> of these are pretty</font>

348
00:14:26,700 --> 00:14:33,000
standard ones as well so first step that

349
00:14:31,500 --> 00:14:36,600
I do when I'm assessing one of these

350
00:14:33,000 --> 00:14:38,370
<font color="#E5E5E5">boxes metasploit is pretty much</font><font color="#CCCCCC"> the</font>

351
00:14:36,600 --> 00:14:40,020
easiest<font color="#E5E5E5"> thing out there de facto</font>

352
00:14:38,370 --> 00:14:43,470
standard as far as you know your tool

353
00:14:40,020 --> 00:14:47,069
suite goes it's so easy to create

354
00:14:43,470 --> 00:14:49,260
executables that are malicious you know

355
00:14:47,070 --> 00:14:51,510
make them<font color="#CCCCCC"> a memory resident rather than</font>

356
00:14:49,260 --> 00:14:53,930
on the<font color="#E5E5E5"> disk you can do</font><font color="#CCCCCC"> all kinds of</font>

357
00:14:51,510 --> 00:14:57,060
pretty pretty fun magic with that so a

358
00:14:53,930 --> 00:15:00,959
standard executable my second bullet

359
00:14:57,060 --> 00:15:02,310
point there on MSF venom if you've used

360
00:15:00,960 --> 00:15:04,860
any<font color="#E5E5E5"> of this in the past it used to be</font>

361
00:15:02,310 --> 00:15:06,300
MSF in code and MSF payload you<font color="#CCCCCC"> can use</font>

362
00:15:04,860 --> 00:15:08,430
<font color="#CCCCCC">some of that to wrap up</font><font color="#E5E5E5"> and executable</font>

363
00:15:06,300 --> 00:15:11,069
it's all wrapped up in MSF venom now and

364
00:15:08,430 --> 00:15:15,000
that command line will basically just

365
00:15:11,070 --> 00:15:17,610
make you a reverse<font color="#E5E5E5"> HTTPS so encrypted a</font>

366
00:15:15,000 --> 00:15:21,590
reverse meterpreter shell which is

367
00:15:17,610 --> 00:15:24,840
basically<font color="#CCCCCC"> metasploit command and control</font>

368
00:15:21,590 --> 00:15:26,880
type of type of backdoor executable or

369
00:15:24,840 --> 00:15:28,710
you can launch further attacks so nice

370
00:15:26,880 --> 00:15:31,200
standard command there to just make

371
00:15:28,710 --> 00:15:33,690
something baseline shove it across<font color="#CCCCCC"> the</font>

372
00:15:31,200 --> 00:15:36,960
wire see if see if the<font color="#E5E5E5"> box catches it</font>

373
00:15:33,690 --> 00:15:38,580
see if it knows what's going on right

374
00:15:36,960 --> 00:15:41,340
off the bat<font color="#CCCCCC"> on that very first bullet</font>

375
00:15:38,580 --> 00:15:43,500
point<font color="#CCCCCC"> I can tell you one of</font><font color="#E5E5E5"> the major</font>

376
00:15:41,340 --> 00:15:47,340
market players doesn't play too well

377
00:15:43,500 --> 00:15:50,430
with that one just<font color="#CCCCCC"> because</font><font color="#E5E5E5"> it's a stager</font>

378
00:15:47,340 --> 00:15:52,560
based payload so when you execute it it

379
00:15:50,430 --> 00:15:56,550
may or may not look malicious and then

380
00:15:52,560 --> 00:15:59,670
all of the actual<font color="#E5E5E5"> bad juju comes in over</font>

381
00:15:56,550 --> 00:16:01,469
the network and<font color="#E5E5E5"> in memory only and some</font>

382
00:15:59,670 --> 00:16:04,020
of these guys if<font color="#E5E5E5"> they don't touch the</font>

383
00:16:01,470 --> 00:16:08,250
<font color="#CCCCCC">disk the product isn't going to find it</font>

384
00:16:04,020 --> 00:16:10,260
and<font color="#CCCCCC"> then if you want to up the bar</font><font color="#E5E5E5"> just</font>

385
00:16:08,250 --> 00:16:11,790
slightly using<font color="#CCCCCC"> metasploit before we get</font>

386
00:16:10,260 --> 00:16:14,010
to<font color="#E5E5E5"> other techniques</font>

387
00:16:11,790 --> 00:16:16,500
you can basically use a<font color="#CCCCCC"> Trojan</font>

388
00:16:14,010 --> 00:16:18,630
executable and this is so<font color="#E5E5E5"> easy to do one</font>

389
00:16:16,500 --> 00:16:20,070
<font color="#CCCCCC">of my favorites to do the first</font><font color="#E5E5E5"> man line</font>

390
00:16:18,630 --> 00:16:21,720
when you make it uses the built-in

391
00:16:20,070 --> 00:16:23,510
<font color="#CCCCCC">metasploit template which a lot of</font>

392
00:16:21,720 --> 00:16:26,160
antivirus vendors will pick that<font color="#E5E5E5"> one up</font>

393
00:16:23,510 --> 00:16:29,580
it's really<font color="#E5E5E5"> simple to grab your</font><font color="#CCCCCC"> own</font>

394
00:16:26,160 --> 00:16:31,230
executable and<font color="#E5E5E5"> Trojan eyes it with with</font>

395
00:16:29,580 --> 00:16:33,840
basically<font color="#E5E5E5"> your</font><font color="#CCCCCC"> metasploit payload it's</font>

396
00:16:31,230 --> 00:16:35,930
as simple as dash<font color="#CCCCCC"> K for keep the</font>

397
00:16:33,840 --> 00:16:38,430
existing functionality of this

398
00:16:35,930 --> 00:16:40,920
executable and then dash X for the

399
00:16:38,430 --> 00:16:43,140
template and I<font color="#E5E5E5"> always used putty</font><font color="#CCCCCC"> Exe as</font>

400
00:16:40,920 --> 00:16:44,790
a as a nice template because when you

401
00:16:43,140 --> 00:16:46,410
double click it it stays open which

402
00:16:44,790 --> 00:16:49,290
means<font color="#E5E5E5"> your session stays resident so</font>

403
00:16:46,410 --> 00:16:50,910
real easy executable to use and you know

404
00:16:49,290 --> 00:16:54,650
you'd be<font color="#E5E5E5"> surprised how often just as</font>

405
00:16:50,910 --> 00:16:58,610
much as that<font color="#E5E5E5"> will bypass some of this</font>

406
00:16:54,650 --> 00:17:03,329
<font color="#E5E5E5">hyperion anyone use Hyperion before</font>

407
00:16:58,610 --> 00:17:05,760
awesome you<font color="#CCCCCC"> know great easy tool this</font>

408
00:17:03,330 --> 00:17:08,460
one pretty<font color="#E5E5E5"> simple to use if you're Kali</font>

409
00:17:05,760 --> 00:17:10,619
<font color="#E5E5E5">Linux use it user out there it's already</font>

410
00:17:08,460 --> 00:17:14,250
<font color="#E5E5E5">on the system it's just a matter of</font>

411
00:17:10,619 --> 00:17:16,439
unzipping it<font color="#E5E5E5"> compiling it with the</font>

412
00:17:14,250 --> 00:17:18,359
windows compiler on there<font color="#E5E5E5"> and then just</font>

413
00:17:16,440 --> 00:17:20,070
running it via wine on your cali

414
00:17:18,359 --> 00:17:22,139
instance so you can do everything

415
00:17:20,069 --> 00:17:23,970
<font color="#E5E5E5">completely self-contained in cali and</font>

416
00:17:22,140 --> 00:17:26,340
it's as simple as a few command lines

417
00:17:23,970 --> 00:17:28,410
and<font color="#CCCCCC"> you can take that previous</font>

418
00:17:26,339 --> 00:17:31,290
executable that<font color="#CCCCCC"> you made in metasploit</font>

419
00:17:28,410 --> 00:17:33,360
for example run Hyperion on that

420
00:17:31,290 --> 00:17:35,879
executable and make an output from that

421
00:17:33,360 --> 00:17:37,860
and then you have a cryptid output that

422
00:17:35,880 --> 00:17:41,010
is a little bit more difficult<font color="#CCCCCC"> for</font>

423
00:17:37,860 --> 00:17:42,870
antivirus to catch so another thing that

424
00:17:41,010 --> 00:17:45,150
you<font color="#E5E5E5"> can use</font><font color="#CCCCCC"> to throw that against</font><font color="#E5E5E5"> the</font>

425
00:17:42,870 --> 00:17:48,060
sandbox see if they catch it<font color="#E5E5E5"> if they're</font>

426
00:17:45,150 --> 00:17:50,190
truly doing heuristic type analysis they

427
00:17:48,060 --> 00:17:52,710
should catch it<font color="#E5E5E5"> and if they don't you</font>

428
00:17:50,190 --> 00:17:54,420
<font color="#CCCCCC">know</font><font color="#E5E5E5"> go back to your vendor and ask why</font>

429
00:17:52,710 --> 00:18:00,210
you can't catch something as simple as

430
00:17:54,420 --> 00:18:03,590
that and then the veil framework any

431
00:18:00,210 --> 00:18:06,990
veil users awesome a few more a few more

432
00:18:03,590 --> 00:18:08,850
so once again going back<font color="#CCCCCC"> to Cali pretty</font>

433
00:18:06,990 --> 00:18:12,230
easy to get this installed on there<font color="#E5E5E5"> just</font>

434
00:18:08,850 --> 00:18:14,969
a couple app gets run veil evasion

435
00:18:12,230 --> 00:18:18,000
directly<font color="#E5E5E5"> Python script and it's a</font>

436
00:18:14,970 --> 00:18:20,250
complete menu driven system it's so easy

437
00:18:18,000 --> 00:18:22,260
<font color="#E5E5E5">to use at that point so you can tell it</font>

438
00:18:20,250 --> 00:18:25,030
you want this payload you know

439
00:18:22,260 --> 00:18:28,870
just just basically drive down menu and

440
00:18:25,030 --> 00:18:30,220
and you can pretty easily get<font color="#CCCCCC"> out a nice</font>

441
00:18:28,870 --> 00:18:32,139
executable that<font color="#CCCCCC"> you can throw against</font>

442
00:18:30,220 --> 00:18:34,210
your sandbox just another set of steps

443
00:18:32,140 --> 00:18:39,220
to test and see if<font color="#E5E5E5"> it's going to</font><font color="#CCCCCC"> catch</font>

444
00:18:34,210 --> 00:18:41,890
that<font color="#E5E5E5"> style and PE cloak this one was was</font>

445
00:18:39,220 --> 00:18:43,300
a really interesting read I've got a

446
00:18:41,890 --> 00:18:46,570
link<font color="#E5E5E5"> to this one in the references at</font>

447
00:18:43,300 --> 00:18:48,010
the end so the author of this one is his

448
00:18:46,570 --> 00:18:50,470
name escapes me at the moment<font color="#E5E5E5"> but the</font>

449
00:18:48,010 --> 00:18:52,180
the author had taken a couple of the

450
00:18:50,470 --> 00:18:53,500
offensive<font color="#E5E5E5"> security classes and they</font>

451
00:18:52,180 --> 00:18:54,880
<font color="#CCCCCC">talked about</font><font color="#E5E5E5"> it you know one of the</font>

452
00:18:53,500 --> 00:18:57,490
classes is cracking the perimeter

453
00:18:54,880 --> 00:18:59,260
getting malware past and past the

454
00:18:57,490 --> 00:19:01,450
perimeter<font color="#E5E5E5"> and in so you can start</font>

455
00:18:59,260 --> 00:19:04,450
launching a social engineering attack or

456
00:19:01,450 --> 00:19:07,450
get<font color="#E5E5E5"> Trojans through and he wanted to</font>

457
00:19:04,450 --> 00:19:10,510
<font color="#E5E5E5">find an easy way to write an encoding</font>

458
00:19:07,450 --> 00:19:14,650
and decoding routine just using simple

459
00:19:10,510 --> 00:19:17,230
add subtract and xor functions and a way

460
00:19:14,650 --> 00:19:20,860
<font color="#E5E5E5">to bypass simple heuristics on</font>

461
00:19:17,230 --> 00:19:23,710
executables and then he used this

462
00:19:20,860 --> 00:19:25,889
concept he calls code caves to hide code

463
00:19:23,710 --> 00:19:29,080
within the executable<font color="#E5E5E5"> endpoints that</font>

464
00:19:25,890 --> 00:19:32,080
that antivirus doesn't expect to look

465
00:19:29,080 --> 00:19:34,389
but still doesn't set off heuristics so

466
00:19:32,080 --> 00:19:38,679
there<font color="#CCCCCC"> are a few example command lines</font>

467
00:19:34,390 --> 00:19:39,670
below this one it's hard<font color="#E5E5E5"> to get it up</font>

468
00:19:38,680 --> 00:19:42,220
and running with some of the

469
00:19:39,670 --> 00:19:43,900
dependencies because they they're kind

470
00:19:42,220 --> 00:19:46,180
of documented out on this guy's link

471
00:19:43,900 --> 00:19:47,260
that<font color="#E5E5E5"> I have at the end</font><font color="#CCCCCC"> of the slides but</font>

472
00:19:46,180 --> 00:19:50,350
<font color="#E5E5E5">it takes a while to get up and running</font>

473
00:19:47,260 --> 00:19:52,150
<font color="#CCCCCC">and then he has awesome examples right</font>

474
00:19:50,350 --> 00:19:55,800
there on his website of this is how i by

475
00:19:52,150 --> 00:19:58,030
passed kaspersky this is how i by passed

476
00:19:55,800 --> 00:19:59,950
mcafee this is how<font color="#E5E5E5"> i bypass security</font>

477
00:19:58,030 --> 00:20:01,480
essentials so they're working examples

478
00:19:59,950 --> 00:20:04,480
out there for every single<font color="#E5E5E5"> one of these</font>

479
00:20:01,480 --> 00:20:06,580
so another<font color="#CCCCCC"> great thing to take throw it</font>

480
00:20:04,480 --> 00:20:09,190
at your sandbox it should bypass

481
00:20:06,580 --> 00:20:11,350
antivirus but if it's a<font color="#E5E5E5"> good sandbox it</font>

482
00:20:09,190 --> 00:20:16,750
should still catch that it's doing

483
00:20:11,350 --> 00:20:18,850
<font color="#E5E5E5">malicious things if you're scripter</font>

484
00:20:16,750 --> 00:20:20,950
there are plenty<font color="#E5E5E5"> of programs out there</font>

485
00:20:18,850 --> 00:20:22,480
to take your your<font color="#CCCCCC"> python your pearl your</font>

486
00:20:20,950 --> 00:20:25,480
VBS whatever and turn it into an

487
00:20:22,480 --> 00:20:27,300
executable this is you know one of the

488
00:20:25,480 --> 00:20:28,990
tricks that I use a lot of<font color="#E5E5E5"> time</font>

489
00:20:27,300 --> 00:20:31,360
antivirus is never going to catch it

490
00:20:28,990 --> 00:20:32,860
because you're writing something custom

491
00:20:31,360 --> 00:20:35,100
and<font color="#E5E5E5"> then turning it into an executable</font>

492
00:20:32,860 --> 00:20:37,678
so it's a really<font color="#CCCCCC"> easy way</font>

493
00:20:35,100 --> 00:20:39,510
to to bypass some of the basic checks

494
00:20:37,679 --> 00:20:43,230
and get<font color="#E5E5E5"> into a sandbox and see if it</font>

495
00:20:39,510 --> 00:20:46,650
actually finds<font color="#E5E5E5"> something malicious the</font>

496
00:20:43,230 --> 00:20:49,020
first link up there is to turn pearl

497
00:20:46,650 --> 00:20:51,150
into an executable and<font color="#E5E5E5"> at the</font><font color="#CCCCCC"> bottom</font>

498
00:20:49,020 --> 00:20:53,610
there's a simple<font color="#CCCCCC"> command line if you</font>

499
00:20:51,150 --> 00:20:56,640
have the right module the PI installer

500
00:20:53,610 --> 00:20:58,469
module just a simple<font color="#E5E5E5"> one-line command</font>

501
00:20:56,640 --> 00:21:01,169
line to turn a<font color="#E5E5E5"> Python script into an</font>

502
00:20:58,470 --> 00:21:04,410
executable<font color="#E5E5E5"> and another nice way you know</font>

503
00:21:01,169 --> 00:21:06,510
if your pen testing red teaming just

504
00:21:04,410 --> 00:21:07,770
basically taking a<font color="#CCCCCC"> Python script and</font>

505
00:21:06,510 --> 00:21:09,330
running it in an environment that

506
00:21:07,770 --> 00:21:11,429
<font color="#CCCCCC">doesn't have Python switch it to an</font>

507
00:21:09,330 --> 00:21:16,949
executable using that command line and

508
00:21:11,429 --> 00:21:19,559
<font color="#CCCCCC">now you've got a portable file and this</font>

509
00:21:16,950 --> 00:21:21,720
is one<font color="#CCCCCC"> of my favorite tricks to do red</font>

510
00:21:19,559 --> 00:21:24,990
teaming pen testing or when I do

511
00:21:21,720 --> 00:21:27,780
assessments like this VBS it'll run<font color="#CCCCCC"> on</font>

512
00:21:24,990 --> 00:21:31,200
any Windows machine it's easy to program

513
00:21:27,780 --> 00:21:32,908
real<font color="#E5E5E5"> simple you can make something</font>

514
00:21:31,200 --> 00:21:36,150
custom that<font color="#E5E5E5"> you know it's going to</font>

515
00:21:32,909 --> 00:21:38,010
bypass antivirus or quite honestly a lot

516
00:21:36,150 --> 00:21:42,360
of these sandbox environments don't even

517
00:21:38,010 --> 00:21:44,129
test VBS but we can also then convert<font color="#CCCCCC"> it</font>

518
00:21:42,360 --> 00:21:46,080
to an executable that<font color="#CCCCCC"> we can get to</font>

519
00:21:44,130 --> 00:21:47,159
launch in the sandbox now this is one of

520
00:21:46,080 --> 00:21:49,590
<font color="#E5E5E5">the techniques that will show a little</font>

521
00:21:47,159 --> 00:21:52,409
bit later<font color="#CCCCCC"> on that I actually used</font>

522
00:21:49,590 --> 00:21:55,500
<font color="#E5E5E5">against the mcafee a TD sandbox to to do</font>

523
00:21:52,409 --> 00:21:57,960
some nice attacking so there's a

524
00:21:55,500 --> 00:22:00,600
built-in command on<font color="#E5E5E5"> Windows that's been</font>

525
00:21:57,960 --> 00:22:03,539
around for a<font color="#CCCCCC"> while it's called I express</font>

526
00:22:00,600 --> 00:22:06,780
and it's<font color="#E5E5E5"> basically think of it as an</font>

527
00:22:03,539 --> 00:22:08,429
install shield program so one<font color="#CCCCCC"> of the</font>

528
00:22:06,780 --> 00:22:10,620
easiest ways to do this is you make your

529
00:22:08,429 --> 00:22:12,120
make your<font color="#E5E5E5"> script that does VBS you know</font>

530
00:22:10,620 --> 00:22:16,770
run a system command net add user

531
00:22:12,120 --> 00:22:19,830
whatever you<font color="#E5E5E5"> launch i express you add</font>

532
00:22:16,770 --> 00:22:21,990
your evil VBS file to the package that

533
00:22:19,830 --> 00:22:24,928
it's going<font color="#E5E5E5"> to zip up and then on the</font>

534
00:22:21,990 --> 00:22:27,720
next page you can say run this arbitrary

535
00:22:24,929 --> 00:22:29,429
command when you when you expand this

536
00:22:27,720 --> 00:22:32,429
package and you<font color="#CCCCCC"> can just</font><font color="#E5E5E5"> tell it run</font>

537
00:22:29,429 --> 00:22:34,409
cscript evil VBS so basically its

538
00:22:32,429 --> 00:22:36,570
packaging up your VBS and executing it

539
00:22:34,409 --> 00:22:39,590
once it's open so really easy way to

540
00:22:36,570 --> 00:22:42,270
turn<font color="#E5E5E5"> a VBS file into an executable and</font>

541
00:22:39,590 --> 00:22:44,370
once<font color="#E5E5E5"> again it'll</font><font color="#CCCCCC"> be your own custom</font>

542
00:22:42,270 --> 00:22:48,530
script which means it's going to bypass

543
00:22:44,370 --> 00:22:48,530
antivirus there's no signature for it

544
00:22:51,929 --> 00:22:56,740
so as<font color="#CCCCCC"> you as you go through some</font><font color="#E5E5E5"> of</font>

545
00:22:54,850 --> 00:22:59,649
these different methods you know how did

546
00:22:56,740 --> 00:23:01,630
the product do how did it how did<font color="#E5E5E5"> it</font>

547
00:22:59,649 --> 00:23:03,879
detect them if it was an inline blocker

548
00:23:01,630 --> 00:23:06,700
did it actually block it what was the

549
00:23:03,880 --> 00:23:09,760
lag<font color="#CCCCCC"> time between when it detected and</font>

550
00:23:06,700 --> 00:23:12,549
when the block was in place how large

551
00:23:09,760 --> 00:23:16,200
was the sandbox backlog can it chug

552
00:23:12,549 --> 00:23:18,549
through this stuff pretty quickly or no

553
00:23:16,200 --> 00:23:19,990
<font color="#CCCCCC">mcafee picked on fire I</font><font color="#E5E5E5"> a while back</font>

554
00:23:18,549 --> 00:23:21,370
saying that they could backlog their

555
00:23:19,990 --> 00:23:22,480
device so much that they could<font color="#CCCCCC"> just</font>

556
00:23:21,370 --> 00:23:23,830
start sending malware through the

557
00:23:22,480 --> 00:23:26,880
company and it wouldn't catch it because

558
00:23:23,830 --> 00:23:30,519
the backlog was so huge so keep<font color="#E5E5E5"> special</font>

559
00:23:26,880 --> 00:23:32,169
interest around that one can we and

560
00:23:30,519 --> 00:23:34,240
basically on that same note can we

561
00:23:32,169 --> 00:23:35,740
overload it with safe files shove

562
00:23:34,240 --> 00:23:38,230
through a bunch<font color="#E5E5E5"> of executables a bunch</font>

563
00:23:35,740 --> 00:23:41,279
of<font color="#E5E5E5"> PDFs if you can overload it it's</font>

564
00:23:38,230 --> 00:23:47,710
pretty<font color="#E5E5E5"> easy to bypass at that point and</font>

565
00:23:41,279 --> 00:23:51,970
any sandbox<font color="#CCCCCC"> Network leakage I had 11</font>

566
00:23:47,710 --> 00:23:53,799
major vendor that<font color="#E5E5E5"> I assessed I at one</font>

567
00:23:51,970 --> 00:23:56,200
point using some<font color="#CCCCCC"> of these techniques on</font>

568
00:23:53,799 --> 00:23:59,019
the last page I got their device to talk

569
00:23:56,200 --> 00:24:00,940
out to my<font color="#E5E5E5"> host on the internet basically</font>

570
00:23:59,019 --> 00:24:03,610
showing me that you're running<font color="#E5E5E5"> this</font>

571
00:24:00,940 --> 00:24:04,960
device on your network and<font color="#CCCCCC"> their</font>

572
00:24:03,610 --> 00:24:06,969
engineers called me up<font color="#E5E5E5"> on the phone and</font>

573
00:24:04,960 --> 00:24:08,980
<font color="#CCCCCC">said this is not possible or device is</font>

574
00:24:06,970 --> 00:24:11,559
not meant to do that like well sorry

575
00:24:08,980 --> 00:24:13,450
here are the steps to<font color="#E5E5E5"> reproduce and they</font>

576
00:24:11,559 --> 00:24:15,340
would not change their device until I

577
00:24:13,450 --> 00:24:19,179
<font color="#E5E5E5">gave them a packet capture which I</font>

578
00:24:15,340 --> 00:24:20,980
didn't have so there's a you know some

579
00:24:19,179 --> 00:24:24,279
of these vendors are vulnerable<font color="#CCCCCC"> to this</font>

580
00:24:20,980 --> 00:24:30,340
type of stuff<font color="#E5E5E5"> so be sure to test them if</font>

581
00:24:24,279 --> 00:24:33,340
you do get<font color="#E5E5E5"> a packet capture and then one</font>

582
00:24:30,340 --> 00:24:34,600
of<font color="#E5E5E5"> the more interesting</font><font color="#CCCCCC"> things to some</font>

583
00:24:33,340 --> 00:24:38,620
of the stuff when I test it I serve it

584
00:24:34,600 --> 00:24:40,600
up from a public IP address and maybe

585
00:24:38,620 --> 00:24:42,309
you send an email with a link to<font color="#CCCCCC"> an</font>

586
00:24:40,600 --> 00:24:45,039
executable<font color="#E5E5E5"> and that's how you download</font>

587
00:24:42,309 --> 00:24:46,240
<font color="#CCCCCC">it and test it so there's only one email</font>

588
00:24:45,039 --> 00:24:48,129
address that you've ever sent that link

589
00:24:46,240 --> 00:24:49,840
<font color="#CCCCCC">to within</font><font color="#E5E5E5"> five minutes you'll start</font>

590
00:24:48,130 --> 00:24:52,299
seeing that file be requested<font color="#E5E5E5"> from</font>

591
00:24:49,840 --> 00:24:55,480
multiple servers around the world and

592
00:24:52,299 --> 00:24:57,970
this ties back<font color="#CCCCCC"> to some</font><font color="#E5E5E5"> of those threat</font>

593
00:24:55,480 --> 00:25:00,500
intelligence feeds a lot of these

594
00:24:57,970 --> 00:25:02,030
vendors feed the stuff right up to

595
00:25:00,500 --> 00:25:03,980
cloud services that go<font color="#CCCCCC"> out and verify</font>

596
00:25:02,030 --> 00:25:05,600
from multiple geographic locations

597
00:25:03,980 --> 00:25:08,030
around the<font color="#CCCCCC"> world to see if that</font><font color="#E5E5E5"> file</font><font color="#CCCCCC"> is</font>

598
00:25:05,600 --> 00:25:11,209
available and they use that<font color="#CCCCCC"> to see if</font>

599
00:25:08,030 --> 00:25:14,240
you're a malicious host if you're

600
00:25:11,210 --> 00:25:16,970
targeting a company directly or a region

601
00:25:14,240 --> 00:25:18,500
directly so if you're testing this stuff

602
00:25:16,970 --> 00:25:20,600
from home on a product<font color="#CCCCCC"> that you're</font>

603
00:25:18,500 --> 00:25:23,270
assessing don't get yourself blacklisted

604
00:25:20,600 --> 00:25:24,709
you know maybe maybe think about where

605
00:25:23,270 --> 00:25:27,260
you're serving some<font color="#CCCCCC"> of the stuff up from</font>

606
00:25:24,710 --> 00:25:29,090
or you know<font color="#E5E5E5"> wills presentation earlier</font>

607
00:25:27,260 --> 00:25:31,430
today<font color="#CCCCCC"> I talked a lot about having hosts</font>

608
00:25:29,090 --> 00:25:32,720
and changing IP addresses so maybe

609
00:25:31,430 --> 00:25:35,450
something<font color="#E5E5E5"> to think about if you're doing</font>

610
00:25:32,720 --> 00:25:36,860
a lot of<font color="#E5E5E5"> this work and then</font><font color="#CCCCCC"> you know are</font>

611
00:25:35,450 --> 00:25:38,780
there any telltale<font color="#E5E5E5"> signs you're in a San</font>

612
00:25:36,860 --> 00:25:43,340
<font color="#CCCCCC">your signs that you're in a sandbox you</font>

613
00:25:38,780 --> 00:25:45,620
know<font color="#E5E5E5"> VMware checks things like</font><font color="#CCCCCC"> that so</font>

614
00:25:43,340 --> 00:25:49,370
talking a little bit<font color="#E5E5E5"> more on internet</font>

615
00:25:45,620 --> 00:25:53,620
access this gets this gets pretty tricky

616
00:25:49,370 --> 00:25:56,030
going back to<font color="#CCCCCC"> that example</font><font color="#E5E5E5"> of using a</font>

617
00:25:53,620 --> 00:25:59,179
stager where the payload gets downloaded

618
00:25:56,030 --> 00:26:01,879
and it's all memory only<font color="#E5E5E5"> if if the</font>

619
00:25:59,180 --> 00:26:03,350
sandbox that I did<font color="#E5E5E5"> that on</font><font color="#CCCCCC"> we're</font>

620
00:26:01,880 --> 00:26:04,970
<font color="#E5E5E5">bypassed</font><font color="#CCCCCC"> it if they had internet access</font>

621
00:26:03,350 --> 00:26:06,199
they'd see that loader come in and they

622
00:26:04,970 --> 00:26:09,430
would see<font color="#E5E5E5"> that it was malicious and</font>

623
00:26:06,200 --> 00:26:11,660
they'd have the ability to to flag on it

624
00:26:09,430 --> 00:26:13,580
but if they allowed internet access for

625
00:26:11,660 --> 00:26:16,220
that to happen do<font color="#E5E5E5"> you really want</font>

626
00:26:13,580 --> 00:26:18,020
<font color="#E5E5E5">malware getting out to the internet from</font>

627
00:26:16,220 --> 00:26:20,900
your company may be scanning others

628
00:26:18,020 --> 00:26:24,920
attacking others so there's a there's a

629
00:26:20,900 --> 00:26:27,170
pretty fine balance you want to walk if

630
00:26:24,920 --> 00:26:30,680
these products<font color="#CCCCCC"> have the ability</font><font color="#E5E5E5"> to add</font>

631
00:26:27,170 --> 00:26:32,060
internet access and one of the one<font color="#CCCCCC"> of</font>

632
00:26:30,680 --> 00:26:34,700
<font color="#E5E5E5">the biggest things you want to look</font><font color="#CCCCCC"> for</font>

633
00:26:32,060 --> 00:26:40,610
is ok you have<font color="#E5E5E5"> internet access what port</font>

634
00:26:34,700 --> 00:26:41,960
is it going out of can<font color="#E5E5E5"> you imagine like</font>

635
00:26:40,610 --> 00:26:44,080
first<font color="#E5E5E5"> of all where would you put the</font>

636
00:26:41,960 --> 00:26:46,190
management interface on this device

637
00:26:44,080 --> 00:26:50,290
anyone shout it out where would you

638
00:26:46,190 --> 00:26:50,290
where'd you<font color="#E5E5E5"> put that on your network</font>

639
00:26:52,240 --> 00:26:57,020
exactly exactly you want<font color="#CCCCCC"> it somewhere</font>

640
00:26:55,340 --> 00:26:58,659
where<font color="#E5E5E5"> no one else can get to it it's</font>

641
00:26:57,020 --> 00:27:02,090
your device<font color="#CCCCCC"> you want</font><font color="#E5E5E5"> to manage it there</font>

642
00:26:58,660 --> 00:27:04,100
so if the internet access comes out of

643
00:27:02,090 --> 00:27:05,840
that management interface where do<font color="#E5E5E5"> you</font>

644
00:27:04,100 --> 00:27:09,050
<font color="#E5E5E5">think we're dumping this malware that</font>

645
00:27:05,840 --> 00:27:12,919
we're knowingly running so something to

646
00:27:09,050 --> 00:27:14,000
keep a very<font color="#E5E5E5"> big eye on this this does</font>

647
00:27:12,920 --> 00:27:16,330
happen<font color="#E5E5E5"> on</font>

648
00:27:14,000 --> 00:27:18,920
these products<font color="#E5E5E5"> this does happen and</font>

649
00:27:16,330 --> 00:27:20,330
another<font color="#E5E5E5"> thing to consider you know how</font>

650
00:27:18,920 --> 00:27:23,540
long is the internet access open maybe

651
00:27:20,330 --> 00:27:24,949
we do a five-minute window or is it

652
00:27:23,540 --> 00:27:29,960
going<font color="#E5E5E5"> to run as long as the malware</font>

653
00:27:24,950 --> 00:27:31,880
keeps doing new stuff so coming back<font color="#CCCCCC"> to</font>

654
00:27:29,960 --> 00:27:34,010
pick<font color="#E5E5E5"> on mcafee again here just a</font><font color="#CCCCCC"> little</font>

655
00:27:31,880 --> 00:27:36,490
bit dead center<font color="#CCCCCC"> in the middle</font><font color="#E5E5E5"> of this</font>

656
00:27:34,010 --> 00:27:41,980
quote talking about internet access

657
00:27:36,490 --> 00:27:44,480
let's see<font color="#E5E5E5"> what do we have threat</font>

658
00:27:41,980 --> 00:27:45,710
advanced threat defense provides real

659
00:27:44,480 --> 00:27:50,120
internet connection through the

660
00:27:45,710 --> 00:27:52,400
management port by default something you

661
00:27:50,120 --> 00:27:53,689
want<font color="#CCCCCC"> to pay attention to</font><font color="#E5E5E5"> it's maybe one</font>

662
00:27:52,400 --> 00:27:54,860
of<font color="#E5E5E5"> the biggest security companies on the</font>

663
00:27:53,690 --> 00:27:56,810
planet but that doesn't mean that

664
00:27:54,860 --> 00:27:59,030
<font color="#E5E5E5">everything right out of the box is the</font>

665
00:27:56,810 --> 00:28:01,550
way you want it and by the<font color="#E5E5E5"> way this was</font>

666
00:27:59,030 --> 00:28:08,810
a one paragraph on page 234 of the guide

667
00:28:01,550 --> 00:28:11,389
so good luck so this is<font color="#CCCCCC"> where the fun</font>

668
00:28:08,810 --> 00:28:15,080
stuff starts for<font color="#CCCCCC"> me I i love getting</font>

669
00:28:11,390 --> 00:28:16,760
vendor products in attacking them<font color="#CCCCCC"> okay</font>

670
00:28:15,080 --> 00:28:18,740
so we tested a little bit what kind<font color="#E5E5E5"> of</font>

671
00:28:16,760 --> 00:28:21,050
malware can<font color="#E5E5E5"> they pick up that's great</font>

672
00:28:18,740 --> 00:28:22,940
and all but I love attacking the box

673
00:28:21,050 --> 00:28:25,370
itself welcome what can<font color="#E5E5E5"> we do with this</font>

674
00:28:22,940 --> 00:28:27,890
<font color="#E5E5E5">device you know over the years have</font>

675
00:28:25,370 --> 00:28:30,260
found that security<font color="#CCCCCC"> tumpa company does</font>

676
00:28:27,890 --> 00:28:34,430
not not mean that it's a secure product

677
00:28:30,260 --> 00:28:35,690
a lot of times you<font color="#E5E5E5"> know people are real</font>

678
00:28:34,430 --> 00:28:37,610
good at pointing fingers at other people

679
00:28:35,690 --> 00:28:39,920
who are<font color="#E5E5E5"> doing things wrong but don't</font>

680
00:28:37,610 --> 00:28:42,379
look in at their own house so I love

681
00:28:39,920 --> 00:28:44,440
taking a look at those so just about all

682
00:28:42,380 --> 00:28:46,550
these have web interfaces anymore and

683
00:28:44,440 --> 00:28:48,860
companies that specialize in security

684
00:28:46,550 --> 00:28:51,200
don't necessarily specialize in web

685
00:28:48,860 --> 00:28:53,959
development so it's always<font color="#E5E5E5"> good to</font>

686
00:28:51,200 --> 00:28:56,900
perform a complete authorization and

687
00:28:53,960 --> 00:28:58,910
authentication audit of all the

688
00:28:56,900 --> 00:29:02,180
available pages<font color="#E5E5E5"> out there because you'll</font>

689
00:28:58,910 --> 00:29:04,040
<font color="#CCCCCC">be surprised what you can find and on</font>

690
00:29:02,180 --> 00:29:06,410
the sandbox<font color="#CCCCCC"> guests if there's any way</font>

691
00:29:04,040 --> 00:29:08,240
that you can<font color="#E5E5E5"> access the guest what type</font>

692
00:29:06,410 --> 00:29:11,360
of services are<font color="#E5E5E5"> listening on that box</font>

693
00:29:08,240 --> 00:29:13,880
itself what type of network access does

694
00:29:11,360 --> 00:29:16,250
that box have and then maybe on the

695
00:29:13,880 --> 00:29:18,350
<font color="#E5E5E5">network sandboxing appliance itself what</font>

696
00:29:16,250 --> 00:29:20,330
kind of ports are open on that just kind

697
00:29:18,350 --> 00:29:24,379
of get that foot print out and figure

698
00:29:20,330 --> 00:29:26,600
out what the attack surface is and<font color="#E5E5E5"> I</font>

699
00:29:24,380 --> 00:29:27,389
have found<font color="#E5E5E5"> the public help files to</font><font color="#CCCCCC"> be</font>

700
00:29:26,600 --> 00:29:29,070
extremely

701
00:29:27,389 --> 00:29:30,689
helpful like<font color="#E5E5E5"> we looked at at a minute</font>

702
00:29:29,070 --> 00:29:32,458
ago some of the you know the

703
00:29:30,690 --> 00:29:35,789
administrator<font color="#CCCCCC"> account the command-line</font>

704
00:29:32,459 --> 00:29:37,320
administrator account if it integrates

705
00:29:35,789 --> 00:29:39,419
with a suite of products there's usually

706
00:29:37,320 --> 00:29:41,369
a service account by default that's

707
00:29:39,419 --> 00:29:45,029
enabled and running with a default

708
00:29:41,369 --> 00:29:49,529
password on the box so something to keep

709
00:29:45,029 --> 00:29:51,119
in mind there and also when you set up<font color="#E5E5E5"> a</font>

710
00:29:49,529 --> 00:29:54,809
guest VM<font color="#E5E5E5"> and you deploy it on here a lot</font>

711
00:29:51,119 --> 00:29:56,339
<font color="#E5E5E5">of these once a standard password so so</font>

712
00:29:54,809 --> 00:29:58,499
that the sandboxing environment can get

713
00:29:56,339 --> 00:30:00,239
in make its changes watch watch what the

714
00:29:58,499 --> 00:30:02,489
changes are so if you know<font color="#E5E5E5"> what</font><font color="#CCCCCC"> the</font>

715
00:30:00,239 --> 00:30:04,200
default<font color="#CCCCCC"> password is to one of these</font>

716
00:30:02,489 --> 00:30:05,519
guests<font color="#E5E5E5"> VMs maybe that's something that</font>

717
00:30:04,200 --> 00:30:06,599
you can toss into your malware and have

718
00:30:05,519 --> 00:30:11,249
a little bit of fun<font color="#CCCCCC"> with</font><font color="#E5E5E5"> as you're</font>

719
00:30:06,599 --> 00:30:13,950
<font color="#E5E5E5">assessing this device and console access</font>

720
00:30:11,249 --> 00:30:16,109
to the device you<font color="#CCCCCC"> would be surprised</font>

721
00:30:13,950 --> 00:30:18,839
what you will find<font color="#E5E5E5"> on some of these</font>

722
00:30:16,109 --> 00:30:21,570
systems<font color="#E5E5E5"> if you log in with their given</font>

723
00:30:18,839 --> 00:30:24,749
console account that they give you<font color="#E5E5E5"> and</font>

724
00:30:21,570 --> 00:30:29,369
you start looking<font color="#E5E5E5"> at bash history you</font>

725
00:30:24,749 --> 00:30:32,639
may or may not find debugging debugging

726
00:30:29,369 --> 00:30:34,109
information hidden shells backdoors that

727
00:30:32,639 --> 00:30:37,949
the vendor has put in for their<font color="#CCCCCC"> own</font>

728
00:30:34,109 --> 00:30:39,809
maintenance things that you can't find

729
00:30:37,950 --> 00:30:43,649
on<font color="#E5E5E5"> Google but are right there and</font>

730
00:30:39,809 --> 00:30:46,139
available just about every demo device

731
00:30:43,649 --> 00:30:49,289
I've run across the prior customer did

732
00:30:46,139 --> 00:30:51,269
not wipe the system think about once

733
00:30:49,289 --> 00:30:53,700
again stepping back<font color="#CCCCCC"> to all those</font><font color="#E5E5E5"> PDFs</font>

734
00:30:51,269 --> 00:30:58,979
that that may be flowing across<font color="#E5E5E5"> the wire</font>

735
00:30:53,700 --> 00:31:01,320
that<font color="#E5E5E5"> these boxes take a look at a lot of</font>

736
00:30:58,979 --> 00:31:04,379
these<font color="#E5E5E5"> also captured network logs so</font>

737
00:31:01,320 --> 00:31:06,689
there are peak apps out there you'll

738
00:31:04,379 --> 00:31:08,218
find some serious stuff on these boxes

739
00:31:06,690 --> 00:31:10,019
if you just simply log into their

740
00:31:08,219 --> 00:31:15,209
command line interface and start<font color="#CCCCCC"> taking</font>

741
00:31:10,019 --> 00:31:18,869
a look<font color="#CCCCCC"> around and then one little hint</font>

742
00:31:15,209 --> 00:31:20,849
on<font color="#CCCCCC"> a on a vendor on bottom if</font><font color="#E5E5E5"> you can</font>

743
00:31:18,869 --> 00:31:24,359
see what<font color="#E5E5E5"> services are running on there</font>

744
00:31:20,849 --> 00:31:25,799
and you know a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> things run on</font>

745
00:31:24,359 --> 00:31:29,218
localhost so you can't get<font color="#E5E5E5"> to them over</font>

746
00:31:25,799 --> 00:31:31,379
<font color="#CCCCCC">the</font><font color="#E5E5E5"> network but ssh port forwarding can</font>

747
00:31:29,219 --> 00:31:35,909
launch you into a local host listening

748
00:31:31,379 --> 00:31:38,149
service so intent there's some good<font color="#CCCCCC"> ones</font>

749
00:31:35,909 --> 00:31:38,149
out there

750
00:31:39,160 --> 00:31:43,580
so getting into my<font color="#E5E5E5"> real world example</font>

751
00:31:41,660 --> 00:31:46,340
here a little bit now<font color="#E5E5E5"> this was fun</font><font color="#CCCCCC"> I</font>

752
00:31:43,580 --> 00:31:50,149
nerd out on this stuff I'm i just love

753
00:31:46,340 --> 00:31:53,149
breaking into it's<font color="#E5E5E5"> fun so there was</font>

754
00:31:50,150 --> 00:31:57,950
a disclosure that came out just recently

755
00:31:53,150 --> 00:31:59,990
by Intel security basically back in

756
00:31:57,950 --> 00:32:01,580
<font color="#E5E5E5">December found a way to break into one</font>

757
00:31:59,990 --> 00:32:03,980
of their systems and I'll<font color="#E5E5E5"> kind of walk</font>

758
00:32:01,580 --> 00:32:06,470
<font color="#E5E5E5">through the the attack here just a</font>

759
00:32:03,980 --> 00:32:09,200
<font color="#CCCCCC">little bit you know stepping back to</font><font color="#E5E5E5"> a</font>

760
00:32:06,470 --> 00:32:10,610
TD this one's the<font color="#CCCCCC"> centralized design got</font>

761
00:32:09,200 --> 00:32:12,400
all the sensors got all the endpoints

762
00:32:10,610 --> 00:32:15,229
they don't files to a central location

763
00:32:12,400 --> 00:32:17,750
it does have the capability to have

764
00:32:15,230 --> 00:32:20,600
internet<font color="#E5E5E5"> access out of their device so</font>

765
00:32:17,750 --> 00:32:23,960
that kind of does and doesn't play into

766
00:32:20,600 --> 00:32:25,459
this scenario so when we have these

767
00:32:23,960 --> 00:32:27,440
products in and I take a look at them

768
00:32:25,460 --> 00:32:28,730
total red team approach you know a

769
00:32:27,440 --> 00:32:30,260
little different between a penetration

770
00:32:28,730 --> 00:32:32,990
testing approach and a red team approach

771
00:32:30,260 --> 00:32:35,480
pen test approach you have to find<font color="#E5E5E5"> your</font>

772
00:32:32,990 --> 00:32:36,770
<font color="#E5E5E5">way in red team approach you have access</font>

773
00:32:35,480 --> 00:32:38,780
it's kind of short cutting getting right

774
00:32:36,770 --> 00:32:40,639
to the point and<font color="#E5E5E5"> going right at it so</font>

775
00:32:38,780 --> 00:32:43,820
the approach<font color="#E5E5E5"> was basically give me the</font>

776
00:32:40,640 --> 00:32:46,010
IP address of the box and<font color="#E5E5E5"> that's it let</font>

777
00:32:43,820 --> 00:32:48,230
me take<font color="#CCCCCC"> care of the rest</font><font color="#E5E5E5"> from there and</font>

778
00:32:46,010 --> 00:32:50,960
we'll just<font color="#E5E5E5"> start assessing it so I had</font>

779
00:32:48,230 --> 00:32:52,760
no no knowledge of credentials on the

780
00:32:50,960 --> 00:32:54,400
box or anything just an IP address<font color="#E5E5E5"> and</font>

781
00:32:52,760 --> 00:32:57,500
then<font color="#E5E5E5"> you know some simple standard tools</font>

782
00:32:54,400 --> 00:33:03,200
windows a browser burp suite and map

783
00:32:57,500 --> 00:33:04,610
kind of start that route so one of the

784
00:33:03,200 --> 00:33:06,590
first<font color="#CCCCCC"> things</font><font color="#E5E5E5"> I like to do when I get one</font>

785
00:33:04,610 --> 00:33:09,169
of<font color="#CCCCCC"> these embedded devices is just browse</font>

786
00:33:06,590 --> 00:33:12,230
to it in your web browser what kind of

787
00:33:09,170 --> 00:33:14,510
at the very basic / you know right<font color="#E5E5E5"> right</font>

788
00:33:12,230 --> 00:33:16,400
at the IP address / nothing else what

789
00:33:14,510 --> 00:33:17,570
kind of<font color="#E5E5E5"> JavaScript files does it start</font>

790
00:33:16,400 --> 00:33:20,000
throwing out to you what<font color="#E5E5E5"> kind of</font>

791
00:33:17,570 --> 00:33:21,530
includes are there you'll find a lot of

792
00:33:20,000 --> 00:33:23,570
<font color="#CCCCCC">the times you start getting all these</font>

793
00:33:21,530 --> 00:33:26,270
include files that contain information

794
00:33:23,570 --> 00:33:27,919
about pages that you can get to once

795
00:33:26,270 --> 00:33:31,040
you're authenticated but you're

796
00:33:27,920 --> 00:33:33,350
currently in<font color="#CCCCCC"> an unauthenticated</font><font color="#E5E5E5"> state so</font>

797
00:33:31,040 --> 00:33:34,879
it's<font color="#E5E5E5"> really easy to just start spidering</font>

798
00:33:33,350 --> 00:33:36,439
it out and a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> times thing tools</font>

799
00:33:34,880 --> 00:33:37,970
like the burp suite they they can't

800
00:33:36,440 --> 00:33:39,440
quite break it down and find all those

801
00:33:37,970 --> 00:33:41,870
links and spider it out correctly so

802
00:33:39,440 --> 00:33:43,550
some manual sifting can can do a lot of

803
00:33:41,870 --> 00:33:45,709
<font color="#E5E5E5">good work</font><font color="#CCCCCC"> for you just sift through</font>

804
00:33:43,550 --> 00:33:47,149
search for dot PHP or something like

805
00:33:45,710 --> 00:33:49,130
that<font color="#E5E5E5"> and start finding those links and</font>

806
00:33:47,150 --> 00:33:52,980
checking the manual

807
00:33:49,130 --> 00:33:56,640
in in a TD in<font color="#E5E5E5"> particular they had tons</font>

808
00:33:52,980 --> 00:33:59,309
of you know basically<font color="#E5E5E5"> Ajax calls between</font>

809
00:33:56,640 --> 00:34:01,530
the client and the<font color="#E5E5E5"> server and the more</font>

810
00:33:59,309 --> 00:34:03,480
Ajax web two point O centric type

811
00:34:01,530 --> 00:34:05,340
application you<font color="#CCCCCC"> have the more that logic</font>

812
00:34:03,480 --> 00:34:07,049
that needs to live on the browser which

813
00:34:05,340 --> 00:34:09,270
means there's a lot more fun<font color="#E5E5E5"> stuff for</font>

814
00:34:07,049 --> 00:34:13,649
us to<font color="#CCCCCC"> look at and a lot bigger attack</font>

815
00:34:09,270 --> 00:34:16,199
surface so JavaScript first of all gave

816
00:34:13,649 --> 00:34:18,000
me the blueprint to their<font color="#E5E5E5"> API that they</font>

817
00:34:16,199 --> 00:34:20,250
were using<font color="#CCCCCC"> to make</font><font color="#E5E5E5"> the JSON calls to the</font>

818
00:34:18,000 --> 00:34:22,949
server<font color="#E5E5E5"> and it was it was a very simple</font>

819
00:34:20,250 --> 00:34:24,810
<font color="#E5E5E5">header with a base64 encoded username</font>

820
00:34:22,949 --> 00:34:27,388
and password just<font color="#E5E5E5"> kind of like basic</font>

821
00:34:24,810 --> 00:34:30,149
authentication pretty close to that but

822
00:34:27,389 --> 00:34:33,060
the<font color="#E5E5E5"> problem was they they did a pretty</font>

823
00:34:30,149 --> 00:34:36,089
<font color="#E5E5E5">poor job of enforcing their own API</font>

824
00:34:33,060 --> 00:34:37,739
across their application which led to a

825
00:34:36,090 --> 00:34:40,889
good handful of<font color="#E5E5E5"> things i'll discuss in a</font>

826
00:34:37,739 --> 00:34:42,779
second and then<font color="#E5E5E5"> you know good ol nmap</font>

827
00:34:40,889 --> 00:34:44,609
toss it out there see what ports are

828
00:34:42,780 --> 00:34:45,810
open do some version scanning figure out

829
00:34:44,609 --> 00:34:51,119
what kind<font color="#E5E5E5"> of services you're looking at</font>

830
00:34:45,810 --> 00:34:54,119
out there so kind of stepping back to

831
00:34:51,119 --> 00:34:56,250
<font color="#E5E5E5">that that API header I could toss in</font>

832
00:34:54,119 --> 00:34:59,520
just about anything as long<font color="#E5E5E5"> as it</font>

833
00:34:56,250 --> 00:35:01,950
appeared<font color="#E5E5E5"> to be a valid string not even a</font>

834
00:34:59,520 --> 00:35:03,570
valid value just<font color="#E5E5E5"> to value a valid string</font>

835
00:35:01,950 --> 00:35:06,299
and sometimes it would<font color="#E5E5E5"> just start</font>

836
00:35:03,570 --> 00:35:08,490
returning me stuff so found all kinds of

837
00:35:06,300 --> 00:35:10,140
discrepancies and how they integrated

838
00:35:08,490 --> 00:35:12,569
their own authentication<font color="#E5E5E5"> scheme on their</font>

839
00:35:10,140 --> 00:35:13,799
own product and a couple of the more

840
00:35:12,570 --> 00:35:17,430
interesting ones by the way there<font color="#CCCCCC"> are</font>

841
00:35:13,800 --> 00:35:19,260
dozens<font color="#E5E5E5"> that I that I sent to them they</font>

842
00:35:17,430 --> 00:35:21,509
had<font color="#CCCCCC"> no questions back said</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font>

843
00:35:19,260 --> 00:35:23,400
we've confirmed them all you know well

844
00:35:21,510 --> 00:35:26,460
we'll<font color="#E5E5E5"> get these fixed but a couple of</font>

845
00:35:23,400 --> 00:35:29,070
the more interesting ones there was a

846
00:35:26,460 --> 00:35:29,820
proxy and server configuration JSON call

847
00:35:29,070 --> 00:35:33,180
that you could do<font color="#E5E5E5"> from an</font>

848
00:35:29,820 --> 00:35:34,650
unauthenticated standpoint and<font color="#E5E5E5"> I'll show</font>

849
00:35:33,180 --> 00:35:37,680
an example of<font color="#CCCCCC"> that one on the next page</font>

850
00:35:34,650 --> 00:35:39,630
and<font color="#E5E5E5"> also this was one</font><font color="#CCCCCC"> of the few</font>

851
00:35:37,680 --> 00:35:41,640
products<font color="#CCCCCC"> that i had seen where they gave</font>

852
00:35:39,630 --> 00:35:43,350
you access<font color="#E5E5E5"> to their sandbox environment</font>

853
00:35:41,640 --> 00:35:46,440
so you could<font color="#CCCCCC"> watch the malware running</font>

854
00:35:43,350 --> 00:35:49,890
and and see what it was doing and they

855
00:35:46,440 --> 00:35:51,480
used a VNC server to do that and guess

856
00:35:49,890 --> 00:35:54,720
what you could spawn and launch and log

857
00:35:51,480 --> 00:35:57,750
<font color="#E5E5E5">into from an unauthenticated user some</font>

858
00:35:54,720 --> 00:35:59,730
of their VNC sessions so to go over a

859
00:35:57,750 --> 00:36:02,250
couple of<font color="#E5E5E5"> these more interesting calls</font>

860
00:35:59,730 --> 00:36:05,250
in particular the<font color="#CCCCCC"> awn</font>

861
00:36:02,250 --> 00:36:07,170
dedicated proxy check that was the first

862
00:36:05,250 --> 00:36:09,780
one I mentioned<font color="#CCCCCC"> on the last page this</font>

863
00:36:07,170 --> 00:36:11,550
one was great because when you logged in

864
00:36:09,780 --> 00:36:14,340
and made this unauthenticated request to

865
00:36:11,550 --> 00:36:18,210
the server<font color="#E5E5E5"> the server was actually the</font>

866
00:36:14,340 --> 00:36:21,420
host that initiated<font color="#CCCCCC"> the request so from</font>

867
00:36:18,210 --> 00:36:23,730
<font color="#CCCCCC">my browser I could say server check this</font>

868
00:36:21,420 --> 00:36:26,760
arbitrary host over here to see<font color="#CCCCCC"> if it's</font>

869
00:36:23,730 --> 00:36:29,640
an HTTP proxy so you could tell the

870
00:36:26,760 --> 00:36:31,680
server to connect out and the username

871
00:36:29,640 --> 00:36:33,779
the password it could<font color="#E5E5E5"> just be arbitrary</font>

872
00:36:31,680 --> 00:36:35,430
data it<font color="#E5E5E5"> doesn't really matter what you</font>

873
00:36:33,780 --> 00:36:36,930
put in there but the server would attach

874
00:36:35,430 --> 00:36:39,480
that to a request<font color="#E5E5E5"> that it would send</font>

875
00:36:36,930 --> 00:36:43,169
over the internet<font color="#E5E5E5"> even to an arbitrary</font>

876
00:36:39,480 --> 00:36:44,640
port and IP of your choice<font color="#CCCCCC"> so kind of</font>

877
00:36:43,170 --> 00:36:47,550
<font color="#E5E5E5">keep this one in mind as we walk a</font>

878
00:36:44,640 --> 00:36:49,950
<font color="#E5E5E5">little bit further down the attack and a</font>

879
00:36:47,550 --> 00:36:51,240
bonus nice denial of service if I had a

880
00:36:49,950 --> 00:36:52,680
net cat listener<font color="#CCCCCC"> that I told it to</font>

881
00:36:51,240 --> 00:36:57,149
connect to as long as<font color="#CCCCCC"> I left that</font>

882
00:36:52,680 --> 00:36:59,040
session<font color="#E5E5E5"> open the system froze so there's</font>

883
00:36:57,150 --> 00:37:00,840
<font color="#E5E5E5">no</font><font color="#CCCCCC"> need to create a backlog in the</font>

884
00:36:59,040 --> 00:37:02,640
sandbox environment just don't close a

885
00:37:00,840 --> 00:37:04,280
connection launch your malware and the

886
00:37:02,640 --> 00:37:07,950
entire<font color="#E5E5E5"> system is pretty much frozen up</font>

887
00:37:04,280 --> 00:37:10,410
so they fix that denial of service as

888
00:37:07,950 --> 00:37:14,129
well<font color="#E5E5E5"> on this vulnerability in this</font>

889
00:37:10,410 --> 00:37:17,609
<font color="#E5E5E5">Advisory second one the opening up a VNC</font>

890
00:37:14,130 --> 00:37:19,800
session it<font color="#E5E5E5"> it tracks all of its malware</font>

891
00:37:17,610 --> 00:37:23,670
through task ID so if you keep hitting

892
00:37:19,800 --> 00:37:24,840
this open VNC PHP page and just iterate

893
00:37:23,670 --> 00:37:28,170
through a whole bunch<font color="#E5E5E5"> of integers you're</font>

894
00:37:24,840 --> 00:37:30,060
eventually going to find a valid piece

895
00:37:28,170 --> 00:37:32,760
of malware that executed in the sandbox

896
00:37:30,060 --> 00:37:35,400
and it will fire up a sandbox and launch

897
00:37:32,760 --> 00:37:37,290
a VNC server so that you can<font color="#CCCCCC"> login it's</font>

898
00:37:35,400 --> 00:37:39,530
pretty obvious through an iterator when

899
00:37:37,290 --> 00:37:43,860
you get a hit and once you get that hit

900
00:37:39,530 --> 00:37:47,730
you use a command line<font color="#CCCCCC"> VNC to just pop</font>

901
00:37:43,860 --> 00:37:50,490
right into that<font color="#E5E5E5"> to that VNC server that</font>

902
00:37:47,730 --> 00:37:52,920
opened<font color="#E5E5E5"> up and oh yeah that's anonymous</font>

903
00:37:50,490 --> 00:37:57,810
<font color="#E5E5E5">just enter no password</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> you can pop</font>

904
00:37:52,920 --> 00:37:59,970
right into that so here's the command

905
00:37:57,810 --> 00:38:02,150
line to use to jump right into one of

906
00:37:59,970 --> 00:38:04,350
those sand box that you unauthenticated

907
00:38:02,150 --> 00:38:06,840
that you initiated via an

908
00:38:04,350 --> 00:38:09,480
unauthenticated connection you can just

909
00:38:06,840 --> 00:38:11,040
jump right in there no<font color="#E5E5E5"> no password when</font>

910
00:38:09,480 --> 00:38:13,530
once you start poking around the sandbox

911
00:38:11,040 --> 00:38:15,750
it runs on VirtualBox you'll see

912
00:38:13,530 --> 00:38:17,820
<font color="#E5E5E5">VirtualBox artifacts out there</font>

913
00:38:15,750 --> 00:38:19,140
so you start you quickly know you're

914
00:38:17,820 --> 00:38:21,810
running in a virtualized environment

915
00:38:19,140 --> 00:38:23,310
pretty obvious<font color="#E5E5E5"> McAfee acquired valid</font>

916
00:38:21,810 --> 00:38:24,840
edge a little while back to do some<font color="#E5E5E5"> of</font>

917
00:38:23,310 --> 00:38:26,790
their malware analysis and there are

918
00:38:24,840 --> 00:38:28,110
signs of<font color="#E5E5E5"> that all over the system so</font>

919
00:38:26,790 --> 00:38:32,250
another easy sign that you're in a

920
00:38:28,110 --> 00:38:34,500
sandbox if<font color="#CCCCCC"> you're malware and telnet yes</font>

921
00:38:32,250 --> 00:38:36,810
they're running telnet on these systems

922
00:38:34,500 --> 00:38:38,940
there are<font color="#CCCCCC"> a</font><font color="#E5E5E5"> couple standard services</font>

923
00:38:36,810 --> 00:38:40,770
that they require<font color="#CCCCCC"> you to run if you're</font>

924
00:38:38,940 --> 00:38:44,730
<font color="#E5E5E5">going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> run this VM image in their</font>

925
00:38:40,770 --> 00:38:46,380
sandbox and telnet is one of them so I

926
00:38:44,730 --> 00:38:47,610
<font color="#E5E5E5">think that'd be a pretty obvious sign if</font>

927
00:38:46,380 --> 00:38:49,590
you're attacking a system and you saw

928
00:38:47,610 --> 00:38:53,010
<font color="#E5E5E5">telnet that uh yeah there's something</font>

929
00:38:49,590 --> 00:38:56,970
going on and there are very predictable

930
00:38:53,010 --> 00:38:59,130
IP addresses I think everything<font color="#E5E5E5"> was / 29</font>

931
00:38:56,970 --> 00:39:02,120
RS / 30 so they're very predictable and

932
00:38:59,130 --> 00:39:06,270
incremental in the 192 168 50 range and

933
00:39:02,120 --> 00:39:09,089
a very interesting aspect so if you

934
00:39:06,270 --> 00:39:12,390
don't enable internet access in<font color="#CCCCCC"> their in</font>

935
00:39:09,090 --> 00:39:14,640
<font color="#CCCCCC">their</font><font color="#E5E5E5"> sandboxes it won't give you a</font>

936
00:39:12,390 --> 00:39:16,799
gateway but this gateway address is

937
00:39:14,640 --> 00:39:18,799
static and it's<font color="#E5E5E5"> always available even if</font>

938
00:39:16,800 --> 00:39:21,000
they say you don't have internet access

939
00:39:18,800 --> 00:39:22,710
you may not be<font color="#CCCCCC"> able to</font><font color="#E5E5E5"> get out to the</font>

940
00:39:21,000 --> 00:39:24,540
internet with it but<font color="#CCCCCC"> I'll show you a</font>

941
00:39:22,710 --> 00:39:27,510
trick in a second that makes this one

942
00:39:24,540 --> 00:39:29,550
pretty important and there's<font color="#CCCCCC"> always an</font>

943
00:39:27,510 --> 00:39:32,310
ftp server running on the<font color="#E5E5E5"> gateway and</font>

944
00:39:29,550 --> 00:39:35,520
you log into that with the<font color="#E5E5E5"> credentials</font>

945
00:39:32,310 --> 00:39:37,650
that they give<font color="#E5E5E5"> you on their faq so you</font>

946
00:39:35,520 --> 00:39:38,790
can give a shot test all these default

947
00:39:37,650 --> 00:39:40,260
credentials right from some of the

948
00:39:38,790 --> 00:39:47,880
malware that you wrap up<font color="#E5E5E5"> and send into</font>

949
00:39:40,260 --> 00:39:50,040
<font color="#CCCCCC">the box so quick time travel here 11</font>

950
00:39:47,880 --> 00:39:51,960
years ago<font color="#E5E5E5"> I reported what I thought was</font>

951
00:39:50,040 --> 00:39:55,770
a bug to the<font color="#E5E5E5"> Linux kernel and what I</font>

952
00:39:51,960 --> 00:39:58,950
still think is a bug if you have a

953
00:39:55,770 --> 00:40:00,840
multi-homed system on a<font color="#E5E5E5"> linux box bsd is</font>

954
00:39:58,950 --> 00:40:03,960
different bsd derivatives don't do this

955
00:40:00,840 --> 00:40:05,460
but linux derivatives if you have two

956
00:40:03,960 --> 00:40:07,410
different<font color="#E5E5E5"> IP addresses on two different</font>

957
00:40:05,460 --> 00:40:10,170
interfaces if you can reach this one

958
00:40:07,410 --> 00:40:13,980
over layer to you can address it at its

959
00:40:10,170 --> 00:40:15,210
MAC address with this IP address and it

960
00:40:13,980 --> 00:40:17,040
will send it through the box right over

961
00:40:15,210 --> 00:40:19,980
to this<font color="#E5E5E5"> other interface over here I</font>

962
00:40:17,040 --> 00:40:22,940
thought<font color="#CCCCCC"> this</font><font color="#E5E5E5"> was a bug</font><font color="#CCCCCC"> I sent it to the</font>

963
00:40:19,980 --> 00:40:26,340
Linux kernel described it to them and

964
00:40:22,940 --> 00:40:28,980
their quote back<font color="#CCCCCC"> hosts normally will</font>

965
00:40:26,340 --> 00:40:30,160
expect<font color="#E5E5E5"> or little except packets for any</font>

966
00:40:28,980 --> 00:40:31,450
local address

967
00:40:30,160 --> 00:40:33,910
regardless<font color="#E5E5E5"> of which interface it was</font>

968
00:40:31,450 --> 00:40:38,109
received on that's not a bug that's how

969
00:40:33,910 --> 00:40:40,180
almost everything works so they saw no

970
00:40:38,109 --> 00:40:42,670
issue with routing between two different

971
00:40:40,180 --> 00:40:45,669
physical networks through the same box

972
00:40:42,670 --> 00:40:47,170
so you<font color="#CCCCCC"> know I did this attack the hard</font>

973
00:40:45,670 --> 00:40:48,670
way when I found<font color="#E5E5E5"> it and then you look at</font>

974
00:40:47,170 --> 00:40:50,500
it<font color="#E5E5E5"> oh it's as simple as a route add</font>

975
00:40:48,670 --> 00:40:52,119
command so put that<font color="#E5E5E5"> in your bag of</font>

976
00:40:50,500 --> 00:40:54,880
tricks for pen testing or red team

977
00:40:52,119 --> 00:40:57,819
engagement simple route add command to

978
00:40:54,880 --> 00:40:59,890
this IP it excuse me to this MAC address

979
00:40:57,819 --> 00:41:01,480
<font color="#CCCCCC">will get you to</font><font color="#E5E5E5"> this IP address even if</font>

980
00:40:59,890 --> 00:41:05,650
they're<font color="#CCCCCC"> on to physically separate</font>

981
00:41:01,480 --> 00:41:08,349
networks so to take one step back in

982
00:41:05,650 --> 00:41:09,640
here building<font color="#E5E5E5"> up the attack we started</font>

983
00:41:08,349 --> 00:41:12,609
with how<font color="#E5E5E5"> to make our own custom malware</font>

984
00:41:09,640 --> 00:41:15,400
to get it to execute in the sandbox so

985
00:41:12,609 --> 00:41:17,288
we'll make one of those shove<font color="#E5E5E5"> it in we</font>

986
00:41:15,400 --> 00:41:20,200
know that<font color="#CCCCCC"> the Gateway is predictable one</font>

987
00:41:17,289 --> 00:41:22,869
<font color="#E5E5E5">on two wings to take 50 dot one we can</font>

988
00:41:20,200 --> 00:41:27,609
<font color="#CCCCCC">use that</font><font color="#E5E5E5"> bugzilla 2399 out of the Linux</font>

989
00:41:22,869 --> 00:41:30,730
<font color="#CCCCCC">kernel I can add a route if you know the</font>

990
00:41:27,609 --> 00:41:33,490
IP address<font color="#E5E5E5"> of the management interface</font>

991
00:41:30,730 --> 00:41:35,170
you can<font color="#E5E5E5"> simply add a route / 50 dot one</font>

992
00:41:33,490 --> 00:41:38,828
<font color="#E5E5E5">to that management interface and</font>

993
00:41:35,170 --> 00:41:41,890
communicate right back to the to<font color="#CCCCCC"> the</font>

994
00:41:38,829 --> 00:41:43,510
main sandbox system without internet

995
00:41:41,890 --> 00:41:45,549
access being<font color="#E5E5E5"> enabled whatsoever and</font>

996
00:41:43,510 --> 00:41:47,770
start exploiting those exact

997
00:41:45,549 --> 00:41:50,349
unauthenticated bugs that we<font color="#E5E5E5"> just walked</font>

998
00:41:47,770 --> 00:41:52,089
through so you can basically entirely

999
00:41:50,349 --> 00:41:55,059
own the system without internet access

1000
00:41:52,089 --> 00:41:57,339
abled or anything and if you don't know

1001
00:41:55,059 --> 00:41:59,619
the IP address<font color="#E5E5E5"> and just about everyone</font>

1002
00:41:57,339 --> 00:42:02,140
out there uses an RFC 1918 address on

1003
00:41:59,619 --> 00:42:04,420
there inside so it's time consuming but

1004
00:42:02,140 --> 00:42:05,650
you can add a route to all the RFC 1918

1005
00:42:04,420 --> 00:42:07,839
blocks that just starts<font color="#CCCCCC"> cannon</font><font color="#E5E5E5"> and</font>

1006
00:42:05,650 --> 00:42:09,039
hopefully get<font color="#E5E5E5"> a hit and once you get</font>

1007
00:42:07,839 --> 00:42:10,869
that hit you know that's going<font color="#E5E5E5"> to be the</font>

1008
00:42:09,039 --> 00:42:12,220
management interface of the sandbox

1009
00:42:10,869 --> 00:42:17,020
environment that<font color="#E5E5E5"> you're in in this</font>

1010
00:42:12,220 --> 00:42:18,549
mcafee a TD environment so<font color="#E5E5E5"> yeah go back</font>

1011
00:42:17,020 --> 00:42:20,740
exploit some of those unauthenticated

1012
00:42:18,549 --> 00:42:22,480
web phones<font color="#CCCCCC"> i had three pages of them</font>

1013
00:42:20,740 --> 00:42:25,689
that I sent them there's plenty of stuff

1014
00:42:22,480 --> 00:42:30,309
<font color="#E5E5E5">it's a ripe environment and stepping</font>

1015
00:42:25,690 --> 00:42:32,589
back<font color="#CCCCCC"> to that a proxy JSON call so</font><font color="#E5E5E5"> if</font>

1016
00:42:30,309 --> 00:42:35,529
that<font color="#E5E5E5"> user name and password can be any</font>

1017
00:42:32,589 --> 00:42:38,288
arbitrary value and you can make the

1018
00:42:35,529 --> 00:42:40,660
server connect out to the internet you

1019
00:42:38,289 --> 00:42:43,420
can use the<font color="#CCCCCC"> atd host itself as a proxy</font>

1020
00:42:40,660 --> 00:42:45,339
to exfiltrate data out of<font color="#E5E5E5"> the network if</font>

1021
00:42:43,420 --> 00:42:48,520
the sandbox does not enable internet

1022
00:42:45,339 --> 00:42:50,170
access so this was a fun

1023
00:42:48,520 --> 00:42:51,250
proof-of-concept you can basically just

1024
00:42:50,170 --> 00:42:53,049
plug in<font color="#E5E5E5"> anything in there and say oh</font>

1025
00:42:51,250 --> 00:42:55,210
send<font color="#E5E5E5"> this to this IP address on this</font>

1026
00:42:53,049 --> 00:42:56,589
port and you know it'll<font color="#E5E5E5"> just shove it</font>

1027
00:42:55,210 --> 00:43:03,910
<font color="#CCCCCC">right out for you no internet access</font>

1028
00:42:56,589 --> 00:43:06,460
needed from the sandbox look so and if

1029
00:43:03,910 --> 00:43:10,328
internet access is enabled we saw back

1030
00:43:06,460 --> 00:43:12,309
there on the mcafee a TD<font color="#CCCCCC"> on that page</font>

1031
00:43:10,329 --> 00:43:14,230
it's out of<font color="#CCCCCC"> their management interface</font>

1032
00:43:12,309 --> 00:43:15,609
by default so you can start scan and

1033
00:43:14,230 --> 00:43:18,700
right at<font color="#CCCCCC"> the heart of</font><font color="#E5E5E5"> the network that</font>

1034
00:43:15,609 --> 00:43:22,150
sweet gooey<font color="#CCCCCC"> center that that tom knows</font>

1035
00:43:18,700 --> 00:43:23,919
where all<font color="#E5E5E5"> these fun devices live so you</font>

1036
00:43:22,150 --> 00:43:26,140
know it's it's pretty much game over if

1037
00:43:23,920 --> 00:43:27,819
if you do allow internet access out and

1038
00:43:26,140 --> 00:43:33,339
you do have<font color="#CCCCCC"> that on your internal</font>

1039
00:43:27,819 --> 00:43:35,170
interface so you know this<font color="#E5E5E5"> is that one</font>

1040
00:43:33,339 --> 00:43:38,259
attack scenario is by no means the only

1041
00:43:35,170 --> 00:43:39,910
thing you can do with this target all

1042
00:43:38,260 --> 00:43:43,780
those default accounts there<font color="#E5E5E5"> are tons of</font>

1043
00:43:39,910 --> 00:43:45,160
<font color="#E5E5E5">them out there hopefully anyone that</font>

1044
00:43:43,780 --> 00:43:46,780
installs us on their network changes

1045
00:43:45,160 --> 00:43:49,569
every single password of every single

1046
00:43:46,780 --> 00:43:51,520
<font color="#E5E5E5">default account or disables them but you</font>

1047
00:43:49,569 --> 00:43:53,259
never know target the web

1048
00:43:51,520 --> 00:43:55,509
vulnerabilities there were a ton of them

1049
00:43:53,260 --> 00:43:57,099
they fixed all<font color="#CCCCCC"> of them that are reported</font>

1050
00:43:55,510 --> 00:43:58,859
but that doesn't mean those are<font color="#E5E5E5"> the only</font>

1051
00:43:57,099 --> 00:44:02,349
ones there may be plenty more out there

1052
00:43:58,859 --> 00:44:04,270
they have ftp servers SFTP servers

1053
00:44:02,349 --> 00:44:05,559
running out there their faq shows all

1054
00:44:04,270 --> 00:44:07,930
<font color="#CCCCCC">the services that are running</font><font color="#E5E5E5"> on that</font>

1055
00:44:05,559 --> 00:44:10,569
host OS so start attacking sooner or

1056
00:44:07,930 --> 00:44:12,399
later one<font color="#CCCCCC"> of those is going to have a</font>

1057
00:44:10,569 --> 00:44:13,869
public vulnerability against it<font color="#CCCCCC"> i mean</font>

1058
00:44:12,400 --> 00:44:17,680
<font color="#E5E5E5">they use open source like everyone else</font>

1059
00:44:13,869 --> 00:44:19,809
<font color="#E5E5E5">so you know you have</font><font color="#CCCCCC"> a good ripe target</font>

1060
00:44:17,680 --> 00:44:21,848
that you can<font color="#E5E5E5"> jump across denial service</font>

1061
00:44:19,809 --> 00:44:23,410
if you never close that netcat shell

1062
00:44:21,849 --> 00:44:24,880
that you connect to from the check proxy

1063
00:44:23,410 --> 00:44:27,339
command you know you may be able to shut

1064
00:44:24,880 --> 00:44:30,160
down the<font color="#E5E5E5"> box</font><font color="#CCCCCC"> freeze it up and then</font>

1065
00:44:27,339 --> 00:44:32,578
exfiltration<font color="#E5E5E5"> that was nice and easy to</font>

1066
00:44:30,160 --> 00:44:35,740
do over that helpful unauthenticated

1067
00:44:32,579 --> 00:44:38,109
proxy checker man we had and if they

1068
00:44:35,740 --> 00:44:40,290
have<font color="#CCCCCC"> internet access enabled get</font>

1069
00:44:38,109 --> 00:44:43,540
<font color="#E5E5E5">creative you can do just about anything</font>

1070
00:44:40,290 --> 00:44:47,859
scan internal networks scan external

1071
00:44:43,540 --> 00:44:49,720
networks you could use you<font color="#CCCCCC"> could wrap up</font>

1072
00:44:47,859 --> 00:44:52,089
<font color="#E5E5E5">a malware that you send in to accompany</font>

1073
00:44:49,720 --> 00:44:54,520
it gets detonated an 8th ed and all of a

1074
00:44:52,089 --> 00:44:56,410
sudden<font color="#CCCCCC"> you start scanning one of their</font>

1075
00:44:54,520 --> 00:44:57,280
<font color="#E5E5E5">competitors and guess where it looks</font>

1076
00:44:56,410 --> 00:44:59,649
like<font color="#E5E5E5"> it came from</font>

1077
00:44:57,280 --> 00:45:00,790
their network I mean just get creative

1078
00:44:59,650 --> 00:45:02,860
you can have some fun<font color="#E5E5E5"> with this one you</font>

1079
00:45:00,790 --> 00:45:04,990
wrap anything up send it<font color="#E5E5E5"> off and the</font>

1080
00:45:02,860 --> 00:45:07,180
great thing about this<font color="#E5E5E5"> entire thing no</font>

1081
00:45:04,990 --> 00:45:09,339
one has<font color="#E5E5E5"> to</font><font color="#CCCCCC"> open up your malware all it</font>

1082
00:45:07,180 --> 00:45:11,109
<font color="#E5E5E5">has to do is cross the wire in that</font>

1083
00:45:09,340 --> 00:45:12,580
company because one of the network

1084
00:45:11,110 --> 00:45:14,710
censors out there is going to say oh I

1085
00:45:12,580 --> 00:45:16,569
see<font color="#E5E5E5"> this new file potentially malicious</font>

1086
00:45:14,710 --> 00:45:19,660
don't know what it is<font color="#E5E5E5"> send it to the</font>

1087
00:45:16,570 --> 00:45:22,930
sandbox so you completely bypass social

1088
00:45:19,660 --> 00:45:24,490
engineering with this type of attack so

1089
00:45:22,930 --> 00:45:25,600
get a little creative when you start

1090
00:45:24,490 --> 00:45:27,479
playing<font color="#CCCCCC"> with some of these boxes out</font>

1091
00:45:25,600 --> 00:45:31,690
there and when you do some assessments

1092
00:45:27,480 --> 00:45:34,480
so on the Rob Ford scale a problem

1093
00:45:31,690 --> 00:45:36,430
seriousness I don't know this one might

1094
00:45:34,480 --> 00:45:39,910
<font color="#CCCCCC">be up there might be up there a little</font>

1095
00:45:36,430 --> 00:45:43,089
bit I don't know it<font color="#E5E5E5"> was a fun</font><font color="#CCCCCC"> one to</font>

1096
00:45:39,910 --> 00:45:44,710
work where I had a<font color="#E5E5E5"> good time so some of</font>

1097
00:45:43,090 --> 00:45:47,890
the lessons learned know your pros cons

1098
00:45:44,710 --> 00:45:49,390
on on the major design you<font color="#E5E5E5"> know put it</font>

1099
00:45:47,890 --> 00:45:53,529
<font color="#E5E5E5">on the network do you have a centralized</font>

1100
00:45:49,390 --> 00:45:55,299
design no the imaging and image sizes

1101
00:45:53,530 --> 00:45:58,060
licensing all those things<font color="#CCCCCC"> that go into</font>

1102
00:45:55,300 --> 00:45:59,950
some of these<font color="#E5E5E5"> devices test the product</font>

1103
00:45:58,060 --> 00:46:02,920
capabilities don't trust the vendor at

1104
00:45:59,950 --> 00:46:06,220
their word throw some malware at it test

1105
00:46:02,920 --> 00:46:09,490
a<font color="#CCCCCC"> few things attack the box itself you</font>

1106
00:46:06,220 --> 00:46:11,529
would be surprised at what you find be

1107
00:46:09,490 --> 00:46:13,930
very deliberate on whether<font color="#CCCCCC"> or not you</font>

1108
00:46:11,530 --> 00:46:16,030
allow internet access their pros there

1109
00:46:13,930 --> 00:46:19,060
are cons if you do don't<font color="#CCCCCC"> make it the</font>

1110
00:46:16,030 --> 00:46:21,760
management interface isolate it off you

1111
00:46:19,060 --> 00:46:23,830
<font color="#E5E5E5">know be smart about doing that and</font>

1112
00:46:21,760 --> 00:46:26,590
assessing the product itself you know

1113
00:46:23,830 --> 00:46:28,290
take a look at<font color="#E5E5E5"> what vm r virtualization</font>

1114
00:46:26,590 --> 00:46:31,420
technology<font color="#CCCCCC"> it's using a lot of them</font><font color="#E5E5E5"> use</font>

1115
00:46:28,290 --> 00:46:34,320
virtualbox one of the major vendors out

1116
00:46:31,420 --> 00:46:37,690
there uses a<font color="#E5E5E5"> Linux kernel based</font>

1117
00:46:34,320 --> 00:46:38,950
virtualization as well so do a little

1118
00:46:37,690 --> 00:46:41,460
bit of research and you'll find some

1119
00:46:38,950 --> 00:46:44,529
interesting attack surface and

1120
00:46:41,460 --> 00:46:46,750
definitely wipe the<font color="#E5E5E5"> system completely</font>

1121
00:46:44,530 --> 00:46:49,180
send them back a brick if you're testing

1122
00:46:46,750 --> 00:46:51,190
out one of these<font color="#E5E5E5"> things because you will</font>

1123
00:46:49,180 --> 00:46:55,120
find other customers data on there<font color="#CCCCCC"> that</font>

1124
00:46:51,190 --> 00:46:59,440
did<font color="#E5E5E5"> not and with that</font><font color="#CCCCCC"> you know few</font>

1125
00:46:55,120 --> 00:47:03,190
resources here at the end Tom do we know

1126
00:46:59,440 --> 00:47:07,400
are we publishing these slides out on

1127
00:47:03,190 --> 00:47:09,320
okay great great so slides are available

1128
00:47:07,400 --> 00:47:13,190
or excuse me resources available there

1129
00:47:09,320 --> 00:47:16,280
on the slides and then you know thank

1130
00:47:13,190 --> 00:47:18,740
you had fun doing this project kind of

1131
00:47:16,280 --> 00:47:22,630
fun talking through it so any<font color="#CCCCCC"> questions</font>

1132
00:47:18,740 --> 00:47:22,629
we have that we can talk through yes sir

1133
00:47:26,710 --> 00:47:31,520
you have a sandbox set up you expected

1134
00:47:29,690 --> 00:47:33,500
<font color="#CCCCCC">to really offer anything against the</font>

1135
00:47:31,520 --> 00:47:36,820
target attacker knows they're absolutely

1136
00:47:33,500 --> 00:47:40,609
it'll still it's still another hurdle

1137
00:47:36,820 --> 00:47:42,920
they may slip up you know there there's

1138
00:47:40,609 --> 00:47:44,990
still a few things<font color="#CCCCCC"> though incremental I</font>

1139
00:47:42,920 --> 00:47:48,080
think it does still help just still help

1140
00:47:44,990 --> 00:47:50,660
if even if they know the exact product

1141
00:47:48,080 --> 00:47:53,119
version things you have maybe a patch

1142
00:47:50,660 --> 00:47:54,109
will mix things up I don't know<font color="#E5E5E5"> but it's</font>

1143
00:47:53,119 --> 00:47:58,190
one of<font color="#E5E5E5"> those things i would do</font>

1144
00:47:54,109 --> 00:47:59,960
regardless but yeah if it's if<font color="#E5E5E5"> i'm</font>

1145
00:47:58,190 --> 00:48:02,839
targeting<font color="#E5E5E5"> a company and i know they have</font>

1146
00:47:59,960 --> 00:48:04,760
mcafee a TD things will<font color="#E5E5E5"> be a little bit</font>

1147
00:48:02,839 --> 00:48:11,570
<font color="#E5E5E5">different but it'll still make me watch</font>

1148
00:48:04,760 --> 00:48:17,150
my steps you just demonstrate plenty of

1149
00:48:11,570 --> 00:48:19,160
liability true in the in the proper

1150
00:48:17,150 --> 00:48:22,400
context they can they can be pretty

1151
00:48:19,160 --> 00:48:24,290
dangerous and that to<font color="#E5E5E5"> me ties back a lot</font>

1152
00:48:22,400 --> 00:48:28,250
too what kind of vm technology are they

1153
00:48:24,290 --> 00:48:29,930
using like this one in particular from

1154
00:48:28,250 --> 00:48:32,420
the vm that they had<font color="#E5E5E5"> i was able to jump</font>

1155
00:48:29,930 --> 00:48:34,520
through jump through loop using the

1156
00:48:32,420 --> 00:48:37,520
router to get back to the host OS a lot

1157
00:48:34,520 --> 00:48:41,720
of them that's not it's not possible but

1158
00:48:37,520 --> 00:48:43,190
some of them it is and then absolutely<font color="#CCCCCC"> a</font>

1159
00:48:41,720 --> 00:48:45,950
liability from the internet access

1160
00:48:43,190 --> 00:48:50,270
standpoint be very<font color="#E5E5E5"> very careful about</font>

1161
00:48:45,950 --> 00:48:55,759
that<font color="#CCCCCC"> one</font><font color="#E5E5E5"> absolutely anyone else</font>

1162
00:48:50,270 --> 00:48:57,560
questions comments<font color="#E5E5E5"> alright cool thanks</font>

1163
00:48:55,760 --> 00:48:59,800
everybody well sorry one in the<font color="#E5E5E5"> back one</font>

1164
00:48:57,560 --> 00:48:59,799
of<font color="#E5E5E5"> the back</font>

1165
00:49:11,949 --> 00:49:22,599
gotcha from from a signature bass<font color="#CCCCCC"> mmm</font>

1166
00:49:24,309 --> 00:49:29,449
gotcha good point so the question<font color="#CCCCCC"> was</font>

1167
00:49:27,019 --> 00:49:31,999
are you seeing anything anything cool

1168
00:49:29,449 --> 00:49:35,900
nice features and any any cool things

1169
00:49:31,999 --> 00:49:39,439
out there the mcafee a TD system does a

1170
00:49:35,900 --> 00:49:42,019
couple<font color="#E5E5E5"> cool things fire I for example it</font>

1171
00:49:39,440 --> 00:49:44,209
might try<font color="#E5E5E5"> and detonate something but if</font>

1172
00:49:42,019 --> 00:49:45,859
there's a some script in there or

1173
00:49:44,209 --> 00:49:47,779
something in the code that<font color="#E5E5E5"> knows it's in</font>

1174
00:49:45,859 --> 00:49:50,619
a vm environment and won't fire off it

1175
00:49:47,779 --> 00:49:53,150
may not<font color="#CCCCCC"> catch everything mcafee a TD</font>

1176
00:49:50,619 --> 00:49:54,349
does it's<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> a little bit</font><font color="#E5E5E5"> of a</font>

1177
00:49:53,150 --> 00:49:57,229
misnomer but they call<font color="#E5E5E5"> it static</font>

1178
00:49:54,349 --> 00:49:59,089
analysis it will see what parts<font color="#E5E5E5"> of the</font>

1179
00:49:57,229 --> 00:50:01,698
code did not detonate in that

1180
00:49:59,089 --> 00:50:03,410
environment and also reports on those so

1181
00:50:01,699 --> 00:50:08,930
that<font color="#CCCCCC"> was one of the</font><font color="#E5E5E5"> really cool features</font>

1182
00:50:03,410 --> 00:50:34,038
that that I've seen absolutely kind<font color="#E5E5E5"> of</font>

1183
00:50:08,930 --> 00:50:35,448
hybrid and<font color="#E5E5E5"> Static yep yeah yes sir so</font>

1184
00:50:34,039 --> 00:50:36,739
the question<font color="#CCCCCC"> was do the any of these</font>

1185
00:50:35,449 --> 00:50:40,009
vendors try and hide that they're

1186
00:50:36,739 --> 00:50:42,559
running a vm and you don't<font color="#E5E5E5"> see too many</font>

1187
00:50:40,009 --> 00:50:44,329
that do you know at the end of the day

1188
00:50:42,559 --> 00:50:45,859
there's only so much you can do certain

1189
00:50:44,329 --> 00:50:47,089
instructions will give away<font color="#E5E5E5"> certain</font>

1190
00:50:45,859 --> 00:50:49,519
assembly instructions will give<font color="#E5E5E5"> away</font>

1191
00:50:47,089 --> 00:50:51,650
that you're in a lot of them<font color="#E5E5E5"> don't even</font>

1192
00:50:49,519 --> 00:50:54,649
try<font color="#CCCCCC"> and cover up from the software</font>

1193
00:50:51,650 --> 00:50:57,049
that's installed like a<font color="#CCCCCC"> TD</font><font color="#E5E5E5"> for example</font>

1194
00:50:54,650 --> 00:50:59,059
it had the valid edge software installed

1195
00:50:57,049 --> 00:51:02,299
on it that's a malware analysis product

1196
00:50:59,059 --> 00:51:04,009
it had VirtualBox artifacts on it that's

1197
00:51:02,299 --> 00:51:06,109
clearly you know a virtual environment

1198
00:51:04,009 --> 00:51:09,739
<font color="#E5E5E5">so some don't go through the steps of</font>

1199
00:51:06,109 --> 00:51:11,328
<font color="#E5E5E5">cleaning some of that stuff up I'd say</font>

1200
00:51:09,739 --> 00:51:13,010
from<font color="#E5E5E5"> what I could see from some of the</font>

1201
00:51:11,329 --> 00:51:15,390
fire I stuff I did a little bit better

1202
00:51:13,010 --> 00:51:22,350
but for the most part you'll still find

1203
00:51:15,390 --> 00:51:23,759
those remnants out there I hate to give

1204
00:51:22,350 --> 00:51:25,920
you the answer but it depends if you're

1205
00:51:23,760 --> 00:51:28,620
<font color="#CCCCCC">a monolithic environment where you have</font>

1206
00:51:25,920 --> 00:51:30,360
a lot of products from<font color="#CCCCCC"> the same vendor</font>

1207
00:51:28,620 --> 00:51:31,799
you can take advantage of a centralized

1208
00:51:30,360 --> 00:51:33,960
architecture and it can<font color="#CCCCCC"> be a really</font><font color="#E5E5E5"> good</font>

1209
00:51:31,800 --> 00:51:36,090
fit also from the standpoint that you

1210
00:51:33,960 --> 00:51:38,670
<font color="#CCCCCC">don't need SSL decryption because the</font>

1211
00:51:36,090 --> 00:51:41,250
endpoints can grab the executables or

1212
00:51:38,670 --> 00:51:44,160
files and send them<font color="#E5E5E5"> off so that's a</font>

1213
00:51:41,250 --> 00:51:45,600
really<font color="#E5E5E5"> great one if you're a small shop</font>

1214
00:51:44,160 --> 00:51:47,370
and you just have the budget for one

1215
00:51:45,600 --> 00:51:48,960
device you know something<font color="#E5E5E5"> like a fire I</font>

1216
00:51:47,370 --> 00:51:50,850
is pretty solid just grab that one

1217
00:51:48,960 --> 00:51:54,210
device pop it out on the wire and and it

1218
00:51:50,850 --> 00:52:01,160
can take a look so it really really

1219
00:51:54,210 --> 00:52:04,790
depends on<font color="#E5E5E5"> a good fit anyone else</font><font color="#CCCCCC"> oh</font>

1220
00:52:01,160 --> 00:52:04,790
<font color="#CCCCCC">great thanks everybody</font>

