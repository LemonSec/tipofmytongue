1
00:00:00,000 --> 00:00:05,279
right so as was mentioned i go by q or

2
00:00:03,280 --> 00:00:07,359
casum i'd like to say uh just say

3
00:00:05,279 --> 00:00:09,040
awesome put a k before that

4
00:00:07,359 --> 00:00:10,639
uh but that's got an old so i just go

5
00:00:09,040 --> 00:00:14,559
with q um

6
00:00:10,639 --> 00:00:16,560
not because of gm spot or anything um

7
00:00:14,559 --> 00:00:18,080
i just it just somebody started saying

8
00:00:16,560 --> 00:00:20,960
it and stuck

9
00:00:18,080 --> 00:00:21,680
and i just stuck with it so i'm talking

10
00:00:20,960 --> 00:00:24,480
about

11
00:00:21,680 --> 00:00:26,480
don't be a hypocrite uh i've got

12
00:00:24,480 --> 00:00:28,480
stickers that say that

13
00:00:26,480 --> 00:00:29,439
but too bad we are doing this remote

14
00:00:28,480 --> 00:00:31,679
otherwise i would have brought them

15
00:00:29,439 --> 00:00:35,360
maybe one day i'll see you all and

16
00:00:31,679 --> 00:00:37,120
hand you some stickers the idea here is

17
00:00:35,360 --> 00:00:40,480
to talk about some of the

18
00:00:37,120 --> 00:00:41,839
issues in healthcare security that blue

19
00:00:40,480 --> 00:00:44,319
and red team

20
00:00:41,840 --> 00:00:45,440
will benefit from from knowing it from

21
00:00:44,320 --> 00:00:47,360
figuring out ways to

22
00:00:45,440 --> 00:00:49,599
combat those issues i'm not trying to

23
00:00:47,360 --> 00:00:52,320
bash healthcare i.t i'm not trying to

24
00:00:49,600 --> 00:00:52,879
um you know just talk about all the wins

25
00:00:52,320 --> 00:00:55,360
instead

26
00:00:52,879 --> 00:00:56,320
what the talk i'm trying to give is to

27
00:00:55,360 --> 00:00:59,359
inform

28
00:00:56,320 --> 00:01:00,719
the blue and red team how can you pawn a

29
00:00:59,359 --> 00:01:01,680
healthcare organization on the other

30
00:01:00,719 --> 00:01:03,680
hand

31
00:01:01,680 --> 00:01:05,438
uh if you're a blue teamer what to look

32
00:01:03,680 --> 00:01:09,840
for

33
00:01:05,438 --> 00:01:10,240
all right so uh let's move on to who am

34
00:01:09,840 --> 00:01:13,439
i

35
00:01:10,240 --> 00:01:15,520
well uh like i mentioned uh go with q i

36
00:01:13,439 --> 00:01:16,158
used to work at culver labs uh not as of

37
00:01:15,520 --> 00:01:19,679
yesterday

38
00:01:16,159 --> 00:01:21,040
uh free agent now i'm not gonna do wink

39
00:01:19,680 --> 00:01:22,000
wink uh hard to see that with these

40
00:01:21,040 --> 00:01:25,200
classes

41
00:01:22,000 --> 00:01:28,320
uh but i've been largely focused on

42
00:01:25,200 --> 00:01:31,680
healthcare clients be it small to large

43
00:01:28,320 --> 00:01:35,119
healthcare organizations be it

44
00:01:31,680 --> 00:01:38,240
health plan providers i started my

45
00:01:35,119 --> 00:01:38,880
professional career as a systems

46
00:01:38,240 --> 00:01:42,000
engineer

47
00:01:38,880 --> 00:01:44,560
at cerner which is a pretty big

48
00:01:42,000 --> 00:01:45,040
healthcare software company i did some

49
00:01:44,560 --> 00:01:48,000
hipaa

50
00:01:45,040 --> 00:01:48,399
and high trust assessments where i

51
00:01:48,000 --> 00:01:50,240
learned

52
00:01:48,399 --> 00:01:52,479
more about microsoft excel than i

53
00:01:50,240 --> 00:01:54,158
learned about hipaa and i trust

54
00:01:52,479 --> 00:01:56,320
i learned that excel is really the tool

55
00:01:54,159 --> 00:01:59,119
of choice in that

56
00:01:56,320 --> 00:02:00,639
and that's my twitter handle i talk a

57
00:01:59,119 --> 00:02:03,439
lot about politics

58
00:02:00,640 --> 00:02:05,040
i complain a lot so you might not learn

59
00:02:03,439 --> 00:02:05,919
a lot about security just by following

60
00:02:05,040 --> 00:02:07,600
me

61
00:02:05,920 --> 00:02:11,200
but if you want to just hear somebody

62
00:02:07,600 --> 00:02:11,200
complain it's right there

63
00:02:11,920 --> 00:02:16,720
all right so before i talk about the

64
00:02:14,400 --> 00:02:19,200
issues i want to introduce what that

65
00:02:16,720 --> 00:02:21,200
healthcare it environment looks like

66
00:02:19,200 --> 00:02:23,040
right so

67
00:02:21,200 --> 00:02:24,399
and most commonly what you see in

68
00:02:23,040 --> 00:02:27,359
healthcare environments

69
00:02:24,400 --> 00:02:29,520
you are going to have the ehr database

70
00:02:27,360 --> 00:02:31,920
the electronic health record database

71
00:02:29,520 --> 00:02:33,440
which is the source of truth for all

72
00:02:31,920 --> 00:02:34,319
healthcare data that's where everything

73
00:02:33,440 --> 00:02:35,519
is going

74
00:02:34,319 --> 00:02:38,000
and that's where everything is coming

75
00:02:35,519 --> 00:02:40,239
from um you have

76
00:02:38,000 --> 00:02:41,920
the billing reporting scheduling

77
00:02:40,239 --> 00:02:43,920
charting servers that are doing all the

78
00:02:41,920 --> 00:02:46,000
metrics that are showing all the data to

79
00:02:43,920 --> 00:02:47,119
clinicians to folks who are sending you

80
00:02:46,000 --> 00:02:50,800
that 50 000

81
00:02:47,120 --> 00:02:52,720
bill for just one pill

82
00:02:50,800 --> 00:02:54,319
they're all using that and it's pulling

83
00:02:52,720 --> 00:02:56,879
that from that ehr database

84
00:02:54,319 --> 00:02:59,599
it's not always just one database

85
00:02:56,879 --> 00:03:02,079
because hipaa requires you to have

86
00:02:59,599 --> 00:03:03,119
the archived data for a while and then

87
00:03:02,080 --> 00:03:05,040
there are some other

88
00:03:03,120 --> 00:03:06,879
contractual requirements it's just good

89
00:03:05,040 --> 00:03:08,239
practice to not forget who your patients

90
00:03:06,879 --> 00:03:09,920
were five years ago

91
00:03:08,239 --> 00:03:11,440
a lot of organizations are going to have

92
00:03:09,920 --> 00:03:13,518
all the hr databases

93
00:03:11,440 --> 00:03:15,760
as they move to different electronic

94
00:03:13,519 --> 00:03:16,640
health records go from cerner to epic

95
00:03:15,760 --> 00:03:20,079
from epic to

96
00:03:16,640 --> 00:03:21,760
kassadin works or whatnot you will see

97
00:03:20,080 --> 00:03:23,440
those old applications

98
00:03:21,760 --> 00:03:25,599
and the database is related to them

99
00:03:23,440 --> 00:03:28,720
still in the environment

100
00:03:25,599 --> 00:03:31,280
a lot of times it's oracle or

101
00:03:28,720 --> 00:03:33,760
ms sequel mysql has started to become

102
00:03:31,280 --> 00:03:36,480
quite common i know center ibus

103
00:03:33,760 --> 00:03:37,920
that i use to support uses mysql for

104
00:03:36,480 --> 00:03:39,359
that

105
00:03:37,920 --> 00:03:42,079
then you'll see some connectivity

106
00:03:39,360 --> 00:03:44,480
engines so these could be

107
00:03:42,080 --> 00:03:46,319
microsoft windows servers this could be

108
00:03:44,480 --> 00:03:48,238
small ubuntu devices

109
00:03:46,319 --> 00:03:50,480
what they're doing is they are

110
00:03:48,239 --> 00:03:54,000
facilitating the conversation

111
00:03:50,480 --> 00:03:55,439
between the medical devices be it your

112
00:03:54,000 --> 00:03:59,519
smart beds

113
00:03:55,439 --> 00:04:02,640
your ventilators the bedside devices

114
00:03:59,519 --> 00:04:03,120
their conversation with the reporting

115
00:04:02,640 --> 00:04:06,000
apps

116
00:04:03,120 --> 00:04:08,480
and with the ehr database a lot of that

117
00:04:06,000 --> 00:04:09,840
conversation is hl7 encoded we'll talk

118
00:04:08,480 --> 00:04:12,640
about that later but what

119
00:04:09,840 --> 00:04:12,640
it means is

120
00:04:13,280 --> 00:04:16,720
using hl7 encoding to make sure that

121
00:04:15,439 --> 00:04:18,478
other apps

122
00:04:16,720 --> 00:04:20,560
other databases can understand what's

123
00:04:18,478 --> 00:04:22,880
being sent and received

124
00:04:20,560 --> 00:04:24,320
oftentimes it may be encrypted over

125
00:04:22,880 --> 00:04:26,840
https

126
00:04:24,320 --> 00:04:28,800
um but more often than not will be

127
00:04:26,840 --> 00:04:32,239
unencrypted

128
00:04:28,800 --> 00:04:34,560
okay then you've got the

129
00:04:32,240 --> 00:04:36,320
outsiders right your third parties that

130
00:04:34,560 --> 00:04:39,199
you're working with could be the

131
00:04:36,320 --> 00:04:40,479
university uh medical center working

132
00:04:39,199 --> 00:04:41,120
with the university or the research

133
00:04:40,479 --> 00:04:43,520
center

134
00:04:41,120 --> 00:04:44,800
it could be through a third party like

135
00:04:43,520 --> 00:04:46,240
an emr vendor

136
00:04:44,800 --> 00:04:48,000
uh center for example when i used to

137
00:04:46,240 --> 00:04:49,120
work at the data center we hosted the

138
00:04:48,000 --> 00:04:52,160
data

139
00:04:49,120 --> 00:04:54,560
for about 20 of the hospitals in the us

140
00:04:52,160 --> 00:04:56,560
so a lot of that was done through the

141
00:04:54,560 --> 00:04:58,320
tunnels and vpn connections and whatnot

142
00:04:56,560 --> 00:05:00,080
you have remote users nowadays with

143
00:04:58,320 --> 00:05:02,080
covid a lot of doctors and clinicians

144
00:05:00,080 --> 00:05:03,840
have gone to work remotely

145
00:05:02,080 --> 00:05:05,440
then you have patients logging into

146
00:05:03,840 --> 00:05:08,000
their patient portals

147
00:05:05,440 --> 00:05:09,440
that are sitting outside that ehr

148
00:05:08,000 --> 00:05:12,160
database

149
00:05:09,440 --> 00:05:12,880
all right sitting outside that internal

150
00:05:12,160 --> 00:05:15,680
network

151
00:05:12,880 --> 00:05:18,479
to provide the output from the ehr

152
00:05:15,680 --> 00:05:20,960
database in there

153
00:05:18,479 --> 00:05:22,000
internal users and admins working with

154
00:05:20,960 --> 00:05:24,960
that environment

155
00:05:22,000 --> 00:05:26,400
working with those devices with the

156
00:05:24,960 --> 00:05:30,799
databases and whatnot

157
00:05:26,400 --> 00:05:33,440
you may also have uh what

158
00:05:30,800 --> 00:05:35,120
i like to call lack of segregation well

159
00:05:33,440 --> 00:05:36,719
everybody calls it that

160
00:05:35,120 --> 00:05:38,240
so there's lack of segregation in there

161
00:05:36,720 --> 00:05:39,759
between the internal admins the passion

162
00:05:38,240 --> 00:05:41,360
portal and other devices and that's

163
00:05:39,759 --> 00:05:42,960
pretty common

164
00:05:41,360 --> 00:05:44,800
a lot of organizations are still trying

165
00:05:42,960 --> 00:05:46,239
to figure out where their medical

166
00:05:44,800 --> 00:05:47,680
devices are

167
00:05:46,240 --> 00:05:50,080
because a lot of those medical devices

168
00:05:47,680 --> 00:05:53,919
are connected to

169
00:05:50,080 --> 00:05:57,280
your network be it through wireless

170
00:05:53,919 --> 00:06:00,318
oftentimes with wep uh be it through

171
00:05:57,280 --> 00:06:01,440
wired networking or bluetooth oftentimes

172
00:06:00,319 --> 00:06:02,960
so a lot of them are still trying to

173
00:06:01,440 --> 00:06:04,319
figure out where those devices are so

174
00:06:02,960 --> 00:06:05,919
they can segregate them

175
00:06:04,319 --> 00:06:07,199
and we'll talk about later how that

176
00:06:05,919 --> 00:06:09,280
comes into play when you're doing pen

177
00:06:07,199 --> 00:06:12,319
testing

178
00:06:09,280 --> 00:06:14,479
um so this is kind of the the overall

179
00:06:12,319 --> 00:06:17,199
view and there a lot of unencrypted

180
00:06:14,479 --> 00:06:19,758
communication in that network

181
00:06:17,199 --> 00:06:20,880
outside communication is very much

182
00:06:19,759 --> 00:06:22,880
encrypted nowadays

183
00:06:20,880 --> 00:06:24,479
uh it may not be the cipher you like it

184
00:06:22,880 --> 00:06:27,280
may not be the tls

185
00:06:24,479 --> 00:06:28,240
version you like i may not be the ike

186
00:06:27,280 --> 00:06:30,159
working you like

187
00:06:28,240 --> 00:06:34,080
but it's getting there and it's getting

188
00:06:30,160 --> 00:06:37,600
much better on the outside

189
00:06:34,080 --> 00:06:39,198
so i mentioned ehr so you hear two terms

190
00:06:37,600 --> 00:06:41,120
ehr and emr

191
00:06:39,199 --> 00:06:42,880
electronic medical record versus

192
00:06:41,120 --> 00:06:47,360
electronic health record

193
00:06:42,880 --> 00:06:49,520
the health record is going to be

194
00:06:47,360 --> 00:06:51,520
everybody all the hospitals you've been

195
00:06:49,520 --> 00:06:53,919
to all the care providers you've gone to

196
00:06:51,520 --> 00:06:55,680
all different tests you've gotten

197
00:06:53,919 --> 00:06:57,280
right so it's gonna be a merger of all

198
00:06:55,680 --> 00:06:59,280
that versus emr

199
00:06:57,280 --> 00:07:00,840
will likely be just one provider's

200
00:06:59,280 --> 00:07:04,400
office or one

201
00:07:00,840 --> 00:07:04,960
doctor think of emr as like a paper

202
00:07:04,400 --> 00:07:08,080
chart

203
00:07:04,960 --> 00:07:10,479
versus ehr includes more

204
00:07:08,080 --> 00:07:12,240
enriched data that can help for example

205
00:07:10,479 --> 00:07:14,318
even billing data and scheduling

206
00:07:12,240 --> 00:07:18,000
which doctor you saw which device were

207
00:07:14,319 --> 00:07:21,280
you connected to which room you were in

208
00:07:18,000 --> 00:07:23,280
this is sunrise power chart center

209
00:07:21,280 --> 00:07:24,638
epic mckesson and next in are the big

210
00:07:23,280 --> 00:07:27,758
players that you'll hear a lot about a

211
00:07:24,639 --> 00:07:30,240
lot of new ones are coming out too

212
00:07:27,759 --> 00:07:31,120
a lot of the medical devices will likely

213
00:07:30,240 --> 00:07:34,479
have their own

214
00:07:31,120 --> 00:07:35,440
ehr for example ge muse has its own page

215
00:07:34,479 --> 00:07:38,639
where you can go and

216
00:07:35,440 --> 00:07:42,080
search for previous patients

217
00:07:38,639 --> 00:07:43,680
a lot of times they're pulling this data

218
00:07:42,080 --> 00:07:44,318
especially when it comes to radiology

219
00:07:43,680 --> 00:07:48,639
where you're

220
00:07:44,319 --> 00:07:52,319
working with very large sized images

221
00:07:48,639 --> 00:07:52,879
um those oftentimes get stored on nfs

222
00:07:52,319 --> 00:07:56,240
shares

223
00:07:52,879 --> 00:07:57,840
or on windows smb shares so that

224
00:07:56,240 --> 00:08:01,199
always comes up being an interesting

225
00:07:57,840 --> 00:08:01,198
thing to look at see what the

226
00:08:01,440 --> 00:08:05,039
level of authentication and access

227
00:08:03,599 --> 00:08:07,520
control is like for that

228
00:08:05,039 --> 00:08:08,479
because we found nfs shares that were

229
00:08:07,520 --> 00:08:11,520
just

230
00:08:08,479 --> 00:08:14,000
no encryption at all one of my

231
00:08:11,520 --> 00:08:16,560
colleagues recently uh found one where

232
00:08:14,000 --> 00:08:18,639
there were 13 billion patient records

233
00:08:16,560 --> 00:08:20,720
being dumped into this one nfs share

234
00:08:18,639 --> 00:08:22,319
without authentication

235
00:08:20,720 --> 00:08:25,520
and that was because they had multiple

236
00:08:22,319 --> 00:08:27,360
emrs cerner epic and few others

237
00:08:25,520 --> 00:08:29,198
and they were all just merging into one

238
00:08:27,360 --> 00:08:31,280
big database for archive

239
00:08:29,199 --> 00:08:34,399
they just didn't realize that the nfs

240
00:08:31,280 --> 00:08:34,399
share was unencrypted

241
00:08:35,839 --> 00:08:38,560
all right other things you'll hear we

242
00:08:37,039 --> 00:08:40,240
talked about connectivity engine which

243
00:08:38,559 --> 00:08:43,760
really is your

244
00:08:40,240 --> 00:08:45,760
um connection between the ehr and

245
00:08:43,760 --> 00:08:47,120
the medical devices kind of like a you

246
00:08:45,760 --> 00:08:49,360
know temporary storage it's

247
00:08:47,120 --> 00:08:51,120
taking the hl7 encoded data making sure

248
00:08:49,360 --> 00:08:54,720
the database understands it

249
00:08:51,120 --> 00:08:56,480
uh so all the devices are not directly

250
00:08:54,720 --> 00:08:57,839
sending things to the database because

251
00:08:56,480 --> 00:08:59,760
that could be problematic especially

252
00:08:57,839 --> 00:09:01,680
when you're trying to

253
00:08:59,760 --> 00:09:04,640
uh provide cross-platform or

254
00:09:01,680 --> 00:09:06,560
cross-vendor compatibility

255
00:09:04,640 --> 00:09:07,680
the medical devices uh have two

256
00:09:06,560 --> 00:09:08,800
functions

257
00:09:07,680 --> 00:09:11,680
you have the order and you have the

258
00:09:08,800 --> 00:09:13,199
result uh order and result was a lot i

259
00:09:11,680 --> 00:09:16,239
heard while doing a night shift

260
00:09:13,200 --> 00:09:19,440
cerner um order really means is the

261
00:09:16,240 --> 00:09:20,800
device is being told to do something

262
00:09:19,440 --> 00:09:23,600
all right so hey device what's the

263
00:09:20,800 --> 00:09:26,479
patient heart rate right now

264
00:09:23,600 --> 00:09:28,080
it would sometimes have a patient id

265
00:09:26,480 --> 00:09:30,160
what a lot of organizations are going

266
00:09:28,080 --> 00:09:31,040
with nowadays is association id so

267
00:09:30,160 --> 00:09:33,920
instead of

268
00:09:31,040 --> 00:09:34,719
in the database using an id specific to

269
00:09:33,920 --> 00:09:37,199
that patient

270
00:09:34,720 --> 00:09:38,800
you will see an id specific to the

271
00:09:37,200 --> 00:09:39,600
association of that patient with that

272
00:09:38,800 --> 00:09:42,160
device

273
00:09:39,600 --> 00:09:43,680
during that time so if i visited a local

274
00:09:42,160 --> 00:09:45,600
hospital

275
00:09:43,680 --> 00:09:47,359
every time i visit and they put me on a

276
00:09:45,600 --> 00:09:49,760
device

277
00:09:47,360 --> 00:09:51,680
for whatever reason it will create that

278
00:09:49,760 --> 00:09:52,480
association that encounter and will have

279
00:09:51,680 --> 00:09:54,719
its own

280
00:09:52,480 --> 00:09:56,959
record you then have to cross-reference

281
00:09:54,720 --> 00:10:01,440
that with another database to find out

282
00:09:56,959 --> 00:10:04,160
my name my id like medical record number

283
00:10:01,440 --> 00:10:05,200
and other information so if you were

284
00:10:04,160 --> 00:10:07,040
able to

285
00:10:05,200 --> 00:10:09,040
get the database your hands on the

286
00:10:07,040 --> 00:10:10,399
database that stored that medical record

287
00:10:09,040 --> 00:10:12,959
result in order

288
00:10:10,399 --> 00:10:14,320
all you would generally in an ideal

289
00:10:12,959 --> 00:10:16,319
world

290
00:10:14,320 --> 00:10:18,000
see is what the heart rate was which

291
00:10:16,320 --> 00:10:21,120
device it was possibly which

292
00:10:18,000 --> 00:10:23,440
room it was but not my name or not my

293
00:10:21,120 --> 00:10:26,160
specific identifier

294
00:10:23,440 --> 00:10:27,360
um a lot of lab robots are really just

295
00:10:26,160 --> 00:10:30,880
assembly lines

296
00:10:27,360 --> 00:10:32,720
uh i've got a client well i use double

297
00:10:30,880 --> 00:10:35,760
client

298
00:10:32,720 --> 00:10:38,399
running an ms-dos robot

299
00:10:35,760 --> 00:10:40,000
this device takes orders sends them to

300
00:10:38,399 --> 00:10:40,640
the medical devices sends the results

301
00:10:40,000 --> 00:10:43,920
back

302
00:10:40,640 --> 00:10:46,240
it kind of functions like metal man

303
00:10:43,920 --> 00:10:47,360
middle person assembly line and it's

304
00:10:46,240 --> 00:10:49,920
running ms dos

305
00:10:47,360 --> 00:10:51,519
and this is very recent um they just

306
00:10:49,920 --> 00:10:53,199
cannot replace it the organization is

307
00:10:51,519 --> 00:10:55,440
very small it's a non-profit

308
00:10:53,200 --> 00:10:57,920
healthcare organization and to replace

309
00:10:55,440 --> 00:10:59,519
that specific device would be

310
00:10:57,920 --> 00:11:01,599
five to ten million dollars that they

311
00:10:59,519 --> 00:11:05,040
don't have so they put in

312
00:11:01,600 --> 00:11:07,440
contingencies they put in comp com um

313
00:11:05,040 --> 00:11:08,640
complementing controls around it like uh

314
00:11:07,440 --> 00:11:11,920
isolated it

315
00:11:08,640 --> 00:11:13,920
uh to avoid and mitigating their risks

316
00:11:11,920 --> 00:11:17,519
i've already talked about emrs and ehrs

317
00:11:13,920 --> 00:11:17,519
in there so i'm gonna skip that

318
00:11:17,680 --> 00:11:21,040
so a lot of jargon in there let's talk

319
00:11:20,000 --> 00:11:23,200
about where the

320
00:11:21,040 --> 00:11:25,599
goods are all right and if you don't

321
00:11:23,200 --> 00:11:29,040
know which uh where the picture is from

322
00:11:25,600 --> 00:11:31,279
uh if you guessed uh um

323
00:11:29,040 --> 00:11:32,880
the freddie mercury uh movie that's also

324
00:11:31,279 --> 00:11:36,240
good but it's

325
00:11:32,880 --> 00:11:39,360
yeah you should know what that is anyway

326
00:11:36,240 --> 00:11:41,920
uh talking about hl7 earlier i like i

327
00:11:39,360 --> 00:11:42,959
like to call it man the middlers heaven

328
00:11:41,920 --> 00:11:46,079
that's because

329
00:11:42,959 --> 00:11:49,518
the data is being sent in plain text

330
00:11:46,079 --> 00:11:49,839
you have encoding occurring that really

331
00:11:49,519 --> 00:11:53,440
is

332
00:11:49,839 --> 00:11:54,000
working to provide cross organization

333
00:11:53,440 --> 00:11:57,519
and cross

334
00:11:54,000 --> 00:12:00,880
device cross vendor compatibility

335
00:11:57,519 --> 00:12:03,040
it's not working to help with the

336
00:12:00,880 --> 00:12:04,560
confidentiality of the data or in

337
00:12:03,040 --> 00:12:06,000
it's somewhat helping with integrity but

338
00:12:04,560 --> 00:12:06,880
that's more with like error checking

339
00:12:06,000 --> 00:12:10,639
than really

340
00:12:06,880 --> 00:12:12,639
providing integrity at uh security level

341
00:12:10,639 --> 00:12:14,079
atl7 is still being used there's a few

342
00:12:12,639 --> 00:12:16,399
versions of it but

343
00:12:14,079 --> 00:12:17,359
still being used quite a bit there is a

344
00:12:16,399 --> 00:12:19,839
new uh

345
00:12:17,360 --> 00:12:21,200
standard out that we'll talk about later

346
00:12:19,839 --> 00:12:24,320
but that's not being

347
00:12:21,200 --> 00:12:26,639
used much at this point

348
00:12:24,320 --> 00:12:28,320
every device you'll see likely is using

349
00:12:26,639 --> 00:12:31,200
hl7

350
00:12:28,320 --> 00:12:31,760
okay and you can run a wireshark capture

351
00:12:31,200 --> 00:12:34,800
if you are

352
00:12:31,760 --> 00:12:38,240
positioned in a man-in-the-middle uh

353
00:12:34,800 --> 00:12:41,680
location and you can see that

354
00:12:38,240 --> 00:12:41,680
traffic going back and forth

355
00:12:42,720 --> 00:12:46,480
healthcare defaults i'm we're seeing a

356
00:12:44,959 --> 00:12:49,040
lot especially that muse

357
00:12:46,480 --> 00:12:50,320
admin account is my favorite all right

358
00:12:49,040 --> 00:12:53,920
you see me using visa admin

359
00:12:50,320 --> 00:12:56,000
here to get access um this has been out

360
00:12:53,920 --> 00:12:59,120
since i believe 2015.

361
00:12:56,000 --> 00:13:02,160
uh yeah that's the cve and

362
00:12:59,120 --> 00:13:04,959
it was released that shaka khan

363
00:13:02,160 --> 00:13:05,360
from scott and he did really good work

364
00:13:04,959 --> 00:13:08,319
on

365
00:13:05,360 --> 00:13:09,120
identifying defaults for ge devices and

366
00:13:08,320 --> 00:13:11,279
at this point

367
00:13:09,120 --> 00:13:12,639
we've collected defaults for a lot of

368
00:13:11,279 --> 00:13:14,320
different devices having worked at

369
00:13:12,639 --> 00:13:16,880
cerner and other medical

370
00:13:14,320 --> 00:13:18,480
record companies i collect some of my

371
00:13:16,880 --> 00:13:21,680
time that

372
00:13:18,480 --> 00:13:23,920
working with them on but muse admin and

373
00:13:21,680 --> 00:13:26,959
muse background are the two

374
00:13:23,920 --> 00:13:29,599
accounts if you are in healthcare i.t

375
00:13:26,959 --> 00:13:31,040
take a look at them let me tell you a

376
00:13:29,600 --> 00:13:34,480
story

377
00:13:31,040 --> 00:13:35,439
working with a middle-sized healthcare

378
00:13:34,480 --> 00:13:38,880
organization

379
00:13:35,440 --> 00:13:39,680
a few hundred beds got the domain admin

380
00:13:38,880 --> 00:13:43,120
in 10 minutes

381
00:13:39,680 --> 00:13:45,040
the path was started by typing in muse

382
00:13:43,120 --> 00:13:46,480
admin credentials in their citrix

383
00:13:45,040 --> 00:13:49,120
endpoint

384
00:13:46,480 --> 00:13:50,320
it had citrix access apparently the

385
00:13:49,120 --> 00:13:54,079
radiology device

386
00:13:50,320 --> 00:13:57,360
needs to work from home at some point um

387
00:13:54,079 --> 00:14:00,560
got in from there identified a windows

388
00:13:57,360 --> 00:14:02,959
server that had the name muse something

389
00:14:00,560 --> 00:14:05,839
to do with muse

390
00:14:02,959 --> 00:14:07,518
muse admin as the name refers is local

391
00:14:05,839 --> 00:14:10,560
admin on that box

392
00:14:07,519 --> 00:14:13,120
that box was set up by it uh

393
00:14:10,560 --> 00:14:14,638
which at least the person who set it up

394
00:14:13,120 --> 00:14:16,800
had domain admin access

395
00:14:14,639 --> 00:14:18,720
so within 10 minutes went from being

396
00:14:16,800 --> 00:14:21,920
external to gaining the domain

397
00:14:18,720 --> 00:14:23,120
admin privilege muse background i'm

398
00:14:21,920 --> 00:14:25,760
seeing a lot of it

399
00:14:23,120 --> 00:14:27,760
uh but not as much as muse admin but

400
00:14:25,760 --> 00:14:31,439
these are definitely the credentials

401
00:14:27,760 --> 00:14:33,040
to know

402
00:14:31,440 --> 00:14:34,720
there's a lot more credentials there are

403
00:14:33,040 --> 00:14:35,439
credentials specific to kronos specific

404
00:14:34,720 --> 00:14:37,360
to cerner

405
00:14:35,440 --> 00:14:38,959
epic just knowing them is very helpful

406
00:14:37,360 --> 00:14:39,920
because oftentimes organizations aren't

407
00:14:38,959 --> 00:14:41,119
changing them

408
00:14:39,920 --> 00:14:43,360
now don't just go and tell the

409
00:14:41,120 --> 00:14:44,560
organization that they are screwed and

410
00:14:43,360 --> 00:14:46,959
they have to change this right away the

411
00:14:44,560 --> 00:14:48,719
reason i say that is often times

412
00:14:46,959 --> 00:14:51,199
it's very difficult to change these

413
00:14:48,720 --> 00:14:54,320
credentials this credential was

414
00:14:51,199 --> 00:14:55,120
was put in 10 years ago 15 years ago and

415
00:14:54,320 --> 00:14:58,800
it's right now

416
00:14:55,120 --> 00:15:00,800
hard coded in apps and in devices and

417
00:14:58,800 --> 00:15:02,079
changing it could have patient health

418
00:15:00,800 --> 00:15:03,359
impacts could could

419
00:15:02,079 --> 00:15:05,279
kill somebody if the device stops

420
00:15:03,360 --> 00:15:07,040
working and something bad happens

421
00:15:05,279 --> 00:15:09,199
so as you're working with organizations

422
00:15:07,040 --> 00:15:11,040
to help them understand the risk

423
00:15:09,199 --> 00:15:12,319
associated with this default do tell

424
00:15:11,040 --> 00:15:15,680
them this is pretty bad

425
00:15:12,320 --> 00:15:19,519
but just just being realistic

426
00:15:15,680 --> 00:15:21,199
it's not going to be an overnight fix

427
00:15:19,519 --> 00:15:23,839
especially when any medical device is

428
00:15:21,199 --> 00:15:23,839
associated

429
00:15:24,480 --> 00:15:32,320
so yeah uh very commonly uh you've got

430
00:15:28,560 --> 00:15:36,000
uh muse admin uh with um

431
00:15:32,320 --> 00:15:37,199
vpn or citrix access and it works almost

432
00:15:36,000 --> 00:15:40,480
every time

433
00:15:37,199 --> 00:15:42,079
all right oftentimes when uh my testers

434
00:15:40,480 --> 00:15:43,519
are working on

435
00:15:42,079 --> 00:15:45,439
a healthcare organization the first

436
00:15:43,519 --> 00:15:47,519
question i will ask trying to avoid

437
00:15:45,440 --> 00:15:50,160
micromanaging but the first question i

438
00:15:47,519 --> 00:15:52,320
will ask is have you tried muse admin

439
00:15:50,160 --> 00:15:55,839
i think i need a poster uh everybody's

440
00:15:52,320 --> 00:15:58,959
cubicle let's say it's that

441
00:15:55,839 --> 00:16:01,440
unauthenticated vnc is still happening

442
00:15:58,959 --> 00:16:03,439
um a lot of it has to do with report

443
00:16:01,440 --> 00:16:05,199
management of devices or

444
00:16:03,440 --> 00:16:06,560
devices that have computers associated

445
00:16:05,199 --> 00:16:08,079
with them um

446
00:16:06,560 --> 00:16:10,000
starting to see a lot of password use in

447
00:16:08,079 --> 00:16:11,519
that it's not as prevalent as it used to

448
00:16:10,000 --> 00:16:14,079
be but it's still there

449
00:16:11,519 --> 00:16:15,680
so do not ignore some of these basic

450
00:16:14,079 --> 00:16:17,599
vulnerabilities like

451
00:16:15,680 --> 00:16:20,560
authenticated vnc and bad passwords

452
00:16:17,600 --> 00:16:23,360
because you will find them a lot

453
00:16:20,560 --> 00:16:25,119
in this case uh pixis uh and this is not

454
00:16:23,360 --> 00:16:27,199
necessarily in the vendor it's how it

455
00:16:25,120 --> 00:16:29,519
was set up by the for the organization

456
00:16:27,199 --> 00:16:31,040
uh we could at this point dispense

457
00:16:29,519 --> 00:16:33,360
medication for us

458
00:16:31,040 --> 00:16:34,240
we could also pretend somebody else you

459
00:16:33,360 --> 00:16:36,720
know since we had

460
00:16:34,240 --> 00:16:37,360
credentials also in addition to this and

461
00:16:36,720 --> 00:16:38,880
somebody else

462
00:16:37,360 --> 00:16:41,040
dispense medication that they shouldn't

463
00:16:38,880 --> 00:16:41,040
have

464
00:16:43,440 --> 00:16:48,560
lack of authentication um i talked about

465
00:16:46,240 --> 00:16:48,959
those 13 billion patient records that we

466
00:16:48,560 --> 00:16:51,040
got

467
00:16:48,959 --> 00:16:52,638
from an nfs share also seeing on the

468
00:16:51,040 --> 00:16:55,279
left here ge muse

469
00:16:52,639 --> 00:16:55,759
web server this organization was no

470
00:16:55,279 --> 00:16:58,880
longer

471
00:16:55,759 --> 00:17:02,560
using uh that vendor

472
00:16:58,880 --> 00:17:05,599
but they kept the application running

473
00:17:02,560 --> 00:17:07,280
due to you know hipaa regulations and

474
00:17:05,599 --> 00:17:08,719
wanting to go back and look at all data

475
00:17:07,280 --> 00:17:10,160
from the patients so as you can see on

476
00:17:08,720 --> 00:17:11,439
that border over there

477
00:17:10,160 --> 00:17:13,600
i don't think we've been doing that

478
00:17:11,439 --> 00:17:15,120
since 90s

479
00:17:13,599 --> 00:17:17,438
back in the day we thought that was cool

480
00:17:15,119 --> 00:17:20,239
we don't think that anymore

481
00:17:17,439 --> 00:17:21,439
you have a lot of patient record storage

482
00:17:20,240 --> 00:17:25,120
in

483
00:17:21,439 --> 00:17:26,799
plain text files in network shares

484
00:17:25,119 --> 00:17:28,159
for example somebody will take notes

485
00:17:26,799 --> 00:17:31,039
because the emr was down

486
00:17:28,160 --> 00:17:32,240
or just taking notes on the side and

487
00:17:31,039 --> 00:17:33,919
left them in their

488
00:17:32,240 --> 00:17:35,280
documents directory thinking nobody else

489
00:17:33,919 --> 00:17:38,400
will see it

490
00:17:35,280 --> 00:17:41,280
well problem with that is the it has no

491
00:17:38,400 --> 00:17:42,720
business knowing that reading that

492
00:17:41,280 --> 00:17:45,120
patient record reading that

493
00:17:42,720 --> 00:17:46,960
you know the note about that patient but

494
00:17:45,120 --> 00:17:48,399
it likely has access to your documents

495
00:17:46,960 --> 00:17:50,880
folder

496
00:17:48,400 --> 00:17:51,840
so creating the separation is important

497
00:17:50,880 --> 00:17:55,039
and

498
00:17:51,840 --> 00:17:58,080
teaching the users to use the emr for

499
00:17:55,039 --> 00:18:00,160
note-taking or use some encrypted apps

500
00:17:58,080 --> 00:18:02,399
if you are going to use uh take some

501
00:18:00,160 --> 00:18:04,080
offline notes put them in microsoft word

502
00:18:02,400 --> 00:18:06,320
or excel and encrypt it

503
00:18:04,080 --> 00:18:08,639
because it does have the password

504
00:18:06,320 --> 00:18:10,240
capability

505
00:18:08,640 --> 00:18:12,160
this is very common in internal networks

506
00:18:10,240 --> 00:18:14,000
you don't often see that on external

507
00:18:12,160 --> 00:18:15,520
what i did see an external a few times

508
00:18:14,000 --> 00:18:19,360
was things like

509
00:18:15,520 --> 00:18:21,039
um a help desk this is one of my

510
00:18:19,360 --> 00:18:24,240
best colleagues i think was actually he

511
00:18:21,039 --> 00:18:26,879
found was the organization's help desk

512
00:18:24,240 --> 00:18:28,720
tool was publicly available if you

513
00:18:26,880 --> 00:18:29,600
wanted to submit a ticket you had to

514
00:18:28,720 --> 00:18:32,720
sign in

515
00:18:29,600 --> 00:18:34,480
but you could review previous tickets so

516
00:18:32,720 --> 00:18:37,440
one of the things we did was just

517
00:18:34,480 --> 00:18:39,600
search for the word password or the name

518
00:18:37,440 --> 00:18:40,240
of the ceo and we found all password

519
00:18:39,600 --> 00:18:43,039
resets

520
00:18:40,240 --> 00:18:43,360
recent password resets password policy

521
00:18:43,039 --> 00:18:46,000
uh

522
00:18:43,360 --> 00:18:47,439
quite a bit of id notes that helped us

523
00:18:46,000 --> 00:18:49,760
gain access to some passwords we

524
00:18:47,440 --> 00:18:51,600
shouldn't have access to

525
00:18:49,760 --> 00:18:53,039
all right so it's important to think

526
00:18:51,600 --> 00:18:54,799
about the authentication

527
00:18:53,039 --> 00:18:56,559
and don't just stop at authentication

528
00:18:54,799 --> 00:18:58,559
think about authorization too

529
00:18:56,559 --> 00:19:00,639
just because you are authenticated you

530
00:18:58,559 --> 00:19:02,160
have the business being in this building

531
00:19:00,640 --> 00:19:04,240
do you have the business

532
00:19:02,160 --> 00:19:06,160
being in this tool in this application

533
00:19:04,240 --> 00:19:09,280
in this share

534
00:19:06,160 --> 00:19:10,080
oftentimes we are seeing applications

535
00:19:09,280 --> 00:19:13,200
interacting

536
00:19:10,080 --> 00:19:14,159
with a network share where the user has

537
00:19:13,200 --> 00:19:16,720
to sign in

538
00:19:14,160 --> 00:19:18,880
to log into the application but the

539
00:19:16,720 --> 00:19:23,280
database the application is using

540
00:19:18,880 --> 00:19:25,360
does not really require that or

541
00:19:23,280 --> 00:19:26,399
the database credentials are saved on

542
00:19:25,360 --> 00:19:28,959
encrypted in c

543
00:19:26,400 --> 00:19:29,440
program files folder so the user could

544
00:19:28,960 --> 00:19:31,600
just

545
00:19:29,440 --> 00:19:32,799
log in directly to the database and that

546
00:19:31,600 --> 00:19:38,959
point you know the authentication kind

547
00:19:32,799 --> 00:19:41,039
of goes out the window too

548
00:19:38,960 --> 00:19:42,799
then of course uh nobody needs a

549
00:19:41,039 --> 00:19:45,200
password manager at least i think so

550
00:19:42,799 --> 00:19:46,559
i'm seeing a lot of passwords stored in

551
00:19:45,200 --> 00:19:50,480
excel files and

552
00:19:46,559 --> 00:19:52,160
words documents and notepad

553
00:19:50,480 --> 00:19:54,160
my favorite ones are when it actually

554
00:19:52,160 --> 00:19:55,919
says password and like this one right

555
00:19:54,160 --> 00:19:57,840
here kind of specifies

556
00:19:55,919 --> 00:19:59,280
which website or app it is for where the

557
00:19:57,840 --> 00:20:02,399
username and password is

558
00:19:59,280 --> 00:20:05,039
i've even seen uh times where it

559
00:20:02,400 --> 00:20:07,200
said critical application password so

560
00:20:05,039 --> 00:20:08,480
critical application credentials and

561
00:20:07,200 --> 00:20:11,120
that was definitely a fun one to take a

562
00:20:08,480 --> 00:20:12,320
look at when it gets really tricky as a

563
00:20:11,120 --> 00:20:15,520
consultant

564
00:20:12,320 --> 00:20:16,960
is when your point of contact the person

565
00:20:15,520 --> 00:20:18,799
who paid for the pen test

566
00:20:16,960 --> 00:20:20,000
or person who you are interacting with

567
00:20:18,799 --> 00:20:22,080
in the pen test

568
00:20:20,000 --> 00:20:23,760
is the one storing credentials in plain

569
00:20:22,080 --> 00:20:25,840
text

570
00:20:23,760 --> 00:20:27,840
that's when you have to make the

571
00:20:25,840 --> 00:20:29,840
consulting choice of

572
00:20:27,840 --> 00:20:31,760
do i tell them or do i tell that

573
00:20:29,840 --> 00:20:34,879
specific person

574
00:20:31,760 --> 00:20:36,879
i'm not gonna go into ethics of that

575
00:20:34,880 --> 00:20:40,320
people much smarter than myself can

576
00:20:36,880 --> 00:20:40,320
probably tell you more about it but

577
00:20:40,880 --> 00:20:43,520
find a balance

578
00:20:44,240 --> 00:20:48,559
and i've done a lot of physical

579
00:20:47,679 --> 00:20:50,720
assessment

580
00:20:48,559 --> 00:20:53,039
of hospitals especially when i was a

581
00:20:50,720 --> 00:20:54,720
hipaa assessor would go on site to try

582
00:20:53,039 --> 00:20:56,320
to find how the organization is doing

583
00:20:54,720 --> 00:20:58,799
from hipaa specific rules

584
00:20:56,320 --> 00:21:00,720
for example are they posting patient

585
00:20:58,799 --> 00:21:04,158
privacy notice

586
00:21:00,720 --> 00:21:07,360
in public areas are they uh

587
00:21:04,159 --> 00:21:09,600
doing anything that will just

588
00:21:07,360 --> 00:21:10,719
violate the fire marshal rules or the

589
00:21:09,600 --> 00:21:14,158
saving data

590
00:21:10,720 --> 00:21:16,159
in bad locations and we found a lot of

591
00:21:14,159 --> 00:21:18,320
instances especially with small clinics

592
00:21:16,159 --> 00:21:21,360
where you could just walk in

593
00:21:18,320 --> 00:21:22,960
and have access to patient data um just

594
00:21:21,360 --> 00:21:24,799
pretend like you're with a patient and

595
00:21:22,960 --> 00:21:25,760
walk into a you know a patient room or

596
00:21:24,799 --> 00:21:27,760
walk into

597
00:21:25,760 --> 00:21:29,600
an area like that we even then i

598
00:21:27,760 --> 00:21:30,000
couldn't find that picture here but we

599
00:21:29,600 --> 00:21:33,199
even

600
00:21:30,000 --> 00:21:35,919
once found it was a small clinic

601
00:21:33,200 --> 00:21:37,280
they had their server rack sitting on

602
00:21:35,919 --> 00:21:41,200
top of a fridge

603
00:21:37,280 --> 00:21:45,039
in a kitchen and it had the emr

604
00:21:41,200 --> 00:21:48,159
it had the network switches and all that

605
00:21:45,039 --> 00:21:51,440
and it was not too far away uh

606
00:21:48,159 --> 00:21:54,799
from the uh from the sink we also

607
00:21:51,440 --> 00:21:55,360
oftentimes saw things like um having the

608
00:21:54,799 --> 00:21:57,520
doctor

609
00:21:55,360 --> 00:21:58,799
manage it or having the doctor manage

610
00:21:57,520 --> 00:22:02,158
security

611
00:21:58,799 --> 00:22:03,039
um one at one time we were interviewing

612
00:22:02,159 --> 00:22:06,320
this

613
00:22:03,039 --> 00:22:08,158
um clinician who was managing i.t

614
00:22:06,320 --> 00:22:10,000
in that clinic so when it came to

615
00:22:08,159 --> 00:22:12,159
configuration management it came to

616
00:22:10,000 --> 00:22:14,000
asset management he was the person to

617
00:22:12,159 --> 00:22:16,480
talk to and he was a gamer

618
00:22:14,000 --> 00:22:18,720
um not a security person not an id

619
00:22:16,480 --> 00:22:20,720
person trying to do the best he could

620
00:22:18,720 --> 00:22:22,400
the way he was doing things was he would

621
00:22:20,720 --> 00:22:25,600
go to

622
00:22:22,400 --> 00:22:26,080
best buy and grab the best laptop or

623
00:22:25,600 --> 00:22:28,399
desktop

624
00:22:26,080 --> 00:22:29,280
you could find um within the budget come

625
00:22:28,400 --> 00:22:31,200
and set it up

626
00:22:29,280 --> 00:22:32,879
and that's it that is the configuration

627
00:22:31,200 --> 00:22:34,080
management that is the asset management

628
00:22:32,880 --> 00:22:34,880
we're doing i'm just writing down the

629
00:22:34,080 --> 00:22:36,559
serial number

630
00:22:34,880 --> 00:22:38,159
on a piece of paper and sending it to it

631
00:22:36,559 --> 00:22:40,879
in corporate

632
00:22:38,159 --> 00:22:43,760
this person for whatever reason was also

633
00:22:40,880 --> 00:22:46,960
responsible for managing the local

634
00:22:43,760 --> 00:22:50,158
small emr app they had and that emr app

635
00:22:46,960 --> 00:22:52,400
i remember he was a gamer he had

636
00:22:50,159 --> 00:22:53,440
forwarded the ports from outside to the

637
00:22:52,400 --> 00:22:54,720
emr

638
00:22:53,440 --> 00:22:56,880
it makes sense right you're running a

639
00:22:54,720 --> 00:22:59,200
web server but he did not

640
00:22:56,880 --> 00:23:01,200
think about encryption or passwords dmr

641
00:22:59,200 --> 00:23:02,799
was publicly available at that point

642
00:23:01,200 --> 00:23:05,039
so anybody could log in or they could

643
00:23:02,799 --> 00:23:05,600
just scan the ip space and find that emr

644
00:23:05,039 --> 00:23:08,400
right there

645
00:23:05,600 --> 00:23:11,039
without authentication they did not have

646
00:23:08,400 --> 00:23:14,240
a lot of patience it was a rural area

647
00:23:11,039 --> 00:23:15,600
uh so the disclosure wasn't in millions

648
00:23:14,240 --> 00:23:16,799
or anything like that but it was still

649
00:23:15,600 --> 00:23:19,039
pretty big deal

650
00:23:16,799 --> 00:23:20,879
and that brought us back to thinking how

651
00:23:19,039 --> 00:23:23,840
many other places in this organization

652
00:23:20,880 --> 00:23:23,840
is that happening

653
00:23:26,000 --> 00:23:31,200
do not ignore the visitor area all right

654
00:23:29,600 --> 00:23:32,639
that right there is the networking

655
00:23:31,200 --> 00:23:34,640
device sitting in visitor

656
00:23:32,640 --> 00:23:36,720
area as you can see the legs over here

657
00:23:34,640 --> 00:23:38,880
for the chair for the

658
00:23:36,720 --> 00:23:41,200
visitor chairs so we just plugged into

659
00:23:38,880 --> 00:23:42,400
it we had network access right away

660
00:23:41,200 --> 00:23:43,679
they don't need to do any social

661
00:23:42,400 --> 00:23:45,520
engineering they didn't need to do any

662
00:23:43,679 --> 00:23:48,159
lock picking or anything like that

663
00:23:45,520 --> 00:23:49,679
just uh sat there plugged in and now we

664
00:23:48,159 --> 00:23:51,039
have internal access

665
00:23:49,679 --> 00:23:54,640
now let's go and find other

666
00:23:51,039 --> 00:23:54,640
vulnerabilities that might affect them

667
00:23:57,600 --> 00:24:01,279
one place to keep an eye on to to to

668
00:24:00,080 --> 00:24:04,960
look at

669
00:24:01,279 --> 00:24:05,919
is the ocr breach portal office of civil

670
00:24:04,960 --> 00:24:09,039
rights

671
00:24:05,919 --> 00:24:10,799
is responsible for enforcement of hipaa

672
00:24:09,039 --> 00:24:12,799
if you mess something up they are the

673
00:24:10,799 --> 00:24:15,679
ones you gotta report to

674
00:24:12,799 --> 00:24:16,840
and they report to the health and human

675
00:24:15,679 --> 00:24:20,400
services office

676
00:24:16,840 --> 00:24:21,760
hhs and the ocr is who you report to

677
00:24:20,400 --> 00:24:22,799
when you have a breach and then they put

678
00:24:21,760 --> 00:24:23,919
that on their website

679
00:24:22,799 --> 00:24:26,158
there are some other rules about

680
00:24:23,919 --> 00:24:29,279
breaches we'll talk about later but

681
00:24:26,159 --> 00:24:30,559
this website ocrportal.hhs.gov is where

682
00:24:29,279 --> 00:24:32,480
you can go and look

683
00:24:30,559 --> 00:24:35,200
what breach your local provider may have

684
00:24:32,480 --> 00:24:37,279
had so this is uh colorado providers

685
00:24:35,200 --> 00:24:38,559
um what type of breacher was what

686
00:24:37,279 --> 00:24:40,640
location so for example

687
00:24:38,559 --> 00:24:42,320
in this case it was a network server

688
00:24:40,640 --> 00:24:43,679
hacking id theft

689
00:24:42,320 --> 00:24:45,439
uh this right here is a straight up

690
00:24:43,679 --> 00:24:46,960
theft of an electronic device so

691
00:24:45,440 --> 00:24:49,360
somebody maybe walked away

692
00:24:46,960 --> 00:24:50,559
with a mobile phone that had phi on it

693
00:24:49,360 --> 00:24:53,678
or walked away with a

694
00:24:50,559 --> 00:24:58,000
the drive um or a laptop was stolen

695
00:24:53,679 --> 00:25:01,200
um you've got a lot of um

696
00:24:58,000 --> 00:25:02,080
paper and file exposure too uh because

697
00:25:01,200 --> 00:25:03,440
the paper is

698
00:25:02,080 --> 00:25:06,080
still used even though you have the

699
00:25:03,440 --> 00:25:07,520
electronic medical record paper is still

700
00:25:06,080 --> 00:25:10,158
being used quite a bit

701
00:25:07,520 --> 00:25:10,879
uh one reason could be the emr is down

702
00:25:10,159 --> 00:25:13,120
for

703
00:25:10,880 --> 00:25:14,960
whatever reason another reason could be

704
00:25:13,120 --> 00:25:17,279
uh the patient wants

705
00:25:14,960 --> 00:25:18,400
paper records they're still also using

706
00:25:17,279 --> 00:25:21,039
cds

707
00:25:18,400 --> 00:25:22,159
um they haven't uh upgraded to mp3

708
00:25:21,039 --> 00:25:23,919
players yet uh

709
00:25:22,159 --> 00:25:25,520
but series are still being used because

710
00:25:23,919 --> 00:25:28,960
at low cost they just

711
00:25:25,520 --> 00:25:31,679
work all right um so a lot of that could

712
00:25:28,960 --> 00:25:34,720
also be stolen you have a lot of

713
00:25:31,679 --> 00:25:37,039
um the

714
00:25:34,720 --> 00:25:39,039
a lot of organizations are using vendors

715
00:25:37,039 --> 00:25:41,600
like iron mountain or others

716
00:25:39,039 --> 00:25:42,080
to store tapes and whatnot but they also

717
00:25:41,600 --> 00:25:43,600
use

718
00:25:42,080 --> 00:25:45,600
shredding companies to come and take

719
00:25:43,600 --> 00:25:47,678
away the sensitive paper to shred

720
00:25:45,600 --> 00:25:49,120
and get a certificate from them to prove

721
00:25:47,679 --> 00:25:50,720
that things were shredded

722
00:25:49,120 --> 00:25:52,239
but one things we found while we were

723
00:25:50,720 --> 00:25:53,120
doing a lot of those hipaa walkthroughs

724
00:25:52,240 --> 00:25:56,720
was

725
00:25:53,120 --> 00:25:59,840
you would find filled up

726
00:25:56,720 --> 00:26:01,360
uh shredding bins or you know the the

727
00:25:59,840 --> 00:26:03,360
secure disposal bins

728
00:26:01,360 --> 00:26:04,879
sitting on the dock with nobody around

729
00:26:03,360 --> 00:26:06,240
to take a look at it so you can just

730
00:26:04,880 --> 00:26:07,760
walk away with that bin

731
00:26:06,240 --> 00:26:09,279
it's pretty easy to break the lock in

732
00:26:07,760 --> 00:26:11,039
fact the bin is plastic you don't even

733
00:26:09,279 --> 00:26:13,360
need to break the lock

734
00:26:11,039 --> 00:26:14,080
or you can just reach in and grab the

735
00:26:13,360 --> 00:26:15,279
paper

736
00:26:14,080 --> 00:26:17,199
and walk away with that you may have

737
00:26:15,279 --> 00:26:18,559
something fun in that

738
00:26:17,200 --> 00:26:20,480
right so this is that's what you see

739
00:26:18,559 --> 00:26:24,879
sometimes in paper and films type of

740
00:26:20,480 --> 00:26:26,400
theft in there

741
00:26:24,880 --> 00:26:28,080
all right so i talked about a lot of bad

742
00:26:26,400 --> 00:26:29,840
things a lot of things that

743
00:26:28,080 --> 00:26:31,199
are the reason i try to avoid going to

744
00:26:29,840 --> 00:26:33,279
doctors although

745
00:26:31,200 --> 00:26:34,720
i'm kind of concerned with shamans

746
00:26:33,279 --> 00:26:36,320
looking for

747
00:26:34,720 --> 00:26:38,559
electronic payments now so it's not like

748
00:26:36,320 --> 00:26:40,158
i can go to them too um

749
00:26:38,559 --> 00:26:42,158
but let's talk about some of the good

750
00:26:40,159 --> 00:26:44,720
things that could help

751
00:26:42,159 --> 00:26:45,679
that are trying that we could improve

752
00:26:44,720 --> 00:26:48,799
upon and

753
00:26:45,679 --> 00:26:48,799
make things somewhat better

754
00:26:49,679 --> 00:26:55,679
i'm just gonna pause here for a second

755
00:26:53,679 --> 00:26:57,360
when i was uh interviewing folks when i

756
00:26:55,679 --> 00:26:59,039
was a hiring manager for hip and hydras

757
00:26:57,360 --> 00:27:00,719
one thing i looked at was if somebody's

758
00:26:59,039 --> 00:27:02,879
talking about hipaa experience how are

759
00:27:00,720 --> 00:27:06,320
they spelling it

760
00:27:02,880 --> 00:27:08,880
is it h-i-p-p-a or h-i-p-a

761
00:27:06,320 --> 00:27:11,120
all right um and the reason for that is

762
00:27:08,880 --> 00:27:14,320
it's health insurance portability and

763
00:27:11,120 --> 00:27:17,600
accountability act so it's hipaa

764
00:27:14,320 --> 00:27:21,279
um the idea around hipaa

765
00:27:17,600 --> 00:27:24,879
was to make the data portable

766
00:27:21,279 --> 00:27:26,320
and offer privacy that was one of the

767
00:27:24,880 --> 00:27:28,720
main reasons for

768
00:27:26,320 --> 00:27:29,600
the emr uh the electronic medical record

769
00:27:28,720 --> 00:27:32,399
revolution

770
00:27:29,600 --> 00:27:34,639
in early 2000's uh that really went on

771
00:27:32,399 --> 00:27:37,120
pretty strong until 25th 2015

772
00:27:34,640 --> 00:27:38,799
um really offering you the ability to

773
00:27:37,120 --> 00:27:39,840
move away to a different doctor and

774
00:27:38,799 --> 00:27:42,399
still have your health

775
00:27:39,840 --> 00:27:43,760
your information with you uh but also

776
00:27:42,399 --> 00:27:45,918
providing privacy

777
00:27:43,760 --> 00:27:46,799
so your information is not being used

778
00:27:45,919 --> 00:27:48,799
for example for

779
00:27:46,799 --> 00:27:50,158
marketing without your approval and

780
00:27:48,799 --> 00:27:52,639
without it being

781
00:27:50,159 --> 00:27:54,720
de-identified or your information is not

782
00:27:52,640 --> 00:27:56,480
being sold

783
00:27:54,720 --> 00:27:58,640
and hipaa security rule that came out

784
00:27:56,480 --> 00:28:01,200
later on uh talked about

785
00:27:58,640 --> 00:28:02,720
how to implement some safeguards around

786
00:28:01,200 --> 00:28:03,760
that patient information

787
00:28:02,720 --> 00:28:05,679
all right so you've got the

788
00:28:03,760 --> 00:28:07,279
administrative safeguard for example

789
00:28:05,679 --> 00:28:08,080
there should be access management we

790
00:28:07,279 --> 00:28:11,360
should

791
00:28:08,080 --> 00:28:12,960
uh evaluate our safeguards or security

792
00:28:11,360 --> 00:28:16,000
policies often this is very

793
00:28:12,960 --> 00:28:18,720
around like policies and procedures

794
00:28:16,000 --> 00:28:19,360
around identity and access management

795
00:28:18,720 --> 00:28:22,720
then you have

796
00:28:19,360 --> 00:28:24,479
physical safeguards such as uh do not

797
00:28:22,720 --> 00:28:26,000
let anybody just walk through the

798
00:28:24,480 --> 00:28:27,840
patient area without

799
00:28:26,000 --> 00:28:29,520
showing some identification without

800
00:28:27,840 --> 00:28:31,760
actually be having a reason

801
00:28:29,520 --> 00:28:33,520
to be there put a lock on your front

802
00:28:31,760 --> 00:28:35,760
door

803
00:28:33,520 --> 00:28:36,559
uh putting some physical access controls

804
00:28:35,760 --> 00:28:39,039
where you can also

805
00:28:36,559 --> 00:28:40,799
monitor them right and then there are

806
00:28:39,039 --> 00:28:43,039
some technical safeguards like

807
00:28:40,799 --> 00:28:46,158
encryption and authentication

808
00:28:43,039 --> 00:28:46,559
now a lot of them is that is where i

809
00:28:46,159 --> 00:28:50,480
have

810
00:28:46,559 --> 00:28:52,320
my gripes with hip-hop and that is

811
00:28:50,480 --> 00:28:54,080
a lot of times when hipaa talks about

812
00:28:52,320 --> 00:28:55,120
good things like encryption and pen

813
00:28:54,080 --> 00:28:58,158
testing

814
00:28:55,120 --> 00:29:01,279
it is if reasonable and appropriate

815
00:28:58,159 --> 00:29:03,120
in my experience and i'm in no way an

816
00:29:01,279 --> 00:29:05,679
authority on hipaa

817
00:29:03,120 --> 00:29:06,239
but in my experience the office of civil

818
00:29:05,679 --> 00:29:09,600
rights

819
00:29:06,240 --> 00:29:11,200
is not doing proactive enforcement

820
00:29:09,600 --> 00:29:13,199
they're not

821
00:29:11,200 --> 00:29:15,360
uh you know making you do encryption

822
00:29:13,200 --> 00:29:18,480
they're not making you do pen testing

823
00:29:15,360 --> 00:29:20,158
until after you have had a breach

824
00:29:18,480 --> 00:29:21,520
when you had a breach they will come in

825
00:29:20,159 --> 00:29:23,279
and they'll ask you why you didn't do

826
00:29:21,520 --> 00:29:24,080
encryption they will ask you why you did

827
00:29:23,279 --> 00:29:26,880
not

828
00:29:24,080 --> 00:29:28,720
evaluate your technical safeguards but

829
00:29:26,880 --> 00:29:31,520
generally until then

830
00:29:28,720 --> 00:29:34,720
you know there's there are pretty easy

831
00:29:31,520 --> 00:29:37,840
ways to be hipaa compliant

832
00:29:34,720 --> 00:29:38,159
hip also in very detail talks about risk

833
00:29:37,840 --> 00:29:39,840
and

834
00:29:38,159 --> 00:29:41,840
risk management and risk analysis and

835
00:29:39,840 --> 00:29:44,000
this is where it takes a lot from nist

836
00:29:41,840 --> 00:29:46,799
uh a lot of provisions in hepa and a lot

837
00:29:44,000 --> 00:29:47,279
of ways organizations do hipaa analysis

838
00:29:46,799 --> 00:29:49,760
and

839
00:29:47,279 --> 00:29:51,520
or hipaa based risk assessments is based

840
00:29:49,760 --> 00:29:54,480
on nist

841
00:29:51,520 --> 00:29:54,879
so when we talk about encryption however

842
00:29:54,480 --> 00:29:57,039
weak

843
00:29:54,880 --> 00:29:58,640
the hipaa rules on that may be it is

844
00:29:57,039 --> 00:29:59,600
still based on nest so you still have to

845
00:29:58,640 --> 00:30:01,440
think about

846
00:29:59,600 --> 00:30:03,199
des is not going to work i have to use

847
00:30:01,440 --> 00:30:05,440
aes

848
00:30:03,200 --> 00:30:05,440
right

849
00:30:06,559 --> 00:30:10,000
so yeah because of hipaa you know the

850
00:30:08,000 --> 00:30:13,360
first rule of nursing home

851
00:30:10,000 --> 00:30:13,360
do not talk about nursing home

852
00:30:14,159 --> 00:30:19,039
so uh hipaa minimum necessary principle

853
00:30:17,520 --> 00:30:20,799
is another thing to think about when you

854
00:30:19,039 --> 00:30:23,600
are looking at fantastic

855
00:30:20,799 --> 00:30:23,918
and or just any security analysis or

856
00:30:23,600 --> 00:30:25,520
just

857
00:30:23,919 --> 00:30:28,320
trying to secure the information in

858
00:30:25,520 --> 00:30:32,399
hospitals is to identify

859
00:30:28,320 --> 00:30:33,840
ways that enforce this minimum necessary

860
00:30:32,399 --> 00:30:36,559
principle of

861
00:30:33,840 --> 00:30:38,240
any use disclosure or request of the

862
00:30:36,559 --> 00:30:42,879
protected health information

863
00:30:38,240 --> 00:30:45,279
your health record should only be

864
00:30:42,880 --> 00:30:47,200
done when it's minimum necessary to

865
00:30:45,279 --> 00:30:49,600
accomplish the purpose of it

866
00:30:47,200 --> 00:30:51,279
what that means to to break it down and

867
00:30:49,600 --> 00:30:54,399
to give you a good example of it

868
00:30:51,279 --> 00:30:57,600
is if you are uh

869
00:30:54,399 --> 00:31:01,199
in the um icu

870
00:30:57,600 --> 00:31:03,840
right intensive care unit and you have

871
00:31:01,200 --> 00:31:05,679
nothing to do there's no reason for a

872
00:31:03,840 --> 00:31:06,879
labor and delivery doctor to have an

873
00:31:05,679 --> 00:31:08,000
interaction with you they're not

874
00:31:06,880 --> 00:31:09,120
assigned to you

875
00:31:08,000 --> 00:31:12,399
they should not be looking at your

876
00:31:09,120 --> 00:31:14,080
information if you are a doctor yourself

877
00:31:12,399 --> 00:31:16,959
you should not be looking at your own

878
00:31:14,080 --> 00:31:19,039
sons or your own daughters or your own

879
00:31:16,960 --> 00:31:20,480
parents information without actually you

880
00:31:19,039 --> 00:31:23,919
know working with them without

881
00:31:20,480 --> 00:31:25,919
being assigned to them so

882
00:31:23,919 --> 00:31:28,640
it boils down to handling the health

883
00:31:25,919 --> 00:31:30,080
information on need to know basis

884
00:31:28,640 --> 00:31:32,720
many organizations are going to use

885
00:31:30,080 --> 00:31:36,080
tools like fair warning or splunk

886
00:31:32,720 --> 00:31:39,039
to alert on who accessed what data

887
00:31:36,080 --> 00:31:41,279
and did they have a reason to access it

888
00:31:39,039 --> 00:31:44,720
a lot of hospitals when dealing with

889
00:31:41,279 --> 00:31:47,760
celebrities will put a vip flag on

890
00:31:44,720 --> 00:31:49,840
the health record of that celebrity and

891
00:31:47,760 --> 00:31:51,600
monitor all access to it to make sure

892
00:31:49,840 --> 00:31:53,840
that you do not have

893
00:31:51,600 --> 00:31:55,120
some nurse or some doctor in a different

894
00:31:53,840 --> 00:31:57,120
department to a different

895
00:31:55,120 --> 00:31:58,719
location taking a look at that

896
00:31:57,120 --> 00:31:59,600
celebrities patient health record and

897
00:31:58,720 --> 00:32:03,120
linking it to

898
00:31:59,600 --> 00:32:05,279
media all right a lot of

899
00:32:03,120 --> 00:32:06,158
common things that look for the rules to

900
00:32:05,279 --> 00:32:07,840
look for is

901
00:32:06,159 --> 00:32:09,760
was it the same address as the staff

902
00:32:07,840 --> 00:32:10,480
they looked at was it the same last name

903
00:32:09,760 --> 00:32:12,720
as the staff

904
00:32:10,480 --> 00:32:15,200
vip status in different departments with

905
00:32:12,720 --> 00:32:17,600
the person from labor and delivery

906
00:32:15,200 --> 00:32:18,880
look at icu patients data did somebody

907
00:32:17,600 --> 00:32:20,879
from nursing home

908
00:32:18,880 --> 00:32:22,880
take a look at somebody from icu's data

909
00:32:20,880 --> 00:32:29,840
and if they did that's likely not

910
00:32:22,880 --> 00:32:29,840
what they should be doing

911
00:32:30,640 --> 00:32:33,679
sorry i had to make knock-knock joke in

912
00:32:32,159 --> 00:32:34,880
there it's not my meme though somebody

913
00:32:33,679 --> 00:32:37,440
else's meme so if you don't like it

914
00:32:34,880 --> 00:32:37,440
don't believe me

915
00:32:38,720 --> 00:32:41,760
all right so we talked about breaches

916
00:32:40,720 --> 00:32:44,000
earlier i kind of showed you some

917
00:32:41,760 --> 00:32:46,799
statistics on that so uh

918
00:32:44,000 --> 00:32:48,799
hipaa high tech breach rule what it

919
00:32:46,799 --> 00:32:51,918
talks about is the notification of it

920
00:32:48,799 --> 00:32:54,399
is first of all you have to define

921
00:32:51,919 --> 00:32:55,440
what the breach is and then according to

922
00:32:54,399 --> 00:32:57,840
hipaa

923
00:32:55,440 --> 00:32:59,840
connected to the ocr the definition of

924
00:32:57,840 --> 00:33:00,720
breach is the unauthorized acquisition

925
00:32:59,840 --> 00:33:03,678
access or

926
00:33:00,720 --> 00:33:05,600
use or disclosure of phi which

927
00:33:03,679 --> 00:33:08,720
compromises the security

928
00:33:05,600 --> 00:33:10,158
and privacy of that phi all right so it

929
00:33:08,720 --> 00:33:11,760
has to be authorized it has to

930
00:33:10,159 --> 00:33:12,320
compromise the security and privacy of

931
00:33:11,760 --> 00:33:14,320
it

932
00:33:12,320 --> 00:33:15,840
uh there has been some debate on if

933
00:33:14,320 --> 00:33:18,879
ransomware itself

934
00:33:15,840 --> 00:33:20,720
is uh a breach

935
00:33:18,880 --> 00:33:22,799
especially when there is no evidence

936
00:33:20,720 --> 00:33:24,399
that the data was looked at by somebody

937
00:33:22,799 --> 00:33:26,240
else there's no evidence of data being

938
00:33:24,399 --> 00:33:28,080
exfiltrated

939
00:33:26,240 --> 00:33:29,360
but later the guidance has been that it

940
00:33:28,080 --> 00:33:33,199
is a breach

941
00:33:29,360 --> 00:33:34,879
unless proven otherwise if more than 500

942
00:33:33,200 --> 00:33:36,240
records were breached and before i

943
00:33:34,880 --> 00:33:38,080
talk about that let's talk about the

944
00:33:36,240 --> 00:33:40,320
record is it could be in

945
00:33:38,080 --> 00:33:42,240
each row in the database it could be

946
00:33:40,320 --> 00:33:43,120
every health record of you every visit

947
00:33:42,240 --> 00:33:46,000
you made

948
00:33:43,120 --> 00:33:47,840
to the hospital and if there's a copy of

949
00:33:46,000 --> 00:33:49,120
it let's say i went to a hospital

950
00:33:47,840 --> 00:33:50,799
of course the hospital should keep

951
00:33:49,120 --> 00:33:51,760
backups there should be backups of those

952
00:33:50,799 --> 00:33:55,039
backups

953
00:33:51,760 --> 00:33:58,000
if the backups were also

954
00:33:55,039 --> 00:33:59,840
disclosed then that also counts as a

955
00:33:58,000 --> 00:34:03,039
separate record

956
00:33:59,840 --> 00:34:04,879
so if we have 500 records but you also

957
00:34:03,039 --> 00:34:06,720
have the backup tape of those records

958
00:34:04,880 --> 00:34:08,720
and those are also disclosed that is a

959
00:34:06,720 --> 00:34:10,879
thousand records in total even though

960
00:34:08,719 --> 00:34:13,118
they're not unique so when i talked

961
00:34:10,879 --> 00:34:15,359
about those 13 billion records earlier

962
00:34:13,119 --> 00:34:16,720
uh those were not unique 13 billion

963
00:34:15,359 --> 00:34:18,239
records

964
00:34:16,719 --> 00:34:20,399
but they all count when it comes to the

965
00:34:18,239 --> 00:34:22,078
fines when it comes to enforcement

966
00:34:20,399 --> 00:34:24,480
so if the more than 500 records are

967
00:34:22,079 --> 00:34:26,399
breached then you have to report within

968
00:34:24,480 --> 00:34:27,679
60 days to the patient to the federal

969
00:34:26,399 --> 00:34:28,719
government which would be the office of

970
00:34:27,679 --> 00:34:30,960
civil rights

971
00:34:28,719 --> 00:34:33,118
and also if you had a large breach you

972
00:34:30,960 --> 00:34:35,599
have to go to the media

973
00:34:33,119 --> 00:34:37,280
if it's less than 500 then you just

974
00:34:35,599 --> 00:34:40,320
notify

975
00:34:37,280 --> 00:34:43,520
the ocr on annual basis but you still

976
00:34:40,320 --> 00:34:45,280
have to let the patient know though so

977
00:34:43,520 --> 00:34:47,679
part of the reason for that is you don't

978
00:34:45,280 --> 00:34:50,560
want to be writing reports

979
00:34:47,679 --> 00:34:50,879
to ocr for every record breach we have

980
00:34:50,560 --> 00:34:53,520
you

981
00:34:50,879 --> 00:34:54,879
might have just one record breached uh

982
00:34:53,520 --> 00:34:56,320
let's say it's once a day

983
00:34:54,879 --> 00:34:57,920
that's still gonna be a lot of forms to

984
00:34:56,320 --> 00:34:58,480
fail so you're gonna combine them into

985
00:34:57,920 --> 00:35:03,200
one big

986
00:34:58,480 --> 00:35:05,040
notification at the end

987
00:35:03,200 --> 00:35:07,118
this is the best use of hipaa for me

988
00:35:05,040 --> 00:35:07,839
that i like right allows you to avoid

989
00:35:07,119 --> 00:35:11,680
those uh

990
00:35:07,839 --> 00:35:11,680
conversations with pesky family members

991
00:35:11,760 --> 00:35:18,560
all right uh so uh something is

992
00:35:15,359 --> 00:35:21,598
if the data was disclosed but

993
00:35:18,560 --> 00:35:25,359
it was encrypted um

994
00:35:21,599 --> 00:35:28,240
well still kind of a breach but

995
00:35:25,359 --> 00:35:28,720
you are not able there's no disclosure

996
00:35:28,240 --> 00:35:31,598
to be

997
00:35:28,720 --> 00:35:32,879
to be technical about it all right the

998
00:35:31,599 --> 00:35:35,280
unencrypted phi

999
00:35:32,880 --> 00:35:37,040
the phi that has not been encrypted

1000
00:35:35,280 --> 00:35:40,079
could technically be

1001
00:35:37,040 --> 00:35:42,640
um hipaa compliant

1002
00:35:40,079 --> 00:35:43,200
but if it's not encrypted and you got a

1003
00:35:42,640 --> 00:35:44,720
breach

1004
00:35:43,200 --> 00:35:46,640
then you're gonna have a huge problem

1005
00:35:44,720 --> 00:35:48,799
and to be fair though

1006
00:35:46,640 --> 00:35:50,720
um if you read more into the rule you

1007
00:35:48,800 --> 00:35:52,079
are not they're not necessarily saying

1008
00:35:50,720 --> 00:35:54,640
that you just say well

1009
00:35:52,079 --> 00:35:56,079
i don't need encryption and that's it uh

1010
00:35:54,640 --> 00:35:58,319
they're still looking for

1011
00:35:56,079 --> 00:36:00,240
reason why you don't need encryption

1012
00:35:58,320 --> 00:36:03,119
right we try to address the issue

1013
00:36:00,240 --> 00:36:04,720
what controls you have in place that

1014
00:36:03,119 --> 00:36:08,800
make it reasonable for you to

1015
00:36:04,720 --> 00:36:11,118
not have encryption the phi was shredded

1016
00:36:08,800 --> 00:36:12,560
in a way that makes it unreadable not

1017
00:36:11,119 --> 00:36:14,800
necessarily a breach

1018
00:36:12,560 --> 00:36:16,000
right or you may have issues like for

1019
00:36:14,800 --> 00:36:19,440
example

1020
00:36:16,000 --> 00:36:20,400
um a nurse or

1021
00:36:19,440 --> 00:36:23,440
you know somebody in a physician's

1022
00:36:20,400 --> 00:36:25,680
office let's say a nurse or a doctor

1023
00:36:23,440 --> 00:36:28,480
accidentally gives a medical summary to

1024
00:36:25,680 --> 00:36:30,399
wrong patient

1025
00:36:28,480 --> 00:36:32,960
who immediately sees it that's not hers

1026
00:36:30,400 --> 00:36:35,760
and returns it back

1027
00:36:32,960 --> 00:36:37,040
that is considered and then the rule

1028
00:36:35,760 --> 00:36:39,599
disclosure to a person

1029
00:36:37,040 --> 00:36:40,960
unlikely to retain that information so

1030
00:36:39,599 --> 00:36:42,079
if that's the case if you can prove

1031
00:36:40,960 --> 00:36:44,640
that's the case

1032
00:36:42,079 --> 00:36:46,320
then it may not be a breach then again

1033
00:36:44,640 --> 00:36:48,879
not a hypo authority on this you still

1034
00:36:46,320 --> 00:36:50,400
should work with

1035
00:36:48,880 --> 00:36:51,920
your compliance department they are

1036
00:36:50,400 --> 00:36:54,720
really the ones who understand these

1037
00:36:51,920 --> 00:36:56,720
things very well

1038
00:36:54,720 --> 00:36:59,598
and again in the end whatever the

1039
00:36:56,720 --> 00:36:59,598
government says goes

1040
00:37:00,320 --> 00:37:04,560
so if there was a breach what's gonna

1041
00:37:02,720 --> 00:37:05,680
happen well the office of civil rights

1042
00:37:04,560 --> 00:37:07,200
will be in your business

1043
00:37:05,680 --> 00:37:09,359
all right they'll come in they'll

1044
00:37:07,200 --> 00:37:11,118
require you to conduct a risk assessment

1045
00:37:09,359 --> 00:37:12,720
they will

1046
00:37:11,119 --> 00:37:15,359
require you to have a corrective action

1047
00:37:12,720 --> 00:37:17,839
plan for whatever issues were identified

1048
00:37:15,359 --> 00:37:19,680
they may even sometimes do surprise

1049
00:37:17,839 --> 00:37:21,359
on-site visits to make sure you have

1050
00:37:19,680 --> 00:37:24,078
good physical security

1051
00:37:21,359 --> 00:37:25,920
and take a look at your papers in

1052
00:37:24,079 --> 00:37:29,280
addition to hipaa nowadays there is

1053
00:37:25,920 --> 00:37:29,839
high trust i have yet to find somebody

1054
00:37:29,280 --> 00:37:33,520
who

1055
00:37:29,839 --> 00:37:33,920
loves hytrust but to be candid there's

1056
00:37:33,520 --> 00:37:35,759
some

1057
00:37:33,920 --> 00:37:37,119
really good technical rules in hydras

1058
00:37:35,760 --> 00:37:39,920
that that i like

1059
00:37:37,119 --> 00:37:40,320
uh being technical um hytrust is kind of

1060
00:37:39,920 --> 00:37:43,839
a

1061
00:37:40,320 --> 00:37:46,880
mixture of your isos 27002 your hipaa

1062
00:37:43,839 --> 00:37:49,440
nist fedramp pci a lot of things like

1063
00:37:46,880 --> 00:37:51,280
segmentation it takes from pci

1064
00:37:49,440 --> 00:37:53,040
it's got three different levels of

1065
00:37:51,280 --> 00:37:54,640
requirements not every hospital is

1066
00:37:53,040 --> 00:37:55,599
created equal so they're not always

1067
00:37:54,640 --> 00:37:58,720
going to have to be the same

1068
00:37:55,599 --> 00:37:58,720
requirements for everybody

1069
00:37:58,800 --> 00:38:04,400
every requirement needs to be rated for

1070
00:38:02,160 --> 00:38:06,560
is there a policy for this is there a

1071
00:38:04,400 --> 00:38:09,599
procedure in place that talks about it

1072
00:38:06,560 --> 00:38:12,000
how well are we implementing it and then

1073
00:38:09,599 --> 00:38:13,520
are we measuring the success of this

1074
00:38:12,000 --> 00:38:15,839
requirement being implemented

1075
00:38:13,520 --> 00:38:17,599
and if there are issues how are we

1076
00:38:15,839 --> 00:38:19,440
remediating them

1077
00:38:17,599 --> 00:38:21,200
so hydras goes in a lot of depth you

1078
00:38:19,440 --> 00:38:22,960
know to that and this is kind of the

1079
00:38:21,200 --> 00:38:25,200
reason why a lot of us consultants

1080
00:38:22,960 --> 00:38:28,079
do not like hydras because it does cause

1081
00:38:25,200 --> 00:38:28,078
a lot of work

1082
00:38:28,640 --> 00:38:34,400
we talked about uh hl7 earlier

1083
00:38:32,160 --> 00:38:35,920
so let's talk about fire all right fire

1084
00:38:34,400 --> 00:38:38,960
is the next evolution

1085
00:38:35,920 --> 00:38:40,079
it still is uh to some extent you know

1086
00:38:38,960 --> 00:38:42,560
you're trying to encode the

1087
00:38:40,079 --> 00:38:43,520
information to make it cross fender

1088
00:38:42,560 --> 00:38:46,960
compatible

1089
00:38:43,520 --> 00:38:50,079
but it supports restful apis it supports

1090
00:38:46,960 --> 00:38:52,880
oauth and json tokens right so

1091
00:38:50,079 --> 00:38:55,040
it also supports the digital signatures

1092
00:38:52,880 --> 00:38:56,960
so it brings in the confidentiality

1093
00:38:55,040 --> 00:38:58,800
integrity and availability of the data

1094
00:38:56,960 --> 00:39:01,280
that we like to get to

1095
00:38:58,800 --> 00:39:02,400
uh it is not being enforced quite a bit

1096
00:39:01,280 --> 00:39:05,040
yet it's not being

1097
00:39:02,400 --> 00:39:07,200
used by new devices and to be candid if

1098
00:39:05,040 --> 00:39:07,599
the device is still working the hospital

1099
00:39:07,200 --> 00:39:10,078
has

1100
00:39:07,599 --> 00:39:11,760
very little reason to change it

1101
00:39:10,079 --> 00:39:14,800
oftentimes those devices can cost

1102
00:39:11,760 --> 00:39:16,320
millions or it can be you know even if

1103
00:39:14,800 --> 00:39:18,160
it doesn't cost a lot of money

1104
00:39:16,320 --> 00:39:20,400
to buy the device it could cost a lot of

1105
00:39:18,160 --> 00:39:23,118
money to train people to use it

1106
00:39:20,400 --> 00:39:25,440
to train organization to implement that

1107
00:39:23,119 --> 00:39:25,440
device

1108
00:39:26,560 --> 00:39:29,839
so where are the crown jewels we talked

1109
00:39:29,119 --> 00:39:31,760
about uh

1110
00:39:29,839 --> 00:39:33,359
how i've been getting in we talked about

1111
00:39:31,760 --> 00:39:36,800
some of the issues we've seen

1112
00:39:33,359 --> 00:39:39,040
uh once you are as a pen tester

1113
00:39:36,800 --> 00:39:40,640
you are looking at an organization

1114
00:39:39,040 --> 00:39:42,560
you've got domain admin or you've got

1115
00:39:40,640 --> 00:39:44,400
access things you need to look for

1116
00:39:42,560 --> 00:39:46,720
especially ephi

1117
00:39:44,400 --> 00:39:47,520
electronic critical protected health

1118
00:39:46,720 --> 00:39:50,319
record the

1119
00:39:47,520 --> 00:39:51,599
you know things in the emr database uh

1120
00:39:50,320 --> 00:39:54,960
patient information and

1121
00:39:51,599 --> 00:39:57,680
notepad files and whatnot count it

1122
00:39:54,960 --> 00:39:59,119
if you can get to a number above 500 you

1123
00:39:57,680 --> 00:39:59,598
will really be scaring some people and

1124
00:39:59,119 --> 00:40:02,640
that's

1125
00:39:59,599 --> 00:40:03,760
a good thing all right you need to uh be

1126
00:40:02,640 --> 00:40:07,440
able to talk

1127
00:40:03,760 --> 00:40:10,480
numbers with the executive leadership um

1128
00:40:07,440 --> 00:40:13,599
do not try the webcam shots speaking

1129
00:40:10,480 --> 00:40:14,960
about from experience um one of my

1130
00:40:13,599 --> 00:40:16,079
former colleagues the guy who actually

1131
00:40:14,960 --> 00:40:19,599
taught me pen testing

1132
00:40:16,079 --> 00:40:21,040
currently lives in boulder him and i we

1133
00:40:19,599 --> 00:40:22,480
used to do a lot of webcam screenshots

1134
00:40:21,040 --> 00:40:24,480
and there have been times when i just

1135
00:40:22,480 --> 00:40:26,400
wish i had not done a webcam screenshot

1136
00:40:24,480 --> 00:40:28,319
there are sometimes organizations that

1137
00:40:26,400 --> 00:40:31,520
want that so they can show

1138
00:40:28,319 --> 00:40:32,000
risk all right look for if you're doing

1139
00:40:31,520 --> 00:40:35,040
physical

1140
00:40:32,000 --> 00:40:38,240
look for printers fax machines copiers

1141
00:40:35,040 --> 00:40:40,000
right the unsecured unlocked

1142
00:40:38,240 --> 00:40:41,359
bins i talked about where you can just

1143
00:40:40,000 --> 00:40:44,880
snatch the paper out

1144
00:40:41,359 --> 00:40:47,119
and that would be you grabbing access to

1145
00:40:44,880 --> 00:40:48,880
a phi

1146
00:40:47,119 --> 00:40:50,240
so when i'm doing the internal network

1147
00:40:48,880 --> 00:40:52,240
tests i'm looking at

1148
00:40:50,240 --> 00:40:54,000
sometimes oftentimes starting with a

1149
00:40:52,240 --> 00:40:57,919
responder i know a lot of

1150
00:40:54,000 --> 00:40:59,520
us feel too elite to use responder but

1151
00:40:57,920 --> 00:41:01,280
broadcast protocols are there

1152
00:40:59,520 --> 00:41:03,040
may as well use them right don't don't

1153
00:41:01,280 --> 00:41:04,079
try to complicate the pen test if you

1154
00:41:03,040 --> 00:41:07,599
don't have to

1155
00:41:04,079 --> 00:41:11,520
so a lot of medical devices and services

1156
00:41:07,599 --> 00:41:14,400
are going to use broadcast protocols to

1157
00:41:11,520 --> 00:41:16,400
do their work especially when you have

1158
00:41:14,400 --> 00:41:18,480
dental emrs and

1159
00:41:16,400 --> 00:41:20,720
other applications that are using smb

1160
00:41:18,480 --> 00:41:23,680
shares to do their work they're storing

1161
00:41:20,720 --> 00:41:25,759
data on smp share and pulling it

1162
00:41:23,680 --> 00:41:26,879
i'm a big fan of cme crack map exec

1163
00:41:25,760 --> 00:41:30,160
thanks marcelo

1164
00:41:26,880 --> 00:41:33,200
um use the 80 defaults i had the

1165
00:41:30,160 --> 00:41:36,399
link i provided in the slides back there

1166
00:41:33,200 --> 00:41:38,720
uh from shakacon has a lot of medical

1167
00:41:36,400 --> 00:41:42,240
device defaults in there many of them

1168
00:41:38,720 --> 00:41:44,399
are ad accounts especially muse admin

1169
00:41:42,240 --> 00:41:46,399
all right tattoo this write it down

1170
00:41:44,400 --> 00:41:47,359
somewhere whatever way you like to do

1171
00:41:46,400 --> 00:41:49,119
your password list

1172
00:41:47,359 --> 00:41:50,720
this right here is a really good

1173
00:41:49,119 --> 00:41:52,319
credential to use

1174
00:41:50,720 --> 00:41:54,160
use metasploit or whichever tool you

1175
00:41:52,319 --> 00:41:57,440
like to look for

1176
00:41:54,160 --> 00:42:01,118
unauthenticated vnc instances

1177
00:41:57,440 --> 00:42:04,000
look for ms sql one thing

1178
00:42:01,119 --> 00:42:05,200
be very careful do not lock out the emr

1179
00:42:04,000 --> 00:42:06,480
database

1180
00:42:05,200 --> 00:42:09,118
i've been through that i've seen that

1181
00:42:06,480 --> 00:42:10,880
happen um the client still brought us

1182
00:42:09,119 --> 00:42:11,359
back but it was not a fun thing to go

1183
00:42:10,880 --> 00:42:13,040
through

1184
00:42:11,359 --> 00:42:14,720
when i was working at center i went

1185
00:42:13,040 --> 00:42:16,480
through some of these issues where

1186
00:42:14,720 --> 00:42:19,040
the emr database is no longer working or

1187
00:42:16,480 --> 00:42:21,040
emr is just down there's an outage

1188
00:42:19,040 --> 00:42:23,040
and that creates a lot of friction

1189
00:42:21,040 --> 00:42:26,000
between i.t and clinicians that

1190
00:42:23,040 --> 00:42:27,040
is not healthy for the security of the

1191
00:42:26,000 --> 00:42:29,839
organization

1192
00:42:27,040 --> 00:42:31,200
it also means the clinicians now have to

1193
00:42:29,839 --> 00:42:32,560
go to paper they have to write

1194
00:42:31,200 --> 00:42:34,480
everything down

1195
00:42:32,560 --> 00:42:36,480
and then they have to once the emr is

1196
00:42:34,480 --> 00:42:39,040
back put that information back

1197
00:42:36,480 --> 00:42:40,240
in the database or in the emr which

1198
00:42:39,040 --> 00:42:42,240
doubles the work

1199
00:42:40,240 --> 00:42:44,160
also now you have paper records that you

1200
00:42:42,240 --> 00:42:46,799
have to worry about securing

1201
00:42:44,160 --> 00:42:49,200
so don't lock other databases if try

1202
00:42:46,800 --> 00:42:51,680
avoiding msql if you can until you have

1203
00:42:49,200 --> 00:42:54,720
good credentials

1204
00:42:51,680 --> 00:42:58,440
maybe just try one password with

1205
00:42:54,720 --> 00:42:59,598
a list of multiple usernames so look for

1206
00:42:58,440 --> 00:43:02,000
ephi

1207
00:42:59,599 --> 00:43:04,079
look for credits especially take a look

1208
00:43:02,000 --> 00:43:05,680
at the smb nfs shares you'll find a lot

1209
00:43:04,079 --> 00:43:07,599
of stuff in there

1210
00:43:05,680 --> 00:43:10,319
eyewitness and peeping tom have been

1211
00:43:07,599 --> 00:43:12,400
really helpful for me to identify

1212
00:43:10,319 --> 00:43:13,359
unauthenticated web apps that i could

1213
00:43:12,400 --> 00:43:15,680
log into

1214
00:43:13,359 --> 00:43:16,480
well i'm trying to get a no login that i

1215
00:43:15,680 --> 00:43:19,520
could get to

1216
00:43:16,480 --> 00:43:21,359
and get patient data and again count the

1217
00:43:19,520 --> 00:43:23,200
patient data you receive

1218
00:43:21,359 --> 00:43:24,799
right so if you are in ms equal you know

1219
00:43:23,200 --> 00:43:27,839
do a select account all

1220
00:43:24,800 --> 00:43:27,839
uh if you are

1221
00:43:28,079 --> 00:43:31,920
walking in doing a physical still count

1222
00:43:29,839 --> 00:43:33,680
how many paper records you got

1223
00:43:31,920 --> 00:43:35,119
because the number of records you were

1224
00:43:33,680 --> 00:43:37,200
able to breach

1225
00:43:35,119 --> 00:43:40,880
uh is what will really help the security

1226
00:43:37,200 --> 00:43:43,520
team get the funding

1227
00:43:40,880 --> 00:43:45,119
privilege escalation look for clinical

1228
00:43:43,520 --> 00:43:46,240
application binaries that have bad

1229
00:43:45,119 --> 00:43:47,920
permissions on them

1230
00:43:46,240 --> 00:43:49,359
so you could do something with you know

1231
00:43:47,920 --> 00:43:50,960
with the power up

1232
00:43:49,359 --> 00:43:53,680
you can exploit them look for

1233
00:43:50,960 --> 00:43:55,520
configuration files dot ini dot config

1234
00:43:53,680 --> 00:43:57,440
files that are sitting in c program

1235
00:43:55,520 --> 00:43:58,880
files or other specific application

1236
00:43:57,440 --> 00:44:02,800
folders or even

1237
00:43:58,880 --> 00:44:04,319
on network shares oftentimes the way the

1238
00:44:02,800 --> 00:44:05,119
application is installed on the share

1239
00:44:04,319 --> 00:44:07,119
and then access

1240
00:44:05,119 --> 00:44:08,960
is just because you have access to the

1241
00:44:07,119 --> 00:44:12,640
share to read the

1242
00:44:08,960 --> 00:44:14,319
phi the data and the config file is also

1243
00:44:12,640 --> 00:44:16,078
stored on the same share you may also be

1244
00:44:14,319 --> 00:44:16,960
able to read passwords for the database

1245
00:44:16,079 --> 00:44:18,560
from the share

1246
00:44:16,960 --> 00:44:20,400
and that point the access controller

1247
00:44:18,560 --> 00:44:22,000
goes out the window

1248
00:44:20,400 --> 00:44:25,040
look for the environment variables a lot

1249
00:44:22,000 --> 00:44:27,200
of organizations a lot of um

1250
00:44:25,040 --> 00:44:28,880
software vendors due to the security

1251
00:44:27,200 --> 00:44:29,520
concerns of configuration files as being

1252
00:44:28,880 --> 00:44:32,079
out there

1253
00:44:29,520 --> 00:44:33,040
are moving to environment variables uh

1254
00:44:32,079 --> 00:44:37,119
which still

1255
00:44:33,040 --> 00:44:40,240
depending on your access you could read

1256
00:44:37,119 --> 00:44:43,359
for external i like to uh still use muse

1257
00:44:40,240 --> 00:44:46,319
admin on citrix and owa on the vpn right

1258
00:44:43,359 --> 00:44:47,040
uh grab some weak passwords with using

1259
00:44:46,319 --> 00:44:49,520
harvester

1260
00:44:47,040 --> 00:44:50,160
go after some portals this is a google

1261
00:44:49,520 --> 00:44:52,880
door

1262
00:44:50,160 --> 00:44:54,879
i've found to be very useful uh to find

1263
00:44:52,880 --> 00:44:55,440
patient portals where patients will log

1264
00:44:54,880 --> 00:44:58,000
in to

1265
00:44:55,440 --> 00:44:59,599
find their patient records just be

1266
00:44:58,000 --> 00:45:01,839
careful sometimes they are

1267
00:44:59,599 --> 00:45:02,839
third party hosted so you'd want to make

1268
00:45:01,839 --> 00:45:07,119
take a look at the

1269
00:45:02,839 --> 00:45:09,680
scope some common passwords

1270
00:45:07,119 --> 00:45:11,839
you want to try uh some variation of

1271
00:45:09,680 --> 00:45:13,839
welcome

1272
00:45:11,839 --> 00:45:15,440
very recently we found an organization

1273
00:45:13,839 --> 00:45:19,359
where we had uh

1274
00:45:15,440 --> 00:45:21,359
over six thousand welcome one passwords

1275
00:45:19,359 --> 00:45:23,119
or welcome one to three it kind of just

1276
00:45:21,359 --> 00:45:24,640
went from one two and three

1277
00:45:23,119 --> 00:45:26,480
every 90 days as they were changing the

1278
00:45:24,640 --> 00:45:28,240
password uh

1279
00:45:26,480 --> 00:45:29,760
old name or the mnemonic is often very

1280
00:45:28,240 --> 00:45:31,200
common in the passwords

1281
00:45:29,760 --> 00:45:32,800
not just specific to healthcare but

1282
00:45:31,200 --> 00:45:35,200
everywhere else

1283
00:45:32,800 --> 00:45:36,160
the change of the emr is generally an

1284
00:45:35,200 --> 00:45:39,200
overnight event

1285
00:45:36,160 --> 00:45:42,560
it's a very extensive event

1286
00:45:39,200 --> 00:45:45,040
which leaves a an impact on people's

1287
00:45:42,560 --> 00:45:46,240
minds they remember it and the event is

1288
00:45:45,040 --> 00:45:48,319
called go live

1289
00:45:46,240 --> 00:45:50,640
you're going live with cerner or epic or

1290
00:45:48,319 --> 00:45:52,240
whatnot so that ends up in a lot of

1291
00:45:50,640 --> 00:45:53,598
passwords

1292
00:45:52,240 --> 00:45:55,680
and of course you've got you know the

1293
00:45:53,599 --> 00:45:56,720
coronavirus or code happening and that

1294
00:45:55,680 --> 00:46:00,160
impacts

1295
00:45:56,720 --> 00:46:02,560
um what passwords are being used

1296
00:46:00,160 --> 00:46:04,480
all right complex medical terms uh

1297
00:46:02,560 --> 00:46:06,960
they're easy for the doctor to remember

1298
00:46:04,480 --> 00:46:08,240
they i think they're not easy for you to

1299
00:46:06,960 --> 00:46:09,920
try but

1300
00:46:08,240 --> 00:46:12,319
if you put them in a password less than

1301
00:46:09,920 --> 00:46:15,599
really it's not hard to uh try them

1302
00:46:12,319 --> 00:46:18,000
um always try

1303
00:46:15,599 --> 00:46:20,000
the digit and first uppercase letter

1304
00:46:18,000 --> 00:46:22,800
because special character is not being

1305
00:46:20,000 --> 00:46:22,800
used a lot still

1306
00:46:23,680 --> 00:46:27,040
as you are performing the pen test it's

1307
00:46:26,160 --> 00:46:30,240
important to

1308
00:46:27,040 --> 00:46:32,160
try and avoid hitting the emr or hr

1309
00:46:30,240 --> 00:46:33,919
right away at least don't scan it don't

1310
00:46:32,160 --> 00:46:36,000
put nasa scans at it

1311
00:46:33,920 --> 00:46:38,000
um and if you're going to do that work

1312
00:46:36,000 --> 00:46:39,920
with the organizations to understand how

1313
00:46:38,000 --> 00:46:42,079
they do it so you're not going to just

1314
00:46:39,920 --> 00:46:44,400
take it down on day one

1315
00:46:42,079 --> 00:46:45,599
try avoiding scanning medical devices or

1316
00:46:44,400 --> 00:46:46,800
battery backups

1317
00:46:45,599 --> 00:46:48,720
and as i mentioned earlier a lot of

1318
00:46:46,800 --> 00:46:51,040
organizations don't know

1319
00:46:48,720 --> 00:46:52,078
where their medical devices are many

1320
00:46:51,040 --> 00:46:54,240
might not even know

1321
00:46:52,079 --> 00:46:55,200
what ip scheme their battery backups

1322
00:46:54,240 --> 00:46:57,919
have

1323
00:46:55,200 --> 00:47:00,399
so helping figuring that out during

1324
00:46:57,920 --> 00:47:04,079
scoping exercises is pretty good idea

1325
00:47:00,400 --> 00:47:05,920
look out for uh you know the

1326
00:47:04,079 --> 00:47:07,839
ms sql server accounts 80 service

1327
00:47:05,920 --> 00:47:11,760
account medical device accounts

1328
00:47:07,839 --> 00:47:13,599
um talk to the client and understand

1329
00:47:11,760 --> 00:47:15,520
what they're concerned with uh do not

1330
00:47:13,599 --> 00:47:18,480
lock them out because locking them out

1331
00:47:15,520 --> 00:47:19,599
would mean you don't come back also when

1332
00:47:18,480 --> 00:47:21,440
you cause an outage

1333
00:47:19,599 --> 00:47:23,119
and i say you and i've done that i've

1334
00:47:21,440 --> 00:47:26,640
done in the past where once

1335
00:47:23,119 --> 00:47:29,119
this one very uh common emr

1336
00:47:26,640 --> 00:47:30,480
i typed in a percentage sign in the

1337
00:47:29,119 --> 00:47:32,079
username field

1338
00:47:30,480 --> 00:47:33,520
it thought i was trying to log in as

1339
00:47:32,079 --> 00:47:35,359
every user

1340
00:47:33,520 --> 00:47:37,040
all of us were trying to do was find sql

1341
00:47:35,359 --> 00:47:39,119
injection or something like that

1342
00:47:37,040 --> 00:47:40,640
but it locked out every user because i

1343
00:47:39,119 --> 00:47:43,280
thought i was trying to log in as them

1344
00:47:40,640 --> 00:47:44,319
so try avoiding that because that would

1345
00:47:43,280 --> 00:47:46,880
create a lot of friction

1346
00:47:44,319 --> 00:47:47,680
the security is already seen as a

1347
00:47:46,880 --> 00:47:48,880
blocker

1348
00:47:47,680 --> 00:47:51,440
right that's something that prevents you

1349
00:47:48,880 --> 00:47:52,880
from patient care that's a very common

1350
00:47:51,440 --> 00:47:55,599
excuse i've heard

1351
00:47:52,880 --> 00:47:57,200
is that two second that has taken me to

1352
00:47:55,599 --> 00:48:00,160
type in my 2fa

1353
00:47:57,200 --> 00:48:01,598
is taking time away from the patients so

1354
00:48:00,160 --> 00:48:05,440
try to be as

1355
00:48:01,599 --> 00:48:07,680
easy uh as uh collaborative as you can

1356
00:48:05,440 --> 00:48:09,200
collaboration is the key word in there

1357
00:48:07,680 --> 00:48:13,598
and as i mentioned earlier

1358
00:48:09,200 --> 00:48:16,879
try avoiding webcam shots if you can

1359
00:48:13,599 --> 00:48:19,119
as we are scoping again you know of find

1360
00:48:16,880 --> 00:48:21,760
places where you should not be doing a

1361
00:48:19,119 --> 00:48:22,400
nasa scan or koala scan or an xbox scan

1362
00:48:21,760 --> 00:48:25,200
because

1363
00:48:22,400 --> 00:48:25,680
you don't want to take things down look

1364
00:48:25,200 --> 00:48:27,598
for

1365
00:48:25,680 --> 00:48:29,919
sensitive devices and networks that you

1366
00:48:27,599 --> 00:48:32,319
should not scan and also look for

1367
00:48:29,920 --> 00:48:33,200
how the organization's network is laid

1368
00:48:32,319 --> 00:48:35,200
out because

1369
00:48:33,200 --> 00:48:36,960
that map i showed you earlier it's all

1370
00:48:35,200 --> 00:48:39,200
flat a lot of

1371
00:48:36,960 --> 00:48:40,319
healthcare organizations are still flat

1372
00:48:39,200 --> 00:48:43,200
organizations

1373
00:48:40,319 --> 00:48:44,880
flat networks so it's very much possible

1374
00:48:43,200 --> 00:48:45,759
if you're pen testing university health

1375
00:48:44,880 --> 00:48:47,520
center

1376
00:48:45,760 --> 00:48:49,440
and you're hired by the health center to

1377
00:48:47,520 --> 00:48:51,599
pentest them

1378
00:48:49,440 --> 00:48:52,559
your nasa scans could very likely or

1379
00:48:51,599 --> 00:48:54,559
your nmap scans

1380
00:48:52,559 --> 00:48:55,599
could very likely be hitting the

1381
00:48:54,559 --> 00:48:57,839
university

1382
00:48:55,599 --> 00:48:59,760
which is not in scope so figure that out

1383
00:48:57,839 --> 00:49:03,119
in the scoping exercises

1384
00:48:59,760 --> 00:49:04,880
all right identify any uh

1385
00:49:03,119 --> 00:49:06,319
password lock out policies if you can if

1386
00:49:04,880 --> 00:49:07,200
the client doesn't feel comfortable

1387
00:49:06,319 --> 00:49:08,558
telling you

1388
00:49:07,200 --> 00:49:10,558
because it's not a pen test it's a red

1389
00:49:08,559 --> 00:49:11,760
team well go and look for that in google

1390
00:49:10,559 --> 00:49:13,599
use google doors

1391
00:49:11,760 --> 00:49:15,280
you can find the password policy video

1392
00:49:13,599 --> 00:49:17,040
commonly

1393
00:49:15,280 --> 00:49:18,240
so you do not lock out clinician

1394
00:49:17,040 --> 00:49:20,000
accounts because they may be in the

1395
00:49:18,240 --> 00:49:21,439
middle of some very sensitive care they

1396
00:49:20,000 --> 00:49:22,800
may be working with an anesthesia

1397
00:49:21,440 --> 00:49:25,839
machine at that point

1398
00:49:22,800 --> 00:49:27,440
right so be very careful with that um

1399
00:49:25,839 --> 00:49:29,119
work with the organization to figure out

1400
00:49:27,440 --> 00:49:30,319
the vulnerability scanning schedule

1401
00:49:29,119 --> 00:49:32,319
especially if it's a pen test and you

1402
00:49:30,319 --> 00:49:33,759
have to do vulnerability scanning um

1403
00:49:32,319 --> 00:49:36,480
try to figure out if there's a if they

1404
00:49:33,760 --> 00:49:38,960
want you to do heavy lifting heavy

1405
00:49:36,480 --> 00:49:39,520
activity after hours now one question i

1406
00:49:38,960 --> 00:49:41,920
often

1407
00:49:39,520 --> 00:49:43,759
follow that up with is if i am working

1408
00:49:41,920 --> 00:49:47,280
after hours to do this

1409
00:49:43,760 --> 00:49:49,440
scan that has some little possibility of

1410
00:49:47,280 --> 00:49:51,359
causing issues do you have anybody

1411
00:49:49,440 --> 00:49:52,880
working at night

1412
00:49:51,359 --> 00:49:55,040
because there really isn't a point

1413
00:49:52,880 --> 00:49:56,400
making the tester the scanner you know

1414
00:49:55,040 --> 00:49:57,759
do the scan at night

1415
00:49:56,400 --> 00:50:01,760
when if something goes down there's

1416
00:49:57,760 --> 00:50:05,119
nobody available to call

1417
00:50:01,760 --> 00:50:07,760
um if you're doing physical try to avoid

1418
00:50:05,119 --> 00:50:09,680
uh you know nuclear medicine or areas

1419
00:50:07,760 --> 00:50:11,119
like that unless you want superpowers so

1420
00:50:09,680 --> 00:50:13,919
work with the client to understand which

1421
00:50:11,119 --> 00:50:15,520
areas you should stay away from

1422
00:50:13,920 --> 00:50:17,119
if you're a male you'll likely be asked

1423
00:50:15,520 --> 00:50:17,839
to stay away from labor and delivery

1424
00:50:17,119 --> 00:50:21,119
area

1425
00:50:17,839 --> 00:50:21,759
um and they may have some you know very

1426
00:50:21,119 --> 00:50:23,839
specific

1427
00:50:21,760 --> 00:50:25,119
research areas that you want they want

1428
00:50:23,839 --> 00:50:27,279
you to stay away from

1429
00:50:25,119 --> 00:50:29,440
if you're medical i'm sure if you're in

1430
00:50:27,280 --> 00:50:32,640
wireless network

1431
00:50:29,440 --> 00:50:34,400
you will likely see wep devices so

1432
00:50:32,640 --> 00:50:36,720
identifying what the ssids

1433
00:50:34,400 --> 00:50:38,000
are specific to the hospital and which

1434
00:50:36,720 --> 00:50:39,598
ones you can go after

1435
00:50:38,000 --> 00:50:41,760
they might sometimes tell you do not go

1436
00:50:39,599 --> 00:50:44,079
after this specific device because

1437
00:50:41,760 --> 00:50:45,760
um you know it's sensitive or something

1438
00:50:44,079 --> 00:50:49,119
like that

1439
00:50:45,760 --> 00:50:51,280
also understanding their domains um

1440
00:50:49,119 --> 00:50:52,480
and this is based on experience uh we

1441
00:50:51,280 --> 00:50:56,160
were doing a pen test back in

1442
00:50:52,480 --> 00:50:59,040
i think 2016. um this organization

1443
00:50:56,160 --> 00:51:01,118
had a an ad domain an active directory

1444
00:50:59,040 --> 00:51:03,279
domain that we got into

1445
00:51:01,119 --> 00:51:04,720
with three character passwords three

1446
00:51:03,280 --> 00:51:07,520
character user names

1447
00:51:04,720 --> 00:51:08,000
it was windows server 2003 domain

1448
00:51:07,520 --> 00:51:10,319
controller

1449
00:51:08,000 --> 00:51:12,000
and every other server was it on that um

1450
00:51:10,319 --> 00:51:14,160
timeline too

1451
00:51:12,000 --> 00:51:15,839
turns out because once we got domain

1452
00:51:14,160 --> 00:51:16,558
pretty quickly couldn't believe it

1453
00:51:15,839 --> 00:51:17,759
because the

1454
00:51:16,559 --> 00:51:20,079
the organization looked pretty good

1455
00:51:17,760 --> 00:51:21,359
otherwise we went and talked to the cso

1456
00:51:20,079 --> 00:51:23,680
who hired us

1457
00:51:21,359 --> 00:51:25,200
and uh they said well i have no idea who

1458
00:51:23,680 --> 00:51:27,279
this is

1459
00:51:25,200 --> 00:51:29,200
that's very scary at that point we have

1460
00:51:27,280 --> 00:51:31,359
a domain in your network range

1461
00:51:29,200 --> 00:51:32,240
an active directory domain with servers

1462
00:51:31,359 --> 00:51:34,558
and users that

1463
00:51:32,240 --> 00:51:37,200
you don't know who that is talk to the

1464
00:51:34,559 --> 00:51:40,480
id manager had no idea

1465
00:51:37,200 --> 00:51:42,319
talked to compliance they had no idea

1466
00:51:40,480 --> 00:51:44,640
uh biomed which is a department that

1467
00:51:42,319 --> 00:51:46,800
manages biomedical devices

1468
00:51:44,640 --> 00:51:48,160
in the environment they had no idea well

1469
00:51:46,800 --> 00:51:50,400
that's pretty scary

1470
00:51:48,160 --> 00:51:52,480
so let's uh bring everybody together and

1471
00:51:50,400 --> 00:51:54,079
see what's going on we did some research

1472
00:51:52,480 --> 00:51:55,920
on our own the client also talked to

1473
00:51:54,079 --> 00:51:56,319
their contracts department and it turns

1474
00:51:55,920 --> 00:51:59,359
out

1475
00:51:56,319 --> 00:52:00,800
this was an emr vendor about five six

1476
00:51:59,359 --> 00:52:02,480
years ago came in

1477
00:52:00,800 --> 00:52:04,480
set up an active directory domain for

1478
00:52:02,480 --> 00:52:07,359
their devices

1479
00:52:04,480 --> 00:52:08,960
and it was communicated but the person

1480
00:52:07,359 --> 00:52:09,598
who was communicated to no longer was

1481
00:52:08,960 --> 00:52:11,359
there

1482
00:52:09,599 --> 00:52:12,720
it was in the contract so everybody just

1483
00:52:11,359 --> 00:52:14,960
thought you know it's in there

1484
00:52:12,720 --> 00:52:15,919
they'll know but of course the client

1485
00:52:14,960 --> 00:52:17,920
there now

1486
00:52:15,920 --> 00:52:19,520
so inventorying while you are doing the

1487
00:52:17,920 --> 00:52:24,000
pen testing might actually be helpful

1488
00:52:19,520 --> 00:52:27,200
um for your client all right

1489
00:52:24,000 --> 00:52:29,520
so that is it uh

1490
00:52:27,200 --> 00:52:30,960
that's uh not all i want to talk about

1491
00:52:29,520 --> 00:52:33,599
with health care but this is all

1492
00:52:30,960 --> 00:52:36,480
uh um that's important and we want to

1493
00:52:33,599 --> 00:52:38,319
talk about in this this time slot

1494
00:52:36,480 --> 00:52:40,240
that's my twitter handle right there uh

1495
00:52:38,319 --> 00:52:42,000
this right here is my linkedin page if

1496
00:52:40,240 --> 00:52:43,598
anybody wants to go and connect i'm

1497
00:52:42,000 --> 00:52:45,200
happy to talk about anything i'll also

1498
00:52:43,599 --> 00:52:46,960
be a discord

1499
00:52:45,200 --> 00:52:48,799
to answer any questions you all may have

1500
00:52:46,960 --> 00:52:49,839
i think i can come up with at least one

1501
00:52:48,800 --> 00:52:51,440
that i'm interested in

1502
00:52:49,839 --> 00:52:52,960
and one that everybody might be

1503
00:52:51,440 --> 00:52:54,480
interested in yeah

1504
00:52:52,960 --> 00:52:56,240
we were discussing open source

1505
00:52:54,480 --> 00:52:57,760
computerized patient records and clinic

1506
00:52:56,240 --> 00:52:59,040
software earlier

1507
00:52:57,760 --> 00:53:00,240
and we speculated that there was

1508
00:52:59,040 --> 00:53:02,079
something there's probably some

1509
00:53:00,240 --> 00:53:02,959
legislative block to that that the big

1510
00:53:02,079 --> 00:53:04,800
companies

1511
00:53:02,960 --> 00:53:06,559
managed to get past you are you aware of

1512
00:53:04,800 --> 00:53:08,559
anything like that

1513
00:53:06,559 --> 00:53:10,640
uh not specifically but i can tell you

1514
00:53:08,559 --> 00:53:12,559
those big companies

1515
00:53:10,640 --> 00:53:15,359
do have a lot of lobbying money

1516
00:53:12,559 --> 00:53:19,200
healthcare is very lucrative business

1517
00:53:15,359 --> 00:53:19,759
um for example uh if you look at the

1518
00:53:19,200 --> 00:53:22,078
cost

1519
00:53:19,760 --> 00:53:22,800
of moving from cerner to epicore epic to

1520
00:53:22,079 --> 00:53:25,440
cerner

1521
00:53:22,800 --> 00:53:27,119
it's in millions so i would not be

1522
00:53:25,440 --> 00:53:29,520
surprised if they're lobbying against

1523
00:53:27,119 --> 00:53:30,960
open source emr or something or open

1524
00:53:29,520 --> 00:53:32,960
source recognition things like that

1525
00:53:30,960 --> 00:53:34,640
there are open source emrs that i'm not

1526
00:53:32,960 --> 00:53:37,119
seeing used a lot either

1527
00:53:34,640 --> 00:53:37,920
a lot of it has to be with support right

1528
00:53:37,119 --> 00:53:39,520
because

1529
00:53:37,920 --> 00:53:41,359
the healthcare organization needs

1530
00:53:39,520 --> 00:53:43,759
support for whatever tool

1531
00:53:41,359 --> 00:53:45,680
they're implementing and they want to

1532
00:53:43,760 --> 00:53:46,720
make sure that

1533
00:53:45,680 --> 00:53:49,839
they just don't feel comfortable with

1534
00:53:46,720 --> 00:53:49,839
open source because of that

1535
00:53:50,240 --> 00:53:56,000
okay and then you said

1536
00:53:53,440 --> 00:53:57,440
don't do webcam captures unless you want

1537
00:53:56,000 --> 00:53:59,520
to see something nasty

1538
00:53:57,440 --> 00:54:01,920
can you give a high level overview for

1539
00:53:59,520 --> 00:54:04,400
everybody about what you might want to

1540
00:54:01,920 --> 00:54:05,839
want to avoid oh what do i want to talk

1541
00:54:04,400 --> 00:54:07,760
about though that's the thing in there

1542
00:54:05,839 --> 00:54:11,599
um

1543
00:54:07,760 --> 00:54:13,280
once so organization um wanted webcam

1544
00:54:11,599 --> 00:54:15,839
shots because they want they were

1545
00:54:13,280 --> 00:54:17,359
the the person who hired us the security

1546
00:54:15,839 --> 00:54:20,480
organization was just

1547
00:54:17,359 --> 00:54:23,520
really being pushed against the corner

1548
00:54:20,480 --> 00:54:26,319
on the budgeting the cfo

1549
00:54:23,520 --> 00:54:28,880
and i'm kind of paraphrasing in here but

1550
00:54:26,319 --> 00:54:31,920
cfo said i have enough money to pay

1551
00:54:28,880 --> 00:54:34,960
hipaa breach fine i don't need

1552
00:54:31,920 --> 00:54:37,280
uh to worry about security that was the

1553
00:54:34,960 --> 00:54:39,359
business decision that the cfo had made

1554
00:54:37,280 --> 00:54:40,640
and the security team that hired us

1555
00:54:39,359 --> 00:54:42,078
wanted us to

1556
00:54:40,640 --> 00:54:44,640
prove that wrong they wanted us to

1557
00:54:42,079 --> 00:54:49,760
specifically get desktop screen shards

1558
00:54:44,640 --> 00:54:52,799
and get webcam screenshots of executive

1559
00:54:49,760 --> 00:54:55,280
leadership and board of directors

1560
00:54:52,799 --> 00:54:56,079
and in that we once we took some webcam

1561
00:54:55,280 --> 00:54:58,880
shots we saw

1562
00:54:56,079 --> 00:55:00,160
things that would look really good on a

1563
00:54:58,880 --> 00:55:02,400
tabloid

1564
00:55:00,160 --> 00:55:04,240
would not really look good on a pen test

1565
00:55:02,400 --> 00:55:07,520
report

1566
00:55:04,240 --> 00:55:08,160
another instance similar issue uh we

1567
00:55:07,520 --> 00:55:11,440
were asked

1568
00:55:08,160 --> 00:55:14,078
to do webcam screenshots and uh

1569
00:55:11,440 --> 00:55:15,599
one computer that we did not think

1570
00:55:14,079 --> 00:55:16,400
because they had some pretty good naming

1571
00:55:15,599 --> 00:55:18,240
scheme about

1572
00:55:16,400 --> 00:55:20,400
which computer is where we were avoiding

1573
00:55:18,240 --> 00:55:23,118
any computers in patient rooms

1574
00:55:20,400 --> 00:55:25,520
but we ended up taking a screenshot from

1575
00:55:23,119 --> 00:55:29,200
a computer in a patient room

1576
00:55:25,520 --> 00:55:32,400
that was not good to look at

1577
00:55:29,200 --> 00:55:33,279
reported that right away it was

1578
00:55:32,400 --> 00:55:35,520
it went through quite a bit of

1579
00:55:33,280 --> 00:55:38,799
investigation by compliance and whatnot

1580
00:55:35,520 --> 00:55:41,119
uh but both of those organizations uh

1581
00:55:38,799 --> 00:55:42,240
they they of course give more money to

1582
00:55:41,119 --> 00:55:45,760
security and whatnot

1583
00:55:42,240 --> 00:55:48,000
but they also uh weirdly

1584
00:55:45,760 --> 00:55:49,839
reissued everybody a laptop without a

1585
00:55:48,000 --> 00:55:51,760
webcam

1586
00:55:49,839 --> 00:55:53,119
which also seems kind of expensive but

1587
00:55:51,760 --> 00:55:56,319
you know

1588
00:55:53,119 --> 00:55:58,160
a good idea and uh

1589
00:55:56,319 --> 00:56:01,359
no epoxy would achieve the same thing

1590
00:55:58,160 --> 00:56:02,558
but might make the laptop hard to close

1591
00:56:01,359 --> 00:56:04,720
all right thanks a lot q we really

1592
00:56:02,559 --> 00:56:06,960
appreciate you presenting today

1593
00:56:04,720 --> 00:56:08,319
uh fascinating topic and i'm sure

1594
00:56:06,960 --> 00:56:10,079
there'll be some some questions in

1595
00:56:08,319 --> 00:56:12,079
discord if you want to

1596
00:56:10,079 --> 00:56:13,280
and then if you get a chance if and

1597
00:56:12,079 --> 00:56:15,359
you're willing to or

1598
00:56:13,280 --> 00:56:16,480
share your slides if you get them back

1599
00:56:15,359 --> 00:56:18,000
to the cfp

1600
00:56:16,480 --> 00:56:19,920
get them in the discord if you want and

1601
00:56:18,000 --> 00:56:20,559
then maybe back to the cfp so we can get

1602
00:56:19,920 --> 00:56:22,640
them

1603
00:56:20,559 --> 00:56:23,839
into the youtube when we share there

1604
00:56:22,640 --> 00:56:25,118
i'll do both i'll

1605
00:56:23,839 --> 00:56:26,960
drop the slides in there shortly and

1606
00:56:25,119 --> 00:56:27,839
discord and i'll email you guys in the

1607
00:56:26,960 --> 00:56:29,119
slides too

1608
00:56:27,839 --> 00:56:31,520
thank you for the opportunity thanks

1609
00:56:29,119 --> 00:56:33,839
everybody thank you sir

1610
00:56:31,520 --> 00:56:33,839
thank you

