1
00:00:02,820 --> 00:00:05,840
thank you so much

2
00:00:06,859 --> 00:00:09,300
uh thank you for sticking around to

3
00:00:09,300 --> 00:00:12,599
those of you that this afternoon uh my

4
00:00:12,599 --> 00:00:14,519
name is exona I'm really excited to be

5
00:00:14,519 --> 00:00:16,859
here this is my first time in kind of a

6
00:00:16,859 --> 00:00:19,560
security community in Kosovo

7
00:00:19,560 --> 00:00:21,600
um thank you to the organizers to all

8
00:00:21,600 --> 00:00:23,340
the speakers I really enjoyed the talks

9
00:00:23,340 --> 00:00:25,920
throughout the day uh so I I will be

10
00:00:25,920 --> 00:00:27,840
talking about how we're using automation

11
00:00:27,840 --> 00:00:31,320
to scale threat detection and response

12
00:00:31,320 --> 00:00:32,220
um

13
00:00:32,220 --> 00:00:34,440
this is kind of a rough agenda I'm going

14
00:00:34,440 --> 00:00:36,239
to talk a little bit about who I am and

15
00:00:36,239 --> 00:00:38,880
what I do uh we're gonna go through a

16
00:00:38,880 --> 00:00:41,399
review of what detection response really

17
00:00:41,399 --> 00:00:43,680
is uh I haven't heard so much about it

18
00:00:43,680 --> 00:00:45,960
today more so on the application side of

19
00:00:45,960 --> 00:00:48,960
vulnerability side so uh we'll go

20
00:00:48,960 --> 00:00:50,940
through a short overview and what that

21
00:00:50,940 --> 00:00:52,320
looks like then we're going to talk

22
00:00:52,320 --> 00:00:54,180
about why we even care about automation

23
00:00:54,180 --> 00:00:56,340
why does it matter

24
00:00:56,340 --> 00:00:57,960
um and then how we might be able to

25
00:00:57,960 --> 00:00:59,760
apply to different environments what

26
00:00:59,760 --> 00:01:01,440
that looks like the trade-offs around it

27
00:01:01,440 --> 00:01:04,199
and then some use case examples to kind

28
00:01:04,199 --> 00:01:06,600
of be more of a practical guide and how

29
00:01:06,600 --> 00:01:08,400
you might be able to incorporate it into

30
00:01:08,400 --> 00:01:10,560
your environment

31
00:01:10,560 --> 00:01:11,580
yeah

32
00:01:11,580 --> 00:01:13,560
so as mentioned before I'm a security

33
00:01:13,560 --> 00:01:15,600
engineer at meta or formerly known as

34
00:01:15,600 --> 00:01:17,700
Facebook I've been there for about five

35
00:01:17,700 --> 00:01:18,900
years

36
00:01:18,900 --> 00:01:20,759
um I studied in computer science at

37
00:01:20,759 --> 00:01:23,460
California State University uh East Bay

38
00:01:23,460 --> 00:01:25,439
so I've lived in the San Francisco Bay

39
00:01:25,439 --> 00:01:26,880
area for a while and then moved to

40
00:01:26,880 --> 00:01:28,380
London more recently I've been living

41
00:01:28,380 --> 00:01:30,720
there I'm really passionate about

42
00:01:30,720 --> 00:01:32,520
diversity and specifically women

43
00:01:32,520 --> 00:01:34,500
representation and infosec I've always

44
00:01:34,500 --> 00:01:36,060
been outnumbered and I'd like to change

45
00:01:36,060 --> 00:01:39,000
that and help as I can

46
00:01:39,000 --> 00:01:39,659
um

47
00:01:39,659 --> 00:01:42,000
I am involved in like women in cyber

48
00:01:42,000 --> 00:01:43,799
security organization or internally at

49
00:01:43,799 --> 00:01:45,960
the company an initiatives to build a

50
00:01:45,960 --> 00:01:48,299
community within that representation

51
00:01:48,299 --> 00:01:50,520
if I'm not working or in front of a

52
00:01:50,520 --> 00:01:52,520
computer I really enjoy being outside

53
00:01:52,520 --> 00:01:54,780
traveling spending time with my family

54
00:01:54,780 --> 00:01:57,420
I'm really passionate about well-being

55
00:01:57,420 --> 00:01:59,759
and health and like cooking healthy

56
00:01:59,759 --> 00:02:01,500
meals and things like that so

57
00:02:01,500 --> 00:02:04,439
now you know a little bit about me

58
00:02:04,439 --> 00:02:06,240
so let's talk about detection and

59
00:02:06,240 --> 00:02:09,360
response so basically what I do is I'm

60
00:02:09,360 --> 00:02:11,220
part of a team that responds to any

61
00:02:11,220 --> 00:02:14,220
malicious Insider or external threats to

62
00:02:14,220 --> 00:02:16,920
company data infrastructure Assets in

63
00:02:16,920 --> 00:02:19,260
general and what that looks like in

64
00:02:19,260 --> 00:02:21,540
terms of what we do specifically is kind

65
00:02:21,540 --> 00:02:25,020
of this life cycle so in order to find

66
00:02:25,020 --> 00:02:27,000
any Badness in the environment we

67
00:02:27,000 --> 00:02:29,040
basically have to get Telemetry or we

68
00:02:29,040 --> 00:02:31,319
have to ingest necessary data

69
00:02:31,319 --> 00:02:33,780
uh this might be I don't know network

70
00:02:33,780 --> 00:02:36,120
connections like DNS logs it might be

71
00:02:36,120 --> 00:02:37,980
things on the host like maybe you want

72
00:02:37,980 --> 00:02:41,340
to uh have EDR uh uh endpoint detection

73
00:02:41,340 --> 00:02:43,920
system that monitors and Aggregates data

74
00:02:43,920 --> 00:02:44,879
for you

75
00:02:44,879 --> 00:02:47,819
um so in order to do any kind of uh

76
00:02:47,819 --> 00:02:49,680
hunting or detecting or responding you

77
00:02:49,680 --> 00:02:50,879
want to make sure you have data that's

78
00:02:50,879 --> 00:02:53,519
actually reliably ingested uh you're not

79
00:02:53,519 --> 00:02:55,500
missing logs and stuff like that the

80
00:02:55,500 --> 00:02:58,080
next step is hunting around that data so

81
00:02:58,080 --> 00:02:59,760
basically you want to be proactive and

82
00:02:59,760 --> 00:03:01,379
not just wait for maybe a partner team

83
00:03:01,379 --> 00:03:02,940
to reach out and say oh there's a

84
00:03:02,940 --> 00:03:04,739
vulnerability and people are exploiting

85
00:03:04,739 --> 00:03:06,180
it you know nothing about and you

86
00:03:06,180 --> 00:03:07,860
actually have those kinds of servers and

87
00:03:07,860 --> 00:03:09,840
they're on patch and blah blah so you

88
00:03:09,840 --> 00:03:11,879
want to be proactive about identifying

89
00:03:11,879 --> 00:03:15,180
uh some ttps which stands for techniques

90
00:03:15,180 --> 00:03:17,580
uh tactics and procedures so basically

91
00:03:17,580 --> 00:03:20,700
uh open source or threatened threat

92
00:03:20,700 --> 00:03:22,680
intelligence in general about threat

93
00:03:22,680 --> 00:03:24,840
actors and uh or indicators of

94
00:03:24,840 --> 00:03:27,720
compromise that you might look for or

95
00:03:27,720 --> 00:03:29,640
just in general understanding your

96
00:03:29,640 --> 00:03:32,159
environment so what kind of machines you

97
00:03:32,159 --> 00:03:34,319
have running what types of servers what

98
00:03:34,319 --> 00:03:35,940
might anomalous look like in that

99
00:03:35,940 --> 00:03:38,640
environment and that can get really

100
00:03:38,640 --> 00:03:40,680
detailed and in depth but this is just

101
00:03:40,680 --> 00:03:42,540
in general what we identify as hunting

102
00:03:42,540 --> 00:03:46,680
once you have actually understood what

103
00:03:46,680 --> 00:03:48,659
your environment looks like what Badness

104
00:03:48,659 --> 00:03:50,519
looks like maybe you are feeding in

105
00:03:50,519 --> 00:03:52,200
threat intelligence and you're able to

106
00:03:52,200 --> 00:03:54,780
look against that we go to detection

107
00:03:54,780 --> 00:03:57,060
where you basically have some sort of

108
00:03:57,060 --> 00:03:58,860
detection engineering framework or

109
00:03:58,860 --> 00:04:03,180
whatever your company has to actually

110
00:04:03,180 --> 00:04:06,060
write a query or run some type of syntax

111
00:04:06,060 --> 00:04:08,340
logic to identify that event when it

112
00:04:08,340 --> 00:04:10,860
happens and trigger an alert for review

113
00:04:10,860 --> 00:04:12,439
for someone

114
00:04:12,439 --> 00:04:14,640
at that stage you would be in the

115
00:04:14,640 --> 00:04:18,060
response team and so in this part of the

116
00:04:18,060 --> 00:04:20,220
life cycle is basically where you grab

117
00:04:20,220 --> 00:04:22,079
that alert most likely someone an

118
00:04:22,079 --> 00:04:24,419
investigator or analyst is going to grab

119
00:04:24,419 --> 00:04:27,060
it and look at it and try to identify is

120
00:04:27,060 --> 00:04:29,340
it actually Badness indeed or maybe

121
00:04:29,340 --> 00:04:30,900
something happen and it's actually a

122
00:04:30,900 --> 00:04:33,780
false positive so a lot of manual

123
00:04:33,780 --> 00:04:35,220
analysis

124
00:04:35,220 --> 00:04:36,060
um

125
00:04:36,060 --> 00:04:38,520
and investigations to try and correlate

126
00:04:38,520 --> 00:04:40,259
information understand what actually

127
00:04:40,259 --> 00:04:42,300
happened because the event that was

128
00:04:42,300 --> 00:04:43,680
flagged is quite limiting you can't

129
00:04:43,680 --> 00:04:45,240
really make a lot of sense out of just

130
00:04:45,240 --> 00:04:48,120
maybe a single line of you know a log

131
00:04:48,120 --> 00:04:50,780
detail like a file event or something

132
00:04:50,780 --> 00:04:53,580
so this might look different depending

133
00:04:53,580 --> 00:04:55,800
on the organization like if you're a

134
00:04:55,800 --> 00:04:58,500
very small uh company you might

135
00:04:58,500 --> 00:05:00,360
Outsource some of this like maybe you

136
00:05:00,360 --> 00:05:02,520
you have a sock or like you hand off

137
00:05:02,520 --> 00:05:04,080
actually investigating the alerts and

138
00:05:04,080 --> 00:05:05,280
you only get

139
00:05:05,280 --> 00:05:08,400
reached out to if if they determine that

140
00:05:08,400 --> 00:05:11,280
it's something bad or maybe you know you

141
00:05:11,280 --> 00:05:12,000
have

142
00:05:12,000 --> 00:05:13,620
like I just want to point out that this

143
00:05:13,620 --> 00:05:15,600
might look different I'm this is just

144
00:05:15,600 --> 00:05:17,340
what I'm used to working at a bigger

145
00:05:17,340 --> 00:05:19,380
company

146
00:05:19,380 --> 00:05:22,440
so if we incorporate automation this is

147
00:05:22,440 --> 00:05:24,120
what it might look like

148
00:05:24,120 --> 00:05:25,919
and as mentioned before it's not like

149
00:05:25,919 --> 00:05:28,320
conclusive this is just my Approach

150
00:05:28,320 --> 00:05:32,400
um so after you detect basically and if

151
00:05:32,400 --> 00:05:35,160
an event is flagged that uh something

152
00:05:35,160 --> 00:05:36,780
bad happened maybe you have a

153
00:05:36,780 --> 00:05:39,900
compromised host I don't know uh this is

154
00:05:39,900 --> 00:05:42,240
the point where ideally you should have

155
00:05:42,240 --> 00:05:44,340
uh some type of automation framework

156
00:05:44,340 --> 00:05:46,259
Incorporated that picks up that alert

157
00:05:46,259 --> 00:05:47,820
and tries to do things automatically

158
00:05:47,820 --> 00:05:51,300
before it's even up for manual review

159
00:05:51,300 --> 00:05:54,780
for an investigator and engineer so this

160
00:05:54,780 --> 00:05:57,600
might be data aggregation uh checks

161
00:05:57,600 --> 00:06:00,000
against Intel or performing common steps

162
00:06:00,000 --> 00:06:03,180
that are manual otherwise and those can

163
00:06:03,180 --> 00:06:05,699
either be generated through uh kind of

164
00:06:05,699 --> 00:06:07,320
retroactive analysis of your

165
00:06:07,320 --> 00:06:09,360
investigations in the past so you can

166
00:06:09,360 --> 00:06:11,340
see that a lot of people are performing

167
00:06:11,340 --> 00:06:14,940
X activity or like uh action and you're

168
00:06:14,940 --> 00:06:18,419
able to actually automate that

169
00:06:18,419 --> 00:06:19,860
her

170
00:06:19,860 --> 00:06:21,960
the last step here that I added I just

171
00:06:21,960 --> 00:06:25,139
want to point out that uh ideally you

172
00:06:25,139 --> 00:06:26,759
have a feedback loop for all of the

173
00:06:26,759 --> 00:06:29,880
other components of your cycle and the

174
00:06:29,880 --> 00:06:32,160
post-mortem phase is kind of where you

175
00:06:32,160 --> 00:06:33,960
should be able to go back to your

176
00:06:33,960 --> 00:06:35,460
Automation and say actually you could

177
00:06:35,460 --> 00:06:37,259
have done better than you did and that's

178
00:06:37,259 --> 00:06:39,240
what we want we want to be able to Once

179
00:06:39,240 --> 00:06:41,580
something is uh

180
00:06:41,580 --> 00:06:43,979
stood up for manual review for an

181
00:06:43,979 --> 00:06:45,900
investigator engineer they're able to

182
00:06:45,900 --> 00:06:48,960
then have some sort of feedback loop

183
00:06:48,960 --> 00:06:50,280
that either goes to detection or

184
00:06:50,280 --> 00:06:51,960
automation depending on like what the

185
00:06:51,960 --> 00:06:54,479
limitations were

186
00:06:54,479 --> 00:06:57,300
so the next step is kind of why should I

187
00:06:57,300 --> 00:06:59,340
invest in automation during my time so

188
00:06:59,340 --> 00:07:01,139
far in my career I have gotten the

189
00:07:01,139 --> 00:07:03,780
chance to focus on different sub areas

190
00:07:03,780 --> 00:07:05,819
of detection and response and I have

191
00:07:05,819 --> 00:07:07,919
focused on automation a lot and I have

192
00:07:07,919 --> 00:07:09,660
had the opportunity to think about

193
00:07:09,660 --> 00:07:12,120
trade-offs here

194
00:07:12,120 --> 00:07:14,400
one of the things

195
00:07:14,400 --> 00:07:16,740
uh sometimes my job is really exciting

196
00:07:16,740 --> 00:07:18,720
other times it's a bit boring and

197
00:07:18,720 --> 00:07:21,539
basically I want to be able to automate

198
00:07:21,539 --> 00:07:23,340
more of the boring stuff so I can do

199
00:07:23,340 --> 00:07:26,039
more exciting stuff and so if I have to

200
00:07:26,039 --> 00:07:27,919
investigate an alert over and over again

201
00:07:27,919 --> 00:07:31,259
uh I don't really want to do it and so

202
00:07:31,259 --> 00:07:33,060
if it's a boring task and it's kind of

203
00:07:33,060 --> 00:07:34,680
mundane and I don't want to do it then

204
00:07:34,680 --> 00:07:37,139
I'd rather have automation to it manual

205
00:07:37,139 --> 00:07:39,840
work is not really efficient so over

206
00:07:39,840 --> 00:07:41,340
time you're not going to be able to

207
00:07:41,340 --> 00:07:42,900
scale maybe I don't know hundreds of

208
00:07:42,900 --> 00:07:44,400
alerts per day

209
00:07:44,400 --> 00:07:46,680
um so having to manually go through

210
00:07:46,680 --> 00:07:49,500
queries it's uh it's quite inefficient

211
00:07:49,500 --> 00:07:52,380
with that comes load management so for

212
00:07:52,380 --> 00:07:54,000
example you're gonna have to hire more

213
00:07:54,000 --> 00:07:56,580
people to review things manually rather

214
00:07:56,580 --> 00:07:58,080
than investing maybe an engineer to

215
00:07:58,080 --> 00:08:01,199
automate some of those things away

216
00:08:01,199 --> 00:08:03,419
The Next Step directly related is

217
00:08:03,419 --> 00:08:05,639
indirect false negative reduction just

218
00:08:05,639 --> 00:08:09,479
because with a lot of uh a lot of manual

219
00:08:09,479 --> 00:08:11,340
review of the same things a lot of

220
00:08:11,340 --> 00:08:13,080
people run into what it's called alert

221
00:08:13,080 --> 00:08:15,240
fatigue and basically you're looking at

222
00:08:15,240 --> 00:08:18,300
things all day uh and maybe you're so

223
00:08:18,300 --> 00:08:20,400
used to seeing this always is ah this is

224
00:08:20,400 --> 00:08:21,960
always a false positive and you close it

225
00:08:21,960 --> 00:08:24,840
out but it was actually a true positive

226
00:08:24,840 --> 00:08:27,240
and thus has led to a false negative

227
00:08:27,240 --> 00:08:29,280
which means it was malicious and missed

228
00:08:29,280 --> 00:08:32,339
which happens all the time and also can

229
00:08:32,339 --> 00:08:34,740
lead to bigger scale incidents for a

230
00:08:34,740 --> 00:08:37,559
company a smaller margin of human error

231
00:08:37,559 --> 00:08:40,080
basically what I mean by this is if you

232
00:08:40,080 --> 00:08:42,839
as a person go and run I don't know SQL

233
00:08:42,839 --> 00:08:44,760
or whatever wherever however you do your

234
00:08:44,760 --> 00:08:47,339
investigations and run analysis you as a

235
00:08:47,339 --> 00:08:49,080
human are more prone to maybe missing

236
00:08:49,080 --> 00:08:51,480
uppercase lowercase or like missing I

237
00:08:51,480 --> 00:08:53,519
don't know uh the extension or whatever

238
00:08:53,519 --> 00:08:55,800
it may be and so if you're proactive

239
00:08:55,800 --> 00:08:59,220
about having automatic queries run that

240
00:08:59,220 --> 00:09:01,620
a person can just click and it's gonna

241
00:09:01,620 --> 00:09:04,860
run for you you're going to reduce you

242
00:09:04,860 --> 00:09:07,080
know the margin of error there

243
00:09:07,080 --> 00:09:08,700
over time

244
00:09:08,700 --> 00:09:11,580
because you've invested proactively in

245
00:09:11,580 --> 00:09:14,580
automation uh you're going to be able to

246
00:09:14,580 --> 00:09:17,880
see impact that will allow you to

247
00:09:17,880 --> 00:09:19,980
actually invest resources in other maybe

248
00:09:19,980 --> 00:09:22,620
high priority things such as onboarding

249
00:09:22,620 --> 00:09:24,839
maybe new signal into a new

250
00:09:24,839 --> 00:09:26,220
infrastructure of the company that you

251
00:09:26,220 --> 00:09:29,760
haven't really touched before so

252
00:09:29,760 --> 00:09:32,519
with that with less of the mundane and

253
00:09:32,519 --> 00:09:34,980
kind of boring tasks because truthfully

254
00:09:34,980 --> 00:09:37,019
there isn't always just exciting things

255
00:09:37,019 --> 00:09:38,040
to do

256
00:09:38,040 --> 00:09:39,660
sometimes you're gonna have to deal with

257
00:09:39,660 --> 00:09:42,000
like low Fidelity low Fidelity rules

258
00:09:42,000 --> 00:09:44,279
that are very false positive prone

259
00:09:44,279 --> 00:09:46,200
and last but not least and this is not

260
00:09:46,200 --> 00:09:47,820
an exhaustive list this is just things

261
00:09:47,820 --> 00:09:49,399
that you know I think are quite common

262
00:09:49,399 --> 00:09:53,100
uh is detection limitations so sometimes

263
00:09:53,100 --> 00:09:54,839
actually during the detection phase that

264
00:09:54,839 --> 00:09:56,399
I talked about in the life cycle it's

265
00:09:56,399 --> 00:09:58,440
limiting you're not able to correlate a

266
00:09:58,440 --> 00:10:00,060
lot of events to actually identify if

267
00:10:00,060 --> 00:10:02,040
something bad happened so for example a

268
00:10:02,040 --> 00:10:04,140
parent process maybe you know three

269
00:10:04,140 --> 00:10:06,240
steps down spawn the process it's quite

270
00:10:06,240 --> 00:10:09,000
unusual you're not able to upfront maybe

271
00:10:09,000 --> 00:10:11,399
because limitations of most detection

272
00:10:11,399 --> 00:10:13,920
engineering Frameworks uh

273
00:10:13,920 --> 00:10:16,620
have kind of limitations in how how much

274
00:10:16,620 --> 00:10:18,959
how dense of a logic you can run and so

275
00:10:18,959 --> 00:10:21,420
you can use automation to actually you

276
00:10:21,420 --> 00:10:22,680
know uh

277
00:10:22,680 --> 00:10:25,860
sift through things easier once an alert

278
00:10:25,860 --> 00:10:28,440
is escalated uh from like a basic

279
00:10:28,440 --> 00:10:31,260
heuristic basically

280
00:10:31,260 --> 00:10:33,480
so how do I incorporate Automation in my

281
00:10:33,480 --> 00:10:34,980
life cycle

282
00:10:34,980 --> 00:10:38,459
as I mentioned uh I'm used to kind of a

283
00:10:38,459 --> 00:10:40,500
bigger Scale Company where things are

284
00:10:40,500 --> 00:10:43,019
made uh accustomed to the environment

285
00:10:43,019 --> 00:10:45,420
more often than not so I'm not really

286
00:10:45,420 --> 00:10:47,339
familiar with a lot of tools out there

287
00:10:47,339 --> 00:10:49,380
but I know that for example Jupiter

288
00:10:49,380 --> 00:10:51,480
notebooks are quite commonly used in the

289
00:10:51,480 --> 00:10:52,620
industry

290
00:10:52,620 --> 00:10:55,019
um for this type of purpose uh

291
00:10:55,019 --> 00:10:56,940
commercial commercial tooling are also

292
00:10:56,940 --> 00:10:58,920
available uh so a lot of times if you

293
00:10:58,920 --> 00:11:00,600
buy EBR or you have a seam or something

294
00:11:00,600 --> 00:11:03,300
like that they will have accompanying

295
00:11:03,300 --> 00:11:05,760
tooling or like things you can add on to

296
00:11:05,760 --> 00:11:07,880
fit your needs in terms of this concept

297
00:11:07,880 --> 00:11:10,620
and then also like if you can influence

298
00:11:10,620 --> 00:11:13,560
for example partner team themes or being

299
00:11:13,560 --> 00:11:15,420
able to hire maybe more of a software

300
00:11:15,420 --> 00:11:17,160
engineering background folks to actually

301
00:11:17,160 --> 00:11:19,160
build these tools on top of things

302
00:11:19,160 --> 00:11:21,600
that's also possible and that's what I'm

303
00:11:21,600 --> 00:11:24,180
used to most of the time

304
00:11:24,180 --> 00:11:26,339
even though I talked a lot about all the

305
00:11:26,339 --> 00:11:28,260
good things about automation because I'm

306
00:11:28,260 --> 00:11:30,060
a fan of it there are trade-offs to

307
00:11:30,060 --> 00:11:31,640
consider and it's not always the answer

308
00:11:31,640 --> 00:11:34,440
so you have to think about what works

309
00:11:34,440 --> 00:11:36,180
for you so if you're kind of more on

310
00:11:36,180 --> 00:11:38,420
like the starting to build your program

311
00:11:38,420 --> 00:11:40,980
and you don't have a lot of resources

312
00:11:40,980 --> 00:11:42,720
and you likely want to invest you know

313
00:11:42,720 --> 00:11:44,700
your costs and capacity into actually

314
00:11:44,700 --> 00:11:47,640
having data and aggregating logs and you

315
00:11:47,640 --> 00:11:49,560
know maybe a formatted way and clean way

316
00:11:49,560 --> 00:11:51,420
that's probably where you should invest

317
00:11:51,420 --> 00:11:54,540
your resources however I think if you

318
00:11:54,540 --> 00:11:58,620
are more on like balancing out uh how

319
00:11:58,620 --> 00:12:00,959
how all all the things work out and

320
00:12:00,959 --> 00:12:02,459
you're at a place where you know you

321
00:12:02,459 --> 00:12:04,260
have the capacity to onboard new

322
00:12:04,260 --> 00:12:07,200
technology then I would vouch for it you

323
00:12:07,200 --> 00:12:08,339
should think about

324
00:12:08,339 --> 00:12:11,279
frequency of you know actions performed

325
00:12:11,279 --> 00:12:12,660
like you don't really want to automate

326
00:12:12,660 --> 00:12:15,720
something that you run maybe or do once

327
00:12:15,720 --> 00:12:17,220
a month and it only takes 10 minutes

328
00:12:17,220 --> 00:12:19,380
because the reward is not that great so

329
00:12:19,380 --> 00:12:21,480
the impact is not that great so having

330
00:12:21,480 --> 00:12:25,200
these considerations uh over like

331
00:12:25,200 --> 00:12:27,300
ahead of time there will be some

332
00:12:27,300 --> 00:12:29,820
maintenance overhead uh you know the

333
00:12:29,820 --> 00:12:31,920
code that actually automation runs on

334
00:12:31,920 --> 00:12:33,540
needs to be maintained and things like

335
00:12:33,540 --> 00:12:36,660
that so just uh wanted to call out that

336
00:12:36,660 --> 00:12:38,579
there is also negative things that we

337
00:12:38,579 --> 00:12:41,279
should consider about it

338
00:12:41,279 --> 00:12:44,880
with that we're at the use case examples

339
00:12:44,880 --> 00:12:46,139
um

340
00:12:46,139 --> 00:12:49,200
I wanted to talk about phishing because

341
00:12:49,200 --> 00:12:52,260
it's one of the most uh

342
00:12:52,260 --> 00:12:54,660
you know talked about prevalent things

343
00:12:54,660 --> 00:12:56,459
that happen in the real world and we

344
00:12:56,459 --> 00:12:59,279
know that it's kind of very it's one of

345
00:12:59,279 --> 00:13:01,500
the most common infection initial

346
00:13:01,500 --> 00:13:03,839
infection vectors used even by threat

347
00:13:03,839 --> 00:13:06,660
actors and but they are very false

348
00:13:06,660 --> 00:13:08,279
positive prone and it's really difficult

349
00:13:08,279 --> 00:13:09,360
to like

350
00:13:09,360 --> 00:13:12,540
for them to be you know meaningful

351
00:13:12,540 --> 00:13:16,079
sometimes and can get boring so uh in

352
00:13:16,079 --> 00:13:17,820
this case what we want to do basically

353
00:13:17,820 --> 00:13:19,980
think of the Playbook

354
00:13:19,980 --> 00:13:22,200
basically documentation you have for an

355
00:13:22,200 --> 00:13:23,760
engineer or like a Playbook on like this

356
00:13:23,760 --> 00:13:25,680
is how you should investigate this how

357
00:13:25,680 --> 00:13:28,200
can you write that into code basically

358
00:13:28,200 --> 00:13:30,240
how can you script that

359
00:13:30,240 --> 00:13:33,060
um and think about things that you Ma

360
00:13:33,060 --> 00:13:35,160
very likely will need in in order to

361
00:13:35,160 --> 00:13:36,720
investigate this type of alert so for

362
00:13:36,720 --> 00:13:38,100
example highly likely that you're gonna

363
00:13:38,100 --> 00:13:40,320
need the email contents the email

364
00:13:40,320 --> 00:13:43,320
headers send their information if it

365
00:13:43,320 --> 00:13:46,380
contained kind of interactive content

366
00:13:46,380 --> 00:13:48,839
such as maybe URLs or attachments or

367
00:13:48,839 --> 00:13:50,279
other things

368
00:13:50,279 --> 00:13:52,560
um if it's not so much like social

369
00:13:52,560 --> 00:13:54,420
engineering type fishing where they want

370
00:13:54,420 --> 00:13:56,459
you to call them back and whatnot but

371
00:13:56,459 --> 00:13:58,620
more so like a malicious email with

372
00:13:58,620 --> 00:14:01,079
content you're probably likely going to

373
00:14:01,079 --> 00:14:02,459
want to prefetch kind of information

374
00:14:02,459 --> 00:14:04,680
that shows if a user interacted with it

375
00:14:04,680 --> 00:14:06,660
do they click those links can you see

376
00:14:06,660 --> 00:14:09,360
that in your uh Network logs was

377
00:14:09,360 --> 00:14:12,180
anything downloaded what happened things

378
00:14:12,180 --> 00:14:15,540
like that and then probably likely if

379
00:14:15,540 --> 00:14:18,060
you have an infection is ways to

380
00:14:18,060 --> 00:14:22,279
remediate that inbox or the user and so

381
00:14:22,279 --> 00:14:24,839
the way I have listed these things is

382
00:14:24,839 --> 00:14:27,720
that for example you you can very likely

383
00:14:27,720 --> 00:14:29,940
automate the highly likely stuff you can

384
00:14:29,940 --> 00:14:31,500
prefetch all that information for

385
00:14:31,500 --> 00:14:33,600
someone to review and in case instead of

386
00:14:33,600 --> 00:14:37,339
them going to run these queries manually

387
00:14:37,339 --> 00:14:39,480
they will already be there and probably

388
00:14:39,480 --> 00:14:40,980
will take them to the three minutes to

389
00:14:40,980 --> 00:14:42,480
actually analyze that if there's

390
00:14:42,480 --> 00:14:43,800
anything that stands out in email

391
00:14:43,800 --> 00:14:46,019
headers security professional you're

392
00:14:46,019 --> 00:14:46,980
probably going to see that right away

393
00:14:46,980 --> 00:14:48,660
instead of spending time to actually go

394
00:14:48,660 --> 00:14:51,959
do that if you're unable to automate the

395
00:14:51,959 --> 00:14:54,019
rest of the process so actually

396
00:14:54,019 --> 00:14:56,699
determining if it's bad but basically

397
00:14:56,699 --> 00:14:59,220
pre-fetching information

398
00:14:59,220 --> 00:15:02,100
so in this case I just wanted to show

399
00:15:02,100 --> 00:15:04,740
a case that might be fully automated

400
00:15:04,740 --> 00:15:06,779
um there are other things that you might

401
00:15:06,779 --> 00:15:08,820
check but this is just some of the

402
00:15:08,820 --> 00:15:10,680
checks you might do

403
00:15:10,680 --> 00:15:12,360
so basically you want to check if an

404
00:15:12,360 --> 00:15:14,339
email is indeed malicious I don't know

405
00:15:14,339 --> 00:15:17,300
if I can use this oh

406
00:15:20,639 --> 00:15:23,160
okay so you want to check if the email

407
00:15:23,160 --> 00:15:25,620
is indeed malicious and maybe some of

408
00:15:25,620 --> 00:15:27,779
the checks you would do is check if the

409
00:15:27,779 --> 00:15:30,000
email is unexpected unexpected the

410
00:15:30,000 --> 00:15:32,339
sender is uncommon headers look off like

411
00:15:32,339 --> 00:15:34,500
maybe you know send their addresses

412
00:15:34,500 --> 00:15:37,620
don't match SPF is off whatever uh it's

413
00:15:37,620 --> 00:15:40,079
trying to impersonate someone maybe uh

414
00:15:40,079 --> 00:15:41,760
that you actually communicate with but

415
00:15:41,760 --> 00:15:44,040
this looks slightly different the the

416
00:15:44,040 --> 00:15:46,920
email has interactive content and maybe

417
00:15:46,920 --> 00:15:49,500
you have kind of automated analysis in

418
00:15:49,500 --> 00:15:51,600
place so oftentimes companies will have

419
00:15:51,600 --> 00:15:54,060
Dynamic analysis available and you can

420
00:15:54,060 --> 00:15:56,760
submit something for it to be run in a

421
00:15:56,760 --> 00:15:58,440
sandbox or something like that and if

422
00:15:58,440 --> 00:16:00,000
you're able to automate that step

423
00:16:00,000 --> 00:16:01,320
basically it will come back with

424
00:16:01,320 --> 00:16:02,760
something saying whether it was

425
00:16:02,760 --> 00:16:04,980
credential harvesting or not

426
00:16:04,980 --> 00:16:07,500
or otherwise interesting

427
00:16:07,500 --> 00:16:09,720
um the other step is around if actually

428
00:16:09,720 --> 00:16:11,339
someone interacted with it because let's

429
00:16:11,339 --> 00:16:13,320
say we have a malicious email but nobody

430
00:16:13,320 --> 00:16:14,880
did anything with it we don't really

431
00:16:14,880 --> 00:16:18,240
care other than maybe adding those iocs

432
00:16:18,240 --> 00:16:20,220
to some sort of tracking if you do that

433
00:16:20,220 --> 00:16:22,139
or some sort of block listing or

434
00:16:22,139 --> 00:16:24,420
otherwise known as the blacklisting uh

435
00:16:24,420 --> 00:16:27,540
if you do that so in the end if you have

436
00:16:27,540 --> 00:16:29,519
for example it looks suspicious

437
00:16:29,519 --> 00:16:31,500
something is off with the email

438
00:16:31,500 --> 00:16:34,860
our automated analysis shows that it's

439
00:16:34,860 --> 00:16:37,019
actually bad and no one interacted with

440
00:16:37,019 --> 00:16:38,880
it then we can just run mediation and

441
00:16:38,880 --> 00:16:40,620
remediations actions such as for example

442
00:16:40,620 --> 00:16:42,660
deleting the email

443
00:16:42,660 --> 00:16:46,259
adding iocs so for example domains uh to

444
00:16:46,259 --> 00:16:48,480
block listing or tracking or if you do

445
00:16:48,480 --> 00:16:49,980
thread and build tracking of some sort

446
00:16:49,980 --> 00:16:51,959
and then close the case as true positive

447
00:16:51,959 --> 00:16:54,420
because it was indeed malicious even

448
00:16:54,420 --> 00:16:58,160
though it did not lead to compromise

449
00:16:58,500 --> 00:17:00,540
the other case I wanted to talk about is

450
00:17:00,540 --> 00:17:02,820
malware because it's also very prevalent

451
00:17:02,820 --> 00:17:04,679
like if you work in an inside in any

452
00:17:04,679 --> 00:17:06,720
type of search team and you're

453
00:17:06,720 --> 00:17:09,660
responsible for a company's assets such

454
00:17:09,660 --> 00:17:12,000
as user laptops you're probably going to

455
00:17:12,000 --> 00:17:13,679
run into a lot of commodity malware

456
00:17:13,679 --> 00:17:16,319
adware and general unwanted software

457
00:17:16,319 --> 00:17:17,939
like pops

458
00:17:17,939 --> 00:17:20,819
um it's gonna get quite quickly

459
00:17:20,819 --> 00:17:23,640
depending on the size of your company a

460
00:17:23,640 --> 00:17:25,799
big volume of alerts and basically in

461
00:17:25,799 --> 00:17:27,359
this case you again want to think about

462
00:17:27,359 --> 00:17:29,820
how you can codify your workflow or the

463
00:17:29,820 --> 00:17:32,760
Playbook that you work with so being

464
00:17:32,760 --> 00:17:35,520
able to flag any type of event uh

465
00:17:35,520 --> 00:17:39,539
proactively at uh before the time of of

466
00:17:39,539 --> 00:17:41,220
alert is raised for manual review and

467
00:17:41,220 --> 00:17:43,320
this might include how prevalent is this

468
00:17:43,320 --> 00:17:45,840
event in your environment what does

469
00:17:45,840 --> 00:17:47,460
anomalous look like more on the host

470
00:17:47,460 --> 00:17:50,340
than maybe the network depending on you

471
00:17:50,340 --> 00:17:52,080
know your environment you might want to

472
00:17:52,080 --> 00:17:53,820
grab suspicious events during the time

473
00:17:53,820 --> 00:17:55,980
that are related to downloads or network

474
00:17:55,980 --> 00:17:58,980
connections again maybe you have Dynamic

475
00:17:58,980 --> 00:18:01,679
analysis for binaries in place and you

476
00:18:01,679 --> 00:18:03,419
can leverage that or maybe you can vouch

477
00:18:03,419 --> 00:18:06,200
for that to be implemented in the future

478
00:18:06,200 --> 00:18:08,720
maybe you know you're flagging against

479
00:18:08,720 --> 00:18:12,299
hashes matched with uh you know things

480
00:18:12,299 --> 00:18:14,280
marked bad in VT but it's actually

481
00:18:14,280 --> 00:18:16,620
outdated indicators and you want to

482
00:18:16,620 --> 00:18:18,360
improve that but you don't necessarily

483
00:18:18,360 --> 00:18:21,559
you want to put it in your thread Intel

484
00:18:21,559 --> 00:18:25,320
uh place where maybe you're gonna get a

485
00:18:25,320 --> 00:18:27,360
big pile of indicators you can't really

486
00:18:27,360 --> 00:18:29,880
manage to update regularly so you might

487
00:18:29,880 --> 00:18:31,860
be able to use automation that gets more

488
00:18:31,860 --> 00:18:34,380
reviewed and tested over time to allow

489
00:18:34,380 --> 00:18:37,500
lists to some extent so there is a lot

490
00:18:37,500 --> 00:18:38,460
of

491
00:18:38,460 --> 00:18:39,120
um

492
00:18:39,120 --> 00:18:42,299
things you could do this is just kind of

493
00:18:42,299 --> 00:18:44,820
some things to think about and then in

494
00:18:44,820 --> 00:18:46,740
case of a true positive maybe instead of

495
00:18:46,740 --> 00:18:48,780
because not everything is automatable

496
00:18:48,780 --> 00:18:50,160
and we don't necessarily want to

497
00:18:50,160 --> 00:18:51,600
automate things because you need to

498
00:18:51,600 --> 00:18:54,120
scope an incident out you can't just oh

499
00:18:54,120 --> 00:18:56,299
remove that binary and close it out

500
00:18:56,299 --> 00:18:58,260
instead maybe you can leverage

501
00:18:58,260 --> 00:19:00,179
automation to prefetch these

502
00:19:00,179 --> 00:19:02,400
informations so points and analyst or

503
00:19:02,400 --> 00:19:04,320
investigator in the right way to like

504
00:19:04,320 --> 00:19:06,059
okay you actually need to contain this

505
00:19:06,059 --> 00:19:07,679
incident what does that look like maybe

506
00:19:07,679 --> 00:19:09,720
you want to isolate the host maybe you

507
00:19:09,720 --> 00:19:11,100
want to quarantine the file only

508
00:19:11,100 --> 00:19:14,940
whatever so leveraging that in any way

509
00:19:14,940 --> 00:19:18,620
to save time basically

510
00:19:19,799 --> 00:19:22,559
so the recap to everything I talked

511
00:19:22,559 --> 00:19:24,840
about is that in my opinion automation

512
00:19:24,840 --> 00:19:27,900
is quite crucial especially to scale uh

513
00:19:27,900 --> 00:19:30,000
an environment at least you should try

514
00:19:30,000 --> 00:19:31,740
to incorporate it as you're building out

515
00:19:31,740 --> 00:19:34,160
your program uh and whatever however

516
00:19:34,160 --> 00:19:37,440
your environment looks like there are

517
00:19:37,440 --> 00:19:39,059
pros and cons to consider and there's

518
00:19:39,059 --> 00:19:41,460
not everything will be automatable so

519
00:19:41,460 --> 00:19:43,260
there is still a lot of Need for human

520
00:19:43,260 --> 00:19:45,360
expertise when doing it especially

521
00:19:45,360 --> 00:19:47,460
incident response or once something is

522
00:19:47,460 --> 00:19:49,380
bad and figuring out to what extent and

523
00:19:49,380 --> 00:19:52,340
like how to remediate and contain that

524
00:19:52,340 --> 00:19:54,480
and with that thank you so much for

525
00:19:54,480 --> 00:19:57,799
listening I know it's quite late

526
00:19:58,260 --> 00:20:00,660
thank you that was great thanks so much

527
00:20:00,660 --> 00:20:04,520
does anybody have any question

528
00:20:07,380 --> 00:20:10,340
Maria

529
00:20:13,100 --> 00:20:15,539
I mean first of all thank you so it was

530
00:20:15,539 --> 00:20:16,980
really interesting talk especially

531
00:20:16,980 --> 00:20:20,179
seeing it from my other perspective

532
00:20:20,179 --> 00:20:22,380
basically I just wanted to ask because

533
00:20:22,380 --> 00:20:24,360
you mentioned automation a lot is there

534
00:20:24,360 --> 00:20:27,120
like any cases where like automation has

535
00:20:27,120 --> 00:20:30,000
actually like fired back because for

536
00:20:30,000 --> 00:20:33,240
example like you automated something and

537
00:20:33,240 --> 00:20:35,640
um like it happened that actually this

538
00:20:35,640 --> 00:20:37,620
was not a false positive for example or

539
00:20:37,620 --> 00:20:39,720
something similar yeah

540
00:20:39,720 --> 00:20:41,580
definitely and that's why I say not

541
00:20:41,580 --> 00:20:43,140
everything is automatable and it's to

542
00:20:43,140 --> 00:20:45,799
some extent so I I will share a case

543
00:20:45,799 --> 00:20:49,080
where uh just going back to the fishing

544
00:20:49,080 --> 00:20:50,720
and like maybe the limitations with that

545
00:20:50,720 --> 00:20:54,179
you you could have automation check

546
00:20:54,179 --> 00:20:56,820
whether there was any interactive

547
00:20:56,820 --> 00:20:59,160
content in the email or if it was just

548
00:20:59,160 --> 00:21:01,799
uh kind of like plain text not really

549
00:21:01,799 --> 00:21:03,419
interesting it was more of the social

550
00:21:03,419 --> 00:21:06,059
engineering side and then our automation

551
00:21:06,059 --> 00:21:07,919
thought okay it's fine the person didn't

552
00:21:07,919 --> 00:21:10,380
respond so we can just close it out and

553
00:21:10,380 --> 00:21:12,120
there wasn't anything flag malicious so

554
00:21:12,120 --> 00:21:14,640
we didn't delete it but then the users

555
00:21:14,640 --> 00:21:18,360
saw it later and responded and then fell

556
00:21:18,360 --> 00:21:20,400
for a social engineering attempt so

557
00:21:20,400 --> 00:21:22,500
there is clearly limitations but there

558
00:21:22,500 --> 00:21:24,539
is a lot of benefit in terms of time

559
00:21:24,539 --> 00:21:27,600
saved that that leads to other impact

560
00:21:27,600 --> 00:21:29,220
welcome

561
00:21:29,220 --> 00:21:32,340
I have another question okay

562
00:21:32,340 --> 00:21:36,240
is it automation done like and like is

563
00:21:36,240 --> 00:21:39,419
it centralized or you as a responders

564
00:21:39,419 --> 00:21:42,360
when you like see something that is

565
00:21:42,360 --> 00:21:44,280
occurring quite often then you try to

566
00:21:44,280 --> 00:21:46,080
automate it and the reason why I'm

567
00:21:46,080 --> 00:21:49,080
asking is that if you're like playing

568
00:21:49,080 --> 00:21:51,679
this like a firefighter if I can say

569
00:21:51,679 --> 00:21:53,820
while you're responding to something

570
00:21:53,820 --> 00:21:55,980
then at the same time you want to see

571
00:21:55,980 --> 00:21:58,140
like do I want to automate this so is it

572
00:21:58,140 --> 00:21:59,760
like centralized that you have a special

573
00:21:59,760 --> 00:22:03,000
team who looks at the data and you see

574
00:22:03,000 --> 00:22:05,039
okay I'm getting this reoccurring so I

575
00:22:05,039 --> 00:22:06,659
want to automate this well this is

576
00:22:06,659 --> 00:22:08,100
mostly like when you come across

577
00:22:08,100 --> 00:22:10,559
something that is often then you flag it

578
00:22:10,559 --> 00:22:13,200
like to automate it I have in both

579
00:22:13,200 --> 00:22:16,200
situations and I would personally vouch

580
00:22:16,200 --> 00:22:18,720
more for the there is a separate team

581
00:22:18,720 --> 00:22:20,820
just because you can I think the Retro

582
00:22:20,820 --> 00:22:22,799
analysis aspect of it is quite valuable

583
00:22:22,799 --> 00:22:24,480
trying to use metrics to actually

584
00:22:24,480 --> 00:22:26,580
determine the impact of an action

585
00:22:26,580 --> 00:22:28,620
performed and then pushing for that

586
00:22:28,620 --> 00:22:30,539
project for example automation for a

587
00:22:30,539 --> 00:22:32,580
specific set of issues or like specific

588
00:22:32,580 --> 00:22:35,400
set of threads so let's say like network

589
00:22:35,400 --> 00:22:37,080
based detections

590
00:22:37,080 --> 00:22:38,880
um and you want to implement automation

591
00:22:38,880 --> 00:22:40,080
but you want to be proactive about

592
00:22:40,080 --> 00:22:41,400
identifying what's actually helpful

593
00:22:41,400 --> 00:22:43,440
rather than oh you see an alert and

594
00:22:43,440 --> 00:22:45,419
you're like oh I seem to be doing this

595
00:22:45,419 --> 00:22:46,799
every other day I'm just going to

596
00:22:46,799 --> 00:22:48,299
automate it and that's not really

597
00:22:48,299 --> 00:22:51,120
scalable in a good way over time in my

598
00:22:51,120 --> 00:22:54,179
opinion it makes sense thanks thank you

599
00:22:54,179 --> 00:22:55,380
so much

600
00:22:55,380 --> 00:22:57,600
I think I have another question up there

601
00:22:57,600 --> 00:22:59,520
so let me just get the last question and

602
00:22:59,520 --> 00:23:02,340
then we can move to our last

603
00:23:02,340 --> 00:23:05,760
talk and then at 5 30 we're gonna have

604
00:23:05,760 --> 00:23:09,140
the raffle so stick around please

605
00:23:10,670 --> 00:23:11,820
[Music]

606
00:23:11,820 --> 00:23:14,460
thank you for your presentation

607
00:23:14,460 --> 00:23:17,280
um I just wanted to ask uh you guys

608
00:23:17,280 --> 00:23:19,100
prefer to use

609
00:23:19,100 --> 00:23:21,299
automated tools that you guys develop

610
00:23:21,299 --> 00:23:24,000
like such as incorporating Yara rules

611
00:23:24,000 --> 00:23:26,940
with iocs or do you guys would rather

612
00:23:26,940 --> 00:23:30,240
use third-party applications such as PF

613
00:23:30,240 --> 00:23:32,280
sounds with elastic elastic search or

614
00:23:32,280 --> 00:23:35,580
kibana so if you if you could tell me

615
00:23:35,580 --> 00:23:38,418
more about your approach

616
00:23:44,940 --> 00:23:47,039
but it depends kind of per use case

617
00:23:47,039 --> 00:23:50,159
basis for example we do use vendor EDR

618
00:23:50,159 --> 00:23:52,260
in combination with like house tooling

619
00:23:52,260 --> 00:23:56,299
so it all kind of depends

620
00:23:57,480 --> 00:24:00,419
thank you like someone

621
00:24:00,419 --> 00:24:03,260
thank you so much

