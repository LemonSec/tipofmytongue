1
00:00:00,000 --> 00:00:06,330
hi guys<font color="#CCCCCC"> it's a pleasure seeing a full</font>

2
00:00:03,090 --> 00:00:08,280
house today at besides<font color="#E5E5E5"> Vegas</font><font color="#CCCCCC"> we are here</font>

3
00:00:06,330 --> 00:00:10,469
for<font color="#E5E5E5"> in vogue nutshell all the power with</font>

4
00:00:08,280 --> 00:00:12,268
no<font color="#E5E5E5"> shell as in PowerShell</font>

5
00:00:10,469 --> 00:00:13,620
once we are<font color="#CCCCCC"> leaving this place</font><font color="#E5E5E5"> to eat</font>

6
00:00:12,269 --> 00:00:17,789
our lunch in 25 minutes

7
00:00:13,620 --> 00:00:19,890
<font color="#E5E5E5">we'll be able to actually take payloads</font>

8
00:00:17,789 --> 00:00:22,380
<font color="#E5E5E5">easily put them in a malicious document</font>

9
00:00:19,890 --> 00:00:25,380
and execute them without<font color="#E5E5E5"> PowerShell dot</font>

10
00:00:22,380 --> 00:00:28,320
<font color="#E5E5E5">eggsy which is nice fast since</font><font color="#CCCCCC"> were like</font>

11
00:00:25,380 --> 00:00:30,359
kind of good guys trying<font color="#E5E5E5"> to act as bad</font>

12
00:00:28,320 --> 00:00:33,660
guys there many<font color="#CCCCCC"> times</font><font color="#E5E5E5"> without further</font>

13
00:00:30,359 --> 00:00:35,100
ado let's move to me that's me<font color="#E5E5E5"> I'm</font>

14
00:00:33,660 --> 00:00:37,500
working for<font color="#E5E5E5"> a company called Minerva</font>

15
00:00:35,100 --> 00:00:39,239
<font color="#CCCCCC">labs</font><font color="#E5E5E5"> but this is not a sales</font><font color="#CCCCCC"> pitch so we</font>

16
00:00:37,500 --> 00:00:42,530
don't<font color="#E5E5E5"> care</font><font color="#CCCCCC"> about this</font>

17
00:00:39,239 --> 00:00:44,968
I have background at fret Intel

18
00:00:42,530 --> 00:00:47,370
<font color="#E5E5E5">background is threat intelligence</font>

19
00:00:44,969 --> 00:00:50,039
<font color="#E5E5E5">analyst I did some work of</font><font color="#CCCCCC"> staff and</font>

20
00:00:47,370 --> 00:00:53,640
<font color="#E5E5E5">full stack researcher meaning that I</font>

21
00:00:50,039 --> 00:00:57,210
tried anything<font color="#E5E5E5"> from SCADA and Modbus to</font>

22
00:00:53,640 --> 00:00:59,730
this crappy PowerShell stuff I hate

23
00:00:57,210 --> 00:01:01,920
PowerShell<font color="#CCCCCC"> after I am</font><font color="#E5E5E5"> about to swear</font>

24
00:00:59,730 --> 00:01:04,649
about it like tons of times

25
00:01:01,920 --> 00:01:09,000
I have many<font color="#E5E5E5"> open</font><font color="#CCCCCC"> source projects and</font>

26
00:01:04,650 --> 00:01:12,810
this is my posterior and github<font color="#CCCCCC"> I have</font>

27
00:01:09,000 --> 00:01:15,320
stuff there<font color="#CCCCCC"> for bypassing</font><font color="#E5E5E5"> sandboxes like</font>

28
00:01:12,810 --> 00:01:18,270
a cuckoo not<font color="#E5E5E5"> sandbox</font><font color="#CCCCCC"> as in browsers and</font>

29
00:01:15,320 --> 00:01:20,639
project for<font color="#CCCCCC"> copy-paste malware built</font>

30
00:01:18,270 --> 00:01:22,740
from<font color="#E5E5E5"> scratch and all kinds of cool stuff</font>

31
00:01:20,640 --> 00:01:26,729
just like<font color="#E5E5E5"> browse there and you'll be</font>

32
00:01:22,740 --> 00:01:30,119
<font color="#E5E5E5">good so yeah my name is</font><font color="#CCCCCC"> Colin by the way</font>

33
00:01:26,729 --> 00:01:31,979
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> just like gal gadot</font><font color="#E5E5E5"> that's like</font>

34
00:01:30,119 --> 00:01:33,810
the best<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> she ever</font><font color="#E5E5E5"> did</font><font color="#CCCCCC"> was being</font>

35
00:01:31,979 --> 00:01:37,650
famous<font color="#E5E5E5"> because now I can</font><font color="#CCCCCC"> actually</font>

36
00:01:33,810 --> 00:01:39,180
<font color="#CCCCCC">explain my</font><font color="#E5E5E5"> name really easily</font><font color="#CCCCCC"> it's a</font>

37
00:01:37,650 --> 00:01:42,450
unisex<font color="#E5E5E5"> name so don't</font><font color="#CCCCCC"> worry about</font><font color="#E5E5E5"> it</font>

38
00:01:39,180 --> 00:01:45,530
<font color="#CCCCCC">actually means wave in</font><font color="#E5E5E5"> Hebrew which is</font>

39
00:01:42,450 --> 00:01:49,860
kind of a cool name<font color="#CCCCCC"> think about it yeah</font>

40
00:01:45,530 --> 00:01:53,100
no worries<font color="#CCCCCC"> and feel</font><font color="#E5E5E5"> free to follow me on</font>

41
00:01:49,860 --> 00:01:56,430
<font color="#CCCCCC">Twitter and get</font><font color="#E5E5E5"> up and I know even on</font>

42
00:01:53,100 --> 00:01:58,048
Instagram<font color="#E5E5E5"> if you really want to yeah</font>

43
00:01:56,430 --> 00:02:02,219
there<font color="#E5E5E5"> will be tons of cheap effects in</font>

44
00:01:58,049 --> 00:02:03,240
this presentation<font color="#E5E5E5"> so stay tuned</font><font color="#CCCCCC"> okay</font>

45
00:02:02,219 --> 00:02:06,539
let's move to the outside<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

46
00:02:03,240 --> 00:02:08,758
presentation we'll start with a bit<font color="#E5E5E5"> of a</font>

47
00:02:06,540 --> 00:02:11,790
background<font color="#CCCCCC"> of PowerShell</font><font color="#E5E5E5"> what it is good</font>

48
00:02:08,758 --> 00:02:13,940
for<font color="#E5E5E5"> absolutely</font><font color="#CCCCCC"> nothing</font><font color="#E5E5E5"> but for blue</font>

49
00:02:11,790 --> 00:02:16,140
teamers and red team

50
00:02:13,940 --> 00:02:20,879
from the different point of view<font color="#CCCCCC"> the</font>

51
00:02:16,140 --> 00:02:22,649
<font color="#CCCCCC">white</font><font color="#E5E5E5"> pouch that is so good or bad</font><font color="#CCCCCC"> will</font>

52
00:02:20,879 --> 00:02:27,209
move them to the<font color="#E5E5E5"> actual tool to invoke</font>

53
00:02:22,650 --> 00:02:28,879
no shell<font color="#E5E5E5"> and how does</font><font color="#CCCCCC"> it work and why it</font>

54
00:02:27,209 --> 00:02:31,560
is<font color="#CCCCCC"> better</font><font color="#E5E5E5"> than what we have</font><font color="#CCCCCC"> right now</font>

55
00:02:28,879 --> 00:02:34,099
<font color="#E5E5E5">and then we'll introduce how it actually</font>

56
00:02:31,560 --> 00:02:36,870
works<font color="#E5E5E5"> and performs against real life</font><font color="#CCCCCC"> AVS</font>

57
00:02:34,099 --> 00:02:40,319
which is kind of what we<font color="#CCCCCC"> are</font><font color="#E5E5E5"> doing on a</font>

58
00:02:36,870 --> 00:02:42,390
daily<font color="#CCCCCC"> life</font><font color="#E5E5E5"> okay so let's begin with the</font>

59
00:02:40,319 --> 00:02:46,980
blue team point of view what is partial

60
00:02:42,390 --> 00:02:48,980
<font color="#CCCCCC">through blue teamers well it is kind of</font>

61
00:02:46,980 --> 00:02:51,959
a programming<font color="#CCCCCC"> language</font>

62
00:02:48,980 --> 00:02:54,599
mostly for<font color="#E5E5E5"> windows night now for Linux</font>

63
00:02:51,959 --> 00:02:56,910
and<font color="#E5E5E5"> Mac</font><font color="#CCCCCC"> I guess I don't know who uses</font>

64
00:02:54,599 --> 00:03:01,768
this kind<font color="#CCCCCC"> of stuff</font><font color="#E5E5E5"> on Linux but good for</font>

65
00:02:56,910 --> 00:03:03,810
you<font color="#CCCCCC"> it is really powerful it is</font><font color="#E5E5E5"> actually</font>

66
00:03:01,769 --> 00:03:06,900
<font color="#E5E5E5">really easy to</font><font color="#CCCCCC"> learn and</font><font color="#E5E5E5"> use which is</font>

67
00:03:03,810 --> 00:03:09,299
good since<font color="#E5E5E5"> we lack trained IT personnel</font>

68
00:03:06,900 --> 00:03:13,019
<font color="#E5E5E5">so this is one</font><font color="#CCCCCC"> of the reasons it is so</font>

69
00:03:09,299 --> 00:03:16,170
popular<font color="#CCCCCC"> even I can code in PowerShell</font><font color="#E5E5E5"> it</font>

70
00:03:13,019 --> 00:03:18,829
has all the power of dotnet dotnet can

71
00:03:16,170 --> 00:03:21,569
do anything in<font color="#E5E5E5"> Windows really anything</font>

72
00:03:18,829 --> 00:03:24,269
<font color="#E5E5E5">even more than the people designing dot</font>

73
00:03:21,569 --> 00:03:26,339
that intended<font color="#CCCCCC"> to I guess so PowerShell</font>

74
00:03:24,269 --> 00:03:28,889
packs all<font color="#CCCCCC"> the dotnet power</font><font color="#E5E5E5"> inside which</font>

75
00:03:26,340 --> 00:03:29,540
is good for blue teamers because they

76
00:03:28,889 --> 00:03:32,910
can do anything

77
00:03:29,540 --> 00:03:35,190
<font color="#E5E5E5">it's compatible with</font><font color="#CCCCCC"> WMI comma objects</font>

78
00:03:32,910 --> 00:03:38,549
which<font color="#E5E5E5"> is again really good</font><font color="#CCCCCC"> because it</font>

79
00:03:35,190 --> 00:03:40,560
enables us to do terms of stuff<font color="#CCCCCC"> maintain</font>

80
00:03:38,549 --> 00:03:43,169
the list of whatever<font color="#E5E5E5"> in the cloud for</font>

81
00:03:40,560 --> 00:03:46,859
<font color="#CCCCCC">example and it has better security</font>

82
00:03:43,169 --> 00:03:49,769
<font color="#E5E5E5">nowadays it has logging and MC which you</font>

83
00:03:46,859 --> 00:03:51,030
can send a buffer<font color="#CCCCCC"> to your AV provider</font>

84
00:03:49,769 --> 00:03:53,940
which<font color="#E5E5E5"> is really nice</font>

85
00:03:51,030 --> 00:04:00,090
however it is not perfect<font color="#E5E5E5"> remember that</font>

86
00:03:53,940 --> 00:04:03,569
for<font color="#E5E5E5"> example yeah this is a recent</font><font color="#CCCCCC"> thing</font>

87
00:04:00,090 --> 00:04:06,090
from a blog of<font color="#CCCCCC"> anti sack for example you</font>

88
00:04:03,569 --> 00:04:08,578
can see<font color="#E5E5E5"> that they do have better</font>

89
00:04:06,090 --> 00:04:10,859
<font color="#E5E5E5">security now and if you try to execute</font>

90
00:04:08,579 --> 00:04:13,019
the system management<font color="#E5E5E5"> automation MCU</font>

91
00:04:10,859 --> 00:04:16,228
tools and get field<font color="#CCCCCC"> etc and try to</font>

92
00:04:13,019 --> 00:04:18,478
<font color="#E5E5E5">disable it they will detect it however</font>

93
00:04:16,228 --> 00:04:21,120
if you break<font color="#CCCCCC"> it with a plus</font><font color="#E5E5E5"> and you can</font>

94
00:04:18,478 --> 00:04:22,530
catenate strings or you just use double

95
00:04:21,120 --> 00:04:25,020
quotes instead<font color="#E5E5E5"> of single</font><font color="#CCCCCC"> quotes</font><font color="#E5E5E5"> you</font>

96
00:04:22,530 --> 00:04:26,138
bypass it so it's not perfect we still

97
00:04:25,020 --> 00:04:28,090
have some

98
00:04:26,139 --> 00:04:31,719
<font color="#CCCCCC">improvements an egg but it's a better</font>

99
00:04:28,090 --> 00:04:33,969
situation that we<font color="#E5E5E5"> used to have okay and</font>

100
00:04:31,719 --> 00:04:37,770
it<font color="#E5E5E5"> is so common that I did a survey</font>

101
00:04:33,969 --> 00:04:40,300
<font color="#E5E5E5">among like</font><font color="#CCCCCC"> 80 different</font><font color="#E5E5E5"> friends of mine</font>

102
00:04:37,770 --> 00:04:42,938
<font color="#E5E5E5">how many people actually use</font><font color="#CCCCCC"> PowerShell</font>

103
00:04:40,300 --> 00:04:44,289
<font color="#CCCCCC">in their daily life</font><font color="#E5E5E5"> and nine seven</font>

104
00:04:42,939 --> 00:04:47,680
percent of<font color="#CCCCCC"> the people use</font><font color="#E5E5E5"> file shell</font>

105
00:04:44,289 --> 00:04:50,889
some like me regret it<font color="#E5E5E5"> really regret it</font>

106
00:04:47,680 --> 00:04:51,550
<font color="#E5E5E5">but it is very common language</font><font color="#CCCCCC"> for a</font>

107
00:04:50,889 --> 00:04:55,419
good reason

108
00:04:51,550 --> 00:04:58,779
<font color="#E5E5E5">and let's continue to the red team's</font>

109
00:04:55,419 --> 00:05:01,568
point of view which is<font color="#CCCCCC"> I know how many</font>

110
00:04:58,779 --> 00:05:04,479
<font color="#E5E5E5">of you</font><font color="#CCCCCC"> are red teamers how many of you</font>

111
00:05:01,569 --> 00:05:07,779
are<font color="#E5E5E5"> blue teamers okay so it's good as</font>

112
00:05:04,479 --> 00:05:09,610
Brad<font color="#E5E5E5"> 5050 and maybe 20 20</font><font color="#CCCCCC"> and 60</font><font color="#E5E5E5"> percent</font>

113
00:05:07,779 --> 00:05:11,370
which<font color="#CCCCCC"> are kind of anonymous but just</font>

114
00:05:09,610 --> 00:05:15,340
<font color="#CCCCCC">okay no worries</font>

115
00:05:11,370 --> 00:05:17,050
so for red<font color="#CCCCCC"> teamers</font><font color="#E5E5E5"> kind of surprisingly</font>

116
00:05:15,340 --> 00:05:19,869
<font color="#E5E5E5">the advantage of the four blue team is</font>

117
00:05:17,050 --> 00:05:22,839
<font color="#E5E5E5">that the same</font><font color="#CCCCCC"> for red team</font><font color="#E5E5E5"> is alike</font>

118
00:05:19,870 --> 00:05:25,719
because<font color="#E5E5E5"> we also lack</font><font color="#CCCCCC"> well-trained red</font>

119
00:05:22,839 --> 00:05:27,909
teamers and it is easy to write bad

120
00:05:25,719 --> 00:05:30,610
stuff in PowerShell<font color="#E5E5E5"> really easy</font><font color="#CCCCCC"> almost</font>

121
00:05:27,909 --> 00:05:33,729
<font color="#E5E5E5">too easy</font><font color="#CCCCCC"> it has all the</font><font color="#E5E5E5"> power of dotnet</font>

122
00:05:30,610 --> 00:05:35,650
which means we can do almost<font color="#E5E5E5"> anything in</font>

123
00:05:33,729 --> 00:05:38,289
malicious PowerShell because<font color="#E5E5E5"> that is so</font>

124
00:05:35,650 --> 00:05:40,000
powerful<font color="#CCCCCC"> and it's communicate with WMI</font>

125
00:05:38,289 --> 00:05:42,688
in<font color="#E5E5E5"> comm check you can use</font><font color="#CCCCCC"> WMI for</font>

126
00:05:40,000 --> 00:05:45,939
<font color="#CCCCCC">example to launch processes without</font>

127
00:05:42,689 --> 00:05:48,250
having the parent process as the

128
00:05:45,939 --> 00:05:50,969
original one which is kind of<font color="#E5E5E5"> good if</font>

129
00:05:48,250 --> 00:05:54,879
you want to fight<font color="#CCCCCC"> edie RS for</font><font color="#E5E5E5"> example</font>

130
00:05:50,969 --> 00:05:56,379
again really<font color="#E5E5E5"> nice just</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> a bit of a</font>

131
00:05:54,879 --> 00:05:58,409
different advantage for<font color="#CCCCCC"> photoshop</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> a</font>

132
00:05:56,379 --> 00:06:03,490
<font color="#E5E5E5">team is the fact that it is fire less</font>

133
00:05:58,409 --> 00:06:04,990
well this<font color="#E5E5E5"> buzzword</font><font color="#CCCCCC"> I hated</font><font color="#E5E5E5"> sorry but it</font>

134
00:06:03,490 --> 00:06:06,580
is an<font color="#E5E5E5"> advantage you can</font><font color="#CCCCCC"> actually execute</font>

135
00:06:04,990 --> 00:06:10,629
thousand scripts<font color="#CCCCCC"> without writing to the</font>

136
00:06:06,580 --> 00:06:13,330
disk<font color="#E5E5E5"> again</font><font color="#CCCCCC"> nice assist you to evade some</font>

137
00:06:10,629 --> 00:06:17,199
detection tools or to make blue teamers

138
00:06:13,330 --> 00:06:20,729
life way more miserable<font color="#CCCCCC"> but blue team is</font>

139
00:06:17,199 --> 00:06:23,889
in the crowd I'm sure<font color="#E5E5E5"> will agree</font><font color="#CCCCCC"> okay</font>

140
00:06:20,729 --> 00:06:25,688
also<font color="#CCCCCC"> a key benefit</font><font color="#E5E5E5"> of PowerShell at</font>

141
00:06:23,889 --> 00:06:27,789
least for red teamers<font color="#E5E5E5"> is the fact that</font>

142
00:06:25,689 --> 00:06:32,529
turns of frameworks were already<font color="#E5E5E5"> written</font>

143
00:06:27,789 --> 00:06:36,610
for PowerShell for example<font color="#CCCCCC"> powersploit</font>

144
00:06:32,529 --> 00:06:38,529
invoke<font color="#E5E5E5"> obfuscation veil all that I think</font>

145
00:06:36,610 --> 00:06:39,710
is compatible of<font color="#CCCCCC"> metalloid which is good</font>

146
00:06:38,529 --> 00:06:41,690
<font color="#E5E5E5">for me</font>

147
00:06:39,710 --> 00:06:43,849
kid<font color="#CCCCCC"> I just like want</font><font color="#E5E5E5"> to generate my</font>

148
00:06:41,690 --> 00:06:47,560
payload<font color="#E5E5E5"> click on this exploit button and</font>

149
00:06:43,850 --> 00:06:50,750
set C to server<font color="#E5E5E5"> and I have a working</font>

150
00:06:47,560 --> 00:06:56,120
<font color="#CCCCCC">backdoor</font><font color="#E5E5E5"> out of the box really easily</font>

151
00:06:50,750 --> 00:06:58,270
and well we're all lazy<font color="#E5E5E5"> but you might</font>

152
00:06:56,120 --> 00:07:02,090
<font color="#E5E5E5">say not lazy maybe we are trying to be</font>

153
00:06:58,270 --> 00:07:05,330
efficient<font color="#CCCCCC"> is the world</font><font color="#E5E5E5"> but powder is a</font>

154
00:07:02,090 --> 00:07:08,659
good way to<font color="#E5E5E5"> achieve powerful</font><font color="#CCCCCC"> backdoors</font>

155
00:07:05,330 --> 00:07:11,780
in no time in a reliable<font color="#E5E5E5"> way</font><font color="#CCCCCC"> to bypass</font>

156
00:07:08,660 --> 00:07:15,860
<font color="#CCCCCC">AVS partially because of those</font>

157
00:07:11,780 --> 00:07:18,320
frameworks<font color="#CCCCCC"> I</font><font color="#E5E5E5"> I did a quick survey about</font>

158
00:07:15,860 --> 00:07:20,060
<font color="#E5E5E5">this as well</font><font color="#CCCCCC"> only 50%</font><font color="#E5E5E5"> of the responders</font>

159
00:07:18,320 --> 00:07:22,070
were actually using<font color="#E5E5E5"> power</font><font color="#CCCCCC"> ship for</font>

160
00:07:20,060 --> 00:07:25,940
malicious purposes so I treated the

161
00:07:22,070 --> 00:07:28,610
results<font color="#CCCCCC"> were</font><font color="#E5E5E5"> suspect</font><font color="#CCCCCC"> only to</font><font color="#E5E5E5"> those using</font>

162
00:07:25,940 --> 00:07:30,140
<font color="#E5E5E5">partial maliciously and 83% of those</font>

163
00:07:28,610 --> 00:07:33,350
using partial<font color="#E5E5E5"> malicious purposes</font>

164
00:07:30,140 --> 00:07:34,340
<font color="#E5E5E5">actually successfully bypass</font><font color="#CCCCCC"> AV the rest</font>

165
00:07:33,350 --> 00:07:36,110
<font color="#CCCCCC">17%</font>

166
00:07:34,340 --> 00:07:39,979
I know<font color="#E5E5E5"> maybe you can take a private</font>

167
00:07:36,110 --> 00:07:41,390
<font color="#E5E5E5">class with me afterwards and</font><font color="#CCCCCC"> 60 percent</font>

168
00:07:39,980 --> 00:07:44,300
of<font color="#E5E5E5"> those using PowerShell for malicious</font>

169
00:07:41,390 --> 00:07:47,479
purposes<font color="#E5E5E5"> use frameworks the remaining</font>

170
00:07:44,300 --> 00:07:48,680
<font color="#CCCCCC">40% I guess well maybe they're the kind</font>

171
00:07:47,480 --> 00:07:52,250
of guys<font color="#CCCCCC"> that invented their own</font>

172
00:07:48,680 --> 00:07:53,030
cryptography or something<font color="#E5E5E5"> use frameworks</font>

173
00:07:52,250 --> 00:07:57,080
<font color="#E5E5E5">it is good</font>

174
00:07:53,030 --> 00:08:01,580
it<font color="#E5E5E5"> is really</font><font color="#CCCCCC"> easy just use frameworks</font>

175
00:07:57,080 --> 00:08:03,890
<font color="#CCCCCC">there they're really good</font><font color="#E5E5E5"> but well oh oh</font>

176
00:08:01,580 --> 00:08:08,599
the life of red teamers<font color="#CCCCCC"> we found</font><font color="#E5E5E5"> are not</font>

177
00:08:03,890 --> 00:08:11,510
that<font color="#E5E5E5"> good as well we do have</font><font color="#CCCCCC"> some issues</font>

178
00:08:08,600 --> 00:08:15,770
with<font color="#CCCCCC"> PowerShell like some</font><font color="#E5E5E5"> respect in</font>

179
00:08:11,510 --> 00:08:18,050
<font color="#E5E5E5">PowerShell you get</font><font color="#CCCCCC"> 90,000 like</font><font color="#E5E5E5"> results</font>

180
00:08:15,770 --> 00:08:20,810
<font color="#CCCCCC">on</font><font color="#E5E5E5"> Google you have some ways to</font><font color="#CCCCCC"> restrict</font>

181
00:08:18,050 --> 00:08:23,450
<font color="#E5E5E5">PowerShell execution they are not making</font>

182
00:08:20,810 --> 00:08:26,510
it impossible but they they make you

183
00:08:23,450 --> 00:08:29,599
struggle for a bit and<font color="#E5E5E5"> you</font><font color="#CCCCCC"> have those</font>

184
00:08:26,510 --> 00:08:32,270
annoying packager activation office

185
00:08:29,600 --> 00:08:35,000
thing which means that if you<font color="#E5E5E5"> try</font><font color="#CCCCCC"> to</font>

186
00:08:32,270 --> 00:08:37,520
let's say put in a oil<font color="#E5E5E5"> I object</font>

187
00:08:35,000 --> 00:08:40,760
and a documented<font color="#CCCCCC"> au in somebody clicks</font>

188
00:08:37,520 --> 00:08:42,500
it in a fully up-to-date<font color="#E5E5E5"> office that's</font>

189
00:08:40,760 --> 00:08:46,280
<font color="#CCCCCC">an important thing you'll get this</font>

190
00:08:42,500 --> 00:08:48,920
<font color="#CCCCCC">screen which blocks any kind of a badge</font>

191
00:08:46,280 --> 00:08:51,829
<font color="#CCCCCC">PowerShell execution</font><font color="#E5E5E5"> if it is an</font>

192
00:08:48,920 --> 00:08:53,329
<font color="#E5E5E5">embedded object again not perfect</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> can</font>

193
00:08:51,830 --> 00:08:56,869
be<font color="#CCCCCC"> bypassed from the</font>

194
00:08:53,329 --> 00:09:00,859
<font color="#E5E5E5">three for example but it makes our life</font>

195
00:08:56,869 --> 00:09:02,299
a bit more tough and this<font color="#E5E5E5"> is the most</font>

196
00:09:00,860 --> 00:09:04,489
annoying thing<font color="#CCCCCC"> at least from my</font><font color="#E5E5E5"> point of</font>

197
00:09:02,299 --> 00:09:06,949
view<font color="#CCCCCC"> when</font><font color="#E5E5E5"> I'm using PowerShell for</font>

198
00:09:04,489 --> 00:09:10,489
offensive purposes<font color="#CCCCCC"> I use it often from a</font>

199
00:09:06,949 --> 00:09:13,910
document so I have a blank document<font color="#E5E5E5"> and</font>

200
00:09:10,489 --> 00:09:16,249
I start like<font color="#CCCCCC"> think about</font><font color="#E5E5E5"> what I what we</font>

201
00:09:13,910 --> 00:09:18,230
are doing now I'll launch<font color="#E5E5E5"> it on open and</font>

202
00:09:16,249 --> 00:09:21,829
<font color="#E5E5E5">close when user clicks let's say I go</font>

203
00:09:18,230 --> 00:09:25,279
for<font color="#E5E5E5"> unclick and then I need to write off</font>

204
00:09:21,829 --> 00:09:27,049
the VBA<font color="#E5E5E5"> ugly code and then I need to</font>

205
00:09:25,279 --> 00:09:29,360
<font color="#E5E5E5">decide whether</font><font color="#CCCCCC"> or not I want</font><font color="#E5E5E5"> to use a if</font>

206
00:09:27,049 --> 00:09:32,329
you bypass<font color="#E5E5E5"> or not again I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> about</font>

207
00:09:29,360 --> 00:09:35,629
well let's do the<font color="#CCCCCC"> EP bypass and then I</font>

208
00:09:32,329 --> 00:09:38,748
generate my final<font color="#E5E5E5"> combination of traits</font>

209
00:09:35,629 --> 00:09:40,720
like the<font color="#CCCCCC"> first trait is the one click</font>

210
00:09:38,749 --> 00:09:43,939
and<font color="#E5E5E5"> the second one is the - EP bypass</font>

211
00:09:40,720 --> 00:09:45,379
but I do all of it manually which is

212
00:09:43,939 --> 00:09:47,748
really<font color="#CCCCCC"> time-consuming and really</font>

213
00:09:45,379 --> 00:09:51,470
annoying since<font color="#E5E5E5"> VBA is even worse than</font>

214
00:09:47,749 --> 00:09:54,319
<font color="#E5E5E5">PowerShell yeah you're all agreeing at</font>

215
00:09:51,470 --> 00:09:57,799
this and it's awful awful awful awful

216
00:09:54,319 --> 00:10:00,699
thing and I hate<font color="#E5E5E5"> it</font><font color="#CCCCCC"> there is a framework</font>

217
00:09:57,799 --> 00:10:03,619
called<font color="#E5E5E5"> Lucky Strike which is nice</font>

218
00:10:00,699 --> 00:10:05,839
it does solve some of the issues<font color="#E5E5E5"> I'm</font>

219
00:10:03,619 --> 00:10:10,579
struggling with but it wasn't good

220
00:10:05,839 --> 00:10:14,779
enough for for my kind<font color="#E5E5E5"> of need you'll</font>

221
00:10:10,579 --> 00:10:17,628
see in a sec how I I solve it out so to

222
00:10:14,779 --> 00:10:20,329
sum it up<font color="#CCCCCC"> now what we are missing</font><font color="#E5E5E5"> is</font>

223
00:10:17,629 --> 00:10:22,669
that<font color="#E5E5E5"> basically having a method to</font>

224
00:10:20,329 --> 00:10:25,699
overcome restrictions effectively and<font color="#E5E5E5"> to</font>

225
00:10:22,669 --> 00:10:28,759
work at scale<font color="#E5E5E5"> to generate all</font><font color="#CCCCCC"> of those</font>

226
00:10:25,699 --> 00:10:31,819
traits and combinations<font color="#E5E5E5"> effectively and</font>

227
00:10:28,759 --> 00:10:36,499
easily at<font color="#CCCCCC"> least from my point</font><font color="#E5E5E5"> of view</font>

228
00:10:31,819 --> 00:10:39,219
<font color="#E5E5E5">I'm kind of a red teamer so in this</font>

229
00:10:36,499 --> 00:10:43,100
stage I want<font color="#E5E5E5"> to unveil invoke</font><font color="#CCCCCC"> Michelle</font>

230
00:10:39,220 --> 00:10:48,980
which<font color="#E5E5E5"> is a yeah</font><font color="#CCCCCC"> I promised the chief</font>

231
00:10:43,100 --> 00:10:51,489
transitions between slides yeah I wish

232
00:10:48,980 --> 00:10:57,799
to unveil invoke Michelle<font color="#E5E5E5"> sorry for</font>

233
00:10:51,489 --> 00:11:00,079
<font color="#CCCCCC">saying</font><font color="#E5E5E5"> in a way and well I don't want to</font>

234
00:10:57,799 --> 00:11:04,939
kind of unveil directly I want to unveil

235
00:11:00,079 --> 00:11:07,060
<font color="#E5E5E5">via a story I had</font><font color="#CCCCCC"> a case I had my boss</font>

236
00:11:04,939 --> 00:11:09,490
comes<font color="#E5E5E5"> to me one morning he says</font>

237
00:11:07,060 --> 00:11:11,800
well we have a potential client<font color="#E5E5E5"> but he</font>

238
00:11:09,490 --> 00:11:14,470
says he's 100<font color="#CCCCCC"> here's</font><font color="#E5E5E5"> 100 percent</font>

239
00:11:11,800 --> 00:11:17,859
<font color="#E5E5E5">protection against any</font><font color="#CCCCCC"> PowerShell attack</font>

240
00:11:14,470 --> 00:11:20,370
nothing can yeah<font color="#E5E5E5"> exactly</font><font color="#CCCCCC"> my response</font>

241
00:11:17,860 --> 00:11:23,470
exactly my response I totally get<font color="#CCCCCC"> it and</font>

242
00:11:20,370 --> 00:11:26,440
well<font color="#E5E5E5"> hi Google for a while and I found</font>

243
00:11:23,470 --> 00:11:28,630
this<font color="#CCCCCC"> think this</font><font color="#E5E5E5"> is the</font><font color="#CCCCCC"> call of invoke</font>

244
00:11:26,440 --> 00:11:30,790
<font color="#E5E5E5">nutshell you might laugh</font><font color="#CCCCCC"> but this is</font>

245
00:11:28,630 --> 00:11:34,600
<font color="#CCCCCC">PowerShell I see for</font><font color="#E5E5E5"> those of you don't</font>

246
00:11:30,790 --> 00:11:37,719
<font color="#E5E5E5">know and after googling for</font><font color="#CCCCCC"> a while it</font>

247
00:11:34,600 --> 00:11:40,510
turns out<font color="#E5E5E5"> that if you place your</font>

248
00:11:37,720 --> 00:11:43,390
<font color="#E5E5E5">PowerShell script in this place which</font>

249
00:11:40,510 --> 00:11:46,150
resolves<font color="#CCCCCC"> to this path you can actually</font>

250
00:11:43,390 --> 00:11:49,330
get<font color="#E5E5E5"> your script executed by PowerShell</font>

251
00:11:46,150 --> 00:11:54,400
ISE instead of PowerShell<font color="#CCCCCC"> but eggsy</font><font color="#E5E5E5"> it</font>

252
00:11:49,330 --> 00:11:56,350
is nice it has a UI which pops but you

253
00:11:54,400 --> 00:11:58,540
can shut<font color="#CCCCCC"> it</font><font color="#E5E5E5"> down you can hide it it is</font>

254
00:11:56,350 --> 00:12:02,170
<font color="#E5E5E5">really nice way to execute and power</font>

255
00:11:58,540 --> 00:12:04,990
that<font color="#CCCCCC"> XE is never invoked</font><font color="#E5E5E5"> it is really</font>

256
00:12:02,170 --> 00:12:07,120
nice it overcomes many<font color="#CCCCCC"> AVS which</font>

257
00:12:04,990 --> 00:12:09,010
<font color="#E5E5E5">restrict PowerShell but not</font><font color="#CCCCCC"> PowerShell</font>

258
00:12:07,120 --> 00:12:11,170
<font color="#CCCCCC">ISE because why</font><font color="#E5E5E5"> restricting power shall</font>

259
00:12:09,010 --> 00:12:14,740
I see it can never execute power shell

260
00:12:11,170 --> 00:12:18,819
scripts it can well just need to read

261
00:12:14,740 --> 00:12:21,760
the manual<font color="#CCCCCC"> and well in this stage I</font><font color="#E5E5E5"> have</font>

262
00:12:18,820 --> 00:12:25,030
like my first trait and<font color="#E5E5E5"> my kind of a</font>

263
00:12:21,760 --> 00:12:28,300
<font color="#CCCCCC">Taft Ward's</font><font color="#E5E5E5"> a final version of my</font>

264
00:12:25,030 --> 00:12:31,180
infected document but then I realized I

265
00:12:28,300 --> 00:12:34,120
need to find a way to<font color="#E5E5E5"> bypass execution</font>

266
00:12:31,180 --> 00:12:37,569
policy<font color="#E5E5E5"> because well I guess that many of</font>

267
00:12:34,120 --> 00:12:40,150
you<font color="#E5E5E5"> already seen malicious documents and</font>

268
00:12:37,570 --> 00:12:42,280
how they used to have<font color="#E5E5E5"> like this - EP</font>

269
00:12:40,150 --> 00:12:44,290
bypass all the<font color="#CCCCCC"> time</font>

270
00:12:42,280 --> 00:12:46,630
but I can't use the<font color="#E5E5E5"> same flag from</font>

271
00:12:44,290 --> 00:12:49,420
<font color="#CCCCCC">PowerShell I</font><font color="#E5E5E5"> see because well it</font><font color="#CCCCCC"> doesn't</font>

272
00:12:46,630 --> 00:12:51,010
get these kind of arguments<font color="#E5E5E5"> it's not</font>

273
00:12:49,420 --> 00:12:53,770
power<font color="#CCCCCC"> at its power</font><font color="#E5E5E5"> that I see and I</font>

274
00:12:51,010 --> 00:12:57,520
can't use this -<font color="#E5E5E5"> EP bypass fortunately</font>

275
00:12:53,770 --> 00:13:00,310
enough although 30% of the user<font color="#E5E5E5"> always</font>

276
00:12:57,520 --> 00:13:02,980
see this annoying message<font color="#E5E5E5"> it turns out</font>

277
00:13:00,310 --> 00:13:05,770
this is executed<font color="#E5E5E5"> policies of restricted</font>

278
00:13:02,980 --> 00:13:10,210
message it turns out<font color="#E5E5E5"> that the execution</font>

279
00:13:05,770 --> 00:13:12,310
<font color="#E5E5E5">policy is broken it is not a security</font>

280
00:13:10,210 --> 00:13:15,670
<font color="#E5E5E5">measure and should never</font><font color="#CCCCCC"> be treated</font><font color="#E5E5E5"> as</font>

281
00:13:12,310 --> 00:13:18,780
one and you<font color="#CCCCCC"> just again you - yeah I can</font>

282
00:13:15,670 --> 00:13:20,949
just<font color="#E5E5E5"> like toss it to the trash bin and</font>

283
00:13:18,780 --> 00:13:23,680
even being Microsoft<font color="#E5E5E5"> document</font>

284
00:13:20,950 --> 00:13:25,959
it was never meant to be<font color="#CCCCCC"> used</font><font color="#E5E5E5"> as a</font>

285
00:13:23,680 --> 00:13:28,719
<font color="#CCCCCC">security measure it</font><font color="#E5E5E5"> just should</font>

286
00:13:25,959 --> 00:13:30,819
idiot-proof<font color="#CCCCCC"> powershell for the stupid</font>

287
00:13:28,720 --> 00:13:32,740
user who doesn't<font color="#E5E5E5"> need to</font><font color="#CCCCCC"> exit a shell</font>

288
00:13:30,820 --> 00:13:35,050
but if I usually intentionally wants to

289
00:13:32,740 --> 00:13:37,329
execute power shell<font color="#E5E5E5"> you can't stop him</font>

290
00:13:35,050 --> 00:13:40,870
<font color="#CCCCCC">from doing so</font><font color="#E5E5E5"> by execution policy and</font>

291
00:13:37,329 --> 00:13:43,630
indeed<font color="#CCCCCC"> I found this nice little blog</font>

292
00:13:40,870 --> 00:13:45,850
post about this registry value<font color="#E5E5E5"> all you</font>

293
00:13:43,630 --> 00:13:48,430
need<font color="#E5E5E5"> to do is just to set this registry</font>

294
00:13:45,850 --> 00:13:50,589
value which resides in the HK<font color="#CCCCCC"> Cu hive</font>

295
00:13:48,430 --> 00:13:53,829
<font color="#E5E5E5">meaning that you even don't need</font><font color="#CCCCCC"> to be</font>

296
00:13:50,589 --> 00:13:55,540
an admin<font color="#CCCCCC"> to set it and you can sell</font><font color="#E5E5E5"> to</font>

297
00:13:53,829 --> 00:13:58,060
unrestricted and it<font color="#E5E5E5"> don't need this</font>

298
00:13:55,540 --> 00:14:02,050
means<font color="#CCCCCC"> ap bypass being which</font><font color="#E5E5E5"> is again</font>

299
00:13:58,060 --> 00:14:06,310
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> amazing and this is the second</font>

300
00:14:02,050 --> 00:14:08,889
trait which<font color="#E5E5E5"> I added to my malicious</font>

301
00:14:06,310 --> 00:14:10,839
document all again by hand which<font color="#CCCCCC"> is kind</font>

302
00:14:08,889 --> 00:14:15,040
of a frustrating<font color="#E5E5E5"> and you need to do it</font>

303
00:14:10,839 --> 00:14:18,490
in VBA<font color="#CCCCCC"> and it's a really</font><font color="#E5E5E5"> annoying thing</font>

304
00:14:15,040 --> 00:14:21,399
<font color="#E5E5E5">to do but I have my second trait and now</font>

305
00:14:18,490 --> 00:14:22,750
well it is not a single vendor<font color="#E5E5E5"> it it is</font>

306
00:14:21,399 --> 00:14:25,120
never<font color="#E5E5E5"> a single vendor you need to check</font>

307
00:14:22,750 --> 00:14:27,820
it<font color="#E5E5E5"> again</font><font color="#CCCCCC"> it is the first vendor</font><font color="#E5E5E5"> and then</font>

308
00:14:25,120 --> 00:14:29,529
<font color="#E5E5E5">the second one and then the</font><font color="#CCCCCC"> third one</font>

309
00:14:27,820 --> 00:14:32,050
<font color="#CCCCCC">and everything</font><font color="#E5E5E5"> by hand and you have like</font>

310
00:14:29,529 --> 00:14:35,260
<font color="#E5E5E5">eight different combinations</font><font color="#CCCCCC"> to check of</font>

311
00:14:32,050 --> 00:14:37,899
trades and<font color="#E5E5E5"> you do it all by hand and</font>

312
00:14:35,260 --> 00:14:39,310
then you find<font color="#E5E5E5"> that</font><font color="#CCCCCC"> after</font><font color="#E5E5E5"> doing all the</font>

313
00:14:37,899 --> 00:14:42,010
vendors<font color="#E5E5E5"> you find this perfect</font>

314
00:14:39,310 --> 00:14:44,859
<font color="#E5E5E5">combination but this takes a lot</font><font color="#CCCCCC"> of time</font>

315
00:14:42,010 --> 00:14:48,790
and my goal was invoke no shell was

316
00:14:44,860 --> 00:14:50,290
solving it so in order<font color="#CCCCCC"> to do so I've</font>

317
00:14:48,790 --> 00:14:52,750
started to think<font color="#CCCCCC"> about what is the</font>

318
00:14:50,290 --> 00:14:55,689
technology<font color="#E5E5E5"> where I can create all this</font>

319
00:14:52,750 --> 00:14:57,880
stuff automatically<font color="#E5E5E5"> and create a</font>

320
00:14:55,690 --> 00:15:01,329
malicious payload<font color="#E5E5E5"> a malicious document</font>

321
00:14:57,880 --> 00:15:05,170
with a payload from code and I used

322
00:15:01,329 --> 00:15:07,569
power to do so and the result was this

323
00:15:05,170 --> 00:15:09,839
nice thing called invoked<font color="#E5E5E5"> or shell it is</font>

324
00:15:07,569 --> 00:15:12,219
basically a<font color="#E5E5E5"> partial script</font>

325
00:15:09,839 --> 00:15:12,550
object-oriented<font color="#CCCCCC"> PowerShell which is</font>

326
00:15:12,220 --> 00:15:14,220
cancer

327
00:15:12,550 --> 00:15:17,709
[Music]

328
00:15:14,220 --> 00:15:19,779
<font color="#CCCCCC">Jacque</font><font color="#E5E5E5"> which has all</font><font color="#CCCCCC"> the kinds of traits</font>

329
00:15:17,710 --> 00:15:22,570
<font color="#E5E5E5">being translated into members and</font>

330
00:15:19,779 --> 00:15:26,200
<font color="#CCCCCC">members functions</font><font color="#E5E5E5"> and it communicates</font>

331
00:15:22,570 --> 00:15:28,150
with office<font color="#CCCCCC"> comm object it</font><font color="#E5E5E5"> just like</font>

332
00:15:26,200 --> 00:15:30,460
uses the<font color="#CCCCCC"> windward instance which means</font>

333
00:15:28,150 --> 00:15:34,029
you need to have<font color="#E5E5E5"> office installed but</font>

334
00:15:30,460 --> 00:15:36,940
well<font color="#E5E5E5"> this kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> makes sense</font><font color="#CCCCCC"> and it's</font>

335
00:15:34,029 --> 00:15:39,040
<font color="#E5E5E5">just like generates on the fly all the</font>

336
00:15:36,940 --> 00:15:44,050
different<font color="#CCCCCC"> permutations of the possible</font>

337
00:15:39,040 --> 00:15:46,930
<font color="#CCCCCC">ways to</font><font color="#E5E5E5"> for example</font><font color="#CCCCCC"> to bypass the</font>

338
00:15:44,050 --> 00:15:48,810
execution<font color="#CCCCCC"> policy or to</font><font color="#E5E5E5"> lunch believer by</font>

339
00:15:46,930 --> 00:15:51,609
PowerShell ISE<font color="#E5E5E5"> of a</font><font color="#CCCCCC"> PowerShell and</font>

340
00:15:48,810 --> 00:15:54,459
either to launch the payload<font color="#E5E5E5"> and open</font>

341
00:15:51,610 --> 00:15:57,670
and<font color="#E5E5E5"> close o on user click</font><font color="#CCCCCC"> which</font><font color="#E5E5E5"> just</font>

342
00:15:54,460 --> 00:16:00,900
<font color="#E5E5E5">creates a link in the document and that</font>

343
00:15:57,670 --> 00:16:03,310
will trigger<font color="#E5E5E5"> it so those are the</font><font color="#CCCCCC"> options</font>

344
00:16:00,900 --> 00:16:05,740
<font color="#CCCCCC">those are the potential hosts for the</font>

345
00:16:03,310 --> 00:16:08,500
PowerShell script and you can bypass

346
00:16:05,740 --> 00:16:11,529
actually execute policy as I said and a

347
00:16:08,500 --> 00:16:13,390
nice<font color="#E5E5E5"> thing I added</font><font color="#CCCCCC"> just recently is the</font>

348
00:16:11,529 --> 00:16:16,540
option<font color="#E5E5E5"> to embed an object in the</font>

349
00:16:13,390 --> 00:16:18,760
document so<font color="#E5E5E5"> this</font><font color="#CCCCCC"> MSS sorry this setting</font>

350
00:16:16,540 --> 00:16:21,790
content<font color="#CCCCCC"> MS ping</font><font color="#E5E5E5"> which was quite popular</font>

351
00:16:18,760 --> 00:16:23,939
<font color="#CCCCCC">for the last</font><font color="#E5E5E5"> couple of months well it</font>

352
00:16:21,790 --> 00:16:27,130
generates<font color="#E5E5E5"> just another permutation of</font>

353
00:16:23,940 --> 00:16:29,560
the of those traits with<font color="#CCCCCC"> just being</font>

354
00:16:27,130 --> 00:16:31,779
<font color="#E5E5E5">embedded inside</font><font color="#CCCCCC"> it is really easy to do</font>

355
00:16:29,560 --> 00:16:35,500
<font color="#E5E5E5">this kind of stuff since it is written</font>

356
00:16:31,779 --> 00:16:37,510
in object-oriented way<font color="#E5E5E5"> it it is</font>

357
00:16:35,500 --> 00:16:41,920
<font color="#E5E5E5">available online</font><font color="#CCCCCC"> we were able</font><font color="#E5E5E5"> to see it</font>

358
00:16:37,510 --> 00:16:44,830
of course<font color="#E5E5E5"> and it is really</font><font color="#CCCCCC"> easy to add</font>

359
00:16:41,920 --> 00:16:47,650
this kind<font color="#CCCCCC"> of stuff inside</font><font color="#E5E5E5"> and once you</font>

360
00:16:44,830 --> 00:16:49,540
do it you<font color="#CCCCCC"> just click on a button</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font>

361
00:16:47,650 --> 00:16:53,110
<font color="#E5E5E5">get all the results</font><font color="#CCCCCC"> they're actually two</font>

362
00:16:49,540 --> 00:16:55,120
different modes<font color="#E5E5E5"> to</font><font color="#CCCCCC"> this you</font><font color="#E5E5E5"> have a</font>

363
00:16:53,110 --> 00:16:57,370
<font color="#E5E5E5">manual mode where you</font><font color="#CCCCCC"> select all of</font>

364
00:16:55,120 --> 00:16:59,380
those traits manually and you have an

365
00:16:57,370 --> 00:17:02,550
automatic<font color="#E5E5E5"> mode</font><font color="#CCCCCC"> now are you</font><font color="#E5E5E5"> just like</font>

366
00:16:59,380 --> 00:17:05,619
press a<font color="#E5E5E5"> single key you have 13 different</font>

367
00:17:02,550 --> 00:17:07,720
combinations of traits which is really

368
00:17:05,619 --> 00:17:10,329
<font color="#CCCCCC">easy because you don't need</font><font color="#E5E5E5"> to manually</font>

369
00:17:07,720 --> 00:17:13,300
edit<font color="#CCCCCC"> the</font><font color="#E5E5E5"> VBA code anymore</font><font color="#CCCCCC"> you just like</font>

370
00:17:10,329 --> 00:17:15,760
press on<font color="#E5E5E5"> just</font><font color="#CCCCCC"> Auto exploit button and</font>

371
00:17:13,300 --> 00:17:19,240
you get tons of different<font color="#CCCCCC"> variations of</font>

372
00:17:15,760 --> 00:17:20,199
this malicious document and<font color="#E5E5E5"> I'm lazy I</font>

373
00:17:19,240 --> 00:17:22,150
<font color="#E5E5E5">really like it</font>

374
00:17:20,199 --> 00:17:25,810
it<font color="#E5E5E5"> really saved me time in my daily life</font>

375
00:17:22,150 --> 00:17:26,720
<font color="#E5E5E5">so</font><font color="#CCCCCC"> a little demonstration of</font><font color="#E5E5E5"> how</font><font color="#CCCCCC"> it</font>

376
00:17:25,810 --> 00:17:28,458
works

377
00:17:26,720 --> 00:17:32,030
this is me<font color="#E5E5E5"> actually executing</font><font color="#CCCCCC"> invoke</font>

378
00:17:28,459 --> 00:17:36,470
<font color="#CCCCCC">Michelle I give it a path to the payload</font>

379
00:17:32,030 --> 00:17:39,649
<font color="#CCCCCC">a mode which is manual to actually enter</font>

380
00:17:36,470 --> 00:17:44,000
my traits manually and<font color="#E5E5E5"> the text to lure</font>

381
00:17:39,650 --> 00:17:48,980
the victim<font color="#E5E5E5"> click me nothing that complex</font>

382
00:17:44,000 --> 00:17:52,159
<font color="#E5E5E5">and my movie will now print the banner</font>

383
00:17:48,980 --> 00:17:54,669
and awesome banner of a invoke<font color="#CCCCCC"> no shell</font>

384
00:17:52,159 --> 00:17:58,190
<font color="#E5E5E5">which is just like</font><font color="#CCCCCC"> a shirt a shell and</font>

385
00:17:54,669 --> 00:18:00,860
<font color="#E5E5E5">no and now I just</font><font color="#CCCCCC"> like select -</font><font color="#E5E5E5"> and</font>

386
00:17:58,190 --> 00:18:01,460
which is on document<font color="#E5E5E5"> clothes launch the</font>

387
00:18:00,860 --> 00:18:03,289
payload

388
00:18:01,460 --> 00:18:05,450
<font color="#E5E5E5">I want to force execution if it is</font>

389
00:18:03,289 --> 00:18:09,110
restricted and I want to use PowerShell

390
00:18:05,450 --> 00:18:09,500
ISE as the host<font color="#E5E5E5"> of</font><font color="#CCCCCC"> a script</font><font color="#E5E5E5"> it is that</font>

391
00:18:09,110 --> 00:18:10,760
easy

392
00:18:09,500 --> 00:18:13,789
I don't need<font color="#E5E5E5"> to edit any VBA code</font>

393
00:18:10,760 --> 00:18:16,100
<font color="#E5E5E5">anymore you can just like take to your</font>

394
00:18:13,789 --> 00:18:18,559
payload of choice and embed it<font color="#E5E5E5"> in a</font>

395
00:18:16,100 --> 00:18:24,158
document<font color="#CCCCCC"> without messing around with</font>

396
00:18:18,559 --> 00:18:27,440
actually writing the VBA<font color="#E5E5E5"> and</font><font color="#CCCCCC"> we're done</font>

397
00:18:24,159 --> 00:18:30,710
on the<font color="#E5E5E5"> other hand you can also use it in</font>

398
00:18:27,440 --> 00:18:32,870
<font color="#CCCCCC">the automatic mode</font><font color="#E5E5E5"> this is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> auto mode</font>

399
00:18:30,710 --> 00:18:35,510
I even don't use any<font color="#E5E5E5"> arguments here like</font>

400
00:18:32,870 --> 00:18:38,178
in the<font color="#E5E5E5"> last movie I just</font><font color="#CCCCCC"> like insert</font>

401
00:18:35,510 --> 00:18:41,179
them by hand<font color="#E5E5E5"> it will</font><font color="#CCCCCC"> ask me questions to</font>

402
00:18:38,179 --> 00:18:44,090
get<font color="#E5E5E5"> like the payload path and the lure</font>

403
00:18:41,179 --> 00:18:45,890
text and all the other stuff<font color="#E5E5E5"> and then</font>

404
00:18:44,090 --> 00:18:48,799
well yeah

405
00:18:45,890 --> 00:18:53,539
you can see I have a typo<font color="#CCCCCC"> here</font><font color="#E5E5E5"> and then</font>

406
00:18:48,799 --> 00:18:58,340
I'll put it in and again like each me in

407
00:18:53,539 --> 00:19:00,950
this case because<font color="#CCCCCC"> why not</font><font color="#E5E5E5"> and auto mode</font>

408
00:18:58,340 --> 00:19:05,178
<font color="#CCCCCC">and then instead</font><font color="#E5E5E5"> of asking me which</font>

409
00:19:00,950 --> 00:19:07,720
trades I want to add to<font color="#E5E5E5"> my it will just</font>

410
00:19:05,179 --> 00:19:10,100
like generate<font color="#E5E5E5"> everything</font><font color="#CCCCCC"> oh sorry yeah</font>

411
00:19:07,720 --> 00:19:15,770
it's not that man<font color="#E5E5E5"> that matter really</font>

412
00:19:10,100 --> 00:19:17,658
<font color="#E5E5E5">much it's just like sorry it will just</font>

413
00:19:15,770 --> 00:19:19,580
like generate after<font color="#E5E5E5"> five minutes</font><font color="#CCCCCC"> all of</font>

414
00:19:17,659 --> 00:19:25,760
those different documents which is

415
00:19:19,580 --> 00:19:27,230
awesome<font color="#CCCCCC"> ok and you can see it's me</font><font color="#E5E5E5"> it's</font>

416
00:19:25,760 --> 00:19:32,809
not<font color="#E5E5E5"> really surprising</font><font color="#CCCCCC"> and I</font><font color="#E5E5E5"> even</font>

417
00:19:27,230 --> 00:19:34,820
commented the<font color="#E5E5E5"> VBA code it generates yeah</font>

418
00:19:32,809 --> 00:19:40,820
<font color="#E5E5E5">awesome</font>

419
00:19:34,820 --> 00:19:43,429
so it<font color="#CCCCCC"> even</font><font color="#E5E5E5"> commented and well you can</font>

420
00:19:40,820 --> 00:19:45,560
really<font color="#CCCCCC"> enjoy an edited and we've seen</font>

421
00:19:43,430 --> 00:19:47,990
the motivation for using<font color="#E5E5E5"> it so far we've</font>

422
00:19:45,560 --> 00:19:50,360
<font color="#CCCCCC">seen like how it works and let's speak</font>

423
00:19:47,990 --> 00:19:54,620
<font color="#CCCCCC">about the the results I did a quick test</font>

424
00:19:50,360 --> 00:19:57,139
whether it works or not<font color="#CCCCCC"> I use the</font>

425
00:19:54,620 --> 00:19:59,840
payload which is the satin<font color="#E5E5E5"> on somewhere</font>

426
00:19:57,140 --> 00:20:01,820
just like<font color="#CCCCCC"> Reddit as a stream</font><font color="#E5E5E5"> of bytes</font>

427
00:19:59,840 --> 00:20:05,679
I used invoke reflective injection<font color="#E5E5E5"> which</font>

428
00:20:01,820 --> 00:20:08,030
is really<font color="#E5E5E5"> popular thing and I just</font><font color="#CCCCCC"> like</font>

429
00:20:05,680 --> 00:20:10,400
injected the<font color="#E5E5E5"> shell code to</font><font color="#CCCCCC"> insert it</font>

430
00:20:08,030 --> 00:20:13,310
used as a payload nothing too fancy or

431
00:20:10,400 --> 00:20:16,610
local even I didn't use like base64

432
00:20:13,310 --> 00:20:17,870
encoding really simple stuff<font color="#CCCCCC"> I generated</font>

433
00:20:16,610 --> 00:20:21,199
13 different documents

434
00:20:17,870 --> 00:20:22,850
the victim was Windows 10 64 bit<font color="#CCCCCC"> five</font>

435
00:20:21,200 --> 00:20:25,670
<font color="#CCCCCC">popular and</font><font color="#E5E5E5"> the Friday if it's often</font>

436
00:20:22,850 --> 00:20:28,040
including<font color="#E5E5E5"> next-gen AVS</font>

437
00:20:25,670 --> 00:20:29,450
which is just another<font color="#E5E5E5"> AV some of them</font>

438
00:20:28,040 --> 00:20:32,960
<font color="#CCCCCC">are really good</font><font color="#E5E5E5"> but it is just another</font>

439
00:20:29,450 --> 00:20:35,360
AV and they were fully enabled fully

440
00:20:32,960 --> 00:20:39,560
capable enterprise scale<font color="#E5E5E5"> enterprise</font>

441
00:20:35,360 --> 00:20:42,889
great and well it's time for<font color="#E5E5E5"> checking if</font>

442
00:20:39,560 --> 00:20:44,600
we've<font color="#E5E5E5"> had great success or not</font><font color="#CCCCCC"> I define</font>

443
00:20:42,890 --> 00:20:45,580
the<font color="#CCCCCC"> success criterion which is kind of</font>

444
00:20:44,600 --> 00:20:48,709
awkward

445
00:20:45,580 --> 00:20:52,460
I want at least one<font color="#E5E5E5"> of</font><font color="#CCCCCC"> my payloads to</font>

446
00:20:48,710 --> 00:20:54,560
<font color="#E5E5E5">actually bypass the AV and at least one</font>

447
00:20:52,460 --> 00:20:56,870
to fail because<font color="#E5E5E5"> if all the payloads</font>

448
00:20:54,560 --> 00:20:58,490
bypass the AV when were<font color="#E5E5E5"> to is worthless</font>

449
00:20:56,870 --> 00:21:00,139
<font color="#E5E5E5">because the AV is worthless and</font><font color="#CCCCCC"> you</font>

450
00:20:58,490 --> 00:21:03,410
don't need<font color="#CCCCCC"> a tool to bypass the AV and</font>

451
00:21:00,140 --> 00:21:06,650
if all failed<font color="#E5E5E5"> the AV is</font><font color="#CCCCCC"> goodbye</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> 'lest</font>

452
00:21:03,410 --> 00:21:10,580
worthless so thankfully I had a hundred

453
00:21:06,650 --> 00:21:12,110
percent success radio<font color="#E5E5E5"> out of those in</font>

454
00:21:10,580 --> 00:21:15,020
<font color="#CCCCCC">forty</font><font color="#E5E5E5"> percent of the cases</font>

455
00:21:12,110 --> 00:21:17,300
actually all the pedals<font color="#CCCCCC"> bypassed</font><font color="#E5E5E5"> AV</font>

456
00:21:15,020 --> 00:21:20,560
which is kind of<font color="#CCCCCC"> awkward but in sixty</font>

457
00:21:17,300 --> 00:21:23,210
percent<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the cases my tool was useful</font>

458
00:21:20,560 --> 00:21:27,919
so I think I<font color="#E5E5E5"> can get the check nodes</font>

459
00:21:23,210 --> 00:21:29,210
<font color="#E5E5E5">approved and</font><font color="#CCCCCC"> seal and since we're kind</font>

460
00:21:27,920 --> 00:21:33,320
<font color="#E5E5E5">of running out of time let's go to the</font>

461
00:21:29,210 --> 00:21:36,620
<font color="#E5E5E5">takeaways well for red teamers use this</font>

462
00:21:33,320 --> 00:21:39,740
<font color="#E5E5E5">to work in scale effectively adopt new</font>

463
00:21:36,620 --> 00:21:42,020
techniques really<font color="#E5E5E5"> fast take it in and</font>

464
00:21:39,740 --> 00:21:44,060
use it<font color="#E5E5E5"> without messing around if</font><font color="#CCCCCC"> your</font>

465
00:21:42,020 --> 00:21:46,550
<font color="#CCCCCC">vba is just like take a</font><font color="#E5E5E5"> powershell</font>

466
00:21:44,060 --> 00:21:47,990
payload launch it without power shell

467
00:21:46,550 --> 00:21:50,480
and

468
00:21:47,990 --> 00:21:52,879
do it in no<font color="#CCCCCC"> time it is</font><font color="#E5E5E5"> really easy to</font>

469
00:21:50,480 --> 00:21:55,879
<font color="#E5E5E5">use</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> need no prerequisites just get</font>

470
00:21:52,879 --> 00:21:59,269
clone and even copy the raw<font color="#CCCCCC"> powershell</font>

471
00:21:55,879 --> 00:22:01,178
script<font color="#E5E5E5"> it is really easy but I want blue</font>

472
00:21:59,269 --> 00:22:04,549
<font color="#CCCCCC">tears</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> to take something from here</font>

473
00:22:01,179 --> 00:22:07,999
don't<font color="#CCCCCC"> rely on this 100% satisfaction</font>

474
00:22:04,549 --> 00:22:09,559
guarantee promises of<font color="#CCCCCC"> the vendors test</font>

475
00:22:07,999 --> 00:22:12,649
it yourself<font color="#CCCCCC"> it is really easy</font><font color="#E5E5E5"> as a blue</font>

476
00:22:09,559 --> 00:22:15,110
team to create many malicious documents

477
00:22:12,649 --> 00:22:17,508
<font color="#CCCCCC">or malicious you can also just</font><font color="#E5E5E5"> like pop</font>

478
00:22:15,110 --> 00:22:19,459
cards I don't<font color="#CCCCCC"> know and to check</font><font color="#E5E5E5"> whether</font>

479
00:22:17,509 --> 00:22:21,950
<font color="#E5E5E5">or not the environment</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> limits</font>

480
00:22:19,460 --> 00:22:26,990
PowerShell<font color="#CCCCCC"> as they expect</font><font color="#E5E5E5"> don't rely on</font>

481
00:22:21,950 --> 00:22:30,529
those snake<font color="#CCCCCC"> all promises</font><font color="#E5E5E5"> it is yeah it</font>

482
00:22:26,990 --> 00:22:34,730
is it is<font color="#CCCCCC"> just</font><font color="#E5E5E5"> like no simply now don't</font>

483
00:22:30,529 --> 00:22:36,710
do it<font color="#E5E5E5"> and without further ado we'll go</font>

484
00:22:34,730 --> 00:22:39,110
to the Q&A session that this is<font color="#CCCCCC"> the cat</font>

485
00:22:36,710 --> 00:22:42,159
I have a cat slide in every one<font color="#CCCCCC"> of my</font>

486
00:22:39,110 --> 00:22:45,110
talks<font color="#E5E5E5"> he looks at PowerShell on a Mac I</font>

487
00:22:42,159 --> 00:22:48,769
found<font color="#CCCCCC"> a stock photo online</font><font color="#E5E5E5"> I can't</font>

488
00:22:45,110 --> 00:22:52,279
explain it<font color="#CCCCCC"> I</font><font color="#E5E5E5"> I have literally no</font>

489
00:22:48,769 --> 00:22:57,110
explanation what the actual we have

490
00:22:52,279 --> 00:23:01,240
<font color="#E5E5E5">streamed so</font><font color="#CCCCCC"> I am NOT gonna say and</font>

491
00:22:57,110 --> 00:23:01,240
I<font color="#E5E5E5"> think we can go to a</font><font color="#CCCCCC"> Q&A now</font>

492
00:23:01,350 --> 00:23:17,629
[Applause]

493
00:23:09,430 --> 00:23:20,990
no questions<font color="#CCCCCC"> in its</font><font color="#E5E5E5"> current version</font><font color="#CCCCCC"> is</font>

494
00:23:17,630 --> 00:23:23,960
there any anti sandbox or sandbox

495
00:23:20,990 --> 00:23:27,620
detection<font color="#E5E5E5"> built</font><font color="#CCCCCC"> in no</font><font color="#E5E5E5"> III didn't took</font>

496
00:23:23,960 --> 00:23:30,080
the like the measures<font color="#E5E5E5"> to</font><font color="#CCCCCC"> evade sandbox</font>

497
00:23:27,620 --> 00:23:32,570
or anything<font color="#CCCCCC"> which in</font><font color="#E5E5E5"> my understanding</font>

498
00:23:30,080 --> 00:23:34,040
<font color="#E5E5E5">should be done by the payload itself</font><font color="#CCCCCC"> I</font>

499
00:23:32,570 --> 00:23:37,639
tried to clip it keep it as clean<font color="#CCCCCC"> as</font>

500
00:23:34,040 --> 00:23:39,889
possible<font color="#E5E5E5"> with nothing like malicious you</font>

501
00:23:37,640 --> 00:23:42,850
might say in my framework<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> really</font>

502
00:23:39,890 --> 00:23:42,850
easy to<font color="#CCCCCC"> add this kind of stuff</font>

503
00:23:49,480 --> 00:23:55,899
as it stands with this<font color="#E5E5E5"> module could</font><font color="#CCCCCC"> you</font>

504
00:23:52,330 --> 00:23:57,840
create an executable<font color="#CCCCCC"> that can run on</font><font color="#E5E5E5"> its</font>

505
00:23:55,899 --> 00:24:02,529
own<font color="#CCCCCC"> or is it just</font><font color="#E5E5E5"> for creating the the</font>

506
00:23:57,840 --> 00:24:04,269
<font color="#E5E5E5">documents</font><font color="#CCCCCC"> that contain the payload it in</font>

507
00:24:02,529 --> 00:24:06,940
this<font color="#E5E5E5"> stage it actually creates only a</font>

508
00:24:04,269 --> 00:24:10,120
document of the payload but<font color="#E5E5E5"> you can do</font>

509
00:24:06,940 --> 00:24:11,769
<font color="#E5E5E5">anything in</font><font color="#CCCCCC"> this like style - you're</font>

510
00:24:10,120 --> 00:24:13,539
talking<font color="#CCCCCC"> about</font><font color="#E5E5E5"> like</font><font color="#CCCCCC"> taking an executable</font>

511
00:24:11,769 --> 00:24:15,909
to launch<font color="#E5E5E5"> the</font><font color="#CCCCCC"> PowerShell using</font>

512
00:24:13,539 --> 00:24:19,799
PowerShell I see it is really<font color="#CCCCCC"> easy yeah</font>

513
00:24:15,909 --> 00:24:19,799
<font color="#E5E5E5">you should do it</font><font color="#CCCCCC"> in no time I trust you</font>

514
00:24:25,529 --> 00:24:33,899
so I got the the malicious content in

515
00:24:29,200 --> 00:24:37,120
<font color="#CCCCCC">that</font><font color="#E5E5E5"> word document was that BBS</font><font color="#CCCCCC"> no</font>

516
00:24:33,899 --> 00:24:40,239
actually<font color="#E5E5E5"> it's VBA like the macro itself</font>

517
00:24:37,120 --> 00:24:42,610
<font color="#E5E5E5">is VBA</font><font color="#CCCCCC"> and it holds</font><font color="#E5E5E5"> all of the payload</font>

518
00:24:40,240 --> 00:24:44,830
<font color="#E5E5E5">as lines actual text lines inside the</font>

519
00:24:42,610 --> 00:24:47,080
macro code<font color="#CCCCCC"> okay and it just</font><font color="#E5E5E5"> like</font>

520
00:24:44,830 --> 00:24:49,149
<font color="#E5E5E5">concatenates it and in my</font><font color="#CCCCCC"> case</font><font color="#E5E5E5"> it in</font>

521
00:24:47,080 --> 00:24:51,610
some of the scenarios<font color="#CCCCCC"> it</font><font color="#E5E5E5"> actually writes</font>

522
00:24:49,149 --> 00:24:53,879
it to<font color="#E5E5E5"> the disk so it is not</font><font color="#CCCCCC"> file s but</font>

523
00:24:51,610 --> 00:24:56,320
who cares it bypasses all of the<font color="#E5E5E5"> Avs</font>

524
00:24:53,880 --> 00:24:59,200
interestingly there's a limitation<font color="#CCCCCC"> in</font>

525
00:24:56,320 --> 00:25:01,899
VBA<font color="#CCCCCC"> you can't exceed a thousand 24</font>

526
00:24:59,200 --> 00:25:04,000
characters in VBA line which is<font color="#E5E5E5"> very</font>

527
00:25:01,899 --> 00:25:06,610
annoying<font color="#E5E5E5"> it limits your payload and also</font>

528
00:25:04,000 --> 00:25:08,440
you can't use non ASCII characters<font color="#E5E5E5"> it's</font>

529
00:25:06,610 --> 00:25:11,529
also kind<font color="#E5E5E5"> of suck but my tool actually</font>

530
00:25:08,440 --> 00:25:12,880
checks that it checks<font color="#E5E5E5"> it prior</font><font color="#CCCCCC"> to the</font>

531
00:25:11,529 --> 00:25:16,000
creation<font color="#CCCCCC"> of the payload and it will</font>

532
00:25:12,880 --> 00:25:18,789
alert you<font color="#E5E5E5"> if you broken the VBA</font><font color="#CCCCCC"> and did</font>

533
00:25:16,000 --> 00:25:21,419
you<font color="#CCCCCC"> build this tool in c-sharp no it is</font>

534
00:25:18,789 --> 00:25:25,779
<font color="#CCCCCC">funny PowerShell okay I cannot regret it</font>

535
00:25:21,419 --> 00:25:28,330
<font color="#CCCCCC">right but it is kind of</font><font color="#E5E5E5"> well well</font><font color="#CCCCCC"> well</font>

536
00:25:25,779 --> 00:25:30,880
coded<font color="#E5E5E5"> and documented you can have a look</font>

537
00:25:28,330 --> 00:25:33,210
<font color="#E5E5E5">it</font><font color="#CCCCCC"> is good if you</font><font color="#E5E5E5"> have questions feel</font>

538
00:25:30,880 --> 00:25:33,210
free to ask

539
00:25:39,120 --> 00:25:44,918
hello<font color="#E5E5E5"> hi this</font><font color="#CCCCCC"> is pretty</font><font color="#E5E5E5"> red-eye</font>

540
00:25:42,490 --> 00:25:50,080
I work as a blue<font color="#CCCCCC"> Timur</font><font color="#E5E5E5"> and this makes</font><font color="#CCCCCC"> me</font>

541
00:25:44,919 --> 00:25:52,710
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> red team had a question you</font>

542
00:25:50,080 --> 00:25:54,370
tested a infomercial against a number of

543
00:25:52,710 --> 00:25:57,309
antivirus utilities

544
00:25:54,370 --> 00:25:58,570
did you try against any like<font color="#E5E5E5"> EDR</font>

545
00:25:57,309 --> 00:25:59,168
solutions like current black or

546
00:25:58,570 --> 00:26:02,049
otherwise

547
00:25:59,169 --> 00:26:03,669
well carbon black no I didn't try<font color="#CCCCCC"> it</font>

548
00:26:02,049 --> 00:26:05,769
specifically<font color="#E5E5E5"> against</font><font color="#CCCCCC"> carbon black also</font>

549
00:26:03,669 --> 00:26:08,110
I'm not<font color="#E5E5E5"> sure if I'm like allowed legally</font>

550
00:26:05,769 --> 00:26:10,600
to say<font color="#E5E5E5"> exactly against who I said it but</font>

551
00:26:08,110 --> 00:26:12,519
it wasn't<font color="#E5E5E5"> carbon black but cover black</font>

552
00:26:10,600 --> 00:26:14,678
may alert like other<font color="#CCCCCC"> EDR solutions</font><font color="#E5E5E5"> on</font>

553
00:26:12,519 --> 00:26:16,629
<font color="#E5E5E5">its kind</font><font color="#CCCCCC"> stuff but easier solutions kind</font>

554
00:26:14,679 --> 00:26:18,519
of<font color="#CCCCCC"> alert on anything and</font><font color="#E5E5E5"> as a blue Timur</font>

555
00:26:16,629 --> 00:26:23,019
I think you can kind of I'm very<font color="#CCCCCC"> where</font>

556
00:26:18,519 --> 00:26:31,000
yeah yeah<font color="#E5E5E5"> alert alert is just like log</font>

557
00:26:23,019 --> 00:26:32,169
in this<font color="#E5E5E5"> case I guess hi</font>

558
00:26:31,000 --> 00:26:34,000
so when you were testing a different

559
00:26:32,169 --> 00:26:35,019
combinations against different<font color="#E5E5E5"> AV did</font>

560
00:26:34,000 --> 00:26:36,669
you find that there were some

561
00:26:35,019 --> 00:26:38,740
combinations<font color="#CCCCCC"> that were working across</font>

562
00:26:36,669 --> 00:26:40,929
<font color="#E5E5E5">the board more often yeah not yeah okay</font>

563
00:26:38,740 --> 00:26:43,000
<font color="#E5E5E5">and is that is that information</font>

564
00:26:40,929 --> 00:26:45,399
<font color="#CCCCCC">documented</font><font color="#E5E5E5"> or is there any if we word I</font>

565
00:26:43,000 --> 00:26:47,980
can tell you right now<font color="#CCCCCC"> it was the case</font>

566
00:26:45,399 --> 00:26:50,229
<font color="#E5E5E5">of using PowerShell ISE and launching it</font>

567
00:26:47,980 --> 00:26:52,960
<font color="#E5E5E5">on a user click you</font><font color="#CCCCCC"> can actually write</font>

568
00:26:50,230 --> 00:26:56,230
the<font color="#E5E5E5"> payload to</font><font color="#CCCCCC"> the disk and to launch</font>

569
00:26:52,960 --> 00:26:58,809
<font color="#E5E5E5">power shall I see from user click</font><font color="#CCCCCC"> on</font>

570
00:26:56,230 --> 00:27:02,110
document and then<font color="#E5E5E5"> you avoid using shell</font>

571
00:26:58,809 --> 00:27:05,049
execute you avoid like using<font color="#E5E5E5"> FileZilla</font>

572
00:27:02,110 --> 00:27:07,178
<font color="#E5E5E5">taxi and well they just don't get you so</font>

573
00:27:05,049 --> 00:27:10,120
cool<font color="#E5E5E5"> thanks yeah that's the</font><font color="#CCCCCC"> Magic Bullet</font>

574
00:27:07,179 --> 00:27:12,330
<font color="#CCCCCC">I think we can probably</font><font color="#E5E5E5"> take</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> more</font>

575
00:27:10,120 --> 00:27:12,330
question

576
00:27:17,010 --> 00:27:20,750
normally<font color="#CCCCCC"> thank him</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> was fine</font>

577
00:27:22,340 --> 00:27:26,730
[Applause]

