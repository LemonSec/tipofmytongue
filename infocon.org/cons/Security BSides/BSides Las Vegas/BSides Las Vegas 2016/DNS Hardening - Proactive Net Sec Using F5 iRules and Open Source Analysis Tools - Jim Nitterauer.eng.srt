1
00:00:00,030 --> 00:00:04,710
<font color="#E5E5E5">all right hi everyone and welcome</font><font color="#CCCCCC"> to</font>

2
00:00:02,040 --> 00:00:07,290
proving grounds<font color="#E5E5E5"> so I'd like to start out</font>

3
00:00:04,710 --> 00:00:10,460
<font color="#CCCCCC">by thanking</font><font color="#E5E5E5"> our sponsors especially our</font>

4
00:00:07,290 --> 00:00:13,820
stellar sponsors<font color="#E5E5E5"> verse</font><font color="#CCCCCC"> bright / tippity</font>

5
00:00:10,460 --> 00:00:16,350
tenable<font color="#E5E5E5"> Amazon and source of knowledge</font>

6
00:00:13,820 --> 00:00:19,560
<font color="#E5E5E5">so this track is being recorded and</font>

7
00:00:16,350 --> 00:00:21,689
we're also<font color="#E5E5E5"> streaming at the end we're</font>

8
00:00:19,560 --> 00:00:23,279
going<font color="#E5E5E5"> to have</font><font color="#CCCCCC"> a Q&A session and I'll be</font>

9
00:00:21,689 --> 00:00:26,160
<font color="#E5E5E5">running the mic around so just please</font>

10
00:00:23,279 --> 00:00:29,099
bear with me<font color="#E5E5E5"> and wait for the mic our</font>

11
00:00:26,160 --> 00:00:32,189
next talk<font color="#CCCCCC"> is on</font><font color="#E5E5E5"> DNS hardening proactive</font>

12
00:00:29,099 --> 00:00:35,309
<font color="#E5E5E5">network security using f5 I rules and</font>

13
00:00:32,189 --> 00:00:41,879
open source<font color="#E5E5E5"> and now analysis tools from</font>

14
00:00:35,309 --> 00:00:44,760
Jim knitter our awesome<font color="#CCCCCC"> friend all</font><font color="#E5E5E5"> right</font>

15
00:00:41,879 --> 00:00:47,789
<font color="#E5E5E5">what's uh Jim</font><font color="#CCCCCC"> marks is a</font><font color="#E5E5E5"> senior systems</font>

16
00:00:44,760 --> 00:01:07,650
<font color="#E5E5E5">administrator at a Kroger</font><font color="#CCCCCC"> please</font><font color="#E5E5E5"> join me</font>

17
00:00:47,789 --> 00:01:09,840
in<font color="#E5E5E5"> welcoming Jim 2006 first I want to</font>

18
00:01:07,650 --> 00:01:11,310
<font color="#E5E5E5">thank</font><font color="#CCCCCC"> my mentor Dave Willis</font><font color="#E5E5E5"> back there</font>

19
00:01:09,840 --> 00:01:12,810
thank you for your help<font color="#E5E5E5"> assistance I</font>

20
00:01:11,310 --> 00:01:16,130
appreciate it and I want<font color="#E5E5E5"> to thank</font>

21
00:01:12,810 --> 00:01:16,130
besides for everybody

22
00:01:21,110 --> 00:01:28,409
<font color="#CCCCCC">all right see if this works all right so</font>

23
00:01:26,400 --> 00:01:31,560
a little<font color="#CCCCCC"> bit</font><font color="#E5E5E5"> about me how did I get here</font>

24
00:01:28,409 --> 00:01:33,000
<font color="#CCCCCC">I</font><font color="#E5E5E5"> wanted all the</font><font color="#CCCCCC"> time 20:15 sitting</font>

25
00:01:31,560 --> 00:01:34,860
around<font color="#CCCCCC"> coffee teaching people about a</font>

26
00:01:33,000 --> 00:01:37,380
few<font color="#E5E5E5"> things that I was</font><font color="#CCCCCC"> really</font><font color="#E5E5E5"> at</font><font color="#CCCCCC"> River</font><font color="#E5E5E5"> a</font>

27
00:01:34,860 --> 00:01:39,000
couple of<font color="#E5E5E5"> guys</font><font color="#CCCCCC"> that were heard me</font><font color="#E5E5E5"> this</font>

28
00:01:37,380 --> 00:01:41,360
says here<font color="#E5E5E5"> and they said why don't you</font>

29
00:01:39,000 --> 00:01:43,320
<font color="#E5E5E5">come speak at our next event about</font>

30
00:01:41,360 --> 00:01:44,580
apparently say a few things and<font color="#E5E5E5"> some</font>

31
00:01:43,320 --> 00:01:47,729
people<font color="#CCCCCC"> over</font><font color="#E5E5E5"> here</font><font color="#CCCCCC"> you're a security</font>

32
00:01:44,580 --> 00:01:50,369
<font color="#E5E5E5">expert so realistically I've been with a</font>

33
00:01:47,729 --> 00:01:52,560
career<font color="#E5E5E5"> Burgas since 2006 this</font>

34
00:01:50,369 --> 00:01:57,810
certificate<font color="#E5E5E5"> is not mine</font><font color="#CCCCCC"> - my name is Jim</font>

35
00:01:52,560 --> 00:02:00,300
Jack<font color="#E5E5E5"> when I</font><font color="#CCCCCC"> came that</font><font color="#E5E5E5"> River in 2006 I</font>

36
00:01:57,810 --> 00:02:02,009
<font color="#CCCCCC">started out on their</font><font color="#E5E5E5"> security team right</font>

37
00:02:00,300 --> 00:02:04,110
<font color="#E5E5E5">now I'm in charge of</font><font color="#CCCCCC"> running their</font>

38
00:02:02,009 --> 00:02:05,700
global<font color="#E5E5E5"> data centers worldwide we have 12</font>

39
00:02:04,110 --> 00:02:08,610
<font color="#CCCCCC">update starters you run all of</font><font color="#E5E5E5"> our</font>

40
00:02:05,700 --> 00:02:11,039
<font color="#E5E5E5">servers</font><font color="#CCCCCC"> out of the offices globally we</font>

41
00:02:08,610 --> 00:02:12,750
run<font color="#E5E5E5"> secure</font><font color="#CCCCCC"> tied with spam filtering</font>

42
00:02:11,038 --> 00:02:16,500
platform<font color="#E5E5E5"> minutes at</font><font color="#CCCCCC"> your server which is</font>

43
00:02:12,750 --> 00:02:18,150
a DNS filtering platform<font color="#E5E5E5"> the opinions</font>

44
00:02:16,500 --> 00:02:20,670
expressed here are not necessarily<font color="#E5E5E5"> those</font>

45
00:02:18,150 --> 00:02:22,290
of<font color="#CCCCCC"> my employer</font><font color="#E5E5E5"> they are mine my love if</font>

46
00:02:20,670 --> 00:02:25,230
you<font color="#E5E5E5"> have any trouble with</font><font color="#CCCCCC"> it come</font><font color="#E5E5E5"> after</font>

47
00:02:22,290 --> 00:02:28,650
me<font color="#CCCCCC"> all right so today</font><font color="#E5E5E5"> what I'm</font><font color="#CCCCCC"> going to</font>

48
00:02:25,230 --> 00:02:30,030
do I'm<font color="#CCCCCC"> gonna lay out</font><font color="#E5E5E5"> challenge what we</font>

49
00:02:28,650 --> 00:02:32,790
were<font color="#CCCCCC"> Facebook when</font><font color="#E5E5E5"> I was a story about</font>

50
00:02:30,030 --> 00:02:35,400
<font color="#E5E5E5">how</font><font color="#CCCCCC"> we went and put together a solution</font>

51
00:02:32,790 --> 00:02:37,380
<font color="#E5E5E5">to secure our DNS infrastructure and</font>

52
00:02:35,400 --> 00:02:39,870
when I'm focusing<font color="#E5E5E5"> on DNS era I'm talking</font>

53
00:02:37,380 --> 00:02:41,820
about<font color="#E5E5E5"> our secure Afghanistan</font><font color="#CCCCCC"> structure</font>

54
00:02:39,870 --> 00:02:43,530
<font color="#CCCCCC">and just the</font><font color="#E5E5E5"> fact that it's an open just</font>

55
00:02:41,820 --> 00:02:45,120
think of it as<font color="#CCCCCC"> a DNS cache resolvers</font>

56
00:02:43,530 --> 00:02:47,130
<font color="#E5E5E5">don't worry about the</font><font color="#CCCCCC"> services</font><font color="#E5E5E5"> of the</font>

57
00:02:45,120 --> 00:02:48,690
<font color="#CCCCCC">members</font><font color="#E5E5E5"> office to your</font><font color="#CCCCCC"> ass</font><font color="#E5E5E5"> any of the</font>

58
00:02:47,130 --> 00:02:50,970
things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> I mentioned here</font><font color="#E5E5E5"> the</font>

59
00:02:48,690 --> 00:02:52,890
different<font color="#E5E5E5"> problem platforms</font>

60
00:02:50,970 --> 00:02:54,480
I'm not endorsing anyone we just<font color="#CCCCCC"> pick</font>

61
00:02:52,890 --> 00:02:57,079
them<font color="#E5E5E5"> when we use them</font><font color="#CCCCCC"> for our platforms</font>

62
00:02:54,480 --> 00:02:59,869
<font color="#CCCCCC">I'm not here</font><font color="#E5E5E5"> to say one</font><font color="#CCCCCC"> winter</font>

63
00:02:57,080 --> 00:03:01,730
just use what works<font color="#E5E5E5"> so I'm going to lay</font>

64
00:02:59,870 --> 00:03:03,290
<font color="#E5E5E5">out the challenge to be faced when</font>

65
00:03:01,730 --> 00:03:05,030
<font color="#CCCCCC">exactly some</font><font color="#E5E5E5"> of the security flaws that</font>

66
00:03:03,290 --> 00:03:06,769
<font color="#E5E5E5">we ran across when we brought on our</font>

67
00:03:05,030 --> 00:03:08,810
service<font color="#E5E5E5"> I'm going to look</font><font color="#CCCCCC"> at some</font><font color="#E5E5E5"> of the</font>

68
00:03:06,770 --> 00:03:11,570
tools<font color="#E5E5E5"> that we use</font><font color="#CCCCCC"> to solve</font><font color="#E5E5E5"> those</font>

69
00:03:08,810 --> 00:03:14,920
security tools are those<font color="#CCCCCC"> security I'm</font>

70
00:03:11,570 --> 00:03:14,920
going to assemble<font color="#E5E5E5"> those pieces in that</font>

71
00:03:15,550 --> 00:03:19,280
show you some of our<font color="#CCCCCC"> results</font><font color="#E5E5E5"> I'm going</font>

72
00:03:18,050 --> 00:03:21,200
<font color="#CCCCCC">to discuss</font><font color="#E5E5E5"> some of the future</font>

73
00:03:19,280 --> 00:03:22,790
<font color="#E5E5E5">possibilities that's a lot of 20 minutes</font>

74
00:03:21,200 --> 00:03:24,589
when I<font color="#CCCCCC"> go</font><font color="#E5E5E5"> through a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> detail</font><font color="#CCCCCC"> about</font>

75
00:03:22,790 --> 00:03:26,209
some<font color="#CCCCCC"> of this stuff</font><font color="#E5E5E5"> a little</font><font color="#CCCCCC"> bit later</font>

76
00:03:24,590 --> 00:03:29,150
after<font color="#E5E5E5"> the</font><font color="#CCCCCC"> talk</font><font color="#E5E5E5"> up with some more</font>

77
00:03:26,210 --> 00:03:31,850
technical blobs<font color="#CCCCCC"> at tripwire</font><font color="#E5E5E5"> and on the</font>

78
00:03:29,150 --> 00:03:33,890
peerless block so the person in federal

79
00:03:31,850 --> 00:03:35,900
<font color="#CCCCCC">basics</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> I came to that River they</font>

80
00:03:33,890 --> 00:03:38,390
had version one<font color="#CCCCCC"> of their</font><font color="#E5E5E5"> secure search</font>

81
00:03:35,900 --> 00:03:39,560
service they rolled it out the service

82
00:03:38,390 --> 00:03:41,690
did what it was supposed to<font color="#E5E5E5"> do a</font>

83
00:03:39,560 --> 00:03:44,209
<font color="#CCCCCC">security or DNS</font><font color="#E5E5E5"> problem was it took</font>

84
00:03:41,690 --> 00:03:46,670
about<font color="#E5E5E5"> five hundred thousand milliseconds</font>

85
00:03:44,209 --> 00:03:48,680
to resolve DNS queries so if you really

86
00:03:46,670 --> 00:03:50,630
<font color="#E5E5E5">like</font><font color="#CCCCCC"> to be nice slow</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> worked well</font>

87
00:03:48,680 --> 00:03:52,400
that didn't<font color="#CCCCCC"> work too well so they</font>

88
00:03:50,630 --> 00:03:54,290
started from scratch<font color="#E5E5E5"> and</font><font color="#CCCCCC"> rewrote</font><font color="#E5E5E5"> the</font>

89
00:03:52,400 --> 00:03:55,970
whole<font color="#E5E5E5"> service when I came on board</font><font color="#CCCCCC"> they</font>

90
00:03:54,290 --> 00:03:58,940
were about to roll out<font color="#E5E5E5"> the service of</font>

91
00:03:55,970 --> 00:04:00,380
<font color="#E5E5E5">the second time and what we ended up</font>

92
00:03:58,940 --> 00:04:02,510
<font color="#E5E5E5">finding out the minute we rolled out the</font>

93
00:04:00,380 --> 00:04:04,220
<font color="#E5E5E5">service was that when you put service</font>

94
00:04:02,510 --> 00:04:06,649
out<font color="#CCCCCC"> there that</font><font color="#E5E5E5"> anybody can connect to</font>

95
00:04:04,220 --> 00:04:11,209
you run into<font color="#E5E5E5"> all kinds</font><font color="#CCCCCC"> of problems right</font>

96
00:04:06,650 --> 00:04:12,850
so what they have up to in our<font color="#CCCCCC"> DNS</font>

97
00:04:11,209 --> 00:04:15,260
servers or DNS<font color="#E5E5E5"> service works at</font>

98
00:04:12,850 --> 00:04:17,180
application layer<font color="#E5E5E5"> seven obviously a lot</font>

99
00:04:15,260 --> 00:04:20,899
<font color="#CCCCCC">of</font><font color="#E5E5E5"> people will secure their das</font><font color="#CCCCCC"> add</font>

100
00:04:17,180 --> 00:04:22,970
layer so basically by setting rules we

101
00:04:20,899 --> 00:04:24,620
block IVs and only resolve<font color="#E5E5E5"> for certain</font>

102
00:04:22,970 --> 00:04:25,430
domains that sort of thing<font color="#CCCCCC"> but</font><font color="#E5E5E5"> we</font>

103
00:04:24,620 --> 00:04:27,060
couldn't do that

104
00:04:25,430 --> 00:04:30,600
we haven't work

105
00:04:27,060 --> 00:04:32,700
therefore layer 5 and later<font color="#E5E5E5"> seven so</font>

106
00:04:30,600 --> 00:04:34,680
what happens if you wait<font color="#E5E5E5"> to security NS</font>

107
00:04:32,700 --> 00:04:36,240
<font color="#E5E5E5">layer 7 again does something like</font><font color="#CCCCCC"> this</font>

108
00:04:34,680 --> 00:04:38,130
<font color="#CCCCCC">right</font><font color="#E5E5E5"> they're</font><font color="#CCCCCC"> going to blow up their DNS</font>

109
00:04:36,240 --> 00:04:39,419
servers there's so much traffic out

110
00:04:38,130 --> 00:04:41,490
there<font color="#E5E5E5"> there's so</font><font color="#CCCCCC"> much malicious traffic</font>

111
00:04:39,419 --> 00:04:44,070
<font color="#E5E5E5">you're not</font><font color="#CCCCCC"> going to be able to support</font>

112
00:04:41,490 --> 00:04:45,900
security<font color="#E5E5E5"> for that</font><font color="#CCCCCC"> platform</font><font color="#E5E5E5"> so what we</font>

113
00:04:44,070 --> 00:04:47,490
ended up<font color="#CCCCCC"> doing was</font><font color="#E5E5E5"> developing a plan to</font>

114
00:04:45,900 --> 00:04:49,679
figure<font color="#E5E5E5"> out how we can mitigate some of</font>

115
00:04:47,490 --> 00:04:52,260
<font color="#E5E5E5">the challenges without</font><font color="#CCCCCC"> closing at the</font>

116
00:04:49,680 --> 00:04:54,750
<font color="#CCCCCC">end we the</font><font color="#E5E5E5"> reason we didn't go with</font><font color="#CCCCCC"> a</font>

117
00:04:52,260 --> 00:04:56,159
wet list of IP based DNS services

118
00:04:54,750 --> 00:04:58,470
because some of our<font color="#CCCCCC"> customers are</font>

119
00:04:56,160 --> 00:05:00,390
<font color="#E5E5E5">actually remote</font><font color="#CCCCCC"> customers so they move</font>

120
00:04:58,470 --> 00:05:01,830
<font color="#CCCCCC">around they have dynamic IDs</font><font color="#E5E5E5"> for small</font>

121
00:05:00,390 --> 00:05:04,740
businesses they<font color="#CCCCCC"> don't just have a fixed</font>

122
00:05:01,830 --> 00:05:07,169
IP<font color="#E5E5E5"> they don't have to</font><font color="#CCCCCC"> log into a captain</font>

123
00:05:04,740 --> 00:05:09,030
<font color="#CCCCCC">or put in their IP address and</font><font color="#E5E5E5"> wait for</font>

124
00:05:07,169 --> 00:05:11,099
that<font color="#CCCCCC"> information to</font><font color="#E5E5E5"> be propagated</font><font color="#CCCCCC"> back</font>

125
00:05:09,030 --> 00:05:13,080
to the service<font color="#E5E5E5"> so what I'm going to go</font>

126
00:05:11,100 --> 00:05:15,150
over today's are the basically<font color="#CCCCCC"> the</font>

127
00:05:13,080 --> 00:05:16,320
security<font color="#E5E5E5"> flaws we found in</font><font color="#CCCCCC"> EMS</font><font color="#E5E5E5"> that</font>

128
00:05:15,150 --> 00:05:17,989
you've probably seen<font color="#E5E5E5"> your own</font>

129
00:05:16,320 --> 00:05:21,060
environment<font color="#CCCCCC"> and I'm going to</font><font color="#E5E5E5"> show you</font>

130
00:05:17,990 --> 00:05:22,800
how we went to solve those<font color="#E5E5E5"> problems</font><font color="#CCCCCC"> in</font>

131
00:05:21,060 --> 00:05:24,990
general detail if<font color="#E5E5E5"> you</font><font color="#CCCCCC"> want more</font>

132
00:05:22,800 --> 00:05:26,490
specifics feel free to come by now

133
00:05:24,990 --> 00:05:28,590
because<font color="#E5E5E5"> rest of the week of being at</font>

134
00:05:26,490 --> 00:05:30,510
that time the let's sit down<font color="#E5E5E5"> and go over</font>

135
00:05:28,590 --> 00:05:33,049
<font color="#E5E5E5">some specifics I'm not showing any live</font>

136
00:05:30,510 --> 00:05:33,050
demos today

137
00:05:33,570 --> 00:05:37,640
all right the first<font color="#E5E5E5"> thing we came across</font>

138
00:05:47,120 --> 00:05:52,590
right<font color="#CCCCCC"> so there</font><font color="#E5E5E5"> are an acquittal attack</font>

139
00:05:50,160 --> 00:05:54,750
or something<font color="#CCCCCC"> spooks</font><font color="#E5E5E5"> an IP address send</font>

140
00:05:52,590 --> 00:05:56,310
you a bunch<font color="#CCCCCC"> of small packets asking for</font>

141
00:05:54,750 --> 00:05:58,919
a bunch<font color="#E5E5E5"> of big packets and</font><font color="#CCCCCC"> sends them to</font>

142
00:05:56,310 --> 00:06:00,780
<font color="#CCCCCC">the spoofed IP address typically</font><font color="#E5E5E5"> by that</font>

143
00:05:58,919 --> 00:06:02,190
network<font color="#E5E5E5"> can rent time on them</font><font color="#CCCCCC"> we'll do</font>

144
00:06:00,780 --> 00:06:04,109
<font color="#E5E5E5">these to the tune there's several</font>

145
00:06:02,190 --> 00:06:07,020
hundred<font color="#E5E5E5"> thousand by that members over</font>

146
00:06:04,110 --> 00:06:09,360
the course of 15 20<font color="#E5E5E5"> minutes</font><font color="#CCCCCC"> of DNS</font><font color="#E5E5E5"> just</font>

147
00:06:07,020 --> 00:06:11,859
doesn't work<font color="#CCCCCC"> ok the NS applications</font>

148
00:06:09,360 --> 00:06:13,689
attacks are a big deal<font color="#CCCCCC"> really</font>

149
00:06:11,860 --> 00:06:14,860
<font color="#CCCCCC">bring us down</font><font color="#E5E5E5"> or make you look stupid</font>

150
00:06:13,689 --> 00:06:16,740
<font color="#E5E5E5">for participating</font>

151
00:06:14,860 --> 00:06:19,000
so you have to be careful about<font color="#E5E5E5"> these</font>

152
00:06:16,740 --> 00:06:21,340
the<font color="#E5E5E5"> next problem the</font><font color="#CCCCCC"> bases have an</font>

153
00:06:19,000 --> 00:06:23,680
interesting one we saw things<font color="#CCCCCC"> family</font>

154
00:06:21,340 --> 00:06:25,508
<font color="#E5E5E5">buyers</font><font color="#CCCCCC"> poultry company were very</font><font color="#E5E5E5"> aware</font>

155
00:06:23,680 --> 00:06:27,159
<font color="#E5E5E5">of what's</font><font color="#CCCCCC"> going on a botnet that</font><font color="#E5E5E5"> works</font>

156
00:06:25,509 --> 00:06:29,620
who's sending out spam for those sorts

157
00:06:27,159 --> 00:06:33,550
of things<font color="#E5E5E5"> but</font><font color="#CCCCCC"> we saw</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> RDS there's</font>

158
00:06:29,620 --> 00:06:35,889
a<font color="#CCCCCC"> atactic that the malware developers</font>

159
00:06:33,550 --> 00:06:38,199
use called the domain generation

160
00:06:35,889 --> 00:06:40,539
algorithms<font color="#CCCCCC"> what they do is that built</font>

161
00:06:38,199 --> 00:06:42,370
<font color="#E5E5E5">into their malware and they generate</font>

162
00:06:40,539 --> 00:06:44,830
these randomly generated domain names

163
00:06:42,370 --> 00:06:46,419
along<font color="#E5E5E5"> with</font><font color="#CCCCCC"> the domain names that are</font>

164
00:06:44,830 --> 00:06:48,460
real<font color="#CCCCCC"> and</font><font color="#E5E5E5"> connected</font><font color="#CCCCCC"> by that community</font>

165
00:06:46,419 --> 00:06:50,258
control networks<font color="#E5E5E5"> and they do this on</font><font color="#CCCCCC"> a</font>

166
00:06:48,460 --> 00:06:53,590
<font color="#E5E5E5">regular basis</font><font color="#CCCCCC"> so that</font><font color="#E5E5E5"> what they're</font>

167
00:06:50,259 --> 00:06:55,180
trying<font color="#CCCCCC"> to do is obviously they're really</font>

168
00:06:53,590 --> 00:06:57,549
an estimate<font color="#E5E5E5"> and control in this</font>

169
00:06:55,180 --> 00:07:00,219
<font color="#E5E5E5">scattered traffic well the problem is a</font>

170
00:06:57,550 --> 00:07:01,870
small<font color="#E5E5E5"> network you may never</font><font color="#CCCCCC"> see them</font><font color="#E5E5E5"> are</font>

171
00:07:00,219 --> 00:07:05,409
big<font color="#E5E5E5"> network like what we're doing</font><font color="#CCCCCC"> we're</font>

172
00:07:01,870 --> 00:07:07,960
doing<font color="#E5E5E5"> 60 70 80 thousand DNS queries a</font>

173
00:07:05,409 --> 00:07:09,699
second<font color="#E5E5E5"> our network these things become</font>

174
00:07:07,960 --> 00:07:13,090
problematic<font color="#E5E5E5"> because they generate the</font>

175
00:07:09,699 --> 00:07:15,039
<font color="#E5E5E5">ton and X domain lookups so your DNS</font>

176
00:07:13,090 --> 00:07:17,859
servers become very slow and<font color="#E5E5E5"> don't</font>

177
00:07:15,039 --> 00:07:21,818
respond very quickly<font color="#E5E5E5"> the third thing we</font>

178
00:07:17,860 --> 00:07:24,099
saw bad name queries<font color="#CCCCCC"> on our</font><font color="#E5E5E5"> DNS so</font>

179
00:07:21,819 --> 00:07:27,069
everybody here<font color="#E5E5E5"> through your</font><font color="#CCCCCC"> DNS</font><font color="#E5E5E5"> and</font>

180
00:07:24,099 --> 00:07:29,169
<font color="#E5E5E5">never relay is a DNS request outside</font>

181
00:07:27,069 --> 00:07:31,870
your network<font color="#CCCCCC"> that it should right so one</font>

182
00:07:29,169 --> 00:07:36,219
of the big ones there's one<font color="#CCCCCC"> one</font><font color="#E5E5E5"> here you</font>

183
00:07:31,870 --> 00:07:37,330
all need to<font color="#E5E5E5"> be aware</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> wpad queries if</font>

184
00:07:36,219 --> 00:07:39,219
you don't have<font color="#CCCCCC"> those shut down on your</font>

185
00:07:37,330 --> 00:07:40,389
network I advise you to dig<font color="#E5E5E5"> through the</font>

186
00:07:39,219 --> 00:07:42,039
<font color="#CCCCCC">internet figure out how to shut</font><font color="#E5E5E5"> those</font>

187
00:07:40,389 --> 00:07:44,379
off immediately<font color="#CCCCCC"> you</font><font color="#E5E5E5"> don't have a proxy</font>

188
00:07:42,039 --> 00:07:47,919
<font color="#CCCCCC">server on your network these are bad</font>

189
00:07:44,379 --> 00:07:50,379
news<font color="#CCCCCC"> your users can</font><font color="#E5E5E5"> go and this is</font><font color="#CCCCCC"> an</font>

190
00:07:47,919 --> 00:07:52,330
aside<font color="#E5E5E5"> they can browse and Wi-Fi anywhere</font>

191
00:07:50,379 --> 00:07:54,699
<font color="#E5E5E5">else</font><font color="#CCCCCC"> it will</font><font color="#E5E5E5"> send out these queries</font>

192
00:07:52,330 --> 00:07:56,948
somebody can scoop DNS queries and reply

193
00:07:54,699 --> 00:07:59,689
<font color="#E5E5E5">to them</font><font color="#CCCCCC"> it will set</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> proxy server</font><font color="#E5E5E5"> on</font>

194
00:07:56,949 --> 00:08:02,719
their browsers and send all the traffic

195
00:07:59,689 --> 00:08:05,059
that processor that<font color="#E5E5E5"> disabled that</font><font color="#CCCCCC"> he</font>

196
00:08:02,719 --> 00:08:08,269
<font color="#CCCCCC">don't use it in your</font><font color="#E5E5E5"> domain take</font><font color="#CCCCCC"> you</font>

197
00:08:05,059 --> 00:08:11,839
seriously<font color="#E5E5E5"> on</font><font color="#CCCCCC"> this but</font><font color="#E5E5E5"> we</font><font color="#CCCCCC"> also saw some</font>

198
00:08:08,269 --> 00:08:13,669
<font color="#E5E5E5">really strange lookups you see that</font>

199
00:08:11,839 --> 00:08:15,739
there's one<font color="#CCCCCC"> there</font><font color="#E5E5E5"> there's a couple</font>

200
00:08:13,669 --> 00:08:17,539
others down here some pretty poor

201
00:08:15,739 --> 00:08:19,698
malware writers<font color="#E5E5E5"> what they were doing</font><font color="#CCCCCC"> is</font>

202
00:08:17,539 --> 00:08:21,979
using these domain generation algorithms

203
00:08:19,699 --> 00:08:24,139
to generate domains by command and

204
00:08:21,979 --> 00:08:25,789
control traffic<font color="#E5E5E5"> but they weren't smart</font>

205
00:08:24,139 --> 00:08:27,860
<font color="#CCCCCC">enough to</font><font color="#E5E5E5"> make a fully</font><font color="#CCCCCC"> qualified domain</font>

206
00:08:25,789 --> 00:08:30,789
name<font color="#E5E5E5"> so they just end up creating a lot</font>

207
00:08:27,860 --> 00:08:32,959
<font color="#CCCCCC">of</font><font color="#E5E5E5"> havoc so we saw these in our network</font>

208
00:08:30,789 --> 00:08:35,659
<font color="#E5E5E5">another thing we saw when we spoke</font>

209
00:08:32,958 --> 00:08:37,279
examine<font color="#E5E5E5"> DNS traffic and initially we're</font>

210
00:08:35,659 --> 00:08:39,490
examining all of this traffic using

211
00:08:37,279 --> 00:08:43,219
wireshark and some other capture methods

212
00:08:39,490 --> 00:08:45,230
we saw<font color="#CCCCCC"> path 1 vs packets</font><font color="#E5E5E5"> there's two</font>

213
00:08:43,219 --> 00:08:47,269
kinds of<font color="#E5E5E5"> things that we saw</font><font color="#CCCCCC"> in this one</font>

214
00:08:45,230 --> 00:08:49,939
<font color="#E5E5E5">of them was malformed packets designed</font>

215
00:08:47,269 --> 00:08:52,339
to basically feed off<font color="#CCCCCC"> your DNS</font><font color="#E5E5E5"> server</font>

216
00:08:49,939 --> 00:08:55,040
<font color="#CCCCCC">breakdown</font><font color="#E5E5E5"> and the other was really</font>

217
00:08:52,339 --> 00:08:56,360
<font color="#E5E5E5">interesting if you know about DNS</font><font color="#CCCCCC"> Conlan</font>

218
00:08:55,040 --> 00:08:59,000
where you can actually tunnel other

219
00:08:56,360 --> 00:09:00,769
protocols through DNS it's done by

220
00:08:59,000 --> 00:09:03,620
packet injection of<font color="#E5E5E5"> the packet header to</font>

221
00:09:00,769 --> 00:09:05,899
go through your DNS server<font color="#E5E5E5"> and you</font><font color="#CCCCCC"> can</font>

222
00:09:03,620 --> 00:09:08,269
see<font color="#E5E5E5"> that in your DNS request if you look</font>

223
00:09:05,899 --> 00:09:10,339
good on<font color="#E5E5E5"> packets so this was a problem</font>

224
00:09:08,269 --> 00:09:12,110
<font color="#E5E5E5">these kinds of traffic should never</font>

225
00:09:10,339 --> 00:09:13,550
never<font color="#E5E5E5"> ever reached your application</font>

226
00:09:12,110 --> 00:09:17,509
servers they should be<font color="#E5E5E5"> blocked with the</font>

227
00:09:13,550 --> 00:09:19,128
edge the next thing we saw was data

228
00:09:17,509 --> 00:09:21,889
exfiltration<font color="#E5E5E5"> via</font><font color="#CCCCCC"> the-- and that's this</font>

229
00:09:19,129 --> 00:09:25,100
<font color="#CCCCCC">is</font><font color="#E5E5E5"> pretty slick</font><font color="#CCCCCC"> so the various people</font>

230
00:09:21,889 --> 00:09:28,370
register domain like<font color="#E5E5E5"> yes 17</font><font color="#CCCCCC"> comma</font><font color="#E5E5E5"> is one</font>

231
00:09:25,100 --> 00:09:29,930
of them then they don't<font color="#CCCCCC"> they do</font><font color="#E5E5E5"> drive-by</font>

232
00:09:28,370 --> 00:09:32,079
now we're down<font color="#E5E5E5"> low to send you some</font>

233
00:09:29,930 --> 00:09:35,149
malware via<font color="#E5E5E5"> battery</font><font color="#CCCCCC"> I for</font><font color="#E5E5E5"> example</font>

234
00:09:32,079 --> 00:09:37,040
<font color="#E5E5E5">install some</font><font color="#CCCCCC"> our on the</font><font color="#E5E5E5"> gear starts</font>

235
00:09:35,149 --> 00:09:40,899
<font color="#E5E5E5">generating traffic looks for the date of</font>

236
00:09:37,040 --> 00:09:40,899
is looking for on that<font color="#E5E5E5"> infected machine</font>

237
00:09:40,920 --> 00:09:46,979
that data off the<font color="#E5E5E5"> disk and creating this</font>

238
00:09:43,589 --> 00:09:49,740
included subdomain<font color="#CCCCCC"> the</font><font color="#E5E5E5"> problem is that</font>

239
00:09:46,980 --> 00:09:51,720
all<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> legal DMS right</font><font color="#E5E5E5"> goes out to</font>

240
00:09:49,740 --> 00:09:53,459
the<font color="#E5E5E5"> root finds name servers goes to the</font>

241
00:09:51,720 --> 00:09:55,920
<font color="#CCCCCC">parish name servers it returns an IP</font>

242
00:09:53,459 --> 00:09:58,040
address<font color="#CCCCCC"> the other thing it does</font><font color="#E5E5E5"> it takes</font>

243
00:09:55,920 --> 00:10:00,269
all this data here at a subdomain and

244
00:09:58,040 --> 00:10:02,099
reactivates it back welcome<font color="#E5E5E5"> at various</font>

245
00:10:00,269 --> 00:10:03,630
side so<font color="#E5E5E5"> their actual training data</font><font color="#CCCCCC"> this</font>

246
00:10:02,100 --> 00:10:06,089
is<font color="#E5E5E5"> what this is data being exfiltrated</font>

247
00:10:03,630 --> 00:10:09,029
from an<font color="#E5E5E5"> effective customer so you can</font>

248
00:10:06,089 --> 00:10:10,889
catch that<font color="#E5E5E5"> in your</font><font color="#CCCCCC"> dns</font><font color="#E5E5E5"> and we were able</font>

249
00:10:09,029 --> 00:10:13,889
<font color="#CCCCCC">to mitigate back to some of our hack</font>

250
00:10:10,889 --> 00:10:16,199
<font color="#E5E5E5">five hours another thing was all because</font>

251
00:10:13,889 --> 00:10:19,680
we didn't<font color="#E5E5E5"> want close our DNS resolvers</font>

252
00:10:16,199 --> 00:10:21,359
<font color="#CCCCCC">down we</font><font color="#E5E5E5"> wanted to be able to</font><font color="#CCCCCC"> block IPs</font>

253
00:10:19,680 --> 00:10:24,060
<font color="#CCCCCC">and we know we're</font><font color="#E5E5E5"> back there's several</font>

254
00:10:21,360 --> 00:10:26,699
lists out there<font color="#CCCCCC"> this</font><font color="#E5E5E5"> particular one is a</font>

255
00:10:24,060 --> 00:10:29,489
drop list from<font color="#CCCCCC"> span house it's freaking</font>

256
00:10:26,699 --> 00:10:31,649
subscribe to the battle over 31 we wrote

257
00:10:29,490 --> 00:10:33,510
a little c-sharp program to put it in

258
00:10:31,649 --> 00:10:35,370
the right format<font color="#E5E5E5"> this is the format that</font>

259
00:10:33,510 --> 00:10:38,100
<font color="#CCCCCC">inaudible data group takes but it's</font>

260
00:10:35,370 --> 00:10:39,300
basically just the<font color="#E5E5E5"> data gotten from</font>

261
00:10:38,100 --> 00:10:42,110
spanning house<font color="#E5E5E5"> to put in the right</font>

262
00:10:39,300 --> 00:10:44,459
format we're able to have this data

263
00:10:42,110 --> 00:10:45,449
stored in<font color="#E5E5E5"> a central location and then</font>

264
00:10:44,459 --> 00:10:49,170
<font color="#E5E5E5">distributed over</font>

265
00:10:45,449 --> 00:10:51,240
<font color="#CCCCCC">iLook</font><font color="#E5E5E5"> balances globally with a bash</font>

266
00:10:49,170 --> 00:10:53,640
script<font color="#E5E5E5"> and chrome</font><font color="#CCCCCC"> drops that are run</font>

267
00:10:51,240 --> 00:10:55,620
every so often<font color="#E5E5E5"> on cert on the</font><font color="#CCCCCC"> i5 will</font>

268
00:10:53,640 --> 00:10:57,360
about so we're able to<font color="#CCCCCC"> aggregate these</font>

269
00:10:55,620 --> 00:11:01,100
we get<font color="#E5E5E5"> this data from</font><font color="#CCCCCC"> various speeds</font>

270
00:10:57,360 --> 00:11:05,220
including our spam filtering information

271
00:11:01,100 --> 00:11:06,810
<font color="#E5E5E5">the last thing we saw is actually an</font>

272
00:11:05,220 --> 00:11:09,690
<font color="#CCCCCC">interesting way that</font><font color="#E5E5E5"> you can use DNS the</font>

273
00:11:06,810 --> 00:11:11,849
<font color="#E5E5E5">DDoS so several probably</font><font color="#CCCCCC"> ran out</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> you</font>

274
00:11:09,690 --> 00:11:14,010
to the<font color="#E5E5E5"> most of the major DNS servers put</font>

275
00:11:11,850 --> 00:11:16,649
in a feature that<font color="#E5E5E5"> allows</font><font color="#CCCCCC"> you to</font><font color="#E5E5E5"> for</font>

276
00:11:14,010 --> 00:11:18,750
certain<font color="#CCCCCC"> queries to be</font><font color="#E5E5E5"> reactive over TCP</font>

277
00:11:16,649 --> 00:11:20,640
<font color="#E5E5E5">so</font><font color="#CCCCCC"> somebody wants to</font><font color="#E5E5E5"> do a DNS</font>

278
00:11:18,750 --> 00:11:21,420
application in fact they<font color="#CCCCCC"> hit</font><font color="#E5E5E5"> your server</font>

279
00:11:20,640 --> 00:11:24,449
with it anyway

280
00:11:21,420 --> 00:11:25,949
last<font color="#CCCCCC"> fifty three</font><font color="#E5E5E5"> your data server says</font>

281
00:11:24,450 --> 00:11:29,100
<font color="#CCCCCC">I'll</font><font color="#E5E5E5"> be happy to answer that you've got</font>

282
00:11:25,950 --> 00:11:31,500
a Gascon<font color="#E5E5E5"> TCP port 53</font><font color="#CCCCCC"> well the bad guys</font>

283
00:11:29,100 --> 00:11:34,890
<font color="#CCCCCC">not gonna initiate</font><font color="#E5E5E5"> the DMS amplification</font>

284
00:11:31,500 --> 00:11:37,170
attack against you over 450<font color="#E5E5E5"> 3tc because</font>

285
00:11:34,890 --> 00:11:39,240
they know<font color="#CCCCCC"> they are</font><font color="#E5E5E5"> but what they will do</font>

286
00:11:37,170 --> 00:11:42,120
is they will spoof the IP address<font color="#CCCCCC"> in the</font>

287
00:11:39,240 --> 00:11:45,150
<font color="#CCCCCC">TCP</font><font color="#E5E5E5"> packet and send you a boatload of</font>

288
00:11:42,120 --> 00:11:48,780
queries directly at the malicious IP

289
00:11:45,150 --> 00:11:51,060
<font color="#CCCCCC">occur via the IP address that they put</font>

290
00:11:48,780 --> 00:11:53,579
in<font color="#E5E5E5"> there the wrong one</font><font color="#CCCCCC"> so what do you do</font>

291
00:11:51,060 --> 00:11:56,219
you end up initiating syn ACK<font color="#CCCCCC"> flow</font>

292
00:11:53,580 --> 00:11:58,320
against apartheid<font color="#E5E5E5"> he addressed so one</font>

293
00:11:56,220 --> 00:12:01,080
fix for vulnerability creates another

294
00:11:58,320 --> 00:12:03,330
vulnerability in your<font color="#E5E5E5"> DNS so be careful</font>

295
00:12:01,080 --> 00:12:05,850
about<font color="#CCCCCC"> these and Windows who can run</font>

296
00:12:03,330 --> 00:12:10,140
Windows DNS and<font color="#CCCCCC"> with the time</font><font color="#E5E5E5"> knowledge</font>

297
00:12:05,850 --> 00:12:13,350
<font color="#CCCCCC">of</font><font color="#E5E5E5"> TCP</font><font color="#CCCCCC"> time-out</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> windows</font><font color="#E5E5E5"> five minutes</font>

298
00:12:10,140 --> 00:12:15,750
<font color="#E5E5E5">five minutes that's ridiculously stupid</font>

299
00:12:13,350 --> 00:12:16,890
nobody<font color="#E5E5E5"> needs five minutes of time</font>

300
00:12:15,750 --> 00:12:18,510
timeout timeout

301
00:12:16,890 --> 00:12:20,520
you can<font color="#E5E5E5"> change that in the register the</font>

302
00:12:18,510 --> 00:12:23,189
<font color="#E5E5E5">lowest windows what you said it is</font><font color="#CCCCCC"> 30</font>

303
00:12:20,520 --> 00:12:26,130
<font color="#CCCCCC">cents but</font><font color="#E5E5E5"> said the 30 seconds</font><font color="#CCCCCC"> that will</font>

304
00:12:23,190 --> 00:12:27,630
protect you wait a bit<font color="#E5E5E5"> thanks Alyssa</font><font color="#CCCCCC"> we</font>

305
00:12:26,130 --> 00:12:30,420
saw last thing we saw<font color="#CCCCCC"> on our D natural</font>

306
00:12:27,630 --> 00:12:31,830
flood<font color="#E5E5E5"> this was kind of interesting</font><font color="#CCCCCC"> we</font>

307
00:12:30,420 --> 00:12:33,990
first brought the service up several

308
00:12:31,830 --> 00:12:36,480
<font color="#CCCCCC">years</font><font color="#E5E5E5"> ago this was a big deal people</font>

309
00:12:33,990 --> 00:12:39,440
<font color="#E5E5E5">just try</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> flood crap out with these</font>

310
00:12:36,480 --> 00:12:41,700
DNS requests<font color="#E5E5E5"> the latest one happened</font>

311
00:12:39,440 --> 00:12:42,560
<font color="#E5E5E5">last year I think</font><font color="#CCCCCC"> October</font><font color="#E5E5E5"> November</font>

312
00:12:41,700 --> 00:12:45,190
anybody

313
00:12:42,560 --> 00:12:47,650
<font color="#CCCCCC">what</font><font color="#E5E5E5"> happened to a particular magazine</font>

314
00:12:45,190 --> 00:12:49,610
<font color="#CCCCCC">they made an</font><font color="#E5E5E5"> announcement about the</font>

315
00:12:47,650 --> 00:12:51,680
content that<font color="#E5E5E5"> they were putting in their</font>

316
00:12:49,610 --> 00:12:54,050
magazine<font color="#E5E5E5"> the next</font><font color="#CCCCCC"> day you know how</font>

317
00:12:51,680 --> 00:12:55,729
people DDoS ultra DNS for about four

318
00:12:54,050 --> 00:12:58,370
hours<font color="#E5E5E5"> and</font><font color="#CCCCCC"> afternoon</font><font color="#E5E5E5"> to come</font><font color="#CCCCCC"> off line</font>

319
00:12:55,730 --> 00:13:04,550
<font color="#E5E5E5">this was playable</font><font color="#CCCCCC"> Playboy magazine so</font>

320
00:12:58,370 --> 00:13:06,170
<font color="#E5E5E5">anybody now say crap all</font><font color="#CCCCCC"> right so what</font>

321
00:13:04,550 --> 00:13:08,150
did<font color="#E5E5E5"> we use don't matter</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> pieces that</font>

322
00:13:06,170 --> 00:13:09,829
we used to put<font color="#CCCCCC"> all this together first</font>

323
00:13:08,150 --> 00:13:11,449
thing we have<font color="#CCCCCC"> a</font><font color="#E5E5E5"> five load balancers</font>

324
00:13:09,830 --> 00:13:12,800
didn't learn a place when we got there

325
00:13:11,450 --> 00:13:14,990
just<font color="#CCCCCC"> working with the tools that</font><font color="#E5E5E5"> we're</font>

326
00:13:12,800 --> 00:13:17,569
in place<font color="#E5E5E5"> so basically the f5 load</font>

327
00:13:14,990 --> 00:13:20,000
balancer is a<font color="#CCCCCC"> public facing</font><font color="#E5E5E5"> IP address</font>

328
00:13:17,570 --> 00:13:22,550
today I'm going for service to<font color="#E5E5E5"> be eating</font>

329
00:13:20,000 --> 00:13:25,250
out to be DNS whatever<font color="#E5E5E5"> it's called a bit</font>

330
00:13:22,550 --> 00:13:27,709
virtual IP address and it's low balances

331
00:13:25,250 --> 00:13:30,830
to be<font color="#CCCCCC"> pool servers in the background in</font>

332
00:13:27,710 --> 00:13:32,050
our case would<font color="#E5E5E5"> be</font><font color="#CCCCCC"> 453 here</font><font color="#E5E5E5"> DNS servers</font>

333
00:13:30,830 --> 00:13:34,430
and background

334
00:13:32,050 --> 00:13:36,020
it also<font color="#CCCCCC"> supports</font><font color="#E5E5E5"> something called I</font>

335
00:13:34,430 --> 00:13:38,599
rules which are<font color="#E5E5E5"> very cool went over</font>

336
00:13:36,020 --> 00:13:40,430
those men Alexis actually monitor what's

337
00:13:38,600 --> 00:13:43,730
going<font color="#E5E5E5"> on</font><font color="#CCCCCC"> believe</font><font color="#E5E5E5"> and load</font><font color="#CCCCCC"> balance across</font>

338
00:13:40,430 --> 00:13:45,380
many servers and background has some

339
00:13:43,730 --> 00:13:48,320
other<font color="#E5E5E5"> features</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> uses an operating</font>

340
00:13:45,380 --> 00:13:49,939
system<font color="#E5E5E5"> called</font><font color="#CCCCCC"> TLS stands for time</font>

341
00:13:48,320 --> 00:13:53,000
management<font color="#E5E5E5"> operation system nothing</font>

342
00:13:49,940 --> 00:13:55,460
fancy it's just<font color="#E5E5E5"> that five operating</font>

343
00:13:53,000 --> 00:13:58,100
system and it has<font color="#E5E5E5"> the ability</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do Tim</font>

344
00:13:55,460 --> 00:14:01,430
SH commands which run functions within

345
00:13:58,100 --> 00:14:03,680
that operating system<font color="#E5E5E5"> another cool</font>

346
00:14:01,430 --> 00:14:05,719
feature<font color="#E5E5E5"> that</font><font color="#CCCCCC"> it has our idols now this</font>

347
00:14:03,680 --> 00:14:07,810
is<font color="#E5E5E5"> just a view of a sample I roll in</font>

348
00:14:05,720 --> 00:14:10,480
<font color="#CCCCCC">m-53 I roll</font>

349
00:14:07,810 --> 00:14:12,609
<font color="#CCCCCC">down</font><font color="#E5E5E5"> online so I rules allow you to</font>

350
00:14:10,480 --> 00:14:14,410
<font color="#E5E5E5">manipulate traffic</font><font color="#CCCCCC"> have the application</font>

351
00:14:12,610 --> 00:14:16,660
<font color="#CCCCCC">on network layer</font><font color="#E5E5E5"> both inbound and</font>

352
00:14:14,410 --> 00:14:19,779
outbound<font color="#E5E5E5"> and do things with and it uses</font>

353
00:14:16,660 --> 00:14:21,010
<font color="#E5E5E5">a language called TCL tool control over</font>

354
00:14:19,779 --> 00:14:21,730
tool command<font color="#CCCCCC"> language I think that</font>

355
00:14:21,010 --> 00:14:24,730
stands<font color="#CCCCCC"> for</font>

356
00:14:21,730 --> 00:14:28,930
so remember<font color="#CCCCCC"> TC</font><font color="#E5E5E5"> a long time ago well</font>

357
00:14:24,730 --> 00:14:30,550
<font color="#E5E5E5">that's back</font><font color="#CCCCCC"> alright so what we also were</font>

358
00:14:28,930 --> 00:14:32,050
able<font color="#E5E5E5"> to do with drem feen I spoke about</font>

359
00:14:30,550 --> 00:14:33,520
<font color="#E5E5E5">these a little bit</font><font color="#CCCCCC"> earlier that's</font><font color="#E5E5E5"> the</font>

360
00:14:32,050 --> 00:14:36,640
<font color="#E5E5E5">address you can go to that</font><font color="#CCCCCC"> will look up</font>

361
00:14:33,520 --> 00:14:39,010
that<font color="#CCCCCC"> particular thread pain if you have</font>

362
00:14:36,640 --> 00:14:41,439
<font color="#CCCCCC">a router or something a firewall that</font>

363
00:14:39,010 --> 00:14:43,060
takes in these IQ feeds<font color="#CCCCCC"> I would go look</font>

364
00:14:41,440 --> 00:14:44,710
<font color="#E5E5E5">at this one in the drop and just drop</font>

365
00:14:43,060 --> 00:14:46,510
that traffic<font color="#E5E5E5"> on your network never let</font>

366
00:14:44,710 --> 00:14:48,130
it touch your network<font color="#E5E5E5"> there's one called</font>

367
00:14:46,510 --> 00:14:52,750
<font color="#CCCCCC">prop there's another one called me drop</font>

368
00:14:48,130 --> 00:15:00,490
free list you can download<font color="#E5E5E5"> so hungry for</font>

369
00:14:52,750 --> 00:15:01,930
<font color="#E5E5E5">bacon this morning but the other thing</font>

370
00:15:00,490 --> 00:15:03,460
that<font color="#CCCCCC"> five</font><font color="#E5E5E5"> allows you to do is we're both</font>

371
00:15:01,930 --> 00:15:05,739
<font color="#E5E5E5">bottom and this is where we</font><font color="#CCCCCC"> can put the</font>

372
00:15:03,460 --> 00:15:07,750
<font color="#CCCCCC">pieces together if I've let you live</font>

373
00:15:05,740 --> 00:15:09,820
<font color="#CCCCCC">locally obviously</font><font color="#E5E5E5"> I'm gonna do that</font><font color="#CCCCCC"> any</font>

374
00:15:07,750 --> 00:15:12,880
<font color="#E5E5E5">time</font><font color="#CCCCCC"> a lottery</font><font color="#E5E5E5"> locally</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> public facing</font>

375
00:15:09,820 --> 00:15:14,800
<font color="#CCCCCC">device</font><font color="#E5E5E5"> your crate</font><font color="#CCCCCC"> I opted</font><font color="#E5E5E5"> on your</font><font color="#CCCCCC"> disks</font>

376
00:15:12,880 --> 00:15:16,930
<font color="#E5E5E5">on your</font><font color="#CCCCCC"> place down so what this allows</font>

377
00:15:14,800 --> 00:15:20,920
<font color="#E5E5E5">you to do a</font><font color="#CCCCCC"> south pass</font><font color="#E5E5E5"> to remotely lock</font>

378
00:15:16,930 --> 00:15:23,410
all<font color="#E5E5E5"> your data we were ugly Bob</font><font color="#CCCCCC"> all of</font>

379
00:15:20,920 --> 00:15:26,469
our data<font color="#E5E5E5"> to</font><font color="#CCCCCC"> great long very long is a</font>

380
00:15:23,410 --> 00:15:28,150
<font color="#E5E5E5">choice if we did is basically the open</font>

381
00:15:26,470 --> 00:15:29,830
<font color="#E5E5E5">source alternative to swamp correct</font>

382
00:15:28,150 --> 00:15:31,449
people used<font color="#E5E5E5"> to bunk we chose not</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use</font>

383
00:15:29,830 --> 00:15:33,040
<font color="#CCCCCC">and we generated so much</font><font color="#E5E5E5"> data</font><font color="#CCCCCC"> at the</font>

384
00:15:31,450 --> 00:15:34,870
<font color="#E5E5E5">cost for</font><font color="#CCCCCC"> us to get</font><font color="#E5E5E5"> involved with swamp</font>

385
00:15:33,040 --> 00:15:36,280
it's a great<font color="#CCCCCC"> product</font><font color="#E5E5E5"> but for</font><font color="#CCCCCC"> us we</font>

386
00:15:34,870 --> 00:15:38,350
<font color="#E5E5E5">needed something</font><font color="#CCCCCC"> that could</font><font color="#E5E5E5"> match a</font>

387
00:15:36,280 --> 00:15:42,189
little<font color="#CCCCCC"> bit more body</font><font color="#E5E5E5"> blob data that we</font>

388
00:15:38,350 --> 00:15:44,290
have is tremendously high<font color="#E5E5E5"> sobre la is</font>

389
00:15:42,190 --> 00:15:46,960
<font color="#CCCCCC">Kim run it as a single</font><font color="#E5E5E5"> machine</font><font color="#CCCCCC"> the</font>

390
00:15:44,290 --> 00:15:49,060
cluster of machines<font color="#CCCCCC"> put the cluster</font>

391
00:15:46,960 --> 00:15:51,140
behind an<font color="#E5E5E5"> f5 little balancer send all of</font>

392
00:15:49,060 --> 00:15:52,579
your<font color="#E5E5E5"> data</font>

393
00:15:51,140 --> 00:15:55,430
balance their<font color="#E5E5E5"> crosses for a lot of</font>

394
00:15:52,579 --> 00:15:58,339
servers<font color="#CCCCCC"> Greylock</font><font color="#E5E5E5"> has inputs that ingest</font>

395
00:15:55,430 --> 00:16:00,469
this<font color="#CCCCCC"> slot data takes</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> lob data and</font>

396
00:15:58,339 --> 00:16:02,839
writes it into an elastic search cluster

397
00:16:00,470 --> 00:16:05,000
the behind this<font color="#E5E5E5"> so we're using elastic</font>

398
00:16:02,839 --> 00:16:07,190
search as well<font color="#E5E5E5"> the elastic search</font>

399
00:16:05,000 --> 00:16:09,019
cluster then indexes all the data based

400
00:16:07,190 --> 00:16:10,880
on the<font color="#E5E5E5"> fields one of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> cool things</font>

401
00:16:09,019 --> 00:16:13,370
<font color="#CCCCCC">about Marais</font><font color="#E5E5E5"> log is that it gives you</font>

402
00:16:10,880 --> 00:16:21,500
<font color="#E5E5E5">the ability to import data in a format</font>

403
00:16:13,370 --> 00:16:23,480
<font color="#CCCCCC">called guilt over</font><font color="#E5E5E5"> that is the other</font>

404
00:16:21,500 --> 00:16:26,149
thing<font color="#CCCCCC"> about</font><font color="#E5E5E5"> to do is write a custom Java</font>

405
00:16:23,480 --> 00:16:29,779
<font color="#CCCCCC">plugin so you can parse data that's</font>

406
00:16:26,149 --> 00:16:32,510
coming in so<font color="#E5E5E5"> community is like Kiwi Kiwi</font>

407
00:16:29,779 --> 00:16:34,490
this is<font color="#CCCCCC"> the sponsor what's good for his</font>

408
00:16:32,510 --> 00:16:36,230
time is hard to get<font color="#E5E5E5"> information out of</font>

409
00:16:34,490 --> 00:16:39,589
<font color="#E5E5E5">that right it just takes</font><font color="#CCCCCC"> trips this lot</font>

410
00:16:36,230 --> 00:16:41,899
of format<font color="#E5E5E5"> dumps it into a file with a</font>

411
00:16:39,589 --> 00:16:44,120
body of<font color="#E5E5E5"> stuff that we're doing it craps</font>

412
00:16:41,899 --> 00:16:45,709
out very easily<font color="#E5E5E5"> the</font><font color="#CCCCCC"> Alaska</font><font color="#E5E5E5"> search gives</font>

413
00:16:44,120 --> 00:16:50,779
you the ability<font color="#E5E5E5"> to do flexible search</font>

414
00:16:45,709 --> 00:16:53,839
you can format<font color="#E5E5E5"> in certain ways the other</font>

415
00:16:50,779 --> 00:16:56,149
thing that<font color="#E5E5E5"> Greylock</font><font color="#CCCCCC"> has now it's pretty</font>

416
00:16:53,839 --> 00:16:58,190
cool<font color="#CCCCCC"> is it lets you from your</font><font color="#E5E5E5"> Windows or</font>

417
00:16:56,149 --> 00:17:00,649
<font color="#E5E5E5">Linux boxes you can ship your lobster</font>

418
00:16:58,190 --> 00:17:04,579
ectly<font color="#E5E5E5"> to it and it has</font><font color="#CCCCCC"> a feature</font><font color="#E5E5E5"> of this</font>

419
00:17:00,649 --> 00:17:07,400
called great a<font color="#E5E5E5"> lot of site cards of</font>

420
00:17:04,579 --> 00:17:10,339
applications on<font color="#E5E5E5"> Windows Server</font><font color="#CCCCCC"> Linux</font>

421
00:17:07,400 --> 00:17:11,839
server and it manages either<font color="#E5E5E5"> an X a lot</font>

422
00:17:10,339 --> 00:17:14,000
of your lobst<font color="#E5E5E5"> action but the cool thing</font>

423
00:17:11,839 --> 00:17:15,589
<font color="#CCCCCC">is it reports back to your great log so</font>

424
00:17:14,000 --> 00:17:17,540
through your<font color="#E5E5E5"> great log web interface</font><font color="#CCCCCC"> you</font>

425
00:17:15,589 --> 00:17:20,119
<font color="#E5E5E5">can manage all your remote endpoints</font><font color="#CCCCCC"> you</font>

426
00:17:17,540 --> 00:17:22,220
<font color="#CCCCCC">can tell it which files and</font><font color="#E5E5E5"> blocks you</font>

427
00:17:20,119 --> 00:17:25,909
want shipped back to<font color="#E5E5E5"> your great web</font>

428
00:17:22,220 --> 00:17:28,700
server<font color="#E5E5E5"> so</font><font color="#CCCCCC"> next log basically think</font><font color="#E5E5E5"> of a</font>

429
00:17:25,910 --> 00:17:30,710
lot<font color="#CCCCCC"> of route</font><font color="#E5E5E5"> you pointed to folder that</font>

430
00:17:28,700 --> 00:17:34,100
contains your<font color="#E5E5E5"> logs you can just close</font>

431
00:17:30,710 --> 00:17:34,860
logs<font color="#CCCCCC"> it will do a transform on them put</font>

432
00:17:34,100 --> 00:17:36,809
them

433
00:17:34,860 --> 00:17:38,370
<font color="#E5E5E5">you want and then</font><font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> send those logs</font>

434
00:17:36,809 --> 00:17:40,530
<font color="#CCCCCC">onto</font><font color="#E5E5E5"> whatever you put your</font><font color="#CCCCCC"> telling to</font>

435
00:17:38,370 --> 00:17:41,729
<font color="#E5E5E5">craft a lot of the bestest</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> sends</font>

436
00:17:40,530 --> 00:17:45,570
it off<font color="#E5E5E5"> that's all it does it's a</font>

437
00:17:41,730 --> 00:17:48,000
middleman<font color="#E5E5E5"> so what we use this for this</font>

438
00:17:45,570 --> 00:17:50,010
this part of it is<font color="#CCCCCC"> because we</font><font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> to</font>

439
00:17:48,000 --> 00:17:52,650
actually look on<font color="#CCCCCC"> Private Networks what</font>

440
00:17:50,010 --> 00:17:54,480
was happening in DNS for customers<font color="#E5E5E5"> so</font>

441
00:17:52,650 --> 00:17:57,480
<font color="#CCCCCC">Indiana</font><font color="#E5E5E5"> suppose these customers have</font>

442
00:17:54,480 --> 00:17:59,190
Active Directory DNS servers Active

443
00:17:57,480 --> 00:18:02,730
Directory DNS servers have the ability

444
00:17:59,190 --> 00:18:06,780
to<font color="#E5E5E5"> output more lot of information in the</font>

445
00:18:02,730 --> 00:18:09,750
debug box right<font color="#CCCCCC"> ten a very crappy</font><font color="#E5E5E5"> format</font>

446
00:18:06,780 --> 00:18:11,940
it's very difficult to read<font color="#CCCCCC"> and it's</font>

447
00:18:09,750 --> 00:18:13,860
also difficult<font color="#E5E5E5"> to make it rotate</font><font color="#CCCCCC"> now you</font>

448
00:18:11,940 --> 00:18:15,809
want to<font color="#E5E5E5"> know how to do that I can put</font><font color="#CCCCCC"> up</font>

449
00:18:13,860 --> 00:18:17,760
a<font color="#E5E5E5"> blog post about how</font><font color="#CCCCCC"> to do it</font><font color="#E5E5E5"> writes a</font>

450
00:18:15,809 --> 00:18:20,790
blog rotate<font color="#E5E5E5"> everything else works with</font>

451
00:18:17,760 --> 00:18:23,400
<font color="#E5E5E5">posted what happened by default in a DNS</font>

452
00:18:20,790 --> 00:18:25,559
<font color="#E5E5E5">you put on the debug</font><font color="#CCCCCC"> lobby it will keep</font>

453
00:18:23,400 --> 00:18:27,840
<font color="#CCCCCC">the file up until</font><font color="#E5E5E5"> whatever size you set</font>

454
00:18:25,559 --> 00:18:29,549
it at<font color="#CCCCCC"> 500 a 50 Gaetti to whatever</font><font color="#E5E5E5"> side</font>

455
00:18:27,840 --> 00:18:31,049
<font color="#E5E5E5">of center that and then</font><font color="#CCCCCC"> it will bleed</font>

456
00:18:29,549 --> 00:18:33,240
<font color="#CCCCCC">that bottom started against</font><font color="#E5E5E5"> what your</font>

457
00:18:31,049 --> 00:18:34,770
data is going with PowerShell you can

458
00:18:33,240 --> 00:18:36,809
set some functions<font color="#E5E5E5"> that will let you</font>

459
00:18:34,770 --> 00:18:42,720
roll those lobs over and<font color="#E5E5E5"> keep those logs</font>

460
00:18:36,809 --> 00:18:45,059
for a period of time<font color="#CCCCCC"> so del del</font><font color="#E5E5E5"> is</font>

461
00:18:42,720 --> 00:18:47,790
called is<font color="#CCCCCC"> sort of</font><font color="#E5E5E5"> Greylock extended</font><font color="#CCCCCC"> lob</font>

462
00:18:45,059 --> 00:18:50,610
format it sends data than a<font color="#E5E5E5"> JSON</font>

463
00:18:47,790 --> 00:18:54,570
formatted packet the first parts of<font color="#E5E5E5"> this</font>

464
00:18:50,610 --> 00:18:55,770
<font color="#CCCCCC">Packer required for Gelf the last parts</font>

465
00:18:54,570 --> 00:18:57,330
<font color="#E5E5E5">for the cool</font><font color="#CCCCCC"> parts where</font><font color="#E5E5E5"> you can</font>

466
00:18:55,770 --> 00:19:01,770
actually parse out and add your<font color="#E5E5E5"> own</font>

467
00:18:57,330 --> 00:19:04,939
fields which<font color="#CCCCCC"> we did - hi back but you</font>

468
00:19:01,770 --> 00:19:04,940
could have<font color="#E5E5E5"> a hundred fields here</font>

469
00:19:08,890 --> 00:19:13,000
kind of<font color="#CCCCCC"> programming</font><font color="#E5E5E5"> guilt libraries</font>

470
00:19:10,840 --> 00:19:14,530
available to do<font color="#E5E5E5"> this or you can do it</font>

471
00:19:13,000 --> 00:19:17,170
natively<font color="#CCCCCC"> whistle straight in a second</font>

472
00:19:14,530 --> 00:19:20,260
<font color="#CCCCCC">and I write</font><font color="#E5E5E5"> five</font><font color="#CCCCCC"> I rules what we did is</font>

473
00:19:17,170 --> 00:19:22,720
we actually told in<font color="#CCCCCC"> TCL s is how you</font>

474
00:19:20,260 --> 00:19:26,530
would<font color="#E5E5E5"> write one line of code to send one</font>

475
00:19:22,720 --> 00:19:28,210
live message to through the f5 in<font color="#CCCCCC"> Gale</font>

476
00:19:26,530 --> 00:19:30,760
format but it's<font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> straightforward</font>

477
00:19:28,210 --> 00:19:32,140
<font color="#E5E5E5">there's your bracket all the information</font>

478
00:19:30,760 --> 00:19:34,030
<font color="#CCCCCC">needed here's the fields that we</font><font color="#E5E5E5"> were</font>

479
00:19:32,140 --> 00:19:36,070
adding<font color="#E5E5E5"> right so we're adding these</font>

480
00:19:34,030 --> 00:19:38,170
fields<font color="#E5E5E5"> down here at the end all</font><font color="#CCCCCC"> of that</font>

481
00:19:36,070 --> 00:19:40,090
David is<font color="#CCCCCC"> very</font><font color="#E5E5E5"> lot of server in Gila</font>

482
00:19:38,170 --> 00:19:41,890
format<font color="#E5E5E5"> there's a</font><font color="#CCCCCC"> Gelb</font><font color="#E5E5E5"> input on a certain</font>

483
00:19:40,090 --> 00:19:44,169
<font color="#CCCCCC">fork and it puts</font><font color="#E5E5E5"> it right into the last</font>

484
00:19:41,890 --> 00:19:46,270
search the last thing we<font color="#E5E5E5"> just started</font>

485
00:19:44,170 --> 00:19:48,670
experimenting with<font color="#E5E5E5"> in how to visualize</font>

486
00:19:46,270 --> 00:19:50,290
<font color="#E5E5E5">our data this</font><font color="#CCCCCC"> Qabbani I mind it</font><font color="#E5E5E5"> wasn't</font>

487
00:19:48,670 --> 00:19:52,480
too much about this but<font color="#E5E5E5"> it links up</font>

488
00:19:50,290 --> 00:19:55,889
directly<font color="#CCCCCC"> to the same indexes that are</font>

489
00:19:52,480 --> 00:19:58,300
created<font color="#CCCCCC"> by great law in your</font>

490
00:19:55,890 --> 00:20:01,930
<font color="#CCCCCC">elasticsearch</font><font color="#E5E5E5"> customer very cool</font>

491
00:19:58,300 --> 00:20:02,919
solution so last part of this puzzle<font color="#E5E5E5"> is</font>

492
00:20:01,930 --> 00:20:04,720
something called critical<font color="#CCCCCC"> threat</font>

493
00:20:02,920 --> 00:20:07,330
notifications<font color="#E5E5E5"> this is built into our</font>

494
00:20:04,720 --> 00:20:10,660
secure<font color="#E5E5E5"> server so basically what happens</font>

495
00:20:07,330 --> 00:20:12,280
<font color="#CCCCCC">is</font><font color="#E5E5E5"> if a customer hits a domain that we</font>

496
00:20:10,660 --> 00:20:14,770
know is either part<font color="#E5E5E5"> of a botnet command</font>

497
00:20:12,280 --> 00:20:20,590
<font color="#E5E5E5">control network or the drive-by download</font>

498
00:20:14,770 --> 00:20:25,180
it will trigger on these alerts<font color="#CCCCCC"> I have</font>

499
00:20:20,590 --> 00:20:27,520
taken<font color="#E5E5E5"> some of the data tell you what</font>

500
00:20:25,180 --> 00:20:29,770
policy<font color="#E5E5E5"> everything else so what we do</font>

501
00:20:27,520 --> 00:20:31,840
then with this is a time stamp<font color="#E5E5E5"> on this</font>

502
00:20:29,770 --> 00:20:35,440
and we<font color="#E5E5E5"> can go back</font><font color="#CCCCCC"> to our data and</font>

503
00:20:31,840 --> 00:20:37,149
actually find in the data where that is

504
00:20:35,440 --> 00:20:38,740
<font color="#CCCCCC">I'll show where that infection is and</font>

505
00:20:37,150 --> 00:20:40,660
what machine on the local network<font color="#E5E5E5"> was</font>

506
00:20:38,740 --> 00:20:43,980
infected and<font color="#CCCCCC"> I'll show you</font><font color="#E5E5E5"> that here</font><font color="#CCCCCC"> in</font>

507
00:20:40,660 --> 00:20:46,860
just a second<font color="#CCCCCC"> so real quick overview</font>

508
00:20:43,980 --> 00:20:48,570
<font color="#E5E5E5">basically a</font>

509
00:20:46,860 --> 00:20:51,030
they'll have a DNS server<font color="#CCCCCC"> for multiple</font>

510
00:20:48,570 --> 00:20:54,330
<font color="#E5E5E5">months their DNS servers are set forward</font>

511
00:20:51,030 --> 00:20:57,000
their DNS<font color="#E5E5E5"> request to us when they</font>

512
00:20:54,330 --> 00:20:58,649
forward this request<font color="#E5E5E5"> to here DNS fit we</font>

513
00:20:57,000 --> 00:21:00,740
<font color="#E5E5E5">have an eye</font><font color="#CCCCCC"> rule in places</font><font color="#E5E5E5"> back</font>

514
00:20:58,650 --> 00:21:02,850
basically<font color="#CCCCCC"> nine hundred lines of</font><font color="#E5E5E5"> code</font>

515
00:21:00,740 --> 00:21:04,290
<font color="#CCCCCC">several</font><font color="#E5E5E5"> sections each one of those</font>

516
00:21:02,850 --> 00:21:05,699
sections<font color="#CCCCCC"> addresses one of</font><font color="#E5E5E5"> those</font>

517
00:21:04,290 --> 00:21:08,370
<font color="#CCCCCC">vulnerabilities that I talked about</font>

518
00:21:05,700 --> 00:21:10,799
earlier<font color="#CCCCCC"> the packet passes through those</font>

519
00:21:08,370 --> 00:21:13,709
<font color="#E5E5E5">test gates through that</font><font color="#CCCCCC"> I role</font><font color="#E5E5E5"> if any of</font>

520
00:21:10,799 --> 00:21:14,850
the rules<font color="#E5E5E5"> trigger a block then the</font>

521
00:21:13,710 --> 00:21:16,740
packet gets dropped

522
00:21:14,850 --> 00:21:18,480
but everything is logged for a lot of

523
00:21:16,740 --> 00:21:20,820
clusters we can see<font color="#E5E5E5"> right away what's</font>

524
00:21:18,480 --> 00:21:25,080
happening when somebody does DNS

525
00:21:20,820 --> 00:21:28,110
amplification attack for example<font color="#E5E5E5"> the</font><font color="#CCCCCC"> f5</font>

526
00:21:25,080 --> 00:21:30,360
<font color="#E5E5E5">s then have</font><font color="#CCCCCC"> grown back</font><font color="#E5E5E5"> and a</font><font color="#CCCCCC"> batch</font>

527
00:21:28,110 --> 00:21:32,100
<font color="#E5E5E5">script that goes out with TM</font><font color="#CCCCCC"> SH and the</font>

528
00:21:30,360 --> 00:21:34,199
web server<font color="#E5E5E5"> that's in one of</font><font color="#CCCCCC"> our data</font>

529
00:21:32,100 --> 00:21:36,090
centers<font color="#CCCCCC"> it pulls out the data from those</font>

530
00:21:34,200 --> 00:21:39,480
threat feeds it does that every so often

531
00:21:36,090 --> 00:21:41,490
so if we find<font color="#CCCCCC"> over here that</font><font color="#E5E5E5"> particular</font>

532
00:21:39,480 --> 00:21:44,010
<font color="#E5E5E5">domain is creating the DNS amplification</font>

533
00:21:41,490 --> 00:21:46,260
attack for<font color="#CCCCCC"> example</font><font color="#E5E5E5"> and it's not in our</font>

534
00:21:44,010 --> 00:21:48,480
threat feed we can<font color="#CCCCCC"> add it</font><font color="#E5E5E5"> and moving</font>

535
00:21:46,260 --> 00:21:50,520
five minutes as globally blocks when

536
00:21:48,480 --> 00:21:52,950
every DNS server<font color="#E5E5E5"> with us out there so</font>

537
00:21:50,520 --> 00:21:55,679
it's a<font color="#E5E5E5"> very quick</font><font color="#CCCCCC"> way of pushing</font><font color="#E5E5E5"> data to</font>

538
00:21:52,950 --> 00:21:57,270
a whole lot<font color="#E5E5E5"> of</font><font color="#CCCCCC"> endpoints very</font><font color="#E5E5E5"> quickly</font><font color="#CCCCCC"> so</font>

539
00:21:55,679 --> 00:21:59,040
let's<font color="#E5E5E5"> look at a little bit of the</font>

540
00:21:57,270 --> 00:22:01,860
<font color="#CCCCCC">information that we get</font><font color="#E5E5E5"> out of this this</font>

541
00:21:59,040 --> 00:22:04,799
<font color="#E5E5E5">is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> great log interface the fields that</font>

542
00:22:01,860 --> 00:22:07,620
are<font color="#E5E5E5"> coming in are over here</font><font color="#CCCCCC"> the time</font>

543
00:22:04,799 --> 00:22:10,168
frame is up here the query is<font color="#CCCCCC"> up here</font>

544
00:22:07,620 --> 00:22:13,139
this<font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> histogram showing you</font>

545
00:22:10,169 --> 00:22:14,880
per minute<font color="#CCCCCC"> this</font><font color="#E5E5E5"> particular one is</font><font color="#CCCCCC"> a DNS</font>

546
00:22:13,140 --> 00:22:16,440
amplification technology you see<font color="#CCCCCC"> the</font>

547
00:22:14,880 --> 00:22:18,570
domain name here<font color="#E5E5E5"> but that's the</font><font color="#CCCCCC"> domain</font>

548
00:22:16,440 --> 00:22:21,990
name<font color="#CCCCCC"> and it shows</font>

549
00:22:18,570 --> 00:22:24,809
and believe us<font color="#E5E5E5"> about a thousand per</font>

550
00:22:21,990 --> 00:22:28,019
minute<font color="#E5E5E5"> coming in and that strong</font><font color="#CCCCCC"> a very</font>

551
00:22:24,809 --> 00:22:29,789
small attack clinging globally now I

552
00:22:28,019 --> 00:22:31,200
know that<font color="#CCCCCC"> I have to be blocking</font><font color="#E5E5E5"> these</font>

553
00:22:29,789 --> 00:22:33,179
but this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> number of</font><font color="#E5E5E5"> queries</font>

554
00:22:31,200 --> 00:22:36,990
coming<font color="#E5E5E5"> in so we record all the queries</font>

555
00:22:33,179 --> 00:22:39,269
<font color="#CCCCCC">that are coming in we can actually split</font>

556
00:22:36,990 --> 00:22:41,429
that<font color="#CCCCCC"> out in</font><font color="#E5E5E5"> Braille</font><font color="#CCCCCC"> on even</font><font color="#E5E5E5"> taking</font>

557
00:22:39,269 --> 00:22:43,769
<font color="#E5E5E5">expand Bloomfield's click on quick</font>

558
00:22:41,429 --> 00:22:46,259
values in<font color="#E5E5E5"> this case you'll end up with a</font>

559
00:22:43,769 --> 00:22:47,970
list<font color="#E5E5E5"> of the top values in there there's</font>

560
00:22:46,259 --> 00:22:50,070
that<font color="#CCCCCC"> domain baby was doing all the</font>

561
00:22:47,970 --> 00:22:52,049
nefarious stuff over that time frame

562
00:22:50,070 --> 00:22:54,269
<font color="#CCCCCC">you've made that</font><font color="#E5E5E5"> many queries it was</font>

563
00:22:52,049 --> 00:22:55,559
that much percent of our traffic<font color="#CCCCCC"> I</font><font color="#E5E5E5"> want</font>

564
00:22:54,269 --> 00:22:57,389
to narrow it down and click that<font color="#E5E5E5"> button</font>

565
00:22:55,559 --> 00:23:00,710
<font color="#CCCCCC">and it</font><font color="#E5E5E5"> will narrow the query down even</font>

566
00:22:57,389 --> 00:23:03,269
more<font color="#CCCCCC"> we have dashboards that run in our</font>

567
00:23:00,710 --> 00:23:05,580
network<font color="#CCCCCC"> operation</font><font color="#E5E5E5"> center</font><font color="#CCCCCC"> where we</font><font color="#E5E5E5"> can</font>

568
00:23:03,269 --> 00:23:08,370
manage<font color="#E5E5E5"> this this is showing an hour view</font>

569
00:23:05,580 --> 00:23:11,580
so over here these are<font color="#CCCCCC"> all in this case</font>

570
00:23:08,370 --> 00:23:13,110
DNS any queries that are coming in these

571
00:23:11,580 --> 00:23:15,210
<font color="#E5E5E5">over here are</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> ones</font><font color="#CCCCCC"> that are getting</font>

572
00:23:13,110 --> 00:23:17,279
blocked<font color="#E5E5E5"> so what we can do is we can</font>

573
00:23:15,210 --> 00:23:19,379
compare<font color="#CCCCCC"> the two</font><font color="#E5E5E5"> and if there's something</font>

574
00:23:17,279 --> 00:23:21,779
missing over here we<font color="#E5E5E5"> can add it to</font><font color="#CCCCCC"> our I</font>

575
00:23:19,379 --> 00:23:24,019
rolled a group<font color="#E5E5E5"> have it pushed out and</font>

576
00:23:21,779 --> 00:23:27,090
have<font color="#CCCCCC"> it blocked pretty quickly</font>

577
00:23:24,019 --> 00:23:28,740
this is an example<font color="#E5E5E5"> of remember</font><font color="#CCCCCC"> the span</font>

578
00:23:27,090 --> 00:23:31,230
<font color="#CCCCCC">house list I showed</font>

579
00:23:28,740 --> 00:23:33,179
<font color="#CCCCCC">listen up</font><font color="#E5E5E5"> there these are actual</font><font color="#CCCCCC"> lakhs</font>

580
00:23:31,230 --> 00:23:36,179
of<font color="#E5E5E5"> people</font><font color="#CCCCCC"> trying to</font><font color="#E5E5E5"> get our DNS servers</font>

581
00:23:33,179 --> 00:23:37,320
<font color="#E5E5E5">coming up here</font><font color="#CCCCCC"> so there's</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> many</font>

582
00:23:36,179 --> 00:23:39,000
<font color="#E5E5E5">getting it and these</font><font color="#CCCCCC"> are actually</font>

583
00:23:37,320 --> 00:23:41,700
getting blocked<font color="#E5E5E5"> so we can tell that</font><font color="#CCCCCC"> our</font>

584
00:23:39,000 --> 00:23:43,290
block for working this year<font color="#CCCCCC"> showed</font>

585
00:23:41,700 --> 00:23:45,390
Network compromised so there was a

586
00:23:43,290 --> 00:23:48,149
particular domain that was<font color="#E5E5E5"> saw on it in</font>

587
00:23:45,390 --> 00:23:50,940
a CTN<font color="#CCCCCC"> we were able to go back to our</font>

588
00:23:48,150 --> 00:23:52,830
<font color="#E5E5E5">public facing fix and find out the two</font>

589
00:23:50,940 --> 00:23:54,960
customers<font color="#CCCCCC"> were generating</font><font color="#E5E5E5"> those by the</font>

590
00:23:52,830 --> 00:23:56,490
way<font color="#CCCCCC"> an</font><font color="#E5E5E5"> IP addresses contact those</font>

591
00:23:54,960 --> 00:23:59,550
<font color="#E5E5E5">customers and get them in the process of</font>

592
00:23:56,490 --> 00:24:01,080
cleaning<font color="#E5E5E5"> up their network this is an</font>

593
00:23:59,550 --> 00:24:03,149
example<font color="#E5E5E5"> of the data we get out of the</font>

594
00:24:01,080 --> 00:24:05,399
DNS debug block<font color="#CCCCCC"> these are the</font><font color="#E5E5E5"> fields</font>

595
00:24:03,150 --> 00:24:07,620
that we<font color="#E5E5E5"> created in our custom Java</font>

596
00:24:05,400 --> 00:24:09,660
<font color="#CCCCCC">plug-in that takes the normal Active</font>

597
00:24:07,620 --> 00:24:11,729
<font color="#E5E5E5">Directory</font><font color="#CCCCCC"> DNS debug loss and breaks it</font>

598
00:24:09,660 --> 00:24:13,710
out<font color="#E5E5E5"> into useful information not the</font>

599
00:24:11,730 --> 00:24:15,990
practice Microsoft has in their DNS

600
00:24:13,710 --> 00:24:18,059
debug logs you can<font color="#CCCCCC"> actually</font><font color="#E5E5E5"> search it</font>

601
00:24:15,990 --> 00:24:19,650
<font color="#E5E5E5">find out what's going on I have all the</font>

602
00:24:18,059 --> 00:24:21,960
fields block<font color="#E5E5E5"> but you can turn on the</font>

603
00:24:19,650 --> 00:24:24,540
source and<font color="#CCCCCC"> destination IP narrow it down</font>

604
00:24:21,960 --> 00:24:26,730
to<font color="#CCCCCC"> a local internal IP and see all the</font>

605
00:24:24,540 --> 00:24:28,860
DNS traffic that particular user on your

606
00:24:26,730 --> 00:24:30,960
networks using<font color="#E5E5E5"> so if you want to spy on</font>

607
00:24:28,860 --> 00:24:33,090
or find<font color="#CCCCCC"> out what your users are visiting</font>

608
00:24:30,960 --> 00:24:35,760
you'd be surprised if you put this in

609
00:24:33,090 --> 00:24:37,379
place you could<font color="#E5E5E5"> build a VM and point</font><font color="#CCCCCC"> the</font>

610
00:24:35,760 --> 00:24:41,429
stop to that and figure out what's<font color="#E5E5E5"> going</font>

611
00:24:37,380 --> 00:24:43,290
on<font color="#E5E5E5"> very quickly</font><font color="#CCCCCC"> we're back to slides</font>

612
00:24:41,429 --> 00:24:45,540
down here<font color="#E5E5E5"> this is just some more debug</font>

613
00:24:43,290 --> 00:24:47,730
data same thing<font color="#CCCCCC"> and the last</font><font color="#E5E5E5"> thing is we</font>

614
00:24:45,540 --> 00:24:49,980
can<font color="#CCCCCC"> actually take that debug data</font><font color="#E5E5E5"> narrow</font>

615
00:24:47,730 --> 00:24:51,520
it down by the<font color="#E5E5E5"> domain name broke I</font>

616
00:24:49,980 --> 00:24:53,650
didn't show

617
00:24:51,520 --> 00:24:55,720
this<font color="#CCCCCC"> is one machine</font><font color="#E5E5E5"> that's compromised</font>

618
00:24:53,650 --> 00:24:56,860
with a DNS queries<font color="#CCCCCC"> from</font><font color="#E5E5E5"> the course of</font>

619
00:24:55,720 --> 00:24:58,270
that week we're able to tell the

620
00:24:56,860 --> 00:25:00,490
<font color="#CCCCCC">customer that machine on our</font><font color="#E5E5E5"> network</font>

621
00:24:58,270 --> 00:25:03,070
suspected take off the network<font color="#E5E5E5"> fix it</font>

622
00:25:00,490 --> 00:25:04,780
<font color="#E5E5E5">and that's kind of information again</font>

623
00:25:03,070 --> 00:25:06,700
<font color="#CCCCCC">another</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can do</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> we can</font><font color="#CCCCCC"> look</font>

624
00:25:04,780 --> 00:25:08,620
<font color="#E5E5E5">at where infections are coming from it</font>

625
00:25:06,700 --> 00:25:10,809
has built-in geolocation<font color="#CCCCCC"> once you</font>

626
00:25:08,620 --> 00:25:12,879
<font color="#E5E5E5">install the geolocation database</font><font color="#CCCCCC"> we're</font>

627
00:25:10,809 --> 00:25:15,399
going to tell where any<font color="#E5E5E5"> kind of data</font>

628
00:25:12,880 --> 00:25:16,950
<font color="#E5E5E5">that's IP based is coming from</font><font color="#CCCCCC"> so</font>

629
00:25:15,400 --> 00:25:20,140
there's a lot of<font color="#E5E5E5"> flexibility in this</font>

630
00:25:16,950 --> 00:25:21,730
<font color="#E5E5E5">we're about out of time</font><font color="#CCCCCC"> so our other</font>

631
00:25:20,140 --> 00:25:22,570
possibilities<font color="#CCCCCC"> we</font><font color="#E5E5E5"> can look at what</font>

632
00:25:21,730 --> 00:25:25,570
they've looked at some of<font color="#E5E5E5"> these other</font>

633
00:25:22,570 --> 00:25:27,220
<font color="#CCCCCC">things and create rules create</font><font color="#E5E5E5"> anything</font>

634
00:25:25,570 --> 00:25:29,168
we can do to export data<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then</font>

635
00:25:27,220 --> 00:25:31,299
analyze<font color="#CCCCCC"> it can be</font><font color="#E5E5E5"> looked at from</font><font color="#CCCCCC"> a</font>

636
00:25:29,169 --> 00:25:34,120
security perspective<font color="#E5E5E5"> so I don't even</font>

637
00:25:31,299 --> 00:25:36,879
<font color="#E5E5E5">information it was pretty high level and</font>

638
00:25:34,120 --> 00:25:42,840
if we have<font color="#E5E5E5"> any</font><font color="#CCCCCC"> questions you can reach</font>

639
00:25:36,880 --> 00:25:42,840
me there<font color="#E5E5E5"> thank you</font>

