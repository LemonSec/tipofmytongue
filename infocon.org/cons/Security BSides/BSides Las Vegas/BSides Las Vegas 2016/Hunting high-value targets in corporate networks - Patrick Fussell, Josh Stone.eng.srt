1
00:00:00,939 --> 00:00:06,649
<font color="#E5E5E5">alright this is audible</font><font color="#CCCCCC"> all right</font>

2
00:00:03,710 --> 00:00:08,719
excellent<font color="#E5E5E5"> so as he said we're Josh and</font>

3
00:00:06,649 --> 00:00:11,750
Patrick we won't<font color="#E5E5E5"> be labor a long</font>

4
00:00:08,719 --> 00:00:14,809
<font color="#E5E5E5">personal introduction we work for PSC we</font>

5
00:00:11,750 --> 00:00:16,128
do a lot<font color="#CCCCCC"> of PCI stuff but pci can mean a</font>

6
00:00:14,809 --> 00:00:18,890
<font color="#CCCCCC">lot of things</font><font color="#E5E5E5"> to different people i</font>

7
00:00:16,129 --> 00:00:21,380
think<font color="#CCCCCC"> you'll see you know it our</font>

8
00:00:18,890 --> 00:00:24,230
perspective on pen testing and it's fun

9
00:00:21,380 --> 00:00:25,580
to apply kind of a<font color="#CCCCCC"> highroad idea of pen</font>

10
00:00:24,230 --> 00:00:28,580
testing with pen test<font color="#E5E5E5"> really ought to be</font>

11
00:00:25,580 --> 00:00:31,369
to<font color="#E5E5E5"> the pci space so quickly you know</font>

12
00:00:28,580 --> 00:00:33,410
what is pen testing after you've been

13
00:00:31,370 --> 00:00:34,850
<font color="#E5E5E5">doing it for a couple decades you start</font>

14
00:00:33,410 --> 00:00:37,129
to feel like pen testing is where you

15
00:00:34,850 --> 00:00:39,710
hack stuff that's kind<font color="#E5E5E5"> of the intuitive</font>

16
00:00:37,129 --> 00:00:41,629
model the industry wants it to be

17
00:00:39,710 --> 00:00:44,120
something<font color="#E5E5E5"> more formalized and repeatable</font>

18
00:00:41,629 --> 00:00:46,730
and so we have methodologies that safe n

19
00:00:44,120 --> 00:00:48,620
testing is this series of stages or

20
00:00:46,730 --> 00:00:50,269
something like that but<font color="#CCCCCC"> unfortunately</font>

21
00:00:48,620 --> 00:00:52,489
sometimes<font color="#E5E5E5"> industry wants to take that</font>

22
00:00:50,269 --> 00:00:55,879
and distill it into<font color="#E5E5E5"> something that's</font>

23
00:00:52,489 --> 00:00:57,919
maybe more profitable and so<font color="#E5E5E5"> this talk</font>

24
00:00:55,879 --> 00:01:01,039
is really<font color="#E5E5E5"> not about this kind of pen</font>

25
00:00:57,920 --> 00:01:03,229
testing it's not about the do a scan on

26
00:01:01,039 --> 00:01:05,450
a few<font color="#CCCCCC"> IPs and</font><font color="#E5E5E5"> then give a report and say</font>

27
00:01:03,229 --> 00:01:10,010
you look good this year that's not

28
00:01:05,450 --> 00:01:11,420
really a pen test so in real life or<font color="#E5E5E5"> at</font>

29
00:01:10,010 --> 00:01:12,890
least conceptually what a pen test

30
00:01:11,420 --> 00:01:14,900
<font color="#E5E5E5">should always have is some sort of</font>

31
00:01:12,890 --> 00:01:16,730
objective there's<font color="#E5E5E5"> something that we're</font>

32
00:01:14,900 --> 00:01:18,710
trying<font color="#E5E5E5"> to achieve we're trying to answer</font>

33
00:01:16,730 --> 00:01:20,270
compliance question or trying to find

34
00:01:18,710 --> 00:01:23,570
significant risks and we're going to<font color="#E5E5E5"> do</font>

35
00:01:20,270 --> 00:01:26,449
that<font color="#E5E5E5"> by demonstrating through some</font>

36
00:01:23,570 --> 00:01:28,429
series of techniques and that we can

37
00:01:26,450 --> 00:01:31,060
gain access to things we can escalate we

38
00:01:28,430 --> 00:01:34,190
can find our<font color="#CCCCCC"> way to the crown jewels and</font>

39
00:01:31,060 --> 00:01:36,800
answer those important questions so this

40
00:01:34,190 --> 00:01:39,200
talk isn't really about<font color="#CCCCCC"> zero days it's</font>

41
00:01:36,800 --> 00:01:41,170
not necessarily about tools what we're

42
00:01:39,200 --> 00:01:43,400
<font color="#E5E5E5">talking about is tactics or strategy</font>

43
00:01:41,170 --> 00:01:45,410
we're talking<font color="#CCCCCC"> about the thought process</font>

44
00:01:43,400 --> 00:01:47,330
and how how do you<font color="#E5E5E5"> take the fact that i</font>

45
00:01:45,410 --> 00:01:49,429
did<font color="#E5E5E5"> metasploit unleashed so</font><font color="#CCCCCC"> i know how</font>

46
00:01:47,330 --> 00:01:51,860
to how to compromise something but how

47
00:01:49,430 --> 00:01:53,390
do you<font color="#E5E5E5"> turn that into you know finding</font>

48
00:01:51,860 --> 00:01:55,550
<font color="#E5E5E5">the crown jewels and especially as</font>

49
00:01:53,390 --> 00:01:57,350
networks scale most of the hacking

50
00:01:55,550 --> 00:01:59,270
classes that we take have little tiny

51
00:01:57,350 --> 00:02:01,309
test networks where everything's pretty

52
00:01:59,270 --> 00:02:03,229
easy to find in real<font color="#CCCCCC"> life you might have</font>

53
00:02:01,310 --> 00:02:05,780
thousands or hundreds of thousands<font color="#CCCCCC"> of</font>

54
00:02:03,230 --> 00:02:08,450
systems on a network how do you in a

55
00:02:05,780 --> 00:02:10,399
couple weeks find those crown jewels

56
00:02:08,449 --> 00:02:13,069
that are scattered<font color="#E5E5E5"> somewhere within that</font>

57
00:02:10,399 --> 00:02:14,380
humongous space so go<font color="#CCCCCC"> through a number</font>

58
00:02:13,069 --> 00:02:16,750
of scenarios

59
00:02:14,380 --> 00:02:18,970
illustrating some specific examples but

60
00:02:16,750 --> 00:02:22,200
hopefully trying to focus on the thought

61
00:02:18,970 --> 00:02:25,150
process the technique and<font color="#E5E5E5"> general</font>

62
00:02:22,200 --> 00:02:28,980
solutions to finding your<font color="#E5E5E5"> way through a</font>

63
00:02:25,150 --> 00:02:28,980
network and find those crown jewels

64
00:02:30,870 --> 00:02:37,900
<font color="#CCCCCC">alright so</font><font color="#E5E5E5"> as we as a pedestrian we</font>

65
00:02:35,830 --> 00:02:39,400
first order our engagements one of the

66
00:02:37,900 --> 00:02:41,410
first<font color="#CCCCCC"> things we want to</font><font color="#E5E5E5"> hone</font><font color="#CCCCCC"> in on or</font>

67
00:02:39,400 --> 00:02:43,090
start thinking about as you kick it<font color="#E5E5E5"> off</font>

68
00:02:41,410 --> 00:02:45,070
is what's going to be our low hanging

69
00:02:43,090 --> 00:02:47,320
fruit or you know what's going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be our</font>

70
00:02:45,070 --> 00:02:49,450
initial access point a lot<font color="#E5E5E5"> of times it's</font>

71
00:02:47,320 --> 00:02:50,709
something that that's easy to find but I

72
00:02:49,450 --> 00:02:52,420
think something that<font color="#CCCCCC"> we're recognizing</font>

73
00:02:50,710 --> 00:02:54,580
now is that we're doing more

74
00:02:52,420 --> 00:02:56,440
organizations who have a more mature

75
00:02:54,580 --> 00:02:58,060
security program something where they've

76
00:02:56,440 --> 00:02:59,950
<font color="#CCCCCC">been through this process a few times</font>

77
00:02:58,060 --> 00:03:01,840
and they've<font color="#E5E5E5"> been able to harden a lot of</font>

78
00:02:59,950 --> 00:03:05,019
these gaps and this little hanging fruit

79
00:03:01,840 --> 00:03:07,720
becomes a little<font color="#E5E5E5"> bit harder to find so</font>

80
00:03:05,020 --> 00:03:09,040
as we kick off a pen test also<font color="#E5E5E5"> in those</font>

81
00:03:07,720 --> 00:03:11,920
initial stages one of the things we're

82
00:03:09,040 --> 00:03:13,750
doing is sort of scanning enumeration as

83
00:03:11,920 --> 00:03:16,299
we start though we<font color="#E5E5E5"> went I have a real</font>

84
00:03:13,750 --> 00:03:17,800
clear picture of what the pin test or

85
00:03:16,300 --> 00:03:21,010
what the<font color="#E5E5E5"> network environment looks like</font>

86
00:03:17,800 --> 00:03:23,140
and we hopefully the driving force

87
00:03:21,010 --> 00:03:24,459
behind the enumeration attempts is can

88
00:03:23,140 --> 00:03:28,839
we<font color="#CCCCCC"> can</font><font color="#E5E5E5"> clear up this picture a little</font>

89
00:03:24,460 --> 00:03:30,190
<font color="#CCCCCC">bit so also as we as we kick off our pen</font>

90
00:03:28,840 --> 00:03:33,100
test one of the things we're trying<font color="#E5E5E5"> to</font>

91
00:03:30,190 --> 00:03:37,030
feel for is because you had jump into

92
00:03:33,100 --> 00:03:38,920
one of the recent pentasa<font color="#E5E5E5"> I did was one</font>

93
00:03:37,030 --> 00:03:40,810
of these organizations who had<font color="#E5E5E5"> a more</font>

94
00:03:38,920 --> 00:03:43,269
maturity super more mature security

95
00:03:40,810 --> 00:03:45,610
program<font color="#E5E5E5"> they probably done pen test for</font>

96
00:03:43,270 --> 00:03:47,560
506 years they had hardened<font color="#E5E5E5"> up a lot of</font>

97
00:03:45,610 --> 00:03:49,000
these gaps so<font color="#CCCCCC"> one of the things that</font><font color="#E5E5E5"> I</font>

98
00:03:47,560 --> 00:03:50,680
look<font color="#CCCCCC"> for first one of the sort</font><font color="#E5E5E5"> of</font>

99
00:03:49,000 --> 00:03:54,220
low-hanging fruit approaches is is

100
00:03:50,680 --> 00:03:55,660
password based attacks that can be look

101
00:03:54,220 --> 00:03:57,310
a lot different depending<font color="#CCCCCC"> on what we're</font>

102
00:03:55,660 --> 00:03:59,470
really talking about is<font color="#E5E5E5"> it web services</font>

103
00:03:57,310 --> 00:04:00,880
where maybe we can do a<font color="#E5E5E5"> little bit of</font>

104
00:03:59,470 --> 00:04:03,370
googling to figure out some common

105
00:04:00,880 --> 00:04:04,810
password and user names in an Active

106
00:04:03,370 --> 00:04:06,940
Directory environment though one of<font color="#E5E5E5"> the</font>

107
00:04:04,810 --> 00:04:09,010
things we're going to hone in<font color="#E5E5E5"> on is can</font>

108
00:04:06,940 --> 00:04:10,750
we get a user list maybe if we<font color="#E5E5E5"> can</font>

109
00:04:09,010 --> 00:04:13,390
generate it because we know naming

110
00:04:10,750 --> 00:04:16,560
convention or we can enumerate it from

111
00:04:13,390 --> 00:04:20,829
somewhere in this particular<font color="#E5E5E5"> pen test</font>

112
00:04:16,560 --> 00:04:21,820
where the the organization had hardened

113
00:04:20,829 --> 00:04:24,460
up<font color="#E5E5E5"> a lot of</font><font color="#CCCCCC"> those places</font><font color="#E5E5E5"> where I would</font>

114
00:04:21,820 --> 00:04:25,900
typically look so you know looking at<font color="#E5E5E5"> a</font>

115
00:04:24,460 --> 00:04:27,700
wiki that they have something posted

116
00:04:25,900 --> 00:04:28,020
they have an intranet site where I get a

117
00:04:27,700 --> 00:04:30,199
new

118
00:04:28,020 --> 00:04:33,750
<font color="#E5E5E5">my users because I connected the DC</font><font color="#CCCCCC"> and</font>

119
00:04:30,199 --> 00:04:36,360
cycle him off no<font color="#E5E5E5"> luck so I wasn't able</font>

120
00:04:33,750 --> 00:04:38,250
<font color="#E5E5E5">to find any any users and so at this</font>

121
00:04:36,360 --> 00:04:39,300
point I felt like let's step back and

122
00:04:38,250 --> 00:04:40,560
look what I do know about<font color="#E5E5E5"> the</font>

123
00:04:39,300 --> 00:04:45,030
environment<font color="#E5E5E5"> to see if I can figure out</font>

124
00:04:40,560 --> 00:04:48,240
how we can kick this off and the first

125
00:04:45,030 --> 00:04:50,369
<font color="#E5E5E5">thing that I noticed is looking at DNS</font>

126
00:04:48,240 --> 00:04:52,889
names looked like quite a few systems

127
00:04:50,370 --> 00:04:55,080
were tied to individual users so we can

128
00:04:52,889 --> 00:04:59,150
see<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the user names were related to</font>

129
00:04:55,080 --> 00:05:01,530
an individual host the problem<font color="#E5E5E5"> here is</font>

130
00:04:59,150 --> 00:05:03,120
yeah I see that<font color="#E5E5E5"> but I don't know if</font>

131
00:05:01,530 --> 00:05:05,758
these are actually user names and that

132
00:05:03,120 --> 00:05:06,990
is relevant because if I don't<font color="#CCCCCC"> know that</font>

133
00:05:05,759 --> 00:05:08,490
this fist our naming convention for

134
00:05:06,990 --> 00:05:09,990
Active Directory I don't know if this<font color="#E5E5E5"> is</font>

135
00:05:08,490 --> 00:05:11,310
going<font color="#E5E5E5"> to be a relevant attack and we</font>

136
00:05:09,990 --> 00:05:12,990
want to<font color="#E5E5E5"> make sure that we're effective</font>

137
00:05:11,310 --> 00:05:15,180
and efficient anything we're doing if

138
00:05:12,990 --> 00:05:16,259
I'm wasting tat time running a password

139
00:05:15,180 --> 00:05:18,090
basic attack against active directory

140
00:05:16,259 --> 00:05:19,979
with a bunch of users that<font color="#E5E5E5"> don't exist</font>

141
00:05:18,090 --> 00:05:23,130
what did I really<font color="#E5E5E5"> accomplished I just</font>

142
00:05:19,979 --> 00:05:25,830
<font color="#E5E5E5">burned a lot of time so the other thing</font>

143
00:05:23,130 --> 00:05:28,020
that I took a look at was remote desktop

144
00:05:25,830 --> 00:05:29,580
now this isn't all that special

145
00:05:28,020 --> 00:05:32,520
everybody's seen remote desktop in a

146
00:05:29,580 --> 00:05:33,930
corporate network what I did notice

147
00:05:32,520 --> 00:05:35,818
though is if you connect to<font color="#E5E5E5"> one of these</font>

148
00:05:33,930 --> 00:05:38,490
sessions if somebody is already there a

149
00:05:35,819 --> 00:05:40,500
lot of<font color="#E5E5E5"> times you'll see who that user is</font>

150
00:05:38,490 --> 00:05:44,370
will see the the domain that they're

151
00:05:40,500 --> 00:05:45,599
joined to and the<font color="#CCCCCC"> username so now we can</font>

152
00:05:44,370 --> 00:05:47,219
tie these two things together we can see

153
00:05:45,599 --> 00:05:50,009
the naming convention for the<font color="#E5E5E5"> domain and</font>

154
00:05:47,219 --> 00:05:51,870
<font color="#E5E5E5">we can see what the users are maybe they</font>

155
00:05:50,009 --> 00:05:53,370
match exactly either way we can do a

156
00:05:51,870 --> 00:05:56,909
little locking and gripping and create a

157
00:05:53,370 --> 00:05:58,080
user list for the domain and what I<font color="#E5E5E5"> want</font>

158
00:05:56,909 --> 00:05:59,639
to point out<font color="#CCCCCC"> here is it that there's</font>

159
00:05:58,080 --> 00:06:01,199
anything special about this probably

160
00:05:59,639 --> 00:06:03,509
<font color="#E5E5E5">lots of people have followed something</font>

161
00:06:01,199 --> 00:06:05,130
similar my point is as we're thinking

162
00:06:03,509 --> 00:06:06,990
about<font color="#E5E5E5"> these initial entry points a lot</font>

163
00:06:05,130 --> 00:06:08,699
of time the information we need to do

164
00:06:06,990 --> 00:06:10,080
them effectively and efficiently is out

165
00:06:08,699 --> 00:06:12,000
there we should have to be willing to

166
00:06:10,080 --> 00:06:18,630
look at some uncommon places to find

167
00:06:12,000 --> 00:06:21,960
them so start starting roughly where

168
00:06:18,630 --> 00:06:23,819
that leaves off maybe we didn't find a

169
00:06:21,960 --> 00:06:26,430
lot of<font color="#E5E5E5"> low-hanging fruit we weren't able</font>

170
00:06:23,819 --> 00:06:28,409
to LOL<font color="#CCCCCC"> M&R we didn't find some Tomcats</font>

171
00:06:26,430 --> 00:06:29,909
and things but as<font color="#CCCCCC"> patrick described may</font>

172
00:06:28,409 --> 00:06:31,860
we found some accidental little

173
00:06:29,909 --> 00:06:35,149
information disclosure that gets us that

174
00:06:31,860 --> 00:06:37,589
list of<font color="#E5E5E5"> usernames so we try a password</font>

175
00:06:35,149 --> 00:06:39,870
<font color="#E5E5E5">this example I find that Joe schmo's</font>

176
00:06:37,589 --> 00:06:41,409
password is password one that's always

177
00:06:39,870 --> 00:06:44,679
very popular

178
00:06:41,409 --> 00:06:46,539
and what we find is in a little network

179
00:06:44,679 --> 00:06:48,698
with a few users you probably won't be

180
00:06:46,539 --> 00:06:50,469
so lucky by guessing a password or two

181
00:06:48,699 --> 00:06:51,849
but if you have thousands of users

182
00:06:50,469 --> 00:06:54,429
you'll probably get a lot with just

183
00:06:51,849 --> 00:06:56,919
about any password you think to guess so

184
00:06:54,429 --> 00:06:59,258
right now summer 2016 is real popular<font color="#E5E5E5"> I</font>

185
00:06:56,919 --> 00:07:00,849
probably<font color="#E5E5E5"> any network of a few thousand</font>

186
00:06:59,259 --> 00:07:02,709
users or more is<font color="#E5E5E5"> going to have tens of</font>

187
00:07:00,849 --> 00:07:05,438
those very likely even if they were told

188
00:07:02,709 --> 00:07:07,300
not to do it before so once we get this

189
00:07:05,439 --> 00:07:09,189
account we start well what does<font color="#E5E5E5"> this</font>

190
00:07:07,300 --> 00:07:11,139
account get me I'm really really hoping

191
00:07:09,189 --> 00:07:14,379
<font color="#E5E5E5">that Joe</font><font color="#CCCCCC"> Schmoe</font><font color="#E5E5E5"> is going to be a domain</font>

192
00:07:11,139 --> 00:07:16,389
admin but<font color="#CCCCCC"> unfortunately he's not we find</font>

193
00:07:14,379 --> 00:07:19,149
that he's<font color="#CCCCCC"> just a member of domain users</font>

194
00:07:16,389 --> 00:07:21,399
and so we we let out this little sigh oh

195
00:07:19,149 --> 00:07:23,889
<font color="#E5E5E5">no I just</font><font color="#CCCCCC"> got this completely useless</font>

196
00:07:21,399 --> 00:07:25,209
account but if<font color="#E5E5E5"> we step back for a second</font>

197
00:07:23,889 --> 00:07:26,739
think you know I<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> have anything</font>

198
00:07:25,209 --> 00:07:29,169
else I<font color="#E5E5E5"> don't have any good low hanging</font>

199
00:07:26,739 --> 00:07:31,359
fruit and this is my first account do I

200
00:07:29,169 --> 00:07:32,709
want<font color="#E5E5E5"> to keep going after passwords or is</font>

201
00:07:31,360 --> 00:07:34,809
there something maybe the domain user

202
00:07:32,709 --> 00:07:37,289
gets me that<font color="#E5E5E5"> gives me a good actionable</font>

203
00:07:34,809 --> 00:07:40,539
path to the next layer<font color="#CCCCCC"> of the pen test</font>

204
00:07:37,289 --> 00:07:42,159
so one of the best concepts for pen

205
00:07:40,539 --> 00:07:44,469
testing<font color="#E5E5E5"> I've run into is when help our</font>

206
00:07:42,159 --> 00:07:46,149
flake presented a few years ago<font color="#CCCCCC"> called</font>

207
00:07:44,469 --> 00:07:48,069
the<font color="#CCCCCC"> compromise boundary and that</font>

208
00:07:46,149 --> 00:07:50,829
<font color="#E5E5E5">compromise boundary is the set of things</font>

209
00:07:48,069 --> 00:07:53,649
<font color="#E5E5E5">that</font><font color="#CCCCCC"> you control or could control with</font>

210
00:07:50,829 --> 00:07:55,599
the information you have and so even

211
00:07:53,649 --> 00:07:57,550
though Joe<font color="#E5E5E5"> Schmo</font><font color="#CCCCCC"> is not a domain admin</font>

212
00:07:55,599 --> 00:07:59,498
and maybe not even a local admin

213
00:07:57,550 --> 00:08:00,999
anywhere he's still an interesting user

214
00:07:59,499 --> 00:08:02,889
because he's expanded our compromise

215
00:08:00,999 --> 00:08:04,059
boundary we now have<font color="#CCCCCC"> access to some</font>

216
00:08:02,889 --> 00:08:06,429
things<font color="#E5E5E5"> that we</font><font color="#CCCCCC"> wouldn't have</font><font color="#E5E5E5"> had</font>

217
00:08:04,059 --> 00:08:10,899
otherwise we'd like it if he controlled

218
00:08:06,429 --> 00:08:13,479
systems but usually domain user at least

219
00:08:10,899 --> 00:08:15,069
has access to lots of files and some

220
00:08:13,479 --> 00:08:16,959
files are more interesting than<font color="#E5E5E5"> others</font>

221
00:08:15,069 --> 00:08:18,360
so here a couple examples of files<font color="#E5E5E5"> that</font>

222
00:08:16,959 --> 00:08:20,349
have credentials embedded in them

223
00:08:18,360 --> 00:08:22,479
finding passwords and files isn't the

224
00:08:20,349 --> 00:08:24,909
only thing that<font color="#CCCCCC"> you might look for</font><font color="#E5E5E5"> but</font>

225
00:08:22,479 --> 00:08:27,339
it turns out that the last<font color="#CCCCCC"> ten years</font><font color="#E5E5E5"> of</font>

226
00:08:24,909 --> 00:08:29,769
<font color="#E5E5E5">my pen testing career this has been</font>

227
00:08:27,339 --> 00:08:31,779
<font color="#E5E5E5">probably my highest yield attack</font>

228
00:08:29,769 --> 00:08:34,389
technique for escalating from a regular

229
00:08:31,779 --> 00:08:36,099
user to a<font color="#E5E5E5"> powerful user because nobody</font>

230
00:08:34,389 --> 00:08:38,139
ever gets the provisions right on their

231
00:08:36,099 --> 00:08:39,909
file shares the other fun thing about

232
00:08:38,139 --> 00:08:42,729
this is<font color="#E5E5E5"> you can have a perfect security</font>

233
00:08:39,909 --> 00:08:45,069
program but because file shares are so

234
00:08:42,729 --> 00:08:47,050
hard<font color="#E5E5E5"> to control this vulnerability will</font>

235
00:08:45,069 --> 00:08:48,459
live forever it all it depends on<font color="#E5E5E5"> is</font>

236
00:08:47,050 --> 00:08:50,290
somebody creating a new share and

237
00:08:48,459 --> 00:08:52,388
putting a file somewhere not realizing

238
00:08:50,290 --> 00:08:54,939
the default permissions are defined in

239
00:08:52,389 --> 00:08:56,860
NTFS as everyone read

240
00:08:54,940 --> 00:09:00,100
so on a little<font color="#E5E5E5"> network is pretty easy to</font>

241
00:08:56,860 --> 00:09:01,420
case the file shares they get 30 users

242
00:09:00,100 --> 00:09:03,310
you have a few servers might have

243
00:09:01,420 --> 00:09:04,510
thousands<font color="#E5E5E5"> of files to go through and you</font>

244
00:09:03,310 --> 00:09:07,270
<font color="#E5E5E5">can go</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> that in an afternoon</font>

245
00:09:04,510 --> 00:09:08,740
doesn't take too<font color="#CCCCCC"> much time but as a</font>

246
00:09:07,270 --> 00:09:11,260
network scales we get to bigger

247
00:09:08,740 --> 00:09:12,820
environments you go to thirty thousand

248
00:09:11,260 --> 00:09:15,040
users you're not talking<font color="#E5E5E5"> about thousands</font>

249
00:09:12,820 --> 00:09:16,720
of files you're talking about thousands

250
00:09:15,040 --> 00:09:20,140
of shares each of which might have

251
00:09:16,720 --> 00:09:22,090
thousands of files used to be and when i

252
00:09:20,140 --> 00:09:23,770
first<font color="#CCCCCC"> started realizing the value of</font>

253
00:09:22,090 --> 00:09:26,380
information<font color="#CCCCCC"> that people throw into file</font>

254
00:09:23,770 --> 00:09:28,930
shares<font color="#CCCCCC"> i just use manual techniques go</font>

255
00:09:26,380 --> 00:09:31,000
map the directory and look through it

256
00:09:28,930 --> 00:09:32,890
with with normal clicking around but

257
00:09:31,000 --> 00:09:34,990
it'll<font color="#CCCCCC"> probably drive you nuts if you try</font>

258
00:09:32,890 --> 00:09:37,030
<font color="#E5E5E5">to do that in a big environment because</font>

259
00:09:34,990 --> 00:09:39,160
it's very manual so do<font color="#E5E5E5"> you think well</font>

260
00:09:37,030 --> 00:09:41,949
let's automate that it will find some

261
00:09:39,160 --> 00:09:44,949
SMB client and we'll<font color="#E5E5E5"> just do a recursive</font>

262
00:09:41,950 --> 00:09:47,620
spider in the file share but

263
00:09:44,950 --> 00:09:50,050
unfortunately<font color="#E5E5E5"> it end up with this</font>

264
00:09:47,620 --> 00:09:53,950
situation where if i'll share is often

265
00:09:50,050 --> 00:09:56,170
run very deep and anything that does<font color="#E5E5E5"> use</font>

266
00:09:53,950 --> 00:09:58,750
your regular depth first recursive

267
00:09:56,170 --> 00:10:01,180
traversal of a tree like a file<font color="#CCCCCC"> system</font>

268
00:09:58,750 --> 00:10:05,380
is going<font color="#E5E5E5"> to take forever and you'll end</font>

269
00:10:01,180 --> 00:10:08,380
up punting pretty quickly because you've

270
00:10:05,380 --> 00:10:10,240
got these five or six thousand shares to

271
00:10:08,380 --> 00:10:12,730
go through and the seventh one takes

272
00:10:10,240 --> 00:10:14,620
forever so number<font color="#E5E5E5"> years ago i'd put</font>

273
00:10:12,730 --> 00:10:17,740
together tool been carting around for a

274
00:10:14,620 --> 00:10:21,190
while called plunder which has a couple

275
00:10:17,740 --> 00:10:23,710
<font color="#CCCCCC">of features we do spidering of shares</font>

276
00:10:21,190 --> 00:10:25,780
with some business logic built in to

277
00:10:23,710 --> 00:10:27,190
make the process make more sense so one

278
00:10:25,780 --> 00:10:28,390
is we limit recursion depth you don't

279
00:10:27,190 --> 00:10:30,210
want to go too deep in the file shares

280
00:10:28,390 --> 00:10:34,030
another one you want<font color="#E5E5E5"> to ignore errors</font>

281
00:10:30,210 --> 00:10:36,430
and also you want have configurable

282
00:10:34,030 --> 00:10:37,900
target criteria you want to find the

283
00:10:36,430 --> 00:10:39,760
files that<font color="#E5E5E5"> are most interesting or most</font>

284
00:10:37,900 --> 00:10:42,069
likely to yield something anything named

285
00:10:39,760 --> 00:10:44,980
web.config is going to be a very

286
00:10:42,070 --> 00:10:47,050
<font color="#E5E5E5">interesting file once you do this so you</font>

287
00:10:44,980 --> 00:10:49,450
get used to spy during yeah with this

288
00:10:47,050 --> 00:10:51,579
with the current publicly available

289
00:10:49,450 --> 00:10:54,250
plunder you know<font color="#CCCCCC"> i can effectively</font>

290
00:10:51,580 --> 00:10:56,320
spider a few million files do a few

291
00:10:54,250 --> 00:10:57,970
thousand shares works quite well but<font color="#E5E5E5"> you</font>

292
00:10:56,320 --> 00:11:00,100
end up with another problem and that is

293
00:10:57,970 --> 00:11:03,460
<font color="#E5E5E5">after i have spidered a bunch of shares</font>

294
00:11:00,100 --> 00:11:05,830
<font color="#E5E5E5">i got over 300 web config files so who</font>

295
00:11:03,460 --> 00:11:07,270
wants to SMB clients to each one of

296
00:11:05,830 --> 00:11:08,710
those CD into the directories that

297
00:11:07,270 --> 00:11:10,420
probably all have spaces in

298
00:11:08,710 --> 00:11:11,920
so you have to quote them and it drives

299
00:11:10,420 --> 00:11:13,990
you nuts and you have two more them and

300
00:11:11,920 --> 00:11:16,270
see if<font color="#E5E5E5"> there's a password in it so</font>

301
00:11:13,990 --> 00:11:19,330
plunder also has a feature that does

302
00:11:16,270 --> 00:11:20,939
automatic downloading and mirroring so

303
00:11:19,330 --> 00:11:24,340
the process looks<font color="#CCCCCC"> like this you get a</font>

304
00:11:20,940 --> 00:11:26,380
source of information about<font color="#E5E5E5"> where shares</font>

305
00:11:24,340 --> 00:11:28,660
might be run them through plunder<font color="#CCCCCC"> to</font>

306
00:11:26,380 --> 00:11:30,880
spider the shares<font color="#E5E5E5"> get a list of all</font>

307
00:11:28,660 --> 00:11:32,860
files that your user has access to and

308
00:11:30,880 --> 00:11:34,630
then run that list right back into

309
00:11:32,860 --> 00:11:36,150
plunder after you filtered it out for

310
00:11:34,630 --> 00:11:38,350
the ones you're most interested in and

311
00:11:36,150 --> 00:11:40,689
automatically downloaded mirror them and

312
00:11:38,350 --> 00:11:42,580
then grep gets<font color="#E5E5E5"> you your passwords and</font>

313
00:11:40,690 --> 00:11:44,980
this turns a process that's really

314
00:11:42,580 --> 00:11:47,410
intractable on a<font color="#E5E5E5"> sizable network in a</font>

315
00:11:44,980 --> 00:11:49,150
short amount of time into a very

316
00:11:47,410 --> 00:11:51,569
<font color="#CCCCCC">straightforward and</font><font color="#E5E5E5"> easy one I was</font>

317
00:11:49,150 --> 00:11:53,860
really<font color="#CCCCCC"> hoping that by the time we got to</font>

318
00:11:51,570 --> 00:11:56,200
presentation here that I'd have plunder

319
00:11:53,860 --> 00:11:58,630
to<font color="#E5E5E5"> available it's just not</font><font color="#CCCCCC"> quite</font>

320
00:11:56,200 --> 00:12:00,190
completely<font color="#CCCCCC"> user-friendly yet I can use</font>

321
00:11:58,630 --> 00:12:02,740
<font color="#E5E5E5">it I've gotten some good success out of</font>

322
00:12:00,190 --> 00:12:04,450
it<font color="#CCCCCC"> it's not quite publishable but there</font>

323
00:12:02,740 --> 00:12:06,010
are<font color="#E5E5E5"> some enhancements that I've got in</font>

324
00:12:04,450 --> 00:12:08,290
plunder<font color="#CCCCCC"> two should be</font><font color="#E5E5E5"> hitting soon once</font>

325
00:12:06,010 --> 00:12:10,270
I release it<font color="#E5E5E5"> and this is instead of</font>

326
00:12:08,290 --> 00:12:12,670
doing depth-first spidering do

327
00:12:10,270 --> 00:12:13,960
breadth-first spidering because you want

328
00:12:12,670 --> 00:12:16,719
as much information about<font color="#E5E5E5"> as many</font>

329
00:12:13,960 --> 00:12:17,830
systems as possible as soon as as<font color="#E5E5E5"> you</font>

330
00:12:16,720 --> 00:12:20,500
can you don't<font color="#E5E5E5"> want to get bogged down</font>

331
00:12:17,830 --> 00:12:23,320
into the batch processing server that

332
00:12:20,500 --> 00:12:25,930
has literally millions of files in a

333
00:12:23,320 --> 00:12:27,250
directory tree and do a couple other

334
00:12:25,930 --> 00:12:29,890
things<font color="#E5E5E5"> like hundred percent retention</font>

335
00:12:27,250 --> 00:12:31,930
and spy during data ability to scale up

336
00:12:29,890 --> 00:12:34,420
to millions of files I've indexed up to

337
00:12:31,930 --> 00:12:38,079
I think the last one<font color="#E5E5E5"> I used it on was</font>

338
00:12:34,420 --> 00:12:40,030
like 18 million files in probably three

339
00:12:38,080 --> 00:12:41,230
<font color="#CCCCCC">hours something like that</font><font color="#E5E5E5"> truly isn't so</font>

340
00:12:40,030 --> 00:12:44,110
bad when<font color="#CCCCCC"> you think about what it takes</font>

341
00:12:41,230 --> 00:12:46,180
to click through it and then also more

342
00:12:44,110 --> 00:12:48,220
complex identification of your<font color="#E5E5E5"> target</font>

343
00:12:46,180 --> 00:12:50,680
criteria so I look for that if you're

344
00:12:48,220 --> 00:12:53,080
interested I've only been<font color="#CCCCCC"> to three</font>

345
00:12:50,680 --> 00:12:55,000
environments in the last<font color="#CCCCCC"> ten years</font><font color="#E5E5E5"> that</font>

346
00:12:53,080 --> 00:12:57,010
i know of the right didn't find

347
00:12:55,000 --> 00:12:59,590
something<font color="#E5E5E5"> cool on a file share that was</font>

348
00:12:57,010 --> 00:13:01,120
not supposed to<font color="#CCCCCC"> be</font><font color="#E5E5E5"> there so it's another</font>

349
00:12:59,590 --> 00:13:07,900
one of those infinite vulnerabilities

350
00:13:01,120 --> 00:13:09,250
that will never go away right so like

351
00:13:07,900 --> 00:13:11,530
<font color="#CCCCCC">josh mission at the beginning one of the</font>

352
00:13:09,250 --> 00:13:13,600
things<font color="#CCCCCC"> that we</font><font color="#E5E5E5"> tend to focus on is pci</font>

353
00:13:11,530 --> 00:13:15,220
pentesting but i think we expand that

354
00:13:13,600 --> 00:13:16,990
out to thinking of<font color="#E5E5E5"> it as</font><font color="#CCCCCC"> goal-based</font>

355
00:13:15,220 --> 00:13:19,540
penetration testing because we look at

356
00:13:16,990 --> 00:13:21,340
some different scenarios and one of the

357
00:13:19,540 --> 00:13:22,540
<font color="#CCCCCC">things that they have in common or the</font>

358
00:13:21,340 --> 00:13:25,570
way<font color="#CCCCCC"> we approach it that</font><font color="#E5E5E5"> they had</font>

359
00:13:22,540 --> 00:13:27,699
common is what we typically expect is

360
00:13:25,570 --> 00:13:29,350
that there is an area of high security

361
00:13:27,700 --> 00:13:31,000
where you put all the things that<font color="#CCCCCC"> really</font>

362
00:13:29,350 --> 00:13:33,700
<font color="#E5E5E5">matter and you have the area of low</font>

363
00:13:31,000 --> 00:13:35,770
security where you put all your users

364
00:13:33,700 --> 00:13:38,290
may be and the obviously<font color="#E5E5E5"> they can be</font>

365
00:13:35,770 --> 00:13:39,250
separated out lots of different ways but

366
00:13:38,290 --> 00:13:41,140
they're going<font color="#E5E5E5"> to be some sort of</font>

367
00:13:39,250 --> 00:13:42,760
boundary between these that could be

368
00:13:41,140 --> 00:13:44,920
implemented lots of different<font color="#CCCCCC"> ways but</font>

369
00:13:42,760 --> 00:13:47,350
typically this<font color="#CCCCCC"> is going to be some sort</font>

370
00:13:44,920 --> 00:13:51,040
of segmentation boundary but<font color="#E5E5E5"> you know</font>

371
00:13:47,350 --> 00:13:53,710
network segmentation bouncer<font color="#E5E5E5"> that is but</font>

372
00:13:51,040 --> 00:13:55,240
the reality is that<font color="#E5E5E5"> the complexities</font><font color="#CCCCCC"> of</font>

373
00:13:53,710 --> 00:13:56,980
managing an environment once you get

374
00:13:55,240 --> 00:13:59,260
<font color="#E5E5E5">something that looks like this means</font>

375
00:13:56,980 --> 00:14:01,000
that that<font color="#E5E5E5"> there there can be some</font>

376
00:13:59,260 --> 00:14:02,380
problems we know for a fact that they're

377
00:14:01,000 --> 00:14:04,180
going<font color="#E5E5E5"> to have to access</font><font color="#CCCCCC"> this high street</font>

378
00:14:02,380 --> 00:14:05,680
environment to administer it they're

379
00:14:04,180 --> 00:14:07,510
giving users access for different

380
00:14:05,680 --> 00:14:09,880
reasons so something that starts off

381
00:14:07,510 --> 00:14:11,200
looking like this over time ends up

382
00:14:09,880 --> 00:14:13,810
looking a little bit<font color="#E5E5E5"> more like this and</font>

383
00:14:11,200 --> 00:14:15,460
so this<font color="#E5E5E5"> is relevant because we know as</font>

384
00:14:13,810 --> 00:14:17,349
pen testers when we when we<font color="#CCCCCC"> approached</font>

385
00:14:15,460 --> 00:14:21,010
the pen test we assume there is a hole

386
00:14:17,350 --> 00:14:24,640
somewhere the the job our<font color="#CCCCCC"> job is we have</font>

387
00:14:21,010 --> 00:14:26,410
to<font color="#E5E5E5"> make sure we can find it so let's</font>

388
00:14:24,640 --> 00:14:28,930
talk about<font color="#E5E5E5"> a situation</font><font color="#CCCCCC"> one</font><font color="#E5E5E5"> of the first</font>

389
00:14:26,410 --> 00:14:30,939
times I ran into this and had to sort of

390
00:14:28,930 --> 00:14:33,699
<font color="#E5E5E5">think through the process on the pen</font>

391
00:14:30,940 --> 00:14:36,580
test so<font color="#E5E5E5"> you know I think the scenario</font>

392
00:14:33,700 --> 00:14:39,520
probably mimics what what would be a

393
00:14:36,580 --> 00:14:42,010
common a lot of situations did the

394
00:14:39,520 --> 00:14:44,050
initial scanning of numeration found a

395
00:14:42,010 --> 00:14:46,540
web application<font color="#E5E5E5"> that was poorly secured</font>

396
00:14:44,050 --> 00:14:48,130
a was able to get a<font color="#CCCCCC"> shell find a local</font>

397
00:14:46,540 --> 00:14:51,270
administrator account that<font color="#E5E5E5"> was common in</font>

398
00:14:48,130 --> 00:14:53,200
a group<font color="#CCCCCC"> used that to</font><font color="#E5E5E5"> find some da creds</font>

399
00:14:51,270 --> 00:14:55,630
great but that's pretty meaningless

400
00:14:53,200 --> 00:14:58,300
unless I went after the DA creds for a

401
00:14:55,630 --> 00:15:01,150
very specific reason I want<font color="#E5E5E5"> to use them</font>

402
00:14:58,300 --> 00:15:02,260
<font color="#E5E5E5">to do something right so i just have da</font>

403
00:15:01,150 --> 00:15:04,300
cries that doesn't really do anything

404
00:15:02,260 --> 00:15:05,860
for me<font color="#CCCCCC"> i want</font><font color="#E5E5E5"> to make sure i turn them</font>

405
00:15:04,300 --> 00:15:08,770
into something so the<font color="#E5E5E5"> question becomes</font>

406
00:15:05,860 --> 00:15:11,260
how do<font color="#E5E5E5"> i use da creds to give me access</font>

407
00:15:08,770 --> 00:15:12,579
to this high security environment so<font color="#CCCCCC"> i</font>

408
00:15:11,260 --> 00:15:14,380
think<font color="#E5E5E5"> we go back</font><font color="#CCCCCC"> to the initial</font>

409
00:15:12,580 --> 00:15:15,850
assumption that is there's holes in this

410
00:15:14,380 --> 00:15:20,410
network we just have to ask the right

411
00:15:15,850 --> 00:15:22,360
<font color="#CCCCCC">question to help us to detect them so</font>

412
00:15:20,410 --> 00:15:24,400
thinking about<font color="#E5E5E5"> the so going to that</font>

413
00:15:22,360 --> 00:15:25,900
what's that what's the question well for

414
00:15:24,400 --> 00:15:27,640
me is are there any direct connections

415
00:15:25,900 --> 00:15:29,800
from these low security hosts that

416
00:15:27,640 --> 00:15:31,210
<font color="#CCCCCC">already have access</font><font color="#E5E5E5"> to to the high</font>

417
00:15:29,800 --> 00:15:33,939
security codes that<font color="#CCCCCC"> i don't</font><font color="#E5E5E5"> have access</font>

418
00:15:31,210 --> 00:15:35,860
to access to yet and if<font color="#CCCCCC"> i'm thinking</font>

419
00:15:33,940 --> 00:15:37,660
<font color="#CCCCCC">about an individual system and the net</font>

420
00:15:35,860 --> 00:15:39,670
connections<font color="#E5E5E5"> that it has live the the</font>

421
00:15:37,660 --> 00:15:41,260
first thing<font color="#E5E5E5"> that pops in my head is as</font>

422
00:15:39,670 --> 00:15:43,360
netstat that's a<font color="#E5E5E5"> great way to see what's</font>

423
00:15:41,260 --> 00:15:48,160
what's going on in any in any given

424
00:15:43,360 --> 00:15:50,019
environment so in this situation I

425
00:15:48,160 --> 00:15:51,640
there's<font color="#E5E5E5"> probably lots of ways that</font><font color="#CCCCCC"> you</font>

426
00:15:50,019 --> 00:15:54,510
could go<font color="#CCCCCC"> about collecting a bunch of net</font>

427
00:15:51,640 --> 00:15:57,490
<font color="#CCCCCC">stats right you could use PowerShell</font>

428
00:15:54,510 --> 00:16:01,269
maybe you have meterpreter open on a lot

429
00:15:57,490 --> 00:16:02,140
<font color="#E5E5E5">of different</font><font color="#CCCCCC"> hosts there's i'm sure you</font>

430
00:16:01,269 --> 00:16:04,120
guys<font color="#E5E5E5"> probably could think of some</font>

431
00:16:02,140 --> 00:16:05,740
creative ways to go about this<font color="#E5E5E5"> in this</font>

432
00:16:04,120 --> 00:16:08,019
particular situation i just used win it

433
00:16:05,740 --> 00:16:11,709
<font color="#E5E5E5">win exe and a bachelor to grab them all</font>

434
00:16:08,019 --> 00:16:14,800
the data so now<font color="#CCCCCC"> i have nets that</font><font color="#E5E5E5"> data</font>

435
00:16:11,709 --> 00:16:17,800
from a whole lot<font color="#CCCCCC"> of systems what's the</font>

436
00:16:14,800 --> 00:16:20,019
first thing i want<font color="#CCCCCC"> to do maybe just run</font>

437
00:16:17,800 --> 00:16:21,550
grep so what if I know what my high

438
00:16:20,019 --> 00:16:23,380
security networks look like I can just

439
00:16:21,550 --> 00:16:26,769
check<font color="#CCCCCC"> to see</font><font color="#E5E5E5"> are any of these IPS</font>

440
00:16:23,380 --> 00:16:29,079
present now<font color="#E5E5E5"> unfortunately in the</font>

441
00:16:26,769 --> 00:16:31,029
situation in the<font color="#E5E5E5"> the first time I ran</font>

442
00:16:29,079 --> 00:16:32,019
through this in a pen test this didn't

443
00:16:31,029 --> 00:16:34,120
pan out I didn't find any of these

444
00:16:32,019 --> 00:16:35,620
direct direct connections I've found

445
00:16:34,120 --> 00:16:38,320
since then<font color="#E5E5E5"> that this is actually fairly</font>

446
00:16:35,620 --> 00:16:39,850
common that you will this will get you

447
00:16:38,320 --> 00:16:42,670
get<font color="#CCCCCC"> you something this will help you</font>

448
00:16:39,850 --> 00:16:43,630
find<font color="#E5E5E5"> one of those places so I had to</font>

449
00:16:42,670 --> 00:16:46,029
kind of take this to the next level

450
00:16:43,630 --> 00:16:47,589
which was what do<font color="#E5E5E5"> I do now that I know</font>

451
00:16:46,029 --> 00:16:50,470
there<font color="#E5E5E5"> are no direct connections or at</font>

452
00:16:47,589 --> 00:16:54,070
least none that I was able<font color="#E5E5E5"> to find and</font>

453
00:16:50,470 --> 00:16:55,720
the answer for me was<font color="#E5E5E5"> I reference to</font>

454
00:16:54,070 --> 00:16:57,850
Josh a little bit we sort<font color="#CCCCCC"> talk through</font>

455
00:16:55,720 --> 00:16:59,980
<font color="#CCCCCC">what some ways we could do something</font>

456
00:16:57,850 --> 00:17:02,470
<font color="#E5E5E5">else with this data was visualized it to</font>

457
00:16:59,980 --> 00:17:03,760
come<font color="#CCCCCC"> up with finding some patterns that</font>

458
00:17:02,470 --> 00:17:05,140
<font color="#CCCCCC">may be a</font><font color="#E5E5E5"> little less obvious in the</font>

459
00:17:03,760 --> 00:17:06,819
network maybe would tell me something

460
00:17:05,140 --> 00:17:10,419
that I didn't already know about<font color="#E5E5E5"> what's</font>

461
00:17:06,819 --> 00:17:12,159
<font color="#E5E5E5">going on so Jack text came up with a</font>

462
00:17:10,419 --> 00:17:14,559
little<font color="#E5E5E5"> script that will parse through</font>

463
00:17:12,160 --> 00:17:16,900
the netstat data and turn it into a

464
00:17:14,559 --> 00:17:19,959
graph is dot file with that dot file on

465
00:17:16,900 --> 00:17:22,630
hand we can create<font color="#E5E5E5"> a picture of network</font>

466
00:17:19,959 --> 00:17:24,069
connections given a specific port so why

467
00:17:22,630 --> 00:17:26,350
<font color="#E5E5E5">is this relevant or how does this help</font>

468
00:17:24,069 --> 00:17:27,668
us there's lots of ways there's lots of

469
00:17:26,349 --> 00:17:29,139
patterns you might look<font color="#E5E5E5"> for that are</font>

470
00:17:27,669 --> 00:17:30,970
relevant if we see lots<font color="#E5E5E5"> of connections</font>

471
00:17:29,140 --> 00:17:32,350
coming in and out<font color="#CCCCCC"> of an individual host</font>

472
00:17:30,970 --> 00:17:35,100
maybe that means it's something

473
00:17:32,350 --> 00:17:39,010
significant like a file server or

474
00:17:35,100 --> 00:17:40,360
database depending on on the port but<font color="#E5E5E5"> I</font>

475
00:17:39,010 --> 00:17:41,620
think<font color="#CCCCCC"> the</font><font color="#E5E5E5"> most interesting thing or the</font>

476
00:17:40,360 --> 00:17:44,439
thing that matters the most in<font color="#E5E5E5"> this</font>

477
00:17:41,620 --> 00:17:46,809
situation is those hosts<font color="#E5E5E5"> that the IT</font>

478
00:17:44,440 --> 00:17:48,130
team or the network team either can't

479
00:17:46,809 --> 00:17:48,680
tell you<font color="#E5E5E5"> about because they don't know</font>

480
00:17:48,130 --> 00:17:51,800
or they

481
00:17:48,680 --> 00:17:53,870
want to tell you about so what you might

482
00:17:51,800 --> 00:17:55,700
do is apply this look to see is there a

483
00:17:53,870 --> 00:17:57,139
is<font color="#E5E5E5"> there a host here that I didn't</font>

484
00:17:55,700 --> 00:17:59,390
<font color="#E5E5E5">already know about based on previous</font>

485
00:17:57,140 --> 00:18:02,420
enumeration can I<font color="#E5E5E5"> look for something</font>

486
00:17:59,390 --> 00:18:04,640
unique or individual here and in<font color="#E5E5E5"> this</font>

487
00:18:02,420 --> 00:18:06,410
pen test that the situation was there

488
00:18:04,640 --> 00:18:07,760
was an old bastion host that handful

489
00:18:06,410 --> 00:18:09,890
we're a small group of users was

490
00:18:07,760 --> 00:18:11,750
connecting to over rdp that was

491
00:18:09,890 --> 00:18:13,940
connecting to a production veal and that

492
00:18:11,750 --> 00:18:15,920
everyone could<font color="#CCCCCC"> Fenian tlie forgot about</font>

493
00:18:13,940 --> 00:18:18,410
so once<font color="#CCCCCC"> i</font><font color="#E5E5E5"> was able to find that already</font>

494
00:18:15,920 --> 00:18:22,850
have<font color="#E5E5E5"> creds for the environment and now</font>

495
00:18:18,410 --> 00:18:23,960
<font color="#CCCCCC">i've got the access</font><font color="#E5E5E5"> i'm looking for yeah</font>

496
00:18:22,850 --> 00:18:25,610
it's worth pointing out yet just like

497
00:18:23,960 --> 00:18:28,670
Patrick saying you know a lot<font color="#CCCCCC"> of times</font>

498
00:18:25,610 --> 00:18:31,429
it's not malice it's that I t is so

499
00:18:28,670 --> 00:18:33,490
complex and or networks grow the way

500
00:18:31,430 --> 00:18:36,440
they do kind<font color="#E5E5E5"> of naturally they accrete</font>

501
00:18:33,490 --> 00:18:38,450
complexity and so sometimes looking

502
00:18:36,440 --> 00:18:40,370
empirically at how systems are actually

503
00:18:38,450 --> 00:18:42,650
talking you find legacy things no one

504
00:18:40,370 --> 00:18:44,360
knew is there you find systems that are

505
00:18:42,650 --> 00:18:45,980
talking directly to databases in places

506
00:18:44,360 --> 00:18:47,179
they shouldn't you<font color="#E5E5E5"> know I didn't know</font>

507
00:18:45,980 --> 00:18:49,040
<font color="#CCCCCC">that guy had that</font><font color="#E5E5E5"> spreadsheet with</font>

508
00:18:47,180 --> 00:18:51,110
built-in credentials for<font color="#E5E5E5"> Oracle it's</font>

509
00:18:49,040 --> 00:18:54,590
really really interesting<font color="#CCCCCC"> when you start</font>

510
00:18:51,110 --> 00:18:56,120
data mining this type of information so

511
00:18:54,590 --> 00:18:58,040
next year is a little bit<font color="#CCCCCC"> a little</font><font color="#E5E5E5"> bit</font>

512
00:18:56,120 --> 00:18:59,330
different instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> being a PCI</font>

513
00:18:58,040 --> 00:19:00,920
scenario where we're trying<font color="#E5E5E5"> to get into</font>

514
00:18:59,330 --> 00:19:03,980
<font color="#E5E5E5">the cardholder data environment get all</font>

515
00:19:00,920 --> 00:19:05,690
the credit<font color="#E5E5E5"> card numbers I was working</font>

516
00:19:03,980 --> 00:19:10,160
with a company that's concerned about

517
00:19:05,690 --> 00:19:11,750
product leaks specifically they had had

518
00:19:10,160 --> 00:19:13,670
some situations where someone had leaked

519
00:19:11,750 --> 00:19:15,770
information by products it<font color="#E5E5E5"> is very</font>

520
00:19:13,670 --> 00:19:17,420
interesting scenario it actually is fun

521
00:19:15,770 --> 00:19:20,270
talking through what the actual damage

522
00:19:17,420 --> 00:19:21,650
of a product leak is because it affects

523
00:19:20,270 --> 00:19:23,150
things like the<font color="#E5E5E5"> timing of product</font>

524
00:19:21,650 --> 00:19:24,500
releases it might affect your old

525
00:19:23,150 --> 00:19:25,910
product when people know the new one is

526
00:19:24,500 --> 00:19:28,280
coming out all<font color="#CCCCCC"> kinds of</font><font color="#E5E5E5"> really</font>

527
00:19:25,910 --> 00:19:30,590
interesting things so the objective in

528
00:19:28,280 --> 00:19:32,420
this case<font color="#E5E5E5"> was</font><font color="#CCCCCC"> to find the marketing</font>

529
00:19:30,590 --> 00:19:35,209
assets for unreleased products they were

530
00:19:32,420 --> 00:19:37,760
interested to know how<font color="#E5E5E5"> hard is it for</font>

531
00:19:35,210 --> 00:19:40,670
somebody<font color="#CCCCCC"> to find this information about</font>

532
00:19:37,760 --> 00:19:43,280
new products if they started put in the

533
00:19:40,670 --> 00:19:46,850
network so I don't know about<font color="#CCCCCC"> you but</font>

534
00:19:43,280 --> 00:19:49,310
for<font color="#CCCCCC"> myself I tend to overly romanticized</font>

535
00:19:46,850 --> 00:19:51,620
what I do<font color="#E5E5E5"> and so I like to</font><font color="#CCCCCC"> think of</font>

536
00:19:49,310 --> 00:19:54,500
network as some sort of medieval kingdom

537
00:19:51,620 --> 00:19:56,360
and I figured if I could get<font color="#E5E5E5"> the keys to</font>

538
00:19:54,500 --> 00:19:58,910
the kingdom in<font color="#E5E5E5"> this network then I could</font>

539
00:19:56,360 --> 00:20:01,250
probably find myself haplessly in any

540
00:19:58,910 --> 00:20:02,040
random burg and find out what people are

541
00:20:01,250 --> 00:20:03,420
doing there

542
00:20:02,040 --> 00:20:07,110
we find the folks who create this

543
00:20:03,420 --> 00:20:09,300
content and successfully obtained and

544
00:20:07,110 --> 00:20:11,760
then potentially execrate this new

545
00:20:09,300 --> 00:20:14,940
product marketing information the

546
00:20:11,760 --> 00:20:17,310
problem was it there<font color="#E5E5E5"> I became</font><font color="#CCCCCC"> the king I</font>

547
00:20:14,940 --> 00:20:18,960
had domain admin and yet I still

548
00:20:17,310 --> 00:20:21,389
couldn't find<font color="#E5E5E5"> anything and I'm getting</font>

549
00:20:18,960 --> 00:20:23,490
<font color="#E5E5E5">to the end of the pen testing period and</font>

550
00:20:21,390 --> 00:20:25,860
thinking this is kind of a soft

551
00:20:23,490 --> 00:20:27,930
environment I escalated very easily but

552
00:20:25,860 --> 00:20:29,399
man finding that information is kind of

553
00:20:27,930 --> 00:20:32,370
hard I don't really know what<font color="#E5E5E5"> I'm</font>

554
00:20:29,400 --> 00:20:34,050
looking<font color="#E5E5E5"> for and so I'm kind of casting</font>

555
00:20:32,370 --> 00:20:36,270
about<font color="#E5E5E5"> trying every random little thing I</font>

556
00:20:34,050 --> 00:20:39,060
can think of heart rates going up I'm

557
00:20:36,270 --> 00:20:40,560
<font color="#E5E5E5">living in bullet time and I start</font><font color="#CCCCCC"> going</font>

558
00:20:39,060 --> 00:20:41,940
back over<font color="#CCCCCC"> all the notes all the things</font>

559
00:20:40,560 --> 00:20:44,610
<font color="#CCCCCC">that had</font><font color="#E5E5E5"> collected as I was doing my</font>

560
00:20:41,940 --> 00:20:46,320
scanning and escalation and one of the

561
00:20:44,610 --> 00:20:49,830
quirky things I had enumerated at one

562
00:20:46,320 --> 00:20:53,070
point I had<font color="#E5E5E5"> taken a snapshot of all the</font>

563
00:20:49,830 --> 00:20:54,810
running services on a whole bunch of

564
00:20:53,070 --> 00:20:57,149
machines and everything in the domain

565
00:20:54,810 --> 00:20:59,040
and I think at the time I was casing

566
00:20:57,150 --> 00:21:00,300
them for defensive suites trying to

567
00:20:59,040 --> 00:21:01,830
figure out you know what<font color="#E5E5E5"> AV are they</font>

568
00:21:00,300 --> 00:21:04,169
running or<font color="#CCCCCC"> something like that</font><font color="#E5E5E5"> it had</font>

569
00:21:01,830 --> 00:21:05,250
been essentially uninteresting but I

570
00:21:04,170 --> 00:21:08,250
<font color="#E5E5E5">started</font><font color="#CCCCCC"> looking at the data and</font><font color="#E5E5E5"> I</font>

571
00:21:05,250 --> 00:21:10,550
thought you know I bet people who create

572
00:21:08,250 --> 00:21:12,570
marketing content maybe they're making

573
00:21:10,550 --> 00:21:14,280
3d models for stuff you're doing

574
00:21:12,570 --> 00:21:15,600
graphics they're doing stuff maybe they

575
00:21:14,280 --> 00:21:17,970
have interesting software that other

576
00:21:15,600 --> 00:21:19,709
people don't have and since I have<font color="#E5E5E5"> this</font>

577
00:21:17,970 --> 00:21:20,820
information I thought<font color="#E5E5E5"> I'd start poking</font>

578
00:21:19,710 --> 00:21:24,020
into it do a little bit of data mining

579
00:21:20,820 --> 00:21:26,250
and so what I ended up doing was

580
00:21:24,020 --> 00:21:29,879
generating a little visualization

581
00:21:26,250 --> 00:21:31,560
showing how commonly each of the

582
00:21:29,880 --> 00:21:35,040
services that I had found in those files

583
00:21:31,560 --> 00:21:36,540
occurs so it's really uninteresting if

584
00:21:35,040 --> 00:21:38,010
you look down at the lower left tail

585
00:21:36,540 --> 00:21:40,620
here there are a lot of services<font color="#E5E5E5"> that</font>

586
00:21:38,010 --> 00:21:43,470
<font color="#E5E5E5">run on every computer elsass is running</font>

587
00:21:40,620 --> 00:21:45,060
on every computer for example the the

588
00:21:43,470 --> 00:21:46,890
browser service workstation service etc

589
00:21:45,060 --> 00:21:48,480
so obviously<font color="#E5E5E5"> that's not going to help me</font>

590
00:21:46,890 --> 00:21:50,370
discriminate specific and interesting

591
00:21:48,480 --> 00:21:52,710
targets on the other end of the spectrum

592
00:21:50,370 --> 00:21:54,120
on the top right I'm sorry<font color="#E5E5E5"> I'm getting a</font>

593
00:21:52,710 --> 00:21:55,890
backwards<font color="#CCCCCC"> it's the top right that is</font>

594
00:21:54,120 --> 00:21:57,959
<font color="#E5E5E5">running on all the machines if we look</font>

595
00:21:55,890 --> 00:21:59,550
at the<font color="#E5E5E5"> left we have some services that</font>

596
00:21:57,960 --> 00:22:01,620
<font color="#E5E5E5">run on only a single box and that's just</font>

597
00:21:59,550 --> 00:22:04,440
going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> be the guy that has the Radeon</font>

598
00:22:01,620 --> 00:22:07,229
instead of the nvidia or<font color="#CCCCCC"> its too</font>

599
00:22:04,440 --> 00:22:08,820
<font color="#E5E5E5">discriminating and</font><font color="#CCCCCC"> i thought i bet the</font>

600
00:22:07,230 --> 00:22:12,090
group<font color="#E5E5E5"> of</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> that i'm looking for is</font>

601
00:22:08,820 --> 00:22:14,100
a team is probably<font color="#CCCCCC"> a handful of people</font>

602
00:22:12,090 --> 00:22:15,870
and so I start thinking anything that

603
00:22:14,100 --> 00:22:19,169
shows up in about the tea

604
00:22:15,870 --> 00:22:21,209
sighs set of systems might might

605
00:22:19,170 --> 00:22:23,070
indicate that these this<font color="#E5E5E5"> is a group of</font>

606
00:22:21,210 --> 00:22:27,510
boxes<font color="#CCCCCC"> that are a little bit unique or</font>

607
00:22:23,070 --> 00:22:28,830
interesting so as I go through I did it

608
00:22:27,510 --> 00:22:31,140
looked at everything<font color="#E5E5E5"> that has I think</font>

609
00:22:28,830 --> 00:22:33,090
<font color="#CCCCCC">between 10 and 20 instances across the</font>

610
00:22:31,140 --> 00:22:35,610
domain and i found the solidworks

611
00:22:33,090 --> 00:22:39,120
<font color="#CCCCCC">licensing service anybody know what</font>

612
00:22:35,610 --> 00:22:40,860
solidworks is if you're a 3d printer or

613
00:22:39,120 --> 00:22:42,120
if you ever worked for<font color="#E5E5E5"> an engineering</font>

614
00:22:40,860 --> 00:22:46,679
shop or something probably know<font color="#E5E5E5"> what it</font>

615
00:22:42,120 --> 00:22:48,059
is solidworks is a 3d<font color="#CCCCCC"> cad solution it's</font>

616
00:22:46,680 --> 00:22:50,100
very<font color="#E5E5E5"> nice one it's</font><font color="#CCCCCC"> very expensive i wish</font>

617
00:22:48,059 --> 00:22:53,129
i could have<font color="#E5E5E5"> a copy but it it's quite</font>

618
00:22:50,100 --> 00:22:54,809
expensive and<font color="#E5E5E5"> i thought well there you</font>

619
00:22:53,130 --> 00:22:56,760
go people<font color="#E5E5E5"> are running CAD packages</font>

620
00:22:54,809 --> 00:22:58,649
they're<font color="#E5E5E5"> probably making product data</font>

621
00:22:56,760 --> 00:23:02,070
maybe<font color="#E5E5E5"> they're</font><font color="#CCCCCC"> doing 3d models for the</font>

622
00:22:58,650 --> 00:23:03,990
the new things or whatever so<font color="#CCCCCC"> i have</font>

623
00:23:02,070 --> 00:23:06,360
this<font color="#CCCCCC"> list of 12 boxes that are all CAD</font>

624
00:23:03,990 --> 00:23:08,220
people and of course these people turn

625
00:23:06,360 --> 00:23:10,949
out to be the<font color="#E5E5E5"> CAD designers and the</font><font color="#CCCCCC"> cad</font>

626
00:23:08,220 --> 00:23:12,990
designers do something tricky that<font color="#CCCCCC"> i had</font>

627
00:23:10,950 --> 00:23:15,809
not<font color="#E5E5E5"> really thought of and that was</font><font color="#CCCCCC"> i had</font>

628
00:23:12,990 --> 00:23:17,100
plundered the tar out of all the file

629
00:23:15,809 --> 00:23:18,928
shares<font color="#CCCCCC"> that</font><font color="#E5E5E5"> never found their stuff</font>

630
00:23:17,100 --> 00:23:20,570
because they store it on their local

631
00:23:18,929 --> 00:23:23,220
desktops and they don't<font color="#E5E5E5"> use the shares</font><font color="#CCCCCC"> I</font>

632
00:23:20,570 --> 00:23:25,200
usually exclude see dollar shares

633
00:23:23,220 --> 00:23:28,170
because usually they're not all<font color="#CCCCCC"> that</font>

634
00:23:25,200 --> 00:23:29,700
interesting when<font color="#E5E5E5"> I'm spidering but once</font>

635
00:23:28,170 --> 00:23:31,860
I had those that's the new product

636
00:23:29,700 --> 00:23:34,650
information and i have my success

637
00:23:31,860 --> 00:23:36,928
criteria it was fun about this a part of

638
00:23:34,650 --> 00:23:38,250
it<font color="#E5E5E5"> was</font><font color="#CCCCCC"> the joy of just problem-solving</font>

639
00:23:36,929 --> 00:23:40,890
during a pen test and figuring this

640
00:23:38,250 --> 00:23:43,140
thing out but really it has become a

641
00:23:40,890 --> 00:23:45,630
general strategy that<font color="#CCCCCC"> i use in a lot of</font>

642
00:23:43,140 --> 00:23:47,580
situations fundamentally there are many

643
00:23:45,630 --> 00:23:50,010
cases where<font color="#E5E5E5"> you don't know what the next</font>

644
00:23:47,580 --> 00:23:52,080
step is in the pen test so how do you

645
00:23:50,010 --> 00:23:54,059
how do you<font color="#E5E5E5"> start generating some</font>

646
00:23:52,080 --> 00:23:55,710
potential that you'll<font color="#CCCCCC"> find that next</font>

647
00:23:54,059 --> 00:23:57,840
layer and so there<font color="#E5E5E5"> are a lot of</font>

648
00:23:55,710 --> 00:24:01,080
situations where if<font color="#CCCCCC"> i can identify some</font>

649
00:23:57,840 --> 00:24:02,699
some data some information if<font color="#E5E5E5"> i could</font>

650
00:24:01,080 --> 00:24:04,559
have that information about the whole

651
00:24:02,700 --> 00:24:06,270
environment maybe that would lead me

652
00:24:04,559 --> 00:24:09,178
somewhere or or just help me figure out

653
00:24:06,270 --> 00:24:10,350
which groups are interesting then if

654
00:24:09,179 --> 00:24:12,030
there's some way I can collect<font color="#E5E5E5"> that</font>

655
00:24:10,350 --> 00:24:14,129
usually involves building a little<font color="#E5E5E5"> ad</font>

656
00:24:12,030 --> 00:24:17,010
hoc scanner or something coding skills

657
00:24:14,130 --> 00:24:18,929
are a plus and then once<font color="#E5E5E5"> I get that data</font>

658
00:24:17,010 --> 00:24:21,750
find some way to visualize or mine the

659
00:24:18,929 --> 00:24:24,420
data<font color="#E5E5E5"> and figure out how can I window</font>

660
00:24:21,750 --> 00:24:27,120
this down if I've got forty thousand

661
00:24:24,420 --> 00:24:28,120
users worth of information just looking

662
00:24:27,120 --> 00:24:30,100
at<font color="#CCCCCC"> it unless</font>

663
00:24:28,120 --> 00:24:31,479
is going to take forever and then of

664
00:24:30,100 --> 00:24:33,909
course once once you find the

665
00:24:31,480 --> 00:24:35,680
interesting thing profit so you<font color="#E5E5E5"> just</font>

666
00:24:33,910 --> 00:24:38,140
start thinking of crazy things like<font color="#E5E5E5"> what</font>

667
00:24:35,680 --> 00:24:40,270
if<font color="#E5E5E5"> I had a list of the network</font>

668
00:24:38,140 --> 00:24:42,310
configuration of every adapter on all

669
00:24:40,270 --> 00:24:43,900
systems in<font color="#E5E5E5"> the domain we find people</font>

670
00:24:42,310 --> 00:24:46,000
that have a secondary interface that's

671
00:24:43,900 --> 00:24:48,250
on a special VLAN you find<font color="#E5E5E5"> people that</font>

672
00:24:46,000 --> 00:24:49,780
have you know virtual interfaces and

673
00:24:48,250 --> 00:24:51,670
they're connecting to VPN<font color="#E5E5E5"> s or something</font>

674
00:24:49,780 --> 00:24:53,470
those people become suddenly very

675
00:24:51,670 --> 00:24:55,990
interesting so if I can<font color="#E5E5E5"> just get that</font>

676
00:24:53,470 --> 00:24:58,300
data this may help me discriminate

677
00:24:55,990 --> 00:24:59,830
useful targets if I<font color="#E5E5E5"> get a process</font>

678
00:24:58,300 --> 00:25:01,690
listing from every system you know what

679
00:24:59,830 --> 00:25:03,310
can a process listing do for me yeah

680
00:25:01,690 --> 00:25:05,410
well finding interesting software

681
00:25:03,310 --> 00:25:07,210
especially once I know how they're

682
00:25:05,410 --> 00:25:09,730
connecting to interesting target areas

683
00:25:07,210 --> 00:25:12,670
in the network<font color="#E5E5E5"> you know looking at a</font>

684
00:25:09,730 --> 00:25:14,650
specific file or directories and files

685
00:25:12,670 --> 00:25:16,870
or directories whether they exist or not

686
00:25:14,650 --> 00:25:18,760
like if you see this someone probably

687
00:25:16,870 --> 00:25:21,219
has cisco anyconnect installed so out of

688
00:25:18,760 --> 00:25:23,620
the<font color="#E5E5E5"> thirty thousand users the 129 of</font>

689
00:25:21,220 --> 00:25:25,000
them that have cisco anyconnect they're

690
00:25:23,620 --> 00:25:26,979
more likely to be connecting to my

691
00:25:25,000 --> 00:25:29,500
target zone so this is<font color="#CCCCCC"> a generally</font>

692
00:25:26,980 --> 00:25:31,810
applicable strategy to find a massive

693
00:25:29,500 --> 00:25:35,950
data mine it and use that to lead you to

694
00:25:31,810 --> 00:25:38,110
the next interesting thing so this one

695
00:25:35,950 --> 00:25:40,690
we don't trade<font color="#CCCCCC"> Sarah 5</font><font color="#E5E5E5"> a little bit</font>

696
00:25:38,110 --> 00:25:43,570
different title this<font color="#E5E5E5"> one there will</font>

697
00:25:40,690 --> 00:25:45,190
never be a CV for this<font color="#E5E5E5"> because there are</font>

698
00:25:43,570 --> 00:25:48,040
some things that as a pen tester as

699
00:25:45,190 --> 00:25:49,660
patrick said earlier as the<font color="#E5E5E5"> environment</font>

700
00:25:48,040 --> 00:25:51,909
<font color="#CCCCCC">gets more mature in their security</font>

701
00:25:49,660 --> 00:25:54,820
practices and they have better defensive

702
00:25:51,910 --> 00:25:56,680
tools and less<font color="#E5E5E5"> low-hanging fruit they</font>

703
00:25:54,820 --> 00:25:59,260
incorporate security early on and so

704
00:25:56,680 --> 00:26:02,200
they don't build stuff that's bad you

705
00:25:59,260 --> 00:26:04,240
can't really<font color="#E5E5E5"> rely on having a useful</font>

706
00:26:02,200 --> 00:26:05,950
exploits existing exploit code out there

707
00:26:04,240 --> 00:26:07,660
but there are a lot of things<font color="#CCCCCC"> that work</font>

708
00:26:05,950 --> 00:26:09,490
as an attacker<font color="#E5E5E5"> that you could never</font>

709
00:26:07,660 --> 00:26:11,830
actually make a CD for because there's

710
00:26:09,490 --> 00:26:13,650
never going to be a patch and no one's

711
00:26:11,830 --> 00:26:16,240
ever going to admit responsibility so

712
00:26:13,650 --> 00:26:18,790
this<font color="#CCCCCC"> situation imagine a scenario where</font>

713
00:26:16,240 --> 00:26:21,310
someone has their their pci<font color="#CCCCCC"> card holder</font>

714
00:26:18,790 --> 00:26:25,420
<font color="#E5E5E5">data environment and in order to access</font>

715
00:26:21,310 --> 00:26:27,460
it they use a secure ID or you know duo

716
00:26:25,420 --> 00:26:29,500
or one<font color="#CCCCCC"> of these other multi-factor</font>

717
00:26:27,460 --> 00:26:31,480
solutions and that makes<font color="#E5E5E5"> it</font><font color="#CCCCCC"> very</font>

718
00:26:29,500 --> 00:26:33,040
difficult<font color="#CCCCCC"> I have the whole domain I have</font>

719
00:26:31,480 --> 00:26:34,840
domain admin I have all the passwords

720
00:26:33,040 --> 00:26:36,129
but I don't have these tokens or the

721
00:26:34,840 --> 00:26:38,500
mobile devices or whatever they're using

722
00:26:36,130 --> 00:26:40,090
to<font color="#E5E5E5"> do that second factor and so I'm</font>

723
00:26:38,500 --> 00:26:41,500
actually somewhat effectively stopped

724
00:26:40,090 --> 00:26:43,540
there was

725
00:26:41,500 --> 00:26:46,480
time when I would<font color="#E5E5E5"> kind of just go off a</font>

726
00:26:43,540 --> 00:26:47,950
<font color="#E5E5E5">of mfa I guess you win but it turns out</font>

727
00:26:46,480 --> 00:26:50,470
um fã can be attacked<font color="#E5E5E5"> a lot of</font>

728
00:26:47,950 --> 00:26:53,530
interesting bypasses did present a few

729
00:26:50,470 --> 00:26:55,930
of these a<font color="#E5E5E5"> couple years</font><font color="#CCCCCC"> ago at</font><font color="#E5E5E5"> Derby con</font>

730
00:26:53,530 --> 00:26:57,670
I'm not<font color="#E5E5E5"> going to talk about a bypass in</font>

731
00:26:55,930 --> 00:26:59,440
this sense it's not<font color="#E5E5E5"> going to be exactly</font>

732
00:26:57,670 --> 00:27:01,630
the same kind of thing I'm going<font color="#E5E5E5"> to talk</font>

733
00:26:59,440 --> 00:27:03,580
about something<font color="#CCCCCC"> that has actually become</font>

734
00:27:01,630 --> 00:27:06,520
the first thing I try every time when I

735
00:27:03,580 --> 00:27:09,250
see multi-factor<font color="#E5E5E5"> on in remote desktop</font>

736
00:27:06,520 --> 00:27:12,639
and in order to set up the story have to

737
00:27:09,250 --> 00:27:15,630
introduce you to Bob so Bob is your

738
00:27:12,640 --> 00:27:18,730
standard every day mark one regular user

739
00:27:15,630 --> 00:27:21,100
Bob lives in the cube farm and eats out

740
00:27:18,730 --> 00:27:24,910
his day doing whatever his regular tasks

741
00:27:21,100 --> 00:27:27,969
are and generally it's not so bad except

742
00:27:24,910 --> 00:27:30,430
that<font color="#E5E5E5"> Bob is ruled by a harsh and</font>

743
00:27:27,970 --> 00:27:33,790
unforgiving task mistress and that is

744
00:27:30,430 --> 00:27:35,350
his outlook calendar now his outlet

745
00:27:33,790 --> 00:27:37,659
calendar never actually looks<font color="#E5E5E5"> like this</font>

746
00:27:35,350 --> 00:27:39,669
it's filled up with all kinds of inane

747
00:27:37,660 --> 00:27:41,650
meetings that take up inordinate amounts

748
00:27:39,670 --> 00:27:44,320
of time that's not<font color="#E5E5E5"> all bad because he</font>

749
00:27:41,650 --> 00:27:48,040
<font color="#E5E5E5">gets to go eat every once in a while and</font>

750
00:27:44,320 --> 00:27:49,360
then you got these moments on the social

751
00:27:48,040 --> 00:27:50,590
calendar where you got<font color="#CCCCCC"> to get out and</font>

752
00:27:49,360 --> 00:27:53,110
talk<font color="#CCCCCC"> to the co-workers and find out</font>

753
00:27:50,590 --> 00:27:54,490
what's<font color="#CCCCCC"> going on get the scuttlebutt and</font>

754
00:27:53,110 --> 00:27:55,810
then of course<font color="#E5E5E5"> there's the biological</font>

755
00:27:54,490 --> 00:27:59,140
imperative<font color="#E5E5E5"> to occasionally hit the</font>

756
00:27:55,810 --> 00:28:01,360
restroom I was<font color="#E5E5E5"> having trouble when I</font>

757
00:27:59,140 --> 00:28:03,370
made it<font color="#E5E5E5"> making a smaller slice and still</font>

758
00:28:01,360 --> 00:28:07,659
fitting the font in there so Bob takes a

759
00:28:03,370 --> 00:28:09,459
half hour for bathroom but what it comes

760
00:28:07,660 --> 00:28:11,740
down to is that from Bob's perspective

761
00:28:09,460 --> 00:28:13,870
if it wasn't<font color="#E5E5E5"> for all of these intrusions</font>

762
00:28:11,740 --> 00:28:16,780
on his calendar he could<font color="#E5E5E5"> really get some</font>

763
00:28:13,870 --> 00:28:19,179
work done and the fact is most of the

764
00:28:16,780 --> 00:28:21,910
time in the<font color="#CCCCCC"> work day his</font><font color="#E5E5E5"> computer looks</font>

765
00:28:19,180 --> 00:28:24,580
like this and this we usually would

766
00:28:21,910 --> 00:28:27,570
think of as a security<font color="#E5E5E5"> feature but</font>

767
00:28:24,580 --> 00:28:29,740
actually what's behind this screen is a

768
00:28:27,570 --> 00:28:31,870
currently logged in multi-factor

769
00:28:29,740 --> 00:28:35,080
authentication remote desktop session in

770
00:28:31,870 --> 00:28:36,850
the CDE if I can only peel this back and

771
00:28:35,080 --> 00:28:38,860
get to that session I could just start

772
00:28:36,850 --> 00:28:40,929
clicking on it myself so I started

773
00:28:38,860 --> 00:28:44,139
thinking to myself I'm going to wait

774
00:28:40,930 --> 00:28:45,750
<font color="#E5E5E5">until Bob connects the CDE and then I'm</font>

775
00:28:44,140 --> 00:28:47,980
going<font color="#CCCCCC"> to wait for him to lock his screen</font>

776
00:28:45,750 --> 00:28:49,180
excuse me be castigated password or

777
00:28:47,980 --> 00:28:51,130
crack it from the<font color="#CCCCCC"> domain or whatever I</font>

778
00:28:49,180 --> 00:28:53,950
want to do I'm going<font color="#E5E5E5"> to rdp into his</font>

779
00:28:51,130 --> 00:28:56,799
workstation and then use his

780
00:28:53,950 --> 00:28:59,320
remote desktop session into the CDE find

781
00:28:56,799 --> 00:29:02,080
some persistence vector yeah set up some

782
00:28:59,320 --> 00:29:03,460
ICMP shell or I'll find<font color="#E5E5E5"> that I can talk</font>

783
00:29:02,080 --> 00:29:05,289
out to something or maybe out to the

784
00:29:03,460 --> 00:29:07,389
public internet<font color="#E5E5E5"> whatever it takes and</font>

785
00:29:05,289 --> 00:29:09,760
once<font color="#E5E5E5"> i have that i never have to beat</font>

786
00:29:07,389 --> 00:29:13,539
multi-factor again and<font color="#E5E5E5"> I have continuous</font>

787
00:29:09,760 --> 00:29:15,279
access into the<font color="#CCCCCC"> target zone so this is</font>

788
00:29:13,539 --> 00:29:17,200
<font color="#CCCCCC">something that you can kind of do pretty</font>

789
00:29:15,279 --> 00:29:20,019
easily with with a lot of existing tools

790
00:29:17,200 --> 00:29:22,090
on a small<font color="#CCCCCC"> network you got a relatively</font>

791
00:29:20,019 --> 00:29:23,169
small<font color="#CCCCCC"> number of employees few of them</font>

792
00:29:22,090 --> 00:29:25,299
are going to be connecting to this

793
00:29:23,169 --> 00:29:28,690
highly<font color="#E5E5E5"> secured zone so i can probably</font>

794
00:29:25,299 --> 00:29:29,799
park yeah Mimi cats or something not

795
00:29:28,690 --> 00:29:31,870
meeting again sorry I'm interpreter or

796
00:29:29,799 --> 00:29:34,000
something on their boxes and watch for

797
00:29:31,870 --> 00:29:37,059
<font color="#E5E5E5">those scenarios but it gets a lot harder</font>

798
00:29:34,000 --> 00:29:38,620
when<font color="#E5E5E5"> you scale the network up you might</font>

799
00:29:37,059 --> 00:29:40,120
have hundreds of people who are

800
00:29:38,620 --> 00:29:41,918
connecting to<font color="#E5E5E5"> this zone or in some</font>

801
00:29:40,120 --> 00:29:44,039
places think of like call centers and

802
00:29:41,919 --> 00:29:46,990
stuff you could have thousands of<font color="#E5E5E5"> people</font>

803
00:29:44,039 --> 00:29:49,240
and what's interesting is on the<font color="#E5E5E5"> small</font>

804
00:29:46,990 --> 00:29:51,519
side it doesn't<font color="#E5E5E5"> happen very often you</font>

805
00:29:49,240 --> 00:29:52,870
know it's a tough timing attack you

806
00:29:51,519 --> 00:29:54,429
could you could<font color="#CCCCCC"> wait a whole week and</font>

807
00:29:52,870 --> 00:29:55,658
<font color="#E5E5E5">never actually have that scenario some</font>

808
00:29:54,429 --> 00:29:57,730
people are very fast studious about

809
00:29:55,659 --> 00:29:59,710
locking their screens or logging out

810
00:29:57,730 --> 00:30:01,059
before they get up or other things but

811
00:29:59,710 --> 00:30:03,370
there's this curious thing that happens

812
00:30:01,059 --> 00:30:05,019
with scale and that is that the<font color="#CCCCCC"> number</font>

813
00:30:03,370 --> 00:30:07,840
of people who might<font color="#CCCCCC"> be in this situation</font>

814
00:30:05,019 --> 00:30:11,049
goes up and so the odds that at any

815
00:30:07,840 --> 00:30:13,449
<font color="#CCCCCC">given time there's somebody who has an</font>

816
00:30:11,049 --> 00:30:15,370
active session the CDE and that screen

817
00:30:13,450 --> 00:30:17,740
hasn't locked they have locked their

818
00:30:15,370 --> 00:30:19,629
desktop and they've walked away that

819
00:30:17,740 --> 00:30:22,630
actually<font color="#E5E5E5"> happens quite often in a</font>

820
00:30:19,630 --> 00:30:24,399
<font color="#CCCCCC">sizable network and so this strangely</font>

821
00:30:22,630 --> 00:30:27,309
becomes one of<font color="#E5E5E5"> the most reliable ways to</font>

822
00:30:24,399 --> 00:30:29,649
get into the CDE look for these you just

823
00:30:27,309 --> 00:30:32,710
have to have<font color="#CCCCCC"> a big enough company so the</font>

824
00:30:29,649 --> 00:30:35,620
big<font color="#CCCCCC"> question is on the large scale how</font>

825
00:30:32,710 --> 00:30:37,419
do I find people<font color="#CCCCCC"> with lock screens if</font>

826
00:30:35,620 --> 00:30:38,889
you google search<font color="#CCCCCC"> for that stack</font>

827
00:30:37,419 --> 00:30:41,649
overflow will tell you that hey<font color="#CCCCCC"> maybe</font>

828
00:30:38,889 --> 00:30:43,090
there's this win32<font color="#CCCCCC"> api call and so i can</font>

829
00:30:41,649 --> 00:30:46,029
make<font color="#E5E5E5"> an executable and</font><font color="#CCCCCC"> i can throw that</font>

830
00:30:43,090 --> 00:30:49,570
<font color="#E5E5E5">out to all the machines and that's kind</font>

831
00:30:46,029 --> 00:30:51,580
of that's hard and not<font color="#CCCCCC"> that I am afraid</font>

832
00:30:49,570 --> 00:30:53,970
of writing code but<font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to do</font>

833
00:30:51,580 --> 00:30:56,320
things<font color="#E5E5E5"> the easy way if I can and I found</font>

834
00:30:53,970 --> 00:30:58,450
it's just pretty easy to look<font color="#E5E5E5"> for log on</font>

835
00:30:56,320 --> 00:31:00,279
you i dot exe remember<font color="#CCCCCC"> i said think</font>

836
00:30:58,450 --> 00:31:01,630
<font color="#CCCCCC">about what if I knew the</font><font color="#E5E5E5"> process is</font>

837
00:31:00,279 --> 00:31:04,419
running on all the systems in<font color="#CCCCCC"> the domain</font>

838
00:31:01,630 --> 00:31:06,909
well log on you i dot exe indicates that

839
00:31:04,419 --> 00:31:08,020
the screen is locked<font color="#CCCCCC"> so if i can</font>

840
00:31:06,909 --> 00:31:10,180
correlate information

841
00:31:08,020 --> 00:31:11,980
<font color="#CCCCCC">Patrick talked about how I find out when</font>

842
00:31:10,180 --> 00:31:13,900
they connect to the CDE I can look at

843
00:31:11,980 --> 00:31:15,280
their netstat and now with this<font color="#E5E5E5"> I can</font>

844
00:31:13,900 --> 00:31:17,530
look and see when their screen is locked

845
00:31:15,280 --> 00:31:19,690
so I find connections to target zone by

846
00:31:17,530 --> 00:31:22,180
net set whispering find people with

847
00:31:19,690 --> 00:31:24,880
their screen lock I can use the super

848
00:31:22,180 --> 00:31:26,380
leet hacking tool called grep to compare

849
00:31:24,880 --> 00:31:28,600
the two lists find the intersection and

850
00:31:26,380 --> 00:31:31,840
use a regular remote desktop session to

851
00:31:28,600 --> 00:31:33,760
connect so that when it<font color="#E5E5E5"> comes down</font><font color="#CCCCCC"> to is</font>

852
00:31:31,840 --> 00:31:36,280
I can write a short script that at any

853
00:31:33,760 --> 00:31:38,350
<font color="#CCCCCC">given time pumps out a list of ips that</font>

854
00:31:36,280 --> 00:31:42,070
meet these criteria big enough network

855
00:31:38,350 --> 00:31:44,649
there's<font color="#E5E5E5"> always an IP in the list so</font>

856
00:31:42,070 --> 00:31:46,300
there<font color="#CCCCCC"> are a couple a couple</font><font color="#E5E5E5"> of things</font><font color="#CCCCCC"> to</font>

857
00:31:44,650 --> 00:31:47,980
<font color="#E5E5E5">think about probably the biggest</font>

858
00:31:46,300 --> 00:31:49,270
objection that I get most often

859
00:31:47,980 --> 00:31:51,400
especially if I<font color="#E5E5E5"> talk it through with the</font>

860
00:31:49,270 --> 00:31:53,050
customer they'll say yeah but you know

861
00:31:51,400 --> 00:31:55,000
baby bear might come back and find that

862
00:31:53,050 --> 00:31:56,980
somebody's been sleeping in his bed it

863
00:31:55,000 --> 00:31:59,830
raised the alarm and how could<font color="#E5E5E5"> that</font>

864
00:31:56,980 --> 00:32:01,660
really be a useful attack and that

865
00:31:59,830 --> 00:32:03,399
<font color="#E5E5E5">that's fair you know if you came</font><font color="#CCCCCC"> back to</font>

866
00:32:01,660 --> 00:32:06,310
<font color="#E5E5E5">your desk and you saw row desktop had</font>

867
00:32:03,400 --> 00:32:07,780
extra windows in it yeah or you see<font color="#E5E5E5"> this</font>

868
00:32:06,310 --> 00:32:09,700
big<font color="#E5E5E5"> PowerShell one liner that I was in</font>

869
00:32:07,780 --> 00:32:12,700
the middle<font color="#E5E5E5"> of typing and the run dialog</font>

870
00:32:09,700 --> 00:32:15,190
I<font color="#E5E5E5"> probably freak you out but it turns</font>

871
00:32:12,700 --> 00:32:17,170
out it's actually non-issue because the

872
00:32:15,190 --> 00:32:19,780
first thing<font color="#CCCCCC"> that I saw when I logged</font>

873
00:32:17,170 --> 00:32:21,760
into his remote desktop session I was

874
00:32:19,780 --> 00:32:23,230
his calendar and I can see that he's

875
00:32:21,760 --> 00:32:26,110
going<font color="#E5E5E5"> to be stuck in</font><font color="#CCCCCC"> that change control</font>

876
00:32:23,230 --> 00:32:27,640
meeting for a solid hour and man if you

877
00:32:26,110 --> 00:32:29,620
can't find a persistence vector in an

878
00:32:27,640 --> 00:32:31,930
hour then you have no business trying to

879
00:32:29,620 --> 00:32:34,120
<font color="#E5E5E5">do this type of attack so really this</font>

880
00:32:31,930 --> 00:32:36,400
turns out to be so dumb I can't<font color="#CCCCCC"> believe</font>

881
00:32:34,120 --> 00:32:38,469
it actually works but in because most

882
00:32:36,400 --> 00:32:40,960
environments are not just you know<font color="#E5E5E5"> five</font>

883
00:32:38,470 --> 00:32:42,070
people using their computers it's

884
00:32:40,960 --> 00:32:44,080
usually going to be hundreds or

885
00:32:42,070 --> 00:32:46,240
thousands or tens of thousands<font color="#E5E5E5"> of people</font>

886
00:32:44,080 --> 00:32:48,040
it means that<font color="#CCCCCC"> we can</font><font color="#E5E5E5"> play the numbers</font>

887
00:32:46,240 --> 00:32:50,380
and will<font color="#E5E5E5"> always find these types of</font>

888
00:32:48,040 --> 00:32:56,440
situations if I<font color="#E5E5E5"> could</font><font color="#CCCCCC"> just figure</font><font color="#E5E5E5"> out a</font>

889
00:32:50,380 --> 00:32:59,080
way to detect them alright so this last

890
00:32:56,440 --> 00:33:02,740
situation really kind of focuses in on

891
00:32:59,080 --> 00:33:04,419
looking<font color="#E5E5E5"> for the target data so you know</font>

892
00:33:02,740 --> 00:33:07,870
you might have a full compromise and

893
00:33:04,420 --> 00:33:09,850
have lots of great shells but<font color="#E5E5E5"> unless you</font>

894
00:33:07,870 --> 00:33:11,320
looked and found the the data that

895
00:33:09,850 --> 00:33:14,409
really matters<font color="#CCCCCC"> to the customer what he</font>

896
00:33:11,320 --> 00:33:16,899
really accomplished<font color="#E5E5E5"> I saw in this in</font>

897
00:33:14,410 --> 00:33:18,909
this engagement I had

898
00:33:16,899 --> 00:33:22,059
had affected fool compromise of the

899
00:33:18,909 --> 00:33:24,309
corporate and this was a pci<font color="#CCCCCC"> pen test so</font>

900
00:33:22,059 --> 00:33:25,779
the cardholder data networks I had the

901
00:33:24,309 --> 00:33:28,389
main admin everywhere<font color="#E5E5E5"> I had shells</font>

902
00:33:25,779 --> 00:33:30,279
everywhere but I had become frustrated

903
00:33:28,389 --> 00:33:32,320
because I hadn't actually found any

904
00:33:30,279 --> 00:33:35,249
large caches of the data I was I was

905
00:33:32,320 --> 00:33:38,710
hunting for I'd looked at databases and

906
00:33:35,249 --> 00:33:40,389
but that's a that<font color="#E5E5E5"> I didn't feel good</font>

907
00:33:38,710 --> 00:33:43,960
<font color="#E5E5E5">about what the results of the pen tests</font>

908
00:33:40,389 --> 00:33:46,748
were at that<font color="#E5E5E5"> point so</font><font color="#CCCCCC"> like I said I had</font>

909
00:33:43,960 --> 00:33:49,299
I have you know in the<font color="#E5E5E5"> process of</font>

910
00:33:46,749 --> 00:33:51,759
creating or of going through the

911
00:33:49,299 --> 00:33:55,089
<font color="#E5E5E5">exploitation I had opened up quite a few</font>

912
00:33:51,759 --> 00:33:56,499
interpreter shelves and I thought well

913
00:33:55,089 --> 00:33:57,580
maybe there's some sub data that would

914
00:33:56,499 --> 00:34:00,129
point me in the right direction I just

915
00:33:57,580 --> 00:34:01,509
haven't thought about yet so I started

916
00:34:00,129 --> 00:34:03,488
thinking about<font color="#E5E5E5"> okay who are the users</font>

917
00:34:01,509 --> 00:34:04,839
who actually access this data because I

918
00:34:03,489 --> 00:34:07,029
know somebody's using the data I know

919
00:34:04,839 --> 00:34:08,739
somebody's accessing it who are they

920
00:34:07,029 --> 00:34:10,480
<font color="#E5E5E5">what groups for might they be</font><font color="#CCCCCC"> n is there</font>

921
00:34:08,739 --> 00:34:15,219
some way<font color="#CCCCCC"> I could I can distinguish one</font>

922
00:34:10,480 --> 00:34:16,539
from the other so started looking at one

923
00:34:15,219 --> 00:34:19,118
<font color="#E5E5E5">of the first things I grabbed was a list</font>

924
00:34:16,539 --> 00:34:21,339
of users<font color="#CCCCCC"> and their group memberships I</font>

925
00:34:19,119 --> 00:34:23,349
you just like to use the<font color="#CCCCCC"> for linux tool</font>

926
00:34:21,339 --> 00:34:26,168
<font color="#E5E5E5">just because</font><font color="#CCCCCC"> i like</font><font color="#E5E5E5"> the handy tool is</font>

927
00:34:23,349 --> 00:34:29,589
pretty easy to grep through so look for

928
00:34:26,168 --> 00:34:31,868
who's a member of what groups and then

929
00:34:29,589 --> 00:34:33,609
kind of extending on<font color="#CCCCCC"> josh's idea looking</font>

930
00:34:31,869 --> 00:34:37,750
for the processes that they might have

931
00:34:33,609 --> 00:34:39,759
so point it was kind of manual right<font color="#CCCCCC"> i</font>

932
00:34:37,750 --> 00:34:41,799
look for the look at the user<font color="#E5E5E5"> and maybe</font>

933
00:34:39,760 --> 00:34:43,329
look at<font color="#E5E5E5"> the</font><font color="#CCCCCC"> groups and I'm kind of kind</font>

934
00:34:41,799 --> 00:34:45,009
of picking at random we're looking for

935
00:34:43,329 --> 00:34:47,020
groups that might be interesting but<font color="#E5E5E5"> I'm</font>

936
00:34:45,010 --> 00:34:49,210
really this was an exceptionally large

937
00:34:47,020 --> 00:34:51,250
network so I wasn't have a lot of

938
00:34:49,210 --> 00:34:52,449
success but just kind of picking these

939
00:34:51,250 --> 00:34:57,539
things together and trying to correlate

940
00:34:52,449 --> 00:35:00,669
you know something useful out of it so

941
00:34:57,539 --> 00:35:05,849
like any good pen tester I decided to

942
00:35:00,670 --> 00:35:09,130
<font color="#E5E5E5">write some code and the idea was to</font>

943
00:35:05,849 --> 00:35:12,220
<font color="#CCCCCC">start by trading nested JSON objects</font>

944
00:35:09,130 --> 00:35:14,829
that let<font color="#CCCCCC"> me see what what the users were</font>

945
00:35:12,220 --> 00:35:16,058
members of which groups and then being

946
00:35:14,829 --> 00:35:17,950
able to connect that to the processes

947
00:35:16,059 --> 00:35:19,750
they were running based on what I could

948
00:35:17,950 --> 00:35:25,558
see from the the nets that are from the

949
00:35:19,750 --> 00:35:27,279
the<font color="#E5E5E5"> task with the output and excuse me</font>

950
00:35:25,559 --> 00:35:29,890
<font color="#CCCCCC">unfortunately this</font><font color="#E5E5E5"> tool isn't isn't</font>

951
00:35:27,279 --> 00:35:30,820
ready for<font color="#E5E5E5"> public consumption yet my goal</font>

952
00:35:29,890 --> 00:35:34,629
is to have it

953
00:35:30,820 --> 00:35:36,580
by the end of august but<font color="#CCCCCC"> will i'll set</font>

954
00:35:34,630 --> 00:35:38,230
the<font color="#E5E5E5"> ad the publish date and so just</font>

955
00:35:36,580 --> 00:35:42,310
follow me on twitter<font color="#CCCCCC"> or something</font>

956
00:35:38,230 --> 00:35:43,690
<font color="#E5E5E5">shameless plug so the idea here was I</font>

957
00:35:42,310 --> 00:35:45,070
wanted<font color="#E5E5E5"> to find</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> way to automate this</font>

958
00:35:43,690 --> 00:35:47,320
process a little bit<font color="#E5E5E5"> actually find some</font>

959
00:35:45,070 --> 00:35:49,840
useful data and so what did is applied

960
00:35:47,320 --> 00:35:51,700
some questioning algorithm to those

961
00:35:49,840 --> 00:35:53,200
nests<font color="#E5E5E5"> to JSON object to see where their</font>

962
00:35:51,700 --> 00:35:55,410
distinct groups something that tied them

963
00:35:53,200 --> 00:35:58,060
together by process by a user group

964
00:35:55,410 --> 00:36:00,129
something that helped me identify you

965
00:35:58,060 --> 00:36:01,420
know some who were the actual unique

966
00:36:00,130 --> 00:36:04,750
groups not just by Active Directory

967
00:36:01,420 --> 00:36:06,790
membership and so what I was able<font color="#E5E5E5"> to do</font>

968
00:36:04,750 --> 00:36:08,650
by by applying these clustering

969
00:36:06,790 --> 00:36:10,060
algorithms was turn something<font color="#E5E5E5"> that was a</font>

970
00:36:08,650 --> 00:36:11,710
little more vague and<font color="#CCCCCC"> did something that</font>

971
00:36:10,060 --> 00:36:13,720
<font color="#E5E5E5">was very specific so i was able to break</font>

972
00:36:11,710 --> 00:36:16,150
down users what they were doing what

973
00:36:13,720 --> 00:36:18,040
<font color="#E5E5E5">kind of tasks they were running and the</font>

974
00:36:16,150 --> 00:36:20,620
thing<font color="#CCCCCC"> that was maybe kind of elusive</font>

975
00:36:18,040 --> 00:36:23,140
about it initially was some of these

976
00:36:20,620 --> 00:36:24,819
<font color="#CCCCCC">processes are kind of generic everybody</font>

977
00:36:23,140 --> 00:36:26,890
in the organization except for customer

978
00:36:24,820 --> 00:36:27,910
<font color="#CCCCCC">service is running</font><font color="#E5E5E5"> chrome I see that</font>

979
00:36:26,890 --> 00:36:30,879
there's<font color="#E5E5E5"> one group of people</font><font color="#CCCCCC"> who also</font>

980
00:36:27,910 --> 00:36:32,109
have Chrome Internet Explorer open so

981
00:36:30,880 --> 00:36:34,960
maybe<font color="#E5E5E5"> this is what they're using to</font>

982
00:36:32,110 --> 00:36:36,790
access an application in there and there

983
00:36:34,960 --> 00:36:40,060
are high security network or the CDE the

984
00:36:36,790 --> 00:36:41,050
cardholder data network and based<font color="#E5E5E5"> on the</font>

985
00:36:40,060 --> 00:36:43,390
recommendation of one of our co-workers

986
00:36:41,050 --> 00:36:46,240
<font color="#CCCCCC">I grabbed CC search which will pull down</font>

987
00:36:43,390 --> 00:36:48,069
will help me look for credit<font color="#CCCCCC"> card data</font>

988
00:36:46,240 --> 00:36:50,410
and run it against the temporary

989
00:36:48,070 --> 00:36:52,360
<font color="#CCCCCC">internet files</font><font color="#E5E5E5"> of learning to explore</font>

990
00:36:50,410 --> 00:36:54,569
and boom every single one of these users

991
00:36:52,360 --> 00:36:57,610
has quite firm ation that's relevant to

992
00:36:54,570 --> 00:36:59,530
to to my pen test and now I feel<font color="#E5E5E5"> like</font>

993
00:36:57,610 --> 00:37:00,850
<font color="#E5E5E5">I've done something successful it turns</font>

994
00:36:59,530 --> 00:37:02,950
out I probably didn't even need to

995
00:37:00,850 --> 00:37:04,390
access the their high security network

996
00:37:02,950 --> 00:37:05,740
because all the data is sitting right

997
00:37:04,390 --> 00:37:09,430
there and they're low security network

998
00:37:05,740 --> 00:37:11,109
in the first place<font color="#CCCCCC"> so now I</font><font color="#E5E5E5"> don't have</font>

999
00:37:09,430 --> 00:37:15,430
to<font color="#CCCCCC"> ask the question</font><font color="#E5E5E5"> of what's the actual</font>

1000
00:37:11,110 --> 00:37:17,380
profitable path of this pen test so i

1001
00:37:15,430 --> 00:37:18,819
<font color="#E5E5E5">think what josh and i we first start</font>

1002
00:37:17,380 --> 00:37:20,260
talking about<font color="#E5E5E5"> what we were going to do</font>

1003
00:37:18,820 --> 00:37:25,200
with this this talk for the presentation

1004
00:37:20,260 --> 00:37:27,940
<font color="#E5E5E5">was try to apply something tactically</font>

1005
00:37:25,200 --> 00:37:30,609
our tactical mindset when we<font color="#CCCCCC"> approached</font>

1006
00:37:27,940 --> 00:37:32,350
these security security problems that

1007
00:37:30,610 --> 00:37:35,080
are keeping us from getting the data we

1008
00:37:32,350 --> 00:37:37,690
<font color="#E5E5E5">want and actually attaching them to some</font>

1009
00:37:35,080 --> 00:37:40,240
practical process for bypassing these

1010
00:37:37,690 --> 00:37:41,650
security flaws that we hope that you can

1011
00:37:40,240 --> 00:37:42,729
actually walk away with something useful

1012
00:37:41,650 --> 00:37:49,240
from

1013
00:37:42,730 --> 00:37:51,550
<font color="#E5E5E5">I also add in conclusion some of this if</font>

1014
00:37:49,240 --> 00:37:53,830
you think about it I<font color="#E5E5E5"> I saw I think</font>

1015
00:37:51,550 --> 00:37:54,910
verizon just published another update to

1016
00:37:53,830 --> 00:37:57,069
the date of<font color="#E5E5E5"> reach but I know the last</font>

1017
00:37:54,910 --> 00:37:59,710
one I had read from them said that<font color="#E5E5E5"> your</font>

1018
00:37:57,070 --> 00:38:01,300
typical intruder resides in your<font color="#E5E5E5"> network</font>

1019
00:37:59,710 --> 00:38:03,010
for something like eight<font color="#CCCCCC"> months I</font><font color="#E5E5E5"> think</font>

1020
00:38:01,300 --> 00:38:06,190
the average if anybody<font color="#CCCCCC"> knows a better</font>

1021
00:38:03,010 --> 00:38:07,960
more precise figure let me know but as a

1022
00:38:06,190 --> 00:38:09,970
pen tester I don't have the luxury to

1023
00:38:07,960 --> 00:38:12,609
just start combing through the

1024
00:38:09,970 --> 00:38:14,649
environment one little bit at a time and

1025
00:38:12,609 --> 00:38:17,560
so sometimes when we're trying to do a

1026
00:38:14,650 --> 00:38:21,640
<font color="#E5E5E5">good job pen testing for a customer</font>

1027
00:38:17,560 --> 00:38:24,400
we're<font color="#E5E5E5"> trying to make a safe marketable a</font>

1028
00:38:21,640 --> 00:38:28,118
professional process and help us

1029
00:38:24,400 --> 00:38:29,260
understand the other process that it

1030
00:38:28,119 --> 00:38:30,960
takes eight months<font color="#E5E5E5"> and would cost too</font>

1031
00:38:29,260 --> 00:38:33,670
much if we could do that<font color="#E5E5E5"> and so</font>

1032
00:38:30,960 --> 00:38:36,100
sometimes we have to come up with a

1033
00:38:33,670 --> 00:38:37,840
solution a technique for finding out

1034
00:38:36,100 --> 00:38:40,630
information much faster so a lot of this

1035
00:38:37,840 --> 00:38:41,890
is about efficiency but also sometimes a

1036
00:38:40,630 --> 00:38:44,560
lot of it is about building up an

1037
00:38:41,890 --> 00:38:46,540
empirical model of the environment so

1038
00:38:44,560 --> 00:38:47,710
that we can see<font color="#E5E5E5"> things that I t doesn't</font>

1039
00:38:46,540 --> 00:38:50,830
see because they thought they built it

1040
00:38:47,710 --> 00:38:52,140
right so anyway with that I think<font color="#E5E5E5"> we</font>

1041
00:38:50,830 --> 00:38:55,170
have a<font color="#E5E5E5"> little bit of time for questions</font>

1042
00:38:52,140 --> 00:38:55,170
feel free

