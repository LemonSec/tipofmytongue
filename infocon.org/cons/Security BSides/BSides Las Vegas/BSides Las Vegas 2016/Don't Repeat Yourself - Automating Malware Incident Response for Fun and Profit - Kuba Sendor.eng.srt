1
00:00:00,000 --> 00:00:04,980
hi hello my name is kuba I'm working as

2
00:00:03,149 --> 00:00:08,219
a software engineer in security team at

3
00:00:04,980 --> 00:00:10,080
Yelp and I'm here to tell<font color="#CCCCCC"> you today</font>

4
00:00:08,220 --> 00:00:14,610
about how we automated our model

5
00:00:10,080 --> 00:00:20,070
response at Yelp so first couple words

6
00:00:14,610 --> 00:00:22,740
about me i started<font color="#E5E5E5"> at</font><font color="#CCCCCC"> Yelp around two</font>

7
00:00:20,070 --> 00:00:24,930
years<font color="#E5E5E5"> ago and since then I've been</font>

8
00:00:22,740 --> 00:00:27,000
mostly involved in our malware incident

9
00:00:24,930 --> 00:00:30,500
response process and also<font color="#E5E5E5"> in the</font>

10
00:00:27,000 --> 00:00:34,320
meantime automating and basically

11
00:00:30,500 --> 00:00:35,940
working on our security processes before

12
00:00:34,320 --> 00:00:37,380
that<font color="#CCCCCC"> I used to</font><font color="#E5E5E5"> work at sa p in</font>

13
00:00:35,940 --> 00:00:39,210
<font color="#CCCCCC">sovereignty</font><font color="#E5E5E5"> policies in</font><font color="#CCCCCC"> France in a</font>

14
00:00:37,380 --> 00:00:42,120
security interest research group and

15
00:00:39,210 --> 00:00:44,670
prior to that I was studying in Krakow

16
00:00:42,120 --> 00:00:47,578
and also doing<font color="#E5E5E5"> joint degree with the</font>

17
00:00:44,670 --> 00:00:50,460
<font color="#CCCCCC">university of telecom perry tag this is</font>

18
00:00:47,579 --> 00:00:52,469
your<font color="#E5E5E5"> home also in sophia antipolis so</font>

19
00:00:50,460 --> 00:00:54,660
just sort of a quick recap yelped

20
00:00:52,469 --> 00:00:58,770
mission is to connect people<font color="#E5E5E5"> with great</font>

21
00:00:54,660 --> 00:01:01,169
local businesses and this led over<font color="#CCCCCC"> the</font>

22
00:00:58,770 --> 00:01:06,630
past 12 years since the company<font color="#E5E5E5"> started</font>

23
00:01:01,170 --> 00:01:08,700
<font color="#E5E5E5">to over 102 million reviews as you can</font>

24
00:01:06,630 --> 00:01:10,408
see<font color="#E5E5E5"> on this slide 19 billion of the</font>

25
00:01:08,700 --> 00:01:13,200
users are<font color="#CCCCCC"> coming from the mobile</font>

26
00:01:10,409 --> 00:01:14,909
websites and applications around seventy

27
00:01:13,200 --> 00:01:17,810
percent of<font color="#E5E5E5"> the stretches are also from</font>

28
00:01:14,909 --> 00:01:22,740
mobile<font color="#E5E5E5"> and web apps mobile apps and</font>

29
00:01:17,810 --> 00:01:25,200
basic our mobile app website and right

30
00:01:22,740 --> 00:01:28,710
now yep<font color="#CCCCCC"> Yelp is present 32 countries</font>

31
00:01:25,200 --> 00:01:30,750
worldwide so what I'm<font color="#CCCCCC"> trying to say by</font>

32
00:01:28,710 --> 00:01:32,880
showing you all<font color="#E5E5E5"> these stats is basically</font>

33
00:01:30,750 --> 00:01:35,119
we have<font color="#E5E5E5"> more than 4,000 employees by now</font>

34
00:01:32,880 --> 00:01:40,320
and most of<font color="#E5E5E5"> them are</font><font color="#CCCCCC"> actually using</font>

35
00:01:35,119 --> 00:01:42,210
macbooks to do their daily job so sort

36
00:01:40,320 --> 00:01:44,850
of acquainting interaction to our<font color="#E5E5E5"> model</font>

37
00:01:42,210 --> 00:01:47,250
or incident response process this sort

38
00:01:44,850 --> 00:01:52,048
<font color="#E5E5E5">of starts when one of our employees gets</font>

39
00:01:47,250 --> 00:01:53,909
an alert either like some detection by

40
00:01:52,049 --> 00:01:57,240
our endpoint monitoring software or some

41
00:01:53,909 --> 00:01:58,950
network monitoring stuff that detect

42
00:01:57,240 --> 00:02:01,229
some suspicious binaries on the user's

43
00:01:58,950 --> 00:02:02,759
machine or some suspicious net worth

44
00:02:01,229 --> 00:02:06,030
<font color="#E5E5E5">dropping coming from from a particular</font>

45
00:02:02,759 --> 00:02:08,729
machine but just let me<font color="#E5E5E5"> first introduce</font>

46
00:02:06,030 --> 00:02:10,979
<font color="#CCCCCC">you sort</font><font color="#E5E5E5"> of two people involved in all</font>

47
00:02:08,729 --> 00:02:12,540
this process so fast<font color="#E5E5E5"> will have a Yelp</font>

48
00:02:10,979 --> 00:02:14,730
employee

49
00:02:12,540 --> 00:02:16,439
who typically uses macbook to perform

50
00:02:14,730 --> 00:02:19,108
<font color="#CCCCCC">its daily duties and from time to time</font>

51
00:02:16,439 --> 00:02:21,780
they will wonder to some<font color="#CCCCCC"> grey sides of</font>

52
00:02:19,109 --> 00:02:25,349
the internet right for instance<font color="#CCCCCC"> Gettler</font>

53
00:02:21,780 --> 00:02:27,930
to download latest update to adobe flash

54
00:02:25,349 --> 00:02:29,760
player or some free video converter app

55
00:02:27,930 --> 00:02:33,359
which comes packaged with malware also

56
00:02:29,760 --> 00:02:35,159
<font color="#E5E5E5">for free we have</font><font color="#CCCCCC"> help desk engineers so</font>

57
00:02:33,359 --> 00:02:40,579
they are<font color="#E5E5E5"> kind of serving as an interface</font>

58
00:02:35,159 --> 00:02:43,138
<font color="#E5E5E5">between users and ask the security team</font>

59
00:02:40,579 --> 00:02:45,389
how does engineers are the best people

60
00:02:43,139 --> 00:02:47,010
to perform all this task they have best

61
00:02:45,389 --> 00:02:49,530
outreach to the users in terms of both

62
00:02:47,010 --> 00:02:51,959
different<font color="#E5E5E5"> time zones and different</font>

63
00:02:49,530 --> 00:02:54,470
locations because Yelp is also present

64
00:02:51,959 --> 00:02:56,669
in various locations around the globe

65
00:02:54,470 --> 00:02:59,930
our offices are in<font color="#E5E5E5"> various locations</font>

66
00:02:56,669 --> 00:03:04,139
around ago and we have<font color="#CCCCCC"> also secured team</font>

67
00:02:59,930 --> 00:03:05,400
that is also consisting on Morales so

68
00:03:04,139 --> 00:03:09,569
the people who are basically in charge

69
00:03:05,400 --> 00:03:13,470
of analyzing the alerts about malware on

70
00:03:09,569 --> 00:03:15,988
modern infections on someone machines so

71
00:03:13,470 --> 00:03:17,790
job of malware<font color="#E5E5E5"> analyst is typically to</font>

72
00:03:15,989 --> 00:03:19,729
answer these three questions how the

73
00:03:17,790 --> 00:03:22,888
malware got there in<font color="#E5E5E5"> the</font><font color="#CCCCCC"> first place</font>

74
00:03:19,729 --> 00:03:25,139
well is the<font color="#CCCCCC"> Machine even infected or not</font>

75
00:03:22,889 --> 00:03:28,650
and how we can<font color="#E5E5E5"> prevent and detect</font>

76
00:03:25,139 --> 00:03:31,079
further infections to sort of stop

77
00:03:28,650 --> 00:03:36,269
spreading malware all over our company

78
00:03:31,079 --> 00:03:39,150
infrastructure so there used to be lots

79
00:03:36,269 --> 00:03:41,430
of false positive in our approach in the

80
00:03:39,150 --> 00:03:44,549
alerts we were receiving so we started

81
00:03:41,430 --> 00:03:46,019
involving malware<font color="#CCCCCC"> analysts as early in</font>

82
00:03:44,549 --> 00:03:49,260
the process as possible so<font color="#CCCCCC"> we are doing</font>

83
00:03:46,019 --> 00:03:52,799
this initial 38 and this is basically<font color="#E5E5E5"> to</font>

84
00:03:49,260 --> 00:03:55,019
establish whether this is<font color="#E5E5E5"> real</font><font color="#CCCCCC"> error</font>

85
00:03:52,799 --> 00:03:57,449
alert or a false positive whether it's

86
00:03:55,019 --> 00:03:59,790
something<font color="#E5E5E5"> like Windows Fred on Mac OS</font>

87
00:03:57,449 --> 00:04:02,310
machines that we don't<font color="#E5E5E5"> really care</font><font color="#CCCCCC"> about</font>

88
00:03:59,790 --> 00:04:04,138
and this is<font color="#E5E5E5"> sort of to save us time from</font>

89
00:04:02,310 --> 00:04:06,299
all<font color="#E5E5E5"> these other tasks like forensics</font>

90
00:04:04,139 --> 00:04:08,759
collection and 4 x's allottees so we can

91
00:04:06,299 --> 00:04:10,620
weave out as filter out sort<font color="#E5E5E5"> of as</font>

92
00:04:08,759 --> 00:04:12,448
quickly as<font color="#CCCCCC"> possible whether this is</font><font color="#E5E5E5"> a</font>

93
00:04:10,620 --> 00:04:16,680
real threat or not there's always<font color="#E5E5E5"> saving</font>

94
00:04:12,449 --> 00:04:18,539
us some time but<font color="#E5E5E5"> our traditional sort of</font>

95
00:04:16,680 --> 00:04:21,810
approach involved later on after this

96
00:04:18,539 --> 00:04:23,789
initial<font color="#CCCCCC"> 3h basically collecting</font>

97
00:04:21,810 --> 00:04:25,680
forensics from<font color="#CCCCCC"> there from the machine</font>

98
00:04:23,789 --> 00:04:29,250
I'll tell about

99
00:04:25,680 --> 00:04:31,770
this a bit more in the next slides this

100
00:04:29,250 --> 00:04:33,930
task used to be performed by our

101
00:04:31,770 --> 00:04:35,490
helpdesk ninja so they're like as<font color="#E5E5E5"> I</font>

102
00:04:33,930 --> 00:04:37,470
mentioned<font color="#CCCCCC"> the best people to do it</font>

103
00:04:35,490 --> 00:04:39,509
<font color="#CCCCCC">because they are really</font><font color="#E5E5E5"> living close to</font>

104
00:04:37,470 --> 00:04:41,070
the users they can just go grab

105
00:04:39,509 --> 00:04:43,560
someone's machines<font color="#CCCCCC"> take it up the</font>

106
00:04:41,070 --> 00:04:46,110
network run the necessary collection

107
00:04:43,560 --> 00:04:49,500
script get the output back and then the

108
00:04:46,110 --> 00:04:53,039
model analysts<font color="#E5E5E5"> can start start analyzing</font>

109
00:04:49,500 --> 00:04:58,620
the output so they can assess the risk

110
00:04:53,039 --> 00:05:00,930
related to the infection so when it

111
00:04:58,620 --> 00:05:03,479
<font color="#E5E5E5">comes to different kind of tools we have</font>

112
00:05:00,930 --> 00:05:05,789
available for<font color="#E5E5E5"> digital forensics</font>

113
00:05:03,479 --> 00:05:08,639
collection on<font color="#E5E5E5"> Mac OS there is</font><font color="#CCCCCC"> OSX</font>

114
00:05:05,789 --> 00:05:13,229
auditor so this is script that more or

115
00:05:08,639 --> 00:05:16,440
less inactive for<font color="#CCCCCC"> the past few few</font>

116
00:05:13,229 --> 00:05:18,419
months it's open source on github it

117
00:05:16,440 --> 00:05:20,849
lets you collect different properties

118
00:05:18,419 --> 00:05:23,609
from the from mac OS machines there is

119
00:05:20,849 --> 00:05:25,830
always<font color="#E5E5E5"> square which also</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> open source</font>

120
00:05:23,610 --> 00:05:27,570
project open source by<font color="#CCCCCC"> Facebook it</font>

121
00:05:25,830 --> 00:05:30,260
allows you to query different system

122
00:05:27,570 --> 00:05:33,960
properties like you will<font color="#CCCCCC"> beat wiring SQL</font>

123
00:05:30,260 --> 00:05:36,240
database knock knock is also quite

124
00:05:33,960 --> 00:05:37,799
useful tool that lets you figure out

125
00:05:36,240 --> 00:05:40,620
<font color="#E5E5E5">which processes are running on your mac</font>

126
00:05:37,800 --> 00:05:42,449
OS machines so this may give you more

127
00:05:40,620 --> 00:05:44,909
insight into<font color="#E5E5E5"> whether there are some</font>

128
00:05:42,449 --> 00:05:46,349
known processes like system processes or

129
00:05:44,909 --> 00:05:48,030
something that was actually installed by

130
00:05:46,349 --> 00:05:51,240
the user potentially packaged with

131
00:05:48,030 --> 00:05:53,099
malware there is Google Rapid Response

132
00:05:51,240 --> 00:05:55,440
framework this is a bit more interested

133
00:05:53,099 --> 00:05:57,870
they let you for instance collect file

134
00:05:55,440 --> 00:06:00,840
samples so it also<font color="#E5E5E5"> gives you more</font>

135
00:05:57,870 --> 00:06:02,310
insights into in terms of whether the

136
00:06:00,840 --> 00:06:04,560
machine is infected with something or

137
00:06:02,310 --> 00:06:06,120
<font color="#E5E5E5">not because they give you possibly to</font>

138
00:06:04,560 --> 00:06:08,669
collect the samples of the files from

139
00:06:06,120 --> 00:06:10,440
the machines as well I'd like<font color="#E5E5E5"> to also</font>

140
00:06:08,669 --> 00:06:12,690
mention the book that was<font color="#CCCCCC"> recently</font>

141
00:06:10,440 --> 00:06:16,169
released is OS stan is in response

142
00:06:12,690 --> 00:06:19,289
scripting analysis by<font color="#E5E5E5"> jaron</font><font color="#CCCCCC"> bradley this</font>

143
00:06:16,169 --> 00:06:22,740
<font color="#CCCCCC">book's also comes with kind of ideas for</font>

144
00:06:19,289 --> 00:06:25,139
scripts that you can basically have to

145
00:06:22,740 --> 00:06:26,610
collect various forensics from from mac

146
00:06:25,139 --> 00:06:29,699
OS machines and also gives you some

147
00:06:26,610 --> 00:06:32,820
ideas about how<font color="#CCCCCC"> to analyze them at the</font>

148
00:06:29,699 --> 00:06:35,130
yelp we use OS<font color="#CCCCCC"> X collector which is a</font>

149
00:06:32,820 --> 00:06:37,710
tool based on OS X editor it's also open

150
00:06:35,130 --> 00:06:39,100
source on<font color="#E5E5E5"> the github so this is a</font>

151
00:06:37,710 --> 00:06:42,669
forensic evidence

152
00:06:39,100 --> 00:06:44,380
election analysis toolkit for OS 10 we

153
00:06:42,670 --> 00:06:46,750
open sores it some two<font color="#CCCCCC"> years ago</font><font color="#E5E5E5"> it was</font>

154
00:06:44,380 --> 00:06:48,820
actually first project I worked on when

155
00:06:46,750 --> 00:06:50,830
I joined you out so I'm<font color="#E5E5E5"> pretty proud of</font>

156
00:06:48,820 --> 00:06:53,530
it that it's<font color="#E5E5E5"> love there and still used</font>

157
00:06:50,830 --> 00:06:55,030
by people actually let me get a quick

158
00:06:53,530 --> 00:06:56,830
show of hands how many of you<font color="#CCCCCC"> are</font>

159
00:06:55,030 --> 00:07:03,479
familiar<font color="#E5E5E5"> with OSX collector in the</font>

160
00:06:56,830 --> 00:07:06,520
audience a couple<font color="#CCCCCC"> of hands ok cool so</font>

161
00:07:03,480 --> 00:07:09,490
basically what Isaac selector is is a

162
00:07:06,520 --> 00:07:11,520
simple<font color="#E5E5E5"> Python script that Iran on</font>

163
00:07:09,490 --> 00:07:15,370
potentially infected machine it will

164
00:07:11,520 --> 00:07:17,950
collect value system properties you see

165
00:07:15,370 --> 00:07:20,740
it here<font color="#CCCCCC"> on this slide and then output</font>

166
00:07:17,950 --> 00:07:23,170
them as a JSON file so that analysts can

167
00:07:20,740 --> 00:07:24,580
take this file and try to figure out all

168
00:07:23,170 --> 00:07:27,610
these properties whether machine is

169
00:07:24,580 --> 00:07:29,919
infected or not so the way<font color="#E5E5E5"> OSX collector</font>

170
00:07:27,610 --> 00:07:32,290
runs is it collects gathers all<font color="#CCCCCC"> these</font>

171
00:07:29,920 --> 00:07:34,360
<font color="#E5E5E5">different information from</font><font color="#CCCCCC"> plist</font><font color="#E5E5E5"> which</font>

172
00:07:32,290 --> 00:07:36,930
are kind<font color="#E5E5E5"> of like you</font><font color="#CCCCCC"> would say windows</font>

173
00:07:34,360 --> 00:07:39,640
registry things on<font color="#E5E5E5"> Mac OS machines</font>

174
00:07:36,930 --> 00:07:42,310
various<font color="#E5E5E5"> sqlite databases that also mac</font>

175
00:07:39,640 --> 00:07:44,409
OS uses to store system properties as

176
00:07:42,310 --> 00:07:46,420
well as some other<font color="#E5E5E5"> a local file system</font>

177
00:07:44,410 --> 00:07:48,390
information for for instance for

178
00:07:46,420 --> 00:07:51,550
applications installed the system or

179
00:07:48,390 --> 00:07:55,830
browser history browser extension things

180
00:07:51,550 --> 00:07:59,170
like that so here<font color="#E5E5E5"> is an example of how</font>

181
00:07:55,830 --> 00:08:01,000
such a JSON entry collected by<font color="#E5E5E5"> OSX</font>

182
00:07:59,170 --> 00:08:03,940
collector looks like it comes<font color="#E5E5E5"> with some</font>

183
00:08:01,000 --> 00:08:06,550
common keys like file paths file hashes

184
00:08:03,940 --> 00:08:08,290
timestamps they're also signature change

185
00:08:06,550 --> 00:08:10,270
for instance for for binaries that might

186
00:08:08,290 --> 00:08:14,280
be useful to figure out whether this is

187
00:08:10,270 --> 00:08:16,900
something<font color="#CCCCCC"> we expect on the system or not</font>

188
00:08:14,280 --> 00:08:19,690
so what we used to do later on after

189
00:08:16,900 --> 00:08:21,520
collecting all these<font color="#E5E5E5"> files from the</font>

190
00:08:19,690 --> 00:08:23,500
potential infected machine is<font color="#CCCCCC"> that</font>

191
00:08:21,520 --> 00:08:26,289
Morales would basically sit down and

192
00:08:23,500 --> 00:08:28,110
with some simple<font color="#E5E5E5"> tools like grab or JQ</font>

193
00:08:26,290 --> 00:08:31,360
which is<font color="#CCCCCC"> actually quite cool thank for</font>

194
00:08:28,110 --> 00:08:34,030
Jason visualization they will go through

195
00:08:31,360 --> 00:08:37,270
the scripts basically trying to<font color="#E5E5E5"> find</font>

196
00:08:34,030 --> 00:08:39,760
some incidents that were happening

197
00:08:37,270 --> 00:08:43,598
around<font color="#CCCCCC"> the</font><font color="#E5E5E5"> certain time frame or goals</font>

198
00:08:39,760 --> 00:08:46,840
also allows you to<font color="#CCCCCC"> with hub of GQ</font><font color="#E5E5E5"> filter</font>

199
00:08:43,599 --> 00:08:48,870
and show only<font color="#E5E5E5"> URLs related to user's</font>

200
00:08:46,840 --> 00:08:52,120
activity around a certain<font color="#E5E5E5"> time frame and</font>

201
00:08:48,870 --> 00:08:52,800
basically based on that annals<font color="#CCCCCC"> we'll try</font>

202
00:08:52,120 --> 00:08:55,110
to figure

203
00:08:52,800 --> 00:08:57,599
two were for instance<font color="#E5E5E5"> the file was</font>

204
00:08:55,110 --> 00:08:59,519
downloaded from or when the file was

205
00:08:57,600 --> 00:09:01,920
installed by<font color="#E5E5E5"> the user trying basically</font>

206
00:08:59,519 --> 00:09:06,570
to figure out answers to these questions

207
00:09:01,920 --> 00:09:09,240
<font color="#E5E5E5">I mentioned earlier so this also works</font>

208
00:09:06,570 --> 00:09:13,709
pretty well<font color="#CCCCCC"> but if you have thirty</font>

209
00:09:09,240 --> 00:09:16,740
thousand lines of JSON output it may

210
00:09:13,709 --> 00:09:18,479
come<font color="#CCCCCC"> as a really job of basically</font>

211
00:09:16,740 --> 00:09:20,970
<font color="#E5E5E5">looking at</font><font color="#CCCCCC"> a lot of Jason</font><font color="#E5E5E5"> and don't get</font>

212
00:09:18,480 --> 00:09:24,180
<font color="#E5E5E5">me wrong like I like Jason Jason is very</font>

213
00:09:20,970 --> 00:09:27,810
pretty<font color="#E5E5E5"> this simple but it's also very</font>

214
00:09:24,180 --> 00:09:30,329
easy<font color="#E5E5E5"> to read and process by my code from</font>

215
00:09:27,810 --> 00:09:33,180
code so<font color="#E5E5E5"> actually why don't we let code</font>

216
00:09:30,329 --> 00:09:36,449
process<font color="#E5E5E5"> JSON output and this is what we</font>

217
00:09:33,180 --> 00:09:39,359
<font color="#CCCCCC">started down as the next step so early</font>

218
00:09:36,450 --> 00:09:41,519
on we automated<font color="#E5E5E5"> the JSON analysis</font>

219
00:09:39,360 --> 00:09:43,560
process or with what we called<font color="#E5E5E5"> OSX</font>

220
00:09:41,519 --> 00:09:45,930
<font color="#CCCCCC">Kaiser output filters and they basically</font>

221
00:09:43,560 --> 00:09:49,018
<font color="#E5E5E5">what they do is they augment the initial</font>

222
00:09:45,930 --> 00:09:51,689
<font color="#CCCCCC">jason with all different properties for</font>

223
00:09:49,019 --> 00:09:54,360
instance<font color="#CCCCCC"> the information from our</font>

224
00:09:51,690 --> 00:09:56,880
internal blacklists or information from

225
00:09:54,360 --> 00:10:00,240
some external threat intelligence api's

226
00:09:56,880 --> 00:10:02,160
they will<font color="#CCCCCC"> also try</font><font color="#E5E5E5"> to construct the list</font>

227
00:10:00,240 --> 00:10:04,140
<font color="#E5E5E5">of related files to a files that are</font>

228
00:10:02,160 --> 00:10:08,850
potentially infected and then produce

229
00:10:04,140 --> 00:10:11,640
some sort<font color="#E5E5E5"> of summary of bindings so this</font>

230
00:10:08,850 --> 00:10:15,180
<font color="#E5E5E5">is a really cool it automates the whole</font>

231
00:10:11,640 --> 00:10:16,829
kind of analysis process but the the

232
00:10:15,180 --> 00:10:19,290
tool itself<font color="#E5E5E5"> OSX collector</font><font color="#CCCCCC"> out with</font>

233
00:10:16,829 --> 00:10:21,589
filters it was quite tedious to maintain

234
00:10:19,290 --> 00:10:24,149
because mal Reynolds had to basically

235
00:10:21,589 --> 00:10:26,550
get the installation installation of the

236
00:10:24,149 --> 00:10:30,120
two on their machine when they started

237
00:10:26,550 --> 00:10:32,880
the analysis they had to also basically

238
00:10:30,120 --> 00:10:36,540
sit there watch<font color="#CCCCCC"> it one ink they if the</font>

239
00:10:32,880 --> 00:10:39,120
machine went to sleep or if they<font color="#E5E5E5"> decided</font>

240
00:10:36,540 --> 00:10:40,620
to like close the machine or for

241
00:10:39,120 --> 00:10:42,449
whatever reason they lost internet

242
00:10:40,620 --> 00:10:44,820
connections all this sort<font color="#E5E5E5"> of process</font>

243
00:10:42,449 --> 00:10:46,380
will kind<font color="#E5E5E5"> of hold and then they all have</font>

244
00:10:44,820 --> 00:10:50,149
to<font color="#E5E5E5"> restart it because it connects to</font>

245
00:10:46,380 --> 00:10:53,250
various external thread until I<font color="#E5E5E5"> pis by</font>

246
00:10:50,149 --> 00:10:54,930
<font color="#E5E5E5">HTTP so basically the</font><font color="#CCCCCC"> food was not</font>

247
00:10:53,250 --> 00:10:57,720
<font color="#E5E5E5">written in the way they allowed them to</font>

248
00:10:54,930 --> 00:11:00,180
kind of like post it and resume at

249
00:10:57,720 --> 00:11:01,620
certain point of time also not to

250
00:11:00,180 --> 00:11:03,359
mention<font color="#CCCCCC"> that basically whenever there</font>

251
00:11:01,620 --> 00:11:05,160
was like new version<font color="#E5E5E5"> of this OS X later</font>

252
00:11:03,360 --> 00:11:06,089
out with filters<font color="#CCCCCC"> mal rounds were in</font>

253
00:11:05,160 --> 00:11:07,680
charge of themselves

254
00:11:06,089 --> 00:11:09,290
dating the source code getting all the

255
00:11:07,680 --> 00:11:11,758
dependencies so it was really really

256
00:11:09,290 --> 00:11:14,879
tedious task and not something<font color="#CCCCCC"> we were</font>

257
00:11:11,759 --> 00:11:18,930
looking to<font color="#E5E5E5"> do with</font><font color="#CCCCCC"> the process that we</font>

258
00:11:14,879 --> 00:11:21,120
were actually<font color="#E5E5E5"> trying to automate so we</font>

259
00:11:18,930 --> 00:11:22,349
<font color="#E5E5E5">thought we can do better and we</font><font color="#CCCCCC"> turn the</font>

260
00:11:21,120 --> 00:11:25,470
<font color="#E5E5E5">autistic like throughout the filters</font>

261
00:11:22,350 --> 00:11:27,540
into a service and we call<font color="#CCCCCC"> the</font><font color="#E5E5E5"> service</font>

262
00:11:25,470 --> 00:11:30,809
<font color="#CCCCCC">amira automated malware incident</font>

263
00:11:27,540 --> 00:11:35,099
response<font color="#E5E5E5"> and analysis so right now with</font>

264
00:11:30,809 --> 00:11:37,499
<font color="#E5E5E5">amira what analysts is doing is just</font>

265
00:11:35,100 --> 00:11:40,740
dropping the<font color="#E5E5E5"> OSX character output file</font>

266
00:11:37,499 --> 00:11:43,559
to the s3 bucket and<font color="#E5E5E5"> amira will</font>

267
00:11:40,740 --> 00:11:46,259
automatically trigger the annals of the

268
00:11:43,559 --> 00:11:51,180
new object in the bucket this is based

269
00:11:46,259 --> 00:11:52,559
on fenkell s3 even notifications so we

270
00:11:51,180 --> 00:11:55,829
have configured disaster e bucket

271
00:11:52,559 --> 00:11:57,899
basically to send a notification to<font color="#CCCCCC"> NS q</font>

272
00:11:55,829 --> 00:12:00,569
SQ whenever there is new object in<font color="#E5E5E5"> this</font>

273
00:11:57,899 --> 00:12:04,649
bucket this SQ SQ is called here on the

274
00:12:00,569 --> 00:12:09,149
slide<font color="#CCCCCC"> amira s3 even notifications so</font>

275
00:12:04,649 --> 00:12:11,699
<font color="#E5E5E5">whenever there is a new object</font><font color="#CCCCCC"> created a</font>

276
00:12:09,149 --> 00:12:13,980
notification will be sent to this<font color="#E5E5E5"> queue</font>

277
00:12:11,699 --> 00:12:17,160
<font color="#E5E5E5">amira periodically check for the new</font>

278
00:12:13,980 --> 00:12:19,259
messages in their sea ice cube and upon

279
00:12:17,160 --> 00:12:21,629
receiving a new one it will fetch the

280
00:12:19,259 --> 00:12:25,879
related<font color="#E5E5E5"> OSX collector output file from</font>

281
00:12:21,629 --> 00:12:29,610
the s3 bucket and you can see actually

282
00:12:25,879 --> 00:12:31,860
<font color="#CCCCCC">that output of the</font><font color="#E5E5E5"> OSX character is</font>

283
00:12:29,610 --> 00:12:33,360
packaged in tar.gz file two sections

284
00:12:31,860 --> 00:12:34,829
face because it's like lots of<font color="#E5E5E5"> Jason so</font>

285
00:12:33,360 --> 00:12:40,730
we want to compress it as much as

286
00:12:34,829 --> 00:12:42,809
<font color="#E5E5E5">possible so here i will also extract the</font>

287
00:12:40,730 --> 00:12:45,660
first decompress the file and then

288
00:12:42,809 --> 00:12:48,689
extract the proper<font color="#E5E5E5"> json file from from</font>

289
00:12:45,660 --> 00:12:50,790
the archive and then it will run execute

290
00:12:48,689 --> 00:12:56,059
all these different analysis filters on

291
00:12:50,790 --> 00:12:56,059
the<font color="#E5E5E5"> OSX collector output file</font>

292
00:12:56,440 --> 00:13:00,940
and after<font color="#CCCCCC"> all this process it will send</font>

293
00:12:59,470 --> 00:13:03,970
the results of the analysis<font color="#E5E5E5"> for instance</font>

294
00:13:00,940 --> 00:13:06,880
to another s3 bucket so the malware

295
00:13:03,970 --> 00:13:10,240
analysts can patch the results from from

296
00:13:06,880 --> 00:13:12,160
the<font color="#E5E5E5"> bucket and see whether the machine</font>

297
00:13:10,240 --> 00:13:15,180
was infected basically with<font color="#CCCCCC"> the whole</font>

298
00:13:12,160 --> 00:13:18,610
summary of them of the Alice's process

299
00:13:15,180 --> 00:13:21,250
here are the examples of the another

300
00:13:18,610 --> 00:13:23,040
results that<font color="#CCCCCC"> amira produces so for</font>

301
00:13:21,250 --> 00:13:25,510
instance<font color="#E5E5E5"> we will see some domains and</font>

302
00:13:23,040 --> 00:13:27,400
hashes that<font color="#E5E5E5"> we refined from the black on</font>

303
00:13:25,510 --> 00:13:29,800
the blackest that we are curating<font color="#CCCCCC"> will</font>

304
00:13:27,400 --> 00:13:32,050
<font color="#CCCCCC">also give you</font><font color="#E5E5E5"> an idea about information</font>

305
00:13:29,800 --> 00:13:34,030
<font color="#E5E5E5">found by conducting the external threat</font>

306
00:13:32,050 --> 00:13:35,589
intelligence<font color="#CCCCCC"> AP is another world</font>

307
00:13:34,030 --> 00:13:37,510
<font color="#CCCCCC">surprised you suggestions so basically</font>

308
00:13:35,590 --> 00:13:40,480
for<font color="#CCCCCC"> the things</font><font color="#E5E5E5"> that were found on</font><font color="#CCCCCC"> the</font>

309
00:13:37,510 --> 00:13:41,980
external threat intelligence api's but

310
00:13:40,480 --> 00:13:45,640
are not listed on<font color="#E5E5E5"> your black place it</font>

311
00:13:41,980 --> 00:13:50,530
will suggest you to you<font color="#CCCCCC"> to add them to</font>

312
00:13:45,640 --> 00:13:53,439
the 2d blacklist<font color="#CCCCCC"> amira doesn't require</font>

313
00:13:50,530 --> 00:13:55,810
too much configuration to run basically

314
00:13:53,440 --> 00:13:57,640
all you need to do<font color="#CCCCCC"> is to figure</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> on</font>

315
00:13:55,810 --> 00:14:00,760
your own this<font color="#CCCCCC"> ester even notification</font>

316
00:13:57,640 --> 00:14:02,610
spank it is well documented on the AWS

317
00:14:00,760 --> 00:14:06,880
documentation so it's<font color="#E5E5E5"> not really</font>

318
00:14:02,610 --> 00:14:10,480
something difficult and then<font color="#E5E5E5"> just to run</font>

319
00:14:06,880 --> 00:14:13,480
it you<font color="#E5E5E5"> basically to specify as qsq name</font>

320
00:14:10,480 --> 00:14:16,960
and AWS region where the queue was

321
00:14:13,480 --> 00:14:19,990
configured to run there is also a

322
00:14:16,960 --> 00:14:23,440
possibility to specify this results of

323
00:14:19,990 --> 00:14:26,340
<font color="#CCCCCC">loaders so there is for</font><font color="#E5E5E5"> instance</font>

324
00:14:23,440 --> 00:14:28,510
possibility to add also some other

325
00:14:26,340 --> 00:14:31,890
results upload their so result of<font color="#E5E5E5"> all</font>

326
00:14:28,510 --> 00:14:34,540
there are basically a way for you to

327
00:14:31,890 --> 00:14:37,330
tell Amira what to do with the Alice's

328
00:14:34,540 --> 00:14:39,069
results so you may want<font color="#CCCCCC"> to add some</font>

329
00:14:37,330 --> 00:14:41,500
other way<font color="#CCCCCC"> of distributing the results</font>

330
00:14:39,070 --> 00:14:45,160
for<font color="#E5E5E5"> instance you may think about sending</font>

331
00:14:41,500 --> 00:14:48,610
<font color="#E5E5E5">the results of the answers via email or</font>

332
00:14:45,160 --> 00:14:50,350
some similar or some basic<font color="#CCCCCC"> alee attach</font>

333
00:14:48,610 --> 00:14:52,540
them to your incident response platform

334
00:14:50,350 --> 00:14:57,940
if you have some more advanced system

335
00:14:52,540 --> 00:15:00,280
two to three edges alert and so that the

336
00:14:57,940 --> 00:15:01,600
syrup while<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was mentioning</font><font color="#CCCCCC"> that kind</font>

337
00:15:00,280 --> 00:15:03,839
<font color="#E5E5E5">of disaster about that there the end</font>

338
00:15:01,600 --> 00:15:07,270
results of the s3 bucket is is uh is

339
00:15:03,839 --> 00:15:09,390
optional step are there any questions<font color="#E5E5E5"> so</font>

340
00:15:07,270 --> 00:15:18,610
far related to

341
00:15:09,390 --> 00:15:20,920
amira so the<font color="#E5E5E5"> question is whether</font><font color="#CCCCCC"> we are</font>

342
00:15:18,610 --> 00:15:23,110
using it as a lambda<font color="#CCCCCC"> function or running</font>

343
00:15:20,920 --> 00:15:27,270
it as our internal<font color="#CCCCCC"> instance so we are</font>

344
00:15:23,110 --> 00:15:31,300
running it is our internalized pneus

345
00:15:27,270 --> 00:15:32,829
gather several factors<font color="#CCCCCC"> its lambda</font>

346
00:15:31,300 --> 00:15:34,780
factors are really<font color="#E5E5E5"> cool but I found them</font>

347
00:15:32,830 --> 00:15:36,340
quite at ease when it comes to importing

348
00:15:34,780 --> 00:15:38,380
some external dependencies like

349
00:15:36,340 --> 00:15:40,900
basically this whole OS<font color="#E5E5E5"> X caught up with</font>

350
00:15:38,380 --> 00:15:44,590
filters but our first idea was actually

351
00:15:40,900 --> 00:15:47,699
to think about lambda functions there

352
00:15:44,590 --> 00:15:53,620
were some other questions<font color="#CCCCCC"> okay if</font><font color="#E5E5E5"> not</font>

353
00:15:47,700 --> 00:15:55,660
let me continue so actually<font color="#CCCCCC"> you can go</font>

354
00:15:53,620 --> 00:15:57,370
<font color="#E5E5E5">even the</font><font color="#CCCCCC"> step ladder with all this for</font>

355
00:15:55,660 --> 00:16:01,689
instance and also<font color="#CCCCCC"> to make the forensics</font>

356
00:15:57,370 --> 00:16:05,230
collections tab so basically what you

357
00:16:01,690 --> 00:16:07,030
can do is instead of<font color="#E5E5E5"> just getting the</font>

358
00:16:05,230 --> 00:16:09,550
<font color="#CCCCCC">Machine and running the OS X character</font>

359
00:16:07,030 --> 00:16:13,420
script on the<font color="#E5E5E5"> machine you could think</font>

360
00:16:09,550 --> 00:16:15,400
about basically having some scripts<font color="#E5E5E5"> that</font>

361
00:16:13,420 --> 00:16:18,310
will run OSX collector<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the machine</font>

362
00:16:15,400 --> 00:16:20,730
<font color="#E5E5E5">and for instance upload the results to</font>

363
00:16:18,310 --> 00:16:23,410
an extra bucket if you have large

364
00:16:20,730 --> 00:16:25,540
installation in your in your<font color="#E5E5E5"> company so</font>

365
00:16:23,410 --> 00:16:28,689
like we all have around for does

366
00:16:25,540 --> 00:16:30,099
employees with with mac OS systems you

367
00:16:28,690 --> 00:16:32,380
<font color="#E5E5E5">probably use something like your</font>

368
00:16:30,100 --> 00:16:34,390
inventory management system you could

369
00:16:32,380 --> 00:16:36,850
think<font color="#E5E5E5"> of basically just dropping the</font>

370
00:16:34,390 --> 00:16:38,680
script<font color="#E5E5E5"> to run OS X Factor collection and</font>

371
00:16:36,850 --> 00:16:44,010
then uploading the results to s3 bucket

372
00:16:38,680 --> 00:16:46,420
and that will trigger the<font color="#CCCCCC"> Amira to to</font>

373
00:16:44,010 --> 00:16:49,630
run their collection<font color="#E5E5E5"> to run the analysis</font>

374
00:16:46,420 --> 00:16:51,670
on the on the results here is an example

375
00:16:49,630 --> 00:16:54,040
of<font color="#CCCCCC"> sits script it's very basic I</font>

376
00:16:51,670 --> 00:16:57,150
actually stole it from someone<font color="#E5E5E5"> else it's</font>

377
00:16:54,040 --> 00:17:01,599
the<font color="#CCCCCC"> only thing it does it's just</font>

378
00:16:57,150 --> 00:17:04,690
calculating this signature for AWS s3 so

379
00:17:01,600 --> 00:17:07,930
it can send<font color="#CCCCCC"> a file their end and then</font>

380
00:17:04,690 --> 00:17:14,090
trigger the whole<font color="#CCCCCC"> analysis process</font>

381
00:17:07,930 --> 00:17:16,760
so the whole<font color="#CCCCCC"> annals is sort of saved us</font>

382
00:17:14,089 --> 00:17:22,790
a lot of time in certain cases it served

383
00:17:16,760 --> 00:17:25,910
<font color="#E5E5E5">us up to like</font><font color="#CCCCCC"> hours from several days we</font>

384
00:17:22,790 --> 00:17:28,520
used to be when<font color="#CCCCCC"> we were involving also</font>

385
00:17:25,910 --> 00:17:31,250
help desk into the whole collection

386
00:17:28,520 --> 00:17:33,740
process we have to wait<font color="#CCCCCC"> for them they</font>

387
00:17:31,250 --> 00:17:35,120
were<font color="#CCCCCC"> in</font><font color="#E5E5E5"> different time zones sometimes</font>

388
00:17:33,740 --> 00:17:37,670
they have<font color="#CCCCCC"> to chase the user which will</font>

389
00:17:35,120 --> 00:17:39,620
also<font color="#E5E5E5"> in the other time zone so the whole</font>

390
00:17:37,670 --> 00:17:42,320
process could easily take up to several

391
00:17:39,620 --> 00:17:45,040
days and then the whole analysis as I

392
00:17:42,320 --> 00:17:48,560
mentioned when it was interrupted

393
00:17:45,040 --> 00:17:50,480
amiright takes basically all this effort

394
00:17:48,560 --> 00:17:54,460
from you you don't have<font color="#E5E5E5"> to sit there</font>

395
00:17:50,480 --> 00:17:57,230
watch how it collects all<font color="#CCCCCC"> the old</font>

396
00:17:54,460 --> 00:18:01,010
information from various<font color="#CCCCCC"> Fred</font>

397
00:17:57,230 --> 00:18:03,560
intelligence api's it also we uses lots

398
00:18:01,010 --> 00:18:05,390
of caching mechanisms so all this<font color="#CCCCCC"> OSX</font>

399
00:18:03,560 --> 00:18:07,490
collector output filters it comes

400
00:18:05,390 --> 00:18:09,140
packaged with some basic cash that will

401
00:18:07,490 --> 00:18:12,070
now teach you the same queries for

402
00:18:09,140 --> 00:18:14,330
instance if that user visited the same

403
00:18:12,070 --> 00:18:15,830
websites<font color="#E5E5E5"> I mean most of the users are</font>

404
00:18:14,330 --> 00:18:17,389
actually visiting probably like eighteen

405
00:18:15,830 --> 00:18:19,850
ninety percent of the websites they're

406
00:18:17,390 --> 00:18:21,860
visiting are the same so when we're

407
00:18:19,850 --> 00:18:26,510
running the process on each by each

408
00:18:21,860 --> 00:18:29,810
individual modeler analyst basically all

409
00:18:26,510 --> 00:18:31,520
all all of<font color="#CCCCCC"> them I had to pretty much get</font>

410
00:18:29,810 --> 00:18:33,980
the same information all over again and

411
00:18:31,520 --> 00:18:37,400
with a mirror which is able<font color="#E5E5E5"> to have this</font>

412
00:18:33,980 --> 00:18:40,010
<font color="#CCCCCC">information at once</font><font color="#E5E5E5"> from the AP ice and</font>

413
00:18:37,400 --> 00:18:43,760
cash it so for instance<font color="#E5E5E5"> saves us lots of</font>

414
00:18:40,010 --> 00:18:45,050
quota<font color="#E5E5E5"> from the external IP eyes and it</font>

415
00:18:43,760 --> 00:18:49,640
basically makes the<font color="#E5E5E5"> whole process in the</font>

416
00:18:45,050 --> 00:18:52,730
<font color="#E5E5E5">pasture it also cut all this interaction</font>

417
00:18:49,640 --> 00:18:55,220
between the modeler analysts and help

418
00:18:52,730 --> 00:18:57,200
desk so right<font color="#CCCCCC"> now amira is taking care</font>

419
00:18:55,220 --> 00:18:59,540
of forensics collection<font color="#CCCCCC"> also the</font>

420
00:18:57,200 --> 00:19:02,510
analysis obviously there is need for

421
00:18:59,540 --> 00:19:03,590
analysts<font color="#E5E5E5"> to review the whole results</font>

422
00:19:02,510 --> 00:19:06,770
summary and actually provide

423
00:19:03,590 --> 00:19:11,649
remediations that are done executed by

424
00:19:06,770 --> 00:19:15,050
the IT engineer help us but before<font color="#E5E5E5"> we</font>

425
00:19:11,650 --> 00:19:19,070
still like there is less sort of human

426
00:19:15,050 --> 00:19:21,830
interaction less errors possibly that

427
00:19:19,070 --> 00:19:24,049
could all over along<font color="#E5E5E5"> the way</font>

428
00:19:21,830 --> 00:19:30,019
also there is no need for<font color="#E5E5E5"> this physical</font>

429
00:19:24,049 --> 00:19:32,299
collection so even less problems with

430
00:19:30,019 --> 00:19:34,190
basically a chasing users down the

431
00:19:32,299 --> 00:19:36,950
corridors and taking their machine of

432
00:19:34,190 --> 00:19:39,760
the network we can just remotely run the

433
00:19:36,950 --> 00:19:42,980
script collect all<font color="#E5E5E5"> the forensics get the</font>

434
00:19:39,760 --> 00:19:44,480
analysis done and then basically malware

435
00:19:42,980 --> 00:19:46,880
analysts can sit down<font color="#CCCCCC"> and look at the</font>

436
00:19:44,480 --> 00:19:49,159
analysis and figure out whether there

437
00:19:46,880 --> 00:19:55,460
are any false positives or we were down

438
00:19:49,159 --> 00:20:01,700
any sort of other problems<font color="#E5E5E5"> and it also</font>

439
00:19:55,460 --> 00:20:03,230
allowed us<font color="#E5E5E5"> to do more proactive forensic</font>

440
00:20:01,700 --> 00:20:07,880
collection so right<font color="#CCCCCC"> now even on the</font>

441
00:20:03,230 --> 00:20:09,529
machines that we are not really sure

442
00:20:07,880 --> 00:20:10,909
<font color="#CCCCCC">that they're in fact there are we we</font>

443
00:20:09,529 --> 00:20:12,799
haven't even received any alerts but

444
00:20:10,909 --> 00:20:14,899
<font color="#E5E5E5">potentially there is some suspicious</font>

445
00:20:12,799 --> 00:20:17,149
<font color="#CCCCCC">networking</font><font color="#E5E5E5"> activity from our DNS</font>

446
00:20:14,899 --> 00:20:19,879
resolvers we could practically run a

447
00:20:17,149 --> 00:20:22,699
mirror and get all the forensics on a

448
00:20:19,880 --> 00:20:27,019
live stem and and figure out<font color="#E5E5E5"> whether the</font>

449
00:20:22,700 --> 00:20:29,720
machine is impacted on that and the

450
00:20:27,019 --> 00:20:32,830
whole<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> is open sourced so go try it</font>

451
00:20:29,720 --> 00:20:35,510
out I'm really<font color="#E5E5E5"> looking forward for any</font>

452
00:20:32,830 --> 00:20:37,939
questions<font color="#E5E5E5"> related to the project and the</font>

453
00:20:35,510 --> 00:20:39,889
issues<font color="#CCCCCC"> that you've spot if you have any</font>

454
00:20:37,940 --> 00:20:41,690
<font color="#E5E5E5">suggestions also don't be shy create</font>

455
00:20:39,889 --> 00:20:46,090
simple requests and then my way i'll try

456
00:20:41,690 --> 00:20:48,590
to review them and all that doubt<font color="#CCCCCC"> i'll</font>

457
00:20:46,090 --> 00:20:51,820
like<font color="#E5E5E5"> to thank you for coming and</font><font color="#CCCCCC"> i'm</font>

458
00:20:48,590 --> 00:20:51,820
open to take any<font color="#E5E5E5"> questions</font>

459
00:20:59,720 --> 00:21:06,970
what kind of percentage I'd say it's

460
00:21:03,190 --> 00:21:10,100
probably way more than 80 purrs like

461
00:21:06,970 --> 00:21:12,950
around this like eighty twenty percent

462
00:21:10,100 --> 00:21:14,840
<font color="#E5E5E5">all right so I guess some of them will</font>

463
00:21:12,950 --> 00:21:16,880
be clearly false positive some of them

464
00:21:14,840 --> 00:21:18,918
will be like oh it is a threat but it's

465
00:21:16,880 --> 00:21:22,159
not applicable for this particular

466
00:21:18,919 --> 00:21:25,059
machine and ya mero basically helps us

467
00:21:22,159 --> 00:21:27,799
to to figure this out because even for a

468
00:21:25,059 --> 00:21:30,049
certain press that are for instance<font color="#CCCCCC"> our</font>

469
00:21:27,799 --> 00:21:32,299
<font color="#E5E5E5">end point</font><font color="#CCCCCC"> or drink say</font><font color="#E5E5E5"> our windows only</font>

470
00:21:30,049 --> 00:21:34,158
<font color="#E5E5E5">will still get the alert and then we'll</font>

471
00:21:32,299 --> 00:21:35,929
have to<font color="#E5E5E5"> figure out these seriously</font>

472
00:21:34,159 --> 00:21:38,480
<font color="#E5E5E5">windows only for instance some browser</font>

473
00:21:35,929 --> 00:21:42,289
extensions there don't really are

474
00:21:38,480 --> 00:21:47,929
related to<font color="#E5E5E5"> to any systems so that's how</font>

475
00:21:42,289 --> 00:21:50,030
we can also analyze it are you planning

476
00:21:47,929 --> 00:21:52,730
<font color="#E5E5E5">any integrations with like sandboxing</font>

477
00:21:50,030 --> 00:21:57,379
technologies goo goo or anything like

478
00:21:52,730 --> 00:21:59,390
that yeah so regarding sandbox<font color="#CCCCCC"> inc so</font>

479
00:21:57,380 --> 00:22:01,130
this is purely sorted for forensics

480
00:21:59,390 --> 00:22:04,640
collection so there is no sample

481
00:22:01,130 --> 00:22:06,530
collection obviously it would be very

482
00:22:04,640 --> 00:22:08,110
interesting<font color="#E5E5E5"> to connect it also if</font>

483
00:22:06,530 --> 00:22:11,149
something that could process a sample

484
00:22:08,110 --> 00:22:13,189
but then we are sort of approaching this

485
00:22:11,150 --> 00:22:15,110
problem of how we are transferring the

486
00:22:13,190 --> 00:22:17,809
samples on the way so for instance

487
00:22:15,110 --> 00:22:19,610
<font color="#E5E5E5">Google Rapid Response framework they do</font>

488
00:22:17,809 --> 00:22:21,740
something that<font color="#E5E5E5"> allows you to pick a</font>

489
00:22:19,610 --> 00:22:26,649
sample<font color="#E5E5E5"> and I guess at the point of time</font>

490
00:22:21,740 --> 00:22:28,940
we would be able so to have some<font color="#CCCCCC"> more</font>

491
00:22:26,650 --> 00:22:31,030
reliable<font color="#E5E5E5"> Anna's when it comes to the</font>

492
00:22:28,940 --> 00:22:34,280
file so so<font color="#CCCCCC"> far we are operating</font>

493
00:22:31,030 --> 00:22:37,720
basically on file hashes I guess file

494
00:22:34,280 --> 00:22:40,399
names things like that I mean URLs are

495
00:22:37,720 --> 00:22:42,140
pretty<font color="#CCCCCC"> okay like sometimes we are</font>

496
00:22:40,400 --> 00:22:44,200
<font color="#E5E5E5">basically collecting a sample from the</font>

497
00:22:42,140 --> 00:22:47,780
original URL rather than from the

498
00:22:44,200 --> 00:22:50,390
machine because<font color="#CCCCCC"> also maybe sort of to</font>

499
00:22:47,780 --> 00:22:52,220
give you a heads up on all this

500
00:22:50,390 --> 00:22:54,350
remediation process apart from<font color="#CCCCCC"> just</font>

501
00:22:52,220 --> 00:22:57,260
getting rid<font color="#E5E5E5"> of the threat on particular</font>

502
00:22:54,350 --> 00:23:01,010
instance what we are trying to<font color="#E5E5E5"> do as</font>

503
00:22:57,260 --> 00:23:03,169
well as block domains block IP addresses

504
00:23:01,010 --> 00:23:05,629
serving malware so at this<font color="#E5E5E5"> point of time</font>

505
00:23:03,169 --> 00:23:08,390
<font color="#E5E5E5">actually it is more important</font><font color="#CCCCCC"> for us</font>

506
00:23:05,630 --> 00:23:10,280
where this Fred got from and if<font color="#E5E5E5"> we are</font>

507
00:23:08,390 --> 00:23:12,800
<font color="#CCCCCC">able</font><font color="#E5E5E5"> to pinpoint it to particular domain</font>

508
00:23:10,280 --> 00:23:14,330
URL and get a sample there

509
00:23:12,800 --> 00:23:16,310
we know we have<font color="#CCCCCC"> to block it right so</font>

510
00:23:14,330 --> 00:23:20,840
it's it's actually more related<font color="#CCCCCC"> to what</font>

511
00:23:16,310 --> 00:23:22,100
we are doing later in the step so now

512
00:23:20,840 --> 00:23:23,600
that<font color="#CCCCCC"> you're now that you're able</font><font color="#E5E5E5"> to</font>

513
00:23:22,100 --> 00:23:24,800
collect a lot more and analyze a<font color="#CCCCCC"> lot</font>

514
00:23:23,600 --> 00:23:27,469
more at scale is there have you found

515
00:23:24,800 --> 00:23:29,120
particular things that you've particular

516
00:23:27,470 --> 00:23:30,620
indicators or particular types of data

517
00:23:29,120 --> 00:23:33,530
you've collected now that we're not

518
00:23:30,620 --> 00:23:34,879
worth collecting before that we're not

519
00:23:33,530 --> 00:23:37,360
we're collecting weren't worth

520
00:23:34,880 --> 00:23:42,070
collecting terms is really expensive

521
00:23:37,360 --> 00:23:44,360
<font color="#CCCCCC">yeah so there are particular parts of</font>

522
00:23:42,070 --> 00:23:47,510
forensics collection done by<font color="#CCCCCC"> OS X</font>

523
00:23:44,360 --> 00:23:49,070
collector it tries to<font color="#E5E5E5"> get as much</font>

524
00:23:47,510 --> 00:23:52,490
information as possible that's why this

525
00:23:49,070 --> 00:23:55,070
<font color="#CCCCCC">30k lines for machine that was running I</font>

526
00:23:52,490 --> 00:23:57,440
guess for several months and then the

527
00:23:55,070 --> 00:24:01,639
whole analysis process is also<font color="#E5E5E5"> longer</font>

528
00:23:57,440 --> 00:24:03,380
because of that yeah we decided for

529
00:24:01,640 --> 00:24:05,750
instance not to look too much into

530
00:24:03,380 --> 00:24:07,610
cookies collecting<font color="#E5E5E5"> a browser there were</font>

531
00:24:05,750 --> 00:24:09,590
several issues actually<font color="#E5E5E5"> with that also</font>

532
00:24:07,610 --> 00:24:12,979
<font color="#E5E5E5">that collecting cookies value from</font>

533
00:24:09,590 --> 00:24:14,840
someone's machines is a security issue

534
00:24:12,980 --> 00:24:16,880
in the first<font color="#E5E5E5"> place because you're</font>

535
00:24:14,840 --> 00:24:19,250
collecting lots of information that

536
00:24:16,880 --> 00:24:22,420
<font color="#E5E5E5">should not leave machine</font><font color="#CCCCCC"> the reason</font>

537
00:24:19,250 --> 00:24:22,420
sumption is not leaving<font color="#E5E5E5"> a machine</font>

538
00:24:22,480 --> 00:24:28,490
sometimes we get some noise related to

539
00:24:26,810 --> 00:24:30,669
to one of the filters so there are

540
00:24:28,490 --> 00:24:36,080
filters that try to<font color="#E5E5E5"> extract domains from</font>

541
00:24:30,670 --> 00:24:38,750
particular<font color="#E5E5E5"> URLs there are so filters to</font>

542
00:24:36,080 --> 00:24:40,790
try to create kind of a network graph of

543
00:24:38,750 --> 00:24:43,040
related files so for instance<font color="#E5E5E5"> if you</font>

544
00:24:40,790 --> 00:24:44,450
have some related files to the one that

545
00:24:43,040 --> 00:24:46,430
<font color="#CCCCCC">is impacted maybe it's potentially</font>

546
00:24:44,450 --> 00:24:49,400
interesting to look at them as well<font color="#E5E5E5"> and</font>

547
00:24:46,430 --> 00:24:51,710
these<font color="#E5E5E5"> are most of the part too noisy to</font>

548
00:24:49,400 --> 00:24:55,670
be actually<font color="#CCCCCC"> taken seriously we very</font>

549
00:24:51,710 --> 00:24:57,800
seldom look at them on the latest mac

550
00:24:55,670 --> 00:25:00,140
hacks that are out there using GPU

551
00:24:57,800 --> 00:25:05,169
<font color="#CCCCCC">graphics attacks are you looking at</font>

552
00:25:00,140 --> 00:25:05,170
those not really<font color="#CCCCCC"> I'm not to bother</font>

553
00:25:05,900 --> 00:25:12,080
I was<font color="#E5E5E5"> wondering if you keep your OS X</font>

554
00:25:09,260 --> 00:25:13,670
collector files and periodically rerun

555
00:25:12,080 --> 00:25:16,610
them you know as your threat feed

556
00:25:13,670 --> 00:25:20,000
updates and if that's proven any of any

557
00:25:16,610 --> 00:25:23,260
value to you yeah so so<font color="#E5E5E5"> far what we are</font>

558
00:25:20,000 --> 00:25:26,930
doing we are keeping the malware

559
00:25:23,260 --> 00:25:30,520
forensics that we collected from the

560
00:25:26,930 --> 00:25:32,930
machines we are not a mirror yet<font color="#E5E5E5"> is not</font>

561
00:25:30,520 --> 00:25:36,020
to stifle apart<font color="#E5E5E5"> from this cache that</font>

562
00:25:32,930 --> 00:25:37,780
I've mentioned earlier<font color="#CCCCCC"> it's not creating</font>

563
00:25:36,020 --> 00:25:40,879
any state<font color="#E5E5E5"> there was actually a project</font>

564
00:25:37,780 --> 00:25:43,430
it was presented<font color="#CCCCCC"> at signed continue to</font>

565
00:25:40,880 --> 00:25:45,290
last year where people were trying

566
00:25:43,430 --> 00:25:49,130
basically to also put all those

567
00:25:45,290 --> 00:25:50,840
information I think it<font color="#E5E5E5"> was MongoDB but</font>

568
00:25:49,130 --> 00:25:52,340
you may<font color="#E5E5E5"> think of okay let's put it</font><font color="#CCCCCC"> in</font>

569
00:25:50,840 --> 00:25:54,860
something like elasticsearch clusters

570
00:25:52,340 --> 00:25:56,510
blanc and let's square it so these are

571
00:25:54,860 --> 00:25:59,330
potential next steps for this project

572
00:25:56,510 --> 00:26:01,129
basically apart from<font color="#E5E5E5"> just taking as like</font>

573
00:25:59,330 --> 00:26:04,639
one machine individually let's try to

574
00:26:01,130 --> 00:26:06,170
see how this machine differs from all

575
00:26:04,640 --> 00:26:08,780
the other machines in the network this

576
00:26:06,170 --> 00:26:11,030
<font color="#CCCCCC">is actually something that OS querrey is</font>

577
00:26:08,780 --> 00:26:13,460
able to do for instance like having the

578
00:26:11,030 --> 00:26:16,250
whole fleet of machines and trying to

579
00:26:13,460 --> 00:26:20,620
compare one machine against all others

580
00:26:16,250 --> 00:26:24,110
in the in the in the same infrastructure

581
00:26:20,620 --> 00:26:25,939
what's the run time of collection and a

582
00:26:24,110 --> 00:26:28,280
mirror I mean how long<font color="#CCCCCC"> it does it take</font>

583
00:26:25,940 --> 00:26:30,830
on each laptop and how<font color="#CCCCCC"> long does it</font><font color="#E5E5E5"> take</font>

584
00:26:28,280 --> 00:26:32,629
<font color="#CCCCCC">to process so the whole collection</font>

585
00:26:30,830 --> 00:26:37,639
process so just purely<font color="#E5E5E5"> OSX collector</font>

586
00:26:32,630 --> 00:26:39,740
script it does rely on how basically<font color="#E5E5E5"> for</font>

587
00:26:37,640 --> 00:26:41,840
how long time the machine was used if

588
00:26:39,740 --> 00:26:43,700
the machine was used for several years

589
00:26:41,840 --> 00:26:45,530
you will for instance like browser

590
00:26:43,700 --> 00:26:48,080
history<font color="#CCCCCC"> isn't pure like you have lots of</font>

591
00:26:45,530 --> 00:26:52,670
apps installed it<font color="#CCCCCC"> might take quite some</font>

592
00:26:48,080 --> 00:26:55,460
time then the whole I know so like<font color="#CCCCCC"> worst</font>

593
00:26:52,670 --> 00:26:57,110
<font color="#CCCCCC">case</font><font color="#E5E5E5"> like you know up</font><font color="#CCCCCC"> to a day let's say</font>

594
00:26:55,460 --> 00:26:58,880
yeah yeah we had the cases when it was

595
00:26:57,110 --> 00:27:00,290
like running for a day like it was still

596
00:26:58,880 --> 00:27:02,960
<font color="#E5E5E5">in the good old days of other skin</font>

597
00:27:00,290 --> 00:27:04,310
janiers trying to get the machine right

598
00:27:02,960 --> 00:27:07,220
now<font color="#E5E5E5"> as we</font><font color="#CCCCCC"> were running it by our</font>

599
00:27:04,310 --> 00:27:10,129
inventory management system we to be

600
00:27:07,220 --> 00:27:12,290
honest we don't collect too much insight

601
00:27:10,130 --> 00:27:13,340
about when the collection was<font color="#E5E5E5"> started</font>

602
00:27:12,290 --> 00:27:15,440
and then when the collection was

603
00:27:13,340 --> 00:27:16,790
finished we only know this time when the

604
00:27:15,440 --> 00:27:19,399
collection<font color="#CCCCCC"> was finished so you don't</font>

605
00:27:16,790 --> 00:27:21,289
know if the collection<font color="#CCCCCC"> was</font>

606
00:27:19,399 --> 00:27:23,899
because user for instance was not in the

607
00:27:21,289 --> 00:27:25,820
<font color="#CCCCCC">office for like a day and his machine</font>

608
00:27:23,899 --> 00:27:29,718
didn't mean up to the central inventory

609
00:27:25,820 --> 00:27:32,960
management system in the<font color="#E5E5E5"> best case I had</font>

610
00:27:29,719 --> 00:27:35,719
actually<font color="#E5E5E5"> on my when I was preparing</font><font color="#CCCCCC"> that</font>

611
00:27:32,960 --> 00:27:37,609
<font color="#E5E5E5">the presentation I had a case when the</font>

612
00:27:35,719 --> 00:27:39,440
whole collection and analysis process

613
00:27:37,609 --> 00:27:41,539
also running and others which can also

614
00:27:39,440 --> 00:27:43,849
may take up to<font color="#E5E5E5"> yeah and other several</font>

615
00:27:41,539 --> 00:27:47,359
hours it took eight minutes basically

616
00:27:43,849 --> 00:27:51,289
from collection to to having the results

617
00:27:47,359 --> 00:27:57,379
a available<font color="#CCCCCC"> for for the mall or analyst</font>

618
00:27:51,289 --> 00:28:00,279
to look at you mentioned started doing

619
00:27:57,379 --> 00:28:02,658
proactive collection have you looked at

620
00:28:00,279 --> 00:28:04,249
collecting that data and trending on the

621
00:28:02,659 --> 00:28:06,859
data over time in something like elastic

622
00:28:04,249 --> 00:28:08,299
search or<font color="#CCCCCC"> cabana yes so</font><font color="#E5E5E5"> this is</font>

623
00:28:06,859 --> 00:28:14,330
<font color="#E5E5E5">something we are not doing yet but</font>

624
00:28:08,299 --> 00:28:16,039
definitely something<font color="#E5E5E5"> I'd like</font><font color="#CCCCCC"> to work as</font>

625
00:28:14,330 --> 00:28:22,039
a next<font color="#E5E5E5"> steps basically after</font><font color="#CCCCCC"> we</font>

626
00:28:16,039 --> 00:28:23,599
automated older this kind<font color="#E5E5E5"> of similar</font>

627
00:28:22,039 --> 00:28:25,369
with respect to active defense do you

628
00:28:23,599 --> 00:28:28,989
guys have a particular threshold that

629
00:28:25,369 --> 00:28:31,189
you have to meet<font color="#E5E5E5"> in order before you</font>

630
00:28:28,989 --> 00:28:32,779
deploy the script or do you just kind of

631
00:28:31,190 --> 00:28:35,929
have this script you know already

632
00:28:32,779 --> 00:28:37,519
<font color="#E5E5E5">available to run on machines and you run</font>

633
00:28:35,929 --> 00:28:40,450
across all your machines or do you again

634
00:28:37,519 --> 00:28:42,739
<font color="#CCCCCC">or do you have</font><font color="#E5E5E5"> to reach a threshold so</font>

635
00:28:40,450 --> 00:28:45,739
yes we do have<font color="#E5E5E5"> something like a</font>

636
00:28:42,739 --> 00:28:47,509
threshold is basically this alerts we

637
00:28:45,739 --> 00:28:49,609
get from<font color="#E5E5E5"> endpoint</font><font color="#CCCCCC"> touring or network</font>

638
00:28:47,509 --> 00:28:51,349
monitoring so this<font color="#E5E5E5"> is our initial kind</font>

639
00:28:49,609 --> 00:28:54,320
of trigger for the<font color="#CCCCCC"> whole marwa</font><font color="#E5E5E5"> malware</font>

640
00:28:51,349 --> 00:29:00,070
incident response process but then we

641
00:28:54,320 --> 00:29:04,218
had some<font color="#E5E5E5"> cases in the past when we were</font>

642
00:29:00,070 --> 00:29:06,649
suspecting part of the fleet to be

643
00:29:04,219 --> 00:29:08,719
infected<font color="#E5E5E5"> with something and then with</font>

644
00:29:06,649 --> 00:29:10,789
<font color="#E5E5E5">just one click we were able to deploy</font>

645
00:29:08,719 --> 00:29:13,149
the script like<font color="#E5E5E5"> hundreds of machines get</font>

646
00:29:10,789 --> 00:29:16,219
the answers down by the next<font color="#E5E5E5"> day and</font>

647
00:29:13,149 --> 00:29:18,559
look at this so it's way more scalable

648
00:29:16,219 --> 00:29:21,149
than our previous approaching this

649
00:29:18,559 --> 00:29:22,950
what kind of file size is this OS<font color="#E5E5E5"> X</font>

650
00:29:21,149 --> 00:29:25,768
collector like<font color="#E5E5E5"> put out like</font><font color="#CCCCCC"> could be</font>

651
00:29:22,950 --> 00:29:29,279
seen file size in terms of the

652
00:29:25,769 --> 00:29:35,070
collection yeah so the tree was actually

653
00:29:29,279 --> 00:29:38,039
on the slide but the compressed tar.gz

654
00:29:35,070 --> 00:29:40,889
file it's usually<font color="#E5E5E5"> several megabytes if</font>

655
00:29:38,039 --> 00:29:45,749
you decompress it's like 60 megabytes 80

656
00:29:40,889 --> 00:29:51,269
megabytes something like<font color="#CCCCCC"> that okay any</font>

657
00:29:45,749 --> 00:29:54,230
other questions still<font color="#CCCCCC"> okay and no thank</font>

658
00:29:51,269 --> 00:29:54,230
<font color="#CCCCCC">you kuba let's hear it</font>

