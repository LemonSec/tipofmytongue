1
00:00:00,160 --> 00:00:01,920
good morning welcome back to b-sides

2
00:00:01,920 --> 00:00:03,760
this is breaking ground uh before we

3
00:00:03,760 --> 00:00:05,359
kick off i have a

4
00:00:05,359 --> 00:00:08,000
few quick announcements uh first of all

5
00:00:08,000 --> 00:00:09,280
i'd like to thank our sponsors

6
00:00:09,280 --> 00:00:10,960
especially lastpass

7
00:00:10,960 --> 00:00:13,040
palo alto networks and our gold sponsors

8
00:00:13,040 --> 00:00:15,519
amazon intel blue cat it's their support

9
00:00:15,519 --> 00:00:17,119
that makes this possible

10
00:00:17,119 --> 00:00:18,560
uh

11
00:00:18,560 --> 00:00:20,000
because these talks are being live

12
00:00:20,000 --> 00:00:21,439
streamed the camera's right there please

13
00:00:21,439 --> 00:00:23,680
turn off your cell phones because we are

14
00:00:23,680 --> 00:00:26,240
in person please keep your masks on

15
00:00:26,240 --> 00:00:27,760
so with that please welcome matt and

16
00:00:27,760 --> 00:00:30,760
rock

17
00:00:34,559 --> 00:00:36,960
hey everyone uh good morning uh if you

18
00:00:36,960 --> 00:00:39,280
saw the keynote this morning uh

19
00:00:39,280 --> 00:00:41,040
hopefully what you have over the next

20
00:00:41,040 --> 00:00:43,600
hour uh probably not gonna go that long

21
00:00:43,600 --> 00:00:45,280
are complementary to a lot of the things

22
00:00:45,280 --> 00:00:48,079
that mr hoff had

23
00:00:48,079 --> 00:00:49,280
so

24
00:00:49,280 --> 00:00:51,039
in my experience

25
00:00:51,039 --> 00:00:52,640
every great talk starts off when you

26
00:00:52,640 --> 00:00:54,559
insult a large portion of the audience

27
00:00:54,559 --> 00:00:56,559
if not all of the audience

28
00:00:56,559 --> 00:00:58,480
and uh let's do that

29
00:00:58,480 --> 00:01:01,440
so uh there are some of you in the crowd

30
00:01:01,440 --> 00:01:03,280
or those watching online

31
00:01:03,280 --> 00:01:06,080
uh that either do not have a threat

32
00:01:06,080 --> 00:01:08,560
model that you're defending against in

33
00:01:08,560 --> 00:01:10,960
your you know home environment your work

34
00:01:10,960 --> 00:01:12,960
environment and there are some of you

35
00:01:12,960 --> 00:01:14,640
that absolutely have an antiquated

36
00:01:14,640 --> 00:01:17,200
threat model and what do i mean by that

37
00:01:17,200 --> 00:01:19,040
that you're still looking at the insider

38
00:01:19,040 --> 00:01:20,799
threats the nation-state actors the

39
00:01:20,799 --> 00:01:23,200
criminal actors uh that wish to deploy

40
00:01:23,200 --> 00:01:25,600
crypto miners in your network uh yes

41
00:01:25,600 --> 00:01:27,600
those are all viable threats that you

42
00:01:27,600 --> 00:01:29,520
need to be concerned about but there's a

43
00:01:29,520 --> 00:01:31,920
more nefarious one that we believe you

44
00:01:31,920 --> 00:01:33,590
should pay more attention to

45
00:01:33,590 --> 00:01:34,799
[Music]

46
00:01:34,799 --> 00:01:36,640
and this is a threat that has access to

47
00:01:36,640 --> 00:01:39,520
all of your emails it has access to all

48
00:01:39,520 --> 00:01:42,399
of your workstations your servers your

49
00:01:42,399 --> 00:01:45,759
routers your switches your netflow

50
00:01:45,759 --> 00:01:48,479
all of your bring your own devices

51
00:01:48,479 --> 00:01:50,320
and more importantly this is one that

52
00:01:50,320 --> 00:01:52,000
you probably paid several million

53
00:01:52,000 --> 00:01:54,799
dollars to put in the network welcoming

54
00:01:54,799 --> 00:01:56,880
it into your environment so what am i

55
00:01:56,880 --> 00:01:59,200
talking about i am talking about the

56
00:01:59,200 --> 00:02:01,680
security appliances and solutions that

57
00:02:01,680 --> 00:02:04,000
are there that you rely on for your

58
00:02:04,000 --> 00:02:05,520
security

59
00:02:05,520 --> 00:02:07,600
in the event that there is a zero day in

60
00:02:07,600 --> 00:02:09,840
the event that there is a compromise of

61
00:02:09,840 --> 00:02:12,959
one of these trusted solutions

62
00:02:12,959 --> 00:02:14,959
these have perfect access in your

63
00:02:14,959 --> 00:02:16,720
environment

64
00:02:16,720 --> 00:02:18,879
and over the next several slides we're

65
00:02:18,879 --> 00:02:21,680
going to talk about ways that you can

66
00:02:21,680 --> 00:02:23,440
even with a zero day you can't stop that

67
00:02:23,440 --> 00:02:24,560
zero day

68
00:02:24,560 --> 00:02:26,160
but what can you do to mitigate the

69
00:02:26,160 --> 00:02:28,000
impact to in your organization when you

70
00:02:28,000 --> 00:02:31,519
have an appliance with damn near perfect

71
00:02:31,519 --> 00:02:33,599
access to your end price

72
00:02:33,599 --> 00:02:37,040
so uh with that uh we're gonna go

73
00:02:37,040 --> 00:02:38,800
through everyone's favorite talk

74
00:02:38,800 --> 00:02:42,720
compliance uh everyone loves that uh

75
00:02:42,720 --> 00:02:44,879
what are some implications of having

76
00:02:44,879 --> 00:02:47,840
these work from home uh scenarios

77
00:02:47,840 --> 00:02:51,040
uh we'll go through a very common uh

78
00:02:51,040 --> 00:02:55,280
exploit vector into your environment

79
00:02:57,760 --> 00:03:00,080
we'll have a guy checking for things

80
00:03:00,080 --> 00:03:02,959
just looking for experiment yep and uh

81
00:03:02,959 --> 00:03:04,400
we'll also talk about

82
00:03:04,400 --> 00:03:08,319
uh you know the newfangled uh aiml that

83
00:03:08,319 --> 00:03:10,560
people are moving towards in enterprise

84
00:03:10,560 --> 00:03:11,840
environments

85
00:03:11,840 --> 00:03:13,200
[Music]

86
00:03:13,200 --> 00:03:15,519
so on to compliance

87
00:03:15,519 --> 00:03:18,400
so these are uh you know if we're lucky

88
00:03:18,400 --> 00:03:20,080
once a year people within their

89
00:03:20,080 --> 00:03:21,519
environments will take a look at them

90
00:03:21,519 --> 00:03:23,440
because it's audit time

91
00:03:23,440 --> 00:03:25,040
these are extremely prescriptive they're

92
00:03:25,040 --> 00:03:26,799
going to tell you what to do and where

93
00:03:26,799 --> 00:03:28,239
to have it

94
00:03:28,239 --> 00:03:29,680
but it's going to leave you up to what's

95
00:03:29,680 --> 00:03:31,440
in leave up to you is to figure out how

96
00:03:31,440 --> 00:03:33,440
to do it securely how do you do it in a

97
00:03:33,440 --> 00:03:35,120
manner that is actually not inducing

98
00:03:35,120 --> 00:03:37,360
more risk in your environment

99
00:03:37,360 --> 00:03:38,640
and another thing that you have to worry

100
00:03:38,640 --> 00:03:41,360
about is you know what are you actually

101
00:03:41,360 --> 00:03:43,440
attempting to secure with these

102
00:03:43,440 --> 00:03:45,200
compliance standards

103
00:03:45,200 --> 00:03:47,040
and like i said earlier it's really the

104
00:03:47,040 --> 00:03:49,360
old threat model the insider threats

105
00:03:49,360 --> 00:03:51,120
maybe some of the compliance standards

106
00:03:51,120 --> 00:03:53,040
actually don't actually consider that a

107
00:03:53,040 --> 00:03:54,799
lot of it is you know security at the

108
00:03:54,799 --> 00:03:55,840
perimeter

109
00:03:55,840 --> 00:03:58,239
uh but now there's things like the cloud

110
00:03:58,239 --> 00:04:00,239
and it's the compliance standards don't

111
00:04:00,239 --> 00:04:02,000
really incorporate that as well

112
00:04:02,000 --> 00:04:04,400
and i have not seen a compliance

113
00:04:04,400 --> 00:04:06,720
standard to date that actually accounts

114
00:04:06,720 --> 00:04:08,560
for when a

115
00:04:08,560 --> 00:04:10,799
mandated security solution

116
00:04:10,799 --> 00:04:13,360
is the point of vulnerability what do

117
00:04:13,360 --> 00:04:15,599
you do at that point

118
00:04:15,599 --> 00:04:17,120
the good news is that we can actually

119
00:04:17,120 --> 00:04:19,358
rationalize this threat and we can

120
00:04:19,358 --> 00:04:21,519
identify that yes we must do these

121
00:04:21,519 --> 00:04:23,840
things to stay compliant

122
00:04:23,840 --> 00:04:26,560
based off federal state local standards

123
00:04:26,560 --> 00:04:28,560
however we can understand you know the

124
00:04:28,560 --> 00:04:31,840
implications within our environment and

125
00:04:31,840 --> 00:04:34,080
what is not covered and so you can take

126
00:04:34,080 --> 00:04:36,479
these you know very abstract very broad

127
00:04:36,479 --> 00:04:38,880
uh requirements and build something

128
00:04:38,880 --> 00:04:41,280
that's more tailored a complementary

129
00:04:41,280 --> 00:04:43,840
checklist that allows you to go in

130
00:04:43,840 --> 00:04:45,919
and actually define the individual

131
00:04:45,919 --> 00:04:47,600
things you need to be looking for based

132
00:04:47,600 --> 00:04:50,000
off of your architecture based off the

133
00:04:50,000 --> 00:04:52,000
security applications based off the

134
00:04:52,000 --> 00:04:53,280
software that you're running in your

135
00:04:53,280 --> 00:04:54,880
environment

136
00:04:54,880 --> 00:04:56,400
and then based off that

137
00:04:56,400 --> 00:04:57,919
hopefully what you've done is create

138
00:04:57,919 --> 00:04:59,520
something that's usable something that

139
00:04:59,520 --> 00:05:01,199
you look at more than once a year who

140
00:05:01,199 --> 00:05:02,960
knows maybe monthly right

141
00:05:02,960 --> 00:05:05,520
and it allows you to uh you know stay

142
00:05:05,520 --> 00:05:07,520
ahead of emerging threats because it's

143
00:05:07,520 --> 00:05:11,520
internally developed and it's useful

144
00:05:11,520 --> 00:05:12,960
so uh

145
00:05:12,960 --> 00:05:14,400
some things have happened in the world

146
00:05:14,400 --> 00:05:17,039
since 2020. i have seen some compliance

147
00:05:17,039 --> 00:05:18,560
standards that have not been updated

148
00:05:18,560 --> 00:05:20,560
since 2014

149
00:05:20,560 --> 00:05:22,240
but we are still

150
00:05:22,240 --> 00:05:24,479
required to adhere to those 2014

151
00:05:24,479 --> 00:05:26,880
standards uh despite you know things

152
00:05:26,880 --> 00:05:29,120
being different at work and so with that

153
00:05:29,120 --> 00:05:30,400
matt's gonna talk a little bit about

154
00:05:30,400 --> 00:05:31,570
some of those changes

155
00:05:31,570 --> 00:05:34,400
[Music]

156
00:05:34,400 --> 00:05:36,560
all right good morning everybody so rock

157
00:05:36,560 --> 00:05:38,320
presented to you some some of the old

158
00:05:38,320 --> 00:05:40,639
modeling and what we're doing as

159
00:05:40,639 --> 00:05:41,919
organized as

160
00:05:41,919 --> 00:05:44,240
professionals security professionals

161
00:05:44,240 --> 00:05:46,080
but how does that feed into our

162
00:05:46,080 --> 00:05:48,160
organizational mission right we can

163
00:05:48,160 --> 00:05:50,160
isolate ourselves and say my job is to

164
00:05:50,160 --> 00:05:51,600
just look at these dashboards look at

165
00:05:51,600 --> 00:05:54,400
the systems that tell me day-to-day what

166
00:05:54,400 --> 00:05:55,759
is actually happening like with my

167
00:05:55,759 --> 00:05:58,319
alerts and with that structure but going

168
00:05:58,319 --> 00:06:00,160
forward the challenge as we go through

169
00:06:00,160 --> 00:06:02,560
these this presentation is to marry that

170
00:06:02,560 --> 00:06:05,039
to your organization's mission to then

171
00:06:05,039 --> 00:06:06,400
inform them

172
00:06:06,400 --> 00:06:08,479
of new models to follow new threats to

173
00:06:08,479 --> 00:06:10,639
advise them on and a way to structure it

174
00:06:10,639 --> 00:06:11,440
out

175
00:06:11,440 --> 00:06:13,199
so that it's not a burden to you and to

176
00:06:13,199 --> 00:06:14,720
go back to the very i gotta go back and

177
00:06:14,720 --> 00:06:17,120
rebuild this whole 2014 model not

178
00:06:17,120 --> 00:06:18,639
necessarily no

179
00:06:18,639 --> 00:06:21,199
right it's laborious to do those things

180
00:06:21,199 --> 00:06:22,800
but if we understand the context of the

181
00:06:22,800 --> 00:06:24,800
mission that our organization is doing

182
00:06:24,800 --> 00:06:27,440
in our mission we can then provide more

183
00:06:27,440 --> 00:06:30,319
agile responsive measures to then manage

184
00:06:30,319 --> 00:06:33,520
these threats and model them

185
00:06:33,520 --> 00:06:35,360
right so

186
00:06:35,360 --> 00:06:36,560
there are we're going to give two

187
00:06:36,560 --> 00:06:39,120
examples and for one is the work from

188
00:06:39,120 --> 00:06:40,240
home model

189
00:06:40,240 --> 00:06:42,400
right so we've

190
00:06:42,400 --> 00:06:44,400
over the last years with covid had

191
00:06:44,400 --> 00:06:46,639
integrated this work from home systems

192
00:06:46,639 --> 00:06:48,720
into our our networks

193
00:06:48,720 --> 00:06:51,120
now when we did that we took a lot of

194
00:06:51,120 --> 00:06:53,280
managed and assumed risk

195
00:06:53,280 --> 00:06:55,599
for the end user we're like okay we're

196
00:06:55,599 --> 00:06:57,440
going to purchase this resource that

197
00:06:57,440 --> 00:06:59,120
we're not going to own but we're going

198
00:06:59,120 --> 00:07:01,360
to rely on it to provide them access

199
00:07:01,360 --> 00:07:04,080
into our networks right

200
00:07:04,080 --> 00:07:06,560
that structure and that management

201
00:07:06,560 --> 00:07:08,560
are we are we 100 aware of what the

202
00:07:08,560 --> 00:07:10,960
implications of that are right as

203
00:07:10,960 --> 00:07:13,360
security practitioners

204
00:07:13,360 --> 00:07:16,080
and for me as i was going through this

205
00:07:16,080 --> 00:07:18,560
the answer was no right

206
00:07:18,560 --> 00:07:19,919
people started managing things

207
00:07:19,919 --> 00:07:22,160
differently the net flow was was odd

208
00:07:22,160 --> 00:07:23,520
people were touching different things

209
00:07:23,520 --> 00:07:25,759
that we weren't aware of

210
00:07:25,759 --> 00:07:27,199
because of the structure that we had put

211
00:07:27,199 --> 00:07:28,639
in place

212
00:07:28,639 --> 00:07:31,360
so our understanding had changed we went

213
00:07:31,360 --> 00:07:33,120
back and tried to look at our baseline

214
00:07:33,120 --> 00:07:35,759
and well we had to do one

215
00:07:35,759 --> 00:07:37,759
but it wasn't as robust no it meant the

216
00:07:37,759 --> 00:07:39,520
prescriptive measures of my yearly

217
00:07:39,520 --> 00:07:41,360
requirements to then answer those

218
00:07:41,360 --> 00:07:42,720
questions be like okay this is what it

219
00:07:42,720 --> 00:07:44,479
does this is generally what people are

220
00:07:44,479 --> 00:07:46,639
doing here's what's happening well there

221
00:07:46,639 --> 00:07:48,240
are massive deviations when we started

222
00:07:48,240 --> 00:07:50,000
integrating this work from home model

223
00:07:50,000 --> 00:07:50,800
right

224
00:07:50,800 --> 00:07:52,080
we had

225
00:07:52,080 --> 00:07:55,680
i.t and we had hr accessing the networks

226
00:07:55,680 --> 00:07:57,360
externally to internal

227
00:07:57,360 --> 00:07:58,639
so now we have to make comparative

228
00:07:58,639 --> 00:08:00,400
analysis of understanding what the

229
00:08:00,400 --> 00:08:02,800
implications of that are right and start

230
00:08:02,800 --> 00:08:04,160
building a model

231
00:08:04,160 --> 00:08:05,360
for threats

232
00:08:05,360 --> 00:08:08,000
relative to that

233
00:08:08,000 --> 00:08:11,280
so then security changed our our context

234
00:08:11,280 --> 00:08:12,800
changed

235
00:08:12,800 --> 00:08:14,400
and that's a difficult

236
00:08:14,400 --> 00:08:16,000
problem to overcome

237
00:08:16,000 --> 00:08:17,919
because reframing and re-un and

238
00:08:17,919 --> 00:08:20,720
understanding holistically

239
00:08:20,720 --> 00:08:23,039
what is now critical versus what was

240
00:08:23,039 --> 00:08:24,160
critical

241
00:08:24,160 --> 00:08:26,720
is different right it was easy on-prem

242
00:08:26,720 --> 00:08:28,319
to say hr you're just going to be doing

243
00:08:28,319 --> 00:08:30,160
these things with these things i t

244
00:08:30,160 --> 00:08:32,080
you'll do this with that i can manage

245
00:08:32,080 --> 00:08:34,240
that i can monitor that but it changed

246
00:08:34,240 --> 00:08:36,159
well now we have to support hr accessing

247
00:08:36,159 --> 00:08:37,760
multiple different things different

248
00:08:37,760 --> 00:08:39,440
people with different software with

249
00:08:39,440 --> 00:08:41,839
different devices tying into this vpn

250
00:08:41,839 --> 00:08:44,399
concentrator than accessing i i can't

251
00:08:44,399 --> 00:08:46,880
necessarily manage those things right

252
00:08:46,880 --> 00:08:48,399
now because i didn't take that into

253
00:08:48,399 --> 00:08:49,839
account as i was building this work from

254
00:08:49,839 --> 00:08:52,399
home structure so as i try to understand

255
00:08:52,399 --> 00:08:54,320
what threat modeling is and

256
00:08:54,320 --> 00:08:56,399
understanding the data making sure it's

257
00:08:56,399 --> 00:08:58,160
one common information model making sure

258
00:08:58,160 --> 00:08:59,680
i can understand it and then advise

259
00:08:59,680 --> 00:09:02,000
people on it and then also

260
00:09:02,000 --> 00:09:04,640
in part is security practices on top of

261
00:09:04,640 --> 00:09:08,000
that was very difficult

262
00:09:08,000 --> 00:09:09,600
then the impact

263
00:09:09,600 --> 00:09:12,399
was massive right it was very hard to

264
00:09:12,399 --> 00:09:14,320
then understand okay if they do gain

265
00:09:14,320 --> 00:09:16,880
access to whatever our vpn concentrator

266
00:09:16,880 --> 00:09:18,399
is when are they going to let us know

267
00:09:18,399 --> 00:09:20,640
and who does it impact and how big is

268
00:09:20,640 --> 00:09:22,000
that impact going to be to what they

269
00:09:22,000 --> 00:09:23,839
touch on my infrastructure

270
00:09:23,839 --> 00:09:26,560
right that's a massive lift to say your

271
00:09:26,560 --> 00:09:28,720
organization might might have

272
00:09:28,720 --> 00:09:30,480
100 people in hr

273
00:09:30,480 --> 00:09:31,279
right

274
00:09:31,279 --> 00:09:33,200
and they're they're touching several

275
00:09:33,200 --> 00:09:34,880
different things i didn't expect them to

276
00:09:34,880 --> 00:09:37,200
do but have i taken that into account to

277
00:09:37,200 --> 00:09:38,720
understand the data

278
00:09:38,720 --> 00:09:40,959
so

279
00:09:40,959 --> 00:09:42,959
what can we do how can we respond at the

280
00:09:42,959 --> 00:09:45,040
end of that long road and how can we

281
00:09:45,040 --> 00:09:46,160
understand it

282
00:09:46,160 --> 00:09:48,399
am i going to say destroy it and rebuild

283
00:09:48,399 --> 00:09:50,080
it now that you have the understanding

284
00:09:50,080 --> 00:09:52,640
no because it's not feasible

285
00:09:52,640 --> 00:09:54,640
it's too much to say hey as security

286
00:09:54,640 --> 00:09:56,480
practitioners we now understand

287
00:09:56,480 --> 00:09:58,880
hindsight being 2020 we need to tear it

288
00:09:58,880 --> 00:10:01,120
down and build it back up

289
00:10:01,120 --> 00:10:02,160
well i don't know if you're gonna keep

290
00:10:02,160 --> 00:10:03,200
anybody who's gonna be like i just

291
00:10:03,200 --> 00:10:04,640
worked on this thing for two years it

292
00:10:04,640 --> 00:10:06,320
was fine two years ago why am i going to

293
00:10:06,320 --> 00:10:07,519
rebuild it

294
00:10:07,519 --> 00:10:09,680
well let's just apply some principles

295
00:10:09,680 --> 00:10:11,920
that we can then manage and monitor and

296
00:10:11,920 --> 00:10:13,920
integrate to our day-to-day to have a

297
00:10:13,920 --> 00:10:16,160
better holistic understanding

298
00:10:16,160 --> 00:10:18,000
and one of those principles is just

299
00:10:18,000 --> 00:10:21,040
enough administration in powershell

300
00:10:21,040 --> 00:10:24,079
right as a security practitioner and

301
00:10:24,079 --> 00:10:26,000
having people external come into my

302
00:10:26,000 --> 00:10:28,399
environment i want to understand and

303
00:10:28,399 --> 00:10:30,160
define what they're functionally capable

304
00:10:30,160 --> 00:10:32,720
of doing so i can monitor it and if

305
00:10:32,720 --> 00:10:35,440
something is outside of those bounds

306
00:10:35,440 --> 00:10:38,480
i can then respond to it in a more agile

307
00:10:38,480 --> 00:10:39,839
manner

308
00:10:39,839 --> 00:10:41,920
now with just enough administration

309
00:10:41,920 --> 00:10:43,519
we can define groups

310
00:10:43,519 --> 00:10:46,320
that over time have become bloated right

311
00:10:46,320 --> 00:10:47,279
but we can give them the

312
00:10:47,279 --> 00:10:48,800
responsibilities

313
00:10:48,800 --> 00:10:51,839
of using specific modules or specific

314
00:10:51,839 --> 00:10:53,519
commandments to do whatever they need to

315
00:10:53,519 --> 00:10:54,320
do

316
00:10:54,320 --> 00:10:56,240
right and if they come to us and say

317
00:10:56,240 --> 00:10:57,600
that thing i was doing last week isn't

318
00:10:57,600 --> 00:10:58,880
working what did you do what did you

319
00:10:58,880 --> 00:11:01,040
change well maybe i didn't have an

320
00:11:01,040 --> 00:11:02,399
understanding and inventory of what it

321
00:11:02,399 --> 00:11:04,640
is you were trying to accomplish so now

322
00:11:04,640 --> 00:11:06,160
they're in a roundabout way advising me

323
00:11:06,160 --> 00:11:07,680
as to how their interactions on that

324
00:11:07,680 --> 00:11:10,480
network are going to impact me

325
00:11:10,480 --> 00:11:13,680
right not just as the the manager of it

326
00:11:13,680 --> 00:11:15,920
personnel but as an advisor to those

327
00:11:15,920 --> 00:11:17,680
that purchase products right integrate

328
00:11:17,680 --> 00:11:19,760
products integrate solutions

329
00:11:19,760 --> 00:11:21,839
right if we're just building on building

330
00:11:21,839 --> 00:11:23,279
on building with with a product and

331
00:11:23,279 --> 00:11:25,680
we're taking the human thought and the

332
00:11:25,680 --> 00:11:28,320
decision making away from from your your

333
00:11:28,320 --> 00:11:30,480
junior analysts or your junior i.t

334
00:11:30,480 --> 00:11:32,480
specialists well you're not staying

335
00:11:32,480 --> 00:11:34,800
ahead of the curve realistically you're

336
00:11:34,800 --> 00:11:36,399
just maintaining the status quo that

337
00:11:36,399 --> 00:11:39,760
prescribed measures that are necessary

338
00:11:39,760 --> 00:11:41,279
because that's what keeps your job going

339
00:11:41,279 --> 00:11:42,399
but it's not progressive it's not

340
00:11:42,399 --> 00:11:44,240
keeping you ahead of the adversary in

341
00:11:44,240 --> 00:11:46,000
this type of work from home environment

342
00:11:46,000 --> 00:11:47,040
right

343
00:11:47,040 --> 00:11:48,959
signing scripts is a simple solution as

344
00:11:48,959 --> 00:11:51,040
well you can manage and track them

345
00:11:51,040 --> 00:11:53,519
right you now understand as

346
00:11:53,519 --> 00:11:54,880
let's say an adversary gets into your

347
00:11:54,880 --> 00:11:56,399
network and wants to lock down the

348
00:11:56,399 --> 00:11:58,160
entire enterprise by pushing out a

349
00:11:58,160 --> 00:12:00,639
script to then you know encrypt

350
00:12:00,639 --> 00:12:02,480
everything for ransom

351
00:12:02,480 --> 00:12:03,839
well if you're signing your scripts and

352
00:12:03,839 --> 00:12:05,760
you've denied the access of unsigned

353
00:12:05,760 --> 00:12:08,240
scripts you've now imposed the cost of

354
00:12:08,240 --> 00:12:09,360
time

355
00:12:09,360 --> 00:12:11,200
on an adversary right

356
00:12:11,200 --> 00:12:15,279
and now we're building a slog a quagmire

357
00:12:15,279 --> 00:12:17,760
into our networks but it's it's a

358
00:12:17,760 --> 00:12:19,839
designed one we understand it because

359
00:12:19,839 --> 00:12:21,519
we're designing it we're imparting these

360
00:12:21,519 --> 00:12:23,040
principles right

361
00:12:23,040 --> 00:12:24,800
we need to define who our trusted hosts

362
00:12:24,800 --> 00:12:26,800
are when we built the work from home

363
00:12:26,800 --> 00:12:28,560
model

364
00:12:28,560 --> 00:12:30,160
initially there was a lot of what we got

365
00:12:30,160 --> 00:12:31,680
to let them do what they got to do we

366
00:12:31,680 --> 00:12:33,120
don't understand

367
00:12:33,120 --> 00:12:34,880
how they're do like hr is telling us

368
00:12:34,880 --> 00:12:36,720
logically how they're doing it but how

369
00:12:36,720 --> 00:12:38,639
are they doing it how is it doing it

370
00:12:38,639 --> 00:12:40,720
right well okay they need to touch a lot

371
00:12:40,720 --> 00:12:42,480
of stuff so let's just give them

372
00:12:42,480 --> 00:12:45,360
access to touch a lot of stuff

373
00:12:45,360 --> 00:12:46,959
but when it comes back to that baseline

374
00:12:46,959 --> 00:12:48,320
deviation and what they're actually

375
00:12:48,320 --> 00:12:50,320
doing have we gone back and refined it

376
00:12:50,320 --> 00:12:51,680
because if our adversaries are there

377
00:12:51,680 --> 00:12:52,800
they are

378
00:12:52,800 --> 00:12:54,320
they're absolutely doing that they're

379
00:12:54,320 --> 00:12:55,760
getting ahead of you as individuals

380
00:12:55,760 --> 00:12:57,920
right you as an organization use a team

381
00:12:57,920 --> 00:12:59,839
because you're taking

382
00:12:59,839 --> 00:13:01,760
prescribed measures but not defined

383
00:13:01,760 --> 00:13:02,880
measures

384
00:13:02,880 --> 00:13:05,360
right and then isolating remote systems

385
00:13:05,360 --> 00:13:07,360
understanding

386
00:13:07,360 --> 00:13:09,360
why steve has to come in

387
00:13:09,360 --> 00:13:11,440
via one jump box and that he told his

388
00:13:11,440 --> 00:13:13,200
whole team that he has to do that same

389
00:13:13,200 --> 00:13:15,600
thing when we have 17 different right

390
00:13:15,600 --> 00:13:18,079
now isolation and understanding to then

391
00:13:18,079 --> 00:13:21,399
make more

392
00:13:21,680 --> 00:13:25,360
documented refined and defined decisions

393
00:13:25,360 --> 00:13:27,920
we can then impart all four of these

394
00:13:27,920 --> 00:13:29,839
onto our network and respond more

395
00:13:29,839 --> 00:13:32,720
effectively advise more effectively and

396
00:13:32,720 --> 00:13:35,519
build out models that aren't burdensome

397
00:13:35,519 --> 00:13:36,959
right and then we also don't have to

398
00:13:36,959 --> 00:13:39,120
tell our leaders hey this thing doesn't

399
00:13:39,120 --> 00:13:41,040
work because when we built it

400
00:13:41,040 --> 00:13:43,199
we missed too much

401
00:13:43,199 --> 00:13:45,440
so that we can then enable and empower

402
00:13:45,440 --> 00:13:48,720
our teams to then be like well this is a

403
00:13:48,720 --> 00:13:50,480
new way of doing it we can impart this

404
00:13:50,480 --> 00:13:51,839
on there this is a new function or

405
00:13:51,839 --> 00:13:53,839
feature that we need and those

406
00:13:53,839 --> 00:13:55,920
advisements make what we're trying to do

407
00:13:55,920 --> 00:13:57,680
more effective and we don't always have

408
00:13:57,680 --> 00:13:59,279
to start over

409
00:13:59,279 --> 00:14:01,360
yeah so again you know back to the whole

410
00:14:01,360 --> 00:14:03,839
principle of this talk this is not a you

411
00:14:03,839 --> 00:14:05,920
know if you do this you'll be successful

412
00:14:05,920 --> 00:14:07,920
list this is a subset of what you could

413
00:14:07,920 --> 00:14:08,959
be doing

414
00:14:08,959 --> 00:14:11,680
but again it's about checks and balances

415
00:14:11,680 --> 00:14:13,360
if you are implementing these controls

416
00:14:13,360 --> 00:14:14,639
in your environment what it's going to

417
00:14:14,639 --> 00:14:16,880
do is provide some mitigation against a

418
00:14:16,880 --> 00:14:19,199
zero day against your vpn concentrator

419
00:14:19,199 --> 00:14:20,639
but now what happens when one of these

420
00:14:20,639 --> 00:14:22,320
have been compromised it's always

421
00:14:22,320 --> 00:14:25,199
iterative right so if you are allowing

422
00:14:25,199 --> 00:14:27,440
only signed scripts what happens when

423
00:14:27,440 --> 00:14:29,760
the adversary can now sign scripts and

424
00:14:29,760 --> 00:14:31,680
deploy throughout your network do you

425
00:14:31,680 --> 00:14:33,920
understand the baseline the additions

426
00:14:33,920 --> 00:14:36,560
the unauthorized editions the deviations

427
00:14:36,560 --> 00:14:38,560
from all of these activities

428
00:14:38,560 --> 00:14:40,000
someone just added a new host a new

429
00:14:40,000 --> 00:14:42,720
trusted host overnight who did it why is

430
00:14:42,720 --> 00:14:43,839
there changed management in the

431
00:14:43,839 --> 00:14:46,160
environment that's robust enough

432
00:14:46,160 --> 00:14:50,399
to account for these anomalies so

433
00:14:50,700 --> 00:14:53,040
[Music]

434
00:14:53,040 --> 00:14:54,720
so then we're going to go to a more

435
00:14:54,720 --> 00:14:57,279
defined model right so when it came to

436
00:14:57,279 --> 00:14:59,040
exchange server abuse with proxy log on

437
00:14:59,040 --> 00:15:00,560
there's plenty of documentation of when

438
00:15:00,560 --> 00:15:03,760
it the the the the after effects of that

439
00:15:03,760 --> 00:15:04,959
event right

440
00:15:04,959 --> 00:15:06,560
we identified that our exchange servers

441
00:15:06,560 --> 00:15:08,240
are internet facing we know that

442
00:15:08,240 --> 00:15:09,680
showdown exists

443
00:15:09,680 --> 00:15:10,880
we know that there's an api that's going

444
00:15:10,880 --> 00:15:12,720
to be scanning for something

445
00:15:12,720 --> 00:15:14,560
whether it's an icon with an md5 hash

446
00:15:14,560 --> 00:15:16,639
that's tied to a version

447
00:15:16,639 --> 00:15:18,880
of an of a vulnerable system or server

448
00:15:18,880 --> 00:15:20,639
right they're then going to take that

449
00:15:20,639 --> 00:15:22,320
and they'll use cve trends on twitter

450
00:15:22,320 --> 00:15:24,480
and be like okay does this apply can i

451
00:15:24,480 --> 00:15:26,560
use this this resource is there a poc

452
00:15:26,560 --> 00:15:28,880
that exists on github that i can then

453
00:15:28,880 --> 00:15:30,480
leverage

454
00:15:30,480 --> 00:15:32,560
and use on this on this environment

455
00:15:32,560 --> 00:15:33,759
right then they're gonna aim for

456
00:15:33,759 --> 00:15:35,120
privileged access and remote code

457
00:15:35,120 --> 00:15:37,920
execution right but their ultimate end

458
00:15:37,920 --> 00:15:40,079
state isn't just that privileged access

459
00:15:40,079 --> 00:15:41,360
it's they're leveraging the peers and

460
00:15:41,360 --> 00:15:42,800
the trust relationships that we all have

461
00:15:42,800 --> 00:15:44,959
to find because of how the enterprise

462
00:15:44,959 --> 00:15:48,079
has to work right we have to support

463
00:15:48,079 --> 00:15:50,000
these relationships to then manage

464
00:15:50,000 --> 00:15:52,240
monitor keep keep up to date understand

465
00:15:52,240 --> 00:15:54,320
the health and welfare of these systems

466
00:15:54,320 --> 00:15:55,600
but they're also interconnected

467
00:15:55,600 --> 00:15:57,759
throughout my enterprise my admins are

468
00:15:57,759 --> 00:15:59,759
going there because there's no fault

469
00:15:59,759 --> 00:16:01,519
tolerance we have we have a load balance

470
00:16:01,519 --> 00:16:03,680
system with eight exchange servers a

471
00:16:03,680 --> 00:16:05,519
primary and an alternate and they're

472
00:16:05,519 --> 00:16:07,680
going to these boxes right how are they

473
00:16:07,680 --> 00:16:09,920
doing it why are they doing it this way

474
00:16:09,920 --> 00:16:11,600
are they using rdp

475
00:16:11,600 --> 00:16:13,199
right are they using secure rdp because

476
00:16:13,199 --> 00:16:14,880
they're trying to do a two-hop jump

477
00:16:14,880 --> 00:16:16,720
without with which is difficult with

478
00:16:16,720 --> 00:16:18,959
standard rdp or are they doing it in

479
00:16:18,959 --> 00:16:20,639
some other way right

480
00:16:20,639 --> 00:16:22,959
now our goal as

481
00:16:22,959 --> 00:16:24,320
defenders

482
00:16:24,320 --> 00:16:26,560
is not to disrupt those essential

483
00:16:26,560 --> 00:16:29,519
services but it is to inform and advise

484
00:16:29,519 --> 00:16:31,759
to then protect them and like i said

485
00:16:31,759 --> 00:16:34,000
provide that quagmire for an adversary

486
00:16:34,000 --> 00:16:36,480
to then impose the cost the the the cost

487
00:16:36,480 --> 00:16:38,000
of time

488
00:16:38,000 --> 00:16:39,839
on them so we can get ahead of it we can

489
00:16:39,839 --> 00:16:41,680
understand it so when things start

490
00:16:41,680 --> 00:16:43,600
happening that are outside those bounds

491
00:16:43,600 --> 00:16:45,120
those left and rights that we have to

492
00:16:45,120 --> 00:16:48,800
find we can then answer them

493
00:16:48,880 --> 00:16:50,480
so

494
00:16:50,480 --> 00:16:52,560
i looked at a few things for this right

495
00:16:52,560 --> 00:16:53,920
and i know i just mentioned like they're

496
00:16:53,920 --> 00:16:55,360
using rdp

497
00:16:55,360 --> 00:16:56,800
well they need to stop like it's

498
00:16:56,800 --> 00:16:58,240
controversial

499
00:16:58,240 --> 00:17:00,480
but stop doing it right we can start

500
00:17:00,480 --> 00:17:02,079
using openssh

501
00:17:02,079 --> 00:17:04,000
with windows for windows right and we

502
00:17:04,000 --> 00:17:05,760
can tunnel through the network and use

503
00:17:05,760 --> 00:17:08,160
it for both domain joined and non-domain

504
00:17:08,160 --> 00:17:10,640
joined right so we updated our modeling

505
00:17:10,640 --> 00:17:12,480
we said okay if we're going to be doing

506
00:17:12,480 --> 00:17:13,520
these things and we're going to try to

507
00:17:13,520 --> 00:17:15,039
stay ahead of the curve

508
00:17:15,039 --> 00:17:17,199
how can we do that if we're doing these

509
00:17:17,199 --> 00:17:18,559
prescribed measures that were there

510
00:17:18,559 --> 00:17:19,760
three years ago

511
00:17:19,760 --> 00:17:22,079
our adversary if he's if he or she is

512
00:17:22,079 --> 00:17:24,000
there they've been there for a while

513
00:17:24,000 --> 00:17:26,240
right they know they're aware

514
00:17:26,240 --> 00:17:29,760
so we change we modify and we adapt

515
00:17:29,760 --> 00:17:32,400
right

516
00:17:32,400 --> 00:17:34,320
now change frequently and i know what

517
00:17:34,320 --> 00:17:35,520
you're thinking

518
00:17:35,520 --> 00:17:37,440
i know what nist says

519
00:17:37,440 --> 00:17:39,440
about steve changing his password is not

520
00:17:39,440 --> 00:17:41,360
great practice but we're not telling

521
00:17:41,360 --> 00:17:43,039
steve to change his password we're

522
00:17:43,039 --> 00:17:45,600
looking at it from a organizational and

523
00:17:45,600 --> 00:17:48,080
a team perspective right

524
00:17:48,080 --> 00:17:49,440
so regularly updating local

525
00:17:49,440 --> 00:17:50,799
administrator and global service account

526
00:17:50,799 --> 00:17:52,960
passwords cool and then rolling

527
00:17:52,960 --> 00:17:55,600
regularly roll kerberos every 45 days

528
00:17:55,600 --> 00:17:57,760
and like these are simple

529
00:17:57,760 --> 00:17:59,679
we know that the golden and silver

530
00:17:59,679 --> 00:18:01,039
tickets are going to exist we have

531
00:18:01,039 --> 00:18:03,520
integrated systems that are legacy that

532
00:18:03,520 --> 00:18:06,480
aren't necessarily

533
00:18:06,559 --> 00:18:08,320
very uh

534
00:18:08,320 --> 00:18:09,760
the question hasn't really been answered

535
00:18:09,760 --> 00:18:10,799
right for those systems because we

536
00:18:10,799 --> 00:18:12,240
haven't integrated them into our new

537
00:18:12,240 --> 00:18:13,600
features

538
00:18:13,600 --> 00:18:15,120
but we don't have the team that

539
00:18:15,120 --> 00:18:16,880
understands the legacy systems and their

540
00:18:16,880 --> 00:18:18,960
integration right so we need to

541
00:18:18,960 --> 00:18:21,120
understand that you know just like

542
00:18:21,120 --> 00:18:22,880
certain viruses and diseases they're

543
00:18:22,880 --> 00:18:24,720
going to come back right so for not

544
00:18:24,720 --> 00:18:26,480
paying attention to them in part making

545
00:18:26,480 --> 00:18:28,480
making simple solutions a part of our

546
00:18:28,480 --> 00:18:30,640
day-to-day in our process

547
00:18:30,640 --> 00:18:32,480
then the the argument can be made that

548
00:18:32,480 --> 00:18:34,400
it's going to be leveraged we need to go

549
00:18:34,400 --> 00:18:36,559
back it's just an example of going back

550
00:18:36,559 --> 00:18:38,880
and understanding what was relevant

551
00:18:38,880 --> 00:18:40,960
what are we seeing and how can we defend

552
00:18:40,960 --> 00:18:42,160
against it when it becomes relevant

553
00:18:42,160 --> 00:18:43,039
again

554
00:18:43,039 --> 00:18:44,559
right it's iterative

555
00:18:44,559 --> 00:18:45,760
and we should be able to understand and

556
00:18:45,760 --> 00:18:47,440
document those things and build them up

557
00:18:47,440 --> 00:18:49,280
over time

558
00:18:49,280 --> 00:18:50,960
now the big picture seam data

559
00:18:50,960 --> 00:18:52,320
integration

560
00:18:52,320 --> 00:18:54,400
we're ingesting data into our seam

561
00:18:54,400 --> 00:18:55,919
solution all the time

562
00:18:55,919 --> 00:18:57,200
all the time

563
00:18:57,200 --> 00:18:57,919
but

564
00:18:57,919 --> 00:19:01,600
what i what i haven't seen in in my job

565
00:19:01,600 --> 00:19:03,679
uh was we weren't integrating the it

566
00:19:03,679 --> 00:19:06,720
team solutions or the the local defender

567
00:19:06,720 --> 00:19:08,960
solutions into these data sets

568
00:19:08,960 --> 00:19:10,480
we were saying oh

569
00:19:10,480 --> 00:19:12,480
they're doing whatever they're doing

570
00:19:12,480 --> 00:19:14,240
we're doing script block logging but are

571
00:19:14,240 --> 00:19:16,559
we looking at what it is are they signed

572
00:19:16,559 --> 00:19:18,320
and if not why aren't they how do we

573
00:19:18,320 --> 00:19:20,320
define those things and integrate them

574
00:19:20,320 --> 00:19:21,840
into the seams so that we can then do

575
00:19:21,840 --> 00:19:23,840
checks and balances on ourselves so that

576
00:19:23,840 --> 00:19:26,880
those that do have access to that splunk

577
00:19:26,880 --> 00:19:28,559
enterprise solution

578
00:19:28,559 --> 00:19:30,640
when they get access to that admin do

579
00:19:30,640 --> 00:19:33,120
they not have access to splunk as well

580
00:19:33,120 --> 00:19:34,799
right how can we understand that how can

581
00:19:34,799 --> 00:19:36,160
we audit that we need to provide those

582
00:19:36,160 --> 00:19:38,799
solutions into what we do

583
00:19:38,799 --> 00:19:40,880
or i would say we are

584
00:19:40,880 --> 00:19:43,120
the problem we're advising but we're not

585
00:19:43,120 --> 00:19:44,880
checking ourselves towards that

586
00:19:44,880 --> 00:19:46,720
advisement that we're making right we're

587
00:19:46,720 --> 00:19:49,520
like oh hr is doing something weird but

588
00:19:49,520 --> 00:19:50,720
maybe sometimes we're doing something

589
00:19:50,720 --> 00:19:52,000
weird too and we need to be aware of

590
00:19:52,000 --> 00:19:52,799
that

591
00:19:52,799 --> 00:19:55,039
now as i said the leveraging peers for

592
00:19:55,039 --> 00:19:57,280
trust relationships

593
00:19:57,280 --> 00:19:59,280
so hear me out right

594
00:19:59,280 --> 00:20:02,080
bloodhound is a fantastic tool

595
00:20:02,080 --> 00:20:03,520
at the end of all these things you

596
00:20:03,520 --> 00:20:05,360
understand what the adversary is trying

597
00:20:05,360 --> 00:20:07,520
to do you know even going back to the

598
00:20:07,520 --> 00:20:08,960
principles that work from home you

599
00:20:08,960 --> 00:20:10,640
defined it all you have admins running

600
00:20:10,640 --> 00:20:12,240
everywhere you have users accessing

601
00:20:12,240 --> 00:20:14,000
things you have sessions existing here

602
00:20:14,000 --> 00:20:16,159
and there you have all this stuff

603
00:20:16,159 --> 00:20:17,280
happening

604
00:20:17,280 --> 00:20:18,559
but how do you provide somebody that's

605
00:20:18,559 --> 00:20:21,200
so what right i can tell you all day

606
00:20:21,200 --> 00:20:23,120
there's microsoft has a bunch of scripts

607
00:20:23,120 --> 00:20:24,880
that'll remotely query my active

608
00:20:24,880 --> 00:20:26,880
directory pull down these relationships

609
00:20:26,880 --> 00:20:30,080
and map them out for me

610
00:20:30,240 --> 00:20:31,760
that's a lot it's a lot to digest and a

611
00:20:31,760 --> 00:20:33,679
lot to manage right

612
00:20:33,679 --> 00:20:36,159
so i would argue using bloodhound

613
00:20:36,159 --> 00:20:37,840
is one of the best ways to graphically

614
00:20:37,840 --> 00:20:39,760
represent those trust relationships the

615
00:20:39,760 --> 00:20:41,520
interactions on your enterprise and

616
00:20:41,520 --> 00:20:42,559
there's a lot of functionality and

617
00:20:42,559 --> 00:20:44,240
modularity to cater to what you're

618
00:20:44,240 --> 00:20:46,159
trying to accomplish because you may not

619
00:20:46,159 --> 00:20:48,480
be responsible for the entirety of your

620
00:20:48,480 --> 00:20:49,600
enterprise

621
00:20:49,600 --> 00:20:51,120
but for the areas that you are

622
00:20:51,120 --> 00:20:53,600
responsible for to provide that so what

623
00:20:53,600 --> 00:20:55,520
to somebody to get their buy-in not just

624
00:20:55,520 --> 00:20:56,960
being like well we could just buy

625
00:20:56,960 --> 00:20:58,799
something right and cut you out and then

626
00:20:58,799 --> 00:21:00,000
you have to learn that new tool or

627
00:21:00,000 --> 00:21:01,919
resource no you should be the ones

628
00:21:01,919 --> 00:21:03,919
providing that so what to your leaders

629
00:21:03,919 --> 00:21:06,159
and managing that so what right

630
00:21:06,159 --> 00:21:08,880
presenting it so hey we have a person

631
00:21:08,880 --> 00:21:10,080
over here that we didn't account for

632
00:21:10,080 --> 00:21:11,679
they had 13 sessions what we did was we

633
00:21:11,679 --> 00:21:13,600
managed that and now the adversary has

634
00:21:13,600 --> 00:21:15,360
to choose a different path

635
00:21:15,360 --> 00:21:17,679
not quite defined every time but at

636
00:21:17,679 --> 00:21:19,280
least we know where we are putting

637
00:21:19,280 --> 00:21:20,799
roadblocks and we're applying the

638
00:21:20,799 --> 00:21:22,000
quagmire

639
00:21:22,000 --> 00:21:24,240
right

640
00:21:24,640 --> 00:21:26,320
pass it over

641
00:21:26,320 --> 00:21:29,039
all right so again it's about intent so

642
00:21:29,039 --> 00:21:31,280
an attacker wants to use the trusted

643
00:21:31,280 --> 00:21:33,280
relationships not because of where it

644
00:21:33,280 --> 00:21:34,640
lands them but because of where they can

645
00:21:34,640 --> 00:21:35,440
go

646
00:21:35,440 --> 00:21:36,960
they want to deploy the crypto miner

647
00:21:36,960 --> 00:21:38,640
they want to deploy the ransomware

648
00:21:38,640 --> 00:21:40,799
throughout the entirety of the network

649
00:21:40,799 --> 00:21:43,760
so how do we proactively visualize where

650
00:21:43,760 --> 00:21:45,120
they could go

651
00:21:45,120 --> 00:21:47,159
and it's about again

652
00:21:47,159 --> 00:21:50,080
a couple slides back we had the model of

653
00:21:50,080 --> 00:21:51,919
do you know where your critical assets

654
00:21:51,919 --> 00:21:53,600
and critical systems are

655
00:21:53,600 --> 00:21:56,240
if you don't bloodhound is one mechanism

656
00:21:56,240 --> 00:21:58,159
that can provide you a way to visualize

657
00:21:58,159 --> 00:21:58,960
that

658
00:21:58,960 --> 00:22:00,080
but also

659
00:22:00,080 --> 00:22:02,080
you know where are the noisy systems

660
00:22:02,080 --> 00:22:03,840
what are the systems that are talking

661
00:22:03,840 --> 00:22:05,919
you know with you know 10 000 open

662
00:22:05,919 --> 00:22:08,320
connections running ad admin

663
00:22:08,320 --> 00:22:10,799
why are you doing that like

664
00:22:10,799 --> 00:22:12,320
do we know this or was this some you

665
00:22:12,320 --> 00:22:13,600
know admin that was just trying to

666
00:22:13,600 --> 00:22:14,880
automate their job so they can drink

667
00:22:14,880 --> 00:22:17,120
coffee and play video games all day

668
00:22:17,120 --> 00:22:19,600
and you know from that you know to have

669
00:22:19,600 --> 00:22:21,440
the the data

670
00:22:21,440 --> 00:22:23,039
presented from bloodhound actually

671
00:22:23,039 --> 00:22:24,720
presents a heat map where you can

672
00:22:24,720 --> 00:22:26,880
quantifiably say where your critical

673
00:22:26,880 --> 00:22:28,720
systems critical connections are and

674
00:22:28,720 --> 00:22:30,559
actually do like an exploit control flow

675
00:22:30,559 --> 00:22:33,200
graph of you know upon here they could

676
00:22:33,200 --> 00:22:35,120
enumerate here here and here based off

677
00:22:35,120 --> 00:22:37,280
of the existing trusted relationships so

678
00:22:37,280 --> 00:22:40,000
again the sludge this lock to actually

679
00:22:40,000 --> 00:22:41,600
incorporate barriers along that way to

680
00:22:41,600 --> 00:22:44,000
make it as slow as possible

681
00:22:44,000 --> 00:22:47,039
so in a smaller environment this becomes

682
00:22:47,039 --> 00:22:49,360
doable when you have these massive

683
00:22:49,360 --> 00:22:51,200
enterprises that span multiple states

684
00:22:51,200 --> 00:22:53,200
multiple countries and you're dealing in

685
00:22:53,200 --> 00:22:55,520
petabytes of data and dating

686
00:22:55,520 --> 00:22:57,360
how do you do this it becomes really

687
00:22:57,360 --> 00:22:58,799
enticing to start

688
00:22:58,799 --> 00:23:01,440
you know investing in aiml solutions

689
00:23:01,440 --> 00:23:04,240
that can you know automatically reason

690
00:23:04,240 --> 00:23:06,559
based off of some ground truth what is

691
00:23:06,559 --> 00:23:08,840
benign and what is malicious

692
00:23:08,840 --> 00:23:10,559
[Music]

693
00:23:10,559 --> 00:23:12,080
so you're not going to be safe just

694
00:23:12,080 --> 00:23:14,080
because you're using next-gen solutions

695
00:23:14,080 --> 00:23:14,960
right

696
00:23:14,960 --> 00:23:17,039
so at its core these are just one more

697
00:23:17,039 --> 00:23:19,760
appliance that could potentially be a

698
00:23:19,760 --> 00:23:22,480
point of vulnerability an rce and your

699
00:23:22,480 --> 00:23:24,799
aiml solution

700
00:23:24,799 --> 00:23:26,880
presents the attacker an opportunity to

701
00:23:26,880 --> 00:23:28,480
change the ground truth

702
00:23:28,480 --> 00:23:31,360
to say what is benign what is and stuff

703
00:23:31,360 --> 00:23:33,520
leave right on through

704
00:23:33,520 --> 00:23:35,919
but let's assume your appliance is never

705
00:23:35,919 --> 00:23:37,600
going to be exploited that it's going to

706
00:23:37,600 --> 00:23:39,520
be perfect all along

707
00:23:39,520 --> 00:23:41,279
there are other ways an attacker can

708
00:23:41,279 --> 00:23:43,520
influence the classification of the data

709
00:23:43,520 --> 00:23:45,120
it's looking at and it's a field of

710
00:23:45,120 --> 00:23:46,400
study called adversarial machine

711
00:23:46,400 --> 00:23:48,480
learning so let's talk about false

712
00:23:48,480 --> 00:23:50,159
negatives first this is where an

713
00:23:50,159 --> 00:23:52,960
attacker wants to slide in undetected

714
00:23:52,960 --> 00:23:55,039
so what it can do is actually find a

715
00:23:55,039 --> 00:23:57,200
benign file benign

716
00:23:57,200 --> 00:23:58,480
artifact

717
00:23:58,480 --> 00:24:00,960
and to start inducing changes on that

718
00:24:00,960 --> 00:24:03,600
file and just introduce it to the

719
00:24:03,600 --> 00:24:06,720
ml solution like hey this is fine and so

720
00:24:06,720 --> 00:24:09,120
slowly nudge it down

721
00:24:09,120 --> 00:24:11,360
to the actually full on weaponization of

722
00:24:11,360 --> 00:24:13,440
that file where it is the exploit it is

723
00:24:13,440 --> 00:24:15,919
the inject into the environment but

724
00:24:15,919 --> 00:24:18,159
because the aiml solution has seen it

725
00:24:18,159 --> 00:24:20,320
thousands and millions of times it has

726
00:24:20,320 --> 00:24:21,600
been trained

727
00:24:21,600 --> 00:24:24,000
to say that this is okay i've seen this

728
00:24:24,000 --> 00:24:25,279
a million times it's just bob from

729
00:24:25,279 --> 00:24:27,440
accounting let them on in

730
00:24:27,440 --> 00:24:29,039
and that's how you actually train those

731
00:24:29,039 --> 00:24:31,039
classifiers to let benign things in

732
00:24:31,039 --> 00:24:32,640
without it flagging

733
00:24:32,640 --> 00:24:35,120
now let's talk about the the noise the

734
00:24:35,120 --> 00:24:36,960
false positives this is where an

735
00:24:36,960 --> 00:24:38,799
attacker wants you to lose confidence in

736
00:24:38,799 --> 00:24:40,799
your solutions that you have alert

737
00:24:40,799 --> 00:24:42,480
saturation where it's like oh this damn

738
00:24:42,480 --> 00:24:44,960
thing doesn't work i don't believe in it

739
00:24:44,960 --> 00:24:46,720
it's because they've done things like

740
00:24:46,720 --> 00:24:48,880
you know behaviors on startup are now

741
00:24:48,880 --> 00:24:50,960
being flagged as malicious

742
00:24:50,960 --> 00:24:52,480
default windows

743
00:24:52,480 --> 00:24:54,080
system files are now automatically

744
00:24:54,080 --> 00:24:56,080
popping up across the entire environment

745
00:24:56,080 --> 00:24:57,760
as a malicious

746
00:24:57,760 --> 00:24:59,760
the admin now loses confidence in the

747
00:24:59,760 --> 00:25:02,080
appliance that allows then the attacker

748
00:25:02,080 --> 00:25:04,320
to slide in through the noise that we

749
00:25:04,320 --> 00:25:06,080
now know that we're generating 10 000

750
00:25:06,080 --> 00:25:08,559
alerts a day no one's looking at it the

751
00:25:08,559 --> 00:25:10,400
logs are rolling you know they only have

752
00:25:10,400 --> 00:25:13,279
a retention of 1000 logs chances are no

753
00:25:13,279 --> 00:25:14,960
one's going to see me come in

754
00:25:14,960 --> 00:25:17,200
and these are the type of you know

755
00:25:17,200 --> 00:25:18,320
aiml

756
00:25:18,320 --> 00:25:19,919
could be a value added to your

757
00:25:19,919 --> 00:25:21,520
environment but you seem to understand

758
00:25:21,520 --> 00:25:24,559
the implications they're in

759
00:25:24,559 --> 00:25:26,720
all right so throughout this talk we've

760
00:25:26,720 --> 00:25:28,799
talked a number of things that you could

761
00:25:28,799 --> 00:25:30,960
do to assume that the most trusted

762
00:25:30,960 --> 00:25:32,880
security solutions in your environment

763
00:25:32,880 --> 00:25:34,240
may potentially be the point of

764
00:25:34,240 --> 00:25:36,240
vulnerability and because of the trusted

765
00:25:36,240 --> 00:25:37,520
relationships

766
00:25:37,520 --> 00:25:39,679
someone's going to abuse it to own your

767
00:25:39,679 --> 00:25:41,200
entire network

768
00:25:41,200 --> 00:25:42,720
we have a list of things that we can

769
00:25:42,720 --> 00:25:45,360
provide you uh both online and in a

770
00:25:45,360 --> 00:25:47,279
hidden hidden slide

771
00:25:47,279 --> 00:25:48,640
that are some references that you can

772
00:25:48,640 --> 00:25:50,240
you know look at what makes sense to

773
00:25:50,240 --> 00:25:52,880
your organization but again it's not

774
00:25:52,880 --> 00:25:54,799
about you know one solution fixing

775
00:25:54,799 --> 00:25:56,400
everything it is iterative it is

776
00:25:56,400 --> 00:25:58,240
understanding the implications

777
00:25:58,240 --> 00:26:01,200
of your actions and assuming that you

778
00:26:01,200 --> 00:26:03,760
know no good deed goes unpunished that

779
00:26:03,760 --> 00:26:06,240
someone's going to exploit your signed

780
00:26:06,240 --> 00:26:08,559
script policy someone's going to exploit

781
00:26:08,559 --> 00:26:10,880
your ml solution

782
00:26:10,880 --> 00:26:13,279
always wear your red team hat even as a

783
00:26:13,279 --> 00:26:15,039
defender and assume

784
00:26:15,039 --> 00:26:16,880
something will go wrong

785
00:26:16,880 --> 00:26:19,039
so with that uh we can take uh any

786
00:26:19,039 --> 00:26:21,760
questions comments concerns uh we like

787
00:26:21,760 --> 00:26:24,320
said we do have uh some resources and

788
00:26:24,320 --> 00:26:26,480
matt has about another five pages uh

789
00:26:26,480 --> 00:26:28,960
that we'll add on uh in the twitter

790
00:26:28,960 --> 00:26:31,120
version that we upload later so please

791
00:26:31,120 --> 00:26:32,799
uh

792
00:26:32,799 --> 00:26:35,039
also this is uh matt's first infosec

793
00:26:35,039 --> 00:26:36,080
conference

794
00:26:36,080 --> 00:26:39,760
so uh if we give him a little uh

795
00:26:43,279 --> 00:26:45,600
but yeah uh any questions uh y'all want

796
00:26:45,600 --> 00:26:47,360
to do we can do that and then uh if

797
00:26:47,360 --> 00:26:49,200
there are no public questions we can uh

798
00:26:49,200 --> 00:26:51,279
stand on the side uh it's in about half

799
00:26:51,279 --> 00:26:53,679
an hour before the next one kicks off so

800
00:26:53,679 --> 00:26:56,320
any questions

801
00:26:56,960 --> 00:26:59,279
please

802
00:27:00,030 --> 00:27:03,609
[Music]

803
00:27:04,240 --> 00:27:06,080
uh so is the next talk gonna be about

804
00:27:06,080 --> 00:27:08,480
absolute machine learning so uh about

805
00:27:08,480 --> 00:27:10,720
2015 i wrote a paper on

806
00:27:10,720 --> 00:27:13,039
the implications they're in uh not uh

807
00:27:13,039 --> 00:27:14,110
it's called uh

808
00:27:14,110 --> 00:27:15,520
[Music]

809
00:27:15,520 --> 00:27:18,880
summoning demons uh so it's online uh

810
00:27:18,880 --> 00:27:21,600
where you know it's actually within uh

811
00:27:21,600 --> 00:27:23,760
your trusted solution and it talks about

812
00:27:23,760 --> 00:27:27,440
a number of threat models like uh

813
00:27:27,440 --> 00:27:30,080
passing floats and doubles

814
00:27:30,080 --> 00:27:32,640
causing uh enough

815
00:27:32,640 --> 00:27:35,520
uh loss of confidence that you actually

816
00:27:35,520 --> 00:27:37,520
sway a classifier if you're not

817
00:27:37,520 --> 00:27:39,520
programming uh safely to actually

818
00:27:39,520 --> 00:27:40,640
account for

819
00:27:40,640 --> 00:27:42,480
uh additional decimal spots things like

820
00:27:42,480 --> 00:27:44,480
that uh but yeah so so many demons is a

821
00:27:44,480 --> 00:27:46,159
paper that you can check out on more of

822
00:27:46,159 --> 00:27:48,159
that topic and again there's about a

823
00:27:48,159 --> 00:27:50,080
million other papers in the field that

824
00:27:50,080 --> 00:27:52,159
can talk to you more about you know ways

825
00:27:52,159 --> 00:27:52,960
that

826
00:27:52,960 --> 00:27:54,799
you can abuse the oracle abuse the

827
00:27:54,799 --> 00:27:56,320
classifier

828
00:27:56,320 --> 00:27:59,520
to do bad things

829
00:28:00,480 --> 00:28:01,440
any other

830
00:28:01,440 --> 00:28:03,840
questions

831
00:28:06,240 --> 00:28:08,000
please so

832
00:28:08,000 --> 00:28:09,760
i guess um

833
00:28:09,760 --> 00:28:11,760
one of the things that i was wondering

834
00:28:11,760 --> 00:28:13,900
about during the thoughts was

835
00:28:13,900 --> 00:28:16,240
[Music]

836
00:28:16,240 --> 00:28:18,000
i guess i don't give any guidance as far

837
00:28:18,000 --> 00:28:18,799
as

838
00:28:18,799 --> 00:28:21,760
how you go about not

839
00:28:21,760 --> 00:28:24,399
rebuilding from scratch yeah like how do

840
00:28:24,399 --> 00:28:26,159
you go about improving what you have so

841
00:28:26,159 --> 00:28:27,840
yeah so i'm let matt take this one we

842
00:28:27,840 --> 00:28:29,279
did about a two hour conversation last

843
00:28:29,279 --> 00:28:30,640
night about this and so to repeat the

844
00:28:30,640 --> 00:28:33,279
question uh so some of these things are

845
00:28:33,279 --> 00:28:34,799
going to break your environment or could

846
00:28:34,799 --> 00:28:36,799
potentially break your environment or

847
00:28:36,799 --> 00:28:38,320
like hey you know at some point when do

848
00:28:38,320 --> 00:28:39,840
you need to nuke the entire network and

849
00:28:39,840 --> 00:28:44,159
just start from scratch so matt

850
00:28:44,159 --> 00:28:46,640
in in what i've uh done throughout my

851
00:28:46,640 --> 00:28:48,399
career as i advise and understand these

852
00:28:48,399 --> 00:28:51,840
networks and see that the solutions that

853
00:28:51,840 --> 00:28:54,080
we would want to provide

854
00:28:54,080 --> 00:28:56,399
are never so burdensome to the the

855
00:28:56,399 --> 00:28:58,559
customer right the local defenders that

856
00:28:58,559 --> 00:29:00,000
they can't functionally do their job and

857
00:29:00,000 --> 00:29:01,360
you have to rebuild the environment

858
00:29:01,360 --> 00:29:02,880
right the

859
00:29:02,880 --> 00:29:05,840
the solutions

860
00:29:06,159 --> 00:29:07,600
are aggressive

861
00:29:07,600 --> 00:29:09,679
taking measured steps between each one

862
00:29:09,679 --> 00:29:12,159
to but first identifying why you're

863
00:29:12,159 --> 00:29:14,080
there what you're doing what the real

864
00:29:14,080 --> 00:29:16,159
question is the work from home model is

865
00:29:16,159 --> 00:29:18,159
is a great example right i didn't have

866
00:29:18,159 --> 00:29:19,840
to nuke even though they wanted to like

867
00:29:19,840 --> 00:29:21,520
the question was do we just have to move

868
00:29:21,520 --> 00:29:23,279
everybody back in like do we have to

869
00:29:23,279 --> 00:29:24,880
bring them back in for the on-prem like

870
00:29:24,880 --> 00:29:27,360
it's like no like you're assuming a lot

871
00:29:27,360 --> 00:29:30,240
of risk sure but somebody is managing

872
00:29:30,240 --> 00:29:31,760
and assessing where that risk is where's

873
00:29:31,760 --> 00:29:33,679
that documentation and the answer is no

874
00:29:33,679 --> 00:29:35,840
there's no documentation okay so let's

875
00:29:35,840 --> 00:29:37,840
define what that is right you're trying

876
00:29:37,840 --> 00:29:40,480
to just enable people to get in right

877
00:29:40,480 --> 00:29:42,159
and you're understanding as we go

878
00:29:42,159 --> 00:29:45,120
through modeling where those faults are

879
00:29:45,120 --> 00:29:47,279
then you can take measured steps to

880
00:29:47,279 --> 00:29:48,320
defend against like just enough

881
00:29:48,320 --> 00:29:49,440
administration

882
00:29:49,440 --> 00:29:51,760
it is gonna break some stuff initially

883
00:29:51,760 --> 00:29:53,200
it's gonna happen

884
00:29:53,200 --> 00:29:54,720
because you're you're defining if you

885
00:29:54,720 --> 00:29:56,559
don't put the right commandlets in there

886
00:29:56,559 --> 00:29:58,480
it's going to deny all commandlets

887
00:29:58,480 --> 00:30:00,960
explicitly so you use nothing

888
00:30:00,960 --> 00:30:02,960
but if you pick and discern what you're

889
00:30:02,960 --> 00:30:04,559
trying to accomplish and take a measured

890
00:30:04,559 --> 00:30:07,360
step through it involve your it teams

891
00:30:07,360 --> 00:30:08,640
involve your administrators and your

892
00:30:08,640 --> 00:30:10,480
local defenders those answers are easy

893
00:30:10,480 --> 00:30:11,679
to overcome that you don't have to

894
00:30:11,679 --> 00:30:13,200
rebuild it because sometimes what

895
00:30:13,200 --> 00:30:15,039
they're saying to you is hey we're just

896
00:30:15,039 --> 00:30:16,799
we're using these microsoft scripts to

897
00:30:16,799 --> 00:30:18,640
do x y and z but this is a functionality

898
00:30:18,640 --> 00:30:20,080
we need with them not the whole thing

899
00:30:20,080 --> 00:30:22,080
here's the variables that we pass in we

900
00:30:22,080 --> 00:30:23,919
can define those variables right we can

901
00:30:23,919 --> 00:30:25,440
define the axis and the means and the

902
00:30:25,440 --> 00:30:26,960
approach that they have they're all

903
00:30:26,960 --> 00:30:28,320
using one jump box that's the only one

904
00:30:28,320 --> 00:30:29,600
they're aware of well that's a failure

905
00:30:29,600 --> 00:30:32,159
on our part to inform them right

906
00:30:32,159 --> 00:30:34,080
the only time it ever becomes a nuclear

907
00:30:34,080 --> 00:30:36,399
problem is when we've defined as we're

908
00:30:36,399 --> 00:30:37,520
going through it they had an incident

909
00:30:37,520 --> 00:30:39,600
response a year ago and they said that

910
00:30:39,600 --> 00:30:41,360
they cleared it because they used this

911
00:30:41,360 --> 00:30:44,320
measure to get in like like proxy log on

912
00:30:44,320 --> 00:30:46,159
they got in but they cleared it and it

913
00:30:46,159 --> 00:30:47,679
wasn't actually a true clear and then

914
00:30:47,679 --> 00:30:48,880
they built more infrastructure on the

915
00:30:48,880 --> 00:30:51,279
backbone of it and it's like well they

916
00:30:51,279 --> 00:30:53,440
logically obliterated your trust

917
00:30:53,440 --> 00:30:54,960
relationships and are everywhere they're

918
00:30:54,960 --> 00:30:56,480
not really they're to be not trusted

919
00:30:56,480 --> 00:30:58,720
anymore right then you can talk about

920
00:30:58,720 --> 00:31:00,399
principles of rebuilding but it's

921
00:31:00,399 --> 00:31:02,480
usually not that aggressive and it's

922
00:31:02,480 --> 00:31:04,240
usually just providing the little

923
00:31:04,240 --> 00:31:06,240
measured steps one at a time it's not an

924
00:31:06,240 --> 00:31:08,000
overnight solution

925
00:31:08,000 --> 00:31:10,480
it is a stepped solution with decision

926
00:31:10,480 --> 00:31:12,799
points throughout that we have to i mean

927
00:31:12,799 --> 00:31:14,720
the previous talk said it great like we

928
00:31:14,720 --> 00:31:16,080
don't in

929
00:31:16,080 --> 00:31:18,320
enable people to provide those those

930
00:31:18,320 --> 00:31:20,320
decision points for us and the guidance

931
00:31:20,320 --> 00:31:22,159
because they're working the mission

932
00:31:22,159 --> 00:31:23,840
if you enroll them in it you never you

933
00:31:23,840 --> 00:31:25,600
generally i don't say never but you

934
00:31:25,600 --> 00:31:27,200
generally don't have to nuke whatever

935
00:31:27,200 --> 00:31:28,799
solution they provided

936
00:31:28,799 --> 00:31:30,559
you can advise them and assume risk in

937
00:31:30,559 --> 00:31:32,480
certain areas and then they can enhance

938
00:31:32,480 --> 00:31:33,679
it over time

939
00:31:33,679 --> 00:31:34,880
and that's really what the the

940
00:31:34,880 --> 00:31:36,799
principles are for

941
00:31:36,799 --> 00:31:38,720
um and then managing your semen and

942
00:31:38,720 --> 00:31:40,720
allowing people to uh to take measured

943
00:31:40,720 --> 00:31:42,399
steps for them protect for their

944
00:31:42,399 --> 00:31:44,080
protection

945
00:31:44,080 --> 00:31:47,840
anybody else have any other questions

946
00:31:49,279 --> 00:31:50,480
great

947
00:31:50,480 --> 00:31:55,640
all right we'll be over here thanks

