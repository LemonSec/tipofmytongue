1
00:00:00,399 --> 00:00:02,320
all right good afternoon welcome to

2
00:00:02,320 --> 00:00:05,600
b-sides las vegas ground truth

3
00:00:05,600 --> 00:00:07,600
this talk is attack flow from data

4
00:00:07,600 --> 00:00:09,519
points to data paths

5
00:00:09,519 --> 00:00:11,759
by gabriel bassett

6
00:00:11,759 --> 00:00:14,400
um a few announcements before we begin

7
00:00:14,400 --> 00:00:16,000
we'd like to thank our sponsors

8
00:00:16,000 --> 00:00:19,199
especially our diamond sponsors lastpass

9
00:00:19,199 --> 00:00:21,199
and palo alto networks and our gold

10
00:00:21,199 --> 00:00:24,480
sponsors amazon plex track and blue cat

11
00:00:24,480 --> 00:00:26,320
it is their support along with our other

12
00:00:26,320 --> 00:00:28,640
sponsors donors and volunteers that make

13
00:00:28,640 --> 00:00:30,960
this event possible these talks are

14
00:00:30,960 --> 00:00:32,800
being streamed live except of course in

15
00:00:32,800 --> 00:00:35,040
underground and as a courtesy to our

16
00:00:35,040 --> 00:00:36,800
speakers and audience we ask that you

17
00:00:36,800 --> 00:00:38,239
make sure that your cell phones are set

18
00:00:38,239 --> 00:00:39,520
to silent

19
00:00:39,520 --> 00:00:41,600
um questions will be at the end if you

20
00:00:41,600 --> 00:00:43,040
have a question use the audience

21
00:00:43,040 --> 00:00:45,120
microphone so youtube can hear you i am

22
00:00:45,120 --> 00:00:46,640
holding that mic i will put it back on

23
00:00:46,640 --> 00:00:49,120
the stand in the middle of the room

24
00:00:49,120 --> 00:00:51,760
uh as a reminder the b-sides lv photo

25
00:00:51,760 --> 00:00:54,000
policy prohibits taking pictures without

26
00:00:54,000 --> 00:00:56,239
the explicit permission of everyone in

27
00:00:56,239 --> 00:00:57,199
frame

28
00:00:57,199 --> 00:00:59,359
all the talks are being recorded again

29
00:00:59,359 --> 00:01:01,199
except in underground and will be

30
00:01:01,199 --> 00:01:03,199
available on youtube in the future

31
00:01:03,199 --> 00:01:06,000
please keep your masks on at all times

32
00:01:06,000 --> 00:01:08,320
uh if you want to hear better see better

33
00:01:08,320 --> 00:01:10,240
feel free to move closer to the center

34
00:01:10,240 --> 00:01:11,920
and front of the room keeping social

35
00:01:11,920 --> 00:01:13,760
distancing in mind

36
00:01:13,760 --> 00:01:16,320
um with that let's get started please

37
00:01:16,320 --> 00:01:19,600
welcome gabriel bassett

38
00:01:21,600 --> 00:01:23,040
it's good that we get the clapping in

39
00:01:23,040 --> 00:01:24,400
now because you don't know what i'm

40
00:01:24,400 --> 00:01:26,000
going to say and if it goes bad at least

41
00:01:26,000 --> 00:01:27,439
i've gotten one clap for the

42
00:01:27,439 --> 00:01:28,640
presentation

43
00:01:28,640 --> 00:01:30,880
so i'm gabriel bassett um

44
00:01:30,880 --> 00:01:32,320
we're going to talk about tag flows so

45
00:01:32,320 --> 00:01:33,600
we're going to do a quick introduction

46
00:01:33,600 --> 00:01:35,040
to it and then we're going to do this

47
00:01:35,040 --> 00:01:36,799
like in the data driven way right i'm

48
00:01:36,799 --> 00:01:38,159
going to show you a bunch of data

49
00:01:38,159 --> 00:01:39,680
particularly data we use in information

50
00:01:39,680 --> 00:01:41,200
security

51
00:01:41,200 --> 00:01:42,960
before like attack flow what it looks

52
00:01:42,960 --> 00:01:44,000
like now and then we're going to kind of

53
00:01:44,000 --> 00:01:45,840
walk through the process of taking data

54
00:01:45,840 --> 00:01:48,079
and turning it into attack flow

55
00:01:48,079 --> 00:01:50,159
and then we're going to look at the data

56
00:01:50,159 --> 00:01:52,240
structured as attack flows then we'll

57
00:01:52,240 --> 00:01:54,560
wrap things up a little bit and so

58
00:01:54,560 --> 00:01:56,079
who am i

59
00:01:56,079 --> 00:01:58,320
um this is me this is my twitter handle

60
00:01:58,320 --> 00:02:01,280
i have done a lot of graph things and i

61
00:02:01,280 --> 00:02:02,399
want to take a second to talk about

62
00:02:02,399 --> 00:02:04,079
where that comes from because i've been

63
00:02:04,079 --> 00:02:06,640
doing graph stuff for about 15 years now

64
00:02:06,640 --> 00:02:07,920
and it started when i was in the

65
00:02:07,920 --> 00:02:08,959
government

66
00:02:08,959 --> 00:02:11,038
um when i was in the government we were

67
00:02:11,038 --> 00:02:12,720
doing risk models right and so this is

68
00:02:12,720 --> 00:02:14,800
like way back because what we did is we

69
00:02:14,800 --> 00:02:16,800
came into our executive and we said hey

70
00:02:16,800 --> 00:02:18,720
we ran nessus and we showed the output

71
00:02:18,720 --> 00:02:22,080
of nessus all of the output analysis

72
00:02:22,080 --> 00:02:23,120
and

73
00:02:23,120 --> 00:02:24,800
it's a little too much and she said go

74
00:02:24,800 --> 00:02:27,440
back and find a better idea

75
00:02:27,440 --> 00:02:30,239
so we came back again and this time

76
00:02:30,239 --> 00:02:31,680
we group things we said this thing

77
00:02:31,680 --> 00:02:33,280
happened this high risk happened 100

78
00:02:33,280 --> 00:02:34,800
times

79
00:02:34,800 --> 00:02:37,599
this one happened 50 times and she goes

80
00:02:37,599 --> 00:02:39,200
that's great i i don't know what that

81
00:02:39,200 --> 00:02:42,400
means right like so what

82
00:02:42,400 --> 00:02:44,319
so okay we go back to the drawing board

83
00:02:44,319 --> 00:02:45,920
we come back we got like the five by

84
00:02:45,920 --> 00:02:48,480
five chart right that has impact uh

85
00:02:48,480 --> 00:02:50,319
likelihood and impact on it and it's got

86
00:02:50,319 --> 00:02:52,800
some red yellow and

87
00:02:52,800 --> 00:02:54,400
uh green areas

88
00:02:54,400 --> 00:02:55,440
and we go

89
00:02:55,440 --> 00:02:57,040
now we know this this wrist is right

90
00:02:57,040 --> 00:02:58,560
here

91
00:02:58,560 --> 00:02:59,440
right

92
00:02:59,440 --> 00:03:00,720
um

93
00:03:00,720 --> 00:03:02,159
the problem was we never could agree

94
00:03:02,159 --> 00:03:03,519
because it wasn't just like one person

95
00:03:03,519 --> 00:03:06,159
making this decision

96
00:03:06,159 --> 00:03:08,080
like i was representing the government i

97
00:03:08,080 --> 00:03:10,640
had a contractor doing the testing

98
00:03:10,640 --> 00:03:11,920
then there's the people that built the

99
00:03:11,920 --> 00:03:13,200
system

100
00:03:13,200 --> 00:03:15,360
and their government representative and

101
00:03:15,360 --> 00:03:17,840
we all disagreed and the problem was why

102
00:03:17,840 --> 00:03:19,680
do we disagree

103
00:03:19,680 --> 00:03:21,040
like why can't we all just get along

104
00:03:21,040 --> 00:03:22,319
well it turned out

105
00:03:22,319 --> 00:03:23,680
that it mattered on how you made

106
00:03:23,680 --> 00:03:26,000
assumptions like when my tester makes

107
00:03:26,000 --> 00:03:27,519
assumptions they would make the

108
00:03:27,519 --> 00:03:29,440
assumption of like hey here's the server

109
00:03:29,440 --> 00:03:31,040
the power button isn't like covered by a

110
00:03:31,040 --> 00:03:33,280
door or anything what if someone walked

111
00:03:33,280 --> 00:03:34,640
in and turned that off this is a really

112
00:03:34,640 --> 00:03:37,599
important server that's a high risk

113
00:03:37,599 --> 00:03:40,480
now understandably the other side of the

114
00:03:40,480 --> 00:03:42,400
government's contractor said

115
00:03:42,400 --> 00:03:43,360
yes

116
00:03:43,360 --> 00:03:44,159
but

117
00:03:44,159 --> 00:03:46,400
that server is inside of a room that has

118
00:03:46,400 --> 00:03:48,000
its own um

119
00:03:48,000 --> 00:03:49,599
access system and set of credentials

120
00:03:49,599 --> 00:03:51,599
it's locked down to like 20 people and

121
00:03:51,599 --> 00:03:53,280
that's inside of this portion of the

122
00:03:53,280 --> 00:03:55,200
building that is only locked down to the

123
00:03:55,200 --> 00:03:56,959
people who can get access to it which is

124
00:03:56,959 --> 00:03:58,400
inside of that half of the building

125
00:03:58,400 --> 00:04:00,319
which is locked down which is inside the

126
00:04:00,319 --> 00:04:02,400
building which has its own access which

127
00:04:02,400 --> 00:04:04,400
is inside the fenced area of the base

128
00:04:04,400 --> 00:04:07,120
which is inside the base and so really

129
00:04:07,120 --> 00:04:10,000
the threat over here is probably

130
00:04:10,000 --> 00:04:11,680
not what we're worried about we're

131
00:04:11,680 --> 00:04:12,799
worrying about the one out here and see

132
00:04:12,799 --> 00:04:16,320
the idea is there's a path here right

133
00:04:16,320 --> 00:04:18,478
the narrative for the threat outside the

134
00:04:18,478 --> 00:04:20,560
building was very different from the

135
00:04:20,560 --> 00:04:21,519
threat

136
00:04:21,519 --> 00:04:22,479
inside

137
00:04:22,479 --> 00:04:24,400
and so we realized or i realized hey we

138
00:04:24,400 --> 00:04:27,120
need to be writing that down

139
00:04:27,120 --> 00:04:29,120
and so i did what everyone does

140
00:04:29,120 --> 00:04:31,280
when they first start to do this

141
00:04:31,280 --> 00:04:32,720
they get an excel spreadsheet and they

142
00:04:32,720 --> 00:04:33,600
say

143
00:04:33,600 --> 00:04:35,440
what's a is a threat inside the building

144
00:04:35,440 --> 00:04:36,320
or not

145
00:04:36,320 --> 00:04:37,600
if you answer

146
00:04:37,600 --> 00:04:39,199
yes it's high

147
00:04:39,199 --> 00:04:41,440
or we add like you know 10 and if it's

148
00:04:41,440 --> 00:04:43,759
no we add 1. we come up with a bunch of

149
00:04:43,759 --> 00:04:45,759
questions like that and then we add them

150
00:04:45,759 --> 00:04:47,680
up and maybe we multiply it by some

151
00:04:47,680 --> 00:04:48,960
random number we came up with because

152
00:04:48,960 --> 00:04:50,479
then it looks prettier

153
00:04:50,479 --> 00:04:52,560
and then we say any number between this

154
00:04:52,560 --> 00:04:54,160
and this that's a high risk and you know

155
00:04:54,160 --> 00:04:55,600
these are the lows

156
00:04:55,600 --> 00:04:57,919
and that doesn't work and i apologize if

157
00:04:57,919 --> 00:04:58,960
anyone in the room is actually still

158
00:04:58,960 --> 00:05:00,560
doing this a lot of people do it's not

159
00:05:00,560 --> 00:05:01,600
just you

160
00:05:01,600 --> 00:05:02,880
um

161
00:05:02,880 --> 00:05:05,039
but the problem is people already know

162
00:05:05,039 --> 00:05:07,120
what they want the risk to be

163
00:05:07,120 --> 00:05:08,960
and after a few times using these kinds

164
00:05:08,960 --> 00:05:11,600
of tables they know how to get it out

165
00:05:11,600 --> 00:05:14,320
and so they come up with some narrative

166
00:05:14,320 --> 00:05:15,759
that fits their mental model for what

167
00:05:15,759 --> 00:05:16,960
that risk to be

168
00:05:16,960 --> 00:05:18,880
i want it to be high so i know i select

169
00:05:18,880 --> 00:05:21,919
this this and this thing to make it high

170
00:05:21,919 --> 00:05:23,600
and so now not only are you not getting

171
00:05:23,600 --> 00:05:24,800
the narrative you needed you're getting

172
00:05:24,800 --> 00:05:26,720
some false narrative and so

173
00:05:26,720 --> 00:05:28,880
i said well let's let's scrub that we'll

174
00:05:28,880 --> 00:05:30,639
go back to the pi by five but when you

175
00:05:30,639 --> 00:05:33,199
put that dot on that five by five matrix

176
00:05:33,199 --> 00:05:35,440
you're gonna have to shoot tell me why

177
00:05:35,440 --> 00:05:36,400
you're gonna have to write out a little

178
00:05:36,400 --> 00:05:37,840
paragraph that says i think the threat

179
00:05:37,840 --> 00:05:39,680
does this and then this thing happens

180
00:05:39,680 --> 00:05:41,199
and then this and then

181
00:05:41,199 --> 00:05:43,280
and when i realized we were writing out

182
00:05:43,280 --> 00:05:45,680
this is where i started to kind of

183
00:05:45,680 --> 00:05:47,759
get a little bit different from what

184
00:05:47,759 --> 00:05:50,400
we'd normally do today and

185
00:05:50,400 --> 00:05:51,600
we realized that what we're really

186
00:05:51,600 --> 00:05:54,479
documenting was this attack path right

187
00:05:54,479 --> 00:05:56,400
the attacker does this

188
00:05:56,400 --> 00:05:57,759
to this system

189
00:05:57,759 --> 00:05:59,919
they do this and it has this effect they

190
00:05:59,919 --> 00:06:02,560
do this it has this effect a sequence of

191
00:06:02,560 --> 00:06:05,360
things and so we started to build paths

192
00:06:05,360 --> 00:06:07,600
and that was actually really cool

193
00:06:07,600 --> 00:06:09,680
because once you start building path

194
00:06:09,680 --> 00:06:12,319
paths you start asking this question

195
00:06:12,319 --> 00:06:14,240
what does that mean in context it's cool

196
00:06:14,240 --> 00:06:17,120
if you've got one what if i have 10

197
00:06:17,120 --> 00:06:20,720
what if my 10 all include the same thing

198
00:06:20,720 --> 00:06:22,319
how can i combine those together and i

199
00:06:22,319 --> 00:06:24,080
remember this moment really clearly i'm

200
00:06:24,080 --> 00:06:24,960
kind of

201
00:06:24,960 --> 00:06:26,720
grappling with this idea it's the end of

202
00:06:26,720 --> 00:06:28,319
the day right everyone's kind of tired

203
00:06:28,319 --> 00:06:30,319
it's me and this one guy there left

204
00:06:30,319 --> 00:06:31,680
like i'm walking past this game he's

205
00:06:31,680 --> 00:06:32,720
like hey i know you've been working on

206
00:06:32,720 --> 00:06:34,639
that problem

207
00:06:34,639 --> 00:06:36,720
my company had this project a couple of

208
00:06:36,720 --> 00:06:38,000
years ago

209
00:06:38,000 --> 00:06:39,260
that involved

210
00:06:39,260 --> 00:06:40,479
[Music]

211
00:06:40,479 --> 00:06:42,400
these things called brass

212
00:06:42,400 --> 00:06:43,600
i'm like cool what's the graphic because

213
00:06:43,600 --> 00:06:46,000
i don't know

214
00:06:46,639 --> 00:06:49,199
like he had no clue but he he kind of he

215
00:06:49,199 --> 00:06:50,720
understood enough to know that it might

216
00:06:50,720 --> 00:06:52,479
apply in my situation so i go back home

217
00:06:52,479 --> 00:06:54,400
and i started searching for it

218
00:06:54,400 --> 00:06:56,639
and it turns out it's a really great

219
00:06:56,639 --> 00:06:57,759
solution by the way if you don't know

220
00:06:57,759 --> 00:06:58,639
what graphs are we're going to talk

221
00:06:58,639 --> 00:07:00,880
about that

222
00:07:00,960 --> 00:07:02,479
three sides

223
00:07:02,479 --> 00:07:05,360
um and so i go back and i build um

224
00:07:05,360 --> 00:07:06,960
bayesian inference networks in the back

225
00:07:06,960 --> 00:07:08,960
of an excel spreadsheet which sounds

226
00:07:08,960 --> 00:07:11,120
like a bad place to do that until you

227
00:07:11,120 --> 00:07:12,400
realize that i was in the government and

228
00:07:12,400 --> 00:07:13,840
they don't let you install things in the

229
00:07:13,840 --> 00:07:14,880
government

230
00:07:14,880 --> 00:07:16,240
and they really don't let you install

231
00:07:16,240 --> 00:07:17,440
programming languages because then you

232
00:07:17,440 --> 00:07:19,199
can run whatever you want

233
00:07:19,199 --> 00:07:21,360
but they do let you write visual basic

234
00:07:21,360 --> 00:07:23,310
because it comes with microsoft office

235
00:07:23,310 --> 00:07:25,680
[Music]

236
00:07:25,680 --> 00:07:27,919
and so that's where i built this and i

237
00:07:27,919 --> 00:07:30,319
left the government after a while i got

238
00:07:30,319 --> 00:07:31,919
a patent around graphs i wrote a bunch

239
00:07:31,919 --> 00:07:33,280
of blogs

240
00:07:33,280 --> 00:07:34,960
i published some stuff i've done a

241
00:07:34,960 --> 00:07:37,520
couple of talks and that brings us to

242
00:07:37,520 --> 00:07:39,440
today

243
00:07:39,440 --> 00:07:41,199
and so it's been clear for a long time

244
00:07:41,199 --> 00:07:44,000
that atomic information atomic infosec

245
00:07:44,000 --> 00:07:46,560
data is not cutting it

246
00:07:46,560 --> 00:07:48,479
right we need to be able to describe the

247
00:07:48,479 --> 00:07:51,199
paths and graphs that graphs

248
00:07:51,199 --> 00:07:53,120
attackers take you know flows so to

249
00:07:53,120 --> 00:07:54,240
speak

250
00:07:54,240 --> 00:07:57,840
but we lack a common language to do that

251
00:07:57,840 --> 00:08:00,000
attack flows that common language it's a

252
00:08:00,000 --> 00:08:03,680
schema for storing paths and graph data

253
00:08:03,680 --> 00:08:05,599
and it's really cool because it's

254
00:08:05,599 --> 00:08:07,680
incredibly simple and it's incredibly

255
00:08:07,680 --> 00:08:09,360
strong

256
00:08:09,360 --> 00:08:10,479
and

257
00:08:10,479 --> 00:08:14,080
before well if anyone wants to clap and

258
00:08:14,080 --> 00:08:15,440
and tell me that i was great at doing

259
00:08:15,440 --> 00:08:16,960
this now that's awesome because on the

260
00:08:16,960 --> 00:08:18,160
next slide i'm going to tell you there

261
00:08:18,160 --> 00:08:20,080
was actually a team of people that did

262
00:08:20,080 --> 00:08:20,960
it

263
00:08:20,960 --> 00:08:24,080
um this was something done through um

264
00:08:24,080 --> 00:08:25,840
fighters uh center for threatened form

265
00:08:25,840 --> 00:08:29,520
defense with um like raj attack iq great

266
00:08:29,520 --> 00:08:31,919
uh gauge anomaly apollo at fortinet

267
00:08:31,919 --> 00:08:34,320
market city ryu and fujitsu andy who's

268
00:08:34,320 --> 00:08:36,240
now at apple market title

269
00:08:36,240 --> 00:08:38,719
and we we were lucky we had many of the

270
00:08:38,719 --> 00:08:41,919
right people um ryu worked on this stuff

271
00:08:41,919 --> 00:08:44,159
back like in his phd years in the early

272
00:08:44,159 --> 00:08:45,440
2000s

273
00:08:45,440 --> 00:08:48,000
like and then this guy is like so smart

274
00:08:48,000 --> 00:08:49,120
that

275
00:08:49,120 --> 00:08:51,200
like i just sit in aw

276
00:08:51,200 --> 00:08:52,800
um but he he could be wandering around

277
00:08:52,800 --> 00:08:55,440
here and he's so mild matter that like

278
00:08:55,440 --> 00:08:56,959
you know he he passed by we would never

279
00:08:56,959 --> 00:08:59,680
see him but he's so smart and so awesome

280
00:08:59,680 --> 00:09:01,279
i love ryu

281
00:09:01,279 --> 00:09:05,040
andy was instrumental in writing caldera

282
00:09:05,040 --> 00:09:06,640
mark was instrumental in writing six and

283
00:09:06,640 --> 00:09:07,760
of course

284
00:09:07,760 --> 00:09:10,320
i've worked with brass for a while and i

285
00:09:10,320 --> 00:09:13,360
also maintain the vera schema for the

286
00:09:13,360 --> 00:09:14,959
used by ryzen for the data breach

287
00:09:14,959 --> 00:09:16,959
investigation report

288
00:09:16,959 --> 00:09:18,880
and so it was this team of people that

289
00:09:18,880 --> 00:09:20,880
did this

290
00:09:20,880 --> 00:09:22,480
and so

291
00:09:22,480 --> 00:09:23,360
what's

292
00:09:23,360 --> 00:09:24,959
what's it look like

293
00:09:24,959 --> 00:09:25,839
and so

294
00:09:25,839 --> 00:09:27,279
graphs

295
00:09:27,279 --> 00:09:30,880
are these mathematical things that

296
00:09:30,880 --> 00:09:32,480
they're actually pretty simple they're

297
00:09:32,480 --> 00:09:34,160
made up of two things they're made up of

298
00:09:34,160 --> 00:09:35,920
let me we're at c should i just push

299
00:09:35,920 --> 00:09:36,959
buttons to figure out which one's the

300
00:09:36,959 --> 00:09:38,240
laser or should i actually think about

301
00:09:38,240 --> 00:09:39,279
it

302
00:09:39,279 --> 00:09:41,040
ah yeah there we are there we go it's

303
00:09:41,040 --> 00:09:42,800
made up of dots

304
00:09:42,800 --> 00:09:45,519
it's made up of lines for graphs

305
00:09:45,519 --> 00:09:47,360
and so the idea

306
00:09:47,360 --> 00:09:49,360
is that the dots are nodes the edges are

307
00:09:49,360 --> 00:09:50,800
the lines

308
00:09:50,800 --> 00:09:53,760
every edge has to have a node connected

309
00:09:53,760 --> 00:09:55,120
to its ends

310
00:09:55,120 --> 00:09:56,880
you can't draw a line in a graph and

311
00:09:56,880 --> 00:09:58,880
have nothing on the end but nodes

312
00:09:58,880 --> 00:10:00,800
themselves can have multiple or even no

313
00:10:00,800 --> 00:10:03,519
lines so this is a graph

314
00:10:03,519 --> 00:10:05,440
this is a graph this is not quite a

315
00:10:05,440 --> 00:10:07,440
graph because there's no no time

316
00:10:07,440 --> 00:10:09,279
and there's a lot of different types of

317
00:10:09,279 --> 00:10:12,160
graphs um there's simple graphs like

318
00:10:12,160 --> 00:10:13,680
you know there's no direction you know

319
00:10:13,680 --> 00:10:15,279
you don't know which ones to start at

320
00:10:15,279 --> 00:10:17,440
the end of the edge

321
00:10:17,440 --> 00:10:19,120
there's directed so it goes from

322
00:10:19,120 --> 00:10:20,240
something to that's why we have this

323
00:10:20,240 --> 00:10:23,200
little arrow on this one

324
00:10:23,600 --> 00:10:25,600
there's tree graphs there's acyclic

325
00:10:25,600 --> 00:10:27,200
graphs there's cyclic there's directed

326
00:10:27,200 --> 00:10:29,519
acyclic graphs or dags which come up a

327
00:10:29,519 --> 00:10:30,480
lot

328
00:10:30,480 --> 00:10:34,000
in a lot of kind of different situations

329
00:10:34,000 --> 00:10:35,600
there's also hyper graphs and property

330
00:10:35,600 --> 00:10:37,040
graphs but we're going to talk about a

331
00:10:37,040 --> 00:10:39,600
very specific type of graph

332
00:10:39,600 --> 00:10:41,040
we're going to be talking about linked

333
00:10:41,040 --> 00:10:42,079
data

334
00:10:42,079 --> 00:10:45,279
and that means a couple of things

335
00:10:45,279 --> 00:10:47,279
the first is that every node in edge is

336
00:10:47,279 --> 00:10:50,079
defined by a single string a single uri

337
00:10:50,079 --> 00:10:51,839
specifically

338
00:10:51,839 --> 00:10:54,880
and so every edge has a uri and this one

339
00:10:54,880 --> 00:10:55,680
it's

340
00:10:55,680 --> 00:10:57,279
rdf type and i'll explain the audio

341
00:10:57,279 --> 00:10:59,120
thing in a second

342
00:10:59,120 --> 00:11:01,600
every node has a uri

343
00:11:01,600 --> 00:11:04,240
this is i think attack flow action one

344
00:11:04,240 --> 00:11:06,160
or varus phishing

345
00:11:06,160 --> 00:11:07,839
um the only time you don't have those is

346
00:11:07,839 --> 00:11:09,680
when a node is a literal so an actual

347
00:11:09,680 --> 00:11:11,360
like a bunch of actual string is not a

348
00:11:11,360 --> 00:11:14,959
uri or a number something like that

349
00:11:14,959 --> 00:11:16,480
and so

350
00:11:16,480 --> 00:11:18,160
you combine those into what are called

351
00:11:18,160 --> 00:11:20,560
triples

352
00:11:21,279 --> 00:11:23,360
here we have a triple of attack flow

353
00:11:23,360 --> 00:11:24,240
action

354
00:11:24,240 --> 00:11:25,600
rdf type

355
00:11:25,600 --> 00:11:27,440
embarrass and it's just three things

356
00:11:27,440 --> 00:11:29,200
right like you can see a table with

357
00:11:29,200 --> 00:11:30,720
three columns and you put edges in there

358
00:11:30,720 --> 00:11:32,560
and you have your triples and you have

359
00:11:32,560 --> 00:11:34,480
your graph

360
00:11:34,480 --> 00:11:35,360
um

361
00:11:35,360 --> 00:11:37,120
but you'll notice right

362
00:11:37,120 --> 00:11:40,160
that i didn't spell out a tag flow i

363
00:11:40,160 --> 00:11:42,160
defined a test flow over here as you

364
00:11:42,160 --> 00:11:44,720
know the af means this

365
00:11:44,720 --> 00:11:46,160
uh namespace

366
00:11:46,160 --> 00:11:47,760
and namespaces are one of the cool

367
00:11:47,760 --> 00:11:49,360
things about link data because you don't

368
00:11:49,360 --> 00:11:51,680
have to reinvent the wheel if someone

369
00:11:51,680 --> 00:11:54,480
else has an entire definition

370
00:11:54,480 --> 00:11:56,800
of how to explain things such as actions

371
00:11:56,800 --> 00:11:58,959
or assets you can just use that you

372
00:11:58,959 --> 00:12:01,120
don't have to come up with your own

373
00:12:01,120 --> 00:12:03,279
um in fact a lot of it's predefined

374
00:12:03,279 --> 00:12:06,560
things like rdf define um this is a type

375
00:12:06,560 --> 00:12:08,959
action is a type or actually that should

376
00:12:08,959 --> 00:12:10,639
go the other way fishing is a type of

377
00:12:10,639 --> 00:12:13,040
action or action is a type of fishing

378
00:12:13,040 --> 00:12:15,360
um there's other name spaces you'll see

379
00:12:15,360 --> 00:12:16,480
a lot

380
00:12:16,480 --> 00:12:17,519
and i'm going to bring these up for a

381
00:12:17,519 --> 00:12:19,120
specific reason so

382
00:12:19,120 --> 00:12:21,680
like rdfs is used for labels so if you

383
00:12:21,680 --> 00:12:23,440
want to give your name node like a

384
00:12:23,440 --> 00:12:25,040
common name or something that sounds a

385
00:12:25,040 --> 00:12:27,360
lot better than you know uri blah blah

386
00:12:27,360 --> 00:12:29,279
blah blah

387
00:12:29,279 --> 00:12:31,120
there's dublin core that adds things

388
00:12:31,120 --> 00:12:33,519
like here's the description for the node

389
00:12:33,519 --> 00:12:34,720
there's

390
00:12:34,720 --> 00:12:37,279
time for time stamps and there's al web

391
00:12:37,279 --> 00:12:39,519
ontology language and it has a lot of

392
00:12:39,519 --> 00:12:41,600
useful things like this node is the same

393
00:12:41,600 --> 00:12:43,040
as this node or

394
00:12:43,040 --> 00:12:45,360
this node has an object property

395
00:12:45,360 --> 00:12:48,000
or a data property of this thing or this

396
00:12:48,000 --> 00:12:49,839
is a named individual like there's

397
00:12:49,839 --> 00:12:51,360
phishing the concept and then there's

398
00:12:51,360 --> 00:12:53,200
the actual phishing action action that

399
00:12:53,200 --> 00:12:55,120
happened as a named individual

400
00:12:55,120 --> 00:12:56,480
and the reason i bring these up is

401
00:12:56,480 --> 00:12:58,240
because you know if you go back and you

402
00:12:58,240 --> 00:13:00,079
go google this or if you're googling it

403
00:13:00,079 --> 00:13:01,279
right now it's going to scare the

404
00:13:01,279 --> 00:13:03,040
vaginas out of you

405
00:13:03,040 --> 00:13:05,360
because al does scary things because the

406
00:13:05,360 --> 00:13:06,800
people who invented al were a bunch of

407
00:13:06,800 --> 00:13:07,920
academics who were like you know what's

408
00:13:07,920 --> 00:13:10,079
cool we can do actual cool reasoning

409
00:13:10,079 --> 00:13:11,200
over this

410
00:13:11,200 --> 00:13:13,279
um we can do first order logic we can do

411
00:13:13,279 --> 00:13:15,760
all these fancy things and

412
00:13:15,760 --> 00:13:18,560
we come into and go you know that's cool

413
00:13:18,560 --> 00:13:20,160
and when we need to know that we can

414
00:13:20,160 --> 00:13:21,519
know that

415
00:13:21,519 --> 00:13:23,279
what we want right now is to say that

416
00:13:23,279 --> 00:13:25,680
one node is the same as the other node

417
00:13:25,680 --> 00:13:28,000
like we're using this much of this big

418
00:13:28,000 --> 00:13:29,680
thing and we don't have to understand

419
00:13:29,680 --> 00:13:31,200
that big thing it doesn't affect us in

420
00:13:31,200 --> 00:13:32,959
any way

421
00:13:32,959 --> 00:13:35,040
um but the nice thing is you have this

422
00:13:35,040 --> 00:13:36,399
name space

423
00:13:36,399 --> 00:13:37,760
if you have a data set and i'll explain

424
00:13:37,760 --> 00:13:38,880
this a little bit later but if you have

425
00:13:38,880 --> 00:13:40,000
a data set

426
00:13:40,000 --> 00:13:41,600
that includes something like the city of

427
00:13:41,600 --> 00:13:42,880
sydney

428
00:13:42,880 --> 00:13:44,560
you don't also have to say that sydney

429
00:13:44,560 --> 00:13:46,000
is in australia

430
00:13:46,000 --> 00:13:48,880
that australia is a continent and that

431
00:13:48,880 --> 00:13:51,199
it has this location

432
00:13:51,199 --> 00:13:52,720
someone else has already built a graph

433
00:13:52,720 --> 00:13:55,040
that explains all that stuff if you

434
00:13:55,040 --> 00:13:57,519
reference their sydney node then anyone

435
00:13:57,519 --> 00:13:59,040
that wants to know that stuff they'll be

436
00:13:59,040 --> 00:14:00,959
able to find it

437
00:14:00,959 --> 00:14:03,680
so now we know what graphs are right

438
00:14:03,680 --> 00:14:05,680
what about attack flow

439
00:14:05,680 --> 00:14:08,160
attack flow is five things

440
00:14:08,160 --> 00:14:12,000
actions assets properties relationships

441
00:14:12,000 --> 00:14:13,519
and flow

442
00:14:13,519 --> 00:14:16,639
so the action is the thing that happened

443
00:14:16,639 --> 00:14:18,160
the asset

444
00:14:18,160 --> 00:14:21,519
is the thing that has its state change

445
00:14:21,519 --> 00:14:23,519
properties are these

446
00:14:23,519 --> 00:14:26,160
nodes that describe actions assets other

447
00:14:26,160 --> 00:14:27,920
properties things like that they're the

448
00:14:27,920 --> 00:14:29,360
descriptions

449
00:14:29,360 --> 00:14:30,959
relationships are just the edges between

450
00:14:30,959 --> 00:14:31,680
them

451
00:14:31,680 --> 00:14:33,519
and the flow is the set of all this

452
00:14:33,519 --> 00:14:35,120
together

453
00:14:35,120 --> 00:14:36,880
and so when we look at it

454
00:14:36,880 --> 00:14:40,399
as a graph it looks something like this

455
00:14:40,399 --> 00:14:43,199
we can see this causal path through the

456
00:14:43,199 --> 00:14:44,480
middle of it

457
00:14:44,480 --> 00:14:46,480
and one thing you'll notice here is that

458
00:14:46,480 --> 00:14:49,279
it goes action asset action asset and

459
00:14:49,279 --> 00:14:52,560
that's very very intentional because

460
00:14:52,560 --> 00:14:54,639
we'll get into a little later but in

461
00:14:54,639 --> 00:14:55,760
security

462
00:14:55,760 --> 00:14:57,600
different people think about causality

463
00:14:57,600 --> 00:14:58,880
in different ways

464
00:14:58,880 --> 00:15:01,040
if i'm a blue teamer i think that i have

465
00:15:01,040 --> 00:15:02,959
an asset and this action happened to it

466
00:15:02,959 --> 00:15:04,079
because that's kind of what my logs look

467
00:15:04,079 --> 00:15:05,199
like

468
00:15:05,199 --> 00:15:08,160
um if i'm in on the red team i might say

469
00:15:08,160 --> 00:15:10,240
i did this which is an action then i did

470
00:15:10,240 --> 00:15:12,720
this which is an action and implicitly

471
00:15:12,720 --> 00:15:14,240
it's the assets that are between that i

472
00:15:14,240 --> 00:15:15,680
did this action there's like two

473
00:15:15,680 --> 00:15:16,880
something

474
00:15:16,880 --> 00:15:19,120
um but to be able to capture all the

475
00:15:19,120 --> 00:15:20,639
ways that we

476
00:15:20,639 --> 00:15:21,839
think about

477
00:15:21,839 --> 00:15:24,079
um security it's important to have these

478
00:15:24,079 --> 00:15:26,480
and how they go back and forth

479
00:15:26,480 --> 00:15:27,920
we'll see some visualizations that show

480
00:15:27,920 --> 00:15:29,839
that later

481
00:15:29,839 --> 00:15:32,000
so now we're coming to kind of the

482
00:15:32,000 --> 00:15:33,199
[Music]

483
00:15:33,199 --> 00:15:36,240
fun part what's our data look like today

484
00:15:36,240 --> 00:15:37,680
this is the opportunity to look at a

485
00:15:37,680 --> 00:15:41,040
bunch of data but not use it um

486
00:15:41,040 --> 00:15:43,040
so starting with red team report right

487
00:15:43,040 --> 00:15:44,959
this is just something i downloaded off

488
00:15:44,959 --> 00:15:47,160
of

489
00:15:47,160 --> 00:15:49,040
pintestreports.com

490
00:15:49,040 --> 00:15:52,000
and what do we see here we see a lot of

491
00:15:52,000 --> 00:15:53,440
freeform text

492
00:15:53,440 --> 00:15:55,759
right not a lot of structure

493
00:15:55,759 --> 00:15:57,199
and really also not a lot of solid

494
00:15:57,199 --> 00:15:58,800
grouping you can't say like here's a

495
00:15:58,800 --> 00:16:00,639
concept and here's there's groping but

496
00:16:00,639 --> 00:16:03,279
it's all over the place

497
00:16:03,279 --> 00:16:05,040
so this is what our renting day looks

498
00:16:05,040 --> 00:16:07,120
like today now

499
00:16:07,120 --> 00:16:09,360
tax simulation data a little bit better

500
00:16:09,360 --> 00:16:11,279
it's structured right

501
00:16:11,279 --> 00:16:13,279
it's a tree but a lot of times in attack

502
00:16:13,279 --> 00:16:15,040
simulation data you get a lot of raw

503
00:16:15,040 --> 00:16:17,680
code it's hard to describe anything more

504
00:16:17,680 --> 00:16:19,120
than a single

505
00:16:19,120 --> 00:16:20,000
thing

506
00:16:20,000 --> 00:16:22,079
without having some clear clone attacks

507
00:16:22,079 --> 00:16:24,639
this one single thing points

508
00:16:24,639 --> 00:16:26,399
to some code

509
00:16:26,399 --> 00:16:27,199
and

510
00:16:27,199 --> 00:16:29,360
what we don't want is we don't want to

511
00:16:29,360 --> 00:16:31,920
have to describe our attack simulations

512
00:16:31,920 --> 00:16:34,240
as like arbitrary code because we don't

513
00:16:34,240 --> 00:16:35,680
want to be like hey i need you to go run

514
00:16:35,680 --> 00:16:37,279
this attack simulation in your

515
00:16:37,279 --> 00:16:39,360
environment with your tools here's just

516
00:16:39,360 --> 00:16:41,440
arbitrary code have fun

517
00:16:41,440 --> 00:16:42,560
like we wanted something a little bit

518
00:16:42,560 --> 00:16:44,880
better than that

519
00:16:44,880 --> 00:16:46,240
um

520
00:16:46,240 --> 00:16:47,519
signatures

521
00:16:47,519 --> 00:16:48,480
right

522
00:16:48,480 --> 00:16:50,240
again structured looks very similar to

523
00:16:50,240 --> 00:16:51,920
the attack floyd it's because it's like

524
00:16:51,920 --> 00:16:53,600
hierarchical data

525
00:16:53,600 --> 00:16:55,519
um but there's no real links we're

526
00:16:55,519 --> 00:16:56,639
seeing

527
00:16:56,639 --> 00:16:59,279
one thing happening in an instant

528
00:16:59,279 --> 00:17:00,560
you know and that's we want to be able

529
00:17:00,560 --> 00:17:01,920
to detect more we want to be able to

530
00:17:01,920 --> 00:17:03,759
test subtler things we wanted to be able

531
00:17:03,759 --> 00:17:06,559
to detect multiple things

532
00:17:06,559 --> 00:17:09,520
then we get into intelligence data right

533
00:17:09,520 --> 00:17:10,400
and

534
00:17:10,400 --> 00:17:13,359
this is a subset of an eye chart a very

535
00:17:13,359 --> 00:17:15,679
small subset of an eye chart

536
00:17:15,679 --> 00:17:17,919
these are two records just off of

537
00:17:17,919 --> 00:17:19,599
showdown right

538
00:17:19,599 --> 00:17:21,839
and there's some substantial problems

539
00:17:21,839 --> 00:17:24,240
with this it's super dense

540
00:17:24,240 --> 00:17:26,880
um also you have duplicate data so if i

541
00:17:26,880 --> 00:17:28,079
have like

542
00:17:28,079 --> 00:17:30,880
the same vulnerability down here

543
00:17:30,880 --> 00:17:32,640
i'm going to get duplication of

544
00:17:32,640 --> 00:17:35,039
references duplications of summaries

545
00:17:35,039 --> 00:17:36,400
like those are going to be in every

546
00:17:36,400 --> 00:17:38,080
single record that references this

547
00:17:38,080 --> 00:17:39,600
vulnerability

548
00:17:39,600 --> 00:17:41,120
right that's going to take a lot of

549
00:17:41,120 --> 00:17:43,520
space but the biggest problem with this

550
00:17:43,520 --> 00:17:44,720
is that when we use these data

551
00:17:44,720 --> 00:17:48,000
structures we don't know what's in them

552
00:17:48,000 --> 00:17:50,080
and so

553
00:17:50,080 --> 00:17:52,320
this one like so

554
00:17:52,320 --> 00:17:54,000
over here

555
00:17:54,000 --> 00:17:57,520
this is an http test

556
00:17:57,520 --> 00:17:58,640
this one

557
00:17:58,640 --> 00:18:00,000
i don't think this one's actually an

558
00:18:00,000 --> 00:18:01,840
http it's a different

559
00:18:01,840 --> 00:18:04,320
test it's like the https test

560
00:18:04,320 --> 00:18:06,160
and there's nothing that says that they

561
00:18:06,160 --> 00:18:08,160
need to have the same information so if

562
00:18:08,160 --> 00:18:10,880
i'm looking at my dictionaries for

563
00:18:10,880 --> 00:18:12,960
key that's like five layers down in

564
00:18:12,960 --> 00:18:14,480
every one of my records it's not there

565
00:18:14,480 --> 00:18:16,160
in every one of my records

566
00:18:16,160 --> 00:18:18,000
and this becomes this huge problem as

567
00:18:18,000 --> 00:18:19,280
you look through data if you don't know

568
00:18:19,280 --> 00:18:21,200
exactly what the entire structure of the

569
00:18:21,200 --> 00:18:23,280
data looks like you know and who wants

570
00:18:23,280 --> 00:18:25,840
to know the structure of all the data

571
00:18:25,840 --> 00:18:27,520
justifying the few things they want to

572
00:18:27,520 --> 00:18:29,200
look for

573
00:18:29,200 --> 00:18:31,520
i say this from profoundly depressing

574
00:18:31,520 --> 00:18:33,919
experience

575
00:18:33,919 --> 00:18:36,960
okay so moving on incident response data

576
00:18:36,960 --> 00:18:40,480
right this is all very textual

577
00:18:40,480 --> 00:18:42,320
it's all kind of these text files by the

578
00:18:42,320 --> 00:18:44,880
way big thanks to chris sanders uh and

579
00:18:44,880 --> 00:18:47,600
his training he donated the text files

580
00:18:47,600 --> 00:18:48,880
for this

581
00:18:48,880 --> 00:18:50,320
um

582
00:18:50,320 --> 00:18:52,400
he's also helped out a lot

583
00:18:52,400 --> 00:18:54,080
and so these are text files of

584
00:18:54,080 --> 00:18:57,840
indicators and information

585
00:18:57,840 --> 00:19:00,240
um that were collected during this uh

586
00:19:00,240 --> 00:19:02,240
simulated ir

587
00:19:02,240 --> 00:19:04,640
and the problem right is it's all text

588
00:19:04,640 --> 00:19:06,080
even some of this is structured this is

589
00:19:06,080 --> 00:19:07,600
structured data

590
00:19:07,600 --> 00:19:08,960
but it's being stored as tests and

591
00:19:08,960 --> 00:19:12,720
there's nothing that links 222 to

592
00:19:12,720 --> 00:19:14,480
something in this file

593
00:19:14,480 --> 00:19:16,960
it's right there or over here or even in

594
00:19:16,960 --> 00:19:19,200
the same file other than like wrapping

595
00:19:19,200 --> 00:19:20,640
the raw text

596
00:19:20,640 --> 00:19:22,480
you know that's not very searchable

597
00:19:22,480 --> 00:19:24,799
that's not very usable

598
00:19:24,799 --> 00:19:26,000
you know you're never going to find that

599
00:19:26,000 --> 00:19:27,340
in six months

600
00:19:27,340 --> 00:19:29,120
[Music]

601
00:19:29,120 --> 00:19:30,000
and so

602
00:19:30,000 --> 00:19:31,360
moving on to like thread and tail this

603
00:19:31,360 --> 00:19:33,760
is uh some noise donate some data

604
00:19:33,760 --> 00:19:35,600
donated by grey noise

605
00:19:35,600 --> 00:19:36,960
this is actually pretty nicely

606
00:19:36,960 --> 00:19:39,039
structured it's relatively clean

607
00:19:39,039 --> 00:19:40,480
this one is

608
00:19:40,480 --> 00:19:43,200
but you know you can end up with

609
00:19:43,200 --> 00:19:45,120
raw data scanned this one they scan two

610
00:19:45,120 --> 00:19:48,080
ports what if they scan every port right

611
00:19:48,080 --> 00:19:49,280
then you get this thing that's like this

612
00:19:49,280 --> 00:19:50,559
big

613
00:19:50,559 --> 00:19:54,799
um also what if you have 40 000 of these

614
00:19:54,799 --> 00:19:56,559
um and you need to find every place that

615
00:19:56,559 --> 00:19:58,160
23 is mentioned

616
00:19:58,160 --> 00:20:00,240
um do you really want to look through 40

617
00:20:00,240 --> 00:20:03,600
000 pieces of data to find the one

618
00:20:03,600 --> 00:20:05,440
everyone that's got you know port 23 in

619
00:20:05,440 --> 00:20:06,480
it

620
00:20:06,480 --> 00:20:08,159
and even when we aggregate things like

621
00:20:08,159 --> 00:20:09,760
threat intelligence like

622
00:20:09,760 --> 00:20:11,919
i like to think that this looks good i

623
00:20:11,919 --> 00:20:14,240
like to think that because i made it

624
00:20:14,240 --> 00:20:15,440
um

625
00:20:15,440 --> 00:20:16,880
you can all tell me that it looks good

626
00:20:16,880 --> 00:20:18,840
you don't have to believe it though

627
00:20:18,840 --> 00:20:21,679
um it's all aggregated and it's pretty

628
00:20:21,679 --> 00:20:24,400
it communicates it's clean it hides a

629
00:20:24,400 --> 00:20:26,480
lot of nuance because of that

630
00:20:26,480 --> 00:20:27,679
aggregation

631
00:20:27,679 --> 00:20:30,159
and we'll see that a little bit later

632
00:20:30,159 --> 00:20:31,600
you know but even keep moving up the

633
00:20:31,600 --> 00:20:33,440
chain let's say that we're making

634
00:20:33,440 --> 00:20:35,039
decisions about our architecture what

635
00:20:35,039 --> 00:20:36,640
we're going to invest in

636
00:20:36,640 --> 00:20:38,080
you know how do we do that these days we

637
00:20:38,080 --> 00:20:39,840
make it one endless you know

638
00:20:39,840 --> 00:20:41,440
at an organization i was at the way we

639
00:20:41,440 --> 00:20:43,039
did is the entire security department

640
00:20:43,039 --> 00:20:45,039
could propose projects

641
00:20:45,039 --> 00:20:46,559
and they said hey we think it'll cost us

642
00:20:46,559 --> 00:20:49,039
much here's some text

643
00:20:49,039 --> 00:20:50,559
maybe a paragraph explaining the benefit

644
00:20:50,559 --> 00:20:53,039
we expect to get from it and we build

645
00:20:53,039 --> 00:20:54,960
you know one endless and at some point

646
00:20:54,960 --> 00:20:57,200
the money runs out you draw a line and

647
00:20:57,200 --> 00:20:58,880
you find this stuff and you don't fund

648
00:20:58,880 --> 00:21:00,080
that stuff

649
00:21:00,080 --> 00:21:03,679
above the line below the line um

650
00:21:03,679 --> 00:21:06,159
the problem is there's no context to it

651
00:21:06,159 --> 00:21:07,919
do we know the email filter plus a

652
00:21:07,919 --> 00:21:09,760
phishing reporting button

653
00:21:09,760 --> 00:21:11,280
do those really we want to buy those

654
00:21:11,280 --> 00:21:13,200
together are those complementary are

655
00:21:13,200 --> 00:21:15,280
they duplicative

656
00:21:15,280 --> 00:21:16,720
and what about the discussions at the

657
00:21:16,720 --> 00:21:18,159
executive level

658
00:21:18,159 --> 00:21:19,280
right

659
00:21:19,280 --> 00:21:20,720
um a new

660
00:21:20,720 --> 00:21:22,880
uh exploit's being hit right software x

661
00:21:22,880 --> 00:21:23,919
has been

662
00:21:23,919 --> 00:21:25,600
used in breaches and you know those

663
00:21:25,600 --> 00:21:27,600
companies look like us and you know the

664
00:21:27,600 --> 00:21:30,080
executive team says well are we at risk

665
00:21:30,080 --> 00:21:30,960
we say

666
00:21:30,960 --> 00:21:32,799
we could be

667
00:21:32,799 --> 00:21:34,880
um we really don't know right we know

668
00:21:34,880 --> 00:21:36,159
that we run the software but we don't

669
00:21:36,159 --> 00:21:37,360
know if we're at risk because we don't

670
00:21:37,360 --> 00:21:39,840
understand our context

671
00:21:39,840 --> 00:21:42,159
and so there's a lot of problems here

672
00:21:42,159 --> 00:21:43,440
right

673
00:21:43,440 --> 00:21:46,080
um often our data is just blocks of

674
00:21:46,080 --> 00:21:48,000
tests it's hard to parse

675
00:21:48,000 --> 00:21:49,360
it's hard for people to parse it's hard

676
00:21:49,360 --> 00:21:51,440
for machines to parse it's hard to get

677
00:21:51,440 --> 00:21:53,120
value from because the person has to be

678
00:21:53,120 --> 00:21:54,320
able to look at it and pull out the

679
00:21:54,320 --> 00:21:55,840
pieces and organize them in their mind

680
00:21:55,840 --> 00:21:57,200
because they're not organized in the

681
00:21:57,200 --> 00:21:59,360
text and if you can't do that in real

682
00:21:59,360 --> 00:22:01,120
time when you're looking at it what are

683
00:22:01,120 --> 00:22:02,080
the chances you're going to be able to

684
00:22:02,080 --> 00:22:03,679
find that later on

685
00:22:03,679 --> 00:22:05,840
and put it to use

686
00:22:05,840 --> 00:22:07,039
you know we've got a lot of structured

687
00:22:07,039 --> 00:22:09,200
data most of it's structured

688
00:22:09,200 --> 00:22:11,360
either tabularly for logs

689
00:22:11,360 --> 00:22:15,200
or hierarchically and that's better

690
00:22:15,200 --> 00:22:17,760
but a lot of times it lacks links

691
00:22:17,760 --> 00:22:19,679
hierarchical data is not good at

692
00:22:19,679 --> 00:22:21,840
building sequential links of things it

693
00:22:21,840 --> 00:22:23,200
can tell you something and then tell you

694
00:22:23,200 --> 00:22:24,320
things about those things and those

695
00:22:24,320 --> 00:22:26,480
things you tell things about it doesn't

696
00:22:26,480 --> 00:22:28,320
say this thing is related to this thing

697
00:22:28,320 --> 00:22:30,559
is related to this thing

698
00:22:30,559 --> 00:22:31,520
um

699
00:22:31,520 --> 00:22:32,400
also

700
00:22:32,400 --> 00:22:34,400
it lacks that context you either are

701
00:22:34,400 --> 00:22:35,840
putting too much context in because

702
00:22:35,840 --> 00:22:37,200
you're duplicating every one of your

703
00:22:37,200 --> 00:22:39,520
records or you have too little context

704
00:22:39,520 --> 00:22:40,880
because you can't go find the additional

705
00:22:40,880 --> 00:22:43,039
pieces of information about them because

706
00:22:43,039 --> 00:22:45,919
they have to be in the record

707
00:22:45,919 --> 00:22:48,640
and if you do have all that context in

708
00:22:48,640 --> 00:22:50,080
your data and all this structure it

709
00:22:50,080 --> 00:22:52,559
becomes so complex that you can't find

710
00:22:52,559 --> 00:22:54,400
anything you need a search engine

711
00:22:54,400 --> 00:22:58,400
just to find minor things in your data

712
00:22:58,400 --> 00:22:59,520
and so

713
00:22:59,520 --> 00:23:00,960
attack flow

714
00:23:00,960 --> 00:23:02,159
improves

715
00:23:02,159 --> 00:23:04,080
infosec data

716
00:23:04,080 --> 00:23:05,679
and we're going to go through this as an

717
00:23:05,679 --> 00:23:08,480
example to see how that works i like

718
00:23:08,480 --> 00:23:09,679
examples so we're going to walk through

719
00:23:09,679 --> 00:23:11,280
it so

720
00:23:11,280 --> 00:23:12,960
we said attack flow is like a schemer

721
00:23:12,960 --> 00:23:14,320
right

722
00:23:14,320 --> 00:23:15,520
it's not

723
00:23:15,520 --> 00:23:18,720
a tool it's not a solution it's how you

724
00:23:18,720 --> 00:23:20,080
structure your data

725
00:23:20,080 --> 00:23:21,760
and the schema itself

726
00:23:21,760 --> 00:23:24,400
lives as either a json schema or as a

727
00:23:24,400 --> 00:23:26,640
graph

728
00:23:26,640 --> 00:23:28,880
um

729
00:23:29,200 --> 00:23:31,120
we also have data and this is a good

730
00:23:31,120 --> 00:23:34,159
example because anytime you have actions

731
00:23:34,159 --> 00:23:38,000
assets in order you can create a flow

732
00:23:38,000 --> 00:23:40,400
um and it can be in incident response

733
00:23:40,400 --> 00:23:42,000
reports red team reports really any of

734
00:23:42,000 --> 00:23:43,840
that data we just looked at

735
00:23:43,840 --> 00:23:45,679
but these are two good examples because

736
00:23:45,679 --> 00:23:46,960
if we look over here if we look at

737
00:23:46,960 --> 00:23:48,320
what's happening

738
00:23:48,320 --> 00:23:51,120
in the ir report it's very asset centric

739
00:23:51,120 --> 00:23:52,960
the mail logs show

740
00:23:52,960 --> 00:23:56,080
no proxy and hosts blogs detect

741
00:23:56,080 --> 00:23:59,120
where a red team report starts with we

742
00:23:59,120 --> 00:24:01,760
fished right we installed it starts with

743
00:24:01,760 --> 00:24:04,159
the action happening

744
00:24:04,159 --> 00:24:05,039
and so

745
00:24:05,039 --> 00:24:06,720
it's two different ways of looking at

746
00:24:06,720 --> 00:24:08,640
the exact same thing

747
00:24:08,640 --> 00:24:09,840
but now we have our scheme and we have

748
00:24:09,840 --> 00:24:11,039
our data and

749
00:24:11,039 --> 00:24:12,320
you know i assume that everyone knows

750
00:24:12,320 --> 00:24:14,400
exactly how

751
00:24:14,400 --> 00:24:16,799
we need something to put them together

752
00:24:16,799 --> 00:24:18,880
which is nice because we actually have

753
00:24:18,880 --> 00:24:22,080
that tool um uh michael uh

754
00:24:22,080 --> 00:24:25,039
corenzo i i agree with things um put

755
00:24:25,039 --> 00:24:26,559
this together as part of the mitre

756
00:24:26,559 --> 00:24:27,600
project

757
00:24:27,600 --> 00:24:30,000
um you define your action and you define

758
00:24:30,000 --> 00:24:31,600
the mandatory properties for it you'll

759
00:24:31,600 --> 00:24:32,960
find your asset in the mandatory

760
00:24:32,960 --> 00:24:34,640
property

761
00:24:34,640 --> 00:24:36,080
and then you can add additional

762
00:24:36,080 --> 00:24:37,679
properties down below and these are all

763
00:24:37,679 --> 00:24:39,279
just kind of point and click

764
00:24:39,279 --> 00:24:41,440
in the user interface to build this out

765
00:24:41,440 --> 00:24:42,320
and

766
00:24:42,320 --> 00:24:44,320
once you've built it you can export your

767
00:24:44,320 --> 00:24:45,679
data

768
00:24:45,679 --> 00:24:48,960
as a tag flow so we can export as a json

769
00:24:48,960 --> 00:24:50,320
schema

770
00:24:50,320 --> 00:24:52,080
and the nice thing here is the actions

771
00:24:52,080 --> 00:24:53,600
are grouped together

772
00:24:53,600 --> 00:24:55,120
assets are grouped together properties

773
00:24:55,120 --> 00:24:56,320
are grouped together

774
00:24:56,320 --> 00:24:58,559
but i really prefer data as a graph and

775
00:24:58,559 --> 00:25:01,520
so still it's a graph stored in json

776
00:25:01,520 --> 00:25:03,279
but it's a little bit different it's

777
00:25:03,279 --> 00:25:05,440
just a list that's what a little flat

778
00:25:05,440 --> 00:25:06,960
bracket tells us

779
00:25:06,960 --> 00:25:08,799
each thing in the list is a node so the

780
00:25:08,799 --> 00:25:11,520
id of this node is action one

781
00:25:11,520 --> 00:25:13,360
and then for every one of the properties

782
00:25:13,360 --> 00:25:14,400
the key

783
00:25:14,400 --> 00:25:16,159
is like the relationship

784
00:25:16,159 --> 00:25:18,880
and the values are the other nodes and

785
00:25:18,880 --> 00:25:19,679
so

786
00:25:19,679 --> 00:25:21,840
action one is a named individual

787
00:25:21,840 --> 00:25:23,840
it's a type of phishing and it's a type

788
00:25:23,840 --> 00:25:26,799
of attack flow action

789
00:25:26,799 --> 00:25:28,640
we can also say the vector for it was

790
00:25:28,640 --> 00:25:29,679
email

791
00:25:29,679 --> 00:25:32,080
or the description is the actor phished

792
00:25:32,080 --> 00:25:33,440
a victim

793
00:25:33,440 --> 00:25:35,679
no things like that

794
00:25:35,679 --> 00:25:37,600
and so if we want to know what a node is

795
00:25:37,600 --> 00:25:39,679
connected to we can just go to that spot

796
00:25:39,679 --> 00:25:41,200
in the file

797
00:25:41,200 --> 00:25:43,120
and then we take that graph because

798
00:25:43,120 --> 00:25:44,720
let's be honest none of us want to work

799
00:25:44,720 --> 00:25:46,880
with json directly we want our machines

800
00:25:46,880 --> 00:25:48,720
to work with json

801
00:25:48,720 --> 00:25:52,320
and we put it into a graph database

802
00:25:52,320 --> 00:25:54,960
this is auto text db

803
00:25:54,960 --> 00:25:58,400
graph or auto text graph db

804
00:25:58,400 --> 00:26:00,480
this is one of the many many tools you

805
00:26:00,480 --> 00:26:01,919
can use for this there's tons of graph

806
00:26:01,919 --> 00:26:03,440
databases out there i like this one

807
00:26:03,440 --> 00:26:04,400
because

808
00:26:04,400 --> 00:26:08,000
it has a nice ui it's got a nice api and

809
00:26:08,000 --> 00:26:09,600
there's a good free

810
00:26:09,600 --> 00:26:10,799
version of it

811
00:26:10,799 --> 00:26:12,799
and it works great for this kind of data

812
00:26:12,799 --> 00:26:15,120
but you know you we said these are these

813
00:26:15,120 --> 00:26:16,720
are just triples you can put them into a

814
00:26:16,720 --> 00:26:19,279
relational database or any other type

815
00:26:19,279 --> 00:26:21,279
and we can see where this happened right

816
00:26:21,279 --> 00:26:23,600
we still have our causal path we have

817
00:26:23,600 --> 00:26:25,840
actions that lead to assets which lead

818
00:26:25,840 --> 00:26:27,440
to actions which lead to assets we have

819
00:26:27,440 --> 00:26:29,039
the properties

820
00:26:29,039 --> 00:26:30,159
a couple other properties and we have

821
00:26:30,159 --> 00:26:33,120
our flow note up here

822
00:26:33,600 --> 00:26:34,400
but

823
00:26:34,400 --> 00:26:36,880
looking at it is fun and you know i

824
00:26:36,880 --> 00:26:38,080
probably could spend a bunch of time up

825
00:26:38,080 --> 00:26:38,880
here

826
00:26:38,880 --> 00:26:40,720
just showing pretty pictures but the

827
00:26:40,720 --> 00:26:43,600
reality is we want to use our data

828
00:26:43,600 --> 00:26:45,840
and so we take that data and the cool

829
00:26:45,840 --> 00:26:47,120
thing is it's in a database it's not

830
00:26:47,120 --> 00:26:49,520
just living on its own in some file

831
00:26:49,520 --> 00:26:52,480
we can now query it and so we can say on

832
00:26:52,480 --> 00:26:54,000
the left what assets have been

833
00:26:54,000 --> 00:26:55,440
compromised

834
00:26:55,440 --> 00:26:57,120
or on the right and i know this isn't

835
00:26:57,120 --> 00:26:58,799
readable

836
00:26:58,799 --> 00:27:01,840
what actions have been taken but we

837
00:27:01,840 --> 00:27:03,039
don't just stop there right because we

838
00:27:03,039 --> 00:27:04,880
really want to know things like what

839
00:27:04,880 --> 00:27:06,480
assets were compromised in a certain

840
00:27:06,480 --> 00:27:07,679
window

841
00:27:07,679 --> 00:27:10,000
or which action is taken most often but

842
00:27:10,000 --> 00:27:11,840
that's this query this is in a language

843
00:27:11,840 --> 00:27:15,520
called sparkle which is a standard graph

844
00:27:15,520 --> 00:27:16,799
query language

845
00:27:16,799 --> 00:27:17,919
but if you were storing this in a

846
00:27:17,919 --> 00:27:19,760
relational database you'd be acquiring a

847
00:27:19,760 --> 00:27:22,240
sql or you could be created with gremlin

848
00:27:22,240 --> 00:27:24,159
or cipher or kql depending on what

849
00:27:24,159 --> 00:27:26,080
you're storing your data in

850
00:27:26,080 --> 00:27:28,960
anything the nice thing is how flexible

851
00:27:28,960 --> 00:27:30,799
data is

852
00:27:30,799 --> 00:27:33,200
and so you go find what you need in your

853
00:27:33,200 --> 00:27:35,200
data and not just in individual pieces

854
00:27:35,200 --> 00:27:36,880
you find it in all your data because all

855
00:27:36,880 --> 00:27:39,520
your data is living in the same place

856
00:27:39,520 --> 00:27:43,360
so going back to our challenges right

857
00:27:43,360 --> 00:27:46,080
instead of a lot of text we have nodes

858
00:27:46,080 --> 00:27:48,640
that represent a single concept

859
00:27:48,640 --> 00:27:50,799
instead of complex json

860
00:27:50,799 --> 00:27:53,120
tacflow lets us represent the parts that

861
00:27:53,120 --> 00:27:55,279
we need

862
00:27:55,279 --> 00:27:56,880
however if there's more context we want

863
00:27:56,880 --> 00:27:58,799
we simply link to it somewhere else

864
00:27:58,799 --> 00:28:00,640
someone has probably described it we can

865
00:28:00,640 --> 00:28:03,760
go and bring in their knowledge as well

866
00:28:03,760 --> 00:28:07,919
the relationships are a uh

867
00:28:08,080 --> 00:28:09,760
clear and explicit

868
00:28:09,760 --> 00:28:12,480
you know we know how to connect things

869
00:28:12,480 --> 00:28:14,880
we can show causality the paths the

870
00:28:14,880 --> 00:28:17,520
attacks take right something we weren't

871
00:28:17,520 --> 00:28:20,000
able to do before

872
00:28:20,000 --> 00:28:21,200
and so

873
00:28:21,200 --> 00:28:23,679
let's go back through our data

874
00:28:23,679 --> 00:28:25,840
and see what it looks like now that

875
00:28:25,840 --> 00:28:27,120
we've turned into tackle we start with

876
00:28:27,120 --> 00:28:28,480
red team data right it looked like this

877
00:28:28,480 --> 00:28:31,279
before

878
00:28:31,279 --> 00:28:32,320
now

879
00:28:32,320 --> 00:28:35,120
it looks like this

880
00:28:35,600 --> 00:28:37,200
this no one in this room is going to

881
00:28:37,200 --> 00:28:38,480
look at this and understand what's going

882
00:28:38,480 --> 00:28:39,200
on

883
00:28:39,200 --> 00:28:40,159
this

884
00:28:40,159 --> 00:28:42,159
everyone can look on right

885
00:28:42,159 --> 00:28:44,480
the red team started with email and

886
00:28:44,480 --> 00:28:46,720
phone they fished one phish to the other

887
00:28:46,720 --> 00:28:48,399
it compromised the person who made the

888
00:28:48,399 --> 00:28:49,520
error and gave out their personal

889
00:28:49,520 --> 00:28:52,080
information or installed malware on the

890
00:28:52,080 --> 00:28:54,080
user device

891
00:28:54,080 --> 00:28:55,760
this led to credentials and installed

892
00:28:55,760 --> 00:28:56,880
malware

893
00:28:56,880 --> 00:28:58,480
over here the sensor exploited a

894
00:28:58,480 --> 00:29:00,559
vulnerability internally on these two

895
00:29:00,559 --> 00:29:01,520
systems

896
00:29:01,520 --> 00:29:02,960
one allowed for additional directory

897
00:29:02,960 --> 00:29:06,320
transversal which compromised phi

898
00:29:06,320 --> 00:29:07,760
you know and not only the cool thing is

899
00:29:07,760 --> 00:29:09,600
not only is this much more legible this

900
00:29:09,600 --> 00:29:11,360
gets fed into whatever tool you are

901
00:29:11,360 --> 00:29:13,760
using to store this data this data isn't

902
00:29:13,760 --> 00:29:16,000
looked at once and then left on the

903
00:29:16,000 --> 00:29:17,440
cutting room floor

904
00:29:17,440 --> 00:29:19,760
it lives in your context for your

905
00:29:19,760 --> 00:29:21,919
organization to use

906
00:29:21,919 --> 00:29:26,159
this nice structured data

907
00:29:26,159 --> 00:29:27,919
did you get it

908
00:29:27,919 --> 00:29:29,279
okay

909
00:29:29,279 --> 00:29:31,679
um looking at tax simulation data this

910
00:29:31,679 --> 00:29:33,039
is a really fun area because right now

911
00:29:33,039 --> 00:29:35,039
it's kind of you can simulate basic

912
00:29:35,039 --> 00:29:36,080
things and we can write a bunch of

913
00:29:36,080 --> 00:29:37,440
programs and do a bunch of stuff in

914
00:29:37,440 --> 00:29:38,480
sequence

915
00:29:38,480 --> 00:29:41,360
what if we could do it dynamically right

916
00:29:41,360 --> 00:29:43,360
and so let's say that the attackers

917
00:29:43,360 --> 00:29:45,200
start with the domain and email

918
00:29:45,200 --> 00:29:46,640
and so what you do is you match into

919
00:29:46,640 --> 00:29:49,360
your graph what little sub graphs or

920
00:29:49,360 --> 00:29:52,159
patterns match what data i have

921
00:29:52,159 --> 00:29:54,399
well network discovery does and so we're

922
00:29:54,399 --> 00:29:55,440
going to do the discovery maybe we

923
00:29:55,440 --> 00:29:57,520
discover an rdp server

924
00:29:57,520 --> 00:29:59,520
over here if we have email well the

925
00:29:59,520 --> 00:30:01,039
action that matches that or one of our

926
00:30:01,039 --> 00:30:02,080
actions matching that's going to be

927
00:30:02,080 --> 00:30:03,360
phishing

928
00:30:03,360 --> 00:30:05,039
and so that compromises a person who

929
00:30:05,039 --> 00:30:06,799
makes a mistake and compromises the

930
00:30:06,799 --> 00:30:08,559
credentials back to the attacker and the

931
00:30:08,559 --> 00:30:09,760
cool thing is

932
00:30:09,760 --> 00:30:11,520
after this happens and this happens you

933
00:30:11,520 --> 00:30:13,600
go back through your list of potential

934
00:30:13,600 --> 00:30:14,960
actions you can take and you see which

935
00:30:14,960 --> 00:30:16,960
other ones match in the graph

936
00:30:16,960 --> 00:30:18,720
because we have compromised credentials

937
00:30:18,720 --> 00:30:20,960
and a compromise ip server we have a

938
00:30:20,960 --> 00:30:23,120
match and so we take another action we

939
00:30:23,120 --> 00:30:24,880
use those stolen credentials to

940
00:30:24,880 --> 00:30:27,520
compromise the rdp server you know the

941
00:30:27,520 --> 00:30:29,440
same way we think is people we can now

942
00:30:29,440 --> 00:30:30,720
document that

943
00:30:30,720 --> 00:30:32,960
and have machine

944
00:30:32,960 --> 00:30:34,640
okay i'm sure everyone like then things

945
00:30:34,640 --> 00:30:36,320
like but do we really want to do this

946
00:30:36,320 --> 00:30:37,520
and you're absolutely right we probably

947
00:30:37,520 --> 00:30:41,039
don't want to do this but you can do it

948
00:30:41,039 --> 00:30:43,520
i want to get in trouble for this one

949
00:30:43,520 --> 00:30:44,799
um

950
00:30:44,799 --> 00:30:46,320
signatures

951
00:30:46,320 --> 00:30:48,480
right our signatures are pretty static

952
00:30:48,480 --> 00:30:50,880
right now what if they could be a little

953
00:30:50,880 --> 00:30:53,039
more dynamic

954
00:30:53,039 --> 00:30:55,440
a process creates a file

955
00:30:55,440 --> 00:30:57,120
that same process

956
00:30:57,120 --> 00:30:58,960
runs that file

957
00:30:58,960 --> 00:31:01,200
the process of the browser and the file

958
00:31:01,200 --> 00:31:02,720
isn't living in a place a browser should

959
00:31:02,720 --> 00:31:05,679
put files right now we don't have to

960
00:31:05,679 --> 00:31:09,039
base detections on individual

961
00:31:09,039 --> 00:31:10,240
events

962
00:31:10,240 --> 00:31:11,440
and the reality is there's a lot of

963
00:31:11,440 --> 00:31:13,440
organizations that are doing all already

964
00:31:13,440 --> 00:31:15,360
but a lot of it's done in raw code and

965
00:31:15,360 --> 00:31:17,360
things that are not communicatable what

966
00:31:17,360 --> 00:31:18,640
we want is something that's communicated

967
00:31:18,640 --> 00:31:20,159
we want a rule that i can then send to

968
00:31:20,159 --> 00:31:22,159
someone else to say hey can you test

969
00:31:22,159 --> 00:31:24,000
this to see if it works

970
00:31:24,000 --> 00:31:25,440
you know can you test this within the

971
00:31:25,440 --> 00:31:27,200
system

972
00:31:27,200 --> 00:31:31,200
our intelligence it is convoluted

973
00:31:31,200 --> 00:31:33,039
we can take it now and we can look for

974
00:31:33,039 --> 00:31:34,640
the parts we want

975
00:31:34,640 --> 00:31:36,640
let's say that i want to know about

976
00:31:36,640 --> 00:31:38,640
this vulnerability right here

977
00:31:38,640 --> 00:31:39,840
and so i search for that and then i

978
00:31:39,840 --> 00:31:41,760
double click that and it says hey here

979
00:31:41,760 --> 00:31:43,360
are the instances of that vulnerability

980
00:31:43,360 --> 00:31:44,799
that exists

981
00:31:44,799 --> 00:31:47,440
and i say great show me the interfaces

982
00:31:47,440 --> 00:31:48,799
that others are found on it's found on

983
00:31:48,799 --> 00:31:50,240
this interface and that interface and

984
00:31:50,240 --> 00:31:52,000
that interface which is found through

985
00:31:52,000 --> 00:31:54,399
these scans on these assets and we can

986
00:31:54,399 --> 00:31:56,000
click through we can do it and the first

987
00:31:56,000 --> 00:31:57,039
couple of times that's going to be

988
00:31:57,039 --> 00:31:58,240
really cool and you're going to enjoy

989
00:31:58,240 --> 00:32:00,480
that it's going to be a lot of fun

990
00:32:00,480 --> 00:32:02,480
um after the first couple times you're

991
00:32:02,480 --> 00:32:05,200
just gonna write a query that says hey

992
00:32:05,200 --> 00:32:06,880
tell me every system that has this

993
00:32:06,880 --> 00:32:08,640
vulnerability on it and it's gonna dump

994
00:32:08,640 --> 00:32:10,559
it out for you it's gonna find that

995
00:32:10,559 --> 00:32:12,320
context and you can link in context from

996
00:32:12,320 --> 00:32:14,559
outside your organization

997
00:32:14,559 --> 00:32:15,840
if you want to know the physical

998
00:32:15,840 --> 00:32:19,199
locations or things like that

999
00:32:19,519 --> 00:32:22,720
our incident response data very

1000
00:32:22,720 --> 00:32:24,880
messy useful from a human perspective

1001
00:32:24,880 --> 00:32:27,519
but not well useful later on

1002
00:32:27,519 --> 00:32:28,960
what if we take that data and we put it

1003
00:32:28,960 --> 00:32:31,039
into markdown

1004
00:32:31,039 --> 00:32:32,480
we're defining an edge right here

1005
00:32:32,480 --> 00:32:34,960
because we have a source a relationship

1006
00:32:34,960 --> 00:32:38,000
and a target

1007
00:32:38,000 --> 00:32:39,840
let's test in markdown

1008
00:32:39,840 --> 00:32:41,760
now we have that we have our incident

1009
00:32:41,760 --> 00:32:43,679
response in our graph in our structured

1010
00:32:43,679 --> 00:32:45,279
data this could potentially be living

1011
00:32:45,279 --> 00:32:47,039
with your intelligence with your renting

1012
00:32:47,039 --> 00:32:48,720
data

1013
00:32:48,720 --> 00:32:50,640
now when we go and look we can go find

1014
00:32:50,640 --> 00:32:52,000
the things you want in fact we can bring

1015
00:32:52,000 --> 00:32:53,279
in that structured data that we had

1016
00:32:53,279 --> 00:32:54,960
during our incident response

1017
00:32:54,960 --> 00:32:56,720
and bring it into the graph directly and

1018
00:32:56,720 --> 00:32:59,200
then output from the graph back into our

1019
00:32:59,200 --> 00:33:00,399
markdown

1020
00:33:00,399 --> 00:33:03,600
allowing us to both work as kind of text

1021
00:33:03,600 --> 00:33:07,360
as well as as structured data

1022
00:33:07,519 --> 00:33:09,279
oh and this is um

1023
00:33:09,279 --> 00:33:11,519
let's see this on the left this is onto

1024
00:33:11,519 --> 00:33:14,399
text graph vegan and obsidian and i'm

1025
00:33:14,399 --> 00:33:15,919
trying to point out tools as i go

1026
00:33:15,919 --> 00:33:17,360
because i want to

1027
00:33:17,360 --> 00:33:19,279
really impress on you that there is so

1028
00:33:19,279 --> 00:33:20,720
much ecosystem that already exists

1029
00:33:20,720 --> 00:33:22,720
around this stuff

1030
00:33:22,720 --> 00:33:25,039
um

1031
00:33:25,039 --> 00:33:26,399
looking at

1032
00:33:26,399 --> 00:33:28,399
the additional the grain oils intel

1033
00:33:28,399 --> 00:33:30,559
and there's a lot i like i think i parse

1034
00:33:30,559 --> 00:33:33,519
through an hour of data in like 46 000

1035
00:33:33,519 --> 00:33:34,799
records

1036
00:33:34,799 --> 00:33:36,000
um

1037
00:33:36,000 --> 00:33:38,399
let's now we can go and explore that you

1038
00:33:38,399 --> 00:33:40,000
know i can go search for the

1039
00:33:40,000 --> 00:33:42,159
vulnerability i want i can find every

1040
00:33:42,159 --> 00:33:44,320
thread after using it and i can click

1041
00:33:44,320 --> 00:33:46,000
through those things

1042
00:33:46,000 --> 00:33:47,360
and then of course my data right it's

1043
00:33:47,360 --> 00:33:48,720
like it's pretty

1044
00:33:48,720 --> 00:33:51,039
but it's hiding some things

1045
00:33:51,039 --> 00:33:53,919
um this is what it looks like on top and

1046
00:33:53,919 --> 00:33:55,600
this is just what a subset of it looks

1047
00:33:55,600 --> 00:33:57,039
like when you go start looking at the

1048
00:33:57,039 --> 00:33:59,679
paths the attackers are taking

1049
00:33:59,679 --> 00:34:01,360
this is not fun to look at either this

1050
00:34:01,360 --> 00:34:03,360
is very messy

1051
00:34:03,360 --> 00:34:04,960
we'll instead look at a subset of it

1052
00:34:04,960 --> 00:34:06,399
well now we're starting to see hey if

1053
00:34:06,399 --> 00:34:07,919
i'm an engineer trying to figure out

1054
00:34:07,919 --> 00:34:09,280
where i want to apply my mitigations

1055
00:34:09,280 --> 00:34:11,280
maybe i'm starting to understand that

1056
00:34:11,280 --> 00:34:14,560
i want to put things on my server layer

1057
00:34:14,560 --> 00:34:16,239
because it looks like my aggregated

1058
00:34:16,239 --> 00:34:17,918
attacks are mostly coming through my

1059
00:34:17,918 --> 00:34:20,000
server layer either as a malicious

1060
00:34:20,000 --> 00:34:22,239
action probably using credentials

1061
00:34:22,239 --> 00:34:24,560
or as an error

1062
00:34:24,560 --> 00:34:26,719
but this is still a little dirty what if

1063
00:34:26,719 --> 00:34:29,520
instead i start to look at the path even

1064
00:34:29,520 --> 00:34:31,359
as a couple bar charts i look at what

1065
00:34:31,359 --> 00:34:33,199
action happened first

1066
00:34:33,199 --> 00:34:34,639
what actions happen the middle what's

1067
00:34:34,639 --> 00:34:36,079
happening last

1068
00:34:36,079 --> 00:34:38,000
i'm adding additional context that i

1069
00:34:38,000 --> 00:34:40,320
didn't have that was obfuscated when i

1070
00:34:40,320 --> 00:34:42,079
looked at this

1071
00:34:42,079 --> 00:34:43,520
from a

1072
00:34:43,520 --> 00:34:46,960
point of a single bar graph

1073
00:34:47,119 --> 00:34:49,440
moving on to the budgeting right we just

1074
00:34:49,440 --> 00:34:51,839
kind of picked our one to end list

1075
00:34:51,839 --> 00:34:53,359
now what if we go and we build out the

1076
00:34:53,359 --> 00:34:54,960
attack flows for it now we're saying

1077
00:34:54,960 --> 00:34:56,079
okay

1078
00:34:56,079 --> 00:34:58,320
this mitigation right here helps with

1079
00:34:58,320 --> 00:35:00,800
this right vulnerability management

1080
00:35:00,800 --> 00:35:04,240
probably helps with all of our servers

1081
00:35:04,240 --> 00:35:06,079
two-factor authentication probably helps

1082
00:35:06,079 --> 00:35:07,520
where we authenticate email filtering

1083
00:35:07,520 --> 00:35:08,880
helps where we

1084
00:35:08,880 --> 00:35:10,560
handle emails

1085
00:35:10,560 --> 00:35:12,800
now we can put this together and say hey

1086
00:35:12,800 --> 00:35:14,320
what we want to do

1087
00:35:14,320 --> 00:35:15,760
is we want to do a couple of things

1088
00:35:15,760 --> 00:35:16,800
together

1089
00:35:16,800 --> 00:35:18,640
as a group because they add together

1090
00:35:18,640 --> 00:35:21,040
they form kind of a single boundary

1091
00:35:21,040 --> 00:35:22,640
and then we want to do these two things

1092
00:35:22,640 --> 00:35:24,000
together because they form the next

1093
00:35:24,000 --> 00:35:25,280
boundary

1094
00:35:25,280 --> 00:35:26,640
and then the next thing is to form the

1095
00:35:26,640 --> 00:35:28,720
next property we can make decisions

1096
00:35:28,720 --> 00:35:29,599
about

1097
00:35:29,599 --> 00:35:33,280
mitigations that complement each other

1098
00:35:33,280 --> 00:35:35,359
and finally that discussion right this

1099
00:35:35,359 --> 00:35:37,599
kind of awkward discussion that

1100
00:35:37,599 --> 00:35:39,359
many of us have had in some form or

1101
00:35:39,359 --> 00:35:40,400
fashion

1102
00:35:40,400 --> 00:35:42,560
what if instead of saying oh this

1103
00:35:42,560 --> 00:35:44,320
vulnerability is happening we said this

1104
00:35:44,320 --> 00:35:46,800
attack path is happening and when we ask

1105
00:35:46,800 --> 00:35:48,560
are we at risk we say well we went back

1106
00:35:48,560 --> 00:35:50,000
and we looked at that path we pulled

1107
00:35:50,000 --> 00:35:52,000
that path out of our data and we've

1108
00:35:52,000 --> 00:35:53,599
tested our phishing defenses and we've

1109
00:35:53,599 --> 00:35:54,640
tested

1110
00:35:54,640 --> 00:35:56,960
um our malware response and the

1111
00:35:56,960 --> 00:35:59,040
likelihood of malware

1112
00:35:59,040 --> 00:36:01,119
saying on the system is this number the

1113
00:36:01,119 --> 00:36:03,040
malware likelihood of being fish is this

1114
00:36:03,040 --> 00:36:04,079
and when we add this together even

1115
00:36:04,079 --> 00:36:05,520
though we know that we're vulnerable to

1116
00:36:05,520 --> 00:36:08,400
the exploit the overall path is low and

1117
00:36:08,400 --> 00:36:09,839
we can say that confidently because we

1118
00:36:09,839 --> 00:36:11,839
queried a data set that we are storing

1119
00:36:11,839 --> 00:36:13,440
that's storing information about the

1120
00:36:13,440 --> 00:36:15,280
structure of our organization

1121
00:36:15,280 --> 00:36:17,359
the story and information about our red

1122
00:36:17,359 --> 00:36:18,560
team results

1123
00:36:18,560 --> 00:36:20,240
and storing information

1124
00:36:20,240 --> 00:36:22,480
about what assets live and what the

1125
00:36:22,480 --> 00:36:26,240
likelihood is from our phishing results

1126
00:36:26,240 --> 00:36:28,560
and so there's even more benefits we get

1127
00:36:28,560 --> 00:36:31,680
from the ecosystem itself

1128
00:36:31,680 --> 00:36:34,160
all this i've done with like open free

1129
00:36:34,160 --> 00:36:36,240
stuff

1130
00:36:36,240 --> 00:36:38,000
but the nice thing is like academics

1131
00:36:38,000 --> 00:36:40,000
have been working on rdf for years and

1132
00:36:40,000 --> 00:36:42,079
years and a decade

1133
00:36:42,079 --> 00:36:46,160
plus now and they built a bunch of stuff

1134
00:36:46,160 --> 00:36:47,440
like that's the good news the bad news

1135
00:36:47,440 --> 00:36:49,280
is they built it all in java but you

1136
00:36:49,280 --> 00:36:50,000
know

1137
00:36:50,000 --> 00:36:51,520
you can live with that

1138
00:36:51,520 --> 00:36:53,839
um there's databases there's graph

1139
00:36:53,839 --> 00:36:55,839
databases there's every other type of

1140
00:36:55,839 --> 00:36:56,960
database

1141
00:36:56,960 --> 00:36:58,960
there's huge numbers of file formats if

1142
00:36:58,960 --> 00:37:00,720
you like your data tabular you can do

1143
00:37:00,720 --> 00:37:03,839
that if you like your data in xml

1144
00:37:03,839 --> 00:37:05,280
i'd like to introduce you to other data

1145
00:37:05,280 --> 00:37:08,880
sites but you can use that there's json

1146
00:37:08,880 --> 00:37:11,359
tab uh tab deleted human readable things

1147
00:37:11,359 --> 00:37:13,520
you name it there's a format that fits

1148
00:37:13,520 --> 00:37:15,839
how you want to use the data

1149
00:37:15,839 --> 00:37:17,920
and then because it can be structured

1150
00:37:17,920 --> 00:37:19,839
however it can be stored however and

1151
00:37:19,839 --> 00:37:21,920
there's even like api tools there's

1152
00:37:21,920 --> 00:37:24,160
validation tools there's programming

1153
00:37:24,160 --> 00:37:26,880
tools visualization tools editing tools

1154
00:37:26,880 --> 00:37:29,200
querying tools analysis tools all these

1155
00:37:29,200 --> 00:37:31,119
things already exist for us because

1156
00:37:31,119 --> 00:37:33,520
we're working in a known

1157
00:37:33,520 --> 00:37:36,640
ecosystem and there's huge stores of

1158
00:37:36,640 --> 00:37:39,280
data there aren't great structures for

1159
00:37:39,280 --> 00:37:41,200
um security data

1160
00:37:41,200 --> 00:37:43,040
there are great structures for every

1161
00:37:43,040 --> 00:37:44,400
other type of data in the world in fact

1162
00:37:44,400 --> 00:37:45,119
like

1163
00:37:45,119 --> 00:37:47,200
this is this data set that are the data

1164
00:37:47,200 --> 00:37:48,720
structure that google uses to build

1165
00:37:48,720 --> 00:37:50,880
structured data into web pages

1166
00:37:50,880 --> 00:37:52,560
you know and it's all machine to machine

1167
00:37:52,560 --> 00:37:54,400
readable we don't have to be in the

1168
00:37:54,400 --> 00:37:56,079
middle of it and that's good

1169
00:37:56,079 --> 00:37:58,240
because the reality is not everyone

1170
00:37:58,240 --> 00:37:59,520
wants to be looking at this kind of

1171
00:37:59,520 --> 00:38:00,720
stuff

1172
00:38:00,720 --> 00:38:03,280
there's more we can add we can define

1173
00:38:03,280 --> 00:38:05,839
sub flows so i can say this this subset

1174
00:38:05,839 --> 00:38:07,440
of things happens often to me does it

1175
00:38:07,440 --> 00:38:09,119
happen often to you

1176
00:38:09,119 --> 00:38:10,880
we can both define those and say what

1177
00:38:10,880 --> 00:38:13,599
things are common between us

1178
00:38:13,599 --> 00:38:15,280
and so going back to visualization this

1179
00:38:15,280 --> 00:38:16,800
is important because the first place

1180
00:38:16,800 --> 00:38:18,480
people want to approach this data

1181
00:38:18,480 --> 00:38:19,599
is

1182
00:38:19,599 --> 00:38:22,640
as a visual graph

1183
00:38:22,640 --> 00:38:23,599
if you want to know more about

1184
00:38:23,599 --> 00:38:25,520
visualization i gave a talk on a

1185
00:38:25,520 --> 00:38:27,359
microsoft bluehound 2019 graph

1186
00:38:27,359 --> 00:38:29,680
visualization and one of the things is

1187
00:38:29,680 --> 00:38:31,200
that after a while you don't want to

1188
00:38:31,200 --> 00:38:32,560
look at graphs

1189
00:38:32,560 --> 00:38:34,720
you just want to use the data

1190
00:38:34,720 --> 00:38:35,920
but it's important to kind of go through

1191
00:38:35,920 --> 00:38:37,280
an example here this is something i

1192
00:38:37,280 --> 00:38:41,119
pulled out of a threat report

1193
00:38:41,119 --> 00:38:42,880
have a nice graph like and right but you

1194
00:38:42,880 --> 00:38:44,160
read this you're like hey i know more

1195
00:38:44,160 --> 00:38:45,280
things

1196
00:38:45,280 --> 00:38:46,960
and if i were to ask you okay go put

1197
00:38:46,960 --> 00:38:50,400
those into practice you're gonna go well

1198
00:38:50,400 --> 00:38:53,040
i guess i patched this right

1199
00:38:53,040 --> 00:38:54,800
i go well but how do you go how are you

1200
00:38:54,800 --> 00:38:56,000
gonna apply this to your system and then

1201
00:38:56,000 --> 00:38:57,920
well no right like

1202
00:38:57,920 --> 00:38:59,920
i can't apply this graph i comply

1203
00:38:59,920 --> 00:39:02,079
knowledge i gained from it i can't apply

1204
00:39:02,079 --> 00:39:03,040
this

1205
00:39:03,040 --> 00:39:04,720
but what if we go structure it as a tech

1206
00:39:04,720 --> 00:39:05,760
flow

1207
00:39:05,760 --> 00:39:07,839
the attacker exploits something over

1208
00:39:07,839 --> 00:39:08,880
here and i've left out the properties

1209
00:39:08,880 --> 00:39:10,800
but you can define the type of exploit

1210
00:39:10,800 --> 00:39:12,079
on a server

1211
00:39:12,079 --> 00:39:13,200
which then

1212
00:39:13,200 --> 00:39:15,359
using data that it also sent

1213
00:39:15,359 --> 00:39:18,960
runs a loader which then adds code

1214
00:39:18,960 --> 00:39:20,960
we can look at this from the attack team

1215
00:39:20,960 --> 00:39:22,560
perspective

1216
00:39:22,560 --> 00:39:23,760
there's the other side later you can

1217
00:39:23,760 --> 00:39:26,320
take a picture of

1218
00:39:26,320 --> 00:39:27,440
and here we're looking at just the

1219
00:39:27,440 --> 00:39:29,599
actions where the server the asset is

1220
00:39:29,599 --> 00:39:31,520
the relationship between them and so

1221
00:39:31,520 --> 00:39:34,160
this might be how a red person wants to

1222
00:39:34,160 --> 00:39:35,680
think about it

1223
00:39:35,680 --> 00:39:37,359
you know the blue side might want to

1224
00:39:37,359 --> 00:39:39,440
think in terms of assets

1225
00:39:39,440 --> 00:39:41,359
with the actions being on the edges you

1226
00:39:41,359 --> 00:39:42,560
know i'm thinking about what's happening

1227
00:39:42,560 --> 00:39:43,839
in the server the data and the code

1228
00:39:43,839 --> 00:39:45,280
being loaded

1229
00:39:45,280 --> 00:39:47,520
and then finally you can look at it all

1230
00:39:47,520 --> 00:39:49,839
back together and one of the things

1231
00:39:49,839 --> 00:39:52,160
that i want to add is if you look at it

1232
00:39:52,160 --> 00:39:53,520
all together you get to carry this

1233
00:39:53,520 --> 00:39:55,200
additional information

1234
00:39:55,200 --> 00:39:57,520
and so you can say not just these things

1235
00:39:57,520 --> 00:39:59,599
are related but here is the requirement

1236
00:39:59,599 --> 00:40:01,599
for this exploit to work

1237
00:40:01,599 --> 00:40:02,560
right

1238
00:40:02,560 --> 00:40:04,720
and here is a state change imposed on

1239
00:40:04,720 --> 00:40:06,480
this server and the server being

1240
00:40:06,480 --> 00:40:08,800
compromised is a requirement

1241
00:40:08,800 --> 00:40:10,560
for the loader to run

1242
00:40:10,560 --> 00:40:11,839
and you can put this data into a

1243
00:40:11,839 --> 00:40:13,359
structured data set

1244
00:40:13,359 --> 00:40:15,599
where you can analyze it and use it with

1245
00:40:15,599 --> 00:40:17,040
all your other data you can share it

1246
00:40:17,040 --> 00:40:19,200
with other people you can get their data

1247
00:40:19,200 --> 00:40:20,960
and we can all actually put things to

1248
00:40:20,960 --> 00:40:21,920
use

1249
00:40:21,920 --> 00:40:22,720
but

1250
00:40:22,720 --> 00:40:24,240
you may not want to always look at it

1251
00:40:24,240 --> 00:40:25,920
right like you start to get complex

1252
00:40:25,920 --> 00:40:28,000
attacks and they start to get busy

1253
00:40:28,000 --> 00:40:29,119
um there's a few things that are

1254
00:40:29,119 --> 00:40:30,720
important for visualizing this kind of

1255
00:40:30,720 --> 00:40:34,240
data like grouping together nodes um

1256
00:40:34,240 --> 00:40:36,000
or putting box but

1257
00:40:36,000 --> 00:40:37,680
you know what i want to do i want to

1258
00:40:37,680 --> 00:40:40,000
display it like this

1259
00:40:40,000 --> 00:40:41,520
i've got my

1260
00:40:41,520 --> 00:40:43,280
assets

1261
00:40:43,280 --> 00:40:45,359
i've got my actions as lines i can build

1262
00:40:45,359 --> 00:40:46,800
this as an interactive visualization i

1263
00:40:46,800 --> 00:40:48,400
can scroll around in it

1264
00:40:48,400 --> 00:40:50,400
this is an easy way to show the same

1265
00:40:50,400 --> 00:40:51,920
thing just because we're using grass

1266
00:40:51,920 --> 00:40:54,480
doesn't mean we have to look at grass

1267
00:40:54,480 --> 00:40:55,440
you know

1268
00:40:55,440 --> 00:40:58,319
and that's important

1269
00:40:58,400 --> 00:41:01,280
because as we go into the future

1270
00:41:01,280 --> 00:41:02,319
right

1271
00:41:02,319 --> 00:41:04,800
this is a schema this is not your single

1272
00:41:04,800 --> 00:41:06,240
pane of glass this doesn't solve all

1273
00:41:06,240 --> 00:41:08,480
your problems it's a foundation to build

1274
00:41:08,480 --> 00:41:09,520
on

1275
00:41:09,520 --> 00:41:11,359
and that means building

1276
00:41:11,359 --> 00:41:12,079
now

1277
00:41:12,079 --> 00:41:13,839
it's possible to build bad things on a

1278
00:41:13,839 --> 00:41:15,040
good foundation like i don't want to

1279
00:41:15,040 --> 00:41:18,240
give you like i'm excited about this you

1280
00:41:18,240 --> 00:41:20,480
know you may be too i don't want to set

1281
00:41:20,480 --> 00:41:23,440
you up and have you feel disappointed

1282
00:41:23,440 --> 00:41:25,520
because there's things to be built

1283
00:41:25,520 --> 00:41:26,560
right and some people don't want to

1284
00:41:26,560 --> 00:41:27,839
build things right

1285
00:41:27,839 --> 00:41:29,280
some people just want to like buy the

1286
00:41:29,280 --> 00:41:31,280
finished house and that's okay that's

1287
00:41:31,280 --> 00:41:34,079
how homebuilders make their money

1288
00:41:34,079 --> 00:41:36,960
as my homebuilder knows

1289
00:41:36,960 --> 00:41:38,319
[Music]

1290
00:41:38,319 --> 00:41:39,599
so that's okay and not everyone's going

1291
00:41:39,599 --> 00:41:42,000
to get it because the prego paper that

1292
00:41:42,000 --> 00:41:43,359
you know google published years and

1293
00:41:43,359 --> 00:41:45,040
years ago they described thinking like a

1294
00:41:45,040 --> 00:41:47,520
node and that's not something everyone

1295
00:41:47,520 --> 00:41:49,280
wants to do or anyone can do and that's

1296
00:41:49,280 --> 00:41:50,400
okay

1297
00:41:50,400 --> 00:41:54,240
a tactile can meet you where you are

1298
00:41:54,240 --> 00:41:56,400
and so to help people with that

1299
00:41:56,400 --> 00:41:57,520
we're working on things like

1300
00:41:57,520 --> 00:41:59,040
documentation

1301
00:41:59,040 --> 00:42:00,480
you know we showed you like here's what

1302
00:42:00,480 --> 00:42:02,720
the day looks like before and after i'm

1303
00:42:02,720 --> 00:42:04,400
working on getting your documentation so

1304
00:42:04,400 --> 00:42:07,680
that you can do that process yourself

1305
00:42:07,680 --> 00:42:09,760
we're also looking at building training

1306
00:42:09,760 --> 00:42:11,200
so you know i said hey you're going to

1307
00:42:11,200 --> 00:42:13,520
enter information into this web app you

1308
00:42:13,520 --> 00:42:14,880
know i want there to be videos so you

1309
00:42:14,880 --> 00:42:16,560
can watch someone else do it to help

1310
00:42:16,560 --> 00:42:18,240
train you on how to do that

1311
00:42:18,240 --> 00:42:19,839
and then we're working on improved

1312
00:42:19,839 --> 00:42:20,880
tooling

1313
00:42:20,880 --> 00:42:22,240
and that means

1314
00:42:22,240 --> 00:42:24,720
more and quicker ways to enter data

1315
00:42:24,720 --> 00:42:26,640
it means easier ways to query the data

1316
00:42:26,640 --> 00:42:29,279
if you've ever seen the

1317
00:42:29,359 --> 00:42:31,599
dot links uh storm query language i

1318
00:42:31,599 --> 00:42:34,720
really like it at mirrors r's implier

1319
00:42:34,720 --> 00:42:35,920
verbs

1320
00:42:35,920 --> 00:42:37,359
it's a great query language i'd like to

1321
00:42:37,359 --> 00:42:40,560
see that usable for a tag flow

1322
00:42:40,560 --> 00:42:42,560
and it also means better visualizations

1323
00:42:42,560 --> 00:42:45,599
easy push button stuff for

1324
00:42:45,599 --> 00:42:47,520
whatever kind of user you are whether

1325
00:42:47,520 --> 00:42:49,119
you're a red team user or blue team or

1326
00:42:49,119 --> 00:42:51,839
an executive

1327
00:42:51,839 --> 00:42:53,040
and

1328
00:42:53,040 --> 00:42:53,920
you know while we're talking about

1329
00:42:53,920 --> 00:42:55,760
things the future

1330
00:42:55,760 --> 00:42:57,440
we want to talk about maybe some of the

1331
00:42:57,440 --> 00:42:59,680
more advanced things right because

1332
00:42:59,680 --> 00:43:01,920
we said action right

1333
00:43:01,920 --> 00:43:03,280
there's nothing in there that says it's

1334
00:43:03,280 --> 00:43:05,200
attacker actions

1335
00:43:05,200 --> 00:43:06,880
we're using it that way

1336
00:43:06,880 --> 00:43:08,960
but what if i describe

1337
00:43:08,960 --> 00:43:11,359
normal behavior as actions i can start

1338
00:43:11,359 --> 00:43:13,040
documenting how my system normally

1339
00:43:13,040 --> 00:43:14,400
operates

1340
00:43:14,400 --> 00:43:17,680
or what about interdependencies um haas

1341
00:43:17,680 --> 00:43:18,800
keynote

1342
00:43:18,800 --> 00:43:22,079
um i assume i was running pbj and i

1343
00:43:22,079 --> 00:43:23,680
missed it

1344
00:43:23,680 --> 00:43:26,079
talked about how what i would call what

1345
00:43:26,079 --> 00:43:27,359
he calls resilience what i would call

1346
00:43:27,359 --> 00:43:28,560
blast rate is

1347
00:43:28,560 --> 00:43:31,040
the effect of one system having an

1348
00:43:31,040 --> 00:43:33,359
adverse state on other systems

1349
00:43:33,359 --> 00:43:34,960
that's just an action this system

1350
00:43:34,960 --> 00:43:36,880
changes state that has an action of

1351
00:43:36,880 --> 00:43:38,960
changing the state of another system you

1352
00:43:38,960 --> 00:43:40,720
know this one's availability is

1353
00:43:40,720 --> 00:43:42,079
compromised that one is this one's

1354
00:43:42,079 --> 00:43:43,599
integrity is compromised this one's a

1355
00:43:43,599 --> 00:43:45,520
table we can start to build that blast

1356
00:43:45,520 --> 00:43:47,680
radius as a structured set of data or

1357
00:43:47,680 --> 00:43:50,079
even response right i can say if this

1358
00:43:50,079 --> 00:43:52,000
system is in this state i'm going to

1359
00:43:52,000 --> 00:43:54,640
take this response action you know and

1360
00:43:54,640 --> 00:43:56,400
document that in the exact same language

1361
00:43:56,400 --> 00:43:58,319
as we've documented everything else

1362
00:43:58,319 --> 00:44:00,960
and that opens up a lot of opportunities

1363
00:44:00,960 --> 00:44:04,000
right the first is just structuring path

1364
00:44:04,000 --> 00:44:06,720
data right now all of our data is logs

1365
00:44:06,720 --> 00:44:08,079
and it's all sequential what would be

1366
00:44:08,079 --> 00:44:10,640
great is if we actually were given the

1367
00:44:10,640 --> 00:44:12,560
causal paths between

1368
00:44:12,560 --> 00:44:15,280
our log events and i actually know um

1369
00:44:15,280 --> 00:44:16,720
some organizations that are working on

1370
00:44:16,720 --> 00:44:17,520
it

1371
00:44:17,520 --> 00:44:19,440
um additionally

1372
00:44:19,440 --> 00:44:21,520
you know what if we weren't companies

1373
00:44:21,520 --> 00:44:23,440
that can provide enrichment so i

1374
00:44:23,440 --> 00:44:25,680
mentioned vertex they sell enrichment

1375
00:44:25,680 --> 00:44:28,560
what if you had your organization's data

1376
00:44:28,560 --> 00:44:29,839
structure

1377
00:44:29,839 --> 00:44:31,440
you didn't want to really store all of

1378
00:44:31,440 --> 00:44:33,359
the

1379
00:44:33,359 --> 00:44:35,520
say the attack techniques and stuff what

1380
00:44:35,520 --> 00:44:36,640
if you just wanted to call into someone

1381
00:44:36,640 --> 00:44:38,240
else's database of what all the threat

1382
00:44:38,240 --> 00:44:40,480
actors were so when you saw this ttp you

1383
00:44:40,480 --> 00:44:42,000
go just query theirs and you link their

1384
00:44:42,000 --> 00:44:44,800
data into your data and it looks like a

1385
00:44:44,800 --> 00:44:46,720
seamless graph database

1386
00:44:46,720 --> 00:44:48,560
from your perspective but on the back

1387
00:44:48,560 --> 00:44:50,480
end it's all being linked together from

1388
00:44:50,480 --> 00:44:53,119
all the other disparate sources

1389
00:44:53,119 --> 00:44:54,079
and then

1390
00:44:54,079 --> 00:44:55,760
what we need better analysis there's

1391
00:44:55,760 --> 00:44:57,680
opportunity to write analysis against

1392
00:44:57,680 --> 00:44:59,280
the data and there's opportunity to

1393
00:44:59,280 --> 00:45:01,280
build automation automation of red teams

1394
00:45:01,280 --> 00:45:03,440
automation of

1395
00:45:03,440 --> 00:45:05,280
defense and blue teams

1396
00:45:05,280 --> 00:45:07,040
and finally for incident response

1397
00:45:07,040 --> 00:45:08,720
there's the ability to apply things like

1398
00:45:08,720 --> 00:45:10,480
link prediction so

1399
00:45:10,480 --> 00:45:11,920
in graphs you can use machine learning

1400
00:45:11,920 --> 00:45:13,200
to say hey

1401
00:45:13,200 --> 00:45:14,800
given the graph we see

1402
00:45:14,800 --> 00:45:17,520
there may be edges that we don't see

1403
00:45:17,520 --> 00:45:20,240
and so we can say um

1404
00:45:20,240 --> 00:45:21,760
we've done this incident response this

1405
00:45:21,760 --> 00:45:23,040
is what we've seen so far this is our

1406
00:45:23,040 --> 00:45:24,800
attack flow

1407
00:45:24,800 --> 00:45:26,160
uh machine learning model are there any

1408
00:45:26,160 --> 00:45:28,319
edges that maybe we missed and it goes

1409
00:45:28,319 --> 00:45:29,920
hey have you considered this edge that

1410
00:45:29,920 --> 00:45:31,599
this action was taken related to this

1411
00:45:31,599 --> 00:45:32,960
asset

1412
00:45:32,960 --> 00:45:34,720
and that gives you another place to look

1413
00:45:34,720 --> 00:45:36,079
in your response

1414
00:45:36,079 --> 00:45:37,920
for things the attacker may have done

1415
00:45:37,920 --> 00:45:40,000
that you didn't know about and so

1416
00:45:40,000 --> 00:45:42,800
attack flow really is the next step in

1417
00:45:42,800 --> 00:45:45,440
information security data and

1418
00:45:45,440 --> 00:45:47,280
if you want to go get involved or go

1419
00:45:47,280 --> 00:45:49,280
look at it these two repos are the place

1420
00:45:49,280 --> 00:45:50,480
to start

1421
00:45:50,480 --> 00:45:53,839
miters repo it has the json schema the

1422
00:45:53,839 --> 00:45:54,800
builder

1423
00:45:54,800 --> 00:45:56,960
a little bit of markdown to explain it

1424
00:45:56,960 --> 00:45:58,000
also

1425
00:45:58,000 --> 00:46:01,040
the bottom one is the graph schema

1426
00:46:01,040 --> 00:46:03,040
as well as the code to convert between

1427
00:46:03,040 --> 00:46:04,319
the two

1428
00:46:04,319 --> 00:46:05,920
um and the reality is this is probably

1429
00:46:05,920 --> 00:46:07,599
going to leave you with more questions

1430
00:46:07,599 --> 00:46:09,119
or many questions

1431
00:46:09,119 --> 00:46:10,640
um and so

1432
00:46:10,640 --> 00:46:12,160
because this is very new this is

1433
00:46:12,160 --> 00:46:13,839
something that just was published in i

1434
00:46:13,839 --> 00:46:16,079
think april

1435
00:46:16,079 --> 00:46:18,160
reach out i'm here to help i want to see

1436
00:46:18,160 --> 00:46:19,760
this i think it is really important for

1437
00:46:19,760 --> 00:46:22,079
the industry to move on and how we

1438
00:46:22,079 --> 00:46:24,560
structure data i get a lot of security

1439
00:46:24,560 --> 00:46:26,319
data um

1440
00:46:26,319 --> 00:46:29,040
i get a lot of security data

1441
00:46:29,040 --> 00:46:31,359
and so the opportunity to improve howie

1442
00:46:31,359 --> 00:46:33,920
structure data is very central to my

1443
00:46:33,920 --> 00:46:35,520
interests

1444
00:46:35,520 --> 00:46:37,599
and so reach out i can help i'm looking

1445
00:46:37,599 --> 00:46:40,000
to help and i would love to open it up

1446
00:46:40,000 --> 00:46:41,680
for questions but i've got 10 minutes to

1447
00:46:41,680 --> 00:46:44,480
get back to pros versus joe's to help in

1448
00:46:44,480 --> 00:46:49,319
their game and so thank you very much

