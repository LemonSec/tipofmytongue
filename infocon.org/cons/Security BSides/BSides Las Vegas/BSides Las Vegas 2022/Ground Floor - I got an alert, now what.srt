1
00:00:00,060 --> 00:00:02,639
all right good morning everyone thank

2
00:00:02,639 --> 00:00:04,319
you for coming for the first talk good

3
00:00:04,319 --> 00:00:07,280
good morning everyone

4
00:00:07,280 --> 00:00:08,760
[Applause]

5
00:00:08,760 --> 00:00:11,460
there we go oh God I hate when people do

6
00:00:11,460 --> 00:00:14,580
that all right so uh I have I I have my

7
00:00:14,580 --> 00:00:16,079
little talk I Gotta Give real quick so

8
00:00:16,079 --> 00:00:17,340
I'll do this real quick before we

9
00:00:17,340 --> 00:00:19,439
introduce uh first good morning everyone

10
00:00:19,439 --> 00:00:21,119
okay I did that all right good morning

11
00:00:21,119 --> 00:00:22,740
everyone and welcome to besides Las

12
00:00:22,740 --> 00:00:23,460
Vegas

13
00:00:23,460 --> 00:00:25,740
this is the

14
00:00:25,740 --> 00:00:28,320
uh the ground floor look I'm doing so

15
00:00:28,320 --> 00:00:29,880
many so welcome to the ground floor

16
00:00:29,880 --> 00:00:31,260
track

17
00:00:31,260 --> 00:00:33,420
um this talk is

18
00:00:33,420 --> 00:00:37,079
I got an alert now what so uh and of

19
00:00:37,079 --> 00:00:39,059
course it's given by uh Kellen Benson

20
00:00:39,059 --> 00:00:40,500
we're very pleased to have you here

21
00:00:40,500 --> 00:00:41,820
thank you so much for coming and

22
00:00:41,820 --> 00:00:44,100
speaking uh a few investments before we

23
00:00:44,100 --> 00:00:46,500
begin uh sponsors of course we need you

24
00:00:46,500 --> 00:00:48,600
to thank our sponsors the uh they are

25
00:00:48,600 --> 00:00:50,460
the uh the companies and the people who

26
00:00:50,460 --> 00:00:52,620
make that happen we'd like to thank our

27
00:00:52,620 --> 00:00:54,960
Diamond sponsors LastPass and Palo Alto

28
00:00:54,960 --> 00:00:57,420
networks of course and our gold sponsors

29
00:00:57,420 --> 00:01:00,600
blue cat Google and Intel oh so uh

30
00:01:00,600 --> 00:01:02,160
absolutely vital to making all this come

31
00:01:02,160 --> 00:01:04,559
down and and working so along with the

32
00:01:04,559 --> 00:01:06,540
support staff and the people who have

33
00:01:06,540 --> 00:01:09,060
been vital in making the actual b-sides

34
00:01:09,060 --> 00:01:12,299
possible so as a reminder uh cell phones

35
00:01:12,299 --> 00:01:14,460
these talks are being streamed live and

36
00:01:14,460 --> 00:01:16,320
they are being recorded you do not need

37
00:01:16,320 --> 00:01:17,759
to record you do not need to take

38
00:01:17,759 --> 00:01:21,240
pictures so please silence your phone uh

39
00:01:21,240 --> 00:01:23,880
as a reminder the policy for taking

40
00:01:23,880 --> 00:01:25,979
pictures is if you were to even take a

41
00:01:25,979 --> 00:01:27,420
picture you were supposed to make sure

42
00:01:27,420 --> 00:01:29,520
you have everyone's permission if

43
00:01:29,520 --> 00:01:30,720
they're in the background of the picture

44
00:01:30,720 --> 00:01:32,880
right we're very sensitive to making

45
00:01:32,880 --> 00:01:34,799
sure we're taking being the privacy of

46
00:01:34,799 --> 00:01:36,840
people very serious especially within

47
00:01:36,840 --> 00:01:39,900
the community we're within so I do ask

48
00:01:39,900 --> 00:01:42,000
if you have a question please step up to

49
00:01:42,000 --> 00:01:44,399
the mic use the mic it's not so much for

50
00:01:44,399 --> 00:01:46,860
us but because it's being recorded that

51
00:01:46,860 --> 00:01:49,079
makes sure that question gets on the

52
00:01:49,079 --> 00:01:51,180
recording so people who see it later can

53
00:01:51,180 --> 00:01:53,399
hear your question as well uh of course

54
00:01:53,399 --> 00:01:54,659
Kelly if you always repeat the question

55
00:01:54,659 --> 00:01:56,159
before you answer it that's always nice

56
00:01:56,159 --> 00:01:57,899
too so

57
00:01:57,899 --> 00:01:59,040
um

58
00:01:59,040 --> 00:02:01,320
as a reminder yeah I just talked about

59
00:02:01,320 --> 00:02:03,840
that for the policy uh with that let's

60
00:02:03,840 --> 00:02:06,180
get started so I'll pass it off to you

61
00:02:06,180 --> 00:02:08,160
thank you so much awesome

62
00:02:08,160 --> 00:02:10,560
let me here we go okay cool

63
00:02:10,560 --> 00:02:12,599
thank you all for being here I really

64
00:02:12,599 --> 00:02:13,980
appreciate it

65
00:02:13,980 --> 00:02:16,739
um welcome to a talk called I got an

66
00:02:16,739 --> 00:02:20,280
alert now what uh before we get started

67
00:02:20,280 --> 00:02:21,660
just want to introduce myself very

68
00:02:21,660 --> 00:02:23,220
quickly my name is Kellen Benson my

69
00:02:23,220 --> 00:02:25,140
pronouns are they them I work at Red

70
00:02:25,140 --> 00:02:28,260
Canary as a senior incident Handler

71
00:02:28,260 --> 00:02:31,019
um where I put out fires for people it's

72
00:02:31,019 --> 00:02:32,459
pretty fun

73
00:02:32,459 --> 00:02:35,220
um and there's a little bit about myself

74
00:02:35,220 --> 00:02:37,140
I'm a pop punk Enthusiast if there's

75
00:02:37,140 --> 00:02:38,879
karaoke later this week you might see me

76
00:02:38,879 --> 00:02:41,640
doing some Paramore so uh look out for

77
00:02:41,640 --> 00:02:43,260
that but that's not why you're here

78
00:02:43,260 --> 00:02:44,760
you're here to learn about I got an

79
00:02:44,760 --> 00:02:47,220
alert now what

80
00:02:47,220 --> 00:02:48,660
sorry I want to go back to that if you

81
00:02:48,660 --> 00:02:49,680
want to reach out to me Twitter's the

82
00:02:49,680 --> 00:02:51,000
best place to do it I have LinkedIn but

83
00:02:51,000 --> 00:02:53,040
I don't check it so just find me on

84
00:02:53,040 --> 00:02:54,720
Twitter

85
00:02:54,720 --> 00:02:56,099
um

86
00:02:56,099 --> 00:03:00,180
so I got an alert now what I had some

87
00:03:00,180 --> 00:03:02,159
friends that I was talking to and one of

88
00:03:02,159 --> 00:03:03,540
them was a newer person who was like Hey

89
00:03:03,540 --> 00:03:05,400
I when I get an alert

90
00:03:05,400 --> 00:03:08,099
what should I do and my first response

91
00:03:08,099 --> 00:03:10,440
was well you investigate it and then I

92
00:03:10,440 --> 00:03:13,440
realized that's a horrible answer

93
00:03:13,440 --> 00:03:15,959
um I did the thing that senior people do

94
00:03:15,959 --> 00:03:17,580
where they're like I'm gonna shortcut

95
00:03:17,580 --> 00:03:18,959
everything that I know and just give you

96
00:03:18,959 --> 00:03:20,519
the short answer which isn't very

97
00:03:20,519 --> 00:03:22,440
helpful to new people so I went through

98
00:03:22,440 --> 00:03:23,940
this process of

99
00:03:23,940 --> 00:03:26,340
what actually do I do when I get an

100
00:03:26,340 --> 00:03:28,019
alert what's my methodology how do I

101
00:03:28,019 --> 00:03:30,900
investigate this thing

102
00:03:30,900 --> 00:03:32,280
um and I think that's really helpful to

103
00:03:32,280 --> 00:03:34,080
do as people with experience in the

104
00:03:34,080 --> 00:03:36,120
industry because not only are you

105
00:03:36,120 --> 00:03:37,860
sharing information to someone you get

106
00:03:37,860 --> 00:03:39,720
to check yourself for gaps and think

107
00:03:39,720 --> 00:03:42,360
like oh did I miss a step or is there

108
00:03:42,360 --> 00:03:44,280
something I could do better here

109
00:03:44,280 --> 00:03:44,940
um

110
00:03:44,940 --> 00:03:46,560
so that's really what I did here that's

111
00:03:46,560 --> 00:03:48,060
what this talk is about to walk through

112
00:03:48,060 --> 00:03:51,239
what my methodology is and some people

113
00:03:51,239 --> 00:03:53,159
um along the way who help me and it's

114
00:03:53,159 --> 00:03:54,480
not really going to jump into tools a

115
00:03:54,480 --> 00:03:55,620
whole lot we might touch on some things

116
00:03:55,620 --> 00:03:57,420
lightly but it very much is a

117
00:03:57,420 --> 00:03:59,519
methodology based thing

118
00:03:59,519 --> 00:04:02,580
so let's Dive In

119
00:04:02,580 --> 00:04:05,939
we're going to touch on we have an alert

120
00:04:05,939 --> 00:04:07,439
um what do you do when you get an alert

121
00:04:07,439 --> 00:04:09,180
so we'll we'll dig into that a little

122
00:04:09,180 --> 00:04:11,280
bit we need to figure out what the alert

123
00:04:11,280 --> 00:04:13,140
is actually telling us just because you

124
00:04:13,140 --> 00:04:14,519
have a blinky red light doesn't mean you

125
00:04:14,519 --> 00:04:16,259
know what to do with it so we need to

126
00:04:16,259 --> 00:04:17,880
understand why the Blinky red light is

127
00:04:17,880 --> 00:04:20,160
on and what we need to look at to

128
00:04:20,160 --> 00:04:22,620
understand that blinking red light

129
00:04:22,620 --> 00:04:25,139
what is interesting about the data that

130
00:04:25,139 --> 00:04:27,900
we have in that alert as well as is it

131
00:04:27,900 --> 00:04:31,500
even a threat like do we care and if it

132
00:04:31,500 --> 00:04:33,300
is a threat what do we do next

133
00:04:33,300 --> 00:04:34,440
and then we're going to do a little bit

134
00:04:34,440 --> 00:04:36,000
of what if because

135
00:04:36,000 --> 00:04:37,620
the world's not perfect and sometimes we

136
00:04:37,620 --> 00:04:39,000
can't answer all of our questions with

137
00:04:39,000 --> 00:04:41,720
the data we have

138
00:04:41,880 --> 00:04:43,680
so here's our alert

139
00:04:43,680 --> 00:04:46,740
we have a high severity

140
00:04:46,740 --> 00:04:50,880
alert that says Excel launch

141
00:04:50,880 --> 00:04:53,280
a suspicious program and we see the

142
00:04:53,280 --> 00:04:55,080
command line here that we see okay we

143
00:04:55,080 --> 00:04:58,800
have excel.exe and summer budget 22 xlsx

144
00:04:58,800 --> 00:05:01,500
probably very safe very fine budget

145
00:05:01,500 --> 00:05:03,419
spreadsheets are normal

146
00:05:03,419 --> 00:05:04,199
um

147
00:05:04,199 --> 00:05:05,699
but

148
00:05:05,699 --> 00:05:07,680
that that's something we need to take

149
00:05:07,680 --> 00:05:09,600
into account here is like what is this

150
00:05:09,600 --> 00:05:11,820
alert telling us and do we care

151
00:05:11,820 --> 00:05:14,719
on top of that

152
00:05:14,940 --> 00:05:17,240
um sorry

153
00:05:18,180 --> 00:05:19,860
we don't have a ton of data here

154
00:05:19,860 --> 00:05:21,539
sometimes when we get an alert we only

155
00:05:21,539 --> 00:05:23,520
get like bits and pieces of data and we

156
00:05:23,520 --> 00:05:25,740
really have to dig in um and we don't

157
00:05:25,740 --> 00:05:27,479
get to necessarily see the logic behind

158
00:05:27,479 --> 00:05:28,919
that alert and we have to come together

159
00:05:28,919 --> 00:05:32,520
and come to some conclusions

160
00:05:32,520 --> 00:05:35,580
um based on what we have so

161
00:05:35,580 --> 00:05:37,740
let's try to understand what this alert

162
00:05:37,740 --> 00:05:41,039
is telling us and if it's actually true

163
00:05:41,039 --> 00:05:44,100
we need to understand did Excel launch a

164
00:05:44,100 --> 00:05:45,240
program

165
00:05:45,240 --> 00:05:47,940
if it launched a program is that program

166
00:05:47,940 --> 00:05:50,039
actually suspicious or is it normal do

167
00:05:50,039 --> 00:05:52,020
we care

168
00:05:52,020 --> 00:05:54,180
and

169
00:05:54,180 --> 00:05:55,919
yeah so let's just dig into that

170
00:05:55,919 --> 00:05:57,360
all right

171
00:05:57,360 --> 00:05:58,560
so

172
00:05:58,560 --> 00:06:00,960
if we had a data point if we have like

173
00:06:00,960 --> 00:06:04,080
an EDR we had sysmon we had a Sim

174
00:06:04,080 --> 00:06:06,360
something like that we have logs of some

175
00:06:06,360 --> 00:06:07,919
kind we might be able to grab a

176
00:06:07,919 --> 00:06:11,699
processed tree for what happened here

177
00:06:11,699 --> 00:06:12,840
um this really depends on your data

178
00:06:12,840 --> 00:06:14,100
we're just going to assume we have good

179
00:06:14,100 --> 00:06:17,580
data life is good everything's perfect

180
00:06:17,580 --> 00:06:19,500
um and

181
00:06:19,500 --> 00:06:21,180
because of that we have a full processor

182
00:06:21,180 --> 00:06:23,940
stream we can see Excel launched reg svr

183
00:06:23,940 --> 00:06:26,819
32 or red serve 32 we can find about how

184
00:06:26,819 --> 00:06:28,259
you want to pronounce that later it's

185
00:06:28,259 --> 00:06:30,000
totally up to you

186
00:06:30,000 --> 00:06:30,720
um

187
00:06:30,720 --> 00:06:33,000
but it launched red serve 32 and then

188
00:06:33,000 --> 00:06:35,660
off of that we have a module load of EF

189
00:06:35,660 --> 00:06:38,819
HJ Dot dll

190
00:06:38,819 --> 00:06:40,919
um we'll get to that but just take note

191
00:06:40,919 --> 00:06:43,080
that's our process tree

192
00:06:43,080 --> 00:06:45,300
um we have this Excel file

193
00:06:45,300 --> 00:06:47,940
that opens and led to register 32

194
00:06:47,940 --> 00:06:48,900
opening

195
00:06:48,900 --> 00:06:51,120
which we should probably grab the hash

196
00:06:51,120 --> 00:06:52,919
of that Excel file for investigating we

197
00:06:52,919 --> 00:06:54,360
have the name of that file these are

198
00:06:54,360 --> 00:06:55,500
important little things just to take

199
00:06:55,500 --> 00:06:57,599
note of as we investigate

200
00:06:57,599 --> 00:06:58,259
um

201
00:06:58,259 --> 00:07:00,360
and then we'll want to dig into register

202
00:07:00,360 --> 00:07:03,080
of 32.

203
00:07:04,380 --> 00:07:06,479
but we need to understand like I said

204
00:07:06,479 --> 00:07:07,800
we're trying to understand is this

205
00:07:07,800 --> 00:07:10,440
suspicious or is this normal in order to

206
00:07:10,440 --> 00:07:11,520
make a determination if something is

207
00:07:11,520 --> 00:07:13,259
suspicious or normal we need to know

208
00:07:13,259 --> 00:07:15,840
what it actually does

209
00:07:15,840 --> 00:07:19,979
um you know and so the way to do that to

210
00:07:19,979 --> 00:07:21,599
the Google machine or Bing if you're

211
00:07:21,599 --> 00:07:22,620
into that

212
00:07:22,620 --> 00:07:24,120
um

213
00:07:24,120 --> 00:07:25,440
so

214
00:07:25,440 --> 00:07:27,900
red serve 32 was launched what is it

215
00:07:27,900 --> 00:07:30,000
what it was what is its purpose

216
00:07:30,000 --> 00:07:31,500
um a quick search of this you're gonna

217
00:07:31,500 --> 00:07:33,199
land at a Microsoft dock of what

218
00:07:33,199 --> 00:07:36,780
regserv32 is and it registers dll files

219
00:07:36,780 --> 00:07:39,479
as command components in the registry

220
00:07:39,479 --> 00:07:41,340
okay

221
00:07:41,340 --> 00:07:43,139
if we think back a little bit we saw a

222
00:07:43,139 --> 00:07:45,120
module load of

223
00:07:45,120 --> 00:07:47,280
EF HJ

224
00:07:47,280 --> 00:07:48,780
Dot dll

225
00:07:48,780 --> 00:07:50,220
so we're registering that as a command

226
00:07:50,220 --> 00:07:53,099
in the registry is that normal

227
00:07:53,099 --> 00:07:55,680
I don't know yet we're gonna find out

228
00:07:55,680 --> 00:07:56,819
um I see some head shaking in the

229
00:07:56,819 --> 00:07:58,080
audience which is fun

230
00:07:58,080 --> 00:08:01,139
um so you're already steps ahead of me

231
00:08:01,139 --> 00:08:02,819
um but

232
00:08:02,819 --> 00:08:04,440
we don't necessarily know if that's

233
00:08:04,440 --> 00:08:06,180
normal or suspicious I mean could that

234
00:08:06,180 --> 00:08:08,400
dll be normal efhj could be an

235
00:08:08,400 --> 00:08:10,379
abbreviation for something an acronym I

236
00:08:10,379 --> 00:08:13,740
don't know or maybe it's just very bad

237
00:08:13,740 --> 00:08:15,539
um so we're gonna grab the hash of that

238
00:08:15,539 --> 00:08:17,699
we likely have the hash of that when the

239
00:08:17,699 --> 00:08:20,340
file was written or when the module was

240
00:08:20,340 --> 00:08:22,080
loaded uh depending upon your data

241
00:08:22,080 --> 00:08:24,240
source you can grab it from there

242
00:08:24,240 --> 00:08:25,020
um

243
00:08:25,020 --> 00:08:26,460
so

244
00:08:26,460 --> 00:08:29,960
let's move forward here

245
00:08:31,319 --> 00:08:34,380
so these are our points of interest

246
00:08:34,380 --> 00:08:38,339
we have an Excel file with a hash we

247
00:08:38,339 --> 00:08:39,179
have

248
00:08:39,179 --> 00:08:41,519
we have a dll

249
00:08:41,519 --> 00:08:44,760
with a hash and then we have regserv but

250
00:08:44,760 --> 00:08:46,440
that maybe it's interesting maybe it's

251
00:08:46,440 --> 00:08:48,360
not these two things probably the most

252
00:08:48,360 --> 00:08:49,740
interesting bits of information we have

253
00:08:49,740 --> 00:08:51,720
so far

254
00:08:51,720 --> 00:08:54,120
what do we do with that

255
00:08:54,120 --> 00:08:57,000
is it the important next question

256
00:08:57,000 --> 00:08:59,120
um

257
00:08:59,700 --> 00:09:01,920
sorry

258
00:09:01,920 --> 00:09:04,040
um

259
00:09:05,279 --> 00:09:08,040
but first wait if you're looking at a

260
00:09:08,040 --> 00:09:09,360
process tree

261
00:09:09,360 --> 00:09:11,940
you might say something like this where

262
00:09:11,940 --> 00:09:13,080
you're like

263
00:09:13,080 --> 00:09:15,540
hey register of 32 didn't just load that

264
00:09:15,540 --> 00:09:17,279
module it did all these other things

265
00:09:17,279 --> 00:09:20,519
that's kind of interesting

266
00:09:20,519 --> 00:09:21,660
pause

267
00:09:21,660 --> 00:09:23,640
don't go down the rabbit hole too early

268
00:09:23,640 --> 00:09:26,459
it's really easy to get lost while

269
00:09:26,459 --> 00:09:28,019
you're investigating when you're trying

270
00:09:28,019 --> 00:09:29,640
to triage things and deal with the alert

271
00:09:29,640 --> 00:09:30,899
initially

272
00:09:30,899 --> 00:09:33,480
and end up like I'm gonna go dig into

273
00:09:33,480 --> 00:09:36,240
jeon.exe

274
00:09:36,240 --> 00:09:37,860
been there done that and then I lost

275
00:09:37,860 --> 00:09:39,360
track of what I was originally doing and

276
00:09:39,360 --> 00:09:41,519
it's been like 30 45 minutes and I

277
00:09:41,519 --> 00:09:43,320
haven't actually triage my alert and

278
00:09:43,320 --> 00:09:45,839
made an important decision which

279
00:09:45,839 --> 00:09:47,940
well it was fun and maybe I found

280
00:09:47,940 --> 00:09:50,040
something neat my alert's still sitting

281
00:09:50,040 --> 00:09:52,980
there and we haven't done anything so

282
00:09:52,980 --> 00:09:54,600
don't go down the rabbit hole too early

283
00:09:54,600 --> 00:09:56,519
at this point what I would probably do

284
00:09:56,519 --> 00:09:58,140
is just take note of those names take

285
00:09:58,140 --> 00:10:00,420
note of the hashes if you have them and

286
00:10:00,420 --> 00:10:02,760
put it off to the side because what we

287
00:10:02,760 --> 00:10:04,260
really need to dig into is that initial

288
00:10:04,260 --> 00:10:06,560
piece of the alert we know Excel program

289
00:10:06,560 --> 00:10:09,720
dll with that we can probably come to a

290
00:10:09,720 --> 00:10:11,160
pretty good conclusion

291
00:10:11,160 --> 00:10:14,959
so let's let's keep going

292
00:10:18,480 --> 00:10:20,839
let's keep going with those artifacts

293
00:10:20,839 --> 00:10:23,399
obligatory pyramid of pain if you're not

294
00:10:23,399 --> 00:10:25,200
familiar with the Pyramid of pain we're

295
00:10:25,200 --> 00:10:27,240
going to talk about it now

296
00:10:27,240 --> 00:10:30,660
um so what we have are artifacts or

297
00:10:30,660 --> 00:10:33,240
potential indicators of compromise

298
00:10:33,240 --> 00:10:36,120
what is an indicator of compromise

299
00:10:36,120 --> 00:10:38,519
I defined it as a thing we can observe

300
00:10:38,519 --> 00:10:41,339
in our data that allows us to identify a

301
00:10:41,339 --> 00:10:44,640
threat at the moment or going forward in

302
00:10:44,640 --> 00:10:48,300
our detections so there's some

303
00:10:48,300 --> 00:10:50,160
difficulties that come with getting

304
00:10:50,160 --> 00:10:51,839
indicators of compromise some are very

305
00:10:51,839 --> 00:10:55,500
easy biohashes IP addresses and domain

306
00:10:55,500 --> 00:10:58,140
names if you've ever gotten a report

307
00:10:58,140 --> 00:11:00,600
from a three-letter agency or read an

308
00:11:00,600 --> 00:11:02,640
Intel report from the internet you

309
00:11:02,640 --> 00:11:04,740
probably have those things to go throw

310
00:11:04,740 --> 00:11:07,380
into your sim dig into that data look

311
00:11:07,380 --> 00:11:09,360
for it in your environment

312
00:11:09,360 --> 00:11:11,760
those are very easy to find and search

313
00:11:11,760 --> 00:11:13,200
for

314
00:11:13,200 --> 00:11:15,300
um and then detect on in the future but

315
00:11:15,300 --> 00:11:16,920
those things can change they rotate

316
00:11:16,920 --> 00:11:18,839
quickly and

317
00:11:18,839 --> 00:11:20,700
honestly you're not always going to be

318
00:11:20,700 --> 00:11:22,140
able to find those things because

319
00:11:22,140 --> 00:11:24,060
attackers change what they're doing

320
00:11:24,060 --> 00:11:25,920
so we look for network and host

321
00:11:25,920 --> 00:11:28,140
artifacts we look for tools and we look

322
00:11:28,140 --> 00:11:31,140
for tactics techniques and procedures

323
00:11:31,140 --> 00:11:33,540
those become more difficult to identify

324
00:11:33,540 --> 00:11:35,519
but also then write detections on and

325
00:11:35,519 --> 00:11:38,160
create alerts on if you are a person who

326
00:11:38,160 --> 00:11:39,959
writes detections you probably know that

327
00:11:39,959 --> 00:11:42,839
writing behavioral detections is a pain

328
00:11:42,839 --> 00:11:46,920
um I see nods so yeah so that is that's

329
00:11:46,920 --> 00:11:48,360
what an indicator of compromise is and

330
00:11:48,360 --> 00:11:50,160
we're going to leverage those

331
00:11:50,160 --> 00:11:52,079
to hopefully come to some conclusions

332
00:11:52,079 --> 00:11:55,219
about what we're looking into

333
00:11:55,320 --> 00:11:57,420
so what I would do is I'd go

334
00:11:57,420 --> 00:11:59,519
virus total what else are we going to do

335
00:11:59,519 --> 00:12:01,139
where else are you gonna put a hash

336
00:12:01,139 --> 00:12:03,480
but wait

337
00:12:03,480 --> 00:12:05,220
I'm gonna take this moment to jump on a

338
00:12:05,220 --> 00:12:06,720
little bit of a soapbox here about

339
00:12:06,720 --> 00:12:08,760
virustotal

340
00:12:08,760 --> 00:12:10,740
um because I've made this mistake and

341
00:12:10,740 --> 00:12:12,000
I've seen other people make this mistake

342
00:12:12,000 --> 00:12:13,139
and maybe you don't even know it's a

343
00:12:13,139 --> 00:12:14,399
mistake and you don't know because you

344
00:12:14,399 --> 00:12:16,260
don't know what you don't know

345
00:12:16,260 --> 00:12:17,100
um

346
00:12:17,100 --> 00:12:22,079
don't submit your files to virus total

347
00:12:22,079 --> 00:12:25,380
um because they can end up public facing

348
00:12:25,380 --> 00:12:28,139
and that can expose your data your

349
00:12:28,139 --> 00:12:31,860
company's data to the internet

350
00:12:31,860 --> 00:12:33,420
um as we all know the internet is a very

351
00:12:33,420 --> 00:12:35,100
safe place and it's a great place to

352
00:12:35,100 --> 00:12:37,820
store your data right

353
00:12:39,540 --> 00:12:42,060
um on top of that depending upon your

354
00:12:42,060 --> 00:12:43,380
threat model

355
00:12:43,380 --> 00:12:45,660
you might tip off threat actors that you

356
00:12:45,660 --> 00:12:47,579
have their tool you've detected it and

357
00:12:47,579 --> 00:12:48,779
now they're going to burn that and then

358
00:12:48,779 --> 00:12:51,120
switch it up and your indicators of

359
00:12:51,120 --> 00:12:53,160
compromise are no longer good that's a

360
00:12:53,160 --> 00:12:55,260
little bit secondary but it's still

361
00:12:55,260 --> 00:12:57,060
something to keep in mind the main thing

362
00:12:57,060 --> 00:12:59,760
is don't upload your files because you

363
00:12:59,760 --> 00:13:00,899
don't want your company's data on the

364
00:13:00,899 --> 00:13:01,860
internet

365
00:13:01,860 --> 00:13:03,420
um if you don't know if you have a

366
00:13:03,420 --> 00:13:05,279
policy or procedure around that at the

367
00:13:05,279 --> 00:13:07,200
place you work you now have homework

368
00:13:07,200 --> 00:13:08,639
you're welcome I've given you an action

369
00:13:08,639 --> 00:13:11,399
item your managers will be thrilled

370
00:13:11,399 --> 00:13:12,180
um

371
00:13:12,180 --> 00:13:14,639
so take that back find out if you do

372
00:13:14,639 --> 00:13:15,899
have a Palestine procedure around that

373
00:13:15,899 --> 00:13:18,779
if you don't make one it's easy share it

374
00:13:18,779 --> 00:13:21,120
with people let them know what can

375
00:13:21,120 --> 00:13:22,920
happen if you do that

376
00:13:22,920 --> 00:13:24,480
um all right

377
00:13:24,480 --> 00:13:26,880
I'm gonna get off my soapbox now

378
00:13:26,880 --> 00:13:28,260
um about that and we're gonna keep

379
00:13:28,260 --> 00:13:30,560
moving

380
00:13:31,320 --> 00:13:33,240
so is it a threat

381
00:13:33,240 --> 00:13:36,060
maybe maybe not we have these hashes

382
00:13:36,060 --> 00:13:37,860
we're going to search them

383
00:13:37,860 --> 00:13:39,300
um

384
00:13:39,300 --> 00:13:41,160
let's move into that

385
00:13:41,160 --> 00:13:43,320
we're going to start with regserve 32

386
00:13:43,320 --> 00:13:44,220
though

387
00:13:44,220 --> 00:13:48,600
because there's a potential hang up here

388
00:13:48,600 --> 00:13:50,760
when we search this on virus total we

389
00:13:50,760 --> 00:13:52,800
get the results back that hey

390
00:13:52,800 --> 00:13:55,380
this was distributed by Microsoft

391
00:13:55,380 --> 00:13:58,380
it's signed by Microsoft no vendors

392
00:13:58,380 --> 00:14:00,660
detect this as malicious

393
00:14:00,660 --> 00:14:03,240
so we're good to go right everything's

394
00:14:03,240 --> 00:14:06,240
fine no not at all

395
00:14:06,240 --> 00:14:09,540
um you can leverage clean binaries to do

396
00:14:09,540 --> 00:14:10,980
evil

397
00:14:10,980 --> 00:14:12,720
um it happens all the time you've

398
00:14:12,720 --> 00:14:14,459
probably heard about a good friend

399
00:14:14,459 --> 00:14:16,920
Powershell and all the terrible and

400
00:14:16,920 --> 00:14:18,959
wonderful things Powershell can do

401
00:14:18,959 --> 00:14:21,540
but when you search that also clean hash

402
00:14:21,540 --> 00:14:24,560
signed by Microsoft good binary right

403
00:14:24,560 --> 00:14:26,699
maybe not

404
00:14:26,699 --> 00:14:28,380
um a little bit of story time I've been

405
00:14:28,380 --> 00:14:30,420
at places where

406
00:14:30,420 --> 00:14:34,920
the alert was suspicious Powershell

407
00:14:34,920 --> 00:14:37,620
okay cool is Powershell suspicious or is

408
00:14:37,620 --> 00:14:39,360
it what Powershell did

409
00:14:39,360 --> 00:14:41,639
the analysis of that was Powershell

410
00:14:41,639 --> 00:14:44,959
clean hash close alert

411
00:14:46,800 --> 00:14:50,779
that didn't turn out well

412
00:14:51,120 --> 00:14:54,180
um there was I don't remember what it

413
00:14:54,180 --> 00:14:56,940
escalated to but it was not good and it

414
00:14:56,940 --> 00:14:58,740
went everywhere

415
00:14:58,740 --> 00:15:01,139
so bear that in mind just because you

416
00:15:01,139 --> 00:15:03,240
have a clean hash doesn't mean the thing

417
00:15:03,240 --> 00:15:05,160
you have is safe

418
00:15:05,160 --> 00:15:06,779
um it's like a chainsaw chainsaws are

419
00:15:06,779 --> 00:15:08,639
good for cutting up things are they safe

420
00:15:08,639 --> 00:15:11,639
maybe depends on how you use it that

421
00:15:11,639 --> 00:15:15,440
analogy I'm sorry we're gonna move on

422
00:15:15,600 --> 00:15:17,220
all right

423
00:15:17,220 --> 00:15:19,800
now let's look at the hashes of our

424
00:15:19,800 --> 00:15:21,300
other files

425
00:15:21,300 --> 00:15:23,339
and virus total

426
00:15:23,339 --> 00:15:25,980
it's evil very clearly a mermaid man has

427
00:15:25,980 --> 00:15:27,300
let us know this

428
00:15:27,300 --> 00:15:28,920
um unfortunately virus total doesn't

429
00:15:28,920 --> 00:15:30,420
show you Mermaid Man when you use it I'm

430
00:15:30,420 --> 00:15:31,500
sorry

431
00:15:31,500 --> 00:15:34,500
um but when we searched the hash of our

432
00:15:34,500 --> 00:15:37,019
Excel file we have 29 vendors that

433
00:15:37,019 --> 00:15:39,720
detected this thing as bad

434
00:15:39,720 --> 00:15:43,440
and then with our dll we have 56. the

435
00:15:43,440 --> 00:15:45,120
denominator here changes I don't know

436
00:15:45,120 --> 00:15:47,220
why some vendors are in some lists and

437
00:15:47,220 --> 00:15:48,180
some aren't

438
00:15:48,180 --> 00:15:50,279
um talk to virus total not me I

439
00:15:50,279 --> 00:15:52,639
apologize

440
00:15:58,740 --> 00:16:01,920
Okay so what have we done so far let's

441
00:16:01,920 --> 00:16:03,540
recap we have

442
00:16:03,540 --> 00:16:06,120
got an alert we understood our alert we

443
00:16:06,120 --> 00:16:08,339
understood that Excel launched a program

444
00:16:08,339 --> 00:16:11,459
that's suspicious based on the hashes we

445
00:16:11,459 --> 00:16:12,360
have

446
00:16:12,360 --> 00:16:13,980
we now know we have suspicious hatches

447
00:16:13,980 --> 00:16:15,240
which we can call our indicators of

448
00:16:15,240 --> 00:16:16,380
compromise

449
00:16:16,380 --> 00:16:17,639
and we can move forward with that

450
00:16:17,639 --> 00:16:19,740
information to ask more questions and

451
00:16:19,740 --> 00:16:21,540
get more data to help us make an

452
00:16:21,540 --> 00:16:23,519
informed decision

453
00:16:23,519 --> 00:16:24,300
um

454
00:16:24,300 --> 00:16:27,060
the next thing I would do is

455
00:16:27,060 --> 00:16:29,339
who is the threat and I'm not saying is

456
00:16:29,339 --> 00:16:31,560
this wizard lizard spider is this a

457
00:16:31,560 --> 00:16:33,540
nation state like

458
00:16:33,540 --> 00:16:36,120
when I say who I mean what is our

459
00:16:36,120 --> 00:16:39,720
malware family what but what are we

460
00:16:39,720 --> 00:16:40,980
dealing with

461
00:16:40,980 --> 00:16:41,940
um we're not going to talk about

462
00:16:41,940 --> 00:16:43,199
attribution if you want to talk about

463
00:16:43,199 --> 00:16:46,819
attribution find me later at a bar

464
00:16:48,899 --> 00:16:52,199
so we can get information

465
00:16:52,199 --> 00:16:53,820
about

466
00:16:53,820 --> 00:16:56,519
who our threat is typically from our

467
00:16:56,519 --> 00:16:58,320
alert and if we can't get it from our

468
00:16:58,320 --> 00:16:59,699
alert we can probably grab it from virus

469
00:16:59,699 --> 00:17:01,860
total if our hashes are being detected

470
00:17:01,860 --> 00:17:03,959
um because when you search a hash in

471
00:17:03,959 --> 00:17:05,520
virusotal you're going to get the names

472
00:17:05,520 --> 00:17:07,559
of detections from all these vendors

473
00:17:07,559 --> 00:17:09,959
that say Hey this is Fab

474
00:17:09,959 --> 00:17:10,619
um

475
00:17:10,619 --> 00:17:12,900
in this case

476
00:17:12,900 --> 00:17:15,240
we see if you can see it on screen says

477
00:17:15,240 --> 00:17:17,760
imotab it's highlighted it was all over

478
00:17:17,760 --> 00:17:19,260
the page I only can give you a little

479
00:17:19,260 --> 00:17:21,539
bit of that but it was everywhere

480
00:17:21,539 --> 00:17:24,059
um so we can say with some decent

481
00:17:24,059 --> 00:17:25,980
confidence we're probably dealing with

482
00:17:25,980 --> 00:17:27,780
emotep

483
00:17:27,780 --> 00:17:29,700
um if we don't know what that is we're

484
00:17:29,700 --> 00:17:31,080
going to pretend we don't and we're

485
00:17:31,080 --> 00:17:32,280
going to go to the Google machine but

486
00:17:32,280 --> 00:17:33,900
first I want to talk about some other

487
00:17:33,900 --> 00:17:35,220
sources that you can go to be on

488
00:17:35,220 --> 00:17:37,260
virustotal if virusol doesn't have

489
00:17:37,260 --> 00:17:38,820
results highly recommend checking out

490
00:17:38,820 --> 00:17:40,980
malware Bazaar or triage

491
00:17:40,980 --> 00:17:42,480
um you can search hashes there as well

492
00:17:42,480 --> 00:17:45,059
and they tag their malware so you can

493
00:17:45,059 --> 00:17:46,980
see like oh is it emotec does it lead to

494
00:17:46,980 --> 00:17:49,020
something else it's great uh malware

495
00:17:49,020 --> 00:17:51,600
Bazaar is free triage requires a free

496
00:17:51,600 --> 00:17:53,400
account so you just have to sign up but

497
00:17:53,400 --> 00:17:54,360
it gives you some really good

498
00:17:54,360 --> 00:17:56,039
information about the binaries that

499
00:17:56,039 --> 00:17:57,960
you're searching as well great resource

500
00:17:57,960 --> 00:18:00,059
for Learning and trying to figure out

501
00:18:00,059 --> 00:18:01,740
what you may have

502
00:18:01,740 --> 00:18:03,799
um

503
00:18:04,679 --> 00:18:07,380
so with this I would feel comfortable

504
00:18:07,380 --> 00:18:09,120
saying this is emote

505
00:18:09,120 --> 00:18:09,720
um

506
00:18:09,720 --> 00:18:12,840
and dig in from there who's that Pokemon

507
00:18:12,840 --> 00:18:15,620
emotep

508
00:18:15,900 --> 00:18:18,480
all right now we have a Who

509
00:18:18,480 --> 00:18:20,820
and the reason I delineate from who and

510
00:18:20,820 --> 00:18:23,940
what is are who gets us to the what and

511
00:18:23,940 --> 00:18:27,120
the what is what is the threat

512
00:18:27,120 --> 00:18:28,679
and when I say what is the threat we

513
00:18:28,679 --> 00:18:31,140
need to know what is the behavior what

514
00:18:31,140 --> 00:18:32,820
are we looking for

515
00:18:32,820 --> 00:18:36,780
what does emotech do what's a demo

516
00:18:36,780 --> 00:18:39,660
when it lands in your environment what

517
00:18:39,660 --> 00:18:41,220
are its goals

518
00:18:41,220 --> 00:18:43,380
and when you can understand those goals

519
00:18:43,380 --> 00:18:45,780
you can understand impact which is what

520
00:18:45,780 --> 00:18:47,640
we as analysts are here to do is

521
00:18:47,640 --> 00:18:49,320
understand the impact of these threats

522
00:18:49,320 --> 00:18:51,299
to our environment and deal with that

523
00:18:51,299 --> 00:18:53,400
and that will help us to triage and

524
00:18:53,400 --> 00:18:55,919
escalate appropriately so is emotech

525
00:18:55,919 --> 00:18:57,780
going to move laterally is it going to

526
00:18:57,780 --> 00:19:00,120
dump credentials is it going to just

527
00:19:00,120 --> 00:19:02,400
change a background to something silly

528
00:19:02,400 --> 00:19:06,780
who knows let's let's dig further we're

529
00:19:06,780 --> 00:19:09,120
doing a lot of digging

530
00:19:09,120 --> 00:19:10,740
check out a shovel that's what I should

531
00:19:10,740 --> 00:19:12,360
have requested it was a shovel

532
00:19:12,360 --> 00:19:13,140
um

533
00:19:13,140 --> 00:19:14,400
okay

534
00:19:14,400 --> 00:19:15,780
so when you search emote you're gonna

535
00:19:15,780 --> 00:19:17,160
get a bunch of results uh I'm gonna

536
00:19:17,160 --> 00:19:18,840
shamelessly plug red Canary's threat

537
00:19:18,840 --> 00:19:20,039
detection report because it's a good

538
00:19:20,039 --> 00:19:22,020
resource even before I work there loved

539
00:19:22,020 --> 00:19:22,919
it

540
00:19:22,919 --> 00:19:25,320
um really good information but

541
00:19:25,320 --> 00:19:26,580
if you search emote you're going to get

542
00:19:26,580 --> 00:19:27,600
information

543
00:19:27,600 --> 00:19:29,160
um and

544
00:19:29,160 --> 00:19:30,900
in the threat detection report we see

545
00:19:30,900 --> 00:19:32,580
some important information I've

546
00:19:32,580 --> 00:19:34,860
highlighted or folded what I think are

547
00:19:34,860 --> 00:19:36,419
the most important bits to answer our

548
00:19:36,419 --> 00:19:38,400
question here which is

549
00:19:38,400 --> 00:19:40,620
emote is a downloader or a dropper of

550
00:19:40,620 --> 00:19:43,440
other malware so with that we know hey

551
00:19:43,440 --> 00:19:47,580
more malware which could be fun right

552
00:19:47,580 --> 00:19:50,280
um and its goal is to steal user data

553
00:19:50,280 --> 00:19:52,919
and banking credentials

554
00:19:52,919 --> 00:19:55,500
now it says banking credentials it's

555
00:19:55,500 --> 00:19:56,700
probably all your credentials and you're

556
00:19:56,700 --> 00:19:58,440
gonna have a bad day

557
00:19:58,440 --> 00:20:00,059
um because

558
00:20:00,059 --> 00:20:02,159
I have some feelings that emotec isn't

559
00:20:02,159 --> 00:20:04,080
gonna say well that doesn't say JP

560
00:20:04,080 --> 00:20:05,880
Morgan in the cred file

561
00:20:05,880 --> 00:20:08,039
they're gonna take everything

562
00:20:08,039 --> 00:20:09,840
um so now you have the ability to

563
00:20:09,840 --> 00:20:11,340
understand impact and what your threat

564
00:20:11,340 --> 00:20:13,080
is I do want to highlight one more bit

565
00:20:13,080 --> 00:20:14,760
here that it's disseminated through

566
00:20:14,760 --> 00:20:15,659
email

567
00:20:15,659 --> 00:20:17,700
links or attachments

568
00:20:17,700 --> 00:20:19,679
that's important to note for cleanup

569
00:20:19,679 --> 00:20:20,700
later

570
00:20:20,700 --> 00:20:23,840
um just bear that in mind

571
00:20:27,900 --> 00:20:30,120
yeah

572
00:20:30,120 --> 00:20:31,919
um

573
00:20:31,919 --> 00:20:34,440
so if threat

574
00:20:34,440 --> 00:20:36,539
then what

575
00:20:36,539 --> 00:20:39,120
um if we have a threat which I think at

576
00:20:39,120 --> 00:20:40,260
this point

577
00:20:40,260 --> 00:20:42,360
with the data that we've collected with

578
00:20:42,360 --> 00:20:44,100
the questions that we've asked the data

579
00:20:44,100 --> 00:20:45,780
points that we've seen

580
00:20:45,780 --> 00:20:48,000
we could probably arrive in a place that

581
00:20:48,000 --> 00:20:49,559
we probably have a threat on our

582
00:20:49,559 --> 00:20:52,559
computer we have Excel suspicious

583
00:20:52,559 --> 00:20:53,820
program

584
00:20:53,820 --> 00:20:56,880
virus total lights up on the Excel file

585
00:20:56,880 --> 00:20:58,740
and the dll

586
00:20:58,740 --> 00:21:02,340
and then if we remember back we have all

587
00:21:02,340 --> 00:21:04,679
those fun processes that came out of the

588
00:21:04,679 --> 00:21:08,280
register 32 that we took note of

589
00:21:08,280 --> 00:21:09,900
um

590
00:21:09,900 --> 00:21:12,840
we'll get to those but just keep that in

591
00:21:12,840 --> 00:21:13,799
mind

592
00:21:13,799 --> 00:21:14,700
um

593
00:21:14,700 --> 00:21:17,400
so with that my first step here is

594
00:21:17,400 --> 00:21:19,799
contain I don't want that endpoint on my

595
00:21:19,799 --> 00:21:21,299
Network anymore I don't want it to talk

596
00:21:21,299 --> 00:21:24,000
to anything something bad is happening

597
00:21:24,000 --> 00:21:25,559
um you can do that through whatever

598
00:21:25,559 --> 00:21:27,840
tools you have if you have an EDR hit

599
00:21:27,840 --> 00:21:29,700
the isolate button if you have Network

600
00:21:29,700 --> 00:21:32,940
tooling just get it off your network

601
00:21:32,940 --> 00:21:34,200
um

602
00:21:34,200 --> 00:21:36,240
so with that and then we move to

603
00:21:36,240 --> 00:21:37,919
eradicate

604
00:21:37,919 --> 00:21:40,500
when well pause we're gonna go back to

605
00:21:40,500 --> 00:21:42,720
contain because if we're going to

606
00:21:42,720 --> 00:21:44,820
contain we also need to ban those

607
00:21:44,820 --> 00:21:48,120
binaries in our environment without it

608
00:21:48,120 --> 00:21:49,980
with whatever tooling you have available

609
00:21:49,980 --> 00:21:51,179
um that's a little bit more difficult of

610
00:21:51,179 --> 00:21:52,380
a conversation if you have application

611
00:21:52,380 --> 00:21:54,419
block listing cool you can do it that

612
00:21:54,419 --> 00:21:57,240
way if you have that power through your

613
00:21:57,240 --> 00:21:58,799
EDR great if you have to push a really

614
00:21:58,799 --> 00:22:02,760
weird GPO do that I mean you know you

615
00:22:02,760 --> 00:22:03,960
got to do what you got to do to get the

616
00:22:03,960 --> 00:22:06,419
threat contained in your environment

617
00:22:06,419 --> 00:22:08,220
um and we're going to take action on

618
00:22:08,220 --> 00:22:10,980
that Excel file and that dll and then

619
00:22:10,980 --> 00:22:12,480
probably everything else that came off

620
00:22:12,480 --> 00:22:14,640
of that register 32 because

621
00:22:14,640 --> 00:22:17,220
we don't know what it did it looked sus

622
00:22:17,220 --> 00:22:19,440
so we should probably just deal with

623
00:22:19,440 --> 00:22:22,320
that now and ask questions later

624
00:22:22,320 --> 00:22:23,760
um

625
00:22:23,760 --> 00:22:25,500
so

626
00:22:25,500 --> 00:22:28,320
with that we've contained that endpoint

627
00:22:28,320 --> 00:22:31,020
but is this other places in our Network

628
00:22:31,020 --> 00:22:33,299
is it on other endpoints if it was

629
00:22:33,299 --> 00:22:34,799
delivered through email which we saw

630
00:22:34,799 --> 00:22:36,299
earlier

631
00:22:36,299 --> 00:22:39,780
do people typically only fish one person

632
00:22:39,780 --> 00:22:43,620
or is it your entire organization

633
00:22:43,620 --> 00:22:46,020
do you have email addresses facing on

634
00:22:46,020 --> 00:22:48,840
your website are they pushed from your

635
00:22:48,840 --> 00:22:51,000
people to their LinkedIn profiles you're

636
00:22:51,000 --> 00:22:52,260
probably getting a lot of phishing

637
00:22:52,260 --> 00:22:54,679
emails

638
00:22:54,780 --> 00:22:57,419
with some delicious emotat attached

639
00:22:57,419 --> 00:22:58,440
um

640
00:22:58,440 --> 00:23:00,299
so I would scope I would search for

641
00:23:00,299 --> 00:23:02,820
those hashes up that we have see if

642
00:23:02,820 --> 00:23:04,799
they're on other endpoints and repeat

643
00:23:04,799 --> 00:23:07,500
our contained phase we need to isolate

644
00:23:07,500 --> 00:23:09,600
those endpoints and then we need to

645
00:23:09,600 --> 00:23:12,480
eradicate our threat

646
00:23:12,480 --> 00:23:14,520
now

647
00:23:14,520 --> 00:23:17,100
with eradication and Recovery there

648
00:23:17,100 --> 00:23:20,039
comes an interesting question of

649
00:23:20,039 --> 00:23:23,100
do we go through each of these endpoints

650
00:23:23,100 --> 00:23:25,740
and clean up everything manually do we

651
00:23:25,740 --> 00:23:27,780
delete all these Excel files do we

652
00:23:27,780 --> 00:23:29,880
delete all these binaries do we look for

653
00:23:29,880 --> 00:23:32,340
you know was there a registry key that

654
00:23:32,340 --> 00:23:34,080
changed was there a scheduled task that

655
00:23:34,080 --> 00:23:35,820
was put into this device

656
00:23:35,820 --> 00:23:37,740
that's pretty tedious

657
00:23:37,740 --> 00:23:39,900
um you could do that if you wanted to do

658
00:23:39,900 --> 00:23:43,700
a full analysis of what happens

659
00:23:43,740 --> 00:23:45,659
I would say one box maybe to do that if

660
00:23:45,659 --> 00:23:46,799
you want to do the full investigation

661
00:23:46,799 --> 00:23:48,600
but

662
00:23:48,600 --> 00:23:50,400
I'm more of a re-image type of person

663
00:23:50,400 --> 00:23:51,659
when it comes to those situations

664
00:23:51,659 --> 00:23:54,539
because

665
00:23:54,539 --> 00:23:56,340
you could miss something

666
00:23:56,340 --> 00:23:58,860
uh story time

667
00:23:58,860 --> 00:24:01,679
uh when

668
00:24:01,679 --> 00:24:03,120
hold on we'll think about how to tell

669
00:24:03,120 --> 00:24:05,460
this story

670
00:24:05,460 --> 00:24:07,860
I've seen situations where people have

671
00:24:07,860 --> 00:24:10,020
manually cleaned up malware they thought

672
00:24:10,020 --> 00:24:12,720
they killed processes they deleted files

673
00:24:12,720 --> 00:24:15,000
they banned binaries

674
00:24:15,000 --> 00:24:16,860
few hours later

675
00:24:16,860 --> 00:24:18,539
hey your box is reinfected with the same

676
00:24:18,539 --> 00:24:19,260
thing

677
00:24:19,260 --> 00:24:21,840
how'd that happen I did the thing I

678
00:24:21,840 --> 00:24:22,860
cleaned it up

679
00:24:22,860 --> 00:24:25,679
well you missed persistence ah okay so

680
00:24:25,679 --> 00:24:27,600
we deleted the scheduled task

681
00:24:27,600 --> 00:24:29,159
a few hours later

682
00:24:29,159 --> 00:24:30,659
hey your box is infected again what

683
00:24:30,659 --> 00:24:33,179
happens well there was more persistence

684
00:24:33,179 --> 00:24:34,980
there was a registered fee there was

685
00:24:34,980 --> 00:24:37,799
this or that and like it's a problem you

686
00:24:37,799 --> 00:24:39,299
play whack-a-mole and it's a waste of

687
00:24:39,299 --> 00:24:40,260
time

688
00:24:40,260 --> 00:24:41,460
um

689
00:24:41,460 --> 00:24:43,740
I'm more of a ramage person

690
00:24:43,740 --> 00:24:44,940
um especially if something jumps into

691
00:24:44,940 --> 00:24:48,179
memory free image that's scary

692
00:24:48,179 --> 00:24:50,460
um if you want to have an argument about

693
00:24:50,460 --> 00:24:52,559
reimage versus manual cleanup I gladly

694
00:24:52,559 --> 00:24:54,539
have that one too that sounds like fun

695
00:24:54,539 --> 00:24:55,320
um

696
00:24:55,320 --> 00:24:58,260
but just keep that in mind as you do

697
00:24:58,260 --> 00:24:59,220
clean up

698
00:24:59,220 --> 00:25:01,140
um reimaging is usually a bit more

699
00:25:01,140 --> 00:25:03,480
efficient and faster

700
00:25:03,480 --> 00:25:05,039
great

701
00:25:05,039 --> 00:25:08,460
we got an alert we investigated it sorry

702
00:25:08,460 --> 00:25:10,620
did the thing again we

703
00:25:10,620 --> 00:25:13,559
got indicators of compromise we searched

704
00:25:13,559 --> 00:25:15,179
those indicators of compromise on the

705
00:25:15,179 --> 00:25:17,640
interwebs through virus total to

706
00:25:17,640 --> 00:25:20,460
understand what they are and what we

707
00:25:20,460 --> 00:25:21,840
were dealing with we got information

708
00:25:21,840 --> 00:25:23,880
that our threat was emotat

709
00:25:23,880 --> 00:25:26,100
we dug into what emoted actually is we

710
00:25:26,100 --> 00:25:28,080
evaluated what it could do in our

711
00:25:28,080 --> 00:25:29,400
environment

712
00:25:29,400 --> 00:25:32,279
and then we dealt with it

713
00:25:32,279 --> 00:25:34,760
great

714
00:25:35,640 --> 00:25:38,279
but sometimes you don't get all that

715
00:25:38,279 --> 00:25:39,960
information

716
00:25:39,960 --> 00:25:41,580
sometimes

717
00:25:41,580 --> 00:25:43,559
you don't have the full picture

718
00:25:43,559 --> 00:25:45,779
what if you don't what are the things

719
00:25:45,779 --> 00:25:47,640
that you can do

720
00:25:47,640 --> 00:25:49,620
to get more information and better

721
00:25:49,620 --> 00:25:53,000
understand what's happening

722
00:25:53,220 --> 00:25:56,220
we go down the rabbit hole of course

723
00:25:56,220 --> 00:25:56,880
um

724
00:25:56,880 --> 00:25:58,440
so

725
00:25:58,440 --> 00:26:00,960
the first question I would ask if I were

726
00:26:00,960 --> 00:26:02,880
in a situation where maybe those hashes

727
00:26:02,880 --> 00:26:05,159
didn't return malicious

728
00:26:05,159 --> 00:26:06,360
um or

729
00:26:06,360 --> 00:26:09,600
I just didn't fully see something that

730
00:26:09,600 --> 00:26:11,700
made me my Spider Sense tingle and go

731
00:26:11,700 --> 00:26:13,860
evil

732
00:26:13,860 --> 00:26:14,940
um

733
00:26:14,940 --> 00:26:17,100
I would start with the process tree and

734
00:26:17,100 --> 00:26:20,700
I'd work my way from where that Excel

735
00:26:20,700 --> 00:26:22,620
happened down the process tree which is

736
00:26:22,620 --> 00:26:25,260
where we see all those other things that

737
00:26:25,260 --> 00:26:26,400
came in

738
00:26:26,400 --> 00:26:28,620
and we'd investigate those the same way

739
00:26:28,620 --> 00:26:30,419
that we investigated the initial thing

740
00:26:30,419 --> 00:26:33,059
we would ask the question of what is

741
00:26:33,059 --> 00:26:34,919
this file what is it doing is it

742
00:26:34,919 --> 00:26:36,840
malicious can we make a determination on

743
00:26:36,840 --> 00:26:39,240
that and go through that

744
00:26:39,240 --> 00:26:41,279
um and

745
00:26:41,279 --> 00:26:43,919
did you know that this song would come

746
00:26:43,919 --> 00:26:46,200
into your investigation

747
00:26:46,200 --> 00:26:50,480
where did it come from where did it go

748
00:26:51,050 --> 00:26:53,100
[Music]

749
00:26:53,100 --> 00:26:55,380
um which is on a great question now

750
00:26:55,380 --> 00:26:56,159
you're going to remember it like that

751
00:26:56,159 --> 00:26:57,059
and every time you ask that question

752
00:26:57,059 --> 00:26:58,200
you're going to hear it as the lyric and

753
00:26:58,200 --> 00:26:59,580
you're welcome

754
00:26:59,580 --> 00:27:00,419
um

755
00:27:00,419 --> 00:27:03,659
so asking how did this get here how did

756
00:27:03,659 --> 00:27:06,059
that Excel file land on the device

757
00:27:06,059 --> 00:27:09,539
was it can I see it coming from a

758
00:27:09,539 --> 00:27:11,340
browser download can I see it coming

759
00:27:11,340 --> 00:27:12,299
from

760
00:27:12,299 --> 00:27:13,919
email

761
00:27:13,919 --> 00:27:14,760
um

762
00:27:14,760 --> 00:27:16,740
and where did it go from there which we

763
00:27:16,740 --> 00:27:17,940
jump back to the process tree a little

764
00:27:17,940 --> 00:27:18,720
bit

765
00:27:18,720 --> 00:27:20,340
but don't get caught up in processed

766
00:27:20,340 --> 00:27:22,140
trees all the time because things can

767
00:27:22,140 --> 00:27:24,600
break from the process tree and there's

768
00:27:24,600 --> 00:27:26,279
other things that can happen around that

769
00:27:26,279 --> 00:27:28,679
there have been times where I've seen

770
00:27:28,679 --> 00:27:32,159
data where I dead end at regsurf

771
00:27:32,159 --> 00:27:34,020
it just I see a mod load and that's it

772
00:27:34,020 --> 00:27:35,399
and that's all I got

773
00:27:35,399 --> 00:27:36,120
um

774
00:27:36,120 --> 00:27:37,919
and then I have to say Okay where did

775
00:27:37,919 --> 00:27:41,460
this actually go though and pull in more

776
00:27:41,460 --> 00:27:43,500
data look at a timeline and look at like

777
00:27:43,500 --> 00:27:46,500
you know five ten minutes around that to

778
00:27:46,500 --> 00:27:48,059
see if something else happened and I've

779
00:27:48,059 --> 00:27:50,700
been in situations where oh

780
00:27:50,700 --> 00:27:52,320
something touched lsas that wasn't

781
00:27:52,320 --> 00:27:54,299
supposed to we have credential dumping

782
00:27:54,299 --> 00:27:58,200
or a command prompt spawned and it's

783
00:27:58,200 --> 00:28:00,600
doing recon those types of things can

784
00:28:00,600 --> 00:28:02,880
happen and they cannot be necessarily

785
00:28:02,880 --> 00:28:04,740
attached to your process tree so just

786
00:28:04,740 --> 00:28:06,179
bear that in mind as you ask the where

787
00:28:06,179 --> 00:28:07,260
did it come from where did it go

788
00:28:07,260 --> 00:28:09,120
question and don't get tied up in your

789
00:28:09,120 --> 00:28:11,220
process tree

790
00:28:11,220 --> 00:28:13,320
if I'm like really stuck and those two

791
00:28:13,320 --> 00:28:15,360
things don't give me an answer like I'm

792
00:28:15,360 --> 00:28:17,520
not getting is this malicious from virus

793
00:28:17,520 --> 00:28:20,399
total I can't figure out exactly where

794
00:28:20,399 --> 00:28:22,200
this came from I'm not sure where it's

795
00:28:22,200 --> 00:28:25,559
going either like I need to start asking

796
00:28:25,559 --> 00:28:27,720
is this normal

797
00:28:27,720 --> 00:28:29,940
is this normal in my environment

798
00:28:29,940 --> 00:28:32,520
I usually start with the user and then

799
00:28:32,520 --> 00:28:34,500
go out from there

800
00:28:34,500 --> 00:28:37,140
um because sometimes

801
00:28:37,140 --> 00:28:38,820
it is normal for that user if you

802
00:28:38,820 --> 00:28:40,500
checked like a 30-day period if you have

803
00:28:40,500 --> 00:28:42,779
30 days of data um

804
00:28:42,779 --> 00:28:46,020
very lucky if you do you're you're doing

805
00:28:46,020 --> 00:28:46,860
great

806
00:28:46,860 --> 00:28:48,539
um but if you don't you can check

807
00:28:48,539 --> 00:28:49,799
whatever data you have to see if that

808
00:28:49,799 --> 00:28:51,299
happens regularly has it happened over

809
00:28:51,299 --> 00:28:53,039
the last seven days

810
00:28:53,039 --> 00:28:55,020
okay maybe not does this happen on the

811
00:28:55,020 --> 00:28:57,299
computer holistically

812
00:28:57,299 --> 00:28:58,860
um not necessarily relevant for this

813
00:28:58,860 --> 00:29:00,539
Excel file thing but generally speaking

814
00:29:00,539 --> 00:29:02,640
like does this weird thing happen on

815
00:29:02,640 --> 00:29:04,620
this device normally

816
00:29:04,620 --> 00:29:06,960
or scoping out to your environment

817
00:29:06,960 --> 00:29:10,020
that's an important step too because you

818
00:29:10,020 --> 00:29:11,700
might realize oh this is happening

819
00:29:11,700 --> 00:29:13,620
across the environment and it's weird we

820
00:29:13,620 --> 00:29:14,640
should probably document this and

821
00:29:14,640 --> 00:29:16,320
understand why it's happening why we're

822
00:29:16,320 --> 00:29:18,240
generating an alert on it

823
00:29:18,240 --> 00:29:20,100
and figure out if that alert alert is

824
00:29:20,100 --> 00:29:21,120
valid or not and then tune your

825
00:29:21,120 --> 00:29:23,580
detectors sorry more homework

826
00:29:23,580 --> 00:29:24,299
um

827
00:29:24,299 --> 00:29:26,520
the other thing is I want to jump back

828
00:29:26,520 --> 00:29:28,799
to the user thing a little bit because

829
00:29:28,799 --> 00:29:31,140
I've seen situations where Excel does

830
00:29:31,140 --> 00:29:33,299
some really wonky stuff and it's usually

831
00:29:33,299 --> 00:29:35,460
in the finance department

832
00:29:35,460 --> 00:29:37,260
and they're usually running macros and

833
00:29:37,260 --> 00:29:41,279
they have add-ons and it looks bad like

834
00:29:41,279 --> 00:29:43,260
real bad

835
00:29:43,260 --> 00:29:44,159
um

836
00:29:44,159 --> 00:29:46,559
but if you can understand why that's

837
00:29:46,559 --> 00:29:48,840
happening and if it's not bad you can

838
00:29:48,840 --> 00:29:50,279
write up some documentation to share

839
00:29:50,279 --> 00:29:51,600
with your team to say hey this is normal

840
00:29:51,600 --> 00:29:52,980
and then you don't waste time on that

841
00:29:52,980 --> 00:29:53,940
alert anymore and you don't have to be

842
00:29:53,940 --> 00:29:56,100
sad and you can look at cat pictures on

843
00:29:56,100 --> 00:29:59,178
the internet or something instead

844
00:30:01,200 --> 00:30:02,820
all right

845
00:30:02,820 --> 00:30:05,279
let's recap

846
00:30:05,279 --> 00:30:08,039
what do we do here today

847
00:30:08,039 --> 00:30:11,220
we evaluated what an alert was saying we

848
00:30:11,220 --> 00:30:13,380
took time to understand

849
00:30:13,380 --> 00:30:16,020
what the alert actually said which is

850
00:30:16,020 --> 00:30:17,820
important because we can end up on a

851
00:30:17,820 --> 00:30:19,799
totally different Trail

852
00:30:19,799 --> 00:30:22,020
if we're not paying attention to our

853
00:30:22,020 --> 00:30:24,179
original hypothesis which that's kind of

854
00:30:24,179 --> 00:30:25,679
how I view alerts is there a hypothesis

855
00:30:25,679 --> 00:30:27,480
about a threat that could live in your

856
00:30:27,480 --> 00:30:28,799
environment and you're going to prove or

857
00:30:28,799 --> 00:30:31,080
disprove them you're like a scientist

858
00:30:31,080 --> 00:30:33,240
sort of as long as you take notes it's

859
00:30:33,240 --> 00:30:34,620
science

860
00:30:34,620 --> 00:30:35,279
um

861
00:30:35,279 --> 00:30:36,960
so we evaluated what the alert was

862
00:30:36,960 --> 00:30:38,159
saying

863
00:30:38,159 --> 00:30:40,320
we were able to identify indicators of

864
00:30:40,320 --> 00:30:42,840
compromise with the data we had so we

865
00:30:42,840 --> 00:30:45,120
had hashes we had file names with those

866
00:30:45,120 --> 00:30:47,220
hashes and file names we were able to

867
00:30:47,220 --> 00:30:49,140
Pivot to

868
00:30:49,140 --> 00:30:51,779
a search on virus total

869
00:30:51,779 --> 00:30:53,399
and understand

870
00:30:53,399 --> 00:30:55,140
oh we are dealing with something evil

871
00:30:55,140 --> 00:30:57,299
here great

872
00:30:57,299 --> 00:30:59,039
now we need to figure out what exactly

873
00:30:59,039 --> 00:31:00,899
that evil thing was

874
00:31:00,899 --> 00:31:03,000
um thanks again virustotal we found out

875
00:31:03,000 --> 00:31:05,720
it was emotep

876
00:31:07,200 --> 00:31:09,299
and because we knew it was emotep we

877
00:31:09,299 --> 00:31:10,380
could dig into that further and

878
00:31:10,380 --> 00:31:12,779
understand why that was important what

879
00:31:12,779 --> 00:31:14,340
the potential impact of emote on our

880
00:31:14,340 --> 00:31:16,140
environment was

881
00:31:16,140 --> 00:31:17,640
and with that information we knew what

882
00:31:17,640 --> 00:31:19,860
he needed yeah we knew we needed to

883
00:31:19,860 --> 00:31:21,960
respond because

884
00:31:21,960 --> 00:31:24,000
somebody could have stolen credentials

885
00:31:24,000 --> 00:31:27,480
somebody could be dropping more malware

886
00:31:27,480 --> 00:31:28,320
um

887
00:31:28,320 --> 00:31:29,700
and we'd need to understand if that's

888
00:31:29,700 --> 00:31:31,500
happening as well

889
00:31:31,500 --> 00:31:34,799
so roll back to remediate one sec

890
00:31:34,799 --> 00:31:36,360
rotate your credentials on the boxes

891
00:31:36,360 --> 00:31:38,279
that were impacted I didn't say that but

892
00:31:38,279 --> 00:31:40,019
make sure you do that if you've got that

893
00:31:40,019 --> 00:31:41,700
happening that would have been a bad day

894
00:31:41,700 --> 00:31:44,640
good job everybody we did it

895
00:31:44,640 --> 00:31:45,240
um

896
00:31:45,240 --> 00:31:48,360
we responded we recovered

897
00:31:48,360 --> 00:31:50,700
we also tried to understand what we

898
00:31:50,700 --> 00:31:52,200
could do if we didn't have all that data

899
00:31:52,200 --> 00:31:53,880
what if what if we don't have all the

900
00:31:53,880 --> 00:31:55,380
information what are the questions we

901
00:31:55,380 --> 00:31:57,779
can ask we can we can dig further into a

902
00:31:57,779 --> 00:32:01,260
process tree we can ask where did this

903
00:32:01,260 --> 00:32:03,600
specific thing come from where did this

904
00:32:03,600 --> 00:32:06,179
specific thing end up on the device and

905
00:32:06,179 --> 00:32:08,340
what are the surrounding activity and is

906
00:32:08,340 --> 00:32:10,200
that suspicious as well

907
00:32:10,200 --> 00:32:12,179
and if it's really not answering we need

908
00:32:12,179 --> 00:32:14,700
to understand is this normal

909
00:32:14,700 --> 00:32:17,820
um and asking that of for the user the

910
00:32:17,820 --> 00:32:21,260
computer and your whole environment

911
00:32:23,279 --> 00:32:26,399
uh in about 30 minutes there will be a

912
00:32:26,399 --> 00:32:28,019
Blog on the internet that has all this

913
00:32:28,019 --> 00:32:30,840
content and you can go check that out as

914
00:32:30,840 --> 00:32:32,640
well if you want some notes uh basically

915
00:32:32,640 --> 00:32:34,019
it's my speaker notes put into a Blog

916
00:32:34,019 --> 00:32:36,179
format so you can just go grab that it's

917
00:32:36,179 --> 00:32:38,159
on red Canary's website

918
00:32:38,159 --> 00:32:38,820
um

919
00:32:38,820 --> 00:32:41,039
go check that out

920
00:32:41,039 --> 00:32:43,799
thank you all so much for coming to this

921
00:32:43,799 --> 00:32:44,580
talk

922
00:32:44,580 --> 00:32:46,080
um I really appreciate each and every

923
00:32:46,080 --> 00:32:47,820
one of you I appreciate everybody who

924
00:32:47,820 --> 00:32:49,500
helped me put this talk together all the

925
00:32:49,500 --> 00:32:51,659
people who uh listen to me fumble

926
00:32:51,659 --> 00:32:54,899
through it uh the first few times and

927
00:32:54,899 --> 00:32:56,519
um with that I'll open the floor for

928
00:32:56,519 --> 00:32:58,700
questions

929
00:33:03,830 --> 00:33:06,949
[Applause]

930
00:33:07,200 --> 00:33:09,179
thank you so much that was a great uh

931
00:33:09,179 --> 00:33:10,260
talk

932
00:33:10,260 --> 00:33:12,240
um I have one question so you mentioned

933
00:33:12,240 --> 00:33:14,760
this under the identification phase or

934
00:33:14,760 --> 00:33:17,399
where you ask more questions would it be

935
00:33:17,399 --> 00:33:19,380
a good step to go to the YouTube and

936
00:33:19,380 --> 00:33:21,600
actually I'll Stand directly where did

937
00:33:21,600 --> 00:33:23,340
you get this from is this something you

938
00:33:23,340 --> 00:33:27,600
expected as a step to include

939
00:33:27,600 --> 00:33:29,100
yeah that's a really good question so

940
00:33:29,100 --> 00:33:30,960
the question was

941
00:33:30,960 --> 00:33:33,419
in the identification phase would you

942
00:33:33,419 --> 00:33:34,740
reach out to the user to get information

943
00:33:34,740 --> 00:33:37,740
from them about what they were doing and

944
00:33:37,740 --> 00:33:39,779
was this the expected result and I

945
00:33:39,779 --> 00:33:40,919
actually think that's a really good step

946
00:33:40,919 --> 00:33:43,080
and if you have the ability to do that

947
00:33:43,080 --> 00:33:45,179
you could cut down on your ability to

948
00:33:45,179 --> 00:33:47,580
triage very quickly um I really like

949
00:33:47,580 --> 00:33:49,620
that step some people don't I'm a fan of

950
00:33:49,620 --> 00:33:52,679
it when I work with customers I often

951
00:33:52,679 --> 00:33:54,059
say can you reach out to this person

952
00:33:54,059 --> 00:33:55,380
just to understand what was happening on

953
00:33:55,380 --> 00:33:56,460
their device

954
00:33:56,460 --> 00:33:58,980
before this went down like were they on

955
00:33:58,980 --> 00:34:00,899
a website did they open an email or were

956
00:34:00,899 --> 00:34:02,940
they just doing their normal job because

957
00:34:02,940 --> 00:34:05,279
that gives you an understanding as an

958
00:34:05,279 --> 00:34:07,500
analyst of what you might be dealing

959
00:34:07,500 --> 00:34:09,418
with so yeah I totally think that's

960
00:34:09,418 --> 00:34:13,339
valid all right thank you yeah

961
00:34:14,280 --> 00:34:16,879
okay

962
00:34:19,619 --> 00:34:21,719
we gotta fight for the mic geez sure

963
00:34:21,719 --> 00:34:24,179
battle the the network Giants

964
00:34:24,179 --> 00:34:27,359
um question for you is so this is like

965
00:34:27,359 --> 00:34:29,879
the most comprehensive how to do an

966
00:34:29,879 --> 00:34:32,159
alert I've ever seen now

967
00:34:32,159 --> 00:34:34,918
we tend to have tuning processes we have

968
00:34:34,918 --> 00:34:36,540
a lot of problems there's lots and lots

969
00:34:36,540 --> 00:34:38,159
of alerts like is there any way we can

970
00:34:38,159 --> 00:34:39,780
sort of get like a

971
00:34:39,780 --> 00:34:41,760
like a like a hack of this like a

972
00:34:41,760 --> 00:34:44,339
shorter more streamlined process should

973
00:34:44,339 --> 00:34:45,300
we do this

974
00:34:45,300 --> 00:34:48,359
yeah like so what we did here

975
00:34:48,359 --> 00:34:50,520
was a bit extensive and I want to talk

976
00:34:50,520 --> 00:34:52,139
to that but there is a point where you

977
00:34:52,139 --> 00:34:54,599
streamline this I think the thing that I

978
00:34:54,599 --> 00:34:56,399
typically cut out

979
00:34:56,399 --> 00:34:58,859
when I'm evaluating something is the

980
00:34:58,859 --> 00:35:01,020
what is the threat because

981
00:35:01,020 --> 00:35:03,300
just with experience I'm I have the

982
00:35:03,300 --> 00:35:04,500
ability to say oh this is evil this is

983
00:35:04,500 --> 00:35:06,119
bad we need to deal with it and but

984
00:35:06,119 --> 00:35:07,320
that's not something everybody has so I

985
00:35:07,320 --> 00:35:09,000
wanted to highlight that but as you go

986
00:35:09,000 --> 00:35:10,200
through this process more and more and

987
00:35:10,200 --> 00:35:11,760
more and you see more data and you deal

988
00:35:11,760 --> 00:35:13,200
with more things

989
00:35:13,200 --> 00:35:15,480
you can cut that piece out because you

990
00:35:15,480 --> 00:35:17,520
have an understanding of

991
00:35:17,520 --> 00:35:20,099
what you're probably dealing with and it

992
00:35:20,099 --> 00:35:21,599
is a threat

993
00:35:21,599 --> 00:35:23,339
um so you're really just hitting the

994
00:35:23,339 --> 00:35:25,619
what's my alert say what are my

995
00:35:25,619 --> 00:35:27,300
indicators of compromise what can I

996
00:35:27,300 --> 00:35:31,520
gather from that okay let's respond

997
00:35:33,180 --> 00:35:34,920
thanks very much that was an awesome

998
00:35:34,920 --> 00:35:37,619
talk I really appreciated it um so have

999
00:35:37,619 --> 00:35:39,240
you ever run into a dead end where

1000
00:35:39,240 --> 00:35:41,099
you're investigating it a lot and what

1001
00:35:41,099 --> 00:35:42,599
did you do

1002
00:35:42,599 --> 00:35:44,220
the question was when I run into a dead

1003
00:35:44,220 --> 00:35:45,660
end what do I do

1004
00:35:45,660 --> 00:35:49,859
um cry is typically the response

1005
00:35:49,859 --> 00:35:52,440
um throw the computer into a volcano no

1006
00:35:52,440 --> 00:35:53,339
um

1007
00:35:53,339 --> 00:35:56,400
seriously I what I do is I ask questions

1008
00:35:56,400 --> 00:35:59,339
of people that are around me if you have

1009
00:35:59,339 --> 00:36:01,500
if you have co-workers

1010
00:36:01,500 --> 00:36:03,900
use that resource like

1011
00:36:03,900 --> 00:36:06,660
ask questions because even if they don't

1012
00:36:06,660 --> 00:36:07,920
know you're gonna have them ask

1013
00:36:07,920 --> 00:36:09,359
different questions that maybe you did

1014
00:36:09,359 --> 00:36:10,680
and they can see something that you

1015
00:36:10,680 --> 00:36:12,660
didn't and you're leveling up your

1016
00:36:12,660 --> 00:36:14,160
co-worker and yourself at the same time

1017
00:36:14,160 --> 00:36:18,060
great teamwork that's awesome do that

1018
00:36:18,060 --> 00:36:18,960
um

1019
00:36:18,960 --> 00:36:23,280
that's my biggest thing is use your team

1020
00:36:23,280 --> 00:36:25,619
when you hit a dead end

1021
00:36:25,619 --> 00:36:26,700
um

1022
00:36:26,700 --> 00:36:28,920
that's usually where I go

1023
00:36:28,920 --> 00:36:31,560
um mostly because my team's great uh if

1024
00:36:31,560 --> 00:36:33,599
you don't have that like

1025
00:36:33,599 --> 00:36:35,880
I would say take a break like if you can

1026
00:36:35,880 --> 00:36:37,980
like pass it on to somebody come back to

1027
00:36:37,980 --> 00:36:39,960
it because sometimes you just need that

1028
00:36:39,960 --> 00:36:42,240
two minutes to get away and then come

1029
00:36:42,240 --> 00:36:44,520
back and you see something fresh

1030
00:36:44,520 --> 00:36:46,740
um the other thing is

1031
00:36:46,740 --> 00:36:48,480
change how you're looking at your data

1032
00:36:48,480 --> 00:36:50,280
perhaps change how you're searching it

1033
00:36:50,280 --> 00:36:51,839
maybe you don't look at the hash maybe

1034
00:36:51,839 --> 00:36:53,820
you look at the command line maybe you

1035
00:36:53,820 --> 00:36:55,560
look at

1036
00:36:55,560 --> 00:36:56,940
um I'd say the command line actually is

1037
00:36:56,940 --> 00:36:57,900
a great place to go if you're not

1038
00:36:57,900 --> 00:36:59,220
getting anything on hash because you'll

1039
00:36:59,220 --> 00:37:00,780
end up in a threat report that's like oh

1040
00:37:00,780 --> 00:37:02,760
that's the exact command line for this

1041
00:37:02,760 --> 00:37:04,320
threat I now know what I'm dealing with

1042
00:37:04,320 --> 00:37:06,420
this is bad or maybe you'll end up in a

1043
00:37:06,420 --> 00:37:08,400
GitHub repo for like an administrative

1044
00:37:08,400 --> 00:37:11,099
tool I've been in both situations

1045
00:37:11,099 --> 00:37:13,579
um so

1046
00:37:15,839 --> 00:37:17,500
what is this

1047
00:37:17,500 --> 00:37:23,100
[Laughter]

1048
00:37:23,520 --> 00:37:29,640
no no I got it I can do it okay yeah

1049
00:37:32,820 --> 00:37:35,339
you know long time caller first time

1050
00:37:35,339 --> 00:37:37,500
listener what are some resources you

1051
00:37:37,500 --> 00:37:39,960
have for incident responders who are

1052
00:37:39,960 --> 00:37:42,540
just starting out

1053
00:37:42,540 --> 00:37:44,760
that's a really good question and what

1054
00:37:44,760 --> 00:37:46,260
are resources that I have for incident

1055
00:37:46,260 --> 00:37:50,420
responders that are just starting

1056
00:37:51,420 --> 00:37:52,980
okay

1057
00:37:52,980 --> 00:37:56,180
um I would say

1058
00:37:56,220 --> 00:37:58,980
this is a really good question oh my god

1059
00:37:58,980 --> 00:38:01,619
um I think the place that I would go is

1060
00:38:01,619 --> 00:38:03,660
actually somewhere like

1061
00:38:03,660 --> 00:38:05,880
malware Bazaar triage or a site that

1062
00:38:05,880 --> 00:38:08,339
does like analysis of a file

1063
00:38:08,339 --> 00:38:09,420
and it's going to show you information

1064
00:38:09,420 --> 00:38:11,640
about a process tree and like really

1065
00:38:11,640 --> 00:38:14,339
detail what's happening because out of

1066
00:38:14,339 --> 00:38:16,320
that you can kind of understand

1067
00:38:16,320 --> 00:38:19,680
what's happening with that binary and

1068
00:38:19,680 --> 00:38:21,119
get a clear picture of what's happening

1069
00:38:21,119 --> 00:38:23,880
there and you'll also get like

1070
00:38:23,880 --> 00:38:26,520
a fair amount of detail I if I if I

1071
00:38:26,520 --> 00:38:27,900
could show you I would but just try

1072
00:38:27,900 --> 00:38:30,180
triage it's really good

1073
00:38:30,180 --> 00:38:31,200
um and it's a great place to look at

1074
00:38:31,200 --> 00:38:34,500
binaries and the other thing is

1075
00:38:34,500 --> 00:38:37,200
play around in a lab environment or

1076
00:38:37,200 --> 00:38:38,820
search your production data for

1077
00:38:38,820 --> 00:38:41,280
interesting things like do something on

1078
00:38:41,280 --> 00:38:43,500
your computer that's normal

1079
00:38:43,500 --> 00:38:44,880
do something on your computer that's

1080
00:38:44,880 --> 00:38:46,920
normal and then look in your data to

1081
00:38:46,920 --> 00:38:48,000
understand

1082
00:38:48,000 --> 00:38:49,619
why that's normal

1083
00:38:49,619 --> 00:38:52,740
and understand why what Excel does when

1084
00:38:52,740 --> 00:38:55,020
it first launches what a word does it

1085
00:38:55,020 --> 00:38:57,000
what you know any of these things do and

1086
00:38:57,000 --> 00:38:58,200
what are the norm what does that normal

1087
00:38:58,200 --> 00:39:00,000
behavior look like because when you

1088
00:39:00,000 --> 00:39:02,040
understand normal you then are able to

1089
00:39:02,040 --> 00:39:03,359
start looking at things and say Spider

1090
00:39:03,359 --> 00:39:06,060
Sense tingles bad

1091
00:39:06,060 --> 00:39:08,099
um is it kind of boring to watch Excel

1092
00:39:08,099 --> 00:39:10,740
open yeah but then you have what that

1093
00:39:10,740 --> 00:39:13,140
looks like in your data and that's

1094
00:39:13,140 --> 00:39:14,820
really important

1095
00:39:14,820 --> 00:39:17,160
um and maybe you spin up a lab and you

1096
00:39:17,160 --> 00:39:18,540
have it isolated and then you rip

1097
00:39:18,540 --> 00:39:20,099
malware on it and then you look at the

1098
00:39:20,099 --> 00:39:23,339
data on that also a great thing to do

1099
00:39:23,339 --> 00:39:24,839
um

1100
00:39:24,839 --> 00:39:26,400
and then from the incident response side

1101
00:39:26,400 --> 00:39:28,680
of like dealing with it

1102
00:39:28,680 --> 00:39:30,660
um

1103
00:39:30,660 --> 00:39:32,520
I would I'm trying to think if there's

1104
00:39:32,520 --> 00:39:34,440
any like free EDR tools out there that

1105
00:39:34,440 --> 00:39:37,680
you can leverage but if you can't

1106
00:39:37,680 --> 00:39:40,200
um get in there do an investigation and

1107
00:39:40,200 --> 00:39:41,700
do the manual deletion just so you

1108
00:39:41,700 --> 00:39:43,619
understand where stuff is I said ramage

1109
00:39:43,619 --> 00:39:44,880
your box but like if you're learning

1110
00:39:44,880 --> 00:39:47,579
going to manually remediate a box

1111
00:39:47,579 --> 00:39:50,099
it's tedious it's a pain it kind of

1112
00:39:50,099 --> 00:39:52,020
sucks but it's good for you eat your

1113
00:39:52,020 --> 00:39:54,500
vegetables

1114
00:39:58,020 --> 00:40:00,960
hi I have a question the same topic so

1115
00:40:00,960 --> 00:40:04,020
we decided to wipe out a system but you

1116
00:40:04,020 --> 00:40:06,359
know in the real world people say hey I

1117
00:40:06,359 --> 00:40:08,460
have a lot of files how do I back them

1118
00:40:08,460 --> 00:40:10,079
up and that's a good question because

1119
00:40:10,079 --> 00:40:12,420
you isolate an end point it means

1120
00:40:12,420 --> 00:40:14,880
internet connection is not it's killed

1121
00:40:14,880 --> 00:40:17,700
like how do you do it safely because you

1122
00:40:17,700 --> 00:40:18,900
know you can do you can go to Google

1123
00:40:18,900 --> 00:40:21,540
Drive and try to save those files but

1124
00:40:21,540 --> 00:40:22,859
there's no guarantee those files not

1125
00:40:22,859 --> 00:40:25,619
corrupted you can plug in USB drives the

1126
00:40:25,619 --> 00:40:28,440
same logic there so that's yeah I guess

1127
00:40:28,440 --> 00:40:30,119
my question is how to safely back up

1128
00:40:30,119 --> 00:40:32,220
important files from a corrupted system

1129
00:40:32,220 --> 00:40:33,839
that's a really good question the

1130
00:40:33,839 --> 00:40:35,760
question was when you have a box that's

1131
00:40:35,760 --> 00:40:38,460
infected and isolated but that box has

1132
00:40:38,460 --> 00:40:40,079
important files on it and you need those

1133
00:40:40,079 --> 00:40:41,460
files back

1134
00:40:41,460 --> 00:40:43,140
what do you do and make sure that those

1135
00:40:43,140 --> 00:40:45,799
files are clean

1136
00:40:45,960 --> 00:40:47,700
um

1137
00:40:47,700 --> 00:40:49,680
yeah that's tough and it really depends

1138
00:40:49,680 --> 00:40:51,540
upon the value of those files and your

1139
00:40:51,540 --> 00:40:53,579
appetite for risk um I think that's a

1140
00:40:53,579 --> 00:40:55,200
really big thing and I've dealt with

1141
00:40:55,200 --> 00:40:56,339
this with some customers where they're

1142
00:40:56,339 --> 00:40:57,000
like

1143
00:40:57,000 --> 00:40:59,339
it's really important like budgeting

1144
00:40:59,339 --> 00:41:00,540
spreadsheets and they lived on this

1145
00:41:00,540 --> 00:41:02,400
person's desktop which that's another

1146
00:41:02,400 --> 00:41:03,720
conversation to have about where you're

1147
00:41:03,720 --> 00:41:05,640
storing your important files

1148
00:41:05,640 --> 00:41:07,920
um but if they are there

1149
00:41:07,920 --> 00:41:09,359
you're gonna have to end up in a spot

1150
00:41:09,359 --> 00:41:10,500
where you

1151
00:41:10,500 --> 00:41:12,240
get a USB drive you never use again

1152
00:41:12,240 --> 00:41:15,300
probably plug it into a computer that is

1153
00:41:15,300 --> 00:41:17,099
isolated

1154
00:41:17,099 --> 00:41:20,579
and do a scan of those things and see is

1155
00:41:20,579 --> 00:41:22,560
this safe are these infected in some way

1156
00:41:22,560 --> 00:41:23,940
shape or form

1157
00:41:23,940 --> 00:41:25,740
um the other thing you can do is

1158
00:41:25,740 --> 00:41:27,960
if you have the data you can evaluate

1159
00:41:27,960 --> 00:41:30,000
where those files even touch within the

1160
00:41:30,000 --> 00:41:31,319
timeline of the malicious thing

1161
00:41:31,319 --> 00:41:33,540
happening on your device because if they

1162
00:41:33,540 --> 00:41:35,400
weren't touched you have no evidence of

1163
00:41:35,400 --> 00:41:38,040
that in your Telemetry and you scan them

1164
00:41:38,040 --> 00:41:39,480
you're in a pretty good spot to say hey

1165
00:41:39,480 --> 00:41:41,640
these things are probably safe

1166
00:41:41,640 --> 00:41:44,460
um generally speaking now we work in

1167
00:41:44,460 --> 00:41:46,380
cyber security and the answer is always

1168
00:41:46,380 --> 00:41:48,420
it depends um but that's where I would

1169
00:41:48,420 --> 00:41:51,060
land with that type of thing it

1170
00:41:51,060 --> 00:41:54,119
it can be tough though and

1171
00:41:54,119 --> 00:41:56,819
sometimes it's you lost that file I'm

1172
00:41:56,819 --> 00:41:58,079
sorry

1173
00:41:58,079 --> 00:41:59,040
um you shouldn't have stored that on

1174
00:41:59,040 --> 00:42:00,900
your desktop we have Enterprise storage

1175
00:42:00,900 --> 00:42:03,359
for a reason

1176
00:42:03,359 --> 00:42:05,819
that's a fun conversation too but

1177
00:42:05,819 --> 00:42:08,660
we won't go there

1178
00:42:16,500 --> 00:42:20,160
so I got a question about like time to

1179
00:42:20,160 --> 00:42:22,619
detection or time to decision so you're

1180
00:42:22,619 --> 00:42:24,660
trying to get in there you're trying to

1181
00:42:24,660 --> 00:42:29,119
investigate but time is

1182
00:42:29,119 --> 00:42:32,280
fleeting and like malware replicates

1183
00:42:32,280 --> 00:42:35,460
very rapidly so especially

1184
00:42:35,460 --> 00:42:37,319
transmits between different computers

1185
00:42:37,319 --> 00:42:39,180
and things like that

1186
00:42:39,180 --> 00:42:41,640
okay so if you find that you have like a

1187
00:42:41,640 --> 00:42:44,400
standard or or anything like that in

1188
00:42:44,400 --> 00:42:46,440
companies that where they they say you

1189
00:42:46,440 --> 00:42:49,319
know need a decision by here or we're

1190
00:42:49,319 --> 00:42:50,640
just gonna have to decide one way or

1191
00:42:50,640 --> 00:42:51,839
another

1192
00:42:51,839 --> 00:42:53,640
yeah and I think it's good to have

1193
00:42:53,640 --> 00:42:57,119
guidelines it's like the Pirates Code

1194
00:42:57,119 --> 00:42:59,880
um be very minimal like I hate putting a

1195
00:42:59,880 --> 00:43:02,040
number on this but like

1196
00:43:02,040 --> 00:43:04,560
in previous places that I've been

1197
00:43:04,560 --> 00:43:07,380
um like a high pry like very critical

1198
00:43:07,380 --> 00:43:09,480
thing is like take five minutes do the

1199
00:43:09,480 --> 00:43:11,160
initial triage try to get it into the

1200
00:43:11,160 --> 00:43:12,839
response Zone like if you see credential

1201
00:43:12,839 --> 00:43:13,980
theft if you see something that's a

1202
00:43:13,980 --> 00:43:16,440
precursor to ransomware like get that

1203
00:43:16,440 --> 00:43:19,319
moving if you're running into like

1204
00:43:19,319 --> 00:43:21,960
suspicious encoded Powershell

1205
00:43:21,960 --> 00:43:24,180
okay you need time to actually like

1206
00:43:24,180 --> 00:43:25,859
decode your Powershell understand what

1207
00:43:25,859 --> 00:43:28,859
that script's doing maybe that's 15 to

1208
00:43:28,859 --> 00:43:31,980
30 depending upon how complex that is

1209
00:43:31,980 --> 00:43:34,560
um so it really comes down to what your

1210
00:43:34,560 --> 00:43:36,060
alerts are your confidence in those

1211
00:43:36,060 --> 00:43:37,140
alerts

1212
00:43:37,140 --> 00:43:38,520
and what you actually have to

1213
00:43:38,520 --> 00:43:41,339
investigate to make a decision I don't

1214
00:43:41,339 --> 00:43:45,119
think I've seen something where like

1215
00:43:45,119 --> 00:43:47,040
I'd say like an hour is typically way

1216
00:43:47,040 --> 00:43:48,000
too long

1217
00:43:48,000 --> 00:43:49,440
if you're dealing with something that's

1218
00:43:49,440 --> 00:43:51,480
generating an alert that's you know

1219
00:43:51,480 --> 00:43:53,220
medium or high suspicious if you're

1220
00:43:53,220 --> 00:43:56,280
dealing with like low interesting things

1221
00:43:56,280 --> 00:43:58,800
then like yeah take your time dig into

1222
00:43:58,800 --> 00:44:00,359
that because they're not necessarily

1223
00:44:00,359 --> 00:44:02,940
always going to turn into something

1224
00:44:02,940 --> 00:44:05,900
that's so tough though

1225
00:44:06,680 --> 00:44:09,780
uh we have about 10 minutes left uh just

1226
00:44:09,780 --> 00:44:11,339
to let you all know if anybody has more

1227
00:44:11,339 --> 00:44:14,240
questions feel free

1228
00:44:15,300 --> 00:44:18,300
foreign

1229
00:44:25,220 --> 00:44:28,440
so I want to know when the Kellen merch

1230
00:44:28,440 --> 00:44:29,520
line is going to be available for

1231
00:44:29,520 --> 00:44:30,960
pre-order

1232
00:44:30,960 --> 00:44:33,180
what do you want to know in my slides uh

1233
00:44:33,180 --> 00:44:34,680
yeah I want to know when the Kellen

1234
00:44:34,680 --> 00:44:37,260
merch line will be for pre-order and uh

1235
00:44:37,260 --> 00:44:39,480
I particularly want fronting tie-dye

1236
00:44:39,480 --> 00:44:40,980
crop tops

1237
00:44:40,980 --> 00:44:44,280
uh apparently we have oh my God a

1238
00:44:44,280 --> 00:44:46,619
serious question though a serious

1239
00:44:46,619 --> 00:44:48,480
question now

1240
00:44:48,480 --> 00:44:50,640
how often do you find that you

1241
00:44:50,640 --> 00:44:52,560
personally have to go back to the alert

1242
00:44:52,560 --> 00:44:55,560
logic and completely or even minorly

1243
00:44:55,560 --> 00:44:57,240
reconjigger it because you're finding

1244
00:44:57,240 --> 00:44:59,599
tools or giving you false positives or

1245
00:44:59,599 --> 00:45:03,180
completely maybe useless information

1246
00:45:03,180 --> 00:45:04,740
um just kind of interested about that of

1247
00:45:04,740 --> 00:45:06,780
the balance of alerts versus coming from

1248
00:45:06,780 --> 00:45:08,579
your tools versus what your sim or what

1249
00:45:08,579 --> 00:45:11,520
you've said this is a proper alert

1250
00:45:11,520 --> 00:45:14,040
um merch line coming soon but the real

1251
00:45:14,040 --> 00:45:16,800
question is what

1252
00:45:16,800 --> 00:45:18,540
how often do you find yourself having to

1253
00:45:18,540 --> 00:45:20,400
tune your detections basically like when

1254
00:45:20,400 --> 00:45:21,839
are how often are you getting false

1255
00:45:21,839 --> 00:45:23,220
positives from your alerts and you have

1256
00:45:23,220 --> 00:45:25,680
to go back to Junior alert logic

1257
00:45:25,680 --> 00:45:26,280
um

1258
00:45:26,280 --> 00:45:29,700
all the time all the time

1259
00:45:29,700 --> 00:45:33,180
you can't a Sim uh detection that sort

1260
00:45:33,180 --> 00:45:35,280
of thing is not set it and forget it

1261
00:45:35,280 --> 00:45:37,560
it is like a garden you have to weed

1262
00:45:37,560 --> 00:45:39,000
your garden you have to water your

1263
00:45:39,000 --> 00:45:40,440
garden you have to make sure that your

1264
00:45:40,440 --> 00:45:41,819
plants are growing in the appropriate

1265
00:45:41,819 --> 00:45:43,740
places I don't Garden so that's as much

1266
00:45:43,740 --> 00:45:45,599
as I know sorry

1267
00:45:45,599 --> 00:45:46,500
um

1268
00:45:46,500 --> 00:45:48,420
but that's what it is you have to take

1269
00:45:48,420 --> 00:45:50,520
care of it you have to go and deal with

1270
00:45:50,520 --> 00:45:52,500
those false positives it's easy to close

1271
00:45:52,500 --> 00:45:53,940
your alert and say well don't want to

1272
00:45:53,940 --> 00:45:55,260
deal with that anymore and then the next

1273
00:45:55,260 --> 00:45:56,460
morning you come back to 10 more and

1274
00:45:56,460 --> 00:45:57,720
you're like gonna close those don't want

1275
00:45:57,720 --> 00:45:59,160
to deal with that anymore you're

1276
00:45:59,160 --> 00:46:00,720
creating Tech debt for yourself and the

1277
00:46:00,720 --> 00:46:03,000
people after you that's mean Tech that's

1278
00:46:03,000 --> 00:46:07,380
bad and you might be missing things if

1279
00:46:07,380 --> 00:46:09,300
you're not tuning your logic maybe

1280
00:46:09,300 --> 00:46:12,000
something new happens and

1281
00:46:12,000 --> 00:46:14,040
you had an incident

1282
00:46:14,040 --> 00:46:15,900
that spun out of

1283
00:46:15,900 --> 00:46:18,060
an alert that was okay

1284
00:46:18,060 --> 00:46:19,500
but there was other behavior in that

1285
00:46:19,500 --> 00:46:21,000
incident where you could create a good

1286
00:46:21,000 --> 00:46:22,500
detection

1287
00:46:22,500 --> 00:46:24,660
create a new detection then tune your

1288
00:46:24,660 --> 00:46:26,760
detection that's a lot of work I know

1289
00:46:26,760 --> 00:46:28,500
some people there's two of you doing

1290
00:46:28,500 --> 00:46:30,420
your security and tuning your detections

1291
00:46:30,420 --> 00:46:31,800
and doing everything else you do is hard

1292
00:46:31,800 --> 00:46:36,180
been there get it but it's important and

1293
00:46:36,180 --> 00:46:38,579
I would say I'm gonna get out of soapbox

1294
00:46:38,579 --> 00:46:40,819
here is if you're in that situation

1295
00:46:40,819 --> 00:46:43,440
communicate the business risk to your

1296
00:46:43,440 --> 00:46:44,880
management and the people above you of

1297
00:46:44,880 --> 00:46:46,140
why there's business risk that you can't

1298
00:46:46,140 --> 00:46:48,660
spend time tuning your detections

1299
00:46:48,660 --> 00:46:50,579
um so say if we don't have time and

1300
00:46:50,579 --> 00:46:51,900
people to tune our detections we're

1301
00:46:51,900 --> 00:46:53,099
going to fall behind and we could be

1302
00:46:53,099 --> 00:46:56,099
impacted by new threat and that could

1303
00:46:56,099 --> 00:46:57,359
bring down

1304
00:46:57,359 --> 00:46:58,980
something in our environment or we could

1305
00:46:58,980 --> 00:47:00,300
miss something

1306
00:47:00,300 --> 00:47:01,140
um

1307
00:47:01,140 --> 00:47:04,380
anyways that's my business brain going

1308
00:47:04,380 --> 00:47:07,160
off in that too

1309
00:47:09,300 --> 00:47:12,740
any other questions if not

1310
00:47:12,960 --> 00:47:15,800
oop one more

1311
00:47:16,260 --> 00:47:18,420
what tooling do you use to track your

1312
00:47:18,420 --> 00:47:20,640
workflow for all of these steps

1313
00:47:20,640 --> 00:47:22,260
could you get a little bit closer sorry

1314
00:47:22,260 --> 00:47:24,599
what tooling do you use to track your

1315
00:47:24,599 --> 00:47:26,099
workflow through all of these steps like

1316
00:47:26,099 --> 00:47:27,000
when you're going through all of them

1317
00:47:27,000 --> 00:47:28,680
how do you make the notes and what do

1318
00:47:28,680 --> 00:47:31,380
you use for that okay um so tooling

1319
00:47:31,380 --> 00:47:34,800
um I have the very fortunate privilege

1320
00:47:34,800 --> 00:47:37,260
of digging through EDR data of customers

1321
00:47:37,260 --> 00:47:39,240
so I have like MD I have Microsoft

1322
00:47:39,240 --> 00:47:42,180
Defender like crowdstrike or carbon

1323
00:47:42,180 --> 00:47:45,300
black response which great EDR Telemetry

1324
00:47:45,300 --> 00:47:48,240
what is EDR telemetry

1325
00:47:48,240 --> 00:47:50,579
it's kind of glorified event logs in

1326
00:47:50,579 --> 00:47:52,440
sisman

1327
00:47:52,440 --> 00:47:54,420
I don't know if I can say that

1328
00:47:54,420 --> 00:47:57,540
um but I did and

1329
00:47:57,540 --> 00:48:00,000
if you have that data use that and then

1330
00:48:00,000 --> 00:48:03,480
leverage network data and use IP

1331
00:48:03,480 --> 00:48:05,520
addresses DNS requests all that sort of

1332
00:48:05,520 --> 00:48:07,319
information like

1333
00:48:07,319 --> 00:48:09,119
and try to get that in one place I've

1334
00:48:09,119 --> 00:48:10,380
been in shops where I had five different

1335
00:48:10,380 --> 00:48:12,359
tools to do all those things you make it

1336
00:48:12,359 --> 00:48:13,500
work

1337
00:48:13,500 --> 00:48:14,400
um

1338
00:48:14,400 --> 00:48:16,260
highly recommend that

1339
00:48:16,260 --> 00:48:17,819
um

1340
00:48:17,819 --> 00:48:19,980
tools

1341
00:48:19,980 --> 00:48:21,480
I have a hard time saying like this tool

1342
00:48:21,480 --> 00:48:22,740
is the best tool or that Tool's the

1343
00:48:22,740 --> 00:48:25,079
better tool one worse just know your

1344
00:48:25,079 --> 00:48:26,819
tools and then in terms of like the

1345
00:48:26,819 --> 00:48:29,640
methodology of like take notes take

1346
00:48:29,640 --> 00:48:31,140
notes about what you saw take notes

1347
00:48:31,140 --> 00:48:32,700
about what you observed what your

1348
00:48:32,700 --> 00:48:34,020
thought process was as you looked at

1349
00:48:34,020 --> 00:48:35,400
that thing and why you thought that

1350
00:48:35,400 --> 00:48:38,460
thing and take screenshots if you can

1351
00:48:38,460 --> 00:48:39,540
um because

1352
00:48:39,540 --> 00:48:41,040
you're not gonna remember everything you

1353
00:48:41,040 --> 00:48:41,760
did

1354
00:48:41,760 --> 00:48:43,559
and you're going to come back 10 minutes

1355
00:48:43,559 --> 00:48:45,059
later and you're going to have 20

1356
00:48:45,059 --> 00:48:46,260
different tabs you're gonna be like why

1357
00:48:46,260 --> 00:48:48,300
do I have those tabs

1358
00:48:48,300 --> 00:48:50,339
uh take notes

1359
00:48:50,339 --> 00:48:51,000
um

1360
00:48:51,000 --> 00:48:52,380
and figure out what works for you too

1361
00:48:52,380 --> 00:48:54,900
like that's a really big thing like

1362
00:48:54,900 --> 00:48:56,520
understand how your brain works and the

1363
00:48:56,520 --> 00:48:58,800
way that you investigate because like I

1364
00:48:58,800 --> 00:48:59,940
might investigate something different

1365
00:48:59,940 --> 00:49:01,680
than you investigate something

1366
00:49:01,680 --> 00:49:02,880
but we're going to come to the same

1367
00:49:02,880 --> 00:49:04,740
conclusion and if we can both talk

1368
00:49:04,740 --> 00:49:06,660
through how we did that and how we reach

1369
00:49:06,660 --> 00:49:07,800
that conclusion that's really valuable

1370
00:49:07,800 --> 00:49:09,300
too because I can learn from you you can

1371
00:49:09,300 --> 00:49:10,319
learn from me

1372
00:49:10,319 --> 00:49:13,619
sorry I like ranted on that but yeah

1373
00:49:13,619 --> 00:49:15,540
just whatever tool you have is a good

1374
00:49:15,540 --> 00:49:18,380
tool learn to use it

1375
00:49:22,079 --> 00:49:24,420
so I have a question kind of based off

1376
00:49:24,420 --> 00:49:26,579
of that I think there's a lot of you you

1377
00:49:26,579 --> 00:49:29,400
went over a lot of like very

1378
00:49:29,400 --> 00:49:31,500
keeping track of a lot of data as you're

1379
00:49:31,500 --> 00:49:33,000
investigating things but I don't

1380
00:49:33,000 --> 00:49:34,740
necessarily think it

1381
00:49:34,740 --> 00:49:37,319
all of that has to be communicated like

1382
00:49:37,319 --> 00:49:38,579
say you're doing a write-up on them

1383
00:49:38,579 --> 00:49:40,680
alert or you're saying hey this I decide

1384
00:49:40,680 --> 00:49:43,440
this wasn't bad or I decide this was how

1385
00:49:43,440 --> 00:49:45,980
do you decide what data is actually

1386
00:49:45,980 --> 00:49:48,839
important enough to be included in that

1387
00:49:48,839 --> 00:49:51,359
and what to pass on and what to just

1388
00:49:51,359 --> 00:49:53,640
accept and say we trust that we looked

1389
00:49:53,640 --> 00:49:55,319
at this that's a really good question

1390
00:49:55,319 --> 00:49:56,760
the question was

1391
00:49:56,760 --> 00:49:59,280
we looked at a lot of data and we had a

1392
00:49:59,280 --> 00:50:00,960
lot of data points

1393
00:50:00,960 --> 00:50:03,180
not all that is necessarily relevant to

1394
00:50:03,180 --> 00:50:05,339
escalate to somebody who might be

1395
00:50:05,339 --> 00:50:07,440
remediating if it's not you and how do

1396
00:50:07,440 --> 00:50:09,000
you determine what's relevant to

1397
00:50:09,000 --> 00:50:11,460
escalate so somebody can make informed

1398
00:50:11,460 --> 00:50:12,540
decisions

1399
00:50:12,540 --> 00:50:13,859
that's a really good question and it

1400
00:50:13,859 --> 00:50:15,480
comes with practice

1401
00:50:15,480 --> 00:50:17,700
but for me the things that I would have

1402
00:50:17,700 --> 00:50:20,339
escalated there in this situation are

1403
00:50:20,339 --> 00:50:23,880
that Excel file that dll that we had our

1404
00:50:23,880 --> 00:50:26,040
Command lines and then the fact that we

1405
00:50:26,040 --> 00:50:27,660
had an additional process tree that spun

1406
00:50:27,660 --> 00:50:29,339
out of that but not necessary and if I

1407
00:50:29,339 --> 00:50:31,619
had the hashes that piece

1408
00:50:31,619 --> 00:50:33,720
and then I would say that's a fairly

1409
00:50:33,720 --> 00:50:35,460
good piece of information for a tier two

1410
00:50:35,460 --> 00:50:36,960
person to then go take action on an

1411
00:50:36,960 --> 00:50:37,920
endpoint

1412
00:50:37,920 --> 00:50:38,520
um

1413
00:50:38,520 --> 00:50:40,319
also like know what endpoint you're

1414
00:50:40,319 --> 00:50:42,059
dealing with in your user we didn't have

1415
00:50:42,059 --> 00:50:44,280
that in our alert bad alert

1416
00:50:44,280 --> 00:50:46,559
we want that data um but that

1417
00:50:46,559 --> 00:50:48,540
information is important as well

1418
00:50:48,540 --> 00:50:50,339
um and being able to distill that comes

1419
00:50:50,339 --> 00:50:51,960
with practice it's more of an art than a

1420
00:50:51,960 --> 00:50:55,579
science in my opinion because

1421
00:50:55,680 --> 00:50:57,480
it's easy to overshare but it's easy to

1422
00:50:57,480 --> 00:51:00,540
undershare when you're communicating

1423
00:51:00,540 --> 00:51:02,760
that type of information

1424
00:51:02,760 --> 00:51:03,480
um

1425
00:51:03,480 --> 00:51:05,720
I typically are on the side of overshare

1426
00:51:05,720 --> 00:51:08,280
personally and it

1427
00:51:08,280 --> 00:51:10,020
it's just what I do

1428
00:51:10,020 --> 00:51:10,740
um

1429
00:51:10,740 --> 00:51:14,299
but again it's kind of the person

1430
00:51:18,420 --> 00:51:21,480
any other questions if not thank you so

1431
00:51:21,480 --> 00:51:25,760
much I really appreciate the engagement

1432
00:51:25,920 --> 00:51:28,160
foreign

