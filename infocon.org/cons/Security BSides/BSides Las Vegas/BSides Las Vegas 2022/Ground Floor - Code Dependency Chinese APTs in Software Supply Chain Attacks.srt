1
00:00:00,080 --> 00:00:01,839
it's great to be back it's wonderful to

2
00:00:01,839 --> 00:00:04,400
be here at b-sides las vegas after a

3
00:00:04,400 --> 00:00:06,640
very long time apart and i hope you are

4
00:00:06,640 --> 00:00:07,759
all having

5
00:00:07,759 --> 00:00:10,559
a terrific reunion and experience at

6
00:00:10,559 --> 00:00:12,639
summer camp 2022.

7
00:00:12,639 --> 00:00:15,120
so thank you for your time and to join

8
00:00:15,120 --> 00:00:18,400
me here with my talk today

9
00:00:20,160 --> 00:00:22,640
a little bit about me i

10
00:00:22,640 --> 00:00:25,840
am a strategic threat intelligence

11
00:00:25,840 --> 00:00:29,199
analyst a specialist with a bank i won't

12
00:00:29,199 --> 00:00:30,480
name the bank

13
00:00:30,480 --> 00:00:32,800
and i've been doing that for a few years

14
00:00:32,800 --> 00:00:36,079
now i'm also very happy to be

15
00:00:36,079 --> 00:00:37,840
a founding member of the diana

16
00:00:37,840 --> 00:00:39,760
initiative where we promote

17
00:00:39,760 --> 00:00:43,120
diversity and equality and bring new

18
00:00:43,120 --> 00:00:46,399
ideas and new people into this realm so

19
00:00:46,399 --> 00:00:48,480
that we can all grow better together

20
00:00:48,480 --> 00:00:50,879
today was our kickoff day after a long

21
00:00:50,879 --> 00:00:52,800
time away

22
00:00:52,800 --> 00:00:56,320
and finally uh an obligatory disclaimer

23
00:00:56,320 --> 00:00:58,399
the views expressed here are mine mine

24
00:00:58,399 --> 00:01:01,440
alone and not those of my employer

25
00:01:01,440 --> 00:01:02,960
okay

26
00:01:02,960 --> 00:01:05,120
so

27
00:01:05,199 --> 00:01:06,960
in this talk what i'd like to talk to

28
00:01:06,960 --> 00:01:08,000
you about

29
00:01:08,000 --> 00:01:10,080
are software supply chain attacks what

30
00:01:10,080 --> 00:01:11,360
are they

31
00:01:11,360 --> 00:01:13,680
and about the growing threat that they

32
00:01:13,680 --> 00:01:16,400
pose we're going to take a look at

33
00:01:16,400 --> 00:01:19,600
code dependency as a factor

34
00:01:19,600 --> 00:01:21,360
and then we're going to talk about how

35
00:01:21,360 --> 00:01:22,960
that is compounded

36
00:01:22,960 --> 00:01:26,880
by mistakes and misconfigurations

37
00:01:26,880 --> 00:01:28,479
then we're going to take a look at a

38
00:01:28,479 --> 00:01:32,400
brief history of some major attacks

39
00:01:32,400 --> 00:01:35,759
and then the state-sponsored actors

40
00:01:35,759 --> 00:01:39,520
who are involved in those attacks

41
00:01:39,520 --> 00:01:41,200
who's been watching

42
00:01:41,200 --> 00:01:43,280
and what they're leveraging

43
00:01:43,280 --> 00:01:45,759
finally we'll wrap up with what we could

44
00:01:45,759 --> 00:01:46,960
be doing better

45
00:01:46,960 --> 00:01:50,079
and some suggestions

46
00:01:51,600 --> 00:01:54,159
we don't fully appreciate just how

47
00:01:54,159 --> 00:01:56,479
interconnected we are

48
00:01:56,479 --> 00:01:58,799
and that translates into

49
00:01:58,799 --> 00:02:01,439
software code dependencies and it took

50
00:02:01,439 --> 00:02:04,479
an event like the solarwinds orion hack

51
00:02:04,479 --> 00:02:08,239
in late 2020 to rattle the bars on that

52
00:02:08,239 --> 00:02:10,239
cage and to wake us up to what's been

53
00:02:10,239 --> 00:02:13,040
going on for some time

54
00:02:13,040 --> 00:02:15,040
the reality is that software supply

55
00:02:15,040 --> 00:02:16,879
chain attacks aren't anything new

56
00:02:16,879 --> 00:02:18,959
they've been around for many years

57
00:02:18,959 --> 00:02:20,000
and

58
00:02:20,000 --> 00:02:21,599
we've been watching that check engine

59
00:02:21,599 --> 00:02:24,000
light for some time but we haven't

60
00:02:24,000 --> 00:02:26,400
really addressed the issues

61
00:02:26,400 --> 00:02:29,360
so my hope is that the knowledge and

62
00:02:29,360 --> 00:02:31,280
examples that i can share here with you

63
00:02:31,280 --> 00:02:33,440
today will give you some new insight and

64
00:02:33,440 --> 00:02:35,280
awareness so that you can go back and

65
00:02:35,280 --> 00:02:36,879
better secure the projects that you're

66
00:02:36,879 --> 00:02:39,440
working on

67
00:02:40,879 --> 00:02:42,560
solarwinds was

68
00:02:42,560 --> 00:02:46,000
truly unprecedented how many people here

69
00:02:46,000 --> 00:02:48,879
had to work got the call to respond to

70
00:02:48,879 --> 00:02:51,840
that

71
00:02:52,239 --> 00:02:54,480
yep

72
00:02:55,120 --> 00:02:57,040
this is the kind of event that we we

73
00:02:57,040 --> 00:02:58,879
talk about for decades it's a it's a

74
00:02:58,879 --> 00:03:00,640
teaching point a learning experience a

75
00:03:00,640 --> 00:03:01,840
case study

76
00:03:01,840 --> 00:03:03,840
it's something that we can build and

77
00:03:03,840 --> 00:03:06,800
learn from that's the important thing

78
00:03:06,800 --> 00:03:07,599
now

79
00:03:07,599 --> 00:03:09,200
what you're going to see is that there

80
00:03:09,200 --> 00:03:11,440
have been a lot of software supply

81
00:03:11,440 --> 00:03:15,599
shenanigans since that point

82
00:03:16,159 --> 00:03:19,519
what is it it's an abuse of trust

83
00:03:19,519 --> 00:03:21,200
and as we like to say in the security

84
00:03:21,200 --> 00:03:22,560
community

85
00:03:22,560 --> 00:03:23,920
trust no one

86
00:03:23,920 --> 00:03:27,440
or at least trust but verify

87
00:03:27,440 --> 00:03:29,760
this involves compromise right at the

88
00:03:29,760 --> 00:03:31,200
source

89
00:03:31,200 --> 00:03:34,560
it's the insertion of malicious code

90
00:03:34,560 --> 00:03:37,440
into legitimate software and that gets

91
00:03:37,440 --> 00:03:40,480
distributed on mass

92
00:03:40,480 --> 00:03:42,959
so you have the compromise of one

93
00:03:42,959 --> 00:03:44,560
trusted source

94
00:03:44,560 --> 00:03:47,200
and that's done by the adversaries

95
00:03:47,200 --> 00:03:48,480
because they want to control your

96
00:03:48,480 --> 00:03:50,799
distribution system so that they can

97
00:03:50,799 --> 00:03:53,280
deliver malicious updates

98
00:03:53,280 --> 00:03:55,840
this then creates access points into the

99
00:03:55,840 --> 00:03:56,959
networks

100
00:03:56,959 --> 00:03:59,040
of those targets

101
00:03:59,040 --> 00:04:00,400
customers

102
00:04:00,400 --> 00:04:03,040
thousands and thousands of customers as

103
00:04:03,040 --> 00:04:04,879
we saw with solar winds but with other

104
00:04:04,879 --> 00:04:06,480
attacks similar

105
00:04:06,480 --> 00:04:08,159
as we've learned

106
00:04:08,159 --> 00:04:10,000
nobody is untouchable

107
00:04:10,000 --> 00:04:12,239
and everybody no matter how well

108
00:04:12,239 --> 00:04:16,480
defended you think you are is a target

109
00:04:16,880 --> 00:04:19,120
as for the impact

110
00:04:19,120 --> 00:04:20,959
well we're looking at

111
00:04:20,959 --> 00:04:23,600
being incapacitated

112
00:04:23,600 --> 00:04:25,120
disruption

113
00:04:25,120 --> 00:04:27,360
sabotage if you measure your

114
00:04:27,360 --> 00:04:31,600
productivity and your profit by downtime

115
00:04:31,600 --> 00:04:33,040
this is for you

116
00:04:33,040 --> 00:04:35,840
it's for all of us

117
00:04:36,320 --> 00:04:38,160
and if you consult the mitre attack

118
00:04:38,160 --> 00:04:41,759
framework this is referenced as t11954

119
00:04:41,759 --> 00:04:43,600
initial access

120
00:04:43,600 --> 00:04:45,280
you want to know what initial access is

121
00:04:45,280 --> 00:04:49,119
that's how the hell did they get in

122
00:04:49,840 --> 00:04:50,720
all right

123
00:04:50,720 --> 00:04:52,800
so software supply chain attacks take

124
00:04:52,800 --> 00:04:54,000
time

125
00:04:54,000 --> 00:04:56,479
resources and skill to plan

126
00:04:56,479 --> 00:04:58,160
that's the purview

127
00:04:58,160 --> 00:05:01,440
of state-sponsored threat actors

128
00:05:01,440 --> 00:05:04,000
typically russian or chinese-backed

129
00:05:04,000 --> 00:05:05,600
groups

130
00:05:05,600 --> 00:05:07,280
there's also cyber criminal and

131
00:05:07,280 --> 00:05:09,199
state-sponsored groups who are targeting

132
00:05:09,199 --> 00:05:11,600
the technology industry why because

133
00:05:11,600 --> 00:05:14,720
these companies are relied on by so many

134
00:05:14,720 --> 00:05:17,440
organizations and individuals and that

135
00:05:17,440 --> 00:05:19,759
is a wide-ranging impact

136
00:05:19,759 --> 00:05:23,680
there is a lot of happy hunting in there

137
00:05:23,680 --> 00:05:25,840
attacks on tech companies

138
00:05:25,840 --> 00:05:29,360
enable third-party compromise

139
00:05:29,360 --> 00:05:32,400
of enterprise customers enterprises big

140
00:05:32,400 --> 00:05:34,960
enterprises money enterprise is a very

141
00:05:34,960 --> 00:05:37,680
juicy target

142
00:05:37,680 --> 00:05:40,800
and china has actively targeted tech

143
00:05:40,800 --> 00:05:43,280
companies in taiwan with supply chain

144
00:05:43,280 --> 00:05:44,880
attacks why

145
00:05:44,880 --> 00:05:46,639
because they see them

146
00:05:46,639 --> 00:05:49,039
as a threat

147
00:05:49,039 --> 00:05:51,039
now an important disclaimer

148
00:05:51,039 --> 00:05:52,479
i'm not a developer

149
00:05:52,479 --> 00:05:54,800
or a coder and i'm not even gonna

150
00:05:54,800 --> 00:05:57,039
pretend to be what i am

151
00:05:57,039 --> 00:05:58,400
is a threat

152
00:05:58,400 --> 00:05:59,840
intelligence

153
00:05:59,840 --> 00:06:02,160
geek it's my day job

154
00:06:02,160 --> 00:06:04,080
and that's how i'm presenting my

155
00:06:04,080 --> 00:06:07,360
research for this talk what i do plays a

156
00:06:07,360 --> 00:06:09,600
key role because we watch the

157
00:06:09,600 --> 00:06:11,680
geopolitics play out

158
00:06:11,680 --> 00:06:13,440
then we look back

159
00:06:13,440 --> 00:06:17,120
for context historical context

160
00:06:17,120 --> 00:06:19,039
because we're looking at patterns of

161
00:06:19,039 --> 00:06:20,560
behavior

162
00:06:20,560 --> 00:06:22,479
history repeats

163
00:06:22,479 --> 00:06:26,318
and actions have consequences

164
00:06:27,120 --> 00:06:29,199
this is from ian pratt who is the global

165
00:06:29,199 --> 00:06:31,199
head of security for personal systems at

166
00:06:31,199 --> 00:06:34,199
hp

167
00:06:36,720 --> 00:06:38,080
there's nothing like getting some

168
00:06:38,080 --> 00:06:40,319
historical context so let's review

169
00:06:40,319 --> 00:06:43,199
what's on this timeline

170
00:06:43,199 --> 00:06:45,600
starting in 2009 we have operation

171
00:06:45,600 --> 00:06:46,639
aurora

172
00:06:46,639 --> 00:06:49,919
we'll move to 2017 for not pecha and the

173
00:06:49,919 --> 00:06:52,240
sea cleaner

174
00:06:52,240 --> 00:06:55,440
2018 we'll talk about shadow pad 2019

175
00:06:55,440 --> 00:06:58,800
there's operation shadowhammer

176
00:06:59,280 --> 00:07:02,800
in 2009 operation aurora was a wake-up

177
00:07:02,800 --> 00:07:03,840
call

178
00:07:03,840 --> 00:07:07,599
the chinese state-sponsored group apt 17

179
00:07:07,599 --> 00:07:10,080
also known as elderwood

180
00:07:10,080 --> 00:07:14,160
targeted google and adobe among 34 other

181
00:07:14,160 --> 00:07:16,319
significant companies and they went

182
00:07:16,319 --> 00:07:17,680
after them for

183
00:07:17,680 --> 00:07:21,440
their source code management systems why

184
00:07:21,440 --> 00:07:23,599
because they wanted to alter the source

185
00:07:23,599 --> 00:07:24,560
code

186
00:07:24,560 --> 00:07:25,680
kind of like

187
00:07:25,680 --> 00:07:28,479
the goose and the golden egg

188
00:07:28,479 --> 00:07:30,800
now when we talk about digital crown

189
00:07:30,800 --> 00:07:31,919
jewels

190
00:07:31,919 --> 00:07:34,080
we need to be talking about this

191
00:07:34,080 --> 00:07:35,919
specifically because this is at the

192
00:07:35,919 --> 00:07:37,759
heart of software supply chain

193
00:07:37,759 --> 00:07:38,960
compromise

194
00:07:38,960 --> 00:07:41,120
and if you alter the source code

195
00:07:41,120 --> 00:07:44,160
well imagine what you could do

196
00:07:44,160 --> 00:07:46,879
so that attack was sophisticated

197
00:07:46,879 --> 00:07:49,440
it exploited zero-day vulnerabilities in

198
00:07:49,440 --> 00:07:52,000
internet explorer and vulnerabilities

199
00:07:52,000 --> 00:07:54,000
were also leveraged in a product called

200
00:07:54,000 --> 00:07:56,479
perforce and this is source code

201
00:07:56,479 --> 00:07:58,240
revision software that was being

202
00:07:58,240 --> 00:08:00,800
utilized by google

203
00:08:00,800 --> 00:08:03,280
you can just carry that concept right

204
00:08:03,280 --> 00:08:04,879
into present day

205
00:08:04,879 --> 00:08:09,319
same kind of scenarios exist

206
00:08:12,400 --> 00:08:15,120
so the good news is that this event led

207
00:08:15,120 --> 00:08:16,879
google to take some action it

208
00:08:16,879 --> 00:08:18,960
implemented zero trust

209
00:08:18,960 --> 00:08:22,160
and it tracked lateral movement

210
00:08:22,160 --> 00:08:24,240
and it put in place better

211
00:08:24,240 --> 00:08:25,840
infrastructure

212
00:08:25,840 --> 00:08:28,000
interestingly enough

213
00:08:28,000 --> 00:08:30,720
google wasn't involved in the carnage

214
00:08:30,720 --> 00:08:33,520
of solar winds

215
00:08:34,559 --> 00:08:35,760
and then

216
00:08:35,760 --> 00:08:38,640
2017 there was not petcha is everybody

217
00:08:38,640 --> 00:08:40,880
here familiar with that story and with

218
00:08:40,880 --> 00:08:43,839
what not patio was

219
00:08:43,839 --> 00:08:44,880
okay

220
00:08:44,880 --> 00:08:47,680
i will enlighten you

221
00:08:47,680 --> 00:08:50,240
this was the work of an elite russian

222
00:08:50,240 --> 00:08:53,040
hacking group known as sandworm and it

223
00:08:53,040 --> 00:08:55,440
was part of the gru military

224
00:08:55,440 --> 00:08:57,680
intelligence services

225
00:08:57,680 --> 00:09:00,320
they compromised and they took over

226
00:09:00,320 --> 00:09:02,560
software updates for a mandatory

227
00:09:02,560 --> 00:09:05,279
accounting package known as emmy doc

228
00:09:05,279 --> 00:09:07,440
this was used throughout the ukraine it

229
00:09:07,440 --> 00:09:10,720
was tax software similar to i don't know

230
00:09:10,720 --> 00:09:14,320
quicken quickbooks turbo tax

231
00:09:14,320 --> 00:09:16,000
but everybody pretty much had to use it

232
00:09:16,000 --> 00:09:18,399
to submit their taxes

233
00:09:18,399 --> 00:09:20,560
so

234
00:09:21,120 --> 00:09:23,920
russia has used ukraine as a cyber petri

235
00:09:23,920 --> 00:09:26,240
dish for years

236
00:09:26,240 --> 00:09:28,160
they have a

237
00:09:28,160 --> 00:09:30,399
rather

238
00:09:30,399 --> 00:09:32,800
hostile relationship and russia has

239
00:09:32,800 --> 00:09:35,040
control issues

240
00:09:35,040 --> 00:09:36,720
so soundworm

241
00:09:36,720 --> 00:09:39,519
was detonating logic bombs in government

242
00:09:39,519 --> 00:09:43,920
and companies all over ukraine

243
00:09:45,200 --> 00:09:47,519
now there was a little family-run firm

244
00:09:47,519 --> 00:09:49,360
known as lincols group

245
00:09:49,360 --> 00:09:51,600
they were responsible for pushing out

246
00:09:51,600 --> 00:09:54,560
those software updates for emmydoc that

247
00:09:54,560 --> 00:09:57,279
was their job

248
00:09:57,760 --> 00:09:59,839
what sandworm did was they hijacked

249
00:09:59,839 --> 00:10:01,519
those update servers

250
00:10:01,519 --> 00:10:03,600
and they installed a hidden back door so

251
00:10:03,600 --> 00:10:06,079
that they could access all the pcs that

252
00:10:06,079 --> 00:10:07,680
we're going to be receiving

253
00:10:07,680 --> 00:10:10,239
emmydock

254
00:10:12,880 --> 00:10:15,120
and in june of 2017

255
00:10:15,120 --> 00:10:17,360
sandworm effectively pushed that play

256
00:10:17,360 --> 00:10:20,560
button to launch not petcha

257
00:10:20,560 --> 00:10:21,680
this was

258
00:10:21,680 --> 00:10:23,440
more than just destructive malware this

259
00:10:23,440 --> 00:10:26,959
was a cyber weapon lobbed at ukraine and

260
00:10:26,959 --> 00:10:28,880
it was designed to spread with

261
00:10:28,880 --> 00:10:32,480
breathtaking speed which it did and when

262
00:10:32,480 --> 00:10:34,160
you saw it the damage had already been

263
00:10:34,160 --> 00:10:37,120
done it leveraged eternal blue

264
00:10:37,120 --> 00:10:38,640
and mimikats

265
00:10:38,640 --> 00:10:41,440
to get complete control

266
00:10:41,440 --> 00:10:44,880
now it was supposed to be

267
00:10:44,880 --> 00:10:47,839
a punitive measure against ukraine

268
00:10:47,839 --> 00:10:48,800
however

269
00:10:48,800 --> 00:10:51,519
it escaped its confines and it spread to

270
00:10:51,519 --> 00:10:53,920
major companies globally like the

271
00:10:53,920 --> 00:10:56,800
shipping giant maersk

272
00:10:56,800 --> 00:11:00,160
the unintended consequences were costly

273
00:11:00,160 --> 00:11:02,800
there was a lot of collateral damage

274
00:11:02,800 --> 00:11:04,000
and at this point we're all pretty

275
00:11:04,000 --> 00:11:05,120
familiar

276
00:11:05,120 --> 00:11:07,120
with what the impact looks like to

277
00:11:07,120 --> 00:11:10,160
supply chain because of covet

278
00:11:10,160 --> 00:11:12,480
this is a global impact

279
00:11:12,480 --> 00:11:14,959
the costs of this one was 10 billion

280
00:11:14,959 --> 00:11:17,359
dollars

281
00:11:19,200 --> 00:11:21,360
all right shadowhammer

282
00:11:21,360 --> 00:11:24,399
january 2019 it's a sophisticated supply

283
00:11:24,399 --> 00:11:25,839
chain attack

284
00:11:25,839 --> 00:11:29,360
against a company known as asus

285
00:11:29,360 --> 00:11:33,360
who here might be using an asus product

286
00:11:33,360 --> 00:11:34,160
yes

287
00:11:34,160 --> 00:11:35,440
it is big

288
00:11:35,440 --> 00:11:37,920
this was by a group apt-17 also known as

289
00:11:37,920 --> 00:11:40,000
barium who've been behind

290
00:11:40,000 --> 00:11:41,519
a number of software supply chain

291
00:11:41,519 --> 00:11:42,480
attacks

292
00:11:42,480 --> 00:11:45,519
and they targeted the asus live

293
00:11:45,519 --> 00:11:47,200
update utility

294
00:11:47,200 --> 00:11:48,000
now

295
00:11:48,000 --> 00:11:50,480
according to gartner in 2017 asus was

296
00:11:50,480 --> 00:11:51,680
the fifth

297
00:11:51,680 --> 00:11:54,800
largest pc vendor that's a huge customer

298
00:11:54,800 --> 00:11:58,320
base that is a very juicy target

299
00:11:58,320 --> 00:12:00,639
and that live update is a pre-installed

300
00:12:00,639 --> 00:12:01,920
utility

301
00:12:01,920 --> 00:12:04,480
on most asus computers it's a thing

302
00:12:04,480 --> 00:12:07,279
designed for convenience and most end

303
00:12:07,279 --> 00:12:08,800
users don't want to have to worry about

304
00:12:08,800 --> 00:12:10,880
updating their bios or their uefi's or

305
00:12:10,880 --> 00:12:13,920
their drivers they would welcome this

306
00:12:13,920 --> 00:12:17,199
kind of a facility

307
00:12:17,600 --> 00:12:20,320
so what happened was they sabotaged the

308
00:12:20,320 --> 00:12:24,240
developer tools to be able to get in and

309
00:12:24,240 --> 00:12:27,120
run what they wanted on this particular

310
00:12:27,120 --> 00:12:30,000
utility they modified an older version

311
00:12:30,000 --> 00:12:31,600
of the asus

312
00:12:31,600 --> 00:12:34,399
utility and then they signed that

313
00:12:34,399 --> 00:12:39,120
malware with two asus digital search

314
00:12:39,120 --> 00:12:42,000
then they stored it on official servers

315
00:12:42,000 --> 00:12:44,639
how would you even know

316
00:12:44,639 --> 00:12:46,480
it was there

317
00:12:46,480 --> 00:12:48,320
then they pushed this out to over a

318
00:12:48,320 --> 00:12:50,240
million laptops

319
00:12:50,240 --> 00:12:53,360
to be able to control more remotely and

320
00:12:53,360 --> 00:12:54,880
install more

321
00:12:54,880 --> 00:12:57,880
malware

322
00:13:08,399 --> 00:13:10,720
okay

323
00:13:12,320 --> 00:13:14,079
nick weaver is a security researcher at

324
00:13:14,079 --> 00:13:15,680
the university of california berkeley

325
00:13:15,680 --> 00:13:17,120
institute and

326
00:13:17,120 --> 00:13:18,560
he shares this

327
00:13:18,560 --> 00:13:20,800
you are trusting every vendor

328
00:13:20,800 --> 00:13:22,800
whose code is on your machine and then

329
00:13:22,800 --> 00:13:25,760
you're trusting every vendor's vendor

330
00:13:25,760 --> 00:13:28,720
take that home with you

331
00:13:32,959 --> 00:13:35,519
all right let's talk about our code

332
00:13:35,519 --> 00:13:37,120
dependency

333
00:13:37,120 --> 00:13:41,120
you may grow that was not funny sorry

334
00:13:42,000 --> 00:13:43,839
so the fact is

335
00:13:43,839 --> 00:13:46,000
applications increasingly depend on

336
00:13:46,000 --> 00:13:49,199
external software to work proprietary

337
00:13:49,199 --> 00:13:50,079
code

338
00:13:50,079 --> 00:13:52,320
of open source components

339
00:13:52,320 --> 00:13:54,720
third-party apis

340
00:13:54,720 --> 00:13:57,040
modern applications are just really big

341
00:13:57,040 --> 00:13:59,279
it's too much for one developer really

342
00:13:59,279 --> 00:14:01,440
to have to do it on their own and

343
00:14:01,440 --> 00:14:04,639
software reuse has become the norm

344
00:14:04,639 --> 00:14:07,920
popular open source projects are

345
00:14:07,920 --> 00:14:09,920
they're used as dependencies and that's

346
00:14:09,920 --> 00:14:11,600
a word if you're not a programmer if

347
00:14:11,600 --> 00:14:13,279
you're out on the other side

348
00:14:13,279 --> 00:14:15,440
you don't realize what that means until

349
00:14:15,440 --> 00:14:19,760
you realize what dependencies mean

350
00:14:19,839 --> 00:14:22,399
now these are attractive targets

351
00:14:22,399 --> 00:14:24,160
to the adversaries because then they can

352
00:14:24,160 --> 00:14:27,040
add malicious code to those dependencies

353
00:14:27,040 --> 00:14:30,720
and then claim the users downstream

354
00:14:30,720 --> 00:14:31,440
so

355
00:14:31,440 --> 00:14:33,680
we need to appreciate the increasing

356
00:14:33,680 --> 00:14:35,680
complexity of what we're building in

357
00:14:35,680 --> 00:14:38,079
this digital realm of the applications

358
00:14:38,079 --> 00:14:40,240
that we rely on

359
00:14:40,240 --> 00:14:41,839
and how the functions of just one

360
00:14:41,839 --> 00:14:43,199
library

361
00:14:43,199 --> 00:14:46,639
rely on a number of other libraries in

362
00:14:46,639 --> 00:14:48,720
order to be implemented that's a lot of

363
00:14:48,720 --> 00:14:50,880
things to keep track of

364
00:14:50,880 --> 00:14:53,680
and this creates complex dependency

365
00:14:53,680 --> 00:14:56,480
trees that developers either

366
00:14:56,480 --> 00:14:59,120
won't remove or update because

367
00:14:59,120 --> 00:15:03,040
of the possible downstream consequences

368
00:15:03,040 --> 00:15:04,480
does anybody has anybody ever found

369
00:15:04,480 --> 00:15:07,440
themselves in that position

370
00:15:10,240 --> 00:15:11,519
let's do a quick little look at some

371
00:15:11,519 --> 00:15:12,560
numbers

372
00:15:12,560 --> 00:15:14,959
the average app has about 118 open

373
00:15:14,959 --> 00:15:17,199
source libraries

374
00:15:17,199 --> 00:15:19,839
an average library is about 2.6 years

375
00:15:19,839 --> 00:15:21,120
old

376
00:15:21,120 --> 00:15:23,760
your average jeff java app has 50 open

377
00:15:23,760 --> 00:15:24,839
source

378
00:15:24,839 --> 00:15:28,399
vulnerabilities 99 of organizations have

379
00:15:28,399 --> 00:15:33,440
will at least one high risk java license

380
00:15:33,440 --> 00:15:35,440
and false positivity rates if you're

381
00:15:35,440 --> 00:15:37,680
using these tools

382
00:15:37,680 --> 00:15:41,600
for java there's 23 23.net is 13

383
00:15:41,600 --> 00:15:45,040
and node is 69

384
00:15:49,360 --> 00:15:51,759
let's take a look now at four elements

385
00:15:51,759 --> 00:15:53,680
of your software supply chain there's

386
00:15:53,680 --> 00:15:55,759
what you write that's your custom code

387
00:15:55,759 --> 00:15:58,079
that's developed in-house

388
00:15:58,079 --> 00:15:59,839
there's what you build with

389
00:15:59,839 --> 00:16:01,759
so that's your software development

390
00:16:01,759 --> 00:16:03,120
tools

391
00:16:03,120 --> 00:16:05,040
there's what you buy

392
00:16:05,040 --> 00:16:07,120
off-the-shelf software as a service type

393
00:16:07,120 --> 00:16:10,160
products and then there's what you use

394
00:16:10,160 --> 00:16:12,880
those are third-party libraries

395
00:16:12,880 --> 00:16:14,959
and we need to understand the areas of

396
00:16:14,959 --> 00:16:17,120
risk around open source libraries and

397
00:16:17,120 --> 00:16:18,560
frameworks

398
00:16:18,560 --> 00:16:21,040
which can come from active or inactive

399
00:16:21,040 --> 00:16:23,680
libraries or library classes and the age

400
00:16:23,680 --> 00:16:25,440
of the library

401
00:16:25,440 --> 00:16:28,000
licensing and vulnerabilities i learned

402
00:16:28,000 --> 00:16:31,040
a lot about libraries i had no idea how

403
00:16:31,040 --> 00:16:33,920
pervasive they are how vulnerable we are

404
00:16:33,920 --> 00:16:36,399
because of this use very good to be able

405
00:16:36,399 --> 00:16:38,480
to share this with you

406
00:16:38,480 --> 00:16:40,079
this is hard to do

407
00:16:40,079 --> 00:16:42,720
if you don't have visibility into which

408
00:16:42,720 --> 00:16:45,519
libraries and classes are being used by

409
00:16:45,519 --> 00:16:47,040
that software

410
00:16:47,040 --> 00:16:49,600
and when you're only relying on static

411
00:16:49,600 --> 00:16:50,800
scans

412
00:16:50,800 --> 00:16:55,519
from legacy security code analysis tools

413
00:16:55,519 --> 00:16:57,600
that are out of date so when you change

414
00:16:57,600 --> 00:16:59,839
something it can't capture that change

415
00:16:59,839 --> 00:17:02,639
or what breaks

416
00:17:02,800 --> 00:17:06,079
this is from a 2021 contrast labs

417
00:17:06,079 --> 00:17:08,799
open source security report it's a lot

418
00:17:08,799 --> 00:17:12,000
to take in but key points would be one

419
00:17:12,000 --> 00:17:14,720
if you are using open source code

420
00:17:14,720 --> 00:17:17,599
you need to be paying more attention

421
00:17:17,599 --> 00:17:18,959
then you happen

422
00:17:18,959 --> 00:17:20,400
to

423
00:17:20,400 --> 00:17:22,319
what we've been doing to identify and

424
00:17:22,319 --> 00:17:24,319
remediate things

425
00:17:24,319 --> 00:17:26,559
it's not comprehensive we're missing

426
00:17:26,559 --> 00:17:28,640
stuff and three

427
00:17:28,640 --> 00:17:31,679
those legacy security tools and use

428
00:17:31,679 --> 00:17:34,880
are not securing us

429
00:17:36,400 --> 00:17:39,120
this is a timeline of software package

430
00:17:39,120 --> 00:17:41,440
repositories that have been in supply

431
00:17:41,440 --> 00:17:43,600
chain attacks part of my day job is to

432
00:17:43,600 --> 00:17:44,799
be tracking

433
00:17:44,799 --> 00:17:46,480
all the events all the attacks things

434
00:17:46,480 --> 00:17:49,200
that are happening i have seen a steady

435
00:17:49,200 --> 00:17:50,320
uptick

436
00:17:50,320 --> 00:17:52,960
in events involving software code

437
00:17:52,960 --> 00:17:54,400
repositories

438
00:17:54,400 --> 00:17:55,760
github

439
00:17:55,760 --> 00:17:56,960
npm

440
00:17:56,960 --> 00:17:58,240
npm

441
00:17:58,240 --> 00:18:00,880
npm pi by

442
00:18:00,880 --> 00:18:04,000
it's just tracking like this

443
00:18:04,000 --> 00:18:06,480
it's really easy to get code from

444
00:18:06,480 --> 00:18:08,799
various projects online and then you

445
00:18:08,799 --> 00:18:12,240
incorporate that into other software

446
00:18:12,240 --> 00:18:13,600
but the risk

447
00:18:13,600 --> 00:18:16,000
some of those open source projects

448
00:18:16,000 --> 00:18:17,120
are not

449
00:18:17,120 --> 00:18:19,120
maintained well

450
00:18:19,120 --> 00:18:21,280
they may even have been abandoned

451
00:18:21,280 --> 00:18:22,640
you're putting yourself at risk and you

452
00:18:22,640 --> 00:18:24,320
may not even realize it

453
00:18:24,320 --> 00:18:26,080
code reuse

454
00:18:26,080 --> 00:18:28,240
is a deliberate strategy of scene is a

455
00:18:28,240 --> 00:18:30,320
good thing it's a differentiator why

456
00:18:30,320 --> 00:18:31,200
because

457
00:18:31,200 --> 00:18:32,880
it's for efficiency

458
00:18:32,880 --> 00:18:35,600
and innovation it allows for speed and

459
00:18:35,600 --> 00:18:37,679
application development these are things

460
00:18:37,679 --> 00:18:40,640
that we want they help us grow

461
00:18:40,640 --> 00:18:43,640
however

462
00:18:43,679 --> 00:18:45,280
the cost

463
00:18:45,280 --> 00:18:48,720
is of being vulnerable to compromised

464
00:18:48,720 --> 00:18:51,600
off-the-shelf components

465
00:18:51,600 --> 00:18:53,360
some of that repurposed code can come

466
00:18:53,360 --> 00:18:56,080
from internal repos but a lot of it

467
00:18:56,080 --> 00:18:58,320
doesn't it comes from open source

468
00:18:58,320 --> 00:19:00,799
libraries third parties

469
00:19:00,799 --> 00:19:03,280
and for an attacker compromising a

470
00:19:03,280 --> 00:19:05,039
software supply chain

471
00:19:05,039 --> 00:19:06,720
can come through

472
00:19:06,720 --> 00:19:09,039
manipulation of the application source

473
00:19:09,039 --> 00:19:11,840
code or you can manipulate

474
00:19:11,840 --> 00:19:15,600
how they update and distribute things or

475
00:19:15,600 --> 00:19:18,720
you can replace compiled releases with a

476
00:19:18,720 --> 00:19:19,600
special

477
00:19:19,600 --> 00:19:21,280
modified version

478
00:19:21,280 --> 00:19:22,880
your targets can range from very

479
00:19:22,880 --> 00:19:26,799
specific to broad

480
00:19:28,640 --> 00:19:31,200
stuff happens

481
00:19:31,200 --> 00:19:32,799
and that brings us to this

482
00:19:32,799 --> 00:19:34,960
the continuous integration

483
00:19:34,960 --> 00:19:37,440
continuous development pipeline now this

484
00:19:37,440 --> 00:19:40,559
is considered a best practice for devops

485
00:19:40,559 --> 00:19:42,640
because it delivers code change

486
00:19:42,640 --> 00:19:45,120
frequently and reliably who here is

487
00:19:45,120 --> 00:19:49,360
familiar with the concept of agile

488
00:19:51,280 --> 00:19:54,799
so ci is a coding philosophy

489
00:19:54,799 --> 00:19:56,480
it's the way you do things it's set of

490
00:19:56,480 --> 00:19:58,320
practices that help drive development

491
00:19:58,320 --> 00:20:00,720
teams to implement small changes

492
00:20:00,720 --> 00:20:03,520
incrementally and they check in the code

493
00:20:03,520 --> 00:20:05,360
to the version control repositories

494
00:20:05,360 --> 00:20:06,720
frequently

495
00:20:06,720 --> 00:20:08,080
consistent

496
00:20:08,080 --> 00:20:09,840
automated

497
00:20:09,840 --> 00:20:11,760
and you can build and package and test

498
00:20:11,760 --> 00:20:14,080
your applications

499
00:20:14,080 --> 00:20:16,159
thing is you're still using other

500
00:20:16,159 --> 00:20:18,559
people's technology

501
00:20:18,559 --> 00:20:21,120
and unfortunately snakes mistakes will

502
00:20:21,120 --> 00:20:23,520
be made

503
00:20:24,000 --> 00:20:25,120
so

504
00:20:25,120 --> 00:20:27,520
this brings us to sonar cube is anybody

505
00:20:27,520 --> 00:20:29,360
familiar with this product it is widely

506
00:20:29,360 --> 00:20:30,559
used

507
00:20:30,559 --> 00:20:32,240
okay

508
00:20:32,240 --> 00:20:35,200
november 2020 the fbi issues a flash

509
00:20:35,200 --> 00:20:36,880
alert warning threat actors have been

510
00:20:36,880 --> 00:20:39,840
actively targeting vulnerable sonar cube

511
00:20:39,840 --> 00:20:42,960
influences instances since april of that

512
00:20:42,960 --> 00:20:45,039
year they're accessing source code

513
00:20:45,039 --> 00:20:46,799
repositories and then they're

514
00:20:46,799 --> 00:20:49,360
exfiltrating the proprietary code of us

515
00:20:49,360 --> 00:20:51,840
government agencies as well as private

516
00:20:51,840 --> 00:20:53,200
organizations

517
00:20:53,200 --> 00:20:55,039
a lot of people got hit

518
00:20:55,039 --> 00:20:57,760
they found multiple potential computer

519
00:20:57,760 --> 00:21:00,240
intrusions that corresponded with leaks

520
00:21:00,240 --> 00:21:02,320
associated with that sonar cube

521
00:21:02,320 --> 00:21:04,960
configuration vulnerabilities which had

522
00:21:04,960 --> 00:21:07,760
been exploited for months before back in

523
00:21:07,760 --> 00:21:08,960
april

524
00:21:08,960 --> 00:21:12,159
it was in august of 2020

525
00:21:12,159 --> 00:21:14,400
that an unknown threat actor leaked

526
00:21:14,400 --> 00:21:16,400
internal data from two of the

527
00:21:16,400 --> 00:21:19,360
organizations through a public lifestyle

528
00:21:19,360 --> 00:21:22,158
repo tool

529
00:21:22,720 --> 00:21:25,200
they scanned online for exposure via a

530
00:21:25,200 --> 00:21:27,840
default port 9000 which is the publicly

531
00:21:27,840 --> 00:21:30,960
accessible ip address

532
00:21:30,960 --> 00:21:32,480
and several of the source code

533
00:21:32,480 --> 00:21:34,960
repositories also contained

534
00:21:34,960 --> 00:21:36,960
hard coded credentials

535
00:21:36,960 --> 00:21:39,440
which just opened the door to accessing

536
00:21:39,440 --> 00:21:41,600
other resources and expansion of that

537
00:21:41,600 --> 00:21:43,679
breach and i can tell you based on the

538
00:21:43,679 --> 00:21:46,080
research we've i've done from 2021 all

539
00:21:46,080 --> 00:21:48,640
the way through 2012 we're increasingly

540
00:21:48,640 --> 00:21:49,760
seeing

541
00:21:49,760 --> 00:21:52,720
stored things keys secrets

542
00:21:52,720 --> 00:21:55,919
hard-coded credentials in source code it

543
00:21:55,919 --> 00:21:59,400
shouldn't be there

544
00:22:01,039 --> 00:22:02,960
with regard to that

545
00:22:02,960 --> 00:22:04,640
sonar cube event

546
00:22:04,640 --> 00:22:09,799
sikar zarakai wrote this oops sorry

547
00:22:13,480 --> 00:22:16,080
misconfiguration is constant it

548
00:22:16,080 --> 00:22:19,760
shouldn't be a constant but it is

549
00:22:24,400 --> 00:22:26,400
all right

550
00:22:26,400 --> 00:22:28,000
let's talk about some

551
00:22:28,000 --> 00:22:30,960
major software supply chain attacks from

552
00:22:30,960 --> 00:22:32,240
the past

553
00:22:32,240 --> 00:22:33,679
and lessons that might not have been

554
00:22:33,679 --> 00:22:36,000
learned

555
00:22:36,880 --> 00:22:40,400
if that looks busy yes yes it is so the

556
00:22:40,400 --> 00:22:43,360
identity theft research center stated

557
00:22:43,360 --> 00:22:46,559
that 137 organizations reported they

558
00:22:46,559 --> 00:22:49,440
were impacted by supply chain attacks at

559
00:22:49,440 --> 00:22:52,400
27 different third-party vendors that

560
00:22:52,400 --> 00:22:54,960
was an increase of 42

561
00:22:54,960 --> 00:22:56,559
in one quarter

562
00:22:56,559 --> 00:22:58,480
attackers manipulate software

563
00:22:58,480 --> 00:23:00,960
dependencies and development tools so

564
00:23:00,960 --> 00:23:03,120
that they can compromise data or systems

565
00:23:03,120 --> 00:23:05,840
before they reach the recipient

566
00:23:05,840 --> 00:23:07,360
as we've seen

567
00:23:07,360 --> 00:23:09,600
they go after source code

568
00:23:09,600 --> 00:23:11,760
think of recent attacks think of lapses

569
00:23:11,760 --> 00:23:13,440
group for example

570
00:23:13,440 --> 00:23:16,080
what did they take they took a lot of

571
00:23:16,080 --> 00:23:18,639
source code

572
00:23:19,200 --> 00:23:21,520
microsoft said that they had gained

573
00:23:21,520 --> 00:23:23,120
access to some of the source code for

574
00:23:23,120 --> 00:23:24,480
exchange

575
00:23:24,480 --> 00:23:27,520
and azure and intune okay if you're in

576
00:23:27,520 --> 00:23:30,159
an enterprise you're using exchange and

577
00:23:30,159 --> 00:23:32,159
you're using azure

578
00:23:32,159 --> 00:23:33,600
having that source code gives

579
00:23:33,600 --> 00:23:36,240
adversaries the advantage why because

580
00:23:36,240 --> 00:23:38,320
they can be the first to look through it

581
00:23:38,320 --> 00:23:40,400
find the vulnerabilities and exploit

582
00:23:40,400 --> 00:23:42,240
them it's code

583
00:23:42,240 --> 00:23:46,240
there are vulnerabilities in there

584
00:23:46,240 --> 00:23:49,520
they also go after certificates

585
00:23:49,520 --> 00:23:52,159
and certificates are important because

586
00:23:52,159 --> 00:23:54,159
if you have stolen code signing

587
00:23:54,159 --> 00:23:55,919
certificates you are now giving that

588
00:23:55,919 --> 00:23:57,120
malware

589
00:23:57,120 --> 00:23:59,360
legitimacy it's going to bypass

590
00:23:59,360 --> 00:24:01,919
detection and antivirus and protective

591
00:24:01,919 --> 00:24:03,120
measures

592
00:24:03,120 --> 00:24:05,760
and then you can send malware payloads

593
00:24:05,760 --> 00:24:08,480
as a legitimate source

594
00:24:08,480 --> 00:24:11,520
and those certificates are simply

595
00:24:11,520 --> 00:24:12,880
a staple

596
00:24:12,880 --> 00:24:15,600
of attacks

597
00:24:16,159 --> 00:24:18,559
let's talk about attacks

598
00:24:18,559 --> 00:24:21,200
there's vendor compromise which is

599
00:24:21,200 --> 00:24:24,320
considered among the most sophisticated

600
00:24:24,320 --> 00:24:27,120
exploitation of third-party applications

601
00:24:27,120 --> 00:24:28,240
could you find and exploit the

602
00:24:28,240 --> 00:24:30,320
vulnerabilities especially zero days and

603
00:24:30,320 --> 00:24:32,799
then these bugs can enable that attacker

604
00:24:32,799 --> 00:24:34,559
to manipulate software to do things that

605
00:24:34,559 --> 00:24:37,039
it was never intended to do

606
00:24:37,039 --> 00:24:39,200
stealing credentials for example

607
00:24:39,200 --> 00:24:41,039
accessing information that it has no

608
00:24:41,039 --> 00:24:43,279
business accessing

609
00:24:43,279 --> 00:24:46,320
exploiting open source libraries we know

610
00:24:46,320 --> 00:24:48,159
these have vulnerabilities and they can

611
00:24:48,159 --> 00:24:50,000
be exploited

612
00:24:50,000 --> 00:24:51,440
it's different from

613
00:24:51,440 --> 00:24:54,080
software packages because it's harder to

614
00:24:54,080 --> 00:24:56,559
update and maintain open source code

615
00:24:56,559 --> 00:24:57,919
here

616
00:24:57,919 --> 00:25:00,080
however because the source code is

617
00:25:00,080 --> 00:25:02,960
available attackers have the opportunity

618
00:25:02,960 --> 00:25:06,080
to study it and practice on it

619
00:25:06,080 --> 00:25:08,480
case in point apache 2

620
00:25:08,480 --> 00:25:11,039
apache struts 2 framework

621
00:25:11,039 --> 00:25:12,840
there have been 13

622
00:25:12,840 --> 00:25:15,760
critical zero day disclosures

623
00:25:15,760 --> 00:25:18,640
just in the past five years

624
00:25:18,640 --> 00:25:20,480
dependency confusion that's an attack

625
00:25:20,480 --> 00:25:22,799
we'll talk about later

626
00:25:22,799 --> 00:25:25,200
and then there's hostile takeover

627
00:25:25,200 --> 00:25:28,559
this is an example where somebody

628
00:25:28,559 --> 00:25:30,640
will take over

629
00:25:30,640 --> 00:25:33,039
in a community a project offered to look

630
00:25:33,039 --> 00:25:35,279
after it they'll be handed over the

631
00:25:35,279 --> 00:25:36,480
control

632
00:25:36,480 --> 00:25:37,840
but with that

633
00:25:37,840 --> 00:25:39,120
they can then

634
00:25:39,120 --> 00:25:42,080
feed malicious content downstream in

635
00:25:42,080 --> 00:25:44,400
2018 there was an event involving event

636
00:25:44,400 --> 00:25:47,039
stream and node.js and it was caught

637
00:25:47,039 --> 00:25:48,640
because there were

638
00:25:48,640 --> 00:25:49,840
mistakes

639
00:25:49,840 --> 00:25:51,760
and the people at node thought it was

640
00:25:51,760 --> 00:25:54,000
just bugs fortunately they caught it

641
00:25:54,000 --> 00:25:57,840
they were able to flag it down

642
00:25:59,679 --> 00:26:01,279
i found this as i was doing my research

643
00:26:01,279 --> 00:26:02,720
and i thought it was a great way to

644
00:26:02,720 --> 00:26:04,640
share what a plan of attack could look

645
00:26:04,640 --> 00:26:06,320
like from the back stabbers knife

646
00:26:06,320 --> 00:26:09,440
collection which is a pretty cool name

647
00:26:09,440 --> 00:26:11,760
you start by injecting malicious code

648
00:26:11,760 --> 00:26:13,919
into that dependency tree

649
00:26:13,919 --> 00:26:16,320
and then you can create a new package

650
00:26:16,320 --> 00:26:18,880
with unexpected features like a trojan

651
00:26:18,880 --> 00:26:22,880
horse or typo squatting or use after

652
00:26:22,880 --> 00:26:26,000
free you can also infect an existing

653
00:26:26,000 --> 00:26:28,480
package and then spread some malicious

654
00:26:28,480 --> 00:26:31,279
goodness by either injecting it into the

655
00:26:31,279 --> 00:26:32,320
source

656
00:26:32,320 --> 00:26:34,960
or into the repository system

657
00:26:34,960 --> 00:26:37,200
or during the build which was what

658
00:26:37,200 --> 00:26:39,840
solarwinds was and then it component the

659
00:26:39,840 --> 00:26:43,360
build system and it contained packages

660
00:26:43,360 --> 00:26:46,080
downloading

661
00:26:46,400 --> 00:26:49,520
that brings us of course to solarwinds

662
00:26:49,520 --> 00:26:50,400
so

663
00:26:50,400 --> 00:26:52,720
this is a trusted network management and

664
00:26:52,720 --> 00:26:55,039
monitoring software that's used by the

665
00:26:55,039 --> 00:26:56,559
government

666
00:26:56,559 --> 00:27:00,880
fortune 500s microsoft firewall

667
00:27:00,880 --> 00:27:02,400
so many people

668
00:27:02,400 --> 00:27:04,320
and nobody knew

669
00:27:04,320 --> 00:27:06,400
that anything was wrong

670
00:27:06,400 --> 00:27:07,840
and it's described as the most

671
00:27:07,840 --> 00:27:10,000
significant attack of our time it's

672
00:27:10,000 --> 00:27:11,760
pretty pretty true

673
00:27:11,760 --> 00:27:14,159
what's distinctive in it is that degree

674
00:27:14,159 --> 00:27:16,880
of stealth that was used the ability of

675
00:27:16,880 --> 00:27:19,200
the adversaries to conceal their actions

676
00:27:19,200 --> 00:27:21,440
and the length of time it took for

677
00:27:21,440 --> 00:27:23,760
discovery

678
00:27:23,760 --> 00:27:26,559
this was an operation that took time and

679
00:27:26,559 --> 00:27:28,720
precision to do the reconnaissance

680
00:27:28,720 --> 00:27:31,039
sophistication to tailor and patience

681
00:27:31,039 --> 00:27:32,799
and in my day job what i'm doing

682
00:27:32,799 --> 00:27:34,399
constantly is

683
00:27:34,399 --> 00:27:36,320
anatomies of attack

684
00:27:36,320 --> 00:27:39,039
understanding the adversaries

685
00:27:39,039 --> 00:27:42,080
and this stands out from all the attacks

686
00:27:42,080 --> 00:27:43,840
we've looked at we spent a lot of time

687
00:27:43,840 --> 00:27:45,760
mapping this out and

688
00:27:45,760 --> 00:27:48,000
looking back you just would go oh my god

689
00:27:48,000 --> 00:27:51,440
they were in there for how many months

690
00:27:53,600 --> 00:27:54,960
they targeted and

691
00:27:54,960 --> 00:27:57,520
compromised that build environment and

692
00:27:57,520 --> 00:28:00,159
the code signing infrastructure for

693
00:28:00,159 --> 00:28:02,480
orion

694
00:28:02,480 --> 00:28:05,120
that gave them complete control

695
00:28:05,120 --> 00:28:06,640
that's your level of trust there that's

696
00:28:06,640 --> 00:28:09,200
just been completely compromised they

697
00:28:09,200 --> 00:28:11,840
modified the source code to add a back

698
00:28:11,840 --> 00:28:14,000
door

699
00:28:14,000 --> 00:28:15,440
and signed it

700
00:28:15,440 --> 00:28:16,799
and then they leveraged the existing

701
00:28:16,799 --> 00:28:19,120
software release management system and

702
00:28:19,120 --> 00:28:21,840
used stolen certificates which let them

703
00:28:21,840 --> 00:28:26,000
laterally move through chains of trust

704
00:28:26,799 --> 00:28:28,640
who here has heard of dependency

705
00:28:28,640 --> 00:28:31,520
confusion this is a wicked cool attack

706
00:28:31,520 --> 00:28:33,919
and it's increasing good

707
00:28:33,919 --> 00:28:36,960
so security researcher alex person

708
00:28:36,960 --> 00:28:38,720
shot a bright light on a very scary

709
00:28:38,720 --> 00:28:39,919
possibility

710
00:28:39,919 --> 00:28:42,320
he took a hypothesis about a supply

711
00:28:42,320 --> 00:28:45,279
chain substitution attack

712
00:28:45,279 --> 00:28:47,120
where you have a software installer

713
00:28:47,120 --> 00:28:48,799
script

714
00:28:48,799 --> 00:28:49,600
that

715
00:28:49,600 --> 00:28:51,919
tricks people into pulling a malicious

716
00:28:51,919 --> 00:28:54,559
code file from a public repository

717
00:28:54,559 --> 00:28:57,200
instead of getting the trusted file with

718
00:28:57,200 --> 00:28:58,720
the same name

719
00:28:58,720 --> 00:29:02,960
from the safe internal repository

720
00:29:02,960 --> 00:29:04,559
to griva's point

721
00:29:04,559 --> 00:29:08,000
he targeted apple microsoft tesla and 32

722
00:29:08,000 --> 00:29:09,760
other companies

723
00:29:09,760 --> 00:29:12,240
and executed unauthorized code inside

724
00:29:12,240 --> 00:29:14,880
their networks

725
00:29:14,880 --> 00:29:16,159
well

726
00:29:16,159 --> 00:29:18,559
that worked but within 48 hours of it

727
00:29:18,559 --> 00:29:20,720
being publicized a lot of other parties

728
00:29:20,720 --> 00:29:23,600
who did not ask permission to do this

729
00:29:23,600 --> 00:29:25,200
thought it was a very good idea too

730
00:29:25,200 --> 00:29:27,120
jumped on the bandwagon and there were

731
00:29:27,120 --> 00:29:29,840
more attacks and i can report we are

732
00:29:29,840 --> 00:29:31,360
seeing an increase of these type of

733
00:29:31,360 --> 00:29:33,760
attacks from 2021

734
00:29:33,760 --> 00:29:35,919
straight into 2022.

735
00:29:35,919 --> 00:29:37,919
and the issue here

736
00:29:37,919 --> 00:29:40,559
existing dependency scanners

737
00:29:40,559 --> 00:29:41,919
do not

738
00:29:41,919 --> 00:29:44,080
detect if a dependency

739
00:29:44,080 --> 00:29:46,159
executes malicious code

740
00:29:46,159 --> 00:29:47,919
and since these tools are limited to

741
00:29:47,919 --> 00:29:50,159
identifying dependencies with known

742
00:29:50,159 --> 00:29:53,159
vulnerabilities

743
00:29:54,320 --> 00:29:56,320
there was an interesting study done as a

744
00:29:56,320 --> 00:29:58,480
result of this at red hunt labs and they

745
00:29:58,480 --> 00:29:59,600
found

746
00:29:59,600 --> 00:30:02,399
these results

747
00:30:03,840 --> 00:30:06,799
93 repositories out of the top thousand

748
00:30:06,799 --> 00:30:09,520
github organizations are using a package

749
00:30:09,520 --> 00:30:11,760
that doesn't even exist on a public

750
00:30:11,760 --> 00:30:13,440
package index

751
00:30:13,440 --> 00:30:16,320
which can be claimed by an attacker to

752
00:30:16,320 --> 00:30:20,000
cause a software supply chain attack

753
00:30:20,559 --> 00:30:22,399
of the top thousand organizations that

754
00:30:22,399 --> 00:30:25,120
were scanned 212 of them had at least

755
00:30:25,120 --> 00:30:27,880
one dependency confusion related

756
00:30:27,880 --> 00:30:30,240
misconfiguration in their database

757
00:30:30,240 --> 00:30:31,679
why does this matter

758
00:30:31,679 --> 00:30:34,320
these are big names that are relied on

759
00:30:34,320 --> 00:30:37,440
by many many users

760
00:30:37,440 --> 00:30:40,799
so if one of those projects gets tainted

761
00:30:40,799 --> 00:30:42,320
there's a high probability that

762
00:30:42,320 --> 00:30:44,000
potentially millions of users will be

763
00:30:44,000 --> 00:30:46,399
affected

764
00:30:46,880 --> 00:30:50,240
xcode spot

765
00:30:50,240 --> 00:30:54,320
how many people use ios

766
00:30:55,200 --> 00:30:56,159
yes

767
00:30:56,159 --> 00:30:58,240
well this is a malicious project that

768
00:30:58,240 --> 00:31:00,559
affects the free application

769
00:31:00,559 --> 00:31:02,799
development environment

770
00:31:02,799 --> 00:31:04,880
and a new malware variant was observed

771
00:31:04,880 --> 00:31:07,760
targeting ios developers in a supply

772
00:31:07,760 --> 00:31:09,760
chain attack

773
00:31:09,760 --> 00:31:11,679
they abused legitimate development

774
00:31:11,679 --> 00:31:15,600
environments from apple

775
00:31:15,760 --> 00:31:18,399
the targets were sharing sites and

776
00:31:18,399 --> 00:31:20,399
repositories this is common practice

777
00:31:20,399 --> 00:31:24,719
it's encouraged it's a belief system

778
00:31:25,039 --> 00:31:29,240
this is a total abuse of trust

779
00:31:39,120 --> 00:31:40,720
how many people are familiar with the

780
00:31:40,720 --> 00:31:44,399
company code cover and what it does

781
00:31:45,279 --> 00:31:48,559
there was a major breach

782
00:31:48,720 --> 00:31:50,399
involving code cov

783
00:31:50,399 --> 00:31:53,440
2021 it's an online platform and it's

784
00:31:53,440 --> 00:31:56,320
used for hosting code testing reports

785
00:31:56,320 --> 00:31:58,080
and statistics

786
00:31:58,080 --> 00:32:00,799
and it gives developers developers tools

787
00:32:00,799 --> 00:32:03,360
that will help them to quantify how much

788
00:32:03,360 --> 00:32:07,200
source code is executed during testing

789
00:32:07,200 --> 00:32:08,720
it's supposed to be very safe it's

790
00:32:08,720 --> 00:32:10,000
trusted

791
00:32:10,000 --> 00:32:12,799
they serve over 29 000 customers

792
00:32:12,799 --> 00:32:14,960
globally many of these are enterprise

793
00:32:14,960 --> 00:32:15,840
level

794
00:32:15,840 --> 00:32:18,159
godaddy atlassian

795
00:32:18,159 --> 00:32:19,279
banks

796
00:32:19,279 --> 00:32:22,320
procter gamble however the impact

797
00:32:22,320 --> 00:32:24,799
spread beyond that to thousands of

798
00:32:24,799 --> 00:32:27,519
public development projects as well

799
00:32:27,519 --> 00:32:29,039
ansible

800
00:32:29,039 --> 00:32:31,039
kubernetes

801
00:32:31,039 --> 00:32:33,360
rapid7 twilio

802
00:32:33,360 --> 00:32:36,399
even e-commerce platforms

803
00:32:36,399 --> 00:32:40,000
so on april 21st of 2021 code cult

804
00:32:40,000 --> 00:32:42,000
reported a supply chain attack that had

805
00:32:42,000 --> 00:32:44,320
actually occurred back in january that's

806
00:32:44,320 --> 00:32:47,039
a few months lag time that's not going

807
00:32:47,039 --> 00:32:48,399
to help anybody

808
00:32:48,399 --> 00:32:50,000
and what happened was attackers had

809
00:32:50,000 --> 00:32:52,320
leveraged an error in the process that

810
00:32:52,320 --> 00:32:55,360
creates code cuffs docker image and this

811
00:32:55,360 --> 00:32:57,760
lets them extract credentials which

812
00:32:57,760 --> 00:32:59,440
protect the modification of something

813
00:32:59,440 --> 00:33:01,440
called the bash uploader script and

814
00:33:01,440 --> 00:33:04,000
that's the tool used by customers to

815
00:33:04,000 --> 00:33:06,480
send their code coverage reports to the

816
00:33:06,480 --> 00:33:08,960
platform and what's in there

817
00:33:08,960 --> 00:33:11,519
all kinds of secrets

818
00:33:11,519 --> 00:33:15,039
credentials etc so that the attackers

819
00:33:15,039 --> 00:33:18,880
could reroute this once they received it

820
00:33:18,880 --> 00:33:20,000
and gain

821
00:33:20,000 --> 00:33:23,399
that information

822
00:33:27,360 --> 00:33:29,679
and then they sent that information to a

823
00:33:29,679 --> 00:33:30,720
server

824
00:33:30,720 --> 00:33:33,360
outside

825
00:33:35,840 --> 00:33:38,720
there was the cassaya breach again

826
00:33:38,720 --> 00:33:40,640
this is important in the way that it was

827
00:33:40,640 --> 00:33:44,399
trusted by the users there's over 40 000

828
00:33:44,399 --> 00:33:45,760
of them

829
00:33:45,760 --> 00:33:48,399
it's a it solutions developer for

830
00:33:48,399 --> 00:33:50,559
managed services providers

831
00:33:50,559 --> 00:33:52,880
and enterprise level organizations their

832
00:33:52,880 --> 00:33:55,120
product vsa is

833
00:33:55,120 --> 00:33:58,000
a unified remote monitoring and

834
00:33:58,000 --> 00:33:59,919
management tool for networks and

835
00:33:59,919 --> 00:34:01,440
endpoints

836
00:34:01,440 --> 00:34:04,000
this has a high level of trust on

837
00:34:04,000 --> 00:34:06,240
customer devices sounds familiar doesn't

838
00:34:06,240 --> 00:34:08,079
it

839
00:34:08,079 --> 00:34:10,480
this has so much trust that the attached

840
00:34:10,480 --> 00:34:12,800
client devices will do whatever they are

841
00:34:12,800 --> 00:34:14,000
told

842
00:34:14,000 --> 00:34:15,359
and that's probably one of the reasons

843
00:34:15,359 --> 00:34:17,760
why casey was targeted

844
00:34:17,760 --> 00:34:19,679
rival ransomware operators delivered a

845
00:34:19,679 --> 00:34:22,719
fake vsa update that sent a ransomware

846
00:34:22,719 --> 00:34:25,679
payload from compromised vsa servers to

847
00:34:25,679 --> 00:34:27,918
vsa agents that were running on managed

848
00:34:27,918 --> 00:34:30,879
windows devices

849
00:34:31,760 --> 00:34:34,000
that malicious update was dubbed the

850
00:34:34,000 --> 00:34:36,159
vsa agent hotfix

851
00:34:36,159 --> 00:34:39,199
the initial access came from an ex

852
00:34:39,199 --> 00:34:41,839
zero day vulnerabilities that

853
00:34:41,839 --> 00:34:44,320
existed in cassay's vsa software they

854
00:34:44,320 --> 00:34:46,079
were reported they were known but they

855
00:34:46,079 --> 00:34:47,839
hadn't been fixed and they were

856
00:34:47,839 --> 00:34:48,879
leveraged

857
00:34:48,879 --> 00:34:50,800
and the attack was triggered through an

858
00:34:50,800 --> 00:34:53,918
authentication bypass vulnerability in

859
00:34:53,918 --> 00:34:56,480
that case a vsa web interface

860
00:34:56,480 --> 00:34:58,480
so the attackers could circumvent

861
00:34:58,480 --> 00:35:00,560
authentication controls

862
00:35:00,560 --> 00:35:02,960
they gained an authenticated session and

863
00:35:02,960 --> 00:35:06,560
then they uploaded a malicious payload

864
00:35:06,560 --> 00:35:09,119
they executed commands using sql

865
00:35:09,119 --> 00:35:10,240
injection

866
00:35:10,240 --> 00:35:12,160
and they achieved code execution in the

867
00:35:12,160 --> 00:35:14,079
process

868
00:35:14,079 --> 00:35:16,400
i'm not super technical but we had to

869
00:35:16,400 --> 00:35:17,920
analyze how the hell did this happen and

870
00:35:17,920 --> 00:35:19,200
what did it mean and there was a lot of

871
00:35:19,200 --> 00:35:20,560
learning and i'm hoping that this will

872
00:35:20,560 --> 00:35:22,720
help you too

873
00:35:22,720 --> 00:35:24,720
they then attempted to disable ms

874
00:35:24,720 --> 00:35:25,839
defender

875
00:35:25,839 --> 00:35:29,599
using a signed certificate

876
00:35:29,599 --> 00:35:31,520
the trust issue here

877
00:35:31,520 --> 00:35:34,320
that can say a hotfix that was leveraged

878
00:35:34,320 --> 00:35:36,320
was ready to go thanks to the

879
00:35:36,320 --> 00:35:38,320
anti-malware software exclusions that

880
00:35:38,320 --> 00:35:42,599
had already been set up

881
00:35:45,839 --> 00:35:50,400
so who's maximizing these opportunities

882
00:35:50,400 --> 00:35:53,359
of all the state's sponsored adversaries

883
00:35:53,359 --> 00:35:56,000
chinese cyber espionage groups have been

884
00:35:56,000 --> 00:35:58,000
and will continue to be the biggest

885
00:35:58,000 --> 00:36:00,400
threat to tech they conduct economic

886
00:36:00,400 --> 00:36:02,800
espionage and intellectual property

887
00:36:02,800 --> 00:36:05,119
theft they are very very good at what

888
00:36:05,119 --> 00:36:06,000
they do

889
00:36:06,000 --> 00:36:07,920
and there have been repeated warnings

890
00:36:07,920 --> 00:36:11,040
again just this year by agencies and

891
00:36:11,040 --> 00:36:14,720
governments in the us and the uk about

892
00:36:14,720 --> 00:36:17,359
stuff they are finding which is very

893
00:36:17,359 --> 00:36:20,000
alarming what's been accessed what's

894
00:36:20,000 --> 00:36:21,440
been stolen

895
00:36:21,440 --> 00:36:24,480
so technology companies are rich targets

896
00:36:24,480 --> 00:36:27,119
just on their own but these groups

897
00:36:27,119 --> 00:36:29,440
leverage them to invest supply chains

898
00:36:29,440 --> 00:36:32,079
and then to go after those customers

899
00:36:32,079 --> 00:36:34,800
don't underestimate

900
00:36:34,800 --> 00:36:37,040
the capability or intent

901
00:36:37,040 --> 00:36:40,480
of these groups

902
00:36:40,480 --> 00:36:42,880
if you want to try mapping apts to

903
00:36:42,880 --> 00:36:45,119
government and military in china i found

904
00:36:45,119 --> 00:36:48,079
this work by anastasius pingus and i'll

905
00:36:48,079 --> 00:36:50,880
share the link here it's complex

906
00:36:50,880 --> 00:36:52,720
but it's interesting

907
00:36:52,720 --> 00:36:55,839
all right attacks by china these are

908
00:36:55,839 --> 00:36:58,640
some of the most well-known attacks

909
00:36:58,640 --> 00:37:02,079
involving chinese threat sponsored

910
00:37:02,079 --> 00:37:03,839
actors

911
00:37:03,839 --> 00:37:05,599
the russians are formidable but you

912
00:37:05,599 --> 00:37:07,839
really don't want chinese adversaries in

913
00:37:07,839 --> 00:37:09,760
your network

914
00:37:09,760 --> 00:37:12,720
in 2017 there was king slayer

915
00:37:12,720 --> 00:37:14,160
this involved the chinese threat after

916
00:37:14,160 --> 00:37:16,720
group apt 19 and they went after an

917
00:37:16,720 --> 00:37:19,599
administrative software package known as

918
00:37:19,599 --> 00:37:22,560
evlog

919
00:37:22,560 --> 00:37:25,839
a targeted enterprise

920
00:37:26,720 --> 00:37:28,160
sorry

921
00:37:28,160 --> 00:37:30,400
enterize operations globally and this

922
00:37:30,400 --> 00:37:33,119
included military organizations and

923
00:37:33,119 --> 00:37:34,960
defense contractors this is something

924
00:37:34,960 --> 00:37:36,720
the chinese care very much about they're

925
00:37:36,720 --> 00:37:38,320
highly competitive with the west and

926
00:37:38,320 --> 00:37:40,720
they want to gain the upper hand at any

927
00:37:40,720 --> 00:37:43,839
cost these are high value targets it's

928
00:37:43,839 --> 00:37:46,400
an impressive client list and it is very

929
00:37:46,400 --> 00:37:49,200
similar to solarwinds

930
00:37:49,200 --> 00:37:50,800
key point here

931
00:37:50,800 --> 00:37:53,359
several years later and we've still not

932
00:37:53,359 --> 00:37:56,079
known how many of these customers were

933
00:37:56,079 --> 00:38:00,079
and could still be compromised

934
00:38:02,000 --> 00:38:04,960
cc cleaner you've probably heard of it

935
00:38:04,960 --> 00:38:08,000
it seemed like a harmless product until

936
00:38:08,000 --> 00:38:11,520
it wasn't this involved apt 17 axiom

937
00:38:11,520 --> 00:38:13,440
group

938
00:38:13,440 --> 00:38:14,320
again

939
00:38:14,320 --> 00:38:16,000
on the alteration of source code of a

940
00:38:16,000 --> 00:38:18,960
product that was widely downloaded and

941
00:38:18,960 --> 00:38:21,200
convenient for customers how did they

942
00:38:21,200 --> 00:38:23,119
get in there

943
00:38:23,119 --> 00:38:24,160
well

944
00:38:24,160 --> 00:38:26,160
initial compromise

945
00:38:26,160 --> 00:38:27,280
was through an

946
00:38:27,280 --> 00:38:29,680
unattended workstation of a ccleaner

947
00:38:29,680 --> 00:38:32,079
developer who was connected to the

948
00:38:32,079 --> 00:38:34,960
piraform network using a teamviewer

949
00:38:34,960 --> 00:38:36,880
remote

950
00:38:36,880 --> 00:38:38,800
they reused credentials

951
00:38:38,800 --> 00:38:40,560
from previous data breaches we've heard

952
00:38:40,560 --> 00:38:42,560
that many times in order to access the

953
00:38:42,560 --> 00:38:44,240
teamviewer account

954
00:38:44,240 --> 00:38:46,079
and then they delivered malware using

955
00:38:46,079 --> 00:38:48,320
vbscript they developed a malicious

956
00:38:48,320 --> 00:38:50,640
version of ccleaner and they used rdp to

957
00:38:50,640 --> 00:38:52,720
set up a back door on a second

958
00:38:52,720 --> 00:38:54,960
unattended connected computer there they

959
00:38:54,960 --> 00:38:56,800
dropped a binary and another malicious

960
00:38:56,800 --> 00:38:59,280
payload

961
00:38:59,280 --> 00:39:03,200
and went on to claim more and distribute

962
00:39:03,200 --> 00:39:06,240
millions of versions

963
00:39:06,640 --> 00:39:08,920
shadow pad

964
00:39:08,920 --> 00:39:11,839
apt-17 also known as barium they

965
00:39:11,839 --> 00:39:14,240
delivered shadow pad malware to infect

966
00:39:14,240 --> 00:39:16,480
enterprise networks by a product known

967
00:39:16,480 --> 00:39:18,000
as netsurang

968
00:39:18,000 --> 00:39:20,079
netsarang specializes in

969
00:39:20,079 --> 00:39:21,760
server management and security

970
00:39:21,760 --> 00:39:25,200
connectivity software used globally by

971
00:39:25,200 --> 00:39:26,960
major organizations

972
00:39:26,960 --> 00:39:30,079
where have we heard this before

973
00:39:30,079 --> 00:39:33,119
so a module was hidden in a code library

974
00:39:33,119 --> 00:39:35,839
it was making suspicious dns requests

975
00:39:35,839 --> 00:39:38,000
dns it's always dns

976
00:39:38,000 --> 00:39:39,440
and it was sending data back to the

977
00:39:39,440 --> 00:39:40,880
operators who then made the decision

978
00:39:40,880 --> 00:39:44,560
whether they wanted to act on it or not

979
00:39:49,119 --> 00:39:50,640
2020

980
00:39:50,640 --> 00:39:53,440
able desktop there's a chinese apt group

981
00:39:53,440 --> 00:39:55,680
known as lucky mouse who went after chat

982
00:39:55,680 --> 00:39:57,359
software that was being used by the

983
00:39:57,359 --> 00:39:59,680
mongolian government and businesses

984
00:39:59,680 --> 00:40:01,680
there they hijacked updates in the

985
00:40:01,680 --> 00:40:03,680
software supply chain and the attackers

986
00:40:03,680 --> 00:40:05,520
didn't need to steal or forge an update

987
00:40:05,520 --> 00:40:07,920
signature because able's updates were

988
00:40:07,920 --> 00:40:10,160
not signed

989
00:40:10,160 --> 00:40:12,240
an operation sign side targeted the

990
00:40:12,240 --> 00:40:14,319
vietnamese government

991
00:40:14,319 --> 00:40:18,319
looking at their certification authority

992
00:40:18,319 --> 00:40:21,200
they compromised that this software was

993
00:40:21,200 --> 00:40:23,200
mandatory and widely used throughout

994
00:40:23,200 --> 00:40:24,640
vietnam

995
00:40:24,640 --> 00:40:27,440
the key point here is the targeted abuse

996
00:40:27,440 --> 00:40:29,760
of trust by leveraging a service

997
00:40:29,760 --> 00:40:32,079
oligopoly

998
00:40:32,079 --> 00:40:34,800
this is believed to be possibly a group

999
00:40:34,800 --> 00:40:37,839
known as ta-428 who target east asian

1000
00:40:37,839 --> 00:40:39,280
countries

1001
00:40:39,280 --> 00:40:40,800
and also

1002
00:40:40,800 --> 00:40:41,760
russia

1003
00:40:41,760 --> 00:40:43,760
to gather intel

1004
00:40:43,760 --> 00:40:46,880
finally 2020 golden spy this is

1005
00:40:46,880 --> 00:40:49,040
intriguing because this is malware

1006
00:40:49,040 --> 00:40:51,520
embedded in required tax payment

1007
00:40:51,520 --> 00:40:52,400
software

1008
00:40:52,400 --> 00:40:53,920
issued to corporations who want to do

1009
00:40:53,920 --> 00:40:56,319
business in china

1010
00:40:56,319 --> 00:40:58,160
and the chinese banks require businesses

1011
00:40:58,160 --> 00:41:00,720
to install the intelligent tax to pay

1012
00:41:00,720 --> 00:41:02,319
the local taxes

1013
00:41:02,319 --> 00:41:04,240
it's produced by the golden tax

1014
00:41:04,240 --> 00:41:06,960
department does it sound familiar a

1015
00:41:06,960 --> 00:41:09,680
little bit like not petcha perhaps

1016
00:41:09,680 --> 00:41:12,240
well the malware installed a back door

1017
00:41:12,240 --> 00:41:14,880
on systems which enabled a remote spread

1018
00:41:14,880 --> 00:41:17,599
actor to execute windows commands

1019
00:41:17,599 --> 00:41:19,440
and then they could upload and execute

1020
00:41:19,440 --> 00:41:20,800
any binary

1021
00:41:20,800 --> 00:41:22,880
including ransomware

1022
00:41:22,880 --> 00:41:25,520
it's persistent you can't kick it off

1023
00:41:25,520 --> 00:41:27,520
the system

1024
00:41:27,520 --> 00:41:29,440
that malware gave system level

1025
00:41:29,440 --> 00:41:31,680
privileges and it had that capability to

1026
00:41:31,680 --> 00:41:33,359
install anything

1027
00:41:33,359 --> 00:41:36,319
on a system where it's installed

1028
00:41:36,319 --> 00:41:38,640
and then it was connected to a c2 server

1029
00:41:38,640 --> 00:41:41,040
that was distinct from the tax software

1030
00:41:41,040 --> 00:41:44,160
network infrastructure

1031
00:41:44,880 --> 00:41:48,240
so where do we go from here

1032
00:41:48,240 --> 00:41:51,839
there is the new executive order

1033
00:41:51,839 --> 00:41:54,240
but the picture is far bigger

1034
00:41:54,240 --> 00:41:57,118
as you can see now

1035
00:41:57,520 --> 00:41:59,599
package management is an ongoing

1036
00:41:59,599 --> 00:42:02,000
challenge that needs to be done better

1037
00:42:02,000 --> 00:42:04,160
registries of record can help us improve

1038
00:42:04,160 --> 00:42:06,480
reliability in the chain

1039
00:42:06,480 --> 00:42:08,240
but it's like finding a needle in a

1040
00:42:08,240 --> 00:42:11,040
haystack if you have the right security

1041
00:42:11,040 --> 00:42:13,119
telemetry and visibility at the right

1042
00:42:13,119 --> 00:42:17,640
control points in your organization

1043
00:42:18,640 --> 00:42:20,480
these are a couple current resources you

1044
00:42:20,480 --> 00:42:22,000
might want to grab a screenshot if you

1045
00:42:22,000 --> 00:42:23,920
can there that talk about what

1046
00:42:23,920 --> 00:42:26,720
solarwinds learned and shared publicly

1047
00:42:26,720 --> 00:42:29,680
so that you can secure your

1048
00:42:29,680 --> 00:42:33,280
your enterprise your operations better

1049
00:42:33,280 --> 00:42:36,880
there were hard lessons

1050
00:42:40,160 --> 00:42:42,640
and some takeaways

1051
00:42:42,640 --> 00:42:44,880
first we need to be paying more

1052
00:42:44,880 --> 00:42:47,359
attention to the

1053
00:42:47,359 --> 00:42:51,359
open source software that we're using

1054
00:42:51,520 --> 00:42:53,119
we need to change

1055
00:42:53,119 --> 00:42:55,200
what we've been doing and how we've been

1056
00:42:55,200 --> 00:42:57,920
doing it to identify and remediate risks

1057
00:42:57,920 --> 00:43:02,319
because we're missing a lot of stuff

1058
00:43:02,319 --> 00:43:05,119
those legacy security tools

1059
00:43:05,119 --> 00:43:08,079
they're not securing us

1060
00:43:08,079 --> 00:43:09,520
there are some new things out there to

1061
00:43:09,520 --> 00:43:12,160
help us one of them is called six store

1062
00:43:12,160 --> 00:43:15,920
and one of them is called package hunter

1063
00:43:16,640 --> 00:43:18,079
but we need to level up

1064
00:43:18,079 --> 00:43:20,319
okay so i will share this with you this

1065
00:43:20,319 --> 00:43:22,800
came out 2021 sig store it's from the

1066
00:43:22,800 --> 00:43:25,359
linux foundation and it seeks to empower

1067
00:43:25,359 --> 00:43:26,800
software developers to help them

1068
00:43:26,800 --> 00:43:29,839
securely sign software artifacts it's

1069
00:43:29,839 --> 00:43:31,839
free for use by all developers and

1070
00:43:31,839 --> 00:43:34,880
software providers

1071
00:43:39,280 --> 00:43:41,599
and then package hunter this is from get

1072
00:43:41,599 --> 00:43:43,280
lab and you can use it to detect

1073
00:43:43,280 --> 00:43:45,119
malicious code and

1074
00:43:45,119 --> 00:43:47,920
unexpected behavior in your dependencies

1075
00:43:47,920 --> 00:43:49,760
because there's a lot of malicious stuff

1076
00:43:49,760 --> 00:43:51,839
out there in the wild

1077
00:43:51,839 --> 00:43:55,280
it's free and it's open source

1078
00:43:55,280 --> 00:43:56,800
so let me end with this

1079
00:43:56,800 --> 00:43:59,440
i love podcasts and one of my go-to's is

1080
00:43:59,440 --> 00:44:00,800
risky business

1081
00:44:00,800 --> 00:44:03,680
they had a great segment featuring mark

1082
00:44:03,680 --> 00:44:06,319
rogers from octa talking about operation

1083
00:44:06,319 --> 00:44:08,560
aurora

1084
00:44:08,560 --> 00:44:11,359
if you can gain a position of trust

1085
00:44:11,359 --> 00:44:13,520
then you can exploit it

1086
00:44:13,520 --> 00:44:16,960
think about service or non-personal ids

1087
00:44:16,960 --> 00:44:18,400
where you are working

1088
00:44:18,400 --> 00:44:20,400
accounts that nobody

1089
00:44:20,400 --> 00:44:22,240
really scrutinizes

1090
00:44:22,240 --> 00:44:24,720
but that have enough privilege

1091
00:44:24,720 --> 00:44:26,160
to leverage

1092
00:44:26,160 --> 00:44:28,640
and to do e-discovery and to find all

1093
00:44:28,640 --> 00:44:32,319
the stuff you need to launch your attack

1094
00:44:32,319 --> 00:44:33,839
because your chain

1095
00:44:33,839 --> 00:44:37,040
is only as good as its weakest link

1096
00:44:37,040 --> 00:44:38,720
and there are more ways to abuse the

1097
00:44:38,720 --> 00:44:42,560
chain of trust than people realize

1098
00:44:42,560 --> 00:44:44,079
and with that

1099
00:44:44,079 --> 00:44:45,839
i say thank you so very much for your

1100
00:44:45,839 --> 00:44:49,480
time and being here

1101
00:44:51,320 --> 00:44:54,429
[Applause]

1102
00:44:55,520 --> 00:44:56,560
okay

1103
00:44:56,560 --> 00:44:59,680
are there any questions

1104
00:45:01,280 --> 00:45:03,520
got a quick question on the uh

1105
00:45:03,520 --> 00:45:05,839
dependency confusion one do you have any

1106
00:45:05,839 --> 00:45:07,359
more information on that because i think

1107
00:45:07,359 --> 00:45:09,200
like just off the top of my head like

1108
00:45:09,200 --> 00:45:10,160
maven

1109
00:45:10,160 --> 00:45:12,880
you've got there's a like a vendor and

1110
00:45:12,880 --> 00:45:14,640
then the actual specific library then

1111
00:45:14,640 --> 00:45:16,480
like the version the very first thing

1112
00:45:16,480 --> 00:45:18,720
that does when it goes to grab that is

1113
00:45:18,720 --> 00:45:21,440
search your cache on your computer and i

1114
00:45:21,440 --> 00:45:22,960
assume all the others work the same way

1115
00:45:22,960 --> 00:45:24,400
and everyone knows assuming is a smart

1116
00:45:24,400 --> 00:45:27,040
thing to do um and so

1117
00:45:27,040 --> 00:45:28,640
i'm just wondering do you have any idea

1118
00:45:28,640 --> 00:45:30,079
like any more information on how i've

1119
00:45:30,079 --> 00:45:31,200
never heard of that particular

1120
00:45:31,200 --> 00:45:32,960
compromise and how that would work

1121
00:45:32,960 --> 00:45:35,119
because it would search locally then it

1122
00:45:35,119 --> 00:45:37,520
goes off to nexus or archiva then if

1123
00:45:37,520 --> 00:45:39,040
they can't find it there that nexus or

1124
00:45:39,040 --> 00:45:41,119
archive then goes out to the main public

1125
00:45:41,119 --> 00:45:43,040
repo so i was just curious

1126
00:45:43,040 --> 00:45:44,400
well that's the beauty of it and that's

1127
00:45:44,400 --> 00:45:46,720
why alex berson was asking the questions

1128
00:45:46,720 --> 00:45:49,200
if you google alex person there's a

1129
00:45:49,200 --> 00:45:51,440
couple of real there's several really

1130
00:45:51,440 --> 00:45:54,160
good write-ups about it and and who was

1131
00:45:54,160 --> 00:45:56,400
impacted and where it's gone from there

1132
00:45:56,400 --> 00:45:58,800
and they're citing dependency confusion

1133
00:45:58,800 --> 00:46:01,119
style attacks increasingly now when it

1134
00:46:01,119 --> 00:46:05,359
comes to software chain and repositories

1135
00:46:05,359 --> 00:46:08,598
a b-i-r-s-a-n

1136
00:46:08,720 --> 00:46:10,959
okay

1137
00:46:11,680 --> 00:46:15,240
any other questions

1138
00:46:21,920 --> 00:46:24,160
okay

1139
00:46:24,160 --> 00:46:25,359
all right

1140
00:46:25,359 --> 00:46:27,200
please go have a good drink and a nice

1141
00:46:27,200 --> 00:46:29,040
dinner and thank you so much for your

1142
00:46:29,040 --> 00:46:30,070
time

1143
00:46:30,070 --> 00:46:35,510
[Applause]

