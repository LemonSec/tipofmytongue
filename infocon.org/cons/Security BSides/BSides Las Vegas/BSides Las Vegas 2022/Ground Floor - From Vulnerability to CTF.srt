1
00:00:00,120 --> 00:00:03,899
I want to introduce to you Ron Bose lead

2
00:00:03,899 --> 00:00:07,680
researcher at rapid7 and for the next

3
00:00:07,680 --> 00:00:09,179
session he's going to tell us about from

4
00:00:09,179 --> 00:00:12,500
vulnerability to CTF

5
00:00:17,520 --> 00:00:19,140
hello everyone

6
00:00:19,140 --> 00:00:19,859
um

7
00:00:19,859 --> 00:00:21,900
thank you all for coming this is the

8
00:00:21,900 --> 00:00:24,060
first talk I've done to a live audience

9
00:00:24,060 --> 00:00:25,439
in like three years

10
00:00:25,439 --> 00:00:27,119
so my only Quest is laugh I make jokes

11
00:00:27,119 --> 00:00:28,320
because that way I feel like there's

12
00:00:28,320 --> 00:00:29,580
actually people around

13
00:00:29,580 --> 00:00:31,080
I've been talking to a webcam for years

14
00:00:31,080 --> 00:00:32,520
and it's been awful

15
00:00:32,520 --> 00:00:34,860
so yeah thanks all for coming

16
00:00:34,860 --> 00:00:36,360
this talk is basically going to start

17
00:00:36,360 --> 00:00:38,040
off with me talking about myself

18
00:00:38,040 --> 00:00:40,680
and uh but what my background is what

19
00:00:40,680 --> 00:00:42,719
I've done what I do now stuff like that

20
00:00:42,719 --> 00:00:44,579
then we'll talk about ctfs capture

21
00:00:44,579 --> 00:00:45,840
flight challenges

22
00:00:45,840 --> 00:00:47,520
I've worked on ctfs in a bunch of

23
00:00:47,520 --> 00:00:49,320
different contexts over the years and I

24
00:00:49,320 --> 00:00:50,700
think a lot of them are

25
00:00:50,700 --> 00:00:52,199
there's a lot of good things about ctfs

26
00:00:52,199 --> 00:00:53,940
that we can really learn from

27
00:00:53,940 --> 00:00:55,440
then the kind of point of the talk is I

28
00:00:55,440 --> 00:00:57,059
want to talk about vulnerabilities I

29
00:00:57,059 --> 00:00:58,739
want to go over I think five or six or

30
00:00:58,739 --> 00:01:00,840
seven vulnerabilities that either I

31
00:01:00,840 --> 00:01:03,840
found or I've known about I've turned

32
00:01:03,840 --> 00:01:05,519
the CTF challenges that's where I talk

33
00:01:05,519 --> 00:01:08,900
about the process of how I do that and

34
00:01:08,900 --> 00:01:11,220
I think bones are cool and I want to

35
00:01:11,220 --> 00:01:12,360
talk about them for an hour and that's

36
00:01:12,360 --> 00:01:13,380
what we're gonna do

37
00:01:13,380 --> 00:01:14,820
another thing I want to say about what

38
00:01:14,820 --> 00:01:17,520
we learned just to wrap it all up

39
00:01:17,520 --> 00:01:20,939
so who am I I am Ron Bose as our empty

40
00:01:20,939 --> 00:01:22,740
Santa my rapid7 I'm a lasikiri

41
00:01:22,740 --> 00:01:24,540
researcher which is the fancy wave

42
00:01:24,540 --> 00:01:26,820
saying I'm a uh I write blogs and

43
00:01:26,820 --> 00:01:28,380
recommends playing stuff

44
00:01:28,380 --> 00:01:31,979
my handle everywhere is Yago xa6 uh Yago

45
00:01:31,979 --> 00:01:34,920
from Shakespeare Othello nx86 from the

46
00:01:34,920 --> 00:01:36,360
CPU

47
00:01:36,360 --> 00:01:38,220
you can find me on GitHub on Twitter on

48
00:01:38,220 --> 00:01:40,380
Steam on pretty much every platform

49
00:01:40,380 --> 00:01:43,079
I do that there Elias

50
00:01:43,079 --> 00:01:44,640
so I want to share with my family first

51
00:01:44,640 --> 00:01:47,280
just you know let you get to know me

52
00:01:47,280 --> 00:01:49,020
um I have a husband who doesn't like his

53
00:01:49,020 --> 00:01:51,720
picture public and I we have two birds

54
00:01:51,720 --> 00:01:53,220
together they're both green cheek

55
00:01:53,220 --> 00:01:55,920
conures gcc's and because they're gccs

56
00:01:55,920 --> 00:01:57,899
we named them playing a shark

57
00:01:57,899 --> 00:01:59,939
so flying on the left we've had for

58
00:01:59,939 --> 00:02:01,680
about two years and sharp is brand new

59
00:02:01,680 --> 00:02:03,420
we hired for we have him for like a

60
00:02:03,420 --> 00:02:04,740
month

61
00:02:04,740 --> 00:02:07,140
Spock squawk thank you uh they love

62
00:02:07,140 --> 00:02:08,580
joining my video calls and stuff at work

63
00:02:08,580 --> 00:02:10,258
it's a lot of fun they're

64
00:02:10,258 --> 00:02:12,300
here are the little troublemakers if I

65
00:02:12,300 --> 00:02:14,099
just want to show them off every CTF I

66
00:02:14,099 --> 00:02:17,160
make has them in there in some way now

67
00:02:17,160 --> 00:02:18,720
so at the level open source development

68
00:02:18,720 --> 00:02:21,300
and uh I kind of got my starts doing

69
00:02:21,300 --> 00:02:23,879
like researchy stuff working on edmap

70
00:02:23,879 --> 00:02:25,739
and Brandon who's in the front row being

71
00:02:25,739 --> 00:02:27,239
able to end up together back in like 20

72
00:02:27,239 --> 00:02:29,879
2009 2010 and he dragged me a tour

73
00:02:29,879 --> 00:02:31,800
trying to do a talk in like 2011 and I

74
00:02:31,800 --> 00:02:33,900
got to talk about nmap and that was kind

75
00:02:33,900 --> 00:02:35,580
of cool my first big talk

76
00:02:35,580 --> 00:02:37,980
these days I work on the medisp flight

77
00:02:37,980 --> 00:02:40,140
before time I research vulnerability

78
00:02:40,140 --> 00:02:41,459
stuff like that I'll talk about that

79
00:02:41,459 --> 00:02:42,300
more

80
00:02:42,300 --> 00:02:43,680
I've written tools for like hash

81
00:02:43,680 --> 00:02:45,300
extension attacks

82
00:02:45,300 --> 00:02:46,019
um

83
00:02:46,019 --> 00:02:47,519
yeah I do lots of Open Source work I've

84
00:02:47,519 --> 00:02:49,680
done a DNS Factor DNS tattoo so you

85
00:02:49,680 --> 00:02:51,660
might have heard of

86
00:02:51,660 --> 00:02:53,640
uh my last three jobs

87
00:02:53,640 --> 00:02:54,840
it turns out they're all kind of the

88
00:02:54,840 --> 00:02:56,280
same thing

89
00:02:56,280 --> 00:02:58,800
uh 2013 I moved to the States from

90
00:02:58,800 --> 00:03:01,319
Canada to work on to work at Google

91
00:03:01,319 --> 00:03:03,780
um I would we would do among other

92
00:03:03,780 --> 00:03:05,099
things reviewing our own products

93
00:03:05,099 --> 00:03:08,879
finding bugs in Google stuff and then

94
00:03:08,879 --> 00:03:10,319
disclosing those bugs to the product

95
00:03:10,319 --> 00:03:11,940
teams and they would fix some stuff very

96
00:03:11,940 --> 00:03:13,379
much like internal

97
00:03:13,379 --> 00:03:15,480
then I jump to counter hack which is uh

98
00:03:15,480 --> 00:03:17,040
run by let's go this is sort of a

99
00:03:17,040 --> 00:03:19,500
affiliate ascends in that counter hack

100
00:03:19,500 --> 00:03:20,819
we would do pen testing for customers

101
00:03:20,819 --> 00:03:22,680
which meant finding vulnerabilities and

102
00:03:22,680 --> 00:03:24,300
customer software and then setting up to

103
00:03:24,300 --> 00:03:25,920
the customers and what's really cool

104
00:03:25,920 --> 00:03:27,120
about counter hack is we would also do

105
00:03:27,120 --> 00:03:29,159
ctfs which I'll talk about soon

106
00:03:29,159 --> 00:03:31,739
and the vulnerabilities from customers

107
00:03:31,739 --> 00:03:34,140
would feed the ctfs as like ideas for

108
00:03:34,140 --> 00:03:36,840
challenges which it talks about and then

109
00:03:36,840 --> 00:03:39,480
the the trouble people had or the things

110
00:03:39,480 --> 00:03:40,980
people applying on the sea of challenges

111
00:03:40,980 --> 00:03:42,239
with feedback into our pen test business

112
00:03:42,239 --> 00:03:43,920
so it's a really nice two-way street and

113
00:03:43,920 --> 00:03:46,200
that's okay gave me idea for this talk

114
00:03:46,200 --> 00:03:48,299
and then about I guess in April this

115
00:03:48,299 --> 00:03:49,980
year I started working at rapid7 so I'm

116
00:03:49,980 --> 00:03:52,019
very very new there and representative I

117
00:03:52,019 --> 00:03:53,580
do all the same things I take software I

118
00:03:53,580 --> 00:03:55,260
find bugs and stuff but now I just

119
00:03:55,260 --> 00:03:56,640
released it to public I can talk about

120
00:03:56,640 --> 00:03:59,819
it I write Vlogs I play plugins

121
00:03:59,819 --> 00:04:01,680
um attackerkb.com is where we post a lot

122
00:04:01,680 --> 00:04:03,480
of our write-ups it's a really cool site

123
00:04:03,480 --> 00:04:06,000
in my opinion as an employee but also we

124
00:04:06,000 --> 00:04:07,319
do really deep Dives on uh

125
00:04:07,319 --> 00:04:08,760
vulnerabilities

126
00:04:08,760 --> 00:04:10,319
it's a

127
00:04:10,319 --> 00:04:12,060
it's one of you okay look at things it's

128
00:04:12,060 --> 00:04:14,720
a pretty cool site

129
00:04:15,120 --> 00:04:16,918
in terms of CTF

130
00:04:16,918 --> 00:04:17,940
um

131
00:04:17,940 --> 00:04:20,160
going back to like 2009 or so I've been

132
00:04:20,160 --> 00:04:22,320
playing ctfs a large use for skull space

133
00:04:22,320 --> 00:04:24,120
which was our um hacker space in

134
00:04:24,120 --> 00:04:25,680
Winnipeg by hometown

135
00:04:25,680 --> 00:04:27,479
and later on the

136
00:04:27,479 --> 00:04:30,660
I did Defcon CTF with stratum or her uh

137
00:04:30,660 --> 00:04:31,979
some of the folks from that from that

138
00:04:31,979 --> 00:04:34,139
team are here somewhere

139
00:04:34,139 --> 00:04:35,340
so

140
00:04:35,340 --> 00:04:38,280
yes is a player for a long long time and

141
00:04:38,280 --> 00:04:40,380
then I gotta started doing ctfs as a

142
00:04:40,380 --> 00:04:42,180
Creator so I make the Beats High San

143
00:04:42,180 --> 00:04:44,759
Francisco CTF along with uh Brendan and

144
00:04:44,759 --> 00:04:46,919
Daniel and some others

145
00:04:46,919 --> 00:04:47,699
um

146
00:04:47,699 --> 00:04:49,919
my previous job we made that were CTF

147
00:04:49,919 --> 00:04:52,440
which is like it's a paid thing concerns

148
00:04:52,440 --> 00:04:53,759
again me and Daniel work on that

149
00:04:53,759 --> 00:04:55,560
together and then Holly heck challenge

150
00:04:55,560 --> 00:04:57,540
20 holiday hack challenge is a free

151
00:04:57,540 --> 00:04:59,160
thing that that sounds and kind of how

152
00:04:59,160 --> 00:05:02,340
to do every year and that's a huge video

153
00:05:02,340 --> 00:05:04,380
game CTF which we're really proud of

154
00:05:04,380 --> 00:05:06,300
again me and Daniel worked on that

155
00:05:06,300 --> 00:05:07,740
I should mention I'm gonna put this I

156
00:05:07,740 --> 00:05:09,360
LinkedIn slides on the last slide so

157
00:05:09,360 --> 00:05:10,440
you'll be able to get there if you want

158
00:05:10,440 --> 00:05:12,060
them

159
00:05:12,060 --> 00:05:15,419
I should mention what is a CTF uh CTF is

160
00:05:15,419 --> 00:05:17,520
a capture the flag challenge basically

161
00:05:17,520 --> 00:05:18,960
if you don't know there's multiple

162
00:05:18,960 --> 00:05:20,340
different kinds I don't get into like a

163
00:05:20,340 --> 00:05:22,380
nitty-gritty things but they're very

164
00:05:22,380 --> 00:05:24,060
short versions that players solve

165
00:05:24,060 --> 00:05:25,860
security related challenges for points

166
00:05:25,860 --> 00:05:27,479
sometimes we just give them a question

167
00:05:27,479 --> 00:05:29,400
answer sometimes they attack each

168
00:05:29,400 --> 00:05:31,440
other's like infrastructure either way

169
00:05:31,440 --> 00:05:33,660
it's security challenges or points and

170
00:05:33,660 --> 00:05:35,220
see if you have time tracks I love the

171
00:05:35,220 --> 00:05:39,060
ctfs most CTS probably all of them

172
00:05:39,060 --> 00:05:41,100
so I want to show off a little bit of

173
00:05:41,100 --> 00:05:42,060
History because I think it's kind of

174
00:05:42,060 --> 00:05:42,840
cool

175
00:05:42,840 --> 00:05:44,340
the first CTF I did as a player was

176
00:05:44,340 --> 00:05:47,400
called stripe CTF in the 2010 apparently

177
00:05:47,400 --> 00:05:50,400
and one big takeaway from that CTF was

178
00:05:50,400 --> 00:05:53,039
the final challenge was a hash extension

179
00:05:53,039 --> 00:05:55,020
vulnerability at the time I'd never

180
00:05:55,020 --> 00:05:57,600
heard of hash extension ever and the

181
00:05:57,600 --> 00:05:59,520
concept of it just blew my mind and

182
00:05:59,520 --> 00:06:00,900
there's no tools for it there was white

183
00:06:00,900 --> 00:06:03,120
papers but no like easy to follow

184
00:06:03,120 --> 00:06:04,440
documentation

185
00:06:04,440 --> 00:06:05,639
so

186
00:06:05,639 --> 00:06:08,460
I read the white papers I wrote code I

187
00:06:08,460 --> 00:06:10,020
hated it it was really hard I'm not very

188
00:06:10,020 --> 00:06:12,000
good at reading academic stuff but I got

189
00:06:12,000 --> 00:06:13,080
through it and managed to write a proof

190
00:06:13,080 --> 00:06:13,979
of concept

191
00:06:13,979 --> 00:06:16,259
exploit for md5 shot one shot two days

192
00:06:16,259 --> 00:06:18,419
six Etc I made a tool called hash

193
00:06:18,419 --> 00:06:20,639
extender and I wrote some Vlogs and

194
00:06:20,639 --> 00:06:22,380
that's now like the best known tool for

195
00:06:22,380 --> 00:06:24,539
it so I can really thank CTF for getting

196
00:06:24,539 --> 00:06:26,039
the idea to do that I learned something

197
00:06:26,039 --> 00:06:27,960
I'd never learned before

198
00:06:27,960 --> 00:06:30,600
uh the photos on the right are from a

199
00:06:30,600 --> 00:06:33,539
2013 CTF called plaid CTF I just put

200
00:06:33,539 --> 00:06:34,860
them there because like the story the

201
00:06:34,860 --> 00:06:36,600
kid in the bottom right hiding behind

202
00:06:36,600 --> 00:06:38,220
the brace acting boxes the name Ethan

203
00:06:38,220 --> 00:06:40,740
he's my buddies kid and he came with a

204
00:06:40,740 --> 00:06:42,780
cape on and I said why do you have a

205
00:06:42,780 --> 00:06:44,220
cable on Ethan and he says I'm a

206
00:06:44,220 --> 00:06:45,180
dinosaur

207
00:06:45,180 --> 00:06:46,800
I was like

208
00:06:46,800 --> 00:06:49,440
can turkey with that

209
00:06:49,440 --> 00:06:51,840
so I think about 7 A.M after working all

210
00:06:51,840 --> 00:06:53,460
night on the top right I had to keep on

211
00:06:53,460 --> 00:06:54,720
I don't remember why I thought it was a

212
00:06:54,720 --> 00:06:58,460
good idea but it was also a dinosaur

213
00:06:58,620 --> 00:07:02,160
so in 2010 as a as a hacker space me and

214
00:07:02,160 --> 00:07:03,960
skull space worked on quality hack

215
00:07:03,960 --> 00:07:05,940
challenge 2010

216
00:07:05,940 --> 00:07:07,319
uh that was back when Daniel was an

217
00:07:07,319 --> 00:07:08,460
intern there

218
00:07:08,460 --> 00:07:10,919
and we won and Ed

219
00:07:10,919 --> 00:07:12,900
wrote like you guys totally rocked you

220
00:07:12,900 --> 00:07:15,060
did awesome you're making cool stuff

221
00:07:15,060 --> 00:07:17,819
happen and that was in March 2020 2011.

222
00:07:17,819 --> 00:07:19,680
so it took three months to pick winners

223
00:07:19,680 --> 00:07:23,340
which pretty much is how we always do it

224
00:07:23,340 --> 00:07:25,199
um what's cool though about this is that

225
00:07:25,199 --> 00:07:28,020
2011 it told me how good I did and then

226
00:07:28,020 --> 00:07:30,720
in 2017 I was working for him so I'm

227
00:07:30,720 --> 00:07:31,800
really proud that I was able to kind of

228
00:07:31,800 --> 00:07:33,660
turn doing ctfs especially doing them

229
00:07:33,660 --> 00:07:36,660
for like Ed into part of my career

230
00:07:36,660 --> 00:07:37,560
and that's like one of the reasons I

231
00:07:37,560 --> 00:07:38,639
like talking about this is because like

232
00:07:38,639 --> 00:07:40,500
CTS has done so much for me that I think

233
00:07:40,500 --> 00:07:43,020
it's really cool to talk about

234
00:07:43,020 --> 00:07:44,160
um this is the first idea of I wrote

235
00:07:44,160 --> 00:07:46,020
this is my playing notes I actually dug

236
00:07:46,020 --> 00:07:47,699
through my pile of notebooks I found

237
00:07:47,699 --> 00:07:49,560
this and I wrote notes for how I want to

238
00:07:49,560 --> 00:07:51,180
make a CTF and I don't want to read all

239
00:07:51,180 --> 00:07:52,259
these you're welcome to download the

240
00:07:52,259 --> 00:07:54,599
slides later and read them but the funny

241
00:07:54,599 --> 00:07:56,340
thing is I rented these I'm thinking oh

242
00:07:56,340 --> 00:07:57,539
yeah I made this challenge again and

243
00:07:57,539 --> 00:07:59,340
again and again there's a few things I

244
00:07:59,340 --> 00:08:01,379
really like making challenges out of and

245
00:08:01,379 --> 00:08:05,580
as far back as 2011 I was still doing it

246
00:08:05,580 --> 00:08:07,259
but the first big CTF I did was B-side

247
00:08:07,259 --> 00:08:09,000
San Francisco and I'm almost done

248
00:08:09,000 --> 00:08:11,160
talking to myself I promise

249
00:08:11,160 --> 00:08:13,740
um the story behind this was I was out I

250
00:08:13,740 --> 00:08:15,120
met Reed Lowden who's somewhere at this

251
00:08:15,120 --> 00:08:16,379
conference I don't think he's in the

252
00:08:16,379 --> 00:08:18,419
room and

253
00:08:18,419 --> 00:08:20,099
we we went out for lunch or something

254
00:08:20,099 --> 00:08:21,960
when I was in San Francisco visiting but

255
00:08:21,960 --> 00:08:23,460
he said hey you don't make ctfs do you

256
00:08:23,460 --> 00:08:27,300
want to do rctf and I was like sure and

257
00:08:27,300 --> 00:08:29,340
we did it and I recorded Brandon and

258
00:08:29,340 --> 00:08:30,960
Daniel and others to help make the CTF

259
00:08:30,960 --> 00:08:33,479
and it ended up being like fairly

260
00:08:33,479 --> 00:08:34,860
successful and we've been doing it for

261
00:08:34,860 --> 00:08:37,200
five years now and each year is better

262
00:08:37,200 --> 00:08:39,479
than the last so we do that every spring

263
00:08:39,479 --> 00:08:41,519
I think we're doing this one in April

264
00:08:41,519 --> 00:08:44,159
so it's really cool to uh

265
00:08:44,159 --> 00:08:46,260
see we get to do a big CTF and I'm

266
00:08:46,260 --> 00:08:47,700
really happy that that besides San

267
00:08:47,700 --> 00:08:50,100
Francisco sorry gives me the the time

268
00:08:50,100 --> 00:08:52,680
and Trust read basically says to us like

269
00:08:52,680 --> 00:08:54,899
make a CTF let me know what you need and

270
00:08:54,899 --> 00:08:56,160
then it goes off and we do our own thing

271
00:08:56,160 --> 00:08:57,480
for

272
00:08:57,480 --> 00:08:59,820
six months can we make a CTF it's pretty

273
00:08:59,820 --> 00:09:01,860
cool

274
00:09:01,860 --> 00:09:03,540
so let's talk about why ctfs are

275
00:09:03,540 --> 00:09:04,800
valuable I think I've touched on this a

276
00:09:04,800 --> 00:09:07,140
lot already but I feel like I should do

277
00:09:07,140 --> 00:09:07,800
more than just talk about

278
00:09:07,800 --> 00:09:09,120
vulnerabilities although I like talking

279
00:09:09,120 --> 00:09:10,980
about vulnerabilities

280
00:09:10,980 --> 00:09:13,380
so this is the best open open licensed

281
00:09:13,380 --> 00:09:15,180
image I could find this sort of

282
00:09:15,180 --> 00:09:17,820
from a easy Google search to say kind of

283
00:09:17,820 --> 00:09:18,839
like people learn a little bit of what

284
00:09:18,839 --> 00:09:20,760
they read and a lot of what they do and

285
00:09:20,760 --> 00:09:22,560
then even more of what they teach

286
00:09:22,560 --> 00:09:23,700
so

287
00:09:23,700 --> 00:09:26,459
ctfs are hands-on experience for things

288
00:09:26,459 --> 00:09:27,899
that people don't typically get hands-on

289
00:09:27,899 --> 00:09:29,459
experience doing but not everyone

290
00:09:29,459 --> 00:09:30,899
especially if people are younger or new

291
00:09:30,899 --> 00:09:32,580
in their careers are privileged enough

292
00:09:32,580 --> 00:09:34,620
to like be able to hack things like I've

293
00:09:34,620 --> 00:09:36,360
been able to as a pen tester or as a

294
00:09:36,360 --> 00:09:37,980
researcher or whatever

295
00:09:37,980 --> 00:09:40,019
so like being able to teach people

296
00:09:40,019 --> 00:09:41,760
things and let them actually do and get

297
00:09:41,760 --> 00:09:44,040
Hands-On work is super super valuable

298
00:09:44,040 --> 00:09:45,899
and Bug bounties these days kind of fill

299
00:09:45,899 --> 00:09:47,160
that role too

300
00:09:47,160 --> 00:09:49,680
but not gonna talk about those

301
00:09:49,680 --> 00:09:51,600
also with CTS

302
00:09:51,600 --> 00:09:53,459
write-ups are very much encouraged and

303
00:09:53,459 --> 00:09:55,200
that's where teachings where it comes in

304
00:09:55,200 --> 00:09:56,820
for Holiday hack challenge we would do

305
00:09:56,820 --> 00:09:58,860
we would value evaluate People based on

306
00:09:58,860 --> 00:10:01,320
their write-ups not based on what they

307
00:10:01,320 --> 00:10:03,600
actually did we would have a hundred

308
00:10:03,600 --> 00:10:04,860
people finish here to a thousand people

309
00:10:04,860 --> 00:10:06,360
I don't know the numbers but a lot of

310
00:10:06,360 --> 00:10:08,279
people finish it and then would write

311
00:10:08,279 --> 00:10:11,459
out submissions of their Solutions and

312
00:10:11,459 --> 00:10:12,720
we would pick the ones that are our

313
00:10:12,720 --> 00:10:14,640
favorite technically and our favorite

314
00:10:14,640 --> 00:10:16,740
creatively so this is just an example I

315
00:10:16,740 --> 00:10:19,320
found not just from Googling around

316
00:10:19,320 --> 00:10:21,959
he and like he runs into the travel log

317
00:10:21,959 --> 00:10:23,760
I believe and it's really cool that

318
00:10:23,760 --> 00:10:25,200
people will then take the things they

319
00:10:25,200 --> 00:10:28,019
learn and share with others and like for

320
00:10:28,019 --> 00:10:29,339
myself I would always wrap some of my

321
00:10:29,339 --> 00:10:31,079
CTF challenges as an author and as a

322
00:10:31,079 --> 00:10:32,820
doer and I think it's really good to

323
00:10:32,820 --> 00:10:35,640
like really really learn things

324
00:10:35,640 --> 00:10:36,839
well I think it's funny you were talking

325
00:10:36,839 --> 00:10:39,660
about as laundering and that no one told

326
00:10:39,660 --> 00:10:40,980
me I can't use this word but it feels a

327
00:10:40,980 --> 00:10:42,720
little bit

328
00:10:42,720 --> 00:10:45,420
weird but basically

329
00:10:45,420 --> 00:10:47,279
as a pen tester we often do work for

330
00:10:47,279 --> 00:10:48,959
customers and they often have really

331
00:10:48,959 --> 00:10:50,640
cool bugs in their software that we

332
00:10:50,640 --> 00:10:51,600
can't talk about because they're

333
00:10:51,600 --> 00:10:53,940
customers but feeding those bugs into

334
00:10:53,940 --> 00:10:56,040
like what's the core of this bug there's

335
00:10:56,040 --> 00:10:58,140
nothing to do with a customer but that

336
00:10:58,140 --> 00:10:59,880
we can teach people as a lesson so that

337
00:10:59,880 --> 00:11:01,800
when they see this bug they'll find it

338
00:11:01,800 --> 00:11:03,720
so I'll talk about some of those after

339
00:11:03,720 --> 00:11:05,459
what's actually really funny about these

340
00:11:05,459 --> 00:11:06,899
is oftentimes bugs you find your real

341
00:11:06,899 --> 00:11:09,360
stuff are too simple or too silly to

342
00:11:09,360 --> 00:11:12,480
really be bugs you see in ctfs people

343
00:11:12,480 --> 00:11:14,459
look and go look there's no way that

344
00:11:14,459 --> 00:11:16,860
would be a real bug it's just too silly

345
00:11:16,860 --> 00:11:21,060
but a lot of real bugs are that silly

346
00:11:21,060 --> 00:11:22,680
this is kind of a

347
00:11:22,680 --> 00:11:25,079
weirder concept

348
00:11:25,079 --> 00:11:27,060
when I was young I had a couple slides

349
00:11:27,060 --> 00:11:28,200
about this I removed because I thought

350
00:11:28,200 --> 00:11:29,279
it was just too much talk about myself

351
00:11:29,279 --> 00:11:30,720
there's already too much talking to

352
00:11:30,720 --> 00:11:32,640
myself when I was young I did a lot of

353
00:11:32,640 --> 00:11:36,060
video game hacking a 2017-18 or when I

354
00:11:36,060 --> 00:11:38,640
was 17 18 19 I got really into Blitzer

355
00:11:38,640 --> 00:11:40,200
games and regrow cheats and stuff for

356
00:11:40,200 --> 00:11:42,300
Starcraft and and Warcraft 2 and

357
00:11:42,300 --> 00:11:43,680
Warcraft 3 and stuff

358
00:11:43,680 --> 00:11:45,540
and like reverse engineering how those

359
00:11:45,540 --> 00:11:47,279
games worked and how the logins worked

360
00:11:47,279 --> 00:11:49,019
and how their profiles work they have

361
00:11:49,019 --> 00:11:50,639
their anti-cheat work and stuff I

362
00:11:50,639 --> 00:11:52,860
learned a lot as like a 17 18 19 year

363
00:11:52,860 --> 00:11:55,019
old and

364
00:11:55,019 --> 00:11:57,360
you that those those systems don't exist

365
00:11:57,360 --> 00:11:58,800
anymore they only use the same logins

366
00:11:58,800 --> 00:12:00,959
anymore so being able to share those

367
00:12:00,959 --> 00:12:03,360
with others and say like here's where I

368
00:12:03,360 --> 00:12:04,500
learned how to do this here's where I

369
00:12:04,500 --> 00:12:06,180
cut my teeth here's what I thought was

370
00:12:06,180 --> 00:12:07,980
interesting and being able to wrap it up

371
00:12:07,980 --> 00:12:10,620
into a challenge is really cool

372
00:12:10,620 --> 00:12:12,180
um so I feel like I'm kind of honoring

373
00:12:12,180 --> 00:12:14,220
the vulnerabilities by

374
00:12:14,220 --> 00:12:15,540
showing people

375
00:12:15,540 --> 00:12:17,519
kind of how they worked

376
00:12:17,519 --> 00:12:20,040
we'll talk about a couple of those

377
00:12:20,040 --> 00:12:21,000
so now I want to talk about

378
00:12:21,000 --> 00:12:22,680
vulnerabilities

379
00:12:22,680 --> 00:12:25,260
this is kind of meat of the talk and

380
00:12:25,260 --> 00:12:27,000
I think I have about six or so

381
00:12:27,000 --> 00:12:29,100
vulnerabilities I want to talk about and

382
00:12:29,100 --> 00:12:30,540
we're gonna go pretty quick but on each

383
00:12:30,540 --> 00:12:32,279
one I have links to write-ups about them

384
00:12:32,279 --> 00:12:34,440
I have links to the source code I've got

385
00:12:34,440 --> 00:12:36,000
a couple live challenges ready to go if

386
00:12:36,000 --> 00:12:38,339
they don't mess up if I do mess them up

387
00:12:38,339 --> 00:12:42,060
I still have slides with screenshots

388
00:12:42,060 --> 00:12:43,680
so the first vulnerability I want to

389
00:12:43,680 --> 00:12:46,620
talk about is CV 2020 1388

390
00:12:46,620 --> 00:12:48,959
uh this was a this is the first thing I

391
00:12:48,959 --> 00:12:51,360
worked on at the rapid seven and I'm

392
00:12:51,360 --> 00:12:53,220
just going to click on my analysis to

393
00:12:53,220 --> 00:12:55,200
show off if you want to read this I have

394
00:12:55,200 --> 00:12:56,820
a lot a lot a lot of detail about how it

395
00:12:56,820 --> 00:12:58,860
works including assembly and clean proof

396
00:12:58,860 --> 00:13:02,459
of concept like I wrote a lot about this

397
00:13:02,459 --> 00:13:05,100
but I'll give you the sort of 50 000

398
00:13:05,100 --> 00:13:06,899
foot view if you're interested in seeing

399
00:13:06,899 --> 00:13:08,940
more that's cool if you can't read the

400
00:13:08,940 --> 00:13:10,560
terminal text at the bottom that's just

401
00:13:10,560 --> 00:13:12,120
a screenshot from the page I just showed

402
00:13:12,120 --> 00:13:14,220
you so you're absolutely welcome to just

403
00:13:14,220 --> 00:13:16,980
read it yourself

404
00:13:16,980 --> 00:13:19,200
basically

405
00:13:19,200 --> 00:13:22,440
fi's big-ip device was vulnerable to a

406
00:13:22,440 --> 00:13:25,260
uh authentication bypass and that's a

407
00:13:25,260 --> 00:13:26,399
pretty common vulnerability class

408
00:13:26,399 --> 00:13:27,779
because it's really easy to mess up

409
00:13:27,779 --> 00:13:29,339
Authentication

410
00:13:29,339 --> 00:13:32,880
so the way the authentication works

411
00:13:32,880 --> 00:13:35,639
currently even like to this day

412
00:13:35,639 --> 00:13:37,139
um

413
00:13:37,139 --> 00:13:40,260
basically there's the F5 server I I do

414
00:13:40,260 --> 00:13:41,579
it a size two different servers but

415
00:13:41,579 --> 00:13:42,420
really

416
00:13:42,420 --> 00:13:44,040
there's two Services running on one

417
00:13:44,040 --> 00:13:47,160
server the first the first service is a

418
00:13:47,160 --> 00:13:49,980
reverse property the reverse proxy would

419
00:13:49,980 --> 00:13:52,500
do some types authentication not others

420
00:13:52,500 --> 00:13:54,000
and then there's a backend that runs on

421
00:13:54,000 --> 00:13:54,959
localhost

422
00:13:54,959 --> 00:13:56,399
and that does a different type of

423
00:13:56,399 --> 00:13:58,800
authentication but not the others

424
00:13:58,800 --> 00:14:00,779
so like whether you're using a password

425
00:14:00,779 --> 00:14:03,360
versus whether you use a token are

426
00:14:03,360 --> 00:14:04,860
handled by different

427
00:14:04,860 --> 00:14:07,079
Services which is a really strange way

428
00:14:07,079 --> 00:14:08,820
of doing things I'm sure it's historical

429
00:14:08,820 --> 00:14:10,800
reasons ultimately

430
00:14:10,800 --> 00:14:12,360
but

431
00:14:12,360 --> 00:14:14,519
what happens then if you applicate with

432
00:14:14,519 --> 00:14:16,079
a token so you'll see at the bottom I

433
00:14:16,079 --> 00:14:19,500
send the X5 xf5 off token equals blah

434
00:14:19,500 --> 00:14:20,940
blah blah

435
00:14:20,940 --> 00:14:22,860
um if you're thinking with a token

436
00:14:22,860 --> 00:14:25,860
the reverse proxy sees a token and says

437
00:14:25,860 --> 00:14:27,959
I only had I don't know how to tokens

438
00:14:27,959 --> 00:14:29,940
that's not my thing I'm gonna forward

439
00:14:29,940 --> 00:14:31,320
this onto the back end

440
00:14:31,320 --> 00:14:33,839
so when the back end receives it it goes

441
00:14:33,839 --> 00:14:36,420
is there a token yes okay I'm gonna get

442
00:14:36,420 --> 00:14:38,519
this token and if it's wrong I push back

443
00:14:38,519 --> 00:14:40,380
if it's right I accept it

444
00:14:40,380 --> 00:14:43,740
sort of simple the back end does the off

445
00:14:43,740 --> 00:14:45,600
the second pass authentication there's

446
00:14:45,600 --> 00:14:46,740
more than two there's like three or four

447
00:14:46,740 --> 00:14:49,680
different paths it's just ludicrous but

448
00:14:49,680 --> 00:14:51,660
the second way is if you say using

449
00:14:51,660 --> 00:14:54,240
password as an authorization header if

450
00:14:54,240 --> 00:14:56,579
the proxy sees using password the proxy

451
00:14:56,579 --> 00:14:58,680
goes oh this is my job I should validate

452
00:14:58,680 --> 00:15:00,959
these and they use a pen module so it

453
00:15:00,959 --> 00:15:03,060
uses the Linux authentication mechanisms

454
00:15:03,060 --> 00:15:04,920
to validate the two same password by

455
00:15:04,920 --> 00:15:05,699
itself

456
00:15:05,699 --> 00:15:08,100
and if they're correct it removes the

457
00:15:08,100 --> 00:15:09,600
Usain password and then forwards at the

458
00:15:09,600 --> 00:15:11,459
back end in the back end receives

459
00:15:11,459 --> 00:15:13,680
something with no authentication it goes

460
00:15:13,680 --> 00:15:15,540
oh this must be already authenticated

461
00:15:15,540 --> 00:15:18,180
and accepts it which makes no sense but

462
00:15:18,180 --> 00:15:19,860
that's how it's done

463
00:15:19,860 --> 00:15:21,180
so

464
00:15:21,180 --> 00:15:22,980
if the back end gets something with no

465
00:15:22,980 --> 00:15:25,560
token and no authentication it accepts

466
00:15:25,560 --> 00:15:29,820
it as valid which that's bad

467
00:15:29,820 --> 00:15:31,560
so it turns out and I didn't know this

468
00:15:31,560 --> 00:15:33,720
this is this was new to me there is an

469
00:15:33,720 --> 00:15:36,060
HTTP header called connection which I

470
00:15:36,060 --> 00:15:38,220
was aware of which usually has the

471
00:15:38,220 --> 00:15:40,199
values of keep alive or close

472
00:15:40,199 --> 00:15:41,759
keep alive means keep the connection

473
00:15:41,759 --> 00:15:44,459
open and close means don't

474
00:15:44,459 --> 00:15:46,019
but turns out there's a third value for

475
00:15:46,019 --> 00:15:46,680
it

476
00:15:46,680 --> 00:15:47,880
which

477
00:15:47,880 --> 00:15:50,759
basically says a list of headers the

478
00:15:50,759 --> 00:15:52,680
name of the header to be removed

479
00:15:52,680 --> 00:15:54,660
so you can tell a proxy to remove a

480
00:15:54,660 --> 00:15:56,880
header while proxying

481
00:15:56,880 --> 00:15:58,199
so now what you have is the same

482
00:15:58,199 --> 00:15:59,279
scenario

483
00:15:59,279 --> 00:16:01,620
except now you send the X5 off token as

484
00:16:01,620 --> 00:16:03,600
a connection header

485
00:16:03,600 --> 00:16:05,459
the uh the reverse proxy gets this

486
00:16:05,459 --> 00:16:08,519
authentication it says is there a token

487
00:16:08,519 --> 00:16:10,079
yes there is so I'm going to forward

488
00:16:10,079 --> 00:16:11,519
this step back end

489
00:16:11,519 --> 00:16:14,040
then approaching his mod proxy says oh

490
00:16:14,040 --> 00:16:15,779
hey I'm supposed to remove this token

491
00:16:15,779 --> 00:16:18,240
so remove the token and it forwards it

492
00:16:18,240 --> 00:16:19,980
and then

493
00:16:19,980 --> 00:16:21,720
you win the back end things are

494
00:16:21,720 --> 00:16:24,000
authenticated and there's a endpoint

495
00:16:24,000 --> 00:16:26,519
that you can't really see probably but

496
00:16:26,519 --> 00:16:28,940
it's called TM slash utilitarsh bash

497
00:16:28,940 --> 00:16:31,560
bash bash which takes the command to run

498
00:16:31,560 --> 00:16:34,320
so you guys run ID and it tells you root

499
00:16:34,320 --> 00:16:36,240
so this is like remote route just by

500
00:16:36,240 --> 00:16:38,279
removing a header and I thought that's a

501
00:16:38,279 --> 00:16:40,500
pretty cool vulnerability to like

502
00:16:40,500 --> 00:16:42,000
learn from because like this whole

503
00:16:42,000 --> 00:16:44,519
connection header thing I had no idea I

504
00:16:44,519 --> 00:16:46,079
spent like a week trying to find the

505
00:16:46,079 --> 00:16:48,360
actual core issue of this vulnerability

506
00:16:48,360 --> 00:16:49,500
and couldn't figure out why it worked

507
00:16:49,500 --> 00:16:51,959
until I read the Horizon 3 Zone who

508
00:16:51,959 --> 00:16:53,579
discloses it until they write Horizon

509
00:16:53,579 --> 00:16:55,320
3's exposure and they mentioned the

510
00:16:55,320 --> 00:16:57,779
connection header and I was like oh

511
00:16:57,779 --> 00:17:00,060
today I learned

512
00:17:00,060 --> 00:17:01,680
so I made a challenge for B-side San

513
00:17:01,680 --> 00:17:04,079
Francisco 2022 which was

514
00:17:04,079 --> 00:17:06,599
two months ago give or take

515
00:17:06,599 --> 00:17:08,160
um called refreshing

516
00:17:08,160 --> 00:17:10,619
and I posted a source to all these

517
00:17:10,619 --> 00:17:11,579
things if you want to see these

518
00:17:11,579 --> 00:17:13,199
challenges we open source all of our

519
00:17:13,199 --> 00:17:14,640
B-side challenges so you're absolutely

520
00:17:14,640 --> 00:17:16,319
welcome to see how we wrote them

521
00:17:16,319 --> 00:17:18,359
but um

522
00:17:18,359 --> 00:17:19,919
basically I wrote a web application

523
00:17:19,919 --> 00:17:23,039
firewall reverse proxy that if I saw it

524
00:17:23,039 --> 00:17:24,959
if I saw Quarry string with any illegal

525
00:17:24,959 --> 00:17:26,459
any weird characters

526
00:17:26,459 --> 00:17:28,500
it was at a security header and say this

527
00:17:28,500 --> 00:17:29,940
is a dangerous request

528
00:17:29,940 --> 00:17:32,880
and then on the actual server it would

529
00:17:32,880 --> 00:17:34,380
check for the header and say if this

530
00:17:34,380 --> 00:17:37,080
header is here alert alert alert this is

531
00:17:37,080 --> 00:17:38,039
bad

532
00:17:38,039 --> 00:17:41,100
so I made a

533
00:17:41,100 --> 00:17:43,200
so I made this Challenge and if the user

534
00:17:43,200 --> 00:17:46,440
can remove the header then they could uh

535
00:17:46,440 --> 00:17:48,960
they could run close they could uh pass

536
00:17:48,960 --> 00:17:50,520
reversal in this case do a very obvious

537
00:17:50,520 --> 00:17:51,960
controversial attack

538
00:17:51,960 --> 00:17:53,400
so basically the solution to it was just

539
00:17:53,400 --> 00:17:56,160
to curl and then set that header

540
00:17:56,160 --> 00:17:58,320
and I thought that was a really cool

541
00:17:58,320 --> 00:17:59,760
way of teaching because I've never heard

542
00:17:59,760 --> 00:18:01,860
this before I think anyone who solved

543
00:18:01,860 --> 00:18:03,539
that challenge probably learned

544
00:18:03,539 --> 00:18:05,400
something because I mean some people I'm

545
00:18:05,400 --> 00:18:07,860
sure I know that but I sure didn't

546
00:18:07,860 --> 00:18:10,380
so Sutter's rfcs have weird edge cases I

547
00:18:10,380 --> 00:18:11,520
think Brandon's really good for that

548
00:18:11,520 --> 00:18:13,980
he'll he'll dig into like file formats

549
00:18:13,980 --> 00:18:15,780
like the zip or raw format or something

550
00:18:15,780 --> 00:18:18,240
and look for like weird ways of hiding

551
00:18:18,240 --> 00:18:20,460
data so it's like it's a cool type of

552
00:18:20,460 --> 00:18:22,020
challenge to like look at specs and make

553
00:18:22,020 --> 00:18:24,539
a challenge based on them

554
00:18:24,539 --> 00:18:25,860
so that's the first issue I want to talk

555
00:18:25,860 --> 00:18:27,059
about

556
00:18:27,059 --> 00:18:27,780
um

557
00:18:27,780 --> 00:18:29,520
the second one and that's okay by three

558
00:18:29,520 --> 00:18:31,740
for the price of one thing and I do want

559
00:18:31,740 --> 00:18:33,780
to do these ones live-ish

560
00:18:33,780 --> 00:18:35,160
um I have screenshots if they don't work

561
00:18:35,160 --> 00:18:36,600
but I could I could go test a little bit

562
00:18:36,600 --> 00:18:37,799
live

563
00:18:37,799 --> 00:18:39,900
so this is where holiday hack challenge

564
00:18:39,900 --> 00:18:42,299
2020 which me and Daniel worked on and

565
00:18:42,299 --> 00:18:43,980
this was our two polling Birds you see

566
00:18:43,980 --> 00:18:46,799
there's a bird that's calling cell phone

567
00:18:46,799 --> 00:18:48,299
um and I can confirm owning a bird they

568
00:18:48,299 --> 00:18:50,280
love being on my head so

569
00:18:50,280 --> 00:18:52,320
the artist it was a good rendition of

570
00:18:52,320 --> 00:18:54,240
what burden would do

571
00:18:54,240 --> 00:18:56,520
so basically if you haven't played holy

572
00:18:56,520 --> 00:18:58,320
hack challenge it's like a game you hop

573
00:18:58,320 --> 00:19:00,539
around this virtual world there's talks

574
00:19:00,539 --> 00:19:02,640
there's music there's this is a whole

575
00:19:02,640 --> 00:19:06,360
game which my old company counter heck

576
00:19:06,360 --> 00:19:08,340
Adele can confirm they put so much time

577
00:19:08,340 --> 00:19:10,500
every money into making this free game

578
00:19:10,500 --> 00:19:13,500
just because our boss Ed just loves the

579
00:19:13,500 --> 00:19:15,840
Christmas challenges and it's really

580
00:19:15,840 --> 00:19:17,039
really cool that we do this for the

581
00:19:17,039 --> 00:19:18,660
community like I'm

582
00:19:18,660 --> 00:19:20,340
I'm a very cynical person who comes to

583
00:19:20,340 --> 00:19:21,720
advertising and I think this is a super

584
00:19:21,720 --> 00:19:23,520
cool thing that does hands does it

585
00:19:23,520 --> 00:19:24,600
doesn't have to

586
00:19:24,600 --> 00:19:26,400
but anyway

587
00:19:26,400 --> 00:19:28,140
uh one of the things was to open the

588
00:19:28,140 --> 00:19:30,900
door of a room and

589
00:19:30,900 --> 00:19:32,520
we have our called terminal challenges

590
00:19:32,520 --> 00:19:33,780
in this game

591
00:19:33,780 --> 00:19:35,039
and the terminal challenges will give

592
00:19:35,039 --> 00:19:37,260
you like a little console like this

593
00:19:37,260 --> 00:19:39,000
and the consoles will let you run

594
00:19:39,000 --> 00:19:40,500
commands and do stuff and this is like a

595
00:19:40,500 --> 00:19:42,480
legitimate URL you could use this later

596
00:19:42,480 --> 00:19:45,059
if you do use it there's a username

597
00:19:45,059 --> 00:19:46,020
parameter that you should change to

598
00:19:46,020 --> 00:19:47,520
something else because somebody else

599
00:19:47,520 --> 00:19:48,900
uses the same username it'll kick you

600
00:19:48,900 --> 00:19:50,580
out which is kind of funny that's

601
00:19:50,580 --> 00:19:53,220
Daniel's Fault by the way

602
00:19:53,220 --> 00:19:55,260
um anyway

603
00:19:55,260 --> 00:19:56,880
you're given this terminal one saying

604
00:19:56,880 --> 00:19:58,919
like please reverse engineer this

605
00:19:58,919 --> 00:20:00,840
encryption to open the door

606
00:20:00,840 --> 00:20:02,700
now something I believe strongly in is

607
00:20:02,700 --> 00:20:04,620
that reversing should be easy as easy as

608
00:20:04,620 --> 00:20:07,200
possible and often it means taking the

609
00:20:07,200 --> 00:20:09,059
dumbest thing that might work

610
00:20:09,059 --> 00:20:10,320
so the three different challenges the

611
00:20:10,320 --> 00:20:11,700
first one is the door

612
00:20:11,700 --> 00:20:14,940
in another lesson for making CTS

613
00:20:14,940 --> 00:20:17,700
is pins so like I don't just give a

614
00:20:17,700 --> 00:20:20,039
challenge I do you look at a screen it

615
00:20:20,039 --> 00:20:22,500
wants a password you roll your eyes the

616
00:20:22,500 --> 00:20:23,700
passwords probably start right in the

617
00:20:23,700 --> 00:20:25,559
binary give those kind of hints to

618
00:20:25,559 --> 00:20:26,880
people I think are very valuable because

619
00:20:26,880 --> 00:20:28,200
you don't want people floundering them

620
00:20:28,200 --> 00:20:30,059
like doing guesses

621
00:20:30,059 --> 00:20:31,679
so if you're into the wrong thing it's

622
00:20:31,679 --> 00:20:33,780
just gonna time out

623
00:20:33,780 --> 00:20:35,580
Ctrl c yeah

624
00:20:35,580 --> 00:20:38,640
so if you just run strings on door

625
00:20:38,640 --> 00:20:40,919
typing is hard

626
00:20:40,919 --> 00:20:42,659
if you run strings on door you get a

627
00:20:42,659 --> 00:20:45,179
bunch of strings and one of them is the

628
00:20:45,179 --> 00:20:46,740
password like I could use a guess for

629
00:20:46,740 --> 00:20:50,100
the path password

630
00:20:50,100 --> 00:20:52,260
yep the password is open the door so

631
00:20:52,260 --> 00:20:54,179
it's a very simple challenge but you

632
00:20:54,179 --> 00:20:56,460
wouldn't believe how many times during

633
00:20:56,460 --> 00:20:58,200
an actual assessment of reallocation

634
00:20:58,200 --> 00:21:00,000
that that's worked where I've just run

635
00:21:00,000 --> 00:21:01,440
like strings in the binary and got to

636
00:21:01,440 --> 00:21:03,059
the password a private key something

637
00:21:03,059 --> 00:21:04,799
other it's something that everyone

638
00:21:04,799 --> 00:21:05,880
should try like if you're gonna reverse

639
00:21:05,880 --> 00:21:07,919
a binary if you just take out my binary

640
00:21:07,919 --> 00:21:09,600
or an exe file does

641
00:21:09,600 --> 00:21:11,159
if you run the Linux Strings program on

642
00:21:11,159 --> 00:21:13,559
it you might just find something and

643
00:21:13,559 --> 00:21:14,700
maybe you don't you might get

644
00:21:14,700 --> 00:21:16,679
interesting information

645
00:21:16,679 --> 00:21:19,320
I do I think strings L is helpful to get

646
00:21:19,320 --> 00:21:22,440
less junk n sorry

647
00:21:22,440 --> 00:21:25,500
I know how to do this I'm a professional

648
00:21:25,500 --> 00:21:27,000
that just gives you only longer strings

649
00:21:27,000 --> 00:21:29,039
and like seeing what libraries are

650
00:21:29,039 --> 00:21:30,059
important stuff like that is really

651
00:21:30,059 --> 00:21:31,260
valuable

652
00:21:31,260 --> 00:21:32,820
I should also mention I can't talk in

653
00:21:32,820 --> 00:21:34,140
detail about the source of these ones

654
00:21:34,140 --> 00:21:37,020
because these are from like contests

655
00:21:37,020 --> 00:21:39,240
but like if you were to Google these

656
00:21:39,240 --> 00:21:40,620
things you would realize this is written

657
00:21:40,620 --> 00:21:42,539
rust and knowing this written rust does

658
00:21:42,539 --> 00:21:43,440
like

659
00:21:43,440 --> 00:21:46,140
tell you things about the application

660
00:21:46,140 --> 00:21:48,179
I think the more interesting one of

661
00:21:48,179 --> 00:21:49,620
these was the lights

662
00:21:49,620 --> 00:21:51,179
let me go into lab folder because I

663
00:21:51,179 --> 00:21:52,860
agree right in here

664
00:21:52,860 --> 00:21:55,200
so if you were in the lights binary

665
00:21:55,200 --> 00:21:56,400
it says you wonder how to turn the

666
00:21:56,400 --> 00:21:58,080
lights on if only had some kind of hint

667
00:21:58,080 --> 00:22:00,360
that it says config file loaded

668
00:22:00,360 --> 00:22:02,580
so and select file is decrypted and

669
00:22:02,580 --> 00:22:03,659
that's kind of the big hint is that

670
00:22:03,659 --> 00:22:05,159
there's a config file

671
00:22:05,159 --> 00:22:08,520
and this was a very very close surrogate

672
00:22:08,520 --> 00:22:10,380
of a vulnerability I actually found in

673
00:22:10,380 --> 00:22:12,000
some customer software

674
00:22:12,000 --> 00:22:14,100
so if you look at the config file

675
00:22:14,100 --> 00:22:16,679
it's got some fields are encrypted and

676
00:22:16,679 --> 00:22:18,900
prefixed with e dollar sign and some

677
00:22:18,900 --> 00:22:21,000
that aren't you'll notice when you run

678
00:22:21,000 --> 00:22:23,280
the program

679
00:22:23,280 --> 00:22:25,559
it says welcome back elf technician so

680
00:22:25,559 --> 00:22:27,000
it reads the config file and it writes

681
00:22:27,000 --> 00:22:28,919
the terminal

682
00:22:28,919 --> 00:22:31,440
this one I'm going to edit it

683
00:22:31,440 --> 00:22:33,539
and just replace L technician with the

684
00:22:33,539 --> 00:22:35,159
password

685
00:22:35,159 --> 00:22:37,760
to do

686
00:22:39,179 --> 00:22:41,100
I told you I'm an expert I know I know

687
00:22:41,100 --> 00:22:43,459
what I'm doing

688
00:22:43,620 --> 00:22:46,280
all right and then run it again

689
00:22:46,280 --> 00:22:49,820
I messed up

690
00:22:51,720 --> 00:22:53,880
there we go so now this is welcome back

691
00:22:53,880 --> 00:22:55,260
computer turn lights on

692
00:22:55,260 --> 00:22:57,240
now this was like an oddly common thing

693
00:22:57,240 --> 00:22:58,980
I found in local applications that have

694
00:22:58,980 --> 00:23:01,320
encrypted config files is that it's very

695
00:23:01,320 --> 00:23:02,880
common for config files to have some

696
00:23:02,880 --> 00:23:07,020
plain text and some encrypted fields

697
00:23:07,020 --> 00:23:08,760
and there's been several times where

698
00:23:08,760 --> 00:23:10,440
I've just swapped the fields so we

699
00:23:10,440 --> 00:23:12,120
decrypt something and then shows it to

700
00:23:12,120 --> 00:23:14,400
me usually it's a name it could be other

701
00:23:14,400 --> 00:23:15,179
things

702
00:23:15,179 --> 00:23:16,380
this actually worked on multiple

703
00:23:16,380 --> 00:23:17,580
different pen tests I've done which is

704
00:23:17,580 --> 00:23:20,039
kind of kind of cool

705
00:23:20,039 --> 00:23:21,840
the third one's a bit too complicated to

706
00:23:21,840 --> 00:23:23,820
actually like do live but I do have

707
00:23:23,820 --> 00:23:26,240
slides

708
00:23:26,340 --> 00:23:31,100
so this was the first one second one

709
00:23:32,700 --> 00:23:34,500
okay so I want

710
00:23:34,500 --> 00:23:36,000
so

711
00:23:36,000 --> 00:23:38,640
this one was based on a point of sale uh

712
00:23:38,640 --> 00:23:40,919
term uh desktop application that I was

713
00:23:40,919 --> 00:23:43,080
working on a long long time ago

714
00:23:43,080 --> 00:23:45,600
and this application was password

715
00:23:45,600 --> 00:23:48,720
protected but I could view the file but

716
00:23:48,720 --> 00:23:51,179
the file was encrypted and

717
00:23:51,179 --> 00:23:52,919
It Was Written in Visual Basic I believe

718
00:23:52,919 --> 00:23:55,320
so I really didn't want to like reverse

719
00:23:55,320 --> 00:23:56,400
engineer it and figure out how to

720
00:23:56,400 --> 00:23:57,720
encrypt the file

721
00:23:57,720 --> 00:24:00,900
so instead I uh we mess with it I forget

722
00:24:00,900 --> 00:24:01,980
how it came out but you're interested to

723
00:24:01,980 --> 00:24:03,900
leave the config file and when I delete

724
00:24:03,900 --> 00:24:06,360
the config file it prompted me and I can

725
00:24:06,360 --> 00:24:07,980
actually

726
00:24:07,980 --> 00:24:10,679
show that what that looks like

727
00:24:10,679 --> 00:24:13,080
so I'll just Catholic a big file just so

728
00:24:13,080 --> 00:24:15,000
you see what it looks like

729
00:24:15,000 --> 00:24:16,620
so it's got an encrypted password in it

730
00:24:16,620 --> 00:24:18,240
just like before

731
00:24:18,240 --> 00:24:20,520
if I remove the vending machines.json

732
00:24:20,520 --> 00:24:22,919
file and run vending machines

733
00:24:22,919 --> 00:24:24,960
it would config files missing please

734
00:24:24,960 --> 00:24:26,820
create a new one please enter the name

735
00:24:26,820 --> 00:24:28,559
wrong please send the password password

736
00:24:28,559 --> 00:24:30,299
doesn't matter

737
00:24:30,299 --> 00:24:31,860
and then

738
00:24:31,860 --> 00:24:33,679
if you look at the fake file now

739
00:24:33,679 --> 00:24:36,240
remove it

740
00:24:36,240 --> 00:24:40,440
wrong password doesn't matter

741
00:24:40,440 --> 00:24:42,299
it doesn't matter

742
00:24:42,299 --> 00:24:44,220
it's not remove it this time

743
00:24:44,220 --> 00:24:47,100
if you can it it encrypts the new values

744
00:24:47,100 --> 00:24:48,840
and what we turned out is that if I

745
00:24:48,840 --> 00:24:50,940
encrypted a whole bunch of A's a whole

746
00:24:50,940 --> 00:24:53,220
bunch of B's a whole bunch of C's Etc

747
00:24:53,220 --> 00:24:55,980
it would eventually uh

748
00:24:55,980 --> 00:24:57,840
have patterns so if you look at

749
00:24:57,840 --> 00:25:00,240
encrypting a whole bunch of A's and this

750
00:25:00,240 --> 00:25:01,559
is very very similar to real

751
00:25:01,559 --> 00:25:05,100
vulnerability and we get 9V T blah blah

752
00:25:05,100 --> 00:25:07,620
9bt every eight or so character is it

753
00:25:07,620 --> 00:25:08,760
would repeat

754
00:25:08,760 --> 00:25:10,260
and then if I encrypt another string

755
00:25:10,260 --> 00:25:12,179
like say all B's

756
00:25:12,179 --> 00:25:13,559
it would be eight different characters

757
00:25:13,559 --> 00:25:15,299
but it was still repeat

758
00:25:15,299 --> 00:25:18,960
if I encrypted like 16 a 16 B's or so

759
00:25:18,960 --> 00:25:20,520
you would see the first half sustainment

760
00:25:20,520 --> 00:25:22,200
the second half difference

761
00:25:22,200 --> 00:25:24,120
so

762
00:25:24,120 --> 00:25:25,919
I do always do my rent to like some sort

763
00:25:25,919 --> 00:25:27,059
of a weird crypto thing and I asked

764
00:25:27,059 --> 00:25:28,320
Brandon and said like what am I looking

765
00:25:28,320 --> 00:25:29,039
at

766
00:25:29,039 --> 00:25:31,500
and he said it's a poly alphabetic

767
00:25:31,500 --> 00:25:32,880
substitution Cipher

768
00:25:32,880 --> 00:25:34,320
what that actually means is like I could

769
00:25:34,320 --> 00:25:36,600
build a lookup table I can try like I

770
00:25:36,600 --> 00:25:38,400
could do eight A's eight B's eight C's

771
00:25:38,400 --> 00:25:39,840
eight D's Etc

772
00:25:39,840 --> 00:25:41,520
figure out what they encrypt to and then

773
00:25:41,520 --> 00:25:43,140
build a lookup table that would just go

774
00:25:43,140 --> 00:25:44,220
backwards

775
00:25:44,220 --> 00:25:45,600
and like there's a much easier way to do

776
00:25:45,600 --> 00:25:47,039
that but that was the hard way and it

777
00:25:47,039 --> 00:25:48,179
worked

778
00:25:48,179 --> 00:25:49,740
the problem is this is a GUI app I was

779
00:25:49,740 --> 00:25:51,059
working on decided to do each one by

780
00:25:51,059 --> 00:25:53,340
hand and like get it pop-up box and it

781
00:25:53,340 --> 00:25:55,559
was brutally slow but I was able to

782
00:25:55,559 --> 00:25:57,720
encrypt a whole config file using that

783
00:25:57,720 --> 00:25:59,700
so that was pretty cool

784
00:25:59,700 --> 00:26:01,200
so I really wanted to like Implement

785
00:26:01,200 --> 00:26:04,320
these things as CTF challenges because

786
00:26:04,320 --> 00:26:05,940
like I read these in the real world and

787
00:26:05,940 --> 00:26:07,020
I thought they were really cool and

788
00:26:07,020 --> 00:26:09,299
wanted to like show them off

789
00:26:09,299 --> 00:26:11,820
crypto attacks can be really easy to

790
00:26:11,820 --> 00:26:14,100
implement in a CTF challenge because

791
00:26:14,100 --> 00:26:16,020
what encrypt is doing is very obvious

792
00:26:16,020 --> 00:26:17,880
it's keeping data

793
00:26:17,880 --> 00:26:20,279
confidential or it's keeping data

794
00:26:20,279 --> 00:26:22,140
um it's keeping Integrity of data so

795
00:26:22,140 --> 00:26:23,159
like

796
00:26:23,159 --> 00:26:24,779
attacker can change your attacker can

797
00:26:24,779 --> 00:26:26,279
read it kind of thing

798
00:26:26,279 --> 00:26:27,900
the problem with crypto challenges is

799
00:26:27,900 --> 00:26:30,000
often hard to make them interesting so I

800
00:26:30,000 --> 00:26:32,039
think making it kind of like a game

801
00:26:32,039 --> 00:26:34,200
really kind of interesting

802
00:26:34,200 --> 00:26:36,419
but it's often kind of hard to make

803
00:26:36,419 --> 00:26:37,860
these fun but I think these ones were

804
00:26:37,860 --> 00:26:39,480
interesting to like figure out

805
00:26:39,480 --> 00:26:40,559
the other problem is that sometimes

806
00:26:40,559 --> 00:26:42,419
these are two they seem too dumb like

807
00:26:42,419 --> 00:26:44,400
people look at our CTF and go no one

808
00:26:44,400 --> 00:26:46,020
would ever actually do this when you got

809
00:26:46,020 --> 00:26:49,340
it from a real piece of software

810
00:26:49,740 --> 00:26:51,299
so

811
00:26:51,299 --> 00:26:53,039
next I want to talk about

812
00:26:53,039 --> 00:26:55,919
this one's interesting because this was

813
00:26:55,919 --> 00:26:59,039
a vulnerability in a diable 2 server

814
00:26:59,039 --> 00:27:04,320
and I want to say 2000 6 2005 when I was

815
00:27:04,320 --> 00:27:06,059
quite a bit younger

816
00:27:06,059 --> 00:27:08,039
um a guy I know at the time his name was

817
00:27:08,039 --> 00:27:10,260
evil cheese living in the UK

818
00:27:10,260 --> 00:27:12,179
basically spent a summary versus using

819
00:27:12,179 --> 00:27:15,000
Diablo 2 server and finding duplication

820
00:27:15,000 --> 00:27:17,760
bugs and back in those days

821
00:27:17,760 --> 00:27:19,080
if you could duplicate the item like a

822
00:27:19,080 --> 00:27:20,520
stone Jordan which if you ever played

823
00:27:20,520 --> 00:27:22,559
this game you probably recognize you can

824
00:27:22,559 --> 00:27:25,200
make like 10 20 of selling one these

825
00:27:25,200 --> 00:27:27,000
days you can make apparently 35 cents so

826
00:27:27,000 --> 00:27:29,159
that's you know economy

827
00:27:29,159 --> 00:27:30,360
but

828
00:27:30,360 --> 00:27:33,720
basically he found a bug that he

829
00:27:33,720 --> 00:27:36,120
exploited and do full of items and made

830
00:27:36,120 --> 00:27:38,640
a bunch of money and then it got fixed

831
00:27:38,640 --> 00:27:40,740
but I could not find any information I

832
00:27:40,740 --> 00:27:41,820
actually like

833
00:27:41,820 --> 00:27:44,880
I found on web on the on the archive I

834
00:27:44,880 --> 00:27:46,140
found someone talking about a similar

835
00:27:46,140 --> 00:27:48,299
dupe by the same guy but I cannot find

836
00:27:48,299 --> 00:27:50,460
the Duke that he told me about as

837
00:27:50,460 --> 00:27:51,600
possible nobody's ever talked about it

838
00:27:51,600 --> 00:27:53,580
which is fine it's also possible I

839
00:27:53,580 --> 00:27:55,020
completely forget the details I get it

840
00:27:55,020 --> 00:27:56,700
completely wrong because this is from a

841
00:27:56,700 --> 00:27:58,380
long time ago but

842
00:27:58,380 --> 00:28:00,240
I think I got this reasonably close to

843
00:28:00,240 --> 00:28:01,740
accurate

844
00:28:01,740 --> 00:28:04,380
so basically the way Diablo 2 worked was

845
00:28:04,380 --> 00:28:05,279
on the right you have the equipment

846
00:28:05,279 --> 00:28:09,059
screen the equipment is um in an array

847
00:28:09,059 --> 00:28:11,340
basically your helmet I'm making this up

848
00:28:11,340 --> 00:28:12,480
a little bit but your helmet might be

849
00:28:12,480 --> 00:28:14,820
one your left weapon might be two your

850
00:28:14,820 --> 00:28:16,799
armors three your ms4

851
00:28:16,799 --> 00:28:18,000
it doesn't matter

852
00:28:18,000 --> 00:28:19,320
what's interesting though is like when

853
00:28:19,320 --> 00:28:21,779
you sell something it would sell from a

854
00:28:21,779 --> 00:28:23,520
certain position so you sell your hat it

855
00:28:23,520 --> 00:28:25,500
would say a muscle item number one if

856
00:28:25,500 --> 00:28:27,899
you're selling your mace number two and

857
00:28:27,899 --> 00:28:29,340
so on

858
00:28:29,340 --> 00:28:31,320
the thing is there's this weird weird

859
00:28:31,320 --> 00:28:34,380
index zero slots that was used as a

860
00:28:34,380 --> 00:28:37,320
temporary buffer or so my memory kills

861
00:28:37,320 --> 00:28:40,260
me where it would copy the item to that

862
00:28:40,260 --> 00:28:42,419
slot and then sell it but there's

863
00:28:42,419 --> 00:28:43,679
nothing stopping you from selling

864
00:28:43,679 --> 00:28:46,080
directly out of slot zero so what you

865
00:28:46,080 --> 00:28:48,299
could do is sell item zero buy it back

866
00:28:48,299 --> 00:28:50,340
sell it buy it back sell buyback and get

867
00:28:50,340 --> 00:28:52,200
multiple copies the same item

868
00:28:52,200 --> 00:28:53,520
and like this is my memory of how the

869
00:28:53,520 --> 00:28:55,740
bug worked and maybe it's wrong but if

870
00:28:55,740 --> 00:28:58,679
that's right it's an interesting bug

871
00:28:58,679 --> 00:29:00,059
several challenges based on that called

872
00:29:00,059 --> 00:29:01,500
beast fight

873
00:29:01,500 --> 00:29:03,960
bees being like BS above like Diablo

874
00:29:03,960 --> 00:29:06,000
it's my pun

875
00:29:06,000 --> 00:29:07,320
you'll notice that the refreshing

876
00:29:07,320 --> 00:29:09,539
challenge was the F5 bug B's fights at

877
00:29:09,539 --> 00:29:13,320
Diablo bug I I make funny names

878
00:29:13,320 --> 00:29:16,440
so this one I actually have handy and I

879
00:29:16,440 --> 00:29:17,279
don't know if it's gonna work out that

880
00:29:17,279 --> 00:29:18,360
well but I do have screenshots if it

881
00:29:18,360 --> 00:29:19,200
doesn't

882
00:29:19,200 --> 00:29:21,179
but this is a game I wrote I've edited

883
00:29:21,179 --> 00:29:22,380
the source code bit to make this like

884
00:29:22,380 --> 00:29:24,720
easier to show off but it was like it

885
00:29:24,720 --> 00:29:25,799
was like a little text-based Adventure

886
00:29:25,799 --> 00:29:27,659
game you would like

887
00:29:27,659 --> 00:29:30,299
uh netcat to a port it will give you all

888
00:29:30,299 --> 00:29:31,860
this stuff

889
00:29:31,860 --> 00:29:32,760
um

890
00:29:32,760 --> 00:29:35,640
it has commands you want help when I was

891
00:29:35,640 --> 00:29:36,960
when I was young these games are all the

892
00:29:36,960 --> 00:29:39,419
rage you know adventure and Zork and all

893
00:29:39,419 --> 00:29:40,620
that stuff

894
00:29:40,620 --> 00:29:42,600
but basically

895
00:29:42,600 --> 00:29:44,220
the way the bug actually worked and I'll

896
00:29:44,220 --> 00:29:46,320
show you the code for it in a bit you

897
00:29:46,320 --> 00:29:48,000
have an inventory so I have blueprints

898
00:29:48,000 --> 00:29:50,279
grass Shield pictures of cats I have

899
00:29:50,279 --> 00:29:52,860
like 50 things that you can have and

900
00:29:52,860 --> 00:29:54,179
I spent a lot of time making a very

901
00:29:54,179 --> 00:29:55,380
simple challenge

902
00:29:55,380 --> 00:29:57,779
but if you look at your inventory so you

903
00:29:57,779 --> 00:29:59,340
remember this

904
00:29:59,340 --> 00:30:00,840
um I have a grass sealed so I can equip

905
00:30:00,840 --> 00:30:02,159
the glass Shield

906
00:30:02,159 --> 00:30:04,260
like so and now I've got your Garcia

907
00:30:04,260 --> 00:30:05,220
equipped

908
00:30:05,220 --> 00:30:07,020
okay I need equip

909
00:30:07,020 --> 00:30:09,559
my shield

910
00:30:11,159 --> 00:30:14,100
by Shield and so on so I can make as

911
00:30:14,100 --> 00:30:16,799
many as I want but that's cool why do we

912
00:30:16,799 --> 00:30:17,940
care

913
00:30:17,940 --> 00:30:19,380
and the thing I should mentioned first

914
00:30:19,380 --> 00:30:20,700
was like There's different areas in the

915
00:30:20,700 --> 00:30:22,620
game there's a street for example so I

916
00:30:22,620 --> 00:30:24,419
can move to the street

917
00:30:24,419 --> 00:30:26,039
and then from the street I can go to

918
00:30:26,039 --> 00:30:27,600
convenience store

919
00:30:27,600 --> 00:30:30,539
move one they used to be like right in

920
00:30:30,539 --> 00:30:31,799
the counters I turned those off just so

921
00:30:31,799 --> 00:30:32,940
we went the

922
00:30:32,940 --> 00:30:34,559
have to deal with it

923
00:30:34,559 --> 00:30:35,760
so you're at the convenience store you

924
00:30:35,760 --> 00:30:37,679
can buy a thing called flag.txt for a

925
00:30:37,679 --> 00:30:39,539
lot of money more money they would ever

926
00:30:39,539 --> 00:30:40,919
hope they have if you actually play the

927
00:30:40,919 --> 00:30:42,659
game which is not true because I hacked

928
00:30:42,659 --> 00:30:43,740
it to have lots of money so I can show

929
00:30:43,740 --> 00:30:46,559
you that but that's besides the point

930
00:30:46,559 --> 00:30:48,299
what you can basically do is unequip

931
00:30:48,299 --> 00:30:49,559
your Shield

932
00:30:49,559 --> 00:30:51,360
and you come Shield

933
00:30:51,360 --> 00:30:53,520
then sell the item I'll just sell one

934
00:30:53,520 --> 00:30:56,100
sell one and so on so it's really simple

935
00:30:56,100 --> 00:30:57,720
you just like on your cup sale on your

936
00:30:57,720 --> 00:30:59,100
cup sale on your cup sale on your cup

937
00:30:59,100 --> 00:31:01,260
sale and you make tons of money

938
00:31:01,260 --> 00:31:02,760
game money not real life money in this

939
00:31:02,760 --> 00:31:05,460
case and then you get it's like say when

940
00:31:05,460 --> 00:31:08,000
you buy the flag

941
00:31:08,039 --> 00:31:09,299
um there's a command to describe things

942
00:31:09,299 --> 00:31:11,340
I forget what it is because

943
00:31:11,340 --> 00:31:12,779
yeah it's hard

944
00:31:12,779 --> 00:31:16,620
inventory describe

945
00:31:16,620 --> 00:31:19,620
describe number four

946
00:31:19,620 --> 00:31:21,000
and then we'll give you the description

947
00:31:21,000 --> 00:31:22,080
of like

948
00:31:22,080 --> 00:31:24,179
so like it's a simple enough challenge

949
00:31:24,179 --> 00:31:26,340
but to me it kind of like captured the

950
00:31:26,340 --> 00:31:27,179
same

951
00:31:27,179 --> 00:31:29,220
sort of thing that this vulnerability

952
00:31:29,220 --> 00:31:31,320
had

953
00:31:31,320 --> 00:31:33,179
um this is gonna be

954
00:31:33,179 --> 00:31:35,399
yeah you've seen that already

955
00:31:35,399 --> 00:31:37,260
so this is the actual code for it and

956
00:31:37,260 --> 00:31:39,720
the source code is as usual linked so

957
00:31:39,720 --> 00:31:40,620
you could just look at the source code

958
00:31:40,620 --> 00:31:43,380
yourself if you want but

959
00:31:43,380 --> 00:31:45,600
um basically and this is a vulnerability

960
00:31:45,600 --> 00:31:46,980
type that I've seen a lot in real

961
00:31:46,980 --> 00:31:49,440
software where it checks if something is

962
00:31:49,440 --> 00:31:52,679
null says if not weapon it does

963
00:31:52,679 --> 00:31:54,659
something but then when you equip it it

964
00:31:54,659 --> 00:31:56,640
doesn't set it all it sets if like the

965
00:31:56,640 --> 00:31:58,440
false it's really common when people

966
00:31:58,440 --> 00:32:00,299
store data in ways that weren't thought

967
00:32:00,299 --> 00:32:02,700
out well enough to like use

968
00:32:02,700 --> 00:32:04,500
two different pieces of unrelated data

969
00:32:04,500 --> 00:32:06,120
like whether it's knowledge equipped I

970
00:32:06,120 --> 00:32:07,740
mix them up that's kind of a state

971
00:32:07,740 --> 00:32:09,659
machine problem since I think I've seen

972
00:32:09,659 --> 00:32:12,840
lots and I thought I'd invented and it

973
00:32:12,840 --> 00:32:14,399
made a cool challenge you've seen all

974
00:32:14,399 --> 00:32:15,480
these screenshots already you've seen

975
00:32:15,480 --> 00:32:17,460
all that

976
00:32:17,460 --> 00:32:19,740
yeah so like it kind of honors this bug

977
00:32:19,740 --> 00:32:21,899
that I sort of remember from being a kid

978
00:32:21,899 --> 00:32:23,460
which I thought was really cool because

979
00:32:23,460 --> 00:32:25,860
like a cool person in my mind disclose

980
00:32:25,860 --> 00:32:27,419
it to me and now I'm telling all of you

981
00:32:27,419 --> 00:32:28,620
about it but it doesn't matter because

982
00:32:28,620 --> 00:32:31,518
this is like 20 years ago

983
00:32:32,100 --> 00:32:33,899
so next I want to talk about

984
00:32:33,899 --> 00:32:36,299
this was a bug called we gave it a name

985
00:32:36,299 --> 00:32:39,000
it's called WebEx web exec so me and my

986
00:32:39,000 --> 00:32:40,740
former co-worker Jeffrey Junkin who's

987
00:32:40,740 --> 00:32:42,779
not here but he should be by me Daniel

988
00:32:42,779 --> 00:32:43,980
and Jeff worked together for quite a

989
00:32:43,980 --> 00:32:46,440
long time we were doing a pen test at a

990
00:32:46,440 --> 00:32:48,419
client site and what they asked us for

991
00:32:48,419 --> 00:32:50,760
was here's our secure laptop image can

992
00:32:50,760 --> 00:32:53,220
you get system on it and we said we

993
00:32:53,220 --> 00:32:55,080
could try so we spent some time on it

994
00:32:55,080 --> 00:32:57,120
and we eventually figured out that

995
00:32:57,120 --> 00:32:59,460
there's there's a Windows service that

996
00:32:59,460 --> 00:33:01,500
can be overwritten and it was Cisco

997
00:33:01,500 --> 00:33:03,360
WebEx and you can override it with

998
00:33:03,360 --> 00:33:05,100
arbitrary exe file because their

999
00:33:05,100 --> 00:33:07,260
permissions were bad and then start the

1000
00:33:07,260 --> 00:33:11,039
service as a user and get a system

1001
00:33:11,039 --> 00:33:13,620
that was a nice easy vulnerability to

1002
00:33:13,620 --> 00:33:14,700
exploit everything

1003
00:33:14,700 --> 00:33:16,440
but the customer was using a

1004
00:33:16,440 --> 00:33:18,360
weightlifting software so we just

1005
00:33:18,360 --> 00:33:20,820
replaced the exe file it didn't work it

1006
00:33:20,820 --> 00:33:24,059
would flag it as a uh most as a changed

1007
00:33:24,059 --> 00:33:26,279
file and tell us it wouldn't load so

1008
00:33:26,279 --> 00:33:28,320
that sucks

1009
00:33:28,320 --> 00:33:30,840
how do we make this work so like at the

1010
00:33:30,840 --> 00:33:32,580
client site I was like I wonder what

1011
00:33:32,580 --> 00:33:34,980
this WebEx updated service is that's a

1012
00:33:34,980 --> 00:33:36,240
strange one

1013
00:33:36,240 --> 00:33:38,700
so I like I run strings on it you know I

1014
00:33:38,700 --> 00:33:40,860
said earlier run strings on things I saw

1015
00:33:40,860 --> 00:33:42,840
that it ran like create process as user

1016
00:33:42,840 --> 00:33:45,000
which means it funds other processes and

1017
00:33:45,000 --> 00:33:46,500
like that's interesting what's what's

1018
00:33:46,500 --> 00:33:47,580
this one

1019
00:33:47,580 --> 00:33:49,320
and it turns out it's fun whatever you

1020
00:33:49,320 --> 00:33:51,059
tell to so if you just start the service

1021
00:33:51,059 --> 00:33:52,559
normally

1022
00:33:52,559 --> 00:33:54,600
um SC that's Windows service control

1023
00:33:54,600 --> 00:33:58,200
manager SE start WebEx service and you

1024
00:33:58,200 --> 00:34:00,480
set the fourth parameter to ndxe file

1025
00:34:00,480 --> 00:34:01,740
and the second parameter just software

1026
00:34:01,740 --> 00:34:03,600
update it would just run that thing as

1027
00:34:03,600 --> 00:34:06,539
system just like okay you want to run

1028
00:34:06,539 --> 00:34:08,159
kelp we'll run kelp

1029
00:34:08,159 --> 00:34:10,918
it's basically suited with no password

1030
00:34:10,918 --> 00:34:12,540
excuse me I don't know why you work like

1031
00:34:12,540 --> 00:34:14,579
that but it worked and it worked great

1032
00:34:14,579 --> 00:34:16,800
so we were able to like run run a

1033
00:34:16,800 --> 00:34:19,020
program as root anything we wanted or as

1034
00:34:19,020 --> 00:34:21,300
system anything we wanted and that gave

1035
00:34:21,300 --> 00:34:23,219
the ability to run like

1036
00:34:23,219 --> 00:34:24,899
I'm interpreter payload or whatever it

1037
00:34:24,899 --> 00:34:27,000
was something would have gone uncut and

1038
00:34:27,000 --> 00:34:28,260
because of how I read it it wasn't

1039
00:34:28,260 --> 00:34:30,480
caught by whitelisting

1040
00:34:30,480 --> 00:34:31,980
so that was really neat so you're able

1041
00:34:31,980 --> 00:34:33,960
to like do that

1042
00:34:33,960 --> 00:34:35,159
actually I think we use it to run

1043
00:34:35,159 --> 00:34:36,540
Powershell and then Powershell around

1044
00:34:36,540 --> 00:34:37,980
our code something like that I don't

1045
00:34:37,980 --> 00:34:38,879
remember

1046
00:34:38,879 --> 00:34:40,500
so like we report to the customer and

1047
00:34:40,500 --> 00:34:42,480
said like can we like tell people about

1048
00:34:42,480 --> 00:34:43,739
this and they said sure that's fine we

1049
00:34:43,739 --> 00:34:44,520
don't care

1050
00:34:44,520 --> 00:34:47,399
so we got permission so we went home and

1051
00:34:47,399 --> 00:34:48,659
we we wrote a report for the customer

1052
00:34:48,659 --> 00:34:50,760
and we sent it and we were documenting

1053
00:34:50,760 --> 00:34:53,040
this vulnerability when Jeff says

1054
00:34:53,040 --> 00:34:54,780
can't you access the service manager

1055
00:34:54,780 --> 00:34:58,140
remotely so I'm like huh so then I read

1056
00:34:58,140 --> 00:35:01,500
SC backsized backslash my P address and

1057
00:35:01,500 --> 00:35:02,880
then and then like start WebEx service

1058
00:35:02,880 --> 00:35:04,980
sure enough it worked

1059
00:35:04,980 --> 00:35:07,200
um suddenly we had like an authenticated

1060
00:35:07,200 --> 00:35:10,500
sort of remote vulnerability it was

1061
00:35:10,500 --> 00:35:11,820
really cool we gave a name because of

1062
00:35:11,820 --> 00:35:13,140
the first vulnerability we found so we

1063
00:35:13,140 --> 00:35:14,880
call it web exec yeah like WebEx but

1064
00:35:14,880 --> 00:35:16,200
exec

1065
00:35:16,200 --> 00:35:18,359
and like we did a pretty detailed blog

1066
00:35:18,359 --> 00:35:19,380
about it

1067
00:35:19,380 --> 00:35:21,119
I linked everything like I said because

1068
00:35:21,119 --> 00:35:22,260
I think it's

1069
00:35:22,260 --> 00:35:23,400
you know lots of things to read

1070
00:35:23,400 --> 00:35:26,220
afterwards this is on my blog

1071
00:35:26,220 --> 00:35:28,140
so like I wrote that I did like a high

1072
00:35:28,140 --> 00:35:29,940
level write up it's all disclosure thing

1073
00:35:29,940 --> 00:35:31,320
it's what I do now for a living but this

1074
00:35:31,320 --> 00:35:32,940
is like doing it

1075
00:35:32,940 --> 00:35:34,980
as a pandester as like we found the

1076
00:35:34,980 --> 00:35:37,200
thing on a engagement

1077
00:35:37,200 --> 00:35:39,300
so we said it to Cisco they fixed it

1078
00:35:39,300 --> 00:35:40,560
they sent me the fix I said this fix

1079
00:35:40,560 --> 00:35:42,480
doesn't work as can you bypassed they

1080
00:35:42,480 --> 00:35:44,339
published it we bypassed it they fixed

1081
00:35:44,339 --> 00:35:45,960
it again blah blah it eventually got

1082
00:35:45,960 --> 00:35:49,200
fixed right on like the third try

1083
00:35:49,200 --> 00:35:50,400
so

1084
00:35:50,400 --> 00:35:52,079
that was it uh we also wrote a message

1085
00:35:52,079 --> 00:35:53,820
module for it and this is like my first

1086
00:35:53,820 --> 00:35:55,260
ever met play module before I worked for

1087
00:35:55,260 --> 00:35:57,119
Rapid seven we just recently published

1088
00:35:57,119 --> 00:35:59,040
our first post worker representative

1089
00:35:59,040 --> 00:36:00,180
essay module

1090
00:36:00,180 --> 00:36:02,220
so basically runs you get a username

1091
00:36:02,220 --> 00:36:05,160
password and it runs code a little bit

1092
00:36:05,160 --> 00:36:06,780
like SMB

1093
00:36:06,780 --> 00:36:08,700
um exact or whatever it's called My

1094
00:36:08,700 --> 00:36:10,619
Brain just turned off but basically like

1095
00:36:10,619 --> 00:36:13,020
LPS exact that's the one it's only p is

1096
00:36:13,020 --> 00:36:15,900
exactly except not

1097
00:36:15,900 --> 00:36:18,420
um so at the core the whole problem here

1098
00:36:18,420 --> 00:36:20,760
was bad Windows service permissions I

1099
00:36:20,760 --> 00:36:23,280
mean badly design software yeah but bad

1100
00:36:23,280 --> 00:36:25,859
service permissions as well so

1101
00:36:25,859 --> 00:36:27,300
arbitrary users shouldn't be able to

1102
00:36:27,300 --> 00:36:29,520
start service locally or remotely only

1103
00:36:29,520 --> 00:36:32,099
system should start the service

1104
00:36:32,099 --> 00:36:34,619
so I was like hang on I can wear a bad

1105
00:36:34,619 --> 00:36:35,579
Window Service

1106
00:36:35,579 --> 00:36:38,960
so I wrote that window service

1107
00:36:39,680 --> 00:36:41,700
I did not link this because we never

1108
00:36:41,700 --> 00:36:44,160
deployed it the readme says it says

1109
00:36:44,160 --> 00:36:46,560
tricky to deploy run this manually after

1110
00:36:46,560 --> 00:36:49,140
an error blah blah blah

1111
00:36:49,140 --> 00:36:51,060
that was not good so

1112
00:36:51,060 --> 00:36:53,099
we tried to get the staple and

1113
00:36:53,099 --> 00:36:54,660
thankfully in testing

1114
00:36:54,660 --> 00:36:56,339
Windows service manager really doesn't

1115
00:36:56,339 --> 00:36:58,560
like being a CTF Target you have to give

1116
00:36:58,560 --> 00:37:00,000
people using a password for the Windows

1117
00:37:00,000 --> 00:37:01,920
machine they have to not abuse the Usain

1118
00:37:01,920 --> 00:37:02,940
password

1119
00:37:02,940 --> 00:37:04,260
um it's really easy adopted by accident

1120
00:37:04,260 --> 00:37:06,000
it's impossible to debug errors

1121
00:37:06,000 --> 00:37:07,920
sometimes Windows service manager says

1122
00:37:07,920 --> 00:37:10,020
like ah so like if you get really

1123
00:37:10,020 --> 00:37:11,579
difficult and thankfully we never

1124
00:37:11,579 --> 00:37:13,740
deployed it we did make a similar

1125
00:37:13,740 --> 00:37:14,880
challenge for networks I think Daniel

1126
00:37:14,880 --> 00:37:17,160
actually got to work but it's our lady

1127
00:37:17,160 --> 00:37:19,020
of level that only like one person per

1128
00:37:19,020 --> 00:37:20,339
game gets to it

1129
00:37:20,339 --> 00:37:23,099
so that it kind of works for that

1130
00:37:23,099 --> 00:37:26,640
but it never worked for us so

1131
00:37:26,640 --> 00:37:29,760
oh that's a really cool service but it

1132
00:37:29,760 --> 00:37:30,960
just didn't work

1133
00:37:30,960 --> 00:37:32,700
so like it turns out some platforms suck

1134
00:37:32,700 --> 00:37:35,400
for ctfs like Windows SMB stuff is

1135
00:37:35,400 --> 00:37:37,200
really really bad it's easy to do now

1136
00:37:37,200 --> 00:37:39,119
service it it's easy to do like break

1137
00:37:39,119 --> 00:37:40,260
things

1138
00:37:40,260 --> 00:37:42,000
in the cloud stuff has similar problems

1139
00:37:42,000 --> 00:37:43,859
if you're hosting on like

1140
00:37:43,859 --> 00:37:45,420
if you're relying on cloud-based

1141
00:37:45,420 --> 00:37:47,820
challenges which we do for b-sides

1142
00:37:47,820 --> 00:37:49,680
um it can be really tricky because

1143
00:37:49,680 --> 00:37:53,160
the Google Amazon whoever might detect

1144
00:37:53,160 --> 00:37:55,740
ivity and break your service

1145
00:37:55,740 --> 00:37:57,300
also it's really easy to like mess up

1146
00:37:57,300 --> 00:38:00,000
configurations and like blah blah blah

1147
00:38:00,000 --> 00:38:02,040
see ya

1148
00:38:02,040 --> 00:38:04,380
more balance so like I obviously started

1149
00:38:04,380 --> 00:38:07,320
with bell knit as like my my target I

1150
00:38:07,320 --> 00:38:08,640
think I have two or three more bones and

1151
00:38:08,640 --> 00:38:09,960
I have 22 minutes so I think we're doing

1152
00:38:09,960 --> 00:38:11,880
pretty good

1153
00:38:11,880 --> 00:38:14,579
so this goes back again to like 1999

1154
00:38:14,579 --> 00:38:16,740
2000 and this is when I was first

1155
00:38:16,740 --> 00:38:18,000
learning how to do like versus

1156
00:38:18,000 --> 00:38:20,280
engineering hacking I I joined like a

1157
00:38:20,280 --> 00:38:24,000
group called uh Vol Legends VL who like

1158
00:38:24,000 --> 00:38:25,859
I learned a lot of stuff from as like

1159
00:38:25,859 --> 00:38:27,720
like game hacking they wrote a bunch of

1160
00:38:27,720 --> 00:38:29,460
like cheats for Starcraft that they kept

1161
00:38:29,460 --> 00:38:30,599
private and they could do a lot of cool

1162
00:38:30,599 --> 00:38:32,940
stuff like stack buildings and Crush

1163
00:38:32,940 --> 00:38:35,160
buildings and like they wrote AIS that

1164
00:38:35,160 --> 00:38:37,260
would like make the units do things it's

1165
00:38:37,260 --> 00:38:38,460
all really cool stuff and I really want

1166
00:38:38,460 --> 00:38:41,460
to learn as like a 18 year old

1167
00:38:41,460 --> 00:38:42,780
so

1168
00:38:42,780 --> 00:38:45,180
when you open up Starcraft and click on

1169
00:38:45,180 --> 00:38:48,000
Battle Nets a bunch of stuff happens

1170
00:38:48,000 --> 00:38:50,520
um it connects to balance servers it it

1171
00:38:50,520 --> 00:38:52,820
says like hey I'm I'm from this local

1172
00:38:52,820 --> 00:38:55,440
from this country I'm running this

1173
00:38:55,440 --> 00:38:56,700
version

1174
00:38:56,700 --> 00:38:58,140
um it does a bunch of stuff like that

1175
00:38:58,140 --> 00:38:59,820
the first thing it doesn't major though

1176
00:38:59,820 --> 00:39:02,220
it'll check the the

1177
00:39:02,220 --> 00:39:04,440
um the main program files the exe file

1178
00:39:04,440 --> 00:39:06,300
and the dll files to make sure I haven't

1179
00:39:06,300 --> 00:39:07,619
been tampered with and we'll talk about

1180
00:39:07,619 --> 00:39:09,540
that that's what this is based on

1181
00:39:09,540 --> 00:39:11,760
a bit of validation product key and make

1182
00:39:11,760 --> 00:39:13,560
sure it's not used it does a bunch of

1183
00:39:13,560 --> 00:39:14,880
weird maths that I bet you haven't

1184
00:39:14,880 --> 00:39:16,020
looked at it now would make more sense

1185
00:39:16,020 --> 00:39:18,119
back then I didn't understand it we call

1186
00:39:18,119 --> 00:39:19,980
it decoding the CD key I don't know what

1187
00:39:19,980 --> 00:39:22,140
does but I bet you I can figure out now

1188
00:39:22,140 --> 00:39:23,940
and then there's a password hash the

1189
00:39:23,940 --> 00:39:25,380
password hashing we call broken Shaw

1190
00:39:25,380 --> 00:39:27,720
button because of Shaw one but not they

1191
00:39:27,720 --> 00:39:30,359
made mistakes implementing it so like

1192
00:39:30,359 --> 00:39:31,859
I personally reversed all these things

1193
00:39:31,859 --> 00:39:34,859
as like a brand new person and I learned

1194
00:39:34,859 --> 00:39:36,000
a lot about it

1195
00:39:36,000 --> 00:39:37,560
but I wrote like some of my old docs and

1196
00:39:37,560 --> 00:39:39,780
other Docs that you can take a look at

1197
00:39:39,780 --> 00:39:41,760
if you want

1198
00:39:41,760 --> 00:39:44,220
but the cool part was the version check

1199
00:39:44,220 --> 00:39:45,900
it was called check revision

1200
00:39:45,900 --> 00:39:48,060
basically when you logged in you would

1201
00:39:48,060 --> 00:39:49,200
send the battle that like hey I'd like

1202
00:39:49,200 --> 00:39:50,400
to log in please I'm from this country

1203
00:39:50,400 --> 00:39:53,040
blah blah it would say sure we're gonna

1204
00:39:53,040 --> 00:39:54,839
send you a dll file like a literal

1205
00:39:54,839 --> 00:39:57,660
window dealer file that we want you to

1206
00:39:57,660 --> 00:40:00,900
loaded memory and then execute so you

1207
00:40:00,900 --> 00:40:01,859
would just download the L file over

1208
00:40:01,859 --> 00:40:03,780
plain text load the memory and execute

1209
00:40:03,780 --> 00:40:05,940
it that's terrible now but that's how we

1210
00:40:05,940 --> 00:40:08,760
how we've done it like 1997.

1211
00:40:08,760 --> 00:40:10,800
so the deal file will get a formula that

1212
00:40:10,800 --> 00:40:12,480
was hard coded and it would always

1213
00:40:12,480 --> 00:40:13,800
change like each time you do this it'll

1214
00:40:13,800 --> 00:40:15,420
be different but the formula would look

1215
00:40:15,420 --> 00:40:16,500
like this

1216
00:40:16,500 --> 00:40:18,240
the first lines

1217
00:40:18,240 --> 00:40:19,800
the second one is more realistic but the

1218
00:40:19,800 --> 00:40:22,680
first line is a demonstration a equals

1219
00:40:22,680 --> 00:40:25,079
five b equals 10 equals fifteen and then

1220
00:40:25,079 --> 00:40:27,480
a equals a plus s blah blah it would

1221
00:40:27,480 --> 00:40:29,339
send you that formula and I was like

1222
00:40:29,339 --> 00:40:31,800
what's this doing like I had no idea

1223
00:40:31,800 --> 00:40:33,420
and like what I learned from reversing

1224
00:40:33,420 --> 00:40:35,760
and from like just testing was it would

1225
00:40:35,760 --> 00:40:38,099
take each bite in the main dll files and

1226
00:40:38,099 --> 00:40:40,800
the XE file set s to that byte and then

1227
00:40:40,800 --> 00:40:42,839
run this formula so take whatever a was

1228
00:40:42,839 --> 00:40:45,480
starting at five and add s to it and

1229
00:40:45,480 --> 00:40:47,280
then do all this math it would do that

1230
00:40:47,280 --> 00:40:49,079
for every byte in the file first by

1231
00:40:49,079 --> 00:40:51,060
second by Third byte four byte in the

1232
00:40:51,060 --> 00:40:53,460
files on the operating system and based

1233
00:40:53,460 --> 00:40:54,480
on what you sent it it would know what

1234
00:40:54,480 --> 00:40:55,859
version you're on and be able to send

1235
00:40:55,859 --> 00:40:58,140
you patches or whatever

1236
00:40:58,140 --> 00:41:00,839
so we reverse that that that's all out

1237
00:41:00,839 --> 00:41:03,300
there it's easy to find but sometimes I

1238
00:41:03,300 --> 00:41:06,420
forget when like 2005 they changed it

1239
00:41:06,420 --> 00:41:07,920
they changed their thing called lockdown

1240
00:41:07,920 --> 00:41:10,260
and I reverse all of lockdown and

1241
00:41:10,260 --> 00:41:12,119
something else I know did too and I

1242
00:41:12,119 --> 00:41:14,220
can't find any of it running a sock

1243
00:41:14,220 --> 00:41:16,619
I have a Wiki this is my Wiki right here

1244
00:41:16,619 --> 00:41:19,260
oops can I click on things this is my

1245
00:41:19,260 --> 00:41:22,500
Wiki I have a bunch of links all 404 I

1246
00:41:22,500 --> 00:41:25,079
have uh source code it has it's not

1247
00:41:25,079 --> 00:41:26,280
implemented

1248
00:41:26,280 --> 00:41:28,079
um RJ who's a little friend of mine said

1249
00:41:28,079 --> 00:41:30,900
we fully intend to update this in 2007

1250
00:41:30,900 --> 00:41:32,460
so like

1251
00:41:32,460 --> 00:41:34,020
all the work I did this is completely

1252
00:41:34,020 --> 00:41:35,280
lost to the void

1253
00:41:35,280 --> 00:41:36,839
I did find one source that talked about

1254
00:41:36,839 --> 00:41:38,520
it which is um

1255
00:41:38,520 --> 00:41:40,560
a white paper style but it's a guy I

1256
00:41:40,560 --> 00:41:42,780
know called skywing he works unless I

1257
00:41:42,780 --> 00:41:43,980
take to work at Microsoft that was a

1258
00:41:43,980 --> 00:41:46,079
long time ago but he kind of documented

1259
00:41:46,079 --> 00:41:47,280
this whole thing and it's really

1260
00:41:47,280 --> 00:41:49,440
interesting but all the work I did is

1261
00:41:49,440 --> 00:41:52,140
just gone I know you happen to it it's

1262
00:41:52,140 --> 00:41:53,220
really sad like I wish I've been on

1263
00:41:53,220 --> 00:41:55,500
GitHub or something but in 2007 didn't

1264
00:41:55,500 --> 00:41:57,240
exist it's not really sad that I

1265
00:41:57,240 --> 00:41:58,619
couldn't find this to show off

1266
00:41:58,619 --> 00:42:00,240
but what lockdown did that was different

1267
00:42:00,240 --> 00:42:02,520
was instead of fingerprinting the files

1268
00:42:02,520 --> 00:42:04,680
on disk you know fingerprinted files in

1269
00:42:04,680 --> 00:42:06,300
memory and we use a bunch of

1270
00:42:06,300 --> 00:42:09,000
anti-debugging tricks to make it harder

1271
00:42:09,000 --> 00:42:11,400
so

1272
00:42:11,400 --> 00:42:13,020
the nice thing about doing it in memory

1273
00:42:13,020 --> 00:42:14,940
is that when you check something memory

1274
00:42:14,940 --> 00:42:17,280
uh debug breakpoints and things like

1275
00:42:17,280 --> 00:42:19,859
that will change the checksum

1276
00:42:19,859 --> 00:42:21,900
so it's a much more complicated thing to

1277
00:42:21,900 --> 00:42:23,700
actually bypass

1278
00:42:23,700 --> 00:42:25,020
several challenge based on that called

1279
00:42:25,020 --> 00:42:26,460
secure asset manager

1280
00:42:26,460 --> 00:42:28,560
uh secure asset managers from beside in

1281
00:42:28,560 --> 00:42:31,140
San Francisco 2021 as usual the source

1282
00:42:31,140 --> 00:42:32,760
is linked

1283
00:42:32,760 --> 00:42:34,920
basically you can't go a service it

1284
00:42:34,920 --> 00:42:36,480
sends you a string that's not unlike

1285
00:42:36,480 --> 00:42:38,760
that that the challenge thing you saw

1286
00:42:38,760 --> 00:42:40,440
you do what checks out my memory based

1287
00:42:40,440 --> 00:42:42,060
on that and then send the checks on back

1288
00:42:42,060 --> 00:42:45,599
so it does the exact same thing

1289
00:42:45,599 --> 00:42:46,440
um

1290
00:42:46,440 --> 00:42:48,300
yeah debugging breakpoints stuff like

1291
00:42:48,300 --> 00:42:49,859
that will change the response that makes

1292
00:42:49,859 --> 00:42:50,880
it really hard a lot of people think

1293
00:42:50,880 --> 00:42:52,380
they got it solved and it doesn't work

1294
00:42:52,380 --> 00:42:54,660
it turns out because they were using the

1295
00:42:54,660 --> 00:42:56,940
bugger and it broke

1296
00:42:56,940 --> 00:42:58,920
so yeah I think I implemented all the

1297
00:42:58,920 --> 00:43:00,359
stuff I found tricky about reversing it

1298
00:43:00,359 --> 00:43:01,440
without

1299
00:43:01,440 --> 00:43:04,680
anything that was actually the code

1300
00:43:04,680 --> 00:43:06,660
that was the first thing I reversed and

1301
00:43:06,660 --> 00:43:08,339
I hacked and I really want to shadow

1302
00:43:08,339 --> 00:43:10,260
people and I've done the same challenge

1303
00:43:10,260 --> 00:43:11,700
in like three or four different

1304
00:43:11,700 --> 00:43:14,760
iterations where I try to do like the

1305
00:43:14,760 --> 00:43:16,140
challenge I remember having with this

1306
00:43:16,140 --> 00:43:17,760
and then doing it again

1307
00:43:17,760 --> 00:43:19,619
so like I thought it was really cool I

1308
00:43:19,619 --> 00:43:21,119
learned from this I want others too as

1309
00:43:21,119 --> 00:43:22,920
well

1310
00:43:22,920 --> 00:43:24,420
so this is the last vulnerability and

1311
00:43:24,420 --> 00:43:26,880
it's by far my favorite one

1312
00:43:26,880 --> 00:43:28,319
so

1313
00:43:28,319 --> 00:43:29,700
you probably heard Pokemon I think

1314
00:43:29,700 --> 00:43:32,400
Brian's playing it as we speak and

1315
00:43:32,400 --> 00:43:34,020
there was a vulnerability in Pokemon Red

1316
00:43:34,020 --> 00:43:35,640
back in the old days

1317
00:43:35,640 --> 00:43:38,940
and it was called the old man glitch and

1318
00:43:38,940 --> 00:43:40,740
the way it worked was

1319
00:43:40,740 --> 00:43:43,380
you would go to a cutscene where

1320
00:43:43,380 --> 00:43:45,660
the old man the character in the game

1321
00:43:45,660 --> 00:43:47,640
would

1322
00:43:47,640 --> 00:43:50,339
um show you how to work a Pokeball which

1323
00:43:50,339 --> 00:43:52,560
you throw at things is minor setting I

1324
00:43:52,560 --> 00:43:55,800
really play these and then he would with

1325
00:43:55,800 --> 00:43:57,540
he would just wander off to a place I

1326
00:43:57,540 --> 00:43:59,339
think civilian island or something and

1327
00:43:59,339 --> 00:44:00,960
he would go you go waiting like on the

1328
00:44:00,960 --> 00:44:02,880
right there and then you would run to a

1329
00:44:02,880 --> 00:44:05,339
Pokemon that doesn't exist missing

1330
00:44:05,339 --> 00:44:08,220
though or others

1331
00:44:08,220 --> 00:44:09,900
but what's going on here

1332
00:44:09,900 --> 00:44:12,060
oh this was an old old issue that like

1333
00:44:12,060 --> 00:44:13,680
everyone can play Pokemon on Game Boy I

1334
00:44:13,680 --> 00:44:14,579
knew about

1335
00:44:14,579 --> 00:44:16,859
and it's probably old man glitch

1336
00:44:16,859 --> 00:44:18,180
so basically happening because when you

1337
00:44:18,180 --> 00:44:19,440
talk to the old man

1338
00:44:19,440 --> 00:44:21,300
your name like if I name my character

1339
00:44:21,300 --> 00:44:23,280
Ron or whatever

1340
00:44:23,280 --> 00:44:25,619
your name is replaced with old man

1341
00:44:25,619 --> 00:44:27,300
temporarily so they can like show you

1342
00:44:27,300 --> 00:44:29,160
how to play

1343
00:44:29,160 --> 00:44:31,380
the problem is this is this is from like

1344
00:44:31,380 --> 00:44:34,560
when's Game Boy like 1995 I don't know

1345
00:44:34,560 --> 00:44:38,040
it's in the 90s anyway and

1346
00:44:38,040 --> 00:44:39,480
it didn't start your name somewhere

1347
00:44:39,480 --> 00:44:40,680
because there's no like Heap there's no

1348
00:44:40,680 --> 00:44:42,480
way like temporary store your memory

1349
00:44:42,480 --> 00:44:43,859
so it would copy your name to someone

1350
00:44:43,859 --> 00:44:45,720
that's not currently being used which

1351
00:44:45,720 --> 00:44:47,520
was the encounter data table

1352
00:44:47,520 --> 00:44:49,079
which means that next time you have an

1353
00:44:49,079 --> 00:44:52,020
encounter if a table is never reset it

1354
00:44:52,020 --> 00:44:53,579
would just have an encounter based on

1355
00:44:53,579 --> 00:44:55,079
your name rather than what you're

1356
00:44:55,079 --> 00:44:56,940
supposed to and as a result you can have

1357
00:44:56,940 --> 00:44:58,740
all kinds of broken encounters uh you

1358
00:44:58,740 --> 00:45:00,000
could based on your name you could

1359
00:45:00,000 --> 00:45:02,520
change the level the type of Pokemon the

1360
00:45:02,520 --> 00:45:07,200
IVs and EVs and uh Pokey things

1361
00:45:07,200 --> 00:45:08,640
Brandon's cringing about my poke

1362
00:45:08,640 --> 00:45:10,619
knowledge uh Cinnabar Island not

1363
00:45:10,619 --> 00:45:11,819
Cerulean

1364
00:45:11,819 --> 00:45:14,040
so yeah basically it stores it stores

1365
00:45:14,040 --> 00:45:15,900
your name in 800 data

1366
00:45:15,900 --> 00:45:17,400
so basically so whatever's in memory

1367
00:45:17,400 --> 00:45:19,560
this is the use after free ultimately is

1368
00:45:19,560 --> 00:45:21,780
what is really known as

1369
00:45:21,780 --> 00:45:23,099
um it copies anything memory and then

1370
00:45:23,099 --> 00:45:25,560
uses it for the wrong kind of thing

1371
00:45:25,560 --> 00:45:27,900
so I'm in the game based on this on the

1372
00:45:27,900 --> 00:45:29,460
left is the original Pokemon on the

1373
00:45:29,460 --> 00:45:31,380
right is my map

1374
00:45:31,380 --> 00:45:33,599
um there's an example putting way way

1375
00:45:33,599 --> 00:45:36,000
way way way too much work to a challenge

1376
00:45:36,000 --> 00:45:39,000
let's see if I can zoom this right

1377
00:45:39,000 --> 00:45:40,440
Zoom

1378
00:45:40,440 --> 00:45:42,000
so this is enough I made this is Google

1379
00:45:42,000 --> 00:45:42,960
Docs

1380
00:45:42,960 --> 00:45:45,359
so I basically made this map and I would

1381
00:45:45,359 --> 00:45:47,460
export this to a CSV file and then load

1382
00:45:47,460 --> 00:45:49,440
it into the game and

1383
00:45:49,440 --> 00:45:50,880
it was really complicated but it

1384
00:45:50,880 --> 00:45:52,380
actually worked really well so I could

1385
00:45:52,380 --> 00:45:54,359
just design map in Google Docs

1386
00:45:54,359 --> 00:45:56,280
that was neat it's like in like modify

1387
00:45:56,280 --> 00:45:58,319
them out like if I put Patrice in like

1388
00:45:58,319 --> 00:46:00,900
with treason and if I make if I export

1389
00:46:00,900 --> 00:46:02,700
this and Run the game it will have trees

1390
00:46:02,700 --> 00:46:04,619
there now

1391
00:46:04,619 --> 00:46:08,040
um so I made all this I also made um a

1392
00:46:08,040 --> 00:46:09,300
list of Pokemons

1393
00:46:09,300 --> 00:46:11,760
so this is the actual Pokemon names

1394
00:46:11,760 --> 00:46:14,160
um sorry uh game freak if I'm battling

1395
00:46:14,160 --> 00:46:16,500
copyrights but like Bulbasaur Ivysaur

1396
00:46:16,500 --> 00:46:18,780
Venusaur Charmander I got all these from

1397
00:46:18,780 --> 00:46:20,160
the wiki

1398
00:46:20,160 --> 00:46:21,780
but then for copyright reasons and

1399
00:46:21,780 --> 00:46:24,060
because for human reasons we changed

1400
00:46:24,060 --> 00:46:25,200
them all my husband actually did all

1401
00:46:25,200 --> 00:46:28,440
this work he changed like

1402
00:46:28,440 --> 00:46:29,400
um

1403
00:46:29,400 --> 00:46:32,579
Bulbasaur to plant frog and Venusaur to

1404
00:46:32,579 --> 00:46:34,260
climb dinosaur and so on and so on and

1405
00:46:34,260 --> 00:46:36,540
so on if you play Pokemon you know how

1406
00:46:36,540 --> 00:46:38,880
much work you put into this it's 152

1407
00:46:38,880 --> 00:46:40,859
technically because of busy no

1408
00:46:40,859 --> 00:46:42,540
and like

1409
00:46:42,540 --> 00:46:44,579
he put so much work into that I put so

1410
00:46:44,579 --> 00:46:46,079
much work in this map and then I

1411
00:46:46,079 --> 00:46:48,240
celebrated a game that was vulnerable

1412
00:46:48,240 --> 00:46:49,680
so here's what the game looks like when

1413
00:46:49,680 --> 00:46:51,960
you actually play it I'm gonna be run

1414
00:46:51,960 --> 00:46:53,819
the actual vulnerability a bit too hard

1415
00:46:53,819 --> 00:46:56,400
to show off but I will show you the x24

1416
00:46:56,400 --> 00:46:58,200
in a bit

1417
00:46:58,200 --> 00:46:59,760
so I'm gonna choose plan frog with my

1418
00:46:59,760 --> 00:47:01,980
starter we have artwork wait a little

1419
00:47:01,980 --> 00:47:02,880
better

1420
00:47:02,880 --> 00:47:05,359
small

1421
00:47:05,700 --> 00:47:08,700
it can also be fire lizard

1422
00:47:08,700 --> 00:47:10,859
not to be confused as Char Charmeleon

1423
00:47:10,859 --> 00:47:12,540
whatever

1424
00:47:12,540 --> 00:47:14,880
I'm not Pokey guy there's also a small

1425
00:47:14,880 --> 00:47:15,780
vulnerability in this which doesn't

1426
00:47:15,780 --> 00:47:16,920
really matter where you can choose any

1427
00:47:16,920 --> 00:47:18,060
Pokemon

1428
00:47:18,060 --> 00:47:20,099
so you could do fire you could do

1429
00:47:20,099 --> 00:47:23,400
missing missing no I think dot which is

1430
00:47:23,400 --> 00:47:25,440
just like this is an Easter egg this is

1431
00:47:25,440 --> 00:47:26,880
not actually useful but you're getting

1432
00:47:26,880 --> 00:47:29,099
missing though

1433
00:47:29,099 --> 00:47:30,839
so once you start the game you get to

1434
00:47:30,839 --> 00:47:33,680
walk around the game world

1435
00:47:35,040 --> 00:47:36,960
um the goal of this game and it says it

1436
00:47:36,960 --> 00:47:39,720
somewhere is if you can collect all 151

1437
00:47:39,720 --> 00:47:41,160
Pokemon

1438
00:47:41,160 --> 00:47:43,619
which is in this list or see all 151

1439
00:47:43,619 --> 00:47:44,400
Pokemon

1440
00:47:44,400 --> 00:47:47,400
then you'll get a flag basically

1441
00:47:47,400 --> 00:47:49,260
it just occurred to me completely

1442
00:47:49,260 --> 00:47:50,339
randomly

1443
00:47:50,339 --> 00:47:52,619
that the professor is actually based on

1444
00:47:52,619 --> 00:47:55,500
the Jack from b-sides uh Jack Daniel

1445
00:47:55,500 --> 00:47:57,599
Professor Jack which is kind of funny I

1446
00:47:57,599 --> 00:47:59,160
just said that's a joke but

1447
00:47:59,160 --> 00:48:01,380
kind of works here

1448
00:48:01,380 --> 00:48:02,640
we have the whole world you just have a

1449
00:48:02,640 --> 00:48:05,400
spreadsheet it's all

1450
00:48:05,400 --> 00:48:07,020
all the names and all the locations and

1451
00:48:07,020 --> 00:48:09,119
all the encounters are all done

1452
00:48:09,119 --> 00:48:10,440
there's

1453
00:48:10,440 --> 00:48:13,140
there's uh fights all the map of the

1454
00:48:13,140 --> 00:48:14,099
fights is based on the actual Pokemon

1455
00:48:14,099 --> 00:48:16,200
map like it's all

1456
00:48:16,200 --> 00:48:18,480
way too much work according to this

1457
00:48:18,480 --> 00:48:20,880
there's also um

1458
00:48:20,880 --> 00:48:22,859
uh I forget what the command is there's

1459
00:48:22,859 --> 00:48:24,900
hidden commands it's this really

1460
00:48:24,900 --> 00:48:26,640
complicated game for reversing and for

1461
00:48:26,640 --> 00:48:28,680
uh playing

1462
00:48:28,680 --> 00:48:30,720
now the actual vulnerability in this

1463
00:48:30,720 --> 00:48:33,660
let's see if I can find my slides

1464
00:48:33,660 --> 00:48:35,700
uh talked about that talked about that

1465
00:48:35,700 --> 00:48:37,920
oh yeah use that for free there we go

1466
00:48:37,920 --> 00:48:39,960
so it's basically

1467
00:48:39,960 --> 00:48:41,579
is it way too small

1468
00:48:41,579 --> 00:48:44,460
I use after free in the uh

1469
00:48:44,460 --> 00:48:47,640
capture thing or if you capture a uh

1470
00:48:47,640 --> 00:48:50,040
Pokemon and then free it you end up with

1471
00:48:50,040 --> 00:48:52,920
a pointer to uninitialize memory and you

1472
00:48:52,920 --> 00:48:54,839
could by using a game changer change

1473
00:48:54,839 --> 00:48:57,119
your name to be put into memory which is

1474
00:48:57,119 --> 00:48:59,460
like a weird Heap attack

1475
00:48:59,460 --> 00:49:01,380
um the actual doesn't really matter I

1476
00:49:01,380 --> 00:49:02,940
did a very detailed uh video about it

1477
00:49:02,940 --> 00:49:06,359
which is linked right here

1478
00:49:06,359 --> 00:49:08,040
but I also wrote an exploit for it that

1479
00:49:08,040 --> 00:49:10,380
I can show off

1480
00:49:10,380 --> 00:49:12,800
which

1481
00:49:13,380 --> 00:49:15,660
I this is a one second Brew of delay but

1482
00:49:15,660 --> 00:49:17,460
you can see how it wanders around

1483
00:49:17,460 --> 00:49:18,780
it's gonna take forever to do anything

1484
00:49:18,780 --> 00:49:23,220
let's go 0.3 seconds

1485
00:49:23,220 --> 00:49:25,260
so it I also used to hit those hidden

1486
00:49:25,260 --> 00:49:27,119
teleport commands

1487
00:49:27,119 --> 00:49:28,740
um it knows how to do fights it knows

1488
00:49:28,740 --> 00:49:30,420
how to do all this all right like I said

1489
00:49:30,420 --> 00:49:33,000
I spent a lot of time on this

1490
00:49:33,000 --> 00:49:34,440
everything is doing this for a reason

1491
00:49:34,440 --> 00:49:36,780
that's a name changer

1492
00:49:36,780 --> 00:49:38,160
I'm not gonna make you watch this in

1493
00:49:38,160 --> 00:49:41,819
that speed I think 0.0 for was what I

1494
00:49:41,819 --> 00:49:43,260
was gonna test it

1495
00:49:43,260 --> 00:49:46,200
basically this just it uses the

1496
00:49:46,200 --> 00:49:47,940
encounter table vulnerability to use

1497
00:49:47,940 --> 00:49:49,680
your name to overwrite the encounter

1498
00:49:49,680 --> 00:49:51,119
table and be able to encounter things

1499
00:49:51,119 --> 00:49:53,579
you should be able to counter basically

1500
00:49:53,579 --> 00:49:55,859
um you'll see that the encounter table

1501
00:49:55,859 --> 00:49:58,200
has high as an encounter which is not

1502
00:49:58,200 --> 00:50:02,480
valid in addition to the uh other names

1503
00:50:02,660 --> 00:50:04,500
it probably won't finish my time my

1504
00:50:04,500 --> 00:50:06,780
Talk's done but it will eventually log

1505
00:50:06,780 --> 00:50:10,880
all 151 Pokemons and then win the game

1506
00:50:11,940 --> 00:50:12,720
um

1507
00:50:12,720 --> 00:50:14,280
yeah so this is not identical to

1508
00:50:14,280 --> 00:50:16,079
vulnerability but I think it captures

1509
00:50:16,079 --> 00:50:17,819
the feeling like I think the whole like

1510
00:50:17,819 --> 00:50:19,859
using your name use after free all those

1511
00:50:19,859 --> 00:50:22,500
kinds of things are kind of captured and

1512
00:50:22,500 --> 00:50:23,760
like this is by far the intelligence I'm

1513
00:50:23,760 --> 00:50:25,079
most proud of because I put tons of work

1514
00:50:25,079 --> 00:50:27,540
into it but like there's a lot of

1515
00:50:27,540 --> 00:50:28,559
Futurama

1516
00:50:28,559 --> 00:50:31,200
similar to or

1517
00:50:31,200 --> 00:50:32,280
something like that similar to people

1518
00:50:32,280 --> 00:50:34,319
legally sing from that use a lot you

1519
00:50:34,319 --> 00:50:35,640
know still not to say legally in my talk

1520
00:50:35,640 --> 00:50:38,040
so similar to what technique is taking

1521
00:50:38,040 --> 00:50:39,720
from is similar to a legalisting from

1522
00:50:39,720 --> 00:50:41,520
similar typically existing from but

1523
00:50:41,520 --> 00:50:45,480
anyway so that's that vulnerability

1524
00:50:45,480 --> 00:50:47,339
and that's kind of the uh the last part

1525
00:50:47,339 --> 00:50:48,839
of my talk

1526
00:50:48,839 --> 00:50:50,579
um I said there's one side that's a

1527
00:50:50,579 --> 00:50:51,780
conclusion because I felt like if I said

1528
00:50:51,780 --> 00:50:53,579
nothing else it would be kind of too

1529
00:50:53,579 --> 00:50:54,540
soon

1530
00:50:54,540 --> 00:50:56,280
basically there's there's some bugs that

1531
00:50:56,280 --> 00:50:58,200
we find that are very teachable moments

1532
00:50:58,200 --> 00:50:59,760
um the F5 vulnerability where I learned

1533
00:50:59,760 --> 00:51:01,200
about headers and stuff like that are

1534
00:51:01,200 --> 00:51:03,180
very well teachable moments

1535
00:51:03,180 --> 00:51:05,579
some bugs you find that you can't talk

1536
00:51:05,579 --> 00:51:06,359
about

1537
00:51:06,359 --> 00:51:08,280
because they're in customer stuff but

1538
00:51:08,280 --> 00:51:09,839
you do want to talk about you can often

1539
00:51:09,839 --> 00:51:11,280
find ways to get around that and do like

1540
00:51:11,280 --> 00:51:13,380
challenges based on those

1541
00:51:13,380 --> 00:51:15,119
um some bugs are too hard to implement

1542
00:51:15,119 --> 00:51:16,980
like I wasn't going to implemented

1543
00:51:16,980 --> 00:51:18,839
Diablo 2 server but I could make a

1544
00:51:18,839 --> 00:51:20,579
server that that behave like the able to

1545
00:51:20,579 --> 00:51:22,980
server and some burgers some bugs just

1546
00:51:22,980 --> 00:51:25,020
don't work we talked about WebEx

1547
00:51:25,020 --> 00:51:26,520
that's pretty much it

1548
00:51:26,520 --> 00:51:27,839
um there's a tiny around the bottom

1549
00:51:27,839 --> 00:51:29,280
there where you can get this these

1550
00:51:29,280 --> 00:51:30,300
slides

1551
00:51:30,300 --> 00:51:31,680
um the QR code will take you there I

1552
00:51:31,680 --> 00:51:33,180
promise

1553
00:51:33,180 --> 00:51:34,619
um my reference haven't worked at

1554
00:51:34,619 --> 00:51:36,059
hackerkb.com

1555
00:51:36,059 --> 00:51:37,740
I seriously think that Dr be the coolest

1556
00:51:37,740 --> 00:51:39,359
thing I've ever worked on I get to just

1557
00:51:39,359 --> 00:51:40,260
write detailed stuff about

1558
00:51:40,260 --> 00:51:42,720
vulnerabilities and my co-workers can

1559
00:51:42,720 --> 00:51:45,059
confirm this we just like spend days

1560
00:51:45,059 --> 00:51:46,319
researching a vulnerability and writing

1561
00:51:46,319 --> 00:51:48,180
about it I think it's really cool my

1562
00:51:48,180 --> 00:51:49,740
blog which I mostly released for ctfs

1563
00:51:49,740 --> 00:51:53,760
now and my email addresses so

1564
00:51:53,760 --> 00:51:55,260
I don't know when I have to be out of

1565
00:51:55,260 --> 00:51:56,040
here but I might have a couple minutes

1566
00:51:56,040 --> 00:51:57,960
for questions I'm totally have two

1567
00:51:57,960 --> 00:52:00,079
minutes

1568
00:52:01,260 --> 00:52:04,020
anyone wants to know how the uh

1569
00:52:04,020 --> 00:52:06,000
oh we're at the number 32 so this will

1570
00:52:06,000 --> 00:52:07,859
never finish

1571
00:52:07,859 --> 00:52:10,700
33.

1572
00:52:10,800 --> 00:52:12,480
thanks everyone coming and have a good

1573
00:52:12,480 --> 00:52:15,440
rest of your biggest

