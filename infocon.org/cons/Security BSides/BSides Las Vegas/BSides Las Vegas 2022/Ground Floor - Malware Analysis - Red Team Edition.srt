1
00:00:00,560 --> 00:00:02,560
all right good morning

2
00:00:02,560 --> 00:00:05,279
i'd like to welcome you all to b-sides

3
00:00:05,279 --> 00:00:07,759
uh this specifically is the ground floor

4
00:00:07,759 --> 00:00:09,200
track so

5
00:00:09,200 --> 00:00:13,040
uh today i have the honor of introducing

6
00:00:13,040 --> 00:00:14,880
uriel who'll be going ahead and talking

7
00:00:14,880 --> 00:00:17,119
about mail or analysis the red team

8
00:00:17,119 --> 00:00:18,160
edition

9
00:00:18,160 --> 00:00:20,080
uh before we do that of course i have a

10
00:00:20,080 --> 00:00:21,359
couple of those little announcements to

11
00:00:21,359 --> 00:00:23,119
give real quick so

12
00:00:23,119 --> 00:00:26,000
first we'd like to start with uh our

13
00:00:26,000 --> 00:00:28,000
thanking our sponsors who are

14
00:00:28,000 --> 00:00:30,080
responsible for making all this happen

15
00:00:30,080 --> 00:00:32,238
without them we literally couldn't be

16
00:00:32,238 --> 00:00:34,079
here doing what we do

17
00:00:34,079 --> 00:00:35,360
we'd like to especially thank our

18
00:00:35,360 --> 00:00:38,480
diamond sponsors lastpass and palo alto

19
00:00:38,480 --> 00:00:41,840
networks and our gold sponsors uh amazon

20
00:00:41,840 --> 00:00:44,800
flextrac and google

21
00:00:44,800 --> 00:00:47,280
it's their support along with our other

22
00:00:47,280 --> 00:00:50,399
sponsors donors and volunteers that make

23
00:00:50,399 --> 00:00:52,960
this event possible

24
00:00:52,960 --> 00:00:55,600
these talks are being streamed live and

25
00:00:55,600 --> 00:00:57,440
they are being recorded and will be

26
00:00:57,440 --> 00:01:00,079
posted on youtube so there is no need

27
00:01:00,079 --> 00:01:02,399
for you to take photos or videos of the

28
00:01:02,399 --> 00:01:03,840
presentation

29
00:01:03,840 --> 00:01:06,799
we ask that you try to silence your cell

30
00:01:06,799 --> 00:01:09,280
phones keep them in your pockets

31
00:01:09,280 --> 00:01:10,799
as a reminder

32
00:01:10,799 --> 00:01:13,040
our policy is photographs is that you if

33
00:01:13,040 --> 00:01:14,880
you do take a photograph

34
00:01:14,880 --> 00:01:16,640
you should have permission for anybody

35
00:01:16,640 --> 00:01:18,400
who's in the shot we're very sensitive

36
00:01:18,400 --> 00:01:20,880
to being photographed uh some uh

37
00:01:20,880 --> 00:01:23,040
presenters and or uh members of the

38
00:01:23,040 --> 00:01:25,920
community prefer to stay anonymous so

39
00:01:25,920 --> 00:01:27,840
please remember that as you're taking

40
00:01:27,840 --> 00:01:31,040
photos around the conference uh also i'd

41
00:01:31,040 --> 00:01:32,799
like to remind you if we're going to do

42
00:01:32,799 --> 00:01:35,040
questions and answers afterwards please

43
00:01:35,040 --> 00:01:37,439
step up and use the microphone it's not

44
00:01:37,439 --> 00:01:39,280
so much for

45
00:01:39,280 --> 00:01:42,000
us in the room or for the presenter but

46
00:01:42,000 --> 00:01:44,159
it's being recorded so that those who

47
00:01:44,159 --> 00:01:46,159
watch it later can hear your question

48
00:01:46,159 --> 00:01:48,640
clearly as it's being asked

49
00:01:48,640 --> 00:01:49,680
so

50
00:01:49,680 --> 00:01:51,600
all right uh with that i'd like to go

51
00:01:51,600 --> 00:01:54,079
ahead and turn it over and say there it

52
00:01:54,079 --> 00:01:58,158
is uh thank you so much for being here

53
00:01:58,399 --> 00:01:59,920
thank you very much for introducing me

54
00:01:59,920 --> 00:02:01,680
so first of all cheers give yourself a

55
00:02:01,680 --> 00:02:03,439
round of applause please

56
00:02:03,439 --> 00:02:04,560
oh oh

57
00:02:04,560 --> 00:02:08,239
come on come on open up

58
00:02:08,239 --> 00:02:11,759
so uh first of all cheers

59
00:02:14,480 --> 00:02:15,760
cognac

60
00:02:15,760 --> 00:02:16,959
um

61
00:02:16,959 --> 00:02:19,200
so first of all my name is royal kosai

62
00:02:19,200 --> 00:02:21,360
thank you for presenting me

63
00:02:21,360 --> 00:02:24,239
uh first words of appreciation uh before

64
00:02:24,239 --> 00:02:26,959
we going to start with our presentation

65
00:02:26,959 --> 00:02:29,040
uh i want to thank uh first of all i

66
00:02:29,040 --> 00:02:31,280
want to thank god and my mom of course

67
00:02:31,280 --> 00:02:32,720
because if not for them i will not be

68
00:02:32,720 --> 00:02:35,519
here i want to thank besides for making

69
00:02:35,519 --> 00:02:37,519
this amazing

70
00:02:37,519 --> 00:02:38,720
conference

71
00:02:38,720 --> 00:02:40,800
and of course thank you amazing audience

72
00:02:40,800 --> 00:02:43,040
thank you for being here so let's get

73
00:02:43,040 --> 00:02:45,519
started

74
00:02:45,920 --> 00:02:47,200
so

75
00:02:47,200 --> 00:02:51,040
i like my talks and my presentation be

76
00:02:51,040 --> 00:02:53,120
less about talks and more about doing

77
00:02:53,120 --> 00:02:55,200
and more about practical stuff

78
00:02:55,200 --> 00:02:58,640
like you know we'll do a couple of demos

79
00:02:58,640 --> 00:03:00,800
so i'll first introduce what i will show

80
00:03:00,800 --> 00:03:02,239
you in the demo so you'll have some

81
00:03:02,239 --> 00:03:03,280
interest

82
00:03:03,280 --> 00:03:04,720
the first demo will be about the dark

83
00:03:04,720 --> 00:03:07,120
side run somewhere and how you can as a

84
00:03:07,120 --> 00:03:08,879
red team learn from it

85
00:03:08,879 --> 00:03:11,280
and basically how you can take the same

86
00:03:11,280 --> 00:03:13,280
concepts and kind of implement them in

87
00:03:13,280 --> 00:03:15,599
your own malware you develop

88
00:03:15,599 --> 00:03:17,760
and another demo which i'll introduce

89
00:03:17,760 --> 00:03:20,080
how to implement some of the bypass

90
00:03:20,080 --> 00:03:21,760
antivirus bypass techniques in your own

91
00:03:21,760 --> 00:03:24,799
malware in order to basically evade

92
00:03:24,799 --> 00:03:27,920
antivirus and edr software

93
00:03:27,920 --> 00:03:31,200
and my goal in this presentation this

94
00:03:31,200 --> 00:03:34,159
talk is basically for you

95
00:03:34,159 --> 00:03:35,840
to open up your mind

96
00:03:35,840 --> 00:03:37,680
to be fluid

97
00:03:37,680 --> 00:03:39,360
not to be rigid

98
00:03:39,360 --> 00:03:41,760
and

99
00:03:41,760 --> 00:03:43,599
basically

100
00:03:43,599 --> 00:03:47,280
help security grow and become better

101
00:03:47,280 --> 00:03:48,480
so

102
00:03:48,480 --> 00:03:52,159
basically let's get started

103
00:03:53,280 --> 00:03:55,360
so this talk is not only for retimers

104
00:03:55,360 --> 00:03:58,000
it's for everyone but

105
00:03:58,000 --> 00:04:01,120
the the aim is specifically more about

106
00:04:01,120 --> 00:04:02,560
retimers

107
00:04:02,560 --> 00:04:04,720
but again anyone can learn from it take

108
00:04:04,720 --> 00:04:07,519
the concepts take the tools and uh you

109
00:04:07,519 --> 00:04:09,680
know implement it

110
00:04:09,680 --> 00:04:11,519
so i want you

111
00:04:11,519 --> 00:04:13,599
to learn malware analysis

112
00:04:13,599 --> 00:04:16,399
now what the heck a retimer want to know

113
00:04:16,399 --> 00:04:19,519
about malware analysis like why

114
00:04:19,519 --> 00:04:22,000
any retimer has its own tools

115
00:04:22,000 --> 00:04:24,240
his own c2 his own

116
00:04:24,240 --> 00:04:26,479
thing

117
00:04:26,560 --> 00:04:29,120
and eventually you know most of the

118
00:04:29,120 --> 00:04:31,759
people that are retimers

119
00:04:31,759 --> 00:04:33,680
are uh you know more about

120
00:04:33,680 --> 00:04:35,919
infrastructure penetration testing or uh

121
00:04:35,919 --> 00:04:38,639
you know uh active directory and stuff

122
00:04:38,639 --> 00:04:39,840
like this

123
00:04:39,840 --> 00:04:42,479
but in the end of the day most of the

124
00:04:42,479 --> 00:04:44,800
adversaries or the attackers

125
00:04:44,800 --> 00:04:47,280
will go for your data

126
00:04:47,280 --> 00:04:48,400
okay

127
00:04:48,400 --> 00:04:49,840
they will write ransomware they will

128
00:04:49,840 --> 00:04:52,320
write some info stealers they will

129
00:04:52,320 --> 00:04:54,880
use mostly malware

130
00:04:54,880 --> 00:04:56,720
so if you want to become

131
00:04:56,720 --> 00:04:58,960
a stronger retimer and a better security

132
00:04:58,960 --> 00:05:00,240
researcher

133
00:05:00,240 --> 00:05:02,240
you need to learn malware analysis and

134
00:05:02,240 --> 00:05:04,160
not only for the sake of malware

135
00:05:04,160 --> 00:05:06,000
analysis

136
00:05:06,000 --> 00:05:06,880
but

137
00:05:06,880 --> 00:05:11,520
for the sake of offensive security

138
00:05:11,520 --> 00:05:13,120
so a little bit about me my name is

139
00:05:13,120 --> 00:05:15,440
uriel kosair i'm the book author of

140
00:05:15,440 --> 00:05:17,440
antivirus bypass techniques

141
00:05:17,440 --> 00:05:19,840
basically the book presents you 10

142
00:05:19,840 --> 00:05:21,360
practical techniques

143
00:05:21,360 --> 00:05:22,840
which you can implement in your own

144
00:05:22,840 --> 00:05:25,600
tools and will help you to bypass

145
00:05:25,600 --> 00:05:29,039
basically any antivirus and edr

146
00:05:29,039 --> 00:05:30,639
and of course this book also provides

147
00:05:30,639 --> 00:05:32,479
some security recommendations that you

148
00:05:32,479 --> 00:05:34,000
can use in order to develop better

149
00:05:34,000 --> 00:05:36,400
antivirus and do better detection

150
00:05:36,400 --> 00:05:38,800
engineering and stuff like this

151
00:05:38,800 --> 00:05:40,639
i'm also the founder of malware analysis

152
00:05:40,639 --> 00:05:42,639
co which is basically a website that

153
00:05:42,639 --> 00:05:45,199
gives you all the necessary information

154
00:05:45,199 --> 00:05:47,440
you need for malware analysis like tools

155
00:05:47,440 --> 00:05:50,080
cheat sheets stuff like this

156
00:05:50,080 --> 00:05:51,919
you also have my courses there i

157
00:05:51,919 --> 00:05:53,840
provided course like basic malware

158
00:05:53,840 --> 00:05:56,000
analysis advanced reverse engineering

159
00:05:56,000 --> 00:06:00,160
and other stuff like malware development

160
00:06:00,400 --> 00:06:03,199
basically i like to do male research

161
00:06:03,199 --> 00:06:06,319
and other security related topics i'm

162
00:06:06,319 --> 00:06:08,319
also the red team tech leader of the

163
00:06:08,319 --> 00:06:10,880
biggest company uh like the biggest beer

164
00:06:10,880 --> 00:06:13,280
company in the world called abn bev

165
00:06:13,280 --> 00:06:15,039
uh just a small disclaimer i'm not

166
00:06:15,039 --> 00:06:16,800
talking in behalf of abby and bev

167
00:06:16,800 --> 00:06:19,440
talking behalf before myself but just

168
00:06:19,440 --> 00:06:21,360
for you to know

169
00:06:21,360 --> 00:06:24,639
um also youtuber blogger lecturer uh

170
00:06:24,639 --> 00:06:26,560
like uh one of my biggest passions

171
00:06:26,560 --> 00:06:30,160
actually is to uh teach students and

172
00:06:30,160 --> 00:06:32,400
give them the knowledge and and given

173
00:06:32,400 --> 00:06:33,280
tools

174
00:06:33,280 --> 00:06:35,759
to become better security professionals

175
00:06:35,759 --> 00:06:36,880
and also

176
00:06:36,880 --> 00:06:39,600
uh to enter this field so i doing this

177
00:06:39,600 --> 00:06:41,919
for something like 10 years in israel

178
00:06:41,919 --> 00:06:43,440
around the world also

179
00:06:43,440 --> 00:06:45,280
and it's a great honor for me also to

180
00:06:45,280 --> 00:06:47,600
stand here

181
00:06:47,600 --> 00:06:50,720
so before the show begins

182
00:06:50,720 --> 00:06:54,240
what the heck is malware analysis

183
00:06:55,039 --> 00:06:56,880
i like to define things

184
00:06:56,880 --> 00:06:59,440
very shortly without all the wikipedia

185
00:06:59,440 --> 00:07:01,520
mumbo jumbo stuff you know

186
00:07:01,520 --> 00:07:03,840
so metal analysis basically is the art

187
00:07:03,840 --> 00:07:06,160
of analyzing and research of malicious

188
00:07:06,160 --> 00:07:08,560
software behavior and patterns

189
00:07:08,560 --> 00:07:10,720
and by researching malicious behaviors

190
00:07:10,720 --> 00:07:12,400
and patterns you can learn a lot from

191
00:07:12,400 --> 00:07:13,759
them

192
00:07:13,759 --> 00:07:15,440
for the sake of blue teaming like

193
00:07:15,440 --> 00:07:18,080
detecting malware extracting indicators

194
00:07:18,080 --> 00:07:20,560
of compromise understanding the ttps and

195
00:07:20,560 --> 00:07:22,160
all this stuff

196
00:07:22,160 --> 00:07:23,599
but also

197
00:07:23,599 --> 00:07:26,000
as a rhythmer you can

198
00:07:26,000 --> 00:07:28,000
learn a lot from those malware from

199
00:07:28,000 --> 00:07:30,479
their techniques from their bypass stuff

200
00:07:30,479 --> 00:07:32,960
uh how they obfuscate their strings how

201
00:07:32,960 --> 00:07:34,560
they use their malware how they're how

202
00:07:34,560 --> 00:07:36,080
they actually literally move in your

203
00:07:36,080 --> 00:07:37,919
network so it's

204
00:07:37,919 --> 00:07:40,000
analyzing malware is like getting into

205
00:07:40,000 --> 00:07:41,440
the head

206
00:07:41,440 --> 00:07:43,280
of the author of this malware it's like

207
00:07:43,280 --> 00:07:46,080
reading a book you know for me it's like

208
00:07:46,080 --> 00:07:48,000
reading a book i think it's even better

209
00:07:48,000 --> 00:07:50,479
than mozart yeah most of people don't

210
00:07:50,479 --> 00:07:51,919
really like to

211
00:07:51,919 --> 00:07:54,240
reverse engineer assembly and sing all

212
00:07:54,240 --> 00:07:56,160
this mumbo jumbo stuff but

213
00:07:56,160 --> 00:07:59,759
for me it's actually an art

214
00:07:59,759 --> 00:08:03,759
so the levels of malware analysis

215
00:08:03,759 --> 00:08:06,160
so the basic level is you can

216
00:08:06,160 --> 00:08:08,000
basically take a malware sample if it's

217
00:08:08,000 --> 00:08:09,840
an executable file powershell script

218
00:08:09,840 --> 00:08:12,160
whatever you can throw it inside a

219
00:08:12,160 --> 00:08:14,080
sandbox which is basically a virtualized

220
00:08:14,080 --> 00:08:16,879
environment with all the necessary tools

221
00:08:16,879 --> 00:08:20,479
um to analyze the malware and basically

222
00:08:20,479 --> 00:08:22,960
you have things like any run or

223
00:08:22,960 --> 00:08:25,599
hybrid analysis which are basically

224
00:08:25,599 --> 00:08:27,759
you can take a file throw it into either

225
00:08:27,759 --> 00:08:30,000
the sandbox and it will give you

226
00:08:30,000 --> 00:08:32,240
uh like the overview of what the malware

227
00:08:32,240 --> 00:08:34,559
actually and how is executed and all the

228
00:08:34,559 --> 00:08:36,958
stuff of course if there is malware with

229
00:08:36,958 --> 00:08:38,479
anti-sandbox and other evasion

230
00:08:38,479 --> 00:08:40,479
techniques most likely it will not be

231
00:08:40,479 --> 00:08:42,399
executed on the sandbox so it's kind of

232
00:08:42,399 --> 00:08:44,159
limited but it can give you a good

233
00:08:44,159 --> 00:08:46,160
overview of what the malware does and

234
00:08:46,160 --> 00:08:48,800
also helping you to extract indicators

235
00:08:48,800 --> 00:08:51,120
of compromise

236
00:08:51,120 --> 00:08:53,279
the next level is called static analysis

237
00:08:53,279 --> 00:08:56,240
is basically taking a file uh extracting

238
00:08:56,240 --> 00:08:58,800
strings understand the

239
00:08:58,800 --> 00:09:01,440
the building blocks of the file

240
00:09:01,440 --> 00:09:04,000
before you actually execute it on your

241
00:09:04,000 --> 00:09:05,920
sandbox environment on your virtualized

242
00:09:05,920 --> 00:09:06,839
machine

243
00:09:06,839 --> 00:09:09,040
okay you have dynamic analysis which is

244
00:09:09,040 --> 00:09:11,040
basically to execute the malware on your

245
00:09:11,040 --> 00:09:13,440
virtual machine to see how it behaves

246
00:09:13,440 --> 00:09:16,000
use tools like procmon plus explorer api

247
00:09:16,000 --> 00:09:17,920
monitor understand what kind of

248
00:09:17,920 --> 00:09:20,000
windows api functions are executed and

249
00:09:20,000 --> 00:09:23,680
all this kind of stuff and of course the

250
00:09:23,680 --> 00:09:26,000
most amazing stuff that most people are

251
00:09:26,000 --> 00:09:27,440
i think frightened of is reverse

252
00:09:27,440 --> 00:09:31,120
engineering it's a god damn get get into

253
00:09:31,120 --> 00:09:33,839
the assembly code or whatever it is

254
00:09:33,839 --> 00:09:36,080
and understand how the malwares actually

255
00:09:36,080 --> 00:09:38,080
work so it's kind of interesting for

256
00:09:38,080 --> 00:09:40,800
example if your malware opens a socket

257
00:09:40,800 --> 00:09:42,800
and interacts with us with you know with

258
00:09:42,800 --> 00:09:45,040
an external server or c2

259
00:09:45,040 --> 00:09:46,959
how would actually do it

260
00:09:46,959 --> 00:09:48,800
okay what kind of windows api function

261
00:09:48,800 --> 00:09:51,279
uses how can i use it for detection

262
00:09:51,279 --> 00:09:52,720
engineering

263
00:09:52,720 --> 00:09:55,120
how can i re-implement it in my own

264
00:09:55,120 --> 00:09:58,000
malware my own ratings in my own attacks

265
00:09:58,000 --> 00:10:00,160
you know for example whenever you want

266
00:10:00,160 --> 00:10:02,800
to interact over http with some external

267
00:10:02,800 --> 00:10:04,880
server you can use

268
00:10:04,880 --> 00:10:07,279
various windows api functions you can

269
00:10:07,279 --> 00:10:10,000
use this socket you can use uh

270
00:10:10,000 --> 00:10:12,399
internet open url and you have all kind

271
00:10:12,399 --> 00:10:15,760
of ba and bunch of other api functions

272
00:10:15,760 --> 00:10:16,880
okay

273
00:10:16,880 --> 00:10:19,680
so this is only a small fraction a small

274
00:10:19,680 --> 00:10:21,680
example for you to understand

275
00:10:21,680 --> 00:10:23,120
what you can do

276
00:10:23,120 --> 00:10:25,760
with the power and knowledge of malware

277
00:10:25,760 --> 00:10:27,760
analysis

278
00:10:27,760 --> 00:10:28,480
so

279
00:10:28,480 --> 00:10:30,160
we talked about malware analysis blah

280
00:10:30,160 --> 00:10:32,079
blah blah what it is what's the level of

281
00:10:32,079 --> 00:10:33,680
this kind of stuff so first of all

282
00:10:33,680 --> 00:10:37,040
cheers another ship

283
00:10:38,320 --> 00:10:40,480
ah amazing

284
00:10:40,480 --> 00:10:41,600
so

285
00:10:41,600 --> 00:10:44,800
what is red tv you know

286
00:10:44,800 --> 00:10:46,800
you will you will ask someone

287
00:10:46,800 --> 00:10:48,959
and they'll say you oh it's the

288
00:10:48,959 --> 00:10:51,360
it's the knowledge of using or takes or

289
00:10:51,360 --> 00:10:54,640
or you the use of tools like metasploit

290
00:10:54,640 --> 00:10:56,480
and cobblestrike and do that and do this

291
00:10:56,480 --> 00:10:59,760
and but like what is the essence what is

292
00:10:59,760 --> 00:11:04,800
the goal of receiving like actually

293
00:11:04,800 --> 00:11:07,519
so first of all right is not about

294
00:11:07,519 --> 00:11:09,120
achieving a d a

295
00:11:09,120 --> 00:11:10,800
domain admin and you know what let me

296
00:11:10,800 --> 00:11:12,079
tell you another thing

297
00:11:12,079 --> 00:11:13,519
most of the attackers and most of the

298
00:11:13,519 --> 00:11:15,920
malware doesn't even care about getting

299
00:11:15,920 --> 00:11:18,240
a domain admin you know why

300
00:11:18,240 --> 00:11:22,000
because most of the networks today

301
00:11:22,320 --> 00:11:25,519
are very very hard to manage

302
00:11:25,519 --> 00:11:26,880
their permissions

303
00:11:26,880 --> 00:11:28,880
and their security it's very hard to be

304
00:11:28,880 --> 00:11:30,640
a blue team it's very hard to like

305
00:11:30,640 --> 00:11:32,640
literally implement security controls in

306
00:11:32,640 --> 00:11:34,000
the right way

307
00:11:34,000 --> 00:11:36,000
so even a ransomware today can encrypt

308
00:11:36,000 --> 00:11:38,959
your document files without having local

309
00:11:38,959 --> 00:11:41,040
admin or even a domain admin so what the

310
00:11:41,040 --> 00:11:43,839
hell it needs the domain army so most of

311
00:11:43,839 --> 00:11:45,920
times malware or attackers will go for

312
00:11:45,920 --> 00:11:47,440
domain admins

313
00:11:47,440 --> 00:11:49,600
if it's really necessary for them like

314
00:11:49,600 --> 00:11:52,399
to literally move between forests

315
00:11:52,399 --> 00:11:54,720
uh through other networks or just for

316
00:11:54,720 --> 00:11:56,880
the fun of it yeah

317
00:11:56,880 --> 00:11:59,680
so writing is about simulating real

318
00:11:59,680 --> 00:12:01,600
world threats now what the heck is a

319
00:12:01,600 --> 00:12:03,360
real world trade

320
00:12:03,360 --> 00:12:05,600
uh doesn't running kraken up exec with

321
00:12:05,600 --> 00:12:07,519
metasploit with all the cobalt strike

322
00:12:07,519 --> 00:12:10,959
mumbo jumbo stuff is actually ready

323
00:12:10,959 --> 00:12:12,000
um

324
00:12:12,000 --> 00:12:13,600
it's the tools it's not the essence of

325
00:12:13,600 --> 00:12:14,480
it

326
00:12:14,480 --> 00:12:15,680
so

327
00:12:15,680 --> 00:12:17,440
the purpose of reading is to provide a

328
00:12:17,440 --> 00:12:19,760
real-world picture of business related

329
00:12:19,760 --> 00:12:20,800
threats

330
00:12:20,800 --> 00:12:23,120
like for example if you're a pharmacy

331
00:12:23,120 --> 00:12:24,399
business

332
00:12:24,399 --> 00:12:26,880
maybe your adversary will not be conti

333
00:12:26,880 --> 00:12:29,519
or reveal

334
00:12:29,519 --> 00:12:30,800
it will be

335
00:12:30,800 --> 00:12:31,680
maybe

336
00:12:31,680 --> 00:12:34,399
another pharmacy company

337
00:12:34,399 --> 00:12:37,600
i don't know uh maybe another competitor

338
00:12:37,600 --> 00:12:38,880
maybe some

339
00:12:38,880 --> 00:12:41,519
insider threat i don't know

340
00:12:41,519 --> 00:12:43,600
and basically you need to define as a

341
00:12:43,600 --> 00:12:46,639
retimer what is an actual threat to your

342
00:12:46,639 --> 00:12:51,480
company that you're trying to red team

343
00:12:52,240 --> 00:12:54,560
purpose is to act like the adversary or

344
00:12:54,560 --> 00:12:55,760
the enemy

345
00:12:55,760 --> 00:12:58,160
based on accurate rate intelligence

346
00:12:58,160 --> 00:12:58,800
and

347
00:12:58,800 --> 00:13:01,200
of threat actors targeting your business

348
00:13:01,200 --> 00:13:03,200
so the use of threat intelligence will

349
00:13:03,200 --> 00:13:04,320
help you

350
00:13:04,320 --> 00:13:07,519
to become more aware of what kind of

351
00:13:07,519 --> 00:13:09,600
threat actors and ttps

352
00:13:09,600 --> 00:13:11,519
you actually need to simulate

353
00:13:11,519 --> 00:13:14,480
in order to give the real picture of the

354
00:13:14,480 --> 00:13:18,399
security posture of the company

355
00:13:18,399 --> 00:13:20,399
simulate potential threats actors ttps

356
00:13:20,399 --> 00:13:23,120
tactics techniques and procedures

357
00:13:23,120 --> 00:13:24,720
okay it's like

358
00:13:24,720 --> 00:13:27,120
understanding the tactics uh the

359
00:13:27,120 --> 00:13:29,040
techniques they're using maybe that the

360
00:13:29,040 --> 00:13:30,720
threat actors using mimikats to dump

361
00:13:30,720 --> 00:13:32,880
elsa's maybe they created their own

362
00:13:32,880 --> 00:13:34,560
version of mimikats with different api

363
00:13:34,560 --> 00:13:36,800
functions which most most of edrs

364
00:13:36,800 --> 00:13:37,920
doesn't really

365
00:13:37,920 --> 00:13:41,040
uh even detect them i don't know

366
00:13:41,040 --> 00:13:42,320
um

367
00:13:42,320 --> 00:13:43,920
and based on

368
00:13:43,920 --> 00:13:46,480
these data like the ttps you can

369
00:13:46,480 --> 00:13:47,519
actually go

370
00:13:47,519 --> 00:13:48,880
and do your stuff

371
00:13:48,880 --> 00:13:50,639
for example if you have three attractors

372
00:13:50,639 --> 00:13:52,160
like conti which they're basically a

373
00:13:52,160 --> 00:13:53,440
ransomware group

374
00:13:53,440 --> 00:13:55,279
i hate them of course

375
00:13:55,279 --> 00:13:57,360
they attack a couple of my clients also

376
00:13:57,360 --> 00:13:58,959
but you know

377
00:13:58,959 --> 00:14:01,440
the world is hard

378
00:14:01,440 --> 00:14:03,519
but if you understand that conte is

379
00:14:03,519 --> 00:14:05,040
actually targeting your business and you

380
00:14:05,040 --> 00:14:07,120
understand their ttps

381
00:14:07,120 --> 00:14:08,079
you can

382
00:14:08,079 --> 00:14:11,199
go and simulate the threats on the

383
00:14:11,199 --> 00:14:13,920
company you're attacking of course in a

384
00:14:13,920 --> 00:14:16,720
secure manner so always take opsec into

385
00:14:16,720 --> 00:14:20,800
your mind when you're doing retin

386
00:14:21,760 --> 00:14:24,160
and eventually the

387
00:14:24,160 --> 00:14:26,480
real goal of red teams is not to go to

388
00:14:26,480 --> 00:14:28,320
blue team and say

389
00:14:28,320 --> 00:14:29,199
yeah

390
00:14:29,199 --> 00:14:32,320
you're you're you've failed or

391
00:14:32,320 --> 00:14:36,000
uh be childish i i i win you and and i

392
00:14:36,000 --> 00:14:37,760
overcome you and all this kind of

393
00:14:37,760 --> 00:14:39,040
 you know

394
00:14:39,040 --> 00:14:41,839
the real purpose of writing is to help

395
00:14:41,839 --> 00:14:44,959
organizations become better that's it

396
00:14:44,959 --> 00:14:47,120
and of course helping the blue team

397
00:14:47,120 --> 00:14:48,399
become better

398
00:14:48,399 --> 00:14:50,399
so if you're as a red team understand

399
00:14:50,399 --> 00:14:51,760
the craft

400
00:14:51,760 --> 00:14:53,279
the techniques the tools that the blue

401
00:14:53,279 --> 00:14:54,480
team uses

402
00:14:54,480 --> 00:14:56,480
and also if the blue team understand how

403
00:14:56,480 --> 00:14:58,880
the red team is operate

404
00:14:58,880 --> 00:15:02,639
they can basically help each other

405
00:15:03,920 --> 00:15:04,800
so

406
00:15:04,800 --> 00:15:06,160
retimer

407
00:15:06,160 --> 00:15:08,399
must have an adversarial mindset this is

408
00:15:08,399 --> 00:15:10,800
for sure you cannot be a red teamer if

409
00:15:10,800 --> 00:15:12,560
you don't know how to think look like

410
00:15:12,560 --> 00:15:15,040
your enemy like a criminal

411
00:15:15,040 --> 00:15:18,560
okay like a bad guy

412
00:15:18,800 --> 00:15:21,600
but mama always said like

413
00:15:21,600 --> 00:15:23,199
told us to stay away from bad guys you

414
00:15:23,199 --> 00:15:24,320
know

415
00:15:24,320 --> 00:15:27,920
oh so sweet mommy

416
00:15:30,720 --> 00:15:32,079
i like my mom

417
00:15:32,079 --> 00:15:32,880
and

418
00:15:32,880 --> 00:15:35,759
she has amazing tips for life and she's

419
00:15:35,759 --> 00:15:37,360
even right

420
00:15:37,360 --> 00:15:40,560
uh but not in the case of wretting

421
00:15:40,560 --> 00:15:42,320
you actually need to think like your

422
00:15:42,320 --> 00:15:45,440
enemy and it's kind of hard um

423
00:15:45,440 --> 00:15:47,440
like psychologically not only

424
00:15:47,440 --> 00:15:49,199
technically

425
00:15:49,199 --> 00:15:50,079
so

426
00:15:50,079 --> 00:15:53,120
uh to know your enemy you must become

427
00:15:53,120 --> 00:15:55,360
your enemy i know it's kind of uh hard

428
00:15:55,360 --> 00:15:56,800
to do it but

429
00:15:56,800 --> 00:15:59,600
uh if your skills of mimicking others

430
00:15:59,600 --> 00:16:01,440
and and to be like uh

431
00:16:01,440 --> 00:16:01,690
uh

432
00:16:01,690 --> 00:16:02,800
[Music]

433
00:16:02,800 --> 00:16:04,000
to

434
00:16:04,000 --> 00:16:05,839
mimic others basically and to understand

435
00:16:05,839 --> 00:16:09,040
their psychology it will be much easier

436
00:16:09,040 --> 00:16:11,839
for you to do this

437
00:16:13,279 --> 00:16:18,000
now behold the real power of retiming

438
00:16:18,160 --> 00:16:21,639
cobalt's right

439
00:16:22,480 --> 00:16:23,680
no no

440
00:16:23,680 --> 00:16:25,519
no don't take it seriously like

441
00:16:25,519 --> 00:16:27,360
cobblestrike

442
00:16:27,360 --> 00:16:29,680
hollow track is an amazing tool you know

443
00:16:29,680 --> 00:16:32,079
it's amazing too it has a gui it has a

444
00:16:32,079 --> 00:16:33,440
lot of features

445
00:16:33,440 --> 00:16:36,240
bypass evasion modules it does amazing

446
00:16:36,240 --> 00:16:38,160
job okay so

447
00:16:38,160 --> 00:16:39,279
uh

448
00:16:39,279 --> 00:16:41,839
take it in the right perspective but

449
00:16:41,839 --> 00:16:43,279
mostly when you talk to retirees they

450
00:16:43,279 --> 00:16:45,680
are about the tools like writing cobalt

451
00:16:45,680 --> 00:16:47,600
strike my man

452
00:16:47,600 --> 00:16:49,279
you're not ready without cobble strike

453
00:16:49,279 --> 00:16:51,600
you need to have cobras right

454
00:16:51,600 --> 00:16:52,959
i don't agree

455
00:16:52,959 --> 00:16:54,959
i don't agree it's just one of the best

456
00:16:54,959 --> 00:16:57,040
tools out there i think but

457
00:16:57,040 --> 00:16:59,440
it's not what actually defines

458
00:16:59,440 --> 00:17:01,920
a retimer

459
00:17:01,920 --> 00:17:05,839
so why not doing things like this

460
00:17:06,640 --> 00:17:07,919
now

461
00:17:07,919 --> 00:17:09,839
in the left you have cobalt's right in

462
00:17:09,839 --> 00:17:13,119
the right you have either pro

463
00:17:13,119 --> 00:17:15,280
personally i like to smoke when i

464
00:17:15,280 --> 00:17:17,039
doing reversing

465
00:17:17,039 --> 00:17:18,880
kind of cool and you know opens your

466
00:17:18,880 --> 00:17:19,510
mind

467
00:17:19,510 --> 00:17:22,589
[Music]

468
00:17:22,880 --> 00:17:25,760
what for me represents the right picture

469
00:17:25,760 --> 00:17:27,679
like ida

470
00:17:27,679 --> 00:17:28,880
is like

471
00:17:28,880 --> 00:17:30,000
go

472
00:17:30,000 --> 00:17:32,640
and understand your own tools go and

473
00:17:32,640 --> 00:17:34,400
understand your own techniques go and

474
00:17:34,400 --> 00:17:36,480
understand other adversaries techniques

475
00:17:36,480 --> 00:17:38,000
and tools and malware

476
00:17:38,000 --> 00:17:38,720
go

477
00:17:38,720 --> 00:17:41,520
and research stuff like

478
00:17:41,520 --> 00:17:44,559
someone asked me like uh five years ago

479
00:17:44,559 --> 00:17:46,080
you know what it's mimi cats and they're

480
00:17:46,080 --> 00:17:46,880
like

481
00:17:46,880 --> 00:17:47,760
uh

482
00:17:47,760 --> 00:17:48,720
i

483
00:17:48,720 --> 00:17:51,120
think so many cats this dumb tool blah

484
00:17:51,120 --> 00:17:52,960
blah and it's like what this and that

485
00:17:52,960 --> 00:17:55,120
comment does and it's like

486
00:17:55,120 --> 00:17:57,919
whatever dumps the elsa's memory okay

487
00:17:57,919 --> 00:17:59,440
it's like yeah

488
00:17:59,440 --> 00:18:01,440
and i asked him you know what

489
00:18:01,440 --> 00:18:03,360
how do you actually understand how it

490
00:18:03,360 --> 00:18:05,039
works you know when you're asking

491
00:18:05,039 --> 00:18:05,919
someone

492
00:18:05,919 --> 00:18:07,840
what is something

493
00:18:07,840 --> 00:18:09,919
do you know about something

494
00:18:09,919 --> 00:18:12,320
so what is the actual level of

495
00:18:12,320 --> 00:18:14,400
understanding of this question

496
00:18:14,400 --> 00:18:15,120
like

497
00:18:15,120 --> 00:18:16,799
for example mimikatz

498
00:18:16,799 --> 00:18:18,640
what is the level of understanding of

499
00:18:18,640 --> 00:18:19,760
this tool

500
00:18:19,760 --> 00:18:22,320
how do you actually know how it operates

501
00:18:22,320 --> 00:18:24,320
how it acts what kind of functions it

502
00:18:24,320 --> 00:18:26,720
uses in what languages it was written

503
00:18:26,720 --> 00:18:28,720
and compiled

504
00:18:28,720 --> 00:18:30,000
do you

505
00:18:30,000 --> 00:18:33,200
or just go grab the tools execute them

506
00:18:33,200 --> 00:18:34,640
and you're ready

507
00:18:34,640 --> 00:18:35,760
which

508
00:18:35,760 --> 00:18:38,880
to be honest most of the time

509
00:18:38,880 --> 00:18:40,880
it's working it's like

510
00:18:40,880 --> 00:18:42,799
not maybe mimics but other tools you

511
00:18:42,799 --> 00:18:46,640
know but in order for you to become

512
00:18:46,640 --> 00:18:48,960
a better returner or a stronger security

513
00:18:48,960 --> 00:18:50,320
professional

514
00:18:50,320 --> 00:18:52,160
go and try to understand how this tool

515
00:18:52,160 --> 00:18:55,840
operate like go do some wireshark

516
00:18:55,840 --> 00:18:58,000
like understand how the network packets

517
00:18:58,000 --> 00:18:59,280
are going on

518
00:18:59,280 --> 00:19:01,039
like understand how the tool you are

519
00:19:01,039 --> 00:19:03,520
using for example mimikats to dump lsas

520
00:19:03,520 --> 00:19:05,679
what's actually doing like opening a

521
00:19:05,679 --> 00:19:06,960
handle

522
00:19:06,960 --> 00:19:10,080
to the else's process enumerating

523
00:19:10,080 --> 00:19:12,400
the pids of the processes

524
00:19:12,400 --> 00:19:14,320
receiving it handled with open with the

525
00:19:14,320 --> 00:19:17,440
open process windows api function

526
00:19:17,440 --> 00:19:20,080
use use of the mini dump function to

527
00:19:20,080 --> 00:19:21,280
actually dump

528
00:19:21,280 --> 00:19:23,039
the lcs

529
00:19:23,039 --> 00:19:25,840
and after you actually understand this

530
00:19:25,840 --> 00:19:28,799
functionality you can think maybe

531
00:19:28,799 --> 00:19:30,960
maybe there's other functions or windows

532
00:19:30,960 --> 00:19:32,880
api functions that i can use

533
00:19:32,880 --> 00:19:34,880
which most likely most cdrs and

534
00:19:34,880 --> 00:19:37,440
antivirus will not detect it

535
00:19:37,440 --> 00:19:39,919
so it will open up for you a greater

536
00:19:39,919 --> 00:19:42,160
world

537
00:19:43,440 --> 00:19:45,440
now don't get me wrong

538
00:19:45,440 --> 00:19:46,960
both malware analysis and red teaming

539
00:19:46,960 --> 00:19:49,360
are not about the tools one is using

540
00:19:49,360 --> 00:19:50,640
but the ability to research and

541
00:19:50,640 --> 00:19:52,640
understand technical and abstract

542
00:19:52,640 --> 00:19:54,880
concepts

543
00:19:54,880 --> 00:19:57,440
eventually

544
00:19:57,679 --> 00:19:59,520
so i think you kind of understand why

545
00:19:59,520 --> 00:20:04,480
malwanas need to concern returners okay

546
00:20:04,840 --> 00:20:07,600
but one of the reasons is because the

547
00:20:07,600 --> 00:20:09,360
bad guys do

548
00:20:09,360 --> 00:20:11,039
they go

549
00:20:11,039 --> 00:20:12,880
and learn from each other's malware from

550
00:20:12,880 --> 00:20:14,240
each other tools from each other

551
00:20:14,240 --> 00:20:15,520
techniques

552
00:20:15,520 --> 00:20:18,320
and they actually go and re-implement

553
00:20:18,320 --> 00:20:21,120
the same techniques the same tools or

554
00:20:21,120 --> 00:20:23,840
the same concept basically in their own

555
00:20:23,840 --> 00:20:25,919
malware for example if you heard about

556
00:20:25,919 --> 00:20:28,400
the log b3 ransomware also did a video

557
00:20:28,400 --> 00:20:30,400
about them

558
00:20:30,400 --> 00:20:32,400
they literally got

559
00:20:32,400 --> 00:20:34,720
the code from dark side ransomware

560
00:20:34,720 --> 00:20:36,880
copied some snippets from it for the

561
00:20:36,880 --> 00:20:39,200
decryption runtime decryption mechanisms

562
00:20:39,200 --> 00:20:41,520
and for dynamic api resolve which will

563
00:20:41,520 --> 00:20:43,600
talk about it and then literally copy

564
00:20:43,600 --> 00:20:44,799
and paste it

565
00:20:44,799 --> 00:20:46,799
the same technique the same concept in

566
00:20:46,799 --> 00:20:48,799
their own malware it's like what the

567
00:20:48,799 --> 00:20:51,200
hell i'm i'm like researching the lobby

568
00:20:51,200 --> 00:20:53,200
transformer and it's like

569
00:20:53,200 --> 00:20:54,559
50

570
00:20:54,559 --> 00:20:55,760
uh

571
00:20:55,760 --> 00:20:57,679
like minimum 50

572
00:20:57,679 --> 00:21:01,360
uh the code of dark side

573
00:21:01,360 --> 00:21:04,480
so if the bad guys go and learn from

574
00:21:04,480 --> 00:21:06,400
other malware and other tools

575
00:21:06,400 --> 00:21:10,159
why not the returners the good guys

576
00:21:12,159 --> 00:21:14,159
so threat actors evolve by learning and

577
00:21:14,159 --> 00:21:16,320
leveraging the craft and ttps by

578
00:21:16,320 --> 00:21:18,480
researching malware samples in the wild

579
00:21:18,480 --> 00:21:21,039
it is one of their secrets

580
00:21:21,039 --> 00:21:22,080
but

581
00:21:22,080 --> 00:21:24,480
not anymore i hope this talk will

582
00:21:24,480 --> 00:21:26,320
actually open your mind and give you the

583
00:21:26,320 --> 00:21:27,919
necessary tools

584
00:21:27,919 --> 00:21:30,720
and necessary mindset to become a better

585
00:21:30,720 --> 00:21:33,760
security professional

586
00:21:34,640 --> 00:21:37,360
so let's talk about uh quickly about the

587
00:21:37,360 --> 00:21:39,039
malware development lifecycle like the

588
00:21:39,039 --> 00:21:41,520
mdlc i call it it's like sdlc for

589
00:21:41,520 --> 00:21:43,360
software development lifecycle but for

590
00:21:43,360 --> 00:21:46,720
malware which is kind of the same

591
00:21:46,720 --> 00:21:49,039
so you have malware development

592
00:21:49,039 --> 00:21:50,960
you develop your malware you know the

593
00:21:50,960 --> 00:21:53,360
malware need to check in which kind of

594
00:21:53,360 --> 00:21:55,200
environment it actually resides whether

595
00:21:55,200 --> 00:21:57,840
it's linux windows what kind of version

596
00:21:57,840 --> 00:22:00,080
what is the mac address the ip address

597
00:22:00,080 --> 00:22:02,240
what's so called information gathering

598
00:22:02,240 --> 00:22:04,799
or situational awareness so the malware

599
00:22:04,799 --> 00:22:08,159
need to be aware of where is actually it

600
00:22:08,159 --> 00:22:10,000
and then based on this information which

601
00:22:10,000 --> 00:22:12,559
most likely be sent to an external c2

602
00:22:12,559 --> 00:22:13,679
server

603
00:22:13,679 --> 00:22:14,799
the malware will receive the

604
00:22:14,799 --> 00:22:17,520
configuration or the next stage of

605
00:22:17,520 --> 00:22:20,159
execution

606
00:22:20,159 --> 00:22:21,039
so

607
00:22:21,039 --> 00:22:22,880
part of our development like any other

608
00:22:22,880 --> 00:22:24,400
software development

609
00:22:24,400 --> 00:22:27,520
is to test and do qa like

610
00:22:27,520 --> 00:22:29,520
go and develop your malware in a secure

611
00:22:29,520 --> 00:22:32,640
manner of course for good purposes

612
00:22:32,640 --> 00:22:35,200
uh and not for bad purposes don't be a

613
00:22:35,200 --> 00:22:38,880
black hat be a white hat you know

614
00:22:38,880 --> 00:22:40,400
it's kind of cool because for example if

615
00:22:40,400 --> 00:22:42,880
you want to learn c and assembly

616
00:22:42,880 --> 00:22:44,240
and doing this

617
00:22:44,240 --> 00:22:46,880
via developing malware it's much cooler

618
00:22:46,880 --> 00:22:48,720
than developing

619
00:22:48,720 --> 00:22:49,520
uh

620
00:22:49,520 --> 00:22:52,320
the checkmate or snake game this this my

621
00:22:52,320 --> 00:22:55,039
my opinion okay

622
00:22:55,039 --> 00:22:56,640
then you want to implement some malware

623
00:22:56,640 --> 00:22:59,360
defense bypass techniques inside your

624
00:22:59,360 --> 00:23:00,640
malware

625
00:23:00,640 --> 00:23:02,080
like

626
00:23:02,080 --> 00:23:04,400
most likely if your malware will drop in

627
00:23:04,400 --> 00:23:05,919
one of the computers or networks that

628
00:23:05,919 --> 00:23:07,600
you're targeting there will be some

629
00:23:07,600 --> 00:23:09,200
endpoint protections that you want to

630
00:23:09,200 --> 00:23:12,559
buy this like dlp edrs antivirus stuff

631
00:23:12,559 --> 00:23:14,640
like this

632
00:23:14,640 --> 00:23:16,400
then you want to actually do some

633
00:23:16,400 --> 00:23:18,559
offline av and edr testing before

634
00:23:18,559 --> 00:23:21,360
actually distributing the malware

635
00:23:21,360 --> 00:23:22,960
and then it's one of the things that i

636
00:23:22,960 --> 00:23:24,559
want to talk about today

637
00:23:24,559 --> 00:23:27,919
is ioc collection and removal like

638
00:23:27,919 --> 00:23:30,960
it's it's fine that you actually develop

639
00:23:30,960 --> 00:23:33,200
your own malware you use c or python or

640
00:23:33,200 --> 00:23:35,679
partial whatever language that you want

641
00:23:35,679 --> 00:23:36,400
but

642
00:23:36,400 --> 00:23:38,880
after you compile your malware

643
00:23:38,880 --> 00:23:40,720
like with visual studio

644
00:23:40,720 --> 00:23:41,919
or with c

645
00:23:41,919 --> 00:23:43,679
or with you know gcc or whatever

646
00:23:43,679 --> 00:23:46,080
compiler is out there

647
00:23:46,080 --> 00:23:49,360
how the file is actually look like for

648
00:23:49,360 --> 00:23:51,919
the edr for the antivirus for the

649
00:23:51,919 --> 00:23:55,600
malware analyst for the researcher

650
00:23:55,760 --> 00:23:57,679
does the strings that you actually used

651
00:23:57,679 --> 00:24:00,559
or the variable names or the function

652
00:24:00,559 --> 00:24:02,880
names or any other ip addresses that you

653
00:24:02,880 --> 00:24:05,360
used in your own malware

654
00:24:05,360 --> 00:24:07,679
they actually presented in your malware

655
00:24:07,679 --> 00:24:09,200
like in a

656
00:24:09,200 --> 00:24:12,880
clear text you need to obfuscate them

657
00:24:12,880 --> 00:24:15,039
maybe one compiler

658
00:24:15,039 --> 00:24:17,679
compiled it in a one way and another

659
00:24:17,679 --> 00:24:18,960
compiler

660
00:24:18,960 --> 00:24:20,240
compiler

661
00:24:20,240 --> 00:24:22,960
compiled your malware in a different way

662
00:24:22,960 --> 00:24:25,440
which will be much harder for malware

663
00:24:25,440 --> 00:24:28,720
analysts and edrs to detect

664
00:24:28,720 --> 00:24:30,880
so if you compile for example c written

665
00:24:30,880 --> 00:24:32,799
malware in

666
00:24:32,799 --> 00:24:34,320
visual studio

667
00:24:34,320 --> 00:24:36,000
it will be basically a different output

668
00:24:36,000 --> 00:24:37,919
if you

669
00:24:37,919 --> 00:24:39,840
compile it

670
00:24:39,840 --> 00:24:44,159
in for example gcc compiler okay

671
00:24:44,159 --> 00:24:44,960
so

672
00:24:44,960 --> 00:24:46,960
it's basically a research topic for you

673
00:24:46,960 --> 00:24:48,320
if you want to kind of

674
00:24:48,320 --> 00:24:51,120
test write a malware try to actually

675
00:24:51,120 --> 00:24:52,720
compile it with different compilers and

676
00:24:52,720 --> 00:24:55,600
see the difference do some diffs uh

677
00:24:55,600 --> 00:24:58,640
strings up code differentiation uh see

678
00:24:58,640 --> 00:25:01,200
how it actually the compiled versions

679
00:25:01,200 --> 00:25:03,120
are differs from each other

680
00:25:03,120 --> 00:25:04,640
okay

681
00:25:04,640 --> 00:25:06,080
and then for example

682
00:25:06,080 --> 00:25:09,360
if you have some malicious or suspicious

683
00:25:09,360 --> 00:25:12,559
ioc presented in your compiled malware

684
00:25:12,559 --> 00:25:15,360
you want to kind of like somehow remove

685
00:25:15,360 --> 00:25:19,439
it obfuscate and prep it or whatever

686
00:25:19,679 --> 00:25:21,600
and of course uh

687
00:25:21,600 --> 00:25:25,120
as a white white attacker or whatever

688
00:25:25,120 --> 00:25:28,000
you want to use the same uh like

689
00:25:28,000 --> 00:25:31,600
techniques and iocs used there and like

690
00:25:31,600 --> 00:25:32,799
work together with the threat

691
00:25:32,799 --> 00:25:34,000
intelligence

692
00:25:34,000 --> 00:25:37,360
and like try to understand uh how they

693
00:25:37,360 --> 00:25:39,520
are actually relevant to other malware

694
00:25:39,520 --> 00:25:43,840
in the wild for other trade groups

695
00:25:44,640 --> 00:25:46,080
basically you do not have to develop

696
00:25:46,080 --> 00:25:48,240
your malware from zero

697
00:25:48,240 --> 00:25:49,679
and this is one of the things that

698
00:25:49,679 --> 00:25:52,400
basically i want to say here

699
00:25:52,400 --> 00:25:53,919
you can learn from real world malware

700
00:25:53,919 --> 00:25:56,400
samples and incidents for example you

701
00:25:56,400 --> 00:25:58,000
can go for

702
00:25:58,000 --> 00:25:59,840
the colonial pipeline incident if you

703
00:25:59,840 --> 00:26:01,120
remember

704
00:26:01,120 --> 00:26:03,360
the same incident that actually broke

705
00:26:03,360 --> 00:26:04,320
half of

706
00:26:04,320 --> 00:26:06,400
the gas stations

707
00:26:06,400 --> 00:26:08,720
in the united states it was actually the

708
00:26:08,720 --> 00:26:12,000
dark side run somewhere like a small

709
00:26:12,000 --> 00:26:15,120
a piece of executable

710
00:26:15,120 --> 00:26:18,000
disturbed and and crashed half of the

711
00:26:18,000 --> 00:26:19,760
gas stations in the united states

712
00:26:19,760 --> 00:26:22,720
something like this not really exactly

713
00:26:22,720 --> 00:26:25,840
on the numbers but something like this

714
00:26:25,840 --> 00:26:28,320
so what one executable file one

715
00:26:28,320 --> 00:26:31,039
ransomware can do to your state not only

716
00:26:31,039 --> 00:26:32,640
for a company

717
00:26:32,640 --> 00:26:33,919
think about it

718
00:26:33,919 --> 00:26:35,840
and how much can be learned

719
00:26:35,840 --> 00:26:38,640
from the this runs away

720
00:26:38,640 --> 00:26:40,880
and i also want to dive with you into

721
00:26:40,880 --> 00:26:42,720
this ransomware like i don't have all

722
00:26:42,720 --> 00:26:43,919
the time in the world but we'll do

723
00:26:43,919 --> 00:26:47,120
something simple there

724
00:26:47,600 --> 00:26:49,039
so

725
00:26:49,039 --> 00:26:52,240
let's talk about darkseid ransomware

726
00:26:52,240 --> 00:26:54,400
runtime code decryption and dynamic api

727
00:26:54,400 --> 00:26:56,159
result now

728
00:26:56,159 --> 00:26:58,320
don't get creepy on me please it it's

729
00:26:58,320 --> 00:27:00,640
going to be kind of a deep technical

730
00:27:00,640 --> 00:27:04,000
stuff like assembly stuff um i'll try to

731
00:27:04,000 --> 00:27:05,600
explain it in a

732
00:27:05,600 --> 00:27:09,039
like in a simple fashion

733
00:27:09,039 --> 00:27:12,879
and let's begin so let me just

734
00:27:14,720 --> 00:27:18,159
start my virtual machine here

735
00:27:19,120 --> 00:27:22,240
so what do we have here

736
00:27:22,240 --> 00:27:24,080
we just do

737
00:27:24,080 --> 00:27:27,360
okay can you see something here like

738
00:27:27,360 --> 00:27:29,679
like this maybe

739
00:27:29,679 --> 00:27:30,960
yeah

740
00:27:30,960 --> 00:27:32,799
so

741
00:27:32,799 --> 00:27:34,720
we have the dark side sample yeah yeah

742
00:27:34,720 --> 00:27:36,799
the same the same

743
00:27:36,799 --> 00:27:38,880
malware that disturbed half of the

744
00:27:38,880 --> 00:27:41,600
united states

745
00:27:41,600 --> 00:27:43,039
gas stations

746
00:27:43,039 --> 00:27:43,760
so

747
00:27:43,760 --> 00:27:46,000
if i open this file inside pe bearer for

748
00:27:46,000 --> 00:27:48,720
example i want to see the sections and

749
00:27:48,720 --> 00:27:51,200
imports like the actual

750
00:27:51,200 --> 00:27:53,600
sections you have in the executable

751
00:27:53,600 --> 00:27:56,000
files and the imported functions

752
00:27:56,000 --> 00:27:57,279
now

753
00:27:57,279 --> 00:27:58,000
i

754
00:27:58,000 --> 00:27:59,520
just remember

755
00:27:59,520 --> 00:28:01,760
uh analyzing malware is like reading a

756
00:28:01,760 --> 00:28:02,720
book

757
00:28:02,720 --> 00:28:04,880
and each one each book has its own

758
00:28:04,880 --> 00:28:07,919
sections like you know it has a title

759
00:28:07,919 --> 00:28:11,440
it has the data in the title and so on

760
00:28:11,440 --> 00:28:13,039
so

761
00:28:13,039 --> 00:28:15,440
you can see here we have two text

762
00:28:15,440 --> 00:28:16,559
sections

763
00:28:16,559 --> 00:28:20,640
now most of normal files will have one

764
00:28:20,640 --> 00:28:22,320
text section

765
00:28:22,320 --> 00:28:24,960
the text section actually contains

766
00:28:24,960 --> 00:28:26,720
the

767
00:28:26,720 --> 00:28:29,520
execution code like the machine code the

768
00:28:29,520 --> 00:28:31,440
assembly code that is need to be

769
00:28:31,440 --> 00:28:33,520
actually executed on your cpu on your

770
00:28:33,520 --> 00:28:35,520
operating system and then you have

771
00:28:35,520 --> 00:28:37,279
another

772
00:28:37,279 --> 00:28:39,520
section called text one you know kind of

773
00:28:39,520 --> 00:28:40,640
weird

774
00:28:40,640 --> 00:28:41,360
now

775
00:28:41,360 --> 00:28:43,919
in most files even most malware if you

776
00:28:43,919 --> 00:28:45,840
go to the imports

777
00:28:45,840 --> 00:28:47,039
you will see

778
00:28:47,039 --> 00:28:48,000
much

779
00:28:48,000 --> 00:28:50,559
larger dll entries

780
00:28:50,559 --> 00:28:52,640
and for each dls you see

781
00:28:52,640 --> 00:28:55,440
at least five to ten

782
00:28:55,440 --> 00:28:58,799
imported functions

783
00:28:58,799 --> 00:29:01,279
you can see where i'm going you have

784
00:29:01,279 --> 00:29:04,559
only one dll kernel 32dl one of the most

785
00:29:04,559 --> 00:29:08,080
basic and mostly used dlls in windows

786
00:29:08,080 --> 00:29:09,679
and they have only one function called

787
00:29:09,679 --> 00:29:12,480
exit process like what the hell like a

788
00:29:12,480 --> 00:29:14,960
normal malware or normal file will uh

789
00:29:14,960 --> 00:29:18,799
will include more dlls like socket and

790
00:29:18,799 --> 00:29:21,600
you know create file great process you

791
00:29:21,600 --> 00:29:23,679
know like basic stuff and here you have

792
00:29:23,679 --> 00:29:27,840
only one function what the hell

793
00:29:28,320 --> 00:29:30,240
so

794
00:29:30,240 --> 00:29:31,679
if you open up the

795
00:29:31,679 --> 00:29:33,440
if you open up the malware inside ida

796
00:29:33,440 --> 00:29:36,080
pro and go again to import you'll see

797
00:29:36,080 --> 00:29:39,679
exit process also only present here

798
00:29:39,679 --> 00:29:41,919
and basically this is the starting point

799
00:29:41,919 --> 00:29:44,799
from where the malware actually begins

800
00:29:44,799 --> 00:29:46,480
now this is not the actual function

801
00:29:46,480 --> 00:29:48,799
names okay so this is the function names

802
00:29:48,799 --> 00:29:52,000
that i call okay so each call here in

803
00:29:52,000 --> 00:29:53,440
assembly is basically calling to a

804
00:29:53,440 --> 00:29:55,520
function so for example you define the

805
00:29:55,520 --> 00:29:58,159
function in c like for example void blah

806
00:29:58,159 --> 00:30:00,880
blah and it has two parameters

807
00:30:00,880 --> 00:30:03,279
so this what we have so you have here

808
00:30:03,279 --> 00:30:04,720
basically two parameters which are

809
00:30:04,720 --> 00:30:06,880
basically encrypted blob

810
00:30:06,880 --> 00:30:08,399
you know basically an encrypted mumbo

811
00:30:08,399 --> 00:30:10,640
jumbo stuff here

812
00:30:10,640 --> 00:30:12,960
and this called mumbo jumbo stuff will

813
00:30:12,960 --> 00:30:14,320
do something

814
00:30:14,320 --> 00:30:16,720
then do another something and eventually

815
00:30:16,720 --> 00:30:18,640
go and decrypt

816
00:30:18,640 --> 00:30:21,039
those encrypted blobs

817
00:30:21,039 --> 00:30:23,520
now if i'll do space here i'll see that

818
00:30:23,520 --> 00:30:25,520
the actual code here is under the text

819
00:30:25,520 --> 00:30:27,840
one section that we saw

820
00:30:27,840 --> 00:30:30,399
which is not very normal

821
00:30:30,399 --> 00:30:34,080
and eventually if i go here to like

822
00:30:34,080 --> 00:30:35,760
for this call where show begins

823
00:30:35,760 --> 00:30:37,360
where it's actually where the run source

824
00:30:37,360 --> 00:30:40,880
start to encrypt your computer

825
00:30:40,880 --> 00:30:44,080
if you go here it's like gibberish

826
00:30:44,080 --> 00:30:45,200
nothing

827
00:30:45,200 --> 00:30:47,760
what the hell

828
00:30:47,760 --> 00:30:48,720
so

829
00:30:48,720 --> 00:30:50,880
if i double click you can see here we

830
00:30:50,880 --> 00:30:52,960
have the text section

831
00:30:52,960 --> 00:30:53,760
so

832
00:30:53,760 --> 00:30:56,640
it's kind of occurs to me that

833
00:30:56,640 --> 00:30:59,760
the decrypted blob will be

834
00:30:59,760 --> 00:31:01,519
uh placed

835
00:31:01,519 --> 00:31:04,159
in the actual text section so this mumbo

836
00:31:04,159 --> 00:31:06,799
jumbo stuff will be eventually decrypted

837
00:31:06,799 --> 00:31:09,679
and be an actual code to analyze so we

838
00:31:09,679 --> 00:31:12,559
have uh basically we have to execute the

839
00:31:12,559 --> 00:31:15,279
ransomware on my virtual machine uh so

840
00:31:15,279 --> 00:31:17,840
be careful with it

841
00:31:17,840 --> 00:31:19,600
let's begin so

842
00:31:19,600 --> 00:31:20,799
basically

843
00:31:20,799 --> 00:31:24,879
i'll go and put a breakpoint here

844
00:31:26,240 --> 00:31:29,760
and start the local windows

845
00:31:30,840 --> 00:31:32,960
debugger whoa

846
00:31:32,960 --> 00:31:35,919
okay so now it got to the breakpoint

847
00:31:35,919 --> 00:31:40,080
so now the actual code is here so we did

848
00:31:40,080 --> 00:31:42,320
whatever stuff it does here

849
00:31:42,320 --> 00:31:43,600
then we do

850
00:31:43,600 --> 00:31:46,480
f8 to actually execute the function now

851
00:31:46,480 --> 00:31:48,399
just for understand what kind of

852
00:31:48,399 --> 00:31:50,720
decryption it uses here if you go double

853
00:31:50,720 --> 00:31:51,840
click

854
00:31:51,840 --> 00:31:53,360
on this function

855
00:31:53,360 --> 00:31:55,919
it calls this this function which i call

856
00:31:55,919 --> 00:31:58,480
decryption festival

857
00:31:58,480 --> 00:32:01,039
which actually go and

858
00:32:01,039 --> 00:32:04,080
call another function

859
00:32:04,720 --> 00:32:07,760
and eventually duke soar

860
00:32:07,760 --> 00:32:10,159
blah blah so it will basically

861
00:32:10,159 --> 00:32:13,760
store the values and in that way decrypt

862
00:32:13,760 --> 00:32:16,480
the content

863
00:32:17,760 --> 00:32:20,559
okay so let's do f8

864
00:32:20,559 --> 00:32:23,760
i hate this computer

865
00:32:23,840 --> 00:32:27,360
okay and another f8

866
00:32:27,360 --> 00:32:28,880
and now

867
00:32:28,880 --> 00:32:30,559
we'll need to see something like

868
00:32:30,559 --> 00:32:32,080
different here

869
00:32:32,080 --> 00:32:33,039
so

870
00:32:33,039 --> 00:32:36,080
before i actually go inside this code

871
00:32:36,080 --> 00:32:39,760
let me just undefine it in ida and

872
00:32:39,760 --> 00:32:42,799
reanalyze it again because for either

873
00:32:42,799 --> 00:32:45,440
kind it's kind of like uh

874
00:32:45,440 --> 00:32:48,320
hard to understand what is going on then

875
00:32:48,320 --> 00:32:50,240
so if i

876
00:32:50,240 --> 00:32:53,279
select here the code

877
00:32:53,279 --> 00:32:56,600
like this

878
00:32:56,799 --> 00:32:59,039
i go and do

879
00:32:59,039 --> 00:33:03,760
uh like analyze selected area or c

880
00:33:04,399 --> 00:33:06,000
analyze

881
00:33:06,000 --> 00:33:07,919
and i'll hope it will give something

882
00:33:07,919 --> 00:33:10,919
sensible

883
00:33:15,840 --> 00:33:17,919
okay

884
00:33:17,919 --> 00:33:19,760
here we have some things here

885
00:33:19,760 --> 00:33:24,320
let's do here c worship begins

886
00:33:24,320 --> 00:33:25,600
amazing

887
00:33:25,600 --> 00:33:27,120
do another c

888
00:33:27,120 --> 00:33:29,279
we kind of need to help either to

889
00:33:29,279 --> 00:33:31,279
reanalyze the code basically

890
00:33:31,279 --> 00:33:32,559
so now

891
00:33:32,559 --> 00:33:35,279
i'll go in f7 which is basically go into

892
00:33:35,279 --> 00:33:36,880
the function

893
00:33:36,880 --> 00:33:39,840
um

894
00:33:40,799 --> 00:33:43,440
let me just also define it as a function

895
00:33:43,440 --> 00:33:45,360
like

896
00:33:45,360 --> 00:33:46,720
with the p

897
00:33:46,720 --> 00:33:48,640
now i defined it as a function and like

898
00:33:48,640 --> 00:33:50,720
if now i can do space and i will see

899
00:33:50,720 --> 00:33:54,640
everything in a fashionably mannered uh

900
00:33:54,640 --> 00:33:56,720
you know execution flow okay so

901
00:33:56,720 --> 00:33:58,960
basically i either after the decryption

902
00:33:58,960 --> 00:34:02,880
has occurred i i undefined the data that

903
00:34:02,880 --> 00:34:04,880
i just kind of like got hard time to

904
00:34:04,880 --> 00:34:07,679
analyze re-analyze it again and using

905
00:34:07,679 --> 00:34:08,719
the p

906
00:34:08,719 --> 00:34:11,359
button in the keyboard basically i

907
00:34:11,359 --> 00:34:13,520
define it as a function

908
00:34:13,520 --> 00:34:15,599
for ida to understand it is what is the

909
00:34:15,599 --> 00:34:18,639
actually building blocks

910
00:34:18,839 --> 00:34:20,399
cheers

911
00:34:20,399 --> 00:34:22,399
okay so

912
00:34:22,399 --> 00:34:24,560
eventually

913
00:34:24,560 --> 00:34:27,918
it will go and call here two functions

914
00:34:27,918 --> 00:34:31,199
this first function the second one so

915
00:34:31,199 --> 00:34:33,679
if i go to this

916
00:34:33,679 --> 00:34:34,560
function

917
00:34:34,560 --> 00:34:37,119
it will do some weird things which will

918
00:34:37,119 --> 00:34:38,399
basically

919
00:34:38,399 --> 00:34:41,199
eventually

920
00:34:41,520 --> 00:34:45,599
will resolve the apis or the functions

921
00:34:45,599 --> 00:34:46,800
of

922
00:34:46,800 --> 00:34:49,599
the of the run somewhere so suddenly you

923
00:34:49,599 --> 00:34:51,280
will have

924
00:34:51,280 --> 00:34:53,760
some functions appear there so

925
00:34:53,760 --> 00:34:56,159
let's try to do

926
00:34:56,159 --> 00:34:57,599
f8 here

927
00:34:57,599 --> 00:34:59,760
call the first function

928
00:34:59,760 --> 00:35:01,119
as you can see

929
00:35:01,119 --> 00:35:05,359
it it resolved like a lot of dlls

930
00:35:05,359 --> 00:35:06,240
and

931
00:35:06,240 --> 00:35:08,480
now we got to actually resolve the

932
00:35:08,480 --> 00:35:10,320
functions also

933
00:35:10,320 --> 00:35:12,560
so

934
00:35:13,119 --> 00:35:14,839
then i do another

935
00:35:14,839 --> 00:35:18,240
f8 and now you can see a lot of call

936
00:35:18,240 --> 00:35:20,320
blah blah something called blah blah

937
00:35:20,320 --> 00:35:23,119
something d word whatever it's actually

938
00:35:23,119 --> 00:35:25,119
a sign that is calling to the

939
00:35:25,119 --> 00:35:27,760
dynamically resolved iat the import

940
00:35:27,760 --> 00:35:30,320
address table the actual functions of

941
00:35:30,320 --> 00:35:33,680
the dls which are resolved in runtime

942
00:35:33,680 --> 00:35:37,920
okay so if i go into this call

943
00:35:37,920 --> 00:35:43,320
or maybe to another call like let me do

944
00:35:44,079 --> 00:35:47,119
i hate this computer

945
00:35:47,119 --> 00:35:48,800
and if i do now

946
00:35:48,800 --> 00:35:51,200
for example

947
00:35:51,200 --> 00:35:54,160
i'll do this call i'll do f7

948
00:35:54,160 --> 00:35:55,760
it will go actually

949
00:35:55,760 --> 00:35:59,760
and call show 32 command line argument

950
00:35:59,760 --> 00:36:03,359
so this function didn't appear in the

951
00:36:03,359 --> 00:36:05,119
executable file

952
00:36:05,119 --> 00:36:06,640
how did it actually

953
00:36:06,640 --> 00:36:10,400
now appear so the two functions that i

954
00:36:10,400 --> 00:36:12,240
presented you here they're actually

955
00:36:12,240 --> 00:36:14,000
doing what's so called dynamic api

956
00:36:14,000 --> 00:36:15,040
result

957
00:36:15,040 --> 00:36:17,599
now if you're as a retimer go and

958
00:36:17,599 --> 00:36:19,280
re-implement the same technique or the

959
00:36:19,280 --> 00:36:21,599
same concept in a different technique

960
00:36:21,599 --> 00:36:25,520
you can evade most of the static engines

961
00:36:25,520 --> 00:36:27,200
in most of the interiors and antivirus

962
00:36:27,200 --> 00:36:29,119
and it's kind of easy to do it

963
00:36:29,119 --> 00:36:30,400
yeah

964
00:36:30,400 --> 00:36:31,680
so

965
00:36:31,680 --> 00:36:34,880
for the sake of uh for our time

966
00:36:34,880 --> 00:36:39,480
i'll go back to my slides

967
00:36:40,800 --> 00:36:42,720
i actually have a run somewhere running

968
00:36:42,720 --> 00:36:44,560
now on my virtual machine and i don't

969
00:36:44,560 --> 00:36:47,839
give a hell about it okay

970
00:36:47,839 --> 00:36:50,800
okay so as we saw no functions in the

971
00:36:50,800 --> 00:36:52,640
import address table

972
00:36:52,640 --> 00:36:55,760
we can see that the sections are packed

973
00:36:55,760 --> 00:36:57,440
or encrypted

974
00:36:57,440 --> 00:37:00,480
okay so you see there is a high entropy

975
00:37:00,480 --> 00:37:02,880
most likely if there is a higher uh

976
00:37:02,880 --> 00:37:05,599
value than seven it will be most likely

977
00:37:05,599 --> 00:37:10,320
encrypted and coded or obfuscated

978
00:37:10,560 --> 00:37:11,680
so

979
00:37:11,680 --> 00:37:14,160
first before it goes into actually

980
00:37:14,160 --> 00:37:15,680
resolving the apis it will do the

981
00:37:15,680 --> 00:37:17,520
decryption so where

982
00:37:17,520 --> 00:37:18,880
where i showed you the two decryption

983
00:37:18,880 --> 00:37:21,280
routines with the source stuff this is

984
00:37:21,280 --> 00:37:23,760
where actually the store is made

985
00:37:23,760 --> 00:37:25,440
and the text section is actually

986
00:37:25,440 --> 00:37:27,520
decrypted

987
00:37:27,520 --> 00:37:30,240
and the dynamic api result

988
00:37:30,240 --> 00:37:33,040
basically it takes um

989
00:37:33,040 --> 00:37:35,680
both functions of load library which

990
00:37:35,680 --> 00:37:38,640
literally loads a dll file in runtime

991
00:37:38,640 --> 00:37:39,839
dynamically

992
00:37:39,839 --> 00:37:42,720
and then uses the get proc address

993
00:37:42,720 --> 00:37:44,560
the get proc address function is like

994
00:37:44,560 --> 00:37:45,520
the

995
00:37:45,520 --> 00:37:47,280
uh the broad like load library and get

996
00:37:47,280 --> 00:37:49,280
processors like the brother and sister

997
00:37:49,280 --> 00:37:52,560
of resolving apis or loading functions

998
00:37:52,560 --> 00:37:54,079
the getpro address function will

999
00:37:54,079 --> 00:37:56,720
actually import the specific functions

1000
00:37:56,720 --> 00:37:59,359
from the dlls

1001
00:37:59,359 --> 00:38:03,200
and voila you have the result functions

1002
00:38:03,200 --> 00:38:05,839
in runtime

1003
00:38:09,839 --> 00:38:12,079
there was some confusion uh as far as

1004
00:38:12,079 --> 00:38:14,079
double booking the room uh if you are

1005
00:38:14,079 --> 00:38:16,079
looking for the 12 o'clock reverse

1006
00:38:16,079 --> 00:38:19,839
engineering a dos pc fm

1007
00:38:19,839 --> 00:38:23,280
v game from 1994 by andrew it's now down

1008
00:38:23,280 --> 00:38:25,440
in the proving ground i'm sorry to have

1009
00:38:25,440 --> 00:38:27,119
interrupted thank you it's fine thank

1010
00:38:27,119 --> 00:38:29,280
you

1011
00:38:30,320 --> 00:38:32,720
so we talked about or i showed you

1012
00:38:32,720 --> 00:38:35,359
actually how it looks like

1013
00:38:35,359 --> 00:38:38,079
reversing a malware or it's not always

1014
00:38:38,079 --> 00:38:39,200
like this

1015
00:38:39,200 --> 00:38:41,599
uh if if the for example malware like

1016
00:38:41,599 --> 00:38:44,160
agent tesla or the yashama ransomware

1017
00:38:44,160 --> 00:38:46,000
which i also have a youtube video on it

1018
00:38:46,000 --> 00:38:47,200
you'll see that the malware is actually

1019
00:38:47,200 --> 00:38:50,800
compiled c sharp like dotnet c sharp

1020
00:38:50,800 --> 00:38:54,480
i hate oop languages i hate i hate them

1021
00:38:54,480 --> 00:38:57,599
but they're much easier to uh analyze

1022
00:38:57,599 --> 00:39:00,000
because you don't need to actually

1023
00:39:00,000 --> 00:39:01,599
analyze assembly because

1024
00:39:01,599 --> 00:39:04,160
dot c sharp is a high level language uh

1025
00:39:04,160 --> 00:39:06,480
it's called il assembly and if you put

1026
00:39:06,480 --> 00:39:09,040
this executable this compiled executable

1027
00:39:09,040 --> 00:39:11,520
into tools like d and spy it will

1028
00:39:11,520 --> 00:39:14,480
literally decompile the code

1029
00:39:14,480 --> 00:39:16,560
you literally will see

1030
00:39:16,560 --> 00:39:19,200
the source code of the malware

1031
00:39:19,200 --> 00:39:20,400
um

1032
00:39:20,400 --> 00:39:22,480
in c plus c or c plus plus compile

1033
00:39:22,480 --> 00:39:24,079
malware you will not see

1034
00:39:24,079 --> 00:39:25,760
the actual source code you will see the

1035
00:39:25,760 --> 00:39:27,760
assembly so either will do for you a

1036
00:39:27,760 --> 00:39:29,920
disassembly not the compile so it's a

1037
00:39:29,920 --> 00:39:31,680
different process

1038
00:39:31,680 --> 00:39:34,400
so now let's do some offensive stuff

1039
00:39:34,400 --> 00:39:35,280
uh

1040
00:39:35,280 --> 00:39:37,680
present you two bypass techniques

1041
00:39:37,680 --> 00:39:39,040
the first one is called rename

1042
00:39:39,040 --> 00:39:41,520
obfuscation and the second one is called

1043
00:39:41,520 --> 00:39:44,240
memory bombing which is my favorite um

1044
00:39:44,240 --> 00:39:46,000
again they're referred also in my book

1045
00:39:46,000 --> 00:39:48,400
antivirus bypass techniques i'll be more

1046
00:39:48,400 --> 00:39:49,599
than glad if you

1047
00:39:49,599 --> 00:39:51,760
will read this book

1048
00:39:51,760 --> 00:39:54,079
so let's take a simple reversal

1049
00:39:54,079 --> 00:39:56,960
like the most basic stuff that

1050
00:39:56,960 --> 00:39:59,200
retimers and pentas are like reverse

1051
00:39:59,200 --> 00:40:01,200
shadow

1052
00:40:01,200 --> 00:40:03,440
so you have a

1053
00:40:03,440 --> 00:40:06,079
c plus plus or c plus plus basically

1054
00:40:06,079 --> 00:40:07,200
code here

1055
00:40:07,200 --> 00:40:09,359
which defines the main function it

1056
00:40:09,359 --> 00:40:10,480
receives

1057
00:40:10,480 --> 00:40:12,720
two to three arguments

1058
00:40:12,720 --> 00:40:14,880
you define the ip that you want to call

1059
00:40:14,880 --> 00:40:17,359
back or to communicate with and the port

1060
00:40:17,359 --> 00:40:19,520
of the c2 malicious

1061
00:40:19,520 --> 00:40:20,960
whatever server

1062
00:40:20,960 --> 00:40:23,280
okay then it actually

1063
00:40:23,280 --> 00:40:24,880
calls the function with the host and

1064
00:40:24,880 --> 00:40:26,480
port

1065
00:40:26,480 --> 00:40:29,599
and you can kind of get what where i'm

1066
00:40:29,599 --> 00:40:30,960
getting it like

1067
00:40:30,960 --> 00:40:33,680
if you have a function named execute

1068
00:40:33,680 --> 00:40:36,000
shell in your code what is the

1069
00:40:36,000 --> 00:40:38,319
probability that antivirus and idios

1070
00:40:38,319 --> 00:40:40,480
will

1071
00:40:40,640 --> 00:40:41,760
detect it

1072
00:40:41,760 --> 00:40:42,720
you know

1073
00:40:42,720 --> 00:40:44,800
think about it

1074
00:40:44,800 --> 00:40:46,319
so the function of execute shell

1075
00:40:46,319 --> 00:40:48,720
basically takes two arguments uh you

1076
00:40:48,720 --> 00:40:50,319
know the ip the port

1077
00:40:50,319 --> 00:40:51,599
creates a socket blah blah blah blah

1078
00:40:51,599 --> 00:40:54,319
blah blah blah stuff and you know uh

1079
00:40:54,319 --> 00:40:56,880
defines the connection of ipv4 in this

1080
00:40:56,880 --> 00:41:00,720
case afinet and defines the receive of

1081
00:41:00,720 --> 00:41:03,520
data the buffer itself like whenever the

1082
00:41:03,520 --> 00:41:05,520
city server uh as an attacker you want

1083
00:41:05,520 --> 00:41:07,680
to execute a comment it needs to send a

1084
00:41:07,680 --> 00:41:09,119
comment and you need to receive the

1085
00:41:09,119 --> 00:41:12,000
output in the server side so this is the

1086
00:41:12,000 --> 00:41:13,040
thing

1087
00:41:13,040 --> 00:41:14,240
so

1088
00:41:14,240 --> 00:41:16,480
now we actually compile this

1089
00:41:16,480 --> 00:41:18,960
malware or reversal

1090
00:41:18,960 --> 00:41:23,119
and now we'll start to look for iocs

1091
00:41:23,119 --> 00:41:25,599
and again not only like you you

1092
00:41:25,599 --> 00:41:27,839
literally switch your

1093
00:41:27,839 --> 00:41:29,839
perspective

1094
00:41:29,839 --> 00:41:31,280
to a blue teamer

1095
00:41:31,280 --> 00:41:33,520
now we're acting like a blue teamer

1096
00:41:33,520 --> 00:41:35,040
this is the real power

1097
00:41:35,040 --> 00:41:35,839
like

1098
00:41:35,839 --> 00:41:37,680
you're already writing your malware your

1099
00:41:37,680 --> 00:41:40,000
whatever stuff you're doing then you put

1100
00:41:40,000 --> 00:41:42,000
the blue team head and you're okay if

1101
00:41:42,000 --> 00:41:44,640
i'm a blue team how do i detect it

1102
00:41:44,640 --> 00:41:46,800
what can what kind of iocs artifacts i

1103
00:41:46,800 --> 00:41:49,119
can find and rely on in order to create

1104
00:41:49,119 --> 00:41:51,200
my detections with the r or whatever

1105
00:41:51,200 --> 00:41:53,760
detection language it uses so if i do

1106
00:41:53,760 --> 00:41:55,839
your strings on the executable and i'll

1107
00:41:55,839 --> 00:41:58,880
use find str in case sensitive on cmd

1108
00:41:58,880 --> 00:42:01,280
like if any star is like the lame

1109
00:42:01,280 --> 00:42:05,040
version of grep in windows okay

1110
00:42:05,040 --> 00:42:07,440
i hate windows

1111
00:42:07,440 --> 00:42:08,240
okay

1112
00:42:08,240 --> 00:42:10,560
um

1113
00:42:10,560 --> 00:42:13,040
and you have this cmd dot

1114
00:42:13,040 --> 00:42:16,319
something like where is it dot exit

1115
00:42:16,319 --> 00:42:18,000
one of the reason you don't see the dot

1116
00:42:18,000 --> 00:42:22,560
exit it's because i used uh c plus plus

1117
00:42:22,560 --> 00:42:24,640
which is a shitty language i like c but

1118
00:42:24,640 --> 00:42:28,560
i hate c plus plus because it's oop and

1119
00:42:28,880 --> 00:42:30,319
and also to reverse engineer simplest

1120
00:42:30,319 --> 00:42:33,119
plus is much harder

1121
00:42:33,280 --> 00:42:34,560
and basically

1122
00:42:34,560 --> 00:42:35,760
um

1123
00:42:35,760 --> 00:42:37,520
you don't see cmd dot exit because there

1124
00:42:37,520 --> 00:42:39,280
is a null terminated string not an

1125
00:42:39,280 --> 00:42:41,359
alternative like a slash n

1126
00:42:41,359 --> 00:42:42,880
in each one of the strings for example

1127
00:42:42,880 --> 00:42:45,400
if you have i i p like

1128
00:42:45,400 --> 00:42:47,359
192.168.0.1 you you'll have in the

1129
00:42:47,359 --> 00:42:49,440
strings 192 168.

1130
00:42:49,440 --> 00:42:51,920
and then a new line

1131
00:42:51,920 --> 00:42:54,480
zero and one what uh

1132
00:42:54,480 --> 00:42:56,839
say plus plus don't ask me

1133
00:42:56,839 --> 00:43:00,000
okay so

1134
00:43:00,000 --> 00:43:01,920
if you're writing your malware z plus

1135
00:43:01,920 --> 00:43:04,880
plus it basically be

1136
00:43:04,880 --> 00:43:06,160
better for you

1137
00:43:06,160 --> 00:43:08,800
uh or easier for you to bypass rather

1138
00:43:08,800 --> 00:43:12,000
than c because c compile executables are

1139
00:43:12,000 --> 00:43:14,160
much easier to read you literally see

1140
00:43:14,160 --> 00:43:16,319
the strings the you know variable names

1141
00:43:16,319 --> 00:43:18,880
or whatever you know functions they're

1142
00:43:18,880 --> 00:43:20,640
defined and it's much easier to

1143
00:43:20,640 --> 00:43:21,920
understand

1144
00:43:21,920 --> 00:43:25,520
um okay so what now so now i'll

1145
00:43:25,520 --> 00:43:27,920
implement some rename obfuscation

1146
00:43:27,920 --> 00:43:31,200
so as you can see it's the same code

1147
00:43:31,200 --> 00:43:32,240
um

1148
00:43:32,240 --> 00:43:35,839
i changed the function from execute

1149
00:43:35,839 --> 00:43:40,800
shell like a shell what the hell to run

1150
00:43:40,800 --> 00:43:44,160
little generic name run run what

1151
00:43:44,160 --> 00:43:46,160
then you have host and port which again

1152
00:43:46,160 --> 00:43:47,839
it can be benign it doesn't have to be

1153
00:43:47,839 --> 00:43:50,000
malicious you know

1154
00:43:50,000 --> 00:43:52,240
um

1155
00:43:52,319 --> 00:43:55,440
you're in in the code before you saw

1156
00:43:55,440 --> 00:43:56,960
that actually

1157
00:43:56,960 --> 00:43:59,440
uh music create process with the cmd dot

1158
00:43:59,440 --> 00:44:02,480
exit and it's like cmd dot x in one line

1159
00:44:02,480 --> 00:44:06,079
so i did a simple trick you know

1160
00:44:06,079 --> 00:44:06,800
i

1161
00:44:06,800 --> 00:44:10,319
basically defined two char variables

1162
00:44:10,319 --> 00:44:11,599
cm

1163
00:44:11,599 --> 00:44:14,800
and d dot exit and then i concatenated

1164
00:44:14,800 --> 00:44:17,920
them together using strcat ins and in c

1165
00:44:17,920 --> 00:44:20,000
or c plus plus whatever as a pointer

1166
00:44:20,000 --> 00:44:22,240
variable of course and i pass this

1167
00:44:22,240 --> 00:44:24,880
pointer variable to create process

1168
00:44:24,880 --> 00:44:26,480
to the windows api create process

1169
00:44:26,480 --> 00:44:27,680
function

1170
00:44:27,680 --> 00:44:28,800
and

1171
00:44:28,800 --> 00:44:32,000
it basically changes things

1172
00:44:32,000 --> 00:44:34,560
in a compiled version

1173
00:44:34,560 --> 00:44:36,640
then you validate it again die you'll

1174
00:44:36,640 --> 00:44:39,359
see removal

1175
00:44:39,520 --> 00:44:41,839
yeah where's the cmd thought something

1176
00:44:41,839 --> 00:44:42,960
yeah

1177
00:44:42,960 --> 00:44:44,960
gun

1178
00:44:44,960 --> 00:44:47,440
got away

1179
00:44:47,760 --> 00:44:49,200
the second technique that i want to show

1180
00:44:49,200 --> 00:44:52,400
you is memory bombing i

1181
00:44:52,400 --> 00:44:54,240
i think that i basically the first that

1182
00:44:54,240 --> 00:44:56,560
name this technique is memory bombing

1183
00:44:56,560 --> 00:44:58,400
not something new but

1184
00:44:58,400 --> 00:45:00,640
presented in my book

1185
00:45:00,640 --> 00:45:02,079
and it's very

1186
00:45:02,079 --> 00:45:05,200
it's very basic like the first technique

1187
00:45:05,200 --> 00:45:07,599
used to bypass the static engine of

1188
00:45:07,599 --> 00:45:10,079
antivirus and edrs this one is just for

1189
00:45:10,079 --> 00:45:11,839
the dynamic engine

1190
00:45:11,839 --> 00:45:12,800
like

1191
00:45:12,800 --> 00:45:14,240
whenever you execute your malware or

1192
00:45:14,240 --> 00:45:16,240
your executable

1193
00:45:16,240 --> 00:45:17,839
the dynamic engine of the antivirus or

1194
00:45:17,839 --> 00:45:21,119
the edr will basically allocate a

1195
00:45:21,119 --> 00:45:24,000
protected virtualized memory like

1196
00:45:24,000 --> 00:45:26,079
virtual alert or something like this

1197
00:45:26,079 --> 00:45:29,040
it will put the code inside this

1198
00:45:29,040 --> 00:45:31,920
emulated uh environment or memory in

1199
00:45:31,920 --> 00:45:34,240
your computer and it will try to execute

1200
00:45:34,240 --> 00:45:35,200
it

1201
00:45:35,200 --> 00:45:36,000
now

1202
00:45:36,000 --> 00:45:37,520
as we all know

1203
00:45:37,520 --> 00:45:40,800
antivirus ddrs has one problem

1204
00:45:40,800 --> 00:45:42,880
uh basically two problems

1205
00:45:42,880 --> 00:45:45,280
the fear of false positives

1206
00:45:45,280 --> 00:45:47,760
yeah

1207
00:45:47,760 --> 00:45:49,680
and

1208
00:45:49,680 --> 00:45:50,880
the

1209
00:45:50,880 --> 00:45:52,960
limitation of resources in your computer

1210
00:45:52,960 --> 00:45:54,800
because think about it and diverse and

1211
00:45:54,800 --> 00:45:56,800
ears are residing the same memory in the

1212
00:45:56,800 --> 00:45:59,520
same operating system the same computer

1213
00:45:59,520 --> 00:46:01,680
so of course there have some limitations

1214
00:46:01,680 --> 00:46:04,240
now think about it if i

1215
00:46:04,240 --> 00:46:05,680
allocate

1216
00:46:05,680 --> 00:46:07,520
enough large memory like eight megabytes

1217
00:46:07,520 --> 00:46:10,160
20 mega whatever

1218
00:46:10,160 --> 00:46:12,160
so dantiverse like looks in your mouth

1219
00:46:12,160 --> 00:46:15,760
and said ah man it's too big for me

1220
00:46:15,760 --> 00:46:18,000
move on

1221
00:46:18,000 --> 00:46:20,800
and it let it let your malware execute

1222
00:46:20,800 --> 00:46:22,000
because

1223
00:46:22,000 --> 00:46:24,160
if there is any chance that it will

1224
00:46:24,160 --> 00:46:26,240
terminate a legitimate process or a

1225
00:46:26,240 --> 00:46:29,839
legitimate executable

1226
00:46:30,000 --> 00:46:31,520
big problem

1227
00:46:31,520 --> 00:46:33,359
and this is the same thing that i'm

1228
00:46:33,359 --> 00:46:35,760
actually exploiting here the fact that

1229
00:46:35,760 --> 00:46:38,079
any antivirus anywhere has some resource

1230
00:46:38,079 --> 00:46:39,440
limitation

1231
00:46:39,440 --> 00:46:42,160
and i'm allocating a big chunk of memory

1232
00:46:42,160 --> 00:46:44,319
for him to choke out

1233
00:46:44,319 --> 00:46:48,400
and later malware executed

1234
00:46:48,640 --> 00:46:53,879
and now for the detection test results

1235
00:46:56,000 --> 00:46:57,920
before the obfuscation and memory

1236
00:46:57,920 --> 00:47:01,839
bombing is made 35 detections

1237
00:47:01,839 --> 00:47:04,880
after the fescation and memory bond has

1238
00:47:04,880 --> 00:47:06,800
occurred

1239
00:47:06,800 --> 00:47:07,839
half

1240
00:47:07,839 --> 00:47:09,680
down

1241
00:47:09,680 --> 00:47:12,640
f down like more than 50

1242
00:47:12,640 --> 00:47:14,079
it's a lot

1243
00:47:14,079 --> 00:47:15,839
now think about it if i'll do things a

1244
00:47:15,839 --> 00:47:16,960
little bit differently and i'll

1245
00:47:16,960 --> 00:47:19,200
implement maybe even one or more

1246
00:47:19,200 --> 00:47:21,119
bypass techniques

1247
00:47:21,119 --> 00:47:23,520
i will create a fully undetectable

1248
00:47:23,520 --> 00:47:25,119
malware

1249
00:47:25,119 --> 00:47:27,040
zero detections

1250
00:47:27,040 --> 00:47:28,000
yeah

1251
00:47:28,000 --> 00:47:30,079
this is the reality we're living at this

1252
00:47:30,079 --> 00:47:31,920
is why you need to become a better

1253
00:47:31,920 --> 00:47:34,000
security expert this is why you need to

1254
00:47:34,000 --> 00:47:36,559
understand both sides red team blue team

1255
00:47:36,559 --> 00:47:39,040
whatever color you want to purple theme

1256
00:47:39,040 --> 00:47:39,920
yellow

1257
00:47:39,920 --> 00:47:41,920
all these colors it's not about the

1258
00:47:41,920 --> 00:47:44,160
colors it's about

1259
00:47:44,160 --> 00:47:45,520
the way you're working the way you're

1260
00:47:45,520 --> 00:47:49,040
taking the way you're approaching stuff

1261
00:47:50,640 --> 00:47:53,200
so for you know for the sake of ending

1262
00:47:53,200 --> 00:47:54,240
this uh

1263
00:47:54,240 --> 00:47:55,520
presentation

1264
00:47:55,520 --> 00:48:00,079
you know some important tips for success

1265
00:48:00,079 --> 00:48:02,400
always understand your tools and malware

1266
00:48:02,400 --> 00:48:04,480
go as deeper as possible understand the

1267
00:48:04,480 --> 00:48:07,119
iocs generated in your compile malware

1268
00:48:07,119 --> 00:48:09,119
the network packets the actual use

1269
00:48:09,119 --> 00:48:13,040
functions everything that you can

1270
00:48:13,040 --> 00:48:14,640
go as deep as possible you will be

1271
00:48:14,640 --> 00:48:17,760
surprised as what you will learn the

1272
00:48:17,760 --> 00:48:18,800
most

1273
00:48:18,800 --> 00:48:21,200
learning experience i had in my own

1274
00:48:21,200 --> 00:48:23,839
offensive blah blah career

1275
00:48:23,839 --> 00:48:25,920
is through doing the blue team stuff

1276
00:48:25,920 --> 00:48:27,680
into the response forensics now right

1277
00:48:27,680 --> 00:48:29,440
now it's like seeing the other side of

1278
00:48:29,440 --> 00:48:30,319
things

1279
00:48:30,319 --> 00:48:31,760
you know what i really appreciate blue

1280
00:48:31,760 --> 00:48:34,400
teamers because it's a hell of a hard

1281
00:48:34,400 --> 00:48:36,400
thing to do

1282
00:48:36,400 --> 00:48:38,960
and always the complaints are against

1283
00:48:38,960 --> 00:48:40,800
the blue team the writing is kind of sad

1284
00:48:40,800 --> 00:48:42,960
but

1285
00:48:43,520 --> 00:48:45,040
learn malware analysis to understand

1286
00:48:45,040 --> 00:48:46,880
think like a blue teamer and again

1287
00:48:46,880 --> 00:48:49,119
marouane is not only for bluetooth is

1288
00:48:49,119 --> 00:48:50,640
for red teamers

1289
00:48:50,640 --> 00:48:52,960
the bad guys do it they analyze malware

1290
00:48:52,960 --> 00:48:54,640
and they learn from each other i

1291
00:48:54,640 --> 00:48:56,319
actually showed you it with the dark

1292
00:48:56,319 --> 00:48:58,240
side ransomware and if you want you can

1293
00:48:58,240 --> 00:49:00,480
go to my youtube video about log b3

1294
00:49:00,480 --> 00:49:02,559
ransomware and you kind of see the same

1295
00:49:02,559 --> 00:49:06,160
code re-implemented there

1296
00:49:06,160 --> 00:49:07,599
research malware to gain deeper

1297
00:49:07,599 --> 00:49:09,760
knowledge and inspirations better

1298
00:49:09,760 --> 00:49:11,440
understanding of operating systems of

1299
00:49:11,440 --> 00:49:14,559
coding of everything

1300
00:49:14,559 --> 00:49:16,319
follow the mdlc model malware

1301
00:49:16,319 --> 00:49:18,079
development is like any other sdlc

1302
00:49:18,079 --> 00:49:20,480
process so write your malware

1303
00:49:20,480 --> 00:49:22,640
in a good fashion like

1304
00:49:22,640 --> 00:49:24,800
one of the malware research like they

1305
00:49:24,800 --> 00:49:26,720
call auto max keylogger

1306
00:49:26,720 --> 00:49:29,200
um i actually found a vulnerability

1307
00:49:29,200 --> 00:49:31,680
there which i exploited dll hijacking

1308
00:49:31,680 --> 00:49:32,480
like

1309
00:49:32,480 --> 00:49:34,079
if if you have automatic skill or in

1310
00:49:34,079 --> 00:49:36,319
your computer and and and i'm an another

1311
00:49:36,319 --> 00:49:38,400
attacker and i want to persist or maybe

1312
00:49:38,400 --> 00:49:42,160
even escalate privilege in your computer

1313
00:49:42,160 --> 00:49:45,119
i can exploit the same malware the art

1314
00:49:45,119 --> 00:49:46,480
of skill group to

1315
00:49:46,480 --> 00:49:48,000
be to resign in your computer so it's

1316
00:49:48,000 --> 00:49:50,079
kind of you know so if it's very

1317
00:49:50,079 --> 00:49:52,720
important for you for like opsec uh

1318
00:49:52,720 --> 00:49:56,079
operational security and everything

1319
00:49:56,079 --> 00:50:00,240
securely code securely code your malware

1320
00:50:00,240 --> 00:50:01,680
yeah i know it's kind of funny to say

1321
00:50:01,680 --> 00:50:03,680
that but yeah

1322
00:50:03,680 --> 00:50:05,920
be curious passionate and innovative i

1323
00:50:05,920 --> 00:50:07,680
don't need to say this

1324
00:50:07,680 --> 00:50:10,000
and take some breaks in between don't

1325
00:50:10,000 --> 00:50:11,280
work like uh

1326
00:50:11,280 --> 00:50:13,040
like a juggernaut take some breaks in

1327
00:50:13,040 --> 00:50:15,040
between

1328
00:50:15,040 --> 00:50:16,480
cooperation

1329
00:50:16,480 --> 00:50:20,240
cooperate don't be a jackass

1330
00:50:20,240 --> 00:50:22,319
yeah

1331
00:50:22,319 --> 00:50:24,880
if you want to do a real

1332
00:50:24,880 --> 00:50:27,280
adversary simulation adversary emulation

1333
00:50:27,280 --> 00:50:29,440
writing code whatever you want

1334
00:50:29,440 --> 00:50:30,800
you need to cooperate with teams like

1335
00:50:30,800 --> 00:50:33,040
trade intelligence you need to or do the

1336
00:50:33,040 --> 00:50:34,640
sort of intelligence for yourself and

1337
00:50:34,640 --> 00:50:36,000
understand what

1338
00:50:36,000 --> 00:50:38,319
is the actual value you provide your

1339
00:50:38,319 --> 00:50:41,040
company based on

1340
00:50:41,040 --> 00:50:42,240
the

1341
00:50:42,240 --> 00:50:46,960
actual threats posed on your company

1342
00:50:46,960 --> 00:50:50,240
and eventually take your report that

1343
00:50:50,240 --> 00:50:51,520
research simulation you did or the

1344
00:50:51,520 --> 00:50:52,720
retaining

1345
00:50:52,720 --> 00:50:54,480
work with the blue team

1346
00:50:54,480 --> 00:50:56,880
and gain a better security and money

1347
00:50:56,880 --> 00:50:59,200
time

1348
00:51:01,200 --> 00:51:03,440
again think like fluid water not like a

1349
00:51:03,440 --> 00:51:05,280
rigid rock

1350
00:51:05,280 --> 00:51:07,680
they can operate like a criminal

1351
00:51:07,680 --> 00:51:11,200
help security grow and become better

1352
00:51:11,599 --> 00:51:13,200
if you want to have some more resources

1353
00:51:13,200 --> 00:51:14,960
some more fun more learning experience

1354
00:51:14,960 --> 00:51:16,720
you can go into malware analysis school

1355
00:51:16,720 --> 00:51:18,319
you don't have to take my courses do

1356
00:51:18,319 --> 00:51:20,079
whatever you want you can learn for

1357
00:51:20,079 --> 00:51:21,200
yourselves

1358
00:51:21,200 --> 00:51:22,720
but you can use the resources the cheat

1359
00:51:22,720 --> 00:51:24,559
sheets everything is most of the things

1360
00:51:24,559 --> 00:51:27,599
are for free basically um my webs is

1361
00:51:27,599 --> 00:51:29,760
like an index you have everything there

1362
00:51:29,760 --> 00:51:31,680
or whatever you need uh if you have some

1363
00:51:31,680 --> 00:51:34,480
suggestions or uh things that

1364
00:51:34,480 --> 00:51:36,960
you think you i may add to

1365
00:51:36,960 --> 00:51:39,760
the website feel free to contact me

1366
00:51:39,760 --> 00:51:42,559
in my twitter whatever

1367
00:51:42,559 --> 00:51:45,550
yeah that's it thank you very much

1368
00:51:45,550 --> 00:51:51,280
[Applause]

1369
00:51:51,280 --> 00:51:52,800
thank you thank you your amazing

1370
00:51:52,800 --> 00:51:56,640
audience any questions

1371
00:51:57,760 --> 00:51:59,200
yeah

1372
00:51:59,200 --> 00:52:00,880
okay can you go just for the microphone

1373
00:52:00,880 --> 00:52:03,119
they asked yeah

1374
00:52:03,119 --> 00:52:05,920
questions questions

1375
00:52:05,920 --> 00:52:07,280
cheers

1376
00:52:07,280 --> 00:52:10,480
uh in terms of uh sandbox analysis uh

1377
00:52:10,480 --> 00:52:12,400
now that cuckoo's kind of been uh not

1378
00:52:12,400 --> 00:52:14,079
updated in a very long time i saw on

1379
00:52:14,079 --> 00:52:15,920
your site you have a bunch of sandboxes

1380
00:52:15,920 --> 00:52:17,839
listed but

1381
00:52:17,839 --> 00:52:20,160
it could be closer to the background

1382
00:52:20,160 --> 00:52:22,559
yeah okay testing amazing all right on

1383
00:52:22,559 --> 00:52:24,319
your website i saw you listed a bunch of

1384
00:52:24,319 --> 00:52:26,880
sandboxes um i used to use cuckoo when i

1385
00:52:26,880 --> 00:52:29,040
used to do this kind of stuff yeah i

1386
00:52:29,040 --> 00:52:30,720
haven't updated that forever the sandbox

1387
00:52:30,720 --> 00:52:32,240
is you listed i see a lot of them are

1388
00:52:32,240 --> 00:52:33,839
like paid solutions is there anything

1389
00:52:33,839 --> 00:52:35,920
you can still run locally similar to how

1390
00:52:35,920 --> 00:52:37,200
cooper used to be where you could step

1391
00:52:37,200 --> 00:52:39,359
into a process and interactively you

1392
00:52:39,359 --> 00:52:41,200
know like make a change like click on a

1393
00:52:41,200 --> 00:52:43,200
link or something or a button um and

1394
00:52:43,200 --> 00:52:45,280
then go back and get your analysis at

1395
00:52:45,280 --> 00:52:47,599
the end yeah that's not like uh running

1396
00:52:47,599 --> 00:52:48,800
the cloud

1397
00:52:48,800 --> 00:52:49,760
because if i'm dealing with very

1398
00:52:49,760 --> 00:52:51,440
sensitive data i don't necessarily trust

1399
00:52:51,440 --> 00:52:52,640
a company that says they'll keep it

1400
00:52:52,640 --> 00:52:55,040
private and keep everything local okay

1401
00:52:55,040 --> 00:52:56,480
thank you for the question so basically

1402
00:52:56,480 --> 00:52:58,720
yes about uh you know

1403
00:52:58,720 --> 00:53:01,520
plausible and workable sandbox out there

1404
00:53:01,520 --> 00:53:02,880
so basically if you go to my website

1405
00:53:02,880 --> 00:53:04,720
you'll see there's a bunch of uh you

1406
00:53:04,720 --> 00:53:06,800
know sandbox that you can use maybe

1407
00:53:06,800 --> 00:53:08,000
there's other settings that i'm not

1408
00:53:08,000 --> 00:53:09,839
aware of um

1409
00:53:09,839 --> 00:53:11,520
you can you basically have two options

1410
00:53:11,520 --> 00:53:13,359
you can implement your own

1411
00:53:13,359 --> 00:53:16,160
automated sandbox in uh

1412
00:53:16,160 --> 00:53:18,160
using cuckoo sandbox which is free open

1413
00:53:18,160 --> 00:53:20,400
source i actually use it in my army

1414
00:53:20,400 --> 00:53:22,480
service uh where i did the research and

1415
00:53:22,480 --> 00:53:24,079
security stuff

1416
00:53:24,079 --> 00:53:26,480
and it's kind of helped me you know to

1417
00:53:26,480 --> 00:53:27,839
gain the first visibility and

1418
00:53:27,839 --> 00:53:29,680
understanding of the malware it actually

1419
00:53:29,680 --> 00:53:32,559
um also uh communicates with your virus

1420
00:53:32,559 --> 00:53:34,720
total and brings you all the detections

1421
00:53:34,720 --> 00:53:37,280
all this kind of stuff um so if you want

1422
00:53:37,280 --> 00:53:39,520
to do something locally use a very

1423
00:53:39,520 --> 00:53:42,400
strong server with you know ssd storage

1424
00:53:42,400 --> 00:53:45,440
and whatever uh you know a zeon cpu

1425
00:53:45,440 --> 00:53:47,680
everything um

1426
00:53:47,680 --> 00:53:50,160
at least 32 gigs of ram because it takes

1427
00:53:50,160 --> 00:53:51,839
a lot of resources

1428
00:53:51,839 --> 00:53:53,040
basically you can implement cuckoo

1429
00:53:53,040 --> 00:53:55,040
sandbox it will do amazing job but take

1430
00:53:55,040 --> 00:53:56,400
into account there is a lot of

1431
00:53:56,400 --> 00:53:58,960
troubleshooting and a lot of problems

1432
00:53:58,960 --> 00:54:00,960
that you need to face like python

1433
00:54:00,960 --> 00:54:03,440
and linux and yada yada a lot

1434
00:54:03,440 --> 00:54:04,960
of yeah

1435
00:54:04,960 --> 00:54:06,240
if you want to

1436
00:54:06,240 --> 00:54:08,880
use a cloud-based sandbox you can use

1437
00:54:08,880 --> 00:54:11,119
any run which is amazing

1438
00:54:11,119 --> 00:54:13,040
uh for understood it's russian-based or

1439
00:54:13,040 --> 00:54:14,559
something i i don't know

1440
00:54:14,559 --> 00:54:16,240
from what i heard

1441
00:54:16,240 --> 00:54:17,599
take care

1442
00:54:17,599 --> 00:54:19,119
good luck don't put any personal

1443
00:54:19,119 --> 00:54:21,810
information in your malware or something

1444
00:54:21,810 --> 00:54:23,119
[Music]

1445
00:54:23,119 --> 00:54:25,599
uh you can use uh you know hybrid

1446
00:54:25,599 --> 00:54:28,319
analysis um and you know other other

1447
00:54:28,319 --> 00:54:31,040
solutions just go to bangladesh you have

1448
00:54:31,040 --> 00:54:32,000
their

1449
00:54:32,000 --> 00:54:32,960
sandbox

1450
00:54:32,960 --> 00:54:35,200
links you can use all of them

1451
00:54:35,200 --> 00:54:38,520
other questions

1452
00:54:40,319 --> 00:54:40,780
thank you

1453
00:54:40,780 --> 00:54:43,040
[Applause]

1454
00:54:43,040 --> 00:54:44,559
your amazing audience thank you very

1455
00:54:44,559 --> 00:54:49,079
much may god bless you all thank you

