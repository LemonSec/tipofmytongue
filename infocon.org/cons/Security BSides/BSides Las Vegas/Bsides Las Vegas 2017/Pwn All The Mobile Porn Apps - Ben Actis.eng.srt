1
00:00:00,000 --> 00:00:05,640
<font color="#E5E5E5">Piru thank you</font><font color="#CCCCCC"> my name is Ben actus this</font>

2
00:00:03,120 --> 00:00:07,560
is<font color="#CCCCCC"> pono</font><font color="#E5E5E5"> for naps thanks for having me at</font>

3
00:00:05,640 --> 00:00:10,500
besides Vegas I'm super<font color="#E5E5E5"> stoked to be</font>

4
00:00:07,560 --> 00:00:12,149
<font color="#CCCCCC">here a little bit about me I started</font><font color="#E5E5E5"> my</font>

5
00:00:10,500 --> 00:00:14,370
career at mitre<font color="#CCCCCC"> which is a federal</font>

6
00:00:12,150 --> 00:00:15,809
research lab<font color="#E5E5E5"> I did a lot of</font><font color="#CCCCCC"> mobile</font>

7
00:00:14,370 --> 00:00:19,080
security<font color="#E5E5E5"> there I also did a lot of</font>

8
00:00:15,809 --> 00:00:21,240
<font color="#E5E5E5">network sensor work as well then I went</font>

9
00:00:19,080 --> 00:00:23,759
to<font color="#E5E5E5"> Lookout where I reversed thousands of</font>

10
00:00:21,240 --> 00:00:26,070
Android malware samples and some iOS

11
00:00:23,760 --> 00:00:27,660
ones as well<font color="#E5E5E5"> then I spent a year</font><font color="#CCCCCC"> and a</font>

12
00:00:26,070 --> 00:00:30,150
half at<font color="#E5E5E5"> syn/ack where I helped build</font>

13
00:00:27,660 --> 00:00:32,520
their mobile attacking<font color="#E5E5E5"> tool chain so how</font>

14
00:00:30,150 --> 00:00:34,710
do you at scale<font color="#E5E5E5"> reverse apps statically</font>

15
00:00:32,520 --> 00:00:36,630
look for<font color="#CCCCCC"> Vons dynamically look for bones</font>

16
00:00:34,710 --> 00:00:39,840
<font color="#CCCCCC">I also did a lot of</font><font color="#E5E5E5"> mobile pen test</font>

17
00:00:36,630 --> 00:00:41,520
there<font color="#CCCCCC"> - all</font><font color="#E5E5E5"> of the work today has done</font>

18
00:00:39,840 --> 00:00:43,500
under<font color="#E5E5E5"> my side business cyber merchants</font>

19
00:00:41,520 --> 00:00:47,489
of death where I do a lot<font color="#CCCCCC"> of bug</font>

20
00:00:43,500 --> 00:00:49,230
bounties and<font color="#E5E5E5"> training in this area - so</font>

21
00:00:47,489 --> 00:00:51,029
a little<font color="#E5E5E5"> bit out line</font><font color="#CCCCCC"> we'll go through</font>

22
00:00:49,230 --> 00:00:52,709
the motivation<font color="#E5E5E5"> a little bit of Android</font>

23
00:00:51,030 --> 00:00:55,770
101 so you understand some of<font color="#E5E5E5"> the bones</font>

24
00:00:52,710 --> 00:00:57,629
if you kind of a novice<font color="#CCCCCC"> then we'll go</font>

25
00:00:55,770 --> 00:01:02,460
<font color="#CCCCCC">through three vulnerabilities</font><font color="#E5E5E5"> and apps</font>

26
00:00:57,629 --> 00:01:04,229
and easy fixes so motivation<font color="#E5E5E5"> here we're</font>

27
00:01:02,460 --> 00:01:06,960
all humans at the<font color="#CCCCCC"> end of the day some of</font>

28
00:01:04,229 --> 00:01:09,060
<font color="#E5E5E5">us have you</font><font color="#CCCCCC"> know sexual urges and some</font>

29
00:01:06,960 --> 00:01:12,030
of us<font color="#E5E5E5"> choose to use adult</font><font color="#CCCCCC"> content or</font>

30
00:01:09,060 --> 00:01:13,799
pornography apps to meet those<font color="#E5E5E5"> urges</font><font color="#CCCCCC"> but</font>

31
00:01:12,030 --> 00:01:16,470
<font color="#E5E5E5">the privacy these apps are pretty</font>

32
00:01:13,799 --> 00:01:18,990
important<font color="#E5E5E5"> right and there can be</font><font color="#CCCCCC"> some</font>

33
00:01:16,470 --> 00:01:21,210
serious consequences if our usage of

34
00:01:18,990 --> 00:01:24,330
<font color="#E5E5E5">these apps are inadvertently leaked to</font>

35
00:01:21,210 --> 00:01:27,000
others right<font color="#E5E5E5"> one such example is this</font>

36
00:01:24,330 --> 00:01:28,619
<font color="#E5E5E5">from the New York Post</font><font color="#CCCCCC"> users were</font>

37
00:01:27,000 --> 00:01:31,829
targeted<font color="#CCCCCC"> with a malicious</font><font color="#E5E5E5"> application</font>

38
00:01:28,619 --> 00:01:33,960
<font color="#E5E5E5">the idea was users would be tricked to</font>

39
00:01:31,829 --> 00:01:35,970
installing like a video<font color="#CCCCCC"> kodak or an</font>

40
00:01:33,960 --> 00:01:37,679
adult content<font color="#CCCCCC"> app what this app would</font>

41
00:01:35,970 --> 00:01:39,869
really do would film the user without

42
00:01:37,680 --> 00:01:41,460
<font color="#E5E5E5">their consent</font><font color="#CCCCCC"> right and then a video</font>

43
00:01:39,869 --> 00:01:43,890
would<font color="#CCCCCC"> be used</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> blackmail them and say</font>

44
00:01:41,460 --> 00:01:45,869
basically<font color="#E5E5E5"> pay me $500 or I share this</font>

45
00:01:43,890 --> 00:01:47,220
<font color="#CCCCCC">with a bunch</font><font color="#E5E5E5"> of people</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so as you</font>

46
00:01:45,869 --> 00:01:49,409
<font color="#E5E5E5">can imagine this would be really</font>

47
00:01:47,220 --> 00:01:53,399
damaging<font color="#CCCCCC"> to relationships</font><font color="#E5E5E5"> professional</font>

48
00:01:49,409 --> 00:01:55,890
ones<font color="#CCCCCC"> and you name it but</font><font color="#E5E5E5"> in addition</font><font color="#CCCCCC"> to</font>

49
00:01:53,399 --> 00:01:59,430
<font color="#E5E5E5">the privacy violation there's also an</font>

50
00:01:55,890 --> 00:02:01,950
actual physical<font color="#E5E5E5"> human impact here</font><font color="#CCCCCC"> Egypt</font>

51
00:01:59,430 --> 00:02:03,570
actually<font color="#E5E5E5"> leveraged improper</font>

52
00:02:01,950 --> 00:02:05,969
implementation some of the GPS

53
00:02:03,570 --> 00:02:08,728
functionality of Grindr to actually

54
00:02:05,969 --> 00:02:10,049
track<font color="#E5E5E5"> gay people and those people</font><font color="#CCCCCC"> are</font>

55
00:02:08,729 --> 00:02:13,560
<font color="#E5E5E5">actually injured and killed in some</font>

56
00:02:10,050 --> 00:02:18,340
cases so there's big impact<font color="#E5E5E5"> here</font>

57
00:02:13,560 --> 00:02:19,900
so are these apps<font color="#CCCCCC"> secured now before I</font>

58
00:02:18,340 --> 00:02:22,180
go forward<font color="#E5E5E5"> I have to cover a few little</font>

59
00:02:19,900 --> 00:02:23,650
Android things here<font color="#CCCCCC"> by default your</font>

60
00:02:22,180 --> 00:02:25,930
Android app has a little protected

61
00:02:23,650 --> 00:02:28,810
storage area<font color="#E5E5E5"> that</font><font color="#CCCCCC"> only that application</font>

62
00:02:25,930 --> 00:02:30,400
<font color="#CCCCCC">can access</font><font color="#E5E5E5"> if you ask for the external</font>

63
00:02:28,810 --> 00:02:32,440
<font color="#E5E5E5">storage permission</font><font color="#CCCCCC"> you can write -</font>

64
00:02:30,400 --> 00:02:34,480
typically<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> the SD card and that</font>

65
00:02:32,440 --> 00:02:36,910
storage is<font color="#E5E5E5"> world readable and world</font>

66
00:02:34,480 --> 00:02:39,310
writable<font color="#CCCCCC"> what I have up over here is the</font>

67
00:02:36,910 --> 00:02:40,569
<font color="#E5E5E5">actual screenshot</font><font color="#CCCCCC"> from the API</font><font color="#E5E5E5"> Docs and</font>

68
00:02:39,310 --> 00:02:43,000
<font color="#CCCCCC">they actually say there in the first</font>

69
00:02:40,569 --> 00:02:45,069
paragraph<font color="#E5E5E5"> do not store any private</font>

70
00:02:43,000 --> 00:02:47,860
information here<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so anything that</font>

71
00:02:45,069 --> 00:02:49,540
could identify<font color="#E5E5E5"> a user photos etc</font><font color="#CCCCCC"> they</font>

72
00:02:47,860 --> 00:02:51,790
also go out of their way that says you

73
00:02:49,540 --> 00:02:53,709
should<font color="#E5E5E5"> never write executable code here</font>

74
00:02:51,790 --> 00:02:56,048
because any<font color="#CCCCCC"> other</font><font color="#E5E5E5"> application on the</font>

75
00:02:53,709 --> 00:02:58,410
phone<font color="#CCCCCC"> could read</font><font color="#E5E5E5"> that code modify that</font>

76
00:02:56,049 --> 00:03:00,310
code<font color="#E5E5E5"> or delete that code</font>

77
00:02:58,410 --> 00:03:02,410
the other important<font color="#CCCCCC"> thing I want to</font>

78
00:03:00,310 --> 00:03:04,870
<font color="#E5E5E5">cover is on Android it's really simple</font>

79
00:03:02,410 --> 00:03:08,049
<font color="#E5E5E5">to do HTTP now as long as your back-end</font>

80
00:03:04,870 --> 00:03:10,780
supports it<font color="#E5E5E5"> it's as simple as</font><font color="#CCCCCC"> just doing</font>

81
00:03:08,049 --> 00:03:12,250
<font color="#E5E5E5">HTTP and your domain right it actually</font>

82
00:03:10,780 --> 00:03:14,560
says it right<font color="#CCCCCC"> there</font><font color="#E5E5E5"> in the docs yes it</font>

83
00:03:12,250 --> 00:03:16,090
can really be<font color="#CCCCCC"> that simple now this isn't</font>

84
00:03:14,560 --> 00:03:17,829
<font color="#E5E5E5">going to do your certificate pinning or</font>

85
00:03:16,090 --> 00:03:21,280
your key validation<font color="#CCCCCC"> but at least it's</font>

86
00:03:17,829 --> 00:03:22,780
<font color="#E5E5E5">something so the problem is if your</font>

87
00:03:21,280 --> 00:03:25,540
pornography app you're banned from

88
00:03:22,780 --> 00:03:27,100
Google Play so you can't leverage<font color="#E5E5E5"> that</font>

89
00:03:25,540 --> 00:03:29,470
update mechanism<font color="#CCCCCC"> so you have to roll</font>

90
00:03:27,100 --> 00:03:30,970
<font color="#CCCCCC">your own</font><font color="#E5E5E5"> the problem is if you</font><font color="#CCCCCC"> go to</font>

91
00:03:29,470 --> 00:03:33,070
stack overflow<font color="#CCCCCC"> and search like how to</font>

92
00:03:30,970 --> 00:03:35,109
update<font color="#CCCCCC"> nan Google Play app you get</font><font color="#E5E5E5"> this</font>

93
00:03:33,070 --> 00:03:37,209
example here<font color="#E5E5E5"> as the top one</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this is</font>

94
00:03:35,109 --> 00:03:40,090
<font color="#E5E5E5">a poor</font><font color="#CCCCCC"> implementation because it says</font><font color="#E5E5E5"> oh</font>

95
00:03:37,209 --> 00:03:41,470
just write to the SD<font color="#CCCCCC"> card right and we</font>

96
00:03:40,090 --> 00:03:43,150
<font color="#E5E5E5">just saw from the other slide</font><font color="#CCCCCC"> Google</font>

97
00:03:41,470 --> 00:03:47,170
tells you in the<font color="#CCCCCC"> api's you should never</font>

98
00:03:43,150 --> 00:03:49,600
do this so let's<font color="#CCCCCC"> look at some vaults</font>

99
00:03:47,170 --> 00:03:51,970
here the first one is known<font color="#CCCCCC"> as planet</font>

100
00:03:49,600 --> 00:03:55,030
prom<font color="#CCCCCC"> according to their</font><font color="#E5E5E5"> website they</font>

101
00:03:51,970 --> 00:03:58,120
have<font color="#CCCCCC"> a</font><font color="#E5E5E5"> million</font><font color="#CCCCCC"> satisfied users 200,000</font>

102
00:03:55,030 --> 00:04:01,000
video and picture sets<font color="#E5E5E5"> 400</font><font color="#CCCCCC"> professional</font>

103
00:03:58,120 --> 00:04:04,569
partners<font color="#CCCCCC"> 30 plus amateur partners as</font>

104
00:04:01,000 --> 00:04:06,190
well it says<font color="#E5E5E5"> one</font><font color="#CCCCCC"> Millett which</font><font color="#E5E5E5"> is funny</font>

105
00:04:04,569 --> 00:04:08,200
<font color="#CCCCCC">because if you look</font><font color="#E5E5E5"> at the tokens later</font>

106
00:04:06,190 --> 00:04:12,280
like<font color="#E5E5E5"> the unique user IDs or not at a</font>

107
00:04:08,200 --> 00:04:14,078
million<font color="#CCCCCC"> so anyway</font><font color="#E5E5E5"> it's true right now</font>

108
00:04:12,280 --> 00:04:16,750
<font color="#CCCCCC">maybe</font><font color="#E5E5E5"> that changed since I reversed it</font>

109
00:04:14,079 --> 00:04:18,070
but anyway Android<font color="#CCCCCC"> central says the</font>

110
00:04:16,750 --> 00:04:20,350
<font color="#E5E5E5">quality is there in the app and the</font>

111
00:04:18,070 --> 00:04:23,349
content<font color="#E5E5E5"> Android</font><font color="#CCCCCC"> Authority gave</font><font color="#E5E5E5"> them good</font>

112
00:04:20,350 --> 00:04:24,800
reviews and also<font color="#E5E5E5"> flush</font><font color="#CCCCCC"> bought too so</font>

113
00:04:23,349 --> 00:04:26,840
<font color="#E5E5E5">volume number one</font>

114
00:04:24,800 --> 00:04:29,180
this is men<font color="#E5E5E5"> in the middle proxy in case</font>

115
00:04:26,840 --> 00:04:31,039
you're not familiar<font color="#E5E5E5"> with it</font><font color="#CCCCCC"> it's most</font>

116
00:04:29,180 --> 00:04:33,770
commonly used for intercepting and

117
00:04:31,039 --> 00:04:36,800
viewing<font color="#E5E5E5"> HTTP traffic but in this case</font>

118
00:04:33,770 --> 00:04:38,659
<font color="#CCCCCC">it's HTTP so a few things here</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font>

119
00:04:36,800 --> 00:04:40,250
see my<font color="#CCCCCC"> username and</font><font color="#E5E5E5"> password also</font>

120
00:04:38,659 --> 00:04:42,560
there's this T value which is the

121
00:04:40,250 --> 00:04:44,000
<font color="#E5E5E5">integer I was</font><font color="#CCCCCC"> alluding to earlier the</font>

122
00:04:42,560 --> 00:04:45,710
<font color="#E5E5E5">reason why that's</font><font color="#CCCCCC"> a problem is if you</font>

123
00:04:44,000 --> 00:04:48,050
actually<font color="#E5E5E5"> look at how the app does its</font>

124
00:04:45,710 --> 00:04:50,090
change password or<font color="#CCCCCC"> change email</font><font color="#E5E5E5"> field</font><font color="#CCCCCC"> it</font>

125
00:04:48,050 --> 00:04:52,819
doesn't<font color="#E5E5E5"> check your</font><font color="#CCCCCC"> user name or password</font>

126
00:04:50,090 --> 00:04:54,169
<font color="#E5E5E5">you just need</font><font color="#CCCCCC"> that token</font><font color="#E5E5E5"> value</font><font color="#CCCCCC"> so you if</font>

127
00:04:52,819 --> 00:04:57,560
<font color="#E5E5E5">you knew</font><font color="#CCCCCC"> that you could</font><font color="#E5E5E5"> change people's</font>

128
00:04:54,169 --> 00:04:59,270
passwords<font color="#E5E5E5"> so the other problem</font><font color="#CCCCCC"> is this</font>

129
00:04:57,560 --> 00:05:01,190
<font color="#E5E5E5">application because it's all in plain</font>

130
00:04:59,270 --> 00:05:03,889
text communication<font color="#E5E5E5"> anything you search</font>

131
00:05:01,190 --> 00:05:05,870
for any private<font color="#E5E5E5"> messages to other</font><font color="#CCCCCC"> users</font>

132
00:05:03,889 --> 00:05:09,289
on the site anyone could<font color="#E5E5E5"> see that all</font>

133
00:05:05,870 --> 00:05:10,849
<font color="#CCCCCC">right so that's not</font><font color="#E5E5E5"> good the other</font>

134
00:05:09,289 --> 00:05:13,068
problem which is<font color="#E5E5E5"> more</font><font color="#CCCCCC"> interesting in my</font>

135
00:05:10,849 --> 00:05:15,099
<font color="#CCCCCC">opinion is can we replace their update</font>

136
00:05:13,069 --> 00:05:17,750
app because they can't be in Google Play

137
00:05:15,099 --> 00:05:19,520
<font color="#E5E5E5">and how this works is I some decompiled</font>

138
00:05:17,750 --> 00:05:21,530
Java code up<font color="#CCCCCC"> here is in this red</font>

139
00:05:19,520 --> 00:05:22,849
rectangle basically you got a string and

140
00:05:21,530 --> 00:05:25,698
it's getting<font color="#E5E5E5"> this string from the</font>

141
00:05:22,849 --> 00:05:27,349
<font color="#E5E5E5">Android manifest</font><font color="#CCCCCC"> for those of you</font><font color="#E5E5E5"> that</font>

142
00:05:25,699 --> 00:05:29,060
don't know<font color="#E5E5E5"> the Android manifest is kind</font>

143
00:05:27,349 --> 00:05:30,770
of like the table of contents<font color="#E5E5E5"> in an</font>

144
00:05:29,060 --> 00:05:32,750
<font color="#E5E5E5">android app</font><font color="#CCCCCC"> and all this is doing is</font>

145
00:05:30,770 --> 00:05:34,698
saying<font color="#E5E5E5"> hey look at this version name</font>

146
00:05:32,750 --> 00:05:36,669
store it in the string so in this case

147
00:05:34,699 --> 00:05:39,080
it's 2.07

148
00:05:36,669 --> 00:05:41,810
then what it's doing is calling<font color="#E5E5E5"> this</font>

149
00:05:39,080 --> 00:05:44,539
check for updates method and how that

150
00:05:41,810 --> 00:05:46,580
works it goes out<font color="#E5E5E5"> again over HTTP it's a</font>

151
00:05:44,539 --> 00:05:49,219
planet<font color="#E5E5E5"> prawn comm slash app slash</font>

152
00:05:46,580 --> 00:05:51,859
version gets<font color="#E5E5E5"> a connection and returns a</font>

153
00:05:49,219 --> 00:05:55,669
numeric value and here's what it looks

154
00:05:51,860 --> 00:05:57,949
<font color="#E5E5E5">like again HTTP now if we're</font><font color="#CCCCCC"> network</font>

155
00:05:55,669 --> 00:06:00,729
capable adversary<font color="#CCCCCC"> we can modify these</font>

156
00:05:57,949 --> 00:06:02,000
<font color="#E5E5E5">things right and I'll step through</font><font color="#CCCCCC"> that</font>

157
00:06:00,729 --> 00:06:03,979
oops

158
00:06:02,000 --> 00:06:05,840
so at this point what you're doing is

159
00:06:03,979 --> 00:06:07,310
<font color="#CCCCCC">just comparing right like if the clients</font>

160
00:06:05,840 --> 00:06:08,960
outdated compared to what the server

161
00:06:07,310 --> 00:06:12,590
tells us then go through<font color="#E5E5E5"> this update</font>

162
00:06:08,960 --> 00:06:14,690
path<font color="#E5E5E5"> and how</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> works is</font><font color="#CCCCCC"> again it's</font>

163
00:06:12,590 --> 00:06:18,318
<font color="#E5E5E5">going over HTTP</font><font color="#CCCCCC"> it goes</font><font color="#E5E5E5"> to just planet</font>

164
00:06:14,690 --> 00:06:21,199
<font color="#E5E5E5">prawn comm slash</font><font color="#CCCCCC"> pranic prawn APK and</font>

165
00:06:18,319 --> 00:06:22,990
then it just installs the<font color="#CCCCCC"> apk there so</font>

166
00:06:21,199 --> 00:06:24,800
here's a little<font color="#E5E5E5"> proof-of-concept video</font>

167
00:06:22,990 --> 00:06:28,759
<font color="#E5E5E5">man-in-the-middle proxy in the</font><font color="#CCCCCC"> back</font>

168
00:06:24,800 --> 00:06:31,069
<font color="#E5E5E5">Android it video</font><font color="#CCCCCC"> on the</font><font color="#E5E5E5"> front and if you</font>

169
00:06:28,759 --> 00:06:33,259
see the orange font that I've set up a

170
00:06:31,069 --> 00:06:35,570
printer<font color="#CCCCCC"> Sept</font><font color="#E5E5E5"> filter so</font><font color="#CCCCCC"> basically says</font>

171
00:06:33,259 --> 00:06:37,530
pause this traffic<font color="#E5E5E5"> if it matches this</font>

172
00:06:35,570 --> 00:06:40,690
<font color="#E5E5E5">expression</font>

173
00:06:37,530 --> 00:06:43,690
so it goes<font color="#E5E5E5"> out to</font><font color="#CCCCCC"> planet prom</font><font color="#E5E5E5"> gets the</font>

174
00:06:40,690 --> 00:06:47,530
version<font color="#E5E5E5"> I allow the request and now I'm</font>

175
00:06:43,690 --> 00:06:50,380
going<font color="#CCCCCC"> to modify this</font><font color="#E5E5E5"> right so the server</font>

176
00:06:47,530 --> 00:06:55,799
saying hey my latest version is 2.7 I'm

177
00:06:50,380 --> 00:06:57,880
gonna say no it's actually 2.9 save it

178
00:06:55,800 --> 00:07:00,520
now I'm<font color="#CCCCCC"> gonna allow this modified</font>

179
00:06:57,880 --> 00:07:02,590
response back to the client<font color="#CCCCCC"> at</font><font color="#E5E5E5"> this</font>

180
00:07:00,520 --> 00:07:03,969
point says update<font color="#CCCCCC"> available and I zoomed</font>

181
00:07:02,590 --> 00:07:06,099
in<font color="#CCCCCC"> here because</font><font color="#E5E5E5"> I added out a lot of the</font>

182
00:07:03,970 --> 00:07:09,690
adult content<font color="#E5E5E5"> yeah</font>

183
00:07:06,100 --> 00:07:09,690
sorry<font color="#E5E5E5"> guys</font><font color="#CCCCCC"> I had to</font><font color="#E5E5E5"> get</font><font color="#CCCCCC"> it through PR</font>

184
00:07:10,620 --> 00:07:18,790
yeah yes<font color="#E5E5E5"> so anyway so now it's going out</font>

185
00:07:16,180 --> 00:07:20,500
<font color="#E5E5E5">to the server</font><font color="#CCCCCC"> alright so this point you</font>

186
00:07:18,790 --> 00:07:21,640
can do a few things<font color="#E5E5E5"> the easiest one for</font>

187
00:07:20,500 --> 00:07:23,830
<font color="#E5E5E5">me is I'm just gonna change to you or</font>

188
00:07:21,640 --> 00:07:26,440
<font color="#CCCCCC">eligos - but you could do DNS poisoning</font>

189
00:07:23,830 --> 00:07:28,810
<font color="#CCCCCC">you can actually</font><font color="#E5E5E5"> modify the zip or the</font>

190
00:07:26,440 --> 00:07:30,400
apk file it comes in at this point<font color="#E5E5E5"> but</font>

191
00:07:28,810 --> 00:07:32,710
I'm just<font color="#CCCCCC"> changing it to a subnet in my</font>

192
00:07:30,400 --> 00:07:38,140
local<font color="#E5E5E5"> IP and I'm calling it planet</font><font color="#CCCCCC"> prana</font>

193
00:07:32,710 --> 00:07:40,539
<font color="#CCCCCC">apk</font><font color="#E5E5E5"> which</font><font color="#CCCCCC"> is not the real one at this</font>

194
00:07:38,140 --> 00:07:44,169
point it's being downloaded<font color="#CCCCCC"> I'm saying</font>

195
00:07:40,540 --> 00:07:47,460
hey open it open<font color="#E5E5E5"> the top one and this</font>

196
00:07:44,170 --> 00:07:52,810
point the<font color="#CCCCCC"> icon is different</font><font color="#E5E5E5"> right</font>

197
00:07:47,460 --> 00:07:55,060
installing<font color="#E5E5E5"> I open it and boom not the</font>

198
00:07:52,810 --> 00:07:56,470
pool<font color="#E5E5E5"> and you're looking for yeah</font><font color="#CCCCCC"> so</font>

199
00:07:55,060 --> 00:07:58,510
obviously this is<font color="#CCCCCC"> not</font><font color="#E5E5E5"> the legit app</font>

200
00:07:56,470 --> 00:08:00,250
right<font color="#E5E5E5"> so if I was an adversary</font><font color="#CCCCCC"> I could</font>

201
00:07:58,510 --> 00:08:02,740
do a lot of<font color="#E5E5E5"> things at this point</font><font color="#CCCCCC"> right</font>

202
00:08:00,250 --> 00:08:04,270
<font color="#CCCCCC">worst case I could replace it with</font><font color="#E5E5E5"> a</font>

203
00:08:02,740 --> 00:08:05,650
rooted version of the app right where I

204
00:08:04,270 --> 00:08:07,990
try<font color="#E5E5E5"> to root your phone with an exploit</font>

205
00:08:05,650 --> 00:08:09,880
and persist that way<font color="#CCCCCC"> I could add</font>

206
00:08:07,990 --> 00:08:11,440
<font color="#CCCCCC">additional permissions like camera and</font>

207
00:08:09,880 --> 00:08:13,210
things like<font color="#CCCCCC"> that and just</font><font color="#E5E5E5"> kind of shove</font>

208
00:08:11,440 --> 00:08:14,620
it into<font color="#E5E5E5"> the</font><font color="#CCCCCC"> binary so it looks like</font><font color="#E5E5E5"> the</font>

209
00:08:13,210 --> 00:08:16,630
<font color="#E5E5E5">real one but I'm actually doing other</font>

210
00:08:14,620 --> 00:08:18,520
things<font color="#E5E5E5"> in the background</font><font color="#CCCCCC"> in even worse</font>

211
00:08:16,630 --> 00:08:19,150
case if I don't any have any new

212
00:08:18,520 --> 00:08:21,280
permissions

213
00:08:19,150 --> 00:08:22,810
I still have read external storage so I

214
00:08:21,280 --> 00:08:24,549
could like kind<font color="#E5E5E5"> of peruse external</font>

215
00:08:22,810 --> 00:08:26,400
storage looking for embarrassing photos

216
00:08:24,550 --> 00:08:29,290
or something

217
00:08:26,400 --> 00:08:31,359
third<font color="#CCCCCC"> boom they're storing this update</font>

218
00:08:29,290 --> 00:08:33,310
file<font color="#E5E5E5"> in a world readable</font><font color="#CCCCCC"> world writable</font>

219
00:08:31,360 --> 00:08:34,930
location<font color="#E5E5E5"> right so if I'm a malicious app</font>

220
00:08:33,309 --> 00:08:38,439
<font color="#E5E5E5">I could just watch this directory and</font>

221
00:08:34,929 --> 00:08:40,839
swap it<font color="#CCCCCC"> out that way - so the vendor is</font>

222
00:08:38,440 --> 00:08:42,640
actually really positive<font color="#CCCCCC"> they basically</font>

223
00:08:40,840 --> 00:08:45,040
<font color="#CCCCCC">thanked me they said we're gonna</font><font color="#E5E5E5"> fix it</font>

224
00:08:42,640 --> 00:08:47,230
ASAP<font color="#CCCCCC"> and he replied I don't know what</font>

225
00:08:45,040 --> 00:08:49,209
Andy's role is but<font color="#E5E5E5"> he wanted to fix it</font>

226
00:08:47,230 --> 00:08:51,610
<font color="#CCCCCC">so</font><font color="#E5E5E5"> cool</font>

227
00:08:49,209 --> 00:08:53,290
<font color="#CCCCCC">disclosure timeline I emailed them</font><font color="#E5E5E5"> end</font>

228
00:08:51,610 --> 00:08:55,540
of the month<font color="#E5E5E5"> they actually responded I</font>

229
00:08:53,290 --> 00:08:58,360
think within<font color="#E5E5E5"> an hour which is great</font><font color="#CCCCCC"> it</font>

230
00:08:55,540 --> 00:09:02,679
still<font color="#CCCCCC"> hasn't</font><font color="#E5E5E5"> been fixed yet but um maybe</font>

231
00:08:58,360 --> 00:09:04,029
this morning they did<font color="#E5E5E5"> so we'll see</font><font color="#CCCCCC"> so</font>

232
00:09:02,679 --> 00:09:05,829
they're doing<font color="#CCCCCC"> in secure communication</font>

233
00:09:04,029 --> 00:09:07,809
<font color="#E5E5E5">there's no integrity check of that</font>

234
00:09:05,829 --> 00:09:11,199
update file and they're saving<font color="#E5E5E5"> that</font>

235
00:09:07,809 --> 00:09:13,420
update file on external<font color="#E5E5E5"> storage so next</font>

236
00:09:11,199 --> 00:09:14,559
one perfect girls<font color="#E5E5E5"> this one's kind of</font>

237
00:09:13,420 --> 00:09:16,748
funny so if you go<font color="#E5E5E5"> to their website</font>

238
00:09:14,559 --> 00:09:18,249
<font color="#E5E5E5">they're mimicking</font><font color="#CCCCCC"> google play but this</font>

239
00:09:16,749 --> 00:09:21,160
<font color="#E5E5E5">is actually</font><font color="#CCCCCC"> not google</font><font color="#E5E5E5"> play which is</font>

240
00:09:18,249 --> 00:09:22,660
<font color="#E5E5E5">really funny</font><font color="#CCCCCC"> second thing is they have</font>

241
00:09:21,160 --> 00:09:24,490
fake reviews and if you go in the source

242
00:09:22,660 --> 00:09:27,519
<font color="#E5E5E5">code it's just like hard-coded values in</font>

243
00:09:24,490 --> 00:09:28,269
here just<font color="#CCCCCC"> also a really funny it</font><font color="#E5E5E5"> gets</font>

244
00:09:27,519 --> 00:09:30,699
<font color="#E5E5E5">better</font>

245
00:09:28,269 --> 00:09:32,319
they were afforded<font color="#E5E5E5"> the app is porn droid</font>

246
00:09:30,699 --> 00:09:33,609
which is not the name of<font color="#CCCCCC"> the app and</font>

247
00:09:32,319 --> 00:09:36,639
<font color="#E5E5E5">this was actually a piece</font><font color="#CCCCCC"> of Android</font>

248
00:09:33,610 --> 00:09:38,319
malware from<font color="#E5E5E5"> like two years ago</font><font color="#CCCCCC"> the</font>

249
00:09:36,639 --> 00:09:40,300
<font color="#E5E5E5">other funny thing is they have like fake</font>

250
00:09:38,319 --> 00:09:42,009
reviews<font color="#CCCCCC"> I don't know why they</font><font color="#E5E5E5"> put like a</font>

251
00:09:40,300 --> 00:09:45,309
fake can you help me reset my password

252
00:09:42,009 --> 00:09:49,480
<font color="#E5E5E5">review</font><font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> know I thought that</font><font color="#CCCCCC"> was</font>

253
00:09:45,309 --> 00:09:51,639
<font color="#E5E5E5">funny so little number one for perfect</font>

254
00:09:49,480 --> 00:09:53,439
girls<font color="#CCCCCC"> this one have this one works the</font>

255
00:09:51,639 --> 00:09:55,119
<font color="#E5E5E5">client sends its version out to the</font>

256
00:09:53,439 --> 00:09:56,259
server<font color="#E5E5E5"> and then the server replies</font><font color="#CCCCCC"> so</font>

257
00:09:55,119 --> 00:09:59,499
this one's saying hey I'm running

258
00:09:56,259 --> 00:10:01,480
<font color="#CCCCCC">version 2.0</font><font color="#E5E5E5"> nine the server responds</font>

259
00:09:59,499 --> 00:10:03,399
with two things this<font color="#CCCCCC"> time</font><font color="#E5E5E5"> one a boolean</font>

260
00:10:01,480 --> 00:10:05,740
<font color="#CCCCCC">value true</font><font color="#E5E5E5"> or false</font><font color="#CCCCCC"> that says is there</font>

261
00:10:03,399 --> 00:10:09,819
an update<font color="#E5E5E5"> available into a version</font>

262
00:10:05,740 --> 00:10:11,529
<font color="#E5E5E5">number</font><font color="#CCCCCC"> so here's how</font><font color="#E5E5E5"> this works so the</font>

263
00:10:09,819 --> 00:10:13,059
first check is<font color="#CCCCCC"> that boolean right you</font>

264
00:10:11,529 --> 00:10:15,309
know<font color="#E5E5E5"> is an update available true or</font>

265
00:10:13,059 --> 00:10:16,929
false<font color="#CCCCCC"> and I'm gonna</font><font color="#E5E5E5"> go through a little</font>

266
00:10:15,309 --> 00:10:18,219
<font color="#CCCCCC">bit of Android assembly here just</font>

267
00:10:16,929 --> 00:10:20,439
because<font color="#E5E5E5"> we're gonna be bug in a couple</font>

268
00:10:18,220 --> 00:10:21,790
slides<font color="#CCCCCC"> so this if statement</font><font color="#E5E5E5"> becomes</font>

269
00:10:20,439 --> 00:10:23,920
three lines right there<font color="#CCCCCC"> so it's</font>

270
00:10:21,790 --> 00:10:26,110
<font color="#E5E5E5">basically get a boolean</font><font color="#CCCCCC"> and then if that</font>

271
00:10:23,920 --> 00:10:29,529
<font color="#E5E5E5">is equal</font><font color="#CCCCCC"> to zero go down one path if not</font>

272
00:10:26,110 --> 00:10:32,649
go<font color="#E5E5E5"> down the</font><font color="#CCCCCC"> other path</font><font color="#E5E5E5"> then there's the</font>

273
00:10:29,529 --> 00:10:34,329
second check that numeric one and this

274
00:10:32,649 --> 00:10:35,769
one<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> values actually hard-coded</font>

275
00:10:34,329 --> 00:10:38,498
<font color="#CCCCCC">as a string in the app it's</font><font color="#E5E5E5"> not in that</font>

276
00:10:35,769 --> 00:10:40,660
manifest file<font color="#CCCCCC"> and it's just</font><font color="#E5E5E5"> saying hey</font>

277
00:10:38,499 --> 00:10:42,549
if<font color="#CCCCCC"> my client version is</font><font color="#E5E5E5"> outdated from</font>

278
00:10:40,660 --> 00:10:45,939
the server one then<font color="#E5E5E5"> go ahead</font><font color="#CCCCCC"> and do an</font>

279
00:10:42,549 --> 00:10:47,889
update<font color="#E5E5E5"> and again this one if statement</font>

280
00:10:45,939 --> 00:10:49,629
<font color="#E5E5E5">comes about four lines because we're</font>

281
00:10:47,889 --> 00:10:51,220
comparing<font color="#E5E5E5"> floats and then it does a</font>

282
00:10:49,629 --> 00:10:53,649
difference and if<font color="#E5E5E5"> that</font><font color="#CCCCCC"> difference is</font>

283
00:10:51,220 --> 00:10:55,360
<font color="#E5E5E5">equal to zero or</font><font color="#CCCCCC"> less than equal to zero</font>

284
00:10:53,649 --> 00:10:58,089
go down one path<font color="#E5E5E5"> otherwise go through</font>

285
00:10:55,360 --> 00:10:59,709
<font color="#E5E5E5">another path so this should</font><font color="#CCCCCC"> be super</font>

286
00:10:58,089 --> 00:11:01,509
<font color="#CCCCCC">easy</font><font color="#E5E5E5"> right because like the apps the</font>

287
00:10:59,709 --> 00:11:02,140
clients apps<font color="#E5E5E5"> already outdated or</font>

288
00:11:01,509 --> 00:11:04,209
<font color="#E5E5E5">outdated</font>

289
00:11:02,140 --> 00:11:07,360
so I'm like okay cool it's<font color="#E5E5E5"> going out</font>

290
00:11:04,209 --> 00:11:09,279
<font color="#CCCCCC">Klein saying it's 2.09</font><font color="#E5E5E5"> server says</font><font color="#CCCCCC"> the</font>

291
00:11:07,360 --> 00:11:11,560
<font color="#E5E5E5">new on is like 2.10 or something like</font>

292
00:11:09,279 --> 00:11:15,180
<font color="#CCCCCC">that I'm like great this should be the</font>

293
00:11:11,560 --> 00:11:18,849
<font color="#CCCCCC">most easy POC ever so I'm allowing it</font>

294
00:11:15,180 --> 00:11:21,219
<font color="#E5E5E5">allowing</font><font color="#CCCCCC"> a bunch of</font><font color="#E5E5E5"> other things</font><font color="#CCCCCC"> and it</font>

295
00:11:18,850 --> 00:11:23,230
failed<font color="#E5E5E5"> which is really weird so I start</font>

296
00:11:21,220 --> 00:11:24,550
changing<font color="#CCCCCC"> and decrement incrementing and</font>

297
00:11:23,230 --> 00:11:26,140
decrementing everything on the client

298
00:11:24,550 --> 00:11:27,880
<font color="#CCCCCC">and everything on the server</font><font color="#E5E5E5"> end and it</font>

299
00:11:26,140 --> 00:11:29,410
still wasn't happening<font color="#CCCCCC"> so I'm like this</font>

300
00:11:27,880 --> 00:11:30,910
is really<font color="#E5E5E5"> weird right because I told my</font>

301
00:11:29,410 --> 00:11:33,430
mentor for<font color="#CCCCCC"> this talk like this</font><font color="#E5E5E5"> will work</font>

302
00:11:30,910 --> 00:11:35,290
right<font color="#E5E5E5"> so I start going</font><font color="#CCCCCC"> through</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> like</font>

303
00:11:33,430 --> 00:11:36,880
this is<font color="#E5E5E5"> weird</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is really strange</font>

304
00:11:35,290 --> 00:11:40,390
that second check I'm getting the same

305
00:11:36,880 --> 00:11:42,399
<font color="#CCCCCC">value twice so</font><font color="#E5E5E5"> their update mechanism</font><font color="#CCCCCC"> is</font>

306
00:11:40,390 --> 00:11:44,890
<font color="#E5E5E5">actually wrong they compare the client</font>

307
00:11:42,399 --> 00:11:46,720
version twice and so<font color="#E5E5E5"> the server one so</font>

308
00:11:44,890 --> 00:11:50,980
they're actually<font color="#E5E5E5"> never update which is</font>

309
00:11:46,720 --> 00:11:54,640
<font color="#E5E5E5">hilarious</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we got a pro so we can</font>

310
00:11:50,980 --> 00:11:56,200
patch their binary<font color="#E5E5E5"> so if they fix this</font>

311
00:11:54,640 --> 00:11:57,490
conditional check they do<font color="#E5E5E5"> update which</font>

312
00:11:56,200 --> 00:11:59,860
is<font color="#CCCCCC"> great</font>

313
00:11:57,490 --> 00:12:01,570
so here's we can also do<font color="#CCCCCC"> debugging and</font>

314
00:11:59,860 --> 00:12:04,269
<font color="#E5E5E5">ida pro with android because you guys</font>

315
00:12:01,570 --> 00:12:05,860
aren't familiar<font color="#E5E5E5"> with that</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> i'm doing</font>

316
00:12:04,269 --> 00:12:07,959
<font color="#CCCCCC">i'm basically</font><font color="#E5E5E5"> saying start debugging</font><font color="#CCCCCC"> any</font>

317
00:12:05,860 --> 00:12:09,220
of<font color="#E5E5E5"> those red lines or breakpoints so I</font>

318
00:12:07,959 --> 00:12:11,380
basically<font color="#CCCCCC"> set a bunch of breakpoints</font>

319
00:12:09,220 --> 00:12:13,930
<font color="#CCCCCC">right where that first boolean check is</font>

320
00:12:11,380 --> 00:12:20,170
and then where that<font color="#E5E5E5"> numeric check is</font>

321
00:12:13,930 --> 00:12:21,519
what you'll<font color="#E5E5E5"> see and a blue line will</font>

322
00:12:20,170 --> 00:12:23,829
indicate<font color="#E5E5E5"> that's like the current line</font>

323
00:12:21,519 --> 00:12:27,690
we're executing on<font color="#E5E5E5"> and don't worry zoom</font>

324
00:12:23,829 --> 00:12:27,689
in<font color="#E5E5E5"> Ida</font><font color="#CCCCCC"> when it's funny values and stuff</font>

325
00:12:28,649 --> 00:12:32,970
so it takes a second<font color="#CCCCCC"> that's launching</font>

326
00:12:31,060 --> 00:12:35,369
<font color="#E5E5E5">okay so gets the client version</font>

327
00:12:32,970 --> 00:12:37,750
<font color="#E5E5E5">correctly the</font><font color="#CCCCCC"> first time for</font><font color="#E5E5E5"> the boolean</font>

328
00:12:35,370 --> 00:12:40,660
<font color="#CCCCCC">now it's getting values</font><font color="#E5E5E5"> from the server</font>

329
00:12:37,750 --> 00:12:43,060
end in the background we're at the<font color="#E5E5E5"> first</font>

330
00:12:40,660 --> 00:12:47,649
boolean check right now<font color="#CCCCCC"> true</font><font color="#E5E5E5"> value</font>

331
00:12:43,060 --> 00:12:50,339
<font color="#E5E5E5">everything's coded correctly here it's</font>

332
00:12:47,649 --> 00:12:52,570
getting the new values from their server

333
00:12:50,339 --> 00:12:54,940
<font color="#CCCCCC">all right and we're gonna go</font><font color="#E5E5E5"> to the left</font>

334
00:12:52,570 --> 00:12:57,040
<font color="#E5E5E5">of execution over here because we got</font>

335
00:12:54,940 --> 00:12:59,320
the right boolean value it's gonna pop

336
00:12:57,040 --> 00:13:01,149
<font color="#CCCCCC">over here gets</font><font color="#E5E5E5"> the client version and</font>

337
00:12:59,320 --> 00:13:03,699
now this is where the<font color="#CCCCCC"> mistake is</font><font color="#E5E5E5"> because</font>

338
00:13:01,149 --> 00:13:06,940
<font color="#E5E5E5">it gets this value twice right one of</font>

339
00:13:03,699 --> 00:13:09,040
those<font color="#E5E5E5"> should be 2.1 so all</font><font color="#CCCCCC"> I did was Ida</font>

340
00:13:06,940 --> 00:13:12,670
<font color="#E5E5E5">I just said okay you're now</font><font color="#CCCCCC"> 1 and it's</font>

341
00:13:09,040 --> 00:13:16,620
<font color="#E5E5E5">gonna go down the update path so boom</font>

342
00:13:12,670 --> 00:13:16,620
hit continue execution<font color="#E5E5E5"> here</font>

343
00:13:20,410 --> 00:13:26,030
it's gonna run and there you go<font color="#CCCCCC"> - that</font>

344
00:13:25,280 --> 00:13:32,770
one<font color="#CCCCCC"> is available</font>

345
00:13:26,030 --> 00:13:35,089
so go<font color="#E5E5E5"> ahead hit</font><font color="#CCCCCC"> download new version and</font>

346
00:13:32,770 --> 00:13:38,030
<font color="#CCCCCC">pow and I'm gonna</font><font color="#E5E5E5"> zoom in on a second</font>

347
00:13:35,090 --> 00:13:39,890
here<font color="#E5E5E5"> you can see what I'm doing so</font>

348
00:13:38,030 --> 00:13:41,510
similar kind<font color="#E5E5E5"> of attack here instead of</font>

349
00:13:39,890 --> 00:13:44,000
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> the legitimate update server</font>

350
00:13:41,510 --> 00:13:46,280
which is also HTTP<font color="#E5E5E5"> I'm just</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> go to</font>

351
00:13:44,000 --> 00:13:48,620
a server<font color="#E5E5E5"> I control</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> think I call it</font>

352
00:13:46,280 --> 00:13:50,720
evil that apk here and download it<font color="#CCCCCC"> now</font>

353
00:13:48,620 --> 00:13:52,850
<font color="#CCCCCC">you could also again like I said change</font>

354
00:13:50,720 --> 00:13:54,890
that<font color="#CCCCCC"> apk</font><font color="#E5E5E5"> in transit so</font><font color="#CCCCCC"> you won't even</font>

355
00:13:52,850 --> 00:13:57,320
see a change<font color="#E5E5E5"> in address</font><font color="#CCCCCC"> could do it</font><font color="#E5E5E5"> that</font>

356
00:13:54,890 --> 00:13:59,210
<font color="#E5E5E5">way and also DNS poison and do a bunch</font>

357
00:13:57,320 --> 00:14:01,160
of other<font color="#E5E5E5"> stuff here too</font>

358
00:13:59,210 --> 00:14:02,510
so at this<font color="#E5E5E5"> point the app pops up and I</font>

359
00:14:01,160 --> 00:14:06,260
had to edit<font color="#E5E5E5"> out a bunch adult content</font>

360
00:14:02,510 --> 00:14:07,880
<font color="#E5E5E5">here so enjoy kittens</font><font color="#CCCCCC"> so now it's</font>

361
00:14:06,260 --> 00:14:15,890
running<font color="#E5E5E5"> it kind of relaunches and then</font>

362
00:14:07,880 --> 00:14:20,570
the<font color="#CCCCCC"> update prompt</font><font color="#E5E5E5"> comes and boom not the</font>

363
00:14:15,890 --> 00:14:24,830
porn<font color="#E5E5E5"> you're looking for so now this one</font>

364
00:14:20,570 --> 00:14:26,900
<font color="#CCCCCC">also writes the SD card which is bad so</font>

365
00:14:24,830 --> 00:14:28,580
disclosure I emailed the company<font color="#E5E5E5"> and I</font>

366
00:14:26,900 --> 00:14:32,870
haven't heard<font color="#E5E5E5"> anything and even</font><font color="#CCCCCC"> checked</font>

367
00:14:28,580 --> 00:14:35,660
<font color="#CCCCCC">my</font><font color="#E5E5E5"> spam folder this morning so I know so</font>

368
00:14:32,870 --> 00:14:37,340
perfect girls<font color="#E5E5E5"> HTTP usage</font><font color="#CCCCCC"> they're not</font>

369
00:14:35,660 --> 00:14:39,020
hashing any kind of<font color="#E5E5E5"> any kind</font><font color="#CCCCCC"> of</font>

370
00:14:37,340 --> 00:14:43,580
<font color="#E5E5E5">integrity check and they're also writing</font>

371
00:14:39,020 --> 00:14:46,040
to external storage so pornhub<font color="#CCCCCC"> most of</font>

372
00:14:43,580 --> 00:14:49,220
you<font color="#E5E5E5"> probably familiar with this one</font><font color="#CCCCCC"> the</font>

373
00:14:46,040 --> 00:14:51,319
good<font color="#E5E5E5"> news is they are using HTTPS right</font>

374
00:14:49,220 --> 00:14:53,990
<font color="#E5E5E5">yeah they have puppy videos on it</font><font color="#CCCCCC"> and</font>

375
00:14:51,320 --> 00:14:56,210
they are<font color="#E5E5E5"> doing a hash of the apk being</font>

376
00:14:53,990 --> 00:14:58,430
downloaded<font color="#CCCCCC"> the problem is as you'll see</font>

377
00:14:56,210 --> 00:15:00,440
here how<font color="#E5E5E5"> it works is it goes that URL</font>

378
00:14:58,430 --> 00:15:02,479
<font color="#E5E5E5">says hey what's the latest version and</font>

379
00:15:00,440 --> 00:15:05,030
then it's going<font color="#E5E5E5"> to reply back if it's</font>

380
00:15:02,480 --> 00:15:08,060
out of<font color="#E5E5E5"> date</font><font color="#CCCCCC"> the new apk the link to it</font>

381
00:15:05,030 --> 00:15:10,850
and then an md5 with that files<font color="#E5E5E5"> md5 of</font>

382
00:15:08,060 --> 00:15:13,729
<font color="#CCCCCC">the new</font><font color="#E5E5E5"> apk and a file size</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> problem</font>

383
00:15:10,850 --> 00:15:16,580
with is you're sending the new file size

384
00:15:13,730 --> 00:15:18,170
and hash<font color="#E5E5E5"> in a mechanism which is as an</font>

385
00:15:16,580 --> 00:15:20,360
attacker I can see so it's trivial<font color="#E5E5E5"> to</font>

386
00:15:18,170 --> 00:15:22,010
change at this point<font color="#E5E5E5"> this file is</font>

387
00:15:20,360 --> 00:15:23,360
written<font color="#E5E5E5"> to external storage and then</font>

388
00:15:22,010 --> 00:15:26,420
there's going<font color="#E5E5E5"> to compare them and if</font>

389
00:15:23,360 --> 00:15:30,210
that<font color="#E5E5E5"> matches then we're good</font>

390
00:15:26,420 --> 00:15:31,650
so I'm modifying<font color="#CCCCCC"> so what I did</font><font color="#E5E5E5"> was I</font><font color="#CCCCCC"> put</font>

391
00:15:30,210 --> 00:15:34,260
a fraudulent cert on the device so I can

392
00:15:31,650 --> 00:15:36,360
intercept traffic<font color="#CCCCCC"> right</font><font color="#E5E5E5"> and what I ended</font>

393
00:15:34,260 --> 00:15:38,790
up doing was<font color="#CCCCCC"> just</font><font color="#E5E5E5"> change it to a value</font>

394
00:15:36,360 --> 00:15:44,430
<font color="#CCCCCC">or server I control</font><font color="#E5E5E5"> I'm changing the</font>

395
00:15:38,790 --> 00:15:46,800
file size and<font color="#E5E5E5"> md5 pretty easy so here's</font>

396
00:15:44,430 --> 00:15:48,900
an example here<font color="#E5E5E5"> I'm sorry for the potato</font>

397
00:15:46,800 --> 00:15:55,469
quality in this video<font color="#E5E5E5"> my screen recorder</font>

398
00:15:48,900 --> 00:16:01,290
binary crashed<font color="#CCCCCC"> so I'm going out it's</font>

399
00:15:55,470 --> 00:16:03,540
talking to pornhub right now now at this

400
00:16:01,290 --> 00:16:05,370
point<font color="#E5E5E5"> I've deleted</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> legitimate values</font>

401
00:16:03,540 --> 00:16:08,640
and I'm<font color="#E5E5E5"> putting my evil ones right so</font>

402
00:16:05,370 --> 00:16:12,180
put in my evil md5 hash here the new

403
00:16:08,640 --> 00:16:16,410
file size<font color="#E5E5E5"> and an evil URL which I</font>

404
00:16:12,180 --> 00:16:18,000
control and because<font color="#E5E5E5"> these are the values</font>

405
00:16:16,410 --> 00:16:20,600
the client checks<font color="#E5E5E5"> it assumes</font>

406
00:16:18,000 --> 00:16:20,600
everything's good

407
00:16:21,560 --> 00:16:27,420
<font color="#E5E5E5">and at this point it's updating now it's</font>

408
00:16:25,770 --> 00:16:33,210
going<font color="#E5E5E5"> to my evil URL to get the new</font>

409
00:16:27,420 --> 00:16:39,540
update<font color="#E5E5E5"> apk</font><font color="#CCCCCC"> OOP</font>

410
00:16:33,210 --> 00:16:42,870
download and<font color="#CCCCCC"> should pop up</font><font color="#E5E5E5"> in a second</font>

411
00:16:39,540 --> 00:16:44,400
here now you could do all this<font color="#E5E5E5"> just with</font>

412
00:16:42,870 --> 00:16:45,930
scripting man-in-the-middle proxy or a

413
00:16:44,400 --> 00:16:47,490
little bit of<font color="#E5E5E5"> Python you none of these</font>

414
00:16:45,930 --> 00:16:52,010
attacks would require my human

415
00:16:47,490 --> 00:16:52,010
intervention hit install

416
00:16:55,350 --> 00:17:00,240
and open cool<font color="#E5E5E5"> right</font>

417
00:16:58,650 --> 00:17:02,189
so pornhub<font color="#CCCCCC"> is a bug bounty I'm like</font>

418
00:17:00,240 --> 00:17:04,319
awesome<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is really</font><font color="#E5E5E5"> cool and get paid</font>

419
00:17:02,190 --> 00:17:06,839
<font color="#E5E5E5">for finding these</font><font color="#CCCCCC"> bones so I submit it</font>

420
00:17:04,319 --> 00:17:09,629
and they're like hey cyber operations to

421
00:17:06,839 --> 00:17:11,550
death thank you but your update URL is

422
00:17:09,630 --> 00:17:13,290
actually<font color="#CCCCCC"> not in scope so we're not going</font>

423
00:17:11,550 --> 00:17:16,889
<font color="#CCCCCC">to reward</font><font color="#E5E5E5"> you and I was like</font><font color="#CCCCCC"> ah sucks</font>

424
00:17:13,290 --> 00:17:18,359
but<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> right but then I was like wait</font>

425
00:17:16,890 --> 00:17:19,589
<font color="#CCCCCC">a minute they're still</font><font color="#E5E5E5"> riding to the SD</font>

426
00:17:18,359 --> 00:17:22,369
card<font color="#CCCCCC"> I wonder</font><font color="#E5E5E5"> if there's a race</font>

427
00:17:19,589 --> 00:17:25,440
condition<font color="#E5E5E5"> there so what I did</font><font color="#CCCCCC"> here was</font>

428
00:17:22,369 --> 00:17:27,659
there's that check<font color="#CCCCCC"> that I mentioned this</font>

429
00:17:25,440 --> 00:17:29,190
I called it checksum check<font color="#E5E5E5"> what this is</font>

430
00:17:27,660 --> 00:17:31,170
doing is<font color="#E5E5E5"> going into this bit of code and</font>

431
00:17:29,190 --> 00:17:33,620
all it's doing is getting<font color="#E5E5E5"> the file size</font>

432
00:17:31,170 --> 00:17:36,450
and the checksum<font color="#E5E5E5"> so it's pretty easy</font>

433
00:17:33,620 --> 00:17:39,840
<font color="#E5E5E5">then if that condition is</font><font color="#CCCCCC"> met then it</font>

434
00:17:36,450 --> 00:17:41,820
goes ahead and installs<font color="#E5E5E5"> the apk that's</font>

435
00:17:39,840 --> 00:17:44,699
downloaded so if I'm an attacker

436
00:17:41,820 --> 00:17:46,939
adversary this is kind of<font color="#E5E5E5"> a period of</font>

437
00:17:44,700 --> 00:17:50,490
<font color="#E5E5E5">time where I have a race condition</font><font color="#CCCCCC"> right</font>

438
00:17:46,940 --> 00:17:52,200
so let's do this so I did<font color="#CCCCCC"> it with a</font>

439
00:17:50,490 --> 00:17:54,180
debugger just so I<font color="#E5E5E5"> could extend that</font>

440
00:17:52,200 --> 00:17:58,140
race condition<font color="#E5E5E5"> to an unlimited period of</font>

441
00:17:54,180 --> 00:18:02,280
time<font color="#E5E5E5"> so I'm doing debugger start the</font>

442
00:17:58,140 --> 00:18:04,350
bugging<font color="#CCCCCC"> and startup in a second here</font><font color="#E5E5E5"> now</font>

443
00:18:02,280 --> 00:18:06,420
on Android<font color="#CCCCCC"> you can debug in a few</font>

444
00:18:04,350 --> 00:18:08,129
<font color="#CCCCCC">different</font><font color="#E5E5E5"> ways</font><font color="#CCCCCC"> if you want to cheat you</font>

445
00:18:06,420 --> 00:18:10,320
can take the app do you compile it<font color="#CCCCCC"> add a</font>

446
00:18:08,130 --> 00:18:12,330
single<font color="#E5E5E5"> flag and then Reese I knit that's</font>

447
00:18:10,320 --> 00:18:14,100
one way<font color="#E5E5E5"> but your signers are not going</font>

448
00:18:12,330 --> 00:18:16,110
to match<font color="#E5E5E5"> because it's public</font><font color="#CCCCCC"> private key</font>

449
00:18:14,100 --> 00:18:17,520
crypto the other<font color="#E5E5E5"> way is you can have a</font>

450
00:18:16,110 --> 00:18:20,159
rooted device<font color="#E5E5E5"> and you can launch</font>

451
00:18:17,520 --> 00:18:21,360
anything<font color="#E5E5E5"> as a root and</font><font color="#CCCCCC"> then attach or if</font>

452
00:18:20,160 --> 00:18:24,000
you really<font color="#CCCCCC"> want to get savvy you can</font>

453
00:18:21,360 --> 00:18:27,120
actually recompile<font color="#CCCCCC"> android</font><font color="#E5E5E5"> from source</font>

454
00:18:24,000 --> 00:18:28,590
and change some<font color="#CCCCCC"> stuff so you know so</font>

455
00:18:27,120 --> 00:18:31,320
right now it's running<font color="#E5E5E5"> it's doing the</font>

456
00:18:28,590 --> 00:18:35,699
update<font color="#E5E5E5"> and I set a breakpoint</font><font color="#CCCCCC"> right</font>

457
00:18:31,320 --> 00:18:37,560
<font color="#CCCCCC">where that check the curse right here so</font>

458
00:18:35,700 --> 00:18:39,510
at this point the app is validated<font color="#E5E5E5"> the</font>

459
00:18:37,560 --> 00:18:41,669
<font color="#E5E5E5">apk on external storage it inherently</font>

460
00:18:39,510 --> 00:18:43,530
trusts it<font color="#E5E5E5"> and what I'm doing here is I'm</font>

461
00:18:41,670 --> 00:18:46,860
<font color="#CCCCCC">just removing there legit</font><font color="#E5E5E5"> app and I'm</font>

462
00:18:43,530 --> 00:18:48,480
copying<font color="#E5E5E5"> the name of my like</font><font color="#CCCCCC"> jokey app to</font>

463
00:18:46,860 --> 00:18:54,120
the same name<font color="#CCCCCC"> that the client is</font>

464
00:18:48,480 --> 00:18:57,530
expecting right and then I'm gonna

465
00:18:54,120 --> 00:18:57,530
enable execution ago

466
00:19:06,990 --> 00:19:12,900
and boom it's updating cool installing

467
00:19:11,190 --> 00:19:14,580
and also by the way<font color="#CCCCCC"> you can change the</font>

468
00:19:12,900 --> 00:19:17,580
little app icons<font color="#E5E5E5"> and shortcuts I was</font>

469
00:19:14,580 --> 00:19:20,699
just being lazy<font color="#CCCCCC"> pool</font><font color="#E5E5E5"> all right so I</font>

470
00:19:17,580 --> 00:19:22,439
submit this one<font color="#E5E5E5"> right</font><font color="#CCCCCC"> so the</font><font color="#E5E5E5"> vendor</font>

471
00:19:20,700 --> 00:19:24,330
kinda went back<font color="#E5E5E5"> and forth for a while I</font>

472
00:19:22,440 --> 00:19:26,730
think<font color="#CCCCCC"> two or three months eventually I</font>

473
00:19:24,330 --> 00:19:28,830
ended<font color="#CCCCCC"> up</font><font color="#E5E5E5"> talking to a nasty Nick who was</font>

474
00:19:26,730 --> 00:19:31,500
their main Android dev I think and he

475
00:19:28,830 --> 00:19:33,330
basically<font color="#E5E5E5"> said hey thank you we're aware</font>

476
00:19:31,500 --> 00:19:35,340
we're storing things in common ground

477
00:19:33,330 --> 00:19:37,740
where other applications can<font color="#E5E5E5"> hijack the</font>

478
00:19:35,340 --> 00:19:39,600
<font color="#E5E5E5">apk sadly there's little we can do</font><font color="#CCCCCC"> to</font>

479
00:19:37,740 --> 00:19:42,150
resolve<font color="#E5E5E5"> this issue because</font><font color="#CCCCCC"> the nature of</font>

480
00:19:39,600 --> 00:19:43,980
how we<font color="#CCCCCC"> distribute</font><font color="#E5E5E5"> and I was like hey I'm</font>

481
00:19:42,150 --> 00:19:45,270
sorry that<font color="#E5E5E5"> Google is being unfair to you</font>

482
00:19:43,980 --> 00:19:47,970
but have you<font color="#CCCCCC"> considered using</font><font color="#E5E5E5"> these</font>

483
00:19:45,270 --> 00:19:49,200
protected storage internal<font color="#CCCCCC"> api's the</font>

484
00:19:47,970 --> 00:19:51,270
difference being like instead<font color="#CCCCCC"> of get</font>

485
00:19:49,200 --> 00:19:54,180
external dirts get dirt it's actually

486
00:19:51,270 --> 00:19:56,340
pretty<font color="#CCCCCC"> easy</font><font color="#E5E5E5"> change at this</font><font color="#CCCCCC"> point there</font>

487
00:19:54,180 --> 00:19:57,420
bug bounty triage person replied to me

488
00:19:56,340 --> 00:20:00,480
<font color="#E5E5E5">and you mind if we close this as</font>

489
00:19:57,420 --> 00:20:01,800
informative and I replied<font color="#E5E5E5"> yeah I do I'm</font>

490
00:20:00,480 --> 00:20:05,010
a little confused here<font color="#CCCCCC"> because</font><font color="#E5E5E5"> it gave</font>

491
00:20:01,800 --> 00:20:07,169
you<font color="#E5E5E5"> proof of concept video</font><font color="#CCCCCC"> I gave you an</font>

492
00:20:05,010 --> 00:20:09,030
Ida Pro database file<font color="#E5E5E5"> and I</font><font color="#CCCCCC"> cite like</font>

493
00:20:07,170 --> 00:20:11,490
mobile<font color="#CCCCCC"> guide saying you really</font><font color="#E5E5E5"> shouldn't</font>

494
00:20:09,030 --> 00:20:14,220
write to external storage<font color="#CCCCCC"> I'm confused</font>

495
00:20:11,490 --> 00:20:15,720
why this doesn't<font color="#CCCCCC"> count</font><font color="#E5E5E5"> at this point I</font>

496
00:20:14,220 --> 00:20:17,460
think<font color="#E5E5E5"> a legal person on their</font><font color="#CCCCCC"> team or</font>

497
00:20:15,720 --> 00:20:19,070
<font color="#E5E5E5">someone wrote me</font><font color="#CCCCCC"> back that said we since</font>

498
00:20:17,460 --> 00:20:21,390
you're quoting are you let me do as well

499
00:20:19,070 --> 00:20:23,360
<font color="#CCCCCC">we reserve the</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> to pay whoever</font><font color="#E5E5E5"> we</font>

500
00:20:21,390 --> 00:20:25,970
want<font color="#CCCCCC"> we don't think this is a</font><font color="#E5E5E5"> bone</font>

501
00:20:23,360 --> 00:20:28,469
<font color="#E5E5E5">there's gonna be no further negotiation</font>

502
00:20:25,970 --> 00:20:33,200
<font color="#E5E5E5">so I told my girlfriend all right</font><font color="#CCCCCC"> I will</font>

503
00:20:28,470 --> 00:20:36,120
<font color="#CCCCCC">give it</font><font color="#E5E5E5"> besides</font><font color="#CCCCCC"> Vegas taco</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> okay yeah</font>

504
00:20:33,200 --> 00:20:37,620
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> I joke but like these are</font><font color="#CCCCCC"> like</font>

505
00:20:36,120 --> 00:20:38,790
really<font color="#E5E5E5"> bad flaws and they really should</font>

506
00:20:37,620 --> 00:20:41,100
fix<font color="#E5E5E5"> up right</font>

507
00:20:38,790 --> 00:20:45,300
but anyway so disclosure<font color="#E5E5E5"> first of all</font>

508
00:20:41,100 --> 00:20:47,909
comes out<font color="#CCCCCC"> 12:10 then on</font><font color="#E5E5E5"> 12:20 yep</font>

509
00:20:45,300 --> 00:20:49,500
<font color="#CCCCCC">they mark is</font><font color="#E5E5E5"> not at scope then I submit</font>

510
00:20:47,910 --> 00:20:50,970
the new bone<font color="#CCCCCC"> then we actually go back</font>

511
00:20:49,500 --> 00:20:54,060
<font color="#CCCCCC">and forth for</font><font color="#E5E5E5"> a bit which was actually</font>

512
00:20:50,970 --> 00:20:57,930
<font color="#E5E5E5">fun 12</font><font color="#CCCCCC"> February first dev says it can't</font>

513
00:20:54,060 --> 00:20:59,760
fix week later they said sorry<font color="#E5E5E5"> go away</font>

514
00:20:57,930 --> 00:21:03,240
and then<font color="#E5E5E5"> 628</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> said hey I'm gonna go</font>

515
00:20:59,760 --> 00:21:04,800
public about<font color="#CCCCCC"> it so the other</font><font color="#E5E5E5"> question</font><font color="#CCCCCC"> is</font>

516
00:21:03,240 --> 00:21:08,400
could we<font color="#E5E5E5"> do this without a debugger</font>

517
00:21:04,800 --> 00:21:10,470
<font color="#CCCCCC">right</font><font color="#E5E5E5"> so this is a really</font><font color="#CCCCCC"> neat</font><font color="#E5E5E5"> app file</font>

518
00:21:08,400 --> 00:21:13,080
observer who knows about<font color="#E5E5E5"> inotify in the</font>

519
00:21:10,470 --> 00:21:14,580
audience<font color="#E5E5E5"> some of you yeah okay so one of</font>

520
00:21:13,080 --> 00:21:16,530
my<font color="#E5E5E5"> old school like</font><font color="#CCCCCC"> graveyard</font><font color="#E5E5E5"> UNIX</font>

521
00:21:14,580 --> 00:21:18,750
mentors taught<font color="#E5E5E5"> me about</font><font color="#CCCCCC"> inotify and it's</font>

522
00:21:16,530 --> 00:21:19,740
super cool basically it leverages the

523
00:21:18,750 --> 00:21:21,660
kernel and<font color="#CCCCCC"> you can base</font>

524
00:21:19,740 --> 00:21:23,610
say watch a directory<font color="#E5E5E5"> for a file change</font>

525
00:21:21,660 --> 00:21:25,200
and you can watch for<font color="#E5E5E5"> a lot of different</font>

526
00:21:23,610 --> 00:21:27,330
things here's all some examples<font color="#E5E5E5"> so you</font>

527
00:21:25,200 --> 00:21:30,600
<font color="#E5E5E5">can say like tell me when a new file is</font>

528
00:21:27,330 --> 00:21:33,000
created<font color="#CCCCCC"> such as update apk</font><font color="#E5E5E5"> tell me when</font>

529
00:21:30,600 --> 00:21:34,860
something is written<font color="#E5E5E5"> to a file</font><font color="#CCCCCC"> tell me</font>

530
00:21:33,000 --> 00:21:37,050
when a file is closed<font color="#CCCCCC"> so what you could</font>

531
00:21:34,860 --> 00:21:39,209
do as an evil app you could<font color="#E5E5E5"> get external</font>

532
00:21:37,050 --> 00:21:41,428
permission and then just watch the SD

533
00:21:39,210 --> 00:21:43,290
<font color="#E5E5E5">card and you would watch for one the</font>

534
00:21:41,429 --> 00:21:44,610
writing of it<font color="#E5E5E5"> and then reading of it</font>

535
00:21:43,290 --> 00:21:46,139
because it remember it<font color="#E5E5E5"> reads file size</font>

536
00:21:44,610 --> 00:21:48,120
and does a hash and<font color="#E5E5E5"> then you just do</font>

537
00:21:46,140 --> 00:21:50,910
like a symlink<font color="#CCCCCC"> really quick so that's</font>

538
00:21:48,120 --> 00:21:53,340
how you do<font color="#E5E5E5"> without a debugger so pornhub</font>

539
00:21:50,910 --> 00:21:56,640
the arguing HTTP which<font color="#E5E5E5"> is awesome</font><font color="#CCCCCC"> they</font>

540
00:21:53,340 --> 00:21:58,320
<font color="#CCCCCC">use</font><font color="#E5E5E5"> yeah it's our HTTP thank you</font><font color="#CCCCCC"> they</font>

541
00:21:56,640 --> 00:22:00,450
are doing an integrity check<font color="#E5E5E5"> which is</font>

542
00:21:58,320 --> 00:22:02,010
good<font color="#CCCCCC"> there's improvement</font><font color="#E5E5E5"> on both of</font>

543
00:22:00,450 --> 00:22:05,190
these but it's something<font color="#CCCCCC"> but they are</font>

544
00:22:02,010 --> 00:22:07,890
<font color="#E5E5E5">still writing to external storage</font><font color="#CCCCCC"> so the</font>

545
00:22:05,190 --> 00:22:10,890
fixes for<font color="#CCCCCC"> these are super easy use HTTP</font>

546
00:22:07,890 --> 00:22:12,750
ideally you know doing<font color="#E5E5E5"> key pinning and</font>

547
00:22:10,890 --> 00:22:16,140
checking your certs<font color="#E5E5E5"> and do not write</font>

548
00:22:12,750 --> 00:22:17,700
files to external shared storage<font color="#E5E5E5"> you</font>

549
00:22:16,140 --> 00:22:20,730
could write it internally and there's an

550
00:22:17,700 --> 00:22:22,500
allow installed apps or installation<font color="#E5E5E5"> of</font>

551
00:22:20,730 --> 00:22:24,630
other apps permission<font color="#E5E5E5"> you want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get</font>

552
00:22:22,500 --> 00:22:26,160
really<font color="#E5E5E5"> crazy you could use some native</font>

553
00:22:24,630 --> 00:22:28,140
code and<font color="#E5E5E5"> patch this stuff in memory if</font>

554
00:22:26,160 --> 00:22:31,020
you<font color="#E5E5E5"> wanted</font><font color="#CCCCCC"> there's a lot of things you</font>

555
00:22:28,140 --> 00:22:32,730
could<font color="#CCCCCC"> do here so I also want to</font><font color="#E5E5E5"> thank my</font>

556
00:22:31,020 --> 00:22:35,040
mentor Brandon for a lot<font color="#E5E5E5"> of help and</font>

557
00:22:32,730 --> 00:22:36,450
mentoring on this<font color="#CCCCCC"> and yeah</font><font color="#E5E5E5"> let me know</font>

558
00:22:35,040 --> 00:22:38,490
if you have any questions my email<font color="#CCCCCC"> is</font>

559
00:22:36,450 --> 00:22:40,320
Ben at cyber merchants at<font color="#E5E5E5"> def calm or</font>

560
00:22:38,490 --> 00:22:45,230
you can follow<font color="#E5E5E5"> me</font><font color="#CCCCCC"> on Twitter at Ben</font>

561
00:22:40,320 --> 00:22:50,159
wrong yes question<font color="#CCCCCC"> the</font><font color="#E5E5E5"> great well thanks</font>

562
00:22:45,230 --> 00:22:52,020
<font color="#CCCCCC">so you said that the like each app has</font>

563
00:22:50,160 --> 00:22:55,080
<font color="#CCCCCC">its</font><font color="#E5E5E5"> own special place where</font><font color="#CCCCCC"> it can</font><font color="#E5E5E5"> store</font>

564
00:22:52,020 --> 00:22:56,520
things<font color="#CCCCCC"> yeah how big can that</font><font color="#E5E5E5"> space be as</font>

565
00:22:55,080 --> 00:22:58,230
big as you<font color="#CCCCCC"> want right so the original</font>

566
00:22:56,520 --> 00:23:00,000
<font color="#CCCCCC">idea was</font><font color="#E5E5E5"> like a lot of Android phones</font>

567
00:22:58,230 --> 00:23:02,100
had a really<font color="#CCCCCC"> really tiny like protected</font>

568
00:23:00,000 --> 00:23:04,590
storage and you had big storage<font color="#E5E5E5"> for like</font>

569
00:23:02,100 --> 00:23:07,139
<font color="#E5E5E5">other</font><font color="#CCCCCC"> things</font><font color="#E5E5E5"> mostly the phones now even</font>

570
00:23:04,590 --> 00:23:10,260
like the $50 Amazon<font color="#E5E5E5"> funds you have</font><font color="#CCCCCC"> like</font>

571
00:23:07,140 --> 00:23:18,090
40 gigs available<font color="#E5E5E5"> for internal right</font>

572
00:23:10,260 --> 00:23:20,850
yeah<font color="#CCCCCC"> gentleman and</font><font color="#E5E5E5"> with regard to</font>

573
00:23:18,090 --> 00:23:23,370
installing your<font color="#CCCCCC"> evilly apk isn't that</font>

574
00:23:20,850 --> 00:23:24,928
<font color="#E5E5E5">getting installed side by side with the</font>

575
00:23:23,370 --> 00:23:27,719
existing app because you're not able to

576
00:23:24,929 --> 00:23:29,340
<font color="#E5E5E5">spoof their signature on their apk right</font>

577
00:23:27,720 --> 00:23:32,070
otherwise<font color="#E5E5E5"> it would like if you try to</font>

578
00:23:29,340 --> 00:23:33,659
use the<font color="#E5E5E5"> same bundle identifier</font><font color="#CCCCCC"> yeah but</font>

579
00:23:32,070 --> 00:23:35,100
they don't<font color="#E5E5E5"> check the signature</font><font color="#CCCCCC"> right so</font>

580
00:23:33,660 --> 00:23:38,550
what's<font color="#E5E5E5"> really cool about Android though</font>

581
00:23:35,100 --> 00:23:40,560
<font color="#E5E5E5">right is</font><font color="#CCCCCC"> it's public private key crypto</font>

582
00:23:38,550 --> 00:23:42,300
<font color="#E5E5E5">right so unless they lose their private</font>

583
00:23:40,560 --> 00:23:44,820
key I can't masquerade as them<font color="#E5E5E5"> right</font>

584
00:23:42,300 --> 00:23:46,680
right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> smart developers right like the</font>

585
00:23:44,820 --> 00:23:48,659
<font color="#E5E5E5">ideal way</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> doing it is you</font><font color="#CCCCCC"> would</font><font color="#E5E5E5"> check</font>

586
00:23:46,680 --> 00:23:51,030
for that<font color="#E5E5E5"> right instead of doing like</font>

587
00:23:48,660 --> 00:23:52,620
that the hashes<font color="#CCCCCC"> over-the-air that'd be a</font>

588
00:23:51,030 --> 00:23:54,300
better way of doing<font color="#E5E5E5"> it</font><font color="#CCCCCC"> so you are able</font>

589
00:23:52,620 --> 00:23:57,540
<font color="#E5E5E5">to overwrite their apk when you install</font>

590
00:23:54,300 --> 00:23:59,850
your<font color="#E5E5E5"> evil one</font><font color="#CCCCCC"> no</font><font color="#E5E5E5"> both would exist right</font>

591
00:23:57,540 --> 00:24:02,030
you could probably delete things<font color="#CCCCCC"> in such</font>

592
00:23:59,850 --> 00:24:04,260
a<font color="#E5E5E5"> way where</font><font color="#CCCCCC"> that wouldn't</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> right</font>

593
00:24:02,030 --> 00:24:10,500
<font color="#CCCCCC">okay great question now by the way</font>

594
00:24:04,260 --> 00:24:13,460
thanks any other questions<font color="#CCCCCC"> okay thank</font>

595
00:24:10,500 --> 00:24:13,460
you hey thanks for<font color="#E5E5E5"> coming</font>

596
00:24:14,690 --> 00:24:18,239
[Applause]

