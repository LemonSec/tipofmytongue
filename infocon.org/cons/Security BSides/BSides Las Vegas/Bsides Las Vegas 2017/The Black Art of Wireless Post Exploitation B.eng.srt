1
00:00:00,000 --> 00:00:05,250
this is the<font color="#CCCCCC"> talk of</font><font color="#E5E5E5"> the black art</font>

2
00:00:01,520 --> 00:00:12,750
<font color="#CCCCCC">Wireless post exploitation post post</font>

3
00:00:05,250 --> 00:00:14,599
exploitation<font color="#E5E5E5"> yeah what I'd I'd like to</font>

4
00:00:12,750 --> 00:00:18,390
take<font color="#E5E5E5"> a few moments ask you a favor</font>

5
00:00:14,599 --> 00:00:21,750
these this<font color="#E5E5E5"> talk is being live-streamed</font>

6
00:00:18,390 --> 00:00:22,980
and as<font color="#E5E5E5"> as such I'd like you to take all</font>

7
00:00:21,750 --> 00:00:26,369
<font color="#CCCCCC">your</font><font color="#E5E5E5"> phones pull them out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> your</font>

8
00:00:22,980 --> 00:00:28,949
pockets<font color="#CCCCCC"> and</font><font color="#E5E5E5"> turn them down</font><font color="#CCCCCC"> we really</font>

9
00:00:26,369 --> 00:00:31,769
don't want<font color="#E5E5E5"> people</font><font color="#CCCCCC"> on YouTube listening</font>

10
00:00:28,949 --> 00:00:35,700
<font color="#E5E5E5">to your conversation that wouldn't be</font>

11
00:00:31,769 --> 00:00:38,640
nice<font color="#E5E5E5"> also if you have a question</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> have</font>

12
00:00:35,700 --> 00:00:40,649
the<font color="#E5E5E5"> audience mic</font><font color="#CCCCCC"> just raise your</font><font color="#E5E5E5"> hand</font><font color="#CCCCCC"> I</font>

13
00:00:38,640 --> 00:00:42,420
will<font color="#E5E5E5"> come over to you and bring you the</font>

14
00:00:40,649 --> 00:00:45,149
mic so everyone can hear<font color="#E5E5E5"> it and even the</font>

15
00:00:42,420 --> 00:00:47,340
people<font color="#CCCCCC"> that</font><font color="#E5E5E5"> on YouTube can hear it I'd</font>

16
00:00:45,149 --> 00:00:51,140
like<font color="#E5E5E5"> to thank all of our sponsors our</font>

17
00:00:47,340 --> 00:00:54,030
<font color="#CCCCCC">wonderful sponsors who are first bright</font>

18
00:00:51,140 --> 00:00:55,379
creativity tenable<font color="#E5E5E5"> Amazon and the source</font>

19
00:00:54,030 --> 00:00:56,550
of<font color="#CCCCCC"> knowledge and</font><font color="#E5E5E5"> this the first time</font>

20
00:00:55,379 --> 00:01:01,559
I've made it<font color="#CCCCCC"> through that without</font>

21
00:00:56,550 --> 00:01:03,870
<font color="#E5E5E5">screwing up the names so I would like to</font>

22
00:01:01,559 --> 00:01:15,509
<font color="#CCCCCC">introduce</font><font color="#E5E5E5"> you to</font><font color="#CCCCCC"> Solstice he's going to</font>

23
00:01:03,870 --> 00:01:18,539
be presenting<font color="#CCCCCC"> hi guys all right so this</font>

24
00:01:15,509 --> 00:01:20,820
is<font color="#CCCCCC"> ya talk title thing so my name is</font>

25
00:01:18,540 --> 00:01:22,619
Gabriel<font color="#CCCCCC"> Ryan</font><font color="#E5E5E5"> I'm a security engineer at</font>

26
00:01:20,820 --> 00:01:23,908
Gotham digital science<font color="#E5E5E5"> we're primarily a</font>

27
00:01:22,619 --> 00:01:26,280
security consulting firm we do some

28
00:01:23,909 --> 00:01:29,490
<font color="#E5E5E5">research as well</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> tend to specialize</font>

29
00:01:26,280 --> 00:01:33,090
in<font color="#E5E5E5"> knapsack infrastructure testing</font><font color="#CCCCCC"> do</font>

30
00:01:29,490 --> 00:01:34,619
some<font color="#CCCCCC"> red teaming stuff like that</font><font color="#E5E5E5"> so cool</font>

31
00:01:33,090 --> 00:01:36,540
new things in this presentation<font color="#CCCCCC"> I mean</font>

32
00:01:34,619 --> 00:01:37,799
we're<font color="#E5E5E5"> gonna be talking about two new</font>

33
00:01:36,540 --> 00:01:38,909
ways<font color="#CCCCCC"> to use rogue access</font><font color="#E5E5E5"> point</font><font color="#CCCCCC"> tax we're</font>

34
00:01:37,799 --> 00:01:40,829
going to talk about<font color="#E5E5E5"> hostile portal</font>

35
00:01:38,909 --> 00:01:41,970
attacks which are it's a method of

36
00:01:40,829 --> 00:01:44,548
stealing Active Directory credentials

37
00:01:41,970 --> 00:01:45,960
without network access<font color="#E5E5E5"> and we're also</font>

38
00:01:44,549 --> 00:01:47,670
going to look at indirect<font color="#E5E5E5"> Wireless</font>

39
00:01:45,960 --> 00:01:50,789
pivots which is a way<font color="#CCCCCC"> of bypassing port</font>

40
00:01:47,670 --> 00:01:53,610
<font color="#E5E5E5">based access controls using rogue access</font>

41
00:01:50,790 --> 00:01:55,079
point attacks so before we go<font color="#CCCCCC"> any</font>

42
00:01:53,610 --> 00:01:56,820
further<font color="#CCCCCC"> we kind</font><font color="#E5E5E5"> of have to do a little</font>

43
00:01:55,079 --> 00:01:59,189
background<font color="#E5E5E5"> info</font><font color="#CCCCCC"> first</font><font color="#E5E5E5"> we're gonna talk</font>

44
00:01:56,820 --> 00:02:00,990
about<font color="#E5E5E5"> is wpa2 EAP</font><font color="#CCCCCC"> how many people are</font>

45
00:01:59,189 --> 00:02:03,258
familiar<font color="#E5E5E5"> with the extensible</font>

46
00:02:00,990 --> 00:02:05,130
authentication protocol show<font color="#CCCCCC"> of hands</font>

47
00:02:03,259 --> 00:02:07,799
awesome<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> this is what I like to see</font>

48
00:02:05,130 --> 00:02:10,590
<font color="#E5E5E5">so I'm gonna fly through this stuff</font><font color="#CCCCCC"> so</font>

49
00:02:07,799 --> 00:02:12,270
as you may know in<font color="#E5E5E5"> order to talk</font><font color="#CCCCCC"> about</font>

50
00:02:10,590 --> 00:02:13,230
like EAP we really have to talk about

51
00:02:12,270 --> 00:02:14,250
<font color="#E5E5E5">rogue</font>

52
00:02:13,230 --> 00:02:17,129
<font color="#CCCCCC">oh</font><font color="#E5E5E5"> boy</font><font color="#CCCCCC"> tax because</font><font color="#E5E5E5"> that's a primary</font>

53
00:02:14,250 --> 00:02:19,200
attack vector that we use to to own it

54
00:02:17,129 --> 00:02:19,950
so rogue access point attacks<font color="#E5E5E5"> I mean</font>

55
00:02:19,200 --> 00:02:22,109
they're pretty<font color="#CCCCCC"> much like the bread and</font>

56
00:02:19,950 --> 00:02:23,190
butter<font color="#E5E5E5"> of modern wireless pen</font><font color="#CCCCCC"> tests you</font>

57
00:02:22,110 --> 00:02:26,220
know you've used<font color="#E5E5E5"> them to perform</font><font color="#CCCCCC"> an the</font>

58
00:02:23,190 --> 00:02:27,720
middle<font color="#E5E5E5"> attacks</font><font color="#CCCCCC"> steel radios creds do</font>

59
00:02:26,220 --> 00:02:28,769
like little fishing portals stuff like

60
00:02:27,720 --> 00:02:30,510
that

61
00:02:28,769 --> 00:02:32,519
and the way that they work at a

62
00:02:30,510 --> 00:02:34,349
fundamental level<font color="#CCCCCC"> you know let's say</font>

63
00:02:32,519 --> 00:02:35,700
that we have this any SSID let's say we

64
00:02:34,349 --> 00:02:37,470
have<font color="#E5E5E5"> like Starbucks Wi-Fi is the name of</font>

65
00:02:35,700 --> 00:02:39,328
<font color="#E5E5E5">our of our Wi-Fi network and its</font>

66
00:02:37,470 --> 00:02:41,790
operating on channel 6<font color="#E5E5E5"> you know if you</font>

67
00:02:39,329 --> 00:02:45,000
<font color="#E5E5E5">if an attacker creates a hotspot</font><font color="#CCCCCC"> using</font>

68
00:02:41,790 --> 00:02:46,890
the same SSID<font color="#CCCCCC"> and channel there's</font>

69
00:02:45,000 --> 00:02:48,989
actually<font color="#E5E5E5"> like you</font><font color="#CCCCCC"> know you might ask</font>

70
00:02:46,890 --> 00:02:50,010
yourself like how<font color="#CCCCCC"> can the wireless</font>

71
00:02:48,989 --> 00:02:50,970
clients that are<font color="#CCCCCC"> associated with its</font>

72
00:02:50,010 --> 00:02:52,260
access point<font color="#CCCCCC"> tell the difference between</font>

73
00:02:50,970 --> 00:02:54,120
the<font color="#CCCCCC"> legitimate axis pointing attackers</font>

74
00:02:52,260 --> 00:02:57,209
<font color="#CCCCCC">actively and the truth is that</font><font color="#E5E5E5"> they</font>

75
00:02:54,120 --> 00:02:58,620
<font color="#CCCCCC">actually can't and the the access</font><font color="#E5E5E5"> point</font>

76
00:02:57,209 --> 00:03:00,060
with the<font color="#CCCCCC"> soccer swing</font><font color="#E5E5E5"> signal strength is</font>

77
00:02:58,620 --> 00:03:01,879
the one that<font color="#E5E5E5"> will you know win so to</font>

78
00:03:00,060 --> 00:03:03,989
speak and and what will happen<font color="#CCCCCC"> is that</font>

79
00:03:01,879 --> 00:03:05,578
the wireless clients will actually

80
00:03:03,989 --> 00:03:07,230
reassociate with the attacker which

81
00:03:05,579 --> 00:03:08,549
gives the attacker<font color="#E5E5E5"> you know a man the</font>

82
00:03:07,230 --> 00:03:11,040
middle it gives them the capability<font color="#CCCCCC"> to</font>

83
00:03:08,549 --> 00:03:12,120
if you run radius which we'll talk<font color="#E5E5E5"> about</font>

84
00:03:11,040 --> 00:03:16,048
a second you<font color="#E5E5E5"> know to for some that</font>

85
00:03:12,120 --> 00:03:17,609
<font color="#E5E5E5">occasion so you know these attacks been</font>

86
00:03:16,049 --> 00:03:19,530
<font color="#CCCCCC">along around for a pretty long time I</font>

87
00:03:17,609 --> 00:03:21,000
mean<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> talking</font><font color="#CCCCCC"> like about at least</font>

88
00:03:19,530 --> 00:03:23,459
<font color="#E5E5E5">15 years at this point</font>

89
00:03:21,000 --> 00:03:26,010
the first documented<font color="#E5E5E5"> mentioned that I</font>

90
00:03:23,459 --> 00:03:29,790
could find for evil twin attacks for

91
00:03:26,010 --> 00:03:34,888
<font color="#E5E5E5">example was this as this Wireless LAN</font>

92
00:03:29,790 --> 00:03:37,410
security fact by w CW Klaus and and<font color="#E5E5E5"> that</font>

93
00:03:34,889 --> 00:03:40,530
was<font color="#CCCCCC"> actually mentioned</font><font color="#E5E5E5"> in the the talk</font>

94
00:03:37,410 --> 00:03:42,750
that came out in 2004<font color="#CCCCCC"> but the</font><font color="#E5E5E5"> idea is</font><font color="#CCCCCC"> o</font>

95
00:03:40,530 --> 00:03:45,810
<font color="#E5E5E5">V and</font><font color="#CCCCCC"> Shane McCauley about karma attacks</font>

96
00:03:42,750 --> 00:03:46,829
<font color="#E5E5E5">so I mean they go back pretty far</font><font color="#CCCCCC"> you</font>

97
00:03:45,810 --> 00:03:48,810
know later on<font color="#E5E5E5"> you have like the free</font>

98
00:03:46,829 --> 00:03:52,859
radius stuff by<font color="#E5E5E5"> Brandon</font><font color="#CCCCCC"> Tata wits and</font>

99
00:03:48,810 --> 00:03:55,349
and and Joshua right and then you know

100
00:03:52,859 --> 00:03:58,769
<font color="#E5E5E5">you know more recently you</font><font color="#CCCCCC"> know in</font><font color="#E5E5E5"> 2000</font>

101
00:03:55,349 --> 00:04:00,599
in 2014<font color="#CCCCCC"> Def Con</font><font color="#E5E5E5"> 22 a couple guys from</font>

102
00:03:58,769 --> 00:04:02,819
<font color="#E5E5E5">sense post</font><font color="#CCCCCC"> dominic</font><font color="#E5E5E5"> white and ian de</font>

103
00:04:00,599 --> 00:04:04,078
<font color="#CCCCCC">villiers</font><font color="#E5E5E5"> came out that manna toolkit if</font>

104
00:04:02,819 --> 00:04:06,268
you guys anyone ever played<font color="#CCCCCC"> with</font><font color="#E5E5E5"> that</font>

105
00:04:04,079 --> 00:04:07,709
<font color="#E5E5E5">yeah it's pretty</font><font color="#CCCCCC"> awesome it basically</font>

106
00:04:06,269 --> 00:04:10,139
<font color="#E5E5E5">they took the carbon tax</font><font color="#CCCCCC"> which had start</font>

107
00:04:07,709 --> 00:04:11,910
<font color="#E5E5E5">to</font><font color="#CCCCCC"> work less and less well over the over</font>

108
00:04:10,139 --> 00:04:13,199
<font color="#E5E5E5">the past decade and kind of made them</font>

109
00:04:11,910 --> 00:04:15,269
really really<font color="#E5E5E5"> relevant and really really</font>

110
00:04:13,199 --> 00:04:16,470
effective<font color="#E5E5E5"> again and also went</font><font color="#CCCCCC"> into some</font>

111
00:04:15,269 --> 00:04:18,810
<font color="#CCCCCC">ap stuff</font><font color="#E5E5E5"> which we'll talk about later</font>

112
00:04:16,470 --> 00:04:19,949
<font color="#CCCCCC">and then finally you know very recently</font>

113
00:04:18,810 --> 00:04:22,349
past couple months actually<font color="#E5E5E5"> we have</font>

114
00:04:19,949 --> 00:04:24,330
<font color="#E5E5E5">lower ten attacks which exploits some</font>

115
00:04:22,349 --> 00:04:26,570
some problems with Windows<font color="#CCCCCC"> tens Wi-Fi</font>

116
00:04:24,330 --> 00:04:28,039
sense capabilities

117
00:04:26,570 --> 00:04:30,710
and it's a totally<font color="#E5E5E5"> new type of attack</font>

118
00:04:28,040 --> 00:04:33,320
and<font color="#CCCCCC"> that the guy who who came up with</font>

119
00:04:30,710 --> 00:04:36,260
<font color="#E5E5E5">the Wi-Fi</font><font color="#CCCCCC"> Fisher tool</font><font color="#E5E5E5"> actually did this</font>

120
00:04:33,320 --> 00:04:38,210
<font color="#E5E5E5">fairly</font><font color="#CCCCCC"> recently</font><font color="#E5E5E5"> so I mean historically</font>

121
00:04:36,260 --> 00:04:40,250
<font color="#E5E5E5">though we've</font><font color="#CCCCCC"> had two primary uses for</font>

122
00:04:38,210 --> 00:04:44,539
<font color="#E5E5E5">rogue</font><font color="#CCCCCC"> ap attacks stealing credentials</font>

123
00:04:40,250 --> 00:04:47,030
<font color="#E5E5E5">and also you know breaching WPA EAP</font>

124
00:04:44,540 --> 00:04:48,530
networks<font color="#E5E5E5"> and and in this talk we're</font>

125
00:04:47,030 --> 00:04:49,549
actually going to<font color="#E5E5E5"> look</font><font color="#CCCCCC"> at something a</font>

126
00:04:48,530 --> 00:04:52,539
little different we're gonna look at<font color="#CCCCCC"> Rho</font>

127
00:04:49,550 --> 00:04:55,460
<font color="#CCCCCC">VP X that means a lateral</font><font color="#E5E5E5"> movement so</font>

128
00:04:52,540 --> 00:04:58,610
before we continue<font color="#CCCCCC"> we should talk also</font>

129
00:04:55,460 --> 00:05:00,260
about<font color="#E5E5E5"> evil twin attacks against wpa2 EAP</font>

130
00:04:58,610 --> 00:05:02,390
and specifically<font color="#E5E5E5"> let's talk about EAP</font>

131
00:05:00,260 --> 00:05:03,980
<font color="#E5E5E5">and how it works</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so you know</font>

132
00:05:02,390 --> 00:05:05,599
logically<font color="#E5E5E5"> and for those</font><font color="#CCCCCC"> of you who know</font>

133
00:05:03,980 --> 00:05:06,470
how he appears you're gonna call me<font color="#CCCCCC"> out</font>

134
00:05:05,600 --> 00:05:07,730
on<font color="#E5E5E5"> this because because there's</font>

135
00:05:06,470 --> 00:05:08,780
something<font color="#CCCCCC"> missing</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> deliberate</font>

136
00:05:07,730 --> 00:05:11,150
<font color="#E5E5E5">for those of us who don't know what it</font>

137
00:05:08,780 --> 00:05:12,380
how it works<font color="#CCCCCC"> I'm simplifying this a bit</font>

138
00:05:11,150 --> 00:05:14,870
<font color="#E5E5E5">I'll go over the more complex definition</font>

139
00:05:12,380 --> 00:05:16,670
later<font color="#CCCCCC"> but you know logically</font><font color="#E5E5E5"> from a very</font>

140
00:05:14,870 --> 00:05:18,890
high level<font color="#E5E5E5"> authentication occur occurs</font>

141
00:05:16,670 --> 00:05:20,510
between two<font color="#E5E5E5"> parties</font><font color="#CCCCCC"> you have the client</font>

142
00:05:18,890 --> 00:05:22,039
and the<font color="#E5E5E5"> authentication server</font><font color="#CCCCCC"> and you</font>

143
00:05:20,510 --> 00:05:23,150
know the<font color="#E5E5E5"> first thing that happens</font><font color="#CCCCCC"> to</font>

144
00:05:22,040 --> 00:05:26,270
this laser pointer thing works it

145
00:05:23,150 --> 00:05:28,880
doesn't<font color="#E5E5E5"> okay you have the client and the</font>

146
00:05:26,270 --> 00:05:30,159
authentication<font color="#E5E5E5"> server and the</font><font color="#CCCCCC"> the client</font>

147
00:05:28,880 --> 00:05:32,600
first<font color="#E5E5E5"> makes an authentication request</font>

148
00:05:30,160 --> 00:05:34,880
<font color="#CCCCCC">and the authentication server</font><font color="#E5E5E5"> then</font>

149
00:05:32,600 --> 00:05:37,130
responds with<font color="#CCCCCC"> x.509 for certificate and</font>

150
00:05:34,880 --> 00:05:41,360
<font color="#CCCCCC">the</font><font color="#E5E5E5"> purpose of that's x.509 certificate</font>

151
00:05:37,130 --> 00:05:43,730
is that the server is is proving<font color="#E5E5E5"> that it</font>

152
00:05:41,360 --> 00:05:46,700
is who it<font color="#E5E5E5"> says it is and if the client</font>

153
00:05:43,730 --> 00:05:48,650
<font color="#E5E5E5">accepts this and this is a big if then</font>

154
00:05:46,700 --> 00:05:50,090
we proceed from<font color="#E5E5E5"> we're just doing which</font>

155
00:05:48,650 --> 00:05:51,440
<font color="#E5E5E5">was the outer authentication now we're</font>

156
00:05:50,090 --> 00:05:54,229
<font color="#CCCCCC">looking</font><font color="#E5E5E5"> at the internal dedication layer</font>

157
00:05:51,440 --> 00:05:56,570
of EAP so you know if this is<font color="#E5E5E5"> EAP</font><font color="#CCCCCC"> TLS</font><font color="#E5E5E5"> or</font>

158
00:05:54,230 --> 00:05:58,880
EAP<font color="#E5E5E5"> peep</font><font color="#CCCCCC"> which is kind of what we're</font>

159
00:05:56,570 --> 00:06:00,260
<font color="#CCCCCC">going to</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> focusing</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> secure tunnel</font>

160
00:05:58,880 --> 00:06:01,670
will be established at<font color="#E5E5E5"> that point and</font>

161
00:06:00,260 --> 00:06:03,440
the intern authentication<font color="#E5E5E5"> will take</font>

162
00:06:01,670 --> 00:06:07,460
place<font color="#E5E5E5"> through that and the reason why we</font>

163
00:06:03,440 --> 00:06:08,330
<font color="#CCCCCC">use</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> secure tunnel</font><font color="#CCCCCC"> is that</font>

164
00:06:07,460 --> 00:06:10,810
everything that's<font color="#E5E5E5"> happening here</font>

165
00:06:08,330 --> 00:06:12,859
actually<font color="#CCCCCC"> is happening</font><font color="#E5E5E5"> over open wireless</font>

166
00:06:10,810 --> 00:06:14,660
<font color="#E5E5E5">technically you know the WPA doesn't</font>

167
00:06:12,860 --> 00:06:18,020
actually<font color="#E5E5E5"> kick in until this entire</font>

168
00:06:14,660 --> 00:06:19,880
process is<font color="#E5E5E5"> complete so you know older</font>

169
00:06:18,020 --> 00:06:21,530
<font color="#E5E5E5">versions of EAP we're actually</font>

170
00:06:19,880 --> 00:06:23,930
susceptible to attacks where you could

171
00:06:21,530 --> 00:06:25,729
just<font color="#E5E5E5"> sniff that entire transaction and</font>

172
00:06:23,930 --> 00:06:28,610
even do like replay attacks and stuff

173
00:06:25,730 --> 00:06:29,690
<font color="#E5E5E5">like that</font><font color="#CCCCCC"> you paid md5 comes to mind</font><font color="#E5E5E5"> you</font>

174
00:06:28,610 --> 00:06:32,390
know and<font color="#CCCCCC"> there</font><font color="#E5E5E5"> are actually tools out</font>

175
00:06:29,690 --> 00:06:34,850
there<font color="#CCCCCC"> for</font><font color="#E5E5E5"> example</font><font color="#CCCCCC"> the md5 hash by Josh</font>

176
00:06:32,390 --> 00:06:36,740
right does that<font color="#E5E5E5"> stuff and that's</font><font color="#CCCCCC"> a</font>

177
00:06:34,850 --> 00:06:38,450
<font color="#E5E5E5">really old attack by the way like a</font>

178
00:06:36,740 --> 00:06:39,680
<font color="#E5E5E5">decade old so you know I mentioned there</font>

179
00:06:38,450 --> 00:06:40,820
were two parties here<font color="#E5E5E5"> they're actually</font>

180
00:06:39,680 --> 00:06:41,930
<font color="#CCCCCC">three</font><font color="#E5E5E5"> there</font>

181
00:06:40,820 --> 00:06:43,310
the authentication server<font color="#E5E5E5"> and there's</font>

182
00:06:41,930 --> 00:06:44,690
the client which I mentioned the client

183
00:06:43,310 --> 00:06:46,820
is also<font color="#E5E5E5"> the technical term for that is</font><font color="#CCCCCC"> a</font>

184
00:06:44,690 --> 00:06:48,050
supplicant<font color="#CCCCCC"> but in the middle there</font>

185
00:06:46,820 --> 00:06:50,450
there's this authenticate or the

186
00:06:48,050 --> 00:06:51,320
Authenticator is<font color="#E5E5E5"> the access point</font><font color="#CCCCCC"> so all</font>

187
00:06:50,450 --> 00:06:53,690
this communication<font color="#CCCCCC"> between the</font>

188
00:06:51,320 --> 00:06:56,420
authentication server<font color="#E5E5E5"> and the supplicant</font>

189
00:06:53,690 --> 00:06:58,010
<font color="#CCCCCC">is</font><font color="#E5E5E5"> being in kind</font><font color="#CCCCCC"> of mediated by this</font>

190
00:06:56,420 --> 00:06:59,330
access point<font color="#CCCCCC"> and you know the</font>

191
00:06:58,010 --> 00:07:00,380
<font color="#E5E5E5">communication</font><font color="#CCCCCC"> between the</font><font color="#E5E5E5"> access point</font>

192
00:06:59,330 --> 00:07:01,880
<font color="#CCCCCC">and the radius server</font><font color="#E5E5E5"> that's happening</font>

193
00:07:00,380 --> 00:07:03,590
over<font color="#E5E5E5"> layer</font><font color="#CCCCCC"> seven much higher protocol</font>

194
00:07:01,880 --> 00:07:07,040
<font color="#E5E5E5">it's radius and everything going on</font>

195
00:07:03,590 --> 00:07:08,510
between the<font color="#E5E5E5"> the client and the access</font>

196
00:07:07,040 --> 00:07:11,140
point is happening at a much lower level

197
00:07:08,510 --> 00:07:13,880
that's that's going<font color="#E5E5E5"> over layer two so</font>

198
00:07:11,140 --> 00:07:16,880
really what you<font color="#E5E5E5"> need to do as a client</font>

199
00:07:13,880 --> 00:07:18,440
in order<font color="#E5E5E5"> to do this securely</font><font color="#CCCCCC"> is be able</font>

200
00:07:16,880 --> 00:07:20,120
<font color="#CCCCCC">to</font><font color="#E5E5E5"> trust the access point and as we</font>

201
00:07:18,440 --> 00:07:21,710
talked<font color="#CCCCCC"> about</font><font color="#E5E5E5"> earlier if you have</font><font color="#CCCCCC"> an open</font>

202
00:07:20,120 --> 00:07:23,390
access point<font color="#E5E5E5"> and all this is technically</font>

203
00:07:21,710 --> 00:07:24,919
having over<font color="#CCCCCC"> to</font><font color="#E5E5E5"> open</font><font color="#CCCCCC"> Wireless</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can't</font>

204
00:07:23,390 --> 00:07:26,599
because you you're vulnerable<font color="#E5E5E5"> to these</font>

205
00:07:24,920 --> 00:07:28,880
these rogue<font color="#E5E5E5"> ap attacks where you could</font>

206
00:07:26,600 --> 00:07:29,720
<font color="#E5E5E5">just spoof in the access point and</font><font color="#CCCCCC"> get</font>

207
00:07:28,880 --> 00:07:31,990
someone<font color="#E5E5E5"> to connect and</font><font color="#CCCCCC"> that's</font>

208
00:07:29,720 --> 00:07:34,250
essentially<font color="#E5E5E5"> how you how you historically</font>

209
00:07:31,990 --> 00:07:36,560
you<font color="#CCCCCC"> know how we've</font><font color="#E5E5E5"> taken advantage</font><font color="#CCCCCC"> of</font>

210
00:07:34,250 --> 00:07:37,850
this<font color="#E5E5E5"> of this protocol</font><font color="#CCCCCC"> because you know</font>

211
00:07:36,560 --> 00:07:39,380
you can actually<font color="#E5E5E5"> just create a rogue</font>

212
00:07:37,850 --> 00:07:41,630
access point<font color="#E5E5E5"> and run your own radio</font>

213
00:07:39,380 --> 00:07:42,680
server in the background<font color="#CCCCCC"> and</font><font color="#E5E5E5"> that will</font>

214
00:07:41,630 --> 00:07:45,050
<font color="#CCCCCC">just force clients to authenticate with</font>

215
00:07:42,680 --> 00:07:46,190
you and then you'll have via page<font color="#CCCCCC"> Hauser</font>

216
00:07:45,050 --> 00:07:46,940
<font color="#CCCCCC">response and you can crack and get</font>

217
00:07:46,190 --> 00:07:49,280
radius<font color="#CCCCCC"> Kratz</font>

218
00:07:46,940 --> 00:07:51,080
so quick demo<font color="#CCCCCC"> how that works by the</font><font color="#E5E5E5"> way</font>

219
00:07:49,280 --> 00:07:52,369
<font color="#E5E5E5">this is a video demo</font><font color="#CCCCCC"> for the new stuff</font>

220
00:07:51,080 --> 00:07:53,780
we're<font color="#CCCCCC"> gonna do live demos but we have</font>

221
00:07:52,370 --> 00:07:55,310
like a short amount<font color="#E5E5E5"> of time</font><font color="#CCCCCC"> to talk</font>

222
00:07:53,780 --> 00:07:58,190
<font color="#CCCCCC">about</font><font color="#E5E5E5"> all this stuff so to avoid</font>

223
00:07:55,310 --> 00:08:01,310
tempting the demo gods<font color="#E5E5E5"> we are going to</font>

224
00:07:58,190 --> 00:08:03,560
see it's<font color="#E5E5E5"> already going that way</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> I'm</font>

225
00:08:01,310 --> 00:08:05,720
<font color="#E5E5E5">gonna skip through this so essentially</font>

226
00:08:03,560 --> 00:08:08,630
what we're doing<font color="#CCCCCC"> here</font><font color="#E5E5E5"> is we're</font><font color="#CCCCCC"> just</font>

227
00:08:05,720 --> 00:08:10,100
<font color="#CCCCCC">creating a bogus certificate</font><font color="#E5E5E5"> because</font>

228
00:08:08,630 --> 00:08:13,700
<font color="#CCCCCC">remember we have to send that cert to</font>

229
00:08:10,100 --> 00:08:18,830
the to the client<font color="#CCCCCC"> and then we're</font><font color="#E5E5E5"> going</font>

230
00:08:13,700 --> 00:08:21,700
to create<font color="#CCCCCC"> our access point and</font><font color="#E5E5E5"> I'm</font>

231
00:08:18,830 --> 00:08:23,990
skipping through this at warp speed<font color="#CCCCCC"> and</font>

232
00:08:21,700 --> 00:08:26,180
you'll notice<font color="#E5E5E5"> here this</font><font color="#CCCCCC"> is the attackers</font>

233
00:08:23,990 --> 00:08:31,940
perspective<font color="#E5E5E5"> you see where we have</font>

234
00:08:26,180 --> 00:08:32,870
someone associated<font color="#CCCCCC"> and later on they're</font>

235
00:08:31,940 --> 00:08:33,799
<font color="#E5E5E5">going to try</font><font color="#CCCCCC"> to authenticate</font><font color="#E5E5E5"> with the</font>

236
00:08:32,870 --> 00:08:35,179
attacker<font color="#E5E5E5"> and then you'd</font><font color="#CCCCCC"> end up</font><font color="#E5E5E5"> with</font>

237
00:08:33,799 --> 00:08:36,890
<font color="#CCCCCC">something</font><font color="#E5E5E5"> that looks like this</font>

238
00:08:35,179 --> 00:08:38,989
there's a<font color="#CCCCCC"> user named challenger</font><font color="#E5E5E5"> response</font>

239
00:08:36,890 --> 00:08:43,069
<font color="#E5E5E5">and</font><font color="#CCCCCC"> that you could</font><font color="#E5E5E5"> just crack</font><font color="#CCCCCC"> it offline</font>

240
00:08:38,990 --> 00:08:46,280
<font color="#E5E5E5">and that's how you get your your plain</font>

241
00:08:43,070 --> 00:08:49,640
<font color="#CCCCCC">tax credentials so</font><font color="#E5E5E5"> that that's the</font>

242
00:08:46,280 --> 00:08:50,569
classic attack against<font color="#E5E5E5"> WPA EAP if you're</font>

243
00:08:49,640 --> 00:08:52,400
actually<font color="#CCCCCC"> trying</font><font color="#E5E5E5"> to gain access to that</font>

244
00:08:50,570 --> 00:08:54,110
<font color="#E5E5E5">kind of network the solution to this</font>

245
00:08:52,400 --> 00:08:54,350
which ironically enough was introduced

246
00:08:54,110 --> 00:08:55,970
into

247
00:08:54,350 --> 00:08:57,460
<font color="#E5E5E5">2008 which is where these these kinds</font><font color="#CCCCCC"> of</font>

248
00:08:55,970 --> 00:09:03,590
<font color="#E5E5E5">attacks really gain prevalence</font>

249
00:08:57,460 --> 00:09:05,960
implemented by RFC<font color="#CCCCCC"> 5216 but</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> ap</font><font color="#E5E5E5"> TLS</font>

250
00:09:03,590 --> 00:09:08,270
<font color="#CCCCCC">instead of you actually</font><font color="#E5E5E5"> had mutual</font>

251
00:09:05,960 --> 00:09:09,770
<font color="#E5E5E5">authentication not only on the internal</font>

252
00:09:08,270 --> 00:09:12,590
<font color="#CCCCCC">indication layer but on the outer</font>

253
00:09:09,770 --> 00:09:14,630
authentication layer as well<font color="#E5E5E5"> so the</font>

254
00:09:12,590 --> 00:09:15,980
server<font color="#CCCCCC"> will to</font><font color="#E5E5E5"> serve</font><font color="#CCCCCC"> in the</font><font color="#E5E5E5"> client needs</font>

255
00:09:14,630 --> 00:09:17,750
<font color="#E5E5E5">to have x.509 certificates that</font><font color="#CCCCCC"> they</font>

256
00:09:15,980 --> 00:09:20,240
<font color="#E5E5E5">send</font><font color="#CCCCCC"> to one another</font><font color="#E5E5E5"> and the strength</font>

257
00:09:17,750 --> 00:09:23,540
lies in<font color="#E5E5E5"> this mutual authentication but</font>

258
00:09:20,240 --> 00:09:26,390
unfortunately<font color="#CCCCCC"> how many people</font><font color="#E5E5E5"> here any</font>

259
00:09:23,540 --> 00:09:30,020
network administrator's out here<font color="#E5E5E5"> no</font><font color="#CCCCCC"> Neda</font>

260
00:09:26,390 --> 00:09:31,280
mints<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so like how many</font><font color="#E5E5E5"> people think</font>

261
00:09:30,020 --> 00:09:33,319
that<font color="#E5E5E5"> this is</font><font color="#CCCCCC"> like easy to implement</font><font color="#E5E5E5"> like</font>

262
00:09:31,280 --> 00:09:34,640
if you had to<font color="#CCCCCC"> go implement EAP</font><font color="#E5E5E5"> TLS on</font>

263
00:09:33,320 --> 00:09:35,930
the massive enterprise network yeah he's

264
00:09:34,640 --> 00:09:38,420
shaking his<font color="#E5E5E5"> head</font><font color="#CCCCCC"> like crazy he's like</font>

265
00:09:35,930 --> 00:09:40,880
<font color="#E5E5E5">enough and and that that is the problem</font>

266
00:09:38,420 --> 00:09:42,380
<font color="#E5E5E5">with this</font><font color="#CCCCCC"> EAP TLS it's very secure</font><font color="#E5E5E5"> it's</font>

267
00:09:40,880 --> 00:09:44,450
wildly unpopular<font color="#CCCCCC"> the reason</font><font color="#E5E5E5"> for that is</font>

268
00:09:42,380 --> 00:09:45,770
it's kind of<font color="#E5E5E5"> arduous to implement you</font>

269
00:09:44,450 --> 00:09:47,480
have to put a<font color="#E5E5E5"> client store on every</font>

270
00:09:45,770 --> 00:09:49,939
single<font color="#CCCCCC"> device on your network in order</font>

271
00:09:47,480 --> 00:09:51,440
<font color="#E5E5E5">for this to work and that can be a pain</font>

272
00:09:49,940 --> 00:09:54,020
<font color="#E5E5E5">and actually it's not always as simple</font>

273
00:09:51,440 --> 00:09:55,100
as that<font color="#E5E5E5"> because you may have network</font>

274
00:09:54,020 --> 00:09:57,340
endpoints particularly if you're<font color="#E5E5E5"> in a</font>

275
00:09:55,100 --> 00:09:59,450
very specialized industry like you know

276
00:09:57,340 --> 00:10:01,520
let's say you're in<font color="#CCCCCC"> the mining</font><font color="#E5E5E5"> industry</font>

277
00:09:59,450 --> 00:10:02,870
<font color="#E5E5E5">and you have mining equipment or let's</font>

278
00:10:01,520 --> 00:10:04,880
say<font color="#E5E5E5"> that you're working in</font><font color="#CCCCCC"> a hospital</font>

279
00:10:02,870 --> 00:10:06,080
and you have like MRI machine<font color="#E5E5E5"> this stuff</font>

280
00:10:04,880 --> 00:10:07,939
might not even<font color="#E5E5E5"> support client-side</font>

281
00:10:06,080 --> 00:10:10,520
<font color="#CCCCCC">service so it really is difficult to</font>

282
00:10:07,940 --> 00:10:12,050
implement<font color="#CCCCCC"> so you end up with</font><font color="#E5E5E5"> this this</font>

283
00:10:10,520 --> 00:10:14,240
classic security<font color="#E5E5E5"> versus convenience</font>

284
00:10:12,050 --> 00:10:15,829
scenario in<font color="#E5E5E5"> which you're kind of forced</font>

285
00:10:14,240 --> 00:10:18,500
<font color="#E5E5E5">to choose between authentication</font>

286
00:10:15,830 --> 00:10:21,290
mechanisms that have known weaknesses or

287
00:10:18,500 --> 00:10:23,540
a highly secure<font color="#CCCCCC"> butBut very impractical</font>

288
00:10:21,290 --> 00:10:26,180
<font color="#E5E5E5">or</font><font color="#CCCCCC"> seemingly impractical authentication</font>

289
00:10:23,540 --> 00:10:28,010
mechanism<font color="#E5E5E5"> and of course you know as you</font>

290
00:10:26,180 --> 00:10:29,120
<font color="#CCCCCC">can guess</font><font color="#E5E5E5"> there's a huge market gap is</font>

291
00:10:28,010 --> 00:10:30,230
<font color="#CCCCCC">that this creates you know</font><font color="#E5E5E5"> people start</font>

292
00:10:29,120 --> 00:10:32,540
coming<font color="#E5E5E5"> out the woodwork</font><font color="#CCCCCC"> trying to sell</font>

293
00:10:30,230 --> 00:10:36,140
you magic pills that can can kind<font color="#E5E5E5"> of</font>

294
00:10:32,540 --> 00:10:40,910
offer the the<font color="#E5E5E5"> convenience</font><font color="#CCCCCC"> and security</font>

295
00:10:36,140 --> 00:10:42,680
<font color="#E5E5E5">of both so along</font><font color="#CCCCCC"> that line the solution</font>

296
00:10:40,910 --> 00:10:44,000
or at least the<font color="#CCCCCC"> current trend</font><font color="#E5E5E5"> it seems</font>

297
00:10:42,680 --> 00:10:45,530
to<font color="#E5E5E5"> be that to focus on breach</font>

298
00:10:44,000 --> 00:10:48,770
containment<font color="#CCCCCC"> rather than than breach</font>

299
00:10:45,530 --> 00:10:49,670
<font color="#E5E5E5">prevention so instead</font><font color="#CCCCCC"> of instead of you</font>

300
00:10:48,770 --> 00:10:51,890
know<font color="#E5E5E5"> focusing on trying to keep</font>

301
00:10:49,670 --> 00:10:53,300
<font color="#E5E5E5">attackers from entering the network you</font>

302
00:10:51,890 --> 00:10:54,530
know you<font color="#E5E5E5"> basically make</font><font color="#CCCCCC"> sure they can't</font>

303
00:10:53,300 --> 00:10:56,240
<font color="#E5E5E5">really do anything dangerous wants to</font>

304
00:10:54,530 --> 00:10:59,300
get<font color="#E5E5E5"> there and the primary way</font><font color="#CCCCCC"> of doing</font>

305
00:10:56,240 --> 00:11:00,650
that<font color="#E5E5E5"> is what we're</font><font color="#CCCCCC"> going to we're pretty</font>

306
00:10:59,300 --> 00:11:01,640
<font color="#E5E5E5">much gonna be talking about you know</font>

307
00:11:00,650 --> 00:11:02,990
whether<font color="#CCCCCC"> or not</font><font color="#E5E5E5"> this actually works</font>

308
00:11:01,640 --> 00:11:08,300
<font color="#E5E5E5">particularly within a wired Wireless</font>

309
00:11:02,990 --> 00:11:09,920
context so so network access control

310
00:11:08,300 --> 00:11:11,930
isms<font color="#E5E5E5"> are actually like the the primary</font>

311
00:11:09,920 --> 00:11:13,099
way that<font color="#E5E5E5"> this this containment</font><font color="#CCCCCC"> problem</font>

312
00:11:11,930 --> 00:11:15,109
has been approached<font color="#E5E5E5"> so we're going to</font>

313
00:11:13,100 --> 00:11:17,360
<font color="#E5E5E5">talk</font><font color="#CCCCCC"> about some classic wireless access</font>

314
00:11:15,110 --> 00:11:18,350
control mechanisms<font color="#E5E5E5"> and I'm before we</font>

315
00:11:17,360 --> 00:11:23,480
continue<font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to present</font><font color="#E5E5E5"> you with</font>

316
00:11:18,350 --> 00:11:26,720
this it's lovely cartoon pretty<font color="#E5E5E5"> much</font>

317
00:11:23,480 --> 00:11:29,000
<font color="#E5E5E5">selves up might 50 on that but so let's</font>

318
00:11:26,720 --> 00:11:31,340
talk<font color="#CCCCCC"> about using of nax for for a</font>

319
00:11:29,000 --> 00:11:33,890
wireless breach containment<font color="#E5E5E5"> so you know</font>

320
00:11:31,340 --> 00:11:35,870
<font color="#CCCCCC">knack mechanisms they're</font><font color="#E5E5E5"> definitely said</font>

321
00:11:33,890 --> 00:11:37,430
one<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those popular methods</font><font color="#CCCCCC"> of this</font>

322
00:11:35,870 --> 00:11:39,530
approaching<font color="#E5E5E5"> this containment problem and</font>

323
00:11:37,430 --> 00:11:41,270
you know the<font color="#E5E5E5"> idea here is</font><font color="#CCCCCC"> that you can</font>

324
00:11:39,530 --> 00:11:43,100
use<font color="#E5E5E5"> an</font><font color="#CCCCCC"> act</font><font color="#E5E5E5"> to distinguish between an</font>

325
00:11:41,270 --> 00:11:44,750
authorized<font color="#E5E5E5"> and unauthorized</font><font color="#CCCCCC"> endpoint so</font>

326
00:11:43,100 --> 00:11:46,280
if an unauthorized endpoint<font color="#CCCCCC"> aka an</font>

327
00:11:44,750 --> 00:11:47,540
attacker enters your network you

328
00:11:46,280 --> 00:11:49,430
immediately put them in a quarantine

329
00:11:47,540 --> 00:11:51,380
jail<font color="#E5E5E5"> where presumably they can't</font>

330
00:11:49,430 --> 00:11:54,579
interact with<font color="#CCCCCC"> anything else and this</font>

331
00:11:51,380 --> 00:11:57,830
problem<font color="#E5E5E5"> is completely solved</font><font color="#CCCCCC"> you know so</font>

332
00:11:54,580 --> 00:11:59,770
the way that<font color="#CCCCCC"> this works is I kind of</font>

333
00:11:57,830 --> 00:12:01,970
<font color="#E5E5E5">just said this I'm</font><font color="#CCCCCC"> gonna skip this slide</font>

334
00:11:59,770 --> 00:12:04,010
so there are two varieties of<font color="#E5E5E5"> nack that</font>

335
00:12:01,970 --> 00:12:05,960
that we<font color="#E5E5E5"> you know has historically the</font>

336
00:12:04,010 --> 00:12:09,640
concern ourselves with the first<font color="#CCCCCC"> agent</font>

337
00:12:05,960 --> 00:12:11,630
<font color="#CCCCCC">based acts so an agent</font><font color="#E5E5E5"> is essentially a</font>

338
00:12:09,640 --> 00:12:13,699
software<font color="#CCCCCC"> component that you install on</font>

339
00:12:11,630 --> 00:12:16,220
every single<font color="#CCCCCC"> Network endpoint and</font><font color="#E5E5E5"> the</font>

340
00:12:13,700 --> 00:12:17,390
idea here<font color="#E5E5E5"> is a software component</font><font color="#CCCCCC"> you</font>

341
00:12:16,220 --> 00:12:19,070
know communicates with the<font color="#CCCCCC"> brain of the</font>

342
00:12:17,390 --> 00:12:20,930
neck and<font color="#E5E5E5"> you know because this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> very</font>

343
00:12:19,070 --> 00:12:22,310
secure<font color="#E5E5E5"> because if it has the agent on</font>

344
00:12:20,930 --> 00:12:24,050
there or communicate<font color="#CCCCCC"> with the with the</font>

345
00:12:22,310 --> 00:12:25,640
<font color="#CCCCCC">next brain and it will be authorized</font><font color="#E5E5E5"> if</font>

346
00:12:24,050 --> 00:12:27,709
it doesn't have it<font color="#E5E5E5"> it'll fail and it</font>

347
00:12:25,640 --> 00:12:29,060
will be quarantined<font color="#CCCCCC"> this is very</font>

348
00:12:27,710 --> 00:12:30,320
<font color="#CCCCCC">effective but</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> know once again we</font>

349
00:12:29,060 --> 00:12:32,060
have something<font color="#CCCCCC"> that we have to put on</font>

350
00:12:30,320 --> 00:12:33,560
every single<font color="#CCCCCC"> Network</font><font color="#E5E5E5"> endpoint in order</font>

351
00:12:32,060 --> 00:12:36,260
<font color="#E5E5E5">to get this to work</font><font color="#CCCCCC"> so it's nearly as</font>

352
00:12:33,560 --> 00:12:37,189
impractical<font color="#E5E5E5"> as</font><font color="#CCCCCC"> eap-tls and then we on</font>

353
00:12:36,260 --> 00:12:38,569
<font color="#E5E5E5">the other on the</font><font color="#CCCCCC"> other side</font><font color="#E5E5E5"> of the</font>

354
00:12:37,190 --> 00:12:40,460
<font color="#CCCCCC">spectrum we have agent listen acts so an</font>

355
00:12:38,570 --> 00:12:41,810
agentless<font color="#CCCCCC"> nak it's purely external you</font>

356
00:12:40,460 --> 00:12:44,060
don't actually have something<font color="#E5E5E5"> on</font><font color="#CCCCCC"> the on</font>

357
00:12:41,810 --> 00:12:47,359
<font color="#CCCCCC">the enact</font><font color="#E5E5E5"> system itself it's relying on</font>

358
00:12:44,060 --> 00:12:49,219
<font color="#E5E5E5">external fingerprinting passive scanning</font>

359
00:12:47,360 --> 00:12:51,770
and stuff like that and and<font color="#E5E5E5"> essentially</font>

360
00:12:49,220 --> 00:12:53,330
you know<font color="#E5E5E5"> the problem with this is</font><font color="#CCCCCC"> that</font>

361
00:12:51,770 --> 00:12:55,460
<font color="#E5E5E5">because it's not there's no internal</font>

362
00:12:53,330 --> 00:12:58,100
component you can't use an<font color="#CCCCCC"> agentless</font><font color="#E5E5E5"> nak</font>

363
00:12:55,460 --> 00:12:59,060
- and I'm leaving<font color="#E5E5E5"> out</font><font color="#CCCCCC"> next generation</font>

364
00:12:58,100 --> 00:13:01,010
next we're gonna talk<font color="#CCCCCC"> about those in a</font>

365
00:12:59,060 --> 00:13:04,010
second but traditionally<font color="#CCCCCC"> you've</font><font color="#E5E5E5"> not been</font>

366
00:13:01,010 --> 00:13:06,860
<font color="#CCCCCC">able to perform internal interrogations</font>

367
00:13:04,010 --> 00:13:08,300
<font color="#E5E5E5">using an agentless nak and so you can</font>

368
00:13:06,860 --> 00:13:10,150
easily<font color="#CCCCCC"> bypass them by masquerading as</font>

369
00:13:08,300 --> 00:13:12,620
<font color="#E5E5E5">authorized</font><font color="#CCCCCC"> advice but</font><font color="#E5E5E5"> it is convenient</font>

370
00:13:10,150 --> 00:13:14,300
<font color="#E5E5E5">so we return to recurring dilemma you</font>

371
00:13:12,620 --> 00:13:16,220
know we've decided to<font color="#E5E5E5"> focus on breach</font>

372
00:13:14,300 --> 00:13:17,750
containment as opposed to breach

373
00:13:16,220 --> 00:13:19,130
prevention but we still<font color="#E5E5E5"> are faced</font><font color="#CCCCCC"> with</font>

374
00:13:17,750 --> 00:13:20,780
<font color="#CCCCCC">this you know how do</font><font color="#E5E5E5"> we best approach</font>

375
00:13:19,130 --> 00:13:21,529
this and there's a still this this this

376
00:13:20,780 --> 00:13:22,790
<font color="#E5E5E5">kind of paradox</font>

377
00:13:21,529 --> 00:13:26,449
<font color="#E5E5E5">we're dealing</font><font color="#CCCCCC"> with security versus in</font>

378
00:13:22,790 --> 00:13:27,949
<font color="#E5E5E5">practicality and once again there's</font>

379
00:13:26,449 --> 00:13:29,599
<font color="#E5E5E5">another market gap that that is created</font>

380
00:13:27,949 --> 00:13:31,040
by this<font color="#E5E5E5"> although we're kind</font><font color="#CCCCCC"> of narrowing</font>

381
00:13:29,600 --> 00:13:32,600
<font color="#CCCCCC">our focus</font><font color="#E5E5E5"> a bit you know there's a high</font>

382
00:13:31,040 --> 00:13:34,730
demand<font color="#E5E5E5"> for a solution</font><font color="#CCCCCC"> that that offers</font>

383
00:13:32,600 --> 00:13:36,889
<font color="#CCCCCC">both the</font><font color="#E5E5E5"> the deep interrogation</font>

384
00:13:34,730 --> 00:13:39,259
capabilities<font color="#CCCCCC"> offered by an agent based</font>

385
00:13:36,889 --> 00:13:43,399
<font color="#E5E5E5">knack</font><font color="#CCCCCC"> but it has the convenience of an</font>

386
00:13:39,259 --> 00:13:44,930
agentless<font color="#CCCCCC"> knack</font><font color="#E5E5E5"> so you know the the</font><font color="#CCCCCC"> kind</font>

387
00:13:43,399 --> 00:13:46,850
of<font color="#E5E5E5"> the kind</font><font color="#CCCCCC"> of things that</font><font color="#E5E5E5"> that have</font>

388
00:13:44,930 --> 00:13:49,248
<font color="#E5E5E5">surfaced</font><font color="#CCCCCC"> to meet this need are these</font>

389
00:13:46,850 --> 00:13:51,589
<font color="#E5E5E5">next-generation</font><font color="#CCCCCC"> TAC appliances and I was</font>

390
00:13:49,249 --> 00:13:53,029
going to talk about one I actually could

391
00:13:51,589 --> 00:13:55,339
that I end up seeing<font color="#E5E5E5"> on pen tests a lot</font>

392
00:13:53,029 --> 00:13:59,300
so I actually opened a helpdesk ticket

393
00:13:55,339 --> 00:14:01,100
<font color="#E5E5E5">to see if I could borrow one and it's a</font>

394
00:13:59,300 --> 00:14:04,670
<font color="#CCCCCC">$10,000</font><font color="#E5E5E5"> network appliance and the answer</font>

395
00:14:01,100 --> 00:14:06,079
was yeah you can guess how that<font color="#E5E5E5"> what but</font>

396
00:14:04,670 --> 00:14:07,610
not<font color="#CCCCCC"> only that so that</font><font color="#E5E5E5"> far it wasn't</font><font color="#CCCCCC"> that</font>

397
00:14:06,079 --> 00:14:08,719
<font color="#CCCCCC">surprising but</font><font color="#E5E5E5"> you know that the part</font>

398
00:14:07,610 --> 00:14:10,069
<font color="#E5E5E5">that actually caught me</font><font color="#CCCCCC"> off-guard was</font>

399
00:14:08,720 --> 00:14:13,069
actually a<font color="#E5E5E5"> legal</font><font color="#CCCCCC"> department got involved</font>

400
00:14:10,069 --> 00:14:15,128
<font color="#E5E5E5">and so for the sake of being</font>

401
00:14:13,069 --> 00:14:16,849
<font color="#E5E5E5">vendor-neutral</font>

402
00:14:15,129 --> 00:14:18,110
we're<font color="#E5E5E5"> just</font><font color="#CCCCCC"> going</font><font color="#E5E5E5"> to you know if you</font>

403
00:14:16,850 --> 00:14:19,759
really really want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> know what's</font>

404
00:14:18,110 --> 00:14:20,899
particularly<font color="#CCCCCC"> Knack I'm talking about</font><font color="#E5E5E5"> you</font>

405
00:14:19,759 --> 00:14:22,279
could probably figure<font color="#E5E5E5"> it out using</font>

406
00:14:20,899 --> 00:14:23,540
<font color="#CCCCCC">Google and the attributes I'm talking</font>

407
00:14:22,279 --> 00:14:25,819
about but we're I'm gonna<font color="#E5E5E5"> be polite</font><font color="#CCCCCC"> and</font>

408
00:14:23,540 --> 00:14:28,519
call this vendor a for the race<font color="#E5E5E5"> in this</font>

409
00:14:25,819 --> 00:14:29,930
talk<font color="#E5E5E5"> and also hardware appliance a but</font>

410
00:14:28,519 --> 00:14:32,029
you know<font color="#E5E5E5"> one great example</font><font color="#CCCCCC"> of a</font>

411
00:14:29,930 --> 00:14:33,949
<font color="#E5E5E5">next-generation</font><font color="#CCCCCC"> nak appliance is there's</font>

412
00:14:32,029 --> 00:14:36,680
vendor<font color="#CCCCCC"> a and they use a dump</font><font color="#E5E5E5"> that they</font>

413
00:14:33,949 --> 00:14:38,120
use<font color="#CCCCCC"> WMI to interrogate devices and</font>

414
00:14:36,680 --> 00:14:39,680
that's pretty<font color="#CCCCCC"> cool</font><font color="#E5E5E5"> because you</font><font color="#CCCCCC"> can</font>

415
00:14:38,120 --> 00:14:41,689
perform you know these deep<font color="#CCCCCC"> internal</font>

416
00:14:39,680 --> 00:14:42,620
checks<font color="#E5E5E5"> without using an</font><font color="#CCCCCC"> agent and the</font>

417
00:14:41,689 --> 00:14:44,599
way that you do that is you just

418
00:14:42,620 --> 00:14:46,699
authenticate over<font color="#CCCCCC"> SNB</font><font color="#E5E5E5"> using a single</font>

419
00:14:44,600 --> 00:14:48,170
<font color="#E5E5E5">administrative service account and you</font>

420
00:14:46,699 --> 00:14:51,378
know service account<font color="#E5E5E5"> is given I'm</font>

421
00:14:48,170 --> 00:14:53,000
hearing some chuckles<font color="#E5E5E5"> so the service</font>

422
00:14:51,379 --> 00:14:54,769
account is<font color="#E5E5E5"> give</font><font color="#CCCCCC"> it remote login</font><font color="#E5E5E5"> access</font>

423
00:14:53,000 --> 00:14:57,259
to everything on the network<font color="#E5E5E5"> that is</font>

424
00:14:54,769 --> 00:14:59,149
authorized<font color="#E5E5E5"> and you know this allows the</font>

425
00:14:57,259 --> 00:15:00,949
device to do is checks and you<font color="#CCCCCC"> know it's</font>

426
00:14:59,149 --> 00:15:02,209
lovely seeing<font color="#E5E5E5"> these on pen tests because</font>

427
00:15:00,949 --> 00:15:05,628
it really<font color="#CCCCCC"> represents a single</font><font color="#E5E5E5"> point of</font>

428
00:15:02,209 --> 00:15:06,979
<font color="#E5E5E5">failure where you know you as an</font>

429
00:15:05,629 --> 00:15:08,480
attacker attempt to<font color="#CCCCCC"> access</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> network</font>

430
00:15:06,980 --> 00:15:12,500
and<font color="#E5E5E5"> you just have</font><font color="#CCCCCC"> God Mode hashes sent</font>

431
00:15:08,480 --> 00:15:13,970
to you so<font color="#CCCCCC"> thanks nak another threat to</font>

432
00:15:12,500 --> 00:15:15,110
<font color="#CCCCCC">this would</font><font color="#E5E5E5"> be</font><font color="#CCCCCC"> SIV</font><font color="#E5E5E5"> really attacks I</font><font color="#CCCCCC"> think</font>

433
00:15:13,970 --> 00:15:19,009
<font color="#CCCCCC">how many people are familiar with SMD</font>

434
00:15:15,110 --> 00:15:21,350
<font color="#E5E5E5">relay attacks I could good stuff</font><font color="#CCCCCC"> I'm</font>

435
00:15:19,009 --> 00:15:23,600
gonna there was about 50 / 50<font color="#CCCCCC"> % show of</font>

436
00:15:21,350 --> 00:15:26,059
hands so I'm<font color="#CCCCCC"> gonna touch</font><font color="#E5E5E5"> on this briefly</font>

437
00:15:23,600 --> 00:15:27,920
so a PPP<font color="#E5E5E5"> you know just much like EVP</font>

438
00:15:26,059 --> 00:15:30,980
bits of<font color="#E5E5E5"> challengers ntlm is a challenge</font>

439
00:15:27,920 --> 00:15:32,628
<font color="#E5E5E5">response mechanism</font><font color="#CCCCCC"> and the way it works</font>

440
00:15:30,980 --> 00:15:33,829
is that<font color="#E5E5E5"> the the client will initiate the</font>

441
00:15:32,629 --> 00:15:35,089
<font color="#E5E5E5">authentication</font><font color="#CCCCCC"> process and the server</font>

442
00:15:33,829 --> 00:15:38,120
will<font color="#E5E5E5"> respond with</font>

443
00:15:35,089 --> 00:15:39,589
<font color="#CCCCCC">a plain</font><font color="#E5E5E5"> text plain text string right and</font>

444
00:15:38,120 --> 00:15:40,970
the client that<font color="#E5E5E5"> this one has to encrypt</font>

445
00:15:39,589 --> 00:15:42,889
the plain text string and send it<font color="#E5E5E5"> back</font>

446
00:15:40,970 --> 00:15:46,009
<font color="#CCCCCC">to the server the server</font><font color="#E5E5E5"> then decrypt it</font>

447
00:15:42,889 --> 00:15:48,319
<font color="#E5E5E5">and if the decrypted string matches the</font>

448
00:15:46,009 --> 00:15:50,059
original saying that it's sent the

449
00:15:48,319 --> 00:15:51,979
authentication<font color="#E5E5E5"> process succeeds</font><font color="#CCCCCC"> so the</font>

450
00:15:50,059 --> 00:15:53,930
way<font color="#E5E5E5"> an SMB relay attack is you literally</font>

451
00:15:51,980 --> 00:15:57,050
just stick yourself<font color="#E5E5E5"> in the middle of</font>

452
00:15:53,930 --> 00:15:58,219
this process<font color="#CCCCCC"> and you know so you use</font>

453
00:15:57,050 --> 00:16:00,019
<font color="#E5E5E5">them and the middle attack or what have</font>

454
00:15:58,220 --> 00:16:01,279
<font color="#CCCCCC">you and the victim will try to Afeni</font>

455
00:16:00,019 --> 00:16:02,300
<font color="#CCCCCC">kate with what it thinks is the server</font>

456
00:16:01,279 --> 00:16:03,829
it's actually authenticating with you

457
00:16:02,300 --> 00:16:05,240
the attacker<font color="#E5E5E5"> and you just kind of</font>

458
00:16:03,829 --> 00:16:07,189
<font color="#CCCCCC">forward all this information</font><font color="#E5E5E5"> on to</font><font color="#CCCCCC"> the</font>

459
00:16:05,240 --> 00:16:09,410
<font color="#E5E5E5">to the destination the target and the</font>

460
00:16:07,189 --> 00:16:11,420
target<font color="#E5E5E5"> just you know sends that you the</font>

461
00:16:09,410 --> 00:16:13,339
response and<font color="#E5E5E5"> you then for the the</font>

462
00:16:11,420 --> 00:16:14,509
responses<font color="#E5E5E5"> back to the victim and</font><font color="#CCCCCC"> this</font>

463
00:16:13,339 --> 00:16:15,860
process<font color="#CCCCCC"> just kind</font><font color="#E5E5E5"> of goes</font><font color="#CCCCCC"> back</font><font color="#E5E5E5"> and forth</font>

464
00:16:14,509 --> 00:16:17,569
<font color="#CCCCCC">until eventually</font><font color="#E5E5E5"> what happens is that</font>

465
00:16:15,860 --> 00:16:18,860
<font color="#E5E5E5">you're authenticated with the target and</font>

466
00:16:17,569 --> 00:16:20,300
<font color="#CCCCCC">not the victim and by the way you can</font>

467
00:16:18,860 --> 00:16:21,559
specify the target<font color="#CCCCCC"> as anything</font><font color="#E5E5E5"> on the</font>

468
00:16:20,300 --> 00:16:23,029
network<font color="#CCCCCC"> that the victim has access to</font>

469
00:16:21,559 --> 00:16:25,040
doesn't<font color="#E5E5E5"> have to be the intended</font>

470
00:16:23,029 --> 00:16:26,329
destination<font color="#E5E5E5"> so of course you know you're</font>

471
00:16:25,040 --> 00:16:27,620
talking<font color="#CCCCCC"> about something that</font><font color="#E5E5E5"> an app</font>

472
00:16:26,329 --> 00:16:29,300
appliance where<font color="#E5E5E5"> you just</font><font color="#CCCCCC"> you know pop on</font>

473
00:16:27,620 --> 00:16:30,889
the network and sense you hashes well

474
00:16:29,300 --> 00:16:32,329
you know if they<font color="#E5E5E5"> don't</font><font color="#CCCCCC"> have SMB signing</font>

475
00:16:30,889 --> 00:16:34,730
turned off<font color="#E5E5E5"> well then you can just use</font>

476
00:16:32,329 --> 00:16:37,160
SMB relays to to<font color="#E5E5E5"> authenticate with just</font>

477
00:16:34,730 --> 00:16:38,920
<font color="#CCCCCC">about everything on there and you know</font>

478
00:16:37,160 --> 00:16:40,719
it's kind of cool because<font color="#CCCCCC"> you don't have</font>

479
00:16:38,920 --> 00:16:43,069
<font color="#E5E5E5">because there's no man</font><font color="#CCCCCC"> in the middle</font>

480
00:16:40,720 --> 00:16:45,800
<font color="#E5E5E5">necessary</font><font color="#CCCCCC"> because it sends you the</font>

481
00:16:43,069 --> 00:16:47,870
hashes it's even faster<font color="#CCCCCC"> so of course you</font>

482
00:16:45,800 --> 00:16:51,290
can<font color="#E5E5E5"> mitigate this by enabling SMB</font>

483
00:16:47,870 --> 00:16:53,389
signing<font color="#E5E5E5"> and you know honestly but the</font>

484
00:16:51,290 --> 00:16:57,199
thing is that<font color="#E5E5E5"> by</font><font color="#CCCCCC"> default</font><font color="#E5E5E5"> you know most</font>

485
00:16:53,389 --> 00:16:58,670
<font color="#CCCCCC">windows operating systems ship with SMB</font>

486
00:16:57,199 --> 00:17:00,649
signing turned off and the<font color="#E5E5E5"> reason why</font><font color="#CCCCCC"> I</font>

487
00:16:58,670 --> 00:17:01,998
<font color="#CCCCCC">sent</font><font color="#E5E5E5"> these signing ships feel the only</font>

488
00:17:00,649 --> 00:17:03,439
thing where it actually is<font color="#E5E5E5"> turned on by</font>

489
00:17:01,999 --> 00:17:04,819
default<font color="#CCCCCC"> is a domain controller and the</font>

490
00:17:03,439 --> 00:17:07,039
reason<font color="#E5E5E5"> for that is the group</font><font color="#CCCCCC"> policy is</font>

491
00:17:04,819 --> 00:17:08,389
actually downloaded<font color="#E5E5E5"> or</font><font color="#CCCCCC"> Vanover SNP so</font>

492
00:17:07,039 --> 00:17:10,459
that's I<font color="#CCCCCC"> think where</font><font color="#E5E5E5"> Microsoft drives</font>

493
00:17:08,390 --> 00:17:11,539
<font color="#E5E5E5">that draws the line and they're like you</font>

494
00:17:10,459 --> 00:17:14,659
<font color="#E5E5E5">know this is the one thing where's gonna</font>

495
00:17:11,539 --> 00:17:16,789
be enabled by<font color="#CCCCCC"> default</font><font color="#E5E5E5"> so you know and</font>

496
00:17:14,659 --> 00:17:17,600
and<font color="#CCCCCC"> by</font><font color="#E5E5E5"> the way there is a workaround</font><font color="#CCCCCC"> to</font>

497
00:17:16,789 --> 00:17:19,669
this if you<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> want to deal with</font>

498
00:17:17,599 --> 00:17:20,719
<font color="#E5E5E5">these issues vendor a does kindly</font>

499
00:17:19,669 --> 00:17:21,949
provide you with a piece<font color="#CCCCCC"> of</font><font color="#E5E5E5"> software</font>

500
00:17:20,720 --> 00:17:23,360
that<font color="#E5E5E5"> you can install in a oh wait that's</font>

501
00:17:21,949 --> 00:17:27,649
just<font color="#E5E5E5"> an agent again</font><font color="#CCCCCC"> so we're back to</font>

502
00:17:23,359 --> 00:17:29,330
<font color="#CCCCCC">square one so what I'm trying to say is</font>

503
00:17:27,648 --> 00:17:31,070
that there's no magic<font color="#E5E5E5"> bullet you know</font>

504
00:17:29,330 --> 00:17:33,289
there's you<font color="#CCCCCC"> can't</font><font color="#E5E5E5"> security you can have</font>

505
00:17:31,070 --> 00:17:34,279
convenience but<font color="#E5E5E5"> usually if you want both</font>

506
00:17:33,289 --> 00:17:36,020
there's going to be some<font color="#E5E5E5"> kind of</font>

507
00:17:34,279 --> 00:17:37,309
compromise made you know and I<font color="#E5E5E5"> think</font>

508
00:17:36,020 --> 00:17:39,320
that's like<font color="#CCCCCC"> a</font><font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> normal problem I</font>

509
00:17:37,309 --> 00:17:40,460
mean like it it's but I mean it's just

510
00:17:39,320 --> 00:17:42,439
<font color="#CCCCCC">something that we have to accept and be</font>

511
00:17:40,460 --> 00:17:45,500
honest<font color="#CCCCCC"> with ourselves about</font><font color="#E5E5E5"> when we're</font>

512
00:17:42,440 --> 00:17:48,420
designing security systems so what about

513
00:17:45,500 --> 00:17:50,340
client<font color="#E5E5E5"> isolation I mean this is another</font>

514
00:17:48,420 --> 00:17:51,930
wireless<font color="#E5E5E5"> security mechanism that that</font>

515
00:17:50,340 --> 00:17:53,909
gets<font color="#E5E5E5"> used a lot particularly</font><font color="#CCCCCC"> to open</font>

516
00:17:51,930 --> 00:17:56,700
networks actually because if you if you

517
00:17:53,910 --> 00:17:57,840
have<font color="#E5E5E5"> been on on the network here you</font>

518
00:17:56,700 --> 00:17:58,740
know you<font color="#E5E5E5"> might notice that you can't</font><font color="#CCCCCC"> pin</font>

519
00:17:57,840 --> 00:17:59,970
each other that's because there's

520
00:17:58,740 --> 00:18:01,290
something<font color="#E5E5E5"> called client isolation</font><font color="#CCCCCC"> and</font>

521
00:17:59,970 --> 00:18:02,730
<font color="#E5E5E5">all my guys</font><font color="#CCCCCC"> just realize I'm gonna</font><font color="#E5E5E5"> tell</font>

522
00:18:01,290 --> 00:18:07,159
you how<font color="#E5E5E5"> to bypass</font><font color="#CCCCCC"> that as we're at the</font>

523
00:18:02,730 --> 00:18:09,900
well<font color="#E5E5E5"> anyways they'll</font><font color="#CCCCCC"> assume me please</font>

524
00:18:07,160 --> 00:18:11,100
so wireless client isolation I mean the

525
00:18:09,900 --> 00:18:12,060
idea here<font color="#E5E5E5"> is that you prevent wireless</font>

526
00:18:11,100 --> 00:18:13,889
<font color="#E5E5E5">clients from communicating with one</font>

527
00:18:12,060 --> 00:18:14,790
<font color="#E5E5E5">another</font><font color="#CCCCCC"> this often uses security control</font>

528
00:18:13,890 --> 00:18:15,930
and you know it works<font color="#CCCCCC"> to a certain</font>

529
00:18:14,790 --> 00:18:19,170
<font color="#E5E5E5">extent because there's a lot of trouble</font>

530
00:18:15,930 --> 00:18:21,390
to go<font color="#CCCCCC"> through to the bypass this so the</font>

531
00:18:19,170 --> 00:18:22,890
<font color="#E5E5E5">way</font><font color="#CCCCCC"> 8'o 2.11 supposed to work</font><font color="#E5E5E5"> so the AP</font>

532
00:18:21,390 --> 00:18:24,810
is supposed to mediate all communication

533
00:18:22,890 --> 00:18:26,370
<font color="#E5E5E5">between you know various</font><font color="#CCCCCC"> network</font>

534
00:18:24,810 --> 00:18:28,850
endpoints and<font color="#E5E5E5"> you know this this</font><font color="#CCCCCC"> works</font>

535
00:18:26,370 --> 00:18:31,560
<font color="#E5E5E5">because everything has to pass to the AP</font>

536
00:18:28,850 --> 00:18:33,120
supposedly and and because of<font color="#E5E5E5"> that the</font>

537
00:18:31,560 --> 00:18:36,179
AP can dictate who you<font color="#E5E5E5"> can and cannot</font>

538
00:18:33,120 --> 00:18:38,280
talk<font color="#E5E5E5"> to the the problem is the client</font>

539
00:18:36,180 --> 00:18:39,480
isolation at least in a wired<font color="#E5E5E5"> this isn't</font>

540
00:18:38,280 --> 00:18:41,430
<font color="#CCCCCC">a so external wired</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> about our</font>

541
00:18:39,480 --> 00:18:43,350
wireless network it's a logical control

542
00:18:41,430 --> 00:18:45,240
not a physical control<font color="#E5E5E5"> you know the the</font>

543
00:18:43,350 --> 00:18:46,740
<font color="#CCCCCC">the problem of how do you</font><font color="#E5E5E5"> know the</font>

544
00:18:45,240 --> 00:18:48,000
problem is<font color="#E5E5E5"> like how do you keep multiple</font>

545
00:18:46,740 --> 00:18:49,530
radio transceivers from communicating

546
00:18:48,000 --> 00:18:51,300
<font color="#E5E5E5">with one another</font><font color="#CCCCCC"> and a really awesome</font>

547
00:18:49,530 --> 00:18:55,230
researcher he's no longer with<font color="#E5E5E5"> us but</font>

548
00:18:51,300 --> 00:18:57,360
<font color="#E5E5E5">you know he was great in 2005 his answer</font>

549
00:18:55,230 --> 00:18:59,580
<font color="#E5E5E5">was you can't and he wrote this really</font>

550
00:18:57,360 --> 00:19:00,929
<font color="#E5E5E5">cool tool called</font><font color="#CCCCCC"> Wi-Fi tap where</font>

551
00:18:59,580 --> 00:19:04,560
essentially<font color="#E5E5E5"> what it does</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> it just</font>

552
00:19:00,930 --> 00:19:08,130
injects challenges and injects responses

553
00:19:04,560 --> 00:19:10,020
to packets coming<font color="#E5E5E5"> from</font><font color="#CCCCCC"> it'll</font><font color="#E5E5E5"> use a</font>

554
00:19:08,130 --> 00:19:11,550
modern remote interface<font color="#E5E5E5"> to sniff</font><font color="#CCCCCC"> for</font>

555
00:19:10,020 --> 00:19:12,990
packets<font color="#E5E5E5"> coming from wireless clients on</font>

556
00:19:11,550 --> 00:19:14,490
the target<font color="#CCCCCC"> network and then inject</font>

557
00:19:12,990 --> 00:19:16,140
responses as if they came<font color="#CCCCCC"> from the AP</font>

558
00:19:14,490 --> 00:19:18,480
<font color="#CCCCCC">and the result of this is that you can</font>

559
00:19:16,140 --> 00:19:20,100
<font color="#CCCCCC">actually bypass client isolation</font><font color="#E5E5E5"> now and</font>

560
00:19:18,480 --> 00:19:22,110
actually<font color="#CCCCCC"> give you like a pretty</font><font color="#E5E5E5"> cool</font>

561
00:19:20,100 --> 00:19:23,429
<font color="#CCCCCC">like</font><font color="#E5E5E5"> ton tap device that you can use to</font>

562
00:19:22,110 --> 00:19:26,580
interact<font color="#E5E5E5"> with the network fully without</font>

563
00:19:23,430 --> 00:19:27,750
even being associated<font color="#E5E5E5"> with it so you</font>

564
00:19:26,580 --> 00:19:30,149
know there are<font color="#CCCCCC"> also later tools that let</font>

565
00:19:27,750 --> 00:19:32,580
you<font color="#E5E5E5"> do this by the way the aircraft</font>

566
00:19:30,150 --> 00:19:34,530
crack suite has some awesome<font color="#CCCCCC"> they have</font>

567
00:19:32,580 --> 00:19:36,600
air ton and also air tkip<font color="#E5E5E5"> ng which let</font>

568
00:19:34,530 --> 00:19:39,030
you do with with weapon and WPA<font color="#CCCCCC"> one</font>

569
00:19:36,600 --> 00:19:40,860
<font color="#E5E5E5">there's also this thing</font><font color="#CCCCCC"> called</font><font color="#E5E5E5"> whole</font><font color="#CCCCCC"> 91</font>

570
00:19:39,030 --> 00:19:43,260
<font color="#CCCCCC">96 which apparently you</font><font color="#E5E5E5"> can use it to do</font>

571
00:19:40,860 --> 00:19:44,790
this for wpa2<font color="#CCCCCC"> I've never seen it work</font>

572
00:19:43,260 --> 00:19:47,160
and it's debatable whether it<font color="#CCCCCC"> actually</font>

573
00:19:44,790 --> 00:19:49,020
does<font color="#E5E5E5"> but whatever I figure for being</font>

574
00:19:47,160 --> 00:19:52,050
thorough I should probably mention it

575
00:19:49,020 --> 00:19:54,510
once<font color="#E5E5E5"> again another speedy video demo</font>

576
00:19:52,050 --> 00:19:56,100
here up<font color="#E5E5E5"> the</font><font color="#CCCCCC"> right-hand corner here</font>

577
00:19:54,510 --> 00:19:58,460
<font color="#CCCCCC">anymore everyone see</font><font color="#E5E5E5"> my mouse with me</font>

578
00:19:56,100 --> 00:20:00,750
<font color="#CCCCCC">around frantically okay cool</font>

579
00:19:58,460 --> 00:20:02,220
top right corner we're<font color="#CCCCCC"> going to create a</font>

580
00:20:00,750 --> 00:20:05,159
an access<font color="#E5E5E5"> point</font>

581
00:20:02,220 --> 00:20:06,750
and so you<font color="#E5E5E5"> just create an access point</font>

582
00:20:05,159 --> 00:20:09,000
we're<font color="#E5E5E5"> going to connect to it from</font><font color="#CCCCCC"> our</font>

583
00:20:06,750 --> 00:20:11,250
<font color="#E5E5E5">host OS and the host</font><font color="#CCCCCC"> OS so I've got</font>

584
00:20:09,000 --> 00:20:14,759
<font color="#CCCCCC">three you know two VMs going</font><font color="#E5E5E5"> on here</font><font color="#CCCCCC"> has</font>

585
00:20:11,250 --> 00:20:18,929
a terminal open the bottom right<font color="#E5E5E5"> and you</font>

586
00:20:14,759 --> 00:20:21,600
can kind of see<font color="#CCCCCC"> should I get</font><font color="#E5E5E5"> the yeah</font>

587
00:20:18,929 --> 00:20:23,460
that's that's<font color="#E5E5E5"> me associated with it so</font>

588
00:20:21,600 --> 00:20:25,769
in the bottom<font color="#E5E5E5"> right I'm gonna send ICMP</font>

589
00:20:23,460 --> 00:20:27,299
packets to the<font color="#E5E5E5"> access</font><font color="#CCCCCC"> point and you</font>

590
00:20:25,769 --> 00:20:29,340
notice<font color="#CCCCCC"> they're you know</font><font color="#E5E5E5"> there are five</font>

591
00:20:27,299 --> 00:20:32,549
pack ICMP packets<font color="#E5E5E5"> sent in five responses</font>

592
00:20:29,340 --> 00:20:35,730
<font color="#CCCCCC">so in</font><font color="#E5E5E5"> this terminal over to the left</font><font color="#CCCCCC"> you</font>

593
00:20:32,549 --> 00:20:37,679
know we have we're gonna run<font color="#E5E5E5"> something</font>

594
00:20:35,730 --> 00:20:39,629
<font color="#CCCCCC">called Wi-Fi ping it's just a</font><font color="#E5E5E5"> modified</font>

595
00:20:37,679 --> 00:20:40,740
version of Wi-Fi<font color="#E5E5E5"> tap that exists it's</font>

596
00:20:39,629 --> 00:20:42,090
kind of<font color="#E5E5E5"> a proof of concept but what it's</font>

597
00:20:40,740 --> 00:20:45,570
going to<font color="#E5E5E5"> do is any</font><font color="#CCCCCC"> time it sees</font><font color="#E5E5E5"> an ICMP</font>

598
00:20:42,090 --> 00:20:46,889
packet<font color="#E5E5E5"> it's going to respond and this</font>

599
00:20:45,570 --> 00:20:50,070
just kind<font color="#CCCCCC"> of proves</font><font color="#E5E5E5"> that this is</font>

600
00:20:46,889 --> 00:20:52,340
possible<font color="#E5E5E5"> so notice here we're gonna</font>

601
00:20:50,070 --> 00:20:55,500
we're running Wi-Fi<font color="#CCCCCC"> pain on the</font><font color="#E5E5E5"> left and</font>

602
00:20:52,340 --> 00:20:56,970
we're now going to run Wi-Fi<font color="#E5E5E5"> we just</font>

603
00:20:55,500 --> 00:20:58,620
made the use<font color="#E5E5E5"> of these five ICMP packets</font>

604
00:20:56,970 --> 00:21:00,419
and notice here that we<font color="#CCCCCC"> have all</font><font color="#E5E5E5"> these</font>

605
00:20:58,620 --> 00:21:01,830
messages<font color="#E5E5E5"> that</font><font color="#CCCCCC"> say duplicate and we have</font>

606
00:21:00,419 --> 00:21:05,279
<font color="#E5E5E5">ten responses and that's because we're</font>

607
00:21:01,830 --> 00:21:06,480
actually<font color="#E5E5E5"> sending ICMP packets to the AP</font>

608
00:21:05,279 --> 00:21:08,610
without even actually being on the

609
00:21:06,480 --> 00:21:10,139
<font color="#E5E5E5">network and it's or not to be</font><font color="#CCCCCC"> ap I'm</font>

610
00:21:08,610 --> 00:21:13,860
sorry to the client is it without

611
00:21:10,139 --> 00:21:15,240
<font color="#CCCCCC">actually being on</font><font color="#E5E5E5"> the network so back to</font>

612
00:21:13,860 --> 00:21:16,830
<font color="#CCCCCC">knacks and</font><font color="#E5E5E5"> actually access control</font><font color="#CCCCCC"> and</font>

613
00:21:15,240 --> 00:21:18,210
breach containment<font color="#CCCCCC"> Food</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> Thought</font>

614
00:21:16,830 --> 00:21:20,370
you know we've been<font color="#E5E5E5"> we've been we talked</font>

615
00:21:18,210 --> 00:21:22,049
a little<font color="#E5E5E5"> bit about whether or not you</font>

616
00:21:20,370 --> 00:21:24,178
know<font color="#CCCCCC"> knacks are effective at being</font><font color="#E5E5E5"> next</font>

617
00:21:22,049 --> 00:21:27,149
and<font color="#CCCCCC"> I think that that's a valid</font>

618
00:21:24,179 --> 00:21:30,659
discussion<font color="#CCCCCC"> to have but what if we're</font>

619
00:21:27,149 --> 00:21:31,739
missing<font color="#CCCCCC"> the point here you know nack</font><font color="#E5E5E5"> is</font>

620
00:21:30,659 --> 00:21:33,990
<font color="#CCCCCC">in</font><font color="#E5E5E5"> the only problem you know the role of</font>

621
00:21:31,740 --> 00:21:35,580
<font color="#E5E5E5">nack</font><font color="#CCCCCC"> and containing a wireless breach is</font>

622
00:21:33,990 --> 00:21:37,830
<font color="#CCCCCC">to prevent</font><font color="#E5E5E5"> attackers from preventing</font>

623
00:21:35,580 --> 00:21:39,320
resources after<font color="#E5E5E5"> from accessing</font><font color="#CCCCCC"> intensive</font>

624
00:21:37,830 --> 00:21:41,460
resources after<font color="#CCCCCC"> the breach occurs and</font>

625
00:21:39,320 --> 00:21:43,320
you know what an authorized endpoint is

626
00:21:41,460 --> 00:21:44,190
detected<font color="#E5E5E5"> the idea is that the endpoint</font>

627
00:21:43,320 --> 00:21:45,840
<font color="#E5E5E5">would be placed in some kind of</font>

628
00:21:44,190 --> 00:21:49,470
quarantine<font color="#CCCCCC"> and that the port will be</font>

629
00:21:45,840 --> 00:21:51,090
blocked and and you know when<font color="#E5E5E5"> you</font>

630
00:21:49,470 --> 00:21:52,919
violate that<font color="#E5E5E5"> these access control</font>

631
00:21:51,090 --> 00:21:54,689
policies<font color="#E5E5E5"> this will cause an act to</font>

632
00:21:52,919 --> 00:21:55,710
impose some kind<font color="#CCCCCC"> of restriction</font><font color="#E5E5E5"> in a</font>

633
00:21:54,690 --> 00:21:57,450
wired<font color="#E5E5E5"> network this</font><font color="#CCCCCC"> is a physical</font>

634
00:21:55,710 --> 00:21:59,279
<font color="#E5E5E5">restriction in a wireless network though</font>

635
00:21:57,450 --> 00:22:00,600
<font color="#E5E5E5">as we saw earlier</font><font color="#CCCCCC"> these</font><font color="#E5E5E5"> kinds of</font>

636
00:21:59,279 --> 00:22:02,970
restrictions can only be logical

637
00:22:00,600 --> 00:22:05,129
<font color="#E5E5E5">district restrictions</font><font color="#CCCCCC"> well we'll talk</font>

638
00:22:02,970 --> 00:22:07,409
more about<font color="#E5E5E5"> that later so I think to kind</font>

639
00:22:05,129 --> 00:22:09,689
of to kind<font color="#CCCCCC"> of like understand you know</font>

640
00:22:07,409 --> 00:22:10,799
where we're going with this it's best

641
00:22:09,690 --> 00:22:12,450
understood through<font color="#CCCCCC"> the scenario you know</font>

642
00:22:10,799 --> 00:22:13,918
<font color="#E5E5E5">we're attacking a wireless network let's</font>

643
00:22:12,450 --> 00:22:14,669
use to access<font color="#E5E5E5"> sensitive resources</font><font color="#CCCCCC"> and</font>

644
00:22:13,919 --> 00:22:15,640
we've already breached the perimeter

645
00:22:14,669 --> 00:22:17,440
using<font color="#E5E5E5"> that attack</font>

646
00:22:15,640 --> 00:22:19,090
earlier<font color="#E5E5E5"> and we end up in</font><font color="#CCCCCC"> a situation</font>

647
00:22:17,440 --> 00:22:20,500
<font color="#E5E5E5">like this where there's</font><font color="#CCCCCC"> a knack involved</font>

648
00:22:19,090 --> 00:22:22,449
and they place this on a quarantine<font color="#E5E5E5"> VLAN</font>

649
00:22:20,500 --> 00:22:24,010
<font color="#E5E5E5">as a restricted VLAN which is what we're</font>

650
00:22:22,450 --> 00:22:25,270
<font color="#E5E5E5">trying to get into and of course there's</font>

651
00:22:24,010 --> 00:22:26,500
sorts of VLAN you have your<font color="#E5E5E5"> sensitive</font>

652
00:22:25,270 --> 00:22:27,970
resources<font color="#E5E5E5"> which are the goodies we're</font>

653
00:22:26,500 --> 00:22:30,160
trying to get but<font color="#E5E5E5"> we can't because we're</font>

654
00:22:27,970 --> 00:22:34,390
stuck over here<font color="#E5E5E5"> so the question</font><font color="#CCCCCC"> is how</font>

655
00:22:30,160 --> 00:22:34,900
do we<font color="#E5E5E5"> get out</font><font color="#CCCCCC"> of this well</font><font color="#E5E5E5"> before</font><font color="#CCCCCC"> we go</font>

656
00:22:34,390 --> 00:22:36,730
any further

657
00:22:34,900 --> 00:22:38,950
who knows how NetBIOS name<font color="#CCCCCC"> resolution</font>

658
00:22:36,730 --> 00:22:39,370
works and LM an RnB T&S poisoning<font color="#CCCCCC"> does</font>

659
00:22:38,950 --> 00:22:41,890
anyone

660
00:22:39,370 --> 00:22:44,379
okay<font color="#E5E5E5"> let's hands cool</font><font color="#CCCCCC"> to talk about this</font>

661
00:22:41,890 --> 00:22:46,030
more so the way NetBIOS name<font color="#CCCCCC"> resolution</font>

662
00:22:44,380 --> 00:22:47,860
works or<font color="#E5E5E5"> basically windows name</font>

663
00:22:46,030 --> 00:22:49,270
resolution<font color="#E5E5E5"> the first thing that happens</font>

664
00:22:47,860 --> 00:22:50,800
<font color="#E5E5E5">is the computer will when it's trying to</font>

665
00:22:49,270 --> 00:22:52,270
look up<font color="#E5E5E5"> a NetBIOS name it will try to</font>

666
00:22:50,800 --> 00:22:54,460
<font color="#E5E5E5">check the local cache in the lmhosts</font>

667
00:22:52,270 --> 00:22:56,590
file locally<font color="#CCCCCC"> if that fails it will</font><font color="#E5E5E5"> try</font>

668
00:22:54,460 --> 00:22:58,840
local DNS<font color="#CCCCCC"> that remote DNS servers local</font>

669
00:22:56,590 --> 00:23:01,149
ones and then you know if those three

670
00:22:58,840 --> 00:23:03,189
<font color="#E5E5E5">steps fail it will do what's called an</font>

671
00:23:01,150 --> 00:23:04,300
LM in<font color="#CCCCCC"> R or MB T and s prod these</font><font color="#E5E5E5"> are</font>

672
00:23:03,190 --> 00:23:05,950
actually two<font color="#E5E5E5"> separate protocols but</font>

673
00:23:04,300 --> 00:23:07,629
<font color="#E5E5E5">they're they're logically very similar</font>

674
00:23:05,950 --> 00:23:09,910
and the implication of the same<font color="#CCCCCC"> so</font><font color="#E5E5E5"> kind</font>

675
00:23:07,630 --> 00:23:11,740
of lump up together<font color="#CCCCCC"> but it will use</font>

676
00:23:09,910 --> 00:23:14,260
element<font color="#CCCCCC"> RMB TNS to make a broadcast</font>

677
00:23:11,740 --> 00:23:17,860
request<font color="#E5E5E5"> to the entire subnet and you</font>

678
00:23:14,260 --> 00:23:19,210
know the<font color="#E5E5E5"> idea is that at that point the</font>

679
00:23:17,860 --> 00:23:20,969
correct<font color="#E5E5E5"> host that is trying to</font><font color="#CCCCCC"> look for</font>

680
00:23:19,210 --> 00:23:24,670
<font color="#E5E5E5">will respond with it with its IP address</font>

681
00:23:20,970 --> 00:23:28,030
<font color="#E5E5E5">if</font><font color="#CCCCCC"> you if you've ever heard of ARP</font><font color="#E5E5E5"> this</font>

682
00:23:24,670 --> 00:23:29,290
sounds very<font color="#CCCCCC"> similar and well</font><font color="#E5E5E5"> we'll see</font>

683
00:23:28,030 --> 00:23:30,610
in a second<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> best way to</font>

684
00:23:29,290 --> 00:23:32,139
understand the problem<font color="#E5E5E5"> of this is once</font>

685
00:23:30,610 --> 00:23:33,580
<font color="#CCCCCC">again through example</font><font color="#E5E5E5"> you know we have</font>

686
00:23:32,140 --> 00:23:35,620
two<font color="#E5E5E5"> windows computers named</font><font color="#CCCCCC"> Allison</font>

687
00:23:33,580 --> 00:23:37,510
<font color="#CCCCCC">Leroy</font><font color="#E5E5E5"> you know</font><font color="#CCCCCC"> Alice is trying to send</font>

688
00:23:35,620 --> 00:23:40,090
something<font color="#E5E5E5"> to Leroy or or or authenticate</font>

689
00:23:37,510 --> 00:23:41,350
with with Leroy<font color="#E5E5E5"> and you know Leroy the</font>

690
00:23:40,090 --> 00:23:43,389
but Alice doesn't<font color="#CCCCCC"> know Leroy's IP</font>

691
00:23:41,350 --> 00:23:44,740
address so what<font color="#E5E5E5"> what will happen is that</font>

692
00:23:43,390 --> 00:23:46,720
<font color="#E5E5E5">you know Alice will first go through</font>

693
00:23:44,740 --> 00:23:48,700
<font color="#E5E5E5">those those first three options</font><font color="#CCCCCC"> you know</font>

694
00:23:46,720 --> 00:23:50,650
both checking locally and also<font color="#E5E5E5"> make you</font>

695
00:23:48,700 --> 00:23:52,360
know try<font color="#CCCCCC"> and local DNS servers</font><font color="#E5E5E5"> if that</font>

696
00:23:50,650 --> 00:23:54,370
fails<font color="#E5E5E5"> Alice will fall back to element</font>

697
00:23:52,360 --> 00:23:55,840
are in NP<font color="#CCCCCC"> TNS so Alice will send out a</font>

698
00:23:54,370 --> 00:23:58,330
broadcast<font color="#E5E5E5"> request at every single end</font>

699
00:23:55,840 --> 00:24:00,370
<font color="#E5E5E5">point on the same subnet and the idea</font>

700
00:23:58,330 --> 00:24:02,260
here<font color="#CCCCCC"> is that you know it</font><font color="#E5E5E5"> every you know</font>

701
00:24:00,370 --> 00:24:03,100
every every computer on<font color="#E5E5E5"> this analysis</font>

702
00:24:02,260 --> 00:24:05,410
<font color="#CCCCCC">suddent</font><font color="#E5E5E5"> it's going to receive</font><font color="#CCCCCC"> this</font>

703
00:24:03,100 --> 00:24:08,169
request<font color="#E5E5E5"> the idea is</font><font color="#CCCCCC"> that there's</font><font color="#E5E5E5"> kind of</font>

704
00:24:05,410 --> 00:24:10,210
an honor system<font color="#E5E5E5"> involved</font><font color="#CCCCCC"> only the only</font>

705
00:24:08,170 --> 00:24:12,310
Leroy's supposed to respond<font color="#E5E5E5"> to this but</font>

706
00:24:10,210 --> 00:24:15,520
<font color="#E5E5E5">you know as we know no honor among</font>

707
00:24:12,310 --> 00:24:17,200
thieves<font color="#E5E5E5"> what can happen is as an</font>

708
00:24:15,520 --> 00:24:19,660
attacker you<font color="#E5E5E5"> can just wait for element R</font>

709
00:24:17,200 --> 00:24:21,220
and<font color="#CCCCCC"> MVT Ness queries and respond to all</font>

710
00:24:19,660 --> 00:24:23,140
<font color="#CCCCCC">of</font><font color="#E5E5E5"> them and the thing is that if</font>

711
00:24:21,220 --> 00:24:24,970
something<font color="#CCCCCC"> if a computer</font><font color="#E5E5E5"> makes these</font>

712
00:24:23,140 --> 00:24:28,500
requests<font color="#E5E5E5"> the first one that receives is</font>

713
00:24:24,970 --> 00:24:33,820
considered<font color="#CCCCCC"> the</font><font color="#E5E5E5"> valid one so</font>

714
00:24:28,500 --> 00:24:35,080
an example<font color="#CCCCCC"> of this working so I'm</font><font color="#E5E5E5"> gonna</font>

715
00:24:33,820 --> 00:24:41,590
<font color="#E5E5E5">skip forward a bit we're going</font><font color="#CCCCCC"> to run a</font>

716
00:24:35,080 --> 00:24:45,669
tool Lawrence<font color="#E5E5E5"> or Lauren Joffe by the way</font>

717
00:24:41,590 --> 00:24:47,379
wrote<font color="#E5E5E5"> this it's really</font><font color="#CCCCCC"> really good</font><font color="#E5E5E5"> this</font>

718
00:24:45,670 --> 00:24:48,700
<font color="#E5E5E5">is this is like</font><font color="#CCCCCC"> stent</font><font color="#E5E5E5"> a standard like</font>

719
00:24:47,380 --> 00:24:50,650
that pen like you know you<font color="#E5E5E5"> you get on</font>

720
00:24:48,700 --> 00:24:51,610
the<font color="#E5E5E5"> local you actually get an</font>

721
00:24:50,650 --> 00:24:53,110
<font color="#CCCCCC">advertisement so you start</font><font color="#E5E5E5"> running this</font>

722
00:24:51,610 --> 00:24:56,530
<font color="#CCCCCC">it's so</font><font color="#E5E5E5"> effective that it's actually</font>

723
00:24:53,110 --> 00:24:57,879
like so here we're<font color="#CCCCCC"> running this poisoner</font>

724
00:24:56,530 --> 00:25:00,129
<font color="#CCCCCC">as you</font><font color="#E5E5E5"> can see we're poisoning element</font>

725
00:24:57,880 --> 00:25:02,200
<font color="#CCCCCC">RMB TNS</font><font color="#E5E5E5"> and we're also listening</font><font color="#CCCCCC"> on it</font>

726
00:25:00,130 --> 00:25:04,000
you know we<font color="#E5E5E5"> have a HTTP server running a</font>

727
00:25:02,200 --> 00:25:04,960
rogue<font color="#CCCCCC"> SMP server running we're</font><font color="#E5E5E5"> just</font>

728
00:25:04,000 --> 00:25:08,680
<font color="#E5E5E5">waiting</font><font color="#CCCCCC"> for something to authenticate</font>

729
00:25:04,960 --> 00:25:11,110
with<font color="#E5E5E5"> us and what's gonna happen</font><font color="#CCCCCC"> is we're</font>

730
00:25:08,680 --> 00:25:12,940
going<font color="#E5E5E5"> to start up on the right here we</font>

731
00:25:11,110 --> 00:25:16,030
<font color="#CCCCCC">have a Windows host</font><font color="#E5E5E5"> and we're just</font><font color="#CCCCCC"> going</font>

732
00:25:12,940 --> 00:25:18,790
<font color="#E5E5E5">to make an attempt</font><font color="#CCCCCC"> to connect to an SMB</font>

733
00:25:16,030 --> 00:25:20,020
share on<font color="#E5E5E5"> non-existent server and because</font>

734
00:25:18,790 --> 00:25:21,399
the server doesn't exist of<font color="#CCCCCC"> course we're</font>

735
00:25:20,020 --> 00:25:24,129
going<font color="#E5E5E5"> to go through all</font><font color="#CCCCCC"> those different</font>

736
00:25:21,400 --> 00:25:25,240
and<font color="#CCCCCC"> be those those different NetBIOS</font>

737
00:25:24,130 --> 00:25:26,350
<font color="#CCCCCC">lookup options and we're going</font><font color="#E5E5E5"> to</font>

738
00:25:25,240 --> 00:25:28,260
exhaust our possibilities<font color="#E5E5E5"> we're going to</font>

739
00:25:26,350 --> 00:25:30,730
fall back to<font color="#CCCCCC"> elven aren't MBTs and</font>

740
00:25:28,260 --> 00:25:31,930
that's going of course<font color="#E5E5E5"> because once</font>

741
00:25:30,730 --> 00:25:32,950
<font color="#CCCCCC">again because the server doesn't exist</font>

742
00:25:31,930 --> 00:25:35,230
the only thing that's going<font color="#CCCCCC"> to respond</font>

743
00:25:32,950 --> 00:25:36,580
<font color="#E5E5E5">to</font><font color="#CCCCCC"> it is our rogue server over here so</font>

744
00:25:35,230 --> 00:25:39,130
<font color="#E5E5E5">you can see here we're</font><font color="#CCCCCC"> typing and do not</font>

745
00:25:36,580 --> 00:25:40,960
does not<font color="#E5E5E5"> exist and we've poison - poison</font>

746
00:25:39,130 --> 00:25:44,650
answer and boom we have hashes<font color="#CCCCCC"> by the</font>

747
00:25:40,960 --> 00:25:47,170
<font color="#CCCCCC">way and that's that's an element art or</font>

748
00:25:44,650 --> 00:25:49,240
MBT nslookup<font color="#E5E5E5"> or poisoning</font><font color="#CCCCCC"> request or</font>

749
00:25:47,170 --> 00:25:51,490
poisoning<font color="#E5E5E5"> attack should I say so</font>

750
00:25:49,240 --> 00:25:52,900
our escape attempt let's say we're about

751
00:25:51,490 --> 00:25:53,920
<font color="#CCCCCC">5% there I mean we've got</font><font color="#E5E5E5"> the</font>

752
00:25:52,900 --> 00:25:56,740
underpinnings of<font color="#CCCCCC"> what we're going to</font><font color="#E5E5E5"> do</font>

753
00:25:53,920 --> 00:25:57,850
to get out of<font color="#CCCCCC"> our our little situation</font>

754
00:25:56,740 --> 00:25:59,500
<font color="#CCCCCC">there</font><font color="#E5E5E5"> in earlier well there's one more</font>

755
00:25:57,850 --> 00:26:02,800
<font color="#E5E5E5">thing we have to go over anybody had</font><font color="#CCCCCC"> any</font>

756
00:25:59,500 --> 00:26:04,870
<font color="#E5E5E5">heard of our redirect</font><font color="#CCCCCC"> SMD okay cool</font>

757
00:26:02,800 --> 00:26:07,000
<font color="#E5E5E5">let's get more into the weeds here so</font>

758
00:26:04,870 --> 00:26:08,439
with a redirect<font color="#CCCCCC"> S&V</font><font color="#E5E5E5"> it's actually pretty</font>

759
00:26:07,000 --> 00:26:10,690
<font color="#E5E5E5">simple attack it is to force the victim</font>

760
00:26:08,440 --> 00:26:12,030
<font color="#E5E5E5">to visit an HTTP endpoint you know like</font>

761
00:26:10,690 --> 00:26:15,670
a fishing<font color="#E5E5E5"> lake or something</font><font color="#CCCCCC"> like that</font>

762
00:26:12,030 --> 00:26:17,740
<font color="#CCCCCC">that actually</font><font color="#E5E5E5"> just redirects</font><font color="#CCCCCC"> to an SMB</font>

763
00:26:15,670 --> 00:26:19,330
share on the<font color="#E5E5E5"> attackers machine so</font><font color="#CCCCCC"> you</font>

764
00:26:17,740 --> 00:26:20,860
<font color="#CCCCCC">last the link and they'll go to the</font>

765
00:26:19,330 --> 00:26:23,590
<font color="#E5E5E5">server and server will initially like</font>

766
00:26:20,860 --> 00:26:26,949
immediately send them<font color="#E5E5E5"> a 302 redirect to</font>

767
00:26:23,590 --> 00:26:28,959
an SMB share and you know that will

768
00:26:26,950 --> 00:26:30,040
trigger<font color="#E5E5E5"> ntlm authentication and you'll</font>

769
00:26:28,960 --> 00:26:31,570
get their hash it's kind of<font color="#E5E5E5"> like what we</font>

770
00:26:30,040 --> 00:26:32,800
<font color="#CCCCCC">just saw and there's a variation of this</font>

771
00:26:31,570 --> 00:26:34,899
<font color="#E5E5E5">where you actually just you know make</font>

772
00:26:32,800 --> 00:26:36,700
<font color="#E5E5E5">them you know redirect to non-existent</font>

773
00:26:34,900 --> 00:26:38,170
share and then we kind of<font color="#E5E5E5"> have</font><font color="#CCCCCC"> the same</font>

774
00:26:36,700 --> 00:26:40,120
<font color="#E5E5E5">situation we saw earlier because it</font>

775
00:26:38,170 --> 00:26:41,380
triggers element<font color="#CCCCCC"> our</font><font color="#E5E5E5"> deputy and s so the</font>

776
00:26:40,120 --> 00:26:41,889
very fast way to get hashes<font color="#E5E5E5"> but it</font>

777
00:26:41,380 --> 00:26:44,950
requires

778
00:26:41,890 --> 00:26:46,120
social engineering so this is where it's

779
00:26:44,950 --> 00:26:47,620
gonna<font color="#E5E5E5"> kind of get cool</font><font color="#CCCCCC"> we're gonna</font><font color="#E5E5E5"> talk</font>

780
00:26:46,120 --> 00:26:49,389
<font color="#CCCCCC">about like new</font><font color="#E5E5E5"> stuff that we're gonna</font>

781
00:26:47,620 --> 00:26:50,320
<font color="#E5E5E5">talk about hostile attacks which is kind</font>

782
00:26:49,390 --> 00:26:53,380
of like<font color="#CCCCCC"> taking a lot</font><font color="#E5E5E5"> of it we just</font>

783
00:26:50,320 --> 00:26:54,639
<font color="#E5E5E5">talked</font><font color="#CCCCCC"> about and puts together and it's</font>

784
00:26:53,380 --> 00:26:55,870
it's kind<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> cool way</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> like stealing</font>

785
00:26:54,640 --> 00:26:58,000
Active Directory credentials without

786
00:26:55,870 --> 00:27:01,780
network access it's just kind<font color="#CCCCCC"> of why I</font>

787
00:26:58,000 --> 00:27:03,250
think<font color="#CCCCCC"> it's C so how many</font><font color="#E5E5E5"> of you like so</font>

788
00:27:01,780 --> 00:27:04,059
you<font color="#CCCCCC"> guys</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> what a captive portal</font><font color="#E5E5E5"> is</font>

789
00:27:03,250 --> 00:27:05,640
right I<font color="#E5E5E5"> mean you've probably seen</font>

790
00:27:04,059 --> 00:27:08,049
something<font color="#CCCCCC"> like this the past few</font><font color="#E5E5E5"> days</font>

791
00:27:05,640 --> 00:27:09,730
<font color="#E5E5E5">yeah so captive portal right it's you</font>

792
00:27:08,049 --> 00:27:10,690
connect to a wireless network<font color="#CCCCCC"> and they</font>

793
00:27:09,730 --> 00:27:11,740
use<font color="#CCCCCC"> that there's a number</font><font color="#E5E5E5"> of tricks that</font>

794
00:27:10,690 --> 00:27:14,140
<font color="#E5E5E5">they use to make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that you end up</font>

795
00:27:11,740 --> 00:27:15,370
back<font color="#CCCCCC"> on</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same page and</font><font color="#E5E5E5"> you typically</font>

796
00:27:14,140 --> 00:27:16,750
don't get released<font color="#E5E5E5"> from that until you</font>

797
00:27:15,370 --> 00:27:19,649
you know fork over some<font color="#CCCCCC"> money or your</font>

798
00:27:16,750 --> 00:27:22,179
room number or spoof<font color="#CCCCCC"> Emeka no sorry um</font>

799
00:27:19,650 --> 00:27:24,490
<font color="#CCCCCC">so but the way that that works is that</font>

800
00:27:22,179 --> 00:27:25,750
<font color="#E5E5E5">all DNS queries are just resolved to the</font>

801
00:27:24,490 --> 00:27:26,860
location the Casa portal and if they

802
00:27:25,750 --> 00:27:29,830
really want<font color="#CCCCCC"> to get sneaky they'll also</font>

803
00:27:26,860 --> 00:27:31,000
<font color="#E5E5E5">redirect</font><font color="#CCCCCC"> DNS traffic</font><font color="#E5E5E5"> and redirect HTTP</font>

804
00:27:29,830 --> 00:27:33,159
traffic so well so you're kind of<font color="#E5E5E5"> stuck</font>

805
00:27:31,000 --> 00:27:34,960
there<font color="#E5E5E5"> so a hostile portal attack is</font><font color="#CCCCCC"> very</font>

806
00:27:33,160 --> 00:27:37,990
<font color="#E5E5E5">similar to</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> like your</font><font color="#CCCCCC"> your typical</font>

807
00:27:34,960 --> 00:27:39,970
hotel<font color="#E5E5E5"> Wi-Fi</font><font color="#CCCCCC"> captive portal but in this</font>

808
00:27:37,990 --> 00:27:41,799
case you're redirecting to an SMB share

809
00:27:39,970 --> 00:27:43,390
on the attackers<font color="#E5E5E5"> machine so they connect</font>

810
00:27:41,799 --> 00:27:44,980
to<font color="#E5E5E5"> the Wi-Fi network</font><font color="#CCCCCC"> and anytime they</font>

811
00:27:43,390 --> 00:27:48,970
try to<font color="#CCCCCC"> access something</font><font color="#E5E5E5"> they just end up</font>

812
00:27:44,980 --> 00:27:52,210
<font color="#E5E5E5">sending you hashes</font><font color="#CCCCCC"> so um you know and</font>

813
00:27:48,970 --> 00:27:53,500
also<font color="#E5E5E5"> you can run you</font><font color="#CCCCCC"> know like responder</font>

814
00:27:52,210 --> 00:27:55,270
in the background and<font color="#CCCCCC"> that will poison</font>

815
00:27:53,500 --> 00:27:58,240
all element<font color="#E5E5E5"> R and</font><font color="#CCCCCC"> mbts lookups that</font><font color="#E5E5E5"> they</font>

816
00:27:55,270 --> 00:27:59,950
make so you know the kind<font color="#CCCCCC"> of what</font><font color="#E5E5E5"> this</font>

817
00:27:58,240 --> 00:28:01,270
<font color="#E5E5E5">would look like is you know the first</font>

818
00:27:59,950 --> 00:28:03,340
<font color="#E5E5E5">the victim would be forced to connect to</font>

819
00:28:01,270 --> 00:28:05,980
the attacker<font color="#CCCCCC"> you know using</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> Rho VP</font>

820
00:28:03,340 --> 00:28:07,689
<font color="#E5E5E5">attack and then instantly you know</font>

821
00:28:05,980 --> 00:28:09,429
anything they do essentially<font color="#E5E5E5"> would be</font>

822
00:28:07,690 --> 00:28:10,809
redirected to<font color="#E5E5E5"> this SMB share and you can</font>

823
00:28:09,429 --> 00:28:12,540
hash this<font color="#E5E5E5"> that way and this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the first</font>

824
00:28:10,809 --> 00:28:14,770
live demo

825
00:28:12,540 --> 00:28:16,980
<font color="#CCCCCC">maybe the demo</font><font color="#E5E5E5"> well this is going off to</font>

826
00:28:14,770 --> 00:28:16,980
a great start

827
00:28:18,360 --> 00:28:24,520
looks like I'm<font color="#CCCCCC"> doing decently on time</font>

828
00:28:20,410 --> 00:28:27,390
though so<font color="#CCCCCC"> I'm going to login it's Jay</font>

829
00:28:24,520 --> 00:28:27,389
Cena there

830
00:28:28,660 --> 00:28:32,830
<font color="#E5E5E5">kurz</font><font color="#CCCCCC"> and chuckles for copyright reasons</font>

831
00:28:30,850 --> 00:28:36,030
<font color="#E5E5E5">I can't use Jason's full first</font><font color="#CCCCCC"> name</font><font color="#E5E5E5"> but</font>

832
00:28:32,830 --> 00:28:36,030
<font color="#E5E5E5">whatever you get the point</font>

833
00:28:37,080 --> 00:28:46,949
<font color="#E5E5E5">all right so the first</font><font color="#CCCCCC"> thing I'm gonna</font>

834
00:28:39,220 --> 00:28:46,950
do is<font color="#CCCCCC"> I'm gonna</font><font color="#E5E5E5"> create</font><font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> command+</font>

835
00:28:47,130 --> 00:28:54,010
<font color="#E5E5E5">okay yeah so I've got an open network</font>

836
00:28:51,550 --> 00:28:55,000
here I'm<font color="#E5E5E5"> gonna make are you are you</font>

837
00:28:54,010 --> 00:28:57,370
<font color="#E5E5E5">kidding me oh I need to be in the</font>

838
00:28:55,000 --> 00:28:58,390
directory see the thing<font color="#E5E5E5"> it's like when</font>

839
00:28:57,370 --> 00:29:00,340
I'm<font color="#E5E5E5"> operating on the projector</font>

840
00:28:58,390 --> 00:29:02,110
everything looks very very small on my

841
00:29:00,340 --> 00:29:04,179
screen<font color="#E5E5E5"> so like I'm having to squint here</font>

842
00:29:02,110 --> 00:29:08,830
to<font color="#CCCCCC"> actually do any of this it's a vise</font>

843
00:29:04,180 --> 00:29:14,470
not<font color="#CCCCCC"> faoud it's a small for you - can</font><font color="#E5E5E5"> you</font>

844
00:29:08,830 --> 00:29:16,360
actually<font color="#E5E5E5"> read that brilliant okay so I'm</font>

845
00:29:14,470 --> 00:29:17,500
<font color="#E5E5E5">gonna make this bigger so</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> this</font>

846
00:29:16,360 --> 00:29:22,389
works<font color="#E5E5E5"> for both</font><font color="#CCCCCC"> of us then we can</font><font color="#E5E5E5"> both</font>

847
00:29:17,500 --> 00:29:23,800
read this okay so try this again

848
00:29:22,390 --> 00:29:25,300
<font color="#CCCCCC">apparently I</font><font color="#E5E5E5"> need</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> actually</font><font color="#CCCCCC"> need a</font>

849
00:29:23,800 --> 00:29:33,010
network<font color="#E5E5E5"> interface to do this big</font>

850
00:29:25,300 --> 00:29:35,740
surprise<font color="#CCCCCC"> there right go</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> looks until I</font>

851
00:29:33,010 --> 00:29:41,430
pick the<font color="#CCCCCC"> machine</font><font color="#E5E5E5"> no I don't I'll take me</font>

852
00:29:35,740 --> 00:29:41,430
there<font color="#E5E5E5"> okay let's try this again</font>

853
00:29:42,390 --> 00:29:54,340
all right cool so I've connected to open

854
00:29:45,100 --> 00:29:58,750
Wi-Fi<font color="#E5E5E5"> and I'm now going</font><font color="#CCCCCC"> to to Jenkins</font>

855
00:29:54,340 --> 00:30:02,409
I've got Leroy Jenkins that's my - let's

856
00:29:58,750 --> 00:30:03,670
fight see those computers all right so

857
00:30:02,410 --> 00:30:05,650
I'm gonna<font color="#E5E5E5"> connect to this open a Wi-Fi</font>

858
00:30:03,670 --> 00:30:10,780
network<font color="#E5E5E5"> and this is this</font><font color="#CCCCCC"> is just like me</font>

859
00:30:05,650 --> 00:30:12,250
setting up the initial Wi-Fi here I'm

860
00:30:10,780 --> 00:30:17,379
gonna<font color="#E5E5E5"> get ready to make this like rogue</font>

861
00:30:12,250 --> 00:30:18,790
<font color="#CCCCCC">ap attack happen all right so</font><font color="#E5E5E5"> it's</font>

862
00:30:17,380 --> 00:30:19,210
associated<font color="#E5E5E5"> that's a good sign what about</font>

863
00:30:18,790 --> 00:30:21,550
over<font color="#CCCCCC"> here</font>

864
00:30:19,210 --> 00:30:23,260
excellent<font color="#CCCCCC"> so it's that's that's working</font>

865
00:30:21,550 --> 00:30:25,480
<font color="#E5E5E5">so now</font><font color="#CCCCCC"> I'm going</font><font color="#E5E5E5"> to launch this rogue ap</font>

866
00:30:23,260 --> 00:30:26,590
attack<font color="#E5E5E5"> and hopefully you guys can see</font>

867
00:30:25,480 --> 00:30:29,410
this a little<font color="#CCCCCC"> better I'm gonna trying to</font>

868
00:30:26,590 --> 00:30:35,230
make this figure is this<font color="#E5E5E5"> decent decent</font>

869
00:30:29,410 --> 00:30:38,340
<font color="#E5E5E5">size I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> take</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> a yes all</font>

870
00:30:35,230 --> 00:30:38,340
<font color="#E5E5E5">right now that's</font><font color="#CCCCCC"> working</font><font color="#E5E5E5"> into a reap</font>

871
00:30:38,400 --> 00:30:44,000
okay<font color="#CCCCCC"> so I gotta connect more stuff</font>

872
00:30:41,620 --> 00:30:48,820
it's funny everything<font color="#CCCCCC"> actually got</font><font color="#E5E5E5"> reset</font>

873
00:30:44,000 --> 00:30:56,210
when I came<font color="#CCCCCC"> up here no</font><font color="#E5E5E5"> I don't do that</font>

874
00:30:48,820 --> 00:30:59,480
come on<font color="#E5E5E5"> all right I'm just gonna make</font>

875
00:30:56,210 --> 00:31:05,090
sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> Network manager doesn't mess</font>

876
00:30:59,480 --> 00:31:11,870
is my thing here<font color="#E5E5E5"> all right so hopefully</font>

877
00:31:05,090 --> 00:31:12,580
<font color="#E5E5E5">that will work there we go no that's</font><font color="#CCCCCC"> not</font>

878
00:31:11,870 --> 00:31:15,850
it

879
00:31:12,580 --> 00:31:15,850
try this one

880
00:31:22,110 --> 00:31:25,559
<font color="#E5E5E5">okay so I wouldn't give this one more</font>

881
00:31:23,940 --> 00:31:30,299
shot and<font color="#E5E5E5"> then for the sake of time going</font>

882
00:31:25,559 --> 00:31:33,928
<font color="#E5E5E5">to switch over</font><font color="#CCCCCC"> to video yeah whatever</font>

883
00:31:30,299 --> 00:31:35,279
<font color="#CCCCCC">alright so then what guys are obviously</font>

884
00:31:33,929 --> 00:31:36,960
pissed<font color="#E5E5E5"> at me right</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> but fortunately I</font>

885
00:31:35,279 --> 00:31:43,080
came<font color="#E5E5E5"> prepared with the backup</font><font color="#CCCCCC"> yay</font>

886
00:31:36,960 --> 00:31:44,570
round of applause for the demo gods yeah

887
00:31:43,080 --> 00:31:46,799
that's right

888
00:31:44,570 --> 00:31:48,539
so okay so<font color="#E5E5E5"> the same thing we're going to</font>

889
00:31:46,799 --> 00:31:51,600
do earlier<font color="#CCCCCC"> we're gonna</font><font color="#E5E5E5"> do earlier but</font>

890
00:31:48,539 --> 00:31:53,340
this time<font color="#E5E5E5"> we're gonna create a Wi-Fi</font>

891
00:31:51,600 --> 00:31:54,480
network<font color="#E5E5E5"> using the terminal in</font><font color="#CCCCCC"> the top</font>

892
00:31:53,340 --> 00:31:57,779
right we're<font color="#CCCCCC"> then going to</font><font color="#E5E5E5"> connect to it</font>

893
00:31:54,480 --> 00:32:01,320
<font color="#CCCCCC">using this poor victim in the bottom</font>

894
00:31:57,779 --> 00:32:02,190
left<font color="#E5E5E5"> and we're gonna connect to it I'm</font>

895
00:32:01,320 --> 00:32:07,519
<font color="#E5E5E5">going to fast</font><font color="#CCCCCC"> forward through the</font>

896
00:32:02,190 --> 00:32:07,519
connection process<font color="#CCCCCC"> you guys type</font><font color="#E5E5E5"> that</font>

897
00:32:07,700 --> 00:32:16,139
<font color="#CCCCCC">all right</font><font color="#E5E5E5"> it's still work yeah so bottom</font>

898
00:32:14,010 --> 00:32:17,639
<font color="#CCCCCC">right is connected to bottom or to top</font>

899
00:32:16,139 --> 00:32:19,408
right<font color="#CCCCCC"> that's kinda what we're looking</font><font color="#E5E5E5"> at</font>

900
00:32:17,639 --> 00:32:22,320
<font color="#CCCCCC">here then</font><font color="#E5E5E5"> bottom left here is going to</font>

901
00:32:19,409 --> 00:32:23,580
do the rogue access point attack and

902
00:32:22,320 --> 00:32:27,779
we're going to<font color="#E5E5E5"> do them to get them</font><font color="#CCCCCC"> to</font>

903
00:32:23,580 --> 00:32:29,820
roam to our<font color="#CCCCCC"> AP and you'll notice they're</font>

904
00:32:27,779 --> 00:32:32,309
now associated<font color="#E5E5E5"> with us and we're gonna</font>

905
00:32:29,820 --> 00:32:33,840
<font color="#E5E5E5">open up</font><font color="#CCCCCC"> I II and and something sometimes</font>

906
00:32:32,309 --> 00:32:34,678
this<font color="#E5E5E5"> will</font><font color="#CCCCCC"> actually open IE automatically</font>

907
00:32:33,840 --> 00:32:36,899
for some reason when<font color="#CCCCCC"> you connect a</font>

908
00:32:34,679 --> 00:32:37,830
network and bam we<font color="#CCCCCC"> have hashes actually</font>

909
00:32:36,899 --> 00:32:39,360
what interesting thing that<font color="#E5E5E5"> you'll</font>

910
00:32:37,830 --> 00:32:40,799
notice<font color="#E5E5E5"> here is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> let's say they're</font>

911
00:32:39,360 --> 00:32:42,000
<font color="#E5E5E5">using Internet Explorer whatever you</font>

912
00:32:40,799 --> 00:32:43,500
type something into the address bar

913
00:32:42,000 --> 00:32:45,330
it'll<font color="#E5E5E5"> do a Bing search for it which will</font>

914
00:32:43,500 --> 00:32:46,860
to further do this attack over and over

915
00:32:45,330 --> 00:32:50,610
and<font color="#E5E5E5"> over again and you'll just</font><font color="#CCCCCC"> fill</font><font color="#E5E5E5"> just</font>

916
00:32:46,860 --> 00:32:55,289
keep sending you<font color="#E5E5E5"> their their their ad</font>

917
00:32:50,610 --> 00:32:56,428
hashes<font color="#CCCCCC"> so anyways that's that</font><font color="#E5E5E5"> so we did</font>

918
00:32:55,289 --> 00:32:57,570
<font color="#E5E5E5">that with an open</font><font color="#CCCCCC"> network and</font><font color="#E5E5E5"> the reason</font>

919
00:32:56,429 --> 00:32:59,039
why we did that<font color="#E5E5E5"> with an open</font><font color="#CCCCCC"> network is</font>

920
00:32:57,570 --> 00:33:02,158
there's a little more<font color="#CCCCCC"> to it when you do</font>

921
00:32:59,039 --> 00:33:02,940
<font color="#E5E5E5">this with WPA EAP you know in most cases</font>

922
00:33:02,159 --> 00:33:04,620
you know what we were talking<font color="#CCCCCC"> about</font>

923
00:33:02,940 --> 00:33:06,779
<font color="#CCCCCC">earlier we were talking about</font><font color="#E5E5E5"> EAP TLS</font>

924
00:33:04,620 --> 00:33:08,639
and<font color="#E5E5E5"> EAP</font><font color="#CCCCCC"> peep and both of these used and</font>

925
00:33:06,779 --> 00:33:11,370
this<font color="#E5E5E5"> chap</font><font color="#CCCCCC"> e24 their</font><font color="#E5E5E5"> inner authentication</font>

926
00:33:08,639 --> 00:33:12,629
method so<font color="#CCCCCC"> Emma's Chafee to actually</font><font color="#E5E5E5"> just</font>

927
00:33:11,370 --> 00:33:14,158
we use mutual<font color="#E5E5E5"> authentication for the</font>

928
00:33:12,630 --> 00:33:15,690
final stage of the<font color="#E5E5E5"> authentication</font>

929
00:33:14,159 --> 00:33:17,039
process<font color="#E5E5E5"> it doesn't use it for the first</font>

930
00:33:15,690 --> 00:33:19,380
stage and<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> why we can perform the</font>

931
00:33:17,039 --> 00:33:20,340
rogue<font color="#CCCCCC"> ap attack</font><font color="#E5E5E5"> but you know the the</font>

932
00:33:19,380 --> 00:33:22,820
thing<font color="#CCCCCC"> is</font><font color="#E5E5E5"> that we for using Emma's</font>

933
00:33:20,340 --> 00:33:25,408
<font color="#CCCCCC">chitchat be to the very end</font><font color="#E5E5E5"> end of the</font>

934
00:33:22,820 --> 00:33:26,760
<font color="#E5E5E5">the authentication process the final</font>

935
00:33:25,409 --> 00:33:29,399
steps<font color="#E5E5E5"> at the radius server actually has</font>

936
00:33:26,760 --> 00:33:31,620
to<font color="#E5E5E5"> prove knowledge of the the users</font>

937
00:33:29,399 --> 00:33:33,510
password<font color="#E5E5E5"> to the user and</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> that doesn't</font>

938
00:33:31,620 --> 00:33:35,489
<font color="#E5E5E5">happen the</font><font color="#CCCCCC"> whole thing fails</font><font color="#E5E5E5"> despite the</font>

939
00:33:33,510 --> 00:33:37,169
<font color="#E5E5E5">fact</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you still in</font><font color="#CCCCCC"> there creds</font>

940
00:33:35,490 --> 00:33:38,279
so what this means<font color="#CCCCCC"> is that although an</font>

941
00:33:37,169 --> 00:33:39,720
attacker can force the victim<font color="#E5E5E5"> to</font>

942
00:33:38,279 --> 00:33:41,309
authenticate<font color="#E5E5E5"> with an evil twin</font><font color="#CCCCCC"> that</font>

943
00:33:39,720 --> 00:33:44,250
<font color="#CCCCCC">still hashes the attacker still needs</font>

944
00:33:41,309 --> 00:33:47,460
<font color="#CCCCCC">the attackers radio server what will</font>

945
00:33:44,250 --> 00:33:49,110
still fail<font color="#CCCCCC"> to that the final stage of</font>

946
00:33:47,460 --> 00:33:50,250
the authentication<font color="#E5E5E5"> process and because</font>

947
00:33:49,110 --> 00:33:51,719
they can't prove<font color="#E5E5E5"> knowledge of the</font><font color="#CCCCCC"> user's</font>

948
00:33:50,250 --> 00:33:53,730
<font color="#CCCCCC">password until they've cracked those</font>

949
00:33:51,720 --> 00:33:55,500
credentials<font color="#CCCCCC"> so</font><font color="#E5E5E5"> there are a couple of</font>

950
00:33:53,730 --> 00:33:56,760
<font color="#E5E5E5">solutions to this and the first one is</font>

951
00:33:55,500 --> 00:34:00,510
really cool<font color="#E5E5E5"> and</font><font color="#CCCCCC"> actually this once</font><font color="#E5E5E5"> again</font>

952
00:33:56,760 --> 00:34:03,210
came out in<font color="#CCCCCC"> incensed</font><font color="#E5E5E5"> post-talk in 2002</font>

953
00:34:00,510 --> 00:34:04,799
<font color="#E5E5E5">or 2014 at Def Con 22</font>

954
00:34:03,210 --> 00:34:06,590
it's called<font color="#E5E5E5"> Auto crack and added we'll</font>

955
00:34:04,799 --> 00:34:08,940
talk about<font color="#E5E5E5"> that that that in a bit</font>

956
00:34:06,590 --> 00:34:11,279
<font color="#CCCCCC">that's Tom white and Ian de Villiers and</font>

957
00:34:08,940 --> 00:34:12,300
then the I guess<font color="#E5E5E5"> the basic the more</font>

958
00:34:11,280 --> 00:34:13,379
<font color="#E5E5E5">basic thing you can do and you'll have</font>

959
00:34:12,300 --> 00:34:15,089
to do this for stronger<font color="#E5E5E5"> radius</font>

960
00:34:13,379 --> 00:34:16,710
credentials<font color="#E5E5E5"> so you just crack offline</font>

961
00:34:15,089 --> 00:34:19,980
and finish the<font color="#CCCCCC"> attack later we'll</font><font color="#E5E5E5"> talk</font>

962
00:34:16,710 --> 00:34:21,839
<font color="#E5E5E5">more about that as well so the very end</font>

963
00:34:19,980 --> 00:34:23,010
of the mschap<font color="#CCCCCC"> YouTube education process</font>

964
00:34:21,839 --> 00:34:24,330
looks like<font color="#E5E5E5"> this the challenge</font><font color="#CCCCCC"> response</font>

965
00:34:23,010 --> 00:34:26,220
which is the<font color="#E5E5E5"> thing that</font><font color="#CCCCCC"> we cracked to</font>

966
00:34:24,330 --> 00:34:27,989
obtain the plaintext<font color="#E5E5E5"> financials is sent</font>

967
00:34:26,219 --> 00:34:29,368
to the attacker in this case the

968
00:34:27,989 --> 00:34:30,719
attacker is running hostapd which is

969
00:34:29,369 --> 00:34:32,970
what you use<font color="#CCCCCC"> to do all this radius stuff</font>

970
00:34:30,719 --> 00:34:34,439
<font color="#E5E5E5">and you know I was</font><font color="#CCCCCC"> pay PD it has this</font>

971
00:34:32,969 --> 00:34:37,459
the special<font color="#CCCCCC"> file</font><font color="#E5E5E5"> that's kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> just</font>

972
00:34:34,440 --> 00:34:39,750
<font color="#E5E5E5">like I really</font><font color="#CCCCCC"> really like you know janky</font>

973
00:34:37,460 --> 00:34:42,270
it's a text file<font color="#CCCCCC"> it's uses a</font><font color="#E5E5E5"> database</font>

974
00:34:39,750 --> 00:34:44,730
that's but it loads<font color="#E5E5E5"> you know the</font>

975
00:34:42,270 --> 00:34:46,918
<font color="#E5E5E5">password from</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> EAP user file and</font>

976
00:34:44,730 --> 00:34:48,389
then it uses<font color="#E5E5E5"> that to create</font>

977
00:34:46,918 --> 00:34:49,980
<font color="#E5E5E5">authentication response that it sends</font>

978
00:34:48,389 --> 00:34:52,200
<font color="#E5E5E5">with the auth success message back to</font>

979
00:34:49,980 --> 00:34:53,730
<font color="#CCCCCC">the</font><font color="#E5E5E5"> victim</font><font color="#CCCCCC"> so you know of</font><font color="#E5E5E5"> course if the</font>

980
00:34:52,199 --> 00:34:55,439
<font color="#E5E5E5">users</font><font color="#CCCCCC"> password is not</font><font color="#E5E5E5"> in the EP user</font>

981
00:34:53,730 --> 00:34:57,060
file it's not<font color="#E5E5E5"> going to work even</font><font color="#CCCCCC"> if you</font>

982
00:34:55,440 --> 00:34:58,170
<font color="#E5E5E5">forged an off success message it's still</font>

983
00:34:57,060 --> 00:35:00,690
you're not<font color="#CCCCCC"> gonna be able</font><font color="#E5E5E5"> to prove</font>

984
00:34:58,170 --> 00:35:03,420
<font color="#CCCCCC">knowledge so you know the</font><font color="#E5E5E5"> the full</font>

985
00:35:00,690 --> 00:35:05,430
authentication will not<font color="#CCCCCC"> put</font><font color="#E5E5E5"> succeed</font><font color="#CCCCCC"> so</font>

986
00:35:03,420 --> 00:35:06,780
the way<font color="#CCCCCC"> Auto crack and AD works is that</font>

987
00:35:05,430 --> 00:35:09,569
Dom<font color="#E5E5E5"> boy and</font><font color="#CCCCCC"> Ian de Villiers came up with</font>

988
00:35:06,780 --> 00:35:11,220
this<font color="#E5E5E5"> technique for instead</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> just you</font>

989
00:35:09,570 --> 00:35:13,170
know<font color="#E5E5E5"> looking it</font><font color="#CCCCCC"> up directly</font><font color="#E5E5E5"> in the EAP</font>

990
00:35:11,220 --> 00:35:14,580
user file you instead<font color="#E5E5E5"> just send the the</font>

991
00:35:13,170 --> 00:35:17,130
<font color="#E5E5E5">challenge response directly to a</font>

992
00:35:14,580 --> 00:35:19,529
cracking rig<font color="#E5E5E5"> and actually for pretty</font>

993
00:35:17,130 --> 00:35:20,880
<font color="#E5E5E5">amazed how quickly the</font><font color="#CCCCCC"> the wordless</font>

994
00:35:19,530 --> 00:35:22,980
password<font color="#E5E5E5"> that we had earlier at the</font>

995
00:35:20,880 --> 00:35:24,240
<font color="#E5E5E5">beginning</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the talk was cracked so for</font>

996
00:35:22,980 --> 00:35:25,440
weak<font color="#CCCCCC"> credentials you</font><font color="#E5E5E5"> can do this very</font>

997
00:35:24,240 --> 00:35:26,399
quickly and<font color="#E5E5E5"> even for relatively strong</font>

998
00:35:25,440 --> 00:35:28,170
credentials<font color="#E5E5E5"> if you have a powerful</font>

999
00:35:26,400 --> 00:35:31,140
enough<font color="#E5E5E5"> to cracking break you can</font>

1000
00:35:28,170 --> 00:35:32,670
actually often you know<font color="#E5E5E5"> send this off</font>

1001
00:35:31,140 --> 00:35:34,650
and then modify the EAP<font color="#E5E5E5"> user file</font>

1002
00:35:32,670 --> 00:35:36,750
<font color="#E5E5E5">throughout this process occurring or</font>

1003
00:35:34,650 --> 00:35:37,859
even just you know<font color="#E5E5E5"> modified after the</font>

1004
00:35:36,750 --> 00:35:41,180
process occurs and then you get<font color="#E5E5E5"> them to</font>

1005
00:35:37,859 --> 00:35:45,000
connect<font color="#CCCCCC"> again and then finish the attack</font>

1006
00:35:41,180 --> 00:35:48,118
<font color="#E5E5E5">so I mean</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> second option of course is</font>

1007
00:35:45,000 --> 00:35:48,960
the is you<font color="#E5E5E5"> know this the</font><font color="#CCCCCC"> autocrat can</font>

1008
00:35:48,119 --> 00:35:50,580
<font color="#CCCCCC">add will work if you have a</font>

1009
00:35:48,960 --> 00:35:51,420
fairly weak radius<font color="#CCCCCC"> crotchal which</font><font color="#E5E5E5"> i mean</font>

1010
00:35:50,580 --> 00:35:53,310
an organization of<font color="#CCCCCC"> a couple hundred</font>

1011
00:35:51,420 --> 00:35:57,420
people<font color="#CCCCCC"> your your you're gonna find at</font>

1012
00:35:53,310 --> 00:35:59,490
least one but<font color="#CCCCCC"> for strong</font><font color="#E5E5E5"> for stronger</font>

1013
00:35:57,420 --> 00:36:01,200
<font color="#E5E5E5">passwords you're going to need to do an</font>

1014
00:35:59,490 --> 00:36:02,910
offline crack<font color="#E5E5E5"> but you know the only</font>

1015
00:36:01,200 --> 00:36:04,589
caveat here is<font color="#CCCCCC"> that instead of this this</font>

1016
00:36:02,910 --> 00:36:05,848
this attack taking<font color="#E5E5E5"> you know anywhere</font>

1017
00:36:04,589 --> 00:36:07,589
between<font color="#E5E5E5"> like a few minutes</font><font color="#CCCCCC"> and a few</font><font color="#E5E5E5"> out</font>

1018
00:36:05,849 --> 00:36:09,480
and in an hour<font color="#E5E5E5"> now it's gonna take a</font><font color="#CCCCCC"> few</font>

1019
00:36:07,589 --> 00:36:10,200
hours<font color="#E5E5E5"> to pop potentially a week but I</font>

1020
00:36:09,480 --> 00:36:11,790
mean that's<font color="#CCCCCC"> still pretty effective</font>

1021
00:36:10,200 --> 00:36:13,200
<font color="#CCCCCC">because you know</font><font color="#E5E5E5"> from a attackers</font>

1022
00:36:11,790 --> 00:36:14,430
perspective that's<font color="#E5E5E5"> not a bad time frame</font>

1023
00:36:13,200 --> 00:36:17,250
<font color="#E5E5E5">and of course if you're dealing with a</font>

1024
00:36:14,430 --> 00:36:22,460
PT's<font color="#E5E5E5"> our buddy up there and</font><font color="#CCCCCC"> them on the</font>

1025
00:36:17,250 --> 00:36:27,480
right<font color="#E5E5E5"> they are</font><font color="#CCCCCC"> a time boxed at all so</font>

1026
00:36:22,460 --> 00:36:28,650
<font color="#E5E5E5">tried demo number two here although this</font>

1027
00:36:27,480 --> 00:36:29,690
<font color="#CCCCCC">can be a variation the same thing so</font>

1028
00:36:28,650 --> 00:36:37,530
we'll try this

1029
00:36:29,690 --> 00:36:39,330
we'll try this<font color="#E5E5E5"> again so once again we're</font>

1030
00:36:37,530 --> 00:36:48,240
<font color="#E5E5E5">going to create an EAP access point over</font>

1031
00:36:39,330 --> 00:36:51,270
here and we're going<font color="#CCCCCC"> to connect to</font><font color="#E5E5E5"> it or</font>

1032
00:36:48,240 --> 00:36:53,359
<font color="#CCCCCC">or</font><font color="#E5E5E5"> at least we're going to alright here</font>

1033
00:36:51,270 --> 00:36:53,359
we<font color="#CCCCCC"> go</font>

1034
00:36:56,640 --> 00:37:07,799
dan it's still connecting<font color="#E5E5E5"> can you</font><font color="#CCCCCC"> smell</font>

1035
00:37:02,910 --> 00:37:12,029
<font color="#CCCCCC">the anticipation checking</font><font color="#E5E5E5"> network</font>

1036
00:37:07,800 --> 00:37:14,070
requirements<font color="#E5E5E5"> I'm going to give this I'm</font>

1037
00:37:12,030 --> 00:37:20,180
<font color="#E5E5E5">gonna give this 15 seconds</font><font color="#CCCCCC"> to connect it</font>

1038
00:37:14,070 --> 00:37:20,180
doesn't<font color="#E5E5E5"> hear you know what</font>

1039
00:37:33,200 --> 00:37:40,040
okay so my interface has<font color="#E5E5E5"> gone completely</font>

1040
00:37:35,329 --> 00:37:47,780
<font color="#E5E5E5">dead thanks for um we're great</font><font color="#CCCCCC"> product</font>

1041
00:37:40,040 --> 00:37:48,759
<font color="#CCCCCC">okay so</font><font color="#E5E5E5"> um we're</font><font color="#CCCCCC"> just gonna do</font><font color="#E5E5E5"> this like</font>

1042
00:37:47,780 --> 00:37:50,569
<font color="#E5E5E5">this again</font>

1043
00:37:48,760 --> 00:37:51,950
but<font color="#E5E5E5"> this time we're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> use it with</font>

1044
00:37:50,569 --> 00:37:56,990
<font color="#CCCCCC">peep and we're gonna</font><font color="#E5E5E5"> do the auto crack</font>

1045
00:37:51,950 --> 00:37:58,220
and<font color="#CCCCCC"> AD</font><font color="#E5E5E5"> and this is you know</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> we're</font>

1046
00:37:56,990 --> 00:38:00,109
<font color="#E5E5E5">just connecting to it for the</font><font color="#CCCCCC"> first time</font>

1047
00:37:58,220 --> 00:38:02,118
this<font color="#E5E5E5"> is actually</font><font color="#CCCCCC"> a legitimate</font><font color="#E5E5E5"> access</font>

1048
00:38:00,109 --> 00:38:04,339
point<font color="#E5E5E5"> so it's this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> what would happen</font>

1049
00:38:02,119 --> 00:38:09,470
<font color="#E5E5E5">and</font><font color="#CCCCCC"> now we're going to actually mount</font>

1050
00:38:04,339 --> 00:38:12,109
the attack and as you can<font color="#E5E5E5"> see here we're</font>

1051
00:38:09,470 --> 00:38:13,578
gonna<font color="#E5E5E5"> start our EP can everyone see okay</font>

1052
00:38:12,109 --> 00:38:16,670
I know that<font color="#E5E5E5"> probably</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> really small</font>

1053
00:38:13,579 --> 00:38:18,410
<font color="#CCCCCC">text</font><font color="#E5E5E5"> I'll put these</font><font color="#CCCCCC"> videos online later</font>

1054
00:38:16,670 --> 00:38:19,790
if you want<font color="#E5E5E5"> to look</font><font color="#CCCCCC"> at them that</font><font color="#E5E5E5"> way you</font>

1055
00:38:18,410 --> 00:38:21,529
<font color="#CCCCCC">don't have to</font><font color="#E5E5E5"> deal with like using a</font>

1056
00:38:19,790 --> 00:38:23,650
telescope to try to see what's going<font color="#CCCCCC"> on</font>

1057
00:38:21,530 --> 00:38:23,650
up there

1058
00:38:24,099 --> 00:38:31,730
but yeah<font color="#E5E5E5"> so we've</font><font color="#CCCCCC"> D off the thing so</font>

1059
00:38:28,700 --> 00:38:33,980
this<font color="#E5E5E5"> will happen with with with EAP is</font>

1060
00:38:31,730 --> 00:38:34,970
that<font color="#E5E5E5"> especially Microsoft it's not as</font>

1061
00:38:33,980 --> 00:38:36,109
much<font color="#CCCCCC"> of a</font><font color="#E5E5E5"> problem from attackers</font>

1062
00:38:34,970 --> 00:38:37,368
<font color="#E5E5E5">perspective when you're doing it until</font>

1063
00:38:36,109 --> 00:38:39,440
it like Android or OSX

1064
00:38:37,369 --> 00:38:40,940
but when you try to<font color="#E5E5E5"> do this attack</font>

1065
00:38:39,440 --> 00:38:42,079
against<font color="#E5E5E5"> Windows sometimes it'll</font><font color="#CCCCCC"> just</font>

1066
00:38:40,940 --> 00:38:43,160
drop off completely<font color="#E5E5E5"> and then the user</font>

1067
00:38:42,079 --> 00:38:44,210
<font color="#E5E5E5">will have to reconnect</font><font color="#CCCCCC"> and then</font>

1068
00:38:43,160 --> 00:38:48,470
fortunately they'll they'll be

1069
00:38:44,210 --> 00:38:49,700
reconnected to<font color="#E5E5E5"> you right but it still</font>

1070
00:38:48,470 --> 00:38:50,779
adds<font color="#E5E5E5"> a little extra</font><font color="#CCCCCC"> so they've they've</font>

1071
00:38:49,700 --> 00:38:53,118
authenticated with<font color="#E5E5E5"> us and we've captured</font>

1072
00:38:50,780 --> 00:38:54,349
<font color="#E5E5E5">the username and challenge and response</font>

1073
00:38:53,119 --> 00:38:56,089
<font color="#E5E5E5">but of course they weren't able to</font>

1074
00:38:54,349 --> 00:38:58,339
associate as you can see down<font color="#CCCCCC"> here and</font>

1075
00:38:56,089 --> 00:38:59,779
the<font color="#E5E5E5"> reason</font><font color="#CCCCCC"> for that is</font><font color="#E5E5E5"> it's missing</font>

1076
00:38:58,339 --> 00:39:01,130
we don't have<font color="#CCCCCC"> knowledge</font><font color="#E5E5E5"> of the password</font>

1077
00:38:59,780 --> 00:39:02,180
yet<font color="#E5E5E5"> however we've just cracked it by</font>

1078
00:39:01,130 --> 00:39:05,089
<font color="#E5E5E5">sending to</font><font color="#CCCCCC"> the crackling reagan would</font>

1079
00:39:02,180 --> 00:39:07,730
<font color="#E5E5E5">have updated</font><font color="#CCCCCC"> our user file</font><font color="#E5E5E5"> in fact if</font>

1080
00:39:05,089 --> 00:39:08,869
you if<font color="#CCCCCC"> you we're gonna also we've just</font>

1081
00:39:07,730 --> 00:39:11,109
reconnected them to the<font color="#E5E5E5"> legitimate</font>

1082
00:39:08,869 --> 00:39:13,880
access<font color="#E5E5E5"> point</font><font color="#CCCCCC"> so you can try this</font><font color="#E5E5E5"> again</font>

1083
00:39:11,109 --> 00:39:16,130
so if you look this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the bottom of our</font>

1084
00:39:13,880 --> 00:39:18,020
stuff<font color="#CCCCCC"> that this</font><font color="#E5E5E5"> is the bottom</font><font color="#CCCCCC"> aren't</font>

1085
00:39:16,130 --> 00:39:19,099
<font color="#E5E5E5">user file we now have the the</font>

1086
00:39:18,020 --> 00:39:21,470
credentials not have been added to that

1087
00:39:19,099 --> 00:39:23,960
<font color="#E5E5E5">and we're gonna proceed forward and</font>

1088
00:39:21,470 --> 00:39:27,230
actually perform<font color="#CCCCCC"> this attack to so</font>

1089
00:39:23,960 --> 00:39:35,839
they've associated with us or they're in

1090
00:39:27,230 --> 00:39:37,099
<font color="#E5E5E5">the process of doing so connects and by</font>

1091
00:39:35,839 --> 00:39:38,900
the way this is<font color="#E5E5E5"> the message I'm gonna</font>

1092
00:39:37,099 --> 00:39:40,069
possibly fast<font color="#CCCCCC"> when you actually</font><font color="#E5E5E5"> are on</font>

1093
00:39:38,900 --> 00:39:42,230
the other<font color="#E5E5E5"> end of this attack and you</font>

1094
00:39:40,069 --> 00:39:43,520
<font color="#CCCCCC">perceive well as invalid certs</font><font color="#E5E5E5"> that's</font>

1095
00:39:42,230 --> 00:39:45,170
the message you<font color="#CCCCCC"> received like in</font><font color="#E5E5E5"> Windows</font>

1096
00:39:43,520 --> 00:39:46,940
<font color="#CCCCCC">it'll say like do you expect</font><font color="#E5E5E5"> to find</font>

1097
00:39:45,170 --> 00:39:48,829
example Wi-Fi

1098
00:39:46,940 --> 00:39:50,630
this location<font color="#E5E5E5"> and you know you were just</font>

1099
00:39:48,829 --> 00:39:52,280
connected<font color="#E5E5E5"> to this</font><font color="#CCCCCC"> thing like five</font>

1100
00:39:50,630 --> 00:39:53,359
minutes ago<font color="#E5E5E5"> or five seconds</font><font color="#CCCCCC"> ago so of</font>

1101
00:39:52,280 --> 00:39:54,770
course you're expecting to find it there

1102
00:39:53,359 --> 00:39:58,130
I mean it so it<font color="#E5E5E5"> doesn't say anything</font>

1103
00:39:54,770 --> 00:40:07,520
<font color="#CCCCCC">about a sir warning</font><font color="#E5E5E5"> so that's I find</font>

1104
00:39:58,130 --> 00:40:08,690
that<font color="#E5E5E5"> interesting but</font><font color="#CCCCCC"> yeah so client's</font>

1105
00:40:07,520 --> 00:40:09,829
going to go<font color="#CCCCCC"> ahead and connect</font><font color="#E5E5E5"> and then</font>

1106
00:40:08,690 --> 00:40:11,900
instantly do you see how<font color="#E5E5E5"> internet</font><font color="#CCCCCC"> store</font>

1107
00:40:09,829 --> 00:40:13,190
just<font color="#CCCCCC"> like randomly opens itself to say</font>

1108
00:40:11,900 --> 00:40:19,190
congrats you're on a<font color="#CCCCCC"> Wi-Fi and then</font>

1109
00:40:13,190 --> 00:40:21,020
instantly<font color="#E5E5E5"> you have you have hashes so</font>

1110
00:40:19,190 --> 00:40:22,430
that's the attack against the<font color="#E5E5E5"> AP so what</font>

1111
00:40:21,020 --> 00:40:24,560
does<font color="#E5E5E5"> this get you it gets you lots and</font>

1112
00:40:22,430 --> 00:40:26,000
lots of ntlm hashes<font color="#CCCCCC"> it's very similar to</font>

1113
00:40:24,560 --> 00:40:27,170
element<font color="#CCCCCC"> aren't</font><font color="#E5E5E5"> MBT nuts poisoning in</font>

1114
00:40:26,000 --> 00:40:29,119
fact it<font color="#CCCCCC"> actually uses</font><font color="#E5E5E5"> that in the</font>

1115
00:40:27,170 --> 00:40:30,650
background<font color="#E5E5E5"> in case that</font><font color="#CCCCCC"> you don't</font><font color="#E5E5E5"> get</font>

1116
00:40:29,119 --> 00:40:32,450
those HTTP requests you can<font color="#E5E5E5"> redirect you</font>

1117
00:40:30,650 --> 00:40:34,400
could still poison element<font color="#CCCCCC"> are at MPT</font>

1118
00:40:32,450 --> 00:40:36,140
<font color="#CCCCCC">and s</font><font color="#E5E5E5"> but the cool</font><font color="#CCCCCC"> thing is you no</font>

1119
00:40:34,400 --> 00:40:37,730
longer<font color="#E5E5E5"> need</font><font color="#CCCCCC"> direct network</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> and</font>

1120
00:40:36,140 --> 00:40:39,589
it's also not limited<font color="#CCCCCC"> to a local subnet</font>

1121
00:40:37,730 --> 00:40:41,839
<font color="#CCCCCC">you get</font><font color="#E5E5E5"> everything</font><font color="#CCCCCC"> that's connected</font><font color="#E5E5E5"> to</font>

1122
00:40:39,589 --> 00:40:43,099
the wireless<font color="#CCCCCC"> and it's also not a passive</font>

1123
00:40:41,839 --> 00:40:44,750
attack before<font color="#CCCCCC"> you're waiting for them</font><font color="#E5E5E5"> to</font>

1124
00:40:43,099 --> 00:40:47,480
send stuff<font color="#CCCCCC"> to you for them to make these</font>

1125
00:40:44,750 --> 00:40:48,680
requests<font color="#E5E5E5"> and now you're you're you're</font>

1126
00:40:47,480 --> 00:40:50,599
actually forcing them<font color="#CCCCCC"> to make these</font><font color="#E5E5E5"> sort</font>

1127
00:40:48,680 --> 00:40:52,430
of us so it's a little<font color="#E5E5E5"> more</font><font color="#CCCCCC"> active</font><font color="#E5E5E5"> back</font>

1128
00:40:50,599 --> 00:40:53,810
to our scenario<font color="#E5E5E5"> we're gonna talk about</font>

1129
00:40:52,430 --> 00:40:57,440
indirect<font color="#CCCCCC"> wireless pivots so</font><font color="#E5E5E5"> it's kind of</font>

1130
00:40:53,810 --> 00:41:00,710
how we can<font color="#E5E5E5"> use</font><font color="#CCCCCC"> this to bypass necks</font><font color="#E5E5E5"> on</font>

1131
00:40:57,440 --> 00:41:02,089
wireless right so what we're gonna be

1132
00:41:00,710 --> 00:41:05,000
<font color="#CCCCCC">doing is</font><font color="#E5E5E5"> we're going to be incorporating</font>

1133
00:41:02,089 --> 00:41:06,319
stuff we<font color="#CCCCCC"> just talked about into and</font>

1134
00:41:05,000 --> 00:41:09,020
using<font color="#E5E5E5"> it's a</font><font color="#CCCCCC"> bypass pork</font><font color="#E5E5E5"> based actual</font>

1135
00:41:06,319 --> 00:41:10,880
control mechanisms and remember here we

1136
00:41:09,020 --> 00:41:12,230
had were these attacker on<font color="#E5E5E5"> the on the</font>

1137
00:41:10,880 --> 00:41:13,099
left and we're trying to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> over here</font>

1138
00:41:12,230 --> 00:41:15,319
where all<font color="#E5E5E5"> the cooties aren't the</font>

1139
00:41:13,099 --> 00:41:16,609
sensitive resources<font color="#E5E5E5"> so we're here on</font>

1140
00:41:15,319 --> 00:41:18,380
<font color="#E5E5E5">this quarantine VLAN oh we want to get</font>

1141
00:41:16,609 --> 00:41:20,240
<font color="#E5E5E5">over to the restricted VLAN yeah but</font>

1142
00:41:18,380 --> 00:41:21,800
there's this<font color="#CCCCCC"> this pesky</font><font color="#E5E5E5"> nack in the way</font>

1143
00:41:20,240 --> 00:41:22,790
and<font color="#E5E5E5"> it's it's</font><font color="#CCCCCC"> kind of put us on</font><font color="#E5E5E5"> this on</font>

1144
00:41:21,800 --> 00:41:25,190
this quarantine deal and we're kind of

1145
00:41:22,790 --> 00:41:26,869
stuck<font color="#E5E5E5"> well you know using what we just</font>

1146
00:41:25,190 --> 00:41:28,430
<font color="#E5E5E5">what we just learned we could use a</font>

1147
00:41:26,869 --> 00:41:30,170
rogue ap attack to force the<font color="#CCCCCC"> victim to</font>

1148
00:41:28,430 --> 00:41:32,450
associate with<font color="#E5E5E5"> us</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> that would be</font>

1149
00:41:30,170 --> 00:41:33,950
step<font color="#CCCCCC"> one step two you could</font><font color="#E5E5E5"> use a</font>

1150
00:41:32,450 --> 00:41:35,720
redirect test and be a hostile portal

1151
00:41:33,950 --> 00:41:38,740
attack to<font color="#CCCCCC"> obtain</font><font color="#E5E5E5"> NC</font><font color="#CCCCCC"> LM hashes from the</font>

1152
00:41:35,720 --> 00:41:40,819
victim crack them offline<font color="#E5E5E5"> you know and</font>

1153
00:41:38,740 --> 00:41:42,109
then you can use that<font color="#CCCCCC"> to authenticate</font>

1154
00:41:40,819 --> 00:41:43,099
with<font color="#E5E5E5"> the victim and you know at this</font>

1155
00:41:42,109 --> 00:41:44,720
<font color="#E5E5E5">point you might have to come back and</font>

1156
00:41:43,099 --> 00:41:46,490
pick up<font color="#CCCCCC"> where you</font><font color="#E5E5E5"> left off depending how</font>

1157
00:41:44,720 --> 00:41:47,868
long<font color="#E5E5E5"> tracking those hashes took but at</font>

1158
00:41:46,490 --> 00:41:50,180
this point<font color="#CCCCCC"> you</font><font color="#E5E5E5"> shown the payload</font><font color="#CCCCCC"> to the</font>

1159
00:41:47,869 --> 00:41:51,319
victim and<font color="#E5E5E5"> you know you could use</font><font color="#CCCCCC"> like a</font>

1160
00:41:50,180 --> 00:41:52,730
scheduled<font color="#E5E5E5"> task or something</font><font color="#CCCCCC"> like that</font>

1161
00:41:51,319 --> 00:41:54,890
<font color="#E5E5E5">some kind</font><font color="#CCCCCC"> of time payload something that</font>

1162
00:41:52,730 --> 00:41:56,540
will not execute<font color="#E5E5E5"> right away and then you</font>

1163
00:41:54,890 --> 00:41:58,060
kill your rogue<font color="#E5E5E5"> ap and allow them to</font>

1164
00:41:56,540 --> 00:42:00,560
reconnect<font color="#CCCCCC"> to that</font><font color="#E5E5E5"> wireless</font><font color="#CCCCCC"> network the</font>

1165
00:41:58,060 --> 00:42:00,869
<font color="#CCCCCC">victim ends up being put back on to the</font>

1166
00:42:00,560 --> 00:42:01,769
<font color="#E5E5E5">research</font>

1167
00:42:00,869 --> 00:42:02,849
<font color="#E5E5E5">vielen because</font><font color="#CCCCCC"> they're still</font><font color="#E5E5E5"> an</font>

1168
00:42:01,769 --> 00:42:05,399
authorized<font color="#E5E5E5"> endpoint that's why the five</font>

1169
00:42:02,849 --> 00:42:07,259
<font color="#CCCCCC">used like attack them and you</font><font color="#E5E5E5"> just wait</font>

1170
00:42:05,400 --> 00:42:08,490
for<font color="#E5E5E5"> the reverse shell and boom now the</font>

1171
00:42:07,259 --> 00:42:09,960
<font color="#E5E5E5">snack could be the most effective</font>

1172
00:42:08,490 --> 00:42:11,459
network access control<font color="#E5E5E5"> mechanism out</font>

1173
00:42:09,960 --> 00:42:14,160
there you know this this<font color="#E5E5E5"> could</font><font color="#CCCCCC"> be like</font>

1174
00:42:11,460 --> 00:42:16,499
<font color="#E5E5E5">the</font><font color="#CCCCCC"> death star of next and it would</font>

1175
00:42:14,160 --> 00:42:18,180
matter<font color="#CCCCCC"> because</font><font color="#E5E5E5"> because you know when you</font>

1176
00:42:16,499 --> 00:42:20,970
attack<font color="#E5E5E5"> this victim over</font><font color="#CCCCCC"> here you</font><font color="#E5E5E5"> weren't</font>

1177
00:42:18,180 --> 00:42:22,319
on this protected<font color="#CCCCCC"> network so I think</font>

1178
00:42:20,970 --> 00:42:23,189
that's kind<font color="#CCCCCC"> of where you know I think</font>

1179
00:42:22,319 --> 00:42:25,200
<font color="#E5E5E5">we're missing the point</font>

1180
00:42:23,190 --> 00:42:28,170
using<font color="#CCCCCC"> knacks for breach containment is</font>

1181
00:42:25,200 --> 00:42:29,430
that if you can't trust<font color="#CCCCCC"> well-well talk</font>

1182
00:42:28,170 --> 00:42:30,660
<font color="#CCCCCC">about more you see where I'm going it</font>

1183
00:42:29,430 --> 00:42:32,368
but a better approach<font color="#E5E5E5"> to this by</font><font color="#CCCCCC"> the way</font>

1184
00:42:30,660 --> 00:42:34,529
would be<font color="#E5E5E5"> it using an SMB relay attack</font>

1185
00:42:32,369 --> 00:42:36,720
I remember here but let's say that<font color="#E5E5E5"> we</font>

1186
00:42:34,529 --> 00:42:38,759
have a couple<font color="#E5E5E5"> victims and you need more</font>

1187
00:42:36,720 --> 00:42:40,499
than<font color="#E5E5E5"> one victim to do this you</font>

1188
00:42:38,759 --> 00:42:42,660
unfortunately cannot just like do an SMB

1189
00:42:40,499 --> 00:42:44,249
relay attack<font color="#E5E5E5"> you know from the victim to</font>

1190
00:42:42,660 --> 00:42:45,269
<font color="#CCCCCC">the victim and the reason for that is</font>

1191
00:42:44,249 --> 00:42:47,788
it's called<font color="#E5E5E5"> that's actually called an</font>

1192
00:42:45,269 --> 00:42:49,470
SMB reflection attack and that<font color="#E5E5E5"> wasn't</font>

1193
00:42:47,789 --> 00:42:51,779
exactly was so effective in 2008

1194
00:42:49,470 --> 00:42:54,450
<font color="#E5E5E5">Microsoft</font><font color="#CCCCCC"> released service patch called</font>

1195
00:42:51,779 --> 00:42:57,749
<font color="#CCCCCC">MS zero eight zero six eight so that's</font>

1196
00:42:54,450 --> 00:42:59,640
just<font color="#E5E5E5"> kind of tells you how yeah</font><font color="#CCCCCC"> so that</font>

1197
00:42:57,749 --> 00:43:02,279
you can't do that anymore but you can

1198
00:42:59,640 --> 00:43:04,410
<font color="#CCCCCC">still do it and be really at that and</font>

1199
00:43:02,279 --> 00:43:05,880
what<font color="#E5E5E5"> that would look like it's</font><font color="#CCCCCC"> use a</font>

1200
00:43:04,410 --> 00:43:09,359
rogue<font color="#E5E5E5"> ap attack to force the victims to</font>

1201
00:43:05,880 --> 00:43:10,680
<font color="#E5E5E5">to to to</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> your</font><font color="#E5E5E5"> own ap</font><font color="#CCCCCC"> they're now</font>

1202
00:43:09,359 --> 00:43:13,440
<font color="#E5E5E5">on your network</font><font color="#CCCCCC"> you can do it what you</font>

1203
00:43:10,680 --> 00:43:15,029
want with them<font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> use the</font>

1204
00:43:13,440 --> 00:43:16,529
hostile portal technique again but this

1205
00:43:15,029 --> 00:43:17,640
<font color="#E5E5E5">time instead of simply capturing hashes</font>

1206
00:43:16,529 --> 00:43:19,079
we're going to perform<font color="#CCCCCC"> s</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> B really</font>

1207
00:43:17,640 --> 00:43:21,690
<font color="#CCCCCC">attack from one victim to the other</font><font color="#E5E5E5"> and</font>

1208
00:43:19,079 --> 00:43:23,700
use that to place a time payload on on

1209
00:43:21,690 --> 00:43:25,380
<font color="#E5E5E5">one of the victims</font><font color="#CCCCCC"> allow</font><font color="#E5E5E5"> them to</font>

1210
00:43:23,700 --> 00:43:26,669
reassociate with<font color="#E5E5E5"> with their with the</font>

1211
00:43:25,380 --> 00:43:28,710
target<font color="#CCCCCC"> network</font><font color="#E5E5E5"> they get placed back on</font>

1212
00:43:26,670 --> 00:43:30,059
the research<font color="#CCCCCC"> to</font><font color="#E5E5E5"> VLANs before and you</font>

1213
00:43:28,710 --> 00:43:32,130
simply just<font color="#CCCCCC"> wait there for the for the</font>

1214
00:43:30,059 --> 00:43:34,680
nice juicy reverse shell<font color="#E5E5E5"> and you get</font>

1215
00:43:32,130 --> 00:43:38,089
<font color="#CCCCCC">access to</font><font color="#E5E5E5"> all this stuff so that's</font><font color="#CCCCCC"> an</font>

1216
00:43:34,680 --> 00:43:40,288
indirect pivot the way<font color="#CCCCCC"> this is going</font>

1217
00:43:38,089 --> 00:43:44,999
almost<font color="#CCCCCC"> time</font><font color="#E5E5E5"> to have like</font><font color="#CCCCCC"> four fifteen</font>

1218
00:43:40,289 --> 00:43:48,839
<font color="#E5E5E5">minutes</font><font color="#CCCCCC"> ten alright</font><font color="#E5E5E5"> so this rate I don't</font>

1219
00:43:44,999 --> 00:43:49,980
<font color="#E5E5E5">trust any of this to work so</font><font color="#CCCCCC"> we're</font>

1220
00:43:48,839 --> 00:43:51,619
<font color="#CCCCCC">just good we're just we're just going to</font>

1221
00:43:49,980 --> 00:43:53,789
say<font color="#E5E5E5"> screw it and go with this and</font>

1222
00:43:51,619 --> 00:43:57,779
whatever<font color="#E5E5E5"> if you want me to give you a</font>

1223
00:43:53,789 --> 00:44:01,249
demo<font color="#E5E5E5"> later just come find</font><font color="#CCCCCC"> me we'll do it</font>

1224
00:43:57,779 --> 00:44:05,160
<font color="#E5E5E5">inside a Faraday cage or</font><font color="#CCCCCC"> something so</font>

1225
00:44:01,249 --> 00:44:06,930
you<font color="#E5E5E5"> know as before oh goodness me so as</font>

1226
00:44:05,160 --> 00:44:08,308
<font color="#E5E5E5">before we</font><font color="#CCCCCC"> have our</font><font color="#E5E5E5"> two victims right you</font>

1227
00:44:06,930 --> 00:44:09,450
know left<font color="#CCCCCC"> and right but we're also gonna</font>

1228
00:44:08,309 --> 00:44:12,119
<font color="#E5E5E5">have our attacker we're gonna be using</font>

1229
00:44:09,450 --> 00:44:14,089
<font color="#E5E5E5">Empire for this it's a because use that</font>

1230
00:44:12,119 --> 00:44:15,470
<font color="#CCCCCC">power before</font>

1231
00:44:14,090 --> 00:44:16,940
oh cool you<font color="#CCCCCC"> should go check this out as</font>

1232
00:44:15,470 --> 00:44:19,069
well<font color="#CCCCCC"> cuz it's</font><font color="#E5E5E5"> pretty</font><font color="#CCCCCC"> awesome it's a</font>

1233
00:44:16,940 --> 00:44:20,420
<font color="#CCCCCC">PowerShell post exploitation</font><font color="#E5E5E5"> framework</font>

1234
00:44:19,070 --> 00:44:24,050
<font color="#E5E5E5">think of it as like</font><font color="#CCCCCC"> Metasploit but for</font>

1235
00:44:20,420 --> 00:44:25,880
attacking Active Directory<font color="#CCCCCC"> and</font><font color="#E5E5E5"> we have</font>

1236
00:44:24,050 --> 00:44:27,680
our our our<font color="#E5E5E5"> access point running in the</font>

1237
00:44:25,880 --> 00:44:32,390
legitimate<font color="#E5E5E5"> access point running in the</font>

1238
00:44:27,680 --> 00:44:37,430
bottom left and we're<font color="#CCCCCC"> going to create</font>

1239
00:44:32,390 --> 00:44:38,629
<font color="#CCCCCC">two</font><font color="#E5E5E5"> Empire listeners</font><font color="#CCCCCC"> we have a switch</font>

1240
00:44:37,430 --> 00:44:39,799
which<font color="#CCCCCC"> is we're going</font><font color="#E5E5E5"> to be using</font><font color="#CCCCCC"> for our</font>

1241
00:44:38,630 --> 00:44:40,850
<font color="#E5E5E5">pivot and we're going to be using</font>

1242
00:44:39,800 --> 00:44:42,400
initial and that's the<font color="#CCCCCC"> initial one that</font>

1243
00:44:40,850 --> 00:44:46,610
we're going<font color="#E5E5E5"> to use to</font><font color="#CCCCCC"> perform</font><font color="#E5E5E5"> the attack</font>

1244
00:44:42,400 --> 00:44:47,870
<font color="#E5E5E5">and we're going to what we're doing</font><font color="#CCCCCC"> here</font>

1245
00:44:46,610 --> 00:44:48,800
is we're creating a<font color="#E5E5E5"> stager so a stage</font>

1246
00:44:47,870 --> 00:44:52,580
<font color="#E5E5E5">here it's basically</font><font color="#CCCCCC"> the code that's</font>

1247
00:44:48,800 --> 00:44:54,400
<font color="#E5E5E5">gonna run on the target on the target to</font>

1248
00:44:52,580 --> 00:44:57,140
send us the<font color="#E5E5E5"> the initial reverse shell</font>

1249
00:44:54,400 --> 00:44:59,030
everybody's using SMB relay<font color="#E5E5E5"> acts which</font>

1250
00:44:57,140 --> 00:45:01,009
is part<font color="#E5E5E5"> of the impact of</font><font color="#CCCCCC"> suite to</font>

1251
00:44:59,030 --> 00:45:02,060
perform our our SMB real attack

1252
00:45:01,010 --> 00:45:03,230
realistically you could use anything

1253
00:45:02,060 --> 00:45:05,000
that<font color="#E5E5E5"> you could just use multi relay</font>

1254
00:45:03,230 --> 00:45:07,970
which is built<font color="#E5E5E5"> into responder you</font><font color="#CCCCCC"> could</font>

1255
00:45:05,000 --> 00:45:09,620
use all kinds of stuff<font color="#E5E5E5"> now we're</font>

1256
00:45:07,970 --> 00:45:12,200
<font color="#CCCCCC">matching</font><font color="#E5E5E5"> we're using a pameron</font><font color="#CCCCCC"> su</font><font color="#E5E5E5"> mounts</font>

1257
00:45:09,620 --> 00:45:13,430
<font color="#E5E5E5">our rogue access point attack and you</font>

1258
00:45:12,200 --> 00:45:17,359
know as before<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> gonna get it to</font>

1259
00:45:13,430 --> 00:45:19,129
<font color="#E5E5E5">Rome from the</font><font color="#CCCCCC"> legitimate apt to us</font><font color="#E5E5E5"> just</font>

1260
00:45:17,360 --> 00:45:23,980
by spamming<font color="#E5E5E5"> the off packets with every</font>

1261
00:45:19,130 --> 00:45:26,900
play and<font color="#CCCCCC"> gonna do</font><font color="#E5E5E5"> that about a second</font>

1262
00:45:23,980 --> 00:45:31,010
and you<font color="#E5E5E5"> can see all right so we got one</font>

1263
00:45:26,900 --> 00:45:34,880
<font color="#CCCCCC">to connect there and we've</font><font color="#E5E5E5"> got the</font>

1264
00:45:31,010 --> 00:45:36,140
second one<font color="#E5E5E5"> to connect so we now have we</font>

1265
00:45:34,880 --> 00:45:38,420
now have two of these guys associated

1266
00:45:36,140 --> 00:45:40,190
with us<font color="#E5E5E5"> which is which is what we want</font>

1267
00:45:38,420 --> 00:45:42,110
<font color="#E5E5E5">so the second thing that's gonna happen</font>

1268
00:45:40,190 --> 00:45:43,580
is<font color="#CCCCCC"> we're going to take that that code</font>

1269
00:45:42,110 --> 00:45:45,800
that's gonna be<font color="#E5E5E5"> executed on the target</font>

1270
00:45:43,580 --> 00:45:49,220
machine<font color="#CCCCCC"> and we're going</font><font color="#E5E5E5"> to sleep are</font>

1271
00:45:45,800 --> 00:45:51,230
going to we're gonna feed it to SMB

1272
00:45:49,220 --> 00:45:52,490
relay acts just<font color="#E5E5E5"> going to perform our SMB</font>

1273
00:45:51,230 --> 00:45:53,930
relay attack<font color="#CCCCCC"> right now we're grabbing a</font>

1274
00:45:52,490 --> 00:45:59,240
legitimate IP address from<font color="#E5E5E5"> one of the</font>

1275
00:45:53,930 --> 00:46:02,180
two victims<font color="#E5E5E5"> and then you go back here</font>

1276
00:45:59,240 --> 00:46:03,350
<font color="#E5E5E5">and we</font><font color="#CCCCCC"> just kind of paste it you can</font>

1277
00:46:02,180 --> 00:46:06,980
kind of see in the bottom<font color="#E5E5E5"> right</font>

1278
00:46:03,350 --> 00:46:08,440
we've<font color="#E5E5E5"> just pasted it into SMB relay X</font>

1279
00:46:06,980 --> 00:46:10,880
and and we're gonna<font color="#E5E5E5"> execute this attack</font>

1280
00:46:08,440 --> 00:46:14,300
<font color="#E5E5E5">and it's gonna perform the</font><font color="#CCCCCC"> ESP relay</font>

1281
00:46:10,880 --> 00:46:15,380
attack<font color="#E5E5E5"> so now we're gonna do something</font>

1282
00:46:14,300 --> 00:46:17,750
<font color="#E5E5E5">we're gonna kind of help this along</font>

1283
00:46:15,380 --> 00:46:22,460
<font color="#E5E5E5">we're gonna have to do something on the</font>

1284
00:46:17,750 --> 00:46:25,790
target<font color="#CCCCCC"> machine that kind</font><font color="#E5E5E5"> of makes it you</font>

1285
00:46:22,460 --> 00:46:27,330
<font color="#E5E5E5">know set of sense he LEM hashes should I</font>

1286
00:46:25,790 --> 00:46:30,960
figure out where<font color="#CCCCCC"> that was</font>

1287
00:46:27,330 --> 00:46:32,279
<font color="#E5E5E5">okay so obviously was somewhere in there</font>

1288
00:46:30,960 --> 00:46:33,660
<font color="#E5E5E5">but we</font><font color="#CCCCCC"> just wait for</font><font color="#E5E5E5"> the hatchets and</font>

1289
00:46:32,280 --> 00:46:35,520
you see here<font color="#E5E5E5"> it says initial agent and</font>

1290
00:46:33,660 --> 00:46:39,029
has<font color="#E5E5E5"> a certain characters and it says</font>

1291
00:46:35,520 --> 00:46:41,220
10.0.0.0 which is one<font color="#E5E5E5"> of our victims</font><font color="#CCCCCC"> so</font>

1292
00:46:39,030 --> 00:46:42,540
we received a<font color="#E5E5E5"> connect back from one of</font>

1293
00:46:41,220 --> 00:46:44,939
our<font color="#CCCCCC"> victims and they're still associated</font>

1294
00:46:42,540 --> 00:46:46,710
<font color="#E5E5E5">with our our access play at this point</font>

1295
00:46:44,940 --> 00:46:48,950
<font color="#E5E5E5">and right now just</font><font color="#CCCCCC"> kind of show</font><font color="#E5E5E5"> where we</font>

1296
00:46:46,710 --> 00:46:51,960
<font color="#CCCCCC">are</font><font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> gonna type use module</font>

1297
00:46:48,950 --> 00:46:54,000
<font color="#E5E5E5">persistence elevated scheduled tasks and</font>

1298
00:46:51,960 --> 00:46:58,080
that's how we're gonna go about<font color="#E5E5E5"> this and</font>

1299
00:46:54,000 --> 00:47:00,180
we're<font color="#E5E5E5"> going to essentially just set this</font>

1300
00:46:58,080 --> 00:47:01,220
you know<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> before we continue</font>

1301
00:47:00,180 --> 00:47:04,230
<font color="#E5E5E5">with</font><font color="#CCCCCC"> that we're gonna do</font><font color="#E5E5E5"> shell</font>

1302
00:47:01,220 --> 00:47:06,600
anti-authority system<font color="#E5E5E5"> that tells you</font>

1303
00:47:04,230 --> 00:47:08,010
what<font color="#E5E5E5"> privileges we have and we do shell</font>

1304
00:47:06,600 --> 00:47:10,080
<font color="#E5E5E5">hostname that'll tell us which</font><font color="#CCCCCC"> of these</font>

1305
00:47:08,010 --> 00:47:11,220
hosts were all so we're attacking<font color="#E5E5E5"> Leroy</font>

1306
00:47:10,080 --> 00:47:12,720
<font color="#CCCCCC">your</font><font color="#E5E5E5"> attendance</font><font color="#CCCCCC"> looks like we're</font>

1307
00:47:11,220 --> 00:47:15,600
attacking Jenkins<font color="#E5E5E5"> okay based on our</font>

1308
00:47:12,720 --> 00:47:17,700
output there so the next thing we're

1309
00:47:15,600 --> 00:47:19,140
<font color="#E5E5E5">gonna do is we're going to set the</font>

1310
00:47:17,700 --> 00:47:21,870
scheduled tasks that execute a couple

1311
00:47:19,140 --> 00:47:25,100
minutes into the future<font color="#E5E5E5"> this little</font>

1312
00:47:21,870 --> 00:47:25,100
<font color="#E5E5E5">thing on the bottom</font><font color="#CCCCCC"> he's popping</font><font color="#E5E5E5"> up so</font>

1313
00:47:26,360 --> 00:47:31,920
so set daily time<font color="#CCCCCC"> total tasks</font><font color="#E5E5E5"> and by the</font>

1314
00:47:30,210 --> 00:47:33,510
way<font color="#CCCCCC"> I note about</font><font color="#E5E5E5"> using a scheduled tasks</font>

1315
00:47:31,920 --> 00:47:40,620
for<font color="#E5E5E5"> this it's really great from a</font>

1316
00:47:33,510 --> 00:47:42,900
proof-of-concept perspective<font color="#CCCCCC"> but like</font>

1317
00:47:40,620 --> 00:47:44,549
you know<font color="#E5E5E5"> in a real pen testing area you</font>

1318
00:47:42,900 --> 00:47:45,600
<font color="#CCCCCC">probably actually</font><font color="#E5E5E5"> want to use like</font>

1319
00:47:44,550 --> 00:47:46,950
something with it's a<font color="#E5E5E5"> little stealth</font>

1320
00:47:45,600 --> 00:47:47,819
<font color="#E5E5E5">here because</font><font color="#CCCCCC"> scheduled tasks touch</font><font color="#E5E5E5"> disk</font>

1321
00:47:46,950 --> 00:47:49,049
<font color="#E5E5E5">so you want something</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> lives</font>

1322
00:47:47,820 --> 00:47:50,370
completely<font color="#E5E5E5"> in memory but I mean there's</font>

1323
00:47:49,050 --> 00:47:53,820
other stuff like<font color="#E5E5E5"> you can do you can hook</font>

1324
00:47:50,370 --> 00:47:55,020
into the you know<font color="#CCCCCC"> like</font><font color="#E5E5E5"> something like a</font>

1325
00:47:53,820 --> 00:47:57,990
network<font color="#E5E5E5"> change event or something when</font>

1326
00:47:55,020 --> 00:47:59,430
they<font color="#E5E5E5"> only switch back anyways so we're</font>

1327
00:47:57,990 --> 00:48:02,459
<font color="#CCCCCC">sitting</font><font color="#E5E5E5"> our listener here we're</font><font color="#CCCCCC"> just set</font>

1328
00:47:59,430 --> 00:48:03,569
our listener to our second listener and

1329
00:48:02,460 --> 00:48:07,880
I'm gonna just<font color="#E5E5E5"> kind of fast-forward</font>

1330
00:48:03,570 --> 00:48:10,980
through this<font color="#CCCCCC"> sorry running out of time</font>

1331
00:48:07,880 --> 00:48:16,170
<font color="#E5E5E5">and something interesting happened when</font>

1332
00:48:10,980 --> 00:48:17,790
I<font color="#E5E5E5"> recorded this right so so you're close</font>

1333
00:48:16,170 --> 00:48:22,290
to the thing I've killed or I will be

1334
00:48:17,790 --> 00:48:24,230
<font color="#E5E5E5">killing the rogue access point</font><font color="#CCCCCC"> so it</font>

1335
00:48:22,290 --> 00:48:27,120
should just<font color="#E5E5E5"> be connected back to the</font>

1336
00:48:24,230 --> 00:48:30,090
<font color="#E5E5E5">target</font><font color="#CCCCCC"> network</font><font color="#E5E5E5"> yeah there you go</font>

1337
00:48:27,120 --> 00:48:32,490
but the problem is that<font color="#E5E5E5"> when I recorded</font>

1338
00:48:30,090 --> 00:48:34,200
this<font color="#CCCCCC"> I actually didn't have the</font><font color="#E5E5E5"> proper</font>

1339
00:48:32,490 --> 00:48:35,790
<font color="#CCCCCC">network adapter plugged in and I decided</font>

1340
00:48:34,200 --> 00:48:37,410
<font color="#E5E5E5">to keep this</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> because</font>

1341
00:48:35,790 --> 00:48:39,540
something<font color="#E5E5E5"> really interesting happened</font>

1342
00:48:37,410 --> 00:48:41,460
when this occurred

1343
00:48:39,540 --> 00:48:44,310
<font color="#CCCCCC">I actually started</font><font color="#E5E5E5"> I still you know I</font>

1344
00:48:41,460 --> 00:48:45,090
actually replugged<font color="#CCCCCC"> I figure out where</font><font color="#E5E5E5"> it</font>

1345
00:48:44,310 --> 00:48:47,100
was<font color="#E5E5E5"> yeah</font>

1346
00:48:45,090 --> 00:48:50,340
so here I'm plugging the network<font color="#E5E5E5"> adapter</font>

1347
00:48:47,100 --> 00:48:53,220
back in and I'm getting<font color="#E5E5E5"> ready to simply</font>

1348
00:48:50,340 --> 00:48:55,890
start be recording this again<font color="#E5E5E5"> but we end</font>

1349
00:48:53,220 --> 00:48:57,870
up<font color="#E5E5E5"> seeing here is</font><font color="#CCCCCC"> that as soon as</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> plug</font>

1350
00:48:55,890 --> 00:48:59,819
the network adapter back in the agent

1351
00:48:57,870 --> 00:49:01,830
still connects back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> me so that's that</font>

1352
00:48:59,820 --> 00:49:03,540
proves<font color="#E5E5E5"> an interesting point about a good</font>

1353
00:49:01,830 --> 00:49:04,830
implants or good<font color="#CCCCCC"> malware's that</font><font color="#E5E5E5"> you know</font>

1354
00:49:03,540 --> 00:49:06,120
it<font color="#E5E5E5"> will keep trying to persist you know</font>

1355
00:49:04,830 --> 00:49:09,690
doggedly connect back to the attacker

1356
00:49:06,120 --> 00:49:11,339
<font color="#E5E5E5">regardless of whether or not it has it</font>

1357
00:49:09,690 --> 00:49:12,810
has<font color="#CCCCCC"> network</font><font color="#E5E5E5"> Isis or not you know in this</font>

1358
00:49:11,340 --> 00:49:14,340
case I had a<font color="#CCCCCC"> hundred sixty three tries</font>

1359
00:49:12,810 --> 00:49:16,590
set on this thing and<font color="#CCCCCC"> that's why white</font>

1360
00:49:14,340 --> 00:49:18,990
did that<font color="#E5E5E5"> so there you are you</font><font color="#CCCCCC"> know we're</font>

1361
00:49:16,590 --> 00:49:20,370
now we've received the agent

1362
00:49:18,990 --> 00:49:22,080
we're gonna run shell<font color="#E5E5E5"> hostname again</font>

1363
00:49:20,370 --> 00:49:24,380
that will give us the<font color="#E5E5E5"> hostname just kind</font>

1364
00:49:22,080 --> 00:49:27,799
<font color="#CCCCCC">of show where we're connected to and</font>

1365
00:49:24,380 --> 00:49:27,800
wait for it

1366
00:49:31,820 --> 00:49:35,910
yeah<font color="#E5E5E5"> there we are Jenkins was our</font>

1367
00:49:34,440 --> 00:49:39,230
<font color="#CCCCCC">initial host that we were</font><font color="#E5E5E5"> connected to</font>

1368
00:49:35,910 --> 00:49:41,250
before so I gotta wrap this<font color="#E5E5E5"> up but</font>

1369
00:49:39,230 --> 00:49:43,200
indirect<font color="#CCCCCC"> wired Wireless</font><font color="#E5E5E5"> pivots I mean</font>

1370
00:49:41,250 --> 00:49:44,460
the equivalent technique would<font color="#CCCCCC"> be in a</font>

1371
00:49:43,200 --> 00:49:46,169
wired network<font color="#CCCCCC"> or because literally</font>

1372
00:49:44,460 --> 00:49:47,700
unplugging a device from from the switch

1373
00:49:46,170 --> 00:49:49,140
and plugging it into your own network

1374
00:49:47,700 --> 00:49:50,879
where you<font color="#CCCCCC"> can attack it</font><font color="#E5E5E5"> and that would</font>

1375
00:49:49,140 --> 00:49:53,250
<font color="#E5E5E5">allow you to bypass like it or</font><font color="#CCCCCC"> treat out</font>

1376
00:49:50,880 --> 00:49:54,510
one X or<font color="#E5E5E5"> whatnot</font><font color="#CCCCCC"> so it's kind of the</font>

1377
00:49:53,250 --> 00:49:55,410
equivalent<font color="#E5E5E5"> of having physical asset</font>

1378
00:49:54,510 --> 00:49:58,230
<font color="#E5E5E5">network where you could do something</font>

1379
00:49:55,410 --> 00:50:00,450
<font color="#CCCCCC">like that you know the</font><font color="#E5E5E5"> the assumption</font>

1380
00:49:58,230 --> 00:50:02,100
<font color="#E5E5E5">you know is that poor support based</font>

1381
00:50:00,450 --> 00:50:03,240
<font color="#E5E5E5">access controls rely on the assumption</font>

1382
00:50:02,100 --> 00:50:04,560
<font color="#CCCCCC">that the physical layer can</font><font color="#E5E5E5"> be trusted</font>

1383
00:50:03,240 --> 00:50:07,169
<font color="#CCCCCC">but a wireless network</font>

1384
00:50:04,560 --> 00:50:09,330
wpa2 EAP is<font color="#E5E5E5"> pretty much all you've got</font>

1385
00:50:07,170 --> 00:50:11,730
to ensure<font color="#E5E5E5"> the</font><font color="#CCCCCC"> integrity of the physical</font>

1386
00:50:09,330 --> 00:50:13,710
layer so in weak forms like wpa2

1387
00:50:11,730 --> 00:50:15,510
EAP are used the attacker can freely

1388
00:50:13,710 --> 00:50:17,670
control<font color="#E5E5E5"> the physical</font><font color="#CCCCCC"> layer using Rho VP</font>

1389
00:50:15,510 --> 00:50:20,160
attacks<font color="#E5E5E5"> and that kind of renders</font><font color="#CCCCCC"> fort</font>

1390
00:50:17,670 --> 00:50:20,490
<font color="#CCCCCC">based in act mechanisms a kind of</font>

1391
00:50:20,160 --> 00:50:22,589
useless

1392
00:50:20,490 --> 00:50:23,879
so then what this<font color="#E5E5E5"> demonstrates</font><font color="#CCCCCC"> is that</font>

1393
00:50:22,590 --> 00:50:25,500
port<font color="#E5E5E5"> base and act mechanisms don't</font>

1394
00:50:23,880 --> 00:50:28,920
effectively mitigate the risk presented

1395
00:50:25,500 --> 00:50:31,410
<font color="#CCCCCC">by weak wpa2 EAP implementations</font><font color="#E5E5E5"> and you</font>

1396
00:50:28,920 --> 00:50:32,460
know furthermore<font color="#E5E5E5"> it demonstrates</font><font color="#CCCCCC"> that</font>

1397
00:50:31,410 --> 00:50:35,490
adding forward based enactment

1398
00:50:32,460 --> 00:50:37,410
mechanisms<font color="#CCCCCC"> you know they don't really</font>

1399
00:50:35,490 --> 00:50:39,390
<font color="#E5E5E5">make the use of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> apt TLS or</font><font color="#CCCCCC"> EBP</font>

1400
00:50:37,410 --> 00:50:41,759
penniless<font color="#CCCCCC"> inappropriate if the</font><font color="#E5E5E5"> network</font>

1401
00:50:39,390 --> 00:50:43,049
in question<font color="#CCCCCC"> it's used to</font><font color="#E5E5E5"> grant access to</font>

1402
00:50:41,760 --> 00:50:44,760
<font color="#E5E5E5">sensitive information about sense of</font>

1403
00:50:43,050 --> 00:50:46,260
information<font color="#CCCCCC"> we usually mean PCI</font><font color="#E5E5E5"> or HIPAA</font>

1404
00:50:44,760 --> 00:50:48,750
data<font color="#CCCCCC"> remember the clock compliant does</font>

1405
00:50:46,260 --> 00:50:50,370
not necessarily mean secure<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> gonna</font>

1406
00:50:48,750 --> 00:50:53,100
make a you know<font color="#E5E5E5"> I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> make a one</font>

1407
00:50:50,370 --> 00:50:54,839
<font color="#E5E5E5">last-ditch like case for EAP TLS</font><font color="#CCCCCC"> it's</font>

1408
00:50:53,100 --> 00:50:56,190
not quite as bad<font color="#CCCCCC"> as</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> used to be</font><font color="#E5E5E5"> you</font>

1409
00:50:54,840 --> 00:50:58,740
<font color="#E5E5E5">know you can use group policy</font><font color="#CCCCCC"> to simply</font>

1410
00:50:56,190 --> 00:51:00,780
configure<font color="#E5E5E5"> 8:02</font><font color="#CCCCCC"> what</font><font color="#E5E5E5"> ex-clients your best</font>

1411
00:50:58,740 --> 00:51:02,669
options to<font color="#E5E5E5"> use a private CA leverage</font>

1412
00:51:00,780 --> 00:51:04,260
Active Directory to deploy<font color="#CCCCCC"> EAP TLS</font><font color="#E5E5E5"> and</font>

1413
00:51:02,670 --> 00:51:06,170
to distribute<font color="#CCCCCC"> the</font><font color="#E5E5E5"> server search to</font>

1414
00:51:04,260 --> 00:51:08,520
clients<font color="#E5E5E5"> to bring your own device clients</font>

1415
00:51:06,170 --> 00:51:11,040
either<font color="#E5E5E5"> using either uses a really solid</font>

1416
00:51:08,520 --> 00:51:14,310
<font color="#CCCCCC">PYD already solution or</font><font color="#E5E5E5"> you use an MDM</font>

1417
00:51:11,040 --> 00:51:16,710
<font color="#E5E5E5">and you know you can actually use let's</font>

1418
00:51:14,310 --> 00:51:18,690
encrypt<font color="#E5E5E5"> so you deploy upp less although</font>

1419
00:51:16,710 --> 00:51:19,980
<font color="#CCCCCC">honestly like even the folks that</font><font color="#E5E5E5"> let's</font>

1420
00:51:18,690 --> 00:51:23,070
encrypt<font color="#E5E5E5"> say that this is</font><font color="#CCCCCC"> probably</font><font color="#E5E5E5"> not</font>

1421
00:51:19,980 --> 00:51:24,030
<font color="#E5E5E5">the best way to use our product so</font>

1422
00:51:23,070 --> 00:51:25,410
<font color="#E5E5E5">closing thoughts</font>

1423
00:51:24,030 --> 00:51:27,570
just because wireless and wired networks

1424
00:51:25,410 --> 00:51:28,950
operate<font color="#CCCCCC"> similarly at the logical level</font>

1425
00:51:27,570 --> 00:51:30,870
<font color="#E5E5E5">it does not</font><font color="#CCCCCC"> necessarily</font><font color="#E5E5E5"> mean that they</font>

1426
00:51:28,950 --> 00:51:32,819
works and operationally at the physical

1427
00:51:30,870 --> 00:51:34,049
<font color="#E5E5E5">level</font><font color="#CCCCCC"> and as</font><font color="#E5E5E5"> community we should really</font>

1428
00:51:32,820 --> 00:51:35,910
question whether it's truly a sound

1429
00:51:34,050 --> 00:51:38,280
<font color="#E5E5E5">business decision to neglect ap TLS in</font>

1430
00:51:35,910 --> 00:51:40,259
<font color="#E5E5E5">favor of reactive approaches that focus</font>

1431
00:51:38,280 --> 00:51:42,900
on<font color="#E5E5E5"> on containment rather than prevention</font>

1432
00:51:40,260 --> 00:51:45,600
<font color="#E5E5E5">and you know the needs for</font><font color="#CCCCCC"> security and</font>

1433
00:51:42,900 --> 00:51:47,400
and convenience often are at odds with

1434
00:51:45,600 --> 00:51:49,200
one<font color="#E5E5E5"> another right so it's it's really</font>

1435
00:51:47,400 --> 00:51:51,000
<font color="#E5E5E5">great</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> it's really good to maintain a</font>

1436
00:51:49,200 --> 00:51:53,640
<font color="#E5E5E5">healthy</font><font color="#CCCCCC"> skepticism to propose solutions</font>

1437
00:51:51,000 --> 00:51:55,410
that promise<font color="#E5E5E5"> both and that's it</font>

1438
00:51:53,640 --> 00:51:58,020
basically<font color="#CCCCCC"> if you want to check out</font><font color="#E5E5E5"> the</font>

1439
00:51:55,410 --> 00:51:59,850
tool<font color="#E5E5E5"> that we were using for the rogue</font><font color="#CCCCCC"> ap</font>

1440
00:51:58,020 --> 00:52:01,710
attacks<font color="#CCCCCC"> it's you can check out github</font>

1441
00:51:59,850 --> 00:52:03,839
<font color="#CCCCCC">calm slash</font><font color="#E5E5E5"> solstice / - eat hammer</font>

1442
00:52:01,710 --> 00:52:05,790
<font color="#CCCCCC">there's also going to</font><font color="#E5E5E5"> be a blog post</font>

1443
00:52:03,840 --> 00:52:08,820
about<font color="#E5E5E5"> this the GDS blog later in the</font>

1444
00:52:05,790 --> 00:52:11,279
week<font color="#CCCCCC"> actually know the URL</font><font color="#E5E5E5"> for that but</font>

1445
00:52:08,820 --> 00:52:14,420
it's<font color="#E5E5E5"> just</font><font color="#CCCCCC"> at a GC free comm</font><font color="#E5E5E5"> it's gonna</font>

1446
00:52:11,280 --> 00:52:21,130
be on there thank you hopefully<font color="#E5E5E5"> the</font>

1447
00:52:14,420 --> 00:52:26,289
[Applause]

1448
00:52:21,130 --> 00:52:34,849
does anyone<font color="#E5E5E5"> have any questions you sir</font>

1449
00:52:26,289 --> 00:52:38,599
what's up yeah<font color="#CCCCCC"> so I've got a</font><font color="#E5E5E5"> question</font>

1450
00:52:34,849 --> 00:52:40,279
<font color="#CCCCCC">and if the clients in this case had had</font>

1451
00:52:38,599 --> 00:52:43,640
come feared the system to use<font color="#E5E5E5"> the</font><font color="#CCCCCC"> EAP</font>

1452
00:52:40,279 --> 00:52:44,960
<font color="#E5E5E5">based on computer instead of users</font>

1453
00:52:43,640 --> 00:52:47,420
what kind of hashes would you collect

1454
00:52:44,960 --> 00:52:50,210
<font color="#E5E5E5">would it be</font><font color="#CCCCCC"> and LM 1 or 2</font><font color="#E5E5E5"> and how</font><font color="#CCCCCC"> would</font>

1455
00:52:47,420 --> 00:52:51,769
<font color="#CCCCCC">you use</font><font color="#E5E5E5"> it so what you're saying is if</font>

1456
00:52:50,210 --> 00:52:53,450
it's if it's<font color="#E5E5E5"> computed it's automatically</font>

1457
00:52:51,769 --> 00:52:54,859
<font color="#E5E5E5">associated with a network using a</font><font color="#CCCCCC"> PT</font><font color="#E5E5E5"> LS</font>

1458
00:52:53,450 --> 00:52:57,470
<font color="#E5E5E5">that depends on how the</font><font color="#CCCCCC"> clients</font>

1459
00:52:54,859 --> 00:52:59,779
configured<font color="#CCCCCC"> because</font><font color="#E5E5E5"> if it's configured</font>

1460
00:52:57,470 --> 00:53:04,250
correctly to reject the certificates

1461
00:52:59,779 --> 00:53:05,599
<font color="#E5E5E5">you're good but if it's if it's I mean</font>

1462
00:53:04,250 --> 00:53:07,640
<font color="#E5E5E5">sometimes you'll get clients that</font><font color="#CCCCCC"> won't</font>

1463
00:53:05,599 --> 00:53:08,779
do that<font color="#E5E5E5"> and</font><font color="#CCCCCC"> they'll just</font><font color="#E5E5E5"> you know so it</font>

1464
00:53:07,640 --> 00:53:11,328
really depends<font color="#CCCCCC"> on</font><font color="#E5E5E5"> how well the</font>

1465
00:53:08,779 --> 00:53:13,190
supplicant is configured<font color="#E5E5E5"> so</font><font color="#CCCCCC"> it could go</font>

1466
00:53:11,329 --> 00:53:15,190
either way<font color="#CCCCCC"> assuming that it's configured</font>

1467
00:53:13,190 --> 00:53:17,240
<font color="#E5E5E5">correctly and it rejects invalid certs</font>

1468
00:53:15,190 --> 00:53:20,420
<font color="#E5E5E5">then it's probably</font><font color="#CCCCCC"> alright</font>

1469
00:53:17,240 --> 00:53:24,529
<font color="#CCCCCC">ok and</font><font color="#E5E5E5"> I think</font><font color="#CCCCCC"> I put the wording wrong</font>

1470
00:53:20,420 --> 00:53:27,829
<font color="#E5E5E5">due</font><font color="#CCCCCC"> to lack of English</font><font color="#E5E5E5"> words</font><font color="#CCCCCC"> ok</font><font color="#E5E5E5"> the</font>

1471
00:53:24,529 --> 00:53:30,769
client was in a pen testing scenario

1472
00:53:27,829 --> 00:53:32,660
<font color="#CCCCCC">your</font><font color="#E5E5E5"> your</font><font color="#CCCCCC"> cognitive</font><font color="#E5E5E5"> client somebody</font>

1473
00:53:30,769 --> 00:53:35,390
that's paying you to break their system

1474
00:53:32,660 --> 00:53:37,038
yes if they implemented the EAP<font color="#E5E5E5"> but</font>

1475
00:53:35,390 --> 00:53:38,598
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> allowing Windows user</font>

1476
00:53:37,039 --> 00:53:41,319
authentication the only base it on

1477
00:53:38,599 --> 00:53:45,349
computers<font color="#E5E5E5"> and they're a part of the</font>

1478
00:53:41,319 --> 00:53:46,880
domain<font color="#CCCCCC"> well that that's the</font><font color="#E5E5E5"> plus</font><font color="#CCCCCC"> here</font>

1479
00:53:45,349 --> 00:53:49,990
talking<font color="#CCCCCC"> about if they're using radius</font>

1480
00:53:46,880 --> 00:53:52,220
instead<font color="#E5E5E5"> of using Active Directory</font>

1481
00:53:49,990 --> 00:53:53,808
are they safe if they<font color="#E5E5E5"> don't use Active</font>

1482
00:53:52,220 --> 00:53:55,669
Directory for radius authentication<font color="#CCCCCC"> and</font>

1483
00:53:53,809 --> 00:53:57,559
the answer that<font color="#E5E5E5"> is no actually because</font>

1484
00:53:55,670 --> 00:54:00,589
if if we wouldn't<font color="#CCCCCC"> have to do</font><font color="#E5E5E5"> this attack</font>

1485
00:53:57,559 --> 00:54:03,339
if people didn't do that<font color="#CCCCCC"> I guess what I</font>

1486
00:54:00,589 --> 00:54:07,549
mean<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that the original the original</font>

1487
00:54:03,339 --> 00:54:08,599
attack against EAP networks was to you

1488
00:54:07,549 --> 00:54:09,559
know<font color="#CCCCCC"> force this thing to</font><font color="#E5E5E5"> authenticate</font>

1489
00:54:08,599 --> 00:54:11,420
with you and then you steal<font color="#CCCCCC"> the radius</font>

1490
00:54:09,559 --> 00:54:13,009
credentials<font color="#E5E5E5"> if there's overlap between</font>

1491
00:54:11,420 --> 00:54:14,599
the radius credentials and the Active

1492
00:54:13,009 --> 00:54:16,789
<font color="#E5E5E5">Directory credentials and you'll end up</font>

1493
00:54:14,599 --> 00:54:18,619
<font color="#E5E5E5">with Active Directory crash holes but</font>

1494
00:54:16,789 --> 00:54:20,329
<font color="#E5E5E5">the reason why we have to go for this</font>

1495
00:54:18,619 --> 00:54:22,549
<font color="#E5E5E5">further step and</font><font color="#CCCCCC"> actually do something</font>

1496
00:54:20,329 --> 00:54:25,009
further<font color="#CCCCCC"> it's because not everyone uses</font>

1497
00:54:22,549 --> 00:54:27,619
<font color="#E5E5E5">Active Directory credentials for radius</font>

1498
00:54:25,009 --> 00:54:28,819
authentication in fact it's technically

1499
00:54:27,619 --> 00:54:30,589
better<font color="#E5E5E5"> not to</font><font color="#CCCCCC"> although I understand the</font>

1500
00:54:28,819 --> 00:54:32,740
reasons why<font color="#CCCCCC"> people do it if that</font><font color="#E5E5E5"> makes</font>

1501
00:54:30,589 --> 00:54:35,590
<font color="#CCCCCC">any</font><font color="#E5E5E5"> sense but</font><font color="#CCCCCC"> kind of answer</font>

1502
00:54:32,740 --> 00:54:39,759
questioner<font color="#CCCCCC"> okay cool stuff is there any</font>

1503
00:54:35,590 --> 00:54:41,240
more questions<font color="#CCCCCC"> Solstice thank you very</font>

1504
00:54:39,760 --> 00:54:46,740
much thank you

1505
00:54:41,240 --> 00:54:46,740
[Applause]

