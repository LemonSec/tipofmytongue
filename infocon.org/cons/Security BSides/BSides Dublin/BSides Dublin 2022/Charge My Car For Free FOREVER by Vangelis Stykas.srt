1
00:00:04,000 --> 00:00:07,359
uh welcome to my besides the dublin 2022

2
00:00:07,359 --> 00:00:10,800
talk uh charge my car for free forever

3
00:00:10,800 --> 00:00:15,200
uh first of all don't do it it's a crime

4
00:00:15,200 --> 00:00:17,760
let's get that out of the way

5
00:00:17,760 --> 00:00:20,400
uh a short intro for me

6
00:00:20,400 --> 00:00:22,720
i'm vaguely stickers i'm greek i work as

7
00:00:22,720 --> 00:00:25,039
a senior penetration api tester at

8
00:00:25,039 --> 00:00:26,720
pandas partners

9
00:00:26,720 --> 00:00:29,359
i have a couple of startups that i'm

10
00:00:29,359 --> 00:00:30,400
advising

11
00:00:30,400 --> 00:00:32,640
to secure themselves and to build

12
00:00:32,640 --> 00:00:35,280
better and more secure apis

13
00:00:35,280 --> 00:00:38,719
my research interests are mainly api for

14
00:00:38,719 --> 00:00:42,840
iot and web application security for the

15
00:00:42,840 --> 00:00:44,399
past

16
00:00:44,399 --> 00:00:45,200
year

17
00:00:45,200 --> 00:00:46,960
close to a year i have been developing a

18
00:00:46,960 --> 00:00:49,600
machine learning tool to spot

19
00:00:49,600 --> 00:00:53,280
api flows and low hanging api issues low

20
00:00:53,280 --> 00:00:57,039
hanging fruits on api issues

21
00:00:57,120 --> 00:00:59,280
you can hear my dodgy accent you might

22
00:00:59,280 --> 00:01:01,680
have heard my dodgy accent on the telly

23
00:01:01,680 --> 00:01:04,000
on a couple of programs

24
00:01:04,000 --> 00:01:07,280
usually i'm not a bad guy

25
00:01:07,280 --> 00:01:10,280
and please follow me on twitter at

26
00:01:10,280 --> 00:01:12,960
evistika's twitter handle

27
00:01:12,960 --> 00:01:15,119
so our talk today is going to be about

28
00:01:15,119 --> 00:01:17,840
electric vehicles there are two distinct

29
00:01:17,840 --> 00:01:20,720
categories of electric vehicles one is

30
00:01:20,720 --> 00:01:24,400
teslas and the other is everything else

31
00:01:24,400 --> 00:01:26,560
if you ever met a tesla owner he would

32
00:01:26,560 --> 00:01:29,119
never stop talking about his ev and how

33
00:01:29,119 --> 00:01:31,360
he's saving the world but that's a talk

34
00:01:31,360 --> 00:01:33,119
for another time

35
00:01:33,119 --> 00:01:35,520
the car industry is trying to switch to

36
00:01:35,520 --> 00:01:38,240
electric vehicles and chargers

37
00:01:38,240 --> 00:01:40,960
the uk government and the eu in general

38
00:01:40,960 --> 00:01:43,920
is planning to ban selling petrol and

39
00:01:43,920 --> 00:01:47,280
diesel cars by 2030

40
00:01:47,280 --> 00:01:48,079
and

41
00:01:48,079 --> 00:01:49,119
currently

42
00:01:49,119 --> 00:01:50,159
there are

43
00:01:50,159 --> 00:01:51,680
more or less three and a half million

44
00:01:51,680 --> 00:01:55,200
electric vehicles in the world and

45
00:01:55,200 --> 00:01:56,719
28

46
00:01:56,719 --> 00:01:59,600
that's a slightly out of date 28 percent

47
00:01:59,600 --> 00:02:03,439
serve in january 2022 of the car sold

48
00:02:03,439 --> 00:02:06,719
where ev vehicles

49
00:02:06,799 --> 00:02:10,000
and we are moving to the actual uh

50
00:02:10,000 --> 00:02:13,040
theme uh subject of the talk which is

51
00:02:13,040 --> 00:02:15,680
evie charger it's a booming market

52
00:02:15,680 --> 00:02:17,520
it's there's a lot of competition there

53
00:02:17,520 --> 00:02:20,080
are smart devices with rush to market

54
00:02:20,080 --> 00:02:22,400
the common issues anyone who has worked

55
00:02:22,400 --> 00:02:24,400
in a startup knows that there are to

56
00:02:24,400 --> 00:02:26,319
market is

57
00:02:26,319 --> 00:02:27,760
implementation

58
00:02:27,760 --> 00:02:30,400
really badly they are implementing stuff

59
00:02:30,400 --> 00:02:33,920
really badly uh it it will keep growing

60
00:02:33,920 --> 00:02:35,760
to the millions of devices because the

61
00:02:35,760 --> 00:02:37,840
plan says that it's going to be one or

62
00:02:37,840 --> 00:02:41,040
two chargers per household right now

63
00:02:41,040 --> 00:02:42,560
from a market analysis there are 18

64
00:02:42,560 --> 00:02:45,120
startups in the field in addition to the

65
00:02:45,120 --> 00:02:48,319
big players like pretty much every huge

66
00:02:48,319 --> 00:02:51,680
company like abb the vw and anyone else

67
00:02:51,680 --> 00:02:54,720
is developing their own

68
00:02:54,720 --> 00:02:56,800
charger and

69
00:02:56,800 --> 00:02:58,879
notice the smart there's the high

70
00:02:58,879 --> 00:03:00,480
opponent's law that says whenever an

71
00:03:00,480 --> 00:03:02,560
appliance is described as smart it's

72
00:03:02,560 --> 00:03:04,319
vulnerable and we're going to see that

73
00:03:04,319 --> 00:03:06,400
it is most of the chargers that we

74
00:03:06,400 --> 00:03:08,319
looked at were one way or another

75
00:03:08,319 --> 00:03:10,958
vulnerable

76
00:03:11,200 --> 00:03:13,440
the ev charger categories are the home

77
00:03:13,440 --> 00:03:16,319
chargers that are installed in our home

78
00:03:16,319 --> 00:03:18,879
they are connected to the land networks

79
00:03:18,879 --> 00:03:21,599
and are usually slower less power

80
00:03:21,599 --> 00:03:25,280
usually 7 to 20 kilowatts

81
00:03:25,280 --> 00:03:27,680
for for power

82
00:03:27,680 --> 00:03:30,319
and the public chargers who are

83
00:03:30,319 --> 00:03:32,640
installed on the public roadside they're

84
00:03:32,640 --> 00:03:35,200
really fast and really high power some

85
00:03:35,200 --> 00:03:36,560
go up to

86
00:03:36,560 --> 00:03:38,640
400 kilowatts per hour

87
00:03:38,640 --> 00:03:41,280
they're interconnected with an protocol

88
00:03:41,280 --> 00:03:43,519
named ocpi we're going to see later what

89
00:03:43,519 --> 00:03:44,640
that means

90
00:03:44,640 --> 00:03:46,799
and the accounts for them can work

91
00:03:46,799 --> 00:03:49,120
globally on all the chargers through

92
00:03:49,120 --> 00:03:51,680
ocpi

93
00:03:52,000 --> 00:03:53,519
random code

94
00:03:53,519 --> 00:03:57,040
the ev fleet in 2020 consumed over 80

95
00:03:57,040 --> 00:03:59,760
terabytes per hour of electricity that's

96
00:03:59,760 --> 00:04:02,720
one percent of current electricity total

97
00:04:02,720 --> 00:04:05,680
and the projection for 2030 is it's

98
00:04:05,680 --> 00:04:08,959
going to be 10 fold 860 terabytes per

99
00:04:08,959 --> 00:04:11,680
hour which is going to be 10

100
00:04:11,680 --> 00:04:14,000
of the current electricity total we're

101
00:04:14,000 --> 00:04:15,840
going to see how this is going to be

102
00:04:15,840 --> 00:04:17,600
used on the

103
00:04:17,600 --> 00:04:20,880
end of this presentation

104
00:04:20,880 --> 00:04:23,120
the cloud-based attacks

105
00:04:23,120 --> 00:04:25,840
is what we're going to look in here now

106
00:04:25,840 --> 00:04:28,160
we are not going to have that black

107
00:04:28,160 --> 00:04:30,160
magic which is called hardware hacking

108
00:04:30,160 --> 00:04:31,520
if you are expecting hardware hacking

109
00:04:31,520 --> 00:04:32,400
from me

110
00:04:32,400 --> 00:04:34,479
i'm going to disappoint you

111
00:04:34,479 --> 00:04:35,759
there's a saying

112
00:04:35,759 --> 00:04:39,199
on api security learn that authorization

113
00:04:39,199 --> 00:04:41,600
is not equal with authentication or api

114
00:04:41,600 --> 00:04:44,800
resources after you so

115
00:04:44,800 --> 00:04:46,720
most of the things that we're going to

116
00:04:46,720 --> 00:04:48,479
see in here they

117
00:04:48,479 --> 00:04:50,320
test that you were authenticated but

118
00:04:50,320 --> 00:04:52,320
never test that you were able or you

119
00:04:52,320 --> 00:04:54,160
should allow you should be allowed to

120
00:04:54,160 --> 00:04:57,840
access that device

121
00:04:57,840 --> 00:05:00,240
generic api testing

122
00:05:00,240 --> 00:05:02,639
all attack has attacks in the stock as i

123
00:05:02,639 --> 00:05:03,759
said are

124
00:05:03,759 --> 00:05:05,280
based are

125
00:05:05,280 --> 00:05:08,160
remotely we didn't have i didn't have to

126
00:05:08,160 --> 00:05:11,280
have any physical access to there

127
00:05:11,280 --> 00:05:13,360
from most of the research i was based in

128
00:05:13,360 --> 00:05:15,360
greece the charters were based somewhere

129
00:05:15,360 --> 00:05:18,639
in back hampshire i had someone pressed

130
00:05:18,639 --> 00:05:21,120
power on and that's all that i needed

131
00:05:21,120 --> 00:05:23,759
they were either mobile or web based

132
00:05:23,759 --> 00:05:25,440
most of them are really really low

133
00:05:25,440 --> 00:05:27,199
hanging fruit you're gonna see on the

134
00:05:27,199 --> 00:05:29,840
following slides and you're gonna

135
00:05:29,840 --> 00:05:31,919
be surprised on how badly they were

136
00:05:31,919 --> 00:05:34,800
implemented the apis

137
00:05:34,800 --> 00:05:37,120
all of them are logic flows

138
00:05:37,120 --> 00:05:40,080
you should not test for injection on any

139
00:05:40,080 --> 00:05:42,160
platform because that's breaking the cma

140
00:05:42,160 --> 00:05:43,520
that's a crime

141
00:05:43,520 --> 00:05:45,919
and the most unfortunate part is that

142
00:05:45,919 --> 00:05:47,759
if something is platform based you're

143
00:05:47,759 --> 00:05:50,800
not getting a cv unfortunately you can

144
00:05:50,800 --> 00:05:53,199
control million of devices but no cv is

145
00:05:53,199 --> 00:05:56,240
going to be assigned to you

146
00:05:56,720 --> 00:05:58,080
what we're going to see we're going to

147
00:05:58,080 --> 00:06:00,560
see api's missive authentication api is

148
00:06:00,560 --> 00:06:02,319
checking for authentication and other

149
00:06:02,319 --> 00:06:03,919
authorization

150
00:06:03,919 --> 00:06:07,680
we're going to see an api that let me uh

151
00:06:07,680 --> 00:06:10,160
upgrade myself to a super admin

152
00:06:10,160 --> 00:06:12,080
and an api that linked everything

153
00:06:12,080 --> 00:06:14,160
because i knew a static key which was

154
00:06:14,160 --> 00:06:17,199
just the compiled application

155
00:06:17,199 --> 00:06:19,600
the fancier stuff is that we're going to

156
00:06:19,600 --> 00:06:22,000
see a charger who was using a

157
00:06:22,000 --> 00:06:24,160
third-party api that was not only

158
00:06:24,160 --> 00:06:27,759
connecting controlling chargers but also

159
00:06:27,759 --> 00:06:29,199
bathtubs

160
00:06:29,199 --> 00:06:32,400
and a lot of other devices into tenths

161
00:06:32,400 --> 00:06:35,120
of millions

162
00:06:35,120 --> 00:06:38,960
api research 101 i have to

163
00:06:38,960 --> 00:06:41,840
warn you first

164
00:06:41,840 --> 00:06:44,000
if i was on piktok i would play the red

165
00:06:44,000 --> 00:06:44,960
alert

166
00:06:44,960 --> 00:06:45,759
the

167
00:06:45,759 --> 00:06:47,360
red crime

168
00:06:47,360 --> 00:06:48,479
sound

169
00:06:48,479 --> 00:06:50,479
most of those issues you have to be

170
00:06:50,479 --> 00:06:53,039
extra careful you should never ever

171
00:06:53,039 --> 00:06:54,960
interact with a device that you don't

172
00:06:54,960 --> 00:06:57,680
own if by mistake you end up being an

173
00:06:57,680 --> 00:07:00,000
admin and yeah you can be an admin by

174
00:07:00,000 --> 00:07:01,599
mistake you have to

175
00:07:01,599 --> 00:07:05,120
notify the vendor immediately

176
00:07:05,120 --> 00:07:07,120
on the following slides you're going to

177
00:07:07,120 --> 00:07:08,479
see some

178
00:07:08,479 --> 00:07:11,280
text which is read this means the cma in

179
00:07:11,280 --> 00:07:14,240
the uk was broken and we had to alert

180
00:07:14,240 --> 00:07:15,199
the

181
00:07:15,199 --> 00:07:17,280
vendor immediately

182
00:07:17,280 --> 00:07:18,479
and

183
00:07:18,479 --> 00:07:20,720
all you know don't do crime please i'm

184
00:07:20,720 --> 00:07:22,960
not encouraging anyone to do crime in

185
00:07:22,960 --> 00:07:25,198
here

186
00:07:25,680 --> 00:07:27,919
let's also

187
00:07:27,919 --> 00:07:30,800
set the goals of what we would say was a

188
00:07:30,800 --> 00:07:33,360
successful research the bare minimum was

189
00:07:33,360 --> 00:07:35,360
control a device

190
00:07:35,360 --> 00:07:37,599
started stop it

191
00:07:37,599 --> 00:07:41,520
and make it things that you shouldn't do

192
00:07:41,520 --> 00:07:44,319
the pii leak is also a bare minimum so

193
00:07:44,319 --> 00:07:46,479
we would want to see who owns a charger

194
00:07:46,479 --> 00:07:48,080
and where the charger is

195
00:07:48,080 --> 00:07:50,560
the medium level goal is to flash a

196
00:07:50,560 --> 00:07:52,800
firmware i'm not going to

197
00:07:52,800 --> 00:07:54,479
to build the firmware there are people

198
00:07:54,479 --> 00:07:57,520
who help me build the firmware so we you

199
00:07:57,520 --> 00:07:59,599
could either break the device or pivot

200
00:07:59,599 --> 00:08:01,840
to the network and the home run is

201
00:08:01,840 --> 00:08:04,560
getting platform admin on everything

202
00:08:04,560 --> 00:08:06,960
unfortunately this was done more than

203
00:08:06,960 --> 00:08:08,879
once

204
00:08:08,879 --> 00:08:10,240
the first category as we said is the

205
00:08:10,240 --> 00:08:13,599
home-based chargers

206
00:08:13,599 --> 00:08:15,680
i was planning to do

207
00:08:15,680 --> 00:08:17,840
a new charger because that presentation

208
00:08:17,840 --> 00:08:19,280
was also done in

209
00:08:19,280 --> 00:08:21,440
in besides london but unfortunately i

210
00:08:21,440 --> 00:08:25,840
disclosed in early january 2022

211
00:08:25,840 --> 00:08:28,240
they responded in 50 days they asked for

212
00:08:28,240 --> 00:08:30,560
more time and as this is a platform

213
00:08:30,560 --> 00:08:34,000
admin if i was disclosing it right now i

214
00:08:34,000 --> 00:08:36,240
would be

215
00:08:36,719 --> 00:08:39,039
bringing a zero day and giving platform

216
00:08:39,039 --> 00:08:41,599
i mean that would be really bad

217
00:08:41,599 --> 00:08:43,839
i have two and a half thousand

218
00:08:43,839 --> 00:08:46,800
installations they're us-based and

219
00:08:46,800 --> 00:08:49,440
probably going to be disclosed i hope in

220
00:08:49,440 --> 00:08:51,519
april but i cannot really know when it's

221
00:08:51,519 --> 00:08:54,320
going to be disclosed

222
00:08:54,320 --> 00:08:56,160
then the other thing is the russia

223
00:08:56,160 --> 00:08:58,880
incident first of all i have an alibi i

224
00:08:58,880 --> 00:09:00,560
didn't do it

225
00:09:00,560 --> 00:09:02,399
it was not a hack i don't know if you

226
00:09:02,399 --> 00:09:04,399
see there are evie charging stations

227
00:09:04,399 --> 00:09:06,000
that were

228
00:09:06,000 --> 00:09:08,399
showing in their screens that putting

229
00:09:08,399 --> 00:09:09,920
putin is

230
00:09:09,920 --> 00:09:13,120
something i'm not going to say the word

231
00:09:13,120 --> 00:09:16,240
it was not a hack it was an ukrainian

232
00:09:16,240 --> 00:09:17,920
company that

233
00:09:17,920 --> 00:09:20,880
tricked that did the back end they had

234
00:09:20,880 --> 00:09:22,480
full ownage of

235
00:09:22,480 --> 00:09:24,800
of the back end so they disabled all the

236
00:09:24,800 --> 00:09:28,480
charges in m11 from saint petersburg to

237
00:09:28,480 --> 00:09:31,600
moscow and dvd vehicles couldn't charge

238
00:09:31,600 --> 00:09:34,839
so they made that travel

239
00:09:34,839 --> 00:09:38,320
impossible now on the actual hacks

240
00:09:38,320 --> 00:09:41,519
first one is the project tv slash either

241
00:09:41,519 --> 00:09:43,760
last sentence and grow watts last

242
00:09:43,760 --> 00:09:45,920
a lot of other names

243
00:09:45,920 --> 00:09:48,480
i had the 2000 installation last year in

244
00:09:48,480 --> 00:09:50,880
the uk

245
00:09:50,880 --> 00:09:54,000
the growbot cloud had a lot of

246
00:09:54,000 --> 00:09:57,680
devices in their cloud not only chargers

247
00:09:57,680 --> 00:09:59,120
photovoltaic

248
00:09:59,120 --> 00:10:01,600
also bathtubs

249
00:10:01,600 --> 00:10:03,279
iot

250
00:10:03,279 --> 00:10:06,880
and cs iot which all of them could be

251
00:10:06,880 --> 00:10:08,240
bound

252
00:10:08,240 --> 00:10:10,160
it was also

253
00:10:10,160 --> 00:10:12,880
approved by the department of transport

254
00:10:12,880 --> 00:10:15,440
and the growth and senzan

255
00:10:15,440 --> 00:10:18,720
are china-based companies and as anyone

256
00:10:18,720 --> 00:10:21,040
who has done research for iot for

257
00:10:21,040 --> 00:10:23,680
chinese iot they were quite slow in

258
00:10:23,680 --> 00:10:24,590
responding

259
00:10:24,590 --> 00:10:26,160
[Music]

260
00:10:26,160 --> 00:10:27,120
they

261
00:10:27,120 --> 00:10:29,120
as you can see in here they were fully

262
00:10:29,120 --> 00:10:31,360
lacking authentication on any call they

263
00:10:31,360 --> 00:10:33,600
just checked on the first call that you

264
00:10:33,600 --> 00:10:35,519
knew the username and password and then

265
00:10:35,519 --> 00:10:38,079
they didn't even check for decision so

266
00:10:38,079 --> 00:10:39,440
you could just say

267
00:10:39,440 --> 00:10:42,480
that you are that charger and you could

268
00:10:42,480 --> 00:10:44,640
control that charger full stop if they

269
00:10:44,640 --> 00:10:46,880
were consecutive

270
00:10:46,880 --> 00:10:48,720
numbers so you could

271
00:10:48,720 --> 00:10:51,279
do anything for all the chargers you

272
00:10:51,279 --> 00:10:52,320
could

273
00:10:52,320 --> 00:10:54,079
you could have full functionality

274
00:10:54,079 --> 00:10:55,600
intended functionality you could lock

275
00:10:55,600 --> 00:10:57,360
and unlock the device

276
00:10:57,360 --> 00:10:59,440
you could firmware update it there was

277
00:10:59,440 --> 00:11:01,519
no signature check so you could have

278
00:11:01,519 --> 00:11:03,760
access to the internal network you could

279
00:11:03,760 --> 00:11:05,440
backdoor it pivot into the internal

280
00:11:05,440 --> 00:11:08,000
network obviously you could take all the

281
00:11:08,000 --> 00:11:09,920
personal identifier

282
00:11:09,920 --> 00:11:11,120
information

283
00:11:11,120 --> 00:11:13,519
you could broke the device and you could

284
00:11:13,519 --> 00:11:16,800
take platform admin which it's in red so

285
00:11:16,800 --> 00:11:20,560
it's a bridge of the cma

286
00:11:21,760 --> 00:11:24,399
now the disclosure went as you would

287
00:11:24,399 --> 00:11:26,800
expect as a train wreck they didn't

288
00:11:26,800 --> 00:11:29,040
respond for weeks they only responded

289
00:11:29,040 --> 00:11:31,440
when i had the bbc

290
00:11:31,440 --> 00:11:33,360
i had the bbc itself

291
00:11:33,360 --> 00:11:35,200
sent

292
00:11:35,200 --> 00:11:38,240
the query they eventually fixed it after

293
00:11:38,240 --> 00:11:40,720
a failed first attempt which they didn't

294
00:11:40,720 --> 00:11:42,240
fix anything they just said that they

295
00:11:42,240 --> 00:11:44,720
fixed and we tested they their fix is a

296
00:11:44,720 --> 00:11:46,720
really strange fix they have a stateless

297
00:11:46,720 --> 00:11:48,320
login which means

298
00:11:48,320 --> 00:11:50,720
they check the login and then they don't

299
00:11:50,720 --> 00:11:52,160
check decision or anything so they

300
00:11:52,160 --> 00:11:54,560
somehow keep decision in your ip on the

301
00:11:54,560 --> 00:11:56,959
server i didn't truly test it because i

302
00:11:56,959 --> 00:11:59,680
didn't want to find anything else

303
00:11:59,680 --> 00:12:02,240
i would grade them

304
00:12:02,240 --> 00:12:05,120
really really bad

305
00:12:05,120 --> 00:12:08,079
the second charger is evbox it's one of

306
00:12:08,079 --> 00:12:09,120
the

307
00:12:09,120 --> 00:12:12,399
biggest companies they have close to 200

308
00:12:12,399 --> 00:12:14,560
000 charging points throughout the world

309
00:12:14,560 --> 00:12:16,639
they're based in amsterdam

310
00:12:16,639 --> 00:12:18,240
they are department of transport

311
00:12:18,240 --> 00:12:20,639
approved and they were acquired by nce

312
00:12:20,639 --> 00:12:25,279
from an undisclosed number of money

313
00:12:25,279 --> 00:12:28,639
their api was surprisingly good but

314
00:12:28,639 --> 00:12:31,120
they had no obvious reasons but

315
00:12:31,120 --> 00:12:33,360
i'm going to challenge you can you see

316
00:12:33,360 --> 00:12:35,040
the issue in here because my machine

317
00:12:35,040 --> 00:12:37,360
learning actually found it

318
00:12:37,360 --> 00:12:38,800
when you are putting something you are

319
00:12:38,800 --> 00:12:41,200
also putting the roles and then it says

320
00:12:41,200 --> 00:12:43,760
account admin and account owner so if

321
00:12:43,760 --> 00:12:46,079
you change the account document to admin

322
00:12:46,079 --> 00:12:48,480
antenna admin you can see on the right

323
00:12:48,480 --> 00:12:49,600
side

324
00:12:49,600 --> 00:12:52,320
that you had the full platform admin for

325
00:12:52,320 --> 00:12:53,519
yourself

326
00:12:53,519 --> 00:12:54,800
so

327
00:12:54,800 --> 00:12:56,480
you had total compromisation of

328
00:12:56,480 --> 00:12:58,320
everything that's with red you could

329
00:12:58,320 --> 00:13:00,160
also control the server you could

330
00:13:00,160 --> 00:13:01,200
control

331
00:13:01,200 --> 00:13:03,200
everything so you were actually the

332
00:13:03,200 --> 00:13:06,560
tenant admin there obviously pii lik

333
00:13:06,560 --> 00:13:08,399
uh you had all the admin functionality

334
00:13:08,399 --> 00:13:09,760
in the world so you could delete you

335
00:13:09,760 --> 00:13:11,200
could stop you could

336
00:13:11,200 --> 00:13:12,720
create new charges you could do

337
00:13:12,720 --> 00:13:17,519
everything the platform admin is of cma

338
00:13:18,160 --> 00:13:20,639
so they responded in two hours which is

339
00:13:20,639 --> 00:13:22,240
a really refreshing they fixed

340
00:13:22,240 --> 00:13:24,079
everything in 24 hours they double

341
00:13:24,079 --> 00:13:26,800
checked the in 48 hours that everything

342
00:13:26,800 --> 00:13:28,079
was fixed

343
00:13:28,079 --> 00:13:30,320
this was an excellent response

344
00:13:30,320 --> 00:13:32,880
i can say that the api's api falls

345
00:13:32,880 --> 00:13:35,040
happen i would give them the gold medal

346
00:13:35,040 --> 00:13:36,720
because they were really good in

347
00:13:36,720 --> 00:13:38,320
everything and

348
00:13:38,320 --> 00:13:40,639
they missed something yeah

349
00:13:40,639 --> 00:13:43,199
we took platform admin but

350
00:13:43,199 --> 00:13:45,360
things happen as we saw in the keynote

351
00:13:45,360 --> 00:13:47,680
it's how you handle them that makes you

352
00:13:47,680 --> 00:13:49,600
a good company or a bad

353
00:13:49,600 --> 00:13:52,399
cyber security wise company

354
00:13:52,399 --> 00:13:54,720
third one is wallbox they have around

355
00:13:54,720 --> 00:13:56,959
100 000 users they are based in

356
00:13:56,959 --> 00:13:58,399
barcelona

357
00:13:58,399 --> 00:14:02,480
they are raising for 300 million usd and

358
00:14:02,480 --> 00:14:04,160
after they are merged

359
00:14:04,160 --> 00:14:05,040
with

360
00:14:05,040 --> 00:14:07,920
an acquisition corp that i don't know

361
00:14:07,920 --> 00:14:09,680
and

362
00:14:09,680 --> 00:14:11,680
they had a second level either as you

363
00:14:11,680 --> 00:14:13,920
might seen here

364
00:14:13,920 --> 00:14:16,560
you could add when you were adding a

365
00:14:16,560 --> 00:14:19,760
user to your charger you were passing

366
00:14:19,760 --> 00:14:22,160
the id

367
00:14:22,800 --> 00:14:25,040
the first and the second is not ids that

368
00:14:25,040 --> 00:14:27,360
i should own so i could

369
00:14:27,360 --> 00:14:28,320
make

370
00:14:28,320 --> 00:14:31,760
me an admin on every charger

371
00:14:31,760 --> 00:14:34,079
there were four different instances of

372
00:14:34,079 --> 00:14:36,480
this in the api

373
00:14:36,480 --> 00:14:38,880
we could have a total control over all

374
00:14:38,880 --> 00:14:41,040
charges we could lock and unlock there

375
00:14:41,040 --> 00:14:43,440
was no way to firmware update

376
00:14:43,440 --> 00:14:45,440
with our own

377
00:14:45,440 --> 00:14:48,639
firmware there was a pii leakage and

378
00:14:48,639 --> 00:14:51,440
we didn't take any platform admin so we

379
00:14:51,440 --> 00:14:55,199
did the minimum of every one of all the

380
00:14:55,199 --> 00:14:56,240
others

381
00:14:56,240 --> 00:14:58,320
they responded the next day they fixed

382
00:14:58,320 --> 00:15:00,480
it in a couple of days unfortunately

383
00:15:00,480 --> 00:15:03,199
when we were engaged because we were

384
00:15:03,199 --> 00:15:05,120
doing a new

385
00:15:05,120 --> 00:15:07,360
check we found something else

386
00:15:07,360 --> 00:15:09,760
quite similar so they didn't fix the

387
00:15:09,760 --> 00:15:12,800
root cause they fixed just the instance

388
00:15:12,800 --> 00:15:15,199
that was found

389
00:15:15,199 --> 00:15:17,360
they wanted to engage so that we could

390
00:15:17,360 --> 00:15:20,240
provide them with services

391
00:15:20,240 --> 00:15:22,800
but they wanted me to

392
00:15:22,800 --> 00:15:26,160
to sign an mba i'm not doing that so all

393
00:15:26,160 --> 00:15:28,079
in all not great

394
00:15:28,079 --> 00:15:30,560
not terrible they tried but

395
00:15:30,560 --> 00:15:31,759
okay

396
00:15:31,759 --> 00:15:35,680
fourth one is the eo charger or eohab

397
00:15:35,680 --> 00:15:38,079
it was the first charger that was

398
00:15:38,079 --> 00:15:40,000
installed in the uk they are based in

399
00:15:40,000 --> 00:15:42,480
london their department of plasma of

400
00:15:42,480 --> 00:15:44,240
transport approved as you can see the

401
00:15:44,240 --> 00:15:46,480
department of transport randomly

402
00:15:46,480 --> 00:15:49,040
approved pretty much anyone it had a lot

403
00:15:49,040 --> 00:15:51,440
of teething problems they have 15 000

404
00:15:51,440 --> 00:15:55,040
users on my estimation

405
00:15:55,040 --> 00:15:58,320
now it was just a raspberry pi you could

406
00:15:58,320 --> 00:16:00,720
just take the sd card and take

407
00:16:00,720 --> 00:16:01,920
everything there's no bootloader

408
00:16:01,920 --> 00:16:03,199
security

409
00:16:03,199 --> 00:16:05,839
i had the recovery we could recover the

410
00:16:05,839 --> 00:16:08,480
full source code which is two python

411
00:16:08,480 --> 00:16:10,399
scripts hard-coded credentials

412
00:16:10,399 --> 00:16:12,639
everywhere full documentation so that

413
00:16:12,639 --> 00:16:14,079
you didn't even have to understand what

414
00:16:14,079 --> 00:16:16,639
it's doing they had everything in there

415
00:16:16,639 --> 00:16:18,399
and

416
00:16:18,399 --> 00:16:20,959
you could do anything you could decrypt

417
00:16:20,959 --> 00:16:24,320
everything you could make a botnet

418
00:16:24,320 --> 00:16:26,399
uh total control over the devices you

419
00:16:26,399 --> 00:16:30,399
could mimic the server the communication

420
00:16:30,399 --> 00:16:35,240
i think they have ticked all the boxes

421
00:16:36,399 --> 00:16:38,560
so they responded in timely fashion they

422
00:16:38,560 --> 00:16:41,040
worked hard into reworking everything

423
00:16:41,040 --> 00:16:44,000
they changed from python to go i think

424
00:16:44,000 --> 00:16:44,800
or

425
00:16:44,800 --> 00:16:48,240
i don't remember the word but their new

426
00:16:48,240 --> 00:16:50,639
and improved eomini is again a raspberry

427
00:16:50,639 --> 00:16:53,839
pi by with just an sd card so they

428
00:16:53,839 --> 00:16:57,279
thrive i i can tell that they tried but

429
00:16:57,279 --> 00:16:58,399
at least

430
00:16:58,399 --> 00:17:00,800
they failed again

431
00:17:00,800 --> 00:17:01,600
uh

432
00:17:01,600 --> 00:17:03,519
for raspberry p

433
00:17:03,519 --> 00:17:04,720
in iot

434
00:17:04,720 --> 00:17:07,520
it's a valid prototyping device not a

435
00:17:07,520 --> 00:17:09,280
good idea to put it on

436
00:17:09,280 --> 00:17:10,400
production

437
00:17:10,400 --> 00:17:12,959
you can easily extract everything

438
00:17:12,959 --> 00:17:14,799
it's easily rootable and there is no

439
00:17:14,799 --> 00:17:17,439
secure bootloader you can see the three

440
00:17:17,439 --> 00:17:20,319
boxes that were

441
00:17:20,319 --> 00:17:22,240
raspberry

442
00:17:22,240 --> 00:17:24,799
based you have in your mini wall box and

443
00:17:24,799 --> 00:17:26,959
hypervolt all of them could be rooted

444
00:17:26,959 --> 00:17:27,919
and

445
00:17:27,919 --> 00:17:32,720
some findings were as you saw in there

446
00:17:32,720 --> 00:17:35,520
the public chargers we only have one i

447
00:17:35,520 --> 00:17:37,200
only have one in there

448
00:17:37,200 --> 00:17:39,919
it's charge point it's one of the three

449
00:17:39,919 --> 00:17:40,960
biggest

450
00:17:40,960 --> 00:17:42,400
charger

451
00:17:42,400 --> 00:17:46,240
networks in the world they have around

452
00:17:46,240 --> 00:17:48,160
120

453
00:17:48,160 --> 00:17:49,200
000

454
00:17:49,200 --> 00:17:50,880
points which means

455
00:17:50,880 --> 00:17:53,679
close to half a million chargers

456
00:17:53,679 --> 00:17:56,480
um they went public in 2021 they're a

457
00:17:56,480 --> 00:17:58,640
huge company

458
00:17:58,640 --> 00:18:00,799
and as you can see they had the publicly

459
00:18:00,799 --> 00:18:04,000
exposed unauthenticated graphql endpoint

460
00:18:04,000 --> 00:18:06,960
that could get everything from every

461
00:18:06,960 --> 00:18:09,919
charger and control it

462
00:18:09,919 --> 00:18:11,679
potentially leaking

463
00:18:11,679 --> 00:18:13,760
their full schema no authentication so

464
00:18:13,760 --> 00:18:16,960
you could get a lot of things now

465
00:18:16,960 --> 00:18:18,320
again

466
00:18:18,320 --> 00:18:20,640
don't do crime

467
00:18:20,640 --> 00:18:23,760
if i pulled the schema which

468
00:18:23,760 --> 00:18:25,280
as you can see in the next slide they

469
00:18:25,280 --> 00:18:27,120
said that they would be okay i would

470
00:18:27,120 --> 00:18:30,880
have gotten about 20 gigabytes of data

471
00:18:30,880 --> 00:18:34,000
with everything and i would have done

472
00:18:34,000 --> 00:18:35,280
one of the

473
00:18:35,280 --> 00:18:37,840
a really big crime never ever interact

474
00:18:37,840 --> 00:18:39,760
with the device you don't own

475
00:18:39,760 --> 00:18:42,960
if you mistakenly do it

476
00:18:42,960 --> 00:18:45,840
notify the vendor immediately and try

477
00:18:45,840 --> 00:18:48,240
not to commit crimes so

478
00:18:48,240 --> 00:18:50,080
chargepoint they responded in an hour

479
00:18:50,080 --> 00:18:51,840
they fixed it on the same day they had

480
00:18:51,840 --> 00:18:53,840
an excellent response they acknowledged

481
00:18:53,840 --> 00:18:55,600
that there was an issue in there and

482
00:18:55,600 --> 00:18:57,600
they said that yeah even if you pulled

483
00:18:57,600 --> 00:19:00,240
it you would be happy not to answer not

484
00:19:00,240 --> 00:19:01,679
to

485
00:19:01,679 --> 00:19:03,600
go after you but this is not something

486
00:19:03,600 --> 00:19:06,160
that you should assume that is going to

487
00:19:06,160 --> 00:19:08,559
happen for all every company so i also

488
00:19:08,559 --> 00:19:11,440
get the gold medal

489
00:19:11,440 --> 00:19:13,760
now the potential issues on the public

490
00:19:13,760 --> 00:19:16,000
charger is on the ocpi

491
00:19:16,000 --> 00:19:18,240
the open charge point protocol is an

492
00:19:18,240 --> 00:19:20,559
application protocol for communicating

493
00:19:20,559 --> 00:19:21,760
it's like

494
00:19:21,760 --> 00:19:24,799
roaming they are also naming roaming so

495
00:19:24,799 --> 00:19:25,919
you create

496
00:19:25,919 --> 00:19:28,320
an account in

497
00:19:28,320 --> 00:19:30,320
chargepoint and you can also do it on

498
00:19:30,320 --> 00:19:32,480
chargeboard or another company that are

499
00:19:32,480 --> 00:19:34,480
all cpi connected this is in the uk and

500
00:19:34,480 --> 00:19:36,160
the us

501
00:19:36,160 --> 00:19:37,520
the connection between providers and

502
00:19:37,520 --> 00:19:38,960
manufacturer

503
00:19:38,960 --> 00:19:40,400
means that

504
00:19:40,400 --> 00:19:43,200
if you find a vulnerability in

505
00:19:43,200 --> 00:19:43,510
one

506
00:19:43,510 --> 00:19:44,880
[Music]

507
00:19:44,880 --> 00:19:46,559
vendor you you have found a

508
00:19:46,559 --> 00:19:48,240
vulnerability everywhere

509
00:19:48,240 --> 00:19:49,919
you could obviously

510
00:19:49,919 --> 00:19:52,799
pii lick everything

511
00:19:52,799 --> 00:19:54,400
and much like the mobile network it's

512
00:19:54,400 --> 00:19:57,120
called roaming

513
00:19:57,200 --> 00:19:59,120
the issue of throw cpi is you could

514
00:19:59,120 --> 00:20:01,760
steal energy and have someone else pay

515
00:20:01,760 --> 00:20:03,280
for it because

516
00:20:03,280 --> 00:20:06,240
obviously you could lick the pii you

517
00:20:06,240 --> 00:20:08,640
could deny service to legitimate users

518
00:20:08,640 --> 00:20:10,799
because you could close the charger

519
00:20:10,799 --> 00:20:13,919
while they're charging but it gets way

520
00:20:13,919 --> 00:20:16,159
way worse

521
00:20:16,159 --> 00:20:17,200
now the

522
00:20:17,200 --> 00:20:19,600
even worse potential issues are based on

523
00:20:19,600 --> 00:20:22,480
a really good job that i'm trying to

524
00:20:22,480 --> 00:20:24,799
pronounce his name william westerhoff

525
00:20:24,799 --> 00:20:27,120
did at his master thesis there is an

526
00:20:27,120 --> 00:20:28,480
attack based on photovoltaic

527
00:20:28,480 --> 00:20:30,400
vulnerabilities that can potentially

528
00:20:30,400 --> 00:20:31,760
destabilize the power grid by

529
00:20:31,760 --> 00:20:33,919
manipulating photovoltaic installations

530
00:20:33,919 --> 00:20:35,280
we are going to take a slightly

531
00:20:35,280 --> 00:20:38,480
different approach in here

532
00:20:40,159 --> 00:20:42,640
so instead of doing

533
00:20:42,640 --> 00:20:44,240
the

534
00:20:44,240 --> 00:20:46,080
the power grids are interconnected in

535
00:20:46,080 --> 00:20:48,159
europe i don't know how familiar with

536
00:20:48,159 --> 00:20:50,799
you are with that but when greece has a

537
00:20:50,799 --> 00:20:52,720
huge energy

538
00:20:52,720 --> 00:20:55,200
demand the import power from bulgaria

539
00:20:55,200 --> 00:20:57,760
when bulgaria has uh demands the import

540
00:20:57,760 --> 00:20:59,280
from greece so they're interconnected

541
00:20:59,280 --> 00:21:01,200
and if you could

542
00:21:01,200 --> 00:21:02,480
for a reason

543
00:21:02,480 --> 00:21:04,000
we're going to see later

544
00:21:04,000 --> 00:21:06,720
demand a lot of power you could bring

545
00:21:06,720 --> 00:21:08,960
down a lot of

546
00:21:08,960 --> 00:21:13,760
places potentially a full country

547
00:21:14,400 --> 00:21:17,200
so on the whole scenario you should go

548
00:21:17,200 --> 00:21:19,520
there to the link and read it it has a

549
00:21:19,520 --> 00:21:20,880
lot of math that i cannot really

550
00:21:20,880 --> 00:21:23,520
understand i'm not a math guy instead of

551
00:21:23,520 --> 00:21:26,240
limiting the pv power but yeah let's

552
00:21:26,240 --> 00:21:28,159
keep that with a star because on another

553
00:21:28,159 --> 00:21:29,840
talk we're going to talk about the pv

554
00:21:29,840 --> 00:21:31,520
power and

555
00:21:31,520 --> 00:21:33,200
a lot of photovoltaic issues that are

556
00:21:33,200 --> 00:21:35,919
going to be announced later

557
00:21:35,919 --> 00:21:37,679
instead of doing that let's maximize the

558
00:21:37,679 --> 00:21:40,400
need for power keep the mind of 80

559
00:21:40,400 --> 00:21:43,120
terawatts per hour and 800 terabytes per

560
00:21:43,120 --> 00:21:45,120
hour think that 80

561
00:21:45,120 --> 00:21:47,760
80 100 watts per hour is how much

562
00:21:47,760 --> 00:21:51,840
belgium is consuming right now so

563
00:21:51,840 --> 00:21:54,799
if you turned on off and done again you

564
00:21:54,799 --> 00:21:56,960
would have a huge spike

565
00:21:56,960 --> 00:21:58,720
on the demand of power

566
00:21:58,720 --> 00:22:00,720
like

567
00:22:00,720 --> 00:22:03,440
as i said the the belgium

568
00:22:03,440 --> 00:22:05,840
having a new belgium

569
00:22:05,840 --> 00:22:09,360
evolve from anywhere else and bring down

570
00:22:09,360 --> 00:22:10,799
the whole

571
00:22:10,799 --> 00:22:12,799
power grid

572
00:22:12,799 --> 00:22:14,000
this is

573
00:22:14,000 --> 00:22:16,400
the home chargers are usually used

574
00:22:16,400 --> 00:22:18,320
during the night and

575
00:22:18,320 --> 00:22:20,720
for this to work you you have to have a

576
00:22:20,720 --> 00:22:24,000
car uh on the charger so you cannot tell

577
00:22:24,000 --> 00:22:26,480
the charger now you need the

578
00:22:26,480 --> 00:22:28,159
power you have to have something

579
00:22:28,159 --> 00:22:31,200
connected with so that it will request

580
00:22:31,200 --> 00:22:33,760
the power

581
00:22:35,120 --> 00:22:37,440
i think that's all

582
00:22:37,440 --> 00:22:40,679
any questions

583
00:22:42,799 --> 00:22:43,919
so

584
00:22:43,919 --> 00:22:45,760
thanks very much for a great talk

585
00:22:45,760 --> 00:22:47,360
on the api

586
00:22:47,360 --> 00:22:49,600
um

587
00:22:49,760 --> 00:22:51,760
the how

588
00:22:51,760 --> 00:22:53,679
how is it possible for you to find the

589
00:22:53,679 --> 00:22:55,679
public api

590
00:22:55,679 --> 00:22:58,320
endpoints um

591
00:22:58,320 --> 00:22:59,919
uh of uh

592
00:22:59,919 --> 00:23:01,200
offenders

593
00:23:01,200 --> 00:23:03,200
you mean the charge point the the the

594
00:23:03,200 --> 00:23:05,679
the actual the actual api

595
00:23:05,679 --> 00:23:07,280
that they connected to

596
00:23:07,280 --> 00:23:08,880
you you're talking about the charge

597
00:23:08,880 --> 00:23:10,400
point issue or for the home charges

598
00:23:10,400 --> 00:23:12,960
because all the home chargers we i used

599
00:23:12,960 --> 00:23:13,840
the

600
00:23:13,840 --> 00:23:16,400
mobile applications for the charge point

601
00:23:16,400 --> 00:23:19,360
the mobile application was sending some

602
00:23:19,360 --> 00:23:22,480
log to that graphql and then when i went

603
00:23:22,480 --> 00:23:25,120
and browsed the graphql i showed that

604
00:23:25,120 --> 00:23:27,679
every charge has a mobile app associated

605
00:23:27,679 --> 00:23:29,360
and you have to download the i've used

606
00:23:29,360 --> 00:23:31,679
the app and that's yes okay and that's

607
00:23:31,679 --> 00:23:34,080
how you export everything

608
00:23:34,080 --> 00:23:35,679
thank you

609
00:23:35,679 --> 00:23:37,280
thanks very much for the talk i wanted

610
00:23:37,280 --> 00:23:39,120
to ask what's the best way for

611
00:23:39,120 --> 00:23:41,200
individuals at home with their own

612
00:23:41,200 --> 00:23:44,880
charging stations to protect themselves

613
00:23:44,880 --> 00:23:47,679
cost-effective

614
00:23:49,360 --> 00:23:51,120
uh

615
00:23:51,120 --> 00:23:51,919
well

616
00:23:51,919 --> 00:23:54,880
first of all you should isolate any iot

617
00:23:54,880 --> 00:23:57,360
that you have and not connected to your

618
00:23:57,360 --> 00:24:00,320
public to your actual network you should

619
00:24:00,320 --> 00:24:02,960
segment your network so that it cannot

620
00:24:02,960 --> 00:24:05,360
pivot

621
00:24:05,360 --> 00:24:07,039
as you saw

622
00:24:07,039 --> 00:24:10,000
make having updating your firmware

623
00:24:10,000 --> 00:24:11,520
wouldn't touch this kind of

624
00:24:11,520 --> 00:24:14,080
vulnerabilities

625
00:24:14,080 --> 00:24:17,120
try to use

626
00:24:17,600 --> 00:24:20,720
devices that are from companies that

627
00:24:20,720 --> 00:24:24,240
seem to know how security works

628
00:24:24,240 --> 00:24:28,000
so no no name chinese iot

629
00:24:28,000 --> 00:24:30,640
and i don't know if prey works for you

630
00:24:30,640 --> 00:24:32,960
pray that nobody sees you but

631
00:24:32,960 --> 00:24:34,559
it's it's one of those things that will

632
00:24:34,559 --> 00:24:38,320
happen eventually unfortunately i think

633
00:24:38,320 --> 00:24:41,200
any other questions

634
00:24:42,080 --> 00:24:43,860
thank you

635
00:24:43,860 --> 00:24:46,640
[Applause]

636
00:24:46,640 --> 00:24:48,720
you

