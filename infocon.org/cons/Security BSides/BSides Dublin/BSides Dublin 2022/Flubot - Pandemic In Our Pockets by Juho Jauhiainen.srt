1
00:00:03,199 --> 00:00:05,359
i'm going to tell you a little about the

2
00:00:05,359 --> 00:00:06,399
uh

3
00:00:06,399 --> 00:00:08,960
this project i have been following it's

4
00:00:08,960 --> 00:00:12,240
a floorbot uh android pack intro trojan

5
00:00:12,240 --> 00:00:13,280
and uh

6
00:00:13,280 --> 00:00:16,400
i will uh tell a little how the threat

7
00:00:16,400 --> 00:00:19,520
actor is acting and what what are they

8
00:00:19,520 --> 00:00:22,080
doing and what are the capabilities

9
00:00:22,080 --> 00:00:23,920
of the of the malware

10
00:00:23,920 --> 00:00:26,320
uh first of all you saw that fancy

11
00:00:26,320 --> 00:00:29,119
accenture slide but uh you know

12
00:00:29,119 --> 00:00:31,359
they paid me here so um

13
00:00:31,359 --> 00:00:34,079
i work for them but my opinions might

14
00:00:34,079 --> 00:00:35,040
not

15
00:00:35,040 --> 00:00:38,239
be in line with my current employer uh

16
00:00:38,239 --> 00:00:41,040
or any previous employer so

17
00:00:41,040 --> 00:00:44,480
my all my uh comments and uh thinking

18
00:00:44,480 --> 00:00:45,840
are my own

19
00:00:45,840 --> 00:00:48,239
and not impacted by the

20
00:00:48,239 --> 00:00:49,520
employer

21
00:00:49,520 --> 00:00:53,840
so uh my name is eugene i'm from finland

22
00:00:53,840 --> 00:00:56,480
i work as a lead investigator at

23
00:00:56,480 --> 00:00:58,640
accenture doing digital forensics and

24
00:00:58,640 --> 00:01:00,480
incident response mainly some malware

25
00:01:00,480 --> 00:01:02,640
analysis as well

26
00:01:02,640 --> 00:01:04,879
before this i was working for finnish

27
00:01:04,879 --> 00:01:06,080
government

28
00:01:06,080 --> 00:01:06,880
and

29
00:01:06,880 --> 00:01:08,640
that's where the

30
00:01:08,640 --> 00:01:10,799
my

31
00:01:10,799 --> 00:01:13,600
journey with the flow but started and i

32
00:01:13,600 --> 00:01:17,040
have been tracking the uh

33
00:01:17,040 --> 00:01:21,600
the malware since last last uh summer

34
00:01:21,600 --> 00:01:24,159
but uh what is floorboard in generally

35
00:01:24,159 --> 00:01:26,960
it's uh android bank controller trojan

36
00:01:26,960 --> 00:01:27,759
uh

37
00:01:27,759 --> 00:01:31,200
it's uh distributed through sms so

38
00:01:31,200 --> 00:01:32,320
uh

39
00:01:32,320 --> 00:01:34,799
usually usually the sms tries to like

40
00:01:34,799 --> 00:01:38,479
lure the uh uh victim to uh go to a drop

41
00:01:38,479 --> 00:01:41,759
site and download the apk and install it

42
00:01:41,759 --> 00:01:43,119
to the uh

43
00:01:43,119 --> 00:01:44,640
their phones

44
00:01:44,640 --> 00:01:46,479
the distribution is done through the

45
00:01:46,479 --> 00:01:50,399
compromised wordpress sites so

46
00:01:50,399 --> 00:01:53,200
they have plenty of wordpress sites that

47
00:01:53,200 --> 00:01:54,720
they can use for this and they have

48
00:01:54,720 --> 00:01:56,240
burned like

49
00:01:56,240 --> 00:01:58,880
thousands or ten thousands of sites uh

50
00:01:58,880 --> 00:02:02,079
just to deliver this uh this ap case uh

51
00:02:02,079 --> 00:02:03,840
to victim forms

52
00:02:03,840 --> 00:02:06,479
it's continuously developed so we are

53
00:02:06,479 --> 00:02:08,479
seeing a lot of new versions coming up

54
00:02:08,479 --> 00:02:09,758
uh

55
00:02:09,758 --> 00:02:13,760
almost uh once in a month i will talk uh

56
00:02:13,760 --> 00:02:15,840
later on a little bit about the versions

57
00:02:15,840 --> 00:02:18,480
and what what has changed and when

58
00:02:18,480 --> 00:02:21,520
and uh they are also reacting

59
00:02:21,520 --> 00:02:24,160
to the mitigation activities that for

60
00:02:24,160 --> 00:02:26,160
example tele operators are doing so if

61
00:02:26,160 --> 00:02:27,280
they are

62
00:02:27,280 --> 00:02:29,840
changing some ways how to block for

63
00:02:29,840 --> 00:02:33,440
example the sms messages

64
00:02:33,519 --> 00:02:35,440
they are going to implement the new

65
00:02:35,440 --> 00:02:38,319
feature which will uh likely bypass the

66
00:02:38,319 --> 00:02:41,120
medication the deliberators have done

67
00:02:41,120 --> 00:02:43,519
but yeah uh here's a screenshot about

68
00:02:43,519 --> 00:02:46,160
the from the drop drop site and also sms

69
00:02:46,160 --> 00:02:49,040
we saw in finland and and as you can see

70
00:02:49,040 --> 00:02:52,480
they are they usually have like uh a lot

71
00:02:52,480 --> 00:02:55,760
of like uh typos and so on so we thought

72
00:02:55,760 --> 00:02:57,120
that uh

73
00:02:57,120 --> 00:02:59,519
no one will click this well

74
00:02:59,519 --> 00:03:02,720
we were wrong because uh when when the

75
00:03:02,720 --> 00:03:03,519
uh

76
00:03:03,519 --> 00:03:06,239
when the situation was uh

77
00:03:06,239 --> 00:03:08,879
the baddest uh there was like millions

78
00:03:08,879 --> 00:03:12,800
of sms messages uh going uh around

79
00:03:12,800 --> 00:03:15,120
finland uh per day

80
00:03:15,120 --> 00:03:17,440
so if you think finland has like five

81
00:03:17,440 --> 00:03:19,280
and a half million people living there

82
00:03:19,280 --> 00:03:22,080
and millions millions of sms messages

83
00:03:22,080 --> 00:03:23,519
were delivered

84
00:03:23,519 --> 00:03:24,959
uh in a day

85
00:03:24,959 --> 00:03:27,519
uh everyone was getting those and and

86
00:03:27,519 --> 00:03:29,840
those were like headlines in in news

87
00:03:29,840 --> 00:03:30,560
that

88
00:03:30,560 --> 00:03:32,480
did you get this kind of sms don't click

89
00:03:32,480 --> 00:03:35,200
the uh message and download the apk

90
00:03:35,200 --> 00:03:37,440
but that that was uh background

91
00:03:37,440 --> 00:03:40,560
uh of the of the uh

92
00:03:40,560 --> 00:03:42,720
okay they stopped working

93
00:03:42,720 --> 00:03:43,599
nice

94
00:03:43,599 --> 00:03:45,840
so uh that that's that's the uh

95
00:03:45,840 --> 00:03:48,239
background of the uh

96
00:03:48,239 --> 00:03:49,760
of the uh

97
00:03:49,760 --> 00:03:51,599
uh uh flu but

98
00:03:51,599 --> 00:03:54,319
so as i told you it's it's uh uh

99
00:03:54,319 --> 00:03:57,200
endeavored through the sms spraying so

100
00:03:57,200 --> 00:04:00,879
uh in fact that phone sends a message to

101
00:04:00,879 --> 00:04:03,680
victim a victim if the victim clicks the

102
00:04:03,680 --> 00:04:06,159
link they will go to the drop site and

103
00:04:06,159 --> 00:04:08,640
the drop site actually knows

104
00:04:08,640 --> 00:04:09,680
from the

105
00:04:09,680 --> 00:04:13,040
given uri that who is clicking the

106
00:04:13,040 --> 00:04:15,120
message so

107
00:04:15,120 --> 00:04:17,519
in some cases we have seen uh

108
00:04:17,519 --> 00:04:20,000
seeing the drop site showing of the

109
00:04:20,000 --> 00:04:22,960
phone number where the sms was actually

110
00:04:22,960 --> 00:04:26,400
sent so they are having like a

111
00:04:26,400 --> 00:04:28,960
database in their back end where they

112
00:04:28,960 --> 00:04:32,000
are like matching all the uh all the

113
00:04:32,000 --> 00:04:33,759
links with the uh

114
00:04:33,759 --> 00:04:37,120
target victims so a lot of lot of like

115
00:04:37,120 --> 00:04:39,199
features that uh

116
00:04:39,199 --> 00:04:42,479
that are not that common for for this

117
00:04:42,479 --> 00:04:45,520
kind of like bulk malware

118
00:04:45,520 --> 00:04:49,360
then if the victim downloads the apk and

119
00:04:49,360 --> 00:04:51,680
side loads it installs it to their

120
00:04:51,680 --> 00:04:52,720
device

121
00:04:52,720 --> 00:04:55,199
they get infected and the first thing

122
00:04:55,199 --> 00:04:57,759
the flowback is doing it will check the

123
00:04:57,759 --> 00:05:00,080
public ib address of the device so it

124
00:05:00,080 --> 00:05:03,360
uses uh these four uh services that

125
00:05:03,360 --> 00:05:05,280
reveal your

126
00:05:05,280 --> 00:05:08,000
public ib address and it stores uh the

127
00:05:08,000 --> 00:05:10,560
information to the uh shared preferences

128
00:05:10,560 --> 00:05:12,880
so that it can use it later on and of

129
00:05:12,880 --> 00:05:14,880
course update it if

130
00:05:14,880 --> 00:05:16,240
if the uh

131
00:05:16,240 --> 00:05:18,639
victim

132
00:05:18,639 --> 00:05:21,440
victim ip gets it gets a new release and

133
00:05:21,440 --> 00:05:23,039
uh and so on

134
00:05:23,039 --> 00:05:25,360
and then it starts to communicate with

135
00:05:25,360 --> 00:05:26,880
the c2

136
00:05:26,880 --> 00:05:28,400
and since

137
00:05:28,400 --> 00:05:32,320
i think since version 4.9

138
00:05:32,320 --> 00:05:35,120
of the flow but it has used dns over

139
00:05:35,120 --> 00:05:38,080
https so all the communication goes

140
00:05:38,080 --> 00:05:39,840
through the uh uh

141
00:05:39,840 --> 00:05:41,520
this cloud

142
00:05:41,520 --> 00:05:43,840
dns providers like google

143
00:05:43,840 --> 00:05:44,880
uh

144
00:05:44,880 --> 00:05:49,360
cloudflare and also uh alibaba and

145
00:05:49,360 --> 00:05:52,560
they actually used this next dns as well

146
00:05:52,560 --> 00:05:55,919
but it was the only provider who started

147
00:05:55,919 --> 00:06:00,479
blocking a flobot c2 so

148
00:06:00,479 --> 00:06:03,440
so yeah so then they dropped the support

149
00:06:03,440 --> 00:06:07,039
for the next dns pretty fast and move to

150
00:06:07,039 --> 00:06:10,240
use these these three and

151
00:06:10,240 --> 00:06:12,560
we have been in finland in my previous

152
00:06:12,560 --> 00:06:14,319
job i have been in contact with all of

153
00:06:14,319 --> 00:06:16,319
them and they are not interested to

154
00:06:16,319 --> 00:06:17,919
touch their

155
00:06:17,919 --> 00:06:21,680
dns over https because it's it's a whole

156
00:06:21,680 --> 00:06:23,680
thing you know privacy and stuff so we

157
00:06:23,680 --> 00:06:25,759
are not blocking even flow but requests

158
00:06:25,759 --> 00:06:27,919
or any other malware there as well so if

159
00:06:27,919 --> 00:06:29,199
any one of you are working for the

160
00:06:29,199 --> 00:06:32,080
companies please do something

161
00:06:32,080 --> 00:06:34,400
and then it starts to spread the sms

162
00:06:34,400 --> 00:06:37,680
messages if the campaign is active in

163
00:06:37,680 --> 00:06:39,840
the in the current country where the

164
00:06:39,840 --> 00:06:41,120
phone is

165
00:06:41,120 --> 00:06:43,759
so it will check the uh i will talk

166
00:06:43,759 --> 00:06:47,440
later about the how it uh checks uh the

167
00:06:47,440 --> 00:06:49,039
device info

168
00:06:49,039 --> 00:06:51,840
but uh if if if the campaign is not

169
00:06:51,840 --> 00:06:54,160
active in the country where the infected

170
00:06:54,160 --> 00:06:57,120
phone is it will not start sending those

171
00:06:57,120 --> 00:06:59,759
messages it will just stay hidden on the

172
00:06:59,759 --> 00:07:01,840
phone and wait that they activate the

173
00:07:01,840 --> 00:07:02,880
campaign

174
00:07:02,880 --> 00:07:05,919
in that specific country again

175
00:07:05,919 --> 00:07:08,000
uh i had actually made this presentation

176
00:07:08,000 --> 00:07:11,599
already and uh on i think on wednesday

177
00:07:11,599 --> 00:07:14,639
evening i saw a tweet from this user

178
00:07:14,639 --> 00:07:18,560
jake j cybersec that he was able to

179
00:07:18,560 --> 00:07:19,599
dump

180
00:07:19,599 --> 00:07:21,599
the uh

181
00:07:21,599 --> 00:07:22,400
the

182
00:07:22,400 --> 00:07:25,599
source code of the of the uh

183
00:07:25,599 --> 00:07:27,759
drop site so

184
00:07:27,759 --> 00:07:30,479
i had to take a look at it actually i

185
00:07:30,479 --> 00:07:33,120
flew here yesterday morning so i i

186
00:07:33,120 --> 00:07:35,759
analyzed the php in the uh in the

187
00:07:35,759 --> 00:07:36,880
airplane

188
00:07:36,880 --> 00:07:37,759
and

189
00:07:37,759 --> 00:07:40,880
saw that it reveals uh one

190
00:07:40,880 --> 00:07:42,720
address from the

191
00:07:42,720 --> 00:07:46,560
back end and uh i will get later back to

192
00:07:46,560 --> 00:07:48,560
this this uh

193
00:07:48,560 --> 00:07:50,319
uh this uh

194
00:07:50,319 --> 00:07:54,000
domain shown there this murfetta dot

195
00:07:54,000 --> 00:07:56,720
russia and uh

196
00:07:56,720 --> 00:07:59,039
yeah uh and i i will i will discuss a

197
00:07:59,039 --> 00:08:00,720
little about the in front where is where

198
00:08:00,720 --> 00:08:03,440
it's hosted but uh if you are interested

199
00:08:03,440 --> 00:08:04,840
about the uh

200
00:08:04,840 --> 00:08:07,520
index.php which which was uh dumped by

201
00:08:07,520 --> 00:08:10,720
this uh twitter user uh it's it's pretty

202
00:08:10,720 --> 00:08:14,080
good uh twitter uh thread about about

203
00:08:14,080 --> 00:08:16,160
what what what is concluded in the code

204
00:08:16,160 --> 00:08:18,879
and what it does so uh go and take a

205
00:08:18,879 --> 00:08:20,800
look as well it's uh you can find the

206
00:08:20,800 --> 00:08:23,280
sample from aristotle

207
00:08:23,280 --> 00:08:25,840
but yeah a little bit about the uh time

208
00:08:25,840 --> 00:08:29,280
frame so as i told uh last summer i got

209
00:08:29,280 --> 00:08:32,399
involved with this case uh in finland um

210
00:08:32,399 --> 00:08:35,279
it was the version 4.5 which which uh

211
00:08:35,279 --> 00:08:38,000
started spreading in finland and uh that

212
00:08:38,000 --> 00:08:40,640
version was actually still using the uh

213
00:08:40,640 --> 00:08:41,360
like

214
00:08:41,360 --> 00:08:43,919
legacy uh connection so it directly

215
00:08:43,919 --> 00:08:46,720
connected to the c2 instead of using the

216
00:08:46,720 --> 00:08:49,920
dns over hc dps uh so it was kind of

217
00:08:49,920 --> 00:08:53,040
easy to block we just generated lists of

218
00:08:53,040 --> 00:08:54,399
these

219
00:08:54,399 --> 00:08:56,959
domains it's using dta so domain

220
00:08:56,959 --> 00:08:59,680
generation algorithm so we generated the

221
00:08:59,680 --> 00:09:00,560
list

222
00:09:00,560 --> 00:09:02,320
and blocked

223
00:09:02,320 --> 00:09:04,800
all the teleoperators blocked these

224
00:09:04,800 --> 00:09:07,200
actresses in finland so so they couldn't

225
00:09:07,200 --> 00:09:10,160
do anything and we were like yes we won

226
00:09:10,160 --> 00:09:14,160
and uh then few months went by and uh we

227
00:09:14,160 --> 00:09:17,200
saw new samples using uh dns over https

228
00:09:17,200 --> 00:09:19,440
and we didn't do anything so yeah

229
00:09:19,440 --> 00:09:22,240
and uh since then they have released a

230
00:09:22,240 --> 00:09:24,959
lot of new versions so they are uh

231
00:09:24,959 --> 00:09:25,760
like

232
00:09:25,760 --> 00:09:28,000
going from static uh

233
00:09:28,000 --> 00:09:32,080
static structure uh to more like uh

234
00:09:32,080 --> 00:09:33,440
things that

235
00:09:33,440 --> 00:09:35,519
that they can update on the fly for

236
00:09:35,519 --> 00:09:37,920
example the dga

237
00:09:37,920 --> 00:09:40,000
seats so they can like generate

238
00:09:40,000 --> 00:09:41,839
different kind of uh

239
00:09:41,839 --> 00:09:43,760
different kind of list of uh

240
00:09:43,760 --> 00:09:46,640
those c2 domains and also

241
00:09:46,640 --> 00:09:48,720
it makes uh us

242
00:09:48,720 --> 00:09:51,120
researchers life a little bit harder

243
00:09:51,120 --> 00:09:53,680
because dc's are not hardcoded to the

244
00:09:53,680 --> 00:09:55,839
malware and they need to be downloaded

245
00:09:55,839 --> 00:09:59,920
from the c2 so so a little bit more work

246
00:09:59,920 --> 00:10:02,320
for for people who are analyzing the

247
00:10:02,320 --> 00:10:04,399
malware

248
00:10:04,399 --> 00:10:07,360
and yeah uh last month actually uh

249
00:10:07,360 --> 00:10:09,440
i think it was uh end of february the

250
00:10:09,440 --> 00:10:12,640
newest version 5.5 was released well i

251
00:10:12,640 --> 00:10:15,680
found it uh using some retro hands on on

252
00:10:15,680 --> 00:10:16,320
the

253
00:10:16,320 --> 00:10:18,160
wires turtle and

254
00:10:18,160 --> 00:10:20,000
checked that that's the newest newest

255
00:10:20,000 --> 00:10:22,320
version

256
00:10:22,480 --> 00:10:26,480
uh analyzing ap cases is kind of easy

257
00:10:26,480 --> 00:10:28,160
because you can just decompile the

258
00:10:28,160 --> 00:10:29,920
package and read the

259
00:10:29,920 --> 00:10:31,440
java but

260
00:10:31,440 --> 00:10:32,800
of course

261
00:10:32,800 --> 00:10:35,200
mobile malware are using packing as well

262
00:10:35,200 --> 00:10:36,480
as the uh

263
00:10:36,480 --> 00:10:39,200
as the like regular windows and linux

264
00:10:39,200 --> 00:10:43,760
malware are doing so uh and uh

265
00:10:43,760 --> 00:10:46,240
flubat used it to use

266
00:10:46,240 --> 00:10:48,959
apk protector which is like known tool

267
00:10:48,959 --> 00:10:49,680
for

268
00:10:49,680 --> 00:10:52,399
apk packing

269
00:10:52,399 --> 00:10:54,160
but they changed

270
00:10:54,160 --> 00:10:56,240
this kind of custom

271
00:10:56,240 --> 00:11:00,320
customized encryption uh in i think it

272
00:11:00,320 --> 00:11:02,720
was version

273
00:11:02,720 --> 00:11:06,640
4.9 where they introduced it and

274
00:11:06,640 --> 00:11:07,600
yeah

275
00:11:07,600 --> 00:11:09,760
and uh it's it's first they have like

276
00:11:09,760 --> 00:11:12,000
multiple layers of obfuscation and

277
00:11:12,000 --> 00:11:14,399
encryption so first layer is like a

278
00:11:14,399 --> 00:11:17,120
simple string obfuscation and then then

279
00:11:17,120 --> 00:11:18,160
there's an

280
00:11:18,160 --> 00:11:20,320
archive hidden into the

281
00:11:20,320 --> 00:11:22,160
sources resources

282
00:11:22,160 --> 00:11:25,600
and then that that is actually when you

283
00:11:25,600 --> 00:11:27,200
uh

284
00:11:27,200 --> 00:11:30,079
uh when you decompress it it's an

285
00:11:30,079 --> 00:11:33,040
encrypted payload and if you uh uh

286
00:11:33,040 --> 00:11:35,600
decrypt the payload it will become an

287
00:11:35,600 --> 00:11:38,079
archive and the archive

288
00:11:38,079 --> 00:11:39,440
will

289
00:11:39,440 --> 00:11:41,120
have the

290
00:11:41,120 --> 00:11:43,920
real classist.dxdx

291
00:11:43,920 --> 00:11:46,800
inside of it and uh if if you uh uh

292
00:11:46,800 --> 00:11:50,079
decompress that one uh it's an and

293
00:11:50,079 --> 00:11:51,680
see the source code it's it's still

294
00:11:51,680 --> 00:11:54,000
obfuscated so there is like a lot of

295
00:11:54,000 --> 00:11:56,160
places where they are trying to hide the

296
00:11:56,160 --> 00:11:56,959
uh

297
00:11:56,959 --> 00:12:00,000
real real true truth of the source code

298
00:12:00,000 --> 00:12:02,720
and uh and uh but i i think uh this kind

299
00:12:02,720 --> 00:12:03,519
of

300
00:12:03,519 --> 00:12:06,399
this kind of uh stuff is fun and uh hope

301
00:12:06,399 --> 00:12:08,959
that they are implementing new features

302
00:12:08,959 --> 00:12:12,959
so so it will get a little bit harder to

303
00:12:12,959 --> 00:12:14,320
decrypt

304
00:12:14,320 --> 00:12:17,680
but yeah so as i told uh they changed

305
00:12:17,680 --> 00:12:21,040
the way of packing between the june and

306
00:12:21,040 --> 00:12:25,440
november last year and uh i think they

307
00:12:25,440 --> 00:12:28,720
will this year bring more features to

308
00:12:28,720 --> 00:12:32,399
that as well so we will see and wait

309
00:12:32,399 --> 00:12:35,680
so if we take a closer look uh how how

310
00:12:35,680 --> 00:12:38,800
the packing is done so first of all

311
00:12:38,800 --> 00:12:41,519
android manifest is good place to start

312
00:12:41,519 --> 00:12:43,519
and see what the application is doing so

313
00:12:43,519 --> 00:12:46,639
it's basically a list uh what services

314
00:12:46,639 --> 00:12:49,519
and listeners and so on are started

315
00:12:49,519 --> 00:12:52,079
when the application is

316
00:12:52,079 --> 00:12:56,240
installed and started so uh the first uh

317
00:12:56,240 --> 00:12:58,480
thing we can see that

318
00:12:58,480 --> 00:13:01,360
that there is this uh main function

319
00:13:01,360 --> 00:13:02,720
inside of the

320
00:13:02,720 --> 00:13:06,639
mobile qq named package but you cannot

321
00:13:06,639 --> 00:13:08,959
find the source code there so it's it's

322
00:13:08,959 --> 00:13:11,600
packing and if you go one line above you

323
00:13:11,600 --> 00:13:13,360
can see that there is this crazy games

324
00:13:13,360 --> 00:13:16,320
package uh which which uh includes

325
00:13:16,320 --> 00:13:19,040
probably the

326
00:13:19,040 --> 00:13:21,839
code for the packing

327
00:13:21,839 --> 00:13:22,639
uh

328
00:13:22,639 --> 00:13:26,480
next slide is a little bit busy but

329
00:13:26,480 --> 00:13:30,480
it's it's it's the uh function where

330
00:13:30,480 --> 00:13:33,200
uh where the uh

331
00:13:33,200 --> 00:13:36,000
the file i mentioned the uh archive uh

332
00:13:36,000 --> 00:13:38,720
where it's stored and and how how it uh

333
00:13:38,720 --> 00:13:41,839
like loads it from from uh from there

334
00:13:41,839 --> 00:13:45,279
and uh then then com decompresses it so

335
00:13:45,279 --> 00:13:48,079
the path for this specific sample is

336
00:13:48,079 --> 00:13:52,240
shown there so there is assets and then

337
00:13:52,240 --> 00:13:55,279
so so uh and that that is the actual

338
00:13:55,279 --> 00:13:57,839
actual file containing the source code

339
00:13:57,839 --> 00:14:01,120
for the for the malware

340
00:14:01,120 --> 00:14:02,959
and then then we can see that there is

341
00:14:02,959 --> 00:14:05,600
actually a decryption function which uh

342
00:14:05,600 --> 00:14:09,040
uses a static password uh from from the

343
00:14:09,040 --> 00:14:10,720
sample of course it's a little bit

344
00:14:10,720 --> 00:14:13,040
obfuscated as well it's uh these chinese

345
00:14:13,040 --> 00:14:16,480
letters and uh with with uh and uh if if

346
00:14:16,480 --> 00:14:17,680
you uh

347
00:14:17,680 --> 00:14:19,920
de-obfuscate that one it will become a

348
00:14:19,920 --> 00:14:22,320
clear text string and uh

349
00:14:22,320 --> 00:14:24,560
that actually means something i i think

350
00:14:24,560 --> 00:14:26,320
they are funny as well because they're

351
00:14:26,320 --> 00:14:29,279
using like uh something something that

352
00:14:29,279 --> 00:14:33,199
means something in in chinese and uh

353
00:14:33,199 --> 00:14:35,199
also there was i think it was the first

354
00:14:35,199 --> 00:14:38,079
sample i saw it was like evil evil evil

355
00:14:38,079 --> 00:14:41,040
evil evil evil the in english the

356
00:14:41,040 --> 00:14:42,880
chinese text so

357
00:14:42,880 --> 00:14:45,440
yeah i i think it's

358
00:14:45,440 --> 00:14:46,880
this is like uh

359
00:14:46,880 --> 00:14:49,040
like easter eggs they're hiding hiding

360
00:14:49,040 --> 00:14:51,839
there and i i kind of like it

361
00:14:51,839 --> 00:14:55,440
uh then uh if you look at the uh

362
00:14:55,440 --> 00:14:58,240
the actual uh decryption function you

363
00:14:58,240 --> 00:15:00,000
can

364
00:15:00,000 --> 00:15:03,040
see that most of it is is like rubbish

365
00:15:03,040 --> 00:15:05,600
and there is only like few parts which

366
00:15:05,600 --> 00:15:06,880
are used for

367
00:15:06,880 --> 00:15:08,160
for the

368
00:15:08,160 --> 00:15:09,199
actual

369
00:15:09,199 --> 00:15:12,880
decryption of the of the classes.the dex

370
00:15:12,880 --> 00:15:15,519
and uh

371
00:15:15,680 --> 00:15:19,519
yeah if when i put it to this slide

372
00:15:19,519 --> 00:15:21,839
it looks easy but it actually took some

373
00:15:21,839 --> 00:15:23,760
time time to figure out how to how to

374
00:15:23,760 --> 00:15:25,199
unpack them

375
00:15:25,199 --> 00:15:28,880
on how to unpack the package and uh

376
00:15:28,880 --> 00:15:30,720
when i had done it i wrote a little

377
00:15:30,720 --> 00:15:34,480
python uh spaghetti code and then run it

378
00:15:34,480 --> 00:15:36,240
and i got the uh

379
00:15:36,240 --> 00:15:38,800
the actual dax file so now we can

380
00:15:38,800 --> 00:15:40,800
actually start analyzing them all over

381
00:15:40,800 --> 00:15:43,759
and um this this look like uh

382
00:15:43,759 --> 00:15:45,839
well in this uh in the uh last year it

383
00:15:45,839 --> 00:15:48,160
took like uh one one week of uh work

384
00:15:48,160 --> 00:15:50,160
days uh to figure out how how it how

385
00:15:50,160 --> 00:15:52,480
it's done

386
00:15:52,480 --> 00:15:54,639
so uh when when the user installs the

387
00:15:54,639 --> 00:15:56,399
malware uh

388
00:15:56,399 --> 00:16:02,800
it it actually requires a lot of like uh

389
00:16:03,040 --> 00:16:06,240
permissions from the user so it prompts

390
00:16:06,240 --> 00:16:10,880
the user uh if it can use the uh layouts

391
00:16:10,880 --> 00:16:12,959
in in uh

392
00:16:12,959 --> 00:16:15,839
in in android which means that basically

393
00:16:15,839 --> 00:16:18,320
the malware can show anything can

394
00:16:18,320 --> 00:16:20,639
intercept anything can do anything with

395
00:16:20,639 --> 00:16:22,399
the phone so it's it's like super

396
00:16:22,399 --> 00:16:23,759
dangerous

397
00:16:23,759 --> 00:16:25,920
thing to give give

398
00:16:25,920 --> 00:16:28,240
any app this kind of access

399
00:16:28,240 --> 00:16:29,759
and uh

400
00:16:29,759 --> 00:16:32,800
and uh of course it's telling that that

401
00:16:32,800 --> 00:16:34,880
the instructions how the user can

402
00:16:34,880 --> 00:16:38,160
actually disable limitations

403
00:16:38,160 --> 00:16:41,120
which which android nowadays builds with

404
00:16:41,120 --> 00:16:42,160
ships with

405
00:16:42,160 --> 00:16:43,759
so you can

406
00:16:43,759 --> 00:16:47,199
they are helping the victims to

407
00:16:47,199 --> 00:16:51,519
make their phone more unsecure

408
00:16:51,519 --> 00:16:53,600
and during the installation it it

409
00:16:53,600 --> 00:16:56,000
actually checks the uh check after after

410
00:16:56,000 --> 00:16:58,720
the after the user gives the rights it

411
00:16:58,720 --> 00:17:01,199
will check the public ip address and a

412
00:17:01,199 --> 00:17:03,759
lot of other stuff which is uh

413
00:17:03,759 --> 00:17:06,240
going to be uh stored into the third

414
00:17:06,240 --> 00:17:08,720
preferences of of the of the application

415
00:17:08,720 --> 00:17:12,160
and uh this is because it wants to store

416
00:17:12,160 --> 00:17:14,720
uh this kind of configurations like

417
00:17:14,720 --> 00:17:16,559
for longer times and it

418
00:17:16,559 --> 00:17:19,039
all of many of the flow but functions

419
00:17:19,039 --> 00:17:20,559
are using the

420
00:17:20,559 --> 00:17:21,599
same

421
00:17:21,599 --> 00:17:24,319
values so so it it uses

422
00:17:24,319 --> 00:17:27,359
shared shared preferences for that

423
00:17:27,359 --> 00:17:28,640
and

424
00:17:28,640 --> 00:17:31,200
one of the one of the things is a spot

425
00:17:31,200 --> 00:17:34,000
id so this is the way the attacker

426
00:17:34,000 --> 00:17:36,720
actually can can specify which device is

427
00:17:36,720 --> 00:17:39,440
calling back to the c2 and this is

428
00:17:39,440 --> 00:17:41,440
unique for for

429
00:17:41,440 --> 00:17:44,080
phones so

430
00:17:44,080 --> 00:17:46,480
so a lot of interesting information

431
00:17:46,480 --> 00:17:48,960
and uh for example uh as i said they

432
00:17:48,960 --> 00:17:50,400
have been implementing these new

433
00:17:50,400 --> 00:17:52,559
features uh so uh

434
00:17:52,559 --> 00:17:55,039
so that they can update like dynamic

435
00:17:55,039 --> 00:17:57,600
dynamically those uh

436
00:17:57,600 --> 00:18:01,600
the uh doh servers and uh c2 servers and

437
00:18:01,600 --> 00:18:05,280
so on so uh there is uh one shared

438
00:18:05,280 --> 00:18:08,960
preference for for new uh dns over https

439
00:18:08,960 --> 00:18:10,640
servers so

440
00:18:10,640 --> 00:18:12,400
as i told they are using the google

441
00:18:12,400 --> 00:18:13,919
alibaba and

442
00:18:13,919 --> 00:18:17,120
cloudflare so they can basically update

443
00:18:17,120 --> 00:18:18,400
their uh

444
00:18:18,400 --> 00:18:21,280
whatever they like and also if someone

445
00:18:21,280 --> 00:18:23,280
for example starts to blocking them they

446
00:18:23,280 --> 00:18:26,320
can implement new new new uh server

447
00:18:26,320 --> 00:18:28,480
there and uh

448
00:18:28,480 --> 00:18:30,720
ensure that they they can continue

449
00:18:30,720 --> 00:18:32,240
operating

450
00:18:32,240 --> 00:18:34,480
and also the custom seed which is used

451
00:18:34,480 --> 00:18:38,000
for the dta so when they created a list

452
00:18:38,000 --> 00:18:40,720
of c2 domains they are using a hard

453
00:18:40,720 --> 00:18:44,520
coded seed which is uh which has been

454
00:18:44,520 --> 00:18:47,039
1945 uh

455
00:18:47,039 --> 00:18:50,080
in many of the samples but but of course

456
00:18:50,080 --> 00:18:52,000
they have this uh

457
00:18:52,000 --> 00:18:54,160
this feature so that they can update it

458
00:18:54,160 --> 00:18:57,160
dynamically

459
00:18:57,840 --> 00:19:00,720
floorbot has a lot of like

460
00:19:00,720 --> 00:19:03,760
hard-coded commands it's it's which

461
00:19:03,760 --> 00:19:07,679
which are used for c2 traffic so

462
00:19:07,679 --> 00:19:09,520
before

463
00:19:09,520 --> 00:19:11,600
starting the c2

464
00:19:11,600 --> 00:19:13,280
communication

465
00:19:13,280 --> 00:19:15,360
it uses this preping

466
00:19:15,360 --> 00:19:16,960
command

467
00:19:16,960 --> 00:19:19,919
where it basically

468
00:19:20,080 --> 00:19:22,799
where it basically connects

469
00:19:22,799 --> 00:19:25,280
well tries to connect uh

470
00:19:25,280 --> 00:19:29,200
uh over two thousand uh uh c2s

471
00:19:29,200 --> 00:19:31,840
and checks which one of them is alive

472
00:19:31,840 --> 00:19:32,640
and

473
00:19:32,640 --> 00:19:35,200
because there is a lot of like uh the

474
00:19:35,200 --> 00:19:38,400
dji uh generates two over 2000 domains

475
00:19:38,400 --> 00:19:39,600
and

476
00:19:39,600 --> 00:19:41,520
because of this they are like

477
00:19:41,520 --> 00:19:45,280
uh really agile uh moving from uh

478
00:19:45,280 --> 00:19:48,080
one location to another so

479
00:19:48,080 --> 00:19:50,000
this is why uh tracking flow but for

480
00:19:50,000 --> 00:19:53,679
example the uh c2 infra might change

481
00:19:53,679 --> 00:19:56,480
every day i i will have few photos about

482
00:19:56,480 --> 00:19:57,200
the

483
00:19:57,200 --> 00:19:59,840
about the current infra from yesterday

484
00:19:59,840 --> 00:20:01,679
and probably it's different already

485
00:20:01,679 --> 00:20:03,360
today so

486
00:20:03,360 --> 00:20:05,039
old info

487
00:20:05,039 --> 00:20:07,520
and uh it also has the ping comment

488
00:20:07,520 --> 00:20:10,159
which is actually the like a keep alive

489
00:20:10,159 --> 00:20:12,960
uh so that's the basic home calling uh

490
00:20:12,960 --> 00:20:14,960
comment and uh

491
00:20:14,960 --> 00:20:18,320
the bing government also has the version

492
00:20:18,320 --> 00:20:20,640
number uh so it it will tell the

493
00:20:20,640 --> 00:20:23,679
attackers which uh c2 version

494
00:20:23,679 --> 00:20:26,400
which flow but version is in use so that

495
00:20:26,400 --> 00:20:28,320
that is the place where uh you can

496
00:20:28,320 --> 00:20:30,320
actually track which version of the flow

497
00:20:30,320 --> 00:20:33,039
but this is the current one and uh

498
00:20:33,039 --> 00:20:35,919
they are updating uh the miner versions

499
00:20:35,919 --> 00:20:37,600
uh kind of

500
00:20:37,600 --> 00:20:39,600
often

501
00:20:39,600 --> 00:20:43,120
it also has a possible uh possibility to

502
00:20:43,120 --> 00:20:46,080
send sms content so it's intercepting

503
00:20:46,080 --> 00:20:49,440
sms messages and delivering the

504
00:20:49,440 --> 00:20:51,840
all of the contents to the attacker so

505
00:20:51,840 --> 00:20:55,679
basically bypassing sms based mfa is

506
00:20:55,679 --> 00:20:58,000
really easy if your phone is infected

507
00:20:58,000 --> 00:20:59,280
with flu but

508
00:20:59,280 --> 00:21:03,440
also it will not show uh the contents to

509
00:21:03,440 --> 00:21:06,320
uh to the victim so if someone is trying

510
00:21:06,320 --> 00:21:09,280
to for example send them message uh to

511
00:21:09,280 --> 00:21:11,919
them that your phone is infected it will

512
00:21:11,919 --> 00:21:13,200
not reach

513
00:21:13,200 --> 00:21:14,240
the

514
00:21:14,240 --> 00:21:16,799
victim but it will go to the uh to the

515
00:21:16,799 --> 00:21:19,440
actual uh attacker and uh

516
00:21:19,440 --> 00:21:21,600
one of the finnish tele operators used

517
00:21:21,600 --> 00:21:24,880
sms to send like uh messages to their

518
00:21:24,880 --> 00:21:27,200
customers if if they were infected with

519
00:21:27,200 --> 00:21:29,520
flu but and they were wondering why why

520
00:21:29,520 --> 00:21:31,440
nothing happens and and this was the

521
00:21:31,440 --> 00:21:33,919
reason and uh and uh they were

522
00:21:33,919 --> 00:21:36,320
surprised that they they need actually

523
00:21:36,320 --> 00:21:38,240
to send letters because they couldn't

524
00:21:38,240 --> 00:21:40,159
call them the calls were blocked as well

525
00:21:40,159 --> 00:21:41,760
so

526
00:21:41,760 --> 00:21:42,840
you

527
00:21:42,840 --> 00:21:46,880
know and uh yeah and then there's this

528
00:21:46,880 --> 00:21:48,480
gta

529
00:21:48,480 --> 00:21:49,280
so

530
00:21:49,280 --> 00:21:52,320
there is hardcoded list of tlds which

531
00:21:52,320 --> 00:21:55,440
which the fluvat is using uh i think

532
00:21:55,440 --> 00:21:57,600
this is just a lure because uh

533
00:21:57,600 --> 00:22:01,600
previously they were using 3d tlds in

534
00:22:01,600 --> 00:22:04,080
the list was only uh had only three

535
00:22:04,080 --> 00:22:05,679
three of them

536
00:22:05,679 --> 00:22:06,400
the

537
00:22:06,400 --> 00:22:09,200
russian soviet union and china and now

538
00:22:09,200 --> 00:22:11,840
they are using yes soviet union has

539
00:22:11,840 --> 00:22:14,080
their own tld i'm not sure why but you

540
00:22:14,080 --> 00:22:15,200
know

541
00:22:15,200 --> 00:22:17,679
and uh but now they're using like a big

542
00:22:17,679 --> 00:22:21,600
list of uh different uh tlds but the c2s

543
00:22:21,600 --> 00:22:25,120
are the active c2s are usually in in uh

544
00:22:25,120 --> 00:22:28,400
dot ru so in russia russia uh country

545
00:22:28,400 --> 00:22:30,080
domain

546
00:22:30,080 --> 00:22:32,880
and uh yeah it will generate uh

547
00:22:32,880 --> 00:22:33,679
uh

548
00:22:33,679 --> 00:22:35,559
uh

549
00:22:35,559 --> 00:22:39,280
3500 domains and try to contact them

550
00:22:39,280 --> 00:22:42,080
afterwards so it creates uh 25 threads

551
00:22:42,080 --> 00:22:44,799
that test those generated domains so the

552
00:22:44,799 --> 00:22:47,520
amount of traffic going out of the phone

553
00:22:47,520 --> 00:22:50,159
when the floorboard is installed is

554
00:22:50,159 --> 00:22:52,880
is enormous so basically

555
00:22:52,880 --> 00:22:56,400
uh if i have my home setup

556
00:22:56,400 --> 00:22:59,440
i have work so it connect uh proxying

557
00:22:59,440 --> 00:23:02,000
the uh all of the

558
00:23:02,000 --> 00:23:03,600
all of the uh

559
00:23:03,600 --> 00:23:06,000
requests coming out from the test phone

560
00:23:06,000 --> 00:23:08,559
and uh when i do that it's like 10 000

561
00:23:08,559 --> 00:23:12,880
requests uh like pop up to the work so

562
00:23:12,880 --> 00:23:15,919
it's it's very lousy

563
00:23:15,919 --> 00:23:17,600
uh yeah

564
00:23:17,600 --> 00:23:21,679
and uh for the uh actual like seed

565
00:23:21,679 --> 00:23:24,559
which is used for the random in in in

566
00:23:24,559 --> 00:23:25,600
java

567
00:23:25,600 --> 00:23:28,320
it uses the hard coded seed it's the

568
00:23:28,320 --> 00:23:29,840
1945

569
00:23:29,840 --> 00:23:32,799
and also it uses the current month and

570
00:23:32,799 --> 00:23:35,039
current year in the generation algorithm

571
00:23:35,039 --> 00:23:36,960
so basically every month you have to

572
00:23:36,960 --> 00:23:39,600
regenerate the list of the dji of the

573
00:23:39,600 --> 00:23:42,320
flowbot c2s if you are willing uh

574
00:23:42,320 --> 00:23:43,919
willing to track those

575
00:23:43,919 --> 00:23:46,080
and as you can get guess

576
00:23:46,080 --> 00:23:48,880
i am actually tracking those so this is

577
00:23:48,880 --> 00:23:51,520
uh example of list list

578
00:23:51,520 --> 00:23:54,080
which which kind of domains the

579
00:23:54,080 --> 00:23:56,159
algorithm generates so here is the list

580
00:23:56,159 --> 00:23:58,880
of uh february domains and also march

581
00:23:58,880 --> 00:24:02,480
domains and uh and in few weeks i have

582
00:24:02,480 --> 00:24:06,720
to generate the april domains as well

583
00:24:06,720 --> 00:24:09,279
and uh

584
00:24:09,760 --> 00:24:12,159
if we look at the

585
00:24:12,159 --> 00:24:14,640
current c2 infra and where it's hosted

586
00:24:14,640 --> 00:24:17,200
so basically as it's using the

587
00:24:17,200 --> 00:24:20,640
dns over https the requests are not

588
00:24:20,640 --> 00:24:23,279
going to that actual domain but the to

589
00:24:23,279 --> 00:24:27,440
the name server of that domain so

590
00:24:27,440 --> 00:24:28,400
in this

591
00:24:28,400 --> 00:24:30,159
slide you can see the

592
00:24:30,159 --> 00:24:33,440
c2 domain uh the name server it's using

593
00:24:33,440 --> 00:24:35,919
and then the ib address of that name

594
00:24:35,919 --> 00:24:39,679
server and then also uh the as number of

595
00:24:39,679 --> 00:24:40,960
the of the

596
00:24:40,960 --> 00:24:42,880
hosting company

597
00:24:42,880 --> 00:24:44,960
and this is this is actually from a few

598
00:24:44,960 --> 00:24:47,840
days ago so

599
00:24:47,840 --> 00:24:49,520
we can see like

600
00:24:49,520 --> 00:24:52,159
that there was not that many active

601
00:24:52,159 --> 00:24:54,880
domains at the moment and uh most of

602
00:24:54,880 --> 00:24:58,080
them were like sinkholes but you know

603
00:24:58,080 --> 00:24:59,200
if you are

604
00:24:59,200 --> 00:25:02,080
uh using dta i'm not sure if sinkholing

605
00:25:02,080 --> 00:25:03,440
is is like

606
00:25:03,440 --> 00:25:06,159
does anything of course uh you can track

607
00:25:06,159 --> 00:25:09,120
uh the amount of infected devices using

608
00:25:09,120 --> 00:25:10,480
that but

609
00:25:10,480 --> 00:25:13,360
but uh sinkholding is is not a solution

610
00:25:13,360 --> 00:25:17,120
to tackle the flow but problem

611
00:25:17,120 --> 00:25:20,640
this one is actually the real deal this

612
00:25:20,640 --> 00:25:22,400
is the active

613
00:25:22,400 --> 00:25:23,760
active

614
00:25:23,760 --> 00:25:24,720
uh

615
00:25:24,720 --> 00:25:28,559
c2 or was the active a c2 few days ago

616
00:25:28,559 --> 00:25:31,279
and if we look at the as number

617
00:25:31,279 --> 00:25:34,080
uh it's uh this um

618
00:25:34,080 --> 00:25:36,080
recall which which countries was but

619
00:25:36,080 --> 00:25:38,799
some african country uh which which

620
00:25:38,799 --> 00:25:40,320
gives like uh

621
00:25:40,320 --> 00:25:43,039
root routing services for everyone and

622
00:25:43,039 --> 00:25:46,480
it's it's called elite uh like lead team

623
00:25:46,480 --> 00:25:47,679
elite

624
00:25:47,679 --> 00:25:50,320
and uh they have this uh funny funny

625
00:25:50,320 --> 00:25:52,400
thing in their uh

626
00:25:52,400 --> 00:25:54,840
who is information that for

627
00:25:54,840 --> 00:25:58,158
example okay

628
00:25:58,480 --> 00:25:59,679
seems good

629
00:25:59,679 --> 00:26:01,279
but they have this

630
00:26:01,279 --> 00:26:03,840
nice information about the netcraft

631
00:26:03,840 --> 00:26:06,480
which is like a service provider that

632
00:26:06,480 --> 00:26:08,400
takes

633
00:26:08,400 --> 00:26:11,279
they offer services where they take down

634
00:26:11,279 --> 00:26:12,880
uh

635
00:26:12,880 --> 00:26:15,279
what's going on

636
00:26:15,279 --> 00:26:17,279
all right

637
00:26:17,279 --> 00:26:18,559
how it works

638
00:26:18,559 --> 00:26:20,240
yep but

639
00:26:20,240 --> 00:26:22,480
they offer services where they take down

640
00:26:22,480 --> 00:26:24,720
for example c2s or fishing sites and so

641
00:26:24,720 --> 00:26:26,320
on so they are

642
00:26:26,320 --> 00:26:28,400
they send a lot of like uh takedown

643
00:26:28,400 --> 00:26:30,720
requests so they are claiming that these

644
00:26:30,720 --> 00:26:32,400
netcraft

645
00:26:32,400 --> 00:26:35,120
uh guys are spammers so

646
00:26:35,120 --> 00:26:38,080
they are not answering uh their requests

647
00:26:38,080 --> 00:26:40,159
and uh this already tells something

648
00:26:40,159 --> 00:26:41,440
about the

649
00:26:41,440 --> 00:26:44,320
as and what's hosted there so that's

650
00:26:44,320 --> 00:26:46,080
that's like

651
00:26:46,080 --> 00:26:49,600
red flag of cyber security you know if

652
00:26:49,600 --> 00:26:52,000
anything goes to that that is it's

653
00:26:52,000 --> 00:26:54,159
probably bad

654
00:26:54,159 --> 00:26:55,200
so

655
00:26:55,200 --> 00:26:57,919
as i said they're updating it constantly

656
00:26:57,919 --> 00:27:01,679
so this is from yesterday and

657
00:27:01,679 --> 00:27:03,919
as you can see there is not that

658
00:27:03,919 --> 00:27:05,600
much

659
00:27:05,600 --> 00:27:08,559
domains anymore but we can see two

660
00:27:08,559 --> 00:27:09,520
active

661
00:27:09,520 --> 00:27:12,559
domains so uh they are here

662
00:27:12,559 --> 00:27:15,360
uh these two and they are hosted in in

663
00:27:15,360 --> 00:27:18,399
uh different areas and this is russian

664
00:27:18,399 --> 00:27:19,360
as

665
00:27:19,360 --> 00:27:22,559
and it's called horizon

666
00:27:22,559 --> 00:27:23,440
so

667
00:27:23,440 --> 00:27:25,360
it's it's uh

668
00:27:25,360 --> 00:27:26,159
it's

669
00:27:26,159 --> 00:27:28,559
we have seen that in many many different

670
00:27:28,559 --> 00:27:32,320
malwares using the same same uh as so

671
00:27:32,320 --> 00:27:34,799
probably that that that's like the real

672
00:27:34,799 --> 00:27:38,880
as they are using for the c2 infra

673
00:27:38,880 --> 00:27:42,320
and if if if you go uh by

674
00:27:42,320 --> 00:27:46,320
to these uh c2 domains by by a browser

675
00:27:46,320 --> 00:27:48,480
it's it's nothing but you can see that

676
00:27:48,480 --> 00:27:51,039
their ip addresses are as well in the

677
00:27:51,039 --> 00:27:53,360
same as so

678
00:27:53,360 --> 00:27:58,158
so uh they are they are uh

679
00:27:58,399 --> 00:28:00,240
i'm not going to touch the table anymore

680
00:28:00,240 --> 00:28:03,840
yeah but uh they are uh hosted in in

681
00:28:03,840 --> 00:28:06,000
russia as well and

682
00:28:06,000 --> 00:28:09,679
before uh they moved to the uh dns over

683
00:28:09,679 --> 00:28:13,120
https they were using uh like these uh

684
00:28:13,120 --> 00:28:15,360
legacy connections like

685
00:28:15,360 --> 00:28:18,480
direct sockets to these uh addresses and

686
00:28:18,480 --> 00:28:20,320
then there

687
00:28:20,320 --> 00:28:23,279
then there their side had this

688
00:28:23,279 --> 00:28:25,919
this kind of propaganda there so

689
00:28:25,919 --> 00:28:27,520
uh

690
00:28:27,520 --> 00:28:28,399
i know

691
00:28:28,399 --> 00:28:30,000
i'm not going to try to say that but

692
00:28:30,000 --> 00:28:30,880
it's like

693
00:28:30,880 --> 00:28:33,600
it was like uh feds off and uh hope

694
00:28:33,600 --> 00:28:36,480
you can have like a good good and good

695
00:28:36,480 --> 00:28:39,360
spirit and something like that so so and

696
00:28:39,360 --> 00:28:42,240
and this is the uh old president of uh

697
00:28:42,240 --> 00:28:44,799
russia the media

698
00:28:44,799 --> 00:28:46,960
how do you say i'm sure but you know

699
00:28:46,960 --> 00:28:49,039
the yeah the guy before

700
00:28:49,039 --> 00:28:50,960
putin

701
00:28:50,960 --> 00:28:53,039
but yeah

702
00:28:53,039 --> 00:28:56,399
and if you remember this one

703
00:28:56,799 --> 00:28:59,200
can you guess the as yes it's the same

704
00:28:59,200 --> 00:29:02,240
one so uh it's it's the horizon uh from

705
00:29:02,240 --> 00:29:04,960
russia and uh and uh i know that there

706
00:29:04,960 --> 00:29:07,440
has been like a lot of takedown requests

707
00:29:07,440 --> 00:29:12,080
uh to this these uh

708
00:29:12,080 --> 00:29:15,440
domains but the response haven't been

709
00:29:15,440 --> 00:29:17,919
that good so

710
00:29:17,919 --> 00:29:20,080
we are still working on it and if you

711
00:29:20,080 --> 00:29:23,200
are working for that as please tell

712
00:29:23,200 --> 00:29:26,399
your company to stop

713
00:29:26,399 --> 00:29:30,000
so how does this c2 tunneling work so

714
00:29:30,000 --> 00:29:33,039
as i said uh it's using uh all the all

715
00:29:33,039 --> 00:29:37,279
the c2 traffic goes to uh ds over https

716
00:29:37,279 --> 00:29:38,159
so

717
00:29:38,159 --> 00:29:40,240
i'm not going to read out those loads

718
00:29:40,240 --> 00:29:42,399
but uh it basically

719
00:29:42,399 --> 00:29:45,200
makes a blob of data

720
00:29:45,200 --> 00:29:48,399
and then then it's it's uh encrypted and

721
00:29:48,399 --> 00:29:52,080
then encoded with base32

722
00:29:52,080 --> 00:29:52,960
and

723
00:29:52,960 --> 00:29:54,399
the actual

724
00:29:54,399 --> 00:29:55,760
uh

725
00:29:55,760 --> 00:29:57,360
actual uh

726
00:29:57,360 --> 00:30:00,880
like the command and response is uh

727
00:30:00,880 --> 00:30:04,720
encrypted with rc4 arc four uh and the

728
00:30:04,720 --> 00:30:05,600
uh

729
00:30:05,600 --> 00:30:08,480
the key for that is actually generated

730
00:30:08,480 --> 00:30:10,799
when the uh when the flow but is

731
00:30:10,799 --> 00:30:13,200
installed on the to the

732
00:30:13,200 --> 00:30:16,240
no sorry it's it's uh generated for each

733
00:30:16,240 --> 00:30:19,120
and every comment so it changes on every

734
00:30:19,120 --> 00:30:22,320
comment so if you are uh figuring out

735
00:30:22,320 --> 00:30:25,360
one of the rc four keys you cannot you

736
00:30:25,360 --> 00:30:27,200
can only like uh

737
00:30:27,200 --> 00:30:30,080
decrypt that session and the uh

738
00:30:30,080 --> 00:30:31,600
in the first

739
00:30:31,600 --> 00:30:32,399
ping

740
00:30:32,399 --> 00:30:35,440
it will deliver the uh the client will

741
00:30:35,440 --> 00:30:39,440
deliver the uh rc4 key to the uh

742
00:30:39,440 --> 00:30:42,720
server the c2 server by uh

743
00:30:42,720 --> 00:30:44,000
and

744
00:30:44,000 --> 00:30:47,919
first it encrypts it with the rsa and it

745
00:30:47,919 --> 00:30:51,120
has a hard hard-coded rsa

746
00:30:51,120 --> 00:30:53,200
public key in the in the sample and it

747
00:30:53,200 --> 00:30:56,960
has been the same the whole time

748
00:30:57,600 --> 00:31:00,960
and then the c2 will answer if it can

749
00:31:00,960 --> 00:31:02,960
decrypt the payload so

750
00:31:02,960 --> 00:31:05,600
i have for example i have been creating

751
00:31:05,600 --> 00:31:08,000
this kind of emulator so i do not have

752
00:31:08,000 --> 00:31:10,240
like always run the sample i can just

753
00:31:10,240 --> 00:31:13,360
use my python to interact with the c2

754
00:31:13,360 --> 00:31:15,600
and uh i had a lot of problems at the

755
00:31:15,600 --> 00:31:18,720
first with the uh with the data

756
00:31:18,720 --> 00:31:21,200
formatting with the c2 so it didn't

757
00:31:21,200 --> 00:31:23,679
answer uh answer me anything and now now

758
00:31:23,679 --> 00:31:26,720
it's working partly

759
00:31:26,720 --> 00:31:29,919
so uh the actual request looks like this

760
00:31:29,919 --> 00:31:33,919
so uh there is this uh

761
00:31:35,120 --> 00:31:37,840
there is this uh uh uh

762
00:31:37,840 --> 00:31:40,480
ds over https host and then there is

763
00:31:40,480 --> 00:31:44,640
this uh session id then uh which number

764
00:31:44,640 --> 00:31:47,600
uh the request is is so it's a sequel

765
00:31:47,600 --> 00:31:50,720
number and then then uh if it's sending

766
00:31:50,720 --> 00:31:54,480
data or receiving uh next so when the

767
00:31:54,480 --> 00:31:58,480
last request has one here and uh the

768
00:31:58,480 --> 00:32:01,440
others are sent with zero and then there

769
00:32:01,440 --> 00:32:04,640
is this blob and then of course the c2

770
00:32:04,640 --> 00:32:07,919
host and the request type is always txt

771
00:32:07,919 --> 00:32:10,399
so it's it's always requesting same type

772
00:32:10,399 --> 00:32:11,440
of

773
00:32:11,440 --> 00:32:13,600
data from the c2

774
00:32:13,600 --> 00:32:16,240
so what does the c2 and answer to the

775
00:32:16,240 --> 00:32:18,480
client so

776
00:32:18,480 --> 00:32:20,320
the client has like

777
00:32:20,320 --> 00:32:21,760
multiple

778
00:32:21,760 --> 00:32:25,760
different capabilities which it can do

779
00:32:25,760 --> 00:32:27,760
i will mention few of them few of them

780
00:32:27,760 --> 00:32:29,760
so

781
00:32:29,760 --> 00:32:34,559
i think the worst one is is the socks so

782
00:32:34,559 --> 00:32:37,360
attacker can actually have like a direct

783
00:32:37,360 --> 00:32:39,279
connection to phone and do whatever they

784
00:32:39,279 --> 00:32:42,000
like there so it is it's basically a

785
00:32:42,000 --> 00:32:43,679
back door

786
00:32:43,679 --> 00:32:45,919
i haven't seen that been used and i

787
00:32:45,919 --> 00:32:47,919
don't know if it has been used but

788
00:32:47,919 --> 00:32:49,919
there's a feature for that

789
00:32:49,919 --> 00:32:52,480
then of course the upload function so it

790
00:32:52,480 --> 00:32:55,039
steals a lot of data from the phone

791
00:32:55,039 --> 00:32:58,799
all contacts sms messages and so on so

792
00:32:58,799 --> 00:33:02,080
it it's like a nightmare for the victim

793
00:33:02,080 --> 00:33:04,080
that that they will lose all of their

794
00:33:04,080 --> 00:33:05,919
information that they are storing in the

795
00:33:05,919 --> 00:33:07,039
phone

796
00:33:07,039 --> 00:33:10,399
and then of course it has these layers

797
00:33:10,399 --> 00:33:13,760
or they call them injects so basically

798
00:33:13,760 --> 00:33:16,159
layers that can be used for fishing and

799
00:33:16,159 --> 00:33:18,559
showing any content to the victim they

800
00:33:18,559 --> 00:33:20,880
want and for example

801
00:33:20,880 --> 00:33:24,159
collect bank details or or

802
00:33:24,159 --> 00:33:27,200
or what else any credentials uh they

803
00:33:27,200 --> 00:33:29,360
targeted actually gmail

804
00:33:29,360 --> 00:33:30,880
as well

805
00:33:30,880 --> 00:33:33,360
so they had a layer for gmail this

806
00:33:33,360 --> 00:33:34,720
actually works

807
00:33:34,720 --> 00:33:37,120
in a way that the

808
00:33:37,120 --> 00:33:40,159
client sends list of all installed

809
00:33:40,159 --> 00:33:43,600
packages to the c2 and c2 answers which

810
00:33:43,600 --> 00:33:46,640
packages it wants to like monitor for

811
00:33:46,640 --> 00:33:49,919
credentials so to get the list what they

812
00:33:49,919 --> 00:33:51,760
are targeting you have to generate the

813
00:33:51,760 --> 00:33:53,279
list of like

814
00:33:53,279 --> 00:33:54,080
all

815
00:33:54,080 --> 00:33:56,240
applications available in google store

816
00:33:56,240 --> 00:33:58,159
and send it to the c2 and then the c2

817
00:33:58,159 --> 00:34:00,880
will tell you what which ones they are

818
00:34:00,880 --> 00:34:03,279
targeting

819
00:34:03,279 --> 00:34:04,880
and uh yeah

820
00:34:04,880 --> 00:34:06,880
and then there's this interesting thing

821
00:34:06,880 --> 00:34:09,199
as well as i said that

822
00:34:09,199 --> 00:34:12,399
they are hosting the infra in russia but

823
00:34:12,399 --> 00:34:15,520
they are also avoiding a russian and

824
00:34:15,520 --> 00:34:19,199
other country countries uh victims so

825
00:34:19,199 --> 00:34:21,359
they have white listed a lot of

826
00:34:21,359 --> 00:34:24,000
languages system languages so the

827
00:34:24,000 --> 00:34:26,480
installation checks uh which language

828
00:34:26,480 --> 00:34:29,760
the phone is using and then then uh the

829
00:34:29,760 --> 00:34:32,960
installation will not continue if the uh

830
00:34:32,960 --> 00:34:35,520
if one of the mentioned uh countries is

831
00:34:35,520 --> 00:34:38,000
is used for languages is used in the

832
00:34:38,000 --> 00:34:39,918
phone and we've if we put these

833
00:34:39,918 --> 00:34:41,599
countries to mop

834
00:34:41,599 --> 00:34:43,520
it looks like this

835
00:34:43,520 --> 00:34:45,199
and by the way i'm not attributing

836
00:34:45,199 --> 00:34:47,520
anything i'm just saying that

837
00:34:47,520 --> 00:34:49,599
they are not targeting these countries

838
00:34:49,599 --> 00:34:51,359
well these uh

839
00:34:51,359 --> 00:34:53,520
countries where these languages are

840
00:34:53,520 --> 00:34:55,679
spoken

841
00:34:55,679 --> 00:34:58,240
so which countries they are targeting

842
00:34:58,240 --> 00:35:00,000
uh

843
00:35:00,000 --> 00:35:03,200
well a lot of like western countries i

844
00:35:03,200 --> 00:35:05,760
also know that there has been campaigns

845
00:35:05,760 --> 00:35:08,400
in australia and new zealand

846
00:35:08,400 --> 00:35:11,200
and also in ireland but i haven't seen

847
00:35:11,200 --> 00:35:14,320
uh i haven't seen samples by myself that

848
00:35:14,320 --> 00:35:16,640
use for example uh

849
00:35:16,640 --> 00:35:19,280
uh these uh country codes of of these

850
00:35:19,280 --> 00:35:22,640
these uh countries so basically

851
00:35:22,640 --> 00:35:24,079
uh

852
00:35:24,079 --> 00:35:25,760
these are the countries they are

853
00:35:25,760 --> 00:35:27,920
focusing right now and and

854
00:35:27,920 --> 00:35:31,359
probably i think this is a

855
00:35:31,359 --> 00:35:34,160
plant that that these countries are the

856
00:35:34,160 --> 00:35:36,320
uh targets and

857
00:35:36,320 --> 00:35:38,960
those informations are hardcoded in the

858
00:35:38,960 --> 00:35:42,079
code and they haven't changed that much

859
00:35:42,079 --> 00:35:44,640
so probably we will see new campaigns uh

860
00:35:44,640 --> 00:35:46,160
flew back campaigns in the future in

861
00:35:46,160 --> 00:35:49,040
these countries as well

862
00:35:49,040 --> 00:35:51,040
their goal is

863
00:35:51,040 --> 00:35:53,520
finance still or at least it looks like

864
00:35:53,520 --> 00:35:56,000
it's financial so they are creating

865
00:35:56,000 --> 00:35:58,320
these fishing overlays and at the moment

866
00:35:58,320 --> 00:36:00,800
they are targeting uh well in finland

867
00:36:00,800 --> 00:36:04,160
they target uh coinbase and binance uh

868
00:36:04,160 --> 00:36:06,160
cryptocurrency uh wallets

869
00:36:06,160 --> 00:36:10,880
and also gmail and uh i i think in in uh

870
00:36:10,880 --> 00:36:14,320
in uh uk for example they were targeting

871
00:36:14,320 --> 00:36:17,760
bank applications so uh

872
00:36:17,760 --> 00:36:20,240
it looks like it's it's uh

873
00:36:20,240 --> 00:36:23,920
it's a financial uh motivated group

874
00:36:23,920 --> 00:36:26,000
and uh

875
00:36:26,000 --> 00:36:28,960
they are actually delivering those uh

876
00:36:28,960 --> 00:36:34,160
fishing overlays as html so uh i did uh

877
00:36:34,160 --> 00:36:37,920
download uh the injects they are giving

878
00:36:37,920 --> 00:36:40,640
and look uh by looking at the code i saw

879
00:36:40,640 --> 00:36:42,640
some russian comments so they were

880
00:36:42,640 --> 00:36:45,839
telling uh i i used google translate to

881
00:36:45,839 --> 00:36:47,599
check what those comments are where and

882
00:36:47,599 --> 00:36:49,839
there was like in the css file there was

883
00:36:49,839 --> 00:36:50,560
like

884
00:36:50,560 --> 00:36:53,119
background and then comment

885
00:36:53,119 --> 00:36:56,000
that this is background

886
00:36:56,000 --> 00:36:58,320
like in russia so

887
00:36:58,320 --> 00:37:01,119
it makes me feel that uh these uh are

888
00:37:01,119 --> 00:37:03,280
not that good in english the uh persons

889
00:37:03,280 --> 00:37:05,040
were who were

890
00:37:05,040 --> 00:37:07,200
uh doing at least the uh

891
00:37:07,200 --> 00:37:09,520
the overlays

892
00:37:09,520 --> 00:37:13,040
so what's my conclusion

893
00:37:14,720 --> 00:37:17,439
threat actor

894
00:37:17,760 --> 00:37:20,160
this is not attribution but they are

895
00:37:20,160 --> 00:37:23,680
hosting their c2 in russia

896
00:37:23,680 --> 00:37:26,880
they inject html code which is commented

897
00:37:26,880 --> 00:37:29,520
with russia they'll all infrastruct

898
00:37:29,520 --> 00:37:31,520
russian propaganda

899
00:37:31,520 --> 00:37:32,640
and

900
00:37:32,640 --> 00:37:34,880
they do not inject systems that use

901
00:37:34,880 --> 00:37:37,520
acrylic alphabets

902
00:37:37,520 --> 00:37:38,320
and

903
00:37:38,320 --> 00:37:40,640
their motivation is probably financial

904
00:37:40,640 --> 00:37:43,200
but my question is why they are using so

905
00:37:43,200 --> 00:37:45,760
much rd for this they are using like a

906
00:37:45,760 --> 00:37:48,320
lot of resources to update the software

907
00:37:48,320 --> 00:37:51,280
also hosting uh the uh hosting in phrase

908
00:37:51,280 --> 00:37:53,440
is kind of kind of large and of course

909
00:37:53,440 --> 00:37:55,680
the drop sites they are burning like

910
00:37:55,680 --> 00:37:58,000
super fast those those compromised

911
00:37:58,000 --> 00:38:00,079
wordpresses so

912
00:38:00,079 --> 00:38:01,520
they are finally

913
00:38:01,520 --> 00:38:04,000
i think they are financially motivated

914
00:38:04,000 --> 00:38:06,720
but but why they are spending so much

915
00:38:06,720 --> 00:38:09,440
resources on this because i think you

916
00:38:09,440 --> 00:38:11,520
could actually

917
00:38:11,520 --> 00:38:15,280
do this with less resources as well

918
00:38:15,280 --> 00:38:19,680
and what what can the defenders do

919
00:38:19,680 --> 00:38:23,200
the providers of the

920
00:38:23,520 --> 00:38:24,800
servers

921
00:38:24,800 --> 00:38:27,119
they should do something i think

922
00:38:27,119 --> 00:38:29,680
because if if uh

923
00:38:29,680 --> 00:38:32,079
before flow but

924
00:38:32,079 --> 00:38:33,920
i didn't see that much

925
00:38:33,920 --> 00:38:36,400
i i hadn't seen that much like malware

926
00:38:36,400 --> 00:38:39,599
samples that use dns over https

927
00:38:39,599 --> 00:38:42,480
and now now it looks like i think cobalt

928
00:38:42,480 --> 00:38:44,640
has cobblestrike has some kind of

929
00:38:44,640 --> 00:38:46,320
feature that you can actually implement

930
00:38:46,320 --> 00:38:49,200
the uh dot there as well so when we go

931
00:38:49,200 --> 00:38:50,720
to the world where

932
00:38:50,720 --> 00:38:54,240
all the malwares are using google or

933
00:38:54,240 --> 00:38:56,560
other services for their c2 channel it

934
00:38:56,560 --> 00:38:57,760
will get hard

935
00:38:57,760 --> 00:39:00,880
as a defender to defend your company or

936
00:39:00,880 --> 00:39:03,280
organization network because you have no

937
00:39:03,280 --> 00:39:06,320
visibility and you cannot actually block

938
00:39:06,320 --> 00:39:09,200
those as well so it's getting hard so i

939
00:39:09,200 --> 00:39:12,240
hope that this ideas over https

940
00:39:12,240 --> 00:39:14,880
providers are should

941
00:39:14,880 --> 00:39:16,800
pay more attention what they are

942
00:39:16,800 --> 00:39:19,680
delivering to their network

943
00:39:19,680 --> 00:39:20,960
and

944
00:39:20,960 --> 00:39:21,680
the

945
00:39:21,680 --> 00:39:25,200
not the best way but you know

946
00:39:25,200 --> 00:39:27,280
the best available

947
00:39:27,280 --> 00:39:30,800
method is to use sms or and mms

948
00:39:30,800 --> 00:39:32,880
firewalls

949
00:39:32,880 --> 00:39:35,599
the teleporters should use them so they

950
00:39:35,599 --> 00:39:38,960
should filter filter the traffic so that

951
00:39:38,960 --> 00:39:40,079
these

952
00:39:40,079 --> 00:39:42,400
these spreading messages won't go

953
00:39:42,400 --> 00:39:44,480
through of course

954
00:39:44,480 --> 00:39:47,440
it's it's hard because they're changing

955
00:39:47,440 --> 00:39:50,240
the layout in the messages a lot and a

956
00:39:50,240 --> 00:39:52,800
lot of like legit services use also sms

957
00:39:52,800 --> 00:39:53,680
so

958
00:39:53,680 --> 00:39:56,560
it's hard to like

959
00:39:57,040 --> 00:39:58,079
filter

960
00:39:58,079 --> 00:39:59,040
the

961
00:39:59,040 --> 00:40:02,000
right traffic traffic away

962
00:40:02,000 --> 00:40:04,400
but yeah that's that's the best way how

963
00:40:04,400 --> 00:40:06,880
how how to block this this if this uh

964
00:40:06,880 --> 00:40:07,920
comes

965
00:40:07,920 --> 00:40:09,839
to your country and or if you are

966
00:40:09,839 --> 00:40:13,040
working as in a teleporter

967
00:40:13,040 --> 00:40:15,520
all right but uh here are some resources

968
00:40:15,520 --> 00:40:17,520
so if someone wants to take a look those

969
00:40:17,520 --> 00:40:19,920
samples i mentioned and so on so here's

970
00:40:19,920 --> 00:40:22,400
uh hashes and you can actually download

971
00:40:22,400 --> 00:40:26,160
them from from wireless turtle and also

972
00:40:26,160 --> 00:40:27,680
there are few

973
00:40:27,680 --> 00:40:30,079
good reads about the

974
00:40:30,079 --> 00:40:33,040
flow but as well available online so if

975
00:40:33,040 --> 00:40:35,280
you're interested take a look at those

976
00:40:35,280 --> 00:40:38,680
thank you very much

977
00:40:39,740 --> 00:40:41,280
[Applause]

978
00:40:41,280 --> 00:40:42,800
do we have time for questions two

979
00:40:42,800 --> 00:40:44,560
minutes all right two minutes two

980
00:40:44,560 --> 00:40:48,440
minutes for questions guys

981
00:40:49,840 --> 00:40:53,059
[Music]

982
00:40:53,359 --> 00:40:57,599
hey great presentation by the way um

983
00:40:57,599 --> 00:40:59,119
would you know any

984
00:40:59,119 --> 00:41:00,640
uh

985
00:41:00,640 --> 00:41:03,359
what kind of mitigation though for an

986
00:41:03,359 --> 00:41:06,160
end user to defend against flu bot

987
00:41:06,160 --> 00:41:10,079
is there any current mitigation out

988
00:41:10,079 --> 00:41:14,000
do not use android that's like yeah okay

989
00:41:14,000 --> 00:41:16,880
but you know uh this i do not understand

990
00:41:16,880 --> 00:41:18,640
that why android

991
00:41:18,640 --> 00:41:20,480
side loading is so easy

992
00:41:20,480 --> 00:41:22,560
because these are not hosted in the play

993
00:41:22,560 --> 00:41:25,040
store these applications they are side

994
00:41:25,040 --> 00:41:27,599
loaded so i'm not sure why

995
00:41:27,599 --> 00:41:29,920
for example my mother should ever have a

996
00:41:29,920 --> 00:41:32,240
possibility to site load software

997
00:41:32,240 --> 00:41:32,960
so

998
00:41:32,960 --> 00:41:34,960
i don't understand that but that's like

999
00:41:34,960 --> 00:41:36,720
the best way

1000
00:41:36,720 --> 00:41:39,599
to like mitigate it do not click links

1001
00:41:39,599 --> 00:41:42,480
and download stuff

1002
00:41:44,000 --> 00:41:47,480
okay thank you

1003
00:41:47,720 --> 00:41:50,000
[Music]

1004
00:41:50,000 --> 00:41:52,640
hey yeah great presentation um

1005
00:41:52,640 --> 00:41:54,400
i'm curious you mentioned your emulator

1006
00:41:54,400 --> 00:41:56,319
um and you also mentioned target

1007
00:41:56,319 --> 00:41:59,599
countries but i might have missed it but

1008
00:41:59,599 --> 00:42:01,599
is your

1009
00:42:01,599 --> 00:42:03,920
is the check for like geolocation early

1010
00:42:03,920 --> 00:42:06,160
on and this is influencer emulator in

1011
00:42:06,160 --> 00:42:08,160
terms of like i know you said it was

1012
00:42:08,160 --> 00:42:10,640
partially working kind of having issues

1013
00:42:10,640 --> 00:42:14,319
but yeah yeah yeah well uh

1014
00:42:14,319 --> 00:42:16,160
they are checking the system language

1015
00:42:16,160 --> 00:42:18,720
and they are getting the public id and

1016
00:42:18,720 --> 00:42:22,160
uh it's based on the public ip if they

1017
00:42:22,160 --> 00:42:24,560
are activating the sms campaign on the

1018
00:42:24,560 --> 00:42:28,000
phone or not so for example if if i run

1019
00:42:28,000 --> 00:42:30,560
the sample now from finnish ip

1020
00:42:30,560 --> 00:42:33,440
i i the connection is made but i i will

1021
00:42:33,440 --> 00:42:36,079
not get any comments from the c2 just

1022
00:42:36,079 --> 00:42:38,000
okay like it's

1023
00:42:38,000 --> 00:42:39,599
it's working but it's not giving any

1024
00:42:39,599 --> 00:42:41,760
comments and if i change it for example

1025
00:42:41,760 --> 00:42:42,560
to

1026
00:42:42,560 --> 00:42:45,200
uk and if the campaign is there active i

1027
00:42:45,200 --> 00:42:47,920
will like instantly start getting

1028
00:42:47,920 --> 00:42:50,240
a comment from the c2

1029
00:42:50,240 --> 00:42:52,560
and the second is you you didn't really

1030
00:42:52,560 --> 00:42:54,560
touch on it but you mentioned like um

1031
00:42:54,560 --> 00:42:56,960
hulk's country obviously

1032
00:42:56,960 --> 00:42:58,720
probably the end goal is to hook a web

1033
00:42:58,720 --> 00:42:59,920
browser to grab

1034
00:42:59,920 --> 00:43:02,480
bank information have you looked into

1035
00:43:02,480 --> 00:43:04,400
like the web books or

1036
00:43:04,400 --> 00:43:05,680
is it web books that they're using for

1037
00:43:05,680 --> 00:43:07,280
your browser you mentioned gmail as well

1038
00:43:07,280 --> 00:43:08,720
but yeah

1039
00:43:08,720 --> 00:43:10,960
so uh

1040
00:43:10,960 --> 00:43:13,839
i haven't like done any any anything

1041
00:43:13,839 --> 00:43:16,560
like uh like doing fake credentials

1042
00:43:16,560 --> 00:43:18,319
delivered there and looking what they're

1043
00:43:18,319 --> 00:43:20,240
doing but they they are

1044
00:43:20,240 --> 00:43:22,640
they are doing like uh

1045
00:43:22,640 --> 00:43:23,760
the uh

1046
00:43:23,760 --> 00:43:25,200
layer

1047
00:43:25,200 --> 00:43:27,280
i mentioned the gmail so basically if

1048
00:43:27,280 --> 00:43:29,280
you're using gmail application you will

1049
00:43:29,280 --> 00:43:32,079
open it and the layer will just pop up

1050
00:43:32,079 --> 00:43:34,480
and the user won't see it it's just like

1051
00:43:34,480 --> 00:43:36,560
normal gmail locking page

1052
00:43:36,560 --> 00:43:37,359
and

1053
00:43:37,359 --> 00:43:38,880
then they will fill the corrects and

1054
00:43:38,880 --> 00:43:41,359
then they will leave to the c2

1055
00:43:41,359 --> 00:43:43,359
yeah from my experience and i see like

1056
00:43:43,359 --> 00:43:44,319
it would be

1057
00:43:44,319 --> 00:43:46,319
the gmail will pop up but it would be a

1058
00:43:46,319 --> 00:43:48,319
an api being called with gmail being put

1059
00:43:48,319 --> 00:43:50,400
in as a yeah parameter and that that

1060
00:43:50,400 --> 00:43:52,079
would be the hopkins yeah but they they

1061
00:43:52,079 --> 00:43:54,319
will deliver the yeah yeah their own

1062
00:43:54,319 --> 00:43:56,000
version of gmail yeah that would pop up

1063
00:43:56,000 --> 00:43:59,440
yeah yeah yeah interesting yeah

1064
00:43:59,440 --> 00:43:59,840
yep

1065
00:43:59,840 --> 00:44:02,939
[Music]

1066
00:44:03,119 --> 00:44:05,119
uh you listed the commands were they

1067
00:44:05,119 --> 00:44:06,800
actually in english or did you give

1068
00:44:06,800 --> 00:44:09,440
english names for they are in english so

1069
00:44:09,440 --> 00:44:12,480
yeah they are they list list this uh in

1070
00:44:12,480 --> 00:44:15,760
english it's a case table and it's there

1071
00:44:15,760 --> 00:44:18,640
yeah you mentioned cobalt striker a few

1072
00:44:18,640 --> 00:44:20,800
a few slides back uh every five have you

1073
00:44:20,800 --> 00:44:22,800
seen much cardboard strike pop up for

1074
00:44:22,800 --> 00:44:25,280
this uh kind of attack or no i don't

1075
00:44:25,280 --> 00:44:27,280
know i do not think that cabal strike

1076
00:44:27,280 --> 00:44:28,880
supports arm

1077
00:44:28,880 --> 00:44:31,599
well the armed devices so i'm sure i

1078
00:44:31,599 --> 00:44:34,079
will probably arm yes but android

1079
00:44:34,079 --> 00:44:37,079
devices

1080
00:44:37,839 --> 00:44:39,839
yeah all right thanks

1081
00:44:39,839 --> 00:44:42,240
thanks very much guys

1082
00:44:42,240 --> 00:44:45,419
[Applause]

