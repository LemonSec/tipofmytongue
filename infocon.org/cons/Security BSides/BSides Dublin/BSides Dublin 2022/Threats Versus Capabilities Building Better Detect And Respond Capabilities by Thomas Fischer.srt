1
00:00:04,480 --> 00:00:06,879
good afternoon everybody

2
00:00:06,879 --> 00:00:07,759
um

3
00:00:07,759 --> 00:00:08,960
you have to forgive me if my voice

4
00:00:08,960 --> 00:00:10,559
starts breaking or anything like that i

5
00:00:10,559 --> 00:00:13,200
just came back from three from a trip

6
00:00:13,200 --> 00:00:14,719
where i was doing a lot of talking a lot

7
00:00:14,719 --> 00:00:17,840
of um partying for those who know me

8
00:00:17,840 --> 00:00:20,880
that's really nothing new

9
00:00:20,880 --> 00:00:24,720
um so my name's thomas uh i'm done a lot

10
00:00:24,720 --> 00:00:26,160
of things in my life

11
00:00:26,160 --> 00:00:27,279
actually i should probably update that

12
00:00:27,279 --> 00:00:29,279
line to stay almost 30 plus years of

13
00:00:29,279 --> 00:00:31,359
experience in infosec

14
00:00:31,359 --> 00:00:34,880
i also help run besides london and

15
00:00:34,880 --> 00:00:37,040
brian is in the audience he's also one

16
00:00:37,040 --> 00:00:39,920
of our co-directors

17
00:00:39,920 --> 00:00:42,079
currently i actually work for riot games

18
00:00:42,079 --> 00:00:44,559
and i run the security operations team

19
00:00:44,559 --> 00:00:46,640
for for the company

20
00:00:46,640 --> 00:00:47,680
so what i'm going to talk to you about

21
00:00:47,680 --> 00:00:50,160
today really doesn't have anything to do

22
00:00:50,160 --> 00:00:52,320
with write games it has something to do

23
00:00:52,320 --> 00:00:53,920
with something that's bugged me for a

24
00:00:53,920 --> 00:00:56,640
long time in our industry i'm i've been

25
00:00:56,640 --> 00:00:58,480
an instant responder for a number of

26
00:00:58,480 --> 00:00:59,840
years i do a lot of detention

27
00:00:59,840 --> 00:01:01,359
engineering and things like that just to

28
00:01:01,359 --> 00:01:03,760
try and understand the best way to

29
00:01:03,760 --> 00:01:05,519
protect an organization from the threats

30
00:01:05,519 --> 00:01:07,760
that could come up and also to ensure

31
00:01:07,760 --> 00:01:09,280
that you're doing things so that you're

32
00:01:09,280 --> 00:01:11,840
protected against for example the data

33
00:01:11,840 --> 00:01:13,520
so that you have a focus on data

34
00:01:13,520 --> 00:01:15,439
protection if you need to do that in

35
00:01:15,439 --> 00:01:18,159
your incident response cycles

36
00:01:18,159 --> 00:01:20,799
so why are we here today well i have a

37
00:01:20,799 --> 00:01:22,720
fundamental problem

38
00:01:22,720 --> 00:01:24,720
when i look at insert response when i

39
00:01:24,720 --> 00:01:27,360
look at what we're trying to achieve

40
00:01:27,360 --> 00:01:28,880
the

41
00:01:28,880 --> 00:01:30,799
actors still get in

42
00:01:30,799 --> 00:01:33,360
right we still get breached we still

43
00:01:33,360 --> 00:01:36,320
have we still have uh

44
00:01:36,320 --> 00:01:37,360
issues

45
00:01:37,360 --> 00:01:38,479
where

46
00:01:38,479 --> 00:01:40,640
something gets run in our environments

47
00:01:40,640 --> 00:01:42,560
and then

48
00:01:42,560 --> 00:01:45,200
there's a breach and then but the actors

49
00:01:45,200 --> 00:01:47,280
inside you is inside he's starting to

50
00:01:47,280 --> 00:01:50,479
act he's moving laterally he's gaining

51
00:01:50,479 --> 00:01:52,560
he's getting a footprint potentially

52
00:01:52,560 --> 00:01:54,799
exfoliating stuff or

53
00:01:54,799 --> 00:01:57,439
ransoming you're in your environment

54
00:01:57,439 --> 00:01:58,560
now

55
00:01:58,560 --> 00:02:01,119
is this a failure of people i don't know

56
00:02:01,119 --> 00:02:03,040
i'd rather not think it's a value of

57
00:02:03,040 --> 00:02:05,119
people the reason i don't think it's

58
00:02:05,119 --> 00:02:06,320
fellow people is because i trust the

59
00:02:06,320 --> 00:02:08,080
teams i work with i like to trust the

60
00:02:08,080 --> 00:02:10,080
teams i work with i don't think that

61
00:02:10,080 --> 00:02:12,080
anybody that's doing this work is trying

62
00:02:12,080 --> 00:02:13,840
to fail i think they're trying to do the

63
00:02:13,840 --> 00:02:15,200
best they can

64
00:02:15,200 --> 00:02:17,360
is it a failure of procedures sometimes

65
00:02:17,360 --> 00:02:18,879
it is i'll be honest with you guys

66
00:02:18,879 --> 00:02:21,520
sometimes the procedures the work that

67
00:02:21,520 --> 00:02:24,080
your your playbooks just don't match

68
00:02:24,080 --> 00:02:25,599
what you need to do in your organization

69
00:02:25,599 --> 00:02:27,280
to respond

70
00:02:27,280 --> 00:02:30,000
or is it a failure of technology

71
00:02:30,000 --> 00:02:31,519
and this is where

72
00:02:31,519 --> 00:02:33,280
i get stuck

73
00:02:33,280 --> 00:02:35,599
because we spend a massive amount of

74
00:02:35,599 --> 00:02:38,080
money on technology right we spend

75
00:02:38,080 --> 00:02:39,760
literally sometimes millions of dollars

76
00:02:39,760 --> 00:02:42,400
a year keeping our technology running

77
00:02:42,400 --> 00:02:43,200
using

78
00:02:43,200 --> 00:02:44,800
implementing our technology improving

79
00:02:44,800 --> 00:02:46,959
our technology to catch to catch the bad

80
00:02:46,959 --> 00:02:48,879
guys

81
00:02:48,879 --> 00:02:51,120
this week i was at some presentations

82
00:02:51,120 --> 00:02:53,120
and this quote came up i actually kind

83
00:02:53,120 --> 00:02:54,400
of like it our failures are a

84
00:02:54,400 --> 00:02:56,400
consequence of many factors but possibly

85
00:02:56,400 --> 00:02:58,319
one of the most important is the fact

86
00:02:58,319 --> 00:02:59,840
that society operates on the fear that

87
00:02:59,840 --> 00:03:01,920
specialization is the key to success and

88
00:03:01,920 --> 00:03:03,760
not realizing that specialization

89
00:03:03,760 --> 00:03:06,080
precludes comprehensive thinking this is

90
00:03:06,080 --> 00:03:08,560
from buck this is by bucks mr fuller he

91
00:03:08,560 --> 00:03:10,720
wrote a um spaceship earth i think it's

92
00:03:10,720 --> 00:03:12,480
called i can't remember the book exactly

93
00:03:12,480 --> 00:03:14,159
but it's a

94
00:03:14,159 --> 00:03:15,280
i have to actually read this because

95
00:03:15,280 --> 00:03:16,720
apparently it's pretty good

96
00:03:16,720 --> 00:03:18,720
um even though it

97
00:03:18,720 --> 00:03:20,720
seems to be far far-fetched but i like

98
00:03:20,720 --> 00:03:22,319
the quote because there's a few things

99
00:03:22,319 --> 00:03:24,080
that i highlighted right specialization

100
00:03:24,080 --> 00:03:26,159
the comprehensive thinking

101
00:03:26,159 --> 00:03:28,239
but if i replace

102
00:03:28,239 --> 00:03:30,159
society by security

103
00:03:30,159 --> 00:03:33,760
and i replace specialization by tools

104
00:03:33,760 --> 00:03:36,319
this still works

105
00:03:36,319 --> 00:03:37,200
right

106
00:03:37,200 --> 00:03:39,760
because secure on some of the security

107
00:03:39,760 --> 00:03:41,760
operations that we do

108
00:03:41,760 --> 00:03:44,000
we rely intensely on certain tools we

109
00:03:44,000 --> 00:03:46,159
rely intensely on upgrading our tools or

110
00:03:46,159 --> 00:03:48,159
taking new tools into into

111
00:03:48,159 --> 00:03:50,879
into into production to help us protect

112
00:03:50,879 --> 00:03:52,480
but we're not actually thinking this

113
00:03:52,480 --> 00:03:53,360
through

114
00:03:53,360 --> 00:03:54,879
and one of the reasons is and i'm sorry

115
00:03:54,879 --> 00:03:56,239
if there are any vendors in the in the

116
00:03:56,239 --> 00:03:57,519
audience but

117
00:03:57,519 --> 00:04:00,799
we've got vendor overload every few

118
00:04:00,799 --> 00:04:02,720
years a vendor will come up with a new

119
00:04:02,720 --> 00:04:05,040
term and i really like this this is from

120
00:04:05,040 --> 00:04:08,000
from uh from secure

121
00:04:08,000 --> 00:04:09,200
security

122
00:04:09,200 --> 00:04:10,959
security tiny

123
00:04:10,959 --> 00:04:11,840
um

124
00:04:11,840 --> 00:04:13,120
basically

125
00:04:13,120 --> 00:04:15,519
my problem is that vendors are

126
00:04:15,519 --> 00:04:17,440
constantly telling us that you know

127
00:04:17,440 --> 00:04:18,798
we've got this new tool we've got this

128
00:04:18,798 --> 00:04:19,759
new

129
00:04:19,759 --> 00:04:23,120
way of doing things we've got xdr now

130
00:04:23,120 --> 00:04:25,280
we've got all of this stuff you know we

131
00:04:25,280 --> 00:04:27,040
want to implement zero trust it'll be

132
00:04:27,040 --> 00:04:28,880
better for you

133
00:04:28,880 --> 00:04:30,560
and at the end of the day vendors are

134
00:04:30,560 --> 00:04:32,160
essentially telling us

135
00:04:32,160 --> 00:04:33,520
well

136
00:04:33,520 --> 00:04:36,160
you know we're the best we're awesome we

137
00:04:36,160 --> 00:04:37,919
can protect your organization we can

138
00:04:37,919 --> 00:04:40,320
detect everything in the sun

139
00:04:40,320 --> 00:04:42,960
don't get me wrong you know

140
00:04:42,960 --> 00:04:44,639
they think they can

141
00:04:44,639 --> 00:04:47,840
but i can test what they probably can't

142
00:04:47,840 --> 00:04:49,600
and the other problem i have too is that

143
00:04:49,600 --> 00:04:50,880
yeah this is a marketing pitch you

144
00:04:50,880 --> 00:04:53,520
evaluate your tools you do things but

145
00:04:53,520 --> 00:04:55,360
it's kind of pushy they're kind of

146
00:04:55,360 --> 00:04:57,360
constantly telling us that they have the

147
00:04:57,360 --> 00:04:58,960
best tools and that they want the best

148
00:04:58,960 --> 00:05:00,639
tools and the problem is they'll usually

149
00:05:00,639 --> 00:05:02,320
go pretty high up in the organization to

150
00:05:02,320 --> 00:05:04,160
try and sell you on this so if you have

151
00:05:04,160 --> 00:05:06,960
an organization where the cso

152
00:05:06,960 --> 00:05:10,639
you know relies on also on you know

153
00:05:10,639 --> 00:05:12,000
people like garden and things like that

154
00:05:12,000 --> 00:05:13,759
tell them what the best tool what the

155
00:05:13,759 --> 00:05:15,600
next best technology is

156
00:05:15,600 --> 00:05:17,840
you start to get kind of peer pressure

157
00:05:17,840 --> 00:05:19,520
you start to get overload from all of

158
00:05:19,520 --> 00:05:21,520
these vendors and you start to feel like

159
00:05:21,520 --> 00:05:23,600
you need to adopt these tools but you're

160
00:05:23,600 --> 00:05:24,960
not you don't really know why you're

161
00:05:24,960 --> 00:05:26,880
adopting them to a certain extent and

162
00:05:26,880 --> 00:05:28,720
this is this is something that you know

163
00:05:28,720 --> 00:05:30,000
i've experienced you've probably

164
00:05:30,000 --> 00:05:31,360
experienced too

165
00:05:31,360 --> 00:05:34,320
i just don't like the idea of us having

166
00:05:34,320 --> 00:05:36,320
to buy a tool because it's the new best

167
00:05:36,320 --> 00:05:38,639
thing right well because they say they

168
00:05:38,639 --> 00:05:40,560
they they detect everything

169
00:05:40,560 --> 00:05:42,160
and

170
00:05:42,160 --> 00:05:43,600
to continue on this

171
00:05:43,600 --> 00:05:46,240
kind of rant and i like to rant right

172
00:05:46,240 --> 00:05:48,880
because i because that's just the way i

173
00:05:48,880 --> 00:05:51,199
i do things people there's a few people

174
00:05:51,199 --> 00:05:53,199
who know me will tell you that i rant

175
00:05:53,199 --> 00:05:54,800
like crazy sometimes

176
00:05:54,800 --> 00:05:55,840
but

177
00:05:55,840 --> 00:05:58,960
one of the problems is minor attack

178
00:05:58,960 --> 00:06:00,960
i have mixed feelings about mario attack

179
00:06:00,960 --> 00:06:02,000
if you've seen some of my previous

180
00:06:02,000 --> 00:06:03,440
presentations you know

181
00:06:03,440 --> 00:06:06,319
i will literally like cast this this

182
00:06:06,319 --> 00:06:07,759
framework

183
00:06:07,759 --> 00:06:10,560
micro attack is really good for defining

184
00:06:10,560 --> 00:06:13,919
what actors do the ttps to give you an

185
00:06:13,919 --> 00:06:16,560
idea of of some of the capabilities it's

186
00:06:16,560 --> 00:06:18,000
also a really great framework to explain

187
00:06:18,000 --> 00:06:20,639
to people what's going on from kind of a

188
00:06:20,639 --> 00:06:22,160
non-technical technical and it's even

189
00:06:22,160 --> 00:06:24,080
worse now it's actually a lot there's a

190
00:06:24,080 --> 00:06:26,160
lot more non-technical aspects to it so

191
00:06:26,160 --> 00:06:27,919
that you can actually take a security

192
00:06:27,919 --> 00:06:29,759
team and it's a response team and they

193
00:06:29,759 --> 00:06:32,240
can kind of use the miter attack to to

194
00:06:32,240 --> 00:06:34,720
identify different the different steps

195
00:06:34,720 --> 00:06:35,919
they can either describe different

196
00:06:35,919 --> 00:06:37,520
phases of an attack but it also helps

197
00:06:37,520 --> 00:06:39,600
them communicate better upwards

198
00:06:39,600 --> 00:06:41,440
and i like that for that i like minor

199
00:06:41,440 --> 00:06:43,600
attack the problem is i have with minor

200
00:06:43,600 --> 00:06:45,199
attack is that

201
00:06:45,199 --> 00:06:47,360
vendors started investing into it right

202
00:06:47,360 --> 00:06:48,960
so they start to say oh yeah this is

203
00:06:48,960 --> 00:06:50,880
really great we can use this to actually

204
00:06:50,880 --> 00:06:53,039
demonstrate what our products do things

205
00:06:53,039 --> 00:06:55,199
and so you have

206
00:06:55,199 --> 00:06:56,639
the evaluation

207
00:06:56,639 --> 00:06:59,680
framework the evaluation system

208
00:06:59,680 --> 00:07:03,120
and yeah okay fine but

209
00:07:03,120 --> 00:07:04,400
it doesn't prove that you can actually

210
00:07:04,400 --> 00:07:06,400
do what you're doing it proves that you

211
00:07:06,400 --> 00:07:07,039
are

212
00:07:07,039 --> 00:07:09,280
essentially capable of

213
00:07:09,280 --> 00:07:11,919
reacting against certain freight actors

214
00:07:11,919 --> 00:07:12,960
right

215
00:07:12,960 --> 00:07:14,560
if you think about it you're you're

216
00:07:14,560 --> 00:07:16,560
acting against whoops

217
00:07:16,560 --> 00:07:19,120
i'm sorry

218
00:07:24,560 --> 00:07:28,680
thomas isn't failing today

219
00:07:31,599 --> 00:07:33,360
let's go back so

220
00:07:33,360 --> 00:07:34,880
you're you're

221
00:07:34,880 --> 00:07:37,440
you're going to be able to act

222
00:07:37,440 --> 00:07:38,960
against

223
00:07:38,960 --> 00:07:41,120
specific vendors with your

224
00:07:41,120 --> 00:07:43,199
specific threat actors that you're

225
00:07:43,199 --> 00:07:45,599
testing against right and yes every year

226
00:07:45,599 --> 00:07:47,759
mitra kind of pushes that that

227
00:07:47,759 --> 00:07:49,199
that testing framework a little bit

228
00:07:49,199 --> 00:07:51,039
further and further up the problem i

229
00:07:51,039 --> 00:07:52,160
have is that

230
00:07:52,160 --> 00:07:54,000
i know specifically for for some of the

231
00:07:54,000 --> 00:07:55,360
organizations that i've worked with

232
00:07:55,360 --> 00:07:57,199
today and in the past

233
00:07:57,199 --> 00:07:59,120
those actually after axes are listed

234
00:07:59,120 --> 00:08:02,080
here don't really concern me

235
00:08:02,080 --> 00:08:03,840
they're not the ones i'm particularly

236
00:08:03,840 --> 00:08:06,080
interested in right that might be

237
00:08:06,080 --> 00:08:07,680
interested in them in the future but

238
00:08:07,680 --> 00:08:09,039
right now i might have some different

239
00:08:09,039 --> 00:08:11,280
visions of which actors i want to i want

240
00:08:11,280 --> 00:08:13,520
to specifically detect in my environment

241
00:08:13,520 --> 00:08:16,319
which actors i know are going to look at

242
00:08:16,319 --> 00:08:18,960
attacking my environment or or

243
00:08:18,960 --> 00:08:22,400
that they want something from me so yeah

244
00:08:22,400 --> 00:08:24,319
you cover a bunch of ttps you can

245
00:08:24,319 --> 00:08:25,599
demonstrate it against the threat the

246
00:08:25,599 --> 00:08:27,919
matter attack but is this really what

247
00:08:27,919 --> 00:08:30,319
what is going to save my organization or

248
00:08:30,319 --> 00:08:32,958
protect my organization

249
00:08:32,958 --> 00:08:34,640
so i've been thinking over the past few

250
00:08:34,640 --> 00:08:36,399
years what can be done differently and

251
00:08:36,399 --> 00:08:37,599
so when you're on lockdown you've got

252
00:08:37,599 --> 00:08:39,200
nothing else to do basically start to

253
00:08:39,200 --> 00:08:41,839
think i hope you i hope you do

254
00:08:41,839 --> 00:08:43,039
otherwise you're going to get really

255
00:08:43,039 --> 00:08:44,959
bored so i started thinking about things

256
00:08:44,959 --> 00:08:46,800
right so i started going down the road

257
00:08:46,800 --> 00:08:49,360
of how am i going to solve this problem

258
00:08:49,360 --> 00:08:52,240
so i've been in this industry like i

259
00:08:52,240 --> 00:08:53,920
said earlier a long time i've done a

260
00:08:53,920 --> 00:08:55,680
whole bunch of different roles i've done

261
00:08:55,680 --> 00:08:58,959
appsec i've done security architecture

262
00:08:58,959 --> 00:09:01,680
i've done compliance i've done privacy i

263
00:09:01,680 --> 00:09:03,360
know you know i've gone through all the

264
00:09:03,360 --> 00:09:06,080
different environment different um

265
00:09:06,080 --> 00:09:09,600
places so i know essentially what can

266
00:09:09,600 --> 00:09:11,760
what what different parts of the

267
00:09:11,760 --> 00:09:15,920
security for the security life cycle

268
00:09:17,920 --> 00:09:19,360
gets done

269
00:09:19,360 --> 00:09:21,279
one of the things that i've always liked

270
00:09:21,279 --> 00:09:22,560
to threat modeling

271
00:09:22,560 --> 00:09:24,160
and you know i'm not going to read this

272
00:09:24,160 --> 00:09:26,000
that it's the def standard oh what's

273
00:09:26,000 --> 00:09:27,360
definition but threat modeling is

274
00:09:27,360 --> 00:09:28,800
interesting because you're basically

275
00:09:28,800 --> 00:09:30,480
taking

276
00:09:30,480 --> 00:09:31,600
the your

277
00:09:31,600 --> 00:09:34,560
your application or your architecture

278
00:09:34,560 --> 00:09:35,680
and you're looking at the different

279
00:09:35,680 --> 00:09:37,279
aspects of it and you're trying to

280
00:09:37,279 --> 00:09:38,880
determine where the failures in that

281
00:09:38,880 --> 00:09:41,040
architecture you're trying to determine

282
00:09:41,040 --> 00:09:41,839
what

283
00:09:41,839 --> 00:09:43,680
what threats can act on your

284
00:09:43,680 --> 00:09:46,160
architecture and try to build in

285
00:09:46,160 --> 00:09:47,920
mitigations and look at how what

286
00:09:47,920 --> 00:09:49,680
controls you need in place and i've

287
00:09:49,680 --> 00:09:51,360
always argued you know i argue

288
00:09:51,360 --> 00:09:53,040
continuously with teams it's like if you

289
00:09:53,040 --> 00:09:54,399
do a freight if you do have threat mode

290
00:09:54,399 --> 00:09:56,959
link and you're playing putting in place

291
00:09:56,959 --> 00:09:58,480
controls because you can't really

292
00:09:58,480 --> 00:09:59,519
correct

293
00:09:59,519 --> 00:10:01,839
whatever whatever weakness you found

294
00:10:01,839 --> 00:10:03,440
those controls should be should be

295
00:10:03,440 --> 00:10:04,800
escalated down so that detection

296
00:10:04,800 --> 00:10:06,320
engineering can actually build them up

297
00:10:06,320 --> 00:10:08,079
as as detections and so which you can

298
00:10:08,079 --> 00:10:10,160
detect if somebody is

299
00:10:10,160 --> 00:10:11,680
pushing through those

300
00:10:11,680 --> 00:10:13,040
those controls that you've put into

301
00:10:13,040 --> 00:10:14,720
place

302
00:10:14,720 --> 00:10:16,720
but fundamentally fret modeling is a

303
00:10:16,720 --> 00:10:19,360
risk based approach so you decide okay

304
00:10:19,360 --> 00:10:20,800
i'm going to evaluate my environment i'm

305
00:10:20,800 --> 00:10:22,240
going to build a nice workflow probably

306
00:10:22,240 --> 00:10:24,959
a dfd or a process workflow and you're

307
00:10:24,959 --> 00:10:27,200
going to identify what this application

308
00:10:27,200 --> 00:10:29,360
is doing and look at the places where

309
00:10:29,360 --> 00:10:31,040
you think there's a risk that you could

310
00:10:31,040 --> 00:10:33,040
be attack for example if you have if you

311
00:10:33,040 --> 00:10:35,279
have a login page can you you're going

312
00:10:35,279 --> 00:10:37,279
to evaluate you're going to evaluate

313
00:10:37,279 --> 00:10:39,279
against brute force brute force brute

314
00:10:39,279 --> 00:10:40,640
forcing on that login page something

315
00:10:40,640 --> 00:10:42,959
like that

316
00:10:42,959 --> 00:10:45,200
but does it really work

317
00:10:45,200 --> 00:10:47,839
for it's an incident responder

318
00:10:47,839 --> 00:10:49,279
does it really work for a detection

319
00:10:49,279 --> 00:10:50,399
engineer

320
00:10:50,399 --> 00:10:52,320
if you think about for you

321
00:10:52,320 --> 00:10:54,399
you're when we're doing instant response

322
00:10:54,399 --> 00:10:56,000
while you're doing the detection

323
00:10:56,000 --> 00:10:58,000
engineering you're essentially looking

324
00:10:58,000 --> 00:10:59,200
at

325
00:10:59,200 --> 00:11:01,120
specific events you want to detect

326
00:11:01,120 --> 00:11:02,800
specific events but worse than that you

327
00:11:02,800 --> 00:11:06,079
want to detect a timeline of events you

328
00:11:06,079 --> 00:11:07,519
want to find the timeline of events

329
00:11:07,519 --> 00:11:09,360
that's going to trigger an alert or

330
00:11:09,360 --> 00:11:10,399
that's going to tell you that

331
00:11:10,399 --> 00:11:11,600
something's going wrong in your

332
00:11:11,600 --> 00:11:13,600
environment

333
00:11:13,600 --> 00:11:15,360
so

334
00:11:15,360 --> 00:11:18,320
determining controls and determining

335
00:11:18,320 --> 00:11:19,760
mitigations

336
00:11:19,760 --> 00:11:23,040
fire process and a risk-based approach

337
00:11:23,040 --> 00:11:24,560
gives you a starting point but it

338
00:11:24,560 --> 00:11:26,079
doesn't really tell you

339
00:11:26,079 --> 00:11:27,440
that detail

340
00:11:27,440 --> 00:11:28,959
enough

341
00:11:28,959 --> 00:11:31,200
so that you can build those alerts so

342
00:11:31,200 --> 00:11:32,880
that you can build those response

343
00:11:32,880 --> 00:11:35,120
activities

344
00:11:35,120 --> 00:11:36,240
so i started looking for a more

345
00:11:36,240 --> 00:11:38,320
practical approach i was thinking if i

346
00:11:38,320 --> 00:11:41,040
take the site this this idea how can i

347
00:11:41,040 --> 00:11:42,480
actually build something

348
00:11:42,480 --> 00:11:44,000
and do something where i'm going to be

349
00:11:44,000 --> 00:11:45,519
able to identify

350
00:11:45,519 --> 00:11:47,920
if my tool is is actually working and if

351
00:11:47,920 --> 00:11:49,120
i've got the right

352
00:11:49,120 --> 00:11:50,880
right things in place to be able to

353
00:11:50,880 --> 00:11:53,040
protect the organization

354
00:11:53,040 --> 00:11:54,880
so i came up with four

355
00:11:54,880 --> 00:11:57,839
distinct things that i kind of needed to

356
00:11:57,839 --> 00:11:59,440
understand

357
00:11:59,440 --> 00:12:01,279
and i'm pretty sure i'm not sure you

358
00:12:01,279 --> 00:12:02,800
know this is this is a work in progress

359
00:12:02,800 --> 00:12:03,920
right so

360
00:12:03,920 --> 00:12:06,079
right now i think it's i think it's what

361
00:12:06,079 --> 00:12:08,320
i need i'm not sure if it's

362
00:12:08,320 --> 00:12:11,279
exactly what i need but

363
00:12:11,279 --> 00:12:13,040
overall

364
00:12:13,040 --> 00:12:15,839
it's it's a start it's a stepping stone

365
00:12:15,839 --> 00:12:17,279
and i'm hoping that it's gonna it's

366
00:12:17,279 --> 00:12:18,800
gonna work and i'm hoping this is gonna

367
00:12:18,800 --> 00:12:20,959
help you think differently and start to

368
00:12:20,959 --> 00:12:23,279
think about how can you think

369
00:12:23,279 --> 00:12:26,240
of ways of building you well integrating

370
00:12:26,240 --> 00:12:27,440
new tools into your environment that

371
00:12:27,440 --> 00:12:29,600
help you protect an organization better

372
00:12:29,600 --> 00:12:31,839
so my first aspect was i wanted a threat

373
00:12:31,839 --> 00:12:33,120
driven approach

374
00:12:33,120 --> 00:12:35,680
yes i still want to keep that that that

375
00:12:35,680 --> 00:12:37,680
concept that we have for actors they do

376
00:12:37,680 --> 00:12:38,399
things

377
00:12:38,399 --> 00:12:39,920
they do things in a very similar way all

378
00:12:39,920 --> 00:12:41,839
the time so i want those threat actors

379
00:12:41,839 --> 00:12:44,720
to be detected but i also like the idea

380
00:12:44,720 --> 00:12:46,800
of the you know the the techniques and

381
00:12:46,800 --> 00:12:48,000
the procedures so i have those

382
00:12:48,000 --> 00:12:49,760
techniques in those procedures i also

383
00:12:49,760 --> 00:12:51,519
wanted to take those

384
00:12:51,519 --> 00:12:53,279
but techniques and procedures evolve

385
00:12:53,279 --> 00:12:54,880
over time and they can be mixed together

386
00:12:54,880 --> 00:12:57,200
to do different things so threat driven

387
00:12:57,200 --> 00:12:58,880
approach to me is more about let's

388
00:12:58,880 --> 00:13:00,959
conceptualize that let's not focus on

389
00:13:00,959 --> 00:13:05,200
one specific actor but focus on perhaps

390
00:13:05,200 --> 00:13:06,480
ransomware

391
00:13:06,480 --> 00:13:07,680
and all the different variants of

392
00:13:07,680 --> 00:13:10,240
ransomware focus on perhaps

393
00:13:10,240 --> 00:13:11,040
uh

394
00:13:11,040 --> 00:13:12,800
back doors and all the different types

395
00:13:12,800 --> 00:13:14,720
of backdoors and what could happen

396
00:13:14,720 --> 00:13:16,480
or focus on

397
00:13:16,480 --> 00:13:18,320
lateral movement say if i'm very

398
00:13:18,320 --> 00:13:19,600
concerned with detecting lateral

399
00:13:19,600 --> 00:13:21,600
movement i'll focus on lateral movement

400
00:13:21,600 --> 00:13:24,160
as a threat or focus on active directory

401
00:13:24,160 --> 00:13:26,079
compromise

402
00:13:26,079 --> 00:13:28,399
if you take a look at all all the recent

403
00:13:28,399 --> 00:13:30,079
attacks that have happened and all the

404
00:13:30,079 --> 00:13:31,760
recent big big attacks that have been in

405
00:13:31,760 --> 00:13:35,120
the news a lot of them start with

406
00:13:35,120 --> 00:13:38,079
the active directory got compromised

407
00:13:38,079 --> 00:13:40,720
uh slack boolean slack a slack user got

408
00:13:40,720 --> 00:13:42,480
compromised and

409
00:13:42,480 --> 00:13:44,959
their saml token which doesn't expire

410
00:13:44,959 --> 00:13:47,920
too fast enough was used to access

411
00:13:47,920 --> 00:13:50,000
github whatever right

412
00:13:50,000 --> 00:13:52,160
so you've got all of these examples that

413
00:13:52,160 --> 00:13:53,920
you can rely on but you want to

414
00:13:53,920 --> 00:13:55,440
conceptualize those threats and remove

415
00:13:55,440 --> 00:13:57,360
that fret axis so that you can

416
00:13:57,360 --> 00:13:59,279
cover a broader base

417
00:13:59,279 --> 00:14:00,800
you want to understand the capabilities

418
00:14:00,800 --> 00:14:03,120
as well right so what i want to do is i

419
00:14:03,120 --> 00:14:05,199
kind of want to say

420
00:14:05,199 --> 00:14:06,639
look

421
00:14:06,639 --> 00:14:08,160
oops

422
00:14:08,160 --> 00:14:10,480
it's a bit fast

423
00:14:10,480 --> 00:14:13,680
i i kind of want to say

424
00:14:13,920 --> 00:14:15,440
what are the i mean i've already i've

425
00:14:15,440 --> 00:14:18,639
kind of already said it sorry

426
00:14:20,639 --> 00:14:21,920
this thing hasn't worked in so long it

427
00:14:21,920 --> 00:14:23,680
doesn't want to work anymore so i kind

428
00:14:23,680 --> 00:14:25,680
of want to understand the capabilities

429
00:14:25,680 --> 00:14:27,920
um

430
00:14:28,240 --> 00:14:30,639
others are ttps

431
00:14:30,639 --> 00:14:33,120
yes from the actors point of view but

432
00:14:33,120 --> 00:14:34,880
what i actually want to focus on here is

433
00:14:34,880 --> 00:14:37,760
what are my capabilities what can i do

434
00:14:37,760 --> 00:14:40,079
what can my organization do what can my

435
00:14:40,079 --> 00:14:42,160
team do

436
00:14:42,160 --> 00:14:44,639
the third point was i need to it to help

437
00:14:44,639 --> 00:14:47,040
me define the detections that it that i

438
00:14:47,040 --> 00:14:48,560
can achieve

439
00:14:48,560 --> 00:14:50,480
and the detections that i need

440
00:14:50,480 --> 00:14:51,279
right

441
00:14:51,279 --> 00:14:54,000
i don't care about you can detect apt-29

442
00:14:54,000 --> 00:14:55,600
i care but i can detect the different

443
00:14:55,600 --> 00:14:57,760
capabilities well i could but i have the

444
00:14:57,760 --> 00:14:58,959
different capabilities to be able to

445
00:14:58,959 --> 00:15:01,760
detect different ttps and the vast

446
00:15:01,760 --> 00:15:04,000
majority of ttps

447
00:15:04,000 --> 00:15:05,839
and how i build those detections based

448
00:15:05,839 --> 00:15:07,519
on the information that i have in front

449
00:15:07,519 --> 00:15:08,480
of me

450
00:15:08,480 --> 00:15:10,959
and lastly i wanted to identify how

451
00:15:10,959 --> 00:15:13,199
effective my response is so how do i

452
00:15:13,199 --> 00:15:15,040
take those detections that i have the

453
00:15:15,040 --> 00:15:16,800
information that i can gather

454
00:15:16,800 --> 00:15:20,639
and build a response model on top of it

455
00:15:25,199 --> 00:15:28,319
this is really annoying

456
00:15:29,040 --> 00:15:30,639
so what's the pr so the premise that i

457
00:15:30,639 --> 00:15:31,920
came up with is

458
00:15:31,920 --> 00:15:33,440
what threats are my organizations

459
00:15:33,440 --> 00:15:35,519
concerned with

460
00:15:35,519 --> 00:15:37,360
so i have a specific set of threats in

461
00:15:37,360 --> 00:15:39,199
my current organization right games i

462
00:15:39,199 --> 00:15:42,079
have a very specific set of threats

463
00:15:42,079 --> 00:15:43,199
um

464
00:15:43,199 --> 00:15:44,959
you may you know probably sought project

465
00:15:44,959 --> 00:15:47,040
right got ransomware last year it's

466
00:15:47,040 --> 00:15:49,600
another gaming company ea got recent was

467
00:15:49,600 --> 00:15:51,440
it recently in the news as well

468
00:15:51,440 --> 00:15:53,680
but so i do know there are threats out

469
00:15:53,680 --> 00:15:55,519
there and there are potentially

470
00:15:55,519 --> 00:15:57,199
actors that are going to target me so

471
00:15:57,199 --> 00:15:58,959
i'm going to build kind of like models

472
00:15:58,959 --> 00:16:00,639
of the threats that i want to but i want

473
00:16:00,639 --> 00:16:02,160
to protect myself against

474
00:16:02,160 --> 00:16:04,880
i'm going to identify my assets

475
00:16:04,880 --> 00:16:06,079
that's one important thing that we

476
00:16:06,079 --> 00:16:08,240
forget as incident responders is do we

477
00:16:08,240 --> 00:16:09,759
really know our assets do we know

478
00:16:09,759 --> 00:16:11,440
everything that we really have in our

479
00:16:11,440 --> 00:16:13,519
environment that we need to protect and

480
00:16:13,519 --> 00:16:14,959
can we get the right information out of

481
00:16:14,959 --> 00:16:18,880
those environments uh that that we need

482
00:16:18,880 --> 00:16:20,560
comment i mean

483
00:16:20,560 --> 00:16:23,199
i'm gonna go back to the tools

484
00:16:23,199 --> 00:16:24,880
have you guys heard of exoneus how many

485
00:16:24,880 --> 00:16:27,680
of you have heard of exoneus

486
00:16:27,680 --> 00:16:30,959
a few of you so axonias basically is

487
00:16:30,959 --> 00:16:33,120
they're

488
00:16:33,120 --> 00:16:35,920
they're claiming to be a automated i

489
00:16:35,920 --> 00:16:37,279
don't know exactly what they call

490
00:16:37,279 --> 00:16:38,720
themselves but essentially what they try

491
00:16:38,720 --> 00:16:40,320
to do is they pull in all the places

492
00:16:40,320 --> 00:16:42,000
where you can potentially have

493
00:16:42,000 --> 00:16:44,160
inventory information like active

494
00:16:44,160 --> 00:16:46,160
directory the sccm

495
00:16:46,160 --> 00:16:48,800
aws

496
00:16:49,199 --> 00:16:50,399
servicenow

497
00:16:50,399 --> 00:16:52,000
and they might they merge all of that

498
00:16:52,000 --> 00:16:54,320
together to basically give you a vision

499
00:16:54,320 --> 00:16:56,480
and a view of your assets

500
00:16:56,480 --> 00:16:59,680
and so they'll ma it'll it'll identify

501
00:16:59,680 --> 00:17:01,440
the computers the users that are on that

502
00:17:01,440 --> 00:17:03,600
computer and things like that

503
00:17:03,600 --> 00:17:04,959
so that's

504
00:17:04,959 --> 00:17:06,959
kind of assets but assets are also your

505
00:17:06,959 --> 00:17:08,799
applications they're also your data

506
00:17:08,799 --> 00:17:10,640
stores and things like that your network

507
00:17:10,640 --> 00:17:13,119
structure your networking environment

508
00:17:13,119 --> 00:17:16,240
you know if you if you subscribe to a

509
00:17:16,240 --> 00:17:17,919
like a company like managing that's

510
00:17:17,919 --> 00:17:19,520
outside and they give you insulin

511
00:17:19,520 --> 00:17:22,559
response um services or

512
00:17:22,559 --> 00:17:24,480
remediation services first thing they're

513
00:17:24,480 --> 00:17:25,760
going to tell you is like could you have

514
00:17:25,760 --> 00:17:27,679
a network map

515
00:17:27,679 --> 00:17:28,960
it's like how many of you are in

516
00:17:28,960 --> 00:17:30,960
organizations so they can swear they

517
00:17:30,960 --> 00:17:34,320
have a proper network map

518
00:17:34,799 --> 00:17:36,960
no one of course not

519
00:17:36,960 --> 00:17:39,200
the network changes constantly

520
00:17:39,200 --> 00:17:40,880
um and it was been worse for the past

521
00:17:40,880 --> 00:17:41,919
couple years right because we've

522
00:17:41,919 --> 00:17:43,520
basically completely destroyed the

523
00:17:43,520 --> 00:17:44,640
network because everybody's been working

524
00:17:44,640 --> 00:17:47,120
from home you want to determine your

525
00:17:47,120 --> 00:17:49,760
detection data points too i don't care

526
00:17:49,760 --> 00:17:51,679
that you can detect a running process i

527
00:17:51,679 --> 00:17:52,559
care

528
00:17:52,559 --> 00:17:54,960
well i do but i don't i what i want to

529
00:17:54,960 --> 00:17:56,880
know is what information do i want from

530
00:17:56,880 --> 00:17:58,720
that running process

531
00:17:58,720 --> 00:18:00,000
what information is going to be useful

532
00:18:00,000 --> 00:18:03,120
for me to build a detection

533
00:18:03,120 --> 00:18:05,039
and then finally i'm going to want to

534
00:18:05,039 --> 00:18:08,160
determine what response and actions that

535
00:18:08,160 --> 00:18:10,000
i want to take and the data points that

536
00:18:10,000 --> 00:18:11,760
i need to take those actions

537
00:18:11,760 --> 00:18:13,840
so for example if i have ransomware of

538
00:18:13,840 --> 00:18:14,960
course i'm going to want to stop it from

539
00:18:14,960 --> 00:18:16,960
encrypting so what do i need to kind of

540
00:18:16,960 --> 00:18:18,640
understand what what data points do i

541
00:18:18,640 --> 00:18:20,160
need to be able to determine if

542
00:18:20,160 --> 00:18:21,840
something is being encrypted and if how

543
00:18:21,840 --> 00:18:23,840
to stop it or how to

544
00:18:23,840 --> 00:18:25,440
essentially maybe capture the way that

545
00:18:25,440 --> 00:18:27,520
it's encrypting so what i don't so i can

546
00:18:27,520 --> 00:18:30,639
potentially reverse it

547
00:18:31,280 --> 00:18:32,880
so the approach that i've been working

548
00:18:32,880 --> 00:18:34,480
on right now

549
00:18:34,480 --> 00:18:36,240
and this could change that's why i put

550
00:18:36,240 --> 00:18:37,520
whatever floats your boat on the first

551
00:18:37,520 --> 00:18:40,400
bullet point is i start with a mind map

552
00:18:40,400 --> 00:18:42,080
i like mind maps if you don't know what

553
00:18:42,080 --> 00:18:43,840
a mind map is i suggest you look it up

554
00:18:43,840 --> 00:18:45,360
i'm not going to go through the concepts

555
00:18:45,360 --> 00:18:46,880
of mind maps it's there's so many

556
00:18:46,880 --> 00:18:48,400
different variations but essentially

557
00:18:48,400 --> 00:18:50,240
it's like you break things down into

558
00:18:50,240 --> 00:18:52,480
into bite-sized chunks that make that

559
00:18:52,480 --> 00:18:53,919
help you understand what you're looking

560
00:18:53,919 --> 00:18:56,559
at what you're trying to model in my

561
00:18:56,559 --> 00:18:58,879
case

562
00:18:59,039 --> 00:19:00,160
i

563
00:19:00,160 --> 00:19:02,720
needed somewhere to start and for a lot

564
00:19:02,720 --> 00:19:04,640
of instant responders a lot of detection

565
00:19:04,640 --> 00:19:06,080
engineering we're talking about using

566
00:19:06,080 --> 00:19:08,000
things like incident response framework

567
00:19:08,000 --> 00:19:09,600
right so nist

568
00:19:09,600 --> 00:19:11,600
right so i use nist

569
00:19:11,600 --> 00:19:14,240
and specifically i use the identify

570
00:19:14,240 --> 00:19:16,320
detect and respond

571
00:19:16,320 --> 00:19:18,640
portions of nist

572
00:19:18,640 --> 00:19:21,440
i didn't go too deep i just wanted to be

573
00:19:21,440 --> 00:19:23,600
able to kind of label what i was doing

574
00:19:23,600 --> 00:19:25,440
into the different phases of where i was

575
00:19:25,440 --> 00:19:28,559
going where i was going with this

576
00:19:28,559 --> 00:19:30,559
so how do i use the mind map i primarily

577
00:19:30,559 --> 00:19:33,280
use it as a reference graph i graph a

578
00:19:33,280 --> 00:19:34,640
view of the requirements based on the

579
00:19:34,640 --> 00:19:36,720
three domains the asset identify

580
00:19:36,720 --> 00:19:38,880
specifically asset management detect and

581
00:19:38,880 --> 00:19:40,160
respond

582
00:19:40,160 --> 00:19:41,919
and like then i can quickly kind of like

583
00:19:41,919 --> 00:19:44,080
build this structure out to kind to

584
00:19:44,080 --> 00:19:45,919
understand where i'm going with with my

585
00:19:45,919 --> 00:19:47,440
thought process how i'm going to

586
00:19:47,440 --> 00:19:49,039
identify my threat actor and how i'm

587
00:19:49,039 --> 00:19:51,120
going to react to that threat actor

588
00:19:51,120 --> 00:19:52,960
and respond and take actions against

589
00:19:52,960 --> 00:19:56,160
that for actor and stop it

590
00:19:56,160 --> 00:19:58,559
so the first phase is basically identify

591
00:19:58,559 --> 00:19:59,919
my risk

592
00:19:59,919 --> 00:20:01,840
which i put in the center of my mind map

593
00:20:01,840 --> 00:20:04,720
so that's the start of my process

594
00:20:04,720 --> 00:20:07,200
i've described that risk maybe i've

595
00:20:07,200 --> 00:20:08,960
described it on a piece of paper locally

596
00:20:08,960 --> 00:20:10,720
or i've described it in you know on a

597
00:20:10,720 --> 00:20:13,120
whiteboard and i've come i've broken it

598
00:20:13,120 --> 00:20:15,360
down into the key components of what

599
00:20:15,360 --> 00:20:17,760
that risk is so if it's ransomware i'm

600
00:20:17,760 --> 00:20:19,840
going to have some kind of dropper that

601
00:20:19,840 --> 00:20:21,600
happens on the machine

602
00:20:21,600 --> 00:20:23,919
um i decide whether i'm going to go

603
00:20:23,919 --> 00:20:25,840
further up that chain and say oh was it

604
00:20:25,840 --> 00:20:28,159
a phishing email or not but typically

605
00:20:28,159 --> 00:20:29,919
what i found is that when i start to do

606
00:20:29,919 --> 00:20:31,919
that i think that phishing emails

607
00:20:31,919 --> 00:20:33,679
probably a different is also a threat in

608
00:20:33,679 --> 00:20:35,600
its own right because it can lead to

609
00:20:35,600 --> 00:20:37,840
different different types of of actions

610
00:20:37,840 --> 00:20:40,240
from the from the actor so i'll actually

611
00:20:40,240 --> 00:20:42,880
extract the fret and put it into the

612
00:20:42,880 --> 00:20:44,320
fishing fret and put it into a different

613
00:20:44,320 --> 00:20:46,840
mind map

614
00:20:46,840 --> 00:20:49,200
um then

615
00:20:49,200 --> 00:20:50,480
i needed a starting point so that's

616
00:20:50,480 --> 00:20:52,799
where i got my identifier my identify as

617
00:20:52,799 --> 00:20:54,480
a management my detect and respond

618
00:20:54,480 --> 00:20:56,640
bubbles so basically what this does is

619
00:20:56,640 --> 00:20:58,480
it breaks down the tree into into bite

620
00:20:58,480 --> 00:21:01,200
into bite size components

621
00:21:01,200 --> 00:21:02,880
okay so that's gonna work

622
00:21:02,880 --> 00:21:04,640
so this this would be at the start of my

623
00:21:04,640 --> 00:21:07,840
tree for the identifying and asset asset

624
00:21:07,840 --> 00:21:08,799
management

625
00:21:08,799 --> 00:21:11,360
so then i'm going to conceptualize this

626
00:21:11,360 --> 00:21:13,039
right so i'm going to put it put up one

627
00:21:13,039 --> 00:21:14,880
one layer higher

628
00:21:14,880 --> 00:21:16,960
so for asset management what i'm

629
00:21:16,960 --> 00:21:18,320
interested in

630
00:21:18,320 --> 00:21:21,280
is if i still stay on that aspect of the

631
00:21:21,280 --> 00:21:24,320
of of a ransomware i'm interested in the

632
00:21:24,320 --> 00:21:26,480
endpoints and i'm interested in network

633
00:21:26,480 --> 00:21:28,320
i'm potentially also interested in the

634
00:21:28,320 --> 00:21:32,080
people by people i mean of course users

635
00:21:32,080 --> 00:21:34,480
for the for the detect

636
00:21:34,480 --> 00:21:36,720
i'm interested in the type of tools that

637
00:21:36,720 --> 00:21:39,600
i can use to detect

638
00:21:41,360 --> 00:21:43,280
i can i'm interested in a telemetry that

639
00:21:43,280 --> 00:21:44,559
i'm going to gather to be able to create

640
00:21:44,559 --> 00:21:47,280
my detections for respond

641
00:21:47,280 --> 00:21:49,360
i'm going to think first how am i going

642
00:21:49,360 --> 00:21:51,280
to analyze this this alert or this

643
00:21:51,280 --> 00:21:52,480
detection

644
00:21:52,480 --> 00:21:54,320
what mitigations and remediations can i

645
00:21:54,320 --> 00:21:56,400
put into place to help me

646
00:21:56,400 --> 00:21:59,440
combat that to help me stop that alert

647
00:21:59,440 --> 00:22:01,520
and what tools do i have at my disposal

648
00:22:01,520 --> 00:22:03,679
and again by tools i'm very

649
00:22:03,679 --> 00:22:05,679
conceptualizing the type of tool not the

650
00:22:05,679 --> 00:22:08,559
actual product

651
00:22:09,200 --> 00:22:09,919
so

652
00:22:09,919 --> 00:22:13,039
i go down one level more so for network

653
00:22:13,039 --> 00:22:14,559
i need like to know understand ip

654
00:22:14,559 --> 00:22:16,640
assignments how do i understand which

655
00:22:16,640 --> 00:22:18,799
devices are in which network which

656
00:22:18,799 --> 00:22:21,600
subnet um where are they based

657
00:22:21,600 --> 00:22:24,640
for endpoints i potentially need a cmdb

658
00:22:24,640 --> 00:22:26,240
right configuration configuration

659
00:22:26,240 --> 00:22:27,600
management database

660
00:22:27,600 --> 00:22:29,760
so i can understand what type of device

661
00:22:29,760 --> 00:22:32,799
it is uh who's it who it's assigned to

662
00:22:32,799 --> 00:22:34,559
what operating system it's running on

663
00:22:34,559 --> 00:22:36,799
and things like that

664
00:22:36,799 --> 00:22:39,120
so for tools for the tools on you'll

665
00:22:39,120 --> 00:22:41,200
know for tools under detect you'll

666
00:22:41,200 --> 00:22:43,120
notice that i actually put tool one i

667
00:22:43,120 --> 00:22:45,360
just don't define it right now well i

668
00:22:45,360 --> 00:22:48,320
mean in the practical this might be uh

669
00:22:48,320 --> 00:22:50,880
endpoint protection it might be

670
00:22:50,880 --> 00:22:53,200
uh network detection might be something

671
00:22:53,200 --> 00:22:55,440
very abstract not a product

672
00:22:55,440 --> 00:22:57,280
for telemetry i'm going down the same

673
00:22:57,280 --> 00:22:59,440
thing i'm going endpoint

674
00:22:59,440 --> 00:23:01,039
i'm going network

675
00:23:01,039 --> 00:23:02,720
so those are the telemetry points that

676
00:23:02,720 --> 00:23:03,840
i'm interested in when i'm trying to

677
00:23:03,840 --> 00:23:06,240
detect my ransomware

678
00:23:06,240 --> 00:23:07,760
in the respond

679
00:23:07,760 --> 00:23:08,880
i'm of course i'm going to have the

680
00:23:08,880 --> 00:23:11,679
event data that i'm going to actually

681
00:23:11,679 --> 00:23:13,600
bring in from the detect phase so

682
00:23:13,600 --> 00:23:15,280
there's a correlation between detect and

683
00:23:15,280 --> 00:23:17,360
my response so i understand where i'm

684
00:23:17,360 --> 00:23:18,799
going with this

685
00:23:18,799 --> 00:23:21,280
and i also have correlation data so can

686
00:23:21,280 --> 00:23:23,600
i bring in indicators of compromise or

687
00:23:23,600 --> 00:23:26,480
in or other iocs from from reliable

688
00:23:26,480 --> 00:23:28,960
sources to be able to fine-tune that

689
00:23:28,960 --> 00:23:31,280
detection be able to tell me what's what

690
00:23:31,280 --> 00:23:33,919
it is what it actually is of course then

691
00:23:33,919 --> 00:23:36,240
we've got mitigation and remediation and

692
00:23:36,240 --> 00:23:38,799
there i'm talking about actions so do i

693
00:23:38,799 --> 00:23:41,360
kill the process do i

694
00:23:41,360 --> 00:23:43,200
isolate the endpoint things like that

695
00:23:43,200 --> 00:23:45,200
and then the tools would be the tools to

696
00:23:45,200 --> 00:23:47,039
be able to do that kind of stuff again

697
00:23:47,039 --> 00:23:50,799
very much abstracted

698
00:23:50,799 --> 00:23:54,000
so we keep going drilling down and

699
00:23:54,000 --> 00:23:56,240
what happens is you get to

700
00:23:56,240 --> 00:23:58,400
an example which is when i'm looking at

701
00:23:58,400 --> 00:24:00,480
this example is basically when i'm

702
00:24:00,480 --> 00:24:03,120
talking about detections and telemetry i

703
00:24:03,120 --> 00:24:04,880
have an endpoint and that's going to

704
00:24:04,880 --> 00:24:06,799
deliver different data points and i'll

705
00:24:06,799 --> 00:24:08,559
show you an example in a second data

706
00:24:08,559 --> 00:24:10,720
points and say and same thing for that

707
00:24:10,720 --> 00:24:12,720
for the network i have data points

708
00:24:12,720 --> 00:24:15,360
and then event data and i have data

709
00:24:15,360 --> 00:24:16,720
points again

710
00:24:16,720 --> 00:24:18,480
for the correlated data i have

711
00:24:18,480 --> 00:24:19,760
intelligence

712
00:24:19,760 --> 00:24:21,520
or i have internal

713
00:24:21,520 --> 00:24:23,919
so maybe i've already had a previous

714
00:24:23,919 --> 00:24:25,919
trigger like this so i can bring in

715
00:24:25,919 --> 00:24:27,520
those internal in that internal

716
00:24:27,520 --> 00:24:29,120
information from a previous trigger to

717
00:24:29,120 --> 00:24:32,400
correlate those alerts

718
00:24:32,400 --> 00:24:34,000
now you

719
00:24:34,000 --> 00:24:35,679
notice there's a dotted line here

720
00:24:35,679 --> 00:24:37,520
basically what i'm trying to associate

721
00:24:37,520 --> 00:24:39,200
here is i'm trying to say

722
00:24:39,200 --> 00:24:41,200
so tool one

723
00:24:41,200 --> 00:24:45,360
will provide data data aspect one

724
00:24:45,360 --> 00:24:47,440
because i could have multiple tools on

725
00:24:47,440 --> 00:24:49,120
an endpoint and they could provide more

726
00:24:49,120 --> 00:24:52,080
different types of data

727
00:24:52,159 --> 00:24:53,200
there's a there's a reason to the

728
00:24:53,200 --> 00:24:54,559
madness and you'll you'll see in a

729
00:24:54,559 --> 00:24:57,039
minute so this is one that i mapped out

730
00:24:57,039 --> 00:24:59,520
for a ransomware type attack might even

731
00:24:59,520 --> 00:25:00,799
abstract a little bit more and i just

732
00:25:00,799 --> 00:25:03,520
said what happens when i get a malware

733
00:25:03,520 --> 00:25:04,640
so

734
00:25:04,640 --> 00:25:05,919
this is really i'm sorry it's really

735
00:25:05,919 --> 00:25:08,159
hard to read it is massive and it's like

736
00:25:08,159 --> 00:25:09,840
but so like here's the endpoint

737
00:25:09,840 --> 00:25:12,480
definition so what domain is it in what

738
00:25:12,480 --> 00:25:14,640
ip does it have does it have an edr

739
00:25:14,640 --> 00:25:16,080
sensor id

740
00:25:16,080 --> 00:25:18,080
does it have a mac what's the mac

741
00:25:18,080 --> 00:25:19,120
address

742
00:25:19,120 --> 00:25:21,120
sometimes it has multiple macs that's

743
00:25:21,120 --> 00:25:23,679
fun does it have a location so do i know

744
00:25:23,679 --> 00:25:25,919
if it's in an office which office which

745
00:25:25,919 --> 00:25:28,000
floor does it have an asset tag does it

746
00:25:28,000 --> 00:25:30,240
has a host what's the host name

747
00:25:30,240 --> 00:25:32,240
what's the purpose

748
00:25:32,240 --> 00:25:35,039
is it a build machine is it a user

749
00:25:35,039 --> 00:25:38,080
machine is it a developer machine

750
00:25:38,080 --> 00:25:40,640
what install time who's it owned by what

751
00:25:40,640 --> 00:25:43,760
os does it have versions and patches

752
00:25:43,760 --> 00:25:45,679
and we drill down and we can drill down

753
00:25:45,679 --> 00:25:47,120
into that

754
00:25:47,120 --> 00:25:48,320
and you'll notice that there's some

755
00:25:48,320 --> 00:25:50,880
lines here so the ip is actually coming

756
00:25:50,880 --> 00:25:52,960
from the network asset

757
00:25:52,960 --> 00:25:55,520
configuration information that i have

758
00:25:55,520 --> 00:25:57,200
and in the network i have a set of

759
00:25:57,200 --> 00:25:59,279
ranges and those ranges might have

760
00:25:59,279 --> 00:26:01,360
owners because you know they could be

761
00:26:01,360 --> 00:26:05,039
um for example ip ranges in aws

762
00:26:05,039 --> 00:26:06,640
and i don't know how you guys structure

763
00:26:06,640 --> 00:26:08,720
your aws but a lot of organizations i've

764
00:26:08,720 --> 00:26:10,720
worked with in the past and

765
00:26:10,720 --> 00:26:11,679
use

766
00:26:11,679 --> 00:26:13,520
assign different owners with different

767
00:26:13,520 --> 00:26:15,919
organizations in aws to kind of manage

768
00:26:15,919 --> 00:26:17,440
billing to kind of understand who's

769
00:26:17,440 --> 00:26:19,120
who's running what when you have

770
00:26:19,120 --> 00:26:20,480
networks and segment names you might

771
00:26:20,480 --> 00:26:22,720
have a topology as well

772
00:26:22,720 --> 00:26:24,480
if it's an office so it might be hub and

773
00:26:24,480 --> 00:26:26,480
spoke and things like that

774
00:26:26,480 --> 00:26:28,240
when we get to the detect

775
00:26:28,240 --> 00:26:30,480
so then i have my telemetry i have my

776
00:26:30,480 --> 00:26:32,400
endpoint my process information that's

777
00:26:32,400 --> 00:26:34,720
important for me i have my username i

778
00:26:34,720 --> 00:26:36,720
have my file detection you know file

779
00:26:36,720 --> 00:26:40,159
detection is a subset of the pros

780
00:26:40,159 --> 00:26:41,840
process info

781
00:26:41,840 --> 00:26:43,919
that's how it you've got command line

782
00:26:43,919 --> 00:26:45,600
arguments so this is what i'm basically

783
00:26:45,600 --> 00:26:47,600
doing i'm breaking it down into the

784
00:26:47,600 --> 00:26:49,520
minimal basic information the data

785
00:26:49,520 --> 00:26:51,440
points i'm not breaking it down into

786
00:26:51,440 --> 00:26:52,960
something but

787
00:26:52,960 --> 00:26:55,520
um but a vendor tells me what i need

788
00:26:55,520 --> 00:26:58,159
right i what i i figured

789
00:26:58,159 --> 00:26:59,760
if you want to detect these things you

790
00:26:59,760 --> 00:27:00,799
should be able to break down the

791
00:27:00,799 --> 00:27:02,640
information that you need and see

792
00:27:02,640 --> 00:27:04,240
there's a lot of dotted lines most of

793
00:27:04,240 --> 00:27:07,679
these dotted lines are things links too

794
00:27:07,679 --> 00:27:10,000
right so this

795
00:27:10,000 --> 00:27:12,640
context username the username links back

796
00:27:12,640 --> 00:27:14,480
to the user

797
00:27:14,480 --> 00:27:17,679
in the asset management

798
00:27:17,679 --> 00:27:22,000
so this gets very complex the the

799
00:27:22,000 --> 00:27:24,399
the mind map can get very big

800
00:27:24,399 --> 00:27:26,720
it's one of my biggest ones actually i

801
00:27:26,720 --> 00:27:28,559
really drill down it i really drill down

802
00:27:28,559 --> 00:27:30,480
into it to kind of understand what i

803
00:27:30,480 --> 00:27:32,320
need what i could detect and how i could

804
00:27:32,320 --> 00:27:34,880
detect i also drilled down

805
00:27:34,880 --> 00:27:36,799
into how i could respond this is the

806
00:27:36,799 --> 00:27:38,720
event data that i had you notice that

807
00:27:38,720 --> 00:27:40,559
the event data actually comes from my

808
00:27:40,559 --> 00:27:41,919
telemetry

809
00:27:41,919 --> 00:27:44,000
then i have the process info so i've got

810
00:27:44,000 --> 00:27:45,760
all this information

811
00:27:45,760 --> 00:27:47,600
i can also pull additional hashes

812
00:27:47,600 --> 00:27:49,840
additional ip addresses by marrying it

813
00:27:49,840 --> 00:27:52,320
with other tools

814
00:27:52,320 --> 00:27:54,240
i've got the event data here so i've got

815
00:27:54,240 --> 00:27:56,480
network that's coming from the networks

816
00:27:56,480 --> 00:27:59,120
i've got source ports i've got

817
00:27:59,120 --> 00:28:02,320
destination ports

818
00:28:02,320 --> 00:28:03,200
and

819
00:28:03,200 --> 00:28:05,120
i've also got coverage here so coverage

820
00:28:05,120 --> 00:28:06,320
is basically

821
00:28:06,320 --> 00:28:08,240
where am i getting my information from

822
00:28:08,240 --> 00:28:09,840
or how can i ensure that i'm getting the

823
00:28:09,840 --> 00:28:11,520
right information

824
00:28:11,520 --> 00:28:13,520
and where where do i expect to store it

825
00:28:13,520 --> 00:28:16,240
so i when i'm responding i know where to

826
00:28:16,240 --> 00:28:18,559
go find it

827
00:28:18,559 --> 00:28:21,279
so once that's done

828
00:28:21,279 --> 00:28:22,880
a mind map really isn't useful to

829
00:28:22,880 --> 00:28:25,039
actually do anything

830
00:28:25,039 --> 00:28:26,799
practical with it

831
00:28:26,799 --> 00:28:29,039
to build a detection or to look at what

832
00:28:29,039 --> 00:28:31,120
kind of tool i want to i want to i want

833
00:28:31,120 --> 00:28:33,120
to use in the end

834
00:28:33,120 --> 00:28:35,840
so i built a reference sheet

835
00:28:35,840 --> 00:28:38,080
this was something that i need to

836
00:28:38,080 --> 00:28:40,000
automate and i still need to automate

837
00:28:40,000 --> 00:28:41,919
but that means request is going to

838
00:28:41,919 --> 00:28:43,200
require a lot of effort because i'm

839
00:28:43,200 --> 00:28:44,799
basically going to have to take a mind

840
00:28:44,799 --> 00:28:47,520
map out of visio or out of

841
00:28:47,520 --> 00:28:49,120
lucid charts

842
00:28:49,120 --> 00:28:51,120
and then kind of find all the data

843
00:28:51,120 --> 00:28:53,039
points and then bring them into a

844
00:28:53,039 --> 00:28:54,640
spreadsheet

845
00:28:54,640 --> 00:28:55,679
yes

846
00:28:55,679 --> 00:28:57,840
i'm a security engineer and i love to

847
00:28:57,840 --> 00:28:59,600
bring and i started making big

848
00:28:59,600 --> 00:29:00,799
spreadsheets

849
00:29:00,799 --> 00:29:04,080
there's no failure in that

850
00:29:05,120 --> 00:29:08,399
and then we complain about finance um

851
00:29:08,399 --> 00:29:11,120
requirements is the ref is basically the

852
00:29:11,120 --> 00:29:12,559
requirements becomes

853
00:29:12,559 --> 00:29:14,480
the reference manual right so this

854
00:29:14,480 --> 00:29:17,360
reference sheet is going to um

855
00:29:17,360 --> 00:29:18,880
essentially

856
00:29:18,880 --> 00:29:20,720
list out all of my uh all of my

857
00:29:20,720 --> 00:29:22,640
requirements based on the mind map

858
00:29:22,640 --> 00:29:24,080
i inventory all the data points that

859
00:29:24,080 --> 00:29:26,640
i've put into my mind map and those kind

860
00:29:26,640 --> 00:29:27,600
of

861
00:29:27,600 --> 00:29:30,000
become my assignments for fret risk

862
00:29:30,000 --> 00:29:31,919
solutions mapping

863
00:29:31,919 --> 00:29:33,760
it helps identify what data points needs

864
00:29:33,760 --> 00:29:36,399
a difference it helps me identify the

865
00:29:36,399 --> 00:29:38,000
data points at different stages but it

866
00:29:38,000 --> 00:29:40,320
also helps me kind of see okay so i have

867
00:29:40,320 --> 00:29:41,760
all these data points where am i getting

868
00:29:41,760 --> 00:29:43,520
them from where am i actually getting

869
00:29:43,520 --> 00:29:45,360
them from so what tools do i currently

870
00:29:45,360 --> 00:29:47,520
have deployed in my environment are they

871
00:29:47,520 --> 00:29:49,919
actually giving me that information

872
00:29:49,919 --> 00:29:51,919
and if i can't find a tool that gives me

873
00:29:51,919 --> 00:29:53,919
that information i basically identified

874
00:29:53,919 --> 00:29:55,200
a gap

875
00:29:55,200 --> 00:29:56,559
and that's what was important to me i

876
00:29:56,559 --> 00:29:58,559
wanted to understand

877
00:29:58,559 --> 00:30:00,240
where i was failing in terms of

878
00:30:00,240 --> 00:30:02,159
detections where what information was

879
00:30:02,159 --> 00:30:04,000
missing for me to be able to detect the

880
00:30:04,000 --> 00:30:06,559
next best actor

881
00:30:06,559 --> 00:30:08,559
it also provides a

882
00:30:08,559 --> 00:30:10,559
it's actually provided me with the

883
00:30:10,559 --> 00:30:13,200
ability to build a requirements sheet

884
00:30:13,200 --> 00:30:14,240
for

885
00:30:14,240 --> 00:30:16,080
selecting new products

886
00:30:16,080 --> 00:30:18,320
for like selecting new tools or for

887
00:30:18,320 --> 00:30:21,360
defining and building a new solution

888
00:30:21,360 --> 00:30:23,679
right so if i wanted to actually define

889
00:30:23,679 --> 00:30:25,200
a solution that i wanted to build i

890
00:30:25,200 --> 00:30:27,200
could come i can come back to this and

891
00:30:27,200 --> 00:30:28,399
look at all the things that i need to

892
00:30:28,399 --> 00:30:30,799
put into that solution

893
00:30:30,799 --> 00:30:33,200
and the design state that i wanted was

894
00:30:33,200 --> 00:30:35,919
to have it to have a gap analysis of my

895
00:30:35,919 --> 00:30:38,720
capabilities

896
00:30:38,720 --> 00:30:41,840
so how do i do this well like i said i

897
00:30:41,840 --> 00:30:44,720
basically build a spreadsheet

898
00:30:44,720 --> 00:30:47,360
so in that spreadsheet i break down my

899
00:30:47,360 --> 00:30:49,679
mind map i start to

900
00:30:49,679 --> 00:30:51,679
list all the things in the mind map

901
00:30:51,679 --> 00:30:55,679
you'll notice in some places i have a

902
00:30:56,000 --> 00:30:58,399
privileges like here it says privileges

903
00:30:58,399 --> 00:31:01,039
one dot dash m so anybody who's done any

904
00:31:01,039 --> 00:31:02,640
database net architecture knows that

905
00:31:02,640 --> 00:31:03,919
that basically means you have a

906
00:31:03,919 --> 00:31:06,159
relationship of one to many so a user

907
00:31:06,159 --> 00:31:08,000
can have

908
00:31:08,000 --> 00:31:11,519
one user can have many privileges

909
00:31:11,519 --> 00:31:12,720
so you

910
00:31:12,720 --> 00:31:14,399
i'm boiling this down

911
00:31:14,399 --> 00:31:15,360
and i'm

912
00:31:15,360 --> 00:31:16,840
listing this

913
00:31:16,840 --> 00:31:20,480
out so then i have a provided by column

914
00:31:20,480 --> 00:31:23,279
and again that can be at one to many so

915
00:31:23,279 --> 00:31:26,159
these data elements can be provided by

916
00:31:26,159 --> 00:31:28,240
the tools where i have in place

917
00:31:28,240 --> 00:31:29,519
so this tells me the information where

918
00:31:29,519 --> 00:31:31,279
the information comes from or can come

919
00:31:31,279 --> 00:31:33,519
from if i have that tool in place does

920
00:31:33,519 --> 00:31:35,600
it provide that information does it come

921
00:31:35,600 --> 00:31:37,760
from an application

922
00:31:37,760 --> 00:31:41,039
it also it also allows me to populate

923
00:31:41,039 --> 00:31:44,240
which tools i kind of i i have or i

924
00:31:44,240 --> 00:31:46,080
don't have access to because there might

925
00:31:46,080 --> 00:31:47,519
be tools that i don't have access to but

926
00:31:47,519 --> 00:31:50,240
can provide me with this information

927
00:31:50,240 --> 00:31:52,159
and the data can as i said earlier the

928
00:31:52,159 --> 00:31:54,799
data can come from multiple sources

929
00:31:54,799 --> 00:31:57,360
the use by field is actually

930
00:31:57,360 --> 00:31:58,799
tells me

931
00:31:58,799 --> 00:32:01,919
am i using this data point already like

932
00:32:01,919 --> 00:32:04,080
i have a playbook am i using that data

933
00:32:04,080 --> 00:32:05,840
point in my playbook i have an insert

934
00:32:05,840 --> 00:32:08,080
respon i have an incident template i

935
00:32:08,080 --> 00:32:10,640
have an instant layout for my ticket am

936
00:32:10,640 --> 00:32:12,799
i actually using those data points in

937
00:32:12,799 --> 00:32:15,840
the incident ticket

938
00:32:15,919 --> 00:32:18,080
i'm doing some forensics work

939
00:32:18,080 --> 00:32:19,600
am i pulling all the information that i

940
00:32:19,600 --> 00:32:20,880
need from that forensic work of the

941
00:32:20,880 --> 00:32:22,559
tools that i'm using pulling all that

942
00:32:22,559 --> 00:32:24,640
information and again the data can be in

943
00:32:24,640 --> 00:32:27,039
multiple places i could have a ticket

944
00:32:27,039 --> 00:32:28,880
but i can also have a response tool that

945
00:32:28,880 --> 00:32:30,559
needs that data to be that needs that

946
00:32:30,559 --> 00:32:33,760
data point to be used

947
00:32:34,399 --> 00:32:36,799
so then name and path is provided in

948
00:32:36,799 --> 00:32:38,880
this example we see that the process

949
00:32:38,880 --> 00:32:43,159
information the process info

950
00:32:43,200 --> 00:32:45,120
trying to get this way so the process

951
00:32:45,120 --> 00:32:47,919
info here we have name path pid command

952
00:32:47,919 --> 00:32:49,519
line arguments

953
00:32:49,519 --> 00:32:51,600
and this is basically telling us that

954
00:32:51,600 --> 00:32:54,320
it's provided by epp so endpoint

955
00:32:54,320 --> 00:32:56,640
protection edr

956
00:32:56,640 --> 00:32:57,919
so i

957
00:32:57,919 --> 00:33:00,640
i did basically i mean this would be

958
00:33:00,640 --> 00:33:02,080
like carbon black if you had called

959
00:33:02,080 --> 00:33:03,519
black sentinel one if you had something

960
00:33:03,519 --> 00:33:05,120
one as an edr

961
00:33:05,120 --> 00:33:07,120
um used by and you'll see that the

962
00:33:07,120 --> 00:33:09,440
process info here process name is used

963
00:33:09,440 --> 00:33:12,320
by my epp but it's also used by my sim

964
00:33:12,320 --> 00:33:14,480
alert

965
00:33:14,480 --> 00:33:16,480
so the file hashes are used by both as

966
00:33:16,480 --> 00:33:17,279
well

967
00:33:17,279 --> 00:33:19,039
now you notice under the fire hashes

968
00:33:19,039 --> 00:33:21,519
that's basic it's blank and it is

969
00:33:21,519 --> 00:33:23,600
supposed to be blank and my example here

970
00:33:23,600 --> 00:33:26,159
is that basically it where i'm not using

971
00:33:26,159 --> 00:33:27,760
that information from my edr is

972
00:33:27,760 --> 00:33:29,360
providing me

973
00:33:29,360 --> 00:33:30,720
now

974
00:33:30,720 --> 00:33:32,480
why am i not using it

975
00:33:32,480 --> 00:33:34,480
couldn't it be useful

976
00:33:34,480 --> 00:33:36,799
like the command line argument i'm not

977
00:33:36,799 --> 00:33:38,799
using it in my playbook let me be

978
00:33:38,799 --> 00:33:41,440
precise the command line arguments could

979
00:33:41,440 --> 00:33:43,279
be very useful in my playbook think

980
00:33:43,279 --> 00:33:45,519
about a powershell or a spawn of a

981
00:33:45,519 --> 00:33:47,360
process from a cmd to a powershell that

982
00:33:47,360 --> 00:33:49,519
has a hash in it

983
00:33:49,519 --> 00:33:51,120
why am i not pulling that back into my

984
00:33:51,120 --> 00:33:52,640
ticket

985
00:33:52,640 --> 00:33:54,000
because at some point in time i'm going

986
00:33:54,000 --> 00:33:56,880
to need to analyze that hash

987
00:33:56,880 --> 00:33:58,880
so in my playbook i've already found the

988
00:33:58,880 --> 00:34:00,240
gap i've already found something that's

989
00:34:00,240 --> 00:34:03,760
not working for me right

990
00:34:04,640 --> 00:34:06,799
and this is this is more complete

991
00:34:06,799 --> 00:34:09,679
version done

992
00:34:10,639 --> 00:34:12,320
so you see i've got all the like this

993
00:34:12,320 --> 00:34:14,480
one is the identification part so the

994
00:34:14,480 --> 00:34:17,040
identify all the different assets that i

995
00:34:17,040 --> 00:34:19,040
have

996
00:34:19,040 --> 00:34:21,679
this is the process this is the detect

997
00:34:21,679 --> 00:34:24,320
element so here i'm detecting so i have

998
00:34:24,320 --> 00:34:26,960
all the i have all of my provided buys

999
00:34:26,960 --> 00:34:29,199
so in this in this example i have carbon

1000
00:34:29,199 --> 00:34:30,480
black providing me information i have

1001
00:34:30,480 --> 00:34:32,480
jam protect providing me information i

1002
00:34:32,480 --> 00:34:35,839
have defender i win log b

1003
00:34:35,839 --> 00:34:38,239
the idea here is that

1004
00:34:38,239 --> 00:34:39,839
the reason i have multiple tools is

1005
00:34:39,839 --> 00:34:41,040
because i have multiple different

1006
00:34:41,040 --> 00:34:42,639
platforms and i'm getting the

1007
00:34:42,639 --> 00:34:43,918
information from multiple different

1008
00:34:43,918 --> 00:34:45,199
environments

1009
00:34:45,199 --> 00:34:47,119
but the information is still

1010
00:34:47,119 --> 00:34:48,639
from an incident response point of view

1011
00:34:48,639 --> 00:34:49,918
from a detection engineering point of

1012
00:34:49,918 --> 00:34:52,800
view it's still the same information

1013
00:34:52,800 --> 00:34:54,480
and that's that's another thing kind of

1014
00:34:54,480 --> 00:34:57,040
side benefit that i got out of this

1015
00:34:57,040 --> 00:34:59,119
is but basically

1016
00:34:59,119 --> 00:35:02,800
i was able to create metadata elements

1017
00:35:02,800 --> 00:35:04,800
from all the detections so if you've

1018
00:35:04,800 --> 00:35:06,720
ever had to you know if you're a splunk

1019
00:35:06,720 --> 00:35:08,800
user you're probably lucky because you

1020
00:35:08,800 --> 00:35:11,200
can basically throw any logs at it and

1021
00:35:11,200 --> 00:35:12,800
it basically figures out what fields are

1022
00:35:12,800 --> 00:35:14,720
in the or in the log

1023
00:35:14,720 --> 00:35:16,800
if you're using elastic you probably

1024
00:35:16,800 --> 00:35:19,119
spend a few years trying to figure out

1025
00:35:19,119 --> 00:35:21,119
the mappings into ecs if there isn't one

1026
00:35:21,119 --> 00:35:22,640
already

1027
00:35:22,640 --> 00:35:25,119
sorry elastic

1028
00:35:25,119 --> 00:35:27,119
but that's the hard truth

1029
00:35:27,119 --> 00:35:28,240
but i know they're getting better with

1030
00:35:28,240 --> 00:35:30,000
this um i've been talking to them about

1031
00:35:30,000 --> 00:35:31,200
it so they

1032
00:35:31,200 --> 00:35:33,599
you know it will get better i'm sure

1033
00:35:33,599 --> 00:35:35,200
the problem is

1034
00:35:35,200 --> 00:35:38,160
i still only want one data point name

1035
00:35:38,160 --> 00:35:39,680
right i don't want to have to deal with

1036
00:35:39,680 --> 00:35:42,160
multiple data point names i also blame

1037
00:35:42,160 --> 00:35:43,680
the other vendors because they basically

1038
00:35:43,680 --> 00:35:45,839
create data port they create for exports

1039
00:35:45,839 --> 00:35:48,800
of their logs with varying their own

1040
00:35:48,800 --> 00:35:50,640
vision of what

1041
00:35:50,640 --> 00:35:53,920
a data point should be called

1042
00:35:54,160 --> 00:35:55,040
so

1043
00:35:55,040 --> 00:35:56,720
that was the side benefit of that i just

1044
00:35:56,720 --> 00:35:58,560
wanted to kind of put that in there is

1045
00:35:58,560 --> 00:36:00,320
that i now had a mapping of all the

1046
00:36:00,320 --> 00:36:01,040
different

1047
00:36:01,040 --> 00:36:02,800
elements and i could actually identify

1048
00:36:02,800 --> 00:36:04,560
if i had a name for if all of my

1049
00:36:04,560 --> 00:36:06,079
products are providing me with a process

1050
00:36:06,079 --> 00:36:07,920
name

1051
00:36:07,920 --> 00:36:10,240
or or a path or a pid or command line i

1052
00:36:10,240 --> 00:36:13,200
don't given

1053
00:36:13,200 --> 00:36:15,280
sorry i wanted to say something so if

1054
00:36:15,280 --> 00:36:16,800
you look at this in this mapping what we

1055
00:36:16,800 --> 00:36:17,680
did

1056
00:36:17,680 --> 00:36:20,400
basically you'll notice that

1057
00:36:20,400 --> 00:36:22,000
i'm pretty

1058
00:36:22,000 --> 00:36:23,760
good on my use by

1059
00:36:23,760 --> 00:36:25,839
except most of my fields are only being

1060
00:36:25,839 --> 00:36:28,800
used by my my sim

1061
00:36:28,800 --> 00:36:31,359
that's good it's generating my alerts

1062
00:36:31,359 --> 00:36:35,200
but why am i not using them in my

1063
00:36:35,200 --> 00:36:37,040
store engine why am i not using them in

1064
00:36:37,040 --> 00:36:38,560
my playbooks

1065
00:36:38,560 --> 00:36:40,720
right and this was just an example of

1066
00:36:40,720 --> 00:36:42,560
the for this particular threat that we

1067
00:36:42,560 --> 00:36:44,240
were mapping we hadn't actually

1068
00:36:44,240 --> 00:36:46,720
completed the whole process in building

1069
00:36:46,720 --> 00:36:49,200
the playbooks to do to use the data

1070
00:36:49,200 --> 00:36:52,160
right so it also provided me with a way

1071
00:36:52,160 --> 00:36:53,599
to kind of track the progress of where

1072
00:36:53,599 --> 00:36:55,520
we were into building our into building

1073
00:36:55,520 --> 00:36:58,160
our playbook

1074
00:36:59,200 --> 00:37:01,359
so this was really cool so now i'm

1075
00:37:01,359 --> 00:37:02,720
understanding the organize my

1076
00:37:02,720 --> 00:37:04,560
organization's capabilities in terms of

1077
00:37:04,560 --> 00:37:07,040
how what things i can detect what things

1078
00:37:07,040 --> 00:37:08,720
information what i have when i do those

1079
00:37:08,720 --> 00:37:10,880
detections what information i have and

1080
00:37:10,880 --> 00:37:12,480
what capabilities i have

1081
00:37:12,480 --> 00:37:13,680
when

1082
00:37:13,680 --> 00:37:16,160
i'm able to

1083
00:37:16,160 --> 00:37:18,640
respond

1084
00:37:19,920 --> 00:37:22,960
it's also allowing me to make better

1085
00:37:22,960 --> 00:37:25,200
decisions on what tooling and how to use

1086
00:37:25,200 --> 00:37:26,400
my tooling

1087
00:37:26,400 --> 00:37:28,079
or tooling i want to get and what how to

1088
00:37:28,079 --> 00:37:29,839
use my tooling

1089
00:37:29,839 --> 00:37:32,160
um to give an example

1090
00:37:32,160 --> 00:37:34,839
when we were reevaluating uh

1091
00:37:34,839 --> 00:37:39,119
our mac protection system systems

1092
00:37:39,119 --> 00:37:40,560
we looked at the different products out

1093
00:37:40,560 --> 00:37:41,839
there

1094
00:37:41,839 --> 00:37:44,720
and we picked in the end jam protect for

1095
00:37:44,720 --> 00:37:46,560
this particular scenario because it was

1096
00:37:46,560 --> 00:37:48,640
providing the best possible coverage of

1097
00:37:48,640 --> 00:37:51,839
information that we needed

1098
00:37:52,240 --> 00:37:54,800
and finally

1099
00:37:54,800 --> 00:37:56,880
it's actually given me a framework to

1100
00:37:56,880 --> 00:37:58,880
poc new tools

1101
00:37:58,880 --> 00:38:01,040
so when i'm bringing in a new tool

1102
00:38:01,040 --> 00:38:03,200
i can now use these maps these

1103
00:38:03,200 --> 00:38:04,800
capabilities that i mapped out and said

1104
00:38:04,800 --> 00:38:07,359
look at them and look hey cool

1105
00:38:07,359 --> 00:38:09,040
does this tool match this this this this

1106
00:38:09,040 --> 00:38:11,040
and that how much does it match can i

1107
00:38:11,040 --> 00:38:12,640
get the information from another tool so

1108
00:38:12,640 --> 00:38:14,880
will it marry properly into my into my

1109
00:38:14,880 --> 00:38:17,119
tool set and into my solution into the

1110
00:38:17,119 --> 00:38:20,160
solution that i want to build

1111
00:38:20,400 --> 00:38:22,240
and that's actually it so we're we've

1112
00:38:22,240 --> 00:38:24,320
got time for questions

1113
00:38:24,320 --> 00:38:25,760
and i'm sorry again i'm sorry if it's a

1114
00:38:25,760 --> 00:38:26,800
little bit

1115
00:38:26,800 --> 00:38:28,960
convoluted i completely misplanned this

1116
00:38:28,960 --> 00:38:31,040
whole week

1117
00:38:31,040 --> 00:38:34,079
which is night hey

1118
00:38:38,880 --> 00:38:40,880
so the question is how much time

1119
00:38:40,880 --> 00:38:43,040
did i spend creating the big mind map

1120
00:38:43,040 --> 00:38:44,560
that i created

1121
00:38:44,560 --> 00:38:47,839
so i didn't create it

1122
00:38:48,160 --> 00:38:49,280
the team

1123
00:38:49,280 --> 00:38:51,359
created it right because

1124
00:38:51,359 --> 00:38:52,880
there is no one source of information

1125
00:38:52,880 --> 00:38:54,160
every you know it's like if you've got a

1126
00:38:54,160 --> 00:38:55,839
good team they all have good ideas they

1127
00:38:55,839 --> 00:38:57,920
all have they're all able to work you're

1128
00:38:57,920 --> 00:39:00,240
gonna want to work together because at

1129
00:39:00,240 --> 00:39:01,520
the end of the day the team is the one

1130
00:39:01,520 --> 00:39:03,839
that's going to want to kind of hold on

1131
00:39:03,839 --> 00:39:06,160
a second

1132
00:39:07,599 --> 00:39:08,960
the team is going to want is the one

1133
00:39:08,960 --> 00:39:09,920
that's going to understand those

1134
00:39:09,920 --> 00:39:11,920
detections that you can make it's also

1135
00:39:11,920 --> 00:39:15,839
the one that's going to want to respond

1136
00:39:16,480 --> 00:39:18,160
to be more specific

1137
00:39:18,160 --> 00:39:21,839
it took us um because

1138
00:39:21,839 --> 00:39:24,000
we work remotely and plus we work in

1139
00:39:24,000 --> 00:39:25,760
different time zones

1140
00:39:25,760 --> 00:39:29,839
we did four

1141
00:39:29,839 --> 00:39:32,640
two hour sessions

1142
00:39:34,640 --> 00:39:36,079
the harder piece of work was taking the

1143
00:39:36,079 --> 00:39:37,680
data put it put taking the my map and

1144
00:39:37,680 --> 00:39:40,320
putting it into the spreadsheet

1145
00:39:40,320 --> 00:39:41,520
that's why i need to find a way to

1146
00:39:41,520 --> 00:39:43,440
automate it because

1147
00:39:43,440 --> 00:39:44,960
to be honest

1148
00:39:44,960 --> 00:39:46,800
it's not gonna work long term it's not

1149
00:39:46,800 --> 00:39:48,240
gonna work if i because as soon as you

1150
00:39:48,240 --> 00:39:49,440
make a change you have to go back and

1151
00:39:49,440 --> 00:39:51,280
look at the in the um in the spreadsheet

1152
00:39:51,280 --> 00:39:55,880
and change that spreadsheet as well

1153
00:39:59,200 --> 00:39:59,920
well

1154
00:39:59,920 --> 00:40:01,760
i think i'll give you the mic just

1155
00:40:01,760 --> 00:40:04,079
thanks no pressure so um i have a

1156
00:40:04,079 --> 00:40:05,440
question hopefully i can get this out

1157
00:40:05,440 --> 00:40:07,280
right so when i look at the mind map it

1158
00:40:07,280 --> 00:40:09,359
was fantastic and that you can clearly

1159
00:40:09,359 --> 00:40:11,280
see the process the decision the action

1160
00:40:11,280 --> 00:40:13,280
the source the data point yeah i looked

1161
00:40:13,280 --> 00:40:14,880
at that and thought oh great and i can

1162
00:40:14,880 --> 00:40:16,800
put the application id here the control

1163
00:40:16,800 --> 00:40:18,560
point here and so on but i kind of

1164
00:40:18,560 --> 00:40:20,000
realized geez you're getting into an

1165
00:40:20,000 --> 00:40:22,319
awful lot of work in this and while it's

1166
00:40:22,319 --> 00:40:24,880
very useful for me personally to do um

1167
00:40:24,880 --> 00:40:27,119
i'm not sure i'd take that full document

1168
00:40:27,119 --> 00:40:29,200
through to my stakeholders for example i

1169
00:40:29,200 --> 00:40:30,720
was kind of curious once you have it

1170
00:40:30,720 --> 00:40:32,960
done for the kind of takeaways

1171
00:40:32,960 --> 00:40:34,720
what are you bringing out to the other

1172
00:40:34,720 --> 00:40:36,079
teams to say right you wouldn't

1173
00:40:36,079 --> 00:40:37,680
necessarily show them the map might not

1174
00:40:37,680 --> 00:40:39,280
show up in a spreadsheet

1175
00:40:39,280 --> 00:40:40,720
is it the gap analysis that comes out

1176
00:40:40,720 --> 00:40:42,160
that says look here's our gaps this is

1177
00:40:42,160 --> 00:40:44,240
what we've got and we have the sitting

1178
00:40:44,240 --> 00:40:46,240
behind is that how it works yeah they

1179
00:40:46,240 --> 00:40:48,800
said yeah you you hit that on the nose

1180
00:40:48,800 --> 00:40:52,319
so i didn't um

1181
00:40:52,319 --> 00:40:54,079
whole presentation is a work in progress

1182
00:40:54,079 --> 00:40:55,760
because the process isn't working in

1183
00:40:55,760 --> 00:40:58,160
progress right but yeah the goal the

1184
00:40:58,160 --> 00:41:00,160
goal from the management point of view

1185
00:41:00,160 --> 00:41:02,240
is to build a gap analysis the goal from

1186
00:41:02,240 --> 00:41:03,440
the management point of view is to

1187
00:41:03,440 --> 00:41:05,359
basically say hey guys

1188
00:41:05,359 --> 00:41:06,800
we're missing this

1189
00:41:06,800 --> 00:41:09,119
this is a potential risk for us because

1190
00:41:09,119 --> 00:41:10,720
we can't cover we can't cover the

1191
00:41:10,720 --> 00:41:13,520
variance of ransomware of our concern to

1192
00:41:13,520 --> 00:41:14,319
us

1193
00:41:14,319 --> 00:41:15,839
it's like we need to

1194
00:41:15,839 --> 00:41:18,240
rework this so i need to assign a team

1195
00:41:18,240 --> 00:41:19,680
to basically do some new detection

1196
00:41:19,680 --> 00:41:20,480
engineering

1197
00:41:20,480 --> 00:41:22,480
it justify it kind of helps me justify

1198
00:41:22,480 --> 00:41:24,160
the work that we need to do

1199
00:41:24,160 --> 00:41:27,440
um it also helps me go back say to

1200
00:41:27,440 --> 00:41:28,319
to

1201
00:41:28,319 --> 00:41:29,920
one of the other teams

1202
00:41:29,920 --> 00:41:31,760
so like one of the things that i've been

1203
00:41:31,760 --> 00:41:33,599
working with closely is our privacy team

1204
00:41:33,599 --> 00:41:35,599
trying to understand

1205
00:41:35,599 --> 00:41:37,680
what do we do about

1206
00:41:37,680 --> 00:41:40,240
privacy and edr tools

1207
00:41:40,240 --> 00:41:42,319
yeah right

1208
00:41:42,319 --> 00:41:44,160
so there we basically identify all the

1209
00:41:44,160 --> 00:41:46,160
data points that we want and privacy is

1210
00:41:46,160 --> 00:41:48,319
like no you can't use that one kind of

1211
00:41:48,319 --> 00:41:50,480
thing right

1212
00:41:50,480 --> 00:41:53,599
but it's it's useful and the thing is

1213
00:41:53,599 --> 00:41:55,839
it's like again this is um

1214
00:41:55,839 --> 00:41:56,880
and i

1215
00:41:56,880 --> 00:41:58,800
i've got to kind of emphasize at the

1216
00:41:58,800 --> 00:42:00,720
beginning i

1217
00:42:00,720 --> 00:42:02,240
don't want to push anything on to you

1218
00:42:02,240 --> 00:42:04,160
this is to help you kind of look at

1219
00:42:04,160 --> 00:42:06,319
things differently differently and think

1220
00:42:06,319 --> 00:42:08,319
from the bottom up instead of the

1221
00:42:08,319 --> 00:42:10,400
product down kind of position right

1222
00:42:10,400 --> 00:42:12,079
because you know i'm going to go okay

1223
00:42:12,079 --> 00:42:14,319
we're out of time but

1224
00:42:14,319 --> 00:42:15,920
vendors tend to tell you oh i've got

1225
00:42:15,920 --> 00:42:17,920
this fantastic solution for you if a

1226
00:42:17,920 --> 00:42:19,599
vendor tells you that kick him out of

1227
00:42:19,599 --> 00:42:21,359
kick him out of the room because a

1228
00:42:21,359 --> 00:42:23,280
vendor cannot build a solution for you

1229
00:42:23,280 --> 00:42:24,880
they don't have your problem you have

1230
00:42:24,880 --> 00:42:26,480
your problem you need to fix your

1231
00:42:26,480 --> 00:42:28,400
problem with your solution they can sell

1232
00:42:28,400 --> 00:42:29,839
your product they can sell you a tool

1233
00:42:29,839 --> 00:42:32,240
that's all

1234
00:42:32,480 --> 00:42:36,160
well thanks everybody i'm i'm

1235
00:42:36,240 --> 00:42:37,359
we're right we have time but i think

1236
00:42:37,359 --> 00:42:38,480
we've got a break we can probably take

1237
00:42:38,480 --> 00:42:41,119
one more question

1238
00:42:42,839 --> 00:42:44,560
sorry

1239
00:42:44,560 --> 00:42:46,400
yeah i mean just because there was one

1240
00:42:46,400 --> 00:42:48,240
more question but

1241
00:42:48,240 --> 00:42:49,680
well i can take it i can take it in the

1242
00:42:49,680 --> 00:42:51,440
other room anyway but you go ahead if

1243
00:42:51,440 --> 00:42:53,760
you have it

1244
00:42:54,560 --> 00:42:55,920
hello

1245
00:42:55,920 --> 00:42:58,800
uh so uh yeah so the question i had is

1246
00:42:58,800 --> 00:43:01,520
like uh like say isn't uh let's say the

1247
00:43:01,520 --> 00:43:03,440
uh the implementation of the sigma or

1248
00:43:03,440 --> 00:43:07,200
the uh uh or like say the mitre care uh

1249
00:43:07,200 --> 00:43:09,920
let's say mapping to attack uh

1250
00:43:09,920 --> 00:43:11,920
for the incident responder like like say

1251
00:43:11,920 --> 00:43:14,640
do we really need to accept build

1252
00:43:14,640 --> 00:43:16,880
build or like say uh let's say reinvent

1253
00:43:16,880 --> 00:43:18,000
a wheel

1254
00:43:18,000 --> 00:43:20,000
uh instead of just like say building on

1255
00:43:20,000 --> 00:43:22,160
top of the miter

1256
00:43:22,160 --> 00:43:23,760
so my intention is not to build on top

1257
00:43:23,760 --> 00:43:25,760
of the miter attack framework for this

1258
00:43:25,760 --> 00:43:26,720
um

1259
00:43:26,720 --> 00:43:28,800
if you want to do that you're welcome to

1260
00:43:28,800 --> 00:43:30,640
uh i don't have enough alcohol anymore

1261
00:43:30,640 --> 00:43:33,440
in me anymore today to be able to to go

1262
00:43:33,440 --> 00:43:35,599
off on my rant about minor attack

1263
00:43:35,599 --> 00:43:38,319
but if you so this the tldr of the mitre

1264
00:43:38,319 --> 00:43:39,920
attack is if you looked at it the ver

1265
00:43:39,920 --> 00:43:41,920
the early versions it was very specific

1266
00:43:41,920 --> 00:43:43,599
they were mapping techniques

1267
00:43:43,599 --> 00:43:44,400
uh

1268
00:43:44,400 --> 00:43:46,720
they were mapping ttps properly if you

1269
00:43:46,720 --> 00:43:48,240
look at it now

1270
00:43:48,240 --> 00:43:50,880
you it takes you like 10 minutes to

1271
00:43:50,880 --> 00:43:54,680
actually find the ttp

1272
00:43:55,040 --> 00:43:56,960
the actual definite the actual

1273
00:43:56,960 --> 00:43:59,040
elements of the ttp they've completely

1274
00:43:59,040 --> 00:44:00,640
removed the data points they completely

1275
00:44:00,640 --> 00:44:01,760
remove the

1276
00:44:01,760 --> 00:44:05,119
the actual technical aspects of the ttps

1277
00:44:05,119 --> 00:44:06,880
they haven't really but they've not made

1278
00:44:06,880 --> 00:44:08,720
it easy for you to get anymore

1279
00:44:08,720 --> 00:44:10,800
uh actually like uh makes it to answer

1280
00:44:10,800 --> 00:44:13,200
that uh there is actually a json version

1281
00:44:13,200 --> 00:44:15,040
of it available which actually has all

1282
00:44:15,040 --> 00:44:16,800
the uh all those all this mapping yeah

1283
00:44:16,800 --> 00:44:18,240
but even if you if even if you go into

1284
00:44:18,240 --> 00:44:19,760
the json version a lot of it's missing

1285
00:44:19,760 --> 00:44:20,560
now

1286
00:44:20,560 --> 00:44:22,799
okay

1287
00:44:24,160 --> 00:44:26,880
no i don't have enough alcohol

1288
00:44:26,880 --> 00:44:29,040
uh yeah so like one more just just one

1289
00:44:29,040 --> 00:44:31,200
more question

1290
00:44:31,200 --> 00:44:32,960
go ahead go ahead i mean we've got a

1291
00:44:32,960 --> 00:44:36,319
break but everybody's welcome to

1292
00:44:36,319 --> 00:44:40,160
okay uh so like yeah so like say uh

1293
00:44:40,160 --> 00:44:41,680
where do we actually like to draw the

1294
00:44:41,680 --> 00:44:43,839
line for like uh

1295
00:44:43,839 --> 00:44:44,640
the

1296
00:44:44,640 --> 00:44:48,400
uh for like say the money

1297
00:44:51,839 --> 00:44:52,960
where do we actually draw the line

1298
00:44:52,960 --> 00:44:56,240
between the money aspect and the ease uh

1299
00:44:56,240 --> 00:44:58,800
uh is in the mind map um we actually

1300
00:44:58,800 --> 00:45:01,040
have to fill the gaps in the uh

1301
00:45:01,040 --> 00:45:02,880
in the mind map when we implement a new

1302
00:45:02,880 --> 00:45:04,720
technology but we also have to check

1303
00:45:04,720 --> 00:45:07,520
like if the technology we are buying

1304
00:45:07,520 --> 00:45:10,800
is that it comes that becomes a

1305
00:45:10,800 --> 00:45:12,880
risk-based decision and a money-based

1306
00:45:12,880 --> 00:45:14,640
decision and you can't do everything in

1307
00:45:14,640 --> 00:45:15,839
the world

1308
00:45:15,839 --> 00:45:17,280
if you have a good company and they've

1309
00:45:17,280 --> 00:45:18,880
got a good budget and they realize the

1310
00:45:18,880 --> 00:45:21,200
benefits of doing this then that's it

1311
00:45:21,200 --> 00:45:22,480
but one of the things i'm playing with

1312
00:45:22,480 --> 00:45:23,839
in my head is because i've done this

1313
00:45:23,839 --> 00:45:26,079
mind mapping and i've done this this gap

1314
00:45:26,079 --> 00:45:27,280
analysis

1315
00:45:27,280 --> 00:45:29,920
if you get compromised

1316
00:45:29,920 --> 00:45:32,240
and you can identify that the compromise

1317
00:45:32,240 --> 00:45:34,560
was because what if it was due to one of

1318
00:45:34,560 --> 00:45:36,880
the gaps that you identified earlier

1319
00:45:36,880 --> 00:45:37,920
that just gives you another

1320
00:45:37,920 --> 00:45:39,599
justification to go back to management

1321
00:45:39,599 --> 00:45:42,000
and say i need more money to stop this

1322
00:45:42,000 --> 00:45:43,520
from happening again

1323
00:45:43,520 --> 00:45:46,920
does that make sense

1324
00:45:46,960 --> 00:45:47,839
cool

1325
00:45:47,839 --> 00:45:50,839
thanks

