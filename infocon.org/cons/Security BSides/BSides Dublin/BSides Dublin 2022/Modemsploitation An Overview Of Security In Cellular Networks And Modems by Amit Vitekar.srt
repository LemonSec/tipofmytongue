1
00:00:03,199 --> 00:00:05,359
so uh very good morning to all let's

2
00:00:05,359 --> 00:00:07,359
begin with the first talk of the day

3
00:00:07,359 --> 00:00:09,200
um this talk is going to be more about

4
00:00:09,200 --> 00:00:11,360
security of cellular networks and modems

5
00:00:11,360 --> 00:00:12,960
which are present in your smartphones

6
00:00:12,960 --> 00:00:15,440
your cars your iot devices drones and

7
00:00:15,440 --> 00:00:18,880
what not my name is amit viteka i'm a

8
00:00:18,880 --> 00:00:20,560
cyber security master student at

9
00:00:20,560 --> 00:00:22,320
national college of ireland i have a two

10
00:00:22,320 --> 00:00:23,760
plus years of experience as security

11
00:00:23,760 --> 00:00:24,880
researcher

12
00:00:24,880 --> 00:00:26,480
into hacking electric vehicle iot

13
00:00:26,480 --> 00:00:28,960
devices embedded devices my most focus

14
00:00:28,960 --> 00:00:30,800
is on security of cellular networks i

15
00:00:30,800 --> 00:00:34,239
have worked on security of gsm lte

16
00:00:34,239 --> 00:00:36,480
5g somewhat

17
00:00:36,480 --> 00:00:38,320
and

18
00:00:38,320 --> 00:00:40,160
most of my time i spend reverse

19
00:00:40,160 --> 00:00:41,760
engineering and exploiting embedded and

20
00:00:41,760 --> 00:00:43,200
iot devices

21
00:00:43,200 --> 00:00:45,760
i'm also interested of something i mean

22
00:00:45,760 --> 00:00:47,200
i have a special interest in awkward

23
00:00:47,200 --> 00:00:48,480
science too

24
00:00:48,480 --> 00:00:50,320
okay so what's this talk going to be

25
00:00:50,320 --> 00:00:52,160
about first things first we'll be

26
00:00:52,160 --> 00:00:54,480
looking at an overview of 4g lte network

27
00:00:54,480 --> 00:00:56,160
to just get a basic understanding of how

28
00:00:56,160 --> 00:00:57,680
cellular networks work

29
00:00:57,680 --> 00:01:00,160
then we'll try to fit in how does modern

30
00:01:00,160 --> 00:01:00,879
play

31
00:01:00,879 --> 00:01:02,079
important role

32
00:01:02,079 --> 00:01:04,000
into communicating with cellular

33
00:01:04,000 --> 00:01:06,479
networks and then we'll be talking about

34
00:01:06,479 --> 00:01:08,960
security features in the cellular modems

35
00:01:08,960 --> 00:01:10,960
we'll also be looking at the case study

36
00:01:10,960 --> 00:01:12,640
of what of different vulnerabilities

37
00:01:12,640 --> 00:01:14,400
that i had reported

38
00:01:14,400 --> 00:01:15,600
and then we'll talk about machine

39
00:01:15,600 --> 00:01:18,400
mitigation techniques that can be

40
00:01:18,400 --> 00:01:21,040
used by different vendors

41
00:01:21,040 --> 00:01:22,400
okay

42
00:01:22,400 --> 00:01:24,560
so this is what a basic 4g network looks

43
00:01:24,560 --> 00:01:27,520
like the ue is basically user equipment

44
00:01:27,520 --> 00:01:29,119
we call it this a smartphone this could

45
00:01:29,119 --> 00:01:31,119
be a smartphone this could be your car

46
00:01:31,119 --> 00:01:31,920
which

47
00:01:31,920 --> 00:01:34,240
is connected to a 4g network let's say

48
00:01:34,240 --> 00:01:35,360
tesla

49
00:01:35,360 --> 00:01:37,360
or it could be an iot device it could be

50
00:01:37,360 --> 00:01:38,960
a drone which is connected to a cellular

51
00:01:38,960 --> 00:01:41,360
network the enb which is basically the

52
00:01:41,360 --> 00:01:43,360
cellular tower also known as evolved

53
00:01:43,360 --> 00:01:44,560
node base

54
00:01:44,560 --> 00:01:46,079
this is your cellphone tower through

55
00:01:46,079 --> 00:01:47,600
which to which your smartphone

56
00:01:47,600 --> 00:01:48,720
communicates

57
00:01:48,720 --> 00:01:51,360
this tower is connected to

58
00:01:51,360 --> 00:01:53,840
the mme mme basically stands for mobile

59
00:01:53,840 --> 00:01:55,360
management entity this is where all the

60
00:01:55,360 --> 00:01:57,040
security stuff happens

61
00:01:57,040 --> 00:01:59,119
all of your uh encryption keys are

62
00:01:59,119 --> 00:02:02,240
stored here everything and the enb talks

63
00:02:02,240 --> 00:02:04,320
to the mme directly these are mostly

64
00:02:04,320 --> 00:02:06,840
connected to fiber optics and various

65
00:02:06,840 --> 00:02:10,160
means all of your ip packets are routed

66
00:02:10,160 --> 00:02:11,840
through s gateway

67
00:02:11,840 --> 00:02:14,160
okay so most of whatever you're browsing

68
00:02:14,160 --> 00:02:15,440
let's say you're browsing facebook

69
00:02:15,440 --> 00:02:17,280
everything all of the data flows from s

70
00:02:17,280 --> 00:02:18,319
gateway

71
00:02:18,319 --> 00:02:20,400
and the job of the pdm gateway or the p

72
00:02:20,400 --> 00:02:22,959
gateway is to allocate you ip as soon as

73
00:02:22,959 --> 00:02:24,560
you turn on your smartphone and your

74
00:02:24,560 --> 00:02:27,040
data so pdm plays a very important role

75
00:02:27,040 --> 00:02:29,599
in all this all of these things work

76
00:02:29,599 --> 00:02:31,920
interconnected with each other

77
00:02:31,920 --> 00:02:33,760
right from your smartphone to your pdm

78
00:02:33,760 --> 00:02:35,519
gateway that is how your data flows and

79
00:02:35,519 --> 00:02:39,680
then you are able to browse the internet

80
00:02:40,000 --> 00:02:41,440
so now the question arises where do

81
00:02:41,440 --> 00:02:43,440
cellular models fit in and why do we

82
00:02:43,440 --> 00:02:44,800
need them

83
00:02:44,800 --> 00:02:46,160
so

84
00:02:46,160 --> 00:02:48,800
just like there are rfcs for various

85
00:02:48,800 --> 00:02:51,440
community various protocols so for web

86
00:02:51,440 --> 00:02:53,840
and tcp and stuff

87
00:02:53,840 --> 00:02:56,319
there's a consortium called idu

88
00:02:56,319 --> 00:02:58,720
international telecom union and it has a

89
00:02:58,720 --> 00:03:00,400
different

90
00:03:00,400 --> 00:03:01,519
sister

91
00:03:01,519 --> 00:03:02,879
groups i would say

92
00:03:02,879 --> 00:03:05,120
one of them is 3gb so 3gpp is

93
00:03:05,120 --> 00:03:07,120
responsible for laying out technical

94
00:03:07,120 --> 00:03:09,360
specifications of how the network should

95
00:03:09,360 --> 00:03:10,560
be

96
00:03:10,560 --> 00:03:12,319
architected how the architecture of the

97
00:03:12,319 --> 00:03:13,840
network should be how they should be

98
00:03:13,840 --> 00:03:16,640
deployed and how it should work

99
00:03:16,640 --> 00:03:19,040
so specifically when it comes to your

100
00:03:19,040 --> 00:03:21,680
smartphone vendors your routers your

101
00:03:21,680 --> 00:03:23,680
electric vehicles and whatnot

102
00:03:23,680 --> 00:03:25,200
they have to follow this specification

103
00:03:25,200 --> 00:03:28,000
to design the modem chip and a firmware

104
00:03:28,000 --> 00:03:29,360
running on top of this chip which is

105
00:03:29,360 --> 00:03:31,200
basically an rtos with different

106
00:03:31,200 --> 00:03:32,560
different tasks

107
00:03:32,560 --> 00:03:34,400
it makes sure that all the 80 commands

108
00:03:34,400 --> 00:03:36,239
which are being executed are being

109
00:03:36,239 --> 00:03:38,720
translated into different

110
00:03:38,720 --> 00:03:39,920
um

111
00:03:39,920 --> 00:03:42,239
basically commands and being sent to the

112
00:03:42,239 --> 00:03:45,120
nearby cell phone tower over rf means

113
00:03:45,120 --> 00:03:46,480
this chips are

114
00:03:46,480 --> 00:03:48,959
mainly available in your mostly found i

115
00:03:48,959 --> 00:03:51,120
would say in your smartphones in your

116
00:03:51,120 --> 00:03:53,920
routers and even your electric cars

117
00:03:53,920 --> 00:03:56,560
drones and whatnot so our talk will be

118
00:03:56,560 --> 00:03:59,040
focusing mostly on based on this chip as

119
00:03:59,040 --> 00:04:00,959
i said a baseband firmware and cellular

120
00:04:00,959 --> 00:04:03,120
modem contains 3gb specs and it is

121
00:04:03,120 --> 00:04:05,360
implemented in from an rtos also

122
00:04:05,360 --> 00:04:07,680
sometimes it has been found it is

123
00:04:07,680 --> 00:04:09,360
available in the form of embedded linux

124
00:04:09,360 --> 00:04:12,720
or open source linux systems

125
00:04:13,040 --> 00:04:14,319
so these are some of the security

126
00:04:14,319 --> 00:04:16,639
features that are being you know are

127
00:04:16,639 --> 00:04:18,560
given by various vendors

128
00:04:18,560 --> 00:04:20,560
uh what today i'll be talking mostly is

129
00:04:20,560 --> 00:04:22,560
about quechtel quechtel is one of the

130
00:04:22,560 --> 00:04:23,759
biggest

131
00:04:23,759 --> 00:04:24,720
biggest

132
00:04:24,720 --> 00:04:27,440
vendors in modern space and telecom

133
00:04:27,440 --> 00:04:29,520
space and they use qualcomm's

134
00:04:29,520 --> 00:04:31,840
architecture called as hexagon

135
00:04:31,840 --> 00:04:33,040
hexagon has a very different

136
00:04:33,040 --> 00:04:34,400
architecture a very different

137
00:04:34,400 --> 00:04:35,680
instruction set

138
00:04:35,680 --> 00:04:37,440
reverse engineering hexagon chip is very

139
00:04:37,440 --> 00:04:39,040
difficult because they are not arm based

140
00:04:39,040 --> 00:04:40,240
they have a very different way of

141
00:04:40,240 --> 00:04:43,120
working and executing so there are four

142
00:04:43,120 --> 00:04:45,199
protection techniques that are given by

143
00:04:45,199 --> 00:04:47,280
this different different vendors

144
00:04:47,280 --> 00:04:50,320
one of them is jamming detection so if

145
00:04:50,320 --> 00:04:52,639
let's say you're traveling somewhere and

146
00:04:52,639 --> 00:04:54,840
you lose connectivity to your cellular

147
00:04:54,840 --> 00:04:57,440
network basically your phone is offline

148
00:04:57,440 --> 00:04:59,840
right you cannot call anyone you cannot

149
00:04:59,840 --> 00:05:01,759
use the internet or do anything

150
00:05:01,759 --> 00:05:03,360
now this is in the case when you're

151
00:05:03,360 --> 00:05:05,520
roaming let's say there is some white

152
00:05:05,520 --> 00:05:07,199
noise or disturbance present in an rx

153
00:05:07,199 --> 00:05:08,240
spectrum

154
00:05:08,240 --> 00:05:10,560
this causes the smartphone to get jammed

155
00:05:10,560 --> 00:05:12,800
and there is jamming detection in these

156
00:05:12,800 --> 00:05:15,360
chips specifically when they are used in

157
00:05:15,360 --> 00:05:17,600
electric cars and drones and stuff in

158
00:05:17,600 --> 00:05:19,199
smartphone

159
00:05:19,199 --> 00:05:21,759
apple does provide protection from

160
00:05:21,759 --> 00:05:24,400
jamming but i'm not aware about with

161
00:05:24,400 --> 00:05:26,720
other vendors like samsung and

162
00:05:26,720 --> 00:05:28,400
oppo or something like that

163
00:05:28,400 --> 00:05:29,520
the second

164
00:05:29,520 --> 00:05:31,520
protection technique or mechanism in

165
00:05:31,520 --> 00:05:34,560
this provide are this vendors provide a

166
00:05:34,560 --> 00:05:36,960
pseudo based station attack direction

167
00:05:36,960 --> 00:05:39,520
which is basically deploying a fake gsm

168
00:05:39,520 --> 00:05:41,680
or ld network and forcing your

169
00:05:41,680 --> 00:05:43,759
smartphone or your device

170
00:05:43,759 --> 00:05:46,240
to connect to this cellular fake

171
00:05:46,240 --> 00:05:47,919
cellular network

172
00:05:47,919 --> 00:05:50,000
so again depends on different different

173
00:05:50,000 --> 00:05:51,680
smartphone vendors some of them provide

174
00:05:51,680 --> 00:05:53,759
protection some of them don't

175
00:05:53,759 --> 00:05:56,080
then there is a private apn attack so

176
00:05:56,080 --> 00:05:58,639
mostly in electric cars and drones what

177
00:05:58,639 --> 00:06:00,639
you would find is that

178
00:06:00,639 --> 00:06:02,560
apns used are very different from the

179
00:06:02,560 --> 00:06:04,639
aps that you find in your smartphones or

180
00:06:04,639 --> 00:06:06,560
your iot devices they are not just that

181
00:06:06,560 --> 00:06:08,400
you create an apn go to your settings

182
00:06:08,400 --> 00:06:09,919
open as create an api and type in the

183
00:06:09,919 --> 00:06:11,840
name of your api and save it and your

184
00:06:11,840 --> 00:06:12,960
data starts flowing through their

185
00:06:12,960 --> 00:06:14,800
network that's not how it works

186
00:06:14,800 --> 00:06:16,479
usually they have a user password

187
00:06:16,479 --> 00:06:19,759
mechanism but when i have what when i've

188
00:06:19,759 --> 00:06:22,479
been tested couple of uh evs

189
00:06:22,479 --> 00:06:24,960
uh in last two years i haven't found any

190
00:06:24,960 --> 00:06:27,360
of the security mechanisms being induced

191
00:06:27,360 --> 00:06:28,880
and this is something has been advised

192
00:06:28,880 --> 00:06:31,120
by a lot of modern manufacturers and

193
00:06:31,120 --> 00:06:33,840
it's even present into 3gb specs that a

194
00:06:33,840 --> 00:06:35,520
username password combination should be

195
00:06:35,520 --> 00:06:37,600
used to authenticate

196
00:06:37,600 --> 00:06:41,039
let's say a car or field of cars to a

197
00:06:41,039 --> 00:06:43,120
cellular network and the last thing we

198
00:06:43,120 --> 00:06:45,280
will be talking about is an 80 command

199
00:06:45,280 --> 00:06:47,199
one ability attack

200
00:06:47,199 --> 00:06:49,280
so this is basically a hardware and a

201
00:06:49,280 --> 00:06:51,919
firmware based attack in which if you

202
00:06:51,919 --> 00:06:53,840
reverse engineer the modem you find

203
00:06:53,840 --> 00:06:56,160
serial communication ports let's say uh

204
00:06:56,160 --> 00:06:57,680
universal synchronous real-time

205
00:06:57,680 --> 00:07:01,360
communication serial wire interface swi

206
00:07:01,360 --> 00:07:03,039
and once you get access to this you

207
00:07:03,039 --> 00:07:04,560
access the internal firmware or your

208
00:07:04,560 --> 00:07:06,639
time try to dump the firmware you

209
00:07:06,639 --> 00:07:08,319
reverse engineer the firmware figure out

210
00:07:08,319 --> 00:07:09,840
what 80 commands are being there and

211
00:07:09,840 --> 00:07:11,360
then you try to manipulate the city

212
00:07:11,360 --> 00:07:12,400
commands

213
00:07:12,400 --> 00:07:14,080
so these are some of the protection

214
00:07:14,080 --> 00:07:15,039
techniques

215
00:07:15,039 --> 00:07:16,720
are provided by vendors against these

216
00:07:16,720 --> 00:07:19,280
various attacks so one by one we'll be

217
00:07:19,280 --> 00:07:20,319
seeing

218
00:07:20,319 --> 00:07:22,880
how we can bypass this technique even if

219
00:07:22,880 --> 00:07:24,639
the protection mechanisms are available

220
00:07:24,639 --> 00:07:26,080
and

221
00:07:26,080 --> 00:07:28,720
what measures should different different

222
00:07:28,720 --> 00:07:31,360
oems take when it comes to protecting

223
00:07:31,360 --> 00:07:34,160
the devices from attacks specifically to

224
00:07:34,160 --> 00:07:35,280
modems and

225
00:07:35,280 --> 00:07:38,160
cellular networks

226
00:07:38,160 --> 00:07:41,120
okay so how is this going to be done

227
00:07:41,120 --> 00:07:43,599
what is the lab setup and everything so

228
00:07:43,599 --> 00:07:45,199
most of this stuff that i'll be talking

229
00:07:45,199 --> 00:07:47,199
about will be done in an isolated

230
00:07:47,199 --> 00:07:48,960
environment you can consider a faraday's

231
00:07:48,960 --> 00:07:51,280
case something like that or a room which

232
00:07:51,280 --> 00:07:54,400
is isolated from external networks we'll

233
00:07:54,400 --> 00:07:56,560
be using a software defined radio so all

234
00:07:56,560 --> 00:07:57,840
of those who don't know what's a

235
00:07:57,840 --> 00:07:59,680
software defined radio

236
00:07:59,680 --> 00:08:03,039
it's a radio which is in which you can

237
00:08:03,039 --> 00:08:04,800
listen to any frequency or you can

238
00:08:04,800 --> 00:08:06,639
transmit any frequency

239
00:08:06,639 --> 00:08:08,000
and stuff

240
00:08:08,000 --> 00:08:11,280
so we'll be using usrpb200 for deploying

241
00:08:11,280 --> 00:08:13,360
our 4g network which will act as a

242
00:08:13,360 --> 00:08:14,879
pseudo based station

243
00:08:14,879 --> 00:08:16,879
i will be using hack rf everybody knows

244
00:08:16,879 --> 00:08:19,360
hacker what is hacker it's pretty famous

245
00:08:19,360 --> 00:08:21,599
uh it will use it for i will be using it

246
00:08:21,599 --> 00:08:23,919
for jamming the network

247
00:08:23,919 --> 00:08:26,639
gps proofing this mostly has been used

248
00:08:26,639 --> 00:08:29,360
when it comes to spoofing your apps like

249
00:08:29,360 --> 00:08:32,000
uber and all this stuff where you try to

250
00:08:32,000 --> 00:08:34,320
manipulate the destination that you're

251
00:08:34,320 --> 00:08:36,719
trying to reach and sometimes just get

252
00:08:36,719 --> 00:08:38,839
away with it at zero cost you can get a

253
00:08:38,839 --> 00:08:41,839
ride and later on we'll see how a usb

254
00:08:41,839 --> 00:08:44,240
total converter can be used to just talk

255
00:08:44,240 --> 00:08:47,600
to the modem over uh swi interface

256
00:08:47,600 --> 00:08:49,519
so let's begin

257
00:08:49,519 --> 00:08:51,360
so to bypass the jamming detection the

258
00:08:51,360 --> 00:08:53,440
first thing is that we need to figure

259
00:08:53,440 --> 00:08:55,760
out at what frequency

260
00:08:55,760 --> 00:08:57,839
is your smartphone or your target device

261
00:08:57,839 --> 00:08:59,680
communicating with a nearby cellular

262
00:08:59,680 --> 00:09:00,800
network

263
00:09:00,800 --> 00:09:02,240
so this is something this is called

264
00:09:02,240 --> 00:09:05,279
something called as ear fcn eu absolute

265
00:09:05,279 --> 00:09:07,279
radio frequency channel number this is

266
00:09:07,279 --> 00:09:10,080
specified in the 3gbp specifications

267
00:09:10,080 --> 00:09:12,080
uh you have to do some reconnaissance

268
00:09:12,080 --> 00:09:14,480
you need to run uh your

269
00:09:14,480 --> 00:09:17,519
hack rf or usrp uh with

270
00:09:17,519 --> 00:09:20,000
your custom gnu radio script and start

271
00:09:20,000 --> 00:09:22,640
listening to various gsm frequencies if

272
00:09:22,640 --> 00:09:26,320
you stay in area so let's say in india

273
00:09:26,320 --> 00:09:28,800
we use basically use frequencies on a

274
00:09:28,800 --> 00:09:31,040
gsm of 900 megahertz

275
00:09:31,040 --> 00:09:33,360
and that is where every region or every

276
00:09:33,360 --> 00:09:34,959
state in india has been allocated a

277
00:09:34,959 --> 00:09:37,279
specific ar fcn and then you have to

278
00:09:37,279 --> 00:09:39,440
just look it up and try yeah oh is your

279
00:09:39,440 --> 00:09:42,640
device listening at this here fca

280
00:09:42,640 --> 00:09:45,200
uh i have tested this and over a

281
00:09:45,200 --> 00:09:47,519
smartphone and even some other ot

282
00:09:47,519 --> 00:09:49,200
devices

283
00:09:49,200 --> 00:09:52,080
also the target device uh which was kind

284
00:09:52,080 --> 00:09:54,640
of a telematics unit or using jamming

285
00:09:54,640 --> 00:09:56,080
attack i was completely able to

286
00:09:56,080 --> 00:09:57,360
disconnect it from the legitimate

287
00:09:57,360 --> 00:09:59,680
circular network and in further attacks

288
00:09:59,680 --> 00:10:01,200
uh we'll see how we can use jamming

289
00:10:01,200 --> 00:10:03,920
attack to force a device to disconnect

290
00:10:03,920 --> 00:10:05,839
from a legitimate network and connect it

291
00:10:05,839 --> 00:10:07,839
to a fake network and then get all the

292
00:10:07,839 --> 00:10:10,399
data traffic flowing

293
00:10:10,399 --> 00:10:12,560
so this is an erfs calculator that you

294
00:10:12,560 --> 00:10:15,279
can find on screenwave so let's say

295
00:10:15,279 --> 00:10:16,880
after reconnaissance you find out the

296
00:10:16,880 --> 00:10:19,360
frequency your frequency is 2 1 4 this

297
00:10:19,360 --> 00:10:21,279
is where you see a huge bike using a

298
00:10:21,279 --> 00:10:23,279
software defined radio you just go to

299
00:10:23,279 --> 00:10:25,440
this here i've seen calculator type in

300
00:10:25,440 --> 00:10:27,839
the frequency and you will get the afc

301
00:10:27,839 --> 00:10:29,120
number or let's say you figure out in

302
00:10:29,120 --> 00:10:31,120
your fcn number and just click on the

303
00:10:31,120 --> 00:10:32,720
frequency thing this is available on

304
00:10:32,720 --> 00:10:34,640
it's an online tool you get to know the

305
00:10:34,640 --> 00:10:38,320
uplink and downlink so 2114.20 and 1924

306
00:10:38,320 --> 00:10:40,079
or 20 these are the frequencies which

307
00:10:40,079 --> 00:10:40,800
are

308
00:10:40,800 --> 00:10:42,320
basically being used by your device to

309
00:10:42,320 --> 00:10:44,000
communicate to the nearby cellular

310
00:10:44,000 --> 00:10:45,360
network

311
00:10:45,360 --> 00:10:47,760
what you need to do next is to jam the

312
00:10:47,760 --> 00:10:49,680
downlink frequency

313
00:10:49,680 --> 00:10:52,880
that's the tricky part

314
00:10:53,120 --> 00:10:54,480
so this is the script that i had been

315
00:10:54,480 --> 00:10:55,760
using

316
00:10:55,760 --> 00:10:58,640
now this software over here on the left

317
00:10:58,640 --> 00:11:00,720
side uh which shows some blocks

318
00:11:00,720 --> 00:11:02,480
interconnected and everything this is

319
00:11:02,480 --> 00:11:06,240
gnu radio gna radio is an open source uh

320
00:11:06,240 --> 00:11:08,320
software based on python

321
00:11:08,320 --> 00:11:10,560
and python and c plus plus

322
00:11:10,560 --> 00:11:12,480
you can use this to generate different

323
00:11:12,480 --> 00:11:14,959
waveforms and you can transmit and

324
00:11:14,959 --> 00:11:17,279
receive data over the air and a lot of

325
00:11:17,279 --> 00:11:18,640
stuff especially if you're a

326
00:11:18,640 --> 00:11:20,720
communication student this is a tool you

327
00:11:20,720 --> 00:11:22,320
should be playing with a lot

328
00:11:22,320 --> 00:11:25,440
using a cheap rtl sdr

329
00:11:25,440 --> 00:11:27,440
after jamming on the right side as you

330
00:11:27,440 --> 00:11:29,120
can see there's a symbol that's a

331
00:11:29,120 --> 00:11:31,839
semicircle symbol which shows that

332
00:11:31,839 --> 00:11:34,000
the frequency has been jammed and some

333
00:11:34,000 --> 00:11:34,959
of the other

334
00:11:34,959 --> 00:11:36,959
other slides you can just slide it to

335
00:11:36,959 --> 00:11:39,839
various frequencies and increase the rf

336
00:11:39,839 --> 00:11:42,720
transmission power to lower or increase

337
00:11:42,720 --> 00:11:45,279
the power of jamming

338
00:11:45,279 --> 00:11:47,680
remember do not jam too much as this

339
00:11:47,680 --> 00:11:49,680
could cause the device to be completely

340
00:11:49,680 --> 00:11:51,760
disconnected and go into a very

341
00:11:51,760 --> 00:11:54,880
different state where it will not even

342
00:11:54,880 --> 00:11:57,040
try to connect to any other cellular

343
00:11:57,040 --> 00:11:59,120
network and just remain idle this is

344
00:11:59,120 --> 00:12:00,560
some this is a kind of a security

345
00:12:00,560 --> 00:12:02,959
mechanism being provided by a lot of

346
00:12:02,959 --> 00:12:05,200
vendors especially some of the very

347
00:12:05,200 --> 00:12:07,040
great israeli vendors i've seen this

348
00:12:07,040 --> 00:12:09,120
they're doing it's a very great security

349
00:12:09,120 --> 00:12:11,200
mechanism and

350
00:12:11,200 --> 00:12:13,040
it's a very nice way to you know detect

351
00:12:13,040 --> 00:12:14,880
oh someone's trying to hack your device

352
00:12:14,880 --> 00:12:17,440
over cellular network you know just sit

353
00:12:17,440 --> 00:12:19,680
there don't do anything let's quit let

354
00:12:19,680 --> 00:12:21,279
the hacker do his thing we wait for half

355
00:12:21,279 --> 00:12:23,200
an hour 45 minutes nothing happens then

356
00:12:23,200 --> 00:12:24,800
we again try to go and try to connect to

357
00:12:24,800 --> 00:12:26,480
the legitimate network

358
00:12:26,480 --> 00:12:28,800
that's the way it works

359
00:12:28,800 --> 00:12:31,040
okay now this was the first attack now

360
00:12:31,040 --> 00:12:33,200
this jamming attack that i described

361
00:12:33,200 --> 00:12:35,920
we'll be using this to deploy our

362
00:12:35,920 --> 00:12:38,079
pseudo base station attack why would i

363
00:12:38,079 --> 00:12:39,279
do this

364
00:12:39,279 --> 00:12:40,800
thing is

365
00:12:40,800 --> 00:12:42,560
as soon as you power on your device your

366
00:12:42,560 --> 00:12:44,959
smartphone your iot device or even you

367
00:12:44,959 --> 00:12:46,480
start your car

368
00:12:46,480 --> 00:12:48,240
it knows what frequencies are nearby

369
00:12:48,240 --> 00:12:50,720
being used by your cellular company

370
00:12:50,720 --> 00:12:52,399
because this data has been is being

371
00:12:52,399 --> 00:12:54,480
transmitted by your telecom operator to

372
00:12:54,480 --> 00:12:57,120
your device and it's resides as a cache

373
00:12:57,120 --> 00:12:58,320
into your

374
00:12:58,320 --> 00:12:59,680
modem

375
00:12:59,680 --> 00:13:02,399
so it directly will go to go and try to

376
00:13:02,399 --> 00:13:04,320
connect to those frequencies

377
00:13:04,320 --> 00:13:06,240
through jamming we force it to

378
00:13:06,240 --> 00:13:08,160
disconnect through those frequencies

379
00:13:08,160 --> 00:13:09,519
once you understand what those

380
00:13:09,519 --> 00:13:11,200
frequencies or what those ear f sense

381
00:13:11,200 --> 00:13:12,000
where

382
00:13:12,000 --> 00:13:14,079
and then at the same frequency or

383
00:13:14,079 --> 00:13:16,160
frequency just a different offset we

384
00:13:16,160 --> 00:13:18,079
deploy our fake network

385
00:13:18,079 --> 00:13:19,360
with

386
00:13:19,360 --> 00:13:23,440
uh all the fields like uh mcc mnc mg

387
00:13:23,440 --> 00:13:25,760
team z so what are these fields

388
00:13:25,760 --> 00:13:28,399
uh mcc stands for mobile country code so

389
00:13:28,399 --> 00:13:29,600
when you're sniffing you can come to

390
00:13:29,600 --> 00:13:31,600
know what is your mobile country cover

391
00:13:31,600 --> 00:13:34,480
then mnc is your network code so mnc is

392
00:13:34,480 --> 00:13:35,680
unique for each and every telecom

393
00:13:35,680 --> 00:13:37,200
operator let's say vodafone has a

394
00:13:37,200 --> 00:13:39,040
different mnc and then three has a

395
00:13:39,040 --> 00:13:42,639
different terms and somewhat mg is your

396
00:13:42,639 --> 00:13:44,560
user's unique identity over cellular

397
00:13:44,560 --> 00:13:46,160
network it stands for international

398
00:13:46,160 --> 00:13:49,120
mobile subscriber identity so let's say

399
00:13:49,120 --> 00:13:50,800
you are coming you're going from ireland

400
00:13:50,800 --> 00:13:52,240
to u.s and

401
00:13:52,240 --> 00:13:54,000
let's say you're on vodafone so how do

402
00:13:54,000 --> 00:13:55,839
they recognize for you're from ireland

403
00:13:55,839 --> 00:13:57,279
or you're from norway or you're from

404
00:13:57,279 --> 00:13:59,199
india or india so mg is your unique

405
00:13:59,199 --> 00:14:01,519
identifier it helps you recognize oh

406
00:14:01,519 --> 00:14:03,120
this guy is coming from here we need to

407
00:14:03,120 --> 00:14:05,360
provide him roaming services we need to

408
00:14:05,360 --> 00:14:07,760
provide him data packs data services and

409
00:14:07,760 --> 00:14:08,720
so

410
00:14:08,720 --> 00:14:10,560
when you're in your home country so

411
00:14:10,560 --> 00:14:12,240
let's say i'm currently a subscriber of

412
00:14:12,240 --> 00:14:14,880
some telecom operator here in ireland so

413
00:14:14,880 --> 00:14:16,320
i have been assigned something called as

414
00:14:16,320 --> 00:14:18,959
timzy so tmz helps me helps the telecom

415
00:14:18,959 --> 00:14:20,720
operators to locate

416
00:14:20,720 --> 00:14:22,639
whether i am going from dublin to car

417
00:14:22,639 --> 00:14:25,040
 to call away where am i exactly

418
00:14:25,040 --> 00:14:27,279
your telecom operator has every or log

419
00:14:27,279 --> 00:14:28,800
of whatever you are doing where you are

420
00:14:28,800 --> 00:14:30,800
roaming what services you're using so

421
00:14:30,800 --> 00:14:33,040
timzy comes into the play when you're in

422
00:14:33,040 --> 00:14:34,880
your home network or you're roaming in

423
00:14:34,880 --> 00:14:36,800
your own country or let's say european

424
00:14:36,800 --> 00:14:39,279
union mg is global

425
00:14:39,279 --> 00:14:41,279
wherever you go they know that you have

426
00:14:41,279 --> 00:14:42,880
gone there you are there for so much

427
00:14:42,880 --> 00:14:44,560
time because the telecom operators over

428
00:14:44,560 --> 00:14:46,720
there they send data back to the

429
00:14:46,720 --> 00:14:48,480
your main operator and they are always

430
00:14:48,480 --> 00:14:50,000
talking to each other using ss7 or

431
00:14:50,000 --> 00:14:51,680
different protocols

432
00:14:51,680 --> 00:14:52,639
okay

433
00:14:52,639 --> 00:14:56,160
so we deploy of cellul uh pseudo fake

434
00:14:56,160 --> 00:14:57,600
cellular network using open source

435
00:14:57,600 --> 00:15:00,560
deploy deployments like srs lte for 4g

436
00:15:00,560 --> 00:15:01,600
network

437
00:15:01,600 --> 00:15:04,160
this is a very famous or i would say of

438
00:15:04,160 --> 00:15:06,800
one of the best deployments of available

439
00:15:06,800 --> 00:15:09,120
right now for 4g networks and open bps

440
00:15:09,120 --> 00:15:10,800
open bts is

441
00:15:10,800 --> 00:15:13,040
old it's now deprecated the main there's

442
00:15:13,040 --> 00:15:14,639
no more maintenance going on but it's

443
00:15:14,639 --> 00:15:16,079
still one of the best choice you can

444
00:15:16,079 --> 00:15:19,120
also go for osmocom it's an amazing 2g

445
00:15:19,120 --> 00:15:20,800
implementation if you have a software

446
00:15:20,800 --> 00:15:22,079
defined radio

447
00:15:22,079 --> 00:15:25,360
in case of 4g now comes a big trick the

448
00:15:25,360 --> 00:15:28,160
big hurdle in 4g networks in 4g we have

449
00:15:28,160 --> 00:15:30,639
something called as private keys these

450
00:15:30,639 --> 00:15:32,240
private keys are basically used for

451
00:15:32,240 --> 00:15:34,079
mutual authentication

452
00:15:34,079 --> 00:15:36,560
in gsm in 2g and 2g networks what used

453
00:15:36,560 --> 00:15:38,720
to be that let's say you are a

454
00:15:38,720 --> 00:15:40,480
subscriber of a certain certain telecom

455
00:15:40,480 --> 00:15:42,560
operator and you try to go into your

456
00:15:42,560 --> 00:15:44,000
settings try to connect to a different

457
00:15:44,000 --> 00:15:45,040
operator

458
00:15:45,040 --> 00:15:46,959
there was no mutual authentication you

459
00:15:46,959 --> 00:15:48,639
could actually fool different operators

460
00:15:48,639 --> 00:15:51,040
to connect your device to the network in

461
00:15:51,040 --> 00:15:53,360
4g this is not possible in 4g you have

462
00:15:53,360 --> 00:15:56,399
to share something like hashes of your

463
00:15:56,399 --> 00:15:59,360
private key to your telecom operator

464
00:15:59,360 --> 00:16:01,360
then that hash goes into the management

465
00:16:01,360 --> 00:16:03,759
entity and those hashes accompanied oh

466
00:16:03,759 --> 00:16:05,759
this has is present in my database this

467
00:16:05,759 --> 00:16:08,000
guy belongs to my network let's give him

468
00:16:08,000 --> 00:16:10,720
access if this does not happen you won't

469
00:16:10,720 --> 00:16:14,079
be allowed to use any of the services

470
00:16:14,079 --> 00:16:15,839
and

471
00:16:15,839 --> 00:16:18,720
in in such situations so let's say you

472
00:16:18,720 --> 00:16:21,839
are using a commercial

473
00:16:21,839 --> 00:16:23,920
mobile operator sim card these sim cards

474
00:16:23,920 --> 00:16:25,680
are not going to get connected to your

475
00:16:25,680 --> 00:16:27,120
fake network because you don't have the

476
00:16:27,120 --> 00:16:29,440
private keys of those sim cards right so

477
00:16:29,440 --> 00:16:30,560
what do you do

478
00:16:30,560 --> 00:16:32,480
well gsm does not use mutual

479
00:16:32,480 --> 00:16:34,480
authentication right we just force the

480
00:16:34,480 --> 00:16:37,120
device to switch back to gsm and tell it

481
00:16:37,120 --> 00:16:38,959
no 4g network is available here please

482
00:16:38,959 --> 00:16:41,519
switch back to gsm it falls back to gsm

483
00:16:41,519 --> 00:16:43,600
on gsm there is no mutual authentication

484
00:16:43,600 --> 00:16:45,199
the device connects to your fake network

485
00:16:45,199 --> 00:16:48,399
and starts sending data all the way

486
00:16:48,399 --> 00:16:50,480
or you can use a programmable sim card

487
00:16:50,480 --> 00:16:52,079
cismo com is one of the best windows to

488
00:16:52,079 --> 00:16:53,279
do this

489
00:16:53,279 --> 00:16:55,440
and after this off after analyzing all

490
00:16:55,440 --> 00:16:57,600
these stakes and you have you are done

491
00:16:57,600 --> 00:16:59,440
with your entire setup then you start

492
00:16:59,440 --> 00:17:02,000
jamming and you jam you keep on jamming

493
00:17:02,000 --> 00:17:03,360
you're jamming until and there's a

494
00:17:03,360 --> 00:17:04,959
device connects to your fake network and

495
00:17:04,959 --> 00:17:08,000
then it starts throwing the data

496
00:17:08,000 --> 00:17:10,400
so this is my test bed that i had used a

497
00:17:10,400 --> 00:17:13,280
laptop for with wireshark and my 4g

498
00:17:13,280 --> 00:17:15,520
network deployment a smartphone for test

499
00:17:15,520 --> 00:17:17,280
purposes

500
00:17:17,280 --> 00:17:19,359
this smartphone was basically used this

501
00:17:19,359 --> 00:17:20,880
smartphone and the target device

502
00:17:20,880 --> 00:17:23,839
connects to the usrp so that's the usrp

503
00:17:23,839 --> 00:17:25,760
which runs your 4g network the

504
00:17:25,760 --> 00:17:27,520
smartphone on the target device uh

505
00:17:27,520 --> 00:17:30,480
connects to your network the smartphone

506
00:17:30,480 --> 00:17:32,080
the reason why i use a smartphone

507
00:17:32,080 --> 00:17:33,440
alongside with my target device is

508
00:17:33,440 --> 00:17:37,039
because on smartphone you can see

509
00:17:37,039 --> 00:17:39,039
different statistics of how what data

510
00:17:39,039 --> 00:17:41,039
rate is being coming on and you know

511
00:17:41,039 --> 00:17:42,640
what other characteristics of your

512
00:17:42,640 --> 00:17:45,120
pseudo network are able to be variable

513
00:17:45,120 --> 00:17:46,960
you are able to see because if you try

514
00:17:46,960 --> 00:17:49,280
to do the same over let's say an iot

515
00:17:49,280 --> 00:17:51,360
device or electric car you won't be able

516
00:17:51,360 --> 00:17:53,120
to see all these things a smartphone

517
00:17:53,120 --> 00:17:55,919
rooted smartphone with some amazing apps

518
00:17:55,919 --> 00:17:57,039
uh

519
00:17:57,039 --> 00:17:59,440
can give you a lot of information about

520
00:17:59,440 --> 00:18:01,520
this

521
00:18:01,520 --> 00:18:04,480
so this is what you get once you start

522
00:18:04,480 --> 00:18:07,360
sniffing and once you deploy it and

523
00:18:07,360 --> 00:18:08,080
the

524
00:18:08,080 --> 00:18:10,320
what whatever messages you get so over

525
00:18:10,320 --> 00:18:11,919
here as you can see the one which is

526
00:18:11,919 --> 00:18:13,520
highlighted rrc connection setup

527
00:18:13,520 --> 00:18:15,679
complete attach request pdm connectivity

528
00:18:15,679 --> 00:18:17,840
request so these are some some of the

529
00:18:17,840 --> 00:18:20,160
initial steps that needs to be done in

530
00:18:20,160 --> 00:18:22,080
order to you know

531
00:18:22,080 --> 00:18:22,960
uh

532
00:18:22,960 --> 00:18:24,960
identify a device and connect just like

533
00:18:24,960 --> 00:18:27,440
we have tcp handshake there are some

534
00:18:27,440 --> 00:18:28,640
handstands that need to be done in

535
00:18:28,640 --> 00:18:30,880
cellular networks after which the

536
00:18:30,880 --> 00:18:33,280
identity is confirmed and then your

537
00:18:33,280 --> 00:18:37,280
granted request as you can see below

538
00:18:37,760 --> 00:18:39,039
yeah

539
00:18:39,039 --> 00:18:40,799
so authentication response security mode

540
00:18:40,799 --> 00:18:43,280
command and then cipher message begins

541
00:18:43,280 --> 00:18:44,799
this happens in very later stage

542
00:18:44,799 --> 00:18:46,320
encryption begins at a very lateness

543
00:18:46,320 --> 00:18:49,120
before that whatever data whatever basic

544
00:18:49,120 --> 00:18:51,120
communication happens it's all in plain

545
00:18:51,120 --> 00:18:53,440
text this was a big flaw in 4g using

546
00:18:53,440 --> 00:18:54,480
this flaw

547
00:18:54,480 --> 00:18:57,039
you can easily study oh at what

548
00:18:57,039 --> 00:18:58,480
frequency is a cellular network running

549
00:18:58,480 --> 00:19:00,559
what is the base station id how you can

550
00:19:00,559 --> 00:19:02,240
even track users how many users are

551
00:19:02,240 --> 00:19:05,120
connected use or to the specific

552
00:19:05,120 --> 00:19:07,039
cellular network or that specific

553
00:19:07,039 --> 00:19:08,640
cellular power which is nearby in your

554
00:19:08,640 --> 00:19:10,720
vicinity those are very sophisticated

555
00:19:10,720 --> 00:19:13,200
attacks and you need a lot of great

556
00:19:13,200 --> 00:19:16,080
radios to carry out such research

557
00:19:16,080 --> 00:19:18,400
so at below uh sorry

558
00:19:18,400 --> 00:19:20,080
below you can see

559
00:19:20,080 --> 00:19:22,080
here mcc says return india or the reason

560
00:19:22,080 --> 00:19:24,320
why i have uh you know masked this

561
00:19:24,320 --> 00:19:25,840
information because this is all very

562
00:19:25,840 --> 00:19:27,840
crucial information and

563
00:19:27,840 --> 00:19:29,280
anyone can use this information to

564
00:19:29,280 --> 00:19:31,200
deploy the fake network

565
00:19:31,200 --> 00:19:32,640
so that's the reason why i have masked i

566
00:19:32,640 --> 00:19:33,760
don't want to get into any legal

567
00:19:33,760 --> 00:19:35,760
troubles

568
00:19:35,760 --> 00:19:38,000
mcc is india india has its own code i

569
00:19:38,000 --> 00:19:39,840
have done this i had carried out this

570
00:19:39,840 --> 00:19:43,039
research work uh in pune a city based

571
00:19:43,039 --> 00:19:45,919
out in maharashtra of india

572
00:19:45,919 --> 00:19:48,880
then you have an mnc so mnc what is what

573
00:19:48,880 --> 00:19:50,960
tells the network or which network are

574
00:19:50,960 --> 00:19:53,520
you in that's what it is and then it

575
00:19:53,520 --> 00:19:55,039
also tells the state so where it says

576
00:19:55,039 --> 00:19:57,440
maharashtra so it's a state in india

577
00:19:57,440 --> 00:19:59,520
then you have mma group id so remember i

578
00:19:59,520 --> 00:20:01,679
said mme is the one who manages all of

579
00:20:01,679 --> 00:20:03,840
your authentication and integrity and

580
00:20:03,840 --> 00:20:06,080
cryptography stuff once you know your

581
00:20:06,080 --> 00:20:07,600
mme group id

582
00:20:07,600 --> 00:20:09,919
you can track users oh this user belongs

583
00:20:09,919 --> 00:20:12,000
to this group id his encrypted key

584
00:20:12,000 --> 00:20:13,600
resides over there

585
00:20:13,600 --> 00:20:14,880
and if you are able to break in

586
00:20:14,880 --> 00:20:16,000
physically

587
00:20:16,000 --> 00:20:17,919
mme you can get access to the private

588
00:20:17,919 --> 00:20:20,640
keys don't do that

589
00:20:20,640 --> 00:20:22,400
then you have mme code and then you have

590
00:20:22,400 --> 00:20:24,320
timzy so these are some of the very

591
00:20:24,320 --> 00:20:25,760
crucial inform and this is all available

592
00:20:25,760 --> 00:20:28,480
in plain text you just need a rtl

593
00:20:28,480 --> 00:20:30,559
uh

594
00:20:30,559 --> 00:20:33,280
rtl sdr and bioshock just need to pipe

595
00:20:33,280 --> 00:20:35,280
it to irish and wire would dissect this

596
00:20:35,280 --> 00:20:37,360
things for you

597
00:20:37,360 --> 00:20:39,919
so once you get all this information and

598
00:20:39,919 --> 00:20:41,760
you study all of these messages one by

599
00:20:41,760 --> 00:20:43,120
one one by one

600
00:20:43,120 --> 00:20:45,600
now what attacks can you conduct using

601
00:20:45,600 --> 00:20:47,039
all of this information downgrade

602
00:20:47,039 --> 00:20:49,280
attacks as i told you because in 4g it's

603
00:20:49,280 --> 00:20:51,440
very difficult to force a device to get

604
00:20:51,440 --> 00:20:53,520
connected to your 4g network because of

605
00:20:53,520 --> 00:20:55,039
the hindrance of the private key not

606
00:20:55,039 --> 00:20:57,280
available you just downgraded you just

607
00:20:57,280 --> 00:20:59,520
tell the device you know hey right now

608
00:20:59,520 --> 00:21:01,440
over here in this vicinity there's no 4g

609
00:21:01,440 --> 00:21:03,919
network running please go back to gsm

610
00:21:03,919 --> 00:21:05,760
and the device will be sure if there's

611
00:21:05,760 --> 00:21:08,480
no 4g available and go back to gsm but

612
00:21:08,480 --> 00:21:11,039
uh gsm has one issue there's not enough

613
00:21:11,039 --> 00:21:13,200
bandwidth over gprs and edge network

614
00:21:13,200 --> 00:21:15,039
that's a big issue

615
00:21:15,039 --> 00:21:16,960
so the second thing is using the list of

616
00:21:16,960 --> 00:21:20,000
nearby area of cns or arfcs i was able

617
00:21:20,000 --> 00:21:21,919
to perform a redirection attack this is

618
00:21:21,919 --> 00:21:24,720
one of the most biggest flaw in 4g this

619
00:21:24,720 --> 00:21:27,039
was revealed and it has been fixed in 5g

620
00:21:27,039 --> 00:21:28,320
networks now

621
00:21:28,320 --> 00:21:30,159
so the thing is using your pseudo base

622
00:21:30,159 --> 00:21:33,360
station network you can tell a device if

623
00:21:33,360 --> 00:21:35,280
he is trying to connect to your network

624
00:21:35,280 --> 00:21:37,200
that you are not allowed to connect to

625
00:21:37,200 --> 00:21:39,520
me but yes i can give you access to my

626
00:21:39,520 --> 00:21:41,760
gsm network and tell him the frequency

627
00:21:41,760 --> 00:21:43,760
of my gsm network the smart the device

628
00:21:43,760 --> 00:21:45,600
goes and connect to your gsm network

629
00:21:45,600 --> 00:21:47,440
this is a huge flaw it should not happen

630
00:21:47,440 --> 00:21:48,960
i mean you're tracking you're tricking

631
00:21:48,960 --> 00:21:50,960
anyone you're taking users to connect to

632
00:21:50,960 --> 00:21:53,520
a cellular fake cellular network

633
00:21:53,520 --> 00:21:55,520
and this has been fixed now in 5g

634
00:21:55,520 --> 00:21:58,320
specifications

635
00:21:58,320 --> 00:22:00,799
then once the target device ue is good

636
00:22:00,799 --> 00:22:02,480
is getting uh it's connected to your

637
00:22:02,480 --> 00:22:04,720
pseudo network you can obtain all the ip

638
00:22:04,720 --> 00:22:06,640
packets whatever data has been flowing

639
00:22:06,640 --> 00:22:08,400
back into the internet and your device

640
00:22:08,400 --> 00:22:09,919
and everything

641
00:22:09,919 --> 00:22:13,520
using this you can use gps spoofing if

642
00:22:13,520 --> 00:22:15,440
you know how to do that let's not get

643
00:22:15,440 --> 00:22:17,440
into that that's not the topic right now

644
00:22:17,440 --> 00:22:19,440
sms proofing you can even manipulate the

645
00:22:19,440 --> 00:22:21,679
80 commands once you have access to the

646
00:22:21,679 --> 00:22:24,159
hardware let's say in next uh slides

647
00:22:24,159 --> 00:22:25,840
will come to know how we can combine all

648
00:22:25,840 --> 00:22:27,760
of these attacks and create a very big

649
00:22:27,760 --> 00:22:29,360
supply chain attack and compromise the

650
00:22:29,360 --> 00:22:31,760
device completely

651
00:22:31,760 --> 00:22:34,799
okay this is something that is the data

652
00:22:34,799 --> 00:22:37,039
you will find in your fake network once

653
00:22:37,039 --> 00:22:39,200
that device gets connected and has been

654
00:22:39,200 --> 00:22:41,520
fooled okay so i have masked the ip

655
00:22:41,520 --> 00:22:43,600
addresses where it's connected to

656
00:22:43,600 --> 00:22:45,840
over here you can see gps log vehicle

657
00:22:45,840 --> 00:22:47,520
info sensitive credentials blah blah

658
00:22:47,520 --> 00:22:48,799
blah

659
00:22:48,799 --> 00:22:51,760
this all is a malform package it's a

660
00:22:51,760 --> 00:22:54,720
packet data this goes to the cloud

661
00:22:54,720 --> 00:22:57,280
the ips are hard coded of the cloud into

662
00:22:57,280 --> 00:22:58,799
the device's firmware

663
00:22:58,799 --> 00:23:00,080
you are just sitting in middle it's a

664
00:23:00,080 --> 00:23:02,080
magnetometer attack a device getting

665
00:23:02,080 --> 00:23:03,520
talking to the cloud you're sitting in

666
00:23:03,520 --> 00:23:05,120
middle you're watching observing all the

667
00:23:05,120 --> 00:23:07,919
data okay now let's say over here there

668
00:23:07,919 --> 00:23:09,840
is lighter to the longitude you do a gps

669
00:23:09,840 --> 00:23:12,559
spoofing attack on the device you see

670
00:23:12,559 --> 00:23:15,200
the change in nitrogen longitude here

671
00:23:15,200 --> 00:23:17,919
now if this was in case of an electric

672
00:23:17,919 --> 00:23:19,840
vehicle let's say you have a app which

673
00:23:19,840 --> 00:23:22,559
shows where your car is right now it

674
00:23:22,559 --> 00:23:25,039
shows uh

675
00:23:25,039 --> 00:23:27,200
uh it might show where you're connected

676
00:23:27,200 --> 00:23:29,200
to and later on it will change your

677
00:23:29,200 --> 00:23:32,000
location you won't be able to figure out

678
00:23:32,000 --> 00:23:35,280
private apn attack so as i said apn

679
00:23:35,280 --> 00:23:37,200
settings are present in your smartphones

680
00:23:37,200 --> 00:23:39,120
uh these are pre-configured if you have

681
00:23:39,120 --> 00:23:41,039
a smartphone in electric vehicles and

682
00:23:41,039 --> 00:23:42,320
all these things

683
00:23:42,320 --> 00:23:44,400
uh it needs to be configured so when you

684
00:23:44,400 --> 00:23:45,600
buy a vehicle and all these are

685
00:23:45,600 --> 00:23:47,760
pre-configured by your

686
00:23:47,760 --> 00:23:49,520
manufacturers

687
00:23:49,520 --> 00:23:51,200
this is how if you are using a 4g

688
00:23:51,200 --> 00:23:53,520
network this is how you would set up a

689
00:23:53,520 --> 00:23:54,480
uh

690
00:23:54,480 --> 00:23:57,039
apn so first you go to your settings of

691
00:23:57,039 --> 00:23:58,720
cellular network scan for the network in

692
00:23:58,720 --> 00:24:01,600
this case the name is 90155 this was the

693
00:24:01,600 --> 00:24:04,240
name given to the network set up

694
00:24:04,240 --> 00:24:07,120
a private apn so srs lte tells you to

695
00:24:07,120 --> 00:24:08,960
set up a private api so that your data

696
00:24:08,960 --> 00:24:11,120
flows to the network very easily

697
00:24:11,120 --> 00:24:12,640
once you create this you just put to

698
00:24:12,640 --> 00:24:14,400
under to put the name name is srslt

699
00:24:14,400 --> 00:24:15,919
that's it nothing else see your username

700
00:24:15,919 --> 00:24:17,279
and password combination is given but we

701
00:24:17,279 --> 00:24:18,640
don't need to use it

702
00:24:18,640 --> 00:24:19,840
okay and this is in the case of

703
00:24:19,840 --> 00:24:21,840
smartphones in cars and iot devices you

704
00:24:21,840 --> 00:24:24,159
need to have this combination otherwise

705
00:24:24,159 --> 00:24:25,760
security is compromised

706
00:24:25,760 --> 00:24:27,440
and this is the bandwidth i was getting

707
00:24:27,440 --> 00:24:28,960
on the

708
00:24:28,960 --> 00:24:33,240
after it was connected to my network

709
00:24:33,360 --> 00:24:35,200
and the final vulnerability that we will

710
00:24:35,200 --> 00:24:37,360
be talking about is 80 command so uh

711
00:24:37,360 --> 00:24:39,120
cellular communication relies heavily on

712
00:24:39,120 --> 00:24:40,960
the baseband modem or the so-called

713
00:24:40,960 --> 00:24:42,880
basement processors in the smartphones

714
00:24:42,880 --> 00:24:44,320
and they are responsible for all the

715
00:24:44,320 --> 00:24:46,480
cellular communication that happens

716
00:24:46,480 --> 00:24:48,159
baseband modems are nothing but they are

717
00:24:48,159 --> 00:24:50,559
where they are they execute 80 commands

718
00:24:50,559 --> 00:24:53,200
and make sure they are communicating

719
00:24:53,200 --> 00:24:56,480
through your antennas to the nearby

720
00:24:56,480 --> 00:24:57,919
cell phone tower

721
00:24:57,919 --> 00:25:00,159
i was able to successfully been able to

722
00:25:00,159 --> 00:25:02,080
sniff the baseband communication from

723
00:25:02,080 --> 00:25:03,919
the target device and analyze the live

724
00:25:03,919 --> 00:25:05,279
communication between the device and the

725
00:25:05,279 --> 00:25:08,000
smartphone i was able to acquire a sms

726
00:25:08,000 --> 00:25:09,760
and call information i'll just show it

727
00:25:09,760 --> 00:25:11,200
how it was

728
00:25:11,200 --> 00:25:12,720
yeah so this is how the attack is

729
00:25:12,720 --> 00:25:14,240
carried down this is a usb to ttl

730
00:25:14,240 --> 00:25:15,279
converter

731
00:25:15,279 --> 00:25:16,480
uh this is used to connect to the

732
00:25:16,480 --> 00:25:19,200
interface or swi or ui interface of this

733
00:25:19,200 --> 00:25:21,440
device and on your terminal or laptop

734
00:25:21,440 --> 00:25:22,640
you get to

735
00:25:22,640 --> 00:25:26,480
so you you get all the information

736
00:25:26,480 --> 00:25:28,000
if you want to know more about this just

737
00:25:28,000 --> 00:25:30,240
go to smoke they have explained great in

738
00:25:30,240 --> 00:25:31,760
depth

739
00:25:31,760 --> 00:25:33,679
once you are set you have set up all

740
00:25:33,679 --> 00:25:35,760
these things i have used tool called qc

741
00:25:35,760 --> 00:25:37,039
super so this is basically a python

742
00:25:37,039 --> 00:25:39,200
script which

743
00:25:39,200 --> 00:25:41,679
once your hardware setup is complete it

744
00:25:41,679 --> 00:25:44,320
interfaces your laptop and your target

745
00:25:44,320 --> 00:25:46,240
device and make sure the communication

746
00:25:46,240 --> 00:25:48,320
is happening between them synchronously

747
00:25:48,320 --> 00:25:49,600
and then you can see and then you have

748
00:25:49,600 --> 00:25:51,760
to just pipe this data wireshark live

749
00:25:51,760 --> 00:25:54,240
and decrypt the traffic

750
00:25:54,240 --> 00:25:56,159
so you have to pipe all this data to

751
00:25:56,159 --> 00:25:57,919
wireshark

752
00:25:57,919 --> 00:25:59,520
this is some this is this is how you

753
00:25:59,520 --> 00:26:00,799
start getting the data from your

754
00:26:00,799 --> 00:26:02,159
smartphone

755
00:26:02,159 --> 00:26:04,799
uh baseband

756
00:26:04,799 --> 00:26:05,679
yeah

757
00:26:05,679 --> 00:26:07,440
this was the thing so this sms's are

758
00:26:07,440 --> 00:26:09,039
usually encrypted in this case i was

759
00:26:09,039 --> 00:26:11,760
able to get you can see here

760
00:26:11,760 --> 00:26:13,760
zero four six zero one four is the otp

761
00:26:13,760 --> 00:26:15,840
for transaction of this this this otp is

762
00:26:15,840 --> 00:26:17,279
added for 15 minutes from the request

763
00:26:17,279 --> 00:26:18,960
please do not share with anyone

764
00:26:18,960 --> 00:26:20,960
well you just shared with me so

765
00:26:20,960 --> 00:26:23,200
i know what the otp is and we were able

766
00:26:23,200 --> 00:26:26,320
to use this otp to

767
00:26:26,320 --> 00:26:28,240
make another device subscribe to the

768
00:26:28,240 --> 00:26:30,080
service and

769
00:26:30,080 --> 00:26:32,400
i mean a huge blog and why are we able

770
00:26:32,400 --> 00:26:34,080
to see this in plain text because we are

771
00:26:34,080 --> 00:26:35,360
logging everything from baseband

772
00:26:35,360 --> 00:26:37,279
remember sms is coming from your

773
00:26:37,279 --> 00:26:39,360
cellular tower to your smartphone from

774
00:26:39,360 --> 00:26:40,320
your smartphone it's going to your

775
00:26:40,320 --> 00:26:42,400
processor processor is decrypting it we

776
00:26:42,400 --> 00:26:45,520
are reading those decrypted messages

777
00:26:45,520 --> 00:26:46,799
no need of encryption you don't deal

778
00:26:46,799 --> 00:26:48,640
with encryption at the hardware layer

779
00:26:48,640 --> 00:26:50,000
everything has been done for you from

780
00:26:50,000 --> 00:26:51,600
the application your kernel and

781
00:26:51,600 --> 00:26:52,880
everything you are reading directly from

782
00:26:52,880 --> 00:26:55,200
the chip

783
00:26:55,600 --> 00:26:58,000
okay what are the mitigations so along

784
00:26:58,000 --> 00:27:00,159
with jamming detection i i feel that

785
00:27:00,159 --> 00:27:01,279
vendor should also provide driving

786
00:27:01,279 --> 00:27:02,880
prevention mechanisms

787
00:27:02,880 --> 00:27:04,159
for pseudo base station attack it is

788
00:27:04,159 --> 00:27:05,440
advised to use a two two factor

789
00:27:05,440 --> 00:27:06,880
authentication

790
00:27:06,880 --> 00:27:08,480
and for private api attack it is better

791
00:27:08,480 --> 00:27:11,200
to whitelist necessary ip and request

792
00:27:11,200 --> 00:27:13,039
made by any other ips so there's only

793
00:27:13,039 --> 00:27:14,559
specific ip addresses the device will

794
00:27:14,559 --> 00:27:16,559
talk to also one can ask the telecom

795
00:27:16,559 --> 00:27:17,840
operator to provide username password

796
00:27:17,840 --> 00:27:20,000
combo for a pin configuration this will

797
00:27:20,000 --> 00:27:22,159
improve your security and in case of 80

798
00:27:22,159 --> 00:27:23,279
comma vulnerability it's better to

799
00:27:23,279 --> 00:27:25,840
disable serial communication ports or

800
00:27:25,840 --> 00:27:27,520
pin outs and execution of system level

801
00:27:27,520 --> 00:27:29,440
commands or serial imports because

802
00:27:29,440 --> 00:27:31,120
sometimes modems give direct access to

803
00:27:31,120 --> 00:27:33,120
their linux interface and you can just

804
00:27:33,120 --> 00:27:35,120
execute linux commands and make system

805
00:27:35,120 --> 00:27:36,720
changes

806
00:27:36,720 --> 00:27:39,120
questions

807
00:27:41,670 --> 00:27:44,759
[Music]

808
00:27:44,799 --> 00:27:46,159
yeah

809
00:27:46,159 --> 00:27:48,240
yeah does

810
00:27:48,240 --> 00:27:50,399
sorry does the phone not then just step

811
00:27:50,399 --> 00:27:52,960
to another frequency it tries to so in

812
00:27:52,960 --> 00:27:54,240
that case you have to keep on jamming

813
00:27:54,240 --> 00:27:55,279
that's what i said you have to keep on

814
00:27:55,279 --> 00:27:57,039
jamming and jamming and jamming at some

815
00:27:57,039 --> 00:27:59,279
point it just stops looking for it and

816
00:27:59,279 --> 00:28:00,799
then once you know what is the frequency

817
00:28:00,799 --> 00:28:02,799
the smartphone is likely to connect to

818
00:28:02,799 --> 00:28:04,720
after jamming multiple frequencies you

819
00:28:04,720 --> 00:28:06,159
just deploy your fake network at that

820
00:28:06,159 --> 00:28:07,919
frequency it tries to go back to that

821
00:28:07,919 --> 00:28:09,520
and it's connected to your network you

822
00:28:09,520 --> 00:28:10,799
don't need to do anything else that's

823
00:28:10,799 --> 00:28:13,840
how you fool the modem

824
00:28:13,840 --> 00:28:17,360
anything else any other questions

825
00:28:20,399 --> 00:28:22,640
okay

826
00:28:22,640 --> 00:28:24,240
okay okay sure

827
00:28:24,240 --> 00:28:28,039
so thanks thanks a lot

