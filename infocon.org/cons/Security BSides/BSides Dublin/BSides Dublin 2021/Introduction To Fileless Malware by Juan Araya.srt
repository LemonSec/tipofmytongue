1
00:00:06,160 --> 00:00:07,839
so first of all thank you very much this

2
00:00:07,839 --> 00:00:09,360
is a great opportunity for me and very

3
00:00:09,360 --> 00:00:10,880
happy and very honored to be

4
00:00:10,880 --> 00:00:12,559
down here sharing about filed this

5
00:00:12,559 --> 00:00:14,080
malware i'm going to talk about what is

6
00:00:14,080 --> 00:00:16,160
false malware how an attack is performed

7
00:00:16,160 --> 00:00:18,000
using this type of technique

8
00:00:18,000 --> 00:00:19,840
and of course i'm gonna provide some a

9
00:00:19,840 --> 00:00:21,680
general recommendation that hopefully

10
00:00:21,680 --> 00:00:23,519
would be very useful for you to protect

11
00:00:23,519 --> 00:00:24,720
against this type of

12
00:00:24,720 --> 00:00:27,840
a threat so as i'm

13
00:00:27,840 --> 00:00:29,519
as you mentioned my name is juan raja

14
00:00:29,519 --> 00:00:31,119
i'm a have a bachelor degree in computer

15
00:00:31,119 --> 00:00:33,120
science i have also a master in cyber

16
00:00:33,120 --> 00:00:34,640
security

17
00:00:34,640 --> 00:00:38,000
thank god i hold several cyber security

18
00:00:38,000 --> 00:00:39,280
related

19
00:00:39,280 --> 00:00:41,680
certifications including you know the

20
00:00:41,680 --> 00:00:43,520
certified advanced security practitioner

21
00:00:43,520 --> 00:00:44,399
and some cloud

22
00:00:44,399 --> 00:00:47,600
certifications and feel feel free of

23
00:00:47,600 --> 00:00:49,120
course to add me as a contact on

24
00:00:49,120 --> 00:00:50,960
linkedin i'll be more than glad to

25
00:00:50,960 --> 00:00:53,120
interact and to clarify doubts after

26
00:00:53,120 --> 00:00:54,480
this session of course

27
00:00:54,480 --> 00:00:58,160
if you have any addition no question

28
00:00:58,160 --> 00:00:59,680
so the agenda is going to be extremely

29
00:00:59,680 --> 00:01:01,520
simple the agenda i'll provide a quick

30
00:01:01,520 --> 00:01:03,120
introduction about what is fileless

31
00:01:03,120 --> 00:01:04,479
malware

32
00:01:04,479 --> 00:01:07,520
how and of course what is malware then

33
00:01:07,520 --> 00:01:09,360
what is follow smart will how an attack

34
00:01:09,360 --> 00:01:11,439
is performed what is a risk what is the

35
00:01:11,439 --> 00:01:12,080
impact so

36
00:01:12,080 --> 00:01:13,920
those type of information i'll share

37
00:01:13,920 --> 00:01:15,439
during the introduction

38
00:01:15,439 --> 00:01:17,360
then we'll focus on what is living off

39
00:01:17,360 --> 00:01:19,520
the land what is lolping's you know well

40
00:01:19,520 --> 00:01:20,880
basically we're gonna

41
00:01:20,880 --> 00:01:23,840
use existing and legitimate tools

42
00:01:23,840 --> 00:01:24,640
against

43
00:01:24,640 --> 00:01:26,960
our victim that's the idea of living off

44
00:01:26,960 --> 00:01:28,159
the land

45
00:01:28,159 --> 00:01:29,439
so with the load beams we're going to

46
00:01:29,439 --> 00:01:31,439
use existing as i said libraries

47
00:01:31,439 --> 00:01:32,960
and we're going to use existing

48
00:01:32,960 --> 00:01:35,520
executable files scripts

49
00:01:35,520 --> 00:01:37,920
we will use good tools such as power

50
00:01:37,920 --> 00:01:38,560
shells

51
00:01:38,560 --> 00:01:41,759
such as stole my to cause damage

52
00:01:41,759 --> 00:01:43,439
finally i'll provide some general

53
00:01:43,439 --> 00:01:45,439
recommendations about how to detect

54
00:01:45,439 --> 00:01:47,920
and what to do to protect your company

55
00:01:47,920 --> 00:01:48,560
against

56
00:01:48,560 --> 00:01:51,920
far less malware attacks

57
00:01:51,920 --> 00:01:53,920
so let's go to the basics because before

58
00:01:53,920 --> 00:01:56,159
we go to file this malware so as you

59
00:01:56,159 --> 00:01:57,520
know what is malware malware is

60
00:01:57,520 --> 00:01:59,040
malicious it stands for malicious

61
00:01:59,040 --> 00:02:00,479
software there are several type of

62
00:02:00,479 --> 00:02:02,880
malicious software such as virus

63
00:02:02,880 --> 00:02:05,600
where normally you know the traditional

64
00:02:05,600 --> 00:02:07,360
a virus will require some sort of human

65
00:02:07,360 --> 00:02:08,000
interaction

66
00:02:08,000 --> 00:02:09,679
where someone will download something

67
00:02:09,679 --> 00:02:11,120
someone will execute

68
00:02:11,120 --> 00:02:13,120
a file someone will install an

69
00:02:13,120 --> 00:02:14,400
application

70
00:02:14,400 --> 00:02:16,480
and that executable file will perform

71
00:02:16,480 --> 00:02:18,400
some malicious actions such as delete

72
00:02:18,400 --> 00:02:20,080
files such as

73
00:02:20,080 --> 00:02:23,520
steal information or even download other

74
00:02:23,520 --> 00:02:24,879
type of malware

75
00:02:24,879 --> 00:02:27,040
the armor virus the one that that comes

76
00:02:27,040 --> 00:02:29,040
in the second

77
00:02:29,040 --> 00:02:31,120
you know picture we're talking about a

78
00:02:31,120 --> 00:02:33,360
virus that has the capability of

79
00:02:33,360 --> 00:02:36,000
encryption and or use obfuscation

80
00:02:36,000 --> 00:02:36,879
techniques to make

81
00:02:36,879 --> 00:02:38,239
very hard you know the reverse

82
00:02:38,239 --> 00:02:40,400
engineering process

83
00:02:40,400 --> 00:02:43,200
then the trojan will be toolset or

84
00:02:43,200 --> 00:02:44,959
application that you could download

85
00:02:44,959 --> 00:02:47,120
that looks legitimate or some of them

86
00:02:47,120 --> 00:02:48,800
you will download it because you want to

87
00:02:48,800 --> 00:02:50,800
avoid paying you know for the license

88
00:02:50,800 --> 00:02:53,840
in other words a piracy so people will

89
00:02:53,840 --> 00:02:55,440
download this type of application

90
00:02:55,440 --> 00:02:57,200
it will work as the way it is supposed

91
00:02:57,200 --> 00:02:59,200
to work however it also will be

92
00:02:59,200 --> 00:03:01,599
executing some other actions that will

93
00:03:01,599 --> 00:03:03,519
impact the confidentiality of the data

94
00:03:03,519 --> 00:03:05,599
maybe the integrity of the data or even

95
00:03:05,599 --> 00:03:06,159
more

96
00:03:06,159 --> 00:03:08,239
even the availability of the data the

97
00:03:08,239 --> 00:03:09,840
bots will be you know

98
00:03:09,840 --> 00:03:12,080
malicious software designed to take

99
00:03:12,080 --> 00:03:13,840
control of your computer

100
00:03:13,840 --> 00:03:15,840
and that way your computer will be

101
00:03:15,840 --> 00:03:18,000
computer or iot device of or

102
00:03:18,000 --> 00:03:20,800
mobile device will be receiving uh

103
00:03:20,800 --> 00:03:22,400
requests or commands and will be

104
00:03:22,400 --> 00:03:24,400
executing those commands such as okay

105
00:03:24,400 --> 00:03:26,720
all these computers are infected let's

106
00:03:26,720 --> 00:03:28,319
try to access

107
00:03:28,319 --> 00:03:31,200
a website so sooner or later that web

108
00:03:31,200 --> 00:03:33,440
server the resources of that web server

109
00:03:33,440 --> 00:03:34,400
will be consumed

110
00:03:34,400 --> 00:03:35,680
and that will cause a developed service

111
00:03:35,680 --> 00:03:37,680
attack the one will be a type of malware

112
00:03:37,680 --> 00:03:39,120
that will copy automatically it will

113
00:03:39,120 --> 00:03:41,040
automatically scan for computers that

114
00:03:41,040 --> 00:03:42,959
has a specific vulnerability

115
00:03:42,959 --> 00:03:45,760
and will automatically copy so there's

116
00:03:45,760 --> 00:03:46,000
no

117
00:03:46,000 --> 00:03:47,599
require of human interaction this

118
00:03:47,599 --> 00:03:49,840
spyware will be you know tools that are

119
00:03:49,840 --> 00:03:50,879
designed to

120
00:03:50,879 --> 00:03:52,640
spy whatever you type for example a

121
00:03:52,640 --> 00:03:55,280
keylogger then adword will be a

122
00:03:55,280 --> 00:03:58,640
malicious software designed to simulate

123
00:03:58,640 --> 00:04:00,000
clicks and that way the attacker will

124
00:04:00,000 --> 00:04:00,799
receive money

125
00:04:00,799 --> 00:04:04,640
in a in a legal way and runs

126
00:04:04,640 --> 00:04:06,080
you know ransomware is a terrible type

127
00:04:06,080 --> 00:04:07,840
of malware designed to

128
00:04:07,840 --> 00:04:09,519
take control of your computer you know

129
00:04:09,519 --> 00:04:11,200
host

130
00:04:11,200 --> 00:04:14,000
you know encrypt all your files and if

131
00:04:14,000 --> 00:04:14,640
and only if

132
00:04:14,640 --> 00:04:18,399
in theory you pay then in theory you you

133
00:04:18,399 --> 00:04:19,918
will be able to continue using your

134
00:04:19,918 --> 00:04:20,880
files

135
00:04:20,880 --> 00:04:22,560
of course it's not a good idea to pay

136
00:04:22,560 --> 00:04:24,160
it's better to be proactive and it's

137
00:04:24,160 --> 00:04:24,800
better to have

138
00:04:24,800 --> 00:04:27,280
very good backups and you know threat

139
00:04:27,280 --> 00:04:28,080
intelligence

140
00:04:28,080 --> 00:04:30,240
and proactively block those type of

141
00:04:30,240 --> 00:04:31,600
attack vectors

142
00:04:31,600 --> 00:04:33,600
how malware is normally distributed is

143
00:04:33,600 --> 00:04:34,720
distributed using

144
00:04:34,720 --> 00:04:36,720
email social engineering techniques you

145
00:04:36,720 --> 00:04:38,400
know by sending emails it looks

146
00:04:38,400 --> 00:04:39,600
legitimate that

147
00:04:39,600 --> 00:04:42,639
invite people to click on a hyperlink or

148
00:04:42,639 --> 00:04:44,639
to download an application

149
00:04:44,639 --> 00:04:47,120
for example um usb keys that has a

150
00:04:47,120 --> 00:04:48,000
malware

151
00:04:48,000 --> 00:04:50,320
using an autorun you know feature that

152
00:04:50,320 --> 00:04:51,520
as soon as you connect

153
00:04:51,520 --> 00:04:54,080
the usb key it will execute you know the

154
00:04:54,080 --> 00:04:55,520
malicious commands

155
00:04:55,520 --> 00:04:57,840
and nowadays because everybody use a

156
00:04:57,840 --> 00:04:59,919
mobile devices and we use uh

157
00:04:59,919 --> 00:05:02,000
several social media tools such as i

158
00:05:02,000 --> 00:05:03,840
don't know telegram or whatsapp

159
00:05:03,840 --> 00:05:06,400
which are good tools however attackers

160
00:05:06,400 --> 00:05:07,680
are using it to send

161
00:05:07,680 --> 00:05:10,960
by bookload suggest that use techniques

162
00:05:10,960 --> 00:05:12,880
such as tiny urls

163
00:05:12,880 --> 00:05:16,080
to encode and to send malicious

164
00:05:16,080 --> 00:05:19,919
hyperlinks so as i said

165
00:05:19,919 --> 00:05:21,520
there are many techniques in order to

166
00:05:21,520 --> 00:05:23,039
start this within the

167
00:05:23,039 --> 00:05:25,199
malware one of them is to use it is to

168
00:05:25,199 --> 00:05:27,360
use for example a typo squadron attack

169
00:05:27,360 --> 00:05:28,320
where they

170
00:05:28,320 --> 00:05:31,440
register urls that looks legitimate

171
00:05:31,440 --> 00:05:34,639
you know very similar to the official

172
00:05:34,639 --> 00:05:35,440
website

173
00:05:35,440 --> 00:05:38,479
so people could a fail on that

174
00:05:38,479 --> 00:05:41,520
attack or emails that looks legitimate

175
00:05:41,520 --> 00:05:43,199
that contains even the logos of the

176
00:05:43,199 --> 00:05:43,840
company

177
00:05:43,840 --> 00:05:45,919
the color coding you know of the of the

178
00:05:45,919 --> 00:05:47,280
company

179
00:05:47,280 --> 00:05:48,800
and of course as i said you know the

180
00:05:48,800 --> 00:05:50,960
famous usb drop key you know where you

181
00:05:50,960 --> 00:05:53,680
are basically using a rubber ducky

182
00:05:53,680 --> 00:05:56,080
usb key and people sooner or later will

183
00:05:56,080 --> 00:05:57,840
connect it to their personal device or

184
00:05:57,840 --> 00:05:59,360
to the com

185
00:05:59,360 --> 00:06:02,400
company computer

186
00:06:02,400 --> 00:06:05,039
now let's talk about fileless malware

187
00:06:05,039 --> 00:06:06,639
because this is another type of a

188
00:06:06,639 --> 00:06:08,479
malware attack

189
00:06:08,479 --> 00:06:10,880
down here the idea is to try to use good

190
00:06:10,880 --> 00:06:12,240
tools existing

191
00:06:12,240 --> 00:06:14,479
tools the idea is to avoid having to

192
00:06:14,479 --> 00:06:16,400
install an application

193
00:06:16,400 --> 00:06:18,240
without installing any malware we're

194
00:06:18,240 --> 00:06:19,680
going to use existing tools and

195
00:06:19,680 --> 00:06:22,000
legitimate tools to perform malicious

196
00:06:22,000 --> 00:06:23,120
attacks

197
00:06:23,120 --> 00:06:24,639
so for example what type of existing

198
00:06:24,639 --> 00:06:26,160
tools will be useful to perform a

199
00:06:26,160 --> 00:06:27,680
fileless malware attack we are talking

200
00:06:27,680 --> 00:06:28,479
about

201
00:06:28,479 --> 00:06:31,120
exploiting good tools from wmi to the

202
00:06:31,120 --> 00:06:32,880
windows management instrumentation

203
00:06:32,880 --> 00:06:35,520
tool from power shield or even just a

204
00:06:35,520 --> 00:06:36,319
common shell

205
00:06:36,319 --> 00:06:39,840
you know because all these tools

206
00:06:39,840 --> 00:06:42,639
has many useful libraries many useful

207
00:06:42,639 --> 00:06:44,319
already functions that enable you to

208
00:06:44,319 --> 00:06:45,759
perform reconnaissance to obtain

209
00:06:45,759 --> 00:06:46,960
information about

210
00:06:46,960 --> 00:06:49,680
the target computer to try to do

211
00:06:49,680 --> 00:06:51,440
pivoting to obtain information about

212
00:06:51,440 --> 00:06:52,720
older computers and

213
00:06:52,720 --> 00:06:54,880
that way you will be able to perform a

214
00:06:54,880 --> 00:06:56,880
lateral movement and attack other

215
00:06:56,880 --> 00:06:59,120
other equipments and of course it will

216
00:06:59,120 --> 00:07:01,039
give you more information even about

217
00:07:01,039 --> 00:07:02,560
what applications are installed

218
00:07:02,560 --> 00:07:06,160
what services are running so again

219
00:07:06,160 --> 00:07:08,720
as you might know on during a normal you

220
00:07:08,720 --> 00:07:10,479
know kilo chain one of the

221
00:07:10,479 --> 00:07:12,639
first action items is to do a good

222
00:07:12,639 --> 00:07:13,919
reconnaissance that that way you will be

223
00:07:13,919 --> 00:07:14,960
able to discover

224
00:07:14,960 --> 00:07:16,479
boone abilities that could be exploited

225
00:07:16,479 --> 00:07:18,800
so again the idea is to

226
00:07:18,800 --> 00:07:21,680
um perform this reconnaissance and then

227
00:07:21,680 --> 00:07:23,360
execute malicious commands

228
00:07:23,360 --> 00:07:26,639
using good tools so

229
00:07:26,639 --> 00:07:28,400
powershell is a good tool it's a very

230
00:07:28,400 --> 00:07:30,800
useful tool that enables us to perform

231
00:07:30,800 --> 00:07:31,520
you know

232
00:07:31,520 --> 00:07:35,039
a auto automate task a configure

233
00:07:35,039 --> 00:07:35,759
automatically

234
00:07:35,759 --> 00:07:38,240
several several devices for example to

235
00:07:38,240 --> 00:07:40,000
interact with active directory to

236
00:07:40,000 --> 00:07:41,759
interact with exchange

237
00:07:41,759 --> 00:07:44,639
you can obtain information about all

238
00:07:44,639 --> 00:07:46,800
your computers easily using powershell

239
00:07:46,800 --> 00:07:47,520
and there are many

240
00:07:47,520 --> 00:07:50,000
very useful uh you know common leds

241
00:07:50,000 --> 00:07:50,879
available

242
00:07:50,879 --> 00:07:52,960
on powershell to do good things just as

243
00:07:52,960 --> 00:07:53,919
an example down here

244
00:07:53,919 --> 00:07:56,080
i'm using just powershell just to

245
00:07:56,080 --> 00:07:57,599
perform a very simple backup you know

246
00:07:57,599 --> 00:07:59,199
with the copy item command

247
00:07:59,199 --> 00:08:01,120
you can do a very simple backup so as

248
00:08:01,120 --> 00:08:02,639
you can see powershell is good and it's

249
00:08:02,639 --> 00:08:04,000
already installed

250
00:08:04,000 --> 00:08:06,319
on most of the windows computers and

251
00:08:06,319 --> 00:08:08,639
servers

252
00:08:08,639 --> 00:08:11,280
another very useful tool is known as

253
00:08:11,280 --> 00:08:14,000
windows management association or wmi

254
00:08:14,000 --> 00:08:16,319
the lmi has something interesting wmi is

255
00:08:16,319 --> 00:08:17,759
a client server you know

256
00:08:17,759 --> 00:08:21,759
approach system where basically you can

257
00:08:21,759 --> 00:08:23,840
request for information or you can send

258
00:08:23,840 --> 00:08:24,960
instructions

259
00:08:24,960 --> 00:08:28,400
using uh dolimei in you know the

260
00:08:28,400 --> 00:08:31,280
wmi query language now these dollar

261
00:08:31,280 --> 00:08:32,880
mixes and the way it works is

262
00:08:32,880 --> 00:08:35,440
similar when you program using a object

263
00:08:35,440 --> 00:08:36,640
oriented programming

264
00:08:36,640 --> 00:08:39,679
so for wmi every single

265
00:08:39,679 --> 00:08:42,240
thing on the on the network and even on

266
00:08:42,240 --> 00:08:43,919
the devices and the components of the

267
00:08:43,919 --> 00:08:44,880
devices at the end

268
00:08:44,880 --> 00:08:47,040
are objects so we're talking about

269
00:08:47,040 --> 00:08:48,000
objects that has

270
00:08:48,000 --> 00:08:50,560
attributes and objects that has methods

271
00:08:50,560 --> 00:08:51,680
or actions

272
00:08:51,680 --> 00:08:54,000
that you can execute so for example it

273
00:08:54,000 --> 00:08:55,760
will be there will be a class for hard

274
00:08:55,760 --> 00:08:56,480
drive

275
00:08:56,480 --> 00:08:58,480
so when you reference the class of

276
00:08:58,480 --> 00:09:00,000
hardware you will be able to obtain

277
00:09:00,000 --> 00:09:01,680
attributes such as you know the size of

278
00:09:01,680 --> 00:09:04,480
the hard drive the type of hard drive

279
00:09:04,480 --> 00:09:05,920
and then you will be able to perform

280
00:09:05,920 --> 00:09:08,880
actions or methods so there will be

281
00:09:08,880 --> 00:09:10,399
multiple type of actions that you can

282
00:09:10,399 --> 00:09:12,160
perform against a

283
00:09:12,160 --> 00:09:15,200
a hardware a hard drive

284
00:09:15,200 --> 00:09:17,040
and as i said because this is a client

285
00:09:17,040 --> 00:09:18,959
server approach you will be able to send

286
00:09:18,959 --> 00:09:20,160
commands and you will be

287
00:09:20,160 --> 00:09:22,480
able to request information and the

288
00:09:22,480 --> 00:09:24,800
system will

289
00:09:24,800 --> 00:09:26,480
receive the instruction execute

290
00:09:26,480 --> 00:09:28,720
instructions and reply with the

291
00:09:28,720 --> 00:09:31,279
response or with the result of the

292
00:09:31,279 --> 00:09:33,920
execution of the action

293
00:09:33,920 --> 00:09:35,920
now you can combine these good tools you

294
00:09:35,920 --> 00:09:37,600
know for your for your good for example

295
00:09:37,600 --> 00:09:38,240
you can

296
00:09:38,240 --> 00:09:40,399
execute lmi commands using powershell as

297
00:09:40,399 --> 00:09:41,920
you can see down here there are several

298
00:09:41,920 --> 00:09:43,120
several of them already

299
00:09:43,120 --> 00:09:45,680
available several commonlets so if you

300
00:09:45,680 --> 00:09:47,920
execute get dash command you know dash

301
00:09:47,920 --> 00:09:49,040
now wmi

302
00:09:49,040 --> 00:09:50,560
you will be able to obtain information

303
00:09:50,560 --> 00:09:52,480
about the existing

304
00:09:52,480 --> 00:09:55,120
common leds that enable you to run wmi

305
00:09:55,120 --> 00:09:56,800
with powershell

306
00:09:56,800 --> 00:09:58,640
now there's another system in this case

307
00:09:58,640 --> 00:09:59,519
we're talking about the common

308
00:09:59,519 --> 00:10:01,440
information model or cmi you can

309
00:10:01,440 --> 00:10:05,360
again use cmi on powershell

310
00:10:05,360 --> 00:10:07,760
to obtain even more data about your

311
00:10:07,760 --> 00:10:09,279
device and perform some

312
00:10:09,279 --> 00:10:11,680
specific actions as you can see down

313
00:10:11,680 --> 00:10:12,320
here

314
00:10:12,320 --> 00:10:16,640
on this screenshot

315
00:10:16,640 --> 00:10:18,160
you can also perform different type of

316
00:10:18,160 --> 00:10:19,920
queries using different methods

317
00:10:19,920 --> 00:10:21,519
so for example look at here i'm trying

318
00:10:21,519 --> 00:10:23,200
to obtain information about you know

319
00:10:23,200 --> 00:10:25,519
logical disks that are on this computer

320
00:10:25,519 --> 00:10:27,760
just by running get wmi object you know

321
00:10:27,760 --> 00:10:29,839
win32 logical disk

322
00:10:29,839 --> 00:10:31,279
so with this command i was able to know

323
00:10:31,279 --> 00:10:34,720
you know the the id of the hard drive

324
00:10:34,720 --> 00:10:37,600
i know the size how many in space is

325
00:10:37,600 --> 00:10:38,640
still free

326
00:10:38,640 --> 00:10:41,040
and the name of the volume you can also

327
00:10:41,040 --> 00:10:41,920
perform some

328
00:10:41,920 --> 00:10:45,200
advanced e queries you know similar to

329
00:10:45,200 --> 00:10:47,839
a sql command you know select whatever

330
00:10:47,839 --> 00:10:49,040
you need from

331
00:10:49,040 --> 00:10:51,200
the element that you want to obtain

332
00:10:51,200 --> 00:10:52,079
information

333
00:10:52,079 --> 00:10:53,600
and again you will be able to obtain

334
00:10:53,600 --> 00:10:55,440
basically the same data with two

335
00:10:55,440 --> 00:10:56,000
different

336
00:10:56,000 --> 00:10:59,680
um techniques now

337
00:10:59,680 --> 00:11:02,240
powershell is good don't don't don't get

338
00:11:02,240 --> 00:11:03,360
me wrong you know i'm not saying the

339
00:11:03,360 --> 00:11:04,160
powershell

340
00:11:04,160 --> 00:11:06,160
powershell is is something that is bad

341
00:11:06,160 --> 00:11:07,279
you want to use

342
00:11:07,279 --> 00:11:09,519
however because it's so powerful

343
00:11:09,519 --> 00:11:11,200
attackers are using powershell to

344
00:11:11,200 --> 00:11:11,920
execute

345
00:11:11,920 --> 00:11:15,040
malicious actions directly on memory

346
00:11:15,040 --> 00:11:16,800
so what type of malicious actions they

347
00:11:16,800 --> 00:11:20,399
are trying to perform some

348
00:11:20,399 --> 00:11:22,079
reconnaissance of course as i mentioned

349
00:11:22,079 --> 00:11:23,680
figure printing

350
00:11:23,680 --> 00:11:25,200
obtain as much information about the

351
00:11:25,200 --> 00:11:26,959
operating system about the applications

352
00:11:26,959 --> 00:11:28,640
that are running obtain information

353
00:11:28,640 --> 00:11:29,360
about the

354
00:11:29,360 --> 00:11:32,320
services that are running uh try to get

355
00:11:32,320 --> 00:11:34,240
information about the user what type of

356
00:11:34,240 --> 00:11:34,880
privilege

357
00:11:34,880 --> 00:11:37,040
that user it has tried to perform you

358
00:11:37,040 --> 00:11:39,279
know escalation privilege

359
00:11:39,279 --> 00:11:42,079
and and many others they of course they

360
00:11:42,079 --> 00:11:42,880
will light

361
00:11:42,880 --> 00:11:45,760
on love to perform some create some sort

362
00:11:45,760 --> 00:11:47,279
of backdoor so they can come back

363
00:11:47,279 --> 00:11:49,040
whenever they want

364
00:11:49,040 --> 00:11:50,399
there are several techniques for

365
00:11:50,399 --> 00:11:52,079
persistence and i'll show you

366
00:11:52,079 --> 00:11:54,639
shortly a couple of them such as adding

367
00:11:54,639 --> 00:11:56,160
some of those commands that you need

368
00:11:56,160 --> 00:11:58,000
maybe on the windows registry maybe you

369
00:11:58,000 --> 00:11:59,839
can use the schedule

370
00:11:59,839 --> 00:12:02,880
a task scheduler so it will be executed

371
00:12:02,880 --> 00:12:04,160
you know whenever you

372
00:12:04,160 --> 00:12:06,399
want

373
00:12:07,920 --> 00:12:10,320
so as you can see down here again we are

374
00:12:10,320 --> 00:12:10,959
we can use

375
00:12:10,959 --> 00:12:12,800
a partial for figure printing in this

376
00:12:12,800 --> 00:12:14,880
case i'm using a dolan

377
00:12:14,880 --> 00:12:16,399
with window 32 and i'm obtaining

378
00:12:16,399 --> 00:12:17,920
information about this computer you know

379
00:12:17,920 --> 00:12:19,040
the computer that i'm

380
00:12:19,040 --> 00:12:22,000
that i'm analyzing so again this is for

381
00:12:22,000 --> 00:12:24,320
the fingerprint perspective you can use

382
00:12:24,320 --> 00:12:26,160
another command and power shield

383
00:12:26,160 --> 00:12:28,320
such as system info to obtain even more

384
00:12:28,320 --> 00:12:29,760
details you can know you know what

385
00:12:29,760 --> 00:12:32,000
operating system is it is running

386
00:12:32,000 --> 00:12:35,200
what type of processor it is using

387
00:12:35,200 --> 00:12:37,360
you can even know what hotfix are

388
00:12:37,360 --> 00:12:38,720
installed so when

389
00:12:38,720 --> 00:12:40,880
if you know what hotfix are installed

390
00:12:40,880 --> 00:12:42,720
you can also know which hotfix are not

391
00:12:42,720 --> 00:12:43,120
it's

392
00:12:43,120 --> 00:12:45,360
installed so which vulnerabilities you

393
00:12:45,360 --> 00:12:47,279
could try to exploit

394
00:12:47,279 --> 00:12:50,720
during this a process

395
00:12:51,360 --> 00:12:53,360
with wmi there's you don't have there

396
00:12:53,360 --> 00:12:56,240
are also other ways to execute wmi

397
00:12:56,240 --> 00:13:00,399
commands such as you know w mic or mic

398
00:13:00,399 --> 00:13:04,240
in this case i'm typing wwmic os get

399
00:13:04,240 --> 00:13:05,519
to obtain information about the

400
00:13:05,519 --> 00:13:07,519
operating system now know that it's

401
00:13:07,519 --> 00:13:09,519
running as an example windows 10

402
00:13:09,519 --> 00:13:13,120
enterprise evaluation 64-bit version

403
00:13:13,120 --> 00:13:15,200
so again this is for fingerprinting

404
00:13:15,200 --> 00:13:16,880
purposes before we

405
00:13:16,880 --> 00:13:20,639
start the actual attack we can know what

406
00:13:20,639 --> 00:13:22,399
products are installed so we

407
00:13:22,399 --> 00:13:23,760
obtain information about the operating

408
00:13:23,760 --> 00:13:25,519
system so now we can obtain information

409
00:13:25,519 --> 00:13:25,839
about

410
00:13:25,839 --> 00:13:27,360
products that are running on this

411
00:13:27,360 --> 00:13:29,120
specific computer so we know

412
00:13:29,120 --> 00:13:30,959
as an example that is running microsoft

413
00:13:30,959 --> 00:13:32,160
health in

414
00:13:32,160 --> 00:13:35,120
update health tools we can obtain some

415
00:13:35,120 --> 00:13:35,600
path

416
00:13:35,600 --> 00:13:38,000
where some data is is some applications

417
00:13:38,000 --> 00:13:39,440
ourselves we can obtain information

418
00:13:39,440 --> 00:13:40,000
about

419
00:13:40,000 --> 00:13:43,120
versions of products so again for

420
00:13:43,120 --> 00:13:44,240
fingerprinting purposes

421
00:13:44,240 --> 00:13:47,680
is extremely useful and if you want to

422
00:13:47,680 --> 00:13:48,480
know what

423
00:13:48,480 --> 00:13:50,399
process are running on that computer you

424
00:13:50,399 --> 00:13:52,399
can easily you do it you know by typing

425
00:13:52,399 --> 00:13:54,160
dolly mic processor list brief and

426
00:13:54,160 --> 00:13:54,639
obtain

427
00:13:54,639 --> 00:13:57,279
information about the the process id you

428
00:13:57,279 --> 00:13:58,160
can of course try

429
00:13:58,160 --> 00:14:01,440
maybe try to kill one of this process

430
00:14:01,440 --> 00:14:05,279
and you know play around with it

431
00:14:06,639 --> 00:14:09,279
so now the attackers know that

432
00:14:09,279 --> 00:14:11,040
powershell is extremely useful

433
00:14:11,040 --> 00:14:13,120
but powershell is not the only tool or

434
00:14:13,120 --> 00:14:15,600
wmi that can be used to make attacks

435
00:14:15,600 --> 00:14:17,199
the other way to make attacks using

436
00:14:17,199 --> 00:14:18,880
legitimate tools is by

437
00:14:18,880 --> 00:14:20,639
following the approach of living off the

438
00:14:20,639 --> 00:14:22,399
land you know also known as

439
00:14:22,399 --> 00:14:25,839
lol so again the idea here

440
00:14:25,839 --> 00:14:28,320
is a same as a aikido you know this

441
00:14:28,320 --> 00:14:29,120
martial art

442
00:14:29,120 --> 00:14:31,199
where you're trying to use the strength

443
00:14:31,199 --> 00:14:32,880
of your enemy to

444
00:14:32,880 --> 00:14:35,199
cause damage so now we're using the

445
00:14:35,199 --> 00:14:36,320
strength you know of

446
00:14:36,320 --> 00:14:38,320
existing tools legitimate tools for

447
00:14:38,320 --> 00:14:40,399
maintenance for monitoring

448
00:14:40,399 --> 00:14:42,800
for automation for network monitoring or

449
00:14:42,800 --> 00:14:44,399
network management

450
00:14:44,399 --> 00:14:48,480
to cause damage what type of tools

451
00:14:48,480 --> 00:14:50,320
i'm talking about so there are many look

452
00:14:50,320 --> 00:14:52,079
at here these are some

453
00:14:52,079 --> 00:14:54,720
a quick sample of executables that are

454
00:14:54,720 --> 00:14:56,880
that are part of the operating system

455
00:14:56,880 --> 00:14:59,920
like ps exact like w mic in

456
00:14:59,920 --> 00:15:02,800
cbc ms build you know many others that

457
00:15:02,800 --> 00:15:03,120
are

458
00:15:03,120 --> 00:15:05,440
a part of the operating system and of

459
00:15:05,440 --> 00:15:07,440
course some dlls dlls that are

460
00:15:07,440 --> 00:15:10,000
legitimate like the windows 32 dll

461
00:15:10,000 --> 00:15:13,440
that's a very useful um dll that is part

462
00:15:13,440 --> 00:15:14,800
of the operating system

463
00:15:14,800 --> 00:15:16,880
so down here the idea is to try to use

464
00:15:16,880 --> 00:15:19,279
them against the victim without the need

465
00:15:19,279 --> 00:15:20,480
of downloading

466
00:15:20,480 --> 00:15:23,760
additional malware um

467
00:15:23,760 --> 00:15:26,800
so that yeah so that's that's idea down

468
00:15:26,800 --> 00:15:28,240
here you know try to use legitimate

469
00:15:28,240 --> 00:15:29,440
tools to make them

470
00:15:29,440 --> 00:15:30,959
as you can see down here in this

471
00:15:30,959 --> 00:15:33,279
screenshot at the on the right

472
00:15:33,279 --> 00:15:35,360
i'm using a good tool in this case cert

473
00:15:35,360 --> 00:15:36,639
util

474
00:15:36,639 --> 00:15:39,279
this air util is normally used for

475
00:15:39,279 --> 00:15:40,320
management of

476
00:15:40,320 --> 00:15:42,880
certificates so i'm using search utils

477
00:15:42,880 --> 00:15:43,839
to hide

478
00:15:43,839 --> 00:15:45,759
a a source code that i want to steal

479
00:15:45,759 --> 00:15:47,199
inside a file

480
00:15:47,199 --> 00:15:50,720
named vpn.crt so that's

481
00:15:50,720 --> 00:15:52,399
that's a way that you can use you know

482
00:15:52,399 --> 00:15:54,320
existing tools tool succumbs to cause

483
00:15:54,320 --> 00:15:57,040
some damage

484
00:15:57,360 --> 00:15:58,959
so now let's try to understand a little

485
00:15:58,959 --> 00:16:01,360
bit more how a fileless malware attack

486
00:16:01,360 --> 00:16:02,320
is performed

487
00:16:02,320 --> 00:16:05,600
so it is it is a perform

488
00:16:05,600 --> 00:16:07,839
in different phases the first phase is

489
00:16:07,839 --> 00:16:09,920
using social engineering techniques

490
00:16:09,920 --> 00:16:12,480
to be able to have a some sort of shell

491
00:16:12,480 --> 00:16:14,000
you know a web shell

492
00:16:14,000 --> 00:16:16,320
a reverse shell you know from the target

493
00:16:16,320 --> 00:16:17,440
computer

494
00:16:17,440 --> 00:16:19,920
so you can do it using a phishing as an

495
00:16:19,920 --> 00:16:20,720
example you

496
00:16:20,720 --> 00:16:22,639
use you can use smishing you know by

497
00:16:22,639 --> 00:16:24,560
sending text messages

498
00:16:24,560 --> 00:16:27,519
uh you can use existing tools such as

499
00:16:27,519 --> 00:16:27,920
the

500
00:16:27,920 --> 00:16:29,519
browser exploitation framework as an

501
00:16:29,519 --> 00:16:31,680
example so you can try to hook the

502
00:16:31,680 --> 00:16:32,800
browser of the victim

503
00:16:32,800 --> 00:16:36,320
and that way once the victim access that

504
00:16:36,320 --> 00:16:38,560
website you will be able to interact use

505
00:16:38,560 --> 00:16:41,680
a metaexploit or other tools to send

506
00:16:41,680 --> 00:16:42,800
malicious commands

507
00:16:42,800 --> 00:16:44,800
but the idea again is just to have

508
00:16:44,800 --> 00:16:46,399
access to a shell

509
00:16:46,399 --> 00:16:49,360
once you have access to to a shell then

510
00:16:49,360 --> 00:16:50,079
let's try to

511
00:16:50,079 --> 00:16:52,959
use existing scripts existing libraries

512
00:16:52,959 --> 00:16:54,639
exists and binaries

513
00:16:54,639 --> 00:16:57,759
to cause damage

514
00:16:58,320 --> 00:17:01,279
so as i said in the first section is use

515
00:17:01,279 --> 00:17:02,880
social engineering techniques to

516
00:17:02,880 --> 00:17:05,199
take control of a shell or to have

517
00:17:05,199 --> 00:17:07,760
access to a shell on the target computer

518
00:17:07,760 --> 00:17:09,919
you can create a copy of an existing

519
00:17:09,919 --> 00:17:12,240
website you can clone it you can use a

520
00:17:12,240 --> 00:17:13,280
type of squadron

521
00:17:13,280 --> 00:17:16,559
and maybe send a sms or send an email

522
00:17:16,559 --> 00:17:19,520
with the hyperlink you can attach a file

523
00:17:19,520 --> 00:17:21,760
that will execute a

524
00:17:21,760 --> 00:17:24,240
malicious command and at the end will

525
00:17:24,240 --> 00:17:26,400
create a reverse a shield that will

526
00:17:26,400 --> 00:17:28,400
make the computer the victim to connect

527
00:17:28,400 --> 00:17:31,840
to the computer of the attacker

528
00:17:31,840 --> 00:17:33,919
okay so that's that's the deal down here

529
00:17:33,919 --> 00:17:35,760
on the social engineering

530
00:17:35,760 --> 00:17:38,640
section now you might think okay so i'm

531
00:17:38,640 --> 00:17:40,559
able to access this computer

532
00:17:40,559 --> 00:17:43,679
i'm able to have uh shell access but how

533
00:17:43,679 --> 00:17:44,559
i can

534
00:17:44,559 --> 00:17:47,679
be have persistence there are many ways

535
00:17:47,679 --> 00:17:50,400
one of them of the most common way is to

536
00:17:50,400 --> 00:17:51,120
try to

537
00:17:51,120 --> 00:17:53,600
hide some of those malicious commands

538
00:17:53,600 --> 00:17:54,480
inside

539
00:17:54,480 --> 00:17:57,600
entries on your windows registry so that

540
00:17:57,600 --> 00:17:58,240
way

541
00:17:58,240 --> 00:17:59,520
the information is going to be there

542
00:17:59,520 --> 00:18:01,120
available and of course you can use you

543
00:18:01,120 --> 00:18:01,440
know

544
00:18:01,440 --> 00:18:04,480
like task schedulers like chrome in

545
00:18:04,480 --> 00:18:08,919
in linux or um schedule you know c

546
00:18:08,919 --> 00:18:11,600
schtask.exe to schedule

547
00:18:11,600 --> 00:18:15,039
uh recurrent tasks

548
00:18:15,039 --> 00:18:17,120
so now let's try to simulate an attack

549
00:18:17,120 --> 00:18:18,799
so for example let's say that i said

550
00:18:18,799 --> 00:18:20,240
that i was able to send an

551
00:18:20,240 --> 00:18:23,520
sms or i send an email addre an email

552
00:18:23,520 --> 00:18:27,600
someone click on that email that email a

553
00:18:27,600 --> 00:18:30,640
ask the person to accept a website

554
00:18:30,640 --> 00:18:32,960
on the website with browser expectation

555
00:18:32,960 --> 00:18:33,919
framework i was

556
00:18:33,919 --> 00:18:36,480
able to send them a payload they execute

557
00:18:36,480 --> 00:18:37,520
the payload and now

558
00:18:37,520 --> 00:18:40,559
boom i have access to a shell so once i

559
00:18:40,559 --> 00:18:42,080
have access to the shell

560
00:18:42,080 --> 00:18:45,440
is where the body will start

561
00:18:45,440 --> 00:18:48,559
so in this example i'm going to simulate

562
00:18:48,559 --> 00:18:50,000
an attack where i'm going to try to

563
00:18:50,000 --> 00:18:52,559
steal information using files malware

564
00:18:52,559 --> 00:18:54,240
approach so how i'm going to steal

565
00:18:54,240 --> 00:18:56,000
information i'm going to try to look for

566
00:18:56,000 --> 00:18:57,840
data that is relevant you know data that

567
00:18:57,840 --> 00:18:59,120
i could sell

568
00:18:59,120 --> 00:19:01,600
on the deep web data that could cause

569
00:19:01,600 --> 00:19:02,240
damage

570
00:19:02,240 --> 00:19:05,360
to the company um data that maybe the

571
00:19:05,360 --> 00:19:07,039
company will be willing to pay you know

572
00:19:07,039 --> 00:19:09,440
in order to try to recover so i'm trying

573
00:19:09,440 --> 00:19:10,320
to

574
00:19:10,320 --> 00:19:12,000
look for information that has pii you

575
00:19:12,000 --> 00:19:13,440
know personal edit file information

576
00:19:13,440 --> 00:19:14,960
maybe some excel files that contain

577
00:19:14,960 --> 00:19:16,640
information about their customers

578
00:19:16,640 --> 00:19:19,919
about new products um pdf backups you

579
00:19:19,919 --> 00:19:20,880
know logs whatever

580
00:19:20,880 --> 00:19:22,640
it is useful for the company that could

581
00:19:22,640 --> 00:19:24,799
be useful for the attacker to

582
00:19:24,799 --> 00:19:27,919
earn money so just on this example i

583
00:19:27,919 --> 00:19:30,320
may be down here on the documents a

584
00:19:30,320 --> 00:19:31,120
folder

585
00:19:31,120 --> 00:19:32,880
there are a couple of files in this case

586
00:19:32,880 --> 00:19:36,000
a customer.tax file and a server.txt

587
00:19:36,000 --> 00:19:37,360
file imagine that this could contain

588
00:19:37,360 --> 00:19:39,600
maybe a list of existing customers

589
00:19:39,600 --> 00:19:40,880
with their email address with their

590
00:19:40,880 --> 00:19:42,480
phone number with their full name with

591
00:19:42,480 --> 00:19:44,400
their position

592
00:19:44,400 --> 00:19:46,400
on on the servers maybe down here this

593
00:19:46,400 --> 00:19:47,919
file could contain data about you know

594
00:19:47,919 --> 00:19:50,160
ip address the operating system adapt

595
00:19:50,160 --> 00:19:50,880
server

596
00:19:50,880 --> 00:19:52,799
maybe the name of that server the

597
00:19:52,799 --> 00:19:53,919
function or

598
00:19:53,919 --> 00:19:56,240
service that that web server or server

599
00:19:56,240 --> 00:19:57,919
is offering

600
00:19:57,919 --> 00:20:00,240
so you can it could be useful for many

601
00:20:00,240 --> 00:20:02,320
purposes

602
00:20:02,320 --> 00:20:04,880
so the first step will be okay let's try

603
00:20:04,880 --> 00:20:06,000
to steal the data so

604
00:20:06,000 --> 00:20:08,080
the first step will be to have a copy of

605
00:20:08,080 --> 00:20:09,440
the data see

606
00:20:09,440 --> 00:20:11,760
the create a zip file with the copy of

607
00:20:11,760 --> 00:20:13,520
those two files that i'm trying to steal

608
00:20:13,520 --> 00:20:15,440
you know remember the customer

609
00:20:15,440 --> 00:20:17,760
and the server txt files inside and zip

610
00:20:17,760 --> 00:20:20,159
file in this case gold.zip

611
00:20:20,159 --> 00:20:22,159
okay so that's it i'm just creating a

612
00:20:22,159 --> 00:20:24,240
zip file with information that i want to

613
00:20:24,240 --> 00:20:25,280
steal

614
00:20:25,280 --> 00:20:27,200
again as you can see down here i'm using

615
00:20:27,200 --> 00:20:28,960
powershell commands

616
00:20:28,960 --> 00:20:31,600
and i'm using compressed.archive i'm not

617
00:20:31,600 --> 00:20:32,799
installing anything

618
00:20:32,799 --> 00:20:35,520
else to be able to perform this action

619
00:20:35,520 --> 00:20:36,880
item

620
00:20:36,880 --> 00:20:39,440
then once i have a copy of the data i

621
00:20:39,440 --> 00:20:41,520
want to delete the original files how do

622
00:20:41,520 --> 00:20:43,440
i delete the original files using

623
00:20:43,440 --> 00:20:45,600
digital tools i'm using powershell i'm

624
00:20:45,600 --> 00:20:46,720
using the remove

625
00:20:46,720 --> 00:20:49,760
item command this remove item is kind of

626
00:20:49,760 --> 00:20:51,520
kind of interesting because when you

627
00:20:51,520 --> 00:20:52,799
execute this command

628
00:20:52,799 --> 00:20:55,200
it will not only delete the file it but

629
00:20:55,200 --> 00:20:56,960
also will delete the file from the

630
00:20:56,960 --> 00:21:00,159
um recycle bin so there's

631
00:21:00,159 --> 00:21:02,559
it will not be so easy to to recover

632
00:21:02,559 --> 00:21:03,440
that file

633
00:21:03,440 --> 00:21:06,559
using this technique

634
00:21:07,919 --> 00:21:11,120
now we were able to save the file

635
00:21:11,120 --> 00:21:12,640
delete the original files and now we

636
00:21:12,640 --> 00:21:14,480
want to encrypt the file how can we

637
00:21:14,480 --> 00:21:16,159
encrypt the file without

638
00:21:16,159 --> 00:21:18,640
downloading a ransomware so this is a

639
00:21:18,640 --> 00:21:20,000
very easy way to do it

640
00:21:20,000 --> 00:21:21,840
we are going to use an existing service

641
00:21:21,840 --> 00:21:23,679
that is designed to encrypt files it's

642
00:21:23,679 --> 00:21:25,280
part of windows and in this case i'm

643
00:21:25,280 --> 00:21:26,640
talking about the crypt

644
00:21:26,640 --> 00:21:30,080
svc service so the first the first thing

645
00:21:30,080 --> 00:21:30,640
that you have

646
00:21:30,640 --> 00:21:32,559
to do is to check if that service is

647
00:21:32,559 --> 00:21:34,640
running how you can check it down here

648
00:21:34,640 --> 00:21:37,600
you can make a wmi query select

649
00:21:37,600 --> 00:21:39,039
everything from these

650
00:21:39,039 --> 00:21:41,760
windows 32 service list and you want to

651
00:21:41,760 --> 00:21:42,799
know if it is running

652
00:21:42,799 --> 00:21:45,600
and if this specific service is running

653
00:21:45,600 --> 00:21:45,840
i

654
00:21:45,840 --> 00:21:47,360
execute this command and you can see

655
00:21:47,360 --> 00:21:49,600
it's running and it's active

656
00:21:49,600 --> 00:21:52,799
perfect so let's use it so how can we

657
00:21:52,799 --> 00:21:54,400
use it we are going to use another

658
00:21:54,400 --> 00:21:56,159
existing command that is part of windows

659
00:21:56,159 --> 00:21:57,600
you can even test it if you want it's

660
00:21:57,600 --> 00:21:58,720
already

661
00:21:58,720 --> 00:22:00,799
installed on most of the windows

662
00:22:00,799 --> 00:22:01,760
versions

663
00:22:01,760 --> 00:22:04,679
if you type cipher in this case the

664
00:22:04,679 --> 00:22:07,120
gold.c file that i just created is not

665
00:22:07,120 --> 00:22:09,520
encrypted so that's why it has a u

666
00:22:09,520 --> 00:22:11,440
so in order to make it even a little bit

667
00:22:11,440 --> 00:22:12,559
more complex i could

668
00:22:12,559 --> 00:22:14,320
even create my own keys and my own

669
00:22:14,320 --> 00:22:16,080
certificate if i want

670
00:22:16,080 --> 00:22:17,840
as you can see by using the same command

671
00:22:17,840 --> 00:22:20,240
cipher and then create my own keys it

672
00:22:20,240 --> 00:22:21,760
will create a server file and it will

673
00:22:21,760 --> 00:22:22,960
create a p

674
00:22:22,960 --> 00:22:26,400
f x file that will contain as i said the

675
00:22:26,400 --> 00:22:29,360
key and the certificate now once the

676
00:22:29,360 --> 00:22:30,960
file has been encrypted

677
00:22:30,960 --> 00:22:32,880
the goal i'm sorry once the once the

678
00:22:32,880 --> 00:22:34,559
keys has been encrypted the goal will be

679
00:22:34,559 --> 00:22:36,080
to encrypt the file

680
00:22:36,080 --> 00:22:38,640
using the same command cipher we can

681
00:22:38,640 --> 00:22:40,159
encrypt the file how we can encrypt it

682
00:22:40,159 --> 00:22:41,360
by using cipher

683
00:22:41,360 --> 00:22:44,559
slash e stands for encrypt and the name

684
00:22:44,559 --> 00:22:46,799
of the file that we want to encrypt

685
00:22:46,799 --> 00:22:49,840
so i type cipher slash e gold.zip

686
00:22:49,840 --> 00:22:52,000
and now i if i run again this cipher

687
00:22:52,000 --> 00:22:53,840
command i'll be able to see that now it

688
00:22:53,840 --> 00:22:54,320
says

689
00:22:54,320 --> 00:22:57,360
e gold.zip because that now

690
00:22:57,360 --> 00:23:00,000
it confirms that the file with the zip

691
00:23:00,000 --> 00:23:02,400
file has been encrypted

692
00:23:02,400 --> 00:23:05,200
now with these ciphers sometimes there

693
00:23:05,200 --> 00:23:05,840
are some

694
00:23:05,840 --> 00:23:07,840
portions of the file that could be

695
00:23:07,840 --> 00:23:09,360
easily recovered that are

696
00:23:09,360 --> 00:23:12,240
in plain text in order to make the

697
00:23:12,240 --> 00:23:14,400
recovery process a lot harder if you

698
00:23:14,400 --> 00:23:15,679
don't have a backup

699
00:23:15,679 --> 00:23:17,200
then there's another command that you

700
00:23:17,200 --> 00:23:18,960
can run to remove

701
00:23:18,960 --> 00:23:21,600
any remaining sections of the file that

702
00:23:21,600 --> 00:23:22,240
is still

703
00:23:22,240 --> 00:23:24,559
in plain text in this case you're gonna

704
00:23:24,559 --> 00:23:25,520
execute this

705
00:23:25,520 --> 00:23:28,640
this command okay it takes a little bit

706
00:23:28,640 --> 00:23:30,559
it takes a couple of minutes but at the

707
00:23:30,559 --> 00:23:31,360
end

708
00:23:31,360 --> 00:23:34,159
it will delete all those remaining of

709
00:23:34,159 --> 00:23:35,840
the original file that are still in

710
00:23:35,840 --> 00:23:38,399
plain text

711
00:23:38,960 --> 00:23:41,760
now i was able to encrypt the file i was

712
00:23:41,760 --> 00:23:43,279
able to save the file

713
00:23:43,279 --> 00:23:46,400
delete the original files and now what i

714
00:23:46,400 --> 00:23:47,600
need to find a way to

715
00:23:47,600 --> 00:23:51,360
have a copy of that zip file right so

716
00:23:51,360 --> 00:23:54,640
in order to try to hide the c file i'm

717
00:23:54,640 --> 00:23:56,159
going to use a steganography

718
00:23:56,159 --> 00:23:58,320
how can i use a steganography i'm going

719
00:23:58,320 --> 00:24:00,720
to use i'm going to create a picture

720
00:24:00,720 --> 00:24:02,000
because i don't want to download

721
00:24:02,000 --> 00:24:04,799
anything if i start downloading files

722
00:24:04,799 --> 00:24:08,159
most likely some hey you know alert

723
00:24:08,159 --> 00:24:09,760
school got trigger so in order to avoid

724
00:24:09,760 --> 00:24:11,279
alerts to go trigger i could use an

725
00:24:11,279 --> 00:24:12,960
existing tool in this case

726
00:24:12,960 --> 00:24:16,000
fs util file create new i'm going to

727
00:24:16,000 --> 00:24:17,520
specify the name of the file in this

728
00:24:17,520 --> 00:24:18,799
case it's going to be

729
00:24:18,799 --> 00:24:22,640
um a bmp file yeah you specify the

730
00:24:22,640 --> 00:24:25,440
size that i want of the cover file why

731
00:24:25,440 --> 00:24:27,360
this is important because

732
00:24:27,360 --> 00:24:30,159
the cover file needs to be big enough in

733
00:24:30,159 --> 00:24:31,360
order to be able

734
00:24:31,360 --> 00:24:33,679
so we can include and we can hide inside

735
00:24:33,679 --> 00:24:34,400
of it

736
00:24:34,400 --> 00:24:36,880
whatever we want so it has to be bigger

737
00:24:36,880 --> 00:24:38,400
than what we want to hide

738
00:24:38,400 --> 00:24:40,159
so that's why in this case i'm selecting

739
00:24:40,159 --> 00:24:42,080
58 in

740
00:24:42,080 --> 00:24:44,320
in this case you know 58 kilobytes the

741
00:24:44,320 --> 00:24:46,480
reader file is just 1k but i want to

742
00:24:46,480 --> 00:24:48,320
make it big enough to

743
00:24:48,320 --> 00:24:51,120
not trigger too many alerts okay so this

744
00:24:51,120 --> 00:24:53,120
is just a picture that has been created

745
00:24:53,120 --> 00:24:54,720
automatically

746
00:24:54,720 --> 00:24:56,240
and now i'm going to use a steganography

747
00:24:56,240 --> 00:24:58,159
to hide that dc file

748
00:24:58,159 --> 00:25:01,360
inside the picture so i'm using the copy

749
00:25:01,360 --> 00:25:03,200
command that is already on part of

750
00:25:03,200 --> 00:25:04,640
windows i'm going to use

751
00:25:04,640 --> 00:25:07,279
copy slash b because i want to modify

752
00:25:07,279 --> 00:25:08,000
the

753
00:25:08,000 --> 00:25:11,039
cover file in binary mode

754
00:25:11,039 --> 00:25:13,360
and hide the gold.zip inside this

755
00:25:13,360 --> 00:25:14,159
picture and

756
00:25:14,159 --> 00:25:16,880
it's going to create a second picture

757
00:25:16,880 --> 00:25:17,919
that will contain

758
00:25:17,919 --> 00:25:20,880
the zip file that is hidden using some

759
00:25:20,880 --> 00:25:22,640
sort of a

760
00:25:22,640 --> 00:25:25,279
steganography algorithm it could be most

761
00:25:25,279 --> 00:25:27,679
likely a lsp you know the list

762
00:25:27,679 --> 00:25:30,320
this significant bit but at the end on

763
00:25:30,320 --> 00:25:31,200
this picture

764
00:25:31,200 --> 00:25:34,720
is where dc file is going to be in

765
00:25:34,720 --> 00:25:36,640
height and of course i'm going to use

766
00:25:36,640 --> 00:25:38,159
the same commander that i used

767
00:25:38,159 --> 00:25:39,840
a few minutes ago i'm going to use the

768
00:25:39,840 --> 00:25:43,520
remove item to remove or to delete

769
00:25:43,520 --> 00:25:45,840
in a permanent way the c file that i

770
00:25:45,840 --> 00:25:47,039
create and also

771
00:25:47,039 --> 00:25:50,000
remove in a permanent way the curve the

772
00:25:50,000 --> 00:25:51,200
temporal cover file

773
00:25:51,200 --> 00:25:53,840
that i create

774
00:25:54,400 --> 00:25:57,120
now this is this is where it gets really

775
00:25:57,120 --> 00:25:58,320
interesting you know again

776
00:25:58,320 --> 00:26:00,480
i i was able to encrypt the file now how

777
00:26:00,480 --> 00:26:02,240
can i obtain a copy of the file

778
00:26:02,240 --> 00:26:05,520
using existing tools so i could use

779
00:26:05,520 --> 00:26:07,520
windows defender for that

780
00:26:07,520 --> 00:26:09,440
it looks kind of similar or kind of kind

781
00:26:09,440 --> 00:26:11,200
of interesting right that the tool that

782
00:26:11,200 --> 00:26:11,520
is

783
00:26:11,520 --> 00:26:13,279
that is designed to defend could be used

784
00:26:13,279 --> 00:26:15,440
also to attack

785
00:26:15,440 --> 00:26:17,840
but this is not something like a failure

786
00:26:17,840 --> 00:26:19,200
from windows offender it could it could

787
00:26:19,200 --> 00:26:19,919
be done by

788
00:26:19,919 --> 00:26:22,559
a using other type of tools and even

789
00:26:22,559 --> 00:26:23,440
order

790
00:26:23,440 --> 00:26:26,000
so security solutions so this is just an

791
00:26:26,000 --> 00:26:27,039
example i'm not saying that windows

792
00:26:27,039 --> 00:26:28,480
defender is not a good tool i'm just

793
00:26:28,480 --> 00:26:29,120
saying that

794
00:26:29,120 --> 00:26:30,240
this is something that could be

795
00:26:30,240 --> 00:26:33,200
exploited so i'm using a legitimate tool

796
00:26:33,200 --> 00:26:35,240
from windows offender conflict

797
00:26:35,240 --> 00:26:36,559
securitypolicy.exe

798
00:26:36,559 --> 00:26:39,200
i'm specifying which file i want to

799
00:26:39,200 --> 00:26:40,000
receive

800
00:26:40,000 --> 00:26:42,960
and where i want to send it so that way

801
00:26:42,960 --> 00:26:44,880
the attacker was able to obtain

802
00:26:44,880 --> 00:26:48,000
the information then

803
00:26:48,000 --> 00:26:50,960
after this the data has been obtained

804
00:26:50,960 --> 00:26:52,960
now the attacker needs to delete his

805
00:26:52,960 --> 00:26:54,080
tracks

806
00:26:54,080 --> 00:26:57,279
a way to delete tracks will be by maybe

807
00:26:57,279 --> 00:26:59,440
going to the event viewer and deleting

808
00:26:59,440 --> 00:27:02,080
a specific tracks or if specific records

809
00:27:02,080 --> 00:27:03,039
from the

810
00:27:03,039 --> 00:27:05,600
event viewer but if you don't have time

811
00:27:05,600 --> 00:27:06,480
you need to delete

812
00:27:06,480 --> 00:27:09,039
it all in one shot you can easily do it

813
00:27:09,039 --> 00:27:09,600
using

814
00:27:09,600 --> 00:27:11,760
powershell by running this command you

815
00:27:11,760 --> 00:27:12,960
know get even locked

816
00:27:12,960 --> 00:27:15,120
lock name delete everything you see it's

817
00:27:15,120 --> 00:27:17,520
a recursive um

818
00:27:17,520 --> 00:27:21,360
action so in just less than one minute

819
00:27:21,360 --> 00:27:22,720
yeah less than one just a couple of

820
00:27:22,720 --> 00:27:25,120
seconds the the event viewer

821
00:27:25,120 --> 00:27:28,640
will be um deleted every single record

822
00:27:28,640 --> 00:27:30,559
so as you can see before i run this

823
00:27:30,559 --> 00:27:32,720
command it had like seven

824
00:27:32,720 --> 00:27:35,600
almost 8 000 events and after i run this

825
00:27:35,600 --> 00:27:37,360
command there was only one that

826
00:27:37,360 --> 00:27:41,120
that is left and which is that one that

827
00:27:41,120 --> 00:27:43,679
reflects that the audio logs has been

828
00:27:43,679 --> 00:27:45,919
clear

829
00:27:47,200 --> 00:27:50,799
and then well this is just i am and

830
00:27:50,799 --> 00:27:51,840
just the beginning you know you can

831
00:27:51,840 --> 00:27:54,159
continue playing around you can leave a

832
00:27:54,159 --> 00:27:56,720
ransom message like this one you know

833
00:27:56,720 --> 00:27:59,440
you can ask for money or what whatever

834
00:27:59,440 --> 00:28:01,760
is the objective of this is malware

835
00:28:01,760 --> 00:28:04,000
attack

836
00:28:04,799 --> 00:28:06,559
now how can you protect against this

837
00:28:06,559 --> 00:28:08,000
type of attack vector

838
00:28:08,000 --> 00:28:10,559
so it is really interesting and it's not

839
00:28:10,559 --> 00:28:12,559
not that easy it's a multi-layer

840
00:28:12,559 --> 00:28:13,919
solution that you have to

841
00:28:13,919 --> 00:28:16,399
implement in order to detect in order to

842
00:28:16,399 --> 00:28:17,600
mitigate

843
00:28:17,600 --> 00:28:20,640
um in order to be able to recover also

844
00:28:20,640 --> 00:28:22,480
from those type of attack factors so the

845
00:28:22,480 --> 00:28:23,679
first one would be

846
00:28:23,679 --> 00:28:27,039
a making sure that everybody knows um

847
00:28:27,039 --> 00:28:28,080
and has a good

848
00:28:28,080 --> 00:28:29,840
cyber security awareness training you

849
00:28:29,840 --> 00:28:31,440
know continually that is continually

850
00:28:31,440 --> 00:28:32,720
evaluated

851
00:28:32,720 --> 00:28:34,799
why because you as you saw one of the

852
00:28:34,799 --> 00:28:36,559
first stages is to use social

853
00:28:36,559 --> 00:28:37,919
engineering techniques

854
00:28:37,919 --> 00:28:40,399
to ask someone to click on a hyperlink

855
00:28:40,399 --> 00:28:41,840
to download something

856
00:28:41,840 --> 00:28:44,000
so we need to make sure that our our

857
00:28:44,000 --> 00:28:45,200
employees knows

858
00:28:45,200 --> 00:28:46,720
how to detect those type of attack

859
00:28:46,720 --> 00:28:48,480
vectors they they need to know what is

860
00:28:48,480 --> 00:28:50,000
fishing what is a vision

861
00:28:50,000 --> 00:28:52,799
what is a sms fishing and many other

862
00:28:52,799 --> 00:28:54,159
type of attack vectors

863
00:28:54,159 --> 00:28:56,240
we need to also evaluate to make sure

864
00:28:56,240 --> 00:28:57,200
that people

865
00:28:57,200 --> 00:28:59,840
are aware of that and our our system are

866
00:28:59,840 --> 00:29:01,600
secure

867
00:29:01,600 --> 00:29:04,640
and of course evaluate continually by

868
00:29:04,640 --> 00:29:06,240
coordinating penetration testing

869
00:29:06,240 --> 00:29:07,919
vulnerability scanning continually

870
00:29:07,919 --> 00:29:10,080
to detect those type of vulnerabilities

871
00:29:10,080 --> 00:29:12,159
and if possible when you request a

872
00:29:12,159 --> 00:29:13,520
penetration testing

873
00:29:13,520 --> 00:29:17,679
also try to suggest or to request that

874
00:29:17,679 --> 00:29:19,440
part of the technique used on this the

875
00:29:19,440 --> 00:29:21,200
penetration testing includes social

876
00:29:21,200 --> 00:29:22,240
engineering

877
00:29:22,240 --> 00:29:24,720
um testing to make sure that people are

878
00:29:24,720 --> 00:29:26,559
aware and verified people

879
00:29:26,559 --> 00:29:31,840
fail on those type of you know lies

880
00:29:32,240 --> 00:29:34,559
another recommendation definitely make

881
00:29:34,559 --> 00:29:36,399
sure that you have a good antivirus that

882
00:29:36,399 --> 00:29:38,880
you have an edr you know

883
00:29:38,880 --> 00:29:40,960
a solution that would enable us to

884
00:29:40,960 --> 00:29:42,240
detect for example

885
00:29:42,240 --> 00:29:44,880
in not only patterns but also behavior

886
00:29:44,880 --> 00:29:46,720
behavioral analytics

887
00:29:46,720 --> 00:29:49,120
to detect if as an example that there

888
00:29:49,120 --> 00:29:50,480
are some commands that are being

889
00:29:50,480 --> 00:29:52,480
executed after hours the

890
00:29:52,480 --> 00:29:54,720
commands that are normally not executed

891
00:29:54,720 --> 00:29:56,320
on those computers and suddenly they are

892
00:29:56,320 --> 00:29:58,399
being executed you know those behavior

893
00:29:58,399 --> 00:29:59,679
analytics

894
00:29:59,679 --> 00:30:02,559
it should be implemented so you you get

895
00:30:02,559 --> 00:30:04,159
notified in a tiny manner

896
00:30:04,159 --> 00:30:06,960
and perform a specific actions make sure

897
00:30:06,960 --> 00:30:08,640
that you monitor all your different

898
00:30:08,640 --> 00:30:10,240
communication systems including your

899
00:30:10,240 --> 00:30:11,120
email

900
00:30:11,120 --> 00:30:14,640
your um chat systems and

901
00:30:14,640 --> 00:30:17,360
keep an eye on your social media tools

902
00:30:17,360 --> 00:30:18,720
that you allow

903
00:30:18,720 --> 00:30:21,520
your co-workers to access you know

904
00:30:21,520 --> 00:30:22,240
because a

905
00:30:22,240 --> 00:30:23,520
social engineering could also be

906
00:30:23,520 --> 00:30:25,440
performed you know through facebook or

907
00:30:25,440 --> 00:30:26,480
through any

908
00:30:26,480 --> 00:30:30,640
sort of social social media tool

909
00:30:30,640 --> 00:30:32,399
when i'm talking about edr there are

910
00:30:32,399 --> 00:30:34,559
many adrs that are very useful and they

911
00:30:34,559 --> 00:30:37,360
are now designed to detect a load beams

912
00:30:37,360 --> 00:30:38,559
usage of loadings

913
00:30:38,559 --> 00:30:41,600
here we can see an example uh on this

914
00:30:41,600 --> 00:30:44,000
edr you know the powershell execution

915
00:30:44,000 --> 00:30:45,360
has been monitored

916
00:30:45,360 --> 00:30:47,440
and it is triggering alerts based on

917
00:30:47,440 --> 00:30:49,279
some possible malicious

918
00:30:49,279 --> 00:30:52,399
activity that is being feared

919
00:30:54,000 --> 00:30:56,559
make sure that you only allow what is

920
00:30:56,559 --> 00:30:57,279
the

921
00:30:57,279 --> 00:30:59,120
what is really really required you know

922
00:30:59,120 --> 00:31:00,960
minimalism you know like the least

923
00:31:00,960 --> 00:31:01,840
privilege

924
00:31:01,840 --> 00:31:04,159
so make sure you apply good separation

925
00:31:04,159 --> 00:31:05,440
of duties that you have a

926
00:31:05,440 --> 00:31:09,440
only allowed a specific

927
00:31:09,440 --> 00:31:11,919
ports to be open specific commands to be

928
00:31:11,919 --> 00:31:13,200
executed

929
00:31:13,200 --> 00:31:15,760
um and as i said i'm not saying don't

930
00:31:15,760 --> 00:31:16,640
dis

931
00:31:16,640 --> 00:31:18,000
go down under don't go down there and

932
00:31:18,000 --> 00:31:19,760
disable powershell everywhere if you

933
00:31:19,760 --> 00:31:21,039
need powershell

934
00:31:21,039 --> 00:31:23,840
use it but just keep an eye on the usage

935
00:31:23,840 --> 00:31:25,919
of tools such as powershell

936
00:31:25,919 --> 00:31:28,480
if possible try to also monitor those

937
00:31:28,480 --> 00:31:30,240
accounts that has a lot of privilege

938
00:31:30,240 --> 00:31:31,440
like using a privileged account

939
00:31:31,440 --> 00:31:33,600
management system to keep an eye on the

940
00:31:33,600 --> 00:31:35,919
usage of those type of tools

941
00:31:35,919 --> 00:31:38,320
that could for example a create a new

942
00:31:38,320 --> 00:31:40,880
service or to disable a service or

943
00:31:40,880 --> 00:31:44,480
many other type of malicious attacks

944
00:31:44,480 --> 00:31:46,799
if you want to use powershell it's good

945
00:31:46,799 --> 00:31:48,720
but make sure that you lock that you

946
00:31:48,720 --> 00:31:50,640
monitor so how you can do it there are

947
00:31:50,640 --> 00:31:52,000
many ways one of the ways

948
00:31:52,000 --> 00:31:54,000
is to enable the powershell command

949
00:31:54,000 --> 00:31:55,840
execution

950
00:31:55,840 --> 00:31:59,600
on the group policy editor and that way

951
00:31:59,600 --> 00:32:02,720
if you integrate those logs

952
00:32:02,720 --> 00:32:05,919
with a sim for example if there are many

953
00:32:05,919 --> 00:32:07,600
open source themes and also commercial

954
00:32:07,600 --> 00:32:09,519
sims then you will be able to create

955
00:32:09,519 --> 00:32:10,720
your own use cases

956
00:32:10,720 --> 00:32:14,880
and keep an eye on this on the usage of

957
00:32:14,880 --> 00:32:18,080
lol bins and existing you know

958
00:32:18,080 --> 00:32:20,879
automation tools

959
00:32:21,840 --> 00:32:25,200
also as you saw one of the actions that

960
00:32:25,200 --> 00:32:26,559
are performed during this

961
00:32:26,559 --> 00:32:28,240
process is not only using social

962
00:32:28,240 --> 00:32:29,760
engineering but also

963
00:32:29,760 --> 00:32:31,360
trying to analyze possible

964
00:32:31,360 --> 00:32:32,880
vulnerabilities and exploit them

965
00:32:32,880 --> 00:32:35,279
so make sure that your device says all

966
00:32:35,279 --> 00:32:36,080
your devices

967
00:32:36,080 --> 00:32:39,360
computers network devices mobile devices

968
00:32:39,360 --> 00:32:42,480
iots video cameras whatever you have has

969
00:32:42,480 --> 00:32:43,519
the latest patch

970
00:32:43,519 --> 00:32:45,679
implemented you know the hot fixes i

971
00:32:45,679 --> 00:32:47,519
apply in italian miner

972
00:32:47,519 --> 00:32:49,279
that you make sure that you're using the

973
00:32:49,279 --> 00:32:51,519
latest version of the application

974
00:32:51,519 --> 00:32:53,360
and that you have also a good software

975
00:32:53,360 --> 00:32:55,120
inventory that you have control on what

976
00:32:55,120 --> 00:32:56,640
applications are installed

977
00:32:56,640 --> 00:32:59,919
who is using them and why they are still

978
00:32:59,919 --> 00:33:00,480
using it

979
00:33:00,480 --> 00:33:02,960
if those if any of those softwares are

980
00:33:02,960 --> 00:33:04,559
no longer required

981
00:33:04,559 --> 00:33:07,600
make sure to delete those applications

982
00:33:07,600 --> 00:33:11,279
from your computers

983
00:33:11,279 --> 00:33:14,000
and finally of course there's no one

984
00:33:14,000 --> 00:33:14,640
single

985
00:33:14,640 --> 00:33:16,399
tool that will so that will protect you

986
00:33:16,399 --> 00:33:18,000
100 percent against

987
00:33:18,000 --> 00:33:20,399
this type of attack vectors so make sure

988
00:33:20,399 --> 00:33:22,000
to implement a security in-depth

989
00:33:22,000 --> 00:33:22,880
approach

990
00:33:22,880 --> 00:33:25,679
as many layers as you can it will make

991
00:33:25,679 --> 00:33:27,360
the life

992
00:33:27,360 --> 00:33:28,960
more miserable to the attackers and it

993
00:33:28,960 --> 00:33:30,480
will be for them a lot

994
00:33:30,480 --> 00:33:32,799
harder to recover their investment

995
00:33:32,799 --> 00:33:33,760
because at the end

996
00:33:33,760 --> 00:33:35,679
they have to invest time they have to

997
00:33:35,679 --> 00:33:37,919
invest money to try to perform an attack

998
00:33:37,919 --> 00:33:38,640
right

999
00:33:38,640 --> 00:33:41,279
so if we add many layers for them

1000
00:33:41,279 --> 00:33:43,039
they're gonna see okay this company has

1001
00:33:43,039 --> 00:33:45,120
too many layers there they they have

1002
00:33:45,120 --> 00:33:47,360
different type of security products they

1003
00:33:47,360 --> 00:33:48,399
know what they do

1004
00:33:48,399 --> 00:33:49,760
so let's try to attack someone else so

1005
00:33:49,760 --> 00:33:51,679
let's try to use another vector you know

1006
00:33:51,679 --> 00:33:52,159
what

1007
00:33:52,159 --> 00:33:54,720
less a sub attack this is i'm i'm losing

1008
00:33:54,720 --> 00:33:57,120
money because attackers at the end

1009
00:33:57,120 --> 00:33:59,840
you know it's a cyber criminal

1010
00:33:59,840 --> 00:34:01,760
organization they need also to recover

1011
00:34:01,760 --> 00:34:04,240
their investment so make sure that you

1012
00:34:04,240 --> 00:34:06,240
have a good network security endpoint

1013
00:34:06,240 --> 00:34:08,399
security application security

1014
00:34:08,399 --> 00:34:10,399
that you develop applications thinking

1015
00:34:10,399 --> 00:34:12,320
on security from day one

1016
00:34:12,320 --> 00:34:14,239
operating operating system security that

1017
00:34:14,239 --> 00:34:16,879
you have data leakage operation system

1018
00:34:16,879 --> 00:34:19,119
to keep an eye on outgoing traffic or

1019
00:34:19,119 --> 00:34:20,399
outgoing

1020
00:34:20,399 --> 00:34:24,079
information and again make sure that the

1021
00:34:24,079 --> 00:34:26,560
that humans are not the weakest link on

1022
00:34:26,560 --> 00:34:28,239
your chain you know make sure that they

1023
00:34:28,239 --> 00:34:29,040
have

1024
00:34:29,040 --> 00:34:32,239
the proper training the proper knowledge

1025
00:34:32,239 --> 00:34:34,399
and that you evaluate that knowledge

1026
00:34:34,399 --> 00:34:37,118
continually

1027
00:34:37,679 --> 00:34:38,879
all right that's it i don't know if you

1028
00:34:38,879 --> 00:34:41,599
have any questions so far

1029
00:34:41,599 --> 00:34:44,159
i won uh thanks very much for the talk

1030
00:34:44,159 --> 00:34:45,760
it was really interesting

1031
00:34:45,760 --> 00:34:48,800
and for anybody watching the talk you

1032
00:34:48,800 --> 00:34:50,800
can use the live discussion

1033
00:34:50,800 --> 00:34:52,960
tab on the bottom right of your screen

1034
00:34:52,960 --> 00:34:54,560
to ask any questions

1035
00:34:54,560 --> 00:34:56,000
and while we're waiting for any

1036
00:34:56,000 --> 00:34:57,680
questions to come through we have a few

1037
00:34:57,680 --> 00:34:58,800
minutes so

1038
00:34:58,800 --> 00:35:02,079
um you actually touched on everything i

1039
00:35:02,079 --> 00:35:04,000
suppose start to finish from you know

1040
00:35:04,000 --> 00:35:06,000
education and training to

1041
00:35:06,000 --> 00:35:08,240
um implement the security control to

1042
00:35:08,240 --> 00:35:10,320
detection all of that so it was actually

1043
00:35:10,320 --> 00:35:11,280
very interesting

1044
00:35:11,280 --> 00:35:15,200
talk so thanks for that um

1045
00:35:15,200 --> 00:35:18,320
the things i suppose that captured my my

1046
00:35:18,320 --> 00:35:21,760
attention was again the putting the

1047
00:35:21,760 --> 00:35:24,000
attention and the focus on social

1048
00:35:24,000 --> 00:35:24,800
engineering

1049
00:35:24,800 --> 00:35:27,680
and training the human uh as i had been

1050
00:35:27,680 --> 00:35:28,640
mentioned

1051
00:35:28,640 --> 00:35:31,119
in a few talks a day and actually in our

1052
00:35:31,119 --> 00:35:32,240
keynote

1053
00:35:32,240 --> 00:35:36,079
speech this morning and unfortunately

1054
00:35:36,079 --> 00:35:37,440
companies that just don't want to spend

1055
00:35:37,440 --> 00:35:39,359
the money it's it's so difficult to get

1056
00:35:39,359 --> 00:35:40,160
out of this

1057
00:35:40,160 --> 00:35:42,960
idea of you know just read the policy

1058
00:35:42,960 --> 00:35:43,200
and

1059
00:35:43,200 --> 00:35:44,800
say i've read it then you know we're

1060
00:35:44,800 --> 00:35:46,640
fine because this is what an author

1061
00:35:46,640 --> 00:35:48,000
might ask and

1062
00:35:48,000 --> 00:35:50,240
and i'm sure you see it all the time as

1063
00:35:50,240 --> 00:35:51,040
a pentester

1064
00:35:51,040 --> 00:35:52,960
it's often the cause of just doing the

1065
00:35:52,960 --> 00:35:55,520
bare minimum what can we do that's gonna

1066
00:35:55,520 --> 00:35:57,119
you know make us gonna fly through the

1067
00:35:57,119 --> 00:35:59,599
audit and forget about everything else

1068
00:35:59,599 --> 00:36:01,359
i don't agree with you i totally totally

1069
00:36:01,359 --> 00:36:02,880
agree with you unfortunately people

1070
00:36:02,880 --> 00:36:04,480
think you know many companies think you

1071
00:36:04,480 --> 00:36:05,280
know

1072
00:36:05,280 --> 00:36:08,000
i'm i i i have a small and medium

1073
00:36:08,000 --> 00:36:09,200
company

1074
00:36:09,200 --> 00:36:11,119
you know smb you know so who's gonna

1075
00:36:11,119 --> 00:36:12,800
attack me you know

1076
00:36:12,800 --> 00:36:15,040
normally attackers will try to find try

1077
00:36:15,040 --> 00:36:16,480
to attack big banks or

1078
00:36:16,480 --> 00:36:18,560
they will try to attack big companies

1079
00:36:18,560 --> 00:36:20,000
that's not true

1080
00:36:20,000 --> 00:36:23,920
they are attacking those that has that

1081
00:36:23,920 --> 00:36:25,839
the worst type of security you know that

1082
00:36:25,839 --> 00:36:27,520
the word those that doesn't have the

1083
00:36:27,520 --> 00:36:28,160
proper

1084
00:36:28,160 --> 00:36:30,480
detection system those that doesn't have

1085
00:36:30,480 --> 00:36:32,000
the proper awareness

1086
00:36:32,000 --> 00:36:33,520
so they don't care you know they do that

1087
00:36:33,520 --> 00:36:35,119
they send it to

1088
00:36:35,119 --> 00:36:38,960
um you know in batch and sooner or later

1089
00:36:38,960 --> 00:36:39,680
someone

1090
00:36:39,680 --> 00:36:42,000
is going to be the victim at the end

1091
00:36:42,000 --> 00:36:42,880
there are only three

1092
00:36:42,880 --> 00:36:44,160
type of companies you know those that

1093
00:36:44,160 --> 00:36:46,079
has been hacked those that are being

1094
00:36:46,079 --> 00:36:47,520
attacked right now and those that are

1095
00:36:47,520 --> 00:36:48,560
going to be attacked

1096
00:36:48,560 --> 00:36:51,760
very soon yeah you're not right

1097
00:36:51,760 --> 00:36:55,119
um you also touched on um

1098
00:36:55,119 --> 00:36:57,119
just i suppose the the basic hygiene so

1099
00:36:57,119 --> 00:36:58,960
do your monitoring list privilege and

1100
00:36:58,960 --> 00:37:00,000
all that

1101
00:37:00,000 --> 00:37:03,200
and um now you you are heavily involved

1102
00:37:03,200 --> 00:37:04,160
in cloud so

1103
00:37:04,160 --> 00:37:07,359
i bet you see it a lot of the time where

1104
00:37:07,359 --> 00:37:10,880
maybe engineering teams haven't really

1105
00:37:10,880 --> 00:37:12,800
i suppose updated their skills with

1106
00:37:12,800 --> 00:37:15,119
regards to cloud native environments

1107
00:37:15,119 --> 00:37:18,480
likes of azure ws so is it is it common

1108
00:37:18,480 --> 00:37:19,359
that you see

1109
00:37:19,359 --> 00:37:22,480
companies maybe that um

1110
00:37:22,480 --> 00:37:24,240
say like a hybrid company so they have

1111
00:37:24,240 --> 00:37:25,760
some on-prem infrastructure and they

1112
00:37:25,760 --> 00:37:26,400
have

1113
00:37:26,400 --> 00:37:30,480
say infrastructure on the cloud say aws

1114
00:37:30,480 --> 00:37:33,520
where everything appears to be fine on

1115
00:37:33,520 --> 00:37:33,839
the

1116
00:37:33,839 --> 00:37:35,920
hybrid on the on the on-prem side of

1117
00:37:35,920 --> 00:37:38,160
hybrid but then the security controls

1118
00:37:38,160 --> 00:37:40,079
aren't implemented correctly

1119
00:37:40,079 --> 00:37:43,200
for the likes of say lambda because the

1120
00:37:43,200 --> 00:37:44,720
developers have an updated

1121
00:37:44,720 --> 00:37:47,359
skill so you know execution role

1122
00:37:47,359 --> 00:37:49,200
potentially makes everything blow up and

1123
00:37:49,200 --> 00:37:50,720
everybody can do anything on any

1124
00:37:50,720 --> 00:37:53,520
resource is that something that you see

1125
00:37:53,520 --> 00:37:55,680
i see a lot of a lot of a lot of things

1126
00:37:55,680 --> 00:37:58,640
so i i do agree that there are many

1127
00:37:58,640 --> 00:38:01,520
companies that they start using new

1128
00:38:01,520 --> 00:38:02,640
technologies because

1129
00:38:02,640 --> 00:38:05,359
is the boom is is what are what what's

1130
00:38:05,359 --> 00:38:06,400
everybody's doing

1131
00:38:06,400 --> 00:38:08,240
but maybe they're not ready for that

1132
00:38:08,240 --> 00:38:09,440
they need to make sure that they have

1133
00:38:09,440 --> 00:38:10,800
the proper training that they

1134
00:38:10,800 --> 00:38:13,760
update their knowledge um remember at

1135
00:38:13,760 --> 00:38:15,599
the end what is in the cloud

1136
00:38:15,599 --> 00:38:18,320
the cloud is someone else's data center

1137
00:38:18,320 --> 00:38:18,640
so

1138
00:38:18,640 --> 00:38:21,520
you are offloading some security things

1139
00:38:21,520 --> 00:38:22,000
to the

1140
00:38:22,000 --> 00:38:25,200
provider but most of the security

1141
00:38:25,200 --> 00:38:27,680
responsibility is still on the customer

1142
00:38:27,680 --> 00:38:28,560
remember the shared

1143
00:38:28,560 --> 00:38:31,200
responsibility matrix so companies that

1144
00:38:31,200 --> 00:38:32,640
wants to take advantage of the cloud

1145
00:38:32,640 --> 00:38:33,760
because cloud has

1146
00:38:33,760 --> 00:38:35,920
many advantages believe me many

1147
00:38:35,920 --> 00:38:37,280
advantages and

1148
00:38:37,280 --> 00:38:39,920
cloud technology is the future for sure

1149
00:38:39,920 --> 00:38:40,320
uh

1150
00:38:40,320 --> 00:38:41,920
at least in the next five years remember

1151
00:38:41,920 --> 00:38:43,839
the technology change so fast but at

1152
00:38:43,839 --> 00:38:44,320
least

1153
00:38:44,320 --> 00:38:46,160
right now i can say that cloud is the

1154
00:38:46,160 --> 00:38:47,599
future so

1155
00:38:47,599 --> 00:38:50,160
a company needs to make sure that they

1156
00:38:50,160 --> 00:38:52,000
take advantage of that technology in a

1157
00:38:52,000 --> 00:38:52,560
wise

1158
00:38:52,560 --> 00:38:55,119
manner you know in a proper manner not

1159
00:38:55,119 --> 00:38:56,800
just doing it because everybody's doing

1160
00:38:56,800 --> 00:38:57,119
it

1161
00:38:57,119 --> 00:38:58,480
make sure that you do it because you're

1162
00:38:58,480 --> 00:38:59,920
ready make sure that you do it because

1163
00:38:59,920 --> 00:39:01,359
you have the proper training

1164
00:39:01,359 --> 00:39:03,280
you have the proper certifications and

1165
00:39:03,280 --> 00:39:05,599
that you understand the technology

1166
00:39:05,599 --> 00:39:08,560
um that you know what should be on a

1167
00:39:08,560 --> 00:39:10,320
public cloud what should be in a private

1168
00:39:10,320 --> 00:39:13,119
cloud how you're going to be monitoring

1169
00:39:13,119 --> 00:39:14,960
at the end and the fact that it's on the

1170
00:39:14,960 --> 00:39:16,560
cloud again it means that it's in

1171
00:39:16,560 --> 00:39:17,920
someone else's data center so you have

1172
00:39:17,920 --> 00:39:18,480
to keep an

1173
00:39:18,480 --> 00:39:21,440
eye on your assets digital assets

1174
00:39:21,440 --> 00:39:22,640
absolutely

1175
00:39:22,640 --> 00:39:24,720
and there's good feedback here and on

1176
00:39:24,720 --> 00:39:26,480
the chat people are really enjoying your

1177
00:39:26,480 --> 00:39:26,960
talk

1178
00:39:26,960 --> 00:39:29,760
and there's no questions that are coming

1179
00:39:29,760 --> 00:39:30,160
true

1180
00:39:30,160 --> 00:39:33,119
so i'll just mention um one of the

1181
00:39:33,119 --> 00:39:34,160
attendees

1182
00:39:34,160 --> 00:39:36,400
was just trying to make a note and just

1183
00:39:36,400 --> 00:39:37,359
to say to everybody

1184
00:39:37,359 --> 00:39:40,320
this um you know if you're happy to

1185
00:39:40,320 --> 00:39:41,599
share the slides and we'll share them

1186
00:39:41,599 --> 00:39:42,079
with the

1187
00:39:42,079 --> 00:39:45,680
attendees so the people watch this talk

1188
00:39:45,680 --> 00:39:47,760
and but there's somebody just taking

1189
00:39:47,760 --> 00:39:49,359
notes obviously as you were talking

1190
00:39:49,359 --> 00:39:52,240
and they're saying um just to make sure

1191
00:39:52,240 --> 00:39:53,040
they covered

1192
00:39:53,040 --> 00:39:55,760
everything from the tools they got

1193
00:39:55,760 --> 00:39:56,720
crowdstrike

1194
00:39:56,720 --> 00:39:59,040
exo beam and splunk did they miss

1195
00:39:59,040 --> 00:40:00,880
anything any other tools that you had on

1196
00:40:00,880 --> 00:40:02,800
your slide

1197
00:40:02,800 --> 00:40:05,760
uh well from the tools perspective uh

1198
00:40:05,760 --> 00:40:06,079
well

1199
00:40:06,079 --> 00:40:08,480
there are many you know to be honest i

1200
00:40:08,480 --> 00:40:10,079
shouldn't um

1201
00:40:10,079 --> 00:40:12,480
there are so many options available that

1202
00:40:12,480 --> 00:40:13,520
is not fair

1203
00:40:13,520 --> 00:40:15,839
just to mention you know brands it's

1204
00:40:15,839 --> 00:40:17,599
more like technologies you know

1205
00:40:17,599 --> 00:40:19,599
no matter if you're using a commercial

1206
00:40:19,599 --> 00:40:20,720
sim

1207
00:40:20,720 --> 00:40:24,000
or a open source a sim because both can

1208
00:40:24,000 --> 00:40:25,440
be very powerful

1209
00:40:25,440 --> 00:40:27,119
the important thing is that you use the

1210
00:40:27,119 --> 00:40:28,480
proper tools and they are properly

1211
00:40:28,480 --> 00:40:29,280
configured

1212
00:40:29,280 --> 00:40:31,040
that you know how to use them that you

1213
00:40:31,040 --> 00:40:33,440
know how to take advantage of them

1214
00:40:33,440 --> 00:40:36,000
so just make sure that you that you get

1215
00:40:36,000 --> 00:40:37,920
familiar with this type of technologies

1216
00:40:37,920 --> 00:40:39,760
as i said crosstrek is is great you know

1217
00:40:39,760 --> 00:40:41,839
but their older also other

1218
00:40:41,839 --> 00:40:45,440
type of edrs available at the market

1219
00:40:45,440 --> 00:40:48,240
so it's a it's a there are so many

1220
00:40:48,240 --> 00:40:50,079
options that it will not be fair just to

1221
00:40:50,079 --> 00:40:52,079
mention just a few products yeah what

1222
00:40:52,079 --> 00:40:54,000
whatever works for everybody every

1223
00:40:54,000 --> 00:40:55,680
organization is different

1224
00:40:55,680 --> 00:40:58,400
and we still have a few minutes and

1225
00:40:58,400 --> 00:41:00,160
actually a question came through

1226
00:41:00,160 --> 00:41:02,400
and is there much difference in

1227
00:41:02,400 --> 00:41:03,440
capabilities

1228
00:41:03,440 --> 00:41:06,319
between lol bins on linux machines

1229
00:41:06,319 --> 00:41:08,800
compared to windows

1230
00:41:08,800 --> 00:41:10,880
the the risk is exactly the same the

1231
00:41:10,880 --> 00:41:12,960
risk is exactly the same because at the

1232
00:41:12,960 --> 00:41:13,599
end

1233
00:41:13,599 --> 00:41:15,440
those are operating systems that are

1234
00:41:15,440 --> 00:41:17,119
that has many tools

1235
00:41:17,119 --> 00:41:20,079
for maintenance for a scheduling

1236
00:41:20,079 --> 00:41:21,760
automatic task you know as i mentioned

1237
00:41:21,760 --> 00:41:22,560
you can do

1238
00:41:22,560 --> 00:41:25,760
a chrome on linux and you can schedule

1239
00:41:25,760 --> 00:41:27,440
tasks using the task scheduler

1240
00:41:27,440 --> 00:41:30,319
on windows so the attack surface is

1241
00:41:30,319 --> 00:41:32,079
basically very similar

1242
00:41:32,079 --> 00:41:34,319
of course the command will be different

1243
00:41:34,319 --> 00:41:35,440
but at the end

1244
00:41:35,440 --> 00:41:36,960
if you think a little bit about it there

1245
00:41:36,960 --> 00:41:38,640
are so many servers or

1246
00:41:38,640 --> 00:41:40,480
so many servers especially servers

1247
00:41:40,480 --> 00:41:42,720
running linux around the world

1248
00:41:42,720 --> 00:41:45,520
so many desktops and laptops and why not

1249
00:41:45,520 --> 00:41:47,520
servers of course running windows so

1250
00:41:47,520 --> 00:41:51,040
both are very good examples but remember

1251
00:41:51,040 --> 00:41:52,319
that this could be performed

1252
00:41:52,319 --> 00:41:55,359
in other type of operating systems you

1253
00:41:55,359 --> 00:41:57,119
know like mobile devices they have their

1254
00:41:57,119 --> 00:41:58,880
own operating system operating system

1255
00:41:58,880 --> 00:41:59,680
that are also

1256
00:41:59,680 --> 00:42:02,640
able to process requests so this this is

1257
00:42:02,640 --> 00:42:03,599
just the

1258
00:42:03,599 --> 00:42:05,440
peak of the eyes work of so many things

1259
00:42:05,440 --> 00:42:06,880
that you can do uh

1260
00:42:06,880 --> 00:42:10,400
using a lullabies australian thank you

1261
00:42:10,400 --> 00:42:11,359
for that

1262
00:42:11,359 --> 00:42:14,000
sure um there's no other questions

1263
00:42:14,000 --> 00:42:16,640
coming true there is a comment um

1264
00:42:16,640 --> 00:42:19,920
from somebody just feedback on your talk

1265
00:42:19,920 --> 00:42:22,400
and somebody here says that the

1266
00:42:22,400 --> 00:42:24,480
importance of having tech specs and

1267
00:42:24,480 --> 00:42:25,280
hardened

1268
00:42:25,280 --> 00:42:27,359
hardened specs has come true in your

1269
00:42:27,359 --> 00:42:29,119
talk as well and that's another area

1270
00:42:29,119 --> 00:42:30,880
companies don't really pay enough

1271
00:42:30,880 --> 00:42:31,760
attention

1272
00:42:31,760 --> 00:42:33,359
and it's something that leads to to

1273
00:42:33,359 --> 00:42:36,800
these compromises that you are showing

1274
00:42:36,800 --> 00:42:38,480
totally totally agree with you

1275
00:42:38,480 --> 00:42:40,160
definitely thank you for sharing that

1276
00:42:40,160 --> 00:42:41,119
comment

1277
00:42:41,119 --> 00:42:45,359
definitely um okay so and we have

1278
00:42:45,359 --> 00:42:48,400
two minutes left but there is no other

1279
00:42:48,400 --> 00:42:49,839
questions coming through

1280
00:42:49,839 --> 00:42:53,119
so um i guess and we can

1281
00:42:53,119 --> 00:42:55,920
give people two minutes back juan thank

1282
00:42:55,920 --> 00:42:57,359
you so much for joining us that was a

1283
00:42:57,359 --> 00:42:58,079
very interesting

1284
00:42:58,079 --> 00:43:02,400
talk you're very welcome

1285
00:43:02,400 --> 00:43:04,480
i hope you enjoyed the rest of your day

1286
00:43:04,480 --> 00:43:05,599
and for

1287
00:43:05,599 --> 00:43:08,400
the people watching uh oh actually

1288
00:43:08,400 --> 00:43:09,839
there's a last minute question

1289
00:43:09,839 --> 00:43:13,040
one don't go all right

1290
00:43:13,040 --> 00:43:15,839
so the question is to be in a position

1291
00:43:15,839 --> 00:43:17,680
to run these tools

1292
00:43:17,680 --> 00:43:19,680
the attacker needs some level of

1293
00:43:19,680 --> 00:43:21,280
privileges on the box

1294
00:43:21,280 --> 00:43:23,440
what is the most common method you see

1295
00:43:23,440 --> 00:43:25,839
of getting this

1296
00:43:25,839 --> 00:43:28,800
so so first thing and this is a very

1297
00:43:28,800 --> 00:43:30,319
common question that people ask me

1298
00:43:30,319 --> 00:43:32,560
when i share when i talk about this this

1299
00:43:32,560 --> 00:43:34,240
specific topic

1300
00:43:34,240 --> 00:43:36,400
you don't need administrator rights on

1301
00:43:36,400 --> 00:43:37,599
the victim computer

1302
00:43:37,599 --> 00:43:39,599
as you saw all those attacks that i

1303
00:43:39,599 --> 00:43:42,240
simulate were performed on a computer

1304
00:43:42,240 --> 00:43:46,640
a when where the user is just a normal

1305
00:43:46,640 --> 00:43:50,000
a standard user you know a user that

1306
00:43:50,000 --> 00:43:50,800
doesn't have

1307
00:43:50,800 --> 00:43:53,680
a admin rights as an example so that is

1308
00:43:53,680 --> 00:43:54,240
the first

1309
00:43:54,240 --> 00:43:56,000
the first thing that you don't need like

1310
00:43:56,000 --> 00:43:58,079
to perform a escalation privilege to be

1311
00:43:58,079 --> 00:43:58,720
able to

1312
00:43:58,720 --> 00:44:02,079
to execute fileless malware the second

1313
00:44:02,079 --> 00:44:02,800
one how

1314
00:44:02,800 --> 00:44:04,480
normally you will be able to obtain

1315
00:44:04,480 --> 00:44:06,000
shell access

1316
00:44:06,000 --> 00:44:07,680
well a social engineer is the best

1317
00:44:07,680 --> 00:44:09,359
option you know you can use beef the

1318
00:44:09,359 --> 00:44:11,200
browser expectation firmware you can

1319
00:44:11,200 --> 00:44:13,440
send payloads you can use metaexploit to

1320
00:44:13,440 --> 00:44:15,280
design your own payloads

1321
00:44:15,280 --> 00:44:17,599
of course most if you you you create

1322
00:44:17,599 --> 00:44:18,720
your payload to

1323
00:44:18,720 --> 00:44:20,800
create your reverse engineer reverse

1324
00:44:20,800 --> 00:44:22,319
shell

1325
00:44:22,319 --> 00:44:24,720
many of the current antivirals are able

1326
00:44:24,720 --> 00:44:25,839
to detect you know those type of

1327
00:44:25,839 --> 00:44:26,800
payloads so

1328
00:44:26,800 --> 00:44:29,200
the best and more effective way is to

1329
00:44:29,200 --> 00:44:30,880
create your own payloads

1330
00:44:30,880 --> 00:44:32,640
you know because there is no signature

1331
00:44:32,640 --> 00:44:34,640
available at that moment

1332
00:44:34,640 --> 00:44:36,480
so most likely they will not be detected

1333
00:44:36,480 --> 00:44:38,400
if you create your own advanced payloads

1334
00:44:38,400 --> 00:44:38,960
to

1335
00:44:38,960 --> 00:44:41,200
a you know obtain the reverse in

1336
00:44:41,200 --> 00:44:42,800
reversal

1337
00:44:42,800 --> 00:44:45,680
ireland okay thank you for that and that

1338
00:44:45,680 --> 00:44:47,280
actually brings us to

1339
00:44:47,280 --> 00:44:51,040
the end of this talk thank you again han

1340
00:44:51,040 --> 00:44:52,880
it was very interesting and lots of nice

1341
00:44:52,880 --> 00:45:03,280
discussion going on here in the chats

