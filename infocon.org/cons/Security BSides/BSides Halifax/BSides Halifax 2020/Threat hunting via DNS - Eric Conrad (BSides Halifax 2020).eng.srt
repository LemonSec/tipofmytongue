1
00:00:00,000 --> 00:00:05,790
Communications Eric's been around for a

2
00:00:03,179 --> 00:00:08,879
little bit started in 1991 as a UNIX

3
00:00:05,790 --> 00:00:11,309
system administrator he has then moved

4
00:00:08,880 --> 00:00:14,040
through the industry into security

5
00:00:11,309 --> 00:00:17,609
working for education power research

6
00:00:14,040 --> 00:00:20,400
healthcare damn near all of them eric

7
00:00:17,609 --> 00:00:24,750
has a lot of experience behind him from

8
00:00:20,400 --> 00:00:28,890
sans to giac to a master's in

9
00:00:24,750 --> 00:00:31,170
information security so I'm gonna stop

10
00:00:28,890 --> 00:00:35,430
rambling on and let him get started on

11
00:00:31,170 --> 00:00:36,570
her stock Eric the floor is yours all

12
00:00:35,430 --> 00:00:38,280
right thank you Jeff

13
00:00:36,570 --> 00:00:40,890
and let me know if everyone you can see

14
00:00:38,280 --> 00:00:43,230
me okay and see my slides okay look see

15
00:00:40,890 --> 00:00:45,780
your slides all right very good

16
00:00:43,230 --> 00:00:47,788
all right so thanks for having me a

17
00:00:45,780 --> 00:00:49,860
little background on this talk this talk

18
00:00:47,789 --> 00:00:52,140
was the talk I was supposed to give it a

19
00:00:49,860 --> 00:00:53,070
Linux security conference last month we

20
00:00:52,140 --> 00:00:56,489
know how that goes right

21
00:00:53,070 --> 00:00:59,280
so I was at Linux security conference

22
00:00:56,489 --> 00:01:01,649
last month last year rather and I talked

23
00:00:59,280 --> 00:01:02,430
then and I'll be back next April so I

24
00:01:01,649 --> 00:01:05,339
haven't met you yet

25
00:01:02,430 --> 00:01:08,189
and your local to Halifax or Nova Scotia

26
00:01:05,339 --> 00:01:09,630
hopefully meet you there and a little

27
00:01:08,189 --> 00:01:12,869
more background on me well at least the

28
00:01:09,630 --> 00:01:14,640
Canadian part I think the only u.s.

29
00:01:12,869 --> 00:01:16,409
presenter today but my family originally

30
00:01:14,640 --> 00:01:18,689
is from Lunenburg Nova Scotia a long

31
00:01:16,409 --> 00:01:21,450
long time ago they emigrated to Boston a

32
00:01:18,689 --> 00:01:23,639
long time ago and my son currently

33
00:01:21,450 --> 00:01:25,500
attends to housing now in Halifax so of

34
00:01:23,640 --> 00:01:28,350
course he's home now but he'll be

35
00:01:25,500 --> 00:01:31,140
starting his junior year in the fall in

36
00:01:28,350 --> 00:01:32,820
some fashion we'll see as a ComStat

37
00:01:31,140 --> 00:01:35,939
major so thank you for having me

38
00:01:32,820 --> 00:01:38,339
I do have an action-packed talk and I

39
00:01:35,939 --> 00:01:39,960
like to you know I have about 39 slides

40
00:01:38,340 --> 00:01:42,390
in 45 minutes which is how I like to

41
00:01:39,960 --> 00:01:44,759
give talks though it's fast and furious

42
00:01:42,390 --> 00:01:46,380
I had 60 something slides yesterday and

43
00:01:44,759 --> 00:01:48,930
they did a survival of the fittest out

44
00:01:46,380 --> 00:01:50,729
of the car 39 you can download the talk

45
00:01:48,930 --> 00:01:53,310
right now I uploaded to my website about

46
00:01:50,729 --> 00:01:54,689
a half hour ago so if I'm moving too

47
00:01:53,310 --> 00:01:57,719
fast for you to write things down I've

48
00:01:54,689 --> 00:01:59,279
heard that comment before yet i always

49
00:01:57,719 --> 00:02:01,559
give talks to this speed i just i'd

50
00:01:59,280 --> 00:02:04,950
rather say more not less and just cover

51
00:02:01,560 --> 00:02:07,200
as much as i can impact as much you know

52
00:02:04,950 --> 00:02:09,840
value to you to bring home back to work

53
00:02:07,200 --> 00:02:12,690
and as I possibly can so I'm trying to

54
00:02:09,840 --> 00:02:13,770
do here so Eric on Raycom is where you

55
00:02:12,690 --> 00:02:15,359
can see them to this talk

56
00:02:13,770 --> 00:02:16,710
so the talks on threat I think of course

57
00:02:15,360 --> 00:02:18,390
you probably know what threat hunting is

58
00:02:16,710 --> 00:02:21,510
threat hunting is the presumption of

59
00:02:18,390 --> 00:02:23,459
compromise turn to a process right so

60
00:02:21,510 --> 00:02:24,959
the presumption of compromised is how

61
00:02:23,460 --> 00:02:26,700
all defenders should defend networks

62
00:02:24,960 --> 00:02:30,570
I've been defending networks very long

63
00:02:26,700 --> 00:02:32,220
long time and the key tenet is we're

64
00:02:30,570 --> 00:02:34,140
already owned something's already in

65
00:02:32,220 --> 00:02:35,340
we've missed something now maybe you

66
00:02:34,140 --> 00:02:36,869
don't tell you boss that but that is

67
00:02:35,340 --> 00:02:38,340
exactly how you should be defending that

68
00:02:36,870 --> 00:02:40,080
works you should defend in network as it

69
00:02:38,340 --> 00:02:41,630
is if you've missed something you should

70
00:02:40,080 --> 00:02:43,590
always assume prevention has failed

71
00:02:41,630 --> 00:02:46,350
initial detection has failed

72
00:02:43,590 --> 00:02:48,660
now what threatening steps in right and

73
00:02:46,350 --> 00:02:50,400
in a Windows environment I would say

74
00:02:48,660 --> 00:02:51,660
windows event logs are the number one

75
00:02:50,400 --> 00:02:54,210
threat hunting source so you're looking

76
00:02:51,660 --> 00:02:56,250
for malware that got through it evaded

77
00:02:54,210 --> 00:02:57,510
prevention it evaded detection at least

78
00:02:56,250 --> 00:02:59,430
initially you know how do you find that

79
00:02:57,510 --> 00:03:00,600
right in a Windows environment I'd say

80
00:02:59,430 --> 00:03:01,860
what is the vet logs are probably the

81
00:03:00,600 --> 00:03:04,500
best source but you're already if you

82
00:03:01,860 --> 00:03:06,180
have a sock you know or sim in a sock

83
00:03:04,500 --> 00:03:07,620
Security Operations Center you've

84
00:03:06,180 --> 00:03:10,290
already probably looking at one as event

85
00:03:07,620 --> 00:03:12,270
logs are you looking at DNS logs now

86
00:03:10,290 --> 00:03:14,190
when most Sox ingest DNS they usually

87
00:03:12,270 --> 00:03:16,170
use of a correlation a correlations find

88
00:03:14,190 --> 00:03:19,260
correlations great you know tying one

89
00:03:16,170 --> 00:03:21,869
event to another but I use DNS primarily

90
00:03:19,260 --> 00:03:24,420
for thread hunting you know based on the

91
00:03:21,870 --> 00:03:27,120
name alone and some metadata around the

92
00:03:24,420 --> 00:03:29,160
name like how old that domain is say hey

93
00:03:27,120 --> 00:03:31,230
that's weird that that's that's that's

94
00:03:29,160 --> 00:03:33,570
odd you know that looks strange and then

95
00:03:31,230 --> 00:03:35,399
go chase that down right and its super

96
00:03:33,570 --> 00:03:38,400
actionable but it's being impacted

97
00:03:35,400 --> 00:03:40,440
heavily heavily by this revolution and

98
00:03:38,400 --> 00:03:43,770
encrypted DNS which is happening at a

99
00:03:40,440 --> 00:03:45,690
wide scale well now so historically it

100
00:03:43,770 --> 00:03:47,580
was easy and most people's preferred

101
00:03:45,690 --> 00:03:49,800
method for grabbing DNS logs was the

102
00:03:47,580 --> 00:03:51,240
Zeke formerly known as bro so you have a

103
00:03:49,800 --> 00:03:53,070
snare for your running security onion or

104
00:03:51,240 --> 00:03:55,650
some form of sniffer you use Zeke now

105
00:03:53,070 --> 00:03:57,810
you ingest the DNS logs and many many

106
00:03:55,650 --> 00:04:00,870
tools play nicely with Zeke logs right

107
00:03:57,810 --> 00:04:02,730
so that is my preferred way to get DNS

108
00:04:00,870 --> 00:04:04,260
you have a sniffer right before your

109
00:04:02,730 --> 00:04:05,940
outbound firewall that lasts you know

110
00:04:04,260 --> 00:04:07,859
unencrypted hopper you know the last hop

111
00:04:05,940 --> 00:04:09,840
before the Internet you grab all your

112
00:04:07,860 --> 00:04:12,570
DNS traffic there and you analyze that

113
00:04:09,840 --> 00:04:14,400
was to me the most scalable way I get a

114
00:04:12,570 --> 00:04:19,079
lot of tools play nicely with Zeke can

115
00:04:14,400 --> 00:04:21,090
also log on the DNS server itself and so

116
00:04:19,079 --> 00:04:23,729
you should be using some form of split

117
00:04:21,089 --> 00:04:26,729
DNS or split split DNS and I won't go I

118
00:04:23,729 --> 00:04:28,800
could talk for hours on this but I want

119
00:04:26,730 --> 00:04:30,690
I love geeking out on DNS and things

120
00:04:28,800 --> 00:04:33,000
like this this is right in my ballpark

121
00:04:30,690 --> 00:04:34,890
but if you use some form of split DNS

122
00:04:33,000 --> 00:04:37,110
and I won't describe too much of that

123
00:04:34,890 --> 00:04:41,219
but basically local clients resolve

124
00:04:37,110 --> 00:04:43,350
locally and then your DNS recursive DNS

125
00:04:41,220 --> 00:04:45,060
server which is really a DNS proxy we

126
00:04:43,350 --> 00:04:48,330
don't don't call it that but that's

127
00:04:45,060 --> 00:04:49,860
where it is your DNS recursive server

128
00:04:48,330 --> 00:04:52,590
goes out finds the answer for you you

129
00:04:49,860 --> 00:04:55,080
can also log there right you can also

130
00:04:52,590 --> 00:04:56,909
log on a client the client with with sis

131
00:04:55,080 --> 00:04:59,460
Mon newly added assessment dienes

132
00:04:56,910 --> 00:05:01,650
logging which I'll talk about great the

133
00:04:59,460 --> 00:05:03,989
browser itself can log and I turned on

134
00:05:01,650 --> 00:05:05,880
Firefox to by it's logging just as a

135
00:05:03,990 --> 00:05:07,800
test and I quickly recoiled in horror

136
00:05:05,880 --> 00:05:09,630
because it's basically the bug style

137
00:05:07,800 --> 00:05:13,050
logging like what one DNS resolution

138
00:05:09,630 --> 00:05:15,450
might have 30 lines of a log file not

139
00:05:13,050 --> 00:05:17,150
ideal not it's possible but not ideal

140
00:05:15,450 --> 00:05:21,120
and it is worth noting that Windows 2012

141
00:05:17,150 --> 00:05:22,799
r2 plus now supports DNS logging via the

142
00:05:21,120 --> 00:05:24,180
event for der meaning it plays nicely

143
00:05:22,800 --> 00:05:26,790
with you same your sloggin all that good

144
00:05:24,180 --> 00:05:29,340
stuff right but all that is now being

145
00:05:26,790 --> 00:05:30,900
impacted heavily by DNS encryption now

146
00:05:29,340 --> 00:05:34,349
anything I say today is gonna be out of

147
00:05:30,900 --> 00:05:35,969
date by next week I was on the East

148
00:05:34,350 --> 00:05:37,740
Coast podcast last week with Daryl and

149
00:05:35,970 --> 00:05:39,360
grant and I said that I said well I'm

150
00:05:37,740 --> 00:05:40,800
gonna update my talk about guarantee and

151
00:05:39,360 --> 00:05:43,740
sure enough something's gonna change it

152
00:05:40,800 --> 00:05:46,230
sure enough chrome 83 debuted on Tuesday

153
00:05:43,740 --> 00:05:48,900
this Tuesday three Reese Tuesday and now

154
00:05:46,230 --> 00:05:49,440
they've turned on DNS over HTTP all

155
00:05:48,900 --> 00:05:51,030
right

156
00:05:49,440 --> 00:05:53,790
not for everyone but they're doing a

157
00:05:51,030 --> 00:05:55,289
rolling uh kind of a staged rollout in

158
00:05:53,790 --> 00:05:56,850
wave just as Firefox has already

159
00:05:55,290 --> 00:06:00,180
completed that in the US anyways right

160
00:05:56,850 --> 00:06:02,370
and there's two flavors of encrypted DNS

161
00:06:00,180 --> 00:06:05,880
and it really throws a monkey wrench

162
00:06:02,370 --> 00:06:07,170
into analyzing DNS and what's happening

163
00:06:05,880 --> 00:06:08,820
with my clients is they don't even know

164
00:06:07,170 --> 00:06:11,070
what's happening they think they're

165
00:06:08,820 --> 00:06:12,510
ingesting DNS through Zeke they think

166
00:06:11,070 --> 00:06:14,430
they're getting all their DNS in or not

167
00:06:12,510 --> 00:06:15,960
they're getting a fraction of their DNS

168
00:06:14,430 --> 00:06:17,880
depending on how many how many uses use

169
00:06:15,960 --> 00:06:19,680
Firefox is Firefox in the US anyways

170
00:06:17,880 --> 00:06:21,210
let's flip that switch I'm not sure

171
00:06:19,680 --> 00:06:24,030
about Canada penny one knows send me an

172
00:06:21,210 --> 00:06:25,140
email econ rat aback sure that my emails

173
00:06:24,030 --> 00:06:27,950
at the end of it if you want to do a

174
00:06:25,140 --> 00:06:29,700
test in Canada I I don't you know I

175
00:06:27,950 --> 00:06:33,240
normally have my son do this at

176
00:06:29,700 --> 00:06:34,950
Dalhousie but he's home right now let me

177
00:06:33,240 --> 00:06:37,290
know do a test in Canada I'm curious to

178
00:06:34,950 --> 00:06:40,110
see whether they flipped the switch in

179
00:06:37,290 --> 00:06:42,540
Canada and so

180
00:06:40,110 --> 00:06:44,740
you you need to know what you don't know

181
00:06:42,540 --> 00:06:45,850
you know and it's a weird thing to say

182
00:06:44,740 --> 00:06:48,130
but you need to know what the blind

183
00:06:45,850 --> 00:06:49,960
spots are as a defender you have to know

184
00:06:48,130 --> 00:06:51,969
where you're blind right you don't know

185
00:06:49,960 --> 00:06:54,070
where you're blind the serious risk

186
00:06:51,970 --> 00:06:55,420
lurks right there right and my clients

187
00:06:54,070 --> 00:06:57,130
think they're ingesting DNS but they're

188
00:06:55,420 --> 00:06:59,290
not getting any DNS from Firefox today

189
00:06:57,130 --> 00:07:01,330
now you can fix that but to fix that

190
00:06:59,290 --> 00:07:02,830
requires knowledge right knowledge that

191
00:07:01,330 --> 00:07:04,390
it's happening and it's it's been

192
00:07:02,830 --> 00:07:04,990
quietly rolled out I mean then I keep it

193
00:07:04,390 --> 00:07:06,849
a secret

194
00:07:04,990 --> 00:07:09,070
but it's easy not to realize that all

195
00:07:06,850 --> 00:07:12,400
your Firefox DNS is now being encrypted

196
00:07:09,070 --> 00:07:13,390
right and I don't wanna I'm not gonna

197
00:07:12,400 --> 00:07:15,400
debate the merits

198
00:07:13,390 --> 00:07:17,919
Pro privacy versus Pro network

199
00:07:15,400 --> 00:07:20,049
monitoring me a citizen Conrad I love

200
00:07:17,919 --> 00:07:22,510
this stuff III want to cryptid DNS I

201
00:07:20,050 --> 00:07:24,160
don't want my ISP snooping on my DNS I

202
00:07:22,510 --> 00:07:26,560
don't want my I used to be selling my

203
00:07:24,160 --> 00:07:28,240
DNS you can learn a lot about someone if

204
00:07:26,560 --> 00:07:30,580
you see everywhere every name they

205
00:07:28,240 --> 00:07:31,840
resolve you know about their health you

206
00:07:30,580 --> 00:07:33,250
know about their financial life you know

207
00:07:31,840 --> 00:07:35,919
about their love life you know a lot

208
00:07:33,250 --> 00:07:37,870
believe me I run my own company for 12

209
00:07:35,919 --> 00:07:40,060
years now but previous to that I was the

210
00:07:37,870 --> 00:07:41,020
HIPAA security officer in the u.s. of

211
00:07:40,060 --> 00:07:43,600
course that's the Health Insurance

212
00:07:41,020 --> 00:07:46,049
Portability and Accountability Act the

213
00:07:43,600 --> 00:07:48,370
u.s. Act governing healthcare data and

214
00:07:46,050 --> 00:07:49,690
my team was in charge of all internal

215
00:07:48,370 --> 00:07:52,180
investigations for things like

216
00:07:49,690 --> 00:07:53,770
acceptable use policy violations for a

217
00:07:52,180 --> 00:07:56,260
12,000 employees company now if you'll

218
00:07:53,770 --> 00:07:58,150
accompany you're going to have some

219
00:07:56,260 --> 00:08:00,930
except we use policy violations you know

220
00:07:58,150 --> 00:08:03,549
if one percent of people are wired weird

221
00:08:00,930 --> 00:08:05,110
it's a lot of people at twelve thousand

222
00:08:03,550 --> 00:08:06,190
right and it but numbers probably

223
00:08:05,110 --> 00:08:08,830
greater than one percent you're gonna

224
00:08:06,190 --> 00:08:10,300
have a u P violations right and from DNS

225
00:08:08,830 --> 00:08:10,840
alone you can tell a lot about that

226
00:08:10,300 --> 00:08:13,210
person

227
00:08:10,840 --> 00:08:17,789
so citizen Conrad I love this stuff now

228
00:08:13,210 --> 00:08:20,049
network defender Conrad not so much so

229
00:08:17,790 --> 00:08:21,460
personally I'm Pro privacy for this yes

230
00:08:20,050 --> 00:08:23,290
but from a network

231
00:08:21,460 --> 00:08:26,080
I want this threat hunting tool in my

232
00:08:23,290 --> 00:08:27,370
arsenal right and so we'll talk about

233
00:08:26,080 --> 00:08:28,690
your company needs to come up with a

234
00:08:27,370 --> 00:08:30,130
policy which you probably don't have

235
00:08:28,690 --> 00:08:32,289
today of what is your stance on this

236
00:08:30,130 --> 00:08:33,760
come up with an organization-wide policy

237
00:08:32,289 --> 00:08:35,588
app what what is your view on this right

238
00:08:33,760 --> 00:08:37,450
do you want the DNS encrypt it or not

239
00:08:35,589 --> 00:08:39,460
you want to respect DNS or not right and

240
00:08:37,450 --> 00:08:41,140
then act accordingly and that way you're

241
00:08:39,460 --> 00:08:43,240
making a decision based on the facts and

242
00:08:41,140 --> 00:08:44,890
not just accidentally making decisions

243
00:08:43,240 --> 00:08:48,430
based on ignorance the changes that are

244
00:08:44,890 --> 00:08:50,560
coming now and do H is here it's it's on

245
00:08:48,430 --> 00:08:53,170
in Firefox it's it's on in some places

246
00:08:50,560 --> 00:08:53,920
in Chrome Windows 10 has added is adding

247
00:08:53,170 --> 00:08:55,870
support now

248
00:08:53,920 --> 00:08:57,099
it's coming and I've been defending that

249
00:08:55,870 --> 00:08:59,110
works a long time as I said I'm a

250
00:08:57,100 --> 00:09:02,290
realist it's pretty much here let's deal

251
00:08:59,110 --> 00:09:03,579
with reality and unfortunately there's

252
00:09:02,290 --> 00:09:05,019
two different verses of this this is

253
00:09:03,579 --> 00:09:06,399
totally something from DNS SEC by the

254
00:09:05,019 --> 00:09:09,880
way DNS SEC is a whole different thing

255
00:09:06,399 --> 00:09:12,519
DNS SEC was basically failure to launch

256
00:09:09,880 --> 00:09:14,199
for I don't know 15 20 years it's been

257
00:09:12,519 --> 00:09:17,589
stuck in a launching pad for forever

258
00:09:14,199 --> 00:09:19,599
it's essentially failed and DNS SEC you

259
00:09:17,589 --> 00:09:21,370
know SEC provided essentially it was

260
00:09:19,600 --> 00:09:23,620
like a digital signature for a DNS reply

261
00:09:21,370 --> 00:09:24,820
meaning I know who sent it and I know it

262
00:09:23,620 --> 00:09:26,290
hasn't changed it did not provide

263
00:09:24,820 --> 00:09:28,570
confidentiality I could tell what you

264
00:09:26,290 --> 00:09:30,490
were resolving plain text so DNS SEC did

265
00:09:28,570 --> 00:09:32,410
not address privacy it addressed

266
00:09:30,490 --> 00:09:34,660
integrity and authentication of the

267
00:09:32,410 --> 00:09:37,089
server which is important right that's

268
00:09:34,660 --> 00:09:38,709
called non repudiation to the crypto

269
00:09:37,089 --> 00:09:40,269
people in the room right you can't the

270
00:09:38,709 --> 00:09:42,010
server can't repudiate or deny having

271
00:09:40,269 --> 00:09:43,269
sent that request because you know the

272
00:09:42,010 --> 00:09:43,949
server sent it you know it hasn't

273
00:09:43,269 --> 00:09:46,389
changed right

274
00:09:43,949 --> 00:09:48,160
but the intersect didn't I can still see

275
00:09:46,389 --> 00:09:51,160
resolving google comm or whatever right

276
00:09:48,160 --> 00:09:54,639
so we have two competing standards and

277
00:09:51,160 --> 00:09:56,980
do H is winning do T uses 28 five three

278
00:09:54,639 --> 00:09:58,420
it keeps the control playing separate

279
00:09:56,980 --> 00:09:59,860
from the data plane if you're a Cisco

280
00:09:58,420 --> 00:10:01,750
person or a routing person network

281
00:09:59,860 --> 00:10:04,029
person you know these terms as a network

282
00:10:01,750 --> 00:10:05,470
designer engineer and defender I like

283
00:10:04,029 --> 00:10:07,750
having a control plane meaning how I

284
00:10:05,470 --> 00:10:10,209
manage things separate for my users data

285
00:10:07,750 --> 00:10:11,769
so on a Cisco router you've got the data

286
00:10:10,209 --> 00:10:13,660
plane which is the date of the packets

287
00:10:11,769 --> 00:10:15,250
right and you've got the control plane

288
00:10:13,660 --> 00:10:16,930
which is how you manage that device and

289
00:10:15,250 --> 00:10:18,699
network defenders and architects like

290
00:10:16,930 --> 00:10:21,250
having separate control planes and data

291
00:10:18,699 --> 00:10:24,459
plans I do to do T keeps them separate

292
00:10:21,250 --> 00:10:26,019
do H does not do H it's just data Mouse

293
00:10:24,459 --> 00:10:28,268
so your DNS requests are just

294
00:10:26,019 --> 00:10:30,459
intermingled with your other HT HTTP

295
00:10:28,269 --> 00:10:33,070
traffic right and there's no easy way to

296
00:10:30,459 --> 00:10:35,380
tell that's DNS do T is easy 25 is free

297
00:10:33,070 --> 00:10:39,370
easy you don't want to have do T block

298
00:10:35,380 --> 00:10:41,260
45 3 right simple right and Paul vixie

299
00:10:39,370 --> 00:10:42,970
as we'll see very shortly next slide has

300
00:10:41,260 --> 00:10:47,740
some very very strong opinions on this

301
00:10:42,970 --> 00:10:49,899
but ultimately do H is winning right and

302
00:10:47,740 --> 00:10:52,180
attract you H and Firefox most closely

303
00:10:49,899 --> 00:10:54,130
cuz it's here Jim Troutman give a great

304
00:10:52,180 --> 00:10:55,510
fire talk I learned a lot I think he won

305
00:10:54,130 --> 00:10:57,880
the best fire talk of water shmoocon

306
00:10:55,510 --> 00:10:59,740
this year so check that talk out if you

307
00:10:57,880 --> 00:11:01,240
have it on good it's there's a link on

308
00:10:59,740 --> 00:11:02,819
my website to the dead talk as well

309
00:11:01,240 --> 00:11:05,800
check that out you'll learn a lot

310
00:11:02,819 --> 00:11:07,329
fantastic he has a more you know large

311
00:11:05,800 --> 00:11:08,889
scale isp kind of view which

312
00:11:07,329 --> 00:11:11,138
fantastic cause I don't I don't have

313
00:11:08,889 --> 00:11:13,119
that angle I don't use large scale ISP

314
00:11:11,139 --> 00:11:14,559
work I'm not much of it so great talk

315
00:11:13,119 --> 00:11:18,059
you can't go wrong with Jim's talk are

316
00:11:14,559 --> 00:11:21,040
they highly recommended so the trend is

317
00:11:18,059 --> 00:11:22,569
Linux well Android does do too if you're

318
00:11:21,040 --> 00:11:24,569
an Android phone the current version of

319
00:11:22,569 --> 00:11:27,998
Android you're using d-o-t right now and

320
00:11:24,569 --> 00:11:30,339
pretty much and in Linux can support do

321
00:11:27,999 --> 00:11:32,139
T it doesn't by default but you can turn

322
00:11:30,339 --> 00:11:34,149
it on through like a kernel mod or I

323
00:11:32,139 --> 00:11:35,829
think you have to do a kernel mod or

324
00:11:34,149 --> 00:11:36,819
some change and it can basically force

325
00:11:35,829 --> 00:11:39,189
it non-default

326
00:11:36,819 --> 00:11:41,160
like a bun to can use do T to a

327
00:11:39,189 --> 00:11:43,569
configuration change in a reboot right

328
00:11:41,160 --> 00:11:46,179
but everything else is doing do H

329
00:11:43,569 --> 00:11:49,238
Firefox is do H chrome is do H and

330
00:11:46,179 --> 00:11:50,679
Windows 10 the insider preview is do H

331
00:11:49,239 --> 00:11:53,199
as well and I've been testing that as

332
00:11:50,679 --> 00:11:55,299
well it's not on by default in Windows

333
00:11:53,199 --> 00:11:56,709
10 inside a preview and if you want to

334
00:11:55,299 --> 00:11:58,540
do inside of preview you just sign up I

335
00:11:56,709 --> 00:11:59,649
just signed up recently and he just you

336
00:11:58,540 --> 00:12:01,118
just have to have a Microsoft account

337
00:11:59,649 --> 00:12:02,529
you sign up and you get the beta versus

338
00:12:01,119 --> 00:12:04,629
of Windows you want to kick the tires on

339
00:12:02,529 --> 00:12:05,949
that in a large Windows environment to

340
00:12:04,629 --> 00:12:07,360
see what's coming I recommend someone

341
00:12:05,949 --> 00:12:10,299
probably already has that subscription

342
00:12:07,360 --> 00:12:12,519
is free so I turned that on it requires

343
00:12:10,299 --> 00:12:13,809
a registry change and new options appear

344
00:12:12,519 --> 00:12:15,819
in the configuration panel once you do

345
00:12:13,809 --> 00:12:19,089
that not on by default but essentially

346
00:12:15,819 --> 00:12:21,149
do H my opinion has largely one -

347
00:12:19,089 --> 00:12:23,079
Android essentially is what I'm seeing

348
00:12:21,149 --> 00:12:27,610
again Paul vixie has strong opinions

349
00:12:23,079 --> 00:12:29,079
right it's a cluster duck thank you Paul

350
00:12:27,610 --> 00:12:31,809
for keeping a family friendly so I can

351
00:12:29,079 --> 00:12:33,099
share your quote and of course I like do

352
00:12:31,809 --> 00:12:34,899
age because of the Homer Simpson

353
00:12:33,100 --> 00:12:37,869
connection who doesn't like this right

354
00:12:34,899 --> 00:12:40,779
and Paul vixie is one of the chief

355
00:12:37,869 --> 00:12:43,329
designers of bind he manages the

356
00:12:40,779 --> 00:12:45,699
esophagus or zombies are thank Teresa

357
00:12:43,329 --> 00:12:48,459
certainly senior person there and the

358
00:12:45,699 --> 00:12:50,649
person one of the main architects of DNS

359
00:12:48,459 --> 00:12:52,419
for the past 20-30 years Paul vixie he's

360
00:12:50,649 --> 00:12:53,949
number one on that list right he knows

361
00:12:52,419 --> 00:12:56,110
more about dns than probably anyone else

362
00:12:53,949 --> 00:12:57,849
the planet and he doesn't want this he

363
00:12:56,110 --> 00:12:59,919
doesn't like this he wants to control

364
00:12:57,850 --> 00:13:03,189
playing separate he wants to do T not do

365
00:12:59,919 --> 00:13:05,619
H again do T use a 25:3 do H is simply

366
00:13:03,189 --> 00:13:07,179
HTTP traffic and you're intermingling

367
00:13:05,619 --> 00:13:10,299
the control plane with a data plane he

368
00:13:07,179 --> 00:13:10,869
strongly against it you know but again

369
00:13:10,299 --> 00:13:13,089
I'm a realist

370
00:13:10,869 --> 00:13:14,410
essentially deal which is one sorry Paul

371
00:13:13,089 --> 00:13:18,639
I agree with Paul as a network defender

372
00:13:14,410 --> 00:13:21,680
I agree but I'm a realist right so

373
00:13:18,639 --> 00:13:23,900
Chrome 83 Tuesday

374
00:13:21,680 --> 00:13:26,000
so again if you if you read this talk or

375
00:13:23,900 --> 00:13:27,590
hear this talk in a week I check my

376
00:13:26,000 --> 00:13:29,420
website because it's changing constantly

377
00:13:27,590 --> 00:13:30,500
Chrome 83 they skipped Chrome 82 by the

378
00:13:29,420 --> 00:13:32,120
way they went from Chrome II do you want

379
00:13:30,500 --> 00:13:36,200
to chroma DS read you to the the

380
00:13:32,120 --> 00:13:38,990
pandemic and it's not on on my Chrome's

381
00:13:36,200 --> 00:13:41,090
I tested this week just to see I tested

382
00:13:38,990 --> 00:13:43,640
Chrome and windows and chrome and Mac

383
00:13:41,090 --> 00:13:46,720
and it's not enabled for me and Firefox

384
00:13:43,640 --> 00:13:49,640
it is so it's they're doing a rolling

385
00:13:46,720 --> 00:13:50,840
update just like Firefox did they don't

386
00:13:49,640 --> 00:13:52,640
want to flip the switch for a whole

387
00:13:50,840 --> 00:13:54,020
country overnight that could be

388
00:13:52,640 --> 00:13:55,520
dangerous of course so they doing a

389
00:13:54,020 --> 00:13:59,569
rolling update and I ever got that one

390
00:13:55,520 --> 00:14:02,900
yet but it's coming and also by the way

391
00:13:59,570 --> 00:14:05,960
we'll talk about this Firefox very

392
00:14:02,900 --> 00:14:07,670
controversial II overrides your DNS

393
00:14:05,960 --> 00:14:09,110
provider and she it changes that the

394
00:14:07,670 --> 00:14:10,670
CloudFlare if you're not currently using

395
00:14:09,110 --> 00:14:12,860
clouds layer that is a highly

396
00:14:10,670 --> 00:14:14,000
controversial decision you of course can

397
00:14:12,860 --> 00:14:15,950
change that to anything you want you

398
00:14:14,000 --> 00:14:17,630
could turn this off easily right it's

399
00:14:15,950 --> 00:14:19,850
easy to turn off at Firefox we'll talk

400
00:14:17,630 --> 00:14:21,650
about ways to do that but Firefox

401
00:14:19,850 --> 00:14:24,230
overrides whatever configuration you

402
00:14:21,650 --> 00:14:26,090
have right and goes to clouds there by

403
00:14:24,230 --> 00:14:27,110
default and as I said you can change

404
00:14:26,090 --> 00:14:28,850
that but one thing I've learned in my

405
00:14:27,110 --> 00:14:30,710
career is defaults are positive they

406
00:14:28,850 --> 00:14:31,820
tend to stick whatever is that if the

407
00:14:30,710 --> 00:14:33,800
default is what most companies

408
00:14:31,820 --> 00:14:35,570
organizations are going to use so you

409
00:14:33,800 --> 00:14:37,069
may be using CloudFlare as your DNS

410
00:14:35,570 --> 00:14:38,540
provider having not made that conscious

411
00:14:37,070 --> 00:14:40,720
decision to do that and being unaware

412
00:14:38,540 --> 00:14:43,819
it's happened all right

413
00:14:40,720 --> 00:14:46,340
so again Firefox highly controversial

414
00:14:43,820 --> 00:14:47,780
they override set you to CloudFlare this

415
00:14:46,340 --> 00:14:48,380
comes into a who do you trust game like

416
00:14:47,780 --> 00:14:50,839
who do you trust

417
00:14:48,380 --> 00:14:52,760
right you trust CloudFlare you do I

418
00:14:50,840 --> 00:14:56,630
trust clouds that flare more than my ISP

419
00:14:52,760 --> 00:14:58,819
I do actually not to monetize that you

420
00:14:56,630 --> 00:15:00,680
know you can check their their their

421
00:14:58,820 --> 00:15:02,660
policy on how they share data in the

422
00:15:00,680 --> 00:15:04,280
privacy policy and it's certainly better

423
00:15:02,660 --> 00:15:05,569
than my ISPs you know so I'm not

424
00:15:04,280 --> 00:15:07,120
knocking my eyes Peter say but they do

425
00:15:05,570 --> 00:15:09,830
sell that data you know it's a way to

426
00:15:07,120 --> 00:15:12,080
make more profit from you to see the

427
00:15:09,830 --> 00:15:14,150
sites you're resolving and conveniently

428
00:15:12,080 --> 00:15:15,740
set your DNS to their resolvers very

429
00:15:14,150 --> 00:15:17,270
convenient now that's convenient for

430
00:15:15,740 --> 00:15:19,100
Speed purposes but also it's convenient

431
00:15:17,270 --> 00:15:22,100
for monitoring purposes and monetization

432
00:15:19,100 --> 00:15:23,750
purposes right chrome uses a different

433
00:15:22,100 --> 00:15:27,110
approach I agree with Chrome's approach

434
00:15:23,750 --> 00:15:28,760
more so than Firefox Chrome says okay if

435
00:15:27,110 --> 00:15:31,130
you're using one of those providers and

436
00:15:28,760 --> 00:15:34,550
that that list will change and grow we

437
00:15:31,130 --> 00:15:36,290
will upgrade your DNS to do H if you

438
00:15:34,550 --> 00:15:37,490
we're gonna leave it all alone right so

439
00:15:36,290 --> 00:15:40,189
I'm not going to change your provider

440
00:15:37,490 --> 00:15:42,709
from Google the CloudFlare which is what

441
00:15:40,190 --> 00:15:45,380
Firefox would do by default Chrome if

442
00:15:42,709 --> 00:15:48,079
you using Google it'll upgrade your DNS

443
00:15:45,380 --> 00:15:50,269
to do H obey it by the way old DNS is

444
00:15:48,080 --> 00:15:52,700
now called do 53 and it's an easier

445
00:15:50,269 --> 00:15:55,070
certainly more slide friendly way than

446
00:15:52,700 --> 00:15:58,370
saying unencrypted DNS over UDP port 53

447
00:15:55,070 --> 00:16:00,019
every time you just say do 53 right and

448
00:15:58,370 --> 00:16:02,930
Jim trout when I picked that up from Jim

449
00:16:00,019 --> 00:16:05,240
Trotman thanks Jim and so deal 53 is the

450
00:16:02,930 --> 00:16:07,579
unencrypted DNS which is largely over

451
00:16:05,240 --> 00:16:09,019
UDP port 53 right so if you're using one

452
00:16:07,579 --> 00:16:11,540
of these providers they'll upgrade you

453
00:16:09,019 --> 00:16:13,190
to HTTPS DLH if you're not to leave you

454
00:16:11,540 --> 00:16:16,670
alone I agree with that

455
00:16:13,190 --> 00:16:19,279
again Firefox will override you and go

456
00:16:16,670 --> 00:16:20,870
over to college layer now this talk is

457
00:16:19,279 --> 00:16:23,480
two parts I'm at the stay in the intro

458
00:16:20,870 --> 00:16:25,519
and I kind of got moving too fast the

459
00:16:23,480 --> 00:16:26,870
state of the art on encrypted DNS and

460
00:16:25,519 --> 00:16:27,769
then what to monitor but first what the

461
00:16:26,870 --> 00:16:29,420
deal with this elephant in the room

462
00:16:27,769 --> 00:16:31,970
which is encrypted DNS then we'll get it

463
00:16:29,420 --> 00:16:33,290
to monitoring all right so what's your

464
00:16:31,970 --> 00:16:34,730
policy you should have a policy none of

465
00:16:33,290 --> 00:16:36,740
my clients to do probably hardly anyone

466
00:16:34,730 --> 00:16:38,420
does what's your stance you know if

467
00:16:36,740 --> 00:16:40,279
you're pro privacy just embrace the

468
00:16:38,420 --> 00:16:42,319
embrace the privacy ride that way right

469
00:16:40,279 --> 00:16:43,610
in fact you could accelerate that wave

470
00:16:42,320 --> 00:16:46,130
you know chrome doesn't have this turned

471
00:16:43,610 --> 00:16:48,230
on by default turn or not right at home

472
00:16:46,130 --> 00:16:50,660
that's exactly what I do all right so

473
00:16:48,230 --> 00:16:52,250
either ride that wave and embrace this

474
00:16:50,660 --> 00:16:55,160
and if you're not looking at DNS now

475
00:16:52,250 --> 00:16:57,140
well what's the harm right you are

476
00:16:55,160 --> 00:16:58,790
looking at DNS for you know an analysis

477
00:16:57,140 --> 00:16:59,839
purposes correlation purposes right any

478
00:16:58,790 --> 00:17:01,939
purposes well now you have some

479
00:16:59,839 --> 00:17:04,189
decisions to make right you could force

480
00:17:01,940 --> 00:17:06,589
it back the old way you can force chrome

481
00:17:04,189 --> 00:17:08,600
to go plaintext right and I'll show you

482
00:17:06,589 --> 00:17:11,059
some diagrams of where it ends up

483
00:17:08,599 --> 00:17:13,129
ultimately much like a VPN it's gonna

484
00:17:11,059 --> 00:17:14,689
get decrypted somewhere right if you're

485
00:17:13,130 --> 00:17:16,400
using a VPN to surf the internet you

486
00:17:14,689 --> 00:17:18,380
just pushing the unencrypted part

487
00:17:16,400 --> 00:17:20,179
further out away from you but at some

488
00:17:18,380 --> 00:17:22,490
point it's gonna be plain text right

489
00:17:20,179 --> 00:17:24,530
same thing with do eights at some point

490
00:17:22,490 --> 00:17:26,929
in most cases with that one exception I

491
00:17:24,530 --> 00:17:28,639
can think of if I'm resolving do H via

492
00:17:26,929 --> 00:17:31,130
Google comm and I resolve say Amazon

493
00:17:28,640 --> 00:17:35,150
comm the actual resolution at the end

494
00:17:31,130 --> 00:17:37,730
will be do 53 as we see here so I'm

495
00:17:35,150 --> 00:17:39,740
using Google and or amusing Firefox

496
00:17:37,730 --> 00:17:41,570
today I'm using Firefox today right and

497
00:17:39,740 --> 00:17:44,000
I haven't changed it in the US what's

498
00:17:41,570 --> 00:17:46,309
happening is I've got do H going through

499
00:17:44,000 --> 00:17:48,530
my firewall to in this case sorry

500
00:17:46,309 --> 00:17:50,780
CloudFlare

501
00:17:48,530 --> 00:17:52,850
backing up now and then cloud for them

502
00:17:50,780 --> 00:17:55,580
resolves for me and again who do you

503
00:17:52,850 --> 00:17:58,850
trust your eyes I can't see this easily

504
00:17:55,580 --> 00:18:00,800
I can't intercept as easily ah you know

505
00:17:58,850 --> 00:18:02,840
it's difficult to see that now can you

506
00:18:00,800 --> 00:18:05,600
do TLS interception sure you can do a

507
00:18:02,840 --> 00:18:07,189
thing like a blue code blue code SSL

508
00:18:05,600 --> 00:18:08,780
proxy there's a whole bunch of

509
00:18:07,190 --> 00:18:10,490
certificate work behind the scenes on

510
00:18:08,780 --> 00:18:12,379
that but some large companies certainly

511
00:18:10,490 --> 00:18:13,760
many governments do perform SSL

512
00:18:12,380 --> 00:18:16,070
inspection if you perform tls/ssl

513
00:18:13,760 --> 00:18:17,750
inspection okay you'll see it if you

514
00:18:16,070 --> 00:18:20,270
don't you're not gonna see it right and

515
00:18:17,750 --> 00:18:22,670
again it's simply web traffic as I'll

516
00:18:20,270 --> 00:18:24,139
show you in a little bit right so who do

517
00:18:22,670 --> 00:18:26,030
you trust at this point you're pushing

518
00:18:24,140 --> 00:18:28,430
the trust out to Google or CloudFlare or

519
00:18:26,030 --> 00:18:31,190
quad 9 or your own you'll run your own

520
00:18:28,430 --> 00:18:32,930
DNA servers I do I run my own custom voh

521
00:18:31,190 --> 00:18:34,880
server myself it's very very easy to do

522
00:18:32,930 --> 00:18:36,560
and I recommend if you're curious about

523
00:18:34,880 --> 00:18:38,180
this there's an old saying in the

524
00:18:36,560 --> 00:18:40,159
industry eat your own dog food right

525
00:18:38,180 --> 00:18:42,620
which means use this stuff right so if

526
00:18:40,160 --> 00:18:45,080
you're curious do it set it up as I did

527
00:18:42,620 --> 00:18:46,669
just eight students asking me you know I

528
00:18:45,080 --> 00:18:49,399
teach for sans and what does it look

529
00:18:46,670 --> 00:18:51,080
like I'm like I'm I don't know let me

530
00:18:49,400 --> 00:18:52,250
find out and I set it up and it's very

531
00:18:51,080 --> 00:18:54,320
easy to set up and I'll show you how in

532
00:18:52,250 --> 00:18:56,090
a little bit in this case we're pushing

533
00:18:54,320 --> 00:18:58,790
trust up to CloudFlare in my case I have

534
00:18:56,090 --> 00:19:00,439
my own do a server in digital oceans

535
00:18:58,790 --> 00:19:03,290
cloud that costs five dollars a month to

536
00:19:00,440 --> 00:19:04,820
run my own personal do 8 server and in

537
00:19:03,290 --> 00:19:06,590
this case it's my server there you can

538
00:19:04,820 --> 00:19:08,899
use a custom server as well so that's

539
00:19:06,590 --> 00:19:10,939
what's happening now largely blinding

540
00:19:08,900 --> 00:19:14,060
most organizations to the DNS now one

541
00:19:10,940 --> 00:19:17,420
thing you can do again you can you can

542
00:19:14,060 --> 00:19:19,010
force everything back to do 53 or you

543
00:19:17,420 --> 00:19:21,170
could run your own custom DNS server

544
00:19:19,010 --> 00:19:23,090
either internally in this case or in the

545
00:19:21,170 --> 00:19:25,670
cloud as I do if you run your own

546
00:19:23,090 --> 00:19:28,730
internal DNS server do a server as well

547
00:19:25,670 --> 00:19:30,890
you can still analyze on the server log

548
00:19:28,730 --> 00:19:32,510
on the server you can still analyze but

549
00:19:30,890 --> 00:19:34,580
Zeke after the server now what's

550
00:19:32,510 --> 00:19:37,070
happening what you're losing here is if

551
00:19:34,580 --> 00:19:38,810
I analyze here with Zeke I don't know

552
00:19:37,070 --> 00:19:40,700
what client necessarily made the request

553
00:19:38,810 --> 00:19:42,950
because it's coming from the DNS server

554
00:19:40,700 --> 00:19:45,380
right so I'm source of DNS server

555
00:19:42,950 --> 00:19:48,260
destination wherever right this is kind

556
00:19:45,380 --> 00:19:51,950
of a middle step you know away from that

557
00:19:48,260 --> 00:19:54,020
but you know while encrypting some

558
00:19:51,950 --> 00:19:57,530
traffic you know it's good of all deal

559
00:19:54,020 --> 00:19:59,780
53 you could have this or that those

560
00:19:57,530 --> 00:20:01,760
your options right and I currently use

561
00:19:59,780 --> 00:20:02,330
this for my traffic again using a custom

562
00:20:01,760 --> 00:20:05,840
deal

563
00:20:02,330 --> 00:20:07,879
server which I'll talk about in a bit

564
00:20:05,840 --> 00:20:09,889
Firefox very easy to disable at the

565
00:20:07,880 --> 00:20:12,529
enterprise level simply you don't let

566
00:20:09,890 --> 00:20:14,570
that name resolve if that name fails to

567
00:20:12,529 --> 00:20:17,570
resolve Firefox won't use do X so that's

568
00:20:14,570 --> 00:20:21,019
an easy flip the switch switch the flip

569
00:20:17,570 --> 00:20:22,370
sorry easy switch to flip and piece of

570
00:20:21,019 --> 00:20:24,320
cake to do it you can also touch each

571
00:20:22,370 --> 00:20:27,168
client and these can be managed through

572
00:20:24,320 --> 00:20:28,908
group policy and windows as well I'm no

573
00:20:27,169 --> 00:20:29,419
expert on GPOs and Windows you can do it

574
00:20:28,909 --> 00:20:31,549
that way

575
00:20:29,419 --> 00:20:34,549
Chrome there's no canary domain support

576
00:20:31,549 --> 00:20:36,110
they didn't turn that on its going to

577
00:20:34,549 --> 00:20:38,840
upgrade auto upgrade anything to wear

578
00:20:36,110 --> 00:20:41,990
you know a supportive provider which

579
00:20:38,840 --> 00:20:44,928
again was here and the easy work around

580
00:20:41,990 --> 00:20:46,700
there is if you're if you don't use a

581
00:20:44,929 --> 00:20:48,289
support provider chrome will not Auto

582
00:20:46,700 --> 00:20:50,960
upgrade so that's kind of the easy

583
00:20:48,289 --> 00:20:53,000
workaround to dodge that if you want to

584
00:20:50,960 --> 00:20:57,710
disable do H and go back to the old way

585
00:20:53,000 --> 00:20:59,450
right I highly recommend this I was done

586
00:20:57,710 --> 00:21:01,370
about 10 minutes having never done this

587
00:20:59,450 --> 00:21:03,019
before you know I've set up plenty of

588
00:21:01,370 --> 00:21:05,418
Linux servers in the cloud don't get me

589
00:21:03,019 --> 00:21:08,899
wrong but as far as this piece really

590
00:21:05,419 --> 00:21:10,940
really easy shout out to this write up

591
00:21:08,899 --> 00:21:12,529
and once you do your own custom voh

592
00:21:10,940 --> 00:21:14,600
server you're eating your own dog food

593
00:21:12,529 --> 00:21:17,899
and while you're at it why not set up a

594
00:21:14,600 --> 00:21:18,980
pie hole right it's called pie hole cuz

595
00:21:17,899 --> 00:21:21,678
it's designed to run on Raspberry Pi

596
00:21:18,980 --> 00:21:23,960
that does DNS ad blocking through DMS

597
00:21:21,679 --> 00:21:25,970
right super useful especially if you

598
00:21:23,960 --> 00:21:27,710
have the things like Smart TVs and

599
00:21:25,970 --> 00:21:30,110
things like that you know and remember

600
00:21:27,710 --> 00:21:31,760
remember a high peninsula Mikko - in

601
00:21:30,110 --> 00:21:33,979
when something's called smart it's

602
00:21:31,760 --> 00:21:36,649
vulnerable so your Smart TV meeting

603
00:21:33,980 --> 00:21:39,320
you're vulnerable TV right and TV

604
00:21:36,649 --> 00:21:42,320
speaking of privacy TVs do Smart TVs do

605
00:21:39,320 --> 00:21:45,678
crazy amounts of stalking of you Vizio

606
00:21:42,320 --> 00:21:49,250
TVs track every pixel you watch is by

607
00:21:45,679 --> 00:21:50,899
default irrespective of input source you

608
00:21:49,250 --> 00:21:52,610
could be watching TV over-the-air some

609
00:21:50,899 --> 00:21:54,139
HD antenna and they can still tell what

610
00:21:52,610 --> 00:21:56,178
you're watching based on tracking pixels

611
00:21:54,139 --> 00:21:58,070
you know click by click Add by add

612
00:21:56,179 --> 00:21:59,929
shield by shield regardless of the input

613
00:21:58,070 --> 00:22:03,350
they can track you I don't want that

614
00:21:59,929 --> 00:22:04,909
right so pie hole is was designed to run

615
00:22:03,350 --> 00:22:06,860
firown' raspberry pies the software

616
00:22:04,909 --> 00:22:08,690
simply Linux software so if you set up

617
00:22:06,860 --> 00:22:10,158
your own d-wade server one I set up a

618
00:22:08,690 --> 00:22:12,649
block and while you're at it

619
00:22:10,159 --> 00:22:14,480
via dns very clean and a really nice

620
00:22:12,649 --> 00:22:15,830
solution and again I did a digitalocean

621
00:22:14,480 --> 00:22:17,539
veep Linux

622
00:22:15,830 --> 00:22:20,090
see I'm a small one which handles this

623
00:22:17,539 --> 00:22:24,919
fine $5.00 us a month not expensive

624
00:22:20,090 --> 00:22:27,139
right and you set up your server and now

625
00:22:24,919 --> 00:22:30,890
you can log here is my Firefox

626
00:22:27,140 --> 00:22:32,870
configuration today I use my ZZ to me as

627
00:22:30,890 --> 00:22:34,250
one of my domains Macedonia had a $1

628
00:22:32,870 --> 00:22:36,229
sale one year and I bought a bunch of

629
00:22:34,250 --> 00:22:38,029
Macedonian also main because I live in

630
00:22:36,230 --> 00:22:40,490
Maine you know it actually stands for

631
00:22:38,029 --> 00:22:42,470
Macedonia not main but main companies

632
00:22:40,490 --> 00:22:44,649
use dot me and and these short domains

633
00:22:42,470 --> 00:22:47,659
available so it says dot me is mine and

634
00:22:44,649 --> 00:22:51,080
you can log right there CDA server it

635
00:22:47,659 --> 00:22:53,389
doesn't log replies responses that I can

636
00:22:51,080 --> 00:22:54,799
see but it's it's open source software

637
00:22:53,389 --> 00:22:56,149
and wouldn't I haven't done this yet but

638
00:22:54,799 --> 00:22:59,210
it'd be a piece of cake the modded and I

639
00:22:56,149 --> 00:23:01,639
plan to mod it and I'll fork that on

640
00:22:59,210 --> 00:23:03,289
github and share my mind and I'm also

641
00:23:01,639 --> 00:23:07,340
probably gonna end up writing software

642
00:23:03,289 --> 00:23:09,408
to I'll put it in github amerikaner I

643
00:23:07,340 --> 00:23:11,559
get I'm just Google Eric Conrad github

644
00:23:09,409 --> 00:23:14,120
or blue team you'll you'll see it and

645
00:23:11,559 --> 00:23:16,399
convert logs like this to a Zeke style

646
00:23:14,120 --> 00:23:17,928
form that way you anything that it just

647
00:23:16,399 --> 00:23:19,219
Zeke logs can also adjust this that's

648
00:23:17,929 --> 00:23:21,169
all my to-do list for the next time I

649
00:23:19,220 --> 00:23:25,639
give a talk like this so stay tuned on

650
00:23:21,169 --> 00:23:26,870
that and it is simply a web app so once

651
00:23:25,639 --> 00:23:29,029
you set the whole thing up you realize

652
00:23:26,870 --> 00:23:32,330
it's simply posting data to a web app so

653
00:23:29,029 --> 00:23:34,250
trying to detect do H is you're trying

654
00:23:32,330 --> 00:23:36,470
to detect a web app that's encrypted

655
00:23:34,250 --> 00:23:38,840
really now if you go to an own site okay

656
00:23:36,470 --> 00:23:39,980
one dot one dot one dot one port 443

657
00:23:38,840 --> 00:23:42,230
that's easy right

658
00:23:39,980 --> 00:23:44,929
that's CloudFlare right or 80 80 80

659
00:23:42,230 --> 00:23:47,269
which is Google or 99.9 quad nine that's

660
00:23:44,929 --> 00:23:50,480
easy right but if it's detecting that is

661
00:23:47,269 --> 00:23:52,340
easy but detecting mind not so easy like

662
00:23:50,480 --> 00:23:53,990
how do you detect that what happens when

663
00:23:52,340 --> 00:23:56,149
malware does that right what happens

664
00:23:53,990 --> 00:23:58,039
malware does that right and I'm focusing

665
00:23:56,149 --> 00:24:00,649
on Firefox now but if I were an evil

666
00:23:58,039 --> 00:24:03,080
malware author and I'm obviously not I

667
00:24:00,649 --> 00:24:04,580
would have my malware resolved uhv our

668
00:24:03,080 --> 00:24:08,090
custom server oh you bet you bet it

669
00:24:04,580 --> 00:24:10,010
would of course I would it's I don't see

670
00:24:08,090 --> 00:24:11,959
much of that now it's coming it's too

671
00:24:10,010 --> 00:24:14,600
smart of an idea not to happen right so

672
00:24:11,960 --> 00:24:16,580
expect that to come so saying Firefox

673
00:24:14,600 --> 00:24:17,870
you shall not resolve the Adia weights

674
00:24:16,580 --> 00:24:19,460
that's fine your malware is gonna do

675
00:24:17,870 --> 00:24:22,100
whatever you've always been do right as

676
00:24:19,460 --> 00:24:23,510
malware tends to do so I don't see a lot

677
00:24:22,100 --> 00:24:27,139
of this now but expect the coming wave

678
00:24:23,510 --> 00:24:29,010
of malware using do h2 non unknown do a

679
00:24:27,139 --> 00:24:30,629
service not on any less still he's not

680
00:24:29,010 --> 00:24:35,670
that that's going to happen so prepare

681
00:24:30,630 --> 00:24:37,050
for that right and as I said known sites

682
00:24:35,670 --> 00:24:39,060
you want to block this your your

683
00:24:37,050 --> 00:24:41,460
firewall person you know your firewall

684
00:24:39,060 --> 00:24:43,620
team wants to block this okay CloudFlare

685
00:24:41,460 --> 00:24:47,730
you know your policy is unencrypted

686
00:24:43,620 --> 00:24:51,360
let's say you know do Tec 45 3 TCP

687
00:24:47,730 --> 00:24:53,670
blocked done piece of cake right do 8 is

688
00:24:51,360 --> 00:24:55,909
simply a web app port 4 for 3 you can't

689
00:24:53,670 --> 00:24:58,680
block all that clearly without well

690
00:24:55,910 --> 00:25:01,830
interception and so you can block 2

691
00:24:58,680 --> 00:25:04,230
known providers quad 9 Google etc but

692
00:25:01,830 --> 00:25:06,689
that leaves unknown like my DNS says

693
00:25:04,230 --> 00:25:08,220
dummy good luck good luck and I can

694
00:25:06,690 --> 00:25:13,800
change that IP or that name any time I

695
00:25:08,220 --> 00:25:16,620
want right piece of cake so how would

696
00:25:13,800 --> 00:25:18,560
you detect a piece of malware is now

697
00:25:16,620 --> 00:25:21,270
resolving via do h to an unknown

698
00:25:18,560 --> 00:25:23,970
resolver that's not on any list your

699
00:25:21,270 --> 00:25:26,700
best shot is beaconing so beaconing is

700
00:25:23,970 --> 00:25:27,990
an idea which looks like massive amounts

701
00:25:26,700 --> 00:25:29,490
of beaconing if you're detecting

702
00:25:27,990 --> 00:25:31,710
beaconing today you've already you're

703
00:25:29,490 --> 00:25:33,990
already detecting toh and your beaconing

704
00:25:31,710 --> 00:25:36,120
probably went ballistic when firefox up

705
00:25:33,990 --> 00:25:38,040
that switch how many times does a

706
00:25:36,120 --> 00:25:39,659
browsers resolve a name in an hour

707
00:25:38,040 --> 00:25:41,100
that's being actively used you're

708
00:25:39,660 --> 00:25:43,410
talking hundreds and thousands of times

709
00:25:41,100 --> 00:25:45,810
so from a beep so beaconing is one the

710
00:25:43,410 --> 00:25:48,330
malware phones home ET phones home right

711
00:25:45,810 --> 00:25:50,700
the malware phones home and malware at

712
00:25:48,330 --> 00:25:52,409
least used to you can set your watch by

713
00:25:50,700 --> 00:25:53,460
it like some older malware and they're

714
00:25:52,410 --> 00:25:56,640
changing this now because it's too easy

715
00:25:53,460 --> 00:25:58,830
to detect every 60 seconds you know 24/7

716
00:25:56,640 --> 00:26:01,920
365 sending something to the internet

717
00:25:58,830 --> 00:26:03,510
the same hours got smarter now because I

718
00:26:01,920 --> 00:26:04,590
can detect that encrypted or unencrypted

719
00:26:03,510 --> 00:26:06,750
that's a piece that's called beaconing

720
00:26:04,590 --> 00:26:08,310
right so net flow can detect that and

721
00:26:06,750 --> 00:26:10,410
tools like rita by John strand John

722
00:26:08,310 --> 00:26:11,669
strands company donated the we go to

723
00:26:10,410 --> 00:26:14,040
training apparently and John's a friend

724
00:26:11,670 --> 00:26:15,510
of mine and Black Hills has amazing

725
00:26:14,040 --> 00:26:17,190
people and amazing stuff and that's yet

726
00:26:15,510 --> 00:26:19,980
another amazing things from Black Hills

727
00:26:17,190 --> 00:26:21,450
thank you John and team for Reta me and

728
00:26:19,980 --> 00:26:24,210
John have discussed beaconing you know

729
00:26:21,450 --> 00:26:25,860
in the past security 511 has we do

730
00:26:24,210 --> 00:26:29,760
beacon II labs and I'm gonna ask her

731
00:26:25,860 --> 00:26:31,260
that and Rita I had a very simple take

732
00:26:29,760 --> 00:26:34,770
on beaconing looking for something going

733
00:26:31,260 --> 00:26:36,240
like you know how many times my take on

734
00:26:34,770 --> 00:26:38,730
beaconing which worked great five years

735
00:26:36,240 --> 00:26:40,710
ago and not so much now carve the day

736
00:26:38,730 --> 00:26:42,540
into five minutes shucks

737
00:26:40,710 --> 00:26:45,440
like you know from midnight

738
00:26:42,540 --> 00:26:47,760
12:05 12:05 to 12 10 12 10 12 15 and

739
00:26:45,440 --> 00:26:50,220
each of those is a one whether I send

740
00:26:47,760 --> 00:26:52,110
one packet or a thousand that's a one so

741
00:26:50,220 --> 00:26:54,960
has any system sent at least one packet

742
00:26:52,110 --> 00:26:57,030
from 1205 into twelve ten then twelve

743
00:26:54,960 --> 00:26:58,680
ten into twelve fifteen twelve fifteen

744
00:26:57,030 --> 00:27:01,110
to twelve twenty and I called that

745
00:26:58,680 --> 00:27:02,340
script persistent on pl yes pearl it's

746
00:27:01,110 --> 00:27:05,459
an older script I've been using it for

747
00:27:02,340 --> 00:27:07,379
twenty years and that catches simple

748
00:27:05,460 --> 00:27:08,850
beaconing but it'll catch this to read

749
00:27:07,380 --> 00:27:11,100
it there's a much more behavioral model

750
00:27:08,850 --> 00:27:12,179
of beaconing but both will catch this so

751
00:27:11,100 --> 00:27:14,929
it's simply because you're gonna be

752
00:27:12,180 --> 00:27:17,130
connecting 29.99 at nine or anything

753
00:27:14,930 --> 00:27:19,080
hundreds or thousands of times per hour

754
00:27:17,130 --> 00:27:20,400
and it get a light up beaconing so

755
00:27:19,080 --> 00:27:21,600
beaconing will catch that that's good

756
00:27:20,400 --> 00:27:23,040
including now we're going to unknown

757
00:27:21,600 --> 00:27:25,860
resolvers as long as it's resolving a

758
00:27:23,040 --> 00:27:28,260
lot you'll catch it another wonderful

759
00:27:25,860 --> 00:27:29,280
feature of system on added very recently

760
00:27:28,260 --> 00:27:34,040
dns logging

761
00:27:29,280 --> 00:27:34,040
unfortunately Firefox bypasses this too

762
00:27:34,160 --> 00:27:39,210
so you can now log through windows event

763
00:27:37,500 --> 00:27:40,920
forwarding sis bonds not installed by

764
00:27:39,210 --> 00:27:43,740
default but it is there as a separate

765
00:27:40,920 --> 00:27:46,290
download you can um have log everything

766
00:27:43,740 --> 00:27:48,600
each client does each application does

767
00:27:46,290 --> 00:27:50,370
which is powerful Firefox bypasses all

768
00:27:48,600 --> 00:27:52,620
this system or does not log that but he

769
00:27:50,370 --> 00:27:54,750
has no it looks like this gives you the

770
00:27:52,620 --> 00:27:57,929
visibility to not only know what the

771
00:27:54,750 --> 00:27:59,580
client IP or system is resolving you

772
00:27:57,930 --> 00:28:02,190
know which application is doing it this

773
00:27:59,580 --> 00:28:04,169
is solid gold from a spread hunting

774
00:28:02,190 --> 00:28:05,910
standpoint knowing what the application

775
00:28:04,170 --> 00:28:08,220
that made the resolution request oh that

776
00:28:05,910 --> 00:28:09,570
is that is a dream that is an absolute

777
00:28:08,220 --> 00:28:11,130
dream that nothing else gives you I mean

778
00:28:09,570 --> 00:28:12,840
you might have a kitane IAM or a carbon

779
00:28:11,130 --> 00:28:14,700
black that gives you some EDR solution

780
00:28:12,840 --> 00:28:17,129
but for free

781
00:28:14,700 --> 00:28:18,930
built-in I will not built in but free

782
00:28:17,130 --> 00:28:20,730
download from Microsoft this is a green

783
00:28:18,930 --> 00:28:22,830
check out this mod is wonderful for lots

784
00:28:20,730 --> 00:28:24,960
of reasons beyond this but including

785
00:28:22,830 --> 00:28:26,610
this it's it's great but does not get do

786
00:28:24,960 --> 00:28:29,910
H through Firefox oh I haven't tested

787
00:28:26,610 --> 00:28:31,979
chrome yeah but I suspect same thing all

788
00:28:29,910 --> 00:28:34,140
right that is a crash 20 minute course

789
00:28:31,980 --> 00:28:37,170
in the 25 minute course and the state of

790
00:28:34,140 --> 00:28:38,790
the art of DNS encryption I could talk

791
00:28:37,170 --> 00:28:39,930
for hours but I won't I've got about 20

792
00:28:38,790 --> 00:28:42,389
minutes left to cover the rest of this

793
00:28:39,930 --> 00:28:44,130
all right you're now getting DNS right

794
00:28:42,390 --> 00:28:46,620
what do you do

795
00:28:44,130 --> 00:28:48,930
DNS makes the best tunneling mechanism

796
00:28:46,620 --> 00:28:50,870
in my opinion and so it's a great

797
00:28:48,930 --> 00:28:54,210
tunneling mechanism and it's a great

798
00:28:50,870 --> 00:28:55,199
malware uses DNS heavily right and I'm

799
00:28:54,210 --> 00:28:55,980
going to go through all these examples

800
00:28:55,200 --> 00:28:59,279
now

801
00:28:55,980 --> 00:29:01,769
but what do you look for now the old way

802
00:28:59,279 --> 00:29:03,269
was the blacklist kill this site's evil

803
00:29:01,769 --> 00:29:05,250
put it on a blacklist criminals to

804
00:29:03,269 --> 00:29:06,960
figure that out that's not pointless but

805
00:29:05,250 --> 00:29:09,690
not very useful anymore I'll talk about

806
00:29:06,960 --> 00:29:10,950
why but requests to hundreds of

807
00:29:09,690 --> 00:29:13,049
thousands of things dot something dot

808
00:29:10,950 --> 00:29:16,010
something like how many things cool calm

809
00:29:13,049 --> 00:29:18,690
you resolve like www.google.com/mapmaker

810
00:29:16,010 --> 00:29:22,080
calm how many things Google calm you

811
00:29:18,690 --> 00:29:25,409
resolve a handful a dozen maybe two not

812
00:29:22,080 --> 00:29:26,939
3,000 not 3,000 different things nobody

813
00:29:25,409 --> 00:29:28,679
does that not on the internet that's not

814
00:29:26,940 --> 00:29:31,500
common at all malware does that all the

815
00:29:28,679 --> 00:29:33,720
time right any large DNS requests any

816
00:29:31,500 --> 00:29:35,070
large DNS reply text records no records

817
00:29:33,720 --> 00:29:37,559
as far as I can tell are exclusively

818
00:29:35,070 --> 00:29:40,049
evil it carries binary data through DNS

819
00:29:37,559 --> 00:29:41,610
any use of null you should block no

820
00:29:40,049 --> 00:29:43,740
records block an alert I've never seen

821
00:29:41,610 --> 00:29:45,209
no use for anything but now malice if

822
00:29:43,740 --> 00:29:47,279
you have a counterexample please let me

823
00:29:45,210 --> 00:29:48,899
know I asked everyone in this space if

824
00:29:47,279 --> 00:29:51,450
you have a counter example of no records

825
00:29:48,899 --> 00:29:53,250
being used for good email me econ read

826
00:29:51,450 --> 00:29:54,620
back show net and I'd love to see that

827
00:29:53,250 --> 00:29:56,570
use case I've never seen it right

828
00:29:54,620 --> 00:29:59,309
massive amounts of failures

829
00:29:56,570 --> 00:30:00,689
unfortunately that's common anyways it

830
00:29:59,309 --> 00:30:02,519
can be especially in poorly designed

831
00:30:00,690 --> 00:30:04,710
networks or applications but that's a

832
00:30:02,519 --> 00:30:06,510
sign and baby domains which is our term

833
00:30:04,710 --> 00:30:09,029
for something I've registered today or

834
00:30:06,510 --> 00:30:10,769
yesterday how often does your CFO go to

835
00:30:09,029 --> 00:30:12,840
a site register today or yesterday or a

836
00:30:10,769 --> 00:30:13,950
domain registered yesterday and they're

837
00:30:12,840 --> 00:30:16,230
not when they're not falling for a

838
00:30:13,950 --> 00:30:19,860
phishing campaign right never happens

839
00:30:16,230 --> 00:30:21,990
never happens right so historically what

840
00:30:19,860 --> 00:30:25,168
happened was zones noise comm that this

841
00:30:21,990 --> 00:30:27,779
is the Zeus botnet notorious notorious

842
00:30:25,169 --> 00:30:30,299
banking botnet right and historically

843
00:30:27,779 --> 00:30:32,220
some vendors ago zones nas comm your

844
00:30:30,299 --> 00:30:34,350
evil will put you on a list bad domain

845
00:30:32,220 --> 00:30:36,000
right and you have this black list and

846
00:30:34,350 --> 00:30:37,408
black list or whack Amole whack Amole

847
00:30:36,000 --> 00:30:38,580
know that that carnival game we hid in

848
00:30:37,409 --> 00:30:39,870
the moles and every time you whack them

849
00:30:38,580 --> 00:30:41,668
all another one pops up and they're

850
00:30:39,870 --> 00:30:43,289
they're popping up too fast to whack and

851
00:30:41,669 --> 00:30:45,419
that's the game right same thing here

852
00:30:43,289 --> 00:30:48,629
it's zones noise calm for the next four

853
00:30:45,419 --> 00:30:49,980
hours and then domain name generation

854
00:30:48,630 --> 00:30:51,389
algorithm say that's gonna change in a

855
00:30:49,980 --> 00:30:53,730
few hours and it's gonna change again

856
00:30:51,389 --> 00:30:55,469
and again and again and again you look

857
00:30:53,730 --> 00:30:56,789
at the generate domains and have the

858
00:30:55,470 --> 00:30:58,649
malware switched domains every few hours

859
00:30:56,789 --> 00:31:01,379
maybe once a day often every few hours

860
00:30:58,649 --> 00:31:03,090
so it's zones noise calm and floor hours

861
00:31:01,380 --> 00:31:05,490
later it zones knocks calm with an ex

862
00:31:03,090 --> 00:31:06,959
that if zones nod calm with a D and I

863
00:31:05,490 --> 00:31:08,970
can play this game all day long right

864
00:31:06,960 --> 00:31:09,620
and your black list might get updated

865
00:31:08,970 --> 00:31:11,150
tomorrow

866
00:31:09,620 --> 00:31:12,409
they've already shifted three more

867
00:31:11,150 --> 00:31:14,930
domains since then that's pointless

868
00:31:12,410 --> 00:31:17,000
right well you do want to look for now

869
00:31:14,930 --> 00:31:19,430
so if zones noise comm isn't there isn't

870
00:31:17,000 --> 00:31:20,630
very useful cuz it's not the despite

871
00:31:19,430 --> 00:31:22,210
what your vendor tells you selling you

872
00:31:20,630 --> 00:31:24,790
these black listing solutions it's not

873
00:31:22,210 --> 00:31:27,710
this is really dumb malware it's not

874
00:31:24,790 --> 00:31:29,360
this was the one thousand twelve

875
00:31:27,710 --> 00:31:32,990
thousand one hundred ninety third thing

876
00:31:29,360 --> 00:31:34,639
site it resolved site right and why one

877
00:31:32,990 --> 00:31:36,350
of twelve thousand one hundred ninety

878
00:31:34,640 --> 00:31:38,510
three it started zero so this that this

879
00:31:36,350 --> 00:31:40,550
matter is resolved it's not it's not

880
00:31:38,510 --> 00:31:42,830
resolution it's it's communication it's

881
00:31:40,550 --> 00:31:44,990
bi-directional communication zero dot P

882
00:31:42,830 --> 00:31:48,559
of the zone sauce calm wanda PF dead

883
00:31:44,990 --> 00:31:50,120
zone stars calm two to pia and twelve

884
00:31:48,559 --> 00:31:52,670
thousand one hundred ninety three times

885
00:31:50,120 --> 00:31:53,959
right again you don't resolve twelve

886
00:31:52,670 --> 00:31:56,780
thousand what are ninety three different

887
00:31:53,960 --> 00:31:58,730
things google calm you simply don't i'm

888
00:31:56,780 --> 00:32:00,230
you never do that on the internet that i

889
00:31:58,730 --> 00:32:03,559
can think of it's gonna be extreme

890
00:32:00,230 --> 00:32:05,690
rarity but here common also it's a it's

891
00:32:03,559 --> 00:32:08,600
a tax record which is freeform text that

892
00:32:05,690 --> 00:32:11,030
is basically four encoded but also it

893
00:32:08,600 --> 00:32:12,889
was xor encrypted and the base64 encoded

894
00:32:11,030 --> 00:32:14,240
if you decode that it's encrypted still

895
00:32:12,890 --> 00:32:15,440
yeah well if you decode that it's a

896
00:32:14,240 --> 00:32:18,080
cryptid I should say so it's encoded

897
00:32:15,440 --> 00:32:21,410
encrypted then encoded right that's not

898
00:32:18,080 --> 00:32:23,840
typically Dena's traffic at all DNS is

899
00:32:21,410 --> 00:32:24,290
the ideal c2 Channel c2 is command and

900
00:32:23,840 --> 00:32:27,050
control

901
00:32:24,290 --> 00:32:28,280
I've infected your PC how do I control

902
00:32:27,050 --> 00:32:30,010
that from somewhere on the internet

903
00:32:28,280 --> 00:32:32,420
that's called c2 command control right

904
00:32:30,010 --> 00:32:35,179
DNS is an ideal channel for that

905
00:32:32,420 --> 00:32:37,070
most sites treat DNS as a utility

906
00:32:35,179 --> 00:32:38,950
meaning it's working or it's not it's

907
00:32:37,070 --> 00:32:41,240
like electricity it's on or it's off and

908
00:32:38,950 --> 00:32:42,740
most organizations don't look at the NS

909
00:32:41,240 --> 00:32:44,929
did it they just know that it's working

910
00:32:42,740 --> 00:32:47,050
and they're happy right so it's an easy

911
00:32:44,929 --> 00:32:50,780
way to kind of hide in plain sight

912
00:32:47,050 --> 00:32:52,730
the beauty of DNS we used well now are

913
00:32:50,780 --> 00:32:56,899
used to use and pentesters used to use

914
00:32:52,730 --> 00:32:58,700
ICMP for this ICMP is you know less

915
00:32:56,900 --> 00:33:02,690
filtered than other things but DNS is

916
00:32:58,700 --> 00:33:04,070
usually almost entirely unfiltered it'll

917
00:33:02,690 --> 00:33:06,860
work to forward as a forward as I said

918
00:33:04,070 --> 00:33:08,750
earlier the DNS proxy so if I can if I

919
00:33:06,860 --> 00:33:10,370
can sit down on a lockdown subnet with

920
00:33:08,750 --> 00:33:12,530
no internet access I've been told this

921
00:33:10,370 --> 00:33:14,928
and type nslookup Google calm and get an

922
00:33:12,530 --> 00:33:16,070
answer that's Internet connectivity my

923
00:33:14,929 --> 00:33:17,690
clients say well no that's a lockdown

924
00:33:16,070 --> 00:33:19,460
subnet you can't surf the web I can

925
00:33:17,690 --> 00:33:21,590
resolve names they say well that goes we

926
00:33:19,460 --> 00:33:22,980
afford it right a DNS forwarder which is

927
00:33:21,590 --> 00:33:25,830
a Dina's proxy right

928
00:33:22,980 --> 00:33:28,289
so I've done ssh through this i've ssh

929
00:33:25,830 --> 00:33:30,418
through Google that 8.8.8.8

930
00:33:28,289 --> 00:33:32,789
I was successfully ssh through google

931
00:33:30,419 --> 00:33:35,370
using dns using iodine as we'll see here

932
00:33:32,789 --> 00:33:36,750
right iodine's wonderful that's Dena's

933
00:33:35,370 --> 00:33:40,139
cat - which is great

934
00:33:36,750 --> 00:33:42,840
DNS catch you can do any TCP protocol

935
00:33:40,139 --> 00:33:44,789
iodine can do any IP protocol you could

936
00:33:42,840 --> 00:33:47,010
use IPSec through iodine tunnel right

937
00:33:44,789 --> 00:33:50,120
and I've set this up myself when I do

938
00:33:47,010 --> 00:33:53,279
penetration tests I always do DNS d2 and

939
00:33:50,120 --> 00:33:55,559
I've never been caught the c2 has never

940
00:33:53,279 --> 00:33:57,659
been caught never all right which tells

941
00:33:55,559 --> 00:33:59,700
you something right and what does it

942
00:33:57,659 --> 00:34:03,240
look like speaking of no records Wow

943
00:33:59,700 --> 00:34:06,690
right this is a SSH tunnel going through

944
00:34:03,240 --> 00:34:09,599
DNS via it goes from my local client to

945
00:34:06,690 --> 00:34:14,099
the local resolver DNS proxy Florida to

946
00:34:09,599 --> 00:34:17,369
Google at 888 to my my iodine server and

947
00:34:14,099 --> 00:34:20,220
and digital oceans cloud and EJ Tommy

948
00:34:17,369 --> 00:34:22,800
another Macedonian domain I plot during

949
00:34:20,219 --> 00:34:24,658
their sail so EJ Tommy is what I use

950
00:34:22,800 --> 00:34:26,639
them as my tunnel broker for DNS right

951
00:34:24,659 --> 00:34:28,950
so it goes from local clients a local

952
00:34:26,639 --> 00:34:32,760
resolver recursive resolver to Google at

953
00:34:28,949 --> 00:34:34,109
8.8.8.8 to EJ Tommy and digital oceans

954
00:34:32,760 --> 00:34:36,450
cloud and I'm Association buy directly

955
00:34:34,109 --> 00:34:38,159
through that again Nell records are an

956
00:34:36,449 --> 00:34:39,899
experimental record that are only used

957
00:34:38,159 --> 00:34:41,460
for evil as far as I can tell they carry

958
00:34:39,899 --> 00:34:43,469
binary data I didn't know you could

959
00:34:41,460 --> 00:34:45,889
carry binary data via DNS but you can

960
00:34:43,469 --> 00:34:45,888
right

961
00:34:46,168 --> 00:34:50,668
so how do you detect that I resolved a

962
00:34:48,810 --> 00:34:52,770
hundred thirty-eight things dot 3 de

963
00:34:50,668 --> 00:34:54,509
jade on me that's not right that's not

964
00:34:52,770 --> 00:34:56,879
right so simply count the number of

965
00:34:54,510 --> 00:34:58,859
subdomains or host names being resolved

966
00:34:56,879 --> 00:35:01,109
on a domain and it's tough jumps right

967
00:34:58,859 --> 00:35:01,859
out of you it's easy to detect if you

968
00:35:01,109 --> 00:35:03,630
look at it that way

969
00:35:01,859 --> 00:35:05,520
right and it works really well for

970
00:35:03,630 --> 00:35:09,119
virtually any form of DNS tunneling this

971
00:35:05,520 --> 00:35:10,560
works great another thing to do is to

972
00:35:09,119 --> 00:35:12,359
detect randomness and I'm gonna give

973
00:35:10,560 --> 00:35:14,460
more mark bragging kits to shoutouts in

974
00:35:12,359 --> 00:35:16,348
the end this talk mark Baggett sets and

975
00:35:14,460 --> 00:35:18,720
I set my eyes for myself wrote security

976
00:35:16,349 --> 00:35:20,910
511 and we wanted to detect randomly

977
00:35:18,720 --> 00:35:22,919
generated sex was this string randomly

978
00:35:20,910 --> 00:35:25,020
generated right and it sounded easy but

979
00:35:22,920 --> 00:35:26,520
it's actually hard well for us not for

980
00:35:25,020 --> 00:35:29,640
mark is marks a genius you know he's

981
00:35:26,520 --> 00:35:32,819
smarter than me and I'm like oh we'll

982
00:35:29,640 --> 00:35:35,220
just use ents and you know if you know

983
00:35:32,819 --> 00:35:36,839
one thing about cryptography Claude

984
00:35:35,220 --> 00:35:39,060
Shannon and Tripp

985
00:35:36,839 --> 00:35:40,799
you know how much disorder how random is

986
00:35:39,060 --> 00:35:42,420
this there's a handy tool called and

987
00:35:40,800 --> 00:35:44,339
built into most versions of UNIX and

988
00:35:42,420 --> 00:35:45,660
Linux this calculator how random this

989
00:35:44,339 --> 00:35:47,279
thing is right so I'll just run that

990
00:35:45,660 --> 00:35:48,720
thing who and a high number means it's

991
00:35:47,280 --> 00:35:51,450
random because why randomly generated

992
00:35:48,720 --> 00:35:53,549
malware uses randomly generated names to

993
00:35:51,450 --> 00:35:55,319
maintain two main generation algorithms

994
00:35:53,550 --> 00:35:57,210
randomly generated names randomly

995
00:35:55,320 --> 00:35:59,460
generated exe names randomly generated

996
00:35:57,210 --> 00:36:01,349
service names on x.509 certificate

997
00:35:59,460 --> 00:36:02,970
entries on and on and on and on they

998
00:36:01,349 --> 00:36:04,740
randomly generate these strings to avoid

999
00:36:02,970 --> 00:36:06,598
a blacklist right so instead of

1000
00:36:04,740 --> 00:36:08,669
blacklisting names and catching things

1001
00:36:06,599 --> 00:36:10,200
on a list of known bad let's just find

1002
00:36:08,670 --> 00:36:11,550
things that were randomly generated that

1003
00:36:10,200 --> 00:36:13,470
should be easy we have a tool but it

1004
00:36:11,550 --> 00:36:15,180
turns out it's not easy well for us from

1005
00:36:13,470 --> 00:36:17,160
market was right because it turns out if

1006
00:36:15,180 --> 00:36:19,770
you think of ascii as a character space

1007
00:36:17,160 --> 00:36:22,470
if i use uppercase lowercase ascii plus

1008
00:36:19,770 --> 00:36:25,859
numbers that's 26 plus 26 plus 10 that's

1009
00:36:22,470 --> 00:36:28,348
62 values out of ascii which is 256

1010
00:36:25,859 --> 00:36:30,930
total so we're using like a quarter of

1011
00:36:28,349 --> 00:36:33,420
ascii right that's not gonna be very not

1012
00:36:30,930 --> 00:36:35,310
even maybe one-fifth of ascii any

1013
00:36:33,420 --> 00:36:37,829
cryptic chronologiste to tell you that's

1014
00:36:35,310 --> 00:36:39,720
not high entropy 150 per character space

1015
00:36:37,829 --> 00:36:42,810
is not random enough clearly right and

1016
00:36:39,720 --> 00:36:44,189
so n failed me a self gave up and mark

1017
00:36:42,810 --> 00:36:46,290
smarter than us so it mark said alright

1018
00:36:44,190 --> 00:36:48,270
i'll take on that challenge and he wrote

1019
00:36:46,290 --> 00:36:50,849
freaked up UI and now the free server as

1020
00:36:48,270 --> 00:36:55,650
well it detects randomness and it works

1021
00:36:50,849 --> 00:36:58,560
really well really well and you give it

1022
00:36:55,650 --> 00:37:00,569
a corpus like the Alexa top million

1023
00:36:58,560 --> 00:37:02,578
which is now commercial Alexa has a list

1024
00:37:00,569 --> 00:37:03,990
of the top million websites used to be

1025
00:37:02,579 --> 00:37:06,750
free now it's commercial but Cisco

1026
00:37:03,990 --> 00:37:09,720
umbrella Cisco umbrella they run Open

1027
00:37:06,750 --> 00:37:12,150
DNS top million resolved names all right

1028
00:37:09,720 --> 00:37:14,490
free download the top million resolved

1029
00:37:12,150 --> 00:37:16,440
names and just that as a corpus any cool

1030
00:37:14,490 --> 00:37:18,419
press you want right I'm doing DNS less

1031
00:37:16,440 --> 00:37:21,630
injects ingest the Cisco umbrella top

1032
00:37:18,420 --> 00:37:24,030
million right and then character

1033
00:37:21,630 --> 00:37:26,040
analysis by character pairs and us

1034
00:37:24,030 --> 00:37:28,109
English how often is queue fall by

1035
00:37:26,040 --> 00:37:30,119
something that's not you not comment

1036
00:37:28,109 --> 00:37:31,380
right so to do whatever corporate should

1037
00:37:30,119 --> 00:37:33,690
give it a do character analysis

1038
00:37:31,380 --> 00:37:34,770
character by character pairs how could

1039
00:37:33,690 --> 00:37:36,480
the likelihood of those two pair is

1040
00:37:34,770 --> 00:37:38,550
occurring in order and then giving an

1041
00:37:36,480 --> 00:37:41,490
overall random random to score on that

1042
00:37:38,550 --> 00:37:43,200
great great works really really well and

1043
00:37:41,490 --> 00:37:45,839
what you have in your sock is a

1044
00:37:43,200 --> 00:37:47,970
dashboard of the 10 least likely names

1045
00:37:45,839 --> 00:37:49,980
that just resolved in the past hour or

1046
00:37:47,970 --> 00:37:50,308
whatever right well they all be malware

1047
00:37:49,980 --> 00:37:52,319
enough

1048
00:37:50,309 --> 00:37:53,910
course the 1lb malware but and you know

1049
00:37:52,319 --> 00:37:55,349
there are things like content

1050
00:37:53,910 --> 00:37:56,519
distribution networks would do this

1051
00:37:55,349 --> 00:37:57,869
you'll have to whitelist some stuff but

1052
00:37:56,519 --> 00:37:59,430
it's pretty easy to do I've done it I

1053
00:37:57,869 --> 00:38:01,709
built these dashboards and have a

1054
00:37:59,430 --> 00:38:04,169
rolling dashboards of 10 or 50 least

1055
00:38:01,709 --> 00:38:06,538
likely names that just result right

1056
00:38:04,170 --> 00:38:08,069
chase that stuff down you'll you'll have

1057
00:38:06,539 --> 00:38:09,209
some false positives you will chase some

1058
00:38:08,069 --> 00:38:13,140
ghosts but you'll find some amount of

1059
00:38:09,209 --> 00:38:14,788
malware I do it's a great technique so

1060
00:38:13,140 --> 00:38:16,890
it's trying to detect stuff like this

1061
00:38:14,789 --> 00:38:20,189
this is a domain generation algorithm on

1062
00:38:16,890 --> 00:38:22,288
some ransomware I was analyzing u.s. DoD

1063
00:38:20,189 --> 00:38:24,509
gave me a contract to analyze ransomware

1064
00:38:22,289 --> 00:38:26,249
and see what it does and how you did

1065
00:38:24,509 --> 00:38:28,259
prevent and detect it on a network and

1066
00:38:26,249 --> 00:38:30,149
so I was I spent about a month in my lab

1067
00:38:28,259 --> 00:38:31,709
infecting myself over and over and over

1068
00:38:30,150 --> 00:38:33,119
again it was great I clicked YES on

1069
00:38:31,709 --> 00:38:35,308
everything I enable macros and

1070
00:38:33,119 --> 00:38:37,019
everything you have decrypted Matt mail

1071
00:38:35,309 --> 00:38:40,499
click here to decrypt oh no it's

1072
00:38:37,019 --> 00:38:43,229
important right I channeled the the true

1073
00:38:40,499 --> 00:38:45,509
user experience you know we call that

1074
00:38:43,229 --> 00:38:46,680
layer eight I became layer eight for a

1075
00:38:45,509 --> 00:38:49,680
month it was a blast now I'm doing this

1076
00:38:46,680 --> 00:38:51,299
on a isolated subnet with a virtualized

1077
00:38:49,680 --> 00:38:52,799
system clean clean snapshot I had a

1078
00:38:51,299 --> 00:38:55,829
blast that's a lot of fun doing that by

1079
00:38:52,799 --> 00:38:57,269
the way I recommend it you know and here

1080
00:38:55,829 --> 00:39:00,689
it is here so this is the zones noise

1081
00:38:57,269 --> 00:39:02,669
comm problem these domains changed about

1082
00:39:00,689 --> 00:39:04,828
every four hours many of them don't

1083
00:39:02,670 --> 00:39:06,479
actually solve at all it'll try a list

1084
00:39:04,829 --> 00:39:08,400
of 40 domains of one might resolve and

1085
00:39:06,479 --> 00:39:10,140
then four hours later at different 40

1086
00:39:08,400 --> 00:39:12,359
and one might resolve right try

1087
00:39:10,140 --> 00:39:13,769
blacklisting that good luck so you can't

1088
00:39:12,359 --> 00:39:15,929
blacklist that not effectively but you

1089
00:39:13,769 --> 00:39:19,109
can say how likely is this dot su name

1090
00:39:15,929 --> 00:39:21,150
right not very likely not very likely

1091
00:39:19,109 --> 00:39:24,299
based on the Cisco umbrella top million

1092
00:39:21,150 --> 00:39:27,689
not very likely at all and freaked-out

1093
00:39:24,299 --> 00:39:29,369
py will tell you that right and again

1094
00:39:27,689 --> 00:39:31,049
it's not just domain names its thread

1095
00:39:29,369 --> 00:39:33,299
names process names workstation name

1096
00:39:31,049 --> 00:39:35,160
service names all kinds of stuff will

1097
00:39:33,299 --> 00:39:37,709
randomly generate that name to avoid

1098
00:39:35,160 --> 00:39:40,049
blacklisting so freaked out py is super

1099
00:39:37,709 --> 00:39:42,660
useful take a Windows 10 your windows 10

1100
00:39:40,049 --> 00:39:44,640
install image your corpus is the name of

1101
00:39:42,660 --> 00:39:47,519
every dot exe on that image not your

1102
00:39:44,640 --> 00:39:49,769
corpus feed that the free top py afreeca

1103
00:39:47,519 --> 00:39:51,419
Pyo and now now give it new names you're

1104
00:39:49,769 --> 00:39:54,299
countering not right not in your station

1105
00:39:51,420 --> 00:39:56,309
image so there's a new executable that

1106
00:39:54,299 --> 00:39:58,829
you did install the user as something

1107
00:39:56,309 --> 00:40:00,809
did how likely is that name to exist per

1108
00:39:58,829 --> 00:40:03,539
the corpus which is your Windows 10 gold

1109
00:40:00,809 --> 00:40:04,200
image master image right it's very very

1110
00:40:03,539 --> 00:40:05,730
effective

1111
00:40:04,200 --> 00:40:07,290
again you will chase some ghosts that's

1112
00:40:05,730 --> 00:40:08,970
the nature of these things but as a

1113
00:40:07,290 --> 00:40:12,329
threat hunting technique in its solid

1114
00:40:08,970 --> 00:40:14,879
gold and the question is does it scale

1115
00:40:12,329 --> 00:40:17,609
yes so Justin Henderson I think he does

1116
00:40:14,880 --> 00:40:19,290
a half a million a second it's hundreds

1117
00:40:17,609 --> 00:40:22,020
of thousands per second and I think it's

1118
00:40:19,290 --> 00:40:24,150
a half a million per second he manages a

1119
00:40:22,020 --> 00:40:27,180
large five six hundred site insurance

1120
00:40:24,150 --> 00:40:29,490
Network and he feeds every name resolved

1121
00:40:27,180 --> 00:40:31,319
everyone everywhere through freak dot or

1122
00:40:29,490 --> 00:40:33,629
the free server so we tried free coffee

1123
00:40:31,320 --> 00:40:36,270
Y and the Perl script the Python script

1124
00:40:33,630 --> 00:40:37,859
exploded as they tend to so he went to

1125
00:40:36,270 --> 00:40:40,230
the server at scale so the questions of

1126
00:40:37,859 --> 00:40:44,029
the scale it scales another thing to do

1127
00:40:40,230 --> 00:40:47,310
is DNS twist these these cousin domains

1128
00:40:44,030 --> 00:40:49,440
notice paypal calm versus paypal calm

1129
00:40:47,310 --> 00:40:51,270
yes two different names the first one

1130
00:40:49,440 --> 00:40:54,480
has Cyrillic characters in it the second

1131
00:40:51,270 --> 00:40:56,910
one doesn't write SEC 5 3 over SEC five

1132
00:40:54,480 --> 00:40:58,770
three zero so you know I'm back

1133
00:40:56,910 --> 00:41:01,379
shawnette and some I read is back Shore

1134
00:40:58,770 --> 00:41:04,170
dot you know or back showed up biz or

1135
00:41:01,380 --> 00:41:05,609
something and claims to be me right or

1136
00:41:04,170 --> 00:41:07,079
use the Cyrillic a for the back Shore

1137
00:41:05,609 --> 00:41:08,730
how would I catch that and they start

1138
00:41:07,079 --> 00:41:11,280
sending phishing emails to my executives

1139
00:41:08,730 --> 00:41:16,470
I don't have executives I am you know to

1140
00:41:11,280 --> 00:41:17,970
me and my wife I guess right you know it

1141
00:41:16,470 --> 00:41:20,549
would you realize if you were sec five

1142
00:41:17,970 --> 00:41:23,189
Ryo and you guys SEC five three zero so

1143
00:41:20,550 --> 00:41:25,230
DNS twist can actually calculate these

1144
00:41:23,190 --> 00:41:28,140
hama glyphs which your international

1145
00:41:25,230 --> 00:41:31,800
character sets and also look-alike

1146
00:41:28,140 --> 00:41:34,109
cousin domains right and another thing

1147
00:41:31,800 --> 00:41:35,700
domain stats so getting close to

1148
00:41:34,109 --> 00:41:37,170
wrapping up here one of the key

1149
00:41:35,700 --> 00:41:41,430
techniques you won't look at mark

1150
00:41:37,170 --> 00:41:43,319
Baggett once again amazing guy how new

1151
00:41:41,430 --> 00:41:46,109
is this domain right if someone does

1152
00:41:43,319 --> 00:41:47,940
register back showed up is yesterday all

1153
00:41:46,109 --> 00:41:49,920
right it starts fishing my executives

1154
00:41:47,940 --> 00:41:52,290
and I missed that because it's easy to

1155
00:41:49,920 --> 00:41:54,210
miss right but the remains sixteen hours

1156
00:41:52,290 --> 00:41:56,040
old how often do your executives go to

1157
00:41:54,210 --> 00:41:58,020
domain sixteen hours old not often now

1158
00:41:56,040 --> 00:41:59,609
our old domain safe and new domains

1159
00:41:58,020 --> 00:42:01,170
always evil no of course not but all

1160
00:41:59,609 --> 00:42:03,420
things being equal as an indicator of

1161
00:42:01,170 --> 00:42:05,940
compromise the newer the more suspicious

1162
00:42:03,420 --> 00:42:10,140
and if you've looked at who is who is is

1163
00:42:05,940 --> 00:42:12,690
a disaster to analyze it is a trash fire

1164
00:42:10,140 --> 00:42:15,299
it a dumpster fire for an asset as far

1165
00:42:12,690 --> 00:42:17,579
as taking this horribly non formatted

1166
00:42:15,300 --> 00:42:18,150
blobs of text and trying to get data out

1167
00:42:17,579 --> 00:42:22,529
of that

1168
00:42:18,150 --> 00:42:24,029
and it's it's bad and it's also the GDP

1169
00:42:22,529 --> 00:42:27,569
our Europe has removed a lot of that the

1170
00:42:24,029 --> 00:42:30,720
data from it and so who is just terrible

1171
00:42:27,569 --> 00:42:32,099
for getting data from RDP is great gives

1172
00:42:30,720 --> 00:42:35,730
you a number of things including how old

1173
00:42:32,099 --> 00:42:39,359
is this domain so it's a nice using you

1174
00:42:35,730 --> 00:42:40,619
know JSON plays nicely and the it gives

1175
00:42:39,359 --> 00:42:41,940
you a lot of things but the main thing

1176
00:42:40,619 --> 00:42:43,980
you want to know is how old is this

1177
00:42:41,940 --> 00:42:46,799
domain and sans was finished in 2003

1178
00:42:43,980 --> 00:42:48,930
which all things being equal is safer

1179
00:42:46,799 --> 00:42:50,880
than yesterday right it's not a hundred

1180
00:42:48,930 --> 00:42:53,009
percent guarantee but certainly safer

1181
00:42:50,880 --> 00:42:56,940
then yesterday and here's the main stats

1182
00:42:53,010 --> 00:42:58,559
in action it's saying it's Santa's org

1183
00:42:56,940 --> 00:43:01,529
is sixty four thousand nine hundred on

1184
00:42:58,559 --> 00:43:02,910
the Alexa top million it's in the US and

1185
00:43:01,529 --> 00:43:07,799
it was registered in this case I guess I

1186
00:43:02,910 --> 00:43:10,020
misspoke 1995 alright that is my talk

1187
00:43:07,799 --> 00:43:12,720
now I know I went fast so you go to Eric

1188
00:43:10,020 --> 00:43:14,880
Conrad comm and download that talk and I

1189
00:43:12,720 --> 00:43:17,180
will now pause for any questions and

1190
00:43:14,880 --> 00:43:17,180
thank you

1191
00:43:18,690 --> 00:43:20,750
you

1192
00:43:20,940 --> 00:43:26,619
thanks Eric that was amazing there was a

1193
00:43:23,380 --> 00:43:32,770
lot of really good info it's gonna take

1194
00:43:26,619 --> 00:43:38,740
a bit to let it all sink in but I saw

1195
00:43:32,770 --> 00:43:42,700
you've talked so it was good we have one

1196
00:43:38,740 --> 00:43:45,129
question up in the queue right now how

1197
00:43:42,700 --> 00:43:47,230
to deal with and grow type of DNS

1198
00:43:45,130 --> 00:43:49,569
realist resolution and threat hunting

1199
00:43:47,230 --> 00:43:51,910
that can be connected to multiple ideas

1200
00:43:49,569 --> 00:43:55,300
for a very short period of time in the

1201
00:43:51,910 --> 00:43:58,810
attack click on c2 connection what was

1202
00:43:55,300 --> 00:43:59,890
the first end what and Greg had a deal

1203
00:43:58,810 --> 00:44:02,170
and growth

1204
00:43:59,890 --> 00:44:04,020
type of DNS resolution I'm not familiar

1205
00:44:02,170 --> 00:44:06,040
with the term end gerak so if you could

1206
00:44:04,020 --> 00:44:08,440
but it would be the rest and I'll

1207
00:44:06,040 --> 00:44:10,029
address - did the tool I'll try to

1208
00:44:08,440 --> 00:44:15,490
address the question so if you mind

1209
00:44:10,030 --> 00:44:18,490
reading it again yeah no I was just

1210
00:44:15,490 --> 00:44:20,529
checking M growth is for secure inter

1211
00:44:18,490 --> 00:44:23,979
spectable tunnels to localhost

1212
00:44:20,530 --> 00:44:26,920
I'll put it they is what Google tells me

1213
00:44:23,980 --> 00:44:28,390
on a quick searched well that's all my

1214
00:44:26,920 --> 00:44:29,890
to-do list to find out about later and

1215
00:44:28,390 --> 00:44:30,970
so we just read the rest a question I'll

1216
00:44:29,890 --> 00:44:33,730
try to address it without knowing the

1217
00:44:30,970 --> 00:44:36,609
tool how to deal with M growth type of

1218
00:44:33,730 --> 00:44:38,800
DNS resolution in threat hunting they

1219
00:44:36,609 --> 00:44:43,060
can be connected to multiple IPS for a

1220
00:44:38,800 --> 00:44:45,730
very short period of time so multiple

1221
00:44:43,060 --> 00:44:47,680
different IPS show a period of time if

1222
00:44:45,730 --> 00:44:48,960
it's only it has to be tough great

1223
00:44:47,680 --> 00:44:51,669
question

1224
00:44:48,960 --> 00:44:53,710
obviously you want to if you can inspect

1225
00:44:51,670 --> 00:44:56,410
the contents inspect the contents but if

1226
00:44:53,710 --> 00:44:58,420
the affected system uses a DNS resolver

1227
00:44:56,410 --> 00:45:00,368
once twice three times and then shifts

1228
00:44:58,420 --> 00:45:03,400
to another shift to another that would

1229
00:45:00,369 --> 00:45:05,020
be difficult well yeah that could be

1230
00:45:03,400 --> 00:45:06,790
very difficult to detect in that case

1231
00:45:05,020 --> 00:45:09,819
I'd fall back to analyzing the content

1232
00:45:06,790 --> 00:45:13,990
and I'll check out an gerak today thank

1233
00:45:09,819 --> 00:45:15,819
you question um next question what would

1234
00:45:13,990 --> 00:45:20,700
you say about vendors trying to sell a

1235
00:45:15,819 --> 00:45:24,310
magic bullet for do h yeah I'm always

1236
00:45:20,700 --> 00:45:26,379
I'm always suspicious of the shiny box

1237
00:45:24,310 --> 00:45:28,540
syndrome you know the magically there is

1238
00:45:26,380 --> 00:45:30,880
no battery flow we know that there's no

1239
00:45:28,540 --> 00:45:32,259
easy button in any of this stuff the

1240
00:45:30,880 --> 00:45:33,850
open source tools to do this are

1241
00:45:32,260 --> 00:45:35,770
fantastic and the vendors

1242
00:45:33,850 --> 00:45:37,690
often just reselling stuff you could

1243
00:45:35,770 --> 00:45:39,190
build yourself you know depends on your

1244
00:45:37,690 --> 00:45:43,630
policy on open-source software and your

1245
00:45:39,190 --> 00:45:45,040
time you know but I the the term magic

1246
00:45:43,630 --> 00:45:47,590
bullet you know we all know there isn't

1247
00:45:45,040 --> 00:45:49,630
one right and companies continually try

1248
00:45:47,590 --> 00:45:51,070
to buy that next shiny box weather you

1249
00:45:49,630 --> 00:45:53,170
know for a long time it was malware

1250
00:45:51,070 --> 00:45:54,640
detonation like fire I and now they're

1251
00:45:53,170 --> 00:45:56,230
trying to hype like machine learning

1252
00:45:54,640 --> 00:45:57,970
artificial intelligence that's the next

1253
00:45:56,230 --> 00:45:58,960
thing that you know I have clients like

1254
00:45:57,970 --> 00:46:00,069
a machine learning artificial

1255
00:45:58,960 --> 00:46:01,900
intelligence and they're not even

1256
00:46:00,070 --> 00:46:05,110
patching properly up a couple we patch

1257
00:46:01,900 --> 00:46:08,890
first we cover the the basic fundamental

1258
00:46:05,110 --> 00:46:10,480
stuff so and for me the vendors are

1259
00:46:08,890 --> 00:46:12,690
often because it's changing so fast like

1260
00:46:10,480 --> 00:46:15,190
chrome flip the switch Tuesday you know

1261
00:46:12,690 --> 00:46:17,140
to me the vendors have not been as

1262
00:46:15,190 --> 00:46:19,480
nimble as I can be using open source

1263
00:46:17,140 --> 00:46:20,799
tools but the end of the day if it

1264
00:46:19,480 --> 00:46:22,450
provides the kind of solution I'm

1265
00:46:20,800 --> 00:46:23,440
talking about and it can do that all the

1266
00:46:22,450 --> 00:46:25,509
things I've talked about which open

1267
00:46:23,440 --> 00:46:27,010
source can by the way if your commercial

1268
00:46:25,510 --> 00:46:28,300
solution could do all of it I don't know

1269
00:46:27,010 --> 00:46:31,300
if any of that can by the way but if

1270
00:46:28,300 --> 00:46:32,680
yours can do all or most sure you like

1271
00:46:31,300 --> 00:46:34,180
that vendor they make good software I

1272
00:46:32,680 --> 00:46:35,890
have no problem with that I prefer to go

1273
00:46:34,180 --> 00:46:42,700
open source but that's perfectly valid

1274
00:46:35,890 --> 00:46:44,170
too there was um not another question

1275
00:46:42,700 --> 00:46:46,089
but a comment regarding the first

1276
00:46:44,170 --> 00:46:47,710
question and they and they said they

1277
00:46:46,090 --> 00:46:51,130
think that technique might be known as

1278
00:46:47,710 --> 00:46:52,840
fast flux DNS oh fast flux yes yes I

1279
00:46:51,130 --> 00:46:54,790
that I'm familiar with that thank you

1280
00:46:52,840 --> 00:46:59,620
for that thank you for that yeah yeah so

1281
00:46:54,790 --> 00:47:02,020
fast flux well thank you that helps one

1282
00:46:59,620 --> 00:47:03,490
way to detect that if your clients

1283
00:47:02,020 --> 00:47:06,910
supposed to be resolving via local

1284
00:47:03,490 --> 00:47:08,379
resolver you know and it's not like you

1285
00:47:06,910 --> 00:47:09,910
know some resolutions going with your

1286
00:47:08,380 --> 00:47:11,710
local DNS server and somes going

1287
00:47:09,910 --> 00:47:13,029
straight out the internet so clients

1288
00:47:11,710 --> 00:47:15,130
that are resolving in ways that you

1289
00:47:13,030 --> 00:47:17,020
didn't configure them to resolve you can

1290
00:47:15,130 --> 00:47:18,820
catch that and if the client is rapidly

1291
00:47:17,020 --> 00:47:20,710
changing DNS servers that itself can be

1292
00:47:18,820 --> 00:47:22,120
an indication but how fast flux is

1293
00:47:20,710 --> 00:47:24,370
helpful in your getting irrespective of

1294
00:47:22,120 --> 00:47:25,480
all that inspect the content once you

1295
00:47:24,370 --> 00:47:27,609
see the contents like if you see

1296
00:47:25,480 --> 00:47:29,470
base64-encoded text and a text record

1297
00:47:27,610 --> 00:47:31,360
and when you decode it it's still

1298
00:47:29,470 --> 00:47:34,379
encrypted that's probably a malware and

1299
00:47:31,360 --> 00:47:36,850
that's what most of these things do

1300
00:47:34,380 --> 00:47:39,750
awesome all right well thank you very

1301
00:47:36,850 --> 00:47:39,750
much for that Eric

