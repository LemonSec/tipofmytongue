1
00:00:00,920 --> 00:00:04,230
hi good afternoon so like I said so my

2
00:00:04,230 --> 00:00:06,180
name is keV and I'm really talking about

3
00:00:06,180 --> 00:00:08,730
some some stuff with pay spin and where

4
00:00:08,730 --> 00:00:10,860
I've taken it from there

5
00:00:10,860 --> 00:00:14,820
so that's me so I'm director content at

6
00:00:14,820 --> 00:00:17,010
a company called Emotiv labs I'm a

7
00:00:17,010 --> 00:00:19,560
part-time blogger a researcher I've been

8
00:00:19,560 --> 00:00:22,260
in security and IT for about 20 years

9
00:00:22,260 --> 00:00:25,439
and I love writing open source tools and

10
00:00:25,439 --> 00:00:27,320
contributing back into the community

11
00:00:27,320 --> 00:00:30,510
wherever I can and there's just a couple

12
00:00:30,510 --> 00:00:32,369
of tools of them that I've done as well

13
00:00:32,369 --> 00:00:33,840
as paste until which is what I will be

14
00:00:33,840 --> 00:00:37,260
talking about today does anybody not

15
00:00:37,260 --> 00:00:41,820
know what paste bin is good start so peg

16
00:00:41,820 --> 00:00:43,200
spins a website where you can store any

17
00:00:43,200 --> 00:00:45,960
text online freezy sharing mainly used

18
00:00:45,960 --> 00:00:47,489
by programmers to store piece of source

19
00:00:47,489 --> 00:00:49,649
code or configuration information that's

20
00:00:49,649 --> 00:00:51,750
the description the paste bin gives its

21
00:00:51,750 --> 00:00:53,670
own website anybody see the problem

22
00:00:53,670 --> 00:00:56,219
there this is what I like to call

23
00:00:56,219 --> 00:00:58,199
paceman it's website where you can

24
00:00:58,199 --> 00:00:59,730
search online for source code or

25
00:00:59,730 --> 00:01:01,440
configuration provided by company

26
00:01:01,440 --> 00:01:04,080
developers which is actually where you

27
00:01:04,080 --> 00:01:07,369
can end up doing it's fairly active

28
00:01:07,369 --> 00:01:10,950
that's a standard day several thousand

29
00:01:10,950 --> 00:01:14,670
pastes going up online that's a week and

30
00:01:14,670 --> 00:01:16,290
you can start to see this active during

31
00:01:16,290 --> 00:01:19,590
like normal weekly cycles in any given

32
00:01:19,590 --> 00:01:23,000
week there's about 25,000 documents

33
00:01:23,000 --> 00:01:26,909
uploaded into paceman and that's just

34
00:01:26,909 --> 00:01:29,040
pay spins at pastebin.com that's not any

35
00:01:29,040 --> 00:01:32,220
of the Clones that's not including any

36
00:01:32,220 --> 00:01:34,229
of their like their other language sites

37
00:01:34,229 --> 00:01:37,009
that's just pastebin.com every week

38
00:01:37,009 --> 00:01:41,159
25,000 documents uploaded and there's

39
00:01:41,159 --> 00:01:43,110
some interesting stuff there's some

40
00:01:43,110 --> 00:01:45,180
creepy stuff this is like genuinely

41
00:01:45,180 --> 00:01:46,979
terrifying stuff that goes into paste

42
00:01:46,979 --> 00:01:49,290
bin and we'll take a look at some of

43
00:01:49,290 --> 00:01:54,630
those a little bit and that's where I

44
00:01:54,630 --> 00:01:58,049
create a paste Center so I was working

45
00:01:58,049 --> 00:01:59,869
at a syrup and we got a notification

46
00:01:59,869 --> 00:02:03,299
that we've had some of our users data

47
00:02:03,299 --> 00:02:05,549
their user name to their passwords up

48
00:02:05,549 --> 00:02:08,610
here on paceman so when we did the

49
00:02:08,610 --> 00:02:12,360
investigation we found out that it

50
00:02:12,360 --> 00:02:13,500
wasn't actually anything the vazha to

51
00:02:13,500 --> 00:02:13,740
being

52
00:02:13,740 --> 00:02:16,140
compromised but other sites have been

53
00:02:16,140 --> 00:02:18,090
compromised all that data been

54
00:02:18,090 --> 00:02:20,220
aggregated and we're just being like

55
00:02:20,220 --> 00:02:22,500
randomly shared on paceman obviously

56
00:02:22,500 --> 00:02:25,110
credential reduces it is a real thing so

57
00:02:25,110 --> 00:02:28,280
data leaks are real password dumps

58
00:02:28,280 --> 00:02:31,440
credential reuse but it's not just there

59
00:02:31,440 --> 00:02:33,900
it's like developers what will publish

60
00:02:33,900 --> 00:02:37,650
stuff too so places like paceman that's

61
00:02:37,650 --> 00:02:39,030
really dangerous when you have things

62
00:02:39,030 --> 00:02:41,370
like static keys when you have like

63
00:02:41,370 --> 00:02:44,220
hard-coded secrets that are put into

64
00:02:44,220 --> 00:02:46,290
configuration files like Django config

65
00:02:46,290 --> 00:02:50,790
files or vagrant files developers for

66
00:02:50,790 --> 00:02:52,560
some reason love to think the paceman is

67
00:02:52,560 --> 00:02:54,300
the easiest way of sharing this with

68
00:02:54,300 --> 00:02:57,090
other developers or if they've got flaws

69
00:02:57,090 --> 00:02:58,590
or if they're testing something they'll

70
00:02:58,590 --> 00:03:00,150
just throw it on here share the show

71
00:03:00,150 --> 00:03:02,520
link and think that nobody else is ever

72
00:03:02,520 --> 00:03:07,440
going to look at it so why new tools so

73
00:03:07,440 --> 00:03:11,820
there's loads of them out there so if

74
00:03:11,820 --> 00:03:14,070
you look on like github you'll find at

75
00:03:14,070 --> 00:03:17,100
least 20 or 30 like scripts or BOTS or

76
00:03:17,100 --> 00:03:19,110
something that is doing something very

77
00:03:19,110 --> 00:03:20,880
similar so it's going out to pay spin

78
00:03:20,880 --> 00:03:24,000
it's scraping the data off there the

79
00:03:24,000 --> 00:03:25,230
reason I wanted to build them to like

80
00:03:25,230 --> 00:03:27,150
pay center is they weren't very friendly

81
00:03:27,150 --> 00:03:29,100
they didn't have all the features I

82
00:03:29,100 --> 00:03:31,710
wanted or that I needed in order to like

83
00:03:31,710 --> 00:03:34,560
respond to something a monitor and

84
00:03:34,560 --> 00:03:38,180
pretty much all of them use reg exes

85
00:03:38,180 --> 00:03:42,590
does anybody know what that reg X is for

86
00:03:42,770 --> 00:03:47,220
that reg X is just for an email reg X is

87
00:03:47,220 --> 00:03:49,590
a really really complex things I don't

88
00:03:49,590 --> 00:03:50,850
know if that makes it any easier to

89
00:03:50,850 --> 00:03:53,100
understand what's happening but they're

90
00:03:53,100 --> 00:03:55,890
quite complex and like I said most of

91
00:03:55,890 --> 00:03:58,320
what you'll find out there with pace

92
00:03:58,320 --> 00:04:00,210
been scraping things they're just big

93
00:04:00,210 --> 00:04:03,030
bunches of reg X now that's fine if

94
00:04:03,030 --> 00:04:04,440
you're just like a research we just

95
00:04:04,440 --> 00:04:05,610
wanted to use the rules they've created

96
00:04:05,610 --> 00:04:07,020
but if you're wanting to create anything

97
00:04:07,020 --> 00:04:09,600
of your own this can be quite a

98
00:04:09,600 --> 00:04:12,600
nightmare trying to go through their reg

99
00:04:12,600 --> 00:04:16,108
X's and if they break or if they're if

100
00:04:16,108 --> 00:04:17,608
they're too loose if you want to try and

101
00:04:17,608 --> 00:04:19,680
tighten them to reduce the false

102
00:04:19,680 --> 00:04:22,140
positives fighting with reg X is

103
00:04:22,140 --> 00:04:24,169
incredibly difficult

104
00:04:24,169 --> 00:04:26,630
now over the

105
00:04:26,630 --> 00:04:28,400
last ten or twelve years I've been

106
00:04:28,400 --> 00:04:30,380
working a lot with malware

107
00:04:30,380 --> 00:04:34,100
he's anybody familiar with Yara yo is

108
00:04:34,100 --> 00:04:37,100
pretty good now Yara was originally it

109
00:04:37,100 --> 00:04:38,690
so it's pattern matching for researchers

110
00:04:38,690 --> 00:04:41,840
it's written by the guys at github that

111
00:04:41,840 --> 00:04:44,330
sorta not to get a virus total which is

112
00:04:44,330 --> 00:04:46,730
obviously Google owned and it was

113
00:04:46,730 --> 00:04:48,320
originally designed for like classifying

114
00:04:48,320 --> 00:04:51,050
malware so it's complex strings so you

115
00:04:51,050 --> 00:04:52,400
can look for Strings you can look for a

116
00:04:52,400 --> 00:04:54,860
regex is you can do some really fun

117
00:04:54,860 --> 00:04:57,140
things and try and categorize stuff

118
00:04:57,140 --> 00:05:00,170
together and every time we look at

119
00:05:00,170 --> 00:05:02,150
malware we right you're all for it

120
00:05:02,150 --> 00:05:04,130
and I'd spent a lot of time work with

121
00:05:04,130 --> 00:05:06,530
yarn I thought this is much easier than

122
00:05:06,530 --> 00:05:10,030
writing regex and if you can read files

123
00:05:10,030 --> 00:05:13,550
what kind of just wheaton text so I

124
00:05:13,550 --> 00:05:17,090
started playing so pay spend you pay

125
00:05:17,090 --> 00:05:18,740
fifty dollars so you get lifetime access

126
00:05:18,740 --> 00:05:21,920
to their scraping API and every second

127
00:05:21,920 --> 00:05:23,840
you can pull back the latest three or

128
00:05:23,840 --> 00:05:25,160
four hundred pastes

129
00:05:25,160 --> 00:05:28,040
so near enough real time you can scrape

130
00:05:28,040 --> 00:05:32,080
paste bin from a any IP just pay the $50

131
00:05:32,080 --> 00:05:34,430
so I started pulling in that feed

132
00:05:34,430 --> 00:05:36,980
started writing some simple rules just

133
00:05:36,980 --> 00:05:39,710
looking for string matches and I was

134
00:05:39,710 --> 00:05:41,150
found I was getting like really high

135
00:05:41,150 --> 00:05:43,130
fidelity hits and I was able to really

136
00:05:43,130 --> 00:05:44,990
easily tune out those false positives

137
00:05:44,990 --> 00:05:47,270
and I was were able to really easy write

138
00:05:47,270 --> 00:05:50,690
some custom rules so I started putting

139
00:05:50,690 --> 00:05:53,360
these into into just a really simple

140
00:05:53,360 --> 00:05:56,390
Python scripts that was just running and

141
00:05:56,390 --> 00:05:58,730
I was getting notifications when stuff

142
00:05:58,730 --> 00:06:01,580
was going but I wanted more than that I

143
00:06:01,580 --> 00:06:03,260
wanted to be able to like look over

144
00:06:03,260 --> 00:06:04,850
historic data I wanted to be able to

145
00:06:04,850 --> 00:06:08,660
collect I want to be able to archive and

146
00:06:08,660 --> 00:06:10,760
that's where I started writing some more

147
00:06:10,760 --> 00:06:14,060
custom rules so for the organization I

148
00:06:14,060 --> 00:06:16,460
was working on we had the standard rules

149
00:06:16,460 --> 00:06:17,870
were looking for like fun things as a

150
00:06:17,870 --> 00:06:20,090
researcher but I was also able to write

151
00:06:20,090 --> 00:06:22,460
rules from my domains for my IP

152
00:06:22,460 --> 00:06:23,720
addresses from my corporate

153
00:06:23,720 --> 00:06:25,820
infrastructure and because I'm running

154
00:06:25,820 --> 00:06:27,740
pace Center like completely locally on a

155
00:06:27,740 --> 00:06:30,080
box like control like inside my network

156
00:06:30,080 --> 00:06:32,870
I was fairly comfortable putting like

157
00:06:32,870 --> 00:06:35,270
partially the brass keys so my developer

158
00:06:35,270 --> 00:06:37,520
keys not off to put in the fork in there

159
00:06:37,520 --> 00:06:38,780
but putting enough that I could get a

160
00:06:38,780 --> 00:06:39,700
good

161
00:06:39,700 --> 00:06:42,370
much put those rules in then any time a

162
00:06:42,370 --> 00:06:45,070
developer accidentally post something of

163
00:06:45,070 --> 00:06:46,810
to pastebin or shared something or any

164
00:06:46,810 --> 00:06:49,120
piece of code then within about five

165
00:06:49,120 --> 00:06:51,010
minutes I'd get a notification that this

166
00:06:51,010 --> 00:06:52,390
thing had just been done and then we

167
00:06:52,390 --> 00:06:57,460
could immediately go and pull it on we

168
00:06:57,460 --> 00:07:00,400
started I started with a simple Python

169
00:07:00,400 --> 00:07:03,460
script it was 30 or 40 lines not the

170
00:07:03,460 --> 00:07:04,930
best pie that I've ever written bluest

171
00:07:04,930 --> 00:07:08,650
function on it worked and I started

172
00:07:08,650 --> 00:07:10,270
walking about some of the things that

173
00:07:10,270 --> 00:07:11,710
I've been finding and it starts to get a

174
00:07:11,710 --> 00:07:14,290
little bit of interest so I thought how

175
00:07:14,290 --> 00:07:16,390
can I make this more usable for other

176
00:07:16,390 --> 00:07:18,340
people like I like to give back to the

177
00:07:18,340 --> 00:07:19,990
community they've given a lot to me so

178
00:07:19,990 --> 00:07:21,760
it's like how can I make this easy for

179
00:07:21,760 --> 00:07:24,330
people so I started to make it modular

180
00:07:24,330 --> 00:07:26,550
and one of the first things I did was

181
00:07:26,550 --> 00:07:28,510
where else that people put things

182
00:07:28,510 --> 00:07:30,610
obviously pastebin we know people share

183
00:07:30,610 --> 00:07:32,110
things on there but where else do people

184
00:07:32,110 --> 00:07:34,300
put stuff so we've got places like

185
00:07:34,300 --> 00:07:38,250
github and gifts gifts people share

186
00:07:38,250 --> 00:07:40,420
you're supposed to be able to unwind

187
00:07:40,420 --> 00:07:42,250
them if they have the URL but github

188
00:07:42,250 --> 00:07:45,130
give you a nice API yet hope also give

189
00:07:45,130 --> 00:07:46,720
you an API for what they call their

190
00:07:46,720 --> 00:07:49,390
events API so every time somebody makes

191
00:07:49,390 --> 00:07:53,080
a commits or a push or pushes any code

192
00:07:53,080 --> 00:07:55,180
you can actually pull those commits and

193
00:07:55,180 --> 00:07:58,200
because most things in github a public

194
00:07:58,200 --> 00:08:00,970
you can search the file names so one of

195
00:08:00,970 --> 00:08:02,500
the other modules we wrote for the

196
00:08:02,500 --> 00:08:05,050
paceman so was we look at that feed of

197
00:08:05,050 --> 00:08:07,210
every push every commit that's going

198
00:08:07,210 --> 00:08:09,520
into github in real time we look for

199
00:08:09,520 --> 00:08:11,350
things like settings like yum or setting

200
00:08:11,350 --> 00:08:14,680
stop whatever so we're looking for those

201
00:08:14,680 --> 00:08:16,210
config files we're looking for vagrant

202
00:08:16,210 --> 00:08:18,160
files were looking for configuration

203
00:08:18,160 --> 00:08:20,290
files and if we match any of those names

204
00:08:20,290 --> 00:08:22,450
then we'll run those same set of rules

205
00:08:22,450 --> 00:08:25,090
against those things looking for sequel

206
00:08:25,090 --> 00:08:27,190
files and then push our sequel rules

207
00:08:27,190 --> 00:08:30,970
against it Stack Overflow is another

208
00:08:30,970 --> 00:08:33,130
place there where people inadvertently

209
00:08:33,130 --> 00:08:35,260
share like full copies of source code

210
00:08:35,260 --> 00:08:37,179
and it's not just source code it's not

211
00:08:37,179 --> 00:08:39,190
just attackers leaking data it's not

212
00:08:39,190 --> 00:08:41,320
just developers like leaking bits of

213
00:08:41,320 --> 00:08:43,840
source code a lot of people put error

214
00:08:43,840 --> 00:08:46,540
logs up and people think that error logs

215
00:08:46,540 --> 00:08:50,110
are fine error logs can actually contain

216
00:08:50,110 --> 00:08:53,220
quite a bit of data

217
00:08:53,459 --> 00:08:56,050
that I talk about profiles I've never

218
00:08:56,050 --> 00:08:58,740
actually abused any of the stuff I found

219
00:08:58,740 --> 00:09:01,440
but there's a guy from Warner Brothers

220
00:09:01,440 --> 00:09:03,879
who was testing their back-end media

221
00:09:03,879 --> 00:09:06,490
server and he couldn't get it to access

222
00:09:06,490 --> 00:09:09,399
properly so what he did is he that the

223
00:09:09,399 --> 00:09:12,310
purpose of a post curl including all of

224
00:09:12,310 --> 00:09:14,379
his API keys his access keys the

225
00:09:14,379 --> 00:09:17,259
transactions that domains like his email

226
00:09:17,259 --> 00:09:19,079
just like everything in a verbose curl

227
00:09:19,079 --> 00:09:21,610
pasted that into paceman and sent off to

228
00:09:21,610 --> 00:09:23,050
another developer I'm assuming that's

229
00:09:23,050 --> 00:09:26,399
what he did that triggered a rule

230
00:09:26,399 --> 00:09:29,350
looking for API keys and looking for

231
00:09:29,350 --> 00:09:32,920
access keys so had I gone and taken any

232
00:09:32,920 --> 00:09:34,300
of that information now he had his

233
00:09:34,300 --> 00:09:36,009
entire session I had the entire session

234
00:09:36,009 --> 00:09:37,720
to get into Warner Brothers back-end

235
00:09:37,720 --> 00:09:40,180
media server it's a lot of damage I

236
00:09:40,180 --> 00:09:41,350
could have done with us a lot of money I

237
00:09:41,350 --> 00:09:42,759
could have made on the piracy market

238
00:09:42,759 --> 00:09:46,629
with that fortunately I'm a good

239
00:09:46,629 --> 00:09:50,230
researcher so I I notified Warner

240
00:09:50,230 --> 00:09:52,509
Brothers told them about it and also

241
00:09:52,509 --> 00:09:54,610
reported to pastebin directly and I'll

242
00:09:54,610 --> 00:09:56,860
I'll talk about that a little bit later

243
00:09:56,860 --> 00:10:01,300
on as well and then things like RSS

244
00:10:01,300 --> 00:10:07,569
feeds was one of the last things looking

245
00:10:07,569 --> 00:10:09,970
at these sites is one thing but data

246
00:10:09,970 --> 00:10:11,439
appears in more places than that

247
00:10:11,439 --> 00:10:13,959
so there's hack forms Don that there's

248
00:10:13,959 --> 00:10:15,970
places like that that's just the dirty

249
00:10:15,970 --> 00:10:18,310
parts of the internet where people just

250
00:10:18,310 --> 00:10:21,339
put stuff up anyway you can take an RSS

251
00:10:21,339 --> 00:10:24,250
feed a spoon will work give it the RSS

252
00:10:24,250 --> 00:10:26,439
feed it will go affect all those pages

253
00:10:26,439 --> 00:10:28,959
in a run the processing engine against

254
00:10:28,959 --> 00:10:30,430
every page you'll find selects it it's

255
00:10:30,430 --> 00:10:34,540
very flexible and what it can do and

256
00:10:34,540 --> 00:10:37,750
then storage an output so like I said I

257
00:10:37,750 --> 00:10:40,089
wanted more than just to get like a

258
00:10:40,089 --> 00:10:42,279
notification I wanted to be able to go

259
00:10:42,279 --> 00:10:45,759
back in time so that if something so

260
00:10:45,759 --> 00:10:47,110
paceman has this feature where you can

261
00:10:47,110 --> 00:10:49,149
time bound things so you can say it's

262
00:10:49,149 --> 00:10:50,800
only like the 10 minutes it's only live

263
00:10:50,800 --> 00:10:52,920
for an hour or a day or or forever

264
00:10:52,920 --> 00:10:56,439
I wanted the ability to if somebody's

265
00:10:56,439 --> 00:10:57,970
deleted something or if somebody goes

266
00:10:57,970 --> 00:10:59,829
removes it then I can go back and find

267
00:10:59,829 --> 00:11:03,970
and provide some more context malware is

268
00:11:03,970 --> 00:11:07,270
quite often published to pastebin

269
00:11:07,270 --> 00:11:09,190
and pastebin on their defense they're

270
00:11:09,190 --> 00:11:10,780
quite good at finding and taking it down

271
00:11:10,780 --> 00:11:13,480
when it's reported so if I'm working in

272
00:11:13,480 --> 00:11:17,410
a in a soccer assert I see a call out to

273
00:11:17,410 --> 00:11:19,240
paceman that pulls down a bar new file

274
00:11:19,240 --> 00:11:21,250
and maybe I can't get it off the device

275
00:11:21,250 --> 00:11:23,410
I can't get off the box and it turns out

276
00:11:23,410 --> 00:11:25,630
it's been deleted on on paceman itself

277
00:11:25,630 --> 00:11:27,670
then using tools like pay center I can

278
00:11:27,670 --> 00:11:30,340
go back in time recover that paste

279
00:11:30,340 --> 00:11:32,110
exactly as it was on the time that was

280
00:11:32,110 --> 00:11:34,150
infected and then I can start to do more

281
00:11:34,150 --> 00:11:36,610
than analysis so I'm not restricted to

282
00:11:36,610 --> 00:11:39,690
having of caught it right at that time

283
00:11:39,690 --> 00:11:42,550
there's other things as well so if you

284
00:11:42,550 --> 00:11:44,020
wanted to add a new rule into your data

285
00:11:44,020 --> 00:11:46,000
set so maybe you've got a new set of

286
00:11:46,000 --> 00:11:48,400
domains that you've just acquired then

287
00:11:48,400 --> 00:11:49,600
you can put them in and then you can

288
00:11:49,600 --> 00:11:51,340
retroactively research back through

289
00:11:51,340 --> 00:11:52,810
however long you've been capturing data

290
00:11:52,810 --> 00:11:57,430
for and it works in one of two ways you

291
00:11:57,430 --> 00:11:59,140
can either tell it to store everything

292
00:11:59,140 --> 00:12:01,330
or you can tell it only store though

293
00:12:01,330 --> 00:12:04,060
those things that much orals like said

294
00:12:04,060 --> 00:12:06,430
there is some fairly terrifying stuff

295
00:12:06,430 --> 00:12:08,380
that goes in there and maybe you don't

296
00:12:08,380 --> 00:12:11,490
want to collect everything so we've made

297
00:12:11,490 --> 00:12:13,600
available as an option that if you

298
00:12:13,600 --> 00:12:15,190
didn't want to store like all if you

299
00:12:15,190 --> 00:12:17,440
didn't want to index all of github and

300
00:12:17,440 --> 00:12:19,780
guests and paceman which is fairly large

301
00:12:19,780 --> 00:12:21,730
in terms of storage then you don't have

302
00:12:21,730 --> 00:12:23,890
to you can only store and index those

303
00:12:23,890 --> 00:12:25,120
things that much on the rules you're

304
00:12:25,120 --> 00:12:28,810
interested in and then we wanted to

305
00:12:28,810 --> 00:12:30,340
write that somewhere and I wanted

306
00:12:30,340 --> 00:12:31,900
something where it was easy for me to go

307
00:12:31,900 --> 00:12:33,730
I don't have to write a custom front end

308
00:12:33,730 --> 00:12:35,320
and the custom back end to go in search

309
00:12:35,320 --> 00:12:37,450
and quilt and query these and that's

310
00:12:37,450 --> 00:12:39,580
where elastic search came in it's really

311
00:12:39,580 --> 00:12:41,830
easy to deploy it's really easy to use

312
00:12:41,830 --> 00:12:44,650
and it's really really good at just

313
00:12:44,650 --> 00:12:46,540
indexing documents and that's what these

314
00:12:46,540 --> 00:12:50,410
things are they're just big documents so

315
00:12:50,410 --> 00:12:52,390
elastic search was a really good thing

316
00:12:52,390 --> 00:12:54,850
storing for everything index everything

317
00:12:54,850 --> 00:12:57,760
and then use Cabana as a front end to be

318
00:12:57,760 --> 00:12:59,200
able to run those complex searches those

319
00:12:59,200 --> 00:13:03,430
queries we also built other indexes so

320
00:13:03,430 --> 00:13:05,560
it will go out to Jason to CSV or go to

321
00:13:05,560 --> 00:13:08,770
syslog and going to Splunk anywhere they

322
00:13:08,770 --> 00:13:12,100
can take a data feed then we can write

323
00:13:12,100 --> 00:13:17,370
modules really easily the pay center

324
00:13:17,370 --> 00:13:20,350
they know what to do more because why

325
00:13:20,350 --> 00:13:21,280
not

326
00:13:21,280 --> 00:13:23,500
so I was collecting all the stages I'm

327
00:13:23,500 --> 00:13:24,880
going through it I'm finding things like

328
00:13:24,880 --> 00:13:27,610
page 64 encoded executables I'm finding

329
00:13:27,610 --> 00:13:30,310
base64 encoded gzip files I'm finding

330
00:13:30,310 --> 00:13:33,400
like big email dumps and bagheera mod

331
00:13:33,400 --> 00:13:36,880
dumps are interesting kind of so I see a

332
00:13:36,880 --> 00:13:39,720
dump that goes on there's 5,000 emails

333
00:13:39,720 --> 00:13:43,780
there's 300 email domains and then I

334
00:13:43,780 --> 00:13:46,150
find another dump that's got 500 emails

335
00:13:46,150 --> 00:13:47,770
or from a single domain that's

336
00:13:47,770 --> 00:13:49,510
potentially more interesting to me as a

337
00:13:49,510 --> 00:13:53,110
researcher because if I see 5,000 emails

338
00:13:53,110 --> 00:13:55,090
with 300 domains that's somebody

339
00:13:55,090 --> 00:13:57,760
aggregating a load of data or maybe it's

340
00:13:57,760 --> 00:14:00,970
a like a site that's been compromised if

341
00:14:00,970 --> 00:14:03,880
I see one email domain with many emails

342
00:14:03,880 --> 00:14:05,860
that's what like a company's being

343
00:14:05,860 --> 00:14:07,330
compromised

344
00:14:07,330 --> 00:14:10,270
so I started adding those kinds of logic

345
00:14:10,270 --> 00:14:12,160
in there's also things doing like

346
00:14:12,160 --> 00:14:14,410
sentiment analysis that's truly

347
00:14:14,410 --> 00:14:17,290
terrifying having a look at how the what

348
00:14:17,290 --> 00:14:19,480
the sentiment for for paceman this is

349
00:14:19,480 --> 00:14:23,170
not a very friendly place and then like

350
00:14:23,170 --> 00:14:25,480
I said with the malware I wanted to do

351
00:14:25,480 --> 00:14:27,940
more so I've now taken those basics for

352
00:14:27,940 --> 00:14:30,160
encode a suitable zyv deep basics to

353
00:14:30,160 --> 00:14:31,930
afford them and I want to know more

354
00:14:31,930 --> 00:14:34,180
about them so we wrote more modules to

355
00:14:34,180 --> 00:14:36,670
push them into virustotal or just push

356
00:14:36,670 --> 00:14:39,280
the hash up to virustotal see if it

357
00:14:39,280 --> 00:14:40,540
exists see if you can identify the

358
00:14:40,540 --> 00:14:43,000
malware automatically push those samples

359
00:14:43,000 --> 00:14:47,560
into a sandbox like cuckoo or vipre and

360
00:14:47,560 --> 00:14:49,600
then start having all that done so now

361
00:14:49,600 --> 00:14:53,230
from Acer and a stock perspective if I

362
00:14:53,230 --> 00:14:54,730
don't see the pastebin or if it's the

363
00:14:54,730 --> 00:14:56,500
same malware going somewhere else all

364
00:14:56,500 --> 00:14:58,390
that stuff is going into my threat data

365
00:14:58,390 --> 00:15:00,870
I say throw data not threat intelligence

366
00:15:00,870 --> 00:15:02,950
all that stuff's going into my threat

367
00:15:02,950 --> 00:15:05,980
data feeds so kuku spits out like all

368
00:15:05,980 --> 00:15:08,260
the IPAs trying to contact correlated

369
00:15:08,260 --> 00:15:10,150
with the fact that I've got the pastebin

370
00:15:10,150 --> 00:15:12,550
IDs the md5 s so I'm actually starting

371
00:15:12,550 --> 00:15:14,350
to get some quite rich data on this as

372
00:15:14,350 --> 00:15:22,040
well and then alerting

373
00:15:22,040 --> 00:15:23,269
like I said this thing runs in

374
00:15:23,269 --> 00:15:26,870
near-real-time so you can configure how

375
00:15:26,870 --> 00:15:28,579
you like but the default configuration

376
00:15:28,579 --> 00:15:31,399
is every 60 seconds go and get the last

377
00:15:31,399 --> 00:15:34,459
500 pasted so pushed up which is enough

378
00:15:34,459 --> 00:15:38,149
not to abuse any of the api's which are

379
00:15:38,149 --> 00:15:40,399
being used and it's enough that you've

380
00:15:40,399 --> 00:15:44,230
got like I think about 98% fidelity of

381
00:15:44,230 --> 00:15:46,670
catching stuff like AD before it has a

382
00:15:46,670 --> 00:15:49,009
chance of being deleted which is

383
00:15:49,009 --> 00:15:50,930
probably good enough there's probably

384
00:15:50,930 --> 00:15:51,949
more you could do but at that point

385
00:15:51,949 --> 00:15:53,930
you're really starting to get fairly

386
00:15:53,930 --> 00:15:56,120
intensive and chewing up a lot of data

387
00:15:56,120 --> 00:15:59,720
and cycles so I wanted like real-time

388
00:15:59,720 --> 00:16:01,519
alerting so that I didn't have to

389
00:16:01,519 --> 00:16:03,470
constantly go into cabana and have to

390
00:16:03,470 --> 00:16:05,089
monitor and look for stuff I wanted to

391
00:16:05,089 --> 00:16:08,089
be able to notify so the first thing we

392
00:16:08,089 --> 00:16:11,509
put in was email alerting so add in an

393
00:16:11,509 --> 00:16:13,610
email address and then any time a rule

394
00:16:13,610 --> 00:16:16,670
or combination of rules fires then you

395
00:16:16,670 --> 00:16:19,250
can receive notification and because

396
00:16:19,250 --> 00:16:20,870
we're using your own because things are

397
00:16:20,870 --> 00:16:22,579
separated out you can get quite complex

398
00:16:22,579 --> 00:16:25,220
to this she can say that only alert me

399
00:16:25,220 --> 00:16:28,220
if I see my domain in a paste that has

400
00:16:28,220 --> 00:16:30,680
30 other domains that doesn't have any

401
00:16:30,680 --> 00:16:33,139
of these other things in it so you can

402
00:16:33,139 --> 00:16:34,459
do a lot of false positive action not

403
00:16:34,459 --> 00:16:35,899
only get alerted on the things that you

404
00:16:35,899 --> 00:16:39,980
genuinely interested in and then slack

405
00:16:39,980 --> 00:16:41,779
because who doesn't love slack in their

406
00:16:41,779 --> 00:16:44,810
office and Twilio for SMS so just

407
00:16:44,810 --> 00:16:47,540
anything you can do we've also got like

408
00:16:47,540 --> 00:16:49,639
telegram and and Twitter and all these

409
00:16:49,639 --> 00:16:51,170
things so there's loads of ways you can

410
00:16:51,170 --> 00:16:53,660
notify so that if stuff is appearing if

411
00:16:53,660 --> 00:16:55,190
you are leaking data if you are

412
00:16:55,190 --> 00:16:56,720
developers are accidentally pushing

413
00:16:56,720 --> 00:16:58,880
stuff up then you can get notified like

414
00:16:58,880 --> 00:17:01,639
within about five minutes by the time

415
00:17:01,639 --> 00:17:03,110
it's finished processing stuff which is

416
00:17:03,110 --> 00:17:05,359
actually pretty good so also a little

417
00:17:05,359 --> 00:17:09,140
bit terrifying so a couple of months

418
00:17:09,140 --> 00:17:12,349
after I pushed the notification that I

419
00:17:12,349 --> 00:17:15,470
add a alerting and sip in started seeing

420
00:17:15,470 --> 00:17:18,679
so far this sum who started to talk to

421
00:17:18,679 --> 00:17:20,150
me through pastebin and sending me

422
00:17:20,150 --> 00:17:27,380
messages it's fun have a mug in my hand

423
00:17:27,380 --> 00:17:29,570
you know there's a plan it just started

424
00:17:29,570 --> 00:17:31,360
getting weird and at one point somebody

425
00:17:31,360 --> 00:17:35,570
took the lyrics to Barbie girl

426
00:17:35,570 --> 00:17:39,679
and coded them in Morse code and it's

427
00:17:39,679 --> 00:17:41,659
like I'm playing my own CTF with

428
00:17:41,659 --> 00:17:43,220
somebody who I have no idea who they are

429
00:17:43,220 --> 00:17:46,100
and it's it's kind of fun it's also a

430
00:17:46,100 --> 00:17:50,779
little bit terrifying yeah and then who

431
00:17:50,779 --> 00:17:52,580
reads Brandon pace anyway I mean other

432
00:17:52,580 --> 00:17:54,259
than me obviously cuz I live in this

433
00:17:54,259 --> 00:17:57,139
place I was genuinely interested in who

434
00:17:57,139 --> 00:17:58,970
reads around the pastes so I created

435
00:17:58,970 --> 00:18:00,289
something that nobody in their right

436
00:18:00,289 --> 00:18:02,269
mind would have any reason to like go

437
00:18:02,269 --> 00:18:05,799
looking up and I published anonymously

438
00:18:05,799 --> 00:18:07,759
gave it a couple of minutes and went

439
00:18:07,759 --> 00:18:09,470
back and I expected to see myself

440
00:18:09,470 --> 00:18:12,799
hitting it once through through viewing

441
00:18:12,799 --> 00:18:14,659
it and then maybe the API grabbing it as

442
00:18:14,659 --> 00:18:17,389
my stuff was automatic passing it within

443
00:18:17,389 --> 00:18:20,649
three minutes I had thirty three views

444
00:18:20,649 --> 00:18:25,309
that was a shock to me especially as

445
00:18:25,309 --> 00:18:27,919
this isn't the way the view counter

446
00:18:27,919 --> 00:18:29,929
works it's not just the API so if you're

447
00:18:29,929 --> 00:18:32,000
affecting stuff via the API it's not

448
00:18:32,000 --> 00:18:33,440
actually recorded in the page views

449
00:18:33,440 --> 00:18:36,250
that's people actually manually browsing

450
00:18:36,250 --> 00:18:44,990
to the page unfortunately not no so peg

451
00:18:44,990 --> 00:18:48,769
spin will have this data we don't that

452
00:18:48,769 --> 00:18:50,419
information so that the time is

453
00:18:50,419 --> 00:18:52,460
published how many views it is all that

454
00:18:52,460 --> 00:18:54,559
is captured by page centers that is part

455
00:18:54,559 --> 00:18:57,559
of the DPI response over there's no

456
00:18:57,559 --> 00:18:58,909
there's no way of telling like where

457
00:18:58,909 --> 00:19:00,590
those users are coming from that would

458
00:19:00,590 --> 00:19:06,769
be very interesting so that's what it is

459
00:19:06,769 --> 00:19:09,320
so it does it's a little bit of why I

460
00:19:09,320 --> 00:19:12,500
kind of built it so I figured that have

461
00:19:12,500 --> 00:19:15,620
a look at service if it finds so like

462
00:19:15,620 --> 00:19:17,360
said everything goes into kibarim into

463
00:19:17,360 --> 00:19:19,340
an archetype by default make some nice

464
00:19:19,340 --> 00:19:24,830
pretty dashboards so this is a set of

465
00:19:24,830 --> 00:19:28,519
Netflix credentials so free Netflix if

466
00:19:28,519 --> 00:19:30,769
you want it's interesting I don't know

467
00:19:30,769 --> 00:19:32,000
where this added all the source this is

468
00:19:32,000 --> 00:19:34,490
but it's not just these names and

469
00:19:34,490 --> 00:19:36,590
passwords it's also session cookies as

470
00:19:36,590 --> 00:19:38,570
well this is this is going to be

471
00:19:38,570 --> 00:19:41,899
something like in browser or in the

472
00:19:41,899 --> 00:19:43,070
network somewhere that's actually

473
00:19:43,070 --> 00:19:45,379
capturing these responses like that was

474
00:19:45,379 --> 00:19:47,299
generally surprising to see those

475
00:19:47,299 --> 00:19:50,110
cookies being harvested

476
00:19:51,309 --> 00:19:53,659
malware like said there's a lot of

477
00:19:53,659 --> 00:19:55,759
malware a lot of basically coated

478
00:19:55,759 --> 00:19:58,549
executables there's some encrypted

479
00:19:58,549 --> 00:20:01,070
executables there's lots of PowerShell

480
00:20:01,070 --> 00:20:03,559
malware there's just lots of it it's

481
00:20:03,559 --> 00:20:07,940
just all over all over the place and

482
00:20:07,940 --> 00:20:10,159
then like I said all that malware pasted

483
00:20:10,159 --> 00:20:12,649
onto will automatically like decode it

484
00:20:12,649 --> 00:20:14,989
if it can and then sling it across the

485
00:20:14,989 --> 00:20:17,779
virus total and into a sandbox you've

486
00:20:17,779 --> 00:20:19,879
got a sandbox and as you can see nothing

487
00:20:19,879 --> 00:20:21,649
in there is a nice executable it's all

488
00:20:21,649 --> 00:20:26,570
pretty bad in the so I've been with us

489
00:20:26,570 --> 00:20:28,190
for a couple years now I've captured a

490
00:20:28,190 --> 00:20:30,710
couple of thousand bits of malware I've

491
00:20:30,710 --> 00:20:33,229
only seen like two legitimate basic

492
00:20:33,229 --> 00:20:35,929
story coated a few files that have gone

493
00:20:35,929 --> 00:20:38,179
up there which statistically is quite

494
00:20:38,179 --> 00:20:41,029
poor and I'm pretty sure that those were

495
00:20:41,029 --> 00:20:43,489
just being used as part of some other

496
00:20:43,489 --> 00:20:45,919
compromise so they were there the

497
00:20:45,919 --> 00:20:47,629
typical binaries you see flight DLL side

498
00:20:47,629 --> 00:20:49,789
loading attacks where they've got the

499
00:20:49,789 --> 00:20:52,549
authority to load sucide low stuff in so

500
00:20:52,549 --> 00:20:54,379
even then those two like legitimate side

501
00:20:54,379 --> 00:20:56,330
by knows I'm so pretty sure being used

502
00:20:56,330 --> 00:21:01,840
for malicious intent this is somebody's

503
00:21:01,840 --> 00:21:04,549
xml file from their home router which

504
00:21:04,549 --> 00:21:06,710
contains their SS IDs their user names

505
00:21:06,710 --> 00:21:08,059
their passwords their port

506
00:21:08,059 --> 00:21:10,549
configurations so a quick search on

507
00:21:10,549 --> 00:21:12,259
wiggle and you'll find this guy's

508
00:21:12,259 --> 00:21:14,239
address park outside his house i've got

509
00:21:14,239 --> 00:21:17,929
full access to his network not sure why

510
00:21:17,929 --> 00:21:19,940
that kind of stuff gets posted up but

511
00:21:19,940 --> 00:21:22,970
but it does it also has his external

512
00:21:22,970 --> 00:21:24,919
domain on there as well so even if i

513
00:21:24,919 --> 00:21:27,200
couldn't find it on wiggle then i can

514
00:21:27,200 --> 00:21:31,970
start doing some stuff with that lots of

515
00:21:31,970 --> 00:21:35,809
lots and lots of piracy IP TV channels

516
00:21:35,809 --> 00:21:40,309
like shed accounts for netflix and

517
00:21:40,309 --> 00:21:42,019
pretty much any streaming service you

518
00:21:42,019 --> 00:21:43,609
can think of you're gonna find loads of

519
00:21:43,609 --> 00:21:49,539
it on there this one was interesting

520
00:21:49,539 --> 00:21:52,190
anybody recognize up I appreciate might

521
00:21:52,190 --> 00:21:53,359
be a bit difficult to see in the back

522
00:21:53,359 --> 00:21:57,019
that's a vagrant config vault the

523
00:21:57,019 --> 00:22:01,239
vagrant config file includes just there

524
00:22:01,239 --> 00:22:03,060
HTTP link

525
00:22:03,060 --> 00:22:05,670
with the credentials in line so that's

526
00:22:05,670 --> 00:22:07,860
the username which is four characters

527
00:22:07,860 --> 00:22:09,780
and the password which I think is five

528
00:22:09,780 --> 00:22:11,730
or six characters but just in their Vega

529
00:22:11,730 --> 00:22:14,610
file that was a little bit interested

530
00:22:14,610 --> 00:22:16,920
maybe probably stepped over line here

531
00:22:16,920 --> 00:22:18,300
but I was like discover look I see

532
00:22:18,300 --> 00:22:21,690
what's that vagrant box files anybody

533
00:22:21,690 --> 00:22:23,810
familiar with a vagrant box file

534
00:22:23,810 --> 00:22:27,150
basically the same as like a VM image

535
00:22:27,150 --> 00:22:29,730
like a VM disk so if you were to

536
00:22:29,730 --> 00:22:32,370
download that and open that up and mount

537
00:22:32,370 --> 00:22:33,930
those images you'll find the entire

538
00:22:33,930 --> 00:22:37,710
operating system including SSH keys the

539
00:22:37,710 --> 00:22:39,450
password file the shadow files if

540
00:22:39,450 --> 00:22:42,240
they're Linux boxes all the source code

541
00:22:42,240 --> 00:22:43,500
for their entire application like

542
00:22:43,500 --> 00:22:45,960
everything you possibly want is in there

543
00:22:45,960 --> 00:22:48,030
it also comes with a nice handy vagrant

544
00:22:48,030 --> 00:22:49,800
config file which gives you all the

545
00:22:49,800 --> 00:22:51,570
domain names all the secrets all the

546
00:22:51,570 --> 00:22:55,080
access and again this is just shared and

547
00:22:55,080 --> 00:22:58,340
what I found this one so I contacted the

548
00:22:58,340 --> 00:23:02,220
company who was responsible and they

549
00:23:02,220 --> 00:23:04,800
were shocked at why I was bothering to

550
00:23:04,800 --> 00:23:08,460
tell them that's what they do that's how

551
00:23:08,460 --> 00:23:09,960
their developers share stuff they want

552
00:23:09,960 --> 00:23:11,370
to share something that's just seen in

553
00:23:11,370 --> 00:23:12,780
space we paceman says that's what it's

554
00:23:12,780 --> 00:23:12,990
for

555
00:23:12,990 --> 00:23:15,540
it was only after I explained what I

556
00:23:15,540 --> 00:23:18,270
could have done that they realized how

557
00:23:18,270 --> 00:23:20,730
dangerous that actually is they're not

558
00:23:20,730 --> 00:23:25,620
alone you find a lot of this this is

559
00:23:25,620 --> 00:23:28,170
where the profit really comes in so this

560
00:23:28,170 --> 00:23:31,560
is a QA trade so they are a

561
00:23:31,560 --> 00:23:35,220
middle-eastern financial trading service

562
00:23:35,220 --> 00:23:39,000
so currency exchange and in this one

563
00:23:39,000 --> 00:23:42,360
configuration file I have the access

564
00:23:42,360 --> 00:23:45,600
keys for their email service so I can

565
00:23:45,600 --> 00:23:47,580
now access every more service send

566
00:23:47,580 --> 00:23:49,880
receive read whatever you mother want

567
00:23:49,880 --> 00:23:53,220
I've got the email addresses that are

568
00:23:53,220 --> 00:23:55,140
authorized to make wire transfers and

569
00:23:55,140 --> 00:23:57,360
the email address that are authorized to

570
00:23:57,360 --> 00:24:01,350
make deposits then right down at the

571
00:24:01,350 --> 00:24:02,820
bottom I've got the minimum deposit

572
00:24:02,820 --> 00:24:05,340
amount and I've got them makes payment

573
00:24:05,340 --> 00:24:07,880
gateway details that's the MasterCard

574
00:24:07,880 --> 00:24:11,400
gateway details so I've now got access

575
00:24:11,400 --> 00:24:14,280
to MasterCard as if I was them I've got

576
00:24:14,280 --> 00:24:15,960
the email addresses are approved to make

577
00:24:15,960 --> 00:24:16,860
transfers

578
00:24:16,860 --> 00:24:18,929
and I've got access to the email server

579
00:24:18,929 --> 00:24:20,279
to send those emails and made those

580
00:24:20,279 --> 00:24:23,220
transfers and again deliberately shared

581
00:24:23,220 --> 00:24:26,399
by their developers on pastebin because

582
00:24:26,399 --> 00:24:29,120
they were having issues

583
00:24:31,409 --> 00:24:34,590
another config file so this one has all

584
00:24:34,590 --> 00:24:36,990
of the database details to their

585
00:24:36,990 --> 00:24:39,419
entire database not just their

586
00:24:39,419 --> 00:24:41,000
production but also their staging

587
00:24:41,000 --> 00:24:44,279
testing environments their staging and

588
00:24:44,279 --> 00:24:46,289
testing environments are on public

589
00:24:46,289 --> 00:24:48,750
domain so they're publicly listed so

590
00:24:48,750 --> 00:24:50,700
they're on a public IP address and they

591
00:24:50,700 --> 00:24:54,330
just have cloud user and admin

592
00:24:54,330 --> 00:24:56,070
user and admin password as they use

593
00:24:56,070 --> 00:24:58,289
names or passwords so they've done the

594
00:24:58,289 --> 00:24:59,549
right thing they've kind of got some

595
00:24:59,549 --> 00:25:01,110
complex passwords for their production

596
00:25:01,110 --> 00:25:03,149
stuff but their staging environments and

597
00:25:03,149 --> 00:25:04,260
testing environments which are still

598
00:25:04,260 --> 00:25:06,870
public just using like default credits

599
00:25:06,870 --> 00:25:10,760
and default passwords and news names

600
00:25:10,760 --> 00:25:13,200
that one's appreciate that's really hard

601
00:25:13,200 --> 00:25:18,000
to see which is probably a good thing

602
00:25:18,000 --> 00:25:20,490
that's somebody's application for a gun

603
00:25:20,490 --> 00:25:24,539
permit that contains his full name

604
00:25:24,539 --> 00:25:27,799
address age like a date of birth

605
00:25:27,799 --> 00:25:30,539
medical insurance number Social Security

606
00:25:30,539 --> 00:25:33,779
number driving license details car

607
00:25:33,779 --> 00:25:36,029
registration details house registration

608
00:25:36,029 --> 00:25:39,240
details what else is on there the name

609
00:25:39,240 --> 00:25:40,860
of the bank that he's going in the name

610
00:25:40,860 --> 00:25:43,019
of the shop whether he's gonna whether

611
00:25:43,019 --> 00:25:45,630
he's approved for American Express Visa

612
00:25:45,630 --> 00:25:50,309
like there's just loads of it throw it

613
00:25:50,309 --> 00:25:52,769
on page bid and see yeah that's not the

614
00:25:52,769 --> 00:25:56,389
only one of those I found this is

615
00:25:56,389 --> 00:25:59,940
whatever I can't remember the name of

616
00:25:59,940 --> 00:26:01,679
the the shop that was doing this but

617
00:26:01,679 --> 00:26:03,480
they were having issues in getting these

618
00:26:03,480 --> 00:26:05,370
transactions sent through because you

619
00:26:05,370 --> 00:26:06,600
have to send the state off and you get a

620
00:26:06,600 --> 00:26:09,299
yes or no response to say whether

621
00:26:09,299 --> 00:26:11,399
they're permitted to to purchase or not

622
00:26:11,399 --> 00:26:13,019
they were having issues getting through

623
00:26:13,019 --> 00:26:14,549
so they were just sharing this kind of

624
00:26:14,549 --> 00:26:15,870
stuff like every time they're making a

625
00:26:15,870 --> 00:26:17,789
request they just dump it onto here and

626
00:26:17,789 --> 00:26:19,289
share I'm assuming share it with

627
00:26:19,289 --> 00:26:21,350
somebody to see what was going wrong

628
00:26:21,350 --> 00:26:23,789
again terrifying some of the stuff you

629
00:26:23,789 --> 00:26:27,000
can find again another really difficult

630
00:26:27,000 --> 00:26:30,299
one to read so consuming a little bit so

631
00:26:30,299 --> 00:26:30,510
they

632
00:26:30,510 --> 00:26:32,820
is a django config vault for web

633
00:26:32,820 --> 00:26:35,100
application so that's their

634
00:26:35,100 --> 00:26:37,650
connection details again for staging

635
00:26:37,650 --> 00:26:40,830
production source got them our sequel

636
00:26:40,830 --> 00:26:42,630
database because why I have one database

637
00:26:42,630 --> 00:26:43,730
when you cannot do

638
00:26:43,730 --> 00:26:46,799
there's the jadibooti Shrieker so now I

639
00:26:46,799 --> 00:26:48,480
can just spoof and forward to my way

640
00:26:48,480 --> 00:26:52,290
into whatever account I want API URLs

641
00:26:52,290 --> 00:26:54,720
there's their twitter secrets so now I

642
00:26:54,720 --> 00:26:57,000
can post on their behalf

643
00:26:57,000 --> 00:26:59,010
there's there's online chat and line

644
00:26:59,010 --> 00:27:01,290
login so that's a live chat with all

645
00:27:01,290 --> 00:27:02,820
their access keys and I can jump into

646
00:27:02,820 --> 00:27:04,500
their live chat I can control their

647
00:27:04,500 --> 00:27:06,919
Twitter I can control their databases

648
00:27:06,919 --> 00:27:09,600
more twitter keys because who needs more

649
00:27:09,600 --> 00:27:10,980
than one Twitter account Facebook

650
00:27:10,980 --> 00:27:14,960
accounts Instagram Google access keys

651
00:27:14,960 --> 00:27:19,200
mail servers for their SMTP their cloud

652
00:27:19,200 --> 00:27:22,020
fair so not only can I control like all

653
00:27:22,020 --> 00:27:23,850
of their entire site but I can go into

654
00:27:23,850 --> 00:27:25,799
cloud fair and redirect that to where I

655
00:27:25,799 --> 00:27:27,720
wanted to go to because I can use their

656
00:27:27,720 --> 00:27:32,150
cloud first stuff Zenda public API stuff

657
00:27:32,150 --> 00:27:34,740
and like I said that was just in one

658
00:27:34,740 --> 00:27:38,070
giant config file and again I find

659
00:27:38,070 --> 00:27:40,980
probably seven or eight Django config

660
00:27:40,980 --> 00:27:44,549
files like every week just constantly

661
00:27:44,549 --> 00:27:47,669
being pushed and saved into interface

662
00:27:47,669 --> 00:27:51,780
been Twitter API keys like I say get

663
00:27:51,780 --> 00:27:54,450
about seven or eight of these a week so

664
00:27:54,450 --> 00:27:55,910
that's everything you need to be able to

665
00:27:55,910 --> 00:27:59,610
post on behalf of whoever it is usually

666
00:27:59,610 --> 00:28:00,809
find these are people who've got like

667
00:28:00,809 --> 00:28:01,980
Twitter bots which are like

668
00:28:01,980 --> 00:28:04,260
automatically retweeting or looking for

669
00:28:04,260 --> 00:28:06,299
things so you can actually find the

670
00:28:06,299 --> 00:28:07,710
logic of the things they're looking for

671
00:28:07,710 --> 00:28:09,840
as well which in itself is quite

672
00:28:09,840 --> 00:28:11,820
interesting seeing the stuff that people

673
00:28:11,820 --> 00:28:13,580
automatically be posting or retweeting

674
00:28:13,580 --> 00:28:16,230
well it's not just individuals although

675
00:28:16,230 --> 00:28:17,850
there is a lot of individual use also

676
00:28:17,850 --> 00:28:21,450
companies you find their kind of stuff

677
00:28:21,450 --> 00:28:24,809
in here as well and then like I

678
00:28:24,809 --> 00:28:27,780
mentioned earlier so this is an extract

679
00:28:27,780 --> 00:28:28,950
for some logs

680
00:28:28,950 --> 00:28:31,400
this is just somebody publishing logs

681
00:28:31,400 --> 00:28:34,500
not realizing how much sensitive data is

682
00:28:34,500 --> 00:28:36,750
actually leaked in something as simple

683
00:28:36,750 --> 00:28:41,280
as as logs so how much that's last 30

684
00:28:41,280 --> 00:28:43,750
days so 52

685
00:28:43,750 --> 00:28:47,470
Twitter Keys 52 slack API keys I imagine

686
00:28:47,470 --> 00:28:48,909
that's really fun because it's just a

687
00:28:48,909 --> 00:28:50,559
web hook like you could curl to that

688
00:28:50,559 --> 00:28:52,299
whatever message you wanted and it's

689
00:28:52,299 --> 00:28:53,380
just going to start appearing in slack

690
00:28:53,380 --> 00:28:57,429
channels we've also got discord as well

691
00:28:57,429 --> 00:28:59,020
that's really fun

692
00:28:59,020 --> 00:29:02,169
so in is anybody familiar with discord

693
00:29:02,169 --> 00:29:04,360
it's like slight but mainly used by like

694
00:29:04,360 --> 00:29:06,039
gamers and stuff like that and people

695
00:29:06,039 --> 00:29:08,770
are like writtens like games and stuff

696
00:29:08,770 --> 00:29:11,289
in there so you type in words and that

697
00:29:11,289 --> 00:29:13,210
the bots will like start like killing

698
00:29:13,210 --> 00:29:15,610
you and there's this fun stuff but they

699
00:29:15,610 --> 00:29:17,350
published some of this or share it on

700
00:29:17,350 --> 00:29:20,230
here and you can actually take those

701
00:29:20,230 --> 00:29:22,210
keys and you can really you could never

702
00:29:22,210 --> 00:29:24,309
having done it myself obviously I really

703
00:29:24,309 --> 00:29:26,200
have some fun with people if you really

704
00:29:26,200 --> 00:29:28,780
wanted to like either from a malicious

705
00:29:28,780 --> 00:29:31,179
point of view you could start like

706
00:29:31,179 --> 00:29:33,940
posting tweets and links as if you were

707
00:29:33,940 --> 00:29:35,950
the admin of them of those services so

708
00:29:35,950 --> 00:29:39,309
like I said it sounds funny but there's

709
00:29:39,309 --> 00:29:40,690
actually a danger there if any of those

710
00:29:40,690 --> 00:29:41,890
are going into like production

711
00:29:41,890 --> 00:29:45,220
environments and we've seen stuff

712
00:29:45,220 --> 00:29:47,440
there's one which I might be able to

713
00:29:47,440 --> 00:29:50,470
find and it's a slack bot that will

714
00:29:50,470 --> 00:29:53,080
automatically deploy your dock

715
00:29:53,080 --> 00:29:56,710
environment and then send you a slack

716
00:29:56,710 --> 00:29:58,600
message to say it's done it and you've

717
00:29:58,600 --> 00:30:00,130
got the full source code so you can see

718
00:30:00,130 --> 00:30:02,500
the everything is doing like how it's

719
00:30:02,500 --> 00:30:04,210
doing the docker how it's doing the

720
00:30:04,210 --> 00:30:05,740
checks and then where it's making the

721
00:30:05,740 --> 00:30:08,440
slack call so you could like if I was a

722
00:30:08,440 --> 00:30:10,750
malicious I could replace those I could

723
00:30:10,750 --> 00:30:12,760
change that or I could just be really

724
00:30:12,760 --> 00:30:14,679
malicious and just start pulling into

725
00:30:14,679 --> 00:30:16,510
there like docker container down like

726
00:30:16,510 --> 00:30:18,460
just on repeat and just essentially Dass

727
00:30:18,460 --> 00:30:19,570
them because every time it sees that

728
00:30:19,570 --> 00:30:21,820
message it then goes and triggers

729
00:30:21,820 --> 00:30:24,220
re-build so you could actually do some

730
00:30:24,220 --> 00:30:25,630
quite serious damage and people don't

731
00:30:25,630 --> 00:30:28,539
they underestimate how trivial some of

732
00:30:28,539 --> 00:30:32,770
the stuff is to to abuse address access

733
00:30:32,770 --> 00:30:36,970
keys loads of those like generic API

734
00:30:36,970 --> 00:30:40,240
keys DB connection strings so that's

735
00:30:40,240 --> 00:30:44,770
anything that has a like a my sequel :

736
00:30:44,770 --> 00:30:48,700
username : password app domain name for

737
00:30:48,700 --> 00:30:52,360
my sequel Postgres even just Haiti

738
00:30:52,360 --> 00:30:55,020
TB stuff hundreds of those appearing

739
00:30:55,020 --> 00:30:57,309
every

740
00:30:57,309 --> 00:31:01,299
SSH keys and more recently we've got

741
00:31:01,299 --> 00:31:04,690
rules in for OpenVPN keys so people are

742
00:31:04,690 --> 00:31:08,519
sharing their entire OpenVPN config file

743
00:31:08,519 --> 00:31:11,529
including their secret keys the domains

744
00:31:11,529 --> 00:31:13,029
like everything everything you need to

745
00:31:13,029 --> 00:31:16,359
access their infrastructure just right

746
00:31:16,359 --> 00:31:18,039
they're on pace benefit for the entire

747
00:31:18,039 --> 00:31:20,009
world to see and like we saw earlier

748
00:31:20,009 --> 00:31:24,450
people are genuinely going to see this

749
00:31:25,289 --> 00:31:27,609
so I started reporting some of this

750
00:31:27,609 --> 00:31:32,950
stuff pastebin make it really hard you

751
00:31:32,950 --> 00:31:34,779
have to visit the site you have to click

752
00:31:34,779 --> 00:31:36,309
the button to report this site there's

753
00:31:36,309 --> 00:31:38,679
no like nice way of just emailing them

754
00:31:38,679 --> 00:31:41,019
here this thing's I think you should be

755
00:31:41,019 --> 00:31:44,320
looking up you have to like go and do

756
00:31:44,320 --> 00:31:45,869
that

757
00:31:45,869 --> 00:31:49,210
I've tried reporting stuff so if I see

758
00:31:49,210 --> 00:31:50,649
something like really sensitive as I'm

759
00:31:50,649 --> 00:31:53,440
going through like I did with with like

760
00:31:53,440 --> 00:31:55,210
the Warner brother stuff and with other

761
00:31:55,210 --> 00:31:56,889
stuff I try and report at the vagrant

762
00:31:56,889 --> 00:32:00,220
files but again most of the time I can't

763
00:32:00,220 --> 00:32:01,869
get through to a security either they

764
00:32:01,869 --> 00:32:03,759
don't have a security team or they're

765
00:32:03,759 --> 00:32:04,960
just uninterested or they don't

766
00:32:04,960 --> 00:32:08,799
understand the risks which is incredibly

767
00:32:08,799 --> 00:32:11,799
frustrating for me as I'm just generally

768
00:32:11,799 --> 00:32:13,450
trying to help people and all I get is

769
00:32:13,450 --> 00:32:17,080
yeah but why do I care and I said one in

770
00:32:17,080 --> 00:32:18,580
five companies actually respond to

771
00:32:18,580 --> 00:32:21,519
emails I send out so I have an automated

772
00:32:21,519 --> 00:32:23,799
service they're just things like

773
00:32:23,799 --> 00:32:26,619
security up with the details and like

774
00:32:26,619 --> 00:32:28,539
one in five companies actively respond

775
00:32:28,539 --> 00:32:42,369
to that right so let's see so this is

776
00:32:42,369 --> 00:32:50,889
live data this coming in right now so

777
00:32:50,889 --> 00:32:53,859
this is the last 24 hours of stuff

778
00:32:53,859 --> 00:32:56,350
they're streaming into a paste bin and

779
00:32:56,350 --> 00:33:00,070
github and we can see we've got so like

780
00:33:00,070 --> 00:33:05,379
stuff like this so this is a PHP web

781
00:33:05,379 --> 00:33:09,639
shell this being deployed somewhere so

782
00:33:09,639 --> 00:33:10,450
we can find stuff

783
00:33:10,450 --> 00:33:19,629
that didn't we see the did anybody see

784
00:33:19,629 --> 00:33:22,710
the tweet that went out from security

785
00:33:22,710 --> 00:33:28,289
about the the secret key the share the I

786
00:33:28,289 --> 00:33:32,559
woke up my words right in a second the

787
00:33:32,559 --> 00:33:35,619
SSL keys to appear leaked so Atlassian

788
00:33:35,619 --> 00:33:40,869
who owned JIRA they had a desktop app

789
00:33:40,869 --> 00:33:44,859
that contained the keys included in the

790
00:33:44,859 --> 00:33:47,259
SSL key and the private key pretty much

791
00:33:47,259 --> 00:33:48,249
everything you needed to run a

792
00:33:48,249 --> 00:33:50,590
man-in-the-middle attack turns out

793
00:33:50,590 --> 00:33:53,619
they're not the only ones IBM also do

794
00:33:53,619 --> 00:33:55,710
something very similar

795
00:33:55,710 --> 00:33:58,659
that's half-past four about half-past

796
00:33:58,659 --> 00:34:01,539
three on the 4th of December somebody

797
00:34:01,539 --> 00:34:04,720
shared that on paceman and it was

798
00:34:04,720 --> 00:34:07,290
automatically picked up by pay center so

799
00:34:07,290 --> 00:34:10,119
it just shows that within like a couple

800
00:34:10,119 --> 00:34:12,250
of minutes that's a private key that you

801
00:34:12,250 --> 00:34:14,859
need to like revoke immediately that you

802
00:34:14,859 --> 00:34:16,210
could have immediately searched for so

803
00:34:16,210 --> 00:34:18,699
he was using IBM's email address was in

804
00:34:18,699 --> 00:34:20,589
the key she could have written a rule

805
00:34:20,589 --> 00:34:22,690
looking for like IBM email addresses

806
00:34:22,690 --> 00:34:24,429
with a private key and he would have

807
00:34:24,429 --> 00:34:26,379
immediately had a notification so that's

808
00:34:26,379 --> 00:34:27,969
just like some of the strengths where

809
00:34:27,969 --> 00:34:34,719
this is in see what else we got looking

810
00:34:34,719 --> 00:34:37,599
for s3 buckets cuz that's popular at the

811
00:34:37,599 --> 00:34:42,000
minute like I said Amazon credentials

812
00:34:42,089 --> 00:34:45,699
PowerShell is also you see lots of that

813
00:34:45,699 --> 00:34:48,089
on here

814
00:34:48,270 --> 00:34:51,129
and we can see here so this is somebody

815
00:34:51,129 --> 00:34:53,109
running PowerShell which is actually

816
00:34:53,109 --> 00:34:55,329
then pulling another page spin so it's

817
00:34:55,329 --> 00:34:57,309
like you're recursively living inside

818
00:34:57,309 --> 00:35:00,849
basement the malware itself referring to

819
00:35:00,849 --> 00:35:02,770
itself like so we've got basically coded

820
00:35:02,770 --> 00:35:08,559
executables we have database schemas so

821
00:35:08,559 --> 00:35:10,630
I said who needs to sequel inject when

822
00:35:10,630 --> 00:35:12,069
you can just go into Page spin and like

823
00:35:12,069 --> 00:35:14,680
search for and read it they don't make

824
00:35:14,680 --> 00:35:19,210
it difficult for you at all I said this

825
00:35:19,210 --> 00:35:23,920
court API keys say hey so this is a HTTP

826
00:35:23,920 --> 00:35:24,310
service

827
00:35:24,310 --> 00:35:25,870
this caught up so there's the key that's

828
00:35:25,870 --> 00:35:27,820
everything you need in order to be able

829
00:35:27,820 --> 00:35:29,080
suppose this is the kind of thing I was

830
00:35:29,080 --> 00:35:31,270
talking about this is clearly some kind

831
00:35:31,270 --> 00:35:33,610
of like discord game that they're

832
00:35:33,610 --> 00:35:36,750
playing through and you could just like

833
00:35:36,750 --> 00:35:39,460
with not without malicious intent

834
00:35:39,460 --> 00:35:40,990
you can have a lot of fun with whoever's

835
00:35:40,990 --> 00:35:42,790
on that discord server just by

836
00:35:42,790 --> 00:35:45,270
monitoring and starting to play around

837
00:35:45,270 --> 00:35:48,820
unlike say it just goes on and on and on

838
00:35:48,820 --> 00:35:52,600
and on slack API keys a degree SC like

839
00:35:52,600 --> 00:35:54,730
commands that have included gate to BS

840
00:35:54,730 --> 00:35:55,720
access keys

841
00:35:55,720 --> 00:36:00,040
it's just wife that's 24 hours that's 24

842
00:36:00,040 --> 00:36:01,750
hours of just the things that have

843
00:36:01,750 --> 00:36:03,880
matched on a rule for hard-coded

844
00:36:03,880 --> 00:36:06,490
credentials or something like that like

845
00:36:06,490 --> 00:36:07,810
sit behind that work

846
00:36:07,810 --> 00:36:10,300
I'm indexing like everything that goes

847
00:36:10,300 --> 00:36:13,090
into paceman like sets and truly truly

848
00:36:13,090 --> 00:36:24,340
terrifying stuff appears in there yes so

849
00:36:24,340 --> 00:36:29,740
I've been so much fear about 2017 is

850
00:36:29,740 --> 00:36:35,020
when I first started running paceman so

851
00:36:35,020 --> 00:36:41,650
I have a 24 terabytes of home got quite

852
00:36:41,650 --> 00:36:49,210
a bit of data yeah so I like that I've

853
00:36:49,210 --> 00:36:51,070
been indexing page pin since the early

854
00:36:51,070 --> 00:36:54,130
days like gifts and get and stock

855
00:36:54,130 --> 00:36:54,850
overflow

856
00:36:54,850 --> 00:36:56,410
I've only been indexing them for

857
00:36:56,410 --> 00:36:58,530
probably the last eight or nine months

858
00:36:58,530 --> 00:37:02,980
but still like because I want to say

859
00:37:02,980 --> 00:37:06,370
it's like eight gig a week it's this

860
00:37:06,370 --> 00:37:09,190
there's a lot of data I am doing

861
00:37:09,190 --> 00:37:11,890
something to plication now just as I'm

862
00:37:11,890 --> 00:37:14,260
starting to see a lot of stuff and I'm

863
00:37:14,260 --> 00:37:15,880
just burning other bits and pieces but

864
00:37:15,880 --> 00:37:18,250
there's a lot of data what I've just

865
00:37:18,250 --> 00:37:22,120
done is that the second part of this is

866
00:37:22,120 --> 00:37:23,950
so I know how many people are looking

867
00:37:23,950 --> 00:37:25,360
and observing pace you know I don't know

868
00:37:25,360 --> 00:37:26,530
how many people actually abuse uh

869
00:37:26,530 --> 00:37:28,930
privilege so what I've done over the

870
00:37:28,930 --> 00:37:31,120
last three months is I've built a load

871
00:37:31,120 --> 00:37:34,210
of databases and production environments

872
00:37:34,210 --> 00:37:36,370
in a to the US and in other places and

873
00:37:36,370 --> 00:37:36,710
I've

874
00:37:36,710 --> 00:37:40,790
ceding paceman with like real-looking

875
00:37:40,790 --> 00:37:42,859
config files with real-looking keys

876
00:37:42,859 --> 00:37:44,720
stuff that I know you could never prove

877
00:37:44,720 --> 00:37:47,660
force they only access them by getting

878
00:37:47,660 --> 00:37:49,310
it from here and this the only place

879
00:37:49,310 --> 00:37:51,560
I've ever put it and I'm starting to see

880
00:37:51,560 --> 00:37:56,089
connections so like people are I I don't

881
00:37:56,089 --> 00:37:57,710
know whether it's like with malicious

882
00:37:57,710 --> 00:37:59,960
intent or not but people are going

883
00:37:59,960 --> 00:38:01,609
through this they are finding this and

884
00:38:01,609 --> 00:38:10,670
they are starting to abuse it so it

885
00:38:10,670 --> 00:38:15,230
starts off so it's hard stuff because

886
00:38:15,230 --> 00:38:16,430
you're always seeing like background

887
00:38:16,430 --> 00:38:18,980
noise but active connections like people

888
00:38:18,980 --> 00:38:20,690
so that my sequel server was the first

889
00:38:20,690 --> 00:38:24,890
one I did it was alive for about three

890
00:38:24,890 --> 00:38:27,170
days before I had the first actual

891
00:38:27,170 --> 00:38:28,849
connection

892
00:38:28,849 --> 00:38:32,180
two days later it just started and then

893
00:38:32,180 --> 00:38:33,530
it was at his kind of his not quite

894
00:38:33,530 --> 00:38:34,940
exponential but it just kept going from

895
00:38:34,940 --> 00:38:37,520
there so at that point I'm making an

896
00:38:37,520 --> 00:38:39,320
assumption that whoever was found it was

897
00:38:39,320 --> 00:38:41,240
in sharing that was reselling that all

898
00:38:41,240 --> 00:38:42,950
because it's a big wreath reseller

899
00:38:42,950 --> 00:38:45,020
marketing like stolen credentials so I'm

900
00:38:45,020 --> 00:38:46,339
assuming that that's what was happening

901
00:38:46,339 --> 00:38:51,020
with it any more freedom or it's cool

902
00:38:51,020 --> 00:38:53,780
it's completely open source if you want

903
00:38:53,780 --> 00:38:55,310
to go in it yourself you can just find

904
00:38:55,310 --> 00:38:57,890
on github if you want to fix it any of

905
00:38:57,890 --> 00:38:59,540
the crappy code over and then please

906
00:38:59,540 --> 00:39:06,170
come help me fix my Python and it's a

907
00:39:06,170 --> 00:39:08,150
l'église MIT license so that if you do

908
00:39:08,150 --> 00:39:09,080
want to write your own rules you don't

909
00:39:09,080 --> 00:39:11,300
have to share them back in like I said

910
00:39:11,300 --> 00:39:13,520
it's it's there as a tool for for

911
00:39:13,520 --> 00:39:14,690
research as it's there as a tool for

912
00:39:14,690 --> 00:39:16,849
companies I generally hope you can

913
00:39:16,849 --> 00:39:18,859
either make you sweat thank you very

914
00:39:18,859 --> 00:39:20,980
much

