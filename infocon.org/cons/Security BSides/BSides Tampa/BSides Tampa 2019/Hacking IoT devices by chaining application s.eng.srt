1
00:00:00,030 --> 00:00:08,910
and we up<font color="#E5E5E5"> a speaker today</font><font color="#CCCCCC"> is Rick</font><font color="#E5E5E5"> Ramadi</font>

2
00:00:05,609 --> 00:00:12,570
<font color="#E5E5E5">and he's going to be speaking about do</font>

3
00:00:08,910 --> 00:00:14,580
you<font color="#E5E5E5"> require</font><font color="#CCCCCC"> hacking IOT devices by</font>

4
00:00:12,570 --> 00:00:19,080
chaining<font color="#E5E5E5"> application security</font>

5
00:00:14,580 --> 00:00:21,948
vulnerabilities<font color="#CCCCCC"> Rick is a security</font>

6
00:00:19,080 --> 00:00:26,609
analyst at<font color="#CCCCCC"> independent security</font>

7
00:00:21,949 --> 00:00:29,820
<font color="#E5E5E5">evaluators and</font><font color="#CCCCCC"> Rick has conducted</font>

8
00:00:26,609 --> 00:00:32,610
<font color="#E5E5E5">high-end custom security assessments of</font>

9
00:00:29,820 --> 00:00:36,360
hardware<font color="#E5E5E5"> software and</font><font color="#CCCCCC"> he manages a team</font>

10
00:00:32,610 --> 00:00:38,519
<font color="#CCCCCC">of security</font><font color="#E5E5E5"> researchers Rick enjoys</font>

11
00:00:36,360 --> 00:00:42,000
being part of<font color="#E5E5E5"> a growing community</font><font color="#CCCCCC"> of</font>

12
00:00:38,520 --> 00:00:43,920
information<font color="#E5E5E5"> security and he appreciates</font>

13
00:00:42,000 --> 00:00:46,500
the<font color="#E5E5E5"> art of the reverse engineering</font>

14
00:00:43,920 --> 00:00:48,120
<font color="#CCCCCC">that's his main gig and he's going to</font><font color="#E5E5E5"> be</font>

15
00:00:46,500 --> 00:00:50,280
<font color="#CCCCCC">sharing that with us today</font>

16
00:00:48,120 --> 00:00:56,730
so<font color="#E5E5E5"> welcome Rick thank you for sharing</font>

17
00:00:50,280 --> 00:00:58,770
everything<font color="#E5E5E5"> all right thanks</font><font color="#CCCCCC"> ok and you</font>

18
00:00:56,730 --> 00:01:00,120
guys hear<font color="#E5E5E5"> me in the</font><font color="#CCCCCC"> back</font><font color="#E5E5E5"> I want to stand</font>

19
00:00:58,770 --> 00:01:02,460
when I speak<font color="#CCCCCC"> all right that's a</font>

20
00:01:00,120 --> 00:01:03,629
<font color="#CCCCCC">thumbs-up so</font><font color="#E5E5E5"> take that as a</font><font color="#CCCCCC"> yes like</font><font color="#E5E5E5"> you</font>

21
00:01:02,460 --> 00:01:05,519
<font color="#E5E5E5">mentioned my</font><font color="#CCCCCC"> name</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> Rick Kuhn Gary</font>

22
00:01:03,629 --> 00:01:07,229
<font color="#CCCCCC">um the presentation</font><font color="#E5E5E5"> is gonna be a little</font>

23
00:01:05,519 --> 00:01:08,729
bit<font color="#E5E5E5"> more loose</font><font color="#CCCCCC"> because I wanted</font><font color="#E5E5E5"> it to be</font>

24
00:01:07,229 --> 00:01:10,890
so that<font color="#CCCCCC"> you</font><font color="#E5E5E5"> guys can actually watch me</font>

25
00:01:08,729 --> 00:01:12,780
hack and see the process<font color="#CCCCCC"> we're just like</font>

26
00:01:10,890 --> 00:01:14,760
not clicking a button and hacking things

27
00:01:12,780 --> 00:01:16,320
we'll see<font color="#CCCCCC"> the process that people</font><font color="#E5E5E5"> go</font>

28
00:01:14,760 --> 00:01:18,420
<font color="#CCCCCC">through</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> they find vulnerabilities</font>

29
00:01:16,320 --> 00:01:20,008
<font color="#E5E5E5">and</font><font color="#CCCCCC"> builds exploits for</font><font color="#E5E5E5"> them so it's</font>

30
00:01:18,420 --> 00:01:23,189
<font color="#E5E5E5">more</font><font color="#CCCCCC"> of like what real hacking looks</font>

31
00:01:20,009 --> 00:01:25,619
like the name of my talk is<font color="#E5E5E5"> introduction</font>

32
00:01:23,189 --> 00:01:27,360
to vulnerability<font color="#CCCCCC"> chains</font><font color="#E5E5E5"> so this is just</font>

33
00:01:25,619 --> 00:01:29,549
not a single vulnerability we end up

34
00:01:27,360 --> 00:01:31,530
chaining cross-site scripting which is a

35
00:01:29,549 --> 00:01:33,689
pretty usual vulnerability that we see

36
00:01:31,530 --> 00:01:34,890
to get on an authenticated command

37
00:01:33,689 --> 00:01:37,169
injection so there's a command injection

38
00:01:34,890 --> 00:01:39,450
that we find by<font color="#CCCCCC"> default</font><font color="#E5E5E5"> but it doesn't</font>

39
00:01:37,170 --> 00:01:40,320
have<font color="#CCCCCC"> well it requires authentication and</font>

40
00:01:39,450 --> 00:01:43,560
<font color="#E5E5E5">we want to see how we can get around</font>

41
00:01:40,320 --> 00:01:45,240
<font color="#E5E5E5">that so first a little bit</font><font color="#CCCCCC"> about myself</font>

42
00:01:43,560 --> 00:01:46,710
<font color="#E5E5E5">like</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> mentioned my name</font><font color="#CCCCCC"> is Rambaldi</font>

43
00:01:45,240 --> 00:01:47,759
there are the things<font color="#CCCCCC"> that I like I enjoy</font>

44
00:01:46,710 --> 00:01:50,279
<font color="#E5E5E5">other</font><font color="#CCCCCC"> things but</font><font color="#E5E5E5"> those are the things</font>

45
00:01:47,759 --> 00:01:51,570
<font color="#CCCCCC">that I</font><font color="#E5E5E5"> enjoy the most</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> I'm a security</font>

46
00:01:50,280 --> 00:01:54,090
<font color="#E5E5E5">analyst and independent security</font>

47
00:01:51,570 --> 00:01:55,470
evaluators since I paid for me<font color="#E5E5E5"> to be</font>

48
00:01:54,090 --> 00:01:57,509
here<font color="#CCCCCC"> this is who independent security</font>

49
00:01:55,470 --> 00:01:58,710
evaluators is we're based out<font color="#CCCCCC"> of</font>

50
00:01:57,509 --> 00:02:00,899
Baltimore<font color="#E5E5E5"> Maryland</font><font color="#CCCCCC"> we also have an</font>

51
00:01:58,710 --> 00:02:02,850
<font color="#CCCCCC">office in</font><font color="#E5E5E5"> San Diego California</font><font color="#CCCCCC"> we do a</font>

52
00:02:00,899 --> 00:02:05,640
<font color="#E5E5E5">bunch of security assessment type deals</font>

53
00:02:02,850 --> 00:02:07,829
and we look at mobile applications and

54
00:02:05,640 --> 00:02:09,780
<font color="#E5E5E5">web applications or pretty much if you</font>

55
00:02:07,829 --> 00:02:12,510
<font color="#CCCCCC">have</font><font color="#E5E5E5"> something</font><font color="#CCCCCC"> that you wrote</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> you</font>

56
00:02:09,780 --> 00:02:13,520
want somebody<font color="#CCCCCC"> audit somebody to audit so</font>

57
00:02:12,510 --> 00:02:15,709
if you have a custom

58
00:02:13,520 --> 00:02:16,760
like custom the<font color="#E5E5E5"> RM implementation or</font>

59
00:02:15,710 --> 00:02:20,570
something like<font color="#E5E5E5"> that</font><font color="#CCCCCC"> would be happy</font><font color="#E5E5E5"> to</font>

60
00:02:16,760 --> 00:02:22,730
look at<font color="#E5E5E5"> it I don't</font><font color="#CCCCCC"> see this slide</font><font color="#E5E5E5"> all</font>

61
00:02:20,570 --> 00:02:24,890
that<font color="#E5E5E5"> often but I wanted</font><font color="#CCCCCC"> to remind you</font>

62
00:02:22,730 --> 00:02:26,630
<font color="#CCCCCC">guys why I'm presenting so the reason</font>

63
00:02:24,890 --> 00:02:27,980
why is that<font color="#E5E5E5"> a lot of the times I'll be</font>

64
00:02:26,630 --> 00:02:28,549
talking<font color="#E5E5E5"> to</font><font color="#CCCCCC"> people</font><font color="#E5E5E5"> when I go to a</font>

65
00:02:27,980 --> 00:02:30,560
hackerspace

66
00:02:28,550 --> 00:02:32,570
and they really think<font color="#E5E5E5"> that hacking is</font>

67
00:02:30,560 --> 00:02:34,610
all about<font color="#E5E5E5"> just like using</font><font color="#CCCCCC"> necess</font><font color="#E5E5E5"> or like</font>

68
00:02:32,570 --> 00:02:37,070
running a scanner and finding a what he

69
00:02:34,610 --> 00:02:38,810
loved what like SSL's<font color="#E5E5E5"> on cypress suites</font>

70
00:02:37,070 --> 00:02:41,060
are wrong and it's more about<font color="#CCCCCC"> like</font>

71
00:02:38,810 --> 00:02:43,220
<font color="#E5E5E5">finding</font><font color="#CCCCCC"> vulnerabilities that</font><font color="#E5E5E5"> somebody</font>

72
00:02:41,060 --> 00:02:45,860
can use<font color="#E5E5E5"> to</font><font color="#CCCCCC"> exploit</font><font color="#E5E5E5"> an application or</font><font color="#CCCCCC"> at</font>

73
00:02:43,220 --> 00:02:47,390
least that's how<font color="#CCCCCC"> I feel</font><font color="#E5E5E5"> and I also</font>

74
00:02:45,860 --> 00:02:49,190
wanted<font color="#CCCCCC"> to give the idea that it's not</font>

75
00:02:47,390 --> 00:02:51,109
just<font color="#E5E5E5"> like somebody who finds these</font>

76
00:02:49,190 --> 00:02:52,670
vulnerabilities by saying like they run

77
00:02:51,110 --> 00:02:54,110
burp suite scanner and<font color="#E5E5E5"> they found all</font>

78
00:02:52,670 --> 00:02:56,450
these things<font color="#E5E5E5"> it's a lot about like</font>

79
00:02:54,110 --> 00:02:58,760
<font color="#E5E5E5">having to do things by hand and reverse</font>

80
00:02:56,450 --> 00:03:00,410
engineering protocols<font color="#E5E5E5"> or like looking at</font>

81
00:02:58,760 --> 00:03:01,940
a binary for a couple hours<font color="#CCCCCC"> and crying</font>

82
00:03:00,410 --> 00:03:04,579
and then eventually figuring out that it

83
00:03:01,940 --> 00:03:06,590
is right it<font color="#CCCCCC"> is in fact vulnerable and</font>

84
00:03:04,580 --> 00:03:08,360
then after like how to pick out<font color="#E5E5E5"> attack</font>

85
00:03:06,590 --> 00:03:09,530
<font color="#CCCCCC">services</font><font color="#E5E5E5"> the device that I have</font><font color="#CCCCCC"> that's</font>

86
00:03:08,360 --> 00:03:11,180
down here<font color="#CCCCCC"> that</font><font color="#E5E5E5"> you guys can't see it's</font>

87
00:03:09,530 --> 00:03:12,710
<font color="#E5E5E5">about my feet it's an AZ device I'm</font>

88
00:03:11,180 --> 00:03:15,020
gonna be running<font color="#CCCCCC"> a demo</font><font color="#E5E5E5"> today and</font>

89
00:03:12,710 --> 00:03:17,060
finding<font color="#E5E5E5"> vulnerabilities in it and it's a</font>

90
00:03:15,020 --> 00:03:19,430
lot about<font color="#E5E5E5"> finding attack surfaces so</font>

91
00:03:17,060 --> 00:03:23,030
it's<font color="#E5E5E5"> not only about well this is running</font>

92
00:03:19,430 --> 00:03:24,590
of vulnerable versions of SMB it's a lot

93
00:03:23,030 --> 00:03:26,300
about saying<font color="#E5E5E5"> it's like oh it has a web</font>

94
00:03:24,590 --> 00:03:28,220
application<font color="#CCCCCC"> that has their interface</font>

95
00:03:26,300 --> 00:03:31,610
with things on the operating system<font color="#CCCCCC"> and</font>

96
00:03:28,220 --> 00:03:33,170
<font color="#E5E5E5">how can I go wrong so these are</font><font color="#CCCCCC"> our</font>

97
00:03:31,610 --> 00:03:34,520
goals today<font color="#CCCCCC"> the first thing that we're</font>

98
00:03:33,170 --> 00:03:35,899
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> focus on is that we're gonna</font>

99
00:03:34,520 --> 00:03:37,340
figure out how<font color="#E5E5E5"> to interface with the</font>

100
00:03:35,900 --> 00:03:39,530
<font color="#E5E5E5">device and I've already told you how</font>

101
00:03:37,340 --> 00:03:41,420
we're gonna do that<font color="#CCCCCC"> it's it does have an</font>

102
00:03:39,530 --> 00:03:44,120
<font color="#E5E5E5">Ethernet adapter so it's like a normal</font>

103
00:03:41,420 --> 00:03:46,100
rj45<font color="#E5E5E5"> you connect to</font><font color="#CCCCCC"> it and</font><font color="#E5E5E5"> then after</font>

104
00:03:44,120 --> 00:03:48,980
you<font color="#E5E5E5"> can interface with</font><font color="#CCCCCC"> it and by default</font>

105
00:03:46,100 --> 00:03:51,560
most<font color="#E5E5E5"> of these devices have a way</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> you</font>

106
00:03:48,980 --> 00:03:53,239
to configure it<font color="#E5E5E5"> if you have a router in</font>

107
00:03:51,560 --> 00:03:54,800
<font color="#CCCCCC">your house which</font><font color="#E5E5E5"> I'm most likely</font><font color="#CCCCCC"> most of</font>

108
00:03:53,240 --> 00:03:56,270
you do then you'll have an

109
00:03:54,800 --> 00:03:58,460
administration<font color="#E5E5E5"> panel or</font><font color="#CCCCCC"> a like if you</font>

110
00:03:56,270 --> 00:03:59,930
have an<font color="#E5E5E5"> AZ device or IP camera that</font>

111
00:03:58,460 --> 00:04:04,640
doesn't use triangular routing it's

112
00:03:59,930 --> 00:04:06,890
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> be the same this this</font><font color="#CCCCCC"> is the</font>

113
00:04:04,640 --> 00:04:08,450
outline of the<font color="#CCCCCC"> talk itself</font><font color="#E5E5E5"> it's we're</font>

114
00:04:06,890 --> 00:04:10,730
<font color="#E5E5E5">going to be talking</font><font color="#CCCCCC"> about what do Lenovo</font>

115
00:04:08,450 --> 00:04:12,440
<font color="#E5E5E5">miix</font><font color="#CCCCCC"> 4 is we're gonna find the attack</font>

116
00:04:10,730 --> 00:04:14,090
surfaces we're gonna find

117
00:04:12,440 --> 00:04:15,079
vulnerabilities<font color="#CCCCCC"> there's the two that I</font>

118
00:04:14,090 --> 00:04:16,010
already<font color="#E5E5E5"> mentioned we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> find</font>

119
00:04:15,080 --> 00:04:17,840
cross-site scripting<font color="#CCCCCC"> and command</font>

120
00:04:16,010 --> 00:04:20,079
injection<font color="#E5E5E5"> and chain those together and</font>

121
00:04:17,839 --> 00:04:22,400
last we're<font color="#E5E5E5"> going to build the exploit</font>

122
00:04:20,079 --> 00:04:24,349
this is our guest of honor<font color="#CCCCCC"> for those of</font>

123
00:04:22,400 --> 00:04:27,020
you that are wondering<font color="#E5E5E5"> hey Daisy Lenovo</font>

124
00:04:24,350 --> 00:04:31,970
<font color="#E5E5E5">ix4 300d as well as the</font>

125
00:04:27,020 --> 00:04:34,729
<font color="#E5E5E5">maybe</font><font color="#CCCCCC"> lenovo i think in like 2016 2015</font>

126
00:04:31,970 --> 00:04:36,289
if<font color="#CCCCCC"> i'm not</font><font color="#E5E5E5"> wrong</font><font color="#CCCCCC"> and it's</font><font color="#E5E5E5"> just normal</font>

127
00:04:34,729 --> 00:04:38,479
<font color="#CCCCCC">network attached storage it was designed</font>

128
00:04:36,289 --> 00:04:40,520
for<font color="#E5E5E5"> enterprise</font><font color="#CCCCCC"> use but people buy the</font>

129
00:04:38,479 --> 00:04:42,710
<font color="#CCCCCC">Iomega version of</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> device for</font><font color="#E5E5E5"> their</font>

130
00:04:40,520 --> 00:04:44,359
<font color="#E5E5E5">houses because it's cheaper as you can</font>

131
00:04:42,710 --> 00:04:47,359
see it has a very<font color="#E5E5E5"> small amount</font><font color="#CCCCCC"> of RAM</font>

132
00:04:44,360 --> 00:04:49,849
because<font color="#CCCCCC"> also many years ago and so it</font>

133
00:04:47,360 --> 00:04:53,780
<font color="#CCCCCC">just has SATA drives and the rj45 that I</font>

134
00:04:49,849 --> 00:04:55,370
mentioned before<font color="#E5E5E5"> here</font><font color="#CCCCCC"> the details</font><font color="#E5E5E5"> that I</font>

135
00:04:53,780 --> 00:04:57,919
want you<font color="#E5E5E5"> to keep in mind there</font><font color="#CCCCCC"> are</font>

136
00:04:55,370 --> 00:04:59,120
threats that can<font color="#CCCCCC"> be internal threats</font><font color="#E5E5E5"> so</font>

137
00:04:57,919 --> 00:05:01,419
like for<font color="#CCCCCC"> example somebody</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> really</font>

138
00:04:59,120 --> 00:05:03,169
has access<font color="#CCCCCC"> to your network</font><font color="#E5E5E5"> or a</font>

139
00:05:01,419 --> 00:05:05,060
vulnerability<font color="#E5E5E5"> that you can exploit</font>

140
00:05:03,169 --> 00:05:07,880
through another service so for<font color="#E5E5E5"> example a</font>

141
00:05:05,060 --> 00:05:09,560
browser on<font color="#E5E5E5"> your computer if your</font>

142
00:05:07,880 --> 00:05:11,030
<font color="#E5E5E5">computers on the same network</font><font color="#CCCCCC"> it does</font>

143
00:05:09,560 --> 00:05:13,220
provide an extra attack surface so you

144
00:05:11,030 --> 00:05:14,750
can interface with<font color="#E5E5E5"> these devices giving</font>

145
00:05:13,220 --> 00:05:17,720
the right protocol<font color="#E5E5E5"> the right protocol in</font>

146
00:05:14,750 --> 00:05:19,419
<font color="#E5E5E5">this case would be HTTP there's external</font>

147
00:05:17,720 --> 00:05:21,860
<font color="#E5E5E5">threats</font><font color="#CCCCCC"> so if you could just send</font>

148
00:05:19,419 --> 00:05:24,080
commands directly<font color="#E5E5E5"> to the device</font><font color="#CCCCCC"> so if</font>

149
00:05:21,860 --> 00:05:27,379
this<font color="#CCCCCC"> device is something that you have</font>

150
00:05:24,080 --> 00:05:28,818
used for<font color="#CCCCCC"> externally facing so if you use</font>

151
00:05:27,379 --> 00:05:30,409
port forwarding so that you can access

152
00:05:28,819 --> 00:05:32,419
your<font color="#CCCCCC"> nas</font><font color="#E5E5E5"> from home from anywhere</font><font color="#CCCCCC"> in the</font>

153
00:05:30,409 --> 00:05:35,110
<font color="#CCCCCC">world it's also</font><font color="#E5E5E5"> a threat you should be</font>

154
00:05:32,419 --> 00:05:37,818
considering<font color="#E5E5E5"> and the last thing is that</font>

155
00:05:35,110 --> 00:05:39,770
the authentication I mentioned already

156
00:05:37,819 --> 00:05:41,599
<font color="#CCCCCC">that you don't need authentication</font>

157
00:05:39,770 --> 00:05:43,219
always even if it is an authenticated

158
00:05:41,599 --> 00:05:44,509
vulnerability because I've<font color="#E5E5E5"> warned about</font>

159
00:05:43,219 --> 00:05:45,710
<font color="#E5E5E5">because of</font><font color="#CCCCCC"> attack side cross-site</font>

160
00:05:44,509 --> 00:05:50,509
request forgery you can<font color="#CCCCCC"> easily get</font>

161
00:05:45,710 --> 00:05:51,799
<font color="#CCCCCC">around that here's a</font><font color="#E5E5E5"> list of things that</font>

162
00:05:50,509 --> 00:05:53,240
I want<font color="#E5E5E5"> us</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> get we want to get a remote</font>

163
00:05:51,800 --> 00:05:54,349
shell we're going to exploit that

164
00:05:53,240 --> 00:05:55,699
command injection and cross the

165
00:05:54,349 --> 00:05:57,289
<font color="#E5E5E5">scripting that I've</font><font color="#CCCCCC"> mentioned so often</font>

166
00:05:55,699 --> 00:06:00,860
and these are the places<font color="#CCCCCC"> that we're</font>

167
00:05:57,289 --> 00:06:02,719
<font color="#E5E5E5">going to get it so a lot</font><font color="#CCCCCC"> of the times</font>

168
00:06:00,860 --> 00:06:04,400
when<font color="#E5E5E5"> you work with anything</font><font color="#CCCCCC"> that has</font>

169
00:06:02,719 --> 00:06:06,710
<font color="#E5E5E5">their interface with the ability to</font>

170
00:06:04,400 --> 00:06:08,929
<font color="#E5E5E5">create directories and remove them from</font>

171
00:06:06,710 --> 00:06:11,150
a embedded device or from<font color="#CCCCCC"> anything else</font>

172
00:06:08,930 --> 00:06:13,219
so<font color="#E5E5E5"> even if it's like some PHP web</font>

173
00:06:11,150 --> 00:06:15,318
application<font color="#CCCCCC"> on a real server if it has</font>

174
00:06:13,219 --> 00:06:17,380
the ability<font color="#CCCCCC"> to interface with</font><font color="#E5E5E5"> any</font>

175
00:06:15,319 --> 00:06:20,270
directory by creating<font color="#E5E5E5"> it deleting it or</font>

176
00:06:17,380 --> 00:06:21,560
<font color="#E5E5E5">creating new shares for example that can</font>

177
00:06:20,270 --> 00:06:23,690
lead to command injection that's one of

178
00:06:21,560 --> 00:06:26,180
them<font color="#E5E5E5"> that we'll see today</font><font color="#CCCCCC"> or if it has</font>

179
00:06:23,690 --> 00:06:28,909
another<font color="#E5E5E5"> functionality for curling a URL</font>

180
00:06:26,180 --> 00:06:31,789
<font color="#E5E5E5">that's anything that it has to we're</font>

181
00:06:28,909 --> 00:06:34,370
relying on<font color="#E5E5E5"> the operating system</font><font color="#CCCCCC"> to do</font>

182
00:06:31,789 --> 00:06:36,199
something for us<font color="#E5E5E5"> one of the common</font><font color="#CCCCCC"> ones</font>

183
00:06:34,370 --> 00:06:39,289
that<font color="#CCCCCC"> we see if any of</font><font color="#E5E5E5"> you played the</font><font color="#CCCCCC"> IOT</font>

184
00:06:36,199 --> 00:06:40,430
<font color="#CCCCCC">volts today is the paym utility has ping</font>

185
00:06:39,289 --> 00:06:41,780
is something that like most

186
00:06:40,430 --> 00:06:43,490
<font color="#E5E5E5">the time they</font><font color="#CCCCCC"> just instead of rewriting</font>

187
00:06:41,780 --> 00:06:44,989
<font color="#E5E5E5">ping they'll just use the one from</font><font color="#CCCCCC"> the</font>

188
00:06:43,490 --> 00:06:47,720
operating<font color="#CCCCCC"> system because</font><font color="#E5E5E5"> it makes</font>

189
00:06:44,990 --> 00:06:49,310
everything a<font color="#E5E5E5"> lot easier</font><font color="#CCCCCC"> and it also like</font>

190
00:06:47,720 --> 00:06:52,730
it's the idea of reusability instead of

191
00:06:49,310 --> 00:06:56,000
<font color="#E5E5E5">having to make new code every time sweet</font>

192
00:06:52,730 --> 00:06:59,720
<font color="#E5E5E5">so let's dive in now and look at</font><font color="#CCCCCC"> a</font>

193
00:06:56,000 --> 00:07:02,540
device so if I have Firefox<font color="#E5E5E5"> here</font>

194
00:06:59,720 --> 00:07:03,880
somewhere<font color="#E5E5E5"> so this is just that's not</font>

195
00:07:02,540 --> 00:07:05,930
<font color="#CCCCCC">Firefox</font>

196
00:07:03,880 --> 00:07:08,659
well<font color="#CCCCCC"> I mean it let me figure</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> my</font>

197
00:07:05,930 --> 00:07:14,210
displays or<font color="#E5E5E5"> if I exit presenter mode</font>

198
00:07:08,660 --> 00:07:15,860
<font color="#E5E5E5">that should help</font><font color="#CCCCCC"> alrighty</font><font color="#E5E5E5"> so here is</font>

199
00:07:14,210 --> 00:07:17,180
<font color="#E5E5E5">just a normal web app we'll go to the</font>

200
00:07:15,860 --> 00:07:20,900
home<font color="#CCCCCC"> page so that</font><font color="#E5E5E5"> you guys can see what</font>

201
00:07:17,180 --> 00:07:22,460
<font color="#E5E5E5">it looks like and when you buy one</font><font color="#CCCCCC"> of</font>

202
00:07:20,900 --> 00:07:24,260
these<font color="#E5E5E5"> Lenovo</font><font color="#CCCCCC"> nas's this is where you get</font>

203
00:07:22,460 --> 00:07:27,140
<font color="#E5E5E5">second normal web application so you can</font>

204
00:07:24,260 --> 00:07:29,240
interface<font color="#CCCCCC"> with it and do stuff if you</font>

205
00:07:27,140 --> 00:07:32,510
click on the slide show you get still

206
00:07:29,240 --> 00:07:34,310
<font color="#E5E5E5">these pretty things it's like</font><font color="#CCCCCC"> well which</font>

207
00:07:32,510 --> 00:07:36,050
<font color="#CCCCCC">really doesn't matter for right now</font><font color="#E5E5E5"> but</font>

208
00:07:34,310 --> 00:07:38,530
there's also the content<font color="#E5E5E5"> page as you can</font>

209
00:07:36,050 --> 00:07:40,760
<font color="#E5E5E5">see there's like some command injection</font>

210
00:07:38,530 --> 00:07:43,130
<font color="#CCCCCC">attempts that I've already</font><font color="#E5E5E5"> created</font><font color="#CCCCCC"> some</font>

211
00:07:40,760 --> 00:07:44,510
of<font color="#CCCCCC"> the shares</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> the for this demo I'm</font>

212
00:07:43,130 --> 00:07:45,730
not gonna<font color="#E5E5E5"> use you reboot one because I</font>

213
00:07:44,510 --> 00:07:48,080
<font color="#E5E5E5">don't want to shoot myself in the foot</font>

214
00:07:45,730 --> 00:07:51,830
but I do want to show you<font color="#CCCCCC"> guys some of</font>

215
00:07:48,080 --> 00:07:53,659
<font color="#E5E5E5">the other functionality so here are all</font>

216
00:07:51,830 --> 00:07:55,820
<font color="#CCCCCC">the</font><font color="#E5E5E5"> features that it provides as you can</font>

217
00:07:53,660 --> 00:07:59,030
see it is a<font color="#E5E5E5"> very rich feature set</font><font color="#CCCCCC"> I</font>

218
00:07:55,820 --> 00:08:00,140
don't<font color="#CCCCCC"> this you know</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> also see</font>

219
00:07:59,030 --> 00:08:02,450
that<font color="#CCCCCC"> it's a</font><font color="#E5E5E5"> little dated</font><font color="#CCCCCC"> because I don't</font>

220
00:08:00,140 --> 00:08:03,530
<font color="#E5E5E5">know Flickr is still a thing but it is</font>

221
00:08:02,450 --> 00:08:05,659
<font color="#E5E5E5">that it does provide</font><font color="#CCCCCC"> a lot of</font>

222
00:08:03,530 --> 00:08:07,940
<font color="#CCCCCC">functionality</font><font color="#E5E5E5"> and one of the</font>

223
00:08:05,660 --> 00:08:14,600
functionalities is the<font color="#CCCCCC"> ability to create</font>

224
00:08:07,940 --> 00:08:16,310
shares which is right here<font color="#CCCCCC"> so if you</font>

225
00:08:14,600 --> 00:08:19,550
<font color="#E5E5E5">look at the first one it's just like I</font>

226
00:08:16,310 --> 00:08:21,410
<font color="#CCCCCC">used</font><font color="#E5E5E5"> backticks and curl to put in or</font>

227
00:08:19,550 --> 00:08:23,080
backticks and then a curl and<font color="#CCCCCC"> it's some</font>

228
00:08:21,410 --> 00:08:25,670
IP address<font color="#E5E5E5"> to test for command injection</font>

229
00:08:23,080 --> 00:08:28,190
<font color="#E5E5E5">in this case the reason why I used</font>

230
00:08:25,670 --> 00:08:31,490
<font color="#E5E5E5">backticks is that it's a good way to</font>

231
00:08:28,190 --> 00:08:32,929
escape<font color="#CCCCCC"> where your the current shell or</font>

232
00:08:31,490 --> 00:08:34,850
like the current thing that you're

233
00:08:32,929 --> 00:08:36,650
<font color="#E5E5E5">shelling out of</font><font color="#CCCCCC"> I'm gonna have to</font>

234
00:08:34,850 --> 00:08:38,180
execute your<font color="#E5E5E5"> own commands you could also</font>

235
00:08:36,650 --> 00:08:40,010
use other characters<font color="#E5E5E5"> like for example</font>

236
00:08:38,179 --> 00:08:41,929
dollar sign and<font color="#E5E5E5"> parentheses are good</font>

237
00:08:40,010 --> 00:08:43,760
<font color="#E5E5E5">combination sometimes for testing out</font>

238
00:08:41,929 --> 00:08:46,579
for command injection<font color="#E5E5E5"> but there's a</font>

239
00:08:43,760 --> 00:08:47,870
<font color="#E5E5E5">black list here and it's kind</font><font color="#CCCCCC"> of this is</font>

240
00:08:46,580 --> 00:08:50,300
a good example<font color="#E5E5E5"> why black lists are</font><font color="#CCCCCC"> not a</font>

241
00:08:47,870 --> 00:08:51,560
good<font color="#E5E5E5"> idea black list usually lead to you</font>

242
00:08:50,300 --> 00:08:53,329
eventually missing something that

243
00:08:51,560 --> 00:08:56,869
<font color="#E5E5E5">shouldn't have been in there</font>

244
00:08:53,330 --> 00:09:01,100
and in this case if this share is ever

245
00:08:56,870 --> 00:09:05,290
renamed deleted or renamed deleted or

246
00:09:01,100 --> 00:09:07,370
moved<font color="#CCCCCC"> it's going</font><font color="#E5E5E5"> to issue this command</font>

247
00:09:05,290 --> 00:09:10,760
<font color="#CCCCCC">the</font><font color="#E5E5E5"> only problem here is</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> the</font>

248
00:09:07,370 --> 00:09:12,470
blacklist<font color="#E5E5E5"> also removes slashes and this</font>

249
00:09:10,760 --> 00:09:15,170
is from that current directory so I want

250
00:09:12,470 --> 00:09:16,730
to<font color="#E5E5E5"> get a remote shell and I would I</font>

251
00:09:15,170 --> 00:09:19,250
didn't have the<font color="#CCCCCC"> ability because</font><font color="#E5E5E5"> I didn't</font>

252
00:09:16,730 --> 00:09:20,930
have hyphens or attacks<font color="#E5E5E5"> so that</font><font color="#CCCCCC"> was</font>

253
00:09:19,250 --> 00:09:23,060
another character<font color="#CCCCCC"> who's blacklisted</font><font color="#E5E5E5"> and</font>

254
00:09:20,930 --> 00:09:25,969
I want to use net cats -<font color="#E5E5E5"> a functionality</font>

255
00:09:23,060 --> 00:09:27,709
<font color="#E5E5E5">it's executed command so instead of</font>

256
00:09:25,970 --> 00:09:30,019
going<font color="#CCCCCC"> through</font><font color="#E5E5E5"> the headache of trying to</font>

257
00:09:27,709 --> 00:09:30,949
write<font color="#E5E5E5"> things to a file and then execute</font>

258
00:09:30,019 --> 00:09:33,079
the command which would be<font color="#E5E5E5"> another</font>

259
00:09:30,950 --> 00:09:36,200
<font color="#E5E5E5">option</font><font color="#CCCCCC"> I decided to hunt for other</font>

260
00:09:33,079 --> 00:09:41,620
command injections<font color="#E5E5E5"> and the other one is</font>

261
00:09:36,200 --> 00:09:45,200
<font color="#E5E5E5">over</font><font color="#CCCCCC"> here in the personal</font><font color="#E5E5E5"> cloud feature</font>

262
00:09:41,620 --> 00:09:47,540
so here we can<font color="#E5E5E5"> connect our Lenovo device</font>

263
00:09:45,200 --> 00:09:48,920
or NAS device to a cloud<font color="#E5E5E5"> service so that</font>

264
00:09:47,540 --> 00:09:53,500
<font color="#CCCCCC">I can synchronize between</font><font color="#E5E5E5"> your Lenovo</font>

265
00:09:48,920 --> 00:09:56,689
devices and when this is not the one

266
00:09:53,500 --> 00:09:59,149
when you add another personal<font color="#E5E5E5"> cloud</font><font color="#CCCCCC"> you</font>

267
00:09:56,690 --> 00:10:01,010
can<font color="#CCCCCC"> name it</font><font color="#E5E5E5"> whatever you want so in this</font>

268
00:09:59,149 --> 00:10:03,980
case I'm just<font color="#E5E5E5"> going to call</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> test so</font>

269
00:10:01,010 --> 00:10:05,600
that<font color="#CCCCCC"> we can see the requests</font><font color="#E5E5E5"> and I'm</font>

270
00:10:03,980 --> 00:10:06,980
gonna intercept this<font color="#E5E5E5"> request with</font>

271
00:10:05,600 --> 00:10:15,680
<font color="#E5E5E5">Burke's key so we can see what the post</font>

272
00:10:06,980 --> 00:10:17,420
request<font color="#E5E5E5"> looks like click on apply it</font>

273
00:10:15,680 --> 00:10:19,010
will<font color="#E5E5E5"> eventually issue the request and</font>

274
00:10:17,420 --> 00:10:21,290
after<font color="#CCCCCC"> the issue is the request we're</font>

275
00:10:19,010 --> 00:10:23,709
gonna see<font color="#E5E5E5"> that what their post body</font><font color="#CCCCCC"> is</font>

276
00:10:21,290 --> 00:10:32,569
<font color="#CCCCCC">gonna look like</font>

277
00:10:23,709 --> 00:10:33,979
come on buddy so while burp suite is

278
00:10:32,570 --> 00:10:35,149
figuring that out right<font color="#E5E5E5"> now I'm just</font>

279
00:10:33,980 --> 00:10:36,860
going<font color="#CCCCCC"> to go ahead and close it</font><font color="#E5E5E5"> and</font>

280
00:10:35,149 --> 00:10:40,100
reopen it because that<font color="#E5E5E5"> seems</font><font color="#CCCCCC"> to be a way</font>

281
00:10:36,860 --> 00:10:42,050
<font color="#CCCCCC">to get burp</font><font color="#E5E5E5"> suite to work and then after</font>

282
00:10:40,100 --> 00:10:44,149
so we'll see that every time this

283
00:10:42,050 --> 00:10:46,910
request is issued it's just going<font color="#E5E5E5"> to be</font>

284
00:10:44,149 --> 00:10:50,649
a normal post request with<font color="#CCCCCC"> the content</font>

285
00:10:46,910 --> 00:10:57,019
of the commands that we want<font color="#E5E5E5"> to run and</font>

286
00:10:50,649 --> 00:11:03,670
in this case we'll see that<font color="#CCCCCC"> reload this</font>

287
00:10:57,019 --> 00:11:03,670
page<font color="#CCCCCC"> turn</font><font color="#E5E5E5"> off intercept turn it back on</font>

288
00:11:04,720 --> 00:11:09,410
we'll see that what it's gonna have<font color="#E5E5E5"> the</font>

289
00:11:07,250 --> 00:11:12,170
word tests in it and in this<font color="#E5E5E5"> case the</font>

290
00:11:09,410 --> 00:11:18,350
password field is<font color="#E5E5E5"> also vulnerable to</font>

291
00:11:12,170 --> 00:11:20,530
<font color="#E5E5E5">command injection so let me try</font><font color="#CCCCCC"> to debug</font>

292
00:11:18,350 --> 00:11:23,090
this right now<font color="#E5E5E5"> with you guys</font><font color="#CCCCCC"> on the fly</font>

293
00:11:20,530 --> 00:11:25,579
<font color="#E5E5E5">we'll check out and see what burp</font><font color="#CCCCCC"> sweets</font>

294
00:11:23,090 --> 00:11:27,440
up to<font color="#E5E5E5"> so usually it should</font><font color="#CCCCCC"> be configured</font>

295
00:11:25,580 --> 00:11:31,190
<font color="#CCCCCC">so that</font><font color="#E5E5E5"> it is on local host and port</font>

296
00:11:27,440 --> 00:11:33,710
8080<font color="#CCCCCC"> which it is and then</font><font color="#E5E5E5"> after we're</font>

297
00:11:31,190 --> 00:11:36,640
<font color="#E5E5E5">going to see that this is also on local</font>

298
00:11:33,710 --> 00:11:41,660
host on port 8080<font color="#E5E5E5"> will close</font><font color="#CCCCCC"> Firefox</font>

299
00:11:36,640 --> 00:11:44,540
open<font color="#CCCCCC"> by</font><font color="#E5E5E5"> Firefox not now power locks no</font>

300
00:11:41,660 --> 00:11:46,939
updates now<font color="#E5E5E5"> but anyways</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> we'll see</font>

301
00:11:44,540 --> 00:11:48,230
that<font color="#E5E5E5"> we can issue this request and after</font>

302
00:11:46,940 --> 00:11:50,300
<font color="#E5E5E5">when</font><font color="#CCCCCC"> we see the ability that</font><font color="#E5E5E5"> we can</font>

303
00:11:48,230 --> 00:12:03,020
issue this request<font color="#E5E5E5"> we'll get into the</font>

304
00:11:50,300 --> 00:12:09,410
good<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> okay proxy I intercept</font><font color="#E5E5E5"> this</font>

305
00:12:03,020 --> 00:12:14,390
should be logging in right now it's a

306
00:12:09,410 --> 00:12:16,400
lot intercepting well the<font color="#E5E5E5"> good</font><font color="#CCCCCC"> thing</font>

307
00:12:14,390 --> 00:12:17,449
about is that<font color="#CCCCCC"> I already</font><font color="#E5E5E5"> have a backup</font>

308
00:12:16,400 --> 00:12:20,959
<font color="#CCCCCC">because I know something is gonna go</font>

309
00:12:17,450 --> 00:12:23,690
<font color="#CCCCCC">wrong</font><font color="#E5E5E5"> and here we can see the request</font>

310
00:12:20,960 --> 00:12:26,270
<font color="#E5E5E5">here we can see that</font><font color="#CCCCCC"> the cloud name is</font>

311
00:12:23,690 --> 00:12:28,540
just test as we saw before<font color="#E5E5E5"> we saw</font><font color="#CCCCCC"> the</font>

312
00:12:26,270 --> 00:12:32,689
<font color="#E5E5E5">user name is test and the password is</font>

313
00:12:28,540 --> 00:12:34,520
this<font color="#CCCCCC"> base64 encoded or URL encoded</font>

314
00:12:32,690 --> 00:12:38,420
strength so let me move that<font color="#E5E5E5"> over to</font>

315
00:12:34,520 --> 00:12:40,760
<font color="#E5E5E5">Britt's URL Dakota or just Dakota</font>

316
00:12:38,420 --> 00:12:42,770
functionality in general and we'll look

317
00:12:40,760 --> 00:12:48,410
at it a<font color="#CCCCCC"> little</font><font color="#E5E5E5"> bit better there</font><font color="#CCCCCC"> kotas</font>

318
00:12:42,770 --> 00:12:50,900
URL and we'll look<font color="#CCCCCC"> it a</font><font color="#E5E5E5"> little bit</font>

319
00:12:48,410 --> 00:12:52,189
better<font color="#E5E5E5"> now so</font><font color="#CCCCCC"> I'm guessing most</font><font color="#E5E5E5"> of you</font>

320
00:12:50,900 --> 00:12:53,600
can see it<font color="#E5E5E5"> but that's like that is the</font>

321
00:12:52,190 --> 00:12:56,780
command<font color="#CCCCCC"> injection pillow right there</font>

322
00:12:53,600 --> 00:12:59,060
it's like they're<font color="#E5E5E5"> just so all versions</font>

323
00:12:56,780 --> 00:13:01,100
of netcat or the ones<font color="#E5E5E5"> that we mostly run</font>

324
00:12:59,060 --> 00:13:03,949
into don't<font color="#E5E5E5"> have the -</font><font color="#CCCCCC"> a flag for a good</font>

325
00:13:01,100 --> 00:13:05,570
reason<font color="#E5E5E5"> it's because whenever like this</font>

326
00:13:03,950 --> 00:13:07,700
this<font color="#E5E5E5"> listener receives something it's</font>

327
00:13:05,570 --> 00:13:09,680
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> launch it with a shell</font><font color="#CCCCCC"> in this</font>

328
00:13:07,700 --> 00:13:12,020
case the shell is slash bin slash<font color="#CCCCCC"> uh</font><font color="#E5E5E5"> or</font>

329
00:13:09,680 --> 00:13:13,339
<font color="#CCCCCC">Sh</font><font color="#E5E5E5"> and it's gonna be listening on port</font>

330
00:13:12,020 --> 00:13:16,100
9000

331
00:13:13,340 --> 00:13:17,450
the problem<font color="#E5E5E5"> every version of neck</font>

332
00:13:16,100 --> 00:13:18,770
Heather you have<font color="#E5E5E5"> right</font><font color="#CCCCCC"> now if any</font><font color="#E5E5E5"> of you</font>

333
00:13:17,450 --> 00:13:19,970
run Linux doesn't<font color="#E5E5E5"> have this</font><font color="#CCCCCC"> anymore</font><font color="#E5E5E5"> and</font>

334
00:13:18,770 --> 00:13:21,590
there's a good<font color="#CCCCCC"> reason</font><font color="#E5E5E5"> why it's because</font>

335
00:13:19,970 --> 00:13:22,550
<font color="#E5E5E5">you shouldn't be able to just set up a</font>

336
00:13:21,590 --> 00:13:25,220
listener so that you can execute

337
00:13:22,550 --> 00:13:27,469
commands but if you the device that

338
00:13:25,220 --> 00:13:28,730
<font color="#E5E5E5">you're looking at has</font><font color="#CCCCCC"> busybox</font><font color="#E5E5E5"> almost</font>

339
00:13:27,470 --> 00:13:31,160
every version of busybox

340
00:13:28,730 --> 00:13:34,190
<font color="#CCCCCC">uses</font><font color="#E5E5E5"> netcat has the</font><font color="#CCCCCC"> - e flag so you're</font>

341
00:13:31,160 --> 00:13:35,390
allowed to<font color="#CCCCCC"> do</font><font color="#E5E5E5"> this I could so this is</font>

342
00:13:34,190 --> 00:13:36,920
just a<font color="#E5E5E5"> bind shell I could have easily</font>

343
00:13:35,390 --> 00:13:38,720
used<font color="#CCCCCC"> a</font><font color="#E5E5E5"> reversal if I wanted to as well</font>

344
00:13:36,920 --> 00:13:40,520
<font color="#E5E5E5">or I could have just set something else</font>

345
00:13:38,720 --> 00:13:43,460
up because it does use<font color="#E5E5E5"> sockets so I</font>

346
00:13:40,520 --> 00:13:46,400
could have just<font color="#CCCCCC"> used bash to set up a</font>

347
00:13:43,460 --> 00:13:50,900
reverse<font color="#E5E5E5"> shell with sockets but this is</font>

348
00:13:46,400 --> 00:13:53,810
enough for<font color="#CCCCCC"> me for it to work now</font><font color="#E5E5E5"> close</font>

349
00:13:50,900 --> 00:13:59,270
this and our device is one or<font color="#E5E5E5"> two months</font>

350
00:13:53,810 --> 00:14:03,140
exceeded 2.6 so if we issue a<font color="#CCCCCC"> request</font>

351
00:13:59,270 --> 00:14:04,790
<font color="#E5E5E5">with the right with the right values it</font>

352
00:14:03,140 --> 00:14:06,670
should<font color="#CCCCCC"> work</font><font color="#E5E5E5"> so one of the things is that</font>

353
00:14:04,790 --> 00:14:09,079
we're going<font color="#E5E5E5"> to need one of these values</font>

354
00:14:06,670 --> 00:14:11,000
<font color="#E5E5E5">because</font><font color="#CCCCCC"> it's going to</font><font color="#E5E5E5"> be updated</font><font color="#CCCCCC"> every</font>

355
00:14:09,080 --> 00:14:14,990
time we log in and<font color="#E5E5E5"> we also need</font><font color="#CCCCCC"> the</font>

356
00:14:11,000 --> 00:14:17,720
<font color="#CCCCCC">Iomega cookie which is here</font><font color="#E5E5E5"> so there's</font>

357
00:14:14,990 --> 00:14:22,240
two details about<font color="#E5E5E5"> this that I've already</font>

358
00:14:17,720 --> 00:14:25,700
given<font color="#CCCCCC"> away and that's</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> we need for</font>

359
00:14:22,240 --> 00:14:27,880
we<font color="#E5E5E5"> need the C value and the</font><font color="#CCCCCC"> Iomega</font>

360
00:14:25,700 --> 00:14:30,980
cookie if not the new<font color="#CCCCCC"> request one work</font>

361
00:14:27,880 --> 00:14:34,460
so now if we<font color="#E5E5E5"> connect to</font><font color="#CCCCCC"> the device over</font>

362
00:14:30,980 --> 00:14:41,360
<font color="#E5E5E5">netcat we type in ID we have a root</font>

363
00:14:34,460 --> 00:14:42,440
shell<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is usually</font><font color="#E5E5E5"> where you clap but</font>

364
00:14:41,360 --> 00:14:44,089
we're not done because<font color="#E5E5E5"> there's an</font>

365
00:14:42,440 --> 00:14:46,880
important part here<font color="#E5E5E5"> and that's this is</font>

366
00:14:44,089 --> 00:14:48,680
authenticated<font color="#E5E5E5"> I was only able</font><font color="#CCCCCC"> to execute</font>

367
00:14:46,880 --> 00:14:50,720
<font color="#E5E5E5">this command because</font><font color="#CCCCCC"> I knew the value</font><font color="#E5E5E5"> of</font>

368
00:14:48,680 --> 00:14:53,599
C and<font color="#E5E5E5"> I knew the value of a matter</font><font color="#CCCCCC"> of I</font>

369
00:14:50,720 --> 00:14:55,130
Omega<font color="#E5E5E5"> so usually you'd be able to say</font>

370
00:14:53,600 --> 00:14:57,290
like<font color="#E5E5E5"> oh it's an authenticated request</font>

371
00:14:55,130 --> 00:14:59,089
they're using cookies that means we can

372
00:14:57,290 --> 00:14:59,839
use cross-site request forgery<font color="#E5E5E5"> but</font>

373
00:14:59,089 --> 00:15:03,260
<font color="#E5E5E5">there's a problem</font>

374
00:14:59,839 --> 00:15:05,930
the C token in the URL<font color="#E5E5E5"> acts as a CSRF</font>

375
00:15:03,260 --> 00:15:07,970
<font color="#E5E5E5">like a CSRF mitigation because you have</font>

376
00:15:05,930 --> 00:15:10,099
no way of<font color="#CCCCCC"> knowing it</font><font color="#E5E5E5"> unless you have a</font>

377
00:15:07,970 --> 00:15:11,990
way<font color="#CCCCCC"> of pulling it out of</font><font color="#E5E5E5"> the browser so</font>

378
00:15:10,100 --> 00:15:14,150
next up<font color="#E5E5E5"> we</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> figure out how we're</font>

379
00:15:11,990 --> 00:15:16,730
gonna get that C<font color="#CCCCCC"> value out of the</font><font color="#E5E5E5"> users</font>

380
00:15:14,150 --> 00:15:19,670
<font color="#E5E5E5">browser and into a request that we can</font>

381
00:15:16,730 --> 00:15:21,290
issue usually<font color="#CCCCCC"> when</font><font color="#E5E5E5"> we want to interact</font>

382
00:15:19,670 --> 00:15:24,199
<font color="#CCCCCC">with the browser there's one thing</font><font color="#E5E5E5"> we</font>

383
00:15:21,290 --> 00:15:26,120
think about<font color="#E5E5E5"> and that's JavaScript and it</font>

384
00:15:24,200 --> 00:15:27,080
is the evil that we usually<font color="#E5E5E5"> end up</font>

385
00:15:26,120 --> 00:15:30,110
dealing<font color="#E5E5E5"> with</font>

386
00:15:27,080 --> 00:15:33,320
so let's go ahead<font color="#E5E5E5"> and look at what's in</font>

387
00:15:30,110 --> 00:15:34,790
our<font color="#CCCCCC"> browsers storage the cookie were</font>

388
00:15:33,320 --> 00:15:37,670
looking at right now<font color="#E5E5E5"> let's look at the</font>

389
00:15:34,790 --> 00:15:38,990
<font color="#E5E5E5">value again it's a way to say</font><font color="#CCCCCC"> two</font><font color="#E5E5E5"> six</font>

390
00:15:37,670 --> 00:15:41,449
<font color="#E5E5E5">nine nine because I don't remember that</font>

391
00:15:38,990 --> 00:15:43,550
many numbers so we'll<font color="#E5E5E5"> look at</font><font color="#CCCCCC"> two six</font>

392
00:15:41,450 --> 00:15:49,070
<font color="#CCCCCC">nine nine</font><font color="#E5E5E5"> in the storage and see where</font>

393
00:15:43,550 --> 00:15:52,010
it<font color="#E5E5E5"> is and it's</font><font color="#CCCCCC"> not in the cookies it's</font>

394
00:15:49,070 --> 00:15:54,110
not in the index browser but it is in

395
00:15:52,010 --> 00:15:56,209
<font color="#E5E5E5">local storage so that means that if we</font>

396
00:15:54,110 --> 00:15:58,910
<font color="#CCCCCC">can somehow use</font><font color="#E5E5E5"> JavaScript</font><font color="#CCCCCC"> to pull out</font>

397
00:15:56,209 --> 00:16:00,890
that<font color="#CCCCCC"> Iomega user cookie value which is</font>

398
00:15:58,910 --> 00:16:02,000
also<font color="#E5E5E5"> the C value that we saw before</font><font color="#CCCCCC"> then</font>

399
00:16:00,890 --> 00:16:05,000
we'll be<font color="#E5E5E5"> able to</font><font color="#CCCCCC"> issue this request</font>

400
00:16:02,000 --> 00:16:09,320
<font color="#E5E5E5">unauthenticated so let's look for</font>

401
00:16:05,000 --> 00:16:10,940
<font color="#E5E5E5">cross-site scripting and this one is</font>

402
00:16:09,320 --> 00:16:14,329
going to be way better<font color="#CCCCCC"> because I don't</font>

403
00:16:10,940 --> 00:16:15,829
<font color="#E5E5E5">need to rely on burp suite so one of the</font>

404
00:16:14,329 --> 00:16:19,670
interesting<font color="#CCCCCC"> features of this application</font>

405
00:16:15,829 --> 00:16:23,390
<font color="#E5E5E5">is that this token right here ends up in</font>

406
00:16:19,670 --> 00:16:27,050
the page so let's instead<font color="#E5E5E5"> of calling a</font>

407
00:16:23,390 --> 00:16:31,910
<font color="#E5E5E5">cat we'll call it Eric you're welcome</font>

408
00:16:27,050 --> 00:16:36,290
Eric and<font color="#CCCCCC"> we'll look for it here in the</font>

409
00:16:31,910 --> 00:16:39,980
HTML<font color="#CCCCCC"> I</font><font color="#E5E5E5"> typed in</font><font color="#CCCCCC"> rec Eric and we'll zoom</font>

410
00:16:36,290 --> 00:16:41,839
<font color="#CCCCCC">in real quick so that</font><font color="#E5E5E5"> you can see it the</font>

411
00:16:39,980 --> 00:16:43,850
value from the<font color="#E5E5E5"> CIT parameter ends up</font>

412
00:16:41,839 --> 00:16:47,720
here and it's also funny because<font color="#E5E5E5"> it's in</font>

413
00:16:43,850 --> 00:16:48,890
the security dot HTML page so what we're

414
00:16:47,720 --> 00:16:51,290
<font color="#CCCCCC">going to do is</font><font color="#E5E5E5"> that we're going</font><font color="#CCCCCC"> to exit</font>

415
00:16:48,890 --> 00:16:51,880
out<font color="#CCCCCC"> the zoom</font><font color="#E5E5E5"> and we're going</font><font color="#CCCCCC"> to try</font>

416
00:16:51,290 --> 00:17:01,040
something else

417
00:16:51,880 --> 00:17:03,020
so we'll call script alert<font color="#E5E5E5"> one script</font>

418
00:17:01,040 --> 00:17:04,490
and I'll let you know<font color="#CCCCCC"> right</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> that</font>

419
00:17:03,020 --> 00:17:07,910
this<font color="#CCCCCC"> is not going</font><font color="#E5E5E5"> to work</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> willing to</font>

420
00:17:04,490 --> 00:17:11,359
look at<font color="#E5E5E5"> it</font><font color="#CCCCCC"> why and if we look at the</font>

421
00:17:07,910 --> 00:17:13,550
source it's good we're gonna look for

422
00:17:11,359 --> 00:17:15,678
<font color="#CCCCCC">this the alert one it's</font><font color="#E5E5E5"> probably easiest</font>

423
00:17:13,550 --> 00:17:17,899
one to find<font color="#E5E5E5"> and it's because we haven't</font>

424
00:17:15,679 --> 00:17:19,429
exited out of<font color="#E5E5E5"> that a tag we're still</font>

425
00:17:17,900 --> 00:17:23,179
inside<font color="#E5E5E5"> the</font><font color="#CCCCCC"> href</font>

426
00:17:19,429 --> 00:17:28,720
that's attribute so if we close it off

427
00:17:23,179 --> 00:17:28,720
<font color="#E5E5E5">and instead</font><font color="#CCCCCC"> of alert one</font><font color="#E5E5E5"> will do hi Eric</font>

428
00:17:30,520 --> 00:17:35,240
<font color="#E5E5E5">we'll see higher so now we have we have</font>

429
00:17:34,130 --> 00:17:38,720
cross-site scripting and this one's

430
00:17:35,240 --> 00:17:40,559
<font color="#CCCCCC">pretty easy</font><font color="#E5E5E5"> so we need to figure out how</font>

431
00:17:38,720 --> 00:17:42,450
we can<font color="#E5E5E5"> use cross-site scripting</font>

432
00:17:40,559 --> 00:17:46,279
<font color="#CCCCCC">to execute this command and</font><font color="#E5E5E5"> pull it out</font>

433
00:17:42,450 --> 00:17:49,289
<font color="#E5E5E5">so for that I prepared a small</font>

434
00:17:46,279 --> 00:17:52,679
<font color="#E5E5E5">JavaScript thing it's called besides</font>

435
00:17:49,289 --> 00:17:55,980
Tampa<font color="#CCCCCC"> or just temp I think I'll</font><font color="#E5E5E5"> zoom in</font>

436
00:17:52,679 --> 00:17:57,450
<font color="#E5E5E5">so</font><font color="#CCCCCC"> that everyone can</font><font color="#E5E5E5"> see it and this is</font>

437
00:17:55,980 --> 00:17:59,519
all the JavaScript you need to own<font color="#E5E5E5"> a</font>

438
00:17:57,450 --> 00:18:01,889
<font color="#CCCCCC">neat Lenovo device that</font><font color="#E5E5E5"> runs like this</font>

439
00:17:59,519 --> 00:18:05,190
or<font color="#E5E5E5"> it like any Lenovo device that's</font><font color="#CCCCCC"> ix4</font>

440
00:18:01,889 --> 00:18:06,840
that has<font color="#CCCCCC"> now been recently updated</font><font color="#E5E5E5"> so at</font>

441
00:18:05,190 --> 00:18:09,090
the top<font color="#CCCCCC"> you see that we you we</font><font color="#E5E5E5"> just</font>

442
00:18:06,840 --> 00:18:11,459
create an HR we set<font color="#CCCCCC"> everything to Const</font>

443
00:18:09,090 --> 00:18:14,549
because we're not<font color="#E5E5E5"> demons</font><font color="#CCCCCC"> and we just</font>

444
00:18:11,460 --> 00:18:16,950
used<font color="#E5E5E5"> the local storage to get the item</font><font color="#CCCCCC"> I</font>

445
00:18:14,549 --> 00:18:18,570
<font color="#CCCCCC">Omega user cookie</font><font color="#E5E5E5"> the URL for</font><font color="#CCCCCC"> the device</font>

446
00:18:16,950 --> 00:18:22,850
<font color="#E5E5E5">that we want to look at which in this</font>

447
00:18:18,570 --> 00:18:22,850
case it's not<font color="#E5E5E5"> this URL</font><font color="#CCCCCC"> it's going to be</font>

448
00:18:24,289 --> 00:18:37,408
one I to that one six eight dot<font color="#E5E5E5"> to that</font>

449
00:18:30,110 --> 00:18:42,539
<font color="#CCCCCC">42.6 and then after this should just</font>

450
00:18:37,409 --> 00:18:50,639
work and if we're all lucky I did good

451
00:18:42,539 --> 00:18:51,629
catch there mate and let's<font color="#E5E5E5"> just cut it</font>

452
00:18:50,639 --> 00:18:52,830
<font color="#E5E5E5">to make</font><font color="#CCCCCC"> sure that it's all</font><font color="#E5E5E5"> the same</font>

453
00:18:51,629 --> 00:18:55,289
since everything seems to<font color="#E5E5E5"> be going wrong</font>

454
00:18:52,830 --> 00:18:57,840
today anyways<font color="#E5E5E5"> and we'll see</font><font color="#CCCCCC"> that it's</font>

455
00:18:55,289 --> 00:19:05,389
the same<font color="#E5E5E5"> so well this</font><font color="#CCCCCC"> host</font><font color="#E5E5E5"> would Python</font>

456
00:18:57,840 --> 00:19:11,039
simple HTTP server<font color="#CCCCCC"> i should be 2.1 - m</font>

457
00:19:05,389 --> 00:19:13,799
simple HTTP server so it's listening<font color="#E5E5E5"> on</font>

458
00:19:11,039 --> 00:19:15,360
port 8000 now for<font color="#E5E5E5"> let's see if it works</font>

459
00:19:13,799 --> 00:19:21,320
<font color="#CCCCCC">so we know that this is the name of the</font>

460
00:19:15,360 --> 00:19:28,080
file<font color="#E5E5E5"> let's go ahead and set the script</font>

461
00:19:21,320 --> 00:19:30,928
source to be equal<font color="#CCCCCC"> to HTTP colon slash</font>

462
00:19:28,080 --> 00:19:34,699
slash<font color="#CCCCCC"> one</font><font color="#E5E5E5"> I to that one six eight</font><font color="#CCCCCC"> to</font>

463
00:19:30,929 --> 00:19:37,230
that one and<font color="#E5E5E5"> then</font><font color="#CCCCCC"> after we closed our</font>

464
00:19:34,700 --> 00:19:42,509
slash the<font color="#E5E5E5"> name of the thing</font><font color="#CCCCCC"> that we're</font>

465
00:19:37,230 --> 00:19:47,389
looking<font color="#CCCCCC"> for and this</font><font color="#E5E5E5"> should go ahead and</font>

466
00:19:42,509 --> 00:19:47,389
fetch our script<font color="#E5E5E5"> which it hasn't so far</font>

467
00:19:47,440 --> 00:19:58,039
<font color="#CCCCCC">40,000 thanks for the help setup</font><font color="#E5E5E5"> on port</font>

468
00:19:52,099 --> 00:20:00,049
8000 so hey<font color="#E5E5E5"> God are they did it for for</font>

469
00:19:58,039 --> 00:20:05,059
for the first one so let's see why

470
00:20:00,049 --> 00:20:07,879
<font color="#E5E5E5">Lenovo exercise Tampa</font><font color="#CCCCCC"> Jas let's see why</font>

471
00:20:05,059 --> 00:20:12,639
Luna works assistant<font color="#E5E5E5"> Oh Jas</font><font color="#CCCCCC"> I don't</font>

472
00:20:07,879 --> 00:20:12,639
<font color="#E5E5E5">think I need</font><font color="#CCCCCC"> to see if</font><font color="#E5E5E5"> that'll work out</font>

473
00:20:12,789 --> 00:20:23,769
but I think that the<font color="#CCCCCC"> it's I have</font><font color="#E5E5E5"> an</font>

474
00:20:18,499 --> 00:20:32,749
ending quotation marks here<font color="#CCCCCC"> so if I do</font>

475
00:20:23,769 --> 00:20:37,219
script let's see<font color="#CCCCCC"> what debugging live</font>

476
00:20:32,749 --> 00:20:40,549
again so see it's okay<font color="#CCCCCC"> so that time I</font>

477
00:20:37,219 --> 00:20:42,349
<font color="#CCCCCC">got</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> two hundred</font><font color="#E5E5E5"> so if we open up</font>

478
00:20:40,549 --> 00:20:46,749
another team<font color="#CCCCCC"> explain and we</font><font color="#E5E5E5"> connected</font>

479
00:20:42,349 --> 00:20:52,519
over netcat<font color="#E5E5E5"> we should have a shell and</font>

480
00:20:46,749 --> 00:20:53,479
let's see why<font color="#CCCCCC"> that didn't work</font><font color="#E5E5E5"> mm no</font>

481
00:20:52,519 --> 00:20:55,729
there should be<font color="#CCCCCC"> nine</font><font color="#E5E5E5"> thousand because</font>

482
00:20:53,479 --> 00:20:58,700
<font color="#E5E5E5">this is the</font><font color="#CCCCCC"> setup</font><font color="#E5E5E5"> the netcat listener we</font>

483
00:20:55,729 --> 00:21:01,700
set up before<font color="#E5E5E5"> so let's look at the</font>

484
00:20:58,700 --> 00:21:03,409
script again<font color="#CCCCCC"> Lenovo X or if we</font><font color="#E5E5E5"> look at</font>

485
00:21:01,700 --> 00:21:06,789
<font color="#CCCCCC">verb Suites history it'll say it in</font>

486
00:21:03,409 --> 00:21:11,089
there so we send<font color="#E5E5E5"> the post request here</font>

487
00:21:06,789 --> 00:21:18,080
and<font color="#E5E5E5"> here's the</font><font color="#CCCCCC"> body</font><font color="#E5E5E5"> and what was a</font>

488
00:21:11,089 --> 00:21:22,190
response and it<font color="#CCCCCC"> so</font><font color="#E5E5E5"> it's saying that I</font>

489
00:21:18,080 --> 00:21:24,949
couldn't<font color="#E5E5E5"> find the</font><font color="#CCCCCC"> the personal</font><font color="#E5E5E5"> cloud</font>

490
00:21:22,190 --> 00:21:28,330
instance<font color="#E5E5E5"> because it may have lost</font>

491
00:21:24,950 --> 00:21:32,080
<font color="#CCCCCC">Internet connectivity which would suck</font>

492
00:21:28,330 --> 00:21:35,509
<font color="#E5E5E5">so let's see if that</font><font color="#CCCCCC"> is the reason</font><font color="#E5E5E5"> why</font>

493
00:21:32,080 --> 00:21:37,129
okay and let's see if<font color="#CCCCCC"> the device</font><font color="#E5E5E5"> allows</font>

494
00:21:35,509 --> 00:21:39,229
the same<font color="#E5E5E5"> IP address which it should</font>

495
00:21:37,129 --> 00:21:43,699
because if we were<font color="#CCCCCC"> able to interact with</font>

496
00:21:39,229 --> 00:21:47,509
<font color="#E5E5E5">it it should</font><font color="#CCCCCC"> okay so that's not</font><font color="#E5E5E5"> the</font>

497
00:21:43,700 --> 00:21:50,080
reason<font color="#CCCCCC"> why let's see what bursts</font><font color="#E5E5E5"> you</font>

498
00:21:47,509 --> 00:21:50,080
<font color="#E5E5E5">said this time</font>

499
00:21:50,809 --> 00:21:55,639
the most recent<font color="#CCCCCC"> request</font><font color="#E5E5E5"> it so it was</font>

500
00:21:53,990 --> 00:21:58,760
<font color="#CCCCCC">able just</font><font color="#E5E5E5"> so that we're falling together</font>

501
00:21:55,640 --> 00:22:03,530
<font color="#CCCCCC">it was</font><font color="#E5E5E5"> able to get the script they ran</font>

502
00:21:58,760 --> 00:22:06,890
<font color="#E5E5E5">the script</font><font color="#CCCCCC"> it did go to the 191 6 a 2.6</font>

503
00:22:03,530 --> 00:22:09,710
and it did<font color="#E5E5E5"> issue the</font><font color="#CCCCCC"> requests and that</font>

504
00:22:06,890 --> 00:22:11,890
<font color="#CCCCCC">we'll see here so</font><font color="#E5E5E5"> oh it's</font><font color="#CCCCCC"> a saying</font><font color="#E5E5E5"> a</font>

505
00:22:09,710 --> 00:22:14,870
page is not found so the reason why is

506
00:22:11,890 --> 00:22:18,669
because I<font color="#E5E5E5"> put the IP address in the</font>

507
00:22:14,870 --> 00:22:18,668
wrong spot<font color="#CCCCCC"> so let's so good that script</font>

508
00:22:18,820 --> 00:22:25,970
live demos so we'll go<font color="#E5E5E5"> ahead and edit</font>

509
00:22:24,409 --> 00:22:37,549
that script to make<font color="#E5E5E5"> sure we don't have</font>

510
00:22:25,970 --> 00:22:40,780
<font color="#E5E5E5">that mistake in there anymore and for</font>

511
00:22:37,549 --> 00:22:42,830
<font color="#E5E5E5">this part I think</font><font color="#CCCCCC"> we can remove this guy</font>

512
00:22:40,780 --> 00:22:44,870
let's see<font color="#E5E5E5"> what we'll get this time</font>

513
00:22:42,830 --> 00:22:56,809
so we'll set up the Python simple HTTP

514
00:22:44,870 --> 00:23:00,799
server again no<font color="#E5E5E5"> I'm wait for</font><font color="#CCCCCC"> we'll wait</font>

515
00:22:56,809 --> 00:23:02,990
<font color="#E5E5E5">for it to refresh when it refreshes</font><font color="#CCCCCC"> I</font>

516
00:23:00,799 --> 00:23:06,730
should get the file<font color="#CCCCCC"> I got the file let's</font>

517
00:23:02,990 --> 00:23:10,340
look at what a<font color="#E5E5E5"> sudden burp suite and</font>

518
00:23:06,730 --> 00:23:15,470
this one might have<font color="#CCCCCC"> actually worked</font><font color="#E5E5E5"> so</font>

519
00:23:10,340 --> 00:23:18,158
let's go ahead<font color="#E5E5E5"> and look that</font><font color="#CCCCCC"> up Jesus so</font>

520
00:23:15,470 --> 00:23:21,830
that<font color="#CCCCCC"> we do we do</font><font color="#E5E5E5"> have a shell um</font><font color="#CCCCCC"> and</font>

521
00:23:18,159 --> 00:23:25,700
<font color="#CCCCCC">there</font><font color="#E5E5E5"> so we now anybody who we can get a</font>

522
00:23:21,830 --> 00:23:27,260
trick<font color="#E5E5E5"> into visiting this</font><font color="#CCCCCC"> causes this or</font>

523
00:23:25,700 --> 00:23:28,610
a page<font color="#E5E5E5"> we're cross-site scripting or if</font>

524
00:23:27,260 --> 00:23:30,440
we<font color="#CCCCCC"> just tricked him into getting</font><font color="#E5E5E5"> a URL</font>

525
00:23:28,610 --> 00:23:32,809
and<font color="#E5E5E5"> clicking on it and it would</font><font color="#CCCCCC"> work</font>

526
00:23:30,440 --> 00:23:34,340
<font color="#CCCCCC">there's a catch here this coastal</font>

527
00:23:32,809 --> 00:23:36,649
scripting cross-site scripting

528
00:23:34,340 --> 00:23:38,418
vulnerability specifically<font color="#E5E5E5"> only</font><font color="#CCCCCC"> works in</font>

529
00:23:36,650 --> 00:23:40,280
some browsers<font color="#E5E5E5"> for example it does not</font>

530
00:23:38,419 --> 00:23:41,929
<font color="#E5E5E5">work in Chrome because Chrome has an XSS</font>

531
00:23:40,280 --> 00:23:43,158
filter and it does stop<font color="#E5E5E5"> this it does</font>

532
00:23:41,929 --> 00:23:45,890
work in the most recent<font color="#CCCCCC"> version of</font>

533
00:23:43,159 --> 00:23:50,120
<font color="#E5E5E5">Firefox so it does stand since a lot of</font>

534
00:23:45,890 --> 00:23:52,640
<font color="#CCCCCC">people do use</font><font color="#E5E5E5"> Firefox</font><font color="#CCCCCC"> and on top of</font><font color="#E5E5E5"> that</font>

535
00:23:50,120 --> 00:23:53,719
it<font color="#CCCCCC"> also stands because</font><font color="#E5E5E5"> it is pretty</font>

536
00:23:52,640 --> 00:23:54,860
often<font color="#E5E5E5"> that people log in</font><font color="#CCCCCC"> to their</font>

537
00:23:53,720 --> 00:23:56,330
<font color="#CCCCCC">announcer voice because they want</font><font color="#E5E5E5"> to</font>

538
00:23:54,860 --> 00:23:58,479
interact with it because<font color="#E5E5E5"> it has all</font>

539
00:23:56,330 --> 00:24:00,980
these all this crazy functionality

540
00:23:58,480 --> 00:24:03,649
now with root there's a lot of

541
00:24:00,980 --> 00:24:03,960
<font color="#E5E5E5">interesting</font><font color="#CCCCCC"> things that</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> do so as</font>

542
00:24:03,649 --> 00:24:05,310
you

543
00:24:03,960 --> 00:24:09,000
see you have full control<font color="#CCCCCC"> over</font><font color="#E5E5E5"> the</font>

544
00:24:05,310 --> 00:24:10,950
<font color="#CCCCCC">device and now you can use the device to</font>

545
00:24:09,000 --> 00:24:14,880
pivot<font color="#E5E5E5"> and to access</font><font color="#CCCCCC"> other devices on the</font>

546
00:24:10,950 --> 00:24:17,490
on the targets<font color="#CCCCCC"> Network</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> also see</font>

547
00:24:14,880 --> 00:24:19,590
how<font color="#E5E5E5"> the device</font><font color="#CCCCCC"> felt like what's stored</font>

548
00:24:17,490 --> 00:24:21,180
<font color="#E5E5E5">on the device and for example steal it</font>

549
00:24:19,590 --> 00:24:27,360
or store other informational you want to

550
00:24:21,180 --> 00:24:29,490
on there as well<font color="#E5E5E5"> sweet so that's the we</font>

551
00:24:27,360 --> 00:24:32,969
did we were<font color="#E5E5E5"> able to combine</font><font color="#CCCCCC"> both of</font>

552
00:24:29,490 --> 00:24:34,740
those to get a shell which<font color="#CCCCCC"> is exactly</font>

553
00:24:32,970 --> 00:24:37,110
what we wanted and<font color="#E5E5E5"> it was less painful</font>

554
00:24:34,740 --> 00:24:39,060
now I thought<font color="#E5E5E5"> it was gonna</font><font color="#CCCCCC"> be so the top</font>

555
00:24:37,110 --> 00:24:41,310
<font color="#E5E5E5">one we got command injection and the</font>

556
00:24:39,060 --> 00:24:42,629
cross the scripting ended up working we

557
00:24:41,310 --> 00:24:44,700
were<font color="#CCCCCC"> able to figure</font><font color="#E5E5E5"> out how we can get</font>

558
00:24:42,630 --> 00:24:46,080
those post parameters<font color="#E5E5E5"> because we saw</font>

559
00:24:44,700 --> 00:24:47,820
<font color="#CCCCCC">that</font><font color="#E5E5E5"> there were only two tokens</font><font color="#CCCCCC"> that we</font>

560
00:24:46,080 --> 00:24:49,830
needed<font color="#E5E5E5"> the one that was already sent</font>

561
00:24:47,820 --> 00:24:51,600
through like normal cookies<font color="#E5E5E5"> because</font>

562
00:24:49,830 --> 00:24:53,370
that's a cookies work and then the one

563
00:24:51,600 --> 00:24:54,270
<font color="#E5E5E5">that was</font><font color="#CCCCCC"> in the URL parameter that we</font>

564
00:24:53,370 --> 00:24:56,399
were<font color="#CCCCCC"> able to get with cross-site</font>

565
00:24:54,270 --> 00:24:58,379
scripting<font color="#E5E5E5"> and after that we</font><font color="#CCCCCC"> like combine</font>

566
00:24:56,400 --> 00:25:02,490
it all together exploited a simple

567
00:24:58,380 --> 00:25:11,610
command<font color="#E5E5E5"> injection and we got a show so</font>

568
00:25:02,490 --> 00:25:13,020
here's some<font color="#E5E5E5"> of them</font><font color="#CCCCCC"> Thanks sweet</font><font color="#E5E5E5"> so the</font>

569
00:25:11,610 --> 00:25:15,179
things<font color="#E5E5E5"> that I do want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk about are</font>

570
00:25:13,020 --> 00:25:17,340
these<font color="#E5E5E5"> so a lot of</font><font color="#CCCCCC"> the times I guess</font>

571
00:25:15,180 --> 00:25:18,780
people<font color="#CCCCCC"> just mention that oh well it's an</font>

572
00:25:17,340 --> 00:25:21,360
IOT device well I can't really I just

573
00:25:18,780 --> 00:25:23,010
<font color="#E5E5E5">won't buy one and for example</font><font color="#CCCCCC"> this is an</font>

574
00:25:21,360 --> 00:25:24,600
as it's not necessarily an IOT device

575
00:25:23,010 --> 00:25:27,180
it's<font color="#E5E5E5"> not a camera or light bulb or</font>

576
00:25:24,600 --> 00:25:28,980
whatever it's not<font color="#E5E5E5"> a fridge but it is</font>

577
00:25:27,180 --> 00:25:30,600
something that you<font color="#E5E5E5"> own so the same thing</font>

578
00:25:28,980 --> 00:25:31,980
applies for routers the same thing

579
00:25:30,600 --> 00:25:33,750
applies for<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> else that's a</font>

580
00:25:31,980 --> 00:25:36,540
prepackaged with some Linux operating

581
00:25:33,750 --> 00:25:38,610
system<font color="#E5E5E5"> or some artists that you own and</font>

582
00:25:36,540 --> 00:25:39,690
set up in your<font color="#E5E5E5"> house or your</font><font color="#CCCCCC"> business or</font>

583
00:25:38,610 --> 00:25:41,820
wherever<font color="#E5E5E5"> else so you want</font><font color="#CCCCCC"> it to be</font>

584
00:25:39,690 --> 00:25:43,530
<font color="#E5E5E5">there's also the problem</font><font color="#CCCCCC"> that you</font><font color="#E5E5E5"> don't</font>

585
00:25:41,820 --> 00:25:45,540
really get<font color="#E5E5E5"> to</font><font color="#CCCCCC"> choose which</font><font color="#E5E5E5"> one of these</font>

586
00:25:43,530 --> 00:25:47,040
<font color="#E5E5E5">devices</font><font color="#CCCCCC"> you interact with sometimes if</font>

587
00:25:45,540 --> 00:25:48,149
you work at a company<font color="#CCCCCC"> and they have</font>

588
00:25:47,040 --> 00:25:49,470
these<font color="#E5E5E5"> things you're not just gonna say</font>

589
00:25:48,150 --> 00:25:50,700
well you can't<font color="#E5E5E5"> have that</font><font color="#CCCCCC"> nas device</font>

590
00:25:49,470 --> 00:25:53,640
because I heard<font color="#E5E5E5"> it</font><font color="#CCCCCC"> has grown abilities</font>

591
00:25:50,700 --> 00:25:54,780
<font color="#E5E5E5">you</font><font color="#CCCCCC"> boys should be able</font><font color="#E5E5E5"> to say that but</font>

592
00:25:53,640 --> 00:25:55,980
at<font color="#E5E5E5"> the same time it's not like you</font><font color="#CCCCCC"> feel</font>

593
00:25:54,780 --> 00:25:58,710
like<font color="#CCCCCC"> you</font><font color="#E5E5E5"> know you're not going to find</font>

594
00:25:55,980 --> 00:26:01,530
all vulnerabilities in all devices<font color="#E5E5E5"> and a</font>

595
00:25:58,710 --> 00:26:03,600
<font color="#E5E5E5">reality that we</font><font color="#CCCCCC"> all need to accept</font><font color="#E5E5E5"> so</font>

596
00:26:01,530 --> 00:26:05,160
one and then there is a similar thing

597
00:26:03,600 --> 00:26:08,219
that if<font color="#E5E5E5"> you visit a hotel for example</font>

598
00:26:05,160 --> 00:26:10,940
<font color="#CCCCCC">and if they have a IOT showerhead</font><font color="#E5E5E5"> your</font>

599
00:26:08,220 --> 00:26:15,730
choices are<font color="#E5E5E5"> to either leave or just stay</font>

600
00:26:10,940 --> 00:26:17,169
<font color="#E5E5E5">yeah like you don't get to choose on</font>

601
00:26:15,730 --> 00:26:18,940
here are some<font color="#E5E5E5"> of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> things</font><font color="#CCCCCC"> that I</font>

602
00:26:17,169 --> 00:26:20,860
recommend<font color="#CCCCCC"> for</font><font color="#E5E5E5"> if you're a manufacturer</font>

603
00:26:18,940 --> 00:26:21,970
or<font color="#E5E5E5"> a consumer if you're a manufacturer</font>

604
00:26:20,860 --> 00:26:24,189
<font color="#CCCCCC">you</font><font color="#E5E5E5"> probably should</font><font color="#CCCCCC"> just get yourself on</font>

605
00:26:21,970 --> 00:26:25,600
<font color="#CCCCCC">it</font><font color="#E5E5E5"> if you don't want to hire a separate</font>

606
00:26:24,190 --> 00:26:27,220
consultancy<font color="#E5E5E5"> then just do it</font><font color="#CCCCCC"> yourself I</font>

607
00:26:25,600 --> 00:26:30,399
don't<font color="#CCCCCC"> really care but have somebody look</font>

608
00:26:27,220 --> 00:26:33,039
at<font color="#E5E5E5"> it and then after the having security</font>

609
00:26:30,399 --> 00:26:36,489
<font color="#E5E5E5">built into your</font><font color="#CCCCCC"> SDLC is very important</font>

610
00:26:33,039 --> 00:26:39,429
<font color="#E5E5E5">well because</font><font color="#CCCCCC"> if it's way harder to fix</font>

611
00:26:36,490 --> 00:26:40,510
vulnerabilities<font color="#E5E5E5"> after it's done then it</font>

612
00:26:39,429 --> 00:26:42,250
is to just like<font color="#CCCCCC"> say like all right cool</font>

613
00:26:40,510 --> 00:26:44,289
<font color="#CCCCCC">let's</font><font color="#E5E5E5"> talk about like how to not put</font>

614
00:26:42,250 --> 00:26:46,029
vulnerabilities into our code<font color="#E5E5E5"> obviously</font>

615
00:26:44,289 --> 00:26:48,010
some are<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> slip by</font><font color="#CCCCCC"> so you do need an</font>

616
00:26:46,029 --> 00:26:49,720
<font color="#E5E5E5">assessment at the end</font><font color="#CCCCCC"> shebar I do that</font>

617
00:26:48,010 --> 00:26:51,669
but it's<font color="#E5E5E5"> probably gonna be less and it's</font>

618
00:26:49,720 --> 00:26:52,990
<font color="#CCCCCC">gonna</font><font color="#E5E5E5"> be less of a headache</font><font color="#CCCCCC"> - and when</font>

619
00:26:51,669 --> 00:26:57,130
it involves we<font color="#CCCCCC"> architect in your whole</font>

620
00:26:52,990 --> 00:26:58,570
authentication system<font color="#E5E5E5"> long term you</font>

621
00:26:57,130 --> 00:27:00,490
polish you to send your devs

622
00:26:58,570 --> 00:27:01,928
to a security<font color="#CCCCCC"> training issue</font><font color="#E5E5E5"> I send your</font>

623
00:27:00,490 --> 00:27:04,720
<font color="#E5E5E5">security people to a security training</font><font color="#CCCCCC"> -</font>

624
00:27:01,929 --> 00:27:05,649
and talk to<font color="#CCCCCC"> professionals</font><font color="#E5E5E5"> there's a</font>

625
00:27:04,720 --> 00:27:08,200
bunch of<font color="#E5E5E5"> people out there like I</font>

626
00:27:05,649 --> 00:27:09,610
personally<font color="#CCCCCC"> ask other people when I don't</font>

627
00:27:08,200 --> 00:27:11,440
know<font color="#CCCCCC"> I may be a team</font><font color="#E5E5E5"> leader</font><font color="#CCCCCC"> at my</font>

628
00:27:09,610 --> 00:27:13,830
company<font color="#E5E5E5"> but I also ask other people and</font>

629
00:27:11,440 --> 00:27:16,539
I ask my team is it's important<font color="#E5E5E5"> and</font>

630
00:27:13,830 --> 00:27:17,740
<font color="#E5E5E5">short</font><font color="#CCCCCC"> term if your consumer is</font><font color="#E5E5E5"> that if</font>

631
00:27:16,539 --> 00:27:19,299
you buy one<font color="#CCCCCC"> of these</font><font color="#E5E5E5"> devices</font><font color="#CCCCCC"> you should</font>

632
00:27:17,740 --> 00:27:21,580
probably look at what services<font color="#CCCCCC"> are</font>

633
00:27:19,299 --> 00:27:24,279
enabled<font color="#E5E5E5"> by default if you</font><font color="#CCCCCC"> don't need</font>

634
00:27:21,580 --> 00:27:26,199
<font color="#E5E5E5">your web up to be enabled</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> your NAS</font>

635
00:27:24,279 --> 00:27:28,929
device<font color="#CCCCCC"> and</font><font color="#E5E5E5"> turn it off</font><font color="#CCCCCC"> a lot of the</font>

636
00:27:26,200 --> 00:27:30,480
times routers ship<font color="#E5E5E5"> so that the their web</font>

637
00:27:28,929 --> 00:27:33,039
application are accessible<font color="#E5E5E5"> from the web</font>

638
00:27:30,480 --> 00:27:34,419
so anybody<font color="#E5E5E5"> anywhere in the internet can</font>

639
00:27:33,039 --> 00:27:35,649
access<font color="#E5E5E5"> your router</font><font color="#CCCCCC"> it's probably not</font><font color="#E5E5E5"> a</font>

640
00:27:34,419 --> 00:27:37,419
good idea<font color="#CCCCCC"> especially</font><font color="#E5E5E5"> if you don't need</font>

641
00:27:35,649 --> 00:27:38,860
<font color="#E5E5E5">it</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> limit it</font><font color="#CCCCCC"> you're</font><font color="#E5E5E5"> like limit your</font>

642
00:27:37,419 --> 00:27:42,190
attack surface it's a very good<font color="#CCCCCC"> security</font>

643
00:27:38,860 --> 00:27:44,500
principle<font color="#E5E5E5"> and updating firmware</font><font color="#CCCCCC"> um it's</font>

644
00:27:42,190 --> 00:27:46,419
<font color="#E5E5E5">kind of hard and I I do feel bad</font><font color="#CCCCCC"> about</font>

645
00:27:44,500 --> 00:27:47,500
saying it because<font color="#E5E5E5"> it's not necessarily</font>

646
00:27:46,419 --> 00:27:49,389
<font color="#E5E5E5">your gonna update your form and</font>

647
00:27:47,500 --> 00:27:50,679
everything's gonna be hunky-dory<font color="#CCCCCC"> because</font>

648
00:27:49,389 --> 00:27:51,879
<font color="#E5E5E5">it happens to</font><font color="#CCCCCC"> be the case that if</font><font color="#E5E5E5"> the</font>

649
00:27:50,679 --> 00:27:53,889
manufacturer doesn't<font color="#E5E5E5"> know about the</font>

650
00:27:51,880 --> 00:27:55,269
vulnerability there's no<font color="#E5E5E5"> work for them</font>

651
00:27:53,889 --> 00:27:56,649
<font color="#E5E5E5">to fix it like there's no firmware</font>

652
00:27:55,269 --> 00:28:00,010
update if<font color="#CCCCCC"> there is command injection or</font>

653
00:27:56,649 --> 00:28:01,779
<font color="#E5E5E5">no one has told them</font><font color="#CCCCCC"> about</font><font color="#E5E5E5"> it long term</font>

654
00:28:00,010 --> 00:28:04,330
is to<font color="#CCCCCC"> request better security</font><font color="#E5E5E5"> in your</font>

655
00:28:01,779 --> 00:28:06,789
devices<font color="#CCCCCC"> if your if you like like a</font>

656
00:28:04,330 --> 00:28:07,809
specific<font color="#E5E5E5"> manufacturer</font><font color="#CCCCCC"> and you've noticed</font>

657
00:28:06,789 --> 00:28:09,309
<font color="#CCCCCC">that they have</font><font color="#E5E5E5"> very poor security</font>

658
00:28:07,809 --> 00:28:10,629
<font color="#E5E5E5">policies you could just say like hey I'm</font>

659
00:28:09,309 --> 00:28:12,970
<font color="#E5E5E5">not buying your stuff anymore because</font>

660
00:28:10,630 --> 00:28:14,409
you don't fix<font color="#CCCCCC"> it and as I found out to</font>

661
00:28:12,970 --> 00:28:16,210
do the magic of<font color="#E5E5E5"> Twitter usually telling</font>

662
00:28:14,409 --> 00:28:20,289
<font color="#E5E5E5">people that</font><font color="#CCCCCC"> their</font><font color="#E5E5E5"> stuff is</font><font color="#CCCCCC"> garbage</font><font color="#E5E5E5"> ends</font>

663
00:28:16,210 --> 00:28:21,760
up with them fixing it yeah and that's

664
00:28:20,289 --> 00:28:23,440
<font color="#E5E5E5">kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the end of my talk folks I hope</font>

665
00:28:21,760 --> 00:28:24,549
you enjoyed<font color="#E5E5E5"> it that's kind of what</font>

666
00:28:23,440 --> 00:28:26,230
<font color="#E5E5E5">hacking looks like from the perspective</font>

667
00:28:24,549 --> 00:28:27,850
<font color="#CCCCCC">of my day-to-day if you have any</font>

668
00:28:26,230 --> 00:28:29,890
questions I<font color="#CCCCCC"> like talking</font><font color="#E5E5E5"> shop I'll be</font>

669
00:28:27,850 --> 00:28:31,209
here<font color="#E5E5E5"> for a while at the IOT village</font>

670
00:28:29,890 --> 00:28:33,100
I work with the<font color="#E5E5E5"> people that put on the</font>

671
00:28:31,210 --> 00:28:36,500
IOT<font color="#E5E5E5"> village and this is what I do in the</font>

672
00:28:33,100 --> 00:28:39,549
research team and thanks

673
00:28:36,500 --> 00:28:39,549
[Applause]

674
00:28:41,910 --> 00:28:45,249
[Applause]

