1
00:00:00,000 --> 00:00:04,350
introduction this<font color="#E5E5E5"> is Daniel Riley he's a</font>

2
00:00:02,190 --> 00:00:06,000
he's an information<font color="#E5E5E5"> security manager for</font>

3
00:00:04,350 --> 00:00:07,258
a small labor management<font color="#E5E5E5"> company in</font>

4
00:00:06,000 --> 00:00:08,700
<font color="#CCCCCC">Seattle</font>

5
00:00:07,259 --> 00:00:10,860
he's also an independent security

6
00:00:08,700 --> 00:00:13,410
<font color="#E5E5E5">researcher and he's also been</font><font color="#CCCCCC"> a previous</font>

7
00:00:10,860 --> 00:00:20,939
<font color="#E5E5E5">speaker</font><font color="#CCCCCC"> at b-sides</font><font color="#E5E5E5"> so just give a warm</font>

8
00:00:13,410 --> 00:00:22,500
welcome<font color="#CCCCCC"> for him and then thank</font><font color="#E5E5E5"> you all</font>

9
00:00:20,939 --> 00:00:23,580
<font color="#E5E5E5">right excellent</font><font color="#CCCCCC"> thank you guys</font><font color="#E5E5E5"> for</font>

10
00:00:22,500 --> 00:00:25,320
<font color="#CCCCCC">coming out after</font><font color="#E5E5E5"> lunch I know</font>

11
00:00:23,580 --> 00:00:27,330
everybody's tired so I'll try<font color="#CCCCCC"> to</font><font color="#E5E5E5"> keep it</font>

12
00:00:25,320 --> 00:00:29,279
<font color="#CCCCCC">interesting and fun if you have</font><font color="#E5E5E5"> anything</font>

13
00:00:27,330 --> 00:00:31,259
<font color="#CCCCCC">to say just</font><font color="#E5E5E5"> kind of shout it out I like</font>

14
00:00:29,279 --> 00:00:34,710
being interactive and I'm<font color="#E5E5E5"> probably won't</font>

15
00:00:31,260 --> 00:00:36,510
notice hands so<font color="#E5E5E5"> just call it out so</font>

16
00:00:34,710 --> 00:00:39,300
today we're<font color="#CCCCCC"> gonna be talking about</font>

17
00:00:36,510 --> 00:00:43,019
<font color="#CCCCCC">Mifare which is a specification for</font><font color="#E5E5E5"> RFID</font>

18
00:00:39,300 --> 00:00:43,890
<font color="#E5E5E5">cards</font><font color="#CCCCCC"> as he said I'm</font><font color="#E5E5E5"> Daniel Riley or you</font>

19
00:00:43,020 --> 00:00:45,899
can call me oniy

20
00:00:43,890 --> 00:00:48,690
<font color="#CCCCCC">I think as hackers we all need to go</font>

21
00:00:45,899 --> 00:00:51,829
<font color="#E5E5E5">back</font><font color="#CCCCCC"> to using</font><font color="#E5E5E5"> handles all right so Who</font>

22
00:00:48,690 --> 00:00:54,718
am<font color="#E5E5E5"> I uh well I'm a lot like Archer and</font>

23
00:00:51,829 --> 00:00:56,760
I've given<font color="#E5E5E5"> this is my third presentation</font>

24
00:00:54,719 --> 00:01:00,449
my first presentation<font color="#E5E5E5"> was a black</font><font color="#CCCCCC"> cat</font>

25
00:00:56,760 --> 00:01:01,829
<font color="#CCCCCC">presentation on writing CNC software my</font>

26
00:01:00,449 --> 00:01:04,500
second<font color="#E5E5E5"> presentation was a</font><font color="#CCCCCC"> gray hat</font>

27
00:01:01,829 --> 00:01:06,150
presentation<font color="#CCCCCC"> on exploits</font><font color="#E5E5E5"> and now we're</font>

28
00:01:04,500 --> 00:01:07,830
at<font color="#CCCCCC"> my white hat presentation where we're</font>

29
00:01:06,150 --> 00:01:13,500
<font color="#E5E5E5">talking about defense techniques for</font>

30
00:01:07,830 --> 00:01:16,740
<font color="#CCCCCC">RFID</font><font color="#E5E5E5"> all right so why did I choose my</font>

31
00:01:13,500 --> 00:01:18,780
fair lady as a title<font color="#E5E5E5"> for this well my</font>

32
00:01:16,740 --> 00:01:21,990
<font color="#E5E5E5">fair kind of lends itself to the topic</font>

33
00:01:18,780 --> 00:01:24,570
<font color="#CCCCCC">but</font><font color="#E5E5E5"> also the topic of the movie my fair</font>

34
00:01:21,990 --> 00:01:26,369
lady<font color="#CCCCCC"> is teaching a cockney flower girl</font>

35
00:01:24,570 --> 00:01:29,130
how to speak and<font color="#E5E5E5"> act like a lady and</font>

36
00:01:26,369 --> 00:01:30,570
<font color="#E5E5E5">pass herself off as very much kind of</font>

37
00:01:29,130 --> 00:01:32,880
<font color="#CCCCCC">like what we're doing here with RFID</font>

38
00:01:30,570 --> 00:01:34,439
today<font color="#E5E5E5"> so we're gonna cover some my fair</font>

39
00:01:32,880 --> 00:01:35,939
background<font color="#E5E5E5"> and then we're gonna talk</font>

40
00:01:34,439 --> 00:01:38,548
about<font color="#E5E5E5"> the landscape and the threat model</font>

41
00:01:35,939 --> 00:01:41,220
<font color="#E5E5E5">that I was using some cool crypto stuff</font>

42
00:01:38,549 --> 00:01:42,720
<font color="#CCCCCC">some more fun RF stuff and then the</font>

43
00:01:41,220 --> 00:01:44,189
<font color="#CCCCCC">conclusion that</font><font color="#E5E5E5"> everybody should walk</font>

44
00:01:42,720 --> 00:01:48,689
out<font color="#E5E5E5"> on because it's</font><font color="#CCCCCC"> gonna be the same</font>

45
00:01:44,189 --> 00:01:50,939
stuff<font color="#E5E5E5"> shortened again thank you all</font>

46
00:01:48,689 --> 00:01:53,039
right you guys<font color="#E5E5E5"> gonna know some</font>

47
00:01:50,939 --> 00:01:55,289
terminology some of<font color="#CCCCCC"> those things look</font>

48
00:01:53,040 --> 00:01:57,689
scary<font color="#E5E5E5"> but I promise they're not so the</font>

49
00:01:55,290 --> 00:02:00,060
<font color="#CCCCCC">first one up there pbkdf2 that's the</font>

50
00:01:57,689 --> 00:02:02,850
password-based key derivation<font color="#E5E5E5"> function</font>

51
00:02:00,060 --> 00:02:05,159
you take<font color="#CCCCCC"> a crappy password</font><font color="#E5E5E5"> you get back</font>

52
00:02:02,850 --> 00:02:07,770
something<font color="#E5E5E5"> that's not nearly as crappy 32</font>

53
00:02:05,159 --> 00:02:10,470
bytes long<font color="#E5E5E5"> based on the password so it's</font>

54
00:02:07,770 --> 00:02:11,730
recoverable crypto<font color="#CCCCCC"> 1 all you need to</font>

55
00:02:10,470 --> 00:02:13,770
know about crypto 1 is that it's

56
00:02:11,730 --> 00:02:17,820
<font color="#E5E5E5">horrible</font><font color="#CCCCCC"> you hear crypto 1 you</font>

57
00:02:13,770 --> 00:02:18,420
think<font color="#E5E5E5"> boo</font><font color="#CCCCCC"> all right AES 128</font><font color="#E5E5E5"> that's the</font>

58
00:02:17,820 --> 00:02:21,239
opposite

59
00:02:18,420 --> 00:02:23,489
that's yay<font color="#E5E5E5"> we love</font><font color="#CCCCCC"> it yes</font><font color="#E5E5E5"> all right</font><font color="#CCCCCC"> H</font>

60
00:02:21,240 --> 00:02:26,400
max<font color="#CCCCCC"> so for people</font><font color="#E5E5E5"> who are not into</font>

61
00:02:23,490 --> 00:02:29,520
cryptography<font color="#CCCCCC"> H Mac is a way of</font>

62
00:02:26,400 --> 00:02:31,260
<font color="#E5E5E5">authenticating a message using a hash of</font>

63
00:02:29,520 --> 00:02:33,770
that<font color="#E5E5E5"> message if the message</font><font color="#CCCCCC"> was changed</font>

64
00:02:31,260 --> 00:02:37,560
the hash would match<font color="#E5E5E5"> you're good to go</font>

65
00:02:33,770 --> 00:02:39,180
encrypt-then-mac<font color="#CCCCCC"> is an additional H Mac</font>

66
00:02:37,560 --> 00:02:40,620
<font color="#E5E5E5">step that says first you're going to</font>

67
00:02:39,180 --> 00:02:42,810
<font color="#E5E5E5">encrypt your</font><font color="#CCCCCC"> data and</font><font color="#E5E5E5"> then you're going</font>

68
00:02:40,620 --> 00:02:44,880
<font color="#E5E5E5">to take the Mac of it rather than taking</font>

69
00:02:42,810 --> 00:02:47,460
<font color="#CCCCCC">the Mac</font><font color="#E5E5E5"> of the plaintext don't ever Mac</font>

70
00:02:44,880 --> 00:02:50,160
your<font color="#CCCCCC"> plaintext</font><font color="#E5E5E5"> all right and then the</font>

71
00:02:47,460 --> 00:02:52,560
puffs<font color="#CCCCCC"> those are physically uncountable</font>

72
00:02:50,160 --> 00:02:55,680
functions<font color="#E5E5E5"> or as of now we consider them</font>

73
00:02:52,560 --> 00:02:57,150
physically in cloneable<font color="#E5E5E5"> those are like</font>

74
00:02:55,680 --> 00:03:00,300
biometrics<font color="#CCCCCC"> for</font><font color="#E5E5E5"> Hardware your</font>

75
00:02:57,150 --> 00:03:02,400
fingerprints and iris analysis<font color="#CCCCCC"> only done</font>

76
00:03:00,300 --> 00:03:06,480
on<font color="#CCCCCC"> the principles of your</font><font color="#E5E5E5"> hardware as</font>

77
00:03:02,400 --> 00:03:08,520
opposed to<font color="#E5E5E5"> your biology</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so now</font>

78
00:03:06,480 --> 00:03:09,959
<font color="#E5E5E5">getting into the classes of RFID tags</font>

79
00:03:08,520 --> 00:03:12,690
we've all<font color="#CCCCCC"> probably been pretty familiar</font>

80
00:03:09,960 --> 00:03:14,640
<font color="#E5E5E5">with</font><font color="#CCCCCC"> these now</font><font color="#E5E5E5"> you've got the system on</font>

81
00:03:12,690 --> 00:03:16,109
a<font color="#CCCCCC"> chip or the</font><font color="#E5E5E5"> single board computer</font>

82
00:03:14,640 --> 00:03:18,420
smart devices<font color="#E5E5E5"> which are basically</font>

83
00:03:16,110 --> 00:03:21,360
<font color="#E5E5E5">running a full computer on a credit card</font>

84
00:03:18,420 --> 00:03:24,030
<font color="#CCCCCC">situs device you can run full crypto you</font>

85
00:03:21,360 --> 00:03:25,920
can do all the internet checks you want

86
00:03:24,030 --> 00:03:26,940
<font color="#E5E5E5">they're super great that's not what</font>

87
00:03:25,920 --> 00:03:29,730
we're dealing<font color="#E5E5E5"> with today</font>

88
00:03:26,940 --> 00:03:32,220
so secured memory devices<font color="#CCCCCC"> wear devices</font>

89
00:03:29,730 --> 00:03:34,410
<font color="#CCCCCC">that had memory that were locked by some</font>

90
00:03:32,220 --> 00:03:37,560
kind<font color="#CCCCCC"> of usually proprietary now it's</font>

91
00:03:34,410 --> 00:03:40,430
more open<font color="#E5E5E5"> at cryptography but back in 95</font>

92
00:03:37,560 --> 00:03:45,000
<font color="#CCCCCC">they used crypto 1 boo</font>

93
00:03:40,430 --> 00:03:47,730
which was completely closed down and not

94
00:03:45,000 --> 00:03:49,350
published it was broken<font color="#CCCCCC"> and</font><font color="#E5E5E5"> when that</font>

95
00:03:47,730 --> 00:03:51,090
moves them down to the simple memory

96
00:03:49,350 --> 00:03:53,370
device these are memory devices<font color="#E5E5E5"> where</font>

97
00:03:51,090 --> 00:03:55,650
all of the sectors inside of it can

98
00:03:53,370 --> 00:03:57,600
<font color="#E5E5E5">basically be read by</font><font color="#CCCCCC"> anybody with</font><font color="#E5E5E5"> a</font>

99
00:03:55,650 --> 00:03:59,930
reader there's no security<font color="#E5E5E5"> involved and</font>

100
00:03:57,600 --> 00:04:02,609
then down from that<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> your simple</font>

101
00:03:59,930 --> 00:04:06,980
<font color="#E5E5E5">broadcast devices these</font><font color="#CCCCCC"> are like your</font><font color="#E5E5E5"> RF</font>

102
00:04:02,610 --> 00:04:09,390
tags that can only transmit a single ID

103
00:04:06,980 --> 00:04:12,299
we're slightly better than<font color="#CCCCCC"> that still</font>

104
00:04:09,390 --> 00:04:14,519
<font color="#E5E5E5">because we've got memory we</font><font color="#CCCCCC"> can use</font><font color="#E5E5E5"> all</font>

105
00:04:12,300 --> 00:04:16,620
<font color="#E5E5E5">right so this</font><font color="#CCCCCC"> is a very brief</font><font color="#E5E5E5"> timeline</font>

106
00:04:14,520 --> 00:04:19,799
of how I've kind of picked apart the

107
00:04:16,620 --> 00:04:22,680
Mifare spec<font color="#E5E5E5"> so in 1994 they introduced</font>

108
00:04:19,798 --> 00:04:25,049
the spec with the crypto<font color="#E5E5E5"> 1 cryptography</font>

109
00:04:22,680 --> 00:04:27,400
and within two<font color="#E5E5E5"> years</font><font color="#CCCCCC"> it was picked up by</font>

110
00:04:25,050 --> 00:04:29,949
Seoul South Korea<font color="#CCCCCC"> as</font><font color="#E5E5E5"> their</font>

111
00:04:27,400 --> 00:04:32,710
<font color="#CCCCCC">main transportation</font><font color="#E5E5E5"> card or carrying</font>

112
00:04:29,949 --> 00:04:34,449
fares<font color="#E5E5E5"> so</font><font color="#CCCCCC"> then there's this huge gap</font>

113
00:04:32,710 --> 00:04:36,638
where apparently<font color="#CCCCCC"> nobody was doing</font>

114
00:04:34,449 --> 00:04:39,550
anything<font color="#CCCCCC"> to</font><font color="#E5E5E5"> secure it because then in</font>

115
00:04:36,639 --> 00:04:42,570
2006<font color="#E5E5E5"> the black hat the first black hat</font>

116
00:04:39,550 --> 00:04:45,729
talk was released which did a partial

117
00:04:42,570 --> 00:04:47,889
algebraic analysis of crypto<font color="#CCCCCC"> 1 and</font>

118
00:04:45,729 --> 00:04:51,340
reduced the key<font color="#E5E5E5"> space so now it became</font>

119
00:04:47,889 --> 00:04:54,280
very much much more crackable then in

120
00:04:51,340 --> 00:04:57,448
2008 just<font color="#E5E5E5"> a short</font><font color="#CCCCCC"> 2 years later there</font>

121
00:04:54,280 --> 00:05:00,760
were<font color="#E5E5E5"> two talks that were released on</font>

122
00:04:57,449 --> 00:05:03,760
simultaneous but separate research the

123
00:05:00,760 --> 00:05:07,240
first researcher<font color="#CCCCCC"> the black hat</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> one</font>

124
00:05:03,760 --> 00:05:10,180
he did another further partial

125
00:05:07,240 --> 00:05:12,550
decryption<font color="#E5E5E5"> or a partial deconstruction</font>

126
00:05:10,180 --> 00:05:15,610
of<font color="#CCCCCC"> the</font><font color="#E5E5E5"> encryption algorithm</font><font color="#CCCCCC"> and then the</font>

127
00:05:12,550 --> 00:05:19,090
second top<font color="#E5E5E5"> he actually fully broke the</font>

128
00:05:15,610 --> 00:05:21,400
crypto he laid out the<font color="#E5E5E5"> key space all</font><font color="#CCCCCC"> of</font>

129
00:05:19,090 --> 00:05:22,239
<font color="#E5E5E5">the nonces it was just broken</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> usable</font>

130
00:05:21,400 --> 00:05:25,270
<font color="#E5E5E5">all right</font>

131
00:05:22,240 --> 00:05:27,610
they don't<font color="#E5E5E5"> change anything 2008 they</font>

132
00:05:25,270 --> 00:05:28,990
released<font color="#E5E5E5"> a</font><font color="#CCCCCC"> mobile industry group and</font>

133
00:05:27,610 --> 00:05:31,120
they say hey instead<font color="#E5E5E5"> of fixing</font>

134
00:05:28,990 --> 00:05:33,070
cryptography<font color="#E5E5E5"> let's get you to use your</font>

135
00:05:31,120 --> 00:05:36,550
cell phones to<font color="#E5E5E5"> do it awesome</font>

136
00:05:33,070 --> 00:05:39,130
so then they also announced<font color="#E5E5E5"> that they're</font>

137
00:05:36,550 --> 00:05:41,199
starting<font color="#CCCCCC"> to</font><font color="#E5E5E5"> incorporate AES but it's not</font>

138
00:05:39,130 --> 00:05:43,180
by<font color="#CCCCCC"> default and it's not</font><font color="#E5E5E5"> going to</font><font color="#CCCCCC"> replace</font>

139
00:05:41,199 --> 00:05:44,250
the old crypto system which is<font color="#E5E5E5"> still</font><font color="#CCCCCC"> in</font>

140
00:05:43,180 --> 00:05:46,720
<font color="#E5E5E5">use today</font>

141
00:05:44,250 --> 00:05:49,479
<font color="#CCCCCC">alright so then moving forward from that</font>

142
00:05:46,720 --> 00:05:51,280
another black hat talk<font color="#E5E5E5"> is released more</font>

143
00:05:49,479 --> 00:05:54,250
of the<font color="#E5E5E5"> system is broken only this one</font>

144
00:05:51,280 --> 00:05:56,530
has<font color="#CCCCCC"> hacks in the wild</font><font color="#E5E5E5"> that are being</font>

145
00:05:54,250 --> 00:05:59,080
used<font color="#E5E5E5"> in South Korea to refill people's</font>

146
00:05:56,530 --> 00:06:01,090
transportation cards<font color="#E5E5E5"> deals with an</font>

147
00:05:59,080 --> 00:06:02,949
<font color="#E5E5E5">Android app you</font><font color="#CCCCCC"> can get if you ever go</font>

148
00:06:01,090 --> 00:06:08,380
<font color="#CCCCCC">to South Korea</font><font color="#E5E5E5"> I think you can still use</font>

149
00:06:02,949 --> 00:06:09,789
it<font color="#CCCCCC"> alright and then in 2014 they still</font>

150
00:06:08,380 --> 00:06:11,820
haven't repaired their crypto because

151
00:06:09,789 --> 00:06:14,949
now they support AES so they feel good

152
00:06:11,820 --> 00:06:17,560
<font color="#CCCCCC">and</font><font color="#E5E5E5"> they say hey we're gonna release the</font>

153
00:06:14,949 --> 00:06:21,430
SDK<font color="#E5E5E5"> cuz now everybody can program bad</font>

154
00:06:17,560 --> 00:06:24,490
stuff<font color="#CCCCCC"> and then the final blackhat talk</font>

155
00:06:21,430 --> 00:06:26,380
in 2014<font color="#CCCCCC"> the gentleman just</font><font color="#E5E5E5"> came out and</font>

156
00:06:24,490 --> 00:06:28,510
<font color="#E5E5E5">said</font><font color="#CCCCCC"> don't use my</font><font color="#E5E5E5"> fare it's broken it's</font>

157
00:06:26,380 --> 00:06:31,000
not<font color="#CCCCCC"> secured</font><font color="#E5E5E5"> don't use it I have</font><font color="#CCCCCC"> to</font>

158
00:06:28,510 --> 00:06:33,969
disagree we'll get to that<font color="#E5E5E5"> in</font><font color="#CCCCCC"> a minute</font>

159
00:06:31,000 --> 00:06:37,460
<font color="#CCCCCC">so then in</font><font color="#E5E5E5"> 2016 they released Mifare</font>

160
00:06:33,970 --> 00:06:39,590
plus the<font color="#CCCCCC"> evo one</font><font color="#E5E5E5"> which by</font><font color="#CCCCCC"> default</font>

161
00:06:37,460 --> 00:06:41,960
can support AES in a security mode

162
00:06:39,590 --> 00:06:44,299
called<font color="#E5E5E5"> security mode 3 however you can</font>

163
00:06:41,960 --> 00:06:46,638
<font color="#E5E5E5">still choose security mode 1 which is</font>

164
00:06:44,300 --> 00:06:51,169
the crypto<font color="#E5E5E5"> 1 standard and is still</font><font color="#CCCCCC"> very</font>

165
00:06:46,639 --> 00:06:53,780
broken<font color="#CCCCCC"> alright so going</font><font color="#E5E5E5"> into where I was</font>

166
00:06:51,169 --> 00:06:56,990
<font color="#E5E5E5">working so</font><font color="#CCCCCC"> I work at a warehouse</font><font color="#E5E5E5"> labor</font>

167
00:06:53,780 --> 00:06:59,659
management<font color="#E5E5E5"> company and a lot</font><font color="#CCCCCC"> of what we</font>

168
00:06:56,990 --> 00:07:01,550
deal with is the<font color="#E5E5E5"> warehouse data so we</font>

169
00:06:59,660 --> 00:07:02,960
have<font color="#E5E5E5"> personnel and shift data down there</font>

170
00:07:01,550 --> 00:07:04,849
in the lower left corner<font color="#E5E5E5"> that's the guy</font>

171
00:07:02,960 --> 00:07:06,650
trying to<font color="#E5E5E5"> get out</font><font color="#CCCCCC"> of the warehouse he</font>

172
00:07:04,849 --> 00:07:08,449
<font color="#E5E5E5">just wants to hit his time clock and</font><font color="#CCCCCC"> run</font>

173
00:07:06,650 --> 00:07:09,710
you've got the freight movement those

174
00:07:08,449 --> 00:07:11,539
are all the people<font color="#E5E5E5"> with the little hand</font>

175
00:07:09,710 --> 00:07:14,539
<font color="#E5E5E5">scanners that scan a box and put</font><font color="#CCCCCC"> a box</font>

176
00:07:11,539 --> 00:07:16,219
<font color="#E5E5E5">on</font><font color="#CCCCCC"> the truck</font><font color="#E5E5E5"> all of that stuff goes to</font>

177
00:07:14,539 --> 00:07:18,949
an<font color="#E5E5E5"> internal network inside of the</font>

178
00:07:16,220 --> 00:07:21,949
warehouse<font color="#E5E5E5"> that network is not considered</font>

179
00:07:18,949 --> 00:07:23,990
<font color="#E5E5E5">stable it's considered semi stable then</font>

180
00:07:21,949 --> 00:07:26,060
we've got a link to<font color="#CCCCCC"> the warehouse data</font>

181
00:07:23,990 --> 00:07:27,710
subnet which is usually a cloud service

182
00:07:26,060 --> 00:07:31,250
provider these days where they're

183
00:07:27,710 --> 00:07:33,049
storing all of<font color="#CCCCCC"> their data so that link</font>

184
00:07:31,250 --> 00:07:35,780
between the warehouse and the data

185
00:07:33,050 --> 00:07:37,909
subnet<font color="#E5E5E5"> is considered stable we should</font>

186
00:07:35,780 --> 00:07:39,469
always be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to get data from the</font>

187
00:07:37,909 --> 00:07:41,750
warehouse subnet<font color="#CCCCCC"> to the warehouse</font>

188
00:07:39,470 --> 00:07:44,419
<font color="#CCCCCC">although all of the</font><font color="#E5E5E5"> devices on the</font>

189
00:07:41,750 --> 00:07:47,539
warehouse<font color="#E5E5E5"> network may not operate all at</font>

190
00:07:44,419 --> 00:07:49,940
once<font color="#CCCCCC"> and update with the information</font><font color="#E5E5E5"> so</font>

191
00:07:47,539 --> 00:07:52,280
then we tap<font color="#E5E5E5"> into their data stream</font>

192
00:07:49,940 --> 00:07:54,380
between<font color="#E5E5E5"> their corporate offices we apply</font>

193
00:07:52,280 --> 00:07:56,719
<font color="#CCCCCC">some super cool analytics stuff to it</font>

194
00:07:54,380 --> 00:07:59,360
and we<font color="#E5E5E5"> spit back out more information</font><font color="#CCCCCC"> up</font>

195
00:07:56,719 --> 00:08:01,909
<font color="#CCCCCC">to their warehouse corporate offices so</font>

196
00:07:59,360 --> 00:08:05,060
this is kind of the<font color="#E5E5E5"> the landscape that</font>

197
00:08:01,909 --> 00:08:06,889
we're looking<font color="#CCCCCC"> at</font><font color="#E5E5E5"> using RFID in and right</font>

198
00:08:05,060 --> 00:08:09,440
off<font color="#E5E5E5"> the bat you see freight movement and</font>

199
00:08:06,889 --> 00:08:12,199
personnel shift data are really<font color="#E5E5E5"> easy</font><font color="#CCCCCC"> to</font>

200
00:08:09,440 --> 00:08:14,330
capture<font color="#E5E5E5"> if you can use a secure RFID</font>

201
00:08:12,199 --> 00:08:16,159
however you don't<font color="#E5E5E5"> want</font><font color="#CCCCCC"> your personnel</font>

202
00:08:14,330 --> 00:08:19,070
walking<font color="#E5E5E5"> around with a card that's</font>

203
00:08:16,159 --> 00:08:21,909
<font color="#CCCCCC">leaking data about who they are</font><font color="#E5E5E5"> or about</font>

204
00:08:19,070 --> 00:08:24,830
what your<font color="#E5E5E5"> business is</font>

205
00:08:21,909 --> 00:08:27,139
so these are the threats<font color="#E5E5E5"> that I didn't</font>

206
00:08:24,830 --> 00:08:29,060
consider first off and<font color="#E5E5E5"> if you don't like</font>

207
00:08:27,139 --> 00:08:31,310
them if they're not applicable<font color="#CCCCCC"> to</font><font color="#E5E5E5"> your</font>

208
00:08:29,060 --> 00:08:34,250
area<font color="#E5E5E5"> that's fine</font><font color="#CCCCCC"> go ahead and figure</font><font color="#E5E5E5"> out</font>

209
00:08:31,310 --> 00:08:35,929
some<font color="#CCCCCC"> solutions for these</font><font color="#E5E5E5"> but can't</font>

210
00:08:34,250 --> 00:08:39,860
<font color="#CCCCCC">approve</font><font color="#E5E5E5"> everything all the time and</font>

211
00:08:35,929 --> 00:08:42,199
<font color="#E5E5E5">aiders are gonna</font><font color="#CCCCCC"> 8th so what I didn't</font>

212
00:08:39,860 --> 00:08:44,270
deal with<font color="#E5E5E5"> is offline but I did kind of</font>

213
00:08:42,200 --> 00:08:46,310
sort of deal<font color="#CCCCCC"> with it</font><font color="#E5E5E5"> because</font><font color="#CCCCCC"> my boss</font>

214
00:08:44,270 --> 00:08:48,050
<font color="#CCCCCC">maybe he I told him hey we're just not</font>

215
00:08:46,310 --> 00:08:49,609
gonna deal with readers going<font color="#E5E5E5"> offline he</font>

216
00:08:48,050 --> 00:08:50,609
goes yeah we<font color="#E5E5E5"> work in warehouses and</font>

217
00:08:49,610 --> 00:08:52,470
that's going<font color="#E5E5E5"> to happen a lot</font>

218
00:08:50,610 --> 00:08:55,800
you need to deal<font color="#CCCCCC"> with it</font><font color="#E5E5E5"> so I got</font>

219
00:08:52,470 --> 00:08:57,600
overruled unattended physical access<font color="#E5E5E5"> to</font>

220
00:08:55,800 --> 00:08:59,910
<font color="#CCCCCC">readers if some guy can get into</font><font color="#E5E5E5"> your</font>

221
00:08:57,600 --> 00:09:01,500
warehouse<font color="#CCCCCC"> open</font><font color="#E5E5E5"> up your time clock with a</font>

222
00:08:59,910 --> 00:09:04,640
crowbar<font color="#E5E5E5"> and attach something</font><font color="#CCCCCC"> to it</font>

223
00:09:01,500 --> 00:09:07,470
you've already lost<font color="#CCCCCC"> I can't help</font><font color="#E5E5E5"> you</font>

224
00:09:04,640 --> 00:09:09,899
<font color="#CCCCCC">alright preventing tag modification</font><font color="#E5E5E5"> this</font>

225
00:09:07,470 --> 00:09:12,269
is a big one<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> of people ask can you</font>

226
00:09:09,899 --> 00:09:14,399
stop somebody<font color="#E5E5E5"> from changing one</font><font color="#CCCCCC"> of these</font>

227
00:09:12,269 --> 00:09:17,430
RFID<font color="#E5E5E5"> tags</font><font color="#CCCCCC"> no you cannot</font>

228
00:09:14,399 --> 00:09:19,890
you can simply detect<font color="#E5E5E5"> if it's been done</font>

229
00:09:17,430 --> 00:09:21,930
now with a<font color="#CCCCCC"> single-board</font><font color="#E5E5E5"> computer or one</font>

230
00:09:19,890 --> 00:09:23,490
of the smarter devices you might<font color="#E5E5E5"> be able</font>

231
00:09:21,930 --> 00:09:26,359
<font color="#E5E5E5">to do that but with one of these my</font>

232
00:09:23,490 --> 00:09:28,950
<font color="#E5E5E5">favorite devices</font><font color="#CCCCCC"> good luck have fun</font>

233
00:09:26,360 --> 00:09:30,450
<font color="#CCCCCC">alright so tell</font><font color="#E5E5E5"> you what</font><font color="#CCCCCC"> I didn't want</font>

234
00:09:28,950 --> 00:09:33,329
to work on<font color="#E5E5E5"> you tell you what</font><font color="#CCCCCC"> actually</font>

235
00:09:30,450 --> 00:09:37,760
did work<font color="#E5E5E5"> on so that is data modification</font>

236
00:09:33,329 --> 00:09:40,349
<font color="#CCCCCC">if the data is modified can we detect it</font>

237
00:09:37,760 --> 00:09:42,569
data leakage<font color="#E5E5E5"> if somebody's walking</font>

238
00:09:40,350 --> 00:09:44,100
<font color="#E5E5E5">around with a personnel RFID card is</font>

239
00:09:42,570 --> 00:09:46,230
somebody going to get their<font color="#E5E5E5"> social</font>

240
00:09:44,100 --> 00:09:49,230
security<font color="#E5E5E5"> number</font><font color="#CCCCCC"> or their</font><font color="#E5E5E5"> place of</font>

241
00:09:46,230 --> 00:09:51,120
<font color="#E5E5E5">business card based attacks against the</font>

242
00:09:49,230 --> 00:09:54,779
reader were the absolute<font color="#CCCCCC"> most fun to</font>

243
00:09:51,120 --> 00:09:57,300
<font color="#E5E5E5">research and they were surprising about</font>

244
00:09:54,779 --> 00:09:59,279
<font color="#E5E5E5">how many iCloud and the</font><font color="#CCCCCC"> networks</font>

245
00:09:57,300 --> 00:10:01,620
sniffing<font color="#E5E5E5"> a man-in-the-middle attacks</font>

246
00:09:59,279 --> 00:10:04,439
these<font color="#E5E5E5"> should just not work who here has</font>

247
00:10:01,620 --> 00:10:06,089
ever<font color="#E5E5E5"> set up a virtual land network so</font>

248
00:10:04,440 --> 00:10:08,850
that<font color="#CCCCCC"> you can segregate parts of your</font>

249
00:10:06,089 --> 00:10:11,220
network<font color="#E5E5E5"> every single person should have</font>

250
00:10:08,850 --> 00:10:13,829
their hand up so go home<font color="#CCCCCC"> and separate</font>

251
00:10:11,220 --> 00:10:15,779
your let<font color="#E5E5E5"> network out in VLANs and then</font>

252
00:10:13,829 --> 00:10:18,810
your network you won't be<font color="#E5E5E5"> able to see</font>

253
00:10:15,779 --> 00:10:21,149
the<font color="#E5E5E5"> requests going back to the database</font>

254
00:10:18,810 --> 00:10:23,459
from your RFID card reader<font color="#CCCCCC"> alright and</font>

255
00:10:21,149 --> 00:10:28,890
then<font color="#E5E5E5"> the last one card cloning</font><font color="#CCCCCC"> this is a</font>

256
00:10:23,459 --> 00:10:31,529
huge problem<font color="#CCCCCC"> because even in the world</font>

257
00:10:28,890 --> 00:10:33,420
<font color="#E5E5E5">of</font><font color="#CCCCCC"> Mifare the cards the first sector</font><font color="#E5E5E5"> of</font>

258
00:10:31,529 --> 00:10:34,800
the card is locked<font color="#E5E5E5"> you're not supposed</font>

259
00:10:33,420 --> 00:10:36,959
to be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to overwrite it that's the</font>

260
00:10:34,800 --> 00:10:39,839
unique identifier<font color="#E5E5E5"> from the manufacturer</font>

261
00:10:36,959 --> 00:10:42,390
<font color="#E5E5E5">however there are Chinese magic cards</font>

262
00:10:39,839 --> 00:10:46,140
which allow you to overwrite all those

263
00:10:42,390 --> 00:10:49,800
sectors including the<font color="#CCCCCC"> the first sector</font>

264
00:10:46,140 --> 00:10:52,050
<font color="#E5E5E5">the zero block which will allow any card</font>

265
00:10:49,800 --> 00:10:54,420
to completely<font color="#E5E5E5"> and fully emulate any</font>

266
00:10:52,050 --> 00:10:58,290
<font color="#E5E5E5">other</font><font color="#CCCCCC"> Mifare card</font><font color="#E5E5E5"> so we need to be able</font>

267
00:10:54,420 --> 00:11:00,899
to<font color="#E5E5E5"> stop that all right so now let's</font><font color="#CCCCCC"> get</font>

268
00:10:58,290 --> 00:11:02,550
<font color="#CCCCCC">into why I wrote up my own system as</font>

269
00:11:00,899 --> 00:11:04,510
opposed to just<font color="#E5E5E5"> using the hundreds that</font>

270
00:11:02,550 --> 00:11:10,219
<font color="#E5E5E5">are</font><font color="#CCCCCC"> out there</font>

271
00:11:04,510 --> 00:11:11,720
sorry<font color="#E5E5E5"> about that this is why we can't</font>

272
00:11:10,220 --> 00:11:16,100
have nice things<font color="#E5E5E5"> that was perfectly</font>

273
00:11:11,720 --> 00:11:18,440
timed<font color="#CCCCCC"> alright so</font><font color="#E5E5E5"> I'm gonna come work</font>

274
00:11:16,100 --> 00:11:20,450
<font color="#E5E5E5">these backwards sniffing the</font><font color="#CCCCCC"> networked</font>

275
00:11:18,440 --> 00:11:22,460
<font color="#CCCCCC">racket</font><font color="#E5E5E5"> it should never be able to happen</font>

276
00:11:20,450 --> 00:11:24,710
<font color="#E5E5E5">your readers should not be on the same</font>

277
00:11:22,460 --> 00:11:27,200
<font color="#E5E5E5">network as</font><font color="#CCCCCC"> the rest of your computer's</font>

278
00:11:24,710 --> 00:11:28,970
let alone<font color="#E5E5E5"> the</font><font color="#CCCCCC"> guests network or I can</font>

279
00:11:27,200 --> 00:11:30,760
just<font color="#CCCCCC"> sit in your</font><font color="#E5E5E5"> Lobby and</font><font color="#CCCCCC"> login and</font>

280
00:11:28,970 --> 00:11:33,710
watch all of<font color="#E5E5E5"> your people</font>

281
00:11:30,760 --> 00:11:34,939
<font color="#CCCCCC">alright unencrypted remote DB queries</font>

282
00:11:33,710 --> 00:11:37,790
this<font color="#E5E5E5"> is what I'm talking</font><font color="#CCCCCC"> about if you</font>

283
00:11:34,940 --> 00:11:39,650
<font color="#E5E5E5">have an encrypted card poor</font>

284
00:11:37,790 --> 00:11:41,780
implementations will decrypt<font color="#E5E5E5"> the</font>

285
00:11:39,650 --> 00:11:44,480
information<font color="#E5E5E5"> and then search the database</font>

286
00:11:41,780 --> 00:11:46,939
for<font color="#CCCCCC"> that person</font><font color="#E5E5E5"> to see if the card is</font>

287
00:11:44,480 --> 00:11:48,530
<font color="#CCCCCC">valid so if you have an encrypted card I</font>

288
00:11:46,940 --> 00:11:50,060
don't<font color="#E5E5E5"> have to decrypt it I just</font><font color="#CCCCCC"> have to</font>

289
00:11:48,530 --> 00:11:52,640
watch your network traffic<font color="#E5E5E5"> to see what</font>

290
00:11:50,060 --> 00:11:57,770
it comes<font color="#E5E5E5"> out as now I have a chosen</font>

291
00:11:52,640 --> 00:12:01,310
ciphertext attack basically<font color="#E5E5E5"> HDTV api's</font>

292
00:11:57,770 --> 00:12:06,230
people let's encrypt works<font color="#CCCCCC"> it's awesome</font>

293
00:12:01,310 --> 00:12:08,469
<font color="#E5E5E5">don't use HTTP anymore</font><font color="#CCCCCC"> alright let's get</font>

294
00:12:06,230 --> 00:12:13,040
<font color="#E5E5E5">into</font><font color="#CCCCCC"> the malicious data modification and</font>

295
00:12:08,470 --> 00:12:16,490
data leakage so data stored<font color="#E5E5E5"> in plain</font>

296
00:12:13,040 --> 00:12:18,740
text<font color="#CCCCCC"> on a my fare card</font><font color="#E5E5E5"> generally is</font>

297
00:12:16,490 --> 00:12:23,210
relying on the crypto one standard<font color="#CCCCCC"> for</font>

298
00:12:18,740 --> 00:12:26,390
protection<font color="#CCCCCC"> so there is no protection and</font>

299
00:12:23,210 --> 00:12:28,550
that is we've known that<font color="#E5E5E5"> since 2008 and</font>

300
00:12:26,390 --> 00:12:30,620
my fare cards are still widely

301
00:12:28,550 --> 00:12:33,319
distributed in fact the reason<font color="#CCCCCC"> I chose</font>

302
00:12:30,620 --> 00:12:35,570
<font color="#CCCCCC">to do</font><font color="#E5E5E5"> this talk was because I bought</font>

303
00:12:33,320 --> 00:12:37,700
some parts<font color="#E5E5E5"> for prototyping without</font>

304
00:12:35,570 --> 00:12:39,560
<font color="#CCCCCC">understanding exactly what it was in</font><font color="#E5E5E5"> the</font>

305
00:12:37,700 --> 00:12:42,820
package it was a big giant<font color="#E5E5E5"> package of</font>

306
00:12:39,560 --> 00:12:45,229
RFID equipment and I got a bunch of

307
00:12:42,820 --> 00:12:47,630
<font color="#CCCCCC">Mifare classic cards that did not</font>

308
00:12:45,230 --> 00:12:51,710
support<font color="#CCCCCC"> the ev1 standard yet</font><font color="#E5E5E5"> they're</font>

309
00:12:47,630 --> 00:12:55,850
<font color="#E5E5E5">very old so I can't just</font><font color="#CCCCCC"> accept crypto</font>

310
00:12:51,710 --> 00:12:57,650
<font color="#CCCCCC">one</font><font color="#E5E5E5"> it's broken it doesn't</font><font color="#CCCCCC"> work another</font>

311
00:12:55,850 --> 00:12:59,450
<font color="#E5E5E5">problem is that you'll put sensitive</font>

312
00:12:57,650 --> 00:13:02,900
data such<font color="#CCCCCC"> as an account</font><font color="#E5E5E5"> balance or a</font>

313
00:12:59,450 --> 00:13:05,060
<font color="#E5E5E5">user ID token on one</font><font color="#CCCCCC"> of these cards</font><font color="#E5E5E5"> and</font>

314
00:13:02,900 --> 00:13:06,709
then your reader is offline let's say

315
00:13:05,060 --> 00:13:08,900
you're driving<font color="#CCCCCC"> a</font><font color="#E5E5E5"> bus through South Korea</font>

316
00:13:06,710 --> 00:13:11,360
<font color="#CCCCCC">your your</font><font color="#E5E5E5"> network reader doesn't have a</font>

317
00:13:08,900 --> 00:13:14,750
network connection<font color="#CCCCCC"> it has to trust that</font>

318
00:13:11,360 --> 00:13:16,990
the value on the card is correct<font color="#E5E5E5"> until</font>

319
00:13:14,750 --> 00:13:19,510
<font color="#E5E5E5">it can check it so</font>

320
00:13:16,990 --> 00:13:22,200
if it's being<font color="#E5E5E5"> stored without some kind</font>

321
00:13:19,510 --> 00:13:24,819
of<font color="#CCCCCC"> Mack some kind of</font><font color="#E5E5E5"> authentication code</font>

322
00:13:22,200 --> 00:13:26,980
<font color="#E5E5E5">anybody could make it anything they want</font>

323
00:13:24,820 --> 00:13:30,060
and<font color="#CCCCCC"> you have to trust it</font><font color="#E5E5E5"> that's not good</font>

324
00:13:26,980 --> 00:13:32,440
and like<font color="#E5E5E5"> that last note says that's all</font>

325
00:13:30,060 --> 00:13:34,810
<font color="#E5E5E5">basically accepted to deal with the</font>

326
00:13:32,440 --> 00:13:36,279
offline<font color="#E5E5E5"> readers so when I</font><font color="#CCCCCC"> told</font><font color="#E5E5E5"> my boss I</font>

327
00:13:34,810 --> 00:13:38,189
<font color="#CCCCCC">don't want to deal with</font><font color="#E5E5E5"> that and he said</font>

328
00:13:36,279 --> 00:13:41,110
no we had<font color="#CCCCCC"> to come up with a</font><font color="#E5E5E5"> better</font><font color="#CCCCCC"> plant</font>

329
00:13:38,190 --> 00:13:43,959
<font color="#E5E5E5">or a card based attacks on readers this</font>

330
00:13:41,110 --> 00:13:46,540
is fun so you've got all<font color="#CCCCCC"> of your typical</font>

331
00:13:43,959 --> 00:13:48,430
attacks that<font color="#CCCCCC"> you would expect</font><font color="#E5E5E5"> only now</font>

332
00:13:46,540 --> 00:13:51,089
instead<font color="#CCCCCC"> of typing from</font><font color="#E5E5E5"> a keyboard or</font>

333
00:13:48,430 --> 00:13:53,680
dropping a session across a VNC server

334
00:13:51,089 --> 00:13:55,350
<font color="#CCCCCC">you have to write your</font><font color="#E5E5E5"> command to a card</font>

335
00:13:53,680 --> 00:13:58,180
and<font color="#E5E5E5"> then swipe the card on the reader</font>

336
00:13:55,350 --> 00:14:00,250
<font color="#CCCCCC">but then you get fun stuff like sequel</font>

337
00:13:58,180 --> 00:14:03,250
injection<font color="#CCCCCC"> where</font><font color="#E5E5E5"> people are still</font>

338
00:14:00,250 --> 00:14:05,610
dropping<font color="#E5E5E5"> account IDs just</font><font color="#CCCCCC"> their strings</font>

339
00:14:03,250 --> 00:14:08,260
that's that's<font color="#E5E5E5"> awesome I love that stuff</font>

340
00:14:05,610 --> 00:14:10,690
<font color="#E5E5E5">JavaScript injection even if the reader</font>

341
00:14:08,260 --> 00:14:14,050
works<font color="#E5E5E5"> the website that they present you</font>

342
00:14:10,690 --> 00:14:16,800
once you<font color="#E5E5E5"> log in doesn't work it has all</font>

343
00:14:14,050 --> 00:14:19,719
of<font color="#E5E5E5"> the same flaws</font><font color="#CCCCCC"> of every</font><font color="#E5E5E5"> other web app</font>

344
00:14:16,800 --> 00:14:21,699
buffer<font color="#CCCCCC"> overflows</font><font color="#E5E5E5"> I didn't get</font><font color="#CCCCCC"> into the</font>

345
00:14:19,720 --> 00:14:25,209
<font color="#E5E5E5">bottom of the libraries there's Lib free</font>

346
00:14:21,700 --> 00:14:27,339
<font color="#E5E5E5">fare and there's Lib NFC I would be</font>

347
00:14:25,209 --> 00:14:29,079
willing<font color="#CCCCCC"> to bet money that those have</font>

348
00:14:27,339 --> 00:14:33,550
buffer overflows in them and just

349
00:14:29,080 --> 00:14:36,670
<font color="#E5E5E5">nobody's looking at them yet</font><font color="#CCCCCC"> all right</font>

350
00:14:33,550 --> 00:14:40,140
<font color="#E5E5E5">and this was the most fun of any of the</font>

351
00:14:36,670 --> 00:14:40,140
ones I found<font color="#E5E5E5"> was</font>

352
00:14:52,890 --> 00:14:58,569
hi so I was working<font color="#CCCCCC"> on finding reader</font>

353
00:14:56,410 --> 00:15:02,130
software in through one of our

354
00:14:58,570 --> 00:15:13,540
connections they actually<font color="#CCCCCC"> got me set up</font>

355
00:15:02,130 --> 00:15:15,250
to do a test<font color="#E5E5E5"> a reader set and so this is</font>

356
00:15:13,540 --> 00:15:17,230
a very condensed<font color="#CCCCCC"> down version because I</font>

357
00:15:15,250 --> 00:15:19,360
wasn't<font color="#CCCCCC"> allowed to</font><font color="#E5E5E5"> show the actual test</font>

358
00:15:17,230 --> 00:15:20,650
<font color="#E5E5E5">it was going to be very</font><font color="#CCCCCC"> embarrassing for</font>

359
00:15:19,360 --> 00:15:23,980
people<font color="#E5E5E5"> that we don't really want to</font>

360
00:15:20,650 --> 00:15:26,620
embarrass so this is a very condensed

361
00:15:23,980 --> 00:15:28,240
<font color="#E5E5E5">down version</font><font color="#CCCCCC"> I got the card and I logged</font>

362
00:15:26,620 --> 00:15:31,450
in<font color="#CCCCCC"> just like</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> normal user would and it</font>

363
00:15:28,240 --> 00:15:34,660
says welcome to<font color="#E5E5E5"> work bla like okay so I</font>

364
00:15:31,450 --> 00:15:37,060
wrote a utility after about three<font color="#CCCCCC"> hours</font>

365
00:15:34,660 --> 00:15:38,770
called<font color="#CCCCCC"> packed this room it</font><font color="#E5E5E5"> took me about</font>

366
00:15:37,060 --> 00:15:42,250
three<font color="#CCCCCC"> hours to figure out that this was</font>

367
00:15:38,770 --> 00:15:43,900
<font color="#CCCCCC">just a string with ASCII string on it</font><font color="#E5E5E5"> so</font>

368
00:15:42,250 --> 00:15:46,510
I<font color="#E5E5E5"> can dump the string that gives me back</font>

369
00:15:43,900 --> 00:15:49,360
<font color="#CCCCCC">oh hey the</font><font color="#E5E5E5"> same thing it spit out on the</font>

370
00:15:46,510 --> 00:15:51,520
command line<font color="#CCCCCC"> well that's not good let's</font>

371
00:15:49,360 --> 00:15:54,360
<font color="#E5E5E5">see if I have control of that</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> what I</font>

372
00:15:51,520 --> 00:15:56,800
did<font color="#E5E5E5"> was I rewrote through the card using</font>

373
00:15:54,360 --> 00:15:59,680
<font color="#E5E5E5">another utility I put together right to</font>

374
00:15:56,800 --> 00:16:02,680
tag<font color="#E5E5E5"> and I'm gonna put</font><font color="#CCCCCC"> test</font><font color="#E5E5E5"> written on</font>

375
00:15:59,680 --> 00:16:04,810
there<font color="#CCCCCC"> I was weird about</font><font color="#E5E5E5"> this reader is</font>

376
00:16:02,680 --> 00:16:07,150
instead of blanking the card out<font color="#E5E5E5"> with</font>

377
00:16:04,810 --> 00:16:10,569
<font color="#E5E5E5">zeros I had</font><font color="#CCCCCC"> to blank the</font><font color="#E5E5E5"> card out with</font>

378
00:16:07,150 --> 00:16:12,010
space characters so ASCII<font color="#E5E5E5"> 32 that was</font>

379
00:16:10,570 --> 00:16:17,260
actually what clued me in that<font color="#CCCCCC"> it</font><font color="#E5E5E5"> was</font>

380
00:16:12,010 --> 00:16:20,950
<font color="#E5E5E5">using an asking base system so I run the</font>

381
00:16:17,260 --> 00:16:23,500
reader<font color="#E5E5E5"> I'd run the card and hey it tells</font>

382
00:16:20,950 --> 00:16:26,080
me welcome to<font color="#E5E5E5"> word</font><font color="#CCCCCC"> Pastor</font><font color="#E5E5E5"> Chen so now I</font>

383
00:16:23,500 --> 00:16:29,890
know I have control<font color="#CCCCCC"> of at least part</font><font color="#E5E5E5"> of</font>

384
00:16:26,080 --> 00:16:32,410
the display<font color="#E5E5E5"> this part also</font><font color="#CCCCCC"> took</font><font color="#E5E5E5"> several</font>

385
00:16:29,890 --> 00:16:34,600
hours<font color="#E5E5E5"> because I forgot how command</font>

386
00:16:32,410 --> 00:16:37,660
injection works and so I was<font color="#E5E5E5"> running</font>

387
00:16:34,600 --> 00:16:39,390
around like<font color="#CCCCCC"> a new you guys get saved</font>

388
00:16:37,660 --> 00:16:44,530
that and I<font color="#E5E5E5"> just went straight</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> the</font>

389
00:16:39,390 --> 00:16:45,939
<font color="#CCCCCC">commands on this but the</font><font color="#E5E5E5"> first thing</font>

390
00:16:44,530 --> 00:16:49,810
you're always going to do is<font color="#E5E5E5"> just write</font>

391
00:16:45,940 --> 00:16:52,579
a sample string<font color="#E5E5E5"> to see if your commands</font>

392
00:16:49,810 --> 00:17:00,939
are even<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> work</font>

393
00:16:52,579 --> 00:17:00,939
<font color="#E5E5E5">this is what I forgot yeah</font><font color="#CCCCCC"> there you are</font>

394
00:17:03,399 --> 00:17:07,059
semicolon<font color="#CCCCCC"> they'll kill you</font>

395
00:17:07,419 --> 00:17:11,360
<font color="#CCCCCC">alright I'm</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> gonna dump</font><font color="#E5E5E5"> the</font>

396
00:17:09,349 --> 00:17:13,549
environment variables to see what's on

397
00:17:11,359 --> 00:17:16,039
the system and<font color="#CCCCCC"> again this is</font><font color="#E5E5E5"> being done</font>

398
00:17:13,549 --> 00:17:18,109
on<font color="#CCCCCC"> a test system</font><font color="#E5E5E5"> so I already know</font>

399
00:17:16,039 --> 00:17:19,819
what's on there but this<font color="#E5E5E5"> is actually the</font>

400
00:17:18,109 --> 00:17:21,529
<font color="#CCCCCC">method that</font><font color="#E5E5E5"> I used when I dumped the</font>

401
00:17:19,819 --> 00:17:26,178
real<font color="#E5E5E5"> system because I wanted to see what</font>

402
00:17:21,529 --> 00:17:27,859
<font color="#E5E5E5">was in the</font><font color="#CCCCCC"> environment</font><font color="#E5E5E5"> we're gonna dump</font>

403
00:17:26,179 --> 00:17:33,350
it again just<font color="#E5E5E5"> to</font><font color="#CCCCCC"> verify that the</font><font color="#E5E5E5"> right</font>

404
00:17:27,859 --> 00:17:35,178
worked<font color="#E5E5E5"> all right</font><font color="#CCCCCC"> we got</font><font color="#E5E5E5"> our command on</font>

405
00:17:33,350 --> 00:17:39,309
the card<font color="#E5E5E5"> now I walked across the</font>

406
00:17:35,179 --> 00:17:39,309
warehouse<font color="#E5E5E5"> swipe the card on the reader</font>

407
00:17:43,000 --> 00:17:47,360
and there we go we've dumped<font color="#E5E5E5"> the</font>

408
00:17:45,230 --> 00:17:52,399
environment<font color="#CCCCCC"> variable</font><font color="#E5E5E5"> so seeing the</font>

409
00:17:47,360 --> 00:17:55,850
<font color="#CCCCCC">environments cool</font><font color="#E5E5E5"> but once we know that</font>

410
00:17:52,399 --> 00:17:57,379
<font color="#CCCCCC">we</font><font color="#E5E5E5"> have command injection we're gonna do</font>

411
00:17:55,850 --> 00:18:00,500
<font color="#CCCCCC">something much</font><font color="#E5E5E5"> more fun like probably</font>

412
00:17:57,380 --> 00:18:02,649
<font color="#E5E5E5">dump passwords or set up a user</font>

413
00:18:00,500 --> 00:18:05,240
<font color="#E5E5E5">depending on what</font><font color="#CCCCCC"> level we're running at</font>

414
00:18:02,649 --> 00:18:11,510
and we're also going to blame somebody

415
00:18:05,240 --> 00:18:13,340
else<font color="#CCCCCC"> don't want</font><font color="#E5E5E5"> to use your name and now</font>

416
00:18:11,510 --> 00:18:16,789
when I did<font color="#CCCCCC"> this in the</font><font color="#E5E5E5"> live environment</font>

417
00:18:13,340 --> 00:18:18,620
<font color="#CCCCCC">I dumped</font><font color="#E5E5E5"> out the</font><font color="#CCCCCC"> Etsy</font><font color="#E5E5E5"> and I think was</font>

418
00:18:16,789 --> 00:18:20,510
probably<font color="#CCCCCC"> what my boss didn't want me to</font>

419
00:18:18,620 --> 00:18:23,899
<font color="#E5E5E5">show everybody was the password hash</font>

420
00:18:20,510 --> 00:18:25,129
<font color="#E5E5E5">dump so I went and redid it and I put a</font>

421
00:18:23,899 --> 00:18:27,260
different<font color="#E5E5E5"> card on there</font>

422
00:18:25,130 --> 00:18:39,919
or a<font color="#E5E5E5"> different file that will</font><font color="#CCCCCC"> be more</font>

423
00:18:27,260 --> 00:18:43,330
acceptable verify the dump<font color="#CCCCCC"> again alright</font>

424
00:18:39,919 --> 00:18:43,330
let's walk<font color="#CCCCCC"> over and</font>

425
00:18:44,669 --> 00:18:53,519
<font color="#E5E5E5">wipe our card game</font><font color="#CCCCCC"> over we have control</font>

426
00:18:47,519 --> 00:18:55,230
of the reader so it takes longer<font color="#E5E5E5"> because</font>

427
00:18:53,519 --> 00:18:57,450
<font color="#E5E5E5">you don't get to just sit</font><font color="#CCCCCC"> down</font><font color="#E5E5E5"> and type</font>

428
00:18:55,230 --> 00:18:59,100
in commands<font color="#E5E5E5"> you have to physically</font><font color="#CCCCCC"> walk</font>

429
00:18:57,450 --> 00:19:02,509
over and interact with<font color="#E5E5E5"> the reader</font>

430
00:18:59,100 --> 00:19:05,070
<font color="#E5E5E5">hardware but beyond that one difference</font>

431
00:19:02,509 --> 00:19:08,789
command injection<font color="#E5E5E5"> works pretty</font><font color="#CCCCCC"> much the</font>

432
00:19:05,070 --> 00:19:12,269
<font color="#CCCCCC">same with an rfid reader as it does with</font>

433
00:19:08,789 --> 00:19:13,590
any<font color="#E5E5E5"> other system all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so now that</font>

434
00:19:12,269 --> 00:19:16,919
<font color="#E5E5E5">we've talked about all the stuff that</font>

435
00:19:13,590 --> 00:19:20,488
<font color="#E5E5E5">was broken</font><font color="#CCCCCC"> how we got fix it so any dual</font>

436
00:19:16,919 --> 00:19:22,259
core fans here<font color="#E5E5E5"> yeah all right so rule</font>

437
00:19:20,489 --> 00:19:25,799
number<font color="#E5E5E5"> six</font><font color="#CCCCCC"> has encrypt all the things</font>

438
00:19:22,259 --> 00:19:27,239
you take your bytes off the record to do

439
00:19:25,799 --> 00:19:29,039
that we're going<font color="#E5E5E5"> to use a bunch of</font>

440
00:19:27,239 --> 00:19:30,960
<font color="#CCCCCC">different keys because</font><font color="#E5E5E5"> one key doesn't</font>

441
00:19:29,039 --> 00:19:33,299
really work anymore<font color="#E5E5E5"> one Keys breakable</font>

442
00:19:30,960 --> 00:19:36,389
so this<font color="#E5E5E5"> gets back to</font><font color="#CCCCCC"> that password-based</font>

443
00:19:33,299 --> 00:19:39,418
key derivation<font color="#CCCCCC"> function on the left here</font>

444
00:19:36,389 --> 00:19:41,508
<font color="#E5E5E5">we've got mr. user mr. user gives us the</font>

445
00:19:39,419 --> 00:19:44,489
awesome password I like football

446
00:19:41,509 --> 00:19:47,129
<font color="#E5E5E5">exclamation</font><font color="#CCCCCC"> point and you see by the</font>

447
00:19:44,489 --> 00:19:49,139
shape<font color="#CCCCCC"> of</font><font color="#E5E5E5"> that that's really it's a</font>

448
00:19:47,129 --> 00:19:53,219
<font color="#E5E5E5">little bit</font><font color="#CCCCCC"> jagged but it's still pretty</font>

449
00:19:49,139 --> 00:19:55,049
predictable<font color="#CCCCCC"> in uniform</font><font color="#E5E5E5"> the host</font><font color="#CCCCCC"> OS the</font>

450
00:19:53,220 --> 00:19:58,799
system that mr. user is running

451
00:19:55,049 --> 00:20:02,879
gives us a 256 pseudo-random salt that's

452
00:19:58,799 --> 00:20:05,730
32<font color="#E5E5E5"> bytes and that salt gets saved into</font>

453
00:20:02,879 --> 00:20:07,998
<font color="#E5E5E5">the master account storage</font><font color="#CCCCCC"> Basin coded</font>

454
00:20:05,730 --> 00:20:11,009
the passwords not saved anywhere ever

455
00:20:07,999 --> 00:20:12,359
all right both those two pieces<font color="#E5E5E5"> get fed</font>

456
00:20:11,009 --> 00:20:15,899
into the password-based key derivation

457
00:20:12,359 --> 00:20:18,480
<font color="#E5E5E5">function that was really cool is that</font><font color="#CCCCCC"> n</font>

458
00:20:15,899 --> 00:20:22,199
parameter is how many times it's<font color="#CCCCCC"> going</font>

459
00:20:18,480 --> 00:20:23,220
to be cycled<font color="#E5E5E5"> through</font><font color="#CCCCCC"> and the point of</font>

460
00:20:22,200 --> 00:20:25,859
the password-based key derivation

461
00:20:23,220 --> 00:20:28,499
<font color="#E5E5E5">function isn't to keep your key from</font>

462
00:20:25,859 --> 00:20:30,449
getting cracked<font color="#CCCCCC"> it's to make it take</font><font color="#E5E5E5"> a</font>

463
00:20:28,499 --> 00:20:31,350
<font color="#E5E5E5">lot longer</font><font color="#CCCCCC"> for an attacker to</font>

464
00:20:30,450 --> 00:20:34,590
<font color="#CCCCCC">brute-force</font>

465
00:20:31,350 --> 00:20:37,199
<font color="#E5E5E5">so you set that</font><font color="#CCCCCC"> n parameter as high</font><font color="#E5E5E5"> as</font>

466
00:20:34,590 --> 00:20:39,689
you<font color="#E5E5E5"> can make it</font><font color="#CCCCCC"> on your software so</font><font color="#E5E5E5"> that</font>

467
00:20:37,200 --> 00:20:43,919
somebody trying<font color="#CCCCCC"> to brute force I like</font>

468
00:20:39,690 --> 00:20:47,159
football<font color="#E5E5E5"> has to get the salt guess the</font>

469
00:20:43,919 --> 00:20:50,399
<font color="#CCCCCC">password and run it through n numbers of</font>

470
00:20:47,159 --> 00:20:53,009
<font color="#E5E5E5">this encryption algorithm so if you set</font>

471
00:20:50,399 --> 00:20:55,738
<font color="#E5E5E5">N</font><font color="#CCCCCC"> to something</font><font color="#E5E5E5"> like 400,000 that</font><font color="#CCCCCC"> means</font>

472
00:20:53,009 --> 00:20:57,480
<font color="#CCCCCC">forever guess they have to run 400,000</font>

473
00:20:55,739 --> 00:21:00,299
derivations of this

474
00:20:57,480 --> 00:21:03,450
function<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> and that generates a</font>

475
00:21:00,299 --> 00:21:05,070
master key now<font color="#E5E5E5"> for those</font><font color="#CCCCCC"> of you from</font><font color="#E5E5E5"> the</font>

476
00:21:03,450 --> 00:21:07,290
<font color="#CCCCCC">Kerberos world you might</font><font color="#E5E5E5"> know this or</font>

477
00:21:05,070 --> 00:21:09,330
call this<font color="#E5E5E5"> a key generating key because</font>

478
00:21:07,290 --> 00:21:12,000
it doesn't<font color="#CCCCCC"> actually grant</font><font color="#E5E5E5"> anything it's</font>

479
00:21:09,330 --> 00:21:15,510
simply used for grant<font color="#E5E5E5"> or for generating</font>

480
00:21:12,000 --> 00:21:17,400
<font color="#E5E5E5">keys which will be used for granting all</font>

481
00:21:15,510 --> 00:21:20,790
right let's look<font color="#E5E5E5"> at that so this is</font><font color="#CCCCCC"> the</font>

482
00:21:17,400 --> 00:21:23,610
<font color="#CCCCCC">data Keys and</font><font color="#E5E5E5"> the tag update function so</font>

483
00:21:20,790 --> 00:21:27,809
for<font color="#CCCCCC"> each tag</font><font color="#E5E5E5"> you're</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> generate a new</font>

484
00:21:23,610 --> 00:21:31,409
key<font color="#E5E5E5"> and that key has also its own 32</font>

485
00:21:27,809 --> 00:21:33,809
byte or 256 pseudo-random salt that<font color="#CCCCCC"> also</font>

486
00:21:31,410 --> 00:21:36,330
gets stored off with the tag<font color="#E5E5E5"> but that</font>

487
00:21:33,809 --> 00:21:40,590
salt is stored encrypted<font color="#E5E5E5"> and it's</font>

488
00:21:36,330 --> 00:21:43,230
encrypted<font color="#E5E5E5"> with</font><font color="#CCCCCC"> the master key so then</font>

489
00:21:40,590 --> 00:21:44,639
that goes through a whole second round

490
00:21:43,230 --> 00:21:47,580
of the password-based key derivation

491
00:21:44,640 --> 00:21:49,770
function<font color="#E5E5E5"> down in the left corner</font><font color="#CCCCCC"> you can</font>

492
00:21:47,580 --> 00:21:52,379
set<font color="#E5E5E5"> it different</font><font color="#CCCCCC"> N</font><font color="#E5E5E5"> or just use a sub the</font>

493
00:21:49,770 --> 00:21:54,330
same hand<font color="#CCCCCC"> but what</font><font color="#E5E5E5"> that will spit out</font>

494
00:21:52,380 --> 00:21:56,850
for you is<font color="#CCCCCC"> actually the data</font><font color="#E5E5E5"> encryption</font>

495
00:21:54,330 --> 00:21:58,379
key you take the data<font color="#E5E5E5"> encryption key you</font>

496
00:21:56,850 --> 00:22:00,389
take the tag data that you want<font color="#E5E5E5"> to</font>

497
00:21:58,380 --> 00:22:03,000
encrypt<font color="#E5E5E5"> and you'll put</font><font color="#CCCCCC"> that through</font><font color="#E5E5E5"> the</font>

498
00:22:00,390 --> 00:22:04,740
AES encryption<font color="#E5E5E5"> that will spit out</font><font color="#CCCCCC"> your</font>

499
00:22:03,000 --> 00:22:09,780
tag block that<font color="#E5E5E5"> gets written</font><font color="#CCCCCC"> to the tag</font>

500
00:22:04,740 --> 00:22:11,940
<font color="#E5E5E5">everybody follow no questions awesome so</font>

501
00:22:09,780 --> 00:22:13,980
let's<font color="#CCCCCC"> look at the</font><font color="#E5E5E5"> memory layout now this</font>

502
00:22:11,940 --> 00:22:16,200
is shortened that's what the<font color="#CCCCCC"> 3</font>

503
00:22:13,980 --> 00:22:18,299
illiteracy dots<font color="#CCCCCC"> there mean so we're</font>

504
00:22:16,200 --> 00:22:20,100
looking<font color="#CCCCCC"> this is a typical memory</font><font color="#E5E5E5"> layout</font>

505
00:22:18,299 --> 00:22:23,610
so your lower memory address is at the

506
00:22:20,100 --> 00:22:28,949
<font color="#E5E5E5">bottom</font><font color="#CCCCCC"> on the right and it works its way</font>

507
00:22:23,610 --> 00:22:31,678
up<font color="#E5E5E5"> the blue</font><font color="#CCCCCC"> at block is</font><font color="#E5E5E5"> 0 there that is</font>

508
00:22:28,950 --> 00:22:36,020
the reserved manufacturer so we can't

509
00:22:31,679 --> 00:22:42,049
use that<font color="#E5E5E5"> also the yellow blocks are</font>

510
00:22:36,020 --> 00:22:45,750
reserved for<font color="#E5E5E5"> the access control keys so</font>

511
00:22:42,049 --> 00:22:47,970
each of<font color="#E5E5E5"> these blocks has two small</font>

512
00:22:45,750 --> 00:22:50,880
cryptographic keys associated with it

513
00:22:47,970 --> 00:22:53,669
<font color="#E5E5E5">that's how the crypto</font><font color="#CCCCCC"> 1 protocol worked</font>

514
00:22:50,880 --> 00:22:57,210
<font color="#E5E5E5">those keys are stored at</font><font color="#CCCCCC"> the end of each</font>

515
00:22:53,669 --> 00:23:00,330
block all the<font color="#CCCCCC"> way up</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> are ways</font>

516
00:22:57,210 --> 00:23:02,250
<font color="#E5E5E5">you can use it but</font><font color="#CCCCCC"> ultimately you can</font>

517
00:23:00,330 --> 00:23:03,480
break your<font color="#E5E5E5"> cards that way so I chose</font><font color="#CCCCCC"> not</font>

518
00:23:02,250 --> 00:23:06,659
to use<font color="#E5E5E5"> them and I just</font><font color="#CCCCCC"> count them as</font>

519
00:23:03,480 --> 00:23:09,390
dead space<font color="#E5E5E5"> all right and then the two</font>

520
00:23:06,659 --> 00:23:10,390
<font color="#E5E5E5">purple sets of blocks up top</font>

521
00:23:09,390 --> 00:23:12,670
are going<font color="#CCCCCC"> to</font>

522
00:23:10,390 --> 00:23:18,540
hold a hash<font color="#CCCCCC"> when we're done</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that's</font>

523
00:23:12,670 --> 00:23:20,680
<font color="#E5E5E5">going to be</font><font color="#CCCCCC"> VH Mack 32-byte sha-256 hash</font>

524
00:23:18,540 --> 00:23:22,690
<font color="#CCCCCC">alright so if you look on the right-hand</font>

525
00:23:20,680 --> 00:23:26,110
<font color="#CCCCCC">side I kind of worked out the math for</font>

526
00:23:22,690 --> 00:23:27,760
<font color="#E5E5E5">how much space you can</font><font color="#CCCCCC"> actually fit</font><font color="#E5E5E5"> once</font>

527
00:23:26,110 --> 00:23:30,490
you take<font color="#CCCCCC"> away all the crap that they</font>

528
00:23:27,760 --> 00:23:32,440
take<font color="#E5E5E5"> from you so 64 blocks</font><font color="#CCCCCC"> minus sixteen</font>

529
00:23:30,490 --> 00:23:34,930
trailer is minus one manufacturer and

530
00:23:32,440 --> 00:23:35,560
two blocks for<font color="#E5E5E5"> the hash gives you</font><font color="#CCCCCC"> 45</font>

531
00:23:34,930 --> 00:23:39,010
blocks

532
00:23:35,560 --> 00:23:41,590
<font color="#E5E5E5">16 bytes per block that's 720 useable</font>

533
00:23:39,010 --> 00:23:44,379
bytes<font color="#E5E5E5"> all right so now that we</font><font color="#CCCCCC"> know how</font>

534
00:23:41,590 --> 00:23:48,340
<font color="#E5E5E5">much information we can fit let's see</font>

535
00:23:44,380 --> 00:23:51,310
what we<font color="#E5E5E5"> can do to protect it so in</font>

536
00:23:48,340 --> 00:23:52,959
<font color="#E5E5E5">writing this I looked for a library for</font>

537
00:23:51,310 --> 00:23:56,530
my<font color="#CCCCCC"> fare that</font><font color="#E5E5E5"> supported AES encryption</font>

538
00:23:52,960 --> 00:23:59,620
<font color="#E5E5E5">and I didn't find it</font><font color="#CCCCCC"> so what I did</font><font color="#E5E5E5"> find</font>

539
00:23:56,530 --> 00:24:01,149
<font color="#E5E5E5">was one for the Raspberry Pi</font><font color="#CCCCCC"> that</font>

540
00:23:59,620 --> 00:24:04,810
supported the hardware<font color="#CCCCCC"> that I was using</font>

541
00:24:01,150 --> 00:24:07,780
the RC<font color="#E5E5E5"> 522</font><font color="#CCCCCC"> but it didn't support</font>

542
00:24:04,810 --> 00:24:12,399
<font color="#E5E5E5">encryption so I took the library and I</font>

543
00:24:07,780 --> 00:24:14,050
added<font color="#E5E5E5"> an RF crypto cipher suite to it so</font>

544
00:24:12,400 --> 00:24:18,430
<font color="#E5E5E5">that way</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> will handle all of your</font><font color="#CCCCCC"> a</font>

545
00:24:14,050 --> 00:24:20,169
<font color="#E5E5E5">EES 128 and then I just appended an</font><font color="#CCCCCC"> S to</font>

546
00:24:18,430 --> 00:24:22,690
it and at first<font color="#E5E5E5"> I</font><font color="#CCCCCC"> was</font><font color="#E5E5E5"> gonna say</font><font color="#CCCCCC"> S is</font><font color="#E5E5E5"> for</font>

547
00:24:20,170 --> 00:24:24,910
<font color="#E5E5E5">secure but that's retarded which is then</font>

548
00:24:22,690 --> 00:24:26,560
people<font color="#E5E5E5"> will go break it so f is just for</font>

549
00:24:24,910 --> 00:24:27,940
safer it's safer<font color="#CCCCCC"> to use</font><font color="#E5E5E5"> one that</font>

550
00:24:26,560 --> 00:24:31,600
supports encryption than one that

551
00:24:27,940 --> 00:24:34,140
doesn't<font color="#E5E5E5"> right that's a valid claim all</font>

552
00:24:31,600 --> 00:24:37,030
<font color="#E5E5E5">right and then they were using a utility</font>

553
00:24:34,140 --> 00:24:38,980
write function to the card and<font color="#E5E5E5"> so I just</font>

554
00:24:37,030 --> 00:24:41,470
rather than making<font color="#E5E5E5"> a whole set of</font>

555
00:24:38,980 --> 00:24:43,180
encrypted load functions I just

556
00:24:41,470 --> 00:24:45,250
piggyback theirs and say if you throw

557
00:24:43,180 --> 00:24:48,370
encrypted<font color="#E5E5E5"> and true in there it will do</font>

558
00:24:45,250 --> 00:24:50,590
it so and<font color="#E5E5E5"> then you till</font><font color="#CCCCCC"> don't decrypt it</font>

559
00:24:48,370 --> 00:24:53,139
they didn't even have<font color="#E5E5E5"> an actual card</font>

560
00:24:50,590 --> 00:24:55,300
dump<font color="#E5E5E5"> thing on there to get back to the</font>

561
00:24:53,140 --> 00:24:57,820
<font color="#E5E5E5">memory it would just print it out to the</font>

562
00:24:55,300 --> 00:24:59,409
command<font color="#E5E5E5"> line so I added a dump decrypted</font>

563
00:24:57,820 --> 00:25:02,139
which will return<font color="#CCCCCC"> the memory as an</font>

564
00:24:59,410 --> 00:25:06,060
object for<font color="#CCCCCC"> you to play</font><font color="#E5E5E5"> with that's up on</font>

565
00:25:02,140 --> 00:25:08,650
my github now you can pull the<font color="#E5E5E5"> PR</font><font color="#CCCCCC"> RC</font><font color="#E5E5E5"> 522</font>

566
00:25:06,060 --> 00:25:11,889
library and it will have<font color="#CCCCCC"> all of the RF</font>

567
00:25:08,650 --> 00:25:14,940
crypto stuff<font color="#CCCCCC"> in there all right</font><font color="#E5E5E5"> so let's</font>

568
00:25:11,890 --> 00:25:14,940
see this crypto demo

569
00:25:39,740 --> 00:25:45,600
<font color="#E5E5E5">all right so this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> the third of</font><font color="#CCCCCC"> the</font>

570
00:25:43,559 --> 00:25:48,480
utilities that<font color="#CCCCCC"> I wrote which is a tag</font>

571
00:25:45,600 --> 00:25:50,010
dump<font color="#CCCCCC"> and it just doesn't memory dump but</font>

572
00:25:48,480 --> 00:25:52,470
it cleans it<font color="#E5E5E5"> up nice and pretty</font>

573
00:25:50,010 --> 00:25:54,150
lowest<font color="#CCCCCC"> addresses on the bottom</font><font color="#E5E5E5"> so it</font>

574
00:25:52,470 --> 00:25:58,770
matches<font color="#CCCCCC"> the memory map that I showed you</font>

575
00:25:54,150 --> 00:26:00,450
<font color="#CCCCCC">before</font><font color="#E5E5E5"> well dump it to</font><font color="#CCCCCC"> a string show</font>

576
00:25:58,770 --> 00:26:02,668
that there's nothing<font color="#E5E5E5"> on there right now</font>

577
00:26:00,450 --> 00:26:07,500
<font color="#E5E5E5">just so you know I'm not trying</font><font color="#CCCCCC"> to pull</font>

578
00:26:02,669 --> 00:26:10,140
an illusion<font color="#E5E5E5"> on you all right so I did</font>

579
00:26:07,500 --> 00:26:12,480
<font color="#CCCCCC">release a crypto example but it just</font>

580
00:26:10,140 --> 00:26:14,490
kind of took<font color="#E5E5E5"> an object and encrypted and</font>

581
00:26:12,480 --> 00:26:16,350
decrypted it so then for you guys I

582
00:26:14,490 --> 00:26:18,570
wrote the better crypto example which

583
00:26:16,350 --> 00:26:20,969
<font color="#E5E5E5">got all these options we can download it</font>

584
00:26:18,570 --> 00:26:23,820
from a file<font color="#E5E5E5"> we can do a raw</font><font color="#CCCCCC"> string</font><font color="#E5E5E5"> and</font>

585
00:26:20,970 --> 00:26:25,549
in<font color="#CCCCCC"> password based so I'm just</font><font color="#E5E5E5"> going to</font>

586
00:26:23,820 --> 00:26:32,100
do a string<font color="#E5E5E5"> from the command line</font><font color="#CCCCCC"> here</font>

587
00:26:25,549 --> 00:26:37,040
hello besides now I'm<font color="#E5E5E5"> entering the</font>

588
00:26:32,100 --> 00:26:37,040
password<font color="#CCCCCC"> you</font><font color="#E5E5E5"> should always use get pass</font>

589
00:26:41,000 --> 00:26:44,480
<font color="#CCCCCC">so</font><font color="#E5E5E5"> it takes a minute because it's</font>

590
00:26:42,470 --> 00:26:59,650
actually<font color="#CCCCCC"> doing the encryption at this</font>

591
00:26:44,480 --> 00:27:02,720
point there we go we<font color="#CCCCCC"> got the new bytes</font>

592
00:26:59,650 --> 00:27:03,700
<font color="#E5E5E5">now I'm going to remove the tag press</font>

593
00:27:02,720 --> 00:27:11,570
<font color="#CCCCCC">Enter</font>

594
00:27:03,700 --> 00:27:15,760
rescan<font color="#E5E5E5"> the</font><font color="#CCCCCC"> tip re-enter</font><font color="#E5E5E5"> the password</font>

595
00:27:11,570 --> 00:27:15,760
because<font color="#E5E5E5"> the passwords not saved anywhere</font>

596
00:27:24,760 --> 00:27:30,559
and there we go we've got<font color="#E5E5E5"> it recovered</font>

597
00:27:28,030 --> 00:27:34,100
hello<font color="#CCCCCC"> b-sides so we know we</font><font color="#E5E5E5"> can do a</font>

598
00:27:30,559 --> 00:27:35,990
<font color="#CCCCCC">successful decryption now let's see what</font>

599
00:27:34,100 --> 00:27:39,070
it looks<font color="#CCCCCC"> like on</font><font color="#E5E5E5"> the card we're gonna go</font>

600
00:27:35,990 --> 00:27:39,070
use the<font color="#CCCCCC"> tag dump again</font>

601
00:27:48,720 --> 00:27:53,200
<font color="#E5E5E5">all right you see we've got</font><font color="#CCCCCC"> the blocks</font>

602
00:27:51,130 --> 00:27:58,559
<font color="#E5E5E5">written down</font><font color="#CCCCCC"> there the cards no longer</font>

603
00:27:53,200 --> 00:28:01,780
<font color="#CCCCCC">empty</font><font color="#E5E5E5"> all right so now we're gonna do</font>

604
00:27:58,559 --> 00:28:03,879
<font color="#E5E5E5">after</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> fat finger type this we're going</font>

605
00:28:01,780 --> 00:28:06,100
<font color="#E5E5E5">to do a second</font><font color="#CCCCCC"> example and</font><font color="#E5E5E5"> I'll tell you</font>

606
00:28:03,880 --> 00:28:25,900
why in a minute<font color="#CCCCCC"> but bear with me we're</font>

607
00:28:06,100 --> 00:28:27,820
<font color="#E5E5E5">going to show off another way so</font><font color="#CCCCCC"> we're</font>

608
00:28:25,900 --> 00:28:32,170
going to dump<font color="#E5E5E5"> this is a</font><font color="#CCCCCC"> wholly separate</font>

609
00:28:27,820 --> 00:28:34,149
tag at this point<font color="#CCCCCC"> dump</font><font color="#E5E5E5"> it empty you're</font>

610
00:28:32,170 --> 00:28:38,970
going to go through the same process<font color="#CCCCCC"> of</font>

611
00:28:34,150 --> 00:28:43,710
writing<font color="#E5E5E5"> the encrypted data</font><font color="#CCCCCC"> I promise</font>

612
00:28:38,970 --> 00:28:43,710
there's a<font color="#E5E5E5"> reason why I'm showing you to</font>

613
00:28:45,390 --> 00:28:51,870
enter a<font color="#E5E5E5"> password</font><font color="#CCCCCC"> into the</font><font color="#E5E5E5"> string now I'm</font>

614
00:28:49,300 --> 00:28:54,250
doing<font color="#E5E5E5"> it from</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> command line</font><font color="#CCCCCC"> but uh</font>

615
00:28:51,870 --> 00:28:56,530
this<font color="#E5E5E5"> is just another option in the</font>

616
00:28:54,250 --> 00:28:57,940
program that I had wrote the point is

617
00:28:56,530 --> 00:28:59,678
that the string I'm using is

618
00:28:57,940 --> 00:29:07,390
considerably longer<font color="#CCCCCC"> than</font><font color="#E5E5E5"> the previous</font>

619
00:28:59,679 --> 00:29:09,960
hello<font color="#CCCCCC"> besides</font><font color="#E5E5E5"> rebel base is in fact in</font>

620
00:29:07,390 --> 00:29:09,960
<font color="#E5E5E5">the North Mountain</font>

621
00:29:16,530 --> 00:29:23,678
now as this goes through<font color="#E5E5E5"> and</font><font color="#CCCCCC"> it's doing</font>

622
00:29:21,490 --> 00:29:27,490
the AES encryption<font color="#E5E5E5"> it's still got to</font><font color="#CCCCCC"> use</font>

623
00:29:23,679 --> 00:29:29,650
the crypto<font color="#E5E5E5"> one encryption to speak back</font>

624
00:29:27,490 --> 00:29:31,780
and forth to the card<font color="#CCCCCC"> so this</font><font color="#E5E5E5"> is</font>

625
00:29:29,650 --> 00:29:34,929
actually that's why<font color="#CCCCCC"> this takes so much</font>

626
00:29:31,780 --> 00:29:37,240
longer<font color="#CCCCCC"> than you</font><font color="#E5E5E5"> would expect</font><font color="#CCCCCC"> and then it</font>

627
00:29:34,929 --> 00:29:39,580
writes it out<font color="#E5E5E5"> to the card we're going to</font>

628
00:29:37,240 --> 00:29:41,910
recover it make sure<font color="#CCCCCC"> our encryption</font>

629
00:29:39,580 --> 00:29:41,909
<font color="#E5E5E5">works</font>

630
00:29:44,410 --> 00:29:47,499
[Music]

631
00:29:48,130 --> 00:29:57,200
<font color="#E5E5E5">all right there you go we've got it</font>

632
00:29:52,490 --> 00:29:59,060
decrypted so excellent<font color="#E5E5E5"> now the reason I</font>

633
00:29:57,200 --> 00:30:03,860
made you watch<font color="#E5E5E5"> two of those instead</font><font color="#CCCCCC"> of</font>

634
00:29:59,060 --> 00:30:10,100
just one did anybody notice the longer

635
00:30:03,860 --> 00:30:14,889
string<font color="#E5E5E5"> so the longer string of the two</font>

636
00:30:10,100 --> 00:30:17,929
is<font color="#E5E5E5"> going to create a much longer text so</font>

637
00:30:14,890 --> 00:30:20,000
a couple improvements so<font color="#CCCCCC"> that we can</font>

638
00:30:17,930 --> 00:30:23,630
make our<font color="#CCCCCC"> incursion scheme better what I</font>

639
00:30:20,000 --> 00:30:26,090
did there didn't include the<font color="#CCCCCC"> H Mac</font><font color="#E5E5E5"> so</font>

640
00:30:23,630 --> 00:30:29,270
there was no hash at the end of the data

641
00:30:26,090 --> 00:30:35,480
<font color="#E5E5E5">we can add that we can use the CBC mode</font>

642
00:30:29,270 --> 00:30:38,560
<font color="#E5E5E5">H Mac or you can use in</font><font color="#CCCCCC"> open</font><font color="#E5E5E5"> SSL they</font>

643
00:30:35,480 --> 00:30:42,080
have GCM<font color="#E5E5E5"> wishes the</font><font color="#CCCCCC"> glories counter mode</font>

644
00:30:38,560 --> 00:30:44,270
<font color="#CCCCCC">and there are a couple other ones out</font>

645
00:30:42,080 --> 00:30:46,669
there<font color="#CCCCCC"> but we have</font><font color="#E5E5E5"> we support</font>

646
00:30:44,270 --> 00:30:50,900
authenticated encryption modes now so we

647
00:30:46,670 --> 00:30:55,130
should<font color="#CCCCCC"> be</font><font color="#E5E5E5"> out using them yeah and then</font>

648
00:30:50,900 --> 00:30:57,890
never ever compute the Mac on<font color="#CCCCCC"> the</font>

649
00:30:55,130 --> 00:30:58,790
plaintext<font color="#E5E5E5"> that leaks information about</font>

650
00:30:57,890 --> 00:31:00,920
the plaintext

651
00:30:58,790 --> 00:31:03,889
you always encrypt it<font color="#E5E5E5"> and then you</font>

652
00:31:00,920 --> 00:31:07,340
create the H<font color="#E5E5E5"> Mac off of the encrypted</font>

653
00:31:03,890 --> 00:31:10,700
data<font color="#E5E5E5"> all right so we talked a little bit</font>

654
00:31:07,340 --> 00:31:12,830
earlier<font color="#CCCCCC"> about</font><font color="#E5E5E5"> using the encrypted tags</font>

655
00:31:10,700 --> 00:31:16,010
and then decrypting them in searching

656
00:31:12,830 --> 00:31:18,260
the<font color="#E5E5E5"> database that's just silly so let's</font>

657
00:31:16,010 --> 00:31:20,840
talk<font color="#E5E5E5"> about using encrypted searches on</font>

658
00:31:18,260 --> 00:31:24,940
encrypted databases and you've got<font color="#CCCCCC"> mr.</font>

659
00:31:20,840 --> 00:31:24,939
<font color="#E5E5E5">user down there he wants</font><font color="#CCCCCC"> to search for</font>

660
00:31:25,690 --> 00:31:31,880
love<font color="#CCCCCC"> Windows updates he wants to search</font>

661
00:31:28,850 --> 00:31:36,110
for a<font color="#E5E5E5"> new Windows Update called ABC</font><font color="#CCCCCC"> No</font>

662
00:31:31,880 --> 00:31:37,580
so he's going<font color="#CCCCCC"> to type in his search ABC</font>

663
00:31:36,110 --> 00:31:40,280
<font color="#E5E5E5">which is then encrypted with</font><font color="#CCCCCC"> the</font>

664
00:31:37,580 --> 00:31:43,010
database<font color="#CCCCCC"> password</font><font color="#E5E5E5"> the database uses the</font>

665
00:31:40,280 --> 00:31:45,290
encrypted<font color="#E5E5E5"> value to search its encrypted</font>

666
00:31:43,010 --> 00:31:47,330
keys and sends back<font color="#CCCCCC"> an encrypted</font><font color="#E5E5E5"> were</font>

667
00:31:45,290 --> 00:31:50,780
result which gets decrypted and<font color="#E5E5E5"> given to</font>

668
00:31:47,330 --> 00:31:53,090
mr. user so that's all super well and

669
00:31:50,780 --> 00:31:54,530
<font color="#E5E5E5">good it involves a whole</font><font color="#CCCCCC"> nother key that</font>

670
00:31:53,090 --> 00:31:58,199
we're going<font color="#E5E5E5"> to use called the database</font>

671
00:31:54,530 --> 00:32:00,420
key and this is<font color="#CCCCCC"> basically becoming what</font>

672
00:31:58,200 --> 00:32:02,220
<font color="#E5E5E5">our update</font><font color="#CCCCCC"> flowchart looks like I am</font>

673
00:32:00,420 --> 00:32:05,070
addicted<font color="#CCCCCC"> to flowcharts I love them I</font>

674
00:32:02,220 --> 00:32:07,680
<font color="#E5E5E5">think they</font><font color="#CCCCCC"> stop errors</font><font color="#E5E5E5"> so if you look</font>

675
00:32:05,070 --> 00:32:09,870
we've got you can<font color="#E5E5E5"> basically</font><font color="#CCCCCC"> ignore the</font>

676
00:32:07,680 --> 00:32:12,690
top block with all the variables<font color="#E5E5E5"> they're</font>

677
00:32:09,870 --> 00:32:15,409
just basically<font color="#E5E5E5"> laying out the sizes of</font>

678
00:32:12,690 --> 00:32:19,620
<font color="#E5E5E5">things like the tag ID the hash value</font>

679
00:32:15,410 --> 00:32:22,020
<font color="#CCCCCC">the data block</font><font color="#E5E5E5"> so what is going to</font><font color="#CCCCCC"> do is</font>

680
00:32:19,620 --> 00:32:24,929
it's going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> take the tag reference</font>

681
00:32:22,020 --> 00:32:30,600
which the tag reference is<font color="#E5E5E5"> the tag ID</font>

682
00:32:24,930 --> 00:32:33,180
and a<font color="#E5E5E5"> secret hash and creates this from</font>

683
00:32:30,600 --> 00:32:36,179
the<font color="#CCCCCC"> database and it goes and</font><font color="#E5E5E5"> it searches</font>

684
00:32:33,180 --> 00:32:38,340
<font color="#CCCCCC">for this encrypted value so if you're</font>

685
00:32:36,180 --> 00:32:40,890
watching on the wire<font color="#CCCCCC"> you don't get to</font>

686
00:32:38,340 --> 00:32:44,250
see the tag ID<font color="#E5E5E5"> you only get to see an</font>

687
00:32:40,890 --> 00:32:46,770
encrypted search<font color="#E5E5E5"> value the on the</font>

688
00:32:44,250 --> 00:32:50,520
database side since<font color="#E5E5E5"> you know it's fairly</font>

689
00:32:46,770 --> 00:32:52,980
<font color="#E5E5E5">common to search by tag UID you create</font>

690
00:32:50,520 --> 00:32:56,070
another field in your database<font color="#E5E5E5"> which</font><font color="#CCCCCC"> has</font>

691
00:32:52,980 --> 00:32:58,440
the encrypted<font color="#E5E5E5"> tag UID as an indexed</font>

692
00:32:56,070 --> 00:32:59,939
field for search<font color="#CCCCCC"> you no longer have to</font>

693
00:32:58,440 --> 00:33:02,730
<font color="#E5E5E5">send your plaintext tag information</font>

694
00:32:59,940 --> 00:33:05,910
<font color="#CCCCCC">across</font><font color="#E5E5E5"> all right so we'll check first</font>

695
00:33:02,730 --> 00:33:09,270
<font color="#E5E5E5">just to see if that initial check works</font>

696
00:33:05,910 --> 00:33:11,280
and if it can find that it<font color="#E5E5E5"> looks up the</font>

697
00:33:09,270 --> 00:33:14,129
two keys that<font color="#CCCCCC"> are associated with the</font>

698
00:33:11,280 --> 00:33:16,800
tag that's the<font color="#E5E5E5"> tag key and the hash key</font>

699
00:33:14,130 --> 00:33:21,210
that's used<font color="#E5E5E5"> for generating the H Mac if</font>

700
00:33:16,800 --> 00:33:23,460
it can pull both<font color="#CCCCCC"> of</font><font color="#E5E5E5"> those back it will</font>

701
00:33:21,210 --> 00:33:26,940
continue down the<font color="#E5E5E5"> left-hand side and if</font>

702
00:33:23,460 --> 00:33:28,890
it fails<font color="#CCCCCC"> at either</font><font color="#E5E5E5"> of those checks you</font>

703
00:33:26,940 --> 00:33:30,930
can brick<font color="#E5E5E5"> attack so</font><font color="#CCCCCC"> you can just</font>

704
00:33:28,890 --> 00:33:33,690
overwrite the memory so<font color="#CCCCCC"> that none of the</font>

705
00:33:30,930 --> 00:33:35,730
sectors<font color="#E5E5E5"> are readable</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> I've heard</font>

706
00:33:33,690 --> 00:33:38,760
<font color="#E5E5E5">that there are ways to undo that but I</font>

707
00:33:35,730 --> 00:33:41,190
have not<font color="#E5E5E5"> actually</font><font color="#CCCCCC"> seen it work</font><font color="#E5E5E5"> supposing</font>

708
00:33:38,760 --> 00:33:43,770
it works<font color="#E5E5E5"> you're going</font><font color="#CCCCCC"> to decrypt</font><font color="#E5E5E5"> the tag</font>

709
00:33:41,190 --> 00:33:46,410
<font color="#E5E5E5">you're going to do the update</font><font color="#CCCCCC"> on the tag</font>

710
00:33:43,770 --> 00:33:47,970
you're going to re-encrypt and hash the

711
00:33:46,410 --> 00:33:50,430
tag you're going to store that

712
00:33:47,970 --> 00:33:53,040
<font color="#CCCCCC">information off and then you're going to</font>

713
00:33:50,430 --> 00:33:55,470
write<font color="#CCCCCC"> the encrypted data back to the tag</font>

714
00:33:53,040 --> 00:34:00,480
<font color="#E5E5E5">so that's how you would handle</font><font color="#CCCCCC"> an</font>

715
00:33:55,470 --> 00:34:02,130
encrypted tag search update<font color="#CCCCCC"> and then it</font>

716
00:34:00,480 --> 00:34:03,920
just cycles all back through next<font color="#E5E5E5"> time</font>

717
00:34:02,130 --> 00:34:06,690
you read the card

718
00:34:03,920 --> 00:34:09,330
so in addition<font color="#CCCCCC"> to</font><font color="#E5E5E5"> that and our first</font>

719
00:34:06,690 --> 00:34:10,220
crypto demo we know we still have a

720
00:34:09,330 --> 00:34:12,710
<font color="#E5E5E5">problem</font>

721
00:34:10,219 --> 00:34:16,189
the problem is<font color="#E5E5E5"> that</font><font color="#CCCCCC"> a EES actually leaks</font>

722
00:34:12,710 --> 00:34:18,260
<font color="#CCCCCC">information about the plain text size so</font>

723
00:34:16,190 --> 00:34:20,480
if you look up<font color="#CCCCCC"> here</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can figure</font><font color="#E5E5E5"> out</font>

724
00:34:18,260 --> 00:34:24,560
the<font color="#CCCCCC"> cipher length is the plain text link</font>

725
00:34:20,480 --> 00:34:26,899
plus a block<font color="#E5E5E5"> -</font><font color="#CCCCCC"> the plain</font><font color="#E5E5E5"> test link mod a</font>

726
00:34:24,560 --> 00:34:32,750
block so if since we're talking about

727
00:34:26,899 --> 00:34:36,020
<font color="#E5E5E5">AES</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> 16 bytes and we're assuming a</font>

728
00:34:32,750 --> 00:34:39,710
simple ASCII encoding in this case so

729
00:34:36,020 --> 00:34:42,109
<font color="#E5E5E5">you could figure out if your your text</font>

730
00:34:39,710 --> 00:34:45,530
is<font color="#CCCCCC"> 9 your your</font><font color="#E5E5E5"> plaintext length is</font><font color="#CCCCCC"> 9</font>

731
00:34:42,109 --> 00:34:48,918
characters<font color="#E5E5E5"> your block size is</font><font color="#CCCCCC"> 16 you're</font>

732
00:34:45,530 --> 00:34:51,679
gonna end<font color="#E5E5E5"> up with a 16 byte cipher right</font>

733
00:34:48,918 --> 00:34:53,750
and then you append a 16 by IV which was

734
00:34:51,679 --> 00:34:56,300
what the<font color="#E5E5E5"> initialization was done with</font>

735
00:34:53,750 --> 00:34:59,000
and that gives you a total size of<font color="#CCCCCC"> 32</font>

736
00:34:56,300 --> 00:35:01,730
bytes<font color="#CCCCCC"> alright nobody</font><font color="#E5E5E5"> actually looks at</font>

737
00:34:59,000 --> 00:35:03,830
encoded bytes we base64 encode them so

738
00:35:01,730 --> 00:35:06,680
that we<font color="#CCCCCC"> can write them out of strings</font><font color="#E5E5E5"> so</font>

739
00:35:03,830 --> 00:35:10,069
<font color="#E5E5E5">base64 can actually be sized predicted</font>

740
00:35:06,680 --> 00:35:12,348
<font color="#E5E5E5">using that big block</font><font color="#CCCCCC"> of text there it's</font>

741
00:35:10,070 --> 00:35:15,650
the same<font color="#E5E5E5"> basic idea you've set the size</font>

742
00:35:12,349 --> 00:35:18,050
and then<font color="#CCCCCC"> you mod</font><font color="#E5E5E5"> 3 based off of the</font>

743
00:35:15,650 --> 00:35:21,950
<font color="#E5E5E5">number of bytes that are used in base64</font>

744
00:35:18,050 --> 00:35:27,170
encoding<font color="#E5E5E5"> but if we take a cipher sex</font><font color="#CCCCCC"> a</font>

745
00:35:21,950 --> 00:35:29,240
<font color="#CCCCCC">ciphertext of</font><font color="#E5E5E5"> 495 bytes</font><font color="#CCCCCC"> Plus that 16</font>

746
00:35:27,170 --> 00:35:35,089
byte block you're<font color="#CCCCCC"> going to end up</font><font color="#E5E5E5"> with a</font>

747
00:35:29,240 --> 00:35:37,729
<font color="#E5E5E5">ciphertext of about 512 bytes</font><font color="#CCCCCC"> and then</font>

748
00:35:35,089 --> 00:35:42,170
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can see down there</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> lowest one if</font>

749
00:35:37,730 --> 00:35:45,920
<font color="#CCCCCC">you've got a 684 byte ciphertext</font><font color="#E5E5E5"> and you</font>

750
00:35:42,170 --> 00:35:48,710
get your 32 byte hash you get a seven

751
00:35:45,920 --> 00:35:51,349
<font color="#CCCCCC">hundred sixteen bytes out of our</font><font color="#E5E5E5"> 720</font>

752
00:35:48,710 --> 00:35:53,740
<font color="#CCCCCC">usable bytes</font><font color="#E5E5E5"> leaving us the</font><font color="#CCCCCC"> four bytes</font>

753
00:35:51,349 --> 00:35:57,820
<font color="#E5E5E5">left over so we won't</font><font color="#CCCCCC"> over run</font><font color="#E5E5E5"> our card</font>

754
00:35:53,740 --> 00:36:02,240
so long as we never over run a 684 byte

755
00:35:57,820 --> 00:36:04,220
<font color="#E5E5E5">ciphertext</font><font color="#CCCCCC"> alright so this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> what I</font>

756
00:36:02,240 --> 00:36:07,040
<font color="#CCCCCC">talk about when</font><font color="#E5E5E5"> I say that a EES leaks</font>

757
00:36:04,220 --> 00:36:09,259
information<font color="#E5E5E5"> who can tell me which one of</font>

758
00:36:07,040 --> 00:36:12,200
those two was the encryption of<font color="#CCCCCC"> the</font>

759
00:36:09,260 --> 00:36:16,849
longer string earlier the one with the

760
00:36:12,200 --> 00:36:18,770
more<font color="#CCCCCC"> date ain't yeah are</font><font color="#E5E5E5"> so what we're</font>

761
00:36:16,849 --> 00:36:21,320
going to do to stop that<font color="#E5E5E5"> is we're going</font>

762
00:36:18,770 --> 00:36:23,480
<font color="#E5E5E5">to add a mutation to</font><font color="#CCCCCC"> the end of the card</font>

763
00:36:21,320 --> 00:36:26,570
<font color="#E5E5E5">and no matter what happens we're</font>

764
00:36:23,480 --> 00:36:28,700
always<font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> make sure the</font><font color="#E5E5E5"> card is 720</font>

765
00:36:26,570 --> 00:36:32,690
bytes long<font color="#E5E5E5"> whether we encrypted one</font>

766
00:36:28,700 --> 00:36:35,299
character or the maximum<font color="#E5E5E5"> of 511</font><font color="#CCCCCC"> I think</font>

767
00:36:32,690 --> 00:36:36,590
I said<font color="#E5E5E5"> it at and the way we're gonna set</font>

768
00:36:35,300 --> 00:36:39,350
that<font color="#CCCCCC"> is we're gonna figure</font><font color="#E5E5E5"> out our</font>

769
00:36:36,590 --> 00:36:41,750
maximum size 720 take out the data link

770
00:36:39,350 --> 00:36:44,150
that we already have set that to our

771
00:36:41,750 --> 00:36:49,010
mutation length generate<font color="#E5E5E5"> some random</font>

772
00:36:44,150 --> 00:36:50,869
bytes<font color="#E5E5E5"> append that with the tag and then</font>

773
00:36:49,010 --> 00:36:53,020
<font color="#E5E5E5">write that</font><font color="#CCCCCC"> all out to the</font><font color="#E5E5E5"> tag so we're</font>

774
00:36:50,869 --> 00:36:56,750
guaranteed<font color="#CCCCCC"> to use</font><font color="#E5E5E5"> everybody every time</font>

775
00:36:53,020 --> 00:37:00,369
don't judge me food<font color="#E5E5E5"> all right so we're</font>

776
00:36:56,750 --> 00:37:00,369
going to<font color="#CCCCCC"> revisit that</font><font color="#E5E5E5"> last example</font>

777
00:37:22,890 --> 00:37:27,700
[Music]

778
00:37:25,410 --> 00:37:34,420
<font color="#E5E5E5">all right so we're gonna dump</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> tag</font>

779
00:37:27,700 --> 00:37:35,740
<font color="#E5E5E5">again it's an empty tag and now we're</font>

780
00:37:34,420 --> 00:37:49,240
gonna run through<font color="#E5E5E5"> two different</font><font color="#CCCCCC"> size</font>

781
00:37:35,740 --> 00:37:51,069
<font color="#CCCCCC">Kryptos hello again I cannot tell</font><font color="#E5E5E5"> you</font>

782
00:37:49,240 --> 00:37:53,589
<font color="#E5E5E5">how hard it is</font><font color="#CCCCCC"> to try to</font><font color="#E5E5E5"> think of a</font>

783
00:37:51,070 --> 00:37:56,220
string<font color="#E5E5E5"> to encrypt for a demo for a</font>

784
00:37:53,590 --> 00:37:56,220
roomful of people

785
00:38:00,030 --> 00:38:04,420
<font color="#E5E5E5">all right we're going to do the tag dump</font>

786
00:38:02,440 --> 00:38:06,850
<font color="#E5E5E5">but you should be able to see right</font><font color="#CCCCCC"> away</font>

787
00:38:04,420 --> 00:38:19,440
<font color="#CCCCCC">that there's a difference in the way the</font>

788
00:38:06,850 --> 00:38:19,440
tag<font color="#CCCCCC"> dump performs that usually works</font>

789
00:38:19,710 --> 00:38:27,480
there we go so now<font color="#CCCCCC"> we have a short</font>

790
00:38:23,110 --> 00:38:27,480
<font color="#E5E5E5">string and a whole lot of data</font><font color="#CCCCCC"> going out</font>

791
00:38:30,570 --> 00:38:37,840
make<font color="#E5E5E5"> sure that we can recover it even</font>

792
00:38:33,040 --> 00:38:39,850
with<font color="#E5E5E5"> the mutex on there and I'm abusing</font>

793
00:38:37,840 --> 00:38:43,240
<font color="#CCCCCC">the word mutex it's probably more of</font>

794
00:38:39,850 --> 00:38:45,779
<font color="#E5E5E5">just a mutation but it I consider it a</font>

795
00:38:43,240 --> 00:38:49,660
mutation<font color="#E5E5E5"> that locks the card therefore</font>

796
00:38:45,780 --> 00:38:51,220
I'm abusing<font color="#E5E5E5"> it</font><font color="#CCCCCC"> all right so we were able</font>

797
00:38:49,660 --> 00:38:55,870
<font color="#E5E5E5">to recover the object even though we</font>

798
00:38:51,220 --> 00:38:58,029
added<font color="#E5E5E5"> all that garbage data to it now</font>

799
00:38:55,870 --> 00:39:01,690
I'm<font color="#E5E5E5"> going to do the longer one which is</font>

800
00:38:58,030 --> 00:39:05,020
from a file<font color="#E5E5E5"> and this is</font><font color="#CCCCCC"> a quote from</font>

801
00:39:01,690 --> 00:39:06,910
<font color="#E5E5E5">Helen Keller</font><font color="#CCCCCC"> security is mostly a</font>

802
00:39:05,020 --> 00:39:09,280
superstition it does not exist<font color="#CCCCCC"> in nature</font>

803
00:39:06,910 --> 00:39:11,859
<font color="#CCCCCC">nor do the</font><font color="#E5E5E5"> children of men as a whole</font>

804
00:39:09,280 --> 00:39:15,880
<font color="#CCCCCC">experience it avoiding danger is no</font>

805
00:39:11,860 --> 00:39:18,120
safer in the long<font color="#E5E5E5"> run and I went too</font>

806
00:39:15,880 --> 00:39:18,120
<font color="#E5E5E5">fast</font>

807
00:39:22,150 --> 00:39:27,859
<font color="#E5E5E5">all right so we're going to now put</font><font color="#CCCCCC"> that</font>

808
00:39:24,439 --> 00:39:29,328
text<font color="#E5E5E5"> from the file</font><font color="#CCCCCC"> onto the card</font><font color="#E5E5E5"> and</font>

809
00:39:27,859 --> 00:39:31,788
<font color="#E5E5E5">we're going to use the M option which is</font>

810
00:39:29,329 --> 00:39:36,130
<font color="#E5E5E5">what</font><font color="#CCCCCC"> actually is</font><font color="#E5E5E5"> telling the a crypto</font>

811
00:39:31,789 --> 00:39:36,130
example to add the mutation to the text

812
00:39:36,549 --> 00:39:40,299
it's<font color="#CCCCCC"> going to write this</font>

813
00:39:53,769 --> 00:40:03,649
and there we<font color="#E5E5E5"> go we</font><font color="#CCCCCC"> see we're</font><font color="#E5E5E5"> writing out</font>

814
00:40:01,039 --> 00:40:10,369
all<font color="#CCCCCC"> the same</font><font color="#E5E5E5"> bytes again well all the</font>

815
00:40:03,650 --> 00:40:22,249
<font color="#E5E5E5">same number</font><font color="#CCCCCC"> of bytes and then we're</font>

816
00:40:10,369 --> 00:40:31,189
going<font color="#E5E5E5"> to recover the object again all</font>

817
00:40:22,249 --> 00:40:32,629
right we see that<font color="#CCCCCC"> we've got it back and</font>

818
00:40:31,189 --> 00:40:38,959
now we're going to dump the tag just

819
00:40:32,630 --> 00:40:43,939
<font color="#CCCCCC">make sure that we used all the bytes no</font>

820
00:40:38,959 --> 00:40:47,209
<font color="#CCCCCC">we're not</font><font color="#E5E5E5"> that's cool</font><font color="#CCCCCC"> too all right</font>

821
00:40:43,939 --> 00:40:49,729
oh yeah<font color="#E5E5E5"> that's why so there we go that's</font>

822
00:40:47,209 --> 00:40:51,499
<font color="#CCCCCC">the dump of the</font><font color="#E5E5E5"> two tags together now</font>

823
00:40:49,729 --> 00:40:53,799
can either<font color="#CCCCCC"> your</font><font color="#E5E5E5"> gay anyone tell me which</font>

824
00:40:51,499 --> 00:40:58,129
one had the<font color="#E5E5E5"> longer string of text in it</font>

825
00:40:53,799 --> 00:41:01,579
no no there's no<font color="#CCCCCC"> way</font><font color="#E5E5E5"> well I mean I guess</font>

826
00:40:58,130 --> 00:41:03,259
<font color="#E5E5E5">really good at math all right so now</font>

827
00:41:01,579 --> 00:41:06,799
that<font color="#E5E5E5"> we've covered the encryption side</font>

828
00:41:03,259 --> 00:41:08,749
of things<font color="#CCCCCC"> you can keep your data safe</font>

829
00:41:06,799 --> 00:41:11,630
<font color="#CCCCCC">you can know if somebody's modified your</font>

830
00:41:08,749 --> 00:41:14,479
data<font color="#E5E5E5"> you still can't tell if somebody's</font>

831
00:41:11,630 --> 00:41:16,759
lying to you about<font color="#E5E5E5"> the card itself</font>

832
00:41:14,479 --> 00:41:20,288
<font color="#CCCCCC">whether</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> cart is the card it claims</font>

833
00:41:16,759 --> 00:41:23,059
<font color="#CCCCCC">to be</font><font color="#E5E5E5"> so this was actually</font><font color="#CCCCCC"> the most</font>

834
00:41:20,289 --> 00:41:28,670
trying and longest part of this research

835
00:41:23,059 --> 00:41:32,239
because<font color="#CCCCCC"> RF was not my specialty</font><font color="#E5E5E5"> but I've</font>

836
00:41:28,670 --> 00:41:36,109
learned a lot<font color="#E5E5E5"> so the thing about how the</font>

837
00:41:32,239 --> 00:41:39,109
way<font color="#E5E5E5"> that RFID works is it uses induction</font>

838
00:41:36,109 --> 00:41:41,449
<font color="#E5E5E5">so power from the reader goes to the</font>

839
00:41:39,109 --> 00:41:45,979
card the card<font color="#CCCCCC"> then uses some of that</font>

840
00:41:41,449 --> 00:41:49,189
power in its internal processes and then

841
00:41:45,979 --> 00:41:52,399
spits back some power as a communication

842
00:41:49,189 --> 00:41:56,420
channel<font color="#E5E5E5"> and though the inductive link is</font>

843
00:41:52,400 --> 00:41:58,910
the the smaller internal circle and the

844
00:41:56,420 --> 00:42:02,299
communication waves are the generally

845
00:41:58,910 --> 00:42:04,069
larger one<font color="#CCCCCC"> the card in</font><font color="#E5E5E5"> the example there</font>

846
00:42:02,299 --> 00:42:05,660
is<font color="#E5E5E5"> using two inductive</font>

847
00:42:04,069 --> 00:42:08,660
<font color="#CCCCCC">link's but the Mifare</font><font color="#E5E5E5"> cards actually</font>

848
00:42:05,660 --> 00:42:13,519
only<font color="#E5E5E5"> used one the chips are hardwired to</font>

849
00:42:08,660 --> 00:42:17,118
<font color="#E5E5E5">the antenna in</font><font color="#CCCCCC"> the card</font><font color="#E5E5E5"> alright so</font>

850
00:42:13,519 --> 00:42:19,488
looking at the RF spectrum<font color="#CCCCCC"> we are in the</font>

851
00:42:17,119 --> 00:42:22,339
thirteen point five six<font color="#E5E5E5"> megahertz range</font>

852
00:42:19,489 --> 00:42:29,180
that's that green star<font color="#E5E5E5"> that puts us</font>

853
00:42:22,339 --> 00:42:34,869
<font color="#E5E5E5">right there in the RF range right about</font>

854
00:42:29,180 --> 00:42:34,868
the ten point<font color="#E5E5E5"> seven five meters range</font>

855
00:42:35,030 --> 00:42:39,589
[Music]

856
00:42:36,969 --> 00:42:42,920
<font color="#CCCCCC">alright and so you can see it's actually</font>

857
00:42:39,589 --> 00:42:45,589
a fairly<font color="#E5E5E5"> low energy standard as opposed</font>

858
00:42:42,920 --> 00:42:48,170
to like<font color="#E5E5E5"> the only lower ones are the 125</font>

859
00:42:45,589 --> 00:42:50,630
<font color="#CCCCCC">and 135 kilohertz and those are</font>

860
00:42:48,170 --> 00:42:54,140
<font color="#CCCCCC">basically just the ID tags the the</font>

861
00:42:50,630 --> 00:42:56,719
really dumb devices<font color="#CCCCCC"> all right so there</font>

862
00:42:54,140 --> 00:43:01,609
is a paper that inspired a<font color="#E5E5E5"> lot</font><font color="#CCCCCC"> of this</font>

863
00:42:56,719 --> 00:43:04,660
talk<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> reading RFID harmonics and</font>

864
00:43:01,609 --> 00:43:08,529
carrier frequencies and this is the lab

865
00:43:04,660 --> 00:43:11,209
model<font color="#E5E5E5"> that they use to try and identify</font>

866
00:43:08,529 --> 00:43:13,219
<font color="#E5E5E5">RFID cards you see up there</font><font color="#CCCCCC"> that's an</font>

867
00:43:11,209 --> 00:43:15,499
oscilloscope you've got an<font color="#CCCCCC"> rfid</font><font color="#E5E5E5"> reader</font>

868
00:43:13,219 --> 00:43:18,049
<font color="#E5E5E5">the oscilloscope is actually a vector</font>

869
00:43:15,499 --> 00:43:20,749
<font color="#CCCCCC">network analyzer which is a relatively</font>

870
00:43:18,049 --> 00:43:23,150
<font color="#CCCCCC">expensive piece of</font><font color="#E5E5E5"> equipment it's got</font>

871
00:43:20,749 --> 00:43:25,308
two coils<font color="#E5E5E5"> which go around the sensor</font>

872
00:43:23,150 --> 00:43:27,920
coil which<font color="#CCCCCC"> is the in fact</font><font color="#E5E5E5"> the reader the</font>

873
00:43:25,309 --> 00:43:30,170
<font color="#E5E5E5">RFID coil reader and then you've got</font>

874
00:43:27,920 --> 00:43:32,599
your electrical schematic down there you

875
00:43:30,170 --> 00:43:35,059
can<font color="#E5E5E5"> see the reader coil is positioned</font>

876
00:43:32,599 --> 00:43:39,019
precisely<font color="#E5E5E5"> between the two sensing coils</font>

877
00:43:35,059 --> 00:43:41,239
<font color="#CCCCCC">I must be</font><font color="#E5E5E5"> awesome to have a lab well I</font>

878
00:43:39,019 --> 00:43:43,488
get to<font color="#CCCCCC"> work</font><font color="#E5E5E5"> with</font><font color="#CCCCCC"> I have to work with a</font>

879
00:43:41,239 --> 00:43:46,729
hack RF one it's<font color="#E5E5E5"> not quite a vector</font>

880
00:43:43,489 --> 00:43:49,459
<font color="#E5E5E5">network analyzer</font><font color="#CCCCCC"> but it will do so we</font>

881
00:43:46,729 --> 00:43:52,218
can get<font color="#E5E5E5"> 16 or 32-bit quadrature sampling</font>

882
00:43:49,459 --> 00:43:56,149
out of that quadrature sampling is sent

883
00:43:52,219 --> 00:43:58,579
simply the combination<font color="#CCCCCC"> of a complex</font>

884
00:43:56,150 --> 00:44:00,229
number<font color="#CCCCCC"> it gives</font><font color="#E5E5E5"> you first it gives you</font>

885
00:43:58,579 --> 00:44:01,789
the real part then gives you the

886
00:44:00,229 --> 00:44:04,038
<font color="#E5E5E5">imaginary part it just keeps</font>

887
00:44:01,789 --> 00:44:07,400
flip-flopping back and forth<font color="#E5E5E5"> so you take</font>

888
00:44:04,039 --> 00:44:09,190
any two readings<font color="#E5E5E5"> of an RN and I and you</font>

889
00:44:07,400 --> 00:44:12,499
get back a complex number

890
00:44:09,190 --> 00:44:15,049
so what we're actually measuring<font color="#CCCCCC"> is the</font>

891
00:44:12,499 --> 00:44:17,799
<font color="#E5E5E5">power at the carrier frequency which is</font>

892
00:44:15,049 --> 00:44:20,890
thirteen point five six<font color="#E5E5E5"> megahertz</font>

893
00:44:17,800 --> 00:44:23,620
but they actually<font color="#E5E5E5"> go down and operate at</font>

894
00:44:20,890 --> 00:44:26,710
<font color="#E5E5E5">about twelve point five six megahertz so</font>

895
00:44:23,620 --> 00:44:29,230
that when multiple cards are present the

896
00:44:26,710 --> 00:44:32,980
they won't<font color="#E5E5E5"> overrun and go</font><font color="#CCCCCC"> outside of the</font>

897
00:44:29,230 --> 00:44:34,450
is<font color="#CCCCCC"> M band so we we check thirteen point</font>

898
00:44:32,980 --> 00:44:37,150
five six<font color="#E5E5E5"> but</font><font color="#CCCCCC"> we also have to measure</font>

899
00:44:34,450 --> 00:44:39,549
<font color="#E5E5E5">twelve point five six we have to carrier</font>

900
00:44:37,150 --> 00:44:43,120
harmonics<font color="#E5E5E5"> and then each of those</font>

901
00:44:39,550 --> 00:44:46,870
carriers<font color="#E5E5E5"> has a third harmonic</font><font color="#CCCCCC"> which is</font>

902
00:44:43,120 --> 00:44:50,100
from music theory essentially<font color="#E5E5E5"> it's a</font>

903
00:44:46,870 --> 00:44:54,339
wave that<font color="#CCCCCC"> is added to our carrier wave</font>

904
00:44:50,100 --> 00:44:56,290
<font color="#CCCCCC">at some power</font><font color="#E5E5E5"> with relation</font><font color="#CCCCCC"> to how</font><font color="#E5E5E5"> far</font>

905
00:44:54,340 --> 00:44:58,120
away it is<font color="#E5E5E5"> from your carrier wave all</font>

906
00:44:56,290 --> 00:45:00,610
you<font color="#E5E5E5"> really</font><font color="#CCCCCC"> know need to know</font><font color="#E5E5E5"> from</font><font color="#CCCCCC"> that</font>

907
00:44:58,120 --> 00:45:02,440
is that<font color="#CCCCCC"> for thirteen point five</font><font color="#E5E5E5"> six the</font>

908
00:45:00,610 --> 00:45:04,900
third harmonic is at forty point six

909
00:45:02,440 --> 00:45:07,510
eight<font color="#E5E5E5"> and thirty seven point six eight</font>

910
00:45:04,900 --> 00:45:09,550
is for twelve point five six<font color="#CCCCCC"> that</font><font color="#E5E5E5"> means</font>

911
00:45:07,510 --> 00:45:13,270
we have four spots<font color="#E5E5E5"> that we have to</font>

912
00:45:09,550 --> 00:45:15,790
measure to get<font color="#E5E5E5"> this power analysis from</font>

913
00:45:13,270 --> 00:45:18,220
luckily in hack RF you can do that in

914
00:45:15,790 --> 00:45:21,160
<font color="#CCCCCC">software but it starts</font><font color="#E5E5E5"> to get really</font>

915
00:45:18,220 --> 00:45:23,830
<font color="#E5E5E5">laggy so I recommended using two radios</font>

916
00:45:21,160 --> 00:45:27,310
and<font color="#E5E5E5"> I actually picked up an</font><font color="#CCCCCC"> RTL SDR as</font>

917
00:45:23,830 --> 00:45:29,319
my second radio<font color="#E5E5E5"> now the hack RF can</font>

918
00:45:27,310 --> 00:45:34,330
sample<font color="#E5E5E5"> at about twenty million samples</font>

919
00:45:29,320 --> 00:45:35,950
per second or 20 megahertz<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> RTL</font>

920
00:45:34,330 --> 00:45:39,549
<font color="#CCCCCC">SDR can only do about two million</font>

921
00:45:35,950 --> 00:45:42,460
megahertz so the RTL SDR<font color="#E5E5E5"> is actually the</font>

922
00:45:39,550 --> 00:45:46,000
one that's<font color="#CCCCCC"> being used</font><font color="#E5E5E5"> to carry to sample</font>

923
00:45:42,460 --> 00:45:47,820
the carrier harmonics<font color="#CCCCCC"> the</font><font color="#E5E5E5"> thirteen point</font>

924
00:45:46,000 --> 00:45:50,620
<font color="#E5E5E5">five six and twelve point five six</font>

925
00:45:47,820 --> 00:45:53,400
<font color="#E5E5E5">because it's the only set that would fit</font>

926
00:45:50,620 --> 00:45:56,020
within the two megahertz<font color="#CCCCCC"> sample band</font>

927
00:45:53,400 --> 00:45:58,300
whereas you<font color="#CCCCCC"> know thirty seven to forty</font>

928
00:45:56,020 --> 00:45:59,950
wouldn't so the thirty seven point<font color="#E5E5E5"> six</font>

929
00:45:58,300 --> 00:46:02,620
eight<font color="#CCCCCC"> and the forty point six eight are</font>

930
00:45:59,950 --> 00:46:04,080
being measured<font color="#E5E5E5"> by the hack RF one that's</font>

931
00:46:02,620 --> 00:46:08,230
good because they actually have<font color="#E5E5E5"> trinka</font>

932
00:46:04,080 --> 00:46:10,090
fainter traces<font color="#CCCCCC"> of power signals alright</font>

933
00:46:08,230 --> 00:46:12,880
so there's my super<font color="#CCCCCC"> science ii</font><font color="#E5E5E5"> set up</font><font color="#CCCCCC"> i</font>

934
00:46:10,090 --> 00:46:14,770
don't get a lab<font color="#CCCCCC"> i get a metal box</font><font color="#E5E5E5"> you</font>

935
00:46:12,880 --> 00:46:18,610
can kind of see the second antenna

936
00:46:14,770 --> 00:46:22,390
<font color="#CCCCCC">coming out here that's the</font><font color="#E5E5E5"> rtl-sdr this</font>

937
00:46:18,610 --> 00:46:24,520
blue here that's the RC<font color="#CCCCCC"> 522 reader</font>

938
00:46:22,390 --> 00:46:26,859
<font color="#E5E5E5">that's what's actually interacting with</font>

939
00:46:24,520 --> 00:46:29,590
the cards<font color="#E5E5E5"> and then you see my hack RF on</font>

940
00:46:26,860 --> 00:46:31,299
top of the box and on the<font color="#CCCCCC"> left-hand side</font>

941
00:46:29,590 --> 00:46:34,149
<font color="#CCCCCC">the computer is</font><font color="#E5E5E5"> running</font>

942
00:46:31,299 --> 00:46:36,999
good new radio program which is doing<font color="#CCCCCC"> a</font>

943
00:46:34,149 --> 00:46:38,949
scope plot of the the cards currently

944
00:46:36,999 --> 00:46:42,519
<font color="#E5E5E5">there's no card on there so I'm taking a</font>

945
00:46:38,949 --> 00:46:46,599
noise reading<font color="#CCCCCC"> alright</font>

946
00:46:42,519 --> 00:46:49,988
so around<font color="#E5E5E5"> 13 this is</font><font color="#CCCCCC"> a power spectral</font>

947
00:46:46,599 --> 00:46:53,559
density<font color="#CCCCCC"> plot of two separate cards being</font>

948
00:46:49,989 --> 00:46:57,609
read<font color="#E5E5E5"> and the</font><font color="#CCCCCC"> 0 here the center frequency</font>

949
00:46:53,559 --> 00:46:59,559
is right about<font color="#E5E5E5"> 13 megahertz so the</font><font color="#CCCCCC"> zero</font>

950
00:46:57,609 --> 00:47:02,529
spike that you see there that's fairly

951
00:46:59,559 --> 00:47:05,499
<font color="#CCCCCC">typical that's a DC offset</font><font color="#E5E5E5"> error the</font>

952
00:47:02,529 --> 00:47:09,849
other spikes that<font color="#E5E5E5"> you see are where</font><font color="#CCCCCC"> two</font>

953
00:47:05,499 --> 00:47:12,129
tags<font color="#E5E5E5"> had highly correlated</font><font color="#CCCCCC"> signals and</font>

954
00:47:09,849 --> 00:47:14,890
where you see them separating apart

955
00:47:12,130 --> 00:47:17,499
that's where<font color="#E5E5E5"> two tags were not similar</font>

956
00:47:14,890 --> 00:47:20,049
<font color="#CCCCCC">in terms</font><font color="#E5E5E5"> of power spectrum and if you</font>

957
00:47:17,499 --> 00:47:22,988
look you're about<font color="#CCCCCC"> twelve point five six</font>

958
00:47:20,049 --> 00:47:26,140
<font color="#CCCCCC">is going to be well this here is about</font>

959
00:47:22,989 --> 00:47:27,759
<font color="#E5E5E5">12</font><font color="#CCCCCC"> 5-12 five six is going</font><font color="#E5E5E5"> to be here and</font>

960
00:47:26,140 --> 00:47:30,459
you see there's a pretty big<font color="#CCCCCC"> difference</font>

961
00:47:27,759 --> 00:47:32,380
up there and then<font color="#E5E5E5"> 13 five six it's gonna</font>

962
00:47:30,459 --> 00:47:34,658
be about<font color="#E5E5E5"> here and there's not so much</font>

963
00:47:32,380 --> 00:47:36,759
difference<font color="#E5E5E5"> than that one so we probably</font>

964
00:47:34,659 --> 00:47:42,609
want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> focus more on the harmonics</font><font color="#CCCCCC"> in</font>

965
00:47:36,759 --> 00:47:45,939
<font color="#E5E5E5">12 than in 13th</font><font color="#CCCCCC"> alright so for</font><font color="#E5E5E5"> everybody</font>

966
00:47:42,609 --> 00:47:48,609
who's<font color="#CCCCCC"> not super familiar with quadrature</font>

967
00:47:45,939 --> 00:47:51,368
sampling or what IQ<font color="#E5E5E5"> data is it's</font>

968
00:47:48,609 --> 00:47:53,799
actually<font color="#CCCCCC"> just data on the polar plane</font><font color="#E5E5E5"> so</font>

969
00:47:51,369 --> 00:47:56,469
you've got your phase of your signal<font color="#E5E5E5"> is</font>

970
00:47:53,799 --> 00:47:59,859
spinning around and then your magnitude

971
00:47:56,469 --> 00:48:02,589
of your signal<font color="#E5E5E5"> is how far out towards</font>

972
00:47:59,859 --> 00:48:06,130
the towards the circle it is<font color="#E5E5E5"> from the</font>

973
00:48:02,589 --> 00:48:08,859
center<font color="#E5E5E5"> so you're given a real value</font>

974
00:48:06,130 --> 00:48:10,899
which is this line<font color="#CCCCCC"> here and then you're</font>

975
00:48:08,859 --> 00:48:14,288
<font color="#CCCCCC">given an imaginary value which is the</font>

976
00:48:10,899 --> 00:48:17,109
<font color="#CCCCCC">cue I know it's confusing</font><font color="#E5E5E5"> because I for</font>

977
00:48:14,289 --> 00:48:19,299
real and<font color="#CCCCCC"> Q for imaginary but there are</font>

978
00:48:17,109 --> 00:48:21,909
reasons<font color="#CCCCCC"> you take those two measures and</font>

979
00:48:19,299 --> 00:48:24,489
<font color="#CCCCCC">you apply a little</font><font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of basic geometry</font>

980
00:48:21,909 --> 00:48:26,709
to<font color="#CCCCCC"> figure out the hypotenuse of your</font>

981
00:48:24,489 --> 00:48:31,349
<font color="#E5E5E5">triangle and that</font><font color="#CCCCCC"> gives you</font><font color="#E5E5E5"> your</font>

982
00:48:26,709 --> 00:48:34,299
magnitude of your signal at that<font color="#E5E5E5"> point</font>

983
00:48:31,349 --> 00:48:36,549
<font color="#E5E5E5">so what we're talking about is</font><font color="#CCCCCC"> actually</font>

984
00:48:34,299 --> 00:48:41,229
how much power is being<font color="#E5E5E5"> reflected back</font>

985
00:48:36,549 --> 00:48:45,680
by the<font color="#E5E5E5"> card towards the reader during an</font>

986
00:48:41,229 --> 00:48:47,720
interaction<font color="#CCCCCC"> and this is a very basic</font>

987
00:48:45,680 --> 00:48:50,118
<font color="#CCCCCC">principle here you have your generator</font>

988
00:48:47,720 --> 00:48:51,770
of your signal you have<font color="#E5E5E5"> your Z naught</font>

989
00:48:50,119 --> 00:48:54,470
which has some<font color="#CCCCCC"> resistance some</font>

990
00:48:51,770 --> 00:48:58,130
capacitance<font color="#E5E5E5"> or impedance</font><font color="#CCCCCC"> and then you</font>

991
00:48:54,470 --> 00:49:00,439
have your load<font color="#E5E5E5"> now you have a positive</font>

992
00:48:58,130 --> 00:49:03,290
wave coming this way going<font color="#E5E5E5"> towards your</font>

993
00:49:00,440 --> 00:49:06,470
load<font color="#E5E5E5"> but because of impedance</font>

994
00:49:03,290 --> 00:49:10,579
mismatching<font color="#E5E5E5"> you're gonna have some wave</font>

995
00:49:06,470 --> 00:49:12,560
coming back<font color="#E5E5E5"> and those two waves add</font>

996
00:49:10,579 --> 00:49:17,000
together to give<font color="#CCCCCC"> you what your output</font>

997
00:49:12,560 --> 00:49:18,828
carrier signal actually<font color="#CCCCCC"> is so there's</font>

998
00:49:17,000 --> 00:49:22,329
there's math up there if<font color="#E5E5E5"> you love math</font>

999
00:49:18,829 --> 00:49:25,640
<font color="#CCCCCC">have at it</font><font color="#E5E5E5"> it can all be simplified down</font>

1000
00:49:22,329 --> 00:49:28,490
into<font color="#CCCCCC"> just a</font><font color="#E5E5E5"> single circuit as opposed</font><font color="#CCCCCC"> to</font>

1001
00:49:25,640 --> 00:49:32,750
the capacitance circuits that<font color="#CCCCCC"> are over</font>

1002
00:49:28,490 --> 00:49:37,549
there<font color="#E5E5E5"> and so what we're trying to get at</font>

1003
00:49:32,750 --> 00:49:39,770
is for the<font color="#E5E5E5"> tag what is the unloaded</font>

1004
00:49:37,550 --> 00:49:43,040
reflection coefficient and<font color="#E5E5E5"> what I mean</font>

1005
00:49:39,770 --> 00:49:45,890
<font color="#E5E5E5">by unloaded is we can't ever interact</font>

1006
00:49:43,040 --> 00:49:48,950
with the<font color="#E5E5E5"> RFID</font><font color="#CCCCCC"> tag by itself we have to</font>

1007
00:49:45,890 --> 00:49:51,170
have a reader stimulating the card to

1008
00:49:48,950 --> 00:49:54,049
get the card to interact so we can't

1009
00:49:51,170 --> 00:49:55,670
ever take<font color="#E5E5E5"> a reading of just the card we</font>

1010
00:49:54,050 --> 00:49:58,609
have<font color="#E5E5E5"> to take a reading of the card and</font>

1011
00:49:55,670 --> 00:50:00,770
the reader so what we do to<font color="#E5E5E5"> compensate</font>

1012
00:49:58,609 --> 00:50:02,420
<font color="#CCCCCC">for that as we take a</font><font color="#E5E5E5"> reading of just</font>

1013
00:50:00,770 --> 00:50:05,050
the reader<font color="#E5E5E5"> that we can do because the</font>

1014
00:50:02,420 --> 00:50:09,050
reader is its own power source<font color="#E5E5E5"> we then</font>

1015
00:50:05,050 --> 00:50:11,900
adjust our reading down to the imaginary

1016
00:50:09,050 --> 00:50:14,630
center<font color="#E5E5E5"> line which</font><font color="#CCCCCC"> is essentially saying</font>

1017
00:50:11,900 --> 00:50:18,020
no power is being<font color="#CCCCCC"> reflected back this is</font>

1018
00:50:14,630 --> 00:50:23,390
a perfectly efficient system we then use

1019
00:50:18,020 --> 00:50:25,369
<font color="#E5E5E5">it save our modification and we read all</font>

1020
00:50:23,390 --> 00:50:27,230
our tag readings now they take their tag

1021
00:50:25,369 --> 00:50:30,589
readings and they fit them to a circle

1022
00:50:27,230 --> 00:50:32,569
<font color="#E5E5E5">and then they apply the same shift that</font>

1023
00:50:30,589 --> 00:50:35,299
<font color="#E5E5E5">they apply</font><font color="#CCCCCC"> without the cards they apply</font>

1024
00:50:32,569 --> 00:50:39,290
it<font color="#E5E5E5"> to the tag data and then they measure</font>

1025
00:50:35,300 --> 00:50:42,700
the the clustering density so you're

1026
00:50:39,290 --> 00:50:46,250
<font color="#E5E5E5">looking like a king means clustering</font><font color="#CCCCCC"> so</font>

1027
00:50:42,700 --> 00:50:48,919
<font color="#CCCCCC">when I go</font><font color="#E5E5E5"> to do this we go to put</font><font color="#CCCCCC"> it on</font>

1028
00:50:46,250 --> 00:50:50,869
a Smith<font color="#E5E5E5"> chart</font><font color="#CCCCCC"> and we read it out</font>

1029
00:50:48,920 --> 00:50:53,750
<font color="#E5E5E5">orange samples are tagged</font><font color="#CCCCCC"> to blue</font>

1030
00:50:50,869 --> 00:50:56,960
samples are tagged<font color="#E5E5E5"> one the squares up at</font>

1031
00:50:53,750 --> 00:50:58,250
<font color="#E5E5E5">the top are the the coefficients that</font>

1032
00:50:56,960 --> 00:50:59,840
<font color="#E5E5E5">are being</font><font color="#CCCCCC"> predict</font>

1033
00:50:58,250 --> 00:51:01,850
and as<font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see there's actually</font><font color="#E5E5E5"> a</font>

1034
00:50:59,840 --> 00:51:04,940
fairly<font color="#E5E5E5"> large gap there so if you had</font>

1035
00:51:01,850 --> 00:51:07,460
<font color="#E5E5E5">only two tags in your system</font><font color="#CCCCCC"> you could</font>

1036
00:51:04,940 --> 00:51:14,960
<font color="#E5E5E5">fairly easily tell which tag produced</font>

1037
00:51:07,460 --> 00:51:16,640
which of those<font color="#E5E5E5"> power spectral signals so</font>

1038
00:51:14,960 --> 00:51:19,750
it sounds all<font color="#E5E5E5"> good it sounds</font><font color="#CCCCCC"> like we've</font>

1039
00:51:16,640 --> 00:51:22,460
got a workable plan<font color="#CCCCCC"> there's a problem</font>

1040
00:51:19,750 --> 00:51:26,000
<font color="#E5E5E5">actually there are a few problems so</font>

1041
00:51:22,460 --> 00:51:28,550
like I<font color="#E5E5E5"> was talking</font><font color="#CCCCCC"> about the tag readers</font>

1042
00:51:26,000 --> 00:51:30,230
<font color="#CCCCCC">themselves are part</font><font color="#E5E5E5"> of the the power</font>

1043
00:51:28,550 --> 00:51:33,680
signature that<font color="#E5E5E5"> you get so you have to</font>

1044
00:51:30,230 --> 00:51:36,890
remove<font color="#E5E5E5"> that</font><font color="#CCCCCC"> in the paper</font>

1045
00:51:33,680 --> 00:51:38,839
they held the cards<font color="#E5E5E5"> at exactly one point</font>

1046
00:51:36,890 --> 00:51:41,330
<font color="#E5E5E5">seven five centimeters above the reader</font>

1047
00:51:38,840 --> 00:51:44,230
they held it<font color="#E5E5E5"> perfectly parallel and they</font>

1048
00:51:41,330 --> 00:51:46,100
were able<font color="#E5E5E5"> to get exacting readings</font>

1049
00:51:44,230 --> 00:51:47,960
unfortunately in the<font color="#CCCCCC"> real world people</font>

1050
00:51:46,100 --> 00:51:50,210
don't<font color="#E5E5E5"> hold their hand exactly still they</font>

1051
00:51:47,960 --> 00:51:52,130
move the card up<font color="#E5E5E5"> and down so we have to</font>

1052
00:51:50,210 --> 00:51:55,370
take<font color="#CCCCCC"> more realistic</font><font color="#E5E5E5"> readings and we have</font>

1053
00:51:52,130 --> 00:52:00,110
to figure out<font color="#E5E5E5"> how to compensate for the</font>

1054
00:51:55,370 --> 00:52:01,880
changing and quality factor so<font color="#E5E5E5"> and like</font>

1055
00:52:00,110 --> 00:52:04,100
<font color="#E5E5E5">I said if you have two tags in</font><font color="#CCCCCC"> your tag</font>

1056
00:52:01,880 --> 00:52:06,650
set it's fairly easy<font color="#CCCCCC"> to predict which</font>

1057
00:52:04,100 --> 00:52:09,890
one made the<font color="#E5E5E5"> power signature if you have</font>

1058
00:52:06,650 --> 00:52:12,380
several thousand or more tags<font color="#E5E5E5"> it's going</font>

1059
00:52:09,890 --> 00:52:14,450
to be very<font color="#E5E5E5"> hard because they become very</font>

1060
00:52:12,380 --> 00:52:18,650
overlapping<font color="#E5E5E5"> there's not as much</font>

1061
00:52:14,450 --> 00:52:21,020
<font color="#E5E5E5">definition and the hardware is still</font>

1062
00:52:18,650 --> 00:52:22,970
expensive so not everybody<font color="#CCCCCC"> is going to</font>

1063
00:52:21,020 --> 00:52:27,800
<font color="#CCCCCC">want to</font><font color="#E5E5E5"> buy an</font><font color="#CCCCCC"> rfid</font><font color="#E5E5E5"> reader which also</font>

1064
00:52:22,970 --> 00:52:29,810
has an<font color="#E5E5E5"> RFID analysis tool attached to it</font>

1065
00:52:27,800 --> 00:52:33,170
<font color="#CCCCCC">like a hack</font><font color="#E5E5E5"> or at one which is still</font>

1066
00:52:29,810 --> 00:52:35,259
<font color="#E5E5E5">about three hundred dollars so the</font>

1067
00:52:33,170 --> 00:52:38,990
<font color="#E5E5E5">overhead for doing the cryptography is</font>

1068
00:52:35,260 --> 00:52:41,300
still pretty<font color="#E5E5E5"> bad</font><font color="#CCCCCC"> nor the overhead</font><font color="#E5E5E5"> for</font>

1069
00:52:38,990 --> 00:52:43,310
doing the predictive analytics<font color="#E5E5E5"> on the</font>

1070
00:52:41,300 --> 00:52:45,230
tag data you probably<font color="#E5E5E5"> have to shuffle</font>

1071
00:52:43,310 --> 00:52:46,940
<font color="#E5E5E5">that off to a cloud server you</font><font color="#CCCCCC"> don't</font>

1072
00:52:45,230 --> 00:52:50,230
want to do it on the reader itself<font color="#E5E5E5"> and</font>

1073
00:52:46,940 --> 00:52:54,200
that comes back<font color="#CCCCCC"> to</font><font color="#E5E5E5"> having stable readers</font>

1074
00:52:50,230 --> 00:52:56,360
so and then these signatures are<font color="#E5E5E5"> based</font>

1075
00:52:54,200 --> 00:53:00,850
on the reader that takes the signature

1076
00:52:56,360 --> 00:53:04,010
so you will have to have a different

1077
00:53:00,850 --> 00:53:05,960
<font color="#E5E5E5">adjustment quotient for each of your</font>

1078
00:53:04,010 --> 00:53:08,780
readers<font color="#E5E5E5"> to be able to predict on the</font>

1079
00:53:05,960 --> 00:53:11,200
<font color="#E5E5E5">same card because the reader affects the</font>

1080
00:53:08,780 --> 00:53:11,200
readings

1081
00:53:11,270 --> 00:53:18,450
<font color="#E5E5E5">all right and then in</font><font color="#CCCCCC"> conclusion</font><font color="#E5E5E5"> we're</font>

1082
00:53:14,490 --> 00:53:20,700
going to use the<font color="#CCCCCC"> PI</font><font color="#E5E5E5"> RC 522 safe to add</font>

1083
00:53:18,450 --> 00:53:22,890
AES encryption<font color="#E5E5E5"> we're going to encrypt</font>

1084
00:53:20,700 --> 00:53:24,660
all our<font color="#E5E5E5"> databases in queries so that</font>

1085
00:53:22,890 --> 00:53:27,230
they're not leaky we're gonna isolate

1086
00:53:24,660 --> 00:53:30,509
our readers off of our regular networks

1087
00:53:27,230 --> 00:53:32,580
<font color="#CCCCCC">Sai kit</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> RF and panas or what I was</font>

1088
00:53:30,510 --> 00:53:35,190
<font color="#CCCCCC">using</font><font color="#E5E5E5"> to create the plots and do all of</font>

1089
00:53:32,580 --> 00:53:37,350
the math<font color="#CCCCCC"> stuff</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> fun</font><font color="#E5E5E5"> and then we're</font>

1090
00:53:35,190 --> 00:53:40,830
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use purpose-built RF IDs if you</font>

1091
00:53:37,350 --> 00:53:43,799
can't if<font color="#E5E5E5"> you cannot allow clones in your</font>

1092
00:53:40,830 --> 00:53:46,940
<font color="#E5E5E5">environment there are</font><font color="#CCCCCC"> already built</font><font color="#E5E5E5"> RFID</font>

1093
00:53:43,800 --> 00:53:49,710
systems with electronics added to add

1094
00:53:46,940 --> 00:53:52,530
signature<font color="#E5E5E5"> physically uncountable</font>

1095
00:53:49,710 --> 00:53:54,870
functions that you can<font color="#CCCCCC"> use alright and</font>

1096
00:53:52,530 --> 00:53:56,550
with<font color="#E5E5E5"> that these are my references there</font>

1097
00:53:54,870 --> 00:53:58,890
are too many for<font color="#CCCCCC"> me to list on a slide</font>

1098
00:53:56,550 --> 00:54:03,440
so if you go to<font color="#E5E5E5"> my</font><font color="#CCCCCC"> blog go</font><font color="#E5E5E5"> to resources</font>

1099
00:53:58,890 --> 00:54:03,440
for RFID<font color="#E5E5E5"> talk they'll be all there</font>

