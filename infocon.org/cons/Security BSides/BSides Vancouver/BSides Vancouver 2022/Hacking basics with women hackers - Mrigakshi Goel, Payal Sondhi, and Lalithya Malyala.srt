1
00:00:00,160 --> 00:00:02,560
uh sorry for that

2
00:00:02,560 --> 00:00:04,879
um

3
00:00:07,359 --> 00:00:09,840
yeah hi everyone today we are going to

4
00:00:09,840 --> 00:00:12,000
have a presentation on hacking basics

5
00:00:12,000 --> 00:00:13,759
with women hackers

6
00:00:13,759 --> 00:00:16,560
uh me and my squad of women is

7
00:00:16,560 --> 00:00:19,680
presenting uh together as we have a

8
00:00:19,680 --> 00:00:22,400
little bit of career in cyber security

9
00:00:22,400 --> 00:00:25,680
and a lot of interest in hacking

10
00:00:25,680 --> 00:00:26,640
um

11
00:00:26,640 --> 00:00:29,599
well we will start with recon and recon

12
00:00:29,599 --> 00:00:32,320
tools with pile

13
00:00:32,320 --> 00:00:34,800
we will have some filters and we will

14
00:00:34,800 --> 00:00:37,920
learn more about appsec with uh

15
00:00:37,920 --> 00:00:41,680
lalithiya and then we will have uh

16
00:00:41,680 --> 00:00:45,200
ubuntu which is file upload bipol bypass

17
00:00:45,200 --> 00:00:48,480
and more about it in detail with me

18
00:00:48,480 --> 00:00:51,440
so let's first start with introduction

19
00:00:51,440 --> 00:00:54,640
uh i am rigakshi i currently work as an

20
00:00:54,640 --> 00:00:57,600
information security engineer at fining

21
00:00:57,600 --> 00:01:00,320
i have about eight years of experience

22
00:01:00,320 --> 00:01:02,879
in different uh fields in the it

23
00:01:02,879 --> 00:01:05,920
industry i have worked at accenture

24
00:01:05,920 --> 00:01:09,600
uh buck crowd and octave all all of it a

25
00:01:09,600 --> 00:01:12,799
lot of it was an application security

26
00:01:12,799 --> 00:01:15,520
and i really enjoy educating everyone

27
00:01:15,520 --> 00:01:17,920
else about cyber security and best

28
00:01:17,920 --> 00:01:21,360
practices that would work place and also

29
00:01:21,360 --> 00:01:24,560
in day-to-day uh life like how to get

30
00:01:24,560 --> 00:01:29,280
more secure and i enjoy finding uh

31
00:01:29,280 --> 00:01:32,320
things that are out of the box or bugs

32
00:01:32,320 --> 00:01:33,520
um

33
00:01:33,520 --> 00:01:35,759
yeah

34
00:01:37,360 --> 00:01:41,840
lolita would you like to go ahead

35
00:01:56,399 --> 00:02:00,040
are you on mute

36
00:02:08,800 --> 00:02:13,239
we can't hear you at all

37
00:02:58,879 --> 00:03:01,120
i can go next

38
00:03:01,120 --> 00:03:02,959
uh yeah

39
00:03:02,959 --> 00:03:05,680
uh we'll wait for you to figure out but

40
00:03:05,680 --> 00:03:08,400
uh uh i think pal can introduce herself

41
00:03:08,400 --> 00:03:09,920
right yeah and i can start the

42
00:03:09,920 --> 00:03:12,319
presentation that's fine lithia can't do

43
00:03:12,319 --> 00:03:13,200
the

44
00:03:13,200 --> 00:03:15,360
introduction with her presentation is it

45
00:03:15,360 --> 00:03:16,400
okay

46
00:03:16,400 --> 00:03:17,360
yep

47
00:03:17,360 --> 00:03:18,480
okay

48
00:03:18,480 --> 00:03:20,959
so hello everyone good afternoon my name

49
00:03:20,959 --> 00:03:24,640
is pile i am cyber enthusiast slash

50
00:03:24,640 --> 00:03:27,040
researcher i completed my degree in

51
00:03:27,040 --> 00:03:29,680
cyber security in forensics from my

52
00:03:29,680 --> 00:03:32,319
american-based university named as

53
00:03:32,319 --> 00:03:34,879
fairly dickinson university currently

54
00:03:34,879 --> 00:03:37,120
i'm pursuing my certifications in

55
00:03:37,120 --> 00:03:39,760
security plus and comptia

56
00:03:39,760 --> 00:03:41,200
pentest plus

57
00:03:41,200 --> 00:03:43,920
i'm an active user of try hack me and

58
00:03:43,920 --> 00:03:46,319
hack the box additionally i am doing my

59
00:03:46,319 --> 00:03:49,599
research on web application hacking

60
00:03:49,599 --> 00:03:51,920
and its tool today i will be talking

61
00:03:51,920 --> 00:03:55,280
about a major factor in web application

62
00:03:55,280 --> 00:03:57,840
which is known as reconnaissance

63
00:03:57,840 --> 00:03:58,799
i will

64
00:03:58,799 --> 00:04:01,599
my agenda will be talking about what is

65
00:04:01,599 --> 00:04:03,599
reconnaissance what are the types of

66
00:04:03,599 --> 00:04:05,519
reconnaissance what are the

67
00:04:05,519 --> 00:04:08,239
methodologies we use in recon

68
00:04:08,239 --> 00:04:12,159
so let's start with the presentation

69
00:04:12,159 --> 00:04:15,720
next slide please

70
00:04:16,000 --> 00:04:18,238
sorry there's a glitch a little bit oh

71
00:04:18,238 --> 00:04:19,519
it's okay

72
00:04:19,519 --> 00:04:21,759
no problem so the

73
00:04:21,759 --> 00:04:23,759
first we go with reconnaissance what is

74
00:04:23,759 --> 00:04:25,759
reconnaissance reconnaissance is the

75
00:04:25,759 --> 00:04:27,280
very first step

76
00:04:27,280 --> 00:04:30,720
an attacker takes it helps an attacker

77
00:04:30,720 --> 00:04:33,680
to gather as much information he or she

78
00:04:33,680 --> 00:04:36,320
can it also known as foot printing of

79
00:04:36,320 --> 00:04:38,720
the web application it is used in

80
00:04:38,720 --> 00:04:41,919
ethical hacking and pen testing it helps

81
00:04:41,919 --> 00:04:44,800
in identifying the weaknesses and also

82
00:04:44,800 --> 00:04:47,840
helps in exploitation of that weaknesses

83
00:04:47,840 --> 00:04:50,719
next slide please

84
00:04:54,320 --> 00:04:56,800
types of recon basically there are two

85
00:04:56,800 --> 00:04:59,600
types of recon the first is active recon

86
00:04:59,600 --> 00:05:01,680
and the second is passive recon in

87
00:05:01,680 --> 00:05:03,120
active recon

88
00:05:03,120 --> 00:05:06,560
an attacker interacts directly with the

89
00:05:06,560 --> 00:05:07,680
system

90
00:05:07,680 --> 00:05:09,919
but the biggest disadvantage of active

91
00:05:09,919 --> 00:05:12,720
recon is that it is easily detectable

92
00:05:12,720 --> 00:05:15,440
because when an attacker send a lot of

93
00:05:15,440 --> 00:05:18,400
packets to the defensive mechanism

94
00:05:18,400 --> 00:05:19,520
it may

95
00:05:19,520 --> 00:05:22,080
it makes easy for the firewall to detect

96
00:05:22,080 --> 00:05:24,320
it but there are various methods through

97
00:05:24,320 --> 00:05:25,199
which

98
00:05:25,199 --> 00:05:27,759
an attacker gather information through

99
00:05:27,759 --> 00:05:29,840
active recon the first is operating

100
00:05:29,840 --> 00:05:32,639
system services running on the machine

101
00:05:32,639 --> 00:05:34,960
as well open and close ports

102
00:05:34,960 --> 00:05:37,360
on the other side in passive recon an

103
00:05:37,360 --> 00:05:39,600
attacker interacts indirectly with the

104
00:05:39,600 --> 00:05:41,840
system and it is very difficult for the

105
00:05:41,840 --> 00:05:43,039
defensive

106
00:05:43,039 --> 00:05:46,080
mechanism to detect it because a

107
00:05:46,080 --> 00:05:48,800
fantastic uses public resources like

108
00:05:48,800 --> 00:05:51,199
employee information the technology used

109
00:05:51,199 --> 00:05:52,400
by the company

110
00:05:52,400 --> 00:05:55,120
we for example linkedin nowadays

111
00:05:55,120 --> 00:05:57,360
companies love to share the information

112
00:05:57,360 --> 00:06:00,080
on social media platforms which makes it

113
00:06:00,080 --> 00:06:02,639
easy for the attackers to act to gain

114
00:06:02,639 --> 00:06:05,360
the access of the information

115
00:06:05,360 --> 00:06:06,880
and

116
00:06:06,880 --> 00:06:07,759
to

117
00:06:07,759 --> 00:06:10,560
gather as much information they can next

118
00:06:10,560 --> 00:06:13,759
slide please methodologies of recon so

119
00:06:13,759 --> 00:06:15,680
let's talk about the different types of

120
00:06:15,680 --> 00:06:18,160
methodologies we use in recon there are

121
00:06:18,160 --> 00:06:20,800
so many but i will discuss some of my

122
00:06:20,800 --> 00:06:22,000
favorites

123
00:06:22,000 --> 00:06:24,960
next slide please

124
00:06:26,240 --> 00:06:28,800
so the first one we are going to talk

125
00:06:28,800 --> 00:06:30,880
about is google docs

126
00:06:30,880 --> 00:06:33,520
google docs also known as google hacking

127
00:06:33,520 --> 00:06:36,319
database it helps in finding the

128
00:06:36,319 --> 00:06:39,120
sensitive information using google for

129
00:06:39,120 --> 00:06:40,479
other sites

130
00:06:40,479 --> 00:06:42,800
some of the examples of google docs are

131
00:06:42,800 --> 00:06:45,360
in url which helps in finding the

132
00:06:45,360 --> 00:06:47,759
information through url

133
00:06:47,759 --> 00:06:50,000
the second is in text it helps in

134
00:06:50,000 --> 00:06:52,639
finding the information in the web

135
00:06:52,639 --> 00:06:53,840
application

136
00:06:53,840 --> 00:06:55,440
the third is site

137
00:06:55,440 --> 00:06:57,280
site helps in finding the information

138
00:06:57,280 --> 00:06:58,560
through domain

139
00:06:58,560 --> 00:07:00,800
fourth is file type it helps in finding

140
00:07:00,800 --> 00:07:02,639
the information through different types

141
00:07:02,639 --> 00:07:06,160
of files like pdf and doc and many more

142
00:07:06,160 --> 00:07:08,160
the link mentioned in this slide

143
00:07:08,160 --> 00:07:11,199
contains database of google docs which

144
00:07:11,199 --> 00:07:14,080
we can use for research

145
00:07:14,080 --> 00:07:16,479
i also use some of the google docs from

146
00:07:16,479 --> 00:07:18,720
this database which i am going to

147
00:07:18,720 --> 00:07:21,360
present in the upcoming slides

148
00:07:21,360 --> 00:07:24,240
next slide please

149
00:07:26,639 --> 00:07:29,840
as you can easily see in this i used the

150
00:07:29,840 --> 00:07:33,360
google doc in url which helped me to

151
00:07:33,360 --> 00:07:34,400
find

152
00:07:34,400 --> 00:07:38,240
an admin panel of the site abcd.com

153
00:07:38,240 --> 00:07:40,400
it also contains some sensitive

154
00:07:40,400 --> 00:07:42,479
information which i censored in this

155
00:07:42,479 --> 00:07:44,560
screenshot

156
00:07:44,560 --> 00:07:47,520
next slide please

157
00:07:48,960 --> 00:07:51,360
now in the next slide we can see that i

158
00:07:51,360 --> 00:07:54,240
use the google doc in text with the help

159
00:07:54,240 --> 00:07:56,720
of which i was able to find the chat

160
00:07:56,720 --> 00:07:59,120
logs of an web application which

161
00:07:59,120 --> 00:08:02,080
contains some sensitive information and

162
00:08:02,080 --> 00:08:03,120
also

163
00:08:03,120 --> 00:08:05,840
it is very easily available to that

164
00:08:05,840 --> 00:08:09,280
to read the chat which was which i found

165
00:08:09,280 --> 00:08:13,120
through by using the google doc indexed

166
00:08:13,120 --> 00:08:16,319
next slide thank you the next uh

167
00:08:16,319 --> 00:08:18,879
methodology we used in recon is wayback

168
00:08:18,879 --> 00:08:21,199
machine way back machine helps in

169
00:08:21,199 --> 00:08:24,240
finding the changes made on a web page

170
00:08:24,240 --> 00:08:26,400
it is very easy to access payback

171
00:08:26,400 --> 00:08:28,879
machine to access the wayback machine we

172
00:08:28,879 --> 00:08:31,599
simply have to go on google type payback

173
00:08:31,599 --> 00:08:34,240
machine it will open up page as shown in

174
00:08:34,240 --> 00:08:35,760
the screenshot

175
00:08:35,760 --> 00:08:38,080
over there you have to put us name of

176
00:08:38,080 --> 00:08:40,880
the target site about which you want to

177
00:08:40,880 --> 00:08:43,440
search like you want to see the changes

178
00:08:43,440 --> 00:08:45,360
made on the site for example in this

179
00:08:45,360 --> 00:08:48,320
screenshot i search for a company named

180
00:08:48,320 --> 00:08:50,720
hudson group and it showed me it

181
00:08:50,720 --> 00:08:53,120
highlights the date on which the changes

182
00:08:53,120 --> 00:08:56,399
are made on that particular site

183
00:08:56,399 --> 00:08:59,040
the disadvantage of this is that

184
00:08:59,040 --> 00:09:01,920
sometimes that snapshots contain

185
00:09:01,920 --> 00:09:04,560
credential while inspecting the source

186
00:09:04,560 --> 00:09:07,200
code which results in bridge and

187
00:09:07,200 --> 00:09:09,279
security concerns

188
00:09:09,279 --> 00:09:12,240
next slide case

189
00:09:13,600 --> 00:09:16,480
the third methodology of recon is server

190
00:09:16,480 --> 00:09:18,560
fingerprinting server fingerprinting

191
00:09:18,560 --> 00:09:20,640
simply means finding details of the

192
00:09:20,640 --> 00:09:23,200
server on which the web applications are

193
00:09:23,200 --> 00:09:24,399
running

194
00:09:24,399 --> 00:09:27,200
in the first screenshot we can see that

195
00:09:27,200 --> 00:09:31,600
i sent a response through http abc.com

196
00:09:31,600 --> 00:09:32,320
and

197
00:09:32,320 --> 00:09:35,480
i sent a request sorry to http

198
00:09:35,480 --> 00:09:38,240
httpabcd.com and in the response i got

199
00:09:38,240 --> 00:09:41,279
the name of the server which is apache

200
00:09:41,279 --> 00:09:44,000
which shares apache server info with

201
00:09:44,000 --> 00:09:46,399
unix operating system

202
00:09:46,399 --> 00:09:49,200
in the selecting screenshot is it easily

203
00:09:49,200 --> 00:09:51,360
uh it can be seen that

204
00:09:51,360 --> 00:09:52,480
i sent

205
00:09:52,480 --> 00:09:55,519
and uh there was an error message i sent

206
00:09:55,519 --> 00:09:58,880
to get santa claus abcd

207
00:09:58,880 --> 00:10:01,440
but still there is an error message but

208
00:10:01,440 --> 00:10:04,079
it is rewarding back me with the server

209
00:10:04,079 --> 00:10:07,680
name which is nginx and its version

210
00:10:07,680 --> 00:10:10,640
next slide please

211
00:10:12,640 --> 00:10:14,800
so there are some automated scanning

212
00:10:14,800 --> 00:10:17,279
tools which we can also use for server

213
00:10:17,279 --> 00:10:20,000
fingerprinting and some of my favorite

214
00:10:20,000 --> 00:10:23,600
are burp scanner niko and map this oil

215
00:10:23,600 --> 00:10:26,320
tools helps in finding the weaknesses of

216
00:10:26,320 --> 00:10:29,120
the web application and also helps in

217
00:10:29,120 --> 00:10:31,760
exploitation of that weaknesses

218
00:10:31,760 --> 00:10:33,760
up next will be lalitha

219
00:10:33,760 --> 00:10:35,440
she will be sharing about few

220
00:10:35,440 --> 00:10:38,320
application furitas and security headers

221
00:10:38,320 --> 00:10:41,600
and more about the web applications

222
00:10:41,600 --> 00:10:44,640
hey everyone hope you can hear me now

223
00:10:44,640 --> 00:10:47,120
yeah we can hear you awesome thanks

224
00:10:47,120 --> 00:10:47,839
uh

225
00:10:47,839 --> 00:10:51,120
so since i missed my intro i'm la lithia

226
00:10:51,120 --> 00:10:53,760
so i cyber security graduate i did my

227
00:10:53,760 --> 00:10:56,959
master's uh in cyber security in 2020

228
00:10:56,959 --> 00:10:58,160
and then

229
00:10:58,160 --> 00:11:00,480
i did my internship with buck crowd as

230
00:11:00,480 --> 00:11:02,640
an application security engineer uh

231
00:11:02,640 --> 00:11:04,480
where i used to try it's a different

232
00:11:04,480 --> 00:11:07,279
kind of uh books that

233
00:11:07,279 --> 00:11:11,000
all over the world hackers

234
00:11:24,399 --> 00:11:27,440
um so today i'm gonna talk about absec

235
00:11:27,440 --> 00:11:29,360
filters like these are the basic filters

236
00:11:29,360 --> 00:11:30,959
there are more filters that you can

237
00:11:30,959 --> 00:11:32,880
apply to your application but i'm going

238
00:11:32,880 --> 00:11:34,959
to talk about some basic filters that

239
00:11:34,959 --> 00:11:36,720
you can what that you need

240
00:11:36,720 --> 00:11:40,240
for a web application um so some basic

241
00:11:40,240 --> 00:11:42,399
ones are going to cover as you see in

242
00:11:42,399 --> 00:11:44,399
the agenda so these are the basic ones

243
00:11:44,399 --> 00:11:46,320
that are gonna cover today

244
00:11:46,320 --> 00:11:49,360
next screen please

245
00:11:50,480 --> 00:11:51,279
so

246
00:11:51,279 --> 00:11:53,920
let's talk about some basic um

247
00:11:53,920 --> 00:11:56,079
security checks that need to be added to

248
00:11:56,079 --> 00:11:58,079
your web application so

249
00:11:58,079 --> 00:12:01,200
dmr check is something like um if you

250
00:12:01,200 --> 00:12:03,680
have a email service in your application

251
00:12:03,680 --> 00:12:05,839
and if you are sending some emails you

252
00:12:05,839 --> 00:12:07,920
want to make sure that they are under a

253
00:12:07,920 --> 00:12:11,040
registered domain and they doesn't have

254
00:12:11,040 --> 00:12:13,440
any malicious they are not vulnerable to

255
00:12:13,440 --> 00:12:16,399
some phishing attacks so uh outside in

256
00:12:16,399 --> 00:12:18,959
the commonwealth people will ask is it

257
00:12:18,959 --> 00:12:21,040
is it's it's your service registered

258
00:12:21,040 --> 00:12:23,440
under the mark so make sure your web

259
00:12:23,440 --> 00:12:26,240
application is registered under demag

260
00:12:26,240 --> 00:12:28,480
and we have an open tool to check your

261
00:12:28,480 --> 00:12:31,120
application is registered or not if not

262
00:12:31,120 --> 00:12:32,160
you can

263
00:12:32,160 --> 00:12:34,880
uh register yourself under the dmarc

264
00:12:34,880 --> 00:12:37,519
account for your web application and

265
00:12:37,519 --> 00:12:40,240
http headers check so we all know the

266
00:12:40,240 --> 00:12:42,880
http headers are quite most important

267
00:12:42,880 --> 00:12:45,200
for any application that we keep but

268
00:12:45,200 --> 00:12:47,360
sometimes we miss some important

269
00:12:47,360 --> 00:12:50,399
security headers but uh

270
00:12:50,399 --> 00:12:54,639
in in real time we don't uh really

271
00:12:54,639 --> 00:12:56,639
feel like these security measures are

272
00:12:56,639 --> 00:12:59,279
important even like top companies like

273
00:12:59,279 --> 00:13:02,160
google etc does miss some security

274
00:13:02,160 --> 00:13:04,720
headers but we have some open source

275
00:13:04,720 --> 00:13:05,680
tools

276
00:13:05,680 --> 00:13:07,920
that are designed and available in the

277
00:13:07,920 --> 00:13:10,240
market which you can go see which

278
00:13:10,240 --> 00:13:13,200
security headers are missing and you can

279
00:13:13,200 --> 00:13:15,600
add those security headers

280
00:13:15,600 --> 00:13:17,360
to your applications

281
00:13:17,360 --> 00:13:20,240
that's uh for headers and then exif

282
00:13:20,240 --> 00:13:22,800
check is like if your application is

283
00:13:22,800 --> 00:13:25,600
having an xf images

284
00:13:25,600 --> 00:13:28,000
so sometimes um

285
00:13:28,000 --> 00:13:30,480
if we have some open tools where ethical

286
00:13:30,480 --> 00:13:32,399
hackers uh use

287
00:13:32,399 --> 00:13:34,959
these uh free open source tools like xf

288
00:13:34,959 --> 00:13:37,279
headers and they grab their information

289
00:13:37,279 --> 00:13:39,279
from the images that we use in our web

290
00:13:39,279 --> 00:13:41,040
web application so

291
00:13:41,040 --> 00:13:43,600
they upload the image they see

292
00:13:43,600 --> 00:13:45,680
if they can disclose any information in

293
00:13:45,680 --> 00:13:48,240
that open source tools and it is

294
00:13:48,240 --> 00:13:50,560
sometimes it's vulnerable to

295
00:13:50,560 --> 00:13:52,560
uh information disclosure locate the

296
00:13:52,560 --> 00:13:55,839
server uh all these kind of info so

297
00:13:55,839 --> 00:13:58,079
make sure you're hiding all these

298
00:13:58,079 --> 00:14:01,279
additional information and being a

299
00:14:01,279 --> 00:14:03,360
like think like an ethical hacker go

300
00:14:03,360 --> 00:14:05,519
check and see uh make the security

301
00:14:05,519 --> 00:14:07,360
checks as possible

302
00:14:07,360 --> 00:14:10,800
update accordingly so if we have a web

303
00:14:10,800 --> 00:14:12,720
application um

304
00:14:12,720 --> 00:14:13,600
and

305
00:14:13,600 --> 00:14:16,160
sometimes it is the case like we have

306
00:14:16,160 --> 00:14:17,760
some um

307
00:14:17,760 --> 00:14:19,760
external links inside sorry internal

308
00:14:19,760 --> 00:14:22,000
links inside an application like

309
00:14:22,000 --> 00:14:23,839
your application web application may

310
00:14:23,839 --> 00:14:25,920
contain a facebook link a twitter link

311
00:14:25,920 --> 00:14:28,000
and an instagram or whatever the social

312
00:14:28,000 --> 00:14:30,480
media or any other links so if you are

313
00:14:30,480 --> 00:14:32,800
sometimes uh users delete their account

314
00:14:32,800 --> 00:14:35,120
but they forgot to update the links in

315
00:14:35,120 --> 00:14:37,839
in your application so which is a very

316
00:14:37,839 --> 00:14:40,000
very vulnerable attack and it may lead

317
00:14:40,000 --> 00:14:41,920
to broken authentication if it is caught

318
00:14:41,920 --> 00:14:44,240
by an ethical hacker sorry any hackers

319
00:14:44,240 --> 00:14:46,639
malicious malicious hackers

320
00:14:46,639 --> 00:14:49,839
um so make sure those links are updated

321
00:14:49,839 --> 00:14:51,920
as soon as if if it if you don't have

322
00:14:51,920 --> 00:14:53,760
the account just remove it if you have

323
00:14:53,760 --> 00:14:56,160
it just keep the valid account a link to

324
00:14:56,160 --> 00:14:57,279
the

325
00:14:57,279 --> 00:14:59,279
the ones that you have in your web

326
00:14:59,279 --> 00:15:02,320
application for external feature updates

327
00:15:02,320 --> 00:15:03,600
uh it's like

328
00:15:03,600 --> 00:15:06,320
for example uh the tls version transport

329
00:15:06,320 --> 00:15:09,680
layer security version um

330
00:15:09,680 --> 00:15:11,440
uh if

331
00:15:11,440 --> 00:15:14,160
recently if you have heard the news um

332
00:15:14,160 --> 00:15:16,480
the tls versions for encryption the

333
00:15:16,480 --> 00:15:17,680
algorithms

334
00:15:17,680 --> 00:15:20,079
uh has been updated deprecated like the

335
00:15:20,079 --> 00:15:22,000
previous versions have been deprecated

336
00:15:22,000 --> 00:15:24,639
in march 2020 and there's a new version

337
00:15:24,639 --> 00:15:25,600
which

338
00:15:25,600 --> 00:15:27,440
which has the additional security layer

339
00:15:27,440 --> 00:15:28,959
additional cipher

340
00:15:28,959 --> 00:15:32,000
uh text uh related kind of algorithms

341
00:15:32,000 --> 00:15:34,160
which you need to upgrade it to your

342
00:15:34,160 --> 00:15:36,480
application so if your application is

343
00:15:36,480 --> 00:15:38,720
falling way back to the previous

344
00:15:38,720 --> 00:15:40,639
versions of tls make sure they are

345
00:15:40,639 --> 00:15:42,720
updated to the new version so make sure

346
00:15:42,720 --> 00:15:45,199
you are updating the external features

347
00:15:45,199 --> 00:15:48,160
as well so this will lead to uh this

348
00:15:48,160 --> 00:15:50,639
will help you to protect from broken

349
00:15:50,639 --> 00:15:55,480
authentication next slide please

350
00:15:57,759 --> 00:16:00,720
rate limit validation is a kind of check

351
00:16:00,720 --> 00:16:04,079
is like if you have a web application

352
00:16:04,079 --> 00:16:05,440
and

353
00:16:05,440 --> 00:16:07,519
obviously every web application normally

354
00:16:07,519 --> 00:16:09,600
will have a login on logout page uh for

355
00:16:09,600 --> 00:16:11,199
example i'm saying that there are many

356
00:16:11,199 --> 00:16:13,759
kind of uh rate limit validations that

357
00:16:13,759 --> 00:16:16,639
you can apply to your application and if

358
00:16:16,639 --> 00:16:19,600
you have a forgot password link and then

359
00:16:19,600 --> 00:16:22,160
it if a forgot password link it can be

360
00:16:22,160 --> 00:16:24,399
used for many multiple times we have

361
00:16:24,399 --> 00:16:27,759
many automated tools which uh and uh

362
00:16:27,759 --> 00:16:30,720
malicious hacker can use it and then he

363
00:16:30,720 --> 00:16:34,240
can uh try to uh send a continuous uh

364
00:16:34,240 --> 00:16:38,240
request to the uh trusted owner but if

365
00:16:38,240 --> 00:16:40,160
we don't have the rate limit validation

366
00:16:40,160 --> 00:16:43,759
check applied to the um credentials the

367
00:16:43,759 --> 00:16:45,360
fields that you have

368
00:16:45,360 --> 00:16:46,079
so

369
00:16:46,079 --> 00:16:48,880
for an example if forgot password link

370
00:16:48,880 --> 00:16:53,759
if it's uh like it used many times then

371
00:16:53,759 --> 00:16:55,759
it doesn't make any sense if it's still

372
00:16:55,759 --> 00:16:57,680
working because it should be validated

373
00:16:57,680 --> 00:16:59,759
after one time it should expire and it

374
00:16:59,759 --> 00:17:02,240
should not work so make sure this check

375
00:17:02,240 --> 00:17:04,480
is applied when you have some external

376
00:17:04,480 --> 00:17:05,359
links

377
00:17:05,359 --> 00:17:07,919
this also applies for username changing

378
00:17:07,919 --> 00:17:09,199
and

379
00:17:09,199 --> 00:17:12,079
account uh login logout and many other

380
00:17:12,079 --> 00:17:14,079
fields but make sure if you are sending

381
00:17:14,079 --> 00:17:17,119
any emails uh to i mean if you want your

382
00:17:17,119 --> 00:17:19,199
link to send to an email they are

383
00:17:19,199 --> 00:17:22,240
validated with a rate limit

384
00:17:22,240 --> 00:17:25,120
next slide please

385
00:17:26,079 --> 00:17:28,799
cookie handlings cookie handlings is

386
00:17:28,799 --> 00:17:30,640
something like um

387
00:17:30,640 --> 00:17:31,440
so

388
00:17:31,440 --> 00:17:34,320
we do have many uh secure properties but

389
00:17:34,320 --> 00:17:36,240
apart from that we do also have one

390
00:17:36,240 --> 00:17:38,799
other property called same site property

391
00:17:38,799 --> 00:17:42,240
which is inside a cookie and it can be

392
00:17:42,240 --> 00:17:45,280
uh set to some properties like it has

393
00:17:45,280 --> 00:17:49,360
attribute attributes like lags or strict

394
00:17:49,360 --> 00:17:52,240
so if you set those properties for this

395
00:17:52,240 --> 00:17:54,799
same site and as for these attributes to

396
00:17:54,799 --> 00:17:57,919
same side property then it will prevent

397
00:17:57,919 --> 00:18:00,640
you to prevent the application from

398
00:18:00,640 --> 00:18:04,080
cross site request for jury attack so

399
00:18:04,080 --> 00:18:06,880
in an application if you see

400
00:18:06,880 --> 00:18:09,360
if you open the cookies and using some

401
00:18:09,360 --> 00:18:11,840
chrome browser extension tools

402
00:18:11,840 --> 00:18:13,039
you will see

403
00:18:13,039 --> 00:18:15,120
third party cookies as well as the first

404
00:18:15,120 --> 00:18:16,559
party cookies first party cookies are

405
00:18:16,559 --> 00:18:18,720
nothing but the application to that uh

406
00:18:18,720 --> 00:18:19,919
particular

407
00:18:19,919 --> 00:18:22,080
um to your application but third-party

408
00:18:22,080 --> 00:18:24,320
cookies are the ones that you use inside

409
00:18:24,320 --> 00:18:25,679
your application

410
00:18:25,679 --> 00:18:28,400
those are like external and if you

411
00:18:28,400 --> 00:18:32,000
don't set the same side property uh to

412
00:18:32,000 --> 00:18:32,960
um

413
00:18:32,960 --> 00:18:35,440
lags or strict as i told you lacks a

414
00:18:35,440 --> 00:18:37,520
restrictor the attributes one is subset

415
00:18:37,520 --> 00:18:40,080
of other we can say um so these

416
00:18:40,080 --> 00:18:43,440
third-party cookies can be inserted by a

417
00:18:43,440 --> 00:18:45,760
malicious hacker and it is vulnerable to

418
00:18:45,760 --> 00:18:48,240
a cross-site request forgery

419
00:18:48,240 --> 00:18:50,480
so this is another filter basic filter

420
00:18:50,480 --> 00:18:52,720
that we can use

421
00:18:52,720 --> 00:18:55,039
error handling filter check this is the

422
00:18:55,039 --> 00:18:57,600
most common one where um

423
00:18:57,600 --> 00:19:00,000
i think malicious hackers gets

424
00:19:00,000 --> 00:19:02,320
information about what's happening in

425
00:19:02,320 --> 00:19:05,200
your application and what they can guess

426
00:19:05,200 --> 00:19:07,360
easily like um

427
00:19:07,360 --> 00:19:09,840
if you have an application and if you

428
00:19:09,840 --> 00:19:12,880
disclose errors they they derive

429
00:19:12,880 --> 00:19:15,760
information based on the errors that you

430
00:19:15,760 --> 00:19:18,480
provide so if you provide any detailed

431
00:19:18,480 --> 00:19:20,799
uh error messages or if you even if you

432
00:19:20,799 --> 00:19:24,240
provide any uh hints that let the

433
00:19:24,240 --> 00:19:26,240
ethical hacker decide okay this is

434
00:19:26,240 --> 00:19:28,880
particular a particular

435
00:19:28,880 --> 00:19:30,799
that's that's known for information

436
00:19:30,799 --> 00:19:33,679
disclosure then it may lead to some

437
00:19:33,679 --> 00:19:36,480
other vulnerable attacks so one uh

438
00:19:36,480 --> 00:19:39,600
example we can say it like if you have a

439
00:19:39,600 --> 00:19:42,640
login field and if you have a username

440
00:19:42,640 --> 00:19:44,559
uh field and if you have a password

441
00:19:44,559 --> 00:19:46,880
field and if you enter an invalid

442
00:19:46,880 --> 00:19:48,960
username with an invalid password and if

443
00:19:48,960 --> 00:19:51,600
you display a hint error message

444
00:19:51,600 --> 00:19:52,880
something like

445
00:19:52,880 --> 00:19:55,520
this user doesn't exist in your system

446
00:19:55,520 --> 00:19:56,799
then the

447
00:19:56,799 --> 00:19:59,360
hacker can know that oh this user isn't

448
00:19:59,360 --> 00:20:01,840
existing isn't existing in the system

449
00:20:01,840 --> 00:20:03,520
and if he tries with the

450
00:20:03,520 --> 00:20:06,240
valid username and an invalid password

451
00:20:06,240 --> 00:20:08,880
and if if the error message says in just

452
00:20:08,880 --> 00:20:11,039
the incorrect password then it's easy

453
00:20:11,039 --> 00:20:13,600
for him okay this uh username is getting

454
00:20:13,600 --> 00:20:16,960
enumerated so he can directly guess he

455
00:20:16,960 --> 00:20:18,880
or she can directly guess

456
00:20:18,880 --> 00:20:21,200
so this will lead to income information

457
00:20:21,200 --> 00:20:22,880
disclosure

458
00:20:22,880 --> 00:20:25,120
and the other thing i would like to talk

459
00:20:25,120 --> 00:20:28,640
about is input validations which is the

460
00:20:28,640 --> 00:20:32,240
most important one these days because um

461
00:20:32,240 --> 00:20:33,919
most of the attacks that we see in the

462
00:20:33,919 --> 00:20:36,080
real time are due to in input

463
00:20:36,080 --> 00:20:38,559
validations so if you have a web

464
00:20:38,559 --> 00:20:41,760
application make sure uh your each uh

465
00:20:41,760 --> 00:20:45,120
field is validated properly because all

466
00:20:45,120 --> 00:20:48,640
of our web applications nowadays um use

467
00:20:48,640 --> 00:20:51,360
those fields to bring out data convert

468
00:20:51,360 --> 00:20:54,640
data send emails uh do some other stuff

469
00:20:54,640 --> 00:20:58,000
etc and if we give an ethical hacker to

470
00:20:58,000 --> 00:21:00,640
input a string fields with some

471
00:21:00,640 --> 00:21:02,720
malicious payloads that are completely

472
00:21:02,720 --> 00:21:04,880
available in the market and if they if

473
00:21:04,880 --> 00:21:06,480
we send them to

474
00:21:06,480 --> 00:21:09,120
um an email to a different person then

475
00:21:09,120 --> 00:21:12,799
the person is uh almost uh almost he got

476
00:21:12,799 --> 00:21:14,000
his uh

477
00:21:14,000 --> 00:21:16,880
laptop got hacked so make sure the input

478
00:21:16,880 --> 00:21:19,120
field is validated uh

479
00:21:19,120 --> 00:21:21,600
like if you have the string fields this

480
00:21:21,600 --> 00:21:23,840
that should not uh

481
00:21:23,840 --> 00:21:25,919
start with some character special

482
00:21:25,919 --> 00:21:28,159
characters so that they are validated

483
00:21:28,159 --> 00:21:30,320
even the file types because almost all

484
00:21:30,320 --> 00:21:32,080
web applications will have your file

485
00:21:32,080 --> 00:21:33,760
types

486
00:21:33,760 --> 00:21:34,880
so

487
00:21:34,880 --> 00:21:37,440
while you are uh uploading if if you

488
00:21:37,440 --> 00:21:39,120
have file types make sure they are

489
00:21:39,120 --> 00:21:42,000
restricted to that particular file types

490
00:21:42,000 --> 00:21:44,960
so vulnerability to file upload bypass

491
00:21:44,960 --> 00:21:46,080
is uh

492
00:21:46,080 --> 00:21:48,000
most common these days

493
00:21:48,000 --> 00:21:50,720
um and uh my friend rigakshi she gonna

494
00:21:50,720 --> 00:21:53,679
continue um to explain about the file

495
00:21:53,679 --> 00:21:55,760
upload bypass and

496
00:21:55,760 --> 00:21:58,960
demo how actually it works

497
00:21:58,960 --> 00:22:01,280
thanks

498
00:22:01,440 --> 00:22:04,000
hi everyone uh

499
00:22:04,000 --> 00:22:06,640
thank you lalitya for handing over to me

500
00:22:06,640 --> 00:22:10,799
uh well uh as you know we were going to

501
00:22:10,799 --> 00:22:13,840
uh exploit more of file upload bypass

502
00:22:13,840 --> 00:22:16,480
with me uh so i'm gonna

503
00:22:16,480 --> 00:22:19,440
say that file upload bypass is not the

504
00:22:19,440 --> 00:22:22,159
nor not the only vulnerability but is

505
00:22:22,159 --> 00:22:25,200
it's also exploited a lot in the world

506
00:22:25,200 --> 00:22:26,559
and

507
00:22:26,559 --> 00:22:28,559
i'm going to talk more about

508
00:22:28,559 --> 00:22:30,960
file upload bypass in modern web

509
00:22:30,960 --> 00:22:32,559
applications

510
00:22:32,559 --> 00:22:35,120
uh so i'm going to start with

511
00:22:35,120 --> 00:22:37,679
introducing the vulnerability and then

512
00:22:37,679 --> 00:22:40,400
i'll show you a little bit more of

513
00:22:40,400 --> 00:22:43,840
different filtering types of uh

514
00:22:43,840 --> 00:22:46,799
that are used to uh avoid file upload

515
00:22:46,799 --> 00:22:50,080
bypass vulnerability i will give you a

516
00:22:50,080 --> 00:22:52,880
small demo and then detailed analysis of

517
00:22:52,880 --> 00:22:55,840
that demo

518
00:22:56,000 --> 00:22:58,240
well uh what is

519
00:22:58,240 --> 00:23:01,120
actually this vulnerability uploading a

520
00:23:01,120 --> 00:23:03,600
file to a web server is generally a

521
00:23:03,600 --> 00:23:06,080
feature in many web application for

522
00:23:06,080 --> 00:23:09,840
example you might want to upload a cv

523
00:23:09,840 --> 00:23:12,240
certain documents you might want to

524
00:23:12,240 --> 00:23:15,600
upload a video presentation or any other

525
00:23:15,600 --> 00:23:18,880
files that you want uh people or your

526
00:23:18,880 --> 00:23:21,600
community to enjoy

527
00:23:21,600 --> 00:23:23,600
some important documents that you want

528
00:23:23,600 --> 00:23:25,679
to send to the government and

529
00:23:25,679 --> 00:23:27,360
things like that

530
00:23:27,360 --> 00:23:30,320
so file uploading isn't is an important

531
00:23:30,320 --> 00:23:33,000
feature in applications well

532
00:23:33,000 --> 00:23:35,760
unrestricted file upload vulnerability

533
00:23:35,760 --> 00:23:37,600
is just uh

534
00:23:37,600 --> 00:23:41,200
it just means that uh having less

535
00:23:41,200 --> 00:23:44,960
validation options or not doing enough

536
00:23:44,960 --> 00:23:48,720
uh validation on the uploaded file

537
00:23:48,720 --> 00:23:50,720
what attackers aim is

538
00:23:50,720 --> 00:23:52,000
here is

539
00:23:52,000 --> 00:23:54,960
to uh upload some malicious code into

540
00:23:54,960 --> 00:23:58,480
the software code or uh inserting some

541
00:23:58,480 --> 00:24:02,240
malicious code in the website uh so

542
00:24:02,240 --> 00:24:04,480
this is this is very common in other

543
00:24:04,480 --> 00:24:06,799
vulnerabilities as well but in file

544
00:24:06,799 --> 00:24:09,200
upload wipers since we are uploading a

545
00:24:09,200 --> 00:24:10,880
file it is

546
00:24:10,880 --> 00:24:13,919
it could be way more harmful as we can

547
00:24:13,919 --> 00:24:15,840
upload uh

548
00:24:15,840 --> 00:24:17,760
more code for code

549
00:24:17,760 --> 00:24:20,799
code into the software just by a file

550
00:24:20,799 --> 00:24:21,600
which

551
00:24:21,600 --> 00:24:25,039
is entering the server

552
00:24:26,240 --> 00:24:29,440
so uh a little bit more about web shells

553
00:24:29,440 --> 00:24:33,120
and rcas rc is remote code execution due

554
00:24:33,120 --> 00:24:36,159
to uh a web shell

555
00:24:36,159 --> 00:24:37,200
so

556
00:24:37,200 --> 00:24:40,640
this is a one liner php code php eco

557
00:24:40,640 --> 00:24:43,919
file get contents path to file

558
00:24:43,919 --> 00:24:47,200
so uh event you see this part

559
00:24:47,200 --> 00:24:50,720
path to target file uh it essentially

560
00:24:50,720 --> 00:24:54,480
means that we want to access whatever is

561
00:24:54,480 --> 00:24:57,840
present on this path and uh get contents

562
00:24:57,840 --> 00:25:00,400
will get the contents of the

563
00:25:00,400 --> 00:25:03,360
of the folders or whatever is present on

564
00:25:03,360 --> 00:25:06,320
this file part and this small one liner

565
00:25:06,320 --> 00:25:09,120
code can be uploaded to uh

566
00:25:09,120 --> 00:25:11,200
to a server where

567
00:25:11,200 --> 00:25:13,679
it was essentially looking for an image

568
00:25:13,679 --> 00:25:17,600
or a video or something but it never uh

569
00:25:17,600 --> 00:25:20,240
never disallowed the php code to be

570
00:25:20,240 --> 00:25:23,279
entered anyway

571
00:25:25,520 --> 00:25:27,840
so let's start with a little bit more

572
00:25:27,840 --> 00:25:29,840
about filters

573
00:25:29,840 --> 00:25:32,080
there could be some filters that are

574
00:25:32,080 --> 00:25:34,400
just client-side filters and there are

575
00:25:34,400 --> 00:25:36,240
other filters that are server-side

576
00:25:36,240 --> 00:25:37,440
filters

577
00:25:37,440 --> 00:25:40,880
uh in general cases client-side filters

578
00:25:40,880 --> 00:25:43,279
are easier to bypass than the

579
00:25:43,279 --> 00:25:44,960
server-side filters

580
00:25:44,960 --> 00:25:48,080
because uh it's way more easier to know

581
00:25:48,080 --> 00:25:51,279
what the client-side filters are just by

582
00:25:51,279 --> 00:25:52,400
uh

583
00:25:52,400 --> 00:25:56,000
checking uh the the normal uh traffic on

584
00:25:56,000 --> 00:25:58,240
the website uploading something and then

585
00:25:58,240 --> 00:26:00,559
checking the traffic but server side

586
00:26:00,559 --> 00:26:03,760
filters are way more harder to bypass so

587
00:26:03,760 --> 00:26:06,640
it's always better to have more server

588
00:26:06,640 --> 00:26:10,320
side filters in place as well uh some of

589
00:26:10,320 --> 00:26:13,039
the filters i'm going to discuss here

590
00:26:13,039 --> 00:26:13,840
are

591
00:26:13,840 --> 00:26:16,400
multi-purpose internet mail

592
00:26:16,400 --> 00:26:20,400
extension uh actually called mime it was

593
00:26:20,400 --> 00:26:23,679
initially made to filter mails that is

594
00:26:23,679 --> 00:26:24,960
why the name

595
00:26:24,960 --> 00:26:28,720
but now it is also it is not used in the

596
00:26:28,720 --> 00:26:31,600
mails anymore but it's used in file

597
00:26:31,600 --> 00:26:34,480
upload bypass and as you can see the

598
00:26:34,480 --> 00:26:37,840
content type image slash png in the

599
00:26:37,840 --> 00:26:40,240
image shown

600
00:26:40,240 --> 00:26:41,039
so

601
00:26:41,039 --> 00:26:43,520
this is the content type header that's

602
00:26:43,520 --> 00:26:46,240
generally uh present if uh if i'm

603
00:26:46,240 --> 00:26:49,120
uploading a jpeg image then it will show

604
00:26:49,120 --> 00:26:52,080
content type header as imagej

605
00:26:52,080 --> 00:26:55,360
but we can easily edit it and i i can

606
00:26:55,360 --> 00:26:59,120
show more of this in the demo later but

607
00:26:59,120 --> 00:27:01,520
if you changed it change it to something

608
00:27:01,520 --> 00:27:02,960
else then

609
00:27:02,960 --> 00:27:05,120
the server might get fooled

610
00:27:05,120 --> 00:27:07,200
and instead

611
00:27:07,200 --> 00:27:09,679
another file gets uploaded

612
00:27:09,679 --> 00:27:12,240
magic number validation is another type

613
00:27:12,240 --> 00:27:14,159
of validation

614
00:27:14,159 --> 00:27:17,440
that is put as a filter in

615
00:27:17,440 --> 00:27:20,240
in many web applications so when we

616
00:27:20,240 --> 00:27:22,799
upload a jpeg file it generally has

617
00:27:22,799 --> 00:27:26,640
hexadecimal values starting with f8 d8

618
00:27:26,640 --> 00:27:30,240
this is the magic number of jpeg file

619
00:27:30,240 --> 00:27:32,480
similar to that there are different

620
00:27:32,480 --> 00:27:35,600
magic numbers of different files mp3

621
00:27:35,600 --> 00:27:37,840
files can have a different

622
00:27:37,840 --> 00:27:40,720
magic number which and we can always use

623
00:27:40,720 --> 00:27:42,960
a hexadecimal editor to change that

624
00:27:42,960 --> 00:27:44,240
value

625
00:27:44,240 --> 00:27:46,720
so we can change the value and fool the

626
00:27:46,720 --> 00:27:49,919
server that this is not a php file this

627
00:27:49,919 --> 00:27:53,840
is the jpeg file and things like that

628
00:27:57,039 --> 00:28:00,080
another filter is file length filtering

629
00:28:00,080 --> 00:28:03,440
uh so while this is not really a great

630
00:28:03,440 --> 00:28:06,880
filter it can prevent some of the denial

631
00:28:06,880 --> 00:28:10,159
of or of service or dos attacks

632
00:28:10,159 --> 00:28:13,600
uh you can find a lot more about a lot

633
00:28:13,600 --> 00:28:15,200
of web shelves present at

634
00:28:15,200 --> 00:28:18,200
printestermonkey.net

635
00:28:18,240 --> 00:28:19,440
the link is

636
00:28:19,440 --> 00:28:21,279
present in this line

637
00:28:21,279 --> 00:28:24,559
well filters filtering files on maximum

638
00:28:24,559 --> 00:28:25,760
size

639
00:28:25,760 --> 00:28:29,039
can be helpful sometimes when uh when

640
00:28:29,039 --> 00:28:31,039
someone some attacker find a

641
00:28:31,039 --> 00:28:33,200
vulnerability that can be

642
00:28:33,200 --> 00:28:36,799
exploited with a long uh set of code but

643
00:28:36,799 --> 00:28:40,480
cannot be exploited by a one liner yeah

644
00:28:40,480 --> 00:28:42,640
this could be helpful file name

645
00:28:42,640 --> 00:28:45,039
filtering is another type of filtering

646
00:28:45,039 --> 00:28:46,480
that

647
00:28:46,480 --> 00:28:49,919
is put there uh to ensure that there are

648
00:28:49,919 --> 00:28:53,120
no duplicates being uploaded by the

649
00:28:53,120 --> 00:28:56,399
attacker for example appending a random

650
00:28:56,399 --> 00:28:59,760
string to a file name upon upload can

651
00:28:59,760 --> 00:29:01,120
prevent this

652
00:29:01,120 --> 00:29:04,000
there could be a certain change in the

653
00:29:04,000 --> 00:29:06,320
file name when the file name files are

654
00:29:06,320 --> 00:29:08,720
uploaded so if same name file is

655
00:29:08,720 --> 00:29:09,919
uploaded

656
00:29:09,919 --> 00:29:12,559
you could just change the name we could

657
00:29:12,559 --> 00:29:15,360
also sanitize bad characters

658
00:29:15,360 --> 00:29:19,279
like uh add the date slash dot dot slash

659
00:29:19,279 --> 00:29:22,240
so sometimes we use slash dot dot slash

660
00:29:22,240 --> 00:29:23,360
to enter

661
00:29:23,360 --> 00:29:26,080
another location and save our file to

662
00:29:26,080 --> 00:29:28,559
temp folder or something somewhere where

663
00:29:28,559 --> 00:29:31,520
it's not meant to be stored

664
00:29:31,520 --> 00:29:33,360
and thus access

665
00:29:33,360 --> 00:29:38,600
xc password files and root files

666
00:29:40,240 --> 00:29:42,960
so uh let's talk about file content

667
00:29:42,960 --> 00:29:45,760
filtering file content filtering is a

668
00:29:45,760 --> 00:29:47,760
new way uh it's

669
00:29:47,760 --> 00:29:50,320
not it's it has not been very common in

670
00:29:50,320 --> 00:29:51,279
the past

671
00:29:51,279 --> 00:29:54,000
but it basically looks for text strings

672
00:29:54,000 --> 00:29:57,200
or objects within images and it looks

673
00:29:57,200 --> 00:30:00,159
for content patterns

674
00:30:00,159 --> 00:30:02,399
it looks for different uh

675
00:30:02,399 --> 00:30:05,200
spoofing attempts it studies how

676
00:30:05,200 --> 00:30:07,200
attackers have been attacking an

677
00:30:07,200 --> 00:30:10,000
organization or similar businesses

678
00:30:10,000 --> 00:30:13,120
uh it looks for uh those patents that

679
00:30:13,120 --> 00:30:15,760
have been there in the past like

680
00:30:15,760 --> 00:30:18,880
and looks for certain signatures

681
00:30:18,880 --> 00:30:21,440
malwares could have some signatures and

682
00:30:21,440 --> 00:30:25,360
then detects those files uh so this is

683
00:30:25,360 --> 00:30:27,840
used in complex uh

684
00:30:27,840 --> 00:30:31,279
organizations and uh as it is way harder

685
00:30:31,279 --> 00:30:34,159
to implement

686
00:30:34,159 --> 00:30:35,120
and then

687
00:30:35,120 --> 00:30:37,600
there is the last one is extension

688
00:30:37,600 --> 00:30:40,559
validation this allows and injects a

689
00:30:40,559 --> 00:30:43,679
file based on the allowed list of

690
00:30:43,679 --> 00:30:47,039
extensions and denied list of extensions

691
00:30:47,039 --> 00:30:49,039
while uh

692
00:30:49,039 --> 00:30:52,399
having a blacklist is possible we can

693
00:30:52,399 --> 00:30:54,399
have certain uh

694
00:30:54,399 --> 00:30:57,840
certain extensions in our blacklist but

695
00:30:57,840 --> 00:31:00,640
whitelist is way more preferred from

696
00:31:00,640 --> 00:31:02,840
security perspectives

697
00:31:02,840 --> 00:31:06,960
because we have seen we have seen now

698
00:31:06,960 --> 00:31:09,440
that there could be people using null

699
00:31:09,440 --> 00:31:12,240
byte extension like php percentage zero

700
00:31:12,240 --> 00:31:14,880
zero shows shown in the image

701
00:31:14,880 --> 00:31:17,679
this kind of file will be a jpeg will be

702
00:31:17,679 --> 00:31:21,120
considered as a jpeg image by the server

703
00:31:21,120 --> 00:31:23,840
and thus gets uploaded to the server

704
00:31:23,840 --> 00:31:28,279
double extensions like php.jpg

705
00:31:30,240 --> 00:31:35,039
and alternate extensions are also common

706
00:31:40,559 --> 00:31:42,399
let's start with a

707
00:31:42,399 --> 00:31:45,039
quick demo

708
00:31:45,200 --> 00:31:47,840
sorry about that

709
00:31:48,000 --> 00:31:52,640
yeah so uh there's a portugal lab

710
00:31:52,640 --> 00:31:56,480
where uh where uh we are going to bypass

711
00:31:56,480 --> 00:31:58,880
a content type restriction

712
00:31:58,880 --> 00:32:01,519
bypass so uh

713
00:32:01,519 --> 00:32:03,760
we have a web shell

714
00:32:03,760 --> 00:32:06,799
file that we have created already and we

715
00:32:06,799 --> 00:32:08,640
are going to bypass a content type

716
00:32:08,640 --> 00:32:10,720
restriction

717
00:32:10,720 --> 00:32:13,519
uh this is the port cigar lab

718
00:32:13,519 --> 00:32:15,679
just look at the php shell we are

719
00:32:15,679 --> 00:32:18,799
uploading it uh

720
00:32:19,200 --> 00:32:21,440
here and we are

721
00:32:21,440 --> 00:32:24,159
checking the request on burp on the

722
00:32:24,159 --> 00:32:26,880
other side

723
00:32:26,880 --> 00:32:29,840
so when we check the request uh the this

724
00:32:29,840 --> 00:32:33,200
is a php one liner code php eco file get

725
00:32:33,200 --> 00:32:34,480
contents

726
00:32:34,480 --> 00:32:37,039
and it's trying to access the contents

727
00:32:37,039 --> 00:32:40,640
of home carlos secret

728
00:32:40,640 --> 00:32:43,440
as you can see the content type is text

729
00:32:43,440 --> 00:32:46,480
slash hp

730
00:32:47,519 --> 00:32:50,480
so here we are not going to do anything

731
00:32:50,480 --> 00:32:52,320
we will just uh

732
00:32:52,320 --> 00:32:55,440
check the request check the content type

733
00:32:55,440 --> 00:32:57,120
header

734
00:32:57,120 --> 00:32:58,399
and the file

735
00:32:58,399 --> 00:33:00,720
and the file contents and we will

736
00:33:00,720 --> 00:33:05,279
forward this request and i try to upload

737
00:33:08,840 --> 00:33:12,720
it so as you can see that it's uh it

738
00:33:12,720 --> 00:33:15,039
says sorry and the file has not been

739
00:33:15,039 --> 00:33:18,320
uploaded to the server

740
00:33:18,399 --> 00:33:22,000
now again i'll try to

741
00:33:22,000 --> 00:33:25,840
upload this file again

742
00:33:35,760 --> 00:33:38,000
so i uploaded the file and insert

743
00:33:38,000 --> 00:33:41,120
intercepted the request again

744
00:33:41,120 --> 00:33:43,360
and

745
00:33:44,799 --> 00:33:49,039
notice that it's again text php

746
00:33:49,039 --> 00:33:51,919
and we are just going to update it to

747
00:33:51,919 --> 00:33:55,919
image slash jpeg

748
00:34:03,600 --> 00:34:05,919
so the file is successfully uploaded and

749
00:34:05,919 --> 00:34:08,639
now let's see it's uploaded in after or

750
00:34:08,639 --> 00:34:10,000
no

751
00:34:10,000 --> 00:34:13,040
uh let's go back to the account and try

752
00:34:13,040 --> 00:34:14,480
to access

753
00:34:14,480 --> 00:34:15,839
the uh

754
00:34:15,839 --> 00:34:17,520
the source code of

755
00:34:17,520 --> 00:34:18,480
uh

756
00:34:18,480 --> 00:34:21,480
avatar

757
00:34:28,719 --> 00:34:31,520
yeah so this i find the source code of

758
00:34:31,520 --> 00:34:32,320
the

759
00:34:32,320 --> 00:34:33,199
and

760
00:34:33,199 --> 00:34:35,679
this is the content of the file

761
00:34:35,679 --> 00:34:38,399
we successfully uploaded the web shell

762
00:34:38,399 --> 00:34:41,598
and executed it

763
00:34:42,639 --> 00:34:45,040
thank you everyone and we welcome you to

764
00:34:45,040 --> 00:34:49,839
ask more questions from all of us

765
00:34:57,950 --> 00:35:01,189
[Music]

766
00:35:25,119 --> 00:35:28,119
hmm

767
00:35:48,880 --> 00:35:50,960
you

