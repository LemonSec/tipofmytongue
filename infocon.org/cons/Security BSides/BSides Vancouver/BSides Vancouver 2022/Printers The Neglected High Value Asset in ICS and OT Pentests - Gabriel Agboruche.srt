1
00:00:04,000 --> 00:00:05,040
okay

2
00:00:05,040 --> 00:00:06,879
well welcome everybody um looks like

3
00:00:06,879 --> 00:00:09,200
we're live here um so just want to start

4
00:00:09,200 --> 00:00:11,120
the uh talk here my name is gabriel

5
00:00:11,120 --> 00:00:14,559
agbaruchi um and again welcome to

6
00:00:14,559 --> 00:00:17,119
b-sides vancouver 2022 this is my first

7
00:00:17,119 --> 00:00:19,760
time speaking at this event and i am

8
00:00:19,760 --> 00:00:22,080
liking it i've been backstage i've been

9
00:00:22,080 --> 00:00:24,000
listening to all of what has been going

10
00:00:24,000 --> 00:00:26,720
on from incident response to i think

11
00:00:26,720 --> 00:00:29,119
other people cover ics and ot subjects

12
00:00:29,119 --> 00:00:30,960
pin testing and all these different

13
00:00:30,960 --> 00:00:33,840
subjects in security they they give me a

14
00:00:33,840 --> 00:00:36,239
lot of joy and a lot of happiness within

15
00:00:36,239 --> 00:00:38,320
my heart because i have a very strong

16
00:00:38,320 --> 00:00:40,960
love for this industry so again gabriela

17
00:00:40,960 --> 00:00:42,480
garuchi and i work for an organization

18
00:00:42,480 --> 00:00:45,039
called accenture we're a consulting firm

19
00:00:45,039 --> 00:00:47,280
specifically we have a very technical

20
00:00:47,280 --> 00:00:50,640
focus um and specifically i'm in the ot

21
00:00:50,640 --> 00:00:52,640
or ics and ot

22
00:00:52,640 --> 00:00:55,199
cyber security practice and i serve as a

23
00:00:55,199 --> 00:00:58,399
manager um let me see how to progress

24
00:00:58,399 --> 00:01:00,559
okay i can progress which is awesome

25
00:01:00,559 --> 00:01:02,160
okay a little bit more background about

26
00:01:02,160 --> 00:01:04,479
myself again gabriel agrees and you see

27
00:01:04,479 --> 00:01:06,400
all these little pictures here to the

28
00:01:06,400 --> 00:01:08,640
left i'll i'll start to the right with

29
00:01:08,640 --> 00:01:10,640
all the boring stuff um and then i'll

30
00:01:10,640 --> 00:01:12,080
get to the left where it talks where

31
00:01:12,080 --> 00:01:14,000
it's more of the cool stuff so on the

32
00:01:14,000 --> 00:01:15,920
right those are all the certifications

33
00:01:15,920 --> 00:01:18,720
and the degrees from the cisco surge to

34
00:01:18,720 --> 00:01:21,840
the sand surfs um and my bachelor's

35
00:01:21,840 --> 00:01:23,200
degree is actually in electrical

36
00:01:23,200 --> 00:01:25,680
engineering so i come from a little bit

37
00:01:25,680 --> 00:01:28,240
less of a tech background or i'd say

38
00:01:28,240 --> 00:01:30,560
administration a lot of people have like

39
00:01:30,560 --> 00:01:32,560
masters of information systems or

40
00:01:32,560 --> 00:01:34,640
computer science specifically come from

41
00:01:34,640 --> 00:01:37,520
very traditional electrical engineering

42
00:01:37,520 --> 00:01:40,159
where we go over the calculus and

43
00:01:40,159 --> 00:01:41,759
physics and

44
00:01:41,759 --> 00:01:43,600
and and all types of other very

45
00:01:43,600 --> 00:01:46,880
technical but not tech type of subject

46
00:01:46,880 --> 00:01:49,600
matter very math intensive and then

47
00:01:49,600 --> 00:01:51,439
later i decided to go forward with a

48
00:01:51,439 --> 00:01:53,040
bachelor's in cyber security tech

49
00:01:53,040 --> 00:01:54,640
technology because i love the field so

50
00:01:54,640 --> 00:01:56,159
much um

51
00:01:56,159 --> 00:01:57,600
kind of a little bit more about me as it

52
00:01:57,600 --> 00:01:59,280
says i'm a regular speaker at like the

53
00:01:59,280 --> 00:02:01,759
sands conferences um for those who are

54
00:02:01,759 --> 00:02:04,159
very familiar with cyber security um

55
00:02:04,159 --> 00:02:06,719
spoken at the sands ics summits i've

56
00:02:06,719 --> 00:02:08,878
been talking at the hack the capitol

57
00:02:08,878 --> 00:02:10,959
actually have that one tomorrow i'm i'm

58
00:02:10,959 --> 00:02:13,360
gonna be speaking at in sans oil and gas

59
00:02:13,360 --> 00:02:15,280
summons stan is new to cyber so i'm kind

60
00:02:15,280 --> 00:02:18,319
of like a sans junkie here um i've also

61
00:02:18,319 --> 00:02:20,400
participated in some of the largest ot

62
00:02:20,400 --> 00:02:22,959
incident response engagements in some of

63
00:02:22,959 --> 00:02:25,920
our lifetime today one specifically you

64
00:02:25,920 --> 00:02:28,480
can uh i'm i'm able to mention is that

65
00:02:28,480 --> 00:02:31,200
of the uh colonial pipeline incident so

66
00:02:31,200 --> 00:02:33,040
i was involved in responding to that one

67
00:02:33,040 --> 00:02:34,879
with the previous firm i was with and

68
00:02:34,879 --> 00:02:37,200
that was just a whole different thing

69
00:02:37,200 --> 00:02:39,200
connect with me off offline i have my

70
00:02:39,200 --> 00:02:40,879
socials and everything i can tell you

71
00:02:40,879 --> 00:02:43,280
more about that possibly of course with

72
00:02:43,280 --> 00:02:44,080
not

73
00:02:44,080 --> 00:02:47,200
going to too much detail for um customer

74
00:02:47,200 --> 00:02:48,720
confidentiality

75
00:02:48,720 --> 00:02:51,519
um so on the left right so you see me

76
00:02:51,519 --> 00:02:53,519
with an instrument i actually play susa

77
00:02:53,519 --> 00:02:56,800
phone so um i'm a low brass musician and

78
00:02:56,800 --> 00:02:58,640
i play with a band called the gabriel

79
00:02:58,640 --> 00:03:01,760
brass band and i typically tell people

80
00:03:01,760 --> 00:03:03,840
it's not my band i play for the band

81
00:03:03,840 --> 00:03:05,680
even though that's my name but the last

82
00:03:05,680 --> 00:03:08,879
name of the band leader is um is gabriel

83
00:03:08,879 --> 00:03:10,480
so that's why that's it's called the

84
00:03:10,480 --> 00:03:12,000
gabriel brassman but

85
00:03:12,000 --> 00:03:13,440
you know sometimes i

86
00:03:13,440 --> 00:03:15,680
i say it's mine too so you know first

87
00:03:15,680 --> 00:03:17,920
for certain crowds i'm also a youtuber

88
00:03:17,920 --> 00:03:19,440
right i have a youtube channel where i

89
00:03:19,440 --> 00:03:21,680
go over it's called struggle security

90
00:03:21,680 --> 00:03:24,000
more info about that at the end um but i

91
00:03:24,000 --> 00:03:26,560
go over very high level cyber security

92
00:03:26,560 --> 00:03:28,640
and information i have a tagline which

93
00:03:28,640 --> 00:03:30,879
says that normalizing struggling in

94
00:03:30,879 --> 00:03:32,400
cyber security because it's not always

95
00:03:32,400 --> 00:03:34,720
easy and struggling is okay in this

96
00:03:34,720 --> 00:03:38,080
field and i'm also on twitter under ics

97
00:03:38,080 --> 00:03:40,720
gabe um and also the last one right i'm

98
00:03:40,720 --> 00:03:42,239
gonna be a new dad coming up soon so

99
00:03:42,239 --> 00:03:44,080
i'll be having my first child coming up

100
00:03:44,080 --> 00:03:47,760
this no november so loading baby um baby

101
00:03:47,760 --> 00:03:50,480
um baking right now so i'm looking

102
00:03:50,480 --> 00:03:53,680
forward to it and um yeah so all of that

103
00:03:53,680 --> 00:03:55,840
stuff so the picture at the bottom left

104
00:03:55,840 --> 00:03:58,319
is a picture of myself at a nuclear

105
00:03:58,319 --> 00:03:59,680
plant that's the nuclear plant i used to

106
00:03:59,680 --> 00:04:02,239
work at and um

107
00:04:02,239 --> 00:04:03,439
yeah might as well talk about it now

108
00:04:03,439 --> 00:04:05,120
right i used to work at a nuclear plant

109
00:04:05,120 --> 00:04:08,480
as a nuclear inc engineer so i worked so

110
00:04:08,480 --> 00:04:09,760
like i said my bachelor's is in

111
00:04:09,760 --> 00:04:12,560
electrical engineering and nuclear power

112
00:04:12,560 --> 00:04:15,120
is a subset right that's that's part of

113
00:04:15,120 --> 00:04:19,199
the um generation of electricity so my

114
00:04:19,199 --> 00:04:21,519
degree in the nuclear kind of went hand

115
00:04:21,519 --> 00:04:24,240
in hand so that's me at the bottom left

116
00:04:24,240 --> 00:04:26,960
um i was at the nuclear plant and we had

117
00:04:26,960 --> 00:04:29,199
some visitors from japan where they had

118
00:04:29,199 --> 00:04:31,680
previously had the um

119
00:04:31,680 --> 00:04:33,600
fukushima um

120
00:04:33,600 --> 00:04:34,560
the

121
00:04:34,560 --> 00:04:37,040
the the fukushima incident at their

122
00:04:37,040 --> 00:04:38,960
nuclear plants where there was a

123
00:04:38,960 --> 00:04:42,240
hurricane there i'm sorry a tsunami

124
00:04:42,240 --> 00:04:44,720
combined with an earthquake which caused

125
00:04:44,720 --> 00:04:46,400
there to be issues at their nuclear

126
00:04:46,400 --> 00:04:49,120
plant so um they were coming to us

127
00:04:49,120 --> 00:04:51,280
because we had a very similar nuclear

128
00:04:51,280 --> 00:04:53,360
reactor and they were kind of making

129
00:04:53,360 --> 00:04:55,040
their u.s kind of tour so that was a

130
00:04:55,040 --> 00:04:57,680
very interesting experience for me while

131
00:04:57,680 --> 00:04:59,600
i was there so

132
00:04:59,600 --> 00:05:00,400
okay

133
00:05:00,400 --> 00:05:01,680
so let's get into the subject let me

134
00:05:01,680 --> 00:05:03,199
give you the premise here because this

135
00:05:03,199 --> 00:05:05,360
is this is very much so kind of

136
00:05:05,360 --> 00:05:07,680
intention for those who might be red

137
00:05:07,680 --> 00:05:09,759
teamers or incident responders but it

138
00:05:09,759 --> 00:05:12,400
can but this is a very common attack

139
00:05:12,400 --> 00:05:14,960
vector for what you call

140
00:05:14,960 --> 00:05:16,080
ot

141
00:05:16,080 --> 00:05:19,039
or ics so ot stands for operational

142
00:05:19,039 --> 00:05:21,520
technology and ics stands for industrial

143
00:05:21,520 --> 00:05:23,759
control systems these two a lot of times

144
00:05:23,759 --> 00:05:26,400
can be synonymous ics and ot you hear

145
00:05:26,400 --> 00:05:29,120
them back to back um so because i'm in

146
00:05:29,120 --> 00:05:31,039
this field this is kind of what i want

147
00:05:31,039 --> 00:05:33,280
to go over here because i don't have my

148
00:05:33,280 --> 00:05:36,080
animations but that is okay

149
00:05:36,080 --> 00:05:37,759
so one thing about these environments so

150
00:05:37,759 --> 00:05:39,199
what you're seeing on the screen here is

151
00:05:39,199 --> 00:05:41,680
a very common architecture for ot

152
00:05:41,680 --> 00:05:43,840
environments you see there at the top

153
00:05:43,840 --> 00:05:46,720
where it says um um level four which is

154
00:05:46,720 --> 00:05:49,199
typically like the business side of an

155
00:05:49,199 --> 00:05:50,880
organization so i used to work for

156
00:05:50,880 --> 00:05:52,960
electrical utility organization that

157
00:05:52,960 --> 00:05:55,600
owned a nuclear plant so that

158
00:05:55,600 --> 00:05:57,600
equivalency would be all the corporate

159
00:05:57,600 --> 00:05:59,919
offices those people in hr those people

160
00:05:59,919 --> 00:06:02,080
in sales the executives that will be

161
00:06:02,080 --> 00:06:04,400
there at the top where you see the web

162
00:06:04,400 --> 00:06:06,639
servers the mail servers you see

163
00:06:06,639 --> 00:06:07,919
engineer well

164
00:06:07,919 --> 00:06:10,319
regular workstations and that that type

165
00:06:10,319 --> 00:06:11,600
of environment and they have a direct

166
00:06:11,600 --> 00:06:13,840
connection into the internet one more

167
00:06:13,840 --> 00:06:16,960
level below you see the level 3.5 which

168
00:06:16,960 --> 00:06:19,440
is typically that of the dmz this is the

169
00:06:19,440 --> 00:06:21,759
area where like the demilitarized zone

170
00:06:21,759 --> 00:06:24,000
where you have all your antivirus you'll

171
00:06:24,000 --> 00:06:26,240
have all your other security things

172
00:06:26,240 --> 00:06:28,960
which pretty much acts as a buffer layer

173
00:06:28,960 --> 00:06:30,000
between

174
00:06:30,000 --> 00:06:32,560
it and ot so level 4 is typically

175
00:06:32,560 --> 00:06:35,680
considered i t and uh that level three

176
00:06:35,680 --> 00:06:38,960
is considered ot so that 3.5 is

177
00:06:38,960 --> 00:06:40,560
somewhere in between there where you

178
00:06:40,560 --> 00:06:42,080
have your intrusion detection systems

179
00:06:42,080 --> 00:06:44,880
antivirus as i mentioned before um and

180
00:06:44,880 --> 00:06:46,880
then you go down to your three which

181
00:06:46,880 --> 00:06:49,280
this is very much so ot environment

182
00:06:49,280 --> 00:06:51,280
right this might be

183
00:06:51,280 --> 00:06:52,080
a

184
00:06:52,080 --> 00:06:54,240
a particular station

185
00:06:54,240 --> 00:06:55,919
building where you have your engineering

186
00:06:55,919 --> 00:06:57,360
workstations you have your data

187
00:06:57,360 --> 00:07:00,479
historians you have these type of assets

188
00:07:00,479 --> 00:07:02,160
which are kind of monitoring those

189
00:07:02,160 --> 00:07:04,800
systems within your ot environment and

190
00:07:04,800 --> 00:07:07,199
one that i mentioned for ot was nuclear

191
00:07:07,199 --> 00:07:09,199
but you can have oil and gas you can

192
00:07:09,199 --> 00:07:11,280
have your building management systems

193
00:07:11,280 --> 00:07:14,240
you can have um electrical utilities

194
00:07:14,240 --> 00:07:16,560
grid type of functions you name it these

195
00:07:16,560 --> 00:07:18,720
all fall into the categories of ics and

196
00:07:18,720 --> 00:07:21,440
ot even water treatment or

197
00:07:21,440 --> 00:07:24,319
reservoir or wind power you name it

198
00:07:24,319 --> 00:07:25,680
mining is another one that i've been

199
00:07:25,680 --> 00:07:27,680
getting into lately so you know you name

200
00:07:27,680 --> 00:07:29,919
it these are all ot type of environments

201
00:07:29,919 --> 00:07:32,479
so that level three is that of systems

202
00:07:32,479 --> 00:07:34,400
within that so then you see your level

203
00:07:34,400 --> 00:07:36,400
two which is your supervision so you're

204
00:07:36,400 --> 00:07:38,400
so this is where you're supervising or

205
00:07:38,400 --> 00:07:40,319
monitoring what's happening at those

206
00:07:40,319 --> 00:07:42,319
lower layers right what's happening in

207
00:07:42,319 --> 00:07:45,360
your in your reactor core with what's

208
00:07:45,360 --> 00:07:48,319
happening in your your uh tunnels or

209
00:07:48,319 --> 00:07:51,440
your fuel fuel uh pumps looking at

210
00:07:51,440 --> 00:07:53,919
levels looking at pressure looking at

211
00:07:53,919 --> 00:07:55,440
temperature of these different

212
00:07:55,440 --> 00:07:57,360
components or even looking at a conveyor

213
00:07:57,360 --> 00:07:59,520
line for an automotive plant where you

214
00:07:59,520 --> 00:08:00,479
see the

215
00:08:00,479 --> 00:08:02,240
different automotive parts going down a

216
00:08:02,240 --> 00:08:04,400
line that's there in that level too

217
00:08:04,400 --> 00:08:06,000
you're monitoring that but then your

218
00:08:06,000 --> 00:08:07,680
level one and your level zero are

219
00:08:07,680 --> 00:08:09,280
specifically what's happening in those

220
00:08:09,280 --> 00:08:12,000
processes so you have your hmi that you

221
00:08:12,000 --> 00:08:14,160
see there your hearing machine interface

222
00:08:14,160 --> 00:08:16,240
you have your safety systems that are

223
00:08:16,240 --> 00:08:18,479
also in some of these environments but

224
00:08:18,479 --> 00:08:20,319
as you see all the way at the bottom you

225
00:08:20,319 --> 00:08:22,879
have your pumps you have your rtus which

226
00:08:22,879 --> 00:08:25,280
stands for remote terminal units you

227
00:08:25,280 --> 00:08:27,520
have your ieds for intelligent

228
00:08:27,520 --> 00:08:29,759
electrical devices you have your plcs

229
00:08:29,759 --> 00:08:31,039
which stand for programmable logic

230
00:08:31,039 --> 00:08:32,559
controllers i don't want you to get

231
00:08:32,559 --> 00:08:34,399
confused by all of the jargon i kind of

232
00:08:34,399 --> 00:08:36,479
wanted you to just understand what a

233
00:08:36,479 --> 00:08:39,200
typical ot architecture looks like and

234
00:08:39,200 --> 00:08:41,279
this is typically what it looks like but

235
00:08:41,279 --> 00:08:44,560
one common asset and that's the the the

236
00:08:44,560 --> 00:08:45,760
theme now we're getting into the theme

237
00:08:45,760 --> 00:08:48,560
of the conversation is that printers you

238
00:08:48,560 --> 00:08:49,839
see that at the top i don't have my

239
00:08:49,839 --> 00:08:52,080
animation but i wanted to show as each

240
00:08:52,080 --> 00:08:54,320
one of the little lines goes down to

241
00:08:54,320 --> 00:08:56,000
every single one of those layers

242
00:08:56,000 --> 00:09:00,480
printers are a very common um asset that

243
00:09:00,480 --> 00:09:02,399
is aligned with every single one of

244
00:09:02,399 --> 00:09:04,399
these layers for a typical ot

245
00:09:04,399 --> 00:09:06,320
architecture and also you see to the

246
00:09:06,320 --> 00:09:07,920
right these are some common attack

247
00:09:07,920 --> 00:09:09,680
vectors where it's in secure remote

248
00:09:09,680 --> 00:09:12,320
access infected usb drives insecure

249
00:09:12,320 --> 00:09:15,440
authentication clear text credentials um

250
00:09:15,440 --> 00:09:18,399
denial service or or research exhaustion

251
00:09:18,399 --> 00:09:20,240
you you name it a lot of these attack

252
00:09:20,240 --> 00:09:22,480
vectors apply to ot architectures and

253
00:09:22,480 --> 00:09:24,160
the thing about it is that printers are

254
00:09:24,160 --> 00:09:26,800
in every single one of these layers and

255
00:09:26,800 --> 00:09:28,399
i've seen this very commonly so i just

256
00:09:28,399 --> 00:09:30,240
want to kind of lay that foundation out

257
00:09:30,240 --> 00:09:32,480
there as we move forward is that that's

258
00:09:32,480 --> 00:09:35,279
why i think that this is a un

259
00:09:35,279 --> 00:09:37,120
or or under

260
00:09:37,120 --> 00:09:40,399
valued assets in ot architectures or ot

261
00:09:40,399 --> 00:09:42,560
environments um because printers are

262
00:09:42,560 --> 00:09:44,800
everywhere and there are common attack

263
00:09:44,800 --> 00:09:46,560
vectors which apply to every single one

264
00:09:46,560 --> 00:09:48,399
of these layers so i think that this is

265
00:09:48,399 --> 00:09:50,000
an asset that needs greater

266
00:09:50,000 --> 00:09:52,800
consideration and i want to go into what

267
00:09:52,800 --> 00:09:55,519
i've done during internal pin tests um

268
00:09:55,519 --> 00:09:58,320
in order to kind of um take take

269
00:09:58,320 --> 00:10:00,959
advantage of this this this asset that's

270
00:10:00,959 --> 00:10:02,000
everywhere

271
00:10:02,000 --> 00:10:04,959
so let's move forward here okay so i

272
00:10:04,959 --> 00:10:06,480
want to give you a couple of examples of

273
00:10:06,480 --> 00:10:09,839
where i've seen seen this so bms and bas

274
00:10:09,839 --> 00:10:11,600
so bms stands for building management

275
00:10:11,600 --> 00:10:13,760
systems slash building automation

276
00:10:13,760 --> 00:10:15,760
systems so this is anything as it

277
00:10:15,760 --> 00:10:19,200
concerns um heating and cooling so hvac

278
00:10:19,200 --> 00:10:22,160
systems you have your as you see in this

279
00:10:22,160 --> 00:10:23,760
example all the way to the left is the

280
00:10:23,760 --> 00:10:26,640
example um your your garage door systems

281
00:10:26,640 --> 00:10:28,800
your elevators escalators you have your

282
00:10:28,800 --> 00:10:30,800
fire alarm and fire suppression type

283
00:10:30,800 --> 00:10:33,600
systems but there's a little arrow here

284
00:10:33,600 --> 00:10:35,440
that you all can probably see is that

285
00:10:35,440 --> 00:10:37,440
all in the midst of this right here by

286
00:10:37,440 --> 00:10:39,440
the fire alarm system and it's

287
00:10:39,440 --> 00:10:42,240
actually it was in other places um you

288
00:10:42,240 --> 00:10:44,640
see a printer a printer is right here

289
00:10:44,640 --> 00:10:45,920
within the building management system

290
00:10:45,920 --> 00:10:47,680
building automation system and this is

291
00:10:47,680 --> 00:10:50,240
an actual architecture from a customer

292
00:10:50,240 --> 00:10:52,480
environment that i did a walk down of

293
00:10:52,480 --> 00:10:55,360
very large organization and this is and

294
00:10:55,360 --> 00:10:58,160
printers were there within this ot type

295
00:10:58,160 --> 00:11:00,560
of system i've blurred out all of the

296
00:11:00,560 --> 00:11:02,000
information associated with this

297
00:11:02,000 --> 00:11:03,680
customer so you won't be able to know

298
00:11:03,680 --> 00:11:05,839
who they are but just

299
00:11:05,839 --> 00:11:07,279
let you know that within building

300
00:11:07,279 --> 00:11:08,240
management systems and building

301
00:11:08,240 --> 00:11:10,880
automation systems printers exist there

302
00:11:10,880 --> 00:11:12,800
now there on the right you have a

303
00:11:12,800 --> 00:11:15,360
typical architecture of a nuclear plant

304
00:11:15,360 --> 00:11:18,000
environment so you see here that you

305
00:11:18,000 --> 00:11:20,160
have your internet and that's kind of

306
00:11:20,160 --> 00:11:21,600
that's that's that's kind of common to

307
00:11:21,600 --> 00:11:22,800
what i showed for the general

308
00:11:22,800 --> 00:11:25,040
architecture every internet connecting

309
00:11:25,040 --> 00:11:27,360
to your business systems right those it

310
00:11:27,360 --> 00:11:29,440
with hr and sales that's that

311
00:11:29,440 --> 00:11:31,279
environment separated by firewalls and

312
00:11:31,279 --> 00:11:33,200
typically in in nuclear plant

313
00:11:33,200 --> 00:11:34,399
environments you have something called a

314
00:11:34,399 --> 00:11:36,880
data diode which only allows data to go

315
00:11:36,880 --> 00:11:39,279
in one direction which is out of the

316
00:11:39,279 --> 00:11:41,279
nuclear plant environment but i've seen

317
00:11:41,279 --> 00:11:43,200
very commonly where you see the control

318
00:11:43,200 --> 00:11:45,600
room i've seen commonly that there are

319
00:11:45,600 --> 00:11:47,440
printers within the control room i've

320
00:11:47,440 --> 00:11:49,279
even been in control rooms nuclear plant

321
00:11:49,279 --> 00:11:51,600
control rooms where next to the reactor

322
00:11:51,600 --> 00:11:53,600
engineering stations there's a printer

323
00:11:53,600 --> 00:11:55,519
sitting right there right control

324
00:11:55,519 --> 00:11:57,839
engineers process engineers reactor

325
00:11:57,839 --> 00:11:59,600
engineers they want to be able to print

326
00:11:59,600 --> 00:12:01,680
out information as it concerns what's

327
00:12:01,680 --> 00:12:04,079
happening within the ot environment and

328
00:12:04,079 --> 00:12:06,160
typically printers are very common there

329
00:12:06,160 --> 00:12:08,079
so even within the control room kind of

330
00:12:08,079 --> 00:12:11,360
the heart in in in breath of a nuclear

331
00:12:11,360 --> 00:12:13,920
plant you see printers right there in

332
00:12:13,920 --> 00:12:15,440
the midst

333
00:12:15,440 --> 00:12:17,440
so those are two examples there this is

334
00:12:17,440 --> 00:12:19,279
another example so this is another walk

335
00:12:19,279 --> 00:12:21,519
down of a system again actual

336
00:12:21,519 --> 00:12:23,600
environments actual architectures these

337
00:12:23,600 --> 00:12:25,360
are pictures that i would that i took

338
00:12:25,360 --> 00:12:26,880
while i was there so this is an oil and

339
00:12:26,880 --> 00:12:29,760
gas compressor station control room um

340
00:12:29,760 --> 00:12:30,720
and

341
00:12:30,720 --> 00:12:33,519
boom right right here you see that you

342
00:12:33,519 --> 00:12:36,560
have some this is small for me so sorry

343
00:12:36,560 --> 00:12:38,560
for zooming in with with

344
00:12:38,560 --> 00:12:41,519
me looking but you have your wind

345
00:12:41,519 --> 00:12:43,760
connections out out here that's going

346
00:12:43,760 --> 00:12:45,760
specifically to your walk area network

347
00:12:45,760 --> 00:12:47,040
right that's that's more towards the

348
00:12:47,040 --> 00:12:49,360
internet connecting to your telecom but

349
00:12:49,360 --> 00:12:51,760
then going into the plan environment you

350
00:12:51,760 --> 00:12:54,320
have a printer here next to all these

351
00:12:54,320 --> 00:12:56,240
workstations right so you see that you

352
00:12:56,240 --> 00:12:58,480
have your primary workstation secondary

353
00:12:58,480 --> 00:13:00,880
works workstation you have your desk

354
00:13:00,880 --> 00:13:03,120
control right that's where your ethernet

355
00:13:03,120 --> 00:13:05,600
jacks and everything are your telephone

356
00:13:05,600 --> 00:13:08,399
systems and your uh alarm systems but

357
00:13:08,399 --> 00:13:10,560
boom right here you have a printer and

358
00:13:10,560 --> 00:13:12,880
this is an actual on the right we have

359
00:13:12,880 --> 00:13:14,320
an actual

360
00:13:14,320 --> 00:13:16,079
show of where that printer is it's

361
00:13:16,079 --> 00:13:19,120
sitting right here on top of a server

362
00:13:19,120 --> 00:13:21,120
next to all of these workstations and

363
00:13:21,120 --> 00:13:23,200
laptops that you see here

364
00:13:23,200 --> 00:13:25,279
common printers are very common i just

365
00:13:25,279 --> 00:13:27,040
want to drill that down printers are

366
00:13:27,040 --> 00:13:30,720
very common in ot environments

367
00:13:30,720 --> 00:13:32,800
the next one is that same customer with

368
00:13:32,800 --> 00:13:34,800
an oil so this is the main control

369
00:13:34,800 --> 00:13:37,680
control room this is like the central

370
00:13:37,680 --> 00:13:40,399
central control unit or central control

371
00:13:40,399 --> 00:13:43,360
area for the whole oil and gas plant or

372
00:13:43,360 --> 00:13:45,440
the whole oil and gas station

373
00:13:45,440 --> 00:13:47,279
so this connects several different

374
00:13:47,279 --> 00:13:49,360
stations together and the control is

375
00:13:49,360 --> 00:13:51,760
right here just showing an emphasis on

376
00:13:51,760 --> 00:13:54,399
how important this environment is um so

377
00:13:54,399 --> 00:13:56,320
you see you you have your

378
00:13:56,320 --> 00:13:58,160
laptops these are human machine

379
00:13:58,160 --> 00:13:59,600
interfaces that are showing what's

380
00:13:59,600 --> 00:14:01,680
happening in the ot environment these

381
00:14:01,680 --> 00:14:03,680
are probably some some some levels and

382
00:14:03,680 --> 00:14:05,920
some temperatures and some pressures

383
00:14:05,920 --> 00:14:07,199
what's happening

384
00:14:07,199 --> 00:14:09,920
within the um on pipes but then boom

385
00:14:09,920 --> 00:14:11,839
right here you have a printer sitting

386
00:14:11,839 --> 00:14:13,839
right here next to all this important

387
00:14:13,839 --> 00:14:16,720
stuff all this important stuff again you

388
00:14:16,720 --> 00:14:19,440
i think that many of us in ot security

389
00:14:19,440 --> 00:14:21,600
or even individuals not in this this

390
00:14:21,600 --> 00:14:23,680
environment need to understand the

391
00:14:23,680 --> 00:14:25,839
importance of printers in these type of

392
00:14:25,839 --> 00:14:27,199
environments

393
00:14:27,199 --> 00:14:29,040
so now i'm gonna get into the attack and

394
00:14:29,040 --> 00:14:31,279
this and again just kind of laying out

395
00:14:31,279 --> 00:14:32,800
the foundation a little bit more with

396
00:14:32,800 --> 00:14:34,800
this is that with the attack this is

397
00:14:34,800 --> 00:14:36,880
something that i've used on multiple

398
00:14:36,880 --> 00:14:39,839
occasions i've used this multiple times

399
00:14:39,839 --> 00:14:42,480
in order to gain an initial foothold

400
00:14:42,480 --> 00:14:43,519
into

401
00:14:43,519 --> 00:14:46,240
environments into ot environments using

402
00:14:46,240 --> 00:14:48,560
this particular attack and that's really

403
00:14:48,560 --> 00:14:50,240
what you do for many pin tests because

404
00:14:50,240 --> 00:14:52,079
typically pintest what you are looking

405
00:14:52,079 --> 00:14:54,800
to do is that you're establishing uh uh

406
00:14:54,800 --> 00:14:56,800
so what we typically did was that we did

407
00:14:56,800 --> 00:15:00,320
an assumed breach type of perspective um

408
00:15:00,320 --> 00:15:02,480
so that's where we're going here setting

409
00:15:02,480 --> 00:15:04,240
the stage for the attack so this is

410
00:15:04,240 --> 00:15:06,160
typically an internal princess or red

411
00:15:06,160 --> 00:15:08,800
team which means that the customer and

412
00:15:08,800 --> 00:15:11,199
the firm that i work work for we had an

413
00:15:11,199 --> 00:15:12,720
understanding that there's a soon breach

414
00:15:12,720 --> 00:15:14,079
perspective where we're going to assume

415
00:15:14,079 --> 00:15:16,000
that the bad guy is already in the

416
00:15:16,000 --> 00:15:18,720
environment right phishing attacks like

417
00:15:18,720 --> 00:15:20,639
i was showing you with the common attack

418
00:15:20,639 --> 00:15:23,680
vectors phishing attacks um um internal

419
00:15:23,680 --> 00:15:27,279
threats with plugging in infected usb

420
00:15:27,279 --> 00:15:29,199
drives remote connections not really

421
00:15:29,199 --> 00:15:30,800
being monitored

422
00:15:30,800 --> 00:15:32,720
all these different attack vectors

423
00:15:32,720 --> 00:15:34,800
really allow the bad guys to get in at

424
00:15:34,800 --> 00:15:36,480
times very easily

425
00:15:36,480 --> 00:15:37,360
so

426
00:15:37,360 --> 00:15:39,040
many organizations want to understand

427
00:15:39,040 --> 00:15:40,800
with these internal princess for ot

428
00:15:40,800 --> 00:15:42,959
specifically to try to understand hey

429
00:15:42,959 --> 00:15:45,600
once the bad guys get in how far can

430
00:15:45,600 --> 00:15:48,079
they go what can they do what systems

431
00:15:48,079 --> 00:15:49,600
can they move to and what

432
00:15:49,600 --> 00:15:51,279
vulnerabilities pretty much exists

433
00:15:51,279 --> 00:15:52,800
within ot

434
00:15:52,800 --> 00:15:55,279
and the overall ot environments i've

435
00:15:55,279 --> 00:15:57,680
seen many times where we'll start off as

436
00:15:57,680 --> 00:15:58,880
i showed you in the previous

437
00:15:58,880 --> 00:16:01,279
architecture we'll start off in the

438
00:16:01,279 --> 00:16:03,759
business side so they'll throw us

439
00:16:03,759 --> 00:16:06,560
on a vm they'll throw us on some type of

440
00:16:06,560 --> 00:16:08,800
laptop or some type of system within

441
00:16:08,800 --> 00:16:10,800
their business systems or their business

442
00:16:10,800 --> 00:16:13,120
architecture and say hey can you go from

443
00:16:13,120 --> 00:16:15,680
the business environment to the ot

444
00:16:15,680 --> 00:16:18,880
environment can you bypass firewalls can

445
00:16:18,880 --> 00:16:20,320
you um

446
00:16:20,320 --> 00:16:22,399
capture credentials of individuals

447
00:16:22,399 --> 00:16:25,680
within it and that will gain you the

448
00:16:25,680 --> 00:16:29,120
ability to transition over into ot so

449
00:16:29,120 --> 00:16:31,360
many times what we'll start off by doing

450
00:16:31,360 --> 00:16:34,000
is a very typical i.t pen test internal

451
00:16:34,000 --> 00:16:35,600
pen test where we're looking at getting

452
00:16:35,600 --> 00:16:38,000
domain admin credentials for that active

453
00:16:38,000 --> 00:16:39,759
directory environment in order for us to

454
00:16:39,759 --> 00:16:41,680
be able to manipulate the environment so

455
00:16:41,680 --> 00:16:44,079
we can jump into ot and

456
00:16:44,079 --> 00:16:46,639
 and find whatever we can find as it

457
00:16:46,639 --> 00:16:49,279
concerns vulnerabilities so that's one

458
00:16:49,279 --> 00:16:50,639
of the things that's kind of setting the

459
00:16:50,639 --> 00:16:52,720
stage here for this type of attack

460
00:16:52,720 --> 00:16:54,720
another one is that um

461
00:16:54,720 --> 00:16:57,600
one of the prerequisites is that um a

462
00:16:57,600 --> 00:16:59,440
microsoft active directory environment

463
00:16:59,440 --> 00:17:02,399
is required so many times and this is

464
00:17:02,399 --> 00:17:04,240
very very common like i said here many

465
00:17:04,240 --> 00:17:05,919
customers desire to test the ability to

466
00:17:05,919 --> 00:17:08,000
move from i t to ot start there in the

467
00:17:08,000 --> 00:17:09,919
um or start there from the ot

468
00:17:09,919 --> 00:17:11,679
environment but active directory is

469
00:17:11,679 --> 00:17:13,760
something that's very common so in ot

470
00:17:13,760 --> 00:17:15,119
architecture it's like i was mentioning

471
00:17:15,119 --> 00:17:16,959
before there's all these servers there's

472
00:17:16,959 --> 00:17:19,199
all these workstations they're typically

473
00:17:19,199 --> 00:17:21,520
windows systems so microsoft active

474
00:17:21,520 --> 00:17:23,599
directory is very common with an

475
00:17:23,599 --> 00:17:26,079
ot but that's a requirement here there

476
00:17:26,079 --> 00:17:28,240
are some ot environments where there's

477
00:17:28,240 --> 00:17:30,880
none there's times where you can see as

478
00:17:30,880 --> 00:17:32,480
as little

479
00:17:32,480 --> 00:17:36,400
um infrastructure right networking or or

480
00:17:36,400 --> 00:17:37,919
just overall infrastructure where i've

481
00:17:37,919 --> 00:17:40,799
seen unmanaged switches that connect

482
00:17:40,799 --> 00:17:43,600
directly to workstations and servers and

483
00:17:43,600 --> 00:17:45,760
that's kind of isolated on its own

484
00:17:45,760 --> 00:17:47,840
environment has its own subnet and

485
00:17:47,840 --> 00:17:50,080
everything so it can be very bare there

486
00:17:50,080 --> 00:17:51,919
so this attack wouldn't apply to that

487
00:17:51,919 --> 00:17:53,520
type of environment

488
00:17:53,520 --> 00:17:55,360
and like i mentioned right not all ot

489
00:17:55,360 --> 00:17:58,000
environments implement microsoft ad but

490
00:17:58,000 --> 00:17:59,679
it's very common for managing windows

491
00:17:59,679 --> 00:18:01,679
systems so when you have network

492
00:18:01,679 --> 00:18:03,520
connected printers

493
00:18:03,520 --> 00:18:05,679
many times it is in the active directory

494
00:18:05,679 --> 00:18:07,679
environment when you have servers

495
00:18:07,679 --> 00:18:10,400
authentication servers or data

496
00:18:10,400 --> 00:18:12,720
historians that's another asset that is

497
00:18:12,720 --> 00:18:15,440
typically a windows server with an ot

498
00:18:15,440 --> 00:18:17,039
you will have an active directory

499
00:18:17,039 --> 00:18:19,280
environment and the third prerequisite

500
00:18:19,280 --> 00:18:20,799
of setting the stage for the attack is

501
00:18:20,799 --> 00:18:22,320
that these need to be network connected

502
00:18:22,320 --> 00:18:23,679
printers we're talking about printers

503
00:18:23,679 --> 00:18:26,240
with ethernet connections to lans and

504
00:18:26,240 --> 00:18:27,919
wireless printers that authenticate to

505
00:18:27,919 --> 00:18:30,880
the local otd domains so those are some

506
00:18:30,880 --> 00:18:32,640
of the prerequisites for setting the

507
00:18:32,640 --> 00:18:34,240
stage for the attacks these things need

508
00:18:34,240 --> 00:18:36,160
to be in place in order for this attack

509
00:18:36,160 --> 00:18:38,240
to be successful

510
00:18:38,240 --> 00:18:40,240
so let's continue here and these are the

511
00:18:40,240 --> 00:18:42,160
steps so i'm going to step you through

512
00:18:42,160 --> 00:18:44,320
each one of these and each one of these

513
00:18:44,320 --> 00:18:47,120
things that you can do in order to

514
00:18:47,120 --> 00:18:49,200
execute this type of attack and i'm also

515
00:18:49,200 --> 00:18:50,799
going to follow so so i'm not just going

516
00:18:50,799 --> 00:18:52,480
to throw it out there to say hey this is

517
00:18:52,480 --> 00:18:54,480
how you can do this bad thing i'm also

518
00:18:54,480 --> 00:18:56,160
going to finish it out by giving some

519
00:18:56,160 --> 00:18:58,559
heartening and some recommendations on

520
00:18:58,559 --> 00:19:00,160
what you can give to your customers or

521
00:19:00,160 --> 00:19:02,480
what organizations can even do today in

522
00:19:02,480 --> 00:19:04,320
order to protect against this particular

523
00:19:04,320 --> 00:19:06,799
type of attack where it's been very easy

524
00:19:06,799 --> 00:19:09,600
to do so the first one like many times

525
00:19:09,600 --> 00:19:12,320
people do or many pin testers do with an

526
00:19:12,320 --> 00:19:14,080
internal pin test is that you start to

527
00:19:14,080 --> 00:19:16,400
scan and you search so you're doing your

528
00:19:16,400 --> 00:19:18,880
reconnaissance but you're not only doing

529
00:19:18,880 --> 00:19:20,880
just basic reconnaissance for vulnerable

530
00:19:20,880 --> 00:19:23,280
systems you're specifically scanning and

531
00:19:23,280 --> 00:19:25,440
searching for printers looking for

532
00:19:25,440 --> 00:19:28,000
printer devices and think about it right

533
00:19:28,000 --> 00:19:31,559
i mean for those who are are are i.t

534
00:19:31,559 --> 00:19:34,640
administrators or or or domain

535
00:19:34,640 --> 00:19:37,520
administrators are you really protecting

536
00:19:37,520 --> 00:19:39,840
your printers are you really looking at

537
00:19:39,840 --> 00:19:41,280
like okay let's see who's trying to

538
00:19:41,280 --> 00:19:42,640
compromise my printer no you're looking

539
00:19:42,640 --> 00:19:44,480
at workstations you're looking at

540
00:19:44,480 --> 00:19:46,720
laptops you're looking at servers those

541
00:19:46,720 --> 00:19:49,919
are your high value assets there so this

542
00:19:49,919 --> 00:19:51,360
looking and searching for printers

543
00:19:51,360 --> 00:19:53,039
scanning for those type of devices

544
00:19:53,039 --> 00:19:55,520
they're getting very specific um to the

545
00:19:55,520 --> 00:19:57,600
type of searching that that you're doing

546
00:19:57,600 --> 00:20:00,160
is kind of many of this activity flies

547
00:20:00,160 --> 00:20:02,480
under under the radar i've spoken to

548
00:20:02,480 --> 00:20:05,039
customers which were kind of doing at

549
00:20:05,039 --> 00:20:07,120
times a purple team type of

550
00:20:07,120 --> 00:20:09,360
scenario when i say purple team i mean

551
00:20:09,360 --> 00:20:12,000
that i'm doing the internal pen test and

552
00:20:12,000 --> 00:20:14,320
that defending organization or those who

553
00:20:14,320 --> 00:20:16,559
are part of the sim or the sock the

554
00:20:16,559 --> 00:20:18,720
security operations center organization

555
00:20:18,720 --> 00:20:21,600
are looking for evidences of my activity

556
00:20:21,600 --> 00:20:23,840
and when i've done this they were not

557
00:20:23,840 --> 00:20:25,840
able to detect the activity that i was

558
00:20:25,840 --> 00:20:27,840
doing they were not able to detect what

559
00:20:27,840 --> 00:20:29,919
i was doing and this is kind of somewhat

560
00:20:29,919 --> 00:20:33,360
of what you call lao or lol right living

561
00:20:33,360 --> 00:20:34,400
off the land

562
00:20:34,400 --> 00:20:38,559
you're utilizing the um um well

563
00:20:38,559 --> 00:20:40,000
probably living off the land is a little

564
00:20:40,000 --> 00:20:42,320
later so i'll i'll i'll get into that a

565
00:20:42,320 --> 00:20:43,919
little later but a lot of i would say

566
00:20:43,919 --> 00:20:46,480
this for step one many of this

567
00:20:46,480 --> 00:20:48,000
type of activity for scanning and

568
00:20:48,000 --> 00:20:50,080
searching for printers is a bit

569
00:20:50,080 --> 00:20:52,960
imperceptible to many defenders so like

570
00:20:52,960 --> 00:20:54,480
i mentioned you can use some very common

571
00:20:54,480 --> 00:20:56,480
tools you can use nmap you can use

572
00:20:56,480 --> 00:20:58,640
metasploit and another one called eye

573
00:20:58,640 --> 00:21:00,799
eyewitness which i've used very very

574
00:21:00,799 --> 00:21:02,240
often in order to search for these

575
00:21:02,240 --> 00:21:06,240
devices so eyewitnesses here this is a

576
00:21:06,240 --> 00:21:08,320
this is a github for eyewitness and

577
00:21:08,320 --> 00:21:10,240
pretty much what it does is it searches

578
00:21:10,240 --> 00:21:11,440
for any

579
00:21:11,440 --> 00:21:15,760
internet or like port tcp port 80 8080

580
00:21:15,760 --> 00:21:18,480
443 it searches for those within the

581
00:21:18,480 --> 00:21:20,159
internal network and it takes a

582
00:21:20,159 --> 00:21:22,640
screenshot of what it finds once it once

583
00:21:22,640 --> 00:21:25,919
that web page or that that that web type

584
00:21:25,919 --> 00:21:28,480
of app application pops up so it can be

585
00:21:28,480 --> 00:21:30,880
used to find printers or any other type

586
00:21:30,880 --> 00:21:32,960
of devices in the environment and it's

587
00:21:32,960 --> 00:21:35,200
very quick if you've ever used eye

588
00:21:35,200 --> 00:21:36,720
eyewitness before so that might be

589
00:21:36,720 --> 00:21:37,840
something that you might want to

590
00:21:37,840 --> 00:21:38,960
consider

591
00:21:38,960 --> 00:21:40,559
another one like i mentioned before is

592
00:21:40,559 --> 00:21:42,480
in-app but making that scan very

593
00:21:42,480 --> 00:21:44,080
specific to the type of ports that

594
00:21:44,080 --> 00:21:45,520
you're looking for

595
00:21:45,520 --> 00:21:48,559
because nmap has the um

596
00:21:48,559 --> 00:21:50,880
can just send off all types of packets

597
00:21:50,880 --> 00:21:54,559
that are very detectable by defenders so

598
00:21:54,559 --> 00:21:56,320
as you see i have an map and i have a

599
00:21:56,320 --> 00:21:58,960
flag for p which means which that report

600
00:21:58,960 --> 00:22:02,799
the 9100 515 6381 and i'm just searching

601
00:22:02,799 --> 00:22:04,720
to see if these are open and i have

602
00:22:04,720 --> 00:22:06,480
again blurring out for any customer

603
00:22:06,480 --> 00:22:09,120
information and as you see here um there

604
00:22:09,120 --> 00:22:11,039
were some printers that popped up here

605
00:22:11,039 --> 00:22:14,159
so you see that of the 55 15

606
00:22:14,159 --> 00:22:15,919
that popped up and that's associated

607
00:22:15,919 --> 00:22:19,120
with with printer services 9100 for jet

608
00:22:19,120 --> 00:22:20,960
direct right so we see that these are

609
00:22:20,960 --> 00:22:23,440
open so these and the ip addresses are

610
00:22:23,440 --> 00:22:25,039
here for all of these devices so what

611
00:22:25,039 --> 00:22:27,120
i'm doing here is first i'm scanning for

612
00:22:27,120 --> 00:22:28,799
these devices and then i'm taking them

613
00:22:28,799 --> 00:22:30,320
and putting them into some type of text

614
00:22:30,320 --> 00:22:32,640
file so i can launch further attack or

615
00:22:32,640 --> 00:22:34,640
further enumeration of these type of

616
00:22:34,640 --> 00:22:36,880
systems um so that's what i'm doing

617
00:22:36,880 --> 00:22:38,400
there within that

618
00:22:38,400 --> 00:22:39,520
okay

619
00:22:39,520 --> 00:22:41,200
and the next thing that you do so we're

620
00:22:41,200 --> 00:22:42,720
moving on for number one where you're

621
00:22:42,720 --> 00:22:44,640
scanning and searching for these devices

622
00:22:44,640 --> 00:22:46,159
once once you find them these are some

623
00:22:46,159 --> 00:22:48,880
common ports where i mentioned 80 443

624
00:22:48,880 --> 00:22:53,600
9100 515 and 631 oh and the reason why

625
00:22:53,600 --> 00:22:57,120
these are on port 80 8080 443 is because

626
00:22:57,120 --> 00:22:58,960
many times these printers have some type

627
00:22:58,960 --> 00:23:01,200
of web interface right some type of web

628
00:23:01,200 --> 00:23:02,880
application running on them so that you

629
00:23:02,880 --> 00:23:04,320
can manage them so you can get into

630
00:23:04,320 --> 00:23:05,679
these devices that you can change

631
00:23:05,679 --> 00:23:07,440
settings you can manage them and that's

632
00:23:07,440 --> 00:23:08,640
kind of more of that living off the

633
00:23:08,640 --> 00:23:10,960
landing i was speaking of so number two

634
00:23:10,960 --> 00:23:12,960
that's when you're getting into that of

635
00:23:12,960 --> 00:23:14,960
checking for printer default uh

636
00:23:14,960 --> 00:23:17,520
credentials so organizations often leave

637
00:23:17,520 --> 00:23:19,840
their printers with default credentials

638
00:23:19,840 --> 00:23:21,600
not only for just to manage them or

639
00:23:21,600 --> 00:23:23,360
getting access to them or even

640
00:23:23,360 --> 00:23:25,679
administrative access so there's default

641
00:23:25,679 --> 00:23:28,640
credentials for so many um printers that

642
00:23:28,640 --> 00:23:31,679
are just sprawled over the internet um

643
00:23:31,679 --> 00:23:33,760
and there are many like repositories

644
00:23:33,760 --> 00:23:35,200
that'll just give you hey what's the

645
00:23:35,200 --> 00:23:39,360
default um credentials for a hp printer

646
00:23:39,360 --> 00:23:41,440
of this type of version or a xerox

647
00:23:41,440 --> 00:23:43,440
printer or a zebra printer any of these

648
00:23:43,440 --> 00:23:46,080
type of printers you can see that you

649
00:23:46,080 --> 00:23:48,559
can find the default credentials online

650
00:23:48,559 --> 00:23:50,320
so let me show you a little bit of that

651
00:23:50,320 --> 00:23:52,640
of what i found and again this isn't

652
00:23:52,640 --> 00:23:53,840
just something that i'm making up this

653
00:23:53,840 --> 00:23:55,760
is this isn't just something i'm saying

654
00:23:55,760 --> 00:23:57,279
this is something that i've used and

655
00:23:57,279 --> 00:23:58,799
executed and these are some of the

656
00:23:58,799 --> 00:24:02,320
examples here this is a xerox printer of

657
00:24:02,320 --> 00:24:04,640
atla link something something something

658
00:24:04,640 --> 00:24:06,640
i don't know the exact exact versions i

659
00:24:06,640 --> 00:24:09,760
can't see that that small but as you see

660
00:24:09,760 --> 00:24:12,000
here i i just i just point out here that

661
00:24:12,000 --> 00:24:14,799
this gives me admin access with these

662
00:24:14,799 --> 00:24:17,120
default credentials administrative

663
00:24:17,120 --> 00:24:19,760
access directly to the printer because

664
00:24:19,760 --> 00:24:21,360
nobody typically changes printer

665
00:24:21,360 --> 00:24:25,360
credentials another one for for h for hp

666
00:24:25,360 --> 00:24:28,880
page wide color flow whatever i don't

667
00:24:28,880 --> 00:24:29,679
know

668
00:24:29,679 --> 00:24:32,880
another arrow here administrator access

669
00:24:32,880 --> 00:24:35,279
default credentials default credentials

670
00:24:35,279 --> 00:24:38,080
for hp printer and this is another one i

671
00:24:38,080 --> 00:24:39,600
never even heard of this version of the

672
00:24:39,600 --> 00:24:41,600
printer before but i found the default

673
00:24:41,600 --> 00:24:43,760
credentials online from just simple

674
00:24:43,760 --> 00:24:45,840
google's the simple beans and simple

675
00:24:45,840 --> 00:24:48,480
whatever imagerunner advance never heard

676
00:24:48,480 --> 00:24:49,919
of this type of printer ever before in

677
00:24:49,919 --> 00:24:53,520
my life administrator access directly to

678
00:24:53,520 --> 00:24:54,960
that printer

679
00:24:54,960 --> 00:24:56,240
so

680
00:24:56,240 --> 00:24:58,640
that is the step two here you find your

681
00:24:58,640 --> 00:25:00,720
default credentials for administrative

682
00:25:00,720 --> 00:25:02,400
access to the printer and now you're

683
00:25:02,400 --> 00:25:05,200
getting into the quote-unquote fun part

684
00:25:05,200 --> 00:25:07,840
right um changing the settings so this

685
00:25:07,840 --> 00:25:09,520
is utilizing the

686
00:25:09,520 --> 00:25:11,919
the um services that are running on the

687
00:25:11,919 --> 00:25:14,559
printers in order to change them so that

688
00:25:14,559 --> 00:25:17,039
you can do something um to try to

689
00:25:17,039 --> 00:25:19,679
discover that those vulnerabilities so

690
00:25:19,679 --> 00:25:21,279
you change where the printers

691
00:25:21,279 --> 00:25:23,360
authenticate by modifying the ldap

692
00:25:23,360 --> 00:25:27,039
settings so ldap it is a a service that

693
00:25:27,039 --> 00:25:29,520
many printers and devices use in order

694
00:25:29,520 --> 00:25:31,840
to authenticate to different systems in

695
00:25:31,840 --> 00:25:34,960
the environment right so ldap is used

696
00:25:34,960 --> 00:25:37,120
for many printers as like a very small

697
00:25:37,120 --> 00:25:41,039
like address book type of service um and

698
00:25:41,039 --> 00:25:43,440
you can change the credentials of the

699
00:25:43,440 --> 00:25:44,799
printer

700
00:25:44,799 --> 00:25:47,200
not by something very difficult but by

701
00:25:47,200 --> 00:25:49,120
let me show you

702
00:25:49,120 --> 00:25:50,880
utilize i don't know why i put that

703
00:25:50,880 --> 00:25:52,159
there i just threw that

704
00:25:52,159 --> 00:25:55,440
up there but by using the settings or

705
00:25:55,440 --> 00:25:58,559
using the internet so this is a web page

706
00:25:58,559 --> 00:26:00,880
that i popped up right so you can change

707
00:26:00,880 --> 00:26:03,600
the ldap configuration settings right

708
00:26:03,600 --> 00:26:04,880
here

709
00:26:04,880 --> 00:26:05,760
on

710
00:26:05,760 --> 00:26:08,640
the web page that xerox

711
00:26:08,640 --> 00:26:11,919
provides to you right so you can click

712
00:26:11,919 --> 00:26:13,520
you can just follow these steps in order

713
00:26:13,520 --> 00:26:16,159
to change the ldap settings and let me

714
00:26:16,159 --> 00:26:17,279
tell you a little bit more of what

715
00:26:17,279 --> 00:26:18,880
you're doing here you're not only

716
00:26:18,880 --> 00:26:20,799
changing the settings

717
00:26:20,799 --> 00:26:24,080
this you're changing the settings to

718
00:26:24,080 --> 00:26:27,200
make the printer authenticate to you as

719
00:26:27,200 --> 00:26:29,279
the attacker so typically in these

720
00:26:29,279 --> 00:26:30,960
settings here i think i have a

721
00:26:30,960 --> 00:26:33,039
screenshot of this

722
00:26:33,039 --> 00:26:34,159
um

723
00:26:34,159 --> 00:26:36,240
typically within the settings

724
00:26:36,240 --> 00:26:38,720
you are giving an ip address and you're

725
00:26:38,720 --> 00:26:40,720
giving a port number in order to

726
00:26:40,720 --> 00:26:43,200
authenticate to but here i have it

727
00:26:43,200 --> 00:26:44,480
specifically and this is where i

728
00:26:44,480 --> 00:26:45,919
actually change the settings inside of

729
00:26:45,919 --> 00:26:48,320
this xerox printer you change the ip

730
00:26:48,320 --> 00:26:50,960
address to your own attacker machine and

731
00:26:50,960 --> 00:26:52,480
then you change the port that it

732
00:26:52,480 --> 00:26:55,600
authenticates to which i change to 3333

733
00:26:55,600 --> 00:26:58,960
and then when that printer goes ahead

734
00:26:58,960 --> 00:27:00,480
and um

735
00:27:00,480 --> 00:27:03,520
tries to do an authentication type of

736
00:27:03,520 --> 00:27:06,159
event it sends those authentic those

737
00:27:06,159 --> 00:27:08,240
clear text credentials directly to your

738
00:27:08,240 --> 00:27:10,480
attacker machine and let me tell you how

739
00:27:10,480 --> 00:27:12,960
how you do do that and feel free to

740
00:27:12,960 --> 00:27:14,960
start to load the comment section up

741
00:27:14,960 --> 00:27:16,480
with questions because i can go into

742
00:27:16,480 --> 00:27:18,320
more detail but just for the interest of

743
00:27:18,320 --> 00:27:20,799
time and to make sure i get your your

744
00:27:20,799 --> 00:27:22,240
your questions i'm not going to go into

745
00:27:22,240 --> 00:27:24,960
so much detail into protocols and how to

746
00:27:24,960 --> 00:27:27,120
break those things things things down

747
00:27:27,120 --> 00:27:29,200
but the way that so once you change the

748
00:27:29,200 --> 00:27:31,279
settings to your attacker machine which

749
00:27:31,279 --> 00:27:33,760
is the ip address and the port directly

750
00:27:33,760 --> 00:27:35,360
within the administrative access of

751
00:27:35,360 --> 00:27:37,600
these printers you set up what you call

752
00:27:37,600 --> 00:27:40,559
netcat a netcat listener so if you uh

753
00:27:40,559 --> 00:27:42,159
for those who don't know about netcat

754
00:27:42,159 --> 00:27:43,520
it's a

755
00:27:43,520 --> 00:27:46,240
networking type of tool which allows you

756
00:27:46,240 --> 00:27:48,720
to capture and to monitor different

757
00:27:48,720 --> 00:27:51,200
network events um specifically many

758
00:27:51,200 --> 00:27:54,000
attackers use it or many ethical hackers

759
00:27:54,000 --> 00:27:55,520
use it so what you're doing is that

760
00:27:55,520 --> 00:27:57,279
you're going to set up a netcat listener

761
00:27:57,279 --> 00:27:59,440
on your machine and then you're going to

762
00:27:59,440 --> 00:28:01,120
also and after that you're going to

763
00:28:01,120 --> 00:28:04,880
initiate an ldap query where as you saw

764
00:28:04,880 --> 00:28:07,279
a little bit hopefully you can see this

765
00:28:07,279 --> 00:28:09,840
i can barely see it but what i did here

766
00:28:09,840 --> 00:28:12,240
is that i initiated uh

767
00:28:12,240 --> 00:28:14,960
a ldap query event i just searched for

768
00:28:14,960 --> 00:28:17,840
myself right gabriel that admiration

769
00:28:17,840 --> 00:28:20,480
whatever um and that initiated an

770
00:28:20,480 --> 00:28:23,440
authentication event on this printer and

771
00:28:23,440 --> 00:28:25,600
then because i had that netcat listener

772
00:28:25,600 --> 00:28:28,960
that specified on that port 3333

773
00:28:28,960 --> 00:28:32,080
i was able to do this here

774
00:28:32,080 --> 00:28:34,320
multiple times so let me just kind of

775
00:28:34,320 --> 00:28:36,159
break this down a little bit so i'm

776
00:28:36,159 --> 00:28:38,000
using netcat that's that's the tool

777
00:28:38,000 --> 00:28:39,600
that's the command line too and it comes

778
00:28:39,600 --> 00:28:41,440
with kali linux so this isn't something

779
00:28:41,440 --> 00:28:42,960
that you have to set up or anything

780
00:28:42,960 --> 00:28:44,960
there's a netcat listener so that l

781
00:28:44,960 --> 00:28:47,919
stands for listener v stands for verbose

782
00:28:47,919 --> 00:28:50,720
or um the out the output is verb verb

783
00:28:50,720 --> 00:28:52,080
for both and the port that you're

784
00:28:52,080 --> 00:28:55,120
listening on is that 3333

785
00:28:55,120 --> 00:28:57,200
and like i mentioned before that 3333 is

786
00:28:57,200 --> 00:28:58,640
it something i just set it up as you can

787
00:28:58,640 --> 00:29:00,399
make it anything you make it one one one

788
00:29:00,399 --> 00:29:02,960
one two five seventy

789
00:29:02,960 --> 00:29:05,120
whatever i don't it doesn't matter so i

790
00:29:05,120 --> 00:29:07,440
set it up to listen on this port

791
00:29:07,440 --> 00:29:10,000
after i change my attacker machine as

792
00:29:10,000 --> 00:29:11,840
the thing that the printer would try to

793
00:29:11,840 --> 00:29:15,120
authenticate to using the ldap uh uh

794
00:29:15,120 --> 00:29:18,399
protocol and as you see here i just kind

795
00:29:18,399 --> 00:29:20,399
of pointed out again don't want to show

796
00:29:20,399 --> 00:29:22,240
any customer information but you see

797
00:29:22,240 --> 00:29:24,240
number one is that as i list it and

798
00:29:24,240 --> 00:29:26,559
that's the domain so that'll be specific

799
00:29:26,559 --> 00:29:28,559
to the active directory domain that

800
00:29:28,559 --> 00:29:30,559
you're in um where the customer has put

801
00:29:30,559 --> 00:29:32,720
you number two specifically is the

802
00:29:32,720 --> 00:29:33,919
username

803
00:29:33,919 --> 00:29:37,360
clear text username of the printer right

804
00:29:37,360 --> 00:29:39,600
it might be something xerox or whatever

805
00:29:39,600 --> 00:29:41,039
or something associated with the

806
00:29:41,039 --> 00:29:43,200
organization and then the password is

807
00:29:43,200 --> 00:29:44,399
right here i just gave you a little bit

808
00:29:44,399 --> 00:29:46,799
of the second part of the password but

809
00:29:46,799 --> 00:29:47,919
it's this

810
00:29:47,919 --> 00:29:50,320
and 2004

811
00:29:50,320 --> 00:29:51,559
b or

812
00:29:51,559 --> 00:29:54,480
20040b that question mark isn't it's

813
00:29:54,480 --> 00:29:57,520
it's just a mush i had oh i'm sorry yeah

814
00:29:57,520 --> 00:29:59,200
it's just a much after i tested it the

815
00:29:59,200 --> 00:30:01,760
second time so again right

816
00:30:01,760 --> 00:30:03,279
you got into the printer i just want to

817
00:30:03,279 --> 00:30:05,520
kind of outline this a little a little

818
00:30:05,520 --> 00:30:07,360
bit more going through the steps of what

819
00:30:07,360 --> 00:30:08,960
actually happens

820
00:30:08,960 --> 00:30:10,960
first you scan for these printers you

821
00:30:10,960 --> 00:30:12,880
found you found them you put it into

822
00:30:12,880 --> 00:30:14,399
some type of text file and you're like

823
00:30:14,399 --> 00:30:16,240
okay i'm going to go and do my dirt

824
00:30:16,240 --> 00:30:17,440
right i'm going to go and find a

825
00:30:17,440 --> 00:30:19,600
vulnerability you put in default

826
00:30:19,600 --> 00:30:21,840
credentials for that printer in order to

827
00:30:21,840 --> 00:30:23,440
gain administrative access of that

828
00:30:23,440 --> 00:30:25,919
device you change the ldap settings

829
00:30:25,919 --> 00:30:26,799
where

830
00:30:26,799 --> 00:30:28,240
they don't the printer doesn't

831
00:30:28,240 --> 00:30:30,399
authenticate to the ldap server but it

832
00:30:30,399 --> 00:30:32,399
rather tries to authenticate to you as

833
00:30:32,399 --> 00:30:34,640
the attacker and you change that port

834
00:30:34,640 --> 00:30:37,200
you set up a netcat listener on your

835
00:30:37,200 --> 00:30:39,200
home machine where you're listening on

836
00:30:39,200 --> 00:30:41,520
the port that you change change it to

837
00:30:41,520 --> 00:30:44,880
and then you initiate an ldap query in

838
00:30:44,880 --> 00:30:45,919
that printer because it has the

839
00:30:45,919 --> 00:30:48,880
capability within every printer um

840
00:30:48,880 --> 00:30:52,240
you set up an ldap query and that forces

841
00:30:52,240 --> 00:30:55,520
the the the printer to finally like use

842
00:30:55,520 --> 00:30:58,080
uh those those credentials and it sends

843
00:30:58,080 --> 00:31:00,720
it to you directly in clear text i just

844
00:31:00,720 --> 00:31:04,480
want to pause here just to show you this

845
00:31:04,480 --> 00:31:07,360
is what the result is right and kind of

846
00:31:07,360 --> 00:31:10,080
giving even more emphasis is that again

847
00:31:10,080 --> 00:31:13,519
these printers exist within every single

848
00:31:13,519 --> 00:31:16,000
level within whether i t where they're

849
00:31:16,000 --> 00:31:18,799
ot it exists everywhere and very many

850
00:31:18,799 --> 00:31:21,760
times very close to high value assets

851
00:31:21,760 --> 00:31:24,399
within ot environments so i think that i

852
00:31:24,399 --> 00:31:26,159
just want to give you the emphasis just

853
00:31:26,159 --> 00:31:28,880
there and you might be asking yourself

854
00:31:28,880 --> 00:31:30,960
so what you have printer

855
00:31:30,960 --> 00:31:32,799
credentials within an environment you

856
00:31:32,799 --> 00:31:34,960
have printer credentials

857
00:31:34,960 --> 00:31:37,519
printer credentials isn't a domain admin

858
00:31:37,519 --> 00:31:40,320
they're not even a regular user right or

859
00:31:40,320 --> 00:31:42,320
or they're not even a privileged user

860
00:31:42,320 --> 00:31:44,640
within the active directory environments

861
00:31:44,640 --> 00:31:46,799
i think that's valuable about this is

862
00:31:46,799 --> 00:31:49,840
that this is an initial foothold

863
00:31:49,840 --> 00:31:52,480
you don't really need you can do so much

864
00:31:52,480 --> 00:31:55,519
with very little privileged accounts

865
00:31:55,519 --> 00:31:57,840
even that of a printer account so like i

866
00:31:57,840 --> 00:32:00,240
said in number five here finally you can

867
00:32:00,240 --> 00:32:02,559
elev so now this is a time to elevate

868
00:32:02,559 --> 00:32:04,720
privileges move laterally and

869
00:32:04,720 --> 00:32:07,039
quote-unquote right have some some some

870
00:32:07,039 --> 00:32:09,200
fun so let me show you what that next

871
00:32:09,200 --> 00:32:11,360
step looks like after you've gotten

872
00:32:11,360 --> 00:32:13,440
those credentials and what can you do so

873
00:32:13,440 --> 00:32:16,080
now you have the credentials you can use

874
00:32:16,080 --> 00:32:18,640
them as an initial foothold but now you

875
00:32:18,640 --> 00:32:20,480
can elevate privileges and move around

876
00:32:20,480 --> 00:32:23,039
the environment to do more things find

877
00:32:23,039 --> 00:32:25,039
more vulnerabilities so the first one

878
00:32:25,039 --> 00:32:26,640
that i want to point out here and like i

879
00:32:26,640 --> 00:32:28,080
said just random graphic i just took

880
00:32:28,080 --> 00:32:29,440
graphics and threw them there you know

881
00:32:29,440 --> 00:32:31,039
sometimes people want to put very

882
00:32:31,039 --> 00:32:33,200
specific things to their talk or very

883
00:32:33,200 --> 00:32:34,960
specific thing i just took i don't know

884
00:32:34,960 --> 00:32:36,480
nuclear is the first one right nuclear

885
00:32:36,480 --> 00:32:38,480
graphic so what you can do here is that

886
00:32:38,480 --> 00:32:40,480
you can use the bloodhound tool to

887
00:32:40,480 --> 00:32:42,960
enumerate ot active directory

888
00:32:42,960 --> 00:32:45,279
environments with printer credentials

889
00:32:45,279 --> 00:32:47,440
you can take those pop them into

890
00:32:47,440 --> 00:32:49,519
bloodhound and to be able to

891
00:32:49,519 --> 00:32:52,159
map or to be able to show the entire

892
00:32:52,159 --> 00:32:53,840
active directory environment and

893
00:32:53,840 --> 00:32:56,480
potential attack vectors and areas where

894
00:32:56,480 --> 00:32:59,679
you can move to cause to to cause more

895
00:32:59,679 --> 00:33:02,559
damage to find more vulnerabilities all

896
00:33:02,559 --> 00:33:04,320
you need are those printer credentials

897
00:33:04,320 --> 00:33:05,840
in order to throw into bloodhound i've

898
00:33:05,840 --> 00:33:07,760
done it before it's very easy second one

899
00:33:07,760 --> 00:33:10,399
baby right baby graphic second one

900
00:33:10,399 --> 00:33:13,039
capture additional domain account hashes

901
00:33:13,039 --> 00:33:15,600
using printer credentials to perform a

902
00:33:15,600 --> 00:33:17,279
kerber roasting attack

903
00:33:17,279 --> 00:33:19,360
i've done this before too

904
00:33:19,360 --> 00:33:22,640
to you to so there are and i can provide

905
00:33:22,640 --> 00:33:23,440
that

906
00:33:23,440 --> 00:33:25,360
maybe at a later time or maybe after

907
00:33:25,360 --> 00:33:28,559
this this this talk there is a python

908
00:33:28,559 --> 00:33:31,600
repository on github called impacts and

909
00:33:31,600 --> 00:33:33,519
they have the capability where you can

910
00:33:33,519 --> 00:33:35,760
put in the username and the pass

911
00:33:35,760 --> 00:33:37,760
password of the printer credentials in

912
00:33:37,760 --> 00:33:41,120
order to find more um accounts just kind

913
00:33:41,120 --> 00:33:42,799
of go around the whole entire

914
00:33:42,799 --> 00:33:44,320
environment and all you need are these

915
00:33:44,320 --> 00:33:46,720
low-level accounts these printer

916
00:33:46,720 --> 00:33:48,640
credentials in order to do additional

917
00:33:48,640 --> 00:33:50,960
curb roasting right so or a kerberos

918
00:33:50,960 --> 00:33:53,200
think attack so that'll pretty much with

919
00:33:53,200 --> 00:33:56,320
that impact its um tool you are able to

920
00:33:56,320 --> 00:33:58,159
put in the username and password and

921
00:33:58,159 --> 00:34:00,799
then you can it'll return to you account

922
00:34:00,799 --> 00:34:03,840
has typically uh machine account hashes

923
00:34:03,840 --> 00:34:05,679
and you can use those do some offline

924
00:34:05,679 --> 00:34:07,519
cracking and at times i've had some

925
00:34:07,519 --> 00:34:09,839
peers who have been able to even get um

926
00:34:09,839 --> 00:34:12,879
domain admin credentials doing this with

927
00:34:12,879 --> 00:34:16,159
low-level low-level privileged accounts

928
00:34:16,159 --> 00:34:18,719
such as those of a printer

929
00:34:18,719 --> 00:34:20,960
astronaut the third one you can search

930
00:34:20,960 --> 00:34:23,839
the web you user interface for old print

931
00:34:23,839 --> 00:34:25,599
jobs that reveal sensitive company

932
00:34:25,599 --> 00:34:27,839
information for those who have i don't

933
00:34:27,839 --> 00:34:29,760
know home printers or even have managed

934
00:34:29,760 --> 00:34:31,918
printers for enterprise environments you

935
00:34:31,918 --> 00:34:34,000
know that sometimes printers can be

936
00:34:34,000 --> 00:34:36,000
janky right they can be in a situation

937
00:34:36,000 --> 00:34:37,918
where you can try to print something but

938
00:34:37,918 --> 00:34:40,719
that job will cancel or hold inside that

939
00:34:40,719 --> 00:34:43,040
machine you can look at the cash and in

940
00:34:43,040 --> 00:34:44,639
many printers they have a capability

941
00:34:44,639 --> 00:34:46,560
where you can review the cash or even at

942
00:34:46,560 --> 00:34:48,960
times past print jobs where you can pull

943
00:34:48,960 --> 00:34:53,040
up full pdfs full video documents of

944
00:34:53,040 --> 00:34:55,119
sensitive company information and you

945
00:34:55,119 --> 00:34:56,800
don't even have to

946
00:34:56,800 --> 00:34:58,560
to compromise somebody's machine you

947
00:34:58,560 --> 00:34:59,839
don't have to compromise a windows

948
00:34:59,839 --> 00:35:01,760
machine you have to compromise servers

949
00:35:01,760 --> 00:35:03,280
you can go directly with that

950
00:35:03,280 --> 00:35:05,280
administrative access to that printer

951
00:35:05,280 --> 00:35:07,040
you can see sensitive print job for

952
00:35:07,040 --> 00:35:09,839
company information i've seen drafts of

953
00:35:09,839 --> 00:35:10,960
um

954
00:35:10,960 --> 00:35:13,599
company drawings and um

955
00:35:13,599 --> 00:35:15,520
schematics about environments network

956
00:35:15,520 --> 00:35:16,480
architecture

957
00:35:16,480 --> 00:35:18,480
all of these i have seen within old

958
00:35:18,480 --> 00:35:21,280
print jobs of printers or you can use

959
00:35:21,280 --> 00:35:23,599
alien the last one you can use crack map

960
00:35:23,599 --> 00:35:26,160
exec which is another tool um and other

961
00:35:26,160 --> 00:35:28,240
enumeration tools to find open file

962
00:35:28,240 --> 00:35:30,000
shares and interesting information you

963
00:35:30,000 --> 00:35:31,839
can just take those credentials from

964
00:35:31,839 --> 00:35:33,680
that printer and just spray them towards

965
00:35:33,680 --> 00:35:35,839
the network now that's not that could be

966
00:35:35,839 --> 00:35:37,359
for a pen test but definitely not for a

967
00:35:37,359 --> 00:35:40,480
red team crap mac exec is very loud it's

968
00:35:40,480 --> 00:35:43,200
something that's very noticeable by um

969
00:35:43,200 --> 00:35:45,599
defenders um so if but if you notice

970
00:35:45,599 --> 00:35:47,280
that maybe

971
00:35:47,280 --> 00:35:48,720
that organization doesn't really have a

972
00:35:48,720 --> 00:35:50,480
lot of defenses in place they don't have

973
00:35:50,480 --> 00:35:52,480
an active sim or

974
00:35:52,480 --> 00:35:54,160
um if you're doing the internal pin test

975
00:35:54,160 --> 00:35:55,359
you can set this

976
00:35:55,359 --> 00:35:57,440
the standards or the with the rules the

977
00:35:57,440 --> 00:35:59,040
rules of engagement that you're not

978
00:35:59,040 --> 00:36:01,599
trying to be quiet in this act

979
00:36:01,599 --> 00:36:03,680
activity crap mac exec and other

980
00:36:03,680 --> 00:36:05,440
enumeration tools will be completely

981
00:36:05,440 --> 00:36:07,440
fine where you can utilize that username

982
00:36:07,440 --> 00:36:10,079
and password from those capture printer

983
00:36:10,079 --> 00:36:11,520
credentials and just spread them all

984
00:36:11,520 --> 00:36:14,320
across the network and look for no log

985
00:36:14,320 --> 00:36:17,680
logins or even very low privileged uh

986
00:36:17,680 --> 00:36:19,520
systems where you might be able you

987
00:36:19,520 --> 00:36:21,680
might be successful in compromising some

988
00:36:21,680 --> 00:36:23,599
additional machines and searching for

989
00:36:23,599 --> 00:36:25,280
credentials on those those machines so

990
00:36:25,280 --> 00:36:27,760
this is that of lateral movement here so

991
00:36:27,760 --> 00:36:29,520
these are some things four different

992
00:36:29,520 --> 00:36:31,680
things that you can do with these low

993
00:36:31,680 --> 00:36:35,680
level um credentials from printers

994
00:36:35,680 --> 00:36:38,480
so moving on and kind of wrapping it up

995
00:36:38,480 --> 00:36:40,960
and um just want to give a few

996
00:36:40,960 --> 00:36:42,640
recommendations right because i don't

997
00:36:42,640 --> 00:36:44,400
want you to just be stuck at the okay

998
00:36:44,400 --> 00:36:46,560
this is what i've done um or this is

999
00:36:46,560 --> 00:36:49,599
what people can do to me or anything i

1000
00:36:49,599 --> 00:36:50,880
want you to have an understanding of

1001
00:36:50,880 --> 00:36:52,480
what you can do

1002
00:36:52,480 --> 00:36:54,800
to remediate these type of things um

1003
00:36:54,800 --> 00:36:57,520
strengthen ot password policies across

1004
00:36:57,520 --> 00:36:59,599
the domain right um i think that that's

1005
00:36:59,599 --> 00:37:01,119
something that's very important because

1006
00:37:01,119 --> 00:37:02,800
if someone gets this initial foothold

1007
00:37:02,800 --> 00:37:04,160
even if they get these printer

1008
00:37:04,160 --> 00:37:05,839
credentials if they're trying to move on

1009
00:37:05,839 --> 00:37:07,680
to other systems capture credentials

1010
00:37:07,680 --> 00:37:08,960
like i was saying with the kerberos

1011
00:37:08,960 --> 00:37:11,359
thing they won't be able to crack these

1012
00:37:11,359 --> 00:37:13,200
accounts if there are strong password

1013
00:37:13,200 --> 00:37:16,000
policies in place and also that's

1014
00:37:16,000 --> 00:37:17,119
another thing i want to give you some

1015
00:37:17,119 --> 00:37:18,880
more information about ot environments

1016
00:37:18,880 --> 00:37:21,680
um shared accounts are still a thing

1017
00:37:21,680 --> 00:37:23,760
it's still a thing and typically don't

1018
00:37:23,760 --> 00:37:26,079
follow any password policies so that's

1019
00:37:26,079 --> 00:37:27,920
another thing that you can do know what

1020
00:37:27,920 --> 00:37:29,920
those shared accounts are and then you

1021
00:37:29,920 --> 00:37:32,560
can use additional controls security

1022
00:37:32,560 --> 00:37:34,560
controls to try to protect those systems

1023
00:37:34,560 --> 00:37:36,560
and assets maybe do some some

1024
00:37:36,560 --> 00:37:39,440
segmentation for the greater ot um

1025
00:37:39,440 --> 00:37:41,359
architecture or the ot network for those

1026
00:37:41,359 --> 00:37:42,640
systems that you know they have shared

1027
00:37:42,640 --> 00:37:43,680
passwords because they're more

1028
00:37:43,680 --> 00:37:45,599
vulnerable to these type of attacks so

1029
00:37:45,599 --> 00:37:47,040
these are some some things that you can

1030
00:37:47,040 --> 00:37:49,359
do within that number one second one is

1031
00:37:49,359 --> 00:37:52,079
hardened printers protocols ports and

1032
00:37:52,079 --> 00:37:55,040
services um disable everything that that

1033
00:37:55,040 --> 00:37:56,320
you don't need

1034
00:37:56,320 --> 00:37:58,320
sometimes um printers come with some

1035
00:37:58,320 --> 00:38:00,079
default

1036
00:38:00,079 --> 00:38:01,680
they come with default ports and

1037
00:38:01,680 --> 00:38:04,400
protocols open already you can harden

1038
00:38:04,400 --> 00:38:06,400
these to maybe only

1039
00:38:06,400 --> 00:38:08,720
um use certain services so these things

1040
00:38:08,720 --> 00:38:12,079
can be compromised or they can only only

1041
00:38:12,079 --> 00:38:14,320
certain systems can access these these

1042
00:38:14,320 --> 00:38:15,680
these printers that can be something

1043
00:38:15,680 --> 00:38:17,760
else else too so using some type of neck

1044
00:38:17,760 --> 00:38:20,640
network access control to try to really

1045
00:38:20,640 --> 00:38:23,040
deal with that type of situation um

1046
00:38:23,040 --> 00:38:25,680
regularly clear cash print jobs like i

1047
00:38:25,680 --> 00:38:27,359
was mentioning before you can get into

1048
00:38:27,359 --> 00:38:29,520
printers find all of the credentials and

1049
00:38:29,520 --> 00:38:32,880
go i mean find all of the uh cache print

1050
00:38:32,880 --> 00:38:35,359
print jobs and just go from there

1051
00:38:35,359 --> 00:38:36,800
there should probably be some type of

1052
00:38:36,800 --> 00:38:39,520
activity where this is regularly cleared

1053
00:38:39,520 --> 00:38:41,680
and um so that you don't have past and

1054
00:38:41,680 --> 00:38:44,160
historical print jobs on these machines

1055
00:38:44,160 --> 00:38:46,880
and overall change your printer default

1056
00:38:46,880 --> 00:38:50,160
credentials change them from the normal

1057
00:38:50,160 --> 00:38:52,160
or whatever the default credentials are

1058
00:38:52,160 --> 00:38:53,599
because many times organizations would

1059
00:38:53,599 --> 00:38:54,720
have maybe

1060
00:38:54,720 --> 00:38:57,040
some type of third-party service um come

1061
00:38:57,040 --> 00:38:59,119
in and install these printers and

1062
00:38:59,119 --> 00:39:01,200
they're not looking at

1063
00:39:01,200 --> 00:39:03,119
security as a consideration they're not

1064
00:39:03,119 --> 00:39:05,920
considering security in this type of

1065
00:39:05,920 --> 00:39:07,440
environment security is typically

1066
00:39:07,440 --> 00:39:10,720
handled at a higher level but um you as

1067
00:39:10,720 --> 00:39:12,880
a security practitioner should go in

1068
00:39:12,880 --> 00:39:15,520
there and recognize and look at the the

1069
00:39:15,520 --> 00:39:17,760
environment and change those default

1070
00:39:17,760 --> 00:39:19,599
credentials because you can anybody can

1071
00:39:19,599 --> 00:39:22,720
do one of these type of attacks

1072
00:39:22,720 --> 00:39:24,000
and

1073
00:39:24,000 --> 00:39:25,839
i oh i kind of want to leave you with a

1074
00:39:25,839 --> 00:39:28,960
just just a small story um so i was

1075
00:39:28,960 --> 00:39:31,839
working with an um an organization this

1076
00:39:31,839 --> 00:39:33,359
was a

1077
00:39:33,359 --> 00:39:35,760
it's the best way to describe them

1078
00:39:35,760 --> 00:39:37,440
this i i'll just say this was an

1079
00:39:37,440 --> 00:39:40,560
industrial organization they had

1080
00:39:40,560 --> 00:39:45,040
um all types of industrial or electrical

1081
00:39:45,040 --> 00:39:47,359
generation um

1082
00:39:47,359 --> 00:39:50,640
generation distribution type of services

1083
00:39:50,640 --> 00:39:52,480
and the thing about them is that they

1084
00:39:52,480 --> 00:39:54,880
put me into an internal pen test and

1085
00:39:54,880 --> 00:39:56,880
they had a shared environment between

1086
00:39:56,880 --> 00:39:59,040
their i.t and their ot

1087
00:39:59,040 --> 00:39:59,839
so

1088
00:39:59,839 --> 00:40:01,680
when i did this pen test for them the

1089
00:40:01,680 --> 00:40:03,920
first thing that i did is that i went

1090
00:40:03,920 --> 00:40:05,839
over this was the first thing that i did

1091
00:40:05,839 --> 00:40:09,440
i did this printer hack right and i was

1092
00:40:09,440 --> 00:40:11,680
able to elevate privileges from that

1093
00:40:11,680 --> 00:40:15,119
printer to that of the point of contact

1094
00:40:15,119 --> 00:40:17,440
that i had for that organization so the

1095
00:40:17,440 --> 00:40:19,119
point of contact typically with the pen

1096
00:40:19,119 --> 00:40:20,480
test is somebody who works for the

1097
00:40:20,480 --> 00:40:21,920
organization typically they're like the

1098
00:40:21,920 --> 00:40:24,160
lead security architect or the lead

1099
00:40:24,160 --> 00:40:26,480
security defender person i was able to

1100
00:40:26,480 --> 00:40:29,680
go from printer credentials to that

1101
00:40:29,680 --> 00:40:32,560
person's credentials just like that and

1102
00:40:32,560 --> 00:40:34,560
it was so interesting to like have the

1103
00:40:34,560 --> 00:40:36,319
executive out briefing and talking to

1104
00:40:36,319 --> 00:40:38,160
the staff talking to the organization

1105
00:40:38,160 --> 00:40:39,359
and saying hey

1106
00:40:39,359 --> 00:40:41,280
this all started the initial attack

1107
00:40:41,280 --> 00:40:43,920
vector for this attack was were your

1108
00:40:43,920 --> 00:40:45,760
printers and they just couldn't believe

1109
00:40:45,760 --> 00:40:47,760
it they were like no no we don't believe

1110
00:40:47,760 --> 00:40:49,040
it we don't believe

1111
00:40:49,040 --> 00:40:51,839
their printers caused me to get to all

1112
00:40:51,839 --> 00:40:53,280
their other systems and even the

1113
00:40:53,280 --> 00:40:55,760
credentials and the access the

1114
00:40:55,760 --> 00:40:57,839
privileged access of the person that was

1115
00:40:57,839 --> 00:40:59,359
sitting right across from me from that

1116
00:40:59,359 --> 00:41:01,200
organization and i think the thing about

1117
00:41:01,200 --> 00:41:03,040
that is that that's why i give it the

1118
00:41:03,040 --> 00:41:04,800
title of the um

1119
00:41:04,800 --> 00:41:06,640
it's it's it's not it's a not very

1120
00:41:06,640 --> 00:41:09,440
valued asset but it can cause these type

1121
00:41:09,440 --> 00:41:12,319
of effects so that really is where i

1122
00:41:12,319 --> 00:41:14,319
want to leave leave you all with is that

1123
00:41:14,319 --> 00:41:16,000
i don't think any rock should be left

1124
00:41:16,000 --> 00:41:18,240
unturned in security that we need to

1125
00:41:18,240 --> 00:41:20,400
start to get more creative in our ways

1126
00:41:20,400 --> 00:41:23,520
and methods of of defending our

1127
00:41:23,520 --> 00:41:25,040
environments and just like i mentioned

1128
00:41:25,040 --> 00:41:26,800
again like no rock should be left

1129
00:41:26,800 --> 00:41:29,760
unturned not even your printers

1130
00:41:29,760 --> 00:41:32,560
okay so i want to leave you with that um

1131
00:41:32,560 --> 00:41:34,079
these are my socials like i mentioned

1132
00:41:34,079 --> 00:41:36,240
before i'm on youtube again struggle

1133
00:41:36,240 --> 00:41:38,480
security is the name of my you youtube

1134
00:41:38,480 --> 00:41:40,800
channel please subs subscribe check out

1135
00:41:40,800 --> 00:41:43,440
my my content it's mainly for that of

1136
00:41:43,440 --> 00:41:45,040
people who are entry level to cyber

1137
00:41:45,040 --> 00:41:47,200
security or people who are transitioning

1138
00:41:47,200 --> 00:41:48,880
into the cyber security field where

1139
00:41:48,880 --> 00:41:50,720
again the tagline is normalizing

1140
00:41:50,720 --> 00:41:53,200
struggling in cyber security this is my

1141
00:41:53,200 --> 00:41:56,720
twitter here um it's it's ics gabe um

1142
00:41:56,720 --> 00:41:58,800
industrial control system gabe kind of

1143
00:41:58,800 --> 00:42:00,560
speaks for itself right i've been in

1144
00:42:00,560 --> 00:42:02,640
this field for years and that's kind of

1145
00:42:02,640 --> 00:42:04,319
my tag line that i've been going after

1146
00:42:04,319 --> 00:42:06,240
for years and these are things that you

1147
00:42:06,240 --> 00:42:08,720
can follow me on dms are open i have an

1148
00:42:08,720 --> 00:42:10,240
email address for my youtube channel

1149
00:42:10,240 --> 00:42:13,760
also dms are open for my um

1150
00:42:13,760 --> 00:42:15,040
twitter

1151
00:42:15,040 --> 00:42:17,599
and thank you thank you thank you i

1152
00:42:17,599 --> 00:42:19,920
really appreciate you all's time and now

1153
00:42:19,920 --> 00:42:22,240
i want to open it up for questions and

1154
00:42:22,240 --> 00:42:24,720
if there are any questions oh it says

1155
00:42:24,720 --> 00:42:26,720
lots of love from the chat questions

1156
00:42:26,720 --> 00:42:31,040
okay it says funny my home e s been xp

1157
00:42:31,040 --> 00:42:33,680
4100 home printer wants to update the

1158
00:42:33,680 --> 00:42:36,560
firmware and software are home printers

1159
00:42:36,560 --> 00:42:38,240
a problem

1160
00:42:38,240 --> 00:42:41,040
they can be yes so

1161
00:42:41,040 --> 00:42:42,640
it's just that so

1162
00:42:42,640 --> 00:42:44,880
again one of the prerequisites for this

1163
00:42:44,880 --> 00:42:47,200
attack was that of a microsoft um active

1164
00:42:47,200 --> 00:42:49,599
directory environment so someone could

1165
00:42:49,599 --> 00:42:52,000
compromise your home printer yes and

1166
00:42:52,000 --> 00:42:54,319
they could kind of start to map out and

1167
00:42:54,319 --> 00:42:55,359
look for

1168
00:42:55,359 --> 00:42:57,920
other assets within your home so if you

1169
00:42:57,920 --> 00:43:00,160
have a uh an active directory

1170
00:43:00,160 --> 00:43:01,839
environment in your home which some do

1171
00:43:01,839 --> 00:43:04,000
some people have home home labs

1172
00:43:04,000 --> 00:43:06,319
they can elevate privileges and

1173
00:43:06,319 --> 00:43:09,040
compromise different systems um just

1174
00:43:09,040 --> 00:43:12,240
from that aspen xp 4100 printer so i

1175
00:43:12,240 --> 00:43:13,440
would say first change the default

1176
00:43:13,440 --> 00:43:15,839
credentials and then go from there and

1177
00:43:15,839 --> 00:43:17,680
and really that those that default

1178
00:43:17,680 --> 00:43:20,560
credential attack vector is really the

1179
00:43:20,560 --> 00:43:22,640
main crux there right how else would i

1180
00:43:22,640 --> 00:43:24,800
be able to gain access or administrative

1181
00:43:24,800 --> 00:43:26,640
access to those printers if i didn't

1182
00:43:26,640 --> 00:43:29,359
have access to those systems so um i

1183
00:43:29,359 --> 00:43:31,440
think starting off by just changing that

1184
00:43:31,440 --> 00:43:34,000
and then going from from there but yeah

1185
00:43:34,000 --> 00:43:37,280
it could be a be a problem yep

1186
00:43:37,280 --> 00:43:39,280
any other questions

1187
00:43:39,280 --> 00:43:41,839
let me see

1188
00:43:41,920 --> 00:43:45,040
i'm checking the chat

1189
00:43:47,760 --> 00:43:49,040
people are giving all their printer

1190
00:43:49,040 --> 00:43:50,960
walls i'm seeing them i'm seeing them

1191
00:43:50,960 --> 00:43:53,960
okay

1192
00:43:56,800 --> 00:43:59,280
see it seems seems like a network news

1193
00:43:59,280 --> 00:44:00,640
report it's because i've been doing

1194
00:44:00,640 --> 00:44:02,319
youtube for a little while now so you

1195
00:44:02,319 --> 00:44:04,160
know i kind of

1196
00:44:04,160 --> 00:44:07,040
uh coming right right here straight to

1197
00:44:07,040 --> 00:44:09,680
you type of thing

1198
00:44:09,680 --> 00:44:12,160
i'm not seeing any other questions

1199
00:44:12,160 --> 00:44:14,640
let's see

1200
00:44:16,720 --> 00:44:19,040
okay

1201
00:44:19,280 --> 00:44:21,280
okay well i think that that's the end of

1202
00:44:21,280 --> 00:44:25,760
my my presentation um oh well

1203
00:44:25,760 --> 00:44:28,079
um i have one more slide here right so

1204
00:44:28,079 --> 00:44:29,599
one more slide here is that us at

1205
00:44:29,599 --> 00:44:32,319
accenture um just a quick small little

1206
00:44:32,319 --> 00:44:34,000
plug here right i said accenture we're

1207
00:44:34,000 --> 00:44:35,520
doing something called the ot incident

1208
00:44:35,520 --> 00:44:38,400
response experience myself a gentleman

1209
00:44:38,400 --> 00:44:41,280
named brian singer he's a um he's very

1210
00:44:41,280 --> 00:44:43,760
he he wrote the book on industrial

1211
00:44:43,760 --> 00:44:45,599
hacking on chris raider another one of

1212
00:44:45,599 --> 00:44:48,000
my colleagues but we're doing this and

1213
00:44:48,000 --> 00:44:49,280
feel free to reach out to me for more

1214
00:44:49,280 --> 00:44:51,119
information it's mainly like a training

1215
00:44:51,119 --> 00:44:53,599
very like immersive training for ot

1216
00:44:53,599 --> 00:44:55,200
incident response type of engagements i

1217
00:44:55,200 --> 00:44:56,480
don't know if anybody's interested in

1218
00:44:56,480 --> 00:44:58,400
that but just wanted to throw that there

1219
00:44:58,400 --> 00:45:00,319
for you all's viewing pleasure if you

1220
00:45:00,319 --> 00:45:02,319
want more information on it feel free to

1221
00:45:02,319 --> 00:45:03,839
jump in those uh

1222
00:45:03,839 --> 00:45:06,640
dms on twitter or anywhere within my

1223
00:45:06,640 --> 00:45:08,960
email um for the struggle security

1224
00:45:08,960 --> 00:45:10,800
website or the struggle security youtube

1225
00:45:10,800 --> 00:45:13,440
channel and again thank you and i think

1226
00:45:13,440 --> 00:45:14,720
that's it

1227
00:45:14,720 --> 00:45:17,720
okay

1228
00:49:01,040 --> 00:49:03,119
you

