1
00:00:02,960 --> 00:00:06,399
i'm

2
00:00:03,439 --> 00:00:07,520
very pleased to bring on to the stage uh

3
00:00:06,399 --> 00:00:10,240
venkataman

4
00:00:07,520 --> 00:00:10,959
okay hello and catherine how are you

5
00:00:10,240 --> 00:00:13,759
yeah hello

6
00:00:10,960 --> 00:00:14,160
how are you doing here hope you're safe

7
00:00:13,759 --> 00:00:16,320
good

8
00:00:14,160 --> 00:00:19,039
yes all very good thank you and where

9
00:00:16,320 --> 00:00:22,640
are you calling it from today

10
00:00:19,039 --> 00:00:23,039
uh i'm i'm descending at chennai which

11
00:00:22,640 --> 00:00:26,960
is in

12
00:00:23,039 --> 00:00:29,119
india yes yeah yeah absolutely

13
00:00:26,960 --> 00:00:31,199
good to hear it so you will be talking

14
00:00:29,119 --> 00:00:34,559
about uh demystifying

15
00:00:31,199 --> 00:00:36,800
common active directory attacks yeah uh

16
00:00:34,559 --> 00:00:39,199
that's the topic what made you uh

17
00:00:36,800 --> 00:00:43,040
interested in this in the first place

18
00:00:39,200 --> 00:00:45,680
yeah the thing i'm interested about is

19
00:00:43,040 --> 00:00:47,360
red teaming assessment and when it comes

20
00:00:45,680 --> 00:00:50,079
to red teaming assessment

21
00:00:47,360 --> 00:00:50,960
the common environment you face is

22
00:00:50,079 --> 00:00:54,160
windows

23
00:00:50,960 --> 00:00:56,320
which is in most of the corporate and

24
00:00:54,160 --> 00:00:57,519
i guess this is the basic stuff you need

25
00:00:56,320 --> 00:01:00,559
to know when

26
00:00:57,520 --> 00:01:02,960
when you get to an engagement there yeah

27
00:01:00,559 --> 00:01:04,878
yeah very good so i'm sure plenty of

28
00:01:02,960 --> 00:01:06,640
audience members will be

29
00:01:04,879 --> 00:01:09,280
interested in this so please bring up

30
00:01:06,640 --> 00:01:12,880
your slides

31
00:01:09,280 --> 00:01:15,680
and we will get those on the screen

32
00:01:12,880 --> 00:01:16,479
sure so i will be sharing my entire

33
00:01:15,680 --> 00:01:19,920
screen here

34
00:01:16,479 --> 00:01:22,799
uh since uh i have the

35
00:01:19,920 --> 00:01:24,880
demos to show up if anything goes wrong

36
00:01:22,799 --> 00:01:27,119
please sure to tell me

37
00:01:24,880 --> 00:01:30,000
absolutely and we can all then pray to

38
00:01:27,119 --> 00:01:30,000
the demo gods

39
00:01:33,759 --> 00:01:38,240
uh is my screen visible no yes it is you

40
00:01:36,799 --> 00:01:42,000
want to bring up the screen that

41
00:01:38,240 --> 00:01:44,079
there we go okay excellent so

42
00:01:42,000 --> 00:01:45,280
demystifying common active directory

43
00:01:44,079 --> 00:01:48,720
attacks taking away

44
00:01:45,280 --> 00:01:50,640
vein catcher man yeah sure so

45
00:01:48,720 --> 00:01:51,920
the topic for today's session would be

46
00:01:50,640 --> 00:01:55,040
dimensifying common

47
00:01:51,920 --> 00:01:55,920
active directory attacks so let's get to

48
00:01:55,040 --> 00:01:58,560
it

49
00:01:55,920 --> 00:02:00,960
so the agenda for today's topic would be

50
00:01:58,560 --> 00:02:04,640
basics of kerberos authentication

51
00:02:00,960 --> 00:02:05,919
technical terms like kdc tgt tgs tickets

52
00:02:04,640 --> 00:02:09,598
should be explained

53
00:02:05,920 --> 00:02:11,760
uh i will also show an uh demo and uh

54
00:02:09,598 --> 00:02:13,599
which uh along with the explanation of

55
00:02:11,760 --> 00:02:15,359
common active directory attacks like

56
00:02:13,599 --> 00:02:18,238
asrep roasting attack

57
00:02:15,360 --> 00:02:19,280
cable roasting attack dc sync attack dc

58
00:02:18,239 --> 00:02:21,599
shadow attack

59
00:02:19,280 --> 00:02:22,480
golden and silver ticket attacks there

60
00:02:21,599 --> 00:02:25,359
are more

61
00:02:22,480 --> 00:02:26,319
to uh when you dig deep into active

62
00:02:25,360 --> 00:02:28,080
directory attacks

63
00:02:26,319 --> 00:02:29,760
but these are the things that i would be

64
00:02:28,080 --> 00:02:32,560
sharing with you today

65
00:02:29,760 --> 00:02:32,959
so this is just a small disclaimer here

66
00:02:32,560 --> 00:02:36,080
uh

67
00:02:32,959 --> 00:02:39,040
all the demos and the explanation are

68
00:02:36,080 --> 00:02:39,840
given here you to uh give you a basic

69
00:02:39,040 --> 00:02:41,760
insight about

70
00:02:39,840 --> 00:02:43,920
active directory attacks that you would

71
00:02:41,760 --> 00:02:44,959
face in the ctf and the real world

72
00:02:43,920 --> 00:02:48,319
engagement

73
00:02:44,959 --> 00:02:50,560
and in order to understand each attack

74
00:02:48,319 --> 00:02:52,238
you need to dig deep into it i have

75
00:02:50,560 --> 00:02:55,519
provided enough references

76
00:02:52,239 --> 00:02:58,640
link uh in each attack

77
00:02:55,519 --> 00:03:01,440
uh hope that would be helpful

78
00:02:58,640 --> 00:03:03,200
and i have configured my demo accounts

79
00:03:01,440 --> 00:03:04,959
in such a way that the password is set

80
00:03:03,200 --> 00:03:07,760
as password at one two three

81
00:03:04,959 --> 00:03:08,720
uh in order to reduce the password

82
00:03:07,760 --> 00:03:11,920
cracking time

83
00:03:08,720 --> 00:03:14,560
and last one is i love beams

84
00:03:11,920 --> 00:03:15,839
if memes are too much uh sorry try to

85
00:03:14,560 --> 00:03:19,519
enjoy it

86
00:03:15,840 --> 00:03:21,200
that's it so let's uh who am i

87
00:03:19,519 --> 00:03:22,720
my name is venkatram and goes by the

88
00:03:21,200 --> 00:03:25,040
cyber name red wolf

89
00:03:22,720 --> 00:03:26,400
i'm working as a security analyst at

90
00:03:25,040 --> 00:03:28,720
walt infosec

91
00:03:26,400 --> 00:03:29,599
chapter lead or aspen i hold a couple of

92
00:03:28,720 --> 00:03:32,720
hall of fames

93
00:03:29,599 --> 00:03:35,359
one i love playing ctf's one a couple of

94
00:03:32,720 --> 00:03:37,599
rhythm village ctfs technical member of

95
00:03:35,360 --> 00:03:40,720
tamilnadu cyber security council

96
00:03:37,599 --> 00:03:43,839
if you have any doubts or any queries uh

97
00:03:40,720 --> 00:03:47,760
make sure you ping me over instagram and

98
00:03:43,840 --> 00:03:50,959
twitter these are my handles so

99
00:03:47,760 --> 00:03:52,959
let's get to the session so what is

100
00:03:50,959 --> 00:03:55,360
kerberos authentication

101
00:03:52,959 --> 00:03:57,599
in simple terms basically it's an

102
00:03:55,360 --> 00:03:59,599
authentication protocol which is used

103
00:03:57,599 --> 00:04:02,798
widely in windows environments

104
00:03:59,599 --> 00:04:03,599
and it is pretty advanced and it is an

105
00:04:02,799 --> 00:04:07,040
alternative

106
00:04:03,599 --> 00:04:10,238
to ntlm which is uh

107
00:04:07,040 --> 00:04:10,959
majorly used too so the major technical

108
00:04:10,239 --> 00:04:12,799
terms here

109
00:04:10,959 --> 00:04:14,239
are kdc which stands for key

110
00:04:12,799 --> 00:04:17,199
distribution center

111
00:04:14,239 --> 00:04:18,798
tgt ticket granting ticket and tgs

112
00:04:17,199 --> 00:04:22,160
ticket granting service

113
00:04:18,798 --> 00:04:24,880
so let's see what are those now so

114
00:04:22,160 --> 00:04:26,560
kdc stands for key distribution center

115
00:04:24,880 --> 00:04:28,639
this is a place where

116
00:04:26,560 --> 00:04:29,680
the user and the service tickets are

117
00:04:28,639 --> 00:04:32,320
generated

118
00:04:29,680 --> 00:04:34,000
upon verification of the request that is

119
00:04:32,320 --> 00:04:37,759
being sent from the client

120
00:04:34,000 --> 00:04:40,800
so this also has components like

121
00:04:37,759 --> 00:04:43,120
password database authentication cent

122
00:04:40,800 --> 00:04:45,120
authentication center and so on i

123
00:04:43,120 --> 00:04:47,440
wouldn't be much explaining about that

124
00:04:45,120 --> 00:04:48,160
since i don't want to stretch it along

125
00:04:47,440 --> 00:04:51,360
and

126
00:04:48,160 --> 00:04:54,560
next comes ticket granting ticket so it

127
00:04:51,360 --> 00:04:56,720
is the initial authentication where

128
00:04:54,560 --> 00:04:58,240
the user is verified and the kdc

129
00:04:56,720 --> 00:05:01,680
provides a ticket here

130
00:04:58,240 --> 00:05:04,639
this ticket is encrypted using the kr

131
00:05:01,680 --> 00:05:06,400
tgt accounts password which is a

132
00:05:04,639 --> 00:05:07,360
computer account which is handled by the

133
00:05:06,400 --> 00:05:10,960
domain controller

134
00:05:07,360 --> 00:05:12,240
itself and this tgt ticket is cached in

135
00:05:10,960 --> 00:05:15,758
the client machine

136
00:05:12,240 --> 00:05:18,080
and the request to access any other

137
00:05:15,759 --> 00:05:18,880
service from the client message uses

138
00:05:18,080 --> 00:05:20,479
this ticket

139
00:05:18,880 --> 00:05:22,880
and skipping the initial step of

140
00:05:20,479 --> 00:05:26,000
authentication so

141
00:05:22,880 --> 00:05:28,400
let's now move on to tds ticket here

142
00:05:26,000 --> 00:05:30,000
tgs ticket stands for uh ticket granting

143
00:05:28,400 --> 00:05:33,120
service when the user adds

144
00:05:30,000 --> 00:05:33,840
tgt ticket and the session key the user

145
00:05:33,120 --> 00:05:37,120
request

146
00:05:33,840 --> 00:05:40,638
the uh kdc in uh tgs

147
00:05:37,120 --> 00:05:44,720
when the user requests kdc to get

148
00:05:40,639 --> 00:05:46,720
tgs tickets once the tgt ticket provided

149
00:05:44,720 --> 00:05:49,520
by the client is verified

150
00:05:46,720 --> 00:05:51,280
the user generates a ticket which is

151
00:05:49,520 --> 00:05:52,000
encrypted using the service accounts

152
00:05:51,280 --> 00:05:55,198
password which

153
00:05:52,000 --> 00:05:56,960
is tgs ticket so let's see the

154
00:05:55,199 --> 00:05:59,360
authentication flow here

155
00:05:56,960 --> 00:06:01,039
so the pre logon or the initial

156
00:05:59,360 --> 00:06:03,680
authentication consists of

157
00:06:01,039 --> 00:06:04,719
two requests so one is the service

158
00:06:03,680 --> 00:06:07,360
request

159
00:06:04,720 --> 00:06:08,800
from the user to the kdc in this

160
00:06:07,360 --> 00:06:10,400
authentication there are only three

161
00:06:08,800 --> 00:06:12,560
actors here one is the client

162
00:06:10,400 --> 00:06:13,840
another one is a domain controller which

163
00:06:12,560 --> 00:06:16,960
in turn means the

164
00:06:13,840 --> 00:06:20,080
kdc two and another one is the service

165
00:06:16,960 --> 00:06:23,599
that the client is trying to access so

166
00:06:20,080 --> 00:06:26,000
the first steps comes with when a user

167
00:06:23,600 --> 00:06:29,840
generates a request to kdc

168
00:06:26,000 --> 00:06:32,400
this request is encrypted using the

169
00:06:29,840 --> 00:06:34,400
user's password the request is the

170
00:06:32,400 --> 00:06:37,919
current timestamp

171
00:06:34,400 --> 00:06:40,560
and this is sent to the kdc here once

172
00:06:37,919 --> 00:06:41,840
since the kdc has all the clients

173
00:06:40,560 --> 00:06:44,800
password all the

174
00:06:41,840 --> 00:06:46,560
user's password that request sent from

175
00:06:44,800 --> 00:06:49,840
the client is decrypted

176
00:06:46,560 --> 00:06:52,639
and the time stamp is verified here

177
00:06:49,840 --> 00:06:54,960
and upon verification the kdc generates

178
00:06:52,639 --> 00:06:57,840
a ticket which is a user ticket

179
00:06:54,960 --> 00:06:58,479
and it is sent in the asrep response

180
00:06:57,840 --> 00:07:00,960
here

181
00:06:58,479 --> 00:07:02,080
so this also has a session key which is

182
00:07:00,960 --> 00:07:05,599
encrypted using the

183
00:07:02,080 --> 00:07:08,080
user's password so once the clients get

184
00:07:05,599 --> 00:07:08,960
these two things from the kdc center

185
00:07:08,080 --> 00:07:10,960
user uh

186
00:07:08,960 --> 00:07:13,599
the client or the user again sends a

187
00:07:10,960 --> 00:07:17,599
request to the sql service in the cr

188
00:07:13,599 --> 00:07:21,680
kdc and upon verification here

189
00:07:17,599 --> 00:07:24,080
the kdc provides the tgs response

190
00:07:21,680 --> 00:07:24,800
this tgs response consists of two parts

191
00:07:24,080 --> 00:07:27,440
one is

192
00:07:24,800 --> 00:07:29,120
the tgs ticket which is encrypted using

193
00:07:27,440 --> 00:07:31,520
the service accounts password

194
00:07:29,120 --> 00:07:32,319
and the session key new session key

195
00:07:31,520 --> 00:07:34,080
which is

196
00:07:32,319 --> 00:07:36,560
always encrypted using the user's

197
00:07:34,080 --> 00:07:39,120
password and with these two

198
00:07:36,560 --> 00:07:40,400
the users can access the sql service

199
00:07:39,120 --> 00:07:43,280
here

200
00:07:40,400 --> 00:07:44,080
the user basically sends the tgs ticket

201
00:07:43,280 --> 00:07:48,000
here

202
00:07:44,080 --> 00:07:50,800
and the decryption takes place here and

203
00:07:48,000 --> 00:07:51,840
the authenticity of the talk ticket is

204
00:07:50,800 --> 00:07:54,960
verified

205
00:07:51,840 --> 00:07:57,919
so let's move on to our first attack so

206
00:07:54,960 --> 00:07:58,960
the first attack is asrep roasting

207
00:07:57,919 --> 00:08:01,120
attack

208
00:07:58,960 --> 00:08:03,599
it is an attack basically it focuses on

209
00:08:01,120 --> 00:08:06,240
the initial step of authentication

210
00:08:03,599 --> 00:08:08,560
and during the pre-authentication of the

211
00:08:06,240 --> 00:08:11,039
initial login phase

212
00:08:08,560 --> 00:08:11,599
the user enters the password and this is

213
00:08:11,039 --> 00:08:14,400
used to

214
00:08:11,599 --> 00:08:16,639
encrypt the current time stamp and it is

215
00:08:14,400 --> 00:08:20,400
sent to the domain controller

216
00:08:16,639 --> 00:08:22,879
once the domain controller receives it

217
00:08:20,400 --> 00:08:24,159
it verifies it by decrypting the key

218
00:08:22,879 --> 00:08:28,160
using the

219
00:08:24,160 --> 00:08:30,160
password and uh the timestamp

220
00:08:28,160 --> 00:08:31,520
timestamp is verified in order to avoid

221
00:08:30,160 --> 00:08:35,039
replay attacks

222
00:08:31,520 --> 00:08:37,439
so and upon verification it generates a

223
00:08:35,039 --> 00:08:39,360
ticket which is tgt ticket

224
00:08:37,440 --> 00:08:41,839
and as i mentioned earlier it is

225
00:08:39,360 --> 00:08:43,599
encrypted using the krbt gt's account

226
00:08:41,839 --> 00:08:45,920
password it's

227
00:08:43,599 --> 00:08:47,200
it's not too long but it's very complex

228
00:08:45,920 --> 00:08:49,680
it's hard to crack

229
00:08:47,200 --> 00:08:50,959
and this krbt gt accounts password is

230
00:08:49,680 --> 00:08:53,199
changed every

231
00:08:50,959 --> 00:08:55,199
30 days by the domain controller itself

232
00:08:53,200 --> 00:08:56,959
its automatic process

233
00:08:55,200 --> 00:08:59,440
this happens for all the computer

234
00:08:56,959 --> 00:09:02,640
accounts in the domain controller

235
00:08:59,440 --> 00:09:05,200
and and it

236
00:09:02,640 --> 00:09:06,319
also sends an session key so this

237
00:09:05,200 --> 00:09:09,680
session key

238
00:09:06,320 --> 00:09:11,839
can be decrypted offline so when the pre

239
00:09:09,680 --> 00:09:12,880
authentication is disabled in an user

240
00:09:11,839 --> 00:09:17,279
account an

241
00:09:12,880 --> 00:09:20,959
attacker could request the tgt

242
00:09:17,279 --> 00:09:22,000
ticket and in response the attacker

243
00:09:20,959 --> 00:09:24,160
would receive tgt

244
00:09:22,000 --> 00:09:26,000
ticket along with the session key from

245
00:09:24,160 --> 00:09:27,040
the session key the password can be

246
00:09:26,000 --> 00:09:30,880
extracted

247
00:09:27,040 --> 00:09:34,800
so in order to show the demo i have

248
00:09:30,880 --> 00:09:39,279
set up my windows machine

249
00:09:34,800 --> 00:09:39,279
let me just show you my things here

250
00:09:42,800 --> 00:09:47,439
okay yes

251
00:09:48,839 --> 00:09:53,680
so is my screen visible

252
00:09:56,399 --> 00:10:01,120
yep okay it's cool so let's see

253
00:09:59,760 --> 00:10:02,480
this is the active directory

254
00:10:01,120 --> 00:10:03,360
administrator center that i have

255
00:10:02,480 --> 00:10:05,760
configured

256
00:10:03,360 --> 00:10:07,680
so i just want to preview about uh

257
00:10:05,760 --> 00:10:08,319
certain accounts that i have configured

258
00:10:07,680 --> 00:10:11,760
here

259
00:10:08,320 --> 00:10:15,200
one is rashtra mouse and another one is

260
00:10:11,760 --> 00:10:16,319
bradley brad owen and he is a part of

261
00:10:15,200 --> 00:10:19,519
domain admin

262
00:10:16,320 --> 00:10:22,399
and he is a normal domain user and

263
00:10:19,519 --> 00:10:24,720
this sql service is also a part of

264
00:10:22,399 --> 00:10:26,720
domain admin group

265
00:10:24,720 --> 00:10:28,880
this account i have created in order to

266
00:10:26,720 --> 00:10:30,800
perform uh

267
00:10:28,880 --> 00:10:32,160
kerberos t contact which i would explain

268
00:10:30,800 --> 00:10:34,079
it later so

269
00:10:32,160 --> 00:10:35,839
let's now switch on to my attacker

270
00:10:34,079 --> 00:10:38,479
mission which is the kali

271
00:10:35,839 --> 00:10:38,959
in order to perform k asrep roasting

272
00:10:38,480 --> 00:10:41,600
attack

273
00:10:38,959 --> 00:10:44,319
i will be using impact script you can

274
00:10:41,600 --> 00:10:47,680
also use powershell scripts here

275
00:10:44,320 --> 00:10:48,640
there are many tools to it but for demo

276
00:10:47,680 --> 00:10:52,160
i will be using

277
00:10:48,640 --> 00:10:52,160
impact here so

278
00:10:53,920 --> 00:10:58,000
so the impact script that i will be

279
00:10:56,240 --> 00:11:01,440
using here is

280
00:10:58,000 --> 00:11:05,200
get np users and let's see the

281
00:11:01,440 --> 00:11:07,760
structure of empirical circuit here

282
00:11:05,200 --> 00:11:09,600
almost all of the impact scripts has

283
00:11:07,760 --> 00:11:11,920
default arguments which is the domain

284
00:11:09,600 --> 00:11:14,880
name and the username

285
00:11:11,920 --> 00:11:17,199
if you have added the domain controller

286
00:11:14,880 --> 00:11:19,760
ip address in your virtual host list

287
00:11:17,200 --> 00:11:20,800
you don't need to mention this i mean

288
00:11:19,760 --> 00:11:22,240
you don't need to

289
00:11:20,800 --> 00:11:24,079
explicitly mention the domain

290
00:11:22,240 --> 00:11:27,120
controllers ip here

291
00:11:24,079 --> 00:11:28,319
if you haven't then you need to mention

292
00:11:27,120 --> 00:11:31,519
it explicitly

293
00:11:28,320 --> 00:11:35,120
so let's try to get this sata

294
00:11:31,519 --> 00:11:39,120
done so

295
00:11:35,120 --> 00:11:43,120
my domain name is hdb.local

296
00:11:39,120 --> 00:11:46,160
i am going to

297
00:11:43,120 --> 00:11:50,079
retrieve the hash for rasta mouse

298
00:11:46,160 --> 00:11:50,079
who has kerberos free authentication

299
00:11:54,839 --> 00:11:57,839
disabled

300
00:11:59,120 --> 00:12:04,959
so my ip of the domain controller is one

301
00:12:02,880 --> 00:12:07,600
zero two

302
00:12:04,959 --> 00:12:09,359
okay so i have retrieved the response

303
00:12:07,600 --> 00:12:12,079
here which is the kerberos

304
00:12:09,360 --> 00:12:12,800
uh session key and this can be decrypted

305
00:12:12,079 --> 00:12:14,638
offline

306
00:12:12,800 --> 00:12:17,040
before decrypting it i just want to

307
00:12:14,639 --> 00:12:19,680
mention uh where this attacks

308
00:12:17,040 --> 00:12:21,519
where this attack can be useful uh this

309
00:12:19,680 --> 00:12:23,839
probably you won't be able to see in a

310
00:12:21,519 --> 00:12:27,200
real world engagement whereas in a ctf

311
00:12:23,839 --> 00:12:30,480
or in solving hack the box missions or

312
00:12:27,200 --> 00:12:33,200
in a rating

313
00:12:30,480 --> 00:12:35,760
thing you would be able to uh when you

314
00:12:33,200 --> 00:12:39,200
have certain usernames or

315
00:12:35,760 --> 00:12:42,000
the employee name and you can generate

316
00:12:39,200 --> 00:12:43,279
a list of username possible username and

317
00:12:42,000 --> 00:12:46,160
you can

318
00:12:43,279 --> 00:12:46,959
add this flag you add them using this

319
00:12:46,160 --> 00:12:49,439
flag

320
00:12:46,959 --> 00:12:50,638
and it would check whether the usernames

321
00:12:49,440 --> 00:12:52,560
that you have added

322
00:12:50,639 --> 00:12:54,800
have kerberos pre-authentication

323
00:12:52,560 --> 00:12:59,040
disabled so

324
00:12:54,800 --> 00:13:02,240
let's try to crack it so let me copy it

325
00:12:59,040 --> 00:13:05,439
i will be saving it in

326
00:13:02,240 --> 00:13:08,160
yes rep so

327
00:13:05,440 --> 00:13:08,160
let's save it

328
00:13:11,440 --> 00:13:15,200
so i will be using hi hash cat to crack

329
00:13:14,160 --> 00:13:18,079
this hash

330
00:13:15,200 --> 00:13:18,079
of course you can use

331
00:13:18,240 --> 00:13:22,639
john 2 but i feel comfortable using

332
00:13:20,720 --> 00:13:26,000
hashcat

333
00:13:22,639 --> 00:13:31,040
so hi there can you zoom in

334
00:13:26,000 --> 00:13:31,040
on your screen somewhat please shut

335
00:13:31,120 --> 00:13:36,959
up of course we can't see much

336
00:13:34,160 --> 00:13:36,959
okay okay

337
00:13:37,600 --> 00:13:49,839
let me just

338
00:14:00,160 --> 00:14:03,839
okay i'm not sure about

339
00:14:04,240 --> 00:14:08,320
okay if it's not possible then so be it

340
00:14:06,639 --> 00:14:11,519
but

341
00:14:08,320 --> 00:14:17,839
yeah let me just check it out

342
00:14:11,519 --> 00:14:17,839
once again

343
00:14:31,920 --> 00:14:38,240
i'm not sure why this isn't i'm playing

344
00:14:34,959 --> 00:14:40,399
okay okay uh sorry

345
00:14:38,240 --> 00:14:41,839
for the uh that's where it is okay then

346
00:14:40,399 --> 00:14:42,480
uh yeah i guess we'll just have to carry

347
00:14:41,839 --> 00:14:45,920
on

348
00:14:42,480 --> 00:14:48,160
and uh everybody squint sure

349
00:14:45,920 --> 00:14:48,160
so

350
00:14:49,279 --> 00:14:52,959
okay uh so here i have specified the

351
00:14:51,680 --> 00:14:57,279
domain name here

352
00:14:52,959 --> 00:15:01,040
so i know that uh okay this is a hash

353
00:14:57,279 --> 00:15:04,240
cam thing so we'll see which module we

354
00:15:01,040 --> 00:15:04,240
would be using it here

355
00:15:06,079 --> 00:15:09,519
uh we know that this is an asrep

356
00:15:08,399 --> 00:15:12,800
response here

357
00:15:09,519 --> 00:15:15,120
and this is encrypted type is 23

358
00:15:12,800 --> 00:15:16,479
so this is a module that we would be

359
00:15:15,120 --> 00:15:18,720
using it here

360
00:15:16,480 --> 00:15:18,720
so

361
00:15:24,839 --> 00:15:29,440
okay

362
00:15:27,120 --> 00:15:29,440
and

363
00:15:33,199 --> 00:15:37,758
rap and i would be using the common word

364
00:15:36,880 --> 00:15:42,399
list

365
00:15:37,759 --> 00:15:42,399
rock you hope you are familiar with it

366
00:15:45,199 --> 00:15:51,040
let's see so in the interim

367
00:15:48,880 --> 00:15:52,160
let's switch on to our domain controller

368
00:15:51,040 --> 00:15:55,040
and let me show you

369
00:15:52,160 --> 00:15:55,439
that this has been misconfigured so

370
00:15:55,040 --> 00:15:58,800
let's

371
00:15:55,440 --> 00:15:58,800
go to properties here

372
00:15:59,360 --> 00:16:02,880
and in the properties we can see other

373
00:16:02,000 --> 00:16:05,759
options

374
00:16:02,880 --> 00:16:07,279
so in this this has been explicitly set

375
00:16:05,759 --> 00:16:08,000
do not require kerberos free

376
00:16:07,279 --> 00:16:11,439
authentication

377
00:16:08,000 --> 00:16:14,320
is checked here so this is the

378
00:16:11,440 --> 00:16:17,040
key thing which is uh which is

379
00:16:14,320 --> 00:16:19,839
responsible for retrieving the hash

380
00:16:17,040 --> 00:16:21,439
kill bros has in our attackers mission

381
00:16:19,839 --> 00:16:24,430
so

382
00:16:21,440 --> 00:16:25,519
yes i guess the hash is cracked so

383
00:16:24,430 --> 00:16:28,239
[Music]

384
00:16:25,519 --> 00:16:28,880
i have and client machine which is set

385
00:16:28,240 --> 00:16:31,920
up here

386
00:16:28,880 --> 00:16:32,800
so this is the client mission this is

387
00:16:31,920 --> 00:16:36,079
connected to an

388
00:16:32,800 --> 00:16:38,880
ad and this client missions

389
00:16:36,079 --> 00:16:39,758
administrator is rashta mouse which is

390
00:16:38,880 --> 00:16:42,800
our mouse

391
00:16:39,759 --> 00:16:46,880
so i will try to uh execute

392
00:16:42,800 --> 00:16:50,000
uh commands over it uh for this one time

393
00:16:46,880 --> 00:16:53,120
and i wouldn't be cracking the hashes

394
00:16:50,000 --> 00:16:53,920
in all the attacks right now so this is

395
00:16:53,120 --> 00:16:57,440
justin

396
00:16:53,920 --> 00:16:57,439
point demo so

397
00:16:58,079 --> 00:17:03,599
i will be using ps exec here

398
00:17:01,120 --> 00:17:04,480
of course you can use uh impact tools

399
00:17:03,600 --> 00:17:08,000
like smb

400
00:17:04,480 --> 00:17:09,839
execs or evil vinaram if vinaram port is

401
00:17:08,000 --> 00:17:13,039
enabled in the target mission

402
00:17:09,839 --> 00:17:13,039
so let's see

403
00:17:15,839 --> 00:17:22,720
so again this has a format here local

404
00:17:19,199 --> 00:17:24,720
uh domain name and almost

405
00:17:22,720 --> 00:17:26,240
at the client machine which you are

406
00:17:24,720 --> 00:17:29,760
going to target here

407
00:17:26,240 --> 00:17:32,720
so the ip address is 128

408
00:17:29,760 --> 00:17:35,160
and the domain controller's ip address

409
00:17:32,720 --> 00:17:39,600
is 192.

410
00:17:35,160 --> 00:17:43,520
0.102 let's fire it up

411
00:17:39,600 --> 00:17:45,678
and this is asking for password three

412
00:17:43,520 --> 00:17:47,360
and i have entered the password that we

413
00:17:45,679 --> 00:17:49,370
have got earlier

414
00:17:47,360 --> 00:17:52,000
and we have got it so

415
00:17:49,370 --> 00:17:55,120
[Music]

416
00:17:52,000 --> 00:17:55,520
so we have got us the administrator of

417
00:17:55,120 --> 00:17:58,879
the

418
00:17:55,520 --> 00:18:01,440
system so this is happened only because

419
00:17:58,880 --> 00:18:03,200
the user our mouse is in local

420
00:18:01,440 --> 00:18:07,280
administrator in the client mission

421
00:18:03,200 --> 00:18:11,520
which is 192.168.0.178.

422
00:18:07,280 --> 00:18:14,720
so let's switch over to our presentation

423
00:18:11,520 --> 00:18:15,440
and yep this is the screenshot that i

424
00:18:14,720 --> 00:18:19,440
sold

425
00:18:15,440 --> 00:18:21,200
and the catch thing here is that it is

426
00:18:19,440 --> 00:18:24,000
nearly impossible to find this

427
00:18:21,200 --> 00:18:27,200
configuration on a real world engagement

428
00:18:24,000 --> 00:18:30,240
whereas uh when you

429
00:18:27,200 --> 00:18:30,720
find it you can find it over hack the

430
00:18:30,240 --> 00:18:33,760
box

431
00:18:30,720 --> 00:18:35,520
missions or active directory labs uh

432
00:18:33,760 --> 00:18:37,440
which would be helpful i guess

433
00:18:35,520 --> 00:18:38,559
it is one of the basic attack that you

434
00:18:37,440 --> 00:18:41,679
need to know

435
00:18:38,559 --> 00:18:45,760
uh when it comes to red team assessments

436
00:18:41,679 --> 00:18:46,640
so i have attached all the possible

437
00:18:45,760 --> 00:18:48,799
demos here

438
00:18:46,640 --> 00:18:50,480
i mean the attacks that i would be

439
00:18:48,799 --> 00:18:54,320
performing i have

440
00:18:50,480 --> 00:18:57,200
captured as a screen as a video and

441
00:18:54,320 --> 00:18:58,399
attached to my presentation here uh the

442
00:18:57,200 --> 00:19:00,480
thing is i am running

443
00:18:58,400 --> 00:19:02,080
three vms here i don't know when they

444
00:19:00,480 --> 00:19:05,039
would uh mess up

445
00:19:02,080 --> 00:19:05,918
so in order to be more safe i have added

446
00:19:05,039 --> 00:19:07,600
the videos here

447
00:19:05,919 --> 00:19:10,640
when i share my presentation hope you

448
00:19:07,600 --> 00:19:13,678
would check it out you can

449
00:19:10,640 --> 00:19:17,520
ask questions too so

450
00:19:13,679 --> 00:19:21,840
this is uh the screenshot where i have

451
00:19:17,520 --> 00:19:25,039
wireshark listening in my ethernet and

452
00:19:21,840 --> 00:19:28,799
firing the asrep roasting attack here

453
00:19:25,039 --> 00:19:32,000
so this is the request that is being

454
00:19:28,799 --> 00:19:35,039
gone to the kdc here so without

455
00:19:32,000 --> 00:19:37,360
entering the password the asrep

456
00:19:35,039 --> 00:19:38,799
response is generated and this is the

457
00:19:37,360 --> 00:19:41,360
tgt ticket

458
00:19:38,799 --> 00:19:42,160
and as i mentioned earlier this cannot

459
00:19:41,360 --> 00:19:45,039
be cracked

460
00:19:42,160 --> 00:19:46,160
uh since it's encrypted using krbtgt's

461
00:19:45,039 --> 00:19:49,440
account password

462
00:19:46,160 --> 00:19:52,880
and this is the session key which can be

463
00:19:49,440 --> 00:19:54,000
brute forced online and kindly make a

464
00:19:52,880 --> 00:19:56,330
note that

465
00:19:54,000 --> 00:19:57,840
this attack i mean

466
00:19:56,330 --> 00:20:01,039
[Music]

467
00:19:57,840 --> 00:20:04,080
this attack possibly retrieves different

468
00:20:01,039 --> 00:20:04,080
hashes whenever you

469
00:20:04,159 --> 00:20:09,520
try it out the thing here is that uh one

470
00:20:07,120 --> 00:20:13,360
of the key that is being encrypted is

471
00:20:09,520 --> 00:20:17,440
uh the current the timestamp

472
00:20:13,360 --> 00:20:17,840
so it's uh its nature that the hashes

473
00:20:17,440 --> 00:20:22,240
would

474
00:20:17,840 --> 00:20:23,120
vary so let's when pre-authentication is

475
00:20:22,240 --> 00:20:26,559
enabled

476
00:20:23,120 --> 00:20:28,559
uh the it throws an error like pre-auth

477
00:20:26,559 --> 00:20:29,280
is required from the kdc this is the

478
00:20:28,559 --> 00:20:32,799
error

479
00:20:29,280 --> 00:20:36,799
and this would be you seeing in

480
00:20:32,799 --> 00:20:38,720
when you run that in package script so

481
00:20:36,799 --> 00:20:40,480
these are some cool references hope you

482
00:20:38,720 --> 00:20:42,320
check it out

483
00:20:40,480 --> 00:20:44,880
let's now move on to the next attack

484
00:20:42,320 --> 00:20:47,520
which is uh careful roasting attack

485
00:20:44,880 --> 00:20:48,000
so kerprusting attack comes into play

486
00:20:47,520 --> 00:20:50,799
when you

487
00:20:48,000 --> 00:20:51,919
have uh certain credentials of the

488
00:20:50,799 --> 00:20:54,879
domain user

489
00:20:51,919 --> 00:20:55,760
so it basically what it does is hit

490
00:20:54,880 --> 00:20:58,960
harvest

491
00:20:55,760 --> 00:21:02,000
the password ashes of the account which

492
00:20:58,960 --> 00:21:05,360
has spn values or the service principle

493
00:21:02,000 --> 00:21:07,760
name values set in it so

494
00:21:05,360 --> 00:21:08,639
this misconfiguration usually takes

495
00:21:07,760 --> 00:21:11,200
place when an

496
00:21:08,640 --> 00:21:12,159
user account is configured as an service

497
00:21:11,200 --> 00:21:14,559
account

498
00:21:12,159 --> 00:21:16,240
through adding the spn values by the

499
00:21:14,559 --> 00:21:19,520
domain administrator

500
00:21:16,240 --> 00:21:21,840
so usually without

501
00:21:19,520 --> 00:21:23,120
generally what happens is that when an

502
00:21:21,840 --> 00:21:27,760
authenticated user

503
00:21:23,120 --> 00:21:31,678
in the dc request to access a service

504
00:21:27,760 --> 00:21:32,640
the tg sdk is generated by the kdc and

505
00:21:31,679 --> 00:21:36,240
given to him

506
00:21:32,640 --> 00:21:39,120
so this tg uh s ticket

507
00:21:36,240 --> 00:21:39,120
comes along with a

508
00:21:39,280 --> 00:21:44,080
t this tgs ticket is encrypted using the

509
00:21:42,880 --> 00:21:46,240
service accounts password

510
00:21:44,080 --> 00:21:47,918
and it comes along with the session key

511
00:21:46,240 --> 00:21:48,799
which is encrypted using the user's

512
00:21:47,919 --> 00:21:52,559
password

513
00:21:48,799 --> 00:21:56,240
so when this is configured by an

514
00:21:52,559 --> 00:21:58,720
administrator or by an person so

515
00:21:56,240 --> 00:22:01,039
the password for the service account is

516
00:21:58,720 --> 00:22:02,640
uh generally seem to be very weak and it

517
00:22:01,039 --> 00:22:03,600
can be brute force whereas when it's

518
00:22:02,640 --> 00:22:05,520
conflict with the

519
00:22:03,600 --> 00:22:07,280
domain controller itself it's hard to

520
00:22:05,520 --> 00:22:10,320
crack so

521
00:22:07,280 --> 00:22:14,480
that is catch here

522
00:22:10,320 --> 00:22:16,399
so this is the image that is

523
00:22:14,480 --> 00:22:17,520
where the misconfiguration is this is

524
00:22:16,400 --> 00:22:19,840
the user account

525
00:22:17,520 --> 00:22:20,879
sql service and this is the service

526
00:22:19,840 --> 00:22:22,959
principle name

527
00:22:20,880 --> 00:22:24,320
and this is the service that has been

528
00:22:22,960 --> 00:22:27,840
configured here

529
00:22:24,320 --> 00:22:31,918
so let's see the demo here

530
00:22:27,840 --> 00:22:31,918
so let's exit the shell

531
00:22:33,120 --> 00:22:36,639
again i will be using an impacted script

532
00:22:35,760 --> 00:22:41,440
which is get

533
00:22:36,640 --> 00:22:43,440
users np htb.lo i am specifying the

534
00:22:41,440 --> 00:22:48,000
domain name here

535
00:22:43,440 --> 00:22:51,120
i know that rasta mouse is the

536
00:22:48,000 --> 00:22:52,400
user name whose credential i have and he

537
00:22:51,120 --> 00:22:54,639
is a part of

538
00:22:52,400 --> 00:22:56,559
domain user i am specifying it the

539
00:22:54,640 --> 00:23:00,000
password explicitly

540
00:22:56,559 --> 00:23:04,240
and let me give the

541
00:23:00,000 --> 00:23:07,440
domain and controller's ip address again

542
00:23:04,240 --> 00:23:09,679
and i will be giving an extra thing

543
00:23:07,440 --> 00:23:11,919
called as target ip which is required to

544
00:23:09,679 --> 00:23:14,240
extract the service accounts

545
00:23:11,919 --> 00:23:14,240
hash

546
00:23:16,960 --> 00:23:19,919
102

547
00:23:20,880 --> 00:23:26,720
okay i guess it's not required

548
00:23:28,640 --> 00:23:36,000
yep so

549
00:23:31,679 --> 00:23:38,640
it uh this retrieves the spn values

550
00:23:36,000 --> 00:23:40,559
whose account has been set so we'll try

551
00:23:38,640 --> 00:23:43,760
to request the

552
00:23:40,559 --> 00:23:43,760
tgs ticket here

553
00:23:45,520 --> 00:23:55,200
okay i guess

554
00:23:50,559 --> 00:23:55,200
there is some issue with my time

555
00:23:56,559 --> 00:24:00,320
okay i expected this

556
00:24:03,120 --> 00:24:08,080
um let me just

557
00:24:08,960 --> 00:24:15,120
restart my vm here

558
00:24:12,320 --> 00:24:19,840
i have attached the video here so let's

559
00:24:15,120 --> 00:24:19,840
play it

560
00:24:26,000 --> 00:24:30,799
i said right something might go wrong

561
00:24:28,080 --> 00:24:30,799
this is the thing

562
00:24:30,840 --> 00:24:35,760
so

563
00:24:33,440 --> 00:24:35,760
yep

564
00:24:38,400 --> 00:24:46,720
yeah so this is the thing and this is a

565
00:24:43,279 --> 00:24:49,279
uh face we've added so

566
00:24:46,720 --> 00:24:50,080
let me just give this i am giving a

567
00:24:49,279 --> 00:24:52,640
command

568
00:24:50,080 --> 00:24:54,879
request and i am entering the password

569
00:24:52,640 --> 00:24:54,880
here

570
00:24:54,960 --> 00:25:00,080
in previous condition i didn't i didn't

571
00:24:58,080 --> 00:25:01,279
i i was not prompted to enter the

572
00:25:00,080 --> 00:25:04,480
password because

573
00:25:01,279 --> 00:25:07,679
uh i have explicitly mentioned it here

574
00:25:04,480 --> 00:25:08,480
so this didn't come so once this has

575
00:25:07,679 --> 00:25:12,000
been given

576
00:25:08,480 --> 00:25:14,320
the krbtgt has been generated

577
00:25:12,000 --> 00:25:15,279
the thing that was going wrong here is

578
00:25:14,320 --> 00:25:18,080
that

579
00:25:15,279 --> 00:25:20,799
uh the time difference between the

580
00:25:18,080 --> 00:25:24,000
domain controller and my kali mission is

581
00:25:20,799 --> 00:25:24,879
too high and the domain controllers

582
00:25:24,000 --> 00:25:28,400
thinks that

583
00:25:24,880 --> 00:25:30,400
it's in replay attack that's the thing

584
00:25:28,400 --> 00:25:31,600
probably if this issue is resolved i

585
00:25:30,400 --> 00:25:34,720
will try to

586
00:25:31,600 --> 00:25:37,439
show this demo let's

587
00:25:34,720 --> 00:25:37,440
go back here

588
00:25:38,000 --> 00:25:42,320
so this is the place where the

589
00:25:40,559 --> 00:25:45,600
misconfiguration is

590
00:25:42,320 --> 00:25:47,918
happened services window

591
00:25:45,600 --> 00:25:48,959
this is the place windows services and

592
00:25:47,919 --> 00:25:52,320
uh

593
00:25:48,960 --> 00:25:53,360
sql service has an authentication or the

594
00:25:52,320 --> 00:25:57,279
logon of

595
00:25:53,360 --> 00:25:59,678
the domain user sql svc hdb.local

596
00:25:57,279 --> 00:26:00,960
and the password has been given here so

597
00:25:59,679 --> 00:26:04,559
this service

598
00:26:00,960 --> 00:26:06,159
uses the domain users account so

599
00:26:04,559 --> 00:26:08,000
this is the reason we were able to get

600
00:26:06,159 --> 00:26:11,120
the tgs

601
00:26:08,000 --> 00:26:13,679
ticket so

602
00:26:11,120 --> 00:26:15,439
this would be the basic flow uh again

603
00:26:13,679 --> 00:26:18,799
the wire start flow here

604
00:26:15,440 --> 00:26:22,240
and uh this is the tgs

605
00:26:18,799 --> 00:26:24,000
response tgs ticket and uh

606
00:26:22,240 --> 00:26:25,600
hope you could see it here the hashes

607
00:26:24,000 --> 00:26:27,919
start with the same thing

608
00:26:25,600 --> 00:26:28,959
and this is the session key new session

609
00:26:27,919 --> 00:26:33,360
key and

610
00:26:28,960 --> 00:26:37,279
uh we don't need to bother it i guess so

611
00:26:33,360 --> 00:26:39,840
let's uh these are some references

612
00:26:37,279 --> 00:26:43,440
let's try to file the command again i

613
00:26:39,840 --> 00:26:43,439
guess there won't be any issue now

614
00:26:46,159 --> 00:26:49,760
okay the time has changed

615
00:26:50,840 --> 00:26:55,678
yep

616
00:26:53,760 --> 00:26:57,919
i guess i won't be able to use my kali

617
00:26:55,679 --> 00:27:00,799
machine here at the time

618
00:26:57,919 --> 00:27:00,799
okay it's look good

619
00:27:04,840 --> 00:27:07,840
okay

620
00:27:18,960 --> 00:27:24,480
i am specifying the password here itself

621
00:27:21,120 --> 00:27:24,479
so that i don't get a prompt

622
00:27:30,799 --> 00:27:35,840
um yep

623
00:27:46,840 --> 00:27:49,840
okay

624
00:27:50,240 --> 00:27:54,000
oh lol i don't know what's this thing is

625
00:27:52,960 --> 00:27:55,520
happening

626
00:27:54,000 --> 00:27:57,279
yeah i have retrieved the hash

627
00:27:55,520 --> 00:28:00,879
successfully here so

628
00:27:57,279 --> 00:28:04,399
let's copy this and let's crack it here

629
00:28:00,880 --> 00:28:04,399
i haven't copied it completely

630
00:28:14,840 --> 00:28:22,000
so

631
00:28:17,360 --> 00:28:22,000
again let's see the module

632
00:28:23,440 --> 00:28:30,480
which we would use in cracking the hash

633
00:28:27,039 --> 00:28:33,840
so this is an tgs response and

634
00:28:30,480 --> 00:28:37,120
we are going to crack tgt a tgs ticket

635
00:28:33,840 --> 00:28:40,639
so let's see so i guess this would be

636
00:28:37,120 --> 00:28:40,639
the module that we'll be using

637
00:28:43,799 --> 00:28:50,320
1300 i guess

638
00:28:46,880 --> 00:28:50,320
and as

639
00:28:50,559 --> 00:28:54,690
this is the password

640
00:28:51,600 --> 00:28:54,689
[Music]

641
00:28:56,320 --> 00:29:00,879
oh again i will be using wordlist

642
00:29:01,600 --> 00:29:07,520
raw queue here and uh

643
00:29:05,120 --> 00:29:08,639
the note i need to mention here is that

644
00:29:07,520 --> 00:29:11,279
uh usually

645
00:29:08,640 --> 00:29:14,559
all the service accounts would be a past

646
00:29:11,279 --> 00:29:17,279
part of domain admin

647
00:29:14,559 --> 00:29:18,240
it's the most common scenario where

648
00:29:17,279 --> 00:29:20,880
server account

649
00:29:18,240 --> 00:29:22,960
has and domain administrator privilege

650
00:29:20,880 --> 00:29:26,080
so that they can access

651
00:29:22,960 --> 00:29:28,799
all the uh things uh

652
00:29:26,080 --> 00:29:30,320
in the service so that's the thing here

653
00:29:28,799 --> 00:29:31,600
so we have retrieved the hash

654
00:29:30,320 --> 00:29:35,600
successfully now

655
00:29:31,600 --> 00:29:39,520
so let's move on to the next attack

656
00:29:35,600 --> 00:29:42,639
so this is and called as dc sync attack

657
00:29:39,520 --> 00:29:44,000
so dc sync attack is probably the last

658
00:29:42,640 --> 00:29:45,520
part of the engagement or

659
00:29:44,000 --> 00:29:47,120
last part of privilege escalation

660
00:29:45,520 --> 00:29:50,000
usually so

661
00:29:47,120 --> 00:29:50,959
when you have the domain administrator

662
00:29:50,000 --> 00:29:54,000
credentials

663
00:29:50,960 --> 00:29:57,120
or and user credential who is part of

664
00:29:54,000 --> 00:29:59,279
the domain admin or the enterprise admin

665
00:29:57,120 --> 00:30:00,719
then you would have an access or

666
00:29:59,279 --> 00:30:03,440
permission

667
00:30:00,720 --> 00:30:04,240
which is replicating changes directory

668
00:30:03,440 --> 00:30:07,440
changes all

669
00:30:04,240 --> 00:30:10,640
or replicating directory changes so this

670
00:30:07,440 --> 00:30:11,279
attack basically is a credential dumping

671
00:30:10,640 --> 00:30:14,240
attack

672
00:30:11,279 --> 00:30:16,399
which stimulates the behavior of

673
00:30:14,240 --> 00:30:19,520
replication of domain controller

674
00:30:16,399 --> 00:30:22,559
and this what

675
00:30:19,520 --> 00:30:26,000
the attack flow would be this

676
00:30:22,559 --> 00:30:27,600
compromise and attack which has a

677
00:30:26,000 --> 00:30:29,360
compromision account which has a

678
00:30:27,600 --> 00:30:31,279
permission of

679
00:30:29,360 --> 00:30:33,279
replicating directory changes all or

680
00:30:31,279 --> 00:30:35,840
replicating directory changes

681
00:30:33,279 --> 00:30:38,240
and request the domain controller for

682
00:30:35,840 --> 00:30:40,799
replication via get nc changes

683
00:30:38,240 --> 00:30:42,640
and the domain controller responds with

684
00:30:40,799 --> 00:30:44,879
the replication process

685
00:30:42,640 --> 00:30:46,640
after verifying the request and the

686
00:30:44,880 --> 00:30:49,679
credentials are being dumped

687
00:30:46,640 --> 00:30:53,120
so i will be using secrets.dumb

688
00:30:49,679 --> 00:30:55,200
secrets dumpster py so

689
00:30:53,120 --> 00:30:56,239
when the replication process is

690
00:30:55,200 --> 00:30:59,440
initiated

691
00:30:56,240 --> 00:31:02,080
uh the secrets dumps only request

692
00:30:59,440 --> 00:31:03,120
for the files or the credential which is

693
00:31:02,080 --> 00:31:06,480
present in

694
00:31:03,120 --> 00:31:08,239
and the

695
00:31:06,480 --> 00:31:10,559
which is present in the credential

696
00:31:08,240 --> 00:31:14,399
database which is ntts

697
00:31:10,559 --> 00:31:18,240
dot dit file so all the same database

698
00:31:14,399 --> 00:31:21,518
so let's move on to the demo now

699
00:31:18,240 --> 00:31:23,679
so i will be using secrets dump

700
00:31:21,519 --> 00:31:23,679
and

701
00:31:28,480 --> 00:31:35,039
see at http

702
00:31:32,320 --> 00:31:35,039
okay let me

703
00:31:41,039 --> 00:31:44,240
i guess i would be prompted to enter the

704
00:31:42,799 --> 00:31:47,200
password

705
00:31:44,240 --> 00:31:47,600
okay name i need to mention target ip

706
00:31:47,200 --> 00:31:52,799
here

707
00:31:47,600 --> 00:31:52,799
since i'm using service account

708
00:31:58,840 --> 00:32:20,720
okay okay

709
00:32:14,640 --> 00:32:20,720
yep this hash usually happens here

710
00:32:21,120 --> 00:32:26,080
so we are able to dump the ntlm ashes

711
00:32:24,480 --> 00:32:27,200
for all the accounts present in the

712
00:32:26,080 --> 00:32:30,639
domain controller

713
00:32:27,200 --> 00:32:33,679
this includes the domain admins

714
00:32:30,640 --> 00:32:36,960
uh the computer accounts

715
00:32:33,679 --> 00:32:40,960
we are able to dump the accounts like

716
00:32:36,960 --> 00:32:44,320
uh our rashta mouse ntlms

717
00:32:40,960 --> 00:32:46,720
sql service ntlms uh we also retrieve

718
00:32:44,320 --> 00:32:50,000
the krb tgt accounts password

719
00:32:46,720 --> 00:32:53,840
ntlms uh let me just copy

720
00:32:50,000 --> 00:32:56,000
and and

721
00:32:53,840 --> 00:32:56,959
note the entire mass of user

722
00:32:56,000 --> 00:33:00,159
administrator

723
00:32:56,960 --> 00:33:03,440
and krbtgt

724
00:33:00,159 --> 00:33:11,840
which i would be later using it in

725
00:33:03,440 --> 00:33:11,840
generating golden and silver ticket

726
00:33:17,919 --> 00:33:21,440
let me just cross verify it

727
00:33:22,840 --> 00:33:29,760
yep

728
00:33:25,600 --> 00:33:33,199
okay so this is all about dc sync attack

729
00:33:29,760 --> 00:33:37,039
uh let's move on to my presentation here

730
00:33:33,200 --> 00:33:39,039
so this is the thing yep

731
00:33:37,039 --> 00:33:40,240
uh here are the references hope you

732
00:33:39,039 --> 00:33:43,039
check it out

733
00:33:40,240 --> 00:33:44,159
so now let's move on to and similar

734
00:33:43,039 --> 00:33:47,519
attack which is

735
00:33:44,159 --> 00:33:49,600
uh dehe shadow attack when it comes to

736
00:33:47,519 --> 00:33:50,080
dc shadow attack the key difference

737
00:33:49,600 --> 00:33:53,760
between

738
00:33:50,080 --> 00:33:56,960
dc zinc and dc shadow is that dc sync

739
00:33:53,760 --> 00:33:59,120
only dumps the credentials of the

740
00:33:56,960 --> 00:34:00,000
computer and the user account present in

741
00:33:59,120 --> 00:34:02,158
the domain

742
00:34:00,000 --> 00:34:04,399
or the domain controller when i come to

743
00:34:02,159 --> 00:34:07,360
dc shadow attack

744
00:34:04,399 --> 00:34:08,078
this would be able to modify the objects

745
00:34:07,360 --> 00:34:10,719
and the

746
00:34:08,079 --> 00:34:11,359
attributes of the object of the domain

747
00:34:10,719 --> 00:34:14,638
controller

748
00:34:11,359 --> 00:34:18,000
we are same replication uh we are

749
00:34:14,639 --> 00:34:20,800
leveraging the replication process so

750
00:34:18,000 --> 00:34:22,879
dc shadow attack basically basically

751
00:34:20,800 --> 00:34:26,720
sets a rogue domain controller

752
00:34:22,879 --> 00:34:28,719
on the network and it pushes the changes

753
00:34:26,719 --> 00:34:31,040
to the original domain controller

754
00:34:28,719 --> 00:34:31,918
so you would make changes to the

755
00:34:31,040 --> 00:34:33,759
original

756
00:34:31,918 --> 00:34:35,440
domain controller via the rogue domain

757
00:34:33,760 --> 00:34:40,800
controller that you have set up

758
00:34:35,440 --> 00:34:44,000
so let's see the process flow here

759
00:34:40,800 --> 00:34:46,079
so first thing you need to have the

760
00:34:44,000 --> 00:34:48,239
there are two requirements here one is

761
00:34:46,079 --> 00:34:49,440
the credentials of an user who is a part

762
00:34:48,239 --> 00:34:51,839
of domain admin

763
00:34:49,440 --> 00:34:52,720
and another one is a system privilege

764
00:34:51,839 --> 00:34:55,918
access

765
00:34:52,719 --> 00:34:57,359
to one of the machine in present in the

766
00:34:55,918 --> 00:35:00,720
ada environment

767
00:34:57,359 --> 00:35:03,040
and i would be using mimikatz to perform

768
00:35:00,720 --> 00:35:06,720
this attack uh

769
00:35:03,040 --> 00:35:08,400
you can uh upload the mimikats on the

770
00:35:06,720 --> 00:35:10,799
machine and start maybe catch with

771
00:35:08,400 --> 00:35:13,359
administrator privilege on two shells

772
00:35:10,800 --> 00:35:15,359
uh one is for creating the rogue domain

773
00:35:13,359 --> 00:35:16,000
controller and setting up the changes in

774
00:35:15,359 --> 00:35:19,359
it

775
00:35:16,000 --> 00:35:21,839
and another one is for pushing this

776
00:35:19,359 --> 00:35:24,400
changes to the original domain control

777
00:35:21,839 --> 00:35:26,240
controller i have been the commands here

778
00:35:24,400 --> 00:35:29,680
and this is the demo file

779
00:35:26,240 --> 00:35:31,279
hope you check it out so let's now move

780
00:35:29,680 --> 00:35:34,078
on to my client mission

781
00:35:31,280 --> 00:35:35,680
so this is the client mission and uh let

782
00:35:34,079 --> 00:35:38,960
me just

783
00:35:35,680 --> 00:35:38,960
power cmt

784
00:35:40,960 --> 00:35:44,160
so i have logged in as bowman who is a

785
00:35:43,359 --> 00:35:47,920
part of

786
00:35:44,160 --> 00:35:47,920
domain admin and

787
00:35:48,480 --> 00:35:55,359
so this is the s id of bowen

788
00:35:52,000 --> 00:35:58,720
so let's now fire

789
00:35:55,359 --> 00:36:02,640
up the mimikaz thing here so of course

790
00:35:58,720 --> 00:36:04,480
uh in uh in an engagement on an

791
00:36:02,640 --> 00:36:06,640
thing what you would do is you would

792
00:36:04,480 --> 00:36:10,000
compromise the client and you would use

793
00:36:06,640 --> 00:36:13,440
any uh script like a tool like

794
00:36:10,000 --> 00:36:17,040
evil venaram or smb exec or ps exec

795
00:36:13,440 --> 00:36:19,119
here so let let me run this as an

796
00:36:17,040 --> 00:36:22,079
administrator

797
00:36:19,119 --> 00:36:22,079
i will also have

798
00:36:22,720 --> 00:36:27,839
another shell here so

799
00:36:27,920 --> 00:36:34,240
let's check whether the pros uh

800
00:36:31,440 --> 00:36:34,640
the dll files are imported here uh we

801
00:36:34,240 --> 00:36:36,959
have

802
00:36:34,640 --> 00:36:39,040
the drivers imported successfully let's

803
00:36:36,960 --> 00:36:42,640
also check whether the

804
00:36:39,040 --> 00:36:46,720
token is as system so

805
00:36:42,640 --> 00:36:49,279
yep so let's

806
00:36:46,720 --> 00:36:50,959
generate the rogue domain controller

807
00:36:49,280 --> 00:36:55,680
here

808
00:36:50,960 --> 00:37:00,640
so the object that i would be

809
00:36:55,680 --> 00:37:00,640
changing here is raster mouse and

810
00:37:00,960 --> 00:37:06,320
the attribute i would be changing here

811
00:37:04,160 --> 00:37:06,319
is

812
00:37:06,839 --> 00:37:09,839
description

813
00:37:15,520 --> 00:37:23,839
and the value here would be v sites

814
00:37:19,359 --> 00:37:23,839
i need to give it in quotes

815
00:37:26,720 --> 00:37:33,439
so that's it let's fire it up

816
00:37:29,760 --> 00:37:35,680
yep so we have created it

817
00:37:33,440 --> 00:37:37,040
so this is waiting for the push command

818
00:37:35,680 --> 00:37:40,160
that we need to give it

819
00:37:37,040 --> 00:37:41,520
so before uh we need to uh as i said

820
00:37:40,160 --> 00:37:44,319
earlier we need to

821
00:37:41,520 --> 00:37:44,880
have an uh domain admin access here

822
00:37:44,320 --> 00:37:47,760
right

823
00:37:44,880 --> 00:37:48,320
so we need to uh impersonate the token

824
00:37:47,760 --> 00:37:51,839
here

825
00:37:48,320 --> 00:37:51,839
so what we'll do is we'll

826
00:37:52,400 --> 00:37:56,480
do that imagination first

827
00:37:59,040 --> 00:38:06,960
yep so i would be using s key

828
00:38:03,119 --> 00:38:06,960
you are say module here

829
00:38:09,760 --> 00:38:17,200
and i would be impersonating as

830
00:38:13,680 --> 00:38:19,919
administrator in order to

831
00:38:17,200 --> 00:38:20,919
not to take any chance and the domain

832
00:38:19,920 --> 00:38:25,359
here is

833
00:38:20,920 --> 00:38:30,880
hdb.local and the ntlm hash for

834
00:38:25,359 --> 00:38:30,880
administrator is i have copied it

835
00:38:31,599 --> 00:38:38,880
and let me paste it and

836
00:38:35,359 --> 00:38:38,880
we are going to impersonate it

837
00:38:43,280 --> 00:38:50,240
okay i have misspelled it

838
00:38:46,480 --> 00:38:50,240
i have added an extras here

839
00:38:52,240 --> 00:38:54,479
oh

840
00:38:55,520 --> 00:39:00,560
lol okay so

841
00:38:58,880 --> 00:39:02,079
the token impersonation has been

842
00:39:00,560 --> 00:39:05,759
successful i guess

843
00:39:02,079 --> 00:39:09,119
let's see so by firing the command to

844
00:39:05,760 --> 00:39:13,119
a token who am i so hope yup

845
00:39:09,119 --> 00:39:15,839
so we'll now

846
00:39:13,119 --> 00:39:15,839
do the

847
00:39:20,240 --> 00:39:26,240
oh sure yeah this has been reflected i

848
00:39:24,400 --> 00:39:29,920
guess let's go to the domain controller

849
00:39:26,240 --> 00:39:33,040
and see it so

850
00:39:29,920 --> 00:39:36,880
yeah this is the thing so

851
00:39:33,040 --> 00:39:38,480
the key difference is that the dc shadow

852
00:39:36,880 --> 00:39:41,920
attack allows you to

853
00:39:38,480 --> 00:39:44,480
uh modify the domain objects

854
00:39:41,920 --> 00:39:46,000
and the attributes of the domain objects

855
00:39:44,480 --> 00:39:47,359
which would be helpful in making

856
00:39:46,000 --> 00:39:50,720
persistent connection

857
00:39:47,359 --> 00:39:51,680
or setting up an backdoor to your c2

858
00:39:50,720 --> 00:39:55,359
framework

859
00:39:51,680 --> 00:39:58,879
so this is the image and

860
00:39:55,359 --> 00:40:02,160
yep okay these are some rough

861
00:39:58,880 --> 00:40:05,680
references let's now move on to

862
00:40:02,160 --> 00:40:06,960
golden ticket so golden ticket attack is

863
00:40:05,680 --> 00:40:10,078
basically

864
00:40:06,960 --> 00:40:12,880
uh is as the name it it

865
00:40:10,079 --> 00:40:15,040
provides you complete and in uh

866
00:40:12,880 --> 00:40:18,079
unlimited access over the domain

867
00:40:15,040 --> 00:40:19,200
controller an attacker who has the

868
00:40:18,079 --> 00:40:22,160
attacker who has a

869
00:40:19,200 --> 00:40:24,960
credentials of krbtgt account or the

870
00:40:22,160 --> 00:40:28,000
ntlms of krbtgt account

871
00:40:24,960 --> 00:40:31,359
can frame the tgt ticket and access

872
00:40:28,000 --> 00:40:34,400
any service in the ad so

873
00:40:31,359 --> 00:40:36,960
using the

874
00:40:34,400 --> 00:40:38,240
possible ways of exploiting this is

875
00:40:36,960 --> 00:40:41,119
issuing tickets for

876
00:40:38,240 --> 00:40:41,598
users that don't exist adding users to

877
00:40:41,119 --> 00:40:43,920
the

878
00:40:41,599 --> 00:40:45,920
uh adding users to grow hope in which

879
00:40:43,920 --> 00:40:47,200
they don't belong or issuing tickets

880
00:40:45,920 --> 00:40:51,119
with the lifetime

881
00:40:47,200 --> 00:40:53,759
uh access or i mean uh the expiry

882
00:40:51,119 --> 00:40:55,040
expert time of tgt ticket can be set to

883
00:40:53,760 --> 00:40:57,839
10 years or so

884
00:40:55,040 --> 00:40:58,720
so the requirements in order to perform

885
00:40:57,839 --> 00:41:01,960
this attack

886
00:40:58,720 --> 00:41:03,520
are domain name domain sid and the

887
00:41:01,960 --> 00:41:05,839
krbtgt accounts

888
00:41:03,520 --> 00:41:07,440
ntla mash and the user that you are

889
00:41:05,839 --> 00:41:12,400
going to impersonate

890
00:41:07,440 --> 00:41:12,400
so again i will be using my client here

891
00:41:13,520 --> 00:41:16,880
so let's close this

892
00:41:18,240 --> 00:41:22,640
let's fire it up again i will be running

893
00:41:20,640 --> 00:41:25,920
it as administrator

894
00:41:22,640 --> 00:41:29,118
so we need the domains sid here right

895
00:41:25,920 --> 00:41:30,160
so this is the s id of users account one

896
00:41:29,119 --> 00:41:33,760
of its part

897
00:41:30,160 --> 00:41:34,720
that is uh till this this is the s id of

898
00:41:33,760 --> 00:41:37,280
domain

899
00:41:34,720 --> 00:41:38,078
and this is the rid of the user account

900
00:41:37,280 --> 00:41:43,200
bowen

901
00:41:38,079 --> 00:41:46,839
so what we'll do is we'll

902
00:41:43,200 --> 00:41:51,359
use kerberos module here

903
00:41:46,839 --> 00:41:51,880
golden and we are going to impersonate

904
00:41:51,359 --> 00:41:54,880
our

905
00:41:51,880 --> 00:41:54,880
administrator

906
00:41:56,079 --> 00:42:03,440
and will be

907
00:41:59,200 --> 00:42:07,359
using the domain htv hdb.local

908
00:42:03,440 --> 00:42:07,359
and the sid is

909
00:42:11,839 --> 00:42:17,839
and krv

910
00:42:15,119 --> 00:42:17,839
tgt

911
00:42:19,760 --> 00:42:23,839
i have captured the hash here so

912
00:42:28,000 --> 00:42:31,599
i will be generating a token with

913
00:42:30,240 --> 00:42:35,359
administrator privilege

914
00:42:31,599 --> 00:42:39,359
which comes with id 500 right so

915
00:42:35,359 --> 00:42:42,319
let's yeah the ticket is saved here so

916
00:42:39,359 --> 00:42:42,319
this is the ticket

917
00:42:43,520 --> 00:42:46,000
and

918
00:42:49,200 --> 00:42:54,480
we'll use this so in order to use this

919
00:42:53,520 --> 00:42:57,359
you need to

920
00:42:54,480 --> 00:42:58,000
import it so i will be importing it

921
00:42:57,359 --> 00:43:00,640
using

922
00:42:58,000 --> 00:43:00,640
this command

923
00:43:01,359 --> 00:43:08,960
okay so let's fire up

924
00:43:05,359 --> 00:43:12,240
command from from this so this is the

925
00:43:08,960 --> 00:43:13,440
i guess the token uh the ticket has been

926
00:43:12,240 --> 00:43:16,160
imported i guess

927
00:43:13,440 --> 00:43:17,200
so let's list the tickets that are

928
00:43:16,160 --> 00:43:20,720
present in this

929
00:43:17,200 --> 00:43:24,879
uh domain so yeah we have

930
00:43:20,720 --> 00:43:28,879
administrator here so let's try to

931
00:43:24,880 --> 00:43:33,440
do an attack where the administrator has

932
00:43:28,880 --> 00:43:35,760
privilege so i will be trying to

933
00:43:33,440 --> 00:43:36,560
load the c directory of domain

934
00:43:35,760 --> 00:43:38,800
controller

935
00:43:36,560 --> 00:43:40,880
to this client mission as a shared

936
00:43:38,800 --> 00:43:54,400
folder here

937
00:43:40,880 --> 00:43:59,520
let's give i and

938
00:43:54,400 --> 00:44:01,440
so this is the thing here

939
00:43:59,520 --> 00:44:04,240
i guess command has been successful

940
00:44:01,440 --> 00:44:07,680
let's try to list it out

941
00:44:04,240 --> 00:44:10,799
so these are the directories of

942
00:44:07,680 --> 00:44:14,000
c drive in my domain controller

943
00:44:10,800 --> 00:44:17,599
so this is the thing uh

944
00:44:14,000 --> 00:44:17,599
so let's now move on to

945
00:44:18,319 --> 00:44:24,560
yeah i have captured the demo here so

946
00:44:22,000 --> 00:44:26,880
i guess we lag behind the time so let's

947
00:44:24,560 --> 00:44:29,200
quickly see what a silver ticket attack

948
00:44:26,880 --> 00:44:30,079
silver ticket attack is similar to

949
00:44:29,200 --> 00:44:32,720
golden ticket

950
00:44:30,079 --> 00:44:34,960
the key difference is that uh golden

951
00:44:32,720 --> 00:44:36,399
ticket provides you an unlimited access

952
00:44:34,960 --> 00:44:38,480
whereas a silver ticket

953
00:44:36,400 --> 00:44:40,000
provides you an access to specific

954
00:44:38,480 --> 00:44:43,359
services

955
00:44:40,000 --> 00:44:45,280
once you have compromised the

956
00:44:43,359 --> 00:44:47,359
password for and service account or the

957
00:44:45,280 --> 00:44:49,440
password has for the service account

958
00:44:47,359 --> 00:44:50,880
you would be able to generate tgs

959
00:44:49,440 --> 00:44:53,440
tickets uh

960
00:44:50,880 --> 00:44:54,000
for every of our any users present to

961
00:44:53,440 --> 00:44:56,960
the domain

962
00:44:54,000 --> 00:44:58,240
in order to access the service so its

963
00:44:56,960 --> 00:45:00,640
scope is limited

964
00:44:58,240 --> 00:45:02,560
but it is very stealth and easily

965
00:45:00,640 --> 00:45:05,040
achievable than golden ticket

966
00:45:02,560 --> 00:45:05,599
the requirements of to perform this

967
00:45:05,040 --> 00:45:09,119
attack

968
00:45:05,599 --> 00:45:09,839
is sid of the user you are trying to

969
00:45:09,119 --> 00:45:13,280
generate

970
00:45:09,839 --> 00:45:16,560
and the domain name the target service

971
00:45:13,280 --> 00:45:18,800
and the username and the ntlr mesh for

972
00:45:16,560 --> 00:45:22,160
the service account so

973
00:45:18,800 --> 00:45:23,440
let's go here i will just kill all the

974
00:45:22,160 --> 00:45:26,480
care bros

975
00:45:23,440 --> 00:45:29,280
list here i have kls

976
00:45:26,480 --> 00:45:30,640
purge would do it i have deleted all the

977
00:45:29,280 --> 00:45:33,760
kerberos tickets here

978
00:45:30,640 --> 00:45:36,799
so let's try to generate the

979
00:45:33,760 --> 00:45:36,800
silver ticket here

980
00:45:36,960 --> 00:45:40,160
i would be using the golden module

981
00:45:39,119 --> 00:45:42,960
itself but

982
00:45:40,160 --> 00:45:43,839
instead of specifying the sid of entire

983
00:45:42,960 --> 00:45:46,640
domain

984
00:45:43,839 --> 00:45:49,520
i would specify the entire sid of the

985
00:45:46,640 --> 00:45:52,319
user and i would specify

986
00:45:49,520 --> 00:45:53,280
the accounts password along with service

987
00:45:52,319 --> 00:45:56,400
name and

988
00:45:53,280 --> 00:46:01,520
the target here so

989
00:45:56,400 --> 00:46:06,400
let's provide the s id here

990
00:46:01,520 --> 00:46:06,400
i guess i have the sid here yep

991
00:46:11,680 --> 00:46:20,000
the domain is htv dot local

992
00:46:15,760 --> 00:46:24,319
or the user is bowen

993
00:46:20,000 --> 00:46:24,960
so uh bowen stands for brad owen which

994
00:46:24,319 --> 00:46:28,400
is the first

995
00:46:24,960 --> 00:46:31,760
uh i have took the initial

996
00:46:28,400 --> 00:46:32,800
letter of first name and the complete

997
00:46:31,760 --> 00:46:34,880
name of last

998
00:46:32,800 --> 00:46:36,160
so this is usually the naming convention

999
00:46:34,880 --> 00:46:38,880
present in your

1000
00:46:36,160 --> 00:46:40,839
uh ad i mean when it comes to active

1001
00:46:38,880 --> 00:46:42,960
directory

1002
00:46:40,839 --> 00:46:48,000
so

1003
00:46:42,960 --> 00:46:48,000
let's provide the target here which is

1004
00:46:54,839 --> 00:46:59,440
and let's provide the service

1005
00:46:59,839 --> 00:47:03,759
here let's also provide

1006
00:47:04,720 --> 00:47:10,319
the password hash so

1007
00:47:07,920 --> 00:47:11,119
since the password has is same for all

1008
00:47:10,319 --> 00:47:13,040
the

1009
00:47:11,119 --> 00:47:16,160
things which is password attend one two

1010
00:47:13,040 --> 00:47:19,680
three uh the password hash wouldn't vary

1011
00:47:16,160 --> 00:47:22,000
so let's yep

1012
00:47:19,680 --> 00:47:26,000
the ticket has been saved i guess let's

1013
00:47:22,000 --> 00:47:30,880
import it again using kerberos vdt

1014
00:47:26,000 --> 00:47:30,880
and oh i haven't to specify the file

1015
00:47:36,400 --> 00:47:40,720
i have imported it successfully let's

1016
00:47:38,640 --> 00:47:43,920
run command here

1017
00:47:40,720 --> 00:47:47,680
so let's list the things

1018
00:47:43,920 --> 00:47:51,280
so i have yeah hope you could see that

1019
00:47:47,680 --> 00:47:55,919
the service ticket i have got it for

1020
00:47:51,280 --> 00:47:58,640
sql svc so this is it

1021
00:47:55,920 --> 00:48:00,880
and this is the image screenshot the

1022
00:47:58,640 --> 00:48:04,640
references

1023
00:48:00,880 --> 00:48:10,319
uh yeah this is it

1024
00:48:04,640 --> 00:48:10,319
thank you let me stop presenting my skin

1025
00:48:12,400 --> 00:48:15,680
thank you very much finn countryman you

1026
00:48:14,400 --> 00:48:18,960
bought that in

1027
00:48:15,680 --> 00:48:19,680
just in time during extended putt play

1028
00:48:18,960 --> 00:48:22,000
as well so

1029
00:48:19,680 --> 00:48:24,240
just in time uh looks like you didn't

1030
00:48:22,000 --> 00:48:24,960
pray to the demo gods quite so hard as

1031
00:48:24,240 --> 00:48:28,319
uh as you

1032
00:48:24,960 --> 00:48:30,880
needed to but yeah i guess the

1033
00:48:28,319 --> 00:48:31,839
timing got screwed up uh so i had to

1034
00:48:30,880 --> 00:48:34,960
restart my

1035
00:48:31,839 --> 00:48:39,279
attacker mission here so things mess up

1036
00:48:34,960 --> 00:48:39,280
ah it's not a reason if it is uh

1037
00:48:39,680 --> 00:48:43,598
yeah thank you for understanding no but

1038
00:48:41,920 --> 00:48:46,839
no no thank you very much

1039
00:48:43,599 --> 00:48:49,839
indeed and in the absence of a real

1040
00:48:46,839 --> 00:48:49,839
applause

