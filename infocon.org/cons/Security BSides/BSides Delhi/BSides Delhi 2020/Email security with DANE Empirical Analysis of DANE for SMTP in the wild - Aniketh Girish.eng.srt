1
00:00:03,439 --> 00:00:07,359
next

2
00:00:04,080 --> 00:00:07,680
up uh we will probably move straight on

3
00:00:07,359 --> 00:00:10,000
where

4
00:00:07,680 --> 00:00:11,519
we've got less than two minutes uh until

5
00:00:10,000 --> 00:00:13,519
the scheduled time

6
00:00:11,519 --> 00:00:14,960
uh in fact we're definitely moving on it

7
00:00:13,519 --> 00:00:18,320
seems so hello

8
00:00:14,960 --> 00:00:21,359
uh aniketh how are you hi hi tom i'm

9
00:00:18,320 --> 00:00:22,720
boeing how are you yes very good thank

10
00:00:21,359 --> 00:00:25,519
you very good

11
00:00:22,720 --> 00:00:27,279
um so first b-sides or have you been to

12
00:00:25,519 --> 00:00:30,159
all of them so far

13
00:00:27,279 --> 00:00:31,519
this is my first besides excellent

14
00:00:30,160 --> 00:00:32,640
excellent and where where do you

15
00:00:31,519 --> 00:00:35,600
where do you come from at the moment

16
00:00:32,640 --> 00:00:38,000
what what what is it that you do

17
00:00:35,600 --> 00:00:39,280
so i'm from kerala the southern part of

18
00:00:38,000 --> 00:00:41,600
india

19
00:00:39,280 --> 00:00:42,559
and i just recently finished my

20
00:00:41,600 --> 00:00:46,399
bachelor's

21
00:00:42,559 --> 00:00:47,199
from amrita and i'm i'm going to do my

22
00:00:46,399 --> 00:00:49,039
phd in

23
00:00:47,200 --> 00:00:50,800
india networks institute and the

24
00:00:49,039 --> 00:00:54,160
university of carlos ceremony

25
00:00:50,800 --> 00:00:55,839
in spain brilliant

26
00:00:54,160 --> 00:00:57,519
like i said yesterday all these young

27
00:00:55,840 --> 00:01:00,719
people who are just

28
00:00:57,520 --> 00:01:02,239
putting me to shame where i just i i

29
00:01:00,719 --> 00:01:03,760
you know partied my way through

30
00:01:02,239 --> 00:01:05,280
university and here you are doing

31
00:01:03,760 --> 00:01:08,000
presentations

32
00:01:05,280 --> 00:01:10,000
um you know presentations and doctorates

33
00:01:08,000 --> 00:01:12,479
and all that sort of thing so i'm i'm

34
00:01:10,000 --> 00:01:13,439
very impressed and slightly ashamed but

35
00:01:12,479 --> 00:01:16,240
there you go

36
00:01:13,439 --> 00:01:18,158
um annika what are you what are you uh

37
00:01:16,240 --> 00:01:21,039
talking about today

38
00:01:18,159 --> 00:01:22,080
so uh today i'll be speaking about email

39
00:01:21,040 --> 00:01:24,960
security

40
00:01:22,080 --> 00:01:27,439
and uh how uh there is a different

41
00:01:24,960 --> 00:01:30,559
protocol called day which has been

42
00:01:27,439 --> 00:01:33,360
recently deployed and standardized so

43
00:01:30,560 --> 00:01:36,560
how that comes into email security and

44
00:01:33,360 --> 00:01:37,680
how that active reverse and helps us to

45
00:01:36,560 --> 00:01:41,280
improve our

46
00:01:37,680 --> 00:01:43,920
security scenario with email and as

47
00:01:41,280 --> 00:01:45,439
as that's said this is an academic

48
00:01:43,920 --> 00:01:46,159
research as well which has been

49
00:01:45,439 --> 00:01:49,439
published

50
00:01:46,159 --> 00:01:52,960
in uh using security so

51
00:01:49,439 --> 00:01:54,000
we also did a longitudinal uh analysis

52
00:01:52,960 --> 00:01:57,039
of how the daying for

53
00:01:54,000 --> 00:01:58,719
smpp is in the wild as well

54
00:01:57,040 --> 00:02:01,360
so i'll be sharing a few of the

55
00:01:58,719 --> 00:02:04,880
interesting results we we found

56
00:02:01,360 --> 00:02:08,000
from that excellent

57
00:02:04,880 --> 00:02:10,639
and a reminder for our viewers

58
00:02:08,000 --> 00:02:11,360
please don't uh hesitate to put

59
00:02:10,639 --> 00:02:14,480
questions

60
00:02:11,360 --> 00:02:16,239
in the comments field on your right

61
00:02:14,480 --> 00:02:18,238
uh we will answer the questions at the

62
00:02:16,239 --> 00:02:19,040
end so please don't feel annika that you

63
00:02:18,239 --> 00:02:20,879
need to check the

64
00:02:19,040 --> 00:02:22,480
question and answer sorry the question

65
00:02:20,879 --> 00:02:25,120
feed uh throughout

66
00:02:22,480 --> 00:02:26,319
so i will be checking out uh for

67
00:02:25,120 --> 00:02:29,680
questions

68
00:02:26,319 --> 00:02:30,319
uh and if will you be around on slack

69
00:02:29,680 --> 00:02:33,360
afterwards

70
00:02:30,319 --> 00:02:35,679
if people want to yeah sure yeah

71
00:02:33,360 --> 00:02:37,599
fantastic so brilliant please uh bring

72
00:02:35,680 --> 00:02:40,959
up your uh presentation

73
00:02:37,599 --> 00:02:44,480
or here we go and uh yeah

74
00:02:40,959 --> 00:02:45,200
take it away annika thank you so uh let

75
00:02:44,480 --> 00:02:47,119
me just

76
00:02:45,200 --> 00:02:48,720
start the presentation and please let me

77
00:02:47,120 --> 00:02:51,760
know if uh

78
00:02:48,720 --> 00:02:53,040
it's not in the presentation mode and

79
00:02:51,760 --> 00:02:54,959
it's in the audience mode

80
00:02:53,040 --> 00:02:57,679
no it's it's not in presentation mode at

81
00:02:54,959 --> 00:03:02,640
the moment but now it is

82
00:02:57,680 --> 00:03:02,640
yeah and now it's not and now it is

83
00:03:03,519 --> 00:03:10,239
so everything's fine i guess fine

84
00:03:06,640 --> 00:03:12,720
you can crack on thank you

85
00:03:10,239 --> 00:03:13,519
so as as i said we'll be discussing

86
00:03:12,720 --> 00:03:16,879
about

87
00:03:13,519 --> 00:03:19,200
email security with today and

88
00:03:16,879 --> 00:03:20,720
moving on i'll explain what's actually

89
00:03:19,200 --> 00:03:23,200
day in and day out

90
00:03:20,720 --> 00:03:24,560
and more about our analysis on how the

91
00:03:23,200 --> 00:03:28,720
train for smtp is

92
00:03:24,560 --> 00:03:29,599
in the wild before that let me introduce

93
00:03:28,720 --> 00:03:32,239
myself

94
00:03:29,599 --> 00:03:33,839
so uh i'm a first year psd student at

95
00:03:32,239 --> 00:03:35,440
indian network institute and university

96
00:03:33,840 --> 00:03:39,040
of carlos cary madrid

97
00:03:35,440 --> 00:03:41,120
in spain and my research interest falls

98
00:03:39,040 --> 00:03:43,040
into mobile and internet security and

99
00:03:41,120 --> 00:03:47,360
privacy in general

100
00:03:43,040 --> 00:03:50,480
and i have been now i have contributed

101
00:03:47,360 --> 00:03:53,280
a lot into open source softwares while

102
00:03:50,480 --> 00:03:54,159
my bachelors and because of that i was

103
00:03:53,280 --> 00:03:58,400
uh

104
00:03:54,159 --> 00:04:00,399
i was a google server of code twice

105
00:03:58,400 --> 00:04:01,519
and i was i was also a former

106
00:04:00,400 --> 00:04:04,959
association in

107
00:04:01,519 --> 00:04:08,480
iig tokyo so yeah that's

108
00:04:04,959 --> 00:04:10,400
about who i am and let's start into

109
00:04:08,480 --> 00:04:12,720
how the next 45 minutes is structured

110
00:04:10,400 --> 00:04:15,599
for for the audience

111
00:04:12,720 --> 00:04:17,040
so i will be speaking a little i'll give

112
00:04:15,599 --> 00:04:19,279
a brief introduction of

113
00:04:17,040 --> 00:04:21,519
smtp transport how that works and

114
00:04:19,279 --> 00:04:24,559
especially on the security aspect

115
00:04:21,519 --> 00:04:28,560
uh and security extensions of smtp

116
00:04:24,560 --> 00:04:30,720
uh especially for day that is and

117
00:04:28,560 --> 00:04:32,479
then we will talk about the domain name

118
00:04:30,720 --> 00:04:35,280
systems uh security extension which is

119
00:04:32,479 --> 00:04:35,280
which is the dns

120
00:04:35,600 --> 00:04:38,960
and how that correlates with day here as

121
00:04:38,560 --> 00:04:41,759
well

122
00:04:38,960 --> 00:04:42,799
so what dane exactly is a dns based

123
00:04:41,759 --> 00:04:45,440
authentication of

124
00:04:42,800 --> 00:04:47,199
indentities again we will talk uh about

125
00:04:45,440 --> 00:04:48,800
in detail in the next few coming two

126
00:04:47,199 --> 00:04:50,720
slides

127
00:04:48,800 --> 00:04:52,160
then what is the tlsa record so

128
00:04:50,720 --> 00:04:53,440
basically when you deploy a game

129
00:04:52,160 --> 00:04:56,479
protocol

130
00:04:53,440 --> 00:04:59,520
it deploys something called a tls record

131
00:04:56,479 --> 00:05:02,800
similar to what an air record is in dns

132
00:04:59,520 --> 00:05:06,240
which correlates to ipv4 addresses

133
00:05:02,800 --> 00:05:06,240
so again we'll go in

134
00:05:06,400 --> 00:05:11,840
then once we have an introduction of all

135
00:05:09,280 --> 00:05:14,960
these terms and all these

136
00:05:11,840 --> 00:05:16,880
protocols we'll start to look into the

137
00:05:14,960 --> 00:05:19,520
infor smtp

138
00:05:16,880 --> 00:05:20,479
and how both of them coexist in the

139
00:05:19,520 --> 00:05:24,240
ecosystem

140
00:05:20,479 --> 00:05:28,000
and how that improves the security of

141
00:05:24,240 --> 00:05:30,639
smtp then fine then moving on we'll

142
00:05:28,000 --> 00:05:32,400
i'll share a few results which we found

143
00:05:30,639 --> 00:05:35,840
on

144
00:05:32,400 --> 00:05:38,960
complete comprehensive uh analysis of

145
00:05:35,840 --> 00:05:41,440
email clients that are out there and

146
00:05:38,960 --> 00:05:42,880
our results on how how the deployment is

147
00:05:41,440 --> 00:05:46,639
and if there is anything this

148
00:05:42,880 --> 00:05:50,240
configuration and things like that

149
00:05:46,639 --> 00:05:51,120
and once we once i share the interesting

150
00:05:50,240 --> 00:05:54,639
reasons

151
00:05:51,120 --> 00:05:57,680
we can we'll be talking about what's

152
00:05:54,639 --> 00:05:57,680
broker that is

153
00:05:58,160 --> 00:06:01,440
the miss configurations in the wild and

154
00:06:00,560 --> 00:06:03,680
things like that

155
00:06:01,440 --> 00:06:05,520
and further i will provide a bit

156
00:06:03,680 --> 00:06:08,560
overview on what should be done

157
00:06:05,520 --> 00:06:12,159
so that we can ignore this

158
00:06:08,560 --> 00:06:15,360
we can fix this this configuration and

159
00:06:12,160 --> 00:06:19,600
have a complete secure package for

160
00:06:15,360 --> 00:06:22,800
our email so moving onwards

161
00:06:19,600 --> 00:06:24,800
why do we need indian first of all we we

162
00:06:22,800 --> 00:06:26,639
already have a pka infrastructure which

163
00:06:24,800 --> 00:06:29,600
is public infrastructure which is

164
00:06:26,639 --> 00:06:30,400
deployed within the tls protocol and why

165
00:06:29,600 --> 00:06:34,080
do we need

166
00:06:30,400 --> 00:06:36,719
some a new one today so

167
00:06:34,080 --> 00:06:38,000
yeah when we use a public infrastructure

168
00:06:36,720 --> 00:06:41,120
we have to

169
00:06:38,000 --> 00:06:44,319
always uh trust on something called

170
00:06:41,120 --> 00:06:45,039
certificate authority and it's a blind

171
00:06:44,319 --> 00:06:47,199
trust

172
00:06:45,039 --> 00:06:48,080
so specifically authorities create their

173
00:06:47,199 --> 00:06:50,880
own self-signed

174
00:06:48,080 --> 00:06:52,560
um certificates which we in turn the

175
00:06:50,880 --> 00:06:55,680
users have to trust

176
00:06:52,560 --> 00:06:56,720
and there has been cases like uh cnn ic

177
00:06:55,680 --> 00:06:59,440
and the digital

178
00:06:56,720 --> 00:07:00,160
of the commodore the cas were

179
00:06:59,440 --> 00:07:02,719
compromised

180
00:07:00,160 --> 00:07:03,680
and misused throttle and then for glen

181
00:07:02,720 --> 00:07:07,039
certificates

182
00:07:03,680 --> 00:07:10,000
you are deployed so

183
00:07:07,039 --> 00:07:11,520
that in terms of that we are in a

184
00:07:10,000 --> 00:07:13,360
situation where we cannot

185
00:07:11,520 --> 00:07:17,039
trust the sea uh that we get other

186
00:07:13,360 --> 00:07:20,319
artists properly

187
00:07:17,039 --> 00:07:24,080
so yeah and uh

188
00:07:20,319 --> 00:07:27,599
and here is where dain comes in so

189
00:07:24,080 --> 00:07:28,560
dane allows us to actually deploy our

190
00:07:27,599 --> 00:07:31,680
own certificate

191
00:07:28,560 --> 00:07:33,759
without the need of uh ca

192
00:07:31,680 --> 00:07:35,919
so basically yourself we can have a

193
00:07:33,759 --> 00:07:38,560
sense like a self-signed certificate

194
00:07:35,919 --> 00:07:39,359
and we can say to our server that hey

195
00:07:38,560 --> 00:07:41,520
listen

196
00:07:39,360 --> 00:07:43,039
just use this certificate when any of

197
00:07:41,520 --> 00:07:45,680
the entity tries to connect

198
00:07:43,039 --> 00:07:46,240
so rather than having the pki model we

199
00:07:45,680 --> 00:07:49,759
can

200
00:07:46,240 --> 00:07:52,639
say that use our certificate

201
00:07:49,759 --> 00:07:53,440
and when for instance when https

202
00:07:52,639 --> 00:07:56,560
connection

203
00:07:53,440 --> 00:07:58,319
tries to establish they can verify their

204
00:07:56,560 --> 00:07:59,440
connection with the certificate that we

205
00:07:58,319 --> 00:08:03,440
have powered

206
00:07:59,440 --> 00:08:07,520
and do the verification process right

207
00:08:03,440 --> 00:08:10,879
so moving on now let's look into

208
00:08:07,520 --> 00:08:15,359
how the smtp transport security is

209
00:08:10,879 --> 00:08:18,160
done in the world so basically there are

210
00:08:15,360 --> 00:08:19,039
a lot of extensions and protocol in the

211
00:08:18,160 --> 00:08:22,240
world

212
00:08:19,039 --> 00:08:25,599
which is developed specifically for smtp

213
00:08:22,240 --> 00:08:27,680
so here the

214
00:08:25,599 --> 00:08:29,840
dame for smtp actually it relies mostly

215
00:08:27,680 --> 00:08:34,080
on the start tls extension

216
00:08:29,840 --> 00:08:36,159
so start pls extension is uh

217
00:08:34,080 --> 00:08:38,399
is basically based on the tls networking

218
00:08:36,159 --> 00:08:40,399
itself for the smtp sessions

219
00:08:38,399 --> 00:08:42,719
and a lot of the male transfer agents

220
00:08:40,399 --> 00:08:45,760
that is the mtas support

221
00:08:42,719 --> 00:08:49,440
staff and uh star kls

222
00:08:45,760 --> 00:08:51,839
is basically for the encryption and

223
00:08:49,440 --> 00:08:53,360
yeah and there are a lot of research

224
00:08:51,839 --> 00:08:55,200
that has been done

225
00:08:53,360 --> 00:08:57,519
uh based on the starter section

226
00:08:55,200 --> 00:09:01,760
execution such that there is

227
00:08:57,519 --> 00:09:04,080
little end-to-end encryption in email

228
00:09:01,760 --> 00:09:06,560
and why is that because smtp is a

229
00:09:04,080 --> 00:09:09,680
multi-hook store and forward mechanism

230
00:09:06,560 --> 00:09:12,079
and tlc so

231
00:09:09,680 --> 00:09:13,120
which means that some of the end points

232
00:09:12,080 --> 00:09:17,120
would be protected

233
00:09:13,120 --> 00:09:19,839
and some might not and another

234
00:09:17,120 --> 00:09:21,360
uh use case or another best part of star

235
00:09:19,839 --> 00:09:24,160
tls is that

236
00:09:21,360 --> 00:09:24,720
we don't have to use a specific port for

237
00:09:24,160 --> 00:09:30,560
port

238
00:09:24,720 --> 00:09:34,080
such as 443 for the https

239
00:09:30,560 --> 00:09:37,518
25 port number of smtp for

240
00:09:34,080 --> 00:09:39,279
and deploy the start dls extension and

241
00:09:37,519 --> 00:09:41,440
you might also wonder that there is

242
00:09:39,279 --> 00:09:44,959
different protocols such as dki and

243
00:09:41,440 --> 00:09:45,839
spf but that has that are for the

244
00:09:44,959 --> 00:09:50,719
authentication

245
00:09:45,839 --> 00:09:52,240
and does not encrypt the analysis and

246
00:09:50,720 --> 00:09:53,839
there is also something called empty

247
00:09:52,240 --> 00:09:56,240
space

248
00:09:53,839 --> 00:09:57,279
which is simple to deploy which is uh

249
00:09:56,240 --> 00:09:59,120
which is the

250
00:09:57,279 --> 00:10:00,320
protocol which is deployed by gmail for

251
00:09:59,120 --> 00:10:03,279
instance

252
00:10:00,320 --> 00:10:04,000
they deploy the txt record and doesn't

253
00:10:03,279 --> 00:10:06,079
have to provide

254
00:10:04,000 --> 00:10:07,440
any uh security guarantee for the

255
00:10:06,079 --> 00:10:09,279
certificate and the integrity of the

256
00:10:07,440 --> 00:10:11,839
record

257
00:10:09,279 --> 00:10:13,839
and uh one of the drawback of the empty

258
00:10:11,839 --> 00:10:16,480
sds is that it relies on the

259
00:10:13,839 --> 00:10:18,160
restaurant costume policy and this

260
00:10:16,480 --> 00:10:19,920
initially smtp connection is trusted

261
00:10:18,160 --> 00:10:23,199
without authentication of the receiving

262
00:10:19,920 --> 00:10:24,000
server so that's why well one of the

263
00:10:23,200 --> 00:10:27,200
reason

264
00:10:24,000 --> 00:10:28,079
the the dane standardizing folks decided

265
00:10:27,200 --> 00:10:30,800
to go with

266
00:10:28,079 --> 00:10:30,800
start tls

267
00:10:31,600 --> 00:10:37,920
so how does this rtls actually work

268
00:10:34,959 --> 00:10:39,279
this is similar to our pcb handshake

269
00:10:37,920 --> 00:10:42,880
initiates

270
00:10:39,279 --> 00:10:46,160
so basically smtp means power tcpa

271
00:10:42,880 --> 00:10:49,680
so the other pcp hand trick done

272
00:10:46,160 --> 00:10:51,839
and initiated by the client and uh

273
00:10:49,680 --> 00:10:53,040
something server says hey listen uh i

274
00:10:51,839 --> 00:10:55,200
have

275
00:10:53,040 --> 00:10:56,880
the services ready with uh some response

276
00:10:55,200 --> 00:10:59,600
code of 220

277
00:10:56,880 --> 00:11:00,399
you can try to just let me know if you

278
00:10:59,600 --> 00:11:03,760
are

279
00:11:00,399 --> 00:11:05,680
online again so the smtp client sends an

280
00:11:03,760 --> 00:11:07,279
elfo comment saying that hey i'm

281
00:11:05,680 --> 00:11:08,479
listening here and just send me the

282
00:11:07,279 --> 00:11:11,680
message

283
00:11:08,480 --> 00:11:14,240
so smtp server says that

284
00:11:11,680 --> 00:11:15,760
wait a second let me just check if you

285
00:11:14,240 --> 00:11:18,800
can support

286
00:11:15,760 --> 00:11:20,319
a private conversation between us so it

287
00:11:18,800 --> 00:11:22,959
advertises

288
00:11:20,320 --> 00:11:24,399
a star teamless support with a response

289
00:11:22,959 --> 00:11:28,479
code of 250

290
00:11:24,399 --> 00:11:31,839
and just that we can try to negotiate

291
00:11:28,480 --> 00:11:35,360
um tls and have a private chat

292
00:11:31,839 --> 00:11:40,640
so if a smtp client supports start tls

293
00:11:35,360 --> 00:11:43,680
it then it allows or for the start dls

294
00:11:40,640 --> 00:11:46,800
for conversation to happen so

295
00:11:43,680 --> 00:11:47,120
but there's a drawback yes and it is

296
00:11:46,800 --> 00:11:49,760
that

297
00:11:47,120 --> 00:11:50,399
it is wonderful to downgrade attacks

298
00:11:49,760 --> 00:11:54,560
because

299
00:11:50,399 --> 00:11:58,000
uh yeah when the

300
00:11:54,560 --> 00:11:59,119
as i told smtp is on a multi-core

301
00:11:58,000 --> 00:12:02,320
protocol

302
00:11:59,120 --> 00:12:03,279
right and there can be a cases where we

303
00:12:02,320 --> 00:12:06,720
have we can do

304
00:12:03,279 --> 00:12:09,600
a mitm attacks and

305
00:12:06,720 --> 00:12:12,079
and because of that with the smtp client

306
00:12:09,600 --> 00:12:17,680
and the smtp server which uses the

307
00:12:12,079 --> 00:12:17,680
star tls uh service is vulnerable

308
00:12:19,040 --> 00:12:25,120
and again why sntp transport

309
00:12:22,880 --> 00:12:25,120
with

310
00:12:26,079 --> 00:12:29,439
basically one of the reason is that star

311
00:12:27,760 --> 00:12:33,519
tls is optional

312
00:12:29,440 --> 00:12:35,680
so and that brings the

313
00:12:33,519 --> 00:12:38,240
case of fault falling back to the one

314
00:12:35,680 --> 00:12:38,239
encrypted

315
00:12:38,290 --> 00:12:41,349
[Music]

316
00:12:50,959 --> 00:12:57,199
is trivial to do as well and

317
00:12:54,399 --> 00:12:58,880
another finding is that most of the mtas

318
00:12:57,200 --> 00:13:01,519
does not authenticate the receiving

319
00:12:58,880 --> 00:13:02,639
server and the server validation is

320
00:13:01,519 --> 00:13:05,440
really right

321
00:13:02,639 --> 00:13:07,760
and and also we have seen that it

322
00:13:05,440 --> 00:13:11,519
doesn't not does not even work

323
00:13:07,760 --> 00:13:12,560
and there is very little incentive to do

324
00:13:11,519 --> 00:13:15,120
all the diffusion

325
00:13:12,560 --> 00:13:15,760
when the only option is to fall back to

326
00:13:15,120 --> 00:13:19,519
clear test

327
00:13:15,760 --> 00:13:20,000
text as well and also start tls is

328
00:13:19,519 --> 00:13:24,560
wonderful

329
00:13:20,000 --> 00:13:24,560
to expose the mixer attached

330
00:13:24,959 --> 00:13:30,719
and one of the

331
00:13:28,399 --> 00:13:32,560
use cases of star tls is that it helps

332
00:13:30,720 --> 00:13:33,760
to resist from passive monitoring in the

333
00:13:32,560 --> 00:13:35,760
smtp

334
00:13:33,760 --> 00:13:37,519
while it's still vulnerable to all of

335
00:13:35,760 --> 00:13:40,720
this bjp hijacking and

336
00:13:37,519 --> 00:13:43,040
dns was rewarded star tls tripping

337
00:13:40,720 --> 00:13:43,040
attacks

338
00:13:43,360 --> 00:13:47,040
so similar to similarly to the

339
00:13:46,000 --> 00:13:51,360
opportunity

340
00:13:47,040 --> 00:13:54,560
a futuristic uh tls security flaws

341
00:13:51,360 --> 00:13:57,680
and it is basically uh

342
00:13:54,560 --> 00:14:00,079
based on the sea model

343
00:13:57,680 --> 00:14:01,760
that is the pki infrastructure so again

344
00:14:00,079 --> 00:14:04,880
as i told you my team attacks is

345
00:14:01,760 --> 00:14:07,839
triggered to do and

346
00:14:04,880 --> 00:14:10,079
downgrading attacks is still evident in

347
00:14:07,839 --> 00:14:13,120
the tls acquisition

348
00:14:10,079 --> 00:14:14,000
and when there is an opportunity tls it

349
00:14:13,120 --> 00:14:16,320
is

350
00:14:14,000 --> 00:14:17,440
it is in the incomplete automation for

351
00:14:16,320 --> 00:14:21,120
certificate rollover

352
00:14:17,440 --> 00:14:21,120
is also found in the world

353
00:14:21,680 --> 00:14:27,760
next before going forward into how

354
00:14:24,800 --> 00:14:28,959
dame and the smtp actually work and

355
00:14:27,760 --> 00:14:30,720
together

356
00:14:28,959 --> 00:14:34,319
let me just give a few pointers on how

357
00:14:30,720 --> 00:14:38,000
we can improve the smtp security

358
00:14:34,320 --> 00:14:41,360
so it it must be this

359
00:14:38,000 --> 00:14:43,680
uh yeah the the

360
00:14:41,360 --> 00:14:44,959
smtp mechanism will be deployed should

361
00:14:43,680 --> 00:14:48,079
be resistant to

362
00:14:44,959 --> 00:14:50,880
active attacks such as the downgrading

363
00:14:48,079 --> 00:14:51,199
a downgraded system should be employed

364
00:14:50,880 --> 00:14:54,959
for

365
00:14:51,199 --> 00:14:58,079
even the first contact then must support

366
00:14:54,959 --> 00:15:00,560
mixed environment and as i mentioned

367
00:14:58,079 --> 00:15:01,760
yeah it's a multi-hope mechanism and

368
00:15:00,560 --> 00:15:05,279
end-to-end

369
00:15:01,760 --> 00:15:07,120
encryption is rare we should

370
00:15:05,279 --> 00:15:09,040
we should provide some sort of signal

371
00:15:07,120 --> 00:15:11,120
which lets

372
00:15:09,040 --> 00:15:13,040
the server and the client knows which

373
00:15:11,120 --> 00:15:16,480
beer to entertain

374
00:15:13,040 --> 00:15:19,680
and then we we must indicate how to

375
00:15:16,480 --> 00:15:21,680
authenticate the hp attachment

376
00:15:19,680 --> 00:15:23,279
just the encryption is not you know you

377
00:15:21,680 --> 00:15:26,638
should also know how which

378
00:15:23,279 --> 00:15:30,000
entity you should trust as well

379
00:15:26,639 --> 00:15:33,360
now into the main game for this

380
00:15:30,000 --> 00:15:37,279
talk which is the beginning

381
00:15:33,360 --> 00:15:40,959
so for as i mentioned before before

382
00:15:37,279 --> 00:15:44,160
properly work there is multiple uh

383
00:15:40,959 --> 00:15:46,160
path or multiple entities which

384
00:15:44,160 --> 00:15:48,079
which the server should support server

385
00:15:46,160 --> 00:15:51,439
in the inbound or outbound

386
00:15:48,079 --> 00:15:55,758
servers should support right and one of

387
00:15:51,440 --> 00:15:58,880
that is the dns so i'm not going in

388
00:15:55,759 --> 00:16:03,120
in depth with dns sec here

389
00:15:58,880 --> 00:16:06,160
because it's it's a bit complicated and

390
00:16:03,120 --> 00:16:07,120
it's very washed area as well so as you

391
00:16:06,160 --> 00:16:10,880
can see it is

392
00:16:07,120 --> 00:16:14,639
defined in multiple rfcs

393
00:16:10,880 --> 00:16:18,320
so basically i will give an overview of

394
00:16:14,639 --> 00:16:22,160
how dns works and how dane uses

395
00:16:18,320 --> 00:16:25,040
that in this card

396
00:16:22,160 --> 00:16:26,000
so as you might know there were from the

397
00:16:25,040 --> 00:16:29,120
inception of

398
00:16:26,000 --> 00:16:33,519
dlns it has always been uh

399
00:16:29,120 --> 00:16:36,800
send over today uh clear text right and

400
00:16:33,519 --> 00:16:40,560
they did not have a mechanism where

401
00:16:36,800 --> 00:16:42,160
the solver took trust and dna server as

402
00:16:40,560 --> 00:16:45,599
well

403
00:16:42,160 --> 00:16:49,519
so the dns set protocol

404
00:16:45,600 --> 00:16:53,040
is deployed to add a layer of

405
00:16:49,519 --> 00:16:56,560
the trust for uh the uses of games right

406
00:16:53,040 --> 00:16:59,519
and the dns also realize

407
00:16:56,560 --> 00:17:00,560
the dns relies on the standard public

408
00:16:59,519 --> 00:17:04,000
infrastructure

409
00:17:00,560 --> 00:17:07,280
and it also adds new type new records

410
00:17:04,000 --> 00:17:09,119
to dns as well and we'll uh learn a

411
00:17:07,280 --> 00:17:12,720
little bit of the records which

412
00:17:09,119 --> 00:17:16,399
is deployed because of a day in a sec in

413
00:17:12,720 --> 00:17:19,839
the next few slides the main point

414
00:17:16,400 --> 00:17:23,360
why is deployed is that we provide

415
00:17:19,839 --> 00:17:26,799
the dns provides a chain of trust

416
00:17:23,359 --> 00:17:30,719
uh till the roof see a

417
00:17:26,799 --> 00:17:34,240
dns server obviously so

418
00:17:30,720 --> 00:17:38,080
this is why dns sec is said that

419
00:17:34,240 --> 00:17:41,360
uh it used to be used to provide uh

420
00:17:38,080 --> 00:17:45,280
a trust form for the end users to

421
00:17:41,360 --> 00:17:47,760
use dmz and it also

422
00:17:45,280 --> 00:17:48,879
because of the chain of trust it

423
00:17:47,760 --> 00:17:51,280
prevents

424
00:17:48,880 --> 00:17:53,840
fake response responses and tampering

425
00:17:51,280 --> 00:17:53,840
with the dns

426
00:17:54,160 --> 00:17:59,679
and that being said let's look into the

427
00:17:56,960 --> 00:18:01,200
dna architecture and basically i'm only

428
00:17:59,679 --> 00:18:04,240
explaining about

429
00:18:01,200 --> 00:18:07,679
the records which is useful for the

430
00:18:04,240 --> 00:18:10,720
day and here are the few

431
00:18:07,679 --> 00:18:12,320
so we create a couple of signing keys i

432
00:18:10,720 --> 00:18:14,880
will explain that in the next

433
00:18:12,320 --> 00:18:15,760
sec so this signing keys which uh

434
00:18:14,880 --> 00:18:19,520
generates

435
00:18:15,760 --> 00:18:22,320
a couple of records for dns

436
00:18:19,520 --> 00:18:24,320
so one of that is dns key that is the

437
00:18:22,320 --> 00:18:27,918
public key for the entire zone

438
00:18:24,320 --> 00:18:28,399
and the private key is used to generate

439
00:18:27,919 --> 00:18:30,880
the

440
00:18:28,400 --> 00:18:31,440
rr signature so that is the resource

441
00:18:30,880 --> 00:18:34,559
resource

442
00:18:31,440 --> 00:18:38,000
or record signatures so for every record

443
00:18:34,559 --> 00:18:38,000
that is the a for ipv2

444
00:18:38,240 --> 00:18:42,640
for ipv6 and then servers and the email

445
00:18:41,760 --> 00:18:46,000
record

446
00:18:42,640 --> 00:18:50,080
is create an rr signature is created

447
00:18:46,000 --> 00:18:53,360
and each uh each signature is created at

448
00:18:50,080 --> 00:18:57,039
each nodes of the dna

449
00:18:53,360 --> 00:18:59,439
and then the next is the ds record

450
00:18:57,039 --> 00:19:00,160
so it is the hash of the dns case that

451
00:18:59,440 --> 00:19:02,240
is the private

452
00:19:00,160 --> 00:19:03,679
public and the private keys and hand it

453
00:19:02,240 --> 00:19:07,840
into the

454
00:19:03,679 --> 00:19:12,960
parent zone of the obligation

455
00:19:07,840 --> 00:19:14,879
and then there is the 10 second in n63

456
00:19:12,960 --> 00:19:18,160
which is which confirms the next homing

457
00:19:14,880 --> 00:19:22,840
responses but um

458
00:19:18,160 --> 00:19:25,840
record is not so relevant for obtaining

459
00:19:22,840 --> 00:19:25,840
foreign

460
00:19:31,440 --> 00:19:34,480
that is as i mentioned before how the

461
00:19:33,600 --> 00:19:37,760
key pair is

462
00:19:34,480 --> 00:19:40,480
generated so we generate two types of

463
00:19:37,760 --> 00:19:42,160
case which is uh zone signing keys and

464
00:19:40,480 --> 00:19:45,200
the key signing piece

465
00:19:42,160 --> 00:19:46,080
so zone signing case is used to uh sign

466
00:19:45,200 --> 00:19:48,320
the zone

467
00:19:46,080 --> 00:19:50,320
the particular form itself and the

468
00:19:48,320 --> 00:19:53,918
public part becomes the dnsp

469
00:19:50,320 --> 00:19:57,280
of that particular then

470
00:19:53,919 --> 00:19:59,120
next we have the key signing piece which

471
00:19:57,280 --> 00:20:00,559
signs the keys for the particular

472
00:19:59,120 --> 00:20:03,520
affects of the room

473
00:20:00,559 --> 00:20:04,320
and uh yeah and the public part becomes

474
00:20:03,520 --> 00:20:08,158
also

475
00:20:04,320 --> 00:20:08,158
the public part becomes the dns um

476
00:20:09,039 --> 00:20:15,679
and this this is used to be used

477
00:20:12,400 --> 00:20:20,559
for exporting the ds record for

478
00:20:15,679 --> 00:20:22,960
that particular that's

479
00:20:20,559 --> 00:20:24,320
the introduction into your dns tech and

480
00:20:22,960 --> 00:20:27,440
let's move on towards

481
00:20:24,320 --> 00:20:31,120
today so

482
00:20:27,440 --> 00:20:35,200
then rfc was published in 2012

483
00:20:31,120 --> 00:20:35,199
and even with its inception

484
00:20:45,200 --> 00:20:51,840
and what name exactly does

485
00:20:48,880 --> 00:20:52,799
is that it allows us to bowl a

486
00:20:51,840 --> 00:20:56,080
certificate

487
00:20:52,799 --> 00:21:00,320
with a but with our domain name

488
00:20:56,080 --> 00:21:03,600
as i explained before if we want to

489
00:21:00,320 --> 00:21:06,399
have a https connection

490
00:21:03,600 --> 00:21:07,918
we can advertise that we have the

491
00:21:06,400 --> 00:21:10,320
certificate to use this particular

492
00:21:07,919 --> 00:21:12,080
particular certificate rather than

493
00:21:10,320 --> 00:21:14,158
providing a certificate which is from

494
00:21:12,080 --> 00:21:17,039
the kita similarly for

495
00:21:14,159 --> 00:21:18,480
well as i have been explaining about the

496
00:21:17,039 --> 00:21:21,520
web infrastructure

497
00:21:18,480 --> 00:21:24,320
but uh yeah

498
00:21:21,520 --> 00:21:26,480
this is similar case where uh the bane

499
00:21:24,320 --> 00:21:29,360
could be used for smtp as well

500
00:21:26,480 --> 00:21:30,320
which is a little bit different and i'll

501
00:21:29,360 --> 00:21:33,600
explain that

502
00:21:30,320 --> 00:21:36,799
in detail in the next community slides

503
00:21:33,600 --> 00:21:40,240
with a dns set um the dane

504
00:21:36,799 --> 00:21:43,120
adds a trusted layer of

505
00:21:40,240 --> 00:21:44,559
authentication and the dns set is

506
00:21:43,120 --> 00:21:45,760
responsible for authenticating the

507
00:21:44,559 --> 00:21:49,120
particular

508
00:21:45,760 --> 00:21:52,559
server for with data

509
00:21:49,120 --> 00:21:56,158
and because of this dns set it enters

510
00:21:52,559 --> 00:21:59,200
uh us for the downgrade protection

511
00:21:56,159 --> 00:22:01,600
and indicates that encryption is uh

512
00:21:59,200 --> 00:22:03,120
yeah so then deploy something called the

513
00:22:01,600 --> 00:22:05,678
tlsa record

514
00:22:03,120 --> 00:22:06,399
uh and i'll uh tell you exactly what

515
00:22:05,679 --> 00:22:09,200
that

516
00:22:06,400 --> 00:22:10,400
record is in the next few slides and it

517
00:22:09,200 --> 00:22:13,200
also helps to authenticate

518
00:22:10,400 --> 00:22:13,200
the receiver

519
00:22:16,559 --> 00:22:20,240
between the smtp and als to fully secure

520
00:22:19,520 --> 00:22:23,600
the

521
00:22:20,240 --> 00:22:27,840
main delivery ecosystem because again

522
00:22:23,600 --> 00:22:27,840
it's a multi-port

523
00:22:33,160 --> 00:22:36,239
[Music]

524
00:22:38,840 --> 00:22:45,760
so yeah similar similar to how

525
00:22:42,400 --> 00:22:48,159
a dns uh server server

526
00:22:45,760 --> 00:22:49,919
tried to fix the records it purchased

527
00:22:48,159 --> 00:22:52,960
something called a tlsr

528
00:22:49,919 --> 00:22:54,240
and the rr simulator of that particular

529
00:22:52,960 --> 00:22:56,880
account

530
00:22:54,240 --> 00:22:58,720
and then when that uh tailors are called

531
00:22:56,880 --> 00:23:02,080
with our signature has been

532
00:22:58,720 --> 00:23:07,039
fetched by the dns server

533
00:23:02,080 --> 00:23:10,799
that our server tries to

534
00:23:07,039 --> 00:23:12,960
validate the dna section and

535
00:23:10,799 --> 00:23:14,320
if the validation process is complete

536
00:23:12,960 --> 00:23:18,559
and

537
00:23:14,320 --> 00:23:21,280
it's validated we move on to the smtp

538
00:23:18,559 --> 00:23:22,399
client and server communication so well

539
00:23:21,280 --> 00:23:25,440
now

540
00:23:22,400 --> 00:23:28,960
so uh since we are

541
00:23:25,440 --> 00:23:32,799
contradicting that this rtls is possible

542
00:23:28,960 --> 00:23:35,039
what the smtp server does

543
00:23:32,799 --> 00:23:36,320
it sends a start dls communication with

544
00:23:35,039 --> 00:23:39,360
a

545
00:23:36,320 --> 00:23:41,439
certificate to the smtp client

546
00:23:39,360 --> 00:23:42,799
and once the certificate is received

547
00:23:41,440 --> 00:23:45,600
that they simply decline

548
00:23:42,799 --> 00:23:46,720
the client the client starts to match

549
00:23:45,600 --> 00:23:49,279
the tlsr card

550
00:23:46,720 --> 00:23:50,000
with the certificate so if the matching

551
00:23:49,279 --> 00:23:54,080
process is

552
00:23:50,000 --> 00:23:56,880
validated and is complete uh the smtp

553
00:23:54,080 --> 00:23:58,158
client says that access to the server

554
00:23:56,880 --> 00:24:00,240
that has an hour they

555
00:23:58,159 --> 00:24:02,840
will cover our private communication

556
00:24:00,240 --> 00:24:05,120
with the tls

557
00:24:02,840 --> 00:24:09,039
channel so

558
00:24:05,120 --> 00:24:12,158
yeah in a brief summary of it

559
00:24:09,039 --> 00:24:15,360
another uh dns

560
00:24:12,159 --> 00:24:17,760
server which has dana second

561
00:24:15,360 --> 00:24:20,639
that is the main point here that the dns

562
00:24:17,760 --> 00:24:24,480
server should have dna set

563
00:24:20,640 --> 00:24:27,760
and their dns resolver tries to fix

564
00:24:24,480 --> 00:24:30,799
their tlsr record with the rr signature

565
00:24:27,760 --> 00:24:33,039
and the mail client receives it and

566
00:24:30,799 --> 00:24:34,559
they uh client with this help of star

567
00:24:33,039 --> 00:24:36,720
tls starts to

568
00:24:34,559 --> 00:24:37,600
have a very complicated verification of

569
00:24:36,720 --> 00:24:40,960
the encryption

570
00:24:37,600 --> 00:24:44,840
complete so

571
00:24:40,960 --> 00:24:47,840
next is about how the record deployed by

572
00:24:44,840 --> 00:24:47,840
dna

573
00:24:54,720 --> 00:24:58,159
so this is one of the email service that

574
00:24:57,200 --> 00:25:00,960
provides

575
00:24:58,159 --> 00:25:00,960
uh email uh

576
00:25:11,360 --> 00:25:15,840
and you can see in the answer section

577
00:25:12,960 --> 00:25:20,080
that how the pls record looks like

578
00:25:15,840 --> 00:25:23,279
and and things like that

579
00:25:20,080 --> 00:25:24,080
so what exactly each of the entities

580
00:25:23,279 --> 00:25:27,200
within the

581
00:25:24,080 --> 00:25:29,039
pls support me so

582
00:25:27,200 --> 00:25:30,320
the initial one that is the 25 which is

583
00:25:29,039 --> 00:25:33,679
the smtp and

584
00:25:30,320 --> 00:25:37,520
the pcp is the protocol right okay

585
00:25:33,679 --> 00:25:40,240
is denoted there and then the host name

586
00:25:37,520 --> 00:25:43,840
or the particular host that we are

587
00:25:40,240 --> 00:25:43,840
trying to find

588
00:25:55,200 --> 00:25:59,600
which is the hash so what is this

589
00:25:57,840 --> 00:26:01,840
particular certificate usage

590
00:25:59,600 --> 00:26:04,080
so the certificate usage mentioned that

591
00:26:01,840 --> 00:26:07,120
if we are using a trusted angle that is

592
00:26:04,080 --> 00:26:08,240
the ca certificate the certificate

593
00:26:07,120 --> 00:26:11,439
provider

594
00:26:08,240 --> 00:26:12,720
which is which can be pki validated or

595
00:26:11,440 --> 00:26:16,960
not

596
00:26:12,720 --> 00:26:17,840
and so with the significant usage of

597
00:26:16,960 --> 00:26:21,679
zero you can mention

598
00:26:17,840 --> 00:26:24,399
that it should be pka then the next is

599
00:26:21,679 --> 00:26:25,440
certificate one which means that it's a

600
00:26:24,400 --> 00:26:28,640
host certificate

601
00:26:25,440 --> 00:26:31,840
or a consent certificate for instance

602
00:26:28,640 --> 00:26:36,400
where the pki is validated

603
00:26:31,840 --> 00:26:39,678
and the next one is a trust banker again

604
00:26:36,400 --> 00:26:43,039
without apk validation and uh again

605
00:26:39,679 --> 00:26:46,320
uh satellite usage three with fours

606
00:26:43,039 --> 00:26:49,279
of opk validation that's

607
00:26:46,320 --> 00:26:51,360
what the certificate usage failed in in

608
00:26:49,279 --> 00:26:55,679
the tlsr economy

609
00:26:51,360 --> 00:26:57,600
then there is a selector so selector

610
00:26:55,679 --> 00:26:59,679
service that should be used or

611
00:26:57,600 --> 00:27:01,678
certificate then that certificate

612
00:26:59,679 --> 00:27:03,120
to validate or should we use just a

613
00:27:01,679 --> 00:27:04,880
public key

614
00:27:03,120 --> 00:27:06,879
and there is a matching type matching

615
00:27:04,880 --> 00:27:08,310
type means

616
00:27:06,880 --> 00:27:11,380
should it be um

617
00:27:08,310 --> 00:27:11,379
[Music]

618
00:27:15,679 --> 00:27:21,840
and that's how a tls record looks like

619
00:27:31,760 --> 00:27:35,120
and the matching type is to three one

620
00:27:33,760 --> 00:27:37,520
one and

621
00:27:35,120 --> 00:27:40,320
it has a specific meaning for all of

622
00:27:37,520 --> 00:27:42,399
those for which one is

623
00:27:40,320 --> 00:27:44,000
three one one means it's uh being

624
00:27:42,399 --> 00:27:49,840
entered

625
00:27:44,000 --> 00:27:49,840
which is a sharp and two fifty six

626
00:27:56,080 --> 00:28:02,559
communication and we use that if

627
00:27:59,440 --> 00:28:02,559
our ca

628
00:28:04,399 --> 00:28:09,279
and the primary purpose of today is to

629
00:28:07,440 --> 00:28:11,440
let dominant owners use custom

630
00:28:09,279 --> 00:28:12,480
certificate for the tls connection as i

631
00:28:11,440 --> 00:28:17,840
mentioned before

632
00:28:12,480 --> 00:28:17,840
by using by deploying their tls

633
00:28:27,120 --> 00:28:35,600
see if we want to use a third party

634
00:28:32,240 --> 00:28:40,559
ceo we cannot deploy it with

635
00:28:35,600 --> 00:28:40,559
three one one or one we have to use

636
00:28:40,960 --> 00:28:43,760
zero or

637
00:28:56,799 --> 00:29:00,320
that way then we cannot benefit fully

638
00:28:59,440 --> 00:29:12,660
from the secure

639
00:29:00,320 --> 00:29:15,989
security measurement which main province

640
00:29:12,660 --> 00:29:15,989
[Music]

641
00:29:25,039 --> 00:29:29,600
there are particular cases where we

642
00:29:27,440 --> 00:29:33,760
should be careful on declining

643
00:29:29,600 --> 00:29:37,120
and how how silly mistakes can

644
00:29:33,760 --> 00:29:39,039
lead to this configuration in the entire

645
00:29:37,120 --> 00:29:43,120
ecosystem

646
00:29:39,039 --> 00:29:45,120
so for a proper support of day

647
00:29:43,120 --> 00:29:47,918
as i mentioned there should be dns sec

648
00:29:45,120 --> 00:29:50,239
and start ls deployed perfectly

649
00:29:47,919 --> 00:29:54,240
and that means the dns set should have

650
00:29:50,240 --> 00:29:56,799
been ds and rcbs published

651
00:29:54,240 --> 00:29:58,080
and these records should be correct that

652
00:29:56,799 --> 00:30:00,480
means it should not be

653
00:29:58,080 --> 00:30:01,760
expired or it should that the r

654
00:30:00,480 --> 00:30:04,080
signature should not have

655
00:30:01,760 --> 00:30:05,279
configuration in the hashes for instance

656
00:30:04,080 --> 00:30:08,240
and things like that

657
00:30:05,279 --> 00:30:09,840
and for uh star tls the certificate

658
00:30:08,240 --> 00:30:12,559
should be provided

659
00:30:09,840 --> 00:30:13,199
and the certificate should be consistent

660
00:30:12,559 --> 00:30:15,918
with

661
00:30:13,200 --> 00:30:18,960
the tls report for a correcting proper

662
00:30:15,919 --> 00:30:18,960
management option

663
00:30:20,840 --> 00:30:26,799
and next year so if

664
00:30:24,159 --> 00:30:28,480
there is any missing components and any

665
00:30:26,799 --> 00:30:31,520
incorrect components

666
00:30:28,480 --> 00:30:32,240
within the dns sec and start als it

667
00:30:31,520 --> 00:30:35,279
should be

668
00:30:32,240 --> 00:30:38,080
in the case that they

669
00:30:35,279 --> 00:30:39,279
and deployed main servers around the

670
00:30:38,080 --> 00:30:43,199
ecosystem

671
00:30:39,279 --> 00:30:46,320
should not receive any name for instance

672
00:30:43,200 --> 00:30:47,919
in our case because there is a risk

673
00:30:46,320 --> 00:30:49,600
configuration and we should not trust

674
00:30:47,919 --> 00:30:53,679
that

675
00:30:49,600 --> 00:30:56,000
so we did a comprehensive analysis

676
00:30:53,679 --> 00:30:56,960
on the server side as well as the client

677
00:30:56,000 --> 00:30:58,640
side

678
00:30:56,960 --> 00:31:02,320
i'm talking about the client side for

679
00:30:58,640 --> 00:31:04,960
this talk today and this is case in our

680
00:31:02,320 --> 00:31:04,960
white paper as

681
00:31:16,320 --> 00:31:19,360
measurement and to see how the

682
00:31:18,000 --> 00:31:22,640
deployment is done

683
00:31:19,360 --> 00:31:26,080
and how correct the deployment is

684
00:31:22,640 --> 00:31:29,200
we had a test bed and

685
00:31:26,080 --> 00:31:31,918
the test bed is as follows so

686
00:31:29,200 --> 00:31:34,559
we purchased a second level for instance

687
00:31:31,919 --> 00:31:38,159
uh something like a daily test platform

688
00:31:34,559 --> 00:31:39,200
and then we created uh with we have we

689
00:31:38,159 --> 00:31:47,840
set up our own

690
00:31:39,200 --> 00:31:47,840
find a name and a postcard that is

691
00:31:58,799 --> 00:32:02,960
has an expired r signature for instance

692
00:32:01,440 --> 00:32:05,039
or the klsa

693
00:32:02,960 --> 00:32:07,440
record with the which provides with this

694
00:32:05,039 --> 00:32:07,440
station

695
00:32:07,600 --> 00:32:14,879
is different so we created a couple of

696
00:32:12,840 --> 00:32:16,879
uh correctly more than seven to eight

697
00:32:14,880 --> 00:32:20,240
scenarios where

698
00:32:16,880 --> 00:32:20,640
this could fail and uh we tested it out

699
00:32:20,240 --> 00:32:23,919
with

700
00:32:20,640 --> 00:32:25,919
29 popular email service providers

701
00:32:23,919 --> 00:32:29,840
and we will talk about the results in

702
00:32:25,919 --> 00:32:29,840
the comments

703
00:32:51,519 --> 00:32:58,480
then we send an email from gmail to

704
00:32:55,360 --> 00:33:01,840
our smtp server and

705
00:32:58,480 --> 00:33:02,960
when we do that at the first entry point

706
00:33:01,840 --> 00:33:06,559
is the dns

707
00:33:02,960 --> 00:33:08,840
so the dns is our type of effects the ms

708
00:33:06,559 --> 00:33:10,000
mx and the dlc records from the dns

709
00:33:08,840 --> 00:33:14,320
examiner

710
00:33:10,000 --> 00:33:18,640
and the dns resolver tries to

711
00:33:14,320 --> 00:33:21,360
look up from our other server

712
00:33:18,640 --> 00:33:21,919
and the authoritative server when it's

713
00:33:21,360 --> 00:33:24,959
when it

714
00:33:21,919 --> 00:33:28,320
against the image and the tls

715
00:33:24,960 --> 00:33:30,000
it tries to do a dns dns lookup and the

716
00:33:28,320 --> 00:33:34,879
tftlc

717
00:33:30,000 --> 00:33:34,880
and verify if it's correct or uh

718
00:33:34,960 --> 00:33:40,240
then when that's done uh and the

719
00:33:38,480 --> 00:33:43,760
verification is correct

720
00:33:40,240 --> 00:33:44,720
um the smtp client initiates a smtp

721
00:33:43,760 --> 00:33:47,120
connection

722
00:33:44,720 --> 00:33:49,279
where again there's something server

723
00:33:47,120 --> 00:33:52,959
will start uh starting

724
00:33:49,279 --> 00:33:55,120
and if it's if this

725
00:33:52,960 --> 00:33:56,320
typical client supports it a certificate

726
00:33:55,120 --> 00:33:59,039
is sent through

727
00:33:56,320 --> 00:34:00,240
and if the certificate is validated with

728
00:33:59,039 --> 00:34:04,720
the tlsa

729
00:34:00,240 --> 00:34:04,720
record then this entity connection is

730
00:34:04,840 --> 00:34:10,000
established so

731
00:34:07,919 --> 00:34:12,079
here is an example of one of our case

732
00:34:10,000 --> 00:34:14,560
that i mentioned before that

733
00:34:12,079 --> 00:34:16,240
which we deployed that is this

734
00:34:14,560 --> 00:34:18,839
configuration in the dns

735
00:34:16,239 --> 00:34:20,638
for instance where the rr signature is

736
00:34:18,839 --> 00:34:25,279
expired so

737
00:34:20,639 --> 00:34:25,280
when our signature is expired however

738
00:34:26,399 --> 00:34:33,359
we would like that the smtp client

739
00:34:30,000 --> 00:34:37,280
should not um send any emails to their

740
00:34:33,359 --> 00:34:40,719
personal points and

741
00:34:37,280 --> 00:34:46,079
because the trust is lost or that

742
00:34:40,719 --> 00:34:49,439
the here the rs nature is expired

743
00:34:46,079 --> 00:34:53,119
so yeah that's it for the testbed

744
00:34:49,440 --> 00:34:54,079
and with the mentioned scenarios that we

745
00:34:53,119 --> 00:34:57,680
deployed

746
00:34:54,079 --> 00:35:01,200
we did a comprehensive analysis on uh

747
00:34:57,680 --> 00:35:04,720
as i mentioned 29 email providers and

748
00:35:01,200 --> 00:35:07,279
here is our five bits so

749
00:35:04,720 --> 00:35:08,160
from the 29 email providers when we

750
00:35:07,280 --> 00:35:11,359
checked

751
00:35:08,160 --> 00:35:12,240
for a pro and to say that uh the dns set

752
00:35:11,359 --> 00:35:14,720
is properly

753
00:35:12,240 --> 00:35:16,560
deployed we say that the dns key and the

754
00:35:14,720 --> 00:35:20,078
dsr account should be fixed

755
00:35:16,560 --> 00:35:23,359
okay and we could see here that the

756
00:35:20,079 --> 00:35:26,320
only 7 out of 29

757
00:35:23,359 --> 00:35:28,839
service providers are actually pitching

758
00:35:26,320 --> 00:35:31,839
the dns key and the ds record

759
00:35:28,839 --> 00:35:35,200
properly and

760
00:35:31,839 --> 00:35:37,599
even out of that only four out of seven

761
00:35:35,200 --> 00:35:40,319
are correctly verifying the dns

762
00:35:37,599 --> 00:35:40,320
ciphertox

763
00:35:42,960 --> 00:35:50,160
so yeah and once we

764
00:35:46,800 --> 00:35:50,800
are completed with the dns uh analysis

765
00:35:50,160 --> 00:35:53,920
we went

766
00:35:50,800 --> 00:35:54,480
for what we measuring how much uh start

767
00:35:53,920 --> 00:35:57,359
als

768
00:35:54,480 --> 00:35:58,079
has been deployed in the world and the

769
00:35:57,359 --> 00:36:01,040
good news

770
00:35:58,079 --> 00:36:02,240
is that 23 out of 29 is supporting

771
00:36:01,040 --> 00:36:05,920
starting list

772
00:36:02,240 --> 00:36:05,919
and which is good

773
00:36:06,160 --> 00:36:10,720
and then there is

774
00:36:10,800 --> 00:36:14,079
so as i mentioned in the previous slides

775
00:36:13,599 --> 00:36:17,200
as well

776
00:36:14,079 --> 00:36:21,200
for a proper working of dane

777
00:36:17,200 --> 00:36:24,799
dnsec and staff als should be deployed

778
00:36:21,200 --> 00:36:28,319
and for that only four of the providers

779
00:36:24,800 --> 00:36:30,160
actually fetched lsa and

780
00:36:28,320 --> 00:36:31,920
we could see that only two of them

781
00:36:30,160 --> 00:36:34,480
correctly validates them

782
00:36:31,920 --> 00:36:37,359
and only two and two and the two others

783
00:36:34,480 --> 00:36:41,839
does not even validate the fields

784
00:36:37,359 --> 00:36:41,839
such as the usage

785
00:36:44,000 --> 00:36:50,800
so finally where are we right now

786
00:36:47,200 --> 00:36:52,839
so as i mentioned we looked into 29

787
00:36:50,800 --> 00:36:56,400
email service providers

788
00:36:52,839 --> 00:36:58,960
and our study

789
00:36:56,400 --> 00:36:59,440
reveals that there are a mismanagement

790
00:36:58,960 --> 00:37:02,560
in the

791
00:36:59,440 --> 00:37:03,119
dynamic system and we found that six

792
00:37:02,560 --> 00:37:05,680
percent

793
00:37:03,119 --> 00:37:06,640
of the tlsa records cannot be updated

794
00:37:05,680 --> 00:37:10,160
due to missing

795
00:37:06,640 --> 00:37:12,720
or incorrect dna and

796
00:37:10,160 --> 00:37:13,279
because dna is an important part of the

797
00:37:12,720 --> 00:37:16,480
daily

798
00:37:13,280 --> 00:37:17,839
system and of which fourteen point

799
00:37:16,480 --> 00:37:19,359
fourteen percent of them are in

800
00:37:17,839 --> 00:37:21,599
consistent with their certificate

801
00:37:19,359 --> 00:37:24,078
records

802
00:37:21,599 --> 00:37:25,359
we have also found that only uh four

803
00:37:24,079 --> 00:37:27,280
email service providers

804
00:37:25,359 --> 00:37:28,560
support them for both outgoing and

805
00:37:27,280 --> 00:37:30,240
incoming emails

806
00:37:28,560 --> 00:37:34,160
but two of them have drawback of not

807
00:37:30,240 --> 00:37:34,160
checking certificates in the pls

808
00:37:34,960 --> 00:37:42,079
and having this misconfiguration

809
00:37:38,560 --> 00:37:45,119
developed in the while what could we do

810
00:37:42,079 --> 00:37:48,960
to fix such a misconception

811
00:37:45,119 --> 00:37:52,160
so as simple answer is for a proper fix

812
00:37:48,960 --> 00:37:52,560
proper certificate validation then we

813
00:37:52,160 --> 00:37:56,720
should

814
00:37:52,560 --> 00:38:00,640
provide tlc validation should be

815
00:37:56,720 --> 00:38:03,359
correct and then the tlc management

816
00:38:00,640 --> 00:38:04,480
should have the correct suitable

817
00:38:03,359 --> 00:38:06,640
certificate you see

818
00:38:04,480 --> 00:38:08,000
and this is a selected field and the

819
00:38:06,640 --> 00:38:10,160
matching field

820
00:38:08,000 --> 00:38:11,119
for the particular and suitable

821
00:38:10,160 --> 00:38:14,240
certificate

822
00:38:11,119 --> 00:38:14,960
that we are using that is if it's a host

823
00:38:14,240 --> 00:38:18,399
or a trust

824
00:38:14,960 --> 00:38:22,160
and the generated certificate we should

825
00:38:18,400 --> 00:38:22,160
decide properly on which

826
00:38:22,480 --> 00:38:27,200
certificate usage and selector and or in

827
00:38:25,280 --> 00:38:32,240
general tls management should be

828
00:38:27,200 --> 00:38:35,520
done and

829
00:38:32,240 --> 00:38:38,879
to have a proper tlsr record deployed uh

830
00:38:35,520 --> 00:38:41,280
the dns must be deployed correctly

831
00:38:38,880 --> 00:38:41,920
and also the important thing is that the

832
00:38:41,280 --> 00:38:45,200
dns

833
00:38:41,920 --> 00:38:46,160
keys should be rolled over and we should

834
00:38:45,200 --> 00:38:51,279
not let it

835
00:38:46,160 --> 00:38:53,440
expire right and um

836
00:38:51,280 --> 00:38:55,200
we should also deploy a ds record

837
00:38:53,440 --> 00:38:59,440
properly in the dns

838
00:38:55,200 --> 00:39:00,078
chain and as as it mentions the dns key

839
00:38:59,440 --> 00:39:02,880
must be

840
00:39:00,079 --> 00:39:04,800
signed by its privacy and which

841
00:39:02,880 --> 00:39:06,480
corresponds to the publishing in the dns

842
00:39:04,800 --> 00:39:09,359
protocol and

843
00:39:06,480 --> 00:39:12,720
on this record and the parent game is

844
00:39:09,359 --> 00:39:12,720
going to create a change of trust

845
00:39:13,040 --> 00:39:16,880
so in the long term what we should look

846
00:39:16,560 --> 00:39:20,240
into

847
00:39:16,880 --> 00:39:21,200
right so deployed in a sec on our

848
00:39:20,240 --> 00:39:24,799
production

849
00:39:21,200 --> 00:39:27,598
domains if it's not already

850
00:39:24,800 --> 00:39:29,359
and publish tlc record for your own

851
00:39:27,599 --> 00:39:32,640
empty certificates

852
00:39:29,359 --> 00:39:34,400
and make sure that these certificates

853
00:39:32,640 --> 00:39:36,879
are rolled over so that they never

854
00:39:34,400 --> 00:39:41,520
expires

855
00:39:36,880 --> 00:39:43,680
apart from this configuration that can

856
00:39:41,520 --> 00:39:44,880
so happen the long term we would like

857
00:39:43,680 --> 00:39:48,000
all of the player

858
00:39:44,880 --> 00:39:51,680
text to be turned off and to be

859
00:39:48,000 --> 00:39:55,359
encrypted so that's it

860
00:39:51,680 --> 00:39:59,040
for today and i i only scratched

861
00:39:55,359 --> 00:40:01,920
the surface of the entire time plus smtp

862
00:39:59,040 --> 00:40:02,720
uh ecosystem there is more to find and

863
00:40:01,920 --> 00:40:05,920
you can find

864
00:40:02,720 --> 00:40:08,240
a lot more details in our paper which

865
00:40:05,920 --> 00:40:08,960
is mentioned in this in this slide as

866
00:40:08,240 --> 00:40:11,598
well

867
00:40:08,960 --> 00:40:12,079
and if you have any questions feel free

868
00:40:11,599 --> 00:40:14,319
to

869
00:40:12,079 --> 00:40:15,680
reach out to me through twitter i'll be

870
00:40:14,319 --> 00:40:19,839
happy to help you

871
00:40:15,680 --> 00:40:25,839
and yeah that's it for today

872
00:40:19,839 --> 00:40:25,839
i'm happy to take any questions

873
00:40:31,220 --> 00:40:34,270
[Music]

874
00:40:45,760 --> 00:40:49,680
thank you very much for that fascinating

875
00:40:48,160 --> 00:40:51,598
when you're talking about dns

876
00:40:49,680 --> 00:40:54,000
uh i must admit it reminds me of the

877
00:40:51,599 --> 00:40:57,760
last time i worked on dns which was with

878
00:40:54,000 --> 00:41:00,240
windows nt4 so uh just to

879
00:40:57,760 --> 00:41:01,839
date myself there a little uh we do have

880
00:41:00,240 --> 00:41:07,359
a couple of questions

881
00:41:01,839 --> 00:41:09,440
uh so we have one from

882
00:41:07,359 --> 00:41:12,960
i just put up on the screen how can i

883
00:41:09,440 --> 00:41:12,960
test start tls

884
00:41:13,119 --> 00:41:15,359
so

885
00:41:17,040 --> 00:41:23,200
basically what we if you are deploying

886
00:41:20,079 --> 00:41:25,359
us smtp server we can

887
00:41:23,200 --> 00:41:26,640
for instance we use uh tools like

888
00:41:25,359 --> 00:41:29,279
hostfix for example

889
00:41:26,640 --> 00:41:30,078
in our studio we use hostfix which is a

890
00:41:29,280 --> 00:41:34,079
smtp

891
00:41:30,079 --> 00:41:37,440
mta we could uh

892
00:41:34,079 --> 00:41:40,560
and those kind of uh tools generally

893
00:41:37,440 --> 00:41:44,000
generate locks for instance so when

894
00:41:40,560 --> 00:41:47,279
when we deploy postfix we could

895
00:41:44,000 --> 00:41:50,640
actually have a configuration done

896
00:41:47,280 --> 00:41:52,560
in their config files and say that it

897
00:41:50,640 --> 00:41:56,000
should support start ls

898
00:41:52,560 --> 00:41:56,560
and once that is done and when we are

899
00:41:56,000 --> 00:41:59,599
actually

900
00:41:56,560 --> 00:42:01,440
sending email to the smtp server we

901
00:41:59,599 --> 00:42:04,560
could see in the launch that

902
00:42:01,440 --> 00:42:06,800
the communication is with starting

903
00:42:04,560 --> 00:42:08,560
i hope that answers your question and if

904
00:42:06,800 --> 00:42:09,280
not i'm happy to help you more in the

905
00:42:08,560 --> 00:42:12,160
snap channel

906
00:42:09,280 --> 00:42:13,760
if you are here fantastic uh they did

907
00:42:12,160 --> 00:42:15,520
have another question it may

908
00:42:13,760 --> 00:42:17,520
you may have answered it but can you

909
00:42:15,520 --> 00:42:19,119
explain more about start tls by giving

910
00:42:17,520 --> 00:42:20,880
an example

911
00:42:19,119 --> 00:42:22,319
or is or is that something for the slack

912
00:42:20,880 --> 00:42:26,319
channel

913
00:42:22,319 --> 00:42:28,160
yeah i think something okay so

914
00:42:26,319 --> 00:42:30,480
just head for the slack channel we have

915
00:42:28,160 --> 00:42:32,879
one more question um

916
00:42:30,480 --> 00:42:34,640
as for start tls you said need downgrade

917
00:42:32,880 --> 00:42:36,480
resistance how can i do it

918
00:42:34,640 --> 00:42:38,799
popular software such as thunderbird can

919
00:42:36,480 --> 00:42:38,800
do it

920
00:42:39,280 --> 00:42:47,440
um so thunderbird is an email client

921
00:42:43,680 --> 00:42:50,078
so uh so the client should also

922
00:42:47,440 --> 00:42:51,359
deploy a mechanism where they should

923
00:42:50,079 --> 00:42:54,480
advertise that

924
00:42:51,359 --> 00:42:56,400
they are also supporting start tls

925
00:42:54,480 --> 00:42:57,920
and the servers that we are trying to

926
00:42:56,400 --> 00:43:00,079
connect with uh

927
00:42:57,920 --> 00:43:01,280
should also say that start als is

928
00:43:00,079 --> 00:43:04,400
deployed

929
00:43:01,280 --> 00:43:07,440
so when a star when

930
00:43:04,400 --> 00:43:10,839
that kind of communication happens then

931
00:43:07,440 --> 00:43:12,640
uh then it's only there is only where

932
00:43:10,839 --> 00:43:14,880
our

933
00:43:12,640 --> 00:43:16,799
yeah that is only where the second

934
00:43:14,880 --> 00:43:19,839
channel exists

935
00:43:16,800 --> 00:43:21,839
and uh start als is not downgrade

936
00:43:19,839 --> 00:43:24,880
resistant it is downward distance

937
00:43:21,839 --> 00:43:28,160
that's what i was speaking about because

938
00:43:24,880 --> 00:43:32,160
star tls41 is an optional feature

939
00:43:28,160 --> 00:43:34,000
so we could uh if if start ls is not

940
00:43:32,160 --> 00:43:37,440
supported by one of the mbt

941
00:43:34,000 --> 00:43:41,920
it could just say that um let's not have

942
00:43:37,440 --> 00:43:44,480
uh the communication of star tls and

943
00:43:41,920 --> 00:43:45,040
yeah and all their communication

944
00:43:44,480 --> 00:43:48,720
channels

945
00:43:45,040 --> 00:43:52,400
could go through the plain text

946
00:43:48,720 --> 00:43:55,040
right so start als is not

947
00:43:52,400 --> 00:43:55,839
downgraded system that's one main point

948
00:43:55,040 --> 00:43:58,400
to

949
00:43:55,839 --> 00:44:00,640
keep in mind and that's why we have to

950
00:43:58,400 --> 00:44:03,839
bring in

951
00:44:00,640 --> 00:44:04,560
bringing dame and dns and the first off

952
00:44:03,839 --> 00:44:07,599
chain

953
00:44:04,560 --> 00:44:10,319
command into the whole scenario

954
00:44:07,599 --> 00:44:11,839
i hope that house once is experienced so

955
00:44:10,319 --> 00:44:14,400
it's not actually free to

956
00:44:11,839 --> 00:44:15,680
open me up in the slack channel yeah we

957
00:44:14,400 --> 00:44:19,520
can discuss more

958
00:44:15,680 --> 00:44:20,399
with examples on uh we can discuss more

959
00:44:19,520 --> 00:44:23,759
on the examples

960
00:44:20,400 --> 00:44:26,160
with the configuration files and how the

961
00:44:23,760 --> 00:44:27,119
logs can look like something which

962
00:44:26,160 --> 00:44:29,839
validates how

963
00:44:27,119 --> 00:44:32,240
a scatial communication actually looks

964
00:44:29,839 --> 00:44:32,240
in the way

965
00:44:33,119 --> 00:44:36,640
excellent thank you very much thank you

966
00:44:35,839 --> 00:44:38,319
so much

967
00:44:36,640 --> 00:44:40,480
for your presentation you get the

968
00:44:38,319 --> 00:44:43,119
virtual applause and the

969
00:44:40,480 --> 00:44:48,720
applause again because you can't hear us

970
00:44:43,119 --> 00:44:48,720
all applauding so you just get to

