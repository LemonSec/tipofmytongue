1
00:00:02,560 --> 00:00:09,010
<font color="#CCCCCC">yeah so hello everyone my name is not</font>

2
00:00:06,939 --> 00:00:10,629
the easiest one I think<font color="#CCCCCC"> for Germans</font><font color="#E5E5E5"> but</font>

3
00:00:09,010 --> 00:00:13,030
<font color="#CCCCCC">I</font><font color="#E5E5E5"> think they Spanish and the</font><font color="#CCCCCC"> Paraguayans</font>

4
00:00:10,629 --> 00:00:14,530
that are in the room<font color="#E5E5E5"> should be</font><font color="#CCCCCC"> able</font><font color="#E5E5E5"> to</font>

5
00:00:13,030 --> 00:00:17,890
<font color="#CCCCCC">cook better</font><font color="#E5E5E5"> with my name the Portuguese</font>

6
00:00:14,530 --> 00:00:19,930
one as well so so how is basically John

7
00:00:17,890 --> 00:00:24,640
or Johan or your harness or whatever you

8
00:00:19,930 --> 00:00:26,830
want<font color="#E5E5E5"> I will go for</font><font color="#CCCCCC"> it yeah</font><font color="#E5E5E5"> we just</font><font color="#CCCCCC"> had a</font>

9
00:00:24,640 --> 00:00:29,670
short introduction I'm going<font color="#CCCCCC"> to be I'm</font>

10
00:00:26,830 --> 00:00:32,019
going<font color="#E5E5E5"> to be talking about baseline</font>

11
00:00:29,670 --> 00:00:34,180
capability<font color="#E5E5E5"> basically how old you start</font>

12
00:00:32,020 --> 00:00:39,219
something<font color="#CCCCCC"> simple</font><font color="#E5E5E5"> till you run that with</font>

13
00:00:34,180 --> 00:00:41,829
based detection yeah<font color="#CCCCCC"> they</font><font color="#E5E5E5"> I have this</font>

14
00:00:39,219 --> 00:00:43,059
obligatory Who am I<font color="#CCCCCC"> so</font><font color="#E5E5E5"> physically I'm</font>

15
00:00:41,829 --> 00:00:44,739
<font color="#CCCCCC">Brazilian that's why I have this strange</font>

16
00:00:43,059 --> 00:00:47,919
name<font color="#E5E5E5"> I'm not a football player</font>

17
00:00:44,739 --> 00:00:49,599
<font color="#CCCCCC">unfortunately I'm an IT guy they're</font>

18
00:00:47,920 --> 00:00:53,019
working<font color="#E5E5E5"> for German for</font><font color="#CCCCCC"> further</font><font color="#E5E5E5"> telecom</font>

19
00:00:49,600 --> 00:00:56,920
since 2010<font color="#CCCCCC"> based</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> Oldenburg</font><font color="#E5E5E5"> actually</font>

20
00:00:53,019 --> 00:00:59,498
between<font color="#E5E5E5"> your bag and bone yeah I'm doing</font>

21
00:00:56,920 --> 00:01:01,269
a lot<font color="#CCCCCC"> of network security</font><font color="#E5E5E5"> and network</font>

22
00:00:59,499 --> 00:01:04,659
for<font color="#CCCCCC"> the network forensics</font><font color="#E5E5E5"> internet</font>

23
00:01:01,269 --> 00:01:06,400
response<font color="#E5E5E5"> collaboration</font><font color="#CCCCCC"> I like talking to</font>

24
00:01:04,659 --> 00:01:08,530
<font color="#CCCCCC">people that's</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> think one of the great</font>

25
00:01:06,400 --> 00:01:10,840
things here from from besides this open

26
00:01:08,530 --> 00:01:12,729
actions platform that we<font color="#CCCCCC"> have just</font><font color="#E5E5E5"> like</font>

27
00:01:10,840 --> 00:01:15,460
to be able<font color="#CCCCCC"> to meet the guys we're really</font>

28
00:01:12,729 --> 00:01:17,170
working<font color="#E5E5E5"> in related stuff in exchange and</font>

29
00:01:15,460 --> 00:01:19,320
then get<font color="#E5E5E5"> our ideas</font><font color="#CCCCCC"> and discussed and</font>

30
00:01:17,170 --> 00:01:21,969
develop them together it's a great<font color="#CCCCCC"> thing</font>

31
00:01:19,320 --> 00:01:29,229
<font color="#CCCCCC">yeah and I love sailing let's just</font><font color="#E5E5E5"> both</font>

32
00:01:21,969 --> 00:01:30,758
<font color="#E5E5E5">myself just to set the scenes 25 minutes</font>

33
00:01:29,229 --> 00:01:34,119
I<font color="#CCCCCC"> think that's the biggest challenge of</font>

34
00:01:30,759 --> 00:01:36,520
the<font color="#E5E5E5"> day because I think most of you like</font>

35
00:01:34,119 --> 00:01:39,280
this kind of stuff<font color="#E5E5E5"> and are also curious</font>

36
00:01:36,520 --> 00:01:41,170
persons like I am but that's<font color="#E5E5E5"> the hard</font>

37
00:01:39,280 --> 00:01:43,299
part<font color="#CCCCCC"> as a Brazilian especially because</font>

38
00:01:41,170 --> 00:01:44,530
the Brazilian<font color="#E5E5E5"> state to talk too much</font><font color="#CCCCCC"> so</font>

39
00:01:43,299 --> 00:01:49,840
that's<font color="#E5E5E5"> why</font><font color="#CCCCCC"> I'll try</font><font color="#E5E5E5"> to keep it to the</font>

40
00:01:44,530 --> 00:01:52,240
point yeah so certainly since<font color="#CCCCCC"> the motor</font>

41
00:01:49,840 --> 00:01:53,979
<font color="#E5E5E5">base detection so basically I'm not</font><font color="#CCCCCC"> the</font>

42
00:01:52,240 --> 00:01:55,750
net<font color="#E5E5E5"> I'm not the host</font><font color="#CCCCCC"> pissed guy I'm</font><font color="#E5E5E5"> the</font>

43
00:01:53,979 --> 00:01:58,390
guy<font color="#E5E5E5"> always looking at packets and bits</font>

44
00:01:55,750 --> 00:01:59,259
and<font color="#E5E5E5"> fields and</font><font color="#CCCCCC"> this kind of stuff</font><font color="#E5E5E5"> and</font>

45
00:01:58,390 --> 00:02:02,619
I'm talking<font color="#CCCCCC"> about the baseline</font>

46
00:01:59,259 --> 00:02:05,170
<font color="#CCCCCC">capability</font><font color="#E5E5E5"> that means how to start your</font>

47
00:02:02,619 --> 00:02:06,850
how to cook<font color="#E5E5E5"> your own brew here if you</font>

48
00:02:05,170 --> 00:02:10,750
want<font color="#E5E5E5"> to do some network based detection</font>

49
00:02:06,850 --> 00:02:13,000
<font color="#CCCCCC">a network based</font><font color="#E5E5E5"> foreign sixth on the</font>

50
00:02:10,750 --> 00:02:14,440
proposal<font color="#E5E5E5"> III</font><font color="#CCCCCC"> evasion I would like to</font>

51
00:02:13,000 --> 00:02:15,750
<font color="#E5E5E5">bring you some some tools and</font><font color="#CCCCCC"> some ideas</font>

52
00:02:14,440 --> 00:02:18,510
<font color="#CCCCCC">out</font><font color="#E5E5E5"> really</font>

53
00:02:15,750 --> 00:02:21,150
<font color="#E5E5E5">some kind of a stepping stones really</font>

54
00:02:18,510 --> 00:02:26,549
<font color="#E5E5E5">start doing</font><font color="#CCCCCC"> this because</font><font color="#E5E5E5"> I think that's</font>

55
00:02:21,150 --> 00:02:27,780
<font color="#E5E5E5">that's easy it's not</font><font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> effort</font><font color="#CCCCCC"> and</font>

56
00:02:26,550 --> 00:02:31,140
you're gonna<font color="#E5E5E5"> get a lot of data for</font>

57
00:02:27,780 --> 00:02:34,730
detecting<font color="#E5E5E5"> incidents</font><font color="#CCCCCC"> and that's the idea</font>

58
00:02:31,140 --> 00:02:37,739
<font color="#CCCCCC">so</font><font color="#E5E5E5"> basically I'll show you some tools</font>

59
00:02:34,730 --> 00:02:39,480
patterns and<font color="#E5E5E5"> really some tricks to get</font>

60
00:02:37,740 --> 00:02:45,050
you<font color="#CCCCCC"> started so that that was basically</font>

61
00:02:39,480 --> 00:02:47,100
the<font color="#CCCCCC"> idea</font><font color="#E5E5E5"> for today yeah some</font>

62
00:02:45,050 --> 00:02:49,050
introduction and concepts because I

63
00:02:47,100 --> 00:02:51,209
think<font color="#E5E5E5"> they are important when you</font>

64
00:02:49,050 --> 00:02:54,180
discuss<font color="#CCCCCC"> network</font><font color="#E5E5E5"> when we discuss network</font>

65
00:02:51,209 --> 00:02:58,410
based detection why is this<font color="#E5E5E5"> thing</font>

66
00:02:54,180 --> 00:03:01,290
important in my opinion<font color="#E5E5E5"> and to the best</font>

67
00:02:58,410 --> 00:03:03,120
<font color="#E5E5E5">of my knowledge</font><font color="#CCCCCC"> um</font><font color="#E5E5E5"> most of you will</font>

68
00:03:01,290 --> 00:03:05,209
already have<font color="#E5E5E5"> the assets that are</font>

69
00:03:03,120 --> 00:03:09,600
necessary to<font color="#CCCCCC"> run this</font><font color="#E5E5E5"> kind of capability</font>

70
00:03:05,209 --> 00:03:11,520
you have switches you have routers you

71
00:03:09,600 --> 00:03:13,530
have some servers proxies and<font color="#CCCCCC"> whatever</font>

72
00:03:11,520 --> 00:03:15,770
that you<font color="#E5E5E5"> can configure them to generate</font>

73
00:03:13,530 --> 00:03:18,360
the data<font color="#CCCCCC"> you need</font><font color="#E5E5E5"> so this is</font><font color="#CCCCCC"> gonna be</font>

74
00:03:15,770 --> 00:03:20,519
from from in terms<font color="#E5E5E5"> of investment not not</font>

75
00:03:18,360 --> 00:03:22,800
not<font color="#CCCCCC"> a very big</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> why I</font>

76
00:03:20,519 --> 00:03:24,120
think<font color="#E5E5E5"> that's important</font><font color="#CCCCCC"> to set it</font><font color="#E5E5E5"> up if</font>

77
00:03:22,800 --> 00:03:25,350
you<font color="#CCCCCC"> are running a</font><font color="#E5E5E5"> smaller mid-sized</font>

78
00:03:24,120 --> 00:03:27,810
environment<font color="#E5E5E5"> it's also not very</font>

79
00:03:25,350 --> 00:03:29,459
<font color="#E5E5E5">complicated to get this thing ready to</font>

80
00:03:27,810 --> 00:03:31,860
<font color="#E5E5E5">get to talk to operations and convince</font>

81
00:03:29,459 --> 00:03:34,100
them that you as a<font color="#CCCCCC"> security analyst a</font>

82
00:03:31,860 --> 00:03:36,540
security responder whatever<font color="#E5E5E5"> security</font>

83
00:03:34,100 --> 00:03:38,430
<font color="#CCCCCC">that you need this information to be</font>

84
00:03:36,540 --> 00:03:41,880
<font color="#E5E5E5">generating that device</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> before the</font>

85
00:03:38,430 --> 00:03:44,970
some kind of<font color="#E5E5E5"> server on</font><font color="#CCCCCC"> your site and I</font>

86
00:03:41,880 --> 00:03:47,579
think<font color="#E5E5E5"> comparing comparing this network</font>

87
00:03:44,970 --> 00:03:52,080
based detection and host<font color="#E5E5E5"> based detection</font>

88
00:03:47,580 --> 00:03:54,870
basically to put<font color="#E5E5E5"> it very</font><font color="#CCCCCC"> simple parallel</font>

89
00:03:52,080 --> 00:03:57,600
parallel<font color="#E5E5E5"> and I would say firewalls and</font>

90
00:03:54,870 --> 00:03:58,140
antivirus am considering network based

91
00:03:57,600 --> 00:04:00,510
detection

92
00:03:58,140 --> 00:04:02,820
I think they typically the efforts<font color="#E5E5E5"> to</font>

93
00:04:00,510 --> 00:04:05,820
set up a<font color="#E5E5E5"> network to set up a host based</font>

94
00:04:02,820 --> 00:04:08,340
<font color="#E5E5E5">detection capabilities higher than a</font>

95
00:04:05,820 --> 00:04:11,100
network based capability<font color="#E5E5E5"> they complement</font>

96
00:04:08,340 --> 00:04:13,140
each other in<font color="#E5E5E5"> a certain</font><font color="#CCCCCC"> way and I think</font>

97
00:04:11,100 --> 00:04:16,320
the point here<font color="#CCCCCC"> is really and</font><font color="#E5E5E5"> also</font><font color="#CCCCCC"> maybe</font>

98
00:04:13,140 --> 00:04:18,570
<font color="#E5E5E5">a question to you who on your side is</font>

99
00:04:16,320 --> 00:04:22,370
already<font color="#E5E5E5"> able</font><font color="#CCCCCC"> to run host pace detection</font>

100
00:04:18,570 --> 00:04:25,110
or it has<font color="#E5E5E5"> some kind of a host based</font>

101
00:04:22,370 --> 00:04:27,840
forensic agent or host<font color="#E5E5E5"> based Incident</font>

102
00:04:25,110 --> 00:04:28,729
<font color="#E5E5E5">Response capability like there is a new</font>

103
00:04:27,840 --> 00:04:30,650
indicator coming

104
00:04:28,729 --> 00:04:32,539
some kind of a registry key or some kind

105
00:04:30,650 --> 00:04:35,568
of a service<font color="#E5E5E5"> driver or whatever</font><font color="#CCCCCC"> file</font>

106
00:04:32,539 --> 00:04:36,860
hash and in my<font color="#CCCCCC"> opinion and that's</font><font color="#E5E5E5"> maybe</font>

107
00:04:35,569 --> 00:04:38,719
a question<font color="#E5E5E5"> of you that would be</font>

108
00:04:36,860 --> 00:04:40,520
<font color="#E5E5E5">interesting to see how many</font><font color="#CCCCCC"> of you</font>

109
00:04:38,719 --> 00:04:42,979
already<font color="#E5E5E5"> have this kind of</font><font color="#CCCCCC"> capability in</font>

110
00:04:40,520 --> 00:04:44,839
<font color="#CCCCCC">your</font><font color="#E5E5E5"> environment are you able to run on</font>

111
00:04:42,979 --> 00:04:46,460
all<font color="#E5E5E5"> your machines to research whether</font>

112
00:04:44,839 --> 00:04:48,830
these machines<font color="#E5E5E5"> have a certain registry</font>

113
00:04:46,460 --> 00:04:50,979
key or certain<font color="#CCCCCC"> the networked</font><font color="#E5E5E5"> device or</font>

114
00:04:48,830 --> 00:04:53,270
<font color="#CCCCCC">sucking</font><font color="#E5E5E5"> and drive or certain</font>

115
00:04:50,979 --> 00:04:55,039
configuration on a<font color="#CCCCCC"> Windows File</font><font color="#E5E5E5"> is this</font>

116
00:04:53,270 --> 00:04:57,438
<font color="#E5E5E5">something that you all have or it is</font>

117
00:04:55,039 --> 00:05:00,188
something that we're<font color="#CCCCCC"> thinking about</font><font color="#E5E5E5"> it</font>

118
00:04:57,439 --> 00:05:00,189
but we<font color="#CCCCCC"> don't have it yet</font>

119
00:05:00,580 --> 00:05:09,558
<font color="#E5E5E5">no that's no one raises the hand one at</font>

120
00:05:03,740 --> 00:05:11,899
<font color="#E5E5E5">least one okay</font><font color="#CCCCCC"> I also have them but I</font>

121
00:05:09,559 --> 00:05:15,439
think<font color="#E5E5E5"> that the reflects simply my point</font>

122
00:05:11,899 --> 00:05:17,210
<font color="#E5E5E5">it is not there and for the network</font>

123
00:05:15,439 --> 00:05:20,330
<font color="#E5E5E5">based detection these things are already</font>

124
00:05:17,210 --> 00:05:21,919
<font color="#E5E5E5">there so</font><font color="#CCCCCC"> that's why I think</font><font color="#E5E5E5"> that's a</font>

125
00:05:20,330 --> 00:05:23,919
<font color="#E5E5E5">low-hanging fruit that's why</font><font color="#CCCCCC"> that was</font>

126
00:05:21,919 --> 00:05:28,849
also<font color="#E5E5E5"> the idea behind this presentation</font>

127
00:05:23,919 --> 00:05:31,068
but in the end<font color="#CCCCCC"> um I don't like this kind</font>

128
00:05:28,849 --> 00:05:32,810
<font color="#CCCCCC">of pictures</font><font color="#E5E5E5"> because they can be easily</font>

129
00:05:31,069 --> 00:05:36,529
we've seen definite but anyway how<font color="#E5E5E5"> to</font>

130
00:05:32,810 --> 00:05:39,169
how<font color="#CCCCCC"> those things fit together</font><font color="#E5E5E5"> and some</font>

131
00:05:36,529 --> 00:05:42,949
kind of a very generic<font color="#E5E5E5"> process here for</font>

132
00:05:39,169 --> 00:05:44,810
<font color="#E5E5E5">doing</font><font color="#CCCCCC"> Network face detection and that's</font>

133
00:05:42,949 --> 00:05:46,279
unavoidable<font color="#CCCCCC"> you have to start by the</font>

134
00:05:44,810 --> 00:05:48,889
recent<font color="#CCCCCC"> red modeling you have to</font>

135
00:05:46,279 --> 00:05:50,719
understand what kind<font color="#CCCCCC"> of variability do</font>

136
00:05:48,889 --> 00:05:53,779
you have what kind<font color="#E5E5E5"> of attackers are</font>

137
00:05:50,719 --> 00:05:55,639
going to be after<font color="#E5E5E5"> those data how does</font>

138
00:05:53,779 --> 00:05:57,439
the<font color="#E5E5E5"> business works and what are the</font>

139
00:05:55,639 --> 00:05:59,240
<font color="#E5E5E5">things that are really that must be</font>

140
00:05:57,439 --> 00:06:02,330
<font color="#E5E5E5">protected</font><font color="#CCCCCC"> so that</font><font color="#E5E5E5"> you can really</font>

141
00:05:59,240 --> 00:06:04,550
understand and start start<font color="#E5E5E5"> doing your</font>

142
00:06:02,330 --> 00:06:07,209
preparation like to understand your kind

143
00:06:04,550 --> 00:06:09,529
of patterns and<font color="#E5E5E5"> can I</font><font color="#CCCCCC"> use to</font><font color="#E5E5E5"> detect to</font>

144
00:06:07,209 --> 00:06:10,449
<font color="#CCCCCC">the deck</font><font color="#E5E5E5"> breach to detect attacker</font>

145
00:06:09,529 --> 00:06:12,860
activities

146
00:06:10,449 --> 00:06:14,389
what is the technically relevant data

147
00:06:12,860 --> 00:06:17,659
that I need<font color="#CCCCCC"> to collect</font><font color="#E5E5E5"> to support this</font>

148
00:06:14,389 --> 00:06:19,129
kind of detection<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then you go for</font>

149
00:06:17,659 --> 00:06:21,319
<font color="#E5E5E5">the collection so basically the things</font>

150
00:06:19,129 --> 00:06:23,599
that you said okay those these networks

151
00:06:21,319 --> 00:06:25,729
<font color="#E5E5E5">these kind</font><font color="#CCCCCC"> of protocols are very</font>

152
00:06:23,599 --> 00:06:29,509
<font color="#E5E5E5">important in my environment so</font><font color="#CCCCCC"> I need to</font>

153
00:06:25,729 --> 00:06:31,580
<font color="#CCCCCC">to start gathering this data I need to</font>

154
00:06:29,509 --> 00:06:33,680
transform<font color="#E5E5E5"> it somehow</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> consolidate</font>

155
00:06:31,580 --> 00:06:35,839
basically in the<font color="#E5E5E5"> future</font><font color="#CCCCCC"> it's stuff which</font>

156
00:06:33,680 --> 00:06:38,839
is<font color="#CCCCCC"> not important and again you have this</font>

157
00:06:35,839 --> 00:06:41,209
presentation<font color="#E5E5E5"> layer to our phrase from a</font>

158
00:06:38,839 --> 00:06:41,700
<font color="#CCCCCC">wi-fi's</font><font color="#E5E5E5"> I think most likely</font><font color="#CCCCCC"> no one will</font>

159
00:06:41,209 --> 00:06:44,130
be<font color="#CCCCCC"> looking</font>

160
00:06:41,700 --> 00:06:46,830
<font color="#CCCCCC">- those things that's a</font><font color="#E5E5E5"> cover chance of</font>

161
00:06:44,130 --> 00:06:49,620
wonderful one<font color="#E5E5E5"> similarly to this one</font>

162
00:06:46,830 --> 00:06:51,450
<font color="#CCCCCC">DNS tunneling</font><font color="#E5E5E5"> I'm going to talk a little</font>

163
00:06:49,620 --> 00:06:53,400
<font color="#E5E5E5">bit about the</font><font color="#CCCCCC"> nesting later on how to</font>

164
00:06:51,450 --> 00:06:58,860
detect<font color="#E5E5E5"> this at least how to detect</font>

165
00:06:53,400 --> 00:07:01,169
anomalies over DNS protocol that's why I

166
00:06:58,860 --> 00:07:04,140
mean you have to consider<font color="#E5E5E5"> again</font><font color="#CCCCCC"> what is</font>

167
00:07:01,170 --> 00:07:05,940
my<font color="#CCCCCC"> technically relevant data that I need</font>

168
00:07:04,140 --> 00:07:10,050
to<font color="#E5E5E5"> cover here so that I can detect this</font>

169
00:07:05,940 --> 00:07:11,790
kind<font color="#CCCCCC"> of attacks and then you end up some</font>

170
00:07:10,050 --> 00:07:13,560
<font color="#E5E5E5">do some archiving from these famous</font>

171
00:07:11,790 --> 00:07:14,550
consolidating them storing them and

172
00:07:13,560 --> 00:07:17,150
<font color="#E5E5E5">destroying any things that</font><font color="#CCCCCC"> you don't</font>

173
00:07:14,550 --> 00:07:19,860
that you're not allowed<font color="#CCCCCC"> to store and</font>

174
00:07:17,150 --> 00:07:22,200
after<font color="#E5E5E5"> when you</font><font color="#CCCCCC"> have these things running</font>

175
00:07:19,860 --> 00:07:23,670
<font color="#E5E5E5">you start doing your detection running</font>

176
00:07:22,200 --> 00:07:26,250
these patterns against<font color="#E5E5E5"> those data that</font>

177
00:07:23,670 --> 00:07:28,950
you have used to<font color="#E5E5E5"> some people's</font>

178
00:07:26,250 --> 00:07:31,740
<font color="#E5E5E5">authorization evaluation is data to</font>

179
00:07:28,950 --> 00:07:33,900
detect<font color="#E5E5E5"> problems or to detective may be</font>

180
00:07:31,740 --> 00:07:35,730
weak spots that's one important<font color="#CCCCCC"> thing</font>

181
00:07:33,900 --> 00:07:38,190
here really<font color="#E5E5E5"> to understand</font><font color="#CCCCCC"> okay if I'm</font>

182
00:07:35,730 --> 00:07:40,620
not collecting<font color="#CCCCCC"> the layer two frames that</font>

183
00:07:38,190 --> 00:07:42,240
<font color="#CCCCCC">I've thought and</font><font color="#E5E5E5"> you according</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> my</font>

184
00:07:40,620 --> 00:07:44,190
<font color="#CCCCCC">dread modeling they're</font><font color="#E5E5E5"> not important for</font>

185
00:07:42,240 --> 00:07:46,710
my environment<font color="#E5E5E5"> but when someone comes</font>

186
00:07:44,190 --> 00:07:48,540
and slaps me<font color="#CCCCCC"> on the face hey it's</font>

187
00:07:46,710 --> 00:07:52,320
important for you then that's the point

188
00:07:48,540 --> 00:07:54,270
<font color="#E5E5E5">you document them put them back there</font>

189
00:07:52,320 --> 00:07:57,150
and<font color="#CCCCCC"> start it from starting</font><font color="#E5E5E5"> over so</font>

190
00:07:54,270 --> 00:08:00,000
basically I<font color="#E5E5E5"> think Mike did this analogy</font>

191
00:07:57,150 --> 00:08:02,219
<font color="#CCCCCC">of sharpen your knives</font><font color="#E5E5E5"> that's again</font>

192
00:08:00,000 --> 00:08:05,550
that's<font color="#CCCCCC"> about it just go and sharpen your</font>

193
00:08:02,220 --> 00:08:08,970
knife reevaluate your threat model and

194
00:08:05,550 --> 00:08:10,560
start it over<font color="#E5E5E5"> I think these kind of</font>

195
00:08:08,970 --> 00:08:12,230
slides<font color="#E5E5E5"> you can talk hours about this you</font>

196
00:08:10,560 --> 00:08:14,640
can discuss we can improve you can

197
00:08:12,230 --> 00:08:17,490
expand them but today<font color="#CCCCCC"> I think we can do</font>

198
00:08:14,640 --> 00:08:19,020
<font color="#E5E5E5">it later on on the</font><font color="#CCCCCC"> on the off side but</font>

199
00:08:17,490 --> 00:08:20,760
it's basically something<font color="#E5E5E5"> very generic</font>

200
00:08:19,020 --> 00:08:21,450
just to understand<font color="#E5E5E5"> how those things fit</font>

201
00:08:20,760 --> 00:08:27,360
<font color="#E5E5E5">together</font>

202
00:08:21,450 --> 00:08:31,170
oh so far<font color="#CCCCCC"> it's so</font><font color="#E5E5E5"> good or any questions</font>

203
00:08:27,360 --> 00:08:33,419
<font color="#CCCCCC">of comment so far ok great</font><font color="#E5E5E5"> so about data</font>

204
00:08:31,170 --> 00:08:34,979
collection<font color="#E5E5E5"> two very important</font><font color="#CCCCCC"> points</font>

205
00:08:33,419 --> 00:08:37,709
about data collection<font color="#E5E5E5"> that</font><font color="#CCCCCC"> are</font>

206
00:08:34,979 --> 00:08:39,750
unavoidable<font color="#E5E5E5"> in my opinion if I don't if</font>

207
00:08:37,710 --> 00:08:42,540
<font color="#E5E5E5">you</font><font color="#CCCCCC"> don't have the proper data you won't</font>

208
00:08:39,750 --> 00:08:45,300
have<font color="#E5E5E5"> visibility and again this layer</font><font color="#CCCCCC"> two</font>

209
00:08:42,539 --> 00:08:47,099
example here you're<font color="#E5E5E5"> not collecting guns</font>

210
00:08:45,300 --> 00:08:49,709
you want<font color="#CCCCCC"> see you won't</font><font color="#E5E5E5"> be able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> detect</font>

211
00:08:47,100 --> 00:08:51,990
<font color="#E5E5E5">um there is also</font><font color="#CCCCCC"> not a slap on</font><font color="#E5E5E5"> the face</font>

212
00:08:49,710 --> 00:08:53,850
<font color="#E5E5E5">these reports from the</font><font color="#CCCCCC"> Swiss defense</font>

213
00:08:51,990 --> 00:08:56,730
company which is<font color="#E5E5E5"> actually a</font><font color="#CCCCCC"> Fanta</font>

214
00:08:53,850 --> 00:08:59,970
the document to learn<font color="#CCCCCC"> about the text to</font>

215
00:08:56,730 --> 00:09:01,470
learn about resourceful actors I don't

216
00:08:59,970 --> 00:09:03,870
like using a<font color="#E5E5E5"> PT's for that but</font>

217
00:09:01,470 --> 00:09:05,790
<font color="#CCCCCC">resourceful actors</font><font color="#E5E5E5"> what the</font>

218
00:09:03,870 --> 00:09:07,470
<font color="#E5E5E5">investigation and how did the rareness</font>

219
00:09:05,790 --> 00:09:09,209
one of the things that was in this

220
00:09:07,470 --> 00:09:13,639
report<font color="#CCCCCC"> I'm not sure if you're familiar</font>

221
00:09:09,209 --> 00:09:16,560
<font color="#E5E5E5">with</font><font color="#CCCCCC"> is a new-agey company rule buggy</font>

222
00:09:13,639 --> 00:09:19,860
<font color="#CCCCCC">one of the one of</font><font color="#E5E5E5"> the quotations that</font>

223
00:09:16,560 --> 00:09:25,290
<font color="#CCCCCC">are</font><font color="#E5E5E5"> risk or</font><font color="#CCCCCC"> that I reported this</font>

224
00:09:19,860 --> 00:09:30,329
document is there is there's a point

225
00:09:25,290 --> 00:09:33,120
that<font color="#E5E5E5"> I say we don't know</font><font color="#CCCCCC"> exactly the the</font>

226
00:09:30,329 --> 00:09:36,779
current that<font color="#CCCCCC"> or the day the actual</font><font color="#E5E5E5"> entry</font>

227
00:09:33,120 --> 00:09:38,100
point no networks<font color="#CCCCCC"> because</font><font color="#E5E5E5"> and the</font>

228
00:09:36,779 --> 00:09:40,319
quotation<font color="#CCCCCC"> that</font><font color="#E5E5E5"> they have is nevertheless</font>

229
00:09:38,100 --> 00:09:42,720
the key aspects of the case could not be

230
00:09:40,319 --> 00:09:45,509
clarified to<font color="#E5E5E5"> an availability of to an</font>

231
00:09:42,720 --> 00:09:48,720
availability to an<font color="#E5E5E5"> availability of log</font>

232
00:09:45,509 --> 00:09:50,850
data<font color="#E5E5E5"> prior to this period to basically</font>

233
00:09:48,720 --> 00:09:54,779
take the healthier they had they had log

234
00:09:50,850 --> 00:09:56,790
data until<font color="#E5E5E5"> September 2014 but they could</font>

235
00:09:54,779 --> 00:09:59,459
not<font color="#E5E5E5"> look in the past so that's why they</font>

236
00:09:56,790 --> 00:10:00,990
really<font color="#E5E5E5"> at some point they said</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we</font>

237
00:09:59,459 --> 00:10:02,939
cannot understand<font color="#E5E5E5"> we cannot have the</font>

238
00:10:00,990 --> 00:10:04,889
full picture of<font color="#CCCCCC"> the attack because we</font>

239
00:10:02,939 --> 00:10:05,730
don't<font color="#E5E5E5"> have the data and that's something</font>

240
00:10:04,889 --> 00:10:09,120
<font color="#CCCCCC">to consider</font>

241
00:10:05,730 --> 00:10:12,029
<font color="#CCCCCC">sometimes management says</font><font color="#E5E5E5"> we don't</font><font color="#CCCCCC"> have</font>

242
00:10:09,120 --> 00:10:15,060
<font color="#CCCCCC">this much</font><font color="#E5E5E5"> this big server for for the</font>

243
00:10:12,029 --> 00:10:16,980
log storage that you want you want<font color="#CCCCCC"> you</font>

244
00:10:15,060 --> 00:10:20,819
<font color="#CCCCCC">wanna be able</font><font color="#E5E5E5"> to store six months of log</font>

245
00:10:16,980 --> 00:10:22,649
<font color="#CCCCCC">written and</font><font color="#E5E5E5"> you say okay that's your</font>

246
00:10:20,819 --> 00:10:24,599
call<font color="#CCCCCC"> not Michael and advising you to</font>

247
00:10:22,649 --> 00:10:26,519
<font color="#E5E5E5">store but if you don't want look at what</font>

248
00:10:24,600 --> 00:10:29,160
happened to those guys so something<font color="#E5E5E5"> to</font>

249
00:10:26,519 --> 00:10:31,050
<font color="#E5E5E5">help you as a defender it's interesting</font>

250
00:10:29,160 --> 00:10:35,670
to take a<font color="#E5E5E5"> look at this document</font><font color="#CCCCCC"> second</font>

251
00:10:31,050 --> 00:10:37,469
point data collection<font color="#E5E5E5"> sometimes message</font>

252
00:10:35,670 --> 00:10:41,849
content is not<font color="#E5E5E5"> available</font><font color="#CCCCCC"> we talked a lot</font>

253
00:10:37,470 --> 00:10:44,910
today about<font color="#E5E5E5"> HTTPS and encryption which</font>

254
00:10:41,850 --> 00:10:46,589
is a great<font color="#E5E5E5"> thing and in these cases</font><font color="#CCCCCC"> it's</font>

255
00:10:44,910 --> 00:10:49,079
unavoidable<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> think no one</font><font color="#E5E5E5"> should be</font>

256
00:10:46,589 --> 00:10:51,120
doing normally<font color="#CCCCCC"> that's the case</font><font color="#E5E5E5"> that no</font>

257
00:10:49,079 --> 00:10:52,920
one should<font color="#E5E5E5"> be doing she said</font><font color="#CCCCCC"> it's should</font>

258
00:10:51,120 --> 00:10:54,660
<font color="#E5E5E5">be breaking</font><font color="#CCCCCC"> TLS on properties or</font>

259
00:10:52,920 --> 00:10:56,550
whatever<font color="#E5E5E5"> and that's the point</font>

260
00:10:54,660 --> 00:10:59,060
if the code<font color="#CCCCCC"> it's not available you go</font>

261
00:10:56,550 --> 00:11:02,339
for the<font color="#CCCCCC"> meta data for instance you can</font>

262
00:10:59,060 --> 00:11:04,529
fairly well reconstruction reconstruct a

263
00:11:02,339 --> 00:11:06,370
web session<font color="#E5E5E5"> by looking</font><font color="#CCCCCC"> into what kind of</font>

264
00:11:04,529 --> 00:11:09,279
requests the size and what

265
00:11:06,370 --> 00:11:11,140
DNS DNS resolution took place<font color="#E5E5E5"> on to the</font>

266
00:11:09,279 --> 00:11:16,689
point<font color="#E5E5E5"> so that that is something</font><font color="#CCCCCC"> that</font>

267
00:11:11,140 --> 00:11:18,610
that<font color="#E5E5E5"> could be complimented considering</font>

268
00:11:16,690 --> 00:11:19,420
<font color="#CCCCCC">Network forensics</font><font color="#E5E5E5"> a network based</font>

269
00:11:18,610 --> 00:11:22,800
<font color="#E5E5E5">detection</font>

270
00:11:19,420 --> 00:11:24,459
what kind of artifacts<font color="#E5E5E5"> we have typically</font>

271
00:11:22,800 --> 00:11:25,990
<font color="#E5E5E5">have</font><font color="#CCCCCC"> pickups</font>

272
00:11:24,460 --> 00:11:27,339
I just wanted to<font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> because</font>

273
00:11:25,990 --> 00:11:30,190
<font color="#E5E5E5">this is</font><font color="#CCCCCC"> not these</font><font color="#E5E5E5"> network quality</font>

274
00:11:27,339 --> 00:11:31,630
<font color="#E5E5E5">sometimes kind of a black box for people</font>

275
00:11:30,190 --> 00:11:34,170
who are doing web development or or

276
00:11:31,630 --> 00:11:36,570
related stuff but not really<font color="#E5E5E5"> into this</font>

277
00:11:34,170 --> 00:11:38,500
basically there are<font color="#E5E5E5"> three types of</font>

278
00:11:36,570 --> 00:11:40,779
artifacts<font color="#CCCCCC"> that are that</font><font color="#E5E5E5"> are used</font>

279
00:11:38,500 --> 00:11:42,460
commonly<font color="#E5E5E5"> packet captures this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> pcap</font>

280
00:11:40,779 --> 00:11:45,040
everywhere a city kept in<font color="#E5E5E5"> this</font>

281
00:11:42,460 --> 00:11:48,279
presentation<font color="#CCCCCC"> I have net flow which is</font>

282
00:11:45,040 --> 00:11:49,779
<font color="#E5E5E5">somehow</font><font color="#CCCCCC"> very Network</font><font color="#E5E5E5"> bound so basically</font>

283
00:11:48,279 --> 00:11:51,640
people<font color="#CCCCCC"> who never</font><font color="#E5E5E5"> did</font><font color="#CCCCCC"> anything with</font>

284
00:11:49,779 --> 00:11:54,029
<font color="#CCCCCC">network the most</font><font color="#E5E5E5"> likely won't here</font>

285
00:11:51,640 --> 00:11:56,500
wouldn't<font color="#E5E5E5"> know what that that's basically</font>

286
00:11:54,029 --> 00:12:01,450
metadata<font color="#CCCCCC"> about packets and sessions that</font>

287
00:11:56,500 --> 00:12:02,800
were<font color="#E5E5E5"> run of the network</font><font color="#CCCCCC"> there</font><font color="#E5E5E5"> is no</font>

288
00:12:01,450 --> 00:12:04,450
message content here again it's just

289
00:12:02,800 --> 00:12:06,400
<font color="#E5E5E5">like a</font><font color="#CCCCCC"> P</font><font color="#E5E5E5"> address how many packets how</font>

290
00:12:04,450 --> 00:12:11,290
many bytes<font color="#CCCCCC"> went to each endpoint</font><font color="#E5E5E5"> and so</font>

291
00:12:06,400 --> 00:12:13,839
<font color="#E5E5E5">on and log events basically events that</font>

292
00:12:11,290 --> 00:12:15,400
could<font color="#E5E5E5"> be security relevant about some</font>

293
00:12:13,839 --> 00:12:18,520
<font color="#E5E5E5">kind of network or some kind</font><font color="#CCCCCC"> of systems</font>

294
00:12:15,400 --> 00:12:20,110
that's basically the three types<font color="#E5E5E5"> of</font>

295
00:12:18,520 --> 00:12:23,439
artifacts that<font color="#CCCCCC"> you need to</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> with</font>

296
00:12:20,110 --> 00:12:25,600
these<font color="#E5E5E5"> things</font><font color="#CCCCCC"> and then we've started</font>

297
00:12:23,440 --> 00:12:27,370
focusing<font color="#E5E5E5"> on this</font><font color="#CCCCCC"> we're</font><font color="#E5E5E5"> talking about the</font>

298
00:12:25,600 --> 00:12:29,440
<font color="#E5E5E5">baseline</font><font color="#CCCCCC"> I'll start talking to packet</font>

299
00:12:27,370 --> 00:12:30,730
capture<font color="#E5E5E5"> because of my opinion that's</font>

300
00:12:29,440 --> 00:12:37,120
more<font color="#CCCCCC"> tangible</font><font color="#E5E5E5"> that's how you should</font>

301
00:12:30,730 --> 00:12:39,700
<font color="#E5E5E5">start okay one first overview about data</font>

302
00:12:37,120 --> 00:12:41,920
<font color="#CCCCCC">collection and I try</font><font color="#E5E5E5"> to put</font><font color="#CCCCCC"> okay some</font>

303
00:12:39,700 --> 00:12:44,560
ideas<font color="#CCCCCC"> about</font><font color="#E5E5E5"> how to do data collection</font>

304
00:12:41,920 --> 00:12:46,180
what kind of tools and<font color="#E5E5E5"> when I say data</font>

305
00:12:44,560 --> 00:12:50,739
<font color="#E5E5E5">collection can be</font><font color="#CCCCCC"> either traffic</font><font color="#E5E5E5"> related</font>

306
00:12:46,180 --> 00:12:53,079
data or metadata<font color="#E5E5E5"> about not perfect and I</font>

307
00:12:50,740 --> 00:12:54,459
<font color="#CCCCCC">think some tools some examples basically</font>

308
00:12:53,080 --> 00:12:56,260
<font color="#CCCCCC">um for traffic</font>

309
00:12:54,459 --> 00:12:58,180
what's the artifact<font color="#E5E5E5"> we discussed a</font>

310
00:12:56,260 --> 00:13:00,069
little<font color="#E5E5E5"> bit so pick up data source</font>

311
00:12:58,180 --> 00:13:03,640
digital<font color="#CCCCCC"> network tabs</font><font color="#E5E5E5"> or network</font>

312
00:13:00,070 --> 00:13:06,130
interface cards collection tools<font color="#CCCCCC"> are</font>

313
00:13:03,640 --> 00:13:08,220
<font color="#E5E5E5">software</font><font color="#CCCCCC"> you need for</font><font color="#E5E5E5"> that basically to</font>

314
00:13:06,130 --> 00:13:10,720
speed up which is basically they

315
00:13:08,220 --> 00:13:14,260
baseline to get these things<font color="#E5E5E5"> done right</font>

316
00:13:10,720 --> 00:13:16,810
<font color="#CCCCCC">flow net flow exporters net flow</font>

317
00:13:14,260 --> 00:13:19,270
exporters basically the device that can

318
00:13:16,810 --> 00:13:19,989
generate net flow records can be fire

319
00:13:19,270 --> 00:13:25,000
<font color="#CCCCCC">off</font>

320
00:13:19,990 --> 00:13:27,760
switches routers and so on likely also

321
00:13:25,000 --> 00:13:30,730
to be applies or harder device

322
00:13:27,760 --> 00:13:32,830
configuration<font color="#E5E5E5"> there are some files like</font>

323
00:13:30,730 --> 00:13:34,800
<font color="#CCCCCC">a PF sense that K generate these kind of</font>

324
00:13:32,830 --> 00:13:36,790
<font color="#E5E5E5">records as well they are very</font><font color="#CCCCCC"> useful for</font>

325
00:13:34,800 --> 00:13:38,890
clarification for instance of data

326
00:13:36,790 --> 00:13:42,640
exfiltration<font color="#CCCCCC"> analysis has something</font><font color="#E5E5E5"> very</font>

327
00:13:38,890 --> 00:13:44,380
<font color="#E5E5E5">easy food um there's</font><font color="#CCCCCC"> Linux tool that is</font>

328
00:13:42,640 --> 00:13:47,350
<font color="#E5E5E5">able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> generate this kind of</font>

329
00:13:44,380 --> 00:13:50,320
information<font color="#E5E5E5"> from a network interface or</font>

330
00:13:47,350 --> 00:13:52,380
from a<font color="#CCCCCC"> pic</font><font color="#E5E5E5"> app it's</font><font color="#CCCCCC"> very interesting</font><font color="#E5E5E5"> to</font>

331
00:13:50,320 --> 00:13:55,779
start<font color="#E5E5E5"> playing with</font><font color="#CCCCCC"> this if you know</font>

332
00:13:52,380 --> 00:13:57,220
<font color="#CCCCCC">enough about logs um I think this</font><font color="#E5E5E5"> is the</font>

333
00:13:55,779 --> 00:14:02,680
common place<font color="#CCCCCC"> a</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't</font><font color="#CCCCCC"> need to</font>

334
00:13:57,220 --> 00:14:04,300
explain<font color="#CCCCCC"> what is a web server log um the</font>

335
00:14:02,680 --> 00:14:08,260
typical case in<font color="#E5E5E5"> talking cane about the</font>

336
00:14:04,300 --> 00:14:10,569
<font color="#CCCCCC">base line you never</font><font color="#E5E5E5"> did it what you have</font>

337
00:14:08,260 --> 00:14:12,160
to do for disappea done for<font color="#E5E5E5"> instance</font>

338
00:14:10,570 --> 00:14:15,070
<font color="#E5E5E5">considering</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you have some kind of</font>

339
00:14:12,160 --> 00:14:16,810
interface card<font color="#CCCCCC"> you</font><font color="#E5E5E5"> packet capture you</font>

340
00:14:15,070 --> 00:14:19,990
don't want to do any DNS resolution

341
00:14:16,810 --> 00:14:21,369
while<font color="#E5E5E5"> in capture you just this kind of</font>

342
00:14:19,990 --> 00:14:25,950
switch<font color="#CCCCCC"> here</font><font color="#E5E5E5"> just kind</font><font color="#CCCCCC"> of a ready-made</font>

343
00:14:21,370 --> 00:14:28,810
recipe<font color="#E5E5E5"> you're generating for</font>

344
00:14:25,950 --> 00:14:31,630
<font color="#E5E5E5">wasted for one hour that's a</font><font color="#CCCCCC"> seconds</font>

345
00:14:28,810 --> 00:14:34,180
here and<font color="#CCCCCC"> you're capturing</font><font color="#E5E5E5"> to it for 24</font>

346
00:14:31,630 --> 00:14:36,910
of those captures and generate 25 files

347
00:14:34,180 --> 00:14:39,609
for 1rh and you rename<font color="#CCCCCC"> you're naming</font>

348
00:14:36,910 --> 00:14:41,160
<font color="#E5E5E5">them with a proper name with the date</font>

349
00:14:39,610 --> 00:14:43,450
and<font color="#CCCCCC"> so basically just something</font>

350
00:14:41,160 --> 00:14:46,839
ready-made for you to start<font color="#E5E5E5"> using if</font>

351
00:14:43,450 --> 00:14:49,420
you're not doing<font color="#E5E5E5"> this if you have some</font>

352
00:14:46,839 --> 00:14:50,890
pickups<font color="#E5E5E5"> laying around</font><font color="#CCCCCC"> ok someone is</font>

353
00:14:49,420 --> 00:14:53,370
doing traffic capture for you your

354
00:14:50,890 --> 00:14:55,930
<font color="#E5E5E5">incident responder</font><font color="#CCCCCC"> you get in there</font>

355
00:14:53,370 --> 00:14:58,120
<font color="#E5E5E5">there are already pickups and you need</font>

356
00:14:55,930 --> 00:14:59,949
to filter<font color="#E5E5E5"> out data you could use also</font>

357
00:14:58,120 --> 00:15:01,870
<font color="#CCCCCC">disappeared um to filter out data just</font>

358
00:14:59,950 --> 00:15:03,790
<font color="#E5E5E5">to focus on certain hosts or certain</font>

359
00:15:01,870 --> 00:15:08,110
networks that are relevant for<font color="#CCCCCC"> a CID</font>

360
00:15:03,790 --> 00:15:10,620
investigation and I'm trying to<font color="#E5E5E5"> speed up</font>

361
00:15:08,110 --> 00:15:13,589
<font color="#E5E5E5">as much as I can</font>

362
00:15:10,620 --> 00:15:16,079
play the conversion I think<font color="#CCCCCC"> punchline is</font>

363
00:15:13,589 --> 00:15:18,870
<font color="#E5E5E5">really</font><font color="#CCCCCC"> T shark the shark is a kind of a</font>

364
00:15:16,079 --> 00:15:20,310
<font color="#E5E5E5">common line version</font><font color="#CCCCCC"> of a shark</font><font color="#E5E5E5"> and this</font>

365
00:15:18,870 --> 00:15:22,800
is kind of a very<font color="#E5E5E5"> interesting because</font>

366
00:15:20,310 --> 00:15:24,660
the shark has the same protocols

367
00:15:22,800 --> 00:15:27,329
<font color="#E5E5E5">implemented as</font><font color="#CCCCCC"> Wireshark so basically</font>

368
00:15:24,660 --> 00:15:29,339
this kind<font color="#E5E5E5"> of nifty tool will</font><font color="#CCCCCC"> give you</font>

369
00:15:27,329 --> 00:15:31,319
these all<font color="#E5E5E5"> these protocol fields from</font>

370
00:15:29,339 --> 00:15:34,470
<font color="#E5E5E5">layer to layer 3 until application layer</font>

371
00:15:31,319 --> 00:15:36,979
protocol suits<font color="#E5E5E5"> up the way to go to start</font>

372
00:15:34,470 --> 00:15:39,990
doing<font color="#E5E5E5"> these things just an example here</font>

373
00:15:36,980 --> 00:15:42,509
<font color="#E5E5E5">using T shark</font><font color="#CCCCCC"> point it</font><font color="#E5E5E5"> to some kind</font><font color="#CCCCCC"> of</font>

374
00:15:39,990 --> 00:15:44,819
<font color="#E5E5E5">already existing</font><font color="#CCCCCC"> recap I'm not capturing</font>

375
00:15:42,509 --> 00:15:47,850
<font color="#E5E5E5">life like data from</font><font color="#CCCCCC"> network and I'm</font>

376
00:15:44,819 --> 00:15:50,519
focusing on<font color="#E5E5E5"> what kind of Danis traffic</font>

377
00:15:47,850 --> 00:15:54,240
is<font color="#E5E5E5"> going on here filtering out some kind</font>

378
00:15:50,519 --> 00:15:57,540
of a layer<font color="#E5E5E5"> 3 multicast stuff</font><font color="#CCCCCC"> a similar</font>

379
00:15:54,240 --> 00:16:00,720
<font color="#E5E5E5">example how to inspect HTTP gaps that</font>

380
00:15:57,540 --> 00:16:02,939
happened in the past<font color="#E5E5E5"> and the shark can</font>

381
00:16:00,720 --> 00:16:06,839
also<font color="#E5E5E5"> put</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> data in JSON format which</font>

382
00:16:02,939 --> 00:16:08,399
<font color="#CCCCCC">is great for elastic</font><font color="#E5E5E5"> search some basic</font>

383
00:16:06,839 --> 00:16:12,000
detection patterns and I'm really

384
00:16:08,399 --> 00:16:13,980
running up here now threat hunting and I

385
00:16:12,000 --> 00:16:16,019
think we can skip<font color="#E5E5E5"> this because I</font><font color="#CCCCCC"> think</font>

386
00:16:13,980 --> 00:16:19,649
<font color="#E5E5E5">this would be pretty straightforward to</font>

387
00:16:16,019 --> 00:16:22,980
explain but anyway what I<font color="#E5E5E5"> call</font><font color="#CCCCCC"> DNS 1 2 3</font>

388
00:16:19,649 --> 00:16:25,019
<font color="#E5E5E5">if you do India s based hunting</font><font color="#CCCCCC"> there</font>

389
00:16:22,980 --> 00:16:27,750
are some pretty<font color="#E5E5E5"> cool stuff that you</font>

390
00:16:25,019 --> 00:16:32,880
<font color="#E5E5E5">could use to detect for instance DNS</font>

391
00:16:27,750 --> 00:16:35,250
tunneling if you want to inspect<font color="#E5E5E5"> all the</font>

392
00:16:32,880 --> 00:16:37,339
fqdn stay fully qualified domain names

393
00:16:35,250 --> 00:16:40,079
the host names that appeared<font color="#E5E5E5"> on your</font>

394
00:16:37,339 --> 00:16:41,939
network or on a traffic capture that<font color="#E5E5E5"> you</font>

395
00:16:40,079 --> 00:16:43,589
already<font color="#E5E5E5"> have then you could run</font>

396
00:16:41,939 --> 00:16:46,380
<font color="#E5E5E5">something like</font><font color="#CCCCCC"> this which is basically</font>

397
00:16:43,589 --> 00:16:49,279
telling<font color="#CCCCCC"> me T shark</font><font color="#E5E5E5"> to show me what kind</font>

398
00:16:46,380 --> 00:16:53,250
<font color="#CCCCCC">of query names like the maps.google.com</font>

399
00:16:49,279 --> 00:16:55,410
<font color="#E5E5E5">were triggered by</font><font color="#CCCCCC"> n points</font><font color="#E5E5E5"> and so</font><font color="#CCCCCC"> on and</font>

400
00:16:53,250 --> 00:16:57,000
I could also<font color="#E5E5E5"> look on the entropy of</font>

401
00:16:55,410 --> 00:16:59,130
<font color="#E5E5E5">those labels</font><font color="#CCCCCC"> like everything which is</font>

402
00:16:57,000 --> 00:17:02,160
<font color="#CCCCCC">between the dots to see</font><font color="#E5E5E5"> when I'm doing</font>

403
00:16:59,130 --> 00:17:03,990
tunneling<font color="#E5E5E5"> I need to unavoidably have a</font>

404
00:17:02,160 --> 00:17:07,109
high entropy<font color="#CCCCCC"> induce</font><font color="#E5E5E5"> labor so that</font><font color="#CCCCCC"> I can</font>

405
00:17:03,990 --> 00:17:08,609
code<font color="#CCCCCC"> theta in as much</font><font color="#E5E5E5"> as many bits as</font>

406
00:17:07,109 --> 00:17:10,948
possible so<font color="#E5E5E5"> basically increase the</font>

407
00:17:08,609 --> 00:17:13,678
bandwidth my<font color="#E5E5E5"> tunnel so that's a kind</font><font color="#CCCCCC"> of</font>

408
00:17:10,949 --> 00:17:18,689
a ready-made recipe for for<font color="#E5E5E5"> doing that</font>

409
00:17:13,679 --> 00:17:22,470
<font color="#CCCCCC">again the rate of txt records</font><font color="#E5E5E5"> or the</font>

410
00:17:18,689 --> 00:17:28,830
rate of<font color="#E5E5E5"> unusual record types</font>

411
00:17:22,470 --> 00:17:30,840
for dinner<font color="#E5E5E5"> stumbling basically the point</font>

412
00:17:28,830 --> 00:17:33,809
here is why should an<font color="#E5E5E5"> endpoint be</font>

413
00:17:30,840 --> 00:17:36,809
queried for a name server<font color="#E5E5E5"> because he has</font>

414
00:17:33,809 --> 00:17:38,549
written<font color="#CCCCCC"> into every network so that's</font>

415
00:17:36,809 --> 00:17:43,019
<font color="#E5E5E5">basically some some things that do not</font>

416
00:17:38,549 --> 00:17:46,320
<font color="#CCCCCC">happen or tunneling</font><font color="#E5E5E5"> typically</font><font color="#CCCCCC"> applies a</font>

417
00:17:43,019 --> 00:17:49,350
lot applies a<font color="#E5E5E5"> lot of</font><font color="#CCCCCC"> cname or some</font><font color="#E5E5E5"> text</font>

418
00:17:46,320 --> 00:17:50,700
<font color="#CCCCCC">records</font><font color="#E5E5E5"> that's why you how you detect</font>

419
00:17:49,350 --> 00:17:53,250
<font color="#E5E5E5">those things and do some kind</font><font color="#CCCCCC"> of</font>

420
00:17:50,700 --> 00:17:56,909
aggregation<font color="#CCCCCC"> a very simple</font><font color="#E5E5E5"> one actually</font>

421
00:17:53,250 --> 00:17:57,360
<font color="#E5E5E5">enough on a console</font><font color="#CCCCCC"> but this plastic</font>

422
00:17:56,909 --> 00:17:59,639
surgeon

423
00:17:57,360 --> 00:18:02,370
<font color="#CCCCCC">bhana</font><font color="#E5E5E5"> stack easily if you have</font><font color="#CCCCCC"> the data</font>

424
00:17:59,639 --> 00:18:04,860
generated<font color="#CCCCCC"> from</font><font color="#E5E5E5"> extracted from</font><font color="#CCCCCC"> T shark</font>

425
00:18:02,370 --> 00:18:06,508
<font color="#E5E5E5">using Jason pumping it down on your</font>

426
00:18:04,860 --> 00:18:08,100
analysis environment<font color="#E5E5E5"> and</font><font color="#CCCCCC"> run</font><font color="#E5E5E5"> the</font>

427
00:18:06,509 --> 00:18:12,120
analysis<font color="#CCCCCC"> on there</font>

428
00:18:08,100 --> 00:18:14,009
last one was non-existent domains<font color="#E5E5E5"> which</font>

429
00:18:12,120 --> 00:18:17,070
is basically<font color="#E5E5E5"> how to detect domain</font>

430
00:18:14,009 --> 00:18:18,809
generation operating<font color="#CCCCCC"> power domain</font>

431
00:18:17,070 --> 00:18:20,908
generation algorithm or will generate a

432
00:18:18,809 --> 00:18:24,450
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> let's say non existing domains</font>

433
00:18:20,909 --> 00:18:25,830
<font color="#E5E5E5">errors and this way you could aggravate</font>

434
00:18:24,450 --> 00:18:28,110
this information see what kind of

435
00:18:25,830 --> 00:18:31,019
<font color="#CCCCCC">endpoints have spikes</font><font color="#E5E5E5"> in this let's say</font>

436
00:18:28,110 --> 00:18:35,039
bad DNS queries<font color="#E5E5E5"> this way would be</font><font color="#CCCCCC"> able</font>

437
00:18:31,019 --> 00:18:38,970
<font color="#E5E5E5">to spot some effect DJ infected</font><font color="#CCCCCC"> hosts on</font>

438
00:18:35,039 --> 00:18:40,730
<font color="#E5E5E5">your on your networks that's</font><font color="#CCCCCC"> my point</font>

439
00:18:38,970 --> 00:18:47,360
here already knew that<font color="#CCCCCC"> this would</font><font color="#E5E5E5"> happen</font>

440
00:18:40,730 --> 00:18:49,860
<font color="#CCCCCC">I put their mastery</font><font color="#E5E5E5"> stuff I have a still</font>

441
00:18:47,360 --> 00:18:52,918
nice lights but I think that's it<font color="#E5E5E5"> we can</font>

442
00:18:49,860 --> 00:18:56,449
do<font color="#E5E5E5"> it on the on the off side yeah that's</font>

443
00:18:52,919 --> 00:18:56,450
basically the idea<font color="#CCCCCC"> questions</font>

444
00:18:58,440 --> 00:19:08,470
[Applause]

445
00:19:06,270 --> 00:19:19,050
<font color="#E5E5E5">I'm sue me you don't</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> any questions</font>

446
00:19:08,470 --> 00:19:19,050
you all know how to detect the<font color="#E5E5E5"> Argos</font><font color="#CCCCCC"> I</font>

447
00:19:22,020 --> 00:19:53,350
don't know this<font color="#E5E5E5"> - I mean is about to set</font>

448
00:19:50,710 --> 00:20:27,520
<font color="#E5E5E5">I mean when we all discuss - everyone</font>

449
00:19:53,350 --> 00:20:34,330
has their<font color="#CCCCCC"> favorite tools that any</font><font color="#E5E5E5"> other</font>

450
00:20:27,520 --> 00:20:37,270
questions what<font color="#CCCCCC"> about what about using</font>

451
00:20:34,330 --> 00:20:38,980
like passive<font color="#E5E5E5"> DNS I think is very</font>

452
00:20:37,270 --> 00:20:42,190
important - especially<font color="#CCCCCC"> for threat</font>

453
00:20:38,980 --> 00:20:43,870
<font color="#CCCCCC">intelligence to understand what happen</font>

454
00:20:42,190 --> 00:20:46,570
<font color="#E5E5E5">in the past</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> you if you're seeing some</font>

455
00:20:43,870 --> 00:20:49,030
kind<font color="#CCCCCC"> of</font><font color="#E5E5E5"> DNS resolution Network and you</font>

456
00:20:46,570 --> 00:20:52,450
<font color="#E5E5E5">say okay is this new but this IP address</font>

457
00:20:49,030 --> 00:20:54,940
<font color="#CCCCCC">and this domain name is fqdn combination</font>

458
00:20:52,450 --> 00:20:57,430
<font color="#E5E5E5">that</font><font color="#CCCCCC"> you see</font><font color="#E5E5E5"> yeah what happened in the</font>

459
00:20:54,940 --> 00:21:02,870
past<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> there's something there</font><font color="#E5E5E5"> is a</font>

460
00:20:57,430 --> 00:21:11,270
bit ago and<font color="#E5E5E5"> to understand</font>

461
00:21:02,870 --> 00:21:12,830
and I mean everyone doing passive<font color="#E5E5E5"> DNS in</font>

462
00:21:11,270 --> 00:21:14,900
their environments<font color="#CCCCCC"> it has this great</font>

463
00:21:12,830 --> 00:21:17,780
capability of being able<font color="#CCCCCC"> to look in</font><font color="#E5E5E5"> the</font>

464
00:21:14,900 --> 00:21:21,370
past<font color="#E5E5E5"> like if I see a combination</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> oh</font>

465
00:21:17,780 --> 00:21:23,840
if<font color="#E5E5E5"> we say New York address fqdn</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> can go</font>

466
00:21:21,370 --> 00:21:28,270
look into this database in<font color="#CCCCCC"> Skokie</font><font color="#E5E5E5"> but</font>

467
00:21:23,840 --> 00:21:28,270
how was this IP<font color="#E5E5E5"> address used in the past</font>

468
00:21:49,480 --> 00:21:54,380
we all would be able<font color="#E5E5E5"> to progress much</font>

469
00:21:52,190 --> 00:21:56,960
faster<font color="#E5E5E5"> if there were several of those</font>

470
00:21:54,380 --> 00:21:58,730
things<font color="#E5E5E5"> coming up yeah</font><font color="#CCCCCC"> portable residence</font>

471
00:21:56,960 --> 00:22:05,330
<font color="#E5E5E5">things that we learned during</font><font color="#CCCCCC"> hard times</font>

472
00:21:58,730 --> 00:22:08,870
and so the rule was breached and then

473
00:22:05,330 --> 00:22:11,960
the Swiss<font color="#E5E5E5"> 30</font><font color="#CCCCCC"> report going into the</font>

474
00:22:08,870 --> 00:22:14,479
details of<font color="#E5E5E5"> how</font><font color="#CCCCCC"> the breach you know to a</font>

475
00:22:11,960 --> 00:22:16,810
place and how well they don't know<font color="#CCCCCC"> it</font>

476
00:22:14,480 --> 00:22:19,310
<font color="#E5E5E5">the details of the exfiltration</font>

477
00:22:16,810 --> 00:22:20,780
<font color="#E5E5E5">everything they knew including</font><font color="#CCCCCC"> the</font>

478
00:22:19,310 --> 00:22:24,520
indicators that<font color="#CCCCCC"> could</font><font color="#E5E5E5"> be used by</font><font color="#CCCCCC"> other</font>

479
00:22:20,780 --> 00:22:24,520
organizations were included in<font color="#CCCCCC"> there</font>

480
00:22:26,740 --> 00:22:31,190
[Applause]

