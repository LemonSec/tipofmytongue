1
00:00:03,760 --> 00:00:06,319
thanks oliver hi guys thanks for

2
00:00:06,319 --> 00:00:08,720
attending our session from simple log to

3
00:00:08,720 --> 00:00:12,080
sophisticated crypto

4
00:00:12,480 --> 00:00:14,799
my name is arnold as already introduced

5
00:00:14,799 --> 00:00:16,320
i'm here with my friend and colleague

6
00:00:16,320 --> 00:00:18,000
hido

7
00:00:18,000 --> 00:00:20,560
and we both live in israel and work as

8
00:00:20,560 --> 00:00:22,400
malware and threat researchers at the

9
00:00:22,400 --> 00:00:24,000
company named

10
00:00:24,000 --> 00:00:26,080
morphysek

11
00:00:26,080 --> 00:00:27,519
and

12
00:00:27,519 --> 00:00:29,119
today we want to share with you our

13
00:00:29,119 --> 00:00:31,359
story on discovering the baba data

14
00:00:31,359 --> 00:00:32,640
crypto

15
00:00:32,640 --> 00:00:35,600
and we'll do so by showing you our point

16
00:00:35,600 --> 00:00:38,399
of view when we investigated something

17
00:00:38,399 --> 00:00:40,320
that might have been simple or

18
00:00:40,320 --> 00:00:42,640
irrelevant anomaly in one of our

19
00:00:42,640 --> 00:00:44,719
customers logs

20
00:00:44,719 --> 00:00:47,120
and later on we'll dive into the cryptos

21
00:00:47,120 --> 00:00:50,000
internals and understand how it works

22
00:00:50,000 --> 00:00:51,520
and

23
00:00:51,520 --> 00:00:53,920
how we use that information in order to

24
00:00:53,920 --> 00:00:56,640
uncover a major campaign that targets

25
00:00:56,640 --> 00:00:58,719
some nft communities

26
00:00:58,719 --> 00:01:00,800
including some additional campaigns that

27
00:01:00,800 --> 00:01:05,760
targets um the ukrainian entities

28
00:01:05,760 --> 00:01:08,560
but before we start let me say a couple

29
00:01:08,560 --> 00:01:10,560
of words on what the crypto is for those

30
00:01:10,560 --> 00:01:12,960
of you may not familiar with it

31
00:01:12,960 --> 00:01:15,759
um let's do it with an example

32
00:01:15,759 --> 00:01:18,159
let's say we have a threat actor that

33
00:01:18,159 --> 00:01:20,560
wants to use some open source

34
00:01:20,560 --> 00:01:23,040
information still for some of his

35
00:01:23,040 --> 00:01:24,799
criminal activities

36
00:01:24,799 --> 00:01:27,759
if you'll use it as is theoretically

37
00:01:27,759 --> 00:01:29,840
security solutions would be easily

38
00:01:29,840 --> 00:01:33,600
detecting it either by strings metadata

39
00:01:33,600 --> 00:01:36,400
or even some of the code blocks

40
00:01:36,400 --> 00:01:38,479
and that's exactly when crypters comes

41
00:01:38,479 --> 00:01:40,960
in handy they solve this problem by

42
00:01:40,960 --> 00:01:43,759
taking this malware or information

43
00:01:43,759 --> 00:01:45,680
stiller as an input

44
00:01:45,680 --> 00:01:48,399
and performing some obfuscation

45
00:01:48,399 --> 00:01:49,920
encryption

46
00:01:49,920 --> 00:01:51,840
and code manipulation

47
00:01:51,840 --> 00:01:54,720
and hopefully the output of decrypter is

48
00:01:54,720 --> 00:01:58,158
an undetected file

49
00:01:58,399 --> 00:02:00,799
without further ado let let our journey

50
00:02:00,799 --> 00:02:02,960
begin

51
00:02:02,960 --> 00:02:04,079
so

52
00:02:04,079 --> 00:02:07,119
one of our tasks security researchers is

53
00:02:07,119 --> 00:02:09,199
to keep track on current trends and

54
00:02:09,199 --> 00:02:11,520
understand the threat landscape and its

55
00:02:11,520 --> 00:02:12,720
evolution

56
00:02:12,720 --> 00:02:14,879
and in order to do so we use

57
00:02:14,879 --> 00:02:16,879
classifications to divide the massive

58
00:02:16,879 --> 00:02:19,920
amount of data we got from our customers

59
00:02:19,920 --> 00:02:22,959
into specific threats or behaviors

60
00:02:22,959 --> 00:02:25,599
and that helps us to cluster the data

61
00:02:25,599 --> 00:02:28,160
and follow trends more easily

62
00:02:28,160 --> 00:02:29,040
so

63
00:02:29,040 --> 00:02:31,760
one day while going through one of our

64
00:02:31,760 --> 00:02:34,400
customers logs

65
00:02:34,400 --> 00:02:37,599
and we came across an anomaly

66
00:02:37,599 --> 00:02:40,400
specifically it was a crypt which is an

67
00:02:40,400 --> 00:02:42,160
information stiller

68
00:02:42,160 --> 00:02:46,160
and at the time we had plenty of those

69
00:02:46,239 --> 00:02:48,800
infections but the thing that caught our

70
00:02:48,800 --> 00:02:50,959
eye was the fact that

71
00:02:50,959 --> 00:02:53,360
the infection chain that led to it was

72
00:02:53,360 --> 00:02:56,000
something that we haven't seen before

73
00:02:56,000 --> 00:02:58,560
and the

74
00:02:58,560 --> 00:03:01,599
the clipboard was being executed from an

75
00:03:01,599 --> 00:03:04,720
executable that was being signed from by

76
00:03:04,720 --> 00:03:06,159
so by

77
00:03:06,159 --> 00:03:10,399
microsoft which was legitimate

78
00:03:10,800 --> 00:03:13,040
and at this time we were

79
00:03:13,040 --> 00:03:16,480
taking those first aid ashes like

80
00:03:16,480 --> 00:03:18,959
every person in our field would do

81
00:03:18,959 --> 00:03:22,000
to violence total

82
00:03:22,720 --> 00:03:24,879
yeah and we are surprised to see a zero

83
00:03:24,879 --> 00:03:26,239
detection rate

84
00:03:26,239 --> 00:03:28,239
which means that no security solution

85
00:03:28,239 --> 00:03:30,840
was able to identify this file as a

86
00:03:30,840 --> 00:03:32,879
malicious and we were even more

87
00:03:32,879 --> 00:03:35,519
surprised to see that this was the case

88
00:03:35,519 --> 00:03:38,159
for multiple scans in a very long period

89
00:03:38,159 --> 00:03:39,200
of time

90
00:03:39,200 --> 00:03:41,440
we took an additional hash from one of

91
00:03:41,440 --> 00:03:43,360
our prevention logs

92
00:03:43,360 --> 00:03:47,200
and the result was the same

93
00:03:47,200 --> 00:03:48,000
so

94
00:03:48,000 --> 00:03:50,239
at this point we were extremely curious

95
00:03:50,239 --> 00:03:52,879
to understand how the crypto works and

96
00:03:52,879 --> 00:03:56,239
what keeps that low detection rate

97
00:03:56,239 --> 00:03:58,640
so in order to do so

98
00:03:58,640 --> 00:04:00,560
we need to get our ants dirty and dive

99
00:04:00,560 --> 00:04:01,599
into the

100
00:04:01,599 --> 00:04:03,599
cryptos internals so

101
00:04:03,599 --> 00:04:05,840
this is an example of how the infection

102
00:04:05,840 --> 00:04:08,239
chain looks and you can see that it's

103
00:04:08,239 --> 00:04:10,319
composed from several components and

104
00:04:10,319 --> 00:04:12,799
we'll explain each and every one of them

105
00:04:12,799 --> 00:04:14,959
let's start with the installer first

106
00:04:14,959 --> 00:04:16,639
stager

107
00:04:16,639 --> 00:04:19,600
and the installer starts with the

108
00:04:19,600 --> 00:04:22,320
decompressing its files into a newly

109
00:04:22,320 --> 00:04:24,639
allocated folder on the disk

110
00:04:24,639 --> 00:04:28,479
and this is how this folder looks and

111
00:04:28,479 --> 00:04:29,759
you can see that

112
00:04:29,759 --> 00:04:32,000
among

113
00:04:32,000 --> 00:04:33,199
it has

114
00:04:33,199 --> 00:04:36,160
um very files in that folder

115
00:04:36,160 --> 00:04:38,320
and among them

116
00:04:38,320 --> 00:04:40,639
most of them actually sorry are in fact

117
00:04:40,639 --> 00:04:41,600
the

118
00:04:41,600 --> 00:04:44,320
legitimate they belong to a legitimate

119
00:04:44,320 --> 00:04:45,919
application or some open source

120
00:04:45,919 --> 00:04:47,120
application

121
00:04:47,120 --> 00:04:50,000
and the ones that marked in red are

122
00:04:50,000 --> 00:04:53,360
belongs to the malicious infection chain

123
00:04:53,360 --> 00:04:55,840
once the clip the installer finishes its

124
00:04:55,840 --> 00:04:57,199
execution

125
00:04:57,199 --> 00:04:59,600
it calls the file marked

126
00:04:59,600 --> 00:05:01,919
as one

127
00:05:01,919 --> 00:05:05,120
the executable and this executable sole

128
00:05:05,120 --> 00:05:08,160
purpose is to invoke the

129
00:05:08,160 --> 00:05:09,840
export function of the next stage

130
00:05:09,840 --> 00:05:11,840
malicious dll

131
00:05:11,840 --> 00:05:14,080
and as you can see it does so with just

132
00:05:14,080 --> 00:05:15,919
a few lines of code

133
00:05:15,919 --> 00:05:18,560
that are placed at the very end of a log

134
00:05:18,560 --> 00:05:19,840
function

135
00:05:19,840 --> 00:05:21,440
whereas the rest of the code in that

136
00:05:21,440 --> 00:05:23,759
function is actually benign again

137
00:05:23,759 --> 00:05:26,560
belongs to legitimate application

138
00:05:26,560 --> 00:05:29,759
once this dll is being invoked

139
00:05:29,759 --> 00:05:31,919
it starts its execution

140
00:05:31,919 --> 00:05:35,039
by calling some sorry

141
00:05:35,039 --> 00:05:36,560
some additional

142
00:05:36,560 --> 00:05:40,160
dlls and this part in the crypto

143
00:05:40,160 --> 00:05:42,479
is written in a modular way that helps

144
00:05:42,479 --> 00:05:45,199
the cryptos users to

145
00:05:45,199 --> 00:05:47,360
choose which functionality they want to

146
00:05:47,360 --> 00:05:48,639
use

147
00:05:48,639 --> 00:05:50,240
for example the

148
00:05:50,240 --> 00:05:52,800
functionalities that we've seen or for

149
00:05:52,800 --> 00:05:54,160
example

150
00:05:54,160 --> 00:05:57,120
a dll that performs persistency in some

151
00:05:57,120 --> 00:05:58,880
various different ways

152
00:05:58,880 --> 00:06:00,560
and a dll that can download the

153
00:06:00,560 --> 00:06:02,639
additional malware

154
00:06:02,639 --> 00:06:04,639
and many more

155
00:06:04,639 --> 00:06:08,080
so once the dll finish calling those

156
00:06:08,080 --> 00:06:11,680
modules it will load a file

157
00:06:11,680 --> 00:06:13,759
from that

158
00:06:13,759 --> 00:06:16,000
folder to memory

159
00:06:16,000 --> 00:06:17,600
in this example it's an

160
00:06:17,600 --> 00:06:20,720
xml file but we've seen many other file

161
00:06:20,720 --> 00:06:24,479
formats such as pdf png

162
00:06:24,479 --> 00:06:26,960
and many more

163
00:06:26,960 --> 00:06:29,280
and this file is structured as the

164
00:06:29,280 --> 00:06:31,039
follows

165
00:06:31,039 --> 00:06:34,240
in between its legitimate xml strings we

166
00:06:34,240 --> 00:06:36,479
have the feldshell code

167
00:06:36,479 --> 00:06:38,240
later on we have a configuration

168
00:06:38,240 --> 00:06:40,800
structure and after that we have several

169
00:06:40,800 --> 00:06:41,680
of

170
00:06:41,680 --> 00:06:43,840
encrypted chunks

171
00:06:43,840 --> 00:06:45,199
and

172
00:06:45,199 --> 00:06:46,240
once the

173
00:06:46,240 --> 00:06:48,479
main dll reads and loads that file it

174
00:06:48,479 --> 00:06:52,560
will invoke the first shell code by

175
00:06:52,560 --> 00:06:55,840
holding a hard coded offset to it

176
00:06:55,840 --> 00:06:58,000
this shellcode has several

177
00:06:58,000 --> 00:06:59,840
functionalities

178
00:06:59,840 --> 00:07:01,840
one of them is to load the configuration

179
00:07:01,840 --> 00:07:05,039
structure that was placed in that xml

180
00:07:05,039 --> 00:07:07,120
and this configuration structure holds

181
00:07:07,120 --> 00:07:09,440
the decryption key

182
00:07:09,440 --> 00:07:12,240
and and the description key for those

183
00:07:12,240 --> 00:07:13,680
encrypted chunks

184
00:07:13,680 --> 00:07:17,199
and the offset and size in the

185
00:07:17,199 --> 00:07:19,199
on the on that file

186
00:07:19,199 --> 00:07:21,039
and after

187
00:07:21,039 --> 00:07:23,599
sorry those configurations those

188
00:07:23,599 --> 00:07:25,759
encrypted chunks are actually the final

189
00:07:25,759 --> 00:07:29,280
payload and the second stage shellcode

190
00:07:29,280 --> 00:07:31,599
and after

191
00:07:31,599 --> 00:07:33,520
loading the configuration structure it

192
00:07:33,520 --> 00:07:35,759
will decrypt those chunks and

193
00:07:35,759 --> 00:07:39,520
concatenating them to the original form

194
00:07:39,520 --> 00:07:41,599
then the decryption shellcode will

195
00:07:41,599 --> 00:07:44,319
invoke the second stage code which is

196
00:07:44,319 --> 00:07:45,360
the

197
00:07:45,360 --> 00:07:47,520
injection shell code

198
00:07:47,520 --> 00:07:50,000
and this injection shell code well is

199
00:07:50,000 --> 00:07:53,280
responsible for injecting the payload

200
00:07:53,280 --> 00:07:56,840
to the original process memory

201
00:07:56,840 --> 00:08:01,039
and after so well that's the

202
00:08:01,039 --> 00:08:03,199
high level overview on the infection

203
00:08:03,199 --> 00:08:06,240
chain but for those of you who want uh

204
00:08:06,240 --> 00:08:09,039
in-depth uh information on that crypto

205
00:08:09,039 --> 00:08:11,120
can check our blog

206
00:08:11,120 --> 00:08:13,840
for more information

207
00:08:14,400 --> 00:08:17,680
so why did we name it babadela

208
00:08:17,680 --> 00:08:19,759
the following is a code snippet from one

209
00:08:19,759 --> 00:08:21,919
of the shell codes specifically the

210
00:08:21,919 --> 00:08:24,479
second one the injection shell code

211
00:08:24,479 --> 00:08:27,120
and if you take a closer look you'll see

212
00:08:27,120 --> 00:08:30,560
that there is there are two um d words

213
00:08:30,560 --> 00:08:31,840
in there

214
00:08:31,840 --> 00:08:33,760
the one in green

215
00:08:33,760 --> 00:08:36,719
dead beef with a typo which is known to

216
00:08:36,719 --> 00:08:39,360
be used as a magic debug value

217
00:08:39,360 --> 00:08:42,320
and the second one in the red

218
00:08:42,320 --> 00:08:44,000
baba dada

219
00:08:44,000 --> 00:08:47,680
is in russian stands for grandma grandpa

220
00:08:47,680 --> 00:08:50,800
so it was an easy choice as there were

221
00:08:50,800 --> 00:08:53,680
no any other indicators

222
00:08:53,680 --> 00:08:56,560
to choose from

223
00:08:57,600 --> 00:09:00,800
moving on to what makes it so evasive

224
00:09:00,800 --> 00:09:02,000
well

225
00:09:02,000 --> 00:09:03,920
if you remember we have

226
00:09:03,920 --> 00:09:06,000
the code logic that is splitted to

227
00:09:06,000 --> 00:09:08,480
several dlls and

228
00:09:08,480 --> 00:09:11,839
those dlls are placed among many other

229
00:09:11,839 --> 00:09:14,800
legitimate files and the code in that in

230
00:09:14,800 --> 00:09:16,720
those dlls are

231
00:09:16,720 --> 00:09:21,040
placed again among many legitimate code

232
00:09:21,040 --> 00:09:23,839
and on top of that in your variants

233
00:09:23,839 --> 00:09:25,440
we've seen that

234
00:09:25,440 --> 00:09:28,720
the main dll is being loaded by a newer

235
00:09:28,720 --> 00:09:31,200
technique that called the cdl side

236
00:09:31,200 --> 00:09:32,399
loading

237
00:09:32,399 --> 00:09:34,160
which helps reducing the amount of

238
00:09:34,160 --> 00:09:36,480
malicious files on that folder by one

239
00:09:36,480 --> 00:09:37,279
and

240
00:09:37,279 --> 00:09:39,920
results in executing the final payload

241
00:09:39,920 --> 00:09:42,240
from legitimate forces as if you

242
00:09:42,240 --> 00:09:44,320
remember we've seen in our prevention

243
00:09:44,320 --> 00:09:46,240
log earlier

244
00:09:46,240 --> 00:09:47,600
and

245
00:09:47,600 --> 00:09:49,839
in addition we have the final payload

246
00:09:49,839 --> 00:09:52,160
and the second stage shellcode encrypted

247
00:09:52,160 --> 00:09:56,240
in some file format for example the xml

248
00:09:56,240 --> 00:09:57,200
and

249
00:09:57,200 --> 00:09:58,800
they are encrypted as i said and

250
00:09:58,800 --> 00:10:00,320
splitted

251
00:10:00,320 --> 00:10:03,279
so at this point we have the

252
00:10:03,279 --> 00:10:06,160
couple of vlogs from there we extracted

253
00:10:06,160 --> 00:10:07,440
some hashes

254
00:10:07,440 --> 00:10:08,240
and

255
00:10:08,240 --> 00:10:10,880
understand how the crypto works

256
00:10:10,880 --> 00:10:14,880
and i'll let you go continue from here

257
00:10:15,680 --> 00:10:16,839
thank you

258
00:10:16,839 --> 00:10:20,320
arnold so after understanding

259
00:10:20,320 --> 00:10:22,959
how the crypto works we had to figure

260
00:10:22,959 --> 00:10:26,560
out what our next steps

261
00:10:26,560 --> 00:10:28,640
i like to look at analysis and research

262
00:10:28,640 --> 00:10:30,480
as two different things

263
00:10:30,480 --> 00:10:32,480
in my in my point of view

264
00:10:32,480 --> 00:10:34,560
analysis is focused on a specific piece

265
00:10:34,560 --> 00:10:37,360
of malware or a specific task such as

266
00:10:37,360 --> 00:10:39,120
incident response

267
00:10:39,120 --> 00:10:40,560
on the other hand

268
00:10:40,560 --> 00:10:42,320
research is a broad field which is

269
00:10:42,320 --> 00:10:45,200
redirected as new information revealed

270
00:10:45,200 --> 00:10:47,920
that's actually exactly what happened in

271
00:10:47,920 --> 00:10:49,920
our research we started by looking at

272
00:10:49,920 --> 00:10:52,320
the baba data crypto itself and now we

273
00:10:52,320 --> 00:10:54,320
are moving on to find its usages in the

274
00:10:54,320 --> 00:10:56,720
wild

275
00:10:56,880 --> 00:10:58,560
at this point we have a pretty good

276
00:10:58,560 --> 00:11:01,040
understanding about the inner workings

277
00:11:01,040 --> 00:11:02,720
of the crypto

278
00:11:02,720 --> 00:11:05,200
we can use this knowledge to translate

279
00:11:05,200 --> 00:11:08,000
and translate it into a yahoo for those

280
00:11:08,000 --> 00:11:10,000
of you who don't know what a yahoo is

281
00:11:10,000 --> 00:11:12,160
all you need to know for now is that

282
00:11:12,160 --> 00:11:14,640
yaga provides you a convenient and

283
00:11:14,640 --> 00:11:17,279
intelligent way uh to search for byte

284
00:11:17,279 --> 00:11:20,399
strings for bytes and uh

285
00:11:20,399 --> 00:11:22,800
for strings and byte sequences in

286
00:11:22,800 --> 00:11:24,320
binaries

287
00:11:24,320 --> 00:11:27,040
so our yara is composed of three main

288
00:11:27,040 --> 00:11:30,000
indicators the first two are being the

289
00:11:30,000 --> 00:11:32,399
baba dada and dead beef placeholders are

290
00:11:32,399 --> 00:11:34,160
not just talked about

291
00:11:34,160 --> 00:11:36,959
and the third one is are few bytes from

292
00:11:36,959 --> 00:11:39,279
the decryption shell code which i remind

293
00:11:39,279 --> 00:11:43,560
you is not encrypted on disk

294
00:11:43,760 --> 00:11:46,320
once we have our java rule tested and

295
00:11:46,320 --> 00:11:48,880
ready we can use it to hunt for more

296
00:11:48,880 --> 00:11:50,079
samples

297
00:11:50,079 --> 00:11:53,839
we hunt in our own data on our own

298
00:11:53,839 --> 00:11:56,639
telemetry from our own customers as well

299
00:11:56,639 --> 00:11:59,279
as online malware databases such as

300
00:11:59,279 --> 00:12:01,839
virustotal and malware bazaar

301
00:12:01,839 --> 00:12:03,920
those databases usually

302
00:12:03,920 --> 00:12:06,480
let you use your own rule in order to

303
00:12:06,480 --> 00:12:09,040
find format samples

304
00:12:09,040 --> 00:12:12,240
so after running this sample collection

305
00:12:12,240 --> 00:12:15,040
we had a pretty large database of baba

306
00:12:15,040 --> 00:12:18,079
data samples that we needed to extract

307
00:12:18,079 --> 00:12:20,560
some information from them so we wrote

308
00:12:20,560 --> 00:12:24,000
an automation that extracted some iocs

309
00:12:24,000 --> 00:12:26,160
which i'll talk more in a bit

310
00:12:26,160 --> 00:12:28,000
about them in a bit

311
00:12:28,000 --> 00:12:28,800
and

312
00:12:28,800 --> 00:12:31,200
then we used open source intelligence to

313
00:12:31,200 --> 00:12:34,399
find some references of usage in the

314
00:12:34,399 --> 00:12:36,639
wild

315
00:12:36,639 --> 00:12:39,680
so let's go back to the automation and

316
00:12:39,680 --> 00:12:42,800
understand what data we need to

317
00:12:42,800 --> 00:12:46,079
extract from each sample

318
00:12:46,079 --> 00:12:49,040
to do that we need to understand what is

319
00:12:49,040 --> 00:12:52,079
our goal and our goal was to find us

320
00:12:52,079 --> 00:12:53,440
agenda in a while

321
00:12:53,440 --> 00:12:56,399
so we figured out that the summer source

322
00:12:56,399 --> 00:12:58,720
network activity and the final payload

323
00:12:58,720 --> 00:13:00,079
classification

324
00:13:00,079 --> 00:13:00,880
will

325
00:13:00,880 --> 00:13:02,320
be enough for us

326
00:13:02,320 --> 00:13:04,560
and as you can see there is an example

327
00:13:04,560 --> 00:13:07,680
this is an example of our automations

328
00:13:07,680 --> 00:13:10,880
output the left column

329
00:13:10,880 --> 00:13:12,639
is the final payload and the right

330
00:13:12,639 --> 00:13:14,800
column is the corresponding

331
00:13:14,800 --> 00:13:17,440
network activity network indicator which

332
00:13:17,440 --> 00:13:18,399
can be

333
00:13:18,399 --> 00:13:22,560
your full url domain or ip or even blank

334
00:13:22,560 --> 00:13:24,560
if we haven't succeeded

335
00:13:24,560 --> 00:13:26,240
and we used

336
00:13:26,240 --> 00:13:29,519
this output to see

337
00:13:29,519 --> 00:13:32,079
what manual families

338
00:13:32,079 --> 00:13:34,160
made the most use of the bava data

339
00:13:34,160 --> 00:13:36,320
crypto

340
00:13:36,320 --> 00:13:38,399
so this one was pretty interesting to

341
00:13:38,399 --> 00:13:40,079
see

342
00:13:40,079 --> 00:13:42,720
then after collecting extracting all of

343
00:13:42,720 --> 00:13:44,480
the data and

344
00:13:44,480 --> 00:13:45,839
we started

345
00:13:45,839 --> 00:13:47,680
open source intelligence

346
00:13:47,680 --> 00:13:50,320
we used online sandboxes malware

347
00:13:50,320 --> 00:13:51,680
databases

348
00:13:51,680 --> 00:13:53,680
social networks and of course google and

349
00:13:53,680 --> 00:13:56,639
virustotal to see

350
00:13:56,639 --> 00:13:58,720
any correlation between what we found so

351
00:13:58,720 --> 00:13:59,760
far

352
00:13:59,760 --> 00:14:01,760
and that's when we came across the

353
00:14:01,760 --> 00:14:03,120
following tweet

354
00:14:03,120 --> 00:14:05,760
the match with one one of our samples

355
00:14:05,760 --> 00:14:07,040
hashes

356
00:14:07,040 --> 00:14:08,959
the interesting part in this tweet is

357
00:14:08,959 --> 00:14:11,040
that it provided us an additional

358
00:14:11,040 --> 00:14:13,600
information to work with as you can see

359
00:14:13,600 --> 00:14:16,240
there is some kind of app called mumbin

360
00:14:16,240 --> 00:14:18,639
with a what's supposed to be

361
00:14:18,639 --> 00:14:21,199
its domain but actually it's slightly

362
00:14:21,199 --> 00:14:23,760
different from the original one

363
00:14:23,760 --> 00:14:26,399
and a discord message so it's

364
00:14:26,399 --> 00:14:29,120
small in here the discord message that

365
00:14:29,120 --> 00:14:31,839
classified as a scam alert

366
00:14:31,839 --> 00:14:34,079
we wanted to see if there are any other

367
00:14:34,079 --> 00:14:35,279
services

368
00:14:35,279 --> 00:14:37,600
that follow the same

369
00:14:37,600 --> 00:14:40,240
pattern so we took the ip address of the

370
00:14:40,240 --> 00:14:42,639
fake domain and

371
00:14:42,639 --> 00:14:44,399
we saw that there are

372
00:14:44,399 --> 00:14:48,560
indeed uh other services lister lisa

373
00:14:48,560 --> 00:14:50,800
lister

374
00:14:50,800 --> 00:14:53,680
listed under it the most famous one you

375
00:14:53,680 --> 00:14:56,079
might be familiar with is a fake domain

376
00:14:56,079 --> 00:14:59,120
of larval labs and

377
00:14:59,120 --> 00:15:02,800
but and then we got into inside those

378
00:15:02,800 --> 00:15:05,519
fake websites website looked inside the

379
00:15:05,519 --> 00:15:08,480
code and we were able to find some

380
00:15:08,480 --> 00:15:11,600
watermarking that allowed us to write a

381
00:15:11,600 --> 00:15:14,959
crawler which will find additional fake

382
00:15:14,959 --> 00:15:17,199
website like those

383
00:15:17,199 --> 00:15:19,920
and after running our automation we

384
00:15:19,920 --> 00:15:22,399
found a bunch of them

385
00:15:22,399 --> 00:15:26,480
with a one specific common ground that

386
00:15:26,480 --> 00:15:29,120
they are all some kind related to the

387
00:15:29,120 --> 00:15:32,639
nft and crypto communities

388
00:15:32,639 --> 00:15:34,480
the last piece of information we wanted

389
00:15:34,480 --> 00:15:37,600
to verify is whether the discord message

390
00:15:37,600 --> 00:15:39,600
is consistent among all of those

391
00:15:39,600 --> 00:15:40,880
services

392
00:15:40,880 --> 00:15:43,360
so we entered the discord server had

393
00:15:43,360 --> 00:15:45,199
official discord server of which one of

394
00:15:45,199 --> 00:15:48,160
them and we found that indeed

395
00:15:48,160 --> 00:15:50,959
they are all having the same discord

396
00:15:50,959 --> 00:15:53,199
scan message

397
00:15:53,199 --> 00:15:56,000
this point we understood that there is

398
00:15:56,000 --> 00:15:58,000
some kind of an ongoing campaign that

399
00:15:58,000 --> 00:16:00,720
targets the nft and crypto communities

400
00:16:00,720 --> 00:16:04,480
and we decided to dig deeper and that's

401
00:16:04,480 --> 00:16:06,880
what we found

402
00:16:06,880 --> 00:16:09,360
for those of you who don't know the nft

403
00:16:09,360 --> 00:16:11,440
and crypto communities are highly

404
00:16:11,440 --> 00:16:13,839
dependent on discord as the main

405
00:16:13,839 --> 00:16:16,399
communication channel the attacker knew

406
00:16:16,399 --> 00:16:19,440
that fact and use it used it in order to

407
00:16:19,440 --> 00:16:22,079
find new victims

408
00:16:22,079 --> 00:16:24,800
once a targeted service

409
00:16:24,800 --> 00:16:27,360
it will uh add its

410
00:16:27,360 --> 00:16:30,560
bots into the discord server of this

411
00:16:30,560 --> 00:16:34,160
service and those both bots will send

412
00:16:34,160 --> 00:16:36,480
direct message to each member of the

413
00:16:36,480 --> 00:16:38,800
channel

414
00:16:38,800 --> 00:16:40,610
as you can see the the

415
00:16:40,610 --> 00:16:41,839
[Music]

416
00:16:41,839 --> 00:16:43,360
discord message

417
00:16:43,360 --> 00:16:46,399
has an official looking of a username

418
00:16:46,399 --> 00:16:47,839
and title

419
00:16:47,839 --> 00:16:48,800
the

420
00:16:48,800 --> 00:16:51,519
discord the message body calls the

421
00:16:51,519 --> 00:16:53,839
victim to download the new desktop app

422
00:16:53,839 --> 00:16:55,759
in order to gain

423
00:16:55,759 --> 00:16:57,920
access to the latest features

424
00:16:57,920 --> 00:17:00,560
and at the end it provides a link to the

425
00:17:00,560 --> 00:17:02,560
official website

426
00:17:02,560 --> 00:17:04,959
which is different from the official one

427
00:17:04,959 --> 00:17:07,359
for example in this case debunk the

428
00:17:07,359 --> 00:17:08,480
official

429
00:17:08,480 --> 00:17:10,480
website is debunked.com

430
00:17:10,480 --> 00:17:15,240
where the provided one is debunk.found

431
00:17:15,520 --> 00:17:18,240
once the victim fills in with scam

432
00:17:18,240 --> 00:17:20,319
message and clicks the link it will be

433
00:17:20,319 --> 00:17:23,039
displayed with a website that looks

434
00:17:23,039 --> 00:17:24,640
almost identical

435
00:17:24,640 --> 00:17:27,280
with the one main difference that

436
00:17:27,280 --> 00:17:29,360
the login button is now a download

437
00:17:29,360 --> 00:17:32,360
button

438
00:17:32,640 --> 00:17:34,559
yeah

439
00:17:34,559 --> 00:17:37,600
um if the victims continues and download

440
00:17:37,600 --> 00:17:40,720
the this file it's actually a malware

441
00:17:40,720 --> 00:17:42,480
that upon execution

442
00:17:42,480 --> 00:17:45,360
provides the attacker a full control on

443
00:17:45,360 --> 00:17:48,320
the infected system

444
00:17:48,320 --> 00:17:50,880
we decided to publish a second blog post

445
00:17:50,880 --> 00:17:52,480
and

446
00:17:52,480 --> 00:17:54,960
that details about this threat act of

447
00:17:54,960 --> 00:17:57,280
the attack chain

448
00:17:57,280 --> 00:18:01,360
which you can go and read about

449
00:18:01,360 --> 00:18:02,880
wait

450
00:18:02,880 --> 00:18:05,200
we actually tracked back the activity of

451
00:18:05,200 --> 00:18:08,160
this attacker and we found that it was

452
00:18:08,160 --> 00:18:10,960
active since november 2020

453
00:18:10,960 --> 00:18:13,520
and and the more interesting part is

454
00:18:13,520 --> 00:18:16,160
that since august 2021 its preferred

455
00:18:16,160 --> 00:18:18,320
crypto is no other than the babadela

456
00:18:18,320 --> 00:18:20,240
crypto we just talked about

457
00:18:20,240 --> 00:18:22,799
so that actually explains how we got to

458
00:18:22,799 --> 00:18:24,960
this campaign at the first place

459
00:18:24,960 --> 00:18:27,440
we wanted to see some usages in the wild

460
00:18:27,440 --> 00:18:30,640
and we got them

461
00:18:32,080 --> 00:18:34,080
at this point you

462
00:18:34,080 --> 00:18:35,600
may ask yourself

463
00:18:35,600 --> 00:18:37,760
why do we publish our work why do

464
00:18:37,760 --> 00:18:39,360
security companies and security

465
00:18:39,360 --> 00:18:42,080
researchers maintain an active blog

466
00:18:42,080 --> 00:18:44,400
there are actually many answers to this

467
00:18:44,400 --> 00:18:47,039
question but for us is to hopefully make

468
00:18:47,039 --> 00:18:50,080
an impact yeah i think

469
00:18:50,080 --> 00:18:52,559
the this figure shows how many new

470
00:18:52,559 --> 00:18:54,160
targeted services

471
00:18:54,160 --> 00:18:57,520
where each month by this attack chain

472
00:18:57,520 --> 00:19:00,799
and threat actor and as you see before

473
00:19:00,799 --> 00:19:03,280
uh releasing our first block

474
00:19:03,280 --> 00:19:06,160
above the baba data there were around 15

475
00:19:06,160 --> 00:19:08,080
new targeted services

476
00:19:08,080 --> 00:19:10,320
and our first blog only briefly

477
00:19:10,320 --> 00:19:13,760
discussed about this ongoing campaign

478
00:19:13,760 --> 00:19:16,559
so the impact was of course close to

479
00:19:16,559 --> 00:19:17,600
none

480
00:19:17,600 --> 00:19:20,240
and then we decided to publish a second

481
00:19:20,240 --> 00:19:22,960
blog post focusing on the threat octo

482
00:19:22,960 --> 00:19:24,400
its evolution over time its

483
00:19:24,400 --> 00:19:27,039
infrastructure and much more

484
00:19:27,039 --> 00:19:28,480
and finally

485
00:19:28,480 --> 00:19:31,679
we got some impact and as of today we

486
00:19:31,679 --> 00:19:33,600
can say that there are no

487
00:19:33,600 --> 00:19:35,520
new targeted services

488
00:19:35,520 --> 00:19:39,120
and we can say for sure we caused it but

489
00:19:39,120 --> 00:19:41,360
we for our own motivation we do like to

490
00:19:41,360 --> 00:19:42,080
think so

491
00:19:42,080 --> 00:19:44,640
[Music]

492
00:19:44,640 --> 00:19:46,880
okay another reason for us to publish

493
00:19:46,880 --> 00:19:48,400
our work is

494
00:19:48,400 --> 00:19:49,840
to help other

495
00:19:49,840 --> 00:19:52,400
with their research for example

496
00:19:52,400 --> 00:19:54,240
let's take the case of baba data against

497
00:19:54,240 --> 00:19:55,840
ukraine

498
00:19:55,840 --> 00:19:58,000
the third ukraine the ukraine third has

499
00:19:58,000 --> 00:19:59,440
published that ukrainian state

500
00:19:59,440 --> 00:20:01,919
organization has been targeted to saint

501
00:20:01,919 --> 00:20:04,960
both and outside malware attacks in this

502
00:20:04,960 --> 00:20:07,360
post there provided some

503
00:20:07,360 --> 00:20:12,080
details not many and with some iocs

504
00:20:12,080 --> 00:20:14,080
but didn't explain so much about the

505
00:20:14,080 --> 00:20:16,080
infection chain

506
00:20:16,080 --> 00:20:18,480
then security company named elsie took

507
00:20:18,480 --> 00:20:21,200
the word walk and expanded it and what

508
00:20:21,200 --> 00:20:24,400
they found is that baba dada was used to

509
00:20:24,400 --> 00:20:26,720
drop the austral malwa

510
00:20:26,720 --> 00:20:29,280
you can go and read more about this i'm

511
00:20:29,280 --> 00:20:33,360
encouraging you a very good stuff

512
00:20:33,360 --> 00:20:36,080
so let's take a recap for what we talked

513
00:20:36,080 --> 00:20:38,720
about today and what are the main key

514
00:20:38,720 --> 00:20:40,720
takeaways we want you to take from this

515
00:20:40,720 --> 00:20:43,200
talk and we'll begin by

516
00:20:43,200 --> 00:20:45,200
understanding the threat landscape

517
00:20:45,200 --> 00:20:47,520
you're working with if you recall that's

518
00:20:47,520 --> 00:20:50,320
how the all resource story

519
00:20:50,320 --> 00:20:52,720
began at the first place we knew how

520
00:20:52,720 --> 00:20:55,039
certain malware infection chain would

521
00:20:55,039 --> 00:20:56,720
look like and

522
00:20:56,720 --> 00:20:58,880
that helped us to spot the anomaly

523
00:20:58,880 --> 00:21:02,320
between the rest of the logs

524
00:21:02,320 --> 00:21:05,039
look at the bigger picture and although

525
00:21:05,039 --> 00:21:06,480
we started by

526
00:21:06,480 --> 00:21:08,480
inspecting the baba data crypto and its

527
00:21:08,480 --> 00:21:10,480
inner walking we

528
00:21:10,480 --> 00:21:12,880
then immediately took a step back

529
00:21:12,880 --> 00:21:15,200
to understand what role it plays

530
00:21:15,200 --> 00:21:17,919
in a full infection chain in a real

531
00:21:17,919 --> 00:21:20,000
life scenario

532
00:21:20,000 --> 00:21:22,240
use automation to make your analysis

533
00:21:22,240 --> 00:21:23,679
easier

534
00:21:23,679 --> 00:21:25,600
when you are dealing with a larger

535
00:21:25,600 --> 00:21:27,120
amount of data

536
00:21:27,120 --> 00:21:29,600
you must automate as many tasks as

537
00:21:29,600 --> 00:21:31,440
possible to make your analysis and

538
00:21:31,440 --> 00:21:33,760
research much easier and quicker

539
00:21:33,760 --> 00:21:35,679
for example in our case we have

540
00:21:35,679 --> 00:21:38,000
automated the sample collection the ioc

541
00:21:38,000 --> 00:21:40,400
extraction the corolla and many more

542
00:21:40,400 --> 00:21:42,080
components

543
00:21:42,080 --> 00:21:44,880
and finally share your findings and make

544
00:21:44,880 --> 00:21:46,880
use of other findings

545
00:21:46,880 --> 00:21:49,200
this is a great community contribute to

546
00:21:49,200 --> 00:21:52,159
it it will help others in their work and

547
00:21:52,159 --> 00:21:54,720
hopefully will help you in your future

548
00:21:54,720 --> 00:21:56,000
work

549
00:21:56,000 --> 00:21:58,120
thank you everybody

550
00:21:58,120 --> 00:22:03,739
[Applause]

551
00:22:05,280 --> 00:22:07,039
cool great guys thank you very much for

552
00:22:07,039 --> 00:22:08,720
the interesting talk it was nice to be

553
00:22:08,720 --> 00:22:11,200
taking on on your journey of discovery

554
00:22:11,200 --> 00:22:14,159
and also i mean linking to the keynote

555
00:22:14,159 --> 00:22:16,159
from this morning sharing your findings

556
00:22:16,159 --> 00:22:18,720
um sharing what you figured out it's a

557
00:22:18,720 --> 00:22:20,799
it's a really cool thing to yeah to help

558
00:22:20,799 --> 00:22:22,799
the community and maybe some of you got

559
00:22:22,799 --> 00:22:25,039
interested in also

560
00:22:25,039 --> 00:22:26,880
doing similar stuff

561
00:22:26,880 --> 00:22:28,480
so yeah we have time for some questions

562
00:22:28,480 --> 00:22:31,679
so when you have questions feel free

563
00:22:31,679 --> 00:22:35,080
come to the microphone

564
00:22:38,360 --> 00:22:41,520
[Music]

565
00:22:41,520 --> 00:22:44,880
um so uh between the two blog posts uh

566
00:22:44,880 --> 00:22:47,520
there seem to be around four months more

567
00:22:47,520 --> 00:22:48,559
or less

568
00:22:48,559 --> 00:22:51,120
uh how much human efforts there is

569
00:22:51,120 --> 00:22:53,440
behind this kind of research and how

570
00:22:53,440 --> 00:22:55,360
many people were involved and

571
00:22:55,360 --> 00:22:58,400
was this let's say uh a focused effort

572
00:22:58,400 --> 00:22:59,679
on that or

573
00:22:59,679 --> 00:23:01,039
how was this

574
00:23:01,039 --> 00:23:02,559
done let's say

575
00:23:02,559 --> 00:23:04,400
so um

576
00:23:04,400 --> 00:23:06,960
actually after posting as i

577
00:23:06,960 --> 00:23:09,600
already said uh at the first ball post

578
00:23:09,600 --> 00:23:11,280
we briefly discussed about the campaign

579
00:23:11,280 --> 00:23:13,520
so we already knew that there is some

580
00:23:13,520 --> 00:23:16,400
kind of an online campaign but we didn't

581
00:23:16,400 --> 00:23:17,440
go

582
00:23:17,440 --> 00:23:19,840
went in much details and understand it

583
00:23:19,840 --> 00:23:23,520
fully but we keep our eyes on it and and

584
00:23:23,520 --> 00:23:26,880
then after one after a certain period of

585
00:23:26,880 --> 00:23:29,600
time we decided to go back together

586
00:23:29,600 --> 00:23:31,760
we were all together not only

587
00:23:31,760 --> 00:23:34,960
because it was uh

588
00:23:34,960 --> 00:23:37,919
it has is a lot of work to be done but

589
00:23:37,919 --> 00:23:40,240
also because it's fun to work together

590
00:23:40,240 --> 00:23:43,360
and and we got back and we decided to

591
00:23:43,360 --> 00:23:46,559
investigate more desperate acto and and

592
00:23:46,559 --> 00:23:47,840
it's it

593
00:23:47,840 --> 00:23:48,960
was

594
00:23:48,960 --> 00:23:51,600
i think at the same scale of the first

595
00:23:51,600 --> 00:23:53,600
uh research but it's different because

596
00:23:53,600 --> 00:23:55,679
the first research is more about reverse

597
00:23:55,679 --> 00:23:57,679
engineering and malware analysis where

598
00:23:57,679 --> 00:24:00,480
the second is more threat intelligent

599
00:24:00,480 --> 00:24:01,760
and

600
00:24:01,760 --> 00:24:02,559
and

601
00:24:02,559 --> 00:24:04,640
those sort of stuff but

602
00:24:04,640 --> 00:24:05,679
yeah

603
00:24:05,679 --> 00:24:06,559
thank you

604
00:24:06,559 --> 00:24:08,879
thank you

605
00:24:10,240 --> 00:24:12,240
you you had this um slide with the

606
00:24:12,240 --> 00:24:14,880
bullet points what um about what made

607
00:24:14,880 --> 00:24:17,360
this scripture so evasive

608
00:24:17,360 --> 00:24:20,799
i'm not i'm new to modern analysis but

609
00:24:20,799 --> 00:24:22,880
still none of those bullets was really

610
00:24:22,880 --> 00:24:25,360
new to me so was is there any really

611
00:24:25,360 --> 00:24:27,679
specific thing that made it so evasive

612
00:24:27,679 --> 00:24:30,400
or is it is it actually not that hard to

613
00:24:30,400 --> 00:24:33,600
make crypto um with a zero detection

614
00:24:33,600 --> 00:24:35,520
rate so is it common is it a common

615
00:24:35,520 --> 00:24:38,880
thing or is it really that special

616
00:24:38,880 --> 00:24:40,880
so first of all

617
00:24:40,880 --> 00:24:43,120
it's not that hard to make a crypto so

618
00:24:43,120 --> 00:24:44,320
evasive

619
00:24:44,320 --> 00:24:45,200
but

620
00:24:45,200 --> 00:24:48,320
the the thing that was special here that

621
00:24:48,320 --> 00:24:50,080
was the fact that this script was

622
00:24:50,080 --> 00:24:52,400
evasive for a very long time

623
00:24:52,400 --> 00:24:54,720
that was the

624
00:24:54,720 --> 00:24:56,960
what interesting in this part

625
00:24:56,960 --> 00:24:58,720
and

626
00:24:58,720 --> 00:24:59,760
by

627
00:24:59,760 --> 00:25:02,880
and this and it does that by

628
00:25:02,880 --> 00:25:05,840
com combining all of those bullets as

629
00:25:05,840 --> 00:25:08,640
you said together that's how we it does

630
00:25:08,640 --> 00:25:11,640
that

631
00:25:17,200 --> 00:25:19,200
very nice then um yeah thanks again you

632
00:25:19,200 --> 00:25:20,799
guys for also making a trip from tel

633
00:25:20,799 --> 00:25:23,120
aviv here to munich and to present and

634
00:25:23,120 --> 00:25:24,080
um

635
00:25:24,080 --> 00:25:28,159
thanks a lot another round of applause

636
00:25:28,159 --> 00:25:30,240
you

