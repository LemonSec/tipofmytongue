1
00:00:15,570 --> 00:00:21,120
[Applause]

2
00:00:18,810 --> 00:00:22,340
so for this thing working do I need to

3
00:00:21,120 --> 00:00:25,710
get closer

4
00:00:22,340 --> 00:00:31,200
this close so I might just as yell

5
00:00:25,710 --> 00:00:32,820
instead my name is Travis I work at

6
00:00:31,200 --> 00:00:34,739
tripwire right across the river here in

7
00:00:32,820 --> 00:00:36,480
Portland I do a lot of research around

8
00:00:34,739 --> 00:00:38,459
the defense defensive side of security

9
00:00:36,480 --> 00:00:40,379
so today I'm going to talk about how the

10
00:00:38,460 --> 00:00:42,720
attack framework can actually be used as

11
00:00:40,379 --> 00:00:45,269
a teaching tool to teach younger people

12
00:00:42,720 --> 00:00:46,830
some of you my men Gallus might

13
00:00:45,270 --> 00:00:48,510
recognize me from previous years where

14
00:00:46,830 --> 00:00:49,979
i've talked about how we've brought on

15
00:00:48,510 --> 00:00:51,780
interns in the past and tried to teach

16
00:00:49,979 --> 00:00:54,600
them security sometimes it's been

17
00:00:51,780 --> 00:00:55,979
successful sometimes it hasn't and using

18
00:00:54,600 --> 00:00:57,780
the attack framework this year with the

19
00:00:55,979 --> 00:00:58,739
one of our interns worked out really

20
00:00:57,780 --> 00:01:00,750
well so I'm going to talk about how we

21
00:00:58,739 --> 00:01:02,299
use that and how you might be able to

22
00:01:00,750 --> 00:01:06,600
use it yourselves

23
00:01:02,299 --> 00:01:08,340
so a couple days ago Tuesday I was in DC

24
00:01:06,600 --> 00:01:10,580
giving a similar presentation I had to

25
00:01:08,340 --> 00:01:12,690
send my slides ahead of time to to mitre

26
00:01:10,580 --> 00:01:15,090
and they said yeah everything looks good

27
00:01:12,690 --> 00:01:21,600
but your second slide is terrifying

28
00:01:15,090 --> 00:01:25,080
which is this one here everybody agrees

29
00:01:21,600 --> 00:01:27,570
have a really good-looking Sun right so

30
00:01:25,080 --> 00:01:30,630
the purpose is really the goal of

31
00:01:27,570 --> 00:01:32,279
teaching is to pass on our knowledge to

32
00:01:30,630 --> 00:01:34,470
the younger generation or maybe they're

33
00:01:32,280 --> 00:01:36,240
older who knows to really make better

34
00:01:34,470 --> 00:01:38,220
versions of ourselves to TAS on the best

35
00:01:36,240 --> 00:01:39,600
parts of ourselves the best knowledge so

36
00:01:38,220 --> 00:01:40,340
they can be better in their lives as

37
00:01:39,600 --> 00:01:43,830
well

38
00:01:40,340 --> 00:01:47,130
so wrong way I have used this clicker

39
00:01:43,830 --> 00:01:48,750
yet so what we did starting out in 2015

40
00:01:47,130 --> 00:01:50,039
we brought on some interns and I said

41
00:01:48,750 --> 00:01:52,530
all right we're gonna turn it up to 11

42
00:01:50,040 --> 00:01:54,480
we're gonna load up some Kali Linux we

43
00:01:52,530 --> 00:01:55,740
use the damn vulnerable web app we're

44
00:01:54,480 --> 00:01:57,030
gonna snus in full and scanning we're

45
00:01:55,740 --> 00:01:59,369
gonna use nmap we're gonna use

46
00:01:57,030 --> 00:02:00,900
Metasploit and we're gonna dispose to

47
00:01:59,370 --> 00:02:02,760
exploit all summer long there's gonna be

48
00:02:00,900 --> 00:02:04,380
a lot of fun everybody's gonna love it

49
00:02:02,760 --> 00:02:06,420
and they just kind of looked around like

50
00:02:04,380 --> 00:02:10,288
this didn't really know what was going

51
00:02:06,420 --> 00:02:11,670
on so what we did the the next year is

52
00:02:10,288 --> 00:02:14,010
we try to engage them a little bit more

53
00:02:11,670 --> 00:02:16,799
try to pique their interest so we bought

54
00:02:14,010 --> 00:02:19,170
a internet controlled robot off of

55
00:02:16,800 --> 00:02:20,580
Amazon it's about 80 bucks plus you need

56
00:02:19,170 --> 00:02:22,079
the Raspberry Pi and things like that so

57
00:02:20,580 --> 00:02:22,849
about a hundred dollars wheel to get

58
00:02:22,080 --> 00:02:25,080
this

59
00:02:22,849 --> 00:02:26,790
robot that they were to build themselves

60
00:02:25,080 --> 00:02:28,980
build the hardware built install the

61
00:02:26,790 --> 00:02:29,969
software see how the software worked and

62
00:02:28,980 --> 00:02:31,230
what we did is we taught them how to

63
00:02:29,969 --> 00:02:33,629
then attack that

64
00:02:31,230 --> 00:02:34,980
and break into that they went through

65
00:02:33,629 --> 00:02:36,899
and then they fixed the vulnerabilities

66
00:02:34,980 --> 00:02:38,250
that they saw patch it as much as they

67
00:02:36,900 --> 00:02:39,690
would harden as much as they could and

68
00:02:38,250 --> 00:02:40,769
then we open it up to our security team

69
00:02:39,690 --> 00:02:43,590
so then they could try to hack it

70
00:02:40,769 --> 00:02:44,849
themselves the first year really good

71
00:02:43,590 --> 00:02:47,069
they actually were able to protect it

72
00:02:44,849 --> 00:02:48,480
the second year they were very close we

73
00:02:47,069 --> 00:02:49,890
gave I think that I could to our time

74
00:02:48,480 --> 00:02:52,530
limit and we were very close to breaking

75
00:02:49,890 --> 00:02:54,779
into it then the intern walked away and

76
00:02:52,530 --> 00:02:55,709
had all the passwords on his desktop so

77
00:02:54,780 --> 00:02:57,810
that's how we were able to break into it

78
00:02:55,709 --> 00:02:59,220
so a really good teaching moment to

79
00:02:57,810 --> 00:03:04,799
never leave your passwords on your

80
00:02:59,220 --> 00:03:06,750
desktop he was very sad about that but

81
00:03:04,799 --> 00:03:08,760
it was still not quite as successful as

82
00:03:06,750 --> 00:03:10,950
we had wanted it to be and then I came

83
00:03:08,760 --> 00:03:12,540
across the the Bloom's taxonomy for for

84
00:03:10,950 --> 00:03:14,879
learning and I realized we were really

85
00:03:12,540 --> 00:03:16,319
skipping to step three in the the

86
00:03:14,879 --> 00:03:17,370
learning objectives the application of

87
00:03:16,319 --> 00:03:19,950
how you actually apply this knowledge

88
00:03:17,370 --> 00:03:21,900
and we were skipping over the building

89
00:03:19,950 --> 00:03:23,569
blocks of you know the learning where we

90
00:03:21,900 --> 00:03:25,200
need that knowledge first you need to

91
00:03:23,569 --> 00:03:26,458
understand what that is and then

92
00:03:25,200 --> 00:03:27,988
comprehend it before you can actually

93
00:03:26,459 --> 00:03:29,940
apply it and then move on to other

94
00:03:27,989 --> 00:03:31,410
things that's why everybody remembers

95
00:03:29,940 --> 00:03:33,540
from their their college days it's like

96
00:03:31,410 --> 00:03:34,890
read the book three times the same kind

97
00:03:33,540 --> 00:03:36,870
of thing where you need to understand it

98
00:03:34,890 --> 00:03:38,429
you need to comprehend it and then go

99
00:03:36,870 --> 00:03:41,549
across it and then when it came across

100
00:03:38,430 --> 00:03:43,139
this is when I was actually deep into

101
00:03:41,549 --> 00:03:44,880
the attack framework and I said okay

102
00:03:43,139 --> 00:03:46,769
well there's a lot of knowledge in that

103
00:03:44,880 --> 00:03:48,450
attack framework how can we use it

104
00:03:46,769 --> 00:03:50,579
anybody that's not familiar with attack

105
00:03:48,450 --> 00:03:52,798
it stands for adversaries Tech tactics

106
00:03:50,579 --> 00:03:54,599
techniques and common knowledge so that

107
00:03:52,799 --> 00:03:57,989
knowledge is a key aspect of the attack

108
00:03:54,599 --> 00:03:59,940
framework so describing what the attack

109
00:03:57,989 --> 00:04:01,470
framework is if anybody's not familiar

110
00:03:59,940 --> 00:04:03,630
at this is the Lockheed Martin cyber

111
00:04:01,470 --> 00:04:05,730
kill chain which really describes an

112
00:04:03,630 --> 00:04:06,870
overall attack strategy of attackers

113
00:04:05,730 --> 00:04:08,250
where they're gonna start with

114
00:04:06,870 --> 00:04:11,430
reconnaissance they're gonna weaponize

115
00:04:08,250 --> 00:04:12,720
things deliver it to you exploits and

116
00:04:11,430 --> 00:04:14,370
then eventually get down to their

117
00:04:12,720 --> 00:04:15,930
whatever their actions on objectives are

118
00:04:14,370 --> 00:04:17,789
on the right it was a great way to

119
00:04:15,930 --> 00:04:19,950
describe the the security lifecycle of

120
00:04:17,789 --> 00:04:22,048
an attacker and where the attack

121
00:04:19,950 --> 00:04:24,210
framework really fits in is in the the

122
00:04:22,048 --> 00:04:26,159
later portion of that actual attack kill

123
00:04:24,210 --> 00:04:27,960
chain it's one they've already gained a

124
00:04:26,160 --> 00:04:29,580
foothold into your environment so we

125
00:04:27,960 --> 00:04:31,020
talked to two organizations and say you

126
00:04:29,580 --> 00:04:32,940
need to adopt the attack framework and

127
00:04:31,020 --> 00:04:34,109
it's really focused on when they've

128
00:04:32,940 --> 00:04:35,669
already gained a foothold that can be

129
00:04:34,110 --> 00:04:37,650
scary but we know that attackers are

130
00:04:35,669 --> 00:04:38,359
gonna get in and we need to do something

131
00:04:37,650 --> 00:04:44,120
about that

132
00:04:38,360 --> 00:04:44,120
so what it is it's a collection of 10

133
00:04:45,540 --> 00:04:50,080
that's weird so it's actually 11 tactics

134
00:04:48,700 --> 00:04:52,810
that the header is really cut off here

135
00:04:50,080 --> 00:04:54,370
which is unfortunate don't know why

136
00:04:52,810 --> 00:04:58,150
that's doing that it looks really cool

137
00:04:54,370 --> 00:05:00,790
but anyways what should be at the top up

138
00:04:58,150 --> 00:05:01,929
here is just the headers are the

139
00:05:00,790 --> 00:05:03,640
different tactics so these are the

140
00:05:01,930 --> 00:05:05,020
things like persistence these the

141
00:05:03,640 --> 00:05:07,240
objectives that an attacker is gonna try

142
00:05:05,020 --> 00:05:08,740
to get to persistence to vent defensive

143
00:05:07,240 --> 00:05:11,440
evasion if I go back it's these ones

144
00:05:08,740 --> 00:05:13,210
here credential access discovery lateral

145
00:05:11,440 --> 00:05:14,469
movement commanding control and they

146
00:05:13,210 --> 00:05:17,140
really describe what the attacker is

147
00:05:14,470 --> 00:05:18,670
going to try to do and then the

148
00:05:17,140 --> 00:05:19,840
individual cells which we would see in

149
00:05:18,670 --> 00:05:22,510
here I'm really sad way that's not

150
00:05:19,840 --> 00:05:23,739
working great is the actual what we call

151
00:05:22,510 --> 00:05:25,270
techniques and that's how they're gonna

152
00:05:23,740 --> 00:05:26,500
gain that objective so if they want

153
00:05:25,270 --> 00:05:29,440
persistence they do something like

154
00:05:26,500 --> 00:05:30,400
registry run keys or if they want

155
00:05:29,440 --> 00:05:32,620
command and control they're gonna

156
00:05:30,400 --> 00:05:36,250
exfiltrated Atta over the network so on

157
00:05:32,620 --> 00:05:37,630
and so forth so what I did is I took

158
00:05:36,250 --> 00:05:38,650
that framework and then I start

159
00:05:37,630 --> 00:05:40,480
splitting out all those different

160
00:05:38,650 --> 00:05:41,919
techniques and I split them up into five

161
00:05:40,480 --> 00:05:44,230
different objectives and I'm a big fan

162
00:05:41,920 --> 00:05:45,040
of the attack acronym and I tried to

163
00:05:44,230 --> 00:05:46,450
make one myself

164
00:05:45,040 --> 00:05:47,920
and then by the time I got down to the

165
00:05:46,450 --> 00:05:50,740
bottom like this is just way too hard

166
00:05:47,920 --> 00:05:53,890
we're just gonna put hard it's what I

167
00:05:50,740 --> 00:05:55,990
did so the blue is really techniques

168
00:05:53,890 --> 00:05:57,789
that are going to be leveraged by other

169
00:05:55,990 --> 00:05:59,770
techniques so things like you're gonna

170
00:05:57,790 --> 00:06:01,720
run and executable or you're going to

171
00:05:59,770 --> 00:06:03,219
query the registry those aren't actual

172
00:06:01,720 --> 00:06:05,350
exploits themselves you're gonna be able

173
00:06:03,220 --> 00:06:06,580
to do but they're gonna be leveraged

174
00:06:05,350 --> 00:06:08,380
later so there's not really something

175
00:06:06,580 --> 00:06:10,539
that you can actually dig into on on

176
00:06:08,380 --> 00:06:12,340
that green are like a really easy ones

177
00:06:10,540 --> 00:06:14,560
so easy my grandma could probably do

178
00:06:12,340 --> 00:06:16,690
them so things like replacing a registry

179
00:06:14,560 --> 00:06:19,570
key for registry run keys or the set HD

180
00:06:16,690 --> 00:06:21,310
keys to replace you know set HD with

181
00:06:19,570 --> 00:06:24,219
with CMD so you can get a command prompt

182
00:06:21,310 --> 00:06:25,480
really easy things to do yellow are

183
00:06:24,220 --> 00:06:26,890
things that are still pretty easy but

184
00:06:25,480 --> 00:06:28,690
you need some type of framework around

185
00:06:26,890 --> 00:06:30,430
it that really enables it to be really

186
00:06:28,690 --> 00:06:33,670
easy to use so if you had something like

187
00:06:30,430 --> 00:06:35,020
Metasploit or cobalt strike or some of

188
00:06:33,670 --> 00:06:37,240
the proof of concept code that you seen

189
00:06:35,020 --> 00:06:40,180
on github that's where those would

190
00:06:37,240 --> 00:06:42,370
really come into play orange is really

191
00:06:40,180 --> 00:06:44,170
split between what's easy and what's

192
00:06:42,370 --> 00:06:46,330
kind of not so easy and what's really

193
00:06:44,170 --> 00:06:47,830
hard but requires some level of

194
00:06:46,330 --> 00:06:49,539
infrastructure to set up so you might

195
00:06:47,830 --> 00:06:52,300
need a web server that you can pop a web

196
00:06:49,540 --> 00:06:55,420
shell onto or to place a shared content

197
00:06:52,300 --> 00:06:57,010
onto or you need a command and control

198
00:06:55,420 --> 00:06:58,240
infrastructure set up you know some of

199
00:06:57,010 --> 00:06:59,169
these things are pretty easy to do

200
00:06:58,240 --> 00:07:00,280
they're not you know pretty actually

201
00:06:59,169 --> 00:07:01,990
pretty simple to do but they actually

202
00:07:00,280 --> 00:07:03,758
require some level investment to get

203
00:07:01,990 --> 00:07:05,380
that up and running and then the final

204
00:07:03,759 --> 00:07:07,389
one is just things that are just hard

205
00:07:05,380 --> 00:07:09,550
right so things that you need custom DLL

206
00:07:07,389 --> 00:07:10,960
for or you need to have very in-depth

207
00:07:09,550 --> 00:07:14,259
knowledge of the operating system or the

208
00:07:10,960 --> 00:07:16,960
actual hardware to implant root kits or

209
00:07:14,259 --> 00:07:19,090
boot kits things like that so what it

210
00:07:16,960 --> 00:07:20,739
looks like here's a better understanding

211
00:07:19,090 --> 00:07:23,888
this is kind of what that that previous

212
00:07:20,740 --> 00:07:26,289
one was trying to show can i zoom in up

213
00:07:23,889 --> 00:07:30,009
top so these are the different tactics

214
00:07:26,289 --> 00:07:31,300
across the top so this is a export from

215
00:07:30,009 --> 00:07:33,130
a tool that they have it's called a TAC

216
00:07:31,300 --> 00:07:35,650
navigator really nice tool you can get

217
00:07:33,130 --> 00:07:36,940
it from their website so these are the

218
00:07:35,650 --> 00:07:39,460
ones that are the blue ones the

219
00:07:36,940 --> 00:07:41,440
graphical user interface user execution

220
00:07:39,460 --> 00:07:44,650
in query registry that we'd want to go

221
00:07:41,440 --> 00:07:47,289
through the green ones these are the

222
00:07:44,650 --> 00:07:48,580
things that are very simple to do so if

223
00:07:47,289 --> 00:07:50,590
you have the junior level person that's

224
00:07:48,580 --> 00:07:53,258
gonna want to go through and research

225
00:07:50,590 --> 00:07:54,369
attack or you want to have a somebody to

226
00:07:53,259 --> 00:07:55,300
teach somebody to attack these are the

227
00:07:54,370 --> 00:07:58,780
green ones that you'd want to actually

228
00:07:55,300 --> 00:08:00,370
go through and do yellow you know like I

229
00:07:58,780 --> 00:08:02,948
said the harder ones things that are you

230
00:08:00,370 --> 00:08:04,509
need some type of level exploitation of

231
00:08:02,949 --> 00:08:06,340
anything where you need Metasploit or

232
00:08:04,509 --> 00:08:08,470
installing root certificates pass the

233
00:08:06,340 --> 00:08:10,840
hash input capture write simple things

234
00:08:08,470 --> 00:08:12,340
to do but usually enabled a little bit

235
00:08:10,840 --> 00:08:15,940
better when you have some type of tool

236
00:08:12,340 --> 00:08:17,799
to be able to do it so I like to not do

237
00:08:15,940 --> 00:08:19,780
these ones even first maybe and skip

238
00:08:17,800 --> 00:08:20,710
over these ones until 2nd or 3rd that

239
00:08:19,780 --> 00:08:22,750
we're gonna go true so they have an

240
00:08:20,710 --> 00:08:24,400
understanding of what's going on so they

241
00:08:22,750 --> 00:08:25,599
don't just you know load up Metasploit

242
00:08:24,400 --> 00:08:27,039
and say you know i pushed a button now i

243
00:08:25,599 --> 00:08:27,940
have root that's really cool alright

244
00:08:27,039 --> 00:08:30,880
they want to have that level of

245
00:08:27,940 --> 00:08:32,320
understanding orange so again like I

246
00:08:30,880 --> 00:08:35,500
said the the ones that need some level

247
00:08:32,320 --> 00:08:38,349
of you know infrastructure to be able to

248
00:08:35,500 --> 00:08:40,059
set up red ones these and ones that are

249
00:08:38,349 --> 00:08:41,919
really really hard you need so you know

250
00:08:40,059 --> 00:08:43,718
some type of custom DLL or you know

251
00:08:41,919 --> 00:08:45,520
understanding of the firmware being able

252
00:08:43,719 --> 00:08:47,350
to understand how the memory structure

253
00:08:45,520 --> 00:08:48,699
works of the operating system so these

254
00:08:47,350 --> 00:08:50,380
the ones like your senior level people

255
00:08:48,700 --> 00:08:51,579
are gonna be doing or like the you know

256
00:08:50,380 --> 00:08:53,620
people and their if they're in college

257
00:08:51,579 --> 00:08:55,029
they're their master thesis kind of kind

258
00:08:53,620 --> 00:08:57,279
of thing that's these are the ones that

259
00:08:55,029 --> 00:08:59,200
they're gonna be actually investigating

260
00:08:57,279 --> 00:09:01,329
so we put it all together we get the

261
00:08:59,200 --> 00:09:02,589
attack rainbow as I call it so these the

262
00:09:01,329 --> 00:09:07,599
ones that are put all together on a

263
00:09:02,589 --> 00:09:10,360
single pane of glass so down here on my

264
00:09:07,600 --> 00:09:11,890
github page I've actually provided JSON

265
00:09:10,360 --> 00:09:13,510
output for the attack navigator

266
00:09:11,890 --> 00:09:15,250
we can actually go through and see him

267
00:09:13,510 --> 00:09:17,589
and then start digging around it and

268
00:09:15,250 --> 00:09:19,839
what I like about going through this

269
00:09:17,589 --> 00:09:21,279
strategy that I went through is if you

270
00:09:19,839 --> 00:09:22,810
look at something like persistence or

271
00:09:21,279 --> 00:09:25,209
defensive evasion and nearly pretty much

272
00:09:22,810 --> 00:09:27,880
every one of these tactics these columns

273
00:09:25,209 --> 00:09:29,829
- of course discovery you have a split

274
00:09:27,880 --> 00:09:31,630
between things that are very easy to do

275
00:09:29,829 --> 00:09:34,209
a little bit harder to do and very hard

276
00:09:31,630 --> 00:09:35,740
to do so as you know from our team and

277
00:09:34,209 --> 00:09:37,239
tripwire we have you know security

278
00:09:35,740 --> 00:09:39,459
researchers and we have multiple people

279
00:09:37,240 --> 00:09:42,130
wanting to look at this we can have our

280
00:09:39,459 --> 00:09:43,750
you know we want to focus on persistence

281
00:09:42,130 --> 00:09:46,720
you know this month or sprint if you

282
00:09:43,750 --> 00:09:48,070
guys are fans of agile so let's you know

283
00:09:46,720 --> 00:09:49,300
split these up you know the junior level

284
00:09:48,070 --> 00:09:51,190
people we can start looking at these

285
00:09:49,300 --> 00:09:52,359
green ones senior level people you work

286
00:09:51,190 --> 00:09:54,250
on the red one so we can start meeting

287
00:09:52,360 --> 00:09:56,100
in the middle somewhere so something

288
00:09:54,250 --> 00:09:58,930
like persistence has red yellow green

289
00:09:56,100 --> 00:10:00,310
blue orange they have all of them so you

290
00:09:58,930 --> 00:10:03,819
can really start spreading this across

291
00:10:00,310 --> 00:10:06,640
your entire team so the actual attack

292
00:10:03,820 --> 00:10:08,890
Navigator it's on their website it's

293
00:10:06,640 --> 00:10:11,019
that's not the link there they recently

294
00:10:08,890 --> 00:10:13,269
put a new feature in where you can load

295
00:10:11,019 --> 00:10:16,180
in these JSON formats of these different

296
00:10:13,269 --> 00:10:19,149
tabs directly from a URL so you can just

297
00:10:16,180 --> 00:10:20,890
take the you know the raw github user

298
00:10:19,149 --> 00:10:22,060
content for any one of these ones that

299
00:10:20,890 --> 00:10:23,470
we have here and just load it directly

300
00:10:22,060 --> 00:10:24,699
into the attack navigator which they

301
00:10:23,470 --> 00:10:26,440
host on their website so you actually

302
00:10:24,699 --> 00:10:27,760
don't need to do anything to be able

303
00:10:26,440 --> 00:10:28,930
start digging into these ones and you

304
00:10:27,760 --> 00:10:31,000
just put it in there and it loads it in

305
00:10:28,930 --> 00:10:33,339
split up by you know different tabs for

306
00:10:31,000 --> 00:10:34,930
whatever you know a specific color if

307
00:10:33,339 --> 00:10:37,029
you want all of them for the full

308
00:10:34,930 --> 00:10:38,769
rainbow for full effect it's a really

309
00:10:37,029 --> 00:10:40,810
neat little feature that you can go

310
00:10:38,769 --> 00:10:42,130
check out immediately if you want to

311
00:10:40,810 --> 00:10:45,489
have fun this weekend just looking at

312
00:10:42,130 --> 00:10:47,019
attack so how we actually used it in

313
00:10:45,490 --> 00:10:49,870
practice so here's how we actually went

314
00:10:47,019 --> 00:10:52,029
under this workflow with our Thor intern

315
00:10:49,870 --> 00:10:53,980
this year first we chose a specific

316
00:10:52,029 --> 00:10:55,180
tactic with persistence because that

317
00:10:53,980 --> 00:10:56,560
one's a little bit easier to use

318
00:10:55,180 --> 00:10:58,449
especially for people that aren't

319
00:10:56,560 --> 00:11:00,130
familiar with security our intern this

320
00:10:58,449 --> 00:11:01,660
year had some level of understanding of

321
00:11:00,130 --> 00:11:04,149
computer science in general but was

322
00:11:01,660 --> 00:11:05,170
brand new to security so we said ok you

323
00:11:04,149 --> 00:11:06,550
know while you're here we're gonna start

324
00:11:05,170 --> 00:11:09,160
working on persistence so let's choose

325
00:11:06,550 --> 00:11:10,420
one of the individual tactics or sorry

326
00:11:09,160 --> 00:11:12,850
one of the individual techniques which

327
00:11:10,420 --> 00:11:14,620
are inside the persistence column so

328
00:11:12,850 --> 00:11:17,230
let's start with the registry gun keys

329
00:11:14,620 --> 00:11:18,370
so once we choose this there's some

330
00:11:17,230 --> 00:11:20,470
things that we want to start looking at

331
00:11:18,370 --> 00:11:22,779
how would you actually exploit this

332
00:11:20,470 --> 00:11:24,940
specific technique or test it depending

333
00:11:22,779 --> 00:11:26,680
on if you need to have you know choose

334
00:11:24,940 --> 00:11:28,840
your words wisely

335
00:11:26,680 --> 00:11:30,189
you know if you once you exploit it

336
00:11:28,840 --> 00:11:32,020
there's mitigation steps that are

337
00:11:30,190 --> 00:11:34,120
provided by the attack framework reached

338
00:11:32,020 --> 00:11:35,400
one of these individual techniques so

339
00:11:34,120 --> 00:11:37,180
you can use still bypass those

340
00:11:35,400 --> 00:11:40,840
mitigations because they're not always

341
00:11:37,180 --> 00:11:42,370
complete and if you can what artifacts

342
00:11:40,840 --> 00:11:43,900
are left behind if you've mitigated it

343
00:11:42,370 --> 00:11:45,850
or if you've tried to mitigate it or try

344
00:11:43,900 --> 00:11:47,500
to exploit it when it's mitigated or you

345
00:11:45,850 --> 00:11:49,390
just exporting it without mitigation so

346
00:11:47,500 --> 00:11:51,090
what artifacts are left behind so if we

347
00:11:49,390 --> 00:11:52,630
don't have a complete coverage of

348
00:11:51,090 --> 00:11:54,490
preventative measures in our

349
00:11:52,630 --> 00:11:55,720
infrastructure what can we see that's

350
00:11:54,490 --> 00:11:58,750
left behind that we can use that as

351
00:11:55,720 --> 00:12:00,520
detection techniques and then finally

352
00:11:58,750 --> 00:12:02,530
are there anything is there anything on

353
00:12:00,520 --> 00:12:05,400
you know the that you found in your

354
00:12:02,530 --> 00:12:07,870
research that is not actually in the

355
00:12:05,400 --> 00:12:09,819
technique itself so that we can then

356
00:12:07,870 --> 00:12:12,610
provide that feedback back to the attack

357
00:12:09,820 --> 00:12:14,020
community the attack framework itself is

358
00:12:12,610 --> 00:12:16,450
very community driven they're relying a

359
00:12:14,020 --> 00:12:19,990
lot on researchers to actually give

360
00:12:16,450 --> 00:12:21,280
feedback back to the framework itself so

361
00:12:19,990 --> 00:12:22,780
we started digging into the actual

362
00:12:21,280 --> 00:12:24,910
attack framework there's a description

363
00:12:22,780 --> 00:12:27,040
on the top this is a screenshot of their

364
00:12:24,910 --> 00:12:28,750
older website where cuz the description

365
00:12:27,040 --> 00:12:31,209
what it is so like this one for example

366
00:12:28,750 --> 00:12:34,000
is saying if you want to you know you

367
00:12:31,210 --> 00:12:36,730
know abuse this specific technique place

368
00:12:34,000 --> 00:12:38,290
registry key in the registry run key

369
00:12:36,730 --> 00:12:40,210
location but actually doesn't tell you

370
00:12:38,290 --> 00:12:43,390
you know what those locations are

371
00:12:40,210 --> 00:12:45,280
sometimes it's just you know you can do

372
00:12:43,390 --> 00:12:46,810
registry run keys or you know whatever

373
00:12:45,280 --> 00:12:48,089
you could do technique X and it doesn't

374
00:12:46,810 --> 00:12:49,959
really provide that level of information

375
00:12:48,090 --> 00:12:51,730
which is where you'd actually have to

376
00:12:49,960 --> 00:12:54,640
start digging into a little bit more as

377
00:12:51,730 --> 00:12:56,170
what's in the attack framework each one

378
00:12:54,640 --> 00:12:58,300
of the different techniques that we have

379
00:12:56,170 --> 00:13:00,069
on the attack framework itself provides

380
00:12:58,300 --> 00:13:02,709
examples so these are actual real world

381
00:13:00,070 --> 00:13:05,440
examples of this technique being abused

382
00:13:02,710 --> 00:13:07,630
in the wild by different threat actors

383
00:13:05,440 --> 00:13:11,140
or pieces of malware we're going to see

384
00:13:07,630 --> 00:13:13,150
okay apt 29 use registry keys or things

385
00:13:11,140 --> 00:13:15,100
like that and this is a really good way

386
00:13:13,150 --> 00:13:16,750
for security organizations to provide a

387
00:13:15,100 --> 00:13:18,730
justification for investing in attack

388
00:13:16,750 --> 00:13:19,720
where we can say you know we want to

389
00:13:18,730 --> 00:13:21,070
invest in this because we've actually

390
00:13:19,720 --> 00:13:22,750
seen this in the wild and this is

391
00:13:21,070 --> 00:13:26,530
actually happening to people around the

392
00:13:22,750 --> 00:13:27,550
world that we need to look at so being

393
00:13:26,530 --> 00:13:30,310
able to dig into different ones of these

394
00:13:27,550 --> 00:13:31,870
we can see on some of them if I you know

395
00:13:30,310 --> 00:13:33,430
some of them actually have you know this

396
00:13:31,870 --> 00:13:35,140
registry key here and things like that

397
00:13:33,430 --> 00:13:36,459
so we can start taking note of what you

398
00:13:35,140 --> 00:13:39,580
know these artifacts are for the

399
00:13:36,460 --> 00:13:41,709
specific the specific technique

400
00:13:39,580 --> 00:13:43,000
and this is very Wikipedia ish so you

401
00:13:41,709 --> 00:13:45,189
can kind of see on each the end of each

402
00:13:43,000 --> 00:13:47,110
one they have links to the actual

403
00:13:45,190 --> 00:13:49,360
referenced articles these are links to

404
00:13:47,110 --> 00:13:51,240
could be you know for this example links

405
00:13:49,360 --> 00:13:53,260
to Microsoft or it could be links to

406
00:13:51,240 --> 00:13:54,700
security vendors doing there you know

407
00:13:53,260 --> 00:13:56,529
published research so thing you know

408
00:13:54,700 --> 00:13:59,050
tripwire could be one could be semantic

409
00:13:56,529 --> 00:14:01,720
or McAfee or red canary or whoever would

410
00:13:59,050 --> 00:14:03,819
be they'd be all out there and then you

411
00:14:01,720 --> 00:14:05,470
start clicking on them and the perfect

412
00:14:03,820 --> 00:14:06,700
example I always start I try to start

413
00:14:05,470 --> 00:14:10,120
with this one when I'm teaching attack

414
00:14:06,700 --> 00:14:11,140
is if you go to the the first link you

415
00:14:10,120 --> 00:14:13,510
can see actually clicked on its

416
00:14:11,140 --> 00:14:15,310
different color is a documentation from

417
00:14:13,510 --> 00:14:17,920
Microsoft that says here's the registry

418
00:14:15,310 --> 00:14:19,149
run keys and there are four of them on

419
00:14:17,920 --> 00:14:22,089
there does anybody know how many

420
00:14:19,149 --> 00:14:25,120
registry run Keys there are a lot more

421
00:14:22,089 --> 00:14:27,250
than four so this it's not very well

422
00:14:25,120 --> 00:14:28,480
documented and even the attack framework

423
00:14:27,250 --> 00:14:30,100
doesn't document them because there's so

424
00:14:28,480 --> 00:14:32,080
many of them they just say use the

425
00:14:30,100 --> 00:14:33,459
sysinternals what are the auto runs use

426
00:14:32,080 --> 00:14:35,410
that to be able to detect all of them

427
00:14:33,459 --> 00:14:36,459
and even sysinternals doesn't document

428
00:14:35,410 --> 00:14:38,319
what they have and it's very difficult

429
00:14:36,459 --> 00:14:39,369
to find so being able to click through

430
00:14:38,320 --> 00:14:41,800
all of these you're gonna be able to see

431
00:14:39,370 --> 00:14:42,880
a lot of different you know artifacts

432
00:14:41,800 --> 00:14:44,199
that are left behind and more

433
00:14:42,880 --> 00:14:46,959
information about what the specific

434
00:14:44,200 --> 00:14:48,760
technique is and get a more in-depth

435
00:14:46,959 --> 00:14:49,869
level of understanding than you're

436
00:14:48,760 --> 00:14:51,220
actually gonna get from the attack

437
00:14:49,870 --> 00:14:53,829
frameworks the attack framework is great

438
00:14:51,220 --> 00:14:55,300
but this is way too much information to

439
00:14:53,829 --> 00:14:56,949
put on us individual webpage so it's

440
00:14:55,300 --> 00:14:58,870
great references to go look back and go

441
00:14:56,950 --> 00:14:59,890
through and no matter what you're gonna

442
00:14:58,870 --> 00:15:01,510
have to probably load up your friend

443
00:14:59,890 --> 00:15:04,360
google and do some original research

444
00:15:01,510 --> 00:15:06,040
yourself there's a ton of information

445
00:15:04,360 --> 00:15:07,630
about security on the web the great

446
00:15:06,040 --> 00:15:11,709
thing about security researchers and the

447
00:15:07,630 --> 00:15:13,120
security at you know world itself is we

448
00:15:11,709 --> 00:15:15,040
like to talk about what we're doing and

449
00:15:13,120 --> 00:15:17,140
show our research so there's a ton of

450
00:15:15,040 --> 00:15:18,880
information out there so load up the you

451
00:15:17,140 --> 00:15:20,529
know the google friend and and see what

452
00:15:18,880 --> 00:15:21,730
you can find there every single

453
00:15:20,529 --> 00:15:25,720
technique is gonna have something out

454
00:15:21,730 --> 00:15:27,279
there in the wild and then finally is

455
00:15:25,720 --> 00:15:29,290
actually go through and exploit this

456
00:15:27,279 --> 00:15:31,089
technique and there's a lot of talk

457
00:15:29,290 --> 00:15:32,949
about you know automating workflows and

458
00:15:31,089 --> 00:15:36,430
and and orchestrating things together

459
00:15:32,950 --> 00:15:38,410
this is a exercise that needs to be done

460
00:15:36,430 --> 00:15:39,969
very manual that's its kind of feels

461
00:15:38,410 --> 00:15:42,130
weird to say that but you need to do

462
00:15:39,970 --> 00:15:44,170
this a very manual very step-by-step

463
00:15:42,130 --> 00:15:45,399
process so you're not just loading up

464
00:15:44,170 --> 00:15:47,199
something and pushing a button saying

465
00:15:45,399 --> 00:15:48,699
hey look I got results now you need to

466
00:15:47,200 --> 00:15:49,750
load up the registry you need to you

467
00:15:48,699 --> 00:15:51,880
know right click and say I want to

468
00:15:49,750 --> 00:15:52,990
create a new key and type it in and then

469
00:15:51,880 --> 00:15:54,459
actually you know

470
00:15:52,990 --> 00:15:55,959
Sarge the system and see what it's doing

471
00:15:54,459 --> 00:15:57,790
and you get a much better understanding

472
00:15:55,959 --> 00:15:59,489
of what's going on and then you're gonna

473
00:15:57,790 --> 00:16:01,480
get something like this when they login

474
00:15:59,490 --> 00:16:02,470
or if you're like you know a security

475
00:16:01,480 --> 00:16:07,420
researcher you're just gonna load up

476
00:16:02,470 --> 00:16:08,980
calculator so here's the the objectives

477
00:16:07,420 --> 00:16:10,000
that I try to get out of the you know

478
00:16:08,980 --> 00:16:11,620
what I'm trying to teach them and say

479
00:16:10,000 --> 00:16:13,510
okay well what did you learn

480
00:16:11,620 --> 00:16:14,800
so was it in the actual attack framework

481
00:16:13,510 --> 00:16:16,360
that you pulled it out of or was it from

482
00:16:14,800 --> 00:16:17,430
your original research that you you

483
00:16:16,360 --> 00:16:19,839
clicked on a link and things like that

484
00:16:17,430 --> 00:16:21,130
and you know for me personally that's

485
00:16:19,839 --> 00:16:24,100
just so I can then provide that feedback

486
00:16:21,130 --> 00:16:25,450
back to the attack community there are

487
00:16:24,100 --> 00:16:26,890
entering this year he'd working on

488
00:16:25,450 --> 00:16:28,660
something and he actually is now listed

489
00:16:26,890 --> 00:16:30,490
as a contributor to the attack framework

490
00:16:28,660 --> 00:16:31,600
even though he had no you know history

491
00:16:30,490 --> 00:16:33,160
in the security world because he went

492
00:16:31,600 --> 00:16:34,930
through these steps and he found things

493
00:16:33,160 --> 00:16:36,880
that you know were on the internet and

494
00:16:34,930 --> 00:16:38,439
were talked about tested him himself

495
00:16:36,880 --> 00:16:39,820
went through the manual process and now

496
00:16:38,440 --> 00:16:42,010
he's you know listed as an attack

497
00:16:39,820 --> 00:16:44,020
contributor and then looking at the the

498
00:16:42,010 --> 00:16:46,060
mitigations versus the detection because

499
00:16:44,020 --> 00:16:47,620
every technique lists out here's the

500
00:16:46,060 --> 00:16:49,989
mitigation factors here's the detection

501
00:16:47,620 --> 00:16:51,490
factors you know did they work to the

502
00:16:49,990 --> 00:16:54,089
mitigation factors work almost every

503
00:16:51,490 --> 00:16:56,680
single one of the windows techniques

504
00:16:54,089 --> 00:16:57,760
says use application whitelisting such

505
00:16:56,680 --> 00:17:00,790
as AppLocker

506
00:16:57,760 --> 00:17:03,220
to stop this and if we go back to you

507
00:17:00,790 --> 00:17:05,290
know this one here we would have

508
00:17:03,220 --> 00:17:06,880
application whitelisting and our users

509
00:17:05,290 --> 00:17:08,230
need to load up you know chrome and an

510
00:17:06,880 --> 00:17:09,790
explorer or whatever would be so

511
00:17:08,230 --> 00:17:11,349
application whitelisting isn't gonna

512
00:17:09,790 --> 00:17:13,629
solve this technique right it's not

513
00:17:11,349 --> 00:17:15,219
gonna stop that so did it work and how

514
00:17:13,630 --> 00:17:16,839
would you i should go about bypassing it

515
00:17:15,220 --> 00:17:18,130
so you can then feed into then how would

516
00:17:16,839 --> 00:17:19,958
you detect it it's okay well we're not

517
00:17:18,130 --> 00:17:23,470
going to be able to prevent this

518
00:17:19,959 --> 00:17:24,610
specific attack but we can detect it

519
00:17:23,470 --> 00:17:26,439
because now we're monitoring the

520
00:17:24,609 --> 00:17:28,000
registry run keys and so on and so forth

521
00:17:26,439 --> 00:17:29,410
and then being able to see okay what

522
00:17:28,000 --> 00:17:30,550
worked what didn't what can be added so

523
00:17:29,410 --> 00:17:32,410
then we can then provide that back to

524
00:17:30,550 --> 00:17:34,210
the feet the community because it's a

525
00:17:32,410 --> 00:17:36,340
very community driven project and that's

526
00:17:34,210 --> 00:17:39,580
the very you know good power about the

527
00:17:36,340 --> 00:17:41,110
attack framework and then once they get

528
00:17:39,580 --> 00:17:43,240
into actually how you know they're

529
00:17:41,110 --> 00:17:44,469
getting into how they can exploit it so

530
00:17:43,240 --> 00:17:45,760
a lot of times it's very difficult to

531
00:17:44,470 --> 00:17:46,690
actually go through and understand what

532
00:17:45,760 --> 00:17:48,850
you're doing when you're attacking

533
00:17:46,690 --> 00:17:50,920
things so here's three resources which I

534
00:17:48,850 --> 00:17:53,050
use heavily when I'm going through and

535
00:17:50,920 --> 00:17:55,360
testing any attack framework first one

536
00:17:53,050 --> 00:17:57,879
is the adversary emulation plans from

537
00:17:55,360 --> 00:17:59,620
mitre themselves so they are going

538
00:17:57,880 --> 00:18:01,419
through and doing EDR evaluations

539
00:17:59,620 --> 00:18:03,699
endpoint detection response so testing

540
00:18:01,419 --> 00:18:05,380
tools like tripwires see how they you

541
00:18:03,700 --> 00:18:06,460
know actually you know they say we do

542
00:18:05,380 --> 00:18:07,690
attack but then they're actually at

543
00:18:06,460 --> 00:18:09,610
party that says yeah they actually do it

544
00:18:07,690 --> 00:18:10,840
correctly or there maybe they don't but

545
00:18:09,610 --> 00:18:13,029
it goes through and they have emulation

546
00:18:10,840 --> 00:18:15,070
plans for example like a PT three or

547
00:18:13,029 --> 00:18:17,499
Gothic panda or some fancy but I don't

548
00:18:15,070 --> 00:18:20,080
know one of the Bears or pandas and it

549
00:18:17,499 --> 00:18:22,419
says okay here are for this specific apt

550
00:18:20,080 --> 00:18:23,649
group we know that they did these 24

551
00:18:22,419 --> 00:18:25,990
different techniques and they list them

552
00:18:23,649 --> 00:18:28,239
out and it says for this specific

553
00:18:25,990 --> 00:18:29,769
technique here's how you would run

554
00:18:28,240 --> 00:18:31,360
something like a PowerShell commander a

555
00:18:29,769 --> 00:18:33,429
Windows internal command or if you have

556
00:18:31,360 --> 00:18:34,809
Metasploit here's the Metasploit module

557
00:18:33,429 --> 00:18:36,519
that you would use to load up once

558
00:18:34,809 --> 00:18:38,230
you've gained access to that machine if

559
00:18:36,519 --> 00:18:40,389
you use cobalt strike here's the cobalt

560
00:18:38,230 --> 00:18:42,039
strike module you would use so very

561
00:18:40,389 --> 00:18:44,619
broken down so it makes people that are

562
00:18:42,039 --> 00:18:46,690
not very red team familiar or don't know

563
00:18:44,619 --> 00:18:48,249
the offensive side of security makes it

564
00:18:46,690 --> 00:18:50,379
very easy to go through and actually

565
00:18:48,249 --> 00:18:53,889
understand how they can actually exploit

566
00:18:50,379 --> 00:18:56,709
or test individual techniques the next

567
00:18:53,889 --> 00:18:58,299
one is a apt simulator that's on github

568
00:18:56,710 --> 00:18:59,769
it's really good about just testing the

569
00:18:58,299 --> 00:19:03,730
defenses or detection measures overall

570
00:18:59,769 --> 00:19:05,740
not map to attack whatsoever and it does

571
00:19:03,730 --> 00:19:08,080
things like change host keys and sorry

572
00:19:05,740 --> 00:19:09,940
read entries in the host file so don't

573
00:19:08,080 --> 00:19:13,389
run this probably don't run any of them

574
00:19:09,940 --> 00:19:14,980
on production systems but really good

575
00:19:13,389 --> 00:19:16,330
it's really good tool and then the last

576
00:19:14,980 --> 00:19:19,470
one is a really really really good tool

577
00:19:16,330 --> 00:19:22,658
from red Canary called atomic red team

578
00:19:19,470 --> 00:19:24,129
wave talk to that guy if you want to

579
00:19:22,659 --> 00:19:25,840
know more about it but it's a really

580
00:19:24,129 --> 00:19:27,039
good tool it has all these different

581
00:19:25,840 --> 00:19:28,869
measures that are mapped directly into

582
00:19:27,039 --> 00:19:30,730
the attack framework and allows you to

583
00:19:28,869 --> 00:19:32,590
automate the the red team aspects of

584
00:19:30,730 --> 00:19:35,049
some of these very easily so you can say

585
00:19:32,590 --> 00:19:36,279
I want to test the registry run keys or

586
00:19:35,049 --> 00:19:37,960
you can actually go through and I think

587
00:19:36,279 --> 00:19:41,080
they can automate it so it'll just pull

588
00:19:37,960 --> 00:19:45,190
a random one at general right so very

589
00:19:41,080 --> 00:19:46,689
very very very good tool to use so I'm

590
00:19:45,190 --> 00:19:48,220
running low on time so I'm just gonna

591
00:19:46,690 --> 00:19:51,039
cut it short there because I can take

592
00:19:48,220 --> 00:19:53,200
any questions if you have but go through

593
00:19:51,039 --> 00:19:54,759
and the teaching the younger kids about

594
00:19:53,200 --> 00:19:56,860
security is a critical to our

595
00:19:54,759 --> 00:19:59,200
environment in our industry in general

596
00:19:56,860 --> 00:20:00,399
and the attack framework is a really

597
00:19:59,200 --> 00:20:01,899
really good tool because there's a ton

598
00:20:00,399 --> 00:20:03,340
of knowledge in there I mean I've been

599
00:20:01,899 --> 00:20:04,389
in the security industry for a long time

600
00:20:03,340 --> 00:20:07,779
and when I first started going through

601
00:20:04,389 --> 00:20:09,519
it I've learned so much about it so you

602
00:20:07,779 --> 00:20:10,749
know everybody that guarantee everybody

603
00:20:09,519 --> 00:20:13,029
in this room is gonna learn something

604
00:20:10,749 --> 00:20:16,649
from this framework so for that I'll

605
00:20:13,029 --> 00:20:19,799
open up to questions and go from there

606
00:20:16,649 --> 00:20:19,799
yes sir

607
00:20:25,720 --> 00:20:33,429
which product of the tack framework the

608
00:20:31,030 --> 00:20:35,678
attack framework itself can go to attack

609
00:20:33,429 --> 00:20:37,630
my torgue and it's all listed on there

610
00:20:35,679 --> 00:20:39,490
they do have that they do have a github

611
00:20:37,630 --> 00:20:40,840
page as well that has a lot of the

612
00:20:39,490 --> 00:20:42,070
attacks stuff on there but if you go

613
00:20:40,840 --> 00:20:43,629
just go to attack that matter that org

614
00:20:42,070 --> 00:20:48,490
that's where you gonna find all the

615
00:20:43,630 --> 00:20:50,170
information on that cool if there's no

616
00:20:48,490 --> 00:20:51,490
questions and thank you and I'll be up

617
00:20:50,170 --> 00:20:53,820
here if you want to talk in person in

618
00:20:51,490 --> 00:20:53,820
private

619
00:21:04,820 --> 00:21:06,879
you

