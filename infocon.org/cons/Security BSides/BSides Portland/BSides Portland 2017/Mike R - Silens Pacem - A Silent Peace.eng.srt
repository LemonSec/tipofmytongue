1
00:00:14,430 --> 00:00:21,310
and I'm my car here's what we're gonna

2
00:00:19,450 --> 00:00:24,009
talk about a little bit Who am I

3
00:00:21,310 --> 00:00:26,759
what are extensions why care and sort of

4
00:00:24,010 --> 00:00:28,840
tool release a little bit about me I

5
00:00:26,760 --> 00:00:30,910
graduated from Rochester Institute of

6
00:00:28,840 --> 00:00:34,030
Technology with a degree in computing

7
00:00:30,910 --> 00:00:35,740
security back in 2013 and I am a

8
00:00:34,030 --> 00:00:38,560
sponsorship coordinator so that's why

9
00:00:35,740 --> 00:00:40,840
the last talk I'll get the slides from

10
00:00:38,560 --> 00:00:44,350
him and be able to determine how best to

11
00:00:40,840 --> 00:00:46,420
disseminate that to everybody best

12
00:00:44,350 --> 00:00:48,220
fashion according to everybody I think

13
00:00:46,420 --> 00:00:51,760
it might either be through the website

14
00:00:48,220 --> 00:00:53,670
or through a common Dropbox or something

15
00:00:51,760 --> 00:00:57,339
not exactly Dropbox to put some source

16
00:00:53,670 --> 00:00:58,710
along with the videos just a little bit

17
00:00:57,340 --> 00:01:00,670
of history of extensions you know

18
00:00:58,710 --> 00:01:02,110
extensions are something that you know

19
00:01:00,670 --> 00:01:06,610
that can be used to modify the behavior

20
00:01:02,110 --> 00:01:09,100
or add some features to the browser you

21
00:01:06,610 --> 00:01:10,810
know its current browser share of chrome

22
00:01:09,100 --> 00:01:14,140
having the majority of people just using

23
00:01:10,810 --> 00:01:16,060
it so that's why I decide to focus on

24
00:01:14,140 --> 00:01:20,350
chrome this is got 55 percent of the

25
00:01:16,060 --> 00:01:22,840
market also as I show there that chrome

26
00:01:20,350 --> 00:01:26,530
released in 2009 but Firefox and

27
00:01:22,840 --> 00:01:28,689
Internet Explorer and then now Safari is

28
00:01:26,530 --> 00:01:30,880
gonna start having browser extensions so

29
00:01:28,689 --> 00:01:32,859
it's not just one browser it's starting

30
00:01:30,880 --> 00:01:37,509
to become more pervasive obviously not

31
00:01:32,859 --> 00:01:41,890
on the phones but on the laptops and

32
00:01:37,509 --> 00:01:45,039
desktop platforms so I'm like err well

33
00:01:41,890 --> 00:01:47,229
I've seen some Stanford and MIT studies

34
00:01:45,039 --> 00:01:48,819
have shown that the extensions are over

35
00:01:47,229 --> 00:01:52,600
privileged like they I think it was a

36
00:01:48,819 --> 00:01:55,149
majority of the top 100 extensions have

37
00:01:52,600 --> 00:01:57,999
been given to men too much privilege and

38
00:01:55,149 --> 00:02:00,310
the the past at least and I know they're

39
00:01:57,999 --> 00:02:03,369
getting a little better the security

40
00:02:00,310 --> 00:02:05,469
model did not do enough to protect the

41
00:02:03,369 --> 00:02:07,659
users to mitigate things such as

42
00:02:05,469 --> 00:02:11,140
cross-site scripting and necessarily

43
00:02:07,659 --> 00:02:13,480
stealing data and some thing that we've

44
00:02:11,140 --> 00:02:16,149
started to see now particularly over the

45
00:02:13,480 --> 00:02:17,739
last compared to the past few years that

46
00:02:16,150 --> 00:02:19,420
I've been looking at this is that we

47
00:02:17,740 --> 00:02:21,040
started to see that these extensions

48
00:02:19,420 --> 00:02:23,470
have become targets you know you see

49
00:02:21,040 --> 00:02:24,909
these examples of you know say adblock

50
00:02:23,470 --> 00:02:27,670
plus literally that was like last week

51
00:02:24,909 --> 00:02:30,970
or the 37,000 people downloaded

52
00:02:27,670 --> 00:02:32,530
adblock plus so I think all they did was

53
00:02:30,970 --> 00:02:34,660
literally just put under the same name

54
00:02:32,530 --> 00:02:36,910
so I mean it's if you can't tell that

55
00:02:34,660 --> 00:02:38,799
it's under the same name then how you

56
00:02:36,910 --> 00:02:41,799
gonna tell is secure it is you know we

57
00:02:38,800 --> 00:02:45,069
had the Cisco on WebEx remote command

58
00:02:41,800 --> 00:02:47,640
execution no they did a great job with

59
00:02:45,069 --> 00:02:49,329
that they fixed it like right away so

60
00:02:47,640 --> 00:02:51,190
something like that would be really

61
00:02:49,330 --> 00:02:52,630
great they're a great example that where

62
00:02:51,190 --> 00:02:56,230
if they find something wrong with it

63
00:02:52,630 --> 00:03:00,010
you fix it I actually use WebEx and that

64
00:02:56,230 --> 00:03:04,030
extension in my work so and you know

65
00:03:00,010 --> 00:03:05,950
you've got the last two which are people

66
00:03:04,030 --> 00:03:07,569
really hijacking the developers which is

67
00:03:05,950 --> 00:03:08,859
a different route hijacking the

68
00:03:07,569 --> 00:03:11,530
extensions rather than going after the

69
00:03:08,860 --> 00:03:13,480
extensions themselves but hijacking

70
00:03:11,530 --> 00:03:16,030
developers is they've got developer

71
00:03:13,480 --> 00:03:19,959
accounts so you've got some industry

72
00:03:16,030 --> 00:03:22,090
efforts Google is now putting out more

73
00:03:19,959 --> 00:03:24,130
security features and tools to help

74
00:03:22,090 --> 00:03:29,380
users basically be able to make that

75
00:03:24,130 --> 00:03:30,790
decision of what they can do to analyze

76
00:03:29,380 --> 00:03:32,920
and look at those extensions but they're

77
00:03:30,790 --> 00:03:35,470
really new that I just looked at just

78
00:03:32,920 --> 00:03:39,040
saw this a few days ago and you have

79
00:03:35,470 --> 00:03:40,450
some enterprise tools that are great if

80
00:03:39,040 --> 00:03:42,429
you're an enterprise but they're

81
00:03:40,450 --> 00:03:45,040
necessary sometimes more focused on the

82
00:03:42,430 --> 00:03:47,730
app side of it they'll also plug in with

83
00:03:45,040 --> 00:03:53,380
your Google Drive environment and other

84
00:03:47,730 --> 00:03:54,730
Google features such as slides and Excel

85
00:03:53,380 --> 00:03:58,359
to be able to look for things such as

86
00:03:54,730 --> 00:04:00,850
social security numbers or maybe credit

87
00:03:58,359 --> 00:04:03,070
card numbers but not necessarily focused

88
00:04:00,850 --> 00:04:05,769
towards extensions in extensions

89
00:04:03,070 --> 00:04:09,370
themselves that don't use the Google

90
00:04:05,769 --> 00:04:13,870
environment and a little bit about the

91
00:04:09,370 --> 00:04:15,609
tool it was written in Python and it

92
00:04:13,870 --> 00:04:19,209
takes an extension that they user

93
00:04:15,609 --> 00:04:20,799
installs reviews the code and assigns a

94
00:04:19,209 --> 00:04:23,080
score to some of the manifest options

95
00:04:20,798 --> 00:04:24,849
and the manifest is just the table of

96
00:04:23,080 --> 00:04:27,909
contents and basically says this is what

97
00:04:24,850 --> 00:04:31,840
is going to be done and it does this

98
00:04:27,910 --> 00:04:34,090
because when a user installs a Chrome

99
00:04:31,840 --> 00:04:36,159
extension it copies all the resources to

100
00:04:34,090 --> 00:04:38,440
their desktop so it's not pulling

101
00:04:36,159 --> 00:04:40,620
anything from Google it's just one

102
00:04:38,440 --> 00:04:41,730
Macbeth sure it's not

103
00:04:40,620 --> 00:04:43,169
the only thing that it is is that

104
00:04:41,730 --> 00:04:45,419
they're coming from the Google store and

105
00:04:43,169 --> 00:04:45,810
you're running it in Chrome but that's

106
00:04:45,419 --> 00:04:48,990
it

107
00:04:45,810 --> 00:04:53,220
and this doesn't and this is not meant

108
00:04:48,990 --> 00:04:54,960
to be a tool that like does anything bad

109
00:04:53,220 --> 00:04:58,200
for the app developers as well it's just

110
00:04:54,960 --> 00:05:02,669
giving us the users an opportunity to

111
00:04:58,200 --> 00:05:05,090
look at what is being used okay and

112
00:05:02,669 --> 00:05:09,240
here's some of the important security

113
00:05:05,090 --> 00:05:11,310
related features that we would look at

114
00:05:09,240 --> 00:05:14,220
now and would want to look at going

115
00:05:11,310 --> 00:05:17,520
forward the permissions the content

116
00:05:14,220 --> 00:05:18,660
security policy are two things that I

117
00:05:17,520 --> 00:05:21,539
definitely take a look at right now

118
00:05:18,660 --> 00:05:23,720
because our it would say most important

119
00:05:21,540 --> 00:05:25,919
I'll show you why in a minute a

120
00:05:23,720 --> 00:05:27,510
background the scripts that run in the

121
00:05:25,919 --> 00:05:31,139
background sometimes know it's really

122
00:05:27,510 --> 00:05:33,599
unknown what happens well and when they

123
00:05:31,139 --> 00:05:36,120
run they can run in the beginning before

124
00:05:33,600 --> 00:05:38,340
the page is loaded after the page is

125
00:05:36,120 --> 00:05:41,160
loaded or while it's loading so it's

126
00:05:38,340 --> 00:05:42,750
really interesting as well as content

127
00:05:41,160 --> 00:05:45,180
scripts as well so they're JavaScript

128
00:05:42,750 --> 00:05:48,600
files that run in the web page so they

129
00:05:45,180 --> 00:05:51,479
can do almost anything as well so and I

130
00:05:48,600 --> 00:05:54,720
say that the permissions earlier these

131
00:05:51,479 --> 00:05:56,520
permissions will not provide a prompt so

132
00:05:54,720 --> 00:05:58,680
if you're gonna install a Chrome

133
00:05:56,520 --> 00:05:59,669
extension it will not tell you that is

134
00:05:58,680 --> 00:06:02,280
looking at your cookies

135
00:05:59,669 --> 00:06:04,320
okay and it will not tell you that is

136
00:06:02,280 --> 00:06:06,809
looking at your webs web browsing

137
00:06:04,320 --> 00:06:09,419
history that's what the web requests and

138
00:06:06,810 --> 00:06:12,660
the web request blocking are they're

139
00:06:09,419 --> 00:06:14,789
basically allowing the extension to look

140
00:06:12,660 --> 00:06:18,030
at all the websites you visit and edit

141
00:06:14,789 --> 00:06:20,180
them in flight so essentially it could

142
00:06:18,030 --> 00:06:22,169
be looking at your cookies and all your

143
00:06:20,180 --> 00:06:28,919
browsing history without you ever

144
00:06:22,169 --> 00:06:30,570
knowing it so in theory yes this is this

145
00:06:28,919 --> 00:06:33,419
is straight from the chrome chrome store

146
00:06:30,570 --> 00:06:36,599
Chrome's website Google website yeah

147
00:06:33,419 --> 00:06:38,280
this is a copy/paste that's why this is

148
00:06:36,600 --> 00:06:40,200
what my what it looks like when I write

149
00:06:38,280 --> 00:06:44,489
it this is a screen grab right from the

150
00:06:40,200 --> 00:06:46,440
Google web site so yeah

151
00:06:44,490 --> 00:06:50,370
an interesting find that I had was on

152
00:06:46,440 --> 00:06:52,680
from cami HQ I am NOT say anything bad

153
00:06:50,370 --> 00:06:54,450
about this but just to back on the theme

154
00:06:52,680 --> 00:06:57,090
of like look what you can find

155
00:06:54,450 --> 00:07:00,240
when you're just looking at things this

156
00:06:57,090 --> 00:07:04,049
is a great tool that is used to edit

157
00:07:00,240 --> 00:07:06,690
your PDFs but it has access so like the

158
00:07:04,050 --> 00:07:08,370
your file to a file share well I have

159
00:07:06,690 --> 00:07:11,100
seen need YouTube video access if you're

160
00:07:08,370 --> 00:07:12,930
editing PDFs like I don't know why and

161
00:07:11,100 --> 00:07:16,110
also a billing software I can understand

162
00:07:12,930 --> 00:07:18,600
that you want it to tie in but it has

163
00:07:16,110 --> 00:07:20,550
two different billing softwares and some

164
00:07:18,600 --> 00:07:23,400
file sharing I'm like okay that's a

165
00:07:20,550 --> 00:07:27,840
little bit odd to me and over on the

166
00:07:23,400 --> 00:07:30,299
left over here the mouse is over here

167
00:07:27,840 --> 00:07:33,510
you see all the different permissions

168
00:07:30,300 --> 00:07:35,730
that it has and requests access to so it

169
00:07:33,510 --> 00:07:37,260
requests access to some of that web

170
00:07:35,730 --> 00:07:38,460
request and web blocking which I

171
00:07:37,260 --> 00:07:40,650
mentioned earlier are not going to be

172
00:07:38,460 --> 00:07:41,370
notified so you're not going to get it's

173
00:07:40,650 --> 00:07:43,710
not going to tell you that it's

174
00:07:41,370 --> 00:07:53,010
accessing it because here it says it's

175
00:07:43,710 --> 00:07:54,989
gonna visit but not edit it so yeah I'll

176
00:07:53,010 --> 00:07:58,530
show you a demo but on what it is

177
00:07:54,990 --> 00:08:01,250
ascetic it downloads it and on the it

178
00:07:58,530 --> 00:08:05,130
there just if you guys look at the files

179
00:08:01,250 --> 00:08:07,950
for Chrome on your machine it will have

180
00:08:05,130 --> 00:08:09,780
downloaded in in those locations and you

181
00:08:07,950 --> 00:08:13,409
can simply go in there and look at the

182
00:08:09,780 --> 00:08:15,450
manifest.json file and then literally

183
00:08:13,410 --> 00:08:18,600
going go through this and the code isn't

184
00:08:15,450 --> 00:08:19,740
anything special some something else

185
00:08:18,600 --> 00:08:21,330
that I found some other interesting

186
00:08:19,740 --> 00:08:23,940
finds was remember I mentioned the cisco

187
00:08:21,330 --> 00:08:26,250
webex vulnerability a while ago yeah

188
00:08:23,940 --> 00:08:28,050
they have since to fix the issue that

189
00:08:26,250 --> 00:08:29,940
the issue and what I'm about to say is

190
00:08:28,050 --> 00:08:33,060
but when it right as it came out there

191
00:08:29,940 --> 00:08:34,979
was no content security policy so you

192
00:08:33,059 --> 00:08:36,900
theoretically had a cross-site scripting

193
00:08:34,979 --> 00:08:41,030
vulnerability that had no restrictions

194
00:08:36,900 --> 00:08:43,079
on it so but they have since fixed it

195
00:08:41,030 --> 00:08:45,780
going forward I would like to analyze

196
00:08:43,080 --> 00:08:47,880
those content scripts and background

197
00:08:45,780 --> 00:08:51,120
scripts as well as the URLs that the

198
00:08:47,880 --> 00:08:53,760
system pulls in the content security

199
00:08:51,120 --> 00:08:58,440
policy gives explicit access to what it

200
00:08:53,760 --> 00:09:00,839
can pull data from but I currently don't

201
00:08:58,440 --> 00:09:05,040
have the

202
00:09:00,839 --> 00:09:10,570
capacity to analyze it right now a

203
00:09:05,040 --> 00:09:15,490
little give a little demo here so yeah

204
00:09:10,570 --> 00:09:17,290
I've got tool right here run it we're

205
00:09:15,490 --> 00:09:21,100
gonna look at kami I don't know why just

206
00:09:17,290 --> 00:09:23,620
easy so I type in the gooood which is

207
00:09:21,100 --> 00:09:25,570
the ID of the extension I've already

208
00:09:23,620 --> 00:09:27,490
installed it on my machine just to save

209
00:09:25,570 --> 00:09:29,020
some time and no need to see me

210
00:09:27,490 --> 00:09:32,140
literally hit three buttons to say I

211
00:09:29,020 --> 00:09:34,630
want to install this but there it's

212
00:09:32,140 --> 00:09:38,830
going through it it's saying this is

213
00:09:34,630 --> 00:09:40,270
version 2.0 dot nine one six five it's

214
00:09:38,830 --> 00:09:44,440
gonna review in the background and

215
00:09:40,270 --> 00:09:48,939
content scripts and as you can see here

216
00:09:44,440 --> 00:09:51,220
it's got a result text file and let's

217
00:09:48,940 --> 00:09:53,230
see how it's changed in the last little

218
00:09:51,220 --> 00:09:57,550
bit it looks like it also accesses your

219
00:09:53,230 --> 00:10:00,760
Google Drive so that's interesting it

220
00:09:57,550 --> 00:10:01,870
still looks like it still looks like

221
00:10:00,760 --> 00:10:10,029
they're accessing all those websites

222
00:10:01,870 --> 00:10:12,100
that guys into what they're resourcing

223
00:10:10,029 --> 00:10:13,930
and what they're calling from so that

224
00:10:12,100 --> 00:10:15,760
content security policy is literally it

225
00:10:13,930 --> 00:10:18,010
like almost like a whitelist to what

226
00:10:15,760 --> 00:10:20,950
resources just calling from so those are

227
00:10:18,010 --> 00:10:23,260
a lot of resources and you could sort of

228
00:10:20,950 --> 00:10:28,390
see here it's 14 websites to different

229
00:10:23,260 --> 00:10:30,000
sources sources like a guy for what

230
00:10:28,390 --> 00:10:34,029
sources is calling from there's like

231
00:10:30,000 --> 00:10:37,360
object sources image sources and there's

232
00:10:34,029 --> 00:10:39,880
like script sources so it only has two

233
00:10:37,360 --> 00:10:41,830
restrictions on two of those one unsafe

234
00:10:39,880 --> 00:10:45,130
coding practice which is the unsafe eval

235
00:10:41,830 --> 00:10:48,279
and it calls from itself twice so and

236
00:10:45,130 --> 00:10:53,160
here's a little score on it I assign

237
00:10:48,279 --> 00:10:57,910
scores for zero being the strictest and

238
00:10:53,160 --> 00:11:00,390
one calling from itself and three for

239
00:10:57,910 --> 00:11:03,189
unsafe evals and unsafe used to zip code

240
00:11:00,390 --> 00:11:05,439
so they gave me the score of sixteen

241
00:11:03,190 --> 00:11:06,849
point five and

242
00:11:05,439 --> 00:11:08,618
instead I was wanting to look at

243
00:11:06,849 --> 00:11:11,109
websites I sort of gave it some options

244
00:11:08,619 --> 00:11:14,559
for initial scope scoring all I did was

245
00:11:11,109 --> 00:11:16,899
I added up the score and divided by the

246
00:11:14,559 --> 00:11:19,539
number of items so sixteen point five

247
00:11:16,899 --> 00:11:22,149
which is considerable considering that

248
00:11:19,539 --> 00:11:26,079
you've got a large number of resources

249
00:11:22,149 --> 00:11:27,669
as well as a ws bucket in there who

250
00:11:26,079 --> 00:11:29,618
knows what that AWS bucket is doing

251
00:11:27,669 --> 00:11:31,269
because it's an extension you don't

252
00:11:29,619 --> 00:11:36,279
really have access into what it is doing

253
00:11:31,269 --> 00:11:40,589
so and permissions I mentioned earlier I

254
00:11:36,279 --> 00:11:43,149
have each permission as well as a number

255
00:11:40,589 --> 00:11:44,079
this is just an example for what I think

256
00:11:43,149 --> 00:11:46,629
that they're worth

257
00:11:44,079 --> 00:11:48,608
you guys can change them in the code and

258
00:11:46,629 --> 00:11:51,399
then what they actually do a description

259
00:11:48,609 --> 00:11:53,289
so for those people for those if you

260
00:11:51,399 --> 00:11:55,739
need to explain it to somebody else it's

261
00:11:53,289 --> 00:11:59,139
an easy explanation as right there I

262
00:11:55,739 --> 00:12:01,269
took it took everything like a total

263
00:11:59,139 --> 00:12:05,079
risk and divided it so the average score

264
00:12:01,269 --> 00:12:08,470
is 1.75 which is medium because I did it

265
00:12:05,079 --> 00:12:11,199
from 1 to 3 on one is low to is medium 3

266
00:12:08,470 --> 00:12:13,899
is high I apologize for the small text

267
00:12:11,199 --> 00:12:17,589
there I was trying to read it I I'm

268
00:12:13,899 --> 00:12:22,119
gonna make this available I'm not sure

269
00:12:17,589 --> 00:12:24,789
if I like the name of silence pack them

270
00:12:22,119 --> 00:12:28,059
yet I just sometimes I have trouble

271
00:12:24,789 --> 00:12:29,949
coming up with names for things so but

272
00:12:28,059 --> 00:12:32,738
I'm gonna make it available I'm gonna up

273
00:12:29,949 --> 00:12:35,289
I mentioned besides PGX and I'll make it

274
00:12:32,739 --> 00:12:38,759
available to the public going forward so

275
00:12:35,289 --> 00:12:38,759
other any questions

276
00:12:45,470 --> 00:12:47,530
you

