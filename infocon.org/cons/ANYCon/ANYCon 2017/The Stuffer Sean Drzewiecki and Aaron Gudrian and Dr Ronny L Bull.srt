1
00:00:10,730 --> 00:00:14,009
<font color="#E5E5E5">okay I'm Ronnie bol I'm a professor at</font>

2
00:00:13,049 --> 00:00:16,590
Utica<font color="#CCCCCC"> College</font>

3
00:00:14,009 --> 00:00:19,020
these two are my students<font color="#CCCCCC"> Shawn</font><font color="#E5E5E5"> and Erin</font>

4
00:00:16,590 --> 00:00:20,820
<font color="#CCCCCC">they did this</font><font color="#E5E5E5"> stuff er is a project for</font>

5
00:00:19,020 --> 00:00:22,500
a class<font color="#E5E5E5"> of mine basically I kind of</font>

6
00:00:20,820 --> 00:00:24,510
challenged them to<font color="#E5E5E5"> see if they could do</font>

7
00:00:22,500 --> 00:00:25,769
this and<font color="#E5E5E5"> they accepted it</font><font color="#CCCCCC"> so I'm going</font>

8
00:00:24,510 --> 00:00:28,680
<font color="#CCCCCC">to</font><font color="#E5E5E5"> let them take</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> from here and</font><font color="#CCCCCC"> then</font>

9
00:00:25,769 --> 00:00:29,598
present to<font color="#CCCCCC"> you</font><font color="#E5E5E5"> guys</font><font color="#CCCCCC"> the stuffer thank</font>

10
00:00:28,680 --> 00:00:32,009
you

11
00:00:29,599 --> 00:00:34,350
so before we<font color="#CCCCCC"> invent the stuffer is they</font>

12
00:00:32,009 --> 00:00:37,950
give you<font color="#CCCCCC"> a quick rundown on what a TCP</font>

13
00:00:34,350 --> 00:00:40,500
header is for those<font color="#E5E5E5"> who need it</font><font color="#CCCCCC"> so TCP</font>

14
00:00:37,950 --> 00:00:44,160
<font color="#CCCCCC">header deals with the transport of the</font>

15
00:00:40,500 --> 00:00:46,430
<font color="#E5E5E5">packets sent</font><font color="#CCCCCC"> along the</font><font color="#E5E5E5"> internet so you</font>

16
00:00:44,160 --> 00:00:49,169
know it has<font color="#E5E5E5"> the source destination</font>

17
00:00:46,430 --> 00:00:51,210
<font color="#E5E5E5">sequence where you're going where</font><font color="#CCCCCC"> you're</font>

18
00:00:49,170 --> 00:00:54,120
coming from size of the window

19
00:00:51,210 --> 00:00:57,350
all we're concerned<font color="#CCCCCC"> about are going to</font>

20
00:00:54,120 --> 00:01:00,570
<font color="#E5E5E5">be two things the reserve and padding</font>

21
00:00:57,350 --> 00:01:03,989
<font color="#E5E5E5">those don't carry any data while</font><font color="#CCCCCC"> the</font>

22
00:01:00,570 --> 00:01:09,780
padding is padding a small<font color="#E5E5E5"> bite six and</font>

23
00:01:03,989 --> 00:01:14,850
the<font color="#E5E5E5"> reserved six</font><font color="#CCCCCC"> padding's variable but</font>

24
00:01:09,780 --> 00:01:16,140
yeah typically<font color="#CCCCCC"> don't carry data there if</font>

25
00:01:14,850 --> 00:01:19,408
you<font color="#E5E5E5"> look at the documentation</font><font color="#CCCCCC"> they</font>

26
00:01:16,140 --> 00:01:23,689
reserved for future use<font color="#CCCCCC"> so that means we</font>

27
00:01:19,409 --> 00:01:28,530
can play with<font color="#E5E5E5"> it so teeth so the stuffer</font>

28
00:01:23,689 --> 00:01:31,949
is a<font color="#CCCCCC"> package stuffing encounter many</font>

29
00:01:28,530 --> 00:01:33,900
<font color="#E5E5E5">times I say stuffer stuffing</font><font color="#CCCCCC"> we'll take</font>

30
00:01:31,950 --> 00:01:35,909
the padding in the reserved sections of

31
00:01:33,900 --> 00:01:37,229
said TCP headers and send them on the

32
00:01:35,909 --> 00:01:40,680
internet<font color="#E5E5E5"> actually stuffing with our own</font>

33
00:01:37,229 --> 00:01:45,329
information so what<font color="#E5E5E5"> is stuffer this is</font>

34
00:01:40,680 --> 00:01:47,549
it<font color="#CCCCCC"> run in</font><font color="#E5E5E5"> Python with the help of</font><font color="#CCCCCC"> scatty</font>

35
00:01:45,329 --> 00:01:51,240
to do all the heavy<font color="#CCCCCC"> lifting for us all</font>

36
00:01:47,549 --> 00:01:53,009
we're doing<font color="#E5E5E5"> is making a packet putting</font>

37
00:01:51,240 --> 00:01:57,449
our own<font color="#CCCCCC"> data in it sending it</font><font color="#E5E5E5"> along</font>

38
00:01:53,009 --> 00:01:58,890
where we<font color="#E5E5E5"> want to</font><font color="#CCCCCC"> go the code is</font><font color="#E5E5E5"> on</font>

39
00:01:57,450 --> 00:02:01,340
github you<font color="#E5E5E5"> do not need to take a picture</font>

40
00:01:58,890 --> 00:02:01,340
of<font color="#E5E5E5"> the slides</font>

41
00:02:02,659 --> 00:02:09,410
so yeah this<font color="#E5E5E5"> is our</font><font color="#CCCCCC"> first prototype</font>

42
00:02:05,360 --> 00:02:13,010
<font color="#E5E5E5">proof-of-concept</font><font color="#CCCCCC"> our demos gotten a bit</font>

43
00:02:09,410 --> 00:02:17,680
out of<font color="#E5E5E5"> hand since our project so you'll</font>

44
00:02:13,010 --> 00:02:23,030
see<font color="#E5E5E5"> that in a</font><font color="#CCCCCC"> minute</font><font color="#E5E5E5"> but um yeah so</font>

45
00:02:17,680 --> 00:02:23,989
<font color="#E5E5E5">you're them an hour</font><font color="#CCCCCC"> okay so I</font><font color="#E5E5E5"> get to</font>

46
00:02:23,030 --> 00:02:25,280
talk to<font color="#CCCCCC"> you about the practical</font>

47
00:02:23,989 --> 00:02:27,140
applications of<font color="#E5E5E5"> this thing that doesn't</font>

48
00:02:25,280 --> 00:02:27,830
seem very practical at<font color="#E5E5E5"> all that's my</font>

49
00:02:27,140 --> 00:02:30,410
favorite part

50
00:02:27,830 --> 00:02:31,580
so one of the most common scenarios to

51
00:02:30,410 --> 00:02:33,680
use this is once you've hidden

52
00:02:31,580 --> 00:02:35,630
<font color="#E5E5E5">information in the padding and flags the</font>

53
00:02:33,680 --> 00:02:37,310
<font color="#E5E5E5">reserved bits so that you know to look</font>

54
00:02:35,630 --> 00:02:38,750
for<font color="#CCCCCC"> the information</font><font color="#E5E5E5"> while it's there you</font>

55
00:02:37,310 --> 00:02:40,280
can actually<font color="#E5E5E5"> set up a lot</font><font color="#CCCCCC"> of covert data</font>

56
00:02:38,750 --> 00:02:42,110
channels between<font color="#E5E5E5"> two people who both</font>

57
00:02:40,280 --> 00:02:43,549
know that the<font color="#E5E5E5"> program is installed in</font>

58
00:02:42,110 --> 00:02:46,580
their computers<font color="#E5E5E5"> we'll come back to those</font>

59
00:02:43,549 --> 00:02:49,670
that don't<font color="#CCCCCC"> later</font><font color="#E5E5E5"> so you</font><font color="#CCCCCC"> can actually set</font>

60
00:02:46,580 --> 00:02:51,620
up a hidden channel<font color="#E5E5E5"> in which you can</font>

61
00:02:49,670 --> 00:02:53,298
pass<font color="#E5E5E5"> surprisingly large amounts of</font>

62
00:02:51,620 --> 00:02:56,360
information<font color="#E5E5E5"> on things like video streams</font>

63
00:02:53,299 --> 00:02:59,090
over<font color="#E5E5E5"> existing internet connections</font>

64
00:02:56,360 --> 00:03:01,130
specifically any sort of TCP socket<font color="#E5E5E5"> now</font>

65
00:02:59,090 --> 00:03:03,410
this has<font color="#E5E5E5"> the benefit of not being picked</font>

66
00:03:01,130 --> 00:03:05,269
<font color="#E5E5E5">up by most firewalls because nobody does</font>

67
00:03:03,410 --> 00:03:06,380
<font color="#E5E5E5">deep packet inspection to see</font><font color="#CCCCCC"> whether</font><font color="#E5E5E5"> or</font>

68
00:03:05,269 --> 00:03:07,700
<font color="#CCCCCC">not you've played around with the</font>

69
00:03:06,380 --> 00:03:10,459
<font color="#E5E5E5">reserved bits and whether or not the</font>

70
00:03:07,700 --> 00:03:12,290
padding is actually<font color="#E5E5E5"> zeros so you can</font>

71
00:03:10,459 --> 00:03:13,609
actually<font color="#E5E5E5"> hijack existing data streams</font>

72
00:03:12,290 --> 00:03:15,798
<font color="#E5E5E5">inside of a network which you've already</font>

73
00:03:13,609 --> 00:03:18,560
exploited get communications going

74
00:03:15,799 --> 00:03:21,260
<font color="#E5E5E5">through extract files send messages</font>

75
00:03:18,560 --> 00:03:22,880
<font color="#E5E5E5">there's no encryption built in but I</font>

76
00:03:21,260 --> 00:03:24,500
suppose you<font color="#CCCCCC"> can encrypt your text before</font>

77
00:03:22,880 --> 00:03:26,060
<font color="#E5E5E5">sending it through either with a</font><font color="#CCCCCC"> cypher</font>

78
00:03:24,500 --> 00:03:28,579
or anything<font color="#E5E5E5"> that</font><font color="#CCCCCC"> actually counts as</font>

79
00:03:26,060 --> 00:03:30,470
encryption<font color="#E5E5E5"> but we don't have to worry</font>

80
00:03:28,579 --> 00:03:32,750
<font color="#E5E5E5">about anything such as data</font><font color="#CCCCCC"> integrity</font>

81
00:03:30,470 --> 00:03:34,489
because we use TCP<font color="#CCCCCC"> into the UDP so it's</font>

82
00:03:32,750 --> 00:03:36,560
all<font color="#CCCCCC"> guaranteed to arrive</font><font color="#E5E5E5"> there in the</font>

83
00:03:34,489 --> 00:03:38,420
correct order if it doesn't it gets sent

84
00:03:36,560 --> 00:03:40,519
<font color="#E5E5E5">again which is great for us</font><font color="#CCCCCC"> because</font>

85
00:03:38,420 --> 00:03:42,920
we're lazy we don't want to worry about

86
00:03:40,519 --> 00:03:46,280
<font color="#E5E5E5">that so we let them take care of it for</font>

87
00:03:42,920 --> 00:03:47,480
us<font color="#CCCCCC"> now when it really starts to get</font>

88
00:03:46,280 --> 00:03:49,819
<font color="#CCCCCC">interesting is when you</font><font color="#E5E5E5"> start getting</font>

89
00:03:47,480 --> 00:03:51,738
<font color="#E5E5E5">into</font><font color="#CCCCCC"> things like buttons now one of</font><font color="#E5E5E5"> the</font>

90
00:03:49,819 --> 00:03:53,149
easiest<font color="#CCCCCC"> ways to</font><font color="#E5E5E5"> realize there's a</font><font color="#CCCCCC"> botnet</font>

91
00:03:51,739 --> 00:03:54,410
<font color="#CCCCCC">on your network is when the botnet</font>

92
00:03:53,150 --> 00:03:56,810
starts to reach out to commanding

93
00:03:54,410 --> 00:03:59,150
control<font color="#E5E5E5"> servers to find its instructions</font>

94
00:03:56,810 --> 00:04:01,940
now the thing<font color="#CCCCCC"> is</font><font color="#E5E5E5"> if it's just</font><font color="#CCCCCC"> reaching</font>

95
00:03:59,150 --> 00:04:04,280
<font color="#CCCCCC">out to a normal website and downloading</font>

96
00:04:01,940 --> 00:04:05,989
a giant text file that's<font color="#CCCCCC"> a</font><font color="#E5E5E5"> PowerShell</font>

97
00:04:04,280 --> 00:04:08,209
script you kind<font color="#E5E5E5"> of start to catch on</font>

98
00:04:05,989 --> 00:04:10,459
some sketches going on<font color="#E5E5E5"> but if you</font>

99
00:04:08,209 --> 00:04:12,680
<font color="#E5E5E5">instructs your botnet that if I send you</font>

100
00:04:10,459 --> 00:04:14,900
this particular<font color="#CCCCCC"> section in the padding</font>

101
00:04:12,680 --> 00:04:15,680
you can hijack existing streams going

102
00:04:14,900 --> 00:04:17,660
<font color="#E5E5E5">into that</font>

103
00:04:15,680 --> 00:04:19,190
users machine because assuming you've

104
00:04:17,660 --> 00:04:21,169
compromised somewhere<font color="#E5E5E5"> upstream as</font><font color="#CCCCCC"> well</font>

105
00:04:19,190 --> 00:04:22,669
and can insert the data<font color="#E5E5E5"> so your button I</font>

106
00:04:21,168 --> 00:04:25,580
can<font color="#E5E5E5"> actually read</font><font color="#CCCCCC"> information carried</font>

107
00:04:22,669 --> 00:04:27,919
along<font color="#E5E5E5"> existing traffic that the user</font>

108
00:04:25,580 --> 00:04:29,150
<font color="#CCCCCC">themself</font><font color="#E5E5E5"> is doing so anyone even looking</font>

109
00:04:27,919 --> 00:04:31,490
<font color="#CCCCCC">at their computer</font><font color="#E5E5E5"> can say</font><font color="#CCCCCC"> hi</font><font color="#E5E5E5"> yes he</font>

110
00:04:29,150 --> 00:04:33,859
opened up<font color="#E5E5E5"> Facebook but your botnet knows</font>

111
00:04:31,490 --> 00:04:36,229
to<font color="#E5E5E5"> look</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> that information</font><font color="#CCCCCC"> see that the</font>

112
00:04:33,860 --> 00:04:38,030
reserved bits have been<font color="#E5E5E5"> flagged read the</font>

113
00:04:36,229 --> 00:04:40,849
padding<font color="#E5E5E5"> for its instructions then carry</font>

114
00:04:38,030 --> 00:04:43,309
them<font color="#E5E5E5"> out and there's no extra traffic at</font>

115
00:04:40,850 --> 00:04:46,100
all<font color="#E5E5E5"> which is kind of cool</font><font color="#CCCCCC"> looking</font>

116
00:04:43,310 --> 00:04:48,530
because<font color="#E5E5E5"> turns out companies that read</font>

117
00:04:46,100 --> 00:04:50,270
the instructions for<font color="#E5E5E5"> how to</font><font color="#CCCCCC"> implement</font>

118
00:04:48,530 --> 00:04:51,739
things such<font color="#CCCCCC"> as</font><font color="#E5E5E5"> TCP really trust that</font>

119
00:04:50,270 --> 00:04:53,750
<font color="#CCCCCC">you're not actually</font><font color="#E5E5E5"> going to touch the</font>

120
00:04:51,740 --> 00:04:56,300
reserved<font color="#E5E5E5"> bits I'm not sure why they</font>

121
00:04:53,750 --> 00:04:57,410
trust us<font color="#E5E5E5"> because well once you play with</font>

122
00:04:56,300 --> 00:04:59,690
the reserved bits you<font color="#CCCCCC"> can do a lot of</font>

123
00:04:57,410 --> 00:05:01,460
dangerous<font color="#E5E5E5"> things but you can you can</font>

124
00:04:59,690 --> 00:05:02,840
also poach entire<font color="#E5E5E5"> websites through this</font>

125
00:05:01,460 --> 00:05:04,400
<font color="#E5E5E5">we can't get this demo working here</font>

126
00:05:02,840 --> 00:05:07,190
today<font color="#CCCCCC"> because we did not want to rely on</font>

127
00:05:04,400 --> 00:05:08,599
the<font color="#CCCCCC"> Internet of a</font><font color="#E5E5E5"> convention center</font><font color="#CCCCCC"> that</font>

128
00:05:07,190 --> 00:05:11,539
a bunch of<font color="#CCCCCC"> hackers are currently in</font>

129
00:05:08,599 --> 00:05:13,580
because we know better<font color="#E5E5E5"> than</font><font color="#CCCCCC"> that but you</font>

130
00:05:11,539 --> 00:05:16,219
can<font color="#CCCCCC"> actually push basic HTML</font><font color="#E5E5E5"> web pages</font>

131
00:05:13,580 --> 00:05:18,320
over an<font color="#E5E5E5"> existing</font><font color="#CCCCCC"> connections so if you</font>

132
00:05:16,220 --> 00:05:19,849
have a web<font color="#E5E5E5"> server of a rather popular</font>

133
00:05:18,320 --> 00:05:21,889
blog and you want to hand out

134
00:05:19,849 --> 00:05:23,539
information covertly you can have people

135
00:05:21,889 --> 00:05:25,430
<font color="#CCCCCC">navigate your blog with the</font><font color="#E5E5E5"> program</font>

136
00:05:23,539 --> 00:05:27,530
running<font color="#E5E5E5"> and actually have an entire</font>

137
00:05:25,430 --> 00:05:29,539
<font color="#E5E5E5">second web browser grabbing the second</font>

138
00:05:27,530 --> 00:05:34,159
<font color="#CCCCCC">website on top of your existing website</font>

139
00:05:29,539 --> 00:05:35,690
and no one else's<font color="#E5E5E5"> any of the wiser my</font>

140
00:05:34,159 --> 00:05:37,430
personal favorite though is<font color="#E5E5E5"> when you</font>

141
00:05:35,690 --> 00:05:39,860
<font color="#E5E5E5">compromise something such as an upstream</font>

142
00:05:37,430 --> 00:05:41,000
router<font color="#E5E5E5"> on a network without compromising</font>

143
00:05:39,860 --> 00:05:42,860
<font color="#E5E5E5">the client machines because you can</font>

144
00:05:41,000 --> 00:05:45,169
start<font color="#CCCCCC"> actually grabbing information as</font>

145
00:05:42,860 --> 00:05:47,690
it flows through<font color="#E5E5E5"> and extracting it</font>

146
00:05:45,169 --> 00:05:49,549
covertly<font color="#CCCCCC"> and you can also do what I have</font>

147
00:05:47,690 --> 00:05:51,139
decided to<font color="#E5E5E5"> call session based denial of</font>

148
00:05:49,550 --> 00:05:53,300
<font color="#E5E5E5">service I'm sure somebody has an actual</font>

149
00:05:51,139 --> 00:05:55,280
name<font color="#CCCCCC"> for it because most things have</font>

150
00:05:53,300 --> 00:05:56,570
<font color="#CCCCCC">been done</font><font color="#E5E5E5"> before but you can</font><font color="#CCCCCC"> actually</font>

151
00:05:55,280 --> 00:05:58,400
because you're messing around with the

152
00:05:56,570 --> 00:06:00,229
information if you don't very carefully

153
00:05:58,400 --> 00:06:02,330
modify the packets you<font color="#CCCCCC"> accidentally</font>

154
00:06:00,229 --> 00:06:03,680
invalidate the checksums<font color="#CCCCCC"> and you can</font>

155
00:06:02,330 --> 00:06:05,840
invalidate<font color="#E5E5E5"> the checksums by playing</font>

156
00:06:03,680 --> 00:06:07,490
<font color="#E5E5E5">around with the reserved bits and if you</font>

157
00:06:05,840 --> 00:06:09,440
change<font color="#E5E5E5"> the reserved bits then don't fix</font>

158
00:06:07,490 --> 00:06:12,740
the checksum<font color="#E5E5E5"> every packet gets dropped</font>

159
00:06:09,440 --> 00:06:15,349
<font color="#E5E5E5">and nobody will really realize why</font>

160
00:06:12,740 --> 00:06:17,120
because nobody<font color="#E5E5E5"> sings to check the</font>

161
00:06:15,349 --> 00:06:20,090
<font color="#CCCCCC">reserve bits that's a</font><font color="#E5E5E5"> recurring theme of</font>

162
00:06:17,120 --> 00:06:21,770
this entire talk please check<font color="#E5E5E5"> your</font>

163
00:06:20,090 --> 00:06:24,039
<font color="#CCCCCC">reserve bits</font><font color="#E5E5E5"> because people will play</font>

164
00:06:21,770 --> 00:06:28,010
with<font color="#E5E5E5"> them and then break your things</font>

165
00:06:24,039 --> 00:06:29,639
have a<font color="#E5E5E5"> lot of fun doing it</font><font color="#CCCCCC"> so now i'm</font>

166
00:06:28,010 --> 00:06:31,949
<font color="#E5E5E5">going to</font><font color="#CCCCCC"> have my</font><font color="#E5E5E5"> lovely assistant</font>

167
00:06:29,639 --> 00:06:34,169
take<font color="#E5E5E5"> over the computer and we're going</font>

168
00:06:31,949 --> 00:06:35,819
<font color="#E5E5E5">to show you and point at things and say</font>

169
00:06:34,169 --> 00:06:38,310
this is what<font color="#CCCCCC"> actually happens and do</font>

170
00:06:35,819 --> 00:06:41,039
some demos locally<font color="#E5E5E5"> because we don't</font>

171
00:06:38,310 --> 00:06:44,310
trust<font color="#E5E5E5"> the Wi-Fi would you like to take</font>

172
00:06:41,039 --> 00:06:45,900
over the<font color="#E5E5E5"> computer yes all right oh yes</font>

173
00:06:44,310 --> 00:06:50,279
actually let's finish up the<font color="#E5E5E5"> last few</font>

174
00:06:45,900 --> 00:06:52,138
<font color="#E5E5E5">slides cool so right now the thing about</font>

175
00:06:50,279 --> 00:06:54,150
stuffer is it's more<font color="#E5E5E5"> of</font><font color="#CCCCCC"> a concept</font><font color="#E5E5E5"> than</font>

176
00:06:52,139 --> 00:06:56,400
an implementation we do have demos

177
00:06:54,150 --> 00:06:59,520
<font color="#E5E5E5">obviously because people like</font><font color="#CCCCCC"> to see</font>

178
00:06:56,400 --> 00:07:01,198
things work but it's more<font color="#E5E5E5"> of the concept</font>

179
00:06:59,520 --> 00:07:03,419
of playing around<font color="#E5E5E5"> with the TCP headers</font>

180
00:07:01,199 --> 00:07:04,919
and inserting information into them

181
00:07:03,419 --> 00:07:06,900
right now it's running<font color="#CCCCCC"> Python 2.7</font>

182
00:07:04,919 --> 00:07:09,900
because all of the actually good

183
00:07:06,900 --> 00:07:12,599
libraries run on Python 2.7<font color="#CCCCCC"> you can port</font>

184
00:07:09,900 --> 00:07:14,219
it<font color="#CCCCCC"> over to Python</font><font color="#E5E5E5"> 3</font><font color="#CCCCCC"> scampi does work a</font>

185
00:07:12,599 --> 00:07:16,860
few<font color="#E5E5E5"> of the libraries which work with</font>

186
00:07:14,219 --> 00:07:19,199
<font color="#CCCCCC">gappy don't work but</font><font color="#E5E5E5"> that's a issue for</font>

187
00:07:16,860 --> 00:07:21,629
<font color="#E5E5E5">someone else and also one of the things</font>

188
00:07:19,199 --> 00:07:23,039
we've<font color="#CCCCCC"> really played around with but</font>

189
00:07:21,629 --> 00:07:25,110
<font color="#E5E5E5">couldn't quite get working</font><font color="#CCCCCC"> and no way to</font>

190
00:07:23,039 --> 00:07:26,938
demo it anyways is actually<font color="#E5E5E5"> router such</font>

191
00:07:25,110 --> 00:07:28,529
as PF sense if you have any of them

192
00:07:26,939 --> 00:07:31,529
<font color="#E5E5E5">running your house I'm sure a few of you</font>

193
00:07:28,529 --> 00:07:33,360
do we're all nerds<font color="#E5E5E5"> can actually read the</font>

194
00:07:31,529 --> 00:07:34,650
reserved bits<font color="#E5E5E5"> as they flow</font><font color="#CCCCCC"> through and</font>

195
00:07:33,360 --> 00:07:37,529
if the packet<font color="#E5E5E5"> has been played with</font>

196
00:07:34,650 --> 00:07:39,419
either<font color="#E5E5E5"> a switch them</font><font color="#CCCCCC"> back to</font><font color="#E5E5E5"> 0 which</font>

197
00:07:37,529 --> 00:07:41,009
would preserve your existing data stream

198
00:07:39,419 --> 00:07:43,710
and<font color="#E5E5E5"> really annoying whoever's trying to</font>

199
00:07:41,009 --> 00:07:45,810
do anything<font color="#E5E5E5"> or B just drop the packets</font>

200
00:07:43,710 --> 00:07:47,758
entirely which is a slightly more

201
00:07:45,810 --> 00:07:49,139
<font color="#CCCCCC">aggressive solution but</font><font color="#E5E5E5"> I suppose if</font>

202
00:07:47,759 --> 00:07:50,699
somebody's<font color="#CCCCCC"> trying to hijack your</font><font color="#E5E5E5"> traffic</font>

203
00:07:49,139 --> 00:07:52,560
<font color="#CCCCCC">you</font><font color="#E5E5E5"> probably don't want that machine</font>

204
00:07:50,699 --> 00:07:54,149
communicating with the<font color="#CCCCCC"> internet no</font>

205
00:07:52,560 --> 00:07:55,529
matter what regardless<font color="#CCCCCC"> of whether that</font>

206
00:07:54,149 --> 00:07:57,180
current packet has<font color="#CCCCCC"> been played around</font>

207
00:07:55,529 --> 00:07:58,319
<font color="#CCCCCC">with because</font><font color="#E5E5E5"> they have something on</font>

208
00:07:57,180 --> 00:08:01,139
their<font color="#E5E5E5"> computer you don't want them to</font>

209
00:07:58,319 --> 00:08:02,849
have<font color="#CCCCCC"> all right so we do have a</font><font color="#E5E5E5"> github</font>

210
00:08:01,139 --> 00:08:04,589
link<font color="#E5E5E5"> it's very simple you</font><font color="#CCCCCC"> can write it</font>

211
00:08:02,849 --> 00:08:05,759
<font color="#CCCCCC">down you can take a picture of it</font><font color="#E5E5E5"> will</font>

212
00:08:04,589 --> 00:08:08,009
be dropping code up there

213
00:08:05,759 --> 00:08:11,310
as we get<font color="#E5E5E5"> all the examples put up on</font>

214
00:08:08,009 --> 00:08:14,159
there we use today<font color="#E5E5E5"> demo itself is fairly</font>

215
00:08:11,310 --> 00:08:16,649
simple<font color="#CCCCCC"> not too complicated because</font><font color="#E5E5E5"> again</font>

216
00:08:14,159 --> 00:08:18,899
we don't<font color="#CCCCCC"> trust the hotel Wi-Fi</font><font color="#E5E5E5"> at a</font>

217
00:08:16,649 --> 00:08:21,850
hacker convention<font color="#E5E5E5"> we've been to Def Con</font>

218
00:08:18,899 --> 00:08:24,650
<font color="#CCCCCC">we don't</font><font color="#E5E5E5"> trust</font><font color="#CCCCCC"> e people</font>

219
00:08:21,850 --> 00:08:26,720
give you all<font color="#CCCCCC"> a second to write down the</font>

220
00:08:24,650 --> 00:08:29,179
link<font color="#E5E5E5"> which is actually wow that's a</font>

221
00:08:26,720 --> 00:08:31,190
<font color="#E5E5E5">really simple link I like that link then</font>

222
00:08:29,180 --> 00:08:32,780
<font color="#E5E5E5">you have to use a URL shortener</font><font color="#CCCCCC"> alright</font>

223
00:08:31,190 --> 00:08:36,460
now you can<font color="#CCCCCC"> take over</font><font color="#E5E5E5"> the computer and</font>

224
00:08:32,780 --> 00:08:38,689
load<font color="#CCCCCC"> up them yes I'm positive the step</font>

225
00:08:36,460 --> 00:08:43,940
clear<font color="#E5E5E5"> out the screen so we</font><font color="#CCCCCC"> can show the</font>

226
00:08:38,690 --> 00:08:46,310
usage<font color="#E5E5E5"> of the commands this is my very</font>

227
00:08:43,940 --> 00:08:48,380
matrix themed color scheme for<font color="#CCCCCC"> Kali I</font>

228
00:08:46,310 --> 00:08:50,239
hope you all<font color="#CCCCCC"> appreciate it</font><font color="#E5E5E5"> it's really</font>

229
00:08:48,380 --> 00:08:52,160
<font color="#E5E5E5">fun when you sit somewhere and run some</font>

230
00:08:50,240 --> 00:08:53,600
sort<font color="#E5E5E5"> of exploitation tool and some</font>

231
00:08:52,160 --> 00:08:55,040
<font color="#E5E5E5">random English major looks over your</font>

232
00:08:53,600 --> 00:08:58,250
shoulder and wonders what<font color="#CCCCCC"> the hell</font>

233
00:08:55,040 --> 00:09:01,280
you're<font color="#CCCCCC"> doing alright so left hand</font><font color="#E5E5E5"> side</font>

234
00:08:58,250 --> 00:09:04,070
<font color="#E5E5E5">will be the receiving or actually first</font>

235
00:09:01,280 --> 00:09:06,920
<font color="#E5E5E5">show them the actual original packet so</font>

236
00:09:04,070 --> 00:09:12,670
on that one<font color="#E5E5E5"> with nope you want to run</font>

237
00:09:06,920 --> 00:09:12,670
that with<font color="#E5E5E5"> this there you go</font><font color="#CCCCCC"> the up arrow</font>

238
00:09:15,760 --> 00:09:20,060
there are actually instructions attached

239
00:09:17,990 --> 00:09:21,710
to the program itself if you<font color="#E5E5E5"> run the</font>

240
00:09:20,060 --> 00:09:23,869
<font color="#CCCCCC">program without</font><font color="#E5E5E5"> any sort of flags it</font>

241
00:09:21,710 --> 00:09:27,980
will yell at<font color="#E5E5E5"> you</font><font color="#CCCCCC"> it's very well built I</font>

242
00:09:23,870 --> 00:09:30,410
tried<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> so you ran that one</font><font color="#E5E5E5"> you went</font>

243
00:09:27,980 --> 00:09:34,910
<font color="#E5E5E5">through and okay so the part we</font><font color="#CCCCCC"> should</font>

244
00:09:30,410 --> 00:09:37,280
be looking at is specifically<font color="#E5E5E5"> the you</font>

245
00:09:34,910 --> 00:09:40,189
step off the<font color="#CCCCCC"> K</font><font color="#E5E5E5"> okay</font><font color="#CCCCCC"> then couldn't quite</font>

246
00:09:37,280 --> 00:09:42,230
reach<font color="#CCCCCC"> the point</font><font color="#E5E5E5"> okay so this is a TCP</font>

247
00:09:40,190 --> 00:09:44,750
packet going<font color="#E5E5E5"> from</font><font color="#CCCCCC"> loop</font><font color="#E5E5E5"> back to</font><font color="#CCCCCC"> loop back</font>

248
00:09:42,230 --> 00:09:48,080
<font color="#E5E5E5">because well of</font><font color="#CCCCCC"> course it is</font><font color="#E5E5E5"> checksum is</font>

249
00:09:44,750 --> 00:09:49,790
<font color="#E5E5E5">normal and right up</font><font color="#CCCCCC"> here we have the</font><font color="#E5E5E5"> not</font>

250
00:09:48,080 --> 00:09:51,980
shown reserved<font color="#E5E5E5"> bits because of course we</font>

251
00:09:49,790 --> 00:09:53,660
<font color="#E5E5E5">don't out there is so the reserved bits</font>

252
00:09:51,980 --> 00:09:55,760
are<font color="#E5E5E5"> currently set to 0</font><font color="#CCCCCC"> l for some</font>

253
00:09:53,660 --> 00:09:58,610
reasons<font color="#CCCCCC"> gabby decides to translate the</font>

254
00:09:55,760 --> 00:10:01,040
binary for 0 0 0<font color="#E5E5E5"> to just 0 when you see</font>

255
00:09:58,610 --> 00:10:03,320
it changed later it will<font color="#E5E5E5"> be 7</font><font color="#CCCCCC"> L because</font>

256
00:10:01,040 --> 00:10:06,650
that's<font color="#E5E5E5"> 1 1 1</font><font color="#CCCCCC"> and you can see that the</font>

257
00:10:03,320 --> 00:10:08,060
padding for the packet is all<font color="#E5E5E5"> just zeros</font>

258
00:10:06,650 --> 00:10:09,770
over<font color="#E5E5E5"> and over and</font><font color="#CCCCCC"> over again until it</font>

259
00:10:08,060 --> 00:10:11,359
<font color="#E5E5E5">reaches</font><font color="#CCCCCC"> the default length</font><font color="#E5E5E5"> it should</font>

260
00:10:09,770 --> 00:10:12,980
have this<font color="#E5E5E5"> is fairly long because there's</font>

261
00:10:11,360 --> 00:10:16,160
no<font color="#E5E5E5"> actual information carried in the</font>

262
00:10:12,980 --> 00:10:17,930
packet normally it'd be much shorter<font color="#CCCCCC"> so</font>

263
00:10:16,160 --> 00:10:21,439
now if we<font color="#CCCCCC"> go over</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the other side of</font>

264
00:10:17,930 --> 00:10:24,010
the screen we<font color="#E5E5E5"> can actually start sending</font>

265
00:10:21,440 --> 00:10:24,010
<font color="#CCCCCC">information</font>

266
00:10:25,240 --> 00:10:28,990
<font color="#E5E5E5">all right so you can see it's just</font>

267
00:10:26,980 --> 00:10:31,420
<font color="#CCCCCC">waiting for</font><font color="#E5E5E5"> you to enter whatever data</font>

268
00:10:28,990 --> 00:10:32,800
you<font color="#CCCCCC"> want</font><font color="#E5E5E5"> to send across and the other</font>

269
00:10:31,420 --> 00:10:34,089
side of the screen<font color="#E5E5E5"> it doesn't</font><font color="#CCCCCC"> actually</font>

270
00:10:32,800 --> 00:10:35,469
have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be cleared you can send whatever</font>

271
00:10:34,089 --> 00:10:39,700
message<font color="#E5E5E5"> you</font><font color="#CCCCCC"> wants all</font><font color="#E5E5E5"> right so many</font>

272
00:10:35,470 --> 00:10:42,490
<font color="#E5E5E5">neighbor word buddy hello sure son hello</font>

273
00:10:39,700 --> 00:10:44,230
<font color="#E5E5E5">Wow ello world very very clichéd of you</font>

274
00:10:42,490 --> 00:10:46,029
thank<font color="#E5E5E5"> you so now</font><font color="#CCCCCC"> you can see that the</font>

275
00:10:44,230 --> 00:10:47,500
reserved bits have actually been flagged

276
00:10:46,029 --> 00:10:49,180
so the program knows to<font color="#CCCCCC"> look for it</font>

277
00:10:47,500 --> 00:10:51,100
because<font color="#E5E5E5"> there is actually other traffic</font>

278
00:10:49,180 --> 00:10:52,569
being bounced around<font color="#E5E5E5"> on this normally we</font>

279
00:10:51,100 --> 00:10:54,010
don't want to review<font color="#E5E5E5"> all of it we don't</font>

280
00:10:52,570 --> 00:10:55,839
care<font color="#E5E5E5"> what's in all of it we only care</font>

281
00:10:54,010 --> 00:10:56,950
about the parts to be played with<font color="#E5E5E5"> so you</font>

282
00:10:55,839 --> 00:10:58,959
can see that we changed around<font color="#E5E5E5"> the</font>

283
00:10:56,950 --> 00:11:01,630
reserved bits so now it's<font color="#CCCCCC"> 7l which</font><font color="#E5E5E5"> is</font>

284
00:10:58,959 --> 00:11:03,699
just one one one binary<font color="#E5E5E5"> seven translates</font>

285
00:11:01,630 --> 00:11:07,120
over<font color="#E5E5E5"> they did it for humans to read</font>

286
00:11:03,700 --> 00:11:08,380
<font color="#E5E5E5">unfortunately we're not humans so now</font>

287
00:11:07,120 --> 00:11:10,510
you can see<font color="#E5E5E5"> that down on the padding can</font>

288
00:11:08,380 --> 00:11:12,550
you just enter a few<font color="#E5E5E5"> times the scroll to</font>

289
00:11:10,510 --> 00:11:14,260
<font color="#CCCCCC">control see X out of</font><font color="#E5E5E5"> the program then</font>

290
00:11:12,550 --> 00:11:16,420
hit enter<font color="#E5E5E5"> a few times and</font><font color="#CCCCCC"> now you've</font>

291
00:11:14,260 --> 00:11:20,170
cleared out the example send<font color="#CCCCCC"> something</font>

292
00:11:16,420 --> 00:11:27,550
again then in<font color="#E5E5E5"> under a</font><font color="#CCCCCC"> few</font><font color="#E5E5E5"> does so you</font>

293
00:11:20,170 --> 00:11:28,810
can see all<font color="#CCCCCC"> right there we go so now you</font>

294
00:11:27,550 --> 00:11:30,459
can see that<font color="#E5E5E5"> it actually carries</font><font color="#CCCCCC"> across</font>

295
00:11:28,810 --> 00:11:31,810
the<font color="#E5E5E5"> message inside of the padding the</font>

296
00:11:30,459 --> 00:11:33,369
rest of the padding is still filled in

297
00:11:31,810 --> 00:11:34,899
<font color="#E5E5E5">with zeros</font><font color="#CCCCCC"> because if you don't</font><font color="#E5E5E5"> fill in</font>

298
00:11:33,370 --> 00:11:37,209
the padding things get very<font color="#E5E5E5"> very</font>

299
00:11:34,899 --> 00:11:38,560
confused<font color="#E5E5E5"> but now that you've actually</font>

300
00:11:37,209 --> 00:11:40,510
<font color="#E5E5E5">carried the message across you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> see</font>

301
00:11:38,560 --> 00:11:42,310
that it's there the rest of the

302
00:11:40,510 --> 00:11:45,010
<font color="#CCCCCC">information is all still the same it</font>

303
00:11:42,310 --> 00:11:46,869
still<font color="#CCCCCC"> uses all the same ports all of the</font>

304
00:11:45,010 --> 00:11:49,959
same information the checksum has been

305
00:11:46,870 --> 00:11:54,250
changed since<font color="#E5E5E5"> it got filled in so yeah</font>

306
00:11:49,959 --> 00:11:56,410
<font color="#CCCCCC">very nice good for transmitting</font>

307
00:11:54,250 --> 00:11:59,589
information over<font color="#CCCCCC"> existing applications</font>

308
00:11:56,410 --> 00:12:01,029
now we don't<font color="#E5E5E5"> have a incredible</font><font color="#CCCCCC"> I'd love</font>

309
00:11:59,589 --> 00:12:02,800
<font color="#E5E5E5">to be able to show you the website but</font>

310
00:12:01,029 --> 00:12:06,660
you don't actually<font color="#E5E5E5"> have Wi-Fi at the</font>

311
00:12:02,800 --> 00:12:08,560
moment<font color="#CCCCCC"> because the Wi-Fi is awful</font><font color="#E5E5E5"> so yes</font>

312
00:12:06,660 --> 00:12:10,750
there any other<font color="#E5E5E5"> comments you would like</font>

313
00:12:08,560 --> 00:12:13,930
<font color="#E5E5E5">to add it's not the most complicated</font>

314
00:12:10,750 --> 00:12:17,680
talk in the planet it was very quick

315
00:12:13,930 --> 00:12:25,660
actually<font color="#E5E5E5"> so yes with questions you do</font>

316
00:12:17,680 --> 00:12:27,069
have a question<font color="#CCCCCC"> yes sure do you want to</font>

317
00:12:25,660 --> 00:12:28,540
<font color="#CCCCCC">open up the</font><font color="#E5E5E5"> actual code we're currently</font>

318
00:12:27,070 --> 00:12:33,100
running instead of the old code we're

319
00:12:28,540 --> 00:12:35,170
not<font color="#E5E5E5"> currently running yeah</font><font color="#CCCCCC"> all right so</font>

320
00:12:33,100 --> 00:12:37,029
this is<font color="#CCCCCC"> the most recent version of the</font>

321
00:12:35,170 --> 00:12:38,140
<font color="#E5E5E5">coding you</font><font color="#CCCCCC"> can ignore that one import of</font>

322
00:12:37,029 --> 00:12:41,050
threading it does nothing

323
00:12:38,140 --> 00:12:42,819
so yes<font color="#E5E5E5"> so what we have here</font><font color="#CCCCCC"> is we have</font>

324
00:12:41,050 --> 00:12:45,449
scroll down a bit<font color="#CCCCCC"> so they can</font><font color="#E5E5E5"> see the</font>

325
00:12:42,820 --> 00:12:49,390
menu<font color="#E5E5E5"> itself and we can work our way up</font>

326
00:12:45,450 --> 00:12:51,640
<font color="#E5E5E5">so right now we have just a menu being</font>

327
00:12:49,390 --> 00:12:53,710
created and<font color="#E5E5E5"> then it chooses whatever</font>

328
00:12:51,640 --> 00:12:55,360
options<font color="#E5E5E5"> you want and then assuming you</font>

329
00:12:53,710 --> 00:12:56,890
<font color="#E5E5E5">want to receive packets which is in my</font>

330
00:12:55,360 --> 00:12:58,420
<font color="#E5E5E5">opinion</font><font color="#CCCCCC"> be more interesting</font><font color="#E5E5E5"> of the two</font>

331
00:12:56,890 --> 00:13:01,090
options<font color="#E5E5E5"> because changing things is very</font>

332
00:12:58,420 --> 00:13:03,189
<font color="#CCCCCC">boring</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> actually go we are using</font>

333
00:13:01,090 --> 00:13:04,810
the sniff function of<font color="#CCCCCC"> Scapa to grab all</font>

334
00:13:03,190 --> 00:13:06,940
of the packets which are actually

335
00:13:04,810 --> 00:13:08,739
incoming or outgoing but in most<font color="#E5E5E5"> cases</font>

336
00:13:06,940 --> 00:13:10,360
it really<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> matter</font><font color="#E5E5E5"> because you</font>

337
00:13:08,740 --> 00:13:12,040
want to<font color="#E5E5E5"> see both the incoming outgoing</font>

338
00:13:10,360 --> 00:13:13,750
traffic<font color="#E5E5E5"> because you care what you're</font>

339
00:13:12,040 --> 00:13:16,480
saying as<font color="#E5E5E5"> well as what they're saying so</font>

340
00:13:13,750 --> 00:13:19,030
<font color="#CCCCCC">it sniffs all the traffic hands up to</font>

341
00:13:16,480 --> 00:13:20,350
the decluttered<font color="#CCCCCC"> decoder just checks to</font>

342
00:13:19,030 --> 00:13:22,240
see if<font color="#E5E5E5"> the reserved bits that actually</font>

343
00:13:20,350 --> 00:13:25,450
been changed<font color="#CCCCCC"> to the 7l which again</font>

344
00:13:22,240 --> 00:13:27,730
<font color="#E5E5E5">translates to</font><font color="#CCCCCC"> 1 1 1</font><font color="#E5E5E5"> and binary and then</font>

345
00:13:25,450 --> 00:13:29,830
if it does it prints out<font color="#E5E5E5"> the message it</font>

346
00:13:27,730 --> 00:13:32,230
<font color="#E5E5E5">also for convenience for the</font><font color="#CCCCCC"> demo sake</font>

347
00:13:29,830 --> 00:13:35,710
removes all the<font color="#E5E5E5"> extra points that we</font>

348
00:13:32,230 --> 00:13:38,350
don't<font color="#E5E5E5"> care about the random - 0</font><font color="#CCCCCC"> X X</font><font color="#E5E5E5"> -</font><font color="#CCCCCC"> X</font>

349
00:13:35,710 --> 00:13:40,540
<font color="#E5E5E5">zero zeros that way we can read it more</font>

350
00:13:38,350 --> 00:13:45,130
easily<font color="#E5E5E5"> now if you scroll</font><font color="#CCCCCC"> up a little bit</font>

351
00:13:40,540 --> 00:13:46,630
further<font color="#CCCCCC"> you write</font><font color="#E5E5E5"> down there</font><font color="#CCCCCC"> alright</font><font color="#E5E5E5"> we</font>

352
00:13:45,130 --> 00:13:47,560
can see that<font color="#E5E5E5"> we little bit further we</font>

353
00:13:46,630 --> 00:13:51,130
want<font color="#E5E5E5"> to show them the Linux works</font>

354
00:13:47,560 --> 00:13:52,300
<font color="#E5E5E5">alright so basically</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is our little</font>

355
00:13:51,130 --> 00:13:54,640
function just<font color="#CCCCCC"> demonstrates sending</font>

356
00:13:52,300 --> 00:13:57,219
information modifying the packets<font color="#CCCCCC"> Caffey</font>

357
00:13:54,640 --> 00:13:59,350
this is not the exact one this<font color="#E5E5E5"> is to</font>

358
00:13:57,220 --> 00:14:01,480
<font color="#E5E5E5">create a blank packet to</font><font color="#CCCCCC"> send it the one</font>

359
00:13:59,350 --> 00:14:04,960
to modify them is<font color="#E5E5E5"> slightly different but</font>

360
00:14:01,480 --> 00:14:06,520
<font color="#CCCCCC">this'll do so all does</font><font color="#E5E5E5"> is quite simple</font>

361
00:14:04,960 --> 00:14:10,060
<font color="#E5E5E5">it actually grabs your message it</font>

362
00:14:06,520 --> 00:14:12,970
creates the packet with<font color="#E5E5E5"> the reserved</font>

363
00:14:10,060 --> 00:14:14,949
<font color="#CCCCCC">bits changed it creates the pad padding</font>

364
00:14:12,970 --> 00:14:18,250
<font color="#E5E5E5">and we actually override</font><font color="#CCCCCC"> suspending</font>

365
00:14:14,950 --> 00:14:19,960
twice that's weird<font color="#CCCCCC"> ok whatever</font><font color="#E5E5E5"> and then</font>

366
00:14:18,250 --> 00:14:22,030
<font color="#E5E5E5">it just adds in your message you</font><font color="#CCCCCC"> can</font>

367
00:14:19,960 --> 00:14:23,440
actually overload the padding of a TCP

368
00:14:22,030 --> 00:14:25,689
packet and send it<font color="#E5E5E5"> over the network</font>

369
00:14:23,440 --> 00:14:27,520
we've had no issues doing so I wouldn't

370
00:14:25,690 --> 00:14:30,490
<font color="#CCCCCC">personally recommend it because it could</font>

371
00:14:27,520 --> 00:14:32,470
start<font color="#E5E5E5"> to explode things but it works</font><font color="#CCCCCC"> the</font>

372
00:14:30,490 --> 00:14:34,360
<font color="#E5E5E5">actual library does check to make</font><font color="#CCCCCC"> sure</font>

373
00:14:32,470 --> 00:14:36,310
you're not<font color="#CCCCCC"> doing that</font><font color="#E5E5E5"> and then it adds</font>

374
00:14:34,360 --> 00:14:37,840
on the extra information<font color="#CCCCCC"> to</font><font color="#E5E5E5"> make</font><font color="#CCCCCC"> sure</font>

375
00:14:36,310 --> 00:14:40,180
that the padding is of the correct<font color="#CCCCCC"> size</font>

376
00:14:37,840 --> 00:14:42,130
it's not<font color="#E5E5E5"> too small because for some</font>

377
00:14:40,180 --> 00:14:43,839
reason it cares a<font color="#E5E5E5"> lot more</font><font color="#CCCCCC"> if the packet</font>

378
00:14:42,130 --> 00:14:46,120
is too small and<font color="#E5E5E5"> does if the packet is</font>

379
00:14:43,840 --> 00:14:47,800
too large<font color="#E5E5E5"> I'm guessing that's because</font>

380
00:14:46,120 --> 00:14:49,570
<font color="#CCCCCC">you can actually enable things such as</font>

381
00:14:47,800 --> 00:14:50,769
jumbo packets so networks have learned

382
00:14:49,570 --> 00:14:52,029
by<font color="#CCCCCC"> now to</font><font color="#E5E5E5"> not be too</font>

383
00:14:50,769 --> 00:14:53,889
surprised when packets come across

384
00:14:52,029 --> 00:14:57,040
they're larger<font color="#CCCCCC"> than they technically</font>

385
00:14:53,889 --> 00:14:59,649
<font color="#CCCCCC">should be so</font><font color="#E5E5E5"> yeah then it just fires it</font>

386
00:14:57,040 --> 00:15:15,009
away over<font color="#CCCCCC"> the network there's no issues</font>

387
00:14:59,649 --> 00:15:16,629
<font color="#CCCCCC">at all question yeah yeah it sends</font>

388
00:15:15,009 --> 00:15:19,720
<font color="#CCCCCC">across as an ascii just fine it is</font>

389
00:15:16,629 --> 00:15:22,269
<font color="#E5E5E5">strange</font><font color="#CCCCCC"> that you don't</font><font color="#E5E5E5"> have to match the</font>

390
00:15:19,720 --> 00:15:30,610
format<font color="#E5E5E5"> not quite sure what's going on</font>

391
00:15:22,269 --> 00:15:32,319
then yeah yeah<font color="#CCCCCC"> SCAF II does have a lot</font>

392
00:15:30,610 --> 00:15:33,549
of<font color="#E5E5E5"> things in the background handled for</font>

393
00:15:32,319 --> 00:15:34,779
us that's<font color="#E5E5E5"> part of the reason why we used</font>

394
00:15:33,549 --> 00:15:36,699
it<font color="#CCCCCC"> and didn't just write it because you</font>

395
00:15:34,779 --> 00:15:38,889
could recreate<font color="#E5E5E5"> this entire</font><font color="#CCCCCC"> concept using</font>

396
00:15:36,699 --> 00:15:41,019
<font color="#E5E5E5">just a straight HTTP library</font><font color="#CCCCCC"> but that's</font>

397
00:15:38,889 --> 00:15:43,149
a lot of extra<font color="#E5E5E5"> works</font><font color="#CCCCCC"> Cappy does do a lot</font>

398
00:15:41,019 --> 00:15:44,619
<font color="#CCCCCC">of it</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> us so I would not</font><font color="#E5E5E5"> be surprised</font>

399
00:15:43,149 --> 00:15:55,509
if<font color="#E5E5E5"> it does actually get transferred at</font>

400
00:15:44,619 --> 00:15:57,549
some point any further questions<font color="#CCCCCC"> in the</font>

401
00:15:55,509 --> 00:16:10,829
issue you have a question<font color="#CCCCCC"> behind you</font>

402
00:15:57,549 --> 00:16:10,829
though yeah yeah

403
00:16:16,110 --> 00:16:21,220
so that actually<font color="#CCCCCC"> said was well with his</font>

404
00:16:19,119 --> 00:16:22,990
question we were really successful in

405
00:16:21,220 --> 00:16:24,759
virtualized environments we have<font color="#E5E5E5"> full</font>

406
00:16:22,990 --> 00:16:26,079
<font color="#E5E5E5">control this is very easy</font><font color="#CCCCCC"> actual</font>

407
00:16:24,759 --> 00:16:27,429
<font color="#CCCCCC">environments it</font><font color="#E5E5E5"> gets a bit iffy er</font>

408
00:16:26,079 --> 00:16:30,339
depending on the exact implementation

409
00:16:27,429 --> 00:16:32,769
people use because<font color="#E5E5E5"> there is actually</font><font color="#CCCCCC"> a</font>

410
00:16:30,339 --> 00:16:35,079
shockingly<font color="#CCCCCC"> low</font><font color="#E5E5E5"> okay can't say shockingly</font>

411
00:16:32,769 --> 00:16:36,459
were nerds<font color="#CCCCCC"> a shockingly large</font><font color="#E5E5E5"> amount of</font>

412
00:16:35,079 --> 00:16:39,040
<font color="#E5E5E5">debate regarding the exact</font>

413
00:16:36,459 --> 00:16:41,410
<font color="#CCCCCC">interpretation of the for future use of</font>

414
00:16:39,040 --> 00:16:42,998
reserved bits some companies take that

415
00:16:41,410 --> 00:16:44,919
to me and<font color="#E5E5E5"> let's reset them and delete</font>

416
00:16:42,999 --> 00:16:48,040
<font color="#E5E5E5">them all others take that is we can do</font>

417
00:16:44,919 --> 00:16:50,709
whatever so the exact usage on<font color="#E5E5E5"> hardware</font>

418
00:16:48,040 --> 00:16:52,809
<font color="#E5E5E5">works in a virtualized environment or</font>

419
00:16:50,709 --> 00:16:54,669
the one we have in<font color="#CCCCCC"> our house or the</font>

420
00:16:52,809 --> 00:16:56,469
<font color="#E5E5E5">computer science labs but not over the</font>

421
00:16:54,669 --> 00:17:00,309
<font color="#CCCCCC">Greater campus networks works sometimes</font>

422
00:16:56,470 --> 00:17:01,749
<font color="#E5E5E5">over</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> Internet it's very odd as to</font>

423
00:17:00,309 --> 00:17:03,370
whether<font color="#E5E5E5"> or not</font><font color="#CCCCCC"> it work in a larger scale</font>

424
00:17:01,749 --> 00:17:05,260
<font color="#CCCCCC">it's good as an extension</font>

425
00:17:03,370 --> 00:17:06,670
of your existing library of tools it's

426
00:17:05,260 --> 00:17:09,099
not really<font color="#E5E5E5"> meant to be a standalone</font>

427
00:17:06,670 --> 00:17:11,170
<font color="#CCCCCC">things you can insert</font><font color="#E5E5E5"> command and</font>

428
00:17:09,099 --> 00:17:13,059
<font color="#E5E5E5">control into existing traffic</font><font color="#CCCCCC"> on an</font>

429
00:17:11,170 --> 00:17:14,890
internal<font color="#E5E5E5"> network it's much easier</font><font color="#CCCCCC"> to do</font>

430
00:17:13,059 --> 00:17:17,730
that's<font color="#E5E5E5"> very easy thing to do we've had</font>

431
00:17:14,890 --> 00:17:21,900
<font color="#CCCCCC">successive that from an</font><font color="#E5E5E5"> external network</font>

432
00:17:17,730 --> 00:17:21,900
depends<font color="#E5E5E5"> on the external</font><font color="#CCCCCC"> Network</font><font color="#E5E5E5"> release</font>

433
00:17:22,650 --> 00:17:28,750
oh yeah VPNs are really weird because

434
00:17:26,349 --> 00:17:30,850
they reset your connections they

435
00:17:28,750 --> 00:17:32,590
repackage everything which<font color="#CCCCCC"> make sense</font>

436
00:17:30,850 --> 00:17:36,850
it's a VPN<font color="#CCCCCC"> you wouldn't want it</font><font color="#E5E5E5"> leaking</font>

437
00:17:32,590 --> 00:17:38,740
<font color="#E5E5E5">your information</font><font color="#CCCCCC"> you further</font><font color="#E5E5E5"> questions</font>

438
00:17:36,850 --> 00:17:40,480
we did have a lot of<font color="#E5E5E5"> fun experiences</font>

439
00:17:38,740 --> 00:17:42,220
<font color="#E5E5E5">getting this to work</font><font color="#CCCCCC"> on a college</font>

440
00:17:40,480 --> 00:17:44,380
<font color="#CCCCCC">network that didn't</font><font color="#E5E5E5"> really know what we</font>

441
00:17:42,220 --> 00:17:46,210
were<font color="#CCCCCC"> doing and sending</font><font color="#E5E5E5"> information</font>

442
00:17:44,380 --> 00:17:48,040
<font color="#E5E5E5">across that the firewalls did not</font>

443
00:17:46,210 --> 00:17:49,360
<font color="#E5E5E5">particularly appreciate because it turns</font>

444
00:17:48,040 --> 00:17:51,550
out<font color="#CCCCCC"> college students like the torrent a</font>

445
00:17:49,360 --> 00:17:53,229
lot of things<font color="#E5E5E5"> so they're not big fans of</font>

446
00:17:51,550 --> 00:17:55,059
having peer-to-peer connections which

447
00:17:53,230 --> 00:17:56,770
have lots of weird traffic attached to

448
00:17:55,059 --> 00:17:58,809
them<font color="#E5E5E5"> so when you start bouncing them</font>

449
00:17:56,770 --> 00:18:00,820
<font color="#E5E5E5">across you start getting weird questions</font>

450
00:17:58,809 --> 00:18:02,920
from the IT people<font color="#E5E5E5"> asking what on earth</font>

451
00:18:00,820 --> 00:18:04,360
<font color="#E5E5E5">are you doing</font><font color="#CCCCCC"> why are</font><font color="#E5E5E5"> you sending broken</font>

452
00:18:02,920 --> 00:18:06,550
packets across<font color="#CCCCCC"> Network we get</font><font color="#E5E5E5"> emails</font>

453
00:18:04,360 --> 00:18:08,770
<font color="#CCCCCC">stop it so that's when we went</font>

454
00:18:06,550 --> 00:18:10,450
virtualized because we don't want<font color="#CCCCCC"> that</font>

455
00:18:08,770 --> 00:18:15,100
to<font color="#CCCCCC"> happen</font><font color="#E5E5E5"> anymore when I want to anger</font>

456
00:18:10,450 --> 00:18:27,340
<font color="#E5E5E5">them Sam no no question</font><font color="#CCCCCC"> got it back then</font>

457
00:18:15,100 --> 00:18:30,159
I'll come<font color="#CCCCCC"> back</font><font color="#E5E5E5"> to you yep no most</font><font color="#CCCCCC"> wooded</font>

458
00:18:27,340 --> 00:18:31,540
but a lot<font color="#E5E5E5"> of ideas don't check the thing</font>

459
00:18:30,160 --> 00:18:32,800
you can actually you<font color="#CCCCCC"> can look in</font>

460
00:18:31,540 --> 00:18:34,899
Wireshark and actually see that<font color="#E5E5E5"> these</font>

461
00:18:32,800 --> 00:18:36,010
packets have been<font color="#E5E5E5"> modified but that's</font>

462
00:18:34,900 --> 00:18:37,510
part of<font color="#E5E5E5"> the debate with the whole</font>

463
00:18:36,010 --> 00:18:39,129
<font color="#E5E5E5">whether or not the reserved bits are</font>

464
00:18:37,510 --> 00:18:41,830
reserved and should be kept for<font color="#CCCCCC"> future</font>

465
00:18:39,130 --> 00:18:44,020
use because in theory<font color="#E5E5E5"> at some point</font>

466
00:18:41,830 --> 00:18:46,178
they'll change<font color="#E5E5E5"> a lot of companies don't</font>

467
00:18:44,020 --> 00:18:47,379
check them they figured<font color="#CCCCCC"> that they could</font>

468
00:18:46,179 --> 00:18:48,850
be changed in the<font color="#CCCCCC"> future and they</font>

469
00:18:47,380 --> 00:18:57,910
wouldn't<font color="#CCCCCC"> want to just murder their</font>

470
00:18:48,850 --> 00:19:00,309
product<font color="#E5E5E5"> accidentally said yeah yep it's</font>

471
00:18:57,910 --> 00:19:01,900
very easy to<font color="#E5E5E5"> catch it's incredibly easy</font>

472
00:19:00,309 --> 00:19:03,040
<font color="#E5E5E5">to catch and</font><font color="#CCCCCC"> that's part of the thing</font>

473
00:19:01,900 --> 00:19:03,700
<font color="#E5E5E5">we're</font><font color="#CCCCCC"> talking</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> with the pfsense</font>

474
00:19:03,040 --> 00:19:05,678
firewalls

475
00:19:03,700 --> 00:19:07,030
if those bits are<font color="#E5E5E5"> changed do you know</font>

476
00:19:05,679 --> 00:19:09,730
someone's doing something<font color="#CCCCCC"> weird that</font>

477
00:19:07,030 --> 00:19:12,220
<font color="#E5E5E5">they shouldn't be but it's incredibly</font>

478
00:19:09,730 --> 00:19:15,309
<font color="#CCCCCC">obvious things</font><font color="#E5E5E5"> that you can use as a</font>

479
00:19:12,220 --> 00:19:31,450
data channel that<font color="#E5E5E5"> doesn't</font><font color="#CCCCCC"> no one</font>

480
00:19:15,309 --> 00:19:32,950
<font color="#CCCCCC">léa checks ok we've sent over chat</font>

481
00:19:31,450 --> 00:19:34,809
programs work really well<font color="#CCCCCC"> over this</font>

482
00:19:32,950 --> 00:19:36,249
<font color="#E5E5E5">we've sent over some we actually got a</font>

483
00:19:34,809 --> 00:19:38,110
reverse<font color="#CCCCCC"> shell</font><font color="#E5E5E5"> working on another</font>

484
00:19:36,249 --> 00:19:40,480
computer<font color="#E5E5E5"> because we were able</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> send</font>

485
00:19:38,110 --> 00:19:42,248
the information<font color="#E5E5E5"> over an existing session</font>

486
00:19:40,480 --> 00:19:43,659
<font color="#CCCCCC">I</font><font color="#E5E5E5"> believe that was actually a web server</font>

487
00:19:42,249 --> 00:19:45,610
<font color="#CCCCCC">that we had yeah that was one of</font><font color="#E5E5E5"> the web</font>

488
00:19:43,659 --> 00:19:47,470
servers we opened<font color="#CCCCCC"> up a web site and as</font>

489
00:19:45,610 --> 00:19:49,149
the<font color="#CCCCCC"> website was loading when you sent</font>

490
00:19:47,470 --> 00:19:51,039
out<font color="#E5E5E5"> the</font><font color="#CCCCCC"> request asking I want this page</font>

491
00:19:49,149 --> 00:19:53,199
it's like here also<font color="#E5E5E5"> run this command for</font>

492
00:19:51,039 --> 00:19:54,970
<font color="#E5E5E5">me</font><font color="#CCCCCC"> and it could get</font><font color="#E5E5E5"> the results back if</font>

493
00:19:53,200 --> 00:19:56,559
you<font color="#CCCCCC"> compromised the</font><font color="#E5E5E5"> other computer but</font>

494
00:19:54,970 --> 00:19:57,909
<font color="#E5E5E5">you do not</font><font color="#CCCCCC"> actually need</font><font color="#E5E5E5"> to be able to</font>

495
00:19:56,559 --> 00:19:59,860
see what the results are if you want to

496
00:19:57,909 --> 00:20:04,059
just<font color="#E5E5E5"> learn</font><font color="#CCCCCC"> more</font><font color="#E5E5E5"> F slash a random web</font>

497
00:19:59,860 --> 00:20:07,269
server without<font color="#E5E5E5"> anyone so yeah we have a</font>

498
00:20:04,059 --> 00:20:08,590
<font color="#E5E5E5">lot of fun and could do a lot more demos</font>

499
00:20:07,269 --> 00:20:10,990
<font color="#E5E5E5">but</font><font color="#CCCCCC"> we don't actually have internet</font>

500
00:20:08,590 --> 00:20:12,939
because we didn't expect<font color="#CCCCCC"> internet by the</font>

501
00:20:10,990 --> 00:20:14,200
way that was<font color="#E5E5E5"> not an unplanned thing we</font>

502
00:20:12,940 --> 00:20:15,669
came into this planning to not have

503
00:20:14,200 --> 00:20:19,950
internet because it's a hacker

504
00:20:15,669 --> 00:20:19,950
convention<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> another</font><font color="#E5E5E5"> question</font>

505
00:20:28,679 --> 00:20:34,269
more covert well if one of the<font color="#E5E5E5"> things</font>

506
00:20:32,230 --> 00:20:36,909
we're actually<font color="#E5E5E5"> looking at still is IPSec</font>

507
00:20:34,269 --> 00:20:38,169
which is encrypted<font color="#CCCCCC"> IP traffic</font><font color="#E5E5E5"> could does</font>

508
00:20:36,909 --> 00:20:39,730
have a few other<font color="#E5E5E5"> fields that could be</font>

509
00:20:38,169 --> 00:20:41,049
played<font color="#E5E5E5"> around with and those are</font>

510
00:20:39,730 --> 00:20:43,869
encrypted you can't just read those

511
00:20:41,049 --> 00:20:45,759
that's a lot of<font color="#E5E5E5"> fun but there are entire</font>

512
00:20:43,869 --> 00:20:48,908
<font color="#E5E5E5">other layers that</font><font color="#CCCCCC"> you can exploit and</font>

513
00:20:45,759 --> 00:20:50,649
add<font color="#E5E5E5"> more information into the big thing</font>

514
00:20:48,909 --> 00:20:52,419
<font color="#CCCCCC">about it</font><font color="#E5E5E5"> is most of the places that you</font>

515
00:20:50,649 --> 00:20:55,389
<font color="#E5E5E5">can modify without anything freaking out</font>

516
00:20:52,419 --> 00:20:58,090
are<font color="#E5E5E5"> just one</font><font color="#CCCCCC"> or two bits</font><font color="#E5E5E5"> so you can add</font>

517
00:20:55,389 --> 00:20:59,918
say<font color="#CCCCCC"> flags and options and carry</font><font color="#E5E5E5"> things</font>

518
00:20:58,090 --> 00:21:01,600
across like<font color="#CCCCCC"> that but you</font><font color="#E5E5E5"> don't get a</font>

519
00:20:59,919 --> 00:21:02,740
very large amount<font color="#CCCCCC"> of bandwidth unlike</font>

520
00:21:01,600 --> 00:21:05,259
with<font color="#CCCCCC"> the padding where you can actually</font>

521
00:21:02,740 --> 00:21:06,580
get a few bytes and if you grab a few

522
00:21:05,259 --> 00:21:08,799
extra packets you can<font color="#CCCCCC"> get a few more</font>

523
00:21:06,580 --> 00:21:10,779
bytes and once you start<font color="#E5E5E5"> fragmenting</font>

524
00:21:08,799 --> 00:21:14,889
things you<font color="#CCCCCC"> meet a lot larger</font><font color="#E5E5E5"> amount of</font>

525
00:21:10,779 --> 00:21:15,980
<font color="#CCCCCC">information across you have another</font>

526
00:21:14,889 --> 00:21:23,600
<font color="#E5E5E5">question</font>

527
00:21:15,980 --> 00:21:25,490
I haven't<font color="#E5E5E5"> driven home that fact yet okay</font>

528
00:21:23,600 --> 00:21:27,770
apparently<font color="#CCCCCC"> I need to emphasize the fact</font>

529
00:21:25,490 --> 00:21:29,720
that<font color="#E5E5E5"> you can send across entire programs</font>

530
00:21:27,770 --> 00:21:31,190
<font color="#E5E5E5">with this you know when we set up the</font>

531
00:21:29,720 --> 00:21:33,770
<font color="#E5E5E5">reverse shell you</font><font color="#CCCCCC"> could actually</font><font color="#E5E5E5"> send</font>

532
00:21:31,190 --> 00:21:35,030
across<font color="#E5E5E5"> an entire say batch script</font>

533
00:21:33,770 --> 00:21:36,440
although<font color="#CCCCCC"> personally I'd recommend just</font>

534
00:21:35,030 --> 00:21:38,389
using<font color="#CCCCCC"> W get and grabbing it from</font>

535
00:21:36,440 --> 00:21:40,730
somewhere else<font color="#CCCCCC"> but</font><font color="#E5E5E5"> anyways so you can</font>

536
00:21:38,390 --> 00:21:43,940
actually send<font color="#E5E5E5"> a car but</font><font color="#CCCCCC"> those</font><font color="#E5E5E5"> include</font>

537
00:21:40,730 --> 00:21:46,010
also<font color="#E5E5E5"> the fact that she also really</font>

538
00:21:43,940 --> 00:21:47,360
wanted<font color="#E5E5E5"> to if you're deploying this out</font>

539
00:21:46,010 --> 00:21:49,429
in the field and you<font color="#CCCCCC"> decide you didn't</font>

540
00:21:47,360 --> 00:21:51,500
update<font color="#CCCCCC"> say you</font><font color="#E5E5E5"> forgot an import or</font>

541
00:21:49,429 --> 00:21:53,120
whatever you could potentially<font color="#E5E5E5"> send its</font>

542
00:21:51,500 --> 00:21:55,790
own update through its own channels

543
00:21:53,120 --> 00:21:59,418
without<font color="#E5E5E5"> anyone knowing again another fun</font>

544
00:21:55,790 --> 00:22:01,520
method we've tried with<font color="#E5E5E5"> it right yes</font>

545
00:21:59,419 --> 00:22:03,110
that's right you do the<font color="#E5E5E5"> code executions</font>

546
00:22:01,520 --> 00:22:04,610
item Python the Python<font color="#E5E5E5"> script is</font>

547
00:22:03,110 --> 00:22:06,469
currently running can actually write its

548
00:22:04,610 --> 00:22:08,629
own<font color="#E5E5E5"> Python script then close itself and</font>

549
00:22:06,470 --> 00:22:11,120
then<font color="#E5E5E5"> somehow also open itself back up</font>

550
00:22:08,630 --> 00:22:13,280
<font color="#E5E5E5">again with the newly updated code so you</font>

551
00:22:11,120 --> 00:22:15,290
can send the<font color="#E5E5E5"> cross once you get the</font>

552
00:22:13,280 --> 00:22:17,450
actual delivered payload from<font color="#E5E5E5"> whatever</font>

553
00:22:15,290 --> 00:22:20,000
you use<font color="#CCCCCC"> to</font><font color="#E5E5E5"> exploit the network if</font><font color="#CCCCCC"> you</font>

554
00:22:17,450 --> 00:22:22,429
have<font color="#CCCCCC"> ever</font><font color="#E5E5E5"> shell put into it you</font><font color="#CCCCCC"> can send</font>

555
00:22:20,000 --> 00:22:24,679
little<font color="#E5E5E5"> bits of code over</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> channel and</font>

556
00:22:22,429 --> 00:22:26,900
then<font color="#E5E5E5"> update and add more imports say you</font>

557
00:22:24,679 --> 00:22:28,549
wanted<font color="#E5E5E5"> to import the well you tend to</font>

558
00:22:26,900 --> 00:22:32,179
<font color="#CCCCCC">sub-par spa</font><font color="#E5E5E5"> let's see what</font><font color="#CCCCCC"> what you want</font>

559
00:22:28,549 --> 00:22:34,160
to<font color="#E5E5E5"> import so you wanted to import your</font>

560
00:22:32,179 --> 00:22:35,960
custom library for<font color="#E5E5E5"> Bitcoin mining on</font>

561
00:22:34,160 --> 00:22:37,070
whatever machine<font color="#CCCCCC"> you've just compromised</font>

562
00:22:35,960 --> 00:22:39,169
<font color="#E5E5E5">now you have your</font><font color="#CCCCCC"> button and</font><font color="#E5E5E5"> on there</font>

563
00:22:37,070 --> 00:22:41,000
<font color="#E5E5E5">you could import that later run the</font>

564
00:22:39,169 --> 00:22:42,919
commands<font color="#CCCCCC"> to pip install</font><font color="#E5E5E5"> it all in the</font>

565
00:22:41,000 --> 00:22:44,000
<font color="#CCCCCC">background using</font><font color="#E5E5E5"> the covert</font><font color="#CCCCCC"> channel and</font>

566
00:22:42,919 --> 00:22:45,799
well if they're paying attention<font color="#CCCCCC"> on</font>

567
00:22:44,000 --> 00:22:47,030
their machine they'll notice you have no

568
00:22:45,799 --> 00:22:54,290
traffic<font color="#E5E5E5"> and then you can have your</font>

569
00:22:47,030 --> 00:22:56,330
botanist or<font color="#E5E5E5"> issuing commands right well</font>

570
00:22:54,290 --> 00:22:57,440
thank<font color="#E5E5E5"> you all for</font><font color="#CCCCCC"> coming I hope you have</font>

571
00:22:56,330 --> 00:23:00,939
fun of your<font color="#CCCCCC"> connection</font>

572
00:22:57,440 --> 00:23:00,940
[Applause]

