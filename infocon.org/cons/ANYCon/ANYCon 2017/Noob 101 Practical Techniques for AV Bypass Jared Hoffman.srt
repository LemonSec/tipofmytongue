1
00:00:00,000 --> 00:00:11,250
oh boy<font color="#E5E5E5"> here we go</font><font color="#CCCCCC"> girl</font>

2
00:00:07,379 --> 00:00:12,629
<font color="#E5E5E5">um well thank everybody any</font><font color="#CCCCCC"> con 2017</font>

3
00:00:11,250 --> 00:00:16,289
<font color="#CCCCCC">seems you got</font><font color="#E5E5E5"> some more</font><font color="#CCCCCC"> people coming in</font>

4
00:00:12,630 --> 00:00:18,060
I want to<font color="#E5E5E5"> thank</font><font color="#CCCCCC"> Tyler and the guys from</font>

5
00:00:16,289 --> 00:00:21,449
<font color="#CCCCCC">weeks's for giving me the opportunity to</font>

6
00:00:18,060 --> 00:00:24,330
<font color="#E5E5E5">come talk today</font><font color="#CCCCCC"> new 101 practical</font>

7
00:00:21,449 --> 00:00:25,529
techniques for<font color="#CCCCCC"> 85s I really hate</font><font color="#E5E5E5"> this</font>

8
00:00:24,330 --> 00:00:27,990
title<font color="#CCCCCC"> uh-huh</font>

9
00:00:25,529 --> 00:00:29,369
<font color="#E5E5E5">and when I was putting in my my talk I</font>

10
00:00:27,990 --> 00:00:31,769
was<font color="#CCCCCC"> mochas more</font><font color="#E5E5E5"> focused</font><font color="#CCCCCC"> in the</font>

11
00:00:29,369 --> 00:00:33,690
description and I kind of did<font color="#CCCCCC"> it left</font>

12
00:00:31,769 --> 00:00:35,519
<font color="#E5E5E5">the title off because it's just kind of</font>

13
00:00:33,690 --> 00:00:37,530
<font color="#E5E5E5">stupid on a few different levels but</font>

14
00:00:35,520 --> 00:00:39,690
really what<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> is my journey it's a</font>

15
00:00:37,530 --> 00:00:41,730
really 85<font color="#CCCCCC"> past and we'll look at</font><font color="#E5E5E5"> some</font>

16
00:00:39,690 --> 00:00:43,468
cool techniques and I don't want<font color="#E5E5E5"> to</font>

17
00:00:41,730 --> 00:00:45,029
disappoint<font color="#E5E5E5"> I was going to plan to do you</font>

18
00:00:43,469 --> 00:00:48,690
know<font color="#E5E5E5"> all this hands-on demo kind of</font>

19
00:00:45,030 --> 00:00:50,670
stuff<font color="#CCCCCC"> but I</font><font color="#E5E5E5"> didn't want a role to die</font>

20
00:00:48,690 --> 00:00:52,019
too much with the demo God's oh we got

21
00:00:50,670 --> 00:00:54,750
some videos and<font color="#CCCCCC"> some of the</font><font color="#E5E5E5"> techniques</font>

22
00:00:52,020 --> 00:00:56,250
but some pretty cool stuff<font color="#CCCCCC"> and I'm kind</font>

23
00:00:54,750 --> 00:00:57,600
of the<font color="#CCCCCC"> guy before me was a little</font><font color="#E5E5E5"> sick</font>

24
00:00:56,250 --> 00:00:58,920
so<font color="#E5E5E5"> I don't necessarily want to roll</font><font color="#CCCCCC"> with</font>

25
00:00:57,600 --> 00:01:00,449
the microphone so if you have an<font color="#E5E5E5"> issue</font>

26
00:00:58,920 --> 00:01:03,090
<font color="#CCCCCC">here I may just let me know</font><font color="#E5E5E5"> and I'll</font>

27
00:01:00,449 --> 00:01:06,509
talk talk louder but my name is<font color="#E5E5E5"> Jared</font>

28
00:01:03,090 --> 00:01:08,520
Hoffman about until about a year and a

29
00:01:06,510 --> 00:01:10,860
half ago<font color="#E5E5E5"> or so I</font><font color="#CCCCCC"> started this little</font>

30
00:01:08,520 --> 00:01:13,048
local<font color="#E5E5E5"> bass InfoSec security consulting</font>

31
00:01:10,860 --> 00:01:15,330
company called cyber decode all the

32
00:01:13,049 --> 00:01:18,390
content from<font color="#E5E5E5"> the presentation today the</font>

33
00:01:15,330 --> 00:01:19,798
slides<font color="#CCCCCC"> who have a video we watch a few</font>

34
00:01:18,390 --> 00:01:21,270
videos but all the videos are up there

35
00:01:19,799 --> 00:01:23,700
as<font color="#E5E5E5"> well as some source code for some</font>

36
00:01:21,270 --> 00:01:24,899
different<font color="#E5E5E5"> techniques I did</font><font color="#CCCCCC"> you can find</font>

37
00:01:23,700 --> 00:01:27,270
some background<font color="#CCCCCC"> about me and</font><font color="#E5E5E5"> what the</font>

38
00:01:24,900 --> 00:01:29,700
company does really<font color="#E5E5E5"> my backgrounds</font>

39
00:01:27,270 --> 00:01:31,408
offensive security<font color="#CCCCCC"> and that's where</font>

40
00:01:29,700 --> 00:01:33,990
<font color="#CCCCCC">we'll be specialized there</font><font color="#E5E5E5"> and so what's</font>

41
00:01:31,409 --> 00:01:36,390
the<font color="#E5E5E5"> talk about today</font><font color="#CCCCCC"> so really the</font>

42
00:01:33,990 --> 00:01:37,860
<font color="#CCCCCC">objective is how could</font><font color="#E5E5E5"> I deliver a well</font>

43
00:01:36,390 --> 00:01:40,670
<font color="#E5E5E5">known payload in today's payload</font>

44
00:01:37,860 --> 00:01:42,630
meterpreter<font color="#CCCCCC"> the reverse</font><font color="#E5E5E5"> HTTP interpreter</font>

45
00:01:40,670 --> 00:01:44,640
something that's well known to a lot<font color="#CCCCCC"> of</font>

46
00:01:42,630 --> 00:01:46,798
<font color="#E5E5E5">AV vendors out</font><font color="#CCCCCC"> there and still have it</font>

47
00:01:44,640 --> 00:01:48,270
<font color="#CCCCCC">bypassed kind of they're just</font><font color="#E5E5E5"> detection</font>

48
00:01:46,799 --> 00:01:50,220
techniques<font color="#E5E5E5"> right so I'm not</font><font color="#CCCCCC"> talking</font>

49
00:01:48,270 --> 00:01:53,460
<font color="#CCCCCC">about</font><font color="#E5E5E5"> you know some new</font><font color="#CCCCCC"> leaked technique</font>

50
00:01:50,220 --> 00:01:54,750
<font color="#E5E5E5">zero-day no</font><font color="#CCCCCC"> rob chain here</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I'm</font>

51
00:01:53,460 --> 00:01:57,149
definitely not downplaying the role of

52
00:01:54,750 --> 00:01:59,070
<font color="#CCCCCC">AV</font><font color="#E5E5E5"> and it's actually the</font><font color="#CCCCCC"> complete</font>

53
00:01:57,149 --> 00:02:00,750
opposite when I was<font color="#E5E5E5"> doing this and I was</font>

54
00:01:59,070 --> 00:02:02,850
running<font color="#E5E5E5"> through some trial versions of</font>

55
00:02:00,750 --> 00:02:05,390
the different AV to test the one that I

56
00:02:02,850 --> 00:02:08,068
picked it was super annoying<font color="#E5E5E5"> in that</font>

57
00:02:05,390 --> 00:02:09,598
<font color="#E5E5E5">base configuration out of the bat it</font>

58
00:02:08,068 --> 00:02:11,190
pretty much<font color="#E5E5E5"> hated every technique I</font>

59
00:02:09,598 --> 00:02:13,500
didn't was always flagging things that I

60
00:02:11,190 --> 00:02:15,690
was trying<font color="#CCCCCC"> to do so I really</font>

61
00:02:13,500 --> 00:02:17,430
got to<font color="#CCCCCC"> appreciate that</font><font color="#E5E5E5"> hey</font><font color="#CCCCCC"> abs very good</font>

62
00:02:15,690 --> 00:02:19,680
you<font color="#E5E5E5"> know getting that</font><font color="#CCCCCC"> low-hanging fruit</font>

63
00:02:17,430 --> 00:02:20,670
I wouldn't<font color="#CCCCCC"> rely on it as a significant</font>

64
00:02:19,680 --> 00:02:23,100
control that stops you know

65
00:02:20,670 --> 00:02:25,380
sophisticated based attacks and these

66
00:02:23,100 --> 00:02:27,000
new kind of<font color="#CCCCCC"> AV</font><font color="#E5E5E5"> next-gen AV kind of</font>

67
00:02:25,380 --> 00:02:28,590
<font color="#E5E5E5">software integrates not just you know</font>

68
00:02:27,000 --> 00:02:30,420
<font color="#E5E5E5">virus detection but maybe some network</font>

69
00:02:28,590 --> 00:02:32,400
controls<font color="#CCCCCC"> IPS ideas</font><font color="#E5E5E5"> kind of stuff like</font>

70
00:02:30,420 --> 00:02:33,600
<font color="#CCCCCC">that</font><font color="#E5E5E5"> so there's</font><font color="#CCCCCC"> definitely a role</font><font color="#E5E5E5"> for AV</font>

71
00:02:32,400 --> 00:02:36,390
and your security<font color="#E5E5E5"> architecture your</font>

72
00:02:33,600 --> 00:02:37,859
security program for your<font color="#E5E5E5"> endpoints but</font>

73
00:02:36,390 --> 00:02:39,239
<font color="#E5E5E5">it should be you know</font><font color="#CCCCCC"> a defense in-depth</font>

74
00:02:37,860 --> 00:02:41,130
approach stuff that we probably<font color="#E5E5E5"> tell</font>

75
00:02:39,240 --> 00:02:43,740
clients<font color="#CCCCCC"> right one control is not enough</font>

76
00:02:41,130 --> 00:02:46,590
<font color="#CCCCCC">you</font><font color="#E5E5E5"> want to have multiple and this</font>

77
00:02:43,740 --> 00:02:47,520
worked for<font color="#E5E5E5"> me and it today and it might</font>

78
00:02:46,590 --> 00:02:49,770
<font color="#CCCCCC">not work for you</font><font color="#E5E5E5"> tomorrow</font>

79
00:02:47,520 --> 00:02:51,410
these AV companies<font color="#E5E5E5"> have some very</font>

80
00:02:49,770 --> 00:02:53,820
intelligent<font color="#E5E5E5"> people that</font><font color="#CCCCCC"> are trying</font><font color="#E5E5E5"> to</font>

81
00:02:51,410 --> 00:02:56,130
you know come up<font color="#E5E5E5"> with new ways and new</font>

82
00:02:53,820 --> 00:02:57,660
<font color="#CCCCCC">avenues for detecting you know</font><font color="#E5E5E5"> I showed</font>

83
00:02:56,130 --> 00:03:00,329
<font color="#E5E5E5">you</font><font color="#CCCCCC"> and virus all that I'll just use the</font>

84
00:02:57,660 --> 00:03:02,400
term malware to detect that<font color="#E5E5E5"> in the wild</font>

85
00:03:00,330 --> 00:03:04,290
<font color="#CCCCCC">as we're trying</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> fight</font><font color="#E5E5E5"> past those</font>

86
00:03:02,400 --> 00:03:09,239
<font color="#E5E5E5">controls so it's a back and</font><font color="#CCCCCC"> forth kind</font>

87
00:03:04,290 --> 00:03:11,250
of kind of situation but inherently the

88
00:03:09,239 --> 00:03:12,600
benefit might fall to us<font color="#E5E5E5"> on our side in</font>

89
00:03:11,250 --> 00:03:14,550
terms<font color="#E5E5E5"> of the offensive</font><font color="#CCCCCC"> counter</font>

90
00:03:12,600 --> 00:03:16,049
perspective right so<font color="#CCCCCC"> well</font><font color="#E5E5E5"> I was doing</font>

91
00:03:14,550 --> 00:03:20,940
<font color="#CCCCCC">some digging on</font><font color="#E5E5E5"> this I</font><font color="#CCCCCC"> came across this</font>

92
00:03:16,050 --> 00:03:23,010
guy straight og bleep<font color="#CCCCCC"> Fred</font><font color="#E5E5E5"> Cullen and he</font>

93
00:03:20,940 --> 00:03:24,810
wrote a paper in 1984<font color="#E5E5E5"> called computer</font>

94
00:03:23,010 --> 00:03:27,149
viruses theories and experiments<font color="#CCCCCC"> and</font>

95
00:03:24,810 --> 00:03:29,400
<font color="#E5E5E5">this guy is really the for a lack of a</font>

96
00:03:27,150 --> 00:03:31,620
<font color="#CCCCCC">better term like the inventor of a</font>

97
00:03:29,400 --> 00:03:32,790
detection<font color="#E5E5E5"> techniques and right in the</font>

98
00:03:31,620 --> 00:03:34,200
<font color="#CCCCCC">beginning of his paper and the</font>

99
00:03:32,790 --> 00:03:36,179
<font color="#E5E5E5">introduction to abstract he says in</font>

100
00:03:34,200 --> 00:03:38,339
general detection of a virus is shown to

101
00:03:36,180 --> 00:03:41,459
be undecidable<font color="#E5E5E5"> and what Fred means here</font>

102
00:03:38,340 --> 00:03:43,590
is<font color="#E5E5E5"> that there's no single</font><font color="#CCCCCC"> algorithm or</font>

103
00:03:41,459 --> 00:03:45,299
process<font color="#E5E5E5"> that he can apply to any piece</font>

104
00:03:43,590 --> 00:03:46,890
<font color="#CCCCCC">of code any piece of software that's</font>

105
00:03:45,299 --> 00:03:48,930
<font color="#CCCCCC">going to give them</font><font color="#E5E5E5"> a</font><font color="#CCCCCC"> definitive yes or</font>

106
00:03:46,890 --> 00:03:51,450
<font color="#CCCCCC">no answer</font><font color="#E5E5E5"> right is this a V is this</font>

107
00:03:48,930 --> 00:03:54,150
<font color="#E5E5E5">malware</font><font color="#CCCCCC"> yes or no it's always going</font><font color="#E5E5E5"> to</font>

108
00:03:51,450 --> 00:03:56,130
be<font color="#CCCCCC"> gray so that's really why it's</font><font color="#E5E5E5"> kind</font>

109
00:03:54,150 --> 00:03:58,260
of still the the benefit might be on<font color="#E5E5E5"> our</font>

110
00:03:56,130 --> 00:03:59,850
side that you know independent<font color="#CCCCCC"> of what</font>

111
00:03:58,260 --> 00:04:01,320
kind<font color="#CCCCCC"> of controls are put into place</font>

112
00:03:59,850 --> 00:04:03,239
there should be an<font color="#CCCCCC"> avenue</font><font color="#E5E5E5"> by which we</font>

113
00:04:01,320 --> 00:04:05,760
<font color="#E5E5E5">can bypass those controls right so we</font>

114
00:04:03,239 --> 00:04:08,760
knew<font color="#E5E5E5"> this back in 1984 and we're still</font>

115
00:04:05,760 --> 00:04:10,320
<font color="#CCCCCC">fighting</font><font color="#E5E5E5"> that fight today so what kind</font>

116
00:04:08,760 --> 00:04:13,230
of techniques are<font color="#CCCCCC"> we to look at and try</font>

117
00:04:10,320 --> 00:04:15,600
<font color="#E5E5E5">to get around</font><font color="#CCCCCC"> so signature-based</font><font color="#E5E5E5"> kind of</font>

118
00:04:13,230 --> 00:04:17,279
detection<font color="#E5E5E5"> is</font><font color="#CCCCCC"> I see a programmer see a</font>

119
00:04:15,600 --> 00:04:19,409
<font color="#E5E5E5">piece of software</font><font color="#CCCCCC"> and I already have a</font>

120
00:04:17,279 --> 00:04:20,969
record of<font color="#E5E5E5"> that</font><font color="#CCCCCC"> in my AV database right</font>

121
00:04:19,410 --> 00:04:22,770
so I've I've seen<font color="#CCCCCC"> that before</font><font color="#E5E5E5"> I have a</font>

122
00:04:20,970 --> 00:04:25,410
way to uniquely identify that software

123
00:04:22,770 --> 00:04:27,359
might have a hash or or some<font color="#E5E5E5"> variant of</font>

124
00:04:25,410 --> 00:04:28,949
<font color="#CCCCCC">that so I know</font><font color="#E5E5E5"> but already</font>

125
00:04:27,360 --> 00:04:31,229
imagines that signature hey that's a

126
00:04:28,949 --> 00:04:33,990
that's a virus<font color="#E5E5E5"> the second one is</font>

127
00:04:31,229 --> 00:04:35,550
heuristics<font color="#CCCCCC"> and</font><font color="#E5E5E5"> when we get caught in our</font>

128
00:04:33,990 --> 00:04:38,219
examples here<font color="#CCCCCC"> and heuristic detection</font>

129
00:04:35,550 --> 00:04:40,080
it's kind<font color="#E5E5E5"> of static analysis so it's</font>

130
00:04:38,219 --> 00:04:42,449
kind of looking<font color="#E5E5E5"> at this</font><font color="#CCCCCC"> with a structure</font>

131
00:04:40,080 --> 00:04:44,159
of<font color="#E5E5E5"> that PE file hey is this similar to</font>

132
00:04:42,449 --> 00:04:47,009
<font color="#E5E5E5">something that flagged as a virus</font>

133
00:04:44,159 --> 00:04:48,210
already<font color="#E5E5E5"> and if so if it walks like a</font>

134
00:04:47,009 --> 00:04:49,979
<font color="#E5E5E5">duck talks like a duck it's going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be</font>

135
00:04:48,210 --> 00:04:53,520
a duck<font color="#E5E5E5"> so I'm going to flag that</font><font color="#CCCCCC"> as</font>

136
00:04:49,979 --> 00:04:56,159
malicious<font color="#E5E5E5"> behavioral and this is kind of</font>

137
00:04:53,520 --> 00:04:58,139
like if the quasi sandbox<font color="#E5E5E5"> one right so</font>

138
00:04:56,159 --> 00:05:00,569
what it's<font color="#E5E5E5"> going to do is that executable</font>

139
00:04:58,139 --> 00:05:02,219
<font color="#E5E5E5">in our in our</font><font color="#CCCCCC"> context here and the demos</font>

140
00:05:00,569 --> 00:05:03,990
is going to run and then it's going<font color="#E5E5E5"> to</font>

141
00:05:02,219 --> 00:05:05,610
<font color="#E5E5E5">see what is that executable doing is it</font>

142
00:05:03,990 --> 00:05:08,280
dumping a lot<font color="#E5E5E5"> of stuff to temp</font>

143
00:05:05,610 --> 00:05:10,229
directories is it changing registry keys

144
00:05:08,280 --> 00:05:11,849
or is it going<font color="#CCCCCC"> to hit the network</font><font color="#E5E5E5"> right</font>

145
00:05:10,229 --> 00:05:13,318
<font color="#CCCCCC">so one big</font><font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that we see is you know</font>

146
00:05:11,849 --> 00:05:15,120
when<font color="#E5E5E5"> we started using the network start</font>

147
00:05:13,319 --> 00:05:18,180
<font color="#E5E5E5">using the wire our</font><font color="#CCCCCC"> AV is going to perk</font>

148
00:05:15,120 --> 00:05:20,009
up<font color="#E5E5E5"> but based on the behavior has certain</font>

149
00:05:18,180 --> 00:05:21,509
<font color="#CCCCCC">attributes that the ad vendor has it</font>

150
00:05:20,009 --> 00:05:23,340
says you know when it's<font color="#E5E5E5"> doing these kind</font>

151
00:05:21,509 --> 00:05:25,169
of actions<font color="#CCCCCC"> I believe this to be a</font>

152
00:05:23,340 --> 00:05:27,539
minister malicious nature<font color="#CCCCCC"> now usually</font>

153
00:05:25,169 --> 00:05:29,669
<font color="#CCCCCC">the alerts that</font><font color="#E5E5E5"> come out are hey this is</font>

154
00:05:27,539 --> 00:05:32,099
suspicious<font color="#CCCCCC"> and so it's not a definitive</font>

155
00:05:29,669 --> 00:05:33,840
<font color="#E5E5E5">hey I believe</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is absolutely a virus</font>

156
00:05:32,099 --> 00:05:35,969
it's just this<font color="#E5E5E5"> seems kind of odd you</font>

157
00:05:33,840 --> 00:05:39,179
<font color="#CCCCCC">might want to take some</font><font color="#E5E5E5"> action and</font><font color="#CCCCCC"> then</font>

158
00:05:35,969 --> 00:05:40,979
<font color="#E5E5E5">real time and that's when like your</font><font color="#CCCCCC"> Auto</font>

159
00:05:39,180 --> 00:05:42,389
<font color="#E5E5E5">protection so you</font><font color="#CCCCCC"> download something</font>

160
00:05:40,979 --> 00:05:44,609
<font color="#CCCCCC">from the internet</font><font color="#E5E5E5"> whenever you're</font>

161
00:05:42,389 --> 00:05:46,560
writing some the<font color="#E5E5E5"> to disk or I believe</font>

162
00:05:44,610 --> 00:05:47,940
right into memory download from the

163
00:05:46,560 --> 00:05:51,389
internet pull it down some from a file

164
00:05:47,940 --> 00:05:52,650
share it's going to<font color="#CCCCCC"> Auto scan or scan</font>

165
00:05:51,389 --> 00:05:55,620
<font color="#E5E5E5">that data right</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> the fly that's the</font>

166
00:05:52,650 --> 00:05:57,029
<font color="#CCCCCC">real-time protection</font><font color="#E5E5E5"> so what are</font>

167
00:05:55,620 --> 00:06:00,360
scenarios<font color="#E5E5E5"> that</font><font color="#CCCCCC"> were going</font><font color="#E5E5E5"> to look at</font>

168
00:05:57,029 --> 00:06:01,919
<font color="#E5E5E5">today</font><font color="#CCCCCC"> then</font><font color="#E5E5E5"> this is kind of what Dave was</font>

169
00:06:00,360 --> 00:06:03,839
talking<font color="#CCCCCC"> about this</font><font color="#E5E5E5"> morning right so how</font>

170
00:06:01,919 --> 00:06:06,960
can we<font color="#CCCCCC"> generate just</font><font color="#E5E5E5"> that standalone</font>

171
00:06:03,839 --> 00:06:08,699
<font color="#CCCCCC">right so just</font><font color="#E5E5E5"> the just a portable</font><font color="#CCCCCC"> XC</font>

172
00:06:06,960 --> 00:06:10,739
that<font color="#CCCCCC"> I can use</font><font color="#E5E5E5"> across an enterprise</font>

173
00:06:08,699 --> 00:06:13,169
across<font color="#CCCCCC"> multiple</font><font color="#E5E5E5"> clients that's going to</font>

174
00:06:10,740 --> 00:06:14,810
bypass<font color="#E5E5E5"> these detection techniques so</font>

175
00:06:13,169 --> 00:06:17,279
we'll see how<font color="#E5E5E5"> we can go around</font>

176
00:06:14,810 --> 00:06:18,539
<font color="#E5E5E5">generating that so you know we first we</font>

177
00:06:17,279 --> 00:06:20,339
<font color="#E5E5E5">tried different frameworks we tried</font>

178
00:06:18,539 --> 00:06:22,020
<font color="#CCCCCC">Metasploit we try the veil framework and</font>

179
00:06:20,339 --> 00:06:24,089
we'll<font color="#E5E5E5"> get into that and we'll see really</font>

180
00:06:22,020 --> 00:06:27,419
at the<font color="#CCCCCC"> end of the day customization is</font>

181
00:06:24,089 --> 00:06:28,800
really the best or custom piece the

182
00:06:27,419 --> 00:06:31,378
second scenario<font color="#CCCCCC"> is some stealth</font>

183
00:06:28,800 --> 00:06:33,060
persistence<font color="#CCCCCC"> I don't know if anyone's</font>

184
00:06:31,379 --> 00:06:34,979
familiar out there with a very

185
00:06:33,060 --> 00:06:37,740
sophisticated piece<font color="#CCCCCC"> of software called</font>

186
00:06:34,979 --> 00:06:39,990
shelter like<font color="#CCCCCC"> high recon and it does some</font>

187
00:06:37,740 --> 00:06:40,950
dynamic<font color="#CCCCCC"> PE infection</font><font color="#E5E5E5"> so we're going to</font>

188
00:06:39,990 --> 00:06:44,400
look<font color="#E5E5E5"> to do so</font>

189
00:06:40,950 --> 00:06:46,140
more sophisticated<font color="#CCCCCC"> backdoor or</font><font color="#E5E5E5"> percent</font>

190
00:06:44,400 --> 00:06:48,120
persistence on machine<font color="#E5E5E5"> once we've</font>

191
00:06:46,140 --> 00:06:51,090
compromised it and then<font color="#CCCCCC"> this third</font>

192
00:06:48,120 --> 00:06:53,400
<font color="#E5E5E5">technique</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> PowerPoint mouse over</font>

193
00:06:51,090 --> 00:06:54,810
action<font color="#E5E5E5"> literally up until two days ago</font>

194
00:06:53,400 --> 00:06:55,799
<font color="#E5E5E5">this third one was</font><font color="#CCCCCC"> just going to</font><font color="#E5E5E5"> be</font>

195
00:06:54,810 --> 00:06:58,710
run-of-the-mill

196
00:06:55,800 --> 00:07:01,440
macro and a<font color="#E5E5E5"> word doc but then John from</font>

197
00:06:58,710 --> 00:07:04,409
<font color="#CCCCCC">Lisa's shared a dark reading article</font>

198
00:07:01,440 --> 00:07:06,990
<font color="#E5E5E5">with me and recently they've noted a lot</font>

199
00:07:04,410 --> 00:07:09,000
of malware variants are delivering you

200
00:07:06,990 --> 00:07:10,680
know<font color="#CCCCCC"> their droppers via this mouse over</font>

201
00:07:09,000 --> 00:07:13,410
action<font color="#E5E5E5"> and</font><font color="#CCCCCC"> PowerPoint files so I was</font>

202
00:07:10,680 --> 00:07:15,450
like that's its relevance recent let's

203
00:07:13,410 --> 00:07:19,890
check it out so I<font color="#E5E5E5"> incorporated that into</font>

204
00:07:15,450 --> 00:07:21,120
it<font color="#E5E5E5"> and the third scenario also uses well</font>

205
00:07:19,890 --> 00:07:22,200
it kind of plays<font color="#E5E5E5"> a role in all three</font>

206
00:07:21,120 --> 00:07:23,760
scenarios<font color="#E5E5E5"> but the third row most</font>

207
00:07:22,200 --> 00:07:25,979
importantly is a<font color="#E5E5E5"> application</font>

208
00:07:23,760 --> 00:07:28,230
whitelisting and bypassing that so<font color="#CCCCCC"> Dave</font>

209
00:07:25,980 --> 00:07:30,510
spoke this<font color="#CCCCCC"> morning about the the new hit</font>

210
00:07:28,230 --> 00:07:33,690
approach using the register server

211
00:07:30,510 --> 00:07:35,039
utility<font color="#E5E5E5"> that CLI register 32 so that</font>

212
00:07:33,690 --> 00:07:36,960
third technique we're<font color="#CCCCCC"> going to show how</font>

213
00:07:35,040 --> 00:07:38,970
<font color="#CCCCCC">you can use</font><font color="#E5E5E5"> that to get remote code</font>

214
00:07:36,960 --> 00:07:40,620
execution<font color="#E5E5E5"> and then once I have remote</font>

215
00:07:38,970 --> 00:07:43,590
code execution<font color="#CCCCCC"> how I can leverage</font>

216
00:07:40,620 --> 00:07:46,320
PowerShell<font color="#E5E5E5"> enough in a non network</font>

217
00:07:43,590 --> 00:07:49,140
fashion to<font color="#CCCCCC"> to execute</font><font color="#E5E5E5"> them interpreter</font>

218
00:07:46,320 --> 00:07:53,370
<font color="#E5E5E5">payload so our victim today just</font><font color="#CCCCCC"> the</font>

219
00:07:49,140 --> 00:07:54,810
<font color="#E5E5E5">standard windows 7 service pack 1 VM the</font>

220
00:07:53,370 --> 00:07:56,760
<font color="#CCCCCC">8ly software that ended</font><font color="#E5E5E5"> up going with</font>

221
00:07:54,810 --> 00:07:58,470
was<font color="#CCCCCC"> Norton security so this is</font><font color="#E5E5E5"> not</font>

222
00:07:56,760 --> 00:07:59,789
Symantec endpoint protection<font color="#E5E5E5"> this is</font>

223
00:07:58,470 --> 00:08:03,030
probably something<font color="#E5E5E5"> that they'll sell to</font>

224
00:07:59,790 --> 00:08:06,540
their home clients<font color="#CCCCCC"> I chose it because it</font>

225
00:08:03,030 --> 00:08:08,820
<font color="#E5E5E5">was it was</font><font color="#CCCCCC"> the hardest if you</font><font color="#E5E5E5"> could say</font>

226
00:08:06,540 --> 00:08:10,770
that it was<font color="#E5E5E5"> without changing any</font>

227
00:08:08,820 --> 00:08:13,680
settings any<font color="#E5E5E5"> configurations just install</font>

228
00:08:10,770 --> 00:08:15,210
and ran it it really<font color="#CCCCCC"> flagged on a lot of</font>

229
00:08:13,680 --> 00:08:17,250
<font color="#E5E5E5">different things and</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> was really</font>

230
00:08:15,210 --> 00:08:19,380
<font color="#CCCCCC">annoyed when</font><font color="#E5E5E5"> I try to circumvent other</font>

231
00:08:17,250 --> 00:08:21,270
things so I said<font color="#CCCCCC"> might as well just use</font>

232
00:08:19,380 --> 00:08:22,830
the hardest one now one<font color="#E5E5E5"> thing to keep in</font>

233
00:08:21,270 --> 00:08:23,849
<font color="#CCCCCC">mind too and</font><font color="#E5E5E5"> kind of goes</font><font color="#CCCCCC"> back to</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> I</font>

234
00:08:22,830 --> 00:08:27,180
was<font color="#E5E5E5"> saying this word for me might not</font>

235
00:08:23,850 --> 00:08:29,010
<font color="#E5E5E5">work</font><font color="#CCCCCC"> for you when we look at the steps</font>

236
00:08:27,180 --> 00:08:30,390
that I<font color="#E5E5E5"> hid so like fail you're fairly</font>

237
00:08:29,010 --> 00:08:32,340
fair and then eventually<font color="#E5E5E5"> it works</font>

238
00:08:30,390 --> 00:08:33,900
certain AV products you might<font color="#E5E5E5"> only</font><font color="#CCCCCC"> have</font>

239
00:08:32,340 --> 00:08:36,090
to go<font color="#E5E5E5"> down two or three steps and it</font>

240
00:08:33,900 --> 00:08:37,860
might work<font color="#E5E5E5"> for you right I chose this</font>

241
00:08:36,090 --> 00:08:39,840
one<font color="#CCCCCC"> because</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> really exhausted all</font>

242
00:08:37,860 --> 00:08:41,250
those possibilities to really what do I

243
00:08:39,840 --> 00:08:44,340
need<font color="#E5E5E5"> to do to get around this piece of</font>

244
00:08:41,250 --> 00:08:45,870
<font color="#E5E5E5">software so</font><font color="#CCCCCC"> it's pretty cool um</font><font color="#E5E5E5"> it's got</font>

245
00:08:44,340 --> 00:08:47,940
<font color="#E5E5E5">the auto projection</font><font color="#CCCCCC"> the real-time boot</font>

246
00:08:45,870 --> 00:08:50,580
protection the sonar protection is<font color="#E5E5E5"> that</font>

247
00:08:47,940 --> 00:08:52,110
<font color="#E5E5E5">behavior detection</font><font color="#CCCCCC"> we get caught</font><font color="#E5E5E5"> up on</font>

248
00:08:50,580 --> 00:08:53,010
<font color="#E5E5E5">that</font><font color="#CCCCCC"> a few times</font><font color="#E5E5E5"> which is interesting</font>

249
00:08:52,110 --> 00:08:54,480
<font color="#E5E5E5">and then</font>

250
00:08:53,010 --> 00:08:56,760
like it because it rolled in the smart

251
00:08:54,480 --> 00:08:58,650
firewall and then<font color="#E5E5E5"> the IPS we don't</font>

252
00:08:56,760 --> 00:09:01,740
<font color="#E5E5E5">really get</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> exploit prevention here</font>

253
00:08:58,650 --> 00:09:03,360
<font color="#CCCCCC">so it's just more firewall controls</font><font color="#E5E5E5"> IDs</font>

254
00:09:01,740 --> 00:09:07,110
alerts when we're trying<font color="#E5E5E5"> to do our</font>

255
00:09:03,360 --> 00:09:09,180
<font color="#E5E5E5">bypass our attacker VMs</font><font color="#CCCCCC"> I mean the</font>

256
00:09:07,110 --> 00:09:10,020
<font color="#CCCCCC">tried-and-true Kali Linux really that's</font>

257
00:09:09,180 --> 00:09:12,030
going<font color="#CCCCCC"> to be our command and</font><font color="#E5E5E5"> control</font>

258
00:09:10,020 --> 00:09:15,180
<font color="#CCCCCC">reviews the</font><font color="#E5E5E5"> framework for</font><font color="#CCCCCC"> that to catch</font>

259
00:09:12,030 --> 00:09:16,530
our callbacks<font color="#CCCCCC"> and then we also have a</font>

260
00:09:15,180 --> 00:09:18,750
Windows 10 box that I'm running<font color="#E5E5E5"> a</font>

261
00:09:16,530 --> 00:09:20,790
community<font color="#CCCCCC"> edition of</font><font color="#E5E5E5"> Visual Studio on</font>

262
00:09:18,750 --> 00:09:23,070
and when<font color="#E5E5E5"> we talk about building our own</font>

263
00:09:20,790 --> 00:09:26,339
executable files<font color="#CCCCCC"> we look</font><font color="#E5E5E5"> into doing that</font>

264
00:09:23,070 --> 00:09:30,720
with Visual Studio<font color="#CCCCCC"> so one of the prereqs</font>

265
00:09:26,340 --> 00:09:33,810
<font color="#E5E5E5">for the talk is in the videos</font><font color="#CCCCCC"> to see it</font>

266
00:09:30,720 --> 00:09:35,910
but<font color="#E5E5E5"> I'm sharing</font><font color="#CCCCCC"> these files</font><font color="#E5E5E5"> between the</font>

267
00:09:33,810 --> 00:09:38,699
attacking<font color="#E5E5E5"> VM and the victim VN via just</font>

268
00:09:35,910 --> 00:09:40,350
<font color="#E5E5E5">a simple VMware shared folder so this is</font>

269
00:09:38,700 --> 00:09:42,600
kind of<font color="#E5E5E5"> taking</font><font color="#CCCCCC"> to account that</font><font color="#E5E5E5"> says hey</font>

270
00:09:40,350 --> 00:09:44,280
<font color="#E5E5E5">you've already</font><font color="#CCCCCC"> established a foothold on</font>

271
00:09:42,600 --> 00:09:46,020
this machine<font color="#CCCCCC"> you</font><font color="#E5E5E5"> already compromised it</font>

272
00:09:44,280 --> 00:09:47,910
in some manner<font color="#E5E5E5"> when I'm putting</font><font color="#CCCCCC"> these</font>

273
00:09:46,020 --> 00:09:50,970
files or testing these files on the

274
00:09:47,910 --> 00:09:53,040
system<font color="#CCCCCC"> I'm not reading it every</font><font color="#E5E5E5"> time so</font>

275
00:09:50,970 --> 00:09:54,300
<font color="#CCCCCC">it just for ease of</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> that was really</font>

276
00:09:53,040 --> 00:09:55,770
what<font color="#CCCCCC"> we're</font><font color="#E5E5E5"> going on here but just keep</font>

277
00:09:54,300 --> 00:09:59,250
<font color="#CCCCCC">in mind feels</font><font color="#E5E5E5"> like the first two</font>

278
00:09:55,770 --> 00:10:02,100
scenarios<font color="#CCCCCC"> building that XE and using the</font>

279
00:09:59,250 --> 00:10:04,230
shelter<font color="#E5E5E5"> for the persistence is really</font>

280
00:10:02,100 --> 00:10:05,970
kind<font color="#CCCCCC"> of post exploitation</font><font color="#E5E5E5"> right the</font>

281
00:10:04,230 --> 00:10:08,250
third one is maybe more fishing social

282
00:10:05,970 --> 00:10:09,810
engineering but they kind of go at the

283
00:10:08,250 --> 00:10:11,790
<font color="#E5E5E5">heart of</font><font color="#CCCCCC"> okay you're already on the</font><font color="#E5E5E5"> box</font>

284
00:10:09,810 --> 00:10:15,060
<font color="#E5E5E5">with admin rights</font><font color="#CCCCCC"> what can you do</font><font color="#E5E5E5"> from</font>

285
00:10:11,790 --> 00:10:17,069
there and even think<font color="#CCCCCC"> about it if let's</font>

286
00:10:15,060 --> 00:10:18,359
<font color="#E5E5E5">say for the XE and I was doing the pass</font>

287
00:10:17,070 --> 00:10:20,220
the hash and<font color="#CCCCCC"> I was jumping</font><font color="#E5E5E5"> and I was</font>

288
00:10:18,360 --> 00:10:23,040
pivoting<font color="#E5E5E5"> if I had</font><font color="#CCCCCC"> it XE that I knew</font>

289
00:10:20,220 --> 00:10:24,900
worked on one<font color="#CCCCCC"> enterprise</font><font color="#E5E5E5"> client if</font><font color="#CCCCCC"> they</font>

290
00:10:23,040 --> 00:10:26,069
<font color="#E5E5E5">thought other clients within the</font>

291
00:10:24,900 --> 00:10:27,420
enterprise kind of shared those same

292
00:10:26,070 --> 00:10:28,770
attributes<font color="#CCCCCC"> the same software</font>

293
00:10:27,420 --> 00:10:30,060
I would probably potentially have an

294
00:10:28,770 --> 00:10:32,220
actually that I could use<font color="#CCCCCC"> over and over</font>

295
00:10:30,060 --> 00:10:34,099
and over<font color="#E5E5E5"> again a custom XE and then with</font>

296
00:10:32,220 --> 00:10:36,270
the persistence if you<font color="#E5E5E5"> backdoor</font>

297
00:10:34,100 --> 00:10:38,150
application that again is<font color="#E5E5E5"> across all the</font>

298
00:10:36,270 --> 00:10:40,199
hosts you can just leverage<font color="#E5E5E5"> that</font>

299
00:10:38,150 --> 00:10:42,990
intelligence<font color="#E5E5E5"> and what we'll</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> is an</font>

300
00:10:40,200 --> 00:10:44,670
<font color="#E5E5E5">execution flow data and you can backdoor</font>

301
00:10:42,990 --> 00:10:47,610
<font color="#CCCCCC">that that application time time</font><font color="#E5E5E5"> again</font>

302
00:10:44,670 --> 00:10:49,530
<font color="#E5E5E5">right</font><font color="#CCCCCC"> so we're not really every time I</font>

303
00:10:47,610 --> 00:10:51,960
just want to<font color="#E5E5E5"> get that</font><font color="#CCCCCC"> out there</font>

304
00:10:49,530 --> 00:10:54,180
all right so the<font color="#E5E5E5"> first one is to</font>

305
00:10:51,960 --> 00:10:55,230
generate<font color="#E5E5E5"> this standalone</font><font color="#CCCCCC"> exe and really</font>

306
00:10:54,180 --> 00:10:57,569
what we want to<font color="#E5E5E5"> do at the</font><font color="#CCCCCC"> end</font><font color="#E5E5E5"> of the day</font>

307
00:10:55,230 --> 00:10:59,940
is build a<font color="#CCCCCC"> 32 bit XE for a</font><font color="#E5E5E5"> Windows</font>

308
00:10:57,570 --> 00:11:02,460
victim<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> going to deliver our</font>

309
00:10:59,940 --> 00:11:03,810
reverse<font color="#CCCCCC"> HTTP payload meterpreter payload</font>

310
00:11:02,460 --> 00:11:04,800
and really is it dot that<font color="#CCCCCC"> that at the</font>

311
00:11:03,810 --> 00:11:07,649
end of it

312
00:11:04,800 --> 00:11:08,939
at all this what happens<font color="#E5E5E5"> the best the</font>

313
00:11:07,649 --> 00:11:10,560
approach<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I had that work time and</font>

314
00:11:08,940 --> 00:11:13,020
<font color="#CCCCCC">time and</font><font color="#E5E5E5"> time again is building my own</font>

315
00:11:10,560 --> 00:11:15,630
executable so what we'll see here is

316
00:11:13,020 --> 00:11:17,189
I'll show<font color="#CCCCCC"> you a</font><font color="#E5E5E5"> bunch of</font><font color="#CCCCCC"> failures</font><font color="#E5E5E5"> and a</font>

317
00:11:15,630 --> 00:11:18,899
lot<font color="#CCCCCC"> of those are</font><font color="#E5E5E5"> coming out of</font>

318
00:11:17,190 --> 00:11:21,360
frameworks like default kind of settings

319
00:11:18,899 --> 00:11:23,250
the full<font color="#E5E5E5"> configurations</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> AV software</font>

320
00:11:21,360 --> 00:11:28,890
companies have known for a while<font color="#CCCCCC"> and</font>

321
00:11:23,250 --> 00:11:30,060
flag on very easily<font color="#CCCCCC"> okay</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right so</font>

322
00:11:28,890 --> 00:11:31,680
this<font color="#CCCCCC"> first one is really kind of our</font>

323
00:11:30,060 --> 00:11:34,529
baseline right so this one<font color="#E5E5E5"> all I</font>

324
00:11:31,680 --> 00:11:38,310
literally did was go<font color="#E5E5E5"> to into the</font>

325
00:11:34,529 --> 00:11:40,980
Metasploit framework<font color="#E5E5E5"> and generate of XE</font>

326
00:11:38,310 --> 00:11:43,109
payload for<font color="#E5E5E5"> reverse HCBS and then put</font>

327
00:11:40,980 --> 00:11:45,270
<font color="#CCCCCC">that on to</font><font color="#E5E5E5"> my host and immediately it</font>

328
00:11:43,110 --> 00:11:48,300
picks up very quickly and it flagged it

329
00:11:45,270 --> 00:11:50,640
on the auto protect here you can see

330
00:11:48,300 --> 00:11:52,949
<font color="#E5E5E5">auto protect and then the threat name</font>

331
00:11:50,640 --> 00:11:55,260
was this<font color="#CCCCCC"> packed generic 347 and if you</font>

332
00:11:52,950 --> 00:11:59,330
<font color="#E5E5E5">open that up</font><font color="#CCCCCC"> and go to Samantha's</font>

333
00:11:55,260 --> 00:12:02,250
website that alert is associated with

334
00:11:59,330 --> 00:12:03,420
payloads or X's that<font color="#E5E5E5"> are packed coming</font>

335
00:12:02,250 --> 00:12:05,610
out of the Metasploit framework and<font color="#CCCCCC"> that</font>

336
00:12:03,420 --> 00:12:06,870
was from<font color="#E5E5E5"> 2012</font><font color="#CCCCCC"> so they've</font><font color="#E5E5E5"> had that</font>

337
00:12:05,610 --> 00:12:08,910
signature<font color="#E5E5E5"> in place for about five years</font>

338
00:12:06,870 --> 00:12:10,770
<font color="#CCCCCC">now so this</font><font color="#E5E5E5"> is kind of like our control</font>

339
00:12:08,910 --> 00:12:12,390
flow right so we already know anything

340
00:12:10,770 --> 00:12:13,620
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> just generic</font><font color="#E5E5E5"> right off the</font><font color="#CCCCCC"> back</font>

341
00:12:12,390 --> 00:12:15,870
coming out of the framework is not<font color="#E5E5E5"> going</font>

342
00:12:13,620 --> 00:12:17,760
to work<font color="#E5E5E5"> and then</font>

343
00:12:15,870 --> 00:12:19,410
so all these<font color="#E5E5E5"> failures</font><font color="#CCCCCC"> also I have a</font>

344
00:12:17,760 --> 00:12:21,810
video up on the on the<font color="#CCCCCC"> website if you</font>

345
00:12:19,410 --> 00:12:24,060
want<font color="#CCCCCC"> to check</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> out so the next step</font>

346
00:12:21,810 --> 00:12:25,890
was<font color="#CCCCCC"> wow what can</font><font color="#E5E5E5"> I do</font><font color="#CCCCCC"> well I'm still in</font>

347
00:12:24,060 --> 00:12:28,050
<font color="#CCCCCC">Metasploit and that's with that payload</font>

348
00:12:25,890 --> 00:12:29,640
<font color="#E5E5E5">and I came across this article by Logan</font>

349
00:12:28,050 --> 00:12:31,500
<font color="#E5E5E5">Lemke from Black Hills Information</font>

350
00:12:29,640 --> 00:12:34,140
<font color="#E5E5E5">Security</font><font color="#CCCCCC"> and it kind of breaks down the</font>

351
00:12:31,500 --> 00:12:35,730
<font color="#E5E5E5">components of a Mercator payload</font><font color="#CCCCCC"> the</font>

352
00:12:34,140 --> 00:12:37,860
stage or the<font color="#E5E5E5"> template</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> the shell</font><font color="#CCCCCC"> coded</font>

353
00:12:35,730 --> 00:12:39,390
<font color="#CCCCCC">I really won't</font><font color="#E5E5E5"> get into it</font><font color="#CCCCCC"> but what we</font>

354
00:12:37,860 --> 00:12:41,250
can do is those are three<font color="#CCCCCC"> areas that we</font>

355
00:12:39,390 --> 00:12:42,899
<font color="#E5E5E5">can modify to kind of get around that</font>

356
00:12:41,250 --> 00:12:44,220
<font color="#E5E5E5">signature detection and that's the first</font>

357
00:12:42,899 --> 00:12:47,640
<font color="#E5E5E5">thing</font><font color="#CCCCCC"> we got with signature detection</font>

358
00:12:44,220 --> 00:12:51,300
<font color="#E5E5E5">the stager when we're talking 32 versus</font>

359
00:12:47,640 --> 00:12:52,740
64-bit platforms in our<font color="#CCCCCC"> scenario we're</font>

360
00:12:51,300 --> 00:12:54,449
just going against<font color="#CCCCCC"> 32-bit so we can't</font>

361
00:12:52,740 --> 00:12:56,339
really<font color="#CCCCCC"> change that but what I have found</font>

362
00:12:54,450 --> 00:12:58,200
while<font color="#E5E5E5"> testing other products is things</font>

363
00:12:56,339 --> 00:13:00,870
<font color="#E5E5E5">that might get easily flagged on 32-bit</font>

364
00:12:58,200 --> 00:13:02,640
<font color="#E5E5E5">work on a 64-bit so it's like there's a</font>

365
00:13:00,870 --> 00:13:05,550
gap<font color="#E5E5E5"> between those signatures they</font>

366
00:13:02,640 --> 00:13:07,050
haven't really close<font color="#E5E5E5"> that so some of the</font>

367
00:13:05,550 --> 00:13:09,000
simpler techniques that I'm using here

368
00:13:07,050 --> 00:13:10,829
the first kind<font color="#E5E5E5"> of few failures might</font>

369
00:13:09,000 --> 00:13:12,750
work against<font color="#CCCCCC"> a 64-bit system</font><font color="#E5E5E5"> because</font>

370
00:13:10,829 --> 00:13:14,760
that signatures<font color="#CCCCCC"> that's</font><font color="#E5E5E5"> not in place that</font>

371
00:13:12,750 --> 00:13:17,720
won't<font color="#E5E5E5"> get you around heuristics or</font>

372
00:13:14,760 --> 00:13:19,370
behavioral<font color="#E5E5E5"> or firewall like detection</font>

373
00:13:17,720 --> 00:13:21,889
stuff<font color="#E5E5E5"> but it will get you past that</font>

374
00:13:19,370 --> 00:13:23,540
<font color="#E5E5E5">initial signature so the shell code</font>

375
00:13:21,889 --> 00:13:25,399
<font color="#E5E5E5">already is going to be encoded mind</font>

376
00:13:23,540 --> 00:13:26,360
generated from the<font color="#CCCCCC"> pelo</font><font color="#E5E5E5"> but the really</font>

377
00:13:25,399 --> 00:13:27,500
thing I filled this<font color="#E5E5E5"> down was the</font>

378
00:13:26,360 --> 00:13:29,329
template which is<font color="#CCCCCC"> just</font><font color="#E5E5E5"> kind of the</font>

379
00:13:27,500 --> 00:13:30,889
wrapper<font color="#CCCCCC"> that's going to execute</font><font color="#E5E5E5"> our</font>

380
00:13:29,329 --> 00:13:32,329
shell code so coming<font color="#E5E5E5"> out</font><font color="#CCCCCC"> of the</font>

381
00:13:30,889 --> 00:13:33,459
framework there's a default<font color="#E5E5E5"> template</font>

382
00:13:32,329 --> 00:13:35,750
that's<font color="#E5E5E5"> going to be used every time</font>

383
00:13:33,459 --> 00:13:38,689
<font color="#E5E5E5">however we do have the option to change</font>

384
00:13:35,750 --> 00:13:40,610
that<font color="#E5E5E5"> so with a you know with a switch in</font>

385
00:13:38,689 --> 00:13:44,209
the command<font color="#E5E5E5"> you pass</font><font color="#CCCCCC"> in another</font><font color="#E5E5E5"> Windows</font>

386
00:13:40,610 --> 00:13:46,670
XE and we'll use<font color="#CCCCCC"> that as</font><font color="#E5E5E5"> the template</font><font color="#CCCCCC"> so</font>

387
00:13:44,209 --> 00:13:50,239
that's what I tried and it<font color="#CCCCCC"> failed right</font>

388
00:13:46,670 --> 00:13:51,349
so this failure<font color="#CCCCCC"> I tried to use you don't</font>

389
00:13:50,240 --> 00:13:52,879
have my own lead speak here but

390
00:13:51,350 --> 00:13:55,279
notepad.exe

391
00:13:52,879 --> 00:13:57,829
a true legit Windows application

392
00:13:55,279 --> 00:13:59,540
<font color="#E5E5E5">probably you know sign it on up</font><font color="#CCCCCC"> and I</font>

393
00:13:57,829 --> 00:14:01,399
try to<font color="#E5E5E5"> use that as a template my payload</font>

394
00:13:59,540 --> 00:14:03,469
came out and I dropped it<font color="#E5E5E5"> and who risked</font>

395
00:14:01,399 --> 00:14:05,540
it caught this one<font color="#E5E5E5"> so wasn't signature</font>

396
00:14:03,470 --> 00:14:07,610
they didn't have a signature for<font color="#CCCCCC"> it</font>

397
00:14:05,540 --> 00:14:09,290
but it was basically<font color="#E5E5E5"> saying hey I've</font>

398
00:14:07,610 --> 00:14:11,389
already saw something<font color="#CCCCCC"> very similar to</font>

399
00:14:09,290 --> 00:14:13,339
<font color="#CCCCCC">this</font><font color="#E5E5E5"> you're probably also malicious in</font>

400
00:14:11,389 --> 00:14:14,779
nature so I'm going to flag you now I

401
00:14:13,339 --> 00:14:17,120
don't<font color="#E5E5E5"> have the slide here but there's a</font>

402
00:14:14,779 --> 00:14:20,569
video up<font color="#CCCCCC"> online if you take a</font>

403
00:14:17,120 --> 00:14:23,750
<font color="#E5E5E5">third-party</font><font color="#CCCCCC"> XE</font><font color="#E5E5E5"> so I tried</font><font color="#CCCCCC"> SVD in plink</font>

404
00:14:20,569 --> 00:14:25,819
dot exe<font color="#E5E5E5"> they will work they will get you</font>

405
00:14:23,750 --> 00:14:29,059
around<font color="#E5E5E5"> the signature</font><font color="#CCCCCC"> in</font><font color="#E5E5E5"> heuristics right</font>

406
00:14:25,819 --> 00:14:30,740
so<font color="#E5E5E5"> using I think</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> use pink dot exe as</font>

407
00:14:29,059 --> 00:14:32,300
my template<font color="#CCCCCC"> and then I</font><font color="#E5E5E5"> generated that</font>

408
00:14:30,740 --> 00:14:33,769
out of the framework and then<font color="#CCCCCC"> dumped</font>

409
00:14:32,300 --> 00:14:35,540
<font color="#E5E5E5">that</font><font color="#CCCCCC"> onto the client it got around</font><font color="#E5E5E5"> the</font>

410
00:14:33,769 --> 00:14:38,689
signature<font color="#CCCCCC"> in</font><font color="#E5E5E5"> the heuristics but as soon</font>

411
00:14:35,540 --> 00:14:41,899
as I fired it off the firewall caught me

412
00:14:38,689 --> 00:14:44,180
for suspicious are non-standard and not

413
00:14:41,899 --> 00:14:45,620
approved network traffic<font color="#E5E5E5"> but just in</font>

414
00:14:44,180 --> 00:14:47,809
this case let's just<font color="#E5E5E5"> say I try to do it</font>

415
00:14:45,620 --> 00:14:50,660
to notepad<font color="#CCCCCC"> and I didn't get</font><font color="#E5E5E5"> around</font><font color="#CCCCCC"> I got</font>

416
00:14:47,809 --> 00:14:52,339
heuristics<font color="#E5E5E5"> come on</font><font color="#CCCCCC"> to this</font><font color="#E5E5E5"> video for</font>

417
00:14:50,660 --> 00:14:54,079
that<font color="#E5E5E5"> so then that brought me to Vale</font>

418
00:14:52,339 --> 00:14:56,389
<font color="#CCCCCC">right is it is anybody familiar with</font><font color="#E5E5E5"> the</font>

419
00:14:54,079 --> 00:14:59,750
<font color="#CCCCCC">Vale framework</font><font color="#E5E5E5"> I'm in right there</font>

420
00:14:56,389 --> 00:15:01,069
<font color="#E5E5E5">public guys are cool</font><font color="#CCCCCC"> Vale framework and</font>

421
00:14:59,750 --> 00:15:02,540
everything I'm talking<font color="#CCCCCC"> about here I</font>

422
00:15:01,069 --> 00:15:04,519
<font color="#E5E5E5">definitely recommend checking out this</font>

423
00:15:02,540 --> 00:15:07,490
is fantastic<font color="#E5E5E5"> stuff</font><font color="#CCCCCC"> especially in our</font>

424
00:15:04,519 --> 00:15:09,559
line<font color="#CCCCCC"> of work or trying</font><font color="#E5E5E5"> to do these</font>

425
00:15:07,490 --> 00:15:11,839
during penetration<font color="#CCCCCC"> reading engagements</font>

426
00:15:09,559 --> 00:15:13,759
<font color="#CCCCCC">so the Vale framework 3.0</font><font color="#E5E5E5"> the most</font>

427
00:15:11,839 --> 00:15:15,949
recent one<font color="#E5E5E5"> is a Python framework which</font>

428
00:15:13,759 --> 00:15:18,079
will allow you to<font color="#E5E5E5"> generate a variety</font><font color="#CCCCCC"> of</font>

429
00:15:15,949 --> 00:15:19,699
<font color="#E5E5E5">executable files that at the heart</font><font color="#CCCCCC"> of</font>

430
00:15:18,079 --> 00:15:21,888
them will get around signature and kind

431
00:15:19,699 --> 00:15:23,449
<font color="#E5E5E5">of heuristic AV detection they have a</font>

432
00:15:21,889 --> 00:15:25,220
lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> intelligence pumped into in</font>

433
00:15:23,449 --> 00:15:27,920
different algorithms that will kind<font color="#E5E5E5"> of</font>

434
00:15:25,220 --> 00:15:29,449
generate these X's that<font color="#CCCCCC"> are unique each</font>

435
00:15:27,920 --> 00:15:29,810
time they do there's not a lot<font color="#CCCCCC"> of you</font>

436
00:15:29,449 --> 00:15:32,060
know

437
00:15:29,810 --> 00:15:33,529
pediments between them<font color="#E5E5E5"> so the two</font>

438
00:15:32,060 --> 00:15:35,959
<font color="#CCCCCC">modules that we look at</font><font color="#E5E5E5"> our veil evasion</font>

439
00:15:33,529 --> 00:15:37,249
<font color="#E5E5E5">and</font><font color="#CCCCCC"> veil ordinance so evasion is going</font>

440
00:15:35,959 --> 00:15:39,410
to be that module that<font color="#CCCCCC"> allows us</font><font color="#E5E5E5"> to</font>

441
00:15:37,249 --> 00:15:41,209
<font color="#CCCCCC">build the executable file um and then</font>

442
00:15:39,410 --> 00:15:44,089
<font color="#CCCCCC">ordnance is what we use</font><font color="#E5E5E5"> to generate our</font>

443
00:15:41,209 --> 00:15:45,800
<font color="#E5E5E5">shellcode right</font><font color="#CCCCCC"> so couple of sources</font>

444
00:15:44,089 --> 00:15:48,259
there the github the<font color="#CCCCCC"> veil framework comm</font>

445
00:15:45,800 --> 00:15:50,479
definitely check that out<font color="#E5E5E5"> so a couple of</font>

446
00:15:48,259 --> 00:15:52,309
things<font color="#E5E5E5"> happened here the first one I</font>

447
00:15:50,480 --> 00:15:55,009
generated was a python-based actually

448
00:15:52,309 --> 00:15:56,870
<font color="#E5E5E5">out of veil right so</font><font color="#CCCCCC"> say python with the</font>

449
00:15:55,009 --> 00:16:00,920
reverse<font color="#E5E5E5"> https payload as soon as that</font>

450
00:15:56,870 --> 00:16:02,600
<font color="#CCCCCC">hit-the hit-the</font><font color="#E5E5E5"> client</font><font color="#CCCCCC"> i scanned it and</font>

451
00:16:00,920 --> 00:16:04,670
a past signature<font color="#CCCCCC"> in</font><font color="#E5E5E5"> heuristics</font><font color="#CCCCCC"> alright</font>

452
00:16:02,600 --> 00:16:06,829
so the<font color="#E5E5E5"> first hurdle was good but then</font>

453
00:16:04,670 --> 00:16:09,229
when I fired it<font color="#E5E5E5"> off</font><font color="#CCCCCC"> I got flagged and</font>

454
00:16:06,829 --> 00:16:11,329
here our<font color="#E5E5E5"> flag is the sonar</font><font color="#CCCCCC"> all right so</font>

455
00:16:09,230 --> 00:16:12,709
this behavior type of detection<font color="#CCCCCC"> and it</font>

456
00:16:11,329 --> 00:16:13,998
says you<font color="#E5E5E5"> know this is behaving</font>

457
00:16:12,709 --> 00:16:15,739
suspiciously<font color="#E5E5E5"> you won't come out</font><font color="#CCCCCC"> right</font>

458
00:16:13,999 --> 00:16:17,930
<font color="#E5E5E5">and say hey that's a virus but it's like</font>

459
00:16:15,740 --> 00:16:20,930
<font color="#E5E5E5">something's definitely weird here and</font>

460
00:16:17,930 --> 00:16:23,479
what happened was when you're building a

461
00:16:20,930 --> 00:16:24,888
<font color="#E5E5E5">Python executable out of veil it has a</font>

462
00:16:23,480 --> 00:16:27,860
couple<font color="#CCCCCC"> of options to how you compile</font>

463
00:16:24,889 --> 00:16:29,329
that<font color="#CCCCCC"> python code to annex</font><font color="#E5E5E5"> e and by</font>

464
00:16:27,860 --> 00:16:32,329
default it uses something called<font color="#CCCCCC"> pi</font>

465
00:16:29,329 --> 00:16:34,459
installer so when you build<font color="#E5E5E5"> that</font>

466
00:16:32,329 --> 00:16:35,930
executable of<font color="#CCCCCC"> PI installer</font><font color="#E5E5E5"> and then you</font>

467
00:16:34,459 --> 00:16:38,239
<font color="#E5E5E5">bring it over</font><font color="#CCCCCC"> and when I fired it up</font>

468
00:16:35,930 --> 00:16:41,089
what it does is it dumps a lot of

469
00:16:38,240 --> 00:16:43,399
content into<font color="#E5E5E5"> local temp and hopefully</font>

470
00:16:41,089 --> 00:16:45,290
you guys can<font color="#E5E5E5"> see</font><font color="#CCCCCC"> that these are</font><font color="#E5E5E5"> folders</font>

471
00:16:43,399 --> 00:16:48,259
and files<font color="#E5E5E5"> that the</font><font color="#CCCCCC"> program's creating</font>

472
00:16:45,290 --> 00:16:50,420
<font color="#CCCCCC">meal prior to execution</font><font color="#E5E5E5"> in local F they</font>

473
00:16:48,259 --> 00:16:53,300
are means yet update a local town and

474
00:16:50,420 --> 00:16:55,209
the AV was like this<font color="#E5E5E5"> is odd and</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font>

475
00:16:53,300 --> 00:16:57,949
what really flag them on the sonar was

476
00:16:55,209 --> 00:16:59,869
why are you writing and why you you know

477
00:16:57,949 --> 00:17:02,599
dumping stuff to local temp so that

478
00:16:59,870 --> 00:17:05,289
wasn't<font color="#E5E5E5"> an</font><font color="#CCCCCC"> option</font><font color="#E5E5E5"> so then I generated a</font>

479
00:17:02,600 --> 00:17:08,089
c-sharp payload coming out of that

480
00:17:05,289 --> 00:17:11,148
<font color="#CCCCCC">c-sharp payloads are compiled with wine</font>

481
00:17:08,089 --> 00:17:13,158
<font color="#CCCCCC">and I think CLP or something like that I</font>

482
00:17:11,148 --> 00:17:14,958
know they<font color="#E5E5E5"> combined with some software</font>

483
00:17:13,159 --> 00:17:16,970
<font color="#E5E5E5">within wine so it doesn't leverage that</font>

484
00:17:14,959 --> 00:17:19,280
<font color="#CCCCCC">PI installer</font><font color="#E5E5E5"> so I could get around that</font>

485
00:17:16,970 --> 00:17:21,110
<font color="#E5E5E5">dumping pad temp so I got around</font>

486
00:17:19,280 --> 00:17:23,389
heuristics and I got around signature

487
00:17:21,109 --> 00:17:26,510
and I got around the behaviors but when

488
00:17:23,390 --> 00:17:27,679
I<font color="#CCCCCC"> went to execute it</font><font color="#E5E5E5"> that's when the</font><font color="#CCCCCC"> the</font>

489
00:17:26,510 --> 00:17:29,030
firewall caught me and<font color="#E5E5E5"> what does</font><font color="#CCCCCC"> it</font>

490
00:17:27,679 --> 00:17:31,220
<font color="#E5E5E5">saying is how you suspicious network</font>

491
00:17:29,030 --> 00:17:33,830
activity has been detected<font color="#CCCCCC"> now if I'm</font>

492
00:17:31,220 --> 00:17:36,020
<font color="#E5E5E5">Jonny user right at the enterprise and</font>

493
00:17:33,830 --> 00:17:37,639
I'm trying<font color="#E5E5E5"> to run my malicious XE</font>

494
00:17:36,020 --> 00:17:41,059
without them<font color="#E5E5E5"> really noticing anything if</font>

495
00:17:37,640 --> 00:17:42,600
this popped up maybe they'll understand

496
00:17:41,059 --> 00:17:44,668
some<font color="#E5E5E5"> of this stuff here</font>

497
00:17:42,600 --> 00:17:46,799
um they'll probably get<font color="#CCCCCC"> scared</font><font color="#E5E5E5"> looking</font>

498
00:17:44,669 --> 00:17:48,570
<font color="#CCCCCC">at a big exclamation point and</font><font color="#E5E5E5"> some</font>

499
00:17:46,799 --> 00:17:51,210
words<font color="#E5E5E5"> here they really won't have any</font>

500
00:17:48,570 --> 00:17:53,580
<font color="#CCCCCC">idea what this is you know</font><font color="#E5E5E5"> network</font>

501
00:17:51,210 --> 00:17:55,919
traffic<font color="#E5E5E5"> what you see here the call was I</font>

502
00:17:53,580 --> 00:17:58,168
was calling back<font color="#E5E5E5"> on port 443 so all my</font>

503
00:17:55,919 --> 00:17:59,910
handlers receive on 443 in case there's

504
00:17:58,169 --> 00:18:02,160
like<font color="#CCCCCC"> any host</font><font color="#E5E5E5"> base kind of firewall that</font>

505
00:17:59,910 --> 00:18:04,500
limits<font color="#E5E5E5"> traffic outbound</font><font color="#CCCCCC"> four</font><font color="#E5E5E5"> four three</font>

506
00:18:02,160 --> 00:18:06,960
<font color="#CCCCCC">I</font><font color="#E5E5E5"> found is usually allowed but if you</font>

507
00:18:04,500 --> 00:18:08,580
look<font color="#E5E5E5"> down here</font><font color="#CCCCCC"> the default</font><font color="#E5E5E5"> action is to</font>

508
00:18:06,960 --> 00:18:10,200
block it<font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so right off the bat</font>

509
00:18:08,580 --> 00:18:11,399
<font color="#E5E5E5">it's going to stop it</font><font color="#CCCCCC"> and there's only</font>

510
00:18:10,200 --> 00:18:15,539
<font color="#CCCCCC">like an OK button</font>

511
00:18:11,400 --> 00:18:17,700
so you I'm<font color="#E5E5E5"> my feeling is maybe you guys</font>

512
00:18:15,539 --> 00:18:18,960
<font color="#E5E5E5">have</font><font color="#CCCCCC"> different opinion but if I was</font><font color="#E5E5E5"> the</font>

513
00:18:17,700 --> 00:18:20,130
user more<font color="#E5E5E5"> than likely</font><font color="#CCCCCC"> they're going</font><font color="#E5E5E5"> to</font>

514
00:18:18,960 --> 00:18:22,230
<font color="#E5E5E5">hit</font><font color="#CCCCCC"> ok and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> is gonna get stopped</font>

515
00:18:20,130 --> 00:18:24,720
right so this<font color="#E5E5E5"> is where we get into the</font>

516
00:18:22,230 --> 00:18:25,950
problem of hey I<font color="#E5E5E5"> gotta run signature you</font>

517
00:18:24,720 --> 00:18:27,929
don't flag me<font color="#CCCCCC"> you don't think I'm</font>

518
00:18:25,950 --> 00:18:29,520
suspicious that's all good now I got to

519
00:18:27,929 --> 00:18:31,289
use<font color="#E5E5E5"> the wire to make my call back and</font>

520
00:18:29,520 --> 00:18:32,370
you don't trust me so that's<font color="#E5E5E5"> when</font><font color="#CCCCCC"> we</font>

521
00:18:31,289 --> 00:18:33,539
<font color="#E5E5E5">start looking at application</font>

522
00:18:32,370 --> 00:18:35,668
whitelisting and the<font color="#E5E5E5"> firewall is</font>

523
00:18:33,539 --> 00:18:39,750
actually controlling what programs can

524
00:18:35,669 --> 00:18:42,780
hit the network<font color="#E5E5E5"> and hit the wire so</font>

525
00:18:39,750 --> 00:18:44,520
that's what got<font color="#CCCCCC"> me</font><font color="#E5E5E5"> thinking</font><font color="#CCCCCC"> I can't use</font>

526
00:18:42,780 --> 00:18:46,049
a<font color="#E5E5E5"> framework right so now I started</font>

527
00:18:44,520 --> 00:18:49,440
thinking I'm going<font color="#E5E5E5"> to</font><font color="#CCCCCC"> have to build my</font>

528
00:18:46,049 --> 00:18:50,940
own you<font color="#E5E5E5"> know executable here but even if</font>

529
00:18:49,440 --> 00:18:52,679
I wrote an executable<font color="#E5E5E5"> I'm still going to</font>

530
00:18:50,940 --> 00:18:55,049
<font color="#E5E5E5">be in the same boat</font><font color="#CCCCCC"> that I was</font><font color="#E5E5E5"> coming</font>

531
00:18:52,679 --> 00:18:56,820
out of<font color="#CCCCCC"> veil right my executable won't be</font>

532
00:18:55,049 --> 00:18:59,010
trusted<font color="#E5E5E5"> and as soon as I hit the network</font>

533
00:18:56,820 --> 00:19:00,750
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> going to flag it so that's when I</font>

534
00:18:59,010 --> 00:19:02,490
started<font color="#CCCCCC"> thinking of injection</font><font color="#E5E5E5"> right</font>

535
00:19:00,750 --> 00:19:04,289
<font color="#E5E5E5">injection in</font><font color="#CCCCCC"> the sense where I'm going</font>

536
00:19:02,490 --> 00:19:07,049
to take my<font color="#CCCCCC"> shellcode which is my reverse</font>

537
00:19:04,289 --> 00:19:09,270
<font color="#CCCCCC">HTTPS</font><font color="#E5E5E5"> I'm going to inject that into a</font>

538
00:19:07,049 --> 00:19:11,370
remote process and then that remote

539
00:19:09,270 --> 00:19:14,400
process will execute my payload back to

540
00:19:11,370 --> 00:19:15,899
my handle<font color="#E5E5E5"> I'll pick a process or I'll</font>

541
00:19:14,400 --> 00:19:18,720
pick a piece of software that's<font color="#E5E5E5"> trusted</font>

542
00:19:15,900 --> 00:19:21,270
<font color="#E5E5E5">right something that can use the wire so</font>

543
00:19:18,720 --> 00:19:23,340
I'll start it off inject my code into it

544
00:19:21,270 --> 00:19:26,129
<font color="#E5E5E5">then it will run and I'll be able to get</font>

545
00:19:23,340 --> 00:19:28,199
my<font color="#E5E5E5"> my payload out so I was like ok</font><font color="#CCCCCC"> so</font>

546
00:19:26,130 --> 00:19:31,679
there's a book<font color="#E5E5E5"> called</font><font color="#CCCCCC"> gray hat Python by</font>

547
00:19:28,200 --> 00:19:32,940
<font color="#E5E5E5">Jason seats I believe and he</font><font color="#CCCCCC"> has a</font><font color="#E5E5E5"> it's</font>

548
00:19:31,679 --> 00:19:34,740
<font color="#E5E5E5">a fantastic book</font><font color="#CCCCCC"> and he has a whole</font>

549
00:19:32,940 --> 00:19:35,940
<font color="#CCCCCC">chapter dedicated of</font><font color="#E5E5E5"> how to do this in</font>

550
00:19:34,740 --> 00:19:37,770
Python<font color="#CCCCCC"> so I was writing</font><font color="#E5E5E5"> some Python</font>

551
00:19:35,940 --> 00:19:41,220
based on that and I thought to myself

552
00:19:37,770 --> 00:19:43,470
<font color="#E5E5E5">well even if I'm</font><font color="#CCCCCC"> able to inject it</font><font color="#E5E5E5"> and</font>

553
00:19:41,220 --> 00:19:44,760
it pops<font color="#E5E5E5"> off that's all</font><font color="#CCCCCC"> good but it won't</font>

554
00:19:43,470 --> 00:19:46,860
<font color="#E5E5E5">get me around that sonar detection</font>

555
00:19:44,760 --> 00:19:48,150
because<font color="#E5E5E5"> by the end</font><font color="#CCCCCC"> of the day no matter</font>

556
00:19:46,860 --> 00:19:49,918
<font color="#CCCCCC">what I write</font><font color="#E5E5E5"> in Python am I going to</font>

557
00:19:48,150 --> 00:19:52,020
have<font color="#E5E5E5"> to build with PI installer so I'll</font>

558
00:19:49,919 --> 00:19:55,020
fall<font color="#CCCCCC"> right into</font><font color="#E5E5E5"> that trap of writing to</font>

559
00:19:52,020 --> 00:19:57,918
<font color="#CCCCCC">AppData local so that's what got me</font><font color="#E5E5E5"> into</font>

560
00:19:55,020 --> 00:19:57,918
<font color="#E5E5E5">C sharp</font>

561
00:19:59,380 --> 00:20:05,180
that's a<font color="#E5E5E5"> fantastic question</font>

562
00:20:01,370 --> 00:20:07,729
so<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> Windows 10 I was looking around</font>

563
00:20:05,180 --> 00:20:10,010
and I'm<font color="#CCCCCC"> like 64-bit systems I need a</font>

564
00:20:07,730 --> 00:20:11,810
<font color="#E5E5E5">32-bit and I came across onedrive you</font>

565
00:20:10,010 --> 00:20:14,300
<font color="#CCCCCC">guys familiar with onedrive it's like</font>

566
00:20:11,810 --> 00:20:16,340
the<font color="#E5E5E5"> Windows cloud thing that's what I</font>

567
00:20:14,300 --> 00:20:19,850
used because it was<font color="#E5E5E5"> already trusted can</font>

568
00:20:16,340 --> 00:20:22,100
use the wire<font color="#E5E5E5"> and we'll see in the video</font>

569
00:20:19,850 --> 00:20:24,379
when it pops up<font color="#E5E5E5"> it kind</font><font color="#CCCCCC"> of seems like</font>

570
00:20:22,100 --> 00:20:25,969
it's<font color="#E5E5E5"> not really malicious</font><font color="#CCCCCC"> like you don't</font>

571
00:20:24,380 --> 00:20:27,170
need<font color="#E5E5E5"> them you</font><font color="#CCCCCC"> see a</font><font color="#E5E5E5"> little flash with</font>

572
00:20:25,970 --> 00:20:28,490
command proper<font color="#E5E5E5"> then you see onedrive</font>

573
00:20:27,170 --> 00:20:30,980
come up and<font color="#E5E5E5"> you're like oh maybe that's</font>

574
00:20:28,490 --> 00:20:33,680
some automatic<font color="#E5E5E5"> or things but we use</font>

575
00:20:30,980 --> 00:20:36,350
onedrive for the injection<font color="#E5E5E5"> here and then</font>

576
00:20:33,680 --> 00:20:39,740
we<font color="#E5E5E5"> use Google Chrome for the back door</font>

577
00:20:36,350 --> 00:20:42,230
<font color="#E5E5E5">backdoor</font><font color="#CCCCCC"> DLL stuff right</font><font color="#E5E5E5"> so great</font>

578
00:20:39,740 --> 00:20:44,030
<font color="#E5E5E5">question</font><font color="#CCCCCC"> I don't have it here and</font>

579
00:20:42,230 --> 00:20:45,740
hopefully<font color="#E5E5E5"> I show</font><font color="#CCCCCC"> up maybe I show in the</font>

580
00:20:44,030 --> 00:20:48,200
videos<font color="#CCCCCC"> I go through the</font><font color="#E5E5E5"> list of what's</font>

581
00:20:45,740 --> 00:20:49,520
<font color="#E5E5E5">allowed in what we can inject into</font><font color="#CCCCCC"> the</font>

582
00:20:48,200 --> 00:20:52,610
other thing<font color="#E5E5E5"> about onedrive</font><font color="#CCCCCC"> which was</font>

583
00:20:49,520 --> 00:20:55,340
<font color="#E5E5E5">awesome is the executable path is</font>

584
00:20:52,610 --> 00:20:57,949
actually<font color="#CCCCCC"> in</font><font color="#E5E5E5"> my own</font><font color="#CCCCCC"> kind</font><font color="#E5E5E5"> of user profile</font>

585
00:20:55,340 --> 00:21:00,679
directory things like<font color="#E5E5E5"> see users this is</font>

586
00:20:57,950 --> 00:21:02,930
<font color="#CCCCCC">spider-man pee Parker slash</font><font color="#E5E5E5"> something so</font>

587
00:21:00,680 --> 00:21:04,910
it is an in Program Files<font color="#CCCCCC"> so I didn't</font>

588
00:21:02,930 --> 00:21:06,230
know when I launched it I really have

589
00:21:04,910 --> 00:21:07,910
full<font color="#E5E5E5"> rights over it so I can do the</font>

590
00:21:06,230 --> 00:21:09,320
injection I run<font color="#E5E5E5"> it I run into like</font>

591
00:21:07,910 --> 00:21:12,140
<font color="#E5E5E5">administrators kind of privileges stuff</font>

592
00:21:09,320 --> 00:21:14,629
so I was<font color="#E5E5E5"> like how do I do this in</font>

593
00:21:12,140 --> 00:21:16,760
c-sharp<font color="#E5E5E5"> and if I could do it in c-sharp</font>

594
00:21:14,630 --> 00:21:19,340
<font color="#CCCCCC">as direct calls</font><font color="#E5E5E5"> over those API calls</font><font color="#CCCCCC"> and</font>

595
00:21:16,760 --> 00:21:21,500
<font color="#E5E5E5">I went around the internet and this is</font>

596
00:21:19,340 --> 00:21:24,409
<font color="#E5E5E5">where I found it this do names are trick</font>

597
00:21:21,500 --> 00:21:26,030
<font color="#E5E5E5">on this world of</font><font color="#CCCCCC"> warcraft' form I have</font>

598
00:21:24,410 --> 00:21:27,830
<font color="#CCCCCC">no idea what I was doing there but if</font>

599
00:21:26,030 --> 00:21:31,010
you<font color="#E5E5E5"> look at the last part it's it's C</font>

600
00:21:27,830 --> 00:21:33,830
<font color="#E5E5E5">ASM injection so he gets into how to</font>

601
00:21:31,010 --> 00:21:37,010
write a c-sharp program and inject your

602
00:21:33,830 --> 00:21:40,610
<font color="#CCCCCC">shellcode</font><font color="#E5E5E5"> into</font><font color="#CCCCCC"> a remote process so we</font>

603
00:21:37,010 --> 00:21:43,640
try that and<font color="#E5E5E5"> then boom I get hit so</font><font color="#CCCCCC"> I</font>

604
00:21:40,610 --> 00:21:48,350
generated it and then I named it dumb

605
00:21:43,640 --> 00:21:50,960
name<font color="#E5E5E5"> dumb slash dumb</font><font color="#CCCCCC"> -</font><font color="#E5E5E5"> named exe and I</font>

606
00:21:48,350 --> 00:21:53,570
get hit<font color="#E5E5E5"> with this sonar heuristics 158</font>

607
00:21:50,960 --> 00:21:55,700
and if you look at that it's saying hey

608
00:21:53,570 --> 00:21:57,290
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> just suspicious because it</font>

609
00:21:55,700 --> 00:21:59,630
attempted to<font color="#E5E5E5"> start a remote thread in a</font>

610
00:21:57,290 --> 00:22:01,610
process address space<font color="#CCCCCC"> so literally it</font>

611
00:21:59,630 --> 00:22:03,320
was<font color="#E5E5E5"> flagging on my injection</font><font color="#CCCCCC"> I was</font>

612
00:22:01,610 --> 00:22:05,240
trying to start<font color="#CCCCCC"> that process and inject</font>

613
00:22:03,320 --> 00:22:07,290
<font color="#E5E5E5">into it and the AV is like no I don't</font>

614
00:22:05,240 --> 00:22:09,450
<font color="#CCCCCC">think</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> so I was like</font>

615
00:22:07,290 --> 00:22:11,670
this really<font color="#CCCCCC"> got me mad</font><font color="#E5E5E5"> and this was like</font>

616
00:22:09,450 --> 00:22:12,360
<font color="#CCCCCC">around April and I'm like man</font><font color="#E5E5E5"> I'm run</font>

617
00:22:11,670 --> 00:22:14,190
out of time

618
00:22:12,360 --> 00:22:16,439
<font color="#E5E5E5">I got like</font><font color="#CCCCCC"> it is</font><font color="#E5E5E5"> get up there and so all</font>

619
00:22:14,190 --> 00:22:18,330
these<font color="#CCCCCC"> people it's like to work</font><font color="#E5E5E5"> and then</font>

620
00:22:16,440 --> 00:22:20,790
for some reason<font color="#E5E5E5"> I just changed the name</font>

621
00:22:18,330 --> 00:22:22,050
<font color="#E5E5E5">and I change it</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> to straight Malan</font>

622
00:22:20,790 --> 00:22:24,180
<font color="#CCCCCC">Jeff and you'll see in</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> video I just</font>

623
00:22:22,050 --> 00:22:25,800
modify the<font color="#E5E5E5"> name I take the</font><font color="#CCCCCC"> - al</font><font color="#E5E5E5"> and that</font>

624
00:22:24,180 --> 00:22:27,420
got her on the<font color="#E5E5E5"> sonar for some reason it</font>

625
00:22:25,800 --> 00:22:29,100
didn't put it through the<font color="#CCCCCC"> behavior or</font>

626
00:22:27,420 --> 00:22:30,810
whatever and I did some testing<font color="#E5E5E5"> on it</font>

627
00:22:29,100 --> 00:22:32,939
<font color="#E5E5E5">and let's say you know you're</font><font color="#CCCCCC"> running</font>

628
00:22:30,810 --> 00:22:34,770
your malware and you generate an<font color="#E5E5E5"> XE with</font>

629
00:22:32,940 --> 00:22:36,960
some like absurd number<font color="#CCCCCC"> of characters</font>

630
00:22:34,770 --> 00:22:38,340
and they're all funky and<font color="#E5E5E5"> it's lagged on</font>

631
00:22:36,960 --> 00:22:39,540
that and<font color="#E5E5E5"> it flagged in the ice</font><font color="#CCCCCC"> and so I</font>

632
00:22:38,340 --> 00:22:42,120
don't<font color="#CCCCCC"> think it like special characters</font>

633
00:22:39,540 --> 00:22:44,190
so when it was all<font color="#E5E5E5"> lowercase alpha and</font>

634
00:22:42,120 --> 00:22:47,429
it seems reasonable<font color="#E5E5E5"> in length</font><font color="#CCCCCC"> I didn't</font>

635
00:22:44,190 --> 00:22:49,650
have a problem<font color="#CCCCCC"> so it's</font><font color="#E5E5E5"> definitely weird</font>

636
00:22:47,430 --> 00:22:52,050
<font color="#E5E5E5">right and I'm it's in the video too</font><font color="#CCCCCC"> so</font>

637
00:22:49,650 --> 00:22:54,600
we'll take<font color="#E5E5E5"> a look at that um so this is</font>

638
00:22:52,050 --> 00:22:56,850
<font color="#CCCCCC">it</font><font color="#E5E5E5"> right so I I got</font><font color="#CCCCCC"> a round signature I</font>

639
00:22:54,600 --> 00:22:58,800
got around her<font color="#CCCCCC"> wrist heuristics I got</font>

640
00:22:56,850 --> 00:23:01,110
<font color="#CCCCCC">around behavior right</font><font color="#E5E5E5"> - sonar kind of</font>

641
00:22:58,800 --> 00:23:03,210
stuff<font color="#CCCCCC"> I got around</font><font color="#E5E5E5"> the firewall alert by</font>

642
00:23:01,110 --> 00:23:05,010
injecting into<font color="#CCCCCC"> a trusted application and</font>

643
00:23:03,210 --> 00:23:07,350
then boom I get<font color="#E5E5E5"> hit</font><font color="#CCCCCC"> again and I'm</font><font color="#E5E5E5"> like</font>

644
00:23:05,010 --> 00:23:09,629
you<font color="#E5E5E5"> know pulling out my</font><font color="#CCCCCC"> hair like what's</font>

645
00:23:07,350 --> 00:23:11,550
the problem here and it's an IPS alert

646
00:23:09,630 --> 00:23:14,340
and it's saying hey<font color="#E5E5E5"> I detected a</font>

647
00:23:11,550 --> 00:23:16,020
meterpreter reverse<font color="#CCCCCC"> https payload which</font>

648
00:23:14,340 --> 00:23:17,939
got me thinking I'm<font color="#E5E5E5"> like I thought this</font>

649
00:23:16,020 --> 00:23:21,690
<font color="#CCCCCC">is</font><font color="#E5E5E5"> over SSL I thought this was a tunnel</font>

650
00:23:17,940 --> 00:23:22,890
<font color="#E5E5E5">happen the IPS see it I knew I was in</font>

651
00:23:21,690 --> 00:23:24,240
the right<font color="#E5E5E5"> direction because when you</font>

652
00:23:22,890 --> 00:23:25,890
scroll<font color="#E5E5E5"> down it's</font><font color="#CCCCCC"> like hey where did</font><font color="#E5E5E5"> this</font>

653
00:23:24,240 --> 00:23:28,500
attack<font color="#E5E5E5"> come from you see that it comes</font>

654
00:23:25,890 --> 00:23:31,230
from<font color="#CCCCCC"> one</font><font color="#E5E5E5"> drive right and I was like I</font>

655
00:23:28,500 --> 00:23:33,630
know I'm there right<font color="#CCCCCC"> so</font><font color="#E5E5E5"> we're injecting</font>

656
00:23:31,230 --> 00:23:36,090
but I'm hitting<font color="#CCCCCC"> this I'm like something</font>

657
00:23:33,630 --> 00:23:37,830
what's the deal<font color="#E5E5E5"> here so</font><font color="#CCCCCC"> there's a video</font>

658
00:23:36,090 --> 00:23:39,990
<font color="#CCCCCC">of that</font><font color="#E5E5E5"> and that's the first one that</font>

659
00:23:37,830 --> 00:23:41,639
<font color="#E5E5E5">we'll take</font><font color="#CCCCCC"> a look at in a second but so</font>

660
00:23:39,990 --> 00:23:44,630
I did some digging<font color="#CCCCCC"> and I</font><font color="#E5E5E5"> came across</font>

661
00:23:41,640 --> 00:23:47,280
this post by Carlos Perez<font color="#CCCCCC"> and</font>

662
00:23:44,630 --> 00:23:49,470
interpreter<font color="#E5E5E5"> SSL certificate validation</font>

663
00:23:47,280 --> 00:23:52,110
and really what that<font color="#E5E5E5"> thing that IPS</font>

664
00:23:49,470 --> 00:23:53,520
signature was alerting on was my my

665
00:23:52,110 --> 00:23:56,129
handler certificate coming out of the

666
00:23:53,520 --> 00:23:57,840
framework right so it was<font color="#E5E5E5"> kind of the</font>

667
00:23:56,130 --> 00:23:59,640
default SSL cert that<font color="#CCCCCC"> Metasploit is</font>

668
00:23:57,840 --> 00:24:00,360
going to use it's<font color="#E5E5E5"> all that coming across</font>

669
00:23:59,640 --> 00:24:01,830
the wire

670
00:24:00,360 --> 00:24:03,389
there must be an<font color="#CCCCCC"> attribute</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> that</font>

671
00:24:01,830 --> 00:24:04,889
certificate<font color="#E5E5E5"> that it looks for maybe some</font>

672
00:24:03,390 --> 00:24:07,290
R and like you know string or something

673
00:24:04,890 --> 00:24:09,210
<font color="#CCCCCC">like that</font><font color="#E5E5E5"> and it flagged on that so what</font>

674
00:24:07,290 --> 00:24:11,639
I found was<font color="#E5E5E5"> leveraging this and</font>

675
00:24:09,210 --> 00:24:14,490
leveraging this module in<font color="#CCCCCC"> Metasploit</font>

676
00:24:11,640 --> 00:24:16,470
<font color="#E5E5E5">impersonate SSL</font><font color="#CCCCCC"> and what it does is it</font>

677
00:24:14,490 --> 00:24:18,200
<font color="#E5E5E5">makes a self signed copy of a legitimate</font>

678
00:24:16,470 --> 00:24:20,120
<font color="#E5E5E5">you know</font><font color="#CCCCCC"> shirt</font>

679
00:24:18,200 --> 00:24:21,890
take the<font color="#CCCCCC"> information from</font><font color="#E5E5E5"> that so this</font>

680
00:24:20,120 --> 00:24:23,810
<font color="#E5E5E5">will give</font><font color="#CCCCCC"> me that unique certificate</font>

681
00:24:21,890 --> 00:24:26,300
<font color="#E5E5E5">that I needed to get around this IPS</font>

682
00:24:23,810 --> 00:24:28,100
alert<font color="#E5E5E5"> so without</font><font color="#CCCCCC"> even</font><font color="#E5E5E5"> changing the</font>

683
00:24:26,300 --> 00:24:30,110
binary itself once I did the<font color="#E5E5E5"> first build</font>

684
00:24:28,100 --> 00:24:32,750
<font color="#E5E5E5">I was all good</font><font color="#CCCCCC"> I just had to change</font><font color="#E5E5E5"> some</font>

685
00:24:30,110 --> 00:24:35,600
<font color="#CCCCCC">settings in</font><font color="#E5E5E5"> the handler</font><font color="#CCCCCC"> and then</font><font color="#E5E5E5"> BOOM</font>

686
00:24:32,750 --> 00:24:36,740
once I did<font color="#CCCCCC"> that</font><font color="#E5E5E5"> I got my shell here so</font>

687
00:24:35,600 --> 00:24:39,080
here we're<font color="#CCCCCC"> running our Handler and</font>

688
00:24:36,740 --> 00:24:41,210
<font color="#E5E5E5">finally I get the</font><font color="#CCCCCC"> callback</font><font color="#E5E5E5"> from Peter</font>

689
00:24:39,080 --> 00:24:42,860
Parker<font color="#E5E5E5"> over at victim 7</font><font color="#CCCCCC"> might I</font><font color="#E5E5E5"> finally</font>

690
00:24:41,210 --> 00:24:45,560
get the call so think about what I had

691
00:24:42,860 --> 00:24:47,000
to do to<font color="#E5E5E5"> get to this point you won't</font>

692
00:24:45,560 --> 00:24:48,919
have to do this for<font color="#E5E5E5"> every piece of</font>

693
00:24:47,000 --> 00:24:50,540
studio<font color="#E5E5E5"> this isn't a silver bullet this</font>

694
00:24:48,920 --> 00:24:52,190
won't work<font color="#E5E5E5"> for everyone and this won't</font>

695
00:24:50,540 --> 00:24:55,010
<font color="#CCCCCC">work</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> every av product but just this</font>

696
00:24:52,190 --> 00:24:56,660
scenario<font color="#CCCCCC"> I had to do a bunch of stuff</font>

697
00:24:55,010 --> 00:24:58,160
ahead<font color="#E5E5E5"> to write my</font><font color="#CCCCCC"> wealth write my own I</font>

698
00:24:56,660 --> 00:24:59,720
had to leverage some c-sharp that was

699
00:24:58,160 --> 00:25:01,820
out<font color="#E5E5E5"> there</font><font color="#CCCCCC"> I had to do that injection</font>

700
00:24:59,720 --> 00:25:03,410
<font color="#E5E5E5">into a trusted application</font><font color="#CCCCCC"> I needed an</font>

701
00:25:01,820 --> 00:25:05,659
application<font color="#E5E5E5"> that I had full control</font><font color="#CCCCCC"> over</font>

702
00:25:03,410 --> 00:25:07,820
<font color="#E5E5E5">as well as the ability to inject into</font>

703
00:25:05,660 --> 00:25:11,570
and then I had to modify<font color="#E5E5E5"> my</font><font color="#CCCCCC"> ssl</font><font color="#E5E5E5"> handler</font>

704
00:25:07,820 --> 00:25:15,200
<font color="#E5E5E5">so it wasn't</font><font color="#CCCCCC"> really like</font><font color="#E5E5E5"> I wouldn't say</font>

705
00:25:11,570 --> 00:25:17,090
you know it was difficult<font color="#CCCCCC"> um but it</font>

706
00:25:15,200 --> 00:25:18,200
wasn't like<font color="#CCCCCC"> low-hanging fruit right so</font>

707
00:25:17,090 --> 00:25:20,300
this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> where I started to think</font><font color="#E5E5E5"> like</font>

708
00:25:18,200 --> 00:25:22,700
hey you know we always rag on<font color="#E5E5E5"> a Vav</font>

709
00:25:20,300 --> 00:25:24,409
sucks and stuff like that but it does

710
00:25:22,700 --> 00:25:25,730
have it<font color="#CCCCCC"> does have some usefulness</font><font color="#E5E5E5"> in</font>

711
00:25:24,410 --> 00:25:27,380
this context is I had<font color="#E5E5E5"> to do some</font>

712
00:25:25,730 --> 00:25:28,840
<font color="#E5E5E5">additional work</font><font color="#CCCCCC"> to get that right</font><font color="#E5E5E5"> so</font>

713
00:25:27,380 --> 00:25:32,210
let's take a look<font color="#E5E5E5"> at some of them</font><font color="#CCCCCC"> and</font>

714
00:25:28,840 --> 00:25:37,699
<font color="#CCCCCC">again I apologize I was going to do this</font>

715
00:25:32,210 --> 00:25:38,900
live but too much<font color="#CCCCCC"> of a gamble</font><font color="#E5E5E5"> um all</font>

716
00:25:37,700 --> 00:25:40,520
<font color="#E5E5E5">right let's look at the c-sharp</font>

717
00:25:38,900 --> 00:25:43,430
<font color="#CCCCCC">injunction this will show us some</font><font color="#E5E5E5"> of the</font>

718
00:25:40,520 --> 00:25:47,810
code<font color="#CCCCCC"> that we use</font><font color="#E5E5E5"> for this</font><font color="#CCCCCC"> and I get said</font>

719
00:25:43,430 --> 00:25:53,060
all the code and<font color="#CCCCCC"> stuff is on deputy</font>

720
00:25:47,810 --> 00:25:54,740
cocom the block<font color="#CCCCCC"> alright and I apologize</font>

721
00:25:53,060 --> 00:25:56,389
<font color="#CCCCCC">I'm not as good as we're</font><font color="#E5E5E5"> going to get</font>

722
00:25:54,740 --> 00:25:59,840
<font color="#E5E5E5">for the deal</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right so let's fire it</font>

723
00:25:56,390 --> 00:26:03,110
<font color="#E5E5E5">off so again Visual Studio Community</font>

724
00:25:59,840 --> 00:26:06,980
Edition<font color="#E5E5E5"> this is our tricks code right so</font>

725
00:26:03,110 --> 00:26:09,199
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> a c-sharp and similar to what</font>

726
00:26:06,980 --> 00:26:11,360
<font color="#E5E5E5">you'll see like when you generate an</font>

727
00:26:09,200 --> 00:26:13,070
execute a load at a<font color="#CCCCCC"> bail framework</font>

728
00:26:11,360 --> 00:26:15,469
they'll give you the the<font color="#E5E5E5"> Python or the C</font>

729
00:26:13,070 --> 00:26:17,510
sharp as well<font color="#E5E5E5"> but really</font><font color="#CCCCCC"> what we're</font>

730
00:26:15,470 --> 00:26:19,510
doing<font color="#E5E5E5"> here is we're including API calls</font>

731
00:26:17,510 --> 00:26:22,400
<font color="#E5E5E5">to allocate memory and remote process</font>

732
00:26:19,510 --> 00:26:25,670
<font color="#CCCCCC">write our shell code to that remote</font>

733
00:26:22,400 --> 00:26:27,800
process memory<font color="#CCCCCC"> which</font><font color="#E5E5E5"> if I can do double</font>

734
00:26:25,670 --> 00:26:28,920
time<font color="#E5E5E5"> area then we create that remote</font>

735
00:26:27,800 --> 00:26:30,720
thread that's the

736
00:26:28,920 --> 00:26:34,850
<font color="#E5E5E5">that's going to fire off</font><font color="#CCCCCC"> our shell</font><font color="#E5E5E5"> cones</font>

737
00:26:30,720 --> 00:26:38,850
<font color="#CCCCCC">in that remote process he defines some</font>

738
00:26:34,850 --> 00:26:40,770
these are<font color="#E5E5E5"> custom data types and based on</font>

739
00:26:38,850 --> 00:26:42,060
the values I don't really understand

740
00:26:40,770 --> 00:26:43,620
<font color="#CCCCCC">exactly everything</font><font color="#E5E5E5"> he's</font><font color="#CCCCCC"> doing here but</font>

741
00:26:42,060 --> 00:26:45,419
I'm guessing<font color="#E5E5E5"> that it has to handle the</font>

742
00:26:43,620 --> 00:26:47,189
memory allocation<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> the right</font>

743
00:26:45,420 --> 00:26:48,330
permissions on that new kind<font color="#E5E5E5"> of space of</font>

744
00:26:47,190 --> 00:26:54,120
memory that<font color="#E5E5E5"> we've allocated for our</font>

745
00:26:48,330 --> 00:26:56,850
<font color="#E5E5E5">shell go but this is where we come in so</font>

746
00:26:54,120 --> 00:26:58,199
now we have this<font color="#E5E5E5"> byte array that's going</font>

747
00:26:56,850 --> 00:27:01,709
to be our shell code<font color="#E5E5E5"> so this is going to</font>

748
00:26:58,200 --> 00:27:03,750
be our payload so where do we<font color="#E5E5E5"> get that</font>

749
00:27:01,710 --> 00:27:05,400
<font color="#CCCCCC">from we go back</font><font color="#E5E5E5"> over to our</font><font color="#CCCCCC"> cally box</font>

750
00:27:03,750 --> 00:27:06,690
and get it from<font color="#CCCCCC"> Metasploit right so</font>

751
00:27:05,400 --> 00:27:10,560
we're going<font color="#E5E5E5"> to use the</font><font color="#CCCCCC"> meterpreter</font>

752
00:27:06,690 --> 00:27:12,330
<font color="#CCCCCC">reverse HTTP payload standard options</font>

753
00:27:10,560 --> 00:27:14,129
really this is<font color="#E5E5E5"> kind of stuff that you</font>

754
00:27:12,330 --> 00:27:15,419
would do if<font color="#E5E5E5"> you're using Emma's venom</font>

755
00:27:14,130 --> 00:27:16,770
from<font color="#E5E5E5"> the command line right but you can</font>

756
00:27:15,420 --> 00:27:18,820
also kind<font color="#CCCCCC"> of do it within the</font><font color="#E5E5E5"> framework</font>

757
00:27:16,770 --> 00:27:20,660
as well<font color="#E5E5E5"> a</font><font color="#CCCCCC"> couple</font><font color="#E5E5E5"> of options</font>

758
00:27:18,820 --> 00:27:23,129
[Music]

759
00:27:20,660 --> 00:27:25,980
<font color="#CCCCCC">those are my El</font><font color="#E5E5E5"> host and out port and</font>

760
00:27:23,130 --> 00:27:28,080
one thing<font color="#E5E5E5"> so I use</font><font color="#CCCCCC"> 4 for 3</font><font color="#E5E5E5"> here in case</font>

761
00:27:25,980 --> 00:27:30,060
the firewall is blocking it like any

762
00:27:28,080 --> 00:27:31,949
calling back out to or making the

763
00:27:30,060 --> 00:27:33,510
connection<font color="#E5E5E5"> back out to 444</font><font color="#CCCCCC"> you know the</font>

764
00:27:31,950 --> 00:27:35,610
default we're<font color="#E5E5E5"> not going to go with that</font>

765
00:27:33,510 --> 00:27:38,310
<font color="#CCCCCC">4</font><font color="#E5E5E5"> 4</font><font color="#CCCCCC"> 3</font><font color="#E5E5E5"> is probably you know allowed out</font>

766
00:27:35,610 --> 00:27:40,469
SSL kind of web stuff so this is a key

767
00:27:38,310 --> 00:27:41,850
<font color="#CCCCCC">here right so</font><font color="#E5E5E5"> this generate command is</font>

768
00:27:40,470 --> 00:27:45,120
what I'm going to<font color="#E5E5E5"> use to</font><font color="#CCCCCC"> generate</font><font color="#E5E5E5"> the</font>

769
00:27:41,850 --> 00:27:46,740
payload<font color="#CCCCCC"> and my type down here is how I'm</font>

770
00:27:45,120 --> 00:27:48,629
going to what type of payloads going to

771
00:27:46,740 --> 00:27:50,340
be generated usually or the ones<font color="#E5E5E5"> that we</font>

772
00:27:48,630 --> 00:27:52,770
were<font color="#E5E5E5"> looking at before I was generating</font>

773
00:27:50,340 --> 00:27:54,090
<font color="#E5E5E5">X's and you see that here XE but here</font>

774
00:27:52,770 --> 00:27:57,060
what we're<font color="#CCCCCC"> going to do is generate</font><font color="#E5E5E5"> the</font>

775
00:27:54,090 --> 00:27:58,439
<font color="#E5E5E5">shell code in hex</font><font color="#CCCCCC"> opcodes</font><font color="#E5E5E5"> so we can take</font>

776
00:27:57,060 --> 00:28:05,970
<font color="#E5E5E5">it and dump it straight into the sheet</font>

777
00:27:58,440 --> 00:28:08,880
<font color="#E5E5E5">sharp my man oh who could bounce</font>

778
00:28:05,970 --> 00:28:11,820
<font color="#E5E5E5">listener</font><font color="#CCCCCC"> I don't know I don't</font><font color="#E5E5E5"> know</font>

779
00:28:08,880 --> 00:28:13,050
<font color="#E5E5E5">that's</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> good</font><font color="#CCCCCC"> question X I know I don't</font>

780
00:28:11,820 --> 00:28:18,450
know if it was<font color="#CCCCCC"> encrypted going back out</font>

781
00:28:13,050 --> 00:28:19,950
<font color="#CCCCCC">to</font><font color="#E5E5E5"> the listener and</font><font color="#CCCCCC"> then sniffing but I</font>

782
00:28:18,450 --> 00:28:21,510
<font color="#E5E5E5">get active we</font><font color="#CCCCCC"> established the tunnel</font>

783
00:28:19,950 --> 00:28:23,220
with<font color="#CCCCCC"> the</font><font color="#E5E5E5"> cert I'm guessing everything</font>

784
00:28:21,510 --> 00:28:28,050
after<font color="#CCCCCC"> that would</font><font color="#E5E5E5"> be encrypted but that</font>

785
00:28:23,220 --> 00:28:31,710
initial<font color="#CCCCCC"> callback I don't know all</font><font color="#E5E5E5"> right</font>

786
00:28:28,050 --> 00:28:34,530
so we're going to do<font color="#E5E5E5"> c-sharp and</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> X</font>

787
00:28:31,710 --> 00:28:35,760
option was what we could<font color="#CCCCCC"> use</font><font color="#E5E5E5"> to change</font>

788
00:28:34,530 --> 00:28:38,580
<font color="#CCCCCC">the template</font><font color="#E5E5E5"> but here I'm going to use</font>

789
00:28:35,760 --> 00:28:41,250
some c-sharp<font color="#E5E5E5"> and I get rid</font><font color="#CCCCCC"> of some bad</font>

790
00:28:38,580 --> 00:28:42,330
characters right no biting<font color="#CCCCCC"> newline</font><font color="#E5E5E5"> and</font>

791
00:28:41,250 --> 00:28:44,220
carriage return

792
00:28:42,330 --> 00:28:46,260
forcing coding on the payload<font color="#E5E5E5"> five</font>

793
00:28:44,220 --> 00:28:48,179
iterations<font color="#E5E5E5"> and</font><font color="#CCCCCC"> then the platform is</font>

794
00:28:46,260 --> 00:28:49,750
<font color="#E5E5E5">going to be x86 right so this is what's</font>

795
00:28:48,179 --> 00:28:53,090
going<font color="#E5E5E5"> to generate that shellcode for us</font>

796
00:28:49,750 --> 00:28:55,860
[Music]

797
00:28:53,090 --> 00:28:58,439
and it dumps<font color="#E5E5E5"> it now the meterpreter</font>

798
00:28:55,860 --> 00:29:01,979
reverse meterpreter<font color="#CCCCCC"> https is a dual</font>

799
00:28:58,440 --> 00:29:03,480
stage<font color="#CCCCCC"> but</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> rx-8 all we</font><font color="#E5E5E5"> really care</font>

800
00:29:01,980 --> 00:29:07,550
about<font color="#CCCCCC"> in</font><font color="#E5E5E5"> that first stage which</font><font color="#CCCCCC"> is</font>

801
00:29:03,480 --> 00:29:09,809
usually smaller in size<font color="#E5E5E5"> so there is the</font>

802
00:29:07,550 --> 00:29:11,700
hex<font color="#CCCCCC"> off</font><font color="#E5E5E5"> codes that's our that's our</font>

803
00:29:09,809 --> 00:29:16,290
shell code right here<font color="#CCCCCC"> a byte array of</font>

804
00:29:11,700 --> 00:29:18,270
494 bytes so what we do is we take<font color="#CCCCCC"> that</font>

805
00:29:16,290 --> 00:29:22,080
back to<font color="#CCCCCC"> our attacker</font><font color="#E5E5E5"> and literally</font><font color="#CCCCCC"> just</font>

806
00:29:18,270 --> 00:29:24,120
dump it<font color="#E5E5E5"> in say that because</font><font color="#CCCCCC"> I'm you know</font>

807
00:29:22,080 --> 00:29:27,149
seems like<font color="#E5E5E5"> of them well and all they're</font>

808
00:29:24,120 --> 00:29:28,800
<font color="#E5E5E5">headed to the the formatting</font><font color="#CCCCCC"> and then we</font>

809
00:29:27,150 --> 00:29:33,360
<font color="#CCCCCC">define what</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> biter</font><font color="#E5E5E5"> the size of our</font>

810
00:29:28,800 --> 00:29:35,850
byte array is<font color="#E5E5E5"> 494 and then down here</font><font color="#CCCCCC"> we</font>

811
00:29:33,360 --> 00:29:38,699
also<font color="#E5E5E5"> come into play</font><font color="#CCCCCC"> so this is where I'm</font>

812
00:29:35,850 --> 00:29:40,409
<font color="#E5E5E5">launching one drive right</font><font color="#CCCCCC"> so I'm getting</font>

813
00:29:38,700 --> 00:29:42,150
the environment variable local app data

814
00:29:40,410 --> 00:29:44,130
which will point<font color="#E5E5E5"> me towards the location</font>

815
00:29:42,150 --> 00:29:47,580
<font color="#CCCCCC">of the one drive I start that process</font>

816
00:29:44,130 --> 00:29:49,890
and then I this variable proc<font color="#E5E5E5"> gets the</font>

817
00:29:47,580 --> 00:29:52,500
handle for<font color="#CCCCCC"> that one drive axing so that</font>

818
00:29:49,890 --> 00:29:54,540
handle is what<font color="#E5E5E5"> I start</font><font color="#CCCCCC"> passing to my</font>

819
00:29:52,500 --> 00:29:56,160
allocation calls for when I'm<font color="#CCCCCC"> handling</font>

820
00:29:54,540 --> 00:29:57,809
the<font color="#E5E5E5"> memory so the handle is going to</font>

821
00:29:56,160 --> 00:29:59,880
point back<font color="#E5E5E5"> to my onedrive so every time</font>

822
00:29:57,809 --> 00:30:03,240
<font color="#E5E5E5">this runs it will start</font><font color="#CCCCCC"> onedrive</font><font color="#E5E5E5"> and</font>

823
00:29:59,880 --> 00:30:04,410
then inject<font color="#E5E5E5"> into onedrive</font><font color="#CCCCCC"> oh and then</font>

824
00:30:03,240 --> 00:30:05,490
this is something<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was messing</font><font color="#CCCCCC"> with -</font>

825
00:30:04,410 --> 00:30:06,980
doesn't really<font color="#CCCCCC"> come into play but</font><font color="#E5E5E5"> I</font>

826
00:30:05,490 --> 00:30:09,929
<font color="#E5E5E5">figure</font><font color="#CCCCCC"> to tell you guys</font>

827
00:30:06,980 --> 00:30:11,250
sometimes sonar if the actually fires

828
00:30:09,929 --> 00:30:12,720
off and then immediately<font color="#E5E5E5"> goes for the</font>

829
00:30:11,250 --> 00:30:14,790
network and<font color="#E5E5E5"> starts trying</font><font color="#CCCCCC"> to send a tit</font>

830
00:30:12,720 --> 00:30:17,160
<font color="#CCCCCC">that will flag so what I did there is a</font>

831
00:30:14,790 --> 00:30:18,990
<font color="#E5E5E5">little sleeper</font><font color="#CCCCCC"> delay right so don't call</font>

832
00:30:17,160 --> 00:30:21,570
the remote thread<font color="#E5E5E5"> don't start that</font>

833
00:30:18,990 --> 00:30:23,480
<font color="#E5E5E5">shellcode until you know you sleep</font><font color="#CCCCCC"> for I</font>

834
00:30:21,570 --> 00:30:26,550
think<font color="#CCCCCC"> this was a minute</font>

835
00:30:23,480 --> 00:30:28,530
<font color="#CCCCCC">all right so and all I'm doing</font><font color="#E5E5E5"> here is</font>

836
00:30:26,550 --> 00:30:30,090
this build<font color="#E5E5E5"> it so I'm just deleting you</font>

837
00:30:28,530 --> 00:30:36,030
know something I had<font color="#CCCCCC"> before</font><font color="#E5E5E5"> in there and</font>

838
00:30:30,090 --> 00:30:39,330
then I build the solution<font color="#CCCCCC"> okey doke</font>

839
00:30:36,030 --> 00:30:41,010
succeeded and then I take that<font color="#E5E5E5"> mal and</font>

840
00:30:39,330 --> 00:30:44,010
<font color="#E5E5E5">Jack that exe</font><font color="#CCCCCC"> and I bring it over</font><font color="#E5E5E5"> to</font>

841
00:30:41,010 --> 00:30:46,770
that<font color="#E5E5E5"> shared folder and then I change it</font>

842
00:30:44,010 --> 00:30:51,240
to dumb name so we go back<font color="#CCCCCC"> to our victim</font>

843
00:30:46,770 --> 00:30:52,470
I start my<font color="#E5E5E5"> AV as administrator for some</font>

844
00:30:51,240 --> 00:30:53,980
reason I take<font color="#CCCCCC"> a look</font><font color="#E5E5E5"> at the history</font><font color="#CCCCCC"> just</font>

845
00:30:52,470 --> 00:30:56,830
see that<font color="#E5E5E5"> there's nothing in there</font>

846
00:30:53,980 --> 00:31:00,760
<font color="#CCCCCC">I go back</font><font color="#E5E5E5"> to the shared folder and now I</font>

847
00:30:56,830 --> 00:31:02,530
pull I<font color="#E5E5E5"> pulled dumb name on to my desktop</font>

848
00:31:00,760 --> 00:31:04,960
<font color="#E5E5E5">now here is where the auto protection is</font>

849
00:31:02,530 --> 00:31:08,168
so even<font color="#CCCCCC"> just</font><font color="#E5E5E5"> that simple copy action on</font>

850
00:31:04,960 --> 00:31:09,820
getting scans the<font color="#CCCCCC"> longer</font><font color="#E5E5E5"> it stays on the</font>

851
00:31:08,169 --> 00:31:11,020
desktop<font color="#E5E5E5"> the better shots I have that</font>

852
00:31:09,820 --> 00:31:14,168
I've gotten around signature and

853
00:31:11,020 --> 00:31:17,440
heuristics<font color="#E5E5E5"> for just a hammer home I do a</font>

854
00:31:14,169 --> 00:31:20,200
quick scan on it and we have the green

855
00:31:17,440 --> 00:31:27,190
light<font color="#E5E5E5"> no threats found perfect right so</font>

856
00:31:20,200 --> 00:31:29,470
now we fire off<font color="#E5E5E5"> the payload and we don't</font>

857
00:31:27,190 --> 00:31:32,350
really<font color="#CCCCCC"> get too far</font><font color="#E5E5E5"> so onedrive popped</font>

858
00:31:29,470 --> 00:31:35,049
off but then we got hit with the sonar

859
00:31:32,350 --> 00:31:38,918
<font color="#E5E5E5">right so there's our sonar eristic</font><font color="#CCCCCC"> 158</font>

860
00:31:35,049 --> 00:31:40,840
coming<font color="#CCCCCC"> into</font><font color="#E5E5E5"> fly</font><font color="#CCCCCC"> exactly what I'm doing</font>

861
00:31:38,919 --> 00:31:42,460
there but I should follow the link if I

862
00:31:40,840 --> 00:31:44,139
<font color="#E5E5E5">good look to the more details</font><font color="#CCCCCC"> and then</font>

863
00:31:42,460 --> 00:31:46,330
they even<font color="#E5E5E5"> had a drop down you look here</font>

864
00:31:44,140 --> 00:31:47,950
it's suspicious<font color="#CCCCCC"> actions you know what</font>

865
00:31:46,330 --> 00:31:49,600
<font color="#CCCCCC">did I we</font><font color="#E5E5E5"> didn't think it was fishy and</font>

866
00:31:47,950 --> 00:31:51,580
<font color="#E5E5E5">then here's the attempt to start the</font>

867
00:31:49,600 --> 00:31:52,928
<font color="#E5E5E5">remote thread in a process address so it</font>

868
00:31:51,580 --> 00:31:54,549
didn't like that hey I was<font color="#E5E5E5"> trying</font><font color="#CCCCCC"> to do</font>

869
00:31:52,929 --> 00:32:01,500
something<font color="#CCCCCC"> at another</font><font color="#E5E5E5"> process beyond</font>

870
00:31:54,549 --> 00:32:01,500
besides my own so I<font color="#CCCCCC"> close that kill that</font>

871
00:32:01,559 --> 00:32:11,110
and then clear<font color="#CCCCCC"> the list</font><font color="#E5E5E5"> of the history</font>

872
00:32:04,750 --> 00:32:13,240
but we go back to<font color="#E5E5E5"> you go I go back to</font>

873
00:32:11,110 --> 00:32:16,870
the sample payload and set a dumb name<font color="#CCCCCC"> I</font>

874
00:32:13,240 --> 00:32:18,820
make<font color="#E5E5E5"> it same PE right so it's the same</font>

875
00:32:16,870 --> 00:32:22,030
<font color="#E5E5E5">file just</font><font color="#CCCCCC"> a different name now it's just</font>

876
00:32:18,820 --> 00:32:24,399
smaller<font color="#E5E5E5"> alpha I do a scan just to prove</font>

877
00:32:22,030 --> 00:32:26,678
we're still you know<font color="#CCCCCC"> bypassing and then</font>

878
00:32:24,400 --> 00:32:30,160
when I hit the open<font color="#E5E5E5"> here</font><font color="#CCCCCC"> I no</font><font color="#E5E5E5"> longer</font>

879
00:32:26,679 --> 00:32:32,530
have that<font color="#E5E5E5"> sonar now I have my IPS set so</font>

880
00:32:30,160 --> 00:32:33,790
<font color="#E5E5E5">now I got past that whole hey this seems</font>

881
00:32:32,530 --> 00:32:35,559
odd you're injecting<font color="#E5E5E5"> into a</font><font color="#CCCCCC"> remote</font>

882
00:32:33,790 --> 00:32:41,500
process<font color="#E5E5E5"> but it still called me for that</font>

883
00:32:35,559 --> 00:32:43,720
<font color="#CCCCCC">SSL so onedrive</font><font color="#E5E5E5"> always pops off because</font>

884
00:32:41,500 --> 00:32:46,840
<font color="#E5E5E5">I start onedrive before I start to</font>

885
00:32:43,720 --> 00:32:50,190
trigger my remote thread but the

886
00:32:46,840 --> 00:32:50,189
interpreter<font color="#E5E5E5"> does go through go for it</font>

887
00:32:51,419 --> 00:32:56,650
exactly<font color="#E5E5E5"> so you'll see that in the next</font>

888
00:32:53,740 --> 00:32:57,520
<font color="#E5E5E5">video</font><font color="#CCCCCC"> right so there we are our</font>

889
00:32:56,650 --> 00:32:59,890
intrusion attempt

890
00:32:57,520 --> 00:33:05,889
we're still getting caught which we

891
00:32:59,890 --> 00:33:09,250
don't<font color="#E5E5E5"> like fill that in and this one</font>

892
00:33:05,890 --> 00:33:10,900
<font color="#CCCCCC">it's alright on</font><font color="#E5E5E5"> a bunch</font><font color="#CCCCCC"> of them open</font>

893
00:33:09,250 --> 00:33:15,610
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> this is where we do the</font>

894
00:33:10,900 --> 00:33:17,530
<font color="#E5E5E5">impersonation so this one I'm just going</font>

895
00:33:15,610 --> 00:33:18,370
to play a<font color="#E5E5E5"> little faster</font><font color="#CCCCCC"> because you</font>

896
00:33:17,530 --> 00:33:21,700
don't have<font color="#E5E5E5"> to go through everything</font>

897
00:33:18,370 --> 00:33:26,229
again<font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> just showing here that</font><font color="#CCCCCC"> hey</font>

898
00:33:21,700 --> 00:33:28,690
this<font color="#CCCCCC"> is</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> same PE</font><font color="#E5E5E5"> file this</font><font color="#CCCCCC"> uh this</font>

899
00:33:26,230 --> 00:33:30,549
<font color="#CCCCCC">isn't something I didn't change</font><font color="#E5E5E5"> anything</font>

900
00:33:28,690 --> 00:33:33,400
it's<font color="#CCCCCC"> the same same thing that</font><font color="#E5E5E5"> we saw in</font>

901
00:33:30,549 --> 00:33:37,420
the previous<font color="#CCCCCC"> example I do is</font><font color="#E5E5E5"> not another</font>

902
00:33:33,400 --> 00:33:47,850
<font color="#E5E5E5">build bring it back over</font><font color="#CCCCCC"> to the share</font>

903
00:33:37,420 --> 00:33:47,850
<font color="#CCCCCC">folder delete the old one copy it over</font>

904
00:33:48,179 --> 00:33:53,679
scan again<font color="#E5E5E5"> no problems we got around</font>

905
00:33:50,890 --> 00:33:55,570
<font color="#E5E5E5">that fantastic our history</font>

906
00:33:53,679 --> 00:33:57,370
<font color="#E5E5E5">cuz</font><font color="#CCCCCC"> all reason I</font><font color="#E5E5E5"> don't know why my</font>

907
00:33:55,570 --> 00:33:58,870
videos<font color="#E5E5E5"> I figured that I wanted to prove</font>

908
00:33:57,370 --> 00:34:00,428
to<font color="#E5E5E5"> the user that there wasn't in the</font>

909
00:33:58,870 --> 00:34:03,010
history anything<font color="#CCCCCC"> Club</font>

910
00:34:00,429 --> 00:34:04,600
that didn't work<font color="#E5E5E5"> because</font><font color="#CCCCCC"> I forgot to</font>

911
00:34:03,010 --> 00:34:05,950
<font color="#E5E5E5">start my handler I'm like where's my you</font>

912
00:34:04,600 --> 00:34:07,270
know the<font color="#CCCCCC"> a/v is not buying what happened</font>

913
00:34:05,950 --> 00:34:08,530
<font color="#CCCCCC">I forgot to start</font><font color="#E5E5E5"> the handler on the</font>

914
00:34:07,270 --> 00:34:11,050
other end so that's<font color="#E5E5E5"> why that didn't go</font>

915
00:34:08,530 --> 00:34:12,970
but as soon<font color="#E5E5E5"> as that goes boom</font><font color="#CCCCCC"> I get</font><font color="#E5E5E5"> head</font>

916
00:34:11,050 --> 00:34:14,980
so<font color="#CCCCCC"> at this point</font><font color="#E5E5E5"> we're still in the same</font>

917
00:34:12,969 --> 00:34:21,009
<font color="#CCCCCC">boat right we're still getting caught by</font>

918
00:34:14,980 --> 00:34:23,020
<font color="#CCCCCC">the IPS and we're still injecting into</font>

919
00:34:21,010 --> 00:34:24,490
<font color="#E5E5E5">that one drive which is you know ideal</font>

920
00:34:23,020 --> 00:34:28,270
what we want to do so how do<font color="#CCCCCC"> we get</font>

921
00:34:24,489 --> 00:34:29,229
around<font color="#E5E5E5"> me is around the</font><font color="#CCCCCC"> VSS LSU</font><font color="#E5E5E5"> we go</font>

922
00:34:28,270 --> 00:34:31,960
back<font color="#E5E5E5"> over</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> Callie</font>

923
00:34:29,230 --> 00:34:33,369
and really it becomes a setting change

924
00:34:31,960 --> 00:34:35,199
like<font color="#CCCCCC"> I've</font><font color="#E5E5E5"> mentioned</font><font color="#CCCCCC"> before in the Hamlet</font>

925
00:34:33,369 --> 00:34:37,149
<font color="#E5E5E5">this isn't a change to the binary</font><font color="#CCCCCC"> this</font>

926
00:34:35,199 --> 00:34:38,500
is only a change to the<font color="#E5E5E5"> handler</font><font color="#CCCCCC"> and the</font>

927
00:34:37,149 --> 00:34:41,168
two things we're going to use more

928
00:34:38,500 --> 00:34:43,270
importantly as this one<font color="#E5E5E5"> handler SSL cert</font>

929
00:34:41,168 --> 00:34:45,250
so this is the SSL cert<font color="#E5E5E5"> that the handler</font>

930
00:34:43,270 --> 00:34:46,449
<font color="#E5E5E5">is</font><font color="#CCCCCC"> going to use so by default it's not</font>

931
00:34:45,250 --> 00:34:47,980
set it's blank it's just going<font color="#E5E5E5"> to use</font>

932
00:34:46,449 --> 00:34:49,259
the default one in the framework<font color="#E5E5E5"> we're</font>

933
00:34:47,980 --> 00:34:54,940
going to we're going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> use that one</font>

934
00:34:49,260 --> 00:34:58,330
<font color="#E5E5E5">with it on a personated one so this</font><font color="#CCCCCC"> is</font>

935
00:34:54,940 --> 00:35:00,640
<font color="#CCCCCC">that impersonate SSL option and I think</font>

936
00:34:58,330 --> 00:35:02,710
<font color="#E5E5E5">you do it an intro on</font><font color="#CCCCCC"> it right so this</font>

937
00:35:00,640 --> 00:35:04,420
<font color="#CCCCCC">module will request</font><font color="#E5E5E5"> a copy of a true</font>

938
00:35:02,710 --> 00:35:06,460
remote SSL certificate and<font color="#E5E5E5"> then creates</font>

939
00:35:04,420 --> 00:35:08,290
a local<font color="#E5E5E5"> self signed version</font><font color="#CCCCCC"> I'm using</font>

940
00:35:06,460 --> 00:35:09,820
<font color="#E5E5E5">the</font><font color="#CCCCCC"> information</font><font color="#E5E5E5"> from that so that's what</font>

941
00:35:08,290 --> 00:35:13,480
we're going<font color="#E5E5E5"> to do with them and then</font>

942
00:35:09,820 --> 00:35:16,300
when you run it which<font color="#CCCCCC"> ones</font><font color="#E5E5E5"> that you set</font>

943
00:35:13,480 --> 00:35:18,460
our<font color="#E5E5E5"> hosts Google</font><font color="#CCCCCC"> let's use Google and</font>

944
00:35:16,300 --> 00:35:19,300
then run and then this<font color="#E5E5E5"> is what we want</font>

945
00:35:18,460 --> 00:35:21,430
<font color="#E5E5E5">it</font>

946
00:35:19,300 --> 00:35:27,070
reach this PEM file<font color="#E5E5E5"> and then that's what</font>

947
00:35:21,430 --> 00:35:33,759
<font color="#E5E5E5">we passed for our</font><font color="#CCCCCC"> ssl certificate so we</font>

948
00:35:27,070 --> 00:35:40,180
copy<font color="#CCCCCC"> that because I got a problem type</font>

949
00:35:33,760 --> 00:35:42,850
in there go<font color="#CCCCCC"> back to my handler now these</font>

950
00:35:40,180 --> 00:35:46,930
are<font color="#E5E5E5"> in the Advanced Options</font><font color="#CCCCCC"> write that</font>

951
00:35:42,850 --> 00:35:49,630
handler SSL cert<font color="#E5E5E5"> and then here I've set</font>

952
00:35:46,930 --> 00:35:53,799
<font color="#E5E5E5">that value to that PEM file from coming</font>

953
00:35:49,630 --> 00:35:56,710
<font color="#E5E5E5">out of this booth there and then I set</font>

954
00:35:53,800 --> 00:36:00,190
the verify SSL cert to true<font color="#E5E5E5"> to</font><font color="#CCCCCC"> verify</font>

955
00:35:56,710 --> 00:36:01,620
that<font color="#CCCCCC"> so I</font><font color="#E5E5E5"> don't have my active job so I</font>

956
00:36:00,190 --> 00:36:04,420
start my job again

957
00:36:01,620 --> 00:36:06,640
<font color="#CCCCCC">and</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> time I go back</font><font color="#E5E5E5"> over refresh</font>

958
00:36:04,420 --> 00:36:10,300
same<font color="#CCCCCC"> binary that was flagged in before</font>

959
00:36:06,640 --> 00:36:13,859
right<font color="#E5E5E5"> onedrive is not running we started</font>

960
00:36:10,300 --> 00:36:17,040
again<font color="#E5E5E5"> little shell onedrive opens up and</font>

961
00:36:13,860 --> 00:36:19,570
nothing looks like<font color="#E5E5E5"> one drives running</font>

962
00:36:17,040 --> 00:36:23,200
BAM<font color="#CCCCCC"> we got the shell on the back end so</font>

963
00:36:19,570 --> 00:36:24,940
<font color="#E5E5E5">here is our connection that is our</font>

964
00:36:23,200 --> 00:36:32,620
trigger<font color="#E5E5E5"> handle going back gumming back</font>

965
00:36:24,940 --> 00:36:35,980
from the victim the victim is<font color="#E5E5E5"> 155 and</font>

966
00:36:32,620 --> 00:36:38,740
one thing I do<font color="#E5E5E5"> here is we interact with</font>

967
00:36:35,980 --> 00:36:42,150
<font color="#E5E5E5">the section session victim</font><font color="#CCCCCC"> 7p park</font><font color="#E5E5E5"> of</font>

968
00:36:38,740 --> 00:36:45,310
<font color="#CCCCCC">superman's</font><font color="#E5E5E5"> in a spider-man denial</font>

969
00:36:42,150 --> 00:36:46,960
this is the<font color="#E5E5E5"> process ID of our</font>

970
00:36:45,310 --> 00:36:51,040
interpreter right so our meterpreter

971
00:36:46,960 --> 00:36:53,110
shell<font color="#E5E5E5"> 3208</font><font color="#CCCCCC"> if we look at all the</font>

972
00:36:51,040 --> 00:36:55,930
<font color="#E5E5E5">processes running on the system and we</font>

973
00:36:53,110 --> 00:36:58,120
find 3208 right there

974
00:36:55,930 --> 00:37:01,899
onedrive<font color="#E5E5E5"> so that's how we know</font><font color="#CCCCCC"> that our</font>

975
00:36:58,120 --> 00:37:04,120
interpreters in onedrive<font color="#CCCCCC"> right so</font><font color="#E5E5E5"> that</font>

976
00:37:01,900 --> 00:37:07,030
was pretty<font color="#E5E5E5"> much ideal for</font><font color="#CCCCCC"> us in</font><font color="#E5E5E5"> terms</font><font color="#CCCCCC"> of</font>

977
00:37:04,120 --> 00:37:08,500
<font color="#E5E5E5">getting around this and then just for</font>

978
00:37:07,030 --> 00:37:10,990
confirmation purposes and it's the

979
00:37:08,500 --> 00:37:13,690
victim<font color="#E5E5E5"> 7 and I think I do</font><font color="#CCCCCC"> it get you ID</font>

980
00:37:10,990 --> 00:37:22,029
at the<font color="#E5E5E5"> NGO jail just to say hey I'm T</font>

981
00:37:13,690 --> 00:37:24,670
<font color="#E5E5E5">Parker</font><font color="#CCCCCC"> I'm not</font><font color="#E5E5E5"> background it</font><font color="#CCCCCC"> alright so</font>

982
00:37:22,030 --> 00:37:26,380
be<font color="#CCCCCC"> side that first initial encryption</font>

983
00:37:24,670 --> 00:37:28,270
question is there anything<font color="#E5E5E5"> else on</font><font color="#CCCCCC"> that</font>

984
00:37:26,380 --> 00:37:30,250
setting<font color="#CCCCCC"> this is all up</font><font color="#E5E5E5"> like I said and</font>

985
00:37:28,270 --> 00:37:31,759
cybg code calm<font color="#CCCCCC"> if you well</font><font color="#E5E5E5"> if you have</font>

986
00:37:30,250 --> 00:37:39,650
any interest<font color="#CCCCCC"> go for</font>

987
00:37:31,760 --> 00:37:41,000
<font color="#CCCCCC">I the</font><font color="#E5E5E5"> only thing I could think</font><font color="#CCCCCC"> about</font>

988
00:37:39,650 --> 00:37:43,970
<font color="#E5E5E5">that would stop that from happening is</font>

989
00:37:41,000 --> 00:37:45,470
if you<font color="#E5E5E5"> didn't have rights to do it so if</font>

990
00:37:43,970 --> 00:37:46,790
that if<font color="#CCCCCC"> Chrome is running</font><font color="#E5E5E5"> under a</font>

991
00:37:45,470 --> 00:37:47,779
different<font color="#E5E5E5"> account or an administrative</font>

992
00:37:46,790 --> 00:37:50,120
account<font color="#E5E5E5"> and you didn't have the</font>

993
00:37:47,780 --> 00:37:52,580
privileges<font color="#CCCCCC"> that could stop</font><font color="#E5E5E5"> you but let's</font>

994
00:37:50,120 --> 00:37:54,560
say<font color="#CCCCCC"> onedrive</font><font color="#E5E5E5"> was already running um and</font>

995
00:37:52,580 --> 00:37:55,819
it<font color="#CCCCCC"> was running</font><font color="#E5E5E5"> under</font><font color="#CCCCCC"> my context</font><font color="#E5E5E5"> P Parker</font>

996
00:37:54,560 --> 00:37:59,779
<font color="#CCCCCC">I</font><font color="#E5E5E5"> don't think that should be</font><font color="#CCCCCC"> initiate</font>

997
00:37:55,820 --> 00:38:01,550
<font color="#E5E5E5">this one</font><font color="#CCCCCC"> I also had a line in that t</font>

998
00:37:59,780 --> 00:38:04,850
<font color="#E5E5E5">sharp</font><font color="#CCCCCC"> - that would kill anyone</font><font color="#E5E5E5"> Drive</font>

999
00:38:01,550 --> 00:38:06,350
instance and then start it<font color="#E5E5E5"> again</font><font color="#CCCCCC"> I just</font>

1000
00:38:04,850 --> 00:38:08,420
thought it'd probably be best<font color="#E5E5E5"> if I just</font>

1001
00:38:06,350 --> 00:38:09,770
<font color="#E5E5E5">started fresh</font><font color="#CCCCCC"> I'm starting</font><font color="#E5E5E5"> with one drop</font>

1002
00:38:08,420 --> 00:38:12,170
but I don't<font color="#E5E5E5"> think I don't</font><font color="#CCCCCC"> think there</font>

1003
00:38:09,770 --> 00:38:15,680
should<font color="#CCCCCC"> be any issue with that all right</font>

1004
00:38:12,170 --> 00:38:20,210
<font color="#CCCCCC">so the next scenario</font><font color="#E5E5E5"> are we doing on</font>

1005
00:38:15,680 --> 00:38:22,730
time<font color="#CCCCCC"> 338</font><font color="#E5E5E5"> okay ah</font><font color="#CCCCCC"> shelter</font><font color="#E5E5E5"> brawl is</font>

1006
00:38:20,210 --> 00:38:25,130
anybody ever<font color="#CCCCCC"> used shelter before it's</font>

1007
00:38:22,730 --> 00:38:31,730
basically<font color="#E5E5E5"> uh it's it's an unbelievable</font>

1008
00:38:25,130 --> 00:38:33,200
tool<font color="#E5E5E5"> it does P infection or injection in</font>

1009
00:38:31,730 --> 00:38:35,270
a different way so usually when we<font color="#E5E5E5"> think</font>

1010
00:38:33,200 --> 00:38:36,710
of PE infectors we think of<font color="#E5E5E5"> maybe I try</font>

1011
00:38:35,270 --> 00:38:38,360
to find a code cave and<font color="#CCCCCC"> stuffing some</font>

1012
00:38:36,710 --> 00:38:40,670
code in there or maybe<font color="#CCCCCC"> appending in</font>

1013
00:38:38,360 --> 00:38:43,550
another section<font color="#E5E5E5"> to the PE file but what</font>

1014
00:38:40,670 --> 00:38:45,290
shelter<font color="#CCCCCC"> bro does is it executes that</font>

1015
00:38:43,550 --> 00:38:47,150
that software<font color="#E5E5E5"> and then traces the</font>

1016
00:38:45,290 --> 00:38:49,100
execution<font color="#E5E5E5"> and then it has</font><font color="#CCCCCC"> more kind</font><font color="#E5E5E5"> of</font>

1017
00:38:47,150 --> 00:38:51,200
intelligent sophisticated ways of<font color="#E5E5E5"> how</font>

1018
00:38:49,100 --> 00:38:52,910
can<font color="#E5E5E5"> I inject my</font><font color="#CCCCCC"> shellcode in there so</font>

1019
00:38:51,200 --> 00:38:55,189
it's it's more dynamic as opposed<font color="#E5E5E5"> to</font>

1020
00:38:52,910 --> 00:38:57,649
kind<font color="#E5E5E5"> of um</font><font color="#CCCCCC"> like I said just</font><font color="#E5E5E5"> kind of</font>

1021
00:38:55,190 --> 00:39:00,470
appending new stuff to a PE file<font color="#E5E5E5"> so this</font>

1022
00:38:57,650 --> 00:39:02,600
comes at a shelter<font color="#CCCCCC"> project or at shelter</font>

1023
00:39:00,470 --> 00:39:03,859
projects of twitter handler<font color="#CCCCCC"> I highly</font>

1024
00:39:02,600 --> 00:39:05,990
<font color="#E5E5E5">recommend going out and supporting this</font>

1025
00:39:03,860 --> 00:39:09,470
product it's a fantastic<font color="#E5E5E5"> tool and it's</font>

1026
00:39:05,990 --> 00:39:11,479
<font color="#E5E5E5">really at you know redefining AV evasion</font>

1027
00:39:09,470 --> 00:39:13,970
<font color="#CCCCCC">is what it says on website but it's very</font>

1028
00:39:11,480 --> 00:39:15,650
<font color="#E5E5E5">good the version that we're going to use</font>

1029
00:39:13,970 --> 00:39:17,990
is the pro<font color="#CCCCCC"> version</font><font color="#E5E5E5"> so definitely go out</font>

1030
00:39:15,650 --> 00:39:20,690
there and support<font color="#E5E5E5"> them pro version 2.0</font>

1031
00:39:17,990 --> 00:39:23,299
that came out and I've<font color="#E5E5E5"> seen like</font><font color="#CCCCCC"> a month</font>

1032
00:39:20,690 --> 00:39:25,880
ago<font color="#E5E5E5"> allowed us to do this injection into</font>

1033
00:39:23,300 --> 00:39:29,240
<font color="#CCCCCC">DLL files</font><font color="#E5E5E5"> so right now it's only limited</font>

1034
00:39:25,880 --> 00:39:31,520
<font color="#CCCCCC">to 32 bits</font><font color="#E5E5E5"> executables but now we can do</font>

1035
00:39:29,240 --> 00:39:33,049
our injection into<font color="#CCCCCC"> xes or dll files</font>

1036
00:39:31,520 --> 00:39:36,320
<font color="#CCCCCC">alright so what we're going</font><font color="#E5E5E5"> to do is</font>

1037
00:39:33,050 --> 00:39:38,420
inject a<font color="#E5E5E5"> dll file so which one are we</font>

1038
00:39:36,320 --> 00:39:40,430
going<font color="#E5E5E5"> to choose</font><font color="#CCCCCC"> chrome</font><font color="#E5E5E5"> for the same</font>

1039
00:39:38,420 --> 00:39:42,320
reason that<font color="#E5E5E5"> we picked onedrive</font>

1040
00:39:40,430 --> 00:39:43,759
we can initiate<font color="#CCCCCC"> the process it's a</font>

1041
00:39:42,320 --> 00:39:44,440
trusted application in<font color="#E5E5E5"> terms of the</font>

1042
00:39:43,760 --> 00:39:46,660
white listing

1043
00:39:44,440 --> 00:39:48,490
and it's allowed to<font color="#CCCCCC"> use the Network+ if</font>

1044
00:39:46,660 --> 00:39:50,500
this we're<font color="#E5E5E5"> gonna use this in</font><font color="#CCCCCC"> the context</font>

1045
00:39:48,490 --> 00:39:52,569
of<font color="#E5E5E5"> a back door this would be pretty</font>

1046
00:39:50,500 --> 00:39:53,230
ideal for<font color="#CCCCCC"> us because everybody loves the</font>

1047
00:39:52,569 --> 00:39:55,390
<font color="#E5E5E5">Internet</font>

1048
00:39:53,230 --> 00:39:57,819
especially<font color="#E5E5E5"> during the</font><font color="#CCCCCC"> work day</font><font color="#E5E5E5"> so if I</font>

1049
00:39:55,390 --> 00:39:59,470
can get my payload to run or execute

1050
00:39:57,819 --> 00:40:02,980
every time somebody opens the<font color="#E5E5E5"> Chrome</font>

1051
00:39:59,470 --> 00:40:05,009
browser<font color="#CCCCCC"> that'd be pretty pretty ideal so</font>

1052
00:40:02,980 --> 00:40:10,240
that's what we're going<font color="#E5E5E5"> to do here</font><font color="#CCCCCC"> um</font>

1053
00:40:05,009 --> 00:40:19,769
and<font color="#E5E5E5"> this</font><font color="#CCCCCC"> video is out there on separate</font>

1054
00:40:10,240 --> 00:40:23,589
decode as well<font color="#E5E5E5"> sheltered</font><font color="#CCCCCC"> the full screen</font>

1055
00:40:19,769 --> 00:40:24,970
so shelter is portable<font color="#CCCCCC"> - you can um you</font>

1056
00:40:23,589 --> 00:40:26,619
don't<font color="#CCCCCC"> need to install</font><font color="#E5E5E5"> it to the host you</font>

1057
00:40:24,970 --> 00:40:27,910
can<font color="#E5E5E5"> if you know you're compromising</font>

1058
00:40:26,619 --> 00:40:30,640
machine you can<font color="#E5E5E5"> bring it down and do</font>

1059
00:40:27,910 --> 00:40:32,170
your infection on<font color="#CCCCCC"> the host as well and</font>

1060
00:40:30,640 --> 00:40:34,450
then another<font color="#CCCCCC"> Pro feature that</font><font color="#E5E5E5"> we don't</font>

1061
00:40:32,170 --> 00:40:37,359
get<font color="#E5E5E5"> into today</font><font color="#CCCCCC"> but it's called execution</font>

1062
00:40:34,450 --> 00:40:41,069
flow<font color="#E5E5E5"> data so once I trace an application</font>

1063
00:40:37,359 --> 00:40:43,328
or<font color="#E5E5E5"> I trace that DLL</font><font color="#CCCCCC"> I can use that EFD</font>

1064
00:40:41,069 --> 00:40:44,829
<font color="#E5E5E5">many more times without having</font><font color="#CCCCCC"> to do</font>

1065
00:40:43,329 --> 00:40:46,630
that trace operation over and over<font color="#CCCCCC"> and</font>

1066
00:40:44,829 --> 00:40:48,579
over<font color="#E5E5E5"> again what it's going to do is take</font>

1067
00:40:46,630 --> 00:40:50,950
the configuration from that<font color="#CCCCCC"> efe</font><font color="#E5E5E5"> and just</font>

1068
00:40:48,579 --> 00:40:53,440
apply that<font color="#E5E5E5"> DLL that is going to seen</font>

1069
00:40:50,950 --> 00:41:02,500
before but<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> full this is a full</font>

1070
00:40:53,440 --> 00:41:07,119
run of<font color="#E5E5E5"> how injected that file</font><font color="#CCCCCC"> oh</font><font color="#E5E5E5"> so I</font>

1071
00:41:02,500 --> 00:41:08,740
did<font color="#CCCCCC"> it here so here is and the firewall</font>

1072
00:41:07,119 --> 00:41:10,779
settings these<font color="#E5E5E5"> are</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> programs that are</font>

1073
00:41:08,740 --> 00:41:14,609
allowed to<font color="#CCCCCC"> hit the</font><font color="#E5E5E5"> internet and you see</font>

1074
00:41:10,779 --> 00:41:14,609
here<font color="#E5E5E5"> we got Google Chrome is allowed</font><font color="#CCCCCC"> I</font>

1075
00:41:15,180 --> 00:41:18,848
wonder<font color="#CCCCCC"> if I scroll down</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> I shall I</font>

1076
00:41:17,259 --> 00:41:20,859
don't show one<font color="#E5E5E5"> drag but one drive was</font>

1077
00:41:18,849 --> 00:41:24,430
also in<font color="#E5E5E5"> that list so in order to</font>

1078
00:41:20,859 --> 00:41:27,700
<font color="#E5E5E5">determine the DLL that</font><font color="#CCCCCC"> Chrome used what</font>

1079
00:41:24,430 --> 00:41:29,740
I did was I just started proc<font color="#E5E5E5"> Mon and</font>

1080
00:41:27,700 --> 00:41:33,430
did a<font color="#E5E5E5"> bunch of filters you know the path</font>

1081
00:41:29,740 --> 00:41:36,368
contains<font color="#E5E5E5"> Google what else that I put the</font>

1082
00:41:33,430 --> 00:41:40,750
process name should<font color="#CCCCCC"> be</font><font color="#E5E5E5"> what is the</font>

1083
00:41:36,369 --> 00:41:42,490
chrome dot exe<font color="#E5E5E5"> now and then the last one</font>

1084
00:41:40,750 --> 00:41:43,869
was<font color="#CCCCCC"> just trial and</font><font color="#E5E5E5"> error that I figured</font>

1085
00:41:42,490 --> 00:41:47,799
out<font color="#E5E5E5"> why I was working with some results</font>

1086
00:41:43,869 --> 00:41:49,569
<font color="#CCCCCC">is success</font><font color="#E5E5E5"> and what that means is when</font>

1087
00:41:47,799 --> 00:41:51,640
it tries to<font color="#CCCCCC"> access a file while it's</font>

1088
00:41:49,569 --> 00:41:53,410
executing<font color="#E5E5E5"> whether it was</font><font color="#CCCCCC"> successful in</font>

1089
00:41:51,640 --> 00:41:54,788
doing<font color="#E5E5E5"> so or it was not</font><font color="#CCCCCC"> successful I</font><font color="#E5E5E5"> want</font>

1090
00:41:53,410 --> 00:41:56,288
to know<font color="#E5E5E5"> that it was successful because</font>

1091
00:41:54,789 --> 00:41:57,580
<font color="#E5E5E5">then I know these are absolutely the</font>

1092
00:41:56,289 --> 00:42:01,270
files that<font color="#E5E5E5"> it's working</font><font color="#CCCCCC"> with</font>

1093
00:41:57,580 --> 00:42:02,440
so when I<font color="#CCCCCC"> launch that</font><font color="#E5E5E5"> and then I launch</font>

1094
00:42:01,270 --> 00:42:04,060
Chrome boom

1095
00:42:02,440 --> 00:42:06,160
<font color="#E5E5E5">Proc mount fires off a bunch</font><font color="#CCCCCC"> of</font>

1096
00:42:04,060 --> 00:42:08,230
different stuff<font color="#CCCCCC"> and</font><font color="#E5E5E5"> I think I just</font><font color="#CCCCCC"> go to</font>

1097
00:42:06,160 --> 00:42:10,210
<font color="#E5E5E5">like time</font><font color="#CCCCCC"> table</font><font color="#E5E5E5"> was my example</font><font color="#CCCCCC"> here</font>

1098
00:42:08,230 --> 00:42:11,830
<font color="#E5E5E5">right so</font><font color="#CCCCCC"> this should illustrate</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> the</font>

1099
00:42:10,210 --> 00:42:13,800
<font color="#CCCCCC">browser's work and</font><font color="#E5E5E5"> just find everything</font>

1100
00:42:11,830 --> 00:42:16,840
seems to<font color="#E5E5E5"> be you</font><font color="#CCCCCC"> know</font><font color="#E5E5E5"> on the up and up</font>

1101
00:42:13,800 --> 00:42:18,100
<font color="#E5E5E5">but I go through and I find a dll</font><font color="#CCCCCC"> and</font>

1102
00:42:16,840 --> 00:42:21,130
it's hard to<font color="#CCCCCC"> see here but it's called</font>

1103
00:42:18,100 --> 00:42:23,460
<font color="#E5E5E5">chrome elf DLL and it's called a lot of</font>

1104
00:42:21,130 --> 00:42:26,470
times by<font color="#CCCCCC"> Chrome</font><font color="#E5E5E5"> right when it's executed</font>

1105
00:42:23,460 --> 00:42:30,370
<font color="#CCCCCC">so I'm</font><font color="#E5E5E5"> like this seems like the perfect</font>

1106
00:42:26,470 --> 00:42:31,750
perfect things so<font color="#CCCCCC"> I copy</font><font color="#E5E5E5"> the path and I</font>

1107
00:42:30,370 --> 00:42:34,540
go take a look at it in the file<font color="#E5E5E5"> and the</font>

1108
00:42:31,750 --> 00:42:36,550
folder structure and then there it is

1109
00:42:34,540 --> 00:42:40,420
<font color="#CCCCCC">alright</font><font color="#E5E5E5"> so I take a copy and I drop it</font>

1110
00:42:36,550 --> 00:42:44,710
to<font color="#E5E5E5"> the desktop and then I fire off</font>

1111
00:42:40,420 --> 00:42:47,290
<font color="#CCCCCC">shelter</font><font color="#E5E5E5"> Pro right this one I was a</font>

1112
00:42:44,710 --> 00:42:48,550
little more smart about the font<font color="#CCCCCC"> what</font>

1113
00:42:47,290 --> 00:42:51,220
we're going<font color="#CCCCCC"> to do is in operation</font><font color="#E5E5E5"> mode</font>

1114
00:42:48,550 --> 00:42:53,170
we're going<font color="#CCCCCC"> to do manual if there's a</font>

1115
00:42:51,220 --> 00:42:54,189
<font color="#E5E5E5">community version of this out there so</font>

1116
00:42:53,170 --> 00:42:57,100
if you<font color="#E5E5E5"> want to play</font><font color="#CCCCCC"> around it I highly</font>

1117
00:42:54,190 --> 00:42:58,840
<font color="#E5E5E5">recommend it I mean what's our target</font>

1118
00:42:57,100 --> 00:43:03,480
going to be so our target is<font color="#E5E5E5"> going to be</font>

1119
00:42:58,840 --> 00:43:03,480
this<font color="#CCCCCC"> DLL file so we copy the path there</font>

1120
00:43:05,550 --> 00:43:11,380
just give<font color="#CCCCCC"> those up</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so these</font>

1121
00:43:09,250 --> 00:43:13,390
are<font color="#CCCCCC"> the based on that DLL</font><font color="#E5E5E5"> what does it</font>

1122
00:43:11,380 --> 00:43:15,610
support<font color="#E5E5E5"> and we see that it supports also</font>

1123
00:43:13,390 --> 00:43:17,650
<font color="#E5E5E5">stealth and</font><font color="#CCCCCC"> multimode</font><font color="#E5E5E5"> so stealth mode</font>

1124
00:43:15,610 --> 00:43:19,720
allows it to maintain<font color="#CCCCCC"> the functionality</font>

1125
00:43:17,650 --> 00:43:21,010
of<font color="#CCCCCC"> that</font><font color="#E5E5E5"> XD or that DLL so even though I</font>

1126
00:43:19,720 --> 00:43:23,020
inject it<font color="#E5E5E5"> into it it's not going to</font>

1127
00:43:21,010 --> 00:43:24,910
<font color="#E5E5E5">break it and then multi payload allows</font>

1128
00:43:23,020 --> 00:43:26,470
payload chaining where I could have you

1129
00:43:24,910 --> 00:43:27,670
know<font color="#CCCCCC"> a bunch of</font><font color="#E5E5E5"> different shell types or</font>

1130
00:43:26,470 --> 00:43:30,430
a bunch of<font color="#E5E5E5"> different types of shell code</font>

1131
00:43:27,670 --> 00:43:31,990
try to execute<font color="#E5E5E5"> but we don't do</font><font color="#CCCCCC"> that we</font>

1132
00:43:30,430 --> 00:43:34,240
just<font color="#CCCCCC"> stick yes we want stealth mode</font><font color="#E5E5E5"> in</font>

1133
00:43:31,990 --> 00:43:37,330
this but we<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> want any</font><font color="#CCCCCC"> apple halo</font>

1134
00:43:34,240 --> 00:43:38,649
training this<font color="#E5E5E5"> is where I would define</font>

1135
00:43:37,330 --> 00:43:40,600
you know<font color="#CCCCCC"> if I want an execution data</font>

1136
00:43:38,650 --> 00:43:42,570
flow and then this is the key part these

1137
00:43:40,600 --> 00:43:45,430
<font color="#E5E5E5">are the exported functions from that DLL</font>

1138
00:43:42,570 --> 00:43:48,850
<font color="#E5E5E5">so the trick</font><font color="#CCCCCC"> is I need to find a</font>

1139
00:43:45,430 --> 00:43:50,950
function<font color="#E5E5E5"> that's used</font><font color="#CCCCCC"> and then put my</font>

1140
00:43:48,850 --> 00:43:53,049
<font color="#CCCCCC">inject into</font><font color="#E5E5E5"> that now</font><font color="#CCCCCC"> I gotta be honest</font>

1141
00:43:50,950 --> 00:43:54,609
this<font color="#E5E5E5"> part was</font><font color="#CCCCCC"> definitely trial and error</font>

1142
00:43:53,050 --> 00:43:56,550
<font color="#CCCCCC">I messed around</font><font color="#E5E5E5"> with a couple</font><font color="#CCCCCC"> different</font>

1143
00:43:54,610 --> 00:44:00,160
functions until<font color="#CCCCCC"> I</font><font color="#E5E5E5"> found one that worked</font>

1144
00:43:56,550 --> 00:44:03,490
<font color="#CCCCCC">and it was that get handle verify</font><font color="#E5E5E5"> right</font>

1145
00:44:00,160 --> 00:44:05,319
so I define<font color="#E5E5E5"> that</font><font color="#CCCCCC"> as my injection point a</font>

1146
00:44:03,490 --> 00:44:07,720
couple different<font color="#CCCCCC"> options here in terms</font>

1147
00:44:05,320 --> 00:44:09,520
<font color="#E5E5E5">of self-modifying code while tracing and</font>

1148
00:44:07,720 --> 00:44:10,419
do I want<font color="#CCCCCC"> real time tracing but now so</font>

1149
00:44:09,520 --> 00:44:12,069
at<font color="#E5E5E5"> this point</font>

1150
00:44:10,420 --> 00:44:14,470
now the tracing has begun and it's hard

1151
00:44:12,069 --> 00:44:16,029
<font color="#E5E5E5">to see up</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> but it's running through</font>

1152
00:44:14,470 --> 00:44:18,308
<font color="#E5E5E5">the instructions</font><font color="#CCCCCC"> basically what it's</font>

1153
00:44:16,030 --> 00:44:20,849
<font color="#CCCCCC">doing is running</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> DLL</font><font color="#E5E5E5"> and it's going</font>

1154
00:44:18,309 --> 00:44:24,579
<font color="#E5E5E5">to determine when my function</font><font color="#CCCCCC"> is called</font>

1155
00:44:20,849 --> 00:44:26,920
um and we're<font color="#E5E5E5"> just going to go faster</font>

1156
00:44:24,579 --> 00:44:28,150
here because this takes<font color="#E5E5E5"> a lot so I don't</font>

1157
00:44:26,920 --> 00:44:31,450
know what I was doing with<font color="#CCCCCC"> notepad here</font>

1158
00:44:28,150 --> 00:44:34,329
<font color="#E5E5E5">but I also show I think I fire off</font><font color="#CCCCCC"> oh we</font>

1159
00:44:31,450 --> 00:44:36,848
hit<font color="#E5E5E5"> around 100,000 it stops so that's</font>

1160
00:44:34,329 --> 00:44:38,619
when our<font color="#E5E5E5"> calls hit</font><font color="#CCCCCC"> but we're still doing</font>

1161
00:44:36,849 --> 00:44:40,180
the trace we're still<font color="#CCCCCC"> loading it</font><font color="#E5E5E5"> so I</font>

1162
00:44:38,619 --> 00:44:43,480
think<font color="#E5E5E5"> I want to do here is I think it's</font>

1163
00:44:40,180 --> 00:44:44,379
show yeah task manager<font color="#CCCCCC"> and this is a</font><font color="#E5E5E5"> VM</font>

1164
00:44:43,480 --> 00:44:46,660
that<font color="#E5E5E5"> it's running</font><font color="#CCCCCC"> on so obviously</font>

1165
00:44:44,380 --> 00:44:55,650
<font color="#E5E5E5">shelter</font><font color="#CCCCCC"> Pro</font><font color="#E5E5E5"> here is you know kicking his</font>

1166
00:44:46,660 --> 00:44:58,058
ass boom<font color="#CCCCCC"> alright and then now</font><font color="#E5E5E5"> it stopped</font>

1167
00:44:55,650 --> 00:45:00,160
<font color="#CCCCCC">all right so the tracing is done it</font>

1168
00:44:58,059 --> 00:45:03,339
knows how to infect this PE so what

1169
00:45:00,160 --> 00:45:04,960
payload do we want we select the payload

1170
00:45:03,339 --> 00:45:06,430
that<font color="#E5E5E5"> we've been using</font><font color="#CCCCCC"> all day the</font><font color="#E5E5E5"> HTTP</font>

1171
00:45:04,960 --> 00:45:09,460
reverse shell and<font color="#E5E5E5"> this is built</font><font color="#CCCCCC"> into</font>

1172
00:45:06,430 --> 00:45:10,990
<font color="#E5E5E5">shelter</font><font color="#CCCCCC"> Pro so</font><font color="#E5E5E5"> I didn't need to</font><font color="#CCCCCC"> -</font>

1173
00:45:09,460 --> 00:45:13,750
<font color="#CCCCCC">bringing in a shell code but that is</font>

1174
00:45:10,990 --> 00:45:16,180
also an option<font color="#E5E5E5"> now this is also key to</font>

1175
00:45:13,750 --> 00:45:18,400
<font color="#E5E5E5">here when we are</font><font color="#CCCCCC"> looking at</font><font color="#E5E5E5"> the c-sharp</font>

1176
00:45:16,180 --> 00:45:20,290
we saw that virtual allocate kind of

1177
00:45:18,400 --> 00:45:22,359
approach<font color="#CCCCCC"> to getting the shell code</font><font color="#E5E5E5"> in in</font>

1178
00:45:20,290 --> 00:45:25,000
this context<font color="#E5E5E5"> in order to maintain</font>

1179
00:45:22,359 --> 00:45:27,069
stealth mode for<font color="#E5E5E5"> a shelter</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> to do</font>

1180
00:45:25,000 --> 00:45:28,569
we utilize<font color="#CCCCCC"> this heap create heap</font>

1181
00:45:27,069 --> 00:45:30,759
allocate which I really<font color="#E5E5E5"> don't know too</font>

1182
00:45:28,569 --> 00:45:32,020
much<font color="#E5E5E5"> about but it seems like that's the</font>

1183
00:45:30,760 --> 00:45:34,119
only<font color="#CCCCCC"> one</font><font color="#E5E5E5"> that's going to</font><font color="#CCCCCC"> be allowing</font><font color="#E5E5E5"> us</font>

1184
00:45:32,020 --> 00:45:35,740
<font color="#CCCCCC">to support that stealth mode which is</font>

1185
00:45:34,119 --> 00:45:36,880
<font color="#CCCCCC">key right we</font><font color="#E5E5E5"> don't want them to</font><font color="#CCCCCC"> open the</font>

1186
00:45:35,740 --> 00:45:38,709
browser<font color="#E5E5E5"> and then have it crash</font>

1187
00:45:36,880 --> 00:45:39,910
<font color="#CCCCCC">irregardless if we get a shell back</font>

1188
00:45:38,710 --> 00:45:41,170
that's<font color="#E5E5E5"> going to raise</font><font color="#CCCCCC"> attention they're</font>

1189
00:45:39,910 --> 00:45:43,000
going to be suspicious<font color="#E5E5E5"> to that right we</font>

1190
00:45:41,170 --> 00:45:46,809
want to complete be stealth complete

1191
00:45:43,000 --> 00:45:49,270
backdoor here so we're going to<font color="#E5E5E5"> use the</font>

1192
00:45:46,809 --> 00:45:51,849
heat create you select for and then it

1193
00:45:49,270 --> 00:45:54,009
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> some options about prepending</font><font color="#CCCCCC"> a</font>

1194
00:45:51,849 --> 00:45:55,480
polymorphic<font color="#E5E5E5"> code and different types of</font>

1195
00:45:54,010 --> 00:45:57,430
encoding but<font color="#E5E5E5"> this is the key right so</font>

1196
00:45:55,480 --> 00:45:59,500
our injection<font color="#E5E5E5"> has been verified the</font>

1197
00:45:57,430 --> 00:46:01,270
payload the shell code<font color="#CCCCCC"> has injected to</font>

1198
00:45:59,500 --> 00:46:03,640
the DLL and it tested it to make sure

1199
00:46:01,270 --> 00:46:05,890
<font color="#CCCCCC">that it</font><font color="#E5E5E5"> gets executed so at this point</font>

1200
00:46:03,640 --> 00:46:10,750
that<font color="#E5E5E5"> DLL file is injected with our</font>

1201
00:46:05,890 --> 00:46:13,540
<font color="#CCCCCC">powers our payload all right so there's</font>

1202
00:46:10,750 --> 00:46:15,520
the file<font color="#CCCCCC"> and just for the purposes I</font>

1203
00:46:13,540 --> 00:46:19,630
scan it<font color="#CCCCCC"> and so even after</font><font color="#E5E5E5"> the injection</font>

1204
00:46:15,520 --> 00:46:21,790
it bypasses<font color="#E5E5E5"> the AV so all I do really</font>

1205
00:46:19,630 --> 00:46:22,790
now at this point is dump it back<font color="#CCCCCC"> into</font>

1206
00:46:21,790 --> 00:46:25,190
<font color="#E5E5E5">Google</font>

1207
00:46:22,790 --> 00:46:29,180
so the original<font color="#CCCCCC"> one I renamed it dot BK</font>

1208
00:46:25,190 --> 00:46:31,340
<font color="#E5E5E5">and then I drop this in there so now</font>

1209
00:46:29,180 --> 00:46:31,669
that my<font color="#CCCCCC"> quote-unquote malicious file is</font>

1210
00:46:31,340 --> 00:46:35,390
there

1211
00:46:31,670 --> 00:46:37,400
and then my handler for shelter is going

1212
00:46:35,390 --> 00:46:39,230
<font color="#CCCCCC">to be the same handler</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> we used</font>

1213
00:46:37,400 --> 00:46:40,760
before<font color="#E5E5E5"> and I'm also I'm still defining</font>

1214
00:46:39,230 --> 00:46:42,320
that<font color="#E5E5E5"> SSL cert right this is still the</font>

1215
00:46:40,760 --> 00:46:44,090
same host<font color="#E5E5E5"> I'm going to run into that</font>

1216
00:46:42,320 --> 00:46:49,190
<font color="#E5E5E5">problem so I need to make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that my</font>

1217
00:46:44,090 --> 00:46:50,390
handler<font color="#CCCCCC"> is uh</font><font color="#E5E5E5"> this prepared to do so so</font>

1218
00:46:49,190 --> 00:46:53,240
<font color="#E5E5E5">again I'm going to use that PEM file</font>

1219
00:46:50,390 --> 00:47:00,470
from the<font color="#E5E5E5"> auxiliary module that we used</font>

1220
00:46:53,240 --> 00:47:03,770
I start my handler<font color="#CCCCCC"> balloon</font><font color="#E5E5E5"> fires off</font>

1221
00:47:00,470 --> 00:47:06,410
there we go<font color="#CCCCCC"> it's running four</font><font color="#E5E5E5"> four four</font>

1222
00:47:03,770 --> 00:47:08,090
<font color="#E5E5E5">four three</font><font color="#CCCCCC"> and then this is again all</font>

1223
00:47:06,410 --> 00:47:12,560
<font color="#E5E5E5">they do is fire off from right so now</font>

1224
00:47:08,090 --> 00:47:14,330
the victim opens<font color="#CCCCCC"> Chrome and just to show</font>

1225
00:47:12,560 --> 00:47:16,460
<font color="#CCCCCC">that it's</font><font color="#E5E5E5"> working</font><font color="#CCCCCC"> I go to time come</font>

1226
00:47:14,330 --> 00:47:18,410
again<font color="#E5E5E5"> all right</font>

1227
00:47:16,460 --> 00:47:21,530
and this time there we go<font color="#CCCCCC"> twelve</font>

1228
00:47:18,410 --> 00:47:23,569
<font color="#CCCCCC">eighteen</font><font color="#E5E5E5"> am when I was doing this so</font><font color="#CCCCCC"> the</font>

1229
00:47:21,530 --> 00:47:27,350
browser's working like it normally<font color="#E5E5E5"> would</font>

1230
00:47:23,570 --> 00:47:28,790
<font color="#E5E5E5">but on the</font><font color="#CCCCCC"> backend</font><font color="#E5E5E5"> shells right and the</font>

1231
00:47:27,350 --> 00:47:30,350
thing<font color="#E5E5E5"> about it is when</font><font color="#CCCCCC"> you look with the</font>

1232
00:47:28,790 --> 00:47:32,930
proc<font color="#E5E5E5"> mount output you saw how many times</font>

1233
00:47:30,350 --> 00:47:34,460
it called<font color="#CCCCCC"> Chrome Elfi</font><font color="#E5E5E5"> ll so every time</font>

1234
00:47:32,930 --> 00:47:35,600
<font color="#CCCCCC">that's getting cold and</font><font color="#E5E5E5"> this possibility</font>

1235
00:47:34,460 --> 00:47:37,070
my function is running it's going to

1236
00:47:35,600 --> 00:47:38,900
make that callback<font color="#CCCCCC"> so</font><font color="#E5E5E5"> that's why you see</font>

1237
00:47:37,070 --> 00:47:44,360
<font color="#E5E5E5">multiple sessions kind of coming back</font>

1238
00:47:38,900 --> 00:47:45,350
here and then we list them the best<font color="#E5E5E5"> ones</font>

1239
00:47:44,360 --> 00:47:47,270
probably<font color="#CCCCCC"> always</font><font color="#E5E5E5"> going to be the first</font>

1240
00:47:45,350 --> 00:47:50,690
one so when we go into<font color="#E5E5E5"> that we get our</font>

1241
00:47:47,270 --> 00:47:52,220
process ID<font color="#E5E5E5"> our process ID here is 50 64</font>

1242
00:47:50,690 --> 00:47:54,770
so that's the<font color="#E5E5E5"> process ID farm</font>

1243
00:47:52,220 --> 00:47:57,709
interpreter<font color="#E5E5E5"> and then when we look at all</font>

1244
00:47:54,770 --> 00:48:01,220
the running processes in the system<font color="#CCCCCC"> we</font>

1245
00:47:57,710 --> 00:48:03,350
see 50 64 is<font color="#CCCCCC"> Chrome</font><font color="#E5E5E5"> Exe right so I'm in</font>

1246
00:48:01,220 --> 00:48:05,120
the chrome<font color="#CCCCCC"> context</font><font color="#E5E5E5"> again I'm leveraging</font>

1247
00:48:03,350 --> 00:48:11,029
a trusted application to get around that

1248
00:48:05,120 --> 00:48:12,410
<font color="#E5E5E5">bypass to deliver my payload another one</font>

1249
00:48:11,030 --> 00:48:19,970
pops off<font color="#CCCCCC"> because I think I left chrome</font>

1250
00:48:12,410 --> 00:48:22,700
<font color="#E5E5E5">open</font><font color="#CCCCCC"> in fixham seven another like I said</font>

1251
00:48:19,970 --> 00:48:25,160
<font color="#CCCCCC">I go out there</font><font color="#E5E5E5"> and support</font><font color="#CCCCCC"> this project</font>

1252
00:48:22,700 --> 00:48:27,230
<font color="#CCCCCC">it's fantastic and this is literally</font>

1253
00:48:25,160 --> 00:48:31,240
just<font color="#E5E5E5"> the tip</font><font color="#CCCCCC"> of the iceberg</font><font color="#E5E5E5"> what you can</font>

1254
00:48:27,230 --> 00:48:35,880
do with with shelter<font color="#E5E5E5"> all right</font>

1255
00:48:31,240 --> 00:48:35,879
so the last one this<font color="#E5E5E5"> is the coolest one</font>

1256
00:48:35,910 --> 00:48:44,500
Dave talked a little bit about this in

1257
00:48:39,339 --> 00:48:45,670
the keynote<font color="#CCCCCC"> this morning so</font><font color="#E5E5E5"> originally I</font>

1258
00:48:44,500 --> 00:48:49,180
was<font color="#E5E5E5"> going to you know</font><font color="#CCCCCC"> deliver this</font>

1259
00:48:45,670 --> 00:48:50,680
<font color="#E5E5E5">through a macro macro using some powers</font>

1260
00:48:49,180 --> 00:48:52,118
I was<font color="#CCCCCC"> actually going to use unicorn</font><font color="#E5E5E5"> then</font>

1261
00:48:50,680 --> 00:48:54,430
<font color="#E5E5E5">he showed this morning</font><font color="#CCCCCC"> to make</font><font color="#E5E5E5"> a</font>

1262
00:48:52,119 --> 00:48:56,550
malicious reverse<font color="#CCCCCC"> a GPS macro put that</font>

1263
00:48:54,430 --> 00:48:58,750
in a word doc and<font color="#CCCCCC"> then deliver that off</font>

1264
00:48:56,550 --> 00:49:01,420
<font color="#E5E5E5">but I got caught and I'll show you what</font>

1265
00:48:58,750 --> 00:49:03,339
I<font color="#CCCCCC"> got caught with but then</font><font color="#E5E5E5"> so I figured</font>

1266
00:49:01,420 --> 00:49:04,660
<font color="#E5E5E5">out a way how to get</font><font color="#CCCCCC"> around</font><font color="#E5E5E5"> that and I</font>

1267
00:49:03,339 --> 00:49:06,520
was still<font color="#CCCCCC"> using the macro</font><font color="#E5E5E5"> and then</font>

1268
00:49:04,660 --> 00:49:09,040
Jonathan<font color="#CCCCCC"> Lisa sent me this article on</font>

1269
00:49:06,520 --> 00:49:12,070
<font color="#E5E5E5">you know this mouse over action and I</font>

1270
00:49:09,040 --> 00:49:13,990
thought that's a<font color="#E5E5E5"> pretty dope</font><font color="#CCCCCC"> so there's</font>

1271
00:49:12,070 --> 00:49:15,430
<font color="#E5E5E5">still a click needed don't get it don't</font>

1272
00:49:13,990 --> 00:49:18,160
get<font color="#E5E5E5"> it</font><font color="#CCCCCC"> twisted you</font><font color="#E5E5E5"> still need to click</font>

1273
00:49:15,430 --> 00:49:20,830
<font color="#E5E5E5">something but into an or initiate the</font>

1274
00:49:18,160 --> 00:49:22,390
process<font color="#CCCCCC"> you literally just kind of hover</font>

1275
00:49:20,830 --> 00:49:24,460
over it and<font color="#E5E5E5"> I'll show you this this</font>

1276
00:49:22,390 --> 00:49:26,529
funky<font color="#E5E5E5"> the video gets into this this</font>

1277
00:49:24,460 --> 00:49:28,210
<font color="#E5E5E5">PowerPoint that I make and it's kind of</font>

1278
00:49:26,530 --> 00:49:30,480
evil in terms of what I do<font color="#E5E5E5"> to</font><font color="#CCCCCC"> the people</font>

1279
00:49:28,210 --> 00:49:32,680
but what<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is also</font><font color="#E5E5E5"> going to do is</font>

1280
00:49:30,480 --> 00:49:34,300
they venture this this morning<font color="#CCCCCC"> it</font>

1281
00:49:32,680 --> 00:49:36,879
leverages<font color="#CCCCCC"> that register server</font>

1282
00:49:34,300 --> 00:49:39,460
<font color="#CCCCCC">command-line utility</font><font color="#E5E5E5"> read serve 32 and</font>

1283
00:49:36,880 --> 00:49:41,619
it passes<font color="#CCCCCC"> in when he said they said this</font>

1284
00:49:39,460 --> 00:49:45,040
morning that<font color="#E5E5E5"> it's proxy where what it</font>

1285
00:49:41,619 --> 00:49:46,839
does is I can pass it<font color="#CCCCCC"> a remote file</font>

1286
00:49:45,040 --> 00:49:49,000
right so I<font color="#CCCCCC"> pass it</font><font color="#E5E5E5"> the location of a</font>

1287
00:49:46,839 --> 00:49:52,029
remote scriptlet a<font color="#CCCCCC"> common script that</font>

1288
00:49:49,000 --> 00:49:53,560
I'm<font color="#E5E5E5"> hosting and what register</font><font color="#CCCCCC"> 32 32 is</font>

1289
00:49:52,030 --> 00:49:56,200
going to do is go<font color="#CCCCCC"> out and get it</font><font color="#E5E5E5"> in</font>

1290
00:49:53,560 --> 00:49:58,359
memory and then execute that file and

1291
00:49:56,200 --> 00:50:00,339
<font color="#CCCCCC">then I inject my VB script into that s</font>

1292
00:49:58,359 --> 00:50:02,380
<font color="#CCCCCC">85</font><font color="#E5E5E5"> that's what's going to give me the</font>

1293
00:50:00,339 --> 00:50:03,970
remote code execution<font color="#E5E5E5"> what that remote</font>

1294
00:50:02,380 --> 00:50:07,720
code execution<font color="#CCCCCC"> unit is</font><font color="#E5E5E5"> going to do then</font>

1295
00:50:03,970 --> 00:50:09,250
<font color="#E5E5E5">is going to it goes from vilest to I</font>

1296
00:50:07,720 --> 00:50:11,759
create a file and<font color="#CCCCCC"> basically what I do</font><font color="#E5E5E5"> is</font>

1297
00:50:09,250 --> 00:50:15,430
I create<font color="#E5E5E5"> a c-sharp file on the host I</font>

1298
00:50:11,760 --> 00:50:17,800
compile<font color="#CCCCCC"> it with CSC exe in a manner</font>

1299
00:50:15,430 --> 00:50:20,919
which install util can run it right so

1300
00:50:17,800 --> 00:50:22,780
I'm still going to<font color="#E5E5E5"> hit even</font><font color="#CCCCCC"> if</font><font color="#E5E5E5"> I even if</font>

1301
00:50:20,920 --> 00:50:24,280
my hook works<font color="#E5E5E5"> and I write my file and I</font>

1302
00:50:22,780 --> 00:50:26,020
compile<font color="#CCCCCC"> it I'm still going to hit</font><font color="#E5E5E5"> that</font>

1303
00:50:24,280 --> 00:50:28,000
hey this<font color="#CCCCCC"> is in</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> trust it actually I</font>

1304
00:50:26,020 --> 00:50:30,400
don't<font color="#CCCCCC"> want to run it but</font><font color="#E5E5E5"> when I run it</font>

1305
00:50:28,000 --> 00:50:32,950
in the context of install utility<font color="#CCCCCC"> AC I</font>

1306
00:50:30,400 --> 00:50:34,420
get around that bypass<font color="#E5E5E5"> so these are two</font>

1307
00:50:32,950 --> 00:50:37,089
<font color="#CCCCCC">different kind of techniques that</font><font color="#E5E5E5"> I kind</font>

1308
00:50:34,420 --> 00:50:40,720
of put together<font color="#E5E5E5"> to get around this to</font>

1309
00:50:37,089 --> 00:50:42,820
get to get this<font color="#E5E5E5"> fish going so why did I</font>

1310
00:50:40,720 --> 00:50:47,980
just<font color="#E5E5E5"> give up on PowerShell so what</font>

1311
00:50:42,820 --> 00:50:50,050
that<font color="#CCCCCC"> unicorn</font><font color="#E5E5E5"> macro into my word doc</font><font color="#CCCCCC"> and</font>

1312
00:50:47,980 --> 00:50:52,030
<font color="#CCCCCC">IX</font><font color="#E5E5E5"> and I open the word doc and enable</font>

1313
00:50:50,050 --> 00:50:55,950
macros<font color="#CCCCCC"> this is what</font><font color="#E5E5E5"> I got hit</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> and</font>

1314
00:50:52,030 --> 00:51:00,010
it was a sonar hit<font color="#CCCCCC"> sonar dot ms-office</font>

1315
00:50:55,950 --> 00:51:02,049
<font color="#E5E5E5">IG</font><font color="#CCCCCC"> seven or something and when I looked</font>

1316
00:51:00,010 --> 00:51:04,840
into<font color="#E5E5E5"> the web page</font><font color="#CCCCCC"> it said hey this is a</font>

1317
00:51:02,050 --> 00:51:07,270
heuristic detection for<font color="#E5E5E5"> a suspicious</font>

1318
00:51:04,840 --> 00:51:08,950
process<font color="#E5E5E5"> launched by office so it didn't</font>

1319
00:51:07,270 --> 00:51:10,810
like that office was launching

1320
00:51:08,950 --> 00:51:12,520
<font color="#E5E5E5">PowerShell and it really didn't like</font>

1321
00:51:10,810 --> 00:51:14,350
<font color="#E5E5E5">that runs PowerShell launched it went to</font>

1322
00:51:12,520 --> 00:51:16,780
the network and if you see when they

1323
00:51:14,350 --> 00:51:18,520
release this<font color="#E5E5E5"> it was</font><font color="#CCCCCC"> april like the first</font>

1324
00:51:16,780 --> 00:51:20,260
week<font color="#CCCCCC"> April this year so it's like</font>

1325
00:51:18,520 --> 00:51:21,790
perfect right in the<font color="#E5E5E5"> middle when I'm</font>

1326
00:51:20,260 --> 00:51:23,500
<font color="#CCCCCC">getting</font><font color="#E5E5E5"> ready for this presentation if</font>

1327
00:51:21,790 --> 00:51:25,660
they<font color="#E5E5E5"> hate me with it so I'm like</font><font color="#CCCCCC"> okay</font>

1328
00:51:23,500 --> 00:51:27,370
<font color="#E5E5E5">but you know I</font><font color="#CCCCCC"> think that's</font><font color="#E5E5E5"> the benefit</font>

1329
00:51:25,660 --> 00:51:29,440
<font color="#E5E5E5">of this</font><font color="#CCCCCC"> is like when I hit those</font>

1330
00:51:27,370 --> 00:51:30,759
Brooklyn on walls<font color="#CCCCCC"> I had to think of</font><font color="#E5E5E5"> new</font>

1331
00:51:29,440 --> 00:51:31,960
ways to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> around and stuff like that</font>

1332
00:51:30,760 --> 00:51:33,190
<font color="#E5E5E5">and it really opened my eyes to</font>

1333
00:51:31,960 --> 00:51:35,230
different techniques that<font color="#CCCCCC"> are</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> there</font>

1334
00:51:33,190 --> 00:51:37,270
<font color="#E5E5E5">so Dave mentioned this morning to</font>

1335
00:51:35,230 --> 00:51:38,620
changing<font color="#E5E5E5"> PowerShell</font><font color="#CCCCCC"> taxi</font><font color="#E5E5E5"> to like move</font>

1336
00:51:37,270 --> 00:51:40,900
down<font color="#E5E5E5"> actually that might have worked in</font>

1337
00:51:38,620 --> 00:51:43,330
this case<font color="#CCCCCC"> I didn't think of that so I</font>

1338
00:51:40,900 --> 00:51:45,310
figured out like how<font color="#CCCCCC"> can I get around</font>

1339
00:51:43,330 --> 00:51:46,690
<font color="#E5E5E5">this so I went digging on the</font><font color="#CCCCCC"> internet</font>

1340
00:51:45,310 --> 00:51:50,259
and that's when I came<font color="#E5E5E5"> across this post</font>

1341
00:51:46,690 --> 00:51:51,880
from Casey Smith of<font color="#E5E5E5"> sub T from April of</font>

1342
00:51:50,260 --> 00:51:54,310
this year and<font color="#CCCCCC"> really have a bypass</font>

1343
00:51:51,880 --> 00:51:57,580
application whitelisting<font color="#E5E5E5"> using register</font>

1344
00:51:54,310 --> 00:51:59,380
32<font color="#E5E5E5"> so this is the command right this is</font>

1345
00:51:57,580 --> 00:52:02,170
going<font color="#E5E5E5"> to be my hook this is what I'll</font>

1346
00:51:59,380 --> 00:52:04,000
put into my PowerShell file when they

1347
00:52:02,170 --> 00:52:05,500
hover over<font color="#CCCCCC"> it it's</font><font color="#E5E5E5"> going to run this</font>

1348
00:52:04,000 --> 00:52:08,410
command and what this<font color="#E5E5E5"> command is going</font>

1349
00:52:05,500 --> 00:52:10,960
to do is cause the unregister action for

1350
00:52:08,410 --> 00:52:13,270
this malicious<font color="#CCCCCC"> FCT file which is</font><font color="#E5E5E5"> sitting</font>

1351
00:52:10,960 --> 00:52:14,830
on<font color="#E5E5E5"> my Kalibak and then the script</font>

1352
00:52:13,270 --> 00:52:16,870
<font color="#CCCCCC">dodging</font><font color="#E5E5E5"> via dll is going to run it</font><font color="#CCCCCC"> so</font>

1353
00:52:14,830 --> 00:52:20,529
what that<font color="#CCCCCC"> ftp file is going to contain</font>

1354
00:52:16,870 --> 00:52:22,720
is my payload<font color="#E5E5E5"> so here's what the SCP</font>

1355
00:52:20,530 --> 00:52:24,910
file<font color="#E5E5E5"> would</font><font color="#CCCCCC"> look like this is actually in</font>

1356
00:52:22,720 --> 00:52:27,430
<font color="#E5E5E5">the registration tags that's what's</font>

1357
00:52:24,910 --> 00:52:28,930
going to execute<font color="#E5E5E5"> the</font><font color="#CCCCCC"> year code I you</font>

1358
00:52:27,430 --> 00:52:31,960
know and it actually<font color="#E5E5E5"> looks</font><font color="#CCCCCC"> very similar</font>

1359
00:52:28,930 --> 00:52:33,850
to a<font color="#E5E5E5"> macro here right we create a script</font>

1360
00:52:31,960 --> 00:52:35,500
shell object and then I run my<font color="#CCCCCC"> power</font>

1361
00:52:33,850 --> 00:52:37,330
<font color="#CCCCCC">Sean there's a bunch of stuff behind</font>

1362
00:52:35,500 --> 00:52:39,070
<font color="#E5E5E5">this will see in the video of what</font><font color="#CCCCCC"> that</font>

1363
00:52:37,330 --> 00:52:40,600
payload looks like and if you were

1364
00:52:39,070 --> 00:52:42,490
<font color="#CCCCCC">looking at if they were trying to</font><font color="#E5E5E5"> alert</font>

1365
00:52:40,600 --> 00:52:45,250
to PowerShell commands that are over

1366
00:52:42,490 --> 00:52:47,109
like 255 characters this technique would

1367
00:52:45,250 --> 00:52:50,260
definitely fall into that so<font color="#E5E5E5"> the</font>

1368
00:52:47,110 --> 00:52:52,690
lifespan of this potential attack

1369
00:52:50,260 --> 00:52:54,010
technique is probably<font color="#CCCCCC"> very short but</font>

1370
00:52:52,690 --> 00:52:55,119
<font color="#E5E5E5">that's what that</font><font color="#CCCCCC"> xct file would look</font>

1371
00:52:54,010 --> 00:52:57,219
like so the

1372
00:52:55,119 --> 00:52:59,650
victim host is<font color="#E5E5E5"> going to go load that in</font>

1373
00:52:57,219 --> 00:53:02,619
in memory and then execute my<font color="#E5E5E5"> PowerShell</font>

1374
00:52:59,650 --> 00:53:04,799
here but I<font color="#E5E5E5"> already told you that the in</font>

1375
00:53:02,619 --> 00:53:07,989
the context that I was hitting<font color="#E5E5E5"> that up</font>

1376
00:53:04,799 --> 00:53:10,029
that<font color="#E5E5E5"> AV Tex that sonar catch so my</font>

1377
00:53:07,989 --> 00:53:12,160
<font color="#CCCCCC">PowerShell here can't</font><font color="#E5E5E5"> be my connection</font>

1378
00:53:10,029 --> 00:53:13,749
back<font color="#E5E5E5"> how can i leverage PowerShell to</font>

1379
00:53:12,160 --> 00:53:15,819
<font color="#E5E5E5">get around that connection so that's</font>

1380
00:53:13,749 --> 00:53:17,919
when again into this technique<font color="#CCCCCC"> right so</font>

1381
00:53:15,819 --> 00:53:20,829
another guy coming<font color="#CCCCCC"> out of Black Hills</font>

1382
00:53:17,920 --> 00:53:23,739
InfoSec Brian<font color="#E5E5E5"> Furman wrote this</font><font color="#CCCCCC"> I think</font>

1383
00:53:20,829 --> 00:53:26,229
<font color="#CCCCCC">this</font><font color="#E5E5E5"> is last year</font><font color="#CCCCCC"> of how to bypass</font><font color="#E5E5E5"> a</font>

1384
00:53:23,739 --> 00:53:28,749
application whitelisting<font color="#E5E5E5"> a</font><font color="#CCCCCC"> navy and what</font>

1385
00:53:26,229 --> 00:53:31,269
they say<font color="#CCCCCC"> is leveraging these executables</font>

1386
00:53:28,749 --> 00:53:33,098
CSC<font color="#E5E5E5"> exe which allows us to compile</font>

1387
00:53:31,269 --> 00:53:36,910
c-sharp code on the command<font color="#CCCCCC"> line</font><font color="#E5E5E5"> and</font>

1388
00:53:33,099 --> 00:53:39,130
then install<font color="#CCCCCC"> utility AC to execute our</font>

1389
00:53:36,910 --> 00:53:41,200
executable<font color="#E5E5E5"> so really what my PowerShell</font>

1390
00:53:39,130 --> 00:53:43,930
is going to do is determine<font color="#CCCCCC"> the location</font>

1391
00:53:41,200 --> 00:53:47,348
paths<font color="#E5E5E5"> of these files generate that</font>

1392
00:53:43,930 --> 00:53:49,239
c-sharp file compile it and the C<font color="#E5E5E5"> sharp</font>

1393
00:53:47,349 --> 00:53:51,069
is written in such a manner that when

1394
00:53:49,239 --> 00:53:53,079
it's run in the<font color="#E5E5E5"> context of install util</font>

1395
00:53:51,069 --> 00:53:55,029
dot exe<font color="#E5E5E5"> it understands it and really</font>

1396
00:53:53,079 --> 00:53:57,369
what that<font color="#CCCCCC"> means is there's an uninstall</font>

1397
00:53:55,029 --> 00:54:00,700
function in my c-sharp<font color="#E5E5E5"> and that runs my</font>

1398
00:53:57,369 --> 00:54:03,009
<font color="#CCCCCC">shellcode so more from those together</font>

1399
00:54:00,700 --> 00:54:04,538
and then<font color="#CCCCCC"> finally this is</font><font color="#E5E5E5"> the article</font>

1400
00:54:03,009 --> 00:54:06,219
<font color="#CCCCCC">that they send in terms of</font><font color="#E5E5E5"> this</font>

1401
00:54:04,539 --> 00:54:07,690
<font color="#CCCCCC">mouse-over technique relying on users</font>

1402
00:54:06,219 --> 00:54:09,999
just<font color="#E5E5E5"> hovering over the</font><font color="#CCCCCC"> hyperlink text</font>

1403
00:54:07,690 --> 00:54:11,710
and images and then to drop the<font color="#E5E5E5"> trojan</font>

1404
00:54:09,999 --> 00:54:14,019
or<font color="#E5E5E5"> in our case our meterpreter payload</font>

1405
00:54:11,710 --> 00:54:16,059
<font color="#CCCCCC">ste the users still need to enable</font><font color="#E5E5E5"> the</font>

1406
00:54:14,019 --> 00:54:18,189
content right so if you've<font color="#E5E5E5"> ever you know</font>

1407
00:54:16,059 --> 00:54:19,839
<font color="#E5E5E5">done some testing in your</font><font color="#CCCCCC"> own lab or</font>

1408
00:54:18,190 --> 00:54:21,460
something<font color="#CCCCCC"> then you get that hey enable</font>

1409
00:54:19,839 --> 00:54:22,690
macros button at the top of<font color="#E5E5E5"> word doc you</font>

1410
00:54:21,460 --> 00:54:25,150
got<font color="#E5E5E5"> to hit that in order for things to</font>

1411
00:54:22,690 --> 00:54:26,529
pop off in this context you'll see a

1412
00:54:25,150 --> 00:54:29,529
little<font color="#E5E5E5"> it's kind</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> actually a little</font>

1413
00:54:26,529 --> 00:54:31,539
<font color="#E5E5E5">scarier message but um there's always</font>

1414
00:54:29,529 --> 00:54:33,069
going<font color="#E5E5E5"> to love this not always but in</font>

1415
00:54:31,539 --> 00:54:35,170
this context is there's going to be a

1416
00:54:33,069 --> 00:54:38,079
quick needed<font color="#E5E5E5"> but once they do click</font>

1417
00:54:35,170 --> 00:54:39,460
<font color="#E5E5E5">right we get our shell back and when we</font>

1418
00:54:38,079 --> 00:54:41,499
<font color="#E5E5E5">look</font><font color="#CCCCCC"> at the context similar to how we</font>

1419
00:54:39,460 --> 00:54:43,390
<font color="#E5E5E5">were looking before now I'm running</font>

1420
00:54:41,499 --> 00:54:46,359
under the context of install util dot

1421
00:54:43,390 --> 00:54:50,410
exe<font color="#E5E5E5"> so at the end of the day all three</font>

1422
00:54:46,359 --> 00:54:53,380
scenarios<font color="#E5E5E5"> standalone XE the shelter I</font>

1423
00:54:50,410 --> 00:54:55,538
was never running under my<font color="#E5E5E5"> custom like</font>

1424
00:54:53,380 --> 00:54:59,219
<font color="#CCCCCC">jarred dot exe</font><font color="#E5E5E5"> it was always under</font>

1425
00:54:55,539 --> 00:55:01,539
something trusted<font color="#E5E5E5"> or something you know</font>

1426
00:54:59,219 --> 00:55:03,160
something<font color="#E5E5E5"> that the system doesn't mark</font>

1427
00:55:01,539 --> 00:55:04,029
as suspicious<font color="#CCCCCC"> or one thing hey this is</font>

1428
00:55:03,160 --> 00:55:06,368
<font color="#CCCCCC">my</font><font color="#E5E5E5"> behavior</font>

1429
00:55:04,029 --> 00:55:08,280
so this<font color="#E5E5E5"> video I</font><font color="#CCCCCC"> just made yesterday</font><font color="#E5E5E5"> and</font>

1430
00:55:06,369 --> 00:55:11,820
actually<font color="#CCCCCC"> it's a little</font><font color="#E5E5E5"> better</font>

1431
00:55:08,280 --> 00:55:13,590
as<font color="#E5E5E5"> I upgraded like the size font and</font>

1432
00:55:11,820 --> 00:55:16,890
stuff<font color="#E5E5E5"> a little so hopefully it's a</font>

1433
00:55:13,590 --> 00:55:19,380
<font color="#CCCCCC">little easier for</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> guys</font><font color="#E5E5E5"> alright let's</font>

1434
00:55:16,890 --> 00:55:20,970
get<font color="#E5E5E5"> into</font><font color="#CCCCCC"> it now I</font><font color="#E5E5E5"> get a Q in mind</font><font color="#CCCCCC"> I</font>

1435
00:55:19,380 --> 00:55:22,800
didn't think I'd have<font color="#E5E5E5"> to do the</font><font color="#CCCCCC"> video</font>

1436
00:55:20,970 --> 00:55:24,450
stuff<font color="#CCCCCC"> right I was hoping for the demo so</font>

1437
00:55:22,800 --> 00:55:25,560
I got these weird<font color="#E5E5E5"> little</font><font color="#CCCCCC"> alpha track</font><font color="#E5E5E5"> but</font>

1438
00:55:24,450 --> 00:55:27,569
we're going<font color="#E5E5E5"> to get that remote code</font>

1439
00:55:25,560 --> 00:55:30,810
execution via the comm<font color="#E5E5E5"> script</font><font color="#CCCCCC"> loop right</font>

1440
00:55:27,570 --> 00:55:33,360
so we host comm script file on our<font color="#CCCCCC"> web</font>

1441
00:55:30,810 --> 00:55:35,210
server<font color="#E5E5E5"> on our</font><font color="#CCCCCC"> Kali box</font><font color="#E5E5E5"> so we take a look</font>

1442
00:55:33,360 --> 00:55:39,210
at what<font color="#E5E5E5"> that</font><font color="#CCCCCC"> looks like</font>

1443
00:55:35,210 --> 00:55:42,150
<font color="#CCCCCC">do boom</font>

1444
00:55:39,210 --> 00:55:44,510
so here is<font color="#CCCCCC"> the script of</font><font color="#E5E5E5"> file and like I</font>

1445
00:55:42,150 --> 00:55:46,590
<font color="#E5E5E5">mentioned within the registration tag is</font>

1446
00:55:44,510 --> 00:55:48,750
where we're going<font color="#CCCCCC"> to run our PowerShell</font>

1447
00:55:46,590 --> 00:55:50,190
<font color="#E5E5E5">so here is our little Phoebe script we</font>

1448
00:55:48,750 --> 00:55:52,110
create our script shell and then here's

1449
00:55:50,190 --> 00:55:53,250
our<font color="#CCCCCC"> Power Cell ignore this one this is</font>

1450
00:55:52,110 --> 00:55:55,320
<font color="#CCCCCC">actually in case anybody's wondering</font>

1451
00:55:53,250 --> 00:55:57,920
this<font color="#E5E5E5"> is a command</font><font color="#CCCCCC"> line how to delete</font>

1452
00:55:55,320 --> 00:56:01,110
somebody's internet history<font color="#E5E5E5"> from</font><font color="#CCCCCC"> I if</font>

1453
00:55:57,920 --> 00:56:04,950
that's of any interest<font color="#CCCCCC"> but what it found</font>

1454
00:56:01,110 --> 00:56:06,270
was if if I ran this multiple<font color="#E5E5E5"> times</font><font color="#CCCCCC"> I</font>

1455
00:56:04,950 --> 00:56:09,450
was like how come it stopped calling

1456
00:56:06,270 --> 00:56:11,970
back for component that<font color="#CCCCCC"> SCT and it</font>

1457
00:56:09,450 --> 00:56:13,439
caches it right so if you're testing and

1458
00:56:11,970 --> 00:56:14,970
you make some<font color="#CCCCCC"> changes to your SCT file</font>

1459
00:56:13,440 --> 00:56:16,380
and you run it again<font color="#E5E5E5"> you're like that</font>

1460
00:56:14,970 --> 00:56:17,939
doesn't seem right<font color="#E5E5E5"> make sure it's not</font>

1461
00:56:16,380 --> 00:56:20,760
caching it and delete<font color="#E5E5E5"> those that</font>

1462
00:56:17,940 --> 00:56:22,410
internet history<font color="#E5E5E5"> but here is really what</font>

1463
00:56:20,760 --> 00:56:23,550
<font color="#E5E5E5">it's going</font><font color="#CCCCCC"> to execute or run this</font>

1464
00:56:22,410 --> 00:56:27,569
command and here's our command this

1465
00:56:23,550 --> 00:56:31,860
<font color="#CCCCCC">powershell</font><font color="#E5E5E5"> base64 blob of data and it's</font>

1466
00:56:27,570 --> 00:56:33,870
gigantic right so if they were flagging

1467
00:56:31,860 --> 00:56:37,230
<font color="#E5E5E5">on PowerShell commands that are large</font>

1468
00:56:33,870 --> 00:56:39,720
this would<font color="#CCCCCC"> definitely fall into that so</font>

1469
00:56:37,230 --> 00:56:41,910
what exactly is that PowerShell payload

1470
00:56:39,720 --> 00:56:43,620
doing we take a look<font color="#CCCCCC"> at that</font><font color="#E5E5E5"> file so</font>

1471
00:56:41,910 --> 00:56:45,509
<font color="#E5E5E5">really the</font><font color="#CCCCCC"> first step</font><font color="#E5E5E5"> I need to</font>

1472
00:56:43,620 --> 00:56:49,200
<font color="#CCCCCC">determine what are the path locations</font>

1473
00:56:45,510 --> 00:56:51,540
for CSC<font color="#CCCCCC"> exe</font><font color="#E5E5E5"> and install util dot exe if</font>

1474
00:56:49,200 --> 00:56:53,430
they don't<font color="#E5E5E5"> exist</font><font color="#CCCCCC"> on the target that I'm</font>

1475
00:56:51,540 --> 00:56:55,259
going after this technique will not work

1476
00:56:53,430 --> 00:56:57,660
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so what I do is I use a little</font>

1477
00:56:55,260 --> 00:56:59,730
<font color="#E5E5E5">PowerShell to enumerate the registry and</font>

1478
00:56:57,660 --> 00:57:01,950
I go and recursively go<font color="#E5E5E5"> through the</font>

1479
00:56:59,730 --> 00:57:04,230
registry under the dotnet<font color="#E5E5E5"> framework kind</font>

1480
00:57:01,950 --> 00:57:06,060
of location<font color="#CCCCCC"> and then I kind of generate</font>

1481
00:57:04,230 --> 00:57:09,770
an array of different<font color="#E5E5E5"> path locations and</font>

1482
00:57:06,060 --> 00:57:12,750
then I append in all that good stuff<font color="#CCCCCC"> but</font>

1483
00:57:09,770 --> 00:57:17,070
<font color="#CCCCCC">so now I know every</font><font color="#E5E5E5"> place that install</font>

1484
00:57:12,750 --> 00:57:18,850
util is<font color="#E5E5E5"> there's a ballot path</font><font color="#CCCCCC"> - and what</font>

1485
00:57:17,070 --> 00:57:21,220
I do is I<font color="#E5E5E5"> then test</font>

1486
00:57:18,850 --> 00:57:23,140
<font color="#CCCCCC">if I see hey does this file exists</font>

1487
00:57:21,220 --> 00:57:25,569
<font color="#CCCCCC">already this program dot</font><font color="#E5E5E5"> CS and programs</font>

1488
00:57:23,140 --> 00:57:27,310
<font color="#CCCCCC">exe</font><font color="#E5E5E5"> which I'm going to create and if so</font>

1489
00:57:25,570 --> 00:57:29,290
delete it so it's a fresh start each

1490
00:57:27,310 --> 00:57:31,210
time but the key is here is this

1491
00:57:29,290 --> 00:57:33,730
environment variable we<font color="#CCCCCC"> already know</font>

1492
00:57:31,210 --> 00:57:35,410
that<font color="#E5E5E5"> writing to</font><font color="#CCCCCC"> app app</font><font color="#E5E5E5"> data local is</font>

1493
00:57:33,730 --> 00:57:36,880
going to get flagged as suspicious<font color="#CCCCCC"> so</font>

1494
00:57:35,410 --> 00:57:39,040
here I'm literally just<font color="#E5E5E5"> writing</font><font color="#CCCCCC"> into the</font>

1495
00:57:36,880 --> 00:57:43,510
<font color="#CCCCCC">user's pictures directory and they</font>

1496
00:57:39,040 --> 00:57:45,370
didn't have any problem<font color="#CCCCCC"> with that</font><font color="#E5E5E5"> so all</font>

1497
00:57:43,510 --> 00:57:47,560
<font color="#E5E5E5">right so I create the file and then all</font>

1498
00:57:45,370 --> 00:57:50,830
these PowerShell commands<font color="#E5E5E5"> write this</font>

1499
00:57:47,560 --> 00:57:53,740
write<font color="#CCCCCC"> output is just creating</font><font color="#E5E5E5"> this</font>

1500
00:57:50,830 --> 00:57:55,299
<font color="#CCCCCC">c-sharp file program dot C yes right so</font>

1501
00:57:53,740 --> 00:57:56,680
let's write<font color="#E5E5E5"> this V out file right this</font>

1502
00:57:55,300 --> 00:57:59,230
<font color="#E5E5E5">is the out file</font><font color="#CCCCCC"> write this to</font><font color="#E5E5E5"> the out</font>

1503
00:57:56,680 --> 00:58:01,180
file and the key is here is I'm<font color="#E5E5E5"> writing</font>

1504
00:57:59,230 --> 00:58:03,880
it in<font color="#E5E5E5"> a context</font><font color="#CCCCCC"> that install</font><font color="#E5E5E5"> utility</font>

1505
00:58:01,180 --> 00:58:05,620
<font color="#CCCCCC">idfc can work with and we see we are</font>

1506
00:58:03,880 --> 00:58:07,900
using<font color="#E5E5E5"> the system configuration install</font>

1507
00:58:05,620 --> 00:58:10,660
<font color="#E5E5E5">installer here and then this is the key</font>

1508
00:58:07,900 --> 00:58:12,700
we<font color="#E5E5E5"> have that uninstall function what</font>

1509
00:58:10,660 --> 00:58:15,190
uninstalled does is it called<font color="#CCCCCC"> shellcode</font>

1510
00:58:12,700 --> 00:58:19,600
exact and then<font color="#CCCCCC"> shellcode that exact is</font>

1511
00:58:15,190 --> 00:58:20,830
where<font color="#CCCCCC"> our payload is and I think all I</font>

1512
00:58:19,600 --> 00:58:22,480
do<font color="#E5E5E5"> for the</font><font color="#CCCCCC"> remainder is just kind of</font>

1513
00:58:20,830 --> 00:58:25,630
highlight that<font color="#E5E5E5"> stuff like oh yeah this</font>

1514
00:58:22,480 --> 00:58:28,240
<font color="#CCCCCC">is key the</font><font color="#E5E5E5"> payload is the same payload</font>

1515
00:58:25,630 --> 00:58:29,860
<font color="#E5E5E5">that we</font><font color="#CCCCCC"> used and instead of</font><font color="#E5E5E5"> having to do</font>

1516
00:58:28,240 --> 00:58:31,330
this in a remote process like inject

1517
00:58:29,860 --> 00:58:32,950
<font color="#E5E5E5">since I'm going to be running on an</font>

1518
00:58:31,330 --> 00:58:35,860
install util<font color="#E5E5E5"> I can just kind of do a</font>

1519
00:58:32,950 --> 00:58:36,339
standard virtual allocation for for

1520
00:58:35,860 --> 00:58:38,530
doing<font color="#CCCCCC"> this</font>

1521
00:58:36,340 --> 00:58:40,540
so we allocate the<font color="#E5E5E5"> memory we create our</font>

1522
00:58:38,530 --> 00:58:44,230
thread and<font color="#E5E5E5"> then execute</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> wait for the</font>

1523
00:58:40,540 --> 00:58:46,509
<font color="#E5E5E5">callback to see that it's done</font><font color="#CCCCCC"> and then</font>

1524
00:58:44,230 --> 00:58:48,430
right here<font color="#CCCCCC"> so the last</font><font color="#E5E5E5"> part is I say I</font>

1525
00:58:46,510 --> 00:58:50,980
hit<font color="#CCCCCC"> a</font><font color="#E5E5E5"> rate through my array of path</font>

1526
00:58:48,430 --> 00:58:54,370
locations<font color="#E5E5E5"> and here is this command I'm</font>

1527
00:58:50,980 --> 00:58:58,390
building the<font color="#CCCCCC"> xing from the program cs</font>

1528
00:58:54,370 --> 00:59:01,290
that I wrote with using<font color="#CCCCCC"> C SDXC and then</font>

1529
00:58:58,390 --> 00:59:05,069
<font color="#E5E5E5">I invoking expression command there</font>

1530
00:59:01,290 --> 00:59:07,720
fantastic<font color="#CCCCCC"> and then once that's built</font>

1531
00:59:05,070 --> 00:59:11,350
make it this other way<font color="#E5E5E5"> once that's built</font>

1532
00:59:07,720 --> 00:59:13,600
I use the install<font color="#CCCCCC"> UFC pass and this U is</font>

1533
00:59:11,350 --> 00:59:15,220
why we put the uninstall function in

1534
00:59:13,600 --> 00:59:17,049
there<font color="#E5E5E5"> it's basically saying uninstall</font>

1535
00:59:15,220 --> 00:59:18,669
this<font color="#CCCCCC"> Xing all right so when it goes in</font>

1536
00:59:17,050 --> 00:59:20,330
it calls that<font color="#E5E5E5"> uninstall function I'm</font>

1537
00:59:18,670 --> 00:59:24,300
going<font color="#CCCCCC"> to run my shelter</font>

1538
00:59:20,330 --> 00:59:27,640
[Music]

1539
00:59:24,300 --> 00:59:30,640
<font color="#E5E5E5">all right</font><font color="#CCCCCC"> well</font><font color="#E5E5E5"> so those are the big</font>

1540
00:59:27,640 --> 00:59:31,930
files that are really<font color="#E5E5E5"> that the one that</font>

1541
00:59:30,640 --> 00:59:34,240
shows the<font color="#CCCCCC"> PowerShell doesn't come into</font>

1542
00:59:31,930 --> 00:59:36,270
<font color="#E5E5E5">play</font><font color="#CCCCCC"> here I just took that base64</font>

1543
00:59:34,240 --> 00:59:38,680
<font color="#CCCCCC">encoded it and then put</font><font color="#E5E5E5"> it in</font><font color="#CCCCCC"> the sec</font>

1544
00:59:36,270 --> 00:59:43,200
<font color="#CCCCCC">again we're going to use that SSL cert</font>

1545
00:59:38,680 --> 00:59:45,930
that we use to get around<font color="#E5E5E5"> the IPS attack</font>

1546
00:59:43,200 --> 00:59:49,270
but I'm also going to show the call to

1547
00:59:45,930 --> 00:59:52,450
the component file so I just tailed the

1548
00:59:49,270 --> 00:59:56,200
Apache access<font color="#E5E5E5"> lock right so right now on</font>

1549
00:59:52,450 --> 00:59:57,879
my c2 server<font color="#E5E5E5"> I'm just watching the</font>

1550
00:59:56,200 --> 01:00:00,009
access lock to see the call for

1551
00:59:57,880 --> 01:00:02,920
component<font color="#CCCCCC"> FCT and then this</font><font color="#E5E5E5"> is my</font>

1552
01:00:00,010 --> 01:00:05,609
handler<font color="#E5E5E5"> to when I get my call back from</font>

1553
01:00:02,920 --> 01:00:08,410
<font color="#E5E5E5">them from</font><font color="#CCCCCC"> the rotor</font><font color="#E5E5E5"> Berger payload</font>

1554
01:00:05,609 --> 01:00:10,390
<font color="#CCCCCC">alright so now we're on my malicious</font>

1555
01:00:08,410 --> 01:00:12,730
Windows 10 machine right so we start<font color="#CCCCCC"> our</font>

1556
01:00:10,390 --> 01:00:14,440
<font color="#CCCCCC">power point let</font><font color="#E5E5E5"> me</font><font color="#CCCCCC"> up</font>

1557
01:00:12,730 --> 01:00:16,270
we don't have to do this in<font color="#E5E5E5"> fast</font><font color="#CCCCCC"> beta</font>

1558
01:00:14,440 --> 01:00:18,790
<font color="#E5E5E5">this one here so I basically make a</font>

1559
01:00:16,270 --> 01:00:21,790
presentation<font color="#CCCCCC"> I kill the first slide and</font>

1560
01:00:18,790 --> 01:00:24,550
then I just write some generic kind<font color="#E5E5E5"> of</font>

1561
01:00:21,790 --> 01:00:29,920
<font color="#E5E5E5">fish message which I thought would be</font>

1562
01:00:24,550 --> 01:00:32,859
<font color="#CCCCCC">appropriate or</font><font color="#E5E5E5"> not so click enable from</font>

1563
01:00:29,920 --> 01:00:35,859
the<font color="#E5E5E5"> dialog prompt below that's something</font>

1564
01:00:32,859 --> 01:00:38,170
<font color="#E5E5E5">that it would be you know instructing</font>

1565
01:00:35,859 --> 01:00:40,180
the user to do something<font color="#E5E5E5"> so instead of</font>

1566
01:00:38,170 --> 01:00:42,640
having<font color="#E5E5E5"> a hyperlink or text what I did</font>

1567
01:00:40,180 --> 01:00:45,190
was I<font color="#E5E5E5"> took a</font><font color="#CCCCCC"> screen shot of what that</font>

1568
01:00:42,640 --> 01:00:47,020
<font color="#CCCCCC">message looks like so when they get</font><font color="#E5E5E5"> hit</font>

1569
01:00:45,190 --> 01:00:49,510
with the message<font color="#E5E5E5"> that's what the prompt</font>

1570
01:00:47,020 --> 01:00:51,550
is so I make the prompt all big<font color="#CCCCCC"> and I</font>

1571
01:00:49,510 --> 01:00:53,770
put a nice green box<font color="#E5E5E5"> around the word</font>

1572
01:00:51,550 --> 01:00:56,710
<font color="#CCCCCC">enable to really drive home</font><font color="#E5E5E5"> hey this</font>

1573
01:00:53,770 --> 01:00:58,780
button is legit you can click it but

1574
01:00:56,710 --> 01:01:01,900
this<font color="#E5E5E5"> is where the cool part comes in so</font>

1575
01:00:58,780 --> 01:01:04,060
two things first<font color="#CCCCCC"> I save this as a PDF</font>

1576
01:01:01,900 --> 01:01:07,030
file<font color="#CCCCCC"> does anybody know</font><font color="#E5E5E5"> what what's</font>

1577
01:01:04,060 --> 01:01:09,040
<font color="#E5E5E5">different in a PDF file basically</font><font color="#CCCCCC"> a PPS</font>

1578
01:01:07,030 --> 01:01:11,500
file just<font color="#E5E5E5"> open straight</font><font color="#CCCCCC"> to presentation</font>

1579
01:01:09,040 --> 01:01:13,330
right so<font color="#CCCCCC"> I'm opening to edit mode it</font>

1580
01:01:11,500 --> 01:01:14,410
will just open<font color="#CCCCCC"> like you like I'm</font>

1581
01:01:13,330 --> 01:01:18,009
standing<font color="#E5E5E5"> up here</font><font color="#CCCCCC"> and I'm showing my</font>

1582
01:01:14,410 --> 01:01:20,440
slides no<font color="#CCCCCC"> no I think I can name it any</font>

1583
01:01:18,010 --> 01:01:22,660
<font color="#CCCCCC">time</font><font color="#E5E5E5"> so right now I have</font><font color="#CCCCCC"> the face right</font>

1584
01:01:20,440 --> 01:01:24,940
<font color="#E5E5E5">so now I need</font><font color="#CCCCCC"> to put the hover over</font>

1585
01:01:22,660 --> 01:01:27,609
action<font color="#E5E5E5"> in and what I use</font><font color="#CCCCCC"> to do that are</font>

1586
01:01:24,940 --> 01:01:29,619
these<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> called action buttons down</font>

1587
01:01:27,609 --> 01:01:31,598
here<font color="#CCCCCC"> at the bottom right so instead of</font>

1588
01:01:29,619 --> 01:01:34,270
<font color="#CCCCCC">is</font><font color="#E5E5E5"> just inserting like a shape I insert</font>

1589
01:01:31,599 --> 01:01:36,430
an action button so we take a look at

1590
01:01:34,270 --> 01:01:39,610
that<font color="#E5E5E5"> I use a custom one</font>

1591
01:01:36,430 --> 01:01:43,210
and I just drag it right<font color="#E5E5E5"> over that whole</font>

1592
01:01:39,610 --> 01:01:46,060
<font color="#E5E5E5">image right this big blue blob over it</font>

1593
01:01:43,210 --> 01:01:48,580
and then this<font color="#E5E5E5"> is key my action settings</font>

1594
01:01:46,060 --> 01:01:50,500
what can I do with that<font color="#E5E5E5"> action button</font>

1595
01:01:48,580 --> 01:01:52,060
two options<font color="#E5E5E5"> what happens when it's</font>

1596
01:01:50,500 --> 01:01:55,150
clicked<font color="#E5E5E5"> and what happens when it's you</font>

1597
01:01:52,060 --> 01:01:57,130
know<font color="#E5E5E5"> mouse over</font><font color="#CCCCCC"> you see here run macro</font>

1598
01:01:55,150 --> 01:01:58,630
and object action are disabled<font color="#E5E5E5"> usually</font>

1599
01:01:57,130 --> 01:01:59,800
there's additional<font color="#E5E5E5"> security controls or</font>

1600
01:01:58,630 --> 01:02:01,720
maybe a group<font color="#E5E5E5"> policy that's going</font><font color="#CCCCCC"> to</font>

1601
01:01:59,800 --> 01:02:06,220
prevent that<font color="#E5E5E5"> but what they don't prevent</font>

1602
01:02:01,720 --> 01:02:08,169
is one program right<font color="#E5E5E5"> so in one program</font>

1603
01:02:06,220 --> 01:02:10,720
is where I'm going to put<font color="#E5E5E5"> that</font><font color="#CCCCCC"> red serve</font>

1604
01:02:08,170 --> 01:02:13,600
<font color="#CCCCCC">thirty-two hook</font><font color="#E5E5E5"> so all I'm doing</font><font color="#CCCCCC"> here is</font>

1605
01:02:10,720 --> 01:02:17,680
just browsing<font color="#E5E5E5"> for the path speed it up a</font>

1606
01:02:13,600 --> 01:02:20,470
<font color="#CCCCCC">little bit</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so I take red serve</font><font color="#E5E5E5"> I'm</font>

1607
01:02:17,680 --> 01:02:24,580
going to run red serve but what's my

1608
01:02:20,470 --> 01:02:26,080
hook<font color="#E5E5E5"> luckily I put a little text file on</font>

1609
01:02:24,580 --> 01:02:28,750
desktop to<font color="#E5E5E5"> tell me so I didn't have to</font>

1610
01:02:26,080 --> 01:02:31,770
memorize<font color="#E5E5E5"> it but</font><font color="#CCCCCC"> that's</font><font color="#E5E5E5"> the hook</font><font color="#CCCCCC"> write</font>

1611
01:02:28,750 --> 01:02:35,290
<font color="#CCCCCC">read</font><font color="#E5E5E5"> serve</font><font color="#CCCCCC"> 30 to unregister</font>

1612
01:02:31,770 --> 01:02:38,350
<font color="#E5E5E5">this remote component SCT file and</font>

1613
01:02:35,290 --> 01:02:41,650
execute<font color="#E5E5E5"> right so that's all I needed</font>

1614
01:02:38,350 --> 01:02:48,670
I'll never done<font color="#E5E5E5"> that action so I just</font>

1615
01:02:41,650 --> 01:02:53,050
<font color="#E5E5E5">copy paste those switches over again</font>

1616
01:02:48,670 --> 01:02:55,270
component that SCT space app and now I

1617
01:02:53,050 --> 01:02:57,780
got my hook<font color="#E5E5E5"> right but who's going to</font>

1618
01:02:55,270 --> 01:03:00,130
mouse<font color="#E5E5E5"> over this this looks ugly as it</font><font color="#CCCCCC"> is</font>

1619
01:02:57,780 --> 01:03:02,770
so one<font color="#E5E5E5"> thing you can do is you can</font>

1620
01:03:00,130 --> 01:03:05,410
format the shape so I go<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> no fill</font>

1621
01:03:02,770 --> 01:03:07,960
<font color="#E5E5E5">and no line it's like</font><font color="#CCCCCC"> it's not even</font>

1622
01:03:05,410 --> 01:03:11,879
there<font color="#CCCCCC"> right so they don't even see this</font>

1623
01:03:07,960 --> 01:03:17,710
this action safe and what I do then is<font color="#CCCCCC"> I</font>

1624
01:03:11,880 --> 01:03:20,320
<font color="#E5E5E5">duplicate the slide three times now why</font>

1625
01:03:17,710 --> 01:03:22,390
did I do that when you're in a PPS view

1626
01:03:20,320 --> 01:03:25,450
to progress to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> next slide you click</font>

1627
01:03:22,390 --> 01:03:26,500
it so I figured<font color="#CCCCCC"> if they are the users</font>

1628
01:03:25,450 --> 01:03:27,819
freaking out and they're<font color="#CCCCCC"> just kind of</font>

1629
01:03:26,500 --> 01:03:29,349
<font color="#E5E5E5">clicking and clicking they're just going</font>

1630
01:03:27,820 --> 01:03:31,690
<font color="#E5E5E5">to keep</font><font color="#CCCCCC"> getting hit in hit and hit</font>

1631
01:03:29,349 --> 01:03:36,210
until they get<font color="#E5E5E5"> out of get out of the</font>

1632
01:03:31,690 --> 01:03:36,210
PowerPoint<font color="#E5E5E5"> but right now it's set to go</font>

1633
01:03:36,930 --> 01:03:42,390
yes yeah this is yeah this<font color="#E5E5E5"> is the last</font>

1634
01:03:40,180 --> 01:03:42,390
<font color="#CCCCCC">night</font>

1635
01:03:43,410 --> 01:03:49,598
we'll leave it going so I put it on<font color="#E5E5E5"> the</font>

1636
01:03:45,670 --> 01:03:55,180
share<font color="#E5E5E5"> I drop it over to the victim</font><font color="#CCCCCC"> I</font>

1637
01:03:49,599 --> 01:03:58,509
think I scan it<font color="#CCCCCC"> again</font><font color="#E5E5E5"> right so now it's</font>

1638
01:03:55,180 --> 01:04:01,299
<font color="#CCCCCC">on my Victim machine I scan it with</font>

1639
01:03:58,509 --> 01:04:04,690
Norton<font color="#E5E5E5"> everything comes</font><font color="#CCCCCC"> back clean</font>

1640
01:04:01,299 --> 01:04:06,369
fantastic now I'm at<font color="#E5E5E5"> this point nothing</font>

1641
01:04:04,690 --> 01:04:09,099
<font color="#E5E5E5">my handler hasn't gotten anything but</font>

1642
01:04:06,369 --> 01:04:11,710
when I show<font color="#E5E5E5"> it right it opens up and</font>

1643
01:04:09,099 --> 01:04:13,630
then<font color="#CCCCCC"> boom as soon</font><font color="#E5E5E5"> as they move the mouse</font>

1644
01:04:11,710 --> 01:04:15,660
a<font color="#E5E5E5"> little bit they get the prompt and</font>

1645
01:04:13,630 --> 01:04:17,829
there's the prompt with the<font color="#CCCCCC"> naval button</font>

1646
01:04:15,660 --> 01:04:19,720
the<font color="#E5E5E5"> user is like oh no what do I feel</font>

1647
01:04:17,829 --> 01:04:21,849
all the<font color="#E5E5E5"> neighborhood is that green and</font>

1648
01:04:19,720 --> 01:04:24,339
<font color="#E5E5E5">then boom they</font><font color="#CCCCCC"> Nabal it and then it runs</font>

1649
01:04:21,849 --> 01:04:26,259
right and they're still<font color="#E5E5E5"> there they're</font>

1650
01:04:24,339 --> 01:04:27,609
<font color="#E5E5E5">still not</font><font color="#CCCCCC"> out of</font><font color="#E5E5E5"> it so they're keep</font>

1651
01:04:26,259 --> 01:04:28,989
clicking and<font color="#E5E5E5"> clicking and then finally</font>

1652
01:04:27,609 --> 01:04:30,640
they get caught now every time<font color="#E5E5E5"> they</font>

1653
01:04:28,989 --> 01:04:32,650
click though<font color="#E5E5E5"> they went to that next</font>

1654
01:04:30,640 --> 01:04:34,960
<font color="#E5E5E5">slide and that</font><font color="#CCCCCC"> next</font><font color="#E5E5E5"> slide gave me</font>

1655
01:04:32,650 --> 01:04:36,489
<font color="#E5E5E5">another shell so here you see they made</font>

1656
01:04:34,960 --> 01:04:39,160
<font color="#E5E5E5">that call back out for component that</font>

1657
01:04:36,489 --> 01:04:44,109
SCT<font color="#E5E5E5"> which is fantastic</font><font color="#CCCCCC"> and then I got a</font>

1658
01:04:39,160 --> 01:04:46,930
bunch<font color="#CCCCCC"> of</font><font color="#E5E5E5"> shells and then just the one</font>

1659
01:04:44,109 --> 01:04:49,269
last thing<font color="#CCCCCC"> I want to</font><font color="#E5E5E5"> show is if</font><font color="#CCCCCC"> we</font>

1660
01:04:46,930 --> 01:04:53,399
interact with<font color="#E5E5E5"> the first session get that</font>

1661
01:04:49,269 --> 01:04:59,769
process<font color="#CCCCCC"> ID of</font><font color="#E5E5E5"> 55:36</font><font color="#CCCCCC"> and then we look in</font>

1662
01:04:53,400 --> 01:05:06,239
55:36<font color="#E5E5E5"> install util dot exe there we go</font>

1663
01:04:59,769 --> 01:05:06,238
<font color="#E5E5E5">oh that's it thank you</font>

