1
00:00:00,030 --> 00:00:03,119
yeah so you okay alright guys I'm going

2
00:00:01,890 --> 00:00:04,439
to go ahead and get started up here

3
00:00:03,120 --> 00:00:06,420
we'll play the looking for nail room

4
00:00:04,440 --> 00:00:08,639
apologies for the little technical

5
00:00:06,420 --> 00:00:12,360
delays there today I learned that you

6
00:00:08,639 --> 00:00:14,399
need to power a VGA HDMI adapter so guys

7
00:00:12,360 --> 00:00:16,020
can pick that up as well thanks for

8
00:00:14,400 --> 00:00:17,670
joining me today we're gonna be talking

9
00:00:16,020 --> 00:00:19,740
about something I'm very passionate

10
00:00:17,670 --> 00:00:21,180
about my thanks to the any kind team for

11
00:00:19,740 --> 00:00:24,509
having me here this is pretty great

12
00:00:21,180 --> 00:00:26,640
second year awesome real quickly about

13
00:00:24,510 --> 00:00:28,890
myself my name is Jake Letta I am a

14
00:00:26,640 --> 00:00:30,390
manager I work in San Francisco but I'm

15
00:00:28,890 --> 00:00:32,880
from the Capital Region so it's good to

16
00:00:30,390 --> 00:00:34,410
be back actually there's two speakers

17
00:00:32,880 --> 00:00:36,930
here from the Waynesburg new york so

18
00:00:34,410 --> 00:00:39,449
it's kind of cool I think I've been

19
00:00:36,930 --> 00:00:40,640
abandoned for seven years now I've done

20
00:00:39,450 --> 00:00:43,190
a lot of different things that maybe

21
00:00:40,640 --> 00:00:45,570
penetration testing it's a response

22
00:00:43,190 --> 00:00:48,030
teaching external education or mobility

23
00:00:45,570 --> 00:00:49,800
research all sorts of fun things but I

24
00:00:48,030 --> 00:00:52,379
really enjoy infrared as an operating

25
00:00:49,800 --> 00:00:53,879
system it's a learning platform so today

26
00:00:52,379 --> 00:00:55,589
we're going to be talking about that I

27
00:00:53,879 --> 00:00:57,570
included my twitter handle on here but

28
00:00:55,590 --> 00:00:59,969
I'm not very good at Twitter so I have a

29
00:00:57,570 --> 00:01:02,129
contact beast-like again that has more

30
00:00:59,969 --> 00:01:03,149
information on how you can reach me if

31
00:01:02,129 --> 00:01:05,570
you're interested in any things I'm

32
00:01:03,149 --> 00:01:07,979
talking about I want to learn more so

33
00:01:05,570 --> 00:01:09,360
just a quick agenda here's we're going

34
00:01:07,979 --> 00:01:11,220
to be talking about a security feature

35
00:01:09,360 --> 00:01:13,260
on the infrared call that's the Android

36
00:01:11,220 --> 00:01:15,689
we're talking about what it is what's

37
00:01:13,260 --> 00:01:17,100
doing for you in the background and then

38
00:01:15,689 --> 00:01:19,048
we're going to talk about what things

39
00:01:17,100 --> 00:01:21,390
look like before we how does the Android

40
00:01:19,049 --> 00:01:22,799
so go back three or four years and look

41
00:01:21,390 --> 00:01:25,170
at the Android ecosystem and how

42
00:01:22,799 --> 00:01:26,909
exploitation was then and then we're

43
00:01:25,170 --> 00:01:28,740
talking about some new techniques if

44
00:01:26,909 --> 00:01:30,509
let's say you're a penetration tester or

45
00:01:28,740 --> 00:01:31,890
you're doing any auditing what is the

46
00:01:30,509 --> 00:01:33,119
problem in escape look like now what do

47
00:01:31,890 --> 00:01:34,500
you what the things you need to keep in

48
00:01:33,119 --> 00:01:36,299
mind if you're actually trying to attack

49
00:01:34,500 --> 00:01:38,100
and device that it's using SEO effort

50
00:01:36,299 --> 00:01:40,259
and hopefully we have some time for

51
00:01:38,100 --> 00:01:42,089
questions and answers if not I'll get

52
00:01:40,259 --> 00:01:44,280
the conference all today and tomorrow so

53
00:01:42,090 --> 00:01:47,280
feel free to fly me down and ask me

54
00:01:44,280 --> 00:01:49,680
exciting us Android questions so just

55
00:01:47,280 --> 00:01:52,770
some of the goals and hopes and dreams

56
00:01:49,680 --> 00:01:54,600
for people in the audience first and I

57
00:01:52,770 --> 00:01:56,789
want people to understand what a scanner

58
00:01:54,600 --> 00:01:58,679
it is and you probable tip I'm gonna

59
00:01:56,790 --> 00:01:59,640
wear this on your phone it's kind of

60
00:01:58,680 --> 00:02:01,500
just running in the back

61
00:01:59,640 --> 00:02:02,820
doing good things for you but just

62
00:02:01,500 --> 00:02:05,340
understand fundamentally how it works

63
00:02:02,820 --> 00:02:07,529
and why it's there and you know what

64
00:02:05,340 --> 00:02:09,330
it's doing to secure your data and if

65
00:02:07,530 --> 00:02:10,830
this is something you find interesting

66
00:02:09,330 --> 00:02:12,000
and want to learn more about to revive

67
00:02:10,830 --> 00:02:15,000
starting point for you

68
00:02:12,000 --> 00:02:16,350
so if Lassiter penetration tester or if

69
00:02:15,000 --> 00:02:19,020
you just want to go buy a new phone and

70
00:02:16,350 --> 00:02:20,130
start auditing it one of the tools of

71
00:02:19,020 --> 00:02:21,450
techniques you're going to need to use

72
00:02:20,130 --> 00:02:23,160
to actually get started

73
00:02:21,450 --> 00:02:24,810
now the last one is kind of

74
00:02:23,160 --> 00:02:26,250
tongue-in-cheek here but is to just

75
00:02:24,810 --> 00:02:29,040
really talk about Android security kamas

76
00:02:26,250 --> 00:02:31,140
matured over the years I've heard a lot

77
00:02:29,040 --> 00:02:33,540
of comments not just to me but just in

78
00:02:31,140 --> 00:02:36,059
general about infrared security and I

79
00:02:33,540 --> 00:02:37,769
think one of them may be the most mad is

80
00:02:36,060 --> 00:02:39,239
when someone said the only secure

81
00:02:37,769 --> 00:02:42,000
Android phones let me throw on the trash

82
00:02:39,239 --> 00:02:44,040
and okay there's some problems with

83
00:02:42,000 --> 00:02:45,510
Android but it's not the worst operating

84
00:02:44,040 --> 00:02:47,070
system out there there's one worse

85
00:02:45,510 --> 00:02:49,109
things just look at Windows a few years

86
00:02:47,070 --> 00:02:50,940
ago compare that to the new versions of

87
00:02:49,110 --> 00:02:53,400
iOS Android I think it's a stark

88
00:02:50,940 --> 00:02:54,630
contrast in terms of security so those

89
00:02:53,400 --> 00:02:56,459
aren't open up hoping you guys can get

90
00:02:54,630 --> 00:02:58,650
on this so let's talk about ICT and

91
00:02:56,459 --> 00:03:00,810
right here so before we get talking

92
00:02:58,650 --> 00:03:01,920
about this Android and how it works and

93
00:03:00,810 --> 00:03:04,530
we need to kind of just do a little bit

94
00:03:01,920 --> 00:03:06,720
of formal definitions here in terms of

95
00:03:04,530 --> 00:03:08,130
access controls so everyone is familiar

96
00:03:06,720 --> 00:03:10,079
with that controls whether you know it

97
00:03:08,130 --> 00:03:13,140
or not you use them attain ultimate

98
00:03:10,079 --> 00:03:14,670
digital and just in real life but

99
00:03:13,140 --> 00:03:16,160
essentially it's restricting its some

100
00:03:14,670 --> 00:03:19,470
sort of subject or a person or thing

101
00:03:16,160 --> 00:03:21,380
access to an object the object could be

102
00:03:19,470 --> 00:03:25,170
by all the subject could be a user

103
00:03:21,380 --> 00:03:26,489
that's how computers work in we have two

104
00:03:25,170 --> 00:03:28,260
different models here we have the

105
00:03:26,489 --> 00:03:29,910
discretionary access control a lot of us

106
00:03:28,260 --> 00:03:32,010
are familiar with this on Windows and on

107
00:03:29,910 --> 00:03:34,019
Linux by default those are discretionary

108
00:03:32,010 --> 00:03:36,420
access control models in which the

109
00:03:34,019 --> 00:03:39,390
subject can pass control on to other

110
00:03:36,420 --> 00:03:41,488
objects for example on Linux if I owned

111
00:03:39,390 --> 00:03:44,548
a file I can do as I please with that

112
00:03:41,489 --> 00:03:45,780
file which is good for you know sharing

113
00:03:44,549 --> 00:03:47,190
data but it can also lead to some

114
00:03:45,780 --> 00:03:49,470
security vulnerabilities which I'll

115
00:03:47,190 --> 00:03:51,750
demonstrate here and it's just a little

116
00:03:49,470 --> 00:03:54,359
too permissive on things like Android

117
00:03:51,750 --> 00:03:56,670
devices the other model is called an app

118
00:03:54,360 --> 00:03:58,680
or a mandatory access control system and

119
00:03:56,670 --> 00:04:01,768
this is when the policies governed by a

120
00:03:58,680 --> 00:04:03,290
central authority in most cases is going

121
00:04:01,769 --> 00:04:05,599
to be the kernel

122
00:04:03,290 --> 00:04:09,108
Android's both the colonel is enforcing

123
00:04:05,599 --> 00:04:10,700
this and owners even if you own quote

124
00:04:09,109 --> 00:04:13,609
unquote file there's really not much you

125
00:04:10,700 --> 00:04:15,260
can do to share and change things I

126
00:04:13,609 --> 00:04:17,478
can't just say hey I want someone else

127
00:04:15,260 --> 00:04:18,829
to have this file the policy master

128
00:04:17,478 --> 00:04:21,228
really is the person who does that

129
00:04:18,829 --> 00:04:23,539
dictation there and just some examples

130
00:04:21,228 --> 00:04:25,520
here obviously we're talking about SD

131
00:04:23,539 --> 00:04:28,070
Android you can also call it SC for

132
00:04:25,520 --> 00:04:29,780
Android ur SD Android doesn't matter and

133
00:04:28,070 --> 00:04:31,969
I also just wanted to conclude on here I

134
00:04:29,780 --> 00:04:34,880
trusted BSD which is the framework that

135
00:04:31,970 --> 00:04:36,020
Apple iOS uses so this I want to just

136
00:04:34,880 --> 00:04:37,909
kind of point out this this isn't just

137
00:04:36,020 --> 00:04:42,560
an Android thing it's also an iOS it's

138
00:04:37,910 --> 00:04:44,750
on many security platforms so let's take

139
00:04:42,560 --> 00:04:47,360
a look at the lights yeah system and

140
00:04:44,750 --> 00:04:49,070
suggest some weaknesses here in terms of

141
00:04:47,360 --> 00:04:52,699
how it applies to the mobile ecosystem

142
00:04:49,070 --> 00:04:55,009
so first off let's say you have a server

143
00:04:52,699 --> 00:04:56,539
in your house you have you know baby you

144
00:04:55,009 --> 00:04:58,310
mean maybe a couple users for you and

145
00:04:56,539 --> 00:05:00,620
your wife your kids or something or no

146
00:04:58,310 --> 00:05:03,259
yeah awesome so processes running on

147
00:05:00,620 --> 00:05:04,910
there maybe they have users as well and

148
00:05:03,259 --> 00:05:06,740
then you have this sort of like elephant

149
00:05:04,910 --> 00:05:07,940
in the room root user which you know

150
00:05:06,740 --> 00:05:09,979
everyone tells you not to use because

151
00:05:07,940 --> 00:05:11,539
it's very powerful but it's there

152
00:05:09,979 --> 00:05:14,360
and when you are Roo you can do whatever

153
00:05:11,539 --> 00:05:16,070
you want on the system and unfortunately

154
00:05:14,360 --> 00:05:17,840
or fortunately Android is based off of

155
00:05:16,070 --> 00:05:19,639
the Linux kernel which means that this

156
00:05:17,840 --> 00:05:22,159
root user is also there on your phone

157
00:05:19,639 --> 00:05:24,680
even though the Android runtime to play

158
00:05:22,159 --> 00:05:26,000
things like Angry Birds don't need root

159
00:05:24,680 --> 00:05:27,740
privileges and they should right doesn't

160
00:05:26,000 --> 00:05:30,349
make it doesn't make any sense however a

161
00:05:27,740 --> 00:05:31,669
lot of things historically run as group

162
00:05:30,349 --> 00:05:32,930
on your phone

163
00:05:31,669 --> 00:05:36,080
things that you take for granted

164
00:05:32,930 --> 00:05:37,490
everyday things like your volume manager

165
00:05:36,080 --> 00:05:40,849
which is not keen on melting file

166
00:05:37,490 --> 00:05:43,210
systems or your battery sensor David is

167
00:05:40,849 --> 00:05:45,710
running probably historically as root

168
00:05:43,210 --> 00:05:47,359
what this leads to is the problem where

169
00:05:45,710 --> 00:05:49,530
they're vulnerable --'tis discovered

170
00:05:47,360 --> 00:05:51,390
these are the targets that attackers are

171
00:05:49,530 --> 00:05:53,039
they're looking at the volume manager

172
00:05:51,390 --> 00:05:54,630
they're looking at the battery sensitive

173
00:05:53,040 --> 00:05:56,190
looking at any other sort of privilege

174
00:05:54,630 --> 00:05:58,230
process because they're running its room

175
00:05:56,190 --> 00:06:01,860
and once your room you can do all sorts

176
00:05:58,230 --> 00:06:04,290
of exciting things on the phone also the

177
00:06:01,860 --> 00:06:06,570
second point is mostly because I've seen

178
00:06:04,290 --> 00:06:08,970
developers - very silly things in the

179
00:06:06,570 --> 00:06:11,070
app space they can do what they want

180
00:06:08,970 --> 00:06:12,990
with their files and you know maybe that

181
00:06:11,070 --> 00:06:14,940
is a good thing but Google has a whole

182
00:06:12,990 --> 00:06:16,680
platform on how to share data securely

183
00:06:14,940 --> 00:06:18,810
but not everyone does that

184
00:06:16,680 --> 00:06:20,550
right you can do whatever you want with

185
00:06:18,810 --> 00:06:25,919
your files because of the way you learn

186
00:06:20,550 --> 00:06:28,740
a stack works also things like IAP tolls

187
00:06:25,919 --> 00:06:30,870
which are calls to the colonel or you

188
00:06:28,740 --> 00:06:33,900
know unix sockets do not have the

189
00:06:30,870 --> 00:06:37,260
ability to fit into laces that model and

190
00:06:33,900 --> 00:06:39,150
we can't actually enforce controls on my

191
00:06:37,260 --> 00:06:40,980
apples unless we actually restrict file

192
00:06:39,150 --> 00:06:42,679
access to which we're sending me out

193
00:06:40,980 --> 00:06:45,690
which we'll talk about in a few slides

194
00:06:42,680 --> 00:06:48,780
and really we can't get as fine-grained

195
00:06:45,690 --> 00:06:51,390
as we need to write think about think

196
00:06:48,780 --> 00:06:53,250
about like the volume manager right so

197
00:06:51,390 --> 00:06:54,870
the fly management one purpose it

198
00:06:53,250 --> 00:06:56,820
announced drives like a super sister

199
00:06:54,870 --> 00:06:59,250
Alice cries you know I'm out right now -

200
00:06:56,820 --> 00:07:00,719
I'm not surprised it does be privileges

201
00:06:59,250 --> 00:07:02,400
to do that because it's a very sensitive

202
00:07:00,720 --> 00:07:04,530
call Oh what else does it need access to

203
00:07:02,400 --> 00:07:06,989
well I would be nothing a configuration

204
00:07:04,530 --> 00:07:08,729
file maybe a couple other files that

205
00:07:06,990 --> 00:07:11,190
needs access to but it doesn't mean the

206
00:07:08,729 --> 00:07:13,289
entire capabilities of the process and

207
00:07:11,190 --> 00:07:14,760
it gets very messy in trying to

208
00:07:13,290 --> 00:07:16,830
implement that with the traditional and

209
00:07:14,760 --> 00:07:21,240
exact to actually say here's what this

210
00:07:16,830 --> 00:07:22,740
process can and can't do so a lot of us

211
00:07:21,240 --> 00:07:24,930
know more - Millie ER with this this

212
00:07:22,740 --> 00:07:28,080
just illustrates the the nine standard

213
00:07:24,930 --> 00:07:30,660
bits for file manipulation and access

214
00:07:28,080 --> 00:07:32,099
rights on Linux you can ignore the D at

215
00:07:30,660 --> 00:07:33,810
the beginning that's just a directory in

216
00:07:32,100 --> 00:07:36,360
this case but we have read write and

217
00:07:33,810 --> 00:07:39,390
execute these are our like actions here

218
00:07:36,360 --> 00:07:41,610
and we have a three different subjects

219
00:07:39,390 --> 00:07:43,530
we have the owner of the file we have

220
00:07:41,610 --> 00:07:45,690
the group associated with the file and

221
00:07:43,530 --> 00:07:48,239
then we have this guy over here other

222
00:07:45,690 --> 00:07:50,340
right we have everyone else this is just

223
00:07:48,240 --> 00:07:53,030
the negation of the user and the group

224
00:07:50,340 --> 00:07:55,609
so this is any other user on the

225
00:07:53,030 --> 00:07:58,070
and do things to this file and I can set

226
00:07:55,610 --> 00:08:01,910
these bits freely if I am the owner of

227
00:07:58,070 --> 00:08:04,730
the file let's walk through an example

228
00:08:01,910 --> 00:08:07,310
here so let's say we have Alice and

229
00:08:04,730 --> 00:08:11,180
Alice wants to use our information in a

230
00:08:07,310 --> 00:08:12,710
file and she creates the file she puts

231
00:08:11,180 --> 00:08:14,780
the data in the file that she wants to

232
00:08:12,710 --> 00:08:16,370
and because the term files you can do

233
00:08:14,780 --> 00:08:18,919
freely with this file

234
00:08:16,370 --> 00:08:21,260
she now wants to share the date of a Bob

235
00:08:18,920 --> 00:08:24,140
so Bob can access the file you can see

236
00:08:21,260 --> 00:08:26,000
the data as well so she can just send

237
00:08:24,140 --> 00:08:28,310
the permission so Alice maybe she's not

238
00:08:26,000 --> 00:08:30,080
a security person she's just a developer

239
00:08:28,310 --> 00:08:31,880
or she's just someone a hobbyist or

240
00:08:30,080 --> 00:08:34,400
something and she's testing other

241
00:08:31,880 --> 00:08:35,719
permissions so that Bob can access it if

242
00:08:34,400 --> 00:08:36,770
she doesn't want to create a group maybe

243
00:08:35,719 --> 00:08:38,840
she does have the ability to create

244
00:08:36,770 --> 00:08:43,130
group if she just says all right anyone

245
00:08:38,840 --> 00:08:44,330
else you can read this file well maybe

246
00:08:43,130 --> 00:08:46,700
what else didn't realize there is that

247
00:08:44,330 --> 00:08:48,770
by saying the other flag everyone else

248
00:08:46,700 --> 00:08:52,610
besides just Bob can access his file

249
00:08:48,770 --> 00:08:54,650
and now people like Eve or attacker here

250
00:08:52,610 --> 00:08:56,630
can now access that file analysis lost

251
00:08:54,650 --> 00:08:58,130
their data now I know this sounds silly

252
00:08:56,630 --> 00:09:00,620
and contrived in why would anyone do

253
00:08:58,130 --> 00:09:02,060
this but this is this is real life right

254
00:09:00,620 --> 00:09:06,620
this is the applications on your phone

255
00:09:02,060 --> 00:09:08,329
doing this back in 2013

256
00:09:06,620 --> 00:09:10,160
I did some security testing of a bunch

257
00:09:08,330 --> 00:09:14,030
of voicemail application so it was like

258
00:09:10,160 --> 00:09:15,260
this new smart voicemail way that smoked

259
00:09:14,030 --> 00:09:17,150
a bunch of carriers where they were like

260
00:09:15,260 --> 00:09:18,830
you know taking the audio from your

261
00:09:17,150 --> 00:09:20,120
voicemails and transcribing give me the

262
00:09:18,830 --> 00:09:22,070
text messages the saw running on your

263
00:09:20,120 --> 00:09:23,540
phone that's all fun and games but they

264
00:09:22,070 --> 00:09:26,000
were storing all the files world

265
00:09:23,540 --> 00:09:27,709
readable so any app that was on your

266
00:09:26,000 --> 00:09:29,720
phone could just if it knew the path

267
00:09:27,710 --> 00:09:32,270
access to your voicemail all the wav

268
00:09:29,720 --> 00:09:34,610
files and the audio or the uh the text

269
00:09:32,270 --> 00:09:36,199
data that was transcribed from them this

270
00:09:34,610 --> 00:09:37,820
is a big deal right these are production

271
00:09:36,200 --> 00:09:39,560
applications running on a lot of phones

272
00:09:37,820 --> 00:09:41,630
and by default they're installed by your

273
00:09:39,560 --> 00:09:42,619
carrier right so companies like Verizon

274
00:09:41,630 --> 00:09:44,750
Sprint

275
00:09:42,620 --> 00:09:46,160
18t they're including these apps on your

276
00:09:44,750 --> 00:09:48,350
phone whether you realize that or not

277
00:09:46,160 --> 00:09:51,800
and they're doing stupid things like

278
00:09:48,350 --> 00:09:53,089
this so this is a problem so let's talk

279
00:09:51,800 --> 00:09:56,270
about how I see ways to make a

280
00:09:53,089 --> 00:09:57,270
difference here so I said I've seen

281
00:09:56,270 --> 00:09:59,160
Linux because that sort

282
00:09:57,270 --> 00:10:02,790
like the base the base project that I

283
00:09:59,160 --> 00:10:04,620
was created back in me ladies by the NSA

284
00:10:02,790 --> 00:10:06,959
so it was developed under the name

285
00:10:04,620 --> 00:10:09,270
security enhancements for Linux and then

286
00:10:06,960 --> 00:10:11,250
in about 2012 it was ported to Android

287
00:10:09,270 --> 00:10:13,470
and they changed the name and now they

288
00:10:11,250 --> 00:10:15,660
call SCE Android but if you call the

289
00:10:13,470 --> 00:10:18,030
SELinux it's essentially the same thing

290
00:10:15,660 --> 00:10:19,829
the port is different in regards to that

291
00:10:18,030 --> 00:10:22,470
they added new features that support the

292
00:10:19,830 --> 00:10:24,150
intro ecosystem so traditionally SEO

293
00:10:22,470 --> 00:10:26,430
annex was mostly profiles and other

294
00:10:24,150 --> 00:10:28,829
Linux II things but there are other

295
00:10:26,430 --> 00:10:31,410
things I enjoyed that matter such as the

296
00:10:28,830 --> 00:10:34,350
property subsystem system services

297
00:10:31,410 --> 00:10:36,540
subsystem that are not part of SC Linux

298
00:10:34,350 --> 00:10:38,610
process project it only needs to be

299
00:10:36,540 --> 00:10:41,579
they're really more specific towards the

300
00:10:38,610 --> 00:10:43,140
influent so they have ported and they've

301
00:10:41,580 --> 00:10:45,600
actually gone in very separate

302
00:10:43,140 --> 00:10:48,360
directions so Google is no longer

303
00:10:45,600 --> 00:10:49,860
committing to the upstream project which

304
00:10:48,360 --> 00:10:52,080
I'll talk about a few more slides it's

305
00:10:49,860 --> 00:10:54,420
kind of pain but anyway it was

306
00:10:52,080 --> 00:10:55,680
introduced into the AOSP I'll be calling

307
00:10:54,420 --> 00:10:58,620
it this for the rest of the slides this

308
00:10:55,680 --> 00:11:00,209
is the Android core developed by Google

309
00:10:58,620 --> 00:11:01,590
the Android Open Source project is

310
00:11:00,210 --> 00:11:04,080
freely available you can download it you

311
00:11:01,590 --> 00:11:07,740
can build it it was introduced in 2012

312
00:11:04,080 --> 00:11:10,860
but at the end of the year when I 4.2

313
00:11:07,740 --> 00:11:13,470
what's that jelly bean jelly bean came

314
00:11:10,860 --> 00:11:14,790
out he wasn't doing anything it was more

315
00:11:13,470 --> 00:11:16,320
like experimental community they were

316
00:11:14,790 --> 00:11:21,180
just testing things probably using it

317
00:11:16,320 --> 00:11:24,030
internally in end of q3 of 2013 we saw

318
00:11:21,180 --> 00:11:27,420
SC Android move into permissive mode

319
00:11:24,030 --> 00:11:28,890
which we'll talk about here but again

320
00:11:27,420 --> 00:11:32,219
it's not really doing too much at this

321
00:11:28,890 --> 00:11:34,560
time and then in q4 of 2014 so just

322
00:11:32,220 --> 00:11:36,960
about 4 years ago with the introduction

323
00:11:34,560 --> 00:11:40,890
of lollipop we saw switch to enforce

324
00:11:36,960 --> 00:11:43,050
mode so what is mrs. Miller courses

325
00:11:40,890 --> 00:11:45,630
enforce mode well permissive mode was

326
00:11:43,050 --> 00:11:47,430
designed so that the OEMs the developers

327
00:11:45,630 --> 00:11:49,050
can test their policies before they

328
00:11:47,430 --> 00:11:51,510
actually applied them because if they

329
00:11:49,050 --> 00:11:53,400
just rolled out this new feature all of

330
00:11:51,510 --> 00:11:53,850
a sudden everyone's phones are just not

331
00:11:53,400 --> 00:11:55,380
going to work

332
00:11:53,850 --> 00:11:57,750
there's a lot of tuning involved here a

333
00:11:55,380 --> 00:11:59,910
lot of manual analysis that you have to

334
00:11:57,750 --> 00:12:01,620
figure out who needs access to what and

335
00:11:59,910 --> 00:12:03,449
none of this stuff was mapped out yet so

336
00:12:01,620 --> 00:12:04,980
if I didn't permissive mode basically

337
00:12:03,450 --> 00:12:08,510
it's logging things but it's not

338
00:12:04,980 --> 00:12:11,040
preventing actions from taking place

339
00:12:08,510 --> 00:12:12,900
within forced mode we actually block and

340
00:12:11,040 --> 00:12:15,990
optionally a lot of all violations that

341
00:12:12,900 --> 00:12:18,270
occurred so if a the battery demon tries

342
00:12:15,990 --> 00:12:20,130
to access the network driver that's

343
00:12:18,270 --> 00:12:22,079
going to be blocked and it's what any

344
00:12:20,130 --> 00:12:23,730
log potentially you know so my testing

345
00:12:22,080 --> 00:12:25,770
can figure out and the biggest thing

346
00:12:23,730 --> 00:12:27,750
here the most important thing here is

347
00:12:25,770 --> 00:12:29,280
that this is required by Google's

348
00:12:27,750 --> 00:12:31,020
compatibility test suite which means

349
00:12:29,280 --> 00:12:33,360
that if you want to make a phone and

350
00:12:31,020 --> 00:12:36,060
have the Play services on it which is

351
00:12:33,360 --> 00:12:38,220
you know the whole Google runtime you

352
00:12:36,060 --> 00:12:42,089
need to support an SEO NXT enforcement

353
00:12:38,220 --> 00:12:43,560
no questions no changes or you'll get in

354
00:12:42,090 --> 00:12:49,770
trouble by Google and you can pepper

355
00:12:43,560 --> 00:12:51,449
your that you it's required by Google's

356
00:12:49,770 --> 00:12:52,770
compatibility suite so that's important

357
00:12:51,450 --> 00:12:54,870
we'll talk about that and some

358
00:12:52,770 --> 00:12:57,600
shortcomings there but I think that's

359
00:12:54,870 --> 00:13:02,250
great that Google's done that it's sad

360
00:12:57,600 --> 00:13:04,170
that a lot of people turn it off so what

361
00:13:02,250 --> 00:13:06,960
are some of the goals here right so I

362
00:13:04,170 --> 00:13:09,390
talked about the root user and that user

363
00:13:06,960 --> 00:13:12,060
needs to go away it really doesn't need

364
00:13:09,390 --> 00:13:14,640
to be any single user on Android

365
00:13:12,060 --> 00:13:16,739
especially when nobody has access to

366
00:13:14,640 --> 00:13:19,710
that user you can't just plug your phone

367
00:13:16,740 --> 00:13:21,900
into a Linux machine and then type sudo

368
00:13:19,710 --> 00:13:23,130
su and run a command room because no one

369
00:13:21,900 --> 00:13:25,530
has access to read

370
00:13:23,130 --> 00:13:27,689
so no user no proxy should be running as

371
00:13:25,530 --> 00:13:29,220
the root user so then one of the goals

372
00:13:27,690 --> 00:13:31,920
here is to basically neuter that that

373
00:13:29,220 --> 00:13:34,140
user make it not attractive to try to

374
00:13:31,920 --> 00:13:36,959
find processes running through instead

375
00:13:34,140 --> 00:13:38,699
make the context for those processes

376
00:13:36,960 --> 00:13:40,040
very restrictive and make it much harder

377
00:13:38,700 --> 00:13:42,240
for an attacker

378
00:13:40,040 --> 00:13:44,040
also we have all these system David's

379
00:13:42,240 --> 00:13:46,320
again things like the volume manager the

380
00:13:44,040 --> 00:13:48,569
Bluetooth thing all these things running

381
00:13:46,320 --> 00:13:51,390
installer naming all these things are

382
00:13:48,570 --> 00:13:53,880
high value targets on entry and we need

383
00:13:51,390 --> 00:13:57,030
to make them much more difficult to gain

384
00:13:53,880 --> 00:13:59,040
access to and that's these guys here so

385
00:13:57,030 --> 00:14:02,430
devices of device drivers

386
00:13:59,040 --> 00:14:05,550
unix sockets all kernel all kernel back

387
00:14:02,430 --> 00:14:06,030
file systems why does a application need

388
00:14:05,550 --> 00:14:08,130
access

389
00:14:06,030 --> 00:14:10,589
doesn't make any sense for Angry Birds

390
00:14:08,130 --> 00:14:11,820
to be able to access the Sisyphus those

391
00:14:10,590 --> 00:14:13,530
are kernel structures to view

392
00:14:11,820 --> 00:14:15,780
information or set information in the

393
00:14:13,530 --> 00:14:18,480
kernel that normal applications need no

394
00:14:15,780 --> 00:14:19,829
rights to or devices there should be no

395
00:14:18,480 --> 00:14:22,680
reason to have to be talking to replace

396
00:14:19,830 --> 00:14:24,030
your and it's not just say we're going

397
00:14:22,680 --> 00:14:25,140
to get rid of those original Linux that

398
00:14:24,030 --> 00:14:26,699
we're actually going to keep everything

399
00:14:25,140 --> 00:14:28,980
that was there and we're just going to

400
00:14:26,700 --> 00:14:30,930
bolt this on on top of it which just

401
00:14:28,980 --> 00:14:34,320
adds another layer of complexity for an

402
00:14:30,930 --> 00:14:35,640
attacker so my goal here isn't to show

403
00:14:34,320 --> 00:14:36,810
you how to make rules we're not writing

404
00:14:35,640 --> 00:14:39,030
the rules together we're not flying

405
00:14:36,810 --> 00:14:40,650
rules of my demoing rules I just kind of

406
00:14:39,030 --> 00:14:43,020
showing you the format of what a rule

407
00:14:40,650 --> 00:14:45,030
looks like so we can talk about how they

408
00:14:43,020 --> 00:14:47,699
work what the actual start analyzing the

409
00:14:45,030 --> 00:14:48,900
policies on our phones so the first

410
00:14:47,700 --> 00:14:51,240
thing here everything is gonna give a

411
00:14:48,900 --> 00:14:54,780
label all objects whether it's a file a

412
00:14:51,240 --> 00:14:58,020
process to the socket it's everything

413
00:14:54,780 --> 00:14:59,339
it's only here this is the format we

414
00:14:58,020 --> 00:15:01,949
have our action which is either alive

415
00:14:59,340 --> 00:15:04,560
allow or deny whatever the domain this

416
00:15:01,950 --> 00:15:07,260
is basically the subject so this is who

417
00:15:04,560 --> 00:15:09,209
we're talking about if so you'll say

418
00:15:07,260 --> 00:15:12,000
like hey this person here and then this

419
00:15:09,210 --> 00:15:13,770
is the the object type is going to be

420
00:15:12,000 --> 00:15:15,480
the label for our object so this is

421
00:15:13,770 --> 00:15:17,490
something you set for example you could

422
00:15:15,480 --> 00:15:20,370
call my file which is not a good idea

423
00:15:17,490 --> 00:15:22,680
what you could do that the class is the

424
00:15:20,370 --> 00:15:25,260
category which is to say these are

425
00:15:22,680 --> 00:15:28,709
defined categories by Google things like

426
00:15:25,260 --> 00:15:30,090
miles sockets property service there's

427
00:15:28,710 --> 00:15:31,710
plenty more you don't need to edit these

428
00:15:30,090 --> 00:15:33,420
you just basically say this is a file

429
00:15:31,710 --> 00:15:35,370
and that's what you said the class to

430
00:15:33,420 --> 00:15:36,900
and then the permission is the actual

431
00:15:35,370 --> 00:15:40,140
operation you're performing on the

432
00:15:36,900 --> 00:15:41,760
object read/write open-eye octal

433
00:15:40,140 --> 00:15:44,460
whatever you want to do to that

434
00:15:41,760 --> 00:15:47,069
particular class is going to be your

435
00:15:44,460 --> 00:15:48,930
permission so we are going to write one

436
00:15:47,070 --> 00:15:51,450
really good rule here it's just all

437
00:15:48,930 --> 00:15:53,910
night rule and let's say we're a

438
00:15:51,450 --> 00:15:55,020
developer iPhone and we want to work we

439
00:15:53,910 --> 00:15:56,969
have this new binder and we're

440
00:15:55,020 --> 00:15:59,340
introducing it trust me Oh Ian's

441
00:15:56,970 --> 00:16:02,490
introduced lots of new buyers and we're

442
00:15:59,340 --> 00:16:04,500
calling it my tool it's instant bin

443
00:16:02,490 --> 00:16:07,740
directory or whatever and it basically

444
00:16:04,500 --> 00:16:11,220
has a configuration file that it's

445
00:16:07,740 --> 00:16:12,960
laughing so we're going to create an

446
00:16:11,220 --> 00:16:14,940
arbitrary label here called my tool

447
00:16:12,960 --> 00:16:17,310
underscore file and we're going to label

448
00:16:14,940 --> 00:16:20,010
this right here and then we're going to

449
00:16:17,310 --> 00:16:22,319
label also the my tool config file as my

450
00:16:20,010 --> 00:16:24,240
tool underscore thing and then we're

451
00:16:22,320 --> 00:16:26,940
going to create a rule to add this

452
00:16:24,240 --> 00:16:28,410
mapping in these particular actions that

453
00:16:26,940 --> 00:16:29,400
we want it to have it's very

454
00:16:28,410 --> 00:16:32,670
straightforward

455
00:16:29,400 --> 00:16:35,640
allow my tool file my tool to think file

456
00:16:32,670 --> 00:16:37,680
read so now any other operation

457
00:16:35,640 --> 00:16:40,170
performed on this file attempting to

458
00:16:37,680 --> 00:16:42,300
write from it or to it sorry attempting

459
00:16:40,170 --> 00:16:44,939
to execute it attempting to do anything

460
00:16:42,300 --> 00:16:46,439
else other than issue a recall is going

461
00:16:44,940 --> 00:16:48,420
to be tonight it's going to be like

462
00:16:46,440 --> 00:16:50,220
actually so you can see how fine-grained

463
00:16:48,420 --> 00:16:52,469
UK you can really have a process that's

464
00:16:50,220 --> 00:16:55,230
a very singular task and make sure that

465
00:16:52,470 --> 00:16:56,580
it only can do that one task and we'll

466
00:16:55,230 --> 00:16:57,570
see just how big of a deal that is when

467
00:16:56,580 --> 00:16:59,610
we start talking about some of the

468
00:16:57,570 --> 00:17:04,410
exploits we see in the wild and why it

469
00:16:59,610 --> 00:17:07,710
matters so rules are defined in these TV

470
00:17:04,410 --> 00:17:11,670
files if you just google like SC Linux

471
00:17:07,710 --> 00:17:13,860
te Google source you'll find a bunch of

472
00:17:11,670 --> 00:17:16,560
them on Google's hungry clothes but

473
00:17:13,859 --> 00:17:19,139
there are dozens of TV files it is all a

474
00:17:16,560 --> 00:17:20,639
boilerplate framework for you if you

475
00:17:19,140 --> 00:17:22,770
just now go to the indigo open source

476
00:17:20,640 --> 00:17:24,480
project and you want it to start

477
00:17:22,770 --> 00:17:26,879
building a device have a really good

478
00:17:24,480 --> 00:17:28,560
starting you do need to change things

479
00:17:26,880 --> 00:17:30,840
especially you start introducing you

480
00:17:28,560 --> 00:17:32,909
hardware and software we have a good

481
00:17:30,840 --> 00:17:35,070
start there's all these macros to help

482
00:17:32,910 --> 00:17:36,780
you here and you will need to change

483
00:17:35,070 --> 00:17:38,550
like there's no real questions there you

484
00:17:36,780 --> 00:17:40,290
have to change things to work on your

485
00:17:38,550 --> 00:17:42,300
device and that's going to be to the

486
00:17:40,290 --> 00:17:44,040
advantage of the attacker because the

487
00:17:42,300 --> 00:17:46,500
people who are making the changes are

488
00:17:44,040 --> 00:17:48,870
not Google and are not people who do

489
00:17:46,500 --> 00:17:52,500
this probably a day in and day out and

490
00:17:48,870 --> 00:17:54,840
breathe security just bills get the

491
00:17:52,500 --> 00:17:57,030
process here we have all of our TV files

492
00:17:54,840 --> 00:18:00,330
which are rules all of our definitions

493
00:17:57,030 --> 00:18:02,700
up here this is like this black box here

494
00:18:00,330 --> 00:18:06,389
that bundles it all up compiles it and

495
00:18:02,700 --> 00:18:08,250
out pops this little tool here it's on

496
00:18:06,390 --> 00:18:10,950
your phone it's a binary file call se

497
00:18:08,250 --> 00:18:11,750
policy and sitting in the directory on

498
00:18:10,950 --> 00:18:14,030
your phone

499
00:18:11,750 --> 00:18:15,500
all the rules inside of it and the

500
00:18:14,030 --> 00:18:16,670
colonel is going to load that guy up and

501
00:18:15,500 --> 00:18:18,290
that's what it's going to check every

502
00:18:16,670 --> 00:18:20,330
time it wants to do any sort of action

503
00:18:18,290 --> 00:18:22,700
on the phone it's gonna come into play

504
00:18:20,330 --> 00:18:25,340
when we actually start looking at any

505
00:18:22,700 --> 00:18:26,900
particular device so let's look at what

506
00:18:25,340 --> 00:18:28,760
it looked like before and I have a

507
00:18:26,900 --> 00:18:30,680
couple of case studies here and I think

508
00:18:28,760 --> 00:18:33,980
it will strengthen the shortcomings of

509
00:18:30,680 --> 00:18:35,900
Android so it used to be as I kind of

510
00:18:33,980 --> 00:18:38,990
mentioned a couple times now a race to

511
00:18:35,900 --> 00:18:41,720
read it was as soon as you execution the

512
00:18:38,990 --> 00:18:46,160
game is over and you just put the phone

513
00:18:41,720 --> 00:18:48,110
saw rootkit what you wanted to and in my

514
00:18:46,160 --> 00:18:50,110
experience this is one to two estimates

515
00:18:48,110 --> 00:18:53,330
we're not looking at anything crazy

516
00:18:50,110 --> 00:18:54,830
especially in the early days and you

517
00:18:53,330 --> 00:18:57,470
could pretty much do what you wanted on

518
00:18:54,830 --> 00:19:00,379
the phone like for this group users from

519
00:18:57,470 --> 00:19:02,330
local kernel modules that's probably not

520
00:19:00,380 --> 00:19:04,070
something that any production phone even

521
00:19:02,330 --> 00:19:06,439
needs to support at this point and some

522
00:19:04,070 --> 00:19:07,790
phones it's turned off but the fact that

523
00:19:06,440 --> 00:19:10,910
the root user is there and can do that

524
00:19:07,790 --> 00:19:13,070
is a problem and again as I mentioned it

525
00:19:10,910 --> 00:19:16,820
numerous times now a majority of the

526
00:19:13,070 --> 00:19:18,710
injury core processes outside of things

527
00:19:16,820 --> 00:19:21,370
running Angry Birds are running as root

528
00:19:18,710 --> 00:19:24,140
so there's a huge attack surface here so

529
00:19:21,370 --> 00:19:26,090
we're gonna go back 2011 here and talk

530
00:19:24,140 --> 00:19:28,370
about the ginger break vulnerability

531
00:19:26,090 --> 00:19:30,760
which affected gingerbread which is so

532
00:19:28,370 --> 00:19:34,280
long ago but still worth talking about

533
00:19:30,760 --> 00:19:35,750
this was one exploit that exploited the

534
00:19:34,280 --> 00:19:37,220
volume manager game and which I've

535
00:19:35,750 --> 00:19:39,920
already brought up which was running a

536
00:19:37,220 --> 00:19:41,480
screw that is essentially designed for

537
00:19:39,920 --> 00:19:43,850
when you plug in an SD card every one

538
00:19:41,480 --> 00:19:45,290
phone statistique cards or when you plug

539
00:19:43,850 --> 00:19:47,540
in you a speed you want to mount a drive

540
00:19:45,290 --> 00:19:49,760
the volume manager takes over and says

541
00:19:47,540 --> 00:19:53,360
yeah I'll I'll apply this for you I'll

542
00:19:49,760 --> 00:19:55,580
format things for you problem is there

543
00:19:53,360 --> 00:19:58,129
was some issues with it particularly an

544
00:19:55,580 --> 00:19:59,149
exposed meddling socket which I'm not

545
00:19:58,130 --> 00:20:00,770
going to spend too much time talking

546
00:19:59,150 --> 00:20:02,090
about the whole explanation here this is

547
00:20:00,770 --> 00:20:04,670
already documented I didn't find this

548
00:20:02,090 --> 00:20:06,709
other people did but essentially you

549
00:20:04,670 --> 00:20:09,650
have this this socket that you can open

550
00:20:06,710 --> 00:20:12,230
here and that link type and you just

551
00:20:09,650 --> 00:20:14,300
send a message to this socket which is

552
00:20:12,230 --> 00:20:16,250
linked up with the kernel and then it

553
00:20:14,300 --> 00:20:19,280
does something which ultimately leads

554
00:20:16,250 --> 00:20:21,710
you to be able to introduce a sec UID

555
00:20:19,280 --> 00:20:22,168
binary and for all the security folks in

556
00:20:21,710 --> 00:20:23,820
the room know

557
00:20:22,169 --> 00:20:25,889
I said you I denied areas that we

558
00:20:23,820 --> 00:20:28,678
control the games over right you can

559
00:20:25,889 --> 00:20:30,719
execute that route so let's look at this

560
00:20:28,679 --> 00:20:32,639
if we compare it with SE Android so a

561
00:20:30,720 --> 00:20:35,399
lot of these actions almost all of them

562
00:20:32,639 --> 00:20:37,799
are completely just muted right we no

563
00:20:35,399 --> 00:20:39,570
longer can open net Ling sockets sorry

564
00:20:37,799 --> 00:20:40,499
this is not a thing anymore right you

565
00:20:39,570 --> 00:20:42,029
shouldn't have been able to do that

566
00:20:40,499 --> 00:20:43,919
anyway I don't know why you would have

567
00:20:42,029 --> 00:20:46,679
been you just can't do that anymore

568
00:20:43,919 --> 00:20:48,869
even things like padding files in the

569
00:20:46,679 --> 00:20:50,429
proc directory there's no reason why

570
00:20:48,869 --> 00:20:52,738
process should be trying to figure out

571
00:20:50,429 --> 00:20:54,480
it's command line by accessing the proc

572
00:20:52,739 --> 00:20:56,279
file system there are other you guys

573
00:20:54,480 --> 00:20:58,440
that can be used for that I guess if you

574
00:20:56,279 --> 00:21:01,470
needed to do that just doing things like

575
00:20:58,440 --> 00:21:03,899
walking off the tables end it anymore

576
00:21:01,470 --> 00:21:06,570
these actions right here like being on

577
00:21:03,899 --> 00:21:08,820
the call remount just not gonna work in

578
00:21:06,570 --> 00:21:10,769
this context you can still do send you I

579
00:21:08,820 --> 00:21:12,779
need although this has changed a lot in

580
00:21:10,769 --> 00:21:14,519
more recent versions of Android however

581
00:21:12,779 --> 00:21:16,889
you're still running in the same context

582
00:21:14,519 --> 00:21:19,379
after you set UID so it probably doesn't

583
00:21:16,889 --> 00:21:21,149
really matter too much so completely

584
00:21:19,379 --> 00:21:25,529
removed even if the vulnerabilities

585
00:21:21,149 --> 00:21:28,369
still existed on the phone today oh we

586
00:21:25,529 --> 00:21:31,409
saw this was a few years later 2014

587
00:21:28,369 --> 00:21:34,559
reported by John Sawyer or J pace on

588
00:21:31,409 --> 00:21:36,210
Twitter he's a very popular a very loud

589
00:21:34,559 --> 00:21:37,859
person on Twitter who talks about

590
00:21:36,210 --> 00:21:39,779
vulnerabilities if you're interested in

591
00:21:37,859 --> 00:21:42,449
a lot of his work on early Android

592
00:21:39,779 --> 00:21:44,759
exploitation it's very inspiring for me

593
00:21:42,450 --> 00:21:46,799
to learn about these things but this

594
00:21:44,759 --> 00:21:49,619
particular vulnerability affected HTC

595
00:21:46,799 --> 00:21:51,960
devices and it was local privilege

596
00:21:49,619 --> 00:21:53,309
escalations a root using a UNIX socket

597
00:21:51,960 --> 00:21:55,889
so again we're noticing a trend here

598
00:21:53,309 --> 00:21:58,440
I've even talked just on UNIX sockets

599
00:21:55,889 --> 00:22:00,449
and custom how silly they are but the

600
00:21:58,440 --> 00:22:02,249
truth is everyone uses UNIX sockets on

601
00:22:00,450 --> 00:22:05,249
the enjoy because they need it for IPC

602
00:22:02,249 --> 00:22:06,779
in the Linux face this one was so

603
00:22:05,249 --> 00:22:08,369
ridiculous it was just the UNIX socket

604
00:22:06,779 --> 00:22:10,769
that there was a there's actually a

605
00:22:08,369 --> 00:22:12,658
driver that was loaded that had a

606
00:22:10,769 --> 00:22:14,039
function call that move file and it

607
00:22:12,659 --> 00:22:16,620
would execute it as like the kernel

608
00:22:14,039 --> 00:22:19,110
context so any application with the

609
00:22:16,620 --> 00:22:20,879
which let's be honest every application

610
00:22:19,110 --> 00:22:23,129
needs the internet nowadays could

611
00:22:20,880 --> 00:22:25,650
literally just move and copy files and

612
00:22:23,130 --> 00:22:28,020
do things to aspect privileges so we're

613
00:22:25,650 --> 00:22:30,870
talking one exploit here one single

614
00:22:28,020 --> 00:22:32,550
thing to go from the lowest privileged

615
00:22:30,870 --> 00:22:34,409
app with the internet permission to

616
00:22:32,550 --> 00:22:36,899
complete control of your phone of course

617
00:22:34,410 --> 00:22:39,030
this is fixed but here's the big thing

618
00:22:36,900 --> 00:22:40,020
it was accessing the UNIX socket in the

619
00:22:39,030 --> 00:22:41,850
dead socket driver

620
00:22:40,020 --> 00:22:44,760
there's no reason any application should

621
00:22:41,850 --> 00:22:47,760
be interacting with those this was for

622
00:22:44,760 --> 00:22:48,929
HTC to do some privileged things I don't

623
00:22:47,760 --> 00:22:50,910
really know what they were trying to do

624
00:22:48,929 --> 00:22:53,460
here but there's no reason that should

625
00:22:50,910 --> 00:22:56,460
be interacting at all even reading from

626
00:22:53,460 --> 00:22:58,830
that directory so this this whole vector

627
00:22:56,460 --> 00:23:00,809
this whole suite of vulnerabilities as

628
00:22:58,830 --> 00:23:02,340
effectively been mitigated as an

629
00:23:00,809 --> 00:23:04,020
unprivileged app just because you can't

630
00:23:02,340 --> 00:23:06,090
even tell us anything in the dev

631
00:23:04,020 --> 00:23:09,420
director that's good that makes that

632
00:23:06,090 --> 00:23:10,770
makes me feel good about things a few

633
00:23:09,420 --> 00:23:13,860
years later this is one that I actually

634
00:23:10,770 --> 00:23:16,050
reported to Qualcomm this one was a

635
00:23:13,860 --> 00:23:19,520
vulnerability in the net D daemon which

636
00:23:16,050 --> 00:23:21,899
was in Qualcomm specific for work

637
00:23:19,520 --> 00:23:24,540
branches which is still millions of

638
00:23:21,900 --> 00:23:26,580
devices outside military devices

639
00:23:24,540 --> 00:23:29,700
this was around for a long time so I

640
00:23:26,580 --> 00:23:31,290
found this in 2015 but chances are

641
00:23:29,700 --> 00:23:33,900
others I was hanging around for quite a

642
00:23:31,290 --> 00:23:36,120
while now this is a cone excuse net room

643
00:23:33,900 --> 00:23:38,010
in this case it's radio but the radio

644
00:23:36,120 --> 00:23:39,780
user is a privileged user on Android

645
00:23:38,010 --> 00:23:42,720
notably and has access to the base man

646
00:23:39,780 --> 00:23:44,730
which need also some other issues there

647
00:23:42,720 --> 00:23:46,740
again we're talking one exploit as a

648
00:23:44,730 --> 00:23:49,740
third-party application to be able to

649
00:23:46,740 --> 00:23:51,390
access the base man so there's

650
00:23:49,740 --> 00:23:53,490
particularly mobility besides just

651
00:23:51,390 --> 00:23:55,410
accessing the base band it can also

652
00:23:53,490 --> 00:23:58,260
allow you to read and write SMS

653
00:23:55,410 --> 00:23:59,580
again why is the net deep the net D game

654
00:23:58,260 --> 00:24:03,179
is responsible for assigning IP

655
00:23:59,580 --> 00:24:05,220
addresses managing your DHCP leases why

656
00:24:03,179 --> 00:24:08,190
can that read or write your SMS database

657
00:24:05,220 --> 00:24:09,900
well they didn't have a way to say that

658
00:24:08,190 --> 00:24:11,340
this particular process needs to are

659
00:24:09,900 --> 00:24:13,290
privileged but they can't do these

660
00:24:11,340 --> 00:24:15,750
actions so we have this huge attack

661
00:24:13,290 --> 00:24:19,200
surface I also do filesystem activities

662
00:24:15,750 --> 00:24:21,150
that like write to directories on areas

663
00:24:19,200 --> 00:24:23,490
that it really had no right

664
00:24:21,150 --> 00:24:25,710
do and had really good access to the

665
00:24:23,490 --> 00:24:27,450
property subsystem which will see if we

666
00:24:25,710 --> 00:24:28,890
come to play a little later but the

667
00:24:27,450 --> 00:24:32,070
property subsystem is essentially like

668
00:24:28,890 --> 00:24:33,780
the Windows registry and with also with

669
00:24:32,070 --> 00:24:35,100
events that you can trigger on when

670
00:24:33,780 --> 00:24:36,870
interactions are made there see the

671
00:24:35,100 --> 00:24:39,510
setup alerts for when this property

672
00:24:36,870 --> 00:24:41,760
changes do this particular action which

673
00:24:39,510 --> 00:24:44,760
is really fun if we can actually make

674
00:24:41,760 --> 00:24:46,200
changes to those properties so let's

675
00:24:44,760 --> 00:24:48,480
look at this one that's the injury

676
00:24:46,200 --> 00:24:50,220
well this one's face I just can't do

677
00:24:48,480 --> 00:24:52,020
that anymore because the netd gaming is

678
00:24:50,220 --> 00:24:55,410
running under a policy that doesn't let

679
00:24:52,020 --> 00:24:56,400
it access the contacts anymore that's

680
00:24:55,410 --> 00:24:57,929
good

681
00:24:56,400 --> 00:24:59,130
the base page you can still access it

682
00:24:57,929 --> 00:25:00,990
unfortunately there's really not much

683
00:24:59,130 --> 00:25:04,500
you can do about that because it's

684
00:25:00,990 --> 00:25:06,210
designed to interact with radio the file

685
00:25:04,500 --> 00:25:07,400
system access has been revoked so you

686
00:25:06,210 --> 00:25:09,720
wouldn't be able to do that

687
00:25:07,400 --> 00:25:11,640
unfortunately you can still alter and

688
00:25:09,720 --> 00:25:14,280
it's the network stack because again

689
00:25:11,640 --> 00:25:16,080
this is the networking David and the

690
00:25:14,280 --> 00:25:16,830
property subsystem has been completely

691
00:25:16,080 --> 00:25:19,050
revamped

692
00:25:16,830 --> 00:25:22,080
with the introduction of SD Linux or se

693
00:25:19,050 --> 00:25:24,928
Android so that has changed and it's

694
00:25:22,080 --> 00:25:26,280
much more restrictive now there's one

695
00:25:24,929 --> 00:25:31,170
last idea here I just want to point out

696
00:25:26,280 --> 00:25:33,000
and that is basically that not

697
00:25:31,170 --> 00:25:34,679
everything's changed right a lot of

698
00:25:33,000 --> 00:25:36,890
embedded devices that aren't Google

699
00:25:34,679 --> 00:25:38,880
sponsored phones are running Android

700
00:25:36,890 --> 00:25:40,320
things that you don't even probably

701
00:25:38,880 --> 00:25:42,270
realize that conference moments are all

702
00:25:40,320 --> 00:25:44,370
Android based now you your cars are

703
00:25:42,270 --> 00:25:46,889
running in from all children's toys

704
00:25:44,370 --> 00:25:49,939
that's a lot of children's toys oh my

705
00:25:46,890 --> 00:25:52,800
god and just insert random IOT device

706
00:25:49,940 --> 00:25:54,690
anything sure refrigerators are running

707
00:25:52,800 --> 00:25:57,570
like Linux or Android and the truth is

708
00:25:54,690 --> 00:25:59,490
like the cold hard truth is people are

709
00:25:57,570 --> 00:26:00,899
just turning this off because they don't

710
00:25:59,490 --> 00:26:01,530
need to use it they don't want to

711
00:26:00,900 --> 00:26:03,809
develop it

712
00:26:01,530 --> 00:26:06,870
they're just shutting it off and I've

713
00:26:03,809 --> 00:26:08,399
seen this numerous times and I put it as

714
00:26:06,870 --> 00:26:10,340
finding blocks and reports like a

715
00:26:08,400 --> 00:26:12,840
straight up just turn this off and

716
00:26:10,340 --> 00:26:14,790
there's just no one but just because

717
00:26:12,840 --> 00:26:16,559
this is hard you have to do a lot of

718
00:26:14,790 --> 00:26:18,090
tuning and all these developers

719
00:26:16,559 --> 00:26:20,730
especially wants to or economy of China

720
00:26:18,090 --> 00:26:22,059
no offense are just not thinking about

721
00:26:20,730 --> 00:26:23,919
security as before

722
00:26:22,059 --> 00:26:25,960
they're trying to push the product I eat

723
00:26:23,919 --> 00:26:27,549
our children's tablet that I don't know

724
00:26:25,960 --> 00:26:29,440
what it lets you do have your kids learn

725
00:26:27,549 --> 00:26:31,029
or something is they don't care about

726
00:26:29,440 --> 00:26:32,710
SEO X they don't care about us he

727
00:26:31,029 --> 00:26:34,539
enjoyed everything is running on Groupon

728
00:26:32,710 --> 00:26:37,299
those phones like it doesn't matter it's

729
00:26:34,539 --> 00:26:39,759
back we're back in 1998 again here and

730
00:26:37,299 --> 00:26:43,229
it's very easy to compromise anything

731
00:26:39,759 --> 00:26:45,309
that's not a Google sponsor for okay

732
00:26:43,229 --> 00:26:49,419
let's talk about monitoring devices

733
00:26:45,309 --> 00:26:51,549
wordlessly so I like I was when I was

734
00:26:49,419 --> 00:26:53,919
doing some work previously a co-worker

735
00:26:51,549 --> 00:26:55,869
of my comment done when I can exploit a

736
00:26:53,919 --> 00:26:57,429
for a vulnerability he was like and this

737
00:26:55,869 --> 00:27:00,639
looks a lot like a Rube Goldberg machine

738
00:26:57,429 --> 00:27:02,080
and I was like what's that it's if

739
00:27:00,639 --> 00:27:04,389
anyone's going like mousetrap before

740
00:27:02,080 --> 00:27:07,299
like we're like the ball hits the lever

741
00:27:04,389 --> 00:27:08,439
which lights a candle it's like all

742
00:27:07,299 --> 00:27:09,969
these different actions that have to

743
00:27:08,440 --> 00:27:12,129
occur that's kind of what we're dealing

744
00:27:09,969 --> 00:27:14,679
with now that's the reality what it

745
00:27:12,129 --> 00:27:17,049
looks like now where it's not just lets

746
00:27:14,679 --> 00:27:18,879
one run exploit and we root over here we

747
00:27:17,049 --> 00:27:20,950
have to do all this silly things jumping

748
00:27:18,879 --> 00:27:22,959
from context to context potentially just

749
00:27:20,950 --> 00:27:24,299
to get if the rights we need to do a

750
00:27:22,960 --> 00:27:26,409
specific action

751
00:27:24,299 --> 00:27:29,529
so yeah that's ourselves different

752
00:27:26,409 --> 00:27:31,960
questions no longer LS and run our PS

753
00:27:29,529 --> 00:27:32,769
and run graphical route that's not gonna

754
00:27:31,960 --> 00:27:34,119
work anymore

755
00:27:32,769 --> 00:27:36,519
well we need to think about is what's

756
00:27:34,119 --> 00:27:38,468
our okay are we trying to write into the

757
00:27:36,519 --> 00:27:40,570
SMS babies because then we need to focus

758
00:27:38,469 --> 00:27:42,549
on context that have access to that are

759
00:27:40,570 --> 00:27:43,869
we trying to release an exploit that

760
00:27:42,549 --> 00:27:45,729
gives us root privileges so we can

761
00:27:43,869 --> 00:27:48,339
actually solve malware well you have to

762
00:27:45,729 --> 00:27:50,109
focus on context or target a context

763
00:27:48,339 --> 00:27:52,059
that has a suspect or user doesn't

764
00:27:50,109 --> 00:27:54,580
matter it you can have a really low

765
00:27:52,059 --> 00:27:55,149
privileged user that has all sorts of se

766
00:27:54,580 --> 00:27:57,519
Android

767
00:27:55,149 --> 00:28:00,488
modifiers which give it more right than

768
00:27:57,519 --> 00:28:02,589
you had before and then my favorite

769
00:28:00,489 --> 00:28:06,249
favorite things to talk about

770
00:28:02,589 --> 00:28:07,960
all right changes by the OEMs it changes

771
00:28:06,249 --> 00:28:10,629
to the Android Open Source project

772
00:28:07,960 --> 00:28:12,789
because this is where the bugs are sick

773
00:28:10,629 --> 00:28:14,529
I've talked about this for years and

774
00:28:12,789 --> 00:28:17,289
I've reported

775
00:28:14,529 --> 00:28:21,849
dozens of vulnerabilities in vendors

776
00:28:17,289 --> 00:28:24,908
like HTC Qualcomm LG these guys are not

777
00:28:21,849 --> 00:28:25,520
as good at security as Google has been

778
00:28:24,909 --> 00:28:28,610
in protect

779
00:28:25,520 --> 00:28:30,230
there and that's just my opinion but I

780
00:28:28,610 --> 00:28:32,300
mean that's what I've seen that's where

781
00:28:30,230 --> 00:28:34,790
I'm staying so I like to focus on the

782
00:28:32,300 --> 00:28:36,830
differences so if I have a huawei phone

783
00:28:34,790 --> 00:28:38,990
what's different look let's look at the

784
00:28:36,830 --> 00:28:41,210
Android policy the SELinux policy and

785
00:28:38,990 --> 00:28:43,370
say what changes have a big is your

786
00:28:41,210 --> 00:28:44,690
sequel airing changes even if it's like

787
00:28:43,370 --> 00:28:46,399
some ones that are forced turning on

788
00:28:44,690 --> 00:28:48,050
that doesn't mean they can't tweak it

789
00:28:46,400 --> 00:28:49,250
and change the way things work right

790
00:28:48,050 --> 00:28:50,930
they can't figure something out they'll

791
00:28:49,250 --> 00:28:55,250
just slap on a modifier that gives that

792
00:28:50,930 --> 00:28:56,840
process full rights so ok so let's say

793
00:28:55,250 --> 00:28:58,010
let's say we're getting into more some

794
00:28:56,840 --> 00:29:00,169
more technical detail so let's say we

795
00:28:58,010 --> 00:29:01,430
actually want to we have a phone and our

796
00:29:00,170 --> 00:29:03,200
friend is giving us we want to start

797
00:29:01,430 --> 00:29:04,700
looking at it the very first thing you

798
00:29:03,200 --> 00:29:06,800
need to do is you need to get access to

799
00:29:04,700 --> 00:29:08,570
the policy box and the labeling class

800
00:29:06,800 --> 00:29:11,090
these are all gonna be present on the

801
00:29:08,570 --> 00:29:14,450
phone on most phones they are accessible

802
00:29:11,090 --> 00:29:16,459
the biggest one here is SE policy SE

803
00:29:14,450 --> 00:29:18,800
policies have binary file that's loaded

804
00:29:16,460 --> 00:29:20,960
up by the kernel which tells you all the

805
00:29:18,800 --> 00:29:22,220
rules that are gonna be performed the

806
00:29:20,960 --> 00:29:24,140
rest of these are just for labeling

807
00:29:22,220 --> 00:29:26,420
right so this is the file context which

808
00:29:24,140 --> 00:29:28,670
was in binary format for one version of

809
00:29:26,420 --> 00:29:30,740
Android it's going to happen

810
00:29:28,670 --> 00:29:32,900
mappings from filing to move context

811
00:29:30,740 --> 00:29:35,630
same thing for services service name to

812
00:29:32,900 --> 00:29:37,490
move context properties properties to

813
00:29:35,630 --> 00:29:40,160
context you get the idea last one here's

814
00:29:37,490 --> 00:29:42,110
an XML file that has our labeling for

815
00:29:40,160 --> 00:29:43,760
applications this is how applications

816
00:29:42,110 --> 00:29:48,560
need to behave because even applications

817
00:29:43,760 --> 00:29:54,460
get labels now to pull these off you can

818
00:29:48,560 --> 00:29:57,679
use the Android debug bridge shell user

819
00:29:54,460 --> 00:30:00,080
if you have a firmer no I'm pulling out

820
00:29:57,680 --> 00:30:01,640
of that I've used that the past or maybe

821
00:30:00,080 --> 00:30:03,050
I can't get to the yes the Android files

822
00:30:01,640 --> 00:30:04,700
because sometimes they're just not

823
00:30:03,050 --> 00:30:07,669
accessible but you get them from a

824
00:30:04,700 --> 00:30:09,260
firmware don't most of these files are

825
00:30:07,670 --> 00:30:12,320
clear text it's super easy to understand

826
00:30:09,260 --> 00:30:13,940
with the exception of the file context

827
00:30:12,320 --> 00:30:16,250
which was converted to a binary format

828
00:30:13,940 --> 00:30:18,650
and nougat and then they immediately

829
00:30:16,250 --> 00:30:21,050
switched it back I couldn't find any

830
00:30:18,650 --> 00:30:23,030
parsers that were written not in C most

831
00:30:21,050 --> 00:30:24,980
of my Chinese forms I don't want in

832
00:30:23,030 --> 00:30:26,300
Python and it's someone you know if for

833
00:30:24,980 --> 00:30:27,130
some reason you're testing a new your

834
00:30:26,300 --> 00:30:29,350
phone it's easy

835
00:30:27,130 --> 00:30:31,510
by their policies while try the Pinery

836
00:30:29,350 --> 00:30:33,010
context file just it's just a simple

837
00:30:31,510 --> 00:30:34,629
script that just parts of the structure

838
00:30:33,010 --> 00:30:36,910
is pretty straightforward now

839
00:30:34,630 --> 00:30:38,320
unfortunately this se policy file which

840
00:30:36,910 --> 00:30:40,870
is a binary format through and through

841
00:30:38,320 --> 00:30:42,490
is a completely different story so we're

842
00:30:40,870 --> 00:30:43,750
gonna circle back really quickly I just

843
00:30:42,490 --> 00:30:46,720
want to show you how this works let's

844
00:30:43,750 --> 00:30:48,130
say you run an ADB shell command so or

845
00:30:46,720 --> 00:30:50,169
this is specifically for the Huawei

846
00:30:48,130 --> 00:30:52,150
honor running in this case I believe

847
00:30:50,169 --> 00:30:53,919
this isn't good

848
00:30:52,150 --> 00:30:55,390
I'm ready to be shelf and then I'm

849
00:30:53,919 --> 00:30:57,250
running the ID come in and you can see

850
00:30:55,390 --> 00:30:59,260
my context is nested right down here at

851
00:30:57,250 --> 00:31:02,320
the bottom after all my traditional

852
00:30:59,260 --> 00:31:05,020
Linux death thinks here all the groups

853
00:31:02,320 --> 00:31:07,450
and users I'm in here's my context I'm

854
00:31:05,020 --> 00:31:09,520
running as a shell context so that's a

855
00:31:07,450 --> 00:31:11,590
good starting right if we're gonna start

856
00:31:09,520 --> 00:31:13,389
poking around on this phone we need to

857
00:31:11,590 --> 00:31:15,580
assume we're starting as the shell

858
00:31:13,390 --> 00:31:17,080
context not so much the shell user

859
00:31:15,580 --> 00:31:18,760
obviously it's still important as well

860
00:31:17,080 --> 00:31:20,620
but knowing that running is the shell

861
00:31:18,760 --> 00:31:24,070
context is key because that's the access

862
00:31:20,620 --> 00:31:25,959
we have okay so we have our context we

863
00:31:24,070 --> 00:31:28,539
have a parts testing policy file I

864
00:31:25,960 --> 00:31:32,049
encourage you to go on google and type

865
00:31:28,539 --> 00:31:34,360
in parsing SE policy Android you're

866
00:31:32,049 --> 00:31:36,668
gonna get this link right here it's on

867
00:31:34,360 --> 00:31:39,459
Stack Overflow it's like four years old

868
00:31:36,669 --> 00:31:41,440
and it's someone saying hey I just want

869
00:31:39,460 --> 00:31:44,080
to parse this file can someone please

870
00:31:41,440 --> 00:31:45,490
help me and this guy says well I've been

871
00:31:44,080 --> 00:31:46,059
looking into this you think this would

872
00:31:45,490 --> 00:31:48,370
be easy

873
00:31:46,059 --> 00:31:50,080
blah blah blah as I'm talking about it

874
00:31:48,370 --> 00:31:51,908
and really comes down you because Google

875
00:31:50,080 --> 00:31:54,490
has fork the code they they're kind of

876
00:31:51,909 --> 00:31:55,929
doing all this stuff behind the scenes

877
00:31:54,490 --> 00:31:58,600
and they're not really publishing the

878
00:31:55,929 --> 00:32:01,390
tools that a normal user would use to

879
00:31:58,600 --> 00:32:03,879
search as an policy because why because

880
00:32:01,390 --> 00:32:06,039
om don't need this they have their own

881
00:32:03,880 --> 00:32:07,750
testing Suites and the only person means

882
00:32:06,039 --> 00:32:09,190
this is me who doesn't have access to

883
00:32:07,750 --> 00:32:11,350
the source code it doesn't have access

884
00:32:09,190 --> 00:32:14,289
to the TV files this is stuff for

885
00:32:11,350 --> 00:32:17,860
attackers there's not publishing that so

886
00:32:14,289 --> 00:32:20,950
I reached out to the give up guy who is

887
00:32:17,860 --> 00:32:24,399
maintaining the SE policy well mostly

888
00:32:20,950 --> 00:32:26,050
just be su nice work of Android or deny

889
00:32:24,400 --> 00:32:28,760
the mainstream project

890
00:32:26,050 --> 00:32:30,440
and I said hey you know straight schools

891
00:32:28,760 --> 00:32:33,500
really helpful like what are your plans

892
00:32:30,440 --> 00:32:36,770
to support Android and he very kindly

893
00:32:33,500 --> 00:32:39,290
replied the next day and said hey I have

894
00:32:36,770 --> 00:32:40,490
no plans of doing this so thanks anyway

895
00:32:39,290 --> 00:32:42,409
he closed it

896
00:32:40,490 --> 00:32:44,720
so basically we're not gonna get any

897
00:32:42,410 --> 00:32:47,210
mainstream support for STD policy

898
00:32:44,720 --> 00:32:49,280
parsing which sucks so let's go back to

899
00:32:47,210 --> 00:32:51,230
this guy here this is a his start of his

900
00:32:49,280 --> 00:32:55,180
question or his answer well here's his

901
00:32:51,230 --> 00:32:57,950
answer all you have to do is first clone

902
00:32:55,180 --> 00:32:59,750
Android which is about 70 gates last

903
00:32:57,950 --> 00:33:01,430
time I checked and then set up a build

904
00:32:59,750 --> 00:33:04,100
environment which is probably a day or

905
00:33:01,430 --> 00:33:06,080
two of work yeah and then you download

906
00:33:04,100 --> 00:33:07,850
this other tool and make these changes

907
00:33:06,080 --> 00:33:09,290
to these four files it's all these

908
00:33:07,850 --> 00:33:11,060
dependencies by the way if things don't

909
00:33:09,290 --> 00:33:14,330
work there's some alternate instructions

910
00:33:11,060 --> 00:33:15,860
here then you can finally do these other

911
00:33:14,330 --> 00:33:19,399
operations here which will help you

912
00:33:15,860 --> 00:33:21,649
build some other core libraries yeah so

913
00:33:19,400 --> 00:33:23,540
you can do all these things and it

914
00:33:21,650 --> 00:33:26,480
actually works so if you take the time

915
00:33:23,540 --> 00:33:28,310
to do as I say Google this this is the

916
00:33:26,480 --> 00:33:30,800
process right now right this is the way

917
00:33:28,310 --> 00:33:32,929
things work unfortunately once you have

918
00:33:30,800 --> 00:33:34,220
the binaries in the bindings you know

919
00:33:32,930 --> 00:33:36,230
you can share them with your friends or

920
00:33:34,220 --> 00:33:38,450
whatever but the trick here is you need

921
00:33:36,230 --> 00:33:41,180
to get access to do all these steps just

922
00:33:38,450 --> 00:33:45,110
to be able to run the SE search command

923
00:33:41,180 --> 00:33:46,400
which in its glory is here so the SE

924
00:33:45,110 --> 00:33:48,260
search command is going to be a way for

925
00:33:46,400 --> 00:33:51,110
us take the policy file which is binary

926
00:33:48,260 --> 00:33:53,060
and then run searches for in the context

927
00:33:51,110 --> 00:33:55,280
we care about really straightforward

928
00:33:53,060 --> 00:33:57,320
easy example here I'm going to search

929
00:33:55,280 --> 00:33:59,930
the SC policy file for that honor that

930
00:33:57,320 --> 00:34:02,510
polyfoam show me all the files that I

931
00:33:59,930 --> 00:34:04,340
can write to as this gel contacts here

932
00:34:02,510 --> 00:34:05,930
they are here all the labels that I have

933
00:34:04,340 --> 00:34:08,389
access to where I have the right

934
00:34:05,930 --> 00:34:10,040
privilege and then do that additional

935
00:34:08,389 --> 00:34:11,960
layer here look for the things that are

936
00:34:10,040 --> 00:34:15,710
different how about the stuff Huawei

937
00:34:11,960 --> 00:34:18,050
sensor this is some new sensor new label

938
00:34:15,710 --> 00:34:19,389
that was not part of Android it's a very

939
00:34:18,050 --> 00:34:21,309
easy process to do that

940
00:34:19,389 --> 00:34:23,139
here you can just basically dip this

941
00:34:21,309 --> 00:34:24,549
list it you know these things will stand

942
00:34:23,139 --> 00:34:26,669
out this one even says Huawei in it so

943
00:34:24,549 --> 00:34:29,918
it's even easier well what is that

944
00:34:26,668 --> 00:34:32,078
let's find out let's find out all the

945
00:34:29,918 --> 00:34:34,569
files that are labeled as this at best

946
00:34:32,079 --> 00:34:36,990
Huawei sensor and look at this these are

947
00:34:34,569 --> 00:34:39,549
all again on this the kernel fact

948
00:34:36,989 --> 00:34:42,219
filesystem sisyphus in the system every

949
00:34:39,549 --> 00:34:45,369
these are direct interfaces to read and

950
00:34:42,219 --> 00:34:47,049
write to potentially the kernel which in

951
00:34:45,369 --> 00:34:49,179
itself is not a vulnerability right it's

952
00:34:47,049 --> 00:34:51,219
just an avenue for an attacker to now as

953
00:34:49,179 --> 00:34:53,289
a monk privileged user potentially

954
00:34:51,219 --> 00:34:56,018
interface with the kernel send data to a

955
00:34:53,289 --> 00:34:57,220
receive data from it what happened so

956
00:34:56,018 --> 00:34:59,339
each one of these will need to be

957
00:34:57,220 --> 00:35:02,730
investigated but what can we do with the

958
00:34:59,339 --> 00:35:04,869
Huawei ALS info structure I don't know

959
00:35:02,730 --> 00:35:06,940
but this is the process you take you

960
00:35:04,869 --> 00:35:09,039
find the context you map it see things

961
00:35:06,940 --> 00:35:10,539
like files look again properties are in

962
00:35:09,039 --> 00:35:12,099
the important services are going to be

963
00:35:10,539 --> 00:35:13,900
important and you're gonna want to look

964
00:35:12,099 --> 00:35:16,599
through what exactly this context can do

965
00:35:13,900 --> 00:35:18,190
and it may not be beneficial to go

966
00:35:16,599 --> 00:35:19,930
strengthen the goal right you may not be

967
00:35:18,190 --> 00:35:22,029
able to find a context that has access

968
00:35:19,930 --> 00:35:23,049
to something super sensitive which means

969
00:35:22,029 --> 00:35:24,339
you're gonna have to go back to every

970
00:35:23,049 --> 00:35:26,109
Goldberg machine like model where you

971
00:35:24,339 --> 00:35:27,788
have to jump around and you just take

972
00:35:26,109 --> 00:35:29,589
baby steps get yourself into a platform

973
00:35:27,789 --> 00:35:35,559
at first and then focus on something

974
00:35:29,589 --> 00:35:37,538
more advanced the property subsystem is

975
00:35:35,559 --> 00:35:41,380
also like I said really instrumental and

976
00:35:37,539 --> 00:35:42,880
key to the injury model and there are

977
00:35:41,380 --> 00:35:45,069
some properties that you should be aware

978
00:35:42,880 --> 00:35:47,799
of that if you're in these times if you

979
00:35:45,069 --> 00:35:49,359
have access to this context and you're

980
00:35:47,799 --> 00:35:51,549
gonna already have code execution or

981
00:35:49,359 --> 00:35:54,220
some sort of privilege escalation that

982
00:35:51,549 --> 00:35:56,140
would be this system problem if you can

983
00:35:54,220 --> 00:35:57,939
get a context that has this you got a

984
00:35:56,140 --> 00:35:59,950
lot of surface that you can now it cover

985
00:35:57,940 --> 00:36:01,990
because you can now interact with a lot

986
00:35:59,950 --> 00:36:05,078
of system properties that normal apps

987
00:36:01,990 --> 00:36:06,879
are not expected to be able to access so

988
00:36:05,079 --> 00:36:08,920
you can make all sorts of funky changes

989
00:36:06,880 --> 00:36:11,970
the properties that other processes are

990
00:36:08,920 --> 00:36:14,140
loading from Italy also maybe look for

991
00:36:11,970 --> 00:36:15,609
those triggers I'll sell you

992
00:36:14,140 --> 00:36:18,549
you can actually have actions occur when

993
00:36:15,609 --> 00:36:21,009
you modify properties also the default

994
00:36:18,549 --> 00:36:22,420
CTL problem label is the lingual

995
00:36:21,010 --> 00:36:24,670
required to start and stop in it

996
00:36:22,420 --> 00:36:26,049
services and it services mostly Ranas

997
00:36:24,670 --> 00:36:27,849
routes though and they're not usually

998
00:36:26,049 --> 00:36:31,059
labeled the very restrictive labels

999
00:36:27,849 --> 00:36:32,260
because they're just not so getting in

1000
00:36:31,059 --> 00:36:37,450
one of these two is going to be really

1001
00:36:32,260 --> 00:36:40,029
big again look for non ASP properties is

1002
00:36:37,450 --> 00:36:42,308
an example right here this would be

1003
00:36:40,029 --> 00:36:45,099
running the SE search and I'm looking

1004
00:36:42,309 --> 00:36:46,990
for if I'm the net d-david so let's say

1005
00:36:45,099 --> 00:36:49,299
we exploited my qualcomm bug here and

1006
00:36:46,990 --> 00:36:52,089
we're looking for properties that we can

1007
00:36:49,299 --> 00:36:55,329
set on quali honor we could set all

1008
00:36:52,089 --> 00:36:57,819
sorts of stuff in addition to read only

1009
00:36:55,329 --> 00:36:59,410
ones which are kind of fun I would like

1010
00:36:57,819 --> 00:37:00,759
to be able to write to read only ones

1011
00:36:59,410 --> 00:37:03,368
but that's just that's kind of how

1012
00:37:00,760 --> 00:37:05,829
things look here also all these ones

1013
00:37:03,369 --> 00:37:07,329
down here these are all non Android Open

1014
00:37:05,829 --> 00:37:13,029
Source these are all added by glowing

1015
00:37:07,329 --> 00:37:16,119
right so now I can now modify the camera

1016
00:37:13,029 --> 00:37:17,559
tuning dump property which again no I'm

1017
00:37:16,119 --> 00:37:19,000
not sure what that does but now you take

1018
00:37:17,559 --> 00:37:20,289
this as a starting point it's our

1019
00:37:19,000 --> 00:37:21,819
reverse engineering the binaries

1020
00:37:20,289 --> 00:37:23,890
associated with these it or looking at

1021
00:37:21,819 --> 00:37:25,960
these and you may have managed actually

1022
00:37:23,890 --> 00:37:28,930
been building all right additional files

1023
00:37:25,960 --> 00:37:37,599
all sorts of exciting things this one

1024
00:37:28,930 --> 00:37:39,669
this is ro probably one just also

1025
00:37:37,599 --> 00:37:41,980
there's another Avenue you take if your

1026
00:37:39,670 --> 00:37:42,759
goal is to just kind of map out the

1027
00:37:41,980 --> 00:37:44,380
context

1028
00:37:42,759 --> 00:37:47,619
look for ones that have learn called

1029
00:37:44,380 --> 00:37:50,619
capabilities NFC ways so capabilities

1030
00:37:47,619 --> 00:37:52,779
are these like power features that you

1031
00:37:50,619 --> 00:37:54,819
can just tack on into a process and let

1032
00:37:52,779 --> 00:37:56,980
you do all sorts of good things so how

1033
00:37:54,819 --> 00:37:58,960
about dak override let me talk about

1034
00:37:56,980 --> 00:38:00,309
what acts are and I mentioned that we're

1035
00:37:58,960 --> 00:38:02,529
gonna use the old lending stack and

1036
00:38:00,309 --> 00:38:04,180
we're gonna pull this on top now you

1037
00:38:02,529 --> 00:38:05,829
have a context the deck override none of

1038
00:38:04,180 --> 00:38:07,118
those rules apply in the kernel level it

1039
00:38:05,829 --> 00:38:10,369
doesn't matter if the file is readable

1040
00:38:07,119 --> 00:38:12,569
as anyone if you have that

1041
00:38:10,369 --> 00:38:15,720
Dec over I agreed obviously just for

1042
00:38:12,569 --> 00:38:18,690
reading sis module we can now we can out

1043
00:38:15,720 --> 00:38:20,810
randomly enforce if kernel modules are

1044
00:38:18,690 --> 00:38:23,579
loaded by having the SIS model

1045
00:38:20,810 --> 00:38:26,279
capability but as you can see down here

1046
00:38:23,579 --> 00:38:29,810
I'm looking for all the contacts that

1047
00:38:26,280 --> 00:38:32,369
have a exist module and the net D

1048
00:38:29,810 --> 00:38:35,910
capability aren't that big data has the

1049
00:38:32,369 --> 00:38:37,530
ability a little kernel modules or how

1050
00:38:35,910 --> 00:38:39,180
about this looks like we have a Wi-Fi

1051
00:38:37,530 --> 00:38:41,339
driver or something so there's still

1052
00:38:39,180 --> 00:38:42,419
avenues here that can be use it for

1053
00:38:41,339 --> 00:38:43,890
those of you who have to go with kernel

1054
00:38:42,420 --> 00:38:46,079
modules just let you load code in the

1055
00:38:43,890 --> 00:38:49,190
Linux kernel once you can do that it's

1056
00:38:46,079 --> 00:38:51,960
again game over because we can directly

1057
00:38:49,190 --> 00:38:54,030
F owner this one lets you basically you

1058
00:38:51,960 --> 00:38:55,500
just kind of destroys the file

1059
00:38:54,030 --> 00:38:57,780
permissions very similar back override

1060
00:38:55,500 --> 00:38:59,640
and some of these are just like super

1061
00:38:57,780 --> 00:39:01,349
privilege right I have this well I think

1062
00:38:59,640 --> 00:39:04,078
this is the Huawei networking daemon

1063
00:39:01,349 --> 00:39:05,430
here this thing to do everything right

1064
00:39:04,079 --> 00:39:08,550
so basically what this is saying is

1065
00:39:05,430 --> 00:39:10,950
don't worry about this process know just

1066
00:39:08,550 --> 00:39:12,270
don't apply the SE Android policies to

1067
00:39:10,950 --> 00:39:14,609
it it can do pretty much whatever it

1068
00:39:12,270 --> 00:39:15,750
wants so these are your high-value

1069
00:39:14,609 --> 00:39:18,480
targets and so things you're in love

1070
00:39:15,750 --> 00:39:19,680
with you to any particular phone can

1071
00:39:18,480 --> 00:39:22,770
have a number of these that you should

1072
00:39:19,680 --> 00:39:24,540
actually focus on so I wanted to kind of

1073
00:39:22,770 --> 00:39:25,770
wrap this up I know we're a few minutes

1074
00:39:24,540 --> 00:39:31,200
left here and just do a little quick

1075
00:39:25,770 --> 00:39:33,150
case thing so in 2016 well early 2016

1076
00:39:31,200 --> 00:39:35,640
I found a bunch of bugs in grenoble

1077
00:39:33,150 --> 00:39:37,560
phones that they try to downplay it but

1078
00:39:35,640 --> 00:39:39,509
it affected like 60 other different

1079
00:39:37,560 --> 00:39:42,150
models mostly international that the EU

1080
00:39:39,510 --> 00:39:44,190
root code execution also a privileged

1081
00:39:42,150 --> 00:39:46,230
context so not only can we have a remote

1082
00:39:44,190 --> 00:39:50,250
execution we also had a very privileged

1083
00:39:46,230 --> 00:39:52,650
context and it was kind of fun to spend

1084
00:39:50,250 --> 00:39:55,319
a lot of time creatively yeah you guys

1085
00:39:52,650 --> 00:39:56,790
like brothers should he go here but

1086
00:39:55,319 --> 00:39:59,310
anyway we were born into them and they

1087
00:39:56,790 --> 00:40:01,090
were receptive eventually and we finally

1088
00:39:59,310 --> 00:40:04,210
got a chance to blog about it

1089
00:40:01,090 --> 00:40:06,070
no more I wasn't started I'm pretty

1090
00:40:04,210 --> 00:40:09,100
proud of it it talks about in very

1091
00:40:06,070 --> 00:40:11,590
technical detail how we went through and

1092
00:40:09,100 --> 00:40:13,000
each PC to use that word son what they

1093
00:40:11,590 --> 00:40:13,810
are how they work how they play typing

1094
00:40:13,000 --> 00:40:16,270
so I'm going to talk about it very

1095
00:40:13,810 --> 00:40:20,140
briefly here but essentially it's code

1096
00:40:16,270 --> 00:40:22,210
execution is route through a a semi

1097
00:40:20,140 --> 00:40:23,770
protected unit side so again everything

1098
00:40:22,210 --> 00:40:26,050
kind of comes back to the state court

1099
00:40:23,770 --> 00:40:27,940
metals things like unique sockets since

1100
00:40:26,050 --> 00:40:30,520
the past really the targets we want to

1101
00:40:27,940 --> 00:40:33,280
focus on what we found is that there's

1102
00:40:30,520 --> 00:40:36,220
this process nak server is running his

1103
00:40:33,280 --> 00:40:39,460
route I was running a fairly privileged

1104
00:40:36,220 --> 00:40:41,259
SELinux I see every context it listens

1105
00:40:39,460 --> 00:40:42,820
on a local UNIX socket for those of you

1106
00:40:41,260 --> 00:40:45,220
not polluted UNIX sockets it's really

1107
00:40:42,820 --> 00:40:46,540
just a socket on IP addresses it's just

1108
00:40:45,220 --> 00:40:50,319
some sort of way to communicate between

1109
00:40:46,540 --> 00:40:52,540
ID processes and I I kid you not the

1110
00:40:50,320 --> 00:40:54,850
purpose of the statement is to receive a

1111
00:40:52,540 --> 00:40:56,860
command on the UNIX socket it executed

1112
00:40:54,850 --> 00:40:58,810
this is the literal definition of a

1113
00:40:56,860 --> 00:41:02,530
backdoor and this was on every little

1114
00:40:58,810 --> 00:41:04,630
phone worldwide so this let's pretend

1115
00:41:02,530 --> 00:41:07,060
that SC Linux is not around let's say we

1116
00:41:04,630 --> 00:41:08,830
didn't have it one gullibility game over

1117
00:41:07,060 --> 00:41:10,360
right where I done we have a process

1118
00:41:08,830 --> 00:41:11,950
running his room it's the same thing as

1119
00:41:10,360 --> 00:41:14,320
that HTC ball turbo that Chancellor

1120
00:41:11,950 --> 00:41:17,470
reported to the 14 but this one was on

1121
00:41:14,320 --> 00:41:18,790
every mobile home however there was the

1122
00:41:17,470 --> 00:41:20,470
Android on the phone that I had which

1123
00:41:18,790 --> 00:41:22,060
means we had to jump around a little bit

1124
00:41:20,470 --> 00:41:25,209
we couldn't just interact with the UNIX

1125
00:41:22,060 --> 00:41:26,980
socket because as you see here if I try

1126
00:41:25,210 --> 00:41:29,020
to connect someone using just so cat or

1127
00:41:26,980 --> 00:41:31,300
something I get permission denied and

1128
00:41:29,020 --> 00:41:33,310
then if you copy the kernel buffers

1129
00:41:31,300 --> 00:41:35,770
we'll see that yes there has been a SC

1130
00:41:33,310 --> 00:41:37,570
Linux prescient violation you cannot

1131
00:41:35,770 --> 00:41:40,330
access this out of that socket that's

1132
00:41:37,570 --> 00:41:41,920
wonderful but who can access that for

1133
00:41:40,330 --> 00:41:43,330
that socket that's our very next

1134
00:41:41,920 --> 00:41:46,660
question is if I can do it

1135
00:41:43,330 --> 00:41:49,120
okay well turns out if you're a system

1136
00:41:46,660 --> 00:41:52,210
app or a platform app you can do that

1137
00:41:49,120 --> 00:41:54,069
and there's also 60 or 70

1138
00:41:52,210 --> 00:41:54,570
platform apps on the phone that I was

1139
00:41:54,070 --> 00:41:58,350
happy

1140
00:41:54,570 --> 00:42:00,570
five by the way so now our target ship

1141
00:41:58,350 --> 00:42:03,180
now we're just going to find any running

1142
00:42:00,570 --> 00:42:06,120
process that's labeled as platform app

1143
00:42:03,180 --> 00:42:08,629
and here's one right here the idea

1144
00:42:06,120 --> 00:42:11,130
friend application this was their

1145
00:42:08,630 --> 00:42:14,280
Lenovo's implementation of the content

1146
00:42:11,130 --> 00:42:16,680
the contacts app which had a nice little

1147
00:42:14,280 --> 00:42:18,810
bug in it where they basically loaded

1148
00:42:16,680 --> 00:42:20,700
jars at runtime that were on signed and

1149
00:42:18,810 --> 00:42:22,680
executed code from them so we could

1150
00:42:20,700 --> 00:42:27,149
create backup of the app and then modify

1151
00:42:22,680 --> 00:42:29,279
the jars so it was code execution as a

1152
00:42:27,150 --> 00:42:31,830
platform app which is wonderful so now

1153
00:42:29,280 --> 00:42:33,030
we can talk to a socket you're just a

1154
00:42:31,830 --> 00:42:35,610
fun little picture of us running the

1155
00:42:33,030 --> 00:42:36,990
vulnerability by the exploit here we

1156
00:42:35,610 --> 00:42:38,670
basically create a bunch of custom

1157
00:42:36,990 --> 00:42:41,399
backups to your stage our payload and

1158
00:42:38,670 --> 00:42:42,930
then we can trigger the bug by talking

1159
00:42:41,400 --> 00:42:44,880
to the Uni sockets sending a the command

1160
00:42:42,930 --> 00:42:46,830
for it to run and lo and behold we have

1161
00:42:44,880 --> 00:42:49,080
a shell through here with this this

1162
00:42:46,830 --> 00:42:50,580
context called group Channel so like

1163
00:42:49,080 --> 00:42:52,319
they even knew what this was they label

1164
00:42:50,580 --> 00:42:55,350
it as root Channel because this was

1165
00:42:52,320 --> 00:42:57,180
meant to run group commands again it's

1166
00:42:55,350 --> 00:42:58,830
not a completely compromised in my mind

1167
00:42:57,180 --> 00:42:59,940
it was you know job well done you can do

1168
00:42:58,830 --> 00:43:01,529
a lot but there's a few things you

1169
00:42:59,940 --> 00:43:02,790
couldn't do for example you really

1170
00:43:01,530 --> 00:43:05,310
couldn't mess with the kernel too much

1171
00:43:02,790 --> 00:43:05,940
so we can't turn off that's the Android

1172
00:43:05,310 --> 00:43:07,650
that's great

1173
00:43:05,940 --> 00:43:09,150
that's actually pretty good and you

1174
00:43:07,650 --> 00:43:11,640
couldn't read my house so we couldn't

1175
00:43:09,150 --> 00:43:14,010
create like a persistent backdoor phone

1176
00:43:11,640 --> 00:43:18,930
but again we probably need one more bug

1177
00:43:14,010 --> 00:43:23,430
from here and we can buy some driver

1178
00:43:18,930 --> 00:43:26,339
that has issue with it and with that I

1179
00:43:23,430 --> 00:43:28,950
want to close things up here so just to

1180
00:43:26,340 --> 00:43:31,950
wrap up if you have a phone that is

1181
00:43:28,950 --> 00:43:33,359
sponsored or proved by Google that was

1182
00:43:31,950 --> 00:43:35,189
released after 2014

1183
00:43:33,360 --> 00:43:36,780
there's a very strong chance that your

1184
00:43:35,190 --> 00:43:37,830
phone is protected by a secret and

1185
00:43:36,780 --> 00:43:39,450
that's great you don't have to do

1186
00:43:37,830 --> 00:43:42,120
anything you don't even know that's

1187
00:43:39,450 --> 00:43:44,189
there you don't need to know it's really

1188
00:43:42,120 --> 00:43:46,770
changed where the attack surface looks

1189
00:43:44,190 --> 00:43:50,370
on phones and it's changed what the

1190
00:43:46,770 --> 00:43:52,620
Tigers are looking for and I think here

1191
00:43:50,370 --> 00:43:53,640
is another wrap up by them but masking

1192
00:43:52,620 --> 00:43:55,319
what this stuff is kind of a pain

1193
00:43:53,640 --> 00:43:57,330
because you have to go this lengthy

1194
00:43:55,320 --> 00:43:59,340
build process to get the binaries that

1195
00:43:57,330 --> 00:44:00,740
you need to actually plumb queries but

1196
00:43:59,340 --> 00:44:02,300
from there it's just using this

1197
00:44:00,740 --> 00:44:05,020
search by Harrington to dig around and

1198
00:44:02,300 --> 00:44:08,119
look for exciting things on your phone

1199
00:44:05,020 --> 00:44:10,040
the exploitation process has really no

1200
00:44:08,119 --> 00:44:11,600
longer justify group and then exploited

1201
00:44:10,040 --> 00:44:14,180
which for the longest time is when I

1202
00:44:11,600 --> 00:44:15,830
would you know just do ps4 ooh and then

1203
00:44:14,180 --> 00:44:17,299
I would look at unix sockets and find

1204
00:44:15,830 --> 00:44:18,350
which ones mapped to each other and then

1205
00:44:17,300 --> 00:44:19,850
I would just paused to that evening

1206
00:44:18,350 --> 00:44:22,880
socket and so we figured out what it did

1207
00:44:19,850 --> 00:44:24,940
I can only do that anymore which is good

1208
00:44:22,880 --> 00:44:27,080
you don't want that's a new case unless

1209
00:44:24,940 --> 00:44:32,450
OMS are disabled against the Android

1210
00:44:27,080 --> 00:44:33,890
which I could assure you with that here

1211
00:44:32,450 --> 00:44:35,960
are some additional resources so if you

1212
00:44:33,890 --> 00:44:37,940
want to learn more first definitely

1213
00:44:35,960 --> 00:44:39,710
start with this slide this slide back

1214
00:44:37,940 --> 00:44:41,690
here the case for security has enjoyed

1215
00:44:39,710 --> 00:44:43,850
this was written by God the NSA

1216
00:44:41,690 --> 00:44:46,310
basically championing us the Android say

1217
00:44:43,850 --> 00:44:48,110
hey this is why we need this he goes

1218
00:44:46,310 --> 00:44:49,580
through like four or five key sites

1219
00:44:48,110 --> 00:44:51,740
about why this is important is

1220
00:44:49,580 --> 00:44:53,240
beneficial very good starting point

1221
00:44:51,740 --> 00:44:55,220
really illustrates some of the case

1222
00:44:53,240 --> 00:44:58,129
studies I went through you made a lot of

1223
00:44:55,220 --> 00:44:59,540
good information there last year I got a

1224
00:44:58,130 --> 00:45:02,869
chance to see the a if we will talk

1225
00:44:59,540 --> 00:45:05,660
about why he's the head of security at

1226
00:45:02,869 --> 00:45:08,330
Android and he was talking about why

1227
00:45:05,660 --> 00:45:10,009
they decided to use SD enjoy but are

1228
00:45:08,330 --> 00:45:11,810
their motivations and put they see on

1229
00:45:10,010 --> 00:45:13,700
the Google side which again I'm work at

1230
00:45:11,810 --> 00:45:15,740
Google I'm not sponsored by Google but

1231
00:45:13,700 --> 00:45:17,149
this is a great idea it works very well

1232
00:45:15,740 --> 00:45:19,700
I also recommend checking that you can

1233
00:45:17,150 --> 00:45:21,350
find online recipes are just technical

1234
00:45:19,700 --> 00:45:23,540
applause this is these guys right here

1235
00:45:21,350 --> 00:45:25,220
oh man if you want to learn all the

1236
00:45:23,540 --> 00:45:26,660
functions that have been modified that

1237
00:45:25,220 --> 00:45:28,669
Linux kernel to support this there is

1238
00:45:26,660 --> 00:45:30,080
those of your slides right there the

1239
00:45:28,670 --> 00:45:32,300
Android documentation is also quite good

1240
00:45:30,080 --> 00:45:34,240
so check that out and then I included

1241
00:45:32,300 --> 00:45:37,160
the links to the fireEye blocks

1242
00:45:34,240 --> 00:45:41,509
Qualcomm elated vulnerability and Noble

1243
00:45:37,160 --> 00:45:42,859
vine and with that I wanted to see if

1244
00:45:41,510 --> 00:45:44,420
anyone had any questions I know

1245
00:45:42,859 --> 00:45:54,910
everyone's antsy it's lunch

1246
00:45:44,420 --> 00:45:54,910
does anyone have any questions kugel

1247
00:45:57,270 --> 00:46:01,470
Sims look very good actually Samsung

1248
00:45:59,670 --> 00:46:03,840
would be my I think my second pick so if

1249
00:46:01,470 --> 00:46:06,180
the Gould cares a lot about this and the

1250
00:46:03,840 --> 00:46:08,310
Nexus series the pixel series is what I

1251
00:46:06,180 --> 00:46:10,890
own anyway I wanna give you phone just

1252
00:46:08,310 --> 00:46:12,930
just buy the Nexus 5 pixel they don't

1253
00:46:10,890 --> 00:46:15,540
need my recommendation samsung also

1254
00:46:12,930 --> 00:46:23,040
cares a lot the other Korean

1255
00:46:15,540 --> 00:46:24,330
manufacturers are less less good they're

1256
00:46:23,040 --> 00:46:26,640
receptive but they're just not quite

1257
00:46:24,330 --> 00:46:28,350
unwell Samsung and then you've got a

1258
00:46:26,640 --> 00:46:29,940
whole different ball game you could be

1259
00:46:28,350 --> 00:46:32,730
diving this of the Chinese ones like

1260
00:46:29,940 --> 00:46:34,410
Xiaomi Huawei those ones just really

1261
00:46:32,730 --> 00:46:37,050
aren't as good they're actually getting

1262
00:46:34,410 --> 00:46:38,549
a lot better the Huawei honor I was

1263
00:46:37,050 --> 00:46:40,080
messing with earlier this year was

1264
00:46:38,550 --> 00:46:40,560
actually much better than I thought it

1265
00:46:40,080 --> 00:46:45,509
was gonna be

1266
00:46:40,560 --> 00:46:47,820
yeah the honor it's very good I had to

1267
00:46:45,510 --> 00:46:49,350
show me five to me five and that one

1268
00:46:47,820 --> 00:46:51,150
who's not very good bunch of bugs on

1269
00:46:49,350 --> 00:46:53,580
that pad it was hard to get a hold of

1270
00:46:51,150 --> 00:46:55,770
the show-me guys at report but anyway

1271
00:46:53,580 --> 00:46:56,910
they're much sort of doubles here below

1272
00:46:55,770 --> 00:46:59,580
I would say so

1273
00:46:56,910 --> 00:47:01,850
like Google mostly craniums in the

1274
00:46:59,580 --> 00:47:04,960
Chinese ones

1275
00:47:01,850 --> 00:47:04,960
[Music]

1276
00:47:10,420 --> 00:47:29,980
interview questions so they're there

1277
00:47:27,349 --> 00:47:32,029
forking the project and they're usually

1278
00:47:29,980 --> 00:47:33,380
they're usually pretty supportive of

1279
00:47:32,029 --> 00:47:35,660
things like SEO instance up they usually

1280
00:47:33,380 --> 00:47:36,980
make changes as well that's the question

1281
00:47:35,660 --> 00:47:38,598
I get a whole bunch when I talk about

1282
00:47:36,980 --> 00:47:39,769
the OEM stop they're always like well

1283
00:47:38,599 --> 00:47:41,480
how about like sighs you mob are they

1284
00:47:39,769 --> 00:47:43,189
doing and the question is I really don't

1285
00:47:41,480 --> 00:47:44,869
know I'd love to spend more time like

1286
00:47:43,190 --> 00:47:47,089
actually looking at with first decide to

1287
00:47:44,869 --> 00:47:49,490
monitor all these other various things

1288
00:47:47,089 --> 00:47:53,960
like that are doing my guess is they're

1289
00:47:49,490 --> 00:47:55,430
also not quite as good as Google I would

1290
00:47:53,960 --> 00:47:56,539
imagine that they're doing their best in

1291
00:47:55,430 --> 00:47:58,660
there they're probably keeping it on

1292
00:47:56,539 --> 00:48:00,740
yours I think all those os's want to

1293
00:47:58,660 --> 00:48:02,210
they want to still have the Google Play

1294
00:48:00,740 --> 00:48:22,848
services so they still need to use

1295
00:48:02,210 --> 00:48:25,460
things like I think I actually haven't

1296
00:48:22,849 --> 00:48:27,049
won that one plus I just don't have any

1297
00:48:25,460 --> 00:48:28,369
more plus devices but I actually would

1298
00:48:27,049 --> 00:48:30,288
really like today whether old is like

1299
00:48:28,369 --> 00:48:32,900
oxygen loss or whether they call it a

1300
00:48:30,289 --> 00:48:34,130
little for injury so I'd look at theirs

1301
00:48:32,900 --> 00:48:35,660
either but it's very similar like

1302
00:48:34,130 --> 00:48:41,289
they're working off it they're doing a

1303
00:48:35,660 --> 00:48:41,288
lot of changes that if I get my hands

1304
00:48:49,530 --> 00:48:54,609
No so it really comes down to is like

1305
00:48:52,660 --> 00:48:56,618
what phones do I want to buy because

1306
00:48:54,609 --> 00:49:00,069
some work it's like supporting what

1307
00:48:56,619 --> 00:49:01,900
they're like hey bones here so I I have

1308
00:49:00,069 --> 00:49:03,400
like hundreds of phones just like

1309
00:49:01,900 --> 00:49:04,690
sitting in like my closets up any

1310
00:49:03,400 --> 00:49:12,520
they're like brand-new phones that I

1311
00:49:04,690 --> 00:49:18,760
probably should sell but I buy only look

1312
00:49:12,520 --> 00:49:20,910
at it I actually really liked blackberry

1313
00:49:18,760 --> 00:49:23,650
phone so black guy came out with the

1314
00:49:20,910 --> 00:49:25,060
ribs if you know that doesn't fifteen

1315
00:49:23,650 --> 00:49:26,650
that's up to the phone that I found the

1316
00:49:25,060 --> 00:49:27,849
Qualcomm bug on smells like so excited

1317
00:49:26,650 --> 00:49:29,560
I'm like oh man I have the blackberry

1318
00:49:27,849 --> 00:49:32,410
and I'm like oh wait it's like every

1319
00:49:29,560 --> 00:49:34,740
phone but that phone was really good

1320
00:49:32,410 --> 00:49:39,879
like those guys they must have hired

1321
00:49:34,740 --> 00:49:41,319
like a really in the weeds because that

1322
00:49:39,880 --> 00:49:43,000
was actually what started Emma started

1323
00:49:41,319 --> 00:49:46,690
all this research is like I got the

1324
00:49:43,000 --> 00:49:48,490
print by my blackberry and I'm like man

1325
00:49:46,690 --> 00:49:49,720
the stink is like a rock like what is

1326
00:49:48,490 --> 00:49:50,950
going on here and then I realized all

1327
00:49:49,720 --> 00:49:52,660
the sexy lady so who's the end of the

1328
00:49:50,950 --> 00:49:54,250
way and then I would like try it on like

1329
00:49:52,660 --> 00:49:56,319
a nexus so I'm like man this is actually

1330
00:49:54,250 --> 00:49:58,540
like way better than will be started

1331
00:49:56,319 --> 00:50:00,160
with so I guess the answer your question

1332
00:49:58,540 --> 00:50:11,410
a little better blackberry is also very

1333
00:50:00,160 --> 00:50:15,040
good any other questions in you say or

1334
00:50:11,410 --> 00:50:17,920
you set up there about that with the

1335
00:50:15,040 --> 00:50:21,960
changes it greatly complicates hacking

1336
00:50:17,920 --> 00:50:24,579
it or breaking it for an attack surface

1337
00:50:21,960 --> 00:50:26,500
greatly complicated meaning that there

1338
00:50:24,579 --> 00:50:29,650
still could be a possibility of breaking

1339
00:50:26,500 --> 00:50:32,079
it yeah absolutely I don't mean I think

1340
00:50:29,650 --> 00:50:33,730
any seven and it's that making it harder

1341
00:50:32,079 --> 00:50:36,369
this is a good set right direction but

1342
00:50:33,730 --> 00:50:41,650
unfortunately there's something like an

1343
00:50:36,369 --> 00:50:43,150
unhackable phone is like for me the

1344
00:50:41,650 --> 00:50:44,770
harder they can make it and the harder

1345
00:50:43,150 --> 00:50:47,230
they can make it without even knowing I

1346
00:50:44,770 --> 00:50:49,420
think it's also a good idea but I mean

1347
00:50:47,230 --> 00:50:51,250
yeah there's I mean look at the Qualcomm

1348
00:50:49,420 --> 00:50:53,470
thing which works with s the Android but

1349
00:50:51,250 --> 00:50:55,780
although one works with se Android this

1350
00:50:53,470 --> 00:50:56,980
isn't B this is also isn't the only

1351
00:50:55,780 --> 00:50:58,990
feature

1352
00:50:56,980 --> 00:51:00,010
right like things like the Amer you

1353
00:50:58,990 --> 00:51:02,200
which have you talked about it has

1354
00:51:00,010 --> 00:51:04,119
really changed the senior as well that

1355
00:51:02,200 --> 00:51:06,160
provides secure cool and secure

1356
00:51:04,119 --> 00:51:07,510
framework there's a lot of other things

1357
00:51:06,160 --> 00:51:10,180
schools doing as well just to make this

1358
00:51:07,510 --> 00:51:34,810
threat landscape smaller but yes it's

1359
00:51:10,180 --> 00:51:37,598
it's always gonna be yeah I mean that's

1360
00:51:34,810 --> 00:51:39,910
a concern I think I think the developers

1361
00:51:37,599 --> 00:51:42,099
probably are aware of exactly what

1362
00:51:39,910 --> 00:51:45,270
function calls Maps permission thing so

1363
00:51:42,099 --> 00:51:47,349
they probably just read a sack or floor

1364
00:51:45,270 --> 00:51:50,109
phone mission or something and they're

1365
00:51:47,349 --> 00:51:53,320
very loose about that the other thing

1366
00:51:50,109 --> 00:51:55,630
too is with Apple models you're trusting

1367
00:51:53,320 --> 00:51:57,790
the OEMs right you're trusting that in

1368
00:51:55,630 --> 00:52:00,010
order to get the phone number I have to

1369
00:51:57,790 --> 00:52:01,930
provide information to do that guarantee

1370
00:52:00,010 --> 00:52:05,109
any phone in the market right now there

1371
00:52:01,930 --> 00:52:07,629
is a bypass for reading the meia without

1372
00:52:05,109 --> 00:52:10,060
because someone's going away maybe I

1373
00:52:07,630 --> 00:52:12,130
guess I don't know why but they're gonna

1374
00:52:10,060 --> 00:52:13,960
write an API in turn a subjective

1375
00:52:12,130 --> 00:52:16,000
immission constraints so the model kind

1376
00:52:13,960 --> 00:52:19,150
of falls apart when that's like

1377
00:52:16,000 --> 00:52:20,890
fundamentally broken I think the bill

1378
00:52:19,150 --> 00:52:41,680
Grady is does help you understand what

1379
00:52:20,890 --> 00:52:43,598
the app can do you'd probably need the

1380
00:52:41,680 --> 00:52:46,089
ability to load kernel module that in

1381
00:52:43,599 --> 00:52:48,310
the kernel either like or instruct over

1382
00:52:46,089 --> 00:52:50,470
on structures or disable it from the

1383
00:52:48,310 --> 00:52:52,150
kernel so you need code execution not

1384
00:52:50,470 --> 00:53:06,848
just as the root user but in the kernel

1385
00:52:52,150 --> 00:53:08,680
to kernel is the I guess you could

1386
00:53:06,849 --> 00:53:10,210
technically I guess overwrite the policy

1387
00:53:08,680 --> 00:53:12,190
pop all right so if you could if you

1388
00:53:10,210 --> 00:53:14,970
could somehow remail file systems it

1389
00:53:12,190 --> 00:53:18,430
over a policy file one label in files

1390
00:53:14,970 --> 00:53:19,660
that would be a attack vector there the

1391
00:53:18,430 --> 00:53:21,609
problem is those are all sort of

1392
00:53:19,660 --> 00:53:23,529
assistant partition because the DM very

1393
00:53:21,609 --> 00:53:26,049
that partition cannot change or the

1394
00:53:23,530 --> 00:53:28,150
phone so that's like I said more

1395
00:53:26,050 --> 00:53:31,300
features here you if the ID a like

1396
00:53:28,150 --> 00:53:33,160
persistent like boom kits or backdoors

1397
00:53:31,300 --> 00:53:36,130
on Android are kind of dead because you

1398
00:53:33,160 --> 00:53:38,770
have to also disable the Ameri which is

1399
00:53:36,130 --> 00:53:40,540
way harder and requires much more things

1400
00:53:38,770 --> 00:53:42,790
because you can't make changes to

1401
00:53:40,540 --> 00:53:44,470
sensitive files anymore so like you and

1402
00:53:42,790 --> 00:53:45,579
it's on with the SU binary is a trick

1403
00:53:44,470 --> 00:53:47,348
now because they have to have like a new

1404
00:53:45,579 --> 00:53:48,579
file system for it because they used to

1405
00:53:47,349 --> 00:53:51,010
just throw that high on the system

1406
00:53:48,579 --> 00:53:54,630
partition and then now you have a assume

1407
00:53:51,010 --> 00:53:54,630
I'm Harry but you can't do that anymore

1408
00:53:57,150 --> 00:54:00,260
[Music]

1409
00:54:07,240 --> 00:54:22,209
I think Google does I mean I honestly I

1410
00:54:21,010 --> 00:54:23,770
can't speak to exactly what they're

1411
00:54:22,210 --> 00:54:26,260
doing just cuz I don't have a lot of

1412
00:54:23,770 --> 00:54:30,460
visibility into that many arguing things

1413
00:54:26,260 --> 00:54:32,770
but is it enough maybe a lot of it also

1414
00:54:30,460 --> 00:54:35,290
comes down to I have a lot of homes that

1415
00:54:32,770 --> 00:54:37,150
are Google's sponsored are approved

1416
00:54:35,290 --> 00:54:38,890
which means that using third-party app

1417
00:54:37,150 --> 00:54:40,990
stores and who knows what they're doing

1418
00:54:38,890 --> 00:54:42,310
right like used to be a lot of the

1419
00:54:40,990 --> 00:54:44,680
Chinese phones have their own markets

1420
00:54:42,310 --> 00:54:47,080
and it's you have a whole different

1421
00:54:44,680 --> 00:54:50,440
ballpark when that's not what Google

1422
00:54:47,080 --> 00:54:52,810
intended for things to do and I think

1423
00:54:50,440 --> 00:54:55,080
that that is probably more of a risk to

1424
00:54:52,810 --> 00:54:58,690
me is having the other markets that I

1425
00:54:55,080 --> 00:55:27,369
think Google does that or something I

1426
00:54:58,690 --> 00:55:30,460
imagine if I wanted to I think it helps

1427
00:55:27,369 --> 00:55:32,400
in terms of like this thing and this

1428
00:55:30,460 --> 00:55:34,210
like whole thing America probably not

1429
00:55:32,400 --> 00:55:36,310
there like definitely like data

1430
00:55:34,210 --> 00:55:38,340
investment stuff like the actually

1431
00:55:36,310 --> 00:55:41,770
they're changing how encryption works do

1432
00:55:38,340 --> 00:55:44,020
they're actually go into a more I Oh s

1433
00:55:41,770 --> 00:55:45,820
like model work there's like a key that

1434
00:55:44,020 --> 00:55:48,609
derives other keys which then are you

1435
00:55:45,820 --> 00:55:51,609
some like profile basis that's like I

1436
00:55:48,609 --> 00:55:53,410
think it would Oreo but I don't know if

1437
00:55:51,609 --> 00:55:55,150
it's gonna affect this process because

1438
00:55:53,410 --> 00:55:57,670
all this stuff is gonna be once the

1439
00:55:55,150 --> 00:56:00,340
phones on and run again once that also

1440
00:55:57,670 --> 00:56:02,350
is transparent to us that but I'm sure

1441
00:56:00,340 --> 00:56:05,100
it helps like everything else right

1442
00:56:02,350 --> 00:56:06,609
anything they can do think it's harder

1443
00:56:05,100 --> 00:56:07,779
okay

1444
00:56:06,609 --> 00:56:09,890
great and then that's all the questions

1445
00:56:07,780 --> 00:56:12,210
here guys this is my contact

1446
00:56:09,890 --> 00:56:14,098
you want to talk to me man name email

1447
00:56:12,210 --> 00:56:16,890
it's on there but also my personal email

1448
00:56:14,099 --> 00:56:19,530
my Twitter tweet at me all forgot I

1449
00:56:16,890 --> 00:56:21,569
retweet things and just some of my other

1450
00:56:19,530 --> 00:56:22,859
stuff before our research blog I kind of

1451
00:56:21,569 --> 00:56:25,319
put stuff on it when everybody gets

1452
00:56:22,859 --> 00:56:27,538
people stuff my blog my website my

1453
00:56:25,319 --> 00:56:30,950
github what's wrong as well so thanks

1454
00:56:27,539 --> 00:56:30,950
for joining us with you guys something

