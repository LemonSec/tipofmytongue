1
00:00:00,000 --> 00:00:01,120
okay cool

2
00:00:01,120 --> 00:00:03,280
so yeah hi my name is johnny so i'm a

3
00:00:03,280 --> 00:00:05,279
phd student in the practice lab at stony

4
00:00:05,279 --> 00:00:07,200
brook university and today i'm going to

5
00:00:07,200 --> 00:00:09,679
be presenting our work on residual trust

6
00:00:09,679 --> 00:00:11,920
and dns or domain names and it's titled

7
00:00:11,920 --> 00:00:13,360
domains do change their spots

8
00:00:13,360 --> 00:00:15,200
quantifying potential abuse of residual

9
00:00:15,200 --> 00:00:16,880
trust and i worked on this with my

10
00:00:16,880 --> 00:00:20,480
colleagues najme and mike as well as my

11
00:00:20,480 --> 00:00:23,519
advisor nick from stony brook

12
00:00:23,519 --> 00:00:24,800
cool so

13
00:00:24,800 --> 00:00:26,240
first off

14
00:00:26,240 --> 00:00:28,000
everyone knows what dns is it's the

15
00:00:28,000 --> 00:00:29,760
domain name system it ties human

16
00:00:29,760 --> 00:00:32,399
readable domain names to ips and not

17
00:00:32,399 --> 00:00:34,800
only now do people rely on this but also

18
00:00:34,800 --> 00:00:37,040
the software on our devices right so

19
00:00:37,040 --> 00:00:38,879
we've come to kind of trust

20
00:00:38,879 --> 00:00:40,480
these domain names to do certain things

21
00:00:40,480 --> 00:00:42,079
for us so for example you would go to

22
00:00:42,079 --> 00:00:45,360
maybe gmail for your mail or a citibank

23
00:00:45,360 --> 00:00:47,360
or chase to handle like your financial

24
00:00:47,360 --> 00:00:49,280
banking services

25
00:00:49,280 --> 00:00:50,879
now this is all nice and everything but

26
00:00:50,879 --> 00:00:52,719
there is a small problem here which is

27
00:00:52,719 --> 00:00:54,960
that these domains can change ownership

28
00:00:54,960 --> 00:00:56,480
right and there's no there's no

29
00:00:56,480 --> 00:00:57,920
mechanism that tells you like when this

30
00:00:57,920 --> 00:00:59,760
happens as a user so if you're an

31
00:00:59,760 --> 00:01:01,600
unaware client if it's your phone maybe

32
00:01:01,600 --> 00:01:04,280
checking for updates from

33
00:01:04,280 --> 00:01:05,840
update.microsoft.com or something like

34
00:01:05,840 --> 00:01:08,240
that now that these will continue to

35
00:01:08,240 --> 00:01:10,080
contact them and potentially expose

36
00:01:10,080 --> 00:01:12,080
information that you wouldn't want to

37
00:01:12,080 --> 00:01:14,880
expose to a new person who manages these

38
00:01:14,880 --> 00:01:16,880
domains

39
00:01:16,880 --> 00:01:18,880
so in this work

40
00:01:18,880 --> 00:01:20,880
we're kind of trying to quantify how

41
00:01:20,880 --> 00:01:22,640
this can be abused or to what extent

42
00:01:22,640 --> 00:01:24,080
this can be abused as a potential

43
00:01:24,080 --> 00:01:26,479
adversary so we introduce

44
00:01:26,479 --> 00:01:27,759
an infrastructure that can help

45
00:01:27,759 --> 00:01:29,600
efficiently identify domains for you

46
00:01:29,600 --> 00:01:31,119
that have residual trust that can be

47
00:01:31,119 --> 00:01:34,159
abused and we show that new owners can

48
00:01:34,159 --> 00:01:36,400
identify these services

49
00:01:36,400 --> 00:01:38,079
using not only the traffic logs from

50
00:01:38,079 --> 00:01:40,880
their domains but also using archived

51
00:01:40,880 --> 00:01:42,640
versions of websites and references on

52
00:01:42,640 --> 00:01:45,680
the internet and we also have an i think

53
00:01:45,680 --> 00:01:47,280
a cool finding that residual trust

54
00:01:47,280 --> 00:01:49,119
traffic is not guaranteed to decay over

55
00:01:49,119 --> 00:01:51,680
time which is kind of counter-intuitive

56
00:01:51,680 --> 00:01:53,439
but overall we show that this abuse can

57
00:01:53,439 --> 00:01:54,880
affect millions of ips and you don't

58
00:01:54,880 --> 00:01:57,680
have to spend a pretty penny to do so

59
00:01:57,680 --> 00:01:59,119
so we do this by

60
00:01:59,119 --> 00:02:00,640
re-registering basically a bunch of

61
00:02:00,640 --> 00:02:03,280
expired domains and then recording all

62
00:02:03,280 --> 00:02:04,960
the requests to our honeypot that we

63
00:02:04,960 --> 00:02:06,399
deploy and then doing some traffic

64
00:02:06,399 --> 00:02:08,800
analysis to show that

65
00:02:08,800 --> 00:02:10,080
this is

66
00:02:10,080 --> 00:02:11,520
a larger problem than we initially

67
00:02:11,520 --> 00:02:13,760
thought it was

68
00:02:13,760 --> 00:02:15,599
so uh for the rest of this talk i'm

69
00:02:15,599 --> 00:02:17,599
gonna be basically presenting a brief

70
00:02:17,599 --> 00:02:19,840
outline of how the domain expiration

71
00:02:19,840 --> 00:02:21,200
process goes

72
00:02:21,200 --> 00:02:22,400
and then going into the infrastructure

73
00:02:22,400 --> 00:02:24,160
and methodology that we use as well as

74
00:02:24,160 --> 00:02:26,080
highlighting some of our major results

75
00:02:26,080 --> 00:02:29,760
and summarizing it at the end

76
00:02:29,760 --> 00:02:30,640
so

77
00:02:30,640 --> 00:02:32,959
for domain exploration the domains are

78
00:02:32,959 --> 00:02:35,120
managed by essentially who governs the

79
00:02:35,120 --> 00:02:37,040
top level domain that it resides under

80
00:02:37,040 --> 00:02:39,120
so if you for example have

81
00:02:39,120 --> 00:02:41,360
expiringdomain.com you're managed by the

82
00:02:41,360 --> 00:02:44,400
people who manage the com tld which is

83
00:02:44,400 --> 00:02:46,239
icann or the internet corporation for

84
00:02:46,239 --> 00:02:47,840
assign names and numbers and they have a

85
00:02:47,840 --> 00:02:49,840
process called the expired registration

86
00:02:49,840 --> 00:02:52,000
recovery policy and this among other

87
00:02:52,000 --> 00:02:54,560
things details like a timeline of when

88
00:02:54,560 --> 00:02:56,800
and how these domains are to be expired

89
00:02:56,800 --> 00:02:59,040
so in short

90
00:02:59,040 --> 00:03:01,519
you can essentially lease a domain for

91
00:03:01,519 --> 00:03:03,200
up to 10 years and then you have to

92
00:03:03,200 --> 00:03:06,319
renew it or else it expires and this erp

93
00:03:06,319 --> 00:03:08,720
the expired registration recovery policy

94
00:03:08,720 --> 00:03:10,720
mandates that registrars have to notify

95
00:03:10,720 --> 00:03:12,879
the owners of expiring domains

96
00:03:12,879 --> 00:03:14,720
approximately a month before they expire

97
00:03:14,720 --> 00:03:16,879
and about a week before they expire now

98
00:03:16,879 --> 00:03:18,159
if they don't

99
00:03:18,159 --> 00:03:20,800
delete the domain within five days after

100
00:03:20,800 --> 00:03:22,080
it has expired then they're also

101
00:03:22,080 --> 00:03:23,760
required to send out another

102
00:03:23,760 --> 00:03:26,319
notification and then the deletion of

103
00:03:26,319 --> 00:03:28,000
the domain by the registrar can occur

104
00:03:28,000 --> 00:03:31,120
anywhere up to 45 days after that

105
00:03:31,120 --> 00:03:32,799
and then when this when this domain

106
00:03:32,799 --> 00:03:34,959
becomes or it is deleted by the

107
00:03:34,959 --> 00:03:37,120
registrar it enters the redemption grace

108
00:03:37,120 --> 00:03:38,159
period

109
00:03:38,159 --> 00:03:40,319
um this essentially is a 30-day period

110
00:03:40,319 --> 00:03:42,640
at which domain owners can renew their

111
00:03:42,640 --> 00:03:44,480
domains but typically at a higher price

112
00:03:44,480 --> 00:03:46,560
than if they had done so earlier and

113
00:03:46,560 --> 00:03:48,959
then five days after this process ends

114
00:03:48,959 --> 00:03:51,599
it becomes released to the public

115
00:03:51,599 --> 00:03:53,360
now nowhere in this um as i mentioned

116
00:03:53,360 --> 00:03:55,760
before do the clients get notified so

117
00:03:55,760 --> 00:03:57,840
the owners can tell they get an email

118
00:03:57,840 --> 00:03:59,040
maybe they check it maybe they don't

119
00:03:59,040 --> 00:04:01,120
check it and then expires but the

120
00:04:01,120 --> 00:04:03,760
clients are essentially

121
00:04:03,760 --> 00:04:05,680
in limbo nobody tells them anything so

122
00:04:05,680 --> 00:04:07,760
it's up to them to entirely decide when

123
00:04:07,760 --> 00:04:09,200
and if they should stop trying to

124
00:04:09,200 --> 00:04:12,159
contact a domain

125
00:04:12,959 --> 00:04:16,000
so if we pivot back to our work here um

126
00:04:16,000 --> 00:04:18,079
i'll go over the high level overview of

127
00:04:18,079 --> 00:04:20,720
like what our experiment is in terms of

128
00:04:20,720 --> 00:04:22,240
the infrastructure components and what

129
00:04:22,240 --> 00:04:24,560
we do for each so we start off with how

130
00:04:24,560 --> 00:04:26,880
we select domains how we deploy them and

131
00:04:26,880 --> 00:04:30,560
the traffic analysis that we perform

132
00:04:30,639 --> 00:04:32,560
so at a high level if we start at the

133
00:04:32,560 --> 00:04:34,080
left

134
00:04:34,080 --> 00:04:35,360
okay i'm not going to use the pointer

135
00:04:35,360 --> 00:04:37,040
because i don't think this angle works

136
00:04:37,040 --> 00:04:39,440
but start at the left we get a bunch of

137
00:04:39,440 --> 00:04:41,280
domains that are expiring every day and

138
00:04:41,280 --> 00:04:43,040
then we try to re-register them we

139
00:04:43,040 --> 00:04:44,880
deploy them with some honeypot services

140
00:04:44,880 --> 00:04:46,800
to record some traffic and then at the

141
00:04:46,800 --> 00:04:48,160
end we

142
00:04:48,160 --> 00:04:51,520
analyze all the traffic in aggregate

143
00:04:51,520 --> 00:04:53,520
but how exactly do we identify domains

144
00:04:53,520 --> 00:04:55,840
that are of interest to us well there's

145
00:04:55,840 --> 00:04:57,440
a bunch of drop cash services that tell

146
00:04:57,440 --> 00:04:59,120
you which domains are dropping to the

147
00:04:59,120 --> 00:05:01,440
public market on that day so we get a

148
00:05:01,440 --> 00:05:03,280
list of these domains from these people

149
00:05:03,280 --> 00:05:06,160
and then we find the ones that

150
00:05:06,160 --> 00:05:07,600
kind of

151
00:05:07,600 --> 00:05:09,759
are popular enough for us to re-register

152
00:05:09,759 --> 00:05:11,280
and we define this popular metric

153
00:05:11,280 --> 00:05:12,880
essentially by

154
00:05:12,880 --> 00:05:14,800
this intuition that if you have a lot of

155
00:05:14,800 --> 00:05:17,280
traffic before you expire chances are

156
00:05:17,280 --> 00:05:18,800
due to the sheer size of your user base

157
00:05:18,800 --> 00:05:20,960
you'll get some traffic after you expire

158
00:05:20,960 --> 00:05:22,240
as well

159
00:05:22,240 --> 00:05:24,320
so we use a passive dns database to kind

160
00:05:24,320 --> 00:05:26,320
of get an estimate on the traffic

161
00:05:26,320 --> 00:05:28,000
popularity of these by getting an

162
00:05:28,000 --> 00:05:29,520
estimate on the number of dns

163
00:05:29,520 --> 00:05:31,759
resolutions

164
00:05:31,759 --> 00:05:33,520
and then we kind of figured in the

165
00:05:33,520 --> 00:05:35,360
beginning that this would be reasonable

166
00:05:35,360 --> 00:05:37,759
um even though there are drop catchers

167
00:05:37,759 --> 00:05:39,600
in the drop catch industry and these

168
00:05:39,600 --> 00:05:41,039
people are essentially looking for

169
00:05:41,039 --> 00:05:43,520
domains that are of high value to them

170
00:05:43,520 --> 00:05:45,199
and they essentially try to register it

171
00:05:45,199 --> 00:05:47,440
within the second that it becomes public

172
00:05:47,440 --> 00:05:49,120
but we reason that there are some

173
00:05:49,120 --> 00:05:51,360
security critical domains which are of

174
00:05:51,360 --> 00:05:53,120
interest to us that are not of interest

175
00:05:53,120 --> 00:05:55,039
to them an example could be a really

176
00:05:55,039 --> 00:05:57,120
long name server domain that's not

177
00:05:57,120 --> 00:05:58,639
memorable it's not short it's not going

178
00:05:58,639 --> 00:06:02,720
to be user facing or an api server

179
00:06:03,440 --> 00:06:04,880
and then after we are able to be

180
00:06:04,880 --> 00:06:07,440
registered these domains we deploy them

181
00:06:07,440 --> 00:06:10,560
we have a pre-allocated block of

182
00:06:10,560 --> 00:06:13,759
i think two block two classy ip blocks

183
00:06:13,759 --> 00:06:16,160
we get one ip we give it to the domain

184
00:06:16,160 --> 00:06:18,000
we configure the dns entry and then we

185
00:06:18,000 --> 00:06:19,360
deploy

186
00:06:19,360 --> 00:06:21,520
a web server a low interaction ssh

187
00:06:21,520 --> 00:06:24,960
telnet and ftp honeypots

188
00:06:25,440 --> 00:06:28,240
and then at the end all the traffic logs

189
00:06:28,240 --> 00:06:30,400
are aggregated to a centralized node for

190
00:06:30,400 --> 00:06:32,479
later analysis and then we

191
00:06:32,479 --> 00:06:34,240
basically we inspect all the traffic and

192
00:06:34,240 --> 00:06:36,720
do a reiter reiterative process of

193
00:06:36,720 --> 00:06:39,199
designing the pipelines and then

194
00:06:39,199 --> 00:06:42,240
checking the output artifacts

195
00:06:42,240 --> 00:06:43,680
so

196
00:06:43,680 --> 00:06:45,440
for the residual trust detection which

197
00:06:45,440 --> 00:06:48,000
is the main goal of this work

198
00:06:48,000 --> 00:06:49,599
not only do we want to identify

199
00:06:49,599 --> 00:06:51,280
instances of traffic that is coming to

200
00:06:51,280 --> 00:06:53,280
us because of residual trust it's also

201
00:06:53,280 --> 00:06:55,120
helpful to identify the traffic that is

202
00:06:55,120 --> 00:06:56,639
not coming to us because of residual

203
00:06:56,639 --> 00:06:58,000
trust and essentially these are just

204
00:06:58,000 --> 00:06:59,759
coming to us because we're online we're

205
00:06:59,759 --> 00:07:00,720
public

206
00:07:00,720 --> 00:07:02,400
these can be ip scans or people just

207
00:07:02,400 --> 00:07:04,160
like trying to exploit whatever services

208
00:07:04,160 --> 00:07:06,160
they find

209
00:07:06,160 --> 00:07:07,840
so essentially if we are from the

210
00:07:07,840 --> 00:07:09,759
viewpoint of reregister.com we have a

211
00:07:09,759 --> 00:07:11,280
bunch of traffic that's coming to us but

212
00:07:11,280 --> 00:07:13,919
if we can label what we call bot for

213
00:07:13,919 --> 00:07:15,599
simplicity the automated traffic that's

214
00:07:15,599 --> 00:07:17,120
not because of residual trust in

215
00:07:17,120 --> 00:07:18,720
addition to the residual trust traffic

216
00:07:18,720 --> 00:07:21,120
that'll yield a um

217
00:07:21,120 --> 00:07:22,720
essentially a higher confidence in our

218
00:07:22,720 --> 00:07:25,199
findings

219
00:07:25,520 --> 00:07:26,960
so yeah so essentially our pipelines

220
00:07:26,960 --> 00:07:28,880
consist of these bot filters or the

221
00:07:28,880 --> 00:07:31,039
blockless filters which match the

222
00:07:31,039 --> 00:07:33,120
not residual trust patterns as well as

223
00:07:33,120 --> 00:07:34,400
the allow list or truss filters that

224
00:07:34,400 --> 00:07:35,840
match the ones that are coming to us

225
00:07:35,840 --> 00:07:37,599
because of residual trust and if you

226
00:07:37,599 --> 00:07:40,000
notice the one on the top the one two

227
00:07:40,000 --> 00:07:43,039
three four ip is labeled about because

228
00:07:43,039 --> 00:07:44,720
they match bot filters as well stress

229
00:07:44,720 --> 00:07:46,160
filters so the bot filters are assigned

230
00:07:46,160 --> 00:07:48,560
more weight here so if they exhibit any

231
00:07:48,560 --> 00:07:50,800
what we deem suspicious behavior that

232
00:07:50,800 --> 00:07:52,720
will always take precedent over what we

233
00:07:52,720 --> 00:07:54,240
deem trust

234
00:07:54,240 --> 00:07:56,479
and here we're tagging the source ips

235
00:07:56,479 --> 00:07:57,840
because these are a lower bound on the

236
00:07:57,840 --> 00:07:59,440
number of clients that are actually

237
00:07:59,440 --> 00:08:02,160
connecting to us

238
00:08:02,479 --> 00:08:04,000
okay so if we go a little bit more in

239
00:08:04,000 --> 00:08:05,919
depth about um what we're actually

240
00:08:05,919 --> 00:08:08,400
looking for in the traffic so we have

241
00:08:08,400 --> 00:08:09,840
three different categories our first one

242
00:08:09,840 --> 00:08:11,280
is the ones that are inherent in the

243
00:08:11,280 --> 00:08:13,360
architecture and the infrastructure

244
00:08:13,360 --> 00:08:15,039
so the first is a placebo server or what

245
00:08:15,039 --> 00:08:17,360
we call possible servers these are

246
00:08:17,360 --> 00:08:19,039
essentially servers that don't have a

247
00:08:19,039 --> 00:08:21,039
domain name associated with them but

248
00:08:21,039 --> 00:08:22,879
they're configured identically otherwise

249
00:08:22,879 --> 00:08:25,120
so we reason that whoever's coming to us

250
00:08:25,120 --> 00:08:26,720
on these placebos or just people who are

251
00:08:26,720 --> 00:08:28,240
scanning the internet

252
00:08:28,240 --> 00:08:30,639
we have designed some

253
00:08:30,639 --> 00:08:33,919
traps on the web so whatever web page we

254
00:08:33,919 --> 00:08:36,559
send we send like a basic 404 with these

255
00:08:36,559 --> 00:08:38,479
bot traps and then these are designed to

256
00:08:38,479 --> 00:08:40,320
lure bots into requesting paths that

257
00:08:40,320 --> 00:08:42,240
normal users never would so an example

258
00:08:42,240 --> 00:08:44,320
could be

259
00:08:44,320 --> 00:08:47,200
a url and an html comment nobody's ever

260
00:08:47,200 --> 00:08:48,560
going to click on that but if we see

261
00:08:48,560 --> 00:08:50,320
request to them that is an indicator

262
00:08:50,320 --> 00:08:52,000
that someone is just parsing the html

263
00:08:52,000 --> 00:08:54,320
and scraping all the links and then the

264
00:08:54,320 --> 00:08:55,600
last thing we have

265
00:08:55,600 --> 00:08:58,399
also on https is uh fingerprinting

266
00:08:58,399 --> 00:09:00,160
script we mainly use this to check for

267
00:09:00,160 --> 00:09:02,800
the exist for the support of javascript

268
00:09:02,800 --> 00:09:04,959
from whatever user agent that they're

269
00:09:04,959 --> 00:09:07,200
requesting and connecting to us from

270
00:09:07,200 --> 00:09:09,040
and we know that most bots from prior

271
00:09:09,040 --> 00:09:12,800
work don't actually support javascript

272
00:09:12,800 --> 00:09:14,720
the next are just basic request

273
00:09:14,720 --> 00:09:17,360
characteristics of each protocol so um

274
00:09:17,360 --> 00:09:18,959
i'd like to highlight that for

275
00:09:18,959 --> 00:09:20,880
every one of these domains we write we

276
00:09:20,880 --> 00:09:22,959
register 200 of these domains we

277
00:09:22,959 --> 00:09:24,560
actually tried to manually profile and

278
00:09:24,560 --> 00:09:26,240
categorize the services that they used

279
00:09:26,240 --> 00:09:28,880
to offer before they had expired

280
00:09:28,880 --> 00:09:30,080
and then from

281
00:09:30,080 --> 00:09:31,839
this we looked at basically like wayback

282
00:09:31,839 --> 00:09:34,080
machine for archived versions we tried

283
00:09:34,080 --> 00:09:35,680
to look for third-party references on

284
00:09:35,680 --> 00:09:38,240
like other websites of these domains and

285
00:09:38,240 --> 00:09:39,600
if we were able to find an archived

286
00:09:39,600 --> 00:09:40,800
version we

287
00:09:40,800 --> 00:09:42,720
looked essentially at the home page of

288
00:09:42,720 --> 00:09:44,959
the archive site and then constructed a

289
00:09:44,959 --> 00:09:47,200
per domain set of url patterns and these

290
00:09:47,200 --> 00:09:48,880
are excluding the general ones so these

291
00:09:48,880 --> 00:09:50,399
should be related to whatever service

292
00:09:50,399 --> 00:09:52,000
they used to offer so if they were like

293
00:09:52,000 --> 00:09:53,920
a video streaming site we looked at you

294
00:09:53,920 --> 00:09:56,080
know the ones that related to

295
00:09:56,080 --> 00:09:59,360
slash genre slash you know id of the

296
00:09:59,360 --> 00:10:01,120
movie and stuff like that

297
00:10:01,120 --> 00:10:04,640
and then in addition for https and ftp

298
00:10:04,640 --> 00:10:06,560
telnet and ssh all the credentials ones

299
00:10:06,560 --> 00:10:08,560
we just looked at the ones that seemed

300
00:10:08,560 --> 00:10:10,320
suspicious as if they were trying to

301
00:10:10,320 --> 00:10:12,560
exploit us or if they were just you know

302
00:10:12,560 --> 00:10:14,000
hammering whatever they found on a

303
00:10:14,000 --> 00:10:16,880
password database breach

304
00:10:16,880 --> 00:10:18,560
we only use rockview for this so it's

305
00:10:18,560 --> 00:10:20,560
kind of old in terms of the database

306
00:10:20,560 --> 00:10:22,800
breach that we're actually looking at

307
00:10:22,800 --> 00:10:24,720
but um i'll get a little bit more into

308
00:10:24,720 --> 00:10:26,399
that later and then the last thing we

309
00:10:26,399 --> 00:10:28,720
look at is just um checking if some of

310
00:10:28,720 --> 00:10:30,160
these packets that we're getting match

311
00:10:30,160 --> 00:10:33,839
like a known mira characteristic

312
00:10:33,839 --> 00:10:35,440
not too important but essentially it's

313
00:10:35,440 --> 00:10:37,519
just checking if the tcp sequence number

314
00:10:37,519 --> 00:10:38,959
is the same as the ip address

315
00:10:38,959 --> 00:10:42,959
destination when displayed by bedfight

316
00:10:42,959 --> 00:10:44,880
okay and the last category of filters

317
00:10:44,880 --> 00:10:47,440
that we use are external these are dns

318
00:10:47,440 --> 00:10:49,279
block lists and ip block lists from fire

319
00:10:49,279 --> 00:10:51,519
hall and essentially dns block list

320
00:10:51,519 --> 00:10:53,600
person were originally intended to

321
00:10:53,600 --> 00:10:55,519
protect your mail servers from spam but

322
00:10:55,519 --> 00:10:56,480
we

323
00:10:56,480 --> 00:10:58,160
reason that whoever is coming to us that

324
00:10:58,160 --> 00:10:59,680
is also on these block lists are not

325
00:10:59,680 --> 00:11:01,600
coming to us because of residual trust

326
00:11:01,600 --> 00:11:03,360
and these ip block lists from fire hall

327
00:11:03,360 --> 00:11:05,600
are aggregated for cyber crime and

328
00:11:05,600 --> 00:11:07,360
whoever is trying to exploit

329
00:11:07,360 --> 00:11:08,880
things and then they aggregate these

330
00:11:08,880 --> 00:11:10,959
from multiple providers and provide

331
00:11:10,959 --> 00:11:14,720
a centralized location to fetch them

332
00:11:14,720 --> 00:11:16,399
okay so that was the main overview for

333
00:11:16,399 --> 00:11:18,720
the methodology and infrastructure now

334
00:11:18,720 --> 00:11:19,839
i'd like to highlight some of the

335
00:11:19,839 --> 00:11:20,959
results we have starting with some

336
00:11:20,959 --> 00:11:23,040
high-level stuff and going into

337
00:11:23,040 --> 00:11:24,640
what we have as case studies in the

338
00:11:24,640 --> 00:11:26,640
paper

339
00:11:26,640 --> 00:11:28,079
so at a high level uh i think i

340
00:11:28,079 --> 00:11:31,120
mentioned we registered uh 201 not 200

341
00:11:31,120 --> 00:11:33,200
of these expired domains spending about

342
00:11:33,200 --> 00:11:34,800
seven dollars in change on average for

343
00:11:34,800 --> 00:11:35,839
each of them

344
00:11:35,839 --> 00:11:37,839
we recorded 650 million requests from

345
00:11:37,839 --> 00:11:39,920
five and a half million ips over four

346
00:11:39,920 --> 00:11:40,800
months

347
00:11:40,800 --> 00:11:43,360
and before we proceed with any analysis

348
00:11:43,360 --> 00:11:44,720
on like what our filters are detected

349
00:11:44,720 --> 00:11:46,399
and what they didn't detect

350
00:11:46,399 --> 00:11:48,079
we have kind of like a high level sanity

351
00:11:48,079 --> 00:11:49,519
check here of what our filters are

352
00:11:49,519 --> 00:11:51,279
designed to do by comparing them against

353
00:11:51,279 --> 00:11:53,040
the block list so we basically use all

354
00:11:53,040 --> 00:11:54,480
the filters besides the block list and

355
00:11:54,480 --> 00:11:56,720
compare the results of using only the

356
00:11:56,720 --> 00:11:58,399
block list and we find that

357
00:11:58,399 --> 00:12:00,480
approximately 80 of

358
00:12:00,480 --> 00:12:02,720
what our filters matched as suspicious

359
00:12:02,720 --> 00:12:05,120
are also matched on the block list so

360
00:12:05,120 --> 00:12:07,200
these ips are exhibiting

361
00:12:07,200 --> 00:12:08,880
behaviors that we deem suspicious and

362
00:12:08,880 --> 00:12:10,480
they're already appearing on industry

363
00:12:10,480 --> 00:12:12,240
standard block lists so this is kind of

364
00:12:12,240 --> 00:12:14,160
good because it verifies what we're

365
00:12:14,160 --> 00:12:16,000
looking for but it's also useful because

366
00:12:16,000 --> 00:12:18,399
that extra 20 that's not matching

367
00:12:18,399 --> 00:12:19,120
are

368
00:12:19,120 --> 00:12:20,639
coming to us and we don't have to resort

369
00:12:20,639 --> 00:12:24,240
to a trusted third party for this

370
00:12:24,240 --> 00:12:26,720
okay so in terms of the honey pots and

371
00:12:26,720 --> 00:12:28,800
what um the pipelines resulted as so

372
00:12:28,800 --> 00:12:31,360
this is a sankey diagram um showing the

373
00:12:31,360 --> 00:12:32,720
set of ip addresses all the way on the

374
00:12:32,720 --> 00:12:34,639
left from all of them and then kind of

375
00:12:34,639 --> 00:12:36,160
splitting them down

376
00:12:36,160 --> 00:12:37,760
by each filter in terms of what they

377
00:12:37,760 --> 00:12:39,839
matched so essentially what we're seeing

378
00:12:39,839 --> 00:12:43,040
here is on top um about 44 of the ips in

379
00:12:43,040 --> 00:12:44,880
our data set were

380
00:12:44,880 --> 00:12:47,440
deem suspicious about a little more than

381
00:12:47,440 --> 00:12:49,519
half of them were deemed residual trust

382
00:12:49,519 --> 00:12:52,240
related and then about six percent um

383
00:12:52,240 --> 00:12:53,760
did not exhibit characteristics that

384
00:12:53,760 --> 00:12:56,399
were suspicious or trust related

385
00:12:56,399 --> 00:12:58,720
and if you notice um

386
00:12:58,720 --> 00:13:01,360
the trust related ips essentially are

387
00:13:01,360 --> 00:13:03,600
mostly just the residual paths that i

388
00:13:03,600 --> 00:13:05,600
just mentioned and that's mainly because

389
00:13:05,600 --> 00:13:07,120
the low interaction honeypots that we

390
00:13:07,120 --> 00:13:09,040
deployed didn't actually have much

391
00:13:09,040 --> 00:13:11,360
information for us to to go into so we

392
00:13:11,360 --> 00:13:13,040
didn't actually find much in terms of

393
00:13:13,040 --> 00:13:14,959
the credentials based services such as

394
00:13:14,959 --> 00:13:17,920
ssh telnet ftp but we were able to get

395
00:13:17,920 --> 00:13:19,760
some more information from

396
00:13:19,760 --> 00:13:21,200
people who are connecting to us over the

397
00:13:21,200 --> 00:13:23,440
web

398
00:13:24,480 --> 00:13:26,639
now in terms of

399
00:13:26,639 --> 00:13:29,760
what we're finding here so essentially

400
00:13:29,760 --> 00:13:31,680
in short most of the domains that we

401
00:13:31,680 --> 00:13:33,440
registered we didn't find evidence that

402
00:13:33,440 --> 00:13:34,720
they could be

403
00:13:34,720 --> 00:13:36,959
abused through residual trust but here

404
00:13:36,959 --> 00:13:38,240
we're concerned mainly about the

405
00:13:38,240 --> 00:13:39,680
outliers and these outliers are coming

406
00:13:39,680 --> 00:13:41,199
to us

407
00:13:41,199 --> 00:13:44,079
and we're receiving uh millions of ips

408
00:13:44,079 --> 00:13:45,760
who are trying to connect to these

409
00:13:45,760 --> 00:13:47,920
domains and if we look at the blue curve

410
00:13:47,920 --> 00:13:50,079
here um we're seeing that essentially

411
00:13:50,079 --> 00:13:51,920
over only seven percent of these domains

412
00:13:51,920 --> 00:13:54,240
received more than one percent of the

413
00:13:54,240 --> 00:13:56,720
traffic that we deem residual trust

414
00:13:56,720 --> 00:13:58,399
and for the orange curve it's the flip

415
00:13:58,399 --> 00:14:01,440
side over 95 percent receives over 95

416
00:14:01,440 --> 00:14:02,480
bot traffic

417
00:14:02,480 --> 00:14:04,240
so the ones that are lying at the

418
00:14:04,240 --> 00:14:05,680
extremes of each curve are the ones that

419
00:14:05,680 --> 00:14:08,719
we're interested in here

420
00:14:08,959 --> 00:14:10,639
and then the last um

421
00:14:10,639 --> 00:14:11,839
major thing that i'd like to highlight

422
00:14:11,839 --> 00:14:13,600
in terms of the residual trust findings

423
00:14:13,600 --> 00:14:15,600
i thought was interesting is intuitively

424
00:14:15,600 --> 00:14:17,279
you would figure that if you have a

425
00:14:17,279 --> 00:14:19,519
client maybe it's your phone maybe

426
00:14:19,519 --> 00:14:20,720
your laptop trying to connect to

427
00:14:20,720 --> 00:14:21,839
something on

428
00:14:21,839 --> 00:14:23,839
an automated or periodic process you'll

429
00:14:23,839 --> 00:14:25,920
notice that if it's an expired domain

430
00:14:25,920 --> 00:14:27,279
things will stop resolving things will

431
00:14:27,279 --> 00:14:28,880
stop working and you'll fix them over

432
00:14:28,880 --> 00:14:31,360
time so on the left hand

433
00:14:31,360 --> 00:14:33,199
on the left-hand side of the plot we see

434
00:14:33,199 --> 00:14:35,199
that most of the traffic there is fairly

435
00:14:35,199 --> 00:14:37,199
stable and these are

436
00:14:37,199 --> 00:14:38,560
you know they're not decreasing or

437
00:14:38,560 --> 00:14:40,079
increasing over time they fluctuate day

438
00:14:40,079 --> 00:14:42,240
by day but overall the pattern over the

439
00:14:42,240 --> 00:14:43,839
four months is kind of the same but if

440
00:14:43,839 --> 00:14:45,600
you look at the right hand side um i

441
00:14:45,600 --> 00:14:48,240
think in terms of the

442
00:14:48,240 --> 00:14:50,560
uh the brown one labeled parastroke the

443
00:14:50,560 --> 00:14:52,560
info you'll see that after about a month

444
00:14:52,560 --> 00:14:55,199
it kind of sharply dies off as well as

445
00:14:55,199 --> 00:14:57,600
the purple series labeled captain turk i

446
00:14:57,600 --> 00:15:00,160
think dot com and it gradually decreases

447
00:15:00,160 --> 00:15:02,639
over time so we see evidence that

448
00:15:02,639 --> 00:15:03,760
some of them

449
00:15:03,760 --> 00:15:05,760
decrease over time but others remain

450
00:15:05,760 --> 00:15:08,160
stable

451
00:15:08,399 --> 00:15:10,160
okay so i'm not going to go into these

452
00:15:10,160 --> 00:15:11,519
in depth but in the paper we also have

453
00:15:11,519 --> 00:15:13,600
some analyses showing

454
00:15:13,600 --> 00:15:15,440
more about the volume and popularity of

455
00:15:15,440 --> 00:15:16,720
these domains and how you can

456
00:15:16,720 --> 00:15:19,120
efficiently find outliers through visual

457
00:15:19,120 --> 00:15:21,600
representations so we find that you know

458
00:15:21,600 --> 00:15:23,199
based on the domain you might get a lot

459
00:15:23,199 --> 00:15:24,720
of traffic you might not get very much

460
00:15:24,720 --> 00:15:26,399
traffic it varies

461
00:15:26,399 --> 00:15:28,560
in nature and i think that's just how

462
00:15:28,560 --> 00:15:30,560
that's just inherent to the nature of

463
00:15:30,560 --> 00:15:32,079
the web

464
00:15:32,079 --> 00:15:33,759
we have very dissimilar types of traffic

465
00:15:33,759 --> 00:15:35,440
that appear as

466
00:15:35,440 --> 00:15:38,000
visual outliers depending on

467
00:15:38,000 --> 00:15:40,079
how you graph them and then poor

468
00:15:40,079 --> 00:15:41,360
popularity which i think is pretty

469
00:15:41,360 --> 00:15:43,040
interesting so i mentioned that we only

470
00:15:43,040 --> 00:15:44,639
deployed about like five or four of

471
00:15:44,639 --> 00:15:46,079
these honeypot services but we're

472
00:15:46,079 --> 00:15:48,480
receiving requests to um other ports as

473
00:15:48,480 --> 00:15:50,399
well and these don't of course these

474
00:15:50,399 --> 00:15:52,320
don't respond to anything so that means

475
00:15:52,320 --> 00:15:54,399
that whoever is connecting to us they

476
00:15:54,399 --> 00:15:56,160
don't actually care about getting a

477
00:15:56,160 --> 00:15:58,240
reply they just keep sending things to

478
00:15:58,240 --> 00:15:59,680
us

479
00:15:59,680 --> 00:16:01,040
and then in terms of profiling and

480
00:16:01,040 --> 00:16:02,079
domains

481
00:16:02,079 --> 00:16:03,519
i mentioned before that we tried to look

482
00:16:03,519 --> 00:16:05,360
at like archives and references of these

483
00:16:05,360 --> 00:16:06,639
domains to figure out what they used to

484
00:16:06,639 --> 00:16:07,519
do

485
00:16:07,519 --> 00:16:10,800
i think we got about 128 of the 201 of

486
00:16:10,800 --> 00:16:13,600
these domains categorized and about and

487
00:16:13,600 --> 00:16:15,920
most of them are related to gambling or

488
00:16:15,920 --> 00:16:18,000
cybercrime

489
00:16:18,000 --> 00:16:19,120
okay so

490
00:16:19,120 --> 00:16:20,240
i'm not going to go into these in too

491
00:16:20,240 --> 00:16:21,920
much depth but they're in the paper i'd

492
00:16:21,920 --> 00:16:23,360
like to highlight that we have a lot of

493
00:16:23,360 --> 00:16:24,800
different categories of these domains in

494
00:16:24,800 --> 00:16:26,399
terms of what they offered we have api

495
00:16:26,399 --> 00:16:28,480
servers we have servers that function as

496
00:16:28,480 --> 00:16:31,279
c2 servers we have dns name servers we

497
00:16:31,279 --> 00:16:33,600
have people that offered steel content

498
00:16:33,600 --> 00:16:35,279
to other websites and they didn't notice

499
00:16:35,279 --> 00:16:36,880
for up to six months

500
00:16:36,880 --> 00:16:40,000
and we have you know mirror domains

501
00:16:40,000 --> 00:16:42,160
and i think the uh the domain with the

502
00:16:42,160 --> 00:16:43,440
most traffic that we were able to

503
00:16:43,440 --> 00:16:46,800
register is this ib ipv6 tracker.org we

504
00:16:46,800 --> 00:16:47,920
actually

505
00:16:47,920 --> 00:16:49,440
stopped our honeypots on this because it

506
00:16:49,440 --> 00:16:51,360
crashed our systems after receiving too

507
00:16:51,360 --> 00:16:52,639
much traffic

508
00:16:52,639 --> 00:16:54,000
so that that number you see there is

509
00:16:54,000 --> 00:16:55,920
actually only i think about a month ish

510
00:16:55,920 --> 00:16:57,360
of data compared to like the four months

511
00:16:57,360 --> 00:16:59,680
of everything else

512
00:16:59,680 --> 00:17:02,079
okay so in conclusion what do we do

513
00:17:02,079 --> 00:17:03,920
we were able to identify and re-register

514
00:17:03,920 --> 00:17:06,240
201 of these expired domains we didn't

515
00:17:06,240 --> 00:17:07,520
we spent like seven dollars and change

516
00:17:07,520 --> 00:17:10,000
on each and we were able to profile most

517
00:17:10,000 --> 00:17:11,919
of them based on just you know the

518
00:17:11,919 --> 00:17:13,359
internet finding archived versions

519
00:17:13,359 --> 00:17:15,839
finding references and most of these are

520
00:17:15,839 --> 00:17:16,880
um

521
00:17:16,880 --> 00:17:18,400
easily able to do so

522
00:17:18,400 --> 00:17:20,559
um and then i think for that domain that

523
00:17:20,559 --> 00:17:22,959
i just mentioned the ipv6 tracker we saw

524
00:17:22,959 --> 00:17:25,439
that up to 80 of these ips were sending

525
00:17:25,439 --> 00:17:27,439
us the same requests over and over and

526
00:17:27,439 --> 00:17:30,240
they were related to torrent tracking so

527
00:17:30,240 --> 00:17:31,679
this means that you can find domains

528
00:17:31,679 --> 00:17:33,919
with up to 80 of the ips that's still

529
00:17:33,919 --> 00:17:35,840
contacted after they expire and they

530
00:17:35,840 --> 00:17:37,440
still continue to exist

531
00:17:37,440 --> 00:17:39,919
exhibit residual trust traffic and then

532
00:17:39,919 --> 00:17:41,919
um the traffic is not guaranteed to

533
00:17:41,919 --> 00:17:43,760
decay over time so i mentioned we found

534
00:17:43,760 --> 00:17:45,280
a domain where

535
00:17:45,280 --> 00:17:46,640
it was serving javascript to some

536
00:17:46,640 --> 00:17:48,160
cryptocurrency blogs and then one of

537
00:17:48,160 --> 00:17:50,000
these blogs continued to leave that

538
00:17:50,000 --> 00:17:52,160
script on its website for up to six

539
00:17:52,160 --> 00:17:53,039
months

540
00:17:53,039 --> 00:17:54,080
um

541
00:17:54,080 --> 00:17:55,679
yeah so it's kind of worrisome there and

542
00:17:55,679 --> 00:17:58,640
then uh we all these domains come from a

543
00:17:58,640 --> 00:18:00,720
varying um

544
00:18:00,720 --> 00:18:01,760
essentially

545
00:18:01,760 --> 00:18:03,360
a large bucket of like the services that

546
00:18:03,360 --> 00:18:05,280
they used to offer and depending on the

547
00:18:05,280 --> 00:18:06,720
services and the type of information

548
00:18:06,720 --> 00:18:09,600
they expose you can um you know

549
00:18:09,600 --> 00:18:11,679
have different differing degrees of

550
00:18:11,679 --> 00:18:13,200
impact in terms of how you can abuse

551
00:18:13,200 --> 00:18:14,720
this traffic

552
00:18:14,720 --> 00:18:16,640
so in conclusion we were able to find

553
00:18:16,640 --> 00:18:18,960
millions of ips that could be abused

554
00:18:18,960 --> 00:18:20,640
through simple re-registration of these

555
00:18:20,640 --> 00:18:22,480
domains

556
00:18:22,480 --> 00:18:25,039
and as an immediate stop gap

557
00:18:25,039 --> 00:18:26,960
since these domains stop resolving for

558
00:18:26,960 --> 00:18:28,880
at least 30 days before they expire and

559
00:18:28,880 --> 00:18:30,480
they're released to the public

560
00:18:30,480 --> 00:18:31,360
if you

561
00:18:31,360 --> 00:18:32,240
have

562
00:18:32,240 --> 00:18:34,160
improved asset management and monitoring

563
00:18:34,160 --> 00:18:35,200
tools

564
00:18:35,200 --> 00:18:36,880
we reason that you know whoever is

565
00:18:36,880 --> 00:18:38,640
setting these up for their production

566
00:18:38,640 --> 00:18:40,960
services should be able to kind of

567
00:18:40,960 --> 00:18:43,440
detect these before they happen but of

568
00:18:43,440 --> 00:18:45,039
course an ideal defense mechanism you

569
00:18:45,039 --> 00:18:46,720
would need to maybe

570
00:18:46,720 --> 00:18:48,480
somehow define the integrity of the

571
00:18:48,480 --> 00:18:49,600
content that you're trying to get over

572
00:18:49,600 --> 00:18:51,600
the web and then check that to make sure

573
00:18:51,600 --> 00:18:53,120
that it's exactly what you want to be

574
00:18:53,120 --> 00:18:54,880
checking

575
00:18:54,880 --> 00:18:56,480
okay so that concludes my talk um thank

576
00:18:56,480 --> 00:18:58,320
you guys for attending um do you guys

577
00:18:58,320 --> 00:19:00,960
have any questions

578
00:19:05,520 --> 00:19:07,440
thanks uh we have time for a couple of

579
00:19:07,440 --> 00:19:09,919
questions if anyone oh yeah please hi

580
00:19:09,919 --> 00:19:11,679
richard roberts university of maryland

581
00:19:11,679 --> 00:19:15,360
awesome talk did you guys see any

582
00:19:15,360 --> 00:19:17,280
indicators of what

583
00:19:17,280 --> 00:19:19,679
the previous owners of the websites

584
00:19:19,679 --> 00:19:21,200
did after they lost control of their

585
00:19:21,200 --> 00:19:22,640
domain did you find any websites that

586
00:19:22,640 --> 00:19:24,000
moved to a different domain and that's

587
00:19:24,000 --> 00:19:26,000
why they let one expire did they lose

588
00:19:26,000 --> 00:19:27,440
them did you ever try and get in contact

589
00:19:27,440 --> 00:19:29,679
with anyone who lost their domains okay

590
00:19:29,679 --> 00:19:31,280
so in terms of uh contacting the

591
00:19:31,280 --> 00:19:32,720
previous domain orders when i when we

592
00:19:32,720 --> 00:19:34,640
did the analysis afterwards these had

593
00:19:34,640 --> 00:19:36,320
already been expired and then we

594
00:19:36,320 --> 00:19:38,000
actually did analysis i think like maybe

595
00:19:38,000 --> 00:19:39,360
a year later so we didn't actually know

596
00:19:39,360 --> 00:19:40,960
about these um at the time they were

597
00:19:40,960 --> 00:19:43,840
happening um and then in terms of um oh

598
00:19:43,840 --> 00:19:44,640
sorry

599
00:19:44,640 --> 00:19:46,799
maybe let me disconnect

600
00:19:46,799 --> 00:19:49,360
and then in terms of uh

601
00:19:49,360 --> 00:19:51,039
if they moved anywhere else so we found

602
00:19:51,039 --> 00:19:52,640
some of these domains were actually

603
00:19:52,640 --> 00:19:53,840
connected to companies that are still

604
00:19:53,840 --> 00:19:56,000
alive um

605
00:19:56,000 --> 00:19:58,000
i don't recall if we actually figured

606
00:19:58,000 --> 00:19:59,760
out like what they did

607
00:19:59,760 --> 00:20:00,960
after that i think they just moved

608
00:20:00,960 --> 00:20:02,640
domains or maybe they just re-registered

609
00:20:02,640 --> 00:20:03,760
them after

610
00:20:03,760 --> 00:20:06,320
we let them expire but yeah i think one

611
00:20:06,320 --> 00:20:07,679
of the things that could have been

612
00:20:07,679 --> 00:20:09,679
interesting to do if we had analyzed the

613
00:20:09,679 --> 00:20:11,679
traffic that we got sooner rather than

614
00:20:11,679 --> 00:20:13,200
later was trying to figure out like

615
00:20:13,200 --> 00:20:15,039
their internal processes and how they

616
00:20:15,039 --> 00:20:16,640
were able to kind of navigate this

617
00:20:16,640 --> 00:20:18,000
process

618
00:20:18,000 --> 00:20:18,880
thank you

619
00:20:18,880 --> 00:20:20,400
awesome thank you so much

620
00:20:20,400 --> 00:20:24,600
let's thank the speaker again thank you

