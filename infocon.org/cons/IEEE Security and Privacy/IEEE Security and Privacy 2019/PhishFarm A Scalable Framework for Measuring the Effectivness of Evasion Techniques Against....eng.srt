1
00:00:08,790 --> 00:00:13,570
all righty Thanks

2
00:00:11,830 --> 00:00:15,610
introduction and thanks everybody for

3
00:00:13,570 --> 00:00:18,490
coming I know it's the last talk

4
00:00:15,610 --> 00:00:20,910
so I really appreciate that I'm really

5
00:00:18,490 --> 00:00:22,900
excited to present my work fish farm

6
00:00:20,910 --> 00:00:24,400
which we'll be measuring the

7
00:00:22,900 --> 00:00:26,799
effectiveness of evasion techniques

8
00:00:24,400 --> 00:00:29,020
against modern anti-phishing blacklists

9
00:00:26,800 --> 00:00:30,759
and this is joint work with my

10
00:00:29,020 --> 00:00:34,120
colleagues at Arizona State University

11
00:00:30,759 --> 00:00:35,890
as well as PayPal so we all know that

12
00:00:34,120 --> 00:00:38,830
phishing attacks rely on social

13
00:00:35,890 --> 00:00:40,150
engineering to get users to submit

14
00:00:38,830 --> 00:00:42,309
credentials or their sensitive

15
00:00:40,150 --> 00:00:44,350
information onto malicious websites

16
00:00:42,309 --> 00:00:47,290
after following malicious messages and

17
00:00:44,350 --> 00:00:50,530
on the surface these attacks seem a

18
00:00:47,290 --> 00:00:52,330
little bit trivial but they work and

19
00:00:50,530 --> 00:00:54,970
they caused widespread damage because we

20
00:00:52,330 --> 00:00:57,040
have a extensive ecosystem which

21
00:00:54,970 --> 00:01:00,369
supports these attacks and makes them

22
00:00:57,040 --> 00:01:02,199
scalable and for that reason these

23
00:01:00,369 --> 00:01:05,080
phishing attacks are challenged to

24
00:01:02,199 --> 00:01:07,990
mitigate at scale here's one example of

25
00:01:05,080 --> 00:01:10,780
a recent phishing attack which actually

26
00:01:07,990 --> 00:01:13,500
compromised the email inbox of John

27
00:01:10,780 --> 00:01:17,380
Podesta one of the Democratic Party

28
00:01:13,500 --> 00:01:20,650
leaders and this email bypassed both

29
00:01:17,380 --> 00:01:23,740
technical and human review so at

30
00:01:20,650 --> 00:01:25,510
bypassed the spam filters and the

31
00:01:23,740 --> 00:01:26,800
blacklist and also bypassed people who

32
00:01:25,510 --> 00:01:28,510
looked at this email said you know this

33
00:01:26,800 --> 00:01:31,060
looks legit you should probably follow

34
00:01:28,510 --> 00:01:32,920
the link now fishing has been around for

35
00:01:31,060 --> 00:01:35,230
a while this isn't the first you know

36
00:01:32,920 --> 00:01:37,570
kind of issue that we've run into so we

37
00:01:35,230 --> 00:01:40,300
have a key defense which is browser

38
00:01:37,570 --> 00:01:43,419
blacklists and these are deployed across

39
00:01:40,300 --> 00:01:45,850
major web browsers both on desktop and

40
00:01:43,420 --> 00:01:47,560
mobile and the idea is that when you

41
00:01:45,850 --> 00:01:49,600
visit a malicious website you'll see a

42
00:01:47,560 --> 00:01:51,100
prominent warning such as this one which

43
00:01:49,600 --> 00:01:53,500
will effectively prevent you from

44
00:01:51,100 --> 00:01:55,869
accessing the content unless you try

45
00:01:53,500 --> 00:01:58,270
really hard so the objectives of

46
00:01:55,870 --> 00:02:01,240
blacklist are twofold first of all we

47
00:01:58,270 --> 00:02:03,759
want timely and comprehensive detection

48
00:02:01,240 --> 00:02:05,710
and blocking of malicious websites and

49
00:02:03,760 --> 00:02:08,679
we also want a low false positive rate

50
00:02:05,710 --> 00:02:10,030
so that websites don't websites that

51
00:02:08,679 --> 00:02:12,819
have legitimate business don't get

52
00:02:10,030 --> 00:02:14,980
disrupted of course it is in the

53
00:02:12,819 --> 00:02:17,409
interest of attackers to circumvent

54
00:02:14,980 --> 00:02:20,340
these black lists and the way they do

55
00:02:17,409 --> 00:02:22,359
this is by various evasion techniques

56
00:02:20,340 --> 00:02:24,100
before I get into those evasion

57
00:02:22,360 --> 00:02:26,709
techniques here's a quick glance at the

58
00:02:24,100 --> 00:02:28,840
anti-phishing blacklist as they as they

59
00:02:26,709 --> 00:02:29,530
were when we did this research so Google

60
00:02:28,840 --> 00:02:32,500
Safe Browsing

61
00:02:29,530 --> 00:02:34,960
protects Chrome Firefox and Safari and

62
00:02:32,500 --> 00:02:38,250
they have a significant majority of the

63
00:02:34,960 --> 00:02:41,340
market share both on desktop and mobile

64
00:02:38,250 --> 00:02:44,110
Microsoft screen will protect Windows

65
00:02:41,340 --> 00:02:46,000
Internet Explorer on edge and then the

66
00:02:44,110 --> 00:02:48,130
Opera blacklist protects the Opera

67
00:02:46,000 --> 00:02:49,620
browser there are still some browsers

68
00:02:48,130 --> 00:02:52,750
that don't have any of this protection

69
00:02:49,620 --> 00:02:56,530
such as Android browser but that gap is

70
00:02:52,750 --> 00:02:59,260
narrowing so why do we want these

71
00:02:56,530 --> 00:03:02,320
evasion techniques for attackers so

72
00:02:59,260 --> 00:03:04,780
black lists work as follows first a

73
00:03:02,320 --> 00:03:06,910
malicious URL will be reported to the

74
00:03:04,780 --> 00:03:09,550
anti-phishing entity that controls the

75
00:03:06,910 --> 00:03:12,190
blacklist that URL will then be checked

76
00:03:09,550 --> 00:03:14,920
by the entity classified as a phishing

77
00:03:12,190 --> 00:03:17,050
URL and add it to the blacklist so for

78
00:03:14,920 --> 00:03:20,380
example as you can see here the web site

79
00:03:17,050 --> 00:03:24,340
secure - login - paypal.com should show

80
00:03:20,380 --> 00:03:27,310
up with a red warning but if we employ

81
00:03:24,340 --> 00:03:29,080
evasion techniques such as cloaking the

82
00:03:27,310 --> 00:03:32,320
victim will visit the site and they will

83
00:03:29,080 --> 00:03:34,810
see the content which is the bogus login

84
00:03:32,320 --> 00:03:36,549
page but when the security crawler

85
00:03:34,810 --> 00:03:38,170
visits the page they might get you

86
00:03:36,549 --> 00:03:39,459
through benign content or an error

87
00:03:38,170 --> 00:03:42,640
message saying that there's nothing

88
00:03:39,459 --> 00:03:45,549
there and when this happens it's

89
00:03:42,640 --> 00:03:47,738
possible that the URL will never be

90
00:03:45,549 --> 00:03:49,600
added to the blacklist and as a result

91
00:03:47,739 --> 00:03:51,250
the attack will stay on for a longer

92
00:03:49,600 --> 00:03:53,140
amount of time before it's mitigated and

93
00:03:51,250 --> 00:03:56,769
attackers get a better return on

94
00:03:53,140 --> 00:03:59,260
investment so our key research question

95
00:03:56,769 --> 00:04:00,910
is how effective are these cloaking

96
00:03:59,260 --> 00:04:02,320
techniques really against our black

97
00:04:00,910 --> 00:04:05,260
lists a prior work has not actually

98
00:04:02,320 --> 00:04:07,120
looked at this so when we employ

99
00:04:05,260 --> 00:04:09,700
cloaking does the black listing occur

100
00:04:07,120 --> 00:04:12,040
are all the browser's all the users know

101
00:04:09,700 --> 00:04:14,768
the device is consistently protected and

102
00:04:12,040 --> 00:04:19,089
is the black listing quick enough to

103
00:04:14,769 --> 00:04:21,880
prevent real-world harm in order to

104
00:04:19,089 --> 00:04:23,650
figure this out we started by deploying

105
00:04:21,880 --> 00:04:25,120
some preliminary experiments to really

106
00:04:23,650 --> 00:04:28,960
understand how these anti-phishing

107
00:04:25,120 --> 00:04:30,700
entities behave we wanted to deploy a

108
00:04:28,960 --> 00:04:32,560
controlled configuration that's

109
00:04:30,700 --> 00:04:35,860
representative of the real anti-phishing

110
00:04:32,560 --> 00:04:37,630
ecosystem and real phishing websites and

111
00:04:35,860 --> 00:04:38,979
we wanted to use this information

112
00:04:37,630 --> 00:04:40,719
obtained through their preliminary

113
00:04:38,979 --> 00:04:43,248
experiments to guide the full-scale

114
00:04:40,720 --> 00:04:47,359
experiments that follow to give us this

115
00:04:43,249 --> 00:04:48,799
a significant sample another advantage

116
00:04:47,359 --> 00:04:51,558
of this approach is that whatever

117
00:04:48,799 --> 00:04:52,909
security recommendations we find early

118
00:04:51,559 --> 00:04:55,729
on could be shared with the

119
00:04:52,909 --> 00:04:57,889
anti-phishing entities and our goal was

120
00:04:55,729 --> 00:05:00,079
to evaluate cloaking techniques that

121
00:04:57,889 --> 00:05:02,029
target real-world parts of the

122
00:05:00,079 --> 00:05:03,619
population so we wanted to pick

123
00:05:02,029 --> 00:05:06,679
techniques that a representative of real

124
00:05:03,619 --> 00:05:08,929
users out there so in addition to having

125
00:05:06,679 --> 00:05:11,268
some websites that have no cloaking as

126
00:05:08,929 --> 00:05:12,799
our control group we started by having a

127
00:05:11,269 --> 00:05:15,289
technique that targets specifically

128
00:05:12,799 --> 00:05:16,938
mobile users so Android and iOS we

129
00:05:15,289 --> 00:05:19,279
believe that this is a very large subset

130
00:05:16,939 --> 00:05:22,699
of users today we also looked at

131
00:05:19,279 --> 00:05:24,499
geolocation so us and non-us desktop

132
00:05:22,699 --> 00:05:24,829
users kind of killing two birds with one

133
00:05:24,499 --> 00:05:27,889
stone

134
00:05:24,829 --> 00:05:30,259
with these cooking techniques we also

135
00:05:27,889 --> 00:05:32,259
took a real-world collection of IP

136
00:05:30,259 --> 00:05:35,539
addresses user agents and host names

137
00:05:32,259 --> 00:05:37,759
from a large data set of real phishing

138
00:05:35,539 --> 00:05:40,699
sites so kind of to understand do

139
00:05:37,759 --> 00:05:42,319
off-the-shelf phishing kits really work

140
00:05:40,699 --> 00:05:44,029
and is there any purpose to these

141
00:05:42,319 --> 00:05:45,189
filtering techniques that they employ on

142
00:05:44,029 --> 00:05:48,199
the backend

143
00:05:45,189 --> 00:05:50,839
finally javascript is what we believe to

144
00:05:48,199 --> 00:05:52,759
be an emerging cloaking technique so

145
00:05:50,839 --> 00:05:55,129
included a batch of websites that has

146
00:05:52,759 --> 00:05:58,759
phishing content that only renders if

147
00:05:55,129 --> 00:06:00,409
javascript is running in the browser so

148
00:05:58,759 --> 00:06:02,599
for our preliminary experiments we take

149
00:06:00,409 --> 00:06:05,329
these six cooking techniques and we

150
00:06:02,599 --> 00:06:08,029
create batches of websites with six or

151
00:06:05,329 --> 00:06:10,909
seven of each we then take each batch

152
00:06:08,029 --> 00:06:12,949
and report it to ten top anti-phishing

153
00:06:10,909 --> 00:06:16,459
entities for a total of four hundred

154
00:06:12,949 --> 00:06:19,909
sites we then used both random and

155
00:06:16,459 --> 00:06:22,189
deceptive URLs to understand if the URL

156
00:06:19,909 --> 00:06:25,839
plays an important factor alongside the

157
00:06:22,189 --> 00:06:28,339
entity and the cloaking technique and

158
00:06:25,839 --> 00:06:30,589
the way we did this was as follows

159
00:06:28,339 --> 00:06:33,019
we started by configuring and deploying

160
00:06:30,589 --> 00:06:35,509
the websites in cloud infrastructure

161
00:06:33,019 --> 00:06:38,389
using fish farm this is according to our

162
00:06:35,509 --> 00:06:40,759
experimental design we then reported

163
00:06:38,389 --> 00:06:42,799
each batch to the anti-phishing entities

164
00:06:40,759 --> 00:06:44,599
directly so for example there'd be one

165
00:06:42,799 --> 00:06:46,369
batch of sites only going to Google

166
00:06:44,599 --> 00:06:49,219
there'd be one batch of sites only go

167
00:06:46,369 --> 00:06:51,110
into Microsoft and so on we then have a

168
00:06:49,219 --> 00:06:53,929
monitoring system which is continuously

169
00:06:51,110 --> 00:06:55,639
looking through the various web browsers

170
00:06:53,929 --> 00:06:56,260
that we're targeting both on desktop and

171
00:06:55,639 --> 00:06:57,910
mobile

172
00:06:56,260 --> 00:07:00,370
to see whether or not the black listings

173
00:06:57,910 --> 00:07:02,890
actually occurring and all of this can

174
00:07:00,370 --> 00:07:06,070
be done with a minimal setup and

175
00:07:02,890 --> 00:07:07,659
essentially end-to-end automation I'm

176
00:07:06,070 --> 00:07:09,640
not going to go in depth on the

177
00:07:07,660 --> 00:07:10,750
technical implementation but if you're

178
00:07:09,640 --> 00:07:13,870
interested please take a look at the

179
00:07:10,750 --> 00:07:15,820
paper where we document that here's an

180
00:07:13,870 --> 00:07:17,650
example of one of our phishing websites

181
00:07:15,820 --> 00:07:20,349
because this project was in

182
00:07:17,650 --> 00:07:23,049
collaboration with PayPal we of course

183
00:07:20,350 --> 00:07:25,540
had permission to use their logo and

184
00:07:23,050 --> 00:07:27,670
their look and feel and on an ethical

185
00:07:25,540 --> 00:07:29,530
note we did not actually collect any

186
00:07:27,670 --> 00:07:31,980
credentials nor was there capacity to

187
00:07:29,530 --> 00:07:34,270
collect credentials though from the

188
00:07:31,980 --> 00:07:35,980
perspective of a web crawler it would

189
00:07:34,270 --> 00:07:38,380
appear as if we had that capacity we

190
00:07:35,980 --> 00:07:39,910
also never distributed these websites to

191
00:07:38,380 --> 00:07:43,150
any real users we only sent them

192
00:07:39,910 --> 00:07:45,850
directly to the anti-abuse entities and

193
00:07:43,150 --> 00:07:48,070
when monitoring in the ideal case we

194
00:07:45,850 --> 00:07:50,500
wanted to see this kind of warning very

195
00:07:48,070 --> 00:07:54,370
early on so this was kind of the thing

196
00:07:50,500 --> 00:07:55,930
that we wanted to see after we ran the

197
00:07:54,370 --> 00:07:57,340
preliminary experiments we had a number

198
00:07:55,930 --> 00:07:59,560
of security recommendations that I'll

199
00:07:57,340 --> 00:08:02,169
get into later we started by having

200
00:07:59,560 --> 00:08:04,810
disclosure meetings with the top browser

201
00:08:02,170 --> 00:08:06,430
vendors and anti-phishing entities we

202
00:08:04,810 --> 00:08:08,980
also put together a written report to

203
00:08:06,430 --> 00:08:10,870
other organizations which were involved

204
00:08:08,980 --> 00:08:14,110
in the study but either we couldn't

205
00:08:10,870 --> 00:08:17,200
reach or that we're not directly part of

206
00:08:14,110 --> 00:08:19,120
the disclosure so we then moved on to

207
00:08:17,200 --> 00:08:20,860
the full experiments and the probe the

208
00:08:19,120 --> 00:08:22,870
preliminary experiments gave us good

209
00:08:20,860 --> 00:08:25,050
data and a good indication that these

210
00:08:22,870 --> 00:08:27,850
six cloaking techniques were in fact

211
00:08:25,050 --> 00:08:30,490
good choices so we wanted to scale up

212
00:08:27,850 --> 00:08:32,860
everything we went from six from the

213
00:08:30,490 --> 00:08:35,289
preliminary experiments up to 66 of each

214
00:08:32,860 --> 00:08:38,740
of these four total batch size of about

215
00:08:35,289 --> 00:08:41,559
400 sites per entity and again as before

216
00:08:38,740 --> 00:08:44,890
we reported each batch to each entity

217
00:08:41,559 --> 00:08:46,750
for a total of almost 2,000 sites lastly

218
00:08:44,890 --> 00:08:49,360
for the full experiments we took out the

219
00:08:46,750 --> 00:08:50,830
URL variations and all the URLs were

220
00:08:49,360 --> 00:08:54,640
random just to eliminate that as a

221
00:08:50,830 --> 00:08:56,050
confounding factor here's a quick videos

222
00:08:54,640 --> 00:08:57,189
it's not in the paper I just wanted to

223
00:08:56,050 --> 00:08:58,839
show how this all works

224
00:08:57,190 --> 00:09:00,730
so we have our experimental

225
00:08:58,840 --> 00:09:01,810
configuration and this gets imported

226
00:09:00,730 --> 00:09:04,480
into fish farm

227
00:09:01,810 --> 00:09:06,819
now all those websites those 2000

228
00:09:04,480 --> 00:09:09,160
websites have been deployed in our cloud

229
00:09:06,820 --> 00:09:10,089
infrastructure we go ahead and activate

230
00:09:09,160 --> 00:09:12,309
the website so the

231
00:09:10,089 --> 00:09:14,439
now they can be publicly accessible and

232
00:09:12,309 --> 00:09:16,689
once they're activated we'll get a

233
00:09:14,439 --> 00:09:18,879
confirmation of this and we can go ahead

234
00:09:16,689 --> 00:09:22,059
and proceed to report the websites to

235
00:09:18,879 --> 00:09:24,279
the entity and this is as easy as just

236
00:09:22,059 --> 00:09:26,319
selecting them all our framework will

237
00:09:24,279 --> 00:09:27,939
send out the emails those emails will

238
00:09:26,319 --> 00:09:30,309
contain essentially a phishing message

239
00:09:27,939 --> 00:09:32,980
similar to what a real user might see

240
00:09:30,309 --> 00:09:37,899
and similar to what a spam filter might

241
00:09:32,980 --> 00:09:40,680
be trained on here's an example of a

242
00:09:37,899 --> 00:09:42,879
live example of one of our websites

243
00:09:40,680 --> 00:09:45,699
it'll look very similar to what we saw

244
00:09:42,879 --> 00:09:48,220
in that screenshot earlier and as I

245
00:09:45,699 --> 00:09:51,399
mentioned we had a total of over 2000 of

246
00:09:48,220 --> 00:09:52,749
these finally well these sites after

247
00:09:51,399 --> 00:09:54,189
these sites have been reported we're

248
00:09:52,749 --> 00:09:56,769
running this monitoring system in the

249
00:09:54,189 --> 00:09:59,009
backend that's looking through all the

250
00:09:56,769 --> 00:10:01,740
browsers and checking for these

251
00:09:59,009 --> 00:10:04,959
blacklist warning messages

252
00:10:01,740 --> 00:10:07,300
we ran the server about 72 hours and

253
00:10:04,959 --> 00:10:08,829
after this we had a treasure trove of

254
00:10:07,300 --> 00:10:12,939
data which we could then analyze to

255
00:10:08,829 --> 00:10:15,309
understand the ecosystem at the end of

256
00:10:12,939 --> 00:10:17,079
the deployment we had over 20,000

257
00:10:15,309 --> 00:10:19,449
blacklist timestamps from all these

258
00:10:17,079 --> 00:10:21,758
sites and we also got over 2 million web

259
00:10:19,449 --> 00:10:23,589
hits from the crawling infrastructure so

260
00:10:21,759 --> 00:10:26,470
there's a very large relative activity

261
00:10:23,589 --> 00:10:28,929
from the security crawlers in our

262
00:10:26,470 --> 00:10:31,059
experiment we saw that cloaking reduced

263
00:10:28,929 --> 00:10:32,949
the likelihood of blacklisting by about

264
00:10:31,059 --> 00:10:35,800
half and a double the time of

265
00:10:32,949 --> 00:10:37,990
blacklisting in addition sites that had

266
00:10:35,800 --> 00:10:40,628
cloaking techniques were less likely to

267
00:10:37,990 --> 00:10:43,600
actually be visited now I'll throw in

268
00:10:40,629 --> 00:10:45,639
one caveat here this is assuming that a

269
00:10:43,600 --> 00:10:48,189
reporting methodology is representative

270
00:10:45,639 --> 00:10:50,110
of the ecosystem so these results do not

271
00:10:48,189 --> 00:10:52,360
generalize necessarily to the entire

272
00:10:50,110 --> 00:10:54,939
population but they're representative

273
00:10:52,360 --> 00:10:57,279
our experimental design which can always

274
00:10:54,939 --> 00:11:00,160
be modified as needed you know using

275
00:10:57,279 --> 00:11:02,439
this framework so now I'd like to talk

276
00:11:00,160 --> 00:11:05,410
about the specific effectiveness of each

277
00:11:02,439 --> 00:11:07,329
individual cloaking technique this chart

278
00:11:05,410 --> 00:11:09,550
combines the results across all of the

279
00:11:07,329 --> 00:11:11,229
browsers and on the y-axis we're looking

280
00:11:09,550 --> 00:11:13,149
at the total percentage of websites that

281
00:11:11,230 --> 00:11:14,559
are being blacklisted now this

282
00:11:13,149 --> 00:11:16,990
percentage might seem a little bit low

283
00:11:14,559 --> 00:11:18,730
and this is because some anti-phishing

284
00:11:16,990 --> 00:11:20,199
entities such as Google aren't

285
00:11:18,730 --> 00:11:22,540
protecting browsers such as Internet

286
00:11:20,199 --> 00:11:22,910
Explorer and edge even though we were

287
00:11:22,540 --> 00:11:25,699
mom

288
00:11:22,910 --> 00:11:27,680
during those browsers on the y-axis we

289
00:11:25,700 --> 00:11:29,720
have the number of hours that have

290
00:11:27,680 --> 00:11:31,339
elapsed since we sent those reports and

291
00:11:29,720 --> 00:11:34,700
since the phishing sites went live and

292
00:11:31,340 --> 00:11:36,740
on the far right are the last three days

293
00:11:34,700 --> 00:11:38,900
of the experiment just for space so you

294
00:11:36,740 --> 00:11:42,530
can see what's going on we observed that

295
00:11:38,900 --> 00:11:45,140
the real change in blacklisting happens

296
00:11:42,530 --> 00:11:47,600
after about two hours or so so before

297
00:11:45,140 --> 00:11:50,270
then a very small percentage of sites is

298
00:11:47,600 --> 00:11:52,940
blacklisted but after about two hours we

299
00:11:50,270 --> 00:11:54,890
see some significant growth and websites

300
00:11:52,940 --> 00:11:57,830
without any cloaking techniques were the

301
00:11:54,890 --> 00:11:59,680
most likely to be blacklisted there we

302
00:11:57,830 --> 00:12:03,170
see a similar story after eight hours

303
00:11:59,680 --> 00:12:05,390
where websites that had for example the

304
00:12:03,170 --> 00:12:07,550
US only geo filter where the least

305
00:12:05,390 --> 00:12:10,069
likely be blacklisted with all the other

306
00:12:07,550 --> 00:12:12,910
filters falling somewhere in between on

307
00:12:10,070 --> 00:12:16,760
that range you'll notice at the end

308
00:12:12,910 --> 00:12:19,069
there's some of the this is the htaccess

309
00:12:16,760 --> 00:12:22,520
data set those are actually more likely

310
00:12:19,070 --> 00:12:25,100
to be blacklisted than the sites without

311
00:12:22,520 --> 00:12:26,900
cloaking and this is because I believe

312
00:12:25,100 --> 00:12:29,410
that there's some fingerprinting going

313
00:12:26,900 --> 00:12:31,760
on of these real-world phishing sites

314
00:12:29,410 --> 00:12:33,920
now one last thing that might not have

315
00:12:31,760 --> 00:12:35,930
been immediately obvious is the bottom

316
00:12:33,920 --> 00:12:38,240
of the chart you'll notice that the iOS

317
00:12:35,930 --> 00:12:40,699
and Android cloaking techniques are

318
00:12:38,240 --> 00:12:42,590
absolutely no black listing so this

319
00:12:40,700 --> 00:12:45,290
means that sites that were targeted at

320
00:12:42,590 --> 00:12:48,820
mobile users were never mitigated using

321
00:12:45,290 --> 00:12:52,370
this you know these black lists and

322
00:12:48,820 --> 00:12:54,860
moreover the sites that were blacklisted

323
00:12:52,370 --> 00:12:56,750
on desktop platforms would also not show

324
00:12:54,860 --> 00:12:57,890
any warnings on mobile so this is a huge

325
00:12:56,750 --> 00:13:00,260
finding that we made

326
00:12:57,890 --> 00:13:02,270
you know after deploying this one of our

327
00:13:00,260 --> 00:13:03,560
biggest anti-phishing defenses is

328
00:13:02,270 --> 00:13:08,569
actually not working in mobile devices

329
00:13:03,560 --> 00:13:10,520
at all we saw that us only cloaking

330
00:13:08,570 --> 00:13:12,650
websites we're not blacklisted by Google

331
00:13:10,520 --> 00:13:13,850
Safe Browsing and we believe this is

332
00:13:12,650 --> 00:13:15,430
because of the interest the way the

333
00:13:13,850 --> 00:13:17,660
infrastructure worked on the back end

334
00:13:15,430 --> 00:13:21,079
similarly for other anti-phishing

335
00:13:17,660 --> 00:13:25,760
entities the non-us sites were not being

336
00:13:21,080 --> 00:13:27,440
blacklisted the real world cloaking from

337
00:13:25,760 --> 00:13:30,290
those phishing kits were effective in

338
00:13:27,440 --> 00:13:32,750
the first 12 hours and the JavaScript

339
00:13:30,290 --> 00:13:36,290
cloaking slowed blacklisting in the long

340
00:13:32,750 --> 00:13:36,680
term quite effectively so looking at the

341
00:13:36,290 --> 00:13:38,540
browser

342
00:13:36,680 --> 00:13:40,939
individually the three browsers

343
00:13:38,540 --> 00:13:43,130
protected by Google Safe Browsing they

344
00:13:40,940 --> 00:13:45,140
dominate the market and luckily Google

345
00:13:43,130 --> 00:13:46,640
Safe Browsing was the fastest blacklist

346
00:13:45,140 --> 00:13:49,370
this is a very good finding

347
00:13:46,640 --> 00:13:51,920
but those gaps as I mentioned with

348
00:13:49,370 --> 00:13:53,750
mobile they have the largest impact at

349
00:13:51,920 --> 00:13:55,760
that point so the fact that there was no

350
00:13:53,750 --> 00:13:57,680
black listing in Android and iOS meant

351
00:13:55,760 --> 00:14:00,980
that a significant number of users were

352
00:13:57,680 --> 00:14:02,270
not being protected Microsoft a smart

353
00:14:00,980 --> 00:14:04,910
scream is actually the only blacklist

354
00:14:02,270 --> 00:14:07,399
that used a proactive heuristics on the

355
00:14:04,910 --> 00:14:09,410
page content and the URL to blacklist

356
00:14:07,399 --> 00:14:12,800
websites without actually verifying the

357
00:14:09,410 --> 00:14:14,930
content so this is a good thing but

358
00:14:12,800 --> 00:14:17,479
unfortunately fissures are shifting away

359
00:14:14,930 --> 00:14:19,040
from using deceptive URLs and using

360
00:14:17,480 --> 00:14:21,950
other techniques that bypass these

361
00:14:19,040 --> 00:14:24,920
heuristics in our experiment we saw very

362
00:14:21,950 --> 00:14:27,589
limited coverage from opera and we saw

363
00:14:24,920 --> 00:14:29,329
very limited data sharing between google

364
00:14:27,589 --> 00:14:31,910
and microsoft's black lists although

365
00:14:29,330 --> 00:14:34,670
clearing houses such as the aPWG did

366
00:14:31,910 --> 00:14:36,050
share data so key outcome of this

367
00:14:34,670 --> 00:14:38,810
research is that following our

368
00:14:36,050 --> 00:14:40,430
disclosure to google we're actually able

369
00:14:38,810 --> 00:14:43,189
to address this mobile black listing

370
00:14:40,430 --> 00:14:45,859
issue before September 2018 if you

371
00:14:43,190 --> 00:14:48,770
visited a known malicious site a known

372
00:14:45,860 --> 00:14:50,330
phishing site you would see something

373
00:14:48,770 --> 00:14:52,400
like this you'd see the real login page

374
00:14:50,330 --> 00:14:54,980
but now you should be seeing the warning

375
00:14:52,400 --> 00:14:56,630
correctly and in addition other cloaking

376
00:14:54,980 --> 00:15:00,260
techniques that we've looked at are now

377
00:14:56,630 --> 00:15:01,850
more easily detectable so looking at the

378
00:15:00,260 --> 00:15:03,189
broader ecosystem what are some of the

379
00:15:01,850 --> 00:15:05,900
vulnerabilities that are still out there

380
00:15:03,190 --> 00:15:08,600
so we believe that cloaking still

381
00:15:05,900 --> 00:15:10,699
prolongs the window of opportunity that

382
00:15:08,600 --> 00:15:12,470
fissures have and in particular the

383
00:15:10,700 --> 00:15:14,480
geo-specific cloaking and not even

384
00:15:12,470 --> 00:15:17,000
limited to the US but if it's limited to

385
00:15:14,480 --> 00:15:19,220
specific countries is a legitimate

386
00:15:17,000 --> 00:15:21,589
concern for the anti-phishing ecosystem

387
00:15:19,220 --> 00:15:24,440
today our mitigations are not fast

388
00:15:21,589 --> 00:15:27,140
enough to prevent abuse and both

389
00:15:24,440 --> 00:15:30,170
blacklist and hosting infrastructure are

390
00:15:27,140 --> 00:15:31,670
our areas that could be improved finally

391
00:15:30,170 --> 00:15:33,860
there's a need for continuous testing

392
00:15:31,670 --> 00:15:35,750
the verification of our defenses which

393
00:15:33,860 --> 00:15:37,850
is something that fish farms of supports

394
00:15:35,750 --> 00:15:39,920
and it's a way for detecting that

395
00:15:37,850 --> 00:15:43,339
baseline mitigation such as the desktop

396
00:15:39,920 --> 00:15:45,469
and mobile are both working as intended

397
00:15:43,339 --> 00:15:48,140
we can also proactively test any

398
00:15:45,470 --> 00:15:50,500
emerging techniques for evasion that may

399
00:15:48,140 --> 00:15:50,500
come out

400
00:15:50,800 --> 00:15:54,939
I expect novel cloaking techniques

401
00:15:53,140 --> 00:15:56,230
especially those based on JavaScript to

402
00:15:54,940 --> 00:15:58,960
be developed over time and this is

403
00:15:56,230 --> 00:16:00,820
something that we should expect finally

404
00:15:58,960 --> 00:16:02,650
data sharing between entities I think is

405
00:16:00,820 --> 00:16:04,990
an important thing an important change

406
00:16:02,650 --> 00:16:06,640
that we can do to improve the

407
00:16:04,990 --> 00:16:10,060
effectiveness of next-generation

408
00:16:06,640 --> 00:16:12,699
anti-phishing systems trusted reporting

409
00:16:10,060 --> 00:16:14,199
channels between victims of phishing and

410
00:16:12,700 --> 00:16:17,070
the organizations that are being phished

411
00:16:14,200 --> 00:16:19,630
and the blacklist providers themselves

412
00:16:17,070 --> 00:16:21,160
would offer intelligence that might not

413
00:16:19,630 --> 00:16:24,520
immediately be available to blacklist

414
00:16:21,160 --> 00:16:26,439
providers and finally in the long term

415
00:16:24,520 --> 00:16:29,380
proactive detection techniques that

416
00:16:26,440 --> 00:16:31,570
involve these trusted reporting channels

417
00:16:29,380 --> 00:16:33,939
and other intelligence beyond just

418
00:16:31,570 --> 00:16:37,330
content is something that we should look

419
00:16:33,940 --> 00:16:38,860
to of course a multi-layer strategy is

420
00:16:37,330 --> 00:16:40,780
the most effective so this should all be

421
00:16:38,860 --> 00:16:43,480
done alongside other mitigation such as

422
00:16:40,780 --> 00:16:46,720
two-factor authentication user training

423
00:16:43,480 --> 00:16:47,890
and so forth so with that that's

424
00:16:46,720 --> 00:16:55,690
everything I have and I'll be happy to

425
00:16:47,890 --> 00:16:56,530
take any questions thank you thanks so

426
00:16:55,690 --> 00:17:04,630
much we have plenty of time for

427
00:16:56,530 --> 00:17:06,310
questions so I definitely have a couple

428
00:17:04,630 --> 00:17:07,350
questions so one of the big ones I think

429
00:17:06,310 --> 00:17:11,440
you did mention a little bit about

430
00:17:07,349 --> 00:17:14,319
ecological validity I think that so just

431
00:17:11,440 --> 00:17:18,370
to confirm you sent the URL for your

432
00:17:14,319 --> 00:17:21,490
page once to the reporting and there was

433
00:17:18,369 --> 00:17:23,050
no other ingestion of that URL into

434
00:17:21,490 --> 00:17:24,760
their system that's correct

435
00:17:23,050 --> 00:17:27,099
in these experiments we did it once yes

436
00:17:24,760 --> 00:17:28,690
okay that's something we decided to do

437
00:17:27,099 --> 00:17:30,909
just because we did not know what would

438
00:17:28,690 --> 00:17:33,070
happen so we had to make these controls

439
00:17:30,910 --> 00:17:34,900
in these experiments but I think that

440
00:17:33,070 --> 00:17:37,419
going forward it might be more

441
00:17:34,900 --> 00:17:40,630
representative to either continuously

442
00:17:37,420 --> 00:17:42,430
send these sorts of reports or vary the

443
00:17:40,630 --> 00:17:45,060
distribution channels and include

444
00:17:42,430 --> 00:17:47,770
multiple entities in a single deployment

445
00:17:45,060 --> 00:17:51,610
hello my name is Christine O'Donnell

446
00:17:47,770 --> 00:17:54,700
from Microsoft and phishing is one of

447
00:17:51,610 --> 00:17:57,610
the things that I do there detection for

448
00:17:54,700 --> 00:18:01,480
the threat protection part of office

449
00:17:57,610 --> 00:18:04,408
exchange I can tell you that submission

450
00:18:01,480 --> 00:18:06,780
channels are different depending on the

451
00:18:04,409 --> 00:18:09,870
part that you submitted to so if you

452
00:18:06,780 --> 00:18:12,960
would submit something which is goes to

453
00:18:09,870 --> 00:18:15,209
a hotmail account there's a an exchange

454
00:18:12,960 --> 00:18:18,600
advanced threat protection account the

455
00:18:15,210 --> 00:18:20,850
results are different because analyzing

456
00:18:18,600 --> 00:18:23,610
the content of the page is quite

457
00:18:20,850 --> 00:18:25,889
expensive at scale so it's something to

458
00:18:23,610 --> 00:18:31,530
keep in mind as you're doing the

459
00:18:25,890 --> 00:18:33,240
analysis right yeah we we're very aware

460
00:18:31,530 --> 00:18:36,899
of this and also the fact that there are

461
00:18:33,240 --> 00:18:39,090
many non-public submission channels if

462
00:18:36,900 --> 00:18:40,590
you want to take this offline I mean

463
00:18:39,090 --> 00:18:43,220
some other ways we could talk about

464
00:18:40,590 --> 00:18:43,220
thank you

465
00:18:43,250 --> 00:18:48,570
yeah I think along those lines when you

466
00:18:45,600 --> 00:18:50,158
did contact these anti-phishing

467
00:18:48,570 --> 00:18:52,740
providers did any of them give you some

468
00:18:50,159 --> 00:18:53,940
sort of insight into oh this submission

469
00:18:52,740 --> 00:18:55,740
channels gonna be completely different

470
00:18:53,940 --> 00:18:57,419
than what we're getting through our

471
00:18:55,740 --> 00:18:59,909
hotmail or why we're getting through our

472
00:18:57,419 --> 00:19:01,440
Gmail so and we reached out to the

473
00:18:59,909 --> 00:19:04,830
entities in the preliminary disclosure

474
00:19:01,440 --> 00:19:06,780
they seemed fine with our approach they

475
00:19:04,830 --> 00:19:17,220
didn't really make any comments that

476
00:19:06,780 --> 00:19:22,080
effect Lou Costello Samsung research

477
00:19:17,220 --> 00:19:23,850
America the ease at which you seem to be

478
00:19:22,080 --> 00:19:26,399
able to generate these phishing sites it

479
00:19:23,850 --> 00:19:28,408
is scary to me

480
00:19:26,400 --> 00:19:31,110
even if they get shut down very quickly

481
00:19:28,409 --> 00:19:33,510
like within 24 hours or just a few hours

482
00:19:31,110 --> 00:19:35,010
does it really matter from the attackers

483
00:19:33,510 --> 00:19:37,289
perspective if they can automatically

484
00:19:35,010 --> 00:19:39,299
make more and more at new domains

485
00:19:37,289 --> 00:19:41,070
it doesn't matter actually and this is

486
00:19:39,299 --> 00:19:42,840
why phishing attacks are so scalable

487
00:19:41,070 --> 00:19:46,678
these days you know we see hundreds of

488
00:19:42,840 --> 00:19:49,590
sites being deployed per hour so that's

489
00:19:46,679 --> 00:19:51,240
why our defenses just need to be we

490
00:19:49,590 --> 00:19:54,418
can't have that gap it needs to be

491
00:19:51,240 --> 00:19:56,100
proactive yeah and this is also the

492
00:19:54,419 --> 00:19:57,090
reason why we're not open sourcing even

493
00:19:56,100 --> 00:19:58,799
though we're open to sharing the

494
00:19:57,090 --> 00:20:01,080
framework with researchers we're not you

495
00:19:58,799 --> 00:20:04,710
know gonna distribute this to malicious

496
00:20:01,080 --> 00:20:07,918
users and one more thing I'd like to add

497
00:20:04,710 --> 00:20:10,080
to that is I don't think I mentioned in

498
00:20:07,919 --> 00:20:14,010
the talk but abuse reports coming into

499
00:20:10,080 --> 00:20:17,149
the hosting providers that we used took

500
00:20:14,010 --> 00:20:18,649
about 17 hours on average

501
00:20:17,149 --> 00:20:21,228
from the time the fishing site was

502
00:20:18,649 --> 00:20:23,869
deployed and in addition it was very

503
00:20:21,229 --> 00:20:25,609
easy to just tell the hosting provider

504
00:20:23,869 --> 00:20:29,959
not to worry about it and they didn't

505
00:20:25,609 --> 00:20:32,059
actually action anything for several

506
00:20:29,960 --> 00:20:33,320
months before actually reaching out to

507
00:20:32,059 --> 00:20:34,940
us and verifying that hey we're

508
00:20:33,320 --> 00:20:40,489
legitimate researchers and not actual

509
00:20:34,940 --> 00:20:43,070
criminals add one more question so did

510
00:20:40,489 --> 00:20:44,419
you see any sort of quantization in when

511
00:20:43,070 --> 00:20:45,678
your sight would get black lows it

512
00:20:44,419 --> 00:20:48,440
seemed like you were sending lots and

513
00:20:45,679 --> 00:20:51,049
lots of examples to Google or Microsoft

514
00:20:48,440 --> 00:20:53,419
or whoever was there like this one's 2

515
00:20:51,049 --> 00:20:56,090
hours and 37 minutes or something that

516
00:20:53,419 --> 00:20:58,309
made it look like there was a very

517
00:20:56,090 --> 00:21:00,470
regular process that was going through

518
00:20:58,309 --> 00:21:03,139
and looking at these things yeah so it

519
00:21:00,470 --> 00:21:05,450
varied and definitely varied by entity

520
00:21:03,139 --> 00:21:07,758
so as I mentioned with Google we saw

521
00:21:05,450 --> 00:21:09,320
some very early activity essentially as

522
00:21:07,759 --> 00:21:11,389
soon as the site was reported they would

523
00:21:09,320 --> 00:21:13,009
hit it with a crawler and then shortly

524
00:21:11,389 --> 00:21:15,439
after that presumably after verification

525
00:21:13,009 --> 00:21:16,580
it would go ahead and be blacklisted but

526
00:21:15,440 --> 00:21:19,519
for some of the other entities there

527
00:21:16,580 --> 00:21:22,519
would be indeed a fixed time window

528
00:21:19,519 --> 00:21:24,019
before anything would happen so there's

529
00:21:22,519 --> 00:21:26,899
definitely some some of that going on

530
00:21:24,019 --> 00:21:28,429
but it's also difficult to measure just

531
00:21:26,899 --> 00:21:28,939
because the infrastructure is very

532
00:21:28,429 --> 00:21:32,450
diverse

533
00:21:28,940 --> 00:21:35,269
right and then you were continually

534
00:21:32,450 --> 00:21:36,769
checking GSB or whatever to determine

535
00:21:35,269 --> 00:21:40,070
whether you were on the black light yes

536
00:21:36,769 --> 00:21:42,679
does that check itself I did used as any

537
00:21:40,070 --> 00:21:44,599
sort of and so it we were very careful

538
00:21:42,679 --> 00:21:46,220
to make sure that wouldn't happen so

539
00:21:44,599 --> 00:21:48,649
when the websites were visited by our

540
00:21:46,220 --> 00:21:51,440
infrastructure we would not display any

541
00:21:48,649 --> 00:21:54,349
content to send a 200 status code

542
00:21:51,440 --> 00:21:56,269
without any content on it you know just

543
00:21:54,349 --> 00:22:01,059
to make sure that we would not

544
00:21:56,269 --> 00:22:01,059
negatively influence this cool thanks

