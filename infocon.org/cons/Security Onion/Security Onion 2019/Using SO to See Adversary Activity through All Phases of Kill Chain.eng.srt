1
00:00:09,559 --> 00:00:14,579
alright so the title of the talk is

2
00:00:12,990 --> 00:00:16,470
called peeling back the layers this is a

3
00:00:14,580 --> 00:00:18,750
talk that Benjamin Klem Kowski and I put

4
00:00:16,470 --> 00:00:20,580
together and we're presenting it

5
00:00:18,750 --> 00:00:22,470
completely in and Jupiter notebook

6
00:00:20,580 --> 00:00:24,089
here's our agenda we're gonna talk to

7
00:00:22,470 --> 00:00:26,398
our goals motivation behind the product

8
00:00:24,090 --> 00:00:28,860
project a little bit of the methodology

9
00:00:26,399 --> 00:00:30,750
it's not a regular kill chain which is

10
00:00:28,860 --> 00:00:32,820
what we think is the actual contribution

11
00:00:30,750 --> 00:00:35,610
of this then some examples of the

12
00:00:32,820 --> 00:00:37,410
techniques that we put together insights

13
00:00:35,610 --> 00:00:39,300
into the data analysis summary and then

14
00:00:37,410 --> 00:00:42,209
of course time for questions I've got a

15
00:00:39,300 --> 00:00:44,489
whole lot of code on little tiny slides

16
00:00:42,210 --> 00:00:46,020
so squint at it but we've got a lot to

17
00:00:44,490 --> 00:00:48,000
go through and a lot of diagrams to show

18
00:00:46,020 --> 00:00:50,329
you all so I won't be able to camp on

19
00:00:48,000 --> 00:00:53,010
any one technique for too much time

20
00:00:50,329 --> 00:00:54,420
obligatory disclaimer been clean Kowski

21
00:00:53,010 --> 00:00:55,620
and I both work for the government

22
00:00:54,420 --> 00:00:57,600
nothing we say in this project

23
00:00:55,620 --> 00:00:59,699
represents the views of the government

24
00:00:57,600 --> 00:01:02,700
whatsoever so please don't take it that

25
00:00:59,700 --> 00:01:06,810
way mmm goals with this project so we

26
00:01:02,700 --> 00:01:08,670
wanted to look at the hunting across the

27
00:01:06,810 --> 00:01:09,780
kill chain originally and we wanted to

28
00:01:08,670 --> 00:01:11,700
do something that was appropriate for

29
00:01:09,780 --> 00:01:12,899
security on a conference and we ended up

30
00:01:11,700 --> 00:01:15,210
with something a little bit different

31
00:01:12,899 --> 00:01:16,530
from from everything else so we've we've

32
00:01:15,210 --> 00:01:18,089
noticed this problem when we're hunting

33
00:01:16,530 --> 00:01:20,819
across multiple phases of the kill chain

34
00:01:18,090 --> 00:01:22,560
we don't always have the time and we

35
00:01:20,819 --> 00:01:24,569
don't always have the data to hunt on

36
00:01:22,560 --> 00:01:26,069
all parts of the kill chain so our first

37
00:01:24,569 --> 00:01:27,899
thought was okay we'll just focus on

38
00:01:26,069 --> 00:01:31,770
high-value parts of the kill chain see

39
00:01:27,899 --> 00:01:34,350
to exfil privilege escalation really

40
00:01:31,770 --> 00:01:38,399
great places to catch and a campaign

41
00:01:34,350 --> 00:01:40,380
going on across the whole really great

42
00:01:38,399 --> 00:01:42,509
places to watch one spot to catch the

43
00:01:40,380 --> 00:01:45,029
whole campaign going on but then we

44
00:01:42,509 --> 00:01:46,649
ended up because of our day jobs skewing

45
00:01:45,029 --> 00:01:48,298
towards something a little more what we

46
00:01:46,649 --> 00:01:50,909
call terrain focused or environment

47
00:01:48,299 --> 00:01:51,869
focused and then we were looking at

48
00:01:50,909 --> 00:01:53,159
Jupiter notebooks and we were

49
00:01:51,869 --> 00:01:54,990
increasingly using those in the

50
00:01:53,159 --> 00:01:56,219
environments to worry on so we like well

51
00:01:54,990 --> 00:01:58,020
what if instead of just being like

52
00:01:56,219 --> 00:01:59,639
here's security onion like everyone else

53
00:01:58,020 --> 00:02:01,079
is done and it's been really impressive

54
00:01:59,639 --> 00:02:03,119
to see some of the talks today on

55
00:02:01,079 --> 00:02:05,158
extending security onion using security

56
00:02:03,119 --> 00:02:06,569
and get all these things like what if we

57
00:02:05,159 --> 00:02:08,970
just use Jupiter and demonstrate the

58
00:02:06,569 --> 00:02:10,830
burrow analysis toolkit within it to

59
00:02:08,970 --> 00:02:12,930
just use the data science power of

60
00:02:10,830 --> 00:02:16,170
Jupiter with pandas running in it in

61
00:02:12,930 --> 00:02:18,659
order to demonstrate a whole analysis

62
00:02:16,170 --> 00:02:20,730
concept from the beginning of reading in

63
00:02:18,659 --> 00:02:22,359
the data analyzing the data and

64
00:02:20,730 --> 00:02:23,890
presenting it to

65
00:02:22,360 --> 00:02:25,000
you the people around us and then of

66
00:02:23,890 --> 00:02:26,649
course we wanted to share some cool

67
00:02:25,000 --> 00:02:28,360
tools and techniques which will

68
00:02:26,650 --> 00:02:30,850
eventually make the repo private so you

69
00:02:28,360 --> 00:02:32,140
guys can go to steal all the code so

70
00:02:30,850 --> 00:02:34,030
highlight on here that we are using

71
00:02:32,140 --> 00:02:35,170
Jupiter we'll go a little bit more into

72
00:02:34,030 --> 00:02:37,660
our environment for those who are

73
00:02:35,170 --> 00:02:40,929
unfamiliar with Jupiter it by default

74
00:02:37,660 --> 00:02:44,530
runs Julia Python and R and a

75
00:02:40,930 --> 00:02:46,300
combination of HTML markup and code

76
00:02:44,530 --> 00:02:48,430
interpreter so that you can get these

77
00:02:46,300 --> 00:02:49,600
really great visuals and commentary all

78
00:02:48,430 --> 00:02:50,920
in one with the code that you're

79
00:02:49,600 --> 00:02:52,420
actually running and then there's a

80
00:02:50,920 --> 00:02:55,030
feature where you can actually push all

81
00:02:52,420 --> 00:02:56,769
your code into slides like we've done

82
00:02:55,030 --> 00:02:58,180
here and show them with JavaScript

83
00:02:56,770 --> 00:03:02,020
through web browsers that's what's going

84
00:02:58,180 --> 00:03:03,700
on here all right so the who am I so Ben

85
00:03:02,020 --> 00:03:06,820
Clem Cassie couldn't be here today he's

86
00:03:03,700 --> 00:03:09,070
a cyber operations officer he you know

87
00:03:06,820 --> 00:03:09,940
big smile bald head as you can see in

88
00:03:09,070 --> 00:03:11,410
his picture

89
00:03:09,940 --> 00:03:14,290
he's got a master's in computer science

90
00:03:11,410 --> 00:03:17,260
and telecommunications goes back through

91
00:03:14,290 --> 00:03:19,600
army career leading teams teaching at

92
00:03:17,260 --> 00:03:21,910
West Point etc and then he's you know

93
00:03:19,600 --> 00:03:23,290
Christian father for weightlifter MMA I

94
00:03:21,910 --> 00:03:25,390
don't believe it he hasn't fought me yet

95
00:03:23,290 --> 00:03:28,298
and then likes to read and you know

96
00:03:25,390 --> 00:03:29,500
research data mining etc Who am I no

97
00:03:28,299 --> 00:03:31,540
picture because I'm right in front of

98
00:03:29,500 --> 00:03:33,730
you I'm what we call an analytics

99
00:03:31,540 --> 00:03:35,410
Support Officer with the army which some

100
00:03:33,730 --> 00:03:36,700
people call a data science officer and

101
00:03:35,410 --> 00:03:39,040
some people call critical thinking

102
00:03:36,700 --> 00:03:40,890
officer used to be military intelligence

103
00:03:39,040 --> 00:03:43,720
and graduated from West Point

104
00:03:40,890 --> 00:03:45,670
unfortunately not when income cassie was

105
00:03:43,720 --> 00:03:47,109
there teaching and the reason I say

106
00:03:45,670 --> 00:03:48,970
hasn't fought me yet it's I do judo and

107
00:03:47,110 --> 00:03:52,900
jiu-jitsu as well so we'll one day it'll

108
00:03:48,970 --> 00:03:55,359
happen and I'll probably lose alright so

109
00:03:52,900 --> 00:03:57,220
we have this motivating problem that's

110
00:03:55,360 --> 00:03:59,140
kind of reminiscent of what we see on a

111
00:03:57,220 --> 00:04:01,540
routine basis which is a firm calls you

112
00:03:59,140 --> 00:04:03,369
and your team to do consulting work the

113
00:04:01,540 --> 00:04:05,350
firm is concerned about their security

114
00:04:03,370 --> 00:04:07,780
and they suspect that they're being

115
00:04:05,350 --> 00:04:09,489
targeted may be compromised maybe not

116
00:04:07,780 --> 00:04:11,200
but they know someone's out to get them

117
00:04:09,489 --> 00:04:14,170
they don't have much understanding of

118
00:04:11,200 --> 00:04:17,409
their networks because acid inventories

119
00:04:14,170 --> 00:04:19,570
are hard so our network Maps apparently

120
00:04:17,410 --> 00:04:21,519
and it becomes clear early into the

121
00:04:19,570 --> 00:04:24,430
project that you don't have as much

122
00:04:21,519 --> 00:04:26,440
information as you want to really clear

123
00:04:24,430 --> 00:04:28,330
the network of things going on it's

124
00:04:26,440 --> 00:04:30,669
really hunt across it so you're going to

125
00:04:28,330 --> 00:04:32,620
inherently be limited to network data

126
00:04:30,669 --> 00:04:34,750
and in this use case we're going to

127
00:04:32,620 --> 00:04:36,220
limit ourselves to Bro defaults because

128
00:04:34,750 --> 00:04:37,600
we can get peak apps for example

129
00:04:36,220 --> 00:04:39,060
we can run through Brodie falls and this

130
00:04:37,600 --> 00:04:41,620
simulates a scenario that we're used to

131
00:04:39,060 --> 00:04:43,720
walking in dropping a tap somewhere and

132
00:04:41,620 --> 00:04:46,750
having to move from no host logs

133
00:04:43,720 --> 00:04:48,970
whatsoever and only network information

134
00:04:46,750 --> 00:04:50,350
to finding things of value so everything

135
00:04:48,970 --> 00:04:53,910
we're going to show you in this talk is

136
00:04:50,350 --> 00:04:56,500
primarily based on network artifacts

137
00:04:53,910 --> 00:04:57,520
setting up our environment alright so

138
00:04:56,500 --> 00:04:59,910
there's a couple things to highlight

139
00:04:57,520 --> 00:05:02,770
here and we get back over all my slides

140
00:04:59,910 --> 00:05:05,520
we're using pandas but we're using it

141
00:05:02,770 --> 00:05:07,150
through modern which allows us to do

142
00:05:05,520 --> 00:05:08,830
multi-threading with pandas which

143
00:05:07,150 --> 00:05:11,020
increases our processing speed and and

144
00:05:08,830 --> 00:05:12,460
makes our memory use more efficient and

145
00:05:11,020 --> 00:05:13,990
then there's a lot of numpy use in the

146
00:05:12,460 --> 00:05:15,789
background you can see a whole bunch of

147
00:05:13,990 --> 00:05:18,220
other libraries that we use such as math

148
00:05:15,790 --> 00:05:20,640
and time all pretty standard stuff the

149
00:05:18,220 --> 00:05:22,960
other thing to draw attention to here is

150
00:05:20,640 --> 00:05:26,200
that which stands for bro analysis

151
00:05:22,960 --> 00:05:29,140
toolkit which is going to super simplify

152
00:05:26,200 --> 00:05:31,539
and analyzing bro logs within a Jupiter

153
00:05:29,140 --> 00:05:33,820
or a Python environment so shout out to

154
00:05:31,540 --> 00:05:35,410
Brian Wylie for creating that and for

155
00:05:33,820 --> 00:05:36,219
maintaining it actually over the course

156
00:05:35,410 --> 00:05:38,860
of our project

157
00:05:36,220 --> 00:05:40,090
he made three major updates that kind of

158
00:05:38,860 --> 00:05:41,590
forced us to adapt and three major

159
00:05:40,090 --> 00:05:44,229
improvements to how it did its memory

160
00:05:41,590 --> 00:05:46,359
management etc also shout out to a

161
00:05:44,230 --> 00:05:48,610
friend of ours Jacob Baxter who's much

162
00:05:46,360 --> 00:05:49,510
better data science than we are and kind

163
00:05:48,610 --> 00:05:50,970
of walked us through some of our

164
00:05:49,510 --> 00:05:53,289
clustering as well as some of our

165
00:05:50,970 --> 00:05:55,510
dimensionality reduction reduction and

166
00:05:53,290 --> 00:05:57,669
projection stuff and then finally to

167
00:05:55,510 --> 00:05:59,140
Milla parkour from deepen and contagion

168
00:05:57,669 --> 00:06:00,609
malware dump because that's where we got

169
00:05:59,140 --> 00:06:01,840
all of our peak apps from or the

170
00:06:00,610 --> 00:06:10,270
exception of the peak apps that are from

171
00:06:01,840 --> 00:06:13,060
the West Point cyber defense exercise so

172
00:06:10,270 --> 00:06:14,650
classes of analytic techniques for the

173
00:06:13,060 --> 00:06:16,720
sake of this talk and analytic is

174
00:06:14,650 --> 00:06:19,030
anything or any analysis technique

175
00:06:16,720 --> 00:06:21,190
analysis technique that allows us to

176
00:06:19,030 --> 00:06:23,200
draw inside out of data that's a really

177
00:06:21,190 --> 00:06:25,540
vague definition but it has a lot of

178
00:06:23,200 --> 00:06:27,340
utility when we're looking at a simplify

179
00:06:25,540 --> 00:06:29,640
simplified framework like this so you've

180
00:06:27,340 --> 00:06:32,229
got three generic types aggregation

181
00:06:29,640 --> 00:06:35,039
summarizing the data a lot of stacking

182
00:06:32,229 --> 00:06:37,659
doing basic statistics visualization

183
00:06:35,040 --> 00:06:39,310
enrichment adding data to it to provide

184
00:06:37,660 --> 00:06:41,590
more value similar to what you just saw

185
00:06:39,310 --> 00:06:43,720
Brian do with the jaw three stuff and

186
00:06:41,590 --> 00:06:45,940
then processing transforming it into a

187
00:06:43,720 --> 00:06:47,140
more usable form and then we have

188
00:06:45,940 --> 00:06:49,600
learning analytics where you have

189
00:06:47,140 --> 00:06:54,640
regression clustering classification

190
00:06:49,600 --> 00:06:56,860
so what a highlight here the importance

191
00:06:54,640 --> 00:06:58,330
of not stepping over the hundred dollar

192
00:06:56,860 --> 00:07:00,340
bill to pick up the nickel on the other

193
00:06:58,330 --> 00:07:01,630
side so as you look at this the simplest

194
00:07:00,340 --> 00:07:03,549
Tsar at the top of the page and the

195
00:07:01,630 --> 00:07:04,860
hardest are towards the bottom of the

196
00:07:03,550 --> 00:07:07,120
page particularly with learning out

197
00:07:04,860 --> 00:07:09,250
analytics and a lot of people are gonna

198
00:07:07,120 --> 00:07:10,510
say like we need to get data science we

199
00:07:09,250 --> 00:07:13,000
need to get machine learning into the

200
00:07:10,510 --> 00:07:15,010
fight with cyber defense and that's true

201
00:07:13,000 --> 00:07:17,350
however if you're in an environment

202
00:07:15,010 --> 00:07:19,210
where you don't understand the basics of

203
00:07:17,350 --> 00:07:21,370
statistics or the basics of data science

204
00:07:19,210 --> 00:07:23,770
you're going to pass over a lot of value

205
00:07:21,370 --> 00:07:25,930
for very little work in order to get to

206
00:07:23,770 --> 00:07:32,049
that machine learning solution that all

207
00:07:25,930 --> 00:07:33,640
the marketers have sold to you so what

208
00:07:32,050 --> 00:07:34,660
we ended up coming up with is a terrain

209
00:07:33,640 --> 00:07:36,610
based approach

210
00:07:34,660 --> 00:07:39,190
unfortunately it's my only meme in here

211
00:07:36,610 --> 00:07:40,540
it's easier to do memes in PowerPoint so

212
00:07:39,190 --> 00:07:41,860
instead of walking through each phase of

213
00:07:40,540 --> 00:07:43,810
the kill chain like a lot of hunt

214
00:07:41,860 --> 00:07:45,250
methodologies will will pitch we're

215
00:07:43,810 --> 00:07:47,290
gonna start with understanding the data

216
00:07:45,250 --> 00:07:49,540
as a whole then describing what entities

217
00:07:47,290 --> 00:07:51,520
are present how those entities interact

218
00:07:49,540 --> 00:07:53,560
with each other and then finally moving

219
00:07:51,520 --> 00:07:54,969
from the terrain focused approach which

220
00:07:53,560 --> 00:07:57,340
is all those entities in your network

221
00:07:54,970 --> 00:07:58,900
into understanding the threats you may

222
00:07:57,340 --> 00:08:00,640
encounter and prioritizing your hunt

223
00:07:58,900 --> 00:08:02,229
from there so it's essentially if I'm

224
00:08:00,640 --> 00:08:04,450
gonna go hunt deer the first thing I'm

225
00:08:02,230 --> 00:08:06,610
going to do is really really understand

226
00:08:04,450 --> 00:08:07,930
the woods and then I'm gonna understand

227
00:08:06,610 --> 00:08:10,030
all the creatures in the woods and how

228
00:08:07,930 --> 00:08:11,980
they tend to interact and then I'm gonna

229
00:08:10,030 --> 00:08:13,599
go after my target because now I'm

230
00:08:11,980 --> 00:08:15,400
familiar enough with the terrain that I

231
00:08:13,600 --> 00:08:21,100
can track it even if I'm not intimately

232
00:08:15,400 --> 00:08:22,960
familiar with it for the hunters in the

233
00:08:21,100 --> 00:08:24,720
room like the deer hunters please don't

234
00:08:22,960 --> 00:08:26,560
pick that analogy apart too badly

235
00:08:24,720 --> 00:08:28,150
alright so first step we're gonna

236
00:08:26,560 --> 00:08:30,610
understand our data as a whole this is

237
00:08:28,150 --> 00:08:32,230
all the super simple stuff that we like

238
00:08:30,610 --> 00:08:35,560
to do and we typically throw these up in

239
00:08:32,230 --> 00:08:36,940
dashboards kibana etc right so the first

240
00:08:35,559 --> 00:08:38,770
thing we need to understand is actually

241
00:08:36,940 --> 00:08:41,230
how much data is present so for this

242
00:08:38,770 --> 00:08:43,140
example we've gone through pulled out

243
00:08:41,230 --> 00:08:45,040
all the IPS that we've observed

244
00:08:43,140 --> 00:08:47,110
deduplicated them and understand that

245
00:08:45,040 --> 00:08:49,270
from a sort destination IP perspective

246
00:08:47,110 --> 00:08:51,940
for the pcap i ran this on we have 31

247
00:08:49,270 --> 00:08:54,939
unique source IPS you can see you know

248
00:08:51,940 --> 00:08:58,120
roughly 2500 destination IPs and then I

249
00:08:54,940 --> 00:09:00,850
demonstrate a set dice set difference to

250
00:08:58,120 --> 00:09:02,030
figure out what what's the value of the

251
00:09:00,850 --> 00:09:04,910
total number of IP

252
00:09:02,030 --> 00:09:07,430
which will go into neck back down down

253
00:09:04,910 --> 00:09:08,930
all right we do the set difference and

254
00:09:07,430 --> 00:09:12,530
we see that those two are the two that

255
00:09:08,930 --> 00:09:16,609
those two IPs they're in the set

256
00:09:12,530 --> 00:09:18,290
difference of I talked - I listened our

257
00:09:16,610 --> 00:09:21,110
two people who only talked - never

258
00:09:18,290 --> 00:09:22,430
listened in the broken log and that's

259
00:09:21,110 --> 00:09:23,990
that tells it starts to tell us

260
00:09:22,430 --> 00:09:26,329
something about the environment now

261
00:09:23,990 --> 00:09:28,940
there's more that you can do in this way

262
00:09:26,330 --> 00:09:32,000
this is just one example of how to do

263
00:09:28,940 --> 00:09:33,350
that so we've got basic counts of how

264
00:09:32,000 --> 00:09:35,000
much information I have in here you

265
00:09:33,350 --> 00:09:37,790
could also say how how many megabytes

266
00:09:35,000 --> 00:09:39,650
how many gigabytes does my data take up

267
00:09:37,790 --> 00:09:41,870
how many rows and records do I have and

268
00:09:39,650 --> 00:09:45,140
then start to summarize that into I have

269
00:09:41,870 --> 00:09:49,400
and all of these records 31 IPS or I

270
00:09:45,140 --> 00:09:51,920
have you know 2659 IPS 31 of which we're

271
00:09:49,400 --> 00:09:53,990
talkers and 2500 of which or listeners

272
00:09:51,920 --> 00:09:56,540
and then cut this down to with a very

273
00:09:53,990 --> 00:09:58,130
simple math calculation which is one

274
00:09:56,540 --> 00:10:00,589
thing minus the other these two were

275
00:09:58,130 --> 00:10:02,060
purely talkers then we get into

276
00:10:00,590 --> 00:10:03,260
describing what they actually do and

277
00:10:02,060 --> 00:10:05,630
this is where we do most of our typical

278
00:10:03,260 --> 00:10:08,270
stacking so here we have TCP UDP and

279
00:10:05,630 --> 00:10:10,550
ICMP stacked up so we can see which ones

280
00:10:08,270 --> 00:10:12,350
are most most common and then we go into

281
00:10:10,550 --> 00:10:14,599
top talkers just like we would do with

282
00:10:12,350 --> 00:10:16,910
our dashboards right so we can see by

283
00:10:14,600 --> 00:10:18,800
session count the top 15 talkers and

284
00:10:16,910 --> 00:10:20,180
that takes as long okay sessions are

285
00:10:18,800 --> 00:10:22,160
interesting but bytes are more

286
00:10:20,180 --> 00:10:24,680
interesting and so we start to see that

287
00:10:22,160 --> 00:10:26,030
this network is very much dominated by

288
00:10:24,680 --> 00:10:28,880
actually switched over listeners they're

289
00:10:26,030 --> 00:10:32,720
very much dominated by certain certain

290
00:10:28,880 --> 00:10:34,280
people so yeah this is table so go to

291
00:10:32,720 --> 00:10:36,620
top listeners and we're like oh okay so

292
00:10:34,280 --> 00:10:38,449
we see that Google's DNS servers the top

293
00:10:36,620 --> 00:10:40,610
listener by session count which makes a

294
00:10:38,450 --> 00:10:42,770
lot of sense because UDP sessions are

295
00:10:40,610 --> 00:10:44,990
really tiny so what if we take that out

296
00:10:42,770 --> 00:10:47,120
and or sorry what if we switched it over

297
00:10:44,990 --> 00:10:51,160
to byte count does it still remain the

298
00:10:47,120 --> 00:10:53,510
same and it doesn't because the most

299
00:10:51,160 --> 00:10:55,430
most listeners are receiving more

300
00:10:53,510 --> 00:10:58,069
information than what goes into a DNS

301
00:10:55,430 --> 00:10:59,689
query so super simple metrics to start

302
00:10:58,070 --> 00:11:03,440
to learn about what entities are in your

303
00:10:59,690 --> 00:11:04,760
environment then we go on to DNS you can

304
00:11:03,440 --> 00:11:06,500
see just by stacking the number of

305
00:11:04,760 --> 00:11:09,460
queries we've got a lot of W pad and

306
00:11:06,500 --> 00:11:11,510
then request to Google Google domains

307
00:11:09,460 --> 00:11:13,550
dominate the conversation from there

308
00:11:11,510 --> 00:11:16,100
we'll show you some better DNS and now

309
00:11:13,550 --> 00:11:17,990
techniques ooh so once we've done

310
00:11:16,100 --> 00:11:21,620
describing the entities we start getting

311
00:11:17,990 --> 00:11:22,760
into describing how they interacts and

312
00:11:21,620 --> 00:11:25,670
this is where the fun stuff actually

313
00:11:22,760 --> 00:11:29,649
starts happening funner as much fun as

314
00:11:25,670 --> 00:11:29,649
staring at charts on a Saturday can be

315
00:11:29,709 --> 00:11:34,969
alright so we've got how do entities

316
00:11:32,750 --> 00:11:36,560
relate to each other are they acting as

317
00:11:34,970 --> 00:11:38,540
a server or are they acting as a client

318
00:11:36,560 --> 00:11:40,459
are they acting as a server when they

319
00:11:38,540 --> 00:11:42,740
are a client and we've got several

320
00:11:40,459 --> 00:11:44,359
different approaches to that so are they

321
00:11:42,740 --> 00:11:46,459
hosting well-known or registered ports

322
00:11:44,360 --> 00:11:48,350
what does the producer/consumer ratio

323
00:11:46,459 --> 00:11:49,939
look like and then we can use network

324
00:11:48,350 --> 00:11:51,800
analysis techniques like in and out

325
00:11:49,940 --> 00:11:53,570
degree to look at that we can also then

326
00:11:51,800 --> 00:11:55,550
characterize those connections looking

327
00:11:53,570 --> 00:11:57,680
for dark space on within the network

328
00:11:55,550 --> 00:11:58,729
internal movement client to client stuff

329
00:11:57,680 --> 00:12:00,649
we all know that that typically

330
00:11:58,730 --> 00:12:03,079
indicates bad and then connected

331
00:12:00,649 --> 00:12:05,120
attempts to block ports so at this point

332
00:12:03,079 --> 00:12:10,250
we'll switch over to one of the other

333
00:12:05,120 --> 00:12:13,880
shows I show you simple filtering

334
00:12:10,250 --> 00:12:15,320
implies for a backup to be s1 all right

335
00:12:13,880 --> 00:12:16,550
so now we're gonna use the bro analysis

336
00:12:15,320 --> 00:12:19,250
toolkit to look for hosts that are

337
00:12:16,550 --> 00:12:20,420
responding like servers con analyzer is

338
00:12:19,250 --> 00:12:22,640
a library within the broad analysis

339
00:12:20,420 --> 00:12:24,380
analysis toolkit that allows us to

340
00:12:22,640 --> 00:12:28,640
automate common searches across the

341
00:12:24,380 --> 00:12:32,050
broke on log super simple code read it

342
00:12:28,640 --> 00:12:34,220
in and then I basically spit it out say

343
00:12:32,050 --> 00:12:37,490
describe the data again and then we can

344
00:12:34,220 --> 00:12:39,760
go into show me all of basically across

345
00:12:37,490 --> 00:12:42,290
the top the ports within the well-known

346
00:12:39,760 --> 00:12:44,959
well-known ports range that people are

347
00:12:42,290 --> 00:12:47,180
listening on and where they were also a

348
00:12:44,959 --> 00:12:49,579
receiving host so we begin to have a

349
00:12:47,180 --> 00:12:54,410
somewhat of a fingerprint of what

350
00:12:49,579 --> 00:12:57,620
communications went to that house from

351
00:12:54,410 --> 00:12:59,649
here we're then going to remove certain

352
00:12:57,620 --> 00:13:02,600
values and set thresholds and we end up

353
00:12:59,649 --> 00:13:05,750
filtering out for just endpoints that we

354
00:13:02,600 --> 00:13:07,760
know are clients and cross crossing that

355
00:13:05,750 --> 00:13:09,860
with the data that we have for things be

356
00:13:07,760 --> 00:13:11,779
having a server so two slides back at

357
00:13:09,860 --> 00:13:13,459
the contingency table we have all the

358
00:13:11,779 --> 00:13:14,959
things behaving as servers and then we

359
00:13:13,459 --> 00:13:17,000
go forward and say but we have a list of

360
00:13:14,959 --> 00:13:19,550
clients based on what we know is our

361
00:13:17,000 --> 00:13:21,290
internal lights IP space and we're gonna

362
00:13:19,550 --> 00:13:23,050
go through our internal IP space and

363
00:13:21,290 --> 00:13:25,219
spit out everything in the server list

364
00:13:23,050 --> 00:13:27,290
based on how was behaving as a server

365
00:13:25,220 --> 00:13:29,509
but we know it's a client and then

366
00:13:27,290 --> 00:13:32,300
begins to tell us some picture of what's

367
00:13:29,509 --> 00:13:35,660
going on for example this 10:1 60-66

368
00:13:32,300 --> 00:13:39,109
here who has served ports up across this

369
00:13:35,660 --> 00:13:40,550
entire range from 20 through through 29

370
00:13:39,110 --> 00:13:42,560
and then we snip it off for the sake of

371
00:13:40,550 --> 00:13:46,000
the of the presentation you can see that

372
00:13:42,560 --> 00:13:46,000
in some other places as well

373
00:13:47,259 --> 00:13:51,350
we can also do this with registered

374
00:13:49,759 --> 00:13:53,149
ports we won't camp on this too long

375
00:13:51,350 --> 00:13:55,850
it's essentially exactly the same thing

376
00:13:53,149 --> 00:13:57,560
this is just a different port range so

377
00:13:55,850 --> 00:13:59,420
we start again with how's it behaving as

378
00:13:57,560 --> 00:14:01,160
a server and then go through the clients

379
00:13:59,420 --> 00:14:03,560
and pull it out we know you're a client

380
00:14:01,160 --> 00:14:05,240
why are you behaving a server and what

381
00:14:03,560 --> 00:14:10,369
are you what kind of server are you

382
00:14:05,240 --> 00:14:12,199
pretending to be we also mentioned

383
00:14:10,370 --> 00:14:15,949
producer-consumer ratio it's a little

384
00:14:12,199 --> 00:14:18,199
more math heavy producer-consumer ratio

385
00:14:15,949 --> 00:14:20,750
is a simple calculation per session that

386
00:14:18,199 --> 00:14:22,729
says how many bytes that I send how many

387
00:14:20,750 --> 00:14:24,440
bytes did I receive and let me turn that

388
00:14:22,730 --> 00:14:26,720
into a simple calculation that's going

389
00:14:24,440 --> 00:14:29,779
to be between the value of zero one both

390
00:14:26,720 --> 00:14:32,060
positive and negative so if I only send

391
00:14:29,779 --> 00:14:34,610
my total bytes is created by only bytes

392
00:14:32,060 --> 00:14:37,339
sense ie bytes sent plus zero equals

393
00:14:34,610 --> 00:14:40,040
total bytes then I'm gonna be a purely

394
00:14:37,339 --> 00:14:41,959
producer at a value of exactly 1.0 if I

395
00:14:40,040 --> 00:14:43,880
send nothing zero and I receive

396
00:14:41,959 --> 00:14:45,949
everything so minus total bytes sent

397
00:14:43,880 --> 00:14:48,800
over total bytes sent I'm a purely

398
00:14:45,949 --> 00:14:50,120
receiver purely consumer in this case so

399
00:14:48,800 --> 00:14:53,660
it's download only kind of behavior

400
00:14:50,120 --> 00:14:55,430
you'll see something about for an HTTP

401
00:14:53,660 --> 00:14:57,079
download or sorry as I'm browsing

402
00:14:55,430 --> 00:14:59,479
through the web you should be seeing

403
00:14:57,079 --> 00:15:01,250
about of negative 0.5 for regular web

404
00:14:59,480 --> 00:15:03,500
browsing activity if I'm sending an

405
00:15:01,250 --> 00:15:06,440
email you're at about positive 0.5 and

406
00:15:03,500 --> 00:15:08,779
then if I'm downloading a big file over

407
00:15:06,440 --> 00:15:10,850
HTTP I'm gonna be basically at a pure

408
00:15:08,779 --> 00:15:15,290
negative 1 that's how those ratios

409
00:15:10,850 --> 00:15:16,850
translate out into real life so what we

410
00:15:15,290 --> 00:15:20,149
then do is for every session in the log

411
00:15:16,850 --> 00:15:22,399
we go through and calculate PCR charts

412
00:15:20,149 --> 00:15:23,630
and squint charts all right then we're

413
00:15:22,399 --> 00:15:25,279
going to go through and actually

414
00:15:23,630 --> 00:15:27,470
collapse those down into some

415
00:15:25,279 --> 00:15:28,579
descriptive statistics of that I want to

416
00:15:27,470 --> 00:15:30,470
draw your attention down here to the

417
00:15:28,579 --> 00:15:32,599
bottom where it says STD that is

418
00:15:30,470 --> 00:15:34,939
standard deviation so we're gonna for

419
00:15:32,600 --> 00:15:37,910
every IP yeah there's a joke in there

420
00:15:34,939 --> 00:15:39,889
somewhere I'm sure for every IP we're

421
00:15:37,910 --> 00:15:40,819
gonna look across all of the PCR s for

422
00:15:39,889 --> 00:15:42,949
all of its sessions we're

423
00:15:40,819 --> 00:15:44,839
collapse it down do the descriptive

424
00:15:42,949 --> 00:15:46,399
statistics of it mean median mode and

425
00:15:44,839 --> 00:15:47,629
then we're calculate the standard

426
00:15:46,399 --> 00:15:49,339
deviation and we're going to present

427
00:15:47,629 --> 00:15:51,679
that back to the analysts we're then

428
00:15:49,339 --> 00:15:53,989
also going to figure out Max and min

429
00:15:51,679 --> 00:15:55,789
values and then this high calculation

430
00:15:53,989 --> 00:15:58,729
that you'll see in the next page is the

431
00:15:55,789 --> 00:16:03,169
number of standard deviations that that

432
00:15:58,729 --> 00:16:04,789
it's max value is above norm so the next

433
00:16:03,169 --> 00:16:07,129
page you'll see a Maxima high and the

434
00:16:04,789 --> 00:16:09,470
high is going to be in a full number

435
00:16:07,129 --> 00:16:12,169
even though your max is at like point

436
00:16:09,470 --> 00:16:15,379
three here a little confusing but we can

437
00:16:12,169 --> 00:16:16,999
see that for this IP it's had this many

438
00:16:15,379 --> 00:16:19,459
sessions I won't read it out to you and

439
00:16:16,999 --> 00:16:21,709
then we see it's minimum one we get it's

440
00:16:19,459 --> 00:16:24,138
three quarts or four quartiles where

441
00:16:21,709 --> 00:16:26,358
they're divided at its max value and

442
00:16:24,139 --> 00:16:28,160
then for this Max value which we can see

443
00:16:26,359 --> 00:16:31,069
is above the last quartile from this

444
00:16:28,160 --> 00:16:35,358
that it's five standard deviations above

445
00:16:31,069 --> 00:16:39,079
the norm so somewhere and that IP space

446
00:16:35,359 --> 00:16:41,509
it was behaving primarily as a most

447
00:16:39,079 --> 00:16:43,519
likely as a producer and that was

448
00:16:41,509 --> 00:16:45,189
abnormal for that things behavior so

449
00:16:43,519 --> 00:16:48,350
we'd go back and look through all of its

450
00:16:45,189 --> 00:16:50,389
its individual sessions and their PCR

451
00:16:48,350 --> 00:16:57,079
values and we look for that spike and we

452
00:16:50,389 --> 00:16:59,239
begin to find something bad so that

453
00:16:57,079 --> 00:17:00,399
tells us into the the dot six eight is

454
00:16:59,239 --> 00:17:03,499
the one we use for this example which is

455
00:17:00,399 --> 00:17:05,269
1/3 down that does us into what this one

456
00:17:03,499 --> 00:17:07,579
is doing so like I just said we pull

457
00:17:05,269 --> 00:17:10,490
back at sessions and we begin to drill

458
00:17:07,579 --> 00:17:12,259
into it this is us running more bad

459
00:17:10,490 --> 00:17:13,939
stuff it produces a lot of warnings and

460
00:17:12,259 --> 00:17:16,429
then we can see the kind of traffic that

461
00:17:13,939 --> 00:17:18,319
it's that it's talking to you and this

462
00:17:16,429 --> 00:17:20,689
pushes us straight into this is actually

463
00:17:18,319 --> 00:17:22,668
emerged with a DNS table so that we get

464
00:17:20,689 --> 00:17:25,039
real VAT real names on top of it and

465
00:17:22,669 --> 00:17:28,220
finally we land with all of these so we

466
00:17:25,039 --> 00:17:30,679
can see Leno Lenovo with a bunch of

467
00:17:28,220 --> 00:17:32,809
nonces down at the negative four level

468
00:17:30,679 --> 00:17:34,250
and then a bunch of stuff down here too

469
00:17:32,809 --> 00:17:36,259
and that's somewhere in the snip is

470
00:17:34,250 --> 00:17:38,799
shark lasers dot net which is really

471
00:17:36,259 --> 00:17:38,799
what we're looking for

472
00:17:41,679 --> 00:17:45,559
in versus out degree we'll talk about a

473
00:17:43,970 --> 00:17:47,390
little bit later connections into dark

474
00:17:45,559 --> 00:17:49,490
space for the sake of time I'm actually

475
00:17:47,390 --> 00:17:51,500
gonna skip over and we'll look at

476
00:17:49,490 --> 00:17:52,970
internal movement so client to client

477
00:17:51,500 --> 00:17:54,380
communications this is a very

478
00:17:52,970 --> 00:17:57,260
straightforward one in fact this slide

479
00:17:54,380 --> 00:17:59,390
deck is a total of one slide this is

480
00:17:57,260 --> 00:18:02,000
literally just a filter to say what is

481
00:17:59,390 --> 00:18:03,860
internal IP space versus internal IP

482
00:18:02,000 --> 00:18:05,780
space highlight all the sessions who

483
00:18:03,860 --> 00:18:08,510
they talk to for internal and to

484
00:18:05,780 --> 00:18:17,240
internal behavior and then finally for

485
00:18:08,510 --> 00:18:19,100
this section we have connection attempts

486
00:18:17,240 --> 00:18:21,650
to block ports so if we have a block

487
00:18:19,100 --> 00:18:24,020
port list then we can summarize very

488
00:18:21,650 --> 00:18:25,970
quickly each IP that tried to talk to

489
00:18:24,020 --> 00:18:28,730
what what blocked ports and what was the

490
00:18:25,970 --> 00:18:29,929
destination IP was the block board so

491
00:18:28,730 --> 00:18:31,309
you're noticing some of this stuff is

492
00:18:29,929 --> 00:18:33,980
stuff that we very easily automate with

493
00:18:31,309 --> 00:18:35,149
a seam and if we're gonna do it in an

494
00:18:33,980 --> 00:18:36,919
environment like Jupiter we're just

495
00:18:35,150 --> 00:18:38,750
gonna go through it real fast gain some

496
00:18:36,919 --> 00:18:41,179
situational awareness and move on to the

497
00:18:38,750 --> 00:18:43,549
next harder problem that a data science

498
00:18:41,179 --> 00:18:47,000
or a data analysis toolkit is more

499
00:18:43,549 --> 00:18:48,559
suited to solve and solve only once

500
00:18:47,000 --> 00:18:53,360
instead of solving in an automated

501
00:18:48,559 --> 00:18:56,530
repeated fashion right don't come back

502
00:18:53,360 --> 00:18:56,530
over to our main presentation

503
00:18:58,810 --> 00:19:03,250
characterizing protocols based on on

504
00:19:01,180 --> 00:19:04,390
what they do so this is a little

505
00:19:03,250 --> 00:19:08,490
different than just characterizing the

506
00:19:04,390 --> 00:19:11,530
protocols so we all know that HTTP is

507
00:19:08,490 --> 00:19:12,940
supposed to ride over port haiti so one

508
00:19:11,530 --> 00:19:14,320
of the quickest ways we can look for a

509
00:19:12,940 --> 00:19:17,080
protocol that's misbehaving is where

510
00:19:14,320 --> 00:19:18,580
HTTP over something besides the four or

511
00:19:17,080 --> 00:19:20,470
five ports that are typically associated

512
00:19:18,580 --> 00:19:22,510
with that SE so eighty and then the

513
00:19:20,470 --> 00:19:24,780
other reserved ports we can start to get

514
00:19:22,510 --> 00:19:27,040
into things too outliers based on

515
00:19:24,780 --> 00:19:29,800
entropy which is really better for DNS

516
00:19:27,040 --> 00:19:32,649
and HTTP session length length of

517
00:19:29,800 --> 00:19:34,240
headers things like inter arrival time I

518
00:19:32,650 --> 00:19:37,090
don't know if we have the code for that

519
00:19:34,240 --> 00:19:39,130
in this presentation so what we actually

520
00:19:37,090 --> 00:19:41,560
begin to find as we dig down into things

521
00:19:39,130 --> 00:19:43,360
like that as DNS has a very interesting

522
00:19:41,560 --> 00:19:46,690
profile when it comes to all of these

523
00:19:43,360 --> 00:19:49,120
sub metrics and HTTP and HTTPS do as

524
00:19:46,690 --> 00:19:50,950
well and based on that profile we can

525
00:19:49,120 --> 00:19:53,729
actually start to describe as this web

526
00:19:50,950 --> 00:19:56,770
browsing is this watching a movie is

527
00:19:53,730 --> 00:20:01,060
downloading a file etc without purely

528
00:19:56,770 --> 00:20:02,530
relying on byte counts so we'll walk

529
00:20:01,060 --> 00:20:05,200
through outlier detection which will

530
00:20:02,530 --> 00:20:06,490
demonstrate actually here and then we've

531
00:20:05,200 --> 00:20:09,580
got some stuff on measures of entropy

532
00:20:06,490 --> 00:20:11,260
and randomness as well as a couple

533
00:20:09,580 --> 00:20:15,460
different interesting ways to look for

534
00:20:11,260 --> 00:20:17,890
unregistered HTTP methods and DNS nonces

535
00:20:15,460 --> 00:20:19,750
etc so we'll go right along into

536
00:20:17,890 --> 00:20:25,060
outliers and then we're gonna double

537
00:20:19,750 --> 00:20:27,970
back into DNS multi-class etcetera all

538
00:20:25,060 --> 00:20:29,620
right outlier detection so this is going

539
00:20:27,970 --> 00:20:33,250
to rely on stacking which we already did

540
00:20:29,620 --> 00:20:35,260
and build up some interesting things

541
00:20:33,250 --> 00:20:37,000
with key artifacts such as user agent

542
00:20:35,260 --> 00:20:41,080
strings which are found in bro and your

543
00:20:37,000 --> 00:20:43,000
HTTP log so we're gonna pull it out and

544
00:20:41,080 --> 00:20:44,770
then do the value counts which panas

545
00:20:43,000 --> 00:20:46,330
makes really easy looking at the head

546
00:20:44,770 --> 00:20:47,889
just gives you the top five of them and

547
00:20:46,330 --> 00:20:50,050
you can see here that Mozilla

548
00:20:47,890 --> 00:20:51,730
dominant the Mozilla user agent strings

549
00:20:50,050 --> 00:20:54,659
that we expect to see dominate the top

550
00:20:51,730 --> 00:20:54,660
five pretty heavily

551
00:20:59,630 --> 00:21:06,000
all right and then as we look at the

552
00:21:02,070 --> 00:21:08,600
tail instead we see this interesting

553
00:21:06,000 --> 00:21:11,159
artifact here the so sorry dot CA and

554
00:21:08,600 --> 00:21:12,600
then a drop off to all these things this

555
00:21:11,159 --> 00:21:14,100
is actually out of cyber defense

556
00:21:12,600 --> 00:21:17,370
exercise so you see like the Air Force

557
00:21:14,100 --> 00:21:20,250
Mill in there because of its simulating

558
00:21:17,370 --> 00:21:21,268
a DoD environment and this is

559
00:21:20,250 --> 00:21:24,600
interesting and we're gonna want to

560
00:21:21,269 --> 00:21:26,279
drill into it so we drill into it and if

561
00:21:24,600 --> 00:21:28,918
we look at it we see that it's mostly

562
00:21:26,279 --> 00:21:31,529
gets and very few posts which is

563
00:21:28,919 --> 00:21:35,340
interesting to see and then we're gonna

564
00:21:31,529 --> 00:21:37,200
go to the next step and so mostly

565
00:21:35,340 --> 00:21:41,129
consuming traffic very little producing

566
00:21:37,200 --> 00:21:42,899
traffic could be some the domain itself

567
00:21:41,129 --> 00:21:45,779
is suspicious we found it because of the

568
00:21:42,899 --> 00:21:47,908
user agent string and we'll want to

569
00:21:45,779 --> 00:21:50,279
continue digging into that in the future

570
00:21:47,909 --> 00:21:54,330
that brings us into consistency analysis

571
00:21:50,279 --> 00:21:55,320
and illegal artifacts so I apologize

572
00:21:54,330 --> 00:21:58,110
enrichment shouldn't have gotten into

573
00:21:55,320 --> 00:22:01,428
that one which I will jump up to you and

574
00:21:58,110 --> 00:22:01,428
a different slide

575
00:22:04,780 --> 00:22:12,399
going over to measures of entropy and

576
00:22:06,820 --> 00:22:14,740
randomness though we can look into DNS

577
00:22:12,400 --> 00:22:17,559
using either nonces which as you guys

578
00:22:14,740 --> 00:22:19,809
are from there with c2 traffic over DNS

579
00:22:17,559 --> 00:22:21,039
relies on communicating all the way

580
00:22:19,809 --> 00:22:22,990
through with the recursive DNS

581
00:22:21,039 --> 00:22:25,809
structures all the way to the

582
00:22:22,990 --> 00:22:27,789
authoritative nameserver in order to do

583
00:22:25,809 --> 00:22:30,580
that you have to not only minimize

584
00:22:27,789 --> 00:22:33,190
caching or cache time values but you

585
00:22:30,580 --> 00:22:36,549
also have to consistently create a

586
00:22:33,190 --> 00:22:38,080
unique sub domain that forces the DNS

587
00:22:36,549 --> 00:22:39,400
servers to talk all the way back to you

588
00:22:38,080 --> 00:22:41,830
a Thor native name server for that

589
00:22:39,400 --> 00:22:43,260
domain so we're gonna look for nonces

590
00:22:41,830 --> 00:22:46,210
because you're going to see a lot of

591
00:22:43,260 --> 00:22:50,289
nonces when c2 is being done where

592
00:22:46,210 --> 00:22:51,429
tunnelling is being done over dns so

593
00:22:50,289 --> 00:22:52,330
we've gone through in this code and

594
00:22:51,429 --> 00:22:55,659
we're actually gonna break out

595
00:22:52,330 --> 00:22:58,330
everything that's below level 3 that's

596
00:22:55,659 --> 00:23:00,460
based on some experience on on bins part

597
00:22:58,330 --> 00:23:03,189
most of the nonces are gonna be at level

598
00:23:00,460 --> 00:23:06,549
4 or lower so you've got your top level

599
00:23:03,190 --> 00:23:08,140
domain your dot-com recoat uk's and then

600
00:23:06,549 --> 00:23:10,720
you've got your primary domain then

601
00:23:08,140 --> 00:23:14,679
typically one sub domain and then nonces

602
00:23:10,720 --> 00:23:16,299
is what he's mostly at experiencing so

603
00:23:14,679 --> 00:23:18,039
when we rip it out that way we can then

604
00:23:16,299 --> 00:23:19,960
count things by those level threes and

605
00:23:18,039 --> 00:23:25,559
we immediately see that cyber mugging

606
00:23:19,960 --> 00:23:29,080
net has what is that 376 thousand

607
00:23:25,559 --> 00:23:31,000
children at level 4 and then we also see

608
00:23:29,080 --> 00:23:33,699
shark lasers which has a similar level 3

609
00:23:31,000 --> 00:23:36,070
to cyber mugging net has the same thing

610
00:23:33,700 --> 00:23:38,620
we see legitimate domains that behave

611
00:23:36,070 --> 00:23:40,629
like illegitimate domains and that's

612
00:23:38,620 --> 00:23:42,629
because a lot of legitimate domains

613
00:23:40,630 --> 00:23:47,110
collect telemetry on you using the same

614
00:23:42,630 --> 00:23:49,150
process as malware does so actually what

615
00:23:47,110 --> 00:23:51,280
you'll see in a real network is your AVS

616
00:23:49,150 --> 00:23:52,870
will pop up when you do this stuff the

617
00:23:51,280 --> 00:23:57,879
same way that your malware seek you will

618
00:23:52,870 --> 00:23:59,678
pop up which is always fun alternatively

619
00:23:57,880 --> 00:24:01,090
we can calculate the probability of the

620
00:23:59,679 --> 00:24:03,190
lowest sub domain and we can look at his

621
00:24:01,090 --> 00:24:05,289
entropy shout out to mark Baggett is in

622
00:24:03,190 --> 00:24:08,799
the room somewhere for the code that we

623
00:24:05,289 --> 00:24:11,770
stole from his github and then we can

624
00:24:08,799 --> 00:24:14,139
add great probability of subdomains by

625
00:24:11,770 --> 00:24:15,280
the last three levels and this we can

626
00:24:14,140 --> 00:24:17,500
then sort on and start identifying

627
00:24:15,280 --> 00:24:18,550
interesting to look at so interesting

628
00:24:17,500 --> 00:24:21,360
ones jump out

629
00:24:18,550 --> 00:24:25,620
cyber battlefield comm cyber mugging and

630
00:24:21,360 --> 00:24:25,620
shark lasers is in there again somewhere

631
00:24:27,000 --> 00:24:33,790
finally we can use essentially the same

632
00:24:31,750 --> 00:24:35,380
thing as counting the number of grouping

633
00:24:33,790 --> 00:24:37,810
it by the level three and then counting

634
00:24:35,380 --> 00:24:39,310
its number of times it occurs is we can

635
00:24:37,810 --> 00:24:41,020
calculate and a help degree basically

636
00:24:39,310 --> 00:24:42,580
looking at this as a tree and we'll show

637
00:24:41,020 --> 00:24:44,379
you an alternative way of looking at

638
00:24:42,580 --> 00:24:48,879
this at the very end where we talked

639
00:24:44,380 --> 00:24:50,740
said intersections so again the level

640
00:24:48,880 --> 00:24:52,270
threes caused us to drill there number

641
00:24:50,740 --> 00:24:53,710
of children which is indicated by out

642
00:24:52,270 --> 00:24:56,260
decree causes to drill in on things that

643
00:24:53,710 --> 00:25:05,400
are suspicious Lenovo pops up again and

644
00:24:56,260 --> 00:25:10,840
other things as well finally

645
00:25:05,400 --> 00:25:14,440
unregistered this one's fun so there are

646
00:25:10,840 --> 00:25:16,689
a set amount of pre registered HTTP

647
00:25:14,440 --> 00:25:18,160
methods and we can go Dianna we could

648
00:25:16,690 --> 00:25:20,290
pull them down and say what are they and

649
00:25:18,160 --> 00:25:21,970
then we can very easily go to the HTTP

650
00:25:20,290 --> 00:25:23,470
log look at the HTTP method and be like

651
00:25:21,970 --> 00:25:25,270
if it's not in this list

652
00:25:23,470 --> 00:25:26,920
filter it out so we're gonna start by

653
00:25:25,270 --> 00:25:30,850
stacking it as normal we see that get

654
00:25:26,920 --> 00:25:32,290
dominates followed shortly by post and

655
00:25:30,850 --> 00:25:34,990
we expect to see that because we've all

656
00:25:32,290 --> 00:25:37,149
read a TCP stream for an HTTP connection

657
00:25:34,990 --> 00:25:38,890
in Wireshark and then we continue

658
00:25:37,150 --> 00:25:40,870
reading down and we're less familiar

659
00:25:38,890 --> 00:25:43,900
with these pretty sure that's not in the

660
00:25:40,870 --> 00:25:45,370
IANA definition but maybe maybe these

661
00:25:43,900 --> 00:25:47,970
are we'll go back and double-check it

662
00:25:45,370 --> 00:25:51,610
and then we get down or like necess

663
00:25:47,970 --> 00:25:54,700
that's a that's a bone scanner that's

664
00:25:51,610 --> 00:25:56,280
not an HTTP method and so this starts to

665
00:25:54,700 --> 00:25:58,780
jump out very very quickly

666
00:25:56,280 --> 00:26:03,070
so go through and sort it out based on

667
00:25:58,780 --> 00:26:05,560
the exclamation point star and we're

668
00:26:03,070 --> 00:26:08,320
starting to zero in on two weird traffic

669
00:26:05,560 --> 00:26:10,810
that way go ahead and build it out pull

670
00:26:08,320 --> 00:26:13,540
it down on prop find also starts to

671
00:26:10,810 --> 00:26:15,730
indicating malicious IPs and we should

672
00:26:13,540 --> 00:26:17,440
see an overlap between if we were to go

673
00:26:15,730 --> 00:26:19,060
back and resolve shark lasers and cyber

674
00:26:17,440 --> 00:26:22,390
mugging we'll see an overlap between

675
00:26:19,060 --> 00:26:25,620
their the IPS in the DNS table and what

676
00:26:22,390 --> 00:26:25,620
we're looking at and gone right now

677
00:26:26,750 --> 00:26:31,370
finally we can mush this all together

678
00:26:28,490 --> 00:26:32,929
and hunt based on that so we have across

679
00:26:31,370 --> 00:26:35,780
the top the method the number of times

680
00:26:32,929 --> 00:26:39,380
that an originating host use that method

681
00:26:35,780 --> 00:26:40,940
and we can see again that you head get

682
00:26:39,380 --> 00:26:44,140
and posts are going to dominate this and

683
00:26:40,940 --> 00:26:44,140
we're gonna have some weird outliers

684
00:26:54,430 --> 00:26:59,740
right back in traffic artifacts looking

685
00:26:57,790 --> 00:27:01,780
at methods all right consistency

686
00:26:59,740 --> 00:27:03,310
analysis so this is when we start

687
00:27:01,780 --> 00:27:05,830
getting into a little more the heavy

688
00:27:03,310 --> 00:27:07,600
data science so look across we can build

689
00:27:05,830 --> 00:27:10,810
what's called a consistency table which

690
00:27:07,600 --> 00:27:12,370
is going to give us an idea almost

691
00:27:10,810 --> 00:27:14,679
essentially the same thing as a pivot

692
00:27:12,370 --> 00:27:16,209
table for those familiar with Excel we

693
00:27:14,680 --> 00:27:18,670
can walk across it and see very very

694
00:27:16,210 --> 00:27:22,060
quickly a summary of the data how things

695
00:27:18,670 --> 00:27:24,160
like so sorry how many times is it

696
00:27:22,060 --> 00:27:26,830
connected get post etc and then we can

697
00:27:24,160 --> 00:27:29,020
calculate a ratio very quickly with this

698
00:27:26,830 --> 00:27:33,000
the same time so we can see so sorry

699
00:27:29,020 --> 00:27:36,250
jumps again then we have a hammer doc a

700
00:27:33,000 --> 00:27:38,920
IP address without a domain name and

701
00:27:36,250 --> 00:27:40,600
then MTG which in my head is Magic the

702
00:27:38,920 --> 00:27:47,710
Gathering but it's probably meeting.com

703
00:27:40,600 --> 00:27:49,510
or something leave al artifacts we

704
00:27:47,710 --> 00:27:53,800
already talked through and then we get

705
00:27:49,510 --> 00:27:55,000
to the fun part in Richmond so for

706
00:27:53,800 --> 00:27:57,010
enrichment it's important to realize

707
00:27:55,000 --> 00:27:59,800
there are a whole lot of free data

708
00:27:57,010 --> 00:28:01,420
sources out there that can get you

709
00:27:59,800 --> 00:28:03,730
really far where you want to go we want

710
00:28:01,420 --> 00:28:05,230
to show you two today and talk through a

711
00:28:03,730 --> 00:28:07,210
couple other ones we're gonna talk about

712
00:28:05,230 --> 00:28:09,430
publicly available who is there are a

713
00:28:07,210 --> 00:28:11,680
lot of Whois services that have RESTful

714
00:28:09,430 --> 00:28:14,200
API so you can query APNIC is one of

715
00:28:11,680 --> 00:28:16,720
them after net queries others so it's a

716
00:28:14,200 --> 00:28:18,100
really reliable one to use and then

717
00:28:16,720 --> 00:28:20,080
showdown of course everyone's heard of

718
00:28:18,100 --> 00:28:23,199
virustotal also as an API you can get a

719
00:28:20,080 --> 00:28:25,540
free version and then you can also look

720
00:28:23,200 --> 00:28:27,280
at things like emerging threats and pull

721
00:28:25,540 --> 00:28:30,270
down rules into Richmond from there as

722
00:28:27,280 --> 00:28:34,480
well with a little bit of creativity

723
00:28:30,270 --> 00:28:36,370
some of these like showdown which have

724
00:28:34,480 --> 00:28:38,440
an API library so we'll start with pan

725
00:28:36,370 --> 00:28:40,030
doesn't show it in and then we'll use

726
00:28:38,440 --> 00:28:41,410
the request library to actually go

727
00:28:40,030 --> 00:28:43,660
through and for every IP that we've

728
00:28:41,410 --> 00:28:45,940
observed we can then pull down its name

729
00:28:43,660 --> 00:28:49,030
country starting address ending address

730
00:28:45,940 --> 00:28:50,590
and some entries have an organ 'm that's

731
00:28:49,030 --> 00:28:52,840
not as consistent and Whois information

732
00:28:50,590 --> 00:28:55,360
but a lot of times your network name

733
00:28:52,840 --> 00:28:57,100
which is the name field will imply an

734
00:28:55,360 --> 00:29:00,490
organizational name and the street

735
00:28:57,100 --> 00:29:02,169
address will as well so then we can

736
00:29:00,490 --> 00:29:04,330
actually pull this into a data frame and

737
00:29:02,170 --> 00:29:06,520
look at it that way and if we wanted to

738
00:29:04,330 --> 00:29:07,870
we could then go back and stack by if we

739
00:29:06,520 --> 00:29:11,350
thought the country was act

740
00:29:07,870 --> 00:29:13,809
a good indicator which it's not look

741
00:29:11,350 --> 00:29:15,219
that way so let me rephrase that country

742
00:29:13,809 --> 00:29:16,899
is a good indicator when your traffic

743
00:29:15,220 --> 00:29:20,800
consistently comes from a well-defined

744
00:29:16,900 --> 00:29:23,110
region if I have a web server in Texas

745
00:29:20,800 --> 00:29:25,210
that only gets traffic from Texas

746
00:29:23,110 --> 00:29:26,830
normally and then suddenly Florida man

747
00:29:25,210 --> 00:29:29,590
hits me that's weird

748
00:29:26,830 --> 00:29:32,350
most web servers don't have that easy

749
00:29:29,590 --> 00:29:33,909
use case though most web servers have

750
00:29:32,350 --> 00:29:35,860
traffic from all over the world and so

751
00:29:33,910 --> 00:29:38,950
geographic location doesn't really

752
00:29:35,860 --> 00:29:40,689
matter we also know that apts and script

753
00:29:38,950 --> 00:29:42,730
kiddies don't always come from their

754
00:29:40,690 --> 00:29:44,410
home so if I'm concerned about Chinese

755
00:29:42,730 --> 00:29:46,960
hacker or Russian hacker and I see a

756
00:29:44,410 --> 00:29:48,820
Russian IP that doesn't actually imply

757
00:29:46,960 --> 00:29:51,190
that that IP is in Russia we all know

758
00:29:48,820 --> 00:29:52,689
how easy it is to spoof that as well as

759
00:29:51,190 --> 00:29:55,720
how to route through something for free

760
00:29:52,690 --> 00:29:57,250
to anonymize it such as tor or you name

761
00:29:55,720 --> 00:29:59,940
the man-in-the-middle as a service that

762
00:29:57,250 --> 00:30:02,800
you want to purchase for your VPN

763
00:29:59,940 --> 00:30:04,030
showdown showdown has a rate limit for

764
00:30:02,800 --> 00:30:06,850
your five dollar version that you can

765
00:30:04,030 --> 00:30:08,260
buy once a year so we'll show you what

766
00:30:06,850 --> 00:30:10,000
some of the results look like but you

767
00:30:08,260 --> 00:30:13,450
can on the version I have you can limit

768
00:30:10,000 --> 00:30:15,790
500 requests a month which is a little

769
00:30:13,450 --> 00:30:17,500
inconvenient for this so if I run for

770
00:30:15,790 --> 00:30:19,270
information on quad ones which is

771
00:30:17,500 --> 00:30:21,790
CloudFlare I get that really rich

772
00:30:19,270 --> 00:30:23,710
information in JSON pre formatted and

773
00:30:21,790 --> 00:30:25,960
JSON I'm actually going to get a list of

774
00:30:23,710 --> 00:30:28,300
matches to that IP and then the second

775
00:30:25,960 --> 00:30:29,890
field in this will actually be a field

776
00:30:28,300 --> 00:30:31,600
that describes the number of matches I

777
00:30:29,890 --> 00:30:34,660
got and then you can see in here that I

778
00:30:31,600 --> 00:30:37,209
also have product information so it's

779
00:30:34,660 --> 00:30:38,559
running an Apache server to get versions

780
00:30:37,210 --> 00:30:40,900
from it without having to interact with

781
00:30:38,559 --> 00:30:47,620
it and then the juicy stuff which is all

782
00:30:40,900 --> 00:30:48,910
the bowls so this helps me understand as

783
00:30:47,620 --> 00:30:50,949
I'm enriching the things that my

784
00:30:48,910 --> 00:30:52,809
environment is talking to if I'm talking

785
00:30:50,950 --> 00:30:54,700
to something on port 80 and then I pull

786
00:30:52,809 --> 00:30:56,260
information back from showdown and it

787
00:30:54,700 --> 00:30:58,450
hasn't seen something on port 80 that's

788
00:30:56,260 --> 00:31:00,490
a little weird that's almost never going

789
00:30:58,450 --> 00:31:03,220
to happen because showed endows and get

790
00:31:00,490 --> 00:31:04,630
blacklisted that often but when I start

791
00:31:03,220 --> 00:31:06,220
to see a mismatch between artifacts

792
00:31:04,630 --> 00:31:13,240
that's how I can start to zero in on on

793
00:31:06,220 --> 00:31:15,870
interesting activity all right go back

794
00:31:13,240 --> 00:31:18,160
through and view our techniques

795
00:31:15,870 --> 00:31:20,199
so I'm actually going to jump to one

796
00:31:18,160 --> 00:31:23,050
last experimental one so we talked about

797
00:31:20,200 --> 00:31:25,390
down here at the very bottom set

798
00:31:23,050 --> 00:31:27,460
operations and how they can provide us

799
00:31:25,390 --> 00:31:29,679
really simple things we can also learn a

800
00:31:27,460 --> 00:31:31,870
lot from Network statistics so we'll

801
00:31:29,679 --> 00:31:37,240
show you some of the work that we did at

802
00:31:31,870 --> 00:31:41,860
the very very end it's still a little

803
00:31:37,240 --> 00:31:43,570
rough alright so going back to pandas in

804
00:31:41,860 --> 00:31:45,550
this case in this example we're gonna

805
00:31:43,570 --> 00:31:47,020
use a library called Network X for those

806
00:31:45,550 --> 00:31:49,120
who have ever done graph theory with

807
00:31:47,020 --> 00:31:52,330
Python you know of Network X because

808
00:31:49,120 --> 00:31:53,739
it's your best friend first thing we're

809
00:31:52,330 --> 00:31:55,090
going to do is we're gonna stack our DNS

810
00:31:53,740 --> 00:31:56,710
queries again this is from a different

811
00:31:55,090 --> 00:32:01,209
data set than the one with shark lasers

812
00:31:56,710 --> 00:32:03,000
and we if we look at the bottom 15 we

813
00:32:01,210 --> 00:32:05,559
can see all these interesting ones

814
00:32:03,000 --> 00:32:08,020
including Bing which I'm kind of glad is

815
00:32:05,559 --> 00:32:09,730
at the bottom of this and then some

816
00:32:08,020 --> 00:32:11,590
weird like poorly defined Facebook stuff

817
00:32:09,730 --> 00:32:13,240
and whatnot but this isn't really

818
00:32:11,590 --> 00:32:15,309
telling me what I want to know without

819
00:32:13,240 --> 00:32:19,480
having to go back and start to Google

820
00:32:15,309 --> 00:32:21,820
individual ones so instead we're going

821
00:32:19,480 --> 00:32:24,190
to turn it into a graph or a tree by

822
00:32:21,820 --> 00:32:26,530
basically going through every query and

823
00:32:24,190 --> 00:32:28,480
I'm going to split every query into its

824
00:32:26,530 --> 00:32:31,090
from its top-level domain all the way

825
00:32:28,480 --> 00:32:32,320
down to its last sub domain I'm going to

826
00:32:31,090 --> 00:32:34,870
split it and I'm going to turn that into

827
00:32:32,320 --> 00:32:36,399
one trace through a tree and I'm going

828
00:32:34,870 --> 00:32:38,080
to do that multiple times I'm gonna keep

829
00:32:36,400 --> 00:32:40,420
track of the of the level that we saw

830
00:32:38,080 --> 00:32:42,189
that word at so if I see Google at level

831
00:32:40,420 --> 00:32:44,860
one and then I see it again at level

832
00:32:42,190 --> 00:32:46,540
five that's interesting when I reach my

833
00:32:44,860 --> 00:32:50,159
data because Google sort of like never

834
00:32:46,540 --> 00:32:50,159
show up at level five of this legitimate

835
00:32:51,300 --> 00:32:55,389
then network excellence me run one

836
00:32:53,770 --> 00:32:56,860
command to calculate out degree across

837
00:32:55,390 --> 00:32:58,780
all nodes of my network actually is

838
00:32:56,860 --> 00:33:00,330
pretty fast and then I can stack it

839
00:32:58,780 --> 00:33:04,059
based on that what I've done here

840
00:33:00,330 --> 00:33:06,520
actually this is the next slide so this

841
00:33:04,059 --> 00:33:09,370
shows us nothing when I stack it this

842
00:33:06,520 --> 00:33:11,710
way I immediately see that Co at level

843
00:33:09,370 --> 00:33:13,928
one which is probably a co dot uk'

844
00:33:11,710 --> 00:33:16,059
is dominating most of my queries and

845
00:33:13,929 --> 00:33:17,440
then Google at level one is as well so

846
00:33:16,059 --> 00:33:19,780
what I want to do then is go back

847
00:33:17,440 --> 00:33:22,270
through and take out all of the level

848
00:33:19,780 --> 00:33:24,309
zeros that I know about and all of the

849
00:33:22,270 --> 00:33:25,720
effective level zeros that I know about

850
00:33:24,309 --> 00:33:27,220
so that I can actually get towards

851
00:33:25,720 --> 00:33:28,960
something that may have a nonce later

852
00:33:27,220 --> 00:33:31,390
down in the chain

853
00:33:28,960 --> 00:33:33,130
once I do that and relook at it I then

854
00:33:31,390 --> 00:33:35,440
have stuff that I can actually look into

855
00:33:33,130 --> 00:33:39,460
SoCo somehow didn't get scraped out

856
00:33:35,440 --> 00:33:43,960
actually has the problem going to do it

857
00:33:39,460 --> 00:33:46,380
this way we were having a visuals

858
00:33:43,960 --> 00:33:46,380
problem

859
00:33:49,310 --> 00:33:57,560
so I run through and I prune it and then

860
00:33:53,360 --> 00:34:00,320
I can come up here rerun my outdegree

861
00:33:57,560 --> 00:34:05,360
calculation and visualize it and then we

862
00:34:00,320 --> 00:34:07,520
can see Kostal in there calm at level

863
00:34:05,360 --> 00:34:10,520
zero goes away but I've got a calm at

864
00:34:07,520 --> 00:34:12,050
level one and then Google if I was to

865
00:34:10,520 --> 00:34:14,418
have this in an actual responsive graph

866
00:34:12,050 --> 00:34:17,500
I would see that Google at level three

867
00:34:14,418 --> 00:34:20,210
are sorry at level two has 46 subdomains

868
00:34:17,500 --> 00:34:21,620
and so I can then repeat this process go

869
00:34:20,210 --> 00:34:23,389
through here and say okay I know that

870
00:34:21,620 --> 00:34:25,250
google.com has a lot of children and

871
00:34:23,389 --> 00:34:26,810
prune that out and then look for the

872
00:34:25,250 --> 00:34:29,570
next thing until I start to see

873
00:34:26,810 --> 00:34:31,340
something below level one and zero that

874
00:34:29,570 --> 00:34:33,290
has a lot of children and this is one of

875
00:34:31,340 --> 00:34:35,030
my ways that I can detect my nonces that

876
00:34:33,290 --> 00:34:38,529
aren't sitting at level four like our

877
00:34:35,030 --> 00:34:38,530
previous technique was relying on

878
00:34:42,940 --> 00:34:46,179
and finally we can use said

879
00:34:44,889 --> 00:34:47,950
intersections to do some really

880
00:34:46,179 --> 00:34:49,149
interesting things there's a concept

881
00:34:47,949 --> 00:34:50,980
called orphan flows which is a

882
00:34:49,149 --> 00:34:53,168
communication to an IP that wasn't

883
00:34:50,980 --> 00:34:55,029
preceded by a DNS lookup anything

884
00:34:53,168 --> 00:34:58,029
crossing your boundary is most likely

885
00:34:55,029 --> 00:35:00,609
going to have a DNS lookup before it has

886
00:34:58,029 --> 00:35:02,890
an IP communication or sorry a TCP

887
00:35:00,609 --> 00:35:04,359
communication following it so very very

888
00:35:02,890 --> 00:35:08,710
simply we're gonna pull out our unique

889
00:35:04,359 --> 00:35:10,720
destinations and our unique yeah our

890
00:35:08,710 --> 00:35:13,089
unique answers from our DNS log so

891
00:35:10,720 --> 00:35:14,828
basically I've made a DNS request I got

892
00:35:13,089 --> 00:35:17,049
an answer back I'm gonna compare that to

893
00:35:14,829 --> 00:35:19,150
my destinations so things I actually

894
00:35:17,049 --> 00:35:22,059
went to a set of things I actually went

895
00:35:19,150 --> 00:35:25,390
to - the set so the set difference of

896
00:35:22,059 --> 00:35:27,099
things that I requested and that gives

897
00:35:25,390 --> 00:35:29,288
me a list of orphan sessions and without

898
00:35:27,099 --> 00:35:33,339
displaying all of them in this data set

899
00:35:29,289 --> 00:35:36,730
I have 756 net flows out of my network

900
00:35:33,339 --> 00:35:39,220
that were not preceded by DNS and that's

901
00:35:36,730 --> 00:35:40,539
a lot of stuff to go through ideally

902
00:35:39,220 --> 00:35:42,308
this should not be happening in your

903
00:35:40,539 --> 00:35:44,319
network as much as this this is pcap for

904
00:35:42,309 --> 00:35:46,000
malware run so it's a little abnormal

905
00:35:44,319 --> 00:35:48,069
and you'd need to dig through all that

906
00:35:46,000 --> 00:35:52,049
because a lot of low hanging fruit situ

907
00:35:48,069 --> 00:35:54,430
exists in this in this orphaned section

908
00:35:52,049 --> 00:35:56,349
alternatively I can look for DNS that's

909
00:35:54,430 --> 00:35:57,910
not followed up by a TCP request which

910
00:35:56,349 --> 00:36:00,819
is also interesting because that might

911
00:35:57,910 --> 00:36:01,899
show me DNS see - so again with a simple

912
00:36:00,819 --> 00:36:03,910
set intersection a little bit of

913
00:36:01,900 --> 00:36:06,579
creativity with Venn diagrams I can be

914
00:36:03,910 --> 00:36:08,410
like okay let me look at all of the IPS

915
00:36:06,579 --> 00:36:09,549
that I got in response and then see

916
00:36:08,410 --> 00:36:11,980
which ones I got in response that I

917
00:36:09,549 --> 00:36:15,700
didn't then go dig into and in this case

918
00:36:11,980 --> 00:36:17,890
I have 2770 this this particular

919
00:36:15,700 --> 00:36:20,618
technique requires a little more pruning

920
00:36:17,890 --> 00:36:22,538
- dialing in on something truly useful

921
00:36:20,619 --> 00:36:23,859
because if you've ever studied DNS

922
00:36:22,539 --> 00:36:25,930
traffic you'll see that sometimes you

923
00:36:23,859 --> 00:36:28,420
get four or five ip's back with one

924
00:36:25,930 --> 00:36:30,940
request and you need to then go through

925
00:36:28,420 --> 00:36:33,519
that and find did this request generate

926
00:36:30,940 --> 00:36:34,869
a response but off-the-cuff we can

927
00:36:33,519 --> 00:36:37,569
already start addressing that problem

928
00:36:34,869 --> 00:36:39,369
with a very very simple math calculation

929
00:36:37,569 --> 00:36:42,359
that takes us a long way towards

930
00:36:39,369 --> 00:36:42,359
understanding what's going on

931
00:36:48,280 --> 00:36:53,630
all right so in conclusion we've got

932
00:36:50,570 --> 00:36:55,250
aggregation summary statistics across

933
00:36:53,630 --> 00:36:58,460
the network understanding beam mode

934
00:36:55,250 --> 00:36:59,780
median visualization caution on

935
00:36:58,460 --> 00:37:01,130
visualization you should never go there

936
00:36:59,780 --> 00:37:03,380
first unless you're doing a presentation

937
00:37:01,130 --> 00:37:05,030
because your visuals are going to

938
00:37:03,380 --> 00:37:07,550
distract your understanding of the

939
00:37:05,030 --> 00:37:09,890
numbers it creates the anchoring bias

940
00:37:07,550 --> 00:37:11,930
based on big shiny pictures and you may

941
00:37:09,890 --> 00:37:14,120
not actually see the significant whereas

942
00:37:11,930 --> 00:37:15,649
the numbers are less inclined to do that

943
00:37:14,120 --> 00:37:17,600
to you especially if you're looking them

944
00:37:15,650 --> 00:37:19,850
with just looking at them with

945
00:37:17,600 --> 00:37:22,580
descriptive statistics and then

946
00:37:19,850 --> 00:37:25,130
enrichment add data to it we showed you

947
00:37:22,580 --> 00:37:26,120
showed in and apnic in this case would

948
00:37:25,130 --> 00:37:28,100
encourage you to look at emerging

949
00:37:26,120 --> 00:37:29,930
threats as well and then processing

950
00:37:28,100 --> 00:37:32,180
transforming it into different forms so

951
00:37:29,930 --> 00:37:33,379
that we can learn more and then finally

952
00:37:32,180 --> 00:37:36,970
learning analytics which we don't

953
00:37:33,380 --> 00:37:36,970
demonstrate at all in this presentation

954
00:37:37,120 --> 00:37:43,490
some insights and future work so again

955
00:37:41,000 --> 00:37:45,710
don't go complex when simple will work

956
00:37:43,490 --> 00:37:48,259
almost everything in here with a little

957
00:37:45,710 --> 00:37:50,300
bit of creativity and a couple coffees

958
00:37:48,260 --> 00:37:53,360
with Brian truckle would turn into a

959
00:37:50,300 --> 00:37:55,430
dashboard if you wanted it to you don't

960
00:37:53,360 --> 00:37:56,140
necessarily need a random forest to make

961
00:37:55,430 --> 00:37:58,640
a decision

962
00:37:56,140 --> 00:38:00,200
some unguided decision on your network

963
00:37:58,640 --> 00:38:01,580
to tell you this is bad when you can

964
00:38:00,200 --> 00:38:03,710
just stack a look a couple things

965
00:38:01,580 --> 00:38:06,620
compared to some thread in tel-aviv this

966
00:38:03,710 --> 00:38:08,270
is bad right here if you want to get

967
00:38:06,620 --> 00:38:10,700
after things that are uniquely signature

968
00:38:08,270 --> 00:38:13,610
Dan our complex to chase after have to

969
00:38:10,700 --> 00:38:14,870
lock down the simple first or threats

970
00:38:13,610 --> 00:38:16,010
will ride through the simple while

971
00:38:14,870 --> 00:38:17,109
you're busy looking for them in the

972
00:38:16,010 --> 00:38:19,370
complex

973
00:38:17,110 --> 00:38:20,810
be careful applying machine learning

974
00:38:19,370 --> 00:38:22,640
we've beat that one to death don't go

975
00:38:20,810 --> 00:38:26,210
down visualizations unless you can

976
00:38:22,640 --> 00:38:28,069
manage it yeah numbers don't lie they

977
00:38:26,210 --> 00:38:30,620
also easier to press visuals take up

978
00:38:28,070 --> 00:38:32,210
lots of space and then finally on any

979
00:38:30,620 --> 00:38:34,190
data science discussion when it comes to

980
00:38:32,210 --> 00:38:35,570
overlapping with security we have to

981
00:38:34,190 --> 00:38:37,820
talk about something called base rate

982
00:38:35,570 --> 00:38:39,650
fallacy those statisticians in the room

983
00:38:37,820 --> 00:38:41,690
you're familiar with the concept of base

984
00:38:39,650 --> 00:38:43,520
rate fallacy and how it basically tells

985
00:38:41,690 --> 00:38:45,320
me that when I look at the number that

986
00:38:43,520 --> 00:38:48,110
says that I only have 0.1% false

987
00:38:45,320 --> 00:38:50,420
positive rate that's misleading because

988
00:38:48,110 --> 00:38:54,230
I incur to the point one but when I have

989
00:38:50,420 --> 00:38:57,590
a list of positives that's 1 million

990
00:38:54,230 --> 00:38:58,880
long that turns into let's see as what

991
00:38:57,590 --> 00:39:01,069
hundred times 10

992
00:38:58,880 --> 00:39:02,960
hundred times that's substantially

993
00:39:01,069 --> 00:39:04,940
longer than any of my analyst can

994
00:39:02,960 --> 00:39:07,099
actually get through in a single day so

995
00:39:04,940 --> 00:39:08,569
we really when it comes to data science

996
00:39:07,099 --> 00:39:09,950
and computer security we want to be

997
00:39:08,569 --> 00:39:12,170
shooting for a false positive rate of

998
00:39:09,950 --> 00:39:14,990
zero because your point ones and your

999
00:39:12,170 --> 00:39:16,640
point fives turn into massive list that

1000
00:39:14,990 --> 00:39:19,220
your sake analyst after triage negative

1001
00:39:16,640 --> 00:39:21,589
time future work we want to migrate the

1002
00:39:19,220 --> 00:39:23,538
code into from its private repo into a

1003
00:39:21,589 --> 00:39:25,009
public repo organize it a little bit

1004
00:39:23,539 --> 00:39:26,869
better than it is in this presentation

1005
00:39:25,009 --> 00:39:29,980
and we've got a lot to do with inter

1006
00:39:26,869 --> 00:39:32,059
arrival time and we've just summarized

1007
00:39:29,980 --> 00:39:34,460
so I'm actually coming in a little ahead

1008
00:39:32,059 --> 00:39:35,809
of time based on what I thought and

1009
00:39:34,460 --> 00:39:39,759
we'll open it up for questions at this

1010
00:39:35,809 --> 00:39:39,759
point anything

1011
00:39:50,540 --> 00:40:03,779
[Applause]

1012
00:40:00,530 --> 00:40:06,720
yes so all of the code in the repo has

1013
00:40:03,780 --> 00:40:08,880
been done in notebooks so when we post

1014
00:40:06,720 --> 00:40:10,770
the repo you'll get all of the notebooks

1015
00:40:08,880 --> 00:40:12,270
all the documentation with it we've got

1016
00:40:10,770 --> 00:40:15,589
to scrub it for a couple things like my

1017
00:40:12,270 --> 00:40:18,839
showed an API key before we push it up

1018
00:40:15,589 --> 00:40:21,420
yeah right best practices I work in

1019
00:40:18,839 --> 00:40:23,400
computer security I know better so

1020
00:40:21,420 --> 00:40:24,390
everything will be in notebooks and

1021
00:40:23,400 --> 00:40:26,069
you'll have the version of the

1022
00:40:24,390 --> 00:40:28,288
presentation which you can visualize as

1023
00:40:26,069 --> 00:40:34,190
well as all of the little notebooks to

1024
00:40:28,289 --> 00:40:34,190
walk you through the analysis yes sir

1025
00:40:34,609 --> 00:40:39,990
it's free that's that's my primary thing

1026
00:40:38,579 --> 00:40:41,400
that I like about it it's free and it's

1027
00:40:39,990 --> 00:40:44,270
useful and with a little bit of tuning

1028
00:40:41,400 --> 00:40:44,270
it can be really useful

1029
00:40:49,490 --> 00:40:59,618
that was emerging trends we're talking

1030
00:40:51,349 --> 00:40:59,619
emerging threats okay cool

