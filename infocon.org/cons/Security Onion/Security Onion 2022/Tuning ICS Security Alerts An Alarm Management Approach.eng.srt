1
00:00:07,940 --> 00:00:10,380
thank you thank you

2
00:00:10,380 --> 00:00:13,740
all right thanks for coming and uh

3
00:00:13,740 --> 00:00:15,599
thanks for staying awake after that

4
00:00:15,599 --> 00:00:18,300
wonderful lunch uh I'm going to try not

5
00:00:18,300 --> 00:00:20,460
to talk like Ben Stein

6
00:00:20,460 --> 00:00:23,340
this is a pcap

7
00:00:23,340 --> 00:00:27,119
well I'm on it says I'm on do I need to

8
00:00:27,119 --> 00:00:29,539
speak louder

9
00:00:31,199 --> 00:00:33,960
okay now there we go all right let me

10
00:00:33,960 --> 00:00:36,180
start over thanks for coming and uh

11
00:00:36,180 --> 00:00:37,739
thanks for being here after lunch that

12
00:00:37,739 --> 00:00:40,800
was a wonderful uh barbecue lunch right

13
00:00:40,800 --> 00:00:42,840
and how everybody's gonna do napcon

14
00:00:42,840 --> 00:00:44,760
right now so especially if I start

15
00:00:44,760 --> 00:00:47,340
talking like Ben Stein you know this is

16
00:00:47,340 --> 00:00:49,140
a p camp

17
00:00:49,140 --> 00:00:51,539
and it's really comfortable

18
00:00:51,539 --> 00:00:53,760
and it's really no I'm not going to put

19
00:00:53,760 --> 00:00:55,199
you all to sleep

20
00:00:55,199 --> 00:00:57,239
uh what I'm going to talk about today is

21
00:00:57,239 --> 00:01:00,300
tuning ICS security alerts

22
00:01:00,300 --> 00:01:02,760
an alarm management approach

23
00:01:02,760 --> 00:01:04,979
my name is Chris sistron technical

24
00:01:04,979 --> 00:01:08,460
manager with ICS team at mandiant and

25
00:01:08,460 --> 00:01:11,820
I've been here almost uh

26
00:01:11,820 --> 00:01:14,760
nine years so and now Mandy it was

27
00:01:14,760 --> 00:01:15,960
bought

28
00:01:15,960 --> 00:01:18,840
recently by Google so I'm going to be

29
00:01:18,840 --> 00:01:21,119
getting one of these hats pretty soon I

30
00:01:21,119 --> 00:01:22,560
think I'm going to try to put the

31
00:01:22,560 --> 00:01:24,299
propeller on my hard hat

32
00:01:24,299 --> 00:01:27,299
um before before Mandy and I worked for

33
00:01:27,299 --> 00:01:29,340
a power company in the South called

34
00:01:29,340 --> 00:01:33,360
Entergy I worked there as a as a power

35
00:01:33,360 --> 00:01:37,500
engineer skate engineer for almost 12

36
00:01:37,500 --> 00:01:40,619
years I founded and ran besides Jackson

37
00:01:40,619 --> 00:01:43,200
in Mississippi for about six years

38
00:01:43,200 --> 00:01:46,140
co-founded the beer eye sack which is uh

39
00:01:46,140 --> 00:01:48,360
the best ice act and we're going to have

40
00:01:48,360 --> 00:01:50,220
beer Isaac later you know after the

41
00:01:50,220 --> 00:01:52,140
conference everybody goes and does that

42
00:01:52,140 --> 00:01:53,960
you know get together

43
00:01:53,960 --> 00:01:57,659
and the founder of napcon and dad jokes

44
00:01:57,659 --> 00:02:00,720
as a service uh

45
00:02:00,720 --> 00:02:03,600
quick uh I love the the dad jokes

46
00:02:03,600 --> 00:02:05,520
earlier uh

47
00:02:05,520 --> 00:02:06,299
um

48
00:02:06,299 --> 00:02:09,300
I'll tell one dad joke and then we'll go

49
00:02:09,300 --> 00:02:13,800
uh keep going uh how did the criminal

50
00:02:13,800 --> 00:02:17,040
cyber criminal escape the police

51
00:02:17,040 --> 00:02:20,120
he ran somewhere

52
00:02:21,840 --> 00:02:24,900
all right so so with this uh you know

53
00:02:24,900 --> 00:02:27,300
you know got some Mandy and alumni in

54
00:02:27,300 --> 00:02:29,340
the front row over here and over here we

55
00:02:29,340 --> 00:02:33,599
got some Indian alumni uh

56
00:02:35,000 --> 00:02:37,739
what's going to happen is it's like we

57
00:02:37,739 --> 00:02:39,599
became FireEye and then nope it's always

58
00:02:39,599 --> 00:02:43,319
been Mandy now so

59
00:02:43,319 --> 00:02:46,560
all right so about the talk uh threats

60
00:02:46,560 --> 00:02:48,720
and risks aren't going away so they're

61
00:02:48,720 --> 00:02:51,480
going to guide and direct our detection

62
00:02:51,480 --> 00:02:54,239
and response goals you all know this how

63
00:02:54,239 --> 00:02:57,420
many of you here have control systems at

64
00:02:57,420 --> 00:03:01,800
your company or in your day job

65
00:03:01,800 --> 00:03:05,700
a few hands okay you probably have them

66
00:03:05,700 --> 00:03:06,840
anyway

67
00:03:06,840 --> 00:03:08,640
just to keep this in mind if you have

68
00:03:08,640 --> 00:03:12,599
any building automation HVAC like data

69
00:03:12,599 --> 00:03:13,580
center

70
00:03:13,580 --> 00:03:16,560
AC you know for your data center we

71
00:03:16,560 --> 00:03:19,200
found those on the internet you know

72
00:03:19,200 --> 00:03:21,120
um you have control systems all around

73
00:03:21,120 --> 00:03:23,640
you so this is something that to keep

74
00:03:23,640 --> 00:03:26,220
that in mind or if you have customers or

75
00:03:26,220 --> 00:03:28,860
clients that have control systems this

76
00:03:28,860 --> 00:03:32,099
is going to help you because this is

77
00:03:32,099 --> 00:03:35,280
still an emerging field even though I

78
00:03:35,280 --> 00:03:37,879
talked about network security monitoring

79
00:03:37,879 --> 00:03:42,120
back in security onion conference back

80
00:03:42,120 --> 00:03:44,640
in 2015

81
00:03:44,640 --> 00:03:48,540
um it's still relatively new there's a

82
00:03:48,540 --> 00:03:50,819
lot of control systems out there that

83
00:03:50,819 --> 00:03:53,220
aren't monitored and so this is kind of

84
00:03:53,220 --> 00:03:56,400
a talk for those who or more advanced

85
00:03:56,400 --> 00:03:58,920
who have some monitoring capabilities

86
00:03:58,920 --> 00:04:01,560
may be bought one of the newer control

87
00:04:01,560 --> 00:04:03,540
system security network security

88
00:04:03,540 --> 00:04:06,599
monitoring products and put it in and

89
00:04:06,599 --> 00:04:08,580
now what do I do with it

90
00:04:08,580 --> 00:04:12,239
so the whole deal is is we need to have

91
00:04:12,239 --> 00:04:15,420
a way to engineer the system and have a

92
00:04:15,420 --> 00:04:18,660
philosophy around how we tune the

93
00:04:18,660 --> 00:04:20,100
security alerts

94
00:04:20,100 --> 00:04:23,280
that's coming in and so I like to call

95
00:04:23,280 --> 00:04:26,940
this security alert engineering or as

96
00:04:26,940 --> 00:04:28,080
Chris

97
00:04:28,080 --> 00:04:31,440
and folks here call it detection

98
00:04:31,440 --> 00:04:33,540
engineering right

99
00:04:33,540 --> 00:04:35,040
um Josh

100
00:04:35,040 --> 00:04:39,300
yeah and uh we want to call this is very

101
00:04:39,300 --> 00:04:42,540
similar to how control system alarms are

102
00:04:42,540 --> 00:04:43,560
tuned

103
00:04:43,560 --> 00:04:45,300
and we're going to talk about two

104
00:04:45,300 --> 00:04:47,699
standards that exist out there this may

105
00:04:47,699 --> 00:04:50,280
not make any sense to you but this is

106
00:04:50,280 --> 00:04:51,840
we're not Reinventing the wheel here

107
00:04:51,840 --> 00:04:54,660
tuning is not new by any means and if

108
00:04:54,660 --> 00:04:57,180
you talk to control systems engineer

109
00:04:57,180 --> 00:04:58,620
they'll go oh yeah I know what tuning is

110
00:04:58,620 --> 00:05:00,440
we have to do that whenever we

111
00:05:00,440 --> 00:05:04,620
commission a new control system

112
00:05:04,620 --> 00:05:06,540
and then we'll tie that back to like the

113
00:05:06,540 --> 00:05:08,400
nist standards and security onion best

114
00:05:08,400 --> 00:05:10,620
practices of tuning your system

115
00:05:10,620 --> 00:05:12,000
and then lastly we'll talk about

116
00:05:12,000 --> 00:05:13,800
response and a little bit about

117
00:05:13,800 --> 00:05:15,419
playbooks

118
00:05:15,419 --> 00:05:18,960
and such so there's some really great

119
00:05:18,960 --> 00:05:21,780
content around Control Systems security

120
00:05:21,780 --> 00:05:24,539
engineering it's a emerging field even

121
00:05:24,539 --> 00:05:27,539
for our group so there's some

122
00:05:27,539 --> 00:05:30,479
OT security blueprints from Sarah flukes

123
00:05:30,479 --> 00:05:34,320
from Germany and a couple years ago at

124
00:05:34,320 --> 00:05:37,020
S4 is one of the probably the the

125
00:05:37,020 --> 00:05:39,539
control system security conference to to

126
00:05:39,539 --> 00:05:43,500
go to there's this birth of

127
00:05:43,500 --> 00:05:46,800
secure coding practices for plcs most of

128
00:05:46,800 --> 00:05:48,960
the time they don't have any security or

129
00:05:48,960 --> 00:05:51,240
if they do it's not enabled by default

130
00:05:51,240 --> 00:05:53,160
so there's a lot of cool things that

131
00:05:53,160 --> 00:05:55,320
that whole team has come up with Jake

132
00:05:55,320 --> 00:05:57,960
Brodsky Sarah Vivek Dale Peterson and

133
00:05:57,960 --> 00:06:01,919
more and then recently also born out of

134
00:06:01,919 --> 00:06:03,979
S4 was this

135
00:06:03,979 --> 00:06:07,860
idea of incident command system ICS

136
00:06:07,860 --> 00:06:11,880
which is like Nema if you have any Nema

137
00:06:11,880 --> 00:06:14,940
or incident command folks we're

138
00:06:14,940 --> 00:06:17,100
following that same process but for

139
00:06:17,100 --> 00:06:18,419
doing incident response and control

140
00:06:18,419 --> 00:06:21,360
system environments called ics for ICS

141
00:06:21,360 --> 00:06:23,460
so that's a little plug about the stuff

142
00:06:23,460 --> 00:06:25,380
that we're working on in control system

143
00:06:25,380 --> 00:06:27,800
security

144
00:06:28,500 --> 00:06:31,620
basically the Crux is know your systems

145
00:06:31,620 --> 00:06:33,840
and you all know this if you don't know

146
00:06:33,840 --> 00:06:37,080
your system you can't defend it how does

147
00:06:37,080 --> 00:06:38,880
my system work what are my threats and

148
00:06:38,880 --> 00:06:41,280
risk do I have enough visibility do I

149
00:06:41,280 --> 00:06:43,500
practice my plans and we've had a lot of

150
00:06:43,500 --> 00:06:45,300
great talks today about all of these

151
00:06:45,300 --> 00:06:48,780
things especially at visibility and how

152
00:06:48,780 --> 00:06:51,120
how things work how could it be used

153
00:06:51,120 --> 00:06:53,520
against us how do we find evil

154
00:06:53,520 --> 00:06:55,740
so here's the problem statement there's

155
00:06:55,740 --> 00:06:57,539
little published about Control Systems

156
00:06:57,539 --> 00:07:00,240
security alert management asset owners

157
00:07:00,240 --> 00:07:02,160
have to learn things by doing that the

158
00:07:02,160 --> 00:07:04,380
hard way and there's really no guide

159
00:07:04,380 --> 00:07:05,539
about it

160
00:07:05,539 --> 00:07:08,940
even still even the manuals for these

161
00:07:08,940 --> 00:07:10,740
network security monitoring sensors

162
00:07:10,740 --> 00:07:14,039
don't have a whole lot in their manuals

163
00:07:14,039 --> 00:07:16,500
about how to tune the system

164
00:07:16,500 --> 00:07:18,440
so the theory is

165
00:07:18,440 --> 00:07:22,380
ICS alarm management like for like a

166
00:07:22,380 --> 00:07:25,680
Siemens system or an Emerson or a GE or

167
00:07:25,680 --> 00:07:29,039
whoever those systems have very well

168
00:07:29,039 --> 00:07:32,340
defined tuning standards and there's

169
00:07:32,340 --> 00:07:34,380
even standards from the international

170
00:07:34,380 --> 00:07:36,780
Society of automation

171
00:07:36,780 --> 00:07:38,759
that's well defined and it's been talked

172
00:07:38,759 --> 00:07:40,919
about a long time it security alert

173
00:07:40,919 --> 00:07:42,660
management is pretty well defined I mean

174
00:07:42,660 --> 00:07:46,319
I remember back in 2015 there was that

175
00:07:46,319 --> 00:07:49,259
talk that talked about collating alerts

176
00:07:49,259 --> 00:07:51,120
where you don't get the same alert 50

177
00:07:51,120 --> 00:07:53,220
times you just get one alert and then

178
00:07:53,220 --> 00:07:55,620
you can just open it up and see the 50

179
00:07:55,620 --> 00:07:57,720
instances of that alert

180
00:07:57,720 --> 00:08:00,000
that's been well defined

181
00:08:00,000 --> 00:08:03,300
now we have to say I see as a security

182
00:08:03,300 --> 00:08:05,699
alert management must be engineered just

183
00:08:05,699 --> 00:08:08,400
like we engineer the control system we

184
00:08:08,400 --> 00:08:11,460
need to engineer the detection system so

185
00:08:11,460 --> 00:08:13,139
the solution is to create a reference

186
00:08:13,139 --> 00:08:14,340
that combines

187
00:08:14,340 --> 00:08:17,520
both Concepts to empower our security

188
00:08:17,520 --> 00:08:20,879
teams and asset owners

189
00:08:20,879 --> 00:08:23,580
so I like to talk about history you

190
00:08:23,580 --> 00:08:26,280
could probably get me talking about you

191
00:08:26,280 --> 00:08:29,879
know old you know glass insulators or

192
00:08:29,879 --> 00:08:32,159
old power lines you know the way things

193
00:08:32,159 --> 00:08:35,899
that were done serial ports and modems

194
00:08:35,899 --> 00:08:39,539
old laptops dial up you know all that

195
00:08:39,539 --> 00:08:42,059
stuff we've been doing this for a long

196
00:08:42,059 --> 00:08:42,979
time

197
00:08:42,979 --> 00:08:46,380
ICS network security monitoring is kind

198
00:08:46,380 --> 00:08:50,040
of the new hotness like Tesla is that

199
00:08:50,040 --> 00:08:51,600
everybody's got oh we got to get a

200
00:08:51,600 --> 00:08:53,760
electric vehicle um that's going to be

201
00:08:53,760 --> 00:08:56,399
great I saw the plug-ins in the the

202
00:08:56,399 --> 00:08:58,920
garage across the street this is really

203
00:08:58,920 --> 00:09:00,300
great

204
00:09:00,300 --> 00:09:03,180
um but it's not new

205
00:09:03,180 --> 00:09:04,500
um here's a

206
00:09:04,500 --> 00:09:07,860
page there's a whole 50 page section of

207
00:09:07,860 --> 00:09:10,260
the in standard handbook for electrical

208
00:09:10,260 --> 00:09:12,540
engineers and that's the fifth edition

209
00:09:12,540 --> 00:09:15,360
from 1922 that's a tweet from way long

210
00:09:15,360 --> 00:09:17,700
time ago they have a whole section on

211
00:09:17,700 --> 00:09:20,880
electric vehicles and then they have a

212
00:09:20,880 --> 00:09:23,940
whole nother section on electric uh

213
00:09:23,940 --> 00:09:26,279
street cars and electric trains and

214
00:09:26,279 --> 00:09:29,040
locomotives and there's a picture of one

215
00:09:29,040 --> 00:09:31,920
if you go in like Jay Leno's Garage he's

216
00:09:31,920 --> 00:09:34,320
got an electric vehicle you know that

217
00:09:34,320 --> 00:09:36,779
was from like 1915 or something like

218
00:09:36,779 --> 00:09:39,480
that so what was all this new again

219
00:09:39,480 --> 00:09:41,339
see where I'm going with this Engineers

220
00:09:41,339 --> 00:09:43,680
already know about how to do monitoring

221
00:09:43,680 --> 00:09:45,839
and I say control system Engineers

222
00:09:45,839 --> 00:09:47,940
electrical engineers mechanical

223
00:09:47,940 --> 00:09:49,019
engineers

224
00:09:49,019 --> 00:09:52,560
and all these this is something that's

225
00:09:52,560 --> 00:09:55,680
not new we've been monitoring processes

226
00:09:55,680 --> 00:09:58,680
to get an idea of how it the system

227
00:09:58,680 --> 00:10:00,600
works and how to improve it and what the

228
00:10:00,600 --> 00:10:03,000
root causes if something goes wrong so

229
00:10:03,000 --> 00:10:05,399
on the left there is a what we call a

230
00:10:05,399 --> 00:10:07,260
wig wag chart

231
00:10:07,260 --> 00:10:09,320
that's the nickname it's a recording

232
00:10:09,320 --> 00:10:12,480
meter and it has a little pin and it

233
00:10:12,480 --> 00:10:15,080
records something like

234
00:10:15,080 --> 00:10:18,060
volts or megawatts or something at a

235
00:10:18,060 --> 00:10:20,399
power substation over time but it can

236
00:10:20,399 --> 00:10:21,839
monitor temperature pressure anything

237
00:10:21,839 --> 00:10:24,959
like that the one on the right is down

238
00:10:24,959 --> 00:10:26,420
into the

239
00:10:26,420 --> 00:10:29,399
a-phase power for inside of a relay when

240
00:10:29,399 --> 00:10:31,560
there's a fault on a transmission line

241
00:10:31,560 --> 00:10:34,980
you can actually see when the voltage

242
00:10:34,980 --> 00:10:37,040
collapses and then when the current

243
00:10:37,040 --> 00:10:39,720
increases for just a few Cycles there

244
00:10:39,720 --> 00:10:42,180
and you can see the the phasor diagram

245
00:10:42,180 --> 00:10:45,120
of what's going on so we've been doing

246
00:10:45,120 --> 00:10:46,920
this kind of root cause analysis for

247
00:10:46,920 --> 00:10:48,060
quite a while

248
00:10:48,060 --> 00:10:50,160
here's the timeline go back all the way

249
00:10:50,160 --> 00:10:52,740
to 1839 Charles Babbage invented that

250
00:10:52,740 --> 00:10:55,140
chart recorder we talked about and doing

251
00:10:55,140 --> 00:10:57,120
monitoring on

252
00:10:57,120 --> 00:11:00,420
train Railways I uh they they headed on

253
00:11:00,420 --> 00:11:01,820
the back of a rail

254
00:11:01,820 --> 00:11:04,560
behind a locomotive

255
00:11:04,560 --> 00:11:07,500
we fast forward to what I'd like to talk

256
00:11:07,500 --> 00:11:09,899
about power grid that's my background of

257
00:11:09,899 --> 00:11:12,120
course three phase

258
00:11:12,120 --> 00:11:17,420
AC was in conceived around 1880s in 1888

259
00:11:17,420 --> 00:11:21,180
the Bristol chart recorder was invented

260
00:11:21,180 --> 00:11:22,980
just for the power system and that's the

261
00:11:22,980 --> 00:11:25,519
picture of the patent there on the left

262
00:11:25,519 --> 00:11:28,320
first scada systems were two wire

263
00:11:28,320 --> 00:11:32,279
telephone based and they had contacts to

264
00:11:32,279 --> 00:11:33,959
see when something was open or closed

265
00:11:33,959 --> 00:11:35,279
and then they could send a telephone

266
00:11:35,279 --> 00:11:38,339
relay to open or close think of like

267
00:11:38,339 --> 00:11:41,279
closing a breaker opening a breaker or

268
00:11:41,279 --> 00:11:43,680
like even on railroads they would do a

269
00:11:43,680 --> 00:11:46,320
switch change the switch on a track and

270
00:11:46,320 --> 00:11:48,360
that's a picture of one of those ones

271
00:11:48,360 --> 00:11:50,579
what it looks like

272
00:11:50,579 --> 00:11:53,120
if you fast forward to

273
00:11:53,120 --> 00:11:57,180
the 60s we have a lot more computers

274
00:11:57,180 --> 00:11:59,760
being there we have digital scada coming

275
00:11:59,760 --> 00:12:01,500
online and then we have the Northeast

276
00:12:01,500 --> 00:12:05,100
blackout boom something bad happens okay

277
00:12:05,100 --> 00:12:09,300
that really causes a revolution and when

278
00:12:09,300 --> 00:12:11,040
something bad happens safety rules are

279
00:12:11,040 --> 00:12:12,779
Written in Blood so now we have to go

280
00:12:12,779 --> 00:12:14,279
write some safety rules we have to

281
00:12:14,279 --> 00:12:17,160
invent some new technology to prevent

282
00:12:17,160 --> 00:12:19,140
the Northeast blackout from happening

283
00:12:19,140 --> 00:12:19,980
again

284
00:12:19,980 --> 00:12:23,399
so we come up with do fault recorders

285
00:12:23,399 --> 00:12:25,980
new digital relays we have ethernet

286
00:12:25,980 --> 00:12:27,660
based scada

287
00:12:27,660 --> 00:12:29,940
phasor measurement units things like

288
00:12:29,940 --> 00:12:32,760
that and then I have in the bottom right

289
00:12:32,760 --> 00:12:34,620
we have network security monitoring it

290
00:12:34,620 --> 00:12:36,480
came around in 1988 you know the

291
00:12:36,480 --> 00:12:38,760
Cuckoo's egg all that stuff we all know

292
00:12:38,760 --> 00:12:39,980
and love

293
00:12:39,980 --> 00:12:41,640
you know

294
00:12:41,640 --> 00:12:44,459
so then we have the blackout happened

295
00:12:44,459 --> 00:12:46,440
again in 2003.

296
00:12:46,440 --> 00:12:48,420
and we go well we didn't have enough

297
00:12:48,420 --> 00:12:51,360
forensics data this wig wag charts that

298
00:12:51,360 --> 00:12:52,820
show

299
00:12:52,820 --> 00:12:55,320
amps was not

300
00:12:55,320 --> 00:12:57,959
you know detailed enough we needed more

301
00:12:57,959 --> 00:13:00,959
information we couldn't see down to the

302
00:13:00,959 --> 00:13:03,660
milliseconds on the forensics to put

303
00:13:03,660 --> 00:13:05,519
together what happened they did put

304
00:13:05,519 --> 00:13:06,779
together what happened but one that

305
00:13:06,779 --> 00:13:08,519
after action was

306
00:13:08,519 --> 00:13:11,339
we need to do more and so we go back to

307
00:13:11,339 --> 00:13:13,200
this and you can see down to the

308
00:13:13,200 --> 00:13:15,000
individual

309
00:13:15,000 --> 00:13:17,220
cycles of the sine wave that's on your

310
00:13:17,220 --> 00:13:19,700
power lines

311
00:13:20,160 --> 00:13:23,880
and then now we've fast forward uh where

312
00:13:23,880 --> 00:13:26,459
we have the Ukraine grid attacks in 2015

313
00:13:26,459 --> 00:13:30,540
and 2016 and and then the Ukraine Russia

314
00:13:30,540 --> 00:13:32,459
war against Ukraine now

315
00:13:32,459 --> 00:13:35,399
uh we see that and this kind of just

316
00:13:35,399 --> 00:13:36,959
gives you an idea

317
00:13:36,959 --> 00:13:39,540
this is just engineering for Power

318
00:13:39,540 --> 00:13:41,880
Systems this is just an idea of the

319
00:13:41,880 --> 00:13:44,399
power grid monitoring since then

320
00:13:44,399 --> 00:13:46,860
so what I try to do is if I meet someone

321
00:13:46,860 --> 00:13:48,899
who doesn't know about security

322
00:13:48,899 --> 00:13:51,180
monitoring I go yeah you do you just

323
00:13:51,180 --> 00:13:52,440
call it something else you're doing

324
00:13:52,440 --> 00:13:54,860
power grid monitoring or you're doing

325
00:13:54,860 --> 00:13:58,260
control system monitoring so that we're

326
00:13:58,260 --> 00:13:59,339
going to see where I'm going with this

327
00:13:59,339 --> 00:14:01,380
we're going to take two concepts and

328
00:14:01,380 --> 00:14:03,660
they're basically the same thing

329
00:14:03,660 --> 00:14:06,300
so a little Bobby I don't know if you've

330
00:14:06,300 --> 00:14:10,079
seen Rob Lee's uh comic strip let's get

331
00:14:10,079 --> 00:14:12,959
some Network visibility and more secure

332
00:14:12,959 --> 00:14:14,760
reliable safe environment what are your

333
00:14:14,760 --> 00:14:15,720
goals

334
00:14:15,720 --> 00:14:18,720
great and you might want to think about

335
00:14:18,720 --> 00:14:21,300
to the in-state deliverables with the

336
00:14:21,300 --> 00:14:23,459
scenarios and impact those goals and

337
00:14:23,459 --> 00:14:24,779
think about the in-state and work

338
00:14:24,779 --> 00:14:27,240
backwards make sure your response

339
00:14:27,240 --> 00:14:28,620
scenarios are supported by your

340
00:14:28,620 --> 00:14:30,779
detection and collection strategies

341
00:14:30,779 --> 00:14:33,420
so that's a really great little comic

342
00:14:33,420 --> 00:14:34,399
strip

343
00:14:34,399 --> 00:14:37,440
around network security monitoring and

344
00:14:37,440 --> 00:14:41,040
control systems so it's really great

345
00:14:41,040 --> 00:14:43,260
so let's take this standard

346
00:14:43,260 --> 00:14:45,959
um Isa the international Society of

347
00:14:45,959 --> 00:14:50,399
automation has 18.2 2016. this is really

348
00:14:50,399 --> 00:14:53,160
nerdy and I will read just this first

349
00:14:53,160 --> 00:14:55,320
paragraph the primary function within

350
00:14:55,320 --> 00:14:57,600
the alarm system is to notify operators

351
00:14:57,600 --> 00:15:00,480
of a normal process conditions or

352
00:15:00,480 --> 00:15:03,060
equipment malfunctions and support the

353
00:15:03,060 --> 00:15:06,420
response does that sound like what we do

354
00:15:06,420 --> 00:15:08,100
I mean this is pretty much the same

355
00:15:08,100 --> 00:15:10,680
thing so let's read nist intrusion

356
00:15:10,680 --> 00:15:12,720
detection is a process of monitoring the

357
00:15:12,720 --> 00:15:16,260
events blah blah blah of imminent

358
00:15:16,260 --> 00:15:17,699
threats and violation of computer

359
00:15:17,699 --> 00:15:19,680
security policies

360
00:15:19,680 --> 00:15:21,959
acceptable use policy standard and

361
00:15:21,959 --> 00:15:24,060
basically ends up supporting what the

362
00:15:24,060 --> 00:15:26,040
response

363
00:15:26,040 --> 00:15:28,199
so we take this diagram

364
00:15:28,199 --> 00:15:32,519
of a control system and it shows from

365
00:15:32,519 --> 00:15:34,560
this standard this Isa standard shows

366
00:15:34,560 --> 00:15:37,560
where you collect data from

367
00:15:37,560 --> 00:15:40,440
and where the alarms are going and you

368
00:15:40,440 --> 00:15:41,240
take

369
00:15:41,240 --> 00:15:43,500
these different sensors on the farther

370
00:15:43,500 --> 00:15:45,480
the far left you have like a pipe there

371
00:15:45,480 --> 00:15:47,279
it's got sensors it's like temperature

372
00:15:47,279 --> 00:15:49,199
pressure monitoring there's a control

373
00:15:49,199 --> 00:15:52,139
valve that has the safety system that's

374
00:15:52,139 --> 00:15:55,160
the sis or the basic

375
00:15:55,160 --> 00:15:58,260
process control system that's the plcs

376
00:15:58,260 --> 00:16:00,120
and you have your hmis that you touch

377
00:16:00,120 --> 00:16:02,880
and can turn on and off things and all

378
00:16:02,880 --> 00:16:04,860
these things are collecting to an alarm

379
00:16:04,860 --> 00:16:06,240
system

380
00:16:06,240 --> 00:16:09,120
well let's drop Security on top of that

381
00:16:09,120 --> 00:16:12,300
we can collect the alarm logs and the

382
00:16:12,300 --> 00:16:14,160
security logs like the newer plcs have

383
00:16:14,160 --> 00:16:16,199
syslog in them and like I talked about

384
00:16:16,199 --> 00:16:19,680
in 2015. we can collect all those logs

385
00:16:19,680 --> 00:16:21,420
and even collect them from a network

386
00:16:21,420 --> 00:16:23,699
security monitoring system

387
00:16:23,699 --> 00:16:26,579
on a sensor on the network and send them

388
00:16:26,579 --> 00:16:29,100
to your security system

389
00:16:29,100 --> 00:16:31,500
your sim or your sock or whatever it

390
00:16:31,500 --> 00:16:34,339
could be security Union

391
00:16:35,519 --> 00:16:38,820
basically it's taking the best of both

392
00:16:38,820 --> 00:16:39,899
worlds of

393
00:16:39,899 --> 00:16:42,600
operations we're monitoring the process

394
00:16:42,600 --> 00:16:44,279
we're trying to make sure that we're

395
00:16:44,279 --> 00:16:47,160
still making power we're still

396
00:16:47,160 --> 00:16:51,180
making oil and gas into end products

397
00:16:51,180 --> 00:16:54,420
that we can use every day or maybe

398
00:16:54,420 --> 00:16:55,920
chocolate bars it could be anything

399
00:16:55,920 --> 00:16:57,839
right and then you have security

400
00:16:57,839 --> 00:17:00,180
monitoring the network for malicious

401
00:17:00,180 --> 00:17:03,180
activity for all these other things like

402
00:17:03,180 --> 00:17:06,000
regulatory safety

403
00:17:06,000 --> 00:17:08,280
things basically it boils down to with

404
00:17:08,280 --> 00:17:10,619
visibility like talk earlier you can't

405
00:17:10,619 --> 00:17:12,959
see where you aren't looking and neither

406
00:17:12,959 --> 00:17:15,900
you you can't do forensics either

407
00:17:15,900 --> 00:17:19,020
one thing that I run into is engineers

408
00:17:19,020 --> 00:17:21,660
in the control system environment don't

409
00:17:21,660 --> 00:17:23,520
really know the term

410
00:17:23,520 --> 00:17:25,859
dfir or

411
00:17:25,859 --> 00:17:29,220
forensics they call it a different term

412
00:17:29,220 --> 00:17:32,040
they call it root cause analysis

413
00:17:32,040 --> 00:17:34,620
so sometimes this is boils down to a

414
00:17:34,620 --> 00:17:36,440
conversation you need to have around

415
00:17:36,440 --> 00:17:39,720
terms so root cause analysis they

416
00:17:39,720 --> 00:17:42,480
understand that is the same in our world

417
00:17:42,480 --> 00:17:45,660
as digital forensics there are

418
00:17:45,660 --> 00:17:47,640
engineering forensics like after the

419
00:17:47,640 --> 00:17:51,000
Super Bowl blackout and uh you know

420
00:17:51,000 --> 00:17:54,360
after after in the Superdome they had a

421
00:17:54,360 --> 00:17:56,460
forensics engineer come in to determine

422
00:17:56,460 --> 00:17:58,020
what happened and they cause a root

423
00:17:58,020 --> 00:18:00,660
determine the root cause I got a phone

424
00:18:00,660 --> 00:18:01,980
call because I worked at that power

425
00:18:01,980 --> 00:18:04,799
company and they said is it cyber I go I

426
00:18:04,799 --> 00:18:07,080
don't know yet I just saw it and let me

427
00:18:07,080 --> 00:18:08,700
go log in

428
00:18:08,700 --> 00:18:12,660
uh it wasn't cyber thankfully uh that

429
00:18:12,660 --> 00:18:15,539
actually that substation had 1200 baud

430
00:18:15,539 --> 00:18:18,120
scada modems so I don't think a hacker

431
00:18:18,120 --> 00:18:20,340
is going to go waste his time trying to

432
00:18:20,340 --> 00:18:22,799
fool with that uh fortunately it was not

433
00:18:22,799 --> 00:18:27,780
related to uh it was a defect in the

434
00:18:27,780 --> 00:18:30,539
relay that was there protecting it it

435
00:18:30,539 --> 00:18:32,340
wasn't anything related to cyber

436
00:18:32,340 --> 00:18:34,620
security at all

437
00:18:34,620 --> 00:18:38,580
so I love this uh Josh uh and Chris

438
00:18:38,580 --> 00:18:41,220
talking about detection engineering is a

439
00:18:41,220 --> 00:18:42,960
process of researching threats and then

440
00:18:42,960 --> 00:18:45,720
building and tuning the tools that find

441
00:18:45,720 --> 00:18:48,660
them I love that I love it love it I

442
00:18:48,660 --> 00:18:52,140
freaking love it you know laughs uh

443
00:18:52,140 --> 00:18:54,059
because it's talking my language it's

444
00:18:54,059 --> 00:18:56,160
talking about when we don't willy-nilly

445
00:18:56,160 --> 00:18:57,780
just go buy this and throw it in there

446
00:18:57,780 --> 00:19:00,480
and then yep yep we checked that box

447
00:19:00,480 --> 00:19:04,080
nope uh we want to get rid of these

448
00:19:04,080 --> 00:19:06,840
nuisance things we want to custom craft

449
00:19:06,840 --> 00:19:10,080
custom build uh and this detection

450
00:19:10,080 --> 00:19:11,700
system around the thing that we've

451
00:19:11,700 --> 00:19:12,900
already custom built which is the

452
00:19:12,900 --> 00:19:14,700
control system

453
00:19:14,700 --> 00:19:18,720
so this alert philosophy in the ISA 18.2

454
00:19:18,720 --> 00:19:21,720
standard basically it starts with having

455
00:19:21,720 --> 00:19:23,700
the basic definitions

456
00:19:23,700 --> 00:19:26,460
that extends to operational definitions

457
00:19:26,460 --> 00:19:29,220
and then you have the performance and

458
00:19:29,220 --> 00:19:31,919
metrics around that based on the

459
00:19:31,919 --> 00:19:33,419
objectives and principles for the Alarm

460
00:19:33,419 --> 00:19:36,000
Systems this is very

461
00:19:36,000 --> 00:19:38,520
what we do in cyber security with a

462
00:19:38,520 --> 00:19:40,980
mature sock operation you're going to

463
00:19:40,980 --> 00:19:42,720
have the same type of philosophy around

464
00:19:42,720 --> 00:19:44,460
it

465
00:19:44,460 --> 00:19:48,179
so what I would say is let's have an ICS

466
00:19:48,179 --> 00:19:50,340
or control system security alert

467
00:19:50,340 --> 00:19:52,880
philosophy around

468
00:19:52,880 --> 00:19:56,000
defining the security operations

469
00:19:56,000 --> 00:19:58,500
defining the alert categories and

470
00:19:58,500 --> 00:20:00,120
priorities

471
00:20:00,120 --> 00:20:03,120
defining the metrics around them and

472
00:20:03,120 --> 00:20:05,340
then align them with your existing

473
00:20:05,340 --> 00:20:07,140
philosophies that are maybe with your it

474
00:20:07,140 --> 00:20:09,600
alerts security alerts or your ICS

475
00:20:09,600 --> 00:20:12,059
control system alarms so it would be

476
00:20:12,059 --> 00:20:15,000
cool to have like your playbooks that

477
00:20:15,000 --> 00:20:17,520
have not you know the the university

478
00:20:17,520 --> 00:20:19,559
folks say what do we do I would just

479
00:20:19,559 --> 00:20:22,500
Google it no we want to have a known

480
00:20:22,500 --> 00:20:23,660
custom

481
00:20:23,660 --> 00:20:26,580
response for this event just like there

482
00:20:26,580 --> 00:20:29,940
is for if a temperature alarm goes off

483
00:20:29,940 --> 00:20:33,059
on a critical pipeline you know you

484
00:20:33,059 --> 00:20:35,340
don't want to have to go I got to go

485
00:20:35,340 --> 00:20:37,200
read the manual no we want to have it

486
00:20:37,200 --> 00:20:40,799
Custom Engineered the entire way

487
00:20:40,799 --> 00:20:44,340
there's a a free checklist in addition

488
00:20:44,340 --> 00:20:46,860
to the ISA standards there's this one

489
00:20:46,860 --> 00:20:49,500
called eemua based in the UK engineering

490
00:20:49,500 --> 00:20:51,000
equipment and materials users

491
00:20:51,000 --> 00:20:52,620
Association

492
00:20:52,620 --> 00:20:55,520
they have a standard called engineering

493
00:20:55,520 --> 00:21:00,600
eemua 191 basically talks about how to

494
00:21:00,600 --> 00:21:05,100
do a checklist and for your philosophy

495
00:21:05,100 --> 00:21:07,860
creating these alerts so we can use this

496
00:21:07,860 --> 00:21:12,120
to create ICS tuning alert philosophies

497
00:21:12,120 --> 00:21:15,240
so just replace the alarm word with

498
00:21:15,240 --> 00:21:18,299
alert and it's like Define any technical

499
00:21:18,299 --> 00:21:21,000
terms used in instead of eclipsing

500
00:21:21,000 --> 00:21:23,400
suppression we just change change it to

501
00:21:23,400 --> 00:21:26,760
ioc network attack sand worm you know

502
00:21:26,760 --> 00:21:28,740
whatever custom alert you're riding it

503
00:21:28,740 --> 00:21:30,980
for

504
00:21:31,500 --> 00:21:33,840
change it you know lay out the

505
00:21:33,840 --> 00:21:36,299
methodology for managing the alert

506
00:21:36,299 --> 00:21:38,460
systems including the management of

507
00:21:38,460 --> 00:21:41,640
Change setting in the alert priorities

508
00:21:41,640 --> 00:21:44,340
or incident priorities the guidance on

509
00:21:44,340 --> 00:21:47,760
the selection of the rules

510
00:21:47,760 --> 00:21:50,340
and things like that so basically we're

511
00:21:50,340 --> 00:21:52,860
taking something that's old

512
00:21:52,860 --> 00:21:55,200
and making it the new hotness we're

513
00:21:55,200 --> 00:21:56,640
doing the same thing that we've done

514
00:21:56,640 --> 00:21:59,280
before a trillion times we just forget

515
00:21:59,280 --> 00:22:01,080
in human history that we've already

516
00:22:01,080 --> 00:22:03,740
invented it

517
00:22:04,020 --> 00:22:06,120
same thing has this whole philosophy

518
00:22:06,120 --> 00:22:08,940
around security alert management this

519
00:22:08,940 --> 00:22:12,360
audit philosophy Loop that's in Isa

520
00:22:12,360 --> 00:22:16,140
standard 18.2 talks about how to have a

521
00:22:16,140 --> 00:22:18,960
mature alarm philosophy

522
00:22:18,960 --> 00:22:20,640
well let's just change some of the

523
00:22:20,640 --> 00:22:22,860
things from operation maintenance and

524
00:22:22,860 --> 00:22:25,620
monitoring assessment to security Ops

525
00:22:25,620 --> 00:22:27,360
tuning and hunting

526
00:22:27,360 --> 00:22:30,600
it just Falls right into place

527
00:22:30,600 --> 00:22:32,159
I love it

528
00:22:32,159 --> 00:22:34,440
so going back to the old mandiant

529
00:22:34,440 --> 00:22:38,340
presentation I gave back in 2015. how do

530
00:22:38,340 --> 00:22:41,039
we do NSM for Control Systems there's a

531
00:22:41,039 --> 00:22:43,559
little example of control system you

532
00:22:43,559 --> 00:22:46,100
know grabbing the firewall logs or you

533
00:22:46,100 --> 00:22:48,960
netflow or full pcap P CAP or didn't

534
00:22:48,960 --> 00:22:51,840
happen and then detection looking at

535
00:22:51,840 --> 00:22:54,780
your security onion alerts or your

536
00:22:54,780 --> 00:22:58,440
firewall alerts or high CPU usage or

537
00:22:58,440 --> 00:22:59,299
whatever

538
00:22:59,299 --> 00:23:01,559
we want to

539
00:23:01,559 --> 00:23:04,559
consider where we detect and then apply

540
00:23:04,559 --> 00:23:06,659
it and tune it so

541
00:23:06,659 --> 00:23:09,480
this is some diagrams from alarm

542
00:23:09,480 --> 00:23:11,340
management

543
00:23:11,340 --> 00:23:14,640
there's a blog post after this I'm going

544
00:23:14,640 --> 00:23:16,140
to post these so you can get to the

545
00:23:16,140 --> 00:23:17,100
links

546
00:23:17,100 --> 00:23:19,799
but it tells you what happens if you

547
00:23:19,799 --> 00:23:22,020
have not tuned

548
00:23:22,020 --> 00:23:25,740
your system so basically the nuisance

549
00:23:25,740 --> 00:23:27,480
alarm should become standing alarms

550
00:23:27,480 --> 00:23:29,640
these standing alarms become performance

551
00:23:29,640 --> 00:23:32,880
Target missed alarms then you're getting

552
00:23:32,880 --> 00:23:35,700
into like wear and tear of Machinery

553
00:23:35,700 --> 00:23:39,780
you're getting equipment damage and if

554
00:23:39,780 --> 00:23:42,659
you are basically upset so much where

555
00:23:42,659 --> 00:23:44,460
you're overwhelmed with so many alarms

556
00:23:44,460 --> 00:23:46,320
you don't know what to do with you're

557
00:23:46,320 --> 00:23:49,080
missing critical alarms you're going to

558
00:23:49,080 --> 00:23:51,059
have injuries and possibly deaths

559
00:23:51,059 --> 00:23:54,120
emergency shutdown or environmental

560
00:23:54,120 --> 00:23:56,159
violations

561
00:23:56,159 --> 00:23:58,320
if you can't

562
00:23:58,320 --> 00:24:01,039
manage your security

563
00:24:01,039 --> 00:24:04,080
alerts the same way you manage control

564
00:24:04,080 --> 00:24:07,860
system Engineers manage the alarm system

565
00:24:07,860 --> 00:24:11,159
so you see we can use the same

566
00:24:11,159 --> 00:24:16,380
philosophy as well in the aamua blog

567
00:24:16,380 --> 00:24:18,380
they have

568
00:24:18,380 --> 00:24:22,140
this level average number of alarms per

569
00:24:22,140 --> 00:24:25,140
operator per hour and then maximum

570
00:24:25,140 --> 00:24:26,880
number of alarms per operator per hour

571
00:24:26,880 --> 00:24:29,640
and there's a a specific level just

572
00:24:29,640 --> 00:24:31,380
between level four and level five is

573
00:24:31,380 --> 00:24:34,919
that their target what's uh and we have

574
00:24:34,919 --> 00:24:38,299
this for socks right we have how many

575
00:24:38,299 --> 00:24:42,000
alarms or alerts can or incidents can a

576
00:24:42,000 --> 00:24:44,580
sock analysts handle how many can the

577
00:24:44,580 --> 00:24:47,100
hole saw handle it's the same thing with

578
00:24:47,100 --> 00:24:49,799
control systems

579
00:24:49,799 --> 00:24:52,320
we don't want to overload our people and

580
00:24:52,320 --> 00:24:55,380
if you only have one person and you have

581
00:24:55,380 --> 00:24:56,760
6

582
00:24:56,760 --> 00:25:00,480
000 alerts per hour then that's that's

583
00:25:00,480 --> 00:25:03,200
untenable

584
00:25:03,840 --> 00:25:06,840
so how do we reduce nuisance alarms

585
00:25:06,840 --> 00:25:09,120
and reduce nuisance

586
00:25:09,120 --> 00:25:11,760
control system security alerts just the

587
00:25:11,760 --> 00:25:13,799
way same way we try to reduce them with

588
00:25:13,799 --> 00:25:15,960
like security onion tuning right

589
00:25:15,960 --> 00:25:18,419
so here's an example before from this

590
00:25:18,419 --> 00:25:20,600
blog post from chemical

591
00:25:20,600 --> 00:25:23,700
processing.com that had a reduction of

592
00:25:23,700 --> 00:25:25,559
nuisance alarms they have the process of

593
00:25:25,559 --> 00:25:27,900
alarms which is up in red and the

594
00:25:27,900 --> 00:25:31,799
operator's actions which is blue below

595
00:25:31,799 --> 00:25:36,120
once they reduce the nuisance alerts

596
00:25:36,120 --> 00:25:38,880
you can see that the the signal and

597
00:25:38,880 --> 00:25:42,120
noise ratio is changed significantly an

598
00:25:42,120 --> 00:25:44,700
operator can see when they need to act

599
00:25:44,700 --> 00:25:47,299
upon which alarms that are happening

600
00:25:47,299 --> 00:25:51,419
same way if you have too many cyber

601
00:25:51,419 --> 00:25:54,120
security alarms coming in right

602
00:25:54,120 --> 00:25:57,179
and there's another one about this blog

603
00:25:57,179 --> 00:26:00,299
post about fire alarm systems because

604
00:26:00,299 --> 00:26:03,419
you know someone pulls a fire alarm okay

605
00:26:03,419 --> 00:26:05,100
is it

606
00:26:05,100 --> 00:26:08,520
you know is it a bad sensor you should

607
00:26:08,520 --> 00:26:11,760
clean the systems uh regularly avoid

608
00:26:11,760 --> 00:26:13,320
activities that would trigger the alarm

609
00:26:13,320 --> 00:26:16,020
or like propping the door open and you

610
00:26:16,020 --> 00:26:17,760
know the oh there's a bakery next door

611
00:26:17,760 --> 00:26:19,919
that's got too much smoke happening you

612
00:26:19,919 --> 00:26:22,740
know or maybe you're just using your

613
00:26:22,740 --> 00:26:24,720
smoke alarm as a timer in your house

614
00:26:24,720 --> 00:26:26,960
when you're cooking right

615
00:26:26,960 --> 00:26:31,080
I've done that seasoning cast iron at 11

616
00:26:31,080 --> 00:26:35,480
PM one time my wife was yelling at me

617
00:26:35,480 --> 00:26:39,000
and I realized that I should have

618
00:26:39,000 --> 00:26:40,440
propped the back door open and turned on

619
00:26:40,440 --> 00:26:42,659
a fan to prevent that from happening but

620
00:26:42,659 --> 00:26:46,440
it still it was I barely made it out of

621
00:26:46,440 --> 00:26:49,320
there with my uh

622
00:26:49,320 --> 00:26:51,120
don't wake your wife up with a fire

623
00:26:51,120 --> 00:26:53,719
alarm okay

624
00:26:54,360 --> 00:26:56,460
so examples when you don't tune you know

625
00:26:56,460 --> 00:26:58,380
this install your favorite security

626
00:26:58,380 --> 00:27:00,840
engine sensor or your favorite control

627
00:27:00,840 --> 00:27:03,779
system NSM sensor here installed its

628
00:27:03,779 --> 00:27:05,880
collecting but data oh my gosh you got

629
00:27:05,880 --> 00:27:08,880
all these emails all these vehicle

630
00:27:08,880 --> 00:27:11,940
alerts coming in oh my god

631
00:27:11,940 --> 00:27:12,539
um

632
00:27:12,539 --> 00:27:15,299
I have a little War Story we had um

633
00:27:15,299 --> 00:27:17,940
a customer uh

634
00:27:17,940 --> 00:27:21,900
uh that we had the head did this they

635
00:27:21,900 --> 00:27:24,840
went out and bought a

636
00:27:24,840 --> 00:27:27,720
you know a latest vendor I won't say

637
00:27:27,720 --> 00:27:29,279
which vendor

638
00:27:29,279 --> 00:27:31,320
um and it doesn't matter really they

639
00:27:31,320 --> 00:27:33,419
just install one for their water system

640
00:27:33,419 --> 00:27:36,240
one for their Wastewater system

641
00:27:36,240 --> 00:27:38,700
and they weren't tuned at all

642
00:27:38,700 --> 00:27:41,580
and they weren't trained on how to tune

643
00:27:41,580 --> 00:27:45,240
it and one had a million alerts in it

644
00:27:45,240 --> 00:27:46,620
the other one I had eight hundred

645
00:27:46,620 --> 00:27:49,320
thousand alerts in it the one that had a

646
00:27:49,320 --> 00:27:51,900
million alerts in it you had to reboot

647
00:27:51,900 --> 00:27:54,720
the sensor to be able to log into it so

648
00:27:54,720 --> 00:27:56,640
just imagine if your security onion box

649
00:27:56,640 --> 00:27:59,820
Doug like you know it's got a million

650
00:27:59,820 --> 00:28:01,559
alerts in there and it's not tuned it's

651
00:28:01,559 --> 00:28:04,080
it's useful it's useless

652
00:28:04,080 --> 00:28:05,820
what would it happen the root cause was

653
00:28:05,820 --> 00:28:09,240
is they had mesh radios that change IP

654
00:28:09,240 --> 00:28:12,059
addresses based upon the best route

655
00:28:12,059 --> 00:28:14,640
and so there was all these alarms of

656
00:28:14,640 --> 00:28:18,659
uh Mac address IP address changes

657
00:28:18,659 --> 00:28:21,419
if we would have just tuned to learn all

658
00:28:21,419 --> 00:28:24,600
the known radio Mac addresses

659
00:28:24,600 --> 00:28:27,120
we wouldn't have gotten any alarms

660
00:28:27,120 --> 00:28:30,000
and you know our uh our good friend

661
00:28:30,000 --> 00:28:32,760
Richard balek tweeted about this it's

662
00:28:32,760 --> 00:28:36,360
like by default bro or Zeke is going to

663
00:28:36,360 --> 00:28:38,159
generate alert for everything so if you

664
00:28:38,159 --> 00:28:40,679
oh we uh experienced this if you've ever

665
00:28:40,679 --> 00:28:43,140
put Zeke into place you've never put it

666
00:28:43,140 --> 00:28:44,880
before and you by default it's going to

667
00:28:44,880 --> 00:28:48,059
alert on everything so modbus or dmp3

668
00:28:48,059 --> 00:28:51,179
it's going to alert on everything so you

669
00:28:51,179 --> 00:28:53,220
got to turn off

670
00:28:53,220 --> 00:28:55,380
everything and and then turn on things

671
00:28:55,380 --> 00:28:56,820
that you only want

672
00:28:56,820 --> 00:28:59,220
it to do

673
00:28:59,220 --> 00:29:03,059
so it's uh it's it's a good thing to get

674
00:29:03,059 --> 00:29:04,860
rid of that and you know collecting them

675
00:29:04,860 --> 00:29:08,880
all everybody remember Beanie Babies

676
00:29:08,880 --> 00:29:09,659
um

677
00:29:09,659 --> 00:29:12,000
yeah that was something right back in

678
00:29:12,000 --> 00:29:14,940
the early 2000s right

679
00:29:14,940 --> 00:29:17,220
um they're not worth anything

680
00:29:17,220 --> 00:29:19,020
if you collect them all you want to

681
00:29:19,020 --> 00:29:21,120
collect the alerts that matter

682
00:29:21,120 --> 00:29:23,700
you know the I wish I still had that bow

683
00:29:23,700 --> 00:29:26,159
nose baseball card right I had all the

684
00:29:26,159 --> 00:29:27,779
baseball cards but the one that Beau

685
00:29:27,779 --> 00:29:30,360
knows that had the football pads and

686
00:29:30,360 --> 00:29:32,580
that's the one you wanted right as when

687
00:29:32,580 --> 00:29:35,700
I was collecting cards as a kid

688
00:29:35,700 --> 00:29:37,860
false positives still cause threat alert

689
00:29:37,860 --> 00:29:41,039
fatigue and like with the target breach

690
00:29:41,039 --> 00:29:43,320
they missed the critical alert because

691
00:29:43,320 --> 00:29:45,020
they had too many alerts

692
00:29:45,020 --> 00:29:47,760
in there there's a couple of examples

693
00:29:47,760 --> 00:29:49,980
from the news

694
00:29:49,980 --> 00:29:52,039
um

695
00:29:52,500 --> 00:29:54,059
uh if you haven't seen this before this

696
00:29:54,059 --> 00:29:58,740
was really great this is from Google uh

697
00:29:58,740 --> 00:30:00,179
and I didn't know that I was going to

698
00:30:00,179 --> 00:30:03,120
become Google so but this is from a few

699
00:30:03,120 --> 00:30:05,580
years ago when I found this webpage they

700
00:30:05,580 --> 00:30:07,679
have the confusing Matrix

701
00:30:07,679 --> 00:30:10,320
of true positive true negative versus

702
00:30:10,320 --> 00:30:12,679
false positive and false negative

703
00:30:12,679 --> 00:30:15,600
example of true positive a wolf

704
00:30:15,600 --> 00:30:17,880
threatened Shepherd said wolf how come

705
00:30:17,880 --> 00:30:20,460
Shepherd is a hero

706
00:30:20,460 --> 00:30:23,279
false negative a wolf threatened

707
00:30:23,279 --> 00:30:25,080
Shepherd said no wolf

708
00:30:25,080 --> 00:30:27,720
how come the wolf ate all the Sheep

709
00:30:27,720 --> 00:30:31,260
and and then uh everything there mubix

710
00:30:31,260 --> 00:30:33,960
on Twitter gave me the idea to find that

711
00:30:33,960 --> 00:30:37,520
so shout out to him for that

712
00:30:37,860 --> 00:30:40,500
so where do we start for those of you

713
00:30:40,500 --> 00:30:42,720
who have control systems or have

714
00:30:42,720 --> 00:30:46,740
customers clients friends whatever uh

715
00:30:46,740 --> 00:30:48,720
if they're starting to do security

716
00:30:48,720 --> 00:30:50,760
monitoring in control systems where do

717
00:30:50,760 --> 00:30:52,559
you start is generally there's not any

718
00:30:52,559 --> 00:30:56,279
sensors at all not very logs being

719
00:30:56,279 --> 00:30:58,799
collected unless it's for critical

720
00:30:58,799 --> 00:31:02,460
things so basically we want you to start

721
00:31:02,460 --> 00:31:05,159
small and use what you already have you

722
00:31:05,159 --> 00:31:07,380
don't need to go buy the latest and

723
00:31:07,380 --> 00:31:10,020
greatest everything and redo all of your

724
00:31:10,020 --> 00:31:12,840
control systems with the latest Windows

725
00:31:12,840 --> 00:31:16,320
the latest Linux the latest plcs no

726
00:31:16,320 --> 00:31:18,240
start with what you have

727
00:31:18,240 --> 00:31:21,059
and then use that capability until you

728
00:31:21,059 --> 00:31:22,919
need more right don't overwhelm yourself

729
00:31:22,919 --> 00:31:25,500
right off the bat

730
00:31:25,500 --> 00:31:28,260
and then as you get better you add more

731
00:31:28,260 --> 00:31:30,299
add more and add more

732
00:31:30,299 --> 00:31:32,220
I gave it a little bit more details

733
00:31:32,220 --> 00:31:34,919
about this in my talk at s419

734
00:31:34,919 --> 00:31:38,480
and that video is on YouTube

735
00:31:40,200 --> 00:31:42,600
so focusing on the basics

736
00:31:42,600 --> 00:31:43,140
um

737
00:31:43,140 --> 00:31:46,919
sock analysts go buy engineers and your

738
00:31:46,919 --> 00:31:50,279
technicians go buy them a box of donuts

739
00:31:50,279 --> 00:31:53,399
and ask them their pain and they will

740
00:31:53,399 --> 00:31:55,440
tell you what has been painful around

741
00:31:55,440 --> 00:31:58,440
I.T and I.T security

742
00:31:58,440 --> 00:32:01,500
and then go solve and Conquer because

743
00:32:01,500 --> 00:32:04,380
they're smart they know about monitoring

744
00:32:04,380 --> 00:32:06,179
they just don't know your terms for

745
00:32:06,179 --> 00:32:07,260
monitoring

746
00:32:07,260 --> 00:32:08,880
remember they don't know DFI or they

747
00:32:08,880 --> 00:32:11,940
know root cause analysis RCA

748
00:32:11,940 --> 00:32:12,600
um

749
00:32:12,600 --> 00:32:15,600
work on this alert philosophy together

750
00:32:15,600 --> 00:32:17,820
and leverage your existing standards

751
00:32:17,820 --> 00:32:20,899
like your alarm standards or your sock

752
00:32:20,899 --> 00:32:23,820
Philosophy for creating alerts

753
00:32:23,820 --> 00:32:26,340
if you don't have one you can use these

754
00:32:26,340 --> 00:32:29,100
standards that I mentioned before

755
00:32:29,100 --> 00:32:31,740
start if you need to know where to put a

756
00:32:31,740 --> 00:32:33,360
sensor start at the boundary between

757
00:32:33,360 --> 00:32:35,700
your ite and your control system or OT

758
00:32:35,700 --> 00:32:38,460
it or OT sometimes there's a DMZ

759
00:32:38,460 --> 00:32:41,279
firewall sometimes there's a switch

760
00:32:41,279 --> 00:32:43,740
it could be somewhere but there's always

761
00:32:43,740 --> 00:32:46,440
a delineation between the two generally

762
00:32:46,440 --> 00:32:48,299
even if it's a flat Network there's

763
00:32:48,299 --> 00:32:51,059
still a delineation there

764
00:32:51,059 --> 00:32:53,880
and then add your existing Windows locks

765
00:32:53,880 --> 00:32:56,279
there's a lot of Windows systems are in

766
00:32:56,279 --> 00:32:58,020
control systems and so they have Windows

767
00:32:58,020 --> 00:33:00,960
alerts you know applications security

768
00:33:00,960 --> 00:33:03,480
logs all those things

769
00:33:03,480 --> 00:33:06,419
the one piece of advice I have is don't

770
00:33:06,419 --> 00:33:09,240
put security alerts on The Operators

771
00:33:09,240 --> 00:33:11,700
workstations they already have enough to

772
00:33:11,700 --> 00:33:12,480
do

773
00:33:12,480 --> 00:33:15,299
managing their own system so leave that

774
00:33:15,299 --> 00:33:17,760
to the stock analyst to do that don't

775
00:33:17,760 --> 00:33:19,980
want to get unless it's

776
00:33:19,980 --> 00:33:21,899
like one

777
00:33:21,899 --> 00:33:26,580
and like if security alert any

778
00:33:26,580 --> 00:33:29,279
tell them to call the sock team maybe

779
00:33:29,279 --> 00:33:31,500
that's the only one but generally try to

780
00:33:31,500 --> 00:33:33,840
keep that away from from what they have

781
00:33:33,840 --> 00:33:35,760
to do

782
00:33:35,760 --> 00:33:37,019
all right now we're going to talk about

783
00:33:37,019 --> 00:33:37,980
football

784
00:33:37,980 --> 00:33:40,320
and play books and uh this is a really

785
00:33:40,320 --> 00:33:42,360
great picture of uh

786
00:33:42,360 --> 00:33:45,120
Sean Payton who used to coach the Saints

787
00:33:45,120 --> 00:33:46,919
and you could zoom in and see his

788
00:33:46,919 --> 00:33:49,620
Playbook here great thing about

789
00:33:49,620 --> 00:33:51,419
football is you have a playbook for

790
00:33:51,419 --> 00:33:54,299
everything right for third down and two

791
00:33:54,299 --> 00:33:57,000
or fourth and long or do we pun do we

792
00:33:57,000 --> 00:33:58,860
pass or do we run

793
00:33:58,860 --> 00:34:00,179
right

794
00:34:00,179 --> 00:34:01,019
um

795
00:34:01,019 --> 00:34:03,600
the the great thing is about the coach

796
00:34:03,600 --> 00:34:05,820
is going to use the strengths of his

797
00:34:05,820 --> 00:34:06,899
players

798
00:34:06,899 --> 00:34:09,239
against the weaknesses of the opponent

799
00:34:09,239 --> 00:34:10,980
and that's what we want to do as

800
00:34:10,980 --> 00:34:12,418
Defenders

801
00:34:12,418 --> 00:34:15,540
so for it we already have tons of

802
00:34:15,540 --> 00:34:17,520
playbooks and y'all got even playbooks

803
00:34:17,520 --> 00:34:19,619
in security Union which I love this is

804
00:34:19,619 --> 00:34:21,540
great but we don't have that many in

805
00:34:21,540 --> 00:34:24,780
control system environments so let's

806
00:34:24,780 --> 00:34:27,418
think of four basic playbooks that

807
00:34:27,418 --> 00:34:29,399
people should work on for control system

808
00:34:29,399 --> 00:34:31,800
environments one commodity malware and

809
00:34:31,800 --> 00:34:34,379
OT what do you do when you have conflict

810
00:34:34,379 --> 00:34:36,480
or Remnant kegertip any of these regular

811
00:34:36,480 --> 00:34:38,879
old windows things that's been floating

812
00:34:38,879 --> 00:34:42,418
around in your network for since 2015.

813
00:34:42,418 --> 00:34:44,339
well there's generally it's not hurting

814
00:34:44,339 --> 00:34:46,199
the control system but it could

815
00:34:46,199 --> 00:34:48,719
and so you need to have a way to

816
00:34:48,719 --> 00:34:52,199
find it hunt for the rest of them that

817
00:34:52,199 --> 00:34:53,820
could be there and then clean them

818
00:34:53,820 --> 00:34:54,739
safely

819
00:34:54,739 --> 00:34:57,540
I've helped many many customers do this

820
00:34:57,540 --> 00:35:00,780
and it's a good playbook to have

821
00:35:00,780 --> 00:35:04,080
um okay the second one is OT credential

822
00:35:04,080 --> 00:35:06,480
compromise a lot of times

823
00:35:06,480 --> 00:35:07,859
um

824
00:35:07,859 --> 00:35:10,560
Control Systems have problems like you

825
00:35:10,560 --> 00:35:12,480
can't change some passwords there may be

826
00:35:12,480 --> 00:35:17,480
hard-coded or they may have less complex

827
00:35:17,480 --> 00:35:19,920
abilities like you can't change it to 20

828
00:35:19,920 --> 00:35:21,599
characters and have all the special

829
00:35:21,599 --> 00:35:23,280
characters

830
00:35:23,280 --> 00:35:24,780
um maybe they're only limited to eight

831
00:35:24,780 --> 00:35:26,940
so you need to have that knowledge

832
00:35:26,940 --> 00:35:29,460
beforehand in case your control system

833
00:35:29,460 --> 00:35:31,200
credentials are compromised like what

834
00:35:31,200 --> 00:35:32,700
happened during the Ukraine power grid

835
00:35:32,700 --> 00:35:35,880
attacks in 2015 they stole all the

836
00:35:35,880 --> 00:35:37,560
operator passwords

837
00:35:37,560 --> 00:35:39,660
and did remote access there was no a

838
00:35:39,660 --> 00:35:41,940
single factor and what was happening is

839
00:35:41,940 --> 00:35:43,920
they were turning off power

840
00:35:43,920 --> 00:35:45,320
they would

841
00:35:45,320 --> 00:35:48,180
notice it and then kick them out kill

842
00:35:48,180 --> 00:35:50,160
that one operator account and they were

843
00:35:50,160 --> 00:35:51,599
playing whack-a-mole

844
00:35:51,599 --> 00:35:53,220
and they stole the next one they stole

845
00:35:53,220 --> 00:35:55,020
the next one they just had all they had

846
00:35:55,020 --> 00:35:57,300
all the accounts instead of just

847
00:35:57,300 --> 00:36:00,180
severing the network of the VPN

848
00:36:00,180 --> 00:36:03,000
or severing the it and OT Network to

849
00:36:03,000 --> 00:36:05,220
cancel all that out they didn't have a

850
00:36:05,220 --> 00:36:08,160
Playbook to to what to do for or when

851
00:36:08,160 --> 00:36:11,099
their credentials were compromised a

852
00:36:11,099 --> 00:36:14,280
destructive attack in OT uh this has

853
00:36:14,280 --> 00:36:17,220
happened like kill disc with Ukraine or

854
00:36:17,220 --> 00:36:20,119
uh not Patia or want to cry

855
00:36:20,119 --> 00:36:24,740
you need to have a red button sever

856
00:36:24,740 --> 00:36:29,760
emergency isolation event for segmenting

857
00:36:29,760 --> 00:36:32,000
your OT

858
00:36:32,099 --> 00:36:33,900
um and there's lots of different ways to

859
00:36:33,900 --> 00:36:35,760
do that lots of philosophies on how to

860
00:36:35,760 --> 00:36:37,500
do that

861
00:36:37,500 --> 00:36:40,619
it's really important and obviously

862
00:36:40,619 --> 00:36:43,020
black backups but uh and then the last

863
00:36:43,020 --> 00:36:45,420
one is ICS protocol attack we've seen

864
00:36:45,420 --> 00:36:49,619
more and more uh two this year happened

865
00:36:49,619 --> 00:36:54,359
um in Destroyer 2 was a new uh version

866
00:36:54,359 --> 00:36:57,119
of industrial one from the Ukraine 2016

867
00:36:57,119 --> 00:36:58,380
attack

868
00:36:58,380 --> 00:37:01,859
thankfully the uh Ukraine cert caught it

869
00:37:01,859 --> 00:37:03,780
before it was deployed but it was

870
00:37:03,780 --> 00:37:07,560
targeting their IEC 104 protocol

871
00:37:07,560 --> 00:37:09,359
and then there's another one called in

872
00:37:09,359 --> 00:37:10,520
controller

873
00:37:10,520 --> 00:37:13,440
that we wrote a report on Andreas wrote

874
00:37:13,440 --> 00:37:14,580
a report on as well

875
00:37:14,580 --> 00:37:16,260
[Music]

876
00:37:16,260 --> 00:37:19,859
that we caught or someone caught before

877
00:37:19,859 --> 00:37:21,720
it was deployed in a victim network but

878
00:37:21,720 --> 00:37:24,480
we saw we actually ran it in the network

879
00:37:24,480 --> 00:37:26,220
with Schneider Electric one of the

880
00:37:26,220 --> 00:37:29,040
vendors that was targeted uh their

881
00:37:29,040 --> 00:37:30,599
products were targeted in that so we

882
00:37:30,599 --> 00:37:32,099
worked with them and ran it in the lab

883
00:37:32,099 --> 00:37:35,040
and it actually works so someone what do

884
00:37:35,040 --> 00:37:37,500
you do when someone's fuzzing my bus or

885
00:37:37,500 --> 00:37:42,839
sending unsolicited uh dmp3 commands or

886
00:37:42,839 --> 00:37:46,160
doing function code 90 and modbus to

887
00:37:46,160 --> 00:37:49,320
reboot your plcs which is a Metasploit

888
00:37:49,320 --> 00:37:50,700
module by the way

889
00:37:50,700 --> 00:37:52,500
what do you do in those cases so have

890
00:37:52,500 --> 00:37:55,260
have a playbook for all of those uh for

891
00:37:55,260 --> 00:37:57,000
if you can

892
00:37:57,000 --> 00:37:59,820
and since um since we're close to

893
00:37:59,820 --> 00:38:02,220
Atlanta uh I Gotta Throw in that uh gift

894
00:38:02,220 --> 00:38:05,000
there of uh

895
00:38:05,220 --> 00:38:09,000
Tuttle uh making a quarterback Matty Ice

896
00:38:09,000 --> 00:38:11,040
hit the hit the Hit the Dirt

897
00:38:11,040 --> 00:38:11,720
um

898
00:38:11,720 --> 00:38:14,040
the design plays for each of these

899
00:38:14,040 --> 00:38:17,220
phases practices drills user player

900
00:38:17,220 --> 00:38:19,200
strengths exploit their weaknesses and

901
00:38:19,200 --> 00:38:22,619
finish strong that's my thing here I

902
00:38:22,619 --> 00:38:24,180
think security engine should have a

903
00:38:24,180 --> 00:38:27,540
mascot because ogres have layers as well

904
00:38:27,540 --> 00:38:29,099
so

905
00:38:29,099 --> 00:38:30,599
um so

906
00:38:30,599 --> 00:38:33,180
knowing Harden your network knowing tune

907
00:38:33,180 --> 00:38:35,460
the network visibility and know what to

908
00:38:35,460 --> 00:38:38,160
do when an incident occurs

909
00:38:38,160 --> 00:38:40,200
Doug I think this I don't know if you

910
00:38:40,200 --> 00:38:42,720
can use this one it's copyrighted but uh

911
00:38:42,720 --> 00:38:45,919
but you should

912
00:38:48,060 --> 00:38:50,339
okay well

913
00:38:50,339 --> 00:38:54,180
ogres have layers cakes have layers

914
00:38:54,180 --> 00:38:57,119
so here's a eye chart for all of the

915
00:38:57,119 --> 00:38:59,940
references that I talked about this will

916
00:38:59,940 --> 00:39:03,500
be posted or you can take a picture

917
00:39:04,260 --> 00:39:09,119
and then uh so this is ICS ICS alarm

918
00:39:09,119 --> 00:39:11,099
management for all the stuff that

919
00:39:11,099 --> 00:39:13,200
Engineers have been doing since the dawn

920
00:39:13,200 --> 00:39:15,119
of 1880s

921
00:39:15,119 --> 00:39:16,040
um

922
00:39:16,040 --> 00:39:20,099
ICS Security will want to also leverage

923
00:39:20,099 --> 00:39:22,200
the security alert management so got all

924
00:39:22,200 --> 00:39:23,700
the stuff from security onion in there

925
00:39:23,700 --> 00:39:27,119
and this 894.

926
00:39:27,119 --> 00:39:31,200
um Zeke developers Google and like apply

927
00:39:31,200 --> 00:39:32,700
network security monitoring from Chris

928
00:39:32,700 --> 00:39:35,520
Sanders and Jason Smith and then the

929
00:39:35,520 --> 00:39:39,540
security engineering blog there so I

930
00:39:39,540 --> 00:39:41,760
want to appreciate everybody for

931
00:39:41,760 --> 00:39:43,980
attending my talk and I think I'm the

932
00:39:43,980 --> 00:39:46,680
last speaker before this a break or the

933
00:39:46,680 --> 00:39:47,880
state of the union or something like

934
00:39:47,880 --> 00:39:49,320
that so

935
00:39:49,320 --> 00:39:51,420
do we have any questions

936
00:39:51,420 --> 00:39:53,420
yeah

937
00:39:56,220 --> 00:39:59,760
oh yeah well those aren't

938
00:39:59,760 --> 00:40:02,099
it's like they don't there's no logs

939
00:40:02,099 --> 00:40:05,940
needed either if Sea Squirrel assume it

940
00:40:05,940 --> 00:40:08,099
was the cause and then we would have

941
00:40:08,099 --> 00:40:11,400
stories of uh line Crews if they

942
00:40:11,400 --> 00:40:13,140
couldn't find out the cause they would

943
00:40:13,140 --> 00:40:14,640
take a dead Square out of the back of

944
00:40:14,640 --> 00:40:16,380
the truck and throw it on the ground and

945
00:40:16,380 --> 00:40:20,099
say there's the culprit that was called

946
00:40:20,099 --> 00:40:22,200
a ground squirrel or a throw down

947
00:40:22,200 --> 00:40:24,680
squirrel

948
00:40:24,960 --> 00:40:27,420
um so yeah squirrels is the normal uh

949
00:40:27,420 --> 00:40:31,020
well number three calls of power outages

950
00:40:31,020 --> 00:40:34,220
any other any questions

951
00:40:34,859 --> 00:40:38,520
so go home go back to work find your

952
00:40:38,520 --> 00:40:40,560
control system environments including

953
00:40:40,560 --> 00:40:44,280
your HVAC your elevators escalators all

954
00:40:44,280 --> 00:40:46,440
those things you'll want to put some

955
00:40:46,440 --> 00:40:49,740
monitoring on those and if any

956
00:40:49,740 --> 00:40:51,540
anybody makes a change through the

957
00:40:51,540 --> 00:40:55,079
rooftop unit for your AC you want to

958
00:40:55,079 --> 00:40:57,660
know about it right

959
00:40:57,660 --> 00:41:00,010
so anyway thanks

960
00:41:00,010 --> 00:41:03,479
[Applause]

