1
00:00:04,319 --> 00:00:07,120
welcome back to the hackaday emoticon

2
00:00:07,120 --> 00:00:09,120
i'm contributing editor tom nardi and

3
00:00:09,120 --> 00:00:10,960
i'll be introducing our next guest who

4
00:00:10,960 --> 00:00:12,480
is perhaps best known to hackaday

5
00:00:12,480 --> 00:00:15,040
readers as the creator of the open book

6
00:00:15,040 --> 00:00:16,640
a very impressive and i think very

7
00:00:16,640 --> 00:00:19,039
important project that aims to design a

8
00:00:19,039 --> 00:00:22,080
fully open hardware ebook reader

9
00:00:22,080 --> 00:00:23,600
but he's recently found himself with a

10
00:00:23,600 --> 00:00:25,519
new obsession and today he's here to

11
00:00:25,519 --> 00:00:28,480
talk to us about the lowly segment lcd

12
00:00:28,480 --> 00:00:30,000
specifically how they can be reverse

13
00:00:30,000 --> 00:00:31,920
engineered and ultimately bent to our

14
00:00:31,920 --> 00:00:33,840
will so with that please join me in

15
00:00:33,840 --> 00:00:37,680
welcoming uh joey castillo to morocco

16
00:00:37,680 --> 00:00:39,440
awesome uh awesome thanks so much for

17
00:00:39,440 --> 00:00:40,640
that introduction

18
00:00:40,640 --> 00:00:41,680
um

19
00:00:41,680 --> 00:00:44,320
so i'm joey and my talk today is about

20
00:00:44,320 --> 00:00:46,160
kind of an old-school display technology

21
00:00:46,160 --> 00:00:48,239
segment liquid crystal displays

22
00:00:48,239 --> 00:00:50,160
we have a lot to cover but before i

23
00:00:50,160 --> 00:00:51,840
start for those of you who don't know me

24
00:00:51,840 --> 00:00:54,399
i figure i should do this uh who am i

25
00:00:54,399 --> 00:00:56,000
and i can probably share my screen for

26
00:00:56,000 --> 00:00:57,600
this part

27
00:00:57,600 --> 00:00:58,719
let's

28
00:00:58,719 --> 00:01:00,079
click on

29
00:01:00,079 --> 00:01:01,359
screen share

30
00:01:01,359 --> 00:01:04,239
desktop two

31
00:01:06,000 --> 00:01:07,360
okay great

32
00:01:07,360 --> 00:01:08,960
uh who am i

33
00:01:08,960 --> 00:01:10,640
i'm at jose castillo on twitter where i

34
00:01:10,640 --> 00:01:12,240
share a lot of my process working on

35
00:01:12,240 --> 00:01:14,479
open source gadgets a little while back

36
00:01:14,479 --> 00:01:15,600
i designed this thing called the open

37
00:01:15,600 --> 00:01:18,159
book which tom just spoke about and then

38
00:01:18,159 --> 00:01:19,920
recently i've been working on the sensor

39
00:01:19,920 --> 00:01:22,000
watch it's a board swap for the casio

40
00:01:22,000 --> 00:01:24,240
f91w wristwatch which is in pre-launch

41
00:01:24,240 --> 00:01:25,520
at crowdsupply if you want to check out

42
00:01:25,520 --> 00:01:26,960
that link down there

43
00:01:26,960 --> 00:01:29,200
um it's in working on this

44
00:01:29,200 --> 00:01:30,799
latest gadget that i've learned a lot

45
00:01:30,799 --> 00:01:32,960
about lcd displays these sort of

46
00:01:32,960 --> 00:01:35,680
old-school low-cost low-power displays

47
00:01:35,680 --> 00:01:37,439
that you can find in lots of gadgets

48
00:01:37,439 --> 00:01:39,520
from watches to pocket calculators

49
00:01:39,520 --> 00:01:41,439
they're ubiquitous they're cheap and

50
00:01:41,439 --> 00:01:43,280
they're seemingly ideal for repurposing

51
00:01:43,280 --> 00:01:46,320
into hobbyist projects

52
00:01:46,320 --> 00:01:48,159
before before we get to the talk though

53
00:01:48,159 --> 00:01:50,240
let's just overview what segment lcds

54
00:01:50,240 --> 00:01:51,439
are

55
00:01:51,439 --> 00:01:53,680
they're generally small glass displays

56
00:01:53,680 --> 00:01:55,280
and they tend to be monochrome just

57
00:01:55,280 --> 00:01:57,200
black and white

58
00:01:57,200 --> 00:01:58,799
they're very low power

59
00:01:58,799 --> 00:02:00,159
this makes them attractive for battery

60
00:02:00,159 --> 00:02:01,759
powered gadgets like wrist watches and

61
00:02:01,759 --> 00:02:03,759
digital thermometers but could also make

62
00:02:03,759 --> 00:02:05,680
them attractive for diy projects that

63
00:02:05,680 --> 00:02:07,280
want to use energy harvesting or solar

64
00:02:07,280 --> 00:02:08,878
power

65
00:02:08,878 --> 00:02:10,878
and finally they have a fixed layout

66
00:02:10,878 --> 00:02:12,640
which is to say you can't display

67
00:02:12,640 --> 00:02:14,720
arbitrary shapes on them you're limited

68
00:02:14,720 --> 00:02:17,040
to turning individual segments on and

69
00:02:17,040 --> 00:02:18,080
off

70
00:02:18,080 --> 00:02:19,040
um

71
00:02:19,040 --> 00:02:20,959
this makes the layout of the lcd crucial

72
00:02:20,959 --> 00:02:23,120
to how useful it can be for your project

73
00:02:23,120 --> 00:02:24,959
the display up top for example with just

74
00:02:24,959 --> 00:02:26,640
three and a half digits won't be as

75
00:02:26,640 --> 00:02:28,400
versatile as the display on the bottom

76
00:02:28,400 --> 00:02:31,360
with eight alphanumeric characters

77
00:02:31,360 --> 00:02:33,120
this is why i'm super into repurposing

78
00:02:33,120 --> 00:02:35,599
the lcds from existing gadgets

79
00:02:35,599 --> 00:02:37,120
these displays tend to have useful

80
00:02:37,120 --> 00:02:38,400
layouts for displaying a lot of

81
00:02:38,400 --> 00:02:40,560
information like this casio calculator

82
00:02:40,560 --> 00:02:42,160
watch

83
00:02:42,160 --> 00:02:43,920
they're also often thoughtfully designed

84
00:02:43,920 --> 00:02:46,080
by you know actual designers who do this

85
00:02:46,080 --> 00:02:48,080
for a living this makes their designs

86
00:02:48,080 --> 00:02:50,400
nice in a way that industrial lcds often

87
00:02:50,400 --> 00:02:52,160
aren't

88
00:02:52,160 --> 00:02:54,080
they also tend to be thinner and finer

89
00:02:54,080 --> 00:02:56,879
pitched than off-the-shelf lcds the f91w

90
00:02:56,879 --> 00:02:59,360
lcd is sort of staggeringly thin it's

91
00:02:59,360 --> 00:03:01,280
only a millimeter thick and it's small

92
00:03:01,280 --> 00:03:03,040
enough to fit in a 38 millimeter watch

93
00:03:03,040 --> 00:03:05,519
case the finer pitch also allows for

94
00:03:05,519 --> 00:03:07,040
more segments to be addressed in this

95
00:03:07,040 --> 00:03:09,760
already small area

96
00:03:09,760 --> 00:03:11,519
they're also just fun uh here's the

97
00:03:11,519 --> 00:03:12,800
watch here's a watch with the sensor

98
00:03:12,800 --> 00:03:14,640
watch board swap installed i've taken

99
00:03:14,640 --> 00:03:16,800
the f91 w's display which is only meant

100
00:03:16,800 --> 00:03:18,640
to display the time and date and i've

101
00:03:18,640 --> 00:03:19,920
repurposed it to be a temperature

102
00:03:19,920 --> 00:03:23,360
display 76.6 degrees fahrenheit now it's

103
00:03:23,360 --> 00:03:25,519
not perfect the 7 is sort of a shorty

104
00:03:25,519 --> 00:03:27,680
lowercase 7 and the decimal point is a

105
00:03:27,680 --> 00:03:29,360
hyphen since there's no decimal point in

106
00:03:29,360 --> 00:03:30,480
this design

107
00:03:30,480 --> 00:03:31,920
but if you're willing to embrace the

108
00:03:31,920 --> 00:03:33,680
limitations you can take a small

109
00:03:33,680 --> 00:03:35,760
well-designed display and coax it into

110
00:03:35,760 --> 00:03:38,720
doing all kinds of interesting stuff

111
00:03:38,720 --> 00:03:41,440
okay so let's set the agenda today i'm

112
00:03:41,440 --> 00:03:42,720
going to talk about how you can find

113
00:03:42,720 --> 00:03:44,640
these lcds in the wild and bend them to

114
00:03:44,640 --> 00:03:47,280
your will first i'm going to introduce

115
00:03:47,280 --> 00:03:49,440
segment lcd tech show off some of how it

116
00:03:49,440 --> 00:03:51,280
works and explain what's required to

117
00:03:51,280 --> 00:03:54,319
drive very basic lcds

118
00:03:54,319 --> 00:03:55,920
next we're going to look at more complex

119
00:03:55,920 --> 00:03:57,760
lcds through the lens of the classic

120
00:03:57,760 --> 00:03:59,200
wristwatch that i used to build the

121
00:03:59,200 --> 00:04:01,040
sensor watch

122
00:04:01,040 --> 00:04:02,560
then we're going to use what we learned

123
00:04:02,560 --> 00:04:04,879
in sections 1 and 2 to reverse engineer

124
00:04:04,879 --> 00:04:08,000
the lcd in a much more complex watch

125
00:04:08,000 --> 00:04:10,000
and finally if we have time i'm going to

126
00:04:10,000 --> 00:04:11,680
share some of what i learned designing a

127
00:04:11,680 --> 00:04:15,760
custom lcd of my own so that's a lot so

128
00:04:15,760 --> 00:04:17,440
let's jump right into it chapter one

129
00:04:17,440 --> 00:04:19,358
intro the tech

130
00:04:19,358 --> 00:04:20,798
i figured i'd start with the compare and

131
00:04:20,798 --> 00:04:22,479
contrast with the technology a lot of

132
00:04:22,479 --> 00:04:24,160
folks here are probably familiar with

133
00:04:24,160 --> 00:04:25,680
segment leds

134
00:04:25,680 --> 00:04:27,600
on their face they look kind of similar

135
00:04:27,600 --> 00:04:29,520
each segment has a pin and there's also

136
00:04:29,520 --> 00:04:31,360
a common pin so for a seven segment

137
00:04:31,360 --> 00:04:33,040
display like this you'd need to run

138
00:04:33,040 --> 00:04:35,680
eight wires to each digit

139
00:04:35,680 --> 00:04:37,280
i've drawn a diagram here for how that

140
00:04:37,280 --> 00:04:39,040
works and i actually found that i had to

141
00:04:39,040 --> 00:04:41,040
draw two diagrams because you'll always

142
00:04:41,040 --> 00:04:43,040
find that these segment led displays are

143
00:04:43,040 --> 00:04:45,840
either common cathode or common anode

144
00:04:45,840 --> 00:04:47,440
that's because for a segment in the

145
00:04:47,440 --> 00:04:49,840
display to glow current has to flow from

146
00:04:49,840 --> 00:04:52,080
the anode to the cathode it's a complete

147
00:04:52,080 --> 00:04:54,160
dc circuit

148
00:04:54,160 --> 00:04:56,080
you'll still use eight wires with an lcd

149
00:04:56,080 --> 00:04:57,520
but the first difference is in how the

150
00:04:57,520 --> 00:04:59,520
display works current doesn't really

151
00:04:59,520 --> 00:05:02,479
flow anywhere in an lcd instead segments

152
00:05:02,479 --> 00:05:04,080
are energized when a difference in

153
00:05:04,080 --> 00:05:05,759
voltage exists between the common and

154
00:05:05,759 --> 00:05:07,919
the segment electrodes

155
00:05:07,919 --> 00:05:09,680
you can imagine an lcd segment as being

156
00:05:09,680 --> 00:05:11,440
a little capacitor with the special

157
00:05:11,440 --> 00:05:12,800
property that when there's a difference

158
00:05:12,800 --> 00:05:14,400
in charge between the segment pin and

159
00:05:14,400 --> 00:05:16,560
the common pin it will darken and become

160
00:05:16,560 --> 00:05:18,479
opaque

161
00:05:18,479 --> 00:05:20,479
that common pin is neither anode nor

162
00:05:20,479 --> 00:05:22,560
cathode because you drive an lcd with an

163
00:05:22,560 --> 00:05:25,199
alternating signal sometimes com is high

164
00:05:25,199 --> 00:05:27,360
other times it's low lcds don't like a

165
00:05:27,360 --> 00:05:29,440
static charge building up on either side

166
00:05:29,440 --> 00:05:30,880
so you have to alternate the polarity of

167
00:05:30,880 --> 00:05:33,280
the charge what do i mean by that well

168
00:05:33,280 --> 00:05:35,199
here's what it looks like and i beg you

169
00:05:35,199 --> 00:05:36,560
please stick with me through these scope

170
00:05:36,560 --> 00:05:38,000
traces i promise they're going to make

171
00:05:38,000 --> 00:05:39,280
sense by the end

172
00:05:39,280 --> 00:05:41,199
um the voltage differential between the

173
00:05:41,199 --> 00:05:43,199
common and segment pin has to be above a

174
00:05:43,199 --> 00:05:44,880
certain threshold for a segment to turn

175
00:05:44,880 --> 00:05:46,800
dark or energized

176
00:05:46,800 --> 00:05:48,160
typically that's between three and five

177
00:05:48,160 --> 00:05:49,600
volts but let's just go with three for

178
00:05:49,600 --> 00:05:50,400
now

179
00:05:50,400 --> 00:05:52,320
here we're looking at one common pin in

180
00:05:52,320 --> 00:05:55,039
cyan and one segment pin in yellow the

181
00:05:55,039 --> 00:05:58,319
difference between the two is in purple

182
00:05:58,319 --> 00:05:59,840
you can see that when the common and

183
00:05:59,840 --> 00:06:02,080
segment pins get the same square wave

184
00:06:02,080 --> 00:06:03,360
there's no voltage difference and the

185
00:06:03,360 --> 00:06:05,600
segment is not energized

186
00:06:05,600 --> 00:06:07,199
but when the segment pin's wave is

187
00:06:07,199 --> 00:06:08,240
inverted

188
00:06:08,240 --> 00:06:10,319
relative to the common pin suddenly the

189
00:06:10,319 --> 00:06:12,080
voltage differential is plus or minus

190
00:06:12,080 --> 00:06:14,000
three volts that's enough to energize

191
00:06:14,000 --> 00:06:15,680
the segment

192
00:06:15,680 --> 00:06:17,680
the cruxy bit is that this has to be an

193
00:06:17,680 --> 00:06:20,400
ac signal with no dc bias

194
00:06:20,400 --> 00:06:21,840
the frequency will depend on some

195
00:06:21,840 --> 00:06:23,039
factors but don't worry about it too

196
00:06:23,039 --> 00:06:25,360
much for now for now let's give it a

197
00:06:25,360 --> 00:06:27,759
whirl and let's do it really simply this

198
00:06:27,759 --> 00:06:29,360
is a circuit python script and it should

199
00:06:29,360 --> 00:06:31,120
be easy to see what it's doing

200
00:06:31,120 --> 00:06:32,720
it's setting up digital outputs for one

201
00:06:32,720 --> 00:06:35,039
common pin and a bunch of segment pins

202
00:06:35,039 --> 00:06:36,880
as well as a button input

203
00:06:36,880 --> 00:06:39,440
when we loop we repeatedly set com high

204
00:06:39,440 --> 00:06:42,639
and low by toggling this phase variable

205
00:06:42,639 --> 00:06:44,800
if the button is up we set all segments

206
00:06:44,800 --> 00:06:46,720
to the same value as com which gives

207
00:06:46,720 --> 00:06:48,960
them all the same square wave but if the

208
00:06:48,960 --> 00:06:51,360
button is down we set our on pins to the

209
00:06:51,360 --> 00:06:53,280
opposite value giving them the opposite

210
00:06:53,280 --> 00:06:54,560
wave

211
00:06:54,560 --> 00:06:56,319
so let's check it out

212
00:06:56,319 --> 00:06:58,560
um

213
00:07:00,240 --> 00:07:02,319
so here i have my uh metro m4 which i've

214
00:07:02,319 --> 00:07:04,720
set up with this button and uh my wire

215
00:07:04,720 --> 00:07:07,280
is going the display so the com pin i've

216
00:07:07,280 --> 00:07:08,880
actually tied to the led here so you can

217
00:07:08,880 --> 00:07:11,120
see it flashing high and low that's

218
00:07:11,120 --> 00:07:12,639
actually the frequency of the wave we're

219
00:07:12,639 --> 00:07:14,639
feeding this lcd so we're not talking

220
00:07:14,639 --> 00:07:16,720
megahertz or even kilohertz here this is

221
00:07:16,720 --> 00:07:18,160
in the dozens of hertz you can see it

222
00:07:18,160 --> 00:07:19,680
with your eye

223
00:07:19,680 --> 00:07:21,120
so right now they're all getting the

224
00:07:21,120 --> 00:07:22,800
same square wave but when i press the

225
00:07:22,800 --> 00:07:24,800
button it's energizing the segments that

226
00:07:24,800 --> 00:07:26,160
are saying hi

227
00:07:26,160 --> 00:07:27,759
by by inverting the wave on those

228
00:07:27,759 --> 00:07:28,720
segments

229
00:07:28,720 --> 00:07:32,319
um i also have my little uh pocket

230
00:07:32,319 --> 00:07:34,319
oscilloscope here and it's showing the

231
00:07:34,319 --> 00:07:36,000
difference between com and seg which is

232
00:07:36,000 --> 00:07:37,919
zero until i press the button and then

233
00:07:37,919 --> 00:07:41,680
it becomes plus or minus three volts

234
00:07:41,680 --> 00:07:43,120
okay

235
00:07:43,120 --> 00:07:46,080
so that is segment section one

236
00:07:46,080 --> 00:07:47,919
to recap quickly

237
00:07:47,919 --> 00:07:49,840
lcd segments are basically little

238
00:07:49,840 --> 00:07:51,440
capacitors that turn dark when they're

239
00:07:51,440 --> 00:07:52,720
charged

240
00:07:52,720 --> 00:07:54,319
these displays are low power because

241
00:07:54,319 --> 00:07:56,639
current isn't really flowing anywhere

242
00:07:56,639 --> 00:07:58,400
they do need to be driven by an ac

243
00:07:58,400 --> 00:08:00,560
signal this part is important uh the

244
00:08:00,560 --> 00:08:02,080
astute viewer might be thinking hey i

245
00:08:02,080 --> 00:08:04,000
could energize a segment by holding comm

246
00:08:04,000 --> 00:08:06,400
low and seg high and that is true you

247
00:08:06,400 --> 00:08:08,560
could but it'll break your lcd after a

248
00:08:08,560 --> 00:08:11,199
while so don't do that

249
00:08:11,199 --> 00:08:13,520
finally the key is to keep the driving

250
00:08:13,520 --> 00:08:15,440
voltage across the segment below the

251
00:08:15,440 --> 00:08:17,440
threshold to turn the segment off and

252
00:08:17,440 --> 00:08:19,199
above the threshold to turn the segment

253
00:08:19,199 --> 00:08:20,080
on

254
00:08:20,080 --> 00:08:22,319
keep that in mind as we move right along

255
00:08:22,319 --> 00:08:25,280
to section two multiplexed displays

256
00:08:25,280 --> 00:08:27,360
so at this point you should have the

257
00:08:27,360 --> 00:08:29,199
gist of how lcds work

258
00:08:29,199 --> 00:08:30,960
now we're going to take these basics and

259
00:08:30,960 --> 00:08:33,200
apply them to a more complex display the

260
00:08:33,200 --> 00:08:35,120
display on our dear friend the casio

261
00:08:35,120 --> 00:08:36,799
f91w

262
00:08:36,799 --> 00:08:38,799
so you'll notice there are a lot of

263
00:08:38,799 --> 00:08:40,719
segments on the left there they're all

264
00:08:40,719 --> 00:08:42,399
driven by the row of pins on the top of

265
00:08:42,399 --> 00:08:44,399
that green circuit board but there are a

266
00:08:44,399 --> 00:08:46,480
lot more segments than pins which begs

267
00:08:46,480 --> 00:08:47,680
the question

268
00:08:47,680 --> 00:08:49,760
how do they pull that off what gives and

269
00:08:49,760 --> 00:08:52,560
the answer is lcd multiplexing so in

270
00:08:52,560 --> 00:08:54,560
short where that screen from our demo

271
00:08:54,560 --> 00:08:57,680
had one common backflame the f91w's lcd

272
00:08:57,680 --> 00:08:59,120
has three

273
00:08:59,120 --> 00:09:00,880
that means three common pins and the

274
00:09:00,880 --> 00:09:04,160
rest 24 of them are segment pins

275
00:09:04,160 --> 00:09:06,080
whereas in the demo the comm pin was

276
00:09:06,080 --> 00:09:07,920
linked to all of the segments in this

277
00:09:07,920 --> 00:09:09,920
watch each common only touches about a

278
00:09:09,920 --> 00:09:12,560
third of touches a third of the segments

279
00:09:12,560 --> 00:09:14,399
and whereas in our demo each segment pin

280
00:09:14,399 --> 00:09:16,080
was linked to one segment in this

281
00:09:16,080 --> 00:09:18,240
display each segment line is linked to

282
00:09:18,240 --> 00:09:19,920
three

283
00:09:19,920 --> 00:09:21,440
the important thing here is that each

284
00:09:21,440 --> 00:09:22,640
segment that you want to address

285
00:09:22,640 --> 00:09:24,800
individually will have a unique common

286
00:09:24,800 --> 00:09:26,640
segment mapping

287
00:09:26,640 --> 00:09:28,560
okay so yeah i admit that diagram was a

288
00:09:28,560 --> 00:09:30,399
lot to take in to make it easier on

289
00:09:30,399 --> 00:09:32,560
ourselves let's consider one segment in

290
00:09:32,560 --> 00:09:34,240
isolation

291
00:09:34,240 --> 00:09:36,480
this is segment a of the last digit in

292
00:09:36,480 --> 00:09:38,800
the clock which ticks the seconds we

293
00:09:38,800 --> 00:09:41,360
would call this com2 seg19 just

294
00:09:41,360 --> 00:09:42,640
numbering each pin from the left to

295
00:09:42,640 --> 00:09:44,080
right

296
00:09:44,080 --> 00:09:46,080
you'll see that while com2 is linked to

297
00:09:46,080 --> 00:09:48,240
a whole lot of segments 24 of them all

298
00:09:48,240 --> 00:09:51,120
tinted in red seg19 is only linked to

299
00:09:51,120 --> 00:09:53,440
the three segments tinted in blue

300
00:09:53,440 --> 00:09:55,600
only the purple segment segment a of the

301
00:09:55,600 --> 00:09:58,240
seconds display is linked to both com2

302
00:09:58,240 --> 00:10:00,800
and seg19 and that's the key to how we

303
00:10:00,800 --> 00:10:03,600
can address it individually

304
00:10:03,600 --> 00:10:05,600
so before we do this ourselves let's see

305
00:10:05,600 --> 00:10:08,399
how the f91w energizes this segment

306
00:10:08,399 --> 00:10:10,160
since the watch ticks once a second from

307
00:10:10,160 --> 00:10:12,000
zero to nine this top segment will be

308
00:10:12,000 --> 00:10:14,399
energized and de-energized fairly often

309
00:10:14,399 --> 00:10:16,079
it's off when displaying the digits one

310
00:10:16,079 --> 00:10:18,000
and four and it's on the rest of the

311
00:10:18,000 --> 00:10:18,959
time

312
00:10:18,959 --> 00:10:21,200
we're going to use a 1990s era tektronix

313
00:10:21,200 --> 00:10:24,240
2211 scope to visualize how the f91w

314
00:10:24,240 --> 00:10:26,320
achieves this

315
00:10:26,320 --> 00:10:27,279
so

316
00:10:27,279 --> 00:10:29,839
here i have my uh f91w movement plugged

317
00:10:29,839 --> 00:10:32,000
into these oscilloscope probes and the

318
00:10:32,000 --> 00:10:34,399
scope is showing us com2 up top and

319
00:10:34,399 --> 00:10:36,399
seg-19 on the bottom

320
00:10:36,399 --> 00:10:37,760
so

321
00:10:37,760 --> 00:10:40,160
com2 seg19

322
00:10:40,160 --> 00:10:42,399
technically that's the inverse of seg19

323
00:10:42,399 --> 00:10:44,640
but uh bear with me for a moment so

324
00:10:44,640 --> 00:10:46,079
the interesting part comes when we

325
00:10:46,079 --> 00:10:49,040
subtract seg19 from com2

326
00:10:49,040 --> 00:10:50,800
so now we're seeing a lot of different

327
00:10:50,800 --> 00:10:53,040
waves but the key is that there's really

328
00:10:53,040 --> 00:10:55,200
two peak voltages plus or minus three

329
00:10:55,200 --> 00:10:58,240
volts and plus or minus 1.5 volts

330
00:10:58,240 --> 00:11:00,959
okay so

331
00:11:00,959 --> 00:11:02,560
what did we see here and what can we

332
00:11:02,560 --> 00:11:04,240
learn from it

333
00:11:04,240 --> 00:11:06,720
first right at the outset we saw the two

334
00:11:06,720 --> 00:11:08,959
waveforms separately we saw that the com

335
00:11:08,959 --> 00:11:10,959
waveform didn't change at all it's just

336
00:11:10,959 --> 00:11:12,399
delivering three voltage levels

337
00:11:12,399 --> 00:11:14,000
repeatedly

338
00:11:14,000 --> 00:11:16,000
we also saw the segway form with just

339
00:11:16,000 --> 00:11:17,760
two voltage levels and that it changes

340
00:11:17,760 --> 00:11:19,839
from time to time

341
00:11:19,839 --> 00:11:21,839
next when we subtracted one from the

342
00:11:21,839 --> 00:11:24,079
other we saw several different waveforms

343
00:11:24,079 --> 00:11:26,240
but really two peak voltages plus or

344
00:11:26,240 --> 00:11:28,959
minus three volts and plus or minus 1.5

345
00:11:28,959 --> 00:11:31,120
volts this tells us the voltage we need

346
00:11:31,120 --> 00:11:33,200
to energize a segment this is a 3 volt

347
00:11:33,200 --> 00:11:35,120
display

348
00:11:35,120 --> 00:11:37,040
so you might be asking yourself in that

349
00:11:37,040 --> 00:11:39,120
middle photo the segment only hits 3

350
00:11:39,120 --> 00:11:40,800
volts about a third of the time why is

351
00:11:40,800 --> 00:11:42,480
that what about those other moments in

352
00:11:42,480 --> 00:11:44,000
between the plus or minus three volt

353
00:11:44,000 --> 00:11:46,560
peaks and the answer is those are time

354
00:11:46,560 --> 00:11:48,959
slots for the other segments remember

355
00:11:48,959 --> 00:11:51,279
sega 19 is controlling three segments on

356
00:11:51,279 --> 00:11:53,120
this watch and we're only looking at it

357
00:11:53,120 --> 00:11:55,200
in relation to com2

358
00:11:55,200 --> 00:11:57,760
0 and com1 are also doing their thing

359
00:11:57,760 --> 00:11:59,839
and plotting 719 against each of those

360
00:11:59,839 --> 00:12:02,399
would yield a different trace

361
00:12:02,399 --> 00:12:05,120
so our workshop the prepared also has a

362
00:12:05,120 --> 00:12:07,040
more modern scope with four inputs and

363
00:12:07,040 --> 00:12:08,639
we can use that to visualize the waves

364
00:12:08,639 --> 00:12:10,959
in more detail here we have our segment

365
00:12:10,959 --> 00:12:14,240
19 waveform in yellow and our com0 com1

366
00:12:14,240 --> 00:12:17,920
and com2 waveforms in cyan pink and blue

367
00:12:17,920 --> 00:12:19,200
it's actually easier to see this if i

368
00:12:19,200 --> 00:12:21,360
stack up all the comm signals so

369
00:12:21,360 --> 00:12:23,360
looking at the top there you can see six

370
00:12:23,360 --> 00:12:25,200
distinct phases in the period of this

371
00:12:25,200 --> 00:12:26,160
wave

372
00:12:26,160 --> 00:12:28,480
com zero has a beat at three volts then

373
00:12:28,480 --> 00:12:30,720
two beats at one point five volts a beat

374
00:12:30,720 --> 00:12:32,639
at zero volts two more beats at one

375
00:12:32,639 --> 00:12:34,240
point and then and then two more beats

376
00:12:34,240 --> 00:12:36,079
at one point five volts

377
00:12:36,079 --> 00:12:38,000
basically over the course of the wave

378
00:12:38,000 --> 00:12:39,839
each com signal has a chance to be at

379
00:12:39,839 --> 00:12:42,560
its maximum and minimum value once

380
00:12:42,560 --> 00:12:44,480
and the other signals hang out at 1.5

381
00:12:44,480 --> 00:12:48,399
volts in between to give them their turn

382
00:12:48,399 --> 00:12:49,519
this is how we're going to get to the

383
00:12:49,519 --> 00:12:52,639
key terms for this slide duty and bias

384
00:12:52,639 --> 00:12:54,560
with three comm lines we have three

385
00:12:54,560 --> 00:12:56,240
chances for each common to hit its

386
00:12:56,240 --> 00:12:58,560
maximum and minimum voltages that makes

387
00:12:58,560 --> 00:13:01,040
this a one-third duty waveform not

388
00:13:01,040 --> 00:13:02,880
coincidentally that corresponds to the

389
00:13:02,880 --> 00:13:05,519
number of comp pins that we have

390
00:13:05,519 --> 00:13:07,519
bias refers to the intermediate voltage

391
00:13:07,519 --> 00:13:09,680
level involved in driving the lcd

392
00:13:09,680 --> 00:13:11,519
looking at the common waveforms up top

393
00:13:11,519 --> 00:13:14,079
you can see three voltage levels 0 volts

394
00:13:14,079 --> 00:13:17,680
1.5 volts and 3 volts that 1.5 volts

395
00:13:17,680 --> 00:13:19,839
makes this a one-half bias waveform

396
00:13:19,839 --> 00:13:21,920
three volts divided two ways

397
00:13:21,920 --> 00:13:23,440
if you had intermediate steps of one

398
00:13:23,440 --> 00:13:25,040
volt and two volts it would be a

399
00:13:25,040 --> 00:13:27,120
one-third bias waveform as in three

400
00:13:27,120 --> 00:13:29,839
volts divided three ways

401
00:13:29,839 --> 00:13:31,760
these two terms combine to describe the

402
00:13:31,760 --> 00:13:33,839
waveform one third duty refers to the

403
00:13:33,839 --> 00:13:36,079
number of comp pins and one-half bias

404
00:13:36,079 --> 00:13:38,160
refers to the single 1.5 volt bias

405
00:13:38,160 --> 00:13:41,839
voltage in between 0 and the lcd voltage

406
00:13:41,839 --> 00:13:43,600
the line in purple again is showing us

407
00:13:43,600 --> 00:13:45,120
the difference between an on state and

408
00:13:45,120 --> 00:13:46,880
an off state for this segment looking at

409
00:13:46,880 --> 00:13:48,399
com 0 this time

410
00:13:48,399 --> 00:13:50,079
the important thing to note is the com

411
00:13:50,079 --> 00:13:52,240
waveforms never change look at the state

412
00:13:52,240 --> 00:13:54,000
of the yellow seg wave right after that

413
00:13:54,000 --> 00:13:56,079
first cursor in that trace at the top

414
00:13:56,079 --> 00:13:58,399
it's high when com 0 is high which adds

415
00:13:58,399 --> 00:14:01,199
it to 0 volts segment off

416
00:14:01,199 --> 00:14:03,920
when com 0 goes to 1.5 volts no matter

417
00:14:03,920 --> 00:14:06,079
what seg19 is doing the difference

418
00:14:06,079 --> 00:14:08,399
between the two can't be more than 1.5

419
00:14:08,399 --> 00:14:09,279
volts

420
00:14:09,279 --> 00:14:10,959
that's something but it's not nearly

421
00:14:10,959 --> 00:14:12,800
enough to hit that three volt threshold

422
00:14:12,800 --> 00:14:14,839
so the segment again remains

423
00:14:14,839 --> 00:14:17,120
off now look at it in the trace at the

424
00:14:17,120 --> 00:14:19,760
bottom the segment line here is low when

425
00:14:19,760 --> 00:14:21,600
com zero is high which adds up to

426
00:14:21,600 --> 00:14:24,399
negative three volts segment on

427
00:14:24,399 --> 00:14:26,480
this same process is repeating two beats

428
00:14:26,480 --> 00:14:28,560
later with the opposite polarity it's

429
00:14:28,560 --> 00:14:30,240
also happening the whole time with the

430
00:14:30,240 --> 00:14:32,480
segments attached to com1 and com2

431
00:14:32,480 --> 00:14:35,440
during com0's 1.5 volt phase so each of

432
00:14:35,440 --> 00:14:37,440
those segments connected to seg19 are

433
00:14:37,440 --> 00:14:39,519
getting their own unique waveforms that

434
00:14:39,519 --> 00:14:41,120
can turn these segments on and off

435
00:14:41,120 --> 00:14:43,519
independently

436
00:14:43,519 --> 00:14:45,600
so i added this slide late but uh i

437
00:14:45,600 --> 00:14:47,040
realized you might be looking at this

438
00:14:47,040 --> 00:14:48,160
and thinking how am i supposed to

439
00:14:48,160 --> 00:14:49,519
generate all these waveforms and bias

440
00:14:49,519 --> 00:14:51,519
voltages anyway this seems complicated

441
00:14:51,519 --> 00:14:53,519
well the good news is if you pick a

442
00:14:53,519 --> 00:14:55,360
microcontroller with an integrated lcd

443
00:14:55,360 --> 00:14:57,519
driver all this hard work is done for

444
00:14:57,519 --> 00:14:59,279
you this is the data sheet for my

445
00:14:59,279 --> 00:15:01,120
current favorite microcontroller the sam

446
00:15:01,120 --> 00:15:03,519
l22 from microchip it's a lot like the

447
00:15:03,519 --> 00:15:06,320
sam d21 but it has an lcd driver that's

448
00:15:06,320 --> 00:15:08,320
fluent in the language of segment lcd

449
00:15:08,320 --> 00:15:09,680
class

450
00:15:09,680 --> 00:15:11,519
so if you use a chip like this instead

451
00:15:11,519 --> 00:15:12,959
of trying to figure out how to generate

452
00:15:12,959 --> 00:15:14,240
a waveform that turns off all of your

453
00:15:14,240 --> 00:15:15,839
segments you can just write directly to

454
00:15:15,839 --> 00:15:17,600
display memory

455
00:15:17,600 --> 00:15:19,440
or if you want to go one level further

456
00:15:19,440 --> 00:15:21,120
you can use vendor driver code that

457
00:15:21,120 --> 00:15:22,959
abstracts even that away and lets you

458
00:15:22,959 --> 00:15:24,720
deal with the lcd using function calls

459
00:15:24,720 --> 00:15:27,600
like a civilized human

460
00:15:27,600 --> 00:15:28,959
it's pretty cool to drive both your

461
00:15:28,959 --> 00:15:30,880
logic and your display with one chip and

462
00:15:30,880 --> 00:15:32,720
while this list isn't exhaustive there's

463
00:15:32,720 --> 00:15:33,839
definitely a fair number of

464
00:15:33,839 --> 00:15:35,519
microcontrollers out there that you can

465
00:15:35,519 --> 00:15:37,600
use to drive an lcd without getting your

466
00:15:37,600 --> 00:15:39,120
hands dirty

467
00:15:39,120 --> 00:15:41,600
okay so here's a question how exactly do

468
00:15:41,600 --> 00:15:43,040
you need to be with this like the

469
00:15:43,040 --> 00:15:44,800
waveforms we were looking at do we have

470
00:15:44,800 --> 00:15:46,639
to replicate that waveform exactly to

471
00:15:46,639 --> 00:15:49,360
drive this lcd glass and the answer is

472
00:15:49,360 --> 00:15:50,800
not necessarily

473
00:15:50,800 --> 00:15:53,199
this lcd glass is a pretty simple thing

474
00:15:53,199 --> 00:15:55,519
the sam l22 likes to drive a one-third

475
00:15:55,519 --> 00:15:57,600
duty displays with a one-third bias

476
00:15:57,600 --> 00:15:58,959
waveform which again involves

477
00:15:58,959 --> 00:16:00,720
intermediate voltages of one and two

478
00:16:00,720 --> 00:16:03,360
instead of 1.5 this display glass was

479
00:16:03,360 --> 00:16:05,519
perfectly happy with that

480
00:16:05,519 --> 00:16:07,360
again the key points are to drive the

481
00:16:07,360 --> 00:16:09,199
segment above its threshold to energize

482
00:16:09,199 --> 00:16:10,800
it to keep it below its threshold to

483
00:16:10,800 --> 00:16:13,360
turn it off and to avoid any dc bias in

484
00:16:13,360 --> 00:16:15,759
the waveform the sam l22 with its

485
00:16:15,759 --> 00:16:18,000
integrated segment lcd driver is easily

486
00:16:18,000 --> 00:16:21,199
able to check all of these boxes

487
00:16:21,199 --> 00:16:23,519
okay we'll recap later for now we're

488
00:16:23,519 --> 00:16:25,600
rolling right along into section three

489
00:16:25,600 --> 00:16:27,279
we've covered the basics of lcd

490
00:16:27,279 --> 00:16:28,880
technology and we've talked about how

491
00:16:28,880 --> 00:16:30,480
complex displays use different

492
00:16:30,480 --> 00:16:32,639
multiplexing schemes to drive displays

493
00:16:32,639 --> 00:16:34,959
with more segments than pins let's take

494
00:16:34,959 --> 00:16:36,800
those lessons and apply them to another

495
00:16:36,800 --> 00:16:40,000
casio watch the casio databank this is a

496
00:16:40,000 --> 00:16:41,680
really cool watch with a lot of segments

497
00:16:41,680 --> 00:16:43,600
and a lot of buttons it would be a blank

498
00:16:43,600 --> 00:16:45,519
canvas for displaying all kinds of cool

499
00:16:45,519 --> 00:16:47,519
information if we could figure out how

500
00:16:47,519 --> 00:16:49,360
to drive it so let's figure out how to

501
00:16:49,360 --> 00:16:50,639
drive it

502
00:16:50,639 --> 00:16:52,639
but first let's take it apart what do we

503
00:16:52,639 --> 00:16:54,959
see inside well we have a back plate and

504
00:16:54,959 --> 00:16:57,120
a rubber gasket and then a circuit board

505
00:16:57,120 --> 00:16:58,800
sandwiched in between two assemblies one

506
00:16:58,800 --> 00:17:02,000
for the battery and one for the display

507
00:17:02,000 --> 00:17:04,480
the circuit board itself has 55 exposed

508
00:17:04,480 --> 00:17:07,839
lcd pads 28 in the top row and 27 in the

509
00:17:07,839 --> 00:17:09,520
bottom

510
00:17:09,520 --> 00:17:11,199
finally we glossed over this point

511
00:17:11,199 --> 00:17:12,799
earlier but i do want to point out the

512
00:17:12,799 --> 00:17:15,039
two elastomer strips sitting in the lcd

513
00:17:15,039 --> 00:17:16,400
assembly

514
00:17:16,400 --> 00:17:18,000
these are commonly called zebra strip

515
00:17:18,000 --> 00:17:19,919
connectors and they're the way the lcd

516
00:17:19,919 --> 00:17:22,559
actually connects to the circuit board

517
00:17:22,559 --> 00:17:23,679
i do want to stop here for a quick

518
00:17:23,679 --> 00:17:25,599
detour on these elastomer strips because

519
00:17:25,599 --> 00:17:27,760
if you do try to upcycle an lcd you're

520
00:17:27,760 --> 00:17:29,840
almost certainly going to run into them

521
00:17:29,840 --> 00:17:31,440
these are called zebra strips because

522
00:17:31,440 --> 00:17:34,080
they have many conductive stripes

523
00:17:34,080 --> 00:17:35,520
you might also see them referred to as

524
00:17:35,520 --> 00:17:37,120
ledge connectors since they mash up

525
00:17:37,120 --> 00:17:38,480
against the ledge of glass with the

526
00:17:38,480 --> 00:17:40,080
electrodes which you can see reflected

527
00:17:40,080 --> 00:17:41,760
there in the glass

528
00:17:41,760 --> 00:17:43,360
the idea here is that your display's

529
00:17:43,360 --> 00:17:45,280
electrodes have the exact same spacing

530
00:17:45,280 --> 00:17:47,280
as the pads on your pcb

531
00:17:47,280 --> 00:17:49,120
and the zebra strip is way denser so

532
00:17:49,120 --> 00:17:50,880
when it gets squished in between there

533
00:17:50,880 --> 00:17:52,480
will be at least a few stripes making

534
00:17:52,480 --> 00:17:54,000
contact which makes a vertical

535
00:17:54,000 --> 00:17:55,520
connection between the board and the

536
00:17:55,520 --> 00:17:56,880
glass

537
00:17:56,880 --> 00:17:58,960
they do require very precise alignment

538
00:17:58,960 --> 00:18:00,640
especially for a fine pitched lcd like

539
00:18:00,640 --> 00:18:02,640
the one in the wrist watch but on the

540
00:18:02,640 --> 00:18:04,640
plus side any gadget that uses this

541
00:18:04,640 --> 00:18:06,400
technology is going to come with a strip

542
00:18:06,400 --> 00:18:08,160
that works and hopefully an enclosure

543
00:18:08,160 --> 00:18:10,240
that holds it in place precisely

544
00:18:10,240 --> 00:18:13,039
just don't lose it

545
00:18:13,039 --> 00:18:15,679
okay back on track um let's reverse

546
00:18:15,679 --> 00:18:18,080
engineer this databank lcd to do it

547
00:18:18,080 --> 00:18:19,919
we're going to need some tools scissors

548
00:18:19,919 --> 00:18:22,559
an oscilloscope and blue painters tape

549
00:18:22,559 --> 00:18:24,160
actually later on i reshot some of this

550
00:18:24,160 --> 00:18:25,840
with kapton tape but you can just use

551
00:18:25,840 --> 00:18:27,280
plain scotch tape all we're doing is

552
00:18:27,280 --> 00:18:29,120
taping over one pad to break the

553
00:18:29,120 --> 00:18:30,799
connection between the lcd glass and the

554
00:18:30,799 --> 00:18:32,160
pcb

555
00:18:32,160 --> 00:18:33,919
why are we doing this well we're doing

556
00:18:33,919 --> 00:18:35,120
this because some of these pins are

557
00:18:35,120 --> 00:18:37,039
common pins and some of them are segment

558
00:18:37,039 --> 00:18:39,200
pins and before we do anything else

559
00:18:39,200 --> 00:18:40,640
we're going to have to figure out which

560
00:18:40,640 --> 00:18:42,880
ones are which

561
00:18:42,880 --> 00:18:45,120
so with this one leftmost pin covered up

562
00:18:45,120 --> 00:18:47,120
we reassemble the watch and we get this

563
00:18:47,120 --> 00:18:49,280
screen which looks pretty similar not

564
00:18:49,280 --> 00:18:51,520
much has changed but there's a sneak

565
00:18:51,520 --> 00:18:53,760
trick with a lot of casio watches if you

566
00:18:53,760 --> 00:18:55,440
press both left buttons and the bottom

567
00:18:55,440 --> 00:18:59,039
right button at the same time oops

568
00:19:01,120 --> 00:19:03,120
there we go you can turn on all the

569
00:19:03,120 --> 00:19:04,640
segments in the watch

570
00:19:04,640 --> 00:19:06,880
when we do that we can see that we lost

571
00:19:06,880 --> 00:19:08,720
five segments two of them in the dot

572
00:19:08,720 --> 00:19:10,799
matrix and three down there in that year

573
00:19:10,799 --> 00:19:12,720
display which brings us to the first

574
00:19:12,720 --> 00:19:14,160
guideline for reverse engineering these

575
00:19:14,160 --> 00:19:16,480
things if a few segments turned off when

576
00:19:16,480 --> 00:19:18,799
you covered a pad you've found a segment

577
00:19:18,799 --> 00:19:19,679
line

578
00:19:19,679 --> 00:19:21,200
this should make sense if you recall our

579
00:19:21,200 --> 00:19:23,039
diagram from earlier

580
00:19:23,039 --> 00:19:25,280
the comm line sweeps across a vast swath

581
00:19:25,280 --> 00:19:27,520
of the display but the seg line only

582
00:19:27,520 --> 00:19:29,440
touches as many segments as there are

583
00:19:29,440 --> 00:19:31,280
comm lines

584
00:19:31,280 --> 00:19:33,039
the fact that we lost five segments when

585
00:19:33,039 --> 00:19:35,679
we covered this pin strongly hints to me

586
00:19:35,679 --> 00:19:37,840
that there are five comm lines it's not

587
00:19:37,840 --> 00:19:39,760
a guarantee sometimes segments can be

588
00:19:39,760 --> 00:19:41,600
shared but that is my suspicion at this

589
00:19:41,600 --> 00:19:42,799
point

590
00:19:42,799 --> 00:19:45,120
okay moving on let's try covering up one

591
00:19:45,120 --> 00:19:46,799
pin on the opposite side of the board

592
00:19:46,799 --> 00:19:48,160
what happens then

593
00:19:48,160 --> 00:19:50,559
answer we lose a ton of segments which

594
00:19:50,559 --> 00:19:52,559
brings us to the second guideline if a

595
00:19:52,559 --> 00:19:53,919
lot of segments turned off when you

596
00:19:53,919 --> 00:19:56,480
covered a pad you've found a common line

597
00:19:56,480 --> 00:19:58,080
this should follow from the diagram but

598
00:19:58,080 --> 00:20:00,160
let's just throw it on screen again

599
00:20:00,160 --> 00:20:02,159
the comm line intersects with as many

600
00:20:02,159 --> 00:20:04,320
segments as there are seg pins so if we

601
00:20:04,320 --> 00:20:06,320
had five comm lines we'd expect losing

602
00:20:06,320 --> 00:20:08,080
one to lose us about a fifth of the

603
00:20:08,080 --> 00:20:09,520
segments

604
00:20:09,520 --> 00:20:11,120
okay so now i'm just gonna start

605
00:20:11,120 --> 00:20:12,480
covering up pads on the right side of

606
00:20:12,480 --> 00:20:14,080
the board here it is with one pin

607
00:20:14,080 --> 00:20:15,120
covered

608
00:20:15,120 --> 00:20:16,960
and covering a second one again we lose

609
00:20:16,960 --> 00:20:18,559
a big chunk of the display this is

610
00:20:18,559 --> 00:20:20,559
another comm line

611
00:20:20,559 --> 00:20:22,559
third pin another 20 of the display is

612
00:20:22,559 --> 00:20:23,840
gone

613
00:20:23,840 --> 00:20:26,799
fourth pin only 50 segments remain 34 in

614
00:20:26,799 --> 00:20:30,480
the dot matrix and 16 down at the bottom

615
00:20:30,480 --> 00:20:32,320
and with five pins covered the whole

616
00:20:32,320 --> 00:20:35,760
display goes blank so get this by

617
00:20:35,760 --> 00:20:37,600
covering five pads with plain old scotch

618
00:20:37,600 --> 00:20:39,360
tape we've discovered not just which

619
00:20:39,360 --> 00:20:41,360
pins are the commons but also half of

620
00:20:41,360 --> 00:20:43,200
the segment mapping because if you look

621
00:20:43,200 --> 00:20:44,960
at the segments that were left when only

622
00:20:44,960 --> 00:20:47,200
that last com was working com0 again

623
00:20:47,200 --> 00:20:49,520
numbering from left to right uh we know

624
00:20:49,520 --> 00:20:51,200
all of those red segments must be

625
00:20:51,200 --> 00:20:53,679
attached to com zero working backwards

626
00:20:53,679 --> 00:20:55,200
based on when we saw the segments turn

627
00:20:55,200 --> 00:20:57,520
off we have all of the com lines mapped

628
00:20:57,520 --> 00:20:59,200
out

629
00:20:59,200 --> 00:21:00,960
moreover we can combine that with what

630
00:21:00,960 --> 00:21:02,880
we saw when we taped off the top left

631
00:21:02,880 --> 00:21:05,280
pin seg0 again numbering from left to

632
00:21:05,280 --> 00:21:06,080
right

633
00:21:06,080 --> 00:21:08,080
and we now have full segment addresses

634
00:21:08,080 --> 00:21:09,919
for five segments of the display those

635
00:21:09,919 --> 00:21:11,520
two in the matrix and the three on that

636
00:21:11,520 --> 00:21:13,440
bottom row

637
00:21:13,440 --> 00:21:15,280
so there's one last step to know how to

638
00:21:15,280 --> 00:21:16,960
drive this display and that's to figure

639
00:21:16,960 --> 00:21:18,640
out the voltage required to turn on a

640
00:21:18,640 --> 00:21:19,600
segment

641
00:21:19,600 --> 00:21:21,280
we'll use the scope for that but before

642
00:21:21,280 --> 00:21:23,200
we do i find it helps to locate one

643
00:21:23,200 --> 00:21:25,760
segment that toggles fairly often

644
00:21:25,760 --> 00:21:27,520
ideally i'd like to find a segment in

645
00:21:27,520 --> 00:21:29,679
the ones place of the seconds display

646
00:21:29,679 --> 00:21:31,280
since all of them change at least once

647
00:21:31,280 --> 00:21:33,520
every 10 seconds

648
00:21:33,520 --> 00:21:35,280
in this case i just had a lucky guess i

649
00:21:35,280 --> 00:21:36,640
just taped off one of the pads on the

650
00:21:36,640 --> 00:21:38,320
right and it was the one that controlled

651
00:21:38,320 --> 00:21:41,360
the seconds display so with that

652
00:21:41,360 --> 00:21:43,520
to the scope

653
00:21:43,520 --> 00:21:45,440
um i really wanted to do this piece live

654
00:21:45,440 --> 00:21:46,799
but it's a bit fiddly to keep the

655
00:21:46,799 --> 00:21:48,480
movement clip down while measuring so i

656
00:21:48,480 --> 00:21:50,159
have it on video but if you look at the

657
00:21:50,159 --> 00:21:51,919
scope traces the key is that you can see

658
00:21:51,919 --> 00:21:53,679
the peak to peak voltage of the com and

659
00:21:53,679 --> 00:21:55,360
the seg pins and you can also see the

660
00:21:55,360 --> 00:21:57,520
purple waveform changing de-energizing

661
00:21:57,520 --> 00:21:59,440
the segment from time to time so we know

662
00:21:59,440 --> 00:22:02,240
we're on the right track

663
00:22:02,240 --> 00:22:04,159
okay so what do we what did we learn

664
00:22:04,159 --> 00:22:06,240
from this well we know the duty is

665
00:22:06,240 --> 00:22:07,919
one-fifth because there are five comp

666
00:22:07,919 --> 00:22:10,880
pins we also see three non-zero voltages

667
00:22:10,880 --> 00:22:13,919
making this a one-third bias waveform

668
00:22:13,919 --> 00:22:15,679
the most important thing though is we

669
00:22:15,679 --> 00:22:17,360
were able to measure the peak-to-peak

670
00:22:17,360 --> 00:22:19,520
voltage on the com and the seg pins and

671
00:22:19,520 --> 00:22:21,760
it looks like just about 4.1 volts i

672
00:22:21,760 --> 00:22:22,960
actually measured this again later with

673
00:22:22,960 --> 00:22:25,039
a full battery and got 4.5 volts but

674
00:22:25,039 --> 00:22:27,280
either way it means my favorite lcd

675
00:22:27,280 --> 00:22:29,840
oriented microcontroller the sam l22

676
00:22:29,840 --> 00:22:32,000
can't drive this display since it maxes

677
00:22:32,000 --> 00:22:34,000
out at 3.6 volts

678
00:22:34,000 --> 00:22:35,679
but that doesn't mean it's impossible

679
00:22:35,679 --> 00:22:36,799
i'm going to throw up that list from

680
00:22:36,799 --> 00:22:38,159
earlier the one that showed chips with

681
00:22:38,159 --> 00:22:40,880
built-in lcd drivers and i get the sense

682
00:22:40,880 --> 00:22:43,280
that this pic16 has the oomph required

683
00:22:43,280 --> 00:22:45,679
to drive a four four and a half volt lcd

684
00:22:45,679 --> 00:22:47,280
with 53 pins it might not be able to

685
00:22:47,280 --> 00:22:49,120
drive all of the segments but you could

686
00:22:49,120 --> 00:22:51,360
get pretty dang close

687
00:22:51,360 --> 00:22:53,520
okay so let's recap this back third of

688
00:22:53,520 --> 00:22:54,799
the talk

689
00:22:54,799 --> 00:22:56,960
we talked about multiplex lcds and

690
00:22:56,960 --> 00:22:58,320
addressing them by their common and

691
00:22:58,320 --> 00:22:59,919
segment pins

692
00:22:59,919 --> 00:23:01,360
we looked at some of the waveforms that

693
00:23:01,360 --> 00:23:03,360
drive these multiplexed lcds and we

694
00:23:03,360 --> 00:23:06,000
talked about how duty and bias work

695
00:23:06,000 --> 00:23:07,520
we talked about microcontrollers with

696
00:23:07,520 --> 00:23:09,840
lcd drivers that can help wave away some

697
00:23:09,840 --> 00:23:11,679
of these complexities

698
00:23:11,679 --> 00:23:13,679
but we also saw how understanding these

699
00:23:13,679 --> 00:23:15,760
concepts gives us the ability to poke at

700
00:23:15,760 --> 00:23:18,000
lcds in the wild and understand how they

701
00:23:18,000 --> 00:23:19,840
work

702
00:23:19,840 --> 00:23:22,320
so it looks like we have time so this is

703
00:23:22,320 --> 00:23:24,080
the bonus round in which your speaker

704
00:23:24,080 --> 00:23:25,600
discovers that it's actually not that

705
00:23:25,600 --> 00:23:27,840
impossible to have your own segment lcd

706
00:23:27,840 --> 00:23:29,760
manufactured

707
00:23:29,760 --> 00:23:32,000
this is the sensor watch dev board it's

708
00:23:32,000 --> 00:23:33,840
in a feather form factor and if that if

709
00:23:33,840 --> 00:23:35,840
that lcd layout looks familiar there's a

710
00:23:35,840 --> 00:23:38,320
reason it's specifically designed to

711
00:23:38,320 --> 00:23:40,799
match the pin out and layout of the f91w

712
00:23:40,799 --> 00:23:42,720
lcd

713
00:23:42,720 --> 00:23:45,200
why do a custom lcd well the answer will

714
00:23:45,200 --> 00:23:47,039
vary from project to project but in my

715
00:23:47,039 --> 00:23:49,120
case i needed something specific i

716
00:23:49,120 --> 00:23:50,720
wanted to make a board whose display

717
00:23:50,720 --> 00:23:52,480
matched the one on the sensor watch so

718
00:23:52,480 --> 00:23:54,559
folks could test their apps more easily

719
00:23:54,559 --> 00:23:56,000
to do that i needed a screen that

720
00:23:56,000 --> 00:23:58,720
matched the f91ws

721
00:23:58,720 --> 00:24:00,799
you may also have design constraints in

722
00:24:00,799 --> 00:24:03,679
my case the existing f91w lcd was too

723
00:24:03,679 --> 00:24:05,919
small too thin and too fragile for this

724
00:24:05,919 --> 00:24:08,480
application i tried it it barely worked

725
00:24:08,480 --> 00:24:11,039
i almost crushed it to death

726
00:24:11,039 --> 00:24:12,960
um this also only makes sense if you

727
00:24:12,960 --> 00:24:14,799
want to make a lot of them so there's an

728
00:24:14,799 --> 00:24:16,480
initial tooling cost that can range from

729
00:24:16,480 --> 00:24:18,480
hundreds to over a thousand bucks

730
00:24:18,480 --> 00:24:20,159
i bit the bullet and did it because i

731
00:24:20,159 --> 00:24:21,919
hope to end up making a lot of these but

732
00:24:21,919 --> 00:24:23,840
it's not ideal for making just five or

733
00:24:23,840 --> 00:24:25,679
ten of something

734
00:24:25,679 --> 00:24:27,039
but if you want to make a thousand of

735
00:24:27,039 --> 00:24:28,559
them you could end up spending as little

736
00:24:28,559 --> 00:24:30,799
as a dollar each for a display this size

737
00:24:30,799 --> 00:24:32,400
if you wanted to make 10 000 of them you

738
00:24:32,400 --> 00:24:33,840
could end up spending even less per

739
00:24:33,840 --> 00:24:35,520
display

740
00:24:35,520 --> 00:24:37,440
one note this is not to say that you can

741
00:24:37,440 --> 00:24:38,799
spend a thousand dollars for five

742
00:24:38,799 --> 00:24:40,559
prototype displays you'll need to work

743
00:24:40,559 --> 00:24:42,159
with a manufacturer and their whole

744
00:24:42,159 --> 00:24:44,000
process is oriented around figuring out

745
00:24:44,000 --> 00:24:45,760
the tooling and then making a reasonably

746
00:24:45,760 --> 00:24:47,760
large run of the same display so it's

747
00:24:47,760 --> 00:24:50,080
not for everyone but if you're building

748
00:24:50,080 --> 00:24:51,520
a product and you need something more

749
00:24:51,520 --> 00:24:53,440
custom this process could make sense for

750
00:24:53,440 --> 00:24:54,799
you

751
00:24:54,799 --> 00:24:57,520
okay so to make a custom segment lcd you

752
00:24:57,520 --> 00:24:58,960
can use just about any vector graphics

753
00:24:58,960 --> 00:25:01,600
program inkscape illustrator whatever

754
00:25:01,600 --> 00:25:03,760
your manufacturer may ask for an autocad

755
00:25:03,760 --> 00:25:05,919
dwg of your design but i was able to

756
00:25:05,919 --> 00:25:07,840
provide an svg and it worked just fine

757
00:25:07,840 --> 00:25:09,360
personally i used affinity designer to

758
00:25:09,360 --> 00:25:12,240
lay this out and it worked great

759
00:25:12,240 --> 00:25:14,400
remember you can't draw more segments in

760
00:25:14,400 --> 00:25:15,679
your design than you can actually

761
00:25:15,679 --> 00:25:16,720
control

762
00:25:16,720 --> 00:25:18,720
the number of segments you can drive is

763
00:25:18,720 --> 00:25:20,240
going to be equal to the number of comm

764
00:25:20,240 --> 00:25:21,919
pins in your design times the number of

765
00:25:21,919 --> 00:25:24,159
segment pins

766
00:25:24,159 --> 00:25:25,760
but you can tie multiple segments

767
00:25:25,760 --> 00:25:28,240
together for example the pm and the

768
00:25:28,240 --> 00:25:29,919
signal icons those are just one

769
00:25:29,919 --> 00:25:31,840
addressable segment same with those

770
00:25:31,840 --> 00:25:33,360
three segments of that weird number in

771
00:25:33,360 --> 00:25:34,720
the date display

772
00:25:34,720 --> 00:25:36,159
you can turn all three of those segments

773
00:25:36,159 --> 00:25:38,159
on or off but you can't control them

774
00:25:38,159 --> 00:25:40,640
individually it's a trade-off right it

775
00:25:40,640 --> 00:25:42,000
makes that position only good for

776
00:25:42,000 --> 00:25:44,400
displaying the numbers one two and three

777
00:25:44,400 --> 00:25:45,760
but it means you only need four

778
00:25:45,760 --> 00:25:47,440
addresses for that digit instead of

779
00:25:47,440 --> 00:25:49,360
seven

780
00:25:49,360 --> 00:25:51,679
next you'll wanna drop a data sheet some

781
00:25:51,679 --> 00:25:53,360
lcd fabricators will just take your

782
00:25:53,360 --> 00:25:55,279
drawing and make it happen but if you

783
00:25:55,279 --> 00:25:57,039
provide some more details you can have a

784
00:25:57,039 --> 00:25:59,679
lot more control over the outcome

785
00:25:59,679 --> 00:26:01,520
so you'll want to specify dimensions

786
00:26:01,520 --> 00:26:02,559
remember there are going to be

787
00:26:02,559 --> 00:26:04,480
manufacturing tolerances so this is just

788
00:26:04,480 --> 00:26:06,240
a you know nominal dimensions sort of

789
00:26:06,240 --> 00:26:07,840
thing they will come back to you with

790
00:26:07,840 --> 00:26:10,480
final dimensions for your approval

791
00:26:10,480 --> 00:26:12,080
you'll also need a bit of margin on the

792
00:26:12,080 --> 00:26:13,600
edges because they need to seal the

793
00:26:13,600 --> 00:26:15,120
glass and you can't have any segments in

794
00:26:15,120 --> 00:26:17,760
the area where they do that

795
00:26:17,760 --> 00:26:20,159
optionally you can specify a segment map

796
00:26:20,159 --> 00:26:21,520
they can just pick a map and route it

797
00:26:21,520 --> 00:26:23,520
for you but if you have constraints like

798
00:26:23,520 --> 00:26:26,320
i did you can specify it

799
00:26:26,320 --> 00:26:28,000
note that they may not be able to able

800
00:26:28,000 --> 00:26:30,000
to accommodate your segment map routing

801
00:26:30,000 --> 00:26:32,000
an lcd is a lot like routing a single

802
00:26:32,000 --> 00:26:33,919
layer board so if your layout is

803
00:26:33,919 --> 00:26:35,919
particularly complex they may not be

804
00:26:35,919 --> 00:26:38,080
able to route it but you can at least

805
00:26:38,080 --> 00:26:39,200
specify certain things that are

806
00:26:39,200 --> 00:26:41,200
important to you and i hope and you can

807
00:26:41,200 --> 00:26:44,000
hope that they can accommodate it

808
00:26:44,000 --> 00:26:45,520
finally you need to specify some

809
00:26:45,520 --> 00:26:46,960
required parameters and i'll just go

810
00:26:46,960 --> 00:26:48,880
over them very quickly

811
00:26:48,880 --> 00:26:50,960
tn or twisted pneumatic is the most

812
00:26:50,960 --> 00:26:52,799
common type of lcd it's cheap and it

813
00:26:52,799 --> 00:26:55,279
works well for segment lcds

814
00:26:55,279 --> 00:26:57,200
viewing direction basically it refers to

815
00:26:57,200 --> 00:26:58,799
the angle folks will view it at it's

816
00:26:58,799 --> 00:27:00,159
like the clock hands if you're looking

817
00:27:00,159 --> 00:27:01,279
at it from slightly below like a

818
00:27:01,279 --> 00:27:03,120
wristwatch it'll be six o'clock if

819
00:27:03,120 --> 00:27:04,240
you're looking at it from slightly above

820
00:27:04,240 --> 00:27:07,600
like a desk clock it'll be 12 o'clock

821
00:27:07,600 --> 00:27:09,600
polarizer mode there's two pieces to

822
00:27:09,600 --> 00:27:12,159
this positive means it's a light display

823
00:27:12,159 --> 00:27:13,440
with segments that darken when they're

824
00:27:13,440 --> 00:27:16,320
energized and uh

825
00:27:16,320 --> 00:27:18,080
negative is that cool inverse look where

826
00:27:18,080 --> 00:27:19,360
it's all black and the segments turn

827
00:27:19,360 --> 00:27:21,200
light

828
00:27:21,200 --> 00:27:22,559
transflective has to do with the

829
00:27:22,559 --> 00:27:24,559
polarizer on the back of the glass uh

830
00:27:24,559 --> 00:27:26,080
transparent is totally see-through like

831
00:27:26,080 --> 00:27:28,240
a heads-up display reflective is totally

832
00:27:28,240 --> 00:27:29,200
opaque

833
00:27:29,200 --> 00:27:30,720
transflective tends to be the best of

834
00:27:30,720 --> 00:27:32,480
both worlds it has a backing layer so

835
00:27:32,480 --> 00:27:34,159
you can see the display but it's

836
00:27:34,159 --> 00:27:35,760
semi-transparent so you can also light

837
00:27:35,760 --> 00:27:37,440
it from behind

838
00:27:37,440 --> 00:27:39,520
driver method we talked about duty will

839
00:27:39,520 --> 00:27:40,799
match the number of comm pins in your

840
00:27:40,799 --> 00:27:43,440
design and your lcd lcd driver's data

841
00:27:43,440 --> 00:27:44,960
sheet will likely recommend a bias

842
00:27:44,960 --> 00:27:46,840
scheme for a given duty

843
00:27:46,840 --> 00:27:49,760
ratio operating voltage again you just

844
00:27:49,760 --> 00:27:50,720
want to ask for something that works

845
00:27:50,720 --> 00:27:52,720
with your chip they made me a three volt

846
00:27:52,720 --> 00:27:55,279
lcd it is pretty standard

847
00:27:55,279 --> 00:27:57,600
temperature i didn't really care about

848
00:27:57,600 --> 00:27:59,679
and then connection method i asked for

849
00:27:59,679 --> 00:28:01,360
zebra strip which meant i needed to make

850
00:28:01,360 --> 00:28:02,880
that 3d printed enclosure to hold the

851
00:28:02,880 --> 00:28:04,159
whole thing together

852
00:28:04,159 --> 00:28:05,440
it also meant that i had to find some

853
00:28:05,440 --> 00:28:07,360
zebra strips on ebay you may want to

854
00:28:07,360 --> 00:28:09,039
have them crimp pins on but this part is

855
00:28:09,039 --> 00:28:11,520
entirely up to you

856
00:28:11,520 --> 00:28:13,200
finally there are some notes but the

857
00:28:13,200 --> 00:28:14,799
only one i want to call out is the

858
00:28:14,799 --> 00:28:16,960
filling port so after they etch your

859
00:28:16,960 --> 00:28:18,720
glass they need to fill the inside with

860
00:28:18,720 --> 00:28:20,720
fluid that's the liquid in a liquid

861
00:28:20,720 --> 00:28:22,720
crystal display this means there will be

862
00:28:22,720 --> 00:28:24,480
a filling port bumping out from one side

863
00:28:24,480 --> 00:28:26,000
of your display glass

864
00:28:26,000 --> 00:28:27,679
it's just a small bump of glass about an

865
00:28:27,679 --> 00:28:29,279
extra millimeter i asked for it on the

866
00:28:29,279 --> 00:28:31,039
bottom they put it on the left in my

867
00:28:31,039 --> 00:28:32,960
case it really didn't matter just know

868
00:28:32,960 --> 00:28:34,000
that you'll have to account for that

869
00:28:34,000 --> 00:28:36,320
bump in your enclosure design and again

870
00:28:36,320 --> 00:28:37,840
they will send you a final data sheet

871
00:28:37,840 --> 00:28:39,120
with all of these dimensions for

872
00:28:39,120 --> 00:28:41,120
approval

873
00:28:41,120 --> 00:28:43,120
finally you don't have to do this but i

874
00:28:43,120 --> 00:28:44,399
just did it because i wanted to be sure

875
00:28:44,399 --> 00:28:45,600
it would work

876
00:28:45,600 --> 00:28:47,200
at some point someone is going to have

877
00:28:47,200 --> 00:28:48,799
to route your lcd

878
00:28:48,799 --> 00:28:50,159
this means physically laying out the

879
00:28:50,159 --> 00:28:51,440
traces that will connect all of the

880
00:28:51,440 --> 00:28:53,919
common and segment lines

881
00:28:53,919 --> 00:28:55,440
again it's a lot like laying out a

882
00:28:55,440 --> 00:28:57,120
single layer pcb

883
00:28:57,120 --> 00:28:58,799
all the lines have to connect

884
00:28:58,799 --> 00:29:00,559
they can't cross each other and there

885
00:29:00,559 --> 00:29:03,120
are no vias to help you

886
00:29:03,120 --> 00:29:04,880
i really don't know what tools the lcd

887
00:29:04,880 --> 00:29:06,720
fab houses use for this all i know is i

888
00:29:06,720 --> 00:29:08,320
used eagle and did some auto router

889
00:29:08,320 --> 00:29:10,000
hacks to get a sense for it

890
00:29:10,000 --> 00:29:11,360
i laid out a schematic with some parts

891
00:29:11,360 --> 00:29:12,880
that resembled the pad layout for my

892
00:29:12,880 --> 00:29:14,960
electrodes some single pin parts for

893
00:29:14,960 --> 00:29:16,559
icons and some eight pin parts for the

894
00:29:16,559 --> 00:29:18,640
segmented digits and i connected them up

895
00:29:18,640 --> 00:29:21,520
to the comm lines i needed to lay out

896
00:29:21,520 --> 00:29:23,279
i basically arranged them roughly the

897
00:29:23,279 --> 00:29:25,279
way i wanted them to look on the lcd and

898
00:29:25,279 --> 00:29:28,159
i had the auto router take a stab at it

899
00:29:28,159 --> 00:29:29,520
same thing for the segment lines i just

900
00:29:29,520 --> 00:29:31,279
assigned them all and let the auto

901
00:29:31,279 --> 00:29:33,520
router do that job for me

902
00:29:33,520 --> 00:29:35,440
okay so here's a question are these best

903
00:29:35,440 --> 00:29:37,360
practices is this the right way to do

904
00:29:37,360 --> 00:29:39,120
this and the answer is

905
00:29:39,120 --> 00:29:40,960
i don't know really if anyone in the

906
00:29:40,960 --> 00:29:42,399
audience has any insights as to what

907
00:29:42,399 --> 00:29:43,840
tools they use to route these kinds of

908
00:29:43,840 --> 00:29:45,360
things in the real world i'd love to

909
00:29:45,360 --> 00:29:47,520
hear it please reach out for now i know

910
00:29:47,520 --> 00:29:48,960
just know that it's what i did and it

911
00:29:48,960 --> 00:29:50,559
worked for me and got me to a working

912
00:29:50,559 --> 00:29:52,399
display

913
00:29:52,399 --> 00:29:54,799
okay so wrapping up i hope this talk

914
00:29:54,799 --> 00:29:56,559
offered some insight into making use of

915
00:29:56,559 --> 00:29:58,320
lcd technology

916
00:29:58,320 --> 00:29:59,600
we talked about how these little pieces

917
00:29:59,600 --> 00:30:01,039
of glass are great for low power

918
00:30:01,039 --> 00:30:02,559
projects

919
00:30:02,559 --> 00:30:04,240
we talked about how they work and how to

920
00:30:04,240 --> 00:30:05,360
recognize the different kinds of

921
00:30:05,360 --> 00:30:07,520
waveforms that drive them

922
00:30:07,520 --> 00:30:08,960
we also talked about how you can drive

923
00:30:08,960 --> 00:30:10,559
them with peripherals designed for this

924
00:30:10,559 --> 00:30:12,640
exact purpose

925
00:30:12,640 --> 00:30:13,919
we talked about how these displays are

926
00:30:13,919 --> 00:30:16,159
out there in gadgets all around you

927
00:30:16,159 --> 00:30:17,600
and we talked about how you can unlock

928
00:30:17,600 --> 00:30:19,279
their secrets

929
00:30:19,279 --> 00:30:20,960
finally we also went over the basics of

930
00:30:20,960 --> 00:30:23,279
how to design your own lcd for a device

931
00:30:23,279 --> 00:30:24,480
if you can't find anything in the

932
00:30:24,480 --> 00:30:27,600
salvage bin that fits your exact needs

933
00:30:27,600 --> 00:30:29,520
so that wraps it up for me these slides

934
00:30:29,520 --> 00:30:30,960
are available on the on the remote con

935
00:30:30,960 --> 00:30:32,480
slideshare so you can download them and

936
00:30:32,480 --> 00:30:34,720
check out some of my notes and i'll be

937
00:30:34,720 --> 00:30:35,919
on discord if you have any questions but

938
00:30:35,919 --> 00:30:37,120
you can also ask any questions on

939
00:30:37,120 --> 00:30:40,000
twitter at josecastio

940
00:30:40,000 --> 00:30:43,240
thank you

