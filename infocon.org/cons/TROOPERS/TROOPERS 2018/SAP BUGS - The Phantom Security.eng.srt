1
00:00:04,550 --> 00:00:09,360
welcome our next speakers<font color="#CCCCCC"> vihan and</font>

2
00:00:06,810 --> 00:00:12,539
<font color="#CCCCCC">vladimir from earpiece can there will be</font>

3
00:00:09,360 --> 00:00:14,669
<font color="#E5E5E5">speaking about</font><font color="#CCCCCC"> sa p</font><font color="#E5E5E5"> box so basically the</font>

4
00:00:12,539 --> 00:00:24,330
<font color="#E5E5E5">SP</font><font color="#CCCCCC"> netweaver</font><font color="#E5E5E5"> again</font>

5
00:00:14,670 --> 00:00:25,320
so let<font color="#CCCCCC"> us welcome them hi</font><font color="#E5E5E5"> everyone thank</font>

6
00:00:24,330 --> 00:00:29,310
you

7
00:00:25,320 --> 00:00:33,390
today<font color="#CCCCCC"> Latimer</font><font color="#E5E5E5"> and I will talk</font><font color="#CCCCCC"> about a</font>

8
00:00:29,310 --> 00:00:38,190
<font color="#CCCCCC">safety security about security</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> CP new</font>

9
00:00:33,390 --> 00:00:41,100
tool for<font color="#CCCCCC"> few slides about us I'm senior</font>

10
00:00:38,190 --> 00:00:46,530
security researcher<font color="#CCCCCC"> earpiece can company</font>

11
00:00:41,100 --> 00:00:52,550
and I like and like back hunter<font color="#CCCCCC"> bug</font>

12
00:00:46,530 --> 00:00:52,550
bounty<font color="#E5E5E5"> Malvo researching and my name is</font>

13
00:00:53,030 --> 00:01:00,539
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> scoot in reverse engineering</font><font color="#E5E5E5"> and</font>

14
00:00:57,420 --> 00:01:05,880
encryption we are<font color="#CCCCCC"> star wars</font><font color="#E5E5E5"> fun though I</font>

15
00:01:00,539 --> 00:01:09,930
<font color="#CCCCCC">think you enjoy patient here is our</font>

16
00:01:05,880 --> 00:01:15,090
agenda the agenda in contains of five

17
00:01:09,930 --> 00:01:21,780
main points in in the first point<font color="#CCCCCC"> will</font>

18
00:01:15,090 --> 00:01:27,120
talk<font color="#E5E5E5"> about s AP about newest</font><font color="#CCCCCC"> CVE</font>

19
00:01:21,780 --> 00:01:31,050
in ASAP network platform<font color="#CCCCCC"> after that</font>

20
00:01:27,120 --> 00:01:33,930
<font color="#E5E5E5">we'll review how</font><font color="#CCCCCC"> kind of how what kind</font>

21
00:01:31,050 --> 00:01:36,750
<font color="#E5E5E5">of application are present in CP for</font>

22
00:01:33,930 --> 00:01:41,850
application server Java and<font color="#CCCCCC"> how you can</font>

23
00:01:36,750 --> 00:01:45,780
use<font color="#E5E5E5"> these applications and after that</font>

24
00:01:41,850 --> 00:01:51,479
we'll review<font color="#CCCCCC"> Redwood component and will</font>

25
00:01:45,780 --> 00:01:56,640
show vulnerability in<font color="#CCCCCC"> Redwood and after</font>

26
00:01:51,480 --> 00:02:00,600
that<font color="#E5E5E5"> we'll review</font><font color="#CCCCCC"> sa PCRM component and</font>

27
00:01:56,640 --> 00:02:03,360
<font color="#CCCCCC">we'll show how</font><font color="#E5E5E5"> you can escalate</font>

28
00:02:00,600 --> 00:02:06,210
privileges in s AP and how you can get

29
00:02:03,360 --> 00:02:10,720
remote comment execution<font color="#CCCCCC"> we a lot</font>

30
00:02:06,210 --> 00:02:14,920
ejection in s AP<font color="#CCCCCC"> network</font>

31
00:02:10,720 --> 00:02:17,050
and in the fifth slide we will show how

32
00:02:14,920 --> 00:02:19,510
<font color="#CCCCCC">you can protect</font><font color="#E5E5E5"> and what kind of a CPA</font>

33
00:02:17,050 --> 00:02:25,140
security notes<font color="#E5E5E5"> you need to install in</font>

34
00:02:19,510 --> 00:02:32,260
your<font color="#CCCCCC"> ACP servers to protect to protect</font>

35
00:02:25,140 --> 00:02:36,359
<font color="#E5E5E5">so I think everyone know about</font><font color="#CCCCCC"> ACP</font>

36
00:02:32,260 --> 00:02:40,950
company he has a lot of applications for

37
00:02:36,360 --> 00:02:40,950
<font color="#E5E5E5">banking for gas and oil for</font>

38
00:02:41,520 --> 00:02:51,220
manufacturing industry<font color="#E5E5E5"> and s</font><font color="#CCCCCC"> IP every</font>

39
00:02:48,220 --> 00:02:55,570
every month<font color="#CCCCCC"> releasing a fiscal two notes</font>

40
00:02:51,220 --> 00:03:01,900
for example<font color="#CCCCCC"> last</font><font color="#E5E5E5"> three years</font><font color="#CCCCCC"> the Sepik</font>

41
00:02:55,570 --> 00:03:06,630
company released around 300 security

42
00:03:01,900 --> 00:03:12,600
notes<font color="#E5E5E5"> each year and last year in 2017</font>

43
00:03:06,630 --> 00:03:15,390
<font color="#CCCCCC">accounted</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> sa P patched around 3:13</font>

44
00:03:12,600 --> 00:03:19,540
critical

45
00:03:15,390 --> 00:03:23,470
he released 13<font color="#E5E5E5"> safety notes to protect</font>

46
00:03:19,540 --> 00:03:27,549
critical vulnerabilities enters our top

47
00:03:23,470 --> 00:03:30,519
four critical<font color="#E5E5E5"> vulnerability which we</font>

48
00:03:27,550 --> 00:03:35,130
<font color="#E5E5E5">found about first vulnerability we</font>

49
00:03:30,519 --> 00:03:40,690
talked in last troopers<font color="#E5E5E5"> troopers 17 and</font>

50
00:03:35,130 --> 00:03:44,290
we showed how s AP administrators can

51
00:03:40,690 --> 00:03:51,010
get remote<font color="#E5E5E5"> comment execution in s AP</font>

52
00:03:44,290 --> 00:03:56,140
company in company customers where s AP

53
00:03:51,010 --> 00:03:58,420
GUI<font color="#E5E5E5"> last next to vulnerability was</font>

54
00:03:56,140 --> 00:04:02,798
present in a safety net<font color="#CCCCCC"> we were</font>

55
00:03:58,420 --> 00:04:08,320
<font color="#E5E5E5">application server Java and use using</font>

56
00:04:02,799 --> 00:04:10,780
these<font color="#E5E5E5"> two vulnerabilities and attackers</font>

57
00:04:08,320 --> 00:04:15,870
for example can get full access to<font color="#CCCCCC"> ACP</font>

58
00:04:10,780 --> 00:04:19,000
<font color="#E5E5E5">network platform and for and</font><font color="#CCCCCC"> for</font>

59
00:04:15,870 --> 00:04:22,770
<font color="#CCCCCC">vulnerability was present in</font><font color="#E5E5E5"> say</font><font color="#CCCCCC"> P HANA</font>

60
00:04:19,000 --> 00:04:26,370
platform<font color="#E5E5E5"> in a say P tracks component</font>

61
00:04:22,770 --> 00:04:31,409
and some of you may remember that<font color="#E5E5E5"> last</font>

62
00:04:26,370 --> 00:04:35,520
<font color="#CCCCCC">year</font><font color="#E5E5E5"> when</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> talked talked how you can</font>

63
00:04:31,410 --> 00:04:40,710
get admin privileges in a say P server

64
00:04:35,520 --> 00:04:44,520
we say that<font color="#E5E5E5"> so we sent some unknown</font>

65
00:04:40,710 --> 00:04:48,388
<font color="#E5E5E5">directory traversal to</font><font color="#CCCCCC"> a say P company</font>

66
00:04:44,520 --> 00:04:52,020
<font color="#E5E5E5">but we don't have any patch yet</font><font color="#CCCCCC"> but now</font>

67
00:04:48,389 --> 00:04:57,289
they say P released a few security<font color="#CCCCCC"> notes</font>

68
00:04:52,020 --> 00:04:57,289
<font color="#E5E5E5">and we can talk about this vulnerability</font>

69
00:04:59,150 --> 00:05:10,859
<font color="#CCCCCC">here</font><font color="#E5E5E5"> is a</font><font color="#CCCCCC"> Sapien at river platform</font>

70
00:05:06,020 --> 00:05:14,840
platform structure<font color="#E5E5E5"> he contains of two</font>

71
00:05:10,860 --> 00:05:19,770
main<font color="#CCCCCC"> parts is a say</font><font color="#E5E5E5"> PA a BP stack and</font>

72
00:05:14,840 --> 00:05:26,669
<font color="#CCCCCC">ASAP Java stack and we today will will</font>

73
00:05:19,770 --> 00:05:30,599
review just only<font color="#CCCCCC"> sa p Java stack so they</font>

74
00:05:26,669 --> 00:05:33,240
say P Java stack has a lot<font color="#E5E5E5"> of</font>

75
00:05:30,599 --> 00:05:37,310
applications which were written<font color="#E5E5E5"> in Java</font>

76
00:05:33,240 --> 00:05:40,469
language and here is a<font color="#E5E5E5"> screenshot of our</font>

77
00:05:37,310 --> 00:05:43,229
tests<font color="#CCCCCC"> ap server</font><font color="#E5E5E5"> you can see that in this</font>

78
00:05:40,469 --> 00:05:46,710
server we<font color="#CCCCCC"> have around</font><font color="#E5E5E5"> a thousand and</font>

79
00:05:43,229 --> 00:05:48,800
four hundred<font color="#E5E5E5"> Java applications</font><font color="#CCCCCC"> all Java</font>

80
00:05:46,710 --> 00:05:52,739
applications<font color="#E5E5E5"> are allocated in a say P</font>

81
00:05:48,800 --> 00:05:55,800
not come<font color="#E5E5E5"> forward in file system and to</font>

82
00:05:52,740 --> 00:05:58,139
understand<font color="#E5E5E5"> how you can how you can call</font>

83
00:05:55,800 --> 00:06:03,630
how you can use these<font color="#CCCCCC"> applications via</font>

84
00:05:58,139 --> 00:06:06,810
browser<font color="#E5E5E5"> let's review one vulnerability</font>

85
00:06:03,630 --> 00:06:08,759
<font color="#E5E5E5">which we found in 2016</font><font color="#CCCCCC"> this</font>

86
00:06:06,810 --> 00:06:14,669
<font color="#CCCCCC">vulnerability of information disclosure</font>

87
00:06:08,759 --> 00:06:19,639
<font color="#E5E5E5">and in</font><font color="#CCCCCC"> videochat</font><font color="#E5E5E5"> component so you can</font>

88
00:06:14,669 --> 00:06:23,549
draw<font color="#E5E5E5"> easy parallel between web URL and</font>

89
00:06:19,639 --> 00:06:28,409
physical path when this<font color="#CCCCCC"> application is</font>

90
00:06:23,550 --> 00:06:31,639
located<font color="#E5E5E5"> and as every java application is</font>

91
00:06:28,409 --> 00:06:36,319
a s AP<font color="#CCCCCC"> application to</font>

92
00:06:31,639 --> 00:06:38,900
have some web<font color="#CCCCCC"> deeper</font><font color="#E5E5E5"> or web web dot XML</font>

93
00:06:36,319 --> 00:06:41,210
files which describing the application

94
00:06:38,900 --> 00:06:46,210
names for example<font color="#CCCCCC"> here</font><font color="#E5E5E5"> you can</font><font color="#CCCCCC"> see that</font>

95
00:06:41,210 --> 00:06:50,000
<font color="#E5E5E5">this video chat</font><font color="#CCCCCC"> component has</font><font color="#E5E5E5"> two</font>

96
00:06:46,210 --> 00:06:53,750
application<font color="#E5E5E5"> name a chat and mesh</font>

97
00:06:50,000 --> 00:07:00,310
messages so and if you will open<font color="#E5E5E5"> this</font>

98
00:06:53,750 --> 00:07:04,750
URL in your browser<font color="#CCCCCC"> you can</font><font color="#E5E5E5"> get s AP</font>

99
00:07:00,310 --> 00:07:08,800
users list with nicknames<font color="#CCCCCC"> without any</font>

100
00:07:04,750 --> 00:07:13,819
credentials so the<font color="#E5E5E5"> Redwood component is</font>

101
00:07:08,800 --> 00:07:16,099
java application<font color="#CCCCCC"> - and to install</font><font color="#E5E5E5"> the</font>

102
00:07:13,819 --> 00:07:20,479
result component in<font color="#E5E5E5"> your CP server you</font>

103
00:07:16,099 --> 00:07:22,520
has you you have two ways<font color="#E5E5E5"> first you can</font>

104
00:07:20,479 --> 00:07:25,008
download<font color="#E5E5E5"> the Redwood component from a CP</font>

105
00:07:22,520 --> 00:07:29,659
launch launch pad and deploy<font color="#CCCCCC"> it in your</font>

106
00:07:25,009 --> 00:07:33,319
say P server<font color="#E5E5E5"> or when you installing this</font>

107
00:07:29,659 --> 00:07:35,990
ap server<font color="#E5E5E5"> you can check the center</font><font color="#CCCCCC"> of</font>

108
00:07:33,319 --> 00:07:38,539
<font color="#E5E5E5">protest scheduling checkbox and after</font>

109
00:07:35,990 --> 00:07:43,159
that in your<font color="#CCCCCC"> SCP server out at eclis we</font>

110
00:07:38,539 --> 00:07:47,270
will deploy we will do playing<font color="#E5E5E5"> Redwood</font>

111
00:07:43,159 --> 00:07:50,750
component so the Redwood component<font color="#CCCCCC"> you</font>

112
00:07:47,270 --> 00:07:54,948
can<font color="#CCCCCC"> you</font><font color="#E5E5E5"> can get you can find a redwood</font>

113
00:07:50,750 --> 00:08:01,279
component in apps folder me ASAP<font color="#CCCCCC"> does</font>

114
00:07:54,949 --> 00:08:05,659
come forward and a redwood<font color="#CCCCCC"> right</font>

115
00:08:01,279 --> 00:08:09,110
component has<font color="#CCCCCC"> scheduler servlet and if</font>

116
00:08:05,659 --> 00:08:17,180
you will open<font color="#CCCCCC"> schedule</font><font color="#E5E5E5"> servlet in your</font>

117
00:08:09,110 --> 00:08:21,819
browser<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can see</font><font color="#E5E5E5"> this this portal so</font>

118
00:08:17,180 --> 00:08:25,419
when we opened this portal we<font color="#E5E5E5"> heard that</font>

119
00:08:21,819 --> 00:08:29,029
this some kind of very<font color="#CCCCCC"> interesting</font>

120
00:08:25,419 --> 00:08:33,740
application<font color="#E5E5E5"> because previous we only</font>

121
00:08:29,029 --> 00:08:39,070
researched<font color="#E5E5E5"> application in s AP dot-com</font>

122
00:08:33,740 --> 00:08:39,070
folder<font color="#CCCCCC"> and we started research it</font>

123
00:08:39,089 --> 00:08:48,550
we we opened we<font color="#CCCCCC"> open the HTML code in</font>

124
00:08:44,950 --> 00:08:54,130
main page and we saw<font color="#E5E5E5"> some metadata some</font>

125
00:08:48,550 --> 00:08:59,170
<font color="#CCCCCC">links some scripts but we but first</font>

126
00:08:54,130 --> 00:09:06,089
script tag is look like<font color="#E5E5E5"> very interesting</font>

127
00:08:59,170 --> 00:09:06,089
because he has<font color="#E5E5E5"> UI util</font><font color="#CCCCCC"> JavaScript GS</font>

128
00:09:06,329 --> 00:09:17,310
servlet<font color="#E5E5E5"> who gets JavaScript old and</font>

129
00:09:11,350 --> 00:09:21,640
utils parameter which are the parameter

130
00:09:17,310 --> 00:09:25,329
<font color="#E5E5E5">U tilde JS file we found in</font><font color="#CCCCCC"> SA P server</font>

131
00:09:21,640 --> 00:09:29,970
<font color="#E5E5E5">and also we</font><font color="#CCCCCC"> found</font><font color="#E5E5E5"> JavaScript and old</font>

132
00:09:25,329 --> 00:09:36,609
folders so what we have we have some

133
00:09:29,970 --> 00:09:42,600
<font color="#E5E5E5">physical file in inter server</font><font color="#CCCCCC"> and we</font>

134
00:09:36,610 --> 00:09:46,750
have URL in the you know we have URL

135
00:09:42,600 --> 00:09:52,570
which can use to read<font color="#E5E5E5"> the util dot</font><font color="#CCCCCC"> JS</font>

136
00:09:46,750 --> 00:10:02,160
file<font color="#E5E5E5"> so and after</font><font color="#CCCCCC"> that we took the</font>

137
00:09:52,570 --> 00:10:07,870
scheduler<font color="#CCCCCC"> server</font><font color="#E5E5E5"> and put dot dot slash</font>

138
00:10:02,160 --> 00:10:15,370
<font color="#E5E5E5">many times and finally we can read wing</font>

139
00:10:07,870 --> 00:10:19,390
any file from<font color="#CCCCCC"> server so you can see that</font>

140
00:10:15,370 --> 00:10:21,910
directory traversal<font color="#E5E5E5"> is very</font><font color="#CCCCCC"> - reducing</font>

141
00:10:19,390 --> 00:10:25,180
vulnerability just need to type dot

142
00:10:21,910 --> 00:10:28,019
slash<font color="#CCCCCC"> ok and</font><font color="#E5E5E5"> immediately we reported</font>

143
00:10:25,180 --> 00:10:37,359
this vulnerability to<font color="#CCCCCC"> ACP it was</font>

144
00:10:28,019 --> 00:10:39,670
February of<font color="#E5E5E5"> 2016 and so cool directory</font>

145
00:10:37,360 --> 00:10:43,720
traversal vulnerability is cool but how

146
00:10:39,670 --> 00:10:47,079
you<font color="#E5E5E5"> can how you can get another sentence</font>

147
00:10:43,720 --> 00:10:51,069
another critical information<font color="#E5E5E5"> critical</font>

148
00:10:47,079 --> 00:10:51,739
data from the<font color="#E5E5E5"> CP server you need to read</font>

149
00:10:51,069 --> 00:10:56,630
<font color="#E5E5E5">and</font>

150
00:10:51,740 --> 00:10:59,210
creeped sex store dot properties and sex

151
00:10:56,630 --> 00:11:03,410
<font color="#E5E5E5">store said you need to decrypt</font><font color="#CCCCCC"> sixth</font><font color="#E5E5E5"> or</font>

152
00:10:59,210 --> 00:11:10,190
properties file and after decryption you

153
00:11:03,410 --> 00:11:14,780
can see that mr.<font color="#CCCCCC"> utter</font><font color="#E5E5E5"> passwords from</font>

154
00:11:10,190 --> 00:11:17,840
the CP server so but<font color="#CCCCCC"> before let's see</font>

155
00:11:14,780 --> 00:11:25,660
the demo of directory traversal

156
00:11:17,840 --> 00:11:28,510
exploitation<font color="#E5E5E5"> here's a CP Java server and</font>

157
00:11:25,660 --> 00:11:35,420
you<font color="#E5E5E5"> can see that we don't have any</font>

158
00:11:28,510 --> 00:11:39,850
<font color="#E5E5E5">privileges on server who opened</font>

159
00:11:35,420 --> 00:11:39,849
scheduler servlet

160
00:11:43,820 --> 00:11:54,470
after that we called<font color="#E5E5E5"> UI</font><font color="#CCCCCC"> YouTube</font>

161
00:11:48,960 --> 00:12:01,560
<font color="#CCCCCC">JavaScript servlet web browser and</font><font color="#E5E5E5"> you</font>

162
00:11:54,470 --> 00:12:06,650
<font color="#CCCCCC">can see that</font><font color="#E5E5E5"> we can we can open any read</font>

163
00:12:01,560 --> 00:12:06,650
any folder and we can get<font color="#E5E5E5"> file lists</font>

164
00:12:18,529 --> 00:12:37,630
after that we try<font color="#E5E5E5"> to read</font><font color="#CCCCCC"> secure storage</font>

165
00:12:25,580 --> 00:12:37,630
<font color="#CCCCCC">of ACP</font><font color="#E5E5E5"> server the our s</font><font color="#CCCCCC"> AP has DM 0s ID</font>

166
00:12:55,530 --> 00:13:06,470
so here's our<font color="#E5E5E5"> hair is a secure storage</font>

167
00:13:01,320 --> 00:13:09,710
<font color="#CCCCCC">and who can read the key file</font><font color="#E5E5E5"> and</font>

168
00:13:06,470 --> 00:13:09,710
properties file

169
00:13:13,410 --> 00:13:22,310
about<font color="#E5E5E5"> sixth or decryption algorithm</font>

170
00:13:18,120 --> 00:13:22,310
<font color="#E5E5E5">we'll talk what Amir</font>

171
00:13:30,600 --> 00:13:37,149
yeah if you remember the stuff<font color="#CCCCCC"> Star Wars</font>

172
00:13:34,320 --> 00:13:39,490
<font color="#E5E5E5">the Death Star was really great but</font>

173
00:13:37,149 --> 00:13:41,800
<font color="#E5E5E5">there was one weakness</font><font color="#CCCCCC"> in the center</font><font color="#E5E5E5"> and</font>

174
00:13:39,490 --> 00:13:45,100
using it<font color="#E5E5E5"> Luke Skywalker completely</font>

175
00:13:41,800 --> 00:13:48,459
destroyed it<font color="#CCCCCC"> so sex store in sa p system</font>

176
00:13:45,100 --> 00:13:50,350
is just the same<font color="#E5E5E5"> thing so we</font><font color="#CCCCCC"> have</font><font color="#E5E5E5"> sex</font>

177
00:13:48,459 --> 00:13:52,359
store<font color="#CCCCCC"> dot propias file containing</font>

178
00:13:50,350 --> 00:13:54,510
information about administrator<font color="#E5E5E5"> lock</font>

179
00:13:52,360 --> 00:13:57,600
<font color="#E5E5E5">like password and our credentials</font>

180
00:13:54,510 --> 00:14:02,439
<font color="#E5E5E5">database connection string and something</font>

181
00:13:57,600 --> 00:14:04,269
in our sensitive data we have also<font color="#CCCCCC"> sex</font>

182
00:14:02,440 --> 00:14:06,700
<font color="#E5E5E5">store</font><font color="#CCCCCC"> that key file containing</font>

183
00:14:04,269 --> 00:14:09,730
<font color="#E5E5E5">encryption key for sex talk dot</font>

184
00:14:06,700 --> 00:14:12,940
properties and so if an attacker can

185
00:14:09,730 --> 00:14:16,450
gain access to to this file<font color="#E5E5E5"> here she can</font>

186
00:14:12,940 --> 00:14:19,360
completely can gain<font color="#E5E5E5"> administrator</font>

187
00:14:16,450 --> 00:14:22,870
privileges<font color="#E5E5E5"> to</font><font color="#CCCCCC"> a CP system and to asset</font>

188
00:14:19,360 --> 00:14:27,100
<font color="#E5E5E5">in database so we analyzed encryption</font>

189
00:14:22,870 --> 00:14:32,200
algorithm and we wrote our tool<font color="#E5E5E5"> sex</font>

190
00:14:27,100 --> 00:14:35,800
store<font color="#CCCCCC"> decrypter this quick get</font><font color="#E5E5E5"> sex about</font>

191
00:14:32,200 --> 00:14:40,029
key file<font color="#CCCCCC"> we also found a half coded key</font>

192
00:14:35,800 --> 00:14:42,339
in<font color="#CCCCCC"> java source code so we need to solve</font>

193
00:14:40,029 --> 00:14:45,850
this well this<font color="#CCCCCC"> really with safe solid</font>

194
00:14:42,339 --> 00:14:50,079
key<font color="#E5E5E5"> and this way we can get very</font><font color="#CCCCCC"> low key</font>

195
00:14:45,850 --> 00:14:53,230
phrase<font color="#E5E5E5"> this key phrase is used as a key</font>

196
00:14:50,079 --> 00:14:56,349
for sex or<font color="#CCCCCC"> dot properties</font><font color="#E5E5E5"> the algorithm</font>

197
00:14:53,230 --> 00:14:59,920
is<font color="#CCCCCC"> Triple DES in CBC mode and whisper</font>

198
00:14:56,350 --> 00:15:02,649
<font color="#E5E5E5">you can get administrator password but</font>

199
00:14:59,920 --> 00:15:05,760
in fact the<font color="#E5E5E5"> real algorithm named is</font>

200
00:15:02,649 --> 00:15:10,020
<font color="#E5E5E5">whisper</font><font color="#CCCCCC"> I don't want to pronounce it</font><font color="#E5E5E5"> so</font>

201
00:15:05,760 --> 00:15:13,480
<font color="#CCCCCC">the main idea is that not the plain</font>

202
00:15:10,020 --> 00:15:21,029
key key phrase value is used<font color="#E5E5E5"> but it's</font>

203
00:15:13,480 --> 00:15:21,029
hash value so let's have a little<font color="#E5E5E5"> demo</font>

204
00:15:22,230 --> 00:15:40,060
so we have six of the deck file<font color="#E5E5E5"> we have</font>

205
00:15:28,240 --> 00:15:45,160
<font color="#E5E5E5">key file and our properties file so we</font>

206
00:15:40,060 --> 00:15:48,280
start down screen with<font color="#E5E5E5"> you can see we</font>

207
00:15:45,160 --> 00:15:52,290
can<font color="#E5E5E5"> decrease</font><font color="#CCCCCC"> Excel files and useful in</font>

208
00:15:48,280 --> 00:15:57,130
can decrypt information from<font color="#E5E5E5"> j2ee config</font>

209
00:15:52,290 --> 00:16:00,520
table<font color="#E5E5E5"> in John state so we just started</font>

210
00:15:57,130 --> 00:16:03,220
and get credential from<font color="#E5E5E5"> a city</font>

211
00:16:00,520 --> 00:16:04,060
administrator connection string to<font color="#E5E5E5"> a</font>

212
00:16:03,220 --> 00:16:06,640
city database

213
00:16:04,060 --> 00:16:08,819
well it's<font color="#E5E5E5"> username and password in clear</font>

214
00:16:06,640 --> 00:16:08,819
<font color="#E5E5E5">text</font>

215
00:16:14,060 --> 00:16:21,140
so you can find we decided to share our

216
00:16:18,800 --> 00:16:22,819
tool so<font color="#E5E5E5"> you</font><font color="#CCCCCC"> can find it in a tower I</font>

217
00:16:21,140 --> 00:16:27,260
give up

218
00:16:22,820 --> 00:16:30,470
please<font color="#E5E5E5"> enjoy it so yeah now we have</font>

219
00:16:27,260 --> 00:16:33,560
credentials<font color="#E5E5E5"> of a city administrator</font><font color="#CCCCCC"> we</font>

220
00:16:30,470 --> 00:16:36,770
can return<font color="#E5E5E5"> to</font><font color="#CCCCCC"> nice window and try to</font>

221
00:16:33,560 --> 00:16:41,270
<font color="#E5E5E5">login so</font><font color="#CCCCCC"> we input our</font><font color="#E5E5E5"> new credentials</font>

222
00:16:36,770 --> 00:16:44,090
and this we're missing the appears<font color="#E5E5E5"> we</font>

223
00:16:41,270 --> 00:16:46,970
don't have<font color="#CCCCCC"> felt reasons</font><font color="#E5E5E5"> so we</font><font color="#CCCCCC"> just put</font>

224
00:16:44,090 --> 00:16:50,300
sucked in<font color="#CCCCCC"> bla bla bla and try to</font>

225
00:16:46,970 --> 00:16:50,660
activate free whistles and oops we got

226
00:16:50,300 --> 00:16:55,930
it

227
00:16:50,660 --> 00:17:01,160
so and<font color="#CCCCCC"> you became a city administrator</font>

228
00:16:55,930 --> 00:17:03,979
very easy way<font color="#CCCCCC"> so let's refresh our</font>

229
00:17:01,160 --> 00:17:07,790
<font color="#E5E5E5">knowledge about our findings we have a</font>

230
00:17:03,980 --> 00:17:10,010
long<font color="#CCCCCC"> direct with reversal in schedule we</font>

231
00:17:07,790 --> 00:17:13,369
have<font color="#E5E5E5"> decryption tool to get adminstrator</font>

232
00:17:10,010 --> 00:17:18,890
password<font color="#E5E5E5"> from sex store and I think it's</font>

233
00:17:13,369 --> 00:17:22,849
time<font color="#E5E5E5"> to look closer at CRM so yeah the</font>

234
00:17:18,890 --> 00:17:25,850
second episode<font color="#E5E5E5"> so She'arim customer</font>

235
00:17:22,849 --> 00:17:28,099
relationship management<font color="#E5E5E5"> what is it in</font>

236
00:17:25,849 --> 00:17:30,649
<font color="#E5E5E5">general is an approach to management</font>

237
00:17:28,099 --> 00:17:34,100
<font color="#CCCCCC">company's interaction with current</font><font color="#E5E5E5"> and</font>

238
00:17:30,650 --> 00:17:36,470
potential users so CRM accumulates

239
00:17:34,100 --> 00:17:39,649
information about customers like<font color="#E5E5E5"> emails</font>

240
00:17:36,470 --> 00:17:43,580
telephone<font color="#E5E5E5"> social media provide analyzing</font>

241
00:17:39,650 --> 00:17:46,250
<font color="#CCCCCC">these data to determine</font><font color="#E5E5E5"> exactly target</font>

242
00:17:43,580 --> 00:17:47,720
audience<font color="#CCCCCC"> so we can share this data to</font>

243
00:17:46,250 --> 00:17:53,300
<font color="#CCCCCC">our customers</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> it's kind</font><font color="#E5E5E5"> of</font>

244
00:17:47,720 --> 00:17:55,030
collaboration that's how sharing<font color="#CCCCCC"> OOP</font>

245
00:17:53,300 --> 00:17:58,129
<font color="#E5E5E5">swipe</font>

246
00:17:55,030 --> 00:18:02,000
<font color="#CCCCCC">console so on the left hand you can see</font>

247
00:17:58,130 --> 00:18:04,760
some<font color="#E5E5E5"> submenu slide</font><font color="#CCCCCC"> 36</font>

248
00:18:02,000 --> 00:18:08,200
and our settings<font color="#E5E5E5"> and the most</font>

249
00:18:04,760 --> 00:18:10,640
<font color="#E5E5E5">interesting is</font><font color="#CCCCCC"> login</font><font color="#E5E5E5"> so let's go where</font>

250
00:18:08,200 --> 00:18:15,080
you can<font color="#CCCCCC"> see lot of</font><font color="#E5E5E5"> parameters like</font>

251
00:18:10,640 --> 00:18:19,580
destination<font color="#CCCCCC"> pub location so we try</font><font color="#E5E5E5"> to</font>

252
00:18:15,080 --> 00:18:22,310
change destination parameter<font color="#E5E5E5"> we use the</font>

253
00:18:19,580 --> 00:18:26,210
same technique<font color="#CCCCCC"> dot dot slash but it</font>

254
00:18:22,310 --> 00:18:28,990
didn't<font color="#CCCCCC"> work so we try to put the</font>

255
00:18:26,210 --> 00:18:32,720
absolute<font color="#E5E5E5"> path on file system and</font>

256
00:18:28,990 --> 00:18:33,740
suddenly<font color="#CCCCCC"> we was no use mistakes</font>

257
00:18:32,720 --> 00:18:37,760
exceptions

258
00:18:33,740 --> 00:18:42,410
it seems that sharing<font color="#E5E5E5"> service just saved</font>

259
00:18:37,760 --> 00:18:45,410
new configuration we also change not

260
00:18:42,410 --> 00:18:49,610
just<font color="#E5E5E5"> a folder of log files</font><font color="#CCCCCC"> but it's</font>

261
00:18:45,410 --> 00:18:51,920
extension<font color="#E5E5E5"> so let's going check if we</font>

262
00:18:49,610 --> 00:18:56,179
knew<font color="#E5E5E5"> all</font><font color="#CCCCCC"> the file appears and here you</font>

263
00:18:51,920 --> 00:19:01,040
can<font color="#E5E5E5"> see we change log file name on</font>

264
00:18:56,180 --> 00:19:05,390
<font color="#E5E5E5">shelter GSP and change folder file</font>

265
00:19:01,040 --> 00:19:08,420
system<font color="#E5E5E5"> and it's really cool</font><font color="#CCCCCC"> because we</font>

266
00:19:05,390 --> 00:19:10,880
we can change<font color="#E5E5E5"> although</font><font color="#CCCCCC"> you can change</font>

267
00:19:08,420 --> 00:19:12,020
extension and I will describe why this

268
00:19:10,880 --> 00:19:16,280
is so cool

269
00:19:12,020 --> 00:19:20,930
imagine a city system<font color="#E5E5E5"> to simplify our</font>

270
00:19:16,280 --> 00:19:23,240
model we<font color="#E5E5E5"> just choose Java</font><font color="#CCCCCC"> step so there</font>

271
00:19:20,930 --> 00:19:25,550
are a lot<font color="#CCCCCC"> of publications in ASAP system</font>

272
00:19:23,240 --> 00:19:28,600
there are<font color="#CCCCCC"> a lot of</font><font color="#E5E5E5"> users calling these</font>

273
00:19:25,550 --> 00:19:32,030
applications<font color="#CCCCCC"> and while allocation what</font>

274
00:19:28,600 --> 00:19:36,850
if exchange information with database

275
00:19:32,030 --> 00:19:40,520
and all years exceptions<font color="#CCCCCC"> and mistakes</font>

276
00:19:36,850 --> 00:19:46,159
<font color="#E5E5E5">writing in log files like twice like</font>

277
00:19:40,520 --> 00:19:50,690
<font color="#CCCCCC">lock so that's how it works before</font>

278
00:19:46,160 --> 00:19:53,690
and after attack<font color="#CCCCCC"> we have a safe</font><font color="#E5E5E5"> city</font>

279
00:19:50,690 --> 00:19:55,820
<font color="#E5E5E5">system with same applications exchange</font>

280
00:19:53,690 --> 00:19:58,430
information with database they send

281
00:19:55,820 --> 00:20:01,450
users<font color="#E5E5E5"> calling</font><font color="#CCCCCC"> these applications</font><font color="#E5E5E5"> but now</font>

282
00:19:58,430 --> 00:20:05,240
we change log file<font color="#E5E5E5"> location on</font>

283
00:20:01,450 --> 00:20:09,650
<font color="#E5E5E5">application directory and we</font><font color="#CCCCCC"> change</font>

284
00:20:05,240 --> 00:20:13,550
extension of where log files<font color="#E5E5E5"> so when a</font>

285
00:20:09,650 --> 00:20:16,340
CP system find dot JSP file<font color="#E5E5E5"> in</font>

286
00:20:13,550 --> 00:20:19,460
application folder<font color="#E5E5E5"> it parsed it as a</font>

287
00:20:16,340 --> 00:20:24,770
belt<font color="#E5E5E5"> GSP application so it means that</font>

288
00:20:19,460 --> 00:20:29,540
<font color="#E5E5E5">you</font><font color="#CCCCCC"> can get</font><font color="#E5E5E5"> access</font><font color="#CCCCCC"> to this file and all</font>

289
00:20:24,770 --> 00:20:31,430
code will be<font color="#E5E5E5"> parsed as GSP and as you</font>

290
00:20:29,540 --> 00:20:34,909
remember<font color="#CCCCCC"> we can still write in</font>

291
00:20:31,430 --> 00:20:41,150
exceptions and errors<font color="#E5E5E5"> in this log file</font>

292
00:20:34,910 --> 00:20:45,140
and<font color="#E5E5E5"> we</font><font color="#CCCCCC"> can call it removal and if we can</font>

293
00:20:41,150 --> 00:20:48,860
write any code in<font color="#E5E5E5"> this log file we can</font>

294
00:20:45,140 --> 00:20:55,810
execute any comment so let's have a look

295
00:20:48,860 --> 00:20:55,810
how we<font color="#CCCCCC"> can change a log file directly</font>

296
00:20:58,800 --> 00:21:04,340
the first 30 seconds is so boring<font color="#CCCCCC"> so I</font>

297
00:21:01,340 --> 00:21:04,340
just

298
00:21:04,940 --> 00:21:14,570
so we go<font color="#CCCCCC"> to schedule we'll</font><font color="#E5E5E5"> login with</font>

299
00:21:08,910 --> 00:21:14,570
our<font color="#E5E5E5"> new credentials administrator</font>

300
00:21:22,700 --> 00:21:27,340
<font color="#CCCCCC">it's not so fast so we need to wait</font>

301
00:21:31,870 --> 00:21:36,268
yeah

302
00:21:34,190 --> 00:21:38,580
we are

303
00:21:36,269 --> 00:21:43,669
<font color="#CCCCCC">a service schedule so we are authorized</font>

304
00:21:38,580 --> 00:21:48,649
in a city system we can go to<font color="#CCCCCC"> MIT to</font><font color="#E5E5E5"> be</font>

305
00:21:43,669 --> 00:21:48,649
in<font color="#CCCCCC"> CRM service</font>

306
00:21:52,380 --> 00:22:00,050
- with this page

307
00:21:54,930 --> 00:22:00,050
so<font color="#E5E5E5"> we go to admin console</font>

308
00:22:02,700 --> 00:22:07,430
so<font color="#E5E5E5"> one in sub menu on the left hand</font>

309
00:22:12,340 --> 00:22:16,199
and now we can change this nation

310
00:22:20,670 --> 00:22:27,090
if you can see the default log file name

311
00:22:23,520 --> 00:22:33,210
is tres<font color="#CCCCCC"> resume</font><font color="#E5E5E5"> zero</font><font color="#CCCCCC"> the TRC</font>

312
00:22:27,090 --> 00:22:36,110
so now we change on<font color="#E5E5E5"> our one test a lot</font>

313
00:22:33,210 --> 00:22:36,110
without<font color="#E5E5E5"> an extension</font>

314
00:22:37,760 --> 00:22:47,480
and now if<font color="#CCCCCC"> we put special</font><font color="#E5E5E5"> URL in the</font>

315
00:22:43,940 --> 00:22:50,620
browser we can<font color="#E5E5E5"> for example download this</font>

316
00:22:47,480 --> 00:22:54,320
file<font color="#E5E5E5"> without any extension</font>

317
00:22:50,620 --> 00:22:56,899
so if<font color="#E5E5E5"> extension of this file will be the</font>

318
00:22:54,320 --> 00:23:00,320
GSP<font color="#E5E5E5"> a city system will parse this file</font>

319
00:22:56,900 --> 00:23:03,370
as valid<font color="#CCCCCC"> application and</font><font color="#E5E5E5"> environment</font>

320
00:23:00,320 --> 00:23:03,370
story about<font color="#CCCCCC"> twist</font>

321
00:23:12,620 --> 00:23:21,678
so before the second directive travursel

322
00:23:18,620 --> 00:23:26,809
exploitation<font color="#E5E5E5"> we have log file which</font>

323
00:23:21,679 --> 00:23:30,669
extension<font color="#E5E5E5"> log XML or TRC and we couldn't</font>

324
00:23:26,809 --> 00:23:33,049
read this file<font color="#E5E5E5"> via browser but after the</font>

325
00:23:30,669 --> 00:23:36,710
second directory traversal exploitation

326
00:23:33,049 --> 00:23:40,340
we can read<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> write sir</font><font color="#E5E5E5"> we can</font>

327
00:23:36,710 --> 00:23:45,470
write the log file in any<font color="#E5E5E5"> folder on the</font>

328
00:23:40,340 --> 00:23:50,330
system so we found the fouled servlet

329
00:23:45,470 --> 00:23:55,490
<font color="#E5E5E5">where we wrote the log file and we</font>

330
00:23:50,330 --> 00:23:58,730
<font color="#CCCCCC">rename log file to</font><font color="#E5E5E5"> shelter GSP</font><font color="#CCCCCC"> and to</font>

331
00:23:55,490 --> 00:24:05,090
get remote<font color="#CCCCCC"> comment</font><font color="#E5E5E5"> execution in SA P we</font>

332
00:23:58,730 --> 00:24:10,429
need<font color="#E5E5E5"> to we need to</font><font color="#CCCCCC"> write the simple</font><font color="#E5E5E5"> Java</font>

333
00:24:05,090 --> 00:24:13,309
<font color="#E5E5E5">shell code in</font><font color="#CCCCCC"> log file in shell dot JSP</font>

334
00:24:10,429 --> 00:24:16,640
and as you can see that this shell code

335
00:24:13,309 --> 00:24:18,980
gets only<font color="#E5E5E5"> CMD parameter and after that</font>

336
00:24:16,640 --> 00:24:26,330
he will<font color="#E5E5E5"> execute value of</font><font color="#CCCCCC"> Sindhi</font>

337
00:24:18,980 --> 00:24:29,600
parameter so to write this<font color="#E5E5E5"> JSP code in</font>

338
00:24:26,330 --> 00:24:33,289
the log file we need<font color="#E5E5E5"> to send some bad</font>

339
00:24:29,600 --> 00:24:38,510
<font color="#E5E5E5">request to</font><font color="#CCCCCC"> ASAP server</font><font color="#E5E5E5"> because after</font>

340
00:24:33,289 --> 00:24:40,850
after after after then that<font color="#CCCCCC"> acp several</font>

341
00:24:38,510 --> 00:24:44,679
will receive some bad request<font color="#E5E5E5"> he tried</font>

342
00:24:40,850 --> 00:24:48,678
to parse the parameter<font color="#E5E5E5"> and he of course</font>

343
00:24:44,679 --> 00:24:52,520
<font color="#E5E5E5">couldn't do it and he will write in log</font>

344
00:24:48,679 --> 00:24:53,240
file<font color="#E5E5E5"> message that</font><font color="#CCCCCC"> i'm sword your</font>

345
00:24:52,520 --> 00:24:56,658
administrator

346
00:24:53,240 --> 00:24:59,929
I couldn't parse<font color="#CCCCCC"> bla</font><font color="#E5E5E5"> bla bla parameter</font>

347
00:24:56,659 --> 00:25:05,380
and instead of<font color="#E5E5E5"> blah blah blah we we can</font>

348
00:24:59,929 --> 00:25:05,380
write we can write any code

349
00:25:05,520 --> 00:25:18,960
here we<font color="#E5E5E5"> write GSP shellcode</font><font color="#CCCCCC"> here is a</font>

350
00:25:11,870 --> 00:25:21,840
shellcode<font color="#E5E5E5"> in log file and here is what</font>

351
00:25:18,960 --> 00:25:28,520
what it looks like if<font color="#CCCCCC"> you take a closer</font>

352
00:25:21,840 --> 00:25:33,750
look<font color="#E5E5E5"> so and after that if you will call</font>

353
00:25:28,520 --> 00:25:36,090
<font color="#E5E5E5">Sheldor GSP via browser with IP config</font>

354
00:25:33,750 --> 00:25:49,650
you can see the result of comment

355
00:25:36,090 --> 00:25:54,330
execution yeah

356
00:25:49,650 --> 00:26:01,830
<font color="#CCCCCC">to sent</font><font color="#E5E5E5"> bed request to a CP server</font><font color="#CCCCCC"> we we</font>

357
00:25:54,330 --> 00:26:05,510
wrote the Python code<font color="#CCCCCC"> we</font><font color="#E5E5E5"> need to write</font>

358
00:26:01,830 --> 00:26:10,409
<font color="#CCCCCC">also</font><font color="#E5E5E5"> we need to input administrator</font>

359
00:26:05,510 --> 00:26:15,090
login password<font color="#E5E5E5"> and after that</font><font color="#CCCCCC"> the Python</font>

360
00:26:10,410 --> 00:26:22,080
<font color="#CCCCCC">code will send but request and and we</font>

361
00:26:15,090 --> 00:26:27,559
will get<font color="#CCCCCC"> shell code</font><font color="#E5E5E5"> and so on</font><font color="#CCCCCC"> a sip</font>

362
00:26:22,080 --> 00:26:27,559
server so here is law blah blah blah

363
00:26:30,880 --> 00:26:35,250
Oh

364
00:26:32,650 --> 00:26:35,250
yeah

365
00:26:35,930 --> 00:26:41,800
and there is a result of<font color="#CCCCCC"> ipconfig</font>

366
00:26:39,500 --> 00:26:41,800
comment

367
00:26:47,340 --> 00:26:49,999
<font color="#E5E5E5">yep</font>

368
00:26:58,320 --> 00:27:08,950
so let's make a little conclusion and

369
00:27:04,560 --> 00:27:12,970
when we when we found and when and they

370
00:27:08,950 --> 00:27:15,280
say P released security<font color="#E5E5E5"> notes of first</font>

371
00:27:12,970 --> 00:27:19,120
director<font color="#CCCCCC"> terror</font><font color="#E5E5E5"> so the director</font>

372
00:27:15,280 --> 00:27:23,920
traversal in<font color="#E5E5E5"> Redwood we scanned the</font>

373
00:27:19,120 --> 00:27:27,280
<font color="#CCCCCC">internet</font><font color="#E5E5E5"> to understand how many servers</font>

374
00:27:23,920 --> 00:27:31,420
with a redwood component are present in

375
00:27:27,280 --> 00:27:41,320
the wild and we<font color="#CCCCCC"> found</font><font color="#E5E5E5"> around 500 public</font>

376
00:27:31,420 --> 00:27:46,260
s<font color="#E5E5E5"> AP server which which have in which</font>

377
00:27:41,320 --> 00:27:51,220
<font color="#E5E5E5">have available</font><font color="#CCCCCC"> a redwood component and</font>

378
00:27:46,260 --> 00:27:54,640
to protect this<font color="#E5E5E5"> to vulnerability</font><font color="#CCCCCC"> you</font>

379
00:27:51,220 --> 00:27:58,780
<font color="#CCCCCC">need to first install and upgrade your</font>

380
00:27:54,640 --> 00:28:03,430
CRM component and<font color="#CCCCCC"> you need to set</font>

381
00:27:58,780 --> 00:28:16,780
<font color="#E5E5E5">special rule in your firewall to limit</font>

382
00:28:03,430 --> 00:28:20,980
<font color="#E5E5E5">to limit</font><font color="#CCCCCC"> 8 the CRM</font><font color="#E5E5E5"> CRM connection to you</font>

383
00:28:16,780 --> 00:28:25,770
need<font color="#E5E5E5"> to upgrade the redwood component</font>

384
00:28:20,980 --> 00:28:29,890
and after that you<font color="#E5E5E5"> need</font><font color="#CCCCCC"> to upgrade the</font>

385
00:28:25,770 --> 00:28:35,560
<font color="#E5E5E5">you need to install the second s AP node</font>

386
00:28:29,890 --> 00:28:46,420
and from<font color="#E5E5E5"> nist.gov</font><font color="#CCCCCC"> Wow</font>

387
00:28:35,560 --> 00:28:50,370
yeah and from<font color="#CCCCCC"> the nice gov website we</font>

388
00:28:46,420 --> 00:28:53,170
saw that this directory traversal

389
00:28:50,370 --> 00:28:57,479
exploited<font color="#E5E5E5"> it in in the wild we don't</font>

390
00:28:53,170 --> 00:28:57,480
have any<font color="#E5E5E5"> information just just</font><font color="#CCCCCC"> it and</font>

391
00:28:58,550 --> 00:29:05,980
so<font color="#E5E5E5"> let's</font><font color="#CCCCCC"> see thank</font><font color="#E5E5E5"> you if you have any</font>

392
00:29:03,560 --> 00:29:05,980
questions

393
00:29:07,100 --> 00:29:14,429
[Applause]

