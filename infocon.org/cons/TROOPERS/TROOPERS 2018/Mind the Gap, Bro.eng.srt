1
00:00:05,290 --> 00:00:11,280
<font color="#E5E5E5">all right looks good people are settling</font>

2
00:00:09,130 --> 00:00:13,900
they're not not that many people<font color="#CCCCCC"> outside</font>

3
00:00:11,280 --> 00:00:17,259
so<font color="#E5E5E5"> we are continuing with the</font>

4
00:00:13,900 --> 00:00:18,820
do-it-yourself style<font color="#CCCCCC"> session I'm very</font>

5
00:00:17,259 --> 00:00:20,590
<font color="#E5E5E5">excited how that will</font><font color="#CCCCCC"> work out for</font>

6
00:00:18,820 --> 00:00:22,950
network monitoring let's welcome our

7
00:00:20,590 --> 00:00:22,950
speaker

8
00:00:26,680 --> 00:00:30,580
so I think this yeah<font color="#E5E5E5"> like it's still</font>

9
00:00:28,630 --> 00:00:33,339
working hello everyone<font color="#CCCCCC"> I'm Joe Slovak</font>

10
00:00:30,580 --> 00:00:34,960
<font color="#CCCCCC">this was a</font><font color="#E5E5E5"> really nice</font><font color="#CCCCCC"> follow-up</font><font color="#E5E5E5"> for</font>

11
00:00:33,340 --> 00:00:36,790
whoever did the scheduling<font color="#E5E5E5"> did a good</font>

12
00:00:34,960 --> 00:00:38,290
job<font color="#CCCCCC"> in pairing this discussion with the</font>

13
00:00:36,790 --> 00:00:41,050
previous discussion<font color="#E5E5E5"> because really we're</font>

14
00:00:38,290 --> 00:00:43,900
<font color="#CCCCCC">talking about</font><font color="#E5E5E5"> how to do things</font><font color="#CCCCCC"> yourself</font>

15
00:00:41,050 --> 00:00:45,250
to you know<font color="#E5E5E5"> improve your security</font>

16
00:00:43,900 --> 00:00:48,339
posture<font color="#E5E5E5"> nothing I'm going</font><font color="#CCCCCC"> to talk about</font>

17
00:00:45,250 --> 00:00:50,260
<font color="#E5E5E5">today</font><font color="#CCCCCC"> should hopefully be completely new</font>

18
00:00:48,339 --> 00:00:52,269
but perhaps in putting different

19
00:00:50,260 --> 00:00:53,980
<font color="#CCCCCC">open-source technologies and other sorts</font>

20
00:00:52,269 --> 00:00:56,470
of things<font color="#E5E5E5"> that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can go out</font><font color="#CCCCCC"> and grab</font>

21
00:00:53,980 --> 00:00:58,839
repositories for<font color="#E5E5E5"> right</font><font color="#CCCCCC"> now you can do a</font>

22
00:00:56,470 --> 00:01:01,000
much<font color="#E5E5E5"> better job in securing organization</font>

23
00:00:58,839 --> 00:01:02,650
and providing a additional measures for

24
00:01:01,000 --> 00:01:04,540
<font color="#E5E5E5">detection so Who am I</font>

25
00:01:02,650 --> 00:01:07,360
<font color="#E5E5E5">I'm</font><font color="#CCCCCC"> Josh Loic I am a threat intelligence</font>

26
00:01:04,540 --> 00:01:08,890
analyst and adversary<font color="#E5E5E5"> hunter in fact</font>

27
00:01:07,360 --> 00:01:10,690
that's my title<font color="#E5E5E5"> right</font><font color="#CCCCCC"> now I don't</font><font color="#E5E5E5"> know</font>

28
00:01:08,890 --> 00:01:12,520
who made<font color="#CCCCCC"> up that term at drago's but</font><font color="#E5E5E5"> I</font>

29
00:01:10,690 --> 00:01:15,399
do adversary hunting work for<font color="#E5E5E5"> Drago's</font>

30
00:01:12,520 --> 00:01:17,470
finding the bad<font color="#CCCCCC"> people</font><font color="#E5E5E5"> and determining</font>

31
00:01:15,400 --> 00:01:19,060
ways to stop them<font color="#E5E5E5"> but prior to that I</font>

32
00:01:17,470 --> 00:01:21,460
ran the incident<font color="#CCCCCC"> response team at Los</font>

33
00:01:19,060 --> 00:01:23,710
Alamos<font color="#CCCCCC"> National Laboratory</font><font color="#E5E5E5"> so the</font><font color="#CCCCCC"> US</font>

34
00:01:21,460 --> 00:01:25,419
<font color="#CCCCCC">Department of Energy I was a</font><font color="#E5E5E5"> naval</font>

35
00:01:23,710 --> 00:01:27,729
officer<font color="#CCCCCC"> prior to that for</font><font color="#E5E5E5"> about five</font>

36
00:01:25,420 --> 00:01:30,400
<font color="#CCCCCC">years and then if you go way back I was</font>

37
00:01:27,729 --> 00:01:32,230
actually<font color="#E5E5E5"> a philosophy major in school</font>

38
00:01:30,400 --> 00:01:34,270
<font color="#E5E5E5">and I dropped out</font><font color="#CCCCCC"> of graduate school</font><font color="#E5E5E5"> and</font>

39
00:01:32,230 --> 00:01:36,070
I<font color="#CCCCCC"> realized that</font><font color="#E5E5E5"> getting a</font><font color="#CCCCCC"> PhD in</font>

40
00:01:34,270 --> 00:01:38,140
philosophy<font color="#E5E5E5"> it was a shortcut to a life</font>

41
00:01:36,070 --> 00:01:40,059
of poverty and other sorts of<font color="#CCCCCC"> things</font>

42
00:01:38,140 --> 00:01:41,320
especially<font color="#E5E5E5"> in the United States so</font>

43
00:01:40,060 --> 00:01:42,580
enough about<font color="#CCCCCC"> me let's</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about where</font>

44
00:01:41,320 --> 00:01:44,919
we're<font color="#CCCCCC"> gonna go</font><font color="#E5E5E5"> so we're gonna talk about</font>

45
00:01:42,580 --> 00:01:47,470
<font color="#E5E5E5">network and host visibility and trying</font>

46
00:01:44,920 --> 00:01:49,270
to leverage network to<font color="#CCCCCC"> improve what we</font>

47
00:01:47,470 --> 00:01:51,460
can see from a host based perspective

48
00:01:49,270 --> 00:01:54,699
<font color="#E5E5E5">sounds</font><font color="#CCCCCC"> contradictory but bear with me</font>

49
00:01:51,460 --> 00:01:56,380
it'll make sense<font color="#E5E5E5"> trust me trust me</font><font color="#CCCCCC"> then</font>

50
00:01:54,700 --> 00:01:57,790
in order to<font color="#E5E5E5"> show you that this actually</font>

51
00:01:56,380 --> 00:02:00,280
does<font color="#E5E5E5"> work we'll talk</font><font color="#CCCCCC"> about some use</font>

52
00:01:57,790 --> 00:02:02,620
cases<font color="#E5E5E5"> it's tied specifically to the ICS</font>

53
00:02:00,280 --> 00:02:05,110
room so I do ICS security research right

54
00:02:02,620 --> 00:02:06,250
now<font color="#E5E5E5"> as my full-time job though these</font>

55
00:02:05,110 --> 00:02:08,470
techniques are certainly applicable

56
00:02:06,250 --> 00:02:10,690
<font color="#E5E5E5">elsewhere but they're especially useful</font>

57
00:02:08,470 --> 00:02:12,370
in the control system environment<font color="#E5E5E5"> for</font>

58
00:02:10,690 --> 00:02:13,930
reasons I'll get into<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then we'll</font>

59
00:02:12,370 --> 00:02:15,879
also<font color="#E5E5E5"> talk about some limitations to this</font>

60
00:02:13,930 --> 00:02:17,379
<font color="#E5E5E5">approach and other certain ways</font><font color="#CCCCCC"> that you</font>

61
00:02:15,879 --> 00:02:19,840
can work around them to<font color="#E5E5E5"> make it more</font>

62
00:02:17,379 --> 00:02:20,950
robust for your own uses<font color="#E5E5E5"> so how did this</font>

63
00:02:19,840 --> 00:02:23,230
<font color="#CCCCCC">conversations start</font>

64
00:02:20,950 --> 00:02:25,480
well<font color="#E5E5E5"> let's stir it out with a tweet as</font>

65
00:02:23,230 --> 00:02:26,980
so many<font color="#E5E5E5"> things seem to</font><font color="#CCCCCC"> do these days but</font>

66
00:02:25,480 --> 00:02:28,030
anyway regardless<font color="#E5E5E5"> what do you think of</font>

67
00:02:26,980 --> 00:02:29,709
<font color="#E5E5E5">mr. malware Jake</font>

68
00:02:28,030 --> 00:02:31,480
he had this<font color="#CCCCCC"> poll up a while ago for like</font>

69
00:02:29,709 --> 00:02:33,700
which do you need<font color="#E5E5E5"> more</font><font color="#CCCCCC"> network our</font><font color="#E5E5E5"> host</font>

70
00:02:31,480 --> 00:02:35,769
visibility my answer is

71
00:02:33,700 --> 00:02:38,380
well why not<font color="#E5E5E5"> both</font><font color="#CCCCCC"> you know really in</font>

72
00:02:35,770 --> 00:02:40,300
looking<font color="#E5E5E5"> at the problem set for advanced</font>

73
00:02:38,380 --> 00:02:41,709
threats is that you have artifacts that

74
00:02:40,300 --> 00:02:44,080
<font color="#E5E5E5">you're going to</font><font color="#CCCCCC"> observe on both a</font>

75
00:02:41,709 --> 00:02:46,650
network and a<font color="#CCCCCC"> host level and not having</font>

76
00:02:44,080 --> 00:02:48,640
<font color="#E5E5E5">one means that the other is going to be</font>

77
00:02:46,650 --> 00:02:50,530
<font color="#CCCCCC">disadvantage</font><font color="#E5E5E5"> to a certain extent you're</font>

78
00:02:48,640 --> 00:02:52,839
not going to get the complete picture<font color="#E5E5E5"> so</font>

79
00:02:50,530 --> 00:02:55,569
if we need both of<font color="#E5E5E5"> these though</font><font color="#CCCCCC"> you</font>

80
00:02:52,840 --> 00:02:57,550
don't often find<font color="#CCCCCC"> them all the</font><font color="#E5E5E5"> time at</font>

81
00:02:55,569 --> 00:02:59,649
least<font color="#E5E5E5"> not to</font><font color="#CCCCCC"> the extent that you want</font><font color="#E5E5E5"> so</font>

82
00:02:57,550 --> 00:03:02,380
host<font color="#CCCCCC"> base</font><font color="#E5E5E5"> monitoring is certainly vital</font>

83
00:02:59,650 --> 00:03:03,910
but in terms<font color="#E5E5E5"> of rollout deployment it's</font>

84
00:03:02,380 --> 00:03:07,209
a lot less<font color="#E5E5E5"> mature like we can talk about</font>

85
00:03:03,910 --> 00:03:09,280
<font color="#E5E5E5">you know</font><font color="#CCCCCC"> using the</font><font color="#E5E5E5"> beats modules doing</font>

86
00:03:07,209 --> 00:03:10,660
sis<font color="#CCCCCC"> bond forwarding to elastic and you</font>

87
00:03:09,280 --> 00:03:12,840
<font color="#CCCCCC">know all</font><font color="#E5E5E5"> sorts of other</font><font color="#CCCCCC"> open source</font>

88
00:03:10,660 --> 00:03:15,549
<font color="#E5E5E5">solutions</font><font color="#CCCCCC"> or buying really</font><font color="#E5E5E5"> pricey</font>

89
00:03:12,840 --> 00:03:18,250
endpoint solutions like your carbon

90
00:03:15,549 --> 00:03:19,360
blacks or your<font color="#E5E5E5"> Falken strike whatever I</font>

91
00:03:18,250 --> 00:03:20,739
can't<font color="#CCCCCC"> remember the name of</font><font color="#E5E5E5"> it off the</font>

92
00:03:19,360 --> 00:03:23,440
<font color="#CCCCCC">top of</font><font color="#E5E5E5"> my head but big commercial</font>

93
00:03:20,739 --> 00:03:24,549
products<font color="#E5E5E5"> that cost a</font><font color="#CCCCCC"> lot of money and we</font>

94
00:03:23,440 --> 00:03:26,859
know about<font color="#E5E5E5"> these things but they're</font>

95
00:03:24,549 --> 00:03:28,360
<font color="#E5E5E5">still not out there and especially from</font>

96
00:03:26,860 --> 00:03:30,069
a centralized logging standpoint what

97
00:03:28,360 --> 00:03:31,900
we'd<font color="#CCCCCC"> want them to be network based</font>

98
00:03:30,069 --> 00:03:33,609
monitoring however is a lot more<font color="#E5E5E5"> mature</font>

99
00:03:31,900 --> 00:03:34,900
<font color="#E5E5E5">and</font><font color="#CCCCCC"> not only</font><font color="#E5E5E5"> that</font><font color="#CCCCCC"> but the nature in</font>

100
00:03:33,610 --> 00:03:37,569
which<font color="#E5E5E5"> we deploy it it's typically</font>

101
00:03:34,900 --> 00:03:41,230
sitting on centralized appliances that

102
00:03:37,569 --> 00:03:43,630
we IT<font color="#E5E5E5"> hopefully IT security have a lot</font>

103
00:03:41,230 --> 00:03:45,459
<font color="#CCCCCC">of control over you control the</font><font color="#E5E5E5"> network</font>

104
00:03:43,630 --> 00:03:48,400
infrastructure where the firewall is and

105
00:03:45,459 --> 00:03:50,109
how<font color="#E5E5E5"> those logs work</font><font color="#CCCCCC"> but unfortunately</font>

106
00:03:48,400 --> 00:03:51,190
that's likely<font color="#E5E5E5"> to be</font><font color="#CCCCCC"> a less complete</font>

107
00:03:50,109 --> 00:03:52,930
picture<font color="#E5E5E5"> of things because you're going</font>

108
00:03:51,190 --> 00:03:54,910
<font color="#E5E5E5">to miss out</font><font color="#CCCCCC"> on all those</font><font color="#E5E5E5"> host artifacts</font>

109
00:03:52,930 --> 00:03:57,880
<font color="#E5E5E5">that you really want to</font><font color="#CCCCCC"> get your eyes on</font>

110
00:03:54,910 --> 00:04:00,310
so the best<font color="#CCCCCC"> answer really</font><font color="#E5E5E5"> is to use both</font>

111
00:03:57,880 --> 00:04:01,780
of these<font color="#E5E5E5"> complimentary to one another in</font>

112
00:04:00,310 --> 00:04:03,549
support of one another<font color="#E5E5E5"> to</font><font color="#CCCCCC"> get a complete</font>

113
00:04:01,780 --> 00:04:05,590
<font color="#CCCCCC">picture but unfortunately you're not</font>

114
00:04:03,549 --> 00:04:07,510
<font color="#CCCCCC">always going to</font><font color="#E5E5E5"> be in that position</font><font color="#CCCCCC"> so</font>

115
00:04:05,590 --> 00:04:08,680
visibility certainly depends upon what

116
00:04:07,510 --> 00:04:11,380
<font color="#E5E5E5">kind of environment that you're in</font>

117
00:04:08,680 --> 00:04:12,670
so if you're in a<font color="#E5E5E5"> very</font><font color="#CCCCCC"> well-funded you</font>

118
00:04:11,380 --> 00:04:14,920
<font color="#E5E5E5">know get a lot of smart</font><font color="#CCCCCC"> people working</font>

119
00:04:12,670 --> 00:04:16,238
<font color="#E5E5E5">for you that have you know lots of time</font>

120
00:04:14,920 --> 00:04:17,469
<font color="#CCCCCC">on their hands to</font><font color="#E5E5E5"> roll these sorts of</font>

121
00:04:16,238 --> 00:04:19,719
things<font color="#CCCCCC"> out and</font><font color="#E5E5E5"> you're in a standard</font>

122
00:04:17,470 --> 00:04:21,220
Windows domain environment<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have all</font>

123
00:04:19,720 --> 00:04:23,020
the security tools you could possibly

124
00:04:21,220 --> 00:04:25,270
<font color="#E5E5E5">want to play with and potentially</font><font color="#CCCCCC"> the</font>

125
00:04:23,020 --> 00:04:26,799
budget to<font color="#E5E5E5"> make that happen</font><font color="#CCCCCC"> but if you're</font>

126
00:04:25,270 --> 00:04:28,390
not in that<font color="#E5E5E5"> sort of an environment</font><font color="#CCCCCC"> like</font>

127
00:04:26,800 --> 00:04:29,710
say you're running<font color="#CCCCCC"> an industrial control</font>

128
00:04:28,390 --> 00:04:33,250
system<font color="#CCCCCC"> Network where you have a</font>

129
00:04:29,710 --> 00:04:35,859
combination<font color="#E5E5E5"> of Windows Server 2003 yes</font>

130
00:04:33,250 --> 00:04:37,450
this does<font color="#E5E5E5"> happen</font><font color="#CCCCCC"> all the way up to maybe</font>

131
00:04:35,860 --> 00:04:38,950
if you're<font color="#CCCCCC"> lucky a couple of wins seven</font>

132
00:04:37,450 --> 00:04:40,389
devices<font color="#CCCCCC"> that are out there</font><font color="#E5E5E5"> and then some</font>

133
00:04:38,950 --> 00:04:42,760
other hodgepodge<font color="#E5E5E5"> of systems</font>

134
00:04:40,389 --> 00:04:44,349
<font color="#E5E5E5">there's no</font><font color="#CCCCCC"> Active Directory</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> logging</font>

135
00:04:42,760 --> 00:04:45,780
is poor<font color="#CCCCCC"> what do you do in a situation</font>

136
00:04:44,349 --> 00:04:49,469
<font color="#CCCCCC">like that</font><font color="#E5E5E5"> where</font><font color="#CCCCCC"> you're</font>

137
00:04:45,780 --> 00:04:50,669
visibility is nil<font color="#E5E5E5"> if to say the least</font>

138
00:04:49,470 --> 00:04:52,710
<font color="#CCCCCC">well you know there's different</font>

139
00:04:50,670 --> 00:04:53,820
<font color="#E5E5E5">challenges</font><font color="#CCCCCC"> to this but also the nature</font>

140
00:04:52,710 --> 00:04:55,710
<font color="#CCCCCC">of</font><font color="#E5E5E5"> the network provides some</font>

141
00:04:53,820 --> 00:04:58,620
opportunities that<font color="#CCCCCC"> give you options to</font>

142
00:04:55,710 --> 00:05:00,388
<font color="#CCCCCC">approach the problem</font><font color="#E5E5E5"> so you know host</font>

143
00:04:58,620 --> 00:05:02,010
might be higher fidelity ground truth

144
00:05:00,389 --> 00:05:04,020
difficult to push out and<font color="#E5E5E5"> manage for</font>

145
00:05:02,010 --> 00:05:05,490
reasons<font color="#E5E5E5"> I talked about you know network</font>

146
00:05:04,020 --> 00:05:08,849
<font color="#E5E5E5">even when you're talking</font><font color="#CCCCCC"> about an</font>

147
00:05:05,490 --> 00:05:10,680
environment<font color="#CCCCCC"> like you</font><font color="#E5E5E5"> know the dirty hard</font>

148
00:05:08,850 --> 00:05:12,419
to manage<font color="#E5E5E5"> control system environment I</font>

149
00:05:10,680 --> 00:05:13,440
just<font color="#CCCCCC"> referenced</font><font color="#E5E5E5"> you still have switches</font>

150
00:05:12,419 --> 00:05:14,909
and routers you still have the

151
00:05:13,440 --> 00:05:17,430
capability of<font color="#CCCCCC"> getting traffic</font><font color="#E5E5E5"> off the</font>

152
00:05:14,910 --> 00:05:19,140
<font color="#E5E5E5">wire or passively monitoring things so</font>

153
00:05:17,430 --> 00:05:21,120
what if we can use<font color="#E5E5E5"> that</font><font color="#CCCCCC"> to try and</font><font color="#E5E5E5"> shed</font>

154
00:05:19,140 --> 00:05:22,800
some<font color="#CCCCCC"> light on the problem</font><font color="#E5E5E5"> that we're</font>

155
00:05:21,120 --> 00:05:24,690
trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> solve to you know</font>

156
00:05:22,800 --> 00:05:25,919
bridge the gap<font color="#CCCCCC"> so to speak between</font><font color="#E5E5E5"> the</font>

157
00:05:24,690 --> 00:05:28,710
visibility that<font color="#CCCCCC"> we have and the</font>

158
00:05:25,919 --> 00:05:30,599
visibility<font color="#CCCCCC"> that we want so</font><font color="#E5E5E5"> let's use</font>

159
00:05:28,710 --> 00:05:32,729
network to try and capture as much<font color="#E5E5E5"> of</font>

160
00:05:30,600 --> 00:05:34,560
hosts as we can so you can<font color="#E5E5E5"> leverage</font>

161
00:05:32,730 --> 00:05:37,260
<font color="#E5E5E5">network</font><font color="#CCCCCC"> visibility to try and get a</font>

162
00:05:34,560 --> 00:05:39,300
grasp of what<font color="#E5E5E5"> might be</font><font color="#CCCCCC"> going on further</font>

163
00:05:37,260 --> 00:05:41,789
<font color="#E5E5E5">down the line</font><font color="#CCCCCC"> at that host based</font><font color="#E5E5E5"> level</font>

164
00:05:39,300 --> 00:05:44,040
so files moving across<font color="#E5E5E5"> the wire or even</font>

165
00:05:41,790 --> 00:05:45,720
commands<font color="#E5E5E5"> via visible protocols or sort</font>

166
00:05:44,040 --> 00:05:47,850
of<font color="#E5E5E5"> a</font><font color="#CCCCCC"> hybrid between</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> two you know you</font>

167
00:05:45,720 --> 00:05:50,010
see a<font color="#E5E5E5"> lot of advanced but actors we'll</font>

168
00:05:47,850 --> 00:05:52,320
talk<font color="#CCCCCC"> about one in a</font><font color="#E5E5E5"> little bit that</font><font color="#CCCCCC"> love</font>

169
00:05:50,010 --> 00:05:54,539
<font color="#E5E5E5">using things like scripting objects</font>

170
00:05:52,320 --> 00:05:56,010
<font color="#E5E5E5">shell scripts etc to automate their</font>

171
00:05:54,540 --> 00:05:57,990
commands<font color="#E5E5E5"> and you can pull the content of</font>

172
00:05:56,010 --> 00:06:00,120
those if you've got full capture on<font color="#E5E5E5"> the</font>

173
00:05:57,990 --> 00:06:01,680
resulting communication link but even if

174
00:06:00,120 --> 00:06:04,229
clear text is unavailable you<font color="#E5E5E5"> still have</font>

175
00:06:01,680 --> 00:06:05,550
<font color="#CCCCCC">options for tying together how different</font>

176
00:06:04,229 --> 00:06:07,890
nodes are communicating<font color="#CCCCCC"> to one another</font>

177
00:06:05,550 --> 00:06:09,419
to tell a story<font color="#E5E5E5"> based upon protocol and</font>

178
00:06:07,890 --> 00:06:10,830
traffic type of what might<font color="#CCCCCC"> be</font><font color="#E5E5E5"> going on</font>

179
00:06:09,419 --> 00:06:13,650
so to try and<font color="#E5E5E5"> put</font><font color="#CCCCCC"> all these things</font>

180
00:06:10,830 --> 00:06:15,690
<font color="#CCCCCC">together what you want to do is leverage</font>

181
00:06:13,650 --> 00:06:17,070
<font color="#E5E5E5">the attackers dependencies for how they</font>

182
00:06:15,690 --> 00:06:19,950
have to actually<font color="#CCCCCC"> interact</font><font color="#E5E5E5"> with your</font>

183
00:06:17,070 --> 00:06:22,770
network<font color="#CCCCCC"> in</font><font color="#E5E5E5"> order</font><font color="#CCCCCC"> to gain visibility and</font>

184
00:06:19,950 --> 00:06:25,349
insight into what they are<font color="#CCCCCC"> doing</font><font color="#E5E5E5"> so the</font>

185
00:06:22,770 --> 00:06:27,719
data commands must<font color="#E5E5E5"> come from</font><font color="#CCCCCC"> somewhere</font>

186
00:06:25,350 --> 00:06:30,030
<font color="#E5E5E5">exfiltrated data has to</font><font color="#CCCCCC"> get out and go</font>

187
00:06:27,720 --> 00:06:31,590
<font color="#E5E5E5">to somewhere</font><font color="#CCCCCC"> you know identify what</font>

188
00:06:30,030 --> 00:06:33,210
critical nodes have to be passed in

189
00:06:31,590 --> 00:06:36,200
order<font color="#E5E5E5"> for these things to take</font><font color="#CCCCCC"> place and</font>

190
00:06:33,210 --> 00:06:40,080
then identify and parse traffic at those

191
00:06:36,200 --> 00:06:42,450
strategic<font color="#CCCCCC"> and mid points so if we were</font>

192
00:06:40,080 --> 00:06:43,950
to look at this at a diagram so to speak

193
00:06:42,450 --> 00:06:46,050
you<font color="#E5E5E5"> know somewhere out</font><font color="#CCCCCC"> there</font>

194
00:06:43,950 --> 00:06:47,789
<font color="#E5E5E5">you have an adversary</font><font color="#CCCCCC"> whether it's some</font>

195
00:06:46,050 --> 00:06:49,470
sort<font color="#E5E5E5"> of external situ</font><font color="#CCCCCC"> or you have an</font>

196
00:06:47,790 --> 00:06:50,640
internal compromised host<font color="#CCCCCC"> you know if</font>

197
00:06:49,470 --> 00:06:52,020
you're talking<font color="#E5E5E5"> about something where you</font>

198
00:06:50,640 --> 00:06:53,760
have two separate networks<font color="#CCCCCC"> like</font><font color="#E5E5E5"> a</font>

199
00:06:52,020 --> 00:06:55,500
control system<font color="#E5E5E5"> Network and the IT or</font>

200
00:06:53,760 --> 00:06:58,140
<font color="#E5E5E5">business</font><font color="#CCCCCC"> Network</font><font color="#E5E5E5"> you know the attacker</font>

201
00:06:55,500 --> 00:07:01,200
has to<font color="#E5E5E5"> control his or her it's probably</font>

202
00:06:58,140 --> 00:07:03,599
<font color="#CCCCCC">he unfortunately</font><font color="#E5E5E5"> implants from somewhere</font>

203
00:07:01,200 --> 00:07:04,890
<font color="#CCCCCC">so</font><font color="#E5E5E5"> take advantage of the fact</font><font color="#CCCCCC"> that they</font>

204
00:07:03,600 --> 00:07:06,960
need<font color="#CCCCCC"> to communicate</font><font color="#E5E5E5"> from what they</font>

205
00:07:04,890 --> 00:07:08,310
control to what they need to<font color="#E5E5E5"> influence</font>

206
00:07:06,960 --> 00:07:10,020
or where they need<font color="#E5E5E5"> to gather things from</font>

207
00:07:08,310 --> 00:07:12,450
so<font color="#CCCCCC"> that means they</font><font color="#E5E5E5"> have to pass through</font>

208
00:07:10,020 --> 00:07:13,770
one<font color="#E5E5E5"> or probably more</font><font color="#CCCCCC"> Network choke</font>

209
00:07:12,450 --> 00:07:16,200
points<font color="#E5E5E5"> so these could be inter or intra</font>

210
00:07:13,770 --> 00:07:18,719
network based and it gives you<font color="#CCCCCC"> options</font>

211
00:07:16,200 --> 00:07:20,430
<font color="#CCCCCC">for monitoring and capturing once you</font>

212
00:07:18,720 --> 00:07:21,900
identify what those<font color="#E5E5E5"> choke points are and</font>

213
00:07:20,430 --> 00:07:23,760
<font color="#E5E5E5">you can increase</font><font color="#CCCCCC"> your visibility again</font>

214
00:07:21,900 --> 00:07:25,440
these are presumably devices that we

215
00:07:23,760 --> 00:07:27,750
have far more control<font color="#CCCCCC"> over than we do on</font>

216
00:07:25,440 --> 00:07:29,700
<font color="#CCCCCC">every endpoint in our network then</font><font color="#E5E5E5"> you</font>

217
00:07:27,750 --> 00:07:31,590
know you can monitor what<font color="#CCCCCC"> goes from the</font>

218
00:07:29,700 --> 00:07:33,690
adversary to<font color="#CCCCCC"> their target or their</font>

219
00:07:31,590 --> 00:07:34,940
victim<font color="#E5E5E5"> victim seems like it's shading</font>

220
00:07:33,690 --> 00:07:37,080
thing is<font color="#E5E5E5"> being completely instant</font>

221
00:07:34,940 --> 00:07:38,700
innocent but if you<font color="#E5E5E5"> open a fish and</font>

222
00:07:37,080 --> 00:07:40,050
enable macros you're not as<font color="#E5E5E5"> much of</font><font color="#CCCCCC"> a</font>

223
00:07:38,700 --> 00:07:42,270
victim<font color="#CCCCCC"> in my opinion</font><font color="#E5E5E5"> you're still a</font>

224
00:07:40,050 --> 00:07:44,100
<font color="#E5E5E5">target though anyway so you see things</font>

225
00:07:42,270 --> 00:07:46,049
like commands<font color="#E5E5E5"> second stage is being</font>

226
00:07:44,100 --> 00:07:48,000
<font color="#E5E5E5">passed down or in the reverse order</font>

227
00:07:46,050 --> 00:07:50,520
<font color="#E5E5E5">excellent rated data if you're talking</font>

228
00:07:48,000 --> 00:07:52,440
about an information theft case or

229
00:07:50,520 --> 00:07:54,539
<font color="#E5E5E5">whatever or so seeing the interplay</font>

230
00:07:52,440 --> 00:07:56,430
between the<font color="#CCCCCC"> two</font><font color="#E5E5E5"> endpoints and monitoring</font>

231
00:07:54,540 --> 00:07:58,890
<font color="#E5E5E5">things in the middle gives you an eye at</font>

232
00:07:56,430 --> 00:08:00,540
least<font color="#E5E5E5"> the</font><font color="#CCCCCC"> option to start</font><font color="#E5E5E5"> determining</font>

233
00:07:58,890 --> 00:08:03,270
what sort of things<font color="#E5E5E5"> are</font><font color="#CCCCCC"> being</font><font color="#E5E5E5"> passed</font>

234
00:08:00,540 --> 00:08:04,050
between points a and points B so how do

235
00:08:03,270 --> 00:08:05,190
we<font color="#E5E5E5"> do this then</font>

236
00:08:04,050 --> 00:08:06,330
well we already<font color="#E5E5E5"> talked a little bit</font>

237
00:08:05,190 --> 00:08:07,620
about<font color="#E5E5E5"> bro in the previous discussion</font>

238
00:08:06,330 --> 00:08:10,650
<font color="#E5E5E5">we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk a little bit</font><font color="#CCCCCC"> more</font>

239
00:08:07,620 --> 00:08:12,540
about it<font color="#CCCCCC"> today</font><font color="#E5E5E5"> so bro is awesome it's an</font>

240
00:08:10,650 --> 00:08:15,750
<font color="#E5E5E5">open source network</font><font color="#CCCCCC"> traffic analyzer I</font>

241
00:08:12,540 --> 00:08:18,540
grew up speaking snort<font color="#CCCCCC"> I was in snort</font>

242
00:08:15,750 --> 00:08:20,070
shops my entire life up<font color="#CCCCCC"> until I started</font>

243
00:08:18,540 --> 00:08:21,300
work in the Department of Energy<font color="#CCCCCC"> which</font>

244
00:08:20,070 --> 00:08:22,650
lo and behold bro<font color="#CCCCCC"> has initially</font>

245
00:08:21,300 --> 00:08:26,310
<font color="#CCCCCC">developed at Lawrence Berkeley National</font>

246
00:08:22,650 --> 00:08:28,380
Laboratory<font color="#E5E5E5"> go do</font><font color="#CCCCCC"> e</font><font color="#E5E5E5"> and we started</font><font color="#CCCCCC"> using</font>

247
00:08:26,310 --> 00:08:30,510
it more robustly in<font color="#E5E5E5"> that environment</font><font color="#CCCCCC"> I</font>

248
00:08:28,380 --> 00:08:32,189
will confess I<font color="#E5E5E5"> am NOT a bro expert I am</font>

249
00:08:30,510 --> 00:08:34,080
still<font color="#E5E5E5"> learning how to use it</font><font color="#CCCCCC"> after your</font>

250
00:08:32,190 --> 00:08:36,090
in trying to shrug away my history of

251
00:08:34,080 --> 00:08:37,740
<font color="#E5E5E5">using snort paste</font><font color="#CCCCCC"> rule sets but bro</font>

252
00:08:36,090 --> 00:08:40,260
gives the capability of diving<font color="#E5E5E5"> into</font>

253
00:08:37,740 --> 00:08:41,909
traffic flows and content to<font color="#E5E5E5"> the extent</font>

254
00:08:40,260 --> 00:08:43,409
that snort just doesn't<font color="#E5E5E5"> allow so it</font>

255
00:08:41,909 --> 00:08:45,870
gives you much more<font color="#E5E5E5"> flexibility in terms</font>

256
00:08:43,409 --> 00:08:47,790
of<font color="#E5E5E5"> what you</font><font color="#CCCCCC"> can analyze</font><font color="#E5E5E5"> with traffic and</font>

257
00:08:45,870 --> 00:08:50,550
what sort of<font color="#E5E5E5"> data you can suss out from</font>

258
00:08:47,790 --> 00:08:52,980
when you have full traffic capture

259
00:08:50,550 --> 00:08:54,569
more importantly<font color="#E5E5E5"> is that there's a lot</font>

260
00:08:52,980 --> 00:08:57,390
<font color="#E5E5E5">of flexibility and continued development</font>

261
00:08:54,570 --> 00:08:59,490
<font color="#E5E5E5">that's all open source around bro as a</font>

262
00:08:57,390 --> 00:09:01,439
network monitoring solution so you<font color="#E5E5E5"> get</font>

263
00:08:59,490 --> 00:09:03,450
tons<font color="#E5E5E5"> of flexibility with almost zero</font>

264
00:09:01,440 --> 00:09:04,470
developmental effort on your<font color="#CCCCCC"> own and in</font>

265
00:09:03,450 --> 00:09:06,330
order<font color="#E5E5E5"> to deploy it and make it</font>

266
00:09:04,470 --> 00:09:08,910
functional<font color="#E5E5E5"> and it was</font><font color="#CCCCCC"> referenced earlier</font>

267
00:09:06,330 --> 00:09:11,190
<font color="#E5E5E5">that security onion can be deployed you</font>

268
00:09:08,910 --> 00:09:13,319
know<font color="#CCCCCC"> no problems whatsoever</font><font color="#E5E5E5"> as being a</font>

269
00:09:11,190 --> 00:09:14,700
easy turnkey sort of solution to<font color="#CCCCCC"> get up</font>

270
00:09:13,320 --> 00:09:17,520
and<font color="#E5E5E5"> running on this so long as you can</font>

271
00:09:14,700 --> 00:09:18,720
point a traffic<font color="#CCCCCC"> feet at it but one of</font>

272
00:09:17,520 --> 00:09:20,370
<font color="#E5E5E5">the most important things</font><font color="#CCCCCC"> that Perl</font>

273
00:09:18,720 --> 00:09:23,010
allows you to do and<font color="#CCCCCC"> that starts getting</font>

274
00:09:20,370 --> 00:09:24,600
<font color="#E5E5E5">us into the mindset</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> capturing</font>

275
00:09:23,010 --> 00:09:26,250
host-based<font color="#E5E5E5"> artifacts</font><font color="#CCCCCC"> from a network</font>

276
00:09:24,600 --> 00:09:28,440
capture is that you can do complete file

277
00:09:26,250 --> 00:09:30,270
carving out of<font color="#CCCCCC"> Bro</font><font color="#E5E5E5"> well normally be an</font>

278
00:09:28,440 --> 00:09:31,770
arduous<font color="#CCCCCC"> and quite frankly a pain in the</font>

279
00:09:30,270 --> 00:09:33,930
<font color="#CCCCCC">ass sort of</font><font color="#E5E5E5"> task if</font><font color="#CCCCCC"> you just have a</font>

280
00:09:31,770 --> 00:09:35,090
packet<font color="#CCCCCC"> capture and</font><font color="#E5E5E5"> then carve a file out</font>

281
00:09:33,930 --> 00:09:37,589
<font color="#CCCCCC">of it especially if you're not talking</font>

282
00:09:35,090 --> 00:09:39,990
<font color="#E5E5E5">HTTP but something like SMB</font><font color="#CCCCCC"> or whatever</font>

283
00:09:37,590 --> 00:09:41,790
<font color="#CCCCCC">burrow automatically bro understands the</font>

284
00:09:39,990 --> 00:09:43,800
protocol it can<font color="#CCCCCC"> cover files out of that</font>

285
00:09:41,790 --> 00:09:46,439
stream and<font color="#E5E5E5"> just drop it into a directory</font>

286
00:09:43,800 --> 00:09:48,030
for<font color="#CCCCCC"> you to do something</font><font color="#E5E5E5"> with so the only</font>

287
00:09:46,440 --> 00:09:50,010
limitation on this is that<font color="#CCCCCC"> you know as</font>

288
00:09:48,030 --> 00:09:52,020
long as bro<font color="#E5E5E5"> as a processor for</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> it can</font>

289
00:09:50,010 --> 00:09:53,550
carve<font color="#E5E5E5"> things out</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> it so long as that</font>

290
00:09:52,020 --> 00:09:54,960
traffic's not encrypted<font color="#E5E5E5"> we'll come back</font>

291
00:09:53,550 --> 00:09:58,260
to that<font color="#CCCCCC"> point</font><font color="#E5E5E5"> and a little later since</font>

292
00:09:54,960 --> 00:10:00,180
it's a<font color="#E5E5E5"> very</font><font color="#CCCCCC"> non-trivial one but a stupid</font>

293
00:09:58,260 --> 00:10:02,880
<font color="#CCCCCC">simple example of file carving with bro</font>

294
00:10:00,180 --> 00:10:04,620
<font color="#E5E5E5">is this just carve everything that you</font>

295
00:10:02,880 --> 00:10:06,300
see for every preprocessor that you have

296
00:10:04,620 --> 00:10:08,460
or every protocol you understand<font color="#E5E5E5"> and</font>

297
00:10:06,300 --> 00:10:09,839
drop it into the<font color="#E5E5E5"> working directory</font><font color="#CCCCCC"> now</font>

298
00:10:08,460 --> 00:10:12,870
that could get a<font color="#E5E5E5"> little noisy and a</font>

299
00:10:09,840 --> 00:10:15,540
little overbearing<font color="#E5E5E5"> fairly shortly but</font>

300
00:10:12,870 --> 00:10:16,710
this<font color="#E5E5E5"> isn't hard in order to structure if</font>

301
00:10:15,540 --> 00:10:17,969
you want to get a little<font color="#E5E5E5"> more complex</font>

302
00:10:16,710 --> 00:10:19,530
and this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> in a little</font><font color="#E5E5E5"> bit of an eye</font>

303
00:10:17,970 --> 00:10:21,630
chart<font color="#CCCCCC"> the slides will be available</font><font color="#E5E5E5"> later</font>

304
00:10:19,530 --> 00:10:23,339
<font color="#E5E5E5">you know you can certainly build</font><font color="#CCCCCC"> things</font>

305
00:10:21,630 --> 00:10:26,130
out so<font color="#E5E5E5"> that you capture artifacts like</font>

306
00:10:23,340 --> 00:10:28,710
hash values at a time stamp at<font color="#E5E5E5"> the</font>

307
00:10:26,130 --> 00:10:30,000
mimetype based upon the the<font color="#E5E5E5"> file</font><font color="#CCCCCC"> etc</font><font color="#E5E5E5"> you</font>

308
00:10:28,710 --> 00:10:32,580
<font color="#CCCCCC">know it's</font><font color="#E5E5E5"> really how much work are</font><font color="#CCCCCC"> you</font>

309
00:10:30,000 --> 00:10:34,500
willing to put in to get out<font color="#E5E5E5"> data that</font>

310
00:10:32,580 --> 00:10:35,670
you<font color="#E5E5E5"> need but the important thing is is</font>

311
00:10:34,500 --> 00:10:37,790
<font color="#CCCCCC">that yeah I mentioned that you can do</font>

312
00:10:35,670 --> 00:10:39,839
things like just get a list of hashes

313
00:10:37,790 --> 00:10:41,490
<font color="#CCCCCC">you know just getting</font><font color="#E5E5E5"> a list of hashes</font>

314
00:10:39,840 --> 00:10:43,320
and checking against a known dirty list

315
00:10:41,490 --> 00:10:45,330
or doing a<font color="#CCCCCC"> virustotal</font><font color="#E5E5E5"> check yeah that</font>

316
00:10:43,320 --> 00:10:46,500
might<font color="#E5E5E5"> be helpful to an extent but it</font>

317
00:10:45,330 --> 00:10:48,840
really<font color="#E5E5E5"> is not</font><font color="#CCCCCC"> going to get you where you</font>

318
00:10:46,500 --> 00:10:52,470
need<font color="#CCCCCC"> to be really what you want to do is</font>

319
00:10:48,840 --> 00:10:53,880
pair that ability to carve data out<font color="#CCCCCC"> of</font>

320
00:10:52,470 --> 00:10:55,680
<font color="#CCCCCC">the traffic</font><font color="#E5E5E5"> flow to some sort of</font>

321
00:10:53,880 --> 00:10:57,960
<font color="#E5E5E5">analysis engine to start looking for</font>

322
00:10:55,680 --> 00:10:59,670
<font color="#E5E5E5">things so you</font><font color="#CCCCCC"> know your options would be</font>

323
00:10:57,960 --> 00:11:01,830
<font color="#E5E5E5">like you could sort of do a roll your</font>

324
00:10:59,670 --> 00:11:02,750
<font color="#CCCCCC">own network</font><font color="#E5E5E5"> inline sandbox that's a</font>

325
00:11:01,830 --> 00:11:04,670
little expensive<font color="#E5E5E5"> and</font>

326
00:11:02,750 --> 00:11:06,140
but it's<font color="#E5E5E5"> possible</font><font color="#CCCCCC"> a little more</font>

327
00:11:04,670 --> 00:11:07,849
lightweight<font color="#E5E5E5"> though is that you can start</font>

328
00:11:06,140 --> 00:11:09,920
deploying things like detection scripts

329
00:11:07,850 --> 00:11:11,480
or<font color="#CCCCCC"> yarra</font><font color="#E5E5E5"> to start looking for items of</font>

330
00:11:09,920 --> 00:11:12,770
interest<font color="#CCCCCC"> that happen to be flowing</font>

331
00:11:11,480 --> 00:11:17,210
<font color="#E5E5E5">within the traffic that you're</font>

332
00:11:12,770 --> 00:11:19,520
<font color="#E5E5E5">monitoring so you know to overview the</font>

333
00:11:17,210 --> 00:11:21,740
<font color="#CCCCCC">Philo</font><font color="#E5E5E5"> carvings scope</font><font color="#CCCCCC"> you know look for</font>

334
00:11:19,520 --> 00:11:23,360
and pull anything<font color="#E5E5E5"> that bro has an</font>

335
00:11:21,740 --> 00:11:27,890
analyzer for so your common<font color="#CCCCCC"> printer</font>

336
00:11:23,360 --> 00:11:29,300
<font color="#CCCCCC">calls HTTP</font><font color="#E5E5E5"> FTP SMB etc if bro can see it</font>

337
00:11:27,890 --> 00:11:32,480
you<font color="#E5E5E5"> can grab it</font><font color="#CCCCCC"> now</font><font color="#E5E5E5"> this is not trivial</font>

338
00:11:29,300 --> 00:11:34,040
<font color="#CCCCCC">to say like Oh bro can do everything in</font>

339
00:11:32,480 --> 00:11:36,140
a customer environment we just ran

340
00:11:34,040 --> 00:11:38,839
across the limitation that<font color="#CCCCCC"> Oh</font><font color="#E5E5E5"> bro</font>

341
00:11:36,140 --> 00:11:40,310
doesn't have a<font color="#CCCCCC"> TFTP parser</font><font color="#E5E5E5"> now some</font><font color="#CCCCCC"> of</font>

342
00:11:38,840 --> 00:11:41,750
you<font color="#E5E5E5"> might be wondering is like</font><font color="#CCCCCC"> TFTP who</font>

343
00:11:40,310 --> 00:11:43,670
still uses<font color="#CCCCCC"> that but</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> people</font>

344
00:11:41,750 --> 00:11:44,960
<font color="#CCCCCC">unfortunately</font><font color="#E5E5E5"> especially</font><font color="#CCCCCC"> in a control</font>

345
00:11:43,670 --> 00:11:47,449
system<font color="#CCCCCC"> environments where you</font><font color="#E5E5E5"> talk about</font>

346
00:11:44,960 --> 00:11:50,000
<font color="#E5E5E5">doing</font><font color="#CCCCCC"> things like updating the firmware</font>

347
00:11:47,450 --> 00:11:51,530
image or the operating system on<font color="#E5E5E5"> saying</font>

348
00:11:50,000 --> 00:11:53,090
<font color="#CCCCCC">network appliance so that's something</font>

349
00:11:51,530 --> 00:11:54,860
<font color="#E5E5E5">we're working on</font><font color="#CCCCCC"> right now</font><font color="#E5E5E5"> but at least</font>

350
00:11:53,090 --> 00:11:56,930
you have the flexibility<font color="#CCCCCC"> of writing an</font>

351
00:11:54,860 --> 00:11:58,130
analyzer for<font color="#E5E5E5"> the protocol</font><font color="#CCCCCC"> of interest</font>

352
00:11:56,930 --> 00:12:01,609
and then deploying it to<font color="#E5E5E5"> get this</font>

353
00:11:58,130 --> 00:12:03,710
<font color="#CCCCCC">functionality so to look</font><font color="#E5E5E5"> at this in a</font>

354
00:12:01,610 --> 00:12:05,330
visual<font color="#E5E5E5"> manner so you capture some</font>

355
00:12:03,710 --> 00:12:07,400
traffic<font color="#E5E5E5"> items get carved out</font><font color="#CCCCCC"> of that</font>

356
00:12:05,330 --> 00:12:09,770
<font color="#CCCCCC">traffic stream some initial filter to</font>

357
00:12:07,400 --> 00:12:12,890
whittle down what you are<font color="#E5E5E5"> looking at to</font>

358
00:12:09,770 --> 00:12:15,110
the<font color="#E5E5E5"> items of you know key interest so</font>

359
00:12:12,890 --> 00:12:17,600
maybe I only want PE files maybe<font color="#E5E5E5"> I want</font>

360
00:12:15,110 --> 00:12:18,860
PE files and document files<font color="#CCCCCC"> maybe I want</font>

361
00:12:17,600 --> 00:12:21,470
to see<font color="#E5E5E5"> PowerShell scripts if they're</font>

362
00:12:18,860 --> 00:12:22,820
<font color="#E5E5E5">available etc but something to scope</font>

363
00:12:21,470 --> 00:12:25,339
what you're grabbing<font color="#E5E5E5"> so that you're not</font>

364
00:12:22,820 --> 00:12:29,030
<font color="#CCCCCC">just getting every single HTTP object</font>

365
00:12:25,339 --> 00:12:29,839
<font color="#CCCCCC">and</font><font color="#E5E5E5"> every JPEG and gif or gif</font><font color="#CCCCCC"> anyone</font>

366
00:12:29,030 --> 00:12:33,079
<font color="#CCCCCC">jiff</font>

367
00:12:29,839 --> 00:12:34,730
we can find it out<font color="#E5E5E5"> later anyway</font>

368
00:12:33,080 --> 00:12:35,870
but you know something to limit<font color="#E5E5E5"> the</font>

369
00:12:34,730 --> 00:12:37,760
scope of<font color="#E5E5E5"> what you're looking at so you</font>

370
00:12:35,870 --> 00:12:39,200
<font color="#CCCCCC">don't drown yourself</font><font color="#E5E5E5"> in data but then</font>

371
00:12:37,760 --> 00:12:41,300
once you've subsetted what you're

372
00:12:39,200 --> 00:12:42,710
analyzing<font color="#E5E5E5"> leverage tools in whatever</font>

373
00:12:41,300 --> 00:12:45,109
engine you're using to<font color="#CCCCCC"> analyze to</font>

374
00:12:42,710 --> 00:12:46,820
<font color="#E5E5E5">identify malicious</font><font color="#CCCCCC"> or suspicious</font>

375
00:12:45,110 --> 00:12:48,680
activity and<font color="#E5E5E5"> this is where things get</font>

376
00:12:46,820 --> 00:12:51,170
really<font color="#E5E5E5"> interesting</font><font color="#CCCCCC"> so your detection</font>

377
00:12:48,680 --> 00:12:53,089
possibilities are likely vast<font color="#CCCCCC"> what I'm</font>

378
00:12:51,170 --> 00:12:54,829
going<font color="#E5E5E5"> to focus on today mostly is yaara</font>

379
00:12:53,089 --> 00:12:58,310
<font color="#E5E5E5">but also</font><font color="#CCCCCC"> talk about some</font><font color="#E5E5E5"> detection</font>

380
00:12:54,830 --> 00:13:00,110
scripts so<font color="#CCCCCC"> yara is you know you commonly</font>

381
00:12:58,310 --> 00:13:01,790
looked at as malware<font color="#E5E5E5"> detection</font><font color="#CCCCCC"> I'm</font><font color="#E5E5E5"> going</font>

382
00:13:00,110 --> 00:13:04,670
<font color="#E5E5E5">to try and move away from just looking</font>

383
00:13:01,790 --> 00:13:06,199
<font color="#E5E5E5">at Yara as an any virus replacement</font><font color="#CCCCCC"> but</font>

384
00:13:04,670 --> 00:13:07,969
you can really<font color="#CCCCCC"> extend it to just look</font>

385
00:13:06,200 --> 00:13:09,800
for<font color="#E5E5E5"> strings of interest or patterns of</font>

386
00:13:07,970 --> 00:13:11,360
interest<font color="#E5E5E5"> can even use it</font><font color="#CCCCCC"> as a form</font><font color="#E5E5E5"> of</font>

387
00:13:09,800 --> 00:13:13,339
data loss<font color="#E5E5E5"> prevention by looking at</font>

388
00:13:11,360 --> 00:13:14,250
traffic<font color="#CCCCCC"> leaving the</font><font color="#E5E5E5"> network</font><font color="#CCCCCC"> and hey does</font>

389
00:13:13,339 --> 00:13:16,080
this happen<font color="#E5E5E5"> to have a</font>

390
00:13:14,250 --> 00:13:18,900
text header in it that says<font color="#CCCCCC"> top-secret</font>

391
00:13:16,080 --> 00:13:20,460
<font color="#CCCCCC">slash slash you</font><font color="#E5E5E5"> know s CI code word</font>

392
00:13:18,900 --> 00:13:21,780
whatever goofiness or whatever like<font color="#CCCCCC"> you</font>

393
00:13:20,460 --> 00:13:23,010
might want to see that leaving<font color="#E5E5E5"> you might</font>

394
00:13:21,780 --> 00:13:24,839
want to wonder why that's<font color="#E5E5E5"> on a visible</font>

395
00:13:23,010 --> 00:13:27,720
<font color="#E5E5E5">network in the first place but anyway</font>

396
00:13:24,840 --> 00:13:30,030
those<font color="#E5E5E5"> possibilities exist for doing that</font>

397
00:13:27,720 --> 00:13:31,920
level of<font color="#E5E5E5"> analysis you</font><font color="#CCCCCC"> can pair that then</font>

398
00:13:30,030 --> 00:13:35,430
with some script<font color="#E5E5E5"> you know very simple</font>

399
00:13:31,920 --> 00:13:37,979
scripting to unpack items or to<font color="#CCCCCC"> do</font>

400
00:13:35,430 --> 00:13:39,599
<font color="#E5E5E5">additional layers</font><font color="#CCCCCC"> of analysis</font><font color="#E5E5E5"> or to</font>

401
00:13:37,980 --> 00:13:41,130
unpack something that is a packed

402
00:13:39,600 --> 00:13:44,370
executive<font color="#CCCCCC"> bowl to give you further</font>

403
00:13:41,130 --> 00:13:46,140
visibility so<font color="#CCCCCC"> yarra is something that I</font>

404
00:13:44,370 --> 00:13:47,790
use all the<font color="#CCCCCC"> time so I call myself a</font>

405
00:13:46,140 --> 00:13:49,380
malware analyst in a lot of<font color="#E5E5E5"> respects not</font>

406
00:13:47,790 --> 00:13:52,290
<font color="#E5E5E5">a reverse engineer because I don't spend</font>

407
00:13:49,380 --> 00:13:53,850
all<font color="#E5E5E5"> day every</font><font color="#CCCCCC"> day all those deep</font><font color="#E5E5E5"> in Ida</font>

408
00:13:52,290 --> 00:13:55,589
Pro doing stuff but I like to<font color="#E5E5E5"> think that</font>

409
00:13:53,850 --> 00:13:57,690
<font color="#E5E5E5">I can pull apart</font><font color="#CCCCCC"> apart malware and</font>

410
00:13:55,590 --> 00:13:59,340
identify things<font color="#E5E5E5"> of interest</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> Yara is</font>

411
00:13:57,690 --> 00:14:01,260
really the best way in<font color="#CCCCCC"> my opinion</font><font color="#E5E5E5"> for</font>

412
00:13:59,340 --> 00:14:03,330
codifying<font color="#E5E5E5"> what knowledge</font><font color="#CCCCCC"> I gain by</font>

413
00:14:01,260 --> 00:14:05,250
<font color="#CCCCCC">ripping apart</font><font color="#E5E5E5"> a piece of malware</font>

414
00:14:03,330 --> 00:14:06,270
suspected software however you want to

415
00:14:05,250 --> 00:14:08,280
phrase it

416
00:14:06,270 --> 00:14:10,380
<font color="#E5E5E5">Yara gives me a flexible and</font><font color="#CCCCCC"> powerful</font>

417
00:14:08,280 --> 00:14:12,480
means to look for<font color="#CCCCCC"> items</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> interest and</font>

418
00:14:10,380 --> 00:14:14,730
you<font color="#CCCCCC"> know sort</font><font color="#E5E5E5"> of set them</font><font color="#CCCCCC"> down in a</font>

419
00:14:12,480 --> 00:14:16,110
easily used format that can<font color="#E5E5E5"> then</font><font color="#CCCCCC"> go out</font>

420
00:14:14,730 --> 00:14:18,810
<font color="#CCCCCC">and search for these</font><font color="#E5E5E5"> things in the</font>

421
00:14:16,110 --> 00:14:22,320
<font color="#CCCCCC">feature</font><font color="#E5E5E5"> so as an example like</font><font color="#CCCCCC"> pure you</font>

422
00:14:18,810 --> 00:14:24,089
<font color="#E5E5E5">know this is a couple of rules I wrote</font>

423
00:14:22,320 --> 00:14:27,270
to catch<font color="#CCCCCC"> dot Pecha so it includes</font><font color="#E5E5E5"> both</font>

424
00:14:24,090 --> 00:14:29,190
string and binary form<font color="#E5E5E5"> pattern searching</font>

425
00:14:27,270 --> 00:14:31,800
so there was the embedded PS<font color="#CCCCCC"> exec that</font>

426
00:14:29,190 --> 00:14:33,660
<font color="#CCCCCC">was within</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> Pecha</font><font color="#E5E5E5"> really easy to find</font>

427
00:14:31,800 --> 00:14:36,000
that look<font color="#E5E5E5"> for multiple</font><font color="#CCCCCC"> NZ headers and</font>

428
00:14:33,660 --> 00:14:37,800
<font color="#E5E5E5">then the</font><font color="#CCCCCC"> except EULA string within</font><font color="#E5E5E5"> the</font>

429
00:14:36,000 --> 00:14:39,420
binary itself like<font color="#CCCCCC"> that shouldn't</font><font color="#E5E5E5"> be</font>

430
00:14:37,800 --> 00:14:40,829
<font color="#E5E5E5">there regardless</font><font color="#CCCCCC"> or whatever why do you</font>

431
00:14:39,420 --> 00:14:42,689
have embedded PS exec and something

432
00:14:40,830 --> 00:14:44,760
probably<font color="#CCCCCC"> want to</font><font color="#E5E5E5"> look at that but then</font>

433
00:14:42,690 --> 00:14:46,290
there was also<font color="#CCCCCC"> the shutdown scheduling</font>

434
00:14:44,760 --> 00:14:48,450
routine that<font color="#E5E5E5"> was coded into the file</font>

435
00:14:46,290 --> 00:14:49,589
itself that changed a little<font color="#E5E5E5"> bit you can</font>

436
00:14:48,450 --> 00:14:51,030
<font color="#CCCCCC">see a little wild carding in that</font>

437
00:14:49,590 --> 00:14:53,970
example<font color="#CCCCCC"> so that's an example of</font>

438
00:14:51,030 --> 00:14:55,350
flexibility but the function itself

439
00:14:53,970 --> 00:14:56,880
outside<font color="#E5E5E5"> of you know putting it into</font>

440
00:14:55,350 --> 00:14:59,400
another<font color="#E5E5E5"> compiler and at the end of the</font>

441
00:14:56,880 --> 00:15:01,350
day we're<font color="#CCCCCC"> all sort of lazy really stuck</font>

442
00:14:59,400 --> 00:15:03,360
through all the iterations<font color="#E5E5E5"> of this that</font>

443
00:15:01,350 --> 00:15:05,520
I was able<font color="#CCCCCC"> to</font><font color="#E5E5E5"> spot a little more complex</font>

444
00:15:03,360 --> 00:15:08,550
example so this is<font color="#CCCCCC"> Olympic destroyer and</font>

445
00:15:05,520 --> 00:15:11,160
this<font color="#E5E5E5"> relates to</font><font color="#CCCCCC"> the service</font><font color="#E5E5E5"> stopping or</font>

446
00:15:08,550 --> 00:15:13,380
the service rewrite that was the final

447
00:15:11,160 --> 00:15:15,030
step in causing systems to not be able

448
00:15:13,380 --> 00:15:17,610
<font color="#E5E5E5">to reboot because your services are now</font>

449
00:15:15,030 --> 00:15:19,140
<font color="#CCCCCC">Bourque you know you can go as complex</font>

450
00:15:17,610 --> 00:15:21,120
as you want<font color="#CCCCCC"> in</font><font color="#E5E5E5"> here this is actually</font><font color="#CCCCCC"> a</font>

451
00:15:19,140 --> 00:15:22,290
<font color="#CCCCCC">really tight signature even though it</font>

452
00:15:21,120 --> 00:15:24,240
looks<font color="#E5E5E5"> like there's a lot of wild carding</font>

453
00:15:22,290 --> 00:15:25,040
<font color="#E5E5E5">going on I found a lot more</font><font color="#CCCCCC"> samples than</font>

454
00:15:24,240 --> 00:15:26,780
<font color="#CCCCCC">more</font>

455
00:15:25,040 --> 00:15:28,670
for this that<font color="#E5E5E5"> were also</font><font color="#CCCCCC"> olympic</font>

456
00:15:26,780 --> 00:15:29,870
destroyer as a result but<font color="#E5E5E5"> you're looking</font>

457
00:15:28,670 --> 00:15:31,040
at this and<font color="#E5E5E5"> it's</font><font color="#CCCCCC"> like</font><font color="#E5E5E5"> wait a minute</font><font color="#CCCCCC"> like</font>

458
00:15:29,870 --> 00:15:32,870
you said you're<font color="#E5E5E5"> going to talk about</font><font color="#CCCCCC"> yara</font>

459
00:15:31,040 --> 00:15:34,670
<font color="#E5E5E5">not just as an alternative</font><font color="#CCCCCC"> to a</font><font color="#E5E5E5"> b and</font>

460
00:15:32,870 --> 00:15:36,380
that's<font color="#E5E5E5"> really all</font><font color="#CCCCCC"> that these</font><font color="#E5E5E5"> are so far</font>

461
00:15:34,670 --> 00:15:38,030
well what about something really<font color="#CCCCCC"> simple</font>

462
00:15:36,380 --> 00:15:40,700
<font color="#E5E5E5">what if</font><font color="#CCCCCC"> i just want</font><font color="#E5E5E5"> to look for all</font>

463
00:15:38,030 --> 00:15:43,220
files<font color="#E5E5E5"> that have a compiled time or a</font>

464
00:15:40,700 --> 00:15:44,660
<font color="#CCCCCC">timestamp that is</font><font color="#E5E5E5"> see i'm trying to</font>

465
00:15:43,220 --> 00:15:48,170
remember<font color="#E5E5E5"> what</font><font color="#CCCCCC"> that breaks out to I think</font>

466
00:15:44,660 --> 00:15:50,270
<font color="#E5E5E5">that's like 1990 or 2000</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> timestamp</font>

467
00:15:48,170 --> 00:15:52,099
<font color="#E5E5E5">before the year 2000 or in the future</font>

468
00:15:50,270 --> 00:15:53,930
you should presumably never see this

469
00:15:52,100 --> 00:15:55,970
<font color="#CCCCCC">maybe in your environment</font><font color="#E5E5E5"> you have some</font>

470
00:15:53,930 --> 00:15:57,109
really<font color="#E5E5E5"> old binaries lying around but you</font>

471
00:15:55,970 --> 00:15:59,510
know seeing something<font color="#E5E5E5"> that has a</font>

472
00:15:57,110 --> 00:16:01,430
<font color="#E5E5E5">timestamp of January 1st 1970 or</font>

473
00:15:59,510 --> 00:16:03,260
whatever<font color="#CCCCCC"> LA okay that's a</font><font color="#E5E5E5"> timestamp</font>

474
00:16:01,430 --> 00:16:05,599
<font color="#E5E5E5">that's been wiped out or it says it was</font>

475
00:16:03,260 --> 00:16:07,400
compiled in 2038<font color="#E5E5E5"> probably want to</font>

476
00:16:05,600 --> 00:16:08,930
analyze that so this gives us<font color="#E5E5E5"> an</font><font color="#CCCCCC"> idea to</font>

477
00:16:07,400 --> 00:16:10,400
look<font color="#E5E5E5"> at something</font><font color="#CCCCCC"> that's not</font><font color="#E5E5E5"> known</font>

478
00:16:08,930 --> 00:16:11,599
<font color="#E5E5E5">malicious but gives us an option to</font>

479
00:16:10,400 --> 00:16:14,270
start flagging things that are just

480
00:16:11,600 --> 00:16:16,730
<font color="#E5E5E5">really suspicious so</font><font color="#CCCCCC"> now let's put</font><font color="#E5E5E5"> this</font>

481
00:16:14,270 --> 00:16:19,280
all<font color="#E5E5E5"> together</font><font color="#CCCCCC"> so host-based</font><font color="#E5E5E5"> artifacts</font>

482
00:16:16,730 --> 00:16:21,260
like seeing executables fire and the

483
00:16:19,280 --> 00:16:22,520
details around that<font color="#E5E5E5"> it's really one of</font>

484
00:16:21,260 --> 00:16:23,960
the main things that<font color="#CCCCCC"> we like</font><font color="#E5E5E5"> getting out</font>

485
00:16:22,520 --> 00:16:26,120
of<font color="#CCCCCC"> host-based</font><font color="#E5E5E5"> logs and host-based</font>

486
00:16:23,960 --> 00:16:28,610
forensics access but<font color="#E5E5E5"> we can get that by</font>

487
00:16:26,120 --> 00:16:31,040
capturing them in route<font color="#CCCCCC"> to targets</font><font color="#E5E5E5"> via</font>

488
00:16:28,610 --> 00:16:33,110
<font color="#E5E5E5">network based monitoring so capture the</font>

489
00:16:31,040 --> 00:16:34,490
traffic<font color="#E5E5E5"> leverage something like Yarra in</font>

490
00:16:33,110 --> 00:16:36,590
order to identify<font color="#E5E5E5"> items of interest</font>

491
00:16:34,490 --> 00:16:38,900
<font color="#E5E5E5">within that traffic stream and then</font>

492
00:16:36,590 --> 00:16:41,180
begin<font color="#CCCCCC"> your investigation from there</font><font color="#E5E5E5"> so</font>

493
00:16:38,900 --> 00:16:42,050
let's put this<font color="#CCCCCC"> in practice get sensors</font>

494
00:16:41,180 --> 00:16:45,319
in place<font color="#E5E5E5"> like</font><font color="#CCCCCC"> it</font>

495
00:16:42,050 --> 00:16:47,390
<font color="#CCCCCC">scripts put together etc</font><font color="#E5E5E5"> what can we</font>

496
00:16:45,320 --> 00:16:49,880
actually<font color="#E5E5E5"> look for them well you know the</font>

497
00:16:47,390 --> 00:16:51,260
<font color="#CCCCCC">options are pretty various because you</font>

498
00:16:49,880 --> 00:16:53,750
know it's<font color="#CCCCCC"> really left up to how you</font><font color="#E5E5E5"> want</font>

499
00:16:51,260 --> 00:16:55,100
<font color="#CCCCCC">to put this together so the answer is it</font>

500
00:16:53,750 --> 00:16:57,350
depends<font color="#E5E5E5"> you know what does your</font>

501
00:16:55,100 --> 00:16:59,390
environment require you to<font color="#CCCCCC"> look for what</font>

502
00:16:57,350 --> 00:17:01,310
is it<font color="#CCCCCC"> that you want to see</font><font color="#E5E5E5"> you know if</font>

503
00:16:59,390 --> 00:17:03,170
you're talking<font color="#E5E5E5"> about a fairly you</font><font color="#CCCCCC"> know</font>

504
00:17:01,310 --> 00:17:05,030
stock Windows environment and you're not

505
00:17:03,170 --> 00:17:06,889
worried about<font color="#E5E5E5"> big bad nation-state</font>

506
00:17:05,030 --> 00:17:08,540
advanced persistent threat kicking down

507
00:17:06,890 --> 00:17:10,010
<font color="#E5E5E5">your door you might not even need to go</font>

508
00:17:08,540 --> 00:17:11,959
<font color="#E5E5E5">this complex although you could use this</font>

509
00:17:10,010 --> 00:17:14,150
<font color="#CCCCCC">as a very cheap alternative to</font><font color="#E5E5E5"> so much</font>

510
00:17:11,959 --> 00:17:15,440
<font color="#CCCCCC">more expensive commercial solutions</font><font color="#E5E5E5"> the</font>

511
00:17:14,150 --> 00:17:18,020
example environment I'm<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to talk</font>

512
00:17:15,440 --> 00:17:20,780
<font color="#CCCCCC">about is industrial control systems</font><font color="#E5E5E5"> why</font>

513
00:17:18,020 --> 00:17:22,699
well in addition that that's my job

514
00:17:20,780 --> 00:17:24,589
<font color="#E5E5E5">it's also a really good environment</font><font color="#CCCCCC"> for</font>

515
00:17:22,699 --> 00:17:26,150
<font color="#E5E5E5">this sort of approach because antivirus</font>

516
00:17:24,589 --> 00:17:27,770
coverage is kind of spotty<font color="#E5E5E5"> so you need</font>

517
00:17:26,150 --> 00:17:30,500
to<font color="#E5E5E5"> make up for</font><font color="#CCCCCC"> the lack of</font><font color="#E5E5E5"> traditional</font>

518
00:17:27,770 --> 00:17:33,230
<font color="#E5E5E5">security coverage</font><font color="#CCCCCC"> host coverage is</font>

519
00:17:30,500 --> 00:17:34,179
incredibly rare to non-existent<font color="#CCCCCC"> in this</font>

520
00:17:33,230 --> 00:17:36,850
news environment

521
00:17:34,179 --> 00:17:38,470
but<font color="#E5E5E5"> network capture is quite good so we</font>

522
00:17:36,850 --> 00:17:39,879
<font color="#E5E5E5">have a lot of the</font><font color="#CCCCCC"> ingredients needed</font><font color="#E5E5E5"> as</font>

523
00:17:38,470 --> 00:17:41,710
well<font color="#E5E5E5"> as the reasons to pursue this</font>

524
00:17:39,879 --> 00:17:44,049
approach<font color="#E5E5E5"> that makes that would make it</font>

525
00:17:41,710 --> 00:17:46,659
successful<font color="#CCCCCC"> so first let's talk about</font>

526
00:17:44,049 --> 00:17:47,918
crash override<font color="#CCCCCC"> so those who were in the</font>

527
00:17:46,659 --> 00:17:50,320
<font color="#E5E5E5">discussions yesterday</font><font color="#CCCCCC"> heard that</font>

528
00:17:47,919 --> 00:17:52,840
mentioned<font color="#E5E5E5"> in the attribution talk crash</font>

529
00:17:50,320 --> 00:17:55,299
override<font color="#E5E5E5"> was the malware framework</font>

530
00:17:52,840 --> 00:17:55,959
responsible for the 2016 power outage in

531
00:17:55,299 --> 00:17:58,149
Ukraine

532
00:17:55,960 --> 00:18:00,369
<font color="#CCCCCC">it was a purpose-built industrial</font>

533
00:17:58,149 --> 00:18:03,090
control system attack framework<font color="#E5E5E5"> with</font>

534
00:18:00,369 --> 00:18:04,840
various payloads<font color="#E5E5E5"> targeting different ICS</font>

535
00:18:03,090 --> 00:18:07,059
functionalities well in<font color="#E5E5E5"> that that's</font>

536
00:18:04,840 --> 00:18:09,850
actually speaking<font color="#CCCCCC"> they're different</font>

537
00:18:07,059 --> 00:18:11,980
<font color="#E5E5E5">protocols for different types of ICS</font>

538
00:18:09,850 --> 00:18:13,689
equipment in this case targeting grid

539
00:18:11,980 --> 00:18:16,059
operations for the substation in

540
00:18:13,690 --> 00:18:18,220
question now the attack itself<font color="#CCCCCC"> you know</font>

541
00:18:16,059 --> 00:18:19,418
<font color="#E5E5E5">it was a multi staged event lots of work</font>

542
00:18:18,220 --> 00:18:22,299
went into<font color="#E5E5E5"> this this wasn't something</font>

543
00:18:19,419 --> 00:18:23,950
<font color="#CCCCCC">like a</font><font color="#E5E5E5"> Olympic destroyer wanna cry set</font>

544
00:18:22,299 --> 00:18:26,529
this forth let it do bad things and<font color="#E5E5E5"> walk</font>

545
00:18:23,950 --> 00:18:28,960
away instead the adversary needed to get

546
00:18:26,529 --> 00:18:30,399
into<font color="#CCCCCC"> the ICS network establish some sort</font>

547
00:18:28,960 --> 00:18:32,350
of foothold so that they could survey

548
00:18:30,399 --> 00:18:33,820
the network enumerate systems and

549
00:18:32,350 --> 00:18:35,350
protocols<font color="#CCCCCC"> and then once they knew what</font>

550
00:18:33,820 --> 00:18:37,149
they were dealing<font color="#CCCCCC"> with and had the</font>

551
00:18:35,350 --> 00:18:39,090
<font color="#CCCCCC">accesses</font><font color="#E5E5E5"> required to deliver their</font>

552
00:18:37,149 --> 00:18:41,408
impact<font color="#E5E5E5"> then deliver the attack</font>

553
00:18:39,090 --> 00:18:43,330
<font color="#E5E5E5">everything prior to</font><font color="#CCCCCC"> this takes time</font>

554
00:18:41,409 --> 00:18:45,490
effort<font color="#E5E5E5"> and dedication to make it work</font>

555
00:18:43,330 --> 00:18:47,619
this is not<font color="#E5E5E5"> something</font><font color="#CCCCCC"> that happens in 24</font>

556
00:18:45,490 --> 00:18:49,570
hours<font color="#E5E5E5"> but more likely over the scope of</font>

557
00:18:47,619 --> 00:18:51,580
several<font color="#E5E5E5"> months and what we want to focus</font>

558
00:18:49,570 --> 00:18:53,439
on<font color="#E5E5E5"> for in this approach is not</font>

559
00:18:51,580 --> 00:18:55,029
necessarily blocking any one<font color="#CCCCCC"> of these</font>

560
00:18:53,440 --> 00:18:57,759
items since<font color="#E5E5E5"> that's sort of a host-based</font>

561
00:18:55,029 --> 00:18:59,259
<font color="#CCCCCC">I thing but looking at each of these</font>

562
00:18:57,759 --> 00:19:01,629
connection points between different

563
00:18:59,259 --> 00:19:04,419
stages<font color="#CCCCCC"> of the attack as data moves from</font>

564
00:19:01,629 --> 00:19:06,279
attacker<font color="#CCCCCC"> owned infrastructure to victim</font>

565
00:19:04,419 --> 00:19:09,129
infrastructure or moving back and forth

566
00:19:06,279 --> 00:19:10,659
<font color="#E5E5E5">between the two so how did crash</font>

567
00:19:09,129 --> 00:19:13,418
override function<font color="#E5E5E5"> within the network</font>

568
00:19:10,659 --> 00:19:16,360
well they moved<font color="#E5E5E5"> around through what may</font>

569
00:19:13,419 --> 00:19:18,490
be seen<font color="#E5E5E5"> is you know quite basic methods</font>

570
00:19:16,360 --> 00:19:21,820
<font color="#E5E5E5">living off the land functionality like</font>

571
00:19:18,490 --> 00:19:24,639
<font color="#E5E5E5">using net use so we saw a lot of there</font>

572
00:19:21,820 --> 00:19:27,580
were a I<font color="#E5E5E5"> don't know if this has</font><font color="#CCCCCC"> been too</font>

573
00:19:24,639 --> 00:19:29,110
much emphasized in public but subsequent

574
00:19:27,580 --> 00:19:31,269
data that<font color="#CCCCCC"> dragged us and myself have</font>

575
00:19:29,110 --> 00:19:34,899
recovered on crash<font color="#E5E5E5"> override indicates</font>

576
00:19:31,269 --> 00:19:37,899
that the adversary<font color="#E5E5E5"> compromised</font><font color="#CCCCCC"> a handful</font>

577
00:19:34,899 --> 00:19:40,330
<font color="#E5E5E5">of Windows Server 2003 devices they are</font>

578
00:19:37,899 --> 00:19:42,459
<font color="#CCCCCC">out there running sequel Microsoft</font>

579
00:19:40,330 --> 00:19:45,759
sequel<font color="#E5E5E5"> server and use the XP command</font>

580
00:19:42,460 --> 00:19:46,440
shell<font color="#E5E5E5"> from</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> database</font><font color="#CCCCCC"> compromised to</font>

581
00:19:45,759 --> 00:19:48,659
then

582
00:19:46,440 --> 00:19:50,610
code execution<font color="#E5E5E5"> on subsequent hosts so</font>

583
00:19:48,659 --> 00:19:53,549
you see<font color="#E5E5E5"> lots of XP commands show</font><font color="#CCCCCC"> net use</font>

584
00:19:50,610 --> 00:19:54,600
take a target<font color="#CCCCCC"> conference credentials</font>

585
00:19:53,549 --> 00:19:56,129
there was a version of<font color="#CCCCCC"> meanie cats</font>

586
00:19:54,600 --> 00:19:57,240
deployed for credential harvesting and

587
00:19:56,129 --> 00:19:58,949
then go from<font color="#E5E5E5"> there</font>

588
00:19:57,240 --> 00:20:01,470
there were also scripts that<font color="#E5E5E5"> were used</font>

589
00:19:58,950 --> 00:20:03,090
and<font color="#CCCCCC"> peeking to be put a little bit</font><font color="#E5E5E5"> all</font>

590
00:20:01,470 --> 00:20:05,970
it<font color="#E5E5E5"> is an automation of a lot of these</font>

591
00:20:03,090 --> 00:20:09,509
<font color="#E5E5E5">same commands net used for file movement</font>

592
00:20:05,970 --> 00:20:11,220
file execution<font color="#E5E5E5"> etc</font><font color="#CCCCCC"> so what's going on</font>

593
00:20:09,509 --> 00:20:12,659
here<font color="#E5E5E5"> lots of living off the land</font><font color="#CCCCCC"> I</font>

594
00:20:11,220 --> 00:20:15,090
didn't have a<font color="#E5E5E5"> really good example to</font>

595
00:20:12,659 --> 00:20:18,269
<font color="#E5E5E5">show here but also using PS exec for</font>

596
00:20:15,090 --> 00:20:19,980
process execution<font color="#CCCCCC"> lots of scripting etc</font>

597
00:20:18,269 --> 00:20:22,679
<font color="#CCCCCC">all of this is going to create</font><font color="#E5E5E5"> a lot of</font>

598
00:20:19,980 --> 00:20:24,509
<font color="#E5E5E5">noise</font><font color="#CCCCCC"> and things</font><font color="#E5E5E5"> like SMB so we have a</font>

599
00:20:22,679 --> 00:20:26,340
protocol trail we<font color="#CCCCCC"> have we know how the</font>

600
00:20:24,509 --> 00:20:28,470
adversary is<font color="#CCCCCC"> going to</font><font color="#E5E5E5"> operate</font><font color="#CCCCCC"> we also</font>

601
00:20:26,340 --> 00:20:30,870
have an<font color="#CCCCCC"> idea for a more general sort</font><font color="#E5E5E5"> of</font>

602
00:20:28,470 --> 00:20:32,519
behavior that any adversary may use well

603
00:20:30,870 --> 00:20:34,918
<font color="#E5E5E5">it's zero in on it see what</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> can do</font>

604
00:20:32,519 --> 00:20:36,960
with<font color="#E5E5E5"> it so</font><font color="#CCCCCC"> our detection strategy is</font>

605
00:20:34,919 --> 00:20:39,179
like<font color="#E5E5E5"> let's look for</font><font color="#CCCCCC"> that file transfer</font>

606
00:20:36,960 --> 00:20:40,919
activity as a means of gaining insight

607
00:20:39,179 --> 00:20:42,240
for what's moving<font color="#E5E5E5"> through the network so</font>

608
00:20:40,919 --> 00:20:44,429
something that<font color="#E5E5E5"> we would typically rely</font>

609
00:20:42,240 --> 00:20:46,950
on a<font color="#CCCCCC"> host-based log to find out but this</font>

610
00:20:44,429 --> 00:20:48,899
in this methodology<font color="#CCCCCC"> we will try and</font>

611
00:20:46,950 --> 00:20:51,029
<font color="#CCCCCC">capture that data</font><font color="#E5E5E5"> through midpoint</font>

612
00:20:48,899 --> 00:20:52,830
capture well parse those<font color="#E5E5E5"> files and look</font>

613
00:20:51,029 --> 00:20:55,080
for malicious or suspicious content and

614
00:20:52,830 --> 00:20:56,730
then take advantage<font color="#CCCCCC"> of that adversaries</font>

615
00:20:55,080 --> 00:20:58,649
requirement<font color="#E5E5E5"> that they</font><font color="#CCCCCC"> have to drill down</font>

616
00:20:56,730 --> 00:21:00,720
<font color="#CCCCCC">through multiple layers</font><font color="#E5E5E5"> of the network</font>

617
00:20:58,649 --> 00:21:03,268
to<font color="#E5E5E5"> get from adversary initial</font>

618
00:21:00,720 --> 00:21:06,090
infrastructure through the victim IT

619
00:21:03,269 --> 00:21:07,110
network all<font color="#E5E5E5"> the way into the ICS network</font>

620
00:21:06,090 --> 00:21:10,559
where they want to deliver their

621
00:21:07,110 --> 00:21:12,779
malicious impact so<font color="#CCCCCC"> bro as it so happens</font>

622
00:21:10,559 --> 00:21:14,789
has<font color="#CCCCCC"> a native SMB module</font><font color="#E5E5E5"> that's out there</font>

623
00:21:12,779 --> 00:21:16,440
<font color="#E5E5E5">that</font><font color="#CCCCCC"> you can just enable to have good</font>

624
00:21:14,789 --> 00:21:18,179
<font color="#E5E5E5">things happen this has a few alterations</font>

625
00:21:16,440 --> 00:21:19,590
in it I<font color="#CCCCCC"> just</font><font color="#E5E5E5"> snip some of this out but</font>

626
00:21:18,179 --> 00:21:20,909
<font color="#E5E5E5">this</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> something that you don't</font>

627
00:21:19,590 --> 00:21:22,470
<font color="#E5E5E5">necessarily have</font><font color="#CCCCCC"> to put in place</font>

628
00:21:20,909 --> 00:21:24,600
yourself you can modify it<font color="#E5E5E5"> certainly</font>

629
00:21:22,470 --> 00:21:26,759
depending<font color="#E5E5E5"> on what you</font><font color="#CCCCCC"> need to do with it</font>

630
00:21:24,600 --> 00:21:28,408
but right<font color="#E5E5E5"> now</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can grab it out of</font>

631
00:21:26,759 --> 00:21:30,389
either<font color="#E5E5E5"> a github repository or use the</font>

632
00:21:28,409 --> 00:21:32,789
one<font color="#E5E5E5"> that's in</font><font color="#CCCCCC"> the default</font><font color="#E5E5E5"> bro config and</font>

633
00:21:30,389 --> 00:21:33,418
you're capturing<font color="#E5E5E5"> traffic on SMB</font><font color="#CCCCCC"> alright</font>

634
00:21:32,789 --> 00:21:36,120
we're good

635
00:21:33,419 --> 00:21:39,570
so next let's look at<font color="#E5E5E5"> the malware in</font>

636
00:21:36,120 --> 00:21:41,639
question<font color="#E5E5E5"> or in this case the software</font>

637
00:21:39,570 --> 00:21:43,379
that is ICS oriented<font color="#E5E5E5"> that just so</font>

638
00:21:41,639 --> 00:21:45,449
happens to<font color="#E5E5E5"> do malicious things because</font>

639
00:21:43,379 --> 00:21:47,039
when you look at it it<font color="#CCCCCC"> doesn't</font><font color="#E5E5E5"> really</font>

640
00:21:45,450 --> 00:21:49,500
fit<font color="#CCCCCC"> the mold of malware in the sense</font>

641
00:21:47,039 --> 00:21:50,850
that<font color="#E5E5E5"> ad would pick this off</font><font color="#CCCCCC"> so we've got</font>

642
00:21:49,500 --> 00:21:52,259
the destructive module to impede

643
00:21:50,850 --> 00:21:54,029
restoration as well plus some

644
00:21:52,259 --> 00:21:56,549
<font color="#E5E5E5">off-the-shelf items like PS exec and</font>

645
00:21:54,029 --> 00:21:57,250
<font color="#E5E5E5">they used a upx</font><font color="#CCCCCC"> wrapped</font><font color="#E5E5E5"> variant to me me</font>

646
00:21:56,549 --> 00:22:00,160
cats

647
00:21:57,250 --> 00:22:02,050
nothing too<font color="#E5E5E5"> fancy there but I say not</font>

648
00:22:00,160 --> 00:22:06,880
really malware because around<font color="#E5E5E5"> the time</font>

649
00:22:02,050 --> 00:22:07,300
<font color="#CCCCCC">that this</font><font color="#E5E5E5"> first hit and yeah 12:19 went</font>

650
00:22:06,880 --> 00:22:09,700
<font color="#E5E5E5">red</font>

651
00:22:07,300 --> 00:22:11,350
so someone thankfully for<font color="#E5E5E5"> us researchers</font>

652
00:22:09,700 --> 00:22:11,800
uploaded this to virustotal the day it

653
00:22:11,350 --> 00:22:14,379
happened

654
00:22:11,800 --> 00:22:15,730
<font color="#E5E5E5">yay um but you can see that other than</font>

655
00:22:14,380 --> 00:22:17,440
<font color="#E5E5E5">getting things like wisdom eyes which</font>

656
00:22:15,730 --> 00:22:17,920
what does that<font color="#E5E5E5"> tell anyone</font><font color="#CCCCCC"> tells me</font>

657
00:22:17,440 --> 00:22:19,660
nothing

658
00:22:17,920 --> 00:22:20,830
wisdom eyes is a junk signature and

659
00:22:19,660 --> 00:22:23,200
seeing a few other<font color="#CCCCCC"> examples like that</font>

660
00:22:20,830 --> 00:22:24,790
<font color="#E5E5E5">but otherwise your AV engines weren't</font>

661
00:22:23,200 --> 00:22:27,310
<font color="#E5E5E5">really meaningfully picking this up at</font>

662
00:22:24,790 --> 00:22:29,020
all so<font color="#E5E5E5"> AV is not helping you much here</font>

663
00:22:27,310 --> 00:22:30,940
<font color="#E5E5E5">not surprising it wasn't designed for</font>

664
00:22:29,020 --> 00:22:32,379
<font color="#E5E5E5">these sorts of threats and looking at</font>

665
00:22:30,940 --> 00:22:35,380
the software<font color="#CCCCCC"> in question that</font><font color="#E5E5E5"> was one of</font>

666
00:22:32,380 --> 00:22:37,000
<font color="#CCCCCC">the ICS specific effects modules</font><font color="#E5E5E5"> it's</font>

667
00:22:35,380 --> 00:22:40,300
outside the scope<font color="#CCCCCC"> of standard commercial</font>

668
00:22:37,000 --> 00:22:41,830
antivirus so there's not<font color="#E5E5E5"> so</font><font color="#CCCCCC"> much much to</font>

669
00:22:40,300 --> 00:22:43,450
look for there but there's an awful<font color="#CCCCCC"> lot</font>

670
00:22:41,830 --> 00:22:45,850
<font color="#CCCCCC">of interest</font><font color="#E5E5E5"> if you dig</font><font color="#CCCCCC"> into</font><font color="#E5E5E5"> the file</font>

671
00:22:43,450 --> 00:22:48,070
<font color="#E5E5E5">that is of</font><font color="#CCCCCC"> interest from</font><font color="#E5E5E5"> a purely ICS</font>

672
00:22:45,850 --> 00:22:49,810
perspective and it's that contextual<font color="#E5E5E5"> 'ti</font>

673
00:22:48,070 --> 00:22:51,909
that this flexible approach towards

674
00:22:49,810 --> 00:22:54,460
monitoring<font color="#E5E5E5"> lets you embrace because you</font>

675
00:22:51,910 --> 00:22:56,950
can design<font color="#E5E5E5"> your</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> so adding some</font>

676
00:22:54,460 --> 00:22:59,410
custom or<font color="#E5E5E5"> tailored to your environment</font>

677
00:22:56,950 --> 00:23:01,300
detection at<font color="#CCCCCC"> midpoint</font><font color="#E5E5E5"> would identify the</font>

678
00:22:59,410 --> 00:23:03,520
payload pre positioning<font color="#E5E5E5"> before the</font>

679
00:23:01,300 --> 00:23:04,930
attack is delivered so from a<font color="#CCCCCC"> very</font>

680
00:23:03,520 --> 00:23:07,780
specific<font color="#CCCCCC"> standpoint this</font><font color="#E5E5E5"> is on the</font>

681
00:23:04,930 --> 00:23:11,950
<font color="#E5E5E5">Drago's</font><font color="#CCCCCC"> github repository</font><font color="#E5E5E5"> was included</font>

682
00:23:07,780 --> 00:23:14,560
in<font color="#E5E5E5"> our report from</font><font color="#CCCCCC"> Wow</font><font color="#E5E5E5"> time flies July</font>

683
00:23:11,950 --> 00:23:15,850
<font color="#E5E5E5">of 2017 but anyway there are two</font>

684
00:23:14,560 --> 00:23:18,580
different<font color="#CCCCCC"> variances so on the one</font><font color="#E5E5E5"> hand</font>

685
00:23:15,850 --> 00:23:21,159
<font color="#E5E5E5">you have</font><font color="#CCCCCC"> some</font><font color="#E5E5E5"> bite pattern activity for</font>

686
00:23:18,580 --> 00:23:24,040
the configuration<font color="#CCCCCC"> reader that</font><font color="#E5E5E5"> was built</font>

687
00:23:21,160 --> 00:23:25,900
into<font color="#E5E5E5"> the main crash override module that</font>

688
00:23:24,040 --> 00:23:27,909
would read the config file that would

689
00:23:25,900 --> 00:23:31,180
tell the malware<font color="#E5E5E5"> how to execute</font><font color="#CCCCCC"> the</font>

690
00:23:27,910 --> 00:23:33,220
<font color="#E5E5E5">specific ICS attack pack payload okay</font>

691
00:23:31,180 --> 00:23:34,870
<font color="#E5E5E5">that didn't change</font><font color="#CCCCCC"> very much</font><font color="#E5E5E5"> and so that</font>

692
00:23:33,220 --> 00:23:36,760
was a pretty good<font color="#E5E5E5"> bytecode signature to</font>

693
00:23:34,870 --> 00:23:38,770
use but<font color="#E5E5E5"> also you know there's just</font>

694
00:23:36,760 --> 00:23:41,379
<font color="#E5E5E5">interesting language in these meant to</font>

695
00:23:38,770 --> 00:23:42,760
both provide output to the user<font color="#CCCCCC"> that</font>

696
00:23:41,380 --> 00:23:44,680
<font color="#CCCCCC">they're but that their payload is</font>

697
00:23:42,760 --> 00:23:46,060
working and debug strings<font color="#E5E5E5"> that could be</font>

698
00:23:44,680 --> 00:23:48,850
tailored off of that are unique to the

699
00:23:46,060 --> 00:23:51,070
ICS environment<font color="#E5E5E5"> so seeing the IEC 104</font>

700
00:23:48,850 --> 00:23:52,810
protocol called out<font color="#CCCCCC"> master/slave</font>

701
00:23:51,070 --> 00:23:54,580
relationships<font color="#E5E5E5"> for communications as well</font>

702
00:23:52,810 --> 00:23:57,889
as referencing a log file like<font color="#E5E5E5"> okay</font>

703
00:23:54,580 --> 00:24:00,210
those<font color="#E5E5E5"> are also items and by</font>

704
00:23:57,890 --> 00:24:03,030
abstracting from<font color="#E5E5E5"> that a bit</font><font color="#CCCCCC"> you can</font>

705
00:24:00,210 --> 00:24:04,470
identify more general terms to start

706
00:24:03,030 --> 00:24:05,730
<font color="#CCCCCC">identifying in traffic and</font><font color="#E5E5E5"> we'll see</font>

707
00:24:04,470 --> 00:24:07,800
some<font color="#CCCCCC"> examples when we start getting into</font>

708
00:24:05,730 --> 00:24:10,800
<font color="#E5E5E5">traces in a little bit</font><font color="#CCCCCC"> on a few slides</font>

709
00:24:07,800 --> 00:24:12,360
<font color="#CCCCCC">but to close out crash override we</font>

710
00:24:10,800 --> 00:24:14,250
really want<font color="#E5E5E5"> to build out environment</font>

711
00:24:12,360 --> 00:24:16,590
specific defense<font color="#E5E5E5"> that's suitable to what</font>

712
00:24:14,250 --> 00:24:18,600
visibility we have and suitable<font color="#E5E5E5"> to what</font>

713
00:24:16,590 --> 00:24:19,980
we're trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> defend so implement</font>

714
00:24:18,600 --> 00:24:21,780
these<font color="#E5E5E5"> that those</font><font color="#CCCCCC"> network choke points</font>

715
00:24:19,980 --> 00:24:24,510
because<font color="#E5E5E5"> we know that the adversary must</font>

716
00:24:21,780 --> 00:24:26,730
navigate through these in order<font color="#E5E5E5"> to reach</font>

717
00:24:24,510 --> 00:24:28,590
their objective<font color="#E5E5E5"> and detect</font><font color="#CCCCCC"> suspicious</font>

718
00:24:26,730 --> 00:24:30,330
items as they traverse those in advance

719
00:24:28,590 --> 00:24:31,949
<font color="#E5E5E5">of the attack so you've gotten a breach</font>

720
00:24:30,330 --> 00:24:33,600
you have<font color="#CCCCCC"> prevented a breach</font><font color="#E5E5E5"> but you may</font>

721
00:24:31,950 --> 00:24:35,190
<font color="#E5E5E5">have prevented the lights from going out</font>

722
00:24:33,600 --> 00:24:36,959
for<font color="#E5E5E5"> a couple</font><font color="#CCCCCC"> of hours but I'm sure the</font>

723
00:24:35,190 --> 00:24:38,640
<font color="#CCCCCC">people</font><font color="#E5E5E5"> in Kiev and December didn't</font>

724
00:24:36,960 --> 00:24:40,440
<font color="#CCCCCC">appreciate that very</font><font color="#E5E5E5"> much</font><font color="#CCCCCC"> at the</font><font color="#E5E5E5"> time</font>

725
00:24:38,640 --> 00:24:42,420
so really it's knowing your<font color="#CCCCCC"> environment</font>

726
00:24:40,440 --> 00:24:44,280
<font color="#E5E5E5">and what's going on there and targeting</font>

727
00:24:42,420 --> 00:24:45,660
those attacker dependencies<font color="#CCCCCC"> to get a</font>

728
00:24:44,280 --> 00:24:47,129
better visualization or<font color="#E5E5E5"> a better</font>

729
00:24:45,660 --> 00:24:49,710
understanding<font color="#E5E5E5"> of what's going</font><font color="#CCCCCC"> on in the</font>

730
00:24:47,130 --> 00:24:51,540
<font color="#CCCCCC">network so next we'll move</font><font color="#E5E5E5"> on</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> trisys</font>

731
00:24:49,710 --> 00:24:53,370
this is a more recent event<font color="#E5E5E5"> without more</font>

732
00:24:51,540 --> 00:24:57,330
recent<font color="#E5E5E5"> from in terms of discovery for</font>

733
00:24:53,370 --> 00:25:00,000
<font color="#E5E5E5">most of us happen in August</font><font color="#CCCCCC"> of 2017</font><font color="#E5E5E5"> was</font>

734
00:24:57,330 --> 00:25:02,850
the<font color="#E5E5E5"> third ICS impacting malware Stuxnet</font>

735
00:25:00,000 --> 00:25:04,470
crash override<font color="#E5E5E5"> and then</font><font color="#CCCCCC"> trisys what's</font>

736
00:25:02,850 --> 00:25:06,120
unique about trisys it was the first to

737
00:25:04,470 --> 00:25:08,400
target safety systems which to

738
00:25:06,120 --> 00:25:10,469
paraphrase<font color="#E5E5E5"> birdperson for the</font><font color="#CCCCCC"> rick and</font>

739
00:25:08,400 --> 00:25:12,510
<font color="#CCCCCC">morty</font><font color="#E5E5E5"> fans out there is very much a dick</font>

740
00:25:10,470 --> 00:25:13,800
move<font color="#CCCCCC"> these are the sorts of things that</font>

741
00:25:12,510 --> 00:25:16,650
<font color="#E5E5E5">you target if you want to hurt someone</font>

742
00:25:13,800 --> 00:25:18,270
<font color="#CCCCCC">or destroy some equipment not cool so</font>

743
00:25:16,650 --> 00:25:20,700
just people shouldn't<font color="#E5E5E5"> be playing around</font>

744
00:25:18,270 --> 00:25:22,620
<font color="#E5E5E5">with these the functionality</font><font color="#CCCCCC"> of what</font><font color="#E5E5E5"> was</font>

745
00:25:20,700 --> 00:25:24,330
recovered and this is<font color="#E5E5E5"> something in</font>

746
00:25:22,620 --> 00:25:26,489
<font color="#E5E5E5">talking</font><font color="#CCCCCC"> with the folks at fireEye who</font>

747
00:25:24,330 --> 00:25:27,689
have done the<font color="#CCCCCC"> hands-on incident response</font>

748
00:25:26,490 --> 00:25:31,260
as well<font color="#E5E5E5"> as from the things that we were</font>

749
00:25:27,690 --> 00:25:33,090
<font color="#E5E5E5">able to recover is the malware that's</font>

750
00:25:31,260 --> 00:25:35,640
<font color="#E5E5E5">available and all the components</font><font color="#CCCCCC"> that</font>

751
00:25:33,090 --> 00:25:37,919
<font color="#E5E5E5">have been recovered thus far are enough</font>

752
00:25:35,640 --> 00:25:40,230
to<font color="#CCCCCC"> set up a basically a rootkit an</font>

753
00:25:37,920 --> 00:25:42,000
in-memory backdoor on the targeted

754
00:25:40,230 --> 00:25:43,440
safety system and<font color="#E5E5E5"> that could allow for</font>

755
00:25:42,000 --> 00:25:45,150
<font color="#E5E5E5">lots of options but we didn't see</font>

756
00:25:43,440 --> 00:25:47,760
something<font color="#CCCCCC"> like crash override where we</font>

757
00:25:45,150 --> 00:25:49,710
had a automated framework for deploying

758
00:25:47,760 --> 00:25:51,420
some sort of destructive effect<font color="#E5E5E5"> so it's</font>

759
00:25:49,710 --> 00:25:52,920
more<font color="#E5E5E5"> getting up to the point where you</font>

760
00:25:51,420 --> 00:25:53,600
could do such a thing<font color="#CCCCCC"> but</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> they're</font>

761
00:25:52,920 --> 00:25:56,090
quite

762
00:25:53,600 --> 00:25:58,010
yet<font color="#E5E5E5"> now the attack framework you had to</font>

763
00:25:56,090 --> 00:25:59,000
penetrate the ICS<font color="#CCCCCC"> network establish a</font>

764
00:25:58,010 --> 00:26:00,830
foot wait a minute

765
00:25:59,000 --> 00:26:03,230
that looks<font color="#E5E5E5"> just like crash override</font>

766
00:26:00,830 --> 00:26:04,730
doesn't it<font color="#CCCCCC"> in fact it is the same sort</font>

767
00:26:03,230 --> 00:26:07,340
<font color="#E5E5E5">of a tech pathway that</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> have to go</font>

768
00:26:04,730 --> 00:26:09,530
from your initial<font color="#E5E5E5"> wherever your</font>

769
00:26:07,340 --> 00:26:12,230
<font color="#E5E5E5">adversaries coming from all the way down</font>

770
00:26:09,530 --> 00:26:14,360
to that<font color="#E5E5E5"> point in the network</font><font color="#CCCCCC"> fairly deep</font>

771
00:26:12,230 --> 00:26:15,920
<font color="#E5E5E5">where you can deliver</font><font color="#CCCCCC"> your payload</font><font color="#E5E5E5"> what</font>

772
00:26:14,360 --> 00:26:17,780
this means is<font color="#CCCCCC"> that you get the same sort</font>

773
00:26:15,920 --> 00:26:19,550
<font color="#E5E5E5">of dependencies</font><font color="#CCCCCC"> of multiple choke points</font>

774
00:26:17,780 --> 00:26:21,379
that the adversary must navigate<font color="#E5E5E5"> where</font>

775
00:26:19,550 --> 00:26:23,870
you have the opportunity<font color="#CCCCCC"> of setting up</font>

776
00:26:21,380 --> 00:26:25,580
traffic capture and monitoring so the

777
00:26:23,870 --> 00:26:27,949
same<font color="#E5E5E5"> similar challenges apply for the</font>

778
00:26:25,580 --> 00:26:29,270
adversary in<font color="#E5E5E5"> establishing</font><font color="#CCCCCC"> c2 they've got</font>

779
00:26:27,950 --> 00:26:30,530
to make<font color="#E5E5E5"> sure they dig into the network</font>

780
00:26:29,270 --> 00:26:33,410
quite far<font color="#CCCCCC"> and then maintain</font>

781
00:26:30,530 --> 00:26:35,510
communications and then what's all<font color="#E5E5E5"> of</font>

782
00:26:33,410 --> 00:26:37,430
<font color="#E5E5E5">that happens that ultimate payload isn't</font>

783
00:26:35,510 --> 00:26:39,770
developed and deployed on<font color="#CCCCCC"> the</font>

784
00:26:37,430 --> 00:26:42,470
compromised<font color="#E5E5E5"> host in the ICS</font><font color="#CCCCCC"> network no</font>

785
00:26:39,770 --> 00:26:44,690
<font color="#CCCCCC">it's move migrated from</font><font color="#E5E5E5"> that initial</font>

786
00:26:42,470 --> 00:26:46,670
attacker infrastructure to the<font color="#E5E5E5"> ICS</font>

787
00:26:44,690 --> 00:26:48,980
<font color="#E5E5E5">network to the subsequent victim machine</font>

788
00:26:46,670 --> 00:26:51,050
<font color="#CCCCCC">lots of places where you can pick this</font>

789
00:26:48,980 --> 00:26:54,470
off<font color="#E5E5E5"> as it moves its way down this path</font>

790
00:26:51,050 --> 00:26:57,860
<font color="#E5E5E5">so the malicious pet payload in question</font>

791
00:26:54,470 --> 00:26:59,360
was downloaded this<font color="#E5E5E5"> is a so if you talk</font>

792
00:26:57,860 --> 00:27:01,429
<font color="#E5E5E5">to the ICS guys like I would say</font>

793
00:26:59,360 --> 00:27:03,469
<font color="#E5E5E5">uploaded they say downloaded it moved</font>

794
00:27:01,430 --> 00:27:06,050
<font color="#E5E5E5">from the engineering</font><font color="#CCCCCC"> workstation that</font>

795
00:27:03,470 --> 00:27:11,000
<font color="#CCCCCC">was one hop away from the safety system</font>

796
00:27:06,050 --> 00:27:13,280
<font color="#E5E5E5">and it was facilitated by a compiled</font>

797
00:27:11,000 --> 00:27:15,440
Python executive<font color="#CCCCCC"> bowl that</font><font color="#E5E5E5"> knew</font><font color="#CCCCCC"> what</font>

798
00:27:13,280 --> 00:27:18,020
precise points in memory on the targeted

799
00:27:15,440 --> 00:27:19,940
safety controller<font color="#CCCCCC"> Schneider tri connects</font>

800
00:27:18,020 --> 00:27:21,020
device in order to upload its payload

801
00:27:19,940 --> 00:27:23,690
and insert the rootkit

802
00:27:21,020 --> 00:27:26,270
so the uploads included the initial

803
00:27:23,690 --> 00:27:28,370
rootkit and the subsequent backdoor

804
00:27:26,270 --> 00:27:30,200
module etcetera<font color="#E5E5E5"> that</font><font color="#CCCCCC"> were removed</font><font color="#E5E5E5"> from</font>

805
00:27:28,370 --> 00:27:32,929
the engineering<font color="#E5E5E5"> workstation then on to</font>

806
00:27:30,200 --> 00:27:34,850
<font color="#E5E5E5">the</font><font color="#CCCCCC"> Syst device so</font><font color="#E5E5E5"> you know we got an</font>

807
00:27:32,930 --> 00:27:36,530
idea<font color="#CCCCCC"> for</font><font color="#E5E5E5"> how this attack works in theory</font>

808
00:27:34,850 --> 00:27:37,820
<font color="#E5E5E5">how do you defend against it or how do</font>

809
00:27:36,530 --> 00:27:39,680
you detect<font color="#E5E5E5"> it well the same sort of</font>

810
00:27:37,820 --> 00:27:41,360
principles<font color="#CCCCCC"> we've talked about at nauseam</font>

811
00:27:39,680 --> 00:27:43,370
already<font color="#CCCCCC"> add detection at those choke</font>

812
00:27:41,360 --> 00:27:45,080
points<font color="#E5E5E5"> and look for</font><font color="#CCCCCC"> items of interest</font>

813
00:27:43,370 --> 00:27:47,719
that are traversing<font color="#CCCCCC"> through them</font><font color="#E5E5E5"> so</font>

814
00:27:45,080 --> 00:27:50,750
safety<font color="#E5E5E5"> system controllers don't get</font>

815
00:27:47,720 --> 00:27:53,120
updated hardly ever<font color="#E5E5E5"> it's something</font>

816
00:27:50,750 --> 00:27:56,180
that's<font color="#E5E5E5"> designed and deployed at</font><font color="#CCCCCC"> the time</font>

817
00:27:53,120 --> 00:27:57,860
that<font color="#E5E5E5"> the plant is put</font><font color="#CCCCCC"> into operation</font><font color="#E5E5E5"> and</font>

818
00:27:56,180 --> 00:27:59,570
you know extensive testing is involved

819
00:27:57,860 --> 00:28:00,860
<font color="#E5E5E5">you're not going to change the</font><font color="#CCCCCC"> logic and</font>

820
00:27:59,570 --> 00:28:02,629
<font color="#E5E5E5">the firmware on these things</font>

821
00:28:00,860 --> 00:28:04,399
hardly ever if at all so when you<font color="#E5E5E5"> see</font>

822
00:28:02,630 --> 00:28:06,110
<font color="#E5E5E5">something</font><font color="#CCCCCC"> that looks</font><font color="#E5E5E5"> like a new firmware</font>

823
00:28:04,400 --> 00:28:08,180
image or<font color="#E5E5E5"> something that's migrating its</font>

824
00:28:06,110 --> 00:28:10,310
way to the workstation responsible for

825
00:28:08,180 --> 00:28:11,840
<font color="#E5E5E5">interacting with it that alone should be</font>

826
00:28:10,310 --> 00:28:13,669
a signal<font color="#E5E5E5"> that</font><font color="#CCCCCC"> something might be up and</font>

827
00:28:11,840 --> 00:28:15,530
<font color="#E5E5E5">then adding further refinements to that</font>

828
00:28:13,670 --> 00:28:19,610
data can identify that something truly

829
00:28:15,530 --> 00:28:21,050
<font color="#CCCCCC">is malicious</font><font color="#E5E5E5"> or potentially malicious so</font>

830
00:28:19,610 --> 00:28:22,939
again I'm<font color="#CCCCCC"> not</font><font color="#E5E5E5"> trying to make this into</font>

831
00:28:21,050 --> 00:28:24,560
<font color="#CCCCCC">like you know AV sucks because a lot of</font>

832
00:28:22,940 --> 00:28:26,510
<font color="#E5E5E5">people like doing</font><font color="#CCCCCC"> that a V is really</font>

833
00:28:24,560 --> 00:28:29,889
good at<font color="#E5E5E5"> what antivirus is designed to do</font>

834
00:28:26,510 --> 00:28:32,960
antivirus was not designed to identify

835
00:28:29,890 --> 00:28:35,270
bespoke narrowly tailored industrial

836
00:28:32,960 --> 00:28:37,400
control system targeting software<font color="#CCCCCC"> so in</font>

837
00:28:35,270 --> 00:28:39,139
the case of<font color="#CCCCCC"> trisys and a couple guys</font>

838
00:28:37,400 --> 00:28:41,270
<font color="#E5E5E5">from Kaspersky jump all over me</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> this</font>

839
00:28:39,140 --> 00:28:42,560
one for implying that<font color="#CCCCCC"> AV was not up to</font>

840
00:28:41,270 --> 00:28:44,120
<font color="#E5E5E5">the task</font><font color="#CCCCCC"> it's like I'm</font><font color="#E5E5E5"> sorry</font><font color="#CCCCCC"> it just</font>

841
00:28:42,560 --> 00:28:46,550
<font color="#E5E5E5">wasn't designed for this it's not the</font>

842
00:28:44,120 --> 00:28:48,409
<font color="#E5E5E5">the right product and trisys was</font>

843
00:28:46,550 --> 00:28:49,940
originally<font color="#CCCCCC"> uploaded to virustotal</font>

844
00:28:48,410 --> 00:28:52,940
way back when the attack took<font color="#CCCCCC"> place in</font>

845
00:28:49,940 --> 00:28:55,610
<font color="#CCCCCC">august</font><font color="#E5E5E5"> and nothing for detections for</font>

846
00:28:52,940 --> 00:28:57,080
months and up until<font color="#E5E5E5"> the reports came out</font>

847
00:28:55,610 --> 00:28:59,959
there was nothing<font color="#CCCCCC"> for detection Zout</font>

848
00:28:57,080 --> 00:29:03,110
side of a few sporadic<font color="#E5E5E5"> crappy signatures</font>

849
00:28:59,960 --> 00:29:04,310
like wisdom<font color="#E5E5E5"> eyes</font><font color="#CCCCCC"> etc again</font><font color="#E5E5E5"> antivirus</font>

850
00:29:03,110 --> 00:29:05,840
isn't going to<font color="#E5E5E5"> help you here</font><font color="#CCCCCC"> because</font>

851
00:29:04,310 --> 00:29:08,300
<font color="#E5E5E5">it's not trained or designed to detect</font>

852
00:29:05,840 --> 00:29:11,830
<font color="#E5E5E5">these sorts of threats so absent relying</font>

853
00:29:08,300 --> 00:29:14,600
on<font color="#CCCCCC"> solutions that are designed for</font><font color="#E5E5E5"> your</font>

854
00:29:11,830 --> 00:29:16,790
<font color="#CCCCCC">standard Windows desktop what do you do</font>

855
00:29:14,600 --> 00:29:18,889
<font color="#E5E5E5">well just like with crash override there</font>

856
00:29:16,790 --> 00:29:20,780
are numerous aspects to<font color="#E5E5E5"> this infection</font>

857
00:29:18,890 --> 00:29:22,880
event<font color="#CCCCCC"> that should stand</font><font color="#E5E5E5"> out</font><font color="#CCCCCC"> that do</font>

858
00:29:20,780 --> 00:29:24,680
stand out<font color="#E5E5E5"> from an ICS specific</font>

859
00:29:22,880 --> 00:29:26,870
<font color="#CCCCCC">perspective</font><font color="#E5E5E5"> so there was a compiled</font>

860
00:29:24,680 --> 00:29:28,610
Python executive<font color="#CCCCCC"> well used you don't see</font>

861
00:29:26,870 --> 00:29:30,409
Python in industrial control

862
00:29:28,610 --> 00:29:32,090
environments might sound amazing<font color="#E5E5E5"> for</font><font color="#CCCCCC"> all</font>

863
00:29:30,410 --> 00:29:33,860
of us that live and<font color="#E5E5E5"> die by Python these</font>

864
00:29:32,090 --> 00:29:35,389
days but it's<font color="#CCCCCC"> just</font><font color="#E5E5E5"> not a</font><font color="#CCCCCC"> language that's</font>

865
00:29:33,860 --> 00:29:38,060
represented especially in a compiled

866
00:29:35,390 --> 00:29:39,830
form furthermore the file headers and

867
00:29:38,060 --> 00:29:41,750
content for<font color="#E5E5E5"> the malicious modules that</font>

868
00:29:39,830 --> 00:29:43,340
get<font color="#E5E5E5"> moved to the safety controller are</font>

869
00:29:41,750 --> 00:29:45,410
very unique<font color="#E5E5E5"> to</font><font color="#CCCCCC"> that sort</font><font color="#E5E5E5"> of software</font>

870
00:29:43,340 --> 00:29:47,240
<font color="#E5E5E5">there is some overlap</font><font color="#CCCCCC"> if you start</font>

871
00:29:45,410 --> 00:29:48,860
piecing them together with lots of other

872
00:29:47,240 --> 00:29:51,140
embedded<font color="#E5E5E5"> devices like printer drivers</font>

873
00:29:48,860 --> 00:29:52,610
for example<font color="#E5E5E5"> but even</font><font color="#CCCCCC"> still you shouldn't</font>

874
00:29:51,140 --> 00:29:54,170
see these sorts of things zipping<font color="#CCCCCC"> around</font>

875
00:29:52,610 --> 00:29:56,149
your industrial control network so

876
00:29:54,170 --> 00:29:58,070
<font color="#E5E5E5">tailoring off of the file headers and</font>

877
00:29:56,150 --> 00:29:59,930
some other patterns on those can at

878
00:29:58,070 --> 00:30:01,879
least trace potential firmware

879
00:29:59,930 --> 00:30:02,990
introduction into the<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> and if</font>

880
00:30:01,880 --> 00:30:05,390
that<font color="#E5E5E5"> doesn't relate to</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> known</font>

881
00:30:02,990 --> 00:30:06,980
maintenance period or update period<font color="#E5E5E5"> you</font>

882
00:30:05,390 --> 00:30:09,230
have a security<font color="#E5E5E5"> incident to investigate</font>

883
00:30:06,980 --> 00:30:11,240
so on a general<font color="#CCCCCC"> level</font><font color="#E5E5E5"> you know this is a</font>

884
00:30:09,230 --> 00:30:11,950
pretty broad<font color="#E5E5E5"> catch-all for just looking</font>

885
00:30:11,240 --> 00:30:13,690
<font color="#CCCCCC">for</font>

886
00:30:11,950 --> 00:30:16,080
Python that happens to reference<font color="#E5E5E5"> any</font>

887
00:30:13,690 --> 00:30:18,370
sort of<font color="#CCCCCC"> industrial control</font><font color="#E5E5E5"> system</font>

888
00:30:16,080 --> 00:30:20,199
technology so ultra lying on a

889
00:30:18,370 --> 00:30:22,899
<font color="#CCCCCC">straight-up strings</font><font color="#E5E5E5"> look for artifacts</font>

890
00:30:20,200 --> 00:30:25,240
of the<font color="#CCCCCC"> pi/2 x ee compiler</font><font color="#E5E5E5"> and does it</font>

891
00:30:22,899 --> 00:30:26,649
reference any of these signals that I

892
00:30:25,240 --> 00:30:28,419
know would indicate that it's

893
00:30:26,649 --> 00:30:30,250
referencing some technology<font color="#CCCCCC"> that I care</font>

894
00:30:28,419 --> 00:30:31,539
<font color="#CCCCCC">about</font><font color="#E5E5E5"> so this is your general detection</font>

895
00:30:30,250 --> 00:30:33,279
like I should never see<font color="#E5E5E5"> something</font><font color="#CCCCCC"> like</font>

896
00:30:31,539 --> 00:30:35,679
this<font color="#E5E5E5"> and if I do that's a cause</font><font color="#CCCCCC"> for</font>

897
00:30:33,279 --> 00:30:38,080
investigation<font color="#E5E5E5"> so you know here is your</font>

898
00:30:35,679 --> 00:30:39,760
general detection methodology<font color="#E5E5E5"> but then</font>

899
00:30:38,080 --> 00:30:41,668
you can dig a well<font color="#E5E5E5"> layer deeper and</font>

900
00:30:39,760 --> 00:30:43,870
these are specifically<font color="#E5E5E5"> tailored</font><font color="#CCCCCC"> to the</font>

901
00:30:41,669 --> 00:30:45,610
malicious payloads that<font color="#E5E5E5"> were used in the</font>

902
00:30:43,870 --> 00:30:46,809
<font color="#CCCCCC">traces event I've got a more general one</font>

903
00:30:45,610 --> 00:30:48,760
<font color="#CCCCCC">of these that's out there</font><font color="#E5E5E5"> as well but</font>

904
00:30:46,809 --> 00:30:50,740
it's<font color="#E5E5E5"> the same</font><font color="#CCCCCC"> sort of</font><font color="#E5E5E5"> idea but</font><font color="#CCCCCC"> you know</font>

905
00:30:48,760 --> 00:30:53,980
<font color="#E5E5E5">looking for this specific file header</font>

906
00:30:50,740 --> 00:30:56,440
within the bin file<font color="#CCCCCC"> you know file size</font>

907
00:30:53,980 --> 00:30:58,450
less<font color="#CCCCCC"> than 10 KB kilobytes these are tiny</font>

908
00:30:56,440 --> 00:31:01,179
files and then let me see<font color="#E5E5E5"> these</font>

909
00:30:58,450 --> 00:31:03,010
sequences that correspond to the logic

910
00:31:01,179 --> 00:31:05,049
format of the<font color="#E5E5E5"> Tri</font><font color="#CCCCCC"> conics controller</font><font color="#E5E5E5"> and</font>

911
00:31:03,010 --> 00:31:08,590
from these<font color="#E5E5E5"> you could abstract them so</font>

912
00:31:05,049 --> 00:31:10,510
this was the go figure<font color="#E5E5E5"> I didn't label</font>

913
00:31:08,590 --> 00:31:12,820
<font color="#E5E5E5">these I want to say that this is I main</font>

914
00:31:10,510 --> 00:31:14,620
dot<font color="#CCCCCC"> bin and this is inject</font><font color="#E5E5E5"> that bin but</font>

915
00:31:12,820 --> 00:31:16,210
that could<font color="#CCCCCC"> be reversed anyway so that</font>

916
00:31:14,620 --> 00:31:18,489
picks up<font color="#E5E5E5"> the specific modules but with</font>

917
00:31:16,210 --> 00:31:20,860
some<font color="#CCCCCC"> mutt modifications you can design</font>

918
00:31:18,490 --> 00:31:22,210
<font color="#E5E5E5">this to look for any example of firmware</font>

919
00:31:20,860 --> 00:31:23,830
<font color="#E5E5E5">and identifying when those get</font>

920
00:31:22,210 --> 00:31:25,870
introduced to<font color="#E5E5E5"> the network which again</font>

921
00:31:23,830 --> 00:31:28,240
should be<font color="#E5E5E5"> a trigger</font><font color="#CCCCCC"> to ID to initiate an</font>

922
00:31:25,870 --> 00:31:30,459
investigation<font color="#CCCCCC"> so what are takeaways here</font>

923
00:31:28,240 --> 00:31:32,980
<font color="#E5E5E5">well first off it's a safety system</font>

924
00:31:30,460 --> 00:31:34,419
controller<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> 0 host visibility on</font>

925
00:31:32,980 --> 00:31:36,490
these devices<font color="#CCCCCC"> and you probably</font><font color="#E5E5E5"> don't</font>

926
00:31:34,419 --> 00:31:38,139
have much on the safety<font color="#CCCCCC"> workstation that</font>

927
00:31:36,490 --> 00:31:40,750
<font color="#E5E5E5">it connects to to begin with these are</font>

928
00:31:38,139 --> 00:31:42,189
allegedly<font color="#CCCCCC"> air-gap systems although</font><font color="#E5E5E5"> as we</font>

929
00:31:40,750 --> 00:31:43,870
saw the fact<font color="#CCCCCC"> that this</font><font color="#E5E5E5"> event even took</font>

930
00:31:42,190 --> 00:31:46,139
<font color="#E5E5E5">place in the first place</font><font color="#CCCCCC"> that air</font><font color="#E5E5E5"> gap is</font>

931
00:31:43,870 --> 00:31:48,789
<font color="#E5E5E5">not as robust as you think it is but</font>

932
00:31:46,139 --> 00:31:51,279
nonetheless<font color="#E5E5E5"> you don't have much in the</font>

933
00:31:48,789 --> 00:31:52,779
<font color="#CCCCCC">way of remote host monitoring or you</font>

934
00:31:51,279 --> 00:31:54,370
know shipping logs off to a central

935
00:31:52,779 --> 00:31:56,440
stash or<font color="#CCCCCC"> Splunk or something along</font><font color="#E5E5E5"> those</font>

936
00:31:54,370 --> 00:31:58,928
<font color="#CCCCCC">lines but</font><font color="#E5E5E5"> what you do have is we have</font>

937
00:31:56,440 --> 00:32:01,360
multiple<font color="#E5E5E5"> ingress and egress points to</font>

938
00:31:58,929 --> 00:32:03,340
get<font color="#E5E5E5"> to that target controller</font><font color="#CCCCCC"> where</font><font color="#E5E5E5"> you</font>

939
00:32:01,360 --> 00:32:04,870
<font color="#E5E5E5">can see what is moving to and from it</font>

940
00:32:03,340 --> 00:32:07,029
<font color="#E5E5E5">and to get an idea for what's happening</font>

941
00:32:04,870 --> 00:32:08,559
there as a<font color="#E5E5E5"> result of that visibility so</font>

942
00:32:07,029 --> 00:32:10,779
you can look<font color="#E5E5E5"> for</font><font color="#CCCCCC"> items that either never</font>

943
00:32:08,559 --> 00:32:12,610
belong like the compiled Python<font color="#CCCCCC"> example</font>

944
00:32:10,779 --> 00:32:15,909
<font color="#E5E5E5">or only appear during known legitimate</font>

945
00:32:12,610 --> 00:32:18,370
<font color="#CCCCCC">activity such as</font><font color="#E5E5E5"> the bin files that are</font>

946
00:32:15,909 --> 00:32:20,830
<font color="#E5E5E5">used</font><font color="#CCCCCC"> for the Tri</font><font color="#E5E5E5"> connects logic</font>

947
00:32:18,370 --> 00:32:22,510
let's close well that's close the talk

948
00:32:20,830 --> 00:32:24,610
<font color="#E5E5E5">but close are examples cuz I</font><font color="#CCCCCC"> think</font><font color="#E5E5E5"> yeah</font>

949
00:32:22,510 --> 00:32:25,960
I'm doing okay<font color="#CCCCCC"> on time with a third</font>

950
00:32:24,610 --> 00:32:26,949
<font color="#CCCCCC">example that's a</font><font color="#E5E5E5"> little more general</font>

951
00:32:25,960 --> 00:32:29,700
that might apply to<font color="#E5E5E5"> some of</font><font color="#CCCCCC"> your</font>

952
00:32:26,950 --> 00:32:32,230
environments<font color="#CCCCCC"> so there is a we define</font>

953
00:32:29,700 --> 00:32:34,510
<font color="#E5E5E5">intrusion actor or intrusion activity by</font>

954
00:32:32,230 --> 00:32:35,950
activity<font color="#CCCCCC"> groups it's a whole</font><font color="#E5E5E5"> another</font>

955
00:32:34,510 --> 00:32:38,020
<font color="#CCCCCC">conversation you can pull</font><font color="#E5E5E5"> me aside on</font>

956
00:32:35,950 --> 00:32:40,299
<font color="#CCCCCC">that one later one that we track is</font>

957
00:32:38,020 --> 00:32:41,980
referred to as<font color="#E5E5E5"> die</font><font color="#CCCCCC"> Molloy</font><font color="#E5E5E5"> you may have</font>

958
00:32:40,299 --> 00:32:43,389
heard<font color="#E5E5E5"> of some of</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> activity because</font>

959
00:32:41,980 --> 00:32:45,640
<font color="#CCCCCC">it gets rolled into</font><font color="#E5E5E5"> something that's</font>

960
00:32:43,390 --> 00:32:48,820
<font color="#CCCCCC">semantic reported</font><font color="#E5E5E5"> last year as dragonfly</font>

961
00:32:45,640 --> 00:32:50,740
2.0<font color="#CCCCCC"> there's a group that was active in</font>

962
00:32:48,820 --> 00:32:53,260
<font color="#E5E5E5">Turkey Europe and North America</font>

963
00:32:50,740 --> 00:32:54,940
so some superficial similarity to<font color="#CCCCCC"> the</font>

964
00:32:53,260 --> 00:32:56,890
legacy<font color="#E5E5E5"> dragonfly activity those are the</font>

965
00:32:54,940 --> 00:32:58,539
guys who deployed<font color="#CCCCCC"> Havoc's and had a lot</font>

966
00:32:56,890 --> 00:32:59,830
of<font color="#E5E5E5"> success</font><font color="#CCCCCC"> in penetrating industrial</font>

967
00:32:58,539 --> 00:33:01,658
control system environments but

968
00:32:59,830 --> 00:33:03,189
significant differences that we treat it

969
00:33:01,659 --> 00:33:05,559
like a separate<font color="#E5E5E5"> group</font><font color="#CCCCCC"> okay . that's</font>

970
00:33:03,190 --> 00:33:07,870
academic<font color="#E5E5E5"> wang</font><font color="#CCCCCC"> curry right</font><font color="#E5E5E5"> there main</font>

971
00:33:05,559 --> 00:33:09,760
thing is part<font color="#CCCCCC"> of the ICS intrusion</font>

972
00:33:07,870 --> 00:33:11,830
involved<font color="#CCCCCC"> where the diamond eye actor was</font>

973
00:33:09,760 --> 00:33:13,960
the exfiltration of HMI screenshots

974
00:33:11,830 --> 00:33:15,879
screenshot exfiltration<font color="#E5E5E5"> why is that</font>

975
00:33:13,960 --> 00:33:18,220
interesting<font color="#CCCCCC"> well you</font><font color="#E5E5E5"> don't see too many</font>

976
00:33:15,880 --> 00:33:20,080
JPEGs or PNG s coming out of your

977
00:33:18,220 --> 00:33:22,659
<font color="#CCCCCC">industrial network well not only that</font>

978
00:33:20,080 --> 00:33:24,970
<font color="#CCCCCC">but</font><font color="#E5E5E5"> screenshots if you think about it a</font>

979
00:33:22,659 --> 00:33:27,460
little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> are typically identified by a</font>

980
00:33:24,970 --> 00:33:29,890
couple<font color="#E5E5E5"> of interesting metadata points so</font>

981
00:33:27,460 --> 00:33:32,679
<font color="#E5E5E5">dye</font><font color="#CCCCCC"> malloy itself you know</font><font color="#E5E5E5"> their modus</font>

982
00:33:29,890 --> 00:33:34,240
operandi<font color="#E5E5E5"> their method of operating</font><font color="#CCCCCC"> you</font>

983
00:33:32,679 --> 00:33:36,399
know initial access via phishing and

984
00:33:34,240 --> 00:33:37,960
website compromise that<font color="#CCCCCC"> upload a lot of</font>

985
00:33:36,399 --> 00:33:39,459
malware mostly a lot<font color="#E5E5E5"> of you know</font>

986
00:33:37,960 --> 00:33:41,710
off-the-shelf sort of stuff<font color="#E5E5E5"> that could</font>

987
00:33:39,460 --> 00:33:43,120
<font color="#E5E5E5">be confused a lot of</font><font color="#CCCCCC"> other criminal</font>

988
00:33:41,710 --> 00:33:45,250
activity<font color="#E5E5E5"> etcetera nothing really</font>

989
00:33:43,120 --> 00:33:47,439
interesting<font color="#CCCCCC"> there and then at the final</font>

990
00:33:45,250 --> 00:33:50,830
information<font color="#E5E5E5"> collection stage you know</font>

991
00:33:47,440 --> 00:33:52,630
they deployed a credential grabber that

992
00:33:50,830 --> 00:33:54,639
included the mini cat source code and

993
00:33:52,630 --> 00:33:57,270
did a<font color="#E5E5E5"> few other you know goofy things in</font>

994
00:33:54,640 --> 00:33:59,500
order<font color="#E5E5E5"> to harvest credentials a document</font>

995
00:33:57,270 --> 00:34:01,299
vacuum cleaner I<font color="#E5E5E5"> guess because it just</font>

996
00:33:59,500 --> 00:34:03,309
would look for<font color="#CCCCCC"> any sort of spreadsheet</font>

997
00:34:01,299 --> 00:34:05,830
or whatever or zip it up<font color="#E5E5E5"> and send it off</font>

998
00:34:03,309 --> 00:34:07,720
but then there was also<font color="#E5E5E5"> the exfiltration</font>

999
00:34:05,830 --> 00:34:09,069
of<font color="#CCCCCC"> screenshots</font><font color="#E5E5E5"> so you might think</font><font color="#CCCCCC"> like</font>

1000
00:34:07,720 --> 00:34:11,080
well what importance is a screenshot

1001
00:34:09,070 --> 00:34:12,580
<font color="#CCCCCC">other than saying like haha</font><font color="#E5E5E5"> screenshot</font>

1002
00:34:11,080 --> 00:34:14,168
of your<font color="#E5E5E5"> box I compromised your system</font>

1003
00:34:12,580 --> 00:34:15,549
well if you think<font color="#E5E5E5"> about it a human</font>

1004
00:34:14,168 --> 00:34:17,080
machine<font color="#E5E5E5"> interface device in an</font>

1005
00:34:15,550 --> 00:34:19,780
industrial control system<font color="#E5E5E5"> network is</font>

1006
00:34:17,080 --> 00:34:22,359
going to give you an overview of the

1007
00:34:19,780 --> 00:34:24,339
plant process the plant environment<font color="#CCCCCC"> as a</font>

1008
00:34:22,359 --> 00:34:25,960
you<font color="#E5E5E5"> know initial intelligence collection</font>

1009
00:34:24,339 --> 00:34:27,940
point it's actually<font color="#CCCCCC"> quite valuable</font><font color="#E5E5E5"> and</font>

1010
00:34:25,960 --> 00:34:29,980
<font color="#CCCCCC">it can identify subsequent network</font><font color="#E5E5E5"> No</font>

1011
00:34:27,940 --> 00:34:31,389
that you either need<font color="#E5E5E5"> to</font><font color="#CCCCCC"> compromise in</font>

1012
00:34:29,980 --> 00:34:33,099
order<font color="#E5E5E5"> to achieve a goal or if you're</font>

1013
00:34:31,389 --> 00:34:34,899
just<font color="#E5E5E5"> simply committing industrial</font>

1014
00:34:33,099 --> 00:34:36,280
espionage<font color="#E5E5E5"> can give you an awful lot</font><font color="#CCCCCC"> of</font>

1015
00:34:34,899 --> 00:34:37,719
information<font color="#CCCCCC"> for how that process</font><font color="#E5E5E5"> is</font>

1016
00:34:36,280 --> 00:34:39,369
<font color="#CCCCCC">designed</font><font color="#E5E5E5"> so it's</font><font color="#CCCCCC"> actually a very</font>

1017
00:34:37,719 --> 00:34:42,969
<font color="#E5E5E5">valuable piece of data for</font><font color="#CCCCCC"> these guys to</font>

1018
00:34:39,369 --> 00:34:44,859
<font color="#E5E5E5">have grabbed now a screen shot activity</font>

1019
00:34:42,969 --> 00:34:46,719
within the ICS<font color="#CCCCCC"> network is a good</font>

1020
00:34:44,859 --> 00:34:47,409
alerting point<font color="#E5E5E5"> how do you actually alert</font>

1021
00:34:46,719 --> 00:34:49,209
on it though

1022
00:34:47,409 --> 00:34:50,560
well you don't have<font color="#CCCCCC"> hosts logs and even</font>

1023
00:34:49,210 --> 00:34:51,970
saying that<font color="#CCCCCC"> I</font><font color="#E5E5E5"> don't know how you really</font>

1024
00:34:50,560 --> 00:34:55,239
picked that<font color="#CCCCCC"> out and host logs - well</font>

1025
00:34:51,969 --> 00:34:56,770
anyway<font color="#CCCCCC"> but something that</font><font color="#E5E5E5"> doesn't get</font>

1026
00:34:55,239 --> 00:34:58,629
<font color="#CCCCCC">picked up by a</font><font color="#E5E5E5"> security solution</font><font color="#CCCCCC"> either</font>

1027
00:34:56,770 --> 00:35:01,420
<font color="#CCCCCC">I don't know of a carbon black rule or</font>

1028
00:34:58,630 --> 00:35:02,800
of a you<font color="#E5E5E5"> know picking</font><font color="#CCCCCC"> EDR product or</font>

1029
00:35:01,420 --> 00:35:03,970
<font color="#E5E5E5">whatever that's like oh my goodness</font><font color="#CCCCCC"> we</font>

1030
00:35:02,800 --> 00:35:05,380
<font color="#CCCCCC">got a screenshot like I've never</font><font color="#E5E5E5"> seen</font>

1031
00:35:03,970 --> 00:35:06,700
<font color="#CCCCCC">that</font><font color="#E5E5E5"> before if I'm wrong</font>

1032
00:35:05,380 --> 00:35:08,079
they don't correct me afterwards<font color="#E5E5E5"> or</font>

1033
00:35:06,700 --> 00:35:09,609
whatever<font color="#CCCCCC"> it'll certainly adjust this but</font>

1034
00:35:08,079 --> 00:35:11,470
it's<font color="#E5E5E5"> typically</font><font color="#CCCCCC"> not activity that we</font>

1035
00:35:09,609 --> 00:35:13,119
associate with maliciousness<font color="#E5E5E5"> but it's a</font>

1036
00:35:11,470 --> 00:35:14,859
good indicator<font color="#CCCCCC"> that someone is in the</font>

1037
00:35:13,119 --> 00:35:17,650
<font color="#E5E5E5">process of doing something you would</font>

1038
00:35:14,859 --> 00:35:19,210
otherwise<font color="#CCCCCC"> they'd not do so what we can</font>

1039
00:35:17,650 --> 00:35:21,460
do that in order<font color="#E5E5E5"> to identify this is</font>

1040
00:35:19,210 --> 00:35:23,349
<font color="#E5E5E5">deploy bro</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> look for files that match</font>

1041
00:35:21,460 --> 00:35:25,750
a<font color="#E5E5E5"> screenshot profile leaving the network</font>

1042
00:35:23,349 --> 00:35:27,400
<font color="#CCCCCC">in question</font><font color="#E5E5E5"> so how do we do</font><font color="#CCCCCC"> identify</font>

1043
00:35:25,750 --> 00:35:28,750
what a screenshot<font color="#E5E5E5"> is well look for image</font>

1044
00:35:27,400 --> 00:35:30,190
files<font color="#E5E5E5"> that match known desktop</font>

1045
00:35:28,750 --> 00:35:31,420
resolutions<font color="#E5E5E5"> because unless you have</font>

1046
00:35:30,190 --> 00:35:33,430
<font color="#E5E5E5">someone who's opening up paint and</font>

1047
00:35:31,420 --> 00:35:34,720
resizing things on the fly chances<font color="#E5E5E5"> are</font>

1048
00:35:33,430 --> 00:35:37,029
you're only<font color="#E5E5E5"> going to</font><font color="#CCCCCC"> see things in about</font>

1049
00:35:34,720 --> 00:35:38,770
five<font color="#E5E5E5"> or six ish different combinations</font>

1050
00:35:37,030 --> 00:35:40,480
of resolutions especially when you're

1051
00:35:38,770 --> 00:35:42,609
<font color="#E5E5E5">talking about a very</font><font color="#CCCCCC"> narrow set</font><font color="#E5E5E5"> of</font>

1052
00:35:40,480 --> 00:35:45,160
devices<font color="#E5E5E5"> such</font><font color="#CCCCCC"> as human machine interface</font>

1053
00:35:42,609 --> 00:35:47,049
devices<font color="#CCCCCC"> in an ICS network so</font><font color="#E5E5E5"> this is</font>

1054
00:35:45,160 --> 00:35:49,060
kind of a stupid<font color="#E5E5E5"> simple alert that you</font>

1055
00:35:47,050 --> 00:35:51,160
can design<font color="#E5E5E5"> so identify that there's an</font>

1056
00:35:49,060 --> 00:35:53,049
<font color="#E5E5E5">image file on the wire capture the file</font>

1057
00:35:51,160 --> 00:35:54,700
via bro and<font color="#E5E5E5"> then do a simple</font><font color="#CCCCCC"> exit grab</font>

1058
00:35:53,050 --> 00:35:56,890
in order to see does this screenshot

1059
00:35:54,700 --> 00:35:58,660
match<font color="#CCCCCC"> a does this image</font><font color="#E5E5E5"> file match a</font>

1060
00:35:56,890 --> 00:36:00,098
screenshot resolution<font color="#E5E5E5"> so there's not a</font>

1061
00:35:58,660 --> 00:36:01,990
whole lot<font color="#CCCCCC"> of complexity here</font><font color="#E5E5E5"> but at the</font>

1062
00:36:00,099 --> 00:36:03,400
<font color="#E5E5E5">same time if you ever see this</font><font color="#CCCCCC"> in the</font>

1063
00:36:01,990 --> 00:36:06,279
environment<font color="#CCCCCC"> that</font><font color="#E5E5E5"> this rule is tailored</font>

1064
00:36:03,400 --> 00:36:07,960
for<font color="#E5E5E5"> something not cool is going</font><font color="#CCCCCC"> on you</font>

1065
00:36:06,280 --> 00:36:09,460
have an engineer<font color="#E5E5E5"> who's trying</font><font color="#CCCCCC"> to make a</font>

1066
00:36:07,960 --> 00:36:10,960
PowerPoint for<font color="#E5E5E5"> their next presentation</font>

1067
00:36:09,460 --> 00:36:12,579
that you know a conference in Las Vegas

1068
00:36:10,960 --> 00:36:15,339
<font color="#E5E5E5">or</font><font color="#CCCCCC"> something</font><font color="#E5E5E5"> or someone's trying to</font>

1069
00:36:12,579 --> 00:36:17,349
steal<font color="#CCCCCC"> data from your</font><font color="#E5E5E5"> network so we can</font>

1070
00:36:15,339 --> 00:36:19,630
apply<font color="#CCCCCC"> yarra to X if results</font><font color="#E5E5E5"> or to other</font>

1071
00:36:17,349 --> 00:36:21,280
ways<font color="#E5E5E5"> of grabbing file metadata pattern</font>

1072
00:36:19,630 --> 00:36:23,790
off those common<font color="#E5E5E5"> screen resolutions and</font>

1073
00:36:21,280 --> 00:36:25,930
use it as a useful data point<font color="#E5E5E5"> now I</font>

1074
00:36:23,790 --> 00:36:27,250
<font color="#E5E5E5">fought about this from an IT</font><font color="#CCCCCC"> perspective</font>

1075
00:36:25,930 --> 00:36:28,750
and it certainly seems like<font color="#E5E5E5"> there might</font>

1076
00:36:27,250 --> 00:36:30,910
be some legs to<font color="#CCCCCC"> it but I would like</font><font color="#E5E5E5"> to</font>

1077
00:36:28,750 --> 00:36:33,130
add in additional sort of logic<font color="#CCCCCC"> gates to</font>

1078
00:36:30,910 --> 00:36:34,899
make this into an effective<font color="#E5E5E5"> or useful</font>

1079
00:36:33,130 --> 00:36:36,310
rule there but again<font color="#E5E5E5"> tailored to the</font>

1080
00:36:34,900 --> 00:36:38,620
environment that<font color="#E5E5E5"> this is being deployed</font>

1081
00:36:36,310 --> 00:36:40,580
in<font color="#E5E5E5"> it's very useful</font>

1082
00:36:38,620 --> 00:36:42,410
so we've gotten<font color="#E5E5E5"> some examples we've</font>

1083
00:36:40,580 --> 00:36:43,940
talked about<font color="#CCCCCC"> like whoa yous Yaran bro</font>

1084
00:36:42,410 --> 00:36:45,109
<font color="#CCCCCC">the world would be a better place and</font>

1085
00:36:43,940 --> 00:36:46,700
<font color="#E5E5E5">you'll see all the things well</font>

1086
00:36:45,110 --> 00:36:48,770
<font color="#CCCCCC">ultimately this approach really</font><font color="#E5E5E5"> is</font><font color="#CCCCCC"> just</font>

1087
00:36:46,700 --> 00:36:50,779
an approximation<font color="#CCCCCC"> so for</font><font color="#E5E5E5"> those who have</font>

1088
00:36:48,770 --> 00:36:52,130
read<font color="#E5E5E5"> the Republic as Plato said the end</font>

1089
00:36:50,780 --> 00:36:53,960
of the day we're<font color="#E5E5E5"> only kind of glimpsing</font>

1090
00:36:52,130 --> 00:36:55,250
shadows on the<font color="#E5E5E5"> wall of the cave</font><font color="#CCCCCC"> you know</font>

1091
00:36:53,960 --> 00:36:57,050
this<font color="#CCCCCC"> is a</font><font color="#E5E5E5"> replacement for</font><font color="#CCCCCC"> host</font>

1092
00:36:55,250 --> 00:36:59,090
visibility it's really<font color="#E5E5E5"> just trying to</font>

1093
00:36:57,050 --> 00:37:00,860
make the<font color="#E5E5E5"> best of what</font><font color="#CCCCCC"> we have</font><font color="#E5E5E5"> so if you</font>

1094
00:36:59,090 --> 00:37:02,990
have an environment<font color="#CCCCCC"> where or</font><font color="#E5E5E5"> you have</font>

1095
00:37:00,860 --> 00:37:05,030
the flexibility to<font color="#E5E5E5"> do more from your</font>

1096
00:37:02,990 --> 00:37:07,970
<font color="#CCCCCC">network side</font><font color="#E5E5E5"> these are options to try</font>

1097
00:37:05,030 --> 00:37:10,100
and reduce<font color="#CCCCCC"> that</font><font color="#E5E5E5"> invisibility or increase</font>

1098
00:37:07,970 --> 00:37:11,600
<font color="#CCCCCC">your visibility</font><font color="#E5E5E5"> and respond and gain</font>

1099
00:37:10,100 --> 00:37:13,819
awareness<font color="#E5E5E5"> of what's happening in</font><font color="#CCCCCC"> your</font>

1100
00:37:11,600 --> 00:37:14,930
network now there are some key<font color="#CCCCCC"> weakness</font>

1101
00:37:13,820 --> 00:37:16,280
is involved<font color="#E5E5E5"> in this though I already</font>

1102
00:37:14,930 --> 00:37:17,779
<font color="#E5E5E5">mentioned encryption</font><font color="#CCCCCC"> we're going to talk</font>

1103
00:37:16,280 --> 00:37:19,520
<font color="#E5E5E5">about compound file types that's</font>

1104
00:37:17,780 --> 00:37:20,810
actually not as big of<font color="#E5E5E5"> a deal but it's</font>

1105
00:37:19,520 --> 00:37:23,270
<font color="#CCCCCC">something I</font><font color="#E5E5E5"> need to be considered and</font>

1106
00:37:20,810 --> 00:37:25,310
then some engineering perspectives

1107
00:37:23,270 --> 00:37:27,740
leading up<font color="#CCCCCC"> to you know what does this</font>

1108
00:37:25,310 --> 00:37:29,660
really give you in the end<font color="#CCCCCC"> so first off</font>

1109
00:37:27,740 --> 00:37:31,129
you<font color="#CCCCCC"> know what's the simple stupid way</font><font color="#E5E5E5"> to</font>

1110
00:37:29,660 --> 00:37:33,790
defeat<font color="#CCCCCC"> this</font><font color="#E5E5E5"> well encrypt all your</font>

1111
00:37:31,130 --> 00:37:36,380
traffic<font color="#E5E5E5"> at that point I'm blind</font><font color="#CCCCCC"> so</font>

1112
00:37:33,790 --> 00:37:38,270
<font color="#CCCCCC">what's more important is a lot of</font>

1113
00:37:36,380 --> 00:37:40,160
adversaries are moving to encrypted

1114
00:37:38,270 --> 00:37:42,380
communications channels<font color="#CCCCCC"> gone are</font><font color="#E5E5E5"> the</font>

1115
00:37:40,160 --> 00:37:44,540
<font color="#E5E5E5">days of the custom</font><font color="#CCCCCC"> X or routine or some</font>

1116
00:37:42,380 --> 00:37:46,580
other crazy and coding schema<font color="#E5E5E5"> that's</font>

1117
00:37:44,540 --> 00:37:48,440
designed from scratch<font color="#E5E5E5"> and I'll just get</font>

1118
00:37:46,580 --> 00:37:50,720
<font color="#CCCCCC">a let's encrypt cert and encrypt all my</font>

1119
00:37:48,440 --> 00:37:52,420
traffic<font color="#E5E5E5"> and you know you're done</font>

1120
00:37:50,720 --> 00:37:55,419
basically<font color="#E5E5E5"> dead in the water from a</font>

1121
00:37:52,420 --> 00:37:57,650
network traffic<font color="#E5E5E5"> analysis perspective</font>

1122
00:37:55,420 --> 00:37:58,970
<font color="#CCCCCC">that</font><font color="#E5E5E5"> is applicable in some environments</font>

1123
00:37:57,650 --> 00:38:00,560
though<font color="#CCCCCC"> so one thing that's nice if</font>

1124
00:37:58,970 --> 00:38:01,700
you're looking at this<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a intra</font>

1125
00:38:00,560 --> 00:38:02,930
<font color="#E5E5E5">network perspective</font><font color="#CCCCCC"> like in the</font>

1126
00:38:01,700 --> 00:38:04,669
industrial control system environment

1127
00:38:02,930 --> 00:38:06,770
<font color="#E5E5E5">encryption for better or worse is</font>

1128
00:38:04,670 --> 00:38:08,870
incredibly rare<font color="#CCCCCC"> it doesn't happen that</font>

1129
00:38:06,770 --> 00:38:10,490
<font color="#E5E5E5">often you might see HTTP</font><font color="#CCCCCC"> for grabbing</font>

1130
00:38:08,870 --> 00:38:12,109
<font color="#E5E5E5">things like software updates which you</font>

1131
00:38:10,490 --> 00:38:14,479
have direct<font color="#E5E5E5"> internet connectivity then</font>

1132
00:38:12,110 --> 00:38:15,890
which is<font color="#E5E5E5"> not a good</font><font color="#CCCCCC"> thing</font><font color="#E5E5E5"> either</font><font color="#CCCCCC"> but a</font>

1133
00:38:14,480 --> 00:38:17,210
lot<font color="#CCCCCC"> of the protocols of interest for</font>

1134
00:38:15,890 --> 00:38:18,589
<font color="#CCCCCC">that</font><font color="#E5E5E5"> moving around</font><font color="#CCCCCC"> the network aren't</font>

1135
00:38:17,210 --> 00:38:19,070
encrypted so<font color="#CCCCCC"> it might</font><font color="#E5E5E5"> work very</font><font color="#CCCCCC"> well</font>

1136
00:38:18,590 --> 00:38:20,780
there

1137
00:38:19,070 --> 00:38:22,640
but you're probably<font color="#E5E5E5"> going to be dead</font><font color="#CCCCCC"> in</font>

1138
00:38:20,780 --> 00:38:24,500
the<font color="#CCCCCC"> water for</font><font color="#E5E5E5"> your traditional Windows</font>

1139
00:38:22,640 --> 00:38:26,450
domain<font color="#E5E5E5"> environment</font><font color="#CCCCCC"> but there are</font>

1140
00:38:24,500 --> 00:38:28,640
workarounds<font color="#CCCCCC"> so one thing that I like to</font>

1141
00:38:26,450 --> 00:38:29,779
<font color="#CCCCCC">look at is you know again going towards</font>

1142
00:38:28,640 --> 00:38:31,759
you know can I get a glimpse<font color="#E5E5E5"> of the</font>

1143
00:38:29,780 --> 00:38:34,370
information to figure<font color="#E5E5E5"> out something</font>

1144
00:38:31,760 --> 00:38:36,200
worth alerting or acting on<font color="#CCCCCC"> Boro allows</font>

1145
00:38:34,370 --> 00:38:38,690
you the<font color="#E5E5E5"> option of capturing certificates</font>

1146
00:38:36,200 --> 00:38:40,250
<font color="#CCCCCC">assess it with encrypted</font><font color="#E5E5E5"> traffic well</font>

1147
00:38:38,690 --> 00:38:41,270
<font color="#E5E5E5">why would might you want to do that well</font>

1148
00:38:40,250 --> 00:38:43,100
you<font color="#E5E5E5"> could</font><font color="#CCCCCC"> identify new or unknown</font>

1149
00:38:41,270 --> 00:38:44,930
<font color="#E5E5E5">certificates is one option</font><font color="#CCCCCC"> you're</font>

1150
00:38:43,100 --> 00:38:46,100
<font color="#E5E5E5">probably not</font><font color="#CCCCCC"> going to enjoy that a lot</font>

1151
00:38:44,930 --> 00:38:47,390
<font color="#CCCCCC">especially if you're doing</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> for</font>

1152
00:38:46,100 --> 00:38:48,470
environments<font color="#E5E5E5"> that do a lot</font><font color="#CCCCCC"> of web</font>

1153
00:38:47,390 --> 00:38:50,089
browsing<font color="#E5E5E5"> but</font>

1154
00:38:48,470 --> 00:38:52,279
can do is look<font color="#CCCCCC"> for certificates</font>

1155
00:38:50,090 --> 00:38:55,250
associated with things that are

1156
00:38:52,280 --> 00:38:56,630
suspicious inherently<font color="#E5E5E5"> so you know I have</font>

1157
00:38:55,250 --> 00:38:58,160
let's encrypt certificates<font color="#E5E5E5"> you know</font>

1158
00:38:56,630 --> 00:38:59,720
that's something it's<font color="#CCCCCC"> not an evil</font>

1159
00:38:58,160 --> 00:39:01,640
service in and of itself just<font color="#CCCCCC"> like or</font>

1160
00:38:59,720 --> 00:39:03,589
isn't evil<font color="#E5E5E5"> but it's certainly leveraged</font>

1161
00:39:01,640 --> 00:39:05,569
by a lot of<font color="#CCCCCC"> people as a cheap and</font><font color="#E5E5E5"> easy</font>

1162
00:39:03,590 --> 00:39:06,980
way<font color="#CCCCCC"> of getting</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> job done</font><font color="#E5E5E5"> and maybe</font>

1163
00:39:05,570 --> 00:39:09,530
you shouldn't see any let's encrypt

1164
00:39:06,980 --> 00:39:11,000
certificates for egress traffic from

1165
00:39:09,530 --> 00:39:12,710
<font color="#E5E5E5">your network</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> can also look for</font>

1166
00:39:11,000 --> 00:39:14,570
<font color="#E5E5E5">things that are self signed or even</font>

1167
00:39:12,710 --> 00:39:18,500
known malicious items so in a past life

1168
00:39:14,570 --> 00:39:20,060
I did a lot<font color="#CCCCCC"> of work on the apt twenty</font>

1169
00:39:18,500 --> 00:39:22,010
<font color="#CCCCCC">eight</font><font color="#E5E5E5"> group fancy bearer however you</font>

1170
00:39:20,060 --> 00:39:23,900
want to<font color="#E5E5E5"> call them and they had a dead</font>

1171
00:39:22,010 --> 00:39:29,359
giveaway pattern for how<font color="#E5E5E5"> they created</font>

1172
00:39:23,900 --> 00:39:31,070
their SSL certs<font color="#CCCCCC"> lose London London UK</font><font color="#E5E5E5"> I</font>

1173
00:39:29,359 --> 00:39:35,750
<font color="#E5E5E5">can look it up again or whatever but</font>

1174
00:39:31,070 --> 00:39:38,450
they had the cert metadata pattern was

1175
00:39:35,750 --> 00:39:40,190
<font color="#CCCCCC">the</font><font color="#E5E5E5"> same for all</font><font color="#CCCCCC"> of their C to</font><font color="#E5E5E5"> knows so</font>

1176
00:39:38,450 --> 00:39:42,080
identify<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> that matches that and</font>

1177
00:39:40,190 --> 00:39:44,030
like I have a suspicious certificate

1178
00:39:42,080 --> 00:39:46,580
associated with SSL traffic<font color="#E5E5E5"> that I know</font>

1179
00:39:44,030 --> 00:39:48,230
is associated<font color="#CCCCCC"> to unknown</font><font color="#E5E5E5"> bad actor</font><font color="#CCCCCC"> okay</font>

1180
00:39:46,580 --> 00:39:50,420
<font color="#CCCCCC">you've cleared up the image a little bit</font>

1181
00:39:48,230 --> 00:39:51,710
<font color="#E5E5E5">by having that metadata look now you</font>

1182
00:39:50,420 --> 00:39:53,300
have<font color="#E5E5E5"> something to investigate whereas</font>

1183
00:39:51,710 --> 00:39:55,070
before<font color="#E5E5E5"> like oh it's encrypted I can't do</font>

1184
00:39:53,300 --> 00:39:57,230
<font color="#CCCCCC">anything with it</font><font color="#E5E5E5"> another thing you can</font>

1185
00:39:55,070 --> 00:39:58,580
<font color="#E5E5E5">do you can do SSL intercept this is a</font>

1186
00:39:57,230 --> 00:40:01,490
touchy subject

1187
00:39:58,580 --> 00:40:03,560
um so it's<font color="#E5E5E5"> justifiable in my opinion</font>

1188
00:40:01,490 --> 00:40:05,509
giving the shifting landscape<font color="#CCCCCC"> it's going</font>

1189
00:40:03,560 --> 00:40:06,710
to your users are<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> hate you</font><font color="#CCCCCC"> your</font>

1190
00:40:05,510 --> 00:40:08,480
lawyers are<font color="#E5E5E5"> probably gonna hate you too</font>

1191
00:40:06,710 --> 00:40:09,800
if you<font color="#E5E5E5"> try and pitch this but it's</font>

1192
00:40:08,480 --> 00:40:12,800
something that<font color="#CCCCCC"> needs to be at least</font>

1193
00:40:09,800 --> 00:40:14,210
<font color="#E5E5E5">discussed from a</font><font color="#CCCCCC"> gain/loss</font><font color="#E5E5E5"> perspective</font>

1194
00:40:12,800 --> 00:40:15,589
like yeah we<font color="#E5E5E5"> can do this but then you</font>

1195
00:40:14,210 --> 00:40:17,390
<font color="#CCCCCC">got</font><font color="#E5E5E5"> to worry about your security team</font>

1196
00:40:15,589 --> 00:40:18,859
<font color="#E5E5E5">stealing people's banking data and</font>

1197
00:40:17,390 --> 00:40:20,598
<font color="#CCCCCC">privacy</font><font color="#E5E5E5"> and all these other</font><font color="#CCCCCC"> things but</font>

1198
00:40:18,859 --> 00:40:23,480
<font color="#CCCCCC">if we</font><font color="#E5E5E5"> don't do it it means that all</font>

1199
00:40:20,599 --> 00:40:25,820
these bad<font color="#CCCCCC"> actors from</font><font color="#E5E5E5"> apt to ransomware</font>

1200
00:40:23,480 --> 00:40:27,200
<font color="#E5E5E5">script kiddies or whatever can do</font>

1201
00:40:25,820 --> 00:40:29,240
whatever they want<font color="#CCCCCC"> on the on the wire</font>

1202
00:40:27,200 --> 00:40:31,368
and<font color="#E5E5E5"> we can't see it it's something</font><font color="#CCCCCC"> to</font>

1203
00:40:29,240 --> 00:40:33,109
discuss<font color="#CCCCCC"> but for many reasons</font><font color="#E5E5E5"> it's</font><font color="#CCCCCC"> not</font>

1204
00:40:31,369 --> 00:40:34,790
going to be<font color="#E5E5E5"> practical for</font><font color="#CCCCCC"> most people</font>

1205
00:40:33,109 --> 00:40:37,430
<font color="#CCCCCC">another</font><font color="#E5E5E5"> thing you can do is identify</font>

1206
00:40:34,790 --> 00:40:38,810
<font color="#CCCCCC">hosts</font><font color="#E5E5E5"> workarounds if possible</font><font color="#CCCCCC"> so</font>

1207
00:40:37,430 --> 00:40:40,790
certainly you<font color="#E5E5E5"> can identify</font><font color="#CCCCCC"> hosts</font>

1208
00:40:38,810 --> 00:40:42,740
<font color="#E5E5E5">workarounds from the standpoint of host</font>

1209
00:40:40,790 --> 00:40:44,300
based logging that<font color="#CCCCCC"> kind of shifts the</font>

1210
00:40:42,740 --> 00:40:45,830
conversation back<font color="#E5E5E5"> to</font><font color="#CCCCCC"> where we started</font>

1211
00:40:44,300 --> 00:40:46,910
though and defeats the purpose of my

1212
00:40:45,830 --> 00:40:48,890
talk so<font color="#E5E5E5"> we're not going to</font><font color="#CCCCCC"> talk about</font>

1213
00:40:46,910 --> 00:40:50,359
<font color="#CCCCCC">that</font><font color="#E5E5E5"> instead what we will talk about</font>

1214
00:40:48,890 --> 00:40:52,250
<font color="#E5E5E5">something</font><font color="#CCCCCC"> interesting that</font><font color="#E5E5E5"> I just</font>

1215
00:40:50,359 --> 00:40:55,190
learned<font color="#E5E5E5"> about a couple of</font><font color="#CCCCCC"> months ago so</font>

1216
00:40:52,250 --> 00:40:56,869
<font color="#CCCCCC">something called the ja3 project which</font>

1217
00:40:55,190 --> 00:40:58,970
is designed for<font color="#CCCCCC"> hosting application</font>

1218
00:40:56,869 --> 00:41:00,670
fingerprinting<font color="#E5E5E5"> this was something put</font>

1219
00:40:58,970 --> 00:41:03,129
together by<font color="#E5E5E5"> John Altos</font>

1220
00:41:00,670 --> 00:41:04,240
at Salesforce I was presented at<font color="#CCCCCC"> the art</font>

1221
00:41:03,130 --> 00:41:06,309
into<font color="#E5E5E5"> science conference a</font><font color="#CCCCCC"> couple of</font>

1222
00:41:04,240 --> 00:41:10,299
months<font color="#CCCCCC"> ago</font><font color="#E5E5E5"> it allows for</font><font color="#CCCCCC"> the</font>

1223
00:41:06,309 --> 00:41:12,790
<font color="#CCCCCC">identification</font><font color="#E5E5E5"> of hosts</font><font color="#CCCCCC"> and applications</font>

1224
00:41:10,299 --> 00:41:14,319
based upon the certificate metadata in

1225
00:41:12,790 --> 00:41:15,970
<font color="#CCCCCC">the traffic stream</font><font color="#E5E5E5"> so it's a way of</font>

1226
00:41:14,319 --> 00:41:18,220
fingerprinting<font color="#E5E5E5"> what the application is</font>

1227
00:41:15,970 --> 00:41:19,779
<font color="#CCCCCC">that happens to</font><font color="#E5E5E5"> be talking back</font><font color="#CCCCCC"> so maybe</font>

1228
00:41:18,220 --> 00:41:22,149
it's<font color="#CCCCCC"> not</font><font color="#E5E5E5"> the browser maybe it's</font>

1229
00:41:19,780 --> 00:41:23,950
someone's deployed<font color="#E5E5E5"> you know remote</font>

1230
00:41:22,150 --> 00:41:26,260
access tool<font color="#E5E5E5"> or</font><font color="#CCCCCC"> own</font><font color="#E5E5E5"> access trojan or</font>

1231
00:41:23,950 --> 00:41:29,558
something else<font color="#E5E5E5"> this can allow you to get</font>

1232
00:41:26,260 --> 00:41:31,059
a<font color="#E5E5E5"> viewpoint of what sort of encrypted</font>

1233
00:41:29,559 --> 00:41:32,770
<font color="#E5E5E5">endpoints are in your environment and</font>

1234
00:41:31,059 --> 00:41:34,900
look for ones that are anomalous or new

1235
00:41:32,770 --> 00:41:36,339
so again you know this is<font color="#E5E5E5"> relying on</font>

1236
00:41:34,900 --> 00:41:38,260
network traffic capture but it gives you

1237
00:41:36,339 --> 00:41:39,790
at<font color="#CCCCCC"> least some insight into</font><font color="#E5E5E5"> what might be</font>

1238
00:41:38,260 --> 00:41:41,440
<font color="#E5E5E5">going on within</font><font color="#CCCCCC"> the host</font><font color="#E5E5E5"> environment so</font>

1239
00:41:39,790 --> 00:41:42,819
I strongly<font color="#E5E5E5"> encourage everyone take a</font>

1240
00:41:41,440 --> 00:41:44,170
look at that it's a really<font color="#E5E5E5"> cool project</font>

1241
00:41:42,819 --> 00:41:45,940
I<font color="#CCCCCC"> need to start playing around with</font><font color="#E5E5E5"> it</font>

1242
00:41:44,170 --> 00:41:47,589
more<font color="#E5E5E5"> than</font><font color="#CCCCCC"> myself so we talked about</font>

1243
00:41:45,940 --> 00:41:50,290
encryption<font color="#E5E5E5"> that's a hard one but there's</font>

1244
00:41:47,589 --> 00:41:51,460
options<font color="#CCCCCC"> compound file types so</font><font color="#E5E5E5"> the</font>

1245
00:41:50,290 --> 00:41:55,329
approach that<font color="#E5E5E5"> I talked</font><font color="#CCCCCC"> about right now</font>

1246
00:41:51,460 --> 00:41:57,670
works really well for PE format<font color="#E5E5E5"> your</font>

1247
00:41:55,329 --> 00:41:58,270
legacy<font color="#CCCCCC"> office documents things</font><font color="#E5E5E5"> of that</font>

1248
00:41:57,670 --> 00:42:00,309
nature

1249
00:41:58,270 --> 00:42:03,220
doesn't work so well<font color="#E5E5E5"> with compound file</font>

1250
00:42:00,309 --> 00:42:08,530
types<font color="#E5E5E5"> like archives the XML format</font>

1251
00:42:03,220 --> 00:42:10,419
document types like docx<font color="#E5E5E5"> sls xlsx etc so</font>

1252
00:42:08,530 --> 00:42:12,190
what do you do<font color="#CCCCCC"> about those well it's</font>

1253
00:42:10,420 --> 00:42:14,589
simple<font color="#E5E5E5"> put a script in there and unpack</font>

1254
00:42:12,190 --> 00:42:16,420
the things so first<font color="#E5E5E5"> identify the file on</font>

1255
00:42:14,589 --> 00:42:19,180
<font color="#E5E5E5">the wire carbon from</font><font color="#CCCCCC"> save traffic okay</font>

1256
00:42:16,420 --> 00:42:21,220
do a mime type identification<font color="#E5E5E5"> to shunt</font>

1257
00:42:19,180 --> 00:42:23,020
it off to the<font color="#E5E5E5"> right processing script so</font>

1258
00:42:21,220 --> 00:42:25,240
<font color="#CCCCCC">in identify script by</font><font color="#E5E5E5"> name I'll type</font>

1259
00:42:23,020 --> 00:42:28,150
extract expand to attempt location and

1260
00:42:25,240 --> 00:42:32,290
then profit<font color="#E5E5E5"> so whether that's unpack upx</font>

1261
00:42:28,150 --> 00:42:34,299
<font color="#E5E5E5">unzip a zip file or unpackage a docx</font>

1262
00:42:32,290 --> 00:42:36,040
<font color="#E5E5E5">file lots of options for this you just</font>

1263
00:42:34,299 --> 00:42:37,540
<font color="#E5E5E5">need to be aware that they're out there</font>

1264
00:42:36,040 --> 00:42:40,720
and<font color="#CCCCCC"> put</font><font color="#E5E5E5"> something in place</font><font color="#CCCCCC"> to handle</font><font color="#E5E5E5"> it</font>

1265
00:42:37,540 --> 00:42:42,099
<font color="#E5E5E5">so here's a really simple example I did</font>

1266
00:42:40,720 --> 00:42:44,470
not modify this<font color="#E5E5E5"> from when I put it</font>

1267
00:42:42,099 --> 00:42:45,910
together<font color="#CCCCCC"> in my previous job</font><font color="#E5E5E5"> and I</font>

1268
00:42:44,470 --> 00:42:49,259
<font color="#CCCCCC">whipped this together in</font><font color="#E5E5E5"> 20 minutes or</font>

1269
00:42:45,910 --> 00:42:52,359
so so<font color="#CCCCCC"> it is</font><font color="#E5E5E5"> ugly</font><font color="#CCCCCC"> but it works</font><font color="#E5E5E5"> just</font>

1270
00:42:49,260 --> 00:42:55,359
<font color="#E5E5E5">identify all docx types within a</font>

1271
00:42:52,359 --> 00:42:57,400
directory<font color="#CCCCCC"> pass in a yaro rule unpack</font>

1272
00:42:55,359 --> 00:42:59,370
them<font color="#E5E5E5"> stand every individual unpacked</font>

1273
00:42:57,400 --> 00:43:01,170
item<font color="#E5E5E5"> post it doesn't</font>

1274
00:42:59,370 --> 00:43:03,509
grep for IP addresses because<font color="#E5E5E5"> this is</font>

1275
00:43:01,170 --> 00:43:06,260
when<font color="#E5E5E5"> I was looking at the fishery</font><font color="#CCCCCC"> that</font>

1276
00:43:03,510 --> 00:43:08,640
exploit but whatever the fishery kit for

1277
00:43:06,260 --> 00:43:09,780
injecting things<font color="#E5E5E5"> into document files and</font>

1278
00:43:08,640 --> 00:43:11,040
let me know if there's anything there

1279
00:43:09,780 --> 00:43:14,190
and clear it up at the<font color="#E5E5E5"> end if you see</font>

1280
00:43:11,040 --> 00:43:15,660
nothing<font color="#CCCCCC"> so this is 15-20 minutes worth</font>

1281
00:43:14,190 --> 00:43:16,140
of<font color="#E5E5E5"> batch</font><font color="#CCCCCC"> that solved that</font><font color="#E5E5E5"> problem right</font>

1282
00:43:15,660 --> 00:43:18,540
there

1283
00:43:16,140 --> 00:43:20,790
for trying to identify malicious macros

1284
00:43:18,540 --> 00:43:23,610
<font color="#E5E5E5">and office files or the fishery kit</font>

1285
00:43:20,790 --> 00:43:25,050
embedded within<font color="#CCCCCC"> office documents</font><font color="#E5E5E5"> no big</font>

1286
00:43:23,610 --> 00:43:26,700
deal there<font color="#E5E5E5"> just need to be aware of it</font>

1287
00:43:25,050 --> 00:43:27,960
and<font color="#E5E5E5"> implement</font><font color="#CCCCCC"> it</font><font color="#E5E5E5"> and make sure</font><font color="#CCCCCC"> that</font>

1288
00:43:26,700 --> 00:43:29,549
you're deleting<font color="#E5E5E5"> things after you're done</font>

1289
00:43:27,960 --> 00:43:31,680
<font color="#CCCCCC">-</font><font color="#E5E5E5"> because you can you know if you're</font>

1290
00:43:29,550 --> 00:43:32,970
<font color="#CCCCCC">doing this</font><font color="#E5E5E5"> for email for like a twenty</font>

1291
00:43:31,680 --> 00:43:34,680
five thousand person<font color="#CCCCCC"> Network and</font>

1292
00:43:32,970 --> 00:43:35,730
everyone likes<font color="#CCCCCC"> a chat attachments this</font>

1293
00:43:34,680 --> 00:43:38,669
will take up a lot of space fairly

1294
00:43:35,730 --> 00:43:40,830
quickly<font color="#E5E5E5"> so</font><font color="#CCCCCC"> yeah doable</font><font color="#E5E5E5"> requires effort</font>

1295
00:43:38,670 --> 00:43:42,900
<font color="#E5E5E5">key is just finding a</font><font color="#CCCCCC"> sustainable</font>

1296
00:43:40,830 --> 00:43:45,600
workflow<font color="#CCCCCC"> Buono vertex storage one</font><font color="#E5E5E5"> over</font>

1297
00:43:42,900 --> 00:43:47,160
<font color="#E5E5E5">tax processing and know what sort</font><font color="#CCCCCC"> of</font>

1298
00:43:45,600 --> 00:43:49,620
requirements<font color="#E5E5E5"> that you</font><font color="#CCCCCC"> have in question</font>

1299
00:43:47,160 --> 00:43:52,890
at the get-go<font color="#CCCCCC"> so that you are applying</font>

1300
00:43:49,620 --> 00:43:55,500
this<font color="#CCCCCC"> in a same fashion the next items</font>

1301
00:43:52,890 --> 00:43:57,960
are more sensor<font color="#E5E5E5"> based or architectural</font>

1302
00:43:55,500 --> 00:43:59,760
<font color="#E5E5E5">based so this approach works really well</font>

1303
00:43:57,960 --> 00:44:01,380
when you have sensors in<font color="#E5E5E5"> line to capture</font>

1304
00:43:59,760 --> 00:44:03,180
traffic<font color="#CCCCCC"> network edge is typically</font>

1305
00:44:01,380 --> 00:44:06,150
covered<font color="#E5E5E5"> fairly well that gets you</font><font color="#CCCCCC"> C to</font>

1306
00:44:03,180 --> 00:44:07,589
downloads uploads etc internal<font color="#CCCCCC"> traffic</font>

1307
00:44:06,150 --> 00:44:09,690
less so and we've talked about<font color="#CCCCCC"> some</font>

1308
00:44:07,590 --> 00:44:12,000
<font color="#CCCCCC">examples where it'd be really</font><font color="#E5E5E5"> useful</font><font color="#CCCCCC"> to</font>

1309
00:44:09,690 --> 00:44:14,100
sort<font color="#E5E5E5"> of see that SMB traffic moving back</font>

1310
00:44:12,000 --> 00:44:15,960
and<font color="#E5E5E5"> forth is a way of carving files as</font>

1311
00:44:14,100 --> 00:44:18,330
<font color="#E5E5E5">they're move through like you know</font><font color="#CCCCCC"> see</font>

1312
00:44:15,960 --> 00:44:20,100
<font color="#CCCCCC">dollars share etc so what do</font><font color="#E5E5E5"> we need to</font>

1313
00:44:18,330 --> 00:44:21,569
do there<font color="#E5E5E5"> we'll try to create</font><font color="#CCCCCC"> more</font>

1314
00:44:20,100 --> 00:44:23,250
<font color="#CCCCCC">chokepoints in the</font><font color="#E5E5E5"> network so</font><font color="#CCCCCC"> that</font>

1315
00:44:21,570 --> 00:44:25,140
you're<font color="#CCCCCC"> enabling more of this monitoring</font>

1316
00:44:23,250 --> 00:44:27,300
<font color="#E5E5E5">that's why the ICS network was a nice</font>

1317
00:44:25,140 --> 00:44:28,859
place<font color="#CCCCCC"> to start for</font><font color="#E5E5E5"> this idea because you</font>

1318
00:44:27,300 --> 00:44:30,810
have a lot<font color="#CCCCCC"> of natural choke points or</font>

1319
00:44:28,860 --> 00:44:32,250
you<font color="#E5E5E5"> should you didn't in crash overrides</font>

1320
00:44:30,810 --> 00:44:34,440
case as far<font color="#CCCCCC"> as I can tell thanks to</font>

1321
00:44:32,250 --> 00:44:36,570
those sequel servers or<font color="#CCCCCC"> MS sequel</font>

1322
00:44:34,440 --> 00:44:39,390
servers but<font color="#E5E5E5"> you know typically</font><font color="#CCCCCC"> you have</font>

1323
00:44:36,570 --> 00:44:40,500
<font color="#E5E5E5">just by virtue of functionality the</font>

1324
00:44:39,390 --> 00:44:42,240
network<font color="#E5E5E5"> has carved up into</font><font color="#CCCCCC"> different</font>

1325
00:44:40,500 --> 00:44:43,950
enclaves and<font color="#E5E5E5"> you have</font><font color="#CCCCCC"> different network</font>

1326
00:44:42,240 --> 00:44:45,330
appliances that<font color="#E5E5E5"> are physically</font>

1327
00:44:43,950 --> 00:44:47,339
segmenting those so lots of different

1328
00:44:45,330 --> 00:44:49,830
<font color="#CCCCCC">points</font><font color="#E5E5E5"> where you</font><font color="#CCCCCC"> can capture traffic in</font>

1329
00:44:47,340 --> 00:44:51,750
<font color="#CCCCCC">your Windows domain you might not you</font>

1330
00:44:49,830 --> 00:44:54,060
<font color="#E5E5E5">might have a very flat network we all</font>

1331
00:44:51,750 --> 00:44:55,560
know<font color="#E5E5E5"> that flat networks are bad we also</font>

1332
00:44:54,060 --> 00:44:57,360
all know<font color="#E5E5E5"> that flat networks are more</font>

1333
00:44:55,560 --> 00:44:59,009
common than we'd like to<font color="#E5E5E5"> admit so you</font>

1334
00:44:57,360 --> 00:45:01,830
could either fix sets or coverage issues

1335
00:44:59,010 --> 00:45:03,720
in order<font color="#CCCCCC"> to you know try and</font><font color="#E5E5E5"> put more</font>

1336
00:45:01,830 --> 00:45:04,520
things in line to detect these sorts of

1337
00:45:03,720 --> 00:45:06,319
things

1338
00:45:04,520 --> 00:45:08,210
or you could look at you know deploying

1339
00:45:06,320 --> 00:45:08,990
VLANs is a virtual option in<font color="#CCCCCC"> order</font><font color="#E5E5E5"> to</font>

1340
00:45:08,210 --> 00:45:10,490
make this<font color="#E5E5E5"> work</font>

1341
00:45:08,990 --> 00:45:11,959
ultimately this<font color="#E5E5E5"> is sort of an</font>

1342
00:45:10,490 --> 00:45:13,310
architectural item so it's hard to

1343
00:45:11,960 --> 00:45:15,050
implement<font color="#CCCCCC"> it's kind of</font><font color="#E5E5E5"> a pain in</font><font color="#CCCCCC"> the ass</font>

1344
00:45:13,310 --> 00:45:16,640
but it's<font color="#E5E5E5"> something that at least needs</font>

1345
00:45:15,050 --> 00:45:18,170
to be discussed in<font color="#E5E5E5"> order to make such an</font>

1346
00:45:16,640 --> 00:45:19,819
approach worthwhile but if you do<font color="#E5E5E5"> this</font>

1347
00:45:18,170 --> 00:45:23,150
you know not only is<font color="#E5E5E5"> something like what</font>

1348
00:45:19,820 --> 00:45:25,160
I've discussed today<font color="#E5E5E5"> applicable but you</font>

1349
00:45:23,150 --> 00:45:27,710
get better<font color="#E5E5E5"> visibility into things like</font>

1350
00:45:25,160 --> 00:45:29,750
lateral movement and other items<font color="#CCCCCC"> once</font>

1351
00:45:27,710 --> 00:45:30,950
the crunchy outer shell<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the network</font>

1352
00:45:29,750 --> 00:45:34,369
has been<font color="#E5E5E5"> pierced then you're into the</font>

1353
00:45:30,950 --> 00:45:35,660
gooey chocolaty<font color="#E5E5E5"> Center</font><font color="#CCCCCC"> the last thing is</font>

1354
00:45:34,369 --> 00:45:37,520
and I've gotten<font color="#E5E5E5"> this sort of</font><font color="#CCCCCC"> feedback</font>

1355
00:45:35,660 --> 00:45:39,529
before<font color="#E5E5E5"> is like</font><font color="#CCCCCC"> oh this is all well and</font>

1356
00:45:37,520 --> 00:45:41,060
good but<font color="#E5E5E5"> this is reactive only you</font>

1357
00:45:39,530 --> 00:45:42,320
haven't<font color="#E5E5E5"> stopped anything here you're</font>

1358
00:45:41,060 --> 00:45:44,509
<font color="#CCCCCC">just detecting</font><font color="#E5E5E5"> that bad things have</font>

1359
00:45:42,320 --> 00:45:47,540
happened<font color="#CCCCCC"> the damage is already done or</font>

1360
00:45:44,510 --> 00:45:49,640
in the progress<font color="#E5E5E5"> of being executed</font><font color="#CCCCCC"> yeah</font>

1361
00:45:47,540 --> 00:45:51,380
that's true<font color="#E5E5E5"> but</font><font color="#CCCCCC"> you know</font><font color="#E5E5E5"> what you might</font>

1362
00:45:49,640 --> 00:45:53,868
be reacting but I will tell<font color="#E5E5E5"> you</font><font color="#CCCCCC"> this if</font>

1363
00:45:51,380 --> 00:45:56,330
you're doing<font color="#CCCCCC"> this sort of approach</font>

1364
00:45:53,869 --> 00:45:58,340
<font color="#E5E5E5">you're detecting things a</font><font color="#CCCCCC"> little earlier</font>

1365
00:45:56,330 --> 00:46:00,020
<font color="#E5E5E5">than you did before</font><font color="#CCCCCC"> that might</font><font color="#E5E5E5"> not seem</font>

1366
00:45:58,340 --> 00:46:02,810
like<font color="#CCCCCC"> much</font><font color="#E5E5E5"> but I bet you for the guys who</font>

1367
00:46:00,020 --> 00:46:04,910
were working<font color="#CCCCCC"> at the distribution station</font>

1368
00:46:02,810 --> 00:46:06,860
in Ukraine back in 2016<font color="#E5E5E5"> they would have</font>

1369
00:46:04,910 --> 00:46:08,029
loved<font color="#E5E5E5"> to have</font><font color="#CCCCCC"> seen this</font><font color="#E5E5E5"> a couple of</font>

1370
00:46:06,860 --> 00:46:09,830
weeks before<font color="#E5E5E5"> the lights went</font><font color="#CCCCCC"> out and</font>

1371
00:46:08,030 --> 00:46:12,530
prevented that from happening<font color="#CCCCCC"> or start</font>

1372
00:46:09,830 --> 00:46:13,759
responding<font color="#CCCCCC"> then even</font><font color="#E5E5E5"> more so</font><font color="#CCCCCC"> for the</font><font color="#E5E5E5"> Tri</font>

1373
00:46:12,530 --> 00:46:15,920
<font color="#CCCCCC">Comics event where you had something</font>

1374
00:46:13,760 --> 00:46:18,470
<font color="#E5E5E5">that</font><font color="#CCCCCC"> could presumably</font><font color="#E5E5E5"> have led to loss</font>

1375
00:46:15,920 --> 00:46:20,600
of life or<font color="#E5E5E5"> loss of equipment so the goal</font>

1376
00:46:18,470 --> 00:46:22,700
here<font color="#CCCCCC"> isn't to stop</font><font color="#E5E5E5"> because at the end</font><font color="#CCCCCC"> of</font>

1377
00:46:20,600 --> 00:46:25,040
the day we can't stop all these attacks

1378
00:46:22,700 --> 00:46:26,569
<font color="#E5E5E5">the goal is just to get faster picking</font>

1379
00:46:25,040 --> 00:46:28,700
off<font color="#E5E5E5"> in network traffic means that we can</font>

1380
00:46:26,570 --> 00:46:29,119
hopefully<font color="#E5E5E5"> identify badness before it</font>

1381
00:46:28,700 --> 00:46:31,580
spreads

1382
00:46:29,119 --> 00:46:32,990
<font color="#CCCCCC">into poor</font><font color="#E5E5E5"> coverage areas or poor</font>

1383
00:46:31,580 --> 00:46:36,920
recovery areas where we're really

1384
00:46:32,990 --> 00:46:38,419
screwed when bad<font color="#CCCCCC"> things do happen</font><font color="#E5E5E5"> so</font>

1385
00:46:36,920 --> 00:46:39,770
lastly<font color="#E5E5E5"> before we get into some</font>

1386
00:46:38,420 --> 00:46:41,660
concluding thoughts<font color="#E5E5E5"> you</font><font color="#CCCCCC"> know you talked</font>

1387
00:46:39,770 --> 00:46:43,220
a lot about industrial control systems<font color="#E5E5E5"> I</font>

1388
00:46:41,660 --> 00:46:44,629
don't work in<font color="#CCCCCC"> industrial control systems</font>

1389
00:46:43,220 --> 00:46:45,980
how is this<font color="#E5E5E5"> helpful for me well I'm</font>

1390
00:46:44,630 --> 00:46:47,420
talking<font color="#E5E5E5"> about ICS because that's what I</font>

1391
00:46:45,980 --> 00:46:49,760
do<font color="#E5E5E5"> though you know we got that all right</font>

1392
00:46:47,420 --> 00:46:51,980
<font color="#E5E5E5">over but a lot of</font><font color="#CCCCCC"> these approaches can</font>

1393
00:46:49,760 --> 00:46:54,410
<font color="#E5E5E5">apply to your</font><font color="#CCCCCC"> own networks whether you</font>

1394
00:46:51,980 --> 00:46:56,630
have sensitive enclaves such as you<font color="#E5E5E5"> know</font>

1395
00:46:54,410 --> 00:46:58,879
here are<font color="#CCCCCC"> the keys to the</font><font color="#E5E5E5"> kingdom the</font>

1396
00:46:56,630 --> 00:47:00,800
<font color="#CCCCCC">holy grail so to speak</font><font color="#E5E5E5"> containing all</font>

1397
00:46:58,880 --> 00:47:03,320
<font color="#CCCCCC">the customer</font><font color="#E5E5E5"> credit card numbers or</font>

1398
00:47:00,800 --> 00:47:06,470
critical institutional intellectual

1399
00:47:03,320 --> 00:47:08,090
property etc<font color="#CCCCCC"> it's like you can put a you</font>

1400
00:47:06,470 --> 00:47:10,459
know<font color="#E5E5E5"> network choke point leading</font><font color="#CCCCCC"> up to</font>

1401
00:47:08,090 --> 00:47:12,770
<font color="#E5E5E5">those scan for traffic there and apply</font><font color="#CCCCCC"> a</font>

1402
00:47:10,460 --> 00:47:14,750
methodology such as this<font color="#E5E5E5"> to gain an</font>

1403
00:47:12,770 --> 00:47:16,660
additional<font color="#E5E5E5"> layer of</font><font color="#CCCCCC"> Defense as a result</font>

1404
00:47:14,750 --> 00:47:18,770
so this<font color="#CCCCCC"> idea might not be</font>

1405
00:47:16,660 --> 00:47:20,720
applicable completely to your

1406
00:47:18,770 --> 00:47:22,100
<font color="#CCCCCC">environment</font><font color="#E5E5E5"> but aspects of it can be</font>

1407
00:47:20,720 --> 00:47:24,200
<font color="#CCCCCC">especially</font><font color="#E5E5E5"> when you start talking</font><font color="#CCCCCC"> about</font>

1408
00:47:22,100 --> 00:47:28,880
critical<font color="#CCCCCC"> network areas</font><font color="#E5E5E5"> that you want to</font>

1409
00:47:24,200 --> 00:47:32,810
make sure<font color="#E5E5E5"> are especially protected so</font><font color="#CCCCCC"> to</font>

1410
00:47:28,880 --> 00:47:33,920
<font color="#E5E5E5">close let's not let the perfect be the</font>

1411
00:47:32,810 --> 00:47:37,009
enemy<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> good</font>

1412
00:47:33,920 --> 00:47:38,810
to paraphrase Voltaire<font color="#E5E5E5"> so</font><font color="#CCCCCC"> imperfect</font>

1413
00:47:37,010 --> 00:47:40,280
situations require<font color="#CCCCCC"> solutions of some</font>

1414
00:47:38,810 --> 00:47:41,810
<font color="#E5E5E5">sorts but we can never expect</font><font color="#CCCCCC"> that the</font>

1415
00:47:40,280 --> 00:47:44,300
problem is going<font color="#E5E5E5"> to completely be erased</font>

1416
00:47:41,810 --> 00:47:45,830
<font color="#E5E5E5">instead of crying that</font><font color="#CCCCCC"> we this is an in</font>

1417
00:47:44,300 --> 00:47:47,810
solvable problem or<font color="#E5E5E5"> something that can</font>

1418
00:47:45,830 --> 00:47:49,580
never<font color="#E5E5E5"> be completely addressed let's</font>

1419
00:47:47,810 --> 00:47:51,529
instead look<font color="#CCCCCC"> at</font><font color="#E5E5E5"> what we've got to hand</font>

1420
00:47:49,580 --> 00:47:53,600
right now<font color="#E5E5E5"> and see how</font><font color="#CCCCCC"> it can make the</font>

1421
00:47:51,530 --> 00:47:55,700
situation better<font color="#CCCCCC"> in this case</font>

1422
00:47:53,600 --> 00:47:57,770
identifying activity activity malicious

1423
00:47:55,700 --> 00:47:59,839
activity earlier in the attack<font color="#E5E5E5"> chains</font>

1424
00:47:57,770 --> 00:48:01,970
that we can<font color="#CCCCCC"> you know decrease our time</font>

1425
00:47:59,840 --> 00:48:03,680
to response<font color="#E5E5E5"> and improve our ability to</font>

1426
00:48:01,970 --> 00:48:05,390
remediate incidents<font color="#E5E5E5"> as they're</font>

1427
00:48:03,680 --> 00:48:08,350
developing as opposed to reacting after

1428
00:48:05,390 --> 00:48:10,549
<font color="#E5E5E5">the malicious impact has</font><font color="#CCCCCC"> been you know</font>

1429
00:48:08,350 --> 00:48:12,470
actualized and<font color="#E5E5E5"> we're you know</font><font color="#CCCCCC"> putting</font>

1430
00:48:10,550 --> 00:48:14,690
out fires at that point<font color="#E5E5E5"> so ultimately</font>

1431
00:48:12,470 --> 00:48:17,149
what this approach<font color="#E5E5E5"> really is based off</font>

1432
00:48:14,690 --> 00:48:19,250
of<font color="#E5E5E5"> is you know one thing</font><font color="#CCCCCC"> that I like to</font>

1433
00:48:17,150 --> 00:48:21,830
<font color="#CCCCCC">close with is that there's this common</font>

1434
00:48:19,250 --> 00:48:23,270
misconception that<font color="#CCCCCC"> oh the attacker only</font>

1435
00:48:21,830 --> 00:48:24,470
has to get things right<font color="#E5E5E5"> once the</font>

1436
00:48:23,270 --> 00:48:27,530
defender has<font color="#CCCCCC"> to get things right</font><font color="#E5E5E5"> every</font>

1437
00:48:24,470 --> 00:48:29,868
<font color="#CCCCCC">time</font><font color="#E5E5E5"> that is excuse my language</font>

1438
00:48:27,530 --> 00:48:31,460
instead the complete opposite holds<font color="#E5E5E5"> true</font>

1439
00:48:29,869 --> 00:48:33,980
because the<font color="#CCCCCC"> adversary has to get it</font>

1440
00:48:31,460 --> 00:48:35,570
right every<font color="#CCCCCC"> step of the way and we as</font>

1441
00:48:33,980 --> 00:48:37,730
defenders since we're in the defensive

1442
00:48:35,570 --> 00:48:39,890
track here<font color="#CCCCCC"> really only need</font><font color="#E5E5E5"> to catch</font>

1443
00:48:37,730 --> 00:48:41,270
<font color="#E5E5E5">them once the adversary needs to get</font>

1444
00:48:39,890 --> 00:48:43,910
<font color="#E5E5E5">into the network</font><font color="#CCCCCC"> he needs to establish</font>

1445
00:48:41,270 --> 00:48:46,700
persistence<font color="#E5E5E5"> as</font><font color="#CCCCCC"> a survey and identify the</font>

1446
00:48:43,910 --> 00:48:48,710
network objective deliver some sort<font color="#CCCCCC"> of</font>

1447
00:48:46,700 --> 00:48:50,629
effect<font color="#E5E5E5"> and then complete it</font><font color="#CCCCCC"> that's a lot</font>

1448
00:48:48,710 --> 00:48:53,000
of<font color="#E5E5E5"> things to get right and a lot of</font>

1449
00:48:50,630 --> 00:48:55,400
<font color="#E5E5E5">different</font><font color="#CCCCCC"> places</font><font color="#E5E5E5"> that we</font><font color="#CCCCCC"> as network</font>

1450
00:48:53,000 --> 00:48:57,650
defenders can<font color="#E5E5E5"> stop them or the very</font>

1451
00:48:55,400 --> 00:48:59,240
least detect them by<font color="#E5E5E5"> applying approaches</font>

1452
00:48:57,650 --> 00:49:00,680
like this that look for<font color="#E5E5E5"> those areas of</font>

1453
00:48:59,240 --> 00:49:02,839
visibility where we have better control

1454
00:49:00,680 --> 00:49:06,319
<font color="#CCCCCC">we can work on</font><font color="#E5E5E5"> this model</font><font color="#CCCCCC"> and</font>

1455
00:49:02,840 --> 00:49:08,000
disadvantage the adversary so that's all

1456
00:49:06,320 --> 00:49:09,410
I've<font color="#CCCCCC"> got I think I've got</font>

1457
00:49:08,000 --> 00:49:12,280
I've got lots of<font color="#E5E5E5"> time</font><font color="#CCCCCC"> for questions and</font>

1458
00:49:09,410 --> 00:49:12,279
<font color="#E5E5E5">most my</font><font color="#CCCCCC"> watches stopped</font>

1459
00:49:13,000 --> 00:49:20,579
[Applause]

