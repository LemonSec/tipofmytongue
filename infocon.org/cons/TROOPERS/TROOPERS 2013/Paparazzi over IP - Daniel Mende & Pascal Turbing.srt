1
00:00:04,160 --> 00:00:11,050
up a lower-body car

2
00:00:11,050 --> 00:00:15,100
want one thing set first a within
minutes to turn this camera into a

3
00:00:15,100 --> 00:00:15,910
rocket launcher

4
00:00:15,910 --> 00:00:19,910
we tried calling you but the and and
than 50 well

5
00:00:19,910 --> 00:00:23,430
okay so um hello

6
00:00:23,430 --> 00:00:26,860
to the first talk today I'll

7
00:00:26,860 --> 00:00:30,540
like michael says it's all about come
across I'm packing stuff

8
00:00:30,540 --> 00:00:34,800
so we're both from here in W on the side

9
00:00:34,800 --> 00:00:39,200
this nothing you I'll so let's take a
look at the good

10
00:00:39,200 --> 00:00:42,260
to we will first ever saw the
introduction

11
00:00:42,260 --> 00:00:46,680
what is this talk all about what's this
%uh may be interesting to

12
00:00:46,680 --> 00:00:51,739
to a camera all such a thing then

13
00:00:51,739 --> 00:00:55,910
obviously this camera has something to
do with IPS a talk titled sets

14
00:00:55,910 --> 00:01:00,250
so we have a look at the rear transport
protocols that are in use

15
00:01:00,250 --> 00:01:05,010
we also had a look at the different
communication mode this camera uses

16
00:01:05,010 --> 00:01:08,220
and we figured out some

17
00:01:08,220 --> 00:01:11,400
attacks against this camera arm

18
00:01:11,400 --> 00:01:14,480
and yet there will be a few conclusions
I'll

19
00:01:14,480 --> 00:01:18,250
fault will come to this later okay

20
00:01:18,250 --> 00:01:21,810
so arm first of all what this is about
and

21
00:01:21,810 --> 00:01:25,520
the last one or two years there are

22
00:01:25,520 --> 00:01:30,080
a lot of cameras dropping into the
market which came with which come with

23
00:01:30,080 --> 00:01:33,620
some my IP connectivity all some network
connectivity

24
00:01:33,620 --> 00:01:36,760
a just to make the thing fans here to
make it

25
00:01:36,760 --> 00:01:40,560
more usable to look at the photograph
like up

26
00:01:40,560 --> 00:01:45,160
the chance to upload pictures in into
the clouds on the fly on

27
00:01:45,160 --> 00:01:49,690
all that fancy stuff arm also

28
00:01:49,690 --> 00:01:52,920
this opens up new attack house and

29
00:01:52,920 --> 00:01:56,020
potential security risks um

30
00:01:56,020 --> 00:02:00,600
we have focus on this device in front
this is the ER

31
00:02:00,600 --> 00:02:04,400
you swung the axe which is the latest
biggest rate this

32
00:02:04,400 --> 00:02:07,970
camera are from Canton so

33
00:02:07,970 --> 00:02:12,620
this has all the the connectivity itself
up and by the way takes great pictures

34
00:02:12,620 --> 00:02:16,140
so but the camera

35
00:02:16,140 --> 00:02:20,130
up up nearly the same size

36
00:02:20,130 --> 00:02:25,900
saw arm I got a bit of marketing here
this is directly from the

37
00:02:25,900 --> 00:02:28,940
Canon USA website at South

38
00:02:28,940 --> 00:02:34,010
okay um it has a built-in Ethernet port
and it allows fast and easy transfer

39
00:02:34,010 --> 00:02:37,290
%uh from the client life events directly
to

40
00:02:37,290 --> 00:02:41,130
the network or a PC absence good

41
00:02:41,130 --> 00:02:44,319
I'll also there is some

42
00:02:44,319 --> 00:02:47,840
wireless file transmitter which is up to
No

43
00:02:47,840 --> 00:02:51,410
to the camera um so it also can do wifi

44
00:02:51,410 --> 00:02:55,830
missus yup pretty cool if you want to
use the stuff for

45
00:02:55,830 --> 00:02:59,069
like I said transferring images or

46
00:02:59,069 --> 00:03:03,410
other things but also it means the
camera doesn't

47
00:03:03,410 --> 00:03:06,620
you need to be attached to network like
physically attached

48
00:03:06,620 --> 00:03:13,330
to get into our attacks okay so here's a
screenshot way see the

49
00:03:13,330 --> 00:03:17,000
is an import on one side of the camera
and

50
00:03:17,000 --> 00:03:20,230
also this little great thing on the site

51
00:03:20,230 --> 00:03:25,720
is like the the WiFi module okay

52
00:03:25,720 --> 00:03:29,030
um so who is the potential target of our
attacks

53
00:03:29,030 --> 00:03:32,400
yeah it could be remiss to Reuters or

54
00:03:32,400 --> 00:03:37,980
room some people working for him and
they usually wear this kind of equipment

55
00:03:37,980 --> 00:03:41,040
with like the rocket launcher lenses in
front of the

56
00:03:41,040 --> 00:03:44,530
and a those kind of people

57
00:03:44,530 --> 00:03:47,620
tried to I'll set up and passos

58
00:03:47,620 --> 00:03:50,930
I'm wait for other people's so

59
00:03:50,930 --> 00:03:55,330
yet both those are pretty much the
targets arm

60
00:03:55,330 --> 00:03:58,620
so what if one evolve

61
00:03:58,620 --> 00:04:01,900
kind of guy could get the real on it it

62
00:04:01,900 --> 00:04:06,470
images first directly from the camera
before they go through some

63
00:04:06,470 --> 00:04:10,090
censorship of stuff like that all

64
00:04:10,090 --> 00:04:13,720
what if one could upload but ima just a
camera

65
00:04:13,720 --> 00:04:17,039
and after the event just point out the
cameraman and so

66
00:04:17,039 --> 00:04:20,729
oh you up I think you know some quite
interesting photos on this camera

67
00:04:20,729 --> 00:04:24,919
%uh you should take a look at the cover
um

68
00:04:24,919 --> 00:04:28,870
also what if one could turn the camera
into the surveillance device

69
00:04:28,870 --> 00:04:32,090
cuz yeah this camera obviously it could
take

70
00:04:32,090 --> 00:04:35,960
in Texas %uh pictures on so but

71
00:04:35,960 --> 00:04:41,779
what if the camera to take pictures when
you don't expect okay we will come back

72
00:04:41,779 --> 00:04:43,379
to all those questions later

73
00:04:43,379 --> 00:04:46,719
and seeing or we can also

74
00:04:46,719 --> 00:04:50,830
okay so so much to the

75
00:04:50,830 --> 00:04:54,099
introduction so it's pretty much all
about the camera and its network

76
00:04:54,099 --> 00:04:55,129
connectivity

77
00:04:55,129 --> 00:04:59,219
features but also about kind of new

78
00:04:59,219 --> 00:05:03,050
attack of are like up

79
00:05:03,050 --> 00:05:10,050
your all the good stuff's coming back
okay so I love when we start no research

80
00:05:10,789 --> 00:05:14,870
the first thing was like to get hands on
one of those cameras

81
00:05:14,870 --> 00:05:18,229
but wasn't that he's in the first place
up

82
00:05:18,229 --> 00:05:22,710
after quite some convincing up we
managed to get one

83
00:05:22,710 --> 00:05:26,389
so we played around with the network
connectivity

84
00:05:26,389 --> 00:05:29,969
and we started at the lower level so we

85
00:05:29,969 --> 00:05:34,520
first a look at the underlying protocols
which in this case

86
00:05:34,520 --> 00:05:37,749
obviously is if another as a different
port

87
00:05:37,749 --> 00:05:41,009
but give also Wireless lan:

88
00:05:41,009 --> 00:05:44,580
wire--the while the songs

89
00:05:44,580 --> 00:05:49,139
arm over or this face layouts or
protocols

90
00:05:49,139 --> 00:05:52,509
on the cameras FaceTime speaks than a to
Skype you

91
00:05:52,509 --> 00:05:56,009
it doesn't implement ipv6 yet

92
00:05:56,009 --> 00:05:59,599
so your everybody's using a few for

93
00:05:59,599 --> 00:06:03,249
of course so you don't need ipv6

94
00:06:03,249 --> 00:06:08,199
as a like that I think can I think so

95
00:06:08,199 --> 00:06:11,639
okay so we're at a look at the
traditional attacks

96
00:06:11,639 --> 00:06:15,159
we also started on a layer 2 and we
figured out so

97
00:06:15,159 --> 00:06:18,969
ops moving on the cameras isn't it
rubles so it s

98
00:06:18,969 --> 00:06:22,559
nothing like sticky up and freeze or arm

99
00:06:22,559 --> 00:06:26,419
something like that also if you just
float the camera will

100
00:06:26,419 --> 00:06:29,909
love of I could just like around 100
packets

101
00:06:29,909 --> 00:06:33,229
seconds but still not done much but its

102
00:06:33,229 --> 00:06:37,259
enough to just do not have service so
that works like if the car

103
00:06:37,259 --> 00:06:41,249
I'll obviously it's built for taking
pictures and not

104
00:06:41,249 --> 00:06:45,580
for withstanding if attacks

105
00:06:45,580 --> 00:06:48,729
so arm I was nothing surprising

106
00:06:48,729 --> 00:06:52,830
so nothing new here on it's just good to
know that these attacks

107
00:06:52,830 --> 00:06:56,169
still work on that kind of equipment

108
00:06:56,169 --> 00:06:59,610
so we moved up the layer or a bit

109
00:06:59,610 --> 00:07:03,469
so we get to lay a three-layer for which
is standard TCP IP

110
00:07:03,469 --> 00:07:06,699
just and all the scenarios on

111
00:07:06,699 --> 00:07:10,399
we also figure out all we're tester and

112
00:07:10,399 --> 00:07:13,800
its came out that's physically
connections are

113
00:07:13,800 --> 00:07:19,219
easily resolvable why just sending
disappear reset

114
00:07:19,219 --> 00:07:22,509
so also on this layer nothing new but

115
00:07:22,509 --> 00:07:27,800
keep this in mind it will come back
later on

116
00:07:27,800 --> 00:07:31,419
okay so all along for camera

117
00:07:31,419 --> 00:07:35,199
itself got different communication modes

118
00:07:35,199 --> 00:07:38,529
so you have a big man you a lot of

119
00:07:38,529 --> 00:07:41,789
configuration of turns I'm you can

120
00:07:41,789 --> 00:07:46,240
two's between for different called
communication modes

121
00:07:46,240 --> 00:07:50,289
so the first thing is the to have to be
uploaded mod's

122
00:07:50,289 --> 00:07:54,539
business your just playing 2k so the
camera takes a picture

123
00:07:54,539 --> 00:07:57,569
I'm instantly uploads the picture to

124
00:07:57,569 --> 00:08:01,249
on FTP server and network

125
00:08:01,249 --> 00:08:05,429
for second communication mode this deal
and a

126
00:08:05,429 --> 00:08:09,240
which is some kinda a standardized
interface for

127
00:08:09,240 --> 00:08:12,949
I'm consumer media devices to exchange

128
00:08:12,949 --> 00:08:16,469
your consumer media I guess arm

129
00:08:16,469 --> 00:08:19,839
for this camera also features to appear

130
00:08:19,839 --> 00:08:24,639
deal in a I'll like protocol stack

131
00:08:24,639 --> 00:08:29,219
it also got a built-in web server I'm I
was wondering why vote

132
00:08:29,219 --> 00:08:32,330
I think just because it's cool or

133
00:08:32,330 --> 00:08:35,919
because everybody know those needs to
have a built-in web server

134
00:08:35,919 --> 00:08:40,140
and then there is a a proprietary

135
00:08:40,140 --> 00:08:43,829
fall moat which is the so-called use
utility mode

136
00:08:43,829 --> 00:08:46,990
which nitsa proprietary can um

137
00:08:46,990 --> 00:08:53,750
software installed on your PC to you're
like remote control the camera

138
00:08:53,750 --> 00:08:56,899
okay now this is

139
00:08:56,899 --> 00:09:00,209
mania the Sun a for communication modes

140
00:09:00,209 --> 00:09:03,699
up we have a look each of those moats
I'll

141
00:09:03,699 --> 00:09:07,880
we will just go through them of one by
one

142
00:09:07,880 --> 00:09:10,949
okay so let's start off with the f2p

143
00:09:10,949 --> 00:09:14,690
out yes

144
00:09:14,690 --> 00:09:18,819
formals side

145
00:09:18,819 --> 00:09:23,300
all us

146
00:09:23,300 --> 00:09:26,850
fun

147
00:09:26,850 --> 00:09:30,709
yeah so just %uh 20

148
00:09:30,709 --> 00:09:34,100
just me this

149
00:09:34,100 --> 00:09:41,100
well you stuck

150
00:09:44,630 --> 00:09:49,120
in

151
00:09:49,120 --> 00:09:53,509
check check take us

152
00:09:53,509 --> 00:09:56,920
yeah so you can look at the for

153
00:09:56,920 --> 00:10:00,329
at first we had a look at the FTP Upload
mode and

154
00:10:00,329 --> 00:10:03,740
yet just two points above something out
so

155
00:10:03,740 --> 00:10:06,779
how you configure it and home

156
00:10:06,779 --> 00:10:09,990
you have to use a camera so

157
00:10:09,990 --> 00:10:13,379
there are some buttons and the

158
00:10:13,379 --> 00:10:16,470
small joystick in at the back of the
camera

159
00:10:16,470 --> 00:10:20,579
to for all through the menu and so stuff

160
00:10:20,579 --> 00:10:23,660
and yeah obviously you have to provide

161
00:10:23,660 --> 00:10:26,920
a the target server and

162
00:10:26,920 --> 00:10:31,029
looking for dan Schultz a into the menu

163
00:10:31,029 --> 00:10:34,440
so the camera know so which will upload
the pictures

164
00:10:34,440 --> 00:10:37,649
and yeah maybe some

165
00:10:37,649 --> 00:10:41,120
non-technical guy once to

166
00:10:41,120 --> 00:10:45,589
a yet wants to minimize the efforts to

167
00:10:45,589 --> 00:10:49,250
taken the password and and stuff and the

168
00:10:49,250 --> 00:10:53,509
just choose a week 1 to

169
00:10:53,509 --> 00:10:56,730
used less the characters for example

170
00:10:56,730 --> 00:11:01,490
because he's not then to the into the
security

171
00:11:01,490 --> 00:11:04,730
and yeah of course maybe also with the

172
00:11:04,730 --> 00:11:07,750
up as well as for the wifi and

173
00:11:07,750 --> 00:11:11,550
yell in case of the FTP up remote

174
00:11:11,550 --> 00:11:15,180
if it's connect its to the network

175
00:11:15,180 --> 00:11:18,209
and you pull the trigger the

176
00:11:18,209 --> 00:11:22,379
shoulda parts of to the pictures shot it
immediately

177
00:11:22,379 --> 00:11:28,490
tries to upload to picture to the FTP so

178
00:11:28,490 --> 00:11:32,370
and your you don't sites

179
00:11:32,370 --> 00:11:36,389
of FTP of you might know

180
00:11:36,389 --> 00:11:40,019
STP is playing to text no

181
00:11:40,019 --> 00:11:45,730
crypto at all yes along although also
nothing new here but we're just

182
00:11:45,730 --> 00:11:50,810
went through all the different
communication notes

183
00:11:50,810 --> 00:11:54,790
yet and because of that once you are

184
00:11:54,790 --> 00:11:58,860
in a man in the middle position or else
we call it in this talk

185
00:11:58,860 --> 00:12:01,990
men in the image below um

186
00:12:01,990 --> 00:12:05,730
you are easily the able to

187
00:12:05,730 --> 00:12:10,449
sniff credentials because this
transmitted in plain text

188
00:12:10,449 --> 00:12:14,259
just said look at you have a look at you
Wireshark

189
00:12:14,259 --> 00:12:17,329
and also

190
00:12:17,329 --> 00:12:22,470
you are able to the sniff all of the
data transmitted

191
00:12:22,470 --> 00:12:25,519
so you can also easily expect

192
00:12:25,519 --> 00:12:29,529
every picture the camera close to the
FTP server

193
00:12:29,529 --> 00:12:33,850
and you may be able to um upload your
own pictures

194
00:12:33,850 --> 00:12:37,579
to the FTP server of the photographer

195
00:12:37,579 --> 00:12:40,610
or the contractor of 24 paparazzi

196
00:12:40,610 --> 00:12:44,550
or yet the FTP server

197
00:12:44,550 --> 00:12:48,639
of another attack a I have no idea

198
00:12:48,639 --> 00:12:52,029
and yeah

199
00:12:52,029 --> 00:12:55,110
as it's easy to the

200
00:12:55,110 --> 00:12:59,699
spot the credentials in a way short term
for example

201
00:12:59,699 --> 00:13:03,800
we r I just want to show how you how
easy this

202
00:13:03,800 --> 00:13:06,939
to restrict the pictures because

203
00:13:06,939 --> 00:13:11,040
from some few might not know how to
extract

204
00:13:11,040 --> 00:13:15,829
pictures from without Wireshark with
right click or something

205
00:13:15,829 --> 00:13:18,959
boats you just used to you

206
00:13:18,959 --> 00:13:22,060
or shell so hero two screenshots

207
00:13:22,060 --> 00:13:25,629
one on this in 10 of the the next slide

208
00:13:25,629 --> 00:13:30,910
so we have our um

209
00:13:30,910 --> 00:13:35,449
host misstep packages in this trace file

210
00:13:35,449 --> 00:13:38,769
and just use TCP flow TCP flow is

211
00:13:38,769 --> 00:13:41,810
them a tool to extract

212
00:13:41,810 --> 00:13:45,040
every TCP stream out of work capture

213
00:13:45,040 --> 00:13:49,379
and you sick leave TCP flow stores them

214
00:13:49,379 --> 00:13:52,579
and separate files so

215
00:13:52,579 --> 00:13:57,230
every one of these files this a known
TCP flow for example every

216
00:13:57,230 --> 00:14:01,089
ftp command sent to the server the login

217
00:14:01,089 --> 00:14:05,680
already put come on for every image

218
00:14:05,680 --> 00:14:08,870
then we just use

219
00:14:08,870 --> 00:14:12,259
foremost which is in recovery tool

220
00:14:12,259 --> 00:14:16,749
full forensics or recovering Daytona
corrupt its

221
00:14:16,749 --> 00:14:20,139
from I'll try for stick

222
00:14:20,139 --> 00:14:24,569
from frightful something and we just
provide

223
00:14:24,569 --> 00:14:28,379
every the every of these files

224
00:14:28,379 --> 00:14:33,199
um extracted by TCP flow

225
00:14:33,199 --> 00:14:36,740
and what for most us is it creates these

226
00:14:36,740 --> 00:14:41,430
open folder in your working directory

227
00:14:41,430 --> 00:14:44,870
and stores lock files what he was able
to

228
00:14:44,870 --> 00:14:48,569
extracts and also

229
00:14:48,569 --> 00:14:52,180
all the the files he was able to extract

230
00:14:52,180 --> 00:14:56,540
in the typical flexible

231
00:14:56,540 --> 00:15:01,740
and all of these pictures from was taken
by the by the camera

232
00:15:01,740 --> 00:15:05,129
and uploaded to FTP to the FTP server
and

233
00:15:05,129 --> 00:15:08,550
all of these pictures can be expected

234
00:15:08,550 --> 00:15:13,300
from no just with to a command-line
tools on

235
00:15:13,300 --> 00:15:16,819
standards the Linux system

236
00:15:16,819 --> 00:15:20,319
though there is one downside for example
if you have

237
00:15:20,319 --> 00:15:25,279
some pickles any FTP connection there
might be some

238
00:15:25,279 --> 00:15:28,959
yeah some shifts in the picture

239
00:15:28,959 --> 00:15:33,529
the to to spot %uh and book they might
be easier for you

240
00:15:33,529 --> 00:15:38,449
easily recoverable were I think also
retransmission parts of the image

241
00:15:38,449 --> 00:15:43,110
yeah me but that was the case by

242
00:15:43,110 --> 00:15:47,629
and in one of peace 14 images

243
00:15:47,629 --> 00:15:51,870
so yeah thus basically it's

244
00:15:51,870 --> 00:15:56,939
on the FTP site

245
00:15:56,939 --> 00:16:00,230
and we want to mix with the on a moat

246
00:16:00,230 --> 00:16:05,819
RK so all the second moats so-called
communication mode of this camera

247
00:16:05,819 --> 00:16:11,519
yes the deal than a Moz yeah we are
certified we've got a nice logo here

248
00:16:11,519 --> 00:16:16,759
up we speak didn't deal on a swell so
but what is it about the other it stands

249
00:16:16,759 --> 00:16:18,120
for digital

250
00:16:18,120 --> 00:16:21,790
Living Network Alliance register

251
00:16:21,790 --> 00:16:25,290
I and is like to own

252
00:16:25,290 --> 00:16:29,790
and mixture of protocols and file
formats

253
00:16:29,790 --> 00:16:32,809
um which are used to transfer

254
00:16:32,809 --> 00:16:37,269
media between different media devices as
I said it's small for the a consumer

255
00:16:37,269 --> 00:16:38,379
device those

256
00:16:38,379 --> 00:16:43,519
like you maybe a year to be at home
speak stealing a so it has a network

257
00:16:43,519 --> 00:16:47,879
connect to an or once it's connected to
the network and the cameras connected to

258
00:16:47,879 --> 00:16:48,800
the network

259
00:16:48,800 --> 00:16:51,860
they both just on send out

260
00:16:51,860 --> 00:16:56,610
UPnP packages to the local network and
discover each other and then figure out

261
00:16:56,610 --> 00:17:01,379
oh yeah the camera got some pictures
over there I'm able to display pictures

262
00:17:01,379 --> 00:17:03,069
maybe use a want to

263
00:17:03,069 --> 00:17:06,959
%uh see the pictures on the camera on so
on and so on

264
00:17:06,959 --> 00:17:10,150
and in this whole process they mainly

265
00:17:10,150 --> 00:17:13,790
use a like I said UPnP for discovery

266
00:17:13,790 --> 00:17:17,030
so to find other devices also capable of

267
00:17:17,030 --> 00:17:21,290
given day and once they found those
devices

268
00:17:21,290 --> 00:17:24,740
values just plane HTTP and

269
00:17:24,740 --> 00:17:28,110
a XML to excess the media

270
00:17:28,110 --> 00:17:32,850
so there are some XML file its on the
camera which can be

271
00:17:32,850 --> 00:17:36,560
just download it which describe liked it
I'll

272
00:17:36,560 --> 00:17:41,150
directory structure or all the images
inside of the cover of

273
00:17:41,150 --> 00:17:46,570
and also they contain links to actual
media files

274
00:17:46,570 --> 00:17:49,840
so arm the downside of the land a

275
00:17:49,840 --> 00:17:54,160
is okay there s no authentication at all

276
00:17:54,160 --> 00:17:59,400
so if you see a deal on a speaker in the
network's second just access it

277
00:17:59,400 --> 00:18:03,270
0 also

278
00:18:03,270 --> 00:18:06,280
there are no restrictions that of

279
00:18:06,280 --> 00:18:10,600
so defined discoverer of on the network
in a deal on a moat

280
00:18:10,600 --> 00:18:14,540
I can access all the image to start to
become

281
00:18:14,540 --> 00:18:18,960
I can access all movies on the camera
and

282
00:18:18,960 --> 00:18:22,750
also yeah I can

283
00:18:22,750 --> 00:18:26,060
download all the images can enumerate
them

284
00:18:26,060 --> 00:18:29,560
and just crap about of the camera

285
00:18:29,560 --> 00:18:33,120
um also idoney any tool for this

286
00:18:33,120 --> 00:18:36,130
because my browser could didn't
eliminate client

287
00:18:36,130 --> 00:18:40,240
a set then use mainly HTTP as a transfer
protocol

288
00:18:40,240 --> 00:18:43,240
and a XOM out to describe their

289
00:18:43,240 --> 00:18:46,660
structures so yeah I could also be
Indialantic

290
00:18:46,660 --> 00:18:49,760
clients just browsing to the camera

291
00:18:49,760 --> 00:18:54,260
arm so dealer named this plain and
simple

292
00:18:54,260 --> 00:18:58,600
off but it got no security features

293
00:18:58,600 --> 00:19:04,070
okay I will help back over to POSCO and
now the good stuff starts the beginning

294
00:19:04,070 --> 00:19:07,940
like the the first two Moz we're kind of
boring

295
00:19:07,940 --> 00:19:11,220
nothing special nothing new we just get
the mattress

296
00:19:11,220 --> 00:19:17,130
but not all something good comes yet the
text part is the bills & Observer of the

297
00:19:17,130 --> 00:19:18,430
camera

298
00:19:18,430 --> 00:19:25,430
and have it on the web that pic the
publication is always a good

299
00:19:25,850 --> 00:19:29,590
so this moats its lease coltie Wireless

300
00:19:29,590 --> 00:19:32,620
file transmitter server mode

301
00:19:32,620 --> 00:19:35,660
which is actually the wifi deweiss

302
00:19:35,660 --> 00:19:39,640
sysname also wireless file transmitter

303
00:19:39,640 --> 00:19:43,420
so and another marketing

304
00:19:43,420 --> 00:19:46,580
as a from can you say

305
00:19:46,580 --> 00:19:49,730
Kansas use a frozen to capture

306
00:19:49,730 --> 00:19:54,460
you and download images remotely

307
00:19:54,460 --> 00:19:58,100
so what if someone else

308
00:19:58,100 --> 00:20:01,230
is also able to capture view and
download

309
00:20:01,230 --> 00:20:04,820
images remotely without

310
00:20:04,820 --> 00:20:08,830
knowledge of the owner of tomorrow

311
00:20:08,830 --> 00:20:11,980
and

312
00:20:11,980 --> 00:20:15,260
the web interface of the camera is
basically

313
00:20:15,260 --> 00:20:20,660
some small Ajax I can the

314
00:20:20,660 --> 00:20:24,520
kind of thing and the embedded Web
server is

315
00:20:24,520 --> 00:20:27,860
only capitol capable also managed of

316
00:20:27,860 --> 00:20:31,450
handling h2b get requests

317
00:20:31,450 --> 00:20:36,470
yet it's an actually it's an embedded
system so it's not that powerful

318
00:20:36,470 --> 00:20:40,860
and just keep it simple

319
00:20:40,860 --> 00:20:45,250
and do what you can with the stuff you
were able to handle

320
00:20:45,250 --> 00:20:48,850
maybe the thoughts of the developers and

321
00:20:48,850 --> 00:20:53,810
every other request method this concert
was a full for

322
00:20:53,810 --> 00:20:57,710
response so

323
00:20:57,710 --> 00:21:00,870
yet even had request for justice for all
yet

324
00:21:00,870 --> 00:21:03,960
so they Fay doesn't implement anything
else than

325
00:21:03,960 --> 00:21:07,510
HDPE get so basically if they

326
00:21:07,510 --> 00:21:11,550
implement that the equity 86 requests
and responses and

327
00:21:11,550 --> 00:21:15,850
and Flickr click stuff and

328
00:21:15,850 --> 00:21:19,610
sending stuff to the web server lawyer
firm

329
00:21:19,610 --> 00:21:23,800
get perimeters and the

330
00:21:23,800 --> 00:21:27,190
camera with XML which is parsed

331
00:21:27,190 --> 00:21:31,350
for why a javascript on blindside

332
00:21:31,350 --> 00:21:35,170
so that's all they implement it there
extent interface

333
00:21:35,170 --> 00:21:38,210
just whistling the it HDPE

334
00:21:38,210 --> 00:21:41,350
gets method

335
00:21:41,350 --> 00:21:45,640
and also

336
00:21:45,640 --> 00:21:49,800
Veris some notification

337
00:21:49,800 --> 00:21:52,840
for me yep the that service

338
00:21:52,840 --> 00:21:56,500
more your bets over actually uses

339
00:21:56,500 --> 00:22:00,420
shitty HTTP basic a alt

340
00:22:00,420 --> 00:22:04,310
what only on one specific

341
00:22:04,310 --> 00:22:07,630
you are I so if you post to the IP

342
00:22:07,630 --> 00:22:10,690
of the camera you will get 4 waters

343
00:22:10,690 --> 00:22:14,610
to the lookin a page

344
00:22:14,610 --> 00:22:18,590
or through the specifics euro well the

345
00:22:18,590 --> 00:22:22,480
us over response with them the meat of
them

346
00:22:22,480 --> 00:22:25,920
authentication my out pitch to the basic

347
00:22:25,920 --> 00:22:29,300
after you've of indicators successfully
the

348
00:22:29,300 --> 00:22:32,550
took you two sips and all the other

349
00:22:32,550 --> 00:22:37,890
the urals just request is the cookie
a.m.

350
00:22:37,890 --> 00:22:42,060
authenticated or not intel's it will

351
00:22:42,060 --> 00:22:45,870
a.m. redirects you to page which set

352
00:22:45,870 --> 00:22:49,350
which this there is a someone else on
this over

353
00:22:49,350 --> 00:22:53,440
for you already you're not logged in
please go to decide and

354
00:22:53,440 --> 00:22:57,140
lookin another time

355
00:22:57,140 --> 00:23:00,620
and let's have a look at the session
cookie

356
00:23:00,620 --> 00:23:03,730
yes was what what's

357
00:23:03,730 --> 00:23:07,550
what's wrong with it to the basics of
yeah there's no transport

358
00:23:07,550 --> 00:23:12,040
a.m. sperm yeah

359
00:23:12,040 --> 00:23:15,340
encryption there's no the encryption at
all

360
00:23:15,340 --> 00:23:19,680
via the between the camera and you feel
broza

361
00:23:19,680 --> 00:23:22,990
so once your again man in the middle

362
00:23:22,990 --> 00:23:27,550
you can also sniff the the looking
financials

363
00:23:27,550 --> 00:23:31,600
but as as we may the see in a couple
slice

364
00:23:31,600 --> 00:23:37,770
we don't meet them we don't BT
credentials at all

365
00:23:37,770 --> 00:23:43,450
so that's heavy the have a look at this
cookie

366
00:23:43,450 --> 00:23:46,690
the cookie looks like this session IV

367
00:23:46,690 --> 00:23:52,620
and surrendering nothing wrong about it

368
00:23:52,620 --> 00:23:58,750
but this string is rather short so

369
00:23:58,750 --> 00:24:02,140
this is a 4-byte session ID

370
00:24:02,140 --> 00:24:05,520
this also means the total number

371
00:24:05,520 --> 00:24:09,220
of possible session ID's this forever

372
00:24:09,220 --> 00:24:12,660
low so and what do you think

373
00:24:12,660 --> 00:24:16,440
how long would take to uproot force

374
00:24:16,440 --> 00:24:21,110
65,000 different 80s

375
00:24:21,110 --> 00:24:25,090
on a web server

376
00:24:25,090 --> 00:24:28,100
yeah and be just thought we saw the
session ID

377
00:24:28,100 --> 00:24:33,310
and its its for quite it's basically an
integer

378
00:24:33,310 --> 00:24:37,930
and we just thought

379
00:24:37,930 --> 00:24:42,060
WTF because it's the a WTF

380
00:24:42,060 --> 00:24:46,170
so up so from yeah as it says in the
name

381
00:24:46,170 --> 00:24:49,180
says they just a.m. spots

382
00:24:49,180 --> 00:24:53,950
two characters and so

383
00:24:53,950 --> 00:24:57,380
the set before its simple to prove false

384
00:24:57,380 --> 00:25:00,720
love four bytes session the ID cookie

385
00:25:00,720 --> 00:25:04,960
we just implemented in six lines of
Python code

386
00:25:04,960 --> 00:25:08,120
and to check all of the possible ID's

387
00:25:08,120 --> 00:25:11,460
its took yeah 18 to 20 minutes

388
00:25:11,460 --> 00:25:14,840
just because the a embedded Web server

389
00:25:14,840 --> 00:25:18,800
was just able to manage one request at a
time

390
00:25:18,800 --> 00:25:24,990
and has a yeah and it took some time up
to one second per request

391
00:25:24,990 --> 00:25:28,570
and it's an embedded system its bills to

392
00:25:28,570 --> 00:25:35,570
take pictures not for serving portal
something

393
00:25:35,840 --> 00:25:39,030
and we just recorded in

394
00:25:39,030 --> 00:25:42,300
shorty mo I'm all speed

395
00:25:42,300 --> 00:25:46,770
foot forcing and setting the cookie and
accessing the web server

396
00:25:46,770 --> 00:25:53,770
I will show you

397
00:25:54,390 --> 00:25:58,510
so your I am year in studying

398
00:25:58,510 --> 00:26:02,910
our pet scripts and you see the pros in
the background

399
00:26:02,910 --> 00:26:06,540
and as I said before it's

400
00:26:06,540 --> 00:26:10,940
takes the up to 20 minutes but we took
care that these

401
00:26:10,940 --> 00:26:15,080
the session ID you read use an odorless
where the low

402
00:26:15,080 --> 00:26:18,120
I've just seen some session it is that
have only

403
00:26:18,120 --> 00:26:21,500
to characters in it and

404
00:26:21,500 --> 00:26:25,490
yeah think me just a.m.

405
00:26:25,490 --> 00:26:28,540
some of them may just have one bites

406
00:26:28,540 --> 00:26:34,550
of assessment of yeah interview if
you're lucky the years ago

407
00:26:34,550 --> 00:26:37,890
just upset tonight it's one so yeah you
for forcing

408
00:26:37,890 --> 00:26:42,000
this finish really quick so no or
powerful setool

409
00:26:42,000 --> 00:26:45,800
just phone develops session ID and this
issue

410
00:26:45,800 --> 00:26:51,480
its three characters and not for

411
00:26:51,480 --> 00:26:58,190
so now we take our cookie and

412
00:26:58,190 --> 00:27:02,250
and show you from the speech

413
00:27:02,250 --> 00:27:05,490
for yet it the fact that was six if we
have a

414
00:27:05,490 --> 00:27:09,440
well it's a session cookie and just the
prints out

415
00:27:09,440 --> 00:27:13,030
please try again 3c relook and

416
00:27:13,030 --> 00:27:16,710
firm yet its business basically says

417
00:27:16,710 --> 00:27:20,020
the user was that same login names over
the existing so

418
00:27:20,020 --> 00:27:23,040
but itself this every time

419
00:27:23,040 --> 00:27:26,570
it's just so steps toward H HTML

420
00:27:26,570 --> 00:27:29,880
site on the camera

421
00:27:29,880 --> 00:27:33,940
so

422
00:27:33,940 --> 00:27:37,240
we adjusts both use a browser to set

423
00:27:37,240 --> 00:27:44,240
alone session ID cookie

424
00:27:45,590 --> 00:27:48,730
checked all the unnecessary boxes and
make it the session cookie

425
00:27:48,730 --> 00:27:52,610
and HD only the reload the site

426
00:27:52,610 --> 00:27:56,050
and now we are accessing the

427
00:27:56,050 --> 00:28:00,660
be into the ref from Dan's of or camera

428
00:28:00,660 --> 00:28:03,820
an issue see here there are different
malts

429
00:28:03,820 --> 00:28:07,110
with a view we can access the so which

430
00:28:07,110 --> 00:28:10,960
of the camera April through the videos

431
00:28:10,960 --> 00:28:15,260
two images don't know them we can even
upload images

432
00:28:15,260 --> 00:28:19,510
through the home CF card and also

433
00:28:19,510 --> 00:28:22,770
we have a camera controls it

434
00:28:22,770 --> 00:28:26,210
businesses see here

435
00:28:26,210 --> 00:28:29,230
we are able to take pictures with this

436
00:28:29,230 --> 00:28:32,760
30 button we see some settings of the
camera

437
00:28:32,760 --> 00:28:36,990
and also we see some configuration
settings of the camera

438
00:28:36,990 --> 00:28:40,400
Andrea also able to remotely

439
00:28:40,400 --> 00:28:43,650
change them and

440
00:28:43,650 --> 00:28:46,800
this big book see you is

441
00:28:46,800 --> 00:28:49,970
the life you of the camera so do you

442
00:28:49,970 --> 00:28:53,370
the sugar pops up and you getting

443
00:28:53,370 --> 00:28:57,000
an image every seconds from the

444
00:28:57,000 --> 00:29:00,030
from the sensor so in this case

445
00:29:00,030 --> 00:29:03,150
we can we can just use the camera in the

446
00:29:03,150 --> 00:29:08,450
as a surveillance device for example
a.m.

447
00:29:08,450 --> 00:29:12,460
a scenario fruitful for this attack

448
00:29:12,460 --> 00:29:16,130
might be some further prefer sitting in
this hotel room

449
00:29:16,130 --> 00:29:20,090
using the hotel why Atlan or

450
00:29:20,090 --> 00:29:23,510
wifi and you're sitting in a in the next
room also accessing

451
00:29:23,510 --> 00:29:28,270
me effeminate and you just

452
00:29:28,270 --> 00:29:31,270
see the Camry Cymru announcing

453
00:29:31,270 --> 00:29:34,340
some packets on bootup and its

454
00:29:34,340 --> 00:29:37,370
just show them I'm a Canon try to hit me

455
00:29:37,370 --> 00:29:41,650
and steel only downside

456
00:29:41,650 --> 00:29:44,820
for this is a kiss a.m.

457
00:29:44,820 --> 00:29:48,580
the session gets actually invalidated if
the

458
00:29:48,580 --> 00:29:52,920
camera gets into it's a bit mode and

459
00:29:52,920 --> 00:29:58,180
the amount of time became more will take
to get him to sleep

460
00:29:58,180 --> 00:30:01,280
if no keys are pressed or something firm

461
00:30:01,280 --> 00:30:05,350
are configurable so if

462
00:30:05,350 --> 00:30:09,220
the camera gets into sleep while you're
approved closing session ID

463
00:30:09,220 --> 00:30:12,690
firm yeah you are not able to get this

464
00:30:12,690 --> 00:30:16,140
your part like a boss 01 spec connector

465
00:30:16,140 --> 00:30:19,450
and up to life you up and running the
camera doesn't sleep at all

466
00:30:19,450 --> 00:30:22,530
so once you're in you're in

467
00:30:22,530 --> 00:30:29,270
their minutes for all the moment so now
we have

468
00:30:29,270 --> 00:30:33,320
full access to the life you the store
images and the camera setting

469
00:30:33,320 --> 00:30:38,800
I'm this also is possible

470
00:30:38,800 --> 00:30:42,650
if the on of the camera is also
suffering

471
00:30:42,650 --> 00:30:47,070
on developing to face and a camera he
might fear

472
00:30:47,070 --> 00:30:50,860
the confused why the cameras ordered

473
00:30:50,860 --> 00:30:55,250
couldn't the web server is running so
slow foot I don't think you would expect

474
00:30:55,250 --> 00:31:00,930
30 for closing session at beyond its

475
00:31:00,930 --> 00:31:04,750
yet the the requirements a set before

476
00:31:04,750 --> 00:31:09,740
a.m. so minutes of time takes up to 20
minutes

477
00:31:09,740 --> 00:31:14,710
the camera has to being the WFT server
most which

478
00:31:14,710 --> 00:31:18,950
starts up the the web server and

479
00:31:18,950 --> 00:31:22,360
a valid section IV has to be open before

480
00:31:22,360 --> 00:31:25,720
but the owner of a camera so

481
00:31:25,720 --> 00:31:29,240
if they're is no looking from from the
owner

482
00:31:29,240 --> 00:31:33,890
so there is no way that session ID but
it just takes 20 minutes to find out

483
00:31:33,890 --> 00:31:38,270
if there is one okay

484
00:31:38,270 --> 00:31:43,420
so I'll now we gotta get to my favorite
mode oMG it's called the

485
00:31:43,420 --> 00:31:47,250
yes utility Malta as I said before it's
are

486
00:31:47,250 --> 00:31:50,660
proprietary tool using

487
00:31:50,660 --> 00:31:54,090
kind of proprietary protocol I'll

488
00:31:54,090 --> 00:31:58,030
speaking with the camera with like
highest

489
00:31:58,030 --> 00:32:01,750
a rights you're able to get over the
network so

490
00:32:01,750 --> 00:32:05,300
this this as: close to route as your cum

491
00:32:05,300 --> 00:32:08,300
by not injecting exploit go to the
camera

492
00:32:08,300 --> 00:32:11,630
so from this

493
00:32:11,630 --> 00:32:15,840
just a screenshot of the utility on the
PC so

494
00:32:15,840 --> 00:32:20,580
if you're connected to a camera you can
%uh start downloading images

495
00:32:20,580 --> 00:32:23,700
you can a through the remote routing

496
00:32:23,700 --> 00:32:26,990
so basically all the stuff you can do
with the web interface

497
00:32:26,990 --> 00:32:31,690
but this is just a good car in the
background in the protocol there are

498
00:32:31,690 --> 00:32:32,900
even more options

499
00:32:32,900 --> 00:32:36,310
so I'll

500
00:32:36,310 --> 00:32:40,280
was a stranger of the 2016 up and
running connected to the camera so you

501
00:32:40,280 --> 00:32:40,730
got

502
00:32:40,730 --> 00:32:44,760
a lot of your screen ago and you got the
camera controls and all that stuff

503
00:32:44,760 --> 00:32:49,310
up so just to give you to a view of the

504
00:32:49,310 --> 00:32:53,710
tool I'm its capabilities then yes you
see is

505
00:32:53,710 --> 00:32:57,380
more less an extended version of the web
front-end

506
00:32:57,380 --> 00:33:00,650
your okay

507
00:33:00,650 --> 00:33:04,060
so I'll as a set

508
00:33:04,060 --> 00:33:08,180
this is a really are reading lights
remote

509
00:33:08,180 --> 00:33:12,160
so you have full control of all camera
controls

510
00:33:12,160 --> 00:33:15,360
that doesn't need like a a manual

511
00:33:15,360 --> 00:33:19,790
I'll twisting of the Lance or stuff like
that

512
00:33:19,790 --> 00:33:23,020
from you also can up and I'll look
pictures

513
00:33:23,020 --> 00:33:26,080
the turn up and download movies arm

514
00:33:26,080 --> 00:33:29,130
it may even be possible to

515
00:33:29,130 --> 00:33:34,270
record sound because the camera is a
video camera it also got a microphone

516
00:33:34,270 --> 00:33:37,740
arm I didn't figure out how to turn on
the mic

517
00:33:37,740 --> 00:33:41,740
yes but there are a lot of like Canon
proprietary

518
00:33:41,740 --> 00:33:46,220
option second sup in the protocol and of
nothin for all up to

519
00:33:46,220 --> 00:33:49,590
so there might be a chance for recording
salt

520
00:33:49,590 --> 00:33:53,090
arm okay also

521
00:33:53,090 --> 00:33:57,180
what both this tool and a camera do like
technically

522
00:33:57,180 --> 00:34:01,040
are first of all day discover each other
again

523
00:34:01,040 --> 00:34:06,060
and this scenario I'll SSDP if the
simple service discovery protocol

524
00:34:06,060 --> 00:34:09,270
and multicast DNS issues so

525
00:34:09,270 --> 00:34:12,790
they both ago and just screaming
direction of the broadcast

526
00:34:12,790 --> 00:34:16,780
I'm hopefully find each other

527
00:34:16,780 --> 00:34:20,649
up the walls of the discovery up
protocol called

528
00:34:20,649 --> 00:34:24,750
p2p it. is used for the communication

529
00:34:24,750 --> 00:34:28,100
also this mold must be really high
secure

530
00:34:28,100 --> 00:34:31,770
because it needs and initial camera
software parry

531
00:34:31,770 --> 00:34:36,120
you need to Press a lot of buttons on
the camera out to put it into pairing

532
00:34:36,120 --> 00:34:37,140
mode

533
00:34:37,140 --> 00:34:41,300
and then your need to click on your PC
to pair with the camera

534
00:34:41,300 --> 00:34:46,179
so this must be sick you

535
00:34:46,179 --> 00:34:50,560
okay what started the parrot Janet to
pair to

536
00:34:50,560 --> 00:34:53,980
kind of exchange credentials I guess

537
00:34:53,980 --> 00:34:57,580
that's what parents should be fortunate
arm

538
00:34:57,580 --> 00:35:02,380
yes I set the camera has to be put into
repairing most about a menu

539
00:35:02,380 --> 00:35:05,750
you can't do that remote um

540
00:35:05,750 --> 00:35:10,430
and also repairing his signaled while
party custom us

541
00:35:10,430 --> 00:35:14,040
so if you put the camera into pairing
mode it's more or less

542
00:35:14,040 --> 00:35:18,560
except pairing from every device or out

543
00:35:18,560 --> 00:35:22,120
so it just sends out arm

544
00:35:22,120 --> 00:35:26,890
want to cast in aspects with this magic
tea I deduct canada.com

545
00:35:26,890 --> 00:35:31,190
um text set to a lot of zeros along and
a lot of Jeff's

546
00:35:31,190 --> 00:35:35,650
that's a signal for your I'm I'm out
Canon camera and I want to appear with

547
00:35:35,650 --> 00:35:38,960
someone

548
00:35:38,960 --> 00:35:43,370
arm this is what it looks like if the
yes eternity detects

549
00:35:43,370 --> 00:35:46,850
appearing the first just so-so care of
on the camera

550
00:35:46,850 --> 00:35:50,460
got this Mike addressing this IP address
and it wants to be picked

551
00:35:50,460 --> 00:35:54,050
click Connect to pair with the camera
okay so

552
00:35:54,050 --> 00:35:59,010
if you to click Connect what happens
this the software connects to the camera

553
00:35:59,010 --> 00:36:00,040
while

554
00:36:00,040 --> 00:36:03,470
this protocol p2p I P will come through

555
00:36:03,470 --> 00:36:06,740
protocol in a second arm

556
00:36:06,740 --> 00:36:09,810
this protocol also includes an
authentication

557
00:36:09,810 --> 00:36:13,030
both if the camera is an appearing alt
the camera

558
00:36:13,030 --> 00:36:18,120
except every authentication mountain
serial data center it

559
00:36:18,120 --> 00:36:22,230
after what's the credentials are store
on the camera so that

560
00:36:22,230 --> 00:36:25,920
only that one client with that specific

561
00:36:25,920 --> 00:36:29,820
authentication information can connect
to become a writer

562
00:36:29,820 --> 00:36:33,790
at least that's what it shouldn't

563
00:36:33,790 --> 00:36:37,030
we'll see okay

564
00:36:37,030 --> 00:36:42,570
let's get to p2p I P that's the main
protocol used here for communication

565
00:36:42,570 --> 00:36:46,620
%uh it feels a little bit like use be
over IP

566
00:36:46,620 --> 00:36:50,230
because I'll physically I P though

567
00:36:50,230 --> 00:36:53,950
so-called picture Transfer Protocol over
Internet Protocol

568
00:36:53,950 --> 00:36:58,310
are sanitized and a very nice I sold the
comment

569
00:36:58,310 --> 00:37:02,690
and sanitize fire Association of the
International

570
00:37:02,690 --> 00:37:06,850
emitting industry yeah

571
00:37:06,850 --> 00:37:10,290
best pro I am

572
00:37:10,290 --> 00:37:13,370
it's more or less a rep of okipe

573
00:37:13,370 --> 00:37:16,940
so pitifully the pic to transfer
protocol as Walt

574
00:37:16,940 --> 00:37:20,380
all more or less all media devices
speaks

575
00:37:20,380 --> 00:37:25,790
why you speak so if you connect the
camera while your spirits explain pitted

576
00:37:25,790 --> 00:37:29,090
if you connect your mp3 player out to a

577
00:37:29,090 --> 00:37:33,600
to computer and then pops up a little
window which that's all media device

578
00:37:33,600 --> 00:37:34,620
discovered

579
00:37:34,620 --> 00:37:37,740
we want to browse it than actually it's

580
00:37:37,740 --> 00:37:41,160
not like browsing a mass storage device
but in the background

581
00:37:41,160 --> 00:37:46,940
this protocol pity is used through
access the media device

582
00:37:46,940 --> 00:37:50,530
so p2p IP is just a wrapper around

583
00:37:50,530 --> 00:37:53,880
you speak for the call because

584
00:37:53,880 --> 00:37:57,450
very decided to just put the protocol on
IP

585
00:37:57,450 --> 00:38:00,640
I don't need it some more information
like

586
00:38:00,640 --> 00:38:03,970
all we need a landfill we need some type
field

587
00:38:03,970 --> 00:38:09,570
and in the end there is justice are to
know p2p data

588
00:38:09,570 --> 00:38:13,050
so I just got tomb of you

589
00:38:13,050 --> 00:38:16,359
on I said before it feels a bit like

590
00:38:16,359 --> 00:38:19,980
use be over IP arm because the

591
00:38:19,980 --> 00:38:23,910
packard land for this very limited and

592
00:38:23,910 --> 00:38:28,630
also units that they to entirely all the
stuff like

593
00:38:28,630 --> 00:38:32,570
I'll sequence numbering aren't

594
00:38:32,570 --> 00:38:37,300
up all that stuff again and again

595
00:38:37,300 --> 00:38:40,320
so okay arm

596
00:38:40,320 --> 00:38:43,690
here's a screenshot of two-layer model
so you gotta

597
00:38:43,690 --> 00:38:48,980
p2p protocol on top you got the p2p I
pirupa then you got TCPIP and

598
00:38:48,980 --> 00:38:52,580
some network layers

599
00:38:52,580 --> 00:38:57,570
okay pitifully IPA got someone typed
that says p2p I

600
00:38:57,570 --> 00:39:01,560
in it come on request that that sounds
interesting

601
00:39:01,560 --> 00:39:06,359
um this come on actually does the
authentification for the connection

602
00:39:06,359 --> 00:39:10,050
and its includes to types of
authentication

603
00:39:10,050 --> 00:39:14,960
beta which is want 16 fights GUID

604
00:39:14,960 --> 00:39:18,390
and host industry

605
00:39:18,390 --> 00:39:22,040
so I'm my first fall was okay

606
00:39:22,040 --> 00:39:26,530
discover host named up could be possible
if it's a Windows or Mac

607
00:39:26,530 --> 00:39:30,290
I'll but all lost 16 byte

608
00:39:30,290 --> 00:39:34,359
to you I D that would be hard to
brute-force

609
00:39:34,359 --> 00:39:37,760
so aka ridiculous the four

610
00:39:37,760 --> 00:39:41,240
um this is just one of those 50 per unit
per month

611
00:39:41,240 --> 00:39:45,550
request so you got like to pick a plan
to get the pic that I

612
00:39:45,550 --> 00:39:48,930
than you got the famous GUID

613
00:39:48,930 --> 00:39:52,870
which looks pretty random are after
whatcha got

614
00:39:52,870 --> 00:39:57,040
hostname this is just so ever and
YouTube 16

615
00:39:57,040 --> 00:40:00,560
and then you got a trailer

616
00:40:00,560 --> 00:40:03,810
are remember this blue string

617
00:40:03,810 --> 00:40:07,910
it will come back in a second

618
00:40:07,910 --> 00:40:13,440
ok it's all obviously we broke the
fourth round spermatids well

619
00:40:13,440 --> 00:40:17,680
otherwise I wouldn't be talking so much
about p2p and all that stuff

620
00:40:17,680 --> 00:40:21,370
arm so let's see for client hostname

621
00:40:21,370 --> 00:40:24,540
as I said before could be easily
discoverable

622
00:40:24,540 --> 00:40:28,820
if it's a Windows machine or Mac who
just broadcast or hostname all the time

623
00:40:28,820 --> 00:40:30,270
in the network

624
00:40:30,270 --> 00:40:36,660
arm but regardless to cover also accepts
connection from different host names

625
00:40:36,660 --> 00:40:41,130
so I think that all three lakes arm

626
00:40:41,130 --> 00:40:44,350
brought yeah actually it doesn't matter
which hostname sup

627
00:40:44,350 --> 00:40:48,250
just connect the camera are also

628
00:40:48,250 --> 00:40:52,359
what I discovered was searching for this
6 invite you I D

629
00:40:52,359 --> 00:40:55,790
this that it was not start nowhere

630
00:40:55,790 --> 00:40:59,190
on the PC this GUID is

631
00:40:59,190 --> 00:41:02,320
unknown to the clients of and that made
me think it's

632
00:41:02,320 --> 00:41:07,320
a while the software doesn't know the
authentication material used to connect

633
00:41:07,320 --> 00:41:08,450
to the cam Russell

634
00:41:08,450 --> 00:41:12,170
where is this GUID coming from

635
00:41:12,170 --> 00:41:15,310
so actually its broadcast the and

636
00:41:15,310 --> 00:41:18,570
office go to form by the camera itself

637
00:41:18,570 --> 00:41:23,500
why you can't so on what this looks like

638
00:41:23,500 --> 00:41:26,680
as this we also got the famous

639
00:41:26,680 --> 00:41:29,720
Tidd can invite com I've now

640
00:41:29,720 --> 00:41:33,050
it's just a random string instead of

641
00:41:33,050 --> 00:41:37,460
lots of zeroes falling and lots of cops
we saw before

642
00:41:37,460 --> 00:41:41,400
no okay this string doesn't match the
GUID

643
00:41:41,400 --> 00:41:44,460
it's a different story but as a set

644
00:41:44,460 --> 00:41:48,090
yeah it's kind of obvious case so of
after putting

645
00:41:48,090 --> 00:41:52,230
little brain into this problem I came
out up with this

646
00:41:52,230 --> 00:41:55,690
short I from statement and after getting
the

647
00:41:55,690 --> 00:41:59,990
tido can not come through this %uh the
loop

648
00:41:59,990 --> 00:42:04,420
we just got back the blue streak that's
exactly the GUID

649
00:42:04,420 --> 00:42:07,940
I showed you before arm on to us

650
00:42:07,940 --> 00:42:11,480
on on the arm picture of the

651
00:42:11,480 --> 00:42:15,080
for the call

652
00:42:15,080 --> 00:42:19,380
ok it's so now on what are going to do
with this

653
00:42:19,380 --> 00:42:22,500
of indication the theory are we figured
out the camera

654
00:42:22,500 --> 00:42:27,310
only allows one connection at a time so
if a user is already connected to the

655
00:42:27,310 --> 00:42:28,560
camera

656
00:42:28,560 --> 00:42:31,690
the use that needs to be disconnected in
some way

657
00:42:31,690 --> 00:42:36,460
to let us connect the camera and as I
mentioned before

658
00:42:36,460 --> 00:42:39,460
oh yeah oh well the TCP reset

659
00:42:39,460 --> 00:42:42,900
attack is possible so you can just

660
00:42:42,900 --> 00:42:46,120
you got to well-known ports arm

661
00:42:46,120 --> 00:42:49,460
also there is quite lot of states are
going

662
00:42:49,460 --> 00:42:53,560
through on this to port so you got pic
TCP Windows

663
00:42:53,560 --> 00:42:57,850
it's not that hard to two hits all RTCP
recess

664
00:42:57,850 --> 00:43:01,359
a attacks are absolutely arm

665
00:43:01,359 --> 00:43:06,040
doable in this scenario ok it's so now
we got to use a disconnect that

666
00:43:06,040 --> 00:43:09,109
so terrorists a lot of space for us

667
00:43:09,109 --> 00:43:14,380
to the camera so the process of this
attack with pretty much speed up

668
00:43:14,380 --> 00:43:17,650
just listen for the camera to pop up

669
00:43:17,650 --> 00:43:22,130
to just up announce itself

670
00:43:22,130 --> 00:43:25,420
than the obfuscate the authentication
data

671
00:43:25,420 --> 00:43:29,260
which is pretty easy with those for
Python statement

672
00:43:29,260 --> 00:43:33,100
than disconnect the client software if
connect

673
00:43:33,100 --> 00:43:37,109
an off-the-wall disconnect yourself why
it's his p2p ike

674
00:43:37,109 --> 00:43:40,400
and of course a fun with other people's
make

675
00:43:40,400 --> 00:43:46,130
picked okay I got assault team on this

676
00:43:46,130 --> 00:43:53,130
on as it's a life the more I will hope
that the works

677
00:43:59,340 --> 00:44:04,010
aka so I'll I just wrote a little tool I
will

678
00:44:04,010 --> 00:44:08,690
months it up what it does it just
licence for the camera under

679
00:44:08,690 --> 00:44:13,660
local network so the camera is asleep at
the moment so I will just wait it up

680
00:44:13,660 --> 00:44:17,110
it will connector while Islam

681
00:44:17,110 --> 00:44:21,190
thats around us of the wats I'll and
will announce

682
00:44:21,190 --> 00:44:25,020
itself on multicast DNS so it just takes

683
00:44:25,020 --> 00:44:28,160
about a few second to associate to the

684
00:44:28,160 --> 00:44:31,420
to wetland to get and there's a cute
dress on

685
00:44:31,420 --> 00:44:37,130
all that stuff but

686
00:44:37,130 --> 00:44:42,350
after I'm I connected to the wifi

687
00:44:42,350 --> 00:44:49,350
I'm connected to the wifi so

688
00:44:49,460 --> 00:44:52,740
civic unrest

689
00:44:52,740 --> 00:44:57,810
trying really hard what's wrong doesn't
can't connect to the wifi

690
00:44:57,810 --> 00:45:01,530
their

691
00:45:01,530 --> 00:45:05,280
see a

692
00:45:05,280 --> 00:45:09,290
have you tried turning in for ago yes

693
00:45:09,290 --> 00:45:16,290
I do so

694
00:45:16,320 --> 00:45:19,370
yeah that's the thing with life famous

695
00:45:19,370 --> 00:45:22,480
when they fail they fail horrible

696
00:45:22,480 --> 00:45:25,900
K

697
00:45:25,900 --> 00:45:31,080
I'll let's see armpit tyrants from
soldiering

698
00:45:31,080 --> 00:45:36,730
lost four days you're pretty purchase
I'm kind of programming them

699
00:45:36,730 --> 00:45:40,300
yeah thank you

700
00:45:40,300 --> 00:45:44,400
%uh threats

701
00:45:44,400 --> 00:45:48,220
I why on earth

702
00:45:48,220 --> 00:45:51,630
up a of

703
00:45:51,630 --> 00:45:55,170
for

704
00:45:55,170 --> 00:45:58,610
okay the camera doesn't get an IP
address

705
00:45:58,610 --> 00:46:05,450
up to al

706
00:46:05,450 --> 00:46:08,520
oh yeah reset the ext that's a good idea

707
00:46:08,520 --> 00:46:13,210
its

708
00:46:13,210 --> 00:46:16,600
us yes its absolutely but not us

709
00:46:16,600 --> 00:46:20,340
fair

710
00:46:20,340 --> 00:46:23,680
access point to sporting good thing
boating

711
00:46:23,680 --> 00:46:29,369
I still got an IP address no

712
00:46:29,369 --> 00:46:34,430
minus gone saw

713
00:46:34,430 --> 00:46:39,390
aka wrist other apps we will

714
00:46:39,390 --> 00:46:43,200
start the camera at Willard out for the
way flan

715
00:46:43,200 --> 00:46:47,119
hour or more you know what maybe

716
00:46:47,119 --> 00:46:51,030
it's too noisy in how many access points
can you count

717
00:46:51,030 --> 00:46:58,030
yes we can just switch to the senate
year as an easier for

718
00:46:58,040 --> 00:47:02,280
I think we're all just be just like

719
00:47:02,280 --> 00:47:06,170
and hour ago before that targets us

720
00:47:06,170 --> 00:47:09,170
test data set up and it was working on
the fourth floor

721
00:47:09,170 --> 00:47:12,380
so yeah was working quite smoothly

722
00:47:12,380 --> 00:47:15,890
okay of

723
00:47:15,890 --> 00:47:19,410
there we go we just need to be patient
sale

724
00:47:19,410 --> 00:47:23,150
the camera now I'll just announce itself

725
00:47:23,150 --> 00:47:26,400
to yeah I'm here I'm a camera assesses

726
00:47:26,400 --> 00:47:30,660
I feel about the IP address idea of this
case that the GUID

727
00:47:30,660 --> 00:47:34,970
and after what's it's just a job of lift
the photo to connect to the camera

728
00:47:34,970 --> 00:47:39,250
so once I'm connectors i-ten

729
00:47:39,250 --> 00:47:43,930
read out the configuration so it's
either stuff like

730
00:47:43,930 --> 00:47:48,490
up I don't know the current a picture
that is set

731
00:47:48,490 --> 00:47:51,540
a camera more though

732
00:47:51,540 --> 00:47:55,250
some were should also be the lands

733
00:47:55,250 --> 00:47:58,820
named and stuff like that saw

734
00:47:58,820 --> 00:48:01,830
after getting for

735
00:48:01,830 --> 00:48:05,380
configuration I can also list all the
files

736
00:48:05,380 --> 00:48:08,750
but I cannot also but I cannot only

737
00:48:08,750 --> 00:48:11,790
lists the files 0 this what for

738
00:48:11,790 --> 00:48:15,690
I can also download the files

739
00:48:15,690 --> 00:48:19,869
um ok now trams up to Mac

740
00:48:19,869 --> 00:48:24,840
that's good so you will see the picture
starts on a camera

741
00:48:24,840 --> 00:48:28,150
Justin about the second to

742
00:48:28,150 --> 00:48:31,510
yeah so thats

743
00:48:31,510 --> 00:48:36,310
one of the pictures the first one from
one or development sessions from the

744
00:48:36,310 --> 00:48:36,950
patch

745
00:48:36,950 --> 00:48:41,430
yeah this is like the whole office looks
yeah

746
00:48:41,430 --> 00:48:44,489
this whole all the guys working on the
batch look

747
00:48:44,489 --> 00:48:48,420
the last week trust me I'm an engineer
yeah

748
00:48:48,420 --> 00:48:52,559
and also

749
00:48:52,559 --> 00:48:57,319
this is what we produced and consumed so

750
00:48:57,319 --> 00:49:01,509
okay now that we got all the pictures of
the camera

751
00:49:01,509 --> 00:49:05,029
what else to do so I thought

752
00:49:05,029 --> 00:49:11,190
it my rights be interesting could just
got a little life you

753
00:49:11,190 --> 00:49:15,589
out of the camera so

754
00:49:15,589 --> 00:49:19,670
I not implemented

755
00:49:19,670 --> 00:49:22,779
RK that for

756
00:49:22,779 --> 00:49:25,849
the wavelet inside interests really trap

757
00:49:25,849 --> 00:49:29,299
long leave this rose about the 20

758
00:49:29,299 --> 00:49:34,859
pictures the second now I'm barely
getting one through for a sec

759
00:49:34,859 --> 00:49:37,900
okay so of

760
00:49:37,900 --> 00:49:41,739
your few small way flout so if you able
to

761
00:49:41,739 --> 00:49:45,039
get access to occurred on

762
00:49:45,039 --> 00:49:48,619
1bx internet wrote you see some
detective

763
00:49:48,619 --> 00:49:55,619
I yeah don't let the cum flow

764
00:50:03,900 --> 00:50:04,280
either

765
00:50:04,280 --> 00:50:07,910
so up you know

766
00:50:07,910 --> 00:50:11,119
what what what some other I'll think of

767
00:50:11,119 --> 00:50:15,690
some photographs using the all the way
flow on the Starbucks with lon

768
00:50:15,690 --> 00:50:19,119
everywhere else freeway flannel around
yeah think like

769
00:50:19,119 --> 00:50:23,560
the sea with a few days ago I'll and

770
00:50:23,560 --> 00:50:27,150
nothing about somebody else being in
that network segment

771
00:50:27,150 --> 00:50:30,280
so almost anybody in the same lawn

772
00:50:30,280 --> 00:50:33,660
can excessive camera regardless of the
mode it's in

773
00:50:33,660 --> 00:50:38,040
can carlotta images and somewhat Stephen
can

774
00:50:38,040 --> 00:50:41,080
upload images scanned yeah

775
00:50:41,080 --> 00:50:44,160
like gets the life you out of the camera

776
00:50:44,160 --> 00:50:48,740
turn it into a surveillance device and
I'm still looking for them microphone

777
00:50:48,740 --> 00:50:51,750
because I wanna the camera be a fun

778
00:50:51,750 --> 00:50:56,100
that would be awesome you actually a
able to record record a video

779
00:50:56,100 --> 00:51:01,820
and go to tougher rules so you've solved
yes but that's just a worker of

780
00:51:01,820 --> 00:51:05,880
for okay

781
00:51:05,880 --> 00:51:09,190
well what are the condom at us so I am
NOT

782
00:51:09,190 --> 00:51:12,440
that much there are

783
00:51:12,440 --> 00:51:17,180
only one to say it like that just enable
the network functionality

784
00:51:17,180 --> 00:51:21,880
and for the trust that work environments
and if you're using with lon

785
00:51:21,880 --> 00:51:25,770
use WPA news WPA

786
00:51:25,770 --> 00:51:29,170
exclamation mark and also only is it

787
00:51:29,170 --> 00:51:33,840
in a trust that the way for okay

788
00:51:33,840 --> 00:51:37,090
saw that's mainly it we got a few
conclusions

789
00:51:37,090 --> 00:51:40,390
I am and this say like

790
00:51:40,390 --> 00:51:43,650
s even more and more

791
00:51:43,650 --> 00:51:47,210
like daily life equipment comes equipped
with

792
00:51:47,210 --> 00:51:51,280
network functionality all the old and
boring

793
00:51:51,280 --> 00:51:54,780
and you like flame attacks they're
coming back

794
00:51:54,780 --> 00:51:59,670
and I'll bite you in the ass because
they are now attacking systems you don't

795
00:51:59,670 --> 00:52:01,760
even know about they have network access

796
00:52:01,760 --> 00:52:05,119
and yet

797
00:52:05,119 --> 00:52:09,280
again up there are

798
00:52:09,280 --> 00:52:12,450
a new throw another new process

799
00:52:12,450 --> 00:52:16,790
of attacks but there are old attacks
against the new class of device

800
00:52:16,790 --> 00:52:20,520
and your I don't think

801
00:52:20,520 --> 00:52:24,590
a the regular normal photograph

802
00:52:24,590 --> 00:52:27,840
kind of guy knows about

803
00:52:27,840 --> 00:52:32,750
of spoofing of stuff like that it just
wanna upload the images into the cloud

804
00:52:32,750 --> 00:52:33,910
as fast as possible

805
00:52:33,910 --> 00:52:38,310
so this phrase strippers speed used to
see

806
00:52:38,310 --> 00:52:43,140
it had has 73 of results yes really

807
00:52:43,140 --> 00:52:48,680
it has happened before and will will
happen yeah things will change

808
00:52:48,680 --> 00:52:52,170
striker I'll

809
00:52:52,170 --> 00:52:57,930
but that's not all various even a new
and more advanced camera than the one

810
00:52:57,930 --> 00:52:59,160
the acts like its up

811
00:52:59,160 --> 00:53:02,800
or want some kind of image quality about
now got on

812
00:53:02,800 --> 00:53:08,300
bill then Wireless access point yes so
you can connect your mobile phone

813
00:53:08,300 --> 00:53:11,500
to the inbuilt access point

814
00:53:11,500 --> 00:53:15,300
and control your camera why I saw
Android up

815
00:53:15,300 --> 00:53:18,340
so that is awesome is not

816
00:53:18,340 --> 00:53:21,810
I wanna see some traces of this book

817
00:53:21,810 --> 00:53:25,430
we don't gotta and I got our hands on
and 16 yet

818
00:53:25,430 --> 00:53:28,570
up any chance us somebody gotta

819
00:53:28,570 --> 00:53:32,140
sixty sponsorship

820
00:53:32,140 --> 00:53:35,750
well up silver okay but

821
00:53:35,750 --> 00:53:39,920
I think we'll have a look at this in the
future so

822
00:53:39,920 --> 00:53:43,820
okay as I have to say this not time
enough

823
00:53:43,820 --> 00:53:48,580
though one minute fifty is blinking red
for just in time so

824
00:53:48,580 --> 00:53:55,580
thanks for your time

825
00:53:56,010 --> 00:54:00,109
are there any I'll fast questions

826
00:54:00,109 --> 00:54:05,240
we got like one of a minute left speak
for us

827
00:54:05,240 --> 00:54:08,310
okay

828
00:54:08,310 --> 00:54:14,369
sorry your

829
00:54:14,369 --> 00:54:18,740
likes that is an option to switch off
the network functionality isn't yeah

830
00:54:18,740 --> 00:54:23,130
it's great here

831
00:54:23,130 --> 00:54:25,380
added got free TV Live

832
00:54:25,380 --> 00:54:29,160
yet yet

833
00:54:29,160 --> 00:54:32,650
use another question question fuzzy

834
00:54:32,650 --> 00:54:36,890
a yeah you don't it's a farce just sent

835
00:54:36,890 --> 00:54:41,599
100 opera seconds on the network cycle
guy POSCO

836
00:54:41,599 --> 00:54:45,930
see if you don't we need to because the

837
00:54:45,930 --> 00:54:49,220
exploitation yeah that would be really
interesting

838
00:54:49,220 --> 00:54:52,660
to get a real like a a payload onto the
camera

839
00:54:52,660 --> 00:54:55,789
arm but I haven't had the time yet to

840
00:54:55,789 --> 00:54:59,539
have a look at the operating system
running on a and I guess it's something

841
00:54:59,539 --> 00:55:00,660
really ugly

842
00:55:00,660 --> 00:55:04,579
because can and ships the sky with their
own like

843
00:55:04,579 --> 00:55:08,530
see if you use which are called image
procesos

844
00:55:08,530 --> 00:55:12,730
I don't own the must be running some
some real way it's

845
00:55:12,730 --> 00:55:16,160
real-time OS so but now that's

846
00:55:16,160 --> 00:55:21,859
our own but just finished I may have
talked a little bit for some some

847
00:55:21,859 --> 00:55:25,119
to the advertisements about Samsung
Galaxy Tamaraws

848
00:55:25,119 --> 00:55:29,500
yeah maybe this kind of devices but the
might be much more interesting for

849
00:55:29,500 --> 00:55:30,180
exportation

850
00:55:30,180 --> 00:55:33,480
yeah and I bet it also speaks pretty

851
00:55:33,480 --> 00:55:37,230
VIP I so

852
00:55:37,230 --> 00:55:42,210
yet last question non

853
00:55:42,210 --> 00:55:46,240
no remaining okay if the ranks of the
questions I think I've never be

854
00:55:46,240 --> 00:55:49,270
opportunities to be disguised a the
breaker

855
00:55:49,270 --> 00:55:52,440
a they won't escape so

856
00:55:52,440 --> 00:55:56,150
maybe fall asleep I of but don't worry

857
00:55:56,150 --> 00:56:01,260
remember charm for the wake the hot ask
the question so that's i think thats a

858
00:56:01,260 --> 00:56:04,789
so a.m. thought new POSCO thank you very
much

859
00:56:04,789 --> 00:56:06,789
yeah I hope to talk to Paul

