1
00:00:00,580 --> 00:00:06,959
on okay so I'm we will continue with the
next talk

2
00:00:06,959 --> 00:00:11,940
among the speakers are for our group
know and FedEx will have two guys of

3
00:00:11,940 --> 00:00:16,619
Yarra W and because some in our company
would like to break things

4
00:00:16,619 --> 00:00:20,980
a.m. and they liked breaker cluster
filesystem

5
00:00:20,980 --> 00:00:24,260
a.m. from IBM which which is quite funny
and

6
00:00:24,260 --> 00:00:28,390
yesterday in the evening I was talking
to these both drive picasso

7
00:00:28,390 --> 00:00:32,360
rocking on the laptop it is was like ok
ok we have to finish all slights

8
00:00:32,360 --> 00:00:35,660
show up for the top for the talk
tomorrow a

9
00:00:35,660 --> 00:00:39,560
a.m. flow wall so I'm so orders to tell
me

10
00:00:39,560 --> 00:00:42,760
a.m. the last changes he did for worth

11
00:00:42,760 --> 00:00:46,640
about 10 minutes ago or so that's kind
of you into a record from

12
00:00:46,640 --> 00:00:50,140
for yard w/ a.m. so let off fwy from

13
00:00:50,140 --> 00:00:57,140
if it helps some some well thanks sooo

14
00:00:59,430 --> 00:01:04,299
hi everybody here strongly on Xilinx
we're going to talk about IBM's GPFS

15
00:01:04,299 --> 00:01:07,880
we called this talk General Paul can
fire system

16
00:01:07,880 --> 00:01:12,970
amo the alternative was general upon up
a filesystem

17
00:01:12,970 --> 00:01:16,300
but we thought that and you will see
this in a minute the

18
00:01:16,300 --> 00:01:19,530
where so many structural and
architectural prom problems

19
00:01:19,530 --> 00:01:23,930
in GPFS that we thought they'd general
Pocan 5 system

20
00:01:23,930 --> 00:01:27,890
is a the better approach for now so um

21
00:01:27,890 --> 00:01:30,620
this is what we're going to talk about
we're going to give you a technology

22
00:01:30,620 --> 00:01:32,540
overview of her what GPFS

23
00:01:32,540 --> 00:01:37,670
yes what it does how to setup I'm we're
going to a dick into the Gulf GPFS

24
00:01:37,670 --> 00:01:42,470
because we hatched tour um it turned out
that we had found a vulnerability that

25
00:01:42,470 --> 00:01:44,870
at first glance looked like it was

26
00:01:44,870 --> 00:01:50,170
easily exploitable and a yeah so we're
going into detail with that it wasn't

27
00:01:50,170 --> 00:01:52,160
that easy to exploit I can

28
00:01:52,160 --> 00:01:55,610
tell you that for now then we're going
to take a look at the remote if you are

29
00:01:55,610 --> 00:01:57,860
an attack us remote view of GPFS

30
00:01:57,860 --> 00:02:01,550
and after that we are getting to the car
I'm not going to say

31
00:02:01,550 --> 00:02:04,980
any details about that now and after
what we will have a Q&A session where

32
00:02:04,980 --> 00:02:06,240
you can ask questions

33
00:02:06,240 --> 00:02:12,030
I okay so let's start soul IBM's general
parallel file system is the real name

34
00:02:12,030 --> 00:02:15,720
and it's a class to fight system and if
you're going at it in a bit

35
00:02:15,720 --> 00:02:19,460
other features include that is fast
simple and two scaleable

36
00:02:19,460 --> 00:02:22,500
saw um basically you can think about it

37
00:02:22,500 --> 00:02:26,930
of multiple notes that get
interconnected and a shout that out how

38
00:02:26,930 --> 00:02:27,950
over the network

39
00:02:27,950 --> 00:02:32,150
and to about two main operating moments
one is the notes

40
00:02:32,150 --> 00:02:35,150
are connected to a San and the other one
is

41
00:02:35,150 --> 00:02:38,800
that there's some kind of network share
disc which means that that this

42
00:02:38,800 --> 00:02:43,560
attached two more the the notes and they
get shared among the whole so you can

43
00:02:43,560 --> 00:02:45,910
access the data from one of the other

44
00:02:45,910 --> 00:02:49,090
um and not at if

45
00:02:49,090 --> 00:02:52,810
different operating systems are
supported by GPFS um

46
00:02:52,810 --> 00:02:57,190
we are going to look at the Linux
version and the Russian GPFS

47
00:02:57,190 --> 00:03:01,459
3.5 um GPFS has a really long history

48
00:03:01,459 --> 00:03:06,600
if you look at the the binary some of
the binary is they all start with TS

49
00:03:06,600 --> 00:03:10,640
or MMF ass TS stands for tiger shark

50
00:03:10,640 --> 00:03:13,739
which action already sounds quite
aggressive

51
00:03:13,739 --> 00:03:18,900
and problematic maybe a tiger shark and
tiger shark is a fight system

52
00:03:18,900 --> 00:03:23,050
that came out in nineteen ninety-three
so we're talking about a technology that

53
00:03:23,050 --> 00:03:23,730
is quite

54
00:03:23,730 --> 00:03:27,780
also under the hood many of the common
components that on the whole are

55
00:03:27,780 --> 00:03:31,310
really really old I'm core users at many
so comp

56
00:03:31,310 --> 00:03:35,310
supercomputers use it as combat fighting
system to classify system

57
00:03:35,310 --> 00:03:39,530
and in class to architecture it is quite
widely used

58
00:03:39,530 --> 00:03:44,110
um for looking at about the components
that you have

59
00:03:44,110 --> 00:03:49,480
when you will need to run a GPFS system
GPFS cluster system

60
00:03:49,480 --> 00:03:53,989
you will have three main components to
say so you have to use a space utility s

61
00:03:53,989 --> 00:03:58,760
there are a lot of binary is I'm laying
around on the filesystem the of shell

62
00:03:58,760 --> 00:03:59,430
scripts

63
00:03:59,430 --> 00:04:04,220
a big shout scripts among some of the
buyer is I just linked to each other

64
00:04:04,220 --> 00:04:09,160
and depending on which name they have
they execute different code paths

65
00:04:09,160 --> 00:04:12,710
and they are some said you ID binary is
true which is

66
00:04:12,710 --> 00:04:16,120
quite interesting for us and then we
have a communication demand the

67
00:04:16,120 --> 00:04:19,799
communication daemon is running on all
of the hosts the future communicated in

68
00:04:19,799 --> 00:04:20,640
the class to

69
00:04:20,640 --> 00:04:23,690
and they use a proprietary communication
protocol which

70
00:04:23,690 --> 00:04:26,990
is used by a TCP and we have a can on
what your

71
00:04:26,990 --> 00:04:30,250
the scanner module is only supply binary
only and they have

72
00:04:30,250 --> 00:04:34,420
written about how module where the sauce
code is available we don't know why this

73
00:04:34,420 --> 00:04:35,950
is so maybe this a strong

74
00:04:35,950 --> 00:04:39,760
GPL of we have no idea um

75
00:04:39,760 --> 00:04:44,090
saw we need you to remember this
structure this threefold structure so we

76
00:04:44,090 --> 00:04:45,980
have to choose a space utility is

77
00:04:45,980 --> 00:04:49,550
we have a communication demand and we
have the condo module

78
00:04:49,550 --> 00:04:52,570
okay so let's start with

79
00:04:52,570 --> 00:04:56,990
the use the space by various so digging
into the guts of GPFS

80
00:04:56,990 --> 00:05:02,520
was are possible for us because it we
encountered during a penetration test

81
00:05:02,520 --> 00:05:06,620
and watcha doing during a penetration
test when you need to get local rule

82
00:05:06,620 --> 00:05:08,960
works on the system you need to an image
a privilege us

83
00:05:08,960 --> 00:05:12,160
the first one of the first thing that
you do is look at such a wide binaries

84
00:05:12,160 --> 00:05:14,030
that are on the system into and that

85
00:05:14,030 --> 00:05:18,320
you don't know because maybe there is an
attack surface and maybe you can

86
00:05:18,320 --> 00:05:22,300
I actually about an image a privilege
just depending on how the utilities work

87
00:05:22,300 --> 00:05:25,680
so in this case this is an incomplete
and ass over the

88
00:05:25,680 --> 00:05:29,750
more of two hundred binary is of that
come with a GPFS

89
00:05:29,750 --> 00:05:34,250
and all the ones that are rock marked in
red are quite interesting because these

90
00:05:34,250 --> 00:05:38,620
are the sexual I D binary is that we
have been looking into all some of them

91
00:05:38,620 --> 00:05:43,910
I'm saw one binary came to our attention
and is called TS

92
00:05:43,910 --> 00:05:48,520
state us and this basically Prince some
status information about the fight

93
00:05:48,520 --> 00:05:49,090
system

94
00:05:49,090 --> 00:05:53,229
I saw if you have this binary if it sent
you idea

95
00:05:53,229 --> 00:06:00,040
as a penetration test our what do you do
first yeah I'm

96
00:06:00,040 --> 00:06:01,889
sorry you're involved

97
00:06:01,889 --> 00:06:05,189
for the first to talk but yeah what do
you do

98
00:06:05,189 --> 00:06:08,949
so your feet up some garbage right okay
so she did a bunch of

99
00:06:08,949 --> 00:06:12,249
Aissa something to see if there's a
buffer overflow and if the application

100
00:06:12,249 --> 00:06:13,629
crashes or something

101
00:06:13,629 --> 00:06:16,889
that wasn't feasible I'm grief fed up
some

102
00:06:16,889 --> 00:06:21,180
some like thousand anus and then there
was an error message we stayed at hey

103
00:06:21,180 --> 00:06:27,080
a value the across the filename can only
be more or can only be less than 500

104
00:06:27,080 --> 00:06:28,870
front fight so out of the box

105
00:06:28,870 --> 00:06:32,749
navajo of Lodi what else can you do
especially when you look at this

106
00:06:32,749 --> 00:06:37,020
salty a Statehouse news are supplied in
Port user-supplied input is coming out

107
00:06:37,020 --> 00:06:37,580
there

108
00:06:37,580 --> 00:06:40,659
format string all very good

109
00:06:40,659 --> 00:06:45,060
yeah so we tried that and if you look at
it perfect there seems to be a format

110
00:06:45,060 --> 00:06:46,060
string vulnerability

111
00:06:46,060 --> 00:06:49,069
because we're feeding and a percent X
and what

112
00:06:49,069 --> 00:06:52,319
percent eggs Das's if you're not using

113
00:06:52,319 --> 00:06:57,180
print of the printer family in a correct
way it's basically a prince one when you

114
00:06:57,180 --> 00:06:57,539
off

115
00:06:57,539 --> 00:07:01,900
stack so here we go we have now a value
of the specs so it's not showing percent

116
00:07:01,900 --> 00:07:02,240
X

117
00:07:02,240 --> 00:07:06,099
anymore and its showing something like
an address or something

118
00:07:06,099 --> 00:07:09,210
and this really looks like a simple
playing

119
00:07:09,210 --> 00:07:12,300
all and a format string vulnerability

120
00:07:12,300 --> 00:07:15,610
I'm some by playing around with it um

121
00:07:15,610 --> 00:07:19,069
we have definitely found it is
vulnerable to a format string and Saul

122
00:07:19,069 --> 00:07:23,669
we could dump values from the stack I'm
not when we're using percent and we

123
00:07:23,669 --> 00:07:23,990
could

124
00:07:23,990 --> 00:07:27,610
do with segmentation fault in the binary
because with percent and

125
00:07:27,610 --> 00:07:31,409
attacking a format string vulnerability
you basically a ride

126
00:07:31,409 --> 00:07:35,560
value or to an arbitrary memory address
and in this case that led to a

127
00:07:35,560 --> 00:07:38,219
segmentation fault in the Pirates your
status

128
00:07:38,219 --> 00:07:42,050
and then we encountered something that
made but

129
00:07:42,050 --> 00:07:46,139
the bay just very far like 12 minutes
but we didn't think about it

130
00:07:46,139 --> 00:07:50,430
when we're just percent ass we got this
message

131
00:07:50,430 --> 00:07:55,949
lost connection to the filesystem demand
saw the MMF

132
00:07:55,949 --> 00:07:59,389
SD man up to educate SD man crashed

133
00:07:59,389 --> 00:08:02,800
and the company 5 system went away so

134
00:08:02,800 --> 00:08:07,289
we were thinking about this we couldn't
come up with an idea why this this but

135
00:08:07,289 --> 00:08:09,319
we thought well let's move on

136
00:08:09,319 --> 00:08:12,319
arm resubmit its arm

137
00:08:12,319 --> 00:08:15,490
the the vulnerability and a proof of
concept to IBM

138
00:08:15,490 --> 00:08:19,439
I we thought it's this clearly
exploitable this should not be a hassle

139
00:08:19,439 --> 00:08:21,669
it's a standard format string
vulnerability year

140
00:08:21,669 --> 00:08:25,740
a should be pretty straightforward we
were thinking all the time okay but why

141
00:08:25,740 --> 00:08:27,469
did the five system team a crash in

142
00:08:27,469 --> 00:08:30,550
we couldn't come up with an with an idea
um

143
00:08:30,550 --> 00:08:34,519
after few weeks a IBM acknowledged of
sand

144
00:08:34,519 --> 00:08:37,719
percent of the CVG and they stated a

145
00:08:37,719 --> 00:08:42,709
because our POC obviously was not a
remote host code execution or call to

146
00:08:42,709 --> 00:08:43,880
lock a code execution

147
00:08:43,880 --> 00:08:48,440
and they stated that this is basically
just a security vulnerability year that

148
00:08:48,440 --> 00:08:50,320
results in a denial-of-service

149
00:08:50,320 --> 00:08:54,639
um a good condition and it has not yet

150
00:08:54,639 --> 00:08:58,839
which is interesting because yeah at
this point it was really not yet

151
00:08:58,839 --> 00:09:03,490
shown to cause any other effects besides
the program terminating

152
00:09:03,490 --> 00:09:07,639
and if your security reach a the
research and Eunice

153
00:09:07,639 --> 00:09:11,180
ready and you weeks such kind of an
advisory am

154
00:09:11,180 --> 00:09:14,589
and you read the worst said you ID com
on than you think

155
00:09:14,589 --> 00:09:20,149
a yes challenge accepted it's not proven
to be a exploitable right now

156
00:09:20,149 --> 00:09:24,220
and a Sony denial-of-service condition
and so we called and no one told

157
00:09:24,220 --> 00:09:27,639
maybe we have a nice talk for g4 for for
troop us

158
00:09:27,639 --> 00:09:32,329
and I we called him up inside like maybe
we should put this on the agenda this

159
00:09:32,329 --> 00:09:35,470
thus might mike Beebe interesting and

160
00:09:35,470 --> 00:09:40,269
so we started a investigating the
exploit so it was research time for us

161
00:09:40,269 --> 00:09:44,139
we were just using our standard to
rescue GB running

162
00:09:44,139 --> 00:09:48,630
we're looking at all the binary was
behaving when sending percent and when

163
00:09:48,630 --> 00:09:49,860
dumping the stack

164
00:09:49,860 --> 00:09:53,690
um it pretty much set for what looked
like

165
00:09:53,690 --> 00:09:58,510
a still looked like a a a format string
vulnerability as you can see here

166
00:09:58,510 --> 00:10:02,760
and two we still had no clue why the
fine system actually is crushing

167
00:10:02,760 --> 00:10:06,529
crashing when you are amusing percent s

168
00:10:06,529 --> 00:10:11,699
saw what we did to get a little bit more
of understanding on how the binary works

169
00:10:11,699 --> 00:10:15,470
um we use test race and just took a look
at it

170
00:10:15,470 --> 00:10:19,579
because idk actually at this point of
time we wear like desperate because we

171
00:10:19,579 --> 00:10:22,250
couldn't exploit the format string
vulnerability is for

172
00:10:22,250 --> 00:10:23,930
multiple reasons me we we have

173
00:10:23,930 --> 00:10:27,279
nope no why so the moment per se just
just didn't work

174
00:10:27,279 --> 00:10:32,540
we have no clue why so we lost as trace
and called state us the taster that your

175
00:10:32,540 --> 00:10:33,529
status binary

176
00:10:33,529 --> 00:10:37,410
fed up some things are supplied in part
so and this is what what basically

177
00:10:37,410 --> 00:10:39,339
happened for the user cost his state us

178
00:10:39,339 --> 00:10:43,200
testator's points to a random TCP port

179
00:10:43,200 --> 00:10:47,370
on all interfaces okay so the usual
stuff the binary

180
00:10:47,370 --> 00:10:51,089
from the binary trees and some random
part it opens up this part

181
00:10:51,089 --> 00:10:54,790
then just ate a sense the park number

182
00:10:54,790 --> 00:10:58,029
and the user the supplied user input
using

183
00:10:58,029 --> 00:11:03,230
local message shoe soul user input goes
into the mess it's true

184
00:11:03,230 --> 00:11:06,320
park is open than the filesystem

185
00:11:06,320 --> 00:11:10,570
grass some stuff out of the message
queue as we found out later

186
00:11:10,570 --> 00:11:13,820
connect to this part to the supply TCP
part

187
00:11:13,820 --> 00:11:17,450
and 7th the power of interpreter for
Assad's

188
00:11:17,450 --> 00:11:21,200
back to the to your status binary and
then

189
00:11:21,200 --> 00:11:24,850
tea estate is basically Prince
everything so okay looking

190
00:11:24,850 --> 00:11:27,990
at a glance looking at t'as trace

191
00:11:27,990 --> 00:11:32,140
nice architecture looks quite
interesting

192
00:11:32,140 --> 00:11:36,420
okay but why does the five system
democrats so if you look

193
00:11:36,420 --> 00:11:39,470
and want to send over the socket so this
iz

194
00:11:39,470 --> 00:11:44,390
are basically year arm the stuff from s
tracer see right here so yes you read

195
00:11:44,390 --> 00:11:48,880
so we see that we are receiving some
stuff and then that tour things

196
00:11:48,880 --> 00:11:52,709
that should come to your attention when
when when seeing this at the first thing

197
00:11:52,709 --> 00:11:54,630
is the last line just chose house

198
00:11:54,630 --> 00:11:58,779
at the message that is displayed for
this is something that your status

199
00:11:58,779 --> 00:12:00,100
rights out to the show

200
00:12:00,100 --> 00:12:04,070
the previous are almost detector or or
or the file system relies too much on

201
00:12:04,070 --> 00:12:04,790
whatever

202
00:12:04,790 --> 00:12:09,760
and the second thing is but this is thus
the stringing that we are printing out

203
00:12:09,760 --> 00:12:10,230
should

204
00:12:10,230 --> 00:12:14,350
be um actually giving the the socket
communication

205
00:12:14,350 --> 00:12:19,160
and some parts of it are in the socket
communication but if you close need

206
00:12:19,160 --> 00:12:24,470
read and look you see that the sock over
the socket from the file system daemon

207
00:12:24,470 --> 00:12:27,850
we see that there is a format string
hand

208
00:12:27,850 --> 00:12:31,770
I see many questions haha

209
00:12:31,770 --> 00:12:34,690
best action you how we looked at as we
have seen it because

210
00:12:34,690 --> 00:12:38,120
am we would have respected that there
was just the string

211
00:12:38,120 --> 00:12:41,640
and the string is received about the
networking is printed out but in this

212
00:12:41,640 --> 00:12:44,240
case the filesystem demand a stop just
sending

213
00:12:44,240 --> 00:12:47,300
the recited back to the binary it is
sending

214
00:12:47,300 --> 00:12:50,830
a format string to the binary and

215
00:12:50,830 --> 00:12:53,940
the corresponding spec for it

216
00:12:53,940 --> 00:12:57,330
nice

217
00:12:57,330 --> 00:13:03,260
because Nole we found out why actually
the filesystem demand is crashing

218
00:13:03,260 --> 00:13:07,810
soul here a point for the fight system
daemon is connecting back to us

219
00:13:07,810 --> 00:13:11,180
and it's ending the results back to
reside is a format string plus the

220
00:13:11,180 --> 00:13:12,570
corresponding stack

221
00:13:12,570 --> 00:13:15,830
and if you send a percent s I'm

222
00:13:15,830 --> 00:13:19,170
just a crash in on the filesystem
demand-side hey this

223
00:13:19,170 --> 00:13:22,720
and it just simply crashes so this is
the denial of service

224
00:13:22,720 --> 00:13:26,880
scenario that we investigated okay so
now with this knowledge

225
00:13:26,880 --> 00:13:30,300
we now own all that we actually

226
00:13:30,300 --> 00:13:34,050
as the attack happened maybe possum may
be able to or

227
00:13:34,050 --> 00:13:37,460
to pass our import and are stacked with
the binary

228
00:13:37,460 --> 00:13:41,800
soul from we could send our own format
string

229
00:13:41,800 --> 00:13:44,870
with a completely controlled stack over
the network

230
00:13:44,870 --> 00:13:48,770
and def a code execution should be
possible because we had full control of

231
00:13:48,770 --> 00:13:50,080
the fact that we're sending

232
00:13:50,080 --> 00:13:53,660
and read for for control of the arm for
much from our ability

233
00:13:53,660 --> 00:13:57,170
but that would challenge us one
challenges as I said

234
00:13:57,170 --> 00:14:00,790
it's a random part that will be open so
how do you get to that part to do

235
00:14:00,790 --> 00:14:02,530
something to speak to the binary

236
00:14:02,530 --> 00:14:05,750
and speed is an issue too because

237
00:14:05,750 --> 00:14:08,880
once you know which kind of part to
connect or

238
00:14:08,880 --> 00:14:12,950
you need to make sure that you are at
the first one and not the fight system

239
00:14:12,950 --> 00:14:15,270
came in so you need to be fast in doing
this

240
00:14:15,270 --> 00:14:18,589
saw for the first point

241
00:14:18,589 --> 00:14:23,390
all the wrong random part problem we did
some i dont get some reverse engineering

242
00:14:23,390 --> 00:14:26,780
and did some strings over the binary and
we found out that there is

243
00:14:26,780 --> 00:14:31,470
an environment variable which states
GPFS com on POF range

244
00:14:31,470 --> 00:14:35,209
and this is basically an environment
variable test your status

245
00:14:35,209 --> 00:14:38,270
to use this part instead of a random pot
okay

246
00:14:38,270 --> 00:14:41,480
fine now we solve the problem of having
the random part

247
00:14:41,480 --> 00:14:44,980
perfect and now we have this race
condition right

248
00:14:44,980 --> 00:14:49,019
yeah the problem is that in our initial
setup with other documents machines that

249
00:14:49,019 --> 00:14:49,920
we had running

250
00:14:49,920 --> 00:14:53,440
with the problem that we did not bring
the race we even came up with

251
00:14:53,440 --> 00:14:57,820
some a obscure sick or to try to win the
race

252
00:14:57,820 --> 00:15:01,089
against the filesystem demand and it
didn't work out and I don't know if

253
00:15:01,089 --> 00:15:04,790
Frank's here but if you're if he's here
thank you frank because he said like

254
00:15:04,790 --> 00:15:09,500
a your Dom just takes two CPUs for the
VM and that should do it

255
00:15:09,500 --> 00:15:12,829
and actually we did that and then we
were fast enough to win the race

256
00:15:12,829 --> 00:15:16,230
so from and even like I think that you
Java

257
00:15:16,230 --> 00:15:19,389
would have determined the race so we
were quite fast

258
00:15:19,389 --> 00:15:23,529
by the time so winning the race
condition is no problem anymore

259
00:15:23,529 --> 00:15:28,850
so now at this point we know the part to
connect what we can win the race to dump

260
00:15:28,850 --> 00:15:31,949
anything into the binary that we want
our custom stack

261
00:15:31,949 --> 00:15:35,180
and the the format string and

262
00:15:35,180 --> 00:15:37,740
the other thing that we need to care
about us is there some kind of

263
00:15:37,740 --> 00:15:40,570
authentication so can we just talk to it
and that's it

264
00:15:40,570 --> 00:15:44,329
I'm looking at the binary found out that
there's some sort of cookie when you

265
00:15:44,329 --> 00:15:46,290
that is checked before doing anything

266
00:15:46,290 --> 00:15:49,630
and I it turns out that this is actually
did the

267
00:15:49,630 --> 00:15:52,899
process ID of tea estate us so if you're
running

268
00:15:52,899 --> 00:15:56,420
to your state us than you would have to
10 it the process ID

269
00:15:56,420 --> 00:16:00,220
and if this process ID is the same than
to just a just

270
00:16:00,220 --> 00:16:03,800
would let you in to say so okay

271
00:16:03,800 --> 00:16:08,050
soul what to do or by exploiting this

272
00:16:08,050 --> 00:16:12,970
yes the first part would be except the
environment mara variable

273
00:16:12,970 --> 00:16:16,990
win the race send the pit of tea estate
us

274
00:16:16,990 --> 00:16:20,670
and the second part get code execution
because you control the spec

275
00:16:20,670 --> 00:16:23,940
your performance reliability it should
be easy saw

276
00:16:23,940 --> 00:16:27,699
at the problem um with

277
00:16:27,699 --> 00:16:30,779
a during this all be encountered some
some additional

278
00:16:30,779 --> 00:16:34,579
a problems and some additional stuff
that helped us out for some

279
00:16:34,579 --> 00:16:38,569
the binary is not high on a bird which
means it had constant addresses which is

280
00:16:38,569 --> 00:16:39,319
quite got

281
00:16:39,319 --> 00:16:43,990
I the system libraries referendum I
asked which is bad and what you normally

282
00:16:43,990 --> 00:16:45,010
would do more

283
00:16:45,010 --> 00:16:48,089
um when you have a format string
vulnerability

284
00:16:48,089 --> 00:16:51,850
you were just jusen in for Nick so
remember that percent

285
00:16:51,850 --> 00:16:57,410
axe gives you values from the stack and
if you are

286
00:16:57,410 --> 00:17:01,070
that might be a chance that dumping
multiple values from the check from from

287
00:17:01,070 --> 00:17:01,560
the stack

288
00:17:01,560 --> 00:17:05,980
will give you a pointer to somewhere and
from this point on you can calculate

289
00:17:05,980 --> 00:17:09,340
your offsets and then rights to the
address a

290
00:17:09,340 --> 00:17:12,350
that for two new tool ride so and
informatique

291
00:17:12,350 --> 00:17:16,690
actually was not possible in this case
because it was our spec

292
00:17:16,690 --> 00:17:20,350
so the stack between we control the
stack and we're sending the stock over

293
00:17:20,350 --> 00:17:21,460
the network basically

294
00:17:21,460 --> 00:17:26,210
so there's no point in dumping spec out
of the a binary with the percent X

295
00:17:26,210 --> 00:17:29,870
because this is not working because it's
all stacked so in four league is not

296
00:17:29,870 --> 00:17:30,720
possible which

297
00:17:30,720 --> 00:17:34,050
makes things a little bit harder um

298
00:17:34,050 --> 00:17:38,700
we went on to overwriting global of the
tables that worked out pretty well

299
00:17:38,700 --> 00:17:41,910
um we had a some

300
00:17:41,910 --> 00:17:45,340
problems that too actually this was
actually the point where

301
00:17:45,340 --> 00:17:50,020
and was like okay so how far are you a
harvard is the exploit isn't working is

302
00:17:50,020 --> 00:17:52,870
it reliable and actually when I could
have whether it's not that

303
00:17:52,870 --> 00:17:54,040
straightforward

304
00:17:54,040 --> 00:17:57,370
and we might need to didn't I am but
everything will be fine

305
00:17:57,370 --> 00:18:00,410
um yup saw

306
00:18:00,410 --> 00:18:03,650
what do you do when overwriting the
global off the table is nominee that you

307
00:18:03,650 --> 00:18:05,800
need to find a library function that is
called

308
00:18:05,800 --> 00:18:09,690
after the format string is triggered so
what you do is

309
00:18:09,690 --> 00:18:13,110
the promise ring is triggered with this
format string you override

310
00:18:13,110 --> 00:18:16,500
the problem of the table and override
function pointer

311
00:18:16,500 --> 00:18:19,540
which real then point to your obtain

312
00:18:19,540 --> 00:18:22,670
but you would have to you was in this
case the problem

313
00:18:22,670 --> 00:18:26,390
loss bet we had a spare small binary im

314
00:18:26,390 --> 00:18:29,850
and there was no reproducible spec
people are available at this time

315
00:18:29,850 --> 00:18:33,230
um so we came up with the idea okay so
just

316
00:18:33,230 --> 00:18:36,540
override the library function with the
different functions some

317
00:18:36,540 --> 00:18:41,240
don't let it point to the rock chain but
let the pointer for example system

318
00:18:41,240 --> 00:18:45,190
or some kind of XI call I turns out that
even is

319
00:18:45,190 --> 00:18:49,740
a annex a call in the binary a about the
problem is

320
00:18:49,740 --> 00:18:54,280
that it is it was not compatible because
we were using F protest all the time

321
00:18:54,280 --> 00:18:58,080
and from system or accept that we could
have your worst

322
00:18:58,080 --> 00:19:01,400
once a string and a friend of the first
paramedics after enough

323
00:19:01,400 --> 00:19:05,460
is actually a pointer to a file I guess
and that this will not work out

324
00:19:05,460 --> 00:19:08,740
I've so we we we could not achieve code
execution

325
00:19:08,740 --> 00:19:11,760
this so everything gets harder and
harder

326
00:19:11,760 --> 00:19:15,530
and harder but never give up

327
00:19:15,530 --> 00:19:19,520
there's an alternative approach that we
found out we were looking at the message

328
00:19:19,520 --> 00:19:21,210
types that you consent

329
00:19:21,210 --> 00:19:24,360
action in these are the message types
but them

330
00:19:24,360 --> 00:19:27,580
IMF St year will be sending so

331
00:19:27,580 --> 00:19:30,690
Jokerit have a message type like display

332
00:19:30,690 --> 00:19:34,940
a message give a general our our and
then we found out that there is a

333
00:19:34,940 --> 00:19:36,200
message type which is called

334
00:19:36,200 --> 00:19:40,170
added message okay so what does this
through

335
00:19:40,170 --> 00:19:43,640
saw basically if what it does yes

336
00:19:43,640 --> 00:19:48,420
the server sends the Edit message to the
two-year state of binary

337
00:19:48,420 --> 00:19:52,260
with arbiter a text context content I'm

338
00:19:52,260 --> 00:19:55,390
then there is an environment variable
which is called edit or

339
00:19:55,390 --> 00:19:59,510
if this is not bad to falls through VI
and what happens

340
00:19:59,510 --> 00:20:03,679
is that a common plan to writes the
contents to a temporary file

341
00:20:03,679 --> 00:20:07,420
drops the privilege us which you can see
right here

342
00:20:07,420 --> 00:20:12,210
and then opens the edit or specified and
the environment variable

343
00:20:12,210 --> 00:20:15,840
so we have some sort of injection point
into

344
00:20:15,840 --> 00:20:19,050
and expect call right hip so the user

345
00:20:19,050 --> 00:20:22,230
in the mall okay scan added the higher

346
00:20:22,230 --> 00:20:26,250
so it's like really you're sending this
year according to your status than VI

347
00:20:26,250 --> 00:20:28,059
pops up you can edit the message

348
00:20:28,059 --> 00:20:32,390
save it close the Edit are and the data
sent back to the Sala

349
00:20:32,390 --> 00:20:35,679
saw what we did now

350
00:20:35,679 --> 00:20:40,929
is rejoiced this or or and kinda
injection to say so in 20 this

351
00:20:40,929 --> 00:20:44,590
except caller combined with hour format
string

352
00:20:44,590 --> 00:20:48,429
attack soul we sent three messages

353
00:20:48,429 --> 00:20:51,920
the first to message us trigger the
format string vulnerability

354
00:20:51,920 --> 00:20:54,970
oneness overwriting said group idea

355
00:20:54,970 --> 00:20:58,720
one is overriding said you idea with the
address of a rat

356
00:20:58,720 --> 00:21:01,820
which basically year rend us

357
00:21:01,820 --> 00:21:06,110
the said you ID's down here as a not

358
00:21:06,110 --> 00:21:11,410
so be alright inside grew by Dean said
you ready with a return address on

359
00:21:11,410 --> 00:21:12,309
nothing happens

360
00:21:12,309 --> 00:21:17,440
right there and Dan in the first message
we triggered the edit message function

361
00:21:17,440 --> 00:21:21,230
as an edit all we specify

362
00:21:21,230 --> 00:21:25,049
Hall and the content that we control

363
00:21:25,049 --> 00:21:30,620
is something like this so this is
basically our show coat that we are

364
00:21:30,620 --> 00:21:31,799
passing to pala

365
00:21:31,799 --> 00:21:36,360
tea estate us actually thinks yeah well
this is an edit all its open it up

366
00:21:36,360 --> 00:21:40,049
it's called Paul let's open it and
that's possible this cold

367
00:21:40,049 --> 00:21:43,520
and then basically pol does it started
chop

368
00:21:43,520 --> 00:21:47,220
soul we have a demo demos always on your
right

369
00:21:47,220 --> 00:21:50,169
so what you see right here is the
democrats what you see how to use the

370
00:21:50,169 --> 00:21:50,809
slights

371
00:21:50,809 --> 00:21:55,520
so to add her to the park from script on
the left role is presently do the script

372
00:21:55,520 --> 00:21:59,820
trying to redress condition so when just
can start to script

373
00:21:59,820 --> 00:22:03,870
which grew just loop on to something
happens and then we have to nice and

374
00:22:03,870 --> 00:22:06,070
location of does that to you again by
knowing

375
00:22:06,070 --> 00:22:11,110
using construe environment variables and
we can see a lot of of harming stringed

376
00:22:11,110 --> 00:22:14,750
Tom to the output and no you should see
who'd show

377
00:22:14,750 --> 00:22:21,750
so if I and ID user you can see we don't
yeah

378
00:22:26,630 --> 00:22:29,090
yeah so that worked out perfectly

379
00:22:29,090 --> 00:22:32,470
soul um yep

380
00:22:32,470 --> 00:22:36,330
we actually resubmitted the spot and
Nole

381
00:22:36,330 --> 00:22:41,710
the CVSS is increased little bit from
for up to six point nine

382
00:22:41,710 --> 00:22:45,570
and yeah actually acknowledge that it is
exploitable

383
00:22:45,570 --> 00:22:51,510
soul remember this structure we are at
the userspace utilities chapter

384
00:22:51,510 --> 00:22:54,520
we have a local privilege escalation now
we are former

385
00:22:54,520 --> 00:22:58,650
string and whatever hybrids

386
00:22:58,650 --> 00:23:03,860
injection exploits and so we have solved
our first challenge

387
00:23:03,860 --> 00:23:08,370
and for the next part fix is going to ok
a thorough

388
00:23:08,370 --> 00:23:12,650
respect too much time working on some
kind of our midstream wanna blue tunes

389
00:23:12,650 --> 00:23:16,049
so I was kind of moderate control rear a
kind of money rated

390
00:23:16,049 --> 00:23:19,660
to look into other parts of the system
as well so

391
00:23:19,660 --> 00:23:22,750
I'm the problem was to come to exploit

392
00:23:22,750 --> 00:23:27,590
basically is a we have a local privilege
escalation on one system

393
00:23:27,590 --> 00:23:31,410
but we might also want to compromise
other nodes in the cluster

394
00:23:31,410 --> 00:23:35,330
so we might be lucky on fine love one
ability that allows

395
00:23:35,330 --> 00:23:38,590
escalation from 10 to close to two
different note left

396
00:23:38,590 --> 00:23:43,620
where I'm it seems to be the case if you
look at the documentation

397
00:23:43,620 --> 00:23:47,640
that a prerequisite of IBM GPFS

398
00:23:47,640 --> 00:23:51,250
is actually that you are able to ssh
from

399
00:23:51,250 --> 00:23:54,450
OneNote in the class to to all other
modes in the cluster

400
00:23:54,450 --> 00:23:58,169
roof to root user ID revolved passport

401
00:23:58,169 --> 00:24:01,880
so if you own one note you own all of
them

402
00:24:01,880 --> 00:24:05,919
plant so we don't even need some kind of

403
00:24:05,919 --> 00:24:09,040
exploits or Park stripped of something
like this

404
00:24:09,040 --> 00:24:13,559
to hack built-in functionality for both
so there's the mnts

405
00:24:13,559 --> 00:24:16,780
age comment were just a distant YouTube
showed both of you

406
00:24:16,780 --> 00:24:19,970
and you give it a list of notes and a
comment

407
00:24:19,970 --> 00:24:23,950
and then you can see you execute comment
on all of these notes were from

408
00:24:23,950 --> 00:24:27,929
group of course is only possible if
ruled on a single note

409
00:24:27,929 --> 00:24:30,929
so

410
00:24:30,929 --> 00:24:34,150
we still have an open question what
happens if your computer from the

411
00:24:34,150 --> 00:24:35,240
outside so you don't

412
00:24:35,240 --> 00:24:39,440
yacht don't have local account on any
systems in fact a cluster you only have

413
00:24:39,440 --> 00:24:40,450
I hope you trust

414
00:24:40,450 --> 00:24:43,520
of one of customs well

415
00:24:43,520 --> 00:24:46,679
we already talked about this mm FST do

416
00:24:46,679 --> 00:24:51,520
5 system daemon of to PFS if the main
network team in order only make pokemon

417
00:24:51,520 --> 00:24:53,270
use by those heights system

418
00:24:53,270 --> 00:24:56,970
and admissions on 23 pop peapod 1191

419
00:24:56,970 --> 00:25:01,850
and interesting figures it's listening
on every interface by default

420
00:25:01,850 --> 00:25:05,929
so you can imagine if you have a
supercomputer wear flack dozens of

421
00:25:05,929 --> 00:25:07,169
network interfaces

422
00:25:07,169 --> 00:25:11,120
a probably only a couple of days I
actually used for

423
00:25:11,120 --> 00:25:16,260
GPFS communication but by default you
PFS is happy to listen on all of his

424
00:25:16,260 --> 00:25:17,049
interface

425
00:25:17,049 --> 00:25:20,210
so of course this is an interesting
attack suffix

426
00:25:20,210 --> 00:25:25,539
not a GPFS humanness mainly used for
class to communication so for

427
00:25:25,539 --> 00:25:27,779
communication between nodes in the
cluster

428
00:25:27,779 --> 00:25:30,870
and for synchronization of to stage and

429
00:25:30,870 --> 00:25:35,720
also for netbooks at discs so if you
have a desktop is only attached to them

430
00:25:35,720 --> 00:25:36,929
a note on the cluster

431
00:25:36,929 --> 00:25:40,169
alzheimer excess will be communicated
using

432
00:25:40,169 --> 00:25:44,760
Stephen I'd works by opening which
purpose trust in Chesapeake connection

433
00:25:44,760 --> 00:25:45,330
sodas

434
00:25:45,330 --> 00:25:49,330
too stupid connections will stay alive
for the whole lifetime of the cluster

435
00:25:49,330 --> 00:25:52,490
and I do case I'm that do not

436
00:25:52,490 --> 00:25:56,620
denotes a mainly exchanging heartbeat
messages so we are still alive

437
00:25:56,620 --> 00:26:00,210
and height synchronization forties not
pictured discs

438
00:26:00,210 --> 00:26:05,270
rant what's interesting if you left X
you look at this traffic on the lie also

439
00:26:05,270 --> 00:26:08,190
issue on a man in the middle position or
something like that

440
00:26:08,190 --> 00:26:12,340
you can see you don't the cluster
communication by default isn't and

441
00:26:12,340 --> 00:26:13,600
Krypton anyway

442
00:26:13,600 --> 00:26:17,970
so this is actually a file I wrote where
world had a trooper sanders is going

443
00:26:17,970 --> 00:26:20,250
over the network liked it so this

444
00:26:20,250 --> 00:26:23,890
something you have to keep in mind of
cost

445
00:26:23,890 --> 00:26:27,380
in a man on the middle a man in the
middle position we now would be able to

446
00:26:27,380 --> 00:26:27,890
like

447
00:26:27,890 --> 00:26:31,250
menu played this message context artery

448
00:26:31,250 --> 00:26:36,870
however of it might be the case that we
on the cluster system weather isn't

449
00:26:36,870 --> 00:26:40,030
any sensitive date of thought on this
network shot discs

450
00:26:40,030 --> 00:26:42,830
of the communication between a cluster
nodes

451
00:26:42,830 --> 00:26:46,850
might be actually a car on a private
interface which we don't actually use it

452
00:26:46,850 --> 00:26:49,980
so this is probably more realistic
attacked

453
00:26:49,980 --> 00:26:54,840
so it would be really nice to have
something like a remote exploit against

454
00:26:54,840 --> 00:26:55,110
a

455
00:26:55,110 --> 00:27:00,090
height system %um so we did some kind of
protocol on

456
00:27:00,090 --> 00:27:04,590
elisa's to understand how does thus
communication excuse

457
00:27:04,590 --> 00:27:09,370
and at the state from protocol so you
have like a processed in connection

458
00:27:09,370 --> 00:27:12,990
between a cluster nodes which starts
were hella packard

459
00:27:12,990 --> 00:27:16,669
and after both to exchange some 2.0
pickups likes

460
00:27:16,669 --> 00:27:21,400
one year seems like before SSL is
possible but as we said before not

461
00:27:21,400 --> 00:27:22,700
enabled by default

462
00:27:22,700 --> 00:27:25,860
for performance reasons I'm and

463
00:27:25,860 --> 00:27:28,960
because on two recent you to dance apart
activating it

464
00:27:28,960 --> 00:27:32,049
without rebooting overhauled restarting
the cluster

465
00:27:32,049 --> 00:27:36,770
so recall simply replace something be
captured to like

466
00:27:36,770 --> 00:27:41,320
trigger high right and start we have to
send a valid help pick up so we can

467
00:27:41,320 --> 00:27:44,929
create create develop connection now

468
00:27:44,929 --> 00:27:48,440
if you look at hello packard your future
couple of

469
00:27:48,440 --> 00:27:52,100
interesting looking troops if you of
Henry Lowood I P so this is

470
00:27:52,100 --> 00:27:55,860
only two teams to keep a note on this
important to start include

471
00:27:55,860 --> 00:27:59,470
and the lower layer protocols so would
basically

472
00:27:59,470 --> 00:28:03,179
one can see in this message format as
like a match a constant

473
00:28:03,179 --> 00:28:07,539
and with your IP addresses of two cost
and a destination node

474
00:28:07,539 --> 00:28:10,559
start inside to Chesapeake payload so

475
00:28:10,559 --> 00:28:14,409
just looks kind of strange in addition
we have time stamps

476
00:28:14,409 --> 00:28:18,970
a cluster ID date uniquely identifies a
certain class star

477
00:28:18,970 --> 00:28:22,360
and then you have to go reread your foot
I plan creditors

478
00:28:22,360 --> 00:28:27,120
for certain operations now we were what
10 wearing

479
00:28:27,120 --> 00:28:31,039
mortis to actually authentication for
this hella packed

480
00:28:31,039 --> 00:28:34,220
and as a ton out the idea of MMFs 10

481
00:28:34,220 --> 00:28:37,570
is don't only notes that apart a

482
00:28:37,570 --> 00:28:41,380
off to class though should be able to
put up a communication

483
00:28:41,380 --> 00:28:45,220
but the problem is just check if you are
part of the class to

484
00:28:45,220 --> 00:28:48,710
is based on the IP address of 2000 your
bet

485
00:28:48,710 --> 00:28:52,820
into detention camp a note so of cost

486
00:28:52,820 --> 00:28:56,970
you can threaten a spoof a valid know to
trust so you put like a ballot no

487
00:28:56,970 --> 00:28:59,150
titsworth inside to TCP payload

488
00:28:59,150 --> 00:29:02,240
and done can communicate as part of the
class

489
00:29:02,240 --> 00:29:06,090
of Costas open slacker extremely large

490
00:29:06,090 --> 00:29:09,850
text her face by design because now we
can like

491
00:29:09,850 --> 00:29:12,900
white up terrified staff on that
Berkshire discs

492
00:29:12,900 --> 00:29:19,360
still we want to have remote code
execution so

493
00:29:19,360 --> 00:29:23,040
the house should pop and I'm

494
00:29:23,040 --> 00:29:27,710
if you open 15 min and I dot you can
find all the different message handler

495
00:29:27,710 --> 00:29:29,780
fullest different type of Massachusetts

496
00:29:29,780 --> 00:29:33,110
and one what honked like instantly

497
00:29:33,110 --> 00:29:36,250
I walls to handle season message

498
00:29:36,250 --> 00:29:39,520
mm remote message to the

499
00:29:39,520 --> 00:29:43,450
not Daz a nice and include key back from
its in the binary phone Crime

500
00:29:43,450 --> 00:29:47,690
through text message name I'm and

501
00:29:47,690 --> 00:29:51,410
what this Dolce this message type
basically tanks

502
00:29:51,410 --> 00:29:56,270
your message payload and posited as
argument to one of three

503
00:29:56,270 --> 00:29:59,310
no clue comment line truths that are
available on a first-come

504
00:29:59,310 --> 00:30:03,460
and as we have feeling just futures we
also doesn't

505
00:30:03,460 --> 00:30:07,910
actually used anymore in country PFS
broadens and reckons he does because

506
00:30:07,910 --> 00:30:11,560
mm remote as I can only binary to the
next test and

507
00:30:11,560 --> 00:30:15,340
so you can try to trigger execution of a
binary that isn't

508
00:30:15,340 --> 00:30:19,580
included anymore in the actual
distribution so

509
00:30:19,580 --> 00:30:24,440
mm remotest bash script which is always
cool if you have a bash script to come

510
00:30:24,440 --> 00:30:28,460
executed recruit privileged from remote
I'm

511
00:30:28,460 --> 00:30:32,490
and it s like the couple of power lines
of code and it's surprising

512
00:30:32,490 --> 00:30:36,620
good so if you're interested in writing
where quality bash scripting

513
00:30:36,620 --> 00:30:39,730
this is a 5x Harper I'm

514
00:30:39,730 --> 00:30:43,610
however by design is already very
powerful so it has like built-in

515
00:30:43,610 --> 00:30:44,830
functionality to

516
00:30:44,830 --> 00:30:47,920
on mount and mount Alberto discs and
stuff like that

517
00:30:47,920 --> 00:30:53,360
so still we wanted to have something you
can simply also like a month injection

518
00:30:53,360 --> 00:30:58,250
and if you call don't like this and its
apartment are able to Carter's over the

519
00:30:58,250 --> 00:31:00,110
networks for remotely without

520
00:31:00,110 --> 00:31:01,590
any authentication

521
00:31:01,590 --> 00:31:05,800
it recreated to hi Paul yeah

522
00:31:05,800 --> 00:31:09,210
of course we also have a bit more for
the remote car execution

523
00:31:09,210 --> 00:31:13,140
so who from

524
00:31:13,140 --> 00:31:19,000
I have to set up so

525
00:31:19,000 --> 00:31:22,390
the problem is for this come on
contraction you can simply

526
00:31:22,390 --> 00:31:27,330
a.m. you can simply

527
00:31:27,330 --> 00:31:31,750
do dis were from one but come on and
action because her certain kind of

528
00:31:31,750 --> 00:31:33,500
special characters onslaught

529
00:31:33,500 --> 00:31:38,220
so you can simply put opa script in such
a compartment action

530
00:31:38,220 --> 00:31:41,290
and start we are doing it by

531
00:31:41,290 --> 00:31:45,820
using a frost tomorrow execution to
download all apart backed off from web

532
00:31:45,820 --> 00:31:46,440
server

533
00:31:46,440 --> 00:31:49,800
and then the second command injection
with actually triggered a script

534
00:31:49,800 --> 00:31:53,870
I'm we have some kind of tiring issue
photos actually has two heads

535
00:31:53,870 --> 00:31:56,950
so I might you're new to execute as

536
00:31:56,950 --> 00:32:01,050
exploit like twice or tree times um

537
00:32:01,050 --> 00:32:04,770
yet but this was like on the second try
and you can also see

538
00:32:04,770 --> 00:32:08,420
I got to communication from the GPFS
note

539
00:32:08,420 --> 00:32:15,420
and if n2 I didn't I'm route so this is
completely remodeled

540
00:32:20,350 --> 00:32:23,470
now the interesting part about the spa
course

541
00:32:23,470 --> 00:32:27,560
on that though rambling able to patch

542
00:32:27,560 --> 00:32:31,730
so at least I learnt a lesson and we got
to live CBS ASCO

543
00:32:31,730 --> 00:32:36,150
at least right now up but the problem is
of course is in a design flaw of two

544
00:32:36,150 --> 00:32:36,870
protocol

545
00:32:36,870 --> 00:32:41,560
and they actually have a reason for why
they are looking at type you trust

546
00:32:41,560 --> 00:32:46,080
stop inside to TCP payload because you
have to imagine you might have something

547
00:32:46,080 --> 00:32:47,210
like pain or a

548
00:32:47,210 --> 00:32:50,710
failover also if one network interface
dice

549
00:32:50,710 --> 00:32:53,800
you still want to be able to communicate
via the cluster

550
00:32:53,800 --> 00:32:58,760
so you can simply use the sauce acute
risks the only way how you can fix this

551
00:32:58,760 --> 00:32:59,330
is by

552
00:32:59,330 --> 00:33:04,660
enabling SSL because tooth apart
authentication over SSL Certificates

553
00:33:04,660 --> 00:33:05,820
basically trying to

554
00:33:05,820 --> 00:33:09,030
caves your store on the pipe system so

555
00:33:09,030 --> 00:33:13,210
they have now released a patch on Sunday
that allows you to enable

556
00:33:13,210 --> 00:33:16,810
SS L during normal operation of this
class to

557
00:33:16,810 --> 00:33:20,740
so because two seems to be a really big
problem for many of the custom of

558
00:33:20,740 --> 00:33:24,530
but they have to be able to enable disk
during normal operation

559
00:33:24,530 --> 00:33:29,040
fordice this cut kind of an impressive a
a technique or

560
00:33:29,040 --> 00:33:32,980
a patch release server if you use GPFS

561
00:33:32,980 --> 00:33:37,090
louisa May SS right now now

562
00:33:37,090 --> 00:33:41,980
we still have something left we all went
good low current

563
00:33:41,980 --> 00:33:45,660
and we got we motored using to
communication human and

564
00:33:45,660 --> 00:33:49,030
then ran have something thought

565
00:33:49,030 --> 00:33:52,780
we have to scroll amadio and now my show

566
00:33:52,780 --> 00:33:57,620
from yep so this column on your creates
bayview device

567
00:33:57,620 --> 00:34:02,130
looks device and is used for
communication between a GP if you are

568
00:34:02,130 --> 00:34:03,020
spaced towards

569
00:34:03,020 --> 00:34:07,000
and to conduct a I'm just normal I was
future ok Oxford

570
00:34:07,000 --> 00:34:11,370
no the problem instead to GPFS called
Ivory's

571
00:34:11,370 --> 00:34:14,830
but need to talk truth to this device

572
00:34:14,830 --> 00:34:18,890
Sun libelous you would not using your
normal use a space application so take

573
00:34:18,890 --> 00:34:19,810
on simpson

574
00:34:19,810 --> 00:34:23,650
due to permissions firm only instead to
have to allow

575
00:34:23,650 --> 00:34:26,149
normal use of two years

576
00:34:26,149 --> 00:34:30,720
I'm Sultan need to edit checked for
everything I was pretty call

577
00:34:30,720 --> 00:34:35,169
and a all like 150 I octo colleagues in
this binary

578
00:34:35,169 --> 00:34:38,520
I'm so

579
00:34:38,520 --> 00:34:41,960
we looked at the car and looked at two
couple of items such as

580
00:34:41,960 --> 00:34:45,829
had lost to find a moon ability um

581
00:34:45,829 --> 00:34:49,639
if you want to look at this you have to
3 lakh units again

582
00:34:49,639 --> 00:34:53,020
I'm MMFF 26 a

583
00:34:53,020 --> 00:34:56,429
is like the only one that actually
performs rock and its binary

584
00:34:56,429 --> 00:35:00,579
only but if you start looking at these
handler functions

585
00:35:00,579 --> 00:35:04,730
your few nice a handler function
cultivate whole flock

586
00:35:04,730 --> 00:35:08,569
hi lock probably which just i future ok
almost 39

587
00:35:08,569 --> 00:35:12,440
and it doesn't have any proof checks so
you can used as I'm privileged from

588
00:35:12,440 --> 00:35:13,569
local custom

589
00:35:13,569 --> 00:35:17,170
and it's called refuse a controlled
arguments so the very both

590
00:35:17,170 --> 00:35:20,550
awk actually coming from userspace and
if you have

591
00:35:20,550 --> 00:35:23,720
ever wouldn't see you feel something
like this

592
00:35:23,720 --> 00:35:28,240
doesn't of it however you bite income
context so we control our CFO and

593
00:35:28,240 --> 00:35:28,920
controller

594
00:35:28,920 --> 00:35:32,740
Oct one so it's like game over so

595
00:35:32,740 --> 00:35:36,109
we're in part to piss to IBM

596
00:35:36,109 --> 00:35:41,520
but didn't provide to full province
escalation proof of concept at this time

597
00:35:41,520 --> 00:35:44,800
but are made clearly stated
business-like

598
00:35:44,800 --> 00:35:47,890
trivial privilege escalation on a normal
Linux system

599
00:35:47,890 --> 00:35:51,050
where dead released a patch on Sunday

600
00:35:51,050 --> 00:35:54,819
but I didn't agree in because clearly a
knob Terry lives only a

601
00:35:54,819 --> 00:35:56,000
denial-of-service

602
00:35:56,000 --> 00:35:59,619
so yeah

603
00:35:59,619 --> 00:36:02,660
a I don't want to spoil it but afk of
its not

604
00:36:02,660 --> 00:36:06,859
a denial of service its actually quite
review to exploit

605
00:36:06,859 --> 00:36:11,500
we used is obvious how we write to write
and the trust of our own

606
00:36:11,500 --> 00:36:14,520
30 shall coat for into one of two

607
00:36:14,520 --> 00:36:19,770
understand trees of 2006 hensler tabor
ten-week called respect of I will

608
00:36:19,770 --> 00:36:22,230
feature using our users based binary

609
00:36:22,230 --> 00:36:25,880
and to con executes the show coat and
change to prove a nurse

610
00:36:25,880 --> 00:36:30,030
of our current pros has true root and

611
00:36:30,030 --> 00:36:31,110
cost

612
00:36:31,110 --> 00:36:38,110
we have a demo for that required cost

613
00:36:38,260 --> 00:36:42,260
so I had on I'll be quite fast head home
and how much I'm

614
00:36:42,260 --> 00:36:46,470
15 minutes okay so time yeah

615
00:36:46,470 --> 00:36:50,070
so we have to SMA sleep

616
00:36:50,070 --> 00:36:55,740
Explorer to compile it and if I execute
third

617
00:36:55,740 --> 00:37:00,690
you can see you even have a lot of 107

618
00:37:00,690 --> 00:37:07,690
36 we should which have faith that we
even have time for the local yeah

619
00:37:11,170 --> 00:37:14,480
I think a local problem what time the
next week and a half

620
00:37:14,480 --> 00:37:18,650
a okay so

621
00:37:18,650 --> 00:37:22,570
remember the structure of all talk
relief to do with pressure to reduce

622
00:37:22,570 --> 00:37:23,700
their program

623
00:37:23,700 --> 00:37:27,510
we have a remote a root exploit against
the communication demon

624
00:37:27,510 --> 00:37:30,980
and for just for fun we also go toward
on Connor

625
00:37:30,980 --> 00:37:35,250
or against a column on your node only
thing that most left to do

626
00:37:35,250 --> 00:37:38,290
was to actually talk to IBM about on the
stuff

627
00:37:38,290 --> 00:37:41,520
tho IBM's response

628
00:37:41,520 --> 00:37:45,030
most extremely professional so day still
half like kings

629
00:37:45,030 --> 00:37:48,250
optimistic estimation of exploit ability
as I call it

630
00:37:48,250 --> 00:37:52,940
so if you don't provide them were for
rolled coil Woodcote execution exploit

631
00:37:52,940 --> 00:37:53,410
though

632
00:37:53,410 --> 00:37:56,810
probably a time denial of service seen
in this cohort

633
00:37:56,810 --> 00:38:00,340
but other than that the really
impressive so their patch

634
00:38:00,340 --> 00:38:03,520
all released patch following Street box
on Sunday

635
00:38:03,520 --> 00:38:07,520
so just in time which means the only
took like 30 days from

636
00:38:07,520 --> 00:38:10,670
up of pressuring part to the actual

637
00:38:10,670 --> 00:38:16,440
Petraeus I'm as we said before the patch
for the remote pockets basically

638
00:38:16,440 --> 00:38:19,930
in a bus 0 so

639
00:38:19,930 --> 00:38:24,180
come to mental fog attacks are you have
to apply vendor Petrus

640
00:38:24,180 --> 00:38:27,400
still neighbor SS and to mitigate to
remote issue

641
00:38:27,400 --> 00:38:30,710
and of cost as you have seen

642
00:38:30,710 --> 00:38:34,590
Jeff s is only usable if on notes are
fully trusted

643
00:38:34,590 --> 00:38:39,200
so if one thing to note is compromised
all the notes in your class that will be

644
00:38:39,200 --> 00:38:40,550
compromised as well

645
00:38:40,550 --> 00:38:44,540
because like dis distributed s age
comment I've shown you

646
00:38:44,540 --> 00:38:47,260
if cramped by design and

647
00:38:47,260 --> 00:38:53,089
we strongly recommend to firewall non
GPFS interfaces to interface with no GPS

648
00:38:53,089 --> 00:38:56,520
as communication because on pot 11

649
00:38:56,520 --> 00:39:01,500
91 so an attack on them to speak to
distant from the whole time but maybe we

650
00:39:01,500 --> 00:39:02,650
have to tell them that

651
00:39:02,650 --> 00:39:06,270
we did some investigations on the
Internet yeah

652
00:39:06,270 --> 00:39:10,619
that and gas only a diff perform a scan
from 1191

653
00:39:10,619 --> 00:39:13,619
and of home system for whale a reason to
think that way

654
00:39:13,619 --> 00:39:17,160
yeah okay so

655
00:39:17,160 --> 00:39:21,640
I think yeah less inclined of cross tech
surfaces chin

656
00:39:21,640 --> 00:39:24,819
in this case the Tax Office of GPFS

657
00:39:24,819 --> 00:39:28,790
is like incredibly large on all males so
we have a lot of

658
00:39:28,790 --> 00:39:32,780
that you had to use of space by know if
you have an extremely complex common

659
00:39:32,780 --> 00:39:33,440
interface

660
00:39:33,440 --> 00:39:36,849
and tooth demon also its

661
00:39:36,849 --> 00:39:40,030
really impressive in did waive wanted
das soda

662
00:39:40,030 --> 00:39:44,849
distributed file system XQ books but of
course it's like a perfect playground

663
00:39:44,849 --> 00:39:48,900
for memory corruption burned Bluetooth
and stuff like this I'm

664
00:39:48,900 --> 00:39:52,220
business-like complexity choose and

665
00:39:52,220 --> 00:39:56,410
of cost a few if you order to binary
star brawl which in a written in

666
00:39:56,410 --> 00:39:57,790
nineteen ninety-three

667
00:39:57,790 --> 00:40:01,329
and support like different kind of Unix
operating systems

668
00:40:01,329 --> 00:40:05,500
ass velux windows you will have problems
and this

669
00:40:05,500 --> 00:40:11,010
and if we go back to all over to MySpace
problem we had at the beginning to

670
00:40:11,010 --> 00:40:14,250
exploit a few state of panic buying to
remember give up

671
00:40:14,250 --> 00:40:19,069
try to exploit it and then look other
stuff in the same system you might still

672
00:40:19,069 --> 00:40:20,260
find some interesting

673
00:40:20,260 --> 00:40:25,250
box and its always good if you haven't
somebody to pressure you into talking at

674
00:40:25,250 --> 00:40:25,990
the confluence

675
00:40:25,990 --> 00:40:29,260
lol but on tel.no: yeah I don't know
about that

676
00:40:29,260 --> 00:40:33,170
but because then you actually have to do
to renew a book so

677
00:40:33,170 --> 00:40:36,190
that's it from all sides thanks for your
attention

678
00:40:36,190 --> 00:40:43,190
and we're happy to answer your question

679
00:40:46,390 --> 00:40:53,390
okay questions

680
00:41:00,540 --> 00:41:05,150
thanks Josh and you take a look at the
tests status so I D binary did you look

681
00:41:05,150 --> 00:41:06,930
at many of the other binaries

682
00:41:06,930 --> 00:41:10,290
got really sick list because to up the
problem is that

683
00:41:10,290 --> 00:41:14,270
to your statuses basically all many of
the binary such a symlink to each other

684
00:41:14,270 --> 00:41:15,740
as I i mention shortly

685
00:41:15,740 --> 00:41:20,010
soul we did not took a look at a test
that was enough in this case

686
00:41:20,010 --> 00:41:23,600
so we didn't took a look at the other
ones because most of them are some links

687
00:41:23,600 --> 00:41:25,600
to each other and depending on what name

688
00:41:25,600 --> 00:41:29,700
the binary has in this case a different
code path will be executed

689
00:41:29,700 --> 00:41:33,280
some most of them up just one big by a
rare

690
00:41:33,280 --> 00:41:36,630
and depending on what name it hasn't
just executes different called I'm

691
00:41:36,630 --> 00:41:40,290
and a good few actually compile so this
is a visit to have two sisters

692
00:41:40,290 --> 00:41:41,850
communications stuff that

693
00:41:41,850 --> 00:41:45,840
for pasta add message and stuff like
this and has the same for all of tissue

694
00:41:45,840 --> 00:41:47,070
space by New Years

695
00:41:47,070 --> 00:41:50,640
a which is just that a key compiled im
because to

696
00:41:50,640 --> 00:41:54,950
cheer state of binary never used to add
message functionality but like to live a

697
00:41:54,950 --> 00:41:58,250
risk of that and it's compiled and so
you have to stack surface

698
00:41:58,250 --> 00:42:02,260
another question if it's OK

699
00:42:02,260 --> 00:42:06,430
I'm on your remote exploit and

700
00:42:06,430 --> 00:42:12,170
is the communication to the NS teases
that required to come from a profession

701
00:42:12,170 --> 00:42:12,630
poor

702
00:42:12,630 --> 00:42:16,030
I E is your mm status

703
00:42:16,030 --> 00:42:19,910
notes night I kinda their own answer for
the

704
00:42:19,910 --> 00:42:23,590
your intellect to to exploitation of
just a touch

705
00:42:23,590 --> 00:42:27,600
so if you connect to this yesterday only
check photo chip cookie order

706
00:42:27,600 --> 00:42:32,180
authentication was only that use had to
process ID of your status by a TCP

707
00:42:32,180 --> 00:42:36,530
which is kind of trivial issue on the
local system an older and have some kind

708
00:42:36,530 --> 00:42:37,580
of random cokie

709
00:42:37,580 --> 00:42:40,850
which should be more secure but to be
honest we didn't look at that

710
00:42:40,850 --> 00:42:47,130
so might still be have from problems
thank you

711
00:42:47,130 --> 00:42:49,670
okay more questions tag

712
00:42:49,670 --> 00:42:53,610
effective so

713
00:42:53,610 --> 00:42:57,560
I told when I saw that they were sending
the steps right

714
00:42:57,560 --> 00:43:01,320
I thought well serialization RPC I

715
00:43:01,320 --> 00:43:04,850
but id did you get the idea what
possessed them

716
00:43:04,850 --> 00:43:08,880
and designed as an actor and you know it
was nineteen ninety-three

717
00:43:08,880 --> 00:43:12,570
yeah they had like a few days of I don't
know we actually talked to a lot of

718
00:43:12,570 --> 00:43:13,440
developers

719
00:43:13,440 --> 00:43:17,960
and he was very calm timed I don't think
they sleep problems but it's like a

720
00:43:17,960 --> 00:43:19,440
crowing architecture

721
00:43:19,440 --> 00:43:22,740
and I'm trying really hard to stay
backwards compatible

722
00:43:22,740 --> 00:43:26,130
so it probably somebody wanted like this
in 1994

723
00:43:26,130 --> 00:43:29,830
and they are still trying to to to Pizza
Hut Inc so

724
00:43:29,830 --> 00:43:35,790
while you were reversing that right did
you she it racism any particular tools

725
00:43:35,790 --> 00:43:37,580
like there are PC Tools

726
00:43:37,580 --> 00:43:42,520
I mean they invented RPC didn't I am
from you looks completely

727
00:43:42,520 --> 00:43:46,140
hank written so it's not like some kind
of automation

728
00:43:46,140 --> 00:43:52,020
or something a hot thank you okay

729
00:43:52,020 --> 00:43:58,060
more questions I

730
00:43:58,060 --> 00:44:03,810
just out of curiosity what systems were
you getting that we're running GPFS

731
00:44:03,810 --> 00:44:05,720
where they see pic Peters oh well they

732
00:44:05,720 --> 00:44:11,970
just general clusters or can you know on
to the next question

733
00:44:11,970 --> 00:44:14,720
coach I

734
00:44:14,720 --> 00:44:19,230
kopi for that had to stay in place

735
00:44:19,230 --> 00:44:26,230
I okay last chance to ask questions

736
00:44:27,190 --> 00:44:31,770
otherwise some overdue an early lunch
break and you can

737
00:44:31,770 --> 00:44:35,580
for talk to Florida tough election
process if you like

738
00:44:35,580 --> 00:44:39,240
private sector play

739
00:44:39,240 --> 00:44:43,500
I p.m. maybe maybe just a hand and a
follow-up question

740
00:44:43,500 --> 00:44:48,540
I have to pleasure to running and back
up to I'm software from IBM

741
00:44:48,540 --> 00:44:52,060
and it's called Chi s am

742
00:44:52,060 --> 00:44:56,290
helped you Lisa just saying to here
you're kinda far I've always been

743
00:44:56,290 --> 00:44:57,480
altered dollar-and-a-half

744
00:44:57,480 --> 00:45:02,450
yeah and ended and general question at
about a and exploits but a

745
00:45:02,450 --> 00:45:05,700
two days still put two convicts into the
bin folder

746
00:45:05,700 --> 00:45:08,790
like to do not a softer soul

747
00:45:08,790 --> 00:45:13,960
fifth has kind of an interesting layout
on your height system let's put it that

748
00:45:13,960 --> 00:45:14,390
way

749
00:45:14,390 --> 00:45:19,940
okay fix the okay so

750
00:45:19,940 --> 00:45:26,550
florio Felix thank you very much great
work

751
00:45:26,550 --> 00:45:29,070
them

