1
00:00:31,880 --> 00:00:35,370
sped up both think this sorry now it's
better

2
00:00:35,370 --> 00:00:38,899
yes thank you at so I come again and

3
00:00:38,899 --> 00:00:43,180
this will be our age and I and s Sagay
set

4
00:00:43,180 --> 00:00:46,530
in there in this keynote today

5
00:00:46,530 --> 00:00:49,860
am we will have to switch on the
dockside

6
00:00:49,860 --> 00:00:53,949
first soul am don't wonder if you might
feel

7
00:00:53,949 --> 00:00:57,110
its if you would be in

8
00:00:57,110 --> 00:01:01,640
hecka session at at least for the first
30 minutes

9
00:01:01,640 --> 00:01:06,080
so do you think you are protected

10
00:01:06,080 --> 00:01:09,439
and I'll that question but I put them

11
00:01:09,439 --> 00:01:14,700
anyway look at this

12
00:01:14,700 --> 00:01:18,360
and many of you have this

13
00:01:18,360 --> 00:01:22,299
firewall intrusion detection and his
palm Web Security

14
00:01:22,299 --> 00:01:25,950
you have been I'm of incidents per day

15
00:01:25,950 --> 00:01:30,200
look at their anti-virus

16
00:01:30,200 --> 00:01:34,500
but they hits 4500

17
00:01:34,500 --> 00:01:38,329
infections per month to do a lot of
security

18
00:01:38,329 --> 00:01:45,329
don't your its court I think get this

19
00:01:47,350 --> 00:01:51,229
do you think one of your system's in
Active Directory

20
00:01:51,229 --> 00:01:58,229
might be compromised

21
00:01:59,380 --> 00:02:03,320
against past the heshe path the car aus

22
00:02:03,320 --> 00:02:06,789
or some pasta the doll that picket

23
00:02:06,789 --> 00:02:09,929
to know about Gordon pickets

24
00:02:09,929 --> 00:02:13,099
who knows about going pickets

25
00:02:13,099 --> 00:02:16,760
okay soul already some

26
00:02:16,760 --> 00:02:19,950
so when I come and

27
00:02:19,950 --> 00:02:23,810
who was see imagine and Pat ka

28
00:02:23,810 --> 00:02:27,810
backed is it kind of Keith Holland

29
00:02:27,810 --> 00:02:33,590
motto from terminator 2: his of liquid
metal

30
00:02:33,590 --> 00:02:36,760
he has the ability

31
00:02:36,760 --> 00:02:40,130
toll impersonate

32
00:02:40,130 --> 00:02:47,130
each person he wants to impersonate
let's have a look

33
00:02:51,540 --> 00:02:58,540
its intended with all audio

34
00:03:06,470 --> 00:03:07,620
so

35
00:03:07,620 --> 00:03:14,620
he's going to impersonate

36
00:03:17,269 --> 00:03:21,230
he's going bypassing security comtrol

37
00:03:21,230 --> 00:03:24,230
he might the PIA a

38
00:03:24,230 --> 00:03:28,860
weekly man him I 2 p.m. at NIST writer
he might

39
00:03:28,860 --> 00:03:32,750
AP at the boss whoever he wants to look
like you might appear

40
00:03:32,750 --> 00:03:37,220
is this a few trial

41
00:03:37,220 --> 00:03:41,819
know it already happened

42
00:03:41,819 --> 00:03:46,400
and I don't want to make you afraid

43
00:03:46,400 --> 00:03:49,400
but probably as well in you are

44
00:03:49,400 --> 00:03:53,360
enterprise to see any link to your

45
00:03:53,360 --> 00:03:57,069
Active Directory infrastructure public
view my

46
00:03:57,069 --> 00:04:00,370
so Wycombe

47
00:04:00,370 --> 00:04:03,680
again this is copy of a slight

48
00:04:03,680 --> 00:04:07,690
from from Microsoft talk

49
00:04:07,690 --> 00:04:11,530
at at a.m. picked up

50
00:04:11,530 --> 00:04:15,190
and QC he a whole past the Hessian pics

51
00:04:15,190 --> 00:04:18,479
are working it begins

52
00:04:18,479 --> 00:04:21,780
with an infected workstation and then
the

53
00:04:21,780 --> 00:04:24,860
at Pixar obvious credentials and moves

54
00:04:24,860 --> 00:04:28,729
from one work from one workstation to
another

55
00:04:28,729 --> 00:04:33,349
eventually gets credentials promise I'll
have any more store so I'll

56
00:04:33,349 --> 00:04:36,680
eventually he gets credentials from the
domain controller

57
00:04:36,680 --> 00:04:39,870
then he the

58
00:04:39,870 --> 00:04:43,150
owns the domain controller and keep owns

59
00:04:43,150 --> 00:04:47,520
the domain this is very interesting

60
00:04:47,520 --> 00:04:50,930
report probably you nor

61
00:04:50,930 --> 00:04:54,340
its the data breach investigations
report

62
00:04:54,340 --> 00:04:58,820
of Horizon you see a hall

63
00:04:58,820 --> 00:05:03,289
the head King has has

64
00:05:03,289 --> 00:05:07,139
increase and if you have been ok

65
00:05:07,139 --> 00:05:11,500
at the UWS of stolen credentials

66
00:05:11,500 --> 00:05:14,560
it's on the top it wasn't on the top

67
00:05:14,560 --> 00:05:18,630
all the years but it has been on talk a

68
00:05:18,630 --> 00:05:22,760
now and probably it will be going to be
on top

69
00:05:22,760 --> 00:05:26,169
so it's really

70
00:05:26,169 --> 00:05:28,530
important threat

71
00:05:28,530 --> 00:05:31,810
that should be addressed

72
00:05:31,810 --> 00:05:37,240
somehow how do you communicate this to
your management

73
00:05:37,240 --> 00:05:40,620
and now the big question we will come
later told this

74
00:05:40,620 --> 00:05:43,680
am and Nole

75
00:05:43,680 --> 00:05:47,480
we are stopping with Windows

76
00:05:47,480 --> 00:05:51,230
authentication we will to the

77
00:05:51,230 --> 00:05:54,800
now a deep dive a that's not a possible

78
00:05:54,800 --> 00:05:59,270
in one hour it buys in Windows
authentication

79
00:05:59,270 --> 00:06:03,930
and the windows authentication framework
in some components

80
00:06:03,930 --> 00:06:07,260
like the eighth us process which is

81
00:06:07,260 --> 00:06:10,300
a one of a the

82
00:06:10,300 --> 00:06:14,000
important subsystems of Windows

83
00:06:14,000 --> 00:06:17,130
to see it here you see the

84
00:06:17,130 --> 00:06:21,300
different authentication package: in
Scarborough sand sp1

85
00:06:21,300 --> 00:06:26,810
and about that contain in a protected
mode credentials of you with us

86
00:06:26,810 --> 00:06:31,020
and you see here she met E-coli the
possibilities

87
00:06:31,020 --> 00:06:34,980
tall I had our authenticates

88
00:06:34,980 --> 00:06:39,720
against the Sam local account all the
Active Directory

89
00:06:39,720 --> 00:06:43,410
Ellis aw

90
00:06:43,410 --> 00:06:50,040
ellis et BLSA process of cost campaigns
lot of security mechanisms

91
00:06:50,040 --> 00:06:53,729
the credentials op not stall

92
00:06:53,729 --> 00:06:56,890
in a in an encrypted memo

93
00:06:56,890 --> 00:07:00,150
of cost a I start and credit but they
aren't

94
00:07:00,150 --> 00:07:04,300
stopped encrypt it and the symmetric
anyway and the keys

95
00:07:04,300 --> 00:07:08,340
half toll I in the memory

96
00:07:08,340 --> 00:07:12,110
will perhaps they don't have but in
actual

97
00:07:12,110 --> 00:07:16,690
in current operating systems they mama
delay

98
00:07:16,690 --> 00:07:22,460
in the memory and of particular interest

99
00:07:22,460 --> 00:07:25,960
fall the at a car

100
00:07:25,960 --> 00:07:29,020
are the password hashes encryption keys
and

101
00:07:29,020 --> 00:07:32,970
copper or stickers so let's look

102
00:07:32,970 --> 00:07:36,810
thats have a local at Windows
authentication

103
00:07:36,810 --> 00:07:40,180
am more precisely at local

104
00:07:40,180 --> 00:07:45,840
and PLM authentication its such event
response

105
00:07:45,840 --> 00:07:51,240
procedure issue in all and the
administrator and this is possible out

106
00:07:51,240 --> 00:07:56,660
is name and QC here the authentication
package:

107
00:07:56,660 --> 00:08:00,300
in the SS process which contains two
versions of

108
00:08:00,300 --> 00:08:05,330
the hash the hash is many data

109
00:08:05,330 --> 00:08:10,130
against the security accomplish a
database

110
00:08:10,130 --> 00:08:13,790
when the use up authenticates locally

111
00:08:13,790 --> 00:08:18,490
in coveralls it's a little bit mall

112
00:08:18,490 --> 00:08:22,910
complicated a could coveralls

113
00:08:22,910 --> 00:08:26,270
provide smooth sure authentication for

114
00:08:26,270 --> 00:08:30,060
clients and solve our is used to access

115
00:08:30,060 --> 00:08:34,349
remote system in the car of terminology

116
00:08:34,349 --> 00:08:38,650
you have the key this you have three
important components

117
00:08:38,650 --> 00:08:41,760
one is the key distribution pent-up

118
00:08:41,760 --> 00:08:46,980
a that this the domain controller in
Microsoft's implementation

119
00:08:46,980 --> 00:08:50,900
you have client computer or use a

120
00:08:50,900 --> 00:08:55,329
and you have this office Paul

121
00:08:55,330 --> 00:08:58,520
the solver which is assessed by

122
00:08:58,520 --> 00:09:03,310
the client for

123
00:09:03,310 --> 00:09:07,030
there are three different encryption
keys

124
00:09:07,030 --> 00:09:10,380
which and bought them and

125
00:09:10,380 --> 00:09:14,089
authentication services provided by Kara
Ross

126
00:09:14,089 --> 00:09:17,190
we short

127
00:09:17,190 --> 00:09:20,880
be doing all that to understand the
attack from area

128
00:09:20,880 --> 00:09:24,650
with these three kind of keys

129
00:09:24,650 --> 00:09:28,339
a they are the long-term Kia of

130
00:09:28,339 --> 00:09:31,820
the domain controller of the domain

131
00:09:31,820 --> 00:09:35,820
which is the cup kg key account and

132
00:09:35,820 --> 00:09:39,610
and he um his secret

133
00:09:39,610 --> 00:09:44,260
valium Houghton his secret signs the
so-called

134
00:09:44,260 --> 00:09:44,920
pack

135
00:09:44,920 --> 00:09:48,440
I will come later to this then we have

136
00:09:48,440 --> 00:09:51,660
the client long term key that is

137
00:09:51,660 --> 00:09:54,940
the NTLM Heschel the copper rose ticket

138
00:09:54,940 --> 00:09:58,750
of computer always use up

139
00:09:58,750 --> 00:10:02,620
and finally we have the Sophists also of
our

140
00:10:02,620 --> 00:10:06,930
hash all ticket which

141
00:10:06,930 --> 00:10:10,160
is yours by the solve all service which

142
00:10:10,160 --> 00:10:15,139
is accessed by the use of am

143
00:10:15,139 --> 00:10:18,310
very important paper struck shot

144
00:10:18,310 --> 00:10:22,230
within and copper rose ticket is the
pock

145
00:10:22,230 --> 00:10:25,660
the pockets the privileged
authentication

146
00:10:25,660 --> 00:10:29,149
at sorry privileged accounts
certificates

147
00:10:29,149 --> 00:10:33,699
the privilege accounts certificates
contains

148
00:10:33,699 --> 00:10:37,279
the information a of the user's

149
00:10:37,279 --> 00:10:42,389
rights in Active Directory contents
information about his

150
00:10:42,389 --> 00:10:46,630
group memberships his privilege shirts

151
00:10:46,630 --> 00:10:49,920
and some %uh some information about

152
00:10:49,920 --> 00:10:55,160
mapped drive and home pop and so on but
the important information

153
00:10:55,160 --> 00:10:59,000
is the identity identity of you of the
user

154
00:10:59,000 --> 00:11:03,040
and this group memberships and security
privilege

155
00:11:03,040 --> 00:11:06,079
on the system he wants to access

156
00:11:06,079 --> 00:11:10,610
all in Active Directory this

157
00:11:10,610 --> 00:11:14,380
Park is time with

158
00:11:14,380 --> 00:11:18,199
the long-term she of the domain
controller that this

159
00:11:18,199 --> 00:11:23,170
the NTLM hash of that Cup tgp

160
00:11:23,170 --> 00:11:25,940
a comp

161
00:11:25,940 --> 00:11:29,670
we will have a short overview paul
cooper also

162
00:11:29,670 --> 00:11:33,500
authentication how it works I'm

163
00:11:33,500 --> 00:11:37,260
to see you was a the user enters his
pass what

164
00:11:37,260 --> 00:11:40,290
and then now

165
00:11:40,290 --> 00:11:43,480
again in the ad says process but now in
there

166
00:11:43,480 --> 00:11:47,450
coveralls de l'air you find authenticate

167
00:11:47,450 --> 00:11:51,790
us and these authenticators I'll
represent a tooth's

168
00:11:51,790 --> 00:11:56,270
of the password and fish even in in
different

169
00:11:56,270 --> 00:11:59,280
to encrypt it formats am

170
00:11:59,280 --> 00:12:02,280
now the authentication process

171
00:12:02,280 --> 00:12:06,460
processes walks like this the

172
00:12:06,460 --> 00:12:10,410
the use our wants authenticate

173
00:12:10,410 --> 00:12:17,050
to the domain controllers so he does and
authentication service request was a

174
00:12:17,050 --> 00:12:18,370
little main controller

175
00:12:18,370 --> 00:12:21,540
and

176
00:12:21,540 --> 00:12:25,130
the domain controller verifies

177
00:12:25,130 --> 00:12:28,340
their pass what

178
00:12:28,340 --> 00:12:31,870
that the with the entire and that was
corn voc-tech

179
00:12:31,870 --> 00:12:34,940
in these authenticators

180
00:12:34,940 --> 00:12:38,240
against his Active Directory database

181
00:12:38,240 --> 00:12:42,000
that is the NPD estate which is taught
on the domain controller

182
00:12:42,000 --> 00:12:45,340
if it is right and US Yuming this

183
00:12:45,340 --> 00:12:49,260
the domain controller issues

184
00:12:49,260 --> 00:12:52,660
it TGT that it's a ticket granting

185
00:12:52,660 --> 00:12:56,940
ticket talk the client and

186
00:12:56,940 --> 00:13:03,150
the client then once we assume this once
to access

187
00:13:03,150 --> 00:13:06,210
resource for example if I is so of

188
00:13:06,210 --> 00:13:10,200
with that tgp he conned excess

189
00:13:10,200 --> 00:13:14,030
the prior saw therefore he need

190
00:13:14,030 --> 00:13:17,650
80gsm ticket granting a

191
00:13:17,650 --> 00:13:21,770
service picket and them

192
00:13:21,770 --> 00:13:25,930
here you see the client reprieve nth

193
00:13:25,930 --> 00:13:31,590
that TGT that he has received from the
domain controller

194
00:13:31,590 --> 00:13:35,640
tool the service and then he gets

195
00:13:35,640 --> 00:13:39,990
excess tall thus office soul

196
00:13:39,990 --> 00:13:43,500
the domain controller never speaks with

197
00:13:43,500 --> 00:13:47,160
for so overall with this office

198
00:13:47,160 --> 00:13:51,490
a the client receives a kind of beer

199
00:13:51,490 --> 00:13:55,530
in order to authenticate himself and
with this bill

200
00:13:55,530 --> 00:13:58,850
he is entitled to requests office

201
00:13:58,850 --> 00:14:02,370
tickets in all that talk authenticate

202
00:14:02,370 --> 00:14:09,370
against services we made rule

203
00:14:10,060 --> 00:14:13,520
we may draw all two important
conclusions

204
00:14:13,520 --> 00:14:18,450
from this oneness which

205
00:14:18,450 --> 00:14:22,350
is p trust anchor in Active Directory

206
00:14:22,350 --> 00:14:27,220
this is one and we already saw

207
00:14:27,220 --> 00:14:31,220
that they are well some keys and pass

208
00:14:31,220 --> 00:14:35,570
and hash is involved the second
important question is

209
00:14:35,570 --> 00:14:39,870
well are based alt AST ALT

210
00:14:39,870 --> 00:14:43,310
and the as this process back and watch

211
00:14:43,310 --> 00:14:46,570
which format and might they be
accessible

212
00:14:46,570 --> 00:14:50,240
in some way to answer the first question

213
00:14:50,240 --> 00:14:54,980
up this now on this this point is very
important

214
00:14:54,980 --> 00:14:58,750
a that I'll let you understand this

215
00:14:58,750 --> 00:15:01,930
that trust on car

216
00:15:01,930 --> 00:15:07,520
the central trust I'm car kind of
stamping authority

217
00:15:07,520 --> 00:15:11,350
fall the domain is

218
00:15:11,350 --> 00:15:16,070
their cup pgp account of

219
00:15:16,070 --> 00:15:19,190
this domain and

220
00:15:19,190 --> 00:15:22,790
what's it it's an NTLM hash so

221
00:15:22,790 --> 00:15:26,000
baths the trust I'm Cup of you are

222
00:15:26,000 --> 00:15:30,570
domain and it's a trust uncovered if you
have a forest then of course you have

223
00:15:30,570 --> 00:15:34,550
you have for each domain you have a cup
to GT account

224
00:15:34,550 --> 00:15:37,760
am bop the whole

225
00:15:37,760 --> 00:15:41,490
security realize on this

226
00:15:41,490 --> 00:15:42,310
Trust I

227
00:15:42,310 --> 00:15:47,200
car this is important to understand then

228
00:15:47,200 --> 00:15:50,740
in other think am had that is very im

229
00:15:50,740 --> 00:15:55,670
interesting it's not very nice is it's
not so important to understand that but

230
00:15:55,670 --> 00:15:56,810
it's interesting

231
00:15:56,810 --> 00:16:00,460
I'm its its

232
00:16:00,460 --> 00:16:03,770
the sauce this Benjamin day P benyamin
day PS

233
00:16:03,770 --> 00:16:08,550
the author of the from most Mimi cuts to
work that we would see

234
00:16:08,550 --> 00:16:11,850
as well he a.m.

235
00:16:11,850 --> 00:16:16,820
did he he the he did this work

236
00:16:16,820 --> 00:16:19,820
NP listed which

237
00:16:19,820 --> 00:16:23,360
columns are access ever

238
00:16:23,360 --> 00:16:28,640
let me say with his to worry about as
well with other two words

239
00:16:28,640 --> 00:16:32,370
which account poss what's

240
00:16:32,370 --> 00:16:37,180
which credentials accessible in which
Windows who are some

241
00:16:37,180 --> 00:16:41,890
depending if it's local account autumn I
know called

242
00:16:41,890 --> 00:16:45,010
Sol we have bad

243
00:16:45,010 --> 00:16:49,220
new horse the bank knew or saw if you
look at

244
00:16:49,220 --> 00:16:52,830
a II don't I don't even want to speak

245
00:16:52,830 --> 00:16:55,870
a about when does have a 2003

246
00:16:55,870 --> 00:16:58,870
when those XP we know is out of support
when the stove a

247
00:16:58,870 --> 00:17:02,280
2003 will be am

248
00:17:02,280 --> 00:17:06,300
bop am is fuming you enterprise

249
00:17:06,300 --> 00:17:09,839
runs this you see this nearly

250
00:17:09,839 --> 00:17:13,209
allred and already is that

251
00:17:13,209 --> 00:17:18,420
credentials hasher's Cabarrus Keith

252
00:17:18,420 --> 00:17:21,890
encryption keys are accessible

253
00:17:21,890 --> 00:17:24,929
tall heck up towards

254
00:17:24,929 --> 00:17:28,040
as Mimi cuts if you look

255
00:17:28,040 --> 00:17:31,560
at Windows 8 and

256
00:17:31,560 --> 00:17:34,660
2012 to a 2000 12

257
00:17:34,660 --> 00:17:38,230
environment it's still a

258
00:17:38,230 --> 00:17:41,309
very kind very much things are at

259
00:17:41,309 --> 00:17:44,360
it becomes a little bit better

260
00:17:44,360 --> 00:17:48,340
if you look at new russians

261
00:17:48,340 --> 00:17:51,409
current versions of Windows Windows 8
one

262
00:17:51,409 --> 00:17:54,690
and saw about 2,000 flow

263
00:17:54,690 --> 00:17:58,580
12 hott who one

264
00:17:58,580 --> 00:18:03,480
important remark don't think you are
better protected

265
00:18:03,480 --> 00:18:06,750
if you use smart cards of biometrics

266
00:18:06,750 --> 00:18:10,090
look at this it's alright

267
00:18:10,090 --> 00:18:13,230
they represent a piss the hash

268
00:18:13,230 --> 00:18:18,789
that is generate it for smart card use
of or the hash

269
00:18:18,789 --> 00:18:22,440
lettuce generated for a for

270
00:18:22,440 --> 00:18:26,669
use up that uses be a metric device is

271
00:18:26,669 --> 00:18:30,380
even more accessible let me say in this

272
00:18:30,380 --> 00:18:33,549
this way is more accessible in memory

273
00:18:33,549 --> 00:18:37,720
then if you won't have hugh was this

274
00:18:37,720 --> 00:18:40,760
so keep this in memory as well

275
00:18:40,760 --> 00:18:44,669
am one white on

276
00:18:44,669 --> 00:18:48,250
Linux systems that acecomm arise

277
00:18:48,250 --> 00:18:53,179
and pop of in Active Directory it's not
an unusual

278
00:18:53,179 --> 00:18:56,610
and I think each latch enterprise

279
00:18:56,610 --> 00:18:59,770
has Linux and UNIX systems that

280
00:18:59,770 --> 00:19:04,470
a pop of the Active Directory bad its
even worse

281
00:19:04,470 --> 00:19:08,370
a.m. this one example the

282
00:19:08,370 --> 00:19:12,190
the cover us ticket is excessive a

283
00:19:12,190 --> 00:19:15,460
by each user am

284
00:19:15,460 --> 00:19:19,270
it's not necessary that in administrator
that its

285
00:19:19,270 --> 00:19:24,100
that that's ruled administrator all root
the root account has excess

286
00:19:24,100 --> 00:19:27,390
toll each cover us ticket I'm

287
00:19:27,390 --> 00:19:30,820
in Windows users cannot

288
00:19:30,820 --> 00:19:34,480
export that tickets by default and

289
00:19:34,480 --> 00:19:38,080
administrators as well not it's not so

290
00:19:38,080 --> 00:19:41,919
they might with well with some towards
but

291
00:19:41,919 --> 00:19:46,909
I'm by the FOC they even might not
ex-partner cover stick

292
00:19:46,909 --> 00:19:49,649
soul keep an eye on a

293
00:19:49,649 --> 00:19:53,549
these machines which of school overlook

294
00:19:53,549 --> 00:19:57,289
mile that we have

295
00:19:57,289 --> 00:20:01,010
the basis to understand call these

296
00:20:01,010 --> 00:20:04,200
pics were ok that has happened ok at

297
00:20:04,200 --> 00:20:07,200
credentials past and prudential

298
00:20:07,200 --> 00:20:12,289
reuse in Active Directory what this

299
00:20:12,289 --> 00:20:15,830
pass the hash

300
00:20:15,830 --> 00:20:18,870
you see here at the graphic

301
00:20:18,870 --> 00:20:23,419
that's the normal procedure are the user
enters this process what

302
00:20:23,419 --> 00:20:26,600
in the Hess is generated unverified

303
00:20:26,600 --> 00:20:31,720
by an instance in case of local
authentication

304
00:20:31,720 --> 00:20:35,340
by the local computer always stand alone
system

305
00:20:35,340 --> 00:20:39,059
if and at a car

306
00:20:39,059 --> 00:20:42,779
was a ver tall get

307
00:20:42,779 --> 00:20:46,120
the hash of the use our then

308
00:20:46,120 --> 00:20:50,270
for the Epica it's not necessary

309
00:20:50,270 --> 00:20:53,279
to even break the possible at all to
know the password

310
00:20:53,279 --> 00:20:56,809
his simple injects the hash

311
00:20:56,809 --> 00:21:00,049
of the user in TSS process

312
00:21:00,049 --> 00:21:03,779
of the machine and then he impersonates

313
00:21:03,779 --> 00:21:07,779
the was up from whom he has behesh

314
00:21:07,779 --> 00:21:11,190
past the ticket

315
00:21:11,190 --> 00:21:15,610
is technically a little bit boss Office
2k tip back

316
00:21:15,610 --> 00:21:18,960
its basically the same thing

317
00:21:18,960 --> 00:21:24,700
it to reuse of cover us tickets to
receive saw this ticket

318
00:21:24,700 --> 00:21:28,520
or excess coveralls service directly

319
00:21:28,520 --> 00:21:32,529
if we as human that

320
00:21:32,529 --> 00:21:36,580
and at pickup was able to get

321
00:21:36,580 --> 00:21:40,770
the tgp then

322
00:21:40,770 --> 00:21:44,100
he is a ver tool

323
00:21:44,100 --> 00:21:50,260
impersonate the user he would do this we
will see this

324
00:21:50,260 --> 00:21:55,049
with a a different kind of course it's
possible

325
00:21:55,049 --> 00:21:56,930
he injected the ticket

326
00:21:56,930 --> 00:22:00,150
in the SS process and band he

327
00:22:00,150 --> 00:22:03,570
PS to the domain controller s if he

328
00:22:03,570 --> 00:22:06,640
well the was themself so

329
00:22:06,640 --> 00:22:11,990
it's not it's no more necessary to get
the ticket from that domain controller

330
00:22:11,990 --> 00:22:12,820
because he

331
00:22:12,820 --> 00:22:17,890
already has stolen it then

332
00:22:17,890 --> 00:22:22,450
am with this ticket granting picket

333
00:22:22,450 --> 00:22:27,240
the epic up authenticates to the domain
controller

334
00:22:27,240 --> 00:22:30,460
and he will receive that service

335
00:22:30,460 --> 00:22:34,220
tickets bath I have a table call

336
00:22:34,220 --> 00:22:37,470
this use a he is impersonating

337
00:22:37,470 --> 00:22:43,710
and then he excesses the resource a big
ball lim et

338
00:22:43,710 --> 00:22:47,550
if path the sophist take a because

339
00:22:47,550 --> 00:22:50,610
it we first only 21 we saw spot

340
00:22:50,610 --> 00:22:53,840
it works basically the same way

341
00:22:53,840 --> 00:22:57,800
to see impersonating am

342
00:22:57,800 --> 00:23:02,560
impersonating evaluate user account

343
00:23:02,560 --> 00:23:05,610
its no longer necessary

344
00:23:05,610 --> 00:23:09,860
toll ask the KDC for authentication

345
00:23:09,860 --> 00:23:12,890
need up to request

346
00:23:12,890 --> 00:23:16,380
a service ticket because he already has
it

347
00:23:16,380 --> 00:23:19,430
and then he can excess

348
00:23:19,430 --> 00:23:23,460
the resource

349
00:23:23,460 --> 00:23:26,880
cholera stickers might be poss

350
00:23:26,880 --> 00:23:31,500
Miami cuts and cover us tickets

351
00:23:31,500 --> 00:23:36,200
might be exported Miami cots in awe that
would be used

352
00:23:36,200 --> 00:23:39,750
on another system it's not necessary

353
00:23:39,750 --> 00:23:43,870
that the at Pixar once he harvested

354
00:23:43,870 --> 00:23:47,210
the credentials that he

355
00:23:47,210 --> 00:23:51,390
is that he excess this

356
00:23:51,390 --> 00:23:54,630
the domain from domain computer

357
00:23:54,630 --> 00:23:58,210
he kind he say but all

358
00:23:58,210 --> 00:24:02,970
ex parte the pickets and use it from

359
00:24:02,970 --> 00:24:07,360
everywhere he once network connectivity

360
00:24:07,360 --> 00:24:11,090
supports soul

361
00:24:11,090 --> 00:24:15,260
on the first step on the first step

362
00:24:15,260 --> 00:24:19,280
a from the epic us perspective

363
00:24:19,280 --> 00:24:22,560
we may summarize as follows:

364
00:24:22,560 --> 00:24:25,710
they are different ways

365
00:24:25,710 --> 00:24:30,000
tall octane hasher's and cover us
tickets

366
00:24:30,000 --> 00:24:34,600
ticket granting tickets as well as
service tickets

367
00:24:34,600 --> 00:24:38,340
and ticket granting picket

368
00:24:38,340 --> 00:24:41,620
allows fall impersonation

369
00:24:41,620 --> 00:24:44,640
offer you was up with him the

370
00:24:44,640 --> 00:24:50,830
valid prime of that ticket granting
picket that this by default pin all loss

371
00:24:50,830 --> 00:24:55,690
with this service ticket the

372
00:24:55,690 --> 00:24:58,850
access is restricted to the resource

373
00:24:58,850 --> 00:25:02,210
fall which the service ticket is valid

374
00:25:02,210 --> 00:25:05,410
and it says well 10 not lost its the
bell

375
00:25:05,410 --> 00:25:09,720
validity of this service ticket

376
00:25:09,720 --> 00:25:16,720
so we had we see from and at Pecos
perspective we have some limitations

377
00:25:17,150 --> 00:25:21,010
don't we have we'll we have only

378
00:25:21,010 --> 00:25:25,560
it ticket granting ticket office heard
from you was a this use a problem he is

379
00:25:25,560 --> 00:25:27,500
not the domain administrator

380
00:25:27,500 --> 00:25:31,530
isn't it perhaps it's another one soul

381
00:25:31,530 --> 00:25:35,590
I think it would be mall interesting fun

382
00:25:35,590 --> 00:25:38,919
Pixar tall create

383
00:25:38,919 --> 00:25:42,549
his own pic and thats

384
00:25:42,549 --> 00:25:48,429
what a we are going to do and what we
are talking

385
00:25:48,429 --> 00:25:52,309
what we are talking about self-made

386
00:25:52,309 --> 00:25:56,549
cover us tickets I really fell

387
00:25:56,549 --> 00:26:00,220
to wear them to a conference form

388
00:26:00,220 --> 00:26:03,490
benyamin there P at where he fat

389
00:26:03,490 --> 00:26:07,520
and I like this his hat they were made
with a lot of LAF

390
00:26:07,520 --> 00:26:11,970
am you can imagine as his to Los

391
00:26:11,970 --> 00:26:17,270
written and comp I it with a lot of
laughing with a lot of capabilities

392
00:26:17,270 --> 00:26:22,110
the boy who picket

393
00:26:22,110 --> 00:26:27,659
is the time all t-1000 model

394
00:26:27,659 --> 00:26:31,620
we saw in the introduction it allows you

395
00:26:31,620 --> 00:26:36,270
to practically everything in Active
Directory

396
00:26:36,270 --> 00:26:40,960
and it is not made

397
00:26:40,960 --> 00:26:45,110
by the domain controller pop

398
00:26:45,110 --> 00:26:48,809
it has a very important as you may issue
on

399
00:26:48,809 --> 00:26:52,500
it has a very report and important
requirement

400
00:26:52,500 --> 00:26:57,669
that this unique for the creation of the
boat and Pickard

401
00:26:57,669 --> 00:27:02,480
you need the you need

402
00:27:02,480 --> 00:27:05,980
to hack a domain controller okay that's

403
00:27:05,980 --> 00:27:09,399
a thats need to be clear that

404
00:27:09,399 --> 00:27:13,600
Yukon created you can create a golden
ticket for a domain

405
00:27:13,600 --> 00:27:17,940
with out having the and KLM hey ash

406
00:27:17,940 --> 00:27:22,960
of the cup tgp a call at

407
00:27:22,960 --> 00:27:26,200
but I'm prominent pick us perspective I

408
00:27:26,200 --> 00:27:30,429
may tell you that in

409
00:27:30,429 --> 00:27:35,580
and a 78 years

410
00:27:35,580 --> 00:27:38,659
Windows or Active Directory pen testing

411
00:27:38,659 --> 00:27:42,720
we always got

412
00:27:42,720 --> 00:27:45,090
we always achieve to

413
00:27:45,090 --> 00:27:48,410
from mice the domain controller op

414
00:27:48,410 --> 00:27:54,210
some years ago law now lost meant that
towards

415
00:27:54,210 --> 00:27:57,760
we haven't the towards true create
golden ticket

416
00:27:57,760 --> 00:28:01,770
so the threat was not as big at this is

417
00:28:01,770 --> 00:28:05,480
now remember

418
00:28:05,480 --> 00:28:10,140
the cup tgp account is the primary Trust
Bank of the domain

419
00:28:10,140 --> 00:28:13,510
and this call thousand

420
00:28:13,510 --> 00:28:17,290
change his spouse what normally I'm

421
00:28:17,290 --> 00:28:20,620
any use I count any computer account

422
00:28:20,620 --> 00:28:24,920
that of far less privileged in Active
Directory

423
00:28:24,920 --> 00:28:28,640
need to change that password according
to the policy

424
00:28:28,640 --> 00:28:31,790
all the default domain policy although

425
00:28:31,790 --> 00:28:36,240
the policy follow that is valid for
computer columns

426
00:28:36,240 --> 00:28:40,320
which is 30 days by default Act one

427
00:28:40,320 --> 00:28:43,970
account and precisely the most important

428
00:28:43,970 --> 00:28:47,650
pol doesn't have to change his password

429
00:28:47,650 --> 00:28:51,030
he only changed is possible at

430
00:28:51,030 --> 00:28:55,030
when the domain is after gravest from

431
00:28:55,030 --> 00:28:58,330
2003 22 was hardened

432
00:28:58,330 --> 00:29:01,590
8 Ohio and that this

433
00:29:01,590 --> 00:29:04,670
I've changed as well if you do when

434
00:29:04,670 --> 00:29:08,230
authoritative priest of Active Directory

435
00:29:08,230 --> 00:29:11,680
everyone that this not

436
00:29:11,680 --> 00:29:15,610
so probably at you already half the same
key

437
00:29:15,610 --> 00:29:19,520
and in other important information

438
00:29:19,520 --> 00:29:23,820
the previous Cup TGT

439
00:29:23,820 --> 00:29:28,260
is valid as well soul even if you come
from

440
00:29:28,260 --> 00:29:31,330
2000 and three probably be

441
00:29:31,330 --> 00:29:34,640
hookup tgp account a

442
00:29:34,640 --> 00:29:38,090
if compromise might

443
00:29:38,090 --> 00:29:42,480
be used for golden ticket

444
00:29:42,480 --> 00:29:46,550
yes soul

445
00:29:46,550 --> 00:29:49,710
am he other prerequisites fall

446
00:29:49,710 --> 00:29:53,610
creating a golden ticket as I said

447
00:29:53,610 --> 00:29:56,920
you need the end KLM hash of the cup

448
00:29:56,920 --> 00:30:01,380
PZT account which you see here and you
need

449
00:30:01,380 --> 00:30:05,070
the domain said in the domain name but
if you got this

450
00:30:05,070 --> 00:30:09,280
you already have this as well am

451
00:30:09,280 --> 00:30:13,050
with golden ticket you are

452
00:30:13,050 --> 00:30:16,620
capabilities in Active Directory on
yearly

453
00:30:16,620 --> 00:30:23,250
unlimited who I a book because you are
the stamping authority now

454
00:30:23,250 --> 00:30:27,170
and you are able to talk create

455
00:30:27,170 --> 00:30:32,420
pickets fall existing you with us waiver
to create pick eighth

456
00:30:32,420 --> 00:30:37,200
fall you was a and extend that
capabilities

457
00:30:37,200 --> 00:30:40,540
you even create talk

458
00:30:40,540 --> 00:30:44,920
you even you are the even able to create

459
00:30:44,920 --> 00:30:47,990
non-existing with icons in the domain

460
00:30:47,990 --> 00:30:51,360
you even able to impersonate this

461
00:30:51,360 --> 00:30:55,510
a bit he was a calls so that basically

462
00:30:55,510 --> 00:30:59,950
no restrictions from it at a cost
perspective

463
00:30:59,950 --> 00:31:04,040
be creative yes am

464
00:31:04,040 --> 00:31:09,160
Sol a we will have little the mall

465
00:31:09,160 --> 00:31:16,160
and am I like this one I don't always
use coveralls but when I do

466
00:31:16,810 --> 00:31:20,480
I create called pickets that's from
Benny I mean they're pretty

467
00:31:20,480 --> 00:31:23,850
that saw thanks for him and now

468
00:31:23,850 --> 00:31:27,430
we will see a here

469
00:31:27,430 --> 00:31:31,940
little the mall we will create a golden
ticket

470
00:31:31,940 --> 00:31:38,940
Antti well use it

471
00:31:43,929 --> 00:31:50,929
lot

472
00:31:56,690 --> 00:32:01,639
so this is gonna hyper-v and we have
here some virtual machines

473
00:32:01,639 --> 00:32:04,859
we have the domain controller that it's
running

474
00:32:04,859 --> 00:32:08,609
am you see him here own we have

475
00:32:08,609 --> 00:32:11,739
the epic %uh machine a which

476
00:32:11,739 --> 00:32:14,769
the is even not member of the domain

477
00:32:14,769 --> 00:32:18,899
am it's not necessary an audit or
perform this attack

478
00:32:18,899 --> 00:32:22,570
and we have another machine running um

479
00:32:22,570 --> 00:32:27,039
here you see the epic has machine

480
00:32:27,039 --> 00:32:31,409
and up I will have a look

481
00:32:31,409 --> 00:32:34,749
I will have a look at

482
00:32:34,749 --> 00:32:38,599
am because I call control enable

483
00:32:38,599 --> 00:32:41,749
that's got now you see Who Am I

484
00:32:41,749 --> 00:32:46,109
and that's not the part because I'm on
the attack %uh machine

485
00:32:46,109 --> 00:32:50,940
and am on the attack a machine of Kos I
we need administrative privileges

486
00:32:50,940 --> 00:32:54,220
I will have a look at my

487
00:32:54,220 --> 00:32:58,090
cover us I'm if I have some cover us

488
00:32:58,090 --> 00:33:01,440
tickets start this

489
00:33:01,440 --> 00:33:05,429
is like this and use all you see there
are no cash

490
00:33:05,429 --> 00:33:09,059
tickets Nole as the

491
00:33:09,059 --> 00:33:12,220
a in order to prove

492
00:33:12,220 --> 00:33:16,460
which privileges I have without a golden
ticket

493
00:33:16,460 --> 00:33:21,639
and without being a member of Active
Directory neither new the computer

494
00:33:21,639 --> 00:33:26,190
mall the use up I will try to access

495
00:33:26,190 --> 00:33:29,479
the a

496
00:33:29,479 --> 00:33:35,770
act mean

497
00:33:35,770 --> 00:33:37,650
are the

498
00:33:37,650 --> 00:33:40,870
at Minshall on the domain controller

499
00:33:40,870 --> 00:33:46,770
and

500
00:33:46,770 --> 00:33:49,960
a you might he

501
00:33:49,960 --> 00:33:55,200
it's very clear what will be resolved I
will be prompted for

502
00:33:55,200 --> 00:33:58,880
the user name of course everything works
as designed

503
00:33:58,880 --> 00:34:03,390
now I

504
00:34:03,390 --> 00:34:06,410
I Mimi cuts on the attack %uh machine

505
00:34:06,410 --> 00:34:10,889
and Mal I create the warden

506
00:34:10,889 --> 00:34:17,889
ticket and here

507
00:34:18,350 --> 00:34:21,850
that's an important information QC

508
00:34:21,850 --> 00:34:24,980
a.m. the ID

509
00:34:24,980 --> 00:34:28,020
I gave them I give them the
administrator ID

510
00:34:28,020 --> 00:34:31,030
the golden pickard and group membership

511
00:34:31,030 --> 00:34:34,530
of two main up means of enterprise up
means

512
00:34:34,530 --> 00:34:38,399
and offbeat in not been this traitors of
the

513
00:34:38,399 --> 00:34:41,470
law of the Active Directory of the
domain

514
00:34:41,470 --> 00:34:48,470
that I'm attacking am

515
00:34:52,139 --> 00:34:55,440
soul now you see pop generate et

516
00:34:55,440 --> 00:34:59,329
packs time with the cup TGT account

517
00:34:59,329 --> 00:35:02,400
that we have am

518
00:35:02,400 --> 00:35:06,579
encryption ticket factional right to
encryption ticket

519
00:35:06,579 --> 00:35:09,990
air-popped encrypt it and the cop

520
00:35:09,990 --> 00:35:13,680
credential it's created we have safe

521
00:35:13,680 --> 00:35:17,490
this in the fire and this fire is
thought

522
00:35:17,490 --> 00:35:20,619
in that directory here you see when me
cuts

523
00:35:20,619 --> 00:35:23,640
works so now

524
00:35:23,640 --> 00:35:27,029
we have to inject this ticket

525
00:35:27,029 --> 00:35:30,150
in the SS process

526
00:35:30,150 --> 00:35:33,849
and this works worth that

527
00:35:33,849 --> 00:35:40,849
command

528
00:35:41,270 --> 00:35:47,049
now I would wear k list law I would do
this

529
00:35:47,049 --> 00:35:54,049
in and the syntax of Mimi cuts and you
see

530
00:35:56,809 --> 00:36:00,230
here you see I have it

531
00:36:00,230 --> 00:36:03,940
TGT and what's Betts Corp here you see

532
00:36:03,940 --> 00:36:07,589
the validity of the TGT is not ten hours

533
00:36:07,589 --> 00:36:10,660
there it's ten years so

534
00:36:10,660 --> 00:36:14,339
once I have this ticket and once

535
00:36:14,339 --> 00:36:17,640
I'm not detect that I would be a bit

536
00:36:17,640 --> 00:36:21,029
to use this ticket for a very long time

537
00:36:21,029 --> 00:36:24,839
and now

538
00:36:24,839 --> 00:36:28,920
I will try toll

539
00:36:28,920 --> 00:36:33,220
are assess

540
00:36:33,220 --> 00:36:39,110
again

541
00:36:39,110 --> 00:36:41,640
at the ticket here as well I see it

542
00:36:41,640 --> 00:36:47,590
and then I do this you see

543
00:36:47,590 --> 00:36:51,760
I mounted a I have access

544
00:36:51,760 --> 00:36:55,330
to the administrative home

545
00:36:55,330 --> 00:36:58,820
shall of the domain controller now

546
00:36:58,820 --> 00:37:02,270
I have installed on this machine that is
not pop

547
00:37:02,270 --> 00:37:05,670
effective directory the Active Directory

548
00:37:05,670 --> 00:37:12,670
it users and computers and now

549
00:37:12,790 --> 00:37:17,570
is see a I don't like this

550
00:37:17,570 --> 00:37:20,710
a administrateur am

551
00:37:20,710 --> 00:37:23,790
I go on this account

552
00:37:23,790 --> 00:37:28,040
am I'll change this because that's not
court

553
00:37:28,040 --> 00:37:31,430
am so

554
00:37:31,430 --> 00:37:35,450
here you see M it's only one Exxon

555
00:37:35,450 --> 00:37:38,580
yes one example that demonstrates

556
00:37:38,580 --> 00:37:41,880
that I'm capable to modify

557
00:37:41,880 --> 00:37:45,930
a the create of the Active Directory

558
00:37:45,930 --> 00:37:49,180
s I cook gif lot more pop

559
00:37:49,180 --> 00:37:53,350
I want mile soul we were

560
00:37:53,350 --> 00:37:57,220
continual a which changed to the white
side

561
00:37:57,220 --> 00:38:01,420
mall am and now

562
00:38:01,420 --> 00:38:05,430
want to though

563
00:38:05,430 --> 00:38:09,420
mitigations you may assume that in the
short time

564
00:38:09,420 --> 00:38:12,930
I will be only able to give it a shot

565
00:38:12,930 --> 00:38:17,520
overview so half decisions a heat

566
00:38:17,520 --> 00:38:21,020
I would do it in full versions

567
00:38:21,020 --> 00:38:25,010
one margin for the management and

568
00:38:25,010 --> 00:38:30,180
a little bit more comprehensive washing
the version for the management

569
00:38:30,180 --> 00:38:33,800
this actually it will slide a

570
00:38:33,800 --> 00:38:36,970
am but I think if

571
00:38:36,970 --> 00:38:41,140
it contends important message what's

572
00:38:41,140 --> 00:38:45,270
should be done we short reorganize are

573
00:38:45,270 --> 00:38:49,260
reorganize the administrative practice

574
00:38:49,260 --> 00:38:53,080
and management of Active Directory and
business critical services

575
00:38:53,080 --> 00:38:56,720
with an Active Directory we shot

576
00:38:56,720 --> 00:39:00,040
a common I this with some that I'm not

577
00:39:00,040 --> 00:39:03,580
much but some specific past the hash

578
00:39:03,580 --> 00:39:07,580
and pass the ticket mitigations and

579
00:39:07,580 --> 00:39:11,140
of calls we short who airport

580
00:39:11,140 --> 00:39:15,330
Active Directory security logging and
monitoring

581
00:39:15,330 --> 00:39:20,930
what many companies don't have soul

582
00:39:20,930 --> 00:39:24,800
that what you saw

583
00:39:24,800 --> 00:39:28,280
this will not require

584
00:39:28,280 --> 00:39:31,880
spending a lot of money and fancy
towards

585
00:39:31,880 --> 00:39:37,400
fancy Appliance eth and so on that's the
good news

586
00:39:37,400 --> 00:39:43,880
bop a provided this system it would be a
kind of Management

587
00:39:43,880 --> 00:39:47,290
information don't forget the small print

588
00:39:47,290 --> 00:39:51,600
which iz who were probably

589
00:39:51,600 --> 00:39:54,700
need mall administrative

590
00:39:54,700 --> 00:39:59,530
and operation at we saw sis that's it

591
00:39:59,530 --> 00:40:02,920
management will understand this

592
00:40:02,920 --> 00:40:07,210
probably at least the second slide

593
00:40:07,210 --> 00:40:12,280
so don't forget their smarTrend remember

594
00:40:12,280 --> 00:40:17,010
walk how ruins hat and the keynote
yesterday

595
00:40:17,010 --> 00:40:19,760
about the infor- mation asymmetry

596
00:40:19,760 --> 00:40:23,349
between the person the usually

597
00:40:23,349 --> 00:40:26,539
working in the InfoSec area and

598
00:40:26,539 --> 00:40:31,049
the management easy task

599
00:40:31,049 --> 00:40:35,730
you are done okay

600
00:40:35,730 --> 00:40:39,750
saw little bit more comprehensive bushel

601
00:40:39,750 --> 00:40:44,299
I'm for us probably am

602
00:40:44,299 --> 00:40:48,380
this is a very high level overview and I
will speak

603
00:40:48,380 --> 00:40:51,910
about a from my perspective

604
00:40:51,910 --> 00:40:56,150
the most important topics on in the shot
way

605
00:40:56,150 --> 00:41:00,140
and we may classify

606
00:41:00,140 --> 00:41:05,099
these high-level steps as follows: I
don't want

607
00:41:05,099 --> 00:41:08,730
I don't we'll talk about the
preconditions

608
00:41:08,730 --> 00:41:13,140
bot a obey really a precondition ce

609
00:41:13,140 --> 00:41:18,510
no US it have process patch management
and so on and place

610
00:41:18,510 --> 00:41:24,000
okay band what's very important these
I'm

611
00:41:24,000 --> 00:41:27,319
and implement administration model

612
00:41:27,319 --> 00:41:32,109
and PS you see that too

613
00:41:32,109 --> 00:41:36,369
mitigations that I great that's one
reason

614
00:41:36,369 --> 00:41:40,700
I will come late on tour this I don't
think that they are

615
00:41:40,700 --> 00:41:44,579
so I'm them might be important

616
00:41:44,579 --> 00:41:48,329
from Microsoft Prospect Point of who
they are

617
00:41:48,329 --> 00:41:52,839
from my point of view not so much and
then

618
00:41:52,839 --> 00:41:56,740
apart from these designed and
organizational control its

619
00:41:56,740 --> 00:42:00,960
you will have of cause a lot of
technical control its

620
00:42:00,960 --> 00:42:04,270
we will do a walk-through

621
00:42:04,270 --> 00:42:07,299
tall the SME TK shins

622
00:42:07,299 --> 00:42:11,710
the vary most

623
00:42:11,710 --> 00:42:13,180
important

624
00:42:13,180 --> 00:42:16,450
mitigation yes the design

625
00:42:16,450 --> 00:42:20,420
and the implementation often at been a
straight to

626
00:42:20,420 --> 00:42:26,570
model with PS you might

627
00:42:26,570 --> 00:42:30,630
you see this year you might Preece your

628
00:42:30,630 --> 00:42:34,110
3 p.s one with domain controllers

629
00:42:34,110 --> 00:42:37,360
very simple one what's of us and one

630
00:42:37,360 --> 00:42:40,360
with workstations and

631
00:42:40,360 --> 00:42:43,600
the you don't should makes

632
00:42:43,600 --> 00:42:48,550
neva the Active Directory you in turn a
forest

633
00:42:48,550 --> 00:42:51,930
with that DMZ for us keep them

634
00:42:51,930 --> 00:42:56,270
separator soul

635
00:42:56,270 --> 00:43:01,800
how with this model walks you see it
here

636
00:43:01,800 --> 00:43:06,290
in each PL you have

637
00:43:06,290 --> 00:43:09,290
all administrative

638
00:43:09,290 --> 00:43:13,550
or high privilege to columns it's not
the only

639
00:43:13,550 --> 00:43:16,630
a happiness

640
00:43:16,630 --> 00:43:20,250
it's not only a model fall
administrative

641
00:43:20,250 --> 00:43:23,890
PS it's a model fall if you'll

642
00:43:23,890 --> 00:43:28,650
speak in a broader way it's a model for
credential partitioning

643
00:43:28,650 --> 00:43:32,870
yes and you short hair

644
00:43:32,870 --> 00:43:38,240
in each tier should have is all

645
00:43:38,240 --> 00:43:41,410
administrative personnel with

646
00:43:41,410 --> 00:43:45,910
all its administrative work stations

647
00:43:45,910 --> 00:43:50,210
that might be chock heightened some
sausage might be hyper-v Sol

648
00:43:50,210 --> 00:43:54,290
but they it it should be dedicated
machines

649
00:43:54,290 --> 00:43:58,120
and these administrative

650
00:43:58,120 --> 00:44:03,940
personal with high all hi privileged
account short never log on

651
00:44:03,940 --> 00:44:09,610
to law too low or privileged re sauces

652
00:44:09,610 --> 00:44:12,690
and am I will call who this

653
00:44:12,690 --> 00:44:16,280
in them more detail how this model walks

654
00:44:16,280 --> 00:44:19,770
first of all each

655
00:44:19,770 --> 00:44:23,590
administrative all each privileged Ruth
sauce

656
00:44:23,590 --> 00:44:27,070
has to be classified ass to be longing

657
00:44:27,070 --> 00:44:32,780
all only 21 Tia personnel

658
00:44:32,780 --> 00:44:36,230
that hath responsibilities on different
PS

659
00:44:36,230 --> 00:44:40,220
if you hot if you have options that at
Minister

660
00:44:40,220 --> 00:44:44,070
the Active Directory domain controllers
and if you have

661
00:44:44,070 --> 00:44:47,680
up means that as well at mean this star

662
00:44:47,680 --> 00:44:50,810
workstations and member so us

663
00:44:50,810 --> 00:44:54,670
Bay must have different columns

664
00:44:54,670 --> 00:44:59,300
that's not so I'm usual yes am

665
00:44:59,300 --> 00:45:02,870
then account

666
00:45:02,870 --> 00:45:05,870
that currently locks onto my computer

667
00:45:05,870 --> 00:45:10,300
yes must be split into mytable columns
this is very important

668
00:45:10,300 --> 00:45:15,720
force officer Collins if you have had
the agent running on each machine with

669
00:45:15,720 --> 00:45:18,730
at domain have been privileged thats

670
00:45:18,730 --> 00:45:22,570
back of Kos am it would be better

671
00:45:22,570 --> 00:45:25,810
if it's in a column that only provides

672
00:45:25,810 --> 00:45:29,340
service for the main control us and stop
us

673
00:45:29,340 --> 00:45:34,450
and it would really be better if it was
separated

674
00:45:34,450 --> 00:45:38,590
North Park pS While that you have a

675
00:45:38,590 --> 00:45:42,030
service the columns that are working
only

676
00:45:42,030 --> 00:45:47,240
in one Pia and of course this the
council all must have different

677
00:45:47,240 --> 00:45:48,070
passwords

678
00:45:48,070 --> 00:45:54,050
administrative accounts may not control

679
00:45:54,050 --> 00:45:57,060
higher we saw sis and lower

680
00:45:57,060 --> 00:46:00,200
as well we already had this and

681
00:46:00,200 --> 00:46:03,280
if is for example Nessus

682
00:46:03,280 --> 00:46:07,790
necessary that the domain at min at
ministers

683
00:46:07,790 --> 00:46:11,700
accounts of solve us all

684
00:46:11,700 --> 00:46:16,510
a South administrators he should use

685
00:46:16,510 --> 00:46:20,680
two words that do not expose their
credentials

686
00:46:20,680 --> 00:46:24,740
in the eighth as process soul we are
coming

687
00:46:24,740 --> 00:46:27,770
be little bit to the technical side it
NOP

688
00:46:27,770 --> 00:46:32,470
it's not only it's not the media
organization up ask

689
00:46:32,470 --> 00:46:36,740
to implement these PS you have tall

690
00:46:36,740 --> 00:46:40,410
a comp and I them with some technical

691
00:46:40,410 --> 00:46:43,470
configurations and one of them

692
00:46:43,470 --> 00:46:46,760
is this for example use MMC consort

693
00:46:46,760 --> 00:46:50,180
MMC console its dole expose the
credentials

694
00:46:50,180 --> 00:46:53,630
dole queues power share script

695
00:46:53,630 --> 00:46:56,849
a in the sudden conflagration

696
00:46:56,849 --> 00:47:00,359
they will expose config alright a
credentials

697
00:47:00,359 --> 00:47:04,510
don't use a remote desktop

698
00:47:04,510 --> 00:47:08,260
on another Kia it will expose
credentials

699
00:47:08,260 --> 00:47:14,440
of cost limit the number of
administrative accounts and the highest

700
00:47:14,440 --> 00:47:15,030
hiya

701
00:47:15,030 --> 00:47:18,490
the scheme at mince should have members

702
00:47:18,490 --> 00:47:22,630
on the on demand Kenny limit the number
of course

703
00:47:22,630 --> 00:47:25,930
on which administrated administrative
credentials

704
00:47:25,930 --> 00:47:29,770
I expose and limit the roles

705
00:47:29,770 --> 00:47:34,859
with required up more privileges to the
privilege

706
00:47:34,859 --> 00:47:38,660
they are really need am

707
00:47:38,660 --> 00:47:42,940
a I'm they are in other things

708
00:47:42,940 --> 00:47:46,640
for remember administrative

709
00:47:46,640 --> 00:47:50,089
Collins shouldn't be granted that the
back privilege

710
00:47:50,089 --> 00:47:53,160
because the debug privilege allows to
look

711
00:47:53,160 --> 00:47:58,869
in another process the administrators
have it by default

712
00:47:58,869 --> 00:48:01,990
I'm shock so keep an eye on this

713
00:48:01,990 --> 00:48:06,380
am restricts

714
00:48:06,380 --> 00:48:09,950
and now all another very important
control

715
00:48:09,950 --> 00:48:13,510
we stripped and protect local calls

716
00:48:13,510 --> 00:48:17,930
that is called of

717
00:48:17,930 --> 00:48:21,060
up Sam databases

718
00:48:21,060 --> 00:48:27,410
on member computers Microsoft now we
comments

719
00:48:27,410 --> 00:48:30,700
that you even don't use these Kong's

720
00:48:30,700 --> 00:48:34,110
this is quite difficult to achieve

721
00:48:34,110 --> 00:48:37,740
pop to might protect them in some way

722
00:48:37,740 --> 00:48:44,160
at you might and false local account
restrictions for remote access

723
00:48:44,160 --> 00:48:47,450
for example you might in my network lock
on

724
00:48:47,450 --> 00:48:54,410
that up there are several kind of lock
on pipes and for example network lock on

725
00:48:54,410 --> 00:48:58,940
should be denied fall local accounts and
of calls

726
00:48:58,940 --> 00:49:02,670
there should be in management solution
to fall

727
00:49:02,670 --> 00:49:05,770
high privilege local accounts

728
00:49:05,770 --> 00:49:08,930
some bariloche enterprise

729
00:49:08,930 --> 00:49:11,960
do have this but not all

730
00:49:11,960 --> 00:49:15,950
very simple proposal

731
00:49:15,950 --> 00:49:19,350
might look like this: the simple
proposal that

732
00:49:19,350 --> 00:49:24,690
a I can give here am but that might be
adopted from you all

733
00:49:24,690 --> 00:49:27,860
you have one Kia

734
00:49:27,860 --> 00:49:32,200
for DC's 1pa force of us and business
Kritika

735
00:49:32,200 --> 00:49:35,240
applications with at least

736
00:49:35,240 --> 00:49:38,760
these three compartments with him

737
00:49:38,760 --> 00:49:42,190
the Kia and finally you have

738
00:49:42,190 --> 00:49:46,030
best top laptops of cost it would be
quote

739
00:49:46,030 --> 00:49:50,190
if you have some com Pocky meant comp
argumentation

740
00:49:50,190 --> 00:49:53,870
within that Pia am

741
00:49:53,870 --> 00:49:58,150
I think you already and I stopped what
are the benefits

742
00:49:58,150 --> 00:50:02,570
of this a of this meeting gation

743
00:50:02,570 --> 00:50:07,380
I think in reality am we don't have any
alternative

744
00:50:07,380 --> 00:50:12,920
because am if you don't expose your
credentials

745
00:50:12,920 --> 00:50:16,430
simply neck epic I won't be able to to
harvest it

746
00:50:16,430 --> 00:50:19,529
right

747
00:50:19,529 --> 00:50:22,239
soul am this

748
00:50:22,239 --> 00:50:26,400
athletes Toyota a leets for comment

749
00:50:26,400 --> 00:50:30,359
that am that I like very much their
parents had

750
00:50:30,359 --> 00:50:33,359
in his in his keynote

751
00:50:33,359 --> 00:50:37,049
yesterday am dole

752
00:50:37,049 --> 00:50:41,839
at Beauty it by you all biz you are in
this case

753
00:50:41,839 --> 00:50:45,789
administrative pia mater by you all

754
00:50:45,789 --> 00:50:49,579
don't buy it am but we are still not
done

755
00:50:49,579 --> 00:50:52,619
am i will. spend some what's on

756
00:50:52,619 --> 00:50:56,630
is out you progress that's a
recommendation from Microsoft that's

757
00:50:56,630 --> 00:50:57,309
from in

758
00:50:57,309 --> 00:51:00,819
architectural and design perspective
very interesting

759
00:51:00,819 --> 00:51:06,029
you don't expose the administrative
accounts because

760
00:51:06,029 --> 00:51:09,299
the administrative accounts of the
production domain

761
00:51:09,299 --> 00:51:12,339
a man bus in there trusted

762
00:51:12,339 --> 00:51:15,719
call rest in administrative environment

763
00:51:15,719 --> 00:51:19,869
so and here you find these credentials

764
00:51:19,869 --> 00:51:23,339
pop did thats court yes

765
00:51:23,339 --> 00:51:26,670
that's and and that enhances security
but

766
00:51:26,670 --> 00:51:29,819
remember what we said the

767
00:51:29,819 --> 00:51:33,109
most important Trust Bank of Active
Directory

768
00:51:33,109 --> 00:51:36,219
yes their cup cutie account

769
00:51:36,219 --> 00:51:40,059
and distrust on car

770
00:51:40,059 --> 00:51:43,630
a it's not protected by the enhance
forest

771
00:51:43,630 --> 00:51:47,890
so am even from a design perspective

772
00:51:47,890 --> 00:51:51,140
we might question whether this model

773
00:51:51,140 --> 00:51:54,349
is that what one or not I tempt

774
00:51:54,349 --> 00:51:57,710
it it depends a little bit on the
administrative praxis

775
00:51:57,710 --> 00:52:02,299
it absent sick it at San additional
security layout but

776
00:52:02,299 --> 00:52:05,519
it passing provide the solution fall

777
00:52:05,519 --> 00:52:08,900
the call problem so what about some

778
00:52:08,900 --> 00:52:13,920
other high-level control what I only
mention that most important one and I

779
00:52:13,920 --> 00:52:15,200
will mix now

780
00:52:15,200 --> 00:52:19,239
the all the members in the domain and
half

781
00:52:19,239 --> 00:52:23,239
or s and application software up today
I'm

782
00:52:23,239 --> 00:52:26,239
I won't speak about possible both I
already did it

783
00:52:26,239 --> 00:52:29,920
you know it and so on have a special ok

784
00:52:29,920 --> 00:52:33,099
its author calls we come we will come

785
00:52:33,099 --> 00:52:37,359
let up to this one slide later have you
a C

786
00:52:37,359 --> 00:52:41,529
enabled at least it defaults have Tepe

787
00:52:41,529 --> 00:52:45,450
enabled and he met deployed a

788
00:52:45,450 --> 00:52:48,729
at least on clients and on PCs

789
00:52:48,729 --> 00:52:52,880
and on I S web servers as well Havelock

790
00:52:52,880 --> 00:52:56,180
on edition and PFS provision and

791
00:52:56,180 --> 00:52:59,779
implement restricted group for
privileged it counts

792
00:52:59,779 --> 00:53:03,009
and don't give the app mints the key but
privilege

793
00:53:03,009 --> 00:53:06,069
about saw this the columns

794
00:53:06,069 --> 00:53:09,609
they are a what be a a lot to say

795
00:53:09,609 --> 00:53:12,869
I leave it to this very good paper which

796
00:53:12,869 --> 00:53:16,789
is a kind of my street for active
directory

797
00:53:16,789 --> 00:53:20,150
administrators in Active Directory
security

798
00:53:20,150 --> 00:53:24,140
last but not least some what's

799
00:53:24,140 --> 00:53:27,779
am in awe that all me to gape

800
00:53:27,779 --> 00:53:32,710
pasta has party ticket golden ticket
apec's

801
00:53:32,710 --> 00:53:36,789
am that's not so much for two extra

802
00:53:36,789 --> 00:53:41,499
if you implement the mitigation sigh
mention

803
00:53:41,499 --> 00:53:45,180
especially the administrative

804
00:53:45,180 --> 00:53:48,219
p.m. model you already did the lock

805
00:53:48,219 --> 00:53:52,630
a lot do this stuff soul

806
00:53:52,630 --> 00:53:57,109
I already mentioned auger and picnic now

807
00:53:57,109 --> 00:54:00,979
that's mule reset the cop ki GTA called

808
00:54:00,979 --> 00:54:04,079
on a regular basis badass

809
00:54:04,079 --> 00:54:08,180
since two weeks a script fiber from
Microsoft

810
00:54:08,180 --> 00:54:11,369
I'm Ashok

811
00:54:11,369 --> 00:54:14,819
not be so many complications we will my

812
00:54:14,819 --> 00:54:17,950
we on the floor we may talk a about this

813
00:54:17,950 --> 00:54:22,690
if you want it and the we don't have
time now to do this

814
00:54:22,690 --> 00:54:28,670
and of calls to at this directory
security monitoring which what be

815
00:54:28,670 --> 00:54:31,220
a an extra topic

816
00:54:31,220 --> 00:54:34,400
I'm and could be filled a loss and so on

817
00:54:34,400 --> 00:54:37,780
partially icon do this but finally

818
00:54:37,780 --> 00:54:41,550
what we will provide together with the
slights

819
00:54:41,550 --> 00:54:45,369
we paid a kind of although or

820
00:54:45,369 --> 00:54:49,660
evaluations of meaty cations I think
this is

821
00:54:49,660 --> 00:54:53,290
very useful am because

822
00:54:53,290 --> 00:54:56,369
a you see here the mitigation

823
00:54:56,369 --> 00:54:59,790
for example at mint hearing credential
partitioning

824
00:54:59,790 --> 00:55:03,900
who have some deep hyatt's of course you
couldn't have all

825
00:55:03,900 --> 00:55:07,840
then you have the security benefit on a
scale from

826
00:55:07,840 --> 00:55:12,660
excellent to very low to have the
operation of usability

827
00:55:12,660 --> 00:55:16,310
of this mitigation

828
00:55:16,310 --> 00:55:20,460
and then eso as well on a scale from

829
00:55:20,460 --> 00:55:23,560
excellent avail all and then

830
00:55:23,560 --> 00:55:26,790
you have attributes to each mitigation

831
00:55:26,790 --> 00:55:31,890
mitigates credential fair YES on all me
to gauge credential use

832
00:55:31,890 --> 00:55:35,099
me to gauge privilege escalation

833
00:55:35,099 --> 00:55:39,310
mitigates lateral movement and Pia

834
00:55:39,310 --> 00:55:43,200
a effectiveness against me make cuts if
you will its

835
00:55:43,200 --> 00:55:46,820
it's quite long it's only a screenshot
from the axle

836
00:55:46,820 --> 00:55:50,520
am you will see that the that on yearly

837
00:55:50,520 --> 00:55:54,070
no am no medications against me cuts

838
00:55:54,070 --> 00:55:58,220
am facilitate security monitoring

839
00:55:58,220 --> 00:56:02,420
the control and from our perspective of
you

840
00:56:02,420 --> 00:56:06,530
must have all reccommend at and I think

841
00:56:06,530 --> 00:56:11,480
with this light you will get some
valuable information

842
00:56:11,480 --> 00:56:15,400
inogda to design hewer appropriate

843
00:56:15,400 --> 00:56:19,040
security controls saw

844
00:56:19,040 --> 00:56:22,260
this force very quick and

845
00:56:22,260 --> 00:56:25,980
prosp overview am

846
00:56:25,980 --> 00:56:32,980
thank you for your attention

847
00:56:36,180 --> 00:56:38,710
rape

848
00:56:38,710 --> 00:56:44,140
yes please

849
00:56:44,140 --> 00:56:47,339
tape

850
00:56:47,339 --> 00:56:52,760
see back up

851
00:56:52,760 --> 00:56:56,099
very isolated yes colours

852
00:56:56,099 --> 00:57:00,150
break really control

853
00:57:00,150 --> 00:57:03,260
thing yes they did

854
00:57:03,260 --> 00:57:08,240
they did was have a 2003 it was possible
to create forest trust

855
00:57:08,240 --> 00:57:11,970
and we actually at this time recommended
at

856
00:57:11,970 --> 00:57:15,070
vary a large organization to do this
store

857
00:57:15,070 --> 00:57:18,940
talk put they are a minute counts in
this domain

858
00:57:18,940 --> 00:57:24,000
and pot the important think with
relationship to the cup to key account

859
00:57:24,000 --> 00:57:29,390
it doesn't at a layer of protection for
this account it Athens a of protection

860
00:57:29,390 --> 00:57:31,230
for the administrator for calls

861
00:57:31,230 --> 00:57:34,890
one

862
00:57:34,890 --> 00:57:39,430
question we had

863
00:57:39,430 --> 00:57:44,430
all by elite

864
00:57:44,430 --> 00:57:47,940
over yes use if yes

865
00:57:47,940 --> 00:57:52,270
recommendations the who'll

866
00:57:52,270 --> 00:57:57,770
yes you Eagles here

867
00:57:57,770 --> 00:58:02,490
okay I i I would say only a very few
words to this because

868
00:58:02,490 --> 00:58:05,859
from its its it's quite complicated

869
00:58:05,859 --> 00:58:10,020
the shock version is am past the heshe

870
00:58:10,020 --> 00:58:13,760
and passed the ticket attacks a very
very difficult

871
00:58:13,760 --> 00:58:17,410
to depict because valmeyer a free am

872
00:58:17,410 --> 00:58:20,800
they use are all the attacker uses legal

873
00:58:20,800 --> 00:58:24,810
credentials and the only thing

874
00:58:24,810 --> 00:58:27,990
we might be a lil is a kind

875
00:58:27,990 --> 00:58:31,839
of anomaly detection you have to know

876
00:58:31,839 --> 00:58:36,079
how you administrators work you have to
know for example at

877
00:58:36,079 --> 00:58:40,109
what kind that iraq the of

878
00:58:40,109 --> 00:58:43,210
this might be an epic this might be an

879
00:58:43,210 --> 00:58:46,290
a in in the in indicator it

880
00:58:46,290 --> 00:58:49,420
at must be not is in awe as well but it
might be

881
00:58:49,420 --> 00:58:54,690
and I'm but if you for example the final
ok on pipes

882
00:58:54,690 --> 00:58:58,349
for example administrative work on
shortened lock on

883
00:58:58,349 --> 00:59:01,390
on lower resource s and

884
00:59:01,390 --> 00:59:05,089
if you prohibit a for example remote
desktop

885
00:59:05,089 --> 00:59:09,270
and if then comes the service account
with the remote desktop connection

886
00:59:09,270 --> 00:59:14,470
then this might be quite suspicious so
there are some possibilities

887
00:59:14,470 --> 00:59:18,050
to monitor this bus but if it put

888
00:59:18,050 --> 00:59:22,099
if the if it's it possible to take oath
the epic and no laws

889
00:59:22,099 --> 00:59:25,250
how your work whole gotten a straight as
works

890
00:59:25,250 --> 00:59:29,100
its nearly impossible

891
00:59:29,100 --> 00:59:32,380
not question on really and

892
00:59:32,380 --> 00:59:39,380
and not gonna our a group like

893
00:59:39,510 --> 00:59:45,330
by 522

894
00:59:45,330 --> 00:59:49,150
for thank you

895
00:59:49,150 --> 00:59:51,670
up thank you

