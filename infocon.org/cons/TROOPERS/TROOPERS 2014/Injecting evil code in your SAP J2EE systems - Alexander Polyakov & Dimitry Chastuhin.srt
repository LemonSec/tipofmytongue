1
00:00:02,500 --> 00:00:06,540
me a talk at first you know you have a
technical problems but if it was your

2
00:00:06,540 --> 00:00:09,150
talk is last they don't have it changes
so I prefer

3
00:00:09,150 --> 00:00:12,830
for spa okay so maybe

4
00:00:12,830 --> 00:00:17,540
four or five years ago I gave my second
presentation in my life in this

5
00:00:17,540 --> 00:00:18,310
conference

6
00:00:18,310 --> 00:00:21,950
and was about basically security and I
suppose it was the first one

7
00:00:21,950 --> 00:00:26,980
presentation about this it is a cute in
troopers today we have five

8
00:00:26,980 --> 00:00:30,140
presentations about a city security the
special track

9
00:00:30,140 --> 00:00:33,329
and also the special work show the day
before

10
00:00:33,329 --> 00:00:37,969
so I think it's something changed in SF
this huge area

11
00:00:37,969 --> 00:00:41,879
and now more people care about that
which is rated

12
00:00:41,879 --> 00:00:46,399
I for me I'm eyes and robotic of the
city of

13
00:00:46,399 --> 00:00:49,999
your piece can company from I most
organized the

14
00:00:49,999 --> 00:00:54,300
unites conference as hardcore techno
security conference thing

15
00:00:54,300 --> 00:00:58,589
in russia arm what else you can for some

16
00:00:58,589 --> 00:01:02,859
twitter-like the right nice world we
making different pictures

17
00:01:02,859 --> 00:01:05,950
of different people around the world
with our

18
00:01:05,950 --> 00:01:09,590
merchandising like flex-time the shows
and whatever

19
00:01:09,590 --> 00:01:13,880
and mycotic midget just a hint he is not
here unfortunately

20
00:01:13,880 --> 00:01:17,900
I is very busy with his penetration
testing theaters and so on

21
00:01:17,900 --> 00:01:21,070
I'll but he wanted to say hello to
everybody

22
00:01:21,070 --> 00:01:25,140
um and what we do with

23
00:01:25,140 --> 00:01:29,650
skew to suffer for analyzing SAP systems
that

24
00:01:29,650 --> 00:01:33,240
and so on and I hope you already in

25
00:01:33,240 --> 00:01:37,160
know all this stuff um so we're talking
about the SEP

26
00:01:37,160 --> 00:01:40,470
a and I think here in Germany

27
00:01:40,470 --> 00:01:43,880
near the recipe headquarters many people

28
00:01:43,880 --> 00:01:47,700
know what it is so how many of you don't
know what is a city

29
00:01:47,700 --> 00:01:51,100
created the first conference were

30
00:01:51,100 --> 00:01:54,150
nobody put their hands

31
00:01:54,150 --> 00:01:57,470
this question up

32
00:01:57,470 --> 00:02:01,430
okay so it's the most popular Pacific
Asian and we have

33
00:02:01,430 --> 00:02:05,670
like 3 different main platforms like

34
00:02:05,670 --> 00:02:09,300
about stick to our stake in the business
subjects I

35
00:02:09,300 --> 00:02:12,879
as my talk is the first 1i think I can
spend a little bit

36
00:02:12,879 --> 00:02:16,709
time on I discussing more general

37
00:02:16,709 --> 00:02:20,519
SAP security stuff like I'll what kind
of problems

38
00:02:20,519 --> 00:02:24,999
may happen if if somebody break this the
system but I suppose you're the No

39
00:02:24,999 --> 00:02:29,200
stuff like this by Nash & South Asian
for also

40
00:02:29,200 --> 00:02:33,239
all those scary things I may happen if
you

41
00:02:33,239 --> 00:02:37,359
I don't care about the SAP security

42
00:02:37,359 --> 00:02:40,639
I and it'll be though the SAP
vulnerabilities

43
00:02:40,639 --> 00:02:43,810
so where by now we have like more than
are

44
00:02:43,810 --> 00:02:46,909
2800 maybe now is 900

45
00:02:46,909 --> 00:02:50,480
I am what can I say

46
00:02:50,480 --> 00:02:54,310
like in a disount in San I it was a high
peak

47
00:02:54,310 --> 00:02:59,629
where as city itself started to do more
research in SAP security

48
00:02:59,629 --> 00:03:03,329
I now we have a little bit less

49
00:03:03,329 --> 00:03:06,450
vulnerabilities in SAP system every year

50
00:03:06,450 --> 00:03:10,400
but I can conclude that there are more
critical and more interesting so

51
00:03:10,400 --> 00:03:14,299
like look all the low-hanging fruits
were found in the

52
00:03:14,299 --> 00:03:18,109
Tucson 10 2012 and now with time to find
something

53
00:03:18,109 --> 00:03:22,489
I more interesting are

54
00:03:22,489 --> 00:03:26,099
and some other interesting things about

55
00:03:26,099 --> 00:03:29,730
a SEP securities that most people think
that

56
00:03:29,730 --> 00:03:33,540
it's only internal problem but it's not
I

57
00:03:33,540 --> 00:03:38,669
we we meetin research are we scan all
the internet against a recipe

58
00:03:38,669 --> 00:03:42,209
services I just wanted to know how many

59
00:03:42,209 --> 00:03:45,269
FB services I

60
00:03:45,269 --> 00:03:48,939
exposed to the internet they were
surprised like there are a lot of

61
00:03:48,939 --> 00:03:52,090
our services exposed internet not only
are you know

62
00:03:52,090 --> 00:03:55,599
is to be services like Port islands here
and so on I

63
00:03:55,599 --> 00:03:59,809
but also their management system
management services like this is because

64
00:03:59,809 --> 00:04:01,409
control a message to your

65
00:04:01,409 --> 00:04:04,639
et cetera I'll so

66
00:04:04,639 --> 00:04:08,239
those numbers are bike the percent of
companies

67
00:04:08,239 --> 00:04:11,980
I which exposed one or more different
services

68
00:04:11,980 --> 00:04:15,219
like I a percent of companies I

69
00:04:15,219 --> 00:04:19,620
expose SEP AMC services which is are
remote management

70
00:04:19,620 --> 00:04:23,270
services probably used by administrators

71
00:04:23,270 --> 00:04:27,240
to you know to configure and to manage
it'd be

72
00:04:27,240 --> 00:04:30,940
system from home but in reality those

73
00:04:30,940 --> 00:04:34,639
services should not be exposed to the
Internet because

74
00:04:34,639 --> 00:04:37,720
all of them have kinda vulnerabilities

75
00:04:37,720 --> 00:04:42,319
some other have information disclosed
issues the summer them

76
00:04:42,319 --> 00:04:46,259
have a were critical of buffer overflow
a religious message server in

77
00:04:46,259 --> 00:04:53,259
and so on so let's start with

78
00:04:54,490 --> 00:04:58,360
my topic and up

79
00:04:58,360 --> 00:05:01,490
today we're we have lots of a different

80
00:05:01,490 --> 00:05:04,650
application servers for SE

81
00:05:04,650 --> 00:05:08,879
I so the beginning it was only the ACP a
BOP

82
00:05:08,879 --> 00:05:12,680
last NetWeaver about application server
and then we've

83
00:05:12,680 --> 00:05:15,840
up then they create basic unit with Java

84
00:05:15,840 --> 00:05:19,229
then they acquired in subjects and a
half a billion subjects

85
00:05:19,229 --> 00:05:23,650
then they create Hannah us a base on one
platform I said before E

86
00:05:23,650 --> 00:05:29,550
so although both application service are
different and have their own problems

87
00:05:29,550 --> 00:05:33,259
I up we r focused up

88
00:05:33,259 --> 00:05:37,229
with that im too focused on the
journalistic because

89
00:05:37,229 --> 00:05:42,590
you know recently more most the did the
research was focused on about 60

90
00:05:42,590 --> 00:05:45,629
will we always trying to find something

91
00:05:45,629 --> 00:05:48,650
something year and

92
00:05:48,650 --> 00:05:54,550
the Joe stack up so the systems like
portal solution manager XI and that

93
00:05:54,550 --> 00:05:56,080
you're developing infrastructure

94
00:05:56,080 --> 00:05:59,280
based on just a I we gave

95
00:05:59,280 --> 00:06:02,340
talk about the SAP portal I'll

96
00:06:02,340 --> 00:06:05,550
a little bit long but it's nice Solution
Manager I

97
00:06:05,550 --> 00:06:09,050
will present their own abilities in up

98
00:06:09,050 --> 00:06:13,370
exchange infrastructure like South
Africa's forgery vulnerabilities

99
00:06:13,370 --> 00:06:16,439
and now is the time to talk about their
nephew

100
00:06:16,439 --> 00:06:20,379
development infrastructure I'll

101
00:06:20,379 --> 00:06:24,780
so basically in two worlds it's like a
system were

102
00:06:24,780 --> 00:06:28,039
people develop are additional
functionality to

103
00:06:28,039 --> 00:06:32,439
nurture job but for are it consists of
different

104
00:06:32,439 --> 00:06:35,439
combines like design-time repository

105
00:06:35,439 --> 00:06:39,210
company your service and so on and so on
I'll

106
00:06:39,210 --> 00:06:42,629
let's look at their at this picture and
more in details

107
00:06:42,629 --> 00:06:46,300
up so we have the component

108
00:06:46,300 --> 00:06:51,050
which go decide time repository actually
it's like an SVN

109
00:06:51,050 --> 00:06:54,050
service for for the software so

110
00:06:54,050 --> 00:06:57,469
here all the stores called or up

111
00:06:57,469 --> 00:07:00,710
java-based applications store I

112
00:07:00,710 --> 00:07:04,819
just saw Scott them have accompanied
bill serious

113
00:07:04,819 --> 00:07:09,919
is is where all the software is building

114
00:07:09,919 --> 00:07:14,930
I up

115
00:07:14,930 --> 00:07:18,629
next one is the change management
service I is actually

116
00:07:18,629 --> 00:07:21,860
up where we tracking all they're all the
changes

117
00:07:21,860 --> 00:07:26,500
and keep versions updated and so on and
so on

118
00:07:26,500 --> 00:07:30,020
I'll and a system landscape directory is

119
00:07:30,020 --> 00:07:34,900
like a I the place were

120
00:07:34,900 --> 00:07:38,150
we manage to all the stuff together

121
00:07:38,150 --> 00:07:43,080
and that we were developers to do is up
the classification based on Eclipse

122
00:07:43,080 --> 00:07:46,159
where developers you know

123
00:07:46,159 --> 00:07:50,729
connect to all those applications and
can creative

124
00:07:50,729 --> 00:07:54,759
ride the soft were and so on

125
00:07:54,759 --> 00:07:58,660
are so all this stuff for except the ACM
is like

126
00:07:58,660 --> 00:08:01,660
typical development this structure I

127
00:08:01,660 --> 00:08:06,350
as the Emmys software deployment manager
so if the system where we

128
00:08:06,350 --> 00:08:10,910
a deploy something and then this system
deployed this

129
00:08:10,910 --> 00:08:15,370
on the are now

130
00:08:15,370 --> 00:08:18,590
production systems so

131
00:08:18,590 --> 00:08:22,949
this one is the main component to our
where we need to take care

132
00:08:22,949 --> 00:08:27,050
I because if somebody can get access to
as the AM

133
00:08:27,050 --> 00:08:30,860
he can to upload their malicious code
inside the

134
00:08:30,860 --> 00:08:37,320
up production systems so that is the AM

135
00:08:37,320 --> 00:08:41,240
I we have the SDM green as the answer

136
00:08:41,240 --> 00:08:45,950
and this error is can be connected to
database and challenging or

137
00:08:45,950 --> 00:08:51,350
file system and so so it's it's very
simple application you basically

138
00:08:51,350 --> 00:08:55,270
connect to the you have a up

139
00:08:55,270 --> 00:08:59,380
fat client written on shower I'll

140
00:08:59,380 --> 00:09:04,170
you connect to the server you can upload

141
00:09:04,170 --> 00:09:06,660
execute a jar files or

142
00:09:06,660 --> 00:09:11,460
Dr file I and they will be uploaded only
you can

143
00:09:11,460 --> 00:09:16,330
or you can a deploy or on deployed

144
00:09:16,330 --> 00:09:20,100
their applications pretty simple up

145
00:09:20,100 --> 00:09:23,550
it can be executed as a stand-alone or
as a Service

146
00:09:23,550 --> 00:09:26,910
over in well integrated I'll

147
00:09:26,910 --> 00:09:30,459
poor health we have a three different
ports

148
00:09:30,459 --> 00:09:34,529
I like aged people or is Justin some
kind of information

149
00:09:34,529 --> 00:09:37,540
up not interesting the admin poor

150
00:09:37,540 --> 00:09:40,820
where you can remotely opt on all four

151
00:09:40,820 --> 00:09:44,600
your own is the AM and equip or which is
the main port for

152
00:09:44,600 --> 00:09:49,240
I uploading I everything I'll

153
00:09:49,240 --> 00:09:53,450
what else it the system can handle only
one using one-time

154
00:09:53,450 --> 00:09:57,010
I so if you to

155
00:09:57,010 --> 00:10:01,410
if you just the you know have a username
and password in the log in to this

156
00:10:01,410 --> 00:10:02,779
system nobody can

157
00:10:02,779 --> 00:10:07,900
I log into the system except you so it's
pretty simple denial of service attack

158
00:10:07,900 --> 00:10:10,910
I and there's only one user

159
00:10:10,910 --> 00:10:16,080
there's only one user

160
00:10:16,080 --> 00:10:19,890
which coed mean int4 the user for
everybody

161
00:10:19,890 --> 00:10:23,910
arm so this is how it looks like

162
00:10:23,910 --> 00:10:28,010
other typical job application you can
see what kind of car

163
00:10:28,010 --> 00:10:35,010
thinks you deploy the server an

164
00:10:37,350 --> 00:10:41,339
what kind of attacks weekend I fine
here's the first 20

165
00:10:41,339 --> 00:10:45,329
I there is 1 user a

166
00:10:45,329 --> 00:10:48,860
so we can try to brute force the
password I

167
00:10:48,860 --> 00:10:52,610
only one user into at what and one time
so we can I have a denial of service

168
00:10:52,610 --> 00:10:53,170
attacks

169
00:10:53,170 --> 00:10:58,540
on and other funny sure if you login

170
00:10:58,540 --> 00:11:02,230
failed three times still there there'll
be I'll

171
00:11:02,230 --> 00:11:05,720
disabled so we can stop there were by
just three

172
00:11:05,720 --> 00:11:11,339
looking at a-tens I

173
00:11:11,339 --> 00:11:14,540
sought denial of service attack on this
them this

174
00:11:14,540 --> 00:11:18,880
very easy just don't need to do anything
just send a simple back it's our

175
00:11:18,880 --> 00:11:22,120
on and you can deploy their

176
00:11:22,120 --> 00:11:26,420
you will cause but you need to know that
the user name and the passport and so

177
00:11:26,420 --> 00:11:29,579
username your you know if the admin I

178
00:11:29,579 --> 00:11:36,579
you need to know the bus or are so you
need to reverse engineer this offer

179
00:11:37,610 --> 00:11:42,920
and typically if you have for like you
know the web-based application the net

180
00:11:42,920 --> 00:11:44,680
worth of software to do that

181
00:11:44,680 --> 00:11:49,820
I like Barbara CA so you can send back
its change them and do something and

182
00:11:49,820 --> 00:11:53,160
not try to up run some attacks

183
00:11:53,160 --> 00:11:57,589
I up here we have the Java plans

184
00:11:57,589 --> 00:12:02,029
and we have a custom protocol it's not
easy to intercept all the stuff

185
00:12:02,029 --> 00:12:06,260
are and so on and so on so I some
problems

186
00:12:06,260 --> 00:12:09,300
but it's not very be on

187
00:12:09,300 --> 00:12:12,760
but we have for with

188
00:12:12,760 --> 00:12:16,709
is based on the Java I version 6 and we
ate can

189
00:12:16,709 --> 00:12:21,100
we have attach API so we can attach to
the our client process

190
00:12:21,100 --> 00:12:24,360
and we can change a what both

191
00:12:24,360 --> 00:12:28,120
things that XD we can modify older

192
00:12:28,120 --> 00:12:31,430
plan several calls so that's how we can

193
00:12:31,430 --> 00:12:36,490
you know try different attacks so what
kinda far

194
00:12:36,490 --> 00:12:40,980
are vulnerabilities we found up

195
00:12:40,980 --> 00:12:44,170
year the first first we'll up if you
just

196
00:12:44,170 --> 00:12:48,180
up I try to login with secret possible
three times

197
00:12:48,180 --> 00:12:52,730
the told me before so this is the real
showdown I

198
00:12:52,730 --> 00:12:57,449
the second the way to make a denial of
service attack is to send the special

199
00:12:57,449 --> 00:12:58,130
bakit

200
00:12:58,130 --> 00:13:01,500
I we have the all the

201
00:13:01,500 --> 00:13:04,660
that all the packets in this protocol
that started with

202
00:13:04,660 --> 00:13:09,089
10 spaces and hours and then the number
of

203
00:13:09,089 --> 00:13:12,790
up I'll like ideal the packets

204
00:13:12,790 --> 00:13:16,899
and then the X male external packet

205
00:13:16,899 --> 00:13:21,240
so this this is a simple packet to shut
down this area just send the shutdown

206
00:13:21,240 --> 00:13:23,000
request without them indication

207
00:13:23,000 --> 00:13:26,089
I and the system shutdown

208
00:13:26,089 --> 00:13:33,029
up I'll the next 10 minutes that we
found is essentially it's also the

209
00:13:33,029 --> 00:13:37,750
response request resultant indication I
just sent this

210
00:13:37,750 --> 00:13:41,069
a file access requests to some kind of
remote

211
00:13:41,069 --> 00:13:45,199
up system and diversity is based on
Windows

212
00:13:45,199 --> 00:13:48,769
you can execute like I S and really
attack

213
00:13:48,769 --> 00:13:52,399
this this

214
00:13:52,399 --> 00:13:56,540
requests also without indication are we
found

215
00:13:56,540 --> 00:14:00,949
a couple more request that can be
executed with amplification but

216
00:14:00,949 --> 00:14:04,029
the notes you know you don't you can't
do anything

217
00:14:04,029 --> 00:14:07,190
critical with them on

218
00:14:07,190 --> 00:14:13,380
up the prevention this for reducing
believe we have there is an S&P knows

219
00:14:13,380 --> 00:14:17,069
I and also a couple of

220
00:14:17,069 --> 00:14:20,690
security features for any for SDM

221
00:14:20,690 --> 00:14:24,310
up case was

222
00:14:24,310 --> 00:14:29,100
the no services pretty scary but it's
not what we're looking for

223
00:14:29,100 --> 00:14:32,290
are we have a more interesting attack I

224
00:14:32,290 --> 00:14:37,480
that attack is like I would compromise
the up

225
00:14:37,480 --> 00:14:40,829
some recipes services then we compromise
is the AM

226
00:14:40,829 --> 00:14:44,040
opera compromising the ACM I up

227
00:14:44,040 --> 00:14:47,300
the compromise suppression system and
then we connect to the

228
00:14:47,300 --> 00:14:50,750
I SEP the production SEP 27

229
00:14:50,750 --> 00:14:54,529
because the if we compromise as the M
itself we just can't

230
00:14:54,529 --> 00:14:57,949
you know uploader malicious code about

231
00:14:57,949 --> 00:15:02,339
I maybe it will be uploaded to the
production system maybe not

232
00:15:02,339 --> 00:15:09,339
my own health on the most critical
wannabe teen is the am at this one

233
00:15:10,220 --> 00:15:14,250
ice on vacation process up actually how
it works

234
00:15:14,250 --> 00:15:17,819
you you have a Fed plans and you

235
00:15:17,819 --> 00:15:22,439
enter your password so the system
generate the Hessian this possible

236
00:15:22,439 --> 00:15:26,829
and then stand this has to the server
and this ever compare the hash

237
00:15:26,829 --> 00:15:29,980
up was the historic in the in the file

238
00:15:29,980 --> 00:15:33,640
so actually don't need to know the bus
for because implication is

239
00:15:33,640 --> 00:15:37,470
going by the hedge so we've up

240
00:15:37,470 --> 00:15:41,069
what you need to do is to find the heshe
I

241
00:15:41,069 --> 00:15:44,199
the those the always pretty simple you
just can a

242
00:15:44,199 --> 00:15:48,309
you know the me the network because
there are no

243
00:15:48,309 --> 00:15:53,880
in ATM I just threw row picket without
any encryption with all this

244
00:15:53,880 --> 00:15:57,740
sale without anything so you can sleep
in but it's not very

245
00:15:57,740 --> 00:16:01,600
interesting on

246
00:16:01,600 --> 00:16:05,319
so you're your problem is to find the
hash if you find the hash

247
00:16:05,319 --> 00:16:09,970
can authenticate in this era and you
don't need to know the password

248
00:16:09,970 --> 00:16:13,579
mom and yes if you look at the source
code

249
00:16:13,579 --> 00:16:16,980
you can easily Decompiler source code
because its Java

250
00:16:16,980 --> 00:16:20,600
seek and to compile its and you can find
are

251
00:16:20,600 --> 00:16:26,699
said request liked create pestering

252
00:16:26,699 --> 00:16:29,949
up and the hair store in the file

253
00:16:29,949 --> 00:16:33,640
which school as the end repository eyes
to see

254
00:16:33,640 --> 00:16:37,559
and this has passed for on

255
00:16:37,559 --> 00:16:40,819
so

256
00:16:40,819 --> 00:16:44,420
so our mission is to find you know the

257
00:16:44,420 --> 00:16:49,309
the this file somehow to get access to
this file

258
00:16:49,309 --> 00:16:53,670
up another problem is up

259
00:16:53,670 --> 00:16:57,620
you know in the old notions as the AM I
the passport this precum

260
00:16:57,620 --> 00:17:01,600
pre-configured in the source call is
this by AV

261
00:17:01,600 --> 00:17:05,809
Abii as the AM so if the default
password

262
00:17:05,809 --> 00:17:10,140
I would only worsen their in all
versions obeys the AM

263
00:17:10,140 --> 00:17:14,240
are so let's suppose that's we have a
new russian and we don't

264
00:17:14,240 --> 00:17:18,520
know the default password on

265
00:17:18,520 --> 00:17:24,270
so what should we do we need to a read
this file give us with passion use it

266
00:17:24,270 --> 00:17:28,130
I as a bus for and deploy the back door

267
00:17:28,130 --> 00:17:31,679
how we can get this I actually there are

268
00:17:31,679 --> 00:17:35,820
many different vulnerabilities are which
along with us too

269
00:17:35,820 --> 00:17:39,809
yes to the file

270
00:17:39,809 --> 00:17:44,770
I'll like operation always comment
execution in city seem

271
00:17:44,770 --> 00:17:49,770
I the vulnerability in journalistic
which we've presented like

272
00:17:49,770 --> 00:17:54,690
three years ago on a black hat I
ex-military only entity 11 abilities

273
00:17:54,690 --> 00:17:58,470
also in the journalistic you can use
them to read the file

274
00:17:58,470 --> 00:18:03,140
I'll to church or so important or and MC
file it functions

275
00:18:03,140 --> 00:18:06,140
I also difference top of a

276
00:18:06,140 --> 00:18:11,149
overstuffed with already up was
presented so

277
00:18:11,149 --> 00:18:14,770
mistake something you I'll

278
00:18:14,770 --> 00:18:20,250
let's look at the another sorus I which
also working here

279
00:18:20,250 --> 00:18:24,100
in the jealous that I this service
called

280
00:18:24,100 --> 00:18:27,970
as the peel ok fewer

281
00:18:27,970 --> 00:18:32,770
SAP lo quiere stand-alone actually are

282
00:18:32,770 --> 00:18:35,840
can be to boyd's up with and if a

283
00:18:35,840 --> 00:18:42,840
on the different ports I up

284
00:18:42,990 --> 00:18:46,320
and that the funny thing that's you can
connected if

285
00:18:46,320 --> 00:18:49,770
if you have a lo Q stand-alone not just
woke you

286
00:18:49,770 --> 00:18:53,340
which is install always the SEP itself

287
00:18:53,340 --> 00:18:58,500
with each other does take itself if
you're on the net for stand-alone

288
00:18:58,500 --> 00:19:03,540
you can connect to this I look cute with
other indication

289
00:19:03,540 --> 00:19:07,050
I you can read the log files from locals

290
00:19:07,050 --> 00:19:12,130
a server you can redo log files from my
external systems and you can

291
00:19:12,130 --> 00:19:15,159
a also I register

292
00:19:15,159 --> 00:19:19,890
your own file look while to reap

293
00:19:19,890 --> 00:19:24,940
are so our tech is very easy you can we
connecting to the Lok your

294
00:19:24,940 --> 00:19:28,669
and we register I'll this file

295
00:19:28,669 --> 00:19:31,730
as Lok while so after that the

296
00:19:31,730 --> 00:19:37,379
love you to a last two to reduce file

297
00:19:37,379 --> 00:19:40,860
to connect to love you a register this
file I

298
00:19:40,860 --> 00:19:44,030
get hash I

299
00:19:44,030 --> 00:19:47,980
and then we need to know use you know
some kind of arm

300
00:19:47,980 --> 00:19:52,550
some kind of tools like a jealous nope
I'll

301
00:19:52,550 --> 00:19:56,310
to change the has that we enter

302
00:19:56,310 --> 00:20:00,300
argent to their to the hedge thats up

303
00:20:00,300 --> 00:20:06,168
system years up

304
00:20:06,169 --> 00:20:10,530
so the the biggest problem up that

305
00:20:10,530 --> 00:20:14,490
is a prevention because

306
00:20:14,490 --> 00:20:17,560
I'm the vulnerability is

307
00:20:17,560 --> 00:20:21,520
in the class error no authentication
process

308
00:20:21,520 --> 00:20:25,679
so to buy this issue you need to change
the

309
00:20:25,679 --> 00:20:28,950
you know that the client and the server

310
00:20:28,950 --> 00:20:33,220
in one-time I seem to stop all the
business processes

311
00:20:33,220 --> 00:20:36,520
and to no to reveal the system

312
00:20:36,520 --> 00:20:40,700
and so on and so on up so it's not just
you know like it

313
00:20:40,700 --> 00:20:47,700
implement this if you know them it works

314
00:20:48,470 --> 00:20:52,340
okay so when we get access to the AC and
what we can do

315
00:20:52,340 --> 00:20:57,270
can a I look at the different

316
00:20:57,270 --> 00:21:00,860
I'll components which are installed

317
00:21:00,860 --> 00:21:01,549
I

318
00:21:01,549 --> 00:21:06,419
up

319
00:21:06,419 --> 00:21:10,789
there is those also one issue now when
the connection is the AM you can deploy

320
00:21:10,789 --> 00:21:11,900
different

321
00:21:11,900 --> 00:21:14,900
difference applications I

322
00:21:14,900 --> 00:21:18,039
you can deploy them from your
workstation

323
00:21:18,039 --> 00:21:22,850
or from the thorough station are by
default you only can deploy

324
00:21:22,850 --> 00:21:25,909
from the Inbox a I'm

325
00:21:25,909 --> 00:21:29,770
folder I up but all the restrictions

326
00:21:29,770 --> 00:21:33,559
you know are on the client side a gain
so

327
00:21:33,559 --> 00:21:36,860
you can use the chalice new and the you
can

328
00:21:36,860 --> 00:21:40,029
use the data to rosso attacks so that
you can

329
00:21:40,029 --> 00:21:45,570
a get access to older all the folders
not just the

330
00:21:45,570 --> 00:21:49,580
up Inbox folder so you can read all the
information from the server

331
00:21:49,580 --> 00:21:52,899
I you also can deploy

332
00:21:52,899 --> 00:21:56,070
any application which mainly to the no
service attack

333
00:21:56,070 --> 00:21:59,179
or you can deploy your own application

334
00:21:59,179 --> 00:22:02,909
I and and so the back door

335
00:22:02,909 --> 00:22:07,130
in the system so I we use like a

336
00:22:07,130 --> 00:22:11,600
the fall application I asked to ask will
monitor

337
00:22:11,600 --> 00:22:15,880
it's the default application I don't
know the proposal this application

338
00:22:15,880 --> 00:22:16,399
because

339
00:22:16,399 --> 00:22:20,480
in as the pugilistic you have about 1200

340
00:22:20,480 --> 00:22:23,990
different fortifications so nobody cares
to

341
00:22:23,990 --> 00:22:27,029
something with will be changed in 10
them

342
00:22:27,029 --> 00:22:31,880
up so we deployed just the copy of this
application but

343
00:22:31,880 --> 00:22:34,909
with the GSP shell

344
00:22:34,909 --> 00:22:39,529
and then you can execute any operation
system comment on this error and so on

345
00:22:39,529 --> 00:22:43,450
I'll okay we have access to

346
00:22:43,450 --> 00:22:47,330
the ACM I but this is just you know like
it

347
00:22:47,330 --> 00:22:50,669
software deployment system it's not the
business

348
00:22:50,669 --> 00:22:54,669
system with are this system don't store
any

349
00:22:54,669 --> 00:22:58,899
business-related date and so on I'll

350
00:22:58,899 --> 00:23:03,309
but the ASTM I used use the database

351
00:23:03,309 --> 00:23:09,309
up connection information and a

352
00:23:09,309 --> 00:23:12,559
I and there is the AM connects to the
JavaServer

353
00:23:12,559 --> 00:23:16,760
I productions our system to you know to
deploy

354
00:23:16,760 --> 00:23:20,260
all the things so there is the AM should
know the password

355
00:23:20,260 --> 00:23:24,340
to connect to production system and this
possible to store things

356
00:23:24,340 --> 00:23:30,750
secured storage and secure the store is
located here

357
00:23:30,750 --> 00:23:34,190
we have two files in up 62

358
00:23:34,190 --> 00:23:37,620
60 properties and six turkey actually

359
00:23:37,620 --> 00:23:41,120
I up

360
00:23:41,120 --> 00:23:44,320
so weak we can get access to

361
00:23:44,320 --> 00:23:47,679
the chalice their using our base or

362
00:23:47,679 --> 00:23:51,700
I there is the sexter properties file

363
00:23:51,700 --> 00:23:55,520
which looks like these I we have a
hashed password

364
00:23:55,520 --> 00:23:59,289
all we have been created password and we
have

365
00:23:59,289 --> 00:24:06,289
for

366
00:24:10,610 --> 00:24:15,580
and slides missing okay so I have so
text or properties file

367
00:24:15,580 --> 00:24:19,290
I up in this folder

368
00:24:19,290 --> 00:24:23,490
and we have the sixth or key file in the
same folder

369
00:24:23,490 --> 00:24:26,590
and the key issues to I

370
00:24:26,590 --> 00:24:31,510
in crib is no group's the bus for

371
00:24:31,510 --> 00:24:35,680
see if we have access to operation
system

372
00:24:35,680 --> 00:24:38,700
we have been created password and we
have a key so we have weak and sick

373
00:24:38,700 --> 00:24:39,580
leave this possible

374
00:24:39,580 --> 00:24:43,300
get access to I up

375
00:24:43,300 --> 00:24:46,980
to production SAP system and then after
we have

376
00:24:46,980 --> 00:24:51,530
access to production is the system I in
most cases as the portal because

377
00:24:51,530 --> 00:24:56,490
are I that Joe think it's mainly used
for this to be poor tell

378
00:24:56,490 --> 00:25:00,240
weekend for have some kind of both
exploitation

379
00:25:00,240 --> 00:25:03,280
I could is pretty easy example

380
00:25:03,280 --> 00:25:06,780
we can get access to a foretell

381
00:25:06,780 --> 00:25:10,210
and run the search and search for the
past four

382
00:25:10,210 --> 00:25:13,340
and this is reportedly is the place
where over

383
00:25:13,340 --> 00:25:17,170
murder people store all the information
about it or no

384
00:25:17,170 --> 00:25:22,890
infrastructure and so on so you can
easily find different documents I'll

385
00:25:22,890 --> 00:25:26,220
wheelchair for passport for the other
systems

386
00:25:26,220 --> 00:25:29,570
and so on song and all the critical
information

387
00:25:29,570 --> 00:25:33,510
this one is crucial for from the want
election system so

388
00:25:33,510 --> 00:25:38,500
you know he any details but you can find
like another route bus forties

389
00:25:38,500 --> 00:25:43,430
love and some kinda father passed what
is blah blah blah so

390
00:25:43,430 --> 00:25:46,910
I we is if on a couple of documents like

391
00:25:46,910 --> 00:25:50,860
talking PDF documents important I'll
which told the passport for

392
00:25:50,860 --> 00:25:54,590
other systems and so

393
00:25:54,590 --> 00:25:57,740
now i cant I will show you the

394
00:25:57,740 --> 00:26:04,740
their full demonstration of the multiple
stations type

395
00:26:37,710 --> 00:26:40,880
okay let's say we have a as the poor
though

396
00:26:40,880 --> 00:26:45,039
which we want to break are we trying to

397
00:26:45,039 --> 00:26:48,559
and turn their username

398
00:26:48,559 --> 00:26:53,039
and the bus for which is of course
doesn't exist

399
00:26:53,039 --> 00:26:57,380
then we're on the a software deployment
manager

400
00:26:57,380 --> 00:27:00,860
I'm trying to connect to the

401
00:27:00,860 --> 00:27:04,919
a as the imposed I without the passport
of course

402
00:27:04,919 --> 00:27:08,669
I it's not working and you see this you
know

403
00:27:08,669 --> 00:27:13,090
I'll message

404
00:27:13,090 --> 00:27:16,360
that's if you log in again

405
00:27:16,360 --> 00:27:23,360
the system will be mean shut down so
we're on the

406
00:27:24,279 --> 00:27:31,279
lo Q stand-alone on the server

407
00:27:35,480 --> 00:27:39,680
to know we i running here love your
clients I

408
00:27:39,680 --> 00:27:44,760
and we connecting to the server specify
the hostname

409
00:27:44,760 --> 00:27:48,430
and look be a poor and I'll

410
00:27:48,430 --> 00:27:54,010
was like the protocol stand-alone so
that we don't need to enter the username

411
00:27:54,010 --> 00:27:55,050
and the pass for

412
00:27:55,050 --> 00:27:59,440
connect I'll

413
00:27:59,440 --> 00:28:04,820
then we and look while and we enter here

414
00:28:04,820 --> 00:28:08,310
the name of the log file is the AM
report story is the same

415
00:28:08,310 --> 00:28:12,980
and after that we can

416
00:28:12,980 --> 00:28:17,680
we can read this file so we can copy

417
00:28:17,680 --> 00:28:24,680
has from from the file

418
00:28:27,220 --> 00:28:31,640
copy to the clipboard and then we trying
to connect to the ACM a game

419
00:28:31,640 --> 00:28:34,750
I we're on the job was no I

420
00:28:34,750 --> 00:28:41,260
to intercept the the passport when with

421
00:28:41,260 --> 00:28:45,330
when we send it to the server so we
intercepting the

422
00:28:45,330 --> 00:28:52,330
the login request and we put our hands
instead of

423
00:28:53,060 --> 00:29:00,060
up sash

424
00:29:09,450 --> 00:29:13,320
so now we successfully authenticated and
and mean

425
00:29:13,320 --> 00:29:19,460
and as the AM

426
00:29:19,460 --> 00:29:23,870
so against the weekend deploy
applications and deploy a view looks

427
00:29:23,870 --> 00:29:27,600
I and so on let's go to the deployment

428
00:29:27,600 --> 00:29:33,730
the first bomb weekend we can browse
their

429
00:29:33,730 --> 00:29:36,760
system service I S

430
00:29:36,760 --> 00:29:41,020
but you know we can see on the inbox for

431
00:29:41,020 --> 00:29:44,290
and nothing nothing else I

432
00:29:44,290 --> 00:29:48,090
so we can do is intercept this up

433
00:29:48,090 --> 00:29:55,090
this week with

434
00:30:06,180 --> 00:30:10,690
winder said the question then we're
trying to or read this again

435
00:30:10,690 --> 00:30:17,690
and we have a string like I in both so
we can

436
00:30:18,150 --> 00:30:22,580
in both like to torture or so and after
that we can

437
00:30:22,580 --> 00:30:25,940
get access to all the folders

438
00:30:25,940 --> 00:30:29,620
on the server so we can read all the

439
00:30:29,620 --> 00:30:33,930
all the files and all the stuff which is
deployed them system

440
00:30:33,930 --> 00:30:38,590
I'll bookmark our mission is not the
sole mission is to deploy our

441
00:30:38,590 --> 00:30:39,760
application

442
00:30:39,760 --> 00:30:44,260
so it's much easier we just select the
local file browsing

443
00:30:44,260 --> 00:30:47,300
are select a one of the

444
00:30:47,300 --> 00:30:51,340
ER files which we

445
00:30:51,340 --> 00:30:54,560
prepare is SQL Trace

446
00:30:54,560 --> 00:30:59,120
we just took the escrow trace from the

447
00:30:59,120 --> 00:31:04,330
Sepe put the JSP shell

448
00:31:04,330 --> 00:31:11,330
and back again and now we have known it
since error

449
00:31:19,180 --> 00:31:23,340
so we're calling this you really gain
because before it was not found because

450
00:31:23,340 --> 00:31:23,810
we

451
00:31:23,810 --> 00:31:27,150
Dom implemented so now we implement its

452
00:31:27,150 --> 00:31:30,840
on the server its

453
00:31:30,840 --> 00:31:37,840
successfully deployed

454
00:31:43,750 --> 00:31:47,299
so and now we have our GSP show

455
00:31:47,299 --> 00:31:51,220
where we can

456
00:31:51,220 --> 00:31:54,679
execute any and and no bridge system
comment like that the config

457
00:31:54,679 --> 00:31:59,750
so on but when we're interested in is to
get access to files like six to

458
00:31:59,750 --> 00:32:00,519
privatise

459
00:32:00,519 --> 00:32:04,990
up we have a passport has

460
00:32:04,990 --> 00:32:08,159
and 6 turkey

461
00:32:08,159 --> 00:32:11,610
we have a keen and we have our to

462
00:32:11,610 --> 00:32:14,990
which can decreed for up

463
00:32:14,990 --> 00:32:18,580
bus for if we have a key and the
provinces

464
00:32:18,580 --> 00:32:25,580
we have a key and the included bus for

465
00:32:30,580 --> 00:32:33,730
so is accuses sixth or critter

466
00:32:33,730 --> 00:32:37,960
and

467
00:32:37,960 --> 00:32:41,160
successfully executed

468
00:32:41,160 --> 00:32:48,160
our file

469
00:32:49,490 --> 00:32:52,480
ok

470
00:32:52,480 --> 00:32:56,240
so now we can get this you know user

471
00:32:56,240 --> 00:33:01,190
I now we can connectors administrator

472
00:33:01,190 --> 00:33:08,190
to the portal and the copy copy this
password:

473
00:33:13,970 --> 00:33:15,220
and

474
00:33:15,220 --> 00:33:18,360
well

475
00:33:18,360 --> 00:33:21,330
said the bus was inspired so actually
the bus with these

476
00:33:21,330 --> 00:33:24,480
the real film it then we need to know
the change

477
00:33:24,480 --> 00:33:29,840
change is possible to the new on I and
will be successfully authenticated

478
00:33:29,840 --> 00:33:33,029
is in the system as administrator

479
00:33:33,029 --> 00:33:37,320
so this how

480
00:33:37,320 --> 00:33:41,519
we can

481
00:33:41,519 --> 00:33:45,630
your access to the Joe stack even if
it's fully

482
00:33:45,630 --> 00:33:50,909
you know secured we can go through the
SDM upload later there's the AM and then

483
00:33:50,909 --> 00:33:51,830
go to their

484
00:33:51,830 --> 00:33:56,889
to the production system self so how to
conclude

485
00:33:56,889 --> 00:34:01,750
all the stuff are ok now we still have
issues in different a

486
00:34:01,750 --> 00:34:06,240
SAP services of course the SEP I became
more and more secure

487
00:34:06,240 --> 00:34:10,020
are so we can do is regulars

488
00:34:10,020 --> 00:34:14,139
the real security assessments and you
need to care about the

489
00:34:14,139 --> 00:34:18,740
all the three different areas I mean the
the platform security or the

490
00:34:18,740 --> 00:34:19,760
vulnerabilities

491
00:34:19,760 --> 00:34:23,540
the segregation of duties and the source
code because if you have

492
00:34:23,540 --> 00:34:27,619
you know problems in a in one area

493
00:34:27,619 --> 00:34:31,349
I you still can be compromised so I

494
00:34:31,349 --> 00:34:34,349
up unity care about all the all the
areas

495
00:34:34,349 --> 00:34:38,530
I the serious that uses this or scope
security there

496
00:34:38,530 --> 00:34:43,970
Bonner abilities miss configurations and
so on and

497
00:34:43,970 --> 00:34:48,460
we like the same other SEP ask you to
response team

498
00:34:48,460 --> 00:34:53,159
I'll with whom we work together on the
know on the race how we can

499
00:34:53,159 --> 00:34:57,869
biatch a this vulnerability him are

500
00:34:57,869 --> 00:35:01,230
and if you're interested in the more
hour

501
00:35:01,230 --> 00:35:05,300
our research you can follow us on on
Twitter and I'm

502
00:35:05,300 --> 00:35:10,280
look at the presentations on our website

503
00:35:10,280 --> 00:35:15,040
and no next presentation will be in some
polo I'll be sizable

504
00:35:15,040 --> 00:35:18,859
I'll small workshop about it particular
city been testing

505
00:35:18,859 --> 00:35:22,069
things for listening and

506
00:35:22,069 --> 00:35:26,329
hope you enjoy it and if you have any
questions I can after them

507
00:35:26,329 --> 00:35:31,170
yeah them

508
00:35:31,170 --> 00:35:34,890
law well

509
00:35:34,890 --> 00:35:39,510
your better

510
00:35:39,510 --> 00:35:42,450
lyle

511
00:35:42,450 --> 00:35:46,960
I okay this him lyle

512
00:35:46,960 --> 00:35:50,470
whatever

513
00:35:50,470 --> 00:35:53,420
in the defense it depends on the
vulnerability few

514
00:35:53,420 --> 00:35:57,640
a up

515
00:35:57,640 --> 00:36:04,640
cape

516
00:36:05,940 --> 00:36:09,390
so the ASDM itself don't have any logs
for you if you if you connect to the

517
00:36:09,390 --> 00:36:10,080
system

518
00:36:10,080 --> 00:36:13,410
I because the you have only one user

519
00:36:13,410 --> 00:36:17,550
and means nobody knows who connected to
the system and even if you

520
00:36:17,550 --> 00:36:20,940
seen as somebody connected you and
understand you know

521
00:36:20,940 --> 00:36:25,340
stansel what's happening here and as for
the other issues

522
00:36:25,340 --> 00:36:28,380
I it depends on how you

523
00:36:28,380 --> 00:36:32,040
and how you enable logging because are

524
00:36:32,040 --> 00:36:39,040
you can find that there is up

525
00:36:39,520 --> 00:36:45,330
so when you upload the shale if you ever
age to be loath you can find liked

526
00:36:45,330 --> 00:36:49,140
axis2 a specific URL

527
00:36:49,140 --> 00:36:52,210
but you don't know what kind of your
attacker you send

528
00:36:52,210 --> 00:36:56,350
I we are you he will a Blowfish shoko

529
00:36:56,350 --> 00:37:02,770
so if you

530
00:37:02,770 --> 00:37:06,090
I mean its its it's possible to up

531
00:37:06,090 --> 00:37:09,550
to find this attack I suppose if you
enable

532
00:37:09,550 --> 00:37:13,270
different types of locks and do some
kind of correlation I

533
00:37:13,270 --> 00:37:17,390
so on but and by default you will not be
able to

534
00:37:17,390 --> 00:37:22,130
to find yeah great and

535
00:37:22,130 --> 00:37:26,420
more the trouble of mmm or something on

536
00:37:26,420 --> 00:37:29,450
development for year on

537
00:37:29,450 --> 00:37:32,650
while them what levi's one my hon

538
00:37:32,650 --> 00:37:35,920
all I long

539
00:37:35,920 --> 00:37:39,470
I'll in talking about the

540
00:37:39,470 --> 00:37:42,920
about transport or but its

541
00:37:42,920 --> 00:37:46,500
its its is a completely different type
of or

542
00:37:46,500 --> 00:37:50,820
up the system you in the up up you have
a traffic management system and so on

543
00:37:50,820 --> 00:37:56,230
and sick and this one is the only for
the job I innovating journalistic so the

544
00:37:56,230 --> 00:38:00,200
to separates the systems are that were
separated

545
00:38:00,200 --> 00:38:03,640
up your

546
00:38:03,640 --> 00:38:05,460
yeah exactly

