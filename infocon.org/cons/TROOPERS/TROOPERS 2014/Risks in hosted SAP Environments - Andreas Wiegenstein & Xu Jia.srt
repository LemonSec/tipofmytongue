1
00:00:01,120 --> 00:00:04,939
welcome everybody to the second talk of
the recipe security track on day two of

2
00:00:04,939 --> 00:00:05,549
troopers

3
00:00:05,549 --> 00:00:08,710
actually SEP security a trooper started
already

4
00:00:08,710 --> 00:00:12,280
yesterday yet these acts up security
book shop with

5
00:00:12,280 --> 00:00:15,740
I'm 7 sup security specialists talking
about

6
00:00:15,740 --> 00:00:19,240
pariahs topics in the SAP security area
I'm

7
00:00:19,240 --> 00:00:22,910
we also had a very nice networking
dinner and very good discussions about

8
00:00:22,910 --> 00:00:27,619
various aspects of ACP security
including some of the speakers today

9
00:00:27,619 --> 00:00:31,070
JP from on up sis was there martin
Guptill was there

10
00:00:31,070 --> 00:00:36,120
surprise guest very welcome surprise
guest and also some guys industry and

11
00:00:36,120 --> 00:00:37,230
from universities

12
00:00:37,230 --> 00:00:43,910
so I'm if somebody doesn't hear me throw
big things that may I notice you can

13
00:00:43,910 --> 00:00:44,360
hear me

14
00:00:44,360 --> 00:00:49,410
I hope I'm loud enough not laptops
please I'm

15
00:00:49,410 --> 00:00:53,469
you know what I am SEP security I'm

16
00:00:53,469 --> 00:00:56,780
Aksana Polyakov already mentioned in his
talk earlier

17
00:00:56,780 --> 00:01:01,219
that I'm the this started troopers in
2010 and

18
00:01:01,219 --> 00:01:05,119
actually attack from Nepal your cough
really had the first talk I looked it up

19
00:01:05,119 --> 00:01:06,530
it was the first talk

20
00:01:06,530 --> 00:01:09,869
but on the second day of that same
troupe was not your fault also gave a

21
00:01:09,869 --> 00:01:10,610
talk so

22
00:01:10,610 --> 00:01:14,790
same event but not the first talk so the
credit goes to russia you're definitely

23
00:01:14,790 --> 00:01:18,409
I'm yeah and now we're talking I'm not
so much about

24
00:01:18,409 --> 00:01:21,549
vulnerabilities exploiting but rather
than I'm

25
00:01:21,549 --> 00:01:25,920
a specific topic of hosting SAP
environments hosted SAP solutions

26
00:01:25,920 --> 00:01:28,939
or use a little disclaimer if you have
time and

27
00:01:28,939 --> 00:01:32,490
feel dizzy and have trouble sleeping you
can read it

28
00:01:32,490 --> 00:01:36,200
I'm otherwise the proceeds to who we are

29
00:01:36,200 --> 00:01:40,479
I'm sure and myself are doing at 8p
security research

30
00:01:40,479 --> 00:01:43,920
both for quite some time we've been
talking azzam

31
00:01:43,920 --> 00:01:47,520
various events on things the fines I'm

32
00:01:47,520 --> 00:01:51,750
yeah I'm we also try to get scores for
all the old days

33
00:01:51,750 --> 00:01:55,890
the report the same way I'm of friends
from russia do of course everybody tries

34
00:01:55,890 --> 00:01:57,049
to get the high score it's a

35
00:01:57,049 --> 00:02:01,259
sort of a recipe security researcher
competition going on here

36
00:02:01,259 --> 00:02:04,450
and I'm yeah so I'm

37
00:02:04,450 --> 00:02:07,590
our mission is SEP security beer

38
00:02:07,590 --> 00:02:10,910
SAP security company virtual forge

39
00:02:10,910 --> 00:02:15,129
and focused on more more on the upside
down on the job aside

40
00:02:15,129 --> 00:02:18,900
I'm as on the shoulder area he's an
expert on the job aside

41
00:02:18,900 --> 00:02:22,660
definitely I'm we have been doing a lot
of research

42
00:02:22,660 --> 00:02:26,209
around up about code analysis were
abilities and stuff but

43
00:02:26,209 --> 00:02:30,800
this year we going yet to move it a
little bit more on a business level on

44
00:02:30,800 --> 00:02:31,230
on the

45
00:02:31,230 --> 00:02:35,760
context level of hosting saw

46
00:02:35,760 --> 00:02:39,680
I'm earlier aleksandr already asked how
many people know ASAP

47
00:02:39,680 --> 00:02:44,050
I'm I don't know if the rules have
changed probably most of you know SEP

48
00:02:44,050 --> 00:02:49,120
but still I'm let's talk about why
should be protected SAP systems in the

49
00:02:49,120 --> 00:02:49,950
first place

50
00:02:49,950 --> 00:02:54,450
any ideas my should be protected SAP
systems

51
00:02:54,450 --> 00:02:59,470
part why not good idea let

52
00:02:59,470 --> 00:03:05,819
we have time I'm not also protect the
SAP system okay other ideas why Cissy

53
00:03:05,819 --> 00:03:06,620
p.m.

54
00:03:06,620 --> 00:03:12,780
something worth protecting SAP systems
protect business that accident thank you

55
00:03:12,780 --> 00:03:13,280
very much

56
00:03:13,280 --> 00:03:16,849
this is exactly the question they dance
i've been waiting for

57
00:03:16,849 --> 00:03:20,500
I'm because I'm according to a city's
website more than 200

58
00:03:20,500 --> 00:03:23,920
eighty the forty eight thousand five
hundred companies runs up this is

59
00:03:23,920 --> 00:03:29,790
a lot and let's look at what kinds of
companies these are and how much we

60
00:03:29,790 --> 00:03:30,470
depend

61
00:03:30,470 --> 00:03:35,260
on them so for example a city customers
transport over one billion flight

62
00:03:35,260 --> 00:03:35,959
passengers

63
00:03:35,959 --> 00:03:41,299
each year seventy as sixty-five percent
of all the TVs are made by customers

64
00:03:41,299 --> 00:03:45,049
runnings up seventy seven thousand cars
produced every day

65
00:03:45,049 --> 00:03:50,409
and 52 percent of all the movie some I
got what if it simply goes down I can go

66
00:03:50,409 --> 00:03:51,519
to see my name or

67
00:03:51,519 --> 00:03:55,150
but the first thing and that would be
something you would notice

68
00:03:55,150 --> 00:03:58,510
two-day at the evening I'm dinner

69
00:03:58,510 --> 00:04:01,870
the worst thing that can happen if SAP
customers get attacked

70
00:04:01,870 --> 00:04:05,900
seventy-two percent of the vote be a
production depends on SAP

71
00:04:05,900 --> 00:04:09,730
so if not

72
00:04:09,730 --> 00:04:15,430
for any other reason do it for the beer
saw

73
00:04:15,430 --> 00:04:18,650
avert on statistics 'em her

74
00:04:18,650 --> 00:04:22,509
in every talk oil many talks with the
interesting statistics about

75
00:04:22,509 --> 00:04:25,820
how things distribute what kind of
things happens

76
00:04:25,820 --> 00:04:29,610
I'm home anything saw of of this column
that flavor

77
00:04:29,610 --> 00:04:33,229
whatever statistics are a very
interesting thing

78
00:04:33,229 --> 00:04:36,990
I'm how many of you run SAP

79
00:04:36,990 --> 00:04:41,220
just asked a few statistical questions
12

80
00:04:41,220 --> 00:04:46,020
oh an outfit is go up a lot how many of
you are running on host third SAP

81
00:04:46,020 --> 00:04:47,900
systems

82
00:04:47,900 --> 00:04:51,250
who 3 open

83
00:04:51,250 --> 00:04:54,620
way okay you've been warned so I'm

84
00:04:54,620 --> 00:04:58,470
statistics it's basically like that I'm
a hunter is

85
00:04:58,470 --> 00:05:03,039
looking for a rabbit he shoots at the
rabbit he misses the rabbits on the left

86
00:05:03,039 --> 00:05:04,750
side by 5 inches

87
00:05:04,750 --> 00:05:08,860
he shoots again at the rabbit and he
misses the rabbit on the right side by 5

88
00:05:08,860 --> 00:05:09,860
inches

89
00:05:09,860 --> 00:05:13,729
statistically the rabbit is dead now
this a statistics

90
00:05:13,729 --> 00:05:18,410
so basically you what I wanna say is you
can't run statistic in any

91
00:05:18,410 --> 00:05:22,520
in any direction you want to miss your
presented the statistics

92
00:05:22,520 --> 00:05:27,169
all this think about why is this guy
showing me some statistics

93
00:05:27,169 --> 00:05:32,120
and especially my favorite don't risk
the district in for the fight yourself

94
00:05:32,120 --> 00:05:36,009
talking about all this statistics close
disclaimer

95
00:05:36,009 --> 00:05:39,919
let's talk a little bit about statistics
from the SAP environment

96
00:05:39,919 --> 00:05:44,460
I'm so this statistic

97
00:05:44,460 --> 00:05:47,490
I make this up myself this is the
disclaimer

98
00:05:47,490 --> 00:05:51,400
depending on which security company
shows you that the colors all the

99
00:05:51,400 --> 00:05:55,430
association with the colors the rise

100
00:05:55,430 --> 00:05:58,490
let me explain how I fought the fight in

101
00:05:58,490 --> 00:06:01,710
quotation marks this statistic to make
it look better but

102
00:06:01,710 --> 00:06:05,639
the bottom line of that this anyway no
matter how you distribute account this

103
00:06:05,639 --> 00:06:06,560
stuff

104
00:06:06,560 --> 00:06:10,990
if you look at all the old days reporter
to SAP and this is what the statistics

105
00:06:10,990 --> 00:06:15,810
is about credits for security advisory
since 2010 minutes apiece started

106
00:06:15,810 --> 00:06:16,880
crediting

107
00:06:16,880 --> 00:06:21,410
you notice that one two three four five
companies in the world

108
00:06:21,410 --> 00:06:24,710
own seventy-five percent of all the
credit for

109
00:06:24,710 --> 00:06:28,479
SAP 0 days which means the know-how on
that is

110
00:06:28,479 --> 00:06:31,479
pretty much focused I'm

111
00:06:31,479 --> 00:06:36,190
unexplainable across Europe you scan
they own the day leading the statistics

112
00:06:36,190 --> 00:06:39,860
if you count by security notes then they
are the clearly dope

113
00:06:39,860 --> 00:06:44,520
no issue with that the green guys the
SNC they'll eat the statistics if you

114
00:06:44,520 --> 00:06:48,199
count the number of notes they submit
2013

115
00:06:48,199 --> 00:06:52,220
clearpoint and virtual forge our claim s

116
00:06:52,220 --> 00:06:57,110
I'm that be base this on the number of
credits per individual researcher

117
00:06:57,110 --> 00:07:01,949
why did he do that we looked at some
security notes from SAP

118
00:07:01,949 --> 00:07:06,020
and compared them to the advisories the
sense to SAP

119
00:07:06,020 --> 00:07:11,340
and it happens that sometimes to send
three different will be a tease to SAP

120
00:07:11,340 --> 00:07:15,650
and the pet should with 1 note well
we're screwed we don't get credit for

121
00:07:15,650 --> 00:07:17,150
the three so we said well

122
00:07:17,150 --> 00:07:21,160
it may not be correct to only come to
know what it may be

123
00:07:21,160 --> 00:07:24,949
better to at least look at the be such
as credit because

124
00:07:24,949 --> 00:07:28,169
if three different people issue and am

125
00:07:28,169 --> 00:07:32,210
an advisory and the three other and
credited in the note this morning flex

126
00:07:32,210 --> 00:07:33,880
or this may more reflect

127
00:07:33,880 --> 00:07:37,419
actually what's been going on
behind-the-scenes

128
00:07:37,419 --> 00:07:40,610
and yeah another disclaimer on

129
00:07:40,610 --> 00:07:46,440
on this specific pages just a minute
make a little bit more ridiculous I'm

130
00:07:46,440 --> 00:07:49,650
and that we are not really I mean I mean
just the point is we are

131
00:07:49,650 --> 00:07:52,750
one of the three that too a lot of
research here

132
00:07:52,750 --> 00:07:56,800
so don't trust the statistic too much to
the point I want to make with it is just

133
00:07:56,800 --> 00:07:57,729
five companies

134
00:07:57,729 --> 00:08:03,270
on 75 percent of all the SAP old days

135
00:08:03,270 --> 00:08:06,550
I also did some counting I'm in this
area

136
00:08:06,550 --> 00:08:10,669
so what is that this is the point
January 10 2000

137
00:08:10,669 --> 00:08:14,180
January 2010 when SAP started publicly

138
00:08:14,180 --> 00:08:17,620
crediting security researchers for I'm

139
00:08:17,620 --> 00:08:21,440
yup for their only if they are
responsibly disclose Tracy

140
00:08:21,440 --> 00:08:26,110
I'm actually I think many if not most of
the leading

141
00:08:26,110 --> 00:08:29,879
the search company started mcveigh
earlier to submit orders

142
00:08:29,879 --> 00:08:35,380
recipe we did that first in 2003 but we
found a buffer overflow vulnerability in

143
00:08:35,380 --> 00:08:37,060
the possible Department of

144
00:08:37,060 --> 00:08:41,659
SAP's internet Transaction Server which
was actually the first step in a bit

145
00:08:41,659 --> 00:08:42,880
server

146
00:08:42,880 --> 00:08:47,279
and yeah we got a nice email thank you
for Mississippi but never a public

147
00:08:47,279 --> 00:08:48,230
credit and

148
00:08:48,230 --> 00:08:52,029
over the years we have submitted various
problems but these were never credited

149
00:08:52,029 --> 00:08:54,269
but

150
00:08:54,269 --> 00:08:57,600
let's not talk about that too much and
the points they they started doing that

151
00:08:57,600 --> 00:08:58,820
in 2010

152
00:08:58,820 --> 00:09:02,940
and there's the interesting trend if you
look at that so what we doing here's

153
00:09:02,940 --> 00:09:07,550
I'm we r we're dividing the number of
advisories

154
00:09:07,550 --> 00:09:11,720
submitted by researchers by the number
of security notes per month

155
00:09:11,720 --> 00:09:17,220
to see how much I'm share how much
percentage do the research itself in

156
00:09:17,220 --> 00:09:17,920
contrast

157
00:09:17,920 --> 00:09:21,120
recipes own internal research NBC

158
00:09:21,120 --> 00:09:24,899
and the first three years till December
2012 that

159
00:09:24,899 --> 00:09:29,769
the researchers clearly lose against SAP
on the average statistically

160
00:09:29,769 --> 00:09:33,580
blues so but then something happens

161
00:09:33,580 --> 00:09:37,690
in generate 2013 be crossed the line of
fifty percent

162
00:09:37,690 --> 00:09:41,880
and only once since then the researchers
drop below the line

163
00:09:41,880 --> 00:09:46,680
so looking at this more closely the
average before 2030 was 16 percent share

164
00:09:46,680 --> 00:09:47,779
of the

165
00:09:47,779 --> 00:09:50,850
advisories and 0 days found

166
00:09:50,850 --> 00:09:55,330
with 61 notes per month released by
sippy

167
00:09:55,330 --> 00:09:58,690
on average again this is all statistics
if interested in

168
00:09:58,690 --> 00:10:01,720
enterovirus forms and checks it's just
one

169
00:10:01,720 --> 00:10:06,290
view of of false on on these information

170
00:10:06,290 --> 00:10:11,740
and since then in 2013 you can turn
around the 16 and get the sixty-one

171
00:10:11,740 --> 00:10:12,630
percent

172
00:10:12,630 --> 00:10:17,290
ever its share of the researchers but
the number of notes has dropped

173
00:10:17,290 --> 00:10:20,540
to slightly below 30

174
00:10:20,540 --> 00:10:24,920
so now we can discuss what's going on
here other researchers

175
00:10:24,920 --> 00:10:27,990
getting better SAP no longer finding
stuff

176
00:10:27,990 --> 00:10:31,209
with their own methodologies I have no
idea I'm

177
00:10:31,209 --> 00:10:34,500
they also some rumors not confirmed

178
00:10:34,500 --> 00:10:37,990
rumors that maybe SAP is not

179
00:10:37,990 --> 00:10:42,100
I'm yeah communicating all the security
vulnerabilities

180
00:10:42,100 --> 00:10:46,490
in security notes anymore us sometime
people say they might be

181
00:10:46,490 --> 00:10:49,930
all the the less a problems might be in
the service packs I don't know if this

182
00:10:49,930 --> 00:10:50,660
is true

183
00:10:50,660 --> 00:10:54,450
just something I for I've also written a
block on that

184
00:10:54,450 --> 00:10:57,740
am if you're interested you can have a
look at it

185
00:10:57,740 --> 00:11:00,769
to get more details on that so

186
00:11:00,769 --> 00:11:04,730
just about sadistic not its let's talk a
little bit about more what we have

187
00:11:04,730 --> 00:11:08,779
in mind with this talk I'm first about
the motivation widely built this talk

188
00:11:08,779 --> 00:11:09,709
and then

189
00:11:09,709 --> 00:11:12,760
two different scenarios which you one
present

190
00:11:12,760 --> 00:11:17,670
a multi-system installation multi-system
hosted insulation and a

191
00:11:17,670 --> 00:11:21,029
single system a shit system installation
and of course

192
00:11:21,029 --> 00:11:24,690
a demo so much aggression

193
00:11:24,690 --> 00:11:27,709
and this all started with

194
00:11:27,709 --> 00:11:31,529
'em security incident

195
00:11:31,529 --> 00:11:35,640
I'm with a hosted company in the United
Kingdom

196
00:11:35,640 --> 00:11:39,149
I'm there was an interesting report I
can open that

197
00:11:39,149 --> 00:11:44,959
the QR code is also link doubling

198
00:11:44,959 --> 00:11:51,959
love you

199
00:11:52,720 --> 00:11:56,490
this wasn't article like I came across
I'm

200
00:11:56,490 --> 00:11:59,870
just to summarize its roughly you can
get your

201
00:11:59,870 --> 00:12:02,880
precise on picture by by looking at the
stuff

202
00:12:02,880 --> 00:12:06,550
later it's it's it's a rather lengthy
budget the point is just being that

203
00:12:06,550 --> 00:12:10,060
the UK posts for some UK pop

204
00:12:10,060 --> 00:12:14,399
the UK police sorry UK police I Met
Police

205
00:12:14,399 --> 00:12:19,399
I'm they were hosted I'm and they did
some kind of on it and the audits turns

206
00:12:19,399 --> 00:12:19,769
art

207
00:12:19,769 --> 00:12:23,200
or told I'm told those guys that they
are

208
00:12:23,200 --> 00:12:27,829
while there may be just to be this to be
a safe site security issues with

209
00:12:27,829 --> 00:12:32,160
the host that applications they have
been this may be an integral

210
00:12:32,160 --> 00:12:35,769
insecure way of posting and this a lot
of discussion

211
00:12:35,769 --> 00:12:41,019
going on later on a.m. potentially also
including comments by Sapa

212
00:12:41,019 --> 00:12:44,360
I'm not really sure there's I'm and SAP
guy

213
00:12:44,360 --> 00:12:47,620
making common see I don't know if this
is somebody with SAP knowledge or

214
00:12:47,620 --> 00:12:49,660
somebody from SAP it's not as close to
your

215
00:12:49,660 --> 00:12:54,820
again you can have a look at that if you
like and that made us think I'm

216
00:12:54,820 --> 00:13:00,329
what I actually the risks if I am
customer in a hosted installation what

217
00:13:00,329 --> 00:13:01,230
can happen to me

218
00:13:01,230 --> 00:13:04,740
so let's show you

219
00:13:04,740 --> 00:13:08,160
I'm 20 different ways of SAP

220
00:13:08,160 --> 00:13:12,579
hosting that can be applied first one
being multi-system hosting

221
00:13:12,579 --> 00:13:16,040
so I if you on a multi host

222
00:13:16,040 --> 00:13:20,310
much a system hosted environment you are
one of these boxes

223
00:13:20,310 --> 00:13:23,670
one of these boxes somewhere in the
internets

224
00:13:23,670 --> 00:13:26,699
at the hosting provider may be in the
cloud I have no idea

225
00:13:26,699 --> 00:13:29,899
the only thing that is relevant to this
year

226
00:13:29,899 --> 00:13:33,750
your books maybe your own which the one
you have holes that

227
00:13:33,750 --> 00:13:38,380
but the box is maintained through SAP
Solution Manager

228
00:13:38,380 --> 00:13:41,790
so Solution Manager it's one of the mmm

229
00:13:41,790 --> 00:13:45,529
newer components in the SAP landscape

230
00:13:45,529 --> 00:13:48,779
that basically managers all the
installation

231
00:13:48,779 --> 00:13:52,459
allows you to deliver pictures and stuff
like that

232
00:13:52,459 --> 00:13:56,769
it also allows you to get information
about the SAP systems

233
00:13:56,769 --> 00:14:00,300
that are maintained get collect data
make

234
00:14:00,300 --> 00:14:03,810
I'm statistical analysis of what's going
on in the system's

235
00:14:03,810 --> 00:14:08,510
and stuff like that so now we have to
know

236
00:14:08,510 --> 00:14:13,899
in order for this to work in order for
solution in order to be able to access

237
00:14:13,899 --> 00:14:18,470
all of these machines what is the
requirement the technically we climb

238
00:14:18,470 --> 00:14:21,649
into the ticking a precondition that
Solution Manager can actually talk to

239
00:14:21,649 --> 00:14:22,329
all those

240
00:14:22,329 --> 00:14:27,920
host its other clearly

241
00:14:27,920 --> 00:14:31,790
yet

242
00:14:31,790 --> 00:14:34,759
network traffic and use them systems
thank you very much

243
00:14:34,759 --> 00:14:38,899
first-line so there's basically a
connection from the Solution Manager

244
00:14:38,899 --> 00:14:44,230
going to all those holes that system by
bitch solution is a can connect

245
00:14:44,230 --> 00:14:47,689
it even gets better these connections

246
00:14:47,689 --> 00:14:51,189
technically stored in SAP transaction SM
59

247
00:14:51,189 --> 00:14:54,949
they have credentials associated with
them so

248
00:14:54,949 --> 00:14:58,360
the username and password for those
connections is in

249
00:14:58,360 --> 00:15:01,679
the connection stort on the Solution
Manager

250
00:15:01,679 --> 00:15:05,529
which means if I am on the Solution
Manager I can simply

251
00:15:05,529 --> 00:15:09,499
if I have the authorization to go
tourist attraction to to do something

252
00:15:09,499 --> 00:15:13,160
I can access all systems from Solution
Manager

253
00:15:13,160 --> 00:15:17,660
all of the connected systems in the
entire hosted environment

254
00:15:17,660 --> 00:15:21,220
maybe on this one is company a company B
Company C if I'm here

255
00:15:21,220 --> 00:15:26,769
I can excess all of them demo

256
00:15:26,769 --> 00:15:29,939
had let's have a look its among those

257
00:15:29,939 --> 00:15:33,459
up about to to mention something in
order for

258
00:15:33,459 --> 00:15:36,839
for the state exchange to take place
because I said it collects information

259
00:15:36,839 --> 00:15:38,100
and stuff like that

260
00:15:38,100 --> 00:15:41,189
there is to substantially large

261
00:15:41,189 --> 00:15:46,279
packet of cold with in the bases systems
within the bases installations of all

262
00:15:46,279 --> 00:15:47,160
SAP Service

263
00:15:47,160 --> 00:15:50,449
I'm which is called the solution is art
with Lakin

264
00:15:50,449 --> 00:15:53,839
STPI answer a plaque in with I'm

265
00:15:53,839 --> 00:15:57,720
a lot of functionality that solution is
a can leverage in its in all

266
00:15:57,720 --> 00:16:02,369
these systems on Etsy 55 my solution
managers

267
00:16:02,369 --> 00:16:05,629
up it's a call to other so

268
00:16:05,629 --> 00:16:08,809
so and for example

269
00:16:08,809 --> 00:16:12,919
bf this object this is one of the
packages

270
00:16:12,919 --> 00:16:16,369
part of the STP I'm just to give you an
idea about

271
00:16:16,369 --> 00:16:19,910
the magnet should be sought sup packages

272
00:16:19,910 --> 00:16:25,309
of this component and this %uh packages
again sub packages

273
00:16:25,309 --> 00:16:29,799
and be looking at

274
00:16:29,799 --> 00:16:33,699
on the specific Wong functioning

275
00:16:33,699 --> 00:16:40,269
so and with in the functional groups
they are

276
00:16:40,269 --> 00:16:44,749
function modules which which is code
that I can call

277
00:16:44,749 --> 00:16:49,559
and this is basically mostly all code
that can be called remotely from the

278
00:16:49,559 --> 00:16:50,639
Solution Manager

279
00:16:50,639 --> 00:16:53,939
so it's a lot of lot of court within
just this

280
00:16:53,939 --> 00:16:57,579
individual functional group and if you
have a closer look just at the

281
00:16:57,579 --> 00:16:59,809
description of what these things to

282
00:16:59,809 --> 00:17:03,009
get the list of involved RFC connections

283
00:17:03,009 --> 00:17:06,529
SQL buffet race read to retrieve SQL
buffet race

284
00:17:06,529 --> 00:17:11,649
a what else but has to be half year I
wanted to show you

285
00:17:11,649 --> 00:17:16,370
the the pub possibility to call in SAP
transaction through this

286
00:17:16,370 --> 00:17:20,230
of course you all this read
authorization to do it but the technical

287
00:17:20,230 --> 00:17:22,189
potential is there to execute its

288
00:17:22,189 --> 00:17:28,919
retrace for example delete

289
00:17:28,919 --> 00:17:33,760
the %ah trial let's have a look at the
source code of this specific function

290
00:17:33,760 --> 00:17:34,299
module

291
00:17:34,299 --> 00:17:37,440
just left some idea

292
00:17:37,440 --> 00:17:44,440
so what the first up is it does

293
00:17:45,649 --> 00:17:49,350
remove RT of islets click into that NBC
very

294
00:17:49,350 --> 00:17:52,419
very well done there's an authority
check and it checks

295
00:17:52,419 --> 00:17:55,870
MI entitled to the lead the fight so
this is not an exploiter something it

296
00:17:55,870 --> 00:18:00,039
just shows you what it does it checks is
the call authority authorized and then

297
00:18:00,039 --> 00:18:03,700
just deletes the dataset provided as
input which means

298
00:18:03,700 --> 00:18:07,730
on the other way if I turn this around
if I am authorized to call this

299
00:18:07,730 --> 00:18:11,480
I can provide to find them and delete
whatever fight I want on

300
00:18:11,480 --> 00:18:16,570
the posted system in brackets including
lock files

301
00:18:16,570 --> 00:18:21,120
if I have the authorization so

302
00:18:21,120 --> 00:18:24,250
was just to get an idea about that

303
00:18:24,250 --> 00:18:28,029
that the software installed on all these
systems caller from Solution Manager is

304
00:18:28,029 --> 00:18:28,860
a lot of stuff

305
00:18:28,860 --> 00:18:32,600
of course I need the right spot I'm
customers

306
00:18:32,600 --> 00:18:35,679
tense in order to simplify the
installation

307
00:18:35,679 --> 00:18:39,000
to give the Solution Manager large
strides

308
00:18:39,000 --> 00:18:42,880
excessive rights to do whatever it needs
to do on those systems

309
00:18:42,880 --> 00:18:47,980
so the changes are that your hosting
provider may have misconfigured

310
00:18:47,980 --> 00:18:51,169
the Solution Manager with to extend the
bride's allowing

311
00:18:51,169 --> 00:18:55,570
somebody on this box to basically doing
nasty things on all those books

312
00:18:55,570 --> 00:18:58,700
saw

313
00:18:58,700 --> 00:19:02,020
let's look at this little closer the
solution

314
00:19:02,020 --> 00:19:05,610
up at sorry I forgot one one minor
detail

315
00:19:05,610 --> 00:19:09,600
I'm if you look in now on a single
installation on the left side

316
00:19:09,600 --> 00:19:13,980
if I'm in a host the books there's also
at the back

317
00:19:13,980 --> 00:19:17,370
through the Solution Manager it's not
that the solution to call its me and get

318
00:19:17,370 --> 00:19:21,190
something I can also call the Solution
Manager and ask him to do other things

319
00:19:21,190 --> 00:19:25,440
so they are also connections from each
of those books suspect to the Solution

320
00:19:25,440 --> 00:19:26,639
Manager

321
00:19:26,639 --> 00:19:29,649
which means theoretically I can on this
box

322
00:19:29,649 --> 00:19:33,200
helped the Solution Manager because I
have a connection to it

323
00:19:33,200 --> 00:19:36,559
from the up pic into all the other
installations

324
00:19:36,559 --> 00:19:41,889
in your third environment as a risk

325
00:19:41,889 --> 00:19:45,799
so therefore Solution Manager has a very
high attack surface because

326
00:19:45,799 --> 00:19:49,029
all of the hosted companies inside

327
00:19:49,029 --> 00:19:52,240
they also environment can attacked the
Solution Manager because they have a

328
00:19:52,240 --> 00:19:54,059
connection to it

329
00:19:54,059 --> 00:19:58,000
if the Solution Manager falls that the
entire

330
00:19:58,000 --> 00:20:03,080
system falls all the connected systems
fall with the Solution Manager

331
00:20:03,080 --> 00:20:06,720
also many Solution Manager applications

332
00:20:06,720 --> 00:20:09,909
which you can run on such major
object-based

333
00:20:09,909 --> 00:20:14,649
you can call them from with with a GDP
and execute them

334
00:20:14,649 --> 00:20:18,330
and specifically a critical audience
solution to can result in access to all

335
00:20:18,330 --> 00:20:19,559
the it up

336
00:20:19,559 --> 00:20:24,419
of the host the company's

337
00:20:24,419 --> 00:20:28,000
let's jump over to a solution Manager
System

338
00:20:28,000 --> 00:20:32,289
just again to show you a little bit
about

339
00:20:32,289 --> 00:20:37,860
and just pick some components from
Solution Manager on

340
00:20:37,860 --> 00:20:41,330
is all basically Rep

341
00:20:41,330 --> 00:20:48,330
services

342
00:20:54,990 --> 00:20:58,400
well okay this is the list of I'm

343
00:20:58,400 --> 00:21:02,570
met applications on Solution Manager
that are available

344
00:21:02,570 --> 00:21:06,490
I'm the grey ones are turned off good
sign the black one saw

345
00:21:06,490 --> 00:21:10,340
accessible so there's just a lot of
stuff

346
00:21:10,340 --> 00:21:15,250
again topic higher tech service of
course most have been switched on

347
00:21:15,250 --> 00:21:15,860
however

348
00:21:15,860 --> 00:21:19,100
the host the may do some something wrong
and made

349
00:21:19,100 --> 00:21:23,420
turn on too many of them and these can
be then called

350
00:21:23,420 --> 00:21:27,050
from the outside so

351
00:21:27,050 --> 00:21:30,820
yup

352
00:21:30,820 --> 00:21:35,420
and we also see there's a specific one
call it a GS book center and this is

353
00:21:35,420 --> 00:21:39,370
also black now let's look

354
00:21:39,370 --> 00:21:42,570
what you can do with that saw

355
00:21:42,570 --> 00:21:46,320
just copy the couple of the ones we have
just seen

356
00:21:46,320 --> 00:21:50,929
here to the presentation and now

357
00:21:50,929 --> 00:21:54,040
what do you think it's them most

358
00:21:54,040 --> 00:21:57,400
not intelligent thing you can do with
the Solution Manager

359
00:21:57,400 --> 00:22:01,000
if you are a host up or a company

360
00:22:01,000 --> 00:22:04,100
what is the most not intelligent thing
you can do with it

361
00:22:04,100 --> 00:22:09,450
portrait on the Internet

362
00:22:09,450 --> 00:22:12,980
exactly thank you very much let

363
00:22:12,980 --> 00:22:16,640
the rest my presentation so I'm i'm too
lazy with this link

364
00:22:16,640 --> 00:22:21,830
are

365
00:22:21,830 --> 00:22:25,370
thats let's just use this one

366
00:22:25,370 --> 00:22:32,370
the 80 S Works and I'll room

367
00:22:40,650 --> 00:22:42,740
ca

368
00:22:42,740 --> 00:22:49,740
through Google search simply one of the
patterns that I can find

369
00:22:50,640 --> 00:22:54,000
in in there on ICU

370
00:22:54,000 --> 00:22:57,860
logon on made on which means logon log
on

371
00:22:57,860 --> 00:23:01,610
these are Solution Manager on the
Internet

372
00:23:01,610 --> 00:23:06,130
accessible via Google very easily now we
can

373
00:23:06,130 --> 00:23:09,960
I think visiting the lock on page
doesn't really hurt

374
00:23:09,960 --> 00:23:13,190
arm let's take some summer

375
00:23:13,190 --> 00:23:16,960
maybe this okay bad luck

376
00:23:16,960 --> 00:23:22,610
tell us that that take another one that
one again without any specific

377
00:23:22,610 --> 00:23:26,270
means and now I'm on a lock on screen of
Solution Manager

378
00:23:26,270 --> 00:23:31,410
on the Internet which is actually I'm
not blaming the specific company or

379
00:23:31,410 --> 00:23:34,130
person I don't want to blame anyone but
it is not really

380
00:23:34,130 --> 00:23:37,780
the best idea to do something like that
and its even for us

381
00:23:37,780 --> 00:23:41,730
if those companies then still have tea
for possible sector I'm not trying

382
00:23:41,730 --> 00:23:42,600
anything is just

383
00:23:42,600 --> 00:23:45,600
showing you that some people have the
idea

384
00:23:45,600 --> 00:23:50,360
or maybe its negligence or whatever and
put their solution manager online

385
00:23:50,360 --> 00:23:54,540
maybe also accidentally there was even
an audit with a customer and

386
00:23:54,540 --> 00:23:57,620
I'm we told the customer a

387
00:23:57,620 --> 00:24:01,160
you know that your solution is on the
internet that that's really not a good

388
00:24:01,160 --> 00:24:01,980
idea guy

389
00:24:01,980 --> 00:24:07,080
and they said we don't have a solution
manager but the hosts ahead

390
00:24:07,080 --> 00:24:10,360
his solution is on the internet and they
didn't know about it and this is really

391
00:24:10,360 --> 00:24:11,410
a big risk so

392
00:24:11,410 --> 00:24:15,150
actually Solution Manager itself it's
like an empty box there's no business

393
00:24:15,150 --> 00:24:16,210
data in its

394
00:24:16,210 --> 00:24:20,540
its it's like a because with nothing in
it

395
00:24:20,540 --> 00:24:24,760
it's just a technical thing and saw most
companies so many companies think

396
00:24:24,760 --> 00:24:28,590
why should I put this thing there's
nothing in it unfortunately this

397
00:24:28,590 --> 00:24:33,170
empty house has 10 minutes to all your
house as with all your values and your

398
00:24:33,170 --> 00:24:34,130
entire city

399
00:24:34,130 --> 00:24:39,150
that's why you should protect Solution
Manager there's nothing in it but the

400
00:24:39,150 --> 00:24:42,260
that it's the key to everything else you
have

401
00:24:42,260 --> 00:24:45,920
so this is for scenario 1: the risk

402
00:24:45,920 --> 00:24:50,100
that the solution address unprotected
potentially in the internet you see this

403
00:24:50,100 --> 00:24:51,500
is not a myth that happens

404
00:24:51,500 --> 00:24:56,890
and even if it's not on the internet one
host the company can go through

405
00:24:56,890 --> 00:24:59,880
through those the excess through
Solution Manager bitches all this they

406
00:24:59,880 --> 00:25:01,290
otherwise it doesn't book

407
00:25:01,290 --> 00:25:04,900
break into solution engine may be
through a zero-day

408
00:25:04,900 --> 00:25:08,360
own solution manager and then all all
other host the company's

409
00:25:08,360 --> 00:25:12,980
this is one way of a tech if you want
even if you an isolated boxes

410
00:25:12,980 --> 00:25:17,220
well thing next think the signal system

411
00:25:17,220 --> 00:25:21,030
I'm is means multiple companies

412
00:25:21,030 --> 00:25:25,090
are installed on the same on the very
same SAP machine

413
00:25:25,090 --> 00:25:28,290
this can be done by SAP's

414
00:25:28,290 --> 00:25:33,790
way of client separation so SAP all of
you work with SAP know if lock in

415
00:25:33,790 --> 00:25:37,830
I always look into specific line these
guys can only go to climb forty-two

416
00:25:37,830 --> 00:25:38,540
these guys

417
00:25:38,540 --> 00:25:42,679
only 223 and no one connects the Conexus
Klein 007

418
00:25:42,679 --> 00:25:47,460
cell this is a a way of having multiple
different organizations

419
00:25:47,460 --> 00:25:50,590
on one system without the ability to
look

420
00:25:50,590 --> 00:25:53,880
at the other guys on the other
organizations data

421
00:25:53,880 --> 00:25:57,510
this is a very good mechanism it really
works at least

422
00:25:57,510 --> 00:26:00,570
inside companies in hosting scenario it

423
00:26:00,570 --> 00:26:03,670
has certain risks so

424
00:26:03,670 --> 00:26:06,820
let's look shortly how this works

425
00:26:06,820 --> 00:26:10,900
so you have an idea how SAP is actually
enforcing this kind of

426
00:26:10,900 --> 00:26:17,900
of thing not come close this one

427
00:26:24,240 --> 00:26:26,260
so if I'm displaying any table

428
00:26:26,260 --> 00:26:31,820
any client dependent able the first
thing I see is the first column in this

429
00:26:31,820 --> 00:26:32,380
table

430
00:26:32,380 --> 00:26:35,660
called months which is the abbreviation
of the German

431
00:26:35,660 --> 00:26:38,810
got for clients Monday Oct no and

432
00:26:38,810 --> 00:26:42,440
all the tables that have this this type
of day term

433
00:26:42,440 --> 00:26:47,340
type they don't month in the first place
are restricted to a single client the

434
00:26:47,340 --> 00:26:50,800
other clients can't get at the state on
either reading or writing

435
00:26:50,800 --> 00:26:54,930
now how does SAP and force this saw

436
00:26:54,930 --> 00:27:01,930
I'm going to show you this honest to1 so
I'm just

437
00:27:02,250 --> 00:27:05,830
activating the database excess The
Secret race

438
00:27:05,830 --> 00:27:09,840
by default it's usually off because if
you turn it on it will kill your hard

439
00:27:09,840 --> 00:27:10,320
drive

440
00:27:10,320 --> 00:27:14,200
I'm before I do that I switched to

441
00:27:14,200 --> 00:27:17,220
transection CAD

442
00:27:17,220 --> 00:27:24,220
and

443
00:27:26,010 --> 00:27:30,620
okay what I do years this is a simple
program that simply select something

444
00:27:30,620 --> 00:27:31,790
from this table

445
00:27:31,790 --> 00:27:36,170
and you see in this select I do not
specify the column

446
00:27:36,170 --> 00:27:39,550
month but the Klein column it's not in
there so

447
00:27:39,550 --> 00:27:42,980
supposedly this should give me all the
data if you're thinking sequel

448
00:27:42,980 --> 00:27:46,730
now let's see what happens aiight with
better now on this stress

449
00:27:46,730 --> 00:27:50,970
database excess trace the execute this
program

450
00:27:50,970 --> 00:27:54,450
it does something we don't care what it
does the trace of

451
00:27:54,450 --> 00:27:59,450
and be analyzed trace me that

452
00:27:59,450 --> 00:28:02,830
looks now we have out of

453
00:28:02,830 --> 00:28:06,130
this was just one click a knife that
race like that

454
00:28:06,130 --> 00:28:10,370
I'm let's have a look at where yet this
is one

455
00:28:10,370 --> 00:28:13,370
my programs that hosted one if you look
at

456
00:28:13,370 --> 00:28:17,710
at this cryptic stuff now BC that

457
00:28:17,710 --> 00:28:20,860
to select is here and

458
00:28:20,860 --> 00:28:24,470
it now includes away a restriction to
the month

459
00:28:24,470 --> 00:28:28,080
so this is something that happens in
side the SAP kernel

460
00:28:28,080 --> 00:28:31,160
the kernel takes all the sequel
statements checks are they

461
00:28:31,160 --> 00:28:35,010
addressed to a table with which has
climbed relevant if yes I automatically

462
00:28:35,010 --> 00:28:37,000
restricted to this Klein so

463
00:28:37,000 --> 00:28:41,830
the court cannot get the open SQL code
cannot get and data

464
00:28:41,830 --> 00:28:45,500
of the other clients so far the theory

465
00:28:45,500 --> 00:28:49,520
which means if the host the companies
have their custom code

466
00:28:49,520 --> 00:28:52,680
and all companies have custom code to
some degree

467
00:28:52,680 --> 00:28:57,580
their court is supposedly not be able 2x
estate of the other with the company on

468
00:28:57,580 --> 00:28:58,480
the same cell

469
00:28:58,480 --> 00:29:03,240
supposedly sup

470
00:29:03,240 --> 00:29:07,410
okay so what are the risks

471
00:29:07,410 --> 00:29:11,170
I'm if you know open SQL from
mississippi you know they are

472
00:29:11,170 --> 00:29:14,560
three ways to bypass the client

473
00:29:14,560 --> 00:29:19,790
separation of the SAP server the first
is to use the specific explicit option

474
00:29:19,790 --> 00:29:22,570
Klein specified in the open SQL
statement

475
00:29:22,570 --> 00:29:26,900
the second is to not use open SQL in the
first place but

476
00:29:26,900 --> 00:29:31,660
use xx esculent execute native see clip
which does not have the ability to

477
00:29:31,660 --> 00:29:33,770
separate back lines and the third is to
use

478
00:29:33,770 --> 00:29:37,810
the other database connectivity
interface bitch allows you to

479
00:29:37,810 --> 00:29:41,800
yeah compile whatever stream and send it
through

480
00:29:41,800 --> 00:29:46,480
to the database drive up so these
through have no implicit protection and

481
00:29:46,480 --> 00:29:48,790
even with the implicit protection it can
be turned off

482
00:29:48,790 --> 00:29:52,780
so let's jump over you know any

483
00:29:52,780 --> 00:29:58,470
that one this time have another

484
00:29:58,470 --> 00:30:02,050
Ford report the what is due

485
00:30:02,050 --> 00:30:05,400
the first one just counts the entries
I'm

486
00:30:05,400 --> 00:30:10,810
of the table so its only our client
because the month and is automatically

487
00:30:10,810 --> 00:30:11,540
appended

488
00:30:11,540 --> 00:30:15,190
the second one says I count Klein
specified

489
00:30:15,190 --> 00:30:20,350
from a different client so I even say
I'm I'm inclined 900 I try to read from

490
00:30:20,350 --> 00:30:20,840
90

491
00:30:20,840 --> 00:30:24,390
911 on and the third one says

492
00:30:24,390 --> 00:30:28,880
Klein specified which means take away
the client restriction

493
00:30:28,880 --> 00:30:33,880
and I don't specify anything which means
I read all the date up if you execute

494
00:30:33,880 --> 00:30:34,870
this BC

495
00:30:34,870 --> 00:30:38,400
outline its fifty two datasets 911 has
13

496
00:30:38,400 --> 00:30:41,880
and all together on all klein's the ID
two entries which means

497
00:30:41,880 --> 00:30:45,110
technically if I can write code I can
get

498
00:30:45,110 --> 00:30:49,310
at the data all the kleins on the same
SAP system

499
00:30:49,310 --> 00:30:55,070
so

500
00:30:55,070 --> 00:31:00,990
arm and this is the risk you have to if
you in a single system hosting system

501
00:31:00,990 --> 00:31:04,650
any custom up quoting can access audit
of almost the company's

502
00:31:04,650 --> 00:31:08,430
you're sitting all virtually in the same
boat if you are hosted in a single

503
00:31:08,430 --> 00:31:08,990
system

504
00:31:08,990 --> 00:31:13,630
if your host that allows any of those to
deploy custom court

505
00:31:13,630 --> 00:31:17,130
this customer can then access all your
data read it

506
00:31:17,130 --> 00:31:22,930
ride it change it whatever they want to
do with that and also any SAP

507
00:31:22,930 --> 00:31:28,000
all day that allows cross Klein excess
can also resides in access to all of

508
00:31:28,000 --> 00:31:28,590
your data

509
00:31:28,590 --> 00:31:32,800
and what kind of o'day classifies as

510
00:31:32,800 --> 00:31:37,050
allowing cross client access to your
data any up command injection

511
00:31:37,050 --> 00:31:39,170
vulnerability on yourself up

512
00:31:39,170 --> 00:31:43,440
qualifies for that any native secret
injection qualifies for that

513
00:31:43,440 --> 00:31:48,590
and any generic Ross Klein vulnerability
which means

514
00:31:48,590 --> 00:31:52,760
generic alt by SAP develop 2x estate on
other clients

515
00:31:52,760 --> 00:31:55,800
I'm doesn't sound like

516
00:31:55,800 --> 00:31:59,190
there's such a thing but it is in this
is what we're showing in this talk

517
00:31:59,190 --> 00:32:00,670
there's actually

518
00:32:00,670 --> 00:32:04,150
two functions as it be provided generic
functions

519
00:32:04,150 --> 00:32:08,170
one function says I'm allows me to name
a table

520
00:32:08,170 --> 00:32:12,250
and retrieve all entries of this table
from every client I truth

521
00:32:12,250 --> 00:32:15,490
and the other function as the pier it
says I hefty

522
00:32:15,490 --> 00:32:18,740
potential to again specify a table and
override

523
00:32:18,740 --> 00:32:22,940
any data in the table I choose across
clients and missus

524
00:32:22,940 --> 00:32:29,790
installed on all SAP systems and can be
even called the RFC

525
00:32:29,790 --> 00:32:33,190
and now this is a time where where I
hand over

526
00:32:33,190 --> 00:32:36,530
the microphone shoe kinda thanks

527
00:32:36,530 --> 00:32:40,400
yes okay and now

528
00:32:40,400 --> 00:32:43,700
I will show you how's this look like
being the real

529
00:32:43,700 --> 00:32:50,700
assisting

530
00:32:53,850 --> 00:33:00,850
okay we have a system 660 so

531
00:33:03,700 --> 00:33:06,180
now

532
00:33:06,180 --> 00:33:13,180
and again

533
00:33:17,190 --> 00:33:22,159
okay we have to assist him twice

534
00:33:22,159 --> 00:33:25,929
and once under 610 900 we have a

535
00:33:25,929 --> 00:33:30,599
user name pair ca on the 100 and the
password is

536
00:33:30,599 --> 00:33:33,729
choppers okay so

537
00:33:33,729 --> 00:33:37,499
and as a side log on

538
00:33:37,499 --> 00:33:42,059
with the client and I 111 Ananda

539
00:33:42,059 --> 00:33:45,129
user is CIO night

540
00:33:45,129 --> 00:33:51,469
111 so the password yet because the CIO
always think everything's Hickory

541
00:33:51,469 --> 00:33:55,879
secret so the pass it on also supra so

542
00:33:55,879 --> 00:34:02,879
snowing

543
00:34:04,150 --> 00:34:08,480
where in both says 10

544
00:34:08,480 --> 00:34:14,410
conducted okay you can see here

545
00:34:14,410 --> 00:34:17,590
so we on the client 900

546
00:34:17,590 --> 00:34:20,880
and on the right side on the client

547
00:34:20,880 --> 00:34:26,640
911 so there's a chance action is he

548
00:34:26,640 --> 00:34:32,690
16 up that can show that a both

549
00:34:32,690 --> 00:34:39,600
there's a dummy

550
00:34:39,600 --> 00:34:46,600
table we prepared celery

551
00:34:50,400 --> 00:34:54,520
to some I made a tying site and way

552
00:34:54,520 --> 00:34:58,370
there's no data here Siro

553
00:34:58,370 --> 00:35:02,670
on a nine hundred so

554
00:35:02,670 --> 00:35:06,160
what we do now is try to use to

555
00:35:06,160 --> 00:35:09,200
and user here on the left side on

556
00:35:09,200 --> 00:35:13,000
900 client tend to get access date

557
00:35:13,000 --> 00:35:16,940
and to the date Honda right side okay

558
00:35:16,940 --> 00:35:21,990
and is somehow boring to just show up
some lines thing the SAP you up

559
00:35:21,990 --> 00:35:26,570
we so what we do a and Jess already
mentioned that we have

560
00:35:26,570 --> 00:35:30,090
to holidays recorder to SAP two years
ago

561
00:35:30,090 --> 00:35:34,220
and as a remote function and enabled

562
00:35:34,220 --> 00:35:39,290
that weekend just called them without
writing a single

563
00:35:39,290 --> 00:35:43,180
I have called so I will go

564
00:35:43,180 --> 00:35:50,180
both sustained

565
00:35:51,740 --> 00:35:54,560
were actually on there's a

566
00:35:54,560 --> 00:35:58,690
there are a lot of prohibited and
ability to call a I

567
00:35:58,690 --> 00:36:01,860
see remote function call so on

568
00:36:01,860 --> 00:36:05,600
yeah we developed our own pool it is
better

569
00:36:05,600 --> 00:36:09,740
is this a as a possibility like ma ko ng

570
00:36:09,740 --> 00:36:14,040
Microsoft Excel or JavaScript VBScript

571
00:36:14,040 --> 00:36:17,920
I'll possible so a/c see here this

572
00:36:17,920 --> 00:36:21,220
we have Arctic sea's P persistent and we

573
00:36:21,220 --> 00:36:24,450
this is really important we under
clinton i 100

574
00:36:24,450 --> 00:36:28,290
we're using the user hecka 900

575
00:36:28,290 --> 00:36:35,290
okay which had to connect

576
00:36:35,420 --> 00:36:40,950
and we want me to date her

577
00:36:40,950 --> 00:36:44,530
you remember that actually there's no
data on the

578
00:36:44,530 --> 00:36:49,890
Klein 900 however

579
00:36:49,890 --> 00:36:52,960
as the results that we have order date
her

580
00:36:52,960 --> 00:36:58,520
pump other client here that means we
have

581
00:36:58,520 --> 00:37:05,030
read access tool other crime so what we
as Kendall

582
00:37:05,030 --> 00:37:08,410
yes there is somehow my name's here

583
00:37:08,410 --> 00:37:12,190
and fine and mystery I'm not satisfied
with mister

584
00:37:12,190 --> 00:37:15,290
on yeah so

585
00:37:15,290 --> 00:37:18,870
what I need to do is yeah and put more

586
00:37:18,870 --> 00:37:25,870
in K

587
00:37:26,970 --> 00:37:29,790
okay

588
00:37:29,790 --> 00:37:35,540
we can read it again

589
00:37:35,540 --> 00:37:38,130
now my salary explode

590
00:37:38,130 --> 00:37:44,940
HAARP

591
00:37:44,940 --> 00:37:51,360
so what we

592
00:37:51,360 --> 00:37:56,870
as can do here we could for example the
eap and we can change the been to mine

593
00:37:56,870 --> 00:38:02,770
yet phone on my both change that you've
been for example okay

594
00:38:02,770 --> 00:38:06,280
and now I will show you another exploit
'em

595
00:38:06,280 --> 00:38:09,350
yeah we still stacking from the client
in a hundred

596
00:38:09,350 --> 00:38:13,150
and what we want to do is to

597
00:38:13,150 --> 00:38:16,590
find a pitkin so

598
00:38:16,590 --> 00:38:20,380
but I do he s first is I won't get

599
00:38:20,380 --> 00:38:23,590
order using this form and this is 10 so

600
00:38:23,590 --> 00:38:28,450
from 902 911 where

601
00:38:28,450 --> 00:38:33,530
I got the you the list at the CIA own I
have 11

602
00:38:33,530 --> 00:38:36,720
and looks interesting so I want

603
00:38:36,720 --> 00:38:40,440
attacked him okay

604
00:38:40,440 --> 00:38:47,440
so with we have fun the user name okay

605
00:38:47,670 --> 00:38:51,570
you remember the password fonda CIO
night hun

606
00:38:51,570 --> 00:38:55,120
111 it was thicker so what what

607
00:38:55,120 --> 00:39:02,120
but I want to do is I want to make it in
secret that's the

608
00:39:02,860 --> 00:39:06,340
user CIO 9 and a okay

609
00:39:06,340 --> 00:39:13,340
so exploit walks I will show you that
they explode really works up

610
00:39:16,280 --> 00:39:20,000
okay some

611
00:39:20,000 --> 00:39:25,250
problem with Windows ok so

612
00:39:25,250 --> 00:39:29,100
which had to abandon on client

613
00:39:29,100 --> 00:39:33,319
911 and the user both CIO 9

614
00:39:33,320 --> 00:39:36,940
im so now eating Syrian

615
00:39:36,940 --> 00:39:41,740
crew okay wearing

616
00:39:41,740 --> 00:39:45,650
here

617
00:39:45,650 --> 00:39:49,020
on our when Chinese testing the system
that means

618
00:39:49,020 --> 00:39:55,050
your the CIO has today his company must
shut down the system for five years

619
00:39:55,050 --> 00:39:58,940
as they fix said so

620
00:39:58,940 --> 00:40:03,490
that's not enough i hecka because the
hecker yes so that the CIO we'll

621
00:40:03,490 --> 00:40:10,490
notice it and that so what we do is

622
00:40:17,119 --> 00:40:20,109
okay in Pennington and the function has
restore

623
00:40:20,109 --> 00:40:24,299
okay we want restart the postulate fonda

624
00:40:24,299 --> 00:40:28,689
from the CIO it works again

625
00:40:28,689 --> 00:40:34,099
now which I to log on again

626
00:40:34,099 --> 00:40:37,699
Ste stay under and 911

627
00:40:37,699 --> 00:40:40,979
to you this CIO

628
00:40:40,979 --> 00:40:44,409
now I tits euchre yeah

629
00:40:44,409 --> 00:40:48,049
wearing me again so

630
00:40:48,049 --> 00:40:51,699
actual weekend restart the password at
the ASI I want

631
00:40:51,699 --> 00:40:56,150
notice it and his account was hijacked

632
00:40:56,150 --> 00:40:59,369
yet for your attack

633
00:40:59,369 --> 00:41:03,569
could to everything what he want yeah
that this was

634
00:41:03,569 --> 00:41:10,569
with me thank you great here so
basically this just making the point

635
00:41:13,640 --> 00:41:14,259
that

636
00:41:14,259 --> 00:41:18,209
in such an environment I'm you can
actually

637
00:41:18,209 --> 00:41:22,319
either with custom code or with your
abilities in sub-standard

638
00:41:22,319 --> 00:41:26,259
excess other clients data so now I'm we
did a survey on

639
00:41:26,259 --> 00:41:29,329
almost two hundred different custom Colt

640
00:41:29,329 --> 00:41:33,159
installations by SAP customers around
the world analyzing their cold

641
00:41:33,159 --> 00:41:37,469
and how much custom Colt performs
crossed lined excess

642
00:41:37,469 --> 00:41:41,329
in there no in in their own internally
developed court how many

643
00:41:41,329 --> 00:41:45,079
program so how many occurrences of cross
client excess

644
00:41:45,079 --> 00:41:51,429
do you think is common inist in the
average standard custom installation how

645
00:41:51,429 --> 00:41:52,709
many times do you see this

646
00:41:52,709 --> 00:41:57,089
unusual way of passing crossing the ball
to another client

647
00:41:57,089 --> 00:42:01,140
explicitly in the cold rally

648
00:42:01,140 --> 00:42:05,909
okay it's seventy six times on average
custom installation of

649
00:42:05,909 --> 00:42:09,789
around 200 systems this happens this is

650
00:42:09,789 --> 00:42:14,209
we can debate if it's really or not
against the two sticks can be used on

651
00:42:14,209 --> 00:42:16,089
Verizon but this is the number

652
00:42:16,089 --> 00:42:21,630
I'm and again how many occurrences of
the explicit

653
00:42:21,630 --> 00:42:25,369
Robert Klein specified to BC in the SAP
stand out

654
00:42:25,369 --> 00:42:32,169
what do you think of many other more or
less than 76 I hear more

655
00:42:32,169 --> 00:42:39,169
first second someone else

656
00:42:41,339 --> 00:42:44,999
2000 plus occurrences in the SUP Stand
that the Jews last

657
00:42:44,999 --> 00:42:48,039
I'm not saying hello SAP I'm not saying

658
00:42:48,039 --> 00:42:52,380
that the supportability I'm just saying
be so occurrences were caught

659
00:42:52,380 --> 00:42:59,380
its accessing data on a different client
so now let's have a look at

660
00:43:00,609 --> 00:43:03,919
CVSS guide from first or

661
00:43:03,919 --> 00:43:09,019
who is familiar with CBS thank you very
much

662
00:43:09,019 --> 00:43:13,549
quite a lot of you I'm CD assessed on
its supposed to give people an

663
00:43:13,549 --> 00:43:16,869
an idea about how severe a problem if

664
00:43:16,869 --> 00:43:20,949
if you look at and what their
confidentiality impact this partial

665
00:43:20,949 --> 00:43:24,769
there's considerable informational
disclosure access to some fights as

666
00:43:24,769 --> 00:43:25,489
possible

667
00:43:25,489 --> 00:43:28,949
but the hacker doesn't have control over
what is obtained on the scope of the

668
00:43:28,949 --> 00:43:32,609
date of this constraint an example is a
vulnerability that the values only

669
00:43:32,609 --> 00:43:33,119
certain

670
00:43:33,119 --> 00:43:38,329
tables in a database certain tables
complete

671
00:43:38,329 --> 00:43:41,729
there's total information disclosure
residing in all system fights being real

672
00:43:41,729 --> 00:43:45,049
the attackers able to read all systems
data memory fides et cetera

673
00:43:45,049 --> 00:43:48,719
this is the advisory

674
00:43:48,719 --> 00:43:52,829
for the vulnerability related to the gym
Eric cross client

675
00:43:52,829 --> 00:43:57,279
read access by ASAP you can download
this and twice as notes

676
00:43:57,279 --> 00:44:00,559
we Senate recipe 13th of February 2012

677
00:44:00,559 --> 00:44:03,589
it was fixed 14 of Martin

678
00:44:03,589 --> 00:44:07,549
may in 2013 page time for 151 days

679
00:44:07,549 --> 00:44:10,689
I don't know if the slot

680
00:44:10,689 --> 00:44:15,079
or not I don't I only work with SAP
security re

681
00:44:15,079 --> 00:44:18,759
I don't break other things just a sleepy
so I don't know if these numbers on

682
00:44:18,759 --> 00:44:19,689
industry average

683
00:44:19,689 --> 00:44:22,949
original not just fact these numbers are
there

684
00:44:22,949 --> 00:44:26,239
I'm the CVS s rating for this cross
client

685
00:44:26,239 --> 00:44:30,339
information disclosure we showed you
before is 3.5

686
00:44:30,339 --> 00:44:33,519
and the confidentiality impact is
partial

687
00:44:33,519 --> 00:44:38,989
I don't comment on that is just one SEP
put in the note you can think about this

688
00:44:38,989 --> 00:44:39,659
yourself

689
00:44:39,659 --> 00:44:44,130
whether this what make you install such
an old quickly or not

690
00:44:44,130 --> 00:44:49,659
let's look at the integrity impact CVSS

691
00:44:49,659 --> 00:44:53,979
again partial integrity impact
modification of some system fights

692
00:44:53,979 --> 00:44:55,159
information as possible

693
00:44:55,159 --> 00:44:58,469
but the ticket doesn't have control over
what can be modified mmm

694
00:44:58,469 --> 00:45:02,869
on the scope of what they take a can
effect is limited so if you know ASAP

695
00:45:02,869 --> 00:45:07,019
you know that 99 percent if not more of
all the information is

696
00:45:07,019 --> 00:45:12,429
in the database genetically to access to
the database cross client gives

697
00:45:12,429 --> 00:45:16,139
me access to 99 over nineteen percent of
all the data

698
00:45:16,139 --> 00:45:19,229
generic write access to the database

699
00:45:19,229 --> 00:45:22,759
gives me write access to ninety-nine
percent if not more

700
00:45:22,759 --> 00:45:27,329
all the date on the SAP system so now we
can debate if this is a partial I this

701
00:45:27,329 --> 00:45:30,150
is a complete integrity impact if I can
delete

702
00:45:30,150 --> 00:45:33,439
or modify and corrupt data as I wish the
same

703
00:45:33,439 --> 00:45:37,299
for availability

704
00:45:37,299 --> 00:45:40,759
what can happen these you can read this

705
00:45:40,759 --> 00:45:43,889
stuff later that is already online the
talk I'm

706
00:45:43,889 --> 00:45:47,630
if you want it you can download it right
after the talk

707
00:45:47,630 --> 00:45:52,909
I'm again here's SAP's note that fixes
the specific right excess water ability

708
00:45:52,909 --> 00:45:57,539
again center ASAP on the same date 13th
of February 2012

709
00:45:57,539 --> 00:46:01,130
fixed a up April 2013 415 days

710
00:46:01,130 --> 00:46:04,939
much time till till it was available

711
00:46:04,939 --> 00:46:09,259
CVS educating 6.0 impact

712
00:46:09,259 --> 00:46:13,239
on integrity partially on availability
partial end interestingly

713
00:46:13,239 --> 00:46:17,989
confidentiality partial for right excess
attack

714
00:46:17,989 --> 00:46:21,959
something so summary

715
00:46:21,959 --> 00:46:25,439
no statistics no lies I'm

716
00:46:25,439 --> 00:46:28,579
if you are a host that make sure

717
00:46:28,579 --> 00:46:34,189
that your host that a installs all SAP
security notes in a timely fashion

718
00:46:34,189 --> 00:46:36,839
otherwise you are prone to this kind of
attack

719
00:46:36,839 --> 00:46:40,130
it specifically ask him if the two North
we showed

720
00:46:40,130 --> 00:46:44,059
the earlier are really and start because
if they are not they are like the Swiss

721
00:46:44,059 --> 00:46:46,459
Army knife for an attack up

722
00:46:46,459 --> 00:46:50,609
check if your holster allows custom call
probably yes they do but

723
00:46:50,609 --> 00:46:54,219
how do they deal with this custom court
how do they prevent that

724
00:46:54,219 --> 00:46:57,669
one of the other hosted companies may be
a competitor of you

725
00:46:57,669 --> 00:47:01,049
is just at the hosting service with no
data

726
00:47:01,049 --> 00:47:05,459
some custom code and wants to break into
your stuff ask them how do they deal

727
00:47:05,459 --> 00:47:07,769
with custom called how do they make sure

728
00:47:07,769 --> 00:47:11,769
the other custom code does not affect
your data

729
00:47:11,769 --> 00:47:16,159
also check with the holster if you're
not in a really shared environment in on

730
00:47:16,159 --> 00:47:16,999
one system

731
00:47:16,999 --> 00:47:21,189
how the host that mitigates risk related
to Solution Manager how the hosts ahead

732
00:47:21,189 --> 00:47:22,859
in Solution Manager connections

733
00:47:22,859 --> 00:47:27,429
authorizations is it really hot in town
to the necessary minimum

734
00:47:27,429 --> 00:47:31,569
other services offline and froth and
foremost is the solution engine of the

735
00:47:31,569 --> 00:47:32,389
whole certain not

736
00:47:32,389 --> 00:47:36,409
online so and also ask if the host
there's

737
00:47:36,409 --> 00:47:40,479
performing penetration testing security
audits on a regular basis

738
00:47:40,479 --> 00:47:43,729
by SAP experts by sup security experts

739
00:47:43,729 --> 00:47:47,009
like I'm Alexander Paul your call from
from Russia or

740
00:47:47,009 --> 00:47:50,679
other companies like virtual porch re:
SNC or

741
00:47:50,679 --> 00:47:54,650
I'm whatever the ones on the on the list
so that other companies that have most

742
00:47:54,650 --> 00:47:59,249
sup security know how you take someone
that really knows what they're doing

743
00:47:59,249 --> 00:48:02,659
Mike Gatto sorry I forgot you in the
back you also an expert

744
00:48:02,659 --> 00:48:06,159
take some guy that knows what they're
doing that's %uh not some penetration

745
00:48:06,159 --> 00:48:09,519
guy

746
00:48:09,519 --> 00:48:12,539
cell I'm if you have further interest in

747
00:48:12,539 --> 00:48:16,709
SAP security topic here's the link to
all block

748
00:48:16,709 --> 00:48:21,359
if you have I'm interest in this
specific talk it's already available

749
00:48:21,359 --> 00:48:25,619
as PDF or download you can try now to
scan the QR code if you like

750
00:48:25,619 --> 00:48:29,409
download it otherwise it will be
distributed after the troopers

751
00:48:29,409 --> 00:48:31,669
conference

752
00:48:31,669 --> 00:48:35,599
no QR code scanners okay then we can
skip to the last slide

753
00:48:35,599 --> 00:48:38,849
if you have any questions now would be a
good time

754
00:48:38,849 --> 00:48:45,849
thank you very much for your attention

755
00:48:51,920 --> 00:48:56,370
yes

756
00:48:56,370 --> 00:49:03,370
ok

757
00:49:03,390 --> 00:49:06,660
every hotel bus who is this

758
00:49:06,660 --> 00:49:11,260
means the Rams his

759
00:49:11,260 --> 00:49:14,270
here is all

760
00:49:14,270 --> 00:49:18,990
almost every company it has my blessing
this is also has the most lead

761
00:49:18,990 --> 00:49:25,320
also very common you would say no
solutions manager his

762
00:49:25,320 --> 00:49:28,610
K is no excesses through a single point

763
00:49:28,610 --> 00:49:32,390
said you entitle as don't live who
doesn't

764
00:49:32,390 --> 00:49:39,280
the Internet you

765
00:49:39,280 --> 00:49:42,470
courses minutes important SM

766
00:49:42,470 --> 00:49:45,570
59 with all the other person who makes

767
00:49:45,570 --> 00:49:49,780
you see all this is a I'm

768
00:49:49,780 --> 00:49:52,920
world much nice

769
00:49:52,920 --> 00:49:56,360
much more usable posted jules is

770
00:49:56,360 --> 00:50:01,060
his strong full

771
00:50:01,060 --> 00:50:06,330
this could be an interesting approach

772
00:50:06,330 --> 00:50:09,440
I think I'm its where law

773
00:50:09,440 --> 00:50:12,770
II really I don't know if this is
possible

774
00:50:12,770 --> 00:50:15,910
house

775
00:50:15,910 --> 00:50:17,089
holes

776
00:50:17,089 --> 00:50:22,640
is

777
00:50:22,640 --> 00:50:26,930
I'll holes

778
00:50:26,930 --> 00:50:28,880
on

779
00:50:28,880 --> 00:50:33,050
Ross

780
00:50:33,050 --> 00:50:34,990
I'll

781
00:50:34,990 --> 00:50:35,720
is

782
00:50:35,720 --> 00:50:39,360
all home

783
00:50:39,360 --> 00:50:42,860
loss

784
00:50:42,860 --> 00:50:44,869
school

785
00:50:44,869 --> 00:50:50,320
moms

786
00:50:50,320 --> 00:50:52,930
his

787
00:50:52,930 --> 00:50:54,010
cool

788
00:50:54,010 --> 00:50:56,750
school

789
00:50:56,750 --> 00:51:00,030
you holes

790
00:51:00,030 --> 00:51:03,530
summarizes well in a situation where
your cell

791
00:51:03,530 --> 00:51:07,200
called for other companies yes this is
exactly the case

792
00:51:07,200 --> 00:51:10,540
his these officials even more insecure

793
00:51:10,540 --> 00:51:15,339
here but there definitely is not her

794
00:51:15,339 --> 00:51:18,839
either once with my lines

795
00:51:18,839 --> 00:51:22,760
and depends on walls castle exploits for

796
00:51:22,760 --> 00:51:27,619
you are individuals is the solution I I
don't really know it's possible

797
00:51:27,619 --> 00:51:30,849
have solutionsr and her client

798
00:51:30,849 --> 00:51:34,520
11 next I don't really know well

799
00:51:34,520 --> 00:51:41,520
home

800
00:51:47,990 --> 00:51:48,390
or

801
00:51:48,390 --> 00:51:51,270
yes right was it destroys the

802
00:51:51,270 --> 00:51:54,180
grill holster yesterday via

803
00:51:54,180 --> 00:51:57,530
interesting secure discussion white
people weapons

804
00:51:57,530 --> 00:52:02,210
soils were here from her eyes thanks
what sponsors

805
00:52:02,210 --> 00:52:05,330
there well companies are only a trickle

806
00:52:05,330 --> 00:52:08,380
all kind of attack this is a test score
the audience

807
00:52:08,380 --> 00:52:12,710
for their they talked on this is not a
Whore

808
00:52:12,710 --> 00:52:16,410
us because there's yes all the different
things because

809
00:52:16,410 --> 00:52:21,640
role there are very many as a here

810
00:52:21,640 --> 00:52:24,790
bread yesterday's sup

811
00:52:24,790 --> 00:52:27,810
10 stuff take back towards

812
00:52:27,810 --> 00:52:31,450
yeah haha supposed

813
00:52:31,450 --> 00:52:35,720
in the whole environment its even more
problematic because it is a

814
00:52:35,720 --> 00:52:39,610
because other companies have that power
to deploy

815
00:52:39,610 --> 00:52:43,620
close and Ron custom call with that look

816
00:52:43,620 --> 00:52:47,610
haha we have I one this

817
00:52:47,610 --> 00:52:54,030
her well here

818
00:52:54,030 --> 00:52:59,940
writer their was any other

819
00:52:59,940 --> 00:53:03,230
their his

820
00:53:03,230 --> 00:53:10,230
and

821
00:53:11,260 --> 00:53:15,760
yeah candles low privilege were

822
00:53:15,760 --> 00:53:18,800
for all the different individuals
systems however

823
00:53:18,800 --> 00:53:22,950
sis solutions as calling loss all
different functions

824
00:53:22,950 --> 00:53:26,250
it's very the growth finds these

825
00:53:26,250 --> 00:53:30,440
says authorizations that makes sense
since the

826
00:53:30,440 --> 00:53:34,170
make a system operation with this this
is

827
00:53:34,170 --> 00:53:37,250
there's it means his

828
00:53:37,250 --> 00:53:40,900
its it can drop read other

829
00:53:40,900 --> 00:53:47,900
ger

830
00:53:48,590 --> 00:53:52,100
also ours

831
00:53:52,100 --> 00:53:57,030
is an hour he doesn't really matter

832
00:53:57,030 --> 00:54:00,490
sexual this literature

833
00:54:00,490 --> 00:54:04,130
bills running with these are exempt
workers

834
00:54:04,130 --> 00:54:11,130
you can simply access

835
00:54:17,900 --> 00:54:24,900
we did Bieber looking to the button is
also her

836
00:54:25,000 --> 00:54:28,300
if it's OK for the best all

837
00:54:28,300 --> 00:54:31,460
good chance that your or

838
00:54:31,460 --> 00:54:36,270
old

839
00:54:36,270 --> 00:54:43,270
court

840
00:54:43,820 --> 00:54:47,140
soon

841
00:54:47,140 --> 00:54:54,140
right

842
00:54:58,050 --> 00:55:01,210
I mean definitely you cannot stop

843
00:55:01,210 --> 00:55:04,460
his Ruth residual

844
00:55:04,460 --> 00:55:11,460
should not be exposed positions began

845
00:55:11,910 --> 00:55:17,500
also discuss of both world

846
00:55:17,500 --> 00:55:24,490
people any other

847
00:55:24,490 --> 00:55:26,619
okay thank you very much and Bon Apetit

