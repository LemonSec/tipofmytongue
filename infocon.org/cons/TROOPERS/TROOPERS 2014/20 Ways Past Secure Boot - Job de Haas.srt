1
00:00:03,979 --> 00:00:07,330
yes so welcome I'm short introduction

2
00:00:07,330 --> 00:00:10,580
I am my name is a past like this

3
00:00:10,580 --> 00:00:14,500
Sat I am I work for a company called
risk your

4
00:00:14,500 --> 00:00:17,710
we specialize in security testing

5
00:00:17,710 --> 00:00:22,630
devices so embedded systems arm we also
make a a product range

6
00:00:22,630 --> 00:00:27,140
that focuses on such an all-important
section and I'm

7
00:00:27,140 --> 00:00:30,839
but we also do a lot of so for
engineering and all kinds of stuff

8
00:00:30,839 --> 00:00:33,989
and I've been doing it for too long

9
00:00:33,989 --> 00:00:37,330
basically so

10
00:00:37,330 --> 00:00:40,870
what I'm going to talk about is secure
boot for some introduction

11
00:00:40,870 --> 00:00:44,230
what like scoping it like a Michael sup

12
00:00:44,230 --> 00:00:48,080
it's it's for PCs for BIOS but also for
embedded devices

13
00:00:48,080 --> 00:00:51,530
and then I basically have a long list of
things

14
00:00:51,530 --> 00:00:55,410
that i won they drew up because I want
to advise people on

15
00:00:55,410 --> 00:00:58,430
on secure boot in because I saw so many
things going wrong

16
00:00:58,430 --> 00:01:02,950
and a list got longer and longer so now
I try to put it into a presentation but

17
00:01:02,950 --> 00:01:04,040
it's still a long list

18
00:01:04,040 --> 00:01:08,109
I made a distinction between Harbor and
logical but of course it's all one big

19
00:01:08,109 --> 00:01:08,780
bunch

20
00:01:08,780 --> 00:01:11,869
in the in the insanity by so the
distinction is all that these

21
00:01:11,869 --> 00:01:14,999
to make I'm and in the middle I

22
00:01:14,999 --> 00:01:18,979
of course I hope a demo because I like
to play was stopped and I like a good

23
00:01:18,979 --> 00:01:19,420
life

24
00:01:19,420 --> 00:01:22,479
um the and this is our

25
00:01:22,479 --> 00:01:25,990
showing you a a glitch but we'll get to
that in the middle

26
00:01:25,990 --> 00:01:29,329
so secure boot

27
00:01:29,329 --> 00:01:34,409
like I said I'm not going to talk about
Microsoft looked on UEFI secure boot

28
00:01:34,409 --> 00:01:39,560
I am not that that doesn't apply but its
job just not my area of expertise

29
00:01:39,560 --> 00:01:43,619
man actually there's very interesting
work by mitre butterworth

30
00:01:43,619 --> 00:01:48,770
and Corey what his last name of very
interesting presentations from

31
00:01:48,770 --> 00:01:52,729
BIOS secure boot mistakes and faults
that are

32
00:01:52,729 --> 00:01:56,319
currently in all our systems basically
there's hardly any secure by those

33
00:01:56,319 --> 00:01:56,759
around

34
00:01:56,759 --> 00:02:02,929
but I'm not focusing on at that moment
so what I do look at this device is

35
00:02:02,929 --> 00:02:06,979
an basically all these devices have a
means to pre-fund

36
00:02:06,979 --> 00:02:10,580
been authenticated coat being stolen it
to protect their

37
00:02:10,580 --> 00:02:13,620
secrets to protect their secure
functions

38
00:02:13,620 --> 00:02:17,050
and their under you know quote content
whatever

39
00:02:17,050 --> 00:02:21,540
and well you already recognize a few
things that you would like to hack

40
00:02:21,540 --> 00:02:25,150
because you like the content and that is
I think the

41
00:02:25,150 --> 00:02:29,420
a main point to take away from secure
boot I don't want to get to political

42
00:02:29,420 --> 00:02:29,850
but

43
00:02:29,850 --> 00:02:33,790
I am it is a double-edged sword because
what is it used for

44
00:02:33,790 --> 00:02:39,200
typically I'm forty five assists and why
said protecting against the Packers Hall

45
00:02:39,200 --> 00:02:39,800
because

46
00:02:39,800 --> 00:02:42,870
day carrying it in their pockets all day
or tits in your own wits your

47
00:02:42,870 --> 00:02:44,810
entertainment system and you want to act

48
00:02:44,810 --> 00:02:49,360
this new users they want to protect
against on the other hand if I lose my

49
00:02:49,360 --> 00:02:50,100
device

50
00:02:50,100 --> 00:02:53,730
or if my device is connected to the
Internet I also

51
00:02:53,730 --> 00:02:58,190
don't want other people too abuse my
system I don't want and is a

52
00:02:58,190 --> 00:03:01,460
to bed or my system I don't wanna go to
China and

53
00:03:01,460 --> 00:03:04,520
at my laptop broken into in in my hotel
room so

54
00:03:04,520 --> 00:03:07,660
I also have a personal interest in a
good secure boot so

55
00:03:07,660 --> 00:03:12,210
both sides from the on the fence happen
interest but of course it can be used to

56
00:03:12,210 --> 00:03:12,830
deny

57
00:03:12,830 --> 00:03:18,570
user a legitimate user access to your
own artwork just to remember

58
00:03:18,570 --> 00:03:21,910
so so what a secure boats

59
00:03:21,910 --> 00:03:25,330
I'm basically it to say very simple

60
00:03:25,330 --> 00:03:29,230
mechanism you have a root of trust
typically its an internal key

61
00:03:29,230 --> 00:03:33,880
in the in the room or in a in a in a
system and it is used to verify in next

62
00:03:33,880 --> 00:03:34,410
stage

63
00:03:34,410 --> 00:03:39,200
buy a digital signature sorry make a
digital signature ok to go to 12

64
00:03:39,200 --> 00:03:43,450
execute before you executed to take the
digital signature you for fights a good

65
00:03:43,450 --> 00:03:46,770
and you execute that states are you go
to do for stage

66
00:03:46,770 --> 00:03:50,660
you can do this multiple times actually

67
00:03:50,660 --> 00:03:53,880
we hardly ever see an internal system

68
00:03:53,880 --> 00:03:58,050
check a signature and then never again
there's always two stages

69
00:03:58,050 --> 00:04:02,850
anyone know why there are stages why
make it complicated

70
00:04:02,850 --> 00:04:05,980
so the the real

71
00:04:05,980 --> 00:04:09,940
interesting fact is that you can
delegate trust you can

72
00:04:09,940 --> 00:04:15,310
have some other key signed by your key
and the prosecution on by someone else

73
00:04:15,310 --> 00:04:17,180
so you can affirm in effect of a chip

74
00:04:17,180 --> 00:04:20,820
but can delegate trust to a medical
device manufacturer and a device

75
00:04:20,820 --> 00:04:22,490
manufacture condemning a trust to

76
00:04:22,490 --> 00:04:25,880
so for fender are so it is nice for

77
00:04:25,880 --> 00:04:29,770
let's say the business side to be able
to delegate distrust so you get this

78
00:04:29,770 --> 00:04:30,790
multiple stages

79
00:04:30,790 --> 00:04:35,010
sometimes there are many of course

80
00:04:35,010 --> 00:04:38,680
with a chain reno old security and a
chain

81
00:04:38,680 --> 00:04:42,310
there's only one work this week to slink
so that also applies here

82
00:04:42,310 --> 00:04:47,460
so how does it go in practice

83
00:04:47,460 --> 00:04:52,400
so what you get is it is also used for
other things and allocating trust it is

84
00:04:52,400 --> 00:04:53,139
also

85
00:04:53,139 --> 00:04:56,370
use to release privileges along the way

86
00:04:56,370 --> 00:05:00,460
so now we get these devices with arm and
withdrew song

87
00:05:00,460 --> 00:05:04,370
first execution environments you may
have heard of it it's all in all our

88
00:05:04,370 --> 00:05:05,740
smartphone these days

89
00:05:05,740 --> 00:05:09,180
we have a tryst execution environment
that is using trucks on

90
00:05:09,180 --> 00:05:12,630
to to protect it arm and that is

91
00:05:12,630 --> 00:05:17,270
initialize in the very early stages and
under the privileges are released

92
00:05:17,270 --> 00:05:21,370
for all the cold after that will run at
the lower prefers level

93
00:05:21,370 --> 00:05:24,240
so now secure boot attacking becomes
interesting because if you want to get

94
00:05:24,240 --> 00:05:25,810
in the privilege level

95
00:05:25,810 --> 00:05:29,730
you need to find a flaw very you know or
you need to

96
00:05:29,730 --> 00:05:33,960
go back into the previous layers

97
00:05:33,960 --> 00:05:37,190
arm and in the end of course you got to
you put on your Android kernel for

98
00:05:37,190 --> 00:05:38,260
instance and

99
00:05:38,260 --> 00:05:41,530
and you can still have your usual and
exploit that exploit your device

100
00:05:41,530 --> 00:05:45,669
so it's still secure booting but it's
still in secure so it doesn't mean

101
00:05:45,669 --> 00:05:49,030
that if you up secure boot it your iOS
device to secure

102
00:05:49,030 --> 00:05:52,940
arm but a it gives us. if you shouldn't
features

103
00:05:52,940 --> 00:05:56,220
that that are nice I'm if it feels so
good

104
00:05:56,220 --> 00:06:00,389
arbitrary code execution of course at
any of the provincial levels where you

105
00:06:00,389 --> 00:06:02,139
manage to break it

106
00:06:02,139 --> 00:06:05,460
arm but often it's not very persistent

107
00:06:05,460 --> 00:06:08,860
so because the root of trust the key
hasn't changed often

108
00:06:08,860 --> 00:06:11,960
so still can be difficult to to

109
00:06:11,960 --> 00:06:15,360
reboot the system is still be exploited

110
00:06:15,360 --> 00:06:20,660
typically a system that house a good few
first stage is scanned can retain

111
00:06:20,660 --> 00:06:23,690
or recover its security now

112
00:06:23,690 --> 00:06:27,960
but sometimes not if you can can by
getting high privilege

113
00:06:27,960 --> 00:06:32,220
I split something that then makes the
device Inc

114
00:06:32,220 --> 00:06:36,290
it's a test device or something like
this: then it might be a personal attack

115
00:06:36,290 --> 00:06:41,310
so it divers how to secure boot exploits

116
00:06:41,310 --> 00:06:46,430
kind of its effect what a dusk if you
often as a stepping stone

117
00:06:46,430 --> 00:06:49,970
because arm let's say a tuner state
aromas not

118
00:06:49,970 --> 00:06:53,790
read one more than later you break it
you can expect from croat

119
00:06:53,790 --> 00:06:58,400
temporarily use that as a stepping stone
sometimes these coats or encrypt it you

120
00:06:58,400 --> 00:06:58,880
can

121
00:06:58,880 --> 00:07:02,050
get the credit for chinook and
unexploited so

122
00:07:02,050 --> 00:07:05,050
a stepping stone is certainly an
effective

123
00:07:05,050 --> 00:07:11,110
no result from a secure boot attack

124
00:07:11,110 --> 00:07:14,660
okay at twenty ways through was a title
my talk are

125
00:07:14,660 --> 00:07:18,460
I don't know anything wire for that wife
I had done problems and I

126
00:07:18,460 --> 00:07:22,169
15 problem so i thought well that's nice
level something to talk

127
00:07:22,169 --> 00:07:26,410
up 20 where's I think I need to switch
off my phone

128
00:07:26,410 --> 00:07:30,389
someone talking put it away I am

129
00:07:30,389 --> 00:07:33,410
in the end well 20 races just a number

130
00:07:33,410 --> 00:07:37,320
and I just try to I find enough of them

131
00:07:37,320 --> 00:07:40,860
there's no really a logical way our I

132
00:07:40,860 --> 00:07:45,370
your present them II mater rough shift
between hardware and logical but

133
00:07:45,370 --> 00:07:49,040
there's no real priority of course are
try to leave something more interesting

134
00:07:49,040 --> 00:07:50,690
one city and zip

135
00:07:50,690 --> 00:07:56,050
basically there's no mosser plan behind
this list

136
00:07:56,050 --> 00:08:02,650
I'm other then maybe you too dirty cheap
way to promote my business

137
00:08:02,650 --> 00:08:05,910
goods restart Arbor related attacks

138
00:08:05,910 --> 00:08:10,770
so the simplest one know we see still
many embedded devices Jaytech

139
00:08:10,770 --> 00:08:14,840
arm to debug interface and I think these
days

140
00:08:14,840 --> 00:08:18,340
I know when I started this stuff like
10-15 years ago

141
00:08:18,340 --> 00:08:21,449
not too many people took things apart
these days everyone takes

142
00:08:21,449 --> 00:08:25,009
suffer part in the two things you look
for Jaytech a new art

143
00:08:25,009 --> 00:08:28,040
which i think is still there to be
looking to face and it still use the

144
00:08:28,040 --> 00:08:29,229
lock

145
00:08:29,229 --> 00:08:32,690
in in phone recovery and all kinds of
things

146
00:08:32,690 --> 00:08:36,159
I it gives you a full deberg

147
00:08:36,159 --> 00:08:39,649
no capability of a device which can in
principle

148
00:08:39,649 --> 00:08:43,510
break the whole secured with chain that
simple

149
00:08:43,510 --> 00:08:47,600
I have 20 so I have to rush a bit so if
you think what's a guy rushton

150
00:08:47,600 --> 00:08:50,720
it's true um the second one the UART

151
00:08:50,720 --> 00:08:54,110
so a you are this a service interface

152
00:08:54,110 --> 00:08:57,420
I and why do people people leave a
timber

153
00:08:57,420 --> 00:09:00,680
abort because they wanna surface when it
comes back it's broken

154
00:09:00,680 --> 00:09:04,520
are you want to debug something the big
question is why do you put in your

155
00:09:04,520 --> 00:09:07,980
production defies can you not at it
later but if it's broken sometimes hard

156
00:09:07,980 --> 00:09:08,450
to put

157
00:09:08,450 --> 00:09:11,800
stuff on there I this is a nice example
the

158
00:09:11,800 --> 00:09:15,960
the the nuke which also you reader for
said Barnes and Noble

159
00:09:15,960 --> 00:09:20,740
I am so they had a the UART and they had
u-boot doing signature checking so

160
00:09:20,740 --> 00:09:21,720
actually you boutros

161
00:09:21,720 --> 00:09:25,630
doing second checking but you're still
good could get the prompt so

162
00:09:25,630 --> 00:09:28,940
you would get a prompt and then you
would to with memory right

163
00:09:28,940 --> 00:09:32,520
just pic a race to seeking to check and
I you

164
00:09:32,520 --> 00:09:37,810
reboot so to no why do you put signature
checking into your boot up for

165
00:09:37,810 --> 00:09:41,040
gets the same service to remove it home

166
00:09:41,040 --> 00:09:44,620
this is still a very simple stuff where
people already try to do something but

167
00:09:44,620 --> 00:09:45,260
very

168
00:09:45,260 --> 00:09:49,080
really do not have a concept yet

169
00:09:49,080 --> 00:09:53,470
um this is also interesting one

170
00:09:53,470 --> 00:09:57,870
many devices support booting from
different sources

171
00:09:57,870 --> 00:10:01,410
so you can boot from a flash chip for
your computer for a spy bus or you can

172
00:10:01,410 --> 00:10:04,040
boot overuse be or you can put over your

173
00:10:04,040 --> 00:10:09,050
arm for some reason there's also the
option to

174
00:10:09,050 --> 00:10:12,610
boot with different privileges or
without signature checking

175
00:10:12,610 --> 00:10:16,640
so people that do issues found at their
support been

176
00:10:16,640 --> 00:10:19,670
for famous chip into

177
00:10:19,670 --> 00:10:23,070
you can justify serving a renaissance
chipper ball so I don't know

178
00:10:23,070 --> 00:10:26,370
arm and then it doesn't check signatures
so you

179
00:10:26,370 --> 00:10:30,770
use this this pin is summer it in on the
PCB should I make this whole check so

180
00:10:30,770 --> 00:10:32,480
the people in the garage can do it

181
00:10:32,480 --> 00:10:37,029
you just shop in the ECU been this
automatically found and then you come

182
00:10:37,029 --> 00:10:42,649
flash and resettle the something to your
issue so that you can drive faster on

183
00:10:42,649 --> 00:10:46,540
stuff like that

184
00:10:46,540 --> 00:10:49,810
a very famous on I'm and also a

185
00:10:49,810 --> 00:10:54,120
has been present for a long time because
in embedded systems often there was no

186
00:10:54,120 --> 00:10:54,380
to

187
00:10:54,380 --> 00:10:57,399
ability to do much about this these days
chips

188
00:10:57,399 --> 00:11:00,580
are stronger more memory also internal
memory

189
00:11:00,580 --> 00:11:04,850
they become a bit better but ideas that
if you checked this integrity of

190
00:11:04,850 --> 00:11:08,160
of coat done

191
00:11:08,160 --> 00:11:11,839
when you start executing it there's a
time difference

192
00:11:11,839 --> 00:11:15,200
in between the time that should not be
possible for the attacker to change to

193
00:11:15,200 --> 00:11:16,610
coat

194
00:11:16,610 --> 00:11:19,870
because you cannot really execute the
code when you execute or

195
00:11:19,870 --> 00:11:23,270
for a fight because when you execute it
so there's always a time checking and

196
00:11:23,270 --> 00:11:25,020
there's a time for execution

197
00:11:25,020 --> 00:11:29,270
if you have external flash storage like
more flesh like in your phone's

198
00:11:29,270 --> 00:11:32,580
done it was a matter of intercepting the
bus

199
00:11:32,580 --> 00:11:36,700
waiting till the check was over and no
one execution started June

200
00:11:36,700 --> 00:11:41,190
start flipping bits an very famous guy
called a song called to preach

201
00:11:41,190 --> 00:11:45,290
made a device that was so very simple
Super D logic

202
00:11:45,290 --> 00:11:48,490
have monitored one data bit for a
pattern

203
00:11:48,490 --> 00:11:52,990
of execution and would flip one bit and
that one bit will change

204
00:11:52,990 --> 00:11:57,290
a the signature and he could turn this
into a personal attack so are you

205
00:11:57,290 --> 00:12:00,910
I don't need to do this once and on the
phone was unlocked

206
00:12:00,910 --> 00:12:04,730
culture and we have seen this in mind by
two feet long time but

207
00:12:04,730 --> 00:12:08,899
typically used to snow solved by loading
the coat in

208
00:12:08,899 --> 00:12:13,709
in RAM so or or protecting the memory
interface itself

209
00:12:13,709 --> 00:12:17,980
but loading coating RAM also the Rams an
external bus so

210
00:12:17,980 --> 00:12:21,830
you may be just shifting the problem too
were faster boss

211
00:12:21,830 --> 00:12:26,220
flash bus is really slow easy to attack
d Rambus a bit more difficult

212
00:12:26,220 --> 00:12:32,839
arm but you may be just replacing the
problem

213
00:12:32,839 --> 00:12:36,070
okay timing attacks arm

214
00:12:36,070 --> 00:12:39,899
wiser to physical attack all in in in in
a better fit your device when you're

215
00:12:39,899 --> 00:12:41,519
booting typically you

216
00:12:41,519 --> 00:12:44,240
you have to measure some physical
signals to understand that this is

217
00:12:44,240 --> 00:12:45,209
happening

218
00:12:45,209 --> 00:12:49,360
ideas that if you do and H Mexican Jer

219
00:12:49,360 --> 00:12:53,019
done your signatures basically 20 bytes
and you

220
00:12:53,019 --> 00:12:56,930
just calculate and compare it to be
stored value in your

221
00:12:56,930 --> 00:13:00,860
update or in your former I'm

222
00:13:00,860 --> 00:13:04,240
if you quit comparing after

223
00:13:04,240 --> 00:13:09,260
the first fill failed bites then you can
start seeing a difference and a source

224
00:13:09,260 --> 00:13:14,029
found in the x-box 360 so very famous
timing attack

225
00:13:14,029 --> 00:13:17,040
a in the gaming industry so

226
00:13:17,040 --> 00:13:20,269
the way day executed it two day sold the
sports

227
00:13:20,269 --> 00:13:25,010
so they use this more PGA I'm you at the
solar wire student and flash

228
00:13:25,010 --> 00:13:29,940
and a few selected wires on the board so
you the use to post condition

229
00:13:29,940 --> 00:13:33,800
which is an error code of two just
booting so it could detect

230
00:13:33,800 --> 00:13:37,550
when the error coats whatever state was
happening

231
00:13:37,550 --> 00:13:43,329
and that time it took from boot to the
Tara coat is what I use for tonya tech

232
00:13:43,329 --> 00:13:47,269
and I use this simple logic I'm

233
00:13:47,269 --> 00:13:51,050
you right in and flash the image

234
00:13:51,050 --> 00:13:55,350
which is not signed you start older dash
by 280

235
00:13:55,350 --> 00:13:59,190
you just start measuring the time

236
00:13:59,190 --> 00:14:02,610
so the first time the first bite us well

237
00:14:02,610 --> 00:14:06,540
to 54 of the 22 or 50 52 to 56 is wrong

238
00:14:06,540 --> 00:14:09,570
so it will have a certain time

239
00:14:09,570 --> 00:14:12,910
and then you will start increasing the
bite 1,2,3,4,5

240
00:14:12,910 --> 00:14:16,060
until it's a bit later

241
00:14:16,060 --> 00:14:20,170
I because then the check is OK for first
bite in the second part will be wrong

242
00:14:20,170 --> 00:14:23,550
and you just started reading a bite and
then the next

243
00:14:23,550 --> 00:14:26,709
a certain moment it will be a bit slower
your step

244
00:14:26,709 --> 00:14:31,940
second bite is good so it goes on and
this so what's automated

245
00:14:31,940 --> 00:14:36,149
but its main port took about two hours
tu brute force because have to write

246
00:14:36,149 --> 00:14:36,740
Nantong

247
00:14:36,740 --> 00:14:41,100
reboot over it still takes a while but
two hours and then you have

248
00:14:41,100 --> 00:14:44,810
y'all permanent attack because you have
a full signature on your or

249
00:14:44,810 --> 00:14:49,709
when you're cope

250
00:14:49,709 --> 00:14:53,410
okay now another heart attack glitch

251
00:14:53,410 --> 00:14:59,690
sensitivity so and now we get already in
a bit more manipulative

252
00:14:59,690 --> 00:15:02,769
attacks let's say so

253
00:15:02,769 --> 00:15:05,940
bitching a.m. for those we don't know is

254
00:15:05,940 --> 00:15:10,140
is some way to externally manipulator
system

255
00:15:10,140 --> 00:15:14,339
to make it do something else I and the
stimulus may be anything

256
00:15:14,339 --> 00:15:17,339
so you can use a voltage dip

257
00:15:17,339 --> 00:15:21,120
you can use laser lights on the dye

258
00:15:21,120 --> 00:15:26,680
you can use electromagnetic waves are
you can even use radiation

259
00:15:26,680 --> 00:15:30,860
so I'm not sure if people a seeing the
CCC

260
00:15:30,860 --> 00:15:34,980
this year with them two guys from the
opinion de F experimented with

261
00:15:34,980 --> 00:15:38,370
radiation by putting that close to chip
and

262
00:15:38,370 --> 00:15:42,290
obtaining somewhere if accepted that I
will demo short

263
00:15:42,290 --> 00:15:46,170
so um there are different things you can

264
00:15:46,170 --> 00:15:49,970
glitch of course because glitching
really works at the gate level at two

265
00:15:49,970 --> 00:15:51,389
transistor level so

266
00:15:51,389 --> 00:15:55,389
a translucent for a sister or a group of
processors will go left unsaid right and

267
00:15:55,389 --> 00:15:57,339
they will do other stuff

268
00:15:57,339 --> 00:16:00,880
what that really means for for a target

269
00:16:00,880 --> 00:16:03,980
depends on the design I am

270
00:16:03,980 --> 00:16:07,029
in our example now we will look at Colt

271
00:16:07,029 --> 00:16:10,360
and basically destruction engine off to
chip will do

272
00:16:10,360 --> 00:16:13,370
something else than intended

273
00:16:13,370 --> 00:16:17,850
and it is a matter of finding dose
faults that call so to do something

274
00:16:17,850 --> 00:16:21,010
that is still meaningful so you don't
want to crash

275
00:16:21,010 --> 00:16:26,630
I freeze up which from you want II
meaningful change

276
00:16:26,630 --> 00:16:30,930
from what can you do about that well
because you're still

277
00:16:30,930 --> 00:16:34,899
influencing cold flow you could
construct a quote in a way to dismiss

278
00:16:34,899 --> 00:16:36,769
more resilient to use

279
00:16:36,769 --> 00:16:41,690
false if you do an if statement on some
condition you could construct

280
00:16:41,690 --> 00:16:45,720
if statements that used to conditions in
multiple ways

281
00:16:45,720 --> 00:16:49,329
to make sure that for instance a single
fault cannot

282
00:16:49,329 --> 00:16:53,790
of course you too going the wrong way

283
00:16:53,790 --> 00:16:56,930
well there's all kinds of examples we
have a paper on our

284
00:16:56,930 --> 00:17:00,680
website also to show some of the
mitigations that you can do

285
00:17:00,680 --> 00:17:05,169
I typically because you are polish
physical stuff around it

286
00:17:05,169 --> 00:17:08,530
it's not the persistent attack you can
do it with an issue

287
00:17:08,530 --> 00:17:11,549
butchered it rise again without a glitch
will still do the old stuff

288
00:17:11,549 --> 00:17:15,890
so it's not so trivial to make something
that all

289
00:17:15,890 --> 00:17:21,089
repeatability glitch a device all the
time

290
00:17:21,089 --> 00:17:24,809
later other attacks were seen

291
00:17:24,809 --> 00:17:29,710
on the ps3 where they glitched access to
a memory bus

292
00:17:29,710 --> 00:17:33,190
or the x-box 360 where they did

293
00:17:33,190 --> 00:17:36,270
of a glitch on the reset line

294
00:17:36,270 --> 00:17:40,049
so the reset line was pulled low but for
short moment

295
00:17:40,049 --> 00:17:44,780
let's say out of spec and not the full
system wanted to reset

296
00:17:44,780 --> 00:17:48,490
so there are all kinds of the slight
mishaps that happen in systems when you

297
00:17:48,490 --> 00:17:49,280
start

298
00:17:49,280 --> 00:17:53,270
playing outside so in a sense you can
compared to submit to the previous talk

299
00:17:53,270 --> 00:17:54,650
with her the packets

300
00:17:54,650 --> 00:17:58,160
and their waist up nothing slightly go
out of

301
00:17:58,160 --> 00:18:02,530
out of spec and then things start to
happen that you don't want

302
00:18:02,530 --> 00:18:05,919
and as soon as you start to be able to
control the CFX

303
00:18:05,919 --> 00:18:10,590
I they become a danger

304
00:18:10,590 --> 00:18:14,260
so how does this work what do I happier
um

305
00:18:14,260 --> 00:18:17,340
I ever abort and it's a very simple
example

306
00:18:17,340 --> 00:18:23,450
so to from maybe take the magic: away a
little bit it's already clear

307
00:18:23,450 --> 00:18:28,320
it's all a demo I am a good thing is it
works really well the

308
00:18:28,320 --> 00:18:31,940
because of that but it is not super
realistic

309
00:18:31,940 --> 00:18:35,450
I what we have a support and I am

310
00:18:35,450 --> 00:18:38,540
it has a reset line we can reset it and

311
00:18:38,540 --> 00:18:41,960
it is an AVR chipman actually a chip
children's art

312
00:18:41,960 --> 00:18:45,020
32 megahertz and we have some code on
their

313
00:18:45,020 --> 00:18:48,410
and I will show you shortly that we can
no

314
00:18:48,410 --> 00:18:52,880
show to go in different directions

315
00:18:52,880 --> 00:18:56,100
is this a real attack you think well I

316
00:18:56,100 --> 00:19:00,640
actually this I when I was just going
over the internet to see what other

317
00:19:00,640 --> 00:19:01,780
people were doing in

318
00:19:01,780 --> 00:19:04,970
%um glitching I came across this kind of

319
00:19:04,970 --> 00:19:08,730
devices I am so they put in

320
00:19:08,730 --> 00:19:12,940
a few 94 batteries and a nice loop you
can see that the

321
00:19:12,940 --> 00:19:16,600
4s implied lights up a few if you
richards

322
00:19:16,600 --> 00:19:21,460
and then okay but what do you do with
this coil

323
00:19:21,460 --> 00:19:25,419
they do this see if it works

324
00:19:25,419 --> 00:19:28,870
so down over son's but

325
00:19:28,870 --> 00:19:31,940
this is a slot machine so you put the

326
00:19:31,940 --> 00:19:37,460
oil in the corner and three and
demeaning

327
00:19:37,460 --> 00:19:40,630
your money

328
00:19:40,630 --> 00:19:43,790
so and there are several videos on the
internet doing this are currently there

329
00:19:43,790 --> 00:19:44,370
are

330
00:19:44,370 --> 00:19:47,520
for mobile so options to this kind of
trick

331
00:19:47,520 --> 00:19:50,540
and that's just the impulse apparently
gifts there

332
00:19:50,540 --> 00:19:55,590
the money system jolt and that's thanks
monies entered into the system

333
00:19:55,590 --> 00:19:59,890
so so the good thing about this attack
issued only

334
00:19:59,890 --> 00:20:03,830
timing you'd only triggering at this it
looks pretty robust I don't know I

335
00:20:03,830 --> 00:20:06,630
haven't tried how many of these systems
work in the field but

336
00:20:06,630 --> 00:20:10,210
but anyway so just to get some

337
00:20:10,210 --> 00:20:13,500
kind of no background of yeah is this
realistic attack

338
00:20:13,500 --> 00:20:19,549
from we do test this for a for a
customer so it is something that

339
00:20:19,549 --> 00:20:22,580
yeah people aren't aware of so

340
00:20:22,580 --> 00:20:27,530
little fewer to coach I want to go doing
so I said the district 02 fixing sure

341
00:20:27,530 --> 00:20:28,679
you have a boolean

342
00:20:28,679 --> 00:20:32,320
bullion is true Bennett SR I'm secure
I'm booting

343
00:20:32,320 --> 00:20:36,660
and it will go on and it opened let's go

344
00:20:36,660 --> 00:20:40,340
I'm if the ball is false then it's sooo
whats in secure

345
00:20:40,340 --> 00:20:43,340
this is not good I will go into a while
loop

346
00:20:43,340 --> 00:20:47,470
ogles will stay there so arm

347
00:20:47,470 --> 00:20:50,789
the IDS false offer was loaded onto this
target so

348
00:20:50,789 --> 00:20:55,840
now the secure boot will be false if I
run this

349
00:20:55,840 --> 00:20:58,840
okay see I'll

350
00:20:58,840 --> 00:21:03,470
whether to set up I am we have a
workstation with some so far we have a

351
00:21:03,470 --> 00:21:04,400
box that this

352
00:21:04,400 --> 00:21:08,100
a BJ based for the timing of the polls

353
00:21:08,100 --> 00:21:11,210
and now we have this thing here which is
an p.m. if I

354
00:21:11,210 --> 00:21:16,679
a electromagnetic field injector which
is basically a coil

355
00:21:16,679 --> 00:21:20,090
where you discharge a large current into
the call

356
00:21:20,090 --> 00:21:23,110
and gifts and %um field very locally
bemused for

357
00:21:23,110 --> 00:21:27,280
used to court I'm I didn't want to carry
this whole

358
00:21:27,280 --> 00:21:30,950
XY stage things are in a factor
something else

359
00:21:30,950 --> 00:21:35,220
but also the probe was still works
because I can do it manually

360
00:21:35,220 --> 00:21:38,860
here and so

361
00:21:38,860 --> 00:21:43,190
well the divers a bit closer a I will
show

362
00:21:43,190 --> 00:21:46,320
I think this is what approach like so we

363
00:21:46,320 --> 00:21:49,350
experimented a bit with with probe tips

364
00:21:49,350 --> 00:21:53,679
I we are now look for using the most
left one so it's a for rights

365
00:21:53,679 --> 00:21:58,500
a with a1 loop coral around it

366
00:21:58,500 --> 00:22:01,900
and that this where the current is
discharged through and

367
00:22:01,900 --> 00:22:05,980
you have to think in the order of 5200
amp

368
00:22:05,980 --> 00:22:12,980
but very short so like to attend 20
nanosecond pulses

369
00:22:13,730 --> 00:22:17,490
um yeah because it was all the deciding
or I would have a camera so I

370
00:22:17,490 --> 00:22:21,100
at a small video with it well actually I
think I can show it like this

371
00:22:21,100 --> 00:22:28,100
maybe I the camera can be turned on done

372
00:22:28,669 --> 00:22:31,820
over both at the same time please

373
00:22:31,820 --> 00:22:35,539
because then I can show on the other
screen

374
00:22:35,539 --> 00:22:38,740
see if that works

375
00:22:38,740 --> 00:22:42,610
this offer

376
00:22:42,610 --> 00:22:47,260
want to move where is it

377
00:22:47,260 --> 00:22:50,710
ok so this is to control to

378
00:22:50,710 --> 00:22:55,169
and what I will for sho let's see

379
00:22:55,169 --> 00:22:59,110
you see here okay so it's a bit
difficult to see

380
00:22:59,110 --> 00:23:03,950
gets so basically system

381
00:23:03,950 --> 00:23:07,390
you can see the tip year

382
00:23:07,390 --> 00:23:13,960
your there so this is a tip and I can
move it

383
00:23:13,960 --> 00:23:17,000
like this so now it's next to it and now
it's on on top of the chip

384
00:23:17,000 --> 00:23:20,750
so basically I will start next to it so
you can see what it does when

385
00:23:20,750 --> 00:23:24,750
everything is good

386
00:23:24,750 --> 00:23:28,820
basically I have some control so far but
everything is prepared

387
00:23:28,820 --> 00:23:33,980
showed up we have some settings here
where we can say

388
00:23:33,980 --> 00:23:37,669
to there so we can say how many tries
you wanna do we can say

389
00:23:37,669 --> 00:23:41,450
what offset s actually I think it needs
to be

390
00:23:41,450 --> 00:23:44,970
this 74 I

391
00:23:44,970 --> 00:23:48,549
like this doesn't matter and I can
install some

392
00:23:48,549 --> 00:23:53,130
configure some power of people's
basically if I ran out

393
00:23:53,130 --> 00:23:56,460
of would think demo

394
00:23:56,460 --> 00:24:02,559
broken wires

395
00:24:02,559 --> 00:24:05,620
day

396
00:24:05,620 --> 00:24:08,860
see know I've to

397
00:24:08,860 --> 00:24:12,500
there there

398
00:24:12,500 --> 00:24:18,090
there

399
00:24:18,090 --> 00:24:19,390
verified no

400
00:24:19,390 --> 00:24:26,330
this is gone okay

401
00:24:26,330 --> 00:24:27,769
up

402
00:24:27,769 --> 00:24:30,970
so basically what you're saying I'm in
secure booting

403
00:24:30,970 --> 00:24:35,539
it shown as green so I have another
caller if something else happens

404
00:24:35,539 --> 00:24:38,539
so I will stop this for a moment

405
00:24:38,539 --> 00:24:41,559
because now I need to

406
00:24:41,559 --> 00:24:45,379
coordinated a bit with moving that
targets

407
00:24:45,379 --> 00:24:52,379
on the time

408
00:24:53,950 --> 00:24:59,330
now I put the tip over to chip and I we
see things happening

409
00:24:59,330 --> 00:25:04,389
so depending on the position you know
I'm going almost gone

410
00:25:04,389 --> 00:25:08,029
all the time secure boot let's go so
this is this the

411
00:25:08,029 --> 00:25:11,690
the other if statement right if I put
into

412
00:25:11,690 --> 00:25:15,609
the way you will see degree once again
sometimes you

413
00:25:15,609 --> 00:25:19,340
we'll see yellows which means crash

414
00:25:19,340 --> 00:25:22,899
action not too many I

415
00:25:22,899 --> 00:25:26,580
yeah so now it resets soda this means no
to the position where

416
00:25:26,580 --> 00:25:30,830
the the waves burned to do something
that the device is completely crushing

417
00:25:30,830 --> 00:25:31,729
so

418
00:25:31,729 --> 00:25:37,700
disposition dependent but it's also not
too bad that I can still do it manually

419
00:25:37,700 --> 00:25:41,529
air in in our testing we see that for
certain chips we

420
00:25:41,529 --> 00:25:45,039
you really wanna lie almost micrometer
step sizes so

421
00:25:45,039 --> 00:25:48,690
it can be very sensitive depending on
the skill to chip this is a

422
00:25:48,690 --> 00:25:49,599
microcontroller

423
00:25:49,599 --> 00:25:54,479
things typically are a bit easier so

424
00:25:54,479 --> 00:25:58,440
so this works I'll to if you a little
bit of a idea

425
00:25:58,440 --> 00:26:02,149
about the sensitivity

426
00:26:02,149 --> 00:26:06,739
I can at to this

427
00:26:06,739 --> 00:26:09,999
so I seventy I'm go

428
00:26:09,999 --> 00:26:12,999
of shut off to the greater than the sum
ni

429
00:26:12,999 --> 00:26:16,589
for 90 seconds since some event arm

430
00:26:16,589 --> 00:26:21,229
but we sought to statements were you
happy red arrow at the bowling if

431
00:26:21,229 --> 00:26:24,559
but we also have the I the while loop

432
00:26:24,559 --> 00:26:29,269
at the end so now I'm moving a glitch to
do while loop

433
00:26:29,269 --> 00:26:32,759
so I know that

434
00:26:32,759 --> 00:26:36,529
roughly should be something like was it

435
00:26:36,529 --> 00:26:39,960
maybe I'm not confused 3

436
00:26:39,960 --> 00:26:44,849
8 78 I think so

437
00:26:44,849 --> 00:26:49,989
so something like three minutes seconds
later so in time quite a bit later

438
00:26:49,989 --> 00:26:54,219
on toggle this she would assess

439
00:26:54,219 --> 00:26:58,059
I order or so now we see something that
says

440
00:26:58,059 --> 00:27:02,899
insecure booting but let's go so

441
00:27:02,899 --> 00:27:07,239
again if I move it around so are their
scenario where trees and stuff

442
00:27:07,239 --> 00:27:11,669
so again depending on the place it's
more sensitive but now we r glitching

443
00:27:11,669 --> 00:27:12,399
another point

444
00:27:12,399 --> 00:27:17,289
so you see that in Cote you will have to
cover multiple points

445
00:27:17,289 --> 00:27:20,970
I to prevent this kind of attack so if
you're

446
00:27:20,970 --> 00:27:24,649
if you're go to sensitive to a certain
fault at some place

447
00:27:24,649 --> 00:27:29,509
they may from countermeasure but you
still have to have all the places

448
00:27:29,509 --> 00:27:33,029
government that this might go and
actually use

449
00:27:33,029 --> 00:27:36,609
hard work is smartcard business this is

450
00:27:36,609 --> 00:27:40,039
arm default but you have to do this

451
00:27:40,039 --> 00:27:44,109
because defy stretching is something is
very difficult physically to protect

452
00:27:44,109 --> 00:27:44,609
against

453
00:27:44,609 --> 00:27:47,830
so developer since marquardt area

454
00:27:47,830 --> 00:27:53,679
all are doing mitigation a fault
injection and have a focus on how to

455
00:27:53,679 --> 00:27:57,399
okay

456
00:27:57,399 --> 00:28:02,009
I think that was my demo much

457
00:28:02,009 --> 00:28:05,239
switch back to this slights that is like
this

458
00:28:05,239 --> 00:28:08,909
up so the video can also go

459
00:28:08,909 --> 00:28:12,539
so

460
00:28:12,539 --> 00:28:16,129
going back quickly to the coats we saw

461
00:28:16,129 --> 00:28:19,179
so first we saw I

462
00:28:19,179 --> 00:28:23,059
secure booting I am after glitch

463
00:28:23,059 --> 00:28:27,009
so normally green was executing resource
secure booting out a glitch

464
00:28:27,009 --> 00:28:31,509
I later we saw in secure booting and
then let's go so that meant to be glitch

465
00:28:31,509 --> 00:28:32,399
the wind up

466
00:28:32,399 --> 00:28:35,779
but you can't individually target
different functions

467
00:28:35,779 --> 00:28:40,089
so you can imagine that that boldest
five-fold

468
00:28:40,089 --> 00:28:43,399
and attacks for people that have
physical access to your target

469
00:28:43,399 --> 00:28:47,549
for a secure would function is a is a
risk

470
00:28:47,549 --> 00:28:50,820
a like I said it doesn't get your
persistence

471
00:28:50,820 --> 00:28:55,339
but it still a allows you to have a
stepping stone for further attacks

472
00:28:55,339 --> 00:28:59,200
or it might allow it to stew key
material

473
00:28:59,200 --> 00:29:04,579
that that would be persistent okay

474
00:29:04,579 --> 00:29:07,960
well we're not there yet look logical

475
00:29:07,960 --> 00:29:10,970
so we have more II 30 all you know
better

476
00:29:10,970 --> 00:29:13,989
so I am these are mistakes well

477
00:29:13,989 --> 00:29:17,559
disarms takes a bit of a we've category
because of course you can put many of

478
00:29:17,559 --> 00:29:19,829
the other things I mentioned as these
are mistakes so

479
00:29:19,829 --> 00:29:24,359
what do I try to say here arm things
that seem to be

480
00:29:24,359 --> 00:29:28,169
yeah from my certain intentional point a
few

481
00:29:28,169 --> 00:29:33,200
I have a purpose sometimes you don't
know exactly but we see things like

482
00:29:33,200 --> 00:29:36,769
to an empty signature is accepted as a
good signature or

483
00:29:36,769 --> 00:29:41,720
having a flack that just allows you to
boot without the signature

484
00:29:41,720 --> 00:29:45,070
now you don't you wonder why do you put
this in the system

485
00:29:45,070 --> 00:29:49,309
if you have such a future I one that I
find very a.m.

486
00:29:49,309 --> 00:29:52,599
in the stiffest the one that the early I
from that

487
00:29:52,599 --> 00:29:56,749
so the early iPhone would get firmware
with a signature

488
00:29:56,749 --> 00:29:59,889
with checked the signature than opiate

489
00:29:59,889 --> 00:30:03,979
with out a signature into its internal
memory throat singer way

490
00:30:03,979 --> 00:30:07,229
and never check it again because it was
gone arm

491
00:30:07,229 --> 00:30:10,889
well you can only do that if you're a
pitcher coating your Moscow wrong or

492
00:30:10,889 --> 00:30:12,029
something like that

493
00:30:12,029 --> 00:30:15,690
something you are really really I trust
you cannot change but a

494
00:30:15,690 --> 00:30:19,479
put it in a more flesh which in the and
source changeable through

495
00:30:19,479 --> 00:30:23,069
mold always arm which is clearly the
same mistake

496
00:30:23,069 --> 00:30:27,720
it's something that someone for no
assumptions made or something

497
00:30:27,720 --> 00:30:30,889
so you really need some if you design
level

498
00:30:30,889 --> 00:30:34,799
already if you make something like this

499
00:30:34,799 --> 00:30:37,869
um not so much a flaw

500
00:30:37,869 --> 00:30:42,960
but something that we see I does have
some value

501
00:30:42,960 --> 00:30:46,029
for I want yeah delaying

502
00:30:46,029 --> 00:30:49,999
or or no not unnecessarily

503
00:30:49,999 --> 00:30:53,789
a exposing now things are done

504
00:30:53,789 --> 00:30:57,479
a and that is hiding the the room croat
so

505
00:30:57,479 --> 00:31:01,069
a if you do not have the Rome accessible

506
00:31:01,069 --> 00:31:04,269
for scrutiny it does the UAE attackers

507
00:31:04,269 --> 00:31:08,629
and in certain markets this may matter
so of course it's always a matter of

508
00:31:08,629 --> 00:31:10,229
what this the time till

509
00:31:10,229 --> 00:31:13,679
the next release or the next a product
cycle

510
00:31:13,679 --> 00:31:16,700
we see that mobile phone cycles go
pretty quickly

511
00:31:16,700 --> 00:31:19,739
so so maybe making this hard

512
00:31:19,739 --> 00:31:23,690
will you know be sufficient for certain

513
00:31:23,690 --> 00:31:28,940
type of products

514
00:31:28,940 --> 00:31:34,440
its it's not really something that is a
flaw in itself

515
00:31:34,440 --> 00:31:39,489
from another one a ser crypto sanitation
I'm cleaning up after use

516
00:31:39,489 --> 00:31:42,609
I the the thing is

517
00:31:42,609 --> 00:31:47,519
that we see crypto being used of course
for signature verification which you

518
00:31:47,519 --> 00:31:48,749
sometimes

519
00:31:48,749 --> 00:31:52,269
NH mickey arm but we also see to

520
00:31:52,269 --> 00:31:55,409
bootloaders being cryptids and being
dick rutan

521
00:31:55,409 --> 00:31:59,479
on startup of the system and then later
crypto engine is still our

522
00:31:59,479 --> 00:32:03,399
available to low-level called low
privileged

523
00:32:03,399 --> 00:32:07,069
called if you still have your key in the
key register you can still keep on the

524
00:32:07,069 --> 00:32:09,339
crippling more interesting with that
engine

525
00:32:09,339 --> 00:32:15,659
so I duct cleaning up your piece after
you use to miss something that but most

526
00:32:15,659 --> 00:32:20,479
no implementation do not do

527
00:32:20,479 --> 00:32:25,470
I am well for america rates I also
always a an interesting area of

528
00:32:25,470 --> 00:32:29,479
from exploration a

529
00:32:29,479 --> 00:32:32,889
in the end if you have an update or E if
you have two original quote it shouldn't

530
00:32:32,889 --> 00:32:33,499
matter

531
00:32:33,499 --> 00:32:37,869
its the signed coat you need to sign
checked signature and you need to

532
00:32:37,869 --> 00:32:40,679
make sure that you don't execute
anything that was not signed it doesn't

533
00:32:40,679 --> 00:32:42,549
matter where it comes from

534
00:32:42,549 --> 00:32:46,200
so you should worry about the mechanisms
that you implement to

535
00:32:46,200 --> 00:32:50,079
get that copy into your system because
that's where the floor SCO

536
00:32:50,079 --> 00:32:56,460
I'm parsing the Hatters hoping it over
other stuff that's already there

537
00:32:56,460 --> 00:32:59,710
but that is where the floors are and not
so much in fact that

538
00:32:59,710 --> 00:33:03,069
of course shouldn't make something that
accepts and sign for us or something but

539
00:33:03,069 --> 00:33:03,759
if you

540
00:33:03,759 --> 00:33:07,479
just use two principal for everything
they've got executed gets verified first

541
00:33:07,479 --> 00:33:08,509
and

542
00:33:08,509 --> 00:33:13,349
in itself it should not be much for her
although still a lot of our own and game

543
00:33:13,349 --> 00:33:13,999
systems

544
00:33:13,999 --> 00:33:17,739
had flaws in this in this area

545
00:33:17,739 --> 00:33:22,239
and things like rollback so you have of
law

546
00:33:22,239 --> 00:33:25,809
for once and people can eternally

547
00:33:25,809 --> 00:33:32,009
installed on your system to recover it

548
00:33:32,009 --> 00:33:35,159
relying on in for a fight got so arm

549
00:33:35,159 --> 00:33:41,279
yeah this is a bit of a a blow to assist
independent situation

550
00:33:41,279 --> 00:33:44,929
what sometimes happen to this up you
have

551
00:33:44,929 --> 00:33:48,849
a routine that the suffocation arce
signature verification

552
00:33:48,849 --> 00:33:52,419
and then it is copied to another place
in the system

553
00:33:52,419 --> 00:33:56,619
for Speed or four size reasons or for
privilege reasons

554
00:33:56,619 --> 00:33:59,619
it this corporate I and then you get the

555
00:33:59,619 --> 00:34:03,639
the problem that that copious maybe not
immutable anymore

556
00:34:03,639 --> 00:34:08,129
so you can change it an example this

557
00:34:08,129 --> 00:34:12,169
the did some some TV assumption TV

558
00:34:12,169 --> 00:34:16,220
I at their arce routine sitting in
memory

559
00:34:16,220 --> 00:34:20,619
and if you put an app on your TV it was
in the same memory space as this are as

560
00:34:20,619 --> 00:34:21,690
a routine

561
00:34:21,690 --> 00:34:24,869
so you could install

562
00:34:24,869 --> 00:34:29,069
rejects simple app when you're for %um
privileged

563
00:34:29,069 --> 00:34:31,690
but just because to memory special
school in protected it would just

564
00:34:31,690 --> 00:34:33,359
patched are same routine

565
00:34:33,359 --> 00:34:37,109
and then you would put in your USB stick
with the firmer great

566
00:34:37,109 --> 00:34:44,109
and all are as a second year was no
bombing

567
00:34:44,259 --> 00:34:47,960
up this is a bit similar to be earlier
you are

568
00:34:47,960 --> 00:34:51,029
thing I am like a surface

569
00:34:51,029 --> 00:34:55,399
feature here I mention more the fact
that you have

570
00:34:55,399 --> 00:34:59,380
this authentication problem so we put
the you work somewhere

571
00:34:59,380 --> 00:35:04,160
on a board or we have some way to to do
servicing to it defies

572
00:35:04,160 --> 00:35:07,980
I we realize that we don't want everyone
to do it but now we r

573
00:35:07,980 --> 00:35:13,180
we want or syndication how do we do this
and it's actually a challenge

574
00:35:13,180 --> 00:35:18,150
for instance cable so easy to use again

575
00:35:18,150 --> 00:35:21,900
almost all of them work with a fixed
magic password

576
00:35:21,900 --> 00:35:25,809
and out what the people do that so these
cables as they gather

577
00:35:25,809 --> 00:35:30,500
official you know ratio or whatever and
a

578
00:35:30,500 --> 00:35:33,520
get those surfing equipment they got the
magic

579
00:35:33,520 --> 00:35:37,549
out of that equipment they stored at in
a cable

580
00:35:37,549 --> 00:35:40,700
height at themselves because that is
their business model so you

581
00:35:40,700 --> 00:35:44,049
still you don't have to break the cable
to get that key

582
00:35:44,049 --> 00:35:48,290
but but the cables now able to talk to
you issue

583
00:35:48,290 --> 00:35:51,579
why is it like this because it is really
complicated to make this a dynamic

584
00:35:51,579 --> 00:35:54,089
authentication protocol

585
00:35:54,089 --> 00:35:57,109
of course there are better
authentication protocols developed the

586
00:35:57,109 --> 00:35:57,480
last

587
00:35:57,480 --> 00:36:01,089
your five ten years but arm still

588
00:36:01,089 --> 00:36:05,559
not having the like an online
possibility which is for a garage shop

589
00:36:05,559 --> 00:36:08,809
not very uncommon situation makes it not
that

590
00:36:08,809 --> 00:36:12,259
trivial to authenticate security and
also make it

591
00:36:12,259 --> 00:36:15,880
you know easily distribute borough all
over the place

592
00:36:15,880 --> 00:36:20,359
but this happen sir still a lot

593
00:36:20,359 --> 00:36:26,450
stay terrorists so I am

594
00:36:26,450 --> 00:36:29,970
in itself a your during secure boot
execution

595
00:36:29,970 --> 00:36:33,259
there's not that much space to
manipulate States

596
00:36:33,259 --> 00:36:36,720
but with the introduction of suspend
resume

597
00:36:36,720 --> 00:36:40,099
I am quite a few more possibilities of

598
00:36:40,099 --> 00:36:44,540
come across because as soon as you
suspend the system

599
00:36:44,540 --> 00:36:49,049
huh excuse me you need to suspend summer

600
00:36:49,049 --> 00:36:52,989
and then when you resume I your what are
you gonna trust

601
00:36:52,989 --> 00:36:57,520
what what this that the state that was
no preserved or what

602
00:36:57,520 --> 00:37:02,200
what i can. can use to reboot or restart
my machine

603
00:37:02,200 --> 00:37:05,470
I'm and anything in between

604
00:37:05,470 --> 00:37:09,529
from youn needs to be suspect and for
designers is

605
00:37:09,529 --> 00:37:13,130
quite a challenge because typically
don't trust everything

606
00:37:13,130 --> 00:37:17,630
that they wrote so you see quite a bit
of

607
00:37:17,630 --> 00:37:21,849
flaws in this area I'm Park

608
00:37:21,849 --> 00:37:25,079
need some water you can look at the
screen

609
00:37:25,079 --> 00:37:28,079
because it to some

610
00:37:28,079 --> 00:37:31,799
its alt 2003 I am

611
00:37:31,799 --> 00:37:36,619
I also back in a box a in October and I
realized I spoke there 10 years ago and

612
00:37:36,619 --> 00:37:37,770
I didn't remember what

613
00:37:37,770 --> 00:37:41,220
I googled my own slights and I thank you

614
00:37:41,220 --> 00:37:45,200
notice with thank you very much

615
00:37:45,200 --> 00:37:48,540
and I came across this life and i felt 0
secure boot

616
00:37:48,540 --> 00:37:53,069
I'm this whilst XD a I'm not sure if you
remember it was the first

617
00:37:53,069 --> 00:37:57,089
PDA phone mates by HTC you think a post

618
00:37:57,089 --> 00:38:00,630
their first device or something like
that arm

619
00:38:00,630 --> 00:38:05,970
and what you see here it was a a patch
low-tar so this went on our

620
00:38:05,970 --> 00:38:09,829
I'm sure you many more what kinda card
CF card or SD card

621
00:38:09,829 --> 00:38:14,130
and when you suspended the device when
it booted again

622
00:38:14,130 --> 00:38:17,839
it would look rat what this uncertainty
my my

623
00:38:17,839 --> 00:38:21,109
UMC or and CEO slot

624
00:38:21,109 --> 00:38:24,540
and if there's a magic gonna magic

625
00:38:24,540 --> 00:38:28,440
it would execute whatever was on that
stick

626
00:38:28,440 --> 00:38:32,059
so what we mate was something to

627
00:38:32,059 --> 00:38:36,470
a deactivated lock password sorry for
looking vice

628
00:38:36,470 --> 00:38:39,619
you can again in you suspended if I
should put this in

629
00:38:39,619 --> 00:38:43,690
you put this you disabled passwords
spent again

630
00:38:43,690 --> 00:38:47,069
booted and the UN and you could britt

631
00:38:47,069 --> 00:38:50,259
turn it back also because it was just a
bit just set

632
00:38:50,259 --> 00:38:53,339
battered active or not act if you didn't
even have to know your password or a

633
00:38:53,339 --> 00:38:54,200
raise it

634
00:38:54,200 --> 00:38:58,680
we just no chocolate very convenient way

635
00:38:58,680 --> 00:39:03,859
the grand up but it shows that the
typical title state purse tote ten years

636
00:39:03,859 --> 00:39:04,989
ago there were there

637
00:39:04,989 --> 00:39:11,520
they're still here

638
00:39:11,520 --> 00:39:14,559
well attack surface I'm driverz

639
00:39:14,559 --> 00:39:17,670
so drive devices these days boot

640
00:39:17,670 --> 00:39:21,730
about everything I'm more and more

641
00:39:21,730 --> 00:39:25,299
let's say peripherals are showing up

642
00:39:25,299 --> 00:39:28,619
and it is actually a competitive future
for

643
00:39:28,619 --> 00:39:33,020
for to printers I can boot from more
sources than you can

644
00:39:33,020 --> 00:39:36,980
so you're more flexible in your better

645
00:39:36,980 --> 00:39:41,450
I am and of course the the problem issue
after partial these things

646
00:39:41,450 --> 00:39:45,279
at a very early stage booting making

647
00:39:45,279 --> 00:39:48,319
your boot stage bloated and

648
00:39:48,319 --> 00:39:53,569
more difficult to to audit and more
sensitive to flaws

649
00:39:53,569 --> 00:40:00,480
and there are many examples of things
are going

650
00:40:00,480 --> 00:40:05,250
okay I am again one that there's not
really a flaw

651
00:40:05,250 --> 00:40:08,380
and I you can you can see

652
00:40:08,380 --> 00:40:12,099
not their own maybe even advised that I
put somewhere else if this actually

653
00:40:12,099 --> 00:40:15,520
advising this kind of be a sure so it's
a bit difficult to say

654
00:40:15,520 --> 00:40:19,859
what is right and wrong but I think it
is good to

655
00:40:19,859 --> 00:40:24,559
I keep in mind that the East mechanisms

656
00:40:24,559 --> 00:40:28,569
are powerful and multiple ways i'm
wrong. patching is sorry

657
00:40:28,569 --> 00:40:32,009
is a method to be able to patch reports
in the field

658
00:40:32,009 --> 00:40:36,270
its use by smart card slot I if there's
a flaw

659
00:40:36,270 --> 00:40:41,680
so swapping a smart card basis is
expensive so it's much more attractive

660
00:40:41,680 --> 00:40:44,920
if you can do a patch in the field

661
00:40:44,920 --> 00:40:49,989
I'm so how's it implemented well Europe
your own coat which is pretty static

662
00:40:49,989 --> 00:40:53,589
but instead of done calling directly
your functions in your home

663
00:40:53,589 --> 00:40:57,380
directly from from all over the place
you put a table in

664
00:40:57,380 --> 00:41:01,369
RAM Korean flash or something neutral

665
00:41:01,369 --> 00:41:04,410
and your room just James they're always

666
00:41:04,410 --> 00:41:07,839
and then there's the front reporter two
points back into the wrong

667
00:41:07,839 --> 00:41:11,119
that this too cold now won something
goes wrong in your own

668
00:41:11,119 --> 00:41:14,130
you up a function you change 2.3 not

669
00:41:14,130 --> 00:41:17,789
neutral place to something that is to
patch

670
00:41:17,789 --> 00:41:20,739
and then your French inspections can
even come back into the original quote

671
00:41:20,739 --> 00:41:21,109
so

672
00:41:21,109 --> 00:41:24,890
it's a ser fairly efficient way to pack
something

673
00:41:24,890 --> 00:41:28,190
of course if if you're almost jumping
all over the place into something is

674
00:41:28,190 --> 00:41:28,989
mutable

675
00:41:28,989 --> 00:41:32,809
it's not the Roman more from origin
point of view

676
00:41:32,809 --> 00:41:37,130
it's becoming usable and that is where
an attacker can also make a persistent

677
00:41:37,130 --> 00:41:37,829
change

678
00:41:37,829 --> 00:41:41,900
to use a cute bow secure boot saw

679
00:41:41,900 --> 00:41:45,270
and so very understandable that the
futures there I mean

680
00:41:45,270 --> 00:41:49,299
all about market and business and
staying alive

681
00:41:49,299 --> 00:41:53,500
I am also if you want to have one
function

682
00:41:53,500 --> 00:41:56,910
that is used let's say we have a
signature verification function in Rome

683
00:41:56,910 --> 00:42:01,150
that we trust it's also very nice if we
can use it for more so for

684
00:42:01,150 --> 00:42:04,660
later so you'll also see a lot of so for
jumping back

685
00:42:04,660 --> 00:42:08,079
into a rum to have one function that
does all the second-ever

686
00:42:08,079 --> 00:42:12,290
station which is a strong thing you
don't really implement you know make

687
00:42:12,290 --> 00:42:16,079
mistakes in the search third load order
to do to make it first two

688
00:42:16,079 --> 00:42:19,489
I am but again you need a similar
construct like this you need a pointer

689
00:42:19,489 --> 00:42:20,119
tabled

690
00:42:20,119 --> 00:42:24,779
Johnson Europe so it's important to

691
00:42:24,779 --> 00:42:28,270
thing to keep in mind ok ghetto here

692
00:42:28,270 --> 00:42:31,829
click away okay well

693
00:42:31,829 --> 00:42:34,930
for to go I decryption it's not

694
00:42:34,930 --> 00:42:38,710
authentication I'm

695
00:42:38,710 --> 00:42:41,980
well it happens so a

696
00:42:41,980 --> 00:42:46,349
yeah people think well I am credited it
is Mikey

697
00:42:46,349 --> 00:42:49,509
I'm the only one that can be created if
I can the cryptids

698
00:42:49,509 --> 00:42:53,210
I on the key it's my coat so I just
indicated

699
00:42:53,210 --> 00:42:57,250
I am but of course a there are ways to
change

700
00:42:57,250 --> 00:43:01,599
encrypt it goat I'm and if you don't
verified at that was changed and you

701
00:43:01,599 --> 00:43:02,569
won't see it

702
00:43:02,569 --> 00:43:05,630
and if I can make changes that still
need

703
00:43:05,630 --> 00:43:10,099
are meaningful even though I cannot see
it rite II something is the crib but I

704
00:43:10,099 --> 00:43:12,989
flip something and then it's the crypt
at OCBC

705
00:43:12,989 --> 00:43:17,359
will X or some of my changes with us
from the Crypt content

706
00:43:17,359 --> 00:43:21,210
so I can flip bets I an example are

707
00:43:21,210 --> 00:43:24,819
also from the same there's some calls
reach long ago

708
00:43:24,819 --> 00:43:29,819
I was the second stage loader and unlock
your phone that was encrypt it

709
00:43:29,819 --> 00:43:34,170
but not signed and they made effectual
not to load

710
00:43:34,170 --> 00:43:38,279
an arbitrary so did a patch out the
signature verification of bankrupted

711
00:43:38,279 --> 00:43:39,180
loader

712
00:43:39,180 --> 00:43:42,710
by just to buy change

713
00:43:42,710 --> 00:43:46,609
so always through separate verification

714
00:43:46,609 --> 00:43:50,529
not only the corruption

715
00:43:50,529 --> 00:43:53,609
um inappropriate signing

716
00:43:53,609 --> 00:43:57,810
carry out its a bit well maybe I should
have known this differently because

717
00:43:57,810 --> 00:43:59,009
there are multiple things at

718
00:43:59,009 --> 00:44:03,180
that play a role here the main thing is
of course

719
00:44:03,180 --> 00:44:07,529
do not use information I was not signs

720
00:44:07,529 --> 00:44:11,549
because well someone might have changed

721
00:44:11,549 --> 00:44:14,609
it sounds obvious it happens a lot I

722
00:44:14,609 --> 00:44:18,170
why doesn't happen a lot and I think
that this may be a slightly

723
00:44:18,170 --> 00:44:22,449
no adjacent to this is that

724
00:44:22,449 --> 00:44:26,730
want to piss you need to load your coat
somewhere internally and unfair if I

725
00:44:26,730 --> 00:44:31,239
and then execute because otherwise you
have to stretch bus attack

726
00:44:31,239 --> 00:44:34,949
but if I need to copy something before I
try to fight it

727
00:44:34,949 --> 00:44:38,029
they now do i know i big it is without

728
00:44:38,029 --> 00:44:41,529
checking Lancs does not verified yet

729
00:44:41,529 --> 00:44:44,829
so there's this little bit of a check
chicken-and-egg problem

730
00:44:44,829 --> 00:44:48,549
most vendors do with this by having
fixed length

731
00:44:48,549 --> 00:44:51,949
first loaders but then at

732
00:44:51,949 --> 00:44:55,500
at some point to get to introduce this
poll you you have to load something the

733
00:44:55,500 --> 00:44:56,449
size is there

734
00:44:56,449 --> 00:45:01,009
but it is not verified yet because
you're copping it before you for a fight

735
00:45:01,009 --> 00:45:04,180
arm well the examples here

736
00:45:04,180 --> 00:45:08,640
the blue from secure boot floor and some
some

737
00:45:08,640 --> 00:45:12,449
gonna kiss for an iPhone and also a
similar one

738
00:45:12,449 --> 00:45:17,730
so it happens

739
00:45:17,730 --> 00:45:21,339
key management arm

740
00:45:21,339 --> 00:45:25,969
if you sign things baby come for a
refillable

741
00:45:25,969 --> 00:45:30,509
from so if you are for a production
bootloader did this for secure boot

742
00:45:30,509 --> 00:45:33,560
and that checks the next one and the
next one

743
00:45:33,560 --> 00:45:37,150
that is a very valuable thing if you can
sign

744
00:45:37,150 --> 00:45:40,339
a development bootloader does not

745
00:45:40,339 --> 00:45:44,380
checked the next thing in an extreme but
just loaded and executed

746
00:45:44,380 --> 00:45:47,819
arm that's pretty bad

747
00:45:47,819 --> 00:45:51,699
I so why do you use that same key

748
00:45:51,699 --> 00:45:55,369
40s development loader 74 the production
lows

749
00:45:55,369 --> 00:45:59,940
0 as soon as you start using a key for
development you cannot use it anymore

750
00:45:59,940 --> 00:46:02,000
for production you need to make a

751
00:46:02,000 --> 00:46:05,259
key management so you basically from the
first key

752
00:46:05,259 --> 00:46:08,719
to generate you need to have a policy of
how are you gonna Houston

753
00:46:08,719 --> 00:46:12,750
where you can store demand how long will
they live and

754
00:46:12,750 --> 00:46:16,190
typically people just make open SSL
Genki

755
00:46:16,190 --> 00:46:19,279
ICICI practice you sip

756
00:46:19,279 --> 00:46:23,569
that happens a lot out so arm

757
00:46:23,569 --> 00:46:26,589
well did this happened in the field we
also saw 100 this

758
00:46:26,589 --> 00:46:31,329
I think he was revealed to in the
meantime

759
00:46:31,329 --> 00:46:34,329
and a lot less on this is still the it
wasn't cold

760
00:46:34,329 --> 00:46:38,199
epic feel for nothing I think this is so
for me I one of the nicest

761
00:46:38,199 --> 00:46:41,980
out so this was also at Sushi

762
00:46:41,980 --> 00:46:46,339
a disclosed the ICU script or use it

763
00:46:46,339 --> 00:46:50,310
the right way but that's basically what
it's about used

764
00:46:50,310 --> 00:46:55,400
not around numbers should refuse to run
them

765
00:46:55,400 --> 00:46:59,960
got there there are more mistakes you
can make IRS as: also houses history

766
00:46:59,960 --> 00:47:00,440
from

767
00:47:00,440 --> 00:47:04,960
a wrong petting low exponent

768
00:47:04,960 --> 00:47:08,489
that you could abuse so yeah

769
00:47:08,489 --> 00:47:11,910
and must ensure crypto before you sit
and people have

770
00:47:11,910 --> 00:47:16,150
reasons to always start using on a
crypto for some reason

771
00:47:16,150 --> 00:47:19,270
so you up no reasonable good crypto be
done

772
00:47:19,270 --> 00:47:22,670
ball know this is faster and to boot I
miss important so we need something

773
00:47:22,670 --> 00:47:23,640
faster so we

774
00:47:23,640 --> 00:47:26,910
take something shorter and or be changed

775
00:47:26,910 --> 00:47:31,380
to another protocol which might have
been developed occur

776
00:47:31,380 --> 00:47:35,040
and then we didn't understand the
details of that yet we knew our say but

777
00:47:35,040 --> 00:47:37,239
now we use a new one because it's faster
and we don't

778
00:47:37,239 --> 00:47:41,400
do due diligence to to really understand

779
00:47:41,400 --> 00:47:45,770
okay so well finally we got 21 arm

780
00:47:45,770 --> 00:47:48,930
so few parting thoughts sodium

781
00:47:48,930 --> 00:47:53,210
the the most difficult thing

782
00:47:53,210 --> 00:47:57,480
in a secure boot design because like
I've shown there are so many things to

783
00:47:57,480 --> 00:47:59,460
think about it's also very complex

784
00:47:59,460 --> 00:48:02,469
a functionality for system

785
00:48:02,469 --> 00:48:06,250
it not only brings up the system it also
has to update the system it also has to

786
00:48:06,250 --> 00:48:07,710
do suspend resume

787
00:48:07,710 --> 00:48:12,430
arm you really need to look at all these
aspects to know what to serve right

788
00:48:12,430 --> 00:48:13,190
solution

789
00:48:13,190 --> 00:48:16,890
do I need from patch tables or credit
card without

790
00:48:16,890 --> 00:48:21,299
do I need this depression at: present
always in my device or can I make a

791
00:48:21,299 --> 00:48:22,829
great later

792
00:48:22,829 --> 00:48:26,190
into in effect 3 where I installed my
sin beber

793
00:48:26,190 --> 00:48:29,849
for Shin then then I don't need to have
it in the field that might

794
00:48:29,849 --> 00:48:33,430
make a difference arm

795
00:48:33,430 --> 00:48:37,579
if you're really I security if you got
keys that are for payment or for other

796
00:48:37,579 --> 00:48:39,750
stuff done you really also need to take
to

797
00:48:39,750 --> 00:48:43,660
Kandahar for related to text so I not so
much you are tired

798
00:48:43,660 --> 00:48:46,859
Jaytech but also pitching and sargent

799
00:48:46,859 --> 00:48:50,299
I'm locally properties on principles

800
00:48:50,299 --> 00:48:54,710
go a long way arm during lessons from
the past

801
00:48:54,710 --> 00:48:57,750
and pay attention to detail

802
00:48:57,750 --> 00:49:01,829
that's not my social security number I
think I'm

803
00:49:01,829 --> 00:49:05,190
because our know who have you noticed
that there were no

804
00:49:05,190 --> 00:49:11,270
20 items

805
00:49:11,270 --> 00:49:16,690
actually there was only 19

806
00:49:16,690 --> 00:49:19,809
can happen but I split 12 I think along
the way

807
00:49:19,809 --> 00:49:24,520
I'm

808
00:49:24,520 --> 00:49:31,520
well and that concludes my presentation
so any any questions

809
00:49:38,049 --> 00:49:39,190
other questions

810
00:49:39,190 --> 00:49:46,190
at least the first row

811
00:49:48,019 --> 00:49:53,240
I yeah a we don't want you to do sports
writer I'm

812
00:49:53,240 --> 00:49:58,619
som I think it's fair to say that if you

813
00:49:58,619 --> 00:50:02,509
months picking up on the developer
versus

814
00:50:02,509 --> 00:50:05,970
with his production signing in similar
issues

815
00:50:05,970 --> 00:50:11,769
it's fair to say to the view if you open
your system

816
00:50:11,769 --> 00:50:15,730
a.m. in in one scenario for example
developer

817
00:50:15,730 --> 00:50:19,380
then it's really hard to keep it close
on the on the other

818
00:50:19,380 --> 00:50:22,650
them in that respect do you thing

819
00:50:22,650 --> 00:50:26,849
systems that are required to be opened

820
00:50:26,849 --> 00:50:30,460
in unthinking about I'm thinking we know
secure boot

821
00:50:30,460 --> 00:50:35,329
and um the at least German requirement
did to is bootloaders that allow you to

822
00:50:35,329 --> 00:50:36,160
boot Linux

823
00:50:36,160 --> 00:50:40,029
I am is dependable

824
00:50:40,029 --> 00:50:43,089
at all because your opinion

825
00:50:43,089 --> 00:50:46,109
basically have the same scenario enters
Thursday from

826
00:50:46,109 --> 00:50:50,099
attendants recently but this is the
relatively new problem

827
00:50:50,099 --> 00:50:54,769
a set of problems and what's what's your
gut feeling is dis dependable

828
00:50:54,769 --> 00:50:58,259
at all it's a good point so you aren't
at the start but I add a disclaimer

829
00:50:58,259 --> 00:50:59,049
about

830
00:50:59,049 --> 00:51:02,319
secure boot for Windows from work so but
it's a valid point

831
00:51:02,319 --> 00:51:05,910
and I'm have no but but is good that

832
00:51:05,910 --> 00:51:10,359
II not really thought about this but I
would say it is the same problem

833
00:51:10,359 --> 00:51:14,049
I'm in India and yeah

834
00:51:14,049 --> 00:51:18,329
you really want to know that the past to
a certain

835
00:51:18,329 --> 00:51:22,690
warned of so for has not been tampered
with and as soon as you can do that

836
00:51:22,690 --> 00:51:27,039
done all the integrity of the Russell
system falls and I'm

837
00:51:27,039 --> 00:51:30,730
I like I said in the beginning most of
these attacks

838
00:51:30,730 --> 00:51:34,009
a do not is returning to

839
00:51:34,009 --> 00:51:38,690
persistent attacks that depends on the
rest of the system but sometimes that

840
00:51:38,690 --> 00:51:39,119
this

841
00:51:39,119 --> 00:51:42,930
that is not don't need it if you look at
people made attacks

842
00:51:42,930 --> 00:51:46,130
where you just have something up runs
initially

843
00:51:46,130 --> 00:51:49,160
gets a fake basque region and just you
know

844
00:51:49,160 --> 00:51:54,269
lose your keys band and that is enough I
mean you have a copy of the disk because

845
00:51:54,269 --> 00:51:55,239
you took that also

846
00:51:55,239 --> 00:52:01,839
minutes now game over okay

847
00:52:01,839 --> 00:52:06,559
more questions okay so

848
00:52:06,559 --> 00:52:08,529
nope thank you very much raising stuff

