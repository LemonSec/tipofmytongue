1
00:00:03,160 --> 00:00:06,620
the ice are really on be here really
excited to

2
00:00:06,620 --> 00:00:10,639
talk to guys about this I'll I know my
title and give too much away

3
00:00:10,639 --> 00:00:14,040
but those are you got do followed sort
of the news and media

4
00:00:14,040 --> 00:00:17,540
I'll three billion dollar up refers to
the fact

5
00:00:17,540 --> 00:00:22,060
thats mister Zuckerberg I offered three
billion dollars to an application called

6
00:00:22,060 --> 00:00:22,650
snapshot

7
00:00:22,650 --> 00:00:27,300
I'm sure most you're worth it and they
surprised me to not down which

8
00:00:27,300 --> 00:00:30,609
well kinda was surprised from what
perspective anyway

9
00:00:30,609 --> 00:00:34,860
and so are we talking about the
publication another one basically run

10
00:00:34,860 --> 00:00:35,839
mobile messaging

11
00:00:35,839 --> 00:00:40,440
and I why there was so much money and
what we can do with them

12
00:00:40,440 --> 00:00:44,430
and do we need three billion dollars to

13
00:00:44,430 --> 00:00:49,390
Soto do our own things just a bit about
quick introduction

14
00:00:49,390 --> 00:00:53,309
i sat on my miles south from New Zealand
I work for a company called

15
00:00:53,309 --> 00:00:56,659
or information security and basically
the usual

16
00:00:56,659 --> 00:01:00,570
I penetration testing center consulting
about a research work

17
00:01:00,570 --> 00:01:04,059
and better things like that I'll

18
00:01:04,059 --> 00:01:07,710
this is yep gonna to reverse their
research costs tied 2-2

19
00:01:07,710 --> 00:01:12,189
conduct and I'll give you got boba re
background around why I chose our

20
00:01:12,189 --> 00:01:13,799
messaging applications and

21
00:01:13,799 --> 00:01:17,420
how talking about I am basically

22
00:01:17,420 --> 00:01:21,009
I went to cuba con on last year which is
the

23
00:01:21,009 --> 00:01:24,159
an equivalent conference but the New
Zealand wool

24
00:01:24,159 --> 00:01:29,049
not by covalent but it does the somewhat
things that are on security research

25
00:01:29,049 --> 00:01:32,579
and around yeah I'm basically

26
00:01:32,579 --> 00:01:36,969
financial information and at QB Connor
some really great stories some really

27
00:01:36,969 --> 00:01:39,289
I'm so inspirational speakers

28
00:01:39,289 --> 00:01:42,619
and and some stuff for inspired me and I
was like I really want to find out a

29
00:01:42,619 --> 00:01:45,140
little bit more about sounding research
it again

30
00:01:45,140 --> 00:01:49,640
vocal track and since then see what I
can do and I'm

31
00:01:49,640 --> 00:01:53,780
all around this time with you guys wanna
talk about the NSA about information

32
00:01:53,780 --> 00:01:54,679
leakage

33
00:01:54,679 --> 00:01:57,880
about privacy a lot of people focused
around so

34
00:01:57,880 --> 00:02:01,859
area there was like well you know how to
communicate privately

35
00:02:01,859 --> 00:02:05,210
on can we communicate privately I what
you know

36
00:02:05,210 --> 00:02:09,069
what happens what that they don't offer
the moment and I thought

37
00:02:09,069 --> 00:02:12,920
chant a friend of mine in Cali I said to
him you know other thing on what to look

38
00:02:12,920 --> 00:02:13,310
for

39
00:02:13,310 --> 00:02:17,110
companies my applications you know I'm
CC when they're about their all about

40
00:02:17,110 --> 00:02:18,000
sending messages

41
00:02:18,000 --> 00:02:21,870
and especially the ones that are talking
about today they're all about sending

42
00:02:21,870 --> 00:02:25,040
this this thing they call I'm ephemeral
messaging

43
00:02:25,040 --> 00:02:28,180
South things that disappear upbeat you
know

44
00:02:28,180 --> 00:02:31,739
they say your message is protected your
private data is protected and down

45
00:02:31,739 --> 00:02:32,840
hopefully should be safe

46
00:02:32,840 --> 00:02:37,180
and that my friend to run them to me
well what you wanna do this you know i

47
00:02:37,180 --> 00:02:37,890
mean they just

48
00:02:37,890 --> 00:02:41,120
using basic messaging services will
what's your idea

49
00:02:41,120 --> 00:02:44,180
what actually what way trying to achieve
I like well

50
00:02:44,180 --> 00:02:47,720
you know what was the reason why these
companies offering so much money

51
00:02:47,720 --> 00:02:51,409
I to these applications applications
sells the not very technically advanced

52
00:02:51,409 --> 00:02:54,830
that there are in fact on a few guys use
not that very much

53
00:02:54,830 --> 00:02:58,930
tend to be quite poorly designed that
just put together startup companies

54
00:02:58,930 --> 00:03:02,010
I mean baseball could build their own
messaging service in

55
00:03:02,010 --> 00:03:05,900
very very few weeks for fraction of the
price

56
00:03:05,900 --> 00:03:10,260
I'm so I was like well the you know that
offering the psych I'm guessing the

57
00:03:10,260 --> 00:03:13,409
offering the the sort of finances and
this this idea this on

58
00:03:13,409 --> 00:03:17,629
his office to these to these messaging
companies because not only by the

59
00:03:17,629 --> 00:03:18,299
application

60
00:03:18,299 --> 00:03:21,689
they want to buy the user base there
after the user's and

61
00:03:21,689 --> 00:03:25,450
especially with Mom profitable
applications like like snapshot

62
00:03:25,450 --> 00:03:30,159
I'm they're not to make a profit that's
all free there's no

63
00:03:30,159 --> 00:03:33,159
subscription model nothing like that the
only way to

64
00:03:33,159 --> 00:03:37,200
things look at possibly I guess Rica
nenu the costs that they

65
00:03:37,200 --> 00:03:41,069
of it would be for actually sending
messages to users advertising revenues

66
00:03:41,069 --> 00:03:42,299
so the usual thing to do

67
00:03:42,299 --> 00:03:47,209
on that that Facebook site anyway so
it's like well you know the great idea

68
00:03:47,209 --> 00:03:48,810
to see if we can do something similar

69
00:03:48,810 --> 00:03:52,730
but for free i'm happy beyond author
spent I'd love to just

70
00:03:52,730 --> 00:03:56,370
you notes the fuckin achieve the same
result but no money at all

71
00:03:56,370 --> 00:03:59,480
and my colleague turns around and says
to me well

72
00:03:59,480 --> 00:04:02,620
you know we gonna do you gonna some
naked pics the self everyone King

73
00:04:02,620 --> 00:04:06,180
you call the White Russian houses like
well maybe something a little more

74
00:04:06,180 --> 00:04:07,180
thought to look at the

75
00:04:07,180 --> 00:04:10,849
other more interesting so I am

76
00:04:10,849 --> 00:04:14,140
the goals were basically to try and
compare and contrast

77
00:04:14,140 --> 00:04:17,549
I to applications in this case on

78
00:04:17,549 --> 00:04:20,960
mentioned before one of the goals was to
determine that valium

79
00:04:20,960 --> 00:04:25,020
why they were so much and what are the
worst to 22 these these companies and

80
00:04:25,020 --> 00:04:25,710
I'm

81
00:04:25,710 --> 00:04:29,830
I so hope they won the reasons that
wanted something from a was well the way

82
00:04:29,830 --> 00:04:33,810
is based purely on the user's I think
the company's I just buying use

83
00:04:33,810 --> 00:04:38,460
and I think at the time the offer on the
money users that's not just three had

84
00:04:38,460 --> 00:04:42,640
turned out to be around forty-five
dollars the use of Facebook is willing

85
00:04:42,640 --> 00:04:43,300
to spend

86
00:04:43,300 --> 00:04:46,850
to purchase application and

87
00:04:46,850 --> 00:04:50,250
the other question with john travolta
that we deliver general messaging they'd

88
00:04:50,250 --> 00:04:51,020
love this

89
00:04:51,020 --> 00:04:54,650
the system that they claim to do up the
whole on structures based on

90
00:04:54,650 --> 00:04:58,060
way send a message to somebody and
disappears you can communiques

91
00:04:58,060 --> 00:05:01,680
with somebody send them naked pictures
what everyone said

92
00:05:01,680 --> 00:05:05,040
but hopefully they contemplate I think
dot

93
00:05:05,040 --> 00:05:09,010
in itself is a something impossible to
achieve

94
00:05:09,010 --> 00:05:12,620
and I'm sure many you just briefly
Google snapshots on

95
00:05:12,620 --> 00:05:17,930
on the Internet you'll find thousands
thousands a week sort of messages

96
00:05:17,930 --> 00:05:20,960
and basically the main question was do
we need to spend that much money to

97
00:05:20,960 --> 00:05:24,300
access this user base

98
00:05:24,300 --> 00:05:27,320
alright so talking number one not jack

99
00:05:27,320 --> 00:05:30,770
million to do this claims the thermal
messaging self-destructing messaging

100
00:05:30,770 --> 00:05:31,850
system

101
00:05:31,850 --> 00:05:34,850
and encrypts on you the data and

102
00:05:34,850 --> 00:05:39,150
in my humble opinion a huge overvalued
for what they were offered

103
00:05:39,150 --> 00:05:42,430
to the number two maybe somebody less
familiar with

104
00:05:42,430 --> 00:05:46,260
was weaker this is a sort of growing

105
00:05:46,260 --> 00:05:49,900
application it's picking up more
traction amongst the specially I'm

106
00:05:49,900 --> 00:05:53,400
you that our concerned about privacy

107
00:05:53,400 --> 00:05:56,820
on their website the claim the high
standards of military-grade encryption

108
00:05:56,820 --> 00:06:00,340
their USP is security they claim that

109
00:06:00,340 --> 00:06:03,370
that totally unbreakable and the
hospital and

110
00:06:03,370 --> 00:06:07,380
they tend to be in the news quite a lot
one of the things they offered was

111
00:06:07,380 --> 00:06:10,470
up two hundred thousand dollar bounty
that someone could

112
00:06:10,470 --> 00:06:14,510
I'm sort of compromise them in in any
way

113
00:06:14,510 --> 00:06:17,590
and one other interesting things to do
the deal of press releases and the talk

114
00:06:17,590 --> 00:06:18,110
about

115
00:06:18,110 --> 00:06:22,410
I'm the FBI apparently approached the
with the founder and ask them

116
00:06:22,410 --> 00:06:25,410
P please put in a battle for us I would
love to be able to access your

117
00:06:25,410 --> 00:06:28,060
application will conduit this is it's
too difficult

118
00:06:28,060 --> 00:06:30,890
and there were then and the press for
this press release the white no no no a

119
00:06:30,890 --> 00:06:31,700
conduit

120
00:06:31,700 --> 00:06:36,140
we value the price is too much the
mother happen

121
00:06:36,140 --> 00:06:40,810
so I'm as post-dispatch others and Alcoa
I later on I'm working group all day for

122
00:06:40,810 --> 00:06:43,080
everything transmits circle but the mean

123
00:06:43,080 --> 00:06:46,080
limbaugh's racial the higher but I get a
filthy

124
00:06:46,080 --> 00:06:51,700
just how much on as I mentioned both
these applications use army corruption

125
00:06:51,700 --> 00:06:53,290
and basically proprietary

126
00:06:53,290 --> 00:06:56,810
part of a to try and on high

127
00:06:56,810 --> 00:07:01,860
disguises obfuscates user data and
sometimes all data

128
00:07:01,860 --> 00:07:05,200
but I'm not trying to approach this

129
00:07:05,200 --> 00:07:09,760
from a normal attacking point de vue
non-league photography is used for

130
00:07:09,760 --> 00:07:10,820
things like this

131
00:07:10,820 --> 00:07:15,020
so you would have analysis and Paul
track communicated that to each other

132
00:07:15,020 --> 00:07:18,910
and across and on secure channel
productive would be employed my guess is

133
00:07:18,910 --> 00:07:19,440
I'll

134
00:07:19,440 --> 00:07:23,080
and basically is to stop Eve in the
middle been able to our

135
00:07:23,080 --> 00:07:28,050
gain access to the communication on this
is pretty fun the method I mean where

136
00:07:28,050 --> 00:07:30,490
time is HTTPS to solicit what we do

137
00:07:30,490 --> 00:07:34,030
I'm but this is not the point if you're
trying to come from on

138
00:07:34,030 --> 00:07:37,660
I'm trying to exploit exploit the
application from from within

139
00:07:37,660 --> 00:07:40,900
basically exploit the khatami fee they
use to

140
00:07:40,900 --> 00:07:44,090
on encrypt the data address its own
captive

141
00:07:44,090 --> 00:07:47,520
at the client as opposed to in transit
and

142
00:07:47,520 --> 00:07:51,950
looking for things like to the gym usage
data on you can't access other account

143
00:07:51,950 --> 00:07:54,080
thing haha how easy it is to do

144
00:07:54,080 --> 00:07:57,560
and will hopefully and again that
transcends the messages

145
00:07:57,560 --> 00:08:02,430
I'm access these magical users which
worth $45 dollars each

146
00:08:02,430 --> 00:08:05,840
and so we have a slightly different
model for the attack

147
00:08:05,840 --> 00:08:09,670
we have something that looks now like
this not so Alice in Wonderland

148
00:08:09,670 --> 00:08:12,750
and we have bobbin he on the other so
the client

149
00:08:12,750 --> 00:08:16,860
and the attacker and now the same thing
and in theory

150
00:08:16,860 --> 00:08:21,420
this is a.m. a very difficult thing to
protect because the client needs all the

151
00:08:21,420 --> 00:08:22,900
information to

152
00:08:22,900 --> 00:08:26,430
the crib the data it needs all the keys
and needs on everything be able to

153
00:08:26,430 --> 00:08:27,250
actually

154
00:08:27,250 --> 00:08:31,280
for the use it to you the client and
practice

155
00:08:31,280 --> 00:08:34,669
at basically like most other people try
and make it

156
00:08:34,669 --> 00:08:38,439
station be difficult for the attack it
you know how the client's

157
00:08:38,439 --> 00:08:42,279
to attack Alice in this case so

158
00:08:42,279 --> 00:08:45,310
that's the basic idea or trying to
achieve with this

159
00:08:45,310 --> 00:08:49,079
and the aim overall aim is to build no

160
00:08:49,079 --> 00:08:54,170
a stable client this is sort of their
overall aspect of how we can achieve the

161
00:08:54,170 --> 00:08:55,480
these things

162
00:08:55,480 --> 00:08:59,180
and the reason I think what it took me a
scaleable it just because

163
00:08:59,180 --> 00:09:03,269
we all know thats by default loading the
applications are vulnerable to do things

164
00:09:03,269 --> 00:09:05,670
like you generation we try to find out

165
00:09:05,670 --> 00:09:08,720
and and basic attacks but on

166
00:09:08,720 --> 00:09:11,509
the issue is that the client you know
only allowed to do certain things you

167
00:09:11,509 --> 00:09:13,439
can set their own mobile phone all day

168
00:09:13,439 --> 00:09:16,660
and Ryan Newman users but it's not a
viable method

169
00:09:16,660 --> 00:09:19,930
so we're trying to build their own
custom clients are trying to obtain

170
00:09:19,930 --> 00:09:22,300
customize control of the application

171
00:09:22,300 --> 00:09:26,170
interact with the server on we need to
be able to scale attack vectors to be

172
00:09:26,170 --> 00:09:26,850
able to

173
00:09:26,850 --> 00:09:30,149
make unreasonable in a way that we can
actually I'm

174
00:09:30,149 --> 00:09:33,889
say this is the reliability something
should be watching out for

175
00:09:33,889 --> 00:09:37,009
and looking to bypass any kansai
controls

176
00:09:37,009 --> 00:09:40,709
on things like signing I'm than actually

177
00:09:40,709 --> 00:09:45,500
I think but lockout mechanisms of an
accident by side on a mobile phone

178
00:09:45,500 --> 00:09:48,779
and to do this basic going to set up an
Android environment

179
00:09:48,779 --> 00:09:52,029
we to somehow why the original source
code or whatever

180
00:09:52,029 --> 00:09:56,449
close we can get to the source code
understand what love the application

181
00:09:56,449 --> 00:10:00,050
and after Wednesday on the workflow
tried to conceptualize some attack

182
00:10:00,050 --> 00:10:00,930
vectors

183
00:10:00,930 --> 00:10:04,129
and see where we can go with it on

184
00:10:04,129 --> 00:10:07,499
away on basic methodology that will go
through both applications

185
00:10:07,499 --> 00:10:10,769
are number ones of the update thing that
location

186
00:10:10,769 --> 00:10:15,259
and I'm on number two we're gonna look
at basically examining communication so

187
00:10:15,259 --> 00:10:16,480
from a web application

188
00:10:16,480 --> 00:10:19,519
on perspective the screw perspective
we're going to look at

189
00:10:19,519 --> 00:10:24,319
proxy and examine it examining it XOM
how to structure the code so we can see

190
00:10:24,319 --> 00:10:26,519
what the and what you doing so

191
00:10:26,519 --> 00:10:29,629
try to get that the source code or as
close to the source code as well as we

192
00:10:29,629 --> 00:10:31,850
can as I can manage

193
00:10:31,850 --> 00:10:35,829
reverse engineer hopefully the source
code on build a custom client at this

194
00:10:35,829 --> 00:10:36,790
point

195
00:10:36,790 --> 00:10:40,529
and then whatever explosive thought of
at the time create them

196
00:10:40,529 --> 00:10:43,999
and see if we get them to run so without
further ado

197
00:10:43,999 --> 00:10:47,420
on let's get right in talking first
about

198
00:10:47,420 --> 00:10:50,870
a snapshot on I won't be obtained the
data

199
00:10:50,870 --> 00:10:55,199
pretty v on obtained from a pic /a who
lost or stolen device

200
00:10:55,199 --> 00:10:59,800
what and later set up a proxy and
started an entropic workflow

201
00:10:59,800 --> 00:11:03,980
3 the chose that a get the Google story
as it's written in Java

202
00:11:03,980 --> 00:11:07,850
other personal John experience and
they're surprisingly easy the

203
00:11:07,850 --> 00:11:11,069
decompile and reverse so this is

204
00:11:11,069 --> 00:11:14,649
just a personal choice but something
could be done with the IKEA and I'm

205
00:11:14,649 --> 00:11:18,350
both applications actually do have a
multiplatform versions

206
00:11:18,350 --> 00:11:21,670
I'm but they both go to work in a
similar way

207
00:11:21,670 --> 00:11:27,220
okay it application acquired are not
uncommon communication and see how these

208
00:11:27,220 --> 00:11:29,509
applications actually talk how they
interact

209
00:11:29,509 --> 00:11:33,230
and I what we can do so um

210
00:11:33,230 --> 00:11:36,889
when we're examining that applications
what we're trying to do is basically

211
00:11:36,889 --> 00:11:39,100
look at certain time communications

212
00:11:39,100 --> 00:11:42,819
we're trying to do is take a stand that
web application approach

213
00:11:42,819 --> 00:11:47,029
so will look into prostitute for and
then we're looking to do things like

214
00:11:47,029 --> 00:11:50,410
book for basic flaws like in any weather
contest on broken

215
00:11:50,410 --> 00:11:55,220
I'm authentication and session fixation
would be the two major things

216
00:11:55,220 --> 00:11:59,319
the reason for this is a lot of web
applications already found the way how

217
00:11:59,319 --> 00:12:03,180
to properly handle these things we use
like cookies we secure channels

218
00:12:03,180 --> 00:12:06,509
but mobile applications still do things
their own way they take on

219
00:12:06,509 --> 00:12:09,529
had to have access to these these
cookies and have access

220
00:12:09,529 --> 00:12:13,339
to to set up this session data so each
application not

221
00:12:13,339 --> 00:12:16,499
you examine tends to handle sessions and
and its own unique way

222
00:12:16,499 --> 00:12:19,699
and this tends to be a lot of the time a
weak point for that particular

223
00:12:19,699 --> 00:12:22,459
application

224
00:12:22,459 --> 00:12:25,999
looking on briefly it's not shut like
any other

225
00:12:25,999 --> 00:12:29,459
application you're presented with the
login screen or finance green

226
00:12:29,459 --> 00:12:33,620
I all traffic is beautifully readable in
clear text so when the proxy the Android

227
00:12:33,620 --> 00:12:34,990
application

228
00:12:34,990 --> 00:12:38,749
we can just a look at what something
back and forth the server look at their

229
00:12:38,749 --> 00:12:40,089
responses

230
00:12:40,089 --> 00:12:44,980
are all requests reply this on RFQ
request open

231
00:12:44,980 --> 00:12:48,670
and the timestamp I'm was well attended
the requests

232
00:12:48,670 --> 00:12:51,920
but I guess this is though this is
basically the subtle way of creating

233
00:12:51,920 --> 00:12:53,059
their own session

234
00:12:53,059 --> 00:12:56,949
session cookies and I'm

235
00:12:56,949 --> 00:12:59,720
unsurprisingly a lot of very helpful
names when you start looking at these

236
00:12:59,720 --> 00:13:00,569
things

237
00:13:00,569 --> 00:13:04,139
things like on post at pH registered
user

238
00:13:04,139 --> 00:13:08,740
so all those requests go to I'm very
elaborate names but I really explain

239
00:13:08,740 --> 00:13:12,649
all responses well-armed plain text
chase on objects so we can see exactly

240
00:13:12,649 --> 00:13:14,470
what the something back and forth

241
00:13:14,470 --> 00:13:17,540
on but only use the messages so things
like sending

242
00:13:17,540 --> 00:13:22,559
I'm about photos sending messages he's
in supplication wrong cryptid

243
00:13:22,559 --> 00:13:25,899
though the heart to heart getting

244
00:13:25,899 --> 00:13:30,120
Arthur think stand up pretty quickly on
want to look at this request ok and how

245
00:13:30,120 --> 00:13:33,329
they do the custom corruption up a
confession management

246
00:13:33,329 --> 00:13:36,910
and what are the what do you think I one
of the things that is pretty quickly

247
00:13:36,910 --> 00:13:38,930
with the token always begins with some
kinda

248
00:13:38,930 --> 00:13:42,309
I'll 930 and at the beginning and then

249
00:13:42,309 --> 00:13:45,999
looks like a hash but is off kinda
variable-length

250
00:13:45,999 --> 00:13:50,999
I it's not a normal shot 256 or md5 hash
into two with Lancashire

251
00:13:50,999 --> 00:13:55,540
with this a 920 stop and it was a heart
surgeon leave that this that if that

252
00:13:55,540 --> 00:13:57,019
should happen so

253
00:13:57,019 --> 00:14:00,069
not gonna need interest rate away
thereafter the thing think by the time

254
00:14:00,069 --> 00:14:01,790
stamp and and other

255
00:14:01,790 --> 00:14:06,019
information is all jacked a client-side

256
00:14:06,019 --> 00:14:09,129
so it was time to get a better idea how
these things put together but

257
00:14:09,129 --> 00:14:12,730
generally I'm tried to avoid attacking
the

258
00:14:12,730 --> 00:14:15,869
the server at this point i win I'm
without permission to

259
00:14:15,869 --> 00:14:20,480
but stop I mean to begin with and we
want to be able to actually look at that

260
00:14:20,480 --> 00:14:22,569
clients are the post to try to

261
00:14:22,569 --> 00:14:26,910
sent a letter dated to the API and try
it I'm so

262
00:14:26,910 --> 00:14:30,550
so to proceed with this sort of attack
track we're going to

263
00:14:30,550 --> 00:14:34,240
go down to the next that and tried to
extract the code

264
00:14:34,240 --> 00:14:37,699
I get pretty easy to achieve with ATK's
really great what

265
00:14:37,699 --> 00:14:40,999
online tools to do that including
Android the compiler com

266
00:14:40,999 --> 00:14:45,430
yes literally I'm download a ticket from
Android uploaded to the website

267
00:14:45,430 --> 00:14:48,449
and why and returns a buncha Java code
for you

268
00:14:48,449 --> 00:14:52,910
all nicely laid out normally these are
quite successful unless some kind of the

269
00:14:52,910 --> 00:14:54,290
station is used

270
00:14:54,290 --> 00:14:57,550
and I'm there are a package that you
that a lot of

271
00:14:57,550 --> 00:15:00,499
sort of banking applications and
application to tend to use of this

272
00:15:00,499 --> 00:15:01,389
cation

273
00:15:01,389 --> 00:15:05,059
which makes very difficult to interpret
the code but lot going with this one

274
00:15:05,059 --> 00:15:09,329
very are usually very readable and
return sort of job over and Sue to Java

275
00:15:09,329 --> 00:15:10,139
code at

276
00:15:10,139 --> 00:15:13,449
tends to trip up around things like
switch statements things like that just

277
00:15:13,449 --> 00:15:14,180
because it

278
00:15:14,180 --> 00:15:18,839
it doesn't know haha quite interpreted

279
00:15:18,839 --> 00:15:22,269
so as I mentioned read the compoz may
need to arm

280
00:15:22,269 --> 00:15:26,480
normal really good code I'm snapshot had
really great naming conventions the hot

281
00:15:26,480 --> 00:15:28,279
folders called crypto

282
00:15:28,279 --> 00:15:32,679
they had I'm files and now all the cost
names were very helpful

283
00:15:32,679 --> 00:15:36,029
and it was we need to start getting too
slow to understand the application and

284
00:15:36,029 --> 00:15:37,819
work for a little bit more

285
00:15:37,819 --> 00:15:41,529
and basically we're trying to do the
trying to pick these

286
00:15:41,529 --> 00:15:45,209
on high-priority functions that wants to
look up by quickly

287
00:15:45,209 --> 00:15:48,689
when you the compile an Android
application you end up with a lot of

288
00:15:48,689 --> 00:15:49,649
goalies

289
00:15:49,649 --> 00:15:53,540
you up with a lot of I'm basically
information & Co that you only care

290
00:15:53,540 --> 00:15:54,519
about stuff that

291
00:15:54,519 --> 00:15:57,749
handles these are important stuff that
does I'm

292
00:15:57,749 --> 00:16:01,819
image generation and whatever else one
care about that want to focus on these

293
00:16:01,819 --> 00:16:05,920
high priority targets knees include
things like what generates a chef

294
00:16:05,920 --> 00:16:08,429
session tokens will generate the request
tokens

295
00:16:08,429 --> 00:16:12,470
how the image is a trip to house the
attempted and and they actually a really

296
00:16:12,470 --> 00:16:13,819
really did find

297
00:16:13,819 --> 00:16:17,089
because and top tags on a couple of mob

298
00:16:17,089 --> 00:16:20,779
other few other mobile apps as well but
all this on a message in one's

299
00:16:20,779 --> 00:16:24,779
they tend to hard code for some reason
I'm all them questions

300
00:16:24,779 --> 00:16:29,139
in there and the COSO the things where
they actually applications something API

301
00:16:29,139 --> 00:16:30,089
request to

302
00:16:30,089 --> 00:16:34,360
would be like pH slash registered user
and ought to do just

303
00:16:34,360 --> 00:16:37,860
I'm ready for that and other functions
work backwards from there

304
00:16:37,860 --> 00:16:41,980
and then we eventually end up at the
part that generates the request tokens

305
00:16:41,980 --> 00:16:45,389
so that quite easy to track down art

306
00:16:45,389 --> 00:16:49,519
let's get to the interesting but on ref
engineering application

307
00:16:49,519 --> 00:16:54,009
and actually lookin at at what it does

308
00:16:54,009 --> 00:16:57,459
with snapshot again this was a on belly

309
00:16:57,459 --> 00:17:00,879
easy exercise it had a lot of isolated
functions

310
00:17:00,879 --> 00:17:04,470
I am NOT basically means they've
designed applications such a way that

311
00:17:04,470 --> 00:17:08,630
call the function and whatever way you
want it and that the actual

312
00:17:08,630 --> 00:17:13,750
put together and then apply much linking
the function if you just on hold back

313
00:17:13,750 --> 00:17:16,380
and forth and recreate part of the
congress our

314
00:17:16,380 --> 00:17:19,230
one of the great things that they
actually had was the first thing I

315
00:17:19,230 --> 00:17:20,760
noticed was this

316
00:17:20,760 --> 00:17:24,680
on request authorization and this is
what with creating the first request

317
00:17:24,680 --> 00:17:25,680
token

318
00:17:25,680 --> 00:17:29,230
and that helped the label everything
string string secret and strength and it

319
00:17:29,230 --> 00:17:30,080
opened

320
00:17:30,080 --> 00:17:33,990
which which made things have really easy
for from our perspective

321
00:17:33,990 --> 00:17:37,480
and on examining the sort of request and
Skoda

322
00:17:37,480 --> 00:17:40,550
for a while turns out that what they
were doing the reason

323
00:17:40,550 --> 00:17:43,720
that the 930 is being generated

324
00:17:43,720 --> 00:17:47,430
as they would take day you that
generated timestamp the contour the

325
00:17:47,430 --> 00:17:48,380
timestamp

326
00:17:48,380 --> 00:17:52,510
they would take on strength secret and
they would have some together

327
00:17:52,510 --> 00:17:55,830
and never do that again take these
adjourned time stop and think

328
00:17:55,830 --> 00:17:59,270
started talking and hash them together
and then they would take those two

329
00:17:59,270 --> 00:18:00,730
hasher's and just append

330
00:18:00,730 --> 00:18:04,020
one at a time across here all the way
along

331
00:18:04,020 --> 00:18:08,720
so it was one passion for zero to shove
this and was on wanna take the hash out

332
00:18:08,720 --> 00:18:09,820
that

333
00:18:09,820 --> 00:18:13,060
and on the way that actually that turned
out is that

334
00:18:13,060 --> 00:18:16,100
all the zeros were completely static
they didn't change

335
00:18:16,100 --> 00:18:19,540
and only the ones for some reason I
action to changing when you have a

336
00:18:19,540 --> 00:18:21,410
timestamp

337
00:18:21,410 --> 00:18:24,550
up again kinda cutting crypto well
that's strange

338
00:18:24,550 --> 00:18:28,250
but to I'm said to build his client we'd
be able to

339
00:18:28,250 --> 00:18:31,360
create our own version of this may be
able to actually send

340
00:18:31,360 --> 00:18:35,710
request for the ATI so to create this
was pretty trivial

341
00:18:35,710 --> 00:18:39,890
all we do is I'll copy the code run it
with a cotton time

342
00:18:39,890 --> 00:18:44,300
down and generated and then we can now
can make fully understand get requests

343
00:18:44,300 --> 00:18:47,580
I'm just so you on smart people knew you
wouldn't notice

344
00:18:47,580 --> 00:18:51,360
dot these also didn't even require about
to happen

345
00:18:51,360 --> 00:18:55,410
as the highest and came from the client
itself and so did the study token

346
00:18:55,410 --> 00:18:58,480
and the strength so once the main one
and get a request

347
00:18:58,480 --> 00:19:01,900
and got access that request token you
can't continually make requests from

348
00:19:01,900 --> 00:19:04,610
that without any problem saving this
replay

349
00:19:04,610 --> 00:19:08,910
attacks over and over again awesome

350
00:19:08,910 --> 00:19:11,860
up for the communications when you
logged in well what we're gonna do

351
00:19:11,860 --> 00:19:16,770
without

352
00:19:16,770 --> 00:19:21,620
so see any further communications well a
bit better handled

353
00:19:21,620 --> 00:19:24,870
naturally when you first log in they
return things like

354
00:19:24,870 --> 00:19:28,460
of token on which is just around the
majority to do it

355
00:19:28,460 --> 00:19:32,080
and then I'm they get Houston with
things like the user name

356
00:19:32,080 --> 00:19:35,260
and the requester so now authenticated

357
00:19:35,260 --> 00:19:39,650
requests take a little bit more effort
to to break in Econ just become any use

358
00:19:39,650 --> 00:19:42,010
you want me to actually log in about you
that

359
00:19:42,010 --> 00:19:46,580
and the need to have of token which is
generated randomly

360
00:19:46,580 --> 00:19:50,990
an interesting thing was actually up the
wilderness by repeated this whatsoever

361
00:19:50,990 --> 00:19:54,040
no such thing as session expiration if
you want then once you're logged in

362
00:19:54,040 --> 00:19:56,520
until you try to walk out

363
00:19:56,520 --> 00:19:59,840
and what this also meant is that you the
name

364
00:19:59,840 --> 00:20:02,920
after you logged in was now linked to
the request token

365
00:20:02,920 --> 00:20:06,190
so changing either the username on the
timestamp

366
00:20:06,190 --> 00:20:10,650
or the request open at this point men
die any requests that you tried to do

367
00:20:10,650 --> 00:20:14,890
would become for Awana unscathed and not
becomes quite and by an important thing

368
00:20:14,890 --> 00:20:15,720
later on

369
00:20:15,720 --> 00:20:19,190
so we could execute randomly and get a
request bus

370
00:20:19,190 --> 00:20:24,980
be high waist and get an idea of how is
basically put together

371
00:20:24,980 --> 00:20:29,090
where my messages well on messages were
a little bit different

372
00:20:29,090 --> 00:20:33,120
on they used another encrypt traffic
secret key very that's fine

373
00:20:33,120 --> 00:20:37,030
this is how not jack up that all the
messages and then communication

374
00:20:37,030 --> 00:20:40,630
all around I have great as:

375
00:20:40,630 --> 00:20:45,740
PCB on-site both the using their and she
got the money with PCB but I'll

376
00:20:45,740 --> 00:20:50,380
a triangle but basically as has a couple
different weaknesses in it

377
00:20:50,380 --> 00:20:55,630
and I'm why then is this thing called
watermarking so if that the image to

378
00:20:55,630 --> 00:20:58,940
uphold the road to convert the same site
the textile ones

379
00:20:58,940 --> 00:21:03,260
to convert the same type a text so he
sent some got a message

380
00:21:03,260 --> 00:21:07,560
I'm over again the site over actually
never changes

381
00:21:07,560 --> 00:21:11,130
again I was really helpful completely
static he's

382
00:21:11,130 --> 00:21:15,040
I everything was there the functions
were very very isolated

383
00:21:15,040 --> 00:21:18,740
and could literally just the river mouth
one other time

384
00:21:18,740 --> 00:21:23,460
and call them over and over again and
the authors not the cups algorithm so we

385
00:21:23,460 --> 00:21:23,820
have

386
00:21:23,820 --> 00:21:27,650
up a group under the night called the
crypt and I'm encrypt

387
00:21:27,650 --> 00:21:31,000
and you can read literally just passing
by today to and

388
00:21:31,000 --> 00:21:34,480
I the crypt encrypt images and other
communication

389
00:21:34,480 --> 00:21:37,940
all by ourselves and again this then
change across clients

390
00:21:37,940 --> 00:21:41,840
then change across and devices
completely static

391
00:21:41,840 --> 00:21:45,190
a just like that once again remind you
guys that this

392
00:21:45,190 --> 00:21:48,260
was the application on the offer three
billion dollars for I mean a

393
00:21:48,260 --> 00:21:53,180
I don't know its difficult

394
00:21:53,180 --> 00:21:58,370
on okay so now have a method we have
basically some idea of how

395
00:21:58,370 --> 00:22:01,530
I am beta is encrypt it and the cryptid

396
00:22:01,530 --> 00:22:04,760
so we can generate use the data

397
00:22:04,760 --> 00:22:07,760
I'm we have sort of a way to

398
00:22:07,760 --> 00:22:11,060
absent request: but we don't mean only
to get some users

399
00:22:11,060 --> 00:22:14,530
and I'm this is what we decided to do
too well basically

400
00:22:14,530 --> 00:22:19,240
four different ways to name a user's and
even some the worst publication that s

401
00:22:19,240 --> 00:22:20,470
myself

402
00:22:20,470 --> 00:22:24,040
force quite a large number I think it
left a pretty much open

403
00:22:24,040 --> 00:22:27,130
North a three-step functionality you can
just

404
00:22:27,130 --> 00:22:30,420
on the services on offer a North request

405
00:22:30,420 --> 00:22:34,490
so you can just supply a username and
salaries the password

406
00:22:34,490 --> 00:22:38,600
and it would come back saying sorry that
exists or reset the user's password

407
00:22:38,600 --> 00:22:43,460
excellent I am with this it actually
sent an email for the unit so it kinda

408
00:22:43,460 --> 00:22:46,240
look at people who are trying to this
too many times and actually numerous

409
00:22:46,240 --> 00:22:46,800
users

410
00:22:46,800 --> 00:22:50,250
arm and as a scaleable and useful way

411
00:22:50,250 --> 00:22:54,490
was long functionality again at the Zen
didn't exist the J subject was very

412
00:22:54,490 --> 00:22:57,490
a graphic and returned information
saying

413
00:22:57,490 --> 00:23:01,120
not saying sorry long wrong with alcohol
just sorry

414
00:23:01,120 --> 00:23:04,350
it's completely the wrong user please
try again

415
00:23:04,350 --> 00:23:08,050
I'm fine print functionality I which
will count in a minute

416
00:23:08,050 --> 00:23:11,690
that was Obama of them to get a request

417
00:23:11,690 --> 00:23:15,570
and the one that we chose what was the
Reg the functionality optical

418
00:23:15,570 --> 00:23:19,500
just because it provided release for
Jason like this

419
00:23:19,500 --> 00:23:23,850
so say sorry the users already taken I
and with a lot of people's false let us

420
00:23:23,850 --> 00:23:24,380
know that

421
00:23:24,380 --> 00:23:27,840
well great not be marked

422
00:23:27,840 --> 00:23:30,920
one other interesting things around the
Sun shows sameera Reddy on

423
00:23:30,920 --> 00:23:34,870
for $1.6 million usually I'm actually
use the find friends

424
00:23:34,870 --> 00:23:38,140
functionality and I'm so we have to do
was

425
00:23:38,140 --> 00:23:43,000
create an anonymous accounts on then you
dialogue and get your these tokens

426
00:23:43,000 --> 00:23:47,840
then you would simply upload a phone
book so some guy named and the number

427
00:23:47,840 --> 00:23:51,270
up to the server on this number could be
as long as you wanted

428
00:23:51,270 --> 00:23:55,150
and basically the server it on returned
yet but user exists

429
00:23:55,150 --> 00:23:58,790
and not only did display the username
about person but also displayed their

430
00:23:58,790 --> 00:23:59,690
phone number

431
00:23:59,690 --> 00:24:02,990
so what these guys did the best we
uploaded I'm from

432
00:24:02,990 --> 00:24:07,150
I was a New York film set from 000 up to
999 a9

433
00:24:07,150 --> 00:24:10,850
and it's got a huge day something back
and 4.69 user names

434
00:24:10,850 --> 00:24:16,170
I'm just so you saw that in the news and
not getting released

435
00:24:16,170 --> 00:24:19,630
okay other aspects by the way now as
well as some rate-limiting around the

436
00:24:19,630 --> 00:24:20,480
system but

437
00:24:20,480 --> 00:24:25,690
bustillos financial gain to later are so
not going to lie there product cations

438
00:24:25,690 --> 00:24:26,990
the firms working

439
00:24:26,990 --> 00:24:31,120
and now want to see can we actually feel
about what we initially wanted to

440
00:24:31,120 --> 00:24:31,740
deliver

441
00:24:31,740 --> 00:24:35,720
can we deliver exploit and message to
users

442
00:24:35,720 --> 00:24:39,070
well does a slight problem with that

443
00:24:39,070 --> 00:24:42,320
anytime you try to send a message to
somebody who was in your friend

444
00:24:42,320 --> 00:24:46,870
all you do is get a friend request

445
00:24:46,870 --> 00:24:50,150
and will happen is so effect on your
friendship

446
00:24:50,150 --> 00:24:53,160
then you could just and they would see
the message open a

447
00:24:53,160 --> 00:24:57,500
and then it didn't accept your
friendship then about what happened

448
00:24:57,500 --> 00:25:01,020
so this is not exactly what I want to do
we don't friend people

449
00:25:01,020 --> 00:25:04,480
won't be able to actually pushed by the
to them to prove that will you know

450
00:25:04,480 --> 00:25:08,150
if we can do it then that's fine I'm
guys can do it or the NSA can do it or

451
00:25:08,150 --> 00:25:11,790
someone else can do it so a little
digging around

452
00:25:11,790 --> 00:25:17,410
and on well a lot of sort of looking at
that the API and that the publication

453
00:25:17,410 --> 00:25:20,580
we came to quite a lot of fun

454
00:25:20,580 --> 00:25:24,360
there was one magic request now with the
retry request

455
00:25:24,360 --> 00:25:27,780
I was completely innocent skated the
retry request should have been an

456
00:25:27,780 --> 00:25:30,860
unauthenticated message so it's
basically after you log n

457
00:25:30,860 --> 00:25:35,870
after you on how to use namely friends
and then you trust on the message

458
00:25:35,870 --> 00:25:39,040
and then that message doesn't get
through and you drop it and then you

459
00:25:39,040 --> 00:25:40,050
drop it again

460
00:25:40,050 --> 00:25:43,490
you drop it may be for a third or fourth
time and then the streets we try request

461
00:25:43,490 --> 00:25:46,250
and will pop up on the client

462
00:25:46,250 --> 00:25:50,250
and yeah at this point the retard
question can you could put anything and

463
00:25:50,250 --> 00:25:51,280
for the request token

464
00:25:51,280 --> 00:25:54,330
you buy anything in for the user name
and the

465
00:25:54,330 --> 00:25:58,690
just then make a difference all need to
do our supply and about his name to send

466
00:25:58,690 --> 00:26:03,540
message to and i own a valid and I'm
cryptid

467
00:26:03,540 --> 00:26:06,970
image or a message I tried to send well

468
00:26:06,970 --> 00:26:10,280
how does this help still have not
friends with the person we can send the

469
00:26:10,280 --> 00:26:13,190
message is going to accept a friend
request

470
00:26:13,190 --> 00:26:17,070
so well we had a liver think and thought
who

471
00:26:17,070 --> 00:26:20,230
is a user going to be friends with my
wife who

472
00:26:20,230 --> 00:26:23,900
regardless any situation will they be
friends with they cannot defend

473
00:26:23,900 --> 00:26:24,860
themselves

474
00:26:24,860 --> 00:26:28,080
all so make another friend that

475
00:26:28,080 --> 00:26:31,780
in any way and of course that would be
themselves

476
00:26:31,780 --> 00:26:35,800
so as I mentioned before normal requests
the username

477
00:26:35,800 --> 00:26:39,960
was links the request token but in this
situation

478
00:26:39,960 --> 00:26:43,360
the requests open made absolutely no
difference and

479
00:26:43,360 --> 00:26:46,720
nothin neither anything else and you can
actually set

480
00:26:46,720 --> 00:26:50,250
the youth named the recipient the same
value at this point

481
00:26:50,250 --> 00:26:53,400
username the you that would receive an
image

482
00:26:53,400 --> 00:26:57,350
from themselves and obviously the second
find themselves

483
00:26:57,350 --> 00:27:00,540
so a.m. it should always be delivered

484
00:27:00,540 --> 00:27:04,850
and notice appear we actually have
independent media id:

485
00:27:04,850 --> 00:27:08,080
what comes from the original user with
the media with that from again

486
00:27:08,080 --> 00:27:11,220
this is just for that sort of service
didn't make any difference you can

487
00:27:11,220 --> 00:27:14,290
change any of this information but as
long as the user existed

488
00:27:14,290 --> 00:27:21,290
and it was the same as a recipient it
was fine the message will get delivered

489
00:27:21,430 --> 00:27:25,200
again please do remember three billion
dollars there of this this is what what

490
00:27:25,200 --> 00:27:27,590
it's worth

491
00:27:27,590 --> 00:27:31,450
okay I so we have attack but to know

492
00:27:31,450 --> 00:27:35,110
we have scaleable I'm we can generate
their own images on just

493
00:27:35,110 --> 00:27:38,330
simple open SSL command line call on

494
00:27:38,330 --> 00:27:41,670
we have all-star keys and we can now

495
00:27:41,670 --> 00:27:45,700
send push messages to you directly
excellence

496
00:27:45,700 --> 00:27:48,950
where to take it from here this was the
next decision to

497
00:27:48,950 --> 00:27:52,590
to be made on I'll get back to this

498
00:27:52,590 --> 00:27:55,680
right after we mention all the things
around with your

499
00:27:55,680 --> 00:27:58,960
but please keep mine snapchat about a
week

500
00:27:58,960 --> 00:28:02,210
week-and-a-half worth the work fully
reverse engineer

501
00:28:02,210 --> 00:28:05,230
fine the when abilities

502
00:28:05,230 --> 00:28:08,390
fine it completely against on them get a
request

503
00:28:08,390 --> 00:28:12,500
and we sort of glances pretty quickly

504
00:28:12,500 --> 00:28:16,550
I'll show you got the end on the sort of
test the last year I'm sending these

505
00:28:16,550 --> 00:28:18,720
messages

506
00:28:18,720 --> 00:28:22,340
okay what about Wicca well

507
00:28:22,340 --> 00:28:25,660
these are the guys thats claim complete

508
00:28:25,660 --> 00:28:29,330
you know security he's a guy that's a
Allison point security

509
00:28:29,330 --> 00:28:33,600
we r crazy secure nothing can happen on
where the rate

510
00:28:33,600 --> 00:28:36,840
the ball in the same on methodology we
use in snapchat

511
00:28:36,840 --> 00:28:39,970
we basically trying to do a similar
thing I'll a

512
00:28:39,970 --> 00:28:43,730
I there is not much more secure other or
do they really up

513
00:28:43,730 --> 00:28:47,740
obfuscating crypt arm or the
communications and all the data

514
00:28:47,740 --> 00:28:51,750
so obtaining the ATK that pretty much
exactly the same

515
00:28:51,750 --> 00:28:55,230
I examine communications next step well

516
00:28:55,230 --> 00:28:58,830
this is whether came unstuck pretty
quickly

517
00:28:58,830 --> 00:29:02,310
looking at with workflow it was reread
different I'll

518
00:29:02,310 --> 00:29:05,520
all the communications were completely
in cryptid I

519
00:29:05,520 --> 00:29:09,100
the size the texts were completely
around them in with the friends

520
00:29:09,100 --> 00:29:12,170
and though the same length for the same
request bus

521
00:29:12,170 --> 00:29:17,650
on basically dead they be used even
gonna run the missing now or some kinda

522
00:29:17,650 --> 00:29:18,270
by these

523
00:29:18,270 --> 00:29:21,730
to make sure that you couldn't replay
them you can do not worry too much

524
00:29:21,730 --> 00:29:25,610
image data that you can really I'll
madame too much

525
00:29:25,610 --> 00:29:29,150
and was very little information leakage
in any other application

526
00:29:29,150 --> 00:29:32,620
all the objects were sent to a secure J
song and no matter what that

527
00:29:32,620 --> 00:29:36,440
communication was when there was
attempted on authentic ate it was fully

528
00:29:36,440 --> 00:29:42,530
encrypt it and other responses the way
as well giving cryptid or just API calls

529
00:29:42,530 --> 00:29:46,370
I so I mean this is gotta hit a brick
wall when we start with this time you

530
00:29:46,370 --> 00:29:48,000
need a point to be gay

531
00:29:48,000 --> 00:29:53,330
likely they provide is just %uh points
they had explanations a php files

532
00:29:53,330 --> 00:29:58,890
I bisous another reason I'd start keep
pursuing this a week a line of inquiry

533
00:29:58,890 --> 00:30:03,110
was just by the plain fact that decided
to use PHP for us over and

534
00:30:03,110 --> 00:30:06,550
nothing can speech he personally I have
developed a net but it doesn't tend to

535
00:30:06,550 --> 00:30:08,720
be the most secure coding language

536
00:30:08,720 --> 00:30:11,770
so even though all the communications
and prompted by this point was that I

537
00:30:11,770 --> 00:30:13,140
understand

538
00:30:13,140 --> 00:30:16,690
what the communication is doing so if
you know it's love you n when it's long

539
00:30:16,690 --> 00:30:17,550
been requested with

540
00:30:17,550 --> 00:30:20,810
calling do live in the PHP all went over
to register user

541
00:30:20,810 --> 00:30:24,220
a check that's calling richest user a
PHP

542
00:30:24,220 --> 00:30:27,650
alright so hopefully we can to see the
same line of on

543
00:30:27,650 --> 00:30:31,280
I'm shouting and the same line of
inquiry with wicker

544
00:30:31,280 --> 00:30:34,480
we can extract the code made you can
find some keys mean

545
00:30:34,480 --> 00:30:39,190
involves dunno do but reversing and see
what happens

546
00:30:39,190 --> 00:30:42,770
again other codex extraction worked very
successfully

547
00:30:42,770 --> 00:30:47,080
I am it was a really really well
commented I look at it code itself the

548
00:30:47,080 --> 00:30:48,870
lock on tight controls on a

549
00:30:48,870 --> 00:30:53,250
and including things like a lot of
Uncharted and client-side in Wicca

550
00:30:53,250 --> 00:30:57,580
and again things like comments like we
know and API calls now doing

551
00:30:57,580 --> 00:31:01,250
in the youth in Papillion was in Ballard
least this is a better response than

552
00:31:01,250 --> 00:31:04,430
please I user name was complaining about
so

553
00:31:04,430 --> 00:31:08,690
now the more difficult you what God has
been suspended and use names but those

554
00:31:08,690 --> 00:31:10,120
already in use

555
00:31:10,120 --> 00:31:13,190
excellent that's what we're looking for
okay so

556
00:31:13,190 --> 00:31:18,390
on basically we get a better a bit of an
idea of what because doings

557
00:31:18,390 --> 00:31:24,060
following a similar methodology and
trying to work out what the situation is

558
00:31:24,060 --> 00:31:27,410
bucks I unfortunately will get a little
bit on stock

559
00:31:27,410 --> 00:31:31,010
the next level on once the compiled on

560
00:31:31,010 --> 00:31:34,020
all the codes seem to be missing all the
interesting to see functions there were

561
00:31:34,020 --> 00:31:34,490
no

562
00:31:34,490 --> 00:31:38,000
calls to any on encryption far methods
the 10

563
00:31:38,000 --> 00:31:43,100
he's the anti static tokens I'm so what
did the usual thing I'm dressed for

564
00:31:43,100 --> 00:31:44,670
things like that as:

565
00:31:44,670 --> 00:31:49,830
shot 256 I'm and d5 looking for
basically any sort of cryptographic

566
00:31:49,830 --> 00:31:51,360
primitives that they were using

567
00:31:51,360 --> 00:31:54,850
because of this they must be doing
something but there was nothing there

568
00:31:54,850 --> 00:31:58,050
all the calls that generate these
requests opens generate link up to date

569
00:31:58,050 --> 00:31:59,880
that distance didn't exist

570
00:31:59,880 --> 00:32:03,210
so look a little bit head-scratching not
really

571
00:32:03,210 --> 00:32:06,980
and talent show what they can from here
do a bit more sort of begging

572
00:32:06,980 --> 00:32:11,080
and we find out that everything
interesting all the stuff we needed to

573
00:32:11,080 --> 00:32:12,090
know

574
00:32:12,090 --> 00:32:16,020
was actually stored in a compiled binary
and basically

575
00:32:16,020 --> 00:32:19,290
with I'm ass and replication and

576
00:32:19,290 --> 00:32:23,070
thinking this summer I'm not sure on
that I just wanted

577
00:32:23,070 --> 00:32:26,880
than the compiler but with an Android
application we can do is you can write a

578
00:32:26,880 --> 00:32:27,490
lot a bit

579
00:32:27,490 --> 00:32:31,020
NRC ko when he compiled a code and use

580
00:32:31,020 --> 00:32:35,390
Jan I'm just the Java native interface
to communicate with the original Java

581
00:32:35,390 --> 00:32:35,880
code

582
00:32:35,880 --> 00:32:39,970
so want to compile the C code I becomes
like any other binary like a DLL

583
00:32:39,970 --> 00:32:43,310
and no economy look inside it that well

584
00:32:43,310 --> 00:32:46,320
well supposedly so have a look

585
00:32:46,320 --> 00:32:50,050
quick look at the binary and know how to
strengthen now just

586
00:32:50,050 --> 00:32:53,320
you use a strong punch on the command
line on there were some

587
00:32:53,320 --> 00:32:56,910
debugging code but again nothing to
useful to give us a clue

588
00:32:56,910 --> 00:33:00,420
a well who go from here so I guess

589
00:33:00,420 --> 00:33:03,910
at this point me to go on a deeper and
pull out some

590
00:33:03,910 --> 00:33:08,070
reverse engineering tools

591
00:33:08,070 --> 00:33:12,140
on to start this can no longer just make
API calls

592
00:33:12,140 --> 00:33:16,080
to on the server and expect responses
actually work through that occasion that

593
00:33:16,080 --> 00:33:16,750
way

594
00:33:16,750 --> 00:33:20,480
week ago based about the beginning and
design the whole project

595
00:33:20,480 --> 00:33:24,460
I'll create the client and our Java
Eclipse environment

596
00:33:24,460 --> 00:33:29,200
create an Android project on with an
emulator that can run native code

597
00:33:29,200 --> 00:33:36,200
and I we can now actually call there out
with a lively from

598
00:33:36,760 --> 00:33:41,890
so I wanna things up to do when you do
such things think that'll to completely

599
00:33:41,890 --> 00:33:45,750
on redesign the work love the
application so with the

600
00:33:45,750 --> 00:33:48,940
application structure loss on nicole
make a library

601
00:33:48,940 --> 00:33:51,970
because out no access this library part
from Parliament

602
00:33:51,970 --> 00:33:56,830
me to make sure that the structure
remains the same I am so if there was

603
00:33:56,830 --> 00:34:00,480
Kong my work home with the gooey
whatever

604
00:34:00,480 --> 00:34:03,600
me to preserve although about
functionality

605
00:34:03,600 --> 00:34:07,050
and what they actually did has relied
very very heavily

606
00:34:07,050 --> 00:34:10,119
on these things on on basically

607
00:34:10,119 --> 00:34:14,279
global the variables so the application
had to

608
00:34:14,279 --> 00:34:17,889
be executed in a very specific order
what happen is they would do a couple

609
00:34:17,889 --> 00:34:19,129
things then it wud

610
00:34:19,129 --> 00:34:22,490
do something called on securing a phone

611
00:34:22,490 --> 00:34:25,309
and look around and if there are other
things message generation and things

612
00:34:25,309 --> 00:34:26,089
like that

613
00:34:26,089 --> 00:34:29,759
so the little bit tricky now but we can
at least

614
00:34:29,759 --> 00:34:33,940
in a way maybe call the API at like this
or to create a ATI

615
00:34:33,940 --> 00:34:37,569
for that make the code if we design it
correctly

616
00:34:37,569 --> 00:34:41,220
so give you guys a quick example here

617
00:34:41,220 --> 00:34:44,829
so we have our make an android running
their and

618
00:34:44,829 --> 00:34:49,139
basic version of Eclipse and what we
doing here as

619
00:34:49,139 --> 00:34:53,129
this is the week hillary duff basically
I'm redesigned from from scratch using

620
00:34:53,129 --> 00:34:55,109
part to their coat apartment

621
00:34:55,109 --> 00:34:58,999
native code now though managed well
other mushers on the compound

622
00:34:58,999 --> 00:35:02,470
fine and we're going to basically try to
create

623
00:35:02,470 --> 00:35:05,819
a you this is one other things that
we've what up in the code is

624
00:35:05,819 --> 00:35:09,279
when you first register you there it
takes in some parameters

625
00:35:09,279 --> 00:35:12,619
a test third day I'm username/password

626
00:35:12,619 --> 00:35:17,650
that private sector and then it creates
one of these encrypt it rings

627
00:35:17,650 --> 00:35:21,150
so all we did all they do is actually
going to go on

628
00:35:21,150 --> 00:35:25,019
didn't see it here we're going soon
tried to call their ATII

629
00:35:25,019 --> 00:35:28,460
block Nani lol got going try to call the
functions inside

630
00:35:28,460 --> 00:35:32,390
the compiled binary and hopefully it
works

631
00:35:32,390 --> 00:35:37,029
we should be able to take some time to
have time to run

632
00:35:37,029 --> 00:35:40,369
to generate our our very own on

633
00:35:40,369 --> 00:35:43,480
Nathalie cryptid with a code

634
00:35:43,480 --> 00:35:48,009
hopefully it has a crush

635
00:35:48,009 --> 00:35:53,860
and see what's happening here

636
00:35:53,860 --> 00:35:58,810
a came know who wants to work

637
00:35:58,810 --> 00:36:03,220
when it does alright so data is an oops

638
00:36:03,220 --> 00:36:08,420
alright so decided to create its own a
new emulator

639
00:36:08,420 --> 00:36:13,290
I do apologize for that not sure what's
decided to do that

640
00:36:13,290 --> 00:36:18,730
okay I the toughest min ago I think I
wanted to restart give it a second so

641
00:36:18,730 --> 00:36:19,960
you can really start this

642
00:36:19,960 --> 00:36:25,240
and I'll get back to that technical demo
so this restart Eclipse and I'll

643
00:36:25,240 --> 00:36:27,190
hopefully run the study of you guys

644
00:36:27,190 --> 00:36:31,260
and get a actually working then and

645
00:36:31,260 --> 00:36:38,039
the better the pain if it's modern quite
right

646
00:36:38,039 --> 00:36:41,030
that's

647
00:36:41,030 --> 00:36:45,790
a child again okay on will will have a
technical demo but maybe not just quite

648
00:36:45,790 --> 00:36:46,270
yet

649
00:36:46,270 --> 00:36:49,310
get back to this

650
00:36:49,310 --> 00:36:52,770
on okay so basically

651
00:36:52,770 --> 00:36:55,800
using not method

652
00:36:55,800 --> 00:36:59,820
we can generate on custom crafted
strengths ok actually call

653
00:36:59,820 --> 00:37:03,440
the API cell I'm

654
00:37:03,440 --> 00:37:08,190
hopefully network so

655
00:37:08,190 --> 00:37:12,619
kinda relies on the fact that at this
point

656
00:37:12,619 --> 00:37:15,830
okay thing might get something working a
second

657
00:37:15,830 --> 00:37:20,010
we can carry the strings because
basically once again generate this these

658
00:37:20,010 --> 00:37:21,490
in Christians ourselves

659
00:37:21,490 --> 00:37:24,850
we can at this point start doing

660
00:37:24,850 --> 00:37:28,470
on our own creation so we can call I'll

661
00:37:28,470 --> 00:37:31,650
register use the function call logging
functions then

662
00:37:31,650 --> 00:37:34,980
Tempe need to know what's inside the
strains with these include two strings

663
00:37:34,980 --> 00:37:36,030
as long as they work

664
00:37:36,030 --> 00:37:43,030
a strong run that one more time

665
00:37:45,200 --> 00:37:50,599
always the case they had to restart and
later

666
00:37:50,599 --> 00:37:57,599
and hopefully my get some sort of
strange generation

667
00:38:02,520 --> 00:38:05,170
housing for time

668
00:38:05,170 --> 00:38:09,420
come on art I'll just move on really
well as it was starting to have them

669
00:38:09,420 --> 00:38:10,330
come back to this

670
00:38:10,330 --> 00:38:14,430
and shake dice or you go what actually
happened so it's dying slowly

671
00:38:14,430 --> 00:38:18,030
want to restart we should have some text
information show here

672
00:38:18,030 --> 00:38:25,030
okay I'm so basically there is there is
a way to generate and to call these on

673
00:38:25,780 --> 00:38:29,000
you think Yas but unfortunately as I
mentioned before our

674
00:38:29,000 --> 00:38:33,470
met this is very finicky doesn't always
work based on these global variables

675
00:38:33,470 --> 00:38:37,760
and that it means that and see
constantly even make sure that they're

676
00:38:37,760 --> 00:38:43,680
execution in the application is is very
arm as as as as very well done and well

677
00:38:43,680 --> 00:38:44,460
time Ana

678
00:38:44,460 --> 00:38:48,790
so better than any fault Aug 8 goal or a

679
00:38:48,790 --> 00:38:53,200
aim of our building custom or scrapes
cable client and also doesn't really

680
00:38:53,200 --> 00:38:54,310
help us understand

681
00:38:54,310 --> 00:38:57,730
what the application is sending what
it's doing and sort of

682
00:38:57,730 --> 00:39:00,860
house communicating with the server
because communications to let

683
00:39:00,860 --> 00:39:04,770
cryptid even though this this is
something that we have sort of control

684
00:39:04,770 --> 00:39:05,220
over

685
00:39:05,220 --> 00:39:08,990
but the control like that is pretty
basic all we can do so some promise

686
00:39:08,990 --> 00:39:12,310
pass it inside their shell Object
Library

687
00:39:12,310 --> 00:39:17,450
and then see what comes out and
hopefully you then that way let's see if

688
00:39:17,450 --> 00:39:24,170
we can get this to work again

689
00:39:24,170 --> 00:39:30,650
rescue Paso the evidence or

690
00:39:30,650 --> 00:39:32,410
bull

691
00:39:32,410 --> 00:39:39,410
conference time

692
00:39:40,100 --> 00:39:45,970
one and only you doing

693
00:39:45,970 --> 00:39:48,619
pain okay here we go excellent

694
00:39:48,619 --> 00:39:52,180
and we that match generate and encrypt
it

695
00:39:52,180 --> 00:39:56,809
version of that User register string
bass on the ground to the previously

696
00:39:56,809 --> 00:39:57,490
provided

697
00:39:57,490 --> 00:40:00,920
if I actually take this train now and
send it to the API

698
00:40:00,920 --> 00:40:05,240
I on this server will get back about
response so this point it's not doing

699
00:40:05,240 --> 00:40:05,980
things like

700
00:40:05,980 --> 00:40:09,609
basically enumerating users like that
before not that interesting

701
00:40:09,609 --> 00:40:13,750
on another scaleable as see-saw the
generation takes quite a while to do

702
00:40:13,750 --> 00:40:17,260
so want to do it in a slightly different
better more

703
00:40:17,260 --> 00:40:20,420
more efficient way on

704
00:40:20,420 --> 00:40:24,069
looking to buy and resell a must be
packed with with three different binary

705
00:40:24,069 --> 00:40:26,769
is when the iPad application you had the
honour down

706
00:40:26,769 --> 00:40:30,029
on the gym 7 x86 which an image and

707
00:40:30,029 --> 00:40:35,289
any you know I should be compiled to on
C code using older versions the tax rate

708
00:40:35,289 --> 00:40:38,769
which I myself actually had so again

709
00:40:38,769 --> 00:40:41,819
look in the binary in games like a
really good idea understanding of the

710
00:40:41,819 --> 00:40:42,480
workflow

711
00:40:42,480 --> 00:40:45,539
of the application on

712
00:40:45,539 --> 00:40:49,019
as mentioned already all the cup to
functions that were interested in were

713
00:40:49,019 --> 00:40:53,190
ponies private functions and basically
they have mister interface the Java so

714
00:40:53,190 --> 00:40:53,700
you'd

715
00:40:53,700 --> 00:40:57,269
the job functions you would call that
the only a couple your call them and

716
00:40:57,269 --> 00:40:59,180
they will go often communicate to the
other

717
00:40:59,180 --> 00:41:02,559
on such a private and we basically want
to get to the

718
00:41:02,559 --> 00:41:06,750
just the way I want to find the
interesting and use information and on

719
00:41:06,750 --> 00:41:07,789
the way to do that

720
00:41:07,789 --> 00:41:11,849
again with picked something on call this
chapter is to use a string

721
00:41:11,849 --> 00:41:15,619
because basically this this native
function is executed the very beginning

722
00:41:15,619 --> 00:41:16,650
the application

723
00:41:16,650 --> 00:41:19,910
and without too many things beings that
and

724
00:41:19,910 --> 00:41:23,170
Prince out some sort of string of some
sort a result so we can hopefully

725
00:41:23,170 --> 00:41:25,779
control it and catch a binary in an
interesting way

726
00:41:25,779 --> 00:41:30,599
to get out what we want looking on code
really briefly

727
00:41:30,599 --> 00:41:33,950
I'll be disassembled the binary
completely we got

728
00:41:33,950 --> 00:41:37,029
really great the money variables and
names so

729
00:41:37,029 --> 00:41:40,579
main by kinko server text and get Bay 64
from data

730
00:41:40,579 --> 00:41:44,019
well they're useful help us understand
how that information is put together

731
00:41:44,019 --> 00:41:47,089
if any guys know much about on

732
00:41:47,089 --> 00:41:52,609
we have an awesome r0 and r1 and r3
Tovar register that you to put important

733
00:41:52,609 --> 00:41:53,640
sometimes a whole

734
00:41:53,640 --> 00:41:57,289
and are zeros always register is used
outputs in this case

735
00:41:57,289 --> 00:42:00,779
with store something register five moved
to res 20

736
00:42:00,779 --> 00:42:04,869
now be the first input them how r for
now one so move

737
00:42:04,869 --> 00:42:08,049
what I was register for 2001 a second
input

738
00:42:08,049 --> 00:42:11,619
& Co serve attacked as a call the
function and the output

739
00:42:11,619 --> 00:42:15,460
is an r0 so our misery rerun which

740
00:42:15,460 --> 00:42:18,720
nice and easy to patch and allows us to
do some

741
00:42:18,720 --> 00:42:22,509
up and think things that a note from %ah
0 hits move soon

742
00:42:22,509 --> 00:42:25,839
get a 64 in code and at this point we
can actually

743
00:42:25,839 --> 00:42:29,890
Prince the status of this a press out
creates a space 64 go to train

744
00:42:29,890 --> 00:42:35,650
okay on again was it is want want want
to be able to see what the application

745
00:42:35,650 --> 00:42:37,380
was doing and more more clear detail

746
00:42:37,380 --> 00:42:40,400
so here we could actually quite easily
patch

747
00:42:40,400 --> 00:42:43,789
information so in coats over text that
to impose

748
00:42:43,789 --> 00:42:48,109
and one other than books must have been
some the plaintext so if we

749
00:42:48,109 --> 00:42:52,599
just a up by here which is then put and
put it back into our 0

750
00:42:52,599 --> 00:42:56,500
than r0 get sent to based 64 and
hopefully

751
00:42:56,500 --> 00:42:59,519
wooden have a look at what the
information has been passed around

752
00:42:59,519 --> 00:43:02,779
now if the demigod salami

753
00:43:02,779 --> 00:43:07,170
I'll demonstrate that and a quick demo
with the pre patch binary

754
00:43:07,170 --> 00:43:11,109
so if I just

755
00:43:11,109 --> 00:43:17,569
rename this so this is a pretty much
binary live with the core and this is

756
00:43:17,569 --> 00:43:18,640
what I use an hour

757
00:43:18,640 --> 00:43:22,150
on next attempt getting information out

758
00:43:22,150 --> 00:43:27,609
night to remember um it goes to base64
so we want to be able to

759
00:43:27,609 --> 00:43:31,150
decode base64 hope to see what
information is actually been that's

760
00:43:31,150 --> 00:43:31,890
passed around

761
00:43:31,890 --> 00:43:35,420
so let's run this

762
00:43:35,420 --> 00:43:39,339
and save get some something different
hope we should be much quicker

763
00:43:39,339 --> 00:43:46,339
doesn't decide to start up a namely
again is something like that in the most

764
00:43:46,740 --> 00:43:50,430
time efficient method up cranes
applications

765
00:43:50,430 --> 00:43:54,710
but this is sort of the first that I
understand how that can communicate and

766
00:43:54,710 --> 00:43:55,849
what actually is doing

767
00:43:55,849 --> 00:43:59,579
and

768
00:43:59,579 --> 00:44:04,970
heap corruption excellence passion buyer
is now my strong point to do apologize

769
00:44:04,970 --> 00:44:08,390
and as I mentioned it doesn't tend to be
on

770
00:44:08,390 --> 00:44:11,660
berry stable but hopefully

771
00:44:11,660 --> 00:44:16,000
it will print out something useful for
us if we run a couple times

772
00:44:16,000 --> 00:44:20,839
on the memory thing that senate that to
change by law based on

773
00:44:20,839 --> 00:44:25,400
I'll how the in latest startup Octomom

774
00:44:25,400 --> 00:44:31,390
to me like this I'm really hung on a
good event today ice

775
00:44:31,390 --> 00:44:35,410
up apologize and the thank you for your
patience hey there we go

776
00:44:35,410 --> 00:44:40,289
so pack it finally worked as you can see
it's the same

777
00:44:40,289 --> 00:44:44,309
on information will call on the same
functions but suddenly it's completely

778
00:44:44,309 --> 00:44:45,420
in cleartext

779
00:44:45,420 --> 00:44:48,759
so now we have Jason object that's being
sent at

780
00:44:48,759 --> 00:44:52,599
well you the name hashing have them I
think the which is a hash

781
00:44:52,599 --> 00:44:55,920
awesome again this method it's okay

782
00:44:55,920 --> 00:45:00,200
on we can carry on can rebuild other
part of the application log in we can

783
00:45:00,200 --> 00:45:01,579
rebuild parts like

784
00:45:01,579 --> 00:45:05,339
on the user registration and other stuff
the final more

785
00:45:05,339 --> 00:45:08,730
on our own information to it but as I
mentioned previously

786
00:45:08,730 --> 00:45:13,430
marketable and doesn't allow us to do
what we really really want to do

787
00:45:13,430 --> 00:45:19,520
which is creates really from lot
attacked the application in that way

788
00:45:19,520 --> 00:45:23,020
okay on mentioned previously there are
two

789
00:45:23,020 --> 00:45:26,420
variables being passed 2i get for
texting code

790
00:45:26,420 --> 00:45:29,910
I want them is there plaintext which we
just saw printed out

791
00:45:29,910 --> 00:45:33,630
and the other law what what else could
be passed into that on the register

792
00:45:33,630 --> 00:45:36,660
my function was it might be the key

793
00:45:36,660 --> 00:45:41,160
and if it's a key I'll be great we don't
need to go through any one relation we

794
00:45:41,160 --> 00:45:42,770
can just call open SSL

795
00:45:42,770 --> 00:45:47,500
and hopefully get the key out one
wrapped around not register and

796
00:45:47,500 --> 00:45:51,579
printed out came out to be a bid to buy
on

797
00:45:51,579 --> 00:45:55,200
long variable which never changed
depending on whether

798
00:45:55,200 --> 00:45:58,250
applications run whatever device or
anything else is a stud

799
00:45:58,250 --> 00:46:02,099
there'll always came back the same so
far so good

800
00:46:02,099 --> 00:46:05,849
but to keep me to find out what is the
encryption method used

801
00:46:05,849 --> 00:46:09,380
excellent AF to 56-51

802
00:46:09,380 --> 00:46:14,849
pretty the looking to buy a wreath now
in a website for the using

803
00:46:14,849 --> 00:46:17,869
so some are patching as before up

804
00:46:17,869 --> 00:46:21,500
we basically take r4 and passed out that

805
00:46:21,500 --> 00:46:24,950
unfortunately I am spent three days
looking at this

806
00:46:24,950 --> 00:46:28,309
and a we've got the key out thirty that
variable it was

807
00:46:28,309 --> 00:46:31,799
it was the right size and the right
places seem to be no the perfect ending

808
00:46:31,799 --> 00:46:32,630
to the story

809
00:46:32,630 --> 00:46:35,970
we have the key now can the crypt all
the communication

810
00:46:35,970 --> 00:46:40,319
I'm any point no matter what they send
didn't quite work out that way

811
00:46:40,319 --> 00:46:43,579
I something was wrong no idea what three
days later

812
00:46:43,579 --> 00:46:47,460
still nothing working an inside look a
little bit deeper into that

813
00:46:47,460 --> 00:46:50,799
the binary itself so a bit more

814
00:46:50,799 --> 00:46:54,910
assembly code this is actually inside
coats over text

815
00:46:54,910 --> 00:46:58,900
and bass from try confirm is why is that
he now working as a summer special going

816
00:46:58,900 --> 00:46:59,559
on

817
00:46:59,559 --> 00:47:03,739
and maybe try and grab the key at an
earlier point just as get sent to their

818
00:47:03,739 --> 00:47:07,180
as: encryption function put the
country's code

819
00:47:07,180 --> 00:47:11,109
basically you this %uh to buy pointers
and by ponder just

820
00:47:11,109 --> 00:47:15,940
I Brett references the register and
returns read-only value

821
00:47:15,940 --> 00:47:19,730
and create some on the bites get the
length a one other values passed then

822
00:47:19,730 --> 00:47:23,880
called as: encrypt with four different
inputs up by five different

823
00:47:23,880 --> 00:47:28,500
input from our 02 r4 then it creates an
empty objects

824
00:47:28,500 --> 00:47:32,130
a pen some bites the object the pencil
by subject and then that becomes

825
00:47:32,130 --> 00:47:36,390
out books of there and conserve a test

826
00:47:36,390 --> 00:47:39,489
so to get the key at this point me to do
a couple different things

827
00:47:39,489 --> 00:47:44,059
me too crate if you register Creighton
spaced worked within the registers

828
00:47:44,059 --> 00:47:48,009
art store the new key and a free
register somewhere

829
00:47:48,009 --> 00:47:52,230
and hopefully a panicky to get final
output

830
00:47:52,230 --> 00:47:55,900
up pre-register it was pretty the
actually by creating this

831
00:47:55,900 --> 00:47:59,119
stabilizer code massively I bird on the
code

832
00:47:59,119 --> 00:48:03,160
there was a stack corruption check on
and of 5 was one of the very few words

833
00:48:03,160 --> 00:48:04,710
so that wasn't being used

834
00:48:04,710 --> 00:48:08,230
something by bypassing this and changing
that 2 I'm

835
00:48:08,230 --> 00:48:11,779
branch my equal we bypassed the
corruption check no matter what was the

836
00:48:11,779 --> 00:48:12,960
rest of 5

837
00:48:12,960 --> 00:48:16,319
and the code executed up successfully
and jumped on further

838
00:48:16,319 --> 00:48:20,069
so now we have to register a hot
excellent

839
00:48:20,069 --> 00:48:23,890
now to find a space to work with in this
function on changing

840
00:48:23,890 --> 00:48:27,109
up to it was like no really free space
in this area swat to change something in

841
00:48:27,109 --> 00:48:27,579
it

842
00:48:27,579 --> 00:48:30,779
to create a better space to our fine
well good

843
00:48:30,779 --> 00:48:33,829
stories registers well

844
00:48:33,829 --> 00:48:38,700
run the bites was actually generating 16
run the bike so this one Imports run by

845
00:48:38,700 --> 00:48:41,779
has an axe 0x 10 a sixteen

846
00:48:41,779 --> 00:48:45,529
and well what sixteen run bytes what
what what what what is a useful

847
00:48:45,529 --> 00:48:49,020
and I V and I the special basically
insurance for

848
00:48:49,020 --> 00:48:52,089
a season is basically an initialization
better

849
00:48:52,089 --> 00:48:55,420
I get past two as: encrypt and it seems
to randomize

850
00:48:55,420 --> 00:48:58,500
on their site thanks to make sure that
the same side message

851
00:48:58,500 --> 00:49:03,099
on the same plane text message when it's
a cryptid look different every time

852
00:49:03,099 --> 00:49:07,230
so surprisingly I just because a whole
was very things that ever which was

853
00:49:07,230 --> 00:49:07,819
actually

854
00:49:07,819 --> 00:49:12,489
storing run by 10% off or and a previous
point but simply not fled the run the

855
00:49:12,489 --> 00:49:14,089
bikes function

856
00:49:14,089 --> 00:49:17,940
remove it completely are not just
created a static IP

857
00:49:17,940 --> 00:49:22,789
and also for by two spacers to work with
him I'm when running this code

858
00:49:22,789 --> 00:49:26,220
actually realized thats it still
produced completely valid

859
00:49:26,220 --> 00:49:30,500
I'm thing I've been criticized for text
on a sense of that for the server

860
00:49:30,500 --> 00:49:34,549
with a static IP its returns ballot
results excellence

861
00:49:34,549 --> 00:49:37,660
and now we have four bytes a space right
here

862
00:49:37,660 --> 00:49:42,239
just before this by point at which
returned some data and by the sponsor

863
00:49:42,239 --> 00:49:43,130
realized

864
00:49:43,130 --> 00:49:47,230
this by .2 here was actually going to i
grab some kind of

865
00:49:47,230 --> 00:49:50,660
static encryption key return it and pass
it to this

866
00:49:50,660 --> 00:49:55,319
as: encrypt and this on input here are
there cuz by pointer is actually the

867
00:49:55,319 --> 00:49:56,450
import a whole

868
00:49:56,450 --> 00:50:00,020
from the previous function okay

869
00:50:00,020 --> 00:50:03,759
so we have faith we've created a
pre-register

870
00:50:03,759 --> 00:50:07,980
now with you to preserve the key pretty
easily done we take off sex which is the

871
00:50:07,980 --> 00:50:08,569
output

872
00:50:08,569 --> 00:50:12,150
are store the non you created free
register our by

873
00:50:12,150 --> 00:50:16,289
arms in cr0 the output from this by
pointer it's not enough sex here

874
00:50:16,289 --> 00:50:21,520
so is preserve our sex as laid on the
code of it gets overwritten

875
00:50:21,520 --> 00:50:26,069
and now we have a keen of 5 extent now
sleater panicky

876
00:50:26,069 --> 00:50:29,460
to want to be the pen by functions and
hopefully it will come out

877
00:50:29,460 --> 00:50:32,520
all nice-looking up

878
00:50:32,520 --> 00:50:35,630
pending against pretty easy this as arm

879
00:50:35,630 --> 00:50:39,270
it has the pen bikes they did Penn 16
bytes of the ID

880
00:50:39,270 --> 00:50:43,079
to create the spay/neuter balls which is
an anti object

881
00:50:43,079 --> 00:50:46,989
I we know the key is 32 bytes in length
so we can use that

882
00:50:46,989 --> 00:50:50,829
so we just override the fight the text
which is appended here

883
00:50:50,829 --> 00:50:54,489
which has a variable length depending on
the length of the cipher generated

884
00:50:54,489 --> 00:50:58,420
but was always great and pay two bucks
the suffering a place to upend

885
00:50:58,420 --> 00:51:01,450
the key in this situation so

886
00:51:01,450 --> 00:51:04,880
pretty the replace are seven with of i

887
00:51:04,880 --> 00:51:07,960
which is crystal here push shut down

888
00:51:07,960 --> 00:51:11,730
and hopefully we have something that now
works

889
00:51:11,730 --> 00:51:14,989
okay got this BBQ looks like I

890
00:51:14,989 --> 00:51:18,469
just so you're aware this is a
completely non-static

891
00:51:18,469 --> 00:51:22,509
shared key model Android applications
analyzed it to the crypt

892
00:51:22,509 --> 00:51:25,710
pretty much most of the webcast
telecommunications and do some pretty

893
00:51:25,710 --> 00:51:27,619
other interesting stuff

894
00:51:27,619 --> 00:51:33,009
%uh so the key after getting off to a
concert you guys

895
00:51:33,009 --> 00:51:37,509
a Hamas still going through a process
for them but dont issues but

896
00:51:37,509 --> 00:51:41,380
not find it pretty much have our
scaleable

897
00:51:41,380 --> 00:51:45,270
useful client that we can use to on a
type system with

898
00:51:45,270 --> 00:51:48,650
we cannot accept all with communications
so we can drink rip them

899
00:51:48,650 --> 00:51:51,900
and weekend I'm do use an immigration

900
00:51:51,900 --> 00:51:54,989
and with great interest in things around
with a loss there is

901
00:51:54,989 --> 00:51:58,130
by default it set up to accept messages
from

902
00:51:58,130 --> 00:52:02,380
anyone incoming I communication unless
you block them specifically

903
00:52:02,380 --> 00:52:07,680
so that you need to find any sort of on
secret delivery messenger quest

904
00:52:07,680 --> 00:52:10,900
we can simply just not send messages to
any users

905
00:52:10,900 --> 00:52:14,619
by enumerating users in the same way
using I'll

906
00:52:14,619 --> 00:52:18,190
there that hasher's consider the
usernames

907
00:52:18,190 --> 00:52:21,849
supply them to the same message I API

908
00:52:21,849 --> 00:52:24,910
rink ripped it and there we go

909
00:52:24,910 --> 00:52:28,119
so because we go running a bounty I

910
00:52:28,119 --> 00:52:31,160
amid the key to them in an email I got a
reply within an hour

911
00:52:31,160 --> 00:52:34,719
and an accepted by bouncy and bass for
some medications

912
00:52:34,719 --> 00:52:38,369
which will come later awesome great
success

913
00:52:38,369 --> 00:52:41,630
I what about snatch a so still don't
know what to do without

914
00:52:41,630 --> 00:52:44,670
I'm we have information contained
messages but

915
00:52:44,670 --> 00:52:49,930
we can her okay my time is running out
so she got pretty quickly

916
00:52:49,930 --> 00:52:53,809
answer snapshot but recap we have what
we need

917
00:52:53,809 --> 00:52:57,670
weakened create on information is among
Python file we can create this whole API

918
00:52:57,670 --> 00:52:59,670
and send the scale the message

919
00:52:59,670 --> 00:53:02,770
now which need a message are we decided
on this

920
00:53:02,770 --> 00:53:05,910
an emergency broadcast I for

921
00:53:05,910 --> 00:53:10,210
you know for all the fun and see what to
do with it so this point had around five

922
00:53:10,210 --> 00:53:12,049
to six million you the names

923
00:53:12,049 --> 00:53:16,109
and the mother that through the parking
program that could not send messages

924
00:53:16,109 --> 00:53:20,809
on this is basically what happened

925
00:53:20,809 --> 00:53:25,069
if anyone is interested and supposedly
the federal messaging was beautifully

926
00:53:25,069 --> 00:53:27,680
proved to be broken as a lot of people
have screenshots

927
00:53:27,680 --> 00:53:32,380
of this information I although if anyone
goes to this

928
00:53:32,380 --> 00:53:35,809
Lincoln can tell me what secret hidden
message in error be helped by you guys a

929
00:53:35,809 --> 00:53:37,349
beer afterwards

930
00:53:37,349 --> 00:53:40,380
so sorry but I'm as over again

931
00:53:40,380 --> 00:53:43,529
more more sort of things snapshot that
affects that

932
00:53:43,529 --> 00:53:48,359
issue are on they can't get a messaging
on sock ons showed them a bit but

933
00:53:48,359 --> 00:53:51,150
hopefully this that illustrates what
actually happened

934
00:53:51,150 --> 00:53:54,200
they manage to fix the whole thing
within an hour someone tweeted at

935
00:53:54,200 --> 00:53:55,170
snapchat

936
00:53:55,170 --> 00:53:59,230
I all zombie apocalypse coming what's
going on they replied with what

937
00:53:59,230 --> 00:54:02,390
and an hour later the whole system was
fixed I cannot be a pretty great result

938
00:54:02,390 --> 00:54:02,700
for them

939
00:54:02,700 --> 00:54:07,380
the day yep considering to them for
months to do it with a

940
00:54:07,380 --> 00:54:10,759
the 4.6 million you name conclusion

941
00:54:10,759 --> 00:54:14,270
annually leave no traces I think up a
demonstrated that that's not by

942
00:54:14,270 --> 00:54:15,700
possibility

943
00:54:15,700 --> 00:54:19,900
medications to look at would be number
one up a scapegoat a binary is

944
00:54:19,900 --> 00:54:23,359
bill you shed keys prove that prevents
analysis use by

945
00:54:23,359 --> 00:54:28,469
key encryption and I'm sign the messages
CD 51 mode allows

946
00:54:28,469 --> 00:54:32,000
I an attack where you can actually
overwrite

947
00:54:32,000 --> 00:54:35,359
their servers and basic Russian 11
request

948
00:54:35,359 --> 00:54:39,489
snap jobs sorry stature mitigations the
snapshot

949
00:54:39,489 --> 00:54:42,900
would be take the money when its offer
to you with I

950
00:54:42,900 --> 00:54:46,359
about the only thing I can think of it
was completely broken otherwise

951
00:54:46,359 --> 00:54:50,609
but a further research on I am almost I
promise wicca is actually

952
00:54:50,609 --> 00:54:54,210
fun into life is so pride for project a
model to all further

953
00:54:54,210 --> 00:54:57,619
and message applications including
snapshot and what's up

954
00:54:57,619 --> 00:55:01,230
so I think maybe next they will have a
19 been billion dollar up

955
00:55:01,230 --> 00:55:04,420
a battle with any luck thank you so much

956
00:55:04,420 --> 00:55:05,369
sorry guys overtime

