1
00:00:06,240 --> 00:00:09,339
[music]

2
00:01:12,350 --> 00:01:15,458
[music]

3
00:02:11,360 --> 00:02:14,819
the diagnostic protocol stack based on

4
00:02:14,819 --> 00:02:17,220
the CAN network and on the right side

5
00:02:17,220 --> 00:02:20,040
the diagnostic pro stack on no Mille

6
00:02:20,040 --> 00:02:23,160
Ethernet like can you spots from therefore

7
00:02:23,160 --> 00:02:27,379
knastik as we can see the application

8
00:03:04,340 --> 00:03:09,480
XL cold for supporting Hyatt so kennis

9
00:03:09,480 --> 00:03:12,659
not dead  and we will not see can go

10
00:03:12,659 --> 00:03:16,620
rated soon because it super jeep every

11
00:03:16,620 --> 00:03:19,760
small mike controller

12
00:03:26,120 --> 00:03:28,680
is the transport layer protocol and

13
00:03:28,680 --> 00:03:31,500
top of can we need this to trans for

14
00:03:31,500 --> 00:03:33,540
software updates volksampel we can

15
00:03:33,540 --> 00:03:36,300
transfer up to for gigabytes of data

16
00:03:36,300 --> 00:03:38,519
know you latest vesucations of the

17
00:03:38,519 --> 00:03:42,239
Prodigy to point protocol a dispoints

18
00:03:42,239 --> 00:03:45,060
and destination something in mechanism and

19
00:03:45,060 --> 00:03:47,760
will then be able to lotto flow control

20
00:03:47,760 --> 00:03:50,239
management

21
00:03:56,060 --> 00:04:00,000
segmented communication so the source

22
00:04:00,000 --> 00:04:03,000


23
00:05:09,620 --> 00:05:13,820
with endpoints let's

24
00:05:13,820 --> 00:05:16,460
scan scan because

25
00:05:16,460 --> 00:05:20,100
the so the endpoint mini the

26
00:05:20,100 --> 00:05:23,060
couple of parameters

27
00:05:23,060 --> 00:05:25,680
all knows a little how can not start in

28
00:05:25,680 --> 00:05:27,419
the communication as well as need to

29
00:05:27,419 --> 00:05:29,360
identifiers

30
00:05:29,360 --> 00:05:32,580
Receiver identifier because that is then

31
00:05:32,580 --> 00:05:36,120
Edition standard for extended where you

32
00:05:36,120 --> 00:05:41,780
have all to additiona  l Receiver

33
00:05:53,200 --> 00:05:56,420
[Music]

34
00:06:09,150 --> 00:06:12,330
[Music]

35
00:07:20,780 --> 00:07:25,020
identifier like also know I want to use

36
00:07:25,020 --> 00:07:27,120
Petting on not and if you look on to the

37
00:07:27,120 --> 00:07:29,479
first bite basically here

38
00:07:29,479 --> 00:07:35,719
to have extended or not extended

39
00:07:37,639 --> 00:07:40,740
to scan such a scanning part car Network

40
00:07:40,740 --> 00:07:43,139
is like just flood in part car  network

41
00:07:43,139 --> 00:07:44,360
with first frames

42
00:07:44,360 --> 00:07:48,680
and listen for responses

43
00:07:51,500 --> 00:07:56,400
sometimes See first of all like detect

44
00:07:56,400 --> 00:07:58,400
all also

45
00:07:58,400 --> 00:08:02,039
typberrys secondly sins like never finish hour also

46
00:08:02,039 --> 00:08:07,220
TP message in the ECU 12 which also received the

47
00:08:07,220 --> 00:08:10,800
next first frame and this means

48
00:08:10,800 --> 00:08:14,340
in the firmware our isotopy message is

49
00:08:14,340 --> 00:08:16,800
never handles  to any Application Layer

50
00:08:16,800 --> 00:08:21,440
basically Neville application

51
00:08:21,919 --> 00:08:27,120
on the safe so we never accident some

52
00:08:27,120 --> 00:08:28,919
UDS command to trigger some

53
00:08:28,919 --> 00:08:31,580
physicalaction

54
00:08:33,860 --> 00:08:37,159
physical actions

55
00:08:37,820 --> 00:08:43,500
are we scanning isotopy and notification

56
00:08:51,560 --> 00:08:54,360
sometimes OEMs implement the own

57
00:08:54,360 --> 00:08:56,820
functionality at the E2 exchange data

58
00:08:56,820 --> 00:08:59,760
between to easy use on top of isotopy

59
00:08:59,760 --> 00:09:02,760
because it  proportal protecall you don't

60
00:09:02,760 --> 00:09:04,560
know the Application Layer format for

61
00:09:04,560 --> 00:09:06,320
this protocal

62
00:09:06,320 --> 00:09:10,320
Scan die Application day

63
00:09:10,320 --> 00:09:13,760
Madita beings

64
00:09:16,920 --> 00:09:19,140
in scappi wir

65
00:09:19,140 --> 00:09:20,899
Utilities

66
00:09:20,899 --> 00:09:25,820
minite the Toyota couple on all

67
00:09:25,820 --> 00:09:28,100
TP

68
00:09:28,100 --> 00:09:30,720
layers one line we can basically run

69
00:09:30,720 --> 00:09:34,980
hour Scan AGA network and then how get

70
00:09:34,980 --> 00:09:38,300
returned alist of all

71
00:09:41,839 --> 00:09:47,519
identifized to go for some father Scania

72
00:09:59,840 --> 00:10:02,989
[music]

73
00:10:05,940 --> 00:10:08,940
vehicle access

74
00:10:20,540 --> 00:10:24,920
the first usage was in 2018

75
00:10:41,210 --> 00:10:44,320
[music]

76
00:11:09,180 --> 00:11:12,480
that is too  the package deluxe like pre

77
00:11:12,480 --> 00:11:15,779
simple thirty to bit of steering identifier

78
00:11:15,779 --> 00:11:19,220
because we too differentipes

79
00:11:19,220 --> 00:11:22,920
basically the message and echo in the

80
00:11:22,920 --> 00:11:26,360
knollsment or sixtyfours an error code

81
00:11:26,360 --> 00:11:31,260
a destination like have your logical

82
00:11:31,260 --> 00:11:34,500
actressing on the easy use so you know from

83
00:11:34,500 --> 00:11:36,540
the destination weekend specify the

84
00:11:36,540 --> 00:11:39,720
something on  the ECU in the sub network the

85
00:11:39,720 --> 00:11:44,240
type want to send the day to basically

86
00:11:44,240 --> 00:11:47,240
UPS

87
00:11:49,820 --> 00:11:54,500
need to send our UDS data

88
00:13:35,120 --> 00:13:37,100
in

89
00:13:37,100 --> 00:13:40,639
Morrison Cars the same purples it says

90
00:13:40,639 --> 00:13:44,399
here now to the standard and not only

91
00:13:44,399 --> 00:13:46,820
beam you double this standard

92
00:13:46,820 --> 00:13:52,760
so sorry that's still a bit

93
00:13:52,760 --> 00:13:56,360
Volkswagen Mercedes

94
00:13:58,700 --> 00:14:04,519
because hsfz and endkapsulate application also

95
00:14:10,040 --> 00:14:13,760
identify

96
00:14:30,980 --> 00:14:35,399
point and then you can connect to the

97
00:14:35,399 --> 00:14:37,260
vehicle we are diagnostic over IP

98
00:14:37,260 --> 00:14:38,700


99
00:14:38,700 --> 00:14:42,800
socket not so here  activate Routing

100
00:14:43,199 --> 00:14:44,420
and

101
00:14:44,420 --> 00:14:47,940
furious smallscanning Script

102
00:14:47,940 --> 00:14:50,639
which allows Youtube identify all the

103
00:14:50,639 --> 00:14:54,420
logical adverse horse address on easy

104
00:14:54,420 --> 00:15:00,000
use in the diagnostics over IP network

105
00:15:01,860 --> 00:15:04,620
if you want to communicate diagnostics

106
00:15:04,620 --> 00:15:09,000
all IP here is volkslampe IPv6 are there

107
00:15:09,000 --> 00:15:11,060
is the Troopers like ip6

108
00:15:11,060 --> 00:15:14,579
you can open UDS diagnostic all  I P6

109
00:15:14,579 --> 00:15:18,779
socket in scappy and directly feet udss

110
00:15:18,779 --> 00:15:22,560
messages into the social get a response

111
00:15:22,560 --> 00:15:26,540
so hier folgsamble wie Sender

112
00:16:20,270 --> 00:16:23,340
[Musik]

113
00:16:31,279 --> 00:16:34,399
wie Import scanner and then we can

114
00:16:34,399 --> 00:16:38,000
OpenOffice socket and basically

115
00:16:38,000 --> 00:16:40,980
directorted scanning

116
00:16:40,980 --> 00:16:43,380
and we got returned a list auf

117
00:16:43,380 --> 00:16:46,500
Information so das ist folgsamer Scan

118
00:16:46,500 --> 00:16:49,019
very gravity some the vehicle

119
00:16:49,019 --> 00:16:51,560
identification

120
00:16:59,120 --> 00:17:01,220
control

121
00:17:01,220 --> 00:17:04,220
responited

122
00:17:04,520 --> 00:17:09,859
want to quarry fast for

123
00:18:05,880 --> 00:18:09,360
Mobby so the tests the client the computer the

124
00:18:09,360 --> 00:18:12,660
pen tester is the client and the client

125
00:18:12,660 --> 00:18:14,220
dest driving the communication so now

126
00:18:14,220 --> 00:18:15,720
always request response between

127
00:18:15,720 --> 00:18:18,559
communication or the client

128
00:18:18,559 --> 00:18:20,640
sensoryquest and the server the car

129
00:18:20,640 --> 00:18:24,120
answers request

130
00:18:24,120 --> 00:18:28,039
that's all like so I have for you DS

131
00:18:28,039 --> 00:18:30,720
Service identifi  he here volksampel

132
00:18:30,720 --> 00:18:33,380
retail at identifier

133
00:18:33,380 --> 00:18:37,380
22 Service

134
00:18:40,300 --> 00:18:43,579
[music]

135
00:19:07,940 --> 00:19:13,260
Service number X-ART with forty so there

136
00:19:13,260 --> 00:19:15,740
is a compilation

137
00:19:15,740 --> 00:19:18,480
betweens in caser for a negative

138
00:19:18,480 --> 00:19:21,240
response I will return will receive

139
00:19:21,240 --> 00:19:24,000
sevenf also negative response Service

140
00:19:24,000 --> 00:19:29,059
identifier Fallout at the Service vor

141
00:19:29,059 --> 00:19:32,600
and the version

142
00:19:40,410 --> 00:19:43,539
[  music]

143
00:19:44,960 --> 00:19:48,380
for you DS

144
00:23:01,220 --> 00:23:04,380
[music]

145
00:24:38,159 --> 00:24:40,520
made

146
00:24:51,020 --> 00:24:54,419
the diagnostic session control service

147
00:24:54,419 --> 00:24:58,980
to record this track

148
00:25:56,780 --> 00:25:59,940
[music]

149
00:26:33,100 --> 00:26:36,320
[music]

150
00:32:27,710 --> 00:32:30,859
[music]

151
00:33:03,720 --> 00:33:06,080
here

152
00:33:06,260 --> 00:33:10,520
stand from the standard

153
00:33:25,820 --> 00:33:29,340
here is again receiver the

154
00:33:29,340 --> 00:33:35,220
currentation i want to go and

155
00:34:45,170 --> 00:34:48,349
[music]

156
00:35:10,910 --> 00:35:13,969
[music]

157
00:35:29,970 --> 00:35:33,020
[music]

158
00:37:01,280 --> 00:37:03,859
at UDS

159
00:37:03,859 --> 00:37:07,800
diagnostics protocol control information

160
00:37:07,800 --> 00:37:12,060
and only check the UDS the service is

161
00:37:12,060 --> 00:37:14,220
the enemy at udss that we know will

162
00:37:14,220 --> 00:37:17,359
change the state of the system

163
00:37:27,800 --> 00:37:29,820
control brings these are different

164
00:37:29,820 --> 00:37:32,119
sessions

165
00:37:37,700 --> 00:37:41,400
one security access level [ __ ] you have

166
00:37:41,400 --> 00:37:44,460
small asset of states and we  need to be

167
00:37:44,460 --> 00:37:46,320
in Avery is Pacific state in order to

168
00:37:46,320 --> 00:37:48,859
enter the bootloader so this is the

169
00:37:48,859 --> 00:37:53,000
simulator problem here that we havenes

170
00:37:53,000 --> 00:37:55,200
bootloader and we to find the right

171
00:37:55,200 --> 00:37:57,599
sequenc  e of messages to enter the

172
00:37:57,599 --> 00:38:01,680
bootloader craft we know how which

173
00:38:01,680 --> 00:38:03,900
messages we have to send in order in

174
00:38:03,900 --> 00:38:09,020
order to go into final state basically

175
00:38:12,200 --> 00:38:16,140
Software so that consists out of three

176
00:38:16,140 --> 00:38:19,079
parts basically die protocol in Cappy

177
00:38:19,079 --> 00:38:22,500
Witcher objects so the prodigall de

178
00:38:22,500 --> 00:38:26,040
fines hour state changes  basically or

179
00:38:26,040 --> 00:38:30,320
notes at test case is what recall

180
00:38:30,320 --> 00:38:35,220
i enumerator of function and this

181
00:38:35,220 --> 00:38:37,500
innovator generate packets witcher sand

182
00:38:37,500 --> 00:38:40,320
tours easy you and all the test case

183
00:38:40,320 --> 00:38:43,980
are in generating only assertain set of

184
00:38:43,980 --> 00:38:45,020
packets

185
00:38:45,020 --> 00:38:48,660
the capital rating the response and

186
00:38:48,660 --> 00:38:51,420
estomating new states which before the

187
00:38:51,420 --> 00:38:56,220
test case generates  age so

188
00:39:03,260 --> 00:39:07,079
so die execute haselist of testcases with

189
00:39:07,079 --> 00:39:10,079
chemistry to execute and from each

190
00:39:10,079 --> 00:39:13,560
execution he Mail receive notes and

191
00:39:13,560 --> 00:39:16,859
edges and then he can build a grave we

192
00:39:16,859 --> 00:39:19,800
can also Reset our target Andy can

193
00:39:19,800 --> 00:39:23,339
modify the target to enter the pass to a

194
00:39:23,339 --> 00:39:27,240
final state and then  run executers sorry

195
00:39:27,240 --> 00:39:30,540
run test cases on certain states so that

196
00:39:30,540 --> 00:39:33,920
's treated

197
00:39:35,720 --> 00:39:39,119
here.ation easy are like basically take and

198
00:39:39,119 --> 00:39:42,800
existing UDS protocol packet  Option

199
00:39:42,800 --> 00:39:46,740
here and tell this diagnostic session

200
00:39:46,740 --> 00:39:51,380
control positive response message hey

201
00:39:51,380 --> 00:39:54,900
you change the session of anisy you

202
00:39:54,900 --> 00:39:58,320
basically so we give on state upject

203
00:39:58,320 --> 00:40:02,579
Todes Decorator and wie Arno Tate basic

204
00:40:02,579 --> 00:40:05,960
protocol with System

205
00:40:17,700 --> 00:40:20,770
[Music]

206
00:40:55,350 --> 00:40:58,469
[Music]

207
00:41:25,460 --> 00:41:28,140
Fingerprint test to test if this

208
00:41:28,140 --> 00:41:30,599
Fingerprint command  is supported and

209
00:41:30,599 --> 00:41:33,839
this leads to a new edge basically to

210
00:41:33,839 --> 00:41:37,640
new note in my system

211
00:41:38,119 --> 00:41:43,260
scanner vs dealer a list of test

212
00:41:43,260 --> 00:41:46,700
cases that found here and maybe some

213
00:41:46,700 --> 00:41:50,339
parameters to make the scan faster to

214
00:41:50,339 --> 00:41:52,619
customized the execution on the

215
00:41:52,619 --> 00:41:55,400
different test cases

216
00:42:11,599 --> 00:42:15,119
not limited by  can here we can just

217
00:42:15,119 --> 00:42:17,660
go on

218
00:42:37,820 --> 00:42:41,579
identifier works here a

219
00:42:41,579 --> 00:42:44,520
dead it and because all go ahead and do the

220
00:42:44,520 --> 00:42:48,780
same I feat is water to my scanner and

221
00:42:48,780 --> 00:42:51,200
run

222
00:42:51,540 --> 00:42:56,220
so haut das des look like das ist ein so

223
00:42:56,220 --> 00:42:59,940
das ist Agenda system that Enrico was

224
00:42:59,940 --> 00:43:01,980
reverse  Engineering as well as one to enter

225
00:43:01,980 --> 00:43:03,839
the bootloader what the Easy you very

226
00:43:03,839 --> 00:43:07,920
would have scanner run basically the default

227
00:43:07,920 --> 00:43:12,420
state here in green the bootloader

228
00:43:12,420 --> 00:43:15,000
session so basically we had to the  worst

229
00:43:15,000 --> 00:43:18,599
over touches here in your to be able to

230
00:43:18,599 --> 00:43:20,180
the bootloader

231
00:43:20,180 --> 00:43:24,859
some basics the dark queen is security

232
00:43:24,859 --> 00:43:29,578
accessful in the bootloader so

233
00:44:31,579 --> 00:44:34,680
automatically and finally on the 12

234
00:44:34,680 --> 00:44:37,260
hours of run the scanner automatical

235
00:44:37,260 --> 00:44:39,540
find the right secrets of messages for

236
00:44:39,540 --> 00:44:42,740
me to enter to the

237
00:44:46,880 --> 00:44:49,940
jacking and  diagnostic of IP your

238
00:44:49,940 --> 00:44:52,520
heartfaster

239
00:44:52,520 --> 00:44:55,700
now limited by can could be Optimist

240
00:44:55,700 --> 00:44:58,700
yes

241
00:44:58,700 --> 00:45:01,380
so here basically I'm in the dark

242
00:45:01,380 --> 00:45:07,280
Session 2 to Security Access finally

243
00:45:35,839 --> 00:45:39,259
for almost

244
00:45:49,700 --> 00:45:53,460
that is also time consuming so Tank

245
00:45:53,460 --> 00:45:58,400
consume take up Tour second to reset DSU

246
00:45:58,400 --> 00:46:01,079
at power cycle are  quite too wait

247
00:46:01,079 --> 00:46:05,339
untill the with you come back and boots

248
00:46:05,339 --> 00:46:06,319
and

249
00:46:06,319 --> 00:46:09,319
sometimes

250
00:46:09,440 --> 00:46:13,440
after session change this happens if you

251
00:46:13,440 --> 00:46:16,280
change the

252
00:46:19,339 --> 00:46:22,339
firmwaresex

253
00:46:26,000 --> 00:46:29,900
another 500 Milly seconds maybe with the

254
00:46:29,900 --> 00:46:32,900
costersheim

255
00:46:34,339 --> 00:46:38,359
round you

256
00:46:38,420 --> 00:46:42,440
order passes so the system would be

257
00:46:42,440 --> 00:46:46,220
like run a new test of the scanner pics

258
00:46:46,220 --> 00:46:52,560
Graf and will  execute the inumerators

259
00:47:15,450 --> 00:47:16,819
[music]

260
00:47:16,819 --> 00:47:21,420
first problem so obedient

261
00:47:21,420 --> 00:47:24,920
after Anthering new diagnostic session

262
00:47:24,920 --> 00:47:27,680
before you hate Security Access Level

263
00:47:27,680 --> 00:47:30,300
does the se  curity Access Level stay the

264
00:47:30,300 --> 00:47:32,660
same all that are

265
00:47:32,660 --> 00:47:35,700
change the session that is orems Pacific

266
00:47:35,700 --> 00:47:37,400
and

267
00:47:37,400 --> 00:47:41,540
the propell Terry

268
00:47:43,859 --> 00:47:46,859
volkampel

269
00:47:48,010 --> 00:47:51,089
[music]

270
00:47:52,800 --> 00:47:55,560
sometimes you

271
00:47:55,560 --> 00:47:59,700
under loud enter programming session the

272
00:47:59,700 --> 00:48:03,140
energy mode is still the power saving so

273
00:48:03,140 --> 00:48:06,839
the state brokering at the power saving

274
00:48:06,839 --> 00:48:10,200
mode and first  do need to enter die

275
00:48:10,200 --> 00:48:13,640
energy mode first name udess operations

276
00:48:13,640 --> 00:48:16,640
please

277
00:48:16,940 --> 00:48:19,940
problems

278
00:48:20,240 --> 00:48:23,220
fine to difference day to change reality

279
00:48:23,220 --> 00:48:26,760
the same state basically so this extens

280
00:48:26,760 --> 00:48:29,220
equipment state draft but escimation

281
00:48:29,220 --> 00:48:34,220
about the easy works and max out

282
00:48:35,530 --> 00:48:38,599
[music]

283
00:48:42,200 --> 00:48:45,319
[music]

284
00:49:08,400 --> 00:49:11,510
[music]

285
00:49:14,480 --> 00:49:18,020
references for the  security access stuff

286
00:49:18,020 --> 00:49:22,099
because thanks for your attention

287
00:50:42,200 --> 00:50:46,460
online so you have no way basically to

288
00:50:46,460 --> 00:50:51,920
direct emulator code now that's

289
00:51:15,920 --> 00:51:18,440
careful

290
00:51:18,440 --> 00:51:21,440
broken

291
00:51:26,660 --> 00:51:29,660
replacement

292
00:51:38,960 --> 00:51:42,960
and test

