1
00:00:00,000 --> 00:00:03,419
two and the mic is working great yes my

2
00:00:03,419 --> 00:00:05,000
name is

3
00:00:05,000 --> 00:00:08,160
that's my nickname in any way I go

4
00:00:08,160 --> 00:00:13,380
GitHub Twitter anywhere so I have this

5
00:00:13,380 --> 00:00:15,299
presentation which is by the way open

6
00:00:15,299 --> 00:00:17,940
source it's available as a PDF analytic

7
00:00:17,940 --> 00:00:19,859
Source in my GitHub repository called

8
00:00:19,859 --> 00:00:21,359
security courses you are welcome to

9
00:00:21,359 --> 00:00:23,279
steal anything from this slide and from

10
00:00:23,279 --> 00:00:24,720
all the other training materials that I

11
00:00:24,720 --> 00:00:25,920
put online

12
00:00:25,920 --> 00:00:27,900
this may my main contribution

13
00:00:27,900 --> 00:00:30,359
contribution today is not a tool or

14
00:00:30,359 --> 00:00:32,098
programming I'm not a good programmer

15
00:00:32,098 --> 00:00:34,320
but I know a lot about networking

16
00:00:34,320 --> 00:00:36,660
networks so I have been performing

17
00:00:36,660 --> 00:00:38,280
structured details testing for customers

18
00:00:38,280 --> 00:00:40,379
for quite some years now and I would

19
00:00:40,379 --> 00:00:45,059
know love to love to see you do the same

20
00:00:45,059 --> 00:00:47,160
in your networks uh there's a little bit

21
00:00:47,160 --> 00:00:49,079
of contact information and I will be

22
00:00:49,079 --> 00:00:51,960
here until Friday so hit me up and talk

23
00:00:51,960 --> 00:00:55,559
about networks infrastructure IPv6 I'm

24
00:00:55,559 --> 00:00:57,300
really sad that we don't have IPv6 here

25
00:00:57,300 --> 00:00:59,280
but we can probably do something about

26
00:00:59,280 --> 00:01:01,980
that create a fake access point or

27
00:01:01,980 --> 00:01:03,660
something like that you're welcome to

28
00:01:03,660 --> 00:01:05,339
drop me emails you're welcome to find me

29
00:01:05,339 --> 00:01:07,080
and ask me questions

30
00:01:07,080 --> 00:01:09,000
also I have this disclaimer because

31
00:01:09,000 --> 00:01:11,040
testing networks can be a bit of a

32
00:01:11,040 --> 00:01:13,200
trouble and doing a stress testing of

33
00:01:13,200 --> 00:01:15,659
networks using DDOS is of course illegal

34
00:01:15,659 --> 00:01:18,000
in many countries so you have to check

35
00:01:18,000 --> 00:01:19,740
up on your own country and where you're

36
00:01:19,740 --> 00:01:21,840
doing it and especially be aware that

37
00:01:21,840 --> 00:01:24,360
you're not doing a DDOS test on an IP

38
00:01:24,360 --> 00:01:26,640
that you do not own because that would

39
00:01:26,640 --> 00:01:28,920
be a sun flooding or some other attempt

40
00:01:28,920 --> 00:01:31,920
that could be seen as illegal activity

41
00:01:31,920 --> 00:01:34,259
so you will get into trouble and we have

42
00:01:34,259 --> 00:01:36,360
had people in Denmark being into trouble

43
00:01:36,360 --> 00:01:39,299
because of doing DDOS attacks and so on

44
00:01:39,299 --> 00:01:42,180
so check your legal

45
00:01:42,180 --> 00:01:44,460
framework in your country's

46
00:01:44,460 --> 00:01:47,700
so this presentation and these slides

47
00:01:47,700 --> 00:01:50,040
will have a lot of text

48
00:01:50,040 --> 00:01:52,259
I'm sorry for that but hopefully you

49
00:01:52,259 --> 00:01:54,780
will be listening to my voice looking at

50
00:01:54,780 --> 00:01:56,700
the pictures looking at the parts that I

51
00:01:56,700 --> 00:01:59,100
have put into bold text so you're not

52
00:01:59,100 --> 00:02:01,799
supposed to read all of the slides but

53
00:02:01,799 --> 00:02:04,020
hopefully when you get home you will be

54
00:02:04,020 --> 00:02:06,000
able to read the slides and follow the

55
00:02:06,000 --> 00:02:08,220
instructions so hopefully there's enough

56
00:02:08,220 --> 00:02:10,800
enough of details on the slides to

57
00:02:10,800 --> 00:02:13,140
enable you to perform DDOS testing after

58
00:02:13,140 --> 00:02:15,599
this talk so you don't have to remember

59
00:02:15,599 --> 00:02:18,300
remember everything

60
00:02:18,300 --> 00:02:20,819
the main part about this is that we are

61
00:02:20,819 --> 00:02:22,560
connecting to the internet you have some

62
00:02:22,560 --> 00:02:23,940
kind of services that you put on the

63
00:02:23,940 --> 00:02:25,739
internet you probably have some kind of

64
00:02:25,739 --> 00:02:28,440
value from that some of it may be

65
00:02:28,440 --> 00:02:30,360
monetary value you want to keep some

66
00:02:30,360 --> 00:02:32,040
website up and running you will want to

67
00:02:32,040 --> 00:02:34,800
keep some sites up and running so when

68
00:02:34,800 --> 00:02:36,599
we connect to the internet we get this

69
00:02:36,599 --> 00:02:38,700
bad traffic we are getting Port scans

70
00:02:38,700 --> 00:02:41,099
we're getting the Internet teenages it's

71
00:02:41,099 --> 00:02:43,440
a background noise all the time and then

72
00:02:43,440 --> 00:02:45,420
sometimes people will start to do Brute

73
00:02:45,420 --> 00:02:46,620
Force attacks and all of the other

74
00:02:46,620 --> 00:02:48,780
attacks that we know of and once in a

75
00:02:48,780 --> 00:02:51,000
while you will also get the DDOS attacks

76
00:02:51,000 --> 00:02:53,099
and we know that the actors that are

77
00:02:53,099 --> 00:02:55,319
performing details they are enabling

78
00:02:55,319 --> 00:02:57,360
details attacks on even small customers

79
00:02:57,360 --> 00:02:59,580
they can handle the flow of customers

80
00:02:59,580 --> 00:03:01,620
attacking smaller and smaller companies

81
00:03:01,620 --> 00:03:03,599
so it's not just the big companies that

82
00:03:03,599 --> 00:03:05,700
are getting hit by DDOS attacks we know

83
00:03:05,700 --> 00:03:07,500
that everybody is getting hit by DDOS

84
00:03:07,500 --> 00:03:09,720
attacks so that's like why we are here

85
00:03:09,720 --> 00:03:12,300
today talking about DDOS so in this talk

86
00:03:12,300 --> 00:03:14,340
I will try to go through these four

87
00:03:14,340 --> 00:03:17,220
bullets which is about firewall

88
00:03:17,220 --> 00:03:19,319
infrastructures I think that a firewall

89
00:03:19,319 --> 00:03:21,900
is more than just the box that you buy I

90
00:03:21,900 --> 00:03:23,580
will talk about doing Port scans for

91
00:03:23,580 --> 00:03:25,980
Discovery before we do the DDOS attacks

92
00:03:25,980 --> 00:03:28,319
then I will do some detail detailed

93
00:03:28,319 --> 00:03:30,000
advice about how to actually perform

94
00:03:30,000 --> 00:03:32,159
this DDOS attack using some of the

95
00:03:32,159 --> 00:03:34,019
existing tools that are available out on

96
00:03:34,019 --> 00:03:35,640
the internet you can run them from a

97
00:03:35,640 --> 00:03:37,800
standard Linux machine and it's not very

98
00:03:37,800 --> 00:03:41,099
hard to get started doing DDOS testing

99
00:03:41,099 --> 00:03:43,440
then I have some advice and that's very

100
00:03:43,440 --> 00:03:46,200
opinionated about how to protect your

101
00:03:46,200 --> 00:03:47,599
networks and make them more robust

102
00:03:47,599 --> 00:03:50,580
towards DDOS attacks and that will also

103
00:03:50,580 --> 00:03:52,080
make them more reliable in many other

104
00:03:52,080 --> 00:03:54,180
ways so hopefully you will take some of

105
00:03:54,180 --> 00:03:56,760
that advice and reuse them on your

106
00:03:56,760 --> 00:03:59,819
existing devices by configuring your

107
00:03:59,819 --> 00:04:02,519
devices better than they are by default

108
00:04:02,519 --> 00:04:04,739
will make your network better so

109
00:04:04,739 --> 00:04:06,299
hopefully you can increase the

110
00:04:06,299 --> 00:04:07,799
protection and robustness of your

111
00:04:07,799 --> 00:04:10,379
network and I can say that is real

112
00:04:10,379 --> 00:04:11,700
because I have seen it in customer

113
00:04:11,700 --> 00:04:14,040
networks where we have perhaps improved

114
00:04:14,040 --> 00:04:16,918
our security stance towards DDOS attacks

115
00:04:16,918 --> 00:04:19,440
like 10 or 100 times in some of the

116
00:04:19,440 --> 00:04:22,380
scenarios so really go and read the

117
00:04:22,380 --> 00:04:24,240
manual for some of the features because

118
00:04:24,240 --> 00:04:26,699
the firewall vendors the router vendors

119
00:04:26,699 --> 00:04:29,040
all the devices these vendors they don't

120
00:04:29,040 --> 00:04:31,259
know how your network looks they don't

121
00:04:31,259 --> 00:04:33,960
know your mix of traffic so it's very

122
00:04:33,960 --> 00:04:35,460
important to look at your configuration

123
00:04:35,460 --> 00:04:37,800
and improve your configuration across

124
00:04:37,800 --> 00:04:40,560
what I call the firewall infrastructure

125
00:04:40,560 --> 00:04:42,240
these attack tools that I will be

126
00:04:42,240 --> 00:04:44,100
talking about today is developed by

127
00:04:44,100 --> 00:04:45,720
others and I'm very grateful that we

128
00:04:45,720 --> 00:04:47,400
have this open source penetration

129
00:04:47,400 --> 00:04:49,620
testing tools attack tools pack

130
00:04:49,620 --> 00:04:51,900
generators so

131
00:04:51,900 --> 00:04:54,660
you can easily find them and Implement

132
00:04:54,660 --> 00:04:57,180
them on in your own infrastructure

133
00:04:57,180 --> 00:05:00,060
so starting out the internet is trouble

134
00:05:00,060 --> 00:05:02,520
so we know that going onto the Internet

135
00:05:02,520 --> 00:05:04,320
connecting to the internet having a

136
00:05:04,320 --> 00:05:06,180
business on the internet we will get all

137
00:05:06,180 --> 00:05:07,919
of these attacks and I have taken some

138
00:05:07,919 --> 00:05:09,840
of these numbers which are quite

139
00:05:09,840 --> 00:05:12,479
annoying quite big these are from

140
00:05:12,479 --> 00:05:14,580
netscout they show that they have seen

141
00:05:14,580 --> 00:05:16,680
an increase and we see an increase year

142
00:05:16,680 --> 00:05:19,199
after year of DDOS attacks we're also

143
00:05:19,199 --> 00:05:22,199
seeing that these detox attacks are huge

144
00:05:22,199 --> 00:05:25,440
so whenever I see a number like 612

145
00:05:25,440 --> 00:05:28,259
gigabits per second I definitely not

146
00:05:28,259 --> 00:05:30,060
have devices that can handle 600

147
00:05:30,060 --> 00:05:32,759
gigabits of traffic luckily my network

148
00:05:32,759 --> 00:05:34,979
is not getting attacked by 600 gigabits

149
00:05:34,979 --> 00:05:38,120
and often we can

150
00:05:38,240 --> 00:05:41,520
contact contact our isps and we can get

151
00:05:41,520 --> 00:05:43,979
services and some people also provide

152
00:05:43,979 --> 00:05:46,020
details protection like cloudflare and

153
00:05:46,020 --> 00:05:49,380
others so the biggest attacks we cannot

154
00:05:49,380 --> 00:05:51,600
handle ourselves but we can actually go

155
00:05:51,600 --> 00:05:53,639
a long way in protecting our networks

156
00:05:53,639 --> 00:05:55,740
and make them more robust towards the

157
00:05:55,740 --> 00:05:57,900
smaller attacks and also some of the

158
00:05:57,900 --> 00:06:01,320
smaller attacks are just a test to see

159
00:06:01,320 --> 00:06:04,139
how broken our networks are if we are a

160
00:06:04,139 --> 00:06:06,240
good choice for doing further attacks

161
00:06:06,240 --> 00:06:09,000
and doing further ransoming and the

162
00:06:09,000 --> 00:06:11,039
hijacking or doing other stuff on our

163
00:06:11,039 --> 00:06:13,380
networks we also see the number in red

164
00:06:13,380 --> 00:06:17,400
which is 453 million packets per second

165
00:06:17,400 --> 00:06:20,340
I'm going to be using this PPS the

166
00:06:20,340 --> 00:06:23,039
package per second as a rate of packets

167
00:06:23,039 --> 00:06:24,780
that are coming in over some kind of

168
00:06:24,780 --> 00:06:27,539
interface over a second and that can be

169
00:06:27,539 --> 00:06:30,000
in the millions if we're looking at a 10

170
00:06:30,000 --> 00:06:32,819
gigabit connection the maximum number of

171
00:06:32,819 --> 00:06:34,979
smallest package you can send on a 10

172
00:06:34,979 --> 00:06:38,880
gigabit is 14.8 million packets per

173
00:06:38,880 --> 00:06:41,220
second and usually your interfaces will

174
00:06:41,220 --> 00:06:42,960
not have this number of packets because

175
00:06:42,960 --> 00:06:44,940
you will have normal traffic you will

176
00:06:44,940 --> 00:06:48,000
have 15 bytes packets 1500 byte packets

177
00:06:48,000 --> 00:06:50,580
so you will be transferring actual data

178
00:06:50,580 --> 00:06:52,199
but if we're talking about a text

179
00:06:52,199 --> 00:06:54,720
sometimes the number of packets per

180
00:06:54,720 --> 00:06:57,479
second can become a problem before the

181
00:06:57,479 --> 00:07:00,419
bandwidth is exhausted so a 10 gigabit

182
00:07:00,419 --> 00:07:02,699
connection can be 10 gigabits of bytes

183
00:07:02,699 --> 00:07:04,100
but it can

184
00:07:04,100 --> 00:07:06,860
maximum B1 without

185
00:07:06,860 --> 00:07:10,440
14.8 million package per second so these

186
00:07:10,440 --> 00:07:11,780
numbers are

187
00:07:11,780 --> 00:07:14,100
interesting when we talk about doing

188
00:07:14,100 --> 00:07:16,620
DDOS attacks

189
00:07:16,620 --> 00:07:19,139
my advice is that we should not give up

190
00:07:19,139 --> 00:07:21,360
when we see these large numbers we

191
00:07:21,360 --> 00:07:23,220
should try to focus on our networks

192
00:07:23,220 --> 00:07:25,259
improve them as best as we can I think

193
00:07:25,259 --> 00:07:27,840
that's one of the foremost options and

194
00:07:27,840 --> 00:07:30,300
object objects for some of our security

195
00:07:30,300 --> 00:07:33,360
people like us we must do as good as we

196
00:07:33,360 --> 00:07:35,940
can with the resources that we have and

197
00:07:35,940 --> 00:07:37,620
sometimes you can do a lot with the

198
00:07:37,620 --> 00:07:40,139
resources that we have already

199
00:07:40,139 --> 00:07:43,020
I also have these definitions of

200
00:07:43,020 --> 00:07:45,120
firewalls and I'm trying to highlight

201
00:07:45,120 --> 00:07:46,740
some of the things that I think are

202
00:07:46,740 --> 00:07:49,080
interesting in these definitions of

203
00:07:49,080 --> 00:07:52,259
firewalls because going back to the

204
00:07:52,259 --> 00:07:53,819
first firewall book Cheswick and

205
00:07:53,819 --> 00:07:56,340
bellowin from 1994 they had this

206
00:07:56,340 --> 00:07:58,560
definition where they say a firewall is

207
00:07:58,560 --> 00:08:01,080
a collection of components and I think

208
00:08:01,080 --> 00:08:02,580
that's really interesting and that's how

209
00:08:02,580 --> 00:08:05,759
I view firewalls I was in a little bit

210
00:08:05,759 --> 00:08:07,080
of a Twitter discussion yesterday

211
00:08:07,080 --> 00:08:09,840
because talking to a vendor they say a

212
00:08:09,840 --> 00:08:12,000
firewall is this box when I talk to an

213
00:08:12,000 --> 00:08:14,460
Enterprise a firewall is this network of

214
00:08:14,460 --> 00:08:17,280
devices multiple components and they

215
00:08:17,280 --> 00:08:19,199
must obey to some kind of local security

216
00:08:19,199 --> 00:08:21,479
policy and I think that's very important

217
00:08:21,479 --> 00:08:23,220
and for a lot of our security work we

218
00:08:23,220 --> 00:08:24,660
have to do something designing and

219
00:08:24,660 --> 00:08:27,060
architecting like the keynote set and

220
00:08:27,060 --> 00:08:29,580
it's the same with networks we have to

221
00:08:29,580 --> 00:08:31,740
look at what we provide what we want to

222
00:08:31,740 --> 00:08:33,899
provide do we want to provide every

223
00:08:33,899 --> 00:08:36,599
protocol to the internet no we probably

224
00:08:36,599 --> 00:08:38,520
want to provide some web services with

225
00:08:38,520 --> 00:08:40,580
HTTP or

226
00:08:40,580 --> 00:08:43,320
80.443 but we do not want to provide

227
00:08:43,320 --> 00:08:45,720
ipsec to the whole internet so maybe we

228
00:08:45,720 --> 00:08:47,940
should do some configuration and do some

229
00:08:47,940 --> 00:08:50,279
local security policy designing and

230
00:08:50,279 --> 00:08:53,880
implement it in our Networks

231
00:08:53,880 --> 00:08:56,640
another definition is this one from

232
00:08:56,640 --> 00:08:58,920
definition of firewalls at Wikipedia and

233
00:08:58,920 --> 00:09:00,360
I really love that this one talks about

234
00:09:00,360 --> 00:09:03,180
a network security system so it's not

235
00:09:03,180 --> 00:09:05,600
just again a single device it's actually

236
00:09:05,600 --> 00:09:08,640
supporting devices multiple devices it's

237
00:09:08,640 --> 00:09:11,519
a complete system where you Monitor and

238
00:09:11,519 --> 00:09:13,500
then you can control the incoming but

239
00:09:13,500 --> 00:09:15,480
it's quite important to actually monitor

240
00:09:15,480 --> 00:09:16,920
and see what kind of traffic you

241
00:09:16,920 --> 00:09:19,200
normally have to be able to protect that

242
00:09:19,200 --> 00:09:21,779
traffic so ensuring that that traffic is

243
00:09:21,779 --> 00:09:24,000
passed and other traffic is turned away

244
00:09:24,000 --> 00:09:26,640
so I really love these definitions and

245
00:09:26,640 --> 00:09:28,740
that's actually how I like to view

246
00:09:28,740 --> 00:09:31,740
firewalls so in my opinion it's not

247
00:09:31,740 --> 00:09:33,959
necessarily a single device or a single

248
00:09:33,959 --> 00:09:36,779
cluster it's not a single component it's

249
00:09:36,779 --> 00:09:38,640
multiple components

250
00:09:38,640 --> 00:09:41,399
looking at the firewall in the vendor's

251
00:09:41,399 --> 00:09:44,279
eyes they will have these nice devices

252
00:09:44,279 --> 00:09:46,320
they will test out these devices they

253
00:09:46,320 --> 00:09:48,060
will optimize them they will Implement

254
00:09:48,060 --> 00:09:50,519
machine

255
00:09:50,519 --> 00:09:54,120
Hardware chips and Hardware layers to

256
00:09:54,120 --> 00:09:55,920
ensure that they can transport packets

257
00:09:55,920 --> 00:09:58,500
quickly they will Implement lots of

258
00:09:58,500 --> 00:10:00,779
features they will come out with version

259
00:10:00,779 --> 00:10:04,440
10 11 12 13 15. every year they have to

260
00:10:04,440 --> 00:10:06,600
come up with new features new marketing

261
00:10:06,600 --> 00:10:08,700
speak to be able to sell their new

262
00:10:08,700 --> 00:10:10,440
versions and it's fair enough here they

263
00:10:10,440 --> 00:10:11,820
have a commercial product they want to

264
00:10:11,820 --> 00:10:13,500
have features but sometimes commercial

265
00:10:13,500 --> 00:10:16,140
products are being oversold

266
00:10:16,140 --> 00:10:18,600
and when you look at the actual devices

267
00:10:18,600 --> 00:10:20,940
that they have they can use a testing

268
00:10:20,940 --> 00:10:23,339
generator a traffic generator they will

269
00:10:23,339 --> 00:10:25,200
buy some commercial ones that will do an

270
00:10:25,200 --> 00:10:28,140
imix what is an imix and imix is some

271
00:10:28,140 --> 00:10:30,180
kind of mix of internet traffic that

272
00:10:30,180 --> 00:10:31,800
doesn't really match anything that we

273
00:10:31,800 --> 00:10:33,600
have in our networks because your

274
00:10:33,600 --> 00:10:34,860
network will be different from my

275
00:10:34,860 --> 00:10:37,440
network so they can test their devices

276
00:10:37,440 --> 00:10:40,019
they can optimize their devices they can

277
00:10:40,019 --> 00:10:42,480
list the highest numbers of how many

278
00:10:42,480 --> 00:10:44,640
bits how many packets how many screens

279
00:10:44,640 --> 00:10:47,220
how many things they can Implement and

280
00:10:47,220 --> 00:10:49,260
that's all fine and nice and then they

281
00:10:49,260 --> 00:10:50,519
delivered it with a default

282
00:10:50,519 --> 00:10:52,220
configuration but the default

283
00:10:52,220 --> 00:10:54,839
configuration again will not suit your

284
00:10:54,839 --> 00:10:57,600
network I have had customers where a

285
00:10:57,600 --> 00:11:00,300
hundred thousand concurrent sessions is

286
00:11:00,300 --> 00:11:02,459
normal but I also have other customers

287
00:11:02,459 --> 00:11:04,620
where like 20 000 concurrent sessions

288
00:11:04,620 --> 00:11:07,920
would be just over the top uh too much

289
00:11:07,920 --> 00:11:11,040
too many concurrent sessions so you have

290
00:11:11,040 --> 00:11:13,560
to tune your devices and they have the

291
00:11:13,560 --> 00:11:16,140
documentation but they also have really

292
00:11:16,140 --> 00:11:18,300
sorry shitty configuration and

293
00:11:18,300 --> 00:11:20,100
configurations listed online sometimes

294
00:11:20,100 --> 00:11:22,500
especially the VPN area they are still

295
00:11:22,500 --> 00:11:24,660
listing configurations with triple disks

296
00:11:24,660 --> 00:11:27,060
and this which is like oh no we're not

297
00:11:27,060 --> 00:11:28,740
going to implement cerebral test in VPN

298
00:11:28,740 --> 00:11:31,860
today so be aware that a firewall in the

299
00:11:31,860 --> 00:11:33,540
vendor's eyes is typically some kind of

300
00:11:33,540 --> 00:11:35,940
device they have optimized and they say

301
00:11:35,940 --> 00:11:38,820
that this device can do everything

302
00:11:38,820 --> 00:11:42,060
and I I took this quote so that's not my

303
00:11:42,060 --> 00:11:44,760
words but it's like can your firewall

304
00:11:44,760 --> 00:11:47,279
Flex in the face of change like what

305
00:11:47,279 --> 00:11:49,380
what I don't need a firewall that can

306
00:11:49,380 --> 00:11:51,720
Flex it's just I want a device that can

307
00:11:51,720 --> 00:11:52,920
perform good

308
00:11:52,920 --> 00:11:55,380
looking at it into into the internal

309
00:11:55,380 --> 00:11:57,779
Enterprise mindset I would consider it

310
00:11:57,779 --> 00:12:00,600
more like we have a firewall people say

311
00:12:00,600 --> 00:12:02,100
we have a firewall we may have a

312
00:12:02,100 --> 00:12:03,720
firewall administrator a group of people

313
00:12:03,720 --> 00:12:06,300
that will configure the firewall then we

314
00:12:06,300 --> 00:12:07,500
have another group which is the

315
00:12:07,500 --> 00:12:09,720
networking group we have another group

316
00:12:09,720 --> 00:12:11,519
which is the application developers we

317
00:12:11,519 --> 00:12:13,019
may even have some people doing load

318
00:12:13,019 --> 00:12:15,300
balancing and we should talk much more

319
00:12:15,300 --> 00:12:17,940
together in these groups we should talk

320
00:12:17,940 --> 00:12:20,360
about creating some kind of coherent

321
00:12:20,360 --> 00:12:22,860
infrastructure that can protect our

322
00:12:22,860 --> 00:12:25,680
services so sometimes after doing these

323
00:12:25,680 --> 00:12:27,720
details testing we have had meetings

324
00:12:27,720 --> 00:12:31,200
with 13 people from the ISP and all the

325
00:12:31,200 --> 00:12:33,300
way to the application developer talking

326
00:12:33,300 --> 00:12:35,640
to all of these people all the way in

327
00:12:35,640 --> 00:12:38,040
the chain between our services on the

328
00:12:38,040 --> 00:12:39,480
internet and all the applications that

329
00:12:39,480 --> 00:12:42,240
we put on the internet so a firewall

330
00:12:42,240 --> 00:12:44,940
should also be seen as more than these

331
00:12:44,940 --> 00:12:46,680
devices that we have bought that are

332
00:12:46,680 --> 00:12:48,779
protecting our internal networks on a

333
00:12:48,779 --> 00:12:50,940
magical way

334
00:12:50,940 --> 00:12:53,639
when we say these vendors suggest that

335
00:12:53,639 --> 00:12:55,860
you can do everything in a box they can

336
00:12:55,860 --> 00:12:58,260
of course do everything in software

337
00:12:58,260 --> 00:13:00,300
and that's an important part because

338
00:13:00,300 --> 00:13:03,120
some parts can be done in Hardware some

339
00:13:03,120 --> 00:13:05,579
parts needs to be done in software and

340
00:13:05,579 --> 00:13:07,320
especially if we're getting to the less

341
00:13:07,320 --> 00:13:09,779
used features they will be implemented

342
00:13:09,779 --> 00:13:11,940
in software where they may have been

343
00:13:11,940 --> 00:13:15,540
optimized for the common case of say TCP

344
00:13:15,540 --> 00:13:20,160
Port AG 4.43 so TLS acceleration and

345
00:13:20,160 --> 00:13:22,380
stuff and all of these things may be

346
00:13:22,380 --> 00:13:25,560
implemented partly in Hardware but some

347
00:13:25,560 --> 00:13:27,300
things will be implemented in software

348
00:13:27,300 --> 00:13:29,399
and guess what happens if you send a lot

349
00:13:29,399 --> 00:13:30,959
of packets to what parts that are

350
00:13:30,959 --> 00:13:33,480
running in software they will break

351
00:13:33,480 --> 00:13:34,860
easily

352
00:13:34,860 --> 00:13:37,800
so my view again is that your

353
00:13:37,800 --> 00:13:39,300
infrastructure is based on multiple

354
00:13:39,300 --> 00:13:42,240
components and devices and I would

355
00:13:42,240 --> 00:13:44,399
appreciate if we could start configuring

356
00:13:44,399 --> 00:13:46,380
them better like using some kind of

357
00:13:46,380 --> 00:13:48,180
defense and depth in the network space

358
00:13:48,180 --> 00:13:51,480
in the firewall space and for me it's

359
00:13:51,480 --> 00:13:54,420
about where are the bottlenecks because

360
00:13:54,420 --> 00:13:56,700
there will always be a bottleneck you

361
00:13:56,700 --> 00:13:58,560
will never have a network that can

362
00:13:58,560 --> 00:14:01,740
handle these huge shoot attacks you will

363
00:14:01,740 --> 00:14:03,420
have networks that have a bottleneck

364
00:14:03,420 --> 00:14:06,600
somewhere but we can increase the

365
00:14:06,600 --> 00:14:09,240
configuration robustness so we can

366
00:14:09,240 --> 00:14:11,339
handle higher loads

367
00:14:11,339 --> 00:14:14,399
this is kind of a generic drawing a

368
00:14:14,399 --> 00:14:16,200
sample Network drawing showing some kind

369
00:14:16,200 --> 00:14:17,820
of internet connections at the top some

370
00:14:17,820 --> 00:14:19,680
kind of routers some kind of Security

371
00:14:19,680 --> 00:14:21,959
Services what we traditionally would

372
00:14:21,959 --> 00:14:23,820
call a firewall device a firewall

373
00:14:23,820 --> 00:14:26,279
component we have some switches we have

374
00:14:26,279 --> 00:14:28,560
some load balances we have all sorts of

375
00:14:28,560 --> 00:14:31,200
devices and looking at each of these

376
00:14:31,200 --> 00:14:33,300
devices the specs say they can handle

377
00:14:33,300 --> 00:14:36,060
student floating nice nice how much can

378
00:14:36,060 --> 00:14:38,639
they handle can they handle it all while

379
00:14:38,639 --> 00:14:40,260
doing all the other things that are

380
00:14:40,260 --> 00:14:41,820
listed on the spec at the same time

381
00:14:41,820 --> 00:14:43,980
probably not

382
00:14:43,980 --> 00:14:46,380
I will focus today on some of the lower

383
00:14:46,380 --> 00:14:48,779
layer attacks but they are of course

384
00:14:48,779 --> 00:14:50,940
also higher layer attacks like slow

385
00:14:50,940 --> 00:14:53,519
lorries and web attacks and we can do a

386
00:14:53,519 --> 00:14:55,440
lot of things in the HTTP space we can

387
00:14:55,440 --> 00:14:57,660
find a big file on your website we can

388
00:14:57,660 --> 00:14:59,279
request that file again and again and

389
00:14:59,279 --> 00:15:01,500
again essentially filling up the

390
00:15:01,500 --> 00:15:03,480
bandwidth from the inside that can is

391
00:15:03,480 --> 00:15:05,399
also one of the ways we can do it but I

392
00:15:05,399 --> 00:15:07,500
will focus mostly on the lower layers

393
00:15:07,500 --> 00:15:09,060
today

394
00:15:09,060 --> 00:15:11,760
also the things that I say today I'm

395
00:15:11,760 --> 00:15:14,519
trying to consider actions and

396
00:15:14,519 --> 00:15:17,760
configurations and advice that will not

397
00:15:17,760 --> 00:15:19,740
lose functionality for your services

398
00:15:19,740 --> 00:15:22,260
that will not be an administrative

399
00:15:22,260 --> 00:15:24,959
nightmare afterwards because if it's too

400
00:15:24,959 --> 00:15:27,300
complex afterwards it will also not be

401
00:15:27,300 --> 00:15:29,220
used and you will have to remove it

402
00:15:29,220 --> 00:15:30,959
again so hopefully it will be

403
00:15:30,959 --> 00:15:33,300
practically good advice that you can

404
00:15:33,300 --> 00:15:35,279
actually use in your own networks

405
00:15:35,279 --> 00:15:37,800
hopefully

406
00:15:37,800 --> 00:15:39,720
talking about availability Network

407
00:15:39,720 --> 00:15:43,560
flooding DDOS going a step down into

408
00:15:43,560 --> 00:15:46,260
what they really are we all know about a

409
00:15:46,260 --> 00:15:48,240
sun plot hopefully it's something that

410
00:15:48,240 --> 00:15:50,760
have been used many many years ago on

411
00:15:50,760 --> 00:15:52,920
large portals being brought down by

412
00:15:52,920 --> 00:15:55,740
what's the 15 or 14 year old Mafia boy

413
00:15:55,740 --> 00:15:57,660
doing Sun flooding for the first time on

414
00:15:57,660 --> 00:15:59,820
a large scale and today we still have

415
00:15:59,820 --> 00:16:01,800
some flooding because it's quite easy to

416
00:16:01,800 --> 00:16:03,899
perform and it's the most basic and it's

417
00:16:03,899 --> 00:16:07,199
very common and we have TCP services on

418
00:16:07,199 --> 00:16:09,300
the internet so yes student flooding

419
00:16:09,300 --> 00:16:11,279
will definitely be there we're also

420
00:16:11,279 --> 00:16:13,380
seeing a lot of icmp and UDP flooding

421
00:16:13,380 --> 00:16:16,620
and for all of these tcps icmp and UDP

422
00:16:16,620 --> 00:16:19,139
we're also seeing amplification attacks

423
00:16:19,139 --> 00:16:20,399
where you're sending some kind of

424
00:16:20,399 --> 00:16:22,680
request that creates a larger response

425
00:16:22,680 --> 00:16:25,380
and with a spoofed source address you

426
00:16:25,380 --> 00:16:27,660
can do an amplification as an attacker

427
00:16:27,660 --> 00:16:29,940
towards aside so even if you do not have

428
00:16:29,940 --> 00:16:31,680
large bandwidth you can use a lot of

429
00:16:31,680 --> 00:16:34,320
amplification sources so we are seeing

430
00:16:34,320 --> 00:16:37,920
these basic ones a lot on the internet

431
00:16:37,920 --> 00:16:40,860
looking at the DDOS from my perspective

432
00:16:40,860 --> 00:16:43,620
because I'm a security person I want to

433
00:16:43,620 --> 00:16:45,600
ensure that my customers networks and

434
00:16:45,600 --> 00:16:47,279
the networks that I built have

435
00:16:47,279 --> 00:16:49,800
resistance against all of it I also go

436
00:16:49,800 --> 00:16:52,079
into other special packets other special

437
00:16:52,079 --> 00:16:54,959
protocols and my advice is of course we

438
00:16:54,959 --> 00:16:56,579
should be able to test all of the

439
00:16:56,579 --> 00:16:59,160
protocols or we should turn away some of

440
00:16:59,160 --> 00:17:01,800
the protocols configures out of having

441
00:17:01,800 --> 00:17:04,859
to handle some of these more exotic

442
00:17:04,859 --> 00:17:06,540
protocols that we're not really using

443
00:17:06,540 --> 00:17:08,520
anymore and you know your own networks

444
00:17:08,520 --> 00:17:10,559
so you know which protocols and package

445
00:17:10,559 --> 00:17:13,319
to allow but some of these Protocols are

446
00:17:13,319 --> 00:17:15,059
not being used in your network so turn

447
00:17:15,059 --> 00:17:17,880
them away at the front door

448
00:17:17,880 --> 00:17:19,919
generically speaking all of these

449
00:17:19,919 --> 00:17:22,140
flooding attacks try to abuse some kind

450
00:17:22,140 --> 00:17:25,260
of resource it can be memory space when

451
00:17:25,260 --> 00:17:27,059
we talk about memory space it can be in

452
00:17:27,059 --> 00:17:29,040
all of these different places like in

453
00:17:29,040 --> 00:17:31,799
the kernel in the TCP State table it can

454
00:17:31,799 --> 00:17:34,440
be in the firewall State table number of

455
00:17:34,440 --> 00:17:36,780
concurrent sessions connections it can

456
00:17:36,780 --> 00:17:38,820
be all of these parameters that

457
00:17:38,820 --> 00:17:40,980
sometimes you can increase like I'm

458
00:17:40,980 --> 00:17:43,440
using openbsdpf and I can easily set the

459
00:17:43,440 --> 00:17:46,080
concurrent number of decisions to 1

460
00:17:46,080 --> 00:17:48,720
million instead which is nice but you

461
00:17:48,720 --> 00:17:50,520
need to configure it in some cases and

462
00:17:50,520 --> 00:17:53,039
in some cases there is just a maximum

463
00:17:53,039 --> 00:17:54,299
that you can sit

464
00:17:54,299 --> 00:17:57,440
we also have more Hardware related

465
00:17:57,440 --> 00:18:01,260
limitations in what we're using like the

466
00:18:01,260 --> 00:18:02,580
network cards have some kind of

467
00:18:02,580 --> 00:18:04,500
interrupt processing the number of

468
00:18:04,500 --> 00:18:06,419
packets that they can handle we have

469
00:18:06,419 --> 00:18:09,000
CPUs in our devices which also have a

470
00:18:09,000 --> 00:18:11,400
limitation in what they can do with

471
00:18:11,400 --> 00:18:14,820
package with data so a CPU processing a

472
00:18:14,820 --> 00:18:17,340
packet can be really hard and I will

473
00:18:17,340 --> 00:18:20,039
show a drawing a little bit later today

474
00:18:20,039 --> 00:18:21,840
also bandwidth of course if we're

475
00:18:21,840 --> 00:18:23,760
filling up the bandwidth it's over it's

476
00:18:23,760 --> 00:18:26,580
game over and usually I would consider

477
00:18:26,580 --> 00:18:28,559
having a 10 gigabit connection as the

478
00:18:28,559 --> 00:18:31,740
least the lowest uh what you call the

479
00:18:31,740 --> 00:18:33,360
number of bandwidth for some kind of

480
00:18:33,360 --> 00:18:35,460
server setup because that will allow you

481
00:18:35,460 --> 00:18:40,140
a little bit of a gap to to at least

482
00:18:40,140 --> 00:18:43,860
take the smaller attacks so if it's the

483
00:18:43,860 --> 00:18:46,020
neighbor's boy trying to do a bandwidth

484
00:18:46,020 --> 00:18:47,700
attack on you with a two three five

485
00:18:47,700 --> 00:18:50,520
gigabit attack it won't hurt your 10

486
00:18:50,520 --> 00:18:53,100
gigabit connection but if we go over 10

487
00:18:53,100 --> 00:18:55,020
gigabit connection attacks of course

488
00:18:55,020 --> 00:18:57,120
they can be filled up

489
00:18:57,120 --> 00:18:59,160
typically on the internet they're also

490
00:18:59,160 --> 00:19:02,760
using spoofed sources but usually when

491
00:19:02,760 --> 00:19:04,620
testing I do not recommend to use

492
00:19:04,620 --> 00:19:07,440
spoofed sources I would rather the exact

493
00:19:07,440 --> 00:19:10,020
Source show up in the locks so we can

494
00:19:10,020 --> 00:19:12,360
also train all the response on the back

495
00:19:12,360 --> 00:19:14,400
side of all of this so doing this

496
00:19:14,400 --> 00:19:15,960
testing is actually not just for the

497
00:19:15,960 --> 00:19:17,760
network people the firewall people but

498
00:19:17,760 --> 00:19:20,280
it's also for the responding two attacks

499
00:19:20,280 --> 00:19:22,260
on the internet because the same

500
00:19:22,260 --> 00:19:24,419
symptoms as received while doing this

501
00:19:24,419 --> 00:19:26,820
testing will show up if we meet a real

502
00:19:26,820 --> 00:19:28,620
Attack on the internet

503
00:19:28,620 --> 00:19:31,140
this is a drawing that I took from the

504
00:19:31,140 --> 00:19:33,419
traffic processing on SRX series devices

505
00:19:33,419 --> 00:19:35,880
from junos Juniper Networks it's one of

506
00:19:35,880 --> 00:19:37,980
the firewalls that I know very well and

507
00:19:37,980 --> 00:19:39,900
looking at this this is what it actually

508
00:19:39,900 --> 00:19:42,720
does for every single packet that

509
00:19:42,720 --> 00:19:45,539
arrives at the firewall interface so

510
00:19:45,539 --> 00:19:48,000
there's like 15 different boxes it can

511
00:19:48,000 --> 00:19:50,400
go through while being processed in the

512
00:19:50,400 --> 00:19:52,200
firewall even if some of this is

513
00:19:52,200 --> 00:19:54,600
handling Hardware some of it is being

514
00:19:54,600 --> 00:19:57,179
handled in in software and some of it

515
00:19:57,179 --> 00:19:59,640
may be deferred to the CPU if it has

516
00:19:59,640 --> 00:20:02,700
some specific characteristics and guess

517
00:20:02,700 --> 00:20:04,679
what we can try to mimic that

518
00:20:04,679 --> 00:20:06,720
characteristics so we make more things

519
00:20:06,720 --> 00:20:08,880
go to the software and that will hurt

520
00:20:08,880 --> 00:20:11,520
the firewall even more so the less we

521
00:20:11,520 --> 00:20:13,740
can put into the firewall device the

522
00:20:13,740 --> 00:20:15,980
better

523
00:20:16,140 --> 00:20:19,020
going into some real networks or the

524
00:20:19,020 --> 00:20:21,299
networks that you may have it all boiled

525
00:20:21,299 --> 00:20:22,980
down to you have some kind of internet

526
00:20:22,980 --> 00:20:24,840
connection you will have some kind of

527
00:20:24,840 --> 00:20:27,720
routing device this routing device may

528
00:20:27,720 --> 00:20:29,640
be a provider routing device or it may

529
00:20:29,640 --> 00:20:32,640
be your own routing device no matter

530
00:20:32,640 --> 00:20:34,679
what kind of device it is it usually

531
00:20:34,679 --> 00:20:36,240
will have some kind of control plane

532
00:20:36,240 --> 00:20:37,980
which is where you do the configuration

533
00:20:37,980 --> 00:20:40,020
and then it will have a data plane a

534
00:20:40,020 --> 00:20:42,059
forwarding plane where it will process

535
00:20:42,059 --> 00:20:43,440
all these packets that are coming

536
00:20:43,440 --> 00:20:46,200
through the router these devices are

537
00:20:46,200 --> 00:20:48,380
actually very very nice they're built on

538
00:20:48,380 --> 00:20:51,720
pdfpgas and chips that they have

539
00:20:51,720 --> 00:20:53,520
designed and switching chips routing

540
00:20:53,520 --> 00:20:55,860
chips and so on and they can handle wire

541
00:20:55,860 --> 00:20:58,500
speed so they can handle a 10 gigabit

542
00:20:58,500 --> 00:21:00,360
connection they can handle a 100 gigabit

543
00:21:00,360 --> 00:21:02,100
connection soon they will be able to

544
00:21:02,100 --> 00:21:04,679
handle a 400 gigabit connection 800

545
00:21:04,679 --> 00:21:06,720
gigabit connection so it will be very

546
00:21:06,720 --> 00:21:08,520
nice to have like a 600 gigabit

547
00:21:08,520 --> 00:21:11,220
connection and then getting 600 gigabits

548
00:21:11,220 --> 00:21:12,900
to your firewall good luck with that

549
00:21:12,900 --> 00:21:15,539
good luck with getting a price quotation

550
00:21:15,539 --> 00:21:19,080
for 600 gigabit connection firewall so

551
00:21:19,080 --> 00:21:21,419
the firewall on the back side of that

552
00:21:21,419 --> 00:21:23,820
routing device will typically also today

553
00:21:23,820 --> 00:21:26,220
have a control plane data plane again

554
00:21:26,220 --> 00:21:28,080
can do some things in hardware and some

555
00:21:28,080 --> 00:21:29,580
things in software

556
00:21:29,580 --> 00:21:31,679
when we're looking at these networks we

557
00:21:31,679 --> 00:21:33,480
want to find what I call pressure points

558
00:21:33,480 --> 00:21:35,280
and we want to find the scope for doing

559
00:21:35,280 --> 00:21:37,380
this testing and usually you will have

560
00:21:37,380 --> 00:21:39,659
some kind of Link net which links the

561
00:21:39,659 --> 00:21:41,460
devices together and then you will have

562
00:21:41,460 --> 00:21:44,100
some kind of announced Network which I

563
00:21:44,100 --> 00:21:46,620
call the hosting Network here so for

564
00:21:46,620 --> 00:21:49,740
ipv4 and IPv6 you will have a linknet

565
00:21:49,740 --> 00:21:51,720
which is typically very small and then

566
00:21:51,720 --> 00:21:53,640
you will have a larger Network some kind

567
00:21:53,640 --> 00:21:56,280
of space that you have bought or

568
00:21:56,280 --> 00:21:58,020
allocated earlier I have a thousand

569
00:21:58,020 --> 00:22:00,419
addresses for my small company and I

570
00:22:00,419 --> 00:22:03,960
have a small slash 29 link knit and for

571
00:22:03,960 --> 00:22:06,120
this DDOS testing it's actually quite

572
00:22:06,120 --> 00:22:08,340
interesting to also look at the linknet

573
00:22:08,340 --> 00:22:10,500
looking at the devices in front because

574
00:22:10,500 --> 00:22:12,059
some of the providers at least in

575
00:22:12,059 --> 00:22:13,679
Denmark they're not very good at

576
00:22:13,679 --> 00:22:16,320
configuring these devices securely so

577
00:22:16,320 --> 00:22:19,200
they may have ports open on these

578
00:22:19,200 --> 00:22:21,419
control planes they may have protocols

579
00:22:21,419 --> 00:22:24,000
open like bgp the routing protocol open

580
00:22:24,000 --> 00:22:26,220
on this device so you will be able to

581
00:22:26,220 --> 00:22:27,659
attack the router in front of the

582
00:22:27,659 --> 00:22:29,340
network and what happens to the service

583
00:22:29,340 --> 00:22:31,679
on on the network if you hit the router

584
00:22:31,679 --> 00:22:34,860
in front then it goes down it reboots it

585
00:22:34,860 --> 00:22:37,799
breaks the pgp channel connection then

586
00:22:37,799 --> 00:22:40,740
the networks is unreachable so typically

587
00:22:40,740 --> 00:22:43,799
I will attack all of these IP addresses

588
00:22:43,799 --> 00:22:45,960
listed on this that would be the scope

589
00:22:45,960 --> 00:22:47,940
of the test

590
00:22:47,940 --> 00:22:49,860
then I would use something like nmap

591
00:22:49,860 --> 00:22:52,020
nmap is a great tool you probably know

592
00:22:52,020 --> 00:22:55,380
it all of you I would port scan the

593
00:22:55,380 --> 00:22:58,260
whole linknet for ipv4 I would ask about

594
00:22:58,260 --> 00:23:01,260
the IPv6 ranges because IPv6 space is so

595
00:23:01,260 --> 00:23:03,659
large so I would ask which networks are

596
00:23:03,659 --> 00:23:07,860
in use which IP addresses are in use

597
00:23:07,860 --> 00:23:11,640
that would lead back to a number of IP

598
00:23:11,640 --> 00:23:13,200
addresses that are active on this

599
00:23:13,200 --> 00:23:15,600
network you will have some services that

600
00:23:15,600 --> 00:23:17,760
you care about you will have some

601
00:23:17,760 --> 00:23:20,100
development services or testing service

602
00:23:20,100 --> 00:23:22,679
that you do not care much about but some

603
00:23:22,679 --> 00:23:24,480
of these Services can be used for

604
00:23:24,480 --> 00:23:26,520
checking service checking that the

605
00:23:26,520 --> 00:23:28,740
network is up so we can use some of

606
00:23:28,740 --> 00:23:30,539
these services that you have found to

607
00:23:30,539 --> 00:23:33,240
verify if the connection is up if the

608
00:23:33,240 --> 00:23:34,919
network is running is the firewall

609
00:23:34,919 --> 00:23:36,780
running and then you can have some

610
00:23:36,780 --> 00:23:39,960
specific checks on the HTTP being

611
00:23:39,960 --> 00:23:41,760
attacked or whatever service you're

612
00:23:41,760 --> 00:23:43,919
running that is important for you so I

613
00:23:43,919 --> 00:23:47,059
will try to find a create a list of the

614
00:23:47,059 --> 00:23:49,380
ports and the protocols that I can

615
00:23:49,380 --> 00:23:51,720
attack and which one should keep on

616
00:23:51,720 --> 00:23:54,120
responding if even if some service is

617
00:23:54,120 --> 00:23:56,100
down so if the application goes down and

618
00:23:56,100 --> 00:23:58,140
does not respond I can still check if

619
00:23:58,140 --> 00:23:59,820
the router and the firewall is still

620
00:23:59,820 --> 00:24:02,039
running and if there's any latency

621
00:24:02,039 --> 00:24:04,200
changes so putting on some kind of

622
00:24:04,200 --> 00:24:06,780
monitoring on these is the next step in

623
00:24:06,780 --> 00:24:08,940
the DDOS testing and typically I would

624
00:24:08,940 --> 00:24:11,100
advise that you do the testing at night

625
00:24:11,100 --> 00:24:13,559
we start typically the testing at 2200

626
00:24:13,559 --> 00:24:15,600
and then run all through the night until

627
00:24:15,600 --> 00:24:17,460
five or six in the morning that will

628
00:24:17,460 --> 00:24:19,919
give you you a nice window like eight

629
00:24:19,919 --> 00:24:22,020
hours where you can do the testing and

630
00:24:22,020 --> 00:24:24,240
not hurt production a lot if you have a

631
00:24:24,240 --> 00:24:25,679
service that needs to run during the

632
00:24:25,679 --> 00:24:28,500
night like Netflix it may be a bad time

633
00:24:28,500 --> 00:24:31,080
but find a time that is suitable for

634
00:24:31,080 --> 00:24:34,799
breakage because there will be breakage

635
00:24:34,799 --> 00:24:37,380
I usually set up this testing a week

636
00:24:37,380 --> 00:24:40,140
before so I get these nice green graphs

637
00:24:40,140 --> 00:24:42,240
this is a tool called Smoke ping which

638
00:24:42,240 --> 00:24:44,400
is very nice for showing both the number

639
00:24:44,400 --> 00:24:46,740
of probes that are lost in this case

640
00:24:46,740 --> 00:24:48,480
there are no lost probes so it's green

641
00:24:48,480 --> 00:24:51,600
zero lost probes it also shows with the

642
00:24:51,600 --> 00:24:53,940
graph with the bar if there's latency

643
00:24:53,940 --> 00:24:56,280
changes in a lot of these probes so it's

644
00:24:56,280 --> 00:24:59,159
sending 20 probes every five minutes by

645
00:24:59,159 --> 00:25:01,500
default but usually for DDOS testing I

646
00:25:01,500 --> 00:25:03,059
would turn it down to checking every

647
00:25:03,059 --> 00:25:05,419
minute so I quickly can see if somebody

648
00:25:05,419 --> 00:25:08,640
something's changed I also use an

649
00:25:08,640 --> 00:25:10,440
external service and that's very nice to

650
00:25:10,440 --> 00:25:12,539
have a third party verifying if a

651
00:25:12,539 --> 00:25:14,700
service is down so it's not just my

652
00:25:14,700 --> 00:25:17,100
testing tools from where I do the test

653
00:25:17,100 --> 00:25:19,679
it's not just my testing tools from my

654
00:25:19,679 --> 00:25:21,539
home where I typically sit during night

655
00:25:21,539 --> 00:25:24,419
to do this testing it's also a third

656
00:25:24,419 --> 00:25:27,120
party which like pingdom can check from

657
00:25:27,120 --> 00:25:29,700
multiple countries multiple places on

658
00:25:29,700 --> 00:25:31,500
the internet so it's a very nice

659
00:25:31,500 --> 00:25:34,740
verification having this DDOS test this

660
00:25:34,740 --> 00:25:37,200
one is checking an HTTP and showing that

661
00:25:37,200 --> 00:25:40,140
it is green running up to the test so if

662
00:25:40,140 --> 00:25:42,360
it's an unstable service it doesn't

663
00:25:42,360 --> 00:25:43,860
really make sense to check it because

664
00:25:43,860 --> 00:25:45,299
then you cannot really see if it's

665
00:25:45,299 --> 00:25:47,520
unstable and therefore it's unavailable

666
00:25:47,520 --> 00:25:49,200
or if it's the testing that makes it

667
00:25:49,200 --> 00:25:51,419
unavailable so these are the ones that I

668
00:25:51,419 --> 00:25:53,820
use and I'm not really recommending ping

669
00:25:53,820 --> 00:25:55,679
dumb you can use whatever you like and

670
00:25:55,679 --> 00:25:57,240
that also goes for any other product

671
00:25:57,240 --> 00:25:59,700
names that I listed like the Juniper SRX

672
00:25:59,700 --> 00:26:02,400
is you have to evaluate by yourself if

673
00:26:02,400 --> 00:26:05,460
you want to use those products

674
00:26:05,460 --> 00:26:10,380
so we have now used nmap we have we have

675
00:26:10,380 --> 00:26:11,940
not used in map yet because I will show

676
00:26:11,940 --> 00:26:13,740
some of the commands but we will use

677
00:26:13,740 --> 00:26:16,740
nmap we will use some specific options

678
00:26:16,740 --> 00:26:18,779
that are not very Advanced that will

679
00:26:18,779 --> 00:26:21,960
give us a list of endpoints ports

680
00:26:21,960 --> 00:26:24,360
protocols some of them we will use for

681
00:26:24,360 --> 00:26:26,520
attacking some of them we will use for

682
00:26:26,520 --> 00:26:28,980
verification if the network is up some

683
00:26:28,980 --> 00:26:31,020
of them will show if the application

684
00:26:31,020 --> 00:26:34,380
goes down when we do the testing so the

685
00:26:34,380 --> 00:26:36,480
one two three on this slide is that we

686
00:26:36,480 --> 00:26:38,820
want to use nmap port scan the network

687
00:26:38,820 --> 00:26:41,700
setup monitoring not shown and then run

688
00:26:41,700 --> 00:26:44,940
tools that are called hping 3 and t50

689
00:26:44,940 --> 00:26:47,580
these two packet generators are some

690
00:26:47,580 --> 00:26:49,200
that I have used for I guess more than

691
00:26:49,200 --> 00:26:51,539
10 years I'm really happy about these

692
00:26:51,539 --> 00:26:53,100
I'm really happy that they are open

693
00:26:53,100 --> 00:26:56,760
source uh they are very uh what you call

694
00:26:56,760 --> 00:26:59,520
it well suited for this testing because

695
00:26:59,520 --> 00:27:02,220
the hp3 can actually allow us to turn up

696
00:27:02,220 --> 00:27:04,860
and down the speed of the testing which

697
00:27:04,860 --> 00:27:08,039
will become important very quickly you

698
00:27:08,039 --> 00:27:10,320
should expect things to break something

699
00:27:10,320 --> 00:27:12,840
will break I have a bit of findings at

700
00:27:12,840 --> 00:27:14,720
the end some things that have been

701
00:27:14,720 --> 00:27:17,100
surprising when you do the test because

702
00:27:17,100 --> 00:27:19,679
you are expecting the firewall and the

703
00:27:19,679 --> 00:27:21,840
route and the application to go down but

704
00:27:21,840 --> 00:27:23,520
sometimes you have some consequences

705
00:27:23,520 --> 00:27:27,000
saying if the firewall goes down oh then

706
00:27:27,000 --> 00:27:28,860
the database connection from the web

707
00:27:28,860 --> 00:27:30,659
application through the same firewall

708
00:27:30,659 --> 00:27:33,960
goes down and we also measure if the

709
00:27:33,960 --> 00:27:35,640
applications and the network returns

710
00:27:35,640 --> 00:27:37,679
back to normal and in this case with

711
00:27:37,679 --> 00:27:39,419
this customer with a database connection

712
00:27:39,419 --> 00:27:41,279
over the firewall the database

713
00:27:41,279 --> 00:27:43,740
connection had to be initiated manually

714
00:27:43,740 --> 00:27:46,740
again so for every test that failed made

715
00:27:46,740 --> 00:27:49,559
the firewall overloaded we they had to

716
00:27:49,559 --> 00:27:51,419
manually re-enable that database

717
00:27:51,419 --> 00:27:53,039
connection now that's really bad if it

718
00:27:53,039 --> 00:27:55,020
happens at three in the night or during

719
00:27:55,020 --> 00:27:56,460
the middle of the day and people are not

720
00:27:56,460 --> 00:27:59,100
aware that it's down how to get it up

721
00:27:59,100 --> 00:28:01,080
and running again how to initiate that

722
00:28:01,080 --> 00:28:02,640
database connection over the same

723
00:28:02,640 --> 00:28:05,400
firewall so a lot of consequences when

724
00:28:05,400 --> 00:28:07,980
we do this testing

725
00:28:07,980 --> 00:28:09,960
I have some hints

726
00:28:09,960 --> 00:28:12,059
throughout the slideshow so they're

727
00:28:12,059 --> 00:28:14,520
marked with hint colon save the scope in

728
00:28:14,520 --> 00:28:16,860
variables so instead of having to type

729
00:28:16,860 --> 00:28:19,260
an IP address at three in the morning

730
00:28:19,260 --> 00:28:22,620
and Mist typing an IP address that's bad

731
00:28:22,620 --> 00:28:25,980
if you just start detosing the NSA or in

732
00:28:25,980 --> 00:28:28,620
my country the the police or some

733
00:28:28,620 --> 00:28:31,679
military installation so my hint is to

734
00:28:31,679 --> 00:28:34,559
export the customer net 4 into some

735
00:28:34,559 --> 00:28:36,900
variable the customer net 6 into some

736
00:28:36,900 --> 00:28:38,820
variable then you can use these

737
00:28:38,820 --> 00:28:41,100
variables in all sorts of scripting all

738
00:28:41,100 --> 00:28:43,320
sorts of copy paste commands you can

739
00:28:43,320 --> 00:28:45,960
repeat the commands you can be sure that

740
00:28:45,960 --> 00:28:47,820
you are not attacking the wrong target

741
00:28:47,820 --> 00:28:51,179
so carefully enter the IP address into a

742
00:28:51,179 --> 00:28:53,340
variable and that will be used for the

743
00:28:53,340 --> 00:28:56,178
rest of the presentation

744
00:28:57,500 --> 00:29:01,320
I said to use nmap and I said to to a

745
00:29:01,320 --> 00:29:04,620
full scan of the link net so this is

746
00:29:04,620 --> 00:29:06,779
just the nmap commands for doing a full

747
00:29:06,779 --> 00:29:09,960
TCP scan on ipv4 on the customer Network

748
00:29:09,960 --> 00:29:12,720
and in my case it just shows Port 80 and

749
00:29:12,720 --> 00:29:16,020
443 very common ports so they these will

750
00:29:16,020 --> 00:29:17,400
be the ones that we will typically

751
00:29:17,400 --> 00:29:20,279
attack we will also attack others we

752
00:29:20,279 --> 00:29:22,620
will also send other protocols but they

753
00:29:22,620 --> 00:29:24,419
may be the main targets that you care

754
00:29:24,419 --> 00:29:26,760
about and likewise you would do the same

755
00:29:26,760 --> 00:29:28,580
on IPv6

756
00:29:28,580 --> 00:29:32,520
maybe I forgot to actually add the -6 I

757
00:29:32,520 --> 00:29:34,200
don't remember if in map I think nmap

758
00:29:34,200 --> 00:29:36,539
needs a minor six for the IPv6 sorry for

759
00:29:36,539 --> 00:29:38,220
that I should have tested the command

760
00:29:38,220 --> 00:29:42,960
but it can do IPv6 scanning and I think

761
00:29:42,960 --> 00:29:44,399
IPv6 is getting more and more

762
00:29:44,399 --> 00:29:48,179
interesting we are using IPv6 in lots of

763
00:29:48,179 --> 00:29:50,100
places we can see the statistics going

764
00:29:50,100 --> 00:29:52,740
up and also a lot of the firewalls are

765
00:29:52,740 --> 00:29:55,799
not very well suited for IPv6 so they're

766
00:29:55,799 --> 00:29:57,179
not optimized for that because that's

767
00:29:57,179 --> 00:29:59,399
not the common case that people are

768
00:29:59,399 --> 00:30:01,559
running IPv6 in our part of the world

769
00:30:01,559 --> 00:30:04,860
and I also know that enw and through

770
00:30:04,860 --> 00:30:07,140
this law of IPv6 and I love IPv6 I did

771
00:30:07,140 --> 00:30:10,320
my thesis about IPv6 in 2002 so 20 years

772
00:30:10,320 --> 00:30:12,419
ago I handed in my thesis about IPv6

773
00:30:12,419 --> 00:30:14,340
this summer

774
00:30:14,340 --> 00:30:16,440
this is just a documentation for these

775
00:30:16,440 --> 00:30:18,779
options that I have used not very

776
00:30:18,779 --> 00:30:21,240
interesting they save the output in XML

777
00:30:21,240 --> 00:30:23,700
format which can be converted into HTML

778
00:30:23,700 --> 00:30:26,279
converting it into HTML will make it

779
00:30:26,279 --> 00:30:28,080
very easy to just copy it into your

780
00:30:28,080 --> 00:30:30,539
documentation for this so when you do a

781
00:30:30,539 --> 00:30:33,059
follow-up on on all of this you have

782
00:30:33,059 --> 00:30:35,700
some nice output to show we had these

783
00:30:35,700 --> 00:30:38,100
ports open on the ISP router can you

784
00:30:38,100 --> 00:30:40,679
please turn off these ports so we are

785
00:30:40,679 --> 00:30:43,799
less vulnerable on the ISP router and on

786
00:30:43,799 --> 00:30:45,539
our services we found that these and

787
00:30:45,539 --> 00:30:48,379
these ports are open

788
00:30:48,419 --> 00:30:52,260
also a small talk about these routers in

789
00:30:52,260 --> 00:30:54,360
front of the network this is actually

790
00:30:54,360 --> 00:30:58,380
real live data that came from a test so

791
00:30:58,380 --> 00:31:00,779
while doing these Port scanning doing

792
00:31:00,779 --> 00:31:03,419
some UDP scanning for instant MP the

793
00:31:03,419 --> 00:31:05,580
simple Network management protocol we

794
00:31:05,580 --> 00:31:07,620
saw that this router which is a Cisco

795
00:31:07,620 --> 00:31:10,020
device in front of a customer Network it

796
00:31:10,020 --> 00:31:13,559
had an uptime of 732 days and I have

797
00:31:13,559 --> 00:31:15,720
also seen plus thousand I think I've

798
00:31:15,720 --> 00:31:18,480
also seen 1800 and we talked about it in

799
00:31:18,480 --> 00:31:21,659
one of the days and it's just why would

800
00:31:21,659 --> 00:31:24,120
you have a machine a device running for

801
00:31:24,120 --> 00:31:27,000
so long because if it has an uptime of

802
00:31:27,000 --> 00:31:30,720
732 days it is definitely missing some

803
00:31:30,720 --> 00:31:33,179
critical vulnerabilities a critical

804
00:31:33,179 --> 00:31:35,279
firmware updates and since we can see

805
00:31:35,279 --> 00:31:37,320
it's a Cisco device we can quickly find

806
00:31:37,320 --> 00:31:39,539
out with the MAC address approximately

807
00:31:39,539 --> 00:31:42,659
when it was created we may even be able

808
00:31:42,659 --> 00:31:44,760
to find the model or approximate model

809
00:31:44,760 --> 00:31:47,520
so we will be able to Target it more if

810
00:31:47,520 --> 00:31:49,919
we know more about it and this is really

811
00:31:49,919 --> 00:31:52,260
bad so in some cases you go back to the

812
00:31:52,260 --> 00:31:54,720
isps and tell them to

813
00:31:54,720 --> 00:31:57,480
sharpen up a bit

814
00:31:57,480 --> 00:31:59,880
then we get to the actual doing the DDOS

815
00:31:59,880 --> 00:32:02,580
testing and I have some a prioritized

816
00:32:02,580 --> 00:32:04,320
list of the things that you should test

817
00:32:04,320 --> 00:32:07,020
this is just a very very

818
00:32:07,020 --> 00:32:10,020
initial test of doing data structure

819
00:32:10,020 --> 00:32:11,700
testing but these are the most

820
00:32:11,700 --> 00:32:13,740
interesting because these are the ones

821
00:32:13,740 --> 00:32:15,840
that are getting amplificated on the

822
00:32:15,840 --> 00:32:17,700
Internet these are the ones that you

823
00:32:17,700 --> 00:32:20,159
have to handle because you have Services

824
00:32:20,159 --> 00:32:22,320
running TCP and if you have Services

825
00:32:22,320 --> 00:32:24,419
running TSB you must allow Samsung

826
00:32:24,419 --> 00:32:27,240
packets to come into your network

827
00:32:27,240 --> 00:32:30,120
I will use this HP I usually use this

828
00:32:30,120 --> 00:32:32,760
hp3 packet generator because it has this

829
00:32:32,760 --> 00:32:34,860
option of doing an interval so you can

830
00:32:34,860 --> 00:32:37,260
turn up and down the speed of this which

831
00:32:37,260 --> 00:32:39,779
will be nice so we can start with 100

832
00:32:39,779 --> 00:32:42,240
000 packets per second 200 000 packets

833
00:32:42,240 --> 00:32:44,880
per second 500 000 packets per second

834
00:32:44,880 --> 00:32:46,980
and then suddenly the people in the

835
00:32:46,980 --> 00:32:48,720
other end where you're communicating

836
00:32:48,720 --> 00:32:52,740
using some kind of talk protocol IRC uh

837
00:32:52,740 --> 00:32:55,559
whatever you want to use but tell them

838
00:32:55,559 --> 00:32:57,600
that now we are sending 500 000 packets

839
00:32:57,600 --> 00:33:00,179
per second and they can say oh the CPU

840
00:33:00,179 --> 00:33:03,659
on the firewall is 33 so if I increase

841
00:33:03,659 --> 00:33:06,299
the attack it may go up and go above

842
00:33:06,299 --> 00:33:08,460
what the CPU on the firewall can handle

843
00:33:08,460 --> 00:33:11,399
so it's very nice to use this with

844
00:33:11,399 --> 00:33:13,919
different speeds to find out where the

845
00:33:13,919 --> 00:33:16,260
bottlenecks are which devices are being

846
00:33:16,260 --> 00:33:19,140
heard by this and then of course you

847
00:33:19,140 --> 00:33:20,580
keep on turning it up

848
00:33:20,580 --> 00:33:22,679
and you end up with sending packets in

849
00:33:22,679 --> 00:33:24,600
the millions of packets per second so

850
00:33:24,600 --> 00:33:27,120
that's very nice and this generator is

851
00:33:27,120 --> 00:33:29,519
also very flexible it's fantastic

852
00:33:29,519 --> 00:33:32,880
because it can produce all sorts of

853
00:33:32,880 --> 00:33:34,980
combinations of source Port destination

854
00:33:34,980 --> 00:33:37,620
Port sometimes just changing the source

855
00:33:37,620 --> 00:33:40,440
Port into Port 80 or Port 53 for DNS

856
00:33:40,440 --> 00:33:43,559
will go past some of the firewalls that

857
00:33:43,559 --> 00:33:47,100
we have seen so you can just uh

858
00:33:47,100 --> 00:33:49,679
Taylor packets and sent them off using

859
00:33:49,679 --> 00:33:52,620
this hping three we also have this t50

860
00:33:52,620 --> 00:33:54,779
which is also a favorite of mine because

861
00:33:54,779 --> 00:33:57,360
it has this special option which is the

862
00:33:57,360 --> 00:34:00,960
one called protocol t50 so protocol t50

863
00:34:00,960 --> 00:34:03,240
you don't know a protocol t50 but that's

864
00:34:03,240 --> 00:34:05,279
just a keyword they have decided to

865
00:34:05,279 --> 00:34:08,099
implement in this tool so it will send

866
00:34:08,099 --> 00:34:12,300
all protocols sequentially oh my God if

867
00:34:12,300 --> 00:34:13,679
you're a firewall that have optimized

868
00:34:13,679 --> 00:34:16,379
the case and some hardware for TCP UDP

869
00:34:16,379 --> 00:34:18,300
icmp but then you're getting all of

870
00:34:18,300 --> 00:34:20,099
these other protocols you're getting

871
00:34:20,099 --> 00:34:23,280
random crap that you must handle in

872
00:34:23,280 --> 00:34:25,320
your firewall and if you're sending this

873
00:34:25,320 --> 00:34:27,960
like a million packets per second it's

874
00:34:27,960 --> 00:34:30,540
really bad for most firewalls so this is

875
00:34:30,540 --> 00:34:32,760
one of the commands that I definitely

876
00:34:32,760 --> 00:34:34,918
advise you to try out it's available on

877
00:34:34,918 --> 00:34:37,859
Kaylee it's easy to run some of these

878
00:34:37,859 --> 00:34:39,780
tools they may not be the fastest

879
00:34:39,780 --> 00:34:41,879
because they are pretty slow they are

880
00:34:41,879 --> 00:34:44,639
pretty old but they can still get a lot

881
00:34:44,639 --> 00:34:46,739
of results and typically since we have

882
00:34:46,739 --> 00:34:49,739
like eight cores 10 cores in a generic

883
00:34:49,739 --> 00:34:52,020
PC server today which I'm using for

884
00:34:52,020 --> 00:34:53,940
these testing but then we can actually

885
00:34:53,940 --> 00:34:56,159
send millions of packets per second and

886
00:34:56,159 --> 00:34:57,720
that's good enough to make something

887
00:34:57,720 --> 00:35:00,660
break on the network

888
00:35:00,660 --> 00:35:03,960
so the process now after having found

889
00:35:03,960 --> 00:35:06,900
some targets found some tools is that

890
00:35:06,900 --> 00:35:09,359
you would want to monitor attack break

891
00:35:09,359 --> 00:35:12,060
repeat so that's basically an iterative

892
00:35:12,060 --> 00:35:14,400
process where you go through all of the

893
00:35:14,400 --> 00:35:16,380
test cases the scenarios that you want

894
00:35:16,380 --> 00:35:18,660
to test and then turn It Up Until It

895
00:35:18,660 --> 00:35:20,700
Breaks and if you turn it up to millions

896
00:35:20,700 --> 00:35:22,260
of packets and nothing happens on the

897
00:35:22,260 --> 00:35:24,599
whole network good for you that's an

898
00:35:24,599 --> 00:35:26,880
okay that's a check so that scenario is

899
00:35:26,880 --> 00:35:29,220
fine but then you probably will meet

900
00:35:29,220 --> 00:35:33,000
like three five or more scenarios that

901
00:35:33,000 --> 00:35:35,400
give you trouble and then afterwards you

902
00:35:35,400 --> 00:35:37,440
should of course evaluate how can we

903
00:35:37,440 --> 00:35:39,660
combat this scenario we can change this

904
00:35:39,660 --> 00:35:41,940
in the firewall we can change this in

905
00:35:41,940 --> 00:35:45,240
our network but make sure that you run

906
00:35:45,240 --> 00:35:47,520
through all the scenarios and then

907
00:35:47,520 --> 00:35:49,800
perform a change and then you can run

908
00:35:49,800 --> 00:35:51,599
all the scenarios again because

909
00:35:51,599 --> 00:35:54,599
sometimes you will have to do a balanced

910
00:35:54,599 --> 00:35:56,520
configuration where you cannot use all

911
00:35:56,520 --> 00:35:58,079
of the features in your firewall devices

912
00:35:58,079 --> 00:36:00,300
and routers and switching and so on so

913
00:36:00,300 --> 00:36:02,280
it's much much better to just run all

914
00:36:02,280 --> 00:36:04,920
the scenarios and then afterwards you

915
00:36:04,920 --> 00:36:07,020
can do the changes and then do a retest

916
00:36:07,020 --> 00:36:09,660
on another day another night

917
00:36:09,660 --> 00:36:11,880
I recommend having a comment chat with

918
00:36:11,880 --> 00:36:14,460
network operators customers outsourced

919
00:36:14,460 --> 00:36:17,640
Partners the firewall administrator also

920
00:36:17,640 --> 00:36:19,440
if they are outsourced make sure that

921
00:36:19,440 --> 00:36:21,240
you bring some people together because

922
00:36:21,240 --> 00:36:23,760
they will notice things that you cannot

923
00:36:23,760 --> 00:36:26,160
see from the outside so they will notice

924
00:36:26,160 --> 00:36:28,619
some logs on the inside they will be

925
00:36:28,619 --> 00:36:30,599
able to give more information about what

926
00:36:30,599 --> 00:36:33,780
works and how bad it is for the network

927
00:36:33,780 --> 00:36:36,000
and also the last bullet is quite

928
00:36:36,000 --> 00:36:37,560
important I should probably put that in

929
00:36:37,560 --> 00:36:40,440
bold because any information resulting

930
00:36:40,440 --> 00:36:43,079
from this testing is good information so

931
00:36:43,079 --> 00:36:46,200
any change in latency any change in

932
00:36:46,200 --> 00:36:48,740
packet drops any change in probe lost

933
00:36:48,740 --> 00:36:51,180
response times anything is good

934
00:36:51,180 --> 00:36:53,220
information

935
00:36:53,220 --> 00:36:55,680
so getting to the attack part with the

936
00:36:55,680 --> 00:36:59,099
hp3 exporting the custom IP into a

937
00:36:59,099 --> 00:37:01,859
variable using a command like I

938
00:37:01,859 --> 00:37:04,320
recommend here using the date called

939
00:37:04,320 --> 00:37:07,260
semicolon time and then the hping three

940
00:37:07,260 --> 00:37:09,119
command and they are quite important

941
00:37:09,119 --> 00:37:11,160
because typically I would just do a

942
00:37:11,160 --> 00:37:13,740
complete script and then have a ASCII

943
00:37:13,740 --> 00:37:15,780
lock of all my commands that I ran

944
00:37:15,780 --> 00:37:17,760
through the night so I will have time

945
00:37:17,760 --> 00:37:20,760
stamped when I did this command I will

946
00:37:20,760 --> 00:37:22,980
have seen with the time command how long

947
00:37:22,980 --> 00:37:25,260
did I run this attack for and that's

948
00:37:25,260 --> 00:37:27,300
very important because afterwards you

949
00:37:27,300 --> 00:37:29,520
want to correlate your attacks with the

950
00:37:29,520 --> 00:37:31,380
logs on the other side on the

951
00:37:31,380 --> 00:37:32,940
applications on the firewall and the

952
00:37:32,940 --> 00:37:35,520
routers and so on so please do a date

953
00:37:35,520 --> 00:37:37,859
and a Time command then running the

954
00:37:37,859 --> 00:37:40,800
attack tool hp3 in this case it's just

955
00:37:40,800 --> 00:37:43,760
sending uh was that a million packets

956
00:37:43,760 --> 00:37:49,140
with the c with minus i u 60 so it will

957
00:37:49,140 --> 00:37:51,420
not be the fastest attack but it will

958
00:37:51,420 --> 00:37:53,880
just send a small burst to show how it's

959
00:37:53,880 --> 00:37:56,220
working and if that works fine you can

960
00:37:56,220 --> 00:37:57,480
see on your own devices that you're

961
00:37:57,480 --> 00:37:59,400
sending packets you can see at the

962
00:37:59,400 --> 00:38:00,839
receiving end there receiving your

963
00:38:00,839 --> 00:38:02,880
packets everything is good you can

964
00:38:02,880 --> 00:38:05,520
continue turning up the attack removing

965
00:38:05,520 --> 00:38:07,800
the count so it will just continuously

966
00:38:07,800 --> 00:38:10,560
be running this hping 3 and that will

967
00:38:10,560 --> 00:38:13,500
actually start to create results

968
00:38:13,500 --> 00:38:15,420
some of my recommendation during this

969
00:38:15,420 --> 00:38:17,520
test is that you run these tests for at

970
00:38:17,520 --> 00:38:20,099
least five minutes even up to 15 minutes

971
00:38:20,099 --> 00:38:22,140
some of these attacks require some kind

972
00:38:22,140 --> 00:38:25,079
of build up so when I'm sending a soon

973
00:38:25,079 --> 00:38:27,540
packet it will get received as a session

974
00:38:27,540 --> 00:38:29,760
being established so that will take like

975
00:38:29,760 --> 00:38:33,119
one line in the table on the devices but

976
00:38:33,119 --> 00:38:35,880
it may take a little bit of time before

977
00:38:35,880 --> 00:38:38,700
we reach the millions of sessions that

978
00:38:38,700 --> 00:38:41,579
are allowed in these devices so keep on

979
00:38:41,579 --> 00:38:44,160
turning up the the speed of the attacks

980
00:38:44,160 --> 00:38:46,140
and also make sure that you run them for

981
00:38:46,140 --> 00:38:48,359
at least five minutes 15 minutes is

982
00:38:48,359 --> 00:38:50,099
probably good if you're sending

983
00:38:50,099 --> 00:38:51,540
something like a million packets per

984
00:38:51,540 --> 00:38:54,119
second over 15 minutes that's quite a

985
00:38:54,119 --> 00:38:56,400
lot of sessions that get established and

986
00:38:56,400 --> 00:38:58,200
then you will see on your firewall

987
00:38:58,200 --> 00:39:00,420
device on your load balances on your

988
00:39:00,420 --> 00:39:02,400
routers and so on some of these numbers

989
00:39:02,400 --> 00:39:05,280
will go high and I know for a fact that

990
00:39:05,280 --> 00:39:07,500
some of the SRX the only firewalls that

991
00:39:07,500 --> 00:39:10,859
I have been using they have had an 1800

992
00:39:10,859 --> 00:39:14,760
second timeout for UDP play packets so

993
00:39:14,760 --> 00:39:17,040
that's really a long time for a UDP

994
00:39:17,040 --> 00:39:20,520
session to be kept in some kind of table

995
00:39:20,520 --> 00:39:23,520
so run this attacks for some time and

996
00:39:23,520 --> 00:39:25,079
take note of any change in response

997
00:39:25,079 --> 00:39:27,599
higher latency loss probes if something

998
00:39:27,599 --> 00:39:30,060
starts to be unresponsive I usually use

999
00:39:30,060 --> 00:39:31,800
something like a curl on the command

1000
00:39:31,800 --> 00:39:34,320
line to check an HTTP service I will go

1001
00:39:34,320 --> 00:39:36,839
back to my smoke ping and graphs and

1002
00:39:36,839 --> 00:39:39,119
then if something goes wrong I will stop

1003
00:39:39,119 --> 00:39:41,160
the attack we will note how long it

1004
00:39:41,160 --> 00:39:43,260
takes for the service to return to

1005
00:39:43,260 --> 00:39:45,839
normal and then we will retest so if

1006
00:39:45,839 --> 00:39:47,700
something does not break we'll continue

1007
00:39:47,700 --> 00:39:49,740
to the next scenario but if something

1008
00:39:49,740 --> 00:39:51,960
breaks we will retest using the same

1009
00:39:51,960 --> 00:39:54,780
parameters sometimes we'll turn it down

1010
00:39:54,780 --> 00:39:57,480
a bit to see if it was around that time

1011
00:39:57,480 --> 00:40:00,599
or that size of the attack it breaks we

1012
00:40:00,599 --> 00:40:02,579
want to know the approximate level where

1013
00:40:02,579 --> 00:40:04,740
it breaks and what breaks

1014
00:40:04,740 --> 00:40:07,260
keep a lock handy write notes start a

1015
00:40:07,260 --> 00:40:09,180
session I usually use the script command

1016
00:40:09,180 --> 00:40:10,980
I'm running all of this on Linux by the

1017
00:40:10,980 --> 00:40:12,960
way I didn't say that sorry but I'm

1018
00:40:12,960 --> 00:40:15,780
using a generic Kali Linux to run all of

1019
00:40:15,780 --> 00:40:17,160
these tools

1020
00:40:17,160 --> 00:40:19,020
you can also run it on Debian or some

1021
00:40:19,020 --> 00:40:21,119
other Linux but my preferred platform

1022
00:40:21,119 --> 00:40:23,940
for this is the Klee Linux

1023
00:40:23,940 --> 00:40:25,920
also once in a while you can use the

1024
00:40:25,920 --> 00:40:29,880
command PS Au xw grip for hp3 because I

1025
00:40:29,880 --> 00:40:31,260
recommend that you run multiple

1026
00:40:31,260 --> 00:40:33,000
processes you run them in the background

1027
00:40:33,000 --> 00:40:34,800
and sometimes I'm running like 10

1028
00:40:34,800 --> 00:40:37,440
processes of hping 3 and when you just

1029
00:40:37,440 --> 00:40:39,119
want to turn down the attack you want to

1030
00:40:39,119 --> 00:40:41,880
kill all of these processes so make sure

1031
00:40:41,880 --> 00:40:44,040
that when you shut off the attack you

1032
00:40:44,040 --> 00:40:45,599
have actually shot off the attack

1033
00:40:45,599 --> 00:40:48,119
running multiple instances of the tools

1034
00:40:48,119 --> 00:40:50,940
one process May generate 800 000 packets

1035
00:40:50,940 --> 00:40:52,560
per second and then adding some

1036
00:40:52,560 --> 00:40:54,960
processes you cannot of course add 100

1037
00:40:54,960 --> 00:40:57,720
processes but you can probably add the

1038
00:40:57,720 --> 00:40:59,640
number of processes corresponding to the

1039
00:40:59,640 --> 00:41:02,160
number of calls you have in the CPU on

1040
00:41:02,160 --> 00:41:04,740
your sending machine so something around

1041
00:41:04,740 --> 00:41:07,020
800 000 packets per second and that's

1042
00:41:07,020 --> 00:41:09,300
actually an old number some of the older

1043
00:41:09,300 --> 00:41:11,460
CPUs I've been using this on I think it

1044
00:41:11,460 --> 00:41:14,180
was something like an E5

1045
00:41:14,180 --> 00:41:19,700
2603 V3 like an old old CPU

1046
00:41:19,740 --> 00:41:21,359
then

1047
00:41:21,359 --> 00:41:24,359
apart from these basic attacks I would

1048
00:41:24,359 --> 00:41:26,160
also recommend some of the more exotic

1049
00:41:26,160 --> 00:41:28,320
attacks and you will typically get a lot

1050
00:41:28,320 --> 00:41:31,079
of fun results when you start to spoof

1051
00:41:31,079 --> 00:41:33,240
packets when you start to send small

1052
00:41:33,240 --> 00:41:36,240
fragments bad fragments bad checksum

1053
00:41:36,240 --> 00:41:39,480
some of these devices on the way to the

1054
00:41:39,480 --> 00:41:41,640
application will also notice if

1055
00:41:41,640 --> 00:41:43,800
something is bad and if something is bad

1056
00:41:43,800 --> 00:41:46,619
they will lock it so they will send a

1057
00:41:46,619 --> 00:41:48,720
lock message so sending a lock message

1058
00:41:48,720 --> 00:41:51,119
can also be quite expensive it can be

1059
00:41:51,119 --> 00:41:52,740
quite expensive for the device that is

1060
00:41:52,740 --> 00:41:54,780
sending the lock message has to generate

1061
00:41:54,780 --> 00:41:56,579
some text send it over Source lock

1062
00:41:56,579 --> 00:41:58,859
because that's what we all use still and

1063
00:41:58,859 --> 00:42:01,740
then it needs to send perhaps 800

1064
00:42:01,740 --> 00:42:04,920
000 log messages per second that's like

1065
00:42:04,920 --> 00:42:07,260
oh no no no no no oh no it's not other

1066
00:42:07,260 --> 00:42:10,140
not per second but it was 800 000 log

1067
00:42:10,140 --> 00:42:14,339
messages in yeah in minutes so that's

1068
00:42:14,339 --> 00:42:16,800
really really a hard task and it's a

1069
00:42:16,800 --> 00:42:19,020
hard task for the logging system to

1070
00:42:19,020 --> 00:42:21,660
ingest all of these messages so in many

1071
00:42:21,660 --> 00:42:23,940
cases we also see that the monitoring go

1072
00:42:23,940 --> 00:42:27,859
blind while we do these attacks

1073
00:42:28,079 --> 00:42:30,599
the actual commands that I usually use

1074
00:42:30,599 --> 00:42:32,760
is the one like soon floating soon AG

1075
00:42:32,760 --> 00:42:35,160
floating icmp flooding UDP flooding

1076
00:42:35,160 --> 00:42:37,800
again I will use the hp3 tool because

1077
00:42:37,800 --> 00:42:41,099
it's very flexible you can start to play

1078
00:42:41,099 --> 00:42:42,960
with all of these parameters when you

1079
00:42:42,960 --> 00:42:45,660
get later into the test but these are

1080
00:42:45,660 --> 00:42:48,180
the basic ones that you should try out

1081
00:42:48,180 --> 00:42:50,280
and when you have tried these out you

1082
00:42:50,280 --> 00:42:52,200
can definitely find good options in your

1083
00:42:52,200 --> 00:42:55,800
firewall devices components to to ensure

1084
00:42:55,800 --> 00:42:57,660
that you are not as vulnerable to these

1085
00:42:57,660 --> 00:42:59,520
attacks and then you can of course move

1086
00:42:59,520 --> 00:43:02,700
on to the more specialized attacks

1087
00:43:02,700 --> 00:43:05,579
while I'm doing this I'm sending all of

1088
00:43:05,579 --> 00:43:07,319
these attack packets I will typically

1089
00:43:07,319 --> 00:43:09,960
use the if PPS tool from the netsniff

1090
00:43:09,960 --> 00:43:11,760
package that will show how many packets

1091
00:43:11,760 --> 00:43:13,740
I'm sending per second which is very

1092
00:43:13,740 --> 00:43:15,780
nice and it's very nice if the network

1093
00:43:15,780 --> 00:43:18,000
people at the other end can verify that

1094
00:43:18,000 --> 00:43:20,099
they are receiving these packets and

1095
00:43:20,099 --> 00:43:22,020
typically I would inform some of the

1096
00:43:22,020 --> 00:43:24,300
isps on the road from my network to the

1097
00:43:24,300 --> 00:43:26,099
customer Network I actually do this

1098
00:43:26,099 --> 00:43:28,560
across the internet but typically I do

1099
00:43:28,560 --> 00:43:30,540
it in Denmark from my network in Denmark

1100
00:43:30,540 --> 00:43:32,880
to another customer in Denmark but I

1101
00:43:32,880 --> 00:43:34,680
have also done it in some cases

1102
00:43:34,680 --> 00:43:37,140
internationally but try to find a way

1103
00:43:37,140 --> 00:43:39,480
where it's allowed to do this attack so

1104
00:43:39,480 --> 00:43:41,160
you're not getting shot down during the

1105
00:43:41,160 --> 00:43:43,020
attack

1106
00:43:43,020 --> 00:43:45,300
some further hints speed we already

1107
00:43:45,300 --> 00:43:48,079
talked about that adding more processes

1108
00:43:48,079 --> 00:43:50,400
using this flooding with caution because

1109
00:43:50,400 --> 00:43:52,020
it just runs max speed and something

1110
00:43:52,020 --> 00:43:54,060
will break and you don't know what broke

1111
00:43:54,060 --> 00:43:56,220
first what is what is wrong in the

1112
00:43:56,220 --> 00:43:57,359
network

1113
00:43:57,359 --> 00:44:00,300
doing your TCP testing with a with a

1114
00:44:00,300 --> 00:44:02,280
with some kind of Port that is allowed

1115
00:44:02,280 --> 00:44:04,500
through the network often that would be

1116
00:44:04,500 --> 00:44:07,140
Port 80 and 443 but depending on your

1117
00:44:07,140 --> 00:44:09,000
network you can probably find other

1118
00:44:09,000 --> 00:44:11,280
interesting TCP services

1119
00:44:11,280 --> 00:44:13,800
focus on text on attacks that are hard

1120
00:44:13,800 --> 00:44:15,960
to block like the TCP student that must

1121
00:44:15,960 --> 00:44:18,720
be allowed in but in other cases if it's

1122
00:44:18,720 --> 00:44:21,420
a pure hosting Network never creating

1123
00:44:21,420 --> 00:44:22,280
outside

1124
00:44:22,280 --> 00:44:25,200
traffic they will never receive the

1125
00:44:25,200 --> 00:44:26,640
response package and they will never

1126
00:44:26,640 --> 00:44:28,740
need to send a soon packet out perhaps

1127
00:44:28,740 --> 00:44:31,079
from that part of the network so some of

1128
00:44:31,079 --> 00:44:33,180
the attacks we can actually block quite

1129
00:44:33,180 --> 00:44:35,640
easy like some of the like a reset

1130
00:44:35,640 --> 00:44:37,280
attack

1131
00:44:37,280 --> 00:44:40,079
rst the reset attack can probably be

1132
00:44:40,079 --> 00:44:42,319
blocked in a lot of networks without

1133
00:44:42,319 --> 00:44:45,300
losing any functionality

1134
00:44:45,300 --> 00:44:49,400
oh time is running sorry

1135
00:44:49,560 --> 00:44:52,260
Focus also on the routers in front don't

1136
00:44:52,260 --> 00:44:55,440
forget those if I find that the router

1137
00:44:55,440 --> 00:44:57,540
in front is not protected with this what

1138
00:44:57,540 --> 00:44:59,400
we call a router protecting filter it

1139
00:44:59,400 --> 00:45:02,579
has SSH open to the device you may be

1140
00:45:02,579 --> 00:45:05,460
able to just create an attack using

1141
00:45:05,460 --> 00:45:08,220
import 22 on the router you can start to

1142
00:45:08,220 --> 00:45:10,980
do a lot of requests on Port 22 that's

1143
00:45:10,980 --> 00:45:13,500
not very nice for a router in front to

1144
00:45:13,500 --> 00:45:15,960
be overloaded by SSH but then of course

1145
00:45:15,960 --> 00:45:18,660
the isps should have blocked that Port

1146
00:45:18,660 --> 00:45:20,460
it should only be available from the

1147
00:45:20,460 --> 00:45:23,220
management network of the ISP or if it's

1148
00:45:23,220 --> 00:45:24,780
the customer it should only be available

1149
00:45:24,780 --> 00:45:27,079
from the customers management Network

1150
00:45:27,079 --> 00:45:30,839
and protocols like bgp which is vital

1151
00:45:30,839 --> 00:45:32,940
for keeping networks up and running if

1152
00:45:32,940 --> 00:45:34,680
that port is open that can also be

1153
00:45:34,680 --> 00:45:36,480
attacked and some of these attacks will

1154
00:45:36,480 --> 00:45:41,240
actually hurt the what is called the

1155
00:45:41,240 --> 00:45:44,280
control plane so that will hurt the

1156
00:45:44,280 --> 00:45:46,079
control plane and that will make the

1157
00:45:46,079 --> 00:45:47,940
router unresponsive so it may be able to

1158
00:45:47,940 --> 00:45:51,420
perform some of the tasks but if the bgp

1159
00:45:51,420 --> 00:45:53,940
breaks it will inform the forwarding

1160
00:45:53,940 --> 00:45:55,800
plane not to forward packets and that

1161
00:45:55,800 --> 00:46:00,060
will break the network connectivity

1162
00:46:00,839 --> 00:46:03,180
small note about IPv6 testing because I

1163
00:46:03,180 --> 00:46:05,160
included it in the title and I'm very

1164
00:46:05,160 --> 00:46:08,280
fond of IPv6 a lot of the favorite tools

1165
00:46:08,280 --> 00:46:10,920
that I have used have not supported IPv6

1166
00:46:10,920 --> 00:46:14,160
which is a shame so the options that we

1167
00:46:14,160 --> 00:46:15,839
have is of course to find another tool

1168
00:46:15,839 --> 00:46:19,140
modify the tools use a use a newer tool

1169
00:46:19,140 --> 00:46:21,359
these tools that I'm using are open

1170
00:46:21,359 --> 00:46:23,819
source and I really love the hping tool

1171
00:46:23,819 --> 00:46:26,940
so back in 2018 I just did a search and

1172
00:46:26,940 --> 00:46:29,460
replace for inet to inet 6 in the code

1173
00:46:29,460 --> 00:46:32,460
more or less 20 years ago so 20 years

1174
00:46:32,460 --> 00:46:34,800
ago I did it with a port scanner but in

1175
00:46:34,800 --> 00:46:37,200
this case it was just the hping tool and

1176
00:46:37,200 --> 00:46:38,819
that made it possible for me to send

1177
00:46:38,819 --> 00:46:41,819
IPv6 packets so it is possible to use

1178
00:46:41,819 --> 00:46:45,180
older tools update them I'm not a great

1179
00:46:45,180 --> 00:46:46,859
programmer but I can do search and

1180
00:46:46,859 --> 00:46:48,480
replace and then I could do make until

1181
00:46:48,480 --> 00:46:52,260
it compiles so I was able to do IPv6

1182
00:46:52,260 --> 00:46:55,140
student packets using hping 3 and this

1183
00:46:55,140 --> 00:46:57,540
is on a GitHub repository and I verified

1184
00:46:57,540 --> 00:46:59,400
yesterday that I can actually still

1185
00:46:59,400 --> 00:47:01,500
compile this on Debian so it still

1186
00:47:01,500 --> 00:47:04,020
actually works and can send IPv6 packets

1187
00:47:04,020 --> 00:47:07,980
but moving on to another tool which is a

1188
00:47:07,980 --> 00:47:10,740
great great tool which is more recent I

1189
00:47:10,740 --> 00:47:12,960
think believe it was created around 2000

1190
00:47:12,960 --> 00:47:16,079
15 called Moon gen it has evolved into a

1191
00:47:16,079 --> 00:47:18,240
library that you can use from other

1192
00:47:18,240 --> 00:47:19,680
programs

1193
00:47:19,680 --> 00:47:25,259
and that tool actually supports IPv6 so

1194
00:47:25,319 --> 00:47:28,020
I'm just going to skip some of these and

1195
00:47:28,020 --> 00:47:31,079
then go to this slide which is about

1196
00:47:31,079 --> 00:47:33,960
this Moon gen tool because as I said

1197
00:47:33,960 --> 00:47:38,040
hping is not the fastest tool but using

1198
00:47:38,040 --> 00:47:40,260
this Moon gen tool it will actually

1199
00:47:40,260 --> 00:47:43,440
allow you to use dpdk which is data

1200
00:47:43,440 --> 00:47:45,119
plane development kit originally from

1201
00:47:45,119 --> 00:47:47,579
Intel it's now open source which I'm

1202
00:47:47,579 --> 00:47:50,280
very happy that it became open source it

1203
00:47:50,280 --> 00:47:52,619
also allows other network cards than

1204
00:47:52,619 --> 00:47:54,900
Intel network cards it's a very low

1205
00:47:54,900 --> 00:47:57,660
level kit this low level kit is quite

1206
00:47:57,660 --> 00:48:00,480
hard to get started using but using this

1207
00:48:00,480 --> 00:48:03,300
new tool called Moon gen you can just

1208
00:48:03,300 --> 00:48:06,359
take a generic PC this is a small Dell

1209
00:48:06,359 --> 00:48:09,000
Precision 3240 not a recommendation it's

1210
00:48:09,000 --> 00:48:11,359
just a device that I bought it was cheap

1211
00:48:11,359 --> 00:48:15,839
it has an X5 PCI slot so I could add a

1212
00:48:15,839 --> 00:48:18,780
dual 10 gig Intel card into this very

1213
00:48:18,780 --> 00:48:22,140
small machine and then I could install a

1214
00:48:22,140 --> 00:48:24,960
generic Linux I have used Debian Linux

1215
00:48:24,960 --> 00:48:26,760
they then I have downloaded the tool

1216
00:48:26,760 --> 00:48:29,339
Moon gen this tool allows you to build

1217
00:48:29,339 --> 00:48:32,880
support for dpdk in in their tool and

1218
00:48:32,880 --> 00:48:35,579
then you can use it with Lua scripts so

1219
00:48:35,579 --> 00:48:38,819
basically by using a generic PC dual 10g

1220
00:48:38,819 --> 00:48:40,859
card Intel network card you can buy them

1221
00:48:40,859 --> 00:48:44,099
on eBay you can do full

1222
00:48:44,099 --> 00:48:45,619
wire speed

1223
00:48:45,619 --> 00:48:48,900
14.8 million packets per second attacks

1224
00:48:48,900 --> 00:48:52,200
using Lua so that's quite nice and that

1225
00:48:52,200 --> 00:48:54,000
actually is it's a maximum for a 10

1226
00:48:54,000 --> 00:48:56,099
gigabit connection and it only actually

1227
00:48:56,099 --> 00:48:58,980
uses one call so that's really really

1228
00:48:58,980 --> 00:49:01,560
nasty but also very nice for you because

1229
00:49:01,560 --> 00:49:03,420
you don't need much of a budget to be

1230
00:49:03,420 --> 00:49:06,540
able to perform perform these testing

1231
00:49:06,540 --> 00:49:09,900
you can also using this tool maybe I

1232
00:49:09,900 --> 00:49:12,060
should have this one is in bold at the

1233
00:49:12,060 --> 00:49:14,099
top so this it's just one of the

1234
00:49:14,099 --> 00:49:16,200
examples you can modify some of these

1235
00:49:16,200 --> 00:49:18,180
examples I have modified these examples

1236
00:49:18,180 --> 00:49:21,180
it's just Lua and this layer 3 TCP

1237
00:49:21,180 --> 00:49:23,520
student floating Lua script could

1238
00:49:23,520 --> 00:49:26,460
actually be printed on an A4 page and it

1239
00:49:26,460 --> 00:49:29,220
also has some options and help so the

1240
00:49:29,220 --> 00:49:31,380
main part of this is very little Lua

1241
00:49:31,380 --> 00:49:34,020
scripting and you can turn down the rate

1242
00:49:34,020 --> 00:49:36,240
so this tool will allow you in this case

1243
00:49:36,240 --> 00:49:38,520
to send five gigabits instead of the

1244
00:49:38,520 --> 00:49:40,920
full 10 gigabits so it can be turned up

1245
00:49:40,920 --> 00:49:43,920
and down like the hping 3 but it's not

1246
00:49:43,920 --> 00:49:46,859
as flexible on the command line as hping

1247
00:49:46,859 --> 00:49:51,560
so I still use hping 3 a lot

1248
00:49:51,960 --> 00:49:54,540
I skipped a couple of slides because I

1249
00:49:54,540 --> 00:49:57,119
put them in the wrong order sorry if you

1250
00:49:57,119 --> 00:50:00,000
want to spoof source and destination you

1251
00:50:00,000 --> 00:50:01,859
can of course do that spoofing the

1252
00:50:01,859 --> 00:50:03,300
destination would make it go to the

1253
00:50:03,300 --> 00:50:05,339
wrong place but spoofing the source is

1254
00:50:05,339 --> 00:50:07,560
quite interesting because as you dig

1255
00:50:07,560 --> 00:50:10,380
deeper into how the network reacts you

1256
00:50:10,380 --> 00:50:13,500
can send the same IP as you're attacking

1257
00:50:13,500 --> 00:50:15,839
so that shouldn't be allowed into the

1258
00:50:15,839 --> 00:50:17,339
network and that is actually something

1259
00:50:17,339 --> 00:50:19,440
the network people should fix but you

1260
00:50:19,440 --> 00:50:21,780
can also try to spoof another IP in the

1261
00:50:21,780 --> 00:50:24,359
same network so you're sending prints a

1262
00:50:24,359 --> 00:50:27,359
ping packet or TCP soon and then the

1263
00:50:27,359 --> 00:50:30,240
response goes back to not me but to the

1264
00:50:30,240 --> 00:50:32,460
spoofed IP which is inside the network

1265
00:50:32,460 --> 00:50:35,220
so you get two for one sending one

1266
00:50:35,220 --> 00:50:37,200
packet but it results to two packets

1267
00:50:37,200 --> 00:50:38,880
within the network that you are

1268
00:50:38,880 --> 00:50:40,560
attacking so some of these things are

1269
00:50:40,560 --> 00:50:42,599
really nice to play with

1270
00:50:42,599 --> 00:50:45,660
also this hp3 tool has some very nice

1271
00:50:45,660 --> 00:50:47,819
features such as the one with the

1272
00:50:47,819 --> 00:50:49,920
fragments so I have tried to highlight

1273
00:50:49,920 --> 00:50:52,740
the important part which is hping 3

1274
00:50:52,740 --> 00:50:54,420
creates a virtual maximum transmission

1275
00:50:54,420 --> 00:50:58,020
unit MTU of 16 bytes so instead of

1276
00:50:58,020 --> 00:51:00,599
sending like full packets small but full

1277
00:51:00,599 --> 00:51:03,059
packets it will send small small

1278
00:51:03,059 --> 00:51:05,819
fragments and lots of small fragments

1279
00:51:05,819 --> 00:51:08,099
will have to get stored on an

1280
00:51:08,099 --> 00:51:10,079
intermediate device that needs to

1281
00:51:10,079 --> 00:51:12,720
combine these fragments before they can

1282
00:51:12,720 --> 00:51:14,940
make a decision to pass the packet or

1283
00:51:14,940 --> 00:51:17,700
not so this will again use up some of

1284
00:51:17,700 --> 00:51:19,680
the resources on the devices in between

1285
00:51:19,680 --> 00:51:22,380
you and the application so it's a very

1286
00:51:22,380 --> 00:51:24,180
nice features and it's very easy to run

1287
00:51:24,180 --> 00:51:26,220
so it's a test case that I'd really love

1288
00:51:26,220 --> 00:51:28,859
to perform and it actually happens a lot

1289
00:51:28,859 --> 00:51:31,920
it works a lot in lots of places

1290
00:51:31,920 --> 00:51:34,559
if we start to do this testing this is

1291
00:51:34,559 --> 00:51:36,960
what the resulting graph will look like

1292
00:51:36,960 --> 00:51:39,119
from the outside you will see that

1293
00:51:39,119 --> 00:51:41,400
probes are getting lost latency

1294
00:51:41,400 --> 00:51:44,220
increases it will get worse and worse as

1295
00:51:44,220 --> 00:51:46,260
you proceed throughout the night and

1296
00:51:46,260 --> 00:51:48,660
this is what to expect if you try to do

1297
00:51:48,660 --> 00:51:51,180
this on a Network that has not done this

1298
00:51:51,180 --> 00:51:53,819
before so even if you hope that you have

1299
00:51:53,819 --> 00:51:55,859
configured your devices in a good way

1300
00:51:55,859 --> 00:51:58,440
you have hoped that the vendors have a

1301
00:51:58,440 --> 00:52:00,180
good default configuration this is

1302
00:52:00,180 --> 00:52:01,859
actually what I see when I do this

1303
00:52:01,859 --> 00:52:04,020
testing which is why I highly recommend

1304
00:52:04,020 --> 00:52:06,359
that you spend the night doing this and

1305
00:52:06,359 --> 00:52:08,760
like a whole project of doing this is

1306
00:52:08,760 --> 00:52:11,760
very few hours around 20 30 hours in

1307
00:52:11,760 --> 00:52:13,680
total doing meetings preparations

1308
00:52:13,680 --> 00:52:16,319
setting up monitoring so less than 30

1309
00:52:16,319 --> 00:52:19,020
hours of work some of it during the

1310
00:52:19,020 --> 00:52:21,780
night unfortunately but still it's very

1311
00:52:21,780 --> 00:52:23,880
good results and it exercises a large

1312
00:52:23,880 --> 00:52:26,220
part of your organization too so this

1313
00:52:26,220 --> 00:52:28,740
was when spoofing start to work so it

1314
00:52:28,740 --> 00:52:31,920
gets red and purple and latency increase

1315
00:52:31,920 --> 00:52:34,619
is and a lot of times these Services get

1316
00:52:34,619 --> 00:52:36,900
unreachable or the whole network becomes

1317
00:52:36,900 --> 00:52:39,440
unreachable

1318
00:52:41,099 --> 00:52:43,020
I sometimes get the question if this

1319
00:52:43,020 --> 00:52:45,480
comparable to a real DDOS and I think it

1320
00:52:45,480 --> 00:52:48,480
is comparable to a real DDOS we are

1321
00:52:48,480 --> 00:52:51,420
using the test cases individually and an

1322
00:52:51,420 --> 00:52:53,579
attacker would of course be able to mix

1323
00:52:53,579 --> 00:52:55,980
and match and use multiple scenarios at

1324
00:52:55,980 --> 00:52:58,079
the same time and of course you can do

1325
00:52:58,079 --> 00:53:01,140
the same so you can do H ping3 and you

1326
00:53:01,140 --> 00:53:03,300
can run t50 and you can run Moon gen at

1327
00:53:03,300 --> 00:53:05,220
the same time and then of course it will

1328
00:53:05,220 --> 00:53:07,859
be a mixed mix of traffic that will

1329
00:53:07,859 --> 00:53:09,900
probably break even more of your

1330
00:53:09,900 --> 00:53:11,760
infrastructure but still it will be

1331
00:53:11,760 --> 00:53:14,040
harder to know which of these attacks

1332
00:53:14,040 --> 00:53:16,440
were the source of the bad things

1333
00:53:16,440 --> 00:53:18,300
happening

1334
00:53:18,300 --> 00:53:20,280
getting to the protection and I can see

1335
00:53:20,280 --> 00:53:23,099
the time is not completely running out

1336
00:53:23,099 --> 00:53:26,040
yet but it's getting closer to this this

1337
00:53:26,040 --> 00:53:28,619
is my advice for configuring your

1338
00:53:28,619 --> 00:53:30,900
firewall so it should say configure your

1339
00:53:30,900 --> 00:53:33,720
firewall infrastructure because if we

1340
00:53:33,720 --> 00:53:35,579
have routers we have switches we have

1341
00:53:35,579 --> 00:53:37,859
Security Services we have load balances

1342
00:53:37,859 --> 00:53:40,380
they are all optimized for specific

1343
00:53:40,380 --> 00:53:44,160
cases so a router can route great but it

1344
00:53:44,160 --> 00:53:46,740
can also filter statelessly on the

1345
00:53:46,740 --> 00:53:49,020
traffic coming in so if you know that

1346
00:53:49,020 --> 00:53:51,240
one part of your network is only using

1347
00:53:51,240 --> 00:53:54,780
TCP another part is only using UDP then

1348
00:53:54,780 --> 00:53:57,359
inform your routing people make them

1349
00:53:57,359 --> 00:53:59,400
create a stateless filter so that will

1350
00:53:59,400 --> 00:54:01,500
look on the individual packets if it

1351
00:54:01,500 --> 00:54:03,720
does not match TCP it's not allowed into

1352
00:54:03,720 --> 00:54:06,240
this part if it does not match UDP it's

1353
00:54:06,240 --> 00:54:07,980
not allowed into this part it sounds

1354
00:54:07,980 --> 00:54:10,319
very simple but actually it has a lot of

1355
00:54:10,319 --> 00:54:12,800
benefit for the rest of the devices

1356
00:54:12,800 --> 00:54:15,839
afterwards so handle it as early as

1357
00:54:15,839 --> 00:54:18,240
possible and make sure that you get an

1358
00:54:18,240 --> 00:54:20,280
enough bandwidth you do stateless

1359
00:54:20,280 --> 00:54:22,200
filtering we also have something called

1360
00:54:22,200 --> 00:54:24,599
real-time black holeing and null routing

1361
00:54:24,599 --> 00:54:26,460
making sure that if you have a full

1362
00:54:26,460 --> 00:54:28,800
table if you have a full bgp table on

1363
00:54:28,800 --> 00:54:31,859
ipv4 or IPv6 you can actually see a pack

1364
00:54:31,859 --> 00:54:34,619
coming in which is with a spoofed source

1365
00:54:34,619 --> 00:54:36,720
address but if that spoofed Source

1366
00:54:36,720 --> 00:54:38,700
address is not active on the internet

1367
00:54:38,700 --> 00:54:40,800
there's no way in hell you're never

1368
00:54:40,800 --> 00:54:43,440
going to be able to respond to that IP

1369
00:54:43,440 --> 00:54:46,319
so better turn it away before it reaches

1370
00:54:46,319 --> 00:54:48,119
your application that tries to send it

1371
00:54:48,119 --> 00:54:50,220
back to your router which will just

1372
00:54:50,220 --> 00:54:53,040
throw it away so having a full routing

1373
00:54:53,040 --> 00:54:55,140
table making sure that you only respond

1374
00:54:55,140 --> 00:54:56,579
to networks that are active on the

1375
00:54:56,579 --> 00:54:58,859
internet actually will turn away some of

1376
00:54:58,859 --> 00:55:01,619
the noise in these attacks

1377
00:55:01,619 --> 00:55:03,839
we also have what we call shaping and

1378
00:55:03,839 --> 00:55:06,240
fair distribution we have class of

1379
00:55:06,240 --> 00:55:08,640
service quality of service all of these

1380
00:55:08,640 --> 00:55:10,319
features are implemented in our routers

1381
00:55:10,319 --> 00:55:12,420
and switches so we can say that instead

1382
00:55:12,420 --> 00:55:14,940
of having 10 gigabits of icmp traffic

1383
00:55:14,940 --> 00:55:17,640
why why would I have I 10 gigabits of

1384
00:55:17,640 --> 00:55:20,220
icmp traffic let's just have 100

1385
00:55:20,220 --> 00:55:22,920
megabits of icmp traffic and that can

1386
00:55:22,920 --> 00:55:25,020
actually happen in these devices without

1387
00:55:25,020 --> 00:55:27,660
any further cost other than a little bit

1388
00:55:27,660 --> 00:55:29,819
of configuration and you will not lose a

1389
00:55:29,819 --> 00:55:32,280
lot of functionality by restricting icmp

1390
00:55:32,280 --> 00:55:34,859
to 100 megabits all of these things

1391
00:55:34,859 --> 00:55:37,740
combined will enable you to turn away

1392
00:55:37,740 --> 00:55:39,960
packets that are part of attacks turn

1393
00:55:39,960 --> 00:55:42,059
away some of these scenarios you can

1394
00:55:42,059 --> 00:55:44,040
verify with these scenarios we can

1395
00:55:44,040 --> 00:55:46,200
verify with these tools that you are

1396
00:55:46,200 --> 00:55:48,839
turning away packets so this is what I

1397
00:55:48,839 --> 00:55:50,819
recommend that you do and this

1398
00:55:50,819 --> 00:55:53,940
presentation has some slides about how

1399
00:55:53,940 --> 00:55:55,920
you could design this protection if

1400
00:55:55,920 --> 00:55:58,079
you're looking at your network it may be

1401
00:55:58,079 --> 00:55:59,819
that in some cases you want full

1402
00:55:59,819 --> 00:56:02,700
bandwidth 10 gigabits but some parts of

1403
00:56:02,700 --> 00:56:04,740
the network only uses less than one

1404
00:56:04,740 --> 00:56:07,740
gigabits of UDP traffic so that profile

1405
00:56:07,740 --> 00:56:11,160
can be put on your routers likewise you

1406
00:56:11,160 --> 00:56:13,140
can probably look at your network you

1407
00:56:13,140 --> 00:56:15,240
could do an address plan in this case I

1408
00:56:15,240 --> 00:56:17,099
have tried to fit in small address plan

1409
00:56:17,099 --> 00:56:20,420
on a slide so for this

1410
00:56:20,420 --> 00:56:22,040
192.020

1411
00:56:22,040 --> 00:56:26,339
25 has TCP and it only has these five

1412
00:56:26,339 --> 00:56:29,460
ports so if there's a packet coming in

1413
00:56:29,460 --> 00:56:32,760
with another Port TCP for distance for

1414
00:56:32,760 --> 00:56:35,160
this network just turn it away you don't

1415
00:56:35,160 --> 00:56:36,960
want to have it further into your

1416
00:56:36,960 --> 00:56:38,880
network you don't want to have it hit

1417
00:56:38,880 --> 00:56:41,160
your firewall and that leaves up and

1418
00:56:41,160 --> 00:56:43,859
frees up resources on the firewall so it

1419
00:56:43,859 --> 00:56:45,900
can handle more of the real traffic

1420
00:56:45,900 --> 00:56:48,480
which you want to have running even if

1421
00:56:48,480 --> 00:56:50,160
you're under attack so that's an

1422
00:56:50,160 --> 00:56:51,720
important part that you want to have

1423
00:56:51,720 --> 00:56:54,059
real traffic normal traffic reaching

1424
00:56:54,059 --> 00:56:57,720
your services while under attack

1425
00:56:57,720 --> 00:57:00,119
you can implement this and there's a

1426
00:57:00,119 --> 00:57:03,119
couple of slides showing how easy it is

1427
00:57:03,119 --> 00:57:05,579
on Juniper devices which I use so

1428
00:57:05,579 --> 00:57:07,740
Juniper devices allow you to do this

1429
00:57:07,740 --> 00:57:10,319
Edge blocker where you from some sources

1430
00:57:10,319 --> 00:57:13,260
some networks even some as numbers you

1431
00:57:13,260 --> 00:57:16,079
would just throw away the packets you

1432
00:57:16,079 --> 00:57:18,180
can do a limitation of the protocol like

1433
00:57:18,180 --> 00:57:21,540
ICP 100 megabit UDP one gigabit that's

1434
00:57:21,540 --> 00:57:24,720
nice that's built into the devices you

1435
00:57:24,720 --> 00:57:27,180
can do this strict filtering so what I

1436
00:57:27,180 --> 00:57:28,559
just said with the destination address

1437
00:57:28,559 --> 00:57:31,440
slash 25 you can say destination port

1438
00:57:31,440 --> 00:57:34,920
and these five nothing else gets passed

1439
00:57:34,920 --> 00:57:36,900
by this router for this destination

1440
00:57:36,900 --> 00:57:39,540
everything gets thrown away and that is

1441
00:57:39,540 --> 00:57:41,700
actually very very nice

1442
00:57:41,700 --> 00:57:45,000
this urpf is the real-time black holding

1443
00:57:45,000 --> 00:57:47,220
and the bgp parts so making sure that

1444
00:57:47,220 --> 00:57:49,680
only active networks on the internet are

1445
00:57:49,680 --> 00:57:52,020
sending traffic and you should all make

1446
00:57:52,020 --> 00:57:53,640
sure that you're also only sending

1447
00:57:53,640 --> 00:57:56,400
traffic from your IP addresses so make

1448
00:57:56,400 --> 00:57:59,460
sure that attackers cannot spoof from

1449
00:57:59,460 --> 00:58:01,260
your networks we are all in this

1450
00:58:01,260 --> 00:58:02,940
together make sure that people cannot

1451
00:58:02,940 --> 00:58:05,280
spoof from your Networks

1452
00:58:05,280 --> 00:58:07,980
if you implement this I promise that it

1453
00:58:07,980 --> 00:58:10,200
will not solve all of your problems I

1454
00:58:10,200 --> 00:58:12,059
cannot promise that but I will promise

1455
00:58:12,059 --> 00:58:14,400
that it can reduce your problems and in

1456
00:58:14,400 --> 00:58:16,740
this case I have an old example where we

1457
00:58:16,740 --> 00:58:18,960
had some attacks which are the spikes

1458
00:58:18,960 --> 00:58:21,420
shown here which combined is about three

1459
00:58:21,420 --> 00:58:23,640
and a half gigabit and this was actually

1460
00:58:23,640 --> 00:58:25,680
hitting one of our customers with a one

1461
00:58:25,680 --> 00:58:28,079
gigabit firewall but because we had

1462
00:58:28,079 --> 00:58:30,900
implemented this instead of sending 3.4

1463
00:58:30,900 --> 00:58:32,940
gigabits to the customer we were

1464
00:58:32,940 --> 00:58:35,940
actually sending less than 400 megabits

1465
00:58:35,940 --> 00:58:38,099
so the customer Network all the services

1466
00:58:38,099 --> 00:58:40,319
were running normally they were having a

1467
00:58:40,319 --> 00:58:42,599
one gigabit firewall that could handle

1468
00:58:42,599 --> 00:58:45,119
this load so everybody was happy except

1469
00:58:45,119 --> 00:58:47,520
the people are taking this would

1470
00:58:47,520 --> 00:58:49,680
probably scale up quite a lot and I'm

1471
00:58:49,680 --> 00:58:51,000
not sure if it would scale up to like

1472
00:58:51,000 --> 00:58:53,700
100 gigabit 200 gigabit 400 gigabit

1473
00:58:53,700 --> 00:58:54,839
because

1474
00:58:54,839 --> 00:58:57,599
ten percent of 400 gigabits is still 40

1475
00:58:57,599 --> 00:58:59,760
gigabits so that's still a lot for a

1476
00:58:59,760 --> 00:59:02,460
fireball to handle but it will help your

1477
00:59:02,460 --> 00:59:03,299
network

1478
00:59:03,299 --> 00:59:06,480
and sorry for getting very very close to

1479
00:59:06,480 --> 00:59:08,220
the ending

1480
00:59:08,220 --> 00:59:10,500
um just some interesting findings that

1481
00:59:10,500 --> 00:59:12,720
we have seen these isps with routers

1482
00:59:12,720 --> 00:59:14,660
with 100

1483
00:59:14,660 --> 00:59:17,700
1808 days of time we have seen big

1484
00:59:17,700 --> 00:59:19,319
companies in Denmark are still using one

1485
00:59:19,319 --> 00:59:21,359
gigabit connections you should move to

1486
00:59:21,359 --> 00:59:26,040
one to 10 gigabit uh usually we see fail

1487
00:59:26,040 --> 00:59:28,980
at at least three scenarios and you can

1488
00:59:28,980 --> 00:59:30,900
do a lot we have seen a lot of

1489
00:59:30,900 --> 00:59:33,720
outsourced managed Services becoming

1490
00:59:33,720 --> 00:59:35,940
unreachable we have seen locking systems

1491
00:59:35,940 --> 00:59:39,319
fall over we have seen the customers own

1492
00:59:39,319 --> 00:59:42,839
employees connected via VPN through the

1493
00:59:42,839 --> 00:59:45,180
same firewall set up losing connectivity

1494
00:59:45,180 --> 00:59:47,940
of course so they became blind and could

1495
00:59:47,940 --> 00:59:50,040
not control the environment which is

1496
00:59:50,040 --> 00:59:52,500
also very important if they ever get

1497
00:59:52,500 --> 00:59:54,660
attacked by a DDOS instead of going to

1498
00:59:54,660 --> 00:59:56,640
their home set up they will take their

1499
00:59:56,640 --> 00:59:58,859
car and drive into work to be able to

1500
00:59:58,859 --> 01:00:00,960
manage the network

1501
01:00:00,960 --> 01:00:03,660
so my conclusion is that hopefully you

1502
01:00:03,660 --> 01:00:06,180
should try this testing investigate your

1503
01:00:06,180 --> 01:00:08,520
existing devices you can do a lot with

1504
01:00:08,520 --> 01:00:11,760
these without having to buy new licenses

1505
01:00:11,760 --> 01:00:14,280
it's only a small part of course of your

1506
01:00:14,280 --> 01:00:16,980
security it's kind of like a fire drill

1507
01:00:16,980 --> 01:00:19,680
for your organization and it's quite fun

1508
01:00:19,680 --> 01:00:23,299
to do it's quite fun to do

1509
01:00:23,579 --> 01:00:26,220
we have time for a single question or no

1510
01:00:26,220 --> 01:00:27,660
if you don't if you have any questions

1511
01:00:27,660 --> 01:00:29,520
you are also welcome to find me in the

1512
01:00:29,520 --> 01:00:30,900
hallways

1513
01:00:30,900 --> 01:00:34,280
we should not go over time

1514
01:00:37,559 --> 01:00:40,619
and and I said the presentation is on

1515
01:00:40,619 --> 01:00:43,980
GitHub comes in the repository called

1516
01:00:43,980 --> 01:00:45,480
security courses and it's the latest

1517
01:00:45,480 --> 01:00:47,520
commit because I fixed some typos today

1518
01:00:47,520 --> 01:00:50,960
so you can easily find it

