1
00:00:00,670 --> 00:00:02,000
[Applause]

2
00:00:02,000 --> 00:00:04,200
break up

3
00:00:04,200 --> 00:00:08,360
so thank you danke gracias

4
00:00:08,360 --> 00:00:11,700
thank you for uh inviting me to have

5
00:00:11,700 --> 00:00:14,400
this session about uh A.D this morning

6
00:00:14,400 --> 00:00:17,220
we had the uh the the the cool stuff

7
00:00:17,220 --> 00:00:20,039
about Azure ad let's say that many may

8
00:00:20,039 --> 00:00:22,020
consider ads the boring stuff the old

9
00:00:22,020 --> 00:00:23,880
stuff the stuff that nobody cares about

10
00:00:23,880 --> 00:00:26,039
anymore but still today it's very

11
00:00:26,039 --> 00:00:27,240
important

12
00:00:27,240 --> 00:00:29,220
a little bit about me my name is Jose

13
00:00:29,220 --> 00:00:32,159
menopinto I'm working for some Paris

14
00:00:32,159 --> 00:00:34,860
I've got three roles working as a

15
00:00:34,860 --> 00:00:37,140
solution architect as a product manager

16
00:00:37,140 --> 00:00:39,420
for our backup Recovery Solution and I'm

17
00:00:39,420 --> 00:00:43,020
also a incident response team member

18
00:00:43,020 --> 00:00:46,020
um working a lot with identity security

19
00:00:46,020 --> 00:00:48,360
and Recovery in general

20
00:00:48,360 --> 00:00:50,520
um let's say that I'm really happy to be

21
00:00:50,520 --> 00:00:52,620
here not just because I was invited but

22
00:00:52,620 --> 00:00:54,960
because since this weekend I was

23
00:00:54,960 --> 00:00:56,879
involved with some other colleagues in a

24
00:00:56,879 --> 00:00:58,860
real ransomware Attack for a customer

25
00:00:58,860 --> 00:01:00,800
and we were

26
00:01:00,800 --> 00:01:03,239
recovering that customer from basically

27
00:01:03,239 --> 00:01:06,799
almost nothing to a live ID again

28
00:01:06,799 --> 00:01:10,380
this presentation is well contains a

29
00:01:10,380 --> 00:01:11,640
little bit of guidance regarding

30
00:01:11,640 --> 00:01:13,860
Disaster Recovery planning

31
00:01:13,860 --> 00:01:15,060
um

32
00:01:15,060 --> 00:01:17,220
this these are just some highlights

33
00:01:17,220 --> 00:01:18,840
because when you talk about disaster

34
00:01:18,840 --> 00:01:21,540
recovery I think I can fill up a whole

35
00:01:21,540 --> 00:01:23,520
day about the topic because it goes so

36
00:01:23,520 --> 00:01:26,640
much further than discussed here the

37
00:01:26,640 --> 00:01:28,500
interesting part of course of the the

38
00:01:28,500 --> 00:01:31,740
whole presentation is the real life

39
00:01:31,740 --> 00:01:33,900
um incident recovery scenario bullet 4

40
00:01:33,900 --> 00:01:37,439
that was uh experienced um a month or

41
00:01:37,439 --> 00:01:40,200
now about a few months ago that was also

42
00:01:40,200 --> 00:01:44,100
for a customer we helped recover from a

43
00:01:44,100 --> 00:01:46,320
ransomware uh sorry from a from an

44
00:01:46,320 --> 00:01:48,600
attack so

45
00:01:48,600 --> 00:01:50,579
a demo I'm going to start immediately

46
00:01:50,579 --> 00:01:54,299
with a demo because I want to send out a

47
00:01:54,299 --> 00:01:56,939
specific message and it's not about our

48
00:01:56,939 --> 00:01:58,619
products because it won't be a product

49
00:01:58,619 --> 00:02:01,200
demo I promise that's not the intention

50
00:02:01,200 --> 00:02:03,659
what I want to do is I'm going to show

51
00:02:03,659 --> 00:02:05,759
you that if you are prepared in a

52
00:02:05,759 --> 00:02:07,259
certain manner

53
00:02:07,259 --> 00:02:09,538
having the VMS or the infrastructure to

54
00:02:09,538 --> 00:02:11,700
deploy new VMS having a correct backup

55
00:02:11,700 --> 00:02:14,520
Recovery Solution in place

56
00:02:14,520 --> 00:02:17,879
I now start the disaster recovery

57
00:02:17,879 --> 00:02:20,099
of the environment I've got five

58
00:02:20,099 --> 00:02:22,260
machines as you can see here five of

59
00:02:22,260 --> 00:02:24,840
them it's a child sorry a forced route

60
00:02:24,840 --> 00:02:26,760
and a child domain in total for sorry

61
00:02:26,760 --> 00:02:28,560
five domain controllers four writables

62
00:02:28,560 --> 00:02:30,780
and one read only the main controller

63
00:02:30,780 --> 00:02:32,640
and my hope is that after the session

64
00:02:32,640 --> 00:02:35,958
the force recovery is done

65
00:02:36,239 --> 00:02:37,920
uh by the way this is not the

66
00:02:37,920 --> 00:02:40,020
environment that you uh is going to be

67
00:02:40,020 --> 00:02:41,160
recovered because this was my

68
00:02:41,160 --> 00:02:43,920
environment at home and I was having

69
00:02:43,920 --> 00:02:45,660
um uh connectivity issues to get there

70
00:02:45,660 --> 00:02:48,000
so the other one was my plan B always

71
00:02:48,000 --> 00:02:49,860
have a plan B

72
00:02:49,860 --> 00:02:53,400
securing and protecting access directory

73
00:02:53,400 --> 00:02:55,980
as a company we help customers secure

74
00:02:55,980 --> 00:02:57,360
their company they're their active

75
00:02:57,360 --> 00:02:59,819
directory by performing scans using

76
00:02:59,819 --> 00:03:01,140
multiple tools

77
00:03:01,140 --> 00:03:04,440
and with that we want to

78
00:03:04,440 --> 00:03:07,080
indicate to customers hey this is what's

79
00:03:07,080 --> 00:03:08,640
wrong in terms of configurations

80
00:03:08,640 --> 00:03:11,940
security historical bad settings etc etc

81
00:03:11,940 --> 00:03:14,700
to prevent the attack as much as

82
00:03:14,700 --> 00:03:17,940
possible but we also see things after

83
00:03:17,940 --> 00:03:21,959
the attack after attacking a after

84
00:03:21,959 --> 00:03:24,360
active directory being attacked we of

85
00:03:24,360 --> 00:03:25,920
course try to recover if there's

86
00:03:25,920 --> 00:03:27,420
anything to recover because you need to

87
00:03:27,420 --> 00:03:29,879
have backups and then we perform all

88
00:03:29,879 --> 00:03:31,920
kinds of scans to see whatever is bad

89
00:03:31,920 --> 00:03:35,159
and then we find many things

90
00:03:35,159 --> 00:03:36,959
admin accounts with password never

91
00:03:36,959 --> 00:03:41,040
expires admin accounts with spns admin

92
00:03:41,040 --> 00:03:43,819
accounts with password not required

93
00:03:43,819 --> 00:03:47,400
unpatched machines very old machines

94
00:03:47,400 --> 00:03:49,860
I can go on the whole day for the stuff

95
00:03:49,860 --> 00:03:52,019
that we find Historical settings because

96
00:03:52,019 --> 00:03:54,780
people do things throughout the years

97
00:03:54,780 --> 00:03:56,819
they continue to do things throughout

98
00:03:56,819 --> 00:03:59,099
the years to come and they forget the

99
00:03:59,099 --> 00:04:00,000
other stuff

100
00:04:00,000 --> 00:04:03,000
as time goes on you need to do something

101
00:04:03,000 --> 00:04:05,819
about it and

102
00:04:05,819 --> 00:04:07,799
how do you do that is to proactively

103
00:04:07,799 --> 00:04:12,420
search but also fix search for so-called

104
00:04:12,420 --> 00:04:15,659
indicators of exposure and those are all

105
00:04:15,659 --> 00:04:17,760
kinds of security settings within

106
00:04:17,760 --> 00:04:18,839
accounts

107
00:04:18,839 --> 00:04:20,940
but also in general as a configuration

108
00:04:20,940 --> 00:04:25,139
thingy in ad things might be configured

109
00:04:25,139 --> 00:04:28,139
in a way that it is not desired it may

110
00:04:28,139 --> 00:04:31,139
might be a good idea years ago but today

111
00:04:31,139 --> 00:04:33,240
it might be a bad idea you need to do

112
00:04:33,240 --> 00:04:34,620
something about it and the only way to

113
00:04:34,620 --> 00:04:37,199
do something about it is to scan for it

114
00:04:37,199 --> 00:04:39,900
and then you get a a so-called to-do

115
00:04:39,900 --> 00:04:41,699
list I need to clean up accounts from

116
00:04:41,699 --> 00:04:43,139
this setting and I need to configure ID

117
00:04:43,139 --> 00:04:44,639
from this setting but there's another

118
00:04:44,639 --> 00:04:48,780
one that is not visible in ad it is

119
00:04:48,780 --> 00:04:51,240
there but the attack paths are not

120
00:04:51,240 --> 00:04:53,520
visible to you so the so-called

121
00:04:53,520 --> 00:04:55,560
invisible attack pass also need to be

122
00:04:55,560 --> 00:04:58,400
investigated to see hey is there some

123
00:04:58,400 --> 00:05:01,860
nobody account somewhere from which you

124
00:05:01,860 --> 00:05:03,900
can hop on from this to that you measure

125
00:05:03,900 --> 00:05:05,400
this verb and suddenly you are the main

126
00:05:05,400 --> 00:05:08,759
admin those paths do exist and if you

127
00:05:08,759 --> 00:05:10,800
have never scanned for them you may not

128
00:05:10,800 --> 00:05:12,479
even be sure

129
00:05:12,479 --> 00:05:15,479
those parts are gone or don't even exist

130
00:05:15,479 --> 00:05:18,000
so make sure you scan for those you also

131
00:05:18,000 --> 00:05:19,259
need to have a look at so-called

132
00:05:19,259 --> 00:05:21,780
indicators of compromise for example if

133
00:05:21,780 --> 00:05:24,300
somebody used DC Shadow there are

134
00:05:24,300 --> 00:05:26,699
certain characteristics within ad that

135
00:05:26,699 --> 00:05:29,820
will tell you DC Shadow is used

136
00:05:29,820 --> 00:05:32,039
When A change is done in ad most of the

137
00:05:32,039 --> 00:05:34,199
times you can see who did it where etc

138
00:05:34,199 --> 00:05:36,600
etc but when you use DC Shadow you will

139
00:05:36,600 --> 00:05:38,340
find all the stuff but you will not find

140
00:05:38,340 --> 00:05:40,740
who did it because it's a machine

141
00:05:40,740 --> 00:05:42,840
account let's call it under the hood

142
00:05:42,840 --> 00:05:45,660
Kerber's roasting the perfect mechanism

143
00:05:45,660 --> 00:05:47,820
of attackers to do because it's really

144
00:05:47,820 --> 00:05:50,880
easy why think about accounts with very

145
00:05:50,880 --> 00:05:54,419
old passwords very weak passwords with

146
00:05:54,419 --> 00:05:56,039
spns

147
00:05:56,039 --> 00:05:59,039
lower encryption algorithms so it

148
00:05:59,039 --> 00:06:01,440
becomes very easy to do stuff take it

149
00:06:01,440 --> 00:06:04,320
offline decrypt and then get the

150
00:06:04,320 --> 00:06:06,120
passwords and of course much more how

151
00:06:06,120 --> 00:06:08,699
can you do that oh and of course you

152
00:06:08,699 --> 00:06:09,840
need to think

153
00:06:09,840 --> 00:06:11,820
and look at your ad

154
00:06:11,820 --> 00:06:14,880
as an attacker look at it as an attacker

155
00:06:14,880 --> 00:06:17,400
of course don't attack it would be

156
00:06:17,400 --> 00:06:19,500
really stupid but okay but look at it as

157
00:06:19,500 --> 00:06:22,259
an attacker and then try to solve things

158
00:06:22,259 --> 00:06:25,500
in that same manner I've got a some

159
00:06:25,500 --> 00:06:27,240
reading material a few but also some

160
00:06:27,240 --> 00:06:30,180
video regarding Defenders think in lists

161
00:06:30,180 --> 00:06:32,880
and attackers think in graphs and that's

162
00:06:32,880 --> 00:06:34,620
the whole invisible path thing you need

163
00:06:34,620 --> 00:06:36,300
to have a look at

164
00:06:36,300 --> 00:06:39,000
well how can you do that well some time

165
00:06:39,000 --> 00:06:41,639
ago for a customer because I was working

166
00:06:41,639 --> 00:06:43,680
at that customer I wrote a Powershell

167
00:06:43,680 --> 00:06:45,720
script A Powershell script that would

168
00:06:45,720 --> 00:06:47,220
scan all the accounts in active

169
00:06:47,220 --> 00:06:49,199
directory and get basically everything

170
00:06:49,199 --> 00:06:51,539
that was related to security presented

171
00:06:51,539 --> 00:06:53,340
in an Excel sheet

172
00:06:53,340 --> 00:06:56,340
but I went even further by Implement by

173
00:06:56,340 --> 00:06:58,199
using specific Powershell models that

174
00:06:58,199 --> 00:07:00,000
are out there and scanned for

175
00:07:00,000 --> 00:07:01,919
compromised passwords I use the

176
00:07:01,919 --> 00:07:03,419
combination of the DS internals

177
00:07:03,419 --> 00:07:05,520
Powershell module combined with have

178
00:07:05,520 --> 00:07:08,220
been Pond compromised password list and

179
00:07:08,220 --> 00:07:09,660
we scanned everything

180
00:07:09,660 --> 00:07:12,600
and then you will be surprised how big

181
00:07:12,600 --> 00:07:14,400
the list is of passwords that are

182
00:07:14,400 --> 00:07:17,220
compromised but also how big the list is

183
00:07:17,220 --> 00:07:19,620
of passwords are being reused think

184
00:07:19,620 --> 00:07:21,599
about some application administrator

185
00:07:21,599 --> 00:07:23,880
having his own account

186
00:07:23,880 --> 00:07:26,520
having an admin account and 100 accounts

187
00:07:26,520 --> 00:07:29,099
for applications give it a number so he

188
00:07:29,099 --> 00:07:31,319
has 102 accounts and you will be

189
00:07:31,319 --> 00:07:33,900
surprised maybe that all those 102

190
00:07:33,900 --> 00:07:35,880
accounts have the exact same weak

191
00:07:35,880 --> 00:07:38,819
password compromise one go to the other

192
00:07:38,819 --> 00:07:41,160
one because probably somewhere it's

193
00:07:41,160 --> 00:07:43,319
written down he is the owner

194
00:07:43,319 --> 00:07:45,180
and then you can hop from one account to

195
00:07:45,180 --> 00:07:46,740
the other one because one account might

196
00:07:46,740 --> 00:07:48,960
be more powerful than the other one

197
00:07:48,960 --> 00:07:51,660
another way is to use one of our tools

198
00:07:51,660 --> 00:07:54,000
so called which is purple Knight which

199
00:07:54,000 --> 00:07:56,520
will scan the ID also at an account

200
00:07:56,520 --> 00:07:58,319
basis but it will also look at

201
00:07:58,319 --> 00:08:01,259
configurations items within ad itself

202
00:08:01,259 --> 00:08:03,120
and then present you with a very nice

203
00:08:03,120 --> 00:08:05,039
score this by the way scans at first

204
00:08:05,039 --> 00:08:08,099
level another tool is pink castle which

205
00:08:08,099 --> 00:08:09,780
can does the same thing different

206
00:08:09,780 --> 00:08:11,580
manners also gives you some nice scoring

207
00:08:11,580 --> 00:08:14,280
mechanism and it does it at the main

208
00:08:14,280 --> 00:08:16,560
level and this is a scan from my own

209
00:08:16,560 --> 00:08:18,780
domain well if you look at it it is

210
00:08:18,780 --> 00:08:21,180
fully in the red so it's it's as bad as

211
00:08:21,180 --> 00:08:23,280
it can be I hope your environment is not

212
00:08:23,280 --> 00:08:25,379
like this

213
00:08:25,379 --> 00:08:26,879
and then there's another one that's

214
00:08:26,879 --> 00:08:29,639
Bloodhound that's the tool that is

215
00:08:29,639 --> 00:08:32,099
really nice to use and have a look at

216
00:08:32,099 --> 00:08:33,059
your ad

217
00:08:33,059 --> 00:08:36,059
where are those invisible attack bars so

218
00:08:36,059 --> 00:08:37,860
you have a tool the ingester sharp Hound

219
00:08:37,860 --> 00:08:39,719
that gets the data from the Force Level

220
00:08:39,719 --> 00:08:41,760
you import it into Bloodhound and then

221
00:08:41,760 --> 00:08:43,440
you can perform all kinds of analysis

222
00:08:43,440 --> 00:08:46,260
using predefined queries to see how do I

223
00:08:46,260 --> 00:08:50,220
get from a nothing to the crown jewels

224
00:08:50,220 --> 00:08:52,800
this is my test environment and when I

225
00:08:52,800 --> 00:08:55,200
run this quite some time ago already I

226
00:08:55,200 --> 00:08:58,260
was surprised that some stupid

227
00:08:58,260 --> 00:09:01,200
SharePoint admin that I had configured

228
00:09:01,200 --> 00:09:03,120
somewhere somehow

229
00:09:03,120 --> 00:09:06,839
was able to get to the main admin

230
00:09:06,839 --> 00:09:10,380
in two ways I didn't even know I just

231
00:09:10,380 --> 00:09:12,300
did it and this is what I mean you might

232
00:09:12,300 --> 00:09:13,980
have stuff like this in your environment

233
00:09:13,980 --> 00:09:16,500
you're not aware of so make sure to scan

234
00:09:16,500 --> 00:09:18,540
for it and especially do something about

235
00:09:18,540 --> 00:09:19,500
it

236
00:09:19,500 --> 00:09:22,560
I know from experience all these scans

237
00:09:22,560 --> 00:09:24,899
all this stuff it will lead to huge

238
00:09:24,899 --> 00:09:26,339
discussions

239
00:09:26,339 --> 00:09:29,399
stop the discussions start somewhere to

240
00:09:29,399 --> 00:09:31,320
just start doing it because that's the

241
00:09:31,320 --> 00:09:32,399
whole point of it because the whole

242
00:09:32,399 --> 00:09:33,899
discussion is just delaying the whole

243
00:09:33,899 --> 00:09:36,180
work and of course there are more tools

244
00:09:36,180 --> 00:09:38,399
out there that can help you

245
00:09:38,399 --> 00:09:40,500
why should you have a disaster recovery

246
00:09:40,500 --> 00:09:42,480
plan

247
00:09:42,480 --> 00:09:45,060
ad Believe It or Not although

248
00:09:45,060 --> 00:09:47,459
everybody's focused on Azure ad which is

249
00:09:47,459 --> 00:09:49,500
the cool new stuff all around the world

250
00:09:49,500 --> 00:09:53,940
ad is still the identity system on-prem

251
00:09:53,940 --> 00:09:57,300
used by many many companies compromise

252
00:09:57,300 --> 00:10:00,420
ID most likely everything else connected

253
00:10:00,420 --> 00:10:03,000
to it goes down the drain

254
00:10:03,000 --> 00:10:06,420
of course you can't attack Azure ad in

255
00:10:06,420 --> 00:10:07,680
the terms that you can bring it down

256
00:10:07,680 --> 00:10:09,779
from adino you make it unavailable for

257
00:10:09,779 --> 00:10:11,700
that specific customer

258
00:10:11,700 --> 00:10:14,120
so if your ad is down

259
00:10:14,120 --> 00:10:15,839
depending of course on your

260
00:10:15,839 --> 00:10:17,399
authentication scenario how do you

261
00:10:17,399 --> 00:10:18,899
authenticate towards your and of course

262
00:10:18,899 --> 00:10:20,399
all your other services that's what I

263
00:10:20,399 --> 00:10:22,019
mean with the unavailability because

264
00:10:22,019 --> 00:10:24,779
Azure ID itself is there

265
00:10:24,779 --> 00:10:28,440
so although Legacy it's still very very

266
00:10:28,440 --> 00:10:31,140
important for many

267
00:10:31,140 --> 00:10:33,360
business reasoning business continuity

268
00:10:33,360 --> 00:10:36,240
for example in the Netherlands

269
00:10:36,240 --> 00:10:39,540
banks for example are obligated to have

270
00:10:39,540 --> 00:10:41,220
a disaster recovery plan in their

271
00:10:41,220 --> 00:10:42,839
business continuity plan

272
00:10:42,839 --> 00:10:45,260
because they must be able to recover

273
00:10:45,260 --> 00:10:47,760
especially if we are talking about

274
00:10:47,760 --> 00:10:50,640
that's the the word in Dutch system

275
00:10:50,640 --> 00:10:53,100
Banks those are we have a few in the

276
00:10:53,100 --> 00:10:56,100
Netherlands those are system banks that

277
00:10:56,100 --> 00:10:58,260
are very important to the whole country

278
00:10:58,260 --> 00:11:00,420
and the economy if one of those Banks go

279
00:11:00,420 --> 00:11:03,180
goes down for example in the economical

280
00:11:03,180 --> 00:11:05,519
crisis the government jumped in and

281
00:11:05,519 --> 00:11:06,899
saved the bank because it's too

282
00:11:06,899 --> 00:11:09,120
important to let it down but if it's a

283
00:11:09,120 --> 00:11:12,060
ransomware attack these the damage is

284
00:11:12,060 --> 00:11:15,240
severe so those uh business those

285
00:11:15,240 --> 00:11:17,100
businesses must have

286
00:11:17,100 --> 00:11:19,560
um uh Disaster Recovery due to all kinds

287
00:11:19,560 --> 00:11:22,079
of regulations the complexity well this

288
00:11:22,079 --> 00:11:23,820
applies to everyone

289
00:11:23,820 --> 00:11:25,980
some may think ah recovering active

290
00:11:25,980 --> 00:11:27,660
directory just restore a domain control

291
00:11:27,660 --> 00:11:29,519
just restore multiple domain controllers

292
00:11:29,519 --> 00:11:31,860
and you're done well it's not really

293
00:11:31,860 --> 00:11:33,959
like that it's really complex and I know

294
00:11:33,959 --> 00:11:35,579
because I've done it multiple times

295
00:11:35,579 --> 00:11:38,820
manually scripted but also with a tool

296
00:11:38,820 --> 00:11:41,880
and even with a tool you gain lots of

297
00:11:41,880 --> 00:11:44,459
time because many of the tasks are

298
00:11:44,459 --> 00:11:46,440
automated but still it's a lot of work

299
00:11:46,440 --> 00:11:48,120
and thinking and you always need to be

300
00:11:48,120 --> 00:11:50,040
with multiple people because it's really

301
00:11:50,040 --> 00:11:54,380
complex and many hours I know

302
00:11:55,079 --> 00:11:57,000
when you think about the complexity it's

303
00:11:57,000 --> 00:11:58,860
not about the technology only but also

304
00:11:58,860 --> 00:12:00,779
look at your company is it for example

305
00:12:00,779 --> 00:12:02,820
just a single data center is it a

306
00:12:02,820 --> 00:12:05,760
distributed company is it um

307
00:12:05,760 --> 00:12:07,800
does it have multiple stakeholders

308
00:12:07,800 --> 00:12:09,000
throughout the world

309
00:12:09,000 --> 00:12:11,040
how about decision making when do you

310
00:12:11,040 --> 00:12:12,660
make the decision we are going to

311
00:12:12,660 --> 00:12:13,920
recover

312
00:12:13,920 --> 00:12:16,200
okay if you have been ransomware well

313
00:12:16,200 --> 00:12:18,899
the decision is very easy but I have

314
00:12:18,899 --> 00:12:20,459
also the experience where a company has

315
00:12:20,459 --> 00:12:22,740
been attacked and where the ID this is

316
00:12:22,740 --> 00:12:24,000
by the way the scenario that I'm going

317
00:12:24,000 --> 00:12:25,200
to explain is still up and running

318
00:12:25,200 --> 00:12:26,700
surprisingly

319
00:12:26,700 --> 00:12:28,440
when do you make the decision we are

320
00:12:28,440 --> 00:12:31,200
going back and I'm going to help you by

321
00:12:31,200 --> 00:12:33,540
giving you an idea risk management

322
00:12:33,540 --> 00:12:35,640
risk management you need to think about

323
00:12:35,640 --> 00:12:38,160
scenarios which scenarios well let's

324
00:12:38,160 --> 00:12:40,079
have a look at these scenarios

325
00:12:40,079 --> 00:12:42,240
years and years ago many of us were

326
00:12:42,240 --> 00:12:43,500
talking about

327
00:12:43,500 --> 00:12:45,360
what's the probability and the impact of

328
00:12:45,360 --> 00:12:48,060
the scenario and we were

329
00:12:48,060 --> 00:12:50,220
sorry

330
00:12:50,220 --> 00:12:54,600
we were focused on the lower part

331
00:12:54,600 --> 00:12:57,120
schema changes that went bad

332
00:12:57,120 --> 00:12:59,459
never seen one and if the schema changes

333
00:12:59,459 --> 00:13:01,560
goes bad you can even defunct it so

334
00:13:01,560 --> 00:13:03,420
there are many many things that we were

335
00:13:03,420 --> 00:13:06,060
planning for they never occurred

336
00:13:06,060 --> 00:13:07,800
but today

337
00:13:07,800 --> 00:13:09,300
ransomware

338
00:13:09,300 --> 00:13:12,180
number one it's as common as having

339
00:13:12,180 --> 00:13:14,459
coffee because it happens every single

340
00:13:14,459 --> 00:13:16,260
day hackers

341
00:13:16,260 --> 00:13:19,680
try to attack you on your weakest moment

342
00:13:19,680 --> 00:13:22,680
every single time every single time I

343
00:13:22,680 --> 00:13:24,180
was called and my colleagues were called

344
00:13:24,180 --> 00:13:27,380
were always on a Friday Saturday Sunday

345
00:13:27,380 --> 00:13:31,019
always those guys do not work from eight

346
00:13:31,019 --> 00:13:34,740
to five it's always or in holiday so

347
00:13:34,740 --> 00:13:36,060
when you are at your weakest moment

348
00:13:36,060 --> 00:13:37,980
that's when they will grab you because

349
00:13:37,980 --> 00:13:39,720
nobody's there people are on vacations

350
00:13:39,720 --> 00:13:41,579
whatever everybody knows it so

351
00:13:41,579 --> 00:13:43,260
ransomware that's the number one reason

352
00:13:43,260 --> 00:13:45,360
today

353
00:13:45,360 --> 00:13:47,940
active directory plan options there are

354
00:13:47,940 --> 00:13:48,779
multiple

355
00:13:48,779 --> 00:13:51,839
and just to summarize them I'm talking

356
00:13:51,839 --> 00:13:53,279
about we have

357
00:13:53,279 --> 00:13:55,320
the default Disaster Recovery plan from

358
00:13:55,320 --> 00:13:57,480
Microsoft for all of you that have read

359
00:13:57,480 --> 00:13:59,820
it it's on the Internet it's a lot of

360
00:13:59,820 --> 00:14:00,779
text

361
00:14:00,779 --> 00:14:03,480
and if you try to say well that's my

362
00:14:03,480 --> 00:14:04,500
plan

363
00:14:04,500 --> 00:14:06,839
by just getting the Microsoft logo out

364
00:14:06,839 --> 00:14:08,519
of it and then putting your logo on it

365
00:14:08,519 --> 00:14:10,680
well please think again don't do it I've

366
00:14:10,680 --> 00:14:12,839
seen it happen where people say well

367
00:14:12,839 --> 00:14:15,899
this is my Disaster Recovery plan and

368
00:14:15,899 --> 00:14:18,680
probably that's just for some

369
00:14:18,680 --> 00:14:22,560
regulations checkbook yeah I had a plan

370
00:14:22,560 --> 00:14:25,139
but can you even execute it because if

371
00:14:25,139 --> 00:14:27,839
you try to execute just by what's doing

372
00:14:27,839 --> 00:14:31,620
what's in there it will take you ages

373
00:14:31,620 --> 00:14:34,019
before you even get to a certain state

374
00:14:34,019 --> 00:14:35,940
and then you have to also to look and

375
00:14:35,940 --> 00:14:38,700
look at is it correctly described does

376
00:14:38,700 --> 00:14:41,279
it take everything into account

377
00:14:41,279 --> 00:14:44,820
I can tell you for sure it does not it's

378
00:14:44,820 --> 00:14:46,800
just a guidance for you to create your

379
00:14:46,800 --> 00:14:48,240
own plan

380
00:14:48,240 --> 00:14:50,279
another way to have a look at it is to

381
00:14:50,279 --> 00:14:53,160
okay let's take that plan

382
00:14:53,160 --> 00:14:55,920
and then customize it and script it

383
00:14:55,920 --> 00:14:58,139
every single task that you need to do

384
00:14:58,139 --> 00:14:59,519
for ad or the domain controls or

385
00:14:59,519 --> 00:15:01,740
whatever you can script it I've done it

386
00:15:01,740 --> 00:15:04,560
it's a lot of work it requires lots of

387
00:15:04,560 --> 00:15:06,720
knowledge because you need to know what

388
00:15:06,720 --> 00:15:09,540
to do when to do and how to do it and

389
00:15:09,540 --> 00:15:10,560
then there's the question about

390
00:15:10,560 --> 00:15:13,139
maintenance if something changes in your

391
00:15:13,139 --> 00:15:15,300
environment you need to keep see if it

392
00:15:15,300 --> 00:15:16,980
still works because something might

393
00:15:16,980 --> 00:15:19,699
break in the end

394
00:15:21,959 --> 00:15:24,540
okay we sell a tool so our preferred way

395
00:15:24,540 --> 00:15:27,839
is the customized ID plan but then fully

396
00:15:27,839 --> 00:15:29,880
automated everything that's about

397
00:15:29,880 --> 00:15:33,060
recovery is fully automated as I just

398
00:15:33,060 --> 00:15:35,880
showed to you click a button go do

399
00:15:35,880 --> 00:15:39,680
something else come back when it's done

400
00:15:42,120 --> 00:15:44,339
then comparing again

401
00:15:44,339 --> 00:15:46,740
how it works

402
00:15:46,740 --> 00:15:48,420
um

403
00:15:48,420 --> 00:15:51,000
the two left options basically

404
00:15:51,000 --> 00:15:53,820
think in the way okay from every single

405
00:15:53,820 --> 00:15:55,980
domain restore the initial domain

406
00:15:55,980 --> 00:15:57,600
controllers

407
00:15:57,600 --> 00:15:59,519
clean them up do whatever you need to do

408
00:15:59,519 --> 00:16:01,740
and then build from there by

409
00:16:01,740 --> 00:16:04,440
re-promoting by cloning because I can

410
00:16:04,440 --> 00:16:05,880
imagine if you have a very big company

411
00:16:05,880 --> 00:16:07,620
that you have the initial domain

412
00:16:07,620 --> 00:16:09,899
controllers and then clone them as

413
00:16:09,899 --> 00:16:12,839
rabbits so that you can handle the

414
00:16:12,839 --> 00:16:15,000
authentication load think about the

415
00:16:15,000 --> 00:16:16,620
authentication load because if you put

416
00:16:16,620 --> 00:16:18,660
the initial domain controllers in

417
00:16:18,660 --> 00:16:19,620
production

418
00:16:19,620 --> 00:16:21,660
they will probably die because

419
00:16:21,660 --> 00:16:24,740
everybody's banging at them applications

420
00:16:24,740 --> 00:16:27,660
users whatever everything

421
00:16:27,660 --> 00:16:29,940
so you need to be prepared and to put

422
00:16:29,940 --> 00:16:32,040
something there that is ready to handle

423
00:16:32,040 --> 00:16:34,500
the load and then distribute accordingly

424
00:16:34,500 --> 00:16:36,839
of course this depends on how big your

425
00:16:36,839 --> 00:16:39,500
environment is

426
00:16:39,720 --> 00:16:41,639
as I mentioned before regarding the

427
00:16:41,639 --> 00:16:44,160
skills on the left two yeah

428
00:16:44,160 --> 00:16:46,620
um you really need to have very deep

429
00:16:46,620 --> 00:16:49,139
deep skills or many skills to understand

430
00:16:49,139 --> 00:16:51,480
what needs to be done the order and also

431
00:16:51,480 --> 00:16:53,220
regarding the tools

432
00:16:53,220 --> 00:16:56,040
if you have a tool you don't need to

433
00:16:56,040 --> 00:16:57,600
have the skills regarding the whole

434
00:16:57,600 --> 00:17:00,120
thing because it's done by the tool it

435
00:17:00,120 --> 00:17:02,940
doesn't mean by having a tool and for

436
00:17:02,940 --> 00:17:04,439
those companies that have said or are

437
00:17:04,439 --> 00:17:06,720
thinking oh I have a tool I'm covered

438
00:17:06,720 --> 00:17:08,880
the tool will help you but you're still

439
00:17:08,880 --> 00:17:10,319
not there you still have lots of

440
00:17:10,319 --> 00:17:13,079
pre-tasks and post tags to do tasks to

441
00:17:13,079 --> 00:17:15,359
do because this is about ad

442
00:17:15,359 --> 00:17:17,880
think about everything else connected to

443
00:17:17,880 --> 00:17:20,819
ad workstation servers for which a

444
00:17:20,819 --> 00:17:22,319
secure channel will fail because when

445
00:17:22,319 --> 00:17:24,500
you go back in time

446
00:17:24,500 --> 00:17:28,020
objects don't exist anymore or objects

447
00:17:28,020 --> 00:17:29,460
that were deleted

448
00:17:29,460 --> 00:17:31,320
are suddenly there again

449
00:17:31,320 --> 00:17:33,660
and think about Azure the connections

450
00:17:33,660 --> 00:17:36,660
there will be a serious mismatch

451
00:17:36,660 --> 00:17:38,940
think about passwords you go back in

452
00:17:38,940 --> 00:17:41,880
time passwords will be a problem

453
00:17:41,880 --> 00:17:45,679
for computers but also users

454
00:17:47,039 --> 00:17:49,980
complexity again well you can see it on

455
00:17:49,980 --> 00:17:51,299
screen

456
00:17:51,299 --> 00:17:52,440
um

457
00:17:52,440 --> 00:17:54,720
with a tool it is easier even if it's

458
00:17:54,720 --> 00:17:56,820
scripted it's even easier than using the

459
00:17:56,820 --> 00:17:58,799
manual approach so it's somewhere in the

460
00:17:58,799 --> 00:18:00,840
middle and the recovery time objective

461
00:18:00,840 --> 00:18:04,260
that's my whole goal with the demo while

462
00:18:04,260 --> 00:18:06,419
I'm talking the ID is going to be

463
00:18:06,419 --> 00:18:08,760
recovered think about it yes it's just

464
00:18:08,760 --> 00:18:11,100
five domain controllers I know but it's

465
00:18:11,100 --> 00:18:13,679
crappy Hardware it's not your full-blown

466
00:18:13,679 --> 00:18:15,240
production Hardware running out there

467
00:18:15,240 --> 00:18:16,799
and

468
00:18:16,799 --> 00:18:18,240
um yeah it's just a few domain

469
00:18:18,240 --> 00:18:20,520
controllers but it's about the idea I'm

470
00:18:20,520 --> 00:18:22,020
talking and the thing is recovering and

471
00:18:22,020 --> 00:18:25,039
in the end it will be working

472
00:18:26,640 --> 00:18:29,880
have you thought about the following

473
00:18:29,880 --> 00:18:32,460
if you have a plan sorry if you have a

474
00:18:32,460 --> 00:18:34,559
planned code tooling whatever where do

475
00:18:34,559 --> 00:18:36,059
you store it

476
00:18:36,059 --> 00:18:39,320
not on SharePoint

477
00:18:41,580 --> 00:18:45,000
also not on SharePoint online you need

478
00:18:45,000 --> 00:18:47,039
to have something that is not a d

479
00:18:47,039 --> 00:18:49,080
dependent

480
00:18:49,080 --> 00:18:51,120
I've seen it happen and think about the

481
00:18:51,120 --> 00:18:52,980
following scenario

482
00:18:52,980 --> 00:18:55,559
add a customer we had a

483
00:18:55,559 --> 00:18:58,860
um a let's call it location where

484
00:18:58,860 --> 00:19:00,780
information was stored I.T information

485
00:19:00,780 --> 00:19:04,020
and it was non-ad dependent

486
00:19:04,020 --> 00:19:06,240
the disaster recovery plan was also

487
00:19:06,240 --> 00:19:09,660
there I wrote it it was there and every

488
00:19:09,660 --> 00:19:11,220
single time I had to log on to that

489
00:19:11,220 --> 00:19:13,140
location I had to provide my username

490
00:19:13,140 --> 00:19:16,140
and password which was not from ad was

491
00:19:16,140 --> 00:19:19,200
from that system and it was one day

492
00:19:19,200 --> 00:19:21,900
when I suddenly experienced

493
00:19:21,900 --> 00:19:24,179
on this word why am I not being asked

494
00:19:24,179 --> 00:19:25,559
for credentials

495
00:19:25,559 --> 00:19:27,840
okay whatever

496
00:19:27,840 --> 00:19:29,400
probably cashing

497
00:19:29,400 --> 00:19:31,260
next day next week and I was done

498
00:19:31,260 --> 00:19:34,980
started to ask did somebody enable SSO

499
00:19:34,980 --> 00:19:38,460
and SSL was enabled depending on ad

500
00:19:38,460 --> 00:19:41,280
watch out for that something might

501
00:19:41,280 --> 00:19:43,320
somebody or something or whatever might

502
00:19:43,320 --> 00:19:46,140
change suddenly you have SSO having a

503
00:19:46,140 --> 00:19:48,480
dependency on ad and the moment you need

504
00:19:48,480 --> 00:19:50,580
it oh dear

505
00:19:50,580 --> 00:19:52,440
do you have a background sorry a

506
00:19:52,440 --> 00:19:54,120
backdoor account that still allows you

507
00:19:54,120 --> 00:19:56,600
to go in

508
00:19:56,880 --> 00:20:00,299
credentials when you go back in time

509
00:20:00,299 --> 00:20:02,700
and now I'm going to exaggerate let's

510
00:20:02,700 --> 00:20:04,500
say that you would go back in time for a

511
00:20:04,500 --> 00:20:05,520
month

512
00:20:05,520 --> 00:20:07,919
do you still have the the main admin

513
00:20:07,919 --> 00:20:10,559
password for a month ago do you know

514
00:20:10,559 --> 00:20:13,200
that so one of the best practices is as

515
00:20:13,200 --> 00:20:15,000
I was already mentioned during the

516
00:20:15,000 --> 00:20:17,220
introduction I'm the one that wrote the

517
00:20:17,220 --> 00:20:19,679
curved TGT password reset script the

518
00:20:19,679 --> 00:20:21,419
best Ram uh the the best practice

519
00:20:21,419 --> 00:20:23,400
recommendation is to

520
00:20:23,400 --> 00:20:25,380
use that script or something else

521
00:20:25,380 --> 00:20:27,120
whatever you want it's not mandatory of

522
00:20:27,120 --> 00:20:29,220
course but at least reset the password

523
00:20:29,220 --> 00:20:31,740
of the curb TGT account for every single

524
00:20:31,740 --> 00:20:34,260
domain every six months

525
00:20:34,260 --> 00:20:36,179
if you ask me for the default domain

526
00:20:36,179 --> 00:20:38,280
admin account you should do the same

527
00:20:38,280 --> 00:20:41,760
reset it maybe but preferably change it

528
00:20:41,760 --> 00:20:43,620
and every single time you change the

529
00:20:43,620 --> 00:20:44,580
password

530
00:20:44,580 --> 00:20:47,100
make sure to write down somewhere of

531
00:20:47,100 --> 00:20:48,539
course in a secure location password

532
00:20:48,539 --> 00:20:51,539
Vault for example to record which were

533
00:20:51,539 --> 00:20:53,220
the older passwords

534
00:20:53,220 --> 00:20:55,440
you don't need to keep passwords from

535
00:20:55,440 --> 00:20:57,059
five years because you will never go

536
00:20:57,059 --> 00:20:59,039
back for five years unless that's your

537
00:20:59,039 --> 00:21:01,880
last resort but okay you never know

538
00:21:01,880 --> 00:21:05,100
but if you keep them it's just a number

539
00:21:05,100 --> 00:21:06,600
for two years it's good enough because

540
00:21:06,600 --> 00:21:09,240
it might happen you created a backup you

541
00:21:09,240 --> 00:21:11,280
change the password you need to recover

542
00:21:11,280 --> 00:21:13,440
you go back a week to that moment oh

543
00:21:13,440 --> 00:21:15,900
your password is different oops if you

544
00:21:15,900 --> 00:21:18,179
can't log in you have an issue

545
00:21:18,179 --> 00:21:20,400
think about for the same scenario

546
00:21:20,400 --> 00:21:22,679
disaster sorry uh your directory

547
00:21:22,679 --> 00:21:24,840
Services restore mode accounts those

548
00:21:24,840 --> 00:21:26,940
accounts that are basically uh per

549
00:21:26,940 --> 00:21:30,000
domain controller there is a a way by

550
00:21:30,000 --> 00:21:31,740
the way where you can create an account

551
00:21:31,740 --> 00:21:33,120
in ID

552
00:21:33,120 --> 00:21:34,799
and you can have every single domain

553
00:21:34,799 --> 00:21:35,940
controller for example through a

554
00:21:35,940 --> 00:21:38,159
scheduled task sync the password of that

555
00:21:38,159 --> 00:21:40,500
that disabled account to its dsrm

556
00:21:40,500 --> 00:21:42,900
account and it happens automatically so

557
00:21:42,900 --> 00:21:44,640
instead of going throughout all the

558
00:21:44,640 --> 00:21:46,440
domain controllers and changing all

559
00:21:46,440 --> 00:21:49,020
those account passwords just change it

560
00:21:49,020 --> 00:21:50,940
every six months in that on that ID

561
00:21:50,940 --> 00:21:52,799
account and if you have that scheduled

562
00:21:52,799 --> 00:21:55,140
task enabled something you need to do it

563
00:21:55,140 --> 00:21:57,539
will sync it automatically again keep

564
00:21:57,539 --> 00:21:59,840
the history

565
00:22:02,100 --> 00:22:04,559
as I mentioned when I began

566
00:22:04,559 --> 00:22:08,340
I said I was in a in a disaster recovery

567
00:22:08,340 --> 00:22:10,260
scenario for a customer and that

568
00:22:10,260 --> 00:22:13,260
customer asked me the following question

569
00:22:13,260 --> 00:22:15,960
we have ad which is done

570
00:22:15,960 --> 00:22:18,240
we have Azure ad connect which is down

571
00:22:18,240 --> 00:22:21,600
we have services in Azure ID which is

572
00:22:21,600 --> 00:22:24,960
working and all kinds of other stuff

573
00:22:24,960 --> 00:22:28,679
but we were using password through sorry

574
00:22:28,679 --> 00:22:31,380
patch through Authentication

575
00:22:31,380 --> 00:22:34,380
is there any way to switch to

576
00:22:34,380 --> 00:22:36,900
native authentication in Azure the

577
00:22:36,900 --> 00:22:39,780
answer simply is no

578
00:22:39,780 --> 00:22:41,700
why because we pass through

579
00:22:41,700 --> 00:22:43,799
authentication you told Azure when I

580
00:22:43,799 --> 00:22:46,559
authenticate please redirect me to my

581
00:22:46,559 --> 00:22:48,299
domain controls oops those are not

582
00:22:48,299 --> 00:22:50,480
available

583
00:23:10,880 --> 00:23:15,419
use password hashing at least because it

584
00:23:15,419 --> 00:23:17,539
is

585
00:23:17,580 --> 00:23:19,620
it's a blunt remark I know because

586
00:23:19,620 --> 00:23:22,080
security people will no I don't want to

587
00:23:22,080 --> 00:23:23,400
have the passwords in the cloud because

588
00:23:23,400 --> 00:23:25,500
it's security issue I know yeah yeah and

589
00:23:25,500 --> 00:23:26,580
then you get all kinds of discussion

590
00:23:26,580 --> 00:23:29,039
nothing happens been there

591
00:23:29,039 --> 00:23:31,140
but then you have recovery

592
00:23:31,140 --> 00:23:32,520
sorry

593
00:23:32,520 --> 00:23:35,220
we decided not to use password hash sync

594
00:23:35,220 --> 00:23:37,020
and now we can't do anything in the

595
00:23:37,020 --> 00:23:38,520
whole business it's basically here I'm

596
00:23:38,520 --> 00:23:39,600
waiting

597
00:23:39,600 --> 00:23:42,780
if you have password test sync you can

598
00:23:42,780 --> 00:23:45,120
start using the services immediately as

599
00:23:45,120 --> 00:23:46,860
if nothing happened if you have

600
00:23:46,860 --> 00:23:49,320
Federated authentication you can still

601
00:23:49,320 --> 00:23:51,559
use it because it's a back

602
00:23:51,559 --> 00:23:54,360
authentication mechanism but still on

603
00:23:54,360 --> 00:23:56,760
Azure don't forget your break glass

604
00:23:56,760 --> 00:24:00,179
accounts also in a password Vault don't

605
00:24:00,179 --> 00:24:01,380
be

606
00:24:01,380 --> 00:24:04,260
uh no you need to have Azure ad specific

607
00:24:04,260 --> 00:24:06,059
admin accounts

608
00:24:06,059 --> 00:24:08,280
don't sync your admin accounts to Azure

609
00:24:08,280 --> 00:24:10,799
bad thing to do because if

610
00:24:10,799 --> 00:24:13,080
authentication doesn't work game over

611
00:24:13,080 --> 00:24:15,240
the only way to that can get there is

612
00:24:15,240 --> 00:24:17,640
Microsoft so

613
00:24:17,640 --> 00:24:19,140
the only thing that you would need to do

614
00:24:19,140 --> 00:24:21,780
with a Federated authentication is to go

615
00:24:21,780 --> 00:24:23,520
into Azure user break class account

616
00:24:23,520 --> 00:24:25,799
switch the authentication mechanism for

617
00:24:25,799 --> 00:24:27,299
the specific domain to be moved from

618
00:24:27,299 --> 00:24:29,520
Federated to Native and then everything

619
00:24:29,520 --> 00:24:32,159
goes as if it was normal

620
00:24:32,159 --> 00:24:34,380
there's a catch and that's something

621
00:24:34,380 --> 00:24:36,480
that I experienced which I still don't

622
00:24:36,480 --> 00:24:38,400
fully understand how and why but okay it

623
00:24:38,400 --> 00:24:39,840
was there and I would like to share with

624
00:24:39,840 --> 00:24:42,240
you is as soon as I did that in my test

625
00:24:42,240 --> 00:24:44,580
environment switching from Federation to

626
00:24:44,580 --> 00:24:47,940
Native identity protection kicked in

627
00:24:47,940 --> 00:24:50,760
which I had enabled in my tenant

628
00:24:50,760 --> 00:24:53,280
it kicked in and it forced me to change

629
00:24:53,280 --> 00:24:54,539
the password

630
00:24:54,539 --> 00:24:56,940
it's not necessarily a bad idea but then

631
00:24:56,940 --> 00:24:58,679
as soon you start changing the passwords

632
00:24:58,679 --> 00:25:01,140
in Azure you will have a mismatch

633
00:25:01,140 --> 00:25:03,600
with ad think about it is there a way to

634
00:25:03,600 --> 00:25:06,679
get out well just thinking out loud

635
00:25:06,679 --> 00:25:09,679
make sure that those people need to

636
00:25:09,679 --> 00:25:12,659
force the password change and then when

637
00:25:12,659 --> 00:25:14,400
the sync is up again use cell service

638
00:25:14,400 --> 00:25:16,559
password reset with passwords right back

639
00:25:16,559 --> 00:25:20,159
and then the whole thing is synced again

640
00:25:20,159 --> 00:25:24,260
when you're back when you're back

641
00:25:25,799 --> 00:25:28,279
sorry

642
00:25:29,580 --> 00:25:31,740
two that is true so the question is if

643
00:25:31,740 --> 00:25:33,600
the ID is compromised you need to change

644
00:25:33,600 --> 00:25:35,520
password that is true but I'm talking

645
00:25:35,520 --> 00:25:37,799
about while the ad is down you will

646
00:25:37,799 --> 00:25:39,240
switch the authentication mechanism

647
00:25:39,240 --> 00:25:40,740
let's say that you have identity

648
00:25:40,740 --> 00:25:42,779
protection enabled in my case it's

649
00:25:42,779 --> 00:25:45,179
forced me to change the password so all

650
00:25:45,179 --> 00:25:46,980
the passwords let the same assume that

651
00:25:46,980 --> 00:25:48,539
everybody logs on

652
00:25:48,539 --> 00:25:50,340
um would be changed in Azure but then

653
00:25:50,340 --> 00:25:51,799
you have a match

654
00:25:51,799 --> 00:25:55,799
in uh NAD sorry mismatching ID how do

655
00:25:55,799 --> 00:25:58,740
you communicate to people

656
00:25:58,740 --> 00:26:01,740
so by forcing them on-prem to change the

657
00:26:01,740 --> 00:26:03,900
password or even from Azure well it's

658
00:26:03,900 --> 00:26:06,000
more complicated than I'm saying it is

659
00:26:06,000 --> 00:26:07,980
but it's it's just an idea make sure

660
00:26:07,980 --> 00:26:10,919
it's done in Azure and then sync back so

661
00:26:10,919 --> 00:26:12,659
that there's a match again between the

662
00:26:12,659 --> 00:26:14,039
two

663
00:26:14,039 --> 00:26:15,960
and Azure ID connect will then do the

664
00:26:15,960 --> 00:26:18,360
the other one the authentication method

665
00:26:18,360 --> 00:26:20,880
well it's as I just explained if you are

666
00:26:20,880 --> 00:26:23,940
on PTA you need and you need to do a

667
00:26:23,940 --> 00:26:26,520
recovery you can't use your Azure

668
00:26:26,520 --> 00:26:28,620
Services sorry

669
00:26:28,620 --> 00:26:30,360
you need to wait until you're back again

670
00:26:30,360 --> 00:26:32,640
that was the story I had to tell this

671
00:26:32,640 --> 00:26:34,679
customer it wasn't a nice story but at

672
00:26:34,679 --> 00:26:36,360
least it was the truth

673
00:26:36,360 --> 00:26:39,799
this is the real life scenario

674
00:26:39,900 --> 00:26:42,900
this is for Real

675
00:26:42,900 --> 00:26:45,120
this is an environment at a customer

676
00:26:45,120 --> 00:26:47,899
simplified

677
00:26:50,220 --> 00:26:51,720
on a Sunday

678
00:26:51,720 --> 00:26:53,700
I call it calls me

679
00:26:53,700 --> 00:26:55,260
a colleague that I really like to work

680
00:26:55,260 --> 00:26:56,220
with

681
00:26:56,220 --> 00:26:57,900
and I was like well he never calls on

682
00:26:57,900 --> 00:26:59,880
Sunday oh dear

683
00:26:59,880 --> 00:27:03,539
and yes my thoughts were we this is

684
00:27:03,539 --> 00:27:05,400
going to be a long week and it was a

685
00:27:05,400 --> 00:27:06,720
long week

686
00:27:06,720 --> 00:27:08,760
we started next month the the Monday

687
00:27:08,760 --> 00:27:11,419
after and after talking to the customer

688
00:27:11,419 --> 00:27:14,760
the whole environment was compromised

689
00:27:14,760 --> 00:27:16,860
all kinds of bad things happening but

690
00:27:16,860 --> 00:27:20,400
the ad was still running surprisingly

691
00:27:20,400 --> 00:27:22,020
and that surprised us because most of

692
00:27:22,020 --> 00:27:24,480
the times at least what we are seeing is

693
00:27:24,480 --> 00:27:26,940
when they attack you they try to encrypt

694
00:27:26,940 --> 00:27:28,559
everything and bring you to your knees

695
00:27:28,559 --> 00:27:30,600
so that you can pay Ransom these days

696
00:27:30,600 --> 00:27:32,340
the golden

697
00:27:32,340 --> 00:27:35,520
scenario is double extortion they try to

698
00:27:35,520 --> 00:27:37,860
steal data and then they encrypt

699
00:27:37,860 --> 00:27:39,600
everything because if you have encrypted

700
00:27:39,600 --> 00:27:41,520
everything and you still have backups

701
00:27:41,520 --> 00:27:43,020
you can you can still go back but

702
00:27:43,020 --> 00:27:45,179
because they have their data they can

703
00:27:45,179 --> 00:27:46,919
put some pressure on it so that they

704
00:27:46,919 --> 00:27:48,900
still get money and then it's up to you

705
00:27:48,900 --> 00:27:52,080
okay how much how how worth is that data

706
00:27:52,080 --> 00:27:55,080
to me if it becomes public I don't know

707
00:27:55,080 --> 00:27:57,720
so even if you're able to recover you

708
00:27:57,720 --> 00:27:59,700
might still think ah let's just pay the

709
00:27:59,700 --> 00:28:01,320
money but still there is no guarantee

710
00:28:01,320 --> 00:28:04,340
it's a hacker

711
00:28:05,100 --> 00:28:07,620
the environment what's compromised but

712
00:28:07,620 --> 00:28:09,179
up and running

713
00:28:09,179 --> 00:28:10,679
surprisingly

714
00:28:10,679 --> 00:28:12,840
the first thing we did we used our

715
00:28:12,840 --> 00:28:14,220
solution

716
00:28:14,220 --> 00:28:16,559
were created a backup because we weren't

717
00:28:16,559 --> 00:28:18,120
entirely sure the backups of the

718
00:28:18,120 --> 00:28:20,340
customer would work or if there was any

719
00:28:20,340 --> 00:28:22,980
dependency with ad we just didn't know

720
00:28:22,980 --> 00:28:25,020
that's also one of the things that we

721
00:28:25,020 --> 00:28:28,200
encounter is I know

722
00:28:28,200 --> 00:28:31,020
from a human perspective everybody's

723
00:28:31,020 --> 00:28:32,880
trying to do their best but if people

724
00:28:32,880 --> 00:28:34,799
don't have a null the knowledge on how

725
00:28:34,799 --> 00:28:37,460
to do things think about education

726
00:28:37,460 --> 00:28:40,620
yeah they will still try their best to

727
00:28:40,620 --> 00:28:42,779
achieve a certain goal but in the end it

728
00:28:42,779 --> 00:28:45,600
might still be not the good way to do

729
00:28:45,600 --> 00:28:48,620
something it happens

730
00:28:50,400 --> 00:28:53,760
while the ID was still up and running we

731
00:28:53,760 --> 00:28:56,039
made a quick decision let's back up this

732
00:28:56,039 --> 00:28:58,440
thing immediately

733
00:28:58,440 --> 00:29:01,220
let's perform a forest recovery

734
00:29:01,220 --> 00:29:05,940
immediately on in an isolated Network

735
00:29:05,940 --> 00:29:07,919
of the forest

736
00:29:07,919 --> 00:29:10,679
just a few DC's because we did not know

737
00:29:10,679 --> 00:29:13,980
if this guy would go down it was still

738
00:29:13,980 --> 00:29:16,440
up and running we were just wanted to be

739
00:29:16,440 --> 00:29:19,140
prepared if it goes down we all already

740
00:29:19,140 --> 00:29:20,640
halfway

741
00:29:20,640 --> 00:29:24,059
with the recovery so alongside we

742
00:29:24,059 --> 00:29:25,980
started the forest recovery in an

743
00:29:25,980 --> 00:29:28,740
isolated Network think about it when you

744
00:29:28,740 --> 00:29:32,399
restore a backup don't put your machines

745
00:29:32,399 --> 00:29:35,279
back into production

746
00:29:35,279 --> 00:29:37,559
make sure you go to the latest operating

747
00:29:37,559 --> 00:29:41,159
system fully patched and then make sure

748
00:29:41,159 --> 00:29:43,020
to scan your ID the one that you have

749
00:29:43,020 --> 00:29:45,000
restored before putting it back to

750
00:29:45,000 --> 00:29:46,799
production using for example purple

751
00:29:46,799 --> 00:29:48,419
Knight Bloodhound pin console or

752
00:29:48,419 --> 00:29:50,340
whatever tool you have out there make

753
00:29:50,340 --> 00:29:52,740
sure you scan it and fix everything that

754
00:29:52,740 --> 00:29:55,740
is critical to you before you release it

755
00:29:55,740 --> 00:29:56,700
to production

756
00:29:56,700 --> 00:29:59,580
if you just restore it and put it back

757
00:29:59,580 --> 00:30:01,679
start your stop your stopwatch

758
00:30:01,679 --> 00:30:04,080
it won't take long

759
00:30:04,080 --> 00:30:05,940
the funny thing is that I've never seen

760
00:30:05,940 --> 00:30:08,279
it before we all know the last log on

761
00:30:08,279 --> 00:30:10,500
and the last log on timestamps

762
00:30:10,500 --> 00:30:13,740
last logon is very accurate but it's a

763
00:30:13,740 --> 00:30:15,960
per domain controller attribute it

764
00:30:15,960 --> 00:30:18,419
doesn't replicate

765
00:30:18,419 --> 00:30:21,539
last log on timestamp is has a 14 day

766
00:30:21,539 --> 00:30:22,559
lag

767
00:30:22,559 --> 00:30:26,460
but it replicates so one that's well not

768
00:30:26,460 --> 00:30:28,980
the best of both worlds but there's a

769
00:30:28,980 --> 00:30:31,799
third one and the third one I know it

770
00:30:31,799 --> 00:30:34,140
exists in ID but I've never ever ever

771
00:30:34,140 --> 00:30:36,539
seen it in an environment this customer

772
00:30:36,539 --> 00:30:40,140
had a special feature in ad enabled

773
00:30:40,140 --> 00:30:42,720
where every single authentication

774
00:30:42,720 --> 00:30:45,960
whether successful or failed was written

775
00:30:45,960 --> 00:30:48,840
onto the account so we could see how

776
00:30:48,840 --> 00:30:50,820
many failed attempts how many successful

777
00:30:50,820 --> 00:30:52,919
attempts even the last log on time and

778
00:30:52,919 --> 00:30:55,620
it replicated very accurate it's it

779
00:30:55,620 --> 00:30:57,240
would write the information on the

780
00:30:57,240 --> 00:30:59,580
account itself lots of it

781
00:30:59,580 --> 00:31:01,980
I'm not saying this and then telling you

782
00:31:01,980 --> 00:31:04,380
it's a recommended thing no it's what we

783
00:31:04,380 --> 00:31:07,559
saw so we have two products one that

784
00:31:07,559 --> 00:31:09,779
catches the changes in ID

785
00:31:09,779 --> 00:31:12,059
and it was running against this one and

786
00:31:12,059 --> 00:31:14,100
then we also implemented against this

787
00:31:14,100 --> 00:31:17,220
one and what we were seeing was password

788
00:31:17,220 --> 00:31:19,799
spray attacks going on why we were able

789
00:31:19,799 --> 00:31:21,299
to see it because those are changes on

790
00:31:21,299 --> 00:31:23,820
the objects many of them so this was a

791
00:31:23,820 --> 00:31:27,600
waterfall of password spray attacks the

792
00:31:27,600 --> 00:31:29,399
information was coming in because we

793
00:31:29,399 --> 00:31:31,260
were catching all those changes so we

794
00:31:31,260 --> 00:31:33,179
restored it

795
00:31:33,179 --> 00:31:35,220
and this is about the whole backup just

796
00:31:35,220 --> 00:31:38,399
the whole change many solutions

797
00:31:38,399 --> 00:31:40,500
approach the whole backup but let's back

798
00:31:40,500 --> 00:31:42,659
up the whole operating system

799
00:31:42,659 --> 00:31:45,120
in a ransomware attack what is a

800
00:31:45,120 --> 00:31:47,520
possibility that the rent the the the

801
00:31:47,520 --> 00:31:50,059
operated system might contain malware

802
00:31:50,059 --> 00:31:54,120
viruses all kinds of other crap scripts

803
00:31:54,120 --> 00:31:56,480
from the attacker to disable stuff

804
00:31:56,480 --> 00:32:00,659
scheduled tasks you have no idea we and

805
00:32:00,659 --> 00:32:03,000
maybe many other Solutions we only care

806
00:32:03,000 --> 00:32:06,419
what's about ad we care about the the

807
00:32:06,419 --> 00:32:08,279
the the database and we care about the

808
00:32:08,279 --> 00:32:10,260
cisfault we don't care about the

809
00:32:10,260 --> 00:32:12,299
operating system so when we do a backup

810
00:32:12,299 --> 00:32:15,480
we only back up the ad database and this

811
00:32:15,480 --> 00:32:18,059
is full everything else I don't care

812
00:32:18,059 --> 00:32:21,179
the restore same story

813
00:32:21,179 --> 00:32:23,159
some of you might think yeah but the

814
00:32:23,159 --> 00:32:25,620
system can still contain bad stuff very

815
00:32:25,620 --> 00:32:28,440
true because it's a file based thing

816
00:32:28,440 --> 00:32:30,299
we have a feature

817
00:32:30,299 --> 00:32:32,520
an option where you can say let's

818
00:32:32,520 --> 00:32:34,679
quarantine this everything that looks

819
00:32:34,679 --> 00:32:37,679
like an executable batch script in file

820
00:32:37,679 --> 00:32:39,419
whatever

821
00:32:39,419 --> 00:32:41,940
is going to be quarantined meaning as

822
00:32:41,940 --> 00:32:43,799
soon as the thing comes up again it will

823
00:32:43,799 --> 00:32:46,140
not work because it has been quarantined

824
00:32:46,140 --> 00:32:49,200
until you have reviewed every single

825
00:32:49,200 --> 00:32:50,039
file

826
00:32:50,039 --> 00:32:52,440
an executable or script or whatever and

827
00:32:52,440 --> 00:32:54,720
say yeah this is cool and then you can

828
00:32:54,720 --> 00:32:56,220
unquarantine it

829
00:32:56,220 --> 00:32:58,080
and you're good to go

830
00:32:58,080 --> 00:33:00,179
but then again I've also seen it at a

831
00:33:00,179 --> 00:33:02,220
customer where the system was being

832
00:33:02,220 --> 00:33:05,100
misused for all kinds of stuff

833
00:33:05,100 --> 00:33:08,640
was basically a file server

834
00:33:08,640 --> 00:33:11,460
and it may contain all kinds of stuff

835
00:33:11,460 --> 00:33:14,640
and if it contains so much data

836
00:33:14,640 --> 00:33:16,679
on this moment when you have to go in

837
00:33:16,679 --> 00:33:18,240
and check every single file to see if

838
00:33:18,240 --> 00:33:19,919
it's okay

839
00:33:19,919 --> 00:33:21,539
and in this case we were talking about

840
00:33:21,539 --> 00:33:24,840
50 000 files out of which were I think

841
00:33:24,840 --> 00:33:27,059
two and a half thousand executables

842
00:33:27,059 --> 00:33:28,980
it will take some time

843
00:33:28,980 --> 00:33:31,980
so thinking oh I'll I'll have some AV

844
00:33:31,980 --> 00:33:34,019
scanner have go through it that's not

845
00:33:34,019 --> 00:33:36,299
good enough because have you checked the

846
00:33:36,299 --> 00:33:37,260
scripts

847
00:33:37,260 --> 00:33:39,419
it might be just some script out there

848
00:33:39,419 --> 00:33:41,220
that is disabling your security

849
00:33:41,220 --> 00:33:43,860
disabling services or enabling something

850
00:33:43,860 --> 00:33:45,980
else or

851
00:33:45,980 --> 00:33:50,100
it's not doing anything harmful but it's

852
00:33:50,100 --> 00:33:52,320
disabling your security it's weakening

853
00:33:52,320 --> 00:33:53,940
you so you need to have a look at those

854
00:33:53,940 --> 00:33:56,580
that means you need to have a look at

855
00:33:56,580 --> 00:33:58,860
every single script that's what they are

856
00:33:58,860 --> 00:34:01,760
doing now for the customer that we are

857
00:34:01,760 --> 00:34:03,539
going through

858
00:34:03,539 --> 00:34:06,840
fifty thousand files with a I think two

859
00:34:06,840 --> 00:34:08,580
and a half thousand executables it's

860
00:34:08,580 --> 00:34:11,520
painful but again if it's the same thing

861
00:34:11,520 --> 00:34:12,780
in your company

862
00:34:12,780 --> 00:34:14,940
make sure that the CSL only contains the

863
00:34:14,940 --> 00:34:17,520
stuff that should be there

864
00:34:17,520 --> 00:34:19,679
every other thing

865
00:34:19,679 --> 00:34:21,719
sorry not my problem put it somewhere

866
00:34:21,719 --> 00:34:23,839
else

867
00:34:28,679 --> 00:34:30,659
We performed the vulnerability analysis

868
00:34:30,659 --> 00:34:32,399
using the tools we mentioned before I

869
00:34:32,399 --> 00:34:34,139
mentioned before and then we had to make

870
00:34:34,139 --> 00:34:36,239
a decision what do we do

871
00:34:36,239 --> 00:34:39,540
we tried to make a decision

872
00:34:39,540 --> 00:34:41,219
um after scanning the tools using purple

873
00:34:41,219 --> 00:34:43,560
Knight we used certify and also

874
00:34:43,560 --> 00:34:45,599
Bloodhound to get as much as information

875
00:34:45,599 --> 00:34:47,580
as possible create a report for

876
00:34:47,580 --> 00:34:48,719
ourselves but also for the customers

877
00:34:48,719 --> 00:34:50,339
because customers just ask questions

878
00:34:50,339 --> 00:34:53,040
what are you doing and why and when

879
00:34:53,040 --> 00:34:54,480
because they want to be back as soon as

880
00:34:54,480 --> 00:34:55,800
possible

881
00:34:55,800 --> 00:34:56,399
um

882
00:34:56,399 --> 00:34:58,500
and with this information we had to make

883
00:34:58,500 --> 00:35:01,560
a decision and think okay are we going

884
00:35:01,560 --> 00:35:02,880
to use this one

885
00:35:02,880 --> 00:35:04,619
or do we cover one

886
00:35:04,619 --> 00:35:07,380
and then at some point in time

887
00:35:07,380 --> 00:35:09,300
after

888
00:35:09,300 --> 00:35:12,119
going through all the stuff we found out

889
00:35:12,119 --> 00:35:14,579
again this is real stuff that all the

890
00:35:14,579 --> 00:35:17,099
domain computers were able to change

891
00:35:17,099 --> 00:35:18,960
certificate templates

892
00:35:18,960 --> 00:35:22,440
not enroll no actually change them

893
00:35:22,440 --> 00:35:25,980
so if you're able to change

894
00:35:25,980 --> 00:35:28,619
a certificate template at the main

895
00:35:28,619 --> 00:35:31,320
computer well if you are an admin on a

896
00:35:31,320 --> 00:35:33,119
domain computer you can become owner of

897
00:35:33,119 --> 00:35:34,440
that domain compute and then you can

898
00:35:34,440 --> 00:35:36,599
change I don't know some web service

899
00:35:36,599 --> 00:35:38,400
certificate that for example allows you

900
00:35:38,400 --> 00:35:40,740
to put a UPN in the

901
00:35:40,740 --> 00:35:43,140
subject alternate name and then you can

902
00:35:43,140 --> 00:35:46,140
simulate any user in the company using

903
00:35:46,140 --> 00:35:49,619
that certificate it's so easy

904
00:35:49,619 --> 00:35:51,300
very dangerous

905
00:35:51,300 --> 00:35:53,640
we fixed all the certificate templates

906
00:35:53,640 --> 00:35:56,520
so after the recovery the messages also

907
00:35:56,520 --> 00:35:58,560
you still have a lot of work to do if

908
00:35:58,560 --> 00:36:00,480
the security posture of your ID is

909
00:36:00,480 --> 00:36:02,520
really really bad

910
00:36:02,520 --> 00:36:05,160
the other one this is an interesting one

911
00:36:05,160 --> 00:36:07,800
this surprises

912
00:36:07,800 --> 00:36:10,560
again knowledge people trying to do

913
00:36:10,560 --> 00:36:12,480
their best

914
00:36:12,480 --> 00:36:15,420
didn't yeah the intention of the people

915
00:36:15,420 --> 00:36:18,359
I think the people were

916
00:36:18,359 --> 00:36:20,339
we want to have a self-serve we want to

917
00:36:20,339 --> 00:36:23,160
help uh have a help desk account

918
00:36:23,160 --> 00:36:26,280
to reset the passwords of all other

919
00:36:26,280 --> 00:36:28,800
users sounds logical right to me it

920
00:36:28,800 --> 00:36:31,440
sounds but what did we see we saw

921
00:36:31,440 --> 00:36:34,260
exactly what I said what we also saw the

922
00:36:34,260 --> 00:36:35,520
other way around

923
00:36:35,520 --> 00:36:38,640
everyone within the company was allowed

924
00:36:38,640 --> 00:36:41,160
to reset the password of the help desk

925
00:36:41,160 --> 00:36:43,140
account but the help desk account was

926
00:36:43,140 --> 00:36:45,900
still also able to reset the passwords

927
00:36:45,900 --> 00:36:47,579
of other accounts in other words

928
00:36:47,579 --> 00:36:50,400
everybody was able to reset each other's

929
00:36:50,400 --> 00:36:51,480
password

930
00:36:51,480 --> 00:36:54,480
so all the admins you're fired because

931
00:36:54,480 --> 00:36:58,040
everybody was able to do it themselves

932
00:36:58,560 --> 00:37:00,660
this was tricky

933
00:37:00,660 --> 00:37:02,460
and then

934
00:37:02,460 --> 00:37:05,099
the EDR team showed us

935
00:37:05,099 --> 00:37:08,220
we are not fighting against remember the

936
00:37:08,220 --> 00:37:10,440
ID was still up and running the ad was

937
00:37:10,440 --> 00:37:12,180
sorry the we are not fighting against

938
00:37:12,180 --> 00:37:13,740
one attacker

939
00:37:13,740 --> 00:37:16,920
there appear to be multiple

940
00:37:16,920 --> 00:37:19,619
and then we needed to think okay is it

941
00:37:19,619 --> 00:37:22,560
even worse and possible

942
00:37:22,560 --> 00:37:25,200
to get this ID up and running in a

943
00:37:25,200 --> 00:37:27,060
secure Manner and keep it like that

944
00:37:27,060 --> 00:37:30,060
imagine being in a boat with so many

945
00:37:30,060 --> 00:37:32,640
holes that you don't have enough fingers

946
00:37:32,640 --> 00:37:34,680
to put in the holes

947
00:37:34,680 --> 00:37:36,839
in the end it will sink

948
00:37:36,839 --> 00:37:38,520
although you're trying to do your best

949
00:37:38,520 --> 00:37:40,800
that's what I mean so we made the

950
00:37:40,800 --> 00:37:43,099
decision

951
00:37:43,500 --> 00:37:45,180
keep using it

952
00:37:45,180 --> 00:37:47,820
we are going to continue with this one

953
00:37:47,820 --> 00:37:50,820
this one will sink at some point if it

954
00:37:50,820 --> 00:37:52,619
even sinks but it that's our assumption

955
00:37:52,619 --> 00:37:54,660
it will go down

956
00:37:54,660 --> 00:37:57,000
we continue with this guy new operating

957
00:37:57,000 --> 00:37:59,400
systems highest operating system

958
00:37:59,400 --> 00:38:00,859
available

959
00:38:00,859 --> 00:38:03,000
for function levels the main function

960
00:38:03,000 --> 00:38:06,180
levels are everything the hardening

961
00:38:06,180 --> 00:38:09,180
all the crap that we found we removed it

962
00:38:09,180 --> 00:38:12,359
everything and it was really drastic all

963
00:38:12,359 --> 00:38:14,400
the powerful groups

964
00:38:14,400 --> 00:38:17,220
everything empty it out all the members

965
00:38:17,220 --> 00:38:20,220
just go out yeah but no goes out account

966
00:38:20,220 --> 00:38:21,900
operator server operators print

967
00:38:21,900 --> 00:38:23,280
operators the main admins Enterprise

968
00:38:23,280 --> 00:38:26,099
admins it was sometimes what I see it's

969
00:38:26,099 --> 00:38:29,180
packed with people

970
00:38:29,220 --> 00:38:31,800
I don't know why we implemented let's

971
00:38:31,800 --> 00:38:33,960
call it a very easy tiering model tier

972
00:38:33,960 --> 00:38:35,820
zero tier one tier two

973
00:38:35,820 --> 00:38:38,099
tier two for workstations tier one for

974
00:38:38,099 --> 00:38:39,720
servers tier zero for the main

975
00:38:39,720 --> 00:38:41,700
controllers adfs Azure 80 connect and

976
00:38:41,700 --> 00:38:42,960
everything that behaves like a domain

977
00:38:42,960 --> 00:38:46,079
control or is very powerful somehow

978
00:38:46,079 --> 00:38:48,480
we changed OU permissions

979
00:38:48,480 --> 00:38:50,280
to hide

980
00:38:50,280 --> 00:38:54,780
those accounts and groups

981
00:38:54,780 --> 00:38:58,140
um NAD to give it a better explanation I

982
00:38:58,140 --> 00:39:00,780
don't know how many of you know it

983
00:39:00,780 --> 00:39:02,040
um

984
00:39:02,040 --> 00:39:05,700
ad has a feature for hosting parties

985
00:39:05,700 --> 00:39:07,800
that's called list object mode you start

986
00:39:07,800 --> 00:39:10,980
using start removing permissions from

987
00:39:10,980 --> 00:39:13,200
objects so that you only see those

988
00:39:13,200 --> 00:39:15,180
permissions so those objects if you

989
00:39:15,180 --> 00:39:16,859
actually have permissions

990
00:39:16,859 --> 00:39:19,380
if it's not available I'm sorry if you

991
00:39:19,380 --> 00:39:20,400
don't have submissions you won't see it

992
00:39:20,400 --> 00:39:21,900
it's let's say it's comparable to the

993
00:39:21,900 --> 00:39:23,339
list object mode thing

994
00:39:23,339 --> 00:39:24,920
we also

995
00:39:24,920 --> 00:39:27,660
also important go through your gpos

996
00:39:27,660 --> 00:39:29,720
because you have no idea what's in there

997
00:39:29,720 --> 00:39:32,339
deploying software starting scheduled

998
00:39:32,339 --> 00:39:34,140
tasks etc etc

999
00:39:34,140 --> 00:39:36,780
regarding the accounts which is by the

1000
00:39:36,780 --> 00:39:38,339
way not even mentioned here it's

1001
00:39:38,339 --> 00:39:40,020
mentioned in legislate we did the

1002
00:39:40,020 --> 00:39:41,220
following

1003
00:39:41,220 --> 00:39:43,800
you might think oh let's reset the

1004
00:39:43,800 --> 00:39:46,140
password of all existing admin accounts

1005
00:39:46,140 --> 00:39:47,880
no

1006
00:39:47,880 --> 00:39:50,700
disable them all of them and then maybe

1007
00:39:50,700 --> 00:39:52,560
even later on

1008
00:39:52,560 --> 00:39:56,099
keep delete them what we did was create

1009
00:39:56,099 --> 00:39:59,460
brand new admin accounts because if you

1010
00:39:59,460 --> 00:40:01,859
use an account it still has a profile

1011
00:40:01,859 --> 00:40:04,020
somewhere you have no idea what's in

1012
00:40:04,020 --> 00:40:06,119
that profile

1013
00:40:06,119 --> 00:40:08,940
when we create the OU model we create it

1014
00:40:08,940 --> 00:40:12,240
at the top level in the domain not down

1015
00:40:12,240 --> 00:40:14,880
some in some OU now at the top level of

1016
00:40:14,880 --> 00:40:17,640
the domain why there's a simple reason

1017
00:40:17,640 --> 00:40:20,099
at the top level of the domain only the

1018
00:40:20,099 --> 00:40:23,040
default domain GPO and maybe other gpos

1019
00:40:23,040 --> 00:40:25,260
will affect those accounts

1020
00:40:25,260 --> 00:40:28,380
and then on the if it's not enforced on

1021
00:40:28,380 --> 00:40:29,579
the OU

1022
00:40:29,579 --> 00:40:32,099
you can say block inheritance and then

1023
00:40:32,099 --> 00:40:34,079
all the GPO settings will not apply

1024
00:40:34,079 --> 00:40:35,940
until you are safe and checked all the

1025
00:40:35,940 --> 00:40:38,099
gpos

1026
00:40:38,099 --> 00:40:40,020
they will not apply to those accounts

1027
00:40:40,020 --> 00:40:43,020
I've also seen it if you have gpos at

1028
00:40:43,020 --> 00:40:45,599
the main level that are enforced see if

1029
00:40:45,599 --> 00:40:47,579
you can remove the enforcement so that

1030
00:40:47,579 --> 00:40:49,380
those accounts are protected until

1031
00:40:49,380 --> 00:40:51,780
further notice because if you have it

1032
00:40:51,780 --> 00:40:54,839
down in some OU structure and you log on

1033
00:40:54,839 --> 00:40:58,380
and there's some GPO with some

1034
00:40:58,380 --> 00:41:00,960
I don't know bad thing in it and you're

1035
00:41:00,960 --> 00:41:02,760
not aware of it even if it's a new

1036
00:41:02,760 --> 00:41:05,940
account you will be impacted again

1037
00:41:05,940 --> 00:41:07,560
there are so many things you need to

1038
00:41:07,560 --> 00:41:08,460
think about

1039
00:41:08,460 --> 00:41:11,640
and that's what I mean with complexity

1040
00:41:11,640 --> 00:41:14,160
so we kept using the ad while it was

1041
00:41:14,160 --> 00:41:16,320
running Let It Go and there's one thing

1042
00:41:16,320 --> 00:41:17,640
that

1043
00:41:17,640 --> 00:41:19,680
important to mention I didn't mention it

1044
00:41:19,680 --> 00:41:20,940
at the beginning

1045
00:41:20,940 --> 00:41:23,160
right at the beginning here as soon as

1046
00:41:23,160 --> 00:41:25,079
we made the decision let's make a backup

1047
00:41:25,079 --> 00:41:27,000
and restore in parallel

1048
00:41:27,000 --> 00:41:29,099
because we were used this ad was still

1049
00:41:29,099 --> 00:41:30,839
up and running and we're going to use it

1050
00:41:30,839 --> 00:41:33,359
until we would switch it

1051
00:41:33,359 --> 00:41:36,420
one of the decisions we made was to

1052
00:41:36,420 --> 00:41:39,980
stop forcing password changes

1053
00:41:39,980 --> 00:41:43,740
temporarily because if you have during

1054
00:41:43,740 --> 00:41:45,240
these moments people changing their

1055
00:41:45,240 --> 00:41:47,220
passwords you will have mismatches in

1056
00:41:47,220 --> 00:41:48,480
the end and then you have additional

1057
00:41:48,480 --> 00:41:50,339
headaches and it doesn't provide you

1058
00:41:50,339 --> 00:41:52,740
much more Risk by disabling it so for

1059
00:41:52,740 --> 00:41:53,760
users

1060
00:41:53,760 --> 00:41:55,740
we ask the customer what is your

1061
00:41:55,740 --> 00:42:00,420
password policy 90 days make it 360. we

1062
00:42:00,420 --> 00:42:02,760
will change it back afterwards as after

1063
00:42:02,760 --> 00:42:05,280
the whole recovery thing make it 360. so

1064
00:42:05,280 --> 00:42:06,960
that people don't change their password

1065
00:42:06,960 --> 00:42:09,240
because they have to but also for

1066
00:42:09,240 --> 00:42:11,940
computers we told computers highest

1067
00:42:11,940 --> 00:42:14,040
level of the domain stop changing

1068
00:42:14,040 --> 00:42:16,640
passwords

1069
00:42:18,180 --> 00:42:19,920
very important in this scenario because

1070
00:42:19,920 --> 00:42:23,359
you have two streams of 80.

1071
00:42:23,700 --> 00:42:25,740
one and a half days as I explained

1072
00:42:25,740 --> 00:42:27,960
tiering model

1073
00:42:27,960 --> 00:42:30,180
cleaning up privileges

1074
00:42:30,180 --> 00:42:33,359
new accounts groups and don't forget to

1075
00:42:33,359 --> 00:42:35,579
use the protected users groups all the

1076
00:42:35,579 --> 00:42:38,280
tier zero accounts should go into the

1077
00:42:38,280 --> 00:42:40,920
protected usage groups Kerber's only no

1078
00:42:40,920 --> 00:42:44,520
delegation highest encryption thingies

1079
00:42:44,520 --> 00:42:48,720
and many many things use it yes there

1080
00:42:48,720 --> 00:42:51,060
may be applications that as soon as you

1081
00:42:51,060 --> 00:42:53,640
add an account to the protected users an

1082
00:42:53,640 --> 00:42:55,500
application might not work think about

1083
00:42:55,500 --> 00:42:59,000
it it's a tier zero account

1084
00:43:00,060 --> 00:43:03,359
previous account with spns

1085
00:43:03,359 --> 00:43:04,920
well it's an easy one because it was

1086
00:43:04,920 --> 00:43:07,319
packed cleaning let's don't even think

1087
00:43:07,319 --> 00:43:10,079
it about it if it's a human account at

1088
00:43:10,079 --> 00:43:11,520
least a person an account for a human

1089
00:43:11,520 --> 00:43:14,339
either admin or normal get rid of the

1090
00:43:14,339 --> 00:43:16,859
SPN don't even ask the question

1091
00:43:16,859 --> 00:43:18,900
if you should remove it or not get rid

1092
00:43:18,900 --> 00:43:20,940
of it it might be there because some

1093
00:43:20,940 --> 00:43:22,800
application was installed under your

1094
00:43:22,800 --> 00:43:24,240
account and the application put it in

1095
00:43:24,240 --> 00:43:27,060
there or somebody was doing a test

1096
00:43:27,060 --> 00:43:28,859
and forgot it

1097
00:43:28,859 --> 00:43:31,319
but then when when an account has this

1098
00:43:31,319 --> 00:43:35,460
list of spns it wasn't forgotten

1099
00:43:35,460 --> 00:43:38,160
oh and uh the OU admin SD holder

1100
00:43:38,160 --> 00:43:40,319
permissions also think about the admin

1101
00:43:40,319 --> 00:43:41,880
SD holder permissions because all those

1102
00:43:41,880 --> 00:43:43,740
permissions on the adminster holder will

1103
00:43:43,740 --> 00:43:46,079
in the end be projected on all protected

1104
00:43:46,079 --> 00:43:48,060
accounts and groups and then if

1105
00:43:48,060 --> 00:43:50,520
something bad is in here your accounts

1106
00:43:50,520 --> 00:43:51,780
are weakened

1107
00:43:51,780 --> 00:43:54,980
again the gpos

1108
00:43:55,980 --> 00:43:58,859
we continued

1109
00:43:58,859 --> 00:44:01,680
and now the tough decision

1110
00:44:01,680 --> 00:44:04,680
we were ready to go live

1111
00:44:04,680 --> 00:44:06,660
it's always fun in a company because

1112
00:44:06,660 --> 00:44:09,599
normally it never happens

1113
00:44:09,599 --> 00:44:12,060
let's just shut down ad

1114
00:44:12,060 --> 00:44:13,859
and we did it

1115
00:44:13,859 --> 00:44:15,599
has anyone ever

1116
00:44:15,599 --> 00:44:19,619
done a domain rename I did just for fun

1117
00:44:19,619 --> 00:44:21,060
now I'm not saying in production but

1118
00:44:21,060 --> 00:44:23,280
just for fun to see what happens the the

1119
00:44:23,280 --> 00:44:25,500
the most beautiful part about the main

1120
00:44:25,500 --> 00:44:27,660
rename is at a certain point you do

1121
00:44:27,660 --> 00:44:29,160
prepare prepare prepare and then there's

1122
00:44:29,160 --> 00:44:31,200
a moment when you press the button and

1123
00:44:31,200 --> 00:44:32,819
then if you're for example a virtualized

1124
00:44:32,819 --> 00:44:34,140
environment you see all your domain

1125
00:44:34,140 --> 00:44:37,319
controls and then they care up again if

1126
00:44:37,319 --> 00:44:38,460
you're lucky

1127
00:44:38,460 --> 00:44:40,500
if you're lucky that's one of those

1128
00:44:40,500 --> 00:44:42,240
moments then you need a forced recovery

1129
00:44:42,240 --> 00:44:45,000
but then for the main rename is not not

1130
00:44:45,000 --> 00:44:46,920
supported anymore for many things but

1131
00:44:46,920 --> 00:44:49,500
again this scenario we told the customer

1132
00:44:49,500 --> 00:44:52,140
well we discussed it with a customer

1133
00:44:52,140 --> 00:44:53,819
this is the time we are going to shut

1134
00:44:53,819 --> 00:44:57,000
down your ID and we did it we shut down

1135
00:44:57,000 --> 00:44:59,400
the ad

1136
00:44:59,400 --> 00:45:02,780
if we put the other one back

1137
00:45:05,819 --> 00:45:09,599
this whole thing felt like this

1138
00:45:09,599 --> 00:45:12,240
driving a car and still changing the

1139
00:45:12,240 --> 00:45:13,140
wheels

1140
00:45:13,140 --> 00:45:14,579
because

1141
00:45:14,579 --> 00:45:18,599
multiple or sorry dual streams of ad

1142
00:45:18,599 --> 00:45:20,640
see what's happening on one side the

1143
00:45:20,640 --> 00:45:22,260
compromise part

1144
00:45:22,260 --> 00:45:24,180
recovering the other part and then

1145
00:45:24,180 --> 00:45:25,980
securing it and then at some point in

1146
00:45:25,980 --> 00:45:28,260
time as one of my colleagues told me as

1147
00:45:28,260 --> 00:45:30,960
if you rip out the heart of the company

1148
00:45:30,960 --> 00:45:34,440
throw it away and put in a new one

1149
00:45:34,440 --> 00:45:37,980
and reboot it and it works

1150
00:45:37,980 --> 00:45:41,280
it works I know

1151
00:45:41,280 --> 00:45:44,220
tough decision

1152
00:45:44,220 --> 00:45:45,720
taking it down

1153
00:45:45,720 --> 00:45:47,940
you just need to do it

1154
00:45:47,940 --> 00:45:49,380
you won't ever do it in a normal

1155
00:45:49,380 --> 00:45:51,420
scenario but in a recovery scenario you

1156
00:45:51,420 --> 00:45:52,800
might need to

1157
00:45:52,800 --> 00:45:54,420
of course when we moved from the

1158
00:45:54,420 --> 00:45:56,400
isolated environment it's not just oh

1159
00:45:56,400 --> 00:45:58,319
click move no we need to change IP

1160
00:45:58,319 --> 00:46:00,839
addresses vlans DNS IP addresses the

1161
00:46:00,839 --> 00:46:04,800
whole thing and then you have to move

1162
00:46:04,800 --> 00:46:07,619
the whole after the the whole move 30

1163
00:46:07,619 --> 00:46:09,000
minutes later everything was up and

1164
00:46:09,000 --> 00:46:11,420
running again

1165
00:46:11,880 --> 00:46:14,579
so we fully automated the recovery by

1166
00:46:14,579 --> 00:46:17,220
recovering DC's re-promotion of the

1167
00:46:17,220 --> 00:46:19,680
disease in the same process as needed

1168
00:46:19,680 --> 00:46:22,140
including all the ad service steps

1169
00:46:22,140 --> 00:46:24,980
metadata cleanup increasing the red pool

1170
00:46:24,980 --> 00:46:27,480
resetting Kerber cgt DC computer

1171
00:46:27,480 --> 00:46:29,400
accounts and the whole thing that exists

1172
00:46:29,400 --> 00:46:32,540
out there that needs to be done

1173
00:46:34,920 --> 00:46:37,200
the EDR team as I mentioned earlier

1174
00:46:37,200 --> 00:46:40,260
there were four are four attackers they

1175
00:46:40,260 --> 00:46:43,740
had taken down many many IPS and many

1176
00:46:43,740 --> 00:46:46,079
command and control systems trying to

1177
00:46:46,079 --> 00:46:48,359
attack against the ad

1178
00:46:48,359 --> 00:46:50,400
while we were doing our things they were

1179
00:46:50,400 --> 00:46:52,079
doing their things it was a continuous

1180
00:46:52,079 --> 00:46:53,460
team effort communicating with each

1181
00:46:53,460 --> 00:46:55,200
other very important by the way to do

1182
00:46:55,200 --> 00:46:56,520
when is this going to happen when is

1183
00:46:56,520 --> 00:46:58,020
that going to happen then they were

1184
00:46:58,020 --> 00:46:59,400
telling us what they were seeing so that

1185
00:46:59,400 --> 00:47:02,599
we could behave on it and clean

1186
00:47:02,640 --> 00:47:05,520
but because we put the ad back all the

1187
00:47:05,520 --> 00:47:08,280
servers and clients

1188
00:47:08,280 --> 00:47:09,900
and that's the magic Bullock with the

1189
00:47:09,900 --> 00:47:12,119
whole password reset thing disabling it

1190
00:47:12,119 --> 00:47:14,880
all those servers and clients were up

1191
00:47:14,880 --> 00:47:18,000
and running over a thousand servers

1192
00:47:18,000 --> 00:47:20,700
were Rebooted

1193
00:47:20,700 --> 00:47:23,579
because they had to create a new secure

1194
00:47:23,579 --> 00:47:26,640
Channel with the new ad because when

1195
00:47:26,640 --> 00:47:27,780
they were up and running they were

1196
00:47:27,780 --> 00:47:30,240
basically talking to the compromised one

1197
00:47:30,240 --> 00:47:33,060
so we put the ID back sorry we shut down

1198
00:47:33,060 --> 00:47:35,160
the old ad the compromise ID put the

1199
00:47:35,160 --> 00:47:37,319
other one back reboot all service all

1200
00:47:37,319 --> 00:47:39,599
workstations everything took a moment

1201
00:47:39,599 --> 00:47:41,579
and then everything was talking fine

1202
00:47:41,579 --> 00:47:43,920
again to the ad there's always a slight

1203
00:47:43,920 --> 00:47:45,359
chance where there's some password

1204
00:47:45,359 --> 00:47:46,800
mismatch because you might have missed

1205
00:47:46,800 --> 00:47:47,880
it I don't know

1206
00:47:47,880 --> 00:47:50,760
but then after putting back the ID we

1207
00:47:50,760 --> 00:47:52,500
changed the password policy again from

1208
00:47:52,500 --> 00:47:56,579
what did I say 390 to 9 sorry 360 to 90.

1209
00:47:56,579 --> 00:47:59,940
and we enabled the password change thing

1210
00:47:59,940 --> 00:48:01,680
again for the computers

1211
00:48:01,680 --> 00:48:04,200
in this previous customer I still don't

1212
00:48:04,200 --> 00:48:07,079
know but they also still don't know

1213
00:48:07,079 --> 00:48:09,660
somebody had disabled

1214
00:48:09,660 --> 00:48:11,280
changing of the passwords of the

1215
00:48:11,280 --> 00:48:12,780
computers it was at the highest level at

1216
00:48:12,780 --> 00:48:14,579
the Domain

1217
00:48:14,579 --> 00:48:16,680
and we found it by looking at the

1218
00:48:16,680 --> 00:48:18,420
passwords one of the reports why are

1219
00:48:18,420 --> 00:48:21,540
those passwords so old

1220
00:48:21,540 --> 00:48:23,160
and then you start digging digging in

1221
00:48:23,160 --> 00:48:26,339
and you find oh there's a GPO

1222
00:48:26,339 --> 00:48:27,839
telling the computers to disable

1223
00:48:27,839 --> 00:48:30,420
password change

1224
00:48:30,420 --> 00:48:33,240
they survived they are still alive

1225
00:48:33,240 --> 00:48:35,880
so after

1226
00:48:35,880 --> 00:48:39,060
there was a challenging week

1227
00:48:39,060 --> 00:48:42,540
after 17 hours a person seven zero hours

1228
00:48:42,540 --> 00:48:44,339
a person

1229
00:48:44,339 --> 00:48:46,440
we achieved this

1230
00:48:46,440 --> 00:48:47,640
a week

1231
00:48:47,640 --> 00:48:50,460
this is of course not a global company I

1232
00:48:50,460 --> 00:48:52,200
need to be honest with you

1233
00:48:52,200 --> 00:48:54,420
this was a company with if I'm not

1234
00:48:54,420 --> 00:48:57,119
mistaken two data centers

1235
00:48:57,119 --> 00:48:59,520
it's a scenario because if it's a global

1236
00:48:59,520 --> 00:49:01,319
company distributed multiple domains

1237
00:49:01,319 --> 00:49:03,060
multiple for us whatever okay it looks

1238
00:49:03,060 --> 00:49:05,640
different this might not work in every

1239
00:49:05,640 --> 00:49:08,040
single scenario it is a scenario that

1240
00:49:08,040 --> 00:49:10,079
worked so you need to think about those

1241
00:49:10,079 --> 00:49:11,220
scenarios

1242
00:49:11,220 --> 00:49:12,980
how to

1243
00:49:12,980 --> 00:49:16,319
attack the attacker

1244
00:49:16,319 --> 00:49:18,240
so we performed a very fast recovery

1245
00:49:18,240 --> 00:49:20,819
fully functional and safe no more

1246
00:49:20,819 --> 00:49:22,619
privilege owned privileged accounts

1247
00:49:22,619 --> 00:49:24,480
because we disabled the old ones and we

1248
00:49:24,480 --> 00:49:26,700
created new ones we told the customer

1249
00:49:26,700 --> 00:49:28,920
please don't use the old ones because

1250
00:49:28,920 --> 00:49:32,280
you have no idea how the how those are

1251
00:49:32,280 --> 00:49:34,740
going to be misused in any other way

1252
00:49:34,740 --> 00:49:36,480
in this case this customer did have

1253
00:49:36,480 --> 00:49:38,579
password through Authentication

1254
00:49:38,579 --> 00:49:40,980
but because it was done so quick for

1255
00:49:40,980 --> 00:49:43,440
them and they were yes we went back in

1256
00:49:43,440 --> 00:49:44,520
time

1257
00:49:44,520 --> 00:49:46,560
but just a little bit it was of a

1258
00:49:46,560 --> 00:49:50,280
running ad backup restore in parallel so

1259
00:49:50,280 --> 00:49:52,560
there was a mismatch but

1260
00:49:52,560 --> 00:49:54,480
important

1261
00:49:54,480 --> 00:49:57,180
I forgot a point uh previously in the um

1262
00:49:57,180 --> 00:49:59,160
the whole synchronization when you go

1263
00:49:59,160 --> 00:50:01,619
back in time with your ad

1264
00:50:01,619 --> 00:50:04,079
one of the things that happens is

1265
00:50:04,079 --> 00:50:06,420
objects

1266
00:50:06,420 --> 00:50:08,579
that you delete it because people left

1267
00:50:08,579 --> 00:50:10,020
the company or the objects does not

1268
00:50:10,020 --> 00:50:11,579
needed anymore when you go back in time

1269
00:50:11,579 --> 00:50:14,839
those objects are back again

1270
00:50:15,240 --> 00:50:18,960
but also the other way around

1271
00:50:18,960 --> 00:50:22,740
in your Azure tenant

1272
00:50:22,740 --> 00:50:25,800
the accounts nothing happened

1273
00:50:25,800 --> 00:50:28,500
and then you have Azure ad connect

1274
00:50:28,500 --> 00:50:31,079
while Azure ad connect is performing a

1275
00:50:31,079 --> 00:50:33,240
Delta sync

1276
00:50:33,240 --> 00:50:36,180
you're okay but as soon as it performs a

1277
00:50:36,180 --> 00:50:39,540
full sync it starts realizing hey I've

1278
00:50:39,540 --> 00:50:41,579
got new objects the ones that had to be

1279
00:50:41,579 --> 00:50:44,099
deleted but I'm also missing objects the

1280
00:50:44,099 --> 00:50:47,579
ones that were created after the backup

1281
00:50:47,579 --> 00:50:49,500
and when it starts doing a full sync

1282
00:50:49,500 --> 00:50:51,180
when it's going to do a full sync when

1283
00:50:51,180 --> 00:50:53,280
because you told it to or because you

1284
00:50:53,280 --> 00:50:55,859
perform an upgrade of azure ad connect

1285
00:50:55,859 --> 00:50:58,099
and then Microsoft changed one of the

1286
00:50:58,099 --> 00:51:00,839
synchronization rules and when you

1287
00:51:00,839 --> 00:51:02,099
change the synchronization rule what's

1288
00:51:02,099 --> 00:51:03,960
the trigger do a full sync

1289
00:51:03,960 --> 00:51:06,119
when it performs a full sync

1290
00:51:06,119 --> 00:51:09,480
all those changes it suddenly detects

1291
00:51:09,480 --> 00:51:12,240
will go towards your those accounts that

1292
00:51:12,240 --> 00:51:14,339
are going to be created you can say okay

1293
00:51:14,339 --> 00:51:16,859
could be a security risk but all those

1294
00:51:16,859 --> 00:51:19,980
accounts that were that it doesn't see

1295
00:51:19,980 --> 00:51:22,260
anymore again it's not deleted it

1296
00:51:22,260 --> 00:51:23,579
doesn't see the objects because those

1297
00:51:23,579 --> 00:51:25,740
were created after the backup

1298
00:51:25,740 --> 00:51:28,500
those will be seen as deletions and

1299
00:51:28,500 --> 00:51:30,420
those accounts will be deleted in Azure

1300
00:51:30,420 --> 00:51:33,059
you might think oh I can undo the the

1301
00:51:33,059 --> 00:51:35,400
deletion in Azure sure you can but for

1302
00:51:35,400 --> 00:51:37,619
from a user perspective it's immediate

1303
00:51:37,619 --> 00:51:40,800
user impact licenses lost mailbox lost

1304
00:51:40,800 --> 00:51:42,780
accounts lost loss of services lost

1305
00:51:42,780 --> 00:51:43,980
whatever

1306
00:51:43,980 --> 00:51:46,619
so what do you need to do

1307
00:51:46,619 --> 00:51:49,079
as soon as you think about I'm going to

1308
00:51:49,079 --> 00:51:51,420
do a forest recovery the first thing you

1309
00:51:51,420 --> 00:51:53,400
must do is disable every single

1310
00:51:53,400 --> 00:51:55,500
synchronization mechanism with ad that

1311
00:51:55,500 --> 00:51:57,660
synchronizes to or from disable it

1312
00:51:57,660 --> 00:51:59,160
because you need to have a stable

1313
00:51:59,160 --> 00:52:00,900
environment you don't need to have all

1314
00:52:00,900 --> 00:52:03,180
kinds of stuff banging against it with

1315
00:52:03,180 --> 00:52:05,160
changes because it will be a headache

1316
00:52:05,160 --> 00:52:06,180
later

1317
00:52:06,180 --> 00:52:09,119
disable it and then after the recovery

1318
00:52:09,119 --> 00:52:12,960
perform a gap analysis what does Azure

1319
00:52:12,960 --> 00:52:16,020
ID know what does AD know and there will

1320
00:52:16,020 --> 00:52:18,480
be a difference so for those objects

1321
00:52:18,480 --> 00:52:20,339
that exist and this is just an example

1322
00:52:20,339 --> 00:52:22,380
because it's it's uh it's more than that

1323
00:52:22,380 --> 00:52:24,660
those objects that existing is your but

1324
00:52:24,660 --> 00:52:25,740
not on ad

1325
00:52:25,740 --> 00:52:28,859
just recreate the objects in ad

1326
00:52:28,859 --> 00:52:31,260
with the exact same UPN

1327
00:52:31,260 --> 00:52:34,079
and the exact same immutable ID

1328
00:52:34,079 --> 00:52:35,819
and as soon

1329
00:52:35,819 --> 00:52:38,640
as Azure ID connect starts to sync it

1330
00:52:38,640 --> 00:52:40,740
will see oh I need to delete this object

1331
00:52:40,740 --> 00:52:43,020
oh I can now can use this object and the

1332
00:52:43,020 --> 00:52:44,579
whole sync and the connections from ad

1333
00:52:44,579 --> 00:52:47,099
to Azure ID will remain in place and the

1334
00:52:47,099 --> 00:52:50,819
data will not be deleted there's a catch

1335
00:52:50,819 --> 00:52:53,480
the immutable ID

1336
00:52:53,480 --> 00:52:56,460
originally is sourced from the object

1337
00:52:56,460 --> 00:52:58,500
guide

1338
00:52:58,500 --> 00:53:00,960
you need to have an attribute that you

1339
00:53:00,960 --> 00:53:03,359
can manipulate so if you create a new

1340
00:53:03,359 --> 00:53:05,280
account you need to be able to put in

1341
00:53:05,280 --> 00:53:07,800
the immutable ID that's in Azure onto

1342
00:53:07,800 --> 00:53:10,380
that account if you are using object

1343
00:53:10,380 --> 00:53:14,280
guide which I think originates from one

1344
00:53:14,280 --> 00:53:16,559
of the uh earliest Azure ID connect

1345
00:53:16,559 --> 00:53:18,059
versions where they were using object

1346
00:53:18,059 --> 00:53:20,520
guide then you have a problem

1347
00:53:20,520 --> 00:53:23,460
if you have moved to for example by

1348
00:53:23,460 --> 00:53:25,380
extending the scheme of Eddie which of

1349
00:53:25,380 --> 00:53:27,059
course is possible and then using your

1350
00:53:27,059 --> 00:53:28,920
own custom attribute to put in the data

1351
00:53:28,920 --> 00:53:30,300
and that's your location for

1352
00:53:30,300 --> 00:53:32,099
immutability you're good because then

1353
00:53:32,099 --> 00:53:34,859
you can put in your own data if you are

1354
00:53:34,859 --> 00:53:37,319
using MSDS consistency to it you're also

1355
00:53:37,319 --> 00:53:38,099
good

1356
00:53:38,099 --> 00:53:40,800
but if you are still using and I must

1357
00:53:40,800 --> 00:53:43,140
say that even if you use a custom schema

1358
00:53:43,140 --> 00:53:45,119
extension and MSDS

1359
00:53:45,119 --> 00:53:47,819
it still uses the source of the object

1360
00:53:47,819 --> 00:53:51,059
with as the initial value but the idea

1361
00:53:51,059 --> 00:53:53,940
is you must be able to update the value

1362
00:53:53,940 --> 00:53:56,040
with something else think about multiple

1363
00:53:56,040 --> 00:53:58,079
domain Forest you need to move a user

1364
00:53:58,079 --> 00:53:59,640
from the main a to the main B but you

1365
00:53:59,640 --> 00:54:01,440
don't want to lose the connection

1366
00:54:01,440 --> 00:54:05,520
moved well delete the the oil write down

1367
00:54:05,520 --> 00:54:08,400
the object sorry the immutable ID delete

1368
00:54:08,400 --> 00:54:10,680
user create in the other domain put in

1369
00:54:10,680 --> 00:54:12,839
the immutable ID back again and the

1370
00:54:12,839 --> 00:54:15,119
connection remains in place if you are

1371
00:54:15,119 --> 00:54:17,280
still on the object do it

1372
00:54:17,280 --> 00:54:19,440
make sure to move away from that and

1373
00:54:19,440 --> 00:54:21,780
start using the MSDS consistency Grid or

1374
00:54:21,780 --> 00:54:25,079
your own custom schema change because in

1375
00:54:25,079 --> 00:54:27,359
normal scenarios nobody cares everything

1376
00:54:27,359 --> 00:54:29,040
is fine

1377
00:54:29,040 --> 00:54:31,200
in a disaster recovery scenario it's

1378
00:54:31,200 --> 00:54:33,059
those small things that matter

1379
00:54:33,059 --> 00:54:35,040
including the password hash sync the

1380
00:54:35,040 --> 00:54:36,900
whole thing so in a disaster recovery

1381
00:54:36,900 --> 00:54:38,819
scenario that's the whole thing that

1382
00:54:38,819 --> 00:54:40,800
matters be prepared

1383
00:54:40,800 --> 00:54:42,300
and discuss whatever needs to be

1384
00:54:42,300 --> 00:54:45,059
discussed With Disaster Recovery mind

1385
00:54:45,059 --> 00:54:46,740
takeaways

1386
00:54:46,740 --> 00:54:48,300
well

1387
00:54:48,300 --> 00:54:51,599
uh open door but please

1388
00:54:51,599 --> 00:54:55,140
please please please invest in securing

1389
00:54:55,140 --> 00:54:56,099
your ad

1390
00:54:56,099 --> 00:54:58,260
I know Azure is cool

1391
00:54:58,260 --> 00:55:00,480
it's nice lots of nice features but

1392
00:55:00,480 --> 00:55:03,180
don't forget your ad use the tools as we

1393
00:55:03,180 --> 00:55:05,640
mentioned purple Knight bloodhound

1394
00:55:05,640 --> 00:55:08,339
anything else you might find and use it

1395
00:55:08,339 --> 00:55:12,140
to scan your ID but also fix it

1396
00:55:14,339 --> 00:55:16,260
and keep monitoring for real time for

1397
00:55:16,260 --> 00:55:17,700
all the bad stuff that's going on your

1398
00:55:17,700 --> 00:55:22,160
network Implement EDR xdr Solutions

1399
00:55:22,380 --> 00:55:25,559
but also be able to reactively restore

1400
00:55:25,559 --> 00:55:28,140
your ID when it goes down the drain make

1401
00:55:28,140 --> 00:55:30,900
sure to bring it back

1402
00:55:30,900 --> 00:55:34,200
these customers that we helped for many

1403
00:55:34,200 --> 00:55:35,280
years

1404
00:55:35,280 --> 00:55:38,099
I've written Disaster Recovery plans

1405
00:55:38,099 --> 00:55:39,780
you need to do this you need to do that

1406
00:55:39,780 --> 00:55:42,180
and now we are helping customers that

1407
00:55:42,180 --> 00:55:45,059
don't have a disaster recovery plan

1408
00:55:45,059 --> 00:55:47,280
you need to do something from the top of

1409
00:55:47,280 --> 00:55:48,900
your head well we can do that and I can

1410
00:55:48,900 --> 00:55:50,760
do that because it's throughout the

1411
00:55:50,760 --> 00:55:53,099
experience but if you don't and if you

1412
00:55:53,099 --> 00:55:54,720
want to do it yourself and you don't

1413
00:55:54,720 --> 00:55:56,640
have the experience and no plan it will

1414
00:55:56,640 --> 00:55:59,359
be a tough time

1415
00:56:00,359 --> 00:56:02,579
this last recovery plan is more than

1416
00:56:02,579 --> 00:56:05,160
technology many people focus on

1417
00:56:05,160 --> 00:56:07,140
technology like oh I bought a tool I'm

1418
00:56:07,140 --> 00:56:09,000
fine no no no no no

1419
00:56:09,000 --> 00:56:12,059
it's about logistics it's about the

1420
00:56:12,059 --> 00:56:15,839
ability to have a isolated Network it's

1421
00:56:15,839 --> 00:56:18,660
about the ability to still deploy

1422
00:56:18,660 --> 00:56:20,400
systems

1423
00:56:20,400 --> 00:56:22,559
because you need to restore ad onto it

1424
00:56:22,559 --> 00:56:24,300
fresh systems

1425
00:56:24,300 --> 00:56:25,920
fully patched

1426
00:56:25,920 --> 00:56:28,319
Communications Logistics if everything

1427
00:56:28,319 --> 00:56:30,420
is going down the drain how are you

1428
00:56:30,420 --> 00:56:31,980
going to communicate

1429
00:56:31,980 --> 00:56:34,079
if your communication stream is for

1430
00:56:34,079 --> 00:56:37,319
example Office 365 okay but if

1431
00:56:37,319 --> 00:56:39,240
authentication to Office 365 is done

1432
00:56:39,240 --> 00:56:42,780
what do you do WhatsApp signal I don't

1433
00:56:42,780 --> 00:56:44,760
know

1434
00:56:44,760 --> 00:56:47,520
so this last recovery is just most more

1435
00:56:47,520 --> 00:56:49,200
than the whole technology and important

1436
00:56:49,200 --> 00:56:51,240
to understand this

1437
00:56:51,240 --> 00:56:54,780
um it's in the end not technology it's

1438
00:56:54,780 --> 00:56:56,780
about your business

1439
00:56:56,780 --> 00:56:59,040
prioritized based on your business the

1440
00:56:59,040 --> 00:57:00,780
most important users the most important

1441
00:57:00,780 --> 00:57:03,480
applications and then approach it like

1442
00:57:03,480 --> 00:57:05,760
that and also with regards to whole

1443
00:57:05,760 --> 00:57:07,500
securing stuff

1444
00:57:07,500 --> 00:57:09,780
and a customer

1445
00:57:09,780 --> 00:57:11,400
when we checked for the compromise

1446
00:57:11,400 --> 00:57:13,020
passwords we were checking and then

1447
00:57:13,020 --> 00:57:14,220
telling people hey you need to change

1448
00:57:14,220 --> 00:57:15,839
your password and now you need to change

1449
00:57:15,839 --> 00:57:17,460
the password and the person changed the

1450
00:57:17,460 --> 00:57:19,559
password we checked again it's still

1451
00:57:19,559 --> 00:57:21,780
compromised because we have been telling

1452
00:57:21,780 --> 00:57:23,760
people for years your password must be

1453
00:57:23,760 --> 00:57:25,380
seven characters and it needs to be

1454
00:57:25,380 --> 00:57:27,240
complex and then you still get those

1455
00:57:27,240 --> 00:57:28,980
shitty passwords because that's what

1456
00:57:28,980 --> 00:57:30,180
people do

1457
00:57:30,180 --> 00:57:32,400
nobody comes up with a machine generated

1458
00:57:32,400 --> 00:57:35,660
password nobody

1459
00:57:36,359 --> 00:57:38,460
at a previous customer I think I made

1460
00:57:38,460 --> 00:57:41,280
about 40 000 enemies

1461
00:57:41,280 --> 00:57:46,319
why because I I convinced management to

1462
00:57:46,319 --> 00:57:48,599
implement a solution to check for

1463
00:57:48,599 --> 00:57:50,579
compromised passwords and block them

1464
00:57:50,579 --> 00:57:53,640
immediately so not after the fact but if

1465
00:57:53,640 --> 00:57:55,619
somebody wanted to use

1466
00:57:55,619 --> 00:57:58,079
a compromised password it was not

1467
00:57:58,079 --> 00:58:00,000
possible it got an error the same stupid

1468
00:58:00,000 --> 00:58:02,280
error doesn't fulfill all the complexity

1469
00:58:02,280 --> 00:58:05,660
stuff what happened

1470
00:58:06,900 --> 00:58:08,700
um

1471
00:58:08,700 --> 00:58:10,980
and we implemented it it took some time

1472
00:58:10,980 --> 00:58:13,500
and then you have to explain to a user

1473
00:58:13,500 --> 00:58:15,240
because that's what we have been telling

1474
00:58:15,240 --> 00:58:17,400
users for years seven eight characters

1475
00:58:17,400 --> 00:58:19,500
nine characters I don't know your

1476
00:58:19,500 --> 00:58:21,720
passport might be this long and still be

1477
00:58:21,720 --> 00:58:24,660
compromised I don't know so we told

1478
00:58:24,660 --> 00:58:26,700
users that the best explanation we could

1479
00:58:26,700 --> 00:58:29,880
give them think about a sentence a

1480
00:58:29,880 --> 00:58:32,220
sentence with maybe stupid errors that

1481
00:58:32,220 --> 00:58:34,380
only you are able to remember

1482
00:58:34,380 --> 00:58:37,500
I know we must get rid of passwords and

1483
00:58:37,500 --> 00:58:38,760
we should

1484
00:58:38,760 --> 00:58:42,119
and um but until that point in time I

1485
00:58:42,119 --> 00:58:43,619
think this is one of the best way and we

1486
00:58:43,619 --> 00:58:45,720
implement it so in the end we got rid of

1487
00:58:45,720 --> 00:58:47,640
all the compromised passwords and I had

1488
00:58:47,640 --> 00:58:50,598
40 000 enemies

1489
00:58:52,740 --> 00:58:54,720
it's all in the end about acceptance

1490
00:58:54,720 --> 00:58:56,819
because people need to get used to it

1491
00:58:56,819 --> 00:58:58,859
it's also the change part that scares

1492
00:58:58,859 --> 00:58:59,700
people

1493
00:58:59,700 --> 00:59:01,680
it always scares people

1494
00:59:01,680 --> 00:59:04,680
seek help if needed but before the

1495
00:59:04,680 --> 00:59:06,420
attack of course after the attack you

1496
00:59:06,420 --> 00:59:08,099
probably call somebody to help you but

1497
00:59:08,099 --> 00:59:10,680
preferably do it before automate as much

1498
00:59:10,680 --> 00:59:12,660
as possible

1499
00:59:12,660 --> 00:59:15,119
it's more than just restoring a single

1500
00:59:15,119 --> 00:59:16,920
or multiple domain controllers there may

1501
00:59:16,920 --> 00:59:20,040
be Solutions out there

1502
00:59:20,040 --> 00:59:21,780
um

1503
00:59:21,780 --> 00:59:23,880
that are able to back up the main

1504
00:59:23,880 --> 00:59:25,680
controllers because they support it but

1505
00:59:25,680 --> 00:59:28,200
how about recovering multiple domain

1506
00:59:28,200 --> 00:59:31,079
controllers how about all those ad

1507
00:59:31,079 --> 00:59:33,780
related steps you need to take

1508
00:59:33,780 --> 00:59:35,520
the customer that I was working with

1509
00:59:35,520 --> 00:59:38,220
this weekend they had a backup solution

1510
00:59:38,220 --> 00:59:40,920
guess what it was integrated with ID ad

1511
00:59:40,920 --> 00:59:42,420
was attacked backup solution was

1512
00:59:42,420 --> 00:59:45,599
attacked now backups end of story

1513
00:59:45,599 --> 00:59:48,540
we were still able to help them

1514
00:59:48,540 --> 00:59:51,000
because somebody suddenly we were almost

1515
00:59:51,000 --> 00:59:53,280
saying well sorry this is going to be we

1516
00:59:53,280 --> 00:59:55,200
need to rebuild everything from scratch

1517
00:59:55,200 --> 00:59:58,260
until somebody suddenly remembered oh

1518
00:59:58,260 --> 01:00:00,180
wait we still have

1519
01:00:00,180 --> 01:00:01,440
um

1520
01:00:01,440 --> 01:00:03,839
um the main controllers in in is from

1521
01:00:03,839 --> 01:00:06,540
Azure and it looked like

1522
01:00:06,540 --> 01:00:08,880
out of coincidence Azure backup Services

1523
01:00:08,880 --> 01:00:11,040
had created created a backup of one of

1524
01:00:11,040 --> 01:00:12,420
those domain controllers

1525
01:00:12,420 --> 01:00:14,520
those were still encrypted the the

1526
01:00:14,520 --> 01:00:16,260
domain controllers but the backup was

1527
01:00:16,260 --> 01:00:18,900
still usable the only one

1528
01:00:18,900 --> 01:00:21,900
so look at your backup solution if it's

1529
01:00:21,900 --> 01:00:23,760
integrated with ad

1530
01:00:23,760 --> 01:00:26,160
integrated meaning that if you attack ID

1531
01:00:26,160 --> 01:00:28,140
you can get to the backup solution it

1532
01:00:28,140 --> 01:00:30,660
should not be possible our solution does

1533
01:00:30,660 --> 01:00:32,640
not allow that many others same story

1534
01:00:32,640 --> 01:00:35,160
but if it's so integrated with ID in

1535
01:00:35,160 --> 01:00:36,780
terms of authentication authorization

1536
01:00:36,780 --> 01:00:38,579
get rid of it

1537
01:00:38,579 --> 01:00:40,440
because in the end if somebody encrypts

1538
01:00:40,440 --> 01:00:44,540
your ID it will encrypt you your backups

1539
01:00:44,579 --> 01:00:49,380
the facet RTO is with a third-party tool

1540
01:00:49,380 --> 01:00:52,380
test your plan Disaster Recovery drills

1541
01:00:52,380 --> 01:00:54,839
every

1542
01:00:54,839 --> 01:00:57,059
year preferably

1543
01:00:57,059 --> 01:00:59,099
and check for any security flaws it

1544
01:00:59,099 --> 01:01:00,359
might have because it's still possible

1545
01:01:00,359 --> 01:01:02,460
to have security flow

1546
01:01:02,460 --> 01:01:04,980
let's have a look if the ID is back or

1547
01:01:04,980 --> 01:01:06,180
not

1548
01:01:06,180 --> 01:01:10,819
how much time an hour right

1549
01:01:10,859 --> 01:01:13,500
ah

1550
01:01:13,500 --> 01:01:17,780
is it done or not and why

1551
01:01:18,359 --> 01:01:21,240
no it's still recovering

1552
01:01:21,240 --> 01:01:22,859
well then probably there's something

1553
01:01:22,859 --> 01:01:24,240
wrong with the infrastructure because

1554
01:01:24,240 --> 01:01:25,920
this should have been done in 20 minutes

1555
01:01:25,920 --> 01:01:27,960
because I tested it

1556
01:01:27,960 --> 01:01:30,480
sorry

1557
01:01:30,480 --> 01:01:31,799
no

1558
01:01:31,799 --> 01:01:35,160
um I don't know why really I don't

1559
01:01:35,160 --> 01:01:36,900
I'm not going to troubleshoot but it

1560
01:01:36,900 --> 01:01:38,760
should be possible to restore really

1561
01:01:38,760 --> 01:01:41,339
really quickly uh because that's the

1562
01:01:41,339 --> 01:01:43,819
whole goal

1563
01:01:44,460 --> 01:01:47,000
questions

1564
01:01:53,940 --> 01:01:55,920
thank you very much for the Deep

1565
01:01:55,920 --> 01:01:59,099
insights into ad recovery

1566
01:01:59,099 --> 01:02:02,119
are there any questions

1567
01:02:03,839 --> 01:02:05,700
and if you have questions afterwards

1568
01:02:05,700 --> 01:02:09,259
contact details

1569
01:02:18,480 --> 01:02:21,480
because

1570
01:02:24,839 --> 01:02:27,540
how to recover service accounts what

1571
01:02:27,540 --> 01:02:29,640
about service accounts

1572
01:02:29,640 --> 01:02:31,799
and the password of the service accounts

1573
01:02:31,799 --> 01:02:33,720
well one of the things we see with

1574
01:02:33,720 --> 01:02:35,880
passwords

1575
01:02:35,880 --> 01:02:38,280
is those are very old

1576
01:02:38,280 --> 01:02:40,079
especially for companies that let's say

1577
01:02:40,079 --> 01:02:43,440
started to use ad from their the the the

1578
01:02:43,440 --> 01:02:46,740
early days let's say the year 2000 or so

1579
01:02:46,740 --> 01:02:49,319
you will find very passwords that are

1580
01:02:49,319 --> 01:02:51,059
very very old you must reset them

1581
01:02:51,059 --> 01:02:53,220
because think about it

1582
01:02:53,220 --> 01:02:56,520
the password that was chosen back then

1583
01:02:56,520 --> 01:02:59,220
it might be strong from that perspective

1584
01:02:59,220 --> 01:03:01,500
but today it's probably nothing

1585
01:03:01,500 --> 01:03:02,579
so

1586
01:03:02,579 --> 01:03:05,220
my aunt my best answer to you and it's I

1587
01:03:05,220 --> 01:03:07,980
think the only answer is

1588
01:03:07,980 --> 01:03:10,680
reset the password of every single

1589
01:03:10,680 --> 01:03:12,660
service account to something that is

1590
01:03:12,660 --> 01:03:15,119
machine machine generated and put it in

1591
01:03:15,119 --> 01:03:17,040
a password vault

1592
01:03:17,040 --> 01:03:19,260
that's the only way I need to do it is

1593
01:03:19,260 --> 01:03:21,420
it a pain yes is it a pain it's a pain

1594
01:03:21,420 --> 01:03:23,099
because it's not just about resetting

1595
01:03:23,099 --> 01:03:25,140
the password you also need to change the

1596
01:03:25,140 --> 01:03:28,140
application if the account is misused in

1597
01:03:28,140 --> 01:03:29,640
all kinds of application and it's doing

1598
01:03:29,640 --> 01:03:31,799
all kinds of things and it's configured

1599
01:03:31,799 --> 01:03:33,660
all over the place then it's going to be

1600
01:03:33,660 --> 01:03:35,579
a pain in the behind to change that

1601
01:03:35,579 --> 01:03:37,819
password

1602
01:03:37,920 --> 01:03:41,540
is there a question about about GMS

1603
01:03:41,540 --> 01:03:44,819
gmsas you need to monitor if those are

1604
01:03:44,819 --> 01:03:46,680
actually being changed on a 30-day by

1605
01:03:46,680 --> 01:03:49,680
30-day basis because gmshas by default

1606
01:03:49,680 --> 01:03:52,260
that's the the the the the best of those

1607
01:03:52,260 --> 01:03:55,079
gmsas if you have a regular service

1608
01:03:55,079 --> 01:03:57,180
account running somewhere for some

1609
01:03:57,180 --> 01:03:59,640
application if the application supports

1610
01:03:59,640 --> 01:04:02,579
a gmsa move to it

1611
01:04:02,579 --> 01:04:04,920
because the password is rotated every 30

1612
01:04:04,920 --> 01:04:07,619
days like a computer account but I also

1613
01:04:07,619 --> 01:04:09,660
know it can occur for whatever stupid

1614
01:04:09,660 --> 01:04:12,359
reason the password is not rotated and

1615
01:04:12,359 --> 01:04:13,799
then you need to investigate what the

1616
01:04:13,799 --> 01:04:16,220
issue is

1617
01:04:16,319 --> 01:04:18,980
for those

1618
01:04:19,020 --> 01:04:21,660
those put it back

1619
01:04:21,660 --> 01:04:24,599
um it's like gmsas it's like a computer

1620
01:04:24,599 --> 01:04:26,520
account password

1621
01:04:26,520 --> 01:04:27,540
um

1622
01:04:27,540 --> 01:04:30,839
30 days change history of one so you

1623
01:04:30,839 --> 01:04:33,180
have basically the window of 60.

1624
01:04:33,180 --> 01:04:35,400
chances that you really go further back

1625
01:04:35,400 --> 01:04:37,020
than

1626
01:04:37,020 --> 01:04:40,500
um than 60 days or when doing a recovery

1627
01:04:40,500 --> 01:04:42,420
I'm going to give you a choice to think

1628
01:04:42,420 --> 01:04:43,380
about

1629
01:04:43,380 --> 01:04:46,740
what will you do regarding choice would

1630
01:04:46,740 --> 01:04:48,839
you choose a backup from today to

1631
01:04:48,839 --> 01:04:50,940
restore that has the shittiest security

1632
01:04:50,940 --> 01:04:53,760
ever or would you choose a backup from a

1633
01:04:53,760 --> 01:04:56,520
week ago that has the best security

1634
01:04:56,520 --> 01:04:59,460
my choice would be the one from today

1635
01:04:59,460 --> 01:05:02,099
with the shittiest security why

1636
01:05:02,099 --> 01:05:04,440
it has the most recent data in terms of

1637
01:05:04,440 --> 01:05:07,740
objects passwords whatever regarding the

1638
01:05:07,740 --> 01:05:09,540
security I can do something about it

1639
01:05:09,540 --> 01:05:13,200
which is easier than going back in time

1640
01:05:13,200 --> 01:05:15,720
having a pain regarding all those

1641
01:05:15,720 --> 01:05:18,119
missing objects all those passwords that

1642
01:05:18,119 --> 01:05:20,220
are mismatching but the security is

1643
01:05:20,220 --> 01:05:23,700
perfect so regarding workload that's so

1644
01:05:23,700 --> 01:05:24,960
much more than

1645
01:05:24,960 --> 01:05:27,980
fixing the security

1646
01:05:28,200 --> 01:05:32,460
I will always always choose

1647
01:05:32,460 --> 01:05:34,559
the the most recent backup available

1648
01:05:34,559 --> 01:05:37,220
always

1649
01:05:37,380 --> 01:05:40,319
okay thank you one more question and

1650
01:05:40,319 --> 01:05:43,799
then due to time restrictions we would

1651
01:05:43,799 --> 01:05:46,140
begin with the next talk

1652
01:05:46,140 --> 01:05:47,819
um I got a question you mentioned that

1653
01:05:47,819 --> 01:05:49,920
all the servers and the clients don't

1654
01:05:49,920 --> 01:05:52,140
have to rejoin the domain what you

1655
01:05:52,140 --> 01:05:54,240
restored and basically how do you do

1656
01:05:54,240 --> 01:05:57,180
that because if you set up a new domain

1657
01:05:57,180 --> 01:05:59,940
basically then you have to rejoin all

1658
01:05:59,940 --> 01:06:01,740
the clients and servers right are you

1659
01:06:01,740 --> 01:06:02,940
talking about the scenario that I

1660
01:06:02,940 --> 01:06:05,520
explained no it was not a new domain it

1661
01:06:05,520 --> 01:06:07,440
was let's call it a clone

1662
01:06:07,440 --> 01:06:11,460
it was a clone sorry so we have an ID we

1663
01:06:11,460 --> 01:06:14,280
backed it up we restored that so call it

1664
01:06:14,280 --> 01:06:15,359
the Clone

1665
01:06:15,359 --> 01:06:17,220
all right so it was if it was a brand

1666
01:06:17,220 --> 01:06:19,200
new domain you would be right

1667
01:06:19,200 --> 01:06:21,540
so because we cloned it and because we

1668
01:06:21,540 --> 01:06:22,980
were thinking well there could be a

1669
01:06:22,980 --> 01:06:25,079
mismatch in passwords somehow let's stop

1670
01:06:25,079 --> 01:06:27,299
the password changing stuff afterwards

1671
01:06:27,299 --> 01:06:29,339
we will fix it and we fixed it to

1672
01:06:29,339 --> 01:06:31,260
prevent those headaches

1673
01:06:31,260 --> 01:06:34,079
first George thank you very much for

1674
01:06:34,079 --> 01:06:36,000
your talk thank you

1675
01:06:36,000 --> 01:06:38,660
thank you

