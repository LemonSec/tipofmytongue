1
00:00:01,199 --> 00:00:05,430
you are able<font color="#CCCCCC"> to do it with low cost</font><font color="#E5E5E5"> low</font>

2
00:00:04,110 --> 00:00:07,740
cost hardware<font color="#CCCCCC"> so we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to show you</font>

3
00:00:05,430 --> 00:00:11,700
<font color="#E5E5E5">how and we're hopefully going to have</font>

4
00:00:07,740 --> 00:00:12,090
fun<font color="#E5E5E5"> doing it</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> hi this is indeed</font><font color="#CCCCCC"> I'm</font>

5
00:00:11,700 --> 00:00:14,820
<font color="#E5E5E5">Melissa</font>

6
00:00:12,090 --> 00:00:17,070
<font color="#E5E5E5">this is Albert</font><font color="#CCCCCC"> and all you</font><font color="#E5E5E5"> need to know</font>

7
00:00:14,820 --> 00:00:20,029
<font color="#CCCCCC">about</font><font color="#E5E5E5"> us is I'm a PhD student</font><font color="#CCCCCC"> and Albert</font>

8
00:00:17,070 --> 00:00:22,439
is I think a freelancer<font color="#E5E5E5"> he calls himself</font>

9
00:00:20,029 --> 00:00:23,400
<font color="#CCCCCC">and what this</font><font color="#E5E5E5"> means is you</font><font color="#CCCCCC"> need to</font><font color="#E5E5E5"> know</font>

10
00:00:22,439 --> 00:00:26,249
two<font color="#CCCCCC"> things about</font><font color="#E5E5E5"> us</font>

11
00:00:23,400 --> 00:00:27,839
one of which<font color="#E5E5E5"> is</font><font color="#CCCCCC"> with sheep so I'm a PhD</font>

12
00:00:26,249 --> 00:00:30,448
student<font color="#CCCCCC"> I don't</font><font color="#E5E5E5"> have much income and</font>

13
00:00:27,839 --> 00:00:33,358
<font color="#E5E5E5">Albert is well be realistic unemployed</font>

14
00:00:30,449 --> 00:00:35,160
<font color="#E5E5E5">so he doesn't have much money and we're</font>

15
00:00:33,359 --> 00:00:36,989
lazy<font color="#E5E5E5"> because</font><font color="#CCCCCC"> I mean I'm a PhD student</font>

16
00:00:35,160 --> 00:00:38,849
<font color="#E5E5E5">it's more I'm super super busy and</font><font color="#CCCCCC"> I</font>

17
00:00:36,989 --> 00:00:41,640
<font color="#CCCCCC">have no</font><font color="#E5E5E5"> time</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> Albert is just plain</font>

18
00:00:38,850 --> 00:00:43,800
<font color="#E5E5E5">lazy so cheap and lazy and</font><font color="#CCCCCC"> that's kind</font>

19
00:00:41,640 --> 00:00:45,180
of<font color="#E5E5E5"> gonna be the folks of historic even</font>

20
00:00:43,800 --> 00:00:46,709
if you know you don't<font color="#E5E5E5"> have much money</font>

21
00:00:45,180 --> 00:00:48,420
and you<font color="#CCCCCC"> don't</font><font color="#E5E5E5"> really want</font><font color="#CCCCCC"> to put too</font>

22
00:00:46,710 --> 00:00:50,100
<font color="#E5E5E5">much time in you can still have at</font><font color="#CCCCCC"> least</font>

23
00:00:48,420 --> 00:00:53,760
fun doing this<font color="#E5E5E5"> and understanding</font><font color="#CCCCCC"> these</font>

24
00:00:50,100 --> 00:00:57,120
attacks<font color="#E5E5E5"> so as I said we're going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> talk</font>

25
00:00:53,760 --> 00:00:58,079
<font color="#CCCCCC">about slight an</font><font color="#E5E5E5"> analysis today and we're</font>

26
00:00:57,120 --> 00:01:00,419
going<font color="#CCCCCC"> to talk about</font><font color="#E5E5E5"> how to do it with</font>

27
00:00:58,079 --> 00:01:02,129
cheap hardware we're<font color="#CCCCCC"> gonna give some</font>

28
00:01:00,420 --> 00:01:04,559
demos we're going to actually<font color="#CCCCCC"> do it</font><font color="#E5E5E5"> here</font>

29
00:01:02,129 --> 00:01:05,939
on stage a bit<font color="#E5E5E5"> and at the end because we</font>

30
00:01:04,559 --> 00:01:07,979
like<font color="#E5E5E5"> photo injection we're also going to</font>

31
00:01:05,939 --> 00:01:12,419
show you a little<font color="#E5E5E5"> bit</font><font color="#CCCCCC"> of Fortune Jackson</font>

32
00:01:07,979 --> 00:01:14,100
just<font color="#E5E5E5"> to</font><font color="#CCCCCC"> finish off the day so side</font>

33
00:01:12,420 --> 00:01:15,990
channel analysis<font color="#CCCCCC"> there's a lot of</font><font color="#E5E5E5"> maths</font>

34
00:01:14,100 --> 00:01:18,089
<font color="#E5E5E5">there's not a theory so it's kind of</font>

35
00:01:15,990 --> 00:01:20,250
hands up if you have some vague idea

36
00:01:18,090 --> 00:01:23,880
about<font color="#E5E5E5"> the math the theory behind side</font>

37
00:01:20,250 --> 00:01:26,549
channel<font color="#E5E5E5"> analysis okay well you know you</font>

38
00:01:23,880 --> 00:01:28,380
don't qualify to be here<font color="#E5E5E5"> the talk</font>

39
00:01:26,549 --> 00:01:30,600
abstract<font color="#CCCCCC"> kitty said you need a</font><font color="#E5E5E5"> healthy</font>

40
00:01:28,380 --> 00:01:32,520
dose of ignorance<font color="#CCCCCC"> and that's really what</font>

41
00:01:30,600 --> 00:01:35,158
we're looking<font color="#CCCCCC"> for</font><font color="#E5E5E5"> today</font><font color="#CCCCCC"> so please</font><font color="#E5E5E5"> don't</font>

42
00:01:32,520 --> 00:01:36,600
cry too<font color="#CCCCCC"> much when we don't discuss the</font>

43
00:01:35,159 --> 00:01:38,040
math and we don't<font color="#E5E5E5"> really go into the</font>

44
00:01:36,600 --> 00:01:39,839
theory this<font color="#E5E5E5"> is going to be kind</font><font color="#CCCCCC"> of a</font>

45
00:01:38,040 --> 00:01:41,369
we're<font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> tell you</font><font color="#CCCCCC"> how it</font><font color="#E5E5E5"> works</font><font color="#CCCCCC"> but</font>

46
00:01:39,840 --> 00:01:44,759
then at some<font color="#CCCCCC"> point it's</font><font color="#E5E5E5"> gonna be magic</font>

47
00:01:41,369 --> 00:01:46,289
<font color="#E5E5E5">but you don't need to care so kind of a</font>

48
00:01:44,759 --> 00:01:47,789
<font color="#CCCCCC">high-level</font><font color="#E5E5E5"> overview just to whatever</font>

49
00:01:46,289 --> 00:01:50,189
we're<font color="#CCCCCC"> talking about what what are we</font>

50
00:01:47,789 --> 00:01:52,110
<font color="#E5E5E5">going to be discussing today so the idea</font>

51
00:01:50,189 --> 00:01:53,339
is we have<font color="#E5E5E5"> some kind of target we will</font>

52
00:01:52,110 --> 00:01:55,409
<font color="#E5E5E5">talk about what kind of target in a</font>

53
00:01:53,340 --> 00:01:58,200
second but you<font color="#E5E5E5"> have something with a</font>

54
00:01:55,409 --> 00:02:00,390
<font color="#CCCCCC">computer a CPU some microprocessor and</font>

55
00:01:58,200 --> 00:02:02,969
<font color="#CCCCCC">you have an attacker</font><font color="#E5E5E5"> that has some kind</font>

56
00:02:00,390 --> 00:02:04,079
of physical access<font color="#CCCCCC"> to this because</font><font color="#E5E5E5"> today</font>

57
00:02:02,969 --> 00:02:06,030
we're<font color="#E5E5E5"> going to be talking</font><font color="#CCCCCC"> about power</font>

58
00:02:04,079 --> 00:02:07,770
<font color="#E5E5E5">side channels you need to be able</font><font color="#CCCCCC"> to</font>

59
00:02:06,030 --> 00:02:09,060
measure the power somehow<font color="#E5E5E5"> and we're</font>

60
00:02:07,770 --> 00:02:10,769
going<font color="#E5E5E5"> to assume you're actually going to</font>

61
00:02:09,060 --> 00:02:13,650
<font color="#CCCCCC">be doing</font><font color="#E5E5E5"> this by physically poking at</font>

62
00:02:10,769 --> 00:02:14,910
the device and<font color="#E5E5E5"> you need some way</font><font color="#CCCCCC"> to send</font>

63
00:02:13,650 --> 00:02:16,440
the device<font color="#CCCCCC"> some commands</font>

64
00:02:14,910 --> 00:02:19,200
because you<font color="#E5E5E5"> want to have some control</font>

65
00:02:16,440 --> 00:02:21,090
<font color="#CCCCCC">over</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> your telling it to</font><font color="#E5E5E5"> do because</font>

66
00:02:19,200 --> 00:02:23,489
we<font color="#CCCCCC"> want to keep our life simple</font><font color="#E5E5E5"> we're</font>

67
00:02:21,090 --> 00:02:25,680
lazy<font color="#E5E5E5"> we want this to be direct we send</font>

68
00:02:23,490 --> 00:02:28,170
it a command<font color="#CCCCCC"> it does</font><font color="#E5E5E5"> something at the</font>

69
00:02:25,680 --> 00:02:31,200
<font color="#E5E5E5">bottom we have this power trace and this</font>

70
00:02:28,170 --> 00:02:33,089
kind of<font color="#E5E5E5"> tells us what it's doing and the</font>

71
00:02:31,200 --> 00:02:36,510
usual context for<font color="#E5E5E5"> this historically is</font>

72
00:02:33,090 --> 00:02:38,790
smart cards these really secure devices

73
00:02:36,510 --> 00:02:41,070
<font color="#CCCCCC">secure elements nowadays which are</font>

74
00:02:38,790 --> 00:02:43,079
<font color="#E5E5E5">really designed slowly to actually</font>

75
00:02:41,070 --> 00:02:45,299
nowadays<font color="#E5E5E5"> resist this</font><font color="#CCCCCC"> kind of attack and</font>

76
00:02:43,080 --> 00:02:49,020
this<font color="#E5E5E5"> has become more more</font><font color="#CCCCCC"> relevant for</font>

77
00:02:45,300 --> 00:02:50,970
various other targets<font color="#CCCCCC"> so in fact</font><font color="#E5E5E5"> you</font>

78
00:02:49,020 --> 00:02:52,860
have this<font color="#CCCCCC"> the systems in cars</font><font color="#E5E5E5"> to protect</font>

79
00:02:50,970 --> 00:02:55,440
<font color="#E5E5E5">crypto keys</font><font color="#CCCCCC"> if you saw the keynote</font>

80
00:02:52,860 --> 00:02:56,250
<font color="#E5E5E5">talking about these these keys which you</font>

81
00:02:55,440 --> 00:02:58,950
used for<font color="#CCCCCC"> a vehicle to vehicle</font>

82
00:02:56,250 --> 00:03:00,600
communication<font color="#E5E5E5"> those are going to be in</font>

83
00:02:58,950 --> 00:03:05,040
<font color="#E5E5E5">secure elements are going</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> be locked</font>

84
00:03:00,600 --> 00:03:07,560
away from<font color="#CCCCCC"> you but</font><font color="#E5E5E5"> also often just it's</font>

85
00:03:05,040 --> 00:03:09,329
interesting<font color="#E5E5E5"> in the general context of</font>

86
00:03:07,560 --> 00:03:12,630
instead of<font color="#E5E5E5"> things of random and devices</font>

87
00:03:09,330 --> 00:03:15,150
because everything has information you

88
00:03:12,630 --> 00:03:18,630
want<font color="#E5E5E5"> to you want to get out of</font><font color="#CCCCCC"> these</font>

89
00:03:15,150 --> 00:03:21,330
devices<font color="#E5E5E5"> discuss in a second but when I</font>

90
00:03:18,630 --> 00:03:24,720
say instead<font color="#CCCCCC"> of things</font><font color="#E5E5E5"> what I mean is my</font>

91
00:03:21,330 --> 00:03:26,280
teddy<font color="#CCCCCC"> bear</font><font color="#E5E5E5"> so this actually is another</font>

92
00:03:24,720 --> 00:03:28,859
device you<font color="#CCCCCC"> can do slide channel analysis</font>

93
00:03:26,280 --> 00:03:31,890
<font color="#CCCCCC">on</font><font color="#E5E5E5"> I found this at</font><font color="#CCCCCC"> the supermarket</font>

94
00:03:28,860 --> 00:03:33,660
it cost me<font color="#E5E5E5"> five euros its cuddly</font><font color="#CCCCCC"> which I</font>

95
00:03:31,890 --> 00:03:36,029
was really surprised that so it's

96
00:03:33,660 --> 00:03:37,410
actually huggable but you can also do

97
00:03:36,030 --> 00:03:39,540
<font color="#E5E5E5">slide</font><font color="#CCCCCC"> share not now see attacks on this</font>

98
00:03:37,410 --> 00:03:43,609
guy<font color="#E5E5E5"> unfortunately</font><font color="#CCCCCC"> he didn't fit in my</font>

99
00:03:39,540 --> 00:03:46,709
luggage<font color="#E5E5E5"> another time maybe</font>

100
00:03:43,610 --> 00:03:49,080
so first I'm gonna talk<font color="#CCCCCC"> about</font><font color="#E5E5E5"> why you</font>

101
00:03:46,709 --> 00:03:50,880
<font color="#E5E5E5">should care</font><font color="#CCCCCC"> about this because</font><font color="#E5E5E5"> it's kind</font>

102
00:03:49,080 --> 00:03:52,620
<font color="#E5E5E5">of side channel analysis it's been</font>

103
00:03:50,880 --> 00:03:55,590
<font color="#E5E5E5">typically on kind of these really</font>

104
00:03:52,620 --> 00:03:58,170
sophisticated secure devices<font color="#E5E5E5"> but</font>

105
00:03:55,590 --> 00:04:00,000
actually<font color="#E5E5E5"> side channels in general and</font>

106
00:03:58,170 --> 00:04:02,040
<font color="#CCCCCC">that includes</font><font color="#E5E5E5"> power side channels</font>

107
00:04:00,000 --> 00:04:03,930
they're really useful<font color="#E5E5E5"> when you're stuck</font>

108
00:04:02,040 --> 00:04:05,640
<font color="#CCCCCC">so if you're trying to exploit the</font>

109
00:04:03,930 --> 00:04:08,040
device but you<font color="#E5E5E5"> don't really know what's</font>

110
00:04:05,640 --> 00:04:10,320
<font color="#E5E5E5">going on inside</font><font color="#CCCCCC"> maybe</font><font color="#E5E5E5"> you don't have</font><font color="#CCCCCC"> the</font>

111
00:04:08,040 --> 00:04:12,870
firmware<font color="#CCCCCC"> you know maybe you</font><font color="#E5E5E5"> just</font>

112
00:04:10,320 --> 00:04:14,670
something weird is going<font color="#E5E5E5"> on and you</font>

113
00:04:12,870 --> 00:04:17,040
<font color="#CCCCCC">don't have any insight into the device</font>

114
00:04:14,670 --> 00:04:18,539
<font color="#E5E5E5">and what we're going</font><font color="#CCCCCC"> to show you</font><font color="#E5E5E5"> is side</font>

115
00:04:17,040 --> 00:04:20,130
channels can be<font color="#E5E5E5"> used to</font><font color="#CCCCCC"> basically gain</font>

116
00:04:18,540 --> 00:04:23,880
some extra<font color="#CCCCCC"> information about</font><font color="#E5E5E5"> what's</font>

117
00:04:20,130 --> 00:04:27,180
<font color="#CCCCCC">going on it's again some just insight</font>

118
00:04:23,880 --> 00:04:29,579
into what's happening<font color="#E5E5E5"> and kind of this</font>

119
00:04:27,180 --> 00:04:31,409
<font color="#CCCCCC">is</font><font color="#E5E5E5"> kind of small card stuffing</font>

120
00:04:29,579 --> 00:04:32,519
the standard<font color="#CCCCCC"> example is</font><font color="#E5E5E5"> this pin check</font>

121
00:04:31,409 --> 00:04:35,129
and I'm going to<font color="#CCCCCC"> use it because</font><font color="#E5E5E5"> I think</font>

122
00:04:32,519 --> 00:04:38,159
it's<font color="#E5E5E5"> really nice</font><font color="#CCCCCC"> you have maybe a</font><font color="#E5E5E5"> four</font>

123
00:04:35,129 --> 00:04:41,099
digit<font color="#E5E5E5"> PIN and say a credit card or any</font>

124
00:04:38,159 --> 00:04:42,959
<font color="#E5E5E5">kind of secure system and it has some</font>

125
00:04:41,099 --> 00:04:45,299
<font color="#CCCCCC">kind of loop like this</font><font color="#E5E5E5"> which checks is</font>

126
00:04:42,959 --> 00:04:48,029
the user input the<font color="#CCCCCC"> command you sent it</font>

127
00:04:45,299 --> 00:04:50,818
maybe over serial equal to the secret

128
00:04:48,029 --> 00:04:52,979
pin and if it doesn't<font color="#E5E5E5"> match</font><font color="#CCCCCC"> on one of</font>

129
00:04:50,819 --> 00:04:54,689
<font color="#E5E5E5">the loop iterations then it fails out so</font>

130
00:04:52,979 --> 00:04:57,329
it's<font color="#E5E5E5"> just one two three four checks if</font>

131
00:04:54,689 --> 00:04:59,699
they're the<font color="#CCCCCC"> same when this is a power</font>

132
00:04:57,329 --> 00:05:03,059
trace<font color="#E5E5E5"> form a device running this kind</font><font color="#CCCCCC"> of</font>

133
00:04:59,699 --> 00:05:04,860
pin check<font color="#E5E5E5"> and you look at this and yeah</font>

134
00:05:03,059 --> 00:05:07,649
I have no<font color="#CCCCCC"> idea what's</font><font color="#E5E5E5"> going on in this</font>

135
00:05:04,860 --> 00:05:11,009
thing but I can tell you keep an eye on

136
00:05:07,649 --> 00:05:12,659
<font color="#E5E5E5">this little circle bit here this is just</font>

137
00:05:11,009 --> 00:05:14,879
a random pin<font color="#E5E5E5"> we've sent to the device</font>

138
00:05:12,659 --> 00:05:16,619
<font color="#E5E5E5">what I'm going to do now is replace this</font>

139
00:05:14,879 --> 00:05:18,809
power trace with a trace we've taken

140
00:05:16,619 --> 00:05:23,189
<font color="#E5E5E5">where the first digit of</font><font color="#CCCCCC"> the pin is</font>

141
00:05:18,809 --> 00:05:26,939
correct<font color="#CCCCCC"> and you can see okay the pattern</font>

142
00:05:23,189 --> 00:05:29,909
kind<font color="#E5E5E5"> of changed there specifically what</font>

143
00:05:26,939 --> 00:05:33,079
happened<font color="#E5E5E5"> is now we have</font><font color="#CCCCCC"> two of these</font>

144
00:05:29,909 --> 00:05:36,149
<font color="#E5E5E5">patterns when we had one</font><font color="#CCCCCC"> before</font><font color="#E5E5E5"> because</font>

145
00:05:33,079 --> 00:05:38,189
<font color="#E5E5E5">we have two loop iterations and this</font>

146
00:05:36,149 --> 00:05:39,989
<font color="#E5E5E5">little pattern is representing one of</font>

147
00:05:38,189 --> 00:05:42,389
<font color="#E5E5E5">these iterations</font><font color="#CCCCCC"> around the loop</font><font color="#E5E5E5"> doing a</font>

148
00:05:39,989 --> 00:05:44,638
pin check it's gone from<font color="#E5E5E5"> 1 to 2 if I put</font>

149
00:05:42,389 --> 00:05:46,919
them side-by-side<font color="#CCCCCC"> if we have no digits</font>

150
00:05:44,639 --> 00:05:48,179
correct you get the first<font color="#E5E5E5"> one one digit</font>

151
00:05:46,919 --> 00:05:50,008
<font color="#E5E5E5">correct you get the second one</font>

152
00:05:48,179 --> 00:05:51,989
so just<font color="#E5E5E5"> literally by looking at this</font>

153
00:05:50,009 --> 00:05:53,939
visually by just<font color="#CCCCCC"> looking</font><font color="#E5E5E5"> at the power</font>

154
00:05:51,989 --> 00:05:56,518
trace and seeing oh when I send<font color="#E5E5E5"> this</font>

155
00:05:53,939 --> 00:05:58,159
input<font color="#E5E5E5"> well it changes you can actually</font>

156
00:05:56,519 --> 00:06:00,749
<font color="#E5E5E5">gain information</font><font color="#CCCCCC"> about what's going on</font>

157
00:05:58,159 --> 00:06:02,998
<font color="#E5E5E5">and I think this I would recommend to</font>

158
00:06:00,749 --> 00:06:04,259
everyone<font color="#E5E5E5"> because when you're stuck when</font>

159
00:06:02,999 --> 00:06:07,189
you don't know what's<font color="#E5E5E5"> going on and</font>

160
00:06:04,259 --> 00:06:12,059
you're trying<font color="#E5E5E5"> to even debug your device</font>

161
00:06:07,189 --> 00:06:13,979
it can<font color="#E5E5E5"> be</font><font color="#CCCCCC"> useful but then</font><font color="#E5E5E5"> they'll step</font>

162
00:06:12,059 --> 00:06:15,419
<font color="#CCCCCC">back a bit</font><font color="#E5E5E5"> it's like</font><font color="#CCCCCC"> wait a minute</font><font color="#E5E5E5"> how</font>

163
00:06:13,979 --> 00:06:18,119
<font color="#E5E5E5">enough do we do this power measurement</font>

164
00:06:15,419 --> 00:06:20,818
<font color="#E5E5E5">in the first place so we have some kind</font>

165
00:06:18,119 --> 00:06:23,669
<font color="#CCCCCC">of processor so kind of CPU</font><font color="#E5E5E5"> and we want</font>

166
00:06:20,819 --> 00:06:25,279
to get the power measurements<font color="#E5E5E5"> and we're</font>

167
00:06:23,669 --> 00:06:28,409
going to<font color="#E5E5E5"> do that using an oscilloscope</font>

168
00:06:25,279 --> 00:06:30,449
<font color="#CCCCCC">how do</font><font color="#E5E5E5"> you do this measurement well okay</font>

169
00:06:28,409 --> 00:06:32,159
you have a power line<font color="#CCCCCC"> so it's got</font><font color="#E5E5E5"> to be</font>

170
00:06:30,449 --> 00:06:33,989
<font color="#E5E5E5">pulling this power</font><font color="#CCCCCC"> that is using from</font>

171
00:06:32,159 --> 00:06:35,610
somewhere<font color="#E5E5E5"> we want</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> measure</font><font color="#CCCCCC"> how much</font>

172
00:06:33,989 --> 00:06:37,828
power it's using<font color="#E5E5E5"> to get these pretty</font>

173
00:06:35,610 --> 00:06:40,739
graphs<font color="#E5E5E5"> so what we can do we just cut the</font>

174
00:06:37,829 --> 00:06:43,139
power line<font color="#E5E5E5"> and ideally we've just taken</font>

175
00:06:40,739 --> 00:06:46,409
a<font color="#E5E5E5"> Scylla scope and we just plug kind of</font>

176
00:06:43,139 --> 00:06:48,120
one end into<font color="#E5E5E5"> one side put another probe</font>

177
00:06:46,409 --> 00:06:50,219
or the earth clip<font color="#E5E5E5"> into the other side</font>

178
00:06:48,120 --> 00:06:53,219
and<font color="#CCCCCC"> just measure the</font><font color="#E5E5E5"> power and it's</font>

179
00:06:50,220 --> 00:06:55,080
<font color="#E5E5E5">almost that simple what do you have to</font>

180
00:06:53,219 --> 00:06:56,879
do is you can't do this directly<font color="#CCCCCC"> but</font>

181
00:06:55,080 --> 00:06:59,460
<font color="#CCCCCC">what you can do is we put a resistor in</font>

182
00:06:56,879 --> 00:07:01,469
there<font color="#E5E5E5"> called a shunt resistor and it's</font>

183
00:06:59,460 --> 00:07:03,780
just a matter of experimentation<font color="#CCCCCC"> so you</font>

184
00:07:01,469 --> 00:07:06,719
<font color="#E5E5E5">just have to pick a resistor that has a</font>

185
00:07:03,780 --> 00:07:08,128
high enough value<font color="#E5E5E5"> alone enough fatty</font>

186
00:07:06,719 --> 00:07:09,930
that<font color="#E5E5E5"> it still works</font><font color="#CCCCCC"> but a high enough</font>

187
00:07:08,129 --> 00:07:11,699
<font color="#CCCCCC">value that the measurements work but you</font>

188
00:07:09,930 --> 00:07:14,460
<font color="#E5E5E5">just kind of</font><font color="#CCCCCC"> fit</font><font color="#E5E5E5"> all until you have</font>

189
00:07:11,699 --> 00:07:15,889
<font color="#E5E5E5">something</font><font color="#CCCCCC"> that works and then you just</font>

190
00:07:14,460 --> 00:07:18,568
plug your<font color="#E5E5E5"> oscilloscope</font><font color="#CCCCCC"> into either</font><font color="#E5E5E5"> side</font>

191
00:07:15,889 --> 00:07:21,870
<font color="#E5E5E5">and this is what we're going to be doing</font>

192
00:07:18,569 --> 00:07:24,210
today<font color="#E5E5E5"> and it's just kind of</font><font color="#CCCCCC"> ok this is</font>

193
00:07:21,870 --> 00:07:25,680
all very theoretical<font color="#E5E5E5"> so far and we want</font>

194
00:07:24,210 --> 00:07:26,909
something<font color="#CCCCCC"> you can go and do at home</font><font color="#E5E5E5"> we</font>

195
00:07:25,680 --> 00:07:29,520
<font color="#E5E5E5">want something</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> everyone can</font><font color="#CCCCCC"> do at</font>

196
00:07:26,909 --> 00:07:32,460
<font color="#CCCCCC">home and so as an example target</font>

197
00:07:29,520 --> 00:07:35,690
we picked the<font color="#E5E5E5"> Arduino</font><font color="#CCCCCC"> Nano</font><font color="#E5E5E5"> which is</font>

198
00:07:32,460 --> 00:07:37,888
perfect for many reasons<font color="#E5E5E5"> it's cheap</font>

199
00:07:35,690 --> 00:07:39,690
ideally everyone has<font color="#E5E5E5"> them lying</font><font color="#CCCCCC"> around</font>

200
00:07:37,889 --> 00:07:41,129
<font color="#E5E5E5">or people you know have to</font><font color="#CCCCCC"> lie around</font>

201
00:07:39,690 --> 00:07:42,990
<font color="#CCCCCC">and</font><font color="#E5E5E5"> they're not going</font><font color="#CCCCCC"> to notice if you</font>

202
00:07:41,129 --> 00:07:44,960
want off with them though they will

203
00:07:42,990 --> 00:07:47,340
notice when<font color="#E5E5E5"> you see what you do to them</font>

204
00:07:44,960 --> 00:07:48,479
<font color="#CCCCCC">and it's not secure</font><font color="#E5E5E5"> which is really</font>

205
00:07:47,340 --> 00:07:51,479
great<font color="#E5E5E5"> because it doesn't have any</font>

206
00:07:48,479 --> 00:07:53,580
<font color="#CCCCCC">protection whatsoever</font><font color="#E5E5E5"> and no matter how</font>

207
00:07:51,479 --> 00:07:55,500
much<font color="#E5E5E5"> you screw up believe me</font><font color="#CCCCCC"> you'll see</font>

208
00:07:53,580 --> 00:07:57,389
some<font color="#CCCCCC"> examples theta</font><font color="#E5E5E5"> you will managed</font><font color="#CCCCCC"> to</font>

209
00:07:55,500 --> 00:08:00,990
do slide channel analysis on this kind

210
00:07:57,389 --> 00:08:03,089
<font color="#CCCCCC">of</font><font color="#E5E5E5"> device the bad news is that in</font>

211
00:08:00,990 --> 00:08:05,460
<font color="#E5E5E5">practice making</font><font color="#CCCCCC"> these power cuts</font><font color="#E5E5E5"> is not</font>

212
00:08:03,089 --> 00:08:08,729
so simple<font color="#CCCCCC"> for example on the arduino</font>

213
00:08:05,460 --> 00:08:12,719
<font color="#CCCCCC">nano</font><font color="#E5E5E5"> the communication is</font><font color="#CCCCCC"> done via</font><font color="#E5E5E5"> a</font>

214
00:08:08,729 --> 00:08:14,550
serial<font color="#CCCCCC"> to USB</font><font color="#E5E5E5"> communication</font><font color="#CCCCCC"> chip and the</font>

215
00:08:12,719 --> 00:08:17,759
power<font color="#CCCCCC"> that it's using you don't want to</font>

216
00:08:14,550 --> 00:08:19,860
mess<font color="#CCCCCC"> with</font><font color="#E5E5E5"> and so you</font><font color="#CCCCCC"> actually have to</font>

217
00:08:17,759 --> 00:08:22,259
make<font color="#E5E5E5"> cuts in two places to preserve the</font>

218
00:08:19,860 --> 00:08:24,360
power do a bit<font color="#E5E5E5"> of soldering and</font><font color="#CCCCCC"> in real</font>

219
00:08:22,259 --> 00:08:26,190
<font color="#CCCCCC">life I think the</font><font color="#E5E5E5"> most difficult part at</font>

220
00:08:24,360 --> 00:08:29,400
<font color="#E5E5E5">least for me about doing</font><font color="#CCCCCC"> site</font><font color="#E5E5E5"> analysis</font>

221
00:08:26,190 --> 00:08:33,208
is this<font color="#E5E5E5"> is getting things soldered and</font>

222
00:08:29,400 --> 00:08:34,708
quickly piling on hot glue<font color="#CCCCCC"> I think these</font>

223
00:08:33,208 --> 00:08:37,919
are all<font color="#CCCCCC"> albert's</font><font color="#E5E5E5"> which I can tell</font>

224
00:08:34,708 --> 00:08:40,978
because<font color="#E5E5E5"> they all work</font><font color="#CCCCCC"> just so that they</font>

225
00:08:37,919 --> 00:08:42,390
actually so<font color="#CCCCCC"> that you</font><font color="#E5E5E5"> actually have all</font>

226
00:08:40,979 --> 00:08:43,769
<font color="#CCCCCC">of</font><font color="#E5E5E5"> these bits wide in the right place</font>

227
00:08:42,390 --> 00:08:45,689
and<font color="#E5E5E5"> you have headers</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you can</font>

228
00:08:43,769 --> 00:08:48,000
connect your resistors to<font color="#E5E5E5"> I mean if you</font>

229
00:08:45,690 --> 00:08:50,490
get this far and if you just so<font color="#E5E5E5"> you mean</font>

230
00:08:48,000 --> 00:08:52,770
you've<font color="#E5E5E5"> made your cut here</font><font color="#CCCCCC"> so your</font><font color="#E5E5E5"> middle</font>

231
00:08:50,490 --> 00:08:54,329
<font color="#CCCCCC">headers taking outside</font><font color="#E5E5E5"> your power in the</font>

232
00:08:52,770 --> 00:08:55,829
head<font color="#E5E5E5"> of somewhere else your power out if</font>

233
00:08:54,329 --> 00:08:56,899
you could connect the<font color="#E5E5E5"> two of those with</font>

234
00:08:55,829 --> 00:08:59,180
a wire<font color="#E5E5E5"> then you</font>

235
00:08:56,899 --> 00:09:01,009
<font color="#E5E5E5">why still works then you're</font><font color="#CCCCCC"> 90% of the</font>

236
00:08:59,180 --> 00:09:03,498
way there and the<font color="#E5E5E5"> great thing about the</font>

237
00:09:01,009 --> 00:09:04,970
<font color="#E5E5E5">Arduino</font><font color="#CCCCCC"> Nano</font><font color="#E5E5E5"> is even if you screw up</font><font color="#CCCCCC"> a</font>

238
00:09:03,499 --> 00:09:07,249
whole bunch<font color="#E5E5E5"> of them it doesn't</font><font color="#CCCCCC"> matter</font>

239
00:09:04,970 --> 00:09:09,459
<font color="#CCCCCC">because they're cheap and they're</font>

240
00:09:07,249 --> 00:09:12,259
<font color="#E5E5E5">plentiful and you can play with</font><font color="#CCCCCC"> them</font><font color="#E5E5E5"> so</font>

241
00:09:09,459 --> 00:09:14,660
again I really recommend<font color="#CCCCCC"> that if you</font><font color="#E5E5E5"> get</font>

242
00:09:12,259 --> 00:09:16,939
a<font color="#E5E5E5"> chance</font><font color="#CCCCCC"> play with</font><font color="#E5E5E5"> this if you're you</font>

243
00:09:14,660 --> 00:09:20,329
know<font color="#E5E5E5"> crazy enough to enjoy this kind of</font>

244
00:09:16,939 --> 00:09:23,540
thing<font color="#E5E5E5"> but you should so going back</font><font color="#CCCCCC"> to</font>

245
00:09:20,329 --> 00:09:25,339
the big picture<font color="#CCCCCC"> so when you</font><font color="#E5E5E5"> actually do</font>

246
00:09:23,540 --> 00:09:27,050
side channel analysis<font color="#E5E5E5"> you're gonna have</font>

247
00:09:25,339 --> 00:09:28,309
<font color="#E5E5E5">your target some kind of processor you</font>

248
00:09:27,050 --> 00:09:30,258
could<font color="#E5E5E5"> have made this power cut so your</font>

249
00:09:28,309 --> 00:09:31,699
signal<font color="#E5E5E5"> is going to be a power signal</font>

250
00:09:30,259 --> 00:09:33,709
<font color="#E5E5E5">you're going to connect this to it</font>

251
00:09:31,699 --> 00:09:35,449
oscilloscope<font color="#E5E5E5"> you're</font><font color="#CCCCCC"> gonna have</font><font color="#E5E5E5"> something</font>

252
00:09:33,709 --> 00:09:36,859
called a trigger which if you're<font color="#CCCCCC"> not</font>

253
00:09:35,449 --> 00:09:38,449
<font color="#CCCCCC">familiar with oscilloscopes tells</font><font color="#E5E5E5"> the</font>

254
00:09:36,860 --> 00:09:40,069
oscilloscope when to<font color="#E5E5E5"> start measuring and</font>

255
00:09:38,449 --> 00:09:42,469
<font color="#CCCCCC">then</font><font color="#E5E5E5"> you're going to have some kind</font><font color="#CCCCCC"> of</font>

256
00:09:40,069 --> 00:09:45,110
computer which is sending<font color="#CCCCCC"> these commands</font>

257
00:09:42,470 --> 00:09:47,119
<font color="#E5E5E5">telling this target please do some kind</font>

258
00:09:45,110 --> 00:09:49,279
of operation maybe giving it<font color="#E5E5E5"> pin codes</font>

259
00:09:47,119 --> 00:09:51,920
<font color="#E5E5E5">and you're going to the PC is going to</font>

260
00:09:49,279 --> 00:09:54,709
be<font color="#E5E5E5"> connecting the measurements from</font><font color="#CCCCCC"> the</font>

261
00:09:51,920 --> 00:09:56,628
PC from the oscilloscope<font color="#CCCCCC"> the</font><font color="#E5E5E5"> great news</font>

262
00:09:54,709 --> 00:09:58,609
is<font color="#E5E5E5"> it can be</font><font color="#CCCCCC"> a really</font><font color="#E5E5E5"> cheap PC which if</font>

263
00:09:56,629 --> 00:10:00,170
you're<font color="#E5E5E5"> plugging things into kind of</font>

264
00:09:58,610 --> 00:10:02,449
<font color="#E5E5E5">handmade Hardware where you solder</font>

265
00:10:00,170 --> 00:10:03,620
things together<font color="#E5E5E5"> is great because you</font>

266
00:10:02,449 --> 00:10:05,929
<font color="#CCCCCC">probably don't want to</font><font color="#E5E5E5"> be doing this</font>

267
00:10:03,620 --> 00:10:07,759
<font color="#E5E5E5">your very expensive laptop though having</font>

268
00:10:05,929 --> 00:10:09,949
said that I<font color="#E5E5E5"> have a very expensive laptop</font>

269
00:10:07,759 --> 00:10:10,819
right<font color="#E5E5E5"> here</font><font color="#CCCCCC"> and it's not</font><font color="#E5E5E5"> broken no</font><font color="#CCCCCC"> matter</font>

270
00:10:09,949 --> 00:10:15,170
what I've<font color="#E5E5E5"> done to it</font>

271
00:10:10,819 --> 00:10:17,319
so far<font color="#E5E5E5"> so</font><font color="#CCCCCC"> okay we're</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to do a demo</font>

272
00:10:15,170 --> 00:10:20,149
in the sense that<font color="#E5E5E5"> right in front</font><font color="#CCCCCC"> of me</font>

273
00:10:17,319 --> 00:10:22,219
<font color="#CCCCCC">we have a setup</font><font color="#E5E5E5"> which you probably</font><font color="#CCCCCC"> can't</font>

274
00:10:20,149 --> 00:10:23,449
<font color="#E5E5E5">see very well which is unfortunate I</font>

275
00:10:22,220 --> 00:10:25,999
will show you once you've actually done

276
00:10:23,449 --> 00:10:29,209
it<font color="#E5E5E5"> but basically what they have here is</font>

277
00:10:25,999 --> 00:10:32,569
<font color="#E5E5E5">I have a modified nano and I have a</font>

278
00:10:29,209 --> 00:10:34,729
bunch<font color="#CCCCCC"> of resistors and</font><font color="#E5E5E5"> I have an</font>

279
00:10:32,569 --> 00:10:37,248
oscilloscope and<font color="#CCCCCC"> so what I'm</font><font color="#E5E5E5"> going</font><font color="#CCCCCC"> to do</font>

280
00:10:34,730 --> 00:10:39,170
is exactly<font color="#E5E5E5"> is described in this light</font>

281
00:10:37,249 --> 00:10:40,730
here what I'm<font color="#E5E5E5"> going to do I'm going to</font>

282
00:10:39,170 --> 00:10:42,349
<font color="#E5E5E5">communicate with the</font><font color="#CCCCCC"> target</font><font color="#E5E5E5"> and send it</font>

283
00:10:40,730 --> 00:10:43,779
some signals and then I'm going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> look</font>

284
00:10:42,350 --> 00:10:46,670
at the signal<font color="#E5E5E5"> I get from my oscilloscope</font>

285
00:10:43,779 --> 00:10:49,730
<font color="#E5E5E5">and the oscilloscope is communicating</font>

286
00:10:46,670 --> 00:10:53,628
via USB<font color="#E5E5E5"> so this is just</font><font color="#CCCCCC"> the Python</font>

287
00:10:49,730 --> 00:10:55,699
<font color="#CCCCCC">script which I hope will actually</font>

288
00:10:53,629 --> 00:10:58,369
communicate<font color="#CCCCCC"> with the target if not I</font>

289
00:10:55,699 --> 00:11:02,209
have<font color="#E5E5E5"> to we plug things there we go it's</font>

290
00:10:58,369 --> 00:11:03,860
doing<font color="#E5E5E5"> something</font><font color="#CCCCCC"> I then I have a very</font>

291
00:11:02,209 --> 00:11:07,279
quickly hat together<font color="#E5E5E5"> a user interface</font>

292
00:11:03,860 --> 00:11:10,400
which just<font color="#CCCCCC"> shows signals in</font><font color="#E5E5E5"> the</font>

293
00:11:07,279 --> 00:11:12,890
oscilloscope<font color="#CCCCCC"> so you can see you can</font>

294
00:11:10,400 --> 00:11:14,390
some kind of pattern here<font color="#CCCCCC"> and if I just</font>

295
00:11:12,890 --> 00:11:16,670
keep<font color="#E5E5E5"> on pressing get them sometimes you</font>

296
00:11:14,390 --> 00:11:18,949
<font color="#CCCCCC">get will noise like this which means</font>

297
00:11:16,670 --> 00:11:20,390
we're not<font color="#CCCCCC"> capturing</font><font color="#E5E5E5"> anything interesting</font>

298
00:11:18,950 --> 00:11:25,130
probably<font color="#E5E5E5"> the devices and doing something</font>

299
00:11:20,390 --> 00:11:26,630
<font color="#E5E5E5">but you also get really nice</font><font color="#CCCCCC"> signals</font>

300
00:11:25,130 --> 00:11:29,120
like this<font color="#E5E5E5"> where you can</font><font color="#CCCCCC"> see wow there's</font>

301
00:11:26,630 --> 00:11:31,130
real patterns here and this is actually

302
00:11:29,120 --> 00:11:38,320
you can<font color="#E5E5E5"> really see what's</font><font color="#CCCCCC"> going on</font><font color="#E5E5E5"> those</font>

303
00:11:31,130 --> 00:11:38,320
<font color="#E5E5E5">weird explained awesome do you know how</font>

304
00:11:39,430 --> 00:11:52,670
is there a button here<font color="#E5E5E5"> Oh awesome</font><font color="#CCCCCC"> not</font>

305
00:11:51,590 --> 00:11:55,550
that of course<font color="#E5E5E5"> you can see this very</font>

306
00:11:52,670 --> 00:11:56,959
<font color="#E5E5E5">well but</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> we should</font><font color="#CCCCCC"> weave so we've</font>

307
00:11:55,550 --> 00:11:59,500
shown<font color="#CCCCCC"> the use of interface so what I'm</font>

308
00:11:56,960 --> 00:12:03,200
<font color="#E5E5E5">actually going to do here is</font><font color="#CCCCCC"> just uh</font>

309
00:11:59,500 --> 00:12:06,860
hopefully kill this and simply hold

310
00:12:03,200 --> 00:12:09,460
<font color="#E5E5E5">things up to the camera</font><font color="#CCCCCC"> it's uh</font><font color="#E5E5E5"> I'm</font>

311
00:12:06,860 --> 00:12:15,350
gonna terribly regret this<font color="#E5E5E5"> all night but</font>

312
00:12:09,460 --> 00:12:18,260
so this is<font color="#E5E5E5"> yeah which you can't see</font><font color="#CCCCCC"> very</font>

313
00:12:15,350 --> 00:12:20,240
<font color="#CCCCCC">well in</font><font color="#E5E5E5"> the lighting but yeah</font><font color="#CCCCCC"> take my</font>

314
00:12:18,260 --> 00:12:22,730
word for<font color="#CCCCCC"> it this is our mango together</font>

315
00:12:20,240 --> 00:12:24,890
<font color="#CCCCCC">or do we know a nano still plugged into</font>

316
00:12:22,730 --> 00:12:26,960
power you have this little red<font color="#E5E5E5"> LED which</font>

317
00:12:24,890 --> 00:12:29,000
is very misleading<font color="#CCCCCC"> because</font><font color="#E5E5E5"> the LED is</font>

318
00:12:26,960 --> 00:12:30,950
powered directly<font color="#CCCCCC"> from the USB</font><font color="#E5E5E5"> power and</font>

319
00:12:29,000 --> 00:12:32,240
not<font color="#E5E5E5"> from your power cut so you see this</font>

320
00:12:30,950 --> 00:12:36,140
red light<font color="#E5E5E5"> and you think oh it's working</font>

321
00:12:32,240 --> 00:12:37,730
<font color="#E5E5E5">but no you speed up the power cut and</font>

322
00:12:36,140 --> 00:12:39,069
then<font color="#CCCCCC"> you</font><font color="#E5E5E5"> have all of this hot glue on</font>

323
00:12:37,730 --> 00:12:41,960
the<font color="#E5E5E5"> back that you can't really see and</font>

324
00:12:39,070 --> 00:12:44,330
<font color="#E5E5E5">because I like easy to see things all</font>

325
00:12:41,960 --> 00:12:48,380
I've mounted all the resistors here just

326
00:12:44,330 --> 00:12:50,060
on this big board now we'll talk more

327
00:12:48,380 --> 00:12:59,689
about this later<font color="#CCCCCC"> for now maybe go back</font>

328
00:12:50,060 --> 00:13:02,209
to the explanations am I going the right

329
00:12:59,690 --> 00:13:04,940
<font color="#CCCCCC">direction yes I am</font><font color="#E5E5E5"> okay so to talk about</font>

330
00:13:02,210 --> 00:13:07,340
what's going<font color="#E5E5E5"> on</font><font color="#CCCCCC"> so we saw just quickly</font>

331
00:13:04,940 --> 00:13:08,900
<font color="#E5E5E5">hitting the button there collecting data</font>

332
00:13:07,340 --> 00:13:11,960
from<font color="#E5E5E5"> the oscilloscope</font><font color="#CCCCCC"> we saw it lovely</font>

333
00:13:08,900 --> 00:13:13,939
<font color="#E5E5E5">patterns like this and what exactly does</font>

334
00:13:11,960 --> 00:13:16,940
this mean<font color="#CCCCCC"> why do we care about the power</font>

335
00:13:13,940 --> 00:13:19,490
<font color="#E5E5E5">usage of the processor</font><font color="#CCCCCC"> of whatever is</font>

336
00:13:16,940 --> 00:13:21,110
running on the<font color="#E5E5E5"> Nano and to cut kind of a</font>

337
00:13:19,490 --> 00:13:24,140
long<font color="#CCCCCC"> story short</font><font color="#E5E5E5"> for our purposes we're</font>

338
00:13:21,110 --> 00:13:25,820
going<font color="#CCCCCC"> to</font><font color="#E5E5E5"> be talking about software</font>

339
00:13:24,140 --> 00:13:28,760
<font color="#CCCCCC">what we're seeing</font><font color="#E5E5E5"> is the switching of</font>

340
00:13:25,820 --> 00:13:31,250
<font color="#CCCCCC">the transistors in the device and</font><font color="#E5E5E5"> the</font>

341
00:13:28,760 --> 00:13:33,589
important<font color="#CCCCCC"> thing is that the power</font><font color="#E5E5E5"> usage</font>

342
00:13:31,250 --> 00:13:35,180
of these transistors<font color="#E5E5E5"> depends on the date</font>

343
00:13:33,589 --> 00:13:37,730
have been<font color="#E5E5E5"> processed and the code being</font>

344
00:13:35,180 --> 00:13:38,630
<font color="#E5E5E5">run but we care today about the data</font>

345
00:13:37,730 --> 00:13:41,149
<font color="#CCCCCC">being processed</font>

346
00:13:38,630 --> 00:13:41,660
<font color="#E5E5E5">and for software</font><font color="#CCCCCC"> and turns</font><font color="#E5E5E5"> out the power</font>

347
00:13:41,149 --> 00:13:44,680
usage

348
00:13:41,660 --> 00:13:47,240
is higher the more<font color="#E5E5E5"> warms in your data</font>

349
00:13:44,680 --> 00:13:51,349
it's all binary<font color="#E5E5E5"> the more ones in your</font>

350
00:13:47,240 --> 00:13:53,269
data<font color="#E5E5E5"> the power usage is higher so just</font>

351
00:13:51,350 --> 00:13:54,769
to make<font color="#CCCCCC"> it easier to discuss</font><font color="#E5E5E5"> this</font><font color="#CCCCCC"> stuff</font>

352
00:13:53,269 --> 00:13:56,930
there's something called Hamming weight

353
00:13:54,769 --> 00:13:59,180
if<font color="#E5E5E5"> you're not familiar the Hamming</font>

354
00:13:56,930 --> 00:14:01,010
weight of<font color="#E5E5E5"> a byte for example it's just</font>

355
00:13:59,180 --> 00:14:03,589
the<font color="#E5E5E5"> number</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> warms which is head in</font>

356
00:14:01,010 --> 00:14:05,870
that bite so<font color="#CCCCCC"> 0 has a</font><font color="#E5E5E5"> Hamming weight</font><font color="#CCCCCC"> of 0</font>

357
00:14:03,589 --> 00:14:10,100
<font color="#E5E5E5">+ FF you have all the one set has a</font>

358
00:14:05,870 --> 00:14:11,540
Hamming weight<font color="#CCCCCC"> of 8 but this is not so</font>

359
00:14:10,100 --> 00:14:14,570
perfect<font color="#E5E5E5"> for working out what's going on</font>

360
00:14:11,540 --> 00:14:17,899
<font color="#E5E5E5">because</font><font color="#CCCCCC"> for example the number 5 has two</font>

361
00:14:14,570 --> 00:14:20,329
ones in binary<font color="#E5E5E5"> having weight of</font><font color="#CCCCCC"> 2 but 0</font>

362
00:14:17,899 --> 00:14:22,190
it's 11<font color="#E5E5E5"> also</font><font color="#CCCCCC"> a Hamming weight of 2</font><font color="#E5E5E5"> so</font>

363
00:14:20,329 --> 00:14:24,709
whatever we're going to do<font color="#E5E5E5"> for side</font>

364
00:14:22,190 --> 00:14:26,930
channel analysis if we're going<font color="#E5E5E5"> to</font>

365
00:14:24,709 --> 00:14:28,160
depend<font color="#E5E5E5"> on this switching then we're</font>

366
00:14:26,930 --> 00:14:30,560
going to<font color="#E5E5E5"> have to find a way that works</font>

367
00:14:28,160 --> 00:14:32,930
<font color="#CCCCCC">even</font><font color="#E5E5E5"> though all we can really see is the</font>

368
00:14:30,560 --> 00:14:35,959
Hamming weight of<font color="#E5E5E5"> these values being</font>

369
00:14:32,930 --> 00:14:38,899
processed<font color="#E5E5E5"> so just to kind of again step</font>

370
00:14:35,959 --> 00:14:40,579
back a bit<font color="#E5E5E5"> how can we be sure this is</font>

371
00:14:38,899 --> 00:14:42,709
what's<font color="#E5E5E5"> going on well you can try this</font>

372
00:14:40,579 --> 00:14:45,469
yourself<font color="#E5E5E5"> you</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> send a bunch</font><font color="#CCCCCC"> of random</font>

373
00:14:42,709 --> 00:14:47,569
bytes<font color="#CCCCCC"> you did some calculation on say</font>

374
00:14:45,470 --> 00:14:50,300
the<font color="#CCCCCC"> Arduino Nano</font><font color="#E5E5E5"> with those random bytes</font>

375
00:14:47,570 --> 00:14:52,910
and<font color="#E5E5E5"> you take power traces and you say</font><font color="#CCCCCC"> ok</font>

376
00:14:50,300 --> 00:14:54,079
<font color="#E5E5E5">we take all the power traces which have</font>

377
00:14:52,910 --> 00:14:57,290
which<font color="#CCCCCC"> opposing data</font>

378
00:14:54,079 --> 00:14:58,399
whoever having weight of<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> know does</font>

379
00:14:57,290 --> 00:15:00,140
that look different<font color="#E5E5E5"> to where we're</font>

380
00:14:58,399 --> 00:15:03,320
<font color="#E5E5E5">posting data over having</font><font color="#CCCCCC"> wait a horn or</font>

381
00:15:00,140 --> 00:15:04,880
<font color="#CCCCCC">- and if you graph this then you can see</font>

382
00:15:03,320 --> 00:15:07,850
<font color="#CCCCCC">that yes it does</font><font color="#E5E5E5"> actually make a</font>

383
00:15:04,880 --> 00:15:10,070
<font color="#CCCCCC">difference</font><font color="#E5E5E5"> so we average the data with</font>

384
00:15:07,850 --> 00:15:11,570
Hamming weight<font color="#E5E5E5"> 0</font><font color="#CCCCCC"> have a</font><font color="#E5E5E5"> weight of 1 and</font>

385
00:15:10,070 --> 00:15:15,290
so<font color="#CCCCCC"> forth and</font><font color="#E5E5E5"> you can see you actually</font>

386
00:15:11,570 --> 00:15:17,480
<font color="#CCCCCC">get a different</font><font color="#E5E5E5"> levels here</font><font color="#CCCCCC"> ok it's</font><font color="#E5E5E5"> not</font>

387
00:15:15,290 --> 00:15:18,829
<font color="#CCCCCC">so easy to see with the eye because</font>

388
00:15:17,480 --> 00:15:21,260
there's lots of<font color="#E5E5E5"> other things going on in</font>

389
00:15:18,829 --> 00:15:25,399
processors but you can<font color="#E5E5E5"> definitely see</font>

390
00:15:21,260 --> 00:15:27,410
this for a software and to cut<font color="#CCCCCC"> the long</font>

391
00:15:25,399 --> 00:15:28,790
story short<font color="#E5E5E5"> what we're actually going to</font>

392
00:15:27,410 --> 00:15:31,850
do today is talk about how to steal

393
00:15:28,790 --> 00:15:33,319
encryption keys<font color="#E5E5E5"> this is the traditional</font>

394
00:15:31,850 --> 00:15:36,260
use of<font color="#CCCCCC"> citation analysis</font><font color="#E5E5E5"> and it's</font>

395
00:15:33,319 --> 00:15:37,939
because keys are awesome<font color="#E5E5E5"> so keys they</font>

396
00:15:36,260 --> 00:15:38,900
might be used to<font color="#E5E5E5"> protect firmware</font>

397
00:15:37,940 --> 00:15:41,600
they might be used<font color="#E5E5E5"> to protect</font>

398
00:15:38,900 --> 00:15:43,550
communication with a<font color="#CCCCCC"> back-end they're</font>

399
00:15:41,600 --> 00:15:45,320
used<font color="#E5E5E5"> for a lot</font><font color="#CCCCCC"> of useful</font><font color="#E5E5E5"> things and</font>

400
00:15:43,550 --> 00:15:47,959
where if you want to<font color="#E5E5E5"> compromise some</font>

401
00:15:45,320 --> 00:15:49,460
kind of<font color="#E5E5E5"> IOT device then often having</font>

402
00:15:47,960 --> 00:15:51,740
these keys is really important

403
00:15:49,460 --> 00:15:53,630
especially for<font color="#E5E5E5"> firmware</font><font color="#CCCCCC"> if you can get</font>

404
00:15:51,740 --> 00:15:55,640
these keys<font color="#CCCCCC"> use the</font><font color="#E5E5E5"> deep hips your</font>

405
00:15:53,630 --> 00:15:57,260
firmware<font color="#E5E5E5"> then you can look at the firm</font>

406
00:15:55,640 --> 00:15:59,480
where you can find vulnerabilities<font color="#E5E5E5"> and</font>

407
00:15:57,260 --> 00:16:01,700
you can exploit the software<font color="#E5E5E5"> but if you</font>

408
00:15:59,480 --> 00:16:03,110
have no<font color="#E5E5E5"> idea what's going on</font><font color="#CCCCCC"> yeah</font><font color="#E5E5E5"> sure a</font>

409
00:16:01,700 --> 00:16:05,810
slide channel<font color="#E5E5E5"> analysis will</font><font color="#CCCCCC"> give you</font>

410
00:16:03,110 --> 00:16:07,160
some insight<font color="#E5E5E5"> but it's not you're</font>

411
00:16:05,810 --> 00:16:10,729
probably<font color="#E5E5E5"> not going to have much luck</font><font color="#CCCCCC"> in</font>

412
00:16:07,160 --> 00:16:12,770
a reasonable<font color="#E5E5E5"> amount of time and</font><font color="#CCCCCC"> what are</font>

413
00:16:10,730 --> 00:16:15,140
we<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to do</font><font color="#E5E5E5"> we're going</font><font color="#CCCCCC"> to look at a</font>

414
00:16:12,770 --> 00:16:16,850
es<font color="#E5E5E5"> because it's actually secure it's</font>

415
00:16:15,140 --> 00:16:19,160
what's used in<font color="#E5E5E5"> the real world it's</font>

416
00:16:16,850 --> 00:16:21,350
pretty much unbroken<font color="#E5E5E5"> unless you have</font>

417
00:16:19,160 --> 00:16:23,719
side channels or forward injection<font color="#E5E5E5"> which</font>

418
00:16:21,350 --> 00:16:26,110
is why these<font color="#E5E5E5"> things are fun an Aes is</font>

419
00:16:23,720 --> 00:16:28,550
made up of<font color="#E5E5E5"> all</font><font color="#CCCCCC"> of these different rounds</font>

420
00:16:26,110 --> 00:16:31,970
it's complicated<font color="#E5E5E5"> how many rounds</font><font color="#CCCCCC"> the</font>

421
00:16:28,550 --> 00:16:33,920
rounds the<font color="#CCCCCC"> VAR I will say 9 maybe 10</font><font color="#E5E5E5"> but</font>

422
00:16:31,970 --> 00:16:36,440
actually today<font color="#E5E5E5"> we're only interested in</font>

423
00:16:33,920 --> 00:16:37,939
<font color="#E5E5E5">the very start here but the reason it's</font>

424
00:16:36,440 --> 00:16:40,460
interesting to know out of<font color="#E5E5E5"> all these</font>

425
00:16:37,940 --> 00:16:42,680
rounds<font color="#E5E5E5"> is this</font><font color="#CCCCCC"> pattern</font><font color="#E5E5E5"> that we saw</font>

426
00:16:40,460 --> 00:16:44,750
earlier with all<font color="#E5E5E5"> of these little spikes</font>

427
00:16:42,680 --> 00:16:48,020
which you got<font color="#CCCCCC"> from</font><font color="#E5E5E5"> our</font><font color="#CCCCCC"> oscilloscope and</font>

428
00:16:44,750 --> 00:16:50,180
our demo here actually<font color="#CCCCCC"> each</font><font color="#E5E5E5"> of these is</font>

429
00:16:48,020 --> 00:16:52,610
an<font color="#CCCCCC"> Aes round and the reason</font><font color="#E5E5E5"> I'm saying</font>

430
00:16:50,180 --> 00:16:54,800
it's<font color="#CCCCCC"> complicated is because</font><font color="#E5E5E5"> not all</font>

431
00:16:52,610 --> 00:16:57,170
rounds of AES are kind of<font color="#E5E5E5"> equal you have</font>

432
00:16:54,800 --> 00:16:58,910
<font color="#CCCCCC">kind of</font><font color="#E5E5E5"> an</font><font color="#CCCCCC"> initial and a 10-round if you</font>

433
00:16:57,170 --> 00:17:01,810
count the peaks here<font color="#CCCCCC"> and you count</font><font color="#E5E5E5"> the</font>

434
00:16:58,910 --> 00:17:04,609
dips<font color="#CCCCCC"> you get different numbers</font><font color="#E5E5E5"> 9 or 10</font>

435
00:17:01,810 --> 00:17:06,050
but the great<font color="#CCCCCC"> news is</font><font color="#E5E5E5"> we also don't</font>

436
00:17:04,609 --> 00:17:08,000
<font color="#CCCCCC">really care</font><font color="#E5E5E5"> about which round is where</font>

437
00:17:06,050 --> 00:17:09,770
other than<font color="#CCCCCC"> the first of</font><font color="#E5E5E5"> all it gives a</font>

438
00:17:08,000 --> 00:17:12,020
great<font color="#CCCCCC"> patter and this</font><font color="#E5E5E5"> is really easy</font><font color="#CCCCCC"> to</font>

439
00:17:09,770 --> 00:17:13,339
<font color="#E5E5E5">spot or</font><font color="#CCCCCC"> the oscilloscope</font><font color="#E5E5E5"> so if you're</font>

440
00:17:12,020 --> 00:17:15,379
trying<font color="#CCCCCC"> to</font><font color="#E5E5E5"> work out where is the AES</font>

441
00:17:13,339 --> 00:17:18,050
happening if it's<font color="#E5E5E5"> software a yes it's</font>

442
00:17:15,380 --> 00:17:20,060
where you see this pattern and we only

443
00:17:18,050 --> 00:17:21,980
care about the start so if we kind of

444
00:17:20,060 --> 00:17:26,240
<font color="#E5E5E5">zoom in to the start what happens at the</font>

445
00:17:21,980 --> 00:17:28,040
start of AES well for<font color="#CCCCCC"> byte 1 there's a</font>

446
00:17:26,240 --> 00:17:30,290
<font color="#E5E5E5">stage</font><font color="#CCCCCC"> coqui</font><font color="#E5E5E5"> Edition where you do an</font>

447
00:17:28,040 --> 00:17:32,540
exclusive<font color="#CCCCCC"> or of the first byte of the</font>

448
00:17:30,290 --> 00:17:35,000
incoming<font color="#E5E5E5"> data with the first byte of</font><font color="#CCCCCC"> the</font>

449
00:17:32,540 --> 00:17:36,100
encryption<font color="#E5E5E5"> key and then we go through</font><font color="#CCCCCC"> an</font>

450
00:17:35,000 --> 00:17:39,470
<font color="#CCCCCC">sbox</font>

451
00:17:36,100 --> 00:17:41,540
for the second byte we do key addition

452
00:17:39,470 --> 00:17:43,490
with<font color="#CCCCCC"> the second byte of the</font><font color="#E5E5E5"> key and then</font>

453
00:17:41,540 --> 00:17:46,340
we<font color="#E5E5E5"> go</font><font color="#CCCCCC"> through an</font><font color="#E5E5E5"> sbox</font><font color="#CCCCCC"> and the great news</font>

454
00:17:43,490 --> 00:17:49,640
is for<font color="#E5E5E5"> this stage</font><font color="#CCCCCC"> that means that we can</font>

455
00:17:46,340 --> 00:17:51,649
<font color="#E5E5E5">look at it bite by</font><font color="#CCCCCC"> bite</font><font color="#E5E5E5"> so we if we're</font>

456
00:17:49,640 --> 00:17:53,270
looking<font color="#E5E5E5"> at the first byte of</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> input</font>

457
00:17:51,650 --> 00:17:55,760
and remember we control the<font color="#CCCCCC"> input</font>

458
00:17:53,270 --> 00:17:57,440
because you can send<font color="#E5E5E5"> commands for</font>

459
00:17:55,760 --> 00:17:59,000
example if you can control<font color="#E5E5E5"> the</font>

460
00:17:57,440 --> 00:18:00,559
encryption or decryption on the device

461
00:17:59,000 --> 00:18:02,420
<font color="#E5E5E5">if it's firmware</font>

462
00:18:00,559 --> 00:18:04,520
then you can simply<font color="#E5E5E5"> set</font><font color="#CCCCCC"> the firmware</font><font color="#E5E5E5"> on</font>

463
00:18:02,420 --> 00:18:06,380
<font color="#CCCCCC">the device you</font><font color="#E5E5E5"> can reflash it to be</font>

464
00:18:04,520 --> 00:18:10,000
whatever firmware you want said that

465
00:18:06,380 --> 00:18:13,160
upgrade images<font color="#E5E5E5"> you control the input and</font>

466
00:18:10,000 --> 00:18:15,860
the key the<font color="#CCCCCC"> key by being used is the one</font>

467
00:18:13,160 --> 00:18:18,080
<font color="#CCCCCC">corresponding to the</font><font color="#E5E5E5"> input so the first</font>

468
00:18:15,860 --> 00:18:20,959
<font color="#E5E5E5">byte</font><font color="#CCCCCC"> of the input is</font><font color="#E5E5E5"> the first byte of</font>

469
00:18:18,080 --> 00:18:25,550
<font color="#CCCCCC">the key so we can do the step by step</font>

470
00:18:20,960 --> 00:18:28,670
<font color="#E5E5E5">and we know the input and we can just</font>

471
00:18:25,550 --> 00:18:31,129
<font color="#E5E5E5">guess the key because</font><font color="#CCCCCC"> ok xx guess the</font>

472
00:18:28,670 --> 00:18:32,210
entire<font color="#E5E5E5"> encryption key is crazy but</font>

473
00:18:31,130 --> 00:18:34,550
trying to guess one<font color="#E5E5E5"> byte of an</font>

474
00:18:32,210 --> 00:18:36,500
encryption key there are only 256

475
00:18:34,550 --> 00:18:37,220
<font color="#CCCCCC">different guesses</font><font color="#E5E5E5"> you can literally</font><font color="#CCCCCC"> just</font>

476
00:18:36,500 --> 00:18:39,950
try them<font color="#E5E5E5"> all</font>

477
00:18:37,220 --> 00:18:43,910
you know<font color="#CCCCCC"> fed to a 256 is not a big deal</font>

478
00:18:39,950 --> 00:18:45,679
<font color="#CCCCCC">and after the sbox</font><font color="#E5E5E5"> what we're going</font><font color="#CCCCCC"> to</font>

479
00:18:43,910 --> 00:18:48,380
do is we're going<font color="#CCCCCC"> to look</font><font color="#E5E5E5"> at the Hamming</font>

480
00:18:45,679 --> 00:18:48,920
weight of the output and this works

481
00:18:48,380 --> 00:18:51,050
<font color="#E5E5E5">beautifully</font>

482
00:18:48,920 --> 00:18:53,030
<font color="#E5E5E5">we control the</font><font color="#CCCCCC"> input</font><font color="#E5E5E5"> we're just gonna</font>

483
00:18:51,050 --> 00:18:56,178
send random input bytes<font color="#E5E5E5"> but it means</font>

484
00:18:53,030 --> 00:18:58,670
that<font color="#E5E5E5"> we can basically control</font><font color="#CCCCCC"> the groups</font>

485
00:18:56,179 --> 00:19:00,890
<font color="#E5E5E5">of the Hamming weights and what we're</font>

486
00:18:58,670 --> 00:19:03,860
going to do we're going<font color="#CCCCCC"> to say ok we're</font>

487
00:19:00,890 --> 00:19:05,540
<font color="#E5E5E5">going to guess all 256 possible bytes to</font>

488
00:19:03,860 --> 00:19:08,870
correspond to all of our<font color="#E5E5E5"> bound of inputs</font>

489
00:19:05,540 --> 00:19:10,520
<font color="#E5E5E5">and we're going to work out the Hamming</font>

490
00:19:08,870 --> 00:19:12,439
weight<font color="#CCCCCC"> so that should be</font><font color="#E5E5E5"> in the traces</font>

491
00:19:10,520 --> 00:19:15,170
<font color="#CCCCCC">and we're just</font><font color="#E5E5E5"> gonna see</font><font color="#CCCCCC"> wittmann's</font>

492
00:19:12,440 --> 00:19:17,690
which one fits the best<font color="#CCCCCC"> so just the</font>

493
00:19:15,170 --> 00:19:20,480
<font color="#CCCCCC">masterplan is</font><font color="#E5E5E5"> just for every key guess</font>

494
00:19:17,690 --> 00:19:23,480
so all 256 key guesses<font color="#E5E5E5"> byte by byte</font>

495
00:19:20,480 --> 00:19:25,070
remember for every<font color="#CCCCCC"> input we calculate</font>

496
00:19:23,480 --> 00:19:26,780
what<font color="#E5E5E5"> the Hamming weight should be</font><font color="#CCCCCC"> we</font>

497
00:19:25,070 --> 00:19:28,879
compare it with the actual leakage and

498
00:19:26,780 --> 00:19:31,610
at the end we<font color="#CCCCCC"> just pick whichever group</font>

499
00:19:28,880 --> 00:19:33,350
fitted the best<font color="#E5E5E5"> and this</font><font color="#CCCCCC"> is all getting</font>

500
00:19:31,610 --> 00:19:36,409
bully and it's like<font color="#E5E5E5"> I pretty</font><font color="#CCCCCC"> sure I</font>

501
00:19:33,350 --> 00:19:37,820
<font color="#E5E5E5">promised there would not be theory</font><font color="#CCCCCC"> this</font>

502
00:19:36,410 --> 00:19:42,590
<font color="#CCCCCC">is something called correlation power</font>

503
00:19:37,820 --> 00:19:44,540
<font color="#CCCCCC">analysis and I could go on</font><font color="#E5E5E5"> and try and</font>

504
00:19:42,590 --> 00:19:46,790
<font color="#CCCCCC">explain this with</font><font color="#E5E5E5"> actual math and</font>

505
00:19:44,540 --> 00:19:48,830
actually so people might understand it

506
00:19:46,790 --> 00:19:50,870
but the thing is what<font color="#E5E5E5"> are you gonna do</font>

507
00:19:48,830 --> 00:19:52,460
next<font color="#CCCCCC"> if you're trying to</font><font color="#E5E5E5"> do side channel</font>

508
00:19:50,870 --> 00:19:54,260
analysis<font color="#CCCCCC"> are you</font><font color="#E5E5E5"> gonna go and</font><font color="#CCCCCC"> implement</font>

509
00:19:52,460 --> 00:19:56,480
this algorithm<font color="#E5E5E5"> you're gonna try</font><font color="#CCCCCC"> and</font>

510
00:19:54,260 --> 00:19:57,230
write<font color="#E5E5E5"> this I mean I</font><font color="#CCCCCC"> don't know about you</font>

511
00:19:56,480 --> 00:19:59,179
but<font color="#E5E5E5"> I'm lazy</font>

512
00:19:57,230 --> 00:20:00,980
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> both lazy</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> are not gonna do this</font>

513
00:19:59,179 --> 00:20:02,960
<font color="#CCCCCC">we're</font><font color="#E5E5E5"> going to go to Google we're going</font>

514
00:20:00,980 --> 00:20:04,070
to type side channel analysis<font color="#E5E5E5"> and we're</font>

515
00:20:02,960 --> 00:20:05,570
<font color="#E5E5E5">gonna use some software love someone</font>

516
00:20:04,070 --> 00:20:07,790
else world<font color="#E5E5E5"> and</font>

517
00:20:05,570 --> 00:20:09,770
exactly what we did thanks so much the

518
00:20:07,790 --> 00:20:12,320
case we're using open source software

519
00:20:09,770 --> 00:20:14,870
<font color="#CCCCCC">coche or SCA basically because it's fast</font>

520
00:20:12,320 --> 00:20:16,189
<font color="#CCCCCC">it does CPA it does all</font><font color="#E5E5E5"> kinds of fancy</font>

521
00:20:14,870 --> 00:20:18,949
<font color="#E5E5E5">your attacks that we don't care about</font>

522
00:20:16,190 --> 00:20:21,590
<font color="#E5E5E5">and it or someone's</font><font color="#CCCCCC"> fast</font><font color="#E5E5E5"> on that cheap</font>

523
00:20:18,950 --> 00:20:24,800
network<font color="#E5E5E5"> that you are used because you're</font>

524
00:20:21,590 --> 00:20:26,510
connecting it<font color="#CCCCCC"> to this flaky</font><font color="#E5E5E5"> hardware but</font>

525
00:20:24,800 --> 00:20:27,980
there's one more ingredient here<font color="#E5E5E5"> so we</font>

526
00:20:26,510 --> 00:20:29,360
have this open<font color="#E5E5E5"> source software</font>

527
00:20:27,980 --> 00:20:33,380
you know the laptop<font color="#CCCCCC"> you have lying</font>

528
00:20:29,360 --> 00:20:38,560
<font color="#CCCCCC">around your Arduino Nano</font><font color="#E5E5E5"> maybe some</font>

529
00:20:33,380 --> 00:20:42,320
resistors for<font color="#CCCCCC"> the shunt resistors and</font>

530
00:20:38,560 --> 00:20:44,510
<font color="#E5E5E5">and it all sounds</font><font color="#CCCCCC"> pretty great so you</font>

531
00:20:42,320 --> 00:20:45,139
send these random inputs to the

532
00:20:44,510 --> 00:20:47,570
processor

533
00:20:45,140 --> 00:20:49,460
you take<font color="#E5E5E5"> these power measurements and</font>

534
00:20:47,570 --> 00:20:51,260
you take these pairs<font color="#E5E5E5"> of the input and</font>

535
00:20:49,460 --> 00:20:52,940
<font color="#E5E5E5">the corresponding power measurement and</font>

536
00:20:51,260 --> 00:20:55,190
instead<font color="#CCCCCC"> of</font><font color="#E5E5E5"> thinking</font><font color="#CCCCCC"> about all</font><font color="#E5E5E5"> this best</font>

537
00:20:52,940 --> 00:20:57,890
fit<font color="#E5E5E5"> first rounds of AES you just say</font>

538
00:20:55,190 --> 00:20:59,930
<font color="#E5E5E5">jail SCA here is some data keeping the</font>

539
00:20:57,890 --> 00:21:02,710
keys and it just gives<font color="#E5E5E5"> you the keys</font><font color="#CCCCCC"> as</font>

540
00:20:59,930 --> 00:21:06,610
you'll<font color="#CCCCCC"> see a</font><font color="#E5E5E5"> bit it's really that simple</font>

541
00:21:02,710 --> 00:21:11,810
except<font color="#E5E5E5"> this you need them oscilloscope</font>

542
00:21:06,610 --> 00:21:15,020
so you can see again here I<font color="#E5E5E5"> hope please</font>

543
00:21:11,810 --> 00:21:16,879
<font color="#E5E5E5">this is the best pattern</font><font color="#CCCCCC"> again</font><font color="#E5E5E5"> this is</font>

544
00:21:15,020 --> 00:21:21,260
software<font color="#E5E5E5"> AES you will see it everywhere</font>

545
00:21:16,880 --> 00:21:22,970
if<font color="#E5E5E5"> you start looking but you</font><font color="#CCCCCC"> need an</font>

546
00:21:21,260 --> 00:21:24,890
oscilloscope and how<font color="#E5E5E5"> expensive of</font>

547
00:21:22,970 --> 00:21:26,720
oscilloscopes well<font color="#E5E5E5"> you might have access</font>

548
00:21:24,890 --> 00:21:29,030
<font color="#CCCCCC">to one</font><font color="#E5E5E5"> but if we start</font><font color="#CCCCCC"> thinking</font><font color="#E5E5E5"> about</font>

549
00:21:26,720 --> 00:21:31,670
<font color="#E5E5E5">kind of</font><font color="#CCCCCC"> board attackers who</font><font color="#E5E5E5"> were sitting</font>

550
00:21:29,030 --> 00:21:35,030
at<font color="#E5E5E5"> home then are they gonna have an</font>

551
00:21:31,670 --> 00:21:36,350
oscilloscope lying around maybe<font color="#E5E5E5"> not I</font>

552
00:21:35,030 --> 00:21:38,060
mean a good question is how many<font color="#CCCCCC"> of you</font>

553
00:21:36,350 --> 00:21:40,760
have an oscilloscope at home maybe

554
00:21:38,060 --> 00:21:42,879
<font color="#E5E5E5">achieve my goal how many of you have</font>

555
00:21:40,760 --> 00:21:45,379
access<font color="#CCCCCC"> to an oscilloscope of some kind</font>

556
00:21:42,880 --> 00:21:48,230
<font color="#CCCCCC">okay so you know that's</font><font color="#E5E5E5"> a reasonable</font>

557
00:21:45,380 --> 00:21:50,510
amount of the room<font color="#E5E5E5"> but not everyone</font><font color="#CCCCCC"> the</font>

558
00:21:48,230 --> 00:21:52,520
thing is if<font color="#CCCCCC"> you start asking slideshow</font>

559
00:21:50,510 --> 00:21:53,870
<font color="#CCCCCC">no experts you know</font><font color="#E5E5E5"> what kind of</font>

560
00:21:52,520 --> 00:21:54,889
oscilloscope<font color="#E5E5E5"> you should get then they</font>

561
00:21:53,870 --> 00:21:57,879
start saying<font color="#CCCCCC"> oh you</font><font color="#E5E5E5"> should play the</font>

562
00:21:54,890 --> 00:22:00,530
<font color="#CCCCCC">Lacroix we have in the lab</font><font color="#E5E5E5"> no and</font>

563
00:21:57,880 --> 00:22:02,750
realistically even these<font color="#CCCCCC"> vital scopes</font>

564
00:22:00,530 --> 00:22:05,540
which are lovely and<font color="#E5E5E5"> cheap at work</font><font color="#CCCCCC"> rate</font>

565
00:22:02,750 --> 00:22:07,370
<font color="#E5E5E5">there's still several hundred euros it's</font>

566
00:22:05,540 --> 00:22:08,659
a lot of<font color="#CCCCCC"> money the great news is other</font>

567
00:22:07,370 --> 00:22:10,489
people before<font color="#CCCCCC"> us have</font><font color="#E5E5E5"> already</font>

568
00:22:08,660 --> 00:22:13,220
encountered this problem<font color="#CCCCCC"> and</font><font color="#E5E5E5"> tried to</font>

569
00:22:10,490 --> 00:22:14,540
<font color="#E5E5E5">fix it so</font><font color="#CCCCCC"> Colin L Flynn developed the</font>

570
00:22:13,220 --> 00:22:18,590
chip<font color="#CCCCCC"> westbrook which is wonderful</font>

571
00:22:14,540 --> 00:22:19,428
hardware<font color="#E5E5E5"> and you have our X colleague</font>

572
00:22:18,590 --> 00:22:22,279
<font color="#E5E5E5">Rafa</font>

573
00:22:19,429 --> 00:22:24,200
who<font color="#CCCCCC"> does show</font><font color="#E5E5E5"> that you can do this with</font>

574
00:22:22,279 --> 00:22:26,359
a cheap USB<font color="#E5E5E5"> oscilloscope</font><font color="#CCCCCC"> like the one</font>

575
00:22:24,200 --> 00:22:27,679
<font color="#E5E5E5">pictured here</font><font color="#CCCCCC"> and that works</font><font color="#E5E5E5"> great but</font>

576
00:22:26,359 --> 00:22:29,478
it's<font color="#E5E5E5"> still quite a bit</font><font color="#CCCCCC"> of money if</font>

577
00:22:27,679 --> 00:22:32,739
you're<font color="#E5E5E5"> just bored</font><font color="#CCCCCC"> and you just kind of</font>

578
00:22:29,479 --> 00:22:36,739
want to randomly<font color="#E5E5E5"> try the sound and</font>

579
00:22:32,739 --> 00:22:38,599
finally this is<font color="#E5E5E5"> the future</font><font color="#CCCCCC"> or maybe it's</font>

580
00:22:36,739 --> 00:22:40,700
the chip<font color="#CCCCCC"> Whisperer Nano</font><font color="#E5E5E5"> it's a cheaper</font>

581
00:22:38,599 --> 00:22:43,009
<font color="#CCCCCC">version of the chip</font><font color="#E5E5E5"> Whisperer it's nice</font>

582
00:22:40,700 --> 00:22:44,330
because it<font color="#CCCCCC"> has a target</font><font color="#E5E5E5"> built in and on</font>

583
00:22:43,009 --> 00:22:47,239
<font color="#E5E5E5">the right side you can</font><font color="#CCCCCC"> see</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> even has a</font>

584
00:22:44,330 --> 00:22:48,949
shunt resistor<font color="#E5E5E5"> built in but it's</font><font color="#CCCCCC"> $50</font>

585
00:22:47,239 --> 00:22:51,320
still and it's still not actually

586
00:22:48,950 --> 00:22:56,509
<font color="#E5E5E5">available and as Albert would say that</font>

587
00:22:51,320 --> 00:22:58,639
is a lot<font color="#E5E5E5"> of beer so we can solve this</font>

588
00:22:56,509 --> 00:22:59,989
very easily<font color="#E5E5E5"> this can't be this expensive</font>

589
00:22:58,639 --> 00:23:01,849
<font color="#CCCCCC">I mean</font><font color="#E5E5E5"> if we look back at</font><font color="#CCCCCC"> the chip</font>

590
00:22:59,989 --> 00:23:03,679
<font color="#CCCCCC">whisper Nano it has all these components</font>

591
00:23:01,849 --> 00:23:06,379
<font color="#E5E5E5">on it</font><font color="#CCCCCC"> well there</font><font color="#E5E5E5"> were these these things</font>

592
00:23:03,679 --> 00:23:08,509
on<font color="#E5E5E5"> this PCB so let's just build a scope</font>

593
00:23:06,379 --> 00:23:11,478
of our own and it turns out we don't

594
00:23:08,509 --> 00:23:13,849
<font color="#CCCCCC">know anything</font><font color="#E5E5E5"> about</font><font color="#CCCCCC"> electronics and</font><font color="#E5E5E5"> also</font>

595
00:23:11,479 --> 00:23:15,169
we don't<font color="#E5E5E5"> know how to solder things we</font>

596
00:23:13,849 --> 00:23:17,779
can kind of<font color="#CCCCCC"> Porsche together the power</font>

597
00:23:15,169 --> 00:23:19,700
<font color="#E5E5E5">cuts so it quickly turned into of course</font>

598
00:23:17,779 --> 00:23:21,729
that's just what's<font color="#E5E5E5"> the minimum effort</font>

599
00:23:19,700 --> 00:23:24,109
thing you can do to hack things<font color="#E5E5E5"> together</font>

600
00:23:21,729 --> 00:23:25,519
<font color="#E5E5E5">and so so what do you need from an</font>

601
00:23:24,109 --> 00:23:28,009
oscilloscope to<font color="#E5E5E5"> do this slide channel</font>

602
00:23:25,519 --> 00:23:30,409
analysis<font color="#E5E5E5"> well you need some way</font><font color="#CCCCCC"> of</font>

603
00:23:28,009 --> 00:23:32,539
trigger<font color="#E5E5E5"> so to tell the oscilloscope when</font>

604
00:23:30,409 --> 00:23:35,570
to<font color="#E5E5E5"> actually start measuring but that can</font>

605
00:23:32,539 --> 00:23:36,859
just be<font color="#E5E5E5"> some kind of random GPIO pin you</font>

606
00:23:35,570 --> 00:23:38,918
need some way to actually<font color="#E5E5E5"> collect the</font>

607
00:23:36,859 --> 00:23:41,539
measurements it's just an<font color="#CCCCCC"> analog digital</font>

608
00:23:38,919 --> 00:23:44,029
converter<font color="#E5E5E5"> and you need some RAM to put</font>

609
00:23:41,539 --> 00:23:45,408
measurements in and it turns out you<font color="#E5E5E5"> can</font>

610
00:23:44,029 --> 00:23:47,299
pick pretty much any cheap

611
00:23:45,409 --> 00:23:49,419
microcontroller<font color="#E5E5E5"> on the market</font><font color="#CCCCCC"> and it</font>

612
00:23:47,299 --> 00:23:52,460
will have all three of<font color="#E5E5E5"> these things</font>

613
00:23:49,419 --> 00:23:54,710
<font color="#E5E5E5">because we make poor life choices what</font>

614
00:23:52,460 --> 00:23:57,769
we<font color="#E5E5E5"> went for is the Atmel</font><font color="#CCCCCC"> X mega</font><font color="#E5E5E5"> it's the</font>

615
00:23:54,710 --> 00:24:00,889
successor to<font color="#E5E5E5"> the mega chip on the</font>

616
00:23:57,769 --> 00:24:04,009
<font color="#CCCCCC">arduino nano</font><font color="#E5E5E5"> it's great it has USB 2 it</font>

617
00:24:00,889 --> 00:24:06,139
has a 12 bit ADC it has<font color="#E5E5E5"> 2 mega samples a</font>

618
00:24:04,009 --> 00:24:08,719
second which to us seems like that<font color="#CCCCCC"> seems</font>

619
00:24:06,139 --> 00:24:10,549
like<font color="#CCCCCC"> a lot</font><font color="#E5E5E5"> until you go</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> Andi</font>

620
00:24:08,719 --> 00:24:12,679
<font color="#CCCCCC">Express and</font><font color="#E5E5E5"> you start looking</font><font color="#CCCCCC"> for boards</font>

621
00:24:10,549 --> 00:24:15,499
based on this and it<font color="#E5E5E5"> turns out the chip</font>

622
00:24:12,679 --> 00:24:18,109
<font color="#CCCCCC">may be $2 50 but you know</font><font color="#E5E5E5"> chips with the</font>

623
00:24:15,499 --> 00:24:20,330
<font color="#E5E5E5">board bought</font><font color="#CCCCCC"> over the chip</font><font color="#E5E5E5"> on it and</font>

624
00:24:18,109 --> 00:24:23,299
like<font color="#CCCCCC"> 50 dollars</font><font color="#E5E5E5"> because apparently no</font>

625
00:24:20,330 --> 00:24:26,658
one uses this chip so of course the<font color="#CCCCCC"> next</font>

626
00:24:23,299 --> 00:24:29,749
<font color="#CCCCCC">step is not a PCP</font><font color="#E5E5E5"> design and actually</font>

627
00:24:26,659 --> 00:24:31,129
develop all<font color="#E5E5E5"> on board and we did we call</font>

628
00:24:29,749 --> 00:24:33,260
it the horoscope it's not going to be

629
00:24:31,129 --> 00:24:35,300
the focus<font color="#CCCCCC"> today but it's</font><font color="#E5E5E5"> just a</font>

630
00:24:33,260 --> 00:24:37,520
<font color="#E5E5E5">when the breakout board</font><font color="#CCCCCC"> basically this</font>

631
00:24:35,300 --> 00:24:39,350
is what happens<font color="#E5E5E5"> when you need a micro</font>

632
00:24:37,520 --> 00:24:41,870
random<font color="#E5E5E5"> microcontroller you pick around a</font>

633
00:24:39,350 --> 00:24:43,669
microcontroller and it turns out<font color="#E5E5E5"> oh you</font>

634
00:24:41,870 --> 00:24:45,229
know<font color="#E5E5E5"> oh these cheap</font><font color="#CCCCCC"> breakout boards are</font>

635
00:24:43,670 --> 00:24:46,310
available<font color="#CCCCCC"> for</font><font color="#E5E5E5"> everything except the</font>

636
00:24:45,230 --> 00:24:49,790
incredibly poor choice of

637
00:24:46,310 --> 00:24:51,560
<font color="#CCCCCC">microcontroller that we made and now I'm</font>

638
00:24:49,790 --> 00:24:54,220
gonna hopefully hand over to Albert who

639
00:24:51,560 --> 00:24:57,260
will<font color="#E5E5E5"> talk about my terrible mistakes</font>

640
00:24:54,220 --> 00:24:59,780
okay so<font color="#CCCCCC"> Alisa just gave us a bit of an</font>

641
00:24:57,260 --> 00:25:02,240
introduction on<font color="#E5E5E5"> site on side channel</font>

642
00:24:59,780 --> 00:25:04,550
attacks<font color="#E5E5E5"> and she also introduced</font>

643
00:25:02,240 --> 00:25:07,370
basically the hardware that<font color="#E5E5E5"> we</font><font color="#CCCCCC"> designed</font>

644
00:25:04,550 --> 00:25:10,399
and built so when we sent this off to

645
00:25:07,370 --> 00:25:12,830
you know<font color="#CCCCCC"> get the board manufactured so</font>

646
00:25:10,400 --> 00:25:16,070
our prototype came back and we had<font color="#CCCCCC"> our</font>

647
00:25:12,830 --> 00:25:19,669
<font color="#CCCCCC">first problem so it turns</font><font color="#E5E5E5"> out we</font>

648
00:25:16,070 --> 00:25:22,550
actually you<font color="#CCCCCC"> know mixed up the data</font>

649
00:25:19,670 --> 00:25:24,710
lines so we we<font color="#CCCCCC"> switched them</font><font color="#E5E5E5"> around so</font>

650
00:25:22,550 --> 00:25:29,149
<font color="#E5E5E5">it's</font><font color="#CCCCCC"> solve that problem we have a USB</font>

651
00:25:24,710 --> 00:25:30,380
<font color="#E5E5E5">cross link cable right so but we did</font>

652
00:25:29,150 --> 00:25:31,970
this basically<font color="#E5E5E5"> so we could test the</font>

653
00:25:30,380 --> 00:25:35,600
board<font color="#E5E5E5"> and then find out if there are any</font>

654
00:25:31,970 --> 00:25:37,460
<font color="#CCCCCC">other problems</font><font color="#E5E5E5"> okay so after we built</font>

655
00:25:35,600 --> 00:25:40,280
the cross link cable we can actually

656
00:25:37,460 --> 00:25:42,470
<font color="#CCCCCC">tackle some real problems so it turns</font>

657
00:25:40,280 --> 00:25:44,690
out one of<font color="#E5E5E5"> our biggest problems is that</font>

658
00:25:42,470 --> 00:25:48,590
we're<font color="#E5E5E5"> actually planning</font><font color="#CCCCCC"> to sample well</font>

659
00:25:44,690 --> 00:25:52,430
below the Nyquist frequency so the<font color="#E5E5E5"> Nano</font>

660
00:25:48,590 --> 00:25:55,550
runs at 16 megahertz<font color="#E5E5E5"> and our ADC</font><font color="#CCCCCC"> samples</font>

661
00:25:52,430 --> 00:25:57,650
at two megahertz<font color="#E5E5E5"> so clearly this is</font><font color="#CCCCCC"> not</font>

662
00:25:55,550 --> 00:26:01,280
<font color="#E5E5E5">enough</font><font color="#CCCCCC"> you're not going to get a sample</font>

663
00:25:57,650 --> 00:26:02,840
<font color="#CCCCCC">every nano clock cycle</font><font color="#E5E5E5"> and in fact if</font>

664
00:26:01,280 --> 00:26:07,850
you<font color="#E5E5E5"> listen to the experts we're actually</font>

665
00:26:02,840 --> 00:26:10,699
sampling<font color="#E5E5E5"> 32 times too slow</font><font color="#CCCCCC"> so how we're</font>

666
00:26:07,850 --> 00:26:14,540
going to<font color="#E5E5E5"> solve this well maybe we can</font>

667
00:26:10,700 --> 00:26:16,100
<font color="#CCCCCC">just</font><font color="#E5E5E5"> take more measurements</font><font color="#CCCCCC"> and we can</font>

668
00:26:14,540 --> 00:26:17,840
also have<font color="#E5E5E5"> a look at the data sheet so</font>

669
00:26:16,100 --> 00:26:19,909
<font color="#E5E5E5">you know this is an apart from the</font>

670
00:26:17,840 --> 00:26:22,280
<font color="#CCCCCC">datasheet</font><font color="#E5E5E5"> it says it has 12 bit</font>

671
00:26:19,910 --> 00:26:25,850
resolution<font color="#CCCCCC"> and it does up</font><font color="#E5E5E5"> to two million</font>

672
00:26:22,280 --> 00:26:27,680
samples<font color="#E5E5E5"> per second so it turns out that</font>

673
00:26:25,850 --> 00:26:30,409
<font color="#CCCCCC">there's</font><font color="#E5E5E5"> two million samples per second</font>

674
00:26:27,680 --> 00:26:32,870
is<font color="#CCCCCC"> just a suggestion</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> can</font><font color="#E5E5E5"> also try</font>

675
00:26:30,410 --> 00:26:37,940
sampling at<font color="#E5E5E5"> four mega samples</font><font color="#CCCCCC"> per second</font>

676
00:26:32,870 --> 00:26:40,570
or perhaps<font color="#E5E5E5"> eight which didn't work okay</font>

677
00:26:37,940 --> 00:26:42,680
<font color="#CCCCCC">so we're back to</font><font color="#E5E5E5"> more traces</font>

678
00:26:40,570 --> 00:26:44,570
additionally we don't have an<font color="#CCCCCC"> analog</font>

679
00:26:42,680 --> 00:26:46,370
<font color="#CCCCCC">front-end so typically</font><font color="#E5E5E5"> an oscilloscope</font>

680
00:26:44,570 --> 00:26:47,030
will actually have a piece of<font color="#E5E5E5"> analog</font>

681
00:26:46,370 --> 00:26:49,520
electronics

682
00:26:47,030 --> 00:26:54,350
<font color="#CCCCCC">basically an amplifier</font><font color="#E5E5E5"> in front of its</font>

683
00:26:49,520 --> 00:26:56,629
ADC so that sounds like<font color="#CCCCCC"> work so we're</font>

684
00:26:54,350 --> 00:26:58,370
not going<font color="#CCCCCC"> to do it and we're probably</font>

685
00:26:56,630 --> 00:27:01,610
going<font color="#E5E5E5"> to compensate by taking more</font>

686
00:26:58,370 --> 00:27:03,408
<font color="#CCCCCC">traces additionally there's</font><font color="#E5E5E5"> this 50</font>

687
00:27:01,610 --> 00:27:05,799
Hertz signal which sometimes comes

688
00:27:03,409 --> 00:27:08,539
through which shows up as a DC offset

689
00:27:05,799 --> 00:27:11,030
<font color="#CCCCCC">and we have all these resolution</font>

690
00:27:08,539 --> 00:27:12,379
problems also<font color="#CCCCCC"> the</font><font color="#E5E5E5"> usb being directly on</font>

691
00:27:11,030 --> 00:27:15,678
the chip<font color="#E5E5E5"> actually gives us more noise</font>

692
00:27:12,380 --> 00:27:20,240
<font color="#CCCCCC">and basically we're going</font><font color="#E5E5E5"> to solve that</font>

693
00:27:15,679 --> 00:27:22,250
by taking<font color="#CCCCCC"> more</font><font color="#E5E5E5"> traces so I'm pretty sure</font>

694
00:27:20,240 --> 00:27:26,390
you noticed a<font color="#CCCCCC"> pattern there I said take</font>

695
00:27:22,250 --> 00:27:28,159
more traces so when we were prototyping

696
00:27:26,390 --> 00:27:31,850
the software we<font color="#CCCCCC"> accidentally</font>

697
00:27:28,159 --> 00:27:35,080
misconfigured the ADC and<font color="#CCCCCC"> I you know</font><font color="#E5E5E5"> and</font>

698
00:27:31,850 --> 00:27:37,730
this<font color="#CCCCCC"> is a trace we were</font><font color="#E5E5E5"> we recovered and</font>

699
00:27:35,080 --> 00:27:40,549
<font color="#E5E5E5">I was actually already pretty happy with</font>

700
00:27:37,730 --> 00:27:42,110
this<font color="#E5E5E5"> because you know if I take a</font>

701
00:27:40,549 --> 00:27:44,629
hundred<font color="#E5E5E5"> of these measurements and</font>

702
00:27:42,110 --> 00:27:48,559
average them<font color="#E5E5E5"> what we actually see is</font>

703
00:27:44,630 --> 00:27:51,760
these IES rounds coming<font color="#E5E5E5"> out well you can</font>

704
00:27:48,559 --> 00:27:55,158
<font color="#CCCCCC">also do is not miss configure the ADC</font>

705
00:27:51,760 --> 00:27:57,289
<font color="#CCCCCC">alright so we now have an oscilloscope</font>

706
00:27:55,159 --> 00:27:58,929
<font color="#E5E5E5">so let's actually try you know try to</font>

707
00:27:57,289 --> 00:28:02,900
actually do some<font color="#CCCCCC"> acquisitions with this</font>

708
00:27:58,929 --> 00:28:05,240
so as a list already explained but just

709
00:28:02,900 --> 00:28:06,590
to recap<font color="#E5E5E5"> we have a PC which controls</font>

710
00:28:05,240 --> 00:28:09,350
both the<font color="#E5E5E5"> oscilloscope and the targets</font>

711
00:28:06,590 --> 00:28:12,620
and<font color="#E5E5E5"> the PC sends messages to the targets</font>

712
00:28:09,350 --> 00:28:14,928
<font color="#E5E5E5">and basically the oscilloscope measures</font>

713
00:28:12,620 --> 00:28:18,379
the power unit<font color="#E5E5E5"> power usage</font><font color="#CCCCCC"> and there's</font>

714
00:28:14,929 --> 00:28:22,039
also this thing<font color="#CCCCCC"> called the trigger yeah</font>

715
00:28:18,380 --> 00:28:24,409
<font color="#E5E5E5">so our</font><font color="#CCCCCC"> real-world setup</font><font color="#E5E5E5"> actually</font><font color="#CCCCCC"> looks</font>

716
00:28:22,039 --> 00:28:28,039
something like this we have<font color="#CCCCCC"> arduino nano</font>

717
00:28:24,409 --> 00:28:31,280
<font color="#CCCCCC">up here which runs our a yes and we have</font>

718
00:28:28,039 --> 00:28:36,080
<font color="#E5E5E5">the horoscope down here and we have</font><font color="#CCCCCC"> some</font>

719
00:28:31,280 --> 00:28:37,610
resistors<font color="#E5E5E5"> over here all right so this</font>

720
00:28:36,080 --> 00:28:39,020
triggering thing we mentioned it but

721
00:28:37,610 --> 00:28:40,820
<font color="#CCCCCC">what does it</font><font color="#E5E5E5"> mean</font><font color="#CCCCCC"> so basically the</font>

722
00:28:39,020 --> 00:28:44,030
<font color="#CCCCCC">question is when</font><font color="#E5E5E5"> does the oscilloscope</font>

723
00:28:40,820 --> 00:28:47,090
<font color="#CCCCCC">know when to measure we don't actually</font>

724
00:28:44,030 --> 00:28:49,220
<font color="#E5E5E5">have enough SRAM to actually basically</font>

725
00:28:47,090 --> 00:28:51,770
to keep<font color="#E5E5E5"> it running all the time so we</font>

726
00:28:49,220 --> 00:28:54,190
need some<font color="#CCCCCC"> way to synchronize</font><font color="#E5E5E5"> basically</font>

727
00:28:51,770 --> 00:28:57,289
this<font color="#CCCCCC"> arduino nano with our oscilloscope</font>

728
00:28:54,190 --> 00:28:59,299
<font color="#E5E5E5">so then the question</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> basically what</font>

729
00:28:57,289 --> 00:29:00,500
is<font color="#CCCCCC"> the</font><font color="#E5E5E5"> last thing we control before this</font>

730
00:28:59,299 --> 00:29:02,120
AES happens

731
00:29:00,500 --> 00:29:06,130
and that's actually us<font color="#E5E5E5"> sending the</font>

732
00:29:02,120 --> 00:29:09,260
inputs<font color="#E5E5E5"> so the triggering plan for the</font>

733
00:29:06,130 --> 00:29:11,540
horoscope<font color="#E5E5E5"> is something like this first</font>

734
00:29:09,260 --> 00:29:14,480
the computer sends the<font color="#E5E5E5"> PC sends a</font>

735
00:29:11,540 --> 00:29:16,430
<font color="#CCCCCC">command to the</font><font color="#E5E5E5"> scope to</font><font color="#CCCCCC"> arm to get</font><font color="#E5E5E5"> ready</font>

736
00:29:14,480 --> 00:29:18,920
<font color="#E5E5E5">for this measurements and then a GPIO</font>

737
00:29:16,430 --> 00:29:21,380
<font color="#E5E5E5">input pin hopefully turns high and</font>

738
00:29:18,920 --> 00:29:24,920
basically<font color="#E5E5E5"> directly after that the</font>

739
00:29:21,380 --> 00:29:27,500
measurements will<font color="#E5E5E5"> start so what we're</font>

740
00:29:24,920 --> 00:29:30,730
going to do is we connect the scope GPIO

741
00:29:27,500 --> 00:29:33,230
<font color="#E5E5E5">input pin to the receive pin on the</font><font color="#CCCCCC"> Nano</font>

742
00:29:30,730 --> 00:29:34,700
so basically when the target when the

743
00:29:33,230 --> 00:29:38,030
<font color="#CCCCCC">Nano receives a command we can</font><font color="#E5E5E5"> actually</font>

744
00:29:34,700 --> 00:29:39,500
trigger<font color="#CCCCCC"> and if we were</font><font color="#E5E5E5"> to build a Python</font>

745
00:29:38,030 --> 00:29:41,930
script<font color="#CCCCCC"> to</font><font color="#E5E5E5"> actually tie that all together</font>

746
00:29:39,500 --> 00:29:42,590
<font color="#CCCCCC">a loop iteration</font><font color="#E5E5E5"> would look something</font>

747
00:29:41,930 --> 00:29:44,690
<font color="#CCCCCC">like this</font>

748
00:29:42,590 --> 00:29:48,409
we would start our loop<font color="#E5E5E5"> impt iteration</font>

749
00:29:44,690 --> 00:29:49,670
we would send most of the input after<font color="#CCCCCC"> we</font>

750
00:29:48,410 --> 00:29:52,670
send<font color="#E5E5E5"> most of the inputs we tell the</font>

751
00:29:49,670 --> 00:29:54,380
<font color="#CCCCCC">oscilloscope to</font><font color="#E5E5E5"> get ready and then when</font>

752
00:29:52,670 --> 00:29:57,050
it's ready<font color="#CCCCCC"> we send the</font><font color="#E5E5E5"> last byte of</font><font color="#CCCCCC"> the</font>

753
00:29:54,380 --> 00:30:00,860
input and this will do two<font color="#E5E5E5"> things</font>

754
00:29:57,050 --> 00:30:02,629
<font color="#E5E5E5">simultaneously so first of all the scope</font>

755
00:30:00,860 --> 00:30:05,540
will see this bytes coming around on the

756
00:30:02,630 --> 00:30:08,420
serial line<font color="#E5E5E5"> and it will start measuring</font>

757
00:30:05,540 --> 00:30:10,790
<font color="#E5E5E5">and additionally because the targets</font>

758
00:30:08,420 --> 00:30:14,660
<font color="#CCCCCC">sees this</font><font color="#E5E5E5"> last bytes arriving it will</font>

759
00:30:10,790 --> 00:30:16,909
<font color="#CCCCCC">actually perform the AES</font><font color="#E5E5E5"> okay so after</font>

760
00:30:14,660 --> 00:30:19,760
that we basically<font color="#E5E5E5"> save all our data we</font>

761
00:30:16,910 --> 00:30:22,490
<font color="#CCCCCC">save to the</font><font color="#E5E5E5"> power trace</font><font color="#CCCCCC"> and we start</font>

762
00:30:19,760 --> 00:30:26,510
<font color="#E5E5E5">again and we you know acquire</font><font color="#CCCCCC"> a loss of</font>

763
00:30:22,490 --> 00:30:28,640
inputs so to<font color="#CCCCCC"> collect these</font><font color="#E5E5E5"> traces we</font>

764
00:30:26,510 --> 00:30:30,260
need a lot<font color="#CCCCCC"> of inputs</font><font color="#E5E5E5"> and we just need to</font>

765
00:30:28,640 --> 00:30:33,230
<font color="#E5E5E5">make</font><font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that either the first or</font><font color="#CCCCCC"> the</font>

766
00:30:30,260 --> 00:30:34,730
last round<font color="#E5E5E5"> here is in few and we need to</font>

767
00:30:33,230 --> 00:30:37,700
make<font color="#CCCCCC"> sure</font><font color="#E5E5E5"> that we actually sample with a</font>

768
00:30:34,730 --> 00:30:39,230
reasonably high sample speed and we need

769
00:30:37,700 --> 00:30:40,940
to make sure<font color="#E5E5E5"> that</font><font color="#CCCCCC"> as we will see later</font>

770
00:30:39,230 --> 00:30:44,720
we need<font color="#CCCCCC"> a little bit</font><font color="#E5E5E5"> of a margin before</font>

771
00:30:40,940 --> 00:30:48,500
and after the<font color="#E5E5E5"> round so if we go</font><font color="#CCCCCC"> back to</font>

772
00:30:44,720 --> 00:30:50,780
<font color="#CCCCCC">the traces elisa</font><font color="#E5E5E5"> already showed us which</font>

773
00:30:48,500 --> 00:30:53,180
turns out<font color="#E5E5E5"> we're actually made with the</font>

774
00:30:50,780 --> 00:30:54,830
horoscope<font color="#CCCCCC"> we can actually see these</font>

775
00:30:53,180 --> 00:30:56,420
rounds of a yes and we probably want<font color="#E5E5E5"> to</font>

776
00:30:54,830 --> 00:30:58,760
collect either here<font color="#CCCCCC"> protect</font><font color="#E5E5E5"> from the</font>

777
00:30:56,420 --> 00:31:00,910
inputs<font color="#E5E5E5"> or maybe from the outputs</font><font color="#CCCCCC"> over</font>

778
00:30:58,760 --> 00:31:00,910
there

779
00:31:01,150 --> 00:31:06,260
so then we start the acquisition<font color="#CCCCCC"> and</font>

780
00:31:03,710 --> 00:31:09,080
then we wait in our<font color="#E5E5E5"> case for about an</font>

781
00:31:06,260 --> 00:31:11,530
<font color="#E5E5E5">hour and a half and then</font><font color="#CCCCCC"> we have all</font>

782
00:31:09,080 --> 00:31:14,269
these<font color="#E5E5E5"> measurements which we can process</font>

783
00:31:11,530 --> 00:31:16,459
<font color="#E5E5E5">so you know we don't actually have</font><font color="#CCCCCC"> to</font>

784
00:31:14,269 --> 00:31:18,409
<font color="#CCCCCC">time to do it live so we actually go</font>

785
00:31:16,459 --> 00:31:21,739
<font color="#CCCCCC">through</font><font color="#E5E5E5"> some data we already collected</font>

786
00:31:18,409 --> 00:31:23,899
previously so we<font color="#CCCCCC"> take these measurements</font>

787
00:31:21,739 --> 00:31:27,109
<font color="#CCCCCC">and we look at them and</font><font color="#E5E5E5"> it turns out</font>

788
00:31:23,899 --> 00:31:29,330
they are<font color="#E5E5E5"> why are they well</font>

789
00:31:27,109 --> 00:31:30,978
there are something<font color="#CCCCCC"> called misaligned</font>

790
00:31:29,330 --> 00:31:32,239
so we plotted two of these<font color="#E5E5E5"> power</font>

791
00:31:30,979 --> 00:31:34,369
measurements on top of each other and

792
00:31:32,239 --> 00:31:36,169
<font color="#CCCCCC">you can see that you know</font><font color="#E5E5E5"> these Peaks</font>

793
00:31:34,369 --> 00:31:38,869
don't really align nicely<font color="#CCCCCC"> they not on</font>

794
00:31:36,169 --> 00:31:41,089
top of<font color="#CCCCCC"> each</font><font color="#E5E5E5"> other</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> this means</font>

795
00:31:38,869 --> 00:31:43,189
basically<font color="#E5E5E5"> in both measurements</font><font color="#CCCCCC"> two</font>

796
00:31:41,089 --> 00:31:46,639
operations do the same operation<font color="#E5E5E5"> doesn't</font>

797
00:31:43,190 --> 00:31:49,070
<font color="#CCCCCC">happen at the same moment</font><font color="#E5E5E5"> in time so if</font>

798
00:31:46,639 --> 00:31:50,958
we look at some what the experts<font color="#E5E5E5"> say</font>

799
00:31:49,070 --> 00:31:52,399
about<font color="#E5E5E5"> this is they say</font><font color="#CCCCCC"> if you do your</font>

800
00:31:50,959 --> 00:31:55,159
statistics<font color="#E5E5E5"> and you have well aligned</font>

801
00:31:52,399 --> 00:31:58,189
traces<font color="#E5E5E5"> you will get this very nice sharp</font>

802
00:31:55,159 --> 00:31:59,959
spikes<font color="#E5E5E5"> however if you have misaligned</font>

803
00:31:58,190 --> 00:32:02,209
traces<font color="#E5E5E5"> and</font><font color="#CCCCCC"> you do the same statistics</font>

804
00:31:59,959 --> 00:32:04,719
<font color="#E5E5E5">you don't get these sharp spikes you get</font>

805
00:32:02,209 --> 00:32:07,039
<font color="#E5E5E5">this bump this</font><font color="#CCCCCC"> spread-out</font><font color="#E5E5E5"> bump and</font>

806
00:32:04,719 --> 00:32:08,659
additionally that bump<font color="#E5E5E5"> might not</font>

807
00:32:07,039 --> 00:32:12,019
<font color="#E5E5E5">actually come out</font><font color="#CCCCCC"> of this background</font>

808
00:32:08,659 --> 00:32:15,559
noise level<font color="#E5E5E5"> so basically we need</font><font color="#CCCCCC"> to</font>

809
00:32:12,019 --> 00:32:18,649
align them<font color="#E5E5E5"> so thankfully Jos ei can</font>

810
00:32:15,559 --> 00:32:21,649
<font color="#E5E5E5">align them for us so we did and what</font><font color="#CCCCCC"> we</font>

811
00:32:18,649 --> 00:32:23,570
see<font color="#CCCCCC"> actually is that</font><font color="#E5E5E5"> we lined on the the</font>

812
00:32:21,649 --> 00:32:26,059
end of the<font color="#E5E5E5"> AES and what we see is that</font>

813
00:32:23,570 --> 00:32:28,158
<font color="#E5E5E5">even though we aligned part of the trace</font>

814
00:32:26,059 --> 00:32:31,579
some<font color="#E5E5E5"> of these other parts are no longer</font>

815
00:32:28,159 --> 00:32:34,159
at the<font color="#CCCCCC"> lines</font><font color="#E5E5E5"> so this part is aligned but</font>

816
00:32:31,579 --> 00:32:36,168
let's say the end<font color="#E5E5E5"> is not aligned and the</font>

817
00:32:34,159 --> 00:32:37,969
beginning is not aligned<font color="#CCCCCC"> so this could</font>

818
00:32:36,169 --> 00:32:40,459
be<font color="#E5E5E5"> either because you know our skill</font>

819
00:32:37,969 --> 00:32:42,529
scope is just really bad<font color="#CCCCCC"> or it could</font><font color="#E5E5E5"> be</font>

820
00:32:40,459 --> 00:32:48,889
because<font color="#E5E5E5"> the Arduino AES library AES</font>

821
00:32:42,529 --> 00:32:50,659
library is not time constant<font color="#E5E5E5"> okay so if</font>

822
00:32:48,889 --> 00:32:52,609
we now do a<font color="#E5E5E5"> little bit of</font><font color="#CCCCCC"> statistics</font>

823
00:32:50,659 --> 00:32:54,979
<font color="#E5E5E5">just to prove</font><font color="#CCCCCC"> that the</font><font color="#E5E5E5"> alignment we did</font>

824
00:32:52,609 --> 00:32:57,189
is actually<font color="#E5E5E5"> useful we can actually do</font>

825
00:32:54,979 --> 00:32:59,839
some statistics<font color="#E5E5E5"> on the output we receive</font>

826
00:32:57,190 --> 00:33:01,099
so before we did this alignments we

827
00:32:59,839 --> 00:33:04,369
<font color="#E5E5E5">actually see that</font><font color="#CCCCCC"> we just</font><font color="#E5E5E5"> have this</font>

828
00:33:01,099 --> 00:33:06,649
noise<font color="#E5E5E5"> band and basically you you maybe</font>

829
00:33:04,369 --> 00:33:08,749
see some<font color="#CCCCCC"> Peaks coming out of it but it's</font>

830
00:33:06,649 --> 00:33:10,609
not<font color="#CCCCCC"> very convincing and after we do the</font>

831
00:33:08,749 --> 00:33:14,149
Slimers what we see is that<font color="#E5E5E5"> the noise</font>

832
00:33:10,609 --> 00:33:15,829
band<font color="#E5E5E5"> is a lot a lot smaller compared</font><font color="#CCCCCC"> to</font>

833
00:33:14,149 --> 00:33:17,689
these very very sharp<font color="#CCCCCC"> peaks we see</font><font color="#E5E5E5"> at</font>

834
00:33:15,829 --> 00:33:19,729
the end<font color="#E5E5E5"> and in fact we can</font><font color="#CCCCCC"> actually see</font>

835
00:33:17,690 --> 00:33:26,349
the output by<font color="#CCCCCC"> it's coming out</font><font color="#E5E5E5"> of the AES</font>

836
00:33:19,729 --> 00:33:26,349
one by one okay<font color="#CCCCCC"> so</font>

837
00:33:26,649 --> 00:33:31,090
let's do a demo<font color="#CCCCCC"> and actually now try</font><font color="#E5E5E5"> to</font>

838
00:33:28,419 --> 00:33:33,759
recover some keys so I'm now<font color="#CCCCCC"> going</font><font color="#E5E5E5"> to</font>

839
00:33:31,090 --> 00:33:35,649
start<font color="#E5E5E5"> start using a</font><font color="#CCCCCC"> Jupiter notebook</font>

840
00:33:33,759 --> 00:33:38,110
<font color="#E5E5E5">does everyone know what's a Jupiter</font>

841
00:33:35,649 --> 00:33:41,229
notebook is yeah I see some people

842
00:33:38,110 --> 00:33:47,279
<font color="#E5E5E5">nodding</font><font color="#CCCCCC"> okay</font><font color="#E5E5E5"> so it's basically a way to</font>

843
00:33:41,230 --> 00:33:52,090
interactively to interactively run code

844
00:33:47,279 --> 00:33:55,379
so here we<font color="#E5E5E5"> basically we starts we open</font>

845
00:33:52,090 --> 00:33:57,999
our measurements<font color="#E5E5E5"> and what we see is that</font>

846
00:33:55,379 --> 00:34:01,658
these traces<font color="#E5E5E5"> are not nicely aligned</font><font color="#CCCCCC"> as</font>

847
00:33:57,999 --> 00:34:04,110
we<font color="#E5E5E5"> predicted so what we do is we run a</font>

848
00:34:01,659 --> 00:34:10,329
little<font color="#E5E5E5"> bit of alignment code down</font><font color="#CCCCCC"> here</font>

849
00:34:04,110 --> 00:34:13,659
and it now is<font color="#E5E5E5"> aligning all these traces</font>

850
00:34:10,329 --> 00:34:16,389
we collected and what<font color="#E5E5E5"> we see is that as</font>

851
00:34:13,659 --> 00:34:18,700
we<font color="#E5E5E5"> said the end part is now very nicely</font>

852
00:34:16,389 --> 00:34:22,359
aligned but this region over<font color="#CCCCCC"> here</font><font color="#E5E5E5"> is not</font>

853
00:34:18,699 --> 00:34:23,710
and neither is<font color="#E5E5E5"> this part here but that's</font>

854
00:34:22,359 --> 00:34:25,210
not really a problem<font color="#CCCCCC"> for us because</font>

855
00:34:23,710 --> 00:34:32,168
we're actually<font color="#E5E5E5"> only interested in</font><font color="#CCCCCC"> this</font>

856
00:34:25,210 --> 00:34:34,720
region<font color="#E5E5E5"> okay so if we now do some</font>

857
00:34:32,168 --> 00:34:36,638
statistics on<font color="#E5E5E5"> the outputs again we</font>

858
00:34:34,719 --> 00:34:39,219
<font color="#E5E5E5">actually see that</font><font color="#CCCCCC"> we actually get</font><font color="#E5E5E5"> these</font>

859
00:34:36,639 --> 00:34:41,470
very very nice<font color="#E5E5E5"> spikes so actually</font>

860
00:34:39,219 --> 00:34:44,408
reasonably<font color="#CCCCCC"> confident</font><font color="#E5E5E5"> that's if we run an</font>

861
00:34:41,469 --> 00:34:47,859
attack we might<font color="#E5E5E5"> actually see we I might</font>

862
00:34:44,409 --> 00:34:55,240
<font color="#E5E5E5">I'd actually recover the key so we're</font>

863
00:34:47,859 --> 00:34:58,779
now<font color="#CCCCCC"> running the attack and</font><font color="#E5E5E5"> basically</font>

864
00:34:55,239 --> 00:35:03,339
what we see<font color="#E5E5E5"> is this so we're now</font>

865
00:34:58,780 --> 00:35:05,670
focusing we're now focusing<font color="#E5E5E5"> on like the</font>

866
00:35:03,339 --> 00:35:09,490
last input bytes<font color="#E5E5E5"> so the last key</font><font color="#CCCCCC"> bite</font>

867
00:35:05,670 --> 00:35:12,849
<font color="#E5E5E5">and what we see is that Julia a has</font>

868
00:35:09,490 --> 00:35:15,098
taken all these guesses<font color="#E5E5E5"> and done the did</font>

869
00:35:12,849 --> 00:35:17,079
<font color="#E5E5E5">this statistics</font><font color="#CCCCCC"> well on them and it</font>

870
00:35:15,099 --> 00:35:19,960
ordered all these guesses<font color="#CCCCCC"> which it calls</font>

871
00:35:17,079 --> 00:35:21,880
candidates<font color="#CCCCCC"> basically by the score and</font>

872
00:35:19,960 --> 00:35:23,410
<font color="#CCCCCC">what we see is that the first</font><font color="#E5E5E5"> the</font>

873
00:35:21,880 --> 00:35:26,500
<font color="#CCCCCC">highest-ranked key candidate has a score</font>

874
00:35:23,410 --> 00:35:29,710
<font color="#CCCCCC">of 0.5 and basically all the others have</font>

875
00:35:26,500 --> 00:35:30,880
a score of let's say 0.25<font color="#E5E5E5"> which</font><font color="#CCCCCC"> means</font>

876
00:35:29,710 --> 00:35:32,740
that there<font color="#CCCCCC"> is actually</font><font color="#E5E5E5"> you a very large</font>

877
00:35:30,880 --> 00:35:35,740
<font color="#E5E5E5">difference</font><font color="#CCCCCC"> between this correctly</font>

878
00:35:32,740 --> 00:35:39,339
correctly<font color="#E5E5E5"> ranks first candidates and</font>

879
00:35:35,740 --> 00:35:40,419
everything<font color="#E5E5E5"> below it so this actually</font>

880
00:35:39,339 --> 00:35:42,308
<font color="#E5E5E5">tells us with the reason</font>

881
00:35:40,420 --> 00:35:45,430
confidence<font color="#E5E5E5"> that we've</font><font color="#CCCCCC"> actually recovered</font>

882
00:35:42,309 --> 00:35:47,609
the correct key<font color="#E5E5E5"> the correct</font><font color="#CCCCCC"> key minds so</font>

883
00:35:45,430 --> 00:35:49,660
we can then<font color="#CCCCCC"> also do it for</font><font color="#E5E5E5"> the</font>

884
00:35:47,609 --> 00:35:51,910
<font color="#E5E5E5">second-to-last key</font><font color="#CCCCCC"> bites for instance</font>

885
00:35:49,660 --> 00:35:56,200
and we see<font color="#CCCCCC"> a</font><font color="#E5E5E5"> pretty much the same story</font>

886
00:35:51,910 --> 00:35:58,118
<font color="#E5E5E5">the correct</font><font color="#CCCCCC"> key bite is on top and it</font>

887
00:35:56,200 --> 00:36:05,669
<font color="#CCCCCC">has a score of</font><font color="#E5E5E5"> 0.5 and all the others</font>

888
00:35:58,119 --> 00:36:08,319
<font color="#E5E5E5">again something</font><font color="#CCCCCC"> like around 0.2</font><font color="#E5E5E5"> okay so</font>

889
00:36:05,670 --> 00:36:11,170
we can also<font color="#E5E5E5"> actually represent what it's</font>

890
00:36:08,319 --> 00:36:15,250
<font color="#CCCCCC">showing us</font><font color="#E5E5E5"> slightly differently so what</font>

891
00:36:11,170 --> 00:36:17,920
we have here<font color="#CCCCCC"> is a plot that shows how</font>

892
00:36:15,250 --> 00:36:20,890
these scores<font color="#CCCCCC"> evolve over time as we give</font>

893
00:36:17,920 --> 00:36:23,049
more traces<font color="#E5E5E5"> so on the x-axis we</font><font color="#CCCCCC"> have the</font>

894
00:36:20,890 --> 00:36:25,390
number of traces<font color="#E5E5E5"> that the</font><font color="#CCCCCC"> jail osea has</font>

895
00:36:23,049 --> 00:36:27,369
processed<font color="#E5E5E5"> and on the y-axis we</font><font color="#CCCCCC"> have</font>

896
00:36:25,390 --> 00:36:31,390
basically the<font color="#CCCCCC"> score</font><font color="#E5E5E5"> for all these key</font>

897
00:36:27,369 --> 00:36:33,490
candidates and what we see is<font color="#CCCCCC"> that you</font>

898
00:36:31,390 --> 00:36:35,319
<font color="#E5E5E5">know when</font><font color="#CCCCCC"> we when not when</font><font color="#E5E5E5"> jail osea</font>

899
00:36:33,490 --> 00:36:37,240
hasn't processed<font color="#E5E5E5"> enough of these</font><font color="#CCCCCC"> traces</font>

900
00:36:35,319 --> 00:36:40,210
basically all<font color="#E5E5E5"> these key candidates are</font>

901
00:36:37,240 --> 00:36:42,729
in<font color="#CCCCCC"> this noise band but as we keep adding</font>

902
00:36:40,210 --> 00:36:45,099
traces what we see is<font color="#CCCCCC"> that you know this</font>

903
00:36:42,730 --> 00:36:47,440
noise band still exists<font color="#E5E5E5"> but one</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> these</font>

904
00:36:45,099 --> 00:36:48,930
key guesses starts the score starts<font color="#CCCCCC"> to</font>

905
00:36:47,440 --> 00:36:51,430
increase and increase and<font color="#CCCCCC"> increase and</font>

906
00:36:48,930 --> 00:36:55,589
<font color="#E5E5E5">this is that correct key candidate</font><font color="#CCCCCC"> I was</font>

907
00:36:51,430 --> 00:36:59,078
talking<font color="#CCCCCC"> about now</font><font color="#E5E5E5"> what we could also do</font>

908
00:36:55,589 --> 00:37:00,849
is basically collect all these plots

909
00:36:59,079 --> 00:37:03,579
<font color="#E5E5E5">together</font><font color="#CCCCCC"> and do this for all key</font>

910
00:37:00,849 --> 00:37:05,619
<font color="#E5E5E5">candidate for all keys</font><font color="#CCCCCC"> but</font><font color="#E5E5E5"> that would</font>

911
00:37:03,579 --> 00:37:06,910
<font color="#CCCCCC">give a really messy picture so what</font><font color="#E5E5E5"> we</font>

912
00:37:05,619 --> 00:37:11,109
can<font color="#E5E5E5"> also do is make a plots which is</font>

913
00:37:06,910 --> 00:37:13,480
called the<font color="#E5E5E5"> rank evolution so basically</font>

914
00:37:11,109 --> 00:37:15,700
this means you're asking<font color="#E5E5E5"> what is the</font>

915
00:37:13,480 --> 00:37:17,640
<font color="#CCCCCC">position</font><font color="#E5E5E5"> what is the the</font><font color="#CCCCCC"> position of</font>

916
00:37:15,700 --> 00:37:20,169
this<font color="#E5E5E5"> of my correct key candidates</font>

917
00:37:17,640 --> 00:37:21,400
between all<font color="#E5E5E5"> these other candidates so</font>

918
00:37:20,170 --> 00:37:25,690
this is<font color="#E5E5E5"> something you can only do if you</font>

919
00:37:21,400 --> 00:37:27,609
<font color="#CCCCCC">actually have</font><font color="#E5E5E5"> the key already</font><font color="#CCCCCC"> so what</font>

920
00:37:25,690 --> 00:37:29,619
you see is that<font color="#E5E5E5"> when</font><font color="#CCCCCC"> you don't give</font><font color="#E5E5E5"> it</font>

921
00:37:27,609 --> 00:37:33,549
enough traces all these<font color="#E5E5E5"> keys have</font>

922
00:37:29,619 --> 00:37:36,010
basically a more or<font color="#CCCCCC"> less random</font><font color="#E5E5E5"> rank but</font>

923
00:37:33,549 --> 00:37:38,200
<font color="#E5E5E5">as you give more</font><font color="#CCCCCC"> traces they all they</font>

924
00:37:36,010 --> 00:37:40,690
<font color="#E5E5E5">all start</font><font color="#CCCCCC"> to float to the top</font><font color="#E5E5E5"> start to</font>

925
00:37:38,200 --> 00:37:43,118
flow to rank<font color="#CCCCCC"> zero and after you've</font>

926
00:37:40,690 --> 00:37:45,430
collected a certain amount<font color="#E5E5E5"> of traces all</font>

927
00:37:43,119 --> 00:37:49,319
the key ranks are<font color="#CCCCCC"> zero and this means</font>

928
00:37:45,430 --> 00:37:49,319
you<font color="#E5E5E5"> basically recovered the entire key</font>

929
00:37:50,970 --> 00:37:59,609
so with that we go back to the

930
00:37:56,010 --> 00:38:01,500
presentation<font color="#E5E5E5"> okay so you know we gave</font>

931
00:37:59,609 --> 00:38:05,400
this demo now we've recovered this key

932
00:38:01,500 --> 00:38:09,060
<font color="#E5E5E5">using</font><font color="#CCCCCC"> a home made oscilloscope but how</font>

933
00:38:05,400 --> 00:38:11,700
bad is it<font color="#CCCCCC"> really so it turns out</font><font color="#E5E5E5"> that</font>

934
00:38:09,060 --> 00:38:15,839
you know if we buy this cheap

935
00:38:11,700 --> 00:38:18,118
oscilloscope<font color="#E5E5E5"> of Aliexpress for about</font>

936
00:38:15,839 --> 00:38:21,000
<font color="#CCCCCC">seventy</font><font color="#E5E5E5"> dollars</font><font color="#CCCCCC"> we can actually</font><font color="#E5E5E5"> recover</font>

937
00:38:18,119 --> 00:38:25,470
the key in approximately<font color="#CCCCCC"> 1500</font>

938
00:38:21,000 --> 00:38:27,119
measurements<font color="#CCCCCC"> and with the horoscope may</font>

939
00:38:25,470 --> 00:38:29,879
differ a bit but it's at least<font color="#CCCCCC"> an all</font>

940
00:38:27,119 --> 00:38:34,770
the order of<font color="#E5E5E5"> magnitude</font><font color="#CCCCCC"> more on the other</font>

941
00:38:29,880 --> 00:38:35,970
hand is also<font color="#E5E5E5"> a lot cheaper so yeah so</font>

942
00:38:34,770 --> 00:38:37,530
<font color="#E5E5E5">basically what we</font><font color="#CCCCCC"> see is that we can</font>

943
00:38:35,970 --> 00:38:39,990
<font color="#E5E5E5">make all these</font><font color="#CCCCCC"> mistakes and</font><font color="#E5E5E5"> we actually</font>

944
00:38:37,530 --> 00:38:43,230
still you know get these attacks to work

945
00:38:39,990 --> 00:38:47,250
<font color="#E5E5E5">so how</font><font color="#CCCCCC"> many mistakes</font><font color="#E5E5E5"> do</font><font color="#CCCCCC"> you actually can</font>

946
00:38:43,230 --> 00:38:49,859
you make so<font color="#CCCCCC"> that it stops working so</font>

947
00:38:47,250 --> 00:38:51,329
originally we had<font color="#E5E5E5"> some we actually had</font>

948
00:38:49,859 --> 00:38:54,810
we worked on some prototypes which

949
00:38:51,329 --> 00:38:57,930
someone else made for a<font color="#E5E5E5"> different reason</font>

950
00:38:54,810 --> 00:38:59,670
<font color="#E5E5E5">and the</font><font color="#CCCCCC"> silkscreen</font><font color="#E5E5E5"> so basically the the</font>

951
00:38:57,930 --> 00:39:03,540
<font color="#CCCCCC">writing</font><font color="#E5E5E5"> next to the pins have an off by</font>

952
00:38:59,670 --> 00:39:07,200
one so you<font color="#E5E5E5"> know everyone told us that</font>

953
00:39:03,540 --> 00:39:10,619
the ADC on the<font color="#E5E5E5"> X mega was really bad so</font>

954
00:39:07,200 --> 00:39:13,379
<font color="#CCCCCC">we took a measurement</font><font color="#E5E5E5"> like this and yeah</font>

955
00:39:10,619 --> 00:39:15,390
yeah okay it's bad<font color="#E5E5E5"> but we can still sort</font>

956
00:39:13,380 --> 00:39:17,880
of<font color="#E5E5E5"> see these rounds of a yes right</font>

957
00:39:15,390 --> 00:39:19,680
but because the silkscreen wasn't off by

958
00:39:17,880 --> 00:39:24,060
one<font color="#CCCCCC"> we hadn't actually</font><font color="#E5E5E5"> connected the</font>

959
00:39:19,680 --> 00:39:25,950
pins so what you're seeing here<font color="#E5E5E5"> is a</font>

960
00:39:24,060 --> 00:39:28,549
measurement<font color="#E5E5E5"> we made without actually</font>

961
00:39:25,950 --> 00:39:31,770
connecting the pins<font color="#E5E5E5"> through the ADC</font>

962
00:39:28,550 --> 00:39:33,240
<font color="#CCCCCC">however if you take you know</font><font color="#E5E5E5"> a thousand</font>

963
00:39:31,770 --> 00:39:36,210
of<font color="#E5E5E5"> those measurements</font><font color="#CCCCCC"> and average</font><font color="#E5E5E5"> them</font>

964
00:39:33,240 --> 00:39:38,490
<font color="#E5E5E5">with no alignment you can</font><font color="#CCCCCC"> actually see</font>

965
00:39:36,210 --> 00:39:42,119
shoot<font color="#E5E5E5"> these rounds of AES again with the</font>

966
00:39:38,490 --> 00:39:44,848
pins not connected<font color="#E5E5E5"> so</font><font color="#CCCCCC"> unfortunately for</font>

967
00:39:42,119 --> 00:39:46,800
us<font color="#CCCCCC"> we didn't actually recover the key in</font>

968
00:39:44,849 --> 00:39:49,440
that<font color="#E5E5E5"> case because we required that many</font>

969
00:39:46,800 --> 00:39:54,119
<font color="#CCCCCC">traces but already the fact</font><font color="#E5E5E5"> that you can</font>

970
00:39:49,440 --> 00:39:55,170
see these rounds appearing<font color="#E5E5E5"> basically</font>

971
00:39:54,119 --> 00:39:59,460
when you haven't even connected up the

972
00:39:55,170 --> 00:40:00,839
wires is<font color="#CCCCCC"> rather worrying all right so</font>

973
00:39:59,460 --> 00:40:02,369
basically<font color="#CCCCCC"> for these side-channel</font><font color="#E5E5E5"> attacks</font>

974
00:40:00,839 --> 00:40:04,380
<font color="#E5E5E5">there's strength in numbers</font><font color="#CCCCCC"> and</font>

975
00:40:02,369 --> 00:40:06,000
basically it

976
00:40:04,380 --> 00:40:08,609
<font color="#CCCCCC">Acts require</font><font color="#E5E5E5"> that the noise from the</font>

977
00:40:06,000 --> 00:40:11,309
system<font color="#E5E5E5"> is overcome and we can actually</font>

978
00:40:08,609 --> 00:40:14,119
<font color="#E5E5E5">reduce this noise by basically</font><font color="#CCCCCC"> taking</font>

979
00:40:11,309 --> 00:40:16,799
more<font color="#CCCCCC"> traces however sometimes the way</font>

980
00:40:14,119 --> 00:40:20,730
<font color="#E5E5E5">the protocol is written for instance</font>

981
00:40:16,799 --> 00:40:22,980
<font color="#E5E5E5">doesn't allow you to do this all right</font>

982
00:40:20,730 --> 00:40:25,109
<font color="#E5E5E5">so enough about all this boring</font><font color="#CCCCCC"> theory</font>

983
00:40:22,980 --> 00:40:27,809
part<font color="#E5E5E5"> let's talk a little bit about fault</font>

984
00:40:25,109 --> 00:40:29,160
injection<font color="#E5E5E5"> before we finish up</font><font color="#CCCCCC"> because I</font>

985
00:40:27,809 --> 00:40:31,740
already<font color="#CCCCCC"> see everyone going</font><font color="#E5E5E5"> a bit tired</font>

986
00:40:29,160 --> 00:40:34,710
of<font color="#E5E5E5"> all this theory so it turns out the</font>

987
00:40:31,740 --> 00:40:37,859
horoscope can actually<font color="#E5E5E5"> sort of power the</font>

988
00:40:34,710 --> 00:40:42,089
<font color="#CCCCCC">Arduino Nano so the</font><font color="#E5E5E5"> Nano normally works</font>

989
00:40:37,859 --> 00:40:44,880
at<font color="#E5E5E5"> 5 volts</font><font color="#CCCCCC"> and the</font><font color="#E5E5E5"> X mega GPIO pins can</font>

990
00:40:42,089 --> 00:40:48,920
provide<font color="#E5E5E5"> three point two volts clearly we</font>

991
00:40:44,880 --> 00:40:48,920
can<font color="#CCCCCC"> actually power it some of the</font><font color="#E5E5E5"> time</font>

992
00:40:49,339 --> 00:40:55,589
<font color="#CCCCCC">yeah</font><font color="#E5E5E5"> so how do we how do we connect it</font>

993
00:40:52,710 --> 00:40:57,000
for you no fault injection<font color="#CCCCCC"> what we do is</font>

994
00:40:55,589 --> 00:41:00,630
<font color="#E5E5E5">basically that power cut we had before</font>

995
00:40:57,000 --> 00:41:03,900
<font color="#E5E5E5">we connect basically the entire port see</font>

996
00:41:00,630 --> 00:41:06,630
GPIO pins<font color="#CCCCCC"> 0 through 7 we connect it to</font>

997
00:41:03,900 --> 00:41:08,579
the VCC line of the targets<font color="#E5E5E5"> and then</font>

998
00:41:06,630 --> 00:41:10,170
<font color="#E5E5E5">basically by toggling these GPIO pins</font>

999
00:41:08,579 --> 00:41:14,609
really quickly<font color="#E5E5E5"> we can</font><font color="#CCCCCC"> actually induce</font>

1000
00:41:10,170 --> 00:41:16,740
<font color="#CCCCCC">faults</font><font color="#E5E5E5"> into the computations so we have</font>

1001
00:41:14,609 --> 00:41:19,049
<font color="#E5E5E5">faults and actually we could not</font>

1002
00:41:16,740 --> 00:41:20,490
actually<font color="#E5E5E5"> perform differential fault</font>

1003
00:41:19,049 --> 00:41:23,430
analysis which basically means you

1004
00:41:20,490 --> 00:41:26,098
<font color="#E5E5E5">injects faults into running a yes and</font>

1005
00:41:23,430 --> 00:41:27,899
then you look at<font color="#CCCCCC"> some of</font><font color="#E5E5E5"> these faulty</font>

1006
00:41:26,099 --> 00:41:31,579
outputs<font color="#E5E5E5"> and if you have enough of good</font>

1007
00:41:27,900 --> 00:41:34,349
faulty outputs you<font color="#CCCCCC"> can recover</font><font color="#E5E5E5"> the key</font>

1008
00:41:31,579 --> 00:41:36,329
<font color="#CCCCCC">all</font><font color="#E5E5E5"> right</font><font color="#CCCCCC"> so you know we can do all</font>

1009
00:41:34,349 --> 00:41:39,150
those things<font color="#CCCCCC"> to the</font><font color="#E5E5E5"> Arduino Nano from</font>

1010
00:41:36,329 --> 00:41:39,660
this horoscope<font color="#CCCCCC"> but what could</font><font color="#E5E5E5"> you do</font>

1011
00:41:39,150 --> 00:41:41,190
<font color="#CCCCCC">about it</font>

1012
00:41:39,660 --> 00:41:42,450
well the<font color="#E5E5E5"> first thing you could do about</font>

1013
00:41:41,190 --> 00:41:45,329
<font color="#CCCCCC">it is you</font><font color="#E5E5E5"> could</font><font color="#CCCCCC"> look at your threat</font>

1014
00:41:42,450 --> 00:41:47,160
model<font color="#CCCCCC"> and try to identify</font><font color="#E5E5E5"> if you can</font>

1015
00:41:45,329 --> 00:41:51,059
come<font color="#CCCCCC"> up with</font><font color="#E5E5E5"> some way in which</font><font color="#CCCCCC"> basically</font>

1016
00:41:47,160 --> 00:41:54,269
these attacks really<font color="#E5E5E5"> don't matter so for</font>

1017
00:41:51,059 --> 00:41:55,619
instance by changing the protocol<font color="#CCCCCC"> there</font>

1018
00:41:54,269 --> 00:41:57,089
are also some other basic steps<font color="#E5E5E5"> you</font>

1019
00:41:55,619 --> 00:41:59,759
could<font color="#E5E5E5"> do to protect you to protect your</font>

1020
00:41:57,089 --> 00:42:01,470
device<font color="#E5E5E5"> and basically I think one</font><font color="#CCCCCC"> of the</font>

1021
00:41:59,759 --> 00:42:03,029
<font color="#E5E5E5">easiest steps is</font><font color="#CCCCCC"> to use some hardware</font>

1022
00:42:01,470 --> 00:42:07,140
that actually has<font color="#E5E5E5"> built-in</font>

1023
00:42:03,029 --> 00:42:08,849
countermeasures already but then<font color="#E5E5E5"> even if</font>

1024
00:42:07,140 --> 00:42:10,650
you<font color="#E5E5E5"> do that I</font><font color="#CCCCCC"> think at some point</font><font color="#E5E5E5"> it</font>

1025
00:42:08,849 --> 00:42:12,450
<font color="#E5E5E5">will be a great idea if you actually</font>

1026
00:42:10,650 --> 00:42:14,190
looked<font color="#E5E5E5"> at these part of the power usage</font>

1027
00:42:12,450 --> 00:42:17,500
of these devices<font color="#E5E5E5"> and</font><font color="#CCCCCC"> actually found try</font>

1028
00:42:14,190 --> 00:42:19,650
to ascertain how much they leak

1029
00:42:17,500 --> 00:42:21,430
using either<font color="#CCCCCC"> you know a real</font>

1030
00:42:19,650 --> 00:42:26,109
oscilloscope<font color="#E5E5E5"> or perhaps the chip</font>

1031
00:42:21,430 --> 00:42:27,819
whisperer so just to<font color="#E5E5E5"> conclude these</font>

1032
00:42:26,109 --> 00:42:30,520
<font color="#CCCCCC">Hardware attacks</font><font color="#E5E5E5"> are a lot cheaper than</font>

1033
00:42:27,820 --> 00:42:32,680
even we thought and side channel

1034
00:42:30,520 --> 00:42:37,330
analysis is something<font color="#E5E5E5"> you can do at</font><font color="#CCCCCC"> home</font>

1035
00:42:32,680 --> 00:42:39,160
<font color="#E5E5E5">and you should</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> give it a go so we'd</font>

1036
00:42:37,330 --> 00:42:42,220
like to<font color="#E5E5E5"> give a special thanks</font><font color="#CCCCCC"> to a case</font>

1037
00:42:39,160 --> 00:42:44,710
for actually<font color="#E5E5E5"> writing</font><font color="#CCCCCC"> jail SCA</font><font color="#E5E5E5"> we'd also</font>

1038
00:42:42,220 --> 00:42:48,580
like to<font color="#E5E5E5"> thank Rafa for really motivating</font>

1039
00:42:44,710 --> 00:42:49,780
us and saying<font color="#E5E5E5"> it wouldn't work</font><font color="#CCCCCC"> we'd like</font>

1040
00:42:48,580 --> 00:42:51,940
to thank India for letting you see<font color="#CCCCCC"> these</font>

1041
00:42:49,780 --> 00:42:54,609
pictures<font color="#E5E5E5"> and we also did a workshop and</font>

1042
00:42:51,940 --> 00:42:57,820
we'd like also to<font color="#E5E5E5"> thank those at Indies</font>

1043
00:42:54,609 --> 00:42:59,650
for<font color="#E5E5E5"> all the feedback they gave us so</font>

1044
00:42:57,820 --> 00:43:01,630
<font color="#E5E5E5">because you're in this</font><font color="#CCCCCC"> room we also have</font>

1045
00:42:59,650 --> 00:43:05,490
a bit<font color="#E5E5E5"> of homework for</font><font color="#CCCCCC"> you which we</font>

1046
00:43:01,630 --> 00:43:08,109
expect to<font color="#E5E5E5"> have back tomorrow</font><font color="#CCCCCC"> we have a</font>

1047
00:43:05,490 --> 00:43:09,580
github repository<font color="#CCCCCC"> we've provided that</font>

1048
00:43:08,109 --> 00:43:12,160
<font color="#E5E5E5">pack we will provide the power traces</font>

1049
00:43:09,580 --> 00:43:14,830
<font color="#E5E5E5">and the</font><font color="#CCCCCC"> juse</font><font color="#E5E5E5"> a notebook</font><font color="#CCCCCC"> and you should</font>

1050
00:43:12,160 --> 00:43:16,839
be able to<font color="#E5E5E5"> get the key we've also</font>

1051
00:43:14,830 --> 00:43:19,330
provided<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the schematics and</font><font color="#E5E5E5"> all the</font>

1052
00:43:16,840 --> 00:43:21,280
source<font color="#CCCCCC"> code we need</font><font color="#E5E5E5"> and we're actually</font>

1053
00:43:19,330 --> 00:43:25,690
also hoping<font color="#CCCCCC"> that someone will port all</font>

1054
00:43:21,280 --> 00:43:29,140
of this basically<font color="#E5E5E5"> to an stm32 you know</font>

1055
00:43:25,690 --> 00:43:33,580
stm32 blue pill so we can actually do<font color="#CCCCCC"> SE</font>

1056
00:43:29,140 --> 00:43:36,310
a for even<font color="#CCCCCC"> cheaper and also less plug so</font>

1057
00:43:33,580 --> 00:43:37,930
with that if you have<font color="#CCCCCC"> any questions you</font>

1058
00:43:36,310 --> 00:43:39,310
<font color="#CCCCCC">can ask them either now</font><font color="#E5E5E5"> or in the</font>

1059
00:43:37,930 --> 00:43:39,640
upcoming days because we'll still<font color="#CCCCCC"> be</font>

1060
00:43:39,310 --> 00:43:42,040
around

1061
00:43:39,640 --> 00:43:45,250
I mean maybe<font color="#CCCCCC"> of course we can't show you</font>

1062
00:43:42,040 --> 00:43:47,320
a whole feature demo here but we have a

1063
00:43:45,250 --> 00:43:48,730
chip<font color="#CCCCCC"> whisperer with us</font><font color="#E5E5E5"> and we have all</font>

1064
00:43:47,320 --> 00:43:50,980
this equipment with us<font color="#E5E5E5"> if you'd like to</font>

1065
00:43:48,730 --> 00:43:53,430
come and<font color="#E5E5E5"> play we'll be here all week so</font>

1066
00:43:50,980 --> 00:43:53,430
please do

1067
00:43:55,680 --> 00:44:06,198
[Applause]

1068
00:44:23,700 --> 00:44:35,230
yes so it turns out the pin so I started

1069
00:44:29,880 --> 00:44:38,650
I'm going<font color="#E5E5E5"> to ruin</font><font color="#CCCCCC"> strain</font><font color="#E5E5E5"> so the because</font>

1070
00:44:35,230 --> 00:44:40,600
the pins were mislabeled<font color="#CCCCCC"> I we connected</font>

1071
00:44:38,650 --> 00:44:44,830
them<font color="#E5E5E5"> basically to</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> pins next to the</font>

1072
00:44:40,600 --> 00:44:46,600
pins we thought we connected so we

1073
00:44:44,830 --> 00:44:47,650
didn't<font color="#E5E5E5"> actually connect the pins but</font>

1074
00:44:46,600 --> 00:44:50,529
because they were still so close

1075
00:44:47,650 --> 00:44:53,620
together<font color="#CCCCCC"> they still</font><font color="#E5E5E5"> somehow I don't</font><font color="#CCCCCC"> know</font>

1076
00:44:50,530 --> 00:44:56,740
<font color="#CCCCCC">electromagnetic decoupled</font><font color="#E5E5E5"> or there was</font>

1077
00:44:53,620 --> 00:44:58,720
some<font color="#CCCCCC"> leach effect or I I don't know</font><font color="#E5E5E5"> it</font>

1078
00:44:56,740 --> 00:45:00,819
<font color="#E5E5E5">may be one thing you don't</font><font color="#CCCCCC"> see here is</font>

1079
00:44:58,720 --> 00:45:02,709
we don't<font color="#E5E5E5"> do a scale right so the</font><font color="#CCCCCC"> white</font>

1080
00:45:00,820 --> 00:45:04,840
scale is just<font color="#E5E5E5"> kind of scaled to fit</font>

1081
00:45:02,710 --> 00:45:06,490
what's there and<font color="#E5E5E5"> it turns out what</font>

1082
00:45:04,840 --> 00:45:08,980
you're seeing<font color="#CCCCCC"> here is</font><font color="#E5E5E5"> wave lower signal</font>

1083
00:45:06,490 --> 00:45:10,870
<font color="#CCCCCC">after</font><font color="#E5E5E5"> signal levels then what we shown</font>

1084
00:45:08,980 --> 00:45:15,580
in the<font color="#E5E5E5"> other graphs but it's still there</font>

1085
00:45:10,870 --> 00:45:17,500
yeah yeah so also as Alyssa's pointing

1086
00:45:15,580 --> 00:45:19,210
<font color="#E5E5E5">out we actually really don't know what</font>

1087
00:45:17,500 --> 00:45:22,680
<font color="#E5E5E5">this voltage level is because</font><font color="#CCCCCC"> we haven't</font>

1088
00:45:19,210 --> 00:45:22,680
calibrated it because we don't<font color="#E5E5E5"> care</font>

1089
00:45:23,620 --> 00:45:26,609
<font color="#E5E5E5">any other questions</font>

1090
00:45:29,700 --> 00:45:38,319
[Applause]

1091
00:46:06,890 --> 00:46:11,160
but I really mean it<font color="#E5E5E5"> I mean if you want</font>

1092
00:46:09,299 --> 00:46:12,750
to play with<font color="#E5E5E5"> this</font><font color="#CCCCCC"> stuff we really</font><font color="#E5E5E5"> want</font>

1093
00:46:11,160 --> 00:46:14,430
to<font color="#E5E5E5"> see more</font><font color="#CCCCCC"> people doing this stuff on</font>

1094
00:46:12,750 --> 00:46:17,150
random<font color="#E5E5E5"> Hardware better understanding</font>

1095
00:46:14,430 --> 00:46:17,149
come talk to us

