1
00:00:01,800 --> 00:00:07,149
<font color="#E5E5E5">all right I would</font><font color="#CCCCCC"> say we continue I hope</font>

2
00:00:04,690 --> 00:00:11,070
you had a good lunch<font color="#E5E5E5"> did you enjoy the</font>

3
00:00:07,149 --> 00:00:13,389
food yeah silence<font color="#CCCCCC"> oh yeah you enjoyed it</font>

4
00:00:11,070 --> 00:00:15,580
<font color="#E5E5E5">all right it's a special pleasure to me</font>

5
00:00:13,389 --> 00:00:18,009
to<font color="#CCCCCC"> introduce to you</font><font color="#E5E5E5"> Dennis one of my</font>

6
00:00:15,580 --> 00:00:19,720
teammates at<font color="#CCCCCC"> EMW</font><font color="#E5E5E5"> and also</font><font color="#CCCCCC"> uske from tu</font>

7
00:00:18,010 --> 00:00:21,430
Darmstadt<font color="#CCCCCC"> who will present on their</font>

8
00:00:19,720 --> 00:00:23,229
<font color="#E5E5E5">Bluetooth framework that they</font><font color="#CCCCCC"> develop</font>

9
00:00:21,430 --> 00:00:25,750
<font color="#CCCCCC">due</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> who's analyzing framework of</font>

10
00:00:23,230 --> 00:00:28,330
course and one<font color="#E5E5E5"> disclaimer before they</font>

11
00:00:25,750 --> 00:00:31,150
start<font color="#E5E5E5"> if you don't</font><font color="#CCCCCC"> want your</font><font color="#E5E5E5"> Bluetooth</font>

12
00:00:28,330 --> 00:00:33,339
ID<font color="#E5E5E5"> to be seen during the presentation</font>

13
00:00:31,150 --> 00:00:37,149
then I would<font color="#E5E5E5"> recommend you</font><font color="#CCCCCC"> to turn</font>

14
00:00:33,339 --> 00:00:40,710
bluetooth off<font color="#E5E5E5"> no all right</font><font color="#CCCCCC"> okay please</font>

15
00:00:37,149 --> 00:00:40,710
give a warm applause<font color="#E5E5E5"> for those two guys</font>

16
00:00:42,089 --> 00:00:47,230
yeah<font color="#E5E5E5"> thank you for the introduction and</font>

17
00:00:44,800 --> 00:00:49,449
<font color="#E5E5E5">welcome you all to our talk my name</font><font color="#CCCCCC"> is</font>

18
00:00:47,230 --> 00:00:51,940
<font color="#E5E5E5">Dennis and yeah I was working with</font>

19
00:00:49,449 --> 00:00:54,429
Bluetooth for my master thesis<font color="#E5E5E5"> basically</font>

20
00:00:51,940 --> 00:00:56,530
what<font color="#E5E5E5"> I did</font><font color="#CCCCCC"> is I reverse engineered the</font>

21
00:00:54,429 --> 00:00:59,440
<font color="#E5E5E5">firmware of a Bluetooth controller which</font>

22
00:00:56,530 --> 00:01:02,050
was manufactured<font color="#E5E5E5"> by Broadcom and I did</font>

23
00:00:59,440 --> 00:01:04,420
that<font color="#E5E5E5"> to find out how it works and how it</font>

24
00:01:02,050 --> 00:01:06,580
<font color="#E5E5E5">looks from a security perspective but</font>

25
00:01:04,420 --> 00:01:09,370
then at<font color="#E5E5E5"> some point I found out that I</font>

26
00:01:06,580 --> 00:01:12,360
was actually<font color="#E5E5E5"> able to modify the firmware</font>

27
00:01:09,370 --> 00:01:14,950
myself so I<font color="#CCCCCC"> decided</font><font color="#E5E5E5"> to write a little</font>

28
00:01:12,360 --> 00:01:16,990
experimentation framework so<font color="#E5E5E5"> that also</font>

29
00:01:14,950 --> 00:01:19,540
other researchers can<font color="#CCCCCC"> use this knowledge</font>

30
00:01:16,990 --> 00:01:22,869
to easily experiment with the<font color="#CCCCCC"> wrister</font>

31
00:01:19,540 --> 00:01:25,000
<font color="#CCCCCC">filmer basically yeah</font>

32
00:01:22,870 --> 00:01:27,250
yes<font color="#CCCCCC"> qey was my supervisor during</font><font color="#E5E5E5"> my</font>

33
00:01:25,000 --> 00:01:29,350
thesis<font color="#CCCCCC"> and she took over</font><font color="#E5E5E5"> the work on</font>

34
00:01:27,250 --> 00:01:31,570
this<font color="#CCCCCC"> framework after</font><font color="#E5E5E5"> I finished and now</font>

35
00:01:29,350 --> 00:01:33,399
<font color="#E5E5E5">she and several other students are still</font>

36
00:01:31,570 --> 00:01:35,020
working<font color="#E5E5E5"> on this and further developing</font>

37
00:01:33,400 --> 00:01:36,970
the features and<font color="#CCCCCC"> also finding more use</font>

38
00:01:35,020 --> 00:01:42,820
cases<font color="#E5E5E5"> and more interesting stuff in this</font>

39
00:01:36,970 --> 00:01:45,880
<font color="#CCCCCC">firmware so what we</font><font color="#E5E5E5"> basically thought is</font>

40
00:01:42,820 --> 00:01:47,789
<font color="#E5E5E5">it would be interesting to to do a</font>

41
00:01:45,880 --> 00:01:50,259
little<font color="#E5E5E5"> research on</font><font color="#CCCCCC"> Bluetooth femoris</font>

42
00:01:47,790 --> 00:01:52,300
there are several things you you might

43
00:01:50,260 --> 00:01:55,720
want to be interested<font color="#CCCCCC"> in</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> example</font>

44
00:01:52,300 --> 00:01:58,030
it's always good to dissect the firmware

45
00:01:55,720 --> 00:01:59,770
if you actually<font color="#E5E5E5"> want</font><font color="#CCCCCC"> to have a look at</font>

46
00:01:58,030 --> 00:02:01,270
it from a security perspective<font color="#E5E5E5"> so this</font>

47
00:01:59,770 --> 00:02:04,000
<font color="#E5E5E5">was what I had first in mind when I</font>

48
00:02:01,270 --> 00:02:06,100
started<font color="#CCCCCC"> my thesis</font><font color="#E5E5E5"> I wanted to see how</font>

49
00:02:04,000 --> 00:02:07,840
<font color="#E5E5E5">well</font><font color="#CCCCCC"> is the security of those</font><font color="#E5E5E5"> members</font>

50
00:02:06,100 --> 00:02:11,200
<font color="#CCCCCC">and I started with a broad confirmer</font>

51
00:02:07,840 --> 00:02:13,090
because this was what I had at<font color="#E5E5E5"> hand then</font>

52
00:02:11,200 --> 00:02:14,738
as I said<font color="#CCCCCC"> I found out that I was</font>

53
00:02:13,090 --> 00:02:14,950
<font color="#E5E5E5">actually able to</font><font color="#CCCCCC"> modify the firmware and</font>

54
00:02:14,739 --> 00:02:16,450
this

55
00:02:14,950 --> 00:02:18,819
opened up a whole new<font color="#E5E5E5"> world of</font>

56
00:02:16,450 --> 00:02:21,549
<font color="#CCCCCC">possibilities</font><font color="#E5E5E5"> so basically now</font><font color="#CCCCCC"> we're</font>

57
00:02:18,819 --> 00:02:23,829
<font color="#E5E5E5">able to leverage this fully featured and</font>

58
00:02:21,550 --> 00:02:25,930
<font color="#E5E5E5">working Bluetooth implementation to be</font>

59
00:02:23,830 --> 00:02:28,060
our<font color="#E5E5E5"> very own experimentation platform</font>

60
00:02:25,930 --> 00:02:30,310
where we<font color="#CCCCCC"> can add new features and alter</font>

61
00:02:28,060 --> 00:02:32,349
existing<font color="#E5E5E5"> behavior</font><font color="#CCCCCC"> which is really</font><font color="#E5E5E5"> nice</font>

62
00:02:30,310 --> 00:02:34,510
it almost feels<font color="#CCCCCC"> like we can had kind of</font>

63
00:02:32,349 --> 00:02:36,640
an<font color="#CCCCCC"> open-source touch</font><font color="#E5E5E5"> to a closed source</font>

64
00:02:34,510 --> 00:02:38,709
system because those Bluetooth members

65
00:02:36,640 --> 00:02:42,339
are<font color="#E5E5E5"> usually not open source and you</font>

66
00:02:38,709 --> 00:02:44,410
cannot see<font color="#E5E5E5"> what they actually doing yeah</font>

67
00:02:42,340 --> 00:02:45,819
<font color="#E5E5E5">after all we really like reverse</font>

68
00:02:44,410 --> 00:02:47,920
engineering so this was<font color="#E5E5E5"> also another</font>

69
00:02:45,819 --> 00:02:50,619
<font color="#E5E5E5">reason why we did that we already</font>

70
00:02:47,920 --> 00:02:53,140
already<font color="#E5E5E5"> did some similar projects in the</font>

71
00:02:50,620 --> 00:02:55,120
past<font color="#E5E5E5"> where we had great experiences</font><font color="#CCCCCC"> with</font>

72
00:02:53,140 --> 00:02:57,880
reverse engineering firmware for example

73
00:02:55,120 --> 00:03:00,250
some of<font color="#CCCCCC"> you might know the next</font><font color="#E5E5E5"> month</font>

74
00:02:57,880 --> 00:03:02,290
project<font color="#E5E5E5"> this was</font><font color="#CCCCCC"> a project</font><font color="#E5E5E5"> where we</font>

75
00:03:00,250 --> 00:03:03,880
reverse engineered<font color="#CCCCCC"> the firmware of Wi-Fi</font>

76
00:03:02,290 --> 00:03:06,280
controllers<font color="#E5E5E5"> also manufactured by</font>

77
00:03:03,880 --> 00:03:08,109
Broadcom<font color="#E5E5E5"> and this was also</font><font color="#CCCCCC"> a big success</font>

78
00:03:06,280 --> 00:03:11,019
we could also<font color="#CCCCCC"> modify the</font><font color="#E5E5E5"> firmware of</font>

79
00:03:08,110 --> 00:03:13,750
those and other researchers took over at

80
00:03:11,019 --> 00:03:16,480
work for<font color="#CCCCCC"> example who project zero used</font>

81
00:03:13,750 --> 00:03:19,329
this<font color="#E5E5E5"> work also</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> develop some remote</font>

82
00:03:16,480 --> 00:03:21,220
execution<font color="#E5E5E5"> packs on on the firmware of</font>

83
00:03:19,329 --> 00:03:25,600
Wi-Fi controllers and they also

84
00:03:21,220 --> 00:03:28,030
referenced to this work now<font color="#CCCCCC"> before we</font>

85
00:03:25,600 --> 00:03:29,888
<font color="#E5E5E5">really start to dig into how this memory</font>

86
00:03:28,030 --> 00:03:33,340
<font color="#E5E5E5">works I want to first talk a little bit</font>

87
00:03:29,889 --> 00:03:35,410
about<font color="#CCCCCC"> bluetooth to bring all on the same</font>

88
00:03:33,340 --> 00:03:39,280
page basically<font color="#CCCCCC"> bluetooth is also a</font>

89
00:03:35,410 --> 00:03:42,069
layered protocol stack just as tcp/ip<font color="#E5E5E5"> we</font>

90
00:03:39,280 --> 00:03:44,440
have different protocol layers<font color="#E5E5E5"> and the</font>

91
00:03:42,069 --> 00:03:47,470
special<font color="#E5E5E5"> thing about this is that it's</font>

92
00:03:44,440 --> 00:03:50,620
basically divided into two<font color="#CCCCCC"> paths</font><font color="#E5E5E5"> so the</font>

93
00:03:47,470 --> 00:03:52,750
upper half is implemented in<font color="#E5E5E5"> the host so</font>

94
00:03:50,620 --> 00:03:55,480
the<font color="#E5E5E5"> host would be in this case an</font>

95
00:03:52,750 --> 00:03:58,989
<font color="#CCCCCC">android phone for example</font><font color="#E5E5E5"> or iOS system</font>

96
00:03:55,480 --> 00:04:01,630
<font color="#E5E5E5">Linux</font><font color="#CCCCCC"> Windows or anything that has a</font>

97
00:03:58,989 --> 00:04:03,430
Bluetooth stack and yeah<font color="#E5E5E5"> comes with</font>

98
00:04:01,630 --> 00:04:05,620
<font color="#CCCCCC">Bluetooth support and then</font><font color="#E5E5E5"> the lower</font>

99
00:04:03,430 --> 00:04:07,209
half<font color="#CCCCCC"> of the stack is implemented inside</font>

100
00:04:05,620 --> 00:04:09,910
a Bluetooth controller and<font color="#E5E5E5"> the Bluetooth</font>

101
00:04:07,209 --> 00:04:11,680
controller is a<font color="#E5E5E5"> dedicated chip on</font><font color="#CCCCCC"> your</font>

102
00:04:09,910 --> 00:04:13,540
main board for<font color="#CCCCCC"> example or it also comes</font>

103
00:04:11,680 --> 00:04:17,620
in form of little USB<font color="#E5E5E5"> dongles you can</font>

104
00:04:13,540 --> 00:04:19,418
plug into your<font color="#E5E5E5"> interior system and so</font>

105
00:04:17,620 --> 00:04:20,918
the<font color="#CCCCCC"> Bluetooth controller implements all</font>

106
00:04:19,418 --> 00:04:23,190
the lower layers<font color="#CCCCCC"> of</font><font color="#E5E5E5"> the Bluetooth</font>

107
00:04:20,918 --> 00:04:25,359
<font color="#E5E5E5">protocol and there's a</font><font color="#CCCCCC"> well-defined</font>

108
00:04:23,190 --> 00:04:27,909
interface this<font color="#E5E5E5"> is called the host</font>

109
00:04:25,360 --> 00:04:28,790
controller<font color="#CCCCCC"> interface which is</font><font color="#E5E5E5"> used for</font>

110
00:04:27,909 --> 00:04:32,180
<font color="#CCCCCC">communication</font>

111
00:04:28,790 --> 00:04:35,390
windows<font color="#CCCCCC"> two</font><font color="#E5E5E5"> components in this</font><font color="#CCCCCC"> Bluetooth</font>

112
00:04:32,180 --> 00:04:37,280
<font color="#CCCCCC">system the host</font><font color="#E5E5E5"> and the controller we</font>

113
00:04:35,390 --> 00:04:38,900
will<font color="#E5E5E5"> refer quite a lot today HDI</font>

114
00:04:37,280 --> 00:04:41,210
protocol it's really important for our

115
00:04:38,900 --> 00:04:43,669
<font color="#CCCCCC">work</font><font color="#E5E5E5"> and what you should keep in</font><font color="#CCCCCC"> mind is</font>

116
00:04:41,210 --> 00:04:45,650
that<font color="#E5E5E5"> this</font><font color="#CCCCCC"> is a protocol used locally</font><font color="#E5E5E5"> so</font>

117
00:04:43,670 --> 00:04:47,570
this will<font color="#E5E5E5"> never be transmitted over the</font>

118
00:04:45,650 --> 00:04:50,120
air it's<font color="#CCCCCC"> just used locally on one system</font>

119
00:04:47,570 --> 00:04:51,370
<font color="#CCCCCC">to communicate between</font><font color="#E5E5E5"> operating system</font>

120
00:04:50,120 --> 00:04:53,540
and a beautiful controller

121
00:04:51,370 --> 00:04:55,670
another interesting protocol is for

122
00:04:53,540 --> 00:04:59,420
example<font color="#E5E5E5"> the link manager protocol the</font>

123
00:04:55,670 --> 00:05:02,810
LMP this one is implemented inside<font color="#E5E5E5"> the</font>

124
00:04:59,420 --> 00:05:05,450
Bluetooth controller<font color="#E5E5E5"> and manages to link</font>

125
00:05:02,810 --> 00:05:07,310
to<font color="#E5E5E5"> other devices</font><font color="#CCCCCC"> so for</font><font color="#E5E5E5"> example it</font>

126
00:05:05,450 --> 00:05:09,890
manages connections set up to another

127
00:05:07,310 --> 00:05:11,720
<font color="#E5E5E5">device it also manages pairing with</font>

128
00:05:09,890 --> 00:05:14,659
other devices and<font color="#E5E5E5"> setting up all</font><font color="#CCCCCC"> the</font>

129
00:05:11,720 --> 00:05:16,940
<font color="#E5E5E5">crypto parameters you need to have an</font>

130
00:05:14,660 --> 00:05:18,050
encrypted channel between multiple

131
00:05:16,940 --> 00:05:21,500
<font color="#CCCCCC">devices so this one is actually</font>

132
00:05:18,050 --> 00:05:23,000
transmitted over the air<font color="#CCCCCC"> that's one</font><font color="#E5E5E5"> of</font>

133
00:05:21,500 --> 00:05:25,580
the main<font color="#CCCCCC"> differences between those two</font>

134
00:05:23,000 --> 00:05:27,920
<font color="#E5E5E5">protocols</font><font color="#CCCCCC"> what's also interesting is</font>

135
00:05:25,580 --> 00:05:30,380
that the<font color="#E5E5E5"> HDI protocol because it's</font>

136
00:05:27,920 --> 00:05:32,840
basically implemented on both sides<font color="#E5E5E5"> is</font>

137
00:05:30,380 --> 00:05:35,180
<font color="#E5E5E5">actually observable from the holes so if</font>

138
00:05:32,840 --> 00:05:38,750
you have a Linux machine<font color="#E5E5E5"> with Wireshark</font>

139
00:05:35,180 --> 00:05:40,490
installed you<font color="#E5E5E5"> can maybe just yeah open</font>

140
00:05:38,750 --> 00:05:41,600
up Wireshark<font color="#E5E5E5"> start capturing on your</font>

141
00:05:40,490 --> 00:05:44,120
<font color="#E5E5E5">Bluetooth interface and you will</font>

142
00:05:41,600 --> 00:05:46,610
<font color="#CCCCCC">actually</font><font color="#E5E5E5"> see HCI traffic however you</font>

143
00:05:44,120 --> 00:05:48,680
will probably<font color="#E5E5E5"> not see any LP traffic</font>

144
00:05:46,610 --> 00:05:50,000
because LMP is the protocol completely

145
00:05:48,680 --> 00:05:52,190
implemented<font color="#CCCCCC"> inside the Bluetooth</font>

146
00:05:50,000 --> 00:05:54,620
controller<font color="#E5E5E5"> it's also terminated on this</font>

147
00:05:52,190 --> 00:05:57,320
<font color="#E5E5E5">layer layer so it none of the LMP</font>

148
00:05:54,620 --> 00:05:59,150
packets will ever show<font color="#CCCCCC"> up</font><font color="#E5E5E5"> on the host</font>

149
00:05:57,320 --> 00:06:01,640
side and the host has no<font color="#E5E5E5"> control over</font>

150
00:05:59,150 --> 00:06:03,739
this protocol<font color="#E5E5E5"> and this is also one thing</font>

151
00:06:01,640 --> 00:06:05,030
I wanted<font color="#E5E5E5"> to change once I found out that</font>

152
00:06:03,740 --> 00:06:07,250
<font color="#E5E5E5">I can actually modify the firmware</font>

153
00:06:05,030 --> 00:06:08,630
because<font color="#E5E5E5"> this LMP protocol looks really</font>

154
00:06:07,250 --> 00:06:12,110
interesting<font color="#CCCCCC"> because it does pairing</font>

155
00:06:08,630 --> 00:06:14,600
crypto and so on<font color="#E5E5E5"> okay and one last</font><font color="#CCCCCC"> thing</font>

156
00:06:12,110 --> 00:06:16,460
to mention<font color="#E5E5E5"> on this slide is as I said</font><font color="#CCCCCC"> I</font>

157
00:06:14,600 --> 00:06:17,810
developed a<font color="#E5E5E5"> little experimentation</font>

158
00:06:16,460 --> 00:06:19,789
framework and the framework<font color="#E5E5E5"> actually</font>

159
00:06:17,810 --> 00:06:22,010
<font color="#E5E5E5">runs on my host computer which runs</font>

160
00:06:19,790 --> 00:06:24,800
Linux the framework is written in Python

161
00:06:22,010 --> 00:06:27,920
<font color="#CCCCCC">and it communicates with an Android</font>

162
00:06:24,800 --> 00:06:30,470
phone over<font color="#E5E5E5"> ADB so basically we have this</font>

163
00:06:27,920 --> 00:06:32,150
Android debug bridge<font color="#CCCCCC"> which we</font><font color="#E5E5E5"> use</font><font color="#CCCCCC"> to</font>

164
00:06:30,470 --> 00:06:33,620
communicate with<font color="#E5E5E5"> the Android phone and</font>

165
00:06:32,150 --> 00:06:36,469
<font color="#E5E5E5">also with the Bluetooth controller</font>

166
00:06:33,620 --> 00:06:38,150
inside the<font color="#E5E5E5"> Android phone just that</font><font color="#CCCCCC"> you</font>

167
00:06:36,470 --> 00:06:40,430
get<font color="#E5E5E5"> not confused</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> framework is</font>

168
00:06:38,150 --> 00:06:41,960
running on<font color="#CCCCCC"> the Linux machine but we will</font>

169
00:06:40,430 --> 00:06:42,650
<font color="#E5E5E5">use the Bluetooth controller in a phone</font>

170
00:06:41,960 --> 00:06:45,500
we

171
00:06:42,650 --> 00:06:47,388
also working that we have support<font color="#E5E5E5"> for</font>

172
00:06:45,500 --> 00:06:49,340
other<font color="#CCCCCC"> Bluetooth</font><font color="#E5E5E5"> chips so</font><font color="#CCCCCC"> that we for</font>

173
00:06:47,389 --> 00:06:52,940
<font color="#CCCCCC">example could also use</font><font color="#E5E5E5"> Bluetooth chips</font>

174
00:06:49,340 --> 00:06:58,280
directly<font color="#CCCCCC"> in our laptops</font><font color="#E5E5E5"> and also maybe</font>

175
00:06:52,940 --> 00:07:01,280
on the Raspberry Pi<font color="#CCCCCC"> okay now</font><font color="#E5E5E5"> I will</font>

176
00:06:58,280 --> 00:07:03,169
<font color="#CCCCCC">briefly explain or demonstrate all the</font>

177
00:07:01,280 --> 00:07:06,979
<font color="#E5E5E5">features and later we will go</font><font color="#CCCCCC"> into more</font>

178
00:07:03,169 --> 00:07:09,139
details<font color="#CCCCCC"> yeah the the</font><font color="#E5E5E5"> framework is named</font>

179
00:07:06,979 --> 00:07:11,300
internal do<font color="#E5E5E5"> it's already open</font><font color="#CCCCCC"> sourced</font>

180
00:07:09,139 --> 00:07:15,110
you can find it on<font color="#CCCCCC"> github if</font><font color="#E5E5E5"> you like to</font>

181
00:07:11,300 --> 00:07:17,930
try<font color="#E5E5E5"> it</font><font color="#CCCCCC"> it's probably currently still</font>

182
00:07:15,110 --> 00:07:19,729
supporting the<font color="#E5E5E5"> Nexus 5 best because this</font>

183
00:07:17,930 --> 00:07:22,070
was the phone I was initially developing

184
00:07:19,729 --> 00:07:24,650
it on but we<font color="#E5E5E5"> are adding support for</font>

185
00:07:22,070 --> 00:07:26,599
<font color="#E5E5E5">other platforms</font><font color="#CCCCCC"> as well</font><font color="#E5E5E5"> so if you have</font>

186
00:07:24,650 --> 00:07:28,460
<font color="#E5E5E5">some kind of Android phone you want to</font>

187
00:07:26,600 --> 00:07:30,260
try experimenting<font color="#E5E5E5"> with it and it has a</font>

188
00:07:28,460 --> 00:07:32,900
<font color="#CCCCCC">Broadcom chip in it</font><font color="#E5E5E5"> you can maybe start</font>

189
00:07:30,260 --> 00:07:35,000
<font color="#E5E5E5">and also come to us if you would like</font>

190
00:07:32,900 --> 00:07:37,400
and the first look support is there

191
00:07:35,000 --> 00:07:39,380
already so if you're not<font color="#E5E5E5"> doing</font>

192
00:07:37,400 --> 00:07:42,320
<font color="#E5E5E5">monitoring but just want to do some</font>

193
00:07:39,380 --> 00:07:44,780
special binary patching<font color="#E5E5E5"> within Bluetooth</font>

194
00:07:42,320 --> 00:07:47,000
<font color="#E5E5E5">that's already working</font><font color="#CCCCCC"> with</font><font color="#E5E5E5"> blues on</font>

195
00:07:44,780 --> 00:07:48,799
Linux<font color="#CCCCCC"> so yeah it's just</font><font color="#E5E5E5"> listed on the</font>

196
00:07:47,000 --> 00:07:54,470
<font color="#CCCCCC">website so I did some</font><font color="#E5E5E5"> pushes during the</font>

197
00:07:48,800 --> 00:07:55,760
last days with new features<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> also if</font>

198
00:07:54,470 --> 00:07:58,250
you're<font color="#E5E5E5"> really interested in how this</font>

199
00:07:55,760 --> 00:08:00,889
framework works internally after I

200
00:07:58,250 --> 00:08:03,199
finished my<font color="#CCCCCC"> thesis</font><font color="#E5E5E5"> I already gave a talk</font>

201
00:08:00,889 --> 00:08:05,229
at another<font color="#CCCCCC"> conference which goes more</font>

202
00:08:03,199 --> 00:08:07,460
into<font color="#E5E5E5"> the architecture</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> this framework</font>

203
00:08:05,229 --> 00:08:09,919
<font color="#E5E5E5">and there's a recording of this talk</font>

204
00:08:07,460 --> 00:08:12,380
down<font color="#E5E5E5"> at the bottom of the slide there's</font>

205
00:08:09,919 --> 00:08:13,760
also a link to<font color="#CCCCCC"> the recording so if</font>

206
00:08:12,380 --> 00:08:15,710
<font color="#E5E5E5">you're interested in</font><font color="#CCCCCC"> that maybe if you</font>

207
00:08:13,760 --> 00:08:18,190
want<font color="#E5E5E5"> start developing</font><font color="#CCCCCC"> using this</font>

208
00:08:15,710 --> 00:08:21,020
framework you<font color="#CCCCCC"> can also refer to</font><font color="#E5E5E5"> that</font>

209
00:08:18,190 --> 00:08:24,020
okay so in nutshell<font color="#CCCCCC"> we are</font><font color="#E5E5E5"> basically</font>

210
00:08:21,020 --> 00:08:26,240
<font color="#E5E5E5">using</font><font color="#CCCCCC"> vendor specific HCI commands</font><font color="#E5E5E5"> so</font>

211
00:08:24,020 --> 00:08:28,310
those are<font color="#E5E5E5"> HCI commands that are</font><font color="#CCCCCC"> only</font>

212
00:08:26,240 --> 00:08:30,889
implemented by the vendor in this case

213
00:08:28,310 --> 00:08:35,179
it's<font color="#CCCCCC"> Broadcom and Broadcom implemented</font>

214
00:08:30,889 --> 00:08:37,339
those<font color="#E5E5E5"> commands which we can now use we</font>

215
00:08:35,179 --> 00:08:39,770
<font color="#E5E5E5">found out how they are working and they</font>

216
00:08:37,339 --> 00:08:42,229
allow us<font color="#E5E5E5"> to</font><font color="#CCCCCC"> directly read and write</font><font color="#E5E5E5"> to</font>

217
00:08:39,770 --> 00:08:44,569
the address<font color="#E5E5E5"> space of the chip so this</font>

218
00:08:42,229 --> 00:08:46,580
was a big success once we found<font color="#E5E5E5"> that out</font>

219
00:08:44,570 --> 00:08:48,620
because the first<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> did was</font>

220
00:08:46,580 --> 00:08:50,209
basically<font color="#E5E5E5"> read out the firmware which</font>

221
00:08:48,620 --> 00:08:51,950
was a great starting point<font color="#CCCCCC"> because now I</font>

222
00:08:50,209 --> 00:08:54,469
could<font color="#E5E5E5"> start reverse engineering on this</font>

223
00:08:51,950 --> 00:08:56,480
<font color="#CCCCCC">firmware but we can also write to</font><font color="#E5E5E5"> the</font>

224
00:08:54,470 --> 00:09:01,040
<font color="#CCCCCC">address space</font><font color="#E5E5E5"> of course only</font><font color="#CCCCCC"> to the</font><font color="#E5E5E5"> RAM</font>

225
00:08:56,480 --> 00:09:03,470
not<font color="#CCCCCC"> theorem but as we found</font><font color="#E5E5E5"> out later</font>

226
00:09:01,040 --> 00:09:05,620
there's also the possibility<font color="#CCCCCC"> to</font><font color="#E5E5E5"> catch</font>

227
00:09:03,470 --> 00:09:08,360
certain<font color="#E5E5E5"> things temporarily in the ROM</font>

228
00:09:05,620 --> 00:09:10,640
<font color="#CCCCCC">Broadcom also has some features</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> that</font>

229
00:09:08,360 --> 00:09:12,830
and once we had<font color="#CCCCCC"> that I started</font>

230
00:09:10,640 --> 00:09:15,140
developing<font color="#CCCCCC"> the</font><font color="#E5E5E5"> framework so that</font><font color="#CCCCCC"> we can</font>

231
00:09:12,830 --> 00:09:17,780
use<font color="#E5E5E5"> that in our tools the framework is a</font>

232
00:09:15,140 --> 00:09:19,520
Python module you<font color="#E5E5E5"> can use it in your</font>

233
00:09:17,780 --> 00:09:21,260
<font color="#CCCCCC">Python scripts if you want to</font><font color="#E5E5E5"> script</font>

234
00:09:19,520 --> 00:09:23,390
something<font color="#E5E5E5"> or it also comes with a</font>

235
00:09:21,260 --> 00:09:26,360
<font color="#CCCCCC">command-line interface</font><font color="#E5E5E5"> if you just want</font>

236
00:09:23,390 --> 00:09:29,270
to do some hex stumps in the memory<font color="#E5E5E5"> call</font>

237
00:09:26,360 --> 00:09:31,580
certain functions in the memory<font color="#E5E5E5"> or what</font>

238
00:09:29,270 --> 00:09:33,770
we also developed as a first<font color="#E5E5E5"> plugin</font>

239
00:09:31,580 --> 00:09:36,140
basically was this LMP monitoring

240
00:09:33,770 --> 00:09:39,079
feature which can also be invoked from

241
00:09:36,140 --> 00:09:40,580
the<font color="#E5E5E5"> command line interface this LMP</font>

242
00:09:39,080 --> 00:09:42,590
monitoring feature is basically just<font color="#E5E5E5"> a</font>

243
00:09:40,580 --> 00:09:44,690
patch to<font color="#CCCCCC"> the firmware so that the LMP</font>

244
00:09:42,590 --> 00:09:46,730
traffic is duplicated inside the

245
00:09:44,690 --> 00:09:48,170
firmware<font color="#E5E5E5"> and also transported to the</font>

246
00:09:46,730 --> 00:09:50,330
host side so that<font color="#E5E5E5"> we can actually</font>

247
00:09:48,170 --> 00:09:53,719
<font color="#E5E5E5">monitor it in Wireshark and we could</font>

248
00:09:50,330 --> 00:09:56,060
also<font color="#E5E5E5"> now inject arbitrary LMP packets</font>

249
00:09:53,720 --> 00:09:57,770
into<font color="#CCCCCC"> existing Bluetooth connections so</font>

250
00:09:56,060 --> 00:09:59,479
if we have this phone<font color="#E5E5E5"> we pair it</font><font color="#CCCCCC"> with</font>

251
00:09:57,770 --> 00:10:02,090
<font color="#CCCCCC">another device</font><font color="#E5E5E5"> there's a Bluetooth</font>

252
00:09:59,480 --> 00:10:03,440
connection<font color="#CCCCCC"> now and we can see every LMP</font>

253
00:10:02,090 --> 00:10:05,960
packet<font color="#E5E5E5"> that is going back and forth</font>

254
00:10:03,440 --> 00:10:08,720
<font color="#CCCCCC">between those two phones and we can also</font>

255
00:10:05,960 --> 00:10:12,230
inject packets<font color="#E5E5E5"> which is quite nice for</font>

256
00:10:08,720 --> 00:10:15,140
<font color="#E5E5E5">doing some experiments on Bluetooth</font><font color="#CCCCCC"> then</font>

257
00:10:12,230 --> 00:10:17,240
we also went<font color="#E5E5E5"> one step</font><font color="#CCCCCC"> further we thought</font>

258
00:10:15,140 --> 00:10:19,370
maybe it's also interesting<font color="#E5E5E5"> to look at</font>

259
00:10:17,240 --> 00:10:21,830
some old<font color="#E5E5E5"> Bluetooth phone abilities that</font>

260
00:10:19,370 --> 00:10:24,140
<font color="#E5E5E5">we're around and see if we</font><font color="#CCCCCC"> can actually</font>

261
00:10:21,830 --> 00:10:26,210
implement a<font color="#E5E5E5"> proof-of-concept because now</font>

262
00:10:24,140 --> 00:10:28,189
we<font color="#CCCCCC"> can</font><font color="#E5E5E5"> actually modify the firmware we</font>

263
00:10:26,210 --> 00:10:31,610
can take those vulnerabilities<font color="#E5E5E5"> that were</font>

264
00:10:28,190 --> 00:10:34,250
<font color="#E5E5E5">discovered which was very hard to ride</font>

265
00:10:31,610 --> 00:10:36,050
<font color="#CCCCCC">pox</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> it because Bluetooth is a closed</font>

266
00:10:34,250 --> 00:10:37,400
<font color="#E5E5E5">source system at least a part</font><font color="#CCCCCC"> that is</font>

267
00:10:36,050 --> 00:10:39,410
implemented inside<font color="#CCCCCC"> a Bluetooth</font>

268
00:10:37,400 --> 00:10:40,819
controller<font color="#E5E5E5"> now that we can modify the</font>

269
00:10:39,410 --> 00:10:43,160
Bluetooth controller firmware we can

270
00:10:40,820 --> 00:10:46,220
also<font color="#E5E5E5"> maybe try to modify it so that</font><font color="#CCCCCC"> it</font>

271
00:10:43,160 --> 00:10:48,439
exploits some vulnerability and the one

272
00:10:46,220 --> 00:10:50,150
I choose<font color="#E5E5E5"> I will</font><font color="#CCCCCC"> demonstrate later was</font>

273
00:10:48,440 --> 00:10:52,520
<font color="#CCCCCC">the fixed coordinate invalid kerf attack</font>

274
00:10:50,150 --> 00:10:55,579
that was released<font color="#E5E5E5"> right after I finished</font>

275
00:10:52,520 --> 00:10:57,170
my<font color="#CCCCCC"> thesis last summer</font><font color="#E5E5E5"> and basically</font>

276
00:10:55,580 --> 00:10:58,760
<font color="#CCCCCC">allow us to do a man the middle on</font><font color="#E5E5E5"> the</font>

277
00:10:57,170 --> 00:10:59,300
pairing sequence but we will come to

278
00:10:58,760 --> 00:11:02,240
that later

279
00:10:59,300 --> 00:11:04,699
and at some point finally<font color="#E5E5E5"> we also found</font>

280
00:11:02,240 --> 00:11:07,430
our own little crash of<font color="#E5E5E5"> the firmware so</font>

281
00:11:04,700 --> 00:11:08,060
we were<font color="#E5E5E5"> basically able to remotely crash</font>

282
00:11:07,430 --> 00:11:10,439
the

283
00:11:08,060 --> 00:11:13,500
the family<font color="#E5E5E5"> running on this beautiful</font>

284
00:11:10,440 --> 00:11:16,170
controller<font color="#CCCCCC"> without prior authentication</font>

285
00:11:13,500 --> 00:11:18,870
which is a DOS<font color="#CCCCCC"> attack on its own and</font>

286
00:11:16,170 --> 00:11:21,060
after some messing around with<font color="#CCCCCC"> that we</font>

287
00:11:18,870 --> 00:11:22,710
also got some limited code execution on

288
00:11:21,060 --> 00:11:25,170
some of the chips<font color="#E5E5E5"> it's not a full</font>

289
00:11:22,710 --> 00:11:27,390
<font color="#E5E5E5">control of the chip but it's interesting</font>

290
00:11:25,170 --> 00:11:29,160
<font color="#E5E5E5">nevertheless we can trigger some code</font>

291
00:11:27,390 --> 00:11:35,640
paths<font color="#E5E5E5"> that are not meant to be triggered</font>

292
00:11:29,160 --> 00:11:37,410
over-the-air<font color="#CCCCCC"> yep yep so</font><font color="#E5E5E5"> the reversing is</font>

293
00:11:35,640 --> 00:11:40,470
actually<font color="#E5E5E5"> very hard I think you spent</font>

294
00:11:37,410 --> 00:11:42,750
like<font color="#E5E5E5"> half a year</font><font color="#CCCCCC"> most of the time just</font>

295
00:11:40,470 --> 00:11:45,870
<font color="#CCCCCC">looking in either</font><font color="#E5E5E5"> staring on hex code</font>

296
00:11:42,750 --> 00:11:49,770
and the problem here<font color="#E5E5E5"> is</font><font color="#CCCCCC"> that to save</font>

297
00:11:45,870 --> 00:11:52,080
space<font color="#E5E5E5"> there is really nothing that is in</font>

298
00:11:49,770 --> 00:11:56,040
there there is<font color="#E5E5E5"> no strings no debug</font>

299
00:11:52,080 --> 00:11:59,580
symbols nothing<font color="#E5E5E5"> so it's not obfuscated</font>

300
00:11:56,040 --> 00:12:01,500
but it's also very very<font color="#E5E5E5"> strange stuff</font>

301
00:11:59,580 --> 00:12:03,930
<font color="#CCCCCC">going</font><font color="#E5E5E5"> on there</font>

302
00:12:01,500 --> 00:12:05,790
there is the documentation so there's

303
00:12:03,930 --> 00:12:07,319
the Bluetooth standard<font color="#E5E5E5"> that's a good</font>

304
00:12:05,790 --> 00:12:10,650
thing I<font color="#E5E5E5"> mean they implement a standard</font>

305
00:12:07,320 --> 00:12:14,250
<font color="#E5E5E5">but they implement like</font><font color="#CCCCCC"> modern so almost</font>

306
00:12:10,650 --> 00:12:16,740
<font color="#CCCCCC">3000</font><font color="#E5E5E5"> pages of standard plus their own</font>

307
00:12:14,250 --> 00:12:19,650
extensions and then<font color="#E5E5E5"> you try to dig for</font>

308
00:12:16,740 --> 00:12:22,140
some strings and numbers and whatever

309
00:12:19,650 --> 00:12:24,900
and then<font color="#CCCCCC"> you</font><font color="#E5E5E5"> start naming functions so</font>

310
00:12:22,140 --> 00:12:27,390
<font color="#CCCCCC">blah blah blah function doing something</font>

311
00:12:24,900 --> 00:12:29,189
with I don't<font color="#CCCCCC"> know maybe LM P maybe this</font>

312
00:12:27,390 --> 00:12:33,270
is encryption<font color="#E5E5E5"> it has like this</font>

313
00:12:29,190 --> 00:12:35,220
<font color="#E5E5E5">exorbitant</font><font color="#CCCCCC"> okay and then then you</font><font color="#E5E5E5"> go</font>

314
00:12:33,270 --> 00:12:38,790
there so what<font color="#E5E5E5"> you can see in this figure</font>

315
00:12:35,220 --> 00:12:40,560
over here's something that<font color="#E5E5E5"> I produced</font>

316
00:12:38,790 --> 00:12:43,349
with code card which tries<font color="#CCCCCC"> to locate</font>

317
00:12:40,560 --> 00:12:46,079
modules and then calls within what<font color="#CCCCCC"> is -</font>

318
00:12:43,350 --> 00:12:48,390
just<font color="#E5E5E5"> yeah give</font><font color="#CCCCCC"> me a starting point which</font>

319
00:12:46,080 --> 00:12:50,820
<font color="#E5E5E5">pipes could be interesting which parts</font>

320
00:12:48,390 --> 00:12:53,730
get more<font color="#CCCCCC"> cause but it's still very messy</font>

321
00:12:50,820 --> 00:12:55,500
so I don't know like half a year<font color="#CCCCCC"> after</font>

322
00:12:53,730 --> 00:12:57,360
it looked like this<font color="#E5E5E5"> yeah we have</font><font color="#CCCCCC"> some</font>

323
00:12:55,500 --> 00:12:58,860
pointer to get a<font color="#E5E5E5"> connections track that</font>

324
00:12:57,360 --> 00:13:00,090
one<font color="#CCCCCC"> is very important</font><font color="#E5E5E5"> that's</font><font color="#CCCCCC"> an all the</font>

325
00:12:58,860 --> 00:13:03,840
important functions<font color="#CCCCCC"> we quality</font>

326
00:13:00,090 --> 00:13:06,510
connections tracks<font color="#CCCCCC"> then there</font><font color="#E5E5E5"> is like</font>

327
00:13:03,840 --> 00:13:08,040
lots of<font color="#CCCCCC"> vendor</font><font color="#E5E5E5"> specific</font><font color="#CCCCCC"> HDI commas not</font>

328
00:13:06,510 --> 00:13:11,310
just to read<font color="#E5E5E5"> and write around but they</font>

329
00:13:08,040 --> 00:13:13,560
are undocumented<font color="#E5E5E5"> and then you have</font>

330
00:13:11,310 --> 00:13:15,900
<font color="#E5E5E5">something like we know if we change to</font>

331
00:13:13,560 --> 00:13:18,420
<font color="#E5E5E5">buffer year then in the end the frame</font>

332
00:13:15,900 --> 00:13:20,699
that<font color="#E5E5E5"> we will send will contain the</font><font color="#CCCCCC"> parts</font>

333
00:13:18,420 --> 00:13:21,449
of this buffer so it's like in the end

334
00:13:20,700 --> 00:13:23,010
we<font color="#E5E5E5"> will</font><font color="#CCCCCC"> send</font>

335
00:13:21,450 --> 00:13:24,960
<font color="#CCCCCC">and</font><font color="#E5E5E5"> P buffer with this but it's really</font>

336
00:13:23,010 --> 00:13:27,780
it's<font color="#E5E5E5"> strange</font><font color="#CCCCCC"> so that's that's what we</font>

337
00:13:24,960 --> 00:13:29,610
did<font color="#E5E5E5"> for quite a lot of time</font><font color="#CCCCCC"> and that's</font>

338
00:13:27,780 --> 00:13:32,430
what I also<font color="#CCCCCC"> continued</font><font color="#E5E5E5"> just</font><font color="#CCCCCC"> staring on</font>

339
00:13:29,610 --> 00:13:36,450
this spending<font color="#CCCCCC"> for</font><font color="#E5E5E5"> even it's it's it's</font>

340
00:13:32,430 --> 00:13:37,829
great<font color="#CCCCCC"> and</font><font color="#E5E5E5"> then it was almost almost</font>

341
00:13:36,450 --> 00:13:41,550
Christmas

342
00:13:37,830 --> 00:13:43,350
<font color="#E5E5E5">and</font><font color="#CCCCCC"> people were like asking me</font><font color="#E5E5E5"> yes but</font>

343
00:13:41,550 --> 00:13:45,750
does it work<font color="#E5E5E5"> on the newest device and</font>

344
00:13:43,350 --> 00:13:48,420
then I said yeah<font color="#E5E5E5"> okay maybe I should get</font>

345
00:13:45,750 --> 00:13:52,740
the newest device and the<font color="#CCCCCC"> issued years</font>

346
00:13:48,420 --> 00:13:55,800
if you if you try to get something<font color="#E5E5E5"> with</font>

347
00:13:52,740 --> 00:13:58,590
a new<font color="#E5E5E5"> Bluetooth chip then you need to</font>

348
00:13:55,800 --> 00:14:00,540
get the newest smartphone<font color="#E5E5E5"> which you then</font>

349
00:13:58,590 --> 00:14:03,840
need to<font color="#CCCCCC"> route and everything that's a</font>

350
00:14:00,540 --> 00:14:05,760
bit risky<font color="#CCCCCC"> this</font><font color="#E5E5E5"> is what I did not</font><font color="#CCCCCC"> want to</font>

351
00:14:03,840 --> 00:14:07,590
do so<font color="#CCCCCC"> it's it's very expensive</font><font color="#E5E5E5"> but then</font>

352
00:14:05,760 --> 00:14:09,960
I found<font color="#E5E5E5"> out</font><font color="#CCCCCC"> there's</font><font color="#E5E5E5"> development kits</font>

353
00:14:07,590 --> 00:14:15,390
<font color="#E5E5E5">they are just something like 50 euros</font>

354
00:14:09,960 --> 00:14:17,100
and they have a very recent<font color="#E5E5E5"> chip</font><font color="#CCCCCC"> rockem</font>

355
00:14:15,390 --> 00:14:18,480
has been acquired<font color="#CCCCCC"> by</font><font color="#E5E5E5"> Cyprus so it's now</font>

356
00:14:17,100 --> 00:14:20,970
called Cyprus something instead of

357
00:14:18,480 --> 00:14:23,790
<font color="#E5E5E5">frotcom something but it's still the</font>

358
00:14:20,970 --> 00:14:26,280
<font color="#E5E5E5">same mechanisms</font><font color="#CCCCCC"> I had that on my table</font>

359
00:14:23,790 --> 00:14:29,640
<font color="#CCCCCC">and then I was</font><font color="#E5E5E5"> wondering so this these</font>

360
00:14:26,280 --> 00:14:33,329
chips they have an IOT application on<font color="#CCCCCC"> it</font>

361
00:14:29,640 --> 00:14:35,610
so they<font color="#CCCCCC"> are IOT application emulation</font>

362
00:14:33,330 --> 00:14:37,650
<font color="#E5E5E5">framework so you can start like a</font>

363
00:14:35,610 --> 00:14:40,650
temperature sensor app on this and it

364
00:14:37,650 --> 00:14:42,480
has also descenders and then there's

365
00:14:40,650 --> 00:14:44,640
this app running on it and<font color="#CCCCCC"> I</font><font color="#E5E5E5"> was asking</font>

366
00:14:42,480 --> 00:14:47,490
myself like<font color="#E5E5E5"> okay if there is an apron on</font>

367
00:14:44,640 --> 00:14:49,560
it<font color="#E5E5E5"> is it using the same basic operating</font>

368
00:14:47,490 --> 00:14:50,790
system or<font color="#E5E5E5"> something</font><font color="#CCCCCC"> different and I</font>

369
00:14:49,560 --> 00:14:53,369
looked into the assembly that<font color="#CCCCCC"> I</font>

370
00:14:50,790 --> 00:14:55,560
extracted<font color="#CCCCCC"> with the reed</font><font color="#E5E5E5"> ROM and so on</font>

371
00:14:53,370 --> 00:14:57,060
and I found<font color="#E5E5E5"> out threads are created the</font>

372
00:14:55,560 --> 00:14:59,880
same<font color="#CCCCCC"> way</font>

373
00:14:57,060 --> 00:15:01,560
and so there must<font color="#E5E5E5"> be some symbols and</font>

374
00:14:59,880 --> 00:15:04,770
then I looked a bit<font color="#E5E5E5"> further and then I</font>

375
00:15:01,560 --> 00:15:07,800
found<font color="#E5E5E5"> a very big symbol table having</font>

376
00:15:04,770 --> 00:15:10,079
<font color="#CCCCCC">like eleven thousand function names or</font>

377
00:15:07,800 --> 00:15:14,579
something<font color="#CCCCCC"> so almost everything</font><font color="#E5E5E5"> was named</font>

378
00:15:10,080 --> 00:15:16,530
so it was a bit more like this you

379
00:15:14,580 --> 00:15:18,530
<font color="#E5E5E5">finally have</font><font color="#CCCCCC"> the correct names</font><font color="#E5E5E5"> and it's</font>

380
00:15:16,530 --> 00:15:22,589
also very<font color="#E5E5E5"> helpful</font><font color="#CCCCCC"> I mean we have more</font>

381
00:15:18,530 --> 00:15:25,110
more<font color="#CCCCCC"> code some older ones</font><font color="#E5E5E5"> and so on but</font>

382
00:15:22,590 --> 00:15:27,600
<font color="#E5E5E5">you will still get an idea so</font><font color="#CCCCCC"> you can do</font>

383
00:15:25,110 --> 00:15:29,160
some build if it's not always<font color="#E5E5E5"> that</font><font color="#CCCCCC"> good</font>

384
00:15:27,600 --> 00:15:31,050
what you get as a result but at least

385
00:15:29,160 --> 00:15:33,150
something<font color="#E5E5E5"> and if you find similar</font>

386
00:15:31,050 --> 00:15:35,290
<font color="#E5E5E5">functions and have a starting</font><font color="#CCCCCC"> point and</font>

387
00:15:33,150 --> 00:15:38,350
you can<font color="#E5E5E5"> give things similar</font>

388
00:15:35,290 --> 00:15:40,300
James<font color="#E5E5E5"> and also get</font><font color="#CCCCCC"> a differences and</font>

389
00:15:38,350 --> 00:15:44,079
there's<font color="#E5E5E5"> really funny names like this</font>

390
00:15:40,300 --> 00:15:45,969
<font color="#CCCCCC">super duper peak</font><font color="#E5E5E5"> poke whatever it's</font>

391
00:15:44,079 --> 00:15:47,589
really<font color="#CCCCCC"> names</font><font color="#E5E5E5"> like this and yes that's</font>

392
00:15:45,970 --> 00:15:50,380
that's<font color="#CCCCCC"> original friend my</font><font color="#E5E5E5"> name is what</font>

393
00:15:47,589 --> 00:15:53,829
<font color="#E5E5E5">you can see</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> also some of them are</font>

394
00:15:50,380 --> 00:15:56,290
not<font color="#E5E5E5"> that nice so this th</font><font color="#CCCCCC"> mlmp TX it's</font>

395
00:15:53,829 --> 00:16:00,130
just what we called<font color="#CCCCCC"> send LMP package I</font>

396
00:15:56,290 --> 00:16:03,730
don't know but at<font color="#E5E5E5"> least it's</font><font color="#CCCCCC"> Olympics so</font>

397
00:16:00,130 --> 00:16:08,079
that's what you<font color="#E5E5E5"> can get from this yeah</font>

398
00:16:03,730 --> 00:16:10,720
so lots of fun<font color="#CCCCCC"> the next part is now that</font>

399
00:16:08,079 --> 00:16:13,779
<font color="#CCCCCC">you have an idea of</font><font color="#E5E5E5"> what is there it's</font>

400
00:16:10,720 --> 00:16:16,420
very<font color="#E5E5E5"> nice to write patches and see so</font>

401
00:16:13,779 --> 00:16:19,149
everything that<font color="#E5E5E5"> Dennis made was writing</font>

402
00:16:16,420 --> 00:16:21,099
patches in assembly which<font color="#CCCCCC"> is still</font>

403
00:16:19,149 --> 00:16:26,350
something<font color="#E5E5E5"> so you don't</font><font color="#CCCCCC"> have to write hex</font>

404
00:16:21,100 --> 00:16:28,509
code<font color="#CCCCCC"> but see is even nicer and we have</font>

405
00:16:26,350 --> 00:16:30,970
<font color="#CCCCCC">for Wi-Fi this other framework called</font>

406
00:16:28,509 --> 00:16:32,709
next<font color="#CCCCCC"> one and it's</font><font color="#E5E5E5"> very generic binary</font>

407
00:16:30,970 --> 00:16:34,420
patching<font color="#E5E5E5"> and we currently have this</font>

408
00:16:32,709 --> 00:16:37,689
branch<font color="#CCCCCC"> bluetooth</font><font color="#E5E5E5"> work in progress</font>

409
00:16:34,420 --> 00:16:40,000
<font color="#CCCCCC">monkey top where</font><font color="#E5E5E5"> we have the first patch</font>

410
00:16:37,690 --> 00:16:41,920
examples for<font color="#CCCCCC"> C but that one needs</font><font color="#E5E5E5"> to be</font>

411
00:16:40,000 --> 00:16:44,139
<font color="#E5E5E5">extended so it's working progress and</font>

412
00:16:41,920 --> 00:16:49,569
then you can also write some<font color="#CCCCCC"> patches and</font>

413
00:16:44,139 --> 00:16:55,600
see so yeah you can add I<font color="#E5E5E5"> don't know</font>

414
00:16:49,569 --> 00:16:59,319
<font color="#E5E5E5">aliens go it</font><font color="#CCCCCC"> whatever and the next part</font>

415
00:16:55,600 --> 00:17:02,949
<font color="#E5E5E5">is that I then stumbled about that</font>

416
00:16:59,319 --> 00:17:05,589
there's on Apple devices<font color="#CCCCCC"> on the older</font>

417
00:17:02,949 --> 00:17:08,168
ones you have the possibility to do LMP

418
00:17:05,589 --> 00:17:11,589
monitoring and they have<font color="#E5E5E5"> prot con ships</font>

419
00:17:08,169 --> 00:17:14,740
<font color="#E5E5E5">and it just works and I was like they</font>

420
00:17:11,589 --> 00:17:16,389
probably don't<font color="#CCCCCC"> to like an assembly page</font>

421
00:17:14,740 --> 00:17:18,250
like you did<font color="#E5E5E5"> maybe they do it</font>

422
00:17:16,390 --> 00:17:19,900
<font color="#E5E5E5">differently</font><font color="#CCCCCC"> I think this</font><font color="#E5E5E5"> was the point</font>

423
00:17:18,250 --> 00:17:21,760
like where you would have<font color="#CCCCCC"> almost</font><font color="#E5E5E5"> killed</font>

424
00:17:19,900 --> 00:17:23,829
me because<font color="#E5E5E5"> it did so much things and</font>

425
00:17:21,760 --> 00:17:27,099
then I just<font color="#E5E5E5"> made it happening and within</font>

426
00:17:23,829 --> 00:17:29,440
one or two weeks<font color="#CCCCCC"> so what I found out</font>

427
00:17:27,099 --> 00:17:33,360
there's a<font color="#E5E5E5"> Diagnostics protocol and</font>

428
00:17:29,440 --> 00:17:37,270
there's some<font color="#E5E5E5"> parts left in this order</font>

429
00:17:33,360 --> 00:17:39,610
<font color="#CCCCCC">apple bluetooth make it longer stuff but</font>

430
00:17:37,270 --> 00:17:42,120
then of<font color="#CCCCCC"> course everything</font><font color="#E5E5E5"> else that is</font>

431
00:17:39,610 --> 00:17:44,620
need to<font color="#E5E5E5"> be known is within this</font>

432
00:17:42,120 --> 00:17:48,010
<font color="#E5E5E5">emulation</font><font color="#CCCCCC"> kit firmware with all the</font>

433
00:17:44,620 --> 00:17:48,909
names and symbols and<font color="#CCCCCC"> what we can do now</font>

434
00:17:48,010 --> 00:17:51,940
is<font color="#E5E5E5"> we</font>

435
00:17:48,910 --> 00:17:55,440
can use a specific<font color="#CCCCCC"> program diagnostic</font>

436
00:17:51,940 --> 00:17:58,300
protocol for the LMP monitor that again

437
00:17:55,440 --> 00:17:59,920
<font color="#E5E5E5">needs another page to the driver but we</font>

438
00:17:58,300 --> 00:18:04,480
already<font color="#E5E5E5"> need to patch the</font><font color="#CCCCCC"> Android</font><font color="#E5E5E5"> driver</font>

439
00:17:59,920 --> 00:18:06,160
so it doesn't matter<font color="#CCCCCC"> it does not</font><font color="#E5E5E5"> work</font>

440
00:18:04,480 --> 00:18:08,350
out of the box of<font color="#E5E5E5"> interest have four</font>

441
00:18:06,160 --> 00:18:12,820
<font color="#E5E5E5">fewer Android versions we have to patch</font>

442
00:18:08,350 --> 00:18:17,530
this<font color="#E5E5E5"> or Android 607 and what is it</font><font color="#CCCCCC"> Linux</font>

443
00:18:12,820 --> 00:18:19,450
OS 14<font color="#CCCCCC"> I was doing those patches</font><font color="#E5E5E5"> and so</font>

444
00:18:17,530 --> 00:18:21,129
it works<font color="#E5E5E5"> for any device with a</font><font color="#CCCCCC"> protocol</font>

445
00:18:19,450 --> 00:18:24,700
chip running one of those three

446
00:18:21,130 --> 00:18:26,320
<font color="#E5E5E5">operating systems instead of having the</font>

447
00:18:24,700 --> 00:18:28,420
assembly<font color="#E5E5E5"> patch on Palouse it does not</font>

448
00:18:26,320 --> 00:18:30,669
<font color="#E5E5E5">work because blues is ignoring the</font>

449
00:18:28,420 --> 00:18:33,160
diagnostic protocol type and I still

450
00:18:30,670 --> 00:18:36,100
didn't get enough time to<font color="#E5E5E5"> patch around</font>

451
00:18:33,160 --> 00:18:40,260
<font color="#E5E5E5">this but yeah I can</font><font color="#CCCCCC"> I can demo it so</font>

452
00:18:36,100 --> 00:18:43,429
this<font color="#E5E5E5"> will be the first demo if it works</font>

453
00:18:40,260 --> 00:18:43,430
[Music]

454
00:19:12,090 --> 00:19:33,739
<font color="#CCCCCC">find it's</font><font color="#E5E5E5"> a bit too small Wow</font><font color="#CCCCCC"> shoved</font><font color="#E5E5E5"> him</font>

455
00:19:26,639 --> 00:19:33,738
<font color="#CCCCCC">I</font><font color="#E5E5E5"> said no I need a best man</font>

456
00:19:43,460 --> 00:19:46,630
[Music]

457
00:19:55,060 --> 00:20:08,060
yeah that one works yep<font color="#E5E5E5"> so that's the</font>

458
00:20:04,610 --> 00:20:10,100
first nice thing right now<font color="#E5E5E5"> so it's</font>

459
00:20:08,060 --> 00:20:14,590
actually<font color="#E5E5E5"> out of detecting what what film</font>

460
00:20:10,100 --> 00:20:17,120
where is running on my<font color="#E5E5E5"> Android phone so</font>

461
00:20:14,590 --> 00:20:20,720
<font color="#E5E5E5">it's just loading</font><font color="#CCCCCC"> everything all</font>

462
00:20:17,120 --> 00:20:33,260
features<font color="#CCCCCC"> that are supported and now I</font>

463
00:20:20,720 --> 00:20:35,240
can say money<font color="#E5E5E5"> all right yep</font><font color="#CCCCCC"> I can just</font>

464
00:20:33,260 --> 00:20:36,950
do some scanning<font color="#E5E5E5"> here so it's like the</font>

465
00:20:35,240 --> 00:20:53,750
point in time they maybe<font color="#E5E5E5"> want to turn</font>

466
00:20:36,950 --> 00:21:00,290
off<font color="#CCCCCC"> your</font><font color="#E5E5E5"> Bluetooth</font><font color="#CCCCCC"> and that's great once</font>

467
00:20:53,750 --> 00:21:02,720
again yes<font color="#E5E5E5"> so that's the cool stuff here</font>

468
00:21:00,290 --> 00:21:09,100
<font color="#E5E5E5">you can see on the right hand side</font><font color="#CCCCCC"> that</font>

469
00:21:02,720 --> 00:21:09,100
is doing some<font color="#CCCCCC"> nmp commands here</font>

470
00:21:14,119 --> 00:21:20,820
so it's just decoding<font color="#E5E5E5"> everything you</font>

471
00:21:17,429 --> 00:21:22,739
could imagine<font color="#CCCCCC"> so it's just LMP and the</font>

472
00:21:20,820 --> 00:21:26,489
cool part here is that<font color="#CCCCCC"> it's now also</font>

473
00:21:22,739 --> 00:21:28,169
<font color="#E5E5E5">working for Bluetooth le so it's</font>

474
00:21:26,489 --> 00:21:30,480
Bluetooth<font color="#E5E5E5"> le and classic Bluetooth</font>

475
00:21:28,169 --> 00:21:37,070
before we just<font color="#CCCCCC"> had</font><font color="#E5E5E5"> LMP now we have the</font>

476
00:21:30,480 --> 00:21:39,299
<font color="#E5E5E5">the other</font><font color="#CCCCCC"> le</font><font color="#E5E5E5"> lower layer</font><font color="#CCCCCC"> - yeah so</font>

477
00:21:37,070 --> 00:21:40,710
that's the first part so if you compile

478
00:21:39,299 --> 00:21:44,519
everything<font color="#E5E5E5"> it</font><font color="#CCCCCC"> should look</font><font color="#E5E5E5"> like this in</font>

479
00:21:40,710 --> 00:21:46,619
<font color="#E5E5E5">the end pretty easy to</font><font color="#CCCCCC"> use one funny</font>

480
00:21:44,519 --> 00:21:49,320
part here is that<font color="#CCCCCC"> the MAC address is</font>

481
00:21:46,619 --> 00:21:50,939
<font color="#E5E5E5">just</font><font color="#CCCCCC"> four bytes because</font><font color="#E5E5E5"> the first two</font>

482
00:21:49,320 --> 00:21:53,340
bytes don't matter in Bluetooth<font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font>

483
00:21:50,940 --> 00:21:54,720
if<font color="#E5E5E5"> you do an l2 ping in blue - if you</font>

484
00:21:53,340 --> 00:21:58,559
can't just<font color="#E5E5E5"> leave out the first two bytes</font>

485
00:21:54,720 --> 00:22:01,300
<font color="#E5E5E5">and you can reach the device so that's</font>

486
00:21:58,559 --> 00:22:04,780
<font color="#E5E5E5">it for the first demo</font>

487
00:22:01,300 --> 00:22:04,780
[Music]

488
00:22:09,120 --> 00:22:12,219
[Music]

489
00:22:16,950 --> 00:22:22,280
Oh<font color="#CCCCCC"> preset</font>

490
00:22:31,060 --> 00:22:34,600
for<font color="#E5E5E5"> some Mannix</font>

491
00:22:46,180 --> 00:22:49,469
[Music]

492
00:23:10,919 --> 00:23:12,950
Oh

493
00:23:13,830 --> 00:23:16,699
<font color="#CCCCCC">you</font><font color="#E5E5E5"> didn't know</font>

494
00:23:22,519 --> 00:23:27,349
okay I<font color="#CCCCCC"> think</font><font color="#E5E5E5"> we you broke it</font>

495
00:23:51,470 --> 00:23:58,580
<font color="#CCCCCC">all right let's phantom</font>

496
00:24:10,320 --> 00:24:13,520
[Music]

497
00:24:53,220 --> 00:25:01,360
oops we<font color="#CCCCCC"> crashed it yep so back to the</font>

498
00:24:58,450 --> 00:25:05,710
presentation<font color="#CCCCCC"> yeah so that</font><font color="#E5E5E5"> was this part</font>

499
00:25:01,360 --> 00:25:08,020
of the demo<font color="#CCCCCC"> now everything about</font>

500
00:25:05,710 --> 00:25:10,870
<font color="#E5E5E5">monitoring on a</font><font color="#CCCCCC"> proteome</font><font color="#E5E5E5"> chip is now</font>

501
00:25:08,020 --> 00:25:13,450
independent from any<font color="#E5E5E5"> assembly patches</font>

502
00:25:10,870 --> 00:25:16,540
and it should<font color="#CCCCCC"> work on quite</font><font color="#E5E5E5"> a lot of</font>

503
00:25:13,450 --> 00:25:17,980
<font color="#E5E5E5">devices so my list is pretty short right</font>

504
00:25:16,540 --> 00:25:20,170
<font color="#CCCCCC">now if you want to try it</font>

505
00:25:17,980 --> 00:25:22,090
<font color="#E5E5E5">I will also help you and you</font><font color="#CCCCCC"> can just</font>

506
00:25:20,170 --> 00:25:32,650
write messages and make<font color="#E5E5E5"> a github issue</font>

507
00:25:22,090 --> 00:25:37,270
and so on if you have questions so it's

508
00:25:32,650 --> 00:25:39,010
doing funny things with me<font color="#CCCCCC"> so there's</font>

509
00:25:37,270 --> 00:25:43,120
pretty a lot<font color="#E5E5E5"> of reasons why</font><font color="#CCCCCC"> we really</font>

510
00:25:39,010 --> 00:25:46,090
<font color="#CCCCCC">like</font><font color="#E5E5E5"> Bluetooth or not and</font><font color="#CCCCCC"> Dennis is</font><font color="#E5E5E5"> now</font>

511
00:25:43,120 --> 00:25:48,699
going<font color="#E5E5E5"> to tell you what oh okay I</font>

512
00:25:46,090 --> 00:25:53,939
<font color="#E5E5E5">continue</font><font color="#CCCCCC"> okay so I also like Bluetooth</font>

513
00:25:48,700 --> 00:25:53,940
for that because it's really<font color="#E5E5E5"> broken</font>

514
00:25:55,230 --> 00:26:06,120
<font color="#CCCCCC">first</font><font color="#E5E5E5"> of all even if you</font><font color="#CCCCCC"> I if you are</font>

515
00:26:01,720 --> 00:26:12,820
not discoverable<font color="#CCCCCC"> it's</font><font color="#E5E5E5"> always possible</font>

516
00:26:06,120 --> 00:26:15,639
<font color="#CCCCCC">that someone can connect to you</font><font color="#E5E5E5"> so if so</font>

517
00:26:12,820 --> 00:26:17,230
you<font color="#E5E5E5"> can just not</font><font color="#CCCCCC"> be visible</font><font color="#E5E5E5"> but as long</font>

518
00:26:15,640 --> 00:26:18,760
<font color="#CCCCCC">as I know you make</font><font color="#E5E5E5"> address I can just</font>

519
00:26:17,230 --> 00:26:21,520
send a packet<font color="#CCCCCC"> to you and and of course</font>

520
00:26:18,760 --> 00:26:23,890
<font color="#CCCCCC">you can say yes I do not want to like</font>

521
00:26:21,520 --> 00:26:27,100
accept connections<font color="#E5E5E5"> and so on but</font>

522
00:26:23,890 --> 00:26:28,929
first of all<font color="#E5E5E5"> it's not</font><font color="#CCCCCC"> that you're not</font>

523
00:26:27,100 --> 00:26:31,360
appearing in a scan does not mean that

524
00:26:28,929 --> 00:26:35,020
your phone<font color="#CCCCCC"> is like</font><font color="#E5E5E5"> blocking all requests</font>

525
00:26:31,360 --> 00:26:37,240
and<font color="#E5E5E5"> that's pretty weird</font><font color="#CCCCCC"> and you can also</font>

526
00:26:35,020 --> 00:26:39,220
do some sniffing in the air and then

527
00:26:37,240 --> 00:26:41,350
<font color="#E5E5E5">guess to make</font><font color="#CCCCCC"> addresses it's a bit</font><font color="#E5E5E5"> more</font>

528
00:26:39,220 --> 00:26:42,850
complicated<font color="#CCCCCC"> then then in Wi-Fi because</font>

529
00:26:41,350 --> 00:26:45,580
after hopping but it's not impossible

530
00:26:42,850 --> 00:26:47,709
<font color="#CCCCCC">and then people can</font><font color="#E5E5E5"> just like get your</font>

531
00:26:45,580 --> 00:26:50,139
<font color="#E5E5E5">Bluetooth make address and then do some</font>

532
00:26:47,710 --> 00:26:52,480
connect or can<font color="#CCCCCC"> just say</font><font color="#E5E5E5"> hey what's your</font>

533
00:26:50,140 --> 00:26:54,340
what's your<font color="#E5E5E5"> LMP version and that's</font>

534
00:26:52,480 --> 00:26:56,440
pretty cool<font color="#E5E5E5"> for program because then you</font>

535
00:26:54,340 --> 00:27:07,178
<font color="#CCCCCC">just know which chip the person is</font>

536
00:26:56,440 --> 00:27:09,820
<font color="#E5E5E5">running um and the next</font><font color="#CCCCCC"> pirate is a so</font>

537
00:27:07,179 --> 00:27:12,549
called<font color="#CCCCCC"> you know attack I</font><font color="#E5E5E5"> think for that</font>

538
00:27:09,820 --> 00:27:14,950
<font color="#E5E5E5">one I will</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> just use the not alive</font>

539
00:27:12,549 --> 00:27:19,570
<font color="#E5E5E5">time about the video because I'm a bit</font>

540
00:27:14,950 --> 00:27:21,700
<font color="#E5E5E5">afraid of</font><font color="#CCCCCC"> breaking the setup</font><font color="#E5E5E5"> so what</font>

541
00:27:19,570 --> 00:27:23,260
happens and<font color="#E5E5E5"> you know as when you do a</font>

542
00:27:21,700 --> 00:27:26,169
bluetooth pairing then you have two

543
00:27:23,260 --> 00:27:29,529
<font color="#E5E5E5">devices and those two devices</font><font color="#CCCCCC"> want to</font>

544
00:27:26,169 --> 00:27:32,080
set<font color="#E5E5E5"> up a secure connection and if you</font>

545
00:27:29,529 --> 00:27:33,789
want to do this<font color="#E5E5E5"> the</font><font color="#CCCCCC"> only way to exclude</font>

546
00:27:32,080 --> 00:27:36,100
<font color="#CCCCCC">that there is a man in the middle</font><font color="#E5E5E5"> man in</font>

547
00:27:33,789 --> 00:27:38,830
<font color="#CCCCCC">the</font><font color="#E5E5E5"> middle is</font><font color="#CCCCCC"> that both devices say we</font>

548
00:27:36,100 --> 00:27:41,168
have a possibility to compare a number

549
00:27:38,830 --> 00:27:43,658
<font color="#E5E5E5">so that's this six digit</font><font color="#CCCCCC"> number that</font><font color="#E5E5E5"> you</font>

550
00:27:41,169 --> 00:27:45,250
see in a bluetooth pairing and you

551
00:27:43,659 --> 00:27:48,070
compare<font color="#E5E5E5"> this</font><font color="#CCCCCC"> and then you exclude that</font>

552
00:27:45,250 --> 00:27:52,990
<font color="#E5E5E5">there is a man in the middle the problem</font>

553
00:27:48,070 --> 00:27:55,120
with this is<font color="#CCCCCC"> that the very first part of</font>

554
00:27:52,990 --> 00:27:57,760
this<font color="#E5E5E5"> connection where the devices say</font>

555
00:27:55,120 --> 00:27:59,770
yes I<font color="#E5E5E5"> have a keyboard yes I have a</font>

556
00:27:57,760 --> 00:28:03,070
display or I<font color="#E5E5E5"> don't have any of this</font>

557
00:27:59,770 --> 00:28:03,668
<font color="#E5E5E5">because I'm a headset this part is not</font>

558
00:28:03,070 --> 00:28:05,529
secured

559
00:28:03,669 --> 00:28:07,000
I mean how<font color="#CCCCCC"> should it be</font><font color="#E5E5E5"> the devices</font>

560
00:28:05,529 --> 00:28:08,409
<font color="#CCCCCC">don't know each other they don't</font><font color="#E5E5E5"> trust</font>

561
00:28:07,000 --> 00:28:11,440
<font color="#E5E5E5">each other yet they don't have any root</font>

562
00:28:08,409 --> 00:28:14,080
of trust<font color="#E5E5E5"> and common so they just need</font><font color="#CCCCCC"> to</font>

563
00:28:11,440 --> 00:28:17,309
trust<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> information if the other</font>

564
00:28:14,080 --> 00:28:21,070
device has a<font color="#CCCCCC"> keyboard display and so on</font>

565
00:28:17,309 --> 00:28:23,799
and<font color="#E5E5E5"> now the problem is that even though</font>

566
00:28:21,070 --> 00:28:28,779
it<font color="#E5E5E5"> is</font><font color="#CCCCCC"> insecure to do a pairing without a</font>

567
00:28:23,799 --> 00:28:30,039
numeric comparison the the most so there

568
00:28:28,779 --> 00:28:31,809
is<font color="#E5E5E5"> nothing in the standard so the</font>

569
00:28:30,039 --> 00:28:33,610
standard says yes this is<font color="#E5E5E5"> insecure if</font>

570
00:28:31,809 --> 00:28:36,460
<font color="#CCCCCC">there</font><font color="#E5E5E5"> so many men in the middle which</font><font color="#CCCCCC"> is</font>

571
00:28:33,610 --> 00:28:37,539
actively exchanging<font color="#E5E5E5"> things but the</font>

572
00:28:36,460 --> 00:28:40,179
<font color="#E5E5E5">operating system does</font>

573
00:28:37,539 --> 00:28:42,669
I<font color="#E5E5E5"> warn you so this is really funny</font>

574
00:28:40,179 --> 00:28:45,759
because you can just say on your<font color="#E5E5E5"> own</font>

575
00:28:42,669 --> 00:28:48,309
<font color="#CCCCCC">smartphone like I am NOT a smartphone</font>

576
00:28:45,759 --> 00:28:50,009
having a display I'm just I'm yes I'm a

577
00:28:48,309 --> 00:28:54,460
smartphone<font color="#E5E5E5"> but I don't have</font><font color="#CCCCCC"> a display</font>

578
00:28:50,009 --> 00:28:56,799
<font color="#E5E5E5">and then the other device will not warn</font>

579
00:28:54,460 --> 00:29:00,720
<font color="#CCCCCC">you but</font><font color="#E5E5E5"> just instead of the number in</font>

580
00:28:56,799 --> 00:29:04,119
the pairing show you this<font color="#CCCCCC"> yes/no option</font>

581
00:29:00,720 --> 00:29:04,119
[Music]

582
00:29:09,940 --> 00:29:12,940
so

583
00:29:20,890 --> 00:29:23,880
<font color="#E5E5E5">there is it</font>

584
00:29:42,580 --> 00:29:50,360
so what you can see<font color="#CCCCCC"> here I have this</font>

585
00:29:45,890 --> 00:29:51,740
<font color="#E5E5E5">Nexus 5 which I use with proof of</font>

586
00:29:50,360 --> 00:29:54,919
<font color="#E5E5E5">concept script that's already</font><font color="#CCCCCC"> online</font>

587
00:29:51,740 --> 00:29:57,350
<font color="#E5E5E5">indicate by now</font><font color="#CCCCCC"> which is just saying I</font>

588
00:29:54,920 --> 00:30:00,410
don't<font color="#CCCCCC"> have</font><font color="#E5E5E5"> any i/o capability so I</font>

589
00:29:57,350 --> 00:30:03,350
cannot show<font color="#CCCCCC"> you a</font><font color="#E5E5E5"> number or kind of</font>

590
00:30:00,410 --> 00:30:05,240
compare<font color="#E5E5E5"> a number the Nexus 5 itself does</font>

591
00:30:03,350 --> 00:30:07,219
not<font color="#E5E5E5"> forget that it can do it from this</font>

592
00:30:05,240 --> 00:30:09,830
<font color="#CCCCCC">patch so it's just</font><font color="#E5E5E5"> telling this to the</font>

593
00:30:07,220 --> 00:30:11,990
<font color="#E5E5E5">other device which means that in the</font>

594
00:30:09,830 --> 00:30:17,060
following<font color="#E5E5E5"> now the Nexus 5 on the</font><font color="#CCCCCC"> Left</font>

595
00:30:11,990 --> 00:30:18,860
will show you a pin so on the left you

596
00:30:17,060 --> 00:30:21,290
<font color="#CCCCCC">can see a pin but</font><font color="#E5E5E5"> on the right it just</font>

597
00:30:18,860 --> 00:30:23,750
<font color="#E5E5E5">says do you want to pair yes or no and</font>

598
00:30:21,290 --> 00:30:25,520
if you're not<font color="#E5E5E5"> aware of this there might</font>

599
00:30:23,750 --> 00:30:27,680
be a man in the<font color="#E5E5E5"> middle you don't know it</font>

600
00:30:25,520 --> 00:30:30,230
and<font color="#E5E5E5"> it's something</font><font color="#CCCCCC"> that the vendors</font>

601
00:30:27,680 --> 00:30:33,800
should change<font color="#CCCCCC"> obviously and it's a very</font>

602
00:30:30,230 --> 00:30:36,350
<font color="#CCCCCC">non attack but maybe due to usability or</font>

603
00:30:33,800 --> 00:30:38,000
something I mean we ignore certificate

604
00:30:36,350 --> 00:30:40,669
warning in the browser<font color="#E5E5E5"> anyway so why</font>

605
00:30:38,000 --> 00:30:42,950
should we read it here I don't<font color="#E5E5E5"> know</font><font color="#CCCCCC"> so</font>

606
00:30:40,670 --> 00:30:47,890
<font color="#E5E5E5">people just say yes no yeah okay go for</font>

607
00:30:42,950 --> 00:30:47,890
it yeah

608
00:30:57,940 --> 00:31:01,449
[Music]

609
00:31:24,470 --> 00:31:27,470
<font color="#E5E5E5">okay</font>

610
00:31:30,520 --> 00:31:38,690
<font color="#E5E5E5">yep okay so also as</font><font color="#CCCCCC"> teacher already</font>

611
00:31:35,090 --> 00:31:41,209
in the introduction<font color="#E5E5E5"> I</font><font color="#CCCCCC"> tried</font><font color="#E5E5E5"> to implement</font>

612
00:31:38,690 --> 00:31:42,890
<font color="#CCCCCC">proof of concept for another</font><font color="#E5E5E5"> security</font>

613
00:31:41,210 --> 00:31:44,990
vulnerability that<font color="#E5E5E5"> came out last summer</font>

614
00:31:42,890 --> 00:31:47,800
this one is called fixed<font color="#CCCCCC"> coordinate</font>

615
00:31:44,990 --> 00:31:51,530
<font color="#E5E5E5">invalid kerf attack and basically</font>

616
00:31:47,800 --> 00:31:52,040
<font color="#CCCCCC">affects the pairing process and to be</font>

617
00:31:51,530 --> 00:31:53,930
<font color="#E5E5E5">exact</font>

618
00:31:52,040 --> 00:31:55,280
<font color="#CCCCCC">the diffie-hellman key exchange that</font>

619
00:31:53,930 --> 00:31:59,630
<font color="#E5E5E5">happens during the bluetooth pairing</font>

620
00:31:55,280 --> 00:32:05,030
<font color="#E5E5E5">process</font><font color="#CCCCCC"> i will now quickly explain how</font>

621
00:31:59,630 --> 00:32:06,860
this<font color="#E5E5E5"> attack works and then</font><font color="#CCCCCC"> know yep</font><font color="#E5E5E5"> how</font>

622
00:32:05,030 --> 00:32:10,160
does the tech<font color="#E5E5E5"> works and later</font><font color="#CCCCCC"> explained</font>

623
00:32:06,860 --> 00:32:12,889
how<font color="#E5E5E5"> I went to develop a proof of</font><font color="#CCCCCC"> concept</font>

624
00:32:10,160 --> 00:32:16,430
for this so the fixed coordinate in<font color="#E5E5E5"> the</font>

625
00:32:12,890 --> 00:32:19,700
kerf attack has already<font color="#E5E5E5"> set effects the</font>

626
00:32:16,430 --> 00:32:21,320
key exchange<font color="#E5E5E5"> Bluetooth uses a elliptic</font>

627
00:32:19,700 --> 00:32:23,780
curve diffie-hellman key exchange during

628
00:32:21,320 --> 00:32:27,290
<font color="#E5E5E5">the pairing sequence and for this key</font>

629
00:32:23,780 --> 00:32:29,710
exchange you usually<font color="#E5E5E5"> exchange two points</font>

630
00:32:27,290 --> 00:32:32,629
on elliptic<font color="#E5E5E5"> curve as a public component</font>

631
00:32:29,710 --> 00:32:34,070
<font color="#E5E5E5">then</font><font color="#CCCCCC"> also what happens in</font><font color="#E5E5E5"> in this</font>

632
00:32:32,630 --> 00:32:35,930
special case<font color="#CCCCCC"> because</font><font color="#E5E5E5"> this is actually</font>

633
00:32:34,070 --> 00:32:38,510
authenticated diffie-hellman key

634
00:32:35,930 --> 00:32:40,520
exchange<font color="#CCCCCC"> both of those components have</font>

635
00:32:38,510 --> 00:32:42,530
to<font color="#CCCCCC"> be authenticated</font><font color="#E5E5E5"> and this works as</font>

636
00:32:40,520 --> 00:32:45,680
already<font color="#E5E5E5"> set with this pin that you have</font>

637
00:32:42,530 --> 00:32:48,100
to<font color="#E5E5E5"> accept so some of the components that</font>

638
00:32:45,680 --> 00:32:51,320
<font color="#E5E5E5">were exchanged during the key exchange</font>

639
00:32:48,100 --> 00:32:53,780
<font color="#E5E5E5">there's a hash calculated over them and</font>

640
00:32:51,320 --> 00:32:55,879
then from this<font color="#E5E5E5"> hash you derive this pin</font>

641
00:32:53,780 --> 00:32:57,950
and show this pin on<font color="#E5E5E5"> both devices and</font>

642
00:32:55,880 --> 00:32:59,870
the user I<font color="#E5E5E5"> have to say okay both pins</font>

643
00:32:57,950 --> 00:33:01,460
are actually the same<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that means that</font>

644
00:32:59,870 --> 00:33:03,350
the hashes were the same and<font color="#CCCCCC"> that means</font>

645
00:33:01,460 --> 00:33:05,420
that the components have<font color="#E5E5E5"> not been</font>

646
00:33:03,350 --> 00:33:09,250
<font color="#E5E5E5">modified by a man the middle attacker</font>

647
00:33:05,420 --> 00:33:12,040
now those<font color="#E5E5E5"> diffie-hellman key exchange</font>

648
00:33:09,250 --> 00:33:14,930
<font color="#E5E5E5">coordinates that are being exchanged are</font>

649
00:33:12,040 --> 00:33:17,090
points<font color="#E5E5E5"> on elliptic curves</font><font color="#CCCCCC"> so they have</font><font color="#E5E5E5"> X</font>

650
00:33:14,930 --> 00:33:19,610
and a y-coordinate<font color="#E5E5E5"> and in the Bluetooth</font>

651
00:33:17,090 --> 00:33:22,240
<font color="#E5E5E5">standard</font><font color="#CCCCCC"> it's actually specified that</font>

652
00:33:19,610 --> 00:33:24,800
only<font color="#CCCCCC"> the</font><font color="#E5E5E5"> x-coordinate should be</font>

653
00:33:22,240 --> 00:33:26,900
authenticated<font color="#CCCCCC"> so</font><font color="#E5E5E5"> only the x-coordinate</font>

654
00:33:24,800 --> 00:33:29,419
actually<font color="#CCCCCC"> affects the pin</font><font color="#E5E5E5"> that is shown</font>

655
00:33:26,900 --> 00:33:31,730
to<font color="#CCCCCC"> the user</font><font color="#E5E5E5"> the y-coordinate is not</font>

656
00:33:29,420 --> 00:33:34,190
included in the hash<font color="#CCCCCC"> that leads to that</font>

657
00:33:31,730 --> 00:33:36,410
<font color="#E5E5E5">in a calculation of the pin so this is</font>

658
00:33:34,190 --> 00:33:38,900
<font color="#CCCCCC">sort of</font><font color="#E5E5E5"> Bluetooth standard this wouldn't</font>

659
00:33:36,410 --> 00:33:40,640
be a problem<font color="#E5E5E5"> because the</font><font color="#CCCCCC"> y-coordinate</font>

660
00:33:38,900 --> 00:33:43,070
actually depends<font color="#E5E5E5"> on the x coordinate so</font>

661
00:33:40,640 --> 00:33:46,100
<font color="#E5E5E5">if the device receives</font><font color="#CCCCCC"> x coordinate</font>

662
00:33:43,070 --> 00:33:48,590
you can you have<font color="#E5E5E5"> to curve equation you</font>

663
00:33:46,100 --> 00:33:50,179
can simply insert the<font color="#CCCCCC"> x-coordinate and</font>

664
00:33:48,590 --> 00:33:53,060
calculate the y-coordinate and see if

665
00:33:50,180 --> 00:33:55,010
you receive the correct y-coordinate<font color="#CCCCCC"> but</font>

666
00:33:53,060 --> 00:33:57,050
of<font color="#CCCCCC"> course not</font><font color="#E5E5E5"> all vendor did it like</font>

667
00:33:55,010 --> 00:34:00,110
this<font color="#E5E5E5"> because this was not</font><font color="#CCCCCC"> mentioned in</font>

668
00:33:57,050 --> 00:34:02,990
the specification<font color="#E5E5E5"> that you do to do to</font>

669
00:34:00,110 --> 00:34:04,939
<font color="#E5E5E5">have this so basically some of the</font>

670
00:34:02,990 --> 00:34:07,280
<font color="#CCCCCC">vendors out there didn't do the check</font>

671
00:34:04,940 --> 00:34:09,380
and simply<font color="#E5E5E5"> trust it the y-coordinate</font>

672
00:34:07,280 --> 00:34:10,820
that was sent<font color="#CCCCCC"> over the air and an</font>

673
00:34:09,380 --> 00:34:12,560
attacker can simply mess with the

674
00:34:10,820 --> 00:34:14,929
y-coordinate because it doesn't<font color="#CCCCCC"> affect</font>

675
00:34:12,560 --> 00:34:17,179
the pin at all<font color="#E5E5E5"> if you if you</font><font color="#CCCCCC"> serial</font><font color="#E5E5E5"> out</font>

676
00:34:14,929 --> 00:34:19,700
for example the pin will still be the

677
00:34:17,179 --> 00:34:22,490
<font color="#E5E5E5">same as before</font><font color="#CCCCCC"> and this</font><font color="#E5E5E5"> is has a problem</font>

678
00:34:19,699 --> 00:34:25,339
<font color="#E5E5E5">because the y-coordinate is still</font>

679
00:34:22,489 --> 00:34:27,678
important if the attacker for example<font color="#CCCCCC"> is</font>

680
00:34:25,340 --> 00:34:30,410
<font color="#E5E5E5">able to see route the y-coordinate in</font>

681
00:34:27,679 --> 00:34:32,120
both directions<font color="#E5E5E5"> then both devices will</font>

682
00:34:30,409 --> 00:34:33,918
continue<font color="#CCCCCC"> to work</font><font color="#E5E5E5"> with a serial</font>

683
00:34:32,120 --> 00:34:38,179
y-coordinate and this will lead<font color="#E5E5E5"> to a</font>

684
00:34:33,918 --> 00:34:39,889
<font color="#E5E5E5">predictable</font><font color="#CCCCCC"> naki to be calculated</font><font color="#E5E5E5"> so if</font>

685
00:34:38,179 --> 00:34:41,600
the attacker manages to find<font color="#E5E5E5"> two</font>

686
00:34:39,889 --> 00:34:42,020
vulnerable devices that want to pair to

687
00:34:41,600 --> 00:34:44,449
each other

688
00:34:42,020 --> 00:34:46,790
<font color="#E5E5E5">and doesn't man in the middle attack and</font>

689
00:34:44,449 --> 00:34:49,069
severs all those y-coordinates<font color="#E5E5E5"> the</font>

690
00:34:46,790 --> 00:34:52,009
diffie-hellman key exchange<font color="#CCCCCC"> still</font>

691
00:34:49,070 --> 00:34:53,960
succeeds because<font color="#E5E5E5"> both devices can still</font>

692
00:34:52,010 --> 00:34:56,090
calculate a key but<font color="#E5E5E5"> the attacker can</font>

693
00:34:53,960 --> 00:34:59,120
predict this key and now also<font color="#E5E5E5"> has two</font>

694
00:34:56,090 --> 00:35:02,110
shared secret<font color="#E5E5E5"> that both have yeah shared</font>

695
00:34:59,120 --> 00:35:04,549
<font color="#E5E5E5">during the key exchange there are a more</font>

696
00:35:02,110 --> 00:35:08,720
<font color="#CCCCCC">little</font><font color="#E5E5E5"> bit more implications to this</font>

697
00:35:04,550 --> 00:35:10,850
attack so it has to be that both the

698
00:35:08,720 --> 00:35:13,370
<font color="#E5E5E5">private keys of the devices have to</font><font color="#CCCCCC"> be</font>

699
00:35:10,850 --> 00:35:15,529
<font color="#E5E5E5">eaten</font><font color="#CCCCCC"> so this attack won't</font><font color="#E5E5E5"> work in all</font>

700
00:35:13,370 --> 00:35:19,549
<font color="#E5E5E5">cases</font><font color="#CCCCCC"> so it's a little bit</font>

701
00:35:15,530 --> 00:35:21,290
non-deterministic and<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> i simply</font>

702
00:35:19,550 --> 00:35:25,460
wanted<font color="#CCCCCC"> to implement</font><font color="#E5E5E5"> this to see</font><font color="#CCCCCC"> if it</font>

703
00:35:21,290 --> 00:35:27,230
actually worked<font color="#E5E5E5"> so my idea was that</font><font color="#CCCCCC"> i</font>

704
00:35:25,460 --> 00:35:28,910
didn't want<font color="#CCCCCC"> to</font><font color="#E5E5E5"> do a man the middle</font>

705
00:35:27,230 --> 00:35:31,220
Bluetooth setup because<font color="#CCCCCC"> this is still</font>

706
00:35:28,910 --> 00:35:33,890
very<font color="#E5E5E5"> hard and I also didn't</font><font color="#CCCCCC"> really want</font>

707
00:35:31,220 --> 00:35:36,649
<font color="#CCCCCC">to attack somebody</font><font color="#E5E5E5"> what</font><font color="#CCCCCC"> I was</font><font color="#E5E5E5"> interested</font>

708
00:35:33,890 --> 00:35:38,839
in in a pen testing scenario<font color="#E5E5E5"> I wanted to</font>

709
00:35:36,650 --> 00:35:40,280
see if<font color="#E5E5E5"> another device if I have to test</font>

710
00:35:38,840 --> 00:35:42,740
this is still vulnerable<font color="#E5E5E5"> to this</font>

711
00:35:40,280 --> 00:35:45,680
<font color="#CCCCCC">vulnerability for example I've</font><font color="#E5E5E5"> tested</font>

712
00:35:42,740 --> 00:35:47,870
car radios or similar IOT devices in the

713
00:35:45,680 --> 00:35:49,339
past and I wanted<font color="#E5E5E5"> to simply check if</font>

714
00:35:47,870 --> 00:35:51,350
this<font color="#CCCCCC"> device is still vulnerable</font><font color="#E5E5E5"> to</font>

715
00:35:49,340 --> 00:35:56,480
<font color="#CCCCCC">respond ability without</font><font color="#E5E5E5"> digging into the</font>

716
00:35:51,350 --> 00:35:57,020
member of this<font color="#CCCCCC"> firmware</font><font color="#E5E5E5"> again so what I</font>

717
00:35:56,480 --> 00:36:00,080
<font color="#E5E5E5">did</font>

718
00:35:57,020 --> 00:36:02,300
I add a patch to the<font color="#E5E5E5"> Nexus 5 which</font>

719
00:36:00,080 --> 00:36:05,119
simply emulates this man-in-the-middle

720
00:36:02,300 --> 00:36:07,160
attack<font color="#CCCCCC"> err so basically the patch does</font>

721
00:36:05,119 --> 00:36:09,050
nothing else then<font color="#E5E5E5"> searing out the</font>

722
00:36:07,160 --> 00:36:10,940
<font color="#E5E5E5">y-coordinates in both directions once</font>

723
00:36:09,050 --> 00:36:14,089
they are sent through this LMP protocol

724
00:36:10,940 --> 00:36:15,800
and by<font color="#E5E5E5"> doing this I basically simulate</font>

725
00:36:14,089 --> 00:36:18,259
an attacker that<font color="#E5E5E5"> sits in the air and</font>

726
00:36:15,800 --> 00:36:20,450
<font color="#CCCCCC">does this in the air I just do it on</font>

727
00:36:18,260 --> 00:36:23,270
<font color="#E5E5E5">this device directly to see if the other</font>

728
00:36:20,450 --> 00:36:25,129
device detects this<font color="#CCCCCC"> and now if I pair my</font>

729
00:36:23,270 --> 00:36:27,140
device with<font color="#E5E5E5"> any other device and this</font>

730
00:36:25,130 --> 00:36:28,820
still works that means<font color="#E5E5E5"> the other device</font>

731
00:36:27,140 --> 00:36:31,098
does not<font color="#E5E5E5"> check if the y-coordinate</font><font color="#CCCCCC"> is</font>

732
00:36:28,820 --> 00:36:33,250
still correct<font color="#E5E5E5"> and this is</font><font color="#CCCCCC"> how I can</font>

733
00:36:31,099 --> 00:36:36,410
<font color="#CCCCCC">check if either devices are vulnerable</font>

734
00:36:33,250 --> 00:36:38,900
<font color="#CCCCCC">yeah and basically because this is</font>

735
00:36:36,410 --> 00:36:40,879
really non-deterministic<font color="#E5E5E5"> I recorded this</font>

736
00:36:38,900 --> 00:36:42,619
as a<font color="#E5E5E5"> video</font><font color="#CCCCCC"> because it really sometimes</font>

737
00:36:40,880 --> 00:36:44,510
<font color="#E5E5E5">takes a while to succeed and I don't</font>

738
00:36:42,619 --> 00:36:48,230
<font color="#E5E5E5">want to do that here</font><font color="#CCCCCC"> so we will</font><font color="#E5E5E5"> see</font>

739
00:36:44,510 --> 00:36:51,080
another<font color="#CCCCCC"> video where I did</font><font color="#E5E5E5"> that basically</font>

740
00:36:48,230 --> 00:36:53,330
<font color="#E5E5E5">I used</font><font color="#CCCCCC"> two Nexus 5 with internal blue as</font>

741
00:36:51,080 --> 00:36:55,520
the<font color="#E5E5E5"> attacking device and then I have a</font>

742
00:36:53,330 --> 00:36:57,589
<font color="#CCCCCC">Nexus 7 which is</font><font color="#E5E5E5"> also still</font><font color="#CCCCCC"> vulnerable</font>

743
00:36:55,520 --> 00:36:59,630
<font color="#CCCCCC">to this attack by the way the Nexus 5 is</font>

744
00:36:57,589 --> 00:37:02,750
<font color="#CCCCCC">also still vulnerable to this</font><font color="#E5E5E5"> attack so</font>

745
00:36:59,630 --> 00:37:05,540
I<font color="#E5E5E5"> don't have to bypass any mitigations</font>

746
00:37:02,750 --> 00:37:08,750
or something on the devices itself<font color="#CCCCCC"> on</font>

747
00:37:05,540 --> 00:37:10,670
the left side you<font color="#CCCCCC"> can see</font><font color="#E5E5E5"> my my computer</font>

748
00:37:08,750 --> 00:37:13,430
screen here<font color="#E5E5E5"> which runs the internal</font><font color="#CCCCCC"> blue</font>

749
00:37:10,670 --> 00:37:15,440
framework on<font color="#E5E5E5"> the right side you have two</font>

750
00:37:13,430 --> 00:37:17,299
<font color="#E5E5E5">devices the</font><font color="#CCCCCC"> botton one is the Nexus 5</font>

751
00:37:15,440 --> 00:37:19,609
<font color="#E5E5E5">which is the attacking device and the</font>

752
00:37:17,300 --> 00:37:21,980
upper one is<font color="#E5E5E5"> the Nexus 7 which is the</font>

753
00:37:19,609 --> 00:37:25,098
victim in<font color="#E5E5E5"> this case the Nexus 5 is</font>

754
00:37:21,980 --> 00:37:30,140
<font color="#E5E5E5">connected</font><font color="#CCCCCC"> by USB</font><font color="#E5E5E5"> to the computer to run</font>

755
00:37:25,099 --> 00:37:36,080
the internal<font color="#CCCCCC"> glue framework</font><font color="#E5E5E5"> now</font><font color="#CCCCCC"> if we</font>

756
00:37:30,140 --> 00:37:38,990
<font color="#CCCCCC">start the video yeah</font><font color="#E5E5E5"> so the first</font><font color="#CCCCCC"> thing</font>

757
00:37:36,080 --> 00:37:41,000
I do is starting a script I wrote that

758
00:37:38,990 --> 00:37:43,399
<font color="#CCCCCC">use this internal blue</font><font color="#E5E5E5"> to basically</font>

759
00:37:41,000 --> 00:37:46,220
patch things<font color="#E5E5E5"> in the firmware this will</font>

760
00:37:43,400 --> 00:37:49,070
then cost at the<font color="#E5E5E5"> y coordinate</font><font color="#CCCCCC"> is 0</font><font color="#E5E5E5"> it</font>

761
00:37:46,220 --> 00:37:51,470
<font color="#E5E5E5">out on both directions</font><font color="#CCCCCC"> then I start the</font>

762
00:37:49,070 --> 00:37:53,089
<font color="#E5E5E5">framework and also the LMP monitor again</font>

763
00:37:51,470 --> 00:37:56,560
so that we<font color="#CCCCCC"> can actually see what's going</font>

764
00:37:53,089 --> 00:37:59,630
<font color="#CCCCCC">on</font><font color="#E5E5E5"> and then I start a pairing process</font>

765
00:37:56,560 --> 00:38:04,190
<font color="#CCCCCC">now you will see that on both devices</font>

766
00:37:59,630 --> 00:38:05,930
it's just wait here<font color="#CCCCCC"> I'm not sure if you</font>

767
00:38:04,190 --> 00:38:07,880
can see that from<font color="#CCCCCC"> the back but I can</font>

768
00:38:05,930 --> 00:38:09,440
assure<font color="#CCCCCC"> you that on both devices the the</font>

769
00:38:07,880 --> 00:38:10,789
pin that<font color="#E5E5E5"> is shown is still the same</font>

770
00:38:09,440 --> 00:38:13,219
<font color="#E5E5E5">however I</font>

771
00:38:10,789 --> 00:38:15,859
zero out the y-coordinate and<font color="#CCCCCC"> later see</font>

772
00:38:13,219 --> 00:38:19,099
that in Wireshark<font color="#CCCCCC"> I just let it</font><font color="#E5E5E5"> continue</font>

773
00:38:15,859 --> 00:38:21,410
now if<font color="#E5E5E5"> I pair those you can see that</font>

774
00:38:19,099 --> 00:38:23,869
pairing actually succeeds<font color="#CCCCCC"> and now in</font>

775
00:38:21,410 --> 00:38:25,609
Wireshark we scroll<font color="#CCCCCC"> back to the point</font>

776
00:38:23,869 --> 00:38:28,959
where the key exchange happened on the

777
00:38:25,609 --> 00:38:31,969
LMP protocol<font color="#CCCCCC"> this happens in three steps</font>

778
00:38:28,959 --> 00:38:34,160
<font color="#E5E5E5">because the key exchange is actually too</font>

779
00:38:31,969 --> 00:38:37,130
large to happen in one single LMP packet

780
00:38:34,160 --> 00:38:39,949
and here you can see the first packet

781
00:38:37,130 --> 00:38:41,809
<font color="#E5E5E5">it's actually too</font><font color="#CCCCCC"> small I guess however</font>

782
00:38:39,949 --> 00:38:43,939
the thing that is<font color="#E5E5E5"> highlighted in blue</font>

783
00:38:41,809 --> 00:38:45,799
there is the x-coordinate<font color="#CCCCCC"> or better the</font>

784
00:38:43,939 --> 00:38:48,109
first part<font color="#CCCCCC"> of the x-coordinate</font><font color="#E5E5E5"> it's some</font>

785
00:38:45,799 --> 00:38:50,569
<font color="#E5E5E5">random numbers that doesn't matter</font><font color="#CCCCCC"> now</font>

786
00:38:48,109 --> 00:38:52,249
<font color="#CCCCCC">if I click on the next</font><font color="#E5E5E5"> packet you see</font>

787
00:38:50,569 --> 00:38:54,558
the rest of the<font color="#CCCCCC"> x-coordinate and the</font>

788
00:38:52,249 --> 00:38:56,178
beginning of<font color="#E5E5E5"> the y-coordinate and if you</font>

789
00:38:54,559 --> 00:38:57,890
have good eyes<font color="#CCCCCC"> then</font><font color="#E5E5E5"> you see that the</font>

790
00:38:56,179 --> 00:39:00,949
second<font color="#CCCCCC"> part</font><font color="#E5E5E5"> of this highlighted thing is</font>

791
00:38:57,890 --> 00:39:02,239
actually<font color="#E5E5E5"> zeroed out and the last packet</font>

792
00:39:00,949 --> 00:39:04,969
will contain the rest of the

793
00:39:02,239 --> 00:39:09,169
y-coordinate and will<font color="#E5E5E5"> actually be all</font>

794
00:39:04,969 --> 00:39:10,999
<font color="#CCCCCC">zeros yeah</font><font color="#E5E5E5"> that's here so</font><font color="#CCCCCC"> you see that I</font>

795
00:39:09,169 --> 00:39:12,679
<font color="#E5E5E5">have</font><font color="#CCCCCC"> zero of</font><font color="#E5E5E5"> the y-coordinate and the</font>

796
00:39:10,999 --> 00:39:15,198
other device still<font color="#CCCCCC"> except that</font><font color="#E5E5E5"> appearing</font>

797
00:39:12,679 --> 00:39:18,650
so I know for sure<font color="#CCCCCC"> that the</font><font color="#E5E5E5"> Nexus</font><font color="#CCCCCC"> 7 is</font>

798
00:39:15,199 --> 00:39:20,749
vulnerable<font color="#CCCCCC"> to this attack and this</font><font color="#E5E5E5"> is</font>

799
00:39:18,650 --> 00:39:23,359
pretty<font color="#E5E5E5"> helpful now I also tried the same</font>

800
00:39:20,749 --> 00:39:25,459
<font color="#CCCCCC">thing</font><font color="#E5E5E5"> with my pixel</font><font color="#CCCCCC"> two here it still</font>

801
00:39:23,359 --> 00:39:27,589
<font color="#E5E5E5">shows the same pin because pin is not</font>

802
00:39:25,459 --> 00:39:29,178
affected however<font color="#E5E5E5"> the pixel two actually</font>

803
00:39:27,589 --> 00:39:31,130
checks if<font color="#CCCCCC"> the y-coordinate was messed</font>

804
00:39:29,179 --> 00:39:34,099
with and so the pairing actually fails

805
00:39:31,130 --> 00:39:36,229
<font color="#E5E5E5">so pixel two is actually fixed against</font>

806
00:39:34,099 --> 00:39:37,789
this vulnerability<font color="#CCCCCC"> or I would have</font><font color="#E5E5E5"> to</font>

807
00:39:36,229 --> 00:39:40,578
<font color="#E5E5E5">try it more often because it could also</font>

808
00:39:37,789 --> 00:39:42,529
be<font color="#CCCCCC"> that the private keys we're not even</font>

809
00:39:40,579 --> 00:39:44,869
so as I said this attack is

810
00:39:42,529 --> 00:39:47,479
<font color="#CCCCCC">non-deterministic</font><font color="#E5E5E5"> and you have to try it</font>

811
00:39:44,869 --> 00:39:49,759
a<font color="#CCCCCC"> few times</font><font color="#E5E5E5"> but this already helped I</font>

812
00:39:47,479 --> 00:39:52,339
mean some pen tests to see if<font color="#E5E5E5"> other</font>

813
00:39:49,759 --> 00:39:55,699
devices<font color="#E5E5E5"> were</font><font color="#CCCCCC"> vulnerable</font><font color="#E5E5E5"> and to actually</font>

814
00:39:52,339 --> 00:39:57,589
find some multiple<font color="#E5E5E5"> IOT devices even</font>

815
00:39:55,699 --> 00:39:59,089
<font color="#CCCCCC">without knowing which vendor this</font><font color="#E5E5E5"> is you</font>

816
00:39:57,589 --> 00:40:00,529
<font color="#E5E5E5">can just do</font><font color="#CCCCCC"> it over</font><font color="#E5E5E5"> the air pair with</font>

817
00:39:59,089 --> 00:40:07,669
the<font color="#CCCCCC"> device and you know okay this one's</font>

818
00:40:00,529 --> 00:40:10,909
<font color="#CCCCCC">fallible</font><font color="#E5E5E5"> okay yep</font><font color="#CCCCCC"> so since we have</font><font color="#E5E5E5"> the</font>

819
00:40:07,669 --> 00:40:13,009
film there of quite a lot<font color="#E5E5E5"> of little</font>

820
00:40:10,909 --> 00:40:16,279
chips it's also<font color="#CCCCCC"> interesting to</font><font color="#E5E5E5"> look for</font>

821
00:40:13,009 --> 00:40:18,919
<font color="#CCCCCC">backs within the firmware and actually I</font>

822
00:40:16,279 --> 00:40:21,079
stumbled over the first<font color="#E5E5E5"> back without</font>

823
00:40:18,919 --> 00:40:24,650
<font color="#CCCCCC">even looking for</font><font color="#E5E5E5"> backs I just was</font>

824
00:40:21,079 --> 00:40:28,180
looking<font color="#E5E5E5"> for functions</font>

825
00:40:24,650 --> 00:40:32,240
so when I went<font color="#CCCCCC"> through all of this code</font>

826
00:40:28,180 --> 00:40:35,470
there is quite a lot of handlers and the

827
00:40:32,240 --> 00:40:39,250
important part with<font color="#CCCCCC"> 10 versus each</font>

828
00:40:35,470 --> 00:40:43,669
handler is checking certain<font color="#CCCCCC"> ranges</font>

829
00:40:39,250 --> 00:40:46,790
<font color="#CCCCCC">looking up</font><font color="#E5E5E5"> up codes or if it's</font><font color="#CCCCCC"> HDI it's</font>

830
00:40:43,670 --> 00:40:51,620
looking is it<font color="#CCCCCC"> which command group am</font><font color="#E5E5E5"> i</font>

831
00:40:46,790 --> 00:40:55,940
in and so<font color="#E5E5E5"> on and in the end find out if</font>

832
00:40:51,620 --> 00:40:59,810
something actually is<font color="#E5E5E5"> a certain</font><font color="#CCCCCC"> Handler</font>

833
00:40:55,940 --> 00:41:04,210
<font color="#CCCCCC">and</font><font color="#E5E5E5"> then there was this one handler</font><font color="#CCCCCC"> that</font>

834
00:40:59,810 --> 00:41:08,150
was really strange<font color="#E5E5E5"> and missing is this</font>

835
00:41:04,210 --> 00:41:10,220
<font color="#E5E5E5">checks so it's within other handlers but</font>

836
00:41:08,150 --> 00:41:13,850
there's this one strange handler not

837
00:41:10,220 --> 00:41:15,950
having any checks<font color="#E5E5E5"> and then I compared</font>

838
00:41:13,850 --> 00:41:18,830
<font color="#CCCCCC">firmwares and so on and I found</font><font color="#E5E5E5"> out so</font>

839
00:41:15,950 --> 00:41:20,600
this was like<font color="#CCCCCC"> patched in summer 2014</font>

840
00:41:18,830 --> 00:41:23,680
so they found<font color="#E5E5E5"> out</font><font color="#CCCCCC"> that there's</font><font color="#E5E5E5"> this</font>

841
00:41:20,600 --> 00:41:26,270
check which misses but they never

842
00:41:23,680 --> 00:41:27,919
thought this<font color="#E5E5E5"> could</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> relevant to</font>

843
00:41:26,270 --> 00:41:29,720
security I mean it's just<font color="#E5E5E5"> a missing is</font>

844
00:41:27,920 --> 00:41:30,400
if it's<font color="#CCCCCC"> just a missing range like what</font>

845
00:41:29,720 --> 00:41:32,990
should it be

846
00:41:30,400 --> 00:41:34,460
<font color="#CCCCCC">and first of</font><font color="#E5E5E5"> all when I</font><font color="#CCCCCC"> contacted</font>

847
00:41:32,990 --> 00:41:37,549
program and said<font color="#CCCCCC"> this</font><font color="#E5E5E5"> really</font><font color="#CCCCCC"> is</font><font color="#E5E5E5"> an issue</font>

848
00:41:34,460 --> 00:41:40,670
they said like<font color="#CCCCCC"> who</font><font color="#E5E5E5"> this handler it does</font>

849
00:41:37,550 --> 00:41:42,470
not exist<font color="#CCCCCC"> so I said it exists you</font>

850
00:41:40,670 --> 00:41:44,780
implement your<font color="#CCCCCC"> own funny stuff there</font>

851
00:41:42,470 --> 00:41:47,839
then they said yeah but<font color="#CCCCCC"> ok then your</font>

852
00:41:44,780 --> 00:41:51,770
attack is<font color="#CCCCCC"> not standard compliant</font><font color="#E5E5E5"> ok</font>

853
00:41:47,840 --> 00:41:53,900
actually I<font color="#E5E5E5"> so the last time I've gave</font>

854
00:41:51,770 --> 00:41:56,420
this<font color="#CCCCCC"> presentation I said my next exploit</font>

855
00:41:53,900 --> 00:41:58,370
will be standard compliant<font color="#E5E5E5"> and yes my</font>

856
00:41:56,420 --> 00:42:02,240
next exploit is<font color="#CCCCCC"> they're not compliant</font>

857
00:41:58,370 --> 00:42:03,950
but not that severe so yeah there's<font color="#E5E5E5"> I at</font>

858
00:42:02,240 --> 00:42:05,930
least<font color="#E5E5E5"> I'm sending standard compliant</font>

859
00:42:03,950 --> 00:42:09,439
packets not correct order but I was<font color="#E5E5E5"> an</font>

860
00:42:05,930 --> 00:42:11,899
<font color="#CCCCCC">extended compliant</font><font color="#E5E5E5"> packets and they also</font>

861
00:42:09,440 --> 00:42:16,670
said it does<font color="#E5E5E5"> not</font><font color="#CCCCCC"> affect Wi-Fi</font>

862
00:42:11,900 --> 00:42:20,030
performance<font color="#CCCCCC"> there's something well maybe</font>

863
00:42:16,670 --> 00:42:22,220
yes maybe no<font color="#E5E5E5"> so they share a 2.4</font>

864
00:42:20,030 --> 00:42:24,020
gigahertz antenna<font color="#E5E5E5"> and whenever you do</font>

865
00:42:22,220 --> 00:42:26,720
something<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> strange like</font>

866
00:42:24,020 --> 00:42:29,090
restarting the the firmware or something

867
00:42:26,720 --> 00:42:30,980
<font color="#E5E5E5">then</font><font color="#CCCCCC"> restart scanning and that really</font>

868
00:42:29,090 --> 00:42:35,090
<font color="#CCCCCC">slows down Wi-Fi so even if it's not</font>

869
00:42:30,980 --> 00:42:37,890
<font color="#E5E5E5">something on a command or control level</font>

870
00:42:35,090 --> 00:42:39,600
somewhere here at least

871
00:42:37,890 --> 00:42:41,609
if you restart<font color="#E5E5E5"> Bluetooth and the device</font>

872
00:42:39,600 --> 00:42:46,799
again<font color="#CCCCCC"> starts scanning</font><font color="#E5E5E5"> that slows down</font>

873
00:42:41,610 --> 00:42:48,480
<font color="#E5E5E5">Wi-Fi so what is this back about well</font>

874
00:42:46,800 --> 00:42:52,320
<font color="#E5E5E5">first of all there's quite a lot</font><font color="#CCCCCC"> of</font>

875
00:42:48,480 --> 00:42:55,020
devices<font color="#CCCCCC"> that</font><font color="#E5E5E5"> are vulnerable so it's just</font>

876
00:42:52,320 --> 00:42:56,880
a selection that I got by asking like<font color="#E5E5E5"> my</font>

877
00:42:55,020 --> 00:42:58,740
students<font color="#E5E5E5"> and it's it's hard</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> ask my</font>

878
00:42:56,880 --> 00:43:00,750
<font color="#CCCCCC">students so I</font><font color="#E5E5E5"> asked them can I try my</font>

879
00:42:58,740 --> 00:43:02,160
new exploit against your machine can<font color="#E5E5E5"> you</font>

880
00:43:00,750 --> 00:43:05,670
please turn on Bluetooth and<font color="#E5E5E5"> they</font><font color="#CCCCCC"> are</font>

881
00:43:02,160 --> 00:43:08,490
like what no never again<font color="#E5E5E5"> not value here</font>

882
00:43:05,670 --> 00:43:10,530
<font color="#CCCCCC">but so this is the selection that I that</font>

883
00:43:08,490 --> 00:43:12,060
I got to move this with asking<font color="#E5E5E5"> people if</font>

884
00:43:10,530 --> 00:43:14,610
I could test<font color="#E5E5E5"> it</font>

885
00:43:12,060 --> 00:43:16,500
Broadcom never gave me<font color="#CCCCCC"> back a list of</font>

886
00:43:14,610 --> 00:43:21,540
vulnerable devices so I guess they

887
00:43:16,500 --> 00:43:21,990
didn't like<font color="#CCCCCC"> me so much yeah and what can</font>

888
00:43:21,540 --> 00:43:25,740
<font color="#E5E5E5">it do</font>

889
00:43:21,990 --> 00:43:27,600
well it just restarts or crashes<font color="#CCCCCC"> to</font>

890
00:43:25,740 --> 00:43:29,759
<font color="#E5E5E5">bluetooth so the restarting is if the</font>

891
00:43:27,600 --> 00:43:31,680
operating<font color="#E5E5E5"> system realizes bluetooth is</font>

892
00:43:29,760 --> 00:43:35,220
gone it might restart<font color="#E5E5E5"> it it depends</font><font color="#CCCCCC"> on</font>

893
00:43:31,680 --> 00:43:37,379
<font color="#CCCCCC">the configuration</font><font color="#E5E5E5"> and then</font><font color="#CCCCCC"> bluetooth is</font>

894
00:43:35,220 --> 00:43:41,160
no longer<font color="#E5E5E5"> doing things that's pretty</font>

895
00:43:37,380 --> 00:43:42,780
great so the test that<font color="#E5E5E5"> I'm that I used</font>

896
00:43:41,160 --> 00:43:45,629
most<font color="#E5E5E5"> of the</font><font color="#CCCCCC"> time it's just</font><font color="#E5E5E5"> that I have</font>

897
00:43:42,780 --> 00:43:47,970
some music<font color="#E5E5E5"> running which is then</font>

898
00:43:45,630 --> 00:43:56,550
interrupted<font color="#CCCCCC"> but it also works</font><font color="#E5E5E5"> without</font>

899
00:43:47,970 --> 00:43:58,020
music<font color="#E5E5E5"> so it's just restarted yeah so</font>

900
00:43:56,550 --> 00:43:59,880
maybe that's<font color="#E5E5E5"> the one that I'm going to</font>

901
00:43:58,020 --> 00:44:02,720
<font color="#CCCCCC">demo if that's the demo work again</font>

902
00:43:59,880 --> 00:44:02,720
that's the big question

903
00:44:19,480 --> 00:44:28,090
<font color="#E5E5E5">okay so this is not</font><font color="#CCCCCC"> the standard</font><font color="#E5E5E5"> setup</font>

904
00:44:24,740 --> 00:44:31,229
<font color="#E5E5E5">that I have here so I applied a patch</font>

905
00:44:28,090 --> 00:44:31,229
[Music]

906
00:44:34,540 --> 00:44:42,500
yeah look I'm on the screen funny

907
00:44:39,080 --> 00:44:45,350
so if I click connect<font color="#E5E5E5"> to the other</font>

908
00:44:42,500 --> 00:44:47,150
device then ideally if it's working<font color="#E5E5E5"> you</font>

909
00:44:45,350 --> 00:44:56,390
should<font color="#E5E5E5"> see</font><font color="#CCCCCC"> you to restart</font><font color="#E5E5E5"> it on the</font>

910
00:44:47,150 --> 00:45:01,960
iPhone<font color="#CCCCCC"> so who</font><font color="#E5E5E5"> wants to be on</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> screen</font>

911
00:44:56,390 --> 00:45:01,960
right now<font color="#E5E5E5"> I mean I can attack</font><font color="#CCCCCC"> right</font>

912
00:45:03,180 --> 00:45:07,600
[Music]

913
00:45:04,660 --> 00:45:11,509
probably<font color="#E5E5E5"> not</font><font color="#CCCCCC"> no it's blocking</font><font color="#E5E5E5"> which</font>

914
00:45:07,600 --> 00:45:21,109
responds differently but yeah<font color="#E5E5E5"> so funny</font>

915
00:45:11,510 --> 00:45:23,119
thing yeah

916
00:45:21,109 --> 00:45:26,020
now you might say<font color="#CCCCCC"> yeah okay it's just</font>

917
00:45:23,119 --> 00:45:29,390
<font color="#E5E5E5">restarting</font><font color="#CCCCCC"> bluetooth who cares</font>

918
00:45:26,020 --> 00:45:40,609
well some people<font color="#CCCCCC"> care</font><font color="#E5E5E5"> but it's actually</font>

919
00:45:29,390 --> 00:45:47,868
more<font color="#CCCCCC"> okay I didn't have he touched it so</font>

920
00:45:40,609 --> 00:45:49,970
<font color="#CCCCCC">it works so the issue here is that we</font>

921
00:45:47,869 --> 00:45:53,780
<font color="#E5E5E5">are actually jumping from one</font><font color="#CCCCCC"> handler</font>

922
00:45:49,970 --> 00:45:56,149
<font color="#E5E5E5">into the other handler</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> best case it</font>

923
00:45:53,780 --> 00:45:59,210
is that I'm executing<font color="#E5E5E5"> something that is</font>

924
00:45:56,150 --> 00:46:04,220
no valid code or no valid address and

925
00:45:59,210 --> 00:46:06,080
then it crashes<font color="#E5E5E5"> but compilers</font><font color="#CCCCCC"> they like</font>

926
00:46:04,220 --> 00:46:07,790
<font color="#E5E5E5">to put handlers after each other so you</font>

927
00:46:06,080 --> 00:46:09,470
have the one<font color="#CCCCCC"> Handler and</font><font color="#E5E5E5"> then you have</font>

928
00:46:07,790 --> 00:46:12,050
the next<font color="#E5E5E5"> handler and the next</font><font color="#CCCCCC"> Handler</font>

929
00:46:09,470 --> 00:46:16,939
<font color="#E5E5E5">and one of the next handlers happens to</font>

930
00:46:12,050 --> 00:46:20,450
be HCI<font color="#E5E5E5"> and there is HCI test commands</font>

931
00:46:16,940 --> 00:46:24,109
and stuff so I<font color="#E5E5E5"> can</font><font color="#CCCCCC"> actually</font><font color="#E5E5E5"> jump with</font>

932
00:46:20,450 --> 00:46:26,720
with some virus<font color="#E5E5E5"> whatever traffic into a</font>

933
00:46:24,109 --> 00:46:28,250
handler<font color="#CCCCCC"> that is</font><font color="#E5E5E5"> HCI and only should be</font>

934
00:46:26,720 --> 00:46:31,069
executed<font color="#CCCCCC"> locally</font>

935
00:46:28,250 --> 00:46:33,460
when I'm on<font color="#CCCCCC"> the host</font><font color="#E5E5E5"> so what I am able</font>

936
00:46:31,070 --> 00:46:36,170
to do is that with this<font color="#CCCCCC"> I can</font><font color="#E5E5E5"> also</font>

937
00:46:33,460 --> 00:46:38,510
execute the test mode on the<font color="#E5E5E5"> other</font>

938
00:46:36,170 --> 00:46:41,390
device<font color="#CCCCCC"> and say yeah you are now in test</font>

939
00:46:38,510 --> 00:46:45,770
mode<font color="#E5E5E5"> so that's for the Nexus 5 trip</font>

940
00:46:41,390 --> 00:46:47,990
<font color="#E5E5E5">which is</font><font color="#CCCCCC"> also in a few other devices and</font>

941
00:46:45,770 --> 00:46:49,790
I just say you are<font color="#E5E5E5"> now</font><font color="#CCCCCC"> doing test mode</font>

942
00:46:47,990 --> 00:46:51,830
and then I can drain<font color="#CCCCCC"> your battery or I</font>

943
00:46:49,790 --> 00:46:55,099
can make<font color="#E5E5E5"> gem</font><font color="#CCCCCC"> new certain frequencies a</font>

944
00:46:51,830 --> 00:46:57,049
test mode which I shared with Wi-Fi<font color="#CCCCCC"> so</font>

945
00:46:55,099 --> 00:47:02,960
at least there you will<font color="#CCCCCC"> definitely have</font>

946
00:46:57,050 --> 00:47:05,810
<font color="#CCCCCC">the problems in Wi-Fi</font><font color="#E5E5E5"> so we promised</font>

947
00:47:02,960 --> 00:47:08,660
welcome to<font color="#E5E5E5"> only publish the details in</font>

948
00:47:05,810 --> 00:47:10,609
summer<font color="#CCCCCC"> so yeah like</font><font color="#E5E5E5"> two three more</font>

949
00:47:08,660 --> 00:47:12,618
<font color="#E5E5E5">months to</font><font color="#CCCCCC"> go the paper is accepted and</font>

950
00:47:10,609 --> 00:47:17,029
<font color="#E5E5E5">so on but yeah so details will</font><font color="#CCCCCC"> follow on</font>

951
00:47:12,619 --> 00:47:21,320
<font color="#E5E5E5">this but they wrote off</font><font color="#CCCCCC"> our Petrus</font>

952
00:47:17,030 --> 00:47:24,410
recently so<font color="#E5E5E5"> the</font><font color="#CCCCCC"> iOS</font><font color="#E5E5E5"> 12</font><font color="#CCCCCC"> 1-3 definitely is</font>

953
00:47:21,320 --> 00:47:28,040
patched against<font color="#E5E5E5"> this so I have an older</font>

954
00:47:24,410 --> 00:47:29,960
iOS on this<font color="#E5E5E5"> iPhone here for the demo but</font>

955
00:47:28,040 --> 00:47:32,150
yeah so you<font color="#CCCCCC"> should always update your</font>

956
00:47:29,960 --> 00:47:35,560
<font color="#CCCCCC">device and I</font><font color="#E5E5E5"> don't know if this very old</font>

957
00:47:32,150 --> 00:47:38,680
ship is still<font color="#E5E5E5"> going</font><font color="#CCCCCC"> to be fixed</font><font color="#E5E5E5"> maybe</font>

958
00:47:35,560 --> 00:47:38,680
maybe not

959
00:47:39,099 --> 00:47:44,030
and now the question<font color="#E5E5E5"> is also what can</font>

960
00:47:41,869 --> 00:47:47,270
you do with<font color="#E5E5E5"> this so we try</font><font color="#CCCCCC"> to explore</font>

961
00:47:44,030 --> 00:47:49,339
things happening in there and the most

962
00:47:47,270 --> 00:47:51,710
useful<font color="#E5E5E5"> thing</font><font color="#CCCCCC"> that Dennis</font><font color="#E5E5E5"> added when I</font>

963
00:47:49,339 --> 00:47:53,720
stumbled around this was adding<font color="#E5E5E5"> trace</font>

964
00:47:51,710 --> 00:47:56,420
points<font color="#E5E5E5"> so in the very beginning I only</font>

965
00:47:53,720 --> 00:47:58,970
had<font color="#CCCCCC"> like oops addresses but what does it</font>

966
00:47:56,420 --> 00:48:01,910
<font color="#CCCCCC">do and then</font><font color="#E5E5E5"> is and it is very useful</font>

967
00:47:58,970 --> 00:48:04,339
<font color="#E5E5E5">feature where you can</font><font color="#CCCCCC"> say I want to add</font>

968
00:48:01,910 --> 00:48:10,098
a trace point so for example in the LMP

969
00:48:04,339 --> 00:48:12,529
dispatcher<font color="#CCCCCC"> and whenever i call this or</font>

970
00:48:10,099 --> 00:48:14,839
this one<font color="#E5E5E5"> gets called I get all registers</font>

971
00:48:12,530 --> 00:48:17,359
printed out and<font color="#CCCCCC"> icon can</font><font color="#E5E5E5"> even dump the</font>

972
00:48:14,839 --> 00:48:20,960
memory contents so<font color="#CCCCCC"> that I have some idea</font>

973
00:48:17,359 --> 00:48:22,970
of what is<font color="#CCCCCC"> going</font><font color="#E5E5E5"> on and after</font><font color="#CCCCCC"> this the</font>

974
00:48:20,960 --> 00:48:24,650
trace point will delete itself<font color="#E5E5E5"> so</font><font color="#CCCCCC"> that</font>

975
00:48:22,970 --> 00:48:26,750
if you<font color="#CCCCCC"> are running something</font><font color="#E5E5E5"> in a loop</font>

976
00:48:24,650 --> 00:48:31,820
that<font color="#E5E5E5"> it's not blocking the complete film</font>

977
00:48:26,750 --> 00:48:36,020
<font color="#E5E5E5">there then I also set up something with</font>

978
00:48:31,820 --> 00:48:38,150
unicorn and<font color="#E5E5E5"> red arrow</font><font color="#CCCCCC"> to which does some</font>

979
00:48:36,020 --> 00:48:41,930
function calls and<font color="#E5E5E5"> so on and memory</font>

980
00:48:38,150 --> 00:48:44,150
<font color="#CCCCCC">diffs but it's very slow</font>

981
00:48:41,930 --> 00:48:46,189
there's also<font color="#CCCCCC"> young sitting over there I</font>

982
00:48:44,150 --> 00:48:48,920
<font color="#E5E5E5">don't</font><font color="#CCCCCC"> know maybe he</font><font color="#E5E5E5"> hides yeah he did</font>

983
00:48:46,189 --> 00:48:51,199
something<font color="#CCCCCC"> that is a bit faster just on</font>

984
00:48:48,920 --> 00:48:53,660
qmo<font color="#E5E5E5"> base and so on</font>

985
00:48:51,199 --> 00:48:56,420
and then<font color="#E5E5E5"> you get tons of traces that you</font>

986
00:48:53,660 --> 00:48:57,348
can stare<font color="#CCCCCC"> onto and try to find out what</font>

987
00:48:56,420 --> 00:48:59,959
is<font color="#E5E5E5"> going on</font>

988
00:48:57,349 --> 00:49:03,739
for some strange<font color="#CCCCCC"> behaviour</font><font color="#E5E5E5"> that's really</font>

989
00:48:59,959 --> 00:49:08,689
great<font color="#CCCCCC"> so you can just</font><font color="#E5E5E5"> stare on tons of</font>

990
00:49:03,739 --> 00:49:14,529
<font color="#CCCCCC">information now fixing</font><font color="#E5E5E5"> bugs is pretty</font>

991
00:49:08,689 --> 00:49:16,999
hard so I mean as Dennis already said

992
00:49:14,529 --> 00:49:20,599
probably they<font color="#CCCCCC"> are never going</font><font color="#E5E5E5"> to fix it</font>

993
00:49:16,999 --> 00:49:22,939
<font color="#E5E5E5">for the older devices because this this</font>

994
00:49:20,599 --> 00:49:24,709
film verifies they they need<font color="#E5E5E5"> to go into</font>

995
00:49:22,939 --> 00:49:26,180
<font color="#CCCCCC">your operating system and</font><font color="#E5E5E5"> then</font><font color="#CCCCCC"> the</font>

996
00:49:24,709 --> 00:49:28,189
operating<font color="#E5E5E5"> system still needs to get</font>

997
00:49:26,180 --> 00:49:29,989
updates and<font color="#E5E5E5"> who is updating</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> smartphone</font>

998
00:49:28,189 --> 00:49:36,979
<font color="#CCCCCC">that</font><font color="#E5E5E5"> is older than like three or five</font>

999
00:49:29,989 --> 00:49:39,339
years<font color="#CCCCCC"> so this is pretty</font><font color="#E5E5E5"> hard so I</font><font color="#CCCCCC"> came</font>

1000
00:49:36,979 --> 00:49:42,198
<font color="#CCCCCC">up with</font><font color="#E5E5E5"> the idea to</font><font color="#CCCCCC"> do a pluto fireball</font>

1001
00:49:39,339 --> 00:49:45,140
<font color="#E5E5E5">that one is also available as as proof</font>

1002
00:49:42,199 --> 00:49:47,299
of<font color="#E5E5E5"> concept by now it's pretty funny so</font>

1003
00:49:45,140 --> 00:49:49,368
you<font color="#E5E5E5"> can just say it's</font><font color="#CCCCCC"> I only want to</font>

1004
00:49:47,299 --> 00:49:51,890
<font color="#E5E5E5">accept connections you have to</font><font color="#CCCCCC"> make a</font>

1005
00:49:49,369 --> 00:49:54,349
dress from my headset<font color="#CCCCCC"> I mean of course</font>

1006
00:49:51,890 --> 00:49:55,670
<font color="#CCCCCC">this someone can try to sniff</font><font color="#E5E5E5"> traffic</font>

1007
00:49:54,349 --> 00:49:57,319
and so on but if you're just<font color="#E5E5E5"> walking</font>

1008
00:49:55,670 --> 00:50:01,160
<font color="#E5E5E5">around without your headset nobody</font>

1009
00:49:57,319 --> 00:50:03,469
should be<font color="#CCCCCC"> able</font><font color="#E5E5E5"> to connect</font><font color="#CCCCCC"> and I then saw</font>

1010
00:50:01,160 --> 00:50:07,009
it's actually crashing at this<font color="#E5E5E5"> Bluetooth</font>

1011
00:50:03,469 --> 00:50:09,380
demon<font color="#CCCCCC"> so that's why I gave</font><font color="#E5E5E5"> them a bit</font>

1012
00:50:07,009 --> 00:50:11,809
more<font color="#E5E5E5"> time but they didn't respond</font><font color="#CCCCCC"> so</font><font color="#E5E5E5"> far</font>

1013
00:50:09,380 --> 00:50:14,650
so I<font color="#CCCCCC"> don't know</font><font color="#E5E5E5"> the fun part in the</font>

1014
00:50:11,809 --> 00:50:19,189
<font color="#CCCCCC">pluto forgiveness that this is trying to</font>

1015
00:50:14,650 --> 00:50:22,880
fix<font color="#CCCCCC"> around stuff in the proteome driver</font>

1016
00:50:19,189 --> 00:50:24,920
so whenever there is something<font color="#CCCCCC"> strange</font>

1017
00:50:22,880 --> 00:50:29,269
and<font color="#E5E5E5"> the Bluetooth</font><font color="#CCCCCC"> D</font><font color="#E5E5E5"> after a minute just</font>

1018
00:50:24,920 --> 00:50:31,549
decides to restart<font color="#CCCCCC"> Bluetooth</font><font color="#E5E5E5"> so for</font>

1019
00:50:29,269 --> 00:50:33,499
<font color="#E5E5E5">example if you now do a connection so I</font>

1020
00:50:31,549 --> 00:50:36,380
<font color="#E5E5E5">established a</font><font color="#CCCCCC"> connection then I would</font>

1021
00:50:33,499 --> 00:50:38,629
normally<font color="#E5E5E5"> get an HDI event back which is</font>

1022
00:50:36,380 --> 00:50:40,489
the connection was successful or I

1023
00:50:38,630 --> 00:50:43,279
couldn't<font color="#E5E5E5"> connect because the device is</font>

1024
00:50:40,489 --> 00:50:46,549
<font color="#CCCCCC">not there and what happens here is</font><font color="#E5E5E5"> I</font>

1025
00:50:43,279 --> 00:50:52,249
sent the<font color="#E5E5E5"> connect request over</font><font color="#CCCCCC"> HCI and</font>

1026
00:50:46,549 --> 00:50:54,920
then the device it's<font color="#E5E5E5"> just saying</font><font color="#CCCCCC"> LMP not</font>

1027
00:50:52,249 --> 00:50:55,700
accepted<font color="#E5E5E5"> so it's a message</font><font color="#CCCCCC"> that is not</font>

1028
00:50:54,920 --> 00:50:57,710
<font color="#E5E5E5">expected</font>

1029
00:50:55,700 --> 00:51:00,109
<font color="#CCCCCC">here then the Broadcom femme where is</font>

1030
00:50:57,710 --> 00:51:02,210
not<font color="#E5E5E5"> sending any</font><font color="#CCCCCC"> HC I went</font><font color="#E5E5E5"> back</font><font color="#CCCCCC"> because</font>

1031
00:51:00,109 --> 00:51:06,500
<font color="#CCCCCC">LM px</font><font color="#E5E5E5"> not</font><font color="#CCCCCC"> accept what you</font><font color="#E5E5E5"> don't get it</font>

1032
00:51:02,210 --> 00:51:09,890
at the stage normally<font color="#CCCCCC"> and then</font><font color="#E5E5E5"> there is</font>

1033
00:51:06,500 --> 00:51:12,470
no report<font color="#CCCCCC"> bake it times out no event and</font>

1034
00:51:09,890 --> 00:51:14,420
just restart so not really some

1035
00:51:12,470 --> 00:51:17,089
execution or something it's<font color="#CCCCCC"> more like a</font>

1036
00:51:14,420 --> 00:51:19,430
back and I think this back also<font color="#E5E5E5"> tells a</font>

1037
00:51:17,089 --> 00:51:21,349
lot about<font color="#E5E5E5"> how stable this driver is so</font>

1038
00:51:19,430 --> 00:51:24,078
whenever something<font color="#CCCCCC"> is strange</font><font color="#E5E5E5"> and I'm</font>

1039
00:51:21,349 --> 00:51:27,470
not<font color="#E5E5E5"> getting the events that I expected</font>

1040
00:51:24,079 --> 00:51:35,990
I just<font color="#CCCCCC"> restarted because yeah I don't</font>

1041
00:51:27,470 --> 00:51:38,810
<font color="#E5E5E5">know what it's doing</font><font color="#CCCCCC"> so this this vendor</font>

1042
00:51:35,990 --> 00:51:41,839
fixes are already being rolled out

1043
00:51:38,810 --> 00:51:44,270
that's that's pretty<font color="#E5E5E5"> cool</font><font color="#CCCCCC"> um but also</font>

1044
00:51:41,839 --> 00:51:46,670
<font color="#E5E5E5">these updates</font><font color="#CCCCCC"> leak the</font><font color="#E5E5E5"> vulnerability so</font>

1045
00:51:44,270 --> 00:51:50,359
probably if you<font color="#CCCCCC"> managed to</font><font color="#E5E5E5"> extract the</font>

1046
00:51:46,670 --> 00:51:52,550
<font color="#E5E5E5">SD file from the most recent smartphones</font>

1047
00:51:50,359 --> 00:51:55,520
and<font color="#E5E5E5"> compare what prot</font><font color="#CCCCCC"> comm has been</font>

1048
00:51:52,550 --> 00:51:58,160
patching<font color="#E5E5E5"> you will be able what exactly</font>

1049
00:51:55,520 --> 00:52:00,680
is the handler<font color="#E5E5E5"> to</font><font color="#CCCCCC"> tremendous what</font>

1050
00:51:58,160 --> 00:52:02,390
<font color="#CCCCCC">handlers</font><font color="#E5E5E5"> so because this this this</font>

1051
00:52:00,680 --> 00:52:04,430
updates they are not signed they are not

1052
00:52:02,390 --> 00:52:07,040
<font color="#CCCCCC">encrypted</font><font color="#E5E5E5"> it's the same mechanisms that</font>

1053
00:52:04,430 --> 00:52:11,328
we<font color="#E5E5E5"> use for patching you can probably</font>

1054
00:52:07,040 --> 00:52:14,930
find it mmm and the next funny part is

1055
00:52:11,329 --> 00:52:18,020
that<font color="#E5E5E5"> normally things are a bit outdated</font>

1056
00:52:14,930 --> 00:52:20,629
so<font color="#CCCCCC"> I said they</font><font color="#E5E5E5"> close</font><font color="#CCCCCC"> to back in 2014</font><font color="#E5E5E5"> and</font>

1057
00:52:18,020 --> 00:52:24,890
summer but it was still in<font color="#CCCCCC"> the</font><font color="#E5E5E5"> MacBook</font>

1058
00:52:20,630 --> 00:52:28,069
from 2016<font color="#CCCCCC"> because the the the film</font><font color="#E5E5E5"> there</font>

1059
00:52:24,890 --> 00:52:30,799
on the chip is even<font color="#E5E5E5"> older than some some</font>

1060
00:52:28,069 --> 00:52:32,740
<font color="#E5E5E5">other stuff around Assad's like around</font>

1061
00:52:30,800 --> 00:52:36,160
<font color="#E5E5E5">the same date</font><font color="#CCCCCC"> of the datasheet probably</font>

1062
00:52:32,740 --> 00:52:38,868
and then if you<font color="#E5E5E5"> get a very recent device</font>

1063
00:52:36,160 --> 00:52:42,828
<font color="#CCCCCC">there's typically a Bluetooth firmware</font>

1064
00:52:38,869 --> 00:52:45,980
on it that is two years old that's not

1065
00:52:42,829 --> 00:52:49,130
so nice<font color="#E5E5E5"> actually if you have</font><font color="#CCCCCC"> a very</font><font color="#E5E5E5"> very</font>

1066
00:52:45,980 --> 00:52:51,500
old ship then these do<font color="#CCCCCC"> not seem to</font><font color="#E5E5E5"> be</font>

1067
00:52:49,130 --> 00:52:56,420
vulnerable<font color="#E5E5E5"> but probably they have other</font>

1068
00:52:51,500 --> 00:52:58,220
vulnerabilities<font color="#E5E5E5"> you never know</font><font color="#CCCCCC"> so that's</font>

1069
00:52:56,420 --> 00:53:00,460
<font color="#E5E5E5">it and we still have a few minutes</font><font color="#CCCCCC"> for</font>

1070
00:52:58,220 --> 00:53:00,459
<font color="#E5E5E5">Q&A</font>

1071
00:53:03,520 --> 00:53:17,969
[Applause]

1072
00:53:06,210 --> 00:53:20,710
let's talk any questions I have one

1073
00:53:17,969 --> 00:53:25,809
<font color="#E5E5E5">chipset that</font><font color="#CCCCCC"> I want to do but the</font>

1074
00:53:20,710 --> 00:53:28,239
<font color="#CCCCCC">problem is most vendors</font><font color="#E5E5E5"> do sign and so</font>

1075
00:53:25,809 --> 00:53:31,329
on their day<font color="#E5E5E5"> updates so for most vendors</font>

1076
00:53:28,239 --> 00:53:34,059
<font color="#E5E5E5">you cannot just do</font><font color="#CCCCCC"> something within the</font>

1077
00:53:31,329 --> 00:53:35,890
film there<font color="#E5E5E5"> yeah</font><font color="#CCCCCC"> so one of the</font><font color="#E5E5E5"> reasons we</font>

1078
00:53:34,059 --> 00:53:38,079
choose<font color="#CCCCCC"> Broadcom is because they made it</font>

1079
00:53:35,890 --> 00:53:39,788
<font color="#E5E5E5">really easy</font><font color="#CCCCCC"> for</font><font color="#E5E5E5"> us there are those HDI</font>

1080
00:53:38,079 --> 00:53:41,499
commands<font color="#E5E5E5"> they implement to read out</font>

1081
00:53:39,789 --> 00:53:44,380
memory and write<font color="#E5E5E5"> memory which is really</font>

1082
00:53:41,499 --> 00:53:47,078
<font color="#E5E5E5">really nice for security researchers and</font>

1083
00:53:44,380 --> 00:53:49,239
for other chipsets we haven't found this

1084
00:53:47,079 --> 00:53:51,099
yet<font color="#CCCCCC"> and but</font><font color="#E5E5E5"> we also haven't really</font>

1085
00:53:49,239 --> 00:53:53,170
looked into<font color="#E5E5E5"> some of the others I guess</font>

1086
00:53:51,099 --> 00:53:55,749
<font color="#E5E5E5">interesting yeah would be other devices</font>

1087
00:53:53,170 --> 00:53:57,160
<font color="#E5E5E5">like Apple devices and also like Intel</font>

1088
00:53:55,749 --> 00:54:00,218
chipsets because they are<font color="#CCCCCC"> almost</font>

1089
00:53:57,160 --> 00:54:03,609
<font color="#CCCCCC">everywhere in the laptops but here so</font>

1090
00:54:00,219 --> 00:54:06,249
far<font color="#E5E5E5"> no yeah so to say I mean I have one</font>

1091
00:54:03,609 --> 00:54:09,069
<font color="#CCCCCC">day I have like</font><font color="#E5E5E5"> leaked vendor-specific</font>

1092
00:54:06,249 --> 00:54:10,629
<font color="#E5E5E5">HDI commands but yeah I mean my to-do</font>

1093
00:54:09,069 --> 00:54:17,140
<font color="#CCCCCC">list is long and I have a couple</font><font color="#E5E5E5"> of</font>

1094
00:54:10,630 --> 00:54:19,269
students yeah<font color="#E5E5E5"> but at least there's very</font>

1095
00:54:17,140 --> 00:54:21,848
many<font color="#CCCCCC"> devices we have</font><font color="#E5E5E5"> brought home chips</font>

1096
00:54:19,269 --> 00:54:23,709
so it's like<font color="#E5E5E5"> 20 or</font><font color="#CCCCCC"> 30 percent</font><font color="#E5E5E5"> so getting</font>

1097
00:54:21,849 --> 00:54:25,900
a good<font color="#E5E5E5"> support for the</font><font color="#CCCCCC"> Broadcom chips</font>

1098
00:54:23,710 --> 00:54:31,690
<font color="#CCCCCC">it's</font><font color="#E5E5E5"> probably worth more than supporting</font>

1099
00:54:25,900 --> 00:54:34,749
like<font color="#CCCCCC"> 10</font><font color="#E5E5E5"> different vendors</font><font color="#CCCCCC"> all right are</font>

1100
00:54:31,690 --> 00:54:36,350
the questions and thanks<font color="#CCCCCC"> again</font><font color="#E5E5E5"> very</font><font color="#CCCCCC"> much</font>

1101
00:54:34,749 --> 00:54:39,968
<font color="#E5E5E5">very good talk</font>

1102
00:54:36,350 --> 00:54:39,969
[Applause]

