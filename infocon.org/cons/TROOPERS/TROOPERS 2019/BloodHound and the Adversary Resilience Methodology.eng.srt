1
00:00:01,199 --> 00:00:07,450
<font color="#E5E5E5">okay so welcome</font><font color="#CCCCCC"> back everyone to</font><font color="#E5E5E5"> the ad</font>

2
00:00:04,840 --> 00:00:10,179
<font color="#E5E5E5">security track next up we have Andrew</font>

3
00:00:07,450 --> 00:00:12,370
Robbins and Rohan<font color="#CCCCCC"> as you might</font><font color="#E5E5E5"> have</font>

4
00:00:10,179 --> 00:00:14,469
guessed<font color="#E5E5E5"> by all the</font><font color="#CCCCCC"> bloodhound logos</font><font color="#E5E5E5"> they</font>

5
00:00:12,370 --> 00:00:17,859
will talk about bloodhound<font color="#CCCCCC"> and</font><font color="#E5E5E5"> and we</font>

6
00:00:14,469 --> 00:00:20,380
will present<font color="#E5E5E5"> a methodology how you can</font>

7
00:00:17,859 --> 00:00:20,830
improve<font color="#CCCCCC"> your security posture</font><font color="#E5E5E5"> in Active</font>

8
00:00:20,380 --> 00:00:24,250
Directory

9
00:00:20,830 --> 00:00:26,310
by utilizing<font color="#E5E5E5"> bloodhound the stage is</font>

10
00:00:24,250 --> 00:00:29,170
yours<font color="#E5E5E5"> thank you</font>

11
00:00:26,310 --> 00:00:31,630
<font color="#CCCCCC">alright I hope</font><font color="#E5E5E5"> everyone's well fed</font><font color="#CCCCCC"> and</font>

12
00:00:29,170 --> 00:00:34,059
starting to get into that<font color="#E5E5E5"> sleepy state</font>

13
00:00:31,630 --> 00:00:36,129
<font color="#E5E5E5">so that</font><font color="#CCCCCC"> and Andy</font><font color="#E5E5E5"> can finish putting you</font>

14
00:00:34,059 --> 00:00:38,169
to sleep<font color="#E5E5E5"> later all</font><font color="#CCCCCC"> right so we're</font>

15
00:00:36,130 --> 00:00:40,030
actually<font color="#E5E5E5"> gonna talk about bloodhound</font><font color="#CCCCCC"> and</font>

16
00:00:38,170 --> 00:00:41,770
<font color="#CCCCCC">the adversary resilience methodology</font>

17
00:00:40,030 --> 00:00:43,300
today as you can<font color="#CCCCCC"> see from</font><font color="#E5E5E5"> our shirts</font>

18
00:00:41,770 --> 00:00:44,860
we're wearing<font color="#E5E5E5"> blue shirts today so we're</font>

19
00:00:43,300 --> 00:00:49,569
actually gonna be blue teamers for once

20
00:00:44,860 --> 00:00:50,590
mostly<font color="#E5E5E5"> I know yeah this this comment</font>

21
00:00:49,570 --> 00:00:51,879
this<font color="#CCCCCC"> hopefully is</font><font color="#E5E5E5"> gonna</font><font color="#CCCCCC"> be</font><font color="#E5E5E5"> a disaster</font>

22
00:00:50,590 --> 00:00:53,829
<font color="#E5E5E5">because neither of us are really blue</font>

23
00:00:51,879 --> 00:00:57,550
teamers but we're just<font color="#CCCCCC"> here for ten so</font>

24
00:00:53,829 --> 00:01:01,780
if we mess up don't<font color="#E5E5E5"> heckle us so yep</font>

25
00:00:57,550 --> 00:01:05,140
<font color="#CCCCCC">that's me okay that's</font><font color="#E5E5E5"> it hey that's</font><font color="#CCCCCC"> me</font>

26
00:01:01,780 --> 00:01:07,030
old picture<font color="#E5E5E5"> all</font><font color="#CCCCCC"> right so we're gonna</font>

27
00:01:05,140 --> 00:01:08,619
<font color="#CCCCCC">start</font><font color="#E5E5E5"> with the cornerstone of every</font>

28
00:01:07,030 --> 00:01:10,420
<font color="#E5E5E5">single</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> of our presentations this</font>

29
00:01:08,619 --> 00:01:12,939
<font color="#E5E5E5">great</font><font color="#CCCCCC"> Court this great great quote by</font>

30
00:01:10,420 --> 00:01:14,680
John Lambert<font color="#E5E5E5"> John Lambert said defenders</font>

31
00:01:12,939 --> 00:01:16,929
thinking lists attackers thinking graphs

32
00:01:14,680 --> 00:01:19,570
<font color="#CCCCCC">as long as this is true attackers win I</font>

33
00:01:16,930 --> 00:01:22,869
love it when attackers win<font color="#CCCCCC"> I mean no</font><font color="#E5E5E5"> a</font>

34
00:01:19,570 --> 00:01:24,639
blue team<font color="#E5E5E5"> so this is actually a really</font>

35
00:01:22,869 --> 00:01:27,159
important cornerstone of how we founded

36
00:01:24,640 --> 00:01:29,740
the Bloodhound<font color="#E5E5E5"> project when</font><font color="#CCCCCC"> we were</font>

37
00:01:27,159 --> 00:01:33,490
<font color="#E5E5E5">looking through problems that we were</font>

38
00:01:29,740 --> 00:01:35,949
having<font color="#E5E5E5"> on pen tests and</font><font color="#CCCCCC"> read teams this</font>

39
00:01:33,490 --> 00:01:37,869
<font color="#E5E5E5">is kind of what motivated us</font><font color="#CCCCCC"> to design</font>

40
00:01:35,950 --> 00:01:39,250
<font color="#CCCCCC">the project as it is just like a quick</font>

41
00:01:37,869 --> 00:01:42,130
show of hands how<font color="#CCCCCC"> many people</font><font color="#E5E5E5"> have used</font>

42
00:01:39,250 --> 00:01:46,560
bloodhound how many people have no<font color="#CCCCCC"> idea</font>

43
00:01:42,130 --> 00:01:50,439
what bloodhound is ouch<font color="#E5E5E5"> that hurts all</font>

44
00:01:46,560 --> 00:01:52,119
<font color="#CCCCCC">right well so</font><font color="#E5E5E5"> Brown is a active</font>

45
00:01:50,439 --> 00:01:54,548
directory permissions mapping tool that

46
00:01:52,119 --> 00:01:55,899
we use to<font color="#E5E5E5"> map out lots of different</font><font color="#CCCCCC"> cool</font>

47
00:01:54,549 --> 00:01:57,759
things<font color="#E5E5E5"> in active directory like</font><font color="#CCCCCC"> who's</font>

48
00:01:55,899 --> 00:01:59,950
admin where who belongs<font color="#E5E5E5"> to what groups</font>

49
00:01:57,759 --> 00:02:02,320
and it lets you paths find from one node

50
00:01:59,950 --> 00:02:05,619
<font color="#CCCCCC">to another and figure out</font><font color="#E5E5E5"> how can I go</font>

51
00:02:02,320 --> 00:02:08,320
<font color="#CCCCCC">from Andy to domain admins</font><font color="#E5E5E5"> or</font><font color="#CCCCCC"> Eddy</font><font color="#E5E5E5"> to</font>

52
00:02:05,619 --> 00:02:09,940
domain admins does it work<font color="#CCCCCC"> if you're not</font>

53
00:02:08,320 --> 00:02:12,310
<font color="#CCCCCC">aware we actually very</font><font color="#E5E5E5"> recently released</font>

54
00:02:09,940 --> 00:02:14,450
bloodhound 2.1 and by recently<font color="#CCCCCC"> I mean</font>

55
00:02:12,310 --> 00:02:18,000
like three days ago

56
00:02:14,450 --> 00:02:21,810
we hope<font color="#CCCCCC"> that messed up</font><font color="#E5E5E5"> Walters project</font>

57
00:02:18,000 --> 00:02:24,420
because he<font color="#CCCCCC"> was presenting on stuff so we</font>

58
00:02:21,810 --> 00:02:25,770
had a few cool features<font color="#CCCCCC"> the</font><font color="#E5E5E5"> biggest one</font>

59
00:02:24,420 --> 00:02:27,869
<font color="#E5E5E5">is resource based constrained delegation</font>

60
00:02:25,770 --> 00:02:29,520
<font color="#CCCCCC">how many people here</font><font color="#E5E5E5"> of read a</font><font color="#CCCCCC"> lodge</font>

61
00:02:27,870 --> 00:02:31,470
<font color="#E5E5E5">tamir's post on resource based</font>

62
00:02:29,520 --> 00:02:32,690
constrained delegation<font color="#CCCCCC"> how many people</font>

63
00:02:31,470 --> 00:02:35,010
understood<font color="#CCCCCC"> it</font>

64
00:02:32,690 --> 00:02:38,370
if anyone<font color="#CCCCCC"> raised</font><font color="#E5E5E5"> their hand like you are</font>

65
00:02:35,010 --> 00:02:40,649
<font color="#CCCCCC">God</font><font color="#E5E5E5"> so that</font><font color="#CCCCCC"> there's a very complicated</font>

66
00:02:38,370 --> 00:02:43,530
<font color="#E5E5E5">blog post and thankfully</font><font color="#CCCCCC"> we have the</font>

67
00:02:40,650 --> 00:02:46,470
great wilharm joy<font color="#CCCCCC"> who can dumb it down</font>

68
00:02:43,530 --> 00:02:47,490
<font color="#CCCCCC">for us some dummies over here and he</font>

69
00:02:46,470 --> 00:02:49,859
actually<font color="#E5E5E5"> did a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> work on</font>

70
00:02:47,490 --> 00:02:52,290
weaponization<font color="#E5E5E5"> using his project Rubeus</font>

71
00:02:49,860 --> 00:02:54,810
and we integrated some<font color="#E5E5E5"> of that into the</font>

72
00:02:52,290 --> 00:02:57,390
<font color="#E5E5E5">Bloodhound project</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is a really cool</font>

73
00:02:54,810 --> 00:02:59,220
attack primitive we've been wishing

74
00:02:57,390 --> 00:03:01,529
since pretty much<font color="#E5E5E5"> be released this</font>

75
00:02:59,220 --> 00:03:04,620
project that we had a computer<font color="#CCCCCC"> takeover</font>

76
00:03:01,530 --> 00:03:06,630
primitive<font color="#CCCCCC"> and we didn't until recently</font>

77
00:03:04,620 --> 00:03:09,870
<font color="#E5E5E5">the</font><font color="#CCCCCC"> only one we had before</font><font color="#E5E5E5"> was laps and</font>

78
00:03:06,630 --> 00:03:12,390
<font color="#E5E5E5">laps is kind of tricky</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> really always</font>

79
00:03:09,870 --> 00:03:15,000
<font color="#CCCCCC">supported however</font><font color="#E5E5E5"> with this as long as</font>

80
00:03:12,390 --> 00:03:16,589
you have<font color="#E5E5E5"> right abilities to this</font><font color="#CCCCCC"> msds</font>

81
00:03:15,000 --> 00:03:19,200
allowed to act on behalf<font color="#E5E5E5"> of other</font>

82
00:03:16,590 --> 00:03:20,810
identity attribute which<font color="#CCCCCC"> is you know</font>

83
00:03:19,200 --> 00:03:23,820
such a short and<font color="#E5E5E5"> easy to remember one</font>

84
00:03:20,810 --> 00:03:26,460
you can take<font color="#E5E5E5"> over</font><font color="#CCCCCC"> a computer too</font>

85
00:03:23,820 --> 00:03:28,140
the only only<font color="#CCCCCC"> thing you need is a user</font>

86
00:03:26,460 --> 00:03:31,470
account<font color="#CCCCCC"> you control</font><font color="#E5E5E5"> with a service</font>

87
00:03:28,140 --> 00:03:33,029
<font color="#CCCCCC">principal</font><font color="#E5E5E5"> name and thankfully by default</font>

88
00:03:31,470 --> 00:03:35,880
<font color="#E5E5E5">any user an</font><font color="#CCCCCC"> active</font><font color="#E5E5E5"> directory can create</font>

89
00:03:33,030 --> 00:03:39,270
<font color="#E5E5E5">ten of those so thank you Microsoft for</font>

90
00:03:35,880 --> 00:03:41,460
really bad defaults as per usual<font color="#E5E5E5"> so in</font>

91
00:03:39,270 --> 00:03:44,400
the graph<font color="#E5E5E5"> you'll now see this new</font>

92
00:03:41,460 --> 00:03:46,890
wonderful<font color="#E5E5E5"> edge at a lab to act if you</font>

93
00:03:44,400 --> 00:03:48,990
see this<font color="#CCCCCC"> you can execute this attack</font>

94
00:03:46,890 --> 00:03:52,589
<font color="#E5E5E5">take over a computer and go on your</font>

95
00:03:48,990 --> 00:03:54,450
merry<font color="#E5E5E5"> way we added a</font><font color="#CCCCCC"> bunch of UI</font>

96
00:03:52,590 --> 00:03:56,880
improvements<font color="#E5E5E5"> there's a new database</font>

97
00:03:54,450 --> 00:03:58,470
<font color="#CCCCCC">warm-up button a lot</font><font color="#E5E5E5"> of people complain</font>

98
00:03:56,880 --> 00:04:02,220
to us<font color="#E5E5E5"> that queries are really slow and</font>

99
00:03:58,470 --> 00:04:03,330
we say well that's neo4j<font color="#E5E5E5"> fault</font><font color="#CCCCCC"> so we</font>

100
00:04:02,220 --> 00:04:05,160
actually<font color="#CCCCCC"> does offload of the</font><font color="#E5E5E5"> worked in</font>

101
00:04:03,330 --> 00:04:06,870
the o4j again because that's how we do

102
00:04:05,160 --> 00:04:08,549
<font color="#E5E5E5">it</font><font color="#CCCCCC"> so when you click the database</font>

103
00:04:06,870 --> 00:04:10,020
warm-up button we load the<font color="#CCCCCC"> entire graph</font>

104
00:04:08,550 --> 00:04:11,070
into memory for you and then everything

105
00:04:10,020 --> 00:04:12,900
<font color="#E5E5E5">is a lot faster</font>

106
00:04:11,070 --> 00:04:14,640
the downside is<font color="#CCCCCC"> you take up like</font><font color="#E5E5E5"> eight</font>

107
00:04:12,900 --> 00:04:17,880
gigs of<font color="#CCCCCC"> RAM but you know who these</font><font color="#E5E5E5"> Rams</font>

108
00:04:14,640 --> 00:04:19,108
<font color="#E5E5E5">like that's that's</font><font color="#CCCCCC"> just cheap so yeah</font>

109
00:04:17,880 --> 00:04:21,298
make sure<font color="#CCCCCC"> you have a lot of</font><font color="#E5E5E5"> RAM before</font>

110
00:04:19,108 --> 00:04:24,180
you click that<font color="#CCCCCC"> button once you click</font><font color="#E5E5E5"> it</font>

111
00:04:21,298 --> 00:04:26,370
<font color="#E5E5E5">I think we saw speed ups</font><font color="#CCCCCC"> up like</font><font color="#E5E5E5"> 70% on</font>

112
00:04:24,180 --> 00:04:27,870
certain queries<font color="#CCCCCC"> so it's pretty</font>

113
00:04:26,370 --> 00:04:29,160
<font color="#E5E5E5">significant</font>

114
00:04:27,870 --> 00:04:32,580
don't look<font color="#E5E5E5"> at your task manager</font><font color="#CCCCCC"> you'll</font>

115
00:04:29,160 --> 00:04:34,560
be<font color="#E5E5E5"> really sad</font><font color="#CCCCCC"> we actually went</font><font color="#E5E5E5"> back and</font>

116
00:04:32,580 --> 00:04:35,849
<font color="#E5E5E5">optimized a lot of queries</font><font color="#CCCCCC"> every now and</font>

117
00:04:34,560 --> 00:04:37,199
then we do<font color="#E5E5E5"> this we just go</font><font color="#CCCCCC"> through all</font>

118
00:04:35,850 --> 00:04:38,910
<font color="#CCCCCC">our pre-built queries everything in the</font>

119
00:04:37,199 --> 00:04:41,370
UI<font color="#E5E5E5"> because</font><font color="#CCCCCC"> we're constantly</font><font color="#E5E5E5"> learning</font>

120
00:04:38,910 --> 00:04:42,750
<font color="#E5E5E5">cipher if this may be news to</font><font color="#CCCCCC"> you but</font><font color="#E5E5E5"> we</font>

121
00:04:41,370 --> 00:04:44,820
knew<font color="#E5E5E5"> nothing about</font><font color="#CCCCCC"> cipher before we</font>

122
00:04:42,750 --> 00:04:46,650
start using neo4j<font color="#CCCCCC"> so as we keep learning</font>

123
00:04:44,820 --> 00:04:49,349
<font color="#E5E5E5">it we keep optimizing and we keep trying</font>

124
00:04:46,650 --> 00:04:50,549
<font color="#E5E5E5">to make</font><font color="#CCCCCC"> it better</font><font color="#E5E5E5"> just for you</font><font color="#CCCCCC"> guys this</font>

125
00:04:49,350 --> 00:04:54,330
<font color="#E5E5E5">is this is all for you</font>

126
00:04:50,550 --> 00:04:56,220
not for<font color="#CCCCCC"> us yeah for the people another</font>

127
00:04:54,330 --> 00:04:57,570
thing<font color="#E5E5E5"> people complain to</font><font color="#CCCCCC"> us about is how</font>

128
00:04:56,220 --> 00:05:01,650
so was to upload<font color="#E5E5E5"> data</font>

129
00:04:57,570 --> 00:05:03,389
<font color="#CCCCCC">well we fix it</font><font color="#E5E5E5"> yay</font><font color="#CCCCCC"> that's a lot faster</font>

130
00:05:01,650 --> 00:05:06,810
now<font color="#E5E5E5"> for pretty much any data type</font>

131
00:05:03,389 --> 00:05:08,520
<font color="#E5E5E5">there's a few few exceptions</font><font color="#CCCCCC"> GPOs in</font>

132
00:05:06,810 --> 00:05:10,610
particular are<font color="#CCCCCC"> to complete and utter</font>

133
00:05:08,520 --> 00:05:12,990
mess<font color="#E5E5E5"> so they're still kind of slow but</font>

134
00:05:10,610 --> 00:05:15,990
<font color="#CCCCCC">GPAs were messing Windows too so that's</font>

135
00:05:12,990 --> 00:05:18,000
not really<font color="#CCCCCC"> a surprise a lot</font><font color="#E5E5E5"> of people</font>

136
00:05:15,990 --> 00:05:20,520
use the query debug mode for learning

137
00:05:18,000 --> 00:05:21,930
how do you do<font color="#E5E5E5"> cipher so turns out that</font>

138
00:05:20,520 --> 00:05:23,400
hadn't<font color="#CCCCCC"> been updated</font><font color="#E5E5E5"> since we introduced</font>

139
00:05:21,930 --> 00:05:24,960
<font color="#E5E5E5">the feature so</font><font color="#CCCCCC"> we updated it now it's a</font>

140
00:05:23,400 --> 00:05:27,570
lot easier<font color="#CCCCCC"> and</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> actually like formats</font>

141
00:05:24,960 --> 00:05:29,698
things for you it puts the query like<font color="#E5E5E5"> so</font>

142
00:05:27,570 --> 00:05:31,199
you<font color="#E5E5E5"> can use it like you know like you</font>

143
00:05:29,699 --> 00:05:33,630
<font color="#E5E5E5">would expect from something</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> helped</font>

144
00:05:31,199 --> 00:05:36,389
you learn<font color="#E5E5E5"> but now it actually works</font><font color="#CCCCCC"> I</font>

145
00:05:33,630 --> 00:05:38,820
promise<font color="#E5E5E5"> there's tons and tons of bug</font>

146
00:05:36,389 --> 00:05:41,400
fixes<font color="#CCCCCC"> underneath the hood</font><font color="#E5E5E5"> not just from</font>

147
00:05:38,820 --> 00:05:42,960
<font color="#E5E5E5">us actually I would say this particular</font>

148
00:05:41,400 --> 00:05:44,340
release had more community contribution

149
00:05:42,960 --> 00:05:46,710
than just about any other release we've

150
00:05:44,340 --> 00:05:51,510
had<font color="#E5E5E5"> particularly from</font><font color="#CCCCCC"> people like Dirk</font>

151
00:05:46,710 --> 00:05:54,090
<font color="#CCCCCC">yon who is somewhere</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> yeah and the</font>

152
00:05:51,510 --> 00:05:56,699
the great crypto<font color="#E5E5E5"> ml and Clement</font><font color="#CCCCCC"> node</font><font color="#E5E5E5"> in</font>

153
00:05:54,090 --> 00:05:58,020
and we got<font color="#CCCCCC"> a bunch of</font><font color="#E5E5E5"> other thing I I</font>

154
00:05:56,699 --> 00:05:59,340
<font color="#CCCCCC">called out a whole bunch of people</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> my</font>

155
00:05:58,020 --> 00:06:02,010
<font color="#E5E5E5">blog post to make sure that everyone got</font>

156
00:05:59,340 --> 00:06:03,780
credit where it was due but this this

157
00:06:02,010 --> 00:06:06,090
was<font color="#E5E5E5"> really more</font><font color="#CCCCCC"> a bug</font><font color="#E5E5E5"> fix release than</font>

158
00:06:03,780 --> 00:06:08,539
anything but<font color="#E5E5E5"> we don't like doing minor</font>

159
00:06:06,090 --> 00:06:11,299
<font color="#E5E5E5">releases so we just made a two point one</font>

160
00:06:08,539 --> 00:06:13,650
there's help<font color="#CCCCCC"> text built</font><font color="#E5E5E5"> into the UI</font>

161
00:06:11,300 --> 00:06:16,020
<font color="#E5E5E5">apparently nobody knows about this</font>

162
00:06:13,650 --> 00:06:17,669
<font color="#E5E5E5">feature</font><font color="#CCCCCC"> if you right-click on an edge in</font>

163
00:06:16,020 --> 00:06:19,169
<font color="#CCCCCC">the bloodhound UI</font><font color="#E5E5E5"> it actually pops up a</font>

164
00:06:17,669 --> 00:06:22,260
big help window which even tells<font color="#E5E5E5"> you</font>

165
00:06:19,169 --> 00:06:24,389
exactly how<font color="#E5E5E5"> to exploit stuff it's really</font>

166
00:06:22,260 --> 00:06:26,760
<font color="#CCCCCC">kind of just lazy mode and it looks like</font>

167
00:06:24,389 --> 00:06:28,260
that<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> actually went back</font><font color="#CCCCCC"> and</font>

168
00:06:26,760 --> 00:06:30,960
updated a bunch of help text so nobody

169
00:06:28,260 --> 00:06:33,030
can<font color="#E5E5E5"> use it this is</font><font color="#CCCCCC"> actually the help</font>

170
00:06:30,960 --> 00:06:34,560
test for<font color="#CCCCCC"> Adelaide</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> act</font><font color="#E5E5E5"> so when you</font>

171
00:06:33,030 --> 00:06:36,929
look at<font color="#E5E5E5"> this it'll give you some general</font>

172
00:06:34,560 --> 00:06:38,370
<font color="#E5E5E5">information you know if you go to the</font>

173
00:06:36,930 --> 00:06:39,249
abuse info tab<font color="#E5E5E5"> over there</font><font color="#CCCCCC"> it actually</font>

174
00:06:38,370 --> 00:06:40,929
<font color="#CCCCCC">walk you</font><font color="#E5E5E5"> through</font>

175
00:06:39,249 --> 00:06:44,079
how to exploit this entire thing using

176
00:06:40,929 --> 00:06:47,529
<font color="#E5E5E5">Rubeus</font><font color="#CCCCCC"> thanks to will for doing that</font>

177
00:06:44,079 --> 00:06:49,929
wonderful<font color="#CCCCCC"> write-up for</font><font color="#E5E5E5"> us we also made a</font>

178
00:06:47,529 --> 00:06:52,779
lot<font color="#E5E5E5"> of collector improvements the first</font>

179
00:06:49,929 --> 00:06:55,359
one<font color="#CCCCCC"> is a CEO logic sucks less I say</font>

180
00:06:52,779 --> 00:06:57,039
sucks less because the<font color="#CCCCCC"> ACO logic is</font>

181
00:06:55,359 --> 00:06:59,079
always going<font color="#E5E5E5"> to suck because</font><font color="#CCCCCC"> ACLs are</font>

182
00:06:57,039 --> 00:07:01,469
really really really hard<font color="#E5E5E5"> to work with</font>

183
00:06:59,079 --> 00:07:03,939
anybody<font color="#CCCCCC"> who has had the wonderful</font>

184
00:07:01,469 --> 00:07:06,459
<font color="#CCCCCC">privilege of working with</font><font color="#E5E5E5"> Windows ACLs</font>

185
00:07:03,939 --> 00:07:08,679
knows that they make no freakin<font color="#CCCCCC"> sense</font>

186
00:07:06,459 --> 00:07:10,569
whatsoever<font color="#CCCCCC"> and they have all sorts of</font>

187
00:07:08,679 --> 00:07:13,388
rules which they just arbitrarily don't

188
00:07:10,569 --> 00:07:16,779
follow<font color="#E5E5E5"> so we tried to make it work</font>

189
00:07:13,389 --> 00:07:19,539
<font color="#CCCCCC">I took the suggestion of Vincent</font><font color="#E5E5E5"> let's</font>

190
00:07:16,779 --> 00:07:22,360
<font color="#E5E5E5">do over here and redid basically all of</font>

191
00:07:19,539 --> 00:07:25,509
<font color="#E5E5E5">it from scratch and now it mostly works</font>

192
00:07:22,360 --> 00:07:27,039
<font color="#E5E5E5">well we'll go with that we made in the</font>

193
00:07:25,509 --> 00:07:28,809
<font color="#CCCCCC">Marais ssin a lot more reliable</font><font color="#E5E5E5"> we added</font>

194
00:07:27,039 --> 00:07:30,519
a lot more fallback code like cool

195
00:07:28,809 --> 00:07:34,119
<font color="#CCCCCC">things that'll find</font><font color="#E5E5E5"> domain controllers</font>

196
00:07:30,519 --> 00:07:36,099
for you<font color="#CCCCCC"> again</font><font color="#E5E5E5"> lots of bug</font><font color="#CCCCCC"> fixes many</font>

197
00:07:34,119 --> 00:07:37,899
from the<font color="#E5E5E5"> community</font><font color="#CCCCCC"> we</font><font color="#E5E5E5"> added some new</font>

198
00:07:36,099 --> 00:07:39,729
cool properties like account<font color="#CCCCCC"> of</font>

199
00:07:37,899 --> 00:07:41,679
sensitive and can't be delegated<font color="#CCCCCC"> that</font>

200
00:07:39,729 --> 00:07:43,119
<font color="#CCCCCC">way you can actually</font><font color="#E5E5E5"> cross references</font><font color="#CCCCCC"> in</font>

201
00:07:41,679 --> 00:07:46,239
<font color="#CCCCCC">the graph without</font><font color="#E5E5E5"> having to go back</font><font color="#CCCCCC"> into</font>

202
00:07:43,119 --> 00:07:48,309
<font color="#CCCCCC">AD we had a no rep preauth so you can do</font>

203
00:07:46,239 --> 00:07:51,128
<font color="#CCCCCC">a s rep roasting</font><font color="#E5E5E5"> which is kind of a</font>

204
00:07:48,309 --> 00:07:53,589
different<font color="#E5E5E5"> form of</font><font color="#CCCCCC"> kerb roasting</font><font color="#E5E5E5"> the last</font>

205
00:07:51,129 --> 00:07:55,929
one we have is<font color="#CCCCCC"> a bad EER vision I say</font>

206
00:07:53,589 --> 00:07:58,539
bad<font color="#E5E5E5"> EDR evasion for two reasons one our</font>

207
00:07:55,929 --> 00:08:00,429
evasion is bad<font color="#E5E5E5"> second of all what the</font>

208
00:07:58,539 --> 00:08:02,199
EDRs were doing was bad

209
00:08:00,429 --> 00:08:03,849
<font color="#E5E5E5">apparently</font><font color="#CCCCCC"> dealers were looking at</font><font color="#E5E5E5"> shark</font>

210
00:08:02,199 --> 00:08:06,129
<font color="#CCCCCC">pound bin and saying hey it's sharp</font>

211
00:08:03,849 --> 00:08:08,169
pound<font color="#E5E5E5"> so we just changed</font><font color="#CCCCCC"> the name</font><font color="#E5E5E5"> and</font>

212
00:08:06,129 --> 00:08:12,159
now we probably won't<font color="#E5E5E5"> get signature for</font>

213
00:08:08,169 --> 00:08:13,808
another like month so yeah that's that's

214
00:08:12,159 --> 00:08:16,389
another little<font color="#CCCCCC"> thing</font><font color="#E5E5E5"> we added in there</font>

215
00:08:13,809 --> 00:08:18,939
<font color="#CCCCCC">at the insistence of some community</font>

216
00:08:16,389 --> 00:08:20,860
members<font color="#E5E5E5"> so it's it's always fun</font><font color="#CCCCCC"> to play</font>

217
00:08:18,939 --> 00:08:23,049
<font color="#E5E5E5">the</font><font color="#CCCCCC"> cat-and-mouse game I think that's</font>

218
00:08:20,860 --> 00:08:24,729
been going on<font color="#E5E5E5"> for two years now and yeah</font>

219
00:08:23,049 --> 00:08:26,888
I don't<font color="#E5E5E5"> see it stopping anytime</font><font color="#CCCCCC"> soon</font>

220
00:08:24,729 --> 00:08:28,839
so we'll just keep<font color="#E5E5E5"> playing playing the</font>

221
00:08:26,889 --> 00:08:31,839
game until someone<font color="#E5E5E5"> gets tired it'll</font>

222
00:08:28,839 --> 00:08:34,088
<font color="#CCCCCC">probably</font><font color="#E5E5E5"> be us</font><font color="#CCCCCC"> either win or die yeah</font>

223
00:08:31,839 --> 00:08:36,610
winner<font color="#CCCCCC"> died right yeah</font><font color="#E5E5E5"> all</font><font color="#CCCCCC"> right</font><font color="#E5E5E5"> so</font>

224
00:08:34,089 --> 00:08:37,809
that's<font color="#CCCCCC"> all</font><font color="#E5E5E5"> our 2.1 features if you</font>

225
00:08:36,610 --> 00:08:40,000
haven't if you've gotten to<font color="#CCCCCC"> use it</font>

226
00:08:37,808 --> 00:08:42,188
<font color="#E5E5E5">that's cool if you get to exploit the</font>

227
00:08:40,000 --> 00:08:43,419
new new attack primitive like you got to

228
00:08:42,188 --> 00:08:46,329
come tell<font color="#CCCCCC"> us because</font><font color="#E5E5E5"> we're gonna geek</font>

229
00:08:43,419 --> 00:08:48,459
out so hard<font color="#CCCCCC"> about it we've been like</font>

230
00:08:46,329 --> 00:08:50,339
we've been like<font color="#E5E5E5"> really on edge about all</font>

231
00:08:48,459 --> 00:08:52,969
the new stuff<font color="#E5E5E5"> that was added so yeah</font>

232
00:08:50,339 --> 00:08:55,370
<font color="#CCCCCC">alright okay can</font><font color="#E5E5E5"> you</font>

233
00:08:52,970 --> 00:08:56,410
hear me<font color="#E5E5E5"> okay</font><font color="#CCCCCC"> all</font><font color="#E5E5E5"> right sweet</font><font color="#CCCCCC"> so first</font>

234
00:08:55,370 --> 00:08:59,329
thing I want<font color="#CCCCCC"> to talk</font><font color="#E5E5E5"> to you guys about</font>

235
00:08:56,410 --> 00:09:02,389
<font color="#E5E5E5">with bloodhound from the defensive</font>

236
00:08:59,329 --> 00:09:03,829
perspective<font color="#E5E5E5"> is a better way and an</font>

237
00:09:02,389 --> 00:09:08,149
easier way a more efficient way<font color="#CCCCCC"> to do</font>

238
00:09:03,829 --> 00:09:09,670
basic<font color="#E5E5E5"> Active Directory auditing so some</font>

239
00:09:08,149 --> 00:09:12,829
things<font color="#CCCCCC"> that bloodhound really simplifies</font>

240
00:09:09,670 --> 00:09:15,019
<font color="#E5E5E5">auditing local admin rights</font><font color="#CCCCCC"> privileged</font>

241
00:09:12,829 --> 00:09:18,529
user behavior<font color="#CCCCCC"> ad object permissions</font>

242
00:09:15,019 --> 00:09:21,319
group policy control and finding<font color="#E5E5E5"> very</font>

243
00:09:18,529 --> 00:09:23,810
nasty<font color="#E5E5E5"> Kerberos configurations or</font><font color="#CCCCCC"> miss</font>

244
00:09:21,319 --> 00:09:27,050
<font color="#CCCCCC">configurations</font><font color="#E5E5E5"> if you will in your</font>

245
00:09:23,810 --> 00:09:30,949
Active Directory so first let's<font color="#E5E5E5"> look at</font>

246
00:09:27,050 --> 00:09:32,899
<font color="#CCCCCC">AD</font><font color="#E5E5E5"> object permissions auditing so what</font>

247
00:09:30,949 --> 00:09:35,359
do I mean<font color="#CCCCCC"> by that</font><font color="#E5E5E5"> what I mean is</font><font color="#CCCCCC"> you</font>

248
00:09:32,899 --> 00:09:39,319
<font color="#CCCCCC">have an object an ad let's say that it</font>

249
00:09:35,360 --> 00:09:43,279
is the domain admins group so you pull

250
00:09:39,319 --> 00:09:44,569
up a duck<font color="#E5E5E5"> you pull</font><font color="#CCCCCC"> up the well first of</font>

251
00:09:43,279 --> 00:09:47,689
all you have<font color="#CCCCCC"> to</font><font color="#E5E5E5"> have an advanced feature</font>

252
00:09:44,569 --> 00:09:49,759
set then pull up<font color="#E5E5E5"> the object then go to</font>

253
00:09:47,689 --> 00:09:53,329
the Security tab<font color="#CCCCCC"> then go to advanced and</font>

254
00:09:49,759 --> 00:09:55,069
<font color="#E5E5E5">then you get this view right here</font><font color="#CCCCCC"> there</font>

255
00:09:53,329 --> 00:10:00,229
is<font color="#CCCCCC"> an ace on here at the</font><font color="#E5E5E5"> very bottom</font>

256
00:09:55,069 --> 00:10:03,110
where it says<font color="#E5E5E5"> David accounting full</font>

257
00:10:00,230 --> 00:10:04,399
control<font color="#CCCCCC"> and that's</font><font color="#E5E5E5"> pretty obvious it's</font>

258
00:10:03,110 --> 00:10:05,930
like<font color="#CCCCCC"> alright that that user has full</font>

259
00:10:04,399 --> 00:10:08,059
control<font color="#CCCCCC"> to domain admins group</font><font color="#E5E5E5"> that</font>

260
00:10:05,930 --> 00:10:11,319
means that David can add arbitrary users

261
00:10:08,059 --> 00:10:15,199
to the to the domain admins group

262
00:10:11,319 --> 00:10:16,729
however what<font color="#CCCCCC"> you usually see is where it</font>

263
00:10:15,199 --> 00:10:18,290
says<font color="#E5E5E5"> like cert publishers</font><font color="#CCCCCC"> when it's</font>

264
00:10:16,730 --> 00:10:20,750
authorization access terminal servers

265
00:10:18,290 --> 00:10:24,160
the<font color="#E5E5E5"> access just blank or it'll say</font><font color="#CCCCCC"> like</font>

266
00:10:20,750 --> 00:10:27,019
<font color="#E5E5E5">special so then you get to click the</font>

267
00:10:24,160 --> 00:10:30,889
<font color="#E5E5E5">View button</font><font color="#CCCCCC"> and then you get a scroll</font>

268
00:10:27,019 --> 00:10:33,620
through<font color="#E5E5E5"> this nice view and to try</font><font color="#CCCCCC"> to</font>

269
00:10:30,889 --> 00:10:37,420
<font color="#E5E5E5">find what is</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> ACE that is actually</font>

270
00:10:33,620 --> 00:10:43,009
applied to<font color="#E5E5E5"> this object</font><font color="#CCCCCC"> this sucks</font>

271
00:10:37,420 --> 00:10:45,290
so this is why things like<font color="#CCCCCC"> Shaun's Apple</font>

272
00:10:43,009 --> 00:10:46,819
scanning<font color="#E5E5E5"> script it's why Power View has</font>

273
00:10:45,290 --> 00:10:48,949
get object a<font color="#CCCCCC"> close</font><font color="#E5E5E5"> so that you can get a</font>

274
00:10:46,819 --> 00:10:54,769
list based output of what the

275
00:10:48,949 --> 00:10:56,899
permissions are but in<font color="#E5E5E5"> bloodhound</font><font color="#CCCCCC"> way</font><font color="#E5E5E5"> to</font>

276
00:10:54,769 --> 00:10:59,600
<font color="#E5E5E5">do this a bloodhound</font><font color="#CCCCCC"> is we already</font>

277
00:10:56,899 --> 00:11:01,699
filter out all of the<font color="#E5E5E5"> permissions that</font>

278
00:10:59,600 --> 00:11:03,920
<font color="#E5E5E5">don't have a currently known abuse</font>

279
00:11:01,699 --> 00:11:06,140
primitive<font color="#E5E5E5"> and so we're only showing you</font>

280
00:11:03,920 --> 00:11:09,050
the<font color="#E5E5E5"> aces that actually</font>

281
00:11:06,140 --> 00:11:11,120
so to say from every no matter<font color="#E5E5E5"> that we</font>

282
00:11:09,050 --> 00:11:13,069
know about<font color="#E5E5E5"> from an object takeover</font>

283
00:11:11,120 --> 00:11:16,010
perspective so for example in a

284
00:11:13,070 --> 00:11:17,899
bloodhound<font color="#CCCCCC"> database we have our domain</font>

285
00:11:16,010 --> 00:11:19,700
admins group<font color="#CCCCCC"> there on the right and then</font>

286
00:11:17,899 --> 00:11:23,839
<font color="#E5E5E5">we have the domain user objects over</font>

287
00:11:19,700 --> 00:11:26,690
there on<font color="#E5E5E5"> the left</font><font color="#CCCCCC"> if we</font><font color="#E5E5E5"> click on one of</font>

288
00:11:23,839 --> 00:11:29,899
those<font color="#E5E5E5"> users</font><font color="#CCCCCC"> we can start</font><font color="#E5E5E5"> looking at how</font>

289
00:11:26,690 --> 00:11:32,630
to audit<font color="#E5E5E5"> this using bloodhound</font><font color="#CCCCCC"> on a per</font>

290
00:11:29,899 --> 00:11:34,269
user basis so if we look at the inbound

291
00:11:32,630 --> 00:11:36,589
<font color="#E5E5E5">object control we can see that there are</font>

292
00:11:34,269 --> 00:11:39,079
three principles that<font color="#E5E5E5"> have explicit</font>

293
00:11:36,589 --> 00:11:41,240
<font color="#E5E5E5">control of a domain admin there's 47</font>

294
00:11:39,079 --> 00:11:43,250
actual users that<font color="#CCCCCC"> have control through</font>

295
00:11:41,240 --> 00:11:45,860
security<font color="#E5E5E5"> group delegation and then the</font>

296
00:11:43,250 --> 00:11:47,810
transitive object controllers this query

297
00:11:45,860 --> 00:11:49,339
probably took like<font color="#E5E5E5"> 10</font><font color="#CCCCCC"> minutes to run</font><font color="#E5E5E5"> the</font>

298
00:11:47,810 --> 00:11:52,310
number is<font color="#E5E5E5"> something</font><font color="#CCCCCC"> over a hundred</font>

299
00:11:49,339 --> 00:11:54,410
thousand and what that transitive<font color="#E5E5E5"> object</font>

300
00:11:52,310 --> 00:11:57,380
control what that means is that every

301
00:11:54,410 --> 00:11:59,149
<font color="#CCCCCC">object</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the directory has an attack</font>

302
00:11:57,380 --> 00:12:03,620
path that<font color="#E5E5E5"> gets them to this principle</font>

303
00:11:59,149 --> 00:12:05,720
using<font color="#CCCCCC"> only using only LDAP we're only</font>

304
00:12:03,620 --> 00:12:06,740
using like<font color="#E5E5E5"> 80 object</font><font color="#CCCCCC"> takeover</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> you</font>

305
00:12:05,720 --> 00:12:08,750
don't have to laterally move to other

306
00:12:06,740 --> 00:12:10,250
systems<font color="#CCCCCC"> you</font><font color="#E5E5E5"> don't have to password spray</font>

307
00:12:08,750 --> 00:12:12,230
you don't do any of<font color="#CCCCCC"> that</font><font color="#E5E5E5"> garbage you</font><font color="#CCCCCC"> can</font>

308
00:12:10,250 --> 00:12:15,140
just do<font color="#E5E5E5"> this all through LDAP and only</font>

309
00:12:12,230 --> 00:12:16,910
talking<font color="#E5E5E5"> to one domain controller</font><font color="#CCCCCC"> but</font>

310
00:12:15,140 --> 00:12:18,050
even<font color="#E5E5E5"> this process already is kind</font><font color="#CCCCCC"> of</font>

311
00:12:16,910 --> 00:12:19,730
tedious because<font color="#CCCCCC"> we're having clip</font>

312
00:12:18,050 --> 00:12:22,010
<font color="#CCCCCC">through each user</font><font color="#E5E5E5"> don't have to expand</font>

313
00:12:19,730 --> 00:12:24,440
<font color="#E5E5E5">that</font><font color="#CCCCCC"> out and really the only</font><font color="#E5E5E5"> thing I</font>

314
00:12:22,010 --> 00:12:27,019
care<font color="#CCCCCC"> about is</font><font color="#E5E5E5"> just tell me what non</font>

315
00:12:24,440 --> 00:12:30,170
domain admins can control any domain

316
00:12:27,019 --> 00:12:31,250
admin and how I<font color="#E5E5E5"> don't have time to go</font>

317
00:12:30,170 --> 00:12:33,050
<font color="#CCCCCC">through this GUI I don't have</font><font color="#E5E5E5"> time to</font>

318
00:12:31,250 --> 00:12:35,750
run<font color="#E5E5E5"> a script</font><font color="#CCCCCC"> I don't care I</font><font color="#E5E5E5"> just this is</font>

319
00:12:33,050 --> 00:12:38,420
<font color="#CCCCCC">what I care about is</font><font color="#E5E5E5"> what matters who</font>

320
00:12:35,750 --> 00:12:41,990
can take<font color="#E5E5E5"> over a da that's not a da tell</font>

321
00:12:38,420 --> 00:12:44,380
me who it<font color="#CCCCCC"> is</font><font color="#E5E5E5"> and how they can</font><font color="#CCCCCC"> do</font><font color="#E5E5E5"> it so I</font>

322
00:12:41,990 --> 00:12:46,399
don't<font color="#CCCCCC"> expect you to</font><font color="#E5E5E5"> be able to read this</font>

323
00:12:44,380 --> 00:12:48,050
<font color="#CCCCCC">the slides are</font><font color="#E5E5E5"> gonna be available</font>

324
00:12:46,399 --> 00:12:50,180
<font color="#E5E5E5">afterwards so you can copy and</font><font color="#CCCCCC"> paste</font>

325
00:12:48,050 --> 00:12:51,979
this if<font color="#E5E5E5"> you want but after you've done</font>

326
00:12:50,180 --> 00:12:54,920
<font color="#E5E5E5">your bloodhound data collection and you</font>

327
00:12:51,980 --> 00:12:57,490
have<font color="#CCCCCC"> a very</font><font color="#E5E5E5"> well populated database you</font>

328
00:12:54,920 --> 00:13:00,380
can run this cipher query right here<font color="#E5E5E5"> and</font>

329
00:12:57,490 --> 00:13:02,029
what this<font color="#E5E5E5"> is doing is</font><font color="#CCCCCC"> it's grabbing any</font>

330
00:13:00,380 --> 00:13:04,519
user<font color="#E5E5E5"> that belong</font><font color="#CCCCCC"> to the domain admins</font>

331
00:13:02,029 --> 00:13:06,800
group<font color="#E5E5E5"> and uh saving that to a variable</font>

332
00:13:04,519 --> 00:13:09,199
<font color="#E5E5E5">and</font><font color="#CCCCCC"> then we're saying alright now show</font>

333
00:13:06,800 --> 00:13:11,240
me<font color="#E5E5E5"> any any object</font><font color="#CCCCCC"> that has explicit</font>

334
00:13:09,199 --> 00:13:14,000
control<font color="#E5E5E5"> or group delegated control of</font>

335
00:13:11,240 --> 00:13:16,339
any of those domain admins<font color="#CCCCCC"> that are not</font>

336
00:13:14,000 --> 00:13:16,760
a<font color="#CCCCCC"> domain admin and show me what that</font>

337
00:13:16,339 --> 00:13:20,120
looks like

338
00:13:16,760 --> 00:13:23,360
<font color="#CCCCCC">in the graph and</font><font color="#E5E5E5"> it looks</font><font color="#CCCCCC"> like this</font>

339
00:13:20,120 --> 00:13:26,690
<font color="#CCCCCC">super-easy this query finishes in like</font>

340
00:13:23,360 --> 00:13:28,220
<font color="#E5E5E5">three seconds maybe and so again on the</font>

341
00:13:26,690 --> 00:13:29,900
<font color="#E5E5E5">very far right we</font><font color="#CCCCCC"> have the domain</font><font color="#E5E5E5"> admins</font>

342
00:13:28,220 --> 00:13:32,930
users<font color="#E5E5E5"> oh this is by the way</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is real</font>

343
00:13:29,900 --> 00:13:36,319
data<font color="#E5E5E5"> we have the domain admins</font><font color="#CCCCCC"> group on</font>

344
00:13:32,930 --> 00:13:39,380
the far right<font color="#E5E5E5"> the users and then this is</font>

345
00:13:36,320 --> 00:13:40,670
<font color="#E5E5E5">probably the administrators</font><font color="#CCCCCC"> group this</font>

346
00:13:39,380 --> 00:13:42,770
<font color="#CCCCCC">is probably the dope this is probably</font>

347
00:13:40,670 --> 00:13:44,750
the account operators<font color="#E5E5E5"> group and then we</font>

348
00:13:42,770 --> 00:13:47,689
<font color="#CCCCCC">have these like random</font><font color="#E5E5E5"> other groups</font><font color="#CCCCCC"> that</font>

349
00:13:44,750 --> 00:13:50,330
<font color="#CCCCCC">either were added to the administrators</font>

350
00:13:47,690 --> 00:13:52,610
<font color="#CCCCCC">group</font><font color="#E5E5E5"> or they have some kind</font><font color="#CCCCCC"> of direct</font>

351
00:13:50,330 --> 00:13:55,280
control<font color="#E5E5E5"> of a domain admin so if you're</font>

352
00:13:52,610 --> 00:13:56,810
looking<font color="#E5E5E5"> at if you if you watch if you if</font>

353
00:13:55,280 --> 00:13:59,300
you watched a<font color="#CCCCCC"> Shawn's talk about like</font>

354
00:13:56,810 --> 00:14:00,739
<font color="#E5E5E5">isolating domain admins this is one way</font>

355
00:13:59,300 --> 00:14:05,170
that<font color="#E5E5E5"> you can do super super easily</font>

356
00:14:00,740 --> 00:14:07,700
<font color="#CCCCCC">looking at the the</font><font color="#E5E5E5"> object tape over</font>

357
00:14:05,170 --> 00:14:09,920
<font color="#E5E5E5">primitives are possible</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> using</font>

358
00:14:07,700 --> 00:14:12,170
bloodhounds<font color="#E5E5E5"> this is like two years worth</font>

359
00:14:09,920 --> 00:14:13,760
of knowledge<font color="#E5E5E5"> and learning that and I've</font>

360
00:14:12,170 --> 00:14:17,000
done that<font color="#E5E5E5"> he just dumped on you and like</font>

361
00:14:13,760 --> 00:14:18,590
<font color="#E5E5E5">30 seconds so if you don't entirely get</font>

362
00:14:17,000 --> 00:14:20,540
it like it's not it's<font color="#E5E5E5"> not your fault</font>

363
00:14:18,590 --> 00:14:22,130
<font color="#CCCCCC">yeah this</font><font color="#E5E5E5"> well</font><font color="#CCCCCC"> so we'll put a blog post</font>

364
00:14:20,540 --> 00:14:23,680
out about this stuff<font color="#E5E5E5"> as well</font><font color="#CCCCCC"> so you can</font>

365
00:14:22,130 --> 00:14:25,670
like read through it at your leisure

366
00:14:23,680 --> 00:14:29,449
<font color="#E5E5E5">okay so the other thing I want to look</font>

367
00:14:25,670 --> 00:14:32,329
<font color="#E5E5E5">at is group policy control auditing</font>

368
00:14:29,450 --> 00:14:36,680
<font color="#CCCCCC">alright who has ever tried to get a</font>

369
00:14:32,330 --> 00:14:39,350
handle on what GPO is<font color="#E5E5E5"> apply to your</font>

370
00:14:36,680 --> 00:14:42,560
domain admins<font color="#CCCCCC"> and who has control of</font>

371
00:14:39,350 --> 00:14:46,160
those GPOs<font color="#E5E5E5"> that is not a domain admin</font>

372
00:14:42,560 --> 00:14:48,050
<font color="#CCCCCC">okay you don't</font><font color="#E5E5E5"> count you don't count</font>

373
00:14:46,160 --> 00:14:53,420
either<font color="#E5E5E5"> all right</font>

374
00:14:48,050 --> 00:14:55,339
why<font color="#E5E5E5"> not it's impossible it's really</font>

375
00:14:53,420 --> 00:14:57,170
really difficult<font color="#E5E5E5"> so here's the process</font>

376
00:14:55,340 --> 00:14:59,060
looks like gonna hide a<font color="#E5E5E5"> high level first</font>

377
00:14:57,170 --> 00:15:01,219
<font color="#E5E5E5">we're gonna find each domain admin user</font>

378
00:14:59,060 --> 00:15:02,900
and<font color="#E5E5E5"> every computer they use then we're</font>

379
00:15:01,220 --> 00:15:04,610
we're<font color="#E5E5E5"> gonna find those objects in the oh</font>

380
00:15:02,900 --> 00:15:06,590
you tree<font color="#E5E5E5"> because again we're looking at</font>

381
00:15:04,610 --> 00:15:09,440
GPO and<font color="#CCCCCC"> that's gonna be linked to OU's</font>

382
00:15:06,590 --> 00:15:11,030
and sites and domains<font color="#CCCCCC"> then we're</font><font color="#E5E5E5"> going</font>

383
00:15:09,440 --> 00:15:13,310
<font color="#CCCCCC">to enumerate</font><font color="#E5E5E5"> the</font><font color="#CCCCCC"> group policy links to</font>

384
00:15:11,030 --> 00:15:16,100
those OU's sites and domains<font color="#E5E5E5"> work out</font>

385
00:15:13,310 --> 00:15:18,170
whether each GPO actually applies to

386
00:15:16,100 --> 00:15:21,020
each of those users<font color="#CCCCCC"> and</font><font color="#E5E5E5"> computers which</font>

387
00:15:18,170 --> 00:15:22,550
is always<font color="#E5E5E5"> really</font><font color="#CCCCCC"> fun and then finally</font>

388
00:15:21,020 --> 00:15:23,420
we're<font color="#E5E5E5"> going to audit the permissions on</font>

389
00:15:22,550 --> 00:15:29,089
each of those GPOs

390
00:15:23,420 --> 00:15:32,209
<font color="#E5E5E5">so every step is</font><font color="#CCCCCC"> pane</font><font color="#E5E5E5"> in in this in this</font>

391
00:15:29,090 --> 00:15:34,040
<font color="#CCCCCC">process so</font><font color="#E5E5E5"> let's do it</font><font color="#CCCCCC"> alright here's my</font>

392
00:15:32,210 --> 00:15:38,839
administrator user so<font color="#E5E5E5"> I find him</font>

393
00:15:34,040 --> 00:15:40,670
a duck<font color="#CCCCCC"> him or her in a duck and then I</font>

394
00:15:38,839 --> 00:15:42,139
want<font color="#CCCCCC"> to see what</font><font color="#E5E5E5"> oh you that user</font>

395
00:15:40,670 --> 00:15:45,949
<font color="#CCCCCC">belongs to you so this</font><font color="#E5E5E5"> user just belongs</font>

396
00:15:42,139 --> 00:15:47,480
to the the users<font color="#E5E5E5"> oh you so okay</font><font color="#CCCCCC"> now I</font>

397
00:15:45,949 --> 00:15:49,370
<font color="#CCCCCC">have a different UI and a look at so I'm</font>

398
00:15:47,480 --> 00:15:51,319
gonna<font color="#E5E5E5"> look at group policy management</font><font color="#CCCCCC"> uh</font>

399
00:15:49,370 --> 00:15:53,360
here's a default domain policy<font color="#CCCCCC"> so that's</font>

400
00:15:51,319 --> 00:15:58,130
gonna apply<font color="#E5E5E5"> to that administrator user</font>

401
00:15:53,360 --> 00:15:59,300
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> well is that link actually enabled</font>

402
00:15:58,130 --> 00:16:02,060
<font color="#E5E5E5">yes</font>

403
00:15:59,300 --> 00:16:03,229
is it enforced<font color="#E5E5E5"> this matters</font><font color="#CCCCCC"> in this</font>

404
00:16:02,060 --> 00:16:06,319
instance it's not<font color="#E5E5E5"> so I'm</font><font color="#CCCCCC"> gonna</font><font color="#E5E5E5"> keep</font>

405
00:16:03,230 --> 00:16:08,180
<font color="#E5E5E5">track</font><font color="#CCCCCC"> of that also I need to look at</font>

406
00:16:06,319 --> 00:16:12,339
whether the oh you containing that user

407
00:16:08,180 --> 00:16:15,079
blocks inheritance<font color="#E5E5E5"> are we</font><font color="#CCCCCC"> having</font><font color="#E5E5E5"> fun yet</font>

408
00:16:12,339 --> 00:16:17,269
<font color="#CCCCCC">well wait we're not</font><font color="#E5E5E5"> done</font><font color="#CCCCCC"> we also need to</font>

409
00:16:15,079 --> 00:16:19,279
look at<font color="#E5E5E5"> Whitney filters so is there a</font>

410
00:16:17,269 --> 00:16:21,110
women filter that<font color="#E5E5E5"> is excluding this user</font>

411
00:16:19,279 --> 00:16:22,610
from<font color="#E5E5E5"> having this</font><font color="#CCCCCC"> GPO applied to them in</font>

412
00:16:21,110 --> 00:16:25,970
this instance<font color="#CCCCCC"> no I don't have</font><font color="#E5E5E5"> any women</font>

413
00:16:22,610 --> 00:16:28,579
filters in my<font color="#E5E5E5"> in my fake domain but in</font>

414
00:16:25,970 --> 00:16:33,500
<font color="#CCCCCC">real life you will probably see a very</font>

415
00:16:28,579 --> 00:16:35,540
long fairly long<font color="#CCCCCC"> list here</font><font color="#E5E5E5"> okay so in</font>

416
00:16:33,500 --> 00:16:37,639
this view this group<font color="#CCCCCC"> policy management</font>

417
00:16:35,540 --> 00:16:39,170
view<font color="#CCCCCC"> you cannot see the</font><font color="#E5E5E5"> permissions of</font>

418
00:16:37,639 --> 00:16:40,760
the<font color="#E5E5E5"> GPO there is no</font><font color="#CCCCCC"> right-click</font>

419
00:16:39,170 --> 00:16:42,860
properties in this view to<font color="#E5E5E5"> look at the</font>

420
00:16:40,760 --> 00:16:45,709
GPO<font color="#E5E5E5"> so now you get to go back</font><font color="#CCCCCC"> into a</font>

421
00:16:42,860 --> 00:16:48,800
<font color="#CCCCCC">duct and</font><font color="#E5E5E5"> you could have find not default</font>

422
00:16:45,709 --> 00:16:52,099
domain policy but<font color="#E5E5E5"> you could define 3 1 B</font>

423
00:16:48,800 --> 00:16:54,829
<font color="#E5E5E5">2 F 3 4</font><font color="#CCCCCC"> 0 - 0 1 you know yadda yadda</font>

424
00:16:52,100 --> 00:16:57,920
<font color="#CCCCCC">yadda you</font><font color="#E5E5E5"> gonna find the the</font>

425
00:16:54,829 --> 00:17:00,550
<font color="#CCCCCC">quote-unquote gooood which is actually</font>

426
00:16:57,920 --> 00:17:04,069
not globally unique<font color="#CCCCCC"> nope for that</font>

427
00:17:00,550 --> 00:17:05,589
relevant policy now you can find a look

428
00:17:04,069 --> 00:17:08,059
at the<font color="#CCCCCC"> permissions on that object and</font>

429
00:17:05,589 --> 00:17:09,619
then you're back<font color="#E5E5E5"> here you're looking</font><font color="#CCCCCC"> at</font>

430
00:17:08,059 --> 00:17:12,760
<font color="#E5E5E5">the</font><font color="#CCCCCC"> aces</font><font color="#E5E5E5"> in here like which ones</font>

431
00:17:09,619 --> 00:17:16,069
<font color="#E5E5E5">actually matter which ones are inherited</font>

432
00:17:12,760 --> 00:17:18,230
<font color="#CCCCCC">do these</font><font color="#E5E5E5"> actually apply there are there</font>

433
00:17:16,069 --> 00:17:23,899
<font color="#E5E5E5">any deny aces that might screw things up</font>

434
00:17:18,230 --> 00:17:26,510
like this<font color="#E5E5E5"> is not good</font><font color="#CCCCCC"> this</font><font color="#E5E5E5"> is pretty bad</font>

435
00:17:23,900 --> 00:17:28,429
so yes<font color="#E5E5E5"> of course this</font><font color="#CCCCCC"> process can</font><font color="#E5E5E5"> be</font>

436
00:17:26,510 --> 00:17:29,840
scripted<font color="#E5E5E5"> there are several people in</font>

437
00:17:28,429 --> 00:17:33,500
this room who<font color="#CCCCCC"> have scripted out</font><font color="#E5E5E5"> this</font>

438
00:17:29,840 --> 00:17:36,139
<font color="#E5E5E5">process but this is a bloodhound talk so</font>

439
00:17:33,500 --> 00:17:38,929
we're gonna<font color="#E5E5E5"> do this with bloodhound so</font>

440
00:17:36,140 --> 00:17:42,049
what do I<font color="#CCCCCC"> want</font><font color="#E5E5E5"> I</font><font color="#CCCCCC"> just</font><font color="#E5E5E5"> want to know which</font>

441
00:17:38,929 --> 00:17:44,240
<font color="#E5E5E5">non DA's can control any GPO that</font>

442
00:17:42,049 --> 00:17:47,299
applies<font color="#CCCCCC"> to any da and how that's really</font>

443
00:17:44,240 --> 00:17:47,660
<font color="#E5E5E5">all that I care</font><font color="#CCCCCC"> about alright</font><font color="#E5E5E5"> so we'll</font>

444
00:17:47,299 --> 00:17:49,940
jump back

445
00:17:47,660 --> 00:17:52,910
<font color="#E5E5E5">decipher this first thing all this is</font>

446
00:17:49,940 --> 00:17:55,550
<font color="#CCCCCC">gonna do is find the GPIOs</font><font color="#E5E5E5"> that apply to</font>

447
00:17:52,910 --> 00:17:58,070
the domain admins<font color="#E5E5E5"> and then we can we can</font>

448
00:17:55,550 --> 00:17:58,970
render that<font color="#E5E5E5"> so all of these GPOs again</font>

449
00:17:58,070 --> 00:18:01,340
this is real data

450
00:17:58,970 --> 00:18:03,380
the<font color="#CCCCCC"> gpo's are linked to the domain</font>

451
00:18:01,340 --> 00:18:05,449
object<font color="#E5E5E5"> chase that down the oh you tree</font>

452
00:18:03,380 --> 00:18:08,660
<font color="#E5E5E5">to the members of the</font><font color="#CCCCCC"> domain admins</font>

453
00:18:05,450 --> 00:18:10,040
group and you know luckily<font color="#E5E5E5"> these domain</font>

454
00:18:08,660 --> 00:18:13,070
admins<font color="#CCCCCC"> there with their</font><font color="#E5E5E5"> contained within</font>

455
00:18:10,040 --> 00:18:14,540
the same<font color="#CCCCCC"> oh you more often</font><font color="#E5E5E5"> than not in</font>

456
00:18:13,070 --> 00:18:16,970
our experience domain admins are like

457
00:18:14,540 --> 00:18:19,399
scattered<font color="#E5E5E5"> all across the the oh you</font>

458
00:18:16,970 --> 00:18:22,580
structure but<font color="#E5E5E5"> this query will find them</font>

459
00:18:19,400 --> 00:18:23,930
<font color="#E5E5E5">regardless it doesn't matter</font><font color="#CCCCCC"> okay</font>

460
00:18:22,580 --> 00:18:25,159
<font color="#E5E5E5">those queries are gonna be in the slide</font>

461
00:18:23,930 --> 00:18:26,360
deck that<font color="#E5E5E5"> we share afterwards so you</font>

462
00:18:25,160 --> 00:18:28,070
<font color="#E5E5E5">know don't worry about taking pictures</font>

463
00:18:26,360 --> 00:18:30,110
<font color="#CCCCCC">or anything like yet</font><font color="#E5E5E5"> you'll you'll just</font>

464
00:18:28,070 --> 00:18:32,929
<font color="#CCCCCC">bill a copy amount yeah</font>

465
00:18:30,110 --> 00:18:35,750
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> so then things get a little more</font>

466
00:18:32,930 --> 00:18:37,400
complicated<font color="#E5E5E5"> hence why I said don't</font>

467
00:18:35,750 --> 00:18:39,950
<font color="#E5E5E5">bother taking</font><font color="#CCCCCC"> picture slightly more</font>

468
00:18:37,400 --> 00:18:42,290
<font color="#CCCCCC">complicated but basically</font><font color="#E5E5E5"> what this</font>

469
00:18:39,950 --> 00:18:43,790
query is doing is saying<font color="#CCCCCC"> alright I now</font>

470
00:18:42,290 --> 00:18:47,180
know what<font color="#E5E5E5"> GPO is apply to my domain</font>

471
00:18:43,790 --> 00:18:49,490
admins now tell me<font color="#E5E5E5"> through either</font>

472
00:18:47,180 --> 00:18:51,170
explicit permissions or group delegated

473
00:18:49,490 --> 00:18:55,010
permissions<font color="#CCCCCC"> who</font><font color="#E5E5E5"> controls each of those</font>

474
00:18:51,170 --> 00:18:57,170
GPOs<font color="#E5E5E5"> and exclude anybody who's a domain</font>

475
00:18:55,010 --> 00:18:59,150
admin<font color="#CCCCCC"> I don't care if a</font><font color="#E5E5E5"> domain admin</font><font color="#CCCCCC"> is</font>

476
00:18:57,170 --> 00:19:03,290
<font color="#CCCCCC">controller they're the people I'm trying</font>

477
00:18:59,150 --> 00:19:06,880
<font color="#E5E5E5">to protect here so the result of that</font>

478
00:19:03,290 --> 00:19:11,389
<font color="#E5E5E5">again this is real data looks like</font><font color="#CCCCCC"> this</font>

479
00:19:06,880 --> 00:19:15,410
so what do we<font color="#E5E5E5"> have we</font><font color="#CCCCCC"> have two different</font>

480
00:19:11,390 --> 00:19:17,510
<font color="#E5E5E5">groups this group right</font><font color="#CCCCCC"> here</font><font color="#E5E5E5"> and this</font>

481
00:19:15,410 --> 00:19:19,700
<font color="#E5E5E5">group right here that have several</font>

482
00:19:17,510 --> 00:19:23,450
<font color="#E5E5E5">different permissions that give them</font>

483
00:19:19,700 --> 00:19:26,150
control<font color="#CCCCCC"> of the gpo's why is</font><font color="#E5E5E5"> this matter</font>

484
00:19:23,450 --> 00:19:29,210
because<font color="#CCCCCC"> with GPO you can do anything I</font>

485
00:19:26,150 --> 00:19:32,810
can make you run<font color="#E5E5E5"> a startup</font><font color="#CCCCCC"> script</font><font color="#E5E5E5"> I can</font>

486
00:19:29,210 --> 00:19:35,900
give your<font color="#CCCCCC"> computer se debug privileges</font>

487
00:19:32,810 --> 00:19:38,870
for<font color="#E5E5E5"> all domain users if you can dream it</font>

488
00:19:35,900 --> 00:19:42,140
you can do<font color="#E5E5E5"> it with GPO it's a wonderful</font>

489
00:19:38,870 --> 00:19:44,120
and complicated<font color="#CCCCCC"> beast</font><font color="#E5E5E5"> then these are all</font>

490
00:19:42,140 --> 00:19:46,190
<font color="#E5E5E5">the users</font><font color="#CCCCCC"> that belong to those groups</font>

491
00:19:44,120 --> 00:19:48,560
<font color="#E5E5E5">and you can see that</font><font color="#CCCCCC"> we're unrolling</font>

492
00:19:46,190 --> 00:19:50,560
<font color="#CCCCCC">that out that's</font><font color="#E5E5E5"> just a native thing</font><font color="#CCCCCC"> in a</font>

493
00:19:48,560 --> 00:19:52,790
graph it's very very<font color="#E5E5E5"> simple</font><font color="#CCCCCC"> for it to do</font>

494
00:19:50,560 --> 00:19:54,470
and so if I'm looking at protecting<font color="#CCCCCC"> my</font>

495
00:19:52,790 --> 00:19:57,740
domain admins<font color="#CCCCCC"> I need to</font><font color="#E5E5E5"> protect them</font>

496
00:19:54,470 --> 00:19:59,690
from<font color="#E5E5E5"> GPO attacks now I know I don't have</font>

497
00:19:57,740 --> 00:20:00,860
to like chase out all the<font color="#E5E5E5"> other attack</font>

498
00:19:59,690 --> 00:20:02,270
paths that that

499
00:20:00,860 --> 00:20:04,909
end up<font color="#CCCCCC"> in the compromise</font><font color="#E5E5E5"> I'm one of</font>

500
00:20:02,270 --> 00:20:05,480
those users on the<font color="#CCCCCC"> left which in this</font>

501
00:20:04,910 --> 00:20:07,220
domain

502
00:20:05,480 --> 00:20:08,630
all those users<font color="#CCCCCC"> are like spraying our</font>

503
00:20:07,220 --> 00:20:11,060
<font color="#E5E5E5">credentials all over the place</font>

504
00:20:08,630 --> 00:20:13,880
all I'm carrying about<font color="#E5E5E5"> at this step is</font>

505
00:20:11,060 --> 00:20:16,580
get rid of those offending aces on the

506
00:20:13,880 --> 00:20:18,830
GPOs that applied the domain admins<font color="#E5E5E5"> so</font>

507
00:20:16,580 --> 00:20:20,750
that<font color="#CCCCCC"> only domain admins can apply GPO to</font>

508
00:20:18,830 --> 00:20:23,110
<font color="#E5E5E5">themselves and then we can periodically</font>

509
00:20:20,750 --> 00:20:27,110
audit<font color="#E5E5E5"> this just it's very very simple</font>

510
00:20:23,110 --> 00:20:29,419
excuse me very<font color="#CCCCCC"> very simple process</font>

511
00:20:27,110 --> 00:20:34,310
<font color="#E5E5E5">process yeah thank you is this my water</font>

512
00:20:29,420 --> 00:20:36,080
<font color="#E5E5E5">yes it is now yep okay so this is this</font>

513
00:20:34,310 --> 00:20:38,179
<font color="#CCCCCC">is like this is the tip of</font><font color="#E5E5E5"> the iceberg</font>

514
00:20:36,080 --> 00:20:40,490
of like very<font color="#CCCCCC"> very easy basic auditing</font>

515
00:20:38,180 --> 00:20:42,560
that<font color="#CCCCCC"> you can do with bloodhound so next</font>

516
00:20:40,490 --> 00:20:49,220
one we'll look at is<font color="#CCCCCC"> finding more</font>

517
00:20:42,560 --> 00:20:52,090
systemic<font color="#E5E5E5"> issues so three things that</font>

518
00:20:49,220 --> 00:20:55,640
<font color="#E5E5E5">come to mind lease privilege violations</font>

519
00:20:52,090 --> 00:20:58,669
cross domain attack<font color="#E5E5E5"> paths and attack</font>

520
00:20:55,640 --> 00:21:02,930
paths<font color="#E5E5E5"> to</font><font color="#CCCCCC"> quote unquote da</font><font color="#E5E5E5"> and I say I</font>

521
00:20:58,670 --> 00:21:03,920
say<font color="#E5E5E5"> da in quotes because as</font><font color="#CCCCCC"> Sean points</font>

522
00:21:02,930 --> 00:21:07,060
out<font color="#CCCCCC"> and again a couple</font><font color="#E5E5E5"> of</font><font color="#CCCCCC"> us blogs</font>

523
00:21:03,920 --> 00:21:10,520
domain admin is not the be-all end-all

524
00:21:07,060 --> 00:21:11,570
<font color="#CCCCCC">necessarily exclusively</font><font color="#E5E5E5"> unto itself that</font>

525
00:21:10,520 --> 00:21:12,590
you have account operators you have

526
00:21:11,570 --> 00:21:13,820
<font color="#E5E5E5">Enterprise admins you have two main</font>

527
00:21:12,590 --> 00:21:15,740
controllers you have all<font color="#E5E5E5"> kinds of</font>

528
00:21:13,820 --> 00:21:17,750
different<font color="#CCCCCC"> principals that can give you</font>

529
00:21:15,740 --> 00:21:22,370
the<font color="#E5E5E5"> same equivalent access as a domain</font>

530
00:21:17,750 --> 00:21:25,880
admin<font color="#E5E5E5"> can okay so first one way to look</font>

531
00:21:22,370 --> 00:21:29,239
<font color="#E5E5E5">at least</font><font color="#CCCCCC"> privileged violations and</font><font color="#E5E5E5"> two</font>

532
00:21:25,880 --> 00:21:31,850
different<font color="#CCCCCC"> perspectives</font><font color="#E5E5E5"> one is inbound</font>

533
00:21:29,240 --> 00:21:33,230
permissions so we can find computers<font color="#CCCCCC"> in</font>

534
00:21:31,850 --> 00:21:36,139
the network<font color="#CCCCCC"> that have way too many</font>

535
00:21:33,230 --> 00:21:37,850
admins<font color="#CCCCCC"> this is really easy to</font><font color="#E5E5E5"> do if like</font>

536
00:21:36,140 --> 00:21:39,470
domain users was added to the<font color="#E5E5E5"> local</font>

537
00:21:37,850 --> 00:21:43,100
admins group that's simple<font color="#CCCCCC"> you can just</font>

538
00:21:39,470 --> 00:21:46,040
<font color="#CCCCCC">run necess and find that if you</font><font color="#E5E5E5"> have a</font>

539
00:21:43,100 --> 00:21:46,189
group that<font color="#E5E5E5"> has domain users added into</font>

540
00:21:46,040 --> 00:21:48,050
it

541
00:21:46,190 --> 00:21:49,340
<font color="#CCCCCC">Nessus is not gonna tell you that no</font>

542
00:21:48,050 --> 00:21:50,899
script is gonna tell you<font color="#CCCCCC"> that it's</font><font color="#E5E5E5"> not</font>

543
00:21:49,340 --> 00:21:53,270
<font color="#CCCCCC">gonna unroll that out automatically for</font>

544
00:21:50,900 --> 00:21:55,280
you or forget domain users if<font color="#CCCCCC"> you just</font>

545
00:21:53,270 --> 00:21:57,200
have<font color="#CCCCCC"> like the everyone principle or the</font>

546
00:21:55,280 --> 00:21:59,270
<font color="#E5E5E5">authenticated users principle or some</font>

547
00:21:57,200 --> 00:22:00,740
group that<font color="#E5E5E5"> somebody</font><font color="#CCCCCC"> decided hey every</font>

548
00:21:59,270 --> 00:22:02,210
every<font color="#CCCCCC"> domain user gets</font><font color="#E5E5E5"> to go in this</font>

549
00:22:00,740 --> 00:22:05,060
group and I'm gonna make<font color="#CCCCCC"> that group</font>

550
00:22:02,210 --> 00:22:08,240
<font color="#E5E5E5">local admin everywhere we can find that</font>

551
00:22:05,060 --> 00:22:11,240
really really<font color="#CCCCCC"> easily with bloodhound so</font>

552
00:22:08,240 --> 00:22:14,720
again it's<font color="#E5E5E5"> two three four fits six lines</font>

553
00:22:11,240 --> 00:22:17,510
of<font color="#E5E5E5"> cipher seven lines of cipher and</font>

554
00:22:14,720 --> 00:22:19,970
the result<font color="#E5E5E5"> of this is we have two</font>

555
00:22:17,510 --> 00:22:22,610
columns of<font color="#E5E5E5"> data we have the name</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> the</font>

556
00:22:19,970 --> 00:22:25,910
computer<font color="#CCCCCC"> in AD and we have the number of</font>

557
00:22:22,610 --> 00:22:27,740
<font color="#CCCCCC">unique admins on that</font><font color="#E5E5E5"> computer we can</font>

558
00:22:25,910 --> 00:22:29,690
take that data<font color="#E5E5E5"> we can massage it</font><font color="#CCCCCC"> into</font>

559
00:22:27,740 --> 00:22:32,570
<font color="#E5E5E5">whatever format we want you can export</font>

560
00:22:29,690 --> 00:22:35,420
from<font color="#E5E5E5"> CSV</font><font color="#CCCCCC"> you can put that</font><font color="#E5E5E5"> into Excel you</font>

561
00:22:32,570 --> 00:22:37,700
<font color="#CCCCCC">can build up a chart</font><font color="#E5E5E5"> whatever</font><font color="#CCCCCC"> as part of</font>

562
00:22:35,420 --> 00:22:39,170
this talk we are<font color="#E5E5E5"> releasing a tool that</font>

563
00:22:37,700 --> 00:22:42,080
will help<font color="#E5E5E5"> you</font><font color="#CCCCCC"> build</font><font color="#E5E5E5"> these visualizations</font>

564
00:22:39,170 --> 00:22:44,420
very very easily<font color="#CCCCCC"> and one of</font><font color="#E5E5E5"> those</font>

565
00:22:42,080 --> 00:22:46,899
<font color="#E5E5E5">visualizations looks like this so</font><font color="#CCCCCC"> this e</font>

566
00:22:44,420 --> 00:22:50,060
these<font color="#E5E5E5"> are the computers in the</font><font color="#CCCCCC"> network</font>

567
00:22:46,900 --> 00:22:51,740
<font color="#E5E5E5">sorted by the number of unique admins so</font>

568
00:22:50,060 --> 00:22:54,889
the two top computers<font color="#E5E5E5"> there each have</font>

569
00:22:51,740 --> 00:22:57,530
approximately<font color="#E5E5E5"> 10,000 users that are</font>

570
00:22:54,890 --> 00:22:59,420
local admin on there then the there's a

571
00:22:57,530 --> 00:23:02,330
significant<font color="#CCCCCC"> drop-off and there's like</font>

572
00:22:59,420 --> 00:23:04,040
something<font color="#E5E5E5"> like 200 admins on each of</font>

573
00:23:02,330 --> 00:23:06,139
these<font color="#E5E5E5"> systems this is</font><font color="#CCCCCC"> not based on real</font>

574
00:23:04,040 --> 00:23:08,210
<font color="#CCCCCC">data yeah doing this based</font><font color="#E5E5E5"> on real</font><font color="#CCCCCC"> data</font>

575
00:23:06,140 --> 00:23:11,000
it would<font color="#CCCCCC"> obviously be a bad idea if I</font>

576
00:23:08,210 --> 00:23:14,600
wanted<font color="#E5E5E5"> to show</font><font color="#CCCCCC"> you host names</font><font color="#E5E5E5"> but in</font>

577
00:23:11,000 --> 00:23:18,020
reality<font color="#E5E5E5"> this usually doesn't follow this</font>

578
00:23:14,600 --> 00:23:20,270
kind<font color="#E5E5E5"> of like extreme</font><font color="#CCCCCC"> and then as a huge</font>

579
00:23:18,020 --> 00:23:21,889
<font color="#CCCCCC">drop-off it's usually it's usually</font><font color="#E5E5E5"> much</font>

580
00:23:20,270 --> 00:23:24,110
more subtle there's usually a<font color="#E5E5E5"> very</font>

581
00:23:21,890 --> 00:23:26,300
subtle<font color="#CCCCCC"> drop-off and so you would</font><font color="#E5E5E5"> have a</font>

582
00:23:24,110 --> 00:23:27,530
computer that<font color="#CCCCCC"> has domain users added</font><font color="#E5E5E5"> to</font>

583
00:23:26,300 --> 00:23:29,690
the<font color="#E5E5E5"> local admins group obviously that's</font>

584
00:23:27,530 --> 00:23:32,000
bad<font color="#CCCCCC"> it's usually pretty</font><font color="#E5E5E5"> easy to</font>

585
00:23:29,690 --> 00:23:33,530
remediate<font color="#CCCCCC"> but then you have all these</font>

586
00:23:32,000 --> 00:23:35,060
instances<font color="#CCCCCC"> where you</font><font color="#E5E5E5"> have groups that</font>

587
00:23:33,530 --> 00:23:36,860
have hundreds<font color="#E5E5E5"> and hundreds and hundreds</font>

588
00:23:35,060 --> 00:23:38,510
<font color="#CCCCCC">of users</font><font color="#E5E5E5"> in them that</font><font color="#CCCCCC"> are granted local</font>

589
00:23:36,860 --> 00:23:40,399
admin rights you can<font color="#CCCCCC"> fare</font><font color="#E5E5E5"> it all that</font>

590
00:23:38,510 --> 00:23:42,290
<font color="#E5E5E5">stuff out with this I challenge you to</font>

591
00:23:40,400 --> 00:23:46,100
go<font color="#E5E5E5"> find this in a</font><font color="#CCCCCC"> tuck if you can do</font><font color="#E5E5E5"> it</font>

592
00:23:42,290 --> 00:23:47,659
<font color="#E5E5E5">it's you're an eighty god that you can</font>

593
00:23:46,100 --> 00:23:51,370
do<font color="#CCCCCC"> anything yeah the world is</font><font color="#E5E5E5"> your</font>

594
00:23:47,660 --> 00:23:51,370
oyster<font color="#CCCCCC"> you are Shawn that cough</font><font color="#E5E5E5"> exactly</font>

595
00:23:51,880 --> 00:23:58,940
so what<font color="#E5E5E5"> about outbound permissions again</font>

596
00:23:54,980 --> 00:24:00,620
in a<font color="#E5E5E5"> duck</font><font color="#CCCCCC"> there is no way to say for any</font>

597
00:23:58,940 --> 00:24:03,830
given user what permissions does that

598
00:24:00,620 --> 00:24:05,659
user have doesn't exist everything is

599
00:24:03,830 --> 00:24:07,429
<font color="#CCCCCC">inbound permissions that</font><font color="#E5E5E5"> you have to</font>

600
00:24:05,660 --> 00:24:10,340
look at<font color="#E5E5E5"> from either local admin or</font>

601
00:24:07,430 --> 00:24:11,690
<font color="#CCCCCC">eighty objects or whatever if I</font><font color="#E5E5E5"> just</font>

602
00:24:10,340 --> 00:24:13,580
pull<font color="#CCCCCC"> up Rohan's account in Active</font>

603
00:24:11,690 --> 00:24:16,370
Directory I have no clue what privileges

604
00:24:13,580 --> 00:24:18,110
he has unless I take<font color="#E5E5E5"> a stab at it with</font>

605
00:24:16,370 --> 00:24:20,510
like well he belongs to<font color="#CCCCCC"> a</font><font color="#E5E5E5"> group called</font>

606
00:24:18,110 --> 00:24:23,919
server<font color="#CCCCCC"> admins so I I guess that means</font><font color="#E5E5E5"> he</font>

607
00:24:20,510 --> 00:24:27,170
<font color="#CCCCCC">has</font><font color="#E5E5E5"> Evan writes on servers don't know</font>

608
00:24:23,920 --> 00:24:28,550
with bloodhound<font color="#E5E5E5"> it's a lot easier we can</font>

609
00:24:27,170 --> 00:24:30,530
<font color="#E5E5E5">we can find</font>

610
00:24:28,550 --> 00:24:35,120
outbound permissions<font color="#E5E5E5"> for any object</font><font color="#CCCCCC"> very</font>

611
00:24:30,530 --> 00:24:38,930
very easily<font color="#E5E5E5"> so what about stale object</font>

612
00:24:35,120 --> 00:24:42,229
control<font color="#CCCCCC"> thanks again</font><font color="#E5E5E5"> to our friend Dirk</font>

613
00:24:38,930 --> 00:24:45,950
<font color="#CCCCCC">Aeon over there say hello Dirk</font><font color="#E5E5E5"> young or</font>

614
00:24:42,230 --> 00:24:47,570
say<font color="#E5E5E5"> go hot</font><font color="#CCCCCC"> thanks</font><font color="#E5E5E5"> of Dirk now we have a</font>

615
00:24:45,950 --> 00:24:50,960
really<font color="#CCCCCC"> great</font><font color="#E5E5E5"> case study of why this</font>

616
00:24:47,570 --> 00:24:52,939
matters and an easy methodology that<font color="#E5E5E5"> we</font>

617
00:24:50,960 --> 00:24:56,270
can go<font color="#E5E5E5"> through</font><font color="#CCCCCC"> to protect ourselves from</font>

618
00:24:52,940 --> 00:24:58,070
<font color="#E5E5E5">a really nasty attack or an attacker</font>

619
00:24:56,270 --> 00:25:00,050
<font color="#CCCCCC">that has access to</font><font color="#E5E5E5"> our to our Active</font>

620
00:24:58,070 --> 00:25:02,360
Directory<font color="#E5E5E5"> and of course I'm talking</font>

621
00:25:00,050 --> 00:25:04,520
about prove<font color="#E5E5E5"> exchange is there everybody</font>

622
00:25:02,360 --> 00:25:08,060
familiar<font color="#CCCCCC"> if</font><font color="#E5E5E5"> exchange it was like the</font>

623
00:25:04,520 --> 00:25:09,620
most terrifying headline that that that

624
00:25:08,060 --> 00:25:11,690
came out in<font color="#E5E5E5"> like the</font><font color="#CCCCCC"> last two months</font><font color="#E5E5E5"> I</font>

625
00:25:09,620 --> 00:25:15,020
guess because it's it's an exchange<font color="#CCCCCC"> o</font>

626
00:25:11,690 --> 00:25:16,880
<font color="#CCCCCC">day</font><font color="#E5E5E5"> it's one click to domain admin oh my</font>

627
00:25:15,020 --> 00:25:20,120
god

628
00:25:16,880 --> 00:25:22,790
the TLDR on this is that whenever<font color="#E5E5E5"> you</font>

629
00:25:20,120 --> 00:25:24,350
install exchange<font color="#E5E5E5"> actually and you didn't</font>

630
00:25:22,790 --> 00:25:28,580
you don't<font color="#E5E5E5"> use a split permissions model</font>

631
00:25:24,350 --> 00:25:31,719
<font color="#E5E5E5">which nobody does</font><font color="#CCCCCC"> exchange grants itself</font>

632
00:25:28,580 --> 00:25:34,850
severe control of the entire directory

633
00:25:31,720 --> 00:25:37,520
the domain head domain admins<font color="#E5E5E5"> every</font>

634
00:25:34,850 --> 00:25:39,500
<font color="#E5E5E5">object every GPO every oh you you name</font>

635
00:25:37,520 --> 00:25:41,660
it<font color="#CCCCCC"> exchange has control of it this makes</font>

636
00:25:39,500 --> 00:25:43,400
your exchange servers as sensitive as

637
00:25:41,660 --> 00:25:44,870
<font color="#E5E5E5">domain controllers because of an</font>

638
00:25:43,400 --> 00:25:47,390
attacker has<font color="#CCCCCC"> access to</font><font color="#E5E5E5"> an exchange</font>

639
00:25:44,870 --> 00:25:49,040
<font color="#E5E5E5">server in a lot</font><font color="#CCCCCC"> of instances</font><font color="#E5E5E5"> they can</font>

640
00:25:47,390 --> 00:25:50,840
just give themselves<font color="#E5E5E5"> the</font><font color="#CCCCCC"> ability to DC</font>

641
00:25:49,040 --> 00:25:53,120
sync or they can give themselves the

642
00:25:50,840 --> 00:25:57,439
<font color="#CCCCCC">ability to add our story</font><font color="#E5E5E5"> principles to</font>

643
00:25:53,120 --> 00:26:02,179
the domain admins group so let's look at

644
00:25:57,440 --> 00:26:04,400
DC sync for instance<font color="#E5E5E5"> this this view</font>

645
00:26:02,180 --> 00:26:06,740
<font color="#E5E5E5">again this is real data we're looking at</font>

646
00:26:04,400 --> 00:26:08,810
the<font color="#E5E5E5"> domain head which is over there and</font>

647
00:26:06,740 --> 00:26:11,450
they're<font color="#CCCCCC"> very far</font><font color="#E5E5E5"> right and we are</font>

648
00:26:08,810 --> 00:26:14,600
<font color="#CCCCCC">looking at every principle that has</font>

649
00:26:11,450 --> 00:26:15,800
control<font color="#E5E5E5"> of the domain head and that that</font>

650
00:26:14,600 --> 00:26:18,469
control<font color="#E5E5E5"> comes in a few different flavors</font>

651
00:26:15,800 --> 00:26:21,080
it can be like full control it<font color="#E5E5E5"> could be</font>

652
00:26:18,470 --> 00:26:23,210
right dackel it could be all extended

653
00:26:21,080 --> 00:26:24,889
<font color="#CCCCCC">all listen to</font><font color="#E5E5E5"> the rights</font><font color="#CCCCCC"> it could be the</font>

654
00:26:23,210 --> 00:26:26,390
<font color="#CCCCCC">combination of get changes</font><font color="#E5E5E5"> and good</font>

655
00:26:24,890 --> 00:26:30,080
changes all which is what<font color="#E5E5E5"> you need to be</font>

656
00:26:26,390 --> 00:26:32,960
able<font color="#E5E5E5"> to do DC sync whatever so here are</font>

657
00:26:30,080 --> 00:26:35,149
all<font color="#CCCCCC"> the users and computers that have</font>

658
00:26:32,960 --> 00:26:37,550
control<font color="#E5E5E5"> of the domain head these are</font><font color="#CCCCCC"> all</font>

659
00:26:35,150 --> 00:26:39,950
of our clients exchange servers<font color="#E5E5E5"> this is</font>

660
00:26:37,550 --> 00:26:42,060
the exchange trusted<font color="#E5E5E5"> sub system this is</font>

661
00:26:39,950 --> 00:26:44,430
the<font color="#E5E5E5"> exchange Windows permissions group</font>

662
00:26:42,060 --> 00:26:46,500
has the ability<font color="#CCCCCC"> to</font><font color="#E5E5E5"> change the security</font>

663
00:26:44,430 --> 00:26:48,690
<font color="#E5E5E5">descriptor</font><font color="#CCCCCC"> on the domain head</font>

664
00:26:46,500 --> 00:26:50,970
so all those exchange servers have that

665
00:26:48,690 --> 00:26:52,830
privilege<font color="#CCCCCC"> the exchange</font><font color="#E5E5E5"> installer is kind</font>

666
00:26:50,970 --> 00:26:54,620
of<font color="#E5E5E5"> a disaster</font><font color="#CCCCCC"> so if you haven't audited</font>

667
00:26:52,830 --> 00:26:56,669
<font color="#CCCCCC">exchange permissions yet in your</font><font color="#E5E5E5"> domain</font>

668
00:26:54,620 --> 00:27:00,419
<font color="#E5E5E5">yeah you should probably gonna want to</font>

669
00:26:56,670 --> 00:27:02,730
do<font color="#E5E5E5"> that yeah so we zoom in</font><font color="#CCCCCC"> on that</font>

670
00:27:00,420 --> 00:27:04,320
specific offending ace<font color="#CCCCCC"> it is the</font>

671
00:27:02,730 --> 00:27:08,310
exchange<font color="#CCCCCC"> windows permissions group has</font>

672
00:27:04,320 --> 00:27:10,110
right<font color="#CCCCCC"> tackle on</font><font color="#E5E5E5"> the domain head</font><font color="#CCCCCC"> we can</font>

673
00:27:08,310 --> 00:27:12,419
<font color="#E5E5E5">also plot that</font><font color="#CCCCCC"> out</font><font color="#E5E5E5"> so</font><font color="#CCCCCC"> we can see more</font>

674
00:27:10,110 --> 00:27:13,949
visually what the impact of that is so

675
00:27:12,420 --> 00:27:16,490
here<font color="#E5E5E5"> are the exchange servers</font><font color="#CCCCCC"> again they</font>

676
00:27:13,950 --> 00:27:18,930
have the<font color="#CCCCCC"> right tackle privilege</font><font color="#E5E5E5"> through</font>

677
00:27:16,490 --> 00:27:22,140
group delegation to<font color="#E5E5E5"> the domain heads so</font>

678
00:27:18,930 --> 00:27:25,710
<font color="#E5E5E5">our our argument is it doesn't need that</font>

679
00:27:22,140 --> 00:27:28,860
if you look in<font color="#CCCCCC"> a documentation for</font><font color="#E5E5E5"> the</font>

680
00:27:25,710 --> 00:27:31,410
permissions<font color="#E5E5E5"> that exchange 2016 gives</font>

681
00:27:28,860 --> 00:27:33,659
<font color="#E5E5E5">itself I</font><font color="#CCCCCC"> believe this</font><font color="#E5E5E5"> this privilege is</font>

682
00:27:31,410 --> 00:27:36,050
<font color="#CCCCCC">not even</font><font color="#E5E5E5"> listed it is listed for</font>

683
00:27:33,660 --> 00:27:40,920
Exchange Server 2007

684
00:27:36,050 --> 00:27:43,860
<font color="#CCCCCC">and a few others but our pitch to the</font>

685
00:27:40,920 --> 00:27:45,180
client was<font color="#E5E5E5"> get rid of that privilege</font><font color="#CCCCCC"> B</font>

686
00:27:43,860 --> 00:27:47,040
and you're not gonna break<font color="#E5E5E5"> anything</font><font color="#CCCCCC"> and</font>

687
00:27:45,180 --> 00:27:48,720
you're gonna<font color="#E5E5E5"> get rid of an enormous</font>

688
00:27:47,040 --> 00:27:50,460
attack surface because all your exchange

689
00:27:48,720 --> 00:27:52,500
servers<font color="#CCCCCC"> they're just</font><font color="#E5E5E5"> hanging out</font><font color="#CCCCCC"> their</font>

690
00:27:50,460 --> 00:27:53,670
<font color="#E5E5E5">way to be popped and the attack</font><font color="#CCCCCC"> path</font><font color="#E5E5E5"> is</font>

691
00:27:52,500 --> 00:27:56,310
possible in the exchange servers in this

692
00:27:53,670 --> 00:27:58,610
<font color="#CCCCCC">environment was</font><font color="#E5E5E5"> really nasty actually</font>

693
00:27:56,310 --> 00:28:00,750
<font color="#CCCCCC">something I forgot</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> include in here</font>

694
00:27:58,610 --> 00:28:03,000
<font color="#E5E5E5">from</font><font color="#CCCCCC"> a different</font><font color="#E5E5E5"> environment from a</font>

695
00:28:00,750 --> 00:28:06,030
bloodhound user who wants<font color="#E5E5E5"> to remain</font>

696
00:28:03,000 --> 00:28:07,650
anonymous<font color="#CCCCCC"> the domain users group had</font>

697
00:28:06,030 --> 00:28:11,129
<font color="#E5E5E5">been given local</font><font color="#CCCCCC"> ebon rights on all</font><font color="#E5E5E5"> the</font>

698
00:28:07,650 --> 00:28:13,800
exchange servers why not<font color="#E5E5E5"> that's the same</font>

699
00:28:11,130 --> 00:28:15,990
as<font color="#E5E5E5"> making domain users domain admins</font>

700
00:28:13,800 --> 00:28:18,120
it's the exact<font color="#E5E5E5"> same thing it's just one</font>

701
00:28:15,990 --> 00:28:20,370
extra<font color="#E5E5E5"> step in between</font><font color="#CCCCCC"> just just to</font>

702
00:28:18,120 --> 00:28:22,469
<font color="#CCCCCC">clarify in case</font><font color="#E5E5E5"> this is a little</font>

703
00:28:20,370 --> 00:28:24,479
<font color="#E5E5E5">confusing if you</font><font color="#CCCCCC"> are an admin on a</font>

704
00:28:22,470 --> 00:28:26,090
server<font color="#E5E5E5"> and you escalate the system you</font>

705
00:28:24,480 --> 00:28:29,520
are<font color="#E5E5E5"> that server in Active Directory</font>

706
00:28:26,090 --> 00:28:31,590
<font color="#E5E5E5">that's a piece</font><font color="#CCCCCC"> of information</font><font color="#E5E5E5"> that a lot</font>

707
00:28:29,520 --> 00:28:33,540
<font color="#E5E5E5">of people just</font><font color="#CCCCCC"> don't know</font><font color="#E5E5E5"> about and it</font>

708
00:28:31,590 --> 00:28:37,740
<font color="#E5E5E5">makes</font><font color="#CCCCCC"> surberg it makes computer objects</font>

709
00:28:33,540 --> 00:28:39,930
just<font color="#E5E5E5"> as dangerous as users</font><font color="#CCCCCC"> know so if</font>

710
00:28:37,740 --> 00:28:41,400
you've ever told somebody that<font color="#CCCCCC"> you need</font>

711
00:28:39,930 --> 00:28:43,650
to remove a<font color="#CCCCCC"> permission you need to</font>

712
00:28:41,400 --> 00:28:44,760
<font color="#E5E5E5">remove</font><font color="#CCCCCC"> eleven rights whatever</font><font color="#E5E5E5"> what is</font>

713
00:28:43,650 --> 00:28:51,990
<font color="#CCCCCC">the</font><font color="#E5E5E5"> number one question</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> you get</font>

714
00:28:44,760 --> 00:28:53,720
back what<font color="#CCCCCC"> is this going</font><font color="#E5E5E5"> to break it's a</font>

715
00:28:51,990 --> 00:28:55,530
good<font color="#CCCCCC"> question it's a valid question</font>

716
00:28:53,720 --> 00:28:57,240
<font color="#CCCCCC">thankfully</font>

717
00:28:55,530 --> 00:28:59,520
<font color="#CCCCCC">wooden is eventing I can come</font><font color="#E5E5E5"> to the</font>

718
00:28:57,240 --> 00:29:01,740
<font color="#E5E5E5">rescue and it can tell</font><font color="#CCCCCC"> us</font><font color="#E5E5E5"> exactly what's</font>

719
00:28:59,520 --> 00:29:05,460
<font color="#E5E5E5">gonna break if we start removing those</font>

720
00:29:01,740 --> 00:29:07,980
permissions so in Active Directory

721
00:29:05,460 --> 00:29:10,020
you<font color="#E5E5E5"> know we saw the security descriptor</font>

722
00:29:07,980 --> 00:29:10,950
GUI before where we were seeing the

723
00:29:10,020 --> 00:29:12,330
permissions

724
00:29:10,950 --> 00:29:14,130
that's the<font color="#E5E5E5"> deckle that's the</font>

725
00:29:12,330 --> 00:29:16,169
discretionary<font color="#E5E5E5"> access control list that</font>

726
00:29:14,130 --> 00:29:18,450
defines what<font color="#E5E5E5"> permissions exist on that</font>

727
00:29:16,170 --> 00:29:21,030
object<font color="#E5E5E5"> for what principles to the right</font>

728
00:29:18,450 --> 00:29:23,880
<font color="#E5E5E5">of that is thus Akal or the system</font>

729
00:29:21,030 --> 00:29:27,000
access control list and this controls

730
00:29:23,880 --> 00:29:30,300
<font color="#E5E5E5">auditing for this object</font><font color="#CCCCCC"> caveat here is</font>

731
00:29:27,000 --> 00:29:32,070
<font color="#CCCCCC">that you do need to enable advanced</font>

732
00:29:30,300 --> 00:29:35,280
<font color="#E5E5E5">audit features in Active Directory to</font>

733
00:29:32,070 --> 00:29:38,850
get access<font color="#CCCCCC"> to some of this data but</font>

734
00:29:35,280 --> 00:29:41,100
again if we look<font color="#CCCCCC"> at this offending ace</font>

735
00:29:38,850 --> 00:29:44,070
right<font color="#E5E5E5"> here we have one group that has</font>

736
00:29:41,100 --> 00:29:47,250
<font color="#E5E5E5">one</font><font color="#CCCCCC"> permission</font><font color="#E5E5E5"> to one object</font><font color="#CCCCCC"> so we just</font>

737
00:29:44,070 --> 00:29:48,240
<font color="#E5E5E5">need to add one</font><font color="#CCCCCC"> Sakka Lace to determine</font>

738
00:29:47,250 --> 00:29:50,640
whether<font color="#E5E5E5"> or not we're going to break</font>

739
00:29:48,240 --> 00:29:53,310
something<font color="#E5E5E5"> by removing that one offending</font>

740
00:29:50,640 --> 00:29:56,430
permission and if if an exchange server

741
00:29:53,310 --> 00:29:58,500
does use that permission<font color="#CCCCCC"> it's going to</font>

742
00:29:56,430 --> 00:30:00,930
<font color="#CCCCCC">generate an event because the computer</font>

743
00:29:58,500 --> 00:30:03,630
use that group membership to execute

744
00:30:00,930 --> 00:30:05,340
that<font color="#E5E5E5"> privilege so we can just add</font><font color="#CCCCCC"> one</font>

745
00:30:03,630 --> 00:30:07,260
very simple<font color="#CCCCCC"> ace</font><font color="#E5E5E5"> of thus Akal we have</font>

746
00:30:05,340 --> 00:30:10,050
<font color="#E5E5E5">exchange trusted subsystem it's a</font>

747
00:30:07,260 --> 00:30:11,550
success<font color="#E5E5E5"> applies</font><font color="#CCCCCC"> to this object only and</font>

748
00:30:10,050 --> 00:30:14,970
it's for the<font color="#CCCCCC"> modify permissions</font>

749
00:30:11,550 --> 00:30:17,909
privilege<font color="#E5E5E5"> so now anytime that an</font>

750
00:30:14,970 --> 00:30:18,720
exchange<font color="#CCCCCC"> server modifies permissions on</font>

751
00:30:17,910 --> 00:30:21,360
<font color="#E5E5E5">the domain head</font>

752
00:30:18,720 --> 00:30:23,130
you're gonna generate a 51:36 event<font color="#E5E5E5"> that</font>

753
00:30:21,360 --> 00:30:25,340
you can then ingest<font color="#E5E5E5"> into</font><font color="#CCCCCC"> Splunk</font>

754
00:30:23,130 --> 00:30:27,900
<font color="#CCCCCC">queue radar whatever you want to do</font>

755
00:30:25,340 --> 00:30:29,639
don't<font color="#CCCCCC"> just</font><font color="#E5E5E5"> leave it in the Windows Event</font>

756
00:30:27,900 --> 00:30:31,950
<font color="#E5E5E5">log on the domain controller because</font>

757
00:30:29,640 --> 00:30:35,640
it's gonna get it's<font color="#E5E5E5"> gonna get purged</font>

758
00:30:31,950 --> 00:30:37,200
<font color="#CCCCCC">when that when that log gets full out of</font>

759
00:30:35,640 --> 00:30:40,460
<font color="#CCCCCC">curiosity how many</font><font color="#E5E5E5"> people</font><font color="#CCCCCC"> have actually</font>

760
00:30:37,200 --> 00:30:42,690
like messed with cycles on any objects

761
00:30:40,460 --> 00:30:45,240
<font color="#CCCCCC">okay how many people have actually</font><font color="#E5E5E5"> seen</font>

762
00:30:42,690 --> 00:30:48,750
<font color="#E5E5E5">that auditing tab before how many people</font>

763
00:30:45,240 --> 00:30:54,780
did it<font color="#CCCCCC"> on accident</font><font color="#E5E5E5"> that's what I thought</font>

764
00:30:48,750 --> 00:30:56,880
<font color="#E5E5E5">so</font><font color="#CCCCCC"> the idea</font><font color="#E5E5E5"> is we now</font><font color="#CCCCCC"> have the ability</font>

765
00:30:54,780 --> 00:31:00,300
to see if an exchange server<font color="#E5E5E5"> ever</font>

766
00:30:56,880 --> 00:31:02,480
actually<font color="#E5E5E5"> uses this permission so now we</font>

767
00:31:00,300 --> 00:31:02,480
wait

768
00:31:03,750 --> 00:31:09,210
and the end<font color="#E5E5E5"> result of going through this</font>

769
00:31:06,389 --> 00:31:11,399
<font color="#CCCCCC">exercise with our client who had they</font>

770
00:31:09,210 --> 00:31:14,370
already had really robust web

771
00:31:11,399 --> 00:31:16,620
<font color="#CCCCCC">architecture really</font><font color="#E5E5E5"> good steam or sim or</font>

772
00:31:14,370 --> 00:31:17,850
how are we<font color="#CCCCCC"> I don't think we've</font><font color="#E5E5E5"> decided</font>

773
00:31:16,620 --> 00:31:24,239
how<font color="#E5E5E5"> to say that word</font><font color="#CCCCCC"> how do you say</font><font color="#E5E5E5"> it</font>

774
00:31:17,850 --> 00:31:27,059
<font color="#E5E5E5">Shawn sim sim that's canonical now</font><font color="#CCCCCC"> the</font>

775
00:31:24,240 --> 00:31:28,379
end result of this<font color="#E5E5E5"> is that the total</font>

776
00:31:27,059 --> 00:31:29,539
<font color="#CCCCCC">number of</font><font color="#E5E5E5"> events we collected in 14</font>

777
00:31:28,379 --> 00:31:33,360
months with<font color="#E5E5E5"> zero</font>

778
00:31:29,539 --> 00:31:35,519
we removed the<font color="#E5E5E5"> offending aces nothing</font>

779
00:31:33,360 --> 00:31:37,740
broke<font color="#E5E5E5"> and we did this five months before</font>

780
00:31:35,519 --> 00:31:41,220
dirty on did his work so when the

781
00:31:37,740 --> 00:31:42,570
headline hit client didn't care<font color="#E5E5E5"> because</font>

782
00:31:41,220 --> 00:31:47,009
the offending permission that made it

783
00:31:42,570 --> 00:31:48,960
possible for this attack<font color="#E5E5E5"> to work didn't</font>

784
00:31:47,009 --> 00:31:50,940
exist<font color="#CCCCCC"> so</font><font color="#E5E5E5"> you could do the man in the</font>

785
00:31:48,960 --> 00:31:52,500
middle<font color="#E5E5E5"> position you could relay the</font>

786
00:31:50,940 --> 00:31:54,330
credential<font color="#E5E5E5"> for the computer account</font><font color="#CCCCCC"> you</font>

787
00:31:52,500 --> 00:31:56,070
<font color="#CCCCCC">could</font><font color="#E5E5E5"> do all that stuff but</font><font color="#CCCCCC"> the</font>

788
00:31:54,330 --> 00:31:58,889
permissions the exchange servers had

789
00:31:56,070 --> 00:32:00,149
<font color="#CCCCCC">we're very</font><font color="#E5E5E5"> very limited and you couldn't</font>

790
00:31:58,889 --> 00:32:02,129
actually do<font color="#CCCCCC"> anything interesting with</font>

791
00:32:00,149 --> 00:32:04,830
<font color="#CCCCCC">that so</font><font color="#E5E5E5"> client was already protected and</font>

792
00:32:02,129 --> 00:32:06,719
they were<font color="#CCCCCC"> happy we were happy super</font>

793
00:32:04,830 --> 00:32:08,668
<font color="#E5E5E5">super happy</font><font color="#CCCCCC"> by the way</font><font color="#E5E5E5"> one eternity</font>

794
00:32:06,720 --> 00:32:10,889
later is whatever<font color="#E5E5E5"> you define</font><font color="#CCCCCC"> is an</font>

795
00:32:08,669 --> 00:32:12,659
eternity<font color="#CCCCCC"> if you decide that</font><font color="#E5E5E5"> two months</font>

796
00:32:10,889 --> 00:32:15,209
is good enough to<font color="#E5E5E5"> decide that you don't</font>

797
00:32:12,659 --> 00:32:17,879
<font color="#E5E5E5">need that</font><font color="#CCCCCC"> anymore</font><font color="#E5E5E5"> that's all</font><font color="#CCCCCC"> you need if</font>

798
00:32:15,210 --> 00:32:20,759
you decide to days<font color="#E5E5E5"> more power to you</font>

799
00:32:17,879 --> 00:32:22,408
it's<font color="#E5E5E5"> your call yeah</font><font color="#CCCCCC"> fourteen</font><font color="#E5E5E5"> months</font><font color="#CCCCCC"> in</font>

800
00:32:20,759 --> 00:32:26,519
this<font color="#E5E5E5"> case because our client was very</font>

801
00:32:22,409 --> 00:32:30,899
very very paranoid about<font color="#CCCCCC"> it so they're</font>

802
00:32:26,519 --> 00:32:33,179
<font color="#CCCCCC">there</font><font color="#E5E5E5"> their exchange their exchange</font>

803
00:32:30,899 --> 00:32:36,629
admin said that<font color="#E5E5E5"> this would completely</font>

804
00:32:33,179 --> 00:32:39,029
<font color="#E5E5E5">break</font><font color="#CCCCCC"> exchange email will be</font><font color="#E5E5E5"> down the</font>

805
00:32:36,629 --> 00:32:40,740
CEO<font color="#CCCCCC"> will be on the phone a company</font><font color="#E5E5E5"> would</font>

806
00:32:39,029 --> 00:32:42,419
<font color="#E5E5E5">be on fire Microsoft would didn't</font>

807
00:32:40,740 --> 00:32:44,669
support yeah like you're<font color="#E5E5E5"> justyou're</font>

808
00:32:42,419 --> 00:32:46,950
<font color="#E5E5E5">you're killing</font><font color="#CCCCCC"> yourself like removing</font>

809
00:32:44,669 --> 00:32:50,629
this privilege<font color="#E5E5E5"> spoiler alert</font><font color="#CCCCCC"> nothing</font>

810
00:32:46,950 --> 00:32:56,929
broke<font color="#E5E5E5"> and the CEO still guys emails</font>

811
00:32:50,629 --> 00:33:01,769
what's that 2016 I<font color="#CCCCCC"> think I think</font>

812
00:32:56,929 --> 00:33:04,129
<font color="#E5E5E5">correctly</font><font color="#CCCCCC"> but interestingly be like only</font>

813
00:33:01,769 --> 00:33:07,019
<font color="#E5E5E5">be like because</font><font color="#CCCCCC"> they're</font><font color="#E5E5E5"> running a</font>

814
00:33:04,129 --> 00:33:09,600
current<font color="#E5E5E5"> ish version of exchange</font><font color="#CCCCCC"> don't it</font>

815
00:33:07,019 --> 00:33:11,940
was a more new one than that<font color="#CCCCCC"> the</font>

816
00:33:09,600 --> 00:33:13,918
permissions that<font color="#E5E5E5"> were there were put</font>

817
00:33:11,940 --> 00:33:17,009
there<font color="#E5E5E5"> by</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> exchange</font><font color="#CCCCCC"> server 2003</font>

818
00:33:13,919 --> 00:33:17,340
installer<font color="#E5E5E5"> when you upgrade exchange it</font>

819
00:33:17,009 --> 00:33:19,950
doesn't

820
00:33:17,340 --> 00:33:21,480
nothing to remove<font color="#E5E5E5"> legacy permissions if</font>

821
00:33:19,950 --> 00:33:23,760
you think exchange is cleaning up after

822
00:33:21,480 --> 00:33:27,300
itself you're dead<font color="#E5E5E5"> wrong is not and it</font>

823
00:33:23,760 --> 00:33:29,310
is still using<font color="#CCCCCC"> the same groups to have</font>

824
00:33:27,300 --> 00:33:31,760
the exchange<font color="#E5E5E5"> servers end so the exchange</font>

825
00:33:29,310 --> 00:33:35,970
servers they have these permissions that

826
00:33:31,760 --> 00:33:39,810
maybe we're necessary<font color="#CCCCCC"> 16 years ago</font>

827
00:33:35,970 --> 00:33:42,900
<font color="#E5E5E5">probably</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> probably</font><font color="#CCCCCC"> not and the</font>

828
00:33:39,810 --> 00:33:44,220
permissions are still there<font color="#E5E5E5"> so</font><font color="#CCCCCC"> leg rohan</font>

829
00:33:42,900 --> 00:33:46,770
said this is something you should<font color="#E5E5E5"> audit</font>

830
00:33:44,220 --> 00:33:49,280
for all right

831
00:33:46,770 --> 00:33:51,990
what about cross domain<font color="#E5E5E5"> attack paths</font>

832
00:33:49,280 --> 00:33:55,950
<font color="#E5E5E5">this is kind of interesting because as</font>

833
00:33:51,990 --> 00:33:59,190
we<font color="#CCCCCC"> all</font><font color="#E5E5E5"> know domain</font><font color="#CCCCCC"> trusts</font><font color="#E5E5E5"> are not</font><font color="#CCCCCC"> a</font>

834
00:33:55,950 --> 00:34:02,300
security boundary<font color="#E5E5E5"> and if you go to will</font>

835
00:33:59,190 --> 00:34:06,350
and<font color="#CCCCCC"> Lee's talk tomorrow</font><font color="#E5E5E5"> you'll see that</font>

836
00:34:02,300 --> 00:34:06,350
something<font color="#CCCCCC"> else is not a truss boundary</font>

837
00:34:07,940 --> 00:34:12,300
<font color="#CCCCCC">all right</font>

838
00:34:09,719 --> 00:34:14,370
so<font color="#E5E5E5"> unfortunately a lot</font><font color="#CCCCCC"> of</font><font color="#E5E5E5"> organizations</font>

839
00:34:12,300 --> 00:34:17,250
do treat domain trust boundaries as

840
00:34:14,370 --> 00:34:20,339
security boundaries and it was just

841
00:34:17,250 --> 00:34:22,230
maybe a merger acquisition<font color="#CCCCCC"> maybe some IT</font>

842
00:34:20,340 --> 00:34:24,020
admin thought that domain<font color="#CCCCCC"> trusts</font>

843
00:34:22,230 --> 00:34:26,520
<font color="#E5E5E5">boundaries</font><font color="#CCCCCC"> or security boundaries</font>

844
00:34:24,020 --> 00:34:29,070
<font color="#E5E5E5">whatever it doesn't matter</font><font color="#CCCCCC"> that's a</font>

845
00:34:26,520 --> 00:34:32,190
situation<font color="#E5E5E5"> they're in and the the</font>

846
00:34:29,070 --> 00:34:36,060
<font color="#E5E5E5">remediation or the fix for this is to we</font>

847
00:34:32,190 --> 00:34:38,909
architect the entire forest that's a lot

848
00:34:36,060 --> 00:34:41,790
of<font color="#E5E5E5"> money that you're</font><font color="#CCCCCC"> paying to Microsoft</font>

849
00:34:38,909 --> 00:34:44,100
premium field engineering or you're

850
00:34:41,790 --> 00:34:46,110
paying<font color="#E5E5E5"> other</font><font color="#CCCCCC"> people a lot of money to</font>

851
00:34:44,100 --> 00:34:47,250
<font color="#CCCCCC">react attack that and you</font><font color="#E5E5E5"> talk</font><font color="#CCCCCC"> about</font>

852
00:34:46,110 --> 00:34:52,470
<font color="#E5E5E5">something's gonna break</font>

853
00:34:47,250 --> 00:34:54,420
<font color="#CCCCCC">oh my god so here's an example</font><font color="#E5E5E5"> of again</font>

854
00:34:52,469 --> 00:34:56,730
the same environment<font color="#E5E5E5"> we're looking at</font>

855
00:34:54,420 --> 00:34:59,580
<font color="#E5E5E5">we're just looking at is it possible to</font>

856
00:34:56,730 --> 00:35:03,210
go from<font color="#CCCCCC"> domain user in one domain to</font>

857
00:34:59,580 --> 00:35:06,090
<font color="#CCCCCC">domain admin in another</font><font color="#E5E5E5"> domain and of</font>

858
00:35:03,210 --> 00:35:09,810
course it is<font color="#E5E5E5"> others yeah spoiler alert</font>

859
00:35:06,090 --> 00:35:12,570
<font color="#E5E5E5">so we have the domain users in one</font>

860
00:35:09,810 --> 00:35:14,310
domain<font color="#E5E5E5"> and they have admin rights on</font>

861
00:35:12,570 --> 00:35:16,410
<font color="#E5E5E5">four different computers they have four</font>

862
00:35:14,310 --> 00:35:18,660
<font color="#E5E5E5">different choices they can</font><font color="#CCCCCC"> go</font><font color="#E5E5E5"> to then</font>

863
00:35:16,410 --> 00:35:21,000
there were five<font color="#CCCCCC"> different privileged</font>

864
00:35:18,660 --> 00:35:23,549
accounts that were logged<font color="#E5E5E5"> onto each of</font>

865
00:35:21,000 --> 00:35:26,070
<font color="#CCCCCC">these systems and all of this was</font><font color="#E5E5E5"> in</font><font color="#CCCCCC"> the</font>

866
00:35:23,550 --> 00:35:28,860
same domain then these users have<font color="#CCCCCC"> been</font>

867
00:35:26,070 --> 00:35:30,339
<font color="#E5E5E5">added</font><font color="#CCCCCC"> to a group in</font><font color="#E5E5E5"> a foreign domain and</font>

868
00:35:28,860 --> 00:35:32,529
in the domain<font color="#CCCCCC"> two</font>

869
00:35:30,339 --> 00:35:34,029
and this group had admin rights on this

870
00:35:32,529 --> 00:35:36,219
computer<font color="#E5E5E5"> so if you're</font><font color="#CCCCCC"> following along as</font>

871
00:35:34,029 --> 00:35:37,869
an attacker<font color="#E5E5E5"> from</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> domain user I pivot</font>

872
00:35:36,219 --> 00:35:41,049
to this machine<font color="#CCCCCC"> I steal this guy's</font>

873
00:35:37,869 --> 00:35:43,900
password<font color="#CCCCCC"> I use my my group membership</font>

874
00:35:41,049 --> 00:35:46,589
here to pivot<font color="#E5E5E5"> to this machine</font><font color="#CCCCCC"> and on</font>

875
00:35:43,900 --> 00:35:49,059
this<font color="#CCCCCC"> machine this user was logged on</font>

876
00:35:46,589 --> 00:35:52,839
this user was added to a group<font color="#E5E5E5"> in a</font>

877
00:35:49,059 --> 00:35:54,579
different domain<font color="#E5E5E5"> and this group has full</font>

878
00:35:52,839 --> 00:35:57,249
<font color="#CCCCCC">control of the domain admins group in</font>

879
00:35:54,579 --> 00:35:59,380
that other domain if<font color="#E5E5E5"> you think this is</font>

880
00:35:57,249 --> 00:36:01,390
rare<font color="#CCCCCC"> just about every multi domain</font>

881
00:35:59,380 --> 00:36:05,249
environment we've seen has a path like

882
00:36:01,390 --> 00:36:08,469
this<font color="#E5E5E5"> this is very very</font><font color="#CCCCCC"> common with</font>

883
00:36:05,249 --> 00:36:11,259
memberships<font color="#E5E5E5"> between domains or admin</font>

884
00:36:08,469 --> 00:36:13,150
rights<font color="#E5E5E5"> across domains like I think</font>

885
00:36:11,259 --> 00:36:15,160
probably<font color="#CCCCCC"> like 90% of what you see</font><font color="#E5E5E5"> so</font>

886
00:36:13,150 --> 00:36:16,960
actually the entire reason<font color="#E5E5E5"> we created</font>

887
00:36:15,160 --> 00:36:20,799
bloodhound<font color="#CCCCCC"> in the first place is because</font>

888
00:36:16,960 --> 00:36:23,650
of because of<font color="#E5E5E5"> this case</font><font color="#CCCCCC"> huge</font>

889
00:36:20,799 --> 00:36:26,769
<font color="#E5E5E5">organization over a hundred domains in</font>

890
00:36:23,650 --> 00:36:29,079
one forest<font color="#E5E5E5"> global conglomerate type</font>

891
00:36:26,769 --> 00:36:31,930
company super<font color="#E5E5E5"> super good security</font>

892
00:36:29,079 --> 00:36:35,589
posture so<font color="#E5E5E5"> know what</font><font color="#CCCCCC"> meso eight oh six</font>

893
00:36:31,930 --> 00:36:39,848
<font color="#E5E5E5">seven no eternal blue which was still in</font>

894
00:36:35,589 --> 00:36:41,710
<font color="#E5E5E5">sa tradecraft at the time yeah</font><font color="#CCCCCC"> nothing</font>

895
00:36:39,849 --> 00:36:43,960
that<font color="#CCCCCC"> you could</font><font color="#E5E5E5"> just easily like password</font>

896
00:36:41,710 --> 00:36:45,579
guess or whatever<font color="#CCCCCC"> like we're only</font><font color="#E5E5E5"> able</font>

897
00:36:43,960 --> 00:36:50,499
<font color="#CCCCCC">to abuse</font><font color="#E5E5E5"> misconfigurations in the</font>

898
00:36:45,579 --> 00:36:52,989
directory<font color="#E5E5E5"> to achieve our objective so by</font>

899
00:36:50,499 --> 00:36:56,229
the third<font color="#CCCCCC"> red team that</font><font color="#E5E5E5"> we were</font><font color="#CCCCCC"> doing</font>

900
00:36:52,989 --> 00:36:59,769
for<font color="#E5E5E5"> this company we got da in one domain</font>

901
00:36:56,229 --> 00:37:04,180
and couldn't turn that<font color="#E5E5E5"> in an enterprise</font>

902
00:36:59,769 --> 00:37:07,359
admin at the forest<font color="#CCCCCC"> root so we go back</font>

903
00:37:04,180 --> 00:37:10,479
<font color="#E5E5E5">we try again</font><font color="#CCCCCC"> can't do</font><font color="#E5E5E5"> it then we start</font>

904
00:37:07,359 --> 00:37:14,249
we start<font color="#CCCCCC"> Pio seeing out bloodhound</font><font color="#E5E5E5"> which</font>

905
00:37:10,479 --> 00:37:14,249
was called test out<font color="#CCCCCC"> HTML at the time</font>

906
00:37:14,309 --> 00:37:19,089
should've<font color="#CCCCCC"> had a screenshot</font><font color="#E5E5E5"> of that in</font>

907
00:37:16,059 --> 00:37:22,539
here<font color="#E5E5E5"> oh it's so bad</font><font color="#CCCCCC"> it's terrible</font><font color="#E5E5E5"> so a</font>

908
00:37:19,089 --> 00:37:24,549
test out HTML<font color="#CCCCCC"> we</font><font color="#E5E5E5"> used to find an attack</font>

909
00:37:22,539 --> 00:37:28,059
path from domain admin in this<font color="#E5E5E5"> like</font>

910
00:37:24,549 --> 00:37:30,089
random<font color="#E5E5E5"> backwater domain to the one and</font>

911
00:37:28,059 --> 00:37:34,150
only enterprise admin at the forest<font color="#CCCCCC"> root</font>

912
00:37:30,089 --> 00:37:36,400
<font color="#E5E5E5">it crossed through eight domain trust</font>

913
00:37:34,150 --> 00:37:38,289
boundaries<font color="#CCCCCC"> and along the way we were</font>

914
00:37:36,400 --> 00:37:42,489
never popping a domain admin along the

915
00:37:38,289 --> 00:37:44,140
way it was all this like like server

916
00:37:42,489 --> 00:37:46,210
admins<font color="#CCCCCC"> yeah server</font><font color="#E5E5E5"> admin</font>

917
00:37:44,140 --> 00:37:49,569
<font color="#E5E5E5">it's like the kind</font><font color="#CCCCCC"> of the underbelly</font><font color="#E5E5E5"> of</font>

918
00:37:46,210 --> 00:37:51,910
of Active Directory<font color="#E5E5E5"> control</font><font color="#CCCCCC"> I just like</font>

919
00:37:49,570 --> 00:37:53,860
<font color="#CCCCCC">Shawn was saying with es AE it's</font>

920
00:37:51,910 --> 00:37:55,470
fantastic<font color="#E5E5E5"> for protecting domain admins</font>

921
00:37:53,860 --> 00:37:58,210
<font color="#E5E5E5">it would have done nothing</font><font color="#CCCCCC"> for</font>

922
00:37:55,470 --> 00:37:59,709
<font color="#E5E5E5">protecting against this kind</font><font color="#CCCCCC"> of attack</font>

923
00:37:58,210 --> 00:38:01,740
path because you have<font color="#E5E5E5"> your server admins</font>

924
00:37:59,710 --> 00:38:03,730
and your workstation admins and all that

925
00:38:01,740 --> 00:38:06,330
so<font color="#E5E5E5"> again we're looking at this from like</font>

926
00:38:03,730 --> 00:38:09,040
<font color="#E5E5E5">a systemic issue perspective so what</font>

927
00:38:06,330 --> 00:38:11,620
what how come how can<font color="#E5E5E5"> we quantify</font><font color="#CCCCCC"> like</font>

928
00:38:09,040 --> 00:38:13,779
how bad is a situation<font color="#CCCCCC"> like from one</font>

929
00:38:11,620 --> 00:38:17,670
domain to<font color="#CCCCCC"> another between</font><font color="#E5E5E5"> all domains</font>

930
00:38:13,780 --> 00:38:23,320
<font color="#E5E5E5">and the answer is with</font><font color="#CCCCCC"> bloodhound so</font>

931
00:38:17,670 --> 00:38:27,760
<font color="#E5E5E5">little bit a cipher we can grab every</font>

932
00:38:23,320 --> 00:38:30,430
computer in a specific<font color="#E5E5E5"> domain and we can</font>

933
00:38:27,760 --> 00:38:32,410
<font color="#E5E5E5">return all the admins on each of those</font>

934
00:38:30,430 --> 00:38:36,399
computers that don't<font color="#E5E5E5"> belong to</font><font color="#CCCCCC"> the same</font>

935
00:38:32,410 --> 00:38:37,930
<font color="#CCCCCC">domain as that computer so I'm a user in</font>

936
00:38:36,400 --> 00:38:41,830
domain a I have admin rights<font color="#E5E5E5"> in a</font>

937
00:38:37,930 --> 00:38:42,899
computer<font color="#CCCCCC"> and domain</font><font color="#E5E5E5"> B the output looks</font>

938
00:38:41,830 --> 00:38:46,029
something like this

939
00:38:42,900 --> 00:38:50,140
so the<font color="#CCCCCC"> right-hand column we're looking</font>

940
00:38:46,030 --> 00:38:51,940
at<font color="#CCCCCC"> for in abdomens 41 29 29 29 etc so</font>

941
00:38:50,140 --> 00:38:53,710
the top one there<font color="#E5E5E5"> there are 41 users</font>

942
00:38:51,940 --> 00:38:55,390
from<font color="#E5E5E5"> a different domain that have admin</font>

943
00:38:53,710 --> 00:38:57,280
<font color="#CCCCCC">rights on</font><font color="#E5E5E5"> that one computer so that's</font>

944
00:38:55,390 --> 00:39:00,520
the way like depending<font color="#E5E5E5"> on how you think</font>

945
00:38:57,280 --> 00:39:03,640
<font color="#CCCCCC">about</font><font color="#E5E5E5"> that that's 41 potential attack</font>

946
00:39:00,520 --> 00:39:06,280
paths<font color="#E5E5E5"> from one domain into another and</font>

947
00:39:03,640 --> 00:39:08,200
then that grows exponentially as you

948
00:39:06,280 --> 00:39:12,760
start multiplying these things<font color="#E5E5E5"> by each</font>

949
00:39:08,200 --> 00:39:17,649
other we can<font color="#E5E5E5"> visualize this with the</font>

950
00:39:12,760 --> 00:39:21,010
flow<font color="#E5E5E5"> chart or a diagram yeah so this is</font>

951
00:39:17,650 --> 00:39:23,770
<font color="#CCCCCC">a little convoluted to read</font><font color="#E5E5E5"> but it's not</font>

952
00:39:21,010 --> 00:39:28,180
too<font color="#E5E5E5"> bad so starting from domain one for</font>

953
00:39:23,770 --> 00:39:31,300
<font color="#E5E5E5">instance we have 23,000 users that have</font>

954
00:39:28,180 --> 00:39:35,950
<font color="#E5E5E5">admin rights</font><font color="#CCCCCC"> on</font><font color="#E5E5E5"> 8700 computers in domain</font>

955
00:39:31,300 --> 00:39:38,590
<font color="#CCCCCC">two from domain three we have a hundred</font>

956
00:39:35,950 --> 00:39:41,189
<font color="#CCCCCC">and eighty-two</font><font color="#E5E5E5"> users that</font><font color="#CCCCCC"> have admin</font>

957
00:39:38,590 --> 00:39:44,500
<font color="#CCCCCC">rights on</font><font color="#E5E5E5"> 1,500 computers at domain</font><font color="#CCCCCC"> two</font>

958
00:39:41,190 --> 00:39:47,250
so<font color="#E5E5E5"> basically like the the pattern</font><font color="#CCCCCC"> that</font>

959
00:39:44,500 --> 00:39:49,630
emerges here is that domain<font color="#CCCCCC"> one is</font>

960
00:39:47,250 --> 00:39:52,470
basically accessible from any other

961
00:39:49,630 --> 00:39:55,840
domain<font color="#CCCCCC"> there's a lot</font><font color="#E5E5E5"> of work to do with</font>

962
00:39:52,470 --> 00:39:58,029
<font color="#E5E5E5">trimming that privilege if it's if it's</font>

963
00:39:55,840 --> 00:40:01,180
strategically necessary if if

964
00:39:58,030 --> 00:40:04,000
that is not an acceptable<font color="#CCCCCC"> attack path</font>

965
00:40:01,180 --> 00:40:06,210
possibility domain<font color="#CCCCCC"> two is like</font>

966
00:40:04,000 --> 00:40:08,320
relatively exposed<font color="#E5E5E5"> domain three has</font>

967
00:40:06,210 --> 00:40:11,350
relatively a small<font color="#CCCCCC"> number of computers</font>

968
00:40:08,320 --> 00:40:14,410
<font color="#CCCCCC">that</font><font color="#E5E5E5"> are exposed to foreign admins</font><font color="#CCCCCC"> and</font>

969
00:40:11,350 --> 00:40:17,799
<font color="#E5E5E5">that's like ten thousand</font><font color="#CCCCCC"> fifty-three is</font>

970
00:40:14,410 --> 00:40:23,170
that right<font color="#E5E5E5"> can I do arithmetic probably</font>

971
00:40:17,800 --> 00:40:26,830
not<font color="#CCCCCC"> a thousand</font><font color="#E5E5E5"> fifty three thank you</font>

972
00:40:23,170 --> 00:40:28,150
thank you Jerry yeah<font color="#E5E5E5"> so we can we can</font>

973
00:40:26,830 --> 00:40:30,040
<font color="#E5E5E5">visualize this and we can see</font>

974
00:40:28,150 --> 00:40:31,840
immediately<font color="#CCCCCC"> like where the big issues</font>

975
00:40:30,040 --> 00:40:33,430
are now for this we're only looking at

976
00:40:31,840 --> 00:40:34,930
<font color="#E5E5E5">local admin rights well we can do this</font>

977
00:40:33,430 --> 00:40:37,060
<font color="#E5E5E5">we mate with anything we could do this</font>

978
00:40:34,930 --> 00:40:39,790
with GPO control we could do it with

979
00:40:37,060 --> 00:40:42,670
control of<font color="#E5E5E5"> user objects</font><font color="#CCCCCC"> you name</font><font color="#E5E5E5"> it</font>

980
00:40:39,790 --> 00:40:44,860
<font color="#CCCCCC">every attack path possibility that the</font>

981
00:40:42,670 --> 00:40:47,610
<font color="#E5E5E5">bloodhound database tracks we can</font><font color="#CCCCCC"> apply</font>

982
00:40:44,860 --> 00:40:49,660
<font color="#E5E5E5">the same</font><font color="#CCCCCC"> methodology to find these uh I</font>

983
00:40:47,610 --> 00:40:53,620
guess these links between<font color="#E5E5E5"> the different</font>

984
00:40:49,660 --> 00:40:57,310
<font color="#CCCCCC">domains all</font><font color="#E5E5E5"> right</font>

985
00:40:53,620 --> 00:41:06,160
is<font color="#E5E5E5"> it food coma hidden yet am</font><font color="#CCCCCC"> i speaking</font>

986
00:40:57,310 --> 00:41:08,100
<font color="#CCCCCC">wildly and</font><font color="#E5E5E5"> quickly enough okay so today</font>

987
00:41:06,160 --> 00:41:10,600
we<font color="#E5E5E5"> are introducing</font><font color="#CCCCCC"> a</font><font color="#E5E5E5"> treatment tools</font>

988
00:41:08,100 --> 00:41:14,110
that we<font color="#E5E5E5"> are generally referring to them</font>

989
00:41:10,600 --> 00:41:16,839
as bloodhound analytics<font color="#E5E5E5"> first one is a</font>

990
00:41:14,110 --> 00:41:18,970
power bi workbook called bloodhound

991
00:41:16,840 --> 00:41:22,450
analytics<font color="#CCCCCC"> P</font><font color="#E5E5E5"> bi X this is obviously a</font>

992
00:41:18,970 --> 00:41:23,620
<font color="#CCCCCC">very creative</font><font color="#E5E5E5"> name that we paid</font>

993
00:41:22,450 --> 00:41:25,720
marketing<font color="#E5E5E5"> people a lot of</font><font color="#CCCCCC"> money to come</font>

994
00:41:23,620 --> 00:41:29,470
<font color="#E5E5E5">up with this is a proof of concept</font>

995
00:41:25,720 --> 00:41:32,649
charting<font color="#CCCCCC"> power book</font><font color="#E5E5E5"> or workbook in power</font>

996
00:41:29,470 --> 00:41:34,990
bi and the concept here<font color="#CCCCCC"> is just to</font><font color="#E5E5E5"> show</font>

997
00:41:32,650 --> 00:41:37,990
<font color="#CCCCCC">you how power bi can be used to make</font>

998
00:41:34,990 --> 00:41:40,959
automatic connections using<font color="#CCCCCC"> saved</font>

999
00:41:37,990 --> 00:41:43,540
queries to the neo4j database and then

1000
00:41:40,960 --> 00:41:44,800
render that output<font color="#CCCCCC"> without having</font><font color="#E5E5E5"> to go</font>

1001
00:41:43,540 --> 00:41:46,990
through<font color="#CCCCCC"> the</font><font color="#E5E5E5"> rigmarole of using the</font>

1002
00:41:44,800 --> 00:41:49,270
console and export into Excel<font color="#E5E5E5"> and going</font>

1003
00:41:46,990 --> 00:41:51,129
through<font color="#E5E5E5"> all</font><font color="#CCCCCC"> that all that</font><font color="#E5E5E5"> nightmare</font>

1004
00:41:49,270 --> 00:41:52,840
so there's<font color="#E5E5E5"> several built-in queries that</font>

1005
00:41:51,130 --> 00:41:54,190
are<font color="#E5E5E5"> useful that with corresponding</font>

1006
00:41:52,840 --> 00:41:55,270
visualizations<font color="#CCCCCC"> that are already</font><font color="#E5E5E5"> built</font>

1007
00:41:54,190 --> 00:41:56,770
<font color="#E5E5E5">they're very pretty</font>

1008
00:41:55,270 --> 00:41:59,980
visualization<font color="#E5E5E5"> for what it's worth</font>

1009
00:41:56,770 --> 00:42:01,870
<font color="#E5E5E5">they're not too bad</font><font color="#CCCCCC"> well have a blog</font>

1010
00:41:59,980 --> 00:42:04,560
post<font color="#CCCCCC"> that shows how you can</font><font color="#E5E5E5"> expand this</font>

1011
00:42:01,870 --> 00:42:07,270
yourself if you have some<font color="#E5E5E5"> kind of clever</font>

1012
00:42:04,560 --> 00:42:08,529
<font color="#CCCCCC">chart that you want to show you I'll</font>

1013
00:42:07,270 --> 00:42:11,340
<font color="#CCCCCC">show</font><font color="#E5E5E5"> you exactly how</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> do that using</font>

1014
00:42:08,530 --> 00:42:13,650
<font color="#E5E5E5">the</font><font color="#CCCCCC"> power</font><font color="#E5E5E5"> bi query are not query</font>

1015
00:42:11,340 --> 00:42:14,520
which but like<font color="#CCCCCC"> data massaged language</font><font color="#E5E5E5"> I</font>

1016
00:42:13,650 --> 00:42:17,580
don't<font color="#CCCCCC"> know I don't</font><font color="#E5E5E5"> know</font><font color="#CCCCCC"> he would</font><font color="#E5E5E5"> refer</font>

1017
00:42:14,520 --> 00:42:19,500
to<font color="#E5E5E5"> it as the power bi language should</font>

1018
00:42:17,580 --> 00:42:22,140
<font color="#E5E5E5">have named it a test dot</font><font color="#CCCCCC"> P bi</font><font color="#E5E5E5"> X just</font>

1019
00:42:19,500 --> 00:42:25,050
<font color="#E5E5E5">call traditional you're right yeah</font><font color="#CCCCCC"> this</font>

1020
00:42:22,140 --> 00:42:26,310
<font color="#E5E5E5">is released under</font><font color="#CCCCCC"> gplv3 and then it's</font>

1021
00:42:25,050 --> 00:42:28,920
gonna<font color="#E5E5E5"> be up on github after this talk is</font>

1022
00:42:26,310 --> 00:42:30,690
over<font color="#E5E5E5"> and here's what it looks like so</font>

1023
00:42:28,920 --> 00:42:33,570
you<font color="#CCCCCC"> saw this chart</font><font color="#E5E5E5"> before whereas</font>

1024
00:42:30,690 --> 00:42:35,400
computers<font color="#CCCCCC"> by a number of</font><font color="#E5E5E5"> admins then</font>

1025
00:42:33,570 --> 00:42:37,590
<font color="#CCCCCC">also if we zoom in on the</font><font color="#E5E5E5"> upper right we</font>

1026
00:42:35,400 --> 00:42:40,050
can see percentage of<font color="#E5E5E5"> users with a path</font>

1027
00:42:37,590 --> 00:42:44,160
<font color="#CCCCCC">of da 100%</font><font color="#E5E5E5"> Wow things</font><font color="#CCCCCC"> are not</font><font color="#E5E5E5"> looking</font>

1028
00:42:40,050 --> 00:42:46,200
good<font color="#CCCCCC"> for</font><font color="#E5E5E5"> you</font><font color="#CCCCCC"> we use this in our service</font>

1029
00:42:44,160 --> 00:42:47,640
line<font color="#CCCCCC"> where we use bloodhound to help</font>

1030
00:42:46,200 --> 00:42:49,560
<font color="#CCCCCC">people get rid of these attack paths</font><font color="#E5E5E5"> and</font>

1031
00:42:47,640 --> 00:42:51,810
we're constantly<font color="#E5E5E5"> coming back to this</font>

1032
00:42:49,560 --> 00:42:53,970
after we say all right<font color="#E5E5E5"> we're gonna make</font>

1033
00:42:51,810 --> 00:42:55,950
this<font color="#E5E5E5"> change in the directory and</font><font color="#CCCCCC"> we</font>

1034
00:42:53,970 --> 00:42:57,990
think it's a killer<font color="#E5E5E5"> awesome idea and</font>

1035
00:42:55,950 --> 00:43:00,810
it's<font color="#E5E5E5"> gonna solve all your problems and</font>

1036
00:42:57,990 --> 00:43:02,310
it's gonna be<font color="#E5E5E5"> like remove remove an ace</font>

1037
00:43:00,810 --> 00:43:04,590
from the dip from<font color="#E5E5E5"> the</font><font color="#CCCCCC"> advocacy</font><font color="#E5E5E5"> holder</font>

1038
00:43:02,310 --> 00:43:06,900
objects or remove the control<font color="#E5E5E5"> from GPO</font>

1039
00:43:04,590 --> 00:43:09,060
that we were<font color="#E5E5E5"> looking at before</font><font color="#CCCCCC"> and nine</font>

1040
00:43:06,900 --> 00:43:12,120
nine times out of<font color="#CCCCCC"> ten this number stays</font>

1041
00:43:09,060 --> 00:43:14,279
the<font color="#E5E5E5"> exact same we we were very quickly</font>

1042
00:43:12,120 --> 00:43:16,109
disabused of are like<font color="#E5E5E5"> initial notions of</font>

1043
00:43:14,280 --> 00:43:18,540
how easy this<font color="#E5E5E5"> was gonna be yeah our</font>

1044
00:43:16,110 --> 00:43:20,640
first<font color="#CCCCCC"> our first</font><font color="#E5E5E5"> one was not fun</font><font color="#CCCCCC"> yeah</font>

1045
00:43:18,540 --> 00:43:23,250
<font color="#E5E5E5">it's actually incredibly difficult to</font>

1046
00:43:20,640 --> 00:43:26,910
defeat an attack graph<font color="#CCCCCC"> but it's it's</font>

1047
00:43:23,250 --> 00:43:28,740
<font color="#CCCCCC">possible so he also saw this one already</font>

1048
00:43:26,910 --> 00:43:30,930
<font color="#CCCCCC">so the computers but</font><font color="#E5E5E5"> a number of admins</font>

1049
00:43:28,740 --> 00:43:32,609
there are then something else<font color="#CCCCCC"> we have is</font>

1050
00:43:30,930 --> 00:43:34,379
<font color="#E5E5E5">like top five highest privileged groups</font>

1051
00:43:32,610 --> 00:43:36,000
by number<font color="#E5E5E5"> of computers you</font><font color="#CCCCCC"> have admin</font>

1052
00:43:34,380 --> 00:43:38,820
<font color="#CCCCCC">rights on so domain</font><font color="#E5E5E5"> admin that's gonna</font>

1053
00:43:36,000 --> 00:43:41,010
be<font color="#E5E5E5"> pretty obvious sometimes you have</font>

1054
00:43:38,820 --> 00:43:43,650
like<font color="#E5E5E5"> an HR group that pops up here and</font>

1055
00:43:41,010 --> 00:43:46,290
it's like hmm<font color="#CCCCCC"> how did this happen</font><font color="#E5E5E5"> so</font>

1056
00:43:43,650 --> 00:43:48,150
<font color="#CCCCCC">it's a very easy</font><font color="#E5E5E5"> way to get like quick</font>

1057
00:43:46,290 --> 00:43:51,840
wins or like low-hanging<font color="#E5E5E5"> fruit</font><font color="#CCCCCC"> that you</font>

1058
00:43:48,150 --> 00:43:53,610
can find<font color="#E5E5E5"> uniquely using an attack graph</font>

1059
00:43:51,840 --> 00:43:56,820
that you cannot find using built-in

1060
00:43:53,610 --> 00:43:58,350
<font color="#E5E5E5">tools in</font><font color="#CCCCCC"> AD</font><font color="#E5E5E5"> and it would be very very</font>

1061
00:43:56,820 --> 00:44:00,840
difficult to<font color="#CCCCCC"> script this out I think</font><font color="#E5E5E5"> if</font>

1062
00:43:58,350 --> 00:44:02,490
you're not<font color="#CCCCCC"> using a graph</font><font color="#E5E5E5"> okay so that's</font>

1063
00:44:00,840 --> 00:44:05,940
part one part two<font color="#E5E5E5"> is bloodhound</font>

1064
00:44:02,490 --> 00:44:09,450
<font color="#E5E5E5">analytics dot</font><font color="#CCCCCC"> PI so this</font><font color="#E5E5E5"> gives us QA</font>

1065
00:44:05,940 --> 00:44:11,520
checks for data completeness<font color="#CCCCCC"> one of the</font>

1066
00:44:09,450 --> 00:44:13,680
biggest pieces<font color="#E5E5E5"> of information that</font><font color="#CCCCCC"> is</font>

1067
00:44:11,520 --> 00:44:16,110
severely lacking in most databases<font color="#E5E5E5"> that</font>

1068
00:44:13,680 --> 00:44:18,990
we look at is user session data<font color="#CCCCCC"> because</font>

1069
00:44:16,110 --> 00:44:22,980
<font color="#E5E5E5">most users</font><font color="#CCCCCC"> will just do one so to say</font>

1070
00:44:18,990 --> 00:44:25,049
loop of session data collection and the

1071
00:44:22,980 --> 00:44:29,250
coverage they have<font color="#E5E5E5"> of where users</font><font color="#CCCCCC"> of</font>

1072
00:44:25,050 --> 00:44:30,240
the environment is maybe like<font color="#CCCCCC"> 5% and so</font>

1073
00:44:29,250 --> 00:44:32,670
<font color="#E5E5E5">you're</font><font color="#CCCCCC"> missing</font>

1074
00:44:30,240 --> 00:44:35,819
<font color="#CCCCCC">95%</font><font color="#E5E5E5"> of users or where they're logged on</font>

1075
00:44:32,670 --> 00:44:37,650
and you're missing huge attack<font color="#E5E5E5"> path</font>

1076
00:44:35,820 --> 00:44:41,490
opportunities you jus get the best

1077
00:44:37,650 --> 00:44:42,690
<font color="#E5E5E5">attack</font><font color="#CCCCCC"> pads</font><font color="#E5E5E5"> you have basic stats</font>

1078
00:44:41,490 --> 00:44:44,819
regarding the number<font color="#CCCCCC"> of</font><font color="#E5E5E5"> nodes and edges</font>

1079
00:44:42,690 --> 00:44:46,380
and<font color="#CCCCCC"> they're different types so</font><font color="#E5E5E5"> you can</font>

1080
00:44:44,820 --> 00:44:49,620
see you know<font color="#E5E5E5"> how comprehensive your data</font>

1081
00:44:46,380 --> 00:44:51,570
is<font color="#CCCCCC"> they're critical asset checks so</font>

1082
00:44:49,620 --> 00:44:53,549
who's a local<font color="#CCCCCC"> Lebanon domain controller</font>

1083
00:44:51,570 --> 00:44:56,730
<font color="#E5E5E5">who can RDP do a domain controller</font>

1084
00:44:53,550 --> 00:45:00,000
<font color="#CCCCCC">things that are universal</font><font color="#E5E5E5"> to any Active</font>

1085
00:44:56,730 --> 00:45:02,160
<font color="#E5E5E5">Directory low-hanging fruit</font><font color="#CCCCCC"> where</font><font color="#E5E5E5"> our</font>

1086
00:45:00,000 --> 00:45:03,690
domain users<font color="#E5E5E5"> at as low as local admin</font>

1087
00:45:02,160 --> 00:45:06,569
where does the authenticated users

1088
00:45:03,690 --> 00:45:08,610
principle have execute<font color="#CCCCCC"> decom</font><font color="#E5E5E5"> privilege</font>

1089
00:45:06,570 --> 00:45:10,980
<font color="#E5E5E5">things that should</font><font color="#CCCCCC"> be very very easy</font>

1090
00:45:08,610 --> 00:45:13,220
<font color="#E5E5E5">wins to get rid of that if you don't get</font>

1091
00:45:10,980 --> 00:45:16,500
rid<font color="#CCCCCC"> of them</font><font color="#E5E5E5"> have a hugely negative</font>

1092
00:45:13,220 --> 00:45:18,060
impact on<font color="#E5E5E5"> your security posture cross</font>

1093
00:45:16,500 --> 00:45:19,830
domain attack<font color="#CCCCCC"> piles we also look at and</font>

1094
00:45:18,060 --> 00:45:23,850
<font color="#E5E5E5">as is of course also</font><font color="#CCCCCC"> release</font><font color="#E5E5E5"> on our</font>

1095
00:45:19,830 --> 00:45:26,190
<font color="#E5E5E5">gplv3 license and will be on github</font>

1096
00:45:23,850 --> 00:45:27,900
after the talk so we have one slide left

1097
00:45:26,190 --> 00:45:29,550
<font color="#CCCCCC">is</font><font color="#E5E5E5"> anything anything else want to say no</font>

1098
00:45:27,900 --> 00:45:32,310
I<font color="#E5E5E5"> think we covered it</font><font color="#CCCCCC"> pretty well</font>

1099
00:45:29,550 --> 00:45:33,900
<font color="#E5E5E5">everyone looks asleep all right well we</font>

1100
00:45:32,310 --> 00:45:36,710
have<font color="#CCCCCC"> a we have</font><font color="#E5E5E5"> a lot</font><font color="#CCCCCC"> of time for</font>

1101
00:45:33,900 --> 00:45:39,150
<font color="#CCCCCC">questions but hopefully this</font><font color="#E5E5E5"> is a good</font>

1102
00:45:36,710 --> 00:45:40,740
way to make you<font color="#E5E5E5"> think about defenders</font>

1103
00:45:39,150 --> 00:45:43,020
being able<font color="#E5E5E5"> to</font><font color="#CCCCCC"> think in graphs now and</font>

1104
00:45:40,740 --> 00:45:45,060
how<font color="#E5E5E5"> we are trying to</font><font color="#CCCCCC"> make this more</font>

1105
00:45:43,020 --> 00:45:47,550
practical<font color="#E5E5E5"> and approachable from the</font>

1106
00:45:45,060 --> 00:45:50,130
defensive side<font color="#E5E5E5"> bloodhound is and always</font>

1107
00:45:47,550 --> 00:45:52,380
will<font color="#E5E5E5"> be an offensive tool first and</font>

1108
00:45:50,130 --> 00:45:53,880
exclusively<font color="#CCCCCC"> is</font><font color="#E5E5E5"> not a defensive tool but</font>

1109
00:45:52,380 --> 00:45:55,670
we're<font color="#E5E5E5"> trying to extract as much</font>

1110
00:45:53,880 --> 00:45:57,870
defensive value out of it<font color="#E5E5E5"> as we can</font>

1111
00:45:55,670 --> 00:45:59,610
<font color="#E5E5E5">here's our contact info you can</font><font color="#CCCCCC"> join the</font>

1112
00:45:57,870 --> 00:46:01,049
bloodhound slack there's like<font color="#CCCCCC"> 30 100</font>

1113
00:45:59,610 --> 00:46:02,790
people in there now and awesome

1114
00:46:01,050 --> 00:46:06,150
conversations are happening all the time

1115
00:46:02,790 --> 00:46:11,240
<font color="#CCCCCC">and so with that we'll leave it to</font>

1116
00:46:06,150 --> 00:46:11,240
questions thank<font color="#E5E5E5"> you</font>

1117
00:46:17,130 --> 00:46:20,940
are there any questions

1118
00:46:28,349 --> 00:46:37,750
thank you for my questions about<font color="#E5E5E5"> how to</font>

1119
00:46:34,299 --> 00:46:40,809
integrate<font color="#CCCCCC"> like a tech path of</font><font color="#E5E5E5"> your stuff</font>

1120
00:46:37,750 --> 00:46:45,210
like backup<font color="#CCCCCC"> systems system</font><font color="#E5E5E5"> set</font>

1121
00:46:40,809 --> 00:46:45,210
management systems or operation manager

1122
00:46:47,160 --> 00:46:52,058
<font color="#CCCCCC">like tie this into some kind of</font><font color="#E5E5E5"> bowl</font>

1123
00:46:50,859 --> 00:46:54,430
management or a system management

1124
00:46:52,059 --> 00:46:58,650
process that<font color="#E5E5E5"> already exists we have</font>

1125
00:46:54,430 --> 00:47:01,390
thoughts about<font color="#E5E5E5"> that that's great yeah</font>

1126
00:46:58,650 --> 00:47:08,859
that's all I want to say<font color="#E5E5E5"> right now good</font>

1127
00:47:01,390 --> 00:47:10,690
question yeah yeah<font color="#E5E5E5"> thanks for</font><font color="#CCCCCC"> the</font><font color="#E5E5E5"> talk</font>

1128
00:47:08,859 --> 00:47:14,380
and<font color="#E5E5E5"> also for the tool it's a great tool</font>

1129
00:47:10,690 --> 00:47:15,880
<font color="#E5E5E5">you</font><font color="#CCCCCC"> mentioned a</font><font color="#E5E5E5"> Windows</font><font color="#CCCCCC"> Event</font><font color="#E5E5E5"> 51:36 and</font>

1130
00:47:14,380 --> 00:47:17,410
you mentioned<font color="#CCCCCC"> it the client</font><font color="#E5E5E5"> waited 14</font>

1131
00:47:15,880 --> 00:47:20,380
months let's assume I don't<font color="#CCCCCC"> want to wait</font>

1132
00:47:17,410 --> 00:47:23,140
14 months<font color="#CCCCCC"> let's</font><font color="#E5E5E5"> say I wait three months</font>

1133
00:47:20,380 --> 00:47:25,089
if it's something happens after<font color="#CCCCCC"> that</font>

1134
00:47:23,140 --> 00:47:26,618
<font color="#CCCCCC">where</font><font color="#E5E5E5"> I still see the event and so I</font>

1135
00:47:25,089 --> 00:47:28,779
could monitor that maybe something

1136
00:47:26,619 --> 00:47:30,460
really<font color="#E5E5E5"> broke or didn't show up and so on</font>

1137
00:47:28,779 --> 00:47:32,710
it was so<font color="#E5E5E5"> monitor you'll see it</font><font color="#CCCCCC"> denied</font>

1138
00:47:30,460 --> 00:47:34,750
so yeah then you just be able<font color="#CCCCCC"> to say</font>

1139
00:47:32,710 --> 00:47:36,130
<font color="#E5E5E5">like oh why did our CEO stop receiving</font>

1140
00:47:34,750 --> 00:47:37,390
<font color="#E5E5E5">email yeah and you look back through</font>

1141
00:47:36,130 --> 00:47:39,640
<font color="#E5E5E5">your logs and you see hey they got</font>

1142
00:47:37,390 --> 00:47:41,680
denied so then you go back<font color="#E5E5E5"> add it in and</font>

1143
00:47:39,640 --> 00:47:44,170
prove exchange pops you the next<font color="#E5E5E5"> day so</font>

1144
00:47:41,680 --> 00:47:45,730
right<font color="#CCCCCC"> that's a great</font><font color="#E5E5E5"> question like you</font>

1145
00:47:44,170 --> 00:47:46,839
<font color="#E5E5E5">don't want to have something silently if</font>

1146
00:47:45,730 --> 00:47:49,660
you don't have some kind<font color="#CCCCCC"> of a critical</font>

1147
00:47:46,839 --> 00:47:51,038
procedures silently fail<font color="#CCCCCC"> without any way</font>

1148
00:47:49,660 --> 00:47:53,799
that troubleshoot that<font color="#E5E5E5"> so yeah</font>

1149
00:47:51,039 --> 00:47:55,920
leaving<font color="#E5E5E5"> that ace behind like Rohan said</font>

1150
00:47:53,799 --> 00:47:59,200
you'll get notice gonna deny event

1151
00:47:55,920 --> 00:48:00,519
<font color="#CCCCCC">excuse me so you'll you'll see the the</font>

1152
00:47:59,200 --> 00:48:07,960
event<font color="#CCCCCC"> pop-up so it</font><font color="#E5E5E5"> doesn't sound like</font>

1153
00:48:00,519 --> 00:48:09,848
fail I've got a question<font color="#E5E5E5"> more related to</font>

1154
00:48:07,960 --> 00:48:10,690
<font color="#E5E5E5">OPSEC for when you guys are running</font>

1155
00:48:09,849 --> 00:48:13,210
<font color="#E5E5E5">bloodhound</font>

1156
00:48:10,690 --> 00:48:14,500
how<font color="#E5E5E5"> many times do you see so you know in</font>

1157
00:48:13,210 --> 00:48:15,910
general<font color="#CCCCCC"> in your and numerating all the</font>

1158
00:48:14,500 --> 00:48:18,309
admins in<font color="#E5E5E5"> the environment and all the</font>

1159
00:48:15,910 --> 00:48:19,359
<font color="#E5E5E5">sessions</font><font color="#CCCCCC"> how many times do you</font><font color="#E5E5E5"> see your</font>

1160
00:48:18,309 --> 00:48:21,700
client come back to you<font color="#E5E5E5"> and say well</font>

1161
00:48:19,359 --> 00:48:23,830
<font color="#E5E5E5">okay</font><font color="#CCCCCC"> we saw</font><font color="#E5E5E5"> this because you know we</font>

1162
00:48:21,700 --> 00:48:25,480
have internal net blows or we just<font color="#E5E5E5"> have</font>

1163
00:48:23,830 --> 00:48:27,130
robust auditing and<font color="#E5E5E5"> we saw the sudden</font>

1164
00:48:25,480 --> 00:48:28,630
one<font color="#E5E5E5"> guys asking every system in the</font>

1165
00:48:27,130 --> 00:48:29,920
environment<font color="#CCCCCC"> do you want the answers</font>

1166
00:48:28,630 --> 00:48:31,450
<font color="#CCCCCC">that'll make you happy or the real</font>

1167
00:48:29,920 --> 00:48:33,970
answer<font color="#E5E5E5"> I want the real answer because</font>

1168
00:48:31,450 --> 00:48:35,350
the real answer is almost<font color="#E5E5E5"> never</font><font color="#CCCCCC"> there</font>

1169
00:48:33,970 --> 00:48:37,209
are very<font color="#E5E5E5"> few people</font><font color="#CCCCCC"> who have</font><font color="#E5E5E5"> robust</font>

1170
00:48:35,350 --> 00:48:38,980
<font color="#E5E5E5">enough net flow to actually pick up on</font>

1171
00:48:37,210 --> 00:48:40,270
<font color="#E5E5E5">this some of</font><font color="#CCCCCC"> our more like advanced</font>

1172
00:48:38,980 --> 00:48:42,400
clients that we run into they're

1173
00:48:40,270 --> 00:48:44,050
starting to<font color="#E5E5E5"> pick up on it</font><font color="#CCCCCC"> just based on</font>

1174
00:48:42,400 --> 00:48:46,720
some behaviors<font color="#E5E5E5"> and stuff like that</font>

1175
00:48:44,050 --> 00:48:49,330
<font color="#CCCCCC">sharkon</font><font color="#E5E5E5"> is not quiet by any means it is</font>

1176
00:48:46,720 --> 00:48:52,810
a super super loud tool when you run its

1177
00:48:49,330 --> 00:48:54,819
default configuration<font color="#CCCCCC"> which it's only</font>

1178
00:48:52,810 --> 00:48:57,009
loud if someone's list exactly<font color="#E5E5E5"> if you're</font>

1179
00:48:54,820 --> 00:48:59,230
not<font color="#E5E5E5"> looking for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> particular brand of</font>

1180
00:48:57,010 --> 00:49:06,850
data then it pretty<font color="#E5E5E5"> much just flies into</font>

1181
00:48:59,230 --> 00:49:09,700
<font color="#E5E5E5">the radar in those places yeah may</font>

1182
00:49:06,850 --> 00:49:10,660
follow<font color="#E5E5E5"> up</font><font color="#CCCCCC"> I assume you are aware</font><font color="#E5E5E5"> of</font>

1183
00:49:09,700 --> 00:49:12,430
Microsoft<font color="#E5E5E5"> ata</font>

1184
00:49:10,660 --> 00:49:24,430
advanced analytics and they kind of

1185
00:49:12,430 --> 00:49:26,259
copycat it<font color="#E5E5E5"> the lateral movement we have</font>

1186
00:49:24,430 --> 00:49:40,980
<font color="#CCCCCC">a good relationship with</font><font color="#E5E5E5"> ata guys so</font>

1187
00:49:26,260 --> 00:49:43,180
yeah we do yeah<font color="#E5E5E5"> okay any more questions</font>

1188
00:49:40,980 --> 00:49:46,150
<font color="#CCCCCC">if there aren't any</font><font color="#E5E5E5"> more questions</font><font color="#CCCCCC"> we</font>

1189
00:49:43,180 --> 00:49:47,470
have<font color="#E5E5E5"> stickers at the front but if you</font>

1190
00:49:46,150 --> 00:49:49,450
take a sticker you<font color="#E5E5E5"> also take a</font><font color="#CCCCCC"> business</font>

1191
00:49:47,470 --> 00:49:51,250
<font color="#E5E5E5">card because</font><font color="#CCCCCC"> our</font><font color="#E5E5E5"> boss makes us do</font>

1192
00:49:49,450 --> 00:49:54,189
business<font color="#CCCCCC"> development when we go to</font>

1193
00:49:51,250 --> 00:49:56,730
conferences so the trap<font color="#CCCCCC"> it's up</font><font color="#E5E5E5"> here for</font>

1194
00:49:54,190 --> 00:50:00,250
you<font color="#E5E5E5"> to take there's like little piles</font>

1195
00:49:56,730 --> 00:50:00,960
<font color="#CCCCCC">meter down</font><font color="#E5E5E5"> for everybody okay thanks</font>

1196
00:50:00,250 --> 00:50:07,090
again

1197
00:50:00,960 --> 00:50:07,090
[Applause]

