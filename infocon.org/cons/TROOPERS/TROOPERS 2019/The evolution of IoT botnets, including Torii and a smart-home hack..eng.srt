1
00:00:01,820 --> 00:00:08,009
<font color="#E5E5E5">right</font><font color="#CCCCCC"> let's come to the next talk which</font>

2
00:00:05,520 --> 00:00:11,248
gained or which topic gained a lot of

3
00:00:08,009 --> 00:00:13,889
popularity and<font color="#E5E5E5"> like heading was very</font>

4
00:00:11,249 --> 00:00:16,410
famous<font color="#E5E5E5"> in the last few years due to some</font>

5
00:00:13,889 --> 00:00:18,990
major incidents that happened buzzwords

6
00:00:16,410 --> 00:00:21,720
me right<font color="#E5E5E5"> and Tori let's give a warm</font>

7
00:00:18,990 --> 00:00:26,009
applause<font color="#E5E5E5"> whoo</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> Anna and his love for</font>

8
00:00:21,720 --> 00:00:29,180
<font color="#CCCCCC">their talk the evolution of IOT botanist</font>

9
00:00:26,010 --> 00:00:32,279
[Applause]

10
00:00:29,180 --> 00:00:35,310
hello everyone<font color="#E5E5E5"> I can you hear me yeah</font>

11
00:00:32,279 --> 00:00:37,980
<font color="#CCCCCC">okay welcome to</font><font color="#E5E5E5"> our talk thank you for</font>

12
00:00:35,310 --> 00:00:41,060
coming the talk is evolution of<font color="#CCCCCC"> IAC bot</font>

13
00:00:37,980 --> 00:00:46,319
Nets including<font color="#CCCCCC"> tory and</font><font color="#E5E5E5"> smart home hack</font>

14
00:00:41,060 --> 00:00:49,590
and before we get<font color="#E5E5E5"> started let</font><font color="#CCCCCC"> me</font>

15
00:00:46,320 --> 00:00:53,070
introduce<font color="#E5E5E5"> who we are I'm Anna I'm a</font>

16
00:00:49,590 --> 00:00:55,440
security<font color="#E5E5E5"> researcher at of ask my current</font>

17
00:00:53,070 --> 00:00:58,470
topic of<font color="#E5E5E5"> interest is</font><font color="#CCCCCC"> IT malware and</font>

18
00:00:55,440 --> 00:01:00,870
botnets<font color="#E5E5E5"> and I'm ready stuff</font><font color="#CCCCCC"> Ellucian and</font>

19
00:00:58,470 --> 00:01:05,489
<font color="#E5E5E5">I do I did research which is why</font><font color="#CCCCCC"> I'm</font>

20
00:01:00,870 --> 00:01:08,030
here<font color="#E5E5E5"> right so today we are going to talk</font>

21
00:01:05,489 --> 00:01:11,400
about<font color="#E5E5E5"> three main things and the first we</font>

22
00:01:08,030 --> 00:01:14,310
will do some retrospective then we will

23
00:01:11,400 --> 00:01:17,580
present<font color="#CCCCCC"> you a case</font><font color="#E5E5E5"> study</font><font color="#CCCCCC"> of botnet is</font>

24
00:01:14,310 --> 00:01:23,909
<font color="#E5E5E5">about natural</font><font color="#CCCCCC"> quarry</font><font color="#E5E5E5"> and at the end we</font>

25
00:01:17,580 --> 00:01:27,900
<font color="#E5E5E5">will show you some hacking so according</font>

26
00:01:23,909 --> 00:01:32,070
<font color="#CCCCCC">to</font><font color="#E5E5E5"> Juniper research we are going to have</font>

27
00:01:27,900 --> 00:01:34,680
around<font color="#E5E5E5"> 38 billion connected devices by</font>

28
00:01:32,070 --> 00:01:38,189
2020<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> really big number and</font>

29
00:01:34,680 --> 00:01:40,770
really hard to understand<font color="#E5E5E5"> and let me</font>

30
00:01:38,189 --> 00:01:44,220
take<font color="#E5E5E5"> you</font><font color="#CCCCCC"> back in 2006</font>

31
00:01:40,770 --> 00:01:47,009
<font color="#E5E5E5">where here</font><font color="#CCCCCC"> you can see the heat map of</font>

32
00:01:44,220 --> 00:01:50,548
the<font color="#CCCCCC"> Internet and the blue dots represent</font>

33
00:01:47,009 --> 00:01:52,890
<font color="#CCCCCC">the utilization of IP addresses and it</font>

34
00:01:50,549 --> 00:01:54,840
like means the low one and<font color="#E5E5E5"> the black is</font>

35
00:01:52,890 --> 00:01:57,299
like devices are<font color="#E5E5E5"> not connected as you</font>

36
00:01:54,840 --> 00:02:01,229
<font color="#CCCCCC">can see there are</font><font color="#E5E5E5"> lots of black spots</font>

37
00:01:57,299 --> 00:02:05,310
<font color="#CCCCCC">and done that</font><font color="#E5E5E5"> many red ones which means</font>

38
00:02:01,229 --> 00:02:09,720
the<font color="#E5E5E5"> 100% utilization and let me fast</font>

39
00:02:05,310 --> 00:02:11,370
<font color="#E5E5E5">forward to 2018 where</font><font color="#CCCCCC"> there like you can</font>

40
00:02:09,720 --> 00:02:13,230
see that the<font color="#E5E5E5"> picture changed</font>

41
00:02:11,370 --> 00:02:15,090
significantly and<font color="#E5E5E5"> there are lots of</font>

42
00:02:13,230 --> 00:02:18,390
connected devices<font color="#CCCCCC"> right</font>

43
00:02:15,090 --> 00:02:20,940
and not<font color="#E5E5E5"> that many black spots so we</font>

44
00:02:18,390 --> 00:02:26,429
<font color="#CCCCCC">managed to utilize almost all ipv4</font>

45
00:02:20,940 --> 00:02:28,530
addresses<font color="#E5E5E5"> and if you were about</font>

46
00:02:26,430 --> 00:02:31,590
wondering how the ipv6 utilization<font color="#E5E5E5"> will</font>

47
00:02:28,530 --> 00:02:35,160
<font color="#E5E5E5">quite that's how it looks like and this</font>

48
00:02:31,590 --> 00:02:38,280
<font color="#CCCCCC">is the future</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> all of</font><font color="#E5E5E5"> that smart</font>

49
00:02:35,160 --> 00:02:42,510
devices<font color="#CCCCCC"> catalyst and some coffee</font>

50
00:02:38,280 --> 00:02:48,500
machines out there<font color="#E5E5E5"> but this is the</font>

51
00:02:42,510 --> 00:02:48,500
future<font color="#CCCCCC"> and what is out there</font><font color="#E5E5E5"> right now</font>

52
00:02:49,160 --> 00:02:53,600
ideas everybody<font color="#E5E5E5"> knows what is</font><font color="#CCCCCC"> shown on</font>

53
00:02:55,370 --> 00:03:01,349
<font color="#CCCCCC">okay we're at security conference right</font>

54
00:02:57,989 --> 00:03:04,170
so<font color="#E5E5E5"> showdown</font><font color="#CCCCCC"> basically like Google for</font>

55
00:03:01,349 --> 00:03:06,738
searching connected devices<font color="#E5E5E5"> and instead</font>

56
00:03:04,170 --> 00:03:09,599
<font color="#CCCCCC">of and you</font><font color="#E5E5E5"> can search pictures there and</font>

57
00:03:06,739 --> 00:03:11,670
it's fairly<font color="#CCCCCC"> easy so</font><font color="#E5E5E5"> for example you</font><font color="#CCCCCC"> just</font>

58
00:03:09,599 --> 00:03:13,410
you know you<font color="#E5E5E5"> search some pictures and</font>

59
00:03:11,670 --> 00:03:16,829
<font color="#E5E5E5">you get some pictures of Google security</font>

60
00:03:13,410 --> 00:03:19,560
<font color="#E5E5E5">cameras out there and there is someone's</font>

61
00:03:16,830 --> 00:03:25,709
back backyard and I don't<font color="#E5E5E5"> know nice sea</font>

62
00:03:19,560 --> 00:03:26,820
<font color="#E5E5E5">view great someone's home okay but can</font>

63
00:03:25,709 --> 00:03:28,790
<font color="#CCCCCC">you really search for something</font><font color="#E5E5E5"> else</font>

64
00:03:26,820 --> 00:03:31,739
something more interesting

65
00:03:28,790 --> 00:03:34,019
how about gas stations there are

66
00:03:31,739 --> 00:03:35,910
thousands of gas stations<font color="#CCCCCC"> in the</font><font color="#E5E5E5"> u.s.</font>

67
00:03:34,019 --> 00:03:39,690
exposed to the internet right<font color="#E5E5E5"> now and</font>

68
00:03:35,910 --> 00:03:43,109
anyone<font color="#E5E5E5"> can connect it just simply tell</font>

69
00:03:39,690 --> 00:03:46,799
Matt to<font color="#E5E5E5"> the IP of the gas station with</font>

70
00:03:43,109 --> 00:03:50,690
<font color="#E5E5E5">port 1001 run one of the hundreds</font>

71
00:03:46,799 --> 00:03:53,220
command commands available<font color="#CCCCCC"> and</font>

72
00:03:50,690 --> 00:03:58,290
theoretically<font color="#CCCCCC"> you can even disrupt the</font>

73
00:03:53,220 --> 00:04:00,630
operation of the<font color="#E5E5E5"> gas station</font><font color="#CCCCCC"> okay that</font>

74
00:03:58,290 --> 00:04:05,069
was<font color="#CCCCCC"> the example</font><font color="#E5E5E5"> of the industrial IOT</font>

75
00:04:00,630 --> 00:04:07,139
but that's the consumer<font color="#CCCCCC"> I will</font><font color="#E5E5E5"> to do</font>

76
00:04:05,069 --> 00:04:17,159
better like<font color="#E5E5E5"> do we have something better</font>

77
00:04:07,139 --> 00:04:20,130
there and in 2016 we got<font color="#CCCCCC"> Mirai and the</font>

78
00:04:17,160 --> 00:04:22,470
DDoS<font color="#E5E5E5"> attack from</font><font color="#CCCCCC"> Mira I was so big</font><font color="#E5E5E5"> that</font>

79
00:04:20,130 --> 00:04:26,700
I think<font color="#CCCCCC"> the attackers</font><font color="#E5E5E5"> like the creators</font>

80
00:04:22,470 --> 00:04:29,069
get scared<font color="#E5E5E5"> and just really the source</font>

81
00:04:26,700 --> 00:04:31,020
code<font color="#E5E5E5"> because</font><font color="#CCCCCC"> they were</font>

82
00:04:29,069 --> 00:04:34,020
maybe afraid that law enforcement<font color="#CCCCCC"> would</font>

83
00:04:31,020 --> 00:04:36,270
get<font color="#CCCCCC"> after them and they were hoping that</font>

84
00:04:34,020 --> 00:04:40,080
<font color="#E5E5E5">all well others who start</font><font color="#CCCCCC"> to copying the</font>

85
00:04:36,270 --> 00:04:42,839
cold and<font color="#CCCCCC"> that can they like get out</font>

86
00:04:40,080 --> 00:04:46,080
attention<font color="#E5E5E5"> out of them but they</font><font color="#CCCCCC"> got</font>

87
00:04:42,839 --> 00:04:49,050
caught<font color="#E5E5E5"> anyway however the damage was</font>

88
00:04:46,080 --> 00:04:52,948
done<font color="#E5E5E5"> already and</font><font color="#CCCCCC"> the source code was out</font>

89
00:04:49,050 --> 00:04:54,960
there yes<font color="#E5E5E5"> so they released the source</font>

90
00:04:52,949 --> 00:04:58,139
code<font color="#E5E5E5"> any script</font><font color="#CCCCCC"> Kitty can now download</font>

91
00:04:54,960 --> 00:05:00,210
it<font color="#CCCCCC"> and compile their own version</font><font color="#E5E5E5"> and it</font>

92
00:04:58,139 --> 00:05:02,309
is very easy<font color="#CCCCCC"> and to show how is it</font>

93
00:05:00,210 --> 00:05:04,349
actually<font color="#CCCCCC"> is</font><font color="#E5E5E5"> we prepared you a tutorial</font>

94
00:05:02,309 --> 00:05:07,169
how to compile your<font color="#CCCCCC"> own mera version</font>

95
00:05:04,349 --> 00:05:09,058
other<font color="#E5E5E5"> one minute</font><font color="#CCCCCC"> in 20 seconds I have</font>

96
00:05:07,169 --> 00:05:10,979
<font color="#CCCCCC">gone to</font><font color="#E5E5E5"> machine there and I already</font>

97
00:05:09,059 --> 00:05:12,930
<font color="#E5E5E5">don't know the source code of</font><font color="#CCCCCC"> Mirai</font><font color="#E5E5E5"> and</font>

98
00:05:10,979 --> 00:05:15,330
I'm just<font color="#E5E5E5"> going to change one module</font>

99
00:05:12,930 --> 00:05:17,399
called scanner<font color="#E5E5E5"> this</font><font color="#CCCCCC"> module is</font>

100
00:05:15,330 --> 00:05:19,770
responsible<font color="#CCCCCC"> for doing dictionary attack</font>

101
00:05:17,399 --> 00:05:23,159
on potential vulnerable targets of Mirai

102
00:05:19,770 --> 00:05:25,979
so once Mirai detects open port for

103
00:05:23,159 --> 00:05:28,319
telnet<font color="#E5E5E5"> it tries to get</font><font color="#CCCCCC"> insight</font><font color="#E5E5E5"> using</font>

104
00:05:25,979 --> 00:05:31,139
predefined dictionary<font color="#CCCCCC"> and what I'm going</font>

105
00:05:28,319 --> 00:05:34,740
<font color="#E5E5E5">to do I'm going to change one entity I'm</font>

106
00:05:31,139 --> 00:05:38,309
going to add entity with a<font color="#E5E5E5"> user</font><font color="#CCCCCC"> named</font>

107
00:05:34,740 --> 00:05:40,169
super user and password<font color="#E5E5E5"> pass that's very</font>

108
00:05:38,309 --> 00:05:42,479
simple<font color="#E5E5E5"> and maybe it is quite popular</font>

109
00:05:40,169 --> 00:05:45,448
combination<font color="#CCCCCC"> I'm going to save this</font>

110
00:05:42,479 --> 00:05:47,669
module and compile the source code as

111
00:05:45,449 --> 00:05:49,830
<font color="#E5E5E5">you can see it takes a few seconds</font><font color="#CCCCCC"> to</font>

112
00:05:47,669 --> 00:05:52,198
<font color="#E5E5E5">compile the source code and if we move</font>

113
00:05:49,830 --> 00:05:54,029
to the<font color="#E5E5E5"> debug folder you can</font><font color="#CCCCCC"> see that</font>

114
00:05:52,199 --> 00:05:57,289
there<font color="#E5E5E5"> are actually five binaries of</font>

115
00:05:54,029 --> 00:06:00,749
Mirai<font color="#CCCCCC"> four different</font><font color="#E5E5E5"> CPU architectures</font>

116
00:05:57,289 --> 00:06:03,058
now thus thing for me to do is to

117
00:06:00,749 --> 00:06:05,699
<font color="#CCCCCC">actually change and rename the name of</font>

118
00:06:03,059 --> 00:06:09,149
me right<font color="#E5E5E5"> to some new</font><font color="#CCCCCC"> Japanese botnet</font>

119
00:06:05,699 --> 00:06:12,089
name and that's<font color="#E5E5E5"> how you compile your</font><font color="#CCCCCC"> own</font>

120
00:06:09,149 --> 00:06:16,409
<font color="#CCCCCC">moriah variant in under</font><font color="#E5E5E5"> one minute and</font>

121
00:06:12,089 --> 00:06:21,029
<font color="#E5E5E5">20 seconds right there</font><font color="#CCCCCC"> being girls of</font>

122
00:06:16,409 --> 00:06:23,029
<font color="#E5E5E5">that easy how easy is that our media is</font>

123
00:06:21,029 --> 00:06:28,279
still bombarded with

124
00:06:23,029 --> 00:06:28,279
<font color="#E5E5E5">with the headlines like that</font>

125
00:06:34,460 --> 00:06:41,539
right<font color="#CCCCCC"> there are there are</font><font color="#E5E5E5"> many many</font>

126
00:06:38,780 --> 00:06:44,929
<font color="#CCCCCC">mirror</font><font color="#E5E5E5"> variants out there that you</font>

127
00:06:41,540 --> 00:06:47,630
<font color="#CCCCCC">probably</font><font color="#E5E5E5"> heard or seen the oh they all</font>

128
00:06:44,930 --> 00:06:51,140
<font color="#E5E5E5">following</font><font color="#CCCCCC"> the same Japanese name</font>

129
00:06:47,630 --> 00:06:56,060
convention<font color="#E5E5E5"> however</font><font color="#CCCCCC"> they</font><font color="#E5E5E5"> are all</font><font color="#CCCCCC"> copycats</font>

130
00:06:51,140 --> 00:06:59,510
<font color="#E5E5E5">of</font><font color="#CCCCCC"> me right but</font><font color="#E5E5E5"> do we have something</font>

131
00:06:56,060 --> 00:07:04,340
<font color="#E5E5E5">more sophisticated than</font><font color="#CCCCCC"> your eye</font><font color="#E5E5E5"> and yes</font>

132
00:06:59,510 --> 00:07:08,690
we do and this B this<font color="#CCCCCC"> is the LT botnet</font>

133
00:07:04,340 --> 00:07:15,590
<font color="#E5E5E5">called</font><font color="#CCCCCC"> torii this botnet that we</font>

134
00:07:08,690 --> 00:07:20,390
<font color="#CCCCCC">analyzed back in 2017</font><font color="#E5E5E5"> 2018 in September</font>

135
00:07:15,590 --> 00:07:23,929
and this is the team who<font color="#CCCCCC"> was analyzing</font>

136
00:07:20,390 --> 00:07:27,680
<font color="#CCCCCC">the story at</font><font color="#E5E5E5"> the time any of you have</font>

137
00:07:23,930 --> 00:07:29,230
ever<font color="#E5E5E5"> been at Def Con anybody okay do you</font>

138
00:07:27,680 --> 00:07:32,420
know<font color="#E5E5E5"> the games put the fat</font>

139
00:07:29,230 --> 00:07:35,330
well there's games put the fat<font color="#E5E5E5"> and the</font>

140
00:07:32,420 --> 00:07:37,700
DEF CON<font color="#E5E5E5"> and actually there are two of us</font>

141
00:07:35,330 --> 00:07:39,890
<font color="#CCCCCC">here but actually</font><font color="#E5E5E5"> the one of the persons</font>

142
00:07:37,700 --> 00:07:42,500
<font color="#CCCCCC">who were also</font><font color="#E5E5E5"> working on the analyzing</font>

143
00:07:39,890 --> 00:07:44,719
<font color="#E5E5E5">of Turing malware see it's somewhere in</font>

144
00:07:42,500 --> 00:07:47,810
<font color="#E5E5E5">this room so you can play</font><font color="#CCCCCC"> the game spot</font>

145
00:07:44,720 --> 00:07:49,700
of<font color="#E5E5E5"> ostian and spot him so those are the</font>

146
00:07:47,810 --> 00:07:54,410
picture those are you hints<font color="#E5E5E5"> enjoy the</font>

147
00:07:49,700 --> 00:07:57,469
<font color="#CCCCCC">game okay so let me tell you a story</font><font color="#E5E5E5"> how</font>

148
00:07:54,410 --> 00:07:59,360
<font color="#CCCCCC">it all started in the</font><font color="#E5E5E5"> matter</font><font color="#CCCCCC"> of fact it</font>

149
00:07:57,470 --> 00:08:02,060
all started with the tweet where the

150
00:07:59,360 --> 00:08:03,740
famous security researcher dr. Vaseline

151
00:08:02,060 --> 00:08:07,610
<font color="#E5E5E5">bunch up and knowing as a</font>

152
00:08:03,740 --> 00:08:09,950
<font color="#CCCCCC">vasin security posted</font><font color="#E5E5E5"> a tweet</font><font color="#CCCCCC"> that he</font>

153
00:08:07,610 --> 00:08:12,710
<font color="#CCCCCC">stole</font><font color="#E5E5E5"> that honey pods get hit by some</font>

154
00:08:09,950 --> 00:08:17,560
unknown malware not looking like<font color="#E5E5E5"> me I'm</font>

155
00:08:12,710 --> 00:08:25,969
American so and the link<font color="#E5E5E5"> is still active</font>

156
00:08:17,560 --> 00:08:29,720
<font color="#CCCCCC">so we decided to give it a try and do</font>

157
00:08:25,970 --> 00:08:33,740
you remind you that installation<font color="#CCCCCC"> of the</font>

158
00:08:29,720 --> 00:08:36,170
<font color="#CCCCCC">ihe botnets oh like sorry</font><font color="#E5E5E5"> copycats of me</font>

159
00:08:33,740 --> 00:08:38,750
<font color="#E5E5E5">right looks something like that there is</font>

160
00:08:36,169 --> 00:08:42,289
<font color="#CCCCCC">like architectures that you can loop</font>

161
00:08:38,750 --> 00:08:45,860
over<font color="#CCCCCC"> and then W get</font><font color="#E5E5E5"> command download</font>

162
00:08:42,289 --> 00:08:48,140
some binary<font color="#CCCCCC"> with Japanese name and then</font>

163
00:08:45,860 --> 00:08:51,740
the binary<font color="#E5E5E5"> make it</font><font color="#CCCCCC"> execute</font>

164
00:08:48,140 --> 00:08:54,110
the targeting<font color="#CCCCCC"> device and then it ran</font>

165
00:08:51,740 --> 00:08:56,740
basically however the execution<font color="#E5E5E5"> process</font>

166
00:08:54,110 --> 00:09:00,500
for<font color="#E5E5E5"> methylation</font><font color="#CCCCCC"> pulses pretoria</font><font color="#E5E5E5"> looks</font>

167
00:08:56,740 --> 00:09:02,750
quite<font color="#CCCCCC"> different even from the first</font><font color="#E5E5E5"> one</font>

168
00:09:00,500 --> 00:09:08,180
glance you<font color="#CCCCCC"> can see that the script</font><font color="#E5E5E5"> is</font>

169
00:09:02,750 --> 00:09:09,890
much longer so the this<font color="#E5E5E5"> is this is the</font>

170
00:09:08,180 --> 00:09:14,569
first stage<font color="#CCCCCC"> the shell which is trying</font>

171
00:09:09,890 --> 00:09:17,840
actually to get<font color="#E5E5E5"> the binary from the</font><font color="#CCCCCC"> c2</font>

172
00:09:14,570 --> 00:09:20,810
and<font color="#E5E5E5"> the script is rather sophisticated</font>

173
00:09:17,840 --> 00:09:23,690
it's also<font color="#E5E5E5"> trying to get a binary wire</font>

174
00:09:20,810 --> 00:09:27,319
HTTP but if<font color="#E5E5E5"> that</font><font color="#CCCCCC"> fails</font><font color="#E5E5E5"> it's trying to</font>

175
00:09:23,690 --> 00:09:29,470
get it<font color="#CCCCCC"> quietly</font><font color="#E5E5E5"> FTP and the credentials</font>

176
00:09:27,320 --> 00:09:32,870
<font color="#E5E5E5">are nicely provided in the shell script</font>

177
00:09:29,470 --> 00:09:37,160
<font color="#CCCCCC">that</font><font color="#E5E5E5"> was very smart however was not</font>

178
00:09:32,870 --> 00:09:40,220
smart<font color="#E5E5E5"> that</font><font color="#CCCCCC"> the attackers</font><font color="#E5E5E5"> forgot to</font>

179
00:09:37,160 --> 00:09:43,100
restrict the access to the server and so

180
00:09:40,220 --> 00:09:46,820
we got<font color="#E5E5E5"> locks lots of locks</font><font color="#CCCCCC"> there were</font>

181
00:09:43,100 --> 00:09:51,830
like FTP<font color="#CCCCCC"> locks for example which gave us</font>

182
00:09:46,820 --> 00:09:53,810
the<font color="#E5E5E5"> statistics how many unique devices</font>

183
00:09:51,830 --> 00:09:56,030
<font color="#CCCCCC">try to connect the binary</font><font color="#E5E5E5"> and</font><font color="#CCCCCC"> as a</font>

184
00:09:53,810 --> 00:09:58,969
<font color="#E5E5E5">matter of fact there was like around</font><font color="#CCCCCC"> 600</font>

185
00:09:56,030 --> 00:10:02,270
of them at<font color="#E5E5E5"> that time we also get an</font>

186
00:09:58,970 --> 00:10:04,340
access to the HTTP log where we saw<font color="#E5E5E5"> that</font>

187
00:10:02,270 --> 00:10:07,130
some<font color="#CCCCCC"> clients tried to</font><font color="#E5E5E5"> download the</font>

188
00:10:04,340 --> 00:10:11,090
<font color="#CCCCCC">binary wire HTTP</font><font color="#E5E5E5"> and then failed and try</font>

189
00:10:07,130 --> 00:10:14,270
<font color="#E5E5E5">FTP</font><font color="#CCCCCC"> in stuff and also we got from the</font>

190
00:10:11,090 --> 00:10:18,070
binary<font color="#CCCCCC"> that</font><font color="#E5E5E5"> we actually showed you a few</font>

191
00:10:14,270 --> 00:10:22,790
slides<font color="#E5E5E5"> before as well as access logs and</font>

192
00:10:18,070 --> 00:10:25,850
we got access<font color="#CCCCCC"> logs for four days and in</font>

193
00:10:22,790 --> 00:10:27,770
<font color="#E5E5E5">total</font><font color="#CCCCCC"> there were two hundred and six a</font>

194
00:10:25,850 --> 00:10:30,440
unique IP<font color="#E5E5E5"> address is trying to connect</font>

195
00:10:27,770 --> 00:10:34,699
to<font color="#CCCCCC"> that server</font><font color="#E5E5E5"> the interesting thing is</font>

196
00:10:30,440 --> 00:10:37,670
is that one IP try to connect<font color="#CCCCCC"> over 1</font>

197
00:10:34,700 --> 00:10:42,110
million times<font color="#E5E5E5"> and so when we analyze</font>

198
00:10:37,670 --> 00:10:44,990
logs we saw that that<font color="#CCCCCC"> was the someone</font>

199
00:10:42,110 --> 00:10:48,440
<font color="#E5E5E5">who was running do</font><font color="#CCCCCC"> Buster</font><font color="#E5E5E5"> and it's just</font>

200
00:10:44,990 --> 00:10:50,390
the basic food forcing tool so if you

201
00:10:48,440 --> 00:10:53,390
ever<font color="#CCCCCC"> try</font><font color="#E5E5E5"> to</font><font color="#CCCCCC"> analyze new strain of</font>

202
00:10:50,390 --> 00:10:55,280
malware instead of using dear<font color="#E5E5E5"> Buster and</font>

203
00:10:53,390 --> 00:10:59,239
<font color="#CCCCCC">birth</font><font color="#E5E5E5"> force approach maybe there is a</font>

204
00:10:55,280 --> 00:11:03,679
<font color="#CCCCCC">better way</font><font color="#E5E5E5"> to analyze something</font>

205
00:10:59,239 --> 00:11:06,629
so the first stage<font color="#CCCCCC"> the script itself</font>

206
00:11:03,679 --> 00:11:09,509
<font color="#CCCCCC">downloads</font><font color="#E5E5E5"> tries to download the second</font>

207
00:11:06,629 --> 00:11:11,879
stage on the device<font color="#E5E5E5"> right and let's take</font>

208
00:11:09,509 --> 00:11:14,489
<font color="#E5E5E5">a closer</font><font color="#CCCCCC"> look at the second stage of the</font>

209
00:11:11,879 --> 00:11:17,279
<font color="#E5E5E5">touring malware first of all a quite</font>

210
00:11:14,489 --> 00:11:20,609
interesting<font color="#CCCCCC"> thing is that</font><font color="#E5E5E5"> all strings in</font>

211
00:11:17,279 --> 00:11:24,720
the binaries are<font color="#CCCCCC"> skated</font><font color="#E5E5E5"> bikes or and</font>

212
00:11:20,609 --> 00:11:26,669
they appreciated during<font color="#CCCCCC"> runtime when the</font>

213
00:11:24,720 --> 00:11:29,549
string is<font color="#E5E5E5"> needed now</font>

214
00:11:26,669 --> 00:11:31,709
<font color="#E5E5E5">second stage consists of two binaries</font>

215
00:11:29,549 --> 00:11:36,179
<font color="#E5E5E5">first there's an extractor which</font>

216
00:11:31,709 --> 00:11:40,160
extracts the third stage which is<font color="#CCCCCC"> inside</font>

217
00:11:36,179 --> 00:11:43,949
<font color="#E5E5E5">the second stage and it then tries to</font>

218
00:11:40,160 --> 00:11:46,769
<font color="#CCCCCC">actually run it so first thing second</font>

219
00:11:43,949 --> 00:11:50,339
<font color="#CCCCCC">station</font><font color="#E5E5E5"> tries to unpack the third stage</font>

220
00:11:46,769 --> 00:11:53,910
right and it<font color="#E5E5E5"> installs the third stage in</font>

221
00:11:50,339 --> 00:11:56,249
<font color="#CCCCCC">saved oh or random allocation</font><font color="#E5E5E5"> and those</font>

222
00:11:53,910 --> 00:11:58,290
locations are predefined<font color="#E5E5E5"> in the binary</font>

223
00:11:56,249 --> 00:11:59,910
of<font color="#E5E5E5"> second stage and there are quite a</font>

224
00:11:58,290 --> 00:12:03,599
few interesting<font color="#E5E5E5"> examples like slash</font>

225
00:11:59,910 --> 00:12:07,019
users there's been or<font color="#CCCCCC"> / tamp then once</font>

226
00:12:03,600 --> 00:12:10,529
this location is determined<font color="#E5E5E5"> then it uses</font>

227
00:12:07,019 --> 00:12:13,139
<font color="#E5E5E5">one</font><font color="#CCCCCC"> of several random names for the</font>

228
00:12:10,529 --> 00:12:15,360
<font color="#E5E5E5">final name of</font><font color="#CCCCCC"> the third stage</font><font color="#E5E5E5"> and some</font>

229
00:12:13,139 --> 00:12:18,839
interesting<font color="#CCCCCC"> examples are</font><font color="#E5E5E5"> for</font><font color="#CCCCCC"> example</font><font color="#E5E5E5"> I</font>

230
00:12:15,360 --> 00:12:21,989
<font color="#E5E5E5">FTP</font><font color="#CCCCCC"> D or</font><font color="#E5E5E5"> not D so if you actually search</font>

231
00:12:18,839 --> 00:12:24,959
for<font color="#E5E5E5"> all files on your iOS device</font><font color="#CCCCCC"> you</font>

232
00:12:21,989 --> 00:12:27,660
won't<font color="#E5E5E5"> find the file with</font><font color="#CCCCCC"> Torre payload</font>

233
00:12:24,959 --> 00:12:31,378
<font color="#CCCCCC">arm</font><font color="#E5E5E5"> you find something that looks like</font>

234
00:12:27,660 --> 00:12:33,929
system<font color="#E5E5E5"> Linux diamond well once</font>

235
00:12:31,379 --> 00:12:36,839
<font color="#E5E5E5">Tory decides where</font><font color="#CCCCCC"> to put the third</font>

236
00:12:33,929 --> 00:12:40,049
stage<font color="#CCCCCC"> it runs the script to ensure third</font>

237
00:12:36,839 --> 00:12:42,839
stage persistent and it is quite

238
00:12:40,049 --> 00:12:45,059
<font color="#E5E5E5">interesting because there are in total</font>

239
00:12:42,839 --> 00:12:47,220
there are six<font color="#E5E5E5"> ways the</font><font color="#CCCCCC"> Tauri can use to</font>

240
00:12:45,059 --> 00:12:50,339
gain persistence including<font color="#E5E5E5"> creating new</font>

241
00:12:47,220 --> 00:12:53,519
cron jobs or injecting the code for any

242
00:12:50,339 --> 00:12:56,639
app for<font color="#E5E5E5"> Bashar</font><font color="#CCCCCC"> seem right but</font><font color="#E5E5E5"> instead of</font>

243
00:12:53,519 --> 00:12:58,769
<font color="#E5E5E5">just choosing randomly which way of</font>

244
00:12:56,639 --> 00:13:02,339
<font color="#E5E5E5">persistent</font><font color="#CCCCCC"> store</font><font color="#E5E5E5"> is going to use it</font>

245
00:12:58,769 --> 00:13:04,379
<font color="#CCCCCC">executes all</font><font color="#E5E5E5"> of them so it runs all six</font>

246
00:13:02,339 --> 00:13:06,929
ways of gaining precision on the<font color="#E5E5E5"> device</font>

247
00:13:04,379 --> 00:13:08,669
so the moral<font color="#CCCCCC"> of the story</font><font color="#E5E5E5"> once stories</font>

248
00:13:06,929 --> 00:13:11,600
inside your<font color="#CCCCCC"> device it really wants to</font>

249
00:13:08,669 --> 00:13:13,550
<font color="#CCCCCC">stay there now after running</font>

250
00:13:11,600 --> 00:13:15,710
all the scripts to<font color="#E5E5E5"> ensure persistent of</font>

251
00:13:13,550 --> 00:13:18,790
the<font color="#CCCCCC"> third-stage</font><font color="#E5E5E5"> it finally execute sit</font>

252
00:13:15,710 --> 00:13:21,200
so let's move to<font color="#CCCCCC"> that</font><font color="#E5E5E5"> third stage</font><font color="#CCCCCC"> and</font>

253
00:13:18,790 --> 00:13:23,900
<font color="#E5E5E5">there are quite a few interesting</font><font color="#CCCCCC"> things</font>

254
00:13:21,200 --> 00:13:25,880
first of all<font color="#CCCCCC"> Torey uses some anti</font>

255
00:13:23,900 --> 00:13:27,620
debugging methods and I have to say if

256
00:13:25,880 --> 00:13:30,200
<font color="#E5E5E5">you compare it to the Windows malware</font>

257
00:13:27,620 --> 00:13:31,820
<font color="#E5E5E5">they are not very</font><font color="#CCCCCC"> sophisticated but if</font>

258
00:13:30,200 --> 00:13:34,670
you compare<font color="#E5E5E5"> Torey to Mirai</font>

259
00:13:31,820 --> 00:13:37,400
and all<font color="#CCCCCC"> mirai variants</font><font color="#E5E5E5"> it is quite an</font>

260
00:13:34,670 --> 00:13:39,829
upgrade<font color="#CCCCCC"> first</font><font color="#E5E5E5"> of all after starting the</font>

261
00:13:37,400 --> 00:13:42,140
third<font color="#CCCCCC"> stage tori sleeps for</font><font color="#E5E5E5"> 60 second</font>

262
00:13:39,830 --> 00:13:44,870
which<font color="#CCCCCC"> is quite a nice way to avoid very</font>

263
00:13:42,140 --> 00:13:47,270
simple sandboxing then it tries to

264
00:13:44,870 --> 00:13:52,370
<font color="#E5E5E5">undermines the process name so in when</font>

265
00:13:47,270 --> 00:13:54,620
you do<font color="#E5E5E5"> PS grab me Tori</font><font color="#CCCCCC"> you will not find</font>

266
00:13:52,370 --> 00:13:57,230
any processes<font color="#E5E5E5"> but instead it tries to</font>

267
00:13:54,620 --> 00:13:59,930
randomize like Tori tries to generate

268
00:13:57,230 --> 00:14:03,560
<font color="#E5E5E5">very random string and it will basically</font>

269
00:13:59,930 --> 00:14:06,920
generate gibberish<font color="#E5E5E5"> and finally all newer</font>

270
00:14:03,560 --> 00:14:09,829
versions of<font color="#E5E5E5"> the binaries are stripped</font>

271
00:14:06,920 --> 00:14:11,660
<font color="#E5E5E5">which is quite interesting</font><font color="#CCCCCC"> because when</font>

272
00:14:09,830 --> 00:14:12,350
we<font color="#E5E5E5"> started working on the analysis of</font>

273
00:14:11,660 --> 00:14:14,750
<font color="#E5E5E5">Tori</font>

274
00:14:12,350 --> 00:14:17,180
we got the binaries with quite a<font color="#E5E5E5"> lot of</font>

275
00:14:14,750 --> 00:14:18,950
<font color="#E5E5E5">strings inside them but on the second</font>

276
00:14:17,180 --> 00:14:23,060
day<font color="#CCCCCC"> the one day after we start</font><font color="#E5E5E5"> the</font>

277
00:14:18,950 --> 00:14:25,610
analysis our<font color="#CCCCCC"> Yarra</font><font color="#E5E5E5"> scanner got hit but</font>

278
00:14:23,060 --> 00:14:28,729
exact same set of binaries but with no

279
00:14:25,610 --> 00:14:32,960
strings inside now

280
00:14:28,730 --> 00:14:35,540
third stage<font color="#E5E5E5"> once it's running its to</font>

281
00:14:32,960 --> 00:14:42,260
communicate with c2 it uses<font color="#CCCCCC"> multi level</font>

282
00:14:35,540 --> 00:14:44,000
encryption<font color="#CCCCCC"> of communication all of their</font>

283
00:14:42,260 --> 00:14:46,819
communication<font color="#E5E5E5"> with common in control</font>

284
00:14:44,000 --> 00:14:52,390
server goes via TCP port<font color="#CCCCCC"> 4 for free</font>

285
00:14:46,820 --> 00:14:56,780
however the this is<font color="#E5E5E5"> not an HTTP and TLS</font>

286
00:14:52,390 --> 00:14:59,960
rather this<font color="#E5E5E5"> is</font><font color="#CCCCCC"> the the a big deception</font>

287
00:14:56,780 --> 00:15:02,870
<font color="#CCCCCC">because you're just trying to</font><font color="#E5E5E5"> pretend</font>

288
00:14:59,960 --> 00:15:05,510
being<font color="#CCCCCC"> HTTP to avoid IDs SOT</font><font color="#E5E5E5"> bucket</font>

289
00:15:02,870 --> 00:15:07,700
analysis<font color="#CCCCCC"> instructions or like analyst</font><font color="#E5E5E5"> in</font>

290
00:15:05,510 --> 00:15:11,420
general because we all know that<font color="#CCCCCC"> to</font>

291
00:15:07,700 --> 00:15:13,250
analyze HTTP traffic is hard<font color="#E5E5E5"> and all of</font>

292
00:15:11,420 --> 00:15:20,689
their communication with<font color="#CCCCCC"> sea to</font>

293
00:15:13,250 --> 00:15:23,060
encrypted and<font color="#CCCCCC"> extra</font><font color="#E5E5E5"> work</font><font color="#CCCCCC"> so yes</font><font color="#E5E5E5"> so all</font>

294
00:15:20,690 --> 00:15:24,950
the communication is encrypted<font color="#E5E5E5"> sort and</font>

295
00:15:23,060 --> 00:15:27,829
encrypted<font color="#E5E5E5"> which is nice and</font>

296
00:15:24,950 --> 00:15:28,790
then Tory<font color="#CCCCCC"> once</font><font color="#E5E5E5"> started and it waits for</font>

297
00:15:27,830 --> 00:15:31,700
<font color="#CCCCCC">60</font><font color="#E5E5E5"> seconds</font>

298
00:15:28,790 --> 00:15:34,430
it sends quite<font color="#E5E5E5"> a lot of data to the Tory</font>

299
00:15:31,700 --> 00:15:35,990
<font color="#CCCCCC">back end</font><font color="#E5E5E5"> it does data exfiltration</font><font color="#CCCCCC"> and</font>

300
00:15:34,430 --> 00:15:38,449
there is quite a lot<font color="#CCCCCC"> of</font><font color="#E5E5E5"> interesting</font>

301
00:15:35,990 --> 00:15:40,220
thing that Tory actually sends there is

302
00:15:38,450 --> 00:15:42,590
<font color="#CCCCCC">information</font><font color="#E5E5E5"> about the host name the</font>

303
00:15:40,220 --> 00:15:45,200
process ID<font color="#E5E5E5"> the list of all MAC addresses</font>

304
00:15:42,590 --> 00:15:47,330
present on the<font color="#CCCCCC"> device and there is</font>

305
00:15:45,200 --> 00:15:50,420
<font color="#E5E5E5">actually</font><font color="#CCCCCC"> information about memory CPU</font>

306
00:15:47,330 --> 00:15:53,180
and partitions which is quite a lot<font color="#CCCCCC"> of</font>

307
00:15:50,420 --> 00:15:55,579
<font color="#CCCCCC">information and it this information can</font>

308
00:15:53,180 --> 00:15:59,949
be quite useful<font color="#CCCCCC"> for</font><font color="#E5E5E5"> malware authors and</font>

309
00:15:55,580 --> 00:15:59,950
we<font color="#CCCCCC"> can get to this point</font><font color="#E5E5E5"> back later</font><font color="#CCCCCC"> so</font>

310
00:16:00,010 --> 00:16:05,330
<font color="#CCCCCC">as both said that there</font><font color="#E5E5E5"> are lots of</font>

311
00:16:03,230 --> 00:16:09,430
information<font color="#E5E5E5"> could be extracted and to do</font>

312
00:16:05,330 --> 00:16:16,220
so<font color="#CCCCCC"> they there is an implementation of</font>

313
00:16:09,430 --> 00:16:20,900
sorry there isn't this is yeah there is

314
00:16:16,220 --> 00:16:24,920
a lot<font color="#CCCCCC"> of commands implemented and you</font>

315
00:16:20,900 --> 00:16:27,350
can divide the commands from like

316
00:16:24,920 --> 00:16:29,089
inbound from<font color="#E5E5E5"> the common</font><font color="#CCCCCC"> in control to</font>

317
00:16:27,350 --> 00:16:31,070
the<font color="#CCCCCC"> bots and outbound</font><font color="#E5E5E5"> from the boat to</font>

318
00:16:29,090 --> 00:16:33,470
<font color="#CCCCCC">the common in control server and the</font>

319
00:16:31,070 --> 00:16:36,980
body is able<font color="#E5E5E5"> to do lots</font><font color="#CCCCCC"> of file</font>

320
00:16:33,470 --> 00:16:40,520
manipulations and it's<font color="#E5E5E5"> able to check if</font>

321
00:16:36,980 --> 00:16:44,090
the file exists<font color="#E5E5E5"> so it can get to the ATC</font>

322
00:16:40,520 --> 00:16:47,569
/ password<font color="#E5E5E5"> and read the file and send</font>

323
00:16:44,090 --> 00:16:49,520
some information<font color="#CCCCCC"> to</font><font color="#E5E5E5"> the to the</font><font color="#CCCCCC"> c2 and if</font>

324
00:16:47,570 --> 00:16:54,850
the respective<font color="#E5E5E5"> comment comes it can also</font>

325
00:16:49,520 --> 00:16:57,560
delete the file and final thing<font color="#E5E5E5"> yeah yes</font>

326
00:16:54,850 --> 00:17:01,250
<font color="#CCCCCC">there</font><font color="#E5E5E5"> are a few other interesting</font>

327
00:16:57,560 --> 00:17:05,060
features in this malware<font color="#E5E5E5"> string is that</font>

328
00:17:01,250 --> 00:17:07,910
Tory can receive the time out of<font color="#E5E5E5"> two</font>

329
00:17:05,060 --> 00:17:10,609
polling time<font color="#E5E5E5"> which means that</font><font color="#CCCCCC"> by default</font>

330
00:17:07,910 --> 00:17:12,620
<font color="#CCCCCC">let's say</font><font color="#E5E5E5"> Tory communicates with c2 and</font>

331
00:17:10,609 --> 00:17:15,379
tries<font color="#CCCCCC"> to get new</font><font color="#E5E5E5"> comments every</font><font color="#CCCCCC"> 5</font>

332
00:17:12,619 --> 00:17:17,300
<font color="#E5E5E5">minutes right but in the future malware</font>

333
00:17:15,380 --> 00:17:19,400
<font color="#E5E5E5">outers can send</font><font color="#CCCCCC"> the comment hey please</font>

334
00:17:17,300 --> 00:17:22,909
communicate with<font color="#CCCCCC"> me</font><font color="#E5E5E5"> every</font><font color="#CCCCCC"> 1 hour or</font>

335
00:17:19,400 --> 00:17:24,980
<font color="#CCCCCC">every day or every week</font><font color="#E5E5E5"> so it can be</font>

336
00:17:22,910 --> 00:17:27,980
quite stealthy on the network level<font color="#E5E5E5"> and</font>

337
00:17:24,980 --> 00:17:28,580
finally<font color="#CCCCCC"> this is</font><font color="#E5E5E5"> like this is</font><font color="#CCCCCC"> the reason</font>

338
00:17:27,980 --> 00:17:31,550
why

339
00:17:28,580 --> 00:17:33,860
Tory is considered<font color="#CCCCCC"> core</font><font color="#E5E5E5"> engine it can</font>

340
00:17:31,550 --> 00:17:37,820
<font color="#E5E5E5">actually execute any given command and</font>

341
00:17:33,860 --> 00:17:38,780
send the output<font color="#E5E5E5"> back to c2 which is</font>

342
00:17:37,820 --> 00:17:41,110
quite nice imagine

343
00:17:38,780 --> 00:17:44,090
having thousands and thousands of shells

344
00:17:41,110 --> 00:17:46,689
<font color="#E5E5E5">you run one comment and you get output</font>

345
00:17:44,090 --> 00:17:49,699
from all of them<font color="#E5E5E5"> which is quite quite</font>

346
00:17:46,690 --> 00:17:53,470
<font color="#E5E5E5">good for malware outers and not quite</font>

347
00:17:49,700 --> 00:17:53,470
good for normal<font color="#CCCCCC"> people</font>

348
00:17:54,340 --> 00:17:59,929
so Tory has that this is the slide with

349
00:17:58,280 --> 00:18:01,850
all<font color="#E5E5E5"> were</font><font color="#CCCCCC"> very common in control service</font>

350
00:17:59,930 --> 00:18:05,600
that we servers that we were<font color="#CCCCCC"> able to</font>

351
00:18:01,850 --> 00:18:08,209
find and we did some digging<font color="#E5E5E5"> on the IP</font>

352
00:18:05,600 --> 00:18:11,990
addresses<font color="#CCCCCC"> and found out that</font><font color="#E5E5E5"> one</font><font color="#CCCCCC"> of the</font>

353
00:18:08,210 --> 00:18:15,470
domain was resolved to<font color="#CCCCCC"> the</font><font color="#E5E5E5"> Tory</font><font color="#CCCCCC"> I</font><font color="#E5E5E5"> see</font><font color="#CCCCCC"> do</font>

354
00:18:11,990 --> 00:18:19,070
in like back in 2017<font color="#CCCCCC"> so we</font><font color="#E5E5E5"> believe that</font>

355
00:18:15,470 --> 00:18:21,140
Tory operates at least from 2017<font color="#E5E5E5"> it</font>

356
00:18:19,070 --> 00:18:23,720
always has three domains to connect to

357
00:18:21,140 --> 00:18:26,240
the reason why<font color="#CCCCCC"> is I could sort</font><font color="#E5E5E5"> of like a</font>

358
00:18:23,720 --> 00:18:28,760
<font color="#E5E5E5">backup so it tries one domain if the</font>

359
00:18:26,240 --> 00:18:30,710
connection fails<font color="#E5E5E5"> it tries another one if</font>

360
00:18:28,760 --> 00:18:33,200
<font color="#E5E5E5">that fails it's always tried the third</font>

361
00:18:30,710 --> 00:18:37,010
one and that all<font color="#CCCCCC"> three a</font><font color="#E5E5E5"> time that</font><font color="#CCCCCC"> temps</font>

362
00:18:33,200 --> 00:18:39,290
fails<font color="#E5E5E5"> it is trying to resolve the common</font>

363
00:18:37,010 --> 00:18:46,550
<font color="#CCCCCC">in control server domain while the</font>

364
00:18:39,290 --> 00:18:50,030
Google r8 8/8 DNS basically now to

365
00:18:46,550 --> 00:18:52,450
summarize<font color="#CCCCCC"> very its persistent it is</font>

366
00:18:50,030 --> 00:18:56,899
quite<font color="#E5E5E5"> nice to have six different ways of</font>

367
00:18:52,450 --> 00:18:58,940
persistence right once in your in<font color="#E5E5E5"> the</font>

368
00:18:56,900 --> 00:19:02,330
device<font color="#CCCCCC"> Torelli really wants to</font><font color="#E5E5E5"> stay</font>

369
00:18:58,940 --> 00:19:04,580
<font color="#E5E5E5">there</font><font color="#CCCCCC"> it is quite stealthy first of all</font>

370
00:19:02,330 --> 00:19:06,560
it's us<font color="#E5E5E5"> and I'm insured it must carry</font>

371
00:19:04,580 --> 00:19:12,580
<font color="#CCCCCC">it's all</font><font color="#E5E5E5"> the traffic and communication</font>

372
00:19:06,560 --> 00:19:15,379
for<font color="#E5E5E5"> to see</font><font color="#CCCCCC"> - and uses port 443</font><font color="#E5E5E5"> and</font>

373
00:19:12,580 --> 00:19:18,020
finally it is quite modular because

374
00:19:15,380 --> 00:19:21,020
ability to download<font color="#E5E5E5"> and store any given</font>

375
00:19:18,020 --> 00:19:22,340
file and execute any arbitrary command

376
00:19:21,020 --> 00:19:25,490
is basically an<font color="#E5E5E5"> open-book</font>

377
00:19:22,340 --> 00:19:28,370
and if you<font color="#E5E5E5"> combine this with the fact</font>

378
00:19:25,490 --> 00:19:31,820
that<font color="#CCCCCC"> Tory</font><font color="#E5E5E5"> outers have the knowledge of</font>

379
00:19:28,370 --> 00:19:34,540
<font color="#E5E5E5">the CPU memory partition and bandwidth</font>

380
00:19:31,820 --> 00:19:37,820
on their<font color="#E5E5E5"> backends they can create such</font>

381
00:19:34,540 --> 00:19:39,980
scenarios where for<font color="#CCCCCC"> example on the IOT</font>

382
00:19:37,820 --> 00:19:43,490
devices<font color="#E5E5E5"> with quite a lot of CPU</font><font color="#CCCCCC"> power</font>

383
00:19:39,980 --> 00:19:45,920
<font color="#CCCCCC">they are going</font><font color="#E5E5E5"> to mind</font><font color="#CCCCCC"> molaro</font><font color="#E5E5E5"> and on the</font>

384
00:19:43,490 --> 00:19:48,680
<font color="#E5E5E5">devices with quite a lot of bandwidth</font>

385
00:19:45,920 --> 00:19:51,770
they can run DDoS module and actually

386
00:19:48,680 --> 00:19:54,260
use<font color="#E5E5E5"> it</font><font color="#CCCCCC"> to sell for highest</font><font color="#E5E5E5"> bidder</font>

387
00:19:51,770 --> 00:19:59,480
so if you<font color="#E5E5E5"> interested in learning more</font>

388
00:19:54,260 --> 00:20:01,970
<font color="#CCCCCC">about</font><font color="#E5E5E5"> story and all the</font><font color="#CCCCCC"> ICS</font><font color="#E5E5E5"> hashes</font>

389
00:19:59,480 --> 00:20:06,040
domains you can<font color="#CCCCCC"> scan this QR code and it</font>

390
00:20:01,970 --> 00:20:10,820
will<font color="#E5E5E5"> lead you to the full blog post</font><font color="#CCCCCC"> now</font>

391
00:20:06,040 --> 00:20:13,490
<font color="#CCCCCC">before</font><font color="#E5E5E5"> before any malware</font><font color="#CCCCCC"> there is</font>

392
00:20:10,820 --> 00:20:17,210
always a<font color="#E5E5E5"> POC right basically how we</font>

393
00:20:13,490 --> 00:20:19,460
automate things we do we<font color="#E5E5E5"> write quick POC</font>

394
00:20:17,210 --> 00:20:22,550
<font color="#E5E5E5">we see if that works and then we try to</font>

395
00:20:19,460 --> 00:20:25,550
automate every step of the process<font color="#CCCCCC"> and</font>

396
00:20:22,550 --> 00:20:28,190
I'll show<font color="#E5E5E5"> you the few big because we are</font>

397
00:20:25,550 --> 00:20:29,990
<font color="#E5E5E5">algae</font><font color="#CCCCCC"> theater searchers and our job at</font><font color="#E5E5E5"> a</font>

398
00:20:28,190 --> 00:20:32,690
<font color="#E5E5E5">vast is to be one step</font><font color="#CCCCCC"> ahead of the bad</font>

399
00:20:29,990 --> 00:20:36,140
<font color="#E5E5E5">guys we decided to create a demo and see</font>

400
00:20:32,690 --> 00:20:37,940
where this IOT malware could lead<font color="#CCCCCC"> us in</font>

401
00:20:36,140 --> 00:20:40,309
a few<font color="#E5E5E5"> years that's why we</font><font color="#CCCCCC"> created a</font>

402
00:20:37,940 --> 00:20:43,010
short demo<font color="#E5E5E5"> during which I will</font><font color="#CCCCCC"> not</font><font color="#E5E5E5"> be</font>

403
00:20:40,309 --> 00:20:44,660
working<font color="#E5E5E5"> for Avast for next 15 minutes</font>

404
00:20:43,010 --> 00:20:47,750
<font color="#E5E5E5">I'm going to play the role of a hacker</font>

405
00:20:44,660 --> 00:20:50,150
<font color="#E5E5E5">and let's imagine</font><font color="#CCCCCC"> let's pretend I'm a</font>

406
00:20:47,750 --> 00:20:53,179
hacker sitting somewhere<font color="#CCCCCC"> in the coffee</font>

407
00:20:50,150 --> 00:20:56,120
shop<font color="#E5E5E5"> and I'm looking for an easy target</font>

408
00:20:53,179 --> 00:20:58,460
<font color="#CCCCCC">right so what I'm</font><font color="#E5E5E5"> going to do I'm going</font>

409
00:20:56,120 --> 00:21:02,330
to<font color="#E5E5E5"> use showdown to search for</font><font color="#CCCCCC"> something</font>

410
00:20:58,460 --> 00:21:05,090
interesting<font color="#E5E5E5"> to hack right and while I'm</font>

411
00:21:02,330 --> 00:21:06,710
searching<font color="#E5E5E5"> on</font><font color="#CCCCCC"> sciaudone</font><font color="#E5E5E5"> I for the purpose</font>

412
00:21:05,090 --> 00:21:09,530
of<font color="#E5E5E5"> this demo</font><font color="#CCCCCC"> he actually brought the</font>

413
00:21:06,710 --> 00:21:11,090
target<font color="#E5E5E5"> smart home with us which is right</font>

414
00:21:09,530 --> 00:21:14,540
there<font color="#CCCCCC"> and you can see all the smart</font>

415
00:21:11,090 --> 00:21:17,840
devices which we are<font color="#E5E5E5"> going to hack so I</font>

416
00:21:14,540 --> 00:21:20,870
<font color="#E5E5E5">search for devices on</font><font color="#CCCCCC"> shodhan right and</font>

417
00:21:17,840 --> 00:21:23,540
I see there's some<font color="#CCCCCC"> sound</font><font color="#E5E5E5"> some buildings</font>

418
00:21:20,870 --> 00:21:25,428
but these<font color="#CCCCCC"> pictures</font><font color="#E5E5E5"> this picture of</font>

419
00:21:23,540 --> 00:21:28,010
<font color="#CCCCCC">gleaming the</font><font color="#E5E5E5"> room looks quite nice</font>

420
00:21:25,429 --> 00:21:30,920
because<font color="#CCCCCC"> it has very nice smart TV</font><font color="#E5E5E5"> it</font><font color="#CCCCCC"> has</font>

421
00:21:28,010 --> 00:21:34,129
quite a few<font color="#CCCCCC"> devices so let's take a</font>

422
00:21:30,920 --> 00:21:37,760
closer look<font color="#E5E5E5"> so what I'm going to do I'm</font>

423
00:21:34,130 --> 00:21:40,040
going to<font color="#E5E5E5"> run</font><font color="#CCCCCC"> nmap and see what ports are</font>

424
00:21:37,760 --> 00:21:42,410
open on the public IP of<font color="#E5E5E5"> that smart home</font>

425
00:21:40,040 --> 00:21:44,330
right what services are running<font color="#E5E5E5"> and</font>

426
00:21:42,410 --> 00:21:45,230
there are<font color="#E5E5E5"> actually two ports open which</font>

427
00:21:44,330 --> 00:21:48,649
is quite nice

428
00:21:45,230 --> 00:21:50,390
<font color="#E5E5E5">so I</font><font color="#CCCCCC"> have a disclaimer</font><font color="#E5E5E5"> I am very lazy</font>

429
00:21:48,650 --> 00:21:52,520
hacker<font color="#E5E5E5"> so instead of doing something</font>

430
00:21:50,390 --> 00:21:55,280
<font color="#CCCCCC">sophisticated like</font><font color="#E5E5E5"> ironing dear</font><font color="#CCCCCC"> buster</font>

431
00:21:52,520 --> 00:21:57,559
<font color="#E5E5E5">I'm going to actually</font><font color="#CCCCCC"> open the IP</font>

432
00:21:55,280 --> 00:22:02,510
address with the port number<font color="#E5E5E5"> in the</font>

433
00:21:57,559 --> 00:22:05,610
browser<font color="#CCCCCC"> and hey I'm inside I'm inside</font>

434
00:22:02,510 --> 00:22:08,070
this camera<font color="#CCCCCC"> you know the reason why</font>

435
00:22:05,610 --> 00:22:12,090
well<font color="#E5E5E5"> apparently the manual for this</font>

436
00:22:08,070 --> 00:22:13,800
camera is 186 pages long and<font color="#CCCCCC"> the</font>

437
00:22:12,090 --> 00:22:16,070
instructions on how<font color="#CCCCCC"> to</font><font color="#E5E5E5"> change</font><font color="#CCCCCC"> the</font>

438
00:22:13,800 --> 00:22:20,240
default credentials<font color="#CCCCCC"> out</font><font color="#E5E5E5"> on the page 93</font>

439
00:22:16,070 --> 00:22:23,939
<font color="#E5E5E5">how many of you would read this manual</font>

440
00:22:20,240 --> 00:22:25,680
exactly so at this point<font color="#E5E5E5"> I'm inside the</font>

441
00:22:23,940 --> 00:22:27,780
camera<font color="#CCCCCC"> I have under strict it access</font><font color="#E5E5E5"> to</font>

442
00:22:25,680 --> 00:22:29,730
the video stream and because I'm very

443
00:22:27,780 --> 00:22:33,149
<font color="#E5E5E5">bad hacker I'm going to make that camera</font>

444
00:22:29,730 --> 00:22:35,640
dance as<font color="#E5E5E5"> you can see right</font><font color="#CCCCCC"> there but I'm</font>

445
00:22:33,150 --> 00:22:38,220
going to<font color="#E5E5E5"> do much worse things now so</font>

446
00:22:35,640 --> 00:22:40,620
let's move to<font color="#E5E5E5"> the settings menu</font><font color="#CCCCCC"> and</font><font color="#E5E5E5"> you</font>

447
00:22:38,220 --> 00:22:43,350
can see a lot of<font color="#CCCCCC"> options there and I</font>

448
00:22:40,620 --> 00:22:45,870
love<font color="#E5E5E5"> options so let's change a few</font>

449
00:22:43,350 --> 00:22:47,610
things<font color="#E5E5E5"> first of all let's move to the</font>

450
00:22:45,870 --> 00:22:50,399
motion detection settings of the camera

451
00:22:47,610 --> 00:22:52,439
<font color="#E5E5E5">and set up date that way that every time</font>

452
00:22:50,400 --> 00:22:54,450
there is<font color="#E5E5E5"> a loud sound or a motion</font>

453
00:22:52,440 --> 00:22:56,520
detected by that IP camera over<font color="#E5E5E5"> there</font>

454
00:22:54,450 --> 00:22:59,460
<font color="#E5E5E5">the clip of</font><font color="#CCCCCC"> that happening would be</font>

455
00:22:56,520 --> 00:23:02,129
uploaded<font color="#CCCCCC"> to my</font><font color="#E5E5E5"> own FTP server we are</font>

456
00:22:59,460 --> 00:23:04,380
going to get<font color="#E5E5E5"> to this part back later now</font>

457
00:23:02,130 --> 00:23:06,770
<font color="#E5E5E5">because I like having</font><font color="#CCCCCC"> wrote on the</font>

458
00:23:04,380 --> 00:23:09,330
device<font color="#E5E5E5"> I'm going</font><font color="#CCCCCC"> to do command injection</font>

459
00:23:06,770 --> 00:23:11,430
<font color="#E5E5E5">to start</font><font color="#CCCCCC"> download Dimond</font>

460
00:23:09,330 --> 00:23:15,830
which was<font color="#E5E5E5"> really provided in the</font>

461
00:23:11,430 --> 00:23:18,960
<font color="#E5E5E5">firmware of that IP camera I'm going to</font>

462
00:23:15,830 --> 00:23:21,270
start it on a diamond<font color="#CCCCCC"> and because I'm</font>

463
00:23:18,960 --> 00:23:24,810
really<font color="#E5E5E5"> lazy</font><font color="#CCCCCC"> I'm going to change a few</font>

464
00:23:21,270 --> 00:23:27,300
things first of<font color="#E5E5E5"> all</font><font color="#CCCCCC"> after</font><font color="#E5E5E5"> starting</font><font color="#CCCCCC"> on</font>

465
00:23:24,810 --> 00:23:30,090
<font color="#CCCCCC">the diamond I need to somehow</font><font color="#E5E5E5"> make the</font>

466
00:23:27,300 --> 00:23:33,360
change their outer settings to do the

467
00:23:30,090 --> 00:23:35,010
port forwarding<font color="#CCCCCC"> alright</font><font color="#E5E5E5"> so every time</font>

468
00:23:33,360 --> 00:23:38,399
<font color="#E5E5E5">there is</font><font color="#CCCCCC"> something coming on the router</font>

469
00:23:35,010 --> 00:23:40,680
with port number 23 it will be<font color="#E5E5E5"> forwarded</font>

470
00:23:38,400 --> 00:23:44,370
to the<font color="#E5E5E5"> IP address of the camera</font><font color="#CCCCCC"> any of</font>

471
00:23:40,680 --> 00:23:47,040
you heard of<font color="#CCCCCC"> UPnP okay</font>

472
00:23:44,370 --> 00:23:50,159
so<font color="#E5E5E5"> apparently</font><font color="#CCCCCC"> there is a binary called</font>

473
00:23:47,040 --> 00:23:53,370
<font color="#E5E5E5">UPN</font><font color="#CCCCCC"> PC static in</font><font color="#E5E5E5"> the IP camera over</font>

474
00:23:50,160 --> 00:23:55,560
there and you<font color="#CCCCCC"> can ask this binary</font><font color="#E5E5E5"> you</font>

475
00:23:53,370 --> 00:23:57,899
<font color="#CCCCCC">can run this binary to actually set up</font>

476
00:23:55,560 --> 00:24:00,240
the port forwarding<font color="#E5E5E5"> because this binary</font>

477
00:23:57,900 --> 00:24:03,210
<font color="#E5E5E5">will request we will get the request</font>

478
00:24:00,240 --> 00:24:04,920
please forward port 23<font color="#E5E5E5"> it will generate</font>

479
00:24:03,210 --> 00:24:07,800
<font color="#E5E5E5">it BMP requests that it to the router</font>

480
00:24:04,920 --> 00:24:10,950
router will listen<font color="#E5E5E5"> and we'll set up the</font>

481
00:24:07,800 --> 00:24:13,260
<font color="#E5E5E5">port forwarding rules for me and lastly</font>

482
00:24:10,950 --> 00:24:15,090
because<font color="#E5E5E5"> I am really</font><font color="#CCCCCC"> really lazy</font><font color="#E5E5E5"> and this</font>

483
00:24:13,260 --> 00:24:17,490
is a technical<font color="#CCCCCC"> conference</font><font color="#E5E5E5"> I'm just going</font>

484
00:24:15,090 --> 00:24:18,490
<font color="#CCCCCC">to make</font><font color="#E5E5E5"> this IP camera be transparent</font>

485
00:24:17,490 --> 00:24:20,920
proxy

486
00:24:18,490 --> 00:24:23,980
so I will be basically inside this local

487
00:24:20,920 --> 00:24:25,300
network<font color="#E5E5E5"> now after all the changes</font><font color="#CCCCCC"> last</font>

488
00:24:23,980 --> 00:24:27,850
thing to do is<font color="#E5E5E5"> to actually drive</font>

489
00:24:25,300 --> 00:24:29,320
everything<font color="#E5E5E5"> works so let's just try to</font>

490
00:24:27,850 --> 00:24:33,340
turn<font color="#CCCCCC"> that to</font><font color="#E5E5E5"> the IP address of this</font>

491
00:24:29,320 --> 00:24:36,100
smart home and<font color="#E5E5E5"> hey I'm inside</font><font color="#CCCCCC"> this was</font>

492
00:24:33,340 --> 00:24:38,050
<font color="#E5E5E5">very easy any script kiddie can do this</font>

493
00:24:36,100 --> 00:24:40,419
and at this<font color="#E5E5E5"> point I'm</font><font color="#CCCCCC"> not in the coffee</font>

494
00:24:38,050 --> 00:24:42,730
shop anymore<font color="#E5E5E5"> I'm actually inside this IP</font>

495
00:24:40,420 --> 00:24:44,830
camera inside their smart home network

496
00:24:42,730 --> 00:24:47,980
inside their living room<font color="#E5E5E5"> living their</font>

497
00:24:44,830 --> 00:24:50,620
lives with them<font color="#E5E5E5"> now once inside the</font>

498
00:24:47,980 --> 00:24:53,170
local<font color="#E5E5E5"> network</font><font color="#CCCCCC"> what I'm</font><font color="#E5E5E5"> going to do I'm</font>

499
00:24:50,620 --> 00:24:55,030
going to<font color="#E5E5E5"> run</font><font color="#CCCCCC"> nmap</font><font color="#E5E5E5"> I'm going to run</font><font color="#CCCCCC"> nmap</font>

500
00:24:53,170 --> 00:24:58,000
<font color="#E5E5E5">and see what other devices</font><font color="#CCCCCC"> are available</font>

501
00:24:55,030 --> 00:25:01,000
<font color="#CCCCCC">for</font><font color="#E5E5E5"> me to hack right and you can see</font>

502
00:24:58,000 --> 00:25:04,120
<font color="#E5E5E5">that there are 14 devices which is quite</font>

503
00:25:01,000 --> 00:25:06,900
a lot<font color="#E5E5E5"> who have more than five devices</font>

504
00:25:04,120 --> 00:25:11,830
smart devices at their local network

505
00:25:06,900 --> 00:25:13,360
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> more than</font><font color="#CCCCCC"> 10 okay I see you</font><font color="#E5E5E5"> you</font>

506
00:25:11,830 --> 00:25:18,310
<font color="#CCCCCC">have to give me your</font><font color="#E5E5E5"> IP address after</font>

507
00:25:13,360 --> 00:25:21,159
the presentation so I'm just<font color="#E5E5E5"> going to</font>

508
00:25:18,310 --> 00:25:23,139
<font color="#E5E5E5">pick one device and let's play with</font>

509
00:25:21,160 --> 00:25:25,660
smart lights<font color="#CCCCCC"> and you</font><font color="#E5E5E5"> have smart lights</font>

510
00:25:23,140 --> 00:25:28,330
at home<font color="#E5E5E5"> you know okay</font>

511
00:25:25,660 --> 00:25:32,110
quite a few for<font color="#E5E5E5"> technical conference you</font>

512
00:25:28,330 --> 00:25:34,360
don't like IOT very much<font color="#E5E5E5"> now there are a</font>

513
00:25:32,110 --> 00:25:36,100
few<font color="#CCCCCC"> commands</font><font color="#E5E5E5"> available first of all</font>

514
00:25:34,360 --> 00:25:39,100
there is<font color="#CCCCCC"> a comment actually turn the</font>

515
00:25:36,100 --> 00:25:39,879
light<font color="#CCCCCC"> bulbs on and off and you</font><font color="#E5E5E5"> can</font>

516
00:25:39,100 --> 00:25:41,100
<font color="#E5E5E5">change the color</font>

517
00:25:39,880 --> 00:25:43,810
<font color="#CCCCCC">there is no authentification</font>

518
00:25:41,100 --> 00:25:45,820
<font color="#E5E5E5">authorization so any device</font><font color="#CCCCCC"> on the</font>

519
00:25:43,810 --> 00:25:48,970
network<font color="#E5E5E5"> can ask for light bulbs</font><font color="#CCCCCC"> to</font><font color="#E5E5E5"> turn</font>

520
00:25:45,820 --> 00:25:50,830
on and off so let's do<font color="#CCCCCC"> just that</font><font color="#E5E5E5"> let's</font>

521
00:25:48,970 --> 00:25:53,460
drink a<font color="#CCCCCC"> little bit</font><font color="#E5E5E5"> I'm very sorry for</font>

522
00:25:50,830 --> 00:25:56,290
the<font color="#E5E5E5"> strobe in your face do you like it</font>

523
00:25:53,460 --> 00:25:59,830
<font color="#CCCCCC">okay</font><font color="#E5E5E5"> imagine</font><font color="#CCCCCC"> having</font><font color="#E5E5E5"> the house full of</font>

524
00:25:56,290 --> 00:26:00,629
those lights<font color="#E5E5E5"> it's it's not very good</font>

525
00:25:59,830 --> 00:26:05,679
experience

526
00:26:00,630 --> 00:26:08,650
now I'm<font color="#E5E5E5"> not done with lights</font><font color="#CCCCCC"> I already</font>

527
00:26:05,680 --> 00:26:12,880
played oh this is RGB party so let's<font color="#CCCCCC"> do</font>

528
00:26:08,650 --> 00:26:16,330
our GP party now<font color="#E5E5E5"> is</font><font color="#CCCCCC"> it better</font><font color="#E5E5E5"> it's quite</font>

529
00:26:12,880 --> 00:26:18,010
annoying<font color="#E5E5E5"> right yes so I'm not done with</font>

530
00:26:16,330 --> 00:26:20,500
<font color="#E5E5E5">those slides there's apparently another</font>

531
00:26:18,010 --> 00:26:22,330
comment available and this<font color="#E5E5E5"> is a comment</font>

532
00:26:20,500 --> 00:26:24,730
called get<font color="#E5E5E5"> season</font><font color="#CCCCCC"> 4 what</font><font color="#E5E5E5"> would you</font>

533
00:26:22,330 --> 00:26:28,689
<font color="#CCCCCC">expect this</font><font color="#E5E5E5"> comment or return MAC</font>

534
00:26:24,730 --> 00:26:31,570
addresses<font color="#CCCCCC"> hashes system IDs</font><font color="#E5E5E5"> state of the</font>

535
00:26:28,690 --> 00:26:32,360
light and maybe the color<font color="#E5E5E5"> all things are</font>

536
00:26:31,570 --> 00:26:35,658
there<font color="#E5E5E5"> what</font>

537
00:26:32,360 --> 00:26:40,039
is that<font color="#CCCCCC"> they slide Bob</font><font color="#E5E5E5"> returns latitude</font>

538
00:26:35,659 --> 00:26:42,110
and longitude thing is when you pair the

539
00:26:40,039 --> 00:26:45,440
<font color="#CCCCCC">lightbulbs</font><font color="#E5E5E5"> with you company</font><font color="#CCCCCC"> upon your</font>

540
00:26:42,110 --> 00:26:47,779
<font color="#E5E5E5">phone</font><font color="#CCCCCC"> company an app will ask physical</font>

541
00:26:45,440 --> 00:26:50,179
GPS location of<font color="#CCCCCC"> your phone and will stir</font>

542
00:26:47,779 --> 00:26:52,429
them on the light bulbs this is not<font color="#E5E5E5"> very</font>

543
00:26:50,179 --> 00:26:55,370
straightforward things to do<font color="#E5E5E5"> but anyway</font>

544
00:26:52,429 --> 00:26:57,620
at this point I actually know where this

545
00:26:55,370 --> 00:27:02,000
house this<font color="#E5E5E5"> smart house is physically</font>

546
00:26:57,620 --> 00:27:04,399
<font color="#E5E5E5">located which is nice now let's move to</font>

547
00:27:02,000 --> 00:27:07,039
<font color="#CCCCCC">the next</font><font color="#E5E5E5"> device apparently</font><font color="#CCCCCC"> there are</font>

548
00:27:04,399 --> 00:27:10,549
smart speakers in the house<font color="#E5E5E5"> any of you</font>

549
00:27:07,039 --> 00:27:14,240
have so knows<font color="#E5E5E5"> anybody</font><font color="#CCCCCC"> okay of</font><font color="#E5E5E5"> you oh</font>

550
00:27:10,549 --> 00:27:16,908
that's nice nice nice<font color="#CCCCCC"> so I'm going to</font>

551
00:27:14,240 --> 00:27:19,730
<font color="#E5E5E5">run nmap scan against the IP address of</font>

552
00:27:16,909 --> 00:27:22,549
the Sonos to see what<font color="#CCCCCC"> services are</font>

553
00:27:19,730 --> 00:27:25,549
running<font color="#E5E5E5"> and there are quite a few first</font>

554
00:27:22,549 --> 00:27:29,059
of<font color="#E5E5E5"> all let's start with you PMP any of</font>

555
00:27:25,549 --> 00:27:33,860
you heard of you PMP any we heard of

556
00:27:29,059 --> 00:27:36,649
<font color="#CCCCCC">UPnP SSDP and UPnP DLNA extensions</font><font color="#E5E5E5"> so</font>

557
00:27:33,860 --> 00:27:39,889
this is basically extensions of<font color="#E5E5E5"> you PMP</font>

558
00:27:36,649 --> 00:27:42,049
<font color="#E5E5E5">and you can create AV transport command</font>

559
00:27:39,889 --> 00:27:43,969
to any device<font color="#CCCCCC"> that support those</font>

560
00:27:42,049 --> 00:27:46,090
extensions<font color="#E5E5E5"> and basically you can play</font>

561
00:27:43,970 --> 00:27:49,669
any audio you want

562
00:27:46,090 --> 00:27:52,149
so let's invite owners of this house to

563
00:27:49,669 --> 00:27:52,149
the party

564
00:27:58,210 --> 00:28:08,139
I really like<font color="#CCCCCC"> this speaker</font><font color="#E5E5E5"> mmm now let's</font>

565
00:28:05,919 --> 00:28:11,529
move on<font color="#E5E5E5"> there are</font><font color="#CCCCCC"> a few other ports open</font>

566
00:28:08,139 --> 00:28:13,629
so again I'm<font color="#CCCCCC"> very lazy Hecker</font><font color="#E5E5E5"> let's just</font>

567
00:28:11,529 --> 00:28:16,990
open the IP address of<font color="#E5E5E5"> the Sonos with</font>

568
00:28:13,629 --> 00:28:19,899
the port number in the browser<font color="#E5E5E5"> and I got</font>

569
00:28:16,990 --> 00:28:22,119
error for<font color="#CCCCCC"> three forbidden</font><font color="#E5E5E5"> I'm sorry guys</font>

570
00:28:19,899 --> 00:28:25,110
apparently<font color="#E5E5E5"> I'm very bad hacker and guys</font>

571
00:28:22,119 --> 00:28:28,990
its own<font color="#E5E5E5"> as a good security or are they</font>

572
00:28:25,110 --> 00:28:33,248
<font color="#E5E5E5">what if we append slash status to the</font>

573
00:28:28,990 --> 00:28:37,029
<font color="#E5E5E5">URL and hey we got a lot more options</font>

574
00:28:33,249 --> 00:28:38,919
<font color="#CCCCCC">and I like options so let's move to</font><font color="#E5E5E5"> the</font>

575
00:28:37,029 --> 00:28:42,039
accounts menu you can see<font color="#E5E5E5"> that there are</font>

576
00:28:38,919 --> 00:28:44,580
some<font color="#CCCCCC"> ideas and some</font><font color="#E5E5E5"> hashes but let me</font>

577
00:28:42,039 --> 00:28:48,460
zoom in meet the owners of the house

578
00:28:44,580 --> 00:28:50,678
<font color="#E5E5E5">Whitney and</font><font color="#CCCCCC"> Joe</font><font color="#E5E5E5"> black thing is on the</font>

579
00:28:48,460 --> 00:28:53,529
older<font color="#CCCCCC"> samosas when you pair Spotify</font>

580
00:28:50,679 --> 00:28:59,799
account with<font color="#CCCCCC"> Sonos it will store you</font>

581
00:28:53,529 --> 00:29:02,019
<font color="#CCCCCC">Spotify name inside so at this point I I</font>

582
00:28:59,799 --> 00:29:05,740
have<font color="#CCCCCC"> unoptimized software for some</font>

583
00:29:02,019 --> 00:29:08,320
reason anyway<font color="#CCCCCC"> I know the names</font><font color="#E5E5E5"> and I can</font>

584
00:29:05,740 --> 00:29:11,740
leverage that<font color="#E5E5E5"> information</font><font color="#CCCCCC"> you see I can</font>

585
00:29:08,320 --> 00:29:14,590
craft<font color="#CCCCCC"> text-to-speech messages I already</font>

586
00:29:11,740 --> 00:29:18,309
know the names of the owners<font color="#CCCCCC"> so let's</font>

587
00:29:14,590 --> 00:29:26,129
try<font color="#E5E5E5"> to do audio around somewhere hey</font>

588
00:29:18,309 --> 00:29:31,600
Whitney<font color="#E5E5E5"> I am in charge now be so kind</font>

589
00:29:26,129 --> 00:29:32,709
<font color="#E5E5E5">containing one Bitcoin</font><font color="#CCCCCC"> well I have a</font>

590
00:29:31,600 --> 00:29:36,009
confession<font color="#CCCCCC"> to make</font>

591
00:29:32,710 --> 00:29:38,070
when I prepared this message<font color="#E5E5E5"> Bitcoin was</font>

592
00:29:36,009 --> 00:29:42,419
worth something

593
00:29:38,070 --> 00:29:42,418
so one Bitcoin<font color="#E5E5E5"> is not enough</font>

594
00:29:44,080 --> 00:29:47,330
[Music]

595
00:29:51,750 --> 00:30:02,700
from now on now keep in mind<font color="#E5E5E5"> that in the</font>

596
00:30:00,600 --> 00:30:05,070
real world<font color="#E5E5E5"> this message would be quite</font>

597
00:30:02,700 --> 00:30:07,380
<font color="#CCCCCC">longer</font><font color="#E5E5E5"> I would include short link to the</font>

598
00:30:05,070 --> 00:30:10,710
instructions<font color="#CCCCCC"> how to actually</font><font color="#E5E5E5"> pay me but</font>

599
00:30:07,380 --> 00:30:14,120
you get the idea<font color="#CCCCCC"> so smart speakers great</font>

600
00:30:10,710 --> 00:30:18,240
<font color="#E5E5E5">devices but some can give away your name</font>

601
00:30:14,120 --> 00:30:21,229
now let's move to<font color="#CCCCCC"> the next</font><font color="#E5E5E5"> device there</font>

602
00:30:18,240 --> 00:30:26,340
is Alexa<font color="#CCCCCC"> any of you own smart assistants</font>

603
00:30:21,230 --> 00:30:28,980
<font color="#CCCCCC">no ok a</font><font color="#E5E5E5"> few just a few</font><font color="#CCCCCC"> ok so</font><font color="#E5E5E5"> I like</font>

604
00:30:26,340 --> 00:30:30,840
Alexa because she she doesn't

605
00:30:28,980 --> 00:30:33,420
<font color="#E5E5E5">distinguish between your voice and my</font>

606
00:30:30,840 --> 00:30:35,669
voice<font color="#E5E5E5"> right and you probably want to see</font>

607
00:30:33,420 --> 00:30:37,830
some very sophisticated<font color="#E5E5E5"> heck of Alex app</font>

608
00:30:35,670 --> 00:30:40,110
but the thing is I'm very<font color="#CCCCCC"> lazy</font><font color="#E5E5E5"> hacker</font><font color="#CCCCCC"> I</font>

609
00:30:37,830 --> 00:30:41,939
<font color="#E5E5E5">already have</font><font color="#CCCCCC"> access to so notes so I'm</font>

610
00:30:40,110 --> 00:30:45,840
just<font color="#E5E5E5"> going to play comments to</font><font color="#CCCCCC"> Alex and</font>

611
00:30:41,940 --> 00:30:49,110
<font color="#E5E5E5">we'll ask her nicely now any of you here</font>

612
00:30:45,840 --> 00:30:52,080
<font color="#E5E5E5">have Amazon Prime</font><font color="#CCCCCC"> okay</font>

613
00:30:49,110 --> 00:30:54,810
one day a free<font color="#CCCCCC"> two-day</font><font color="#E5E5E5"> delivery grant or</font>

614
00:30:52,080 --> 00:30:58,860
very nice<font color="#E5E5E5"> so let's try to max out the</font>

615
00:30:54,810 --> 00:31:01,530
cards of Whitney and your family hey

616
00:30:58,860 --> 00:31:12,649
Alexa<font color="#CCCCCC"> add Tesla Model treated my</font>

617
00:31:01,530 --> 00:31:12,649
shopping list<font color="#E5E5E5"> that's not nice</font>

618
00:31:13,220 --> 00:31:19,470
let's try again

619
00:31:15,800 --> 00:31:23,790
hey Alexa<font color="#CCCCCC"> add Tesla Model treated my</font>

620
00:31:19,470 --> 00:31:26,750
shopping list<font color="#E5E5E5"> Tesla Model 3 added to</font>

621
00:31:23,790 --> 00:31:29,220
your shopping list<font color="#E5E5E5"> so just</font><font color="#CCCCCC"> in a few days</font>

622
00:31:26,750 --> 00:31:33,660
Whitney and<font color="#CCCCCC"> Jo will receive something</font><font color="#E5E5E5"> on</font>

623
00:31:29,220 --> 00:31:35,580
their doorstep<font color="#E5E5E5"> now Alex</font>

624
00:31:33,660 --> 00:31:39,180
very nice speaker but<font color="#CCCCCC"> will listen to</font>

625
00:31:35,580 --> 00:31:42,480
anyone especially to me in this<font color="#E5E5E5"> case now</font>

626
00:31:39,180 --> 00:31:45,930
sorry<font color="#E5E5E5"> I'm not</font><font color="#CCCCCC"> sure and apparently she's</font>

627
00:31:42,480 --> 00:31:48,690
<font color="#E5E5E5">not sure sometimes</font><font color="#CCCCCC"> now at this point</font>

628
00:31:45,930 --> 00:31:51,360
<font color="#E5E5E5">just to summarize I have unrestricted</font>

629
00:31:48,690 --> 00:31:55,230
access<font color="#E5E5E5"> to the video stream coming from</font>

630
00:31:51,360 --> 00:31:57,629
the IP<font color="#E5E5E5"> camera over there</font><font color="#CCCCCC"> I know</font><font color="#E5E5E5"> the</font>

631
00:31:55,230 --> 00:32:00,179
names of the<font color="#E5E5E5"> owners and I have physical</font>

632
00:31:57,630 --> 00:32:02,700
location of<font color="#E5E5E5"> the house so I think it is</font>

633
00:32:00,179 --> 00:32:05,160
time to actually<font color="#E5E5E5"> pay Whitney enjoy a</font>

634
00:32:02,700 --> 00:32:05,470
visit<font color="#CCCCCC"> and to do that</font><font color="#E5E5E5"> there</font><font color="#CCCCCC"> are</font><font color="#E5E5E5"> actually</font>

635
00:32:05,160 --> 00:32:08,500
<font color="#CCCCCC">two</font>

636
00:32:05,470 --> 00:32:12,250
steps required<font color="#CCCCCC"> first of all</font><font color="#E5E5E5"> Whitney and</font>

637
00:32:08,500 --> 00:32:13,990
<font color="#CCCCCC">Joe love security and they want their</font>

638
00:32:12,250 --> 00:32:16,570
house to be<font color="#CCCCCC"> secure</font><font color="#E5E5E5"> they want their lives</font>

639
00:32:13,990 --> 00:32:20,159
to<font color="#CCCCCC"> be secure</font><font color="#E5E5E5"> any of you can relate</font><font color="#CCCCCC"> to</font>

640
00:32:16,570 --> 00:32:22,720
that<font color="#CCCCCC"> on the</font><font color="#E5E5E5"> security conference okay so</font>

641
00:32:20,159 --> 00:32:23,770
the reverse is not<font color="#E5E5E5"> full</font><font color="#CCCCCC"> of sociopaths</font>

642
00:32:22,720 --> 00:32:26,260
<font color="#E5E5E5">okay</font>

643
00:32:23,770 --> 00:32:28,090
that's fine so they have smart home

644
00:32:26,260 --> 00:32:31,900
security system with all kinds of

645
00:32:28,090 --> 00:32:34,120
sensors<font color="#E5E5E5"> a camera and a motion sensor</font><font color="#CCCCCC"> and</font>

646
00:32:31,900 --> 00:32:37,059
I'm going to alarm it<font color="#E5E5E5"> you can see that</font>

647
00:32:34,120 --> 00:32:40,570
lead is open and this<font color="#CCCCCC"> specific home</font>

648
00:32:37,059 --> 00:32:42,700
alarm has 30 seconds<font color="#E5E5E5"> of grace period so</font>

649
00:32:40,570 --> 00:32:45,908
about in 25 seconds the alarm will go

650
00:32:42,700 --> 00:32:46,690
off<font color="#E5E5E5"> and now we have a challenge</font><font color="#CCCCCC"> to</font>

651
00:32:45,909 --> 00:32:49,840
disable it

652
00:32:46,690 --> 00:32:52,120
right thing is<font color="#E5E5E5"> with ninja love</font>

653
00:32:49,840 --> 00:32:54,789
convenience so they pair their smart

654
00:32:52,120 --> 00:32:57,428
home security system with Alexa<font color="#E5E5E5"> so let's</font>

655
00:32:54,789 --> 00:33:04,750
ask Alexa nicely to<font color="#E5E5E5"> disable the</font><font color="#CCCCCC"> alarm</font>

656
00:32:57,429 --> 00:33:06,780
for<font color="#CCCCCC"> us hey Alexa</font><font color="#E5E5E5"> ask Sofia to disarm the</font>

657
00:33:04,750 --> 00:33:06,780
alarm

658
00:33:09,940 --> 00:33:18,640
passcode needed for this action what is

659
00:33:12,740 --> 00:33:18,640
your passcode<font color="#CCCCCC"> one two three four</font>

660
00:33:19,670 --> 00:33:28,100
<font color="#E5E5E5">even</font><font color="#CCCCCC"> 270 room so the truth</font><font color="#E5E5E5"> is it took me</font>

661
00:33:25,490 --> 00:33:29,840
30 minutes<font color="#E5E5E5"> to find how to change the</font>

662
00:33:28,100 --> 00:33:31,370
default passcode in the convenient

663
00:33:29,840 --> 00:33:34,580
application of that<font color="#E5E5E5"> smart home security</font>

664
00:33:31,370 --> 00:33:38,719
system<font color="#E5E5E5"> so it is pretty</font><font color="#CCCCCC"> safe to say that</font>

665
00:33:34,580 --> 00:33:41,240
<font color="#E5E5E5">average</font><font color="#CCCCCC"> user is not going to do that now</font>

666
00:33:38,720 --> 00:33:44,299
the last<font color="#CCCCCC"> step I</font><font color="#E5E5E5"> disabled the security</font>

667
00:33:41,240 --> 00:33:47,780
<font color="#E5E5E5">system and apparently Whitney and</font><font color="#CCCCCC"> Joe</font>

668
00:33:44,299 --> 00:33:50,179
have very smart<font color="#E5E5E5"> door because they have</font>

669
00:33:47,780 --> 00:33:52,428
smart<font color="#E5E5E5"> lock which</font><font color="#CCCCCC"> is a</font><font color="#E5E5E5"> home</font><font color="#CCCCCC"> get enabled</font>

670
00:33:50,179 --> 00:33:56,419
<font color="#E5E5E5">and it is part of the iPad over there</font>

671
00:33:52,429 --> 00:33:58,280
<font color="#CCCCCC">and the thing about iPad and see is that</font>

672
00:33:56,419 --> 00:34:00,919
Siri can distinguish between<font color="#E5E5E5"> your voice</font>

673
00:33:58,280 --> 00:34:03,260
and my<font color="#CCCCCC"> voice right</font><font color="#E5E5E5"> I cannot just say hey</font>

674
00:34:00,919 --> 00:34:05,540
Siri to activate all your phones and all

675
00:34:03,260 --> 00:34:07,400
your iPhones right<font color="#E5E5E5"> but remember at the</font>

676
00:34:05,540 --> 00:34:09,440
very<font color="#E5E5E5"> beginning I said that every time</font>

677
00:34:07,400 --> 00:34:11,960
there<font color="#CCCCCC"> is a motion</font><font color="#E5E5E5"> or a sound the IP</font>

678
00:34:09,440 --> 00:34:14,960
<font color="#E5E5E5">camera is going to send the clip of that</font>

679
00:34:11,960 --> 00:34:17,060
<font color="#E5E5E5">happening to my own FTP server well at</font>

680
00:34:14,960 --> 00:34:19,129
this<font color="#CCCCCC"> point I have hours and hours of</font>

681
00:34:17,060 --> 00:34:22,070
footage<font color="#E5E5E5"> coming from that living</font><font color="#CCCCCC"> room and</font>

682
00:34:19,129 --> 00:34:23,540
I'm not<font color="#E5E5E5"> going to watch it I'm going this</font>

683
00:34:22,070 --> 00:34:26,300
machine learning and speech recognition

684
00:34:23,540 --> 00:34:29,449
<font color="#CCCCCC">to search for very specific key phrase a</font>

685
00:34:26,300 --> 00:34:32,270
<font color="#CCCCCC">CA</font><font color="#E5E5E5"> I'm going to use that audio clip of</font>

686
00:34:29,449 --> 00:34:34,638
that<font color="#CCCCCC"> phrase and I'm going to</font><font color="#E5E5E5"> use it to</font>

687
00:34:32,270 --> 00:34:37,250
trigger Syria<font color="#CCCCCC"> and interesting thing</font>

688
00:34:34,639 --> 00:34:40,369
about this assistant is that anything

689
00:34:37,250 --> 00:34:42,889
<font color="#CCCCCC">you say everybody says</font><font color="#E5E5E5"> after hey Siri</font>

690
00:34:40,369 --> 00:34:44,510
trigger word will be processed<font color="#CCCCCC"> and</font>

691
00:34:42,889 --> 00:34:51,619
anybody<font color="#E5E5E5"> can talk to Siri</font>

692
00:34:44,510 --> 00:34:57,550
so let's try<font color="#CCCCCC"> to unlock the door hey Siri</font>

693
00:34:51,619 --> 00:34:57,550
<font color="#E5E5E5">unlock the door please I'm on it</font>

694
00:35:02,380 --> 00:35:09,280
<font color="#CCCCCC">your dana lock is are not Wow it works</font>

695
00:35:05,440 --> 00:35:11,560
<font color="#E5E5E5">so as you can see the doors are open the</font>

696
00:35:09,280 --> 00:35:14,500
doors unlock and unfortunately<font color="#E5E5E5"> I'm not</font>

697
00:35:11,560 --> 00:35:17,620
<font color="#E5E5E5">going to fit through those but</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> get</font>

698
00:35:14,500 --> 00:35:20,080
the idea<font color="#CCCCCC"> and if you if you</font><font color="#E5E5E5"> remember</font>

699
00:35:17,620 --> 00:35:23,020
<font color="#E5E5E5">after he Siri there was actually a man's</font>

700
00:35:20,080 --> 00:35:27,759
voice<font color="#E5E5E5"> and it clearly was not witness</font>

701
00:35:23,020 --> 00:35:29,590
voice so this<font color="#E5E5E5"> is actually a paradox of</font>

702
00:35:27,760 --> 00:35:31,810
security in<font color="#E5E5E5"> this case because Sweeney</font>

703
00:35:29,590 --> 00:35:34,600
<font color="#E5E5E5">and Joe or</font><font color="#CCCCCC"> chaste smart home security</font>

704
00:35:31,810 --> 00:35:36,790
system and smart lock to<font color="#CCCCCC"> make their home</font>

705
00:35:34,600 --> 00:35:39,100
safe to make their life safe but

706
00:35:36,790 --> 00:35:41,050
<font color="#E5E5E5">actually it</font><font color="#CCCCCC"> make me easy like it made</font>

707
00:35:39,100 --> 00:35:43,779
easier for me to<font color="#E5E5E5"> get</font><font color="#CCCCCC"> inside and</font>

708
00:35:41,050 --> 00:35:46,960
<font color="#E5E5E5">compromised all of those devices</font><font color="#CCCCCC"> and the</font>

709
00:35:43,780 --> 00:35:49,720
thing is<font color="#E5E5E5"> like in this case that if not</font>

710
00:35:46,960 --> 00:35:51,880
<font color="#E5E5E5">for</font><font color="#CCCCCC"> that</font><font color="#E5E5E5"> IP camera over there nothing of</font>

711
00:35:49,720 --> 00:35:53,799
that<font color="#E5E5E5"> would be</font><font color="#CCCCCC"> possible because</font><font color="#E5E5E5"> if not</font>

712
00:35:51,880 --> 00:35:55,930
<font color="#CCCCCC">for that</font><font color="#E5E5E5"> IP camera I would not be able</font>

713
00:35:53,800 --> 00:35:59,080
<font color="#CCCCCC">to get inside</font><font color="#E5E5E5"> the network and compromise</font>

714
00:35:55,930 --> 00:35:59,440
<font color="#E5E5E5">all of those devices because let's be</font>

715
00:35:59,080 --> 00:36:02,170
frank

716
00:35:59,440 --> 00:36:03,910
you<font color="#CCCCCC"> came P protocol and everything else</font>

717
00:36:02,170 --> 00:36:05,650
<font color="#E5E5E5">that I showed</font><font color="#CCCCCC"> you</font><font color="#E5E5E5"> are common protocols</font>

718
00:36:03,910 --> 00:36:08,830
that rely<font color="#E5E5E5"> on security of your local</font>

719
00:36:05,650 --> 00:36:11,200
<font color="#E5E5E5">network</font><font color="#CCCCCC"> so the point of</font><font color="#E5E5E5"> this demo was</font>

720
00:36:08,830 --> 00:36:13,090
that like this home or your home is a

721
00:36:11,200 --> 00:36:16,149
<font color="#E5E5E5">strongly secured as the weakest device</font>

722
00:36:13,090 --> 00:36:18,250
<font color="#E5E5E5">if you have one vulnerable camera</font>

723
00:36:16,150 --> 00:36:20,890
it only takes to actually get<font color="#CCCCCC"> inside</font>

724
00:36:18,250 --> 00:36:26,010
<font color="#CCCCCC">your network and do all other kinds</font><font color="#E5E5E5"> of</font>

725
00:36:20,890 --> 00:36:26,009
stuff<font color="#E5E5E5"> so thank you very much</font>

